Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_modified', '--query_batches', 'batch3', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '01092023_182316_1', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 82522
Number of validation nodes: 9169
Number of training edges: 195815
Number of validation edges: 21757
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9082; val_auprc_score: 0.8728; val_best_acc_score: 0.8620; val_best_f1_score: 0.8701; train_kl_reg_loss: 24125.7986; train_edge_recon_loss: 2673378.5333; train_gene_expr_recon_loss: 2958127.4132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5655631.7546; train_optim_loss: 5655631.7546; val_kl_reg_loss: 24266.8958; val_edge_recon_loss: 2740168.9477; val_gene_expr_recon_loss: 2312586.3779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5077022.1744; val_optim_loss: 5077022.1744
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9074; val_auprc_score: 0.8710; val_best_acc_score: 0.8622; val_best_f1_score: 0.8706; train_kl_reg_loss: 24125.3949; train_edge_recon_loss: 2674617.9856; train_gene_expr_recon_loss: 2064208.6537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4762952.0339; train_optim_loss: 4762952.0339; val_kl_reg_loss: 24234.6574; val_edge_recon_loss: 2739317.6337; val_gene_expr_recon_loss: 1887174.2645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4650726.5698; val_optim_loss: 4650726.5698
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9096; val_auprc_score: 0.8754; val_best_acc_score: 0.8637; val_best_f1_score: 0.8712; train_kl_reg_loss: 24121.8058; train_edge_recon_loss: 2673085.1913; train_gene_expr_recon_loss: 1852241.7562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4549448.7598; train_optim_loss: 4549448.7598; val_kl_reg_loss: 24228.0925; val_edge_recon_loss: 2738252.6686; val_gene_expr_recon_loss: 1815954.8721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4578435.5698; val_optim_loss: 4578435.5698
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9090; val_auprc_score: 0.8739; val_best_acc_score: 0.8625; val_best_f1_score: 0.8704; train_kl_reg_loss: 24135.8388; train_edge_recon_loss: 2676670.4217; train_gene_expr_recon_loss: 1814184.0176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4514990.2833; train_optim_loss: 4514990.2833; val_kl_reg_loss: 24221.0744; val_edge_recon_loss: 2741523.6221; val_gene_expr_recon_loss: 1799684.4273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4565429.1628; val_optim_loss: 4565429.1628
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9062; val_auprc_score: 0.8698; val_best_acc_score: 0.8613; val_best_f1_score: 0.8696; train_kl_reg_loss: 24127.2427; train_edge_recon_loss: 2673682.4360; train_gene_expr_recon_loss: 1804935.1740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4502744.8590; train_optim_loss: 4502744.8590; val_kl_reg_loss: 24290.3824; val_edge_recon_loss: 2741749.5174; val_gene_expr_recon_loss: 1792602.2849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4558642.1977; val_optim_loss: 4558642.1977
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9104; val_auprc_score: 0.8740; val_best_acc_score: 0.8646; val_best_f1_score: 0.8723; train_kl_reg_loss: 24112.1140; train_edge_recon_loss: 2676336.8949; train_gene_expr_recon_loss: 1799597.9801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4500046.9843; train_optim_loss: 4500046.9843; val_kl_reg_loss: 24271.4286; val_edge_recon_loss: 2731987.0116; val_gene_expr_recon_loss: 1793389.9070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4549648.3372; val_optim_loss: 4549648.3372
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9086; val_auprc_score: 0.8731; val_best_acc_score: 0.8620; val_best_f1_score: 0.8704; train_kl_reg_loss: 24129.3555; train_edge_recon_loss: 2674704.6038; train_gene_expr_recon_loss: 1794019.4546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4492853.4021; train_optim_loss: 4492853.4021; val_kl_reg_loss: 24248.8196; val_edge_recon_loss: 2738291.3314; val_gene_expr_recon_loss: 1786939.5145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4549479.6744; val_optim_loss: 4549479.6744
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9090; val_auprc_score: 0.8732; val_best_acc_score: 0.8645; val_best_f1_score: 0.8718; train_kl_reg_loss: 24123.4415; train_edge_recon_loss: 2672937.5803; train_gene_expr_recon_loss: 1790467.0091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4487528.0131; train_optim_loss: 4487528.0131; val_kl_reg_loss: 24261.1169; val_edge_recon_loss: 2737699.7558; val_gene_expr_recon_loss: 1785358.2064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4547319.1279; val_optim_loss: 4547319.1279
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9113; val_auprc_score: 0.8745; val_best_acc_score: 0.8668; val_best_f1_score: 0.8737; train_kl_reg_loss: 24121.4397; train_edge_recon_loss: 2672843.1880; train_gene_expr_recon_loss: 1788238.5467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4485203.1619; train_optim_loss: 4485203.1619; val_kl_reg_loss: 24247.8286; val_edge_recon_loss: 2729542.0872; val_gene_expr_recon_loss: 1780409.0029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4534198.8721; val_optim_loss: 4534198.8721
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9088; val_auprc_score: 0.8730; val_best_acc_score: 0.8634; val_best_f1_score: 0.8715; train_kl_reg_loss: 24149.0408; train_edge_recon_loss: 2672944.3897; train_gene_expr_recon_loss: 1785426.5659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4482520.0091; train_optim_loss: 4482520.0091; val_kl_reg_loss: 24269.9355; val_edge_recon_loss: 2737074.1453; val_gene_expr_recon_loss: 1776059.7064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4537403.7907; val_optim_loss: 4537403.7907
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9084; val_auprc_score: 0.8720; val_best_acc_score: 0.8639; val_best_f1_score: 0.8710; train_kl_reg_loss: 24132.3260; train_edge_recon_loss: 2675371.7650; train_gene_expr_recon_loss: 1781621.0506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4481125.1423; train_optim_loss: 4481125.1423; val_kl_reg_loss: 24255.4408; val_edge_recon_loss: 2735508.3372; val_gene_expr_recon_loss: 1772854.4971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4532618.2558; val_optim_loss: 4532618.2558
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9091; val_auprc_score: 0.8725; val_best_acc_score: 0.8648; val_best_f1_score: 0.8725; train_kl_reg_loss: 24143.9736; train_edge_recon_loss: 2674461.6292; train_gene_expr_recon_loss: 1778856.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4477461.7715; train_optim_loss: 4477461.7715; val_kl_reg_loss: 24205.5125; val_edge_recon_loss: 2734893.6395; val_gene_expr_recon_loss: 1768890.6076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527989.7442; val_optim_loss: 4527989.7442
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9101; val_auprc_score: 0.8746; val_best_acc_score: 0.8659; val_best_f1_score: 0.8732; train_kl_reg_loss: 24132.6924; train_edge_recon_loss: 2675920.2278; train_gene_expr_recon_loss: 1777637.7993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4477690.7050; train_optim_loss: 4477690.7050; val_kl_reg_loss: 24313.6776; val_edge_recon_loss: 2729934.8721; val_gene_expr_recon_loss: 1773846.6744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4528095.2442; val_optim_loss: 4528095.2442
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9089; val_auprc_score: 0.8745; val_best_acc_score: 0.8624; val_best_f1_score: 0.8702; train_kl_reg_loss: 24139.9030; train_edge_recon_loss: 2672979.1436; train_gene_expr_recon_loss: 1776429.1919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4473548.2402; train_optim_loss: 4473548.2402; val_kl_reg_loss: 24223.8239; val_edge_recon_loss: 2735425.1453; val_gene_expr_recon_loss: 1767690.9855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527339.9419; val_optim_loss: 4527339.9419
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9093; val_auprc_score: 0.8741; val_best_acc_score: 0.8637; val_best_f1_score: 0.8713; train_kl_reg_loss: 24125.0565; train_edge_recon_loss: 2675329.3035; train_gene_expr_recon_loss: 1776088.5672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4475542.9334; train_optim_loss: 4475542.9334; val_kl_reg_loss: 24230.7024; val_edge_recon_loss: 2737520.3430; val_gene_expr_recon_loss: 1763036.4419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4524787.4767; val_optim_loss: 4524787.4767
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9075; val_auprc_score: 0.8721; val_best_acc_score: 0.8614; val_best_f1_score: 0.8691; train_kl_reg_loss: 24131.6234; train_edge_recon_loss: 2675568.6619; train_gene_expr_recon_loss: 1773153.0352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4472853.3277; train_optim_loss: 4472853.3277; val_kl_reg_loss: 24243.1513; val_edge_recon_loss: 2744190.2093; val_gene_expr_recon_loss: 1766745.4971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4535178.8605; val_optim_loss: 4535178.8605
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9072; val_auprc_score: 0.8702; val_best_acc_score: 0.8618; val_best_f1_score: 0.8705; train_kl_reg_loss: 24125.2300; train_edge_recon_loss: 2674435.3296; train_gene_expr_recon_loss: 1773265.6224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471826.1984; train_optim_loss: 4471826.1984; val_kl_reg_loss: 24241.3150; val_edge_recon_loss: 2742020.8895; val_gene_expr_recon_loss: 1764602.6657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4530864.8837; val_optim_loss: 4530864.8837
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9100; val_auprc_score: 0.8746; val_best_acc_score: 0.8651; val_best_f1_score: 0.8727; train_kl_reg_loss: 24134.6553; train_edge_recon_loss: 2673139.0039; train_gene_expr_recon_loss: 1772361.7216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469635.3616; train_optim_loss: 4469635.3616; val_kl_reg_loss: 24196.8800; val_edge_recon_loss: 2732616.6919; val_gene_expr_recon_loss: 1767917.5814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4524731.1744; val_optim_loss: 4524731.1744
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9060; val_auprc_score: 0.8689; val_best_acc_score: 0.8615; val_best_f1_score: 0.8697; train_kl_reg_loss: 24137.6213; train_edge_recon_loss: 2676794.7435; train_gene_expr_recon_loss: 1771540.0793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4472472.4334; train_optim_loss: 4472472.4334; val_kl_reg_loss: 24211.3807; val_edge_recon_loss: 2742270.3314; val_gene_expr_recon_loss: 1764255.1686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4530736.8837; val_optim_loss: 4530736.8837
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9084; val_auprc_score: 0.8730; val_best_acc_score: 0.8623; val_best_f1_score: 0.8707; train_kl_reg_loss: 24127.5117; train_edge_recon_loss: 2674344.2493; train_gene_expr_recon_loss: 1770846.0656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469317.8381; train_optim_loss: 4469317.8381; val_kl_reg_loss: 24255.0182; val_edge_recon_loss: 2741645.1047; val_gene_expr_recon_loss: 1761132.9128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527033.0581; val_optim_loss: 4527033.0581
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9090; val_auprc_score: 0.8727; val_best_acc_score: 0.8625; val_best_f1_score: 0.8704; train_kl_reg_loss: 24142.8221; train_edge_recon_loss: 2671945.3890; train_gene_expr_recon_loss: 1771132.9641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4467221.2010; train_optim_loss: 4467221.2010; val_kl_reg_loss: 24228.1491; val_edge_recon_loss: 2737506.0756; val_gene_expr_recon_loss: 1765600.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527334.7674; val_optim_loss: 4527334.7674
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9079; val_auprc_score: 0.8720; val_best_acc_score: 0.8628; val_best_f1_score: 0.8706; train_kl_reg_loss: 24142.4990; train_edge_recon_loss: 2679210.7258; train_gene_expr_recon_loss: 1770676.4308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4474029.6462; train_optim_loss: 4474029.6462; val_kl_reg_loss: 24252.2144; val_edge_recon_loss: 2742798.6453; val_gene_expr_recon_loss: 1762739.8692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4529790.7326; val_optim_loss: 4529790.7326

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9067; val_auprc_score: 0.8696; val_best_acc_score: 0.8613; val_best_f1_score: 0.8699; train_kl_reg_loss: 24131.0416; train_edge_recon_loss: 2679195.7467; train_gene_expr_recon_loss: 1770835.1560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4474161.9491; train_optim_loss: 4474161.9491; val_kl_reg_loss: 24251.4732; val_edge_recon_loss: 2740122.0000; val_gene_expr_recon_loss: 1761892.2791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4526265.6744; val_optim_loss: 4526265.6744
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9075; val_auprc_score: 0.8711; val_best_acc_score: 0.8626; val_best_f1_score: 0.8707; train_kl_reg_loss: 24132.4410; train_edge_recon_loss: 2675993.1867; train_gene_expr_recon_loss: 1769420.4005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469546.0405; train_optim_loss: 4469546.0405; val_kl_reg_loss: 24260.4934; val_edge_recon_loss: 2737756.0233; val_gene_expr_recon_loss: 1764283.4186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4526299.9186; val_optim_loss: 4526299.9186
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9069; val_auprc_score: 0.8708; val_best_acc_score: 0.8630; val_best_f1_score: 0.8705; train_kl_reg_loss: 24134.4612; train_edge_recon_loss: 2676481.0372; train_gene_expr_recon_loss: 1769795.9827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4470411.4883; train_optim_loss: 4470411.4883; val_kl_reg_loss: 24214.9196; val_edge_recon_loss: 2742235.5058; val_gene_expr_recon_loss: 1760876.8488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527327.2674; val_optim_loss: 4527327.2674
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9080; val_auprc_score: 0.8716; val_best_acc_score: 0.8640; val_best_f1_score: 0.8716; train_kl_reg_loss: 24124.2255; train_edge_recon_loss: 2676525.5940; train_gene_expr_recon_loss: 1769918.1586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4470567.9726; train_optim_loss: 4470567.9726; val_kl_reg_loss: 24215.8020; val_edge_recon_loss: 2737327.0640; val_gene_expr_recon_loss: 1759126.8547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4520669.7093; val_optim_loss: 4520669.7093
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9065; val_auprc_score: 0.8693; val_best_acc_score: 0.8614; val_best_f1_score: 0.8695; train_kl_reg_loss: 24136.5848; train_edge_recon_loss: 2671461.9752; train_gene_expr_recon_loss: 1769509.7187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4465108.2650; train_optim_loss: 4465108.2650; val_kl_reg_loss: 24230.9511; val_edge_recon_loss: 2742078.3895; val_gene_expr_recon_loss: 1765452.2093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4531761.5581; val_optim_loss: 4531761.5581
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9090; val_auprc_score: 0.8725; val_best_acc_score: 0.8630; val_best_f1_score: 0.8709; train_kl_reg_loss: 24131.8944; train_edge_recon_loss: 2677831.5424; train_gene_expr_recon_loss: 1770376.4341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4472339.8773; train_optim_loss: 4472339.8773; val_kl_reg_loss: 24241.1285; val_edge_recon_loss: 2739522.9012; val_gene_expr_recon_loss: 1766082.7297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4529846.7442; val_optim_loss: 4529846.7442
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9075; val_auprc_score: 0.8715; val_best_acc_score: 0.8620; val_best_f1_score: 0.8698; train_kl_reg_loss: 24109.4215; train_edge_recon_loss: 2675646.0986; train_gene_expr_recon_loss: 1771291.4063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471046.9164; train_optim_loss: 4471046.9164; val_kl_reg_loss: 24194.5600; val_edge_recon_loss: 2744067.9360; val_gene_expr_recon_loss: 1760568.8837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4528831.3140; val_optim_loss: 4528831.3140
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9088; val_auprc_score: 0.8727; val_best_acc_score: 0.8628; val_best_f1_score: 0.8702; train_kl_reg_loss: 24130.7115; train_edge_recon_loss: 2674208.2905; train_gene_expr_recon_loss: 1770690.1775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469029.1841; train_optim_loss: 4469029.1841; val_kl_reg_loss: 24151.2154; val_edge_recon_loss: 2743679.2965; val_gene_expr_recon_loss: 1763703.2849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4531533.7907; val_optim_loss: 4531533.7907

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9093; val_auprc_score: 0.8744; val_best_acc_score: 0.8633; val_best_f1_score: 0.8707; train_kl_reg_loss: 24132.7142; train_edge_recon_loss: 2677466.2167; train_gene_expr_recon_loss: 1770203.7265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471802.6488; train_optim_loss: 4471802.6488; val_kl_reg_loss: 24182.1216; val_edge_recon_loss: 2737986.8023; val_gene_expr_recon_loss: 1763130.1192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4525299.0465; val_optim_loss: 4525299.0465
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9075; val_auprc_score: 0.8716; val_best_acc_score: 0.8619; val_best_f1_score: 0.8696; train_kl_reg_loss: 24131.2792; train_edge_recon_loss: 2675273.5796; train_gene_expr_recon_loss: 1769716.1002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469120.9491; train_optim_loss: 4469120.9491; val_kl_reg_loss: 24256.8573; val_edge_recon_loss: 2744843.0465; val_gene_expr_recon_loss: 1762022.6279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4531122.5000; val_optim_loss: 4531122.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9088; val_auprc_score: 0.8731; val_best_acc_score: 0.8634; val_best_f1_score: 0.8716; train_kl_reg_loss: 24140.2044; train_edge_recon_loss: 2673963.9758; train_gene_expr_recon_loss: 1769050.0760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4467154.2663; train_optim_loss: 4467154.2663; val_kl_reg_loss: 24228.3102; val_edge_recon_loss: 2738860.8256; val_gene_expr_recon_loss: 1762115.4360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4525204.5116; val_optim_loss: 4525204.5116
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9080; val_auprc_score: 0.8717; val_best_acc_score: 0.8625; val_best_f1_score: 0.8708; train_kl_reg_loss: 24139.7744; train_edge_recon_loss: 2676812.4876; train_gene_expr_recon_loss: 1771025.1299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471977.3982; train_optim_loss: 4471977.3982; val_kl_reg_loss: 24256.6176; val_edge_recon_loss: 2737101.4593; val_gene_expr_recon_loss: 1758061.9477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4519420.0116; val_optim_loss: 4519420.0116
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9080; val_auprc_score: 0.8730; val_best_acc_score: 0.8618; val_best_f1_score: 0.8699; train_kl_reg_loss: 24121.5821; train_edge_recon_loss: 2670732.4687; train_gene_expr_recon_loss: 1768741.5780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4463595.6266; train_optim_loss: 4463595.6266; val_kl_reg_loss: 24242.4712; val_edge_recon_loss: 2740048.8547; val_gene_expr_recon_loss: 1769869.7209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4534161.0349; val_optim_loss: 4534161.0349
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9110; val_auprc_score: 0.8767; val_best_acc_score: 0.8641; val_best_f1_score: 0.8718; train_kl_reg_loss: 24114.8362; train_edge_recon_loss: 2677700.2004; train_gene_expr_recon_loss: 1769544.7817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471359.8133; train_optim_loss: 4471359.8133; val_kl_reg_loss: 24220.2612; val_edge_recon_loss: 2731905.5233; val_gene_expr_recon_loss: 1764870.3517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4520996.1744; val_optim_loss: 4520996.1744
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9078; val_auprc_score: 0.8715; val_best_acc_score: 0.8633; val_best_f1_score: 0.8712; train_kl_reg_loss: 24125.3936; train_edge_recon_loss: 2677030.5248; train_gene_expr_recon_loss: 1771414.6407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4472570.5718; train_optim_loss: 4472570.5718; val_kl_reg_loss: 24220.3571; val_edge_recon_loss: 2737920.8953; val_gene_expr_recon_loss: 1763069.0698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4525210.3488; val_optim_loss: 4525210.3488
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9077; val_auprc_score: 0.8717; val_best_acc_score: 0.8640; val_best_f1_score: 0.8716; train_kl_reg_loss: 24111.1885; train_edge_recon_loss: 2676556.8740; train_gene_expr_recon_loss: 1769273.8166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469941.9008; train_optim_loss: 4469941.9008; val_kl_reg_loss: 24216.8195; val_edge_recon_loss: 2743823.1744; val_gene_expr_recon_loss: 1758758.0233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4526798.0000; val_optim_loss: 4526798.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9092; val_auprc_score: 0.8740; val_best_acc_score: 0.8647; val_best_f1_score: 0.8713; train_kl_reg_loss: 24138.5645; train_edge_recon_loss: 2674681.0026; train_gene_expr_recon_loss: 1770515.3293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469334.8982; train_optim_loss: 4469334.8982; val_kl_reg_loss: 24249.9663; val_edge_recon_loss: 2733498.4070; val_gene_expr_recon_loss: 1759256.5756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4517004.9651; val_optim_loss: 4517004.9651
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9088; val_auprc_score: 0.8732; val_best_acc_score: 0.8635; val_best_f1_score: 0.8713; train_kl_reg_loss: 24139.4040; train_edge_recon_loss: 2673335.5137; train_gene_expr_recon_loss: 1770261.0917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4467736.0117; train_optim_loss: 4467736.0117; val_kl_reg_loss: 24250.4999; val_edge_recon_loss: 2740296.3023; val_gene_expr_recon_loss: 1762477.0291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527023.8372; val_optim_loss: 4527023.8372
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9079; val_auprc_score: 0.8721; val_best_acc_score: 0.8623; val_best_f1_score: 0.8700; train_kl_reg_loss: 24122.5961; train_edge_recon_loss: 2673342.3466; train_gene_expr_recon_loss: 1769989.4824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4467454.4386; train_optim_loss: 4467454.4386; val_kl_reg_loss: 24198.3495; val_edge_recon_loss: 2741595.4884; val_gene_expr_recon_loss: 1762338.5523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4528132.4302; val_optim_loss: 4528132.4302
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9082; val_auprc_score: 0.8729; val_best_acc_score: 0.8618; val_best_f1_score: 0.8701; train_kl_reg_loss: 24137.8900; train_edge_recon_loss: 2675686.2996; train_gene_expr_recon_loss: 1769895.4047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469719.5940; train_optim_loss: 4469719.5940; val_kl_reg_loss: 24257.3840; val_edge_recon_loss: 2739055.7267; val_gene_expr_recon_loss: 1764151.3285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527464.4651; val_optim_loss: 4527464.4651
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9096; val_auprc_score: 0.8735; val_best_acc_score: 0.8628; val_best_f1_score: 0.8707; train_kl_reg_loss: 24139.7393; train_edge_recon_loss: 2674222.4785; train_gene_expr_recon_loss: 1771104.3949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469466.6240; train_optim_loss: 4469466.6240; val_kl_reg_loss: 24235.1457; val_edge_recon_loss: 2735835.8605; val_gene_expr_recon_loss: 1763306.9186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4523377.9070; val_optim_loss: 4523377.9070

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9093; val_auprc_score: 0.8735; val_best_acc_score: 0.8647; val_best_f1_score: 0.8721; train_kl_reg_loss: 24117.7818; train_edge_recon_loss: 2676647.6057; train_gene_expr_recon_loss: 1769040.2993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469805.6828; train_optim_loss: 4469805.6828; val_kl_reg_loss: 24236.8025; val_edge_recon_loss: 2734279.5988; val_gene_expr_recon_loss: 1763251.4360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4521767.8721; val_optim_loss: 4521767.8721
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9088; val_auprc_score: 0.8734; val_best_acc_score: 0.8628; val_best_f1_score: 0.8705; train_kl_reg_loss: 24137.1913; train_edge_recon_loss: 2674886.8381; train_gene_expr_recon_loss: 1771082.2918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4470106.3211; train_optim_loss: 4470106.3211; val_kl_reg_loss: 24198.4478; val_edge_recon_loss: 2736713.1628; val_gene_expr_recon_loss: 1760285.4273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4521197.0349; val_optim_loss: 4521197.0349
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9114; val_auprc_score: 0.8755; val_best_acc_score: 0.8654; val_best_f1_score: 0.8730; train_kl_reg_loss: 24125.0915; train_edge_recon_loss: 2674772.2781; train_gene_expr_recon_loss: 1770574.2023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469471.5744; train_optim_loss: 4469471.5744; val_kl_reg_loss: 24212.4979; val_edge_recon_loss: 2724313.1977; val_gene_expr_recon_loss: 1761210.7093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4509736.3721; val_optim_loss: 4509736.3721
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9073; val_auprc_score: 0.8701; val_best_acc_score: 0.8631; val_best_f1_score: 0.8712; train_kl_reg_loss: 24131.1162; train_edge_recon_loss: 2676336.2604; train_gene_expr_recon_loss: 1770028.4918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4470495.8603; train_optim_loss: 4470495.8603; val_kl_reg_loss: 24289.1000; val_edge_recon_loss: 2737447.4593; val_gene_expr_recon_loss: 1762199.3343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4523935.8837; val_optim_loss: 4523935.8837
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9088; val_auprc_score: 0.8728; val_best_acc_score: 0.8639; val_best_f1_score: 0.8720; train_kl_reg_loss: 24138.8222; train_edge_recon_loss: 2675701.9595; train_gene_expr_recon_loss: 1770182.3949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4470023.1997; train_optim_loss: 4470023.1997; val_kl_reg_loss: 24261.1465; val_edge_recon_loss: 2733049.0174; val_gene_expr_recon_loss: 1763987.6047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4521297.7558; val_optim_loss: 4521297.7558
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9109; val_auprc_score: 0.8760; val_best_acc_score: 0.8647; val_best_f1_score: 0.8717; train_kl_reg_loss: 24135.1163; train_edge_recon_loss: 2675373.6227; train_gene_expr_recon_loss: 1769813.7742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469322.5261; train_optim_loss: 4469322.5261; val_kl_reg_loss: 24235.7506; val_edge_recon_loss: 2735902.2616; val_gene_expr_recon_loss: 1762312.4884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4522450.5814; val_optim_loss: 4522450.5814
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9081; val_auprc_score: 0.8721; val_best_acc_score: 0.8633; val_best_f1_score: 0.8708; train_kl_reg_loss: 24127.1889; train_edge_recon_loss: 2677233.2480; train_gene_expr_recon_loss: 1771516.1178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4472876.5457; train_optim_loss: 4472876.5457; val_kl_reg_loss: 24243.0422; val_edge_recon_loss: 2742972.5058; val_gene_expr_recon_loss: 1762240.5552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4529456.1163; val_optim_loss: 4529456.1163

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9070; val_auprc_score: 0.8699; val_best_acc_score: 0.8620; val_best_f1_score: 0.8704; train_kl_reg_loss: 24128.4731; train_edge_recon_loss: 2675494.2911; train_gene_expr_recon_loss: 1771801.2768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471424.0457; train_optim_loss: 4471424.0457; val_kl_reg_loss: 24279.9946; val_edge_recon_loss: 2740257.2442; val_gene_expr_recon_loss: 1764346.7733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4528884.0233; val_optim_loss: 4528884.0233
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9082; val_auprc_score: 0.8716; val_best_acc_score: 0.8629; val_best_f1_score: 0.8710; train_kl_reg_loss: 24129.6560; train_edge_recon_loss: 2673713.4902; train_gene_expr_recon_loss: 1769253.4311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4467096.5888; train_optim_loss: 4467096.5888; val_kl_reg_loss: 24214.4633; val_edge_recon_loss: 2737383.4360; val_gene_expr_recon_loss: 1763253.7994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4524851.6977; val_optim_loss: 4524851.6977
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9075; val_auprc_score: 0.8710; val_best_acc_score: 0.8638; val_best_f1_score: 0.8715; train_kl_reg_loss: 24128.8169; train_edge_recon_loss: 2676901.7422; train_gene_expr_recon_loss: 1770646.1658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471676.7167; train_optim_loss: 4471676.7167; val_kl_reg_loss: 24249.3126; val_edge_recon_loss: 2739867.9244; val_gene_expr_recon_loss: 1768691.8605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4532809.0930; val_optim_loss: 4532809.0930
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9074; val_auprc_score: 0.8718; val_best_acc_score: 0.8607; val_best_f1_score: 0.8686; train_kl_reg_loss: 24128.9179; train_edge_recon_loss: 2674639.0026; train_gene_expr_recon_loss: 1770010.0101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4468777.9138; train_optim_loss: 4468777.9138; val_kl_reg_loss: 24227.7872; val_edge_recon_loss: 2746553.6337; val_gene_expr_recon_loss: 1764581.9448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4535363.3488; val_optim_loss: 4535363.3488

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 123 min 37 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9067
val AUPRC score: 0.8703
val best accuracy score: 0.8617
val best F1 score: 0.8694
val target rna MSE score: 1.3931
val source rna MSE score: 0.2542
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0892

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
