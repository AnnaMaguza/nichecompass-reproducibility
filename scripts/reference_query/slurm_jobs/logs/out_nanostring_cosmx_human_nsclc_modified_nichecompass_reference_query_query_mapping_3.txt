Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_modified', '--query_batches', 'batch3', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '31082023_085723_1', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 38, n_output: 960

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 82522
Number of validation nodes: 9169
Number of training edges: 195815
Number of validation edges: 21757
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9151; val_auprc_score: 0.8802; val_best_acc_score: 0.8582; val_best_f1_score: 0.8643; train_kl_reg_loss: 23523.4774; train_edge_recon_loss: 2713729.2644; train_gene_expr_recon_loss: 2030747.1025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4767999.8381; train_optim_loss: 4767999.8381; val_kl_reg_loss: 23422.7480; val_edge_recon_loss: 2779557.7151; val_gene_expr_recon_loss: 1867148.7645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4670129.2442; val_optim_loss: 4670129.2442
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9138; val_auprc_score: 0.8754; val_best_acc_score: 0.8591; val_best_f1_score: 0.8654; train_kl_reg_loss: 23533.8088; train_edge_recon_loss: 2709470.6090; train_gene_expr_recon_loss: 1831654.5578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4564658.9948; train_optim_loss: 4564658.9948; val_kl_reg_loss: 23495.4308; val_edge_recon_loss: 2774959.0814; val_gene_expr_recon_loss: 1806280.8372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4604735.3140; val_optim_loss: 4604735.3140
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9152; val_auprc_score: 0.8781; val_best_acc_score: 0.8600; val_best_f1_score: 0.8655; train_kl_reg_loss: 23532.4533; train_edge_recon_loss: 2709965.2148; train_gene_expr_recon_loss: 1794200.1521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4527697.8329; train_optim_loss: 4527697.8329; val_kl_reg_loss: 23422.4268; val_edge_recon_loss: 2775812.7442; val_gene_expr_recon_loss: 1778664.0756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4577899.2558; val_optim_loss: 4577899.2558
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9141; val_auprc_score: 0.8774; val_best_acc_score: 0.8569; val_best_f1_score: 0.8633; train_kl_reg_loss: 23521.0473; train_edge_recon_loss: 2712480.4302; train_gene_expr_recon_loss: 1776112.7598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4512114.2298; train_optim_loss: 4512114.2298; val_kl_reg_loss: 23388.1405; val_edge_recon_loss: 2784337.7616; val_gene_expr_recon_loss: 1765413.8401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4573139.7093; val_optim_loss: 4573139.7093
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9148; val_auprc_score: 0.8786; val_best_acc_score: 0.8574; val_best_f1_score: 0.8641; train_kl_reg_loss: 23512.3815; train_edge_recon_loss: 2715173.8035; train_gene_expr_recon_loss: 1766219.3084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4504905.4974; train_optim_loss: 4504905.4974; val_kl_reg_loss: 23404.1654; val_edge_recon_loss: 2781712.7267; val_gene_expr_recon_loss: 1757952.1424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4563069.0116; val_optim_loss: 4563069.0116
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9139; val_auprc_score: 0.8769; val_best_acc_score: 0.8574; val_best_f1_score: 0.8634; train_kl_reg_loss: 23514.1203; train_edge_recon_loss: 2714713.0313; train_gene_expr_recon_loss: 1759399.2033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4497626.3616; train_optim_loss: 4497626.3616; val_kl_reg_loss: 23442.2327; val_edge_recon_loss: 2781526.4535; val_gene_expr_recon_loss: 1749591.6570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4554560.3140; val_optim_loss: 4554560.3140
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9127; val_auprc_score: 0.8750; val_best_acc_score: 0.8562; val_best_f1_score: 0.8628; train_kl_reg_loss: 23527.6462; train_edge_recon_loss: 2713819.2448; train_gene_expr_recon_loss: 1751371.0183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4488717.8982; train_optim_loss: 4488717.8982; val_kl_reg_loss: 23520.0922; val_edge_recon_loss: 2781293.7384; val_gene_expr_recon_loss: 1747052.3314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4551866.2209; val_optim_loss: 4551866.2209
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9152; val_auprc_score: 0.8805; val_best_acc_score: 0.8572; val_best_f1_score: 0.8637; train_kl_reg_loss: 23528.4724; train_edge_recon_loss: 2713547.2977; train_gene_expr_recon_loss: 1744768.7970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4481844.5653; train_optim_loss: 4481844.5653; val_kl_reg_loss: 23403.4302; val_edge_recon_loss: 2783106.9477; val_gene_expr_recon_loss: 1740642.9390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4547153.3023; val_optim_loss: 4547153.3023
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9124; val_auprc_score: 0.8744; val_best_acc_score: 0.8567; val_best_f1_score: 0.8630; train_kl_reg_loss: 23515.4059; train_edge_recon_loss: 2714242.9014; train_gene_expr_recon_loss: 1743373.6965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4481131.9987; train_optim_loss: 4481131.9987; val_kl_reg_loss: 23426.7525; val_edge_recon_loss: 2783859.7035; val_gene_expr_recon_loss: 1735036.1541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4542322.6279; val_optim_loss: 4542322.6279
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9158; val_auprc_score: 0.8797; val_best_acc_score: 0.8586; val_best_f1_score: 0.8648; train_kl_reg_loss: 23534.6244; train_edge_recon_loss: 2713260.8597; train_gene_expr_recon_loss: 1739955.2787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4476750.7624; train_optim_loss: 4476750.7624; val_kl_reg_loss: 23461.0593; val_edge_recon_loss: 2776661.6628; val_gene_expr_recon_loss: 1735869.8953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4535992.6512; val_optim_loss: 4535992.6512
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9132; val_auprc_score: 0.8752; val_best_acc_score: 0.8580; val_best_f1_score: 0.8646; train_kl_reg_loss: 23531.3005; train_edge_recon_loss: 2712184.6775; train_gene_expr_recon_loss: 1739221.2905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4474937.2637; train_optim_loss: 4474937.2637; val_kl_reg_loss: 23500.6028; val_edge_recon_loss: 2779060.1221; val_gene_expr_recon_loss: 1734937.2529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4537497.9767; val_optim_loss: 4537497.9767
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9123; val_auprc_score: 0.8740; val_best_acc_score: 0.8557; val_best_f1_score: 0.8623; train_kl_reg_loss: 23522.6847; train_edge_recon_loss: 2711931.2572; train_gene_expr_recon_loss: 1736400.0995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471854.0431; train_optim_loss: 4471854.0431; val_kl_reg_loss: 23490.0111; val_edge_recon_loss: 2787275.7849; val_gene_expr_recon_loss: 1729599.7558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4540365.5233; val_optim_loss: 4540365.5233
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9113; val_auprc_score: 0.8724; val_best_acc_score: 0.8570; val_best_f1_score: 0.8637; train_kl_reg_loss: 23525.3053; train_edge_recon_loss: 2713556.1292; train_gene_expr_recon_loss: 1735666.3580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4472747.7977; train_optim_loss: 4472747.7977; val_kl_reg_loss: 23440.3403; val_edge_recon_loss: 2786160.0233; val_gene_expr_recon_loss: 1732153.5843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4541753.8953; val_optim_loss: 4541753.8953
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9134; val_auprc_score: 0.8759; val_best_acc_score: 0.8584; val_best_f1_score: 0.8642; train_kl_reg_loss: 23546.3506; train_edge_recon_loss: 2710963.2800; train_gene_expr_recon_loss: 1734647.0372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469156.6736; train_optim_loss: 4469156.6736; val_kl_reg_loss: 23472.2115; val_edge_recon_loss: 2780067.6163; val_gene_expr_recon_loss: 1730795.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4534334.8023; val_optim_loss: 4534334.8023
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9138; val_auprc_score: 0.8768; val_best_acc_score: 0.8575; val_best_f1_score: 0.8634; train_kl_reg_loss: 23528.4317; train_edge_recon_loss: 2713593.7213; train_gene_expr_recon_loss: 1735414.5392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4472536.6945; train_optim_loss: 4472536.6945; val_kl_reg_loss: 23429.6864; val_edge_recon_loss: 2784377.4767; val_gene_expr_recon_loss: 1730327.5930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4538134.7442; val_optim_loss: 4538134.7442
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9152; val_auprc_score: 0.8794; val_best_acc_score: 0.8568; val_best_f1_score: 0.8631; train_kl_reg_loss: 23524.7630; train_edge_recon_loss: 2715485.6540; train_gene_expr_recon_loss: 1734276.9465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4473287.3512; train_optim_loss: 4473287.3512; val_kl_reg_loss: 23473.1776; val_edge_recon_loss: 2774019.8372; val_gene_expr_recon_loss: 1731575.8023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4529068.7442; val_optim_loss: 4529068.7442
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9132; val_auprc_score: 0.8756; val_best_acc_score: 0.8556; val_best_f1_score: 0.8622; train_kl_reg_loss: 23532.8577; train_edge_recon_loss: 2712636.4145; train_gene_expr_recon_loss: 1733552.4768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469721.7376; train_optim_loss: 4469721.7376; val_kl_reg_loss: 23433.0238; val_edge_recon_loss: 2787144.7151; val_gene_expr_recon_loss: 1729317.3110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4539895.0233; val_optim_loss: 4539895.0233
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9139; val_auprc_score: 0.8773; val_best_acc_score: 0.8559; val_best_f1_score: 0.8621; train_kl_reg_loss: 23534.0865; train_edge_recon_loss: 2712440.8003; train_gene_expr_recon_loss: 1733484.9909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469459.8916; train_optim_loss: 4469459.8916; val_kl_reg_loss: 23479.9786; val_edge_recon_loss: 2783582.0523; val_gene_expr_recon_loss: 1729252.1948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4536314.2326; val_optim_loss: 4536314.2326
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9143; val_auprc_score: 0.8783; val_best_acc_score: 0.8581; val_best_f1_score: 0.8643; train_kl_reg_loss: 23500.9015; train_edge_recon_loss: 2712530.1704; train_gene_expr_recon_loss: 1733102.9328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469134.0131; train_optim_loss: 4469134.0131; val_kl_reg_loss: 23394.4765; val_edge_recon_loss: 2782068.6105; val_gene_expr_recon_loss: 1725991.5872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4531454.6860; val_optim_loss: 4531454.6860
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9145; val_auprc_score: 0.8773; val_best_acc_score: 0.8579; val_best_f1_score: 0.8648; train_kl_reg_loss: 23521.6055; train_edge_recon_loss: 2710933.3336; train_gene_expr_recon_loss: 1732835.2647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4467290.2050; train_optim_loss: 4467290.2050; val_kl_reg_loss: 23514.1811; val_edge_recon_loss: 2774156.3721; val_gene_expr_recon_loss: 1730255.0901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527925.6860; val_optim_loss: 4527925.6860
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9112; val_auprc_score: 0.8722; val_best_acc_score: 0.8565; val_best_f1_score: 0.8632; train_kl_reg_loss: 23529.3020; train_edge_recon_loss: 2710926.0914; train_gene_expr_recon_loss: 1732393.3189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4466848.6958; train_optim_loss: 4466848.6958; val_kl_reg_loss: 23510.7844; val_edge_recon_loss: 2787917.2093; val_gene_expr_recon_loss: 1730470.3837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4541898.3721; val_optim_loss: 4541898.3721
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9142; val_auprc_score: 0.8777; val_best_acc_score: 0.8575; val_best_f1_score: 0.8639; train_kl_reg_loss: 23529.6628; train_edge_recon_loss: 2712258.5894; train_gene_expr_recon_loss: 1733541.3518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469329.6097; train_optim_loss: 4469329.6097; val_kl_reg_loss: 23462.8041; val_edge_recon_loss: 2779034.9826; val_gene_expr_recon_loss: 1728638.7064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4531136.5581; val_optim_loss: 4531136.5581
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9131; val_auprc_score: 0.8760; val_best_acc_score: 0.8566; val_best_f1_score: 0.8627; train_kl_reg_loss: 23522.2261; train_edge_recon_loss: 2709805.9948; train_gene_expr_recon_loss: 1732354.8469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4465683.0653; train_optim_loss: 4465683.0653; val_kl_reg_loss: 23463.1884; val_edge_recon_loss: 2778952.3895; val_gene_expr_recon_loss: 1727843.7733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4530259.3256; val_optim_loss: 4530259.3256
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9183; val_auprc_score: 0.8833; val_best_acc_score: 0.8620; val_best_f1_score: 0.8677; train_kl_reg_loss: 23533.7896; train_edge_recon_loss: 2710238.7520; train_gene_expr_recon_loss: 1732792.8727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4466565.3982; train_optim_loss: 4466565.3982; val_kl_reg_loss: 23420.9199; val_edge_recon_loss: 2761201.4884; val_gene_expr_recon_loss: 1727553.2384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4512175.6279; val_optim_loss: 4512175.6279
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9124; val_auprc_score: 0.8758; val_best_acc_score: 0.8563; val_best_f1_score: 0.8630; train_kl_reg_loss: 23521.0064; train_edge_recon_loss: 2712189.6645; train_gene_expr_recon_loss: 1733050.2079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4468760.8590; train_optim_loss: 4468760.8590; val_kl_reg_loss: 23469.3770; val_edge_recon_loss: 2786736.4360; val_gene_expr_recon_loss: 1726757.4913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4536963.2791; val_optim_loss: 4536963.2791
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9144; val_auprc_score: 0.8787; val_best_acc_score: 0.8564; val_best_f1_score: 0.8634; train_kl_reg_loss: 23520.2294; train_edge_recon_loss: 2715064.8668; train_gene_expr_recon_loss: 1731568.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4470153.4008; train_optim_loss: 4470153.4008; val_kl_reg_loss: 23436.4298; val_edge_recon_loss: 2783553.5698; val_gene_expr_recon_loss: 1729201.2093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4536191.2093; val_optim_loss: 4536191.2093
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9134; val_auprc_score: 0.8757; val_best_acc_score: 0.8586; val_best_f1_score: 0.8643; train_kl_reg_loss: 23526.5374; train_edge_recon_loss: 2711539.4413; train_gene_expr_recon_loss: 1731697.4576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4466763.4399; train_optim_loss: 4466763.4399; val_kl_reg_loss: 23460.8148; val_edge_recon_loss: 2781937.1105; val_gene_expr_recon_loss: 1727164.9390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4532562.8023; val_optim_loss: 4532562.8023
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9141; val_auprc_score: 0.8779; val_best_acc_score: 0.8567; val_best_f1_score: 0.8633; train_kl_reg_loss: 23539.5685; train_edge_recon_loss: 2710013.7598; train_gene_expr_recon_loss: 1732883.4227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4466436.7467; train_optim_loss: 4466436.7467; val_kl_reg_loss: 23477.7936; val_edge_recon_loss: 2779968.7500; val_gene_expr_recon_loss: 1727269.6134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4530716.1628; val_optim_loss: 4530716.1628

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9151; val_auprc_score: 0.8792; val_best_acc_score: 0.8580; val_best_f1_score: 0.8639; train_kl_reg_loss: 23529.1752; train_edge_recon_loss: 2712472.9315; train_gene_expr_recon_loss: 1732861.7086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4468863.8120; train_optim_loss: 4468863.8120; val_kl_reg_loss: 23481.4226; val_edge_recon_loss: 2779454.0000; val_gene_expr_recon_loss: 1729200.2762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4532135.7093; val_optim_loss: 4532135.7093
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9133; val_auprc_score: 0.8758; val_best_acc_score: 0.8563; val_best_f1_score: 0.8629; train_kl_reg_loss: 23529.4329; train_edge_recon_loss: 2712680.9648; train_gene_expr_recon_loss: 1732792.6465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469003.0509; train_optim_loss: 4469003.0509; val_kl_reg_loss: 23455.8963; val_edge_recon_loss: 2786906.1744; val_gene_expr_recon_loss: 1726522.7297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4536884.8023; val_optim_loss: 4536884.8023
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9121; val_auprc_score: 0.8751; val_best_acc_score: 0.8544; val_best_f1_score: 0.8610; train_kl_reg_loss: 23539.4631; train_edge_recon_loss: 2712845.7885; train_gene_expr_recon_loss: 1731030.7928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4467416.0574; train_optim_loss: 4467416.0574; val_kl_reg_loss: 23440.7461; val_edge_recon_loss: 2786935.4942; val_gene_expr_recon_loss: 1730066.3895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4540442.6512; val_optim_loss: 4540442.6512
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9141; val_auprc_score: 0.8782; val_best_acc_score: 0.8574; val_best_f1_score: 0.8633; train_kl_reg_loss: 23518.7342; train_edge_recon_loss: 2713723.7807; train_gene_expr_recon_loss: 1733129.3854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4470371.9086; train_optim_loss: 4470371.9086; val_kl_reg_loss: 23415.5033; val_edge_recon_loss: 2783670.5814; val_gene_expr_recon_loss: 1726096.6657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4533182.7209; val_optim_loss: 4533182.7209

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 26 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9124
val AUPRC score: 0.8747
val best accuracy score: 0.8559
val best F1 score: 0.8628
val target rna MSE score: 0.6046
val source rna MSE score: 0.1451
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0771
Val cat covariate2 mean sim diff: nan

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
