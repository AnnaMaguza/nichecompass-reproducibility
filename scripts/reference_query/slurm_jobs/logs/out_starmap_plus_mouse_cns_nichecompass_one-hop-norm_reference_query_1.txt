Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9678; val_auprc_score: 0.9773; val_best_acc_score: 0.9589; val_best_f1_score: 0.9697; train_kl_reg_loss: 5800.9506; train_edge_recon_loss: 175225.6142; train_cat_covariates_contrastive_loss: 32235.4980; train_gene_expr_recon_loss: 88519.7515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301781.8145; train_optim_loss: 301781.8145; val_kl_reg_loss: 5673.8768; val_edge_recon_loss: 174651.3739; val_cat_covariates_contrastive_loss: 31823.9166; val_gene_expr_recon_loss: 88328.5952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 300477.7626; val_optim_loss: 300477.7626
[True]
Run timestamp: 07072023_185811_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference_query_reference_only', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 193574
Number of validation nodes: 21508
Number of training edges: 1323311
Number of validation edges: 147034
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9650; val_auprc_score: 0.9723; val_best_acc_score: 0.9526; val_best_f1_score: 0.9650; train_kl_reg_loss: 6580.2809; train_edge_recon_loss: 182506.1584; train_cat_covariates_contrastive_loss: 79843.4079; train_gene_expr_recon_loss: 105745.5169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374675.3634; train_optim_loss: 374675.3634; val_kl_reg_loss: 6052.1533; val_edge_recon_loss: 175646.2622; val_cat_covariates_contrastive_loss: 78852.0577; val_gene_expr_recon_loss: 94271.3510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 354821.8242; val_optim_loss: 354821.8242
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9663; val_auprc_score: 0.9723; val_best_acc_score: 0.9588; val_best_f1_score: 0.9695; train_kl_reg_loss: 6137.9284; train_edge_recon_loss: 175838.0391; train_cat_covariates_contrastive_loss: 79160.9764; train_gene_expr_recon_loss: 92402.2630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353539.2068; train_optim_loss: 353539.2068; val_kl_reg_loss: 5941.2310; val_edge_recon_loss: 174905.0582; val_cat_covariates_contrastive_loss: 78788.5234; val_gene_expr_recon_loss: 91101.2629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350736.0755; val_optim_loss: 350736.0755
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9707; val_auprc_score: 0.9800; val_best_acc_score: 0.9602; val_best_f1_score: 0.9706; train_kl_reg_loss: 5823.9982; train_edge_recon_loss: 175215.0097; train_cat_covariates_contrastive_loss: 32210.3215; train_gene_expr_recon_loss: 87986.5301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301235.8599; train_optim_loss: 301235.8599; val_kl_reg_loss: 5705.7588; val_edge_recon_loss: 174165.8575; val_cat_covariates_contrastive_loss: 31843.9472; val_gene_expr_recon_loss: 88081.3100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 299796.8743; val_optim_loss: 299796.8743
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9651; val_auprc_score: 0.9708; val_best_acc_score: 0.9616; val_best_f1_score: 0.9716; train_kl_reg_loss: 6127.0856; train_edge_recon_loss: 175422.5235; train_cat_covariates_contrastive_loss: 79146.6489; train_gene_expr_recon_loss: 90274.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350970.7017; train_optim_loss: 350970.7017; val_kl_reg_loss: 6086.0236; val_edge_recon_loss: 174723.2641; val_cat_covariates_contrastive_loss: 78724.7171; val_gene_expr_recon_loss: 89687.2690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349221.2767; val_optim_loss: 349221.2767
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9654; val_auprc_score: 0.9706; val_best_acc_score: 0.9631; val_best_f1_score: 0.9726; train_kl_reg_loss: 6135.9144; train_edge_recon_loss: 175116.2145; train_cat_covariates_contrastive_loss: 79151.7460; train_gene_expr_recon_loss: 89141.5466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349545.4213; train_optim_loss: 349545.4213; val_kl_reg_loss: 6078.1438; val_edge_recon_loss: 175228.0008; val_cat_covariates_contrastive_loss: 78809.3068; val_gene_expr_recon_loss: 88719.0535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348834.5072; val_optim_loss: 348834.5072
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9706; val_auprc_score: 0.9799; val_best_acc_score: 0.9595; val_best_f1_score: 0.9702; train_kl_reg_loss: 5848.6432; train_edge_recon_loss: 175018.4693; train_cat_covariates_contrastive_loss: 32204.4103; train_gene_expr_recon_loss: 87584.3400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 300655.8627; train_optim_loss: 300655.8627; val_kl_reg_loss: 5849.5912; val_edge_recon_loss: 174434.1196; val_cat_covariates_contrastive_loss: 31859.7577; val_gene_expr_recon_loss: 87703.2514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 299846.7194; val_optim_loss: 299846.7194
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9657; val_auprc_score: 0.9708; val_best_acc_score: 0.9637; val_best_f1_score: 0.9732; train_kl_reg_loss: 6158.4693; train_edge_recon_loss: 175016.5840; train_cat_covariates_contrastive_loss: 79154.2592; train_gene_expr_recon_loss: 88427.3857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348756.6976; train_optim_loss: 348756.6976; val_kl_reg_loss: 6101.2374; val_edge_recon_loss: 174276.3910; val_cat_covariates_contrastive_loss: 78794.1917; val_gene_expr_recon_loss: 88200.4779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347372.2973; val_optim_loss: 347372.2973
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9708; val_auprc_score: 0.9802; val_best_acc_score: 0.9604; val_best_f1_score: 0.9708; train_kl_reg_loss: 5882.1130; train_edge_recon_loss: 174891.9433; train_cat_covariates_contrastive_loss: 32183.7237; train_gene_expr_recon_loss: 87281.4695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 300239.2495; train_optim_loss: 300239.2495; val_kl_reg_loss: 5852.1141; val_edge_recon_loss: 174323.8413; val_cat_covariates_contrastive_loss: 31850.5642; val_gene_expr_recon_loss: 87563.9589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 299590.4783; val_optim_loss: 299590.4783
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9649; val_auprc_score: 0.9700; val_best_acc_score: 0.9646; val_best_f1_score: 0.9738; train_kl_reg_loss: 6176.8619; train_edge_recon_loss: 174996.9046; train_cat_covariates_contrastive_loss: 79146.5919; train_gene_expr_recon_loss: 87985.0214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348305.3794; train_optim_loss: 348305.3794; val_kl_reg_loss: 6155.7881; val_edge_recon_loss: 174172.9329; val_cat_covariates_contrastive_loss: 78806.8570; val_gene_expr_recon_loss: 87882.3190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347017.8967; val_optim_loss: 347017.8967
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9657; val_auprc_score: 0.9708; val_best_acc_score: 0.9645; val_best_f1_score: 0.9737; train_kl_reg_loss: 6201.0091; train_edge_recon_loss: 174637.5823; train_cat_covariates_contrastive_loss: 79141.2835; train_gene_expr_recon_loss: 87620.0540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347599.9295; train_optim_loss: 347599.9295; val_kl_reg_loss: 6233.8261; val_edge_recon_loss: 174734.0660; val_cat_covariates_contrastive_loss: 78842.1893; val_gene_expr_recon_loss: 87601.1126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347411.1936; val_optim_loss: 347411.1936
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9710; val_auprc_score: 0.9805; val_best_acc_score: 0.9609; val_best_f1_score: 0.9712; train_kl_reg_loss: 5902.3798; train_edge_recon_loss: 174851.2922; train_cat_covariates_contrastive_loss: 32174.9901; train_gene_expr_recon_loss: 87093.7950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 300022.4576; train_optim_loss: 300022.4576; val_kl_reg_loss: 5884.0100; val_edge_recon_loss: 174050.4097; val_cat_covariates_contrastive_loss: 31894.4209; val_gene_expr_recon_loss: 87385.1905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 299214.0310; val_optim_loss: 299214.0310
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9665; val_auprc_score: 0.9716; val_best_acc_score: 0.9652; val_best_f1_score: 0.9742; train_kl_reg_loss: 6228.1336; train_edge_recon_loss: 174738.0609; train_cat_covariates_contrastive_loss: 79145.4106; train_gene_expr_recon_loss: 87319.3115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347430.9160; train_optim_loss: 347430.9160; val_kl_reg_loss: 6254.4278; val_edge_recon_loss: 174824.6708; val_cat_covariates_contrastive_loss: 78852.4615; val_gene_expr_recon_loss: 87344.2772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347275.8357; val_optim_loss: 347275.8357
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9657; val_auprc_score: 0.9698; val_best_acc_score: 0.9671; val_best_f1_score: 0.9756; train_kl_reg_loss: 6250.9517; train_edge_recon_loss: 174639.8992; train_cat_covariates_contrastive_loss: 79143.7016; train_gene_expr_recon_loss: 87055.5351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347090.0874; train_optim_loss: 347090.0874; val_kl_reg_loss: 6292.8334; val_edge_recon_loss: 173690.8369; val_cat_covariates_contrastive_loss: 78769.1775; val_gene_expr_recon_loss: 87211.1365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345963.9842; val_optim_loss: 345963.9842
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9711; val_auprc_score: 0.9803; val_best_acc_score: 0.9617; val_best_f1_score: 0.9718; train_kl_reg_loss: 5934.3955; train_edge_recon_loss: 174889.1112; train_cat_covariates_contrastive_loss: 32181.7413; train_gene_expr_recon_loss: 86893.9630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299899.2111; train_optim_loss: 299899.2111; val_kl_reg_loss: 5897.6126; val_edge_recon_loss: 173788.8627; val_cat_covariates_contrastive_loss: 31861.0340; val_gene_expr_recon_loss: 87344.2046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 298891.7146; val_optim_loss: 298891.7146
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9665; val_auprc_score: 0.9710; val_best_acc_score: 0.9672; val_best_f1_score: 0.9756; train_kl_reg_loss: 6258.6803; train_edge_recon_loss: 174858.3376; train_cat_covariates_contrastive_loss: 79129.3951; train_gene_expr_recon_loss: 86852.2905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347098.7034; train_optim_loss: 347098.7034; val_kl_reg_loss: 6289.5675; val_edge_recon_loss: 174289.2308; val_cat_covariates_contrastive_loss: 78812.5648; val_gene_expr_recon_loss: 87057.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346449.0477; val_optim_loss: 346449.0477
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9662; val_auprc_score: 0.9708; val_best_acc_score: 0.9661; val_best_f1_score: 0.9748; train_kl_reg_loss: 6290.9037; train_edge_recon_loss: 174898.8890; train_cat_covariates_contrastive_loss: 79146.3186; train_gene_expr_recon_loss: 86713.5011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347049.6123; train_optim_loss: 347049.6123; val_kl_reg_loss: 6117.6490; val_edge_recon_loss: 175193.7628; val_cat_covariates_contrastive_loss: 78827.0605; val_gene_expr_recon_loss: 86844.2152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346982.6884; val_optim_loss: 346982.6884
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9695; val_auprc_score: 0.9792; val_best_acc_score: 0.9615; val_best_f1_score: 0.9716; train_kl_reg_loss: 5953.7822; train_edge_recon_loss: 174648.0011; train_cat_covariates_contrastive_loss: 32177.8383; train_gene_expr_recon_loss: 86665.3303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299444.9520; train_optim_loss: 299444.9520; val_kl_reg_loss: 5935.2824; val_edge_recon_loss: 174180.0811; val_cat_covariates_contrastive_loss: 31809.1792; val_gene_expr_recon_loss: 87145.6472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 299070.1901; val_optim_loss: 299070.1901
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9664; val_auprc_score: 0.9707; val_best_acc_score: 0.9675; val_best_f1_score: 0.9759; train_kl_reg_loss: 6304.2874; train_edge_recon_loss: 174781.4188; train_cat_covariates_contrastive_loss: 79142.2770; train_gene_expr_recon_loss: 86574.9703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346802.9534; train_optim_loss: 346802.9534; val_kl_reg_loss: 6268.5255; val_edge_recon_loss: 173773.7256; val_cat_covariates_contrastive_loss: 78793.2096; val_gene_expr_recon_loss: 86926.6040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345762.0655; val_optim_loss: 345762.0655
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9662; val_auprc_score: 0.9711; val_best_acc_score: 0.9675; val_best_f1_score: 0.9759; train_kl_reg_loss: 6309.3627; train_edge_recon_loss: 174605.2266; train_cat_covariates_contrastive_loss: 79118.0589; train_gene_expr_recon_loss: 86442.6217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346475.2697; train_optim_loss: 346475.2697; val_kl_reg_loss: 6158.4741; val_edge_recon_loss: 174003.6657; val_cat_covariates_contrastive_loss: 78853.0396; val_gene_expr_recon_loss: 86618.7535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345633.9323; val_optim_loss: 345633.9323
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9720; val_auprc_score: 0.9809; val_best_acc_score: 0.9618; val_best_f1_score: 0.9718; train_kl_reg_loss: 5976.2130; train_edge_recon_loss: 174886.3231; train_cat_covariates_contrastive_loss: 32169.2813; train_gene_expr_recon_loss: 86558.1879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299590.0053; train_optim_loss: 299590.0053; val_kl_reg_loss: 5930.7405; val_edge_recon_loss: 174035.3234; val_cat_covariates_contrastive_loss: 31856.5206; val_gene_expr_recon_loss: 87159.4871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 298982.0710; val_optim_loss: 298982.0710
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9667; val_auprc_score: 0.9716; val_best_acc_score: 0.9672; val_best_f1_score: 0.9756; train_kl_reg_loss: 6324.3283; train_edge_recon_loss: 174791.0186; train_cat_covariates_contrastive_loss: 79123.5954; train_gene_expr_recon_loss: 86349.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346587.9749; train_optim_loss: 346587.9749; val_kl_reg_loss: 6309.1866; val_edge_recon_loss: 174294.1084; val_cat_covariates_contrastive_loss: 78878.3955; val_gene_expr_recon_loss: 86502.5088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345984.2003; val_optim_loss: 345984.2003
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9657; val_auprc_score: 0.9703; val_best_acc_score: 0.9675; val_best_f1_score: 0.9759; train_kl_reg_loss: 6336.2965; train_edge_recon_loss: 174435.4636; train_cat_covariates_contrastive_loss: 79125.0752; train_gene_expr_recon_loss: 86233.7268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346130.5621; train_optim_loss: 346130.5621; val_kl_reg_loss: 6421.1750; val_edge_recon_loss: 174143.4136; val_cat_covariates_contrastive_loss: 78809.3570; val_gene_expr_recon_loss: 86478.1564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345852.1013; val_optim_loss: 345852.1013
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9702; val_auprc_score: 0.9798; val_best_acc_score: 0.9613; val_best_f1_score: 0.9714; train_kl_reg_loss: 5992.0351; train_edge_recon_loss: 174782.1172; train_cat_covariates_contrastive_loss: 32166.7334; train_gene_expr_recon_loss: 86389.6317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299330.5175; train_optim_loss: 299330.5175; val_kl_reg_loss: 5950.9953; val_edge_recon_loss: 174732.9201; val_cat_covariates_contrastive_loss: 31838.2563; val_gene_expr_recon_loss: 87000.5262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 299522.6988; val_optim_loss: 299522.6988
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9665; val_auprc_score: 0.9708; val_best_acc_score: 0.9677; val_best_f1_score: 0.9760; train_kl_reg_loss: 6342.6498; train_edge_recon_loss: 174433.2271; train_cat_covariates_contrastive_loss: 79105.4020; train_gene_expr_recon_loss: 86171.5286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346052.8074; train_optim_loss: 346052.8074; val_kl_reg_loss: 6319.7544; val_edge_recon_loss: 174297.7707; val_cat_covariates_contrastive_loss: 78840.0505; val_gene_expr_recon_loss: 86615.4135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346072.9891; val_optim_loss: 346072.9891
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9680; val_auprc_score: 0.9722; val_best_acc_score: 0.9684; val_best_f1_score: 0.9766; train_kl_reg_loss: 6358.4948; train_edge_recon_loss: 174681.1052; train_cat_covariates_contrastive_loss: 79125.9306; train_gene_expr_recon_loss: 86086.7690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346252.2992; train_optim_loss: 346252.2992; val_kl_reg_loss: 6376.1149; val_edge_recon_loss: 173692.3775; val_cat_covariates_contrastive_loss: 78855.8541; val_gene_expr_recon_loss: 86548.1373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345472.4839; val_optim_loss: 345472.4839
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9712; val_auprc_score: 0.9806; val_best_acc_score: 0.9614; val_best_f1_score: 0.9715; train_kl_reg_loss: 6010.9843; train_edge_recon_loss: 174640.1087; train_cat_covariates_contrastive_loss: 32167.8337; train_gene_expr_recon_loss: 86307.9944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299126.9211; train_optim_loss: 299126.9211; val_kl_reg_loss: 5969.5786; val_edge_recon_loss: 174531.2051; val_cat_covariates_contrastive_loss: 31817.3462; val_gene_expr_recon_loss: 86960.5207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 299278.6497; val_optim_loss: 299278.6497
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9665; val_auprc_score: 0.9712; val_best_acc_score: 0.9677; val_best_f1_score: 0.9761; train_kl_reg_loss: 6368.6919; train_edge_recon_loss: 174505.4181; train_cat_covariates_contrastive_loss: 79110.7141; train_gene_expr_recon_loss: 85977.0017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345961.8256; train_optim_loss: 345961.8256; val_kl_reg_loss: 6408.2001; val_edge_recon_loss: 173573.3328; val_cat_covariates_contrastive_loss: 78787.7316; val_gene_expr_recon_loss: 86299.1414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345068.4049; val_optim_loss: 345068.4049

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9703; val_auprc_score: 0.9799; val_best_acc_score: 0.9622; val_best_f1_score: 0.9721; train_kl_reg_loss: 6021.5145; train_edge_recon_loss: 174770.2930; train_cat_covariates_contrastive_loss: 32155.5428; train_gene_expr_recon_loss: 85821.2228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 298768.5727; train_optim_loss: 298768.5727; val_kl_reg_loss: 5997.5515; val_edge_recon_loss: 174251.4173; val_cat_covariates_contrastive_loss: 31855.5956; val_gene_expr_recon_loss: 86814.4822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 298919.0469; val_optim_loss: 298919.0469
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9673; val_auprc_score: 0.9717; val_best_acc_score: 0.9682; val_best_f1_score: 0.9764; train_kl_reg_loss: 6379.0298; train_edge_recon_loss: 174661.7034; train_cat_covariates_contrastive_loss: 79102.0369; train_gene_expr_recon_loss: 85928.7102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346071.4803; train_optim_loss: 346071.4803; val_kl_reg_loss: 6360.1489; val_edge_recon_loss: 174134.8317; val_cat_covariates_contrastive_loss: 78884.7040; val_gene_expr_recon_loss: 86393.7365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345773.4221; val_optim_loss: 345773.4221
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9675; val_auprc_score: 0.9722; val_best_acc_score: 0.9674; val_best_f1_score: 0.9758; train_kl_reg_loss: 6384.5940; train_edge_recon_loss: 174465.7489; train_cat_covariates_contrastive_loss: 79100.6391; train_gene_expr_recon_loss: 85874.6560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345825.6373; train_optim_loss: 345825.6373; val_kl_reg_loss: 6359.6967; val_edge_recon_loss: 175121.5168; val_cat_covariates_contrastive_loss: 78851.6798; val_gene_expr_recon_loss: 86291.6058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346624.4987; val_optim_loss: 346624.4987
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9688; val_auprc_score: 0.9789; val_best_acc_score: 0.9617; val_best_f1_score: 0.9718; train_kl_reg_loss: 6017.1535; train_edge_recon_loss: 174655.9204; train_cat_covariates_contrastive_loss: 32163.9073; train_gene_expr_recon_loss: 85716.4128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 298553.3941; train_optim_loss: 298553.3941; val_kl_reg_loss: 5950.6303; val_edge_recon_loss: 173915.8697; val_cat_covariates_contrastive_loss: 31834.3765; val_gene_expr_recon_loss: 86771.8652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 298472.7424; val_optim_loss: 298472.7424
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9652; val_auprc_score: 0.9695; val_best_acc_score: 0.9679; val_best_f1_score: 0.9762; train_kl_reg_loss: 6388.6773; train_edge_recon_loss: 174355.8640; train_cat_covariates_contrastive_loss: 79099.9105; train_gene_expr_recon_loss: 85839.2703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345683.7220; train_optim_loss: 345683.7220; val_kl_reg_loss: 6409.1447; val_edge_recon_loss: 174042.5405; val_cat_covariates_contrastive_loss: 78800.5363; val_gene_expr_recon_loss: 86138.0203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345390.2415; val_optim_loss: 345390.2415
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9672; val_auprc_score: 0.9717; val_best_acc_score: 0.9684; val_best_f1_score: 0.9766; train_kl_reg_loss: 6406.6108; train_edge_recon_loss: 174571.9820; train_cat_covariates_contrastive_loss: 79104.0115; train_gene_expr_recon_loss: 85768.5446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345851.1485; train_optim_loss: 345851.1485; val_kl_reg_loss: 6256.9591; val_edge_recon_loss: 173893.0975; val_cat_covariates_contrastive_loss: 78854.7365; val_gene_expr_recon_loss: 86364.5390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345369.3322; val_optim_loss: 345369.3322
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9704; val_auprc_score: 0.9800; val_best_acc_score: 0.9621; val_best_f1_score: 0.9720; train_kl_reg_loss: 6017.9214; train_edge_recon_loss: 174707.1590; train_cat_covariates_contrastive_loss: 32161.7234; train_gene_expr_recon_loss: 85655.4271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 298542.2300; train_optim_loss: 298542.2300; val_kl_reg_loss: 5957.8951; val_edge_recon_loss: 173902.3058; val_cat_covariates_contrastive_loss: 31825.8984; val_gene_expr_recon_loss: 86736.3145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 298422.4128; val_optim_loss: 298422.4128
