Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--query_batches', 'batch4', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '03092023_010847_6', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 75351
Number of validation nodes: 8372
Number of training edges: 175771
Number of validation edges: 19530
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7239; val_auprc_score: 0.7405; val_best_acc_score: 0.6420; val_best_f1_score: 0.7281; train_kl_reg_loss: 62374.1309; train_edge_recon_loss: 3454842.7209; train_gene_expr_recon_loss: 14194815.4680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17712032.3023; train_optim_loss: 17712032.3023; val_kl_reg_loss: 46329.1544; val_edge_recon_loss: 3531783.2436; val_gene_expr_recon_loss: 8963525.0128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12541637.3846; val_optim_loss: 12541637.3846
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7228; val_auprc_score: 0.7402; val_best_acc_score: 0.6420; val_best_f1_score: 0.7270; train_kl_reg_loss: 61915.9937; train_edge_recon_loss: 3453383.9985; train_gene_expr_recon_loss: 10037808.4651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 13553108.4680; train_optim_loss: 13553108.4680; val_kl_reg_loss: 44034.9997; val_edge_recon_loss: 3536145.7885; val_gene_expr_recon_loss: 7342176.8974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10922357.7692; val_optim_loss: 10922357.7692
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7226; val_auprc_score: 0.7390; val_best_acc_score: 0.6418; val_best_f1_score: 0.7274; train_kl_reg_loss: 58986.5802; train_edge_recon_loss: 3452965.3605; train_gene_expr_recon_loss: 8985150.7747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12497102.7355; train_optim_loss: 12497102.7355; val_kl_reg_loss: 43240.1781; val_edge_recon_loss: 3533769.9038; val_gene_expr_recon_loss: 6646272.9615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 10223283.0769; val_optim_loss: 10223283.0769
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7236; val_auprc_score: 0.7386; val_best_acc_score: 0.6418; val_best_f1_score: 0.7275; train_kl_reg_loss: 52562.5149; train_edge_recon_loss: 3451916.9201; train_gene_expr_recon_loss: 8473741.4070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11978220.8401; train_optim_loss: 11978220.8401; val_kl_reg_loss: 46488.5993; val_edge_recon_loss: 3533733.2628; val_gene_expr_recon_loss: 6219093.2821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 9799315.0769; val_optim_loss: 9799315.0769
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7239; val_auprc_score: 0.7393; val_best_acc_score: 0.6429; val_best_f1_score: 0.7287; train_kl_reg_loss: 53436.5141; train_edge_recon_loss: 3450828.0749; train_gene_expr_recon_loss: 8108266.3779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11612530.9535; train_optim_loss: 11612530.9535; val_kl_reg_loss: 40671.1818; val_edge_recon_loss: 3528468.7436; val_gene_expr_recon_loss: 5954807.8974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 9523947.7436; val_optim_loss: 9523947.7436
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7220; val_auprc_score: 0.7381; val_best_acc_score: 0.6428; val_best_f1_score: 0.7288; train_kl_reg_loss: 59461.3404; train_edge_recon_loss: 3452675.7943; train_gene_expr_recon_loss: 7844859.0828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11356996.2122; train_optim_loss: 11356996.2122; val_kl_reg_loss: 47323.3260; val_edge_recon_loss: 3533701.2756; val_gene_expr_recon_loss: 5692976.3718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 9274000.8718; val_optim_loss: 9274000.8718
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7240; val_auprc_score: 0.7397; val_best_acc_score: 0.6432; val_best_f1_score: 0.7288; train_kl_reg_loss: 58008.9509; train_edge_recon_loss: 3452665.2747; train_gene_expr_recon_loss: 7642086.2282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11152760.4302; train_optim_loss: 11152760.4302; val_kl_reg_loss: 50770.9111; val_edge_recon_loss: 3527457.5128; val_gene_expr_recon_loss: 5519571.4615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 9097799.9487; val_optim_loss: 9097799.9487
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7237; val_auprc_score: 0.7406; val_best_acc_score: 0.6429; val_best_f1_score: 0.7288; train_kl_reg_loss: 56973.6213; train_edge_recon_loss: 3451959.1068; train_gene_expr_recon_loss: 7470831.6962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10979764.4215; train_optim_loss: 10979764.4215; val_kl_reg_loss: 49256.4811; val_edge_recon_loss: 3531412.4038; val_gene_expr_recon_loss: 5372305.7949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8952974.6667; val_optim_loss: 8952974.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7208; val_auprc_score: 0.7380; val_best_acc_score: 0.6404; val_best_f1_score: 0.7270; train_kl_reg_loss: 59794.9798; train_edge_recon_loss: 3453977.0094; train_gene_expr_recon_loss: 7343444.6701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10857216.6512; train_optim_loss: 10857216.6512; val_kl_reg_loss: 56102.0356; val_edge_recon_loss: 3533562.4038; val_gene_expr_recon_loss: 5265916.6923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8855581.1795; val_optim_loss: 8855581.1795
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7238; val_auprc_score: 0.7409; val_best_acc_score: 0.6426; val_best_f1_score: 0.7280; train_kl_reg_loss: 55662.2994; train_edge_recon_loss: 3452539.8983; train_gene_expr_recon_loss: 7239667.0145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10747869.1831; train_optim_loss: 10747869.1831; val_kl_reg_loss: 39746.5180; val_edge_recon_loss: 3533899.1603; val_gene_expr_recon_loss: 5156782.7179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8730428.4231; val_optim_loss: 8730428.4231
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7205; val_auprc_score: 0.7360; val_best_acc_score: 0.6426; val_best_f1_score: 0.7281; train_kl_reg_loss: 57660.6545; train_edge_recon_loss: 3454972.1693; train_gene_expr_recon_loss: 7152089.2980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10664722.1395; train_optim_loss: 10664722.1395; val_kl_reg_loss: 43094.3820; val_edge_recon_loss: 3536050.2436; val_gene_expr_recon_loss: 5087857.4359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8667002.0897; val_optim_loss: 8667002.0897
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7234; val_auprc_score: 0.7396; val_best_acc_score: 0.6431; val_best_f1_score: 0.7285; train_kl_reg_loss: 54941.0768; train_edge_recon_loss: 3453775.4608; train_gene_expr_recon_loss: 7089288.4259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10598004.9767; train_optim_loss: 10598004.9767; val_kl_reg_loss: 54774.2488; val_edge_recon_loss: 3531307.9295; val_gene_expr_recon_loss: 5007710.5641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8593792.6923; val_optim_loss: 8593792.6923
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7241; val_auprc_score: 0.7386; val_best_acc_score: 0.6434; val_best_f1_score: 0.7290; train_kl_reg_loss: 58268.3107; train_edge_recon_loss: 3454371.8212; train_gene_expr_recon_loss: 7015470.5015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10528110.6512; train_optim_loss: 10528110.6512; val_kl_reg_loss: 54009.7846; val_edge_recon_loss: 3524599.3269; val_gene_expr_recon_loss: 4971173.7179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8549782.8205; val_optim_loss: 8549782.8205
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7242; val_auprc_score: 0.7389; val_best_acc_score: 0.6453; val_best_f1_score: 0.7291; train_kl_reg_loss: 59591.2112; train_edge_recon_loss: 3451460.3852; train_gene_expr_recon_loss: 6984962.5683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10496014.1977; train_optim_loss: 10496014.1977; val_kl_reg_loss: 53851.2409; val_edge_recon_loss: 3522384.1026; val_gene_expr_recon_loss: 4931010.1795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8507245.5897; val_optim_loss: 8507245.5897
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7240; val_auprc_score: 0.7395; val_best_acc_score: 0.6435; val_best_f1_score: 0.7293; train_kl_reg_loss: 59569.7101; train_edge_recon_loss: 3451706.6141; train_gene_expr_recon_loss: 6951165.0727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10462441.3924; train_optim_loss: 10462441.3924; val_kl_reg_loss: 48242.0748; val_edge_recon_loss: 3526393.1346; val_gene_expr_recon_loss: 4889907.9872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8464543.1923; val_optim_loss: 8464543.1923
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7239; val_auprc_score: 0.7404; val_best_acc_score: 0.6438; val_best_f1_score: 0.7287; train_kl_reg_loss: 57031.3046; train_edge_recon_loss: 3454040.7733; train_gene_expr_recon_loss: 6900657.8401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10411729.9390; train_optim_loss: 10411729.9390; val_kl_reg_loss: 66088.0926; val_edge_recon_loss: 3527107.4038; val_gene_expr_recon_loss: 4873038.8462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8466234.4103; val_optim_loss: 8466234.4103
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7253; val_auprc_score: 0.7416; val_best_acc_score: 0.6440; val_best_f1_score: 0.7289; train_kl_reg_loss: 59966.4319; train_edge_recon_loss: 3455969.1308; train_gene_expr_recon_loss: 6890155.6701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10406091.2384; train_optim_loss: 10406091.2384; val_kl_reg_loss: 37817.9600; val_edge_recon_loss: 3527135.0385; val_gene_expr_recon_loss: 4850747.3205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8415700.3077; val_optim_loss: 8415700.3077
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7235; val_auprc_score: 0.7400; val_best_acc_score: 0.6423; val_best_f1_score: 0.7274; train_kl_reg_loss: 56556.4646; train_edge_recon_loss: 3455191.8554; train_gene_expr_recon_loss: 6870281.2645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10382029.5872; train_optim_loss: 10382029.5872; val_kl_reg_loss: 41085.6652; val_edge_recon_loss: 3529905.3654; val_gene_expr_recon_loss: 4837935.4231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8408926.5385; val_optim_loss: 8408926.5385
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7228; val_auprc_score: 0.7391; val_best_acc_score: 0.6413; val_best_f1_score: 0.7273; train_kl_reg_loss: 56759.3376; train_edge_recon_loss: 3454565.0778; train_gene_expr_recon_loss: 6848039.0988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10359363.5058; train_optim_loss: 10359363.5058; val_kl_reg_loss: 49051.2204; val_edge_recon_loss: 3535264.0705; val_gene_expr_recon_loss: 4829582.4231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8413897.7051; val_optim_loss: 8413897.7051
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7221; val_auprc_score: 0.7381; val_best_acc_score: 0.6420; val_best_f1_score: 0.7278; train_kl_reg_loss: 59539.5169; train_edge_recon_loss: 3450874.8016; train_gene_expr_recon_loss: 6820403.4884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10330817.7965; train_optim_loss: 10330817.7965; val_kl_reg_loss: 44509.1122; val_edge_recon_loss: 3533255.4231; val_gene_expr_recon_loss: 4797830.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8375595.3718; val_optim_loss: 8375595.3718
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7232; val_auprc_score: 0.7384; val_best_acc_score: 0.6423; val_best_f1_score: 0.7280; train_kl_reg_loss: 57013.4065; train_edge_recon_loss: 3455823.8103; train_gene_expr_recon_loss: 6812357.0015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10325194.2209; train_optim_loss: 10325194.2209; val_kl_reg_loss: 48997.8760; val_edge_recon_loss: 3535472.4295; val_gene_expr_recon_loss: 4799066.7821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8383537.0897; val_optim_loss: 8383537.0897
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7233; val_auprc_score: 0.7398; val_best_acc_score: 0.6433; val_best_f1_score: 0.7289; train_kl_reg_loss: 59193.4049; train_edge_recon_loss: 3453154.9077; train_gene_expr_recon_loss: 6803957.4128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10316305.6802; train_optim_loss: 10316305.6802; val_kl_reg_loss: 53012.8517; val_edge_recon_loss: 3531220.7692; val_gene_expr_recon_loss: 4804501.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8388734.7692; val_optim_loss: 8388734.7692
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7212; val_auprc_score: 0.7365; val_best_acc_score: 0.6435; val_best_f1_score: 0.7281; train_kl_reg_loss: 55098.9304; train_edge_recon_loss: 3456282.4360; train_gene_expr_recon_loss: 6796128.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10307510.3285; train_optim_loss: 10307510.3285; val_kl_reg_loss: 38951.5063; val_edge_recon_loss: 3528946.6090; val_gene_expr_recon_loss: 4785004.2051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8352902.3333; val_optim_loss: 8352902.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7245; val_auprc_score: 0.7398; val_best_acc_score: 0.6430; val_best_f1_score: 0.7288; train_kl_reg_loss: 58103.2128; train_edge_recon_loss: 3452928.2827; train_gene_expr_recon_loss: 6780833.0378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10291864.5233; train_optim_loss: 10291864.5233; val_kl_reg_loss: 42289.7612; val_edge_recon_loss: 3530090.6346; val_gene_expr_recon_loss: 4791017.0513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8363397.4487; val_optim_loss: 8363397.4487
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7216; val_auprc_score: 0.7390; val_best_acc_score: 0.6422; val_best_f1_score: 0.7274; train_kl_reg_loss: 53431.4118; train_edge_recon_loss: 3452221.9891; train_gene_expr_recon_loss: 6784978.1831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10290631.6134; train_optim_loss: 10290631.6134; val_kl_reg_loss: 46335.6491; val_edge_recon_loss: 3532468.9679; val_gene_expr_recon_loss: 4771174.5897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8349979.1923; val_optim_loss: 8349979.1923
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.6981; val_auprc_score: 0.6908; val_best_acc_score: 0.6436; val_best_f1_score: 0.7290; train_kl_reg_loss: 58912.9956; train_edge_recon_loss: 3502464.8626; train_gene_expr_recon_loss: 3196532.8583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6757910.7151; train_optim_loss: 6757910.7151; val_kl_reg_loss: 39499.3669; val_edge_recon_loss: 3537676.8397; val_gene_expr_recon_loss: 2850410.6218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6427586.8462; val_optim_loss: 6427586.8462
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7001; val_auprc_score: 0.6924; val_best_acc_score: 0.6434; val_best_f1_score: 0.7287; train_kl_reg_loss: 57299.3381; train_edge_recon_loss: 3499717.5487; train_gene_expr_recon_loss: 3095248.1272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6652265.0218; train_optim_loss: 6652265.0218; val_kl_reg_loss: 43502.7853; val_edge_recon_loss: 3536778.4872; val_gene_expr_recon_loss: 2790089.2821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6370370.5513; val_optim_loss: 6370370.5513
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.6995; val_auprc_score: 0.6919; val_best_acc_score: 0.6427; val_best_f1_score: 0.7278; train_kl_reg_loss: 56763.5134; train_edge_recon_loss: 3500010.9310; train_gene_expr_recon_loss: 3049761.2529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6606535.6962; train_optim_loss: 6606535.6962; val_kl_reg_loss: 44777.2896; val_edge_recon_loss: 3539426.5705; val_gene_expr_recon_loss: 2756264.5897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6340468.4359; val_optim_loss: 6340468.4359
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.6934; val_auprc_score: 0.6887; val_best_acc_score: 0.6381; val_best_f1_score: 0.7258; train_kl_reg_loss: 56629.0961; train_edge_recon_loss: 3496349.8626; train_gene_expr_recon_loss: 3018377.8118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6571356.7602; train_optim_loss: 6571356.7602; val_kl_reg_loss: 45543.7377; val_edge_recon_loss: 3554672.3269; val_gene_expr_recon_loss: 2734991.8654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6335207.9359; val_optim_loss: 6335207.9359
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.6944; val_auprc_score: 0.6878; val_best_acc_score: 0.6411; val_best_f1_score: 0.7280; train_kl_reg_loss: 59138.8135; train_edge_recon_loss: 3497209.8001; train_gene_expr_recon_loss: 2997825.4658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6554174.0858; train_optim_loss: 6554174.0858; val_kl_reg_loss: 47935.3367; val_edge_recon_loss: 3546197.0513; val_gene_expr_recon_loss: 2706560.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6300693.2821; val_optim_loss: 6300693.2821
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.6964; val_auprc_score: 0.6894; val_best_acc_score: 0.6428; val_best_f1_score: 0.7283; train_kl_reg_loss: 60666.8798; train_edge_recon_loss: 3497212.4019; train_gene_expr_recon_loss: 2978370.5116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6536249.7951; train_optim_loss: 6536249.7951; val_kl_reg_loss: 49167.8202; val_edge_recon_loss: 3543112.9615; val_gene_expr_recon_loss: 2704445.5192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6296726.2949; val_optim_loss: 6296726.2949
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.6979; val_auprc_score: 0.6894; val_best_acc_score: 0.6426; val_best_f1_score: 0.7282; train_kl_reg_loss: 54586.9343; train_edge_recon_loss: 3498020.5065; train_gene_expr_recon_loss: 2961792.4273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6514399.8648; train_optim_loss: 6514399.8648; val_kl_reg_loss: 46629.7545; val_edge_recon_loss: 3542212.0513; val_gene_expr_recon_loss: 2689795.1026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6278636.9231; val_optim_loss: 6278636.9231
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.6997; val_auprc_score: 0.6927; val_best_acc_score: 0.6428; val_best_f1_score: 0.7283; train_kl_reg_loss: 49559.4834; train_edge_recon_loss: 3499850.6657; train_gene_expr_recon_loss: 2947546.6221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6496956.7747; train_optim_loss: 6496956.7747; val_kl_reg_loss: 44014.1207; val_edge_recon_loss: 3536513.0192; val_gene_expr_recon_loss: 2675287.1154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6255814.2051; val_optim_loss: 6255814.2051
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.6965; val_auprc_score: 0.6898; val_best_acc_score: 0.6399; val_best_f1_score: 0.7267; train_kl_reg_loss: 58283.7640; train_edge_recon_loss: 3497098.1919; train_gene_expr_recon_loss: 2930294.5589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6485676.4956; train_optim_loss: 6485676.4956; val_kl_reg_loss: 49631.9537; val_edge_recon_loss: 3552161.1667; val_gene_expr_recon_loss: 2674441.3718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6276234.4615; val_optim_loss: 6276234.4615
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7001; val_auprc_score: 0.6931; val_best_acc_score: 0.6396; val_best_f1_score: 0.7269; train_kl_reg_loss: 58277.4658; train_edge_recon_loss: 3499204.0320; train_gene_expr_recon_loss: 2924777.1802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6482258.6613; train_optim_loss: 6482258.6613; val_kl_reg_loss: 49007.0167; val_edge_recon_loss: 3541623.1795; val_gene_expr_recon_loss: 2667557.7436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6258187.9231; val_optim_loss: 6258187.9231
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.6936; val_auprc_score: 0.6882; val_best_acc_score: 0.6394; val_best_f1_score: 0.7266; train_kl_reg_loss: 53019.7609; train_edge_recon_loss: 3499952.2624; train_gene_expr_recon_loss: 2920899.4019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6473871.4360; train_optim_loss: 6473871.4360; val_kl_reg_loss: 35933.5279; val_edge_recon_loss: 3549817.1923; val_gene_expr_recon_loss: 2660792.1923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6246542.8974; val_optim_loss: 6246542.8974
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.6964; val_auprc_score: 0.6912; val_best_acc_score: 0.6408; val_best_f1_score: 0.7275; train_kl_reg_loss: 54462.6487; train_edge_recon_loss: 3502849.1083; train_gene_expr_recon_loss: 2917400.3459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6474712.0988; train_optim_loss: 6474712.0988; val_kl_reg_loss: 45264.1316; val_edge_recon_loss: 3542587.2821; val_gene_expr_recon_loss: 2661668.2756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6249519.6795; val_optim_loss: 6249519.6795
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.6972; val_auprc_score: 0.6892; val_best_acc_score: 0.6410; val_best_f1_score: 0.7266; train_kl_reg_loss: 60769.7432; train_edge_recon_loss: 3498304.8299; train_gene_expr_recon_loss: 2908727.1112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6467801.6642; train_optim_loss: 6467801.6642; val_kl_reg_loss: 45780.9727; val_edge_recon_loss: 3546201.5962; val_gene_expr_recon_loss: 2666670.6154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6258653.2179; val_optim_loss: 6258653.2179
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.6969; val_auprc_score: 0.6898; val_best_acc_score: 0.6402; val_best_f1_score: 0.7268; train_kl_reg_loss: 56494.5693; train_edge_recon_loss: 3499151.4608; train_gene_expr_recon_loss: 2912123.4491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6467769.4651; train_optim_loss: 6467769.4651; val_kl_reg_loss: 44986.3687; val_edge_recon_loss: 3549225.6795; val_gene_expr_recon_loss: 2656401.4487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6250613.5128; val_optim_loss: 6250613.5128
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.6976; val_auprc_score: 0.6892; val_best_acc_score: 0.6427; val_best_f1_score: 0.7289; train_kl_reg_loss: 57211.2144; train_edge_recon_loss: 3499230.9411; train_gene_expr_recon_loss: 2911109.3721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6467551.5247; train_optim_loss: 6467551.5247; val_kl_reg_loss: 53117.2247; val_edge_recon_loss: 3541302.0513; val_gene_expr_recon_loss: 2652775.6346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6247194.9487; val_optim_loss: 6247194.9487

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.6969; val_auprc_score: 0.6900; val_best_acc_score: 0.6393; val_best_f1_score: 0.7268; train_kl_reg_loss: 56860.4794; train_edge_recon_loss: 3499448.6955; train_gene_expr_recon_loss: 2906591.9506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6462901.1119; train_optim_loss: 6462901.1119; val_kl_reg_loss: 48880.1338; val_edge_recon_loss: 3546740.8462; val_gene_expr_recon_loss: 2663348.9615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6258969.9744; val_optim_loss: 6258969.9744
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.7015; val_auprc_score: 0.6947; val_best_acc_score: 0.6461; val_best_f1_score: 0.7295; train_kl_reg_loss: 54071.9776; train_edge_recon_loss: 3499856.5189; train_gene_expr_recon_loss: 2911223.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6465151.5770; train_optim_loss: 6465151.5770; val_kl_reg_loss: 48582.2512; val_edge_recon_loss: 3532508.6282; val_gene_expr_recon_loss: 2651656.1923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6232747.0385; val_optim_loss: 6232747.0385
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.6979; val_auprc_score: 0.6918; val_best_acc_score: 0.6416; val_best_f1_score: 0.7279; train_kl_reg_loss: 58841.0600; train_edge_recon_loss: 3498904.0705; train_gene_expr_recon_loss: 2909699.6446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6467444.7762; train_optim_loss: 6467444.7762; val_kl_reg_loss: 53396.4645; val_edge_recon_loss: 3547131.6923; val_gene_expr_recon_loss: 2652748.7628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6253276.8718; val_optim_loss: 6253276.8718
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.6970; val_auprc_score: 0.6905; val_best_acc_score: 0.6399; val_best_f1_score: 0.7269; train_kl_reg_loss: 59860.4719; train_edge_recon_loss: 3498550.0698; train_gene_expr_recon_loss: 2905337.5567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6463748.1119; train_optim_loss: 6463748.1119; val_kl_reg_loss: 36456.6892; val_edge_recon_loss: 3548711.1154; val_gene_expr_recon_loss: 2656140.6603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6241308.4615; val_optim_loss: 6241308.4615
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.7006; val_auprc_score: 0.6943; val_best_acc_score: 0.6418; val_best_f1_score: 0.7277; train_kl_reg_loss: 54886.6115; train_edge_recon_loss: 3497921.2275; train_gene_expr_recon_loss: 2909034.5967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6461842.4564; train_optim_loss: 6461842.4564; val_kl_reg_loss: 41740.0748; val_edge_recon_loss: 3542783.7885; val_gene_expr_recon_loss: 2665603.3590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6250127.2564; val_optim_loss: 6250127.2564
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.7013; val_auprc_score: 0.6945; val_best_acc_score: 0.6435; val_best_f1_score: 0.7288; train_kl_reg_loss: 54116.2904; train_edge_recon_loss: 3498561.2297; train_gene_expr_recon_loss: 2907880.2108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6460557.7311; train_optim_loss: 6460557.7311; val_kl_reg_loss: 57286.4071; val_edge_recon_loss: 3532487.5577; val_gene_expr_recon_loss: 2656480.0128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6246253.9615; val_optim_loss: 6246253.9615

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.6969; val_auprc_score: 0.6908; val_best_acc_score: 0.6414; val_best_f1_score: 0.7279; train_kl_reg_loss: 54522.4058; train_edge_recon_loss: 3498957.6969; train_gene_expr_recon_loss: 2907074.9368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6460555.0378; train_optim_loss: 6460555.0378; val_kl_reg_loss: 40045.0659; val_edge_recon_loss: 3543225.5128; val_gene_expr_recon_loss: 2651012.3782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6234282.9615; val_optim_loss: 6234282.9615
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.6996; val_auprc_score: 0.6919; val_best_acc_score: 0.6446; val_best_f1_score: 0.7298; train_kl_reg_loss: 56189.8599; train_edge_recon_loss: 3499229.9433; train_gene_expr_recon_loss: 2904592.4164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6460012.2151; train_optim_loss: 6460012.2151; val_kl_reg_loss: 42238.4329; val_edge_recon_loss: 3531917.9744; val_gene_expr_recon_loss: 2657742.1090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6231898.4744; val_optim_loss: 6231898.4744
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.7002; val_auprc_score: 0.6955; val_best_acc_score: 0.6421; val_best_f1_score: 0.7283; train_kl_reg_loss: 54551.7990; train_edge_recon_loss: 3499862.5858; train_gene_expr_recon_loss: 2906945.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6461360.0654; train_optim_loss: 6461360.0654; val_kl_reg_loss: 61646.1458; val_edge_recon_loss: 3543856.8974; val_gene_expr_recon_loss: 2659843.1346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6265346.1667; val_optim_loss: 6265346.1667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.6980; val_auprc_score: 0.6915; val_best_acc_score: 0.6419; val_best_f1_score: 0.7275; train_kl_reg_loss: 56739.4114; train_edge_recon_loss: 3497579.7456; train_gene_expr_recon_loss: 2904604.8154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6458923.9709; train_optim_loss: 6458923.9709; val_kl_reg_loss: 56723.8687; val_edge_recon_loss: 3540776.4167; val_gene_expr_recon_loss: 2656382.1154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6253882.4231; val_optim_loss: 6253882.4231
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.6992; val_auprc_score: 0.6924; val_best_acc_score: 0.6430; val_best_f1_score: 0.7274; train_kl_reg_loss: 53430.9967; train_edge_recon_loss: 3499695.1112; train_gene_expr_recon_loss: 2908956.8140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6462082.9055; train_optim_loss: 6462082.9055; val_kl_reg_loss: 54717.3954; val_edge_recon_loss: 3539340.5513; val_gene_expr_recon_loss: 2662318.8718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6256376.8205; val_optim_loss: 6256376.8205
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.7014; val_auprc_score: 0.6935; val_best_acc_score: 0.6453; val_best_f1_score: 0.7298; train_kl_reg_loss: 58120.2114; train_edge_recon_loss: 3499404.8263; train_gene_expr_recon_loss: 2907667.7478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6465192.7994; train_optim_loss: 6465192.7994; val_kl_reg_loss: 39181.2801; val_edge_recon_loss: 3526436.5321; val_gene_expr_recon_loss: 2652382.0192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6217999.8462; val_optim_loss: 6217999.8462
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.6979; val_auprc_score: 0.6904; val_best_acc_score: 0.6414; val_best_f1_score: 0.7276; train_kl_reg_loss: 52457.8311; train_edge_recon_loss: 3497056.6781; train_gene_expr_recon_loss: 2905867.5240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6455382.0349; train_optim_loss: 6455382.0349; val_kl_reg_loss: 46636.1540; val_edge_recon_loss: 3544449.8974; val_gene_expr_recon_loss: 2656993.7756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6248079.8462; val_optim_loss: 6248079.8462
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.6959; val_auprc_score: 0.6892; val_best_acc_score: 0.6389; val_best_f1_score: 0.7269; train_kl_reg_loss: 51987.1970; train_edge_recon_loss: 3499599.9070; train_gene_expr_recon_loss: 2905981.5422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6457568.6294; train_optim_loss: 6457568.6294; val_kl_reg_loss: 41164.3220; val_edge_recon_loss: 3548176.4872; val_gene_expr_recon_loss: 2664482.9038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6253823.6667; val_optim_loss: 6253823.6667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.7034; val_auprc_score: 0.6954; val_best_acc_score: 0.6464; val_best_f1_score: 0.7299; train_kl_reg_loss: 56551.8516; train_edge_recon_loss: 3498918.2108; train_gene_expr_recon_loss: 2906779.4353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6462249.5145; train_optim_loss: 6462249.5145; val_kl_reg_loss: 40953.6816; val_edge_recon_loss: 3527813.7756; val_gene_expr_recon_loss: 2659390.7051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6228158.1923; val_optim_loss: 6228158.1923
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.6992; val_auprc_score: 0.6933; val_best_acc_score: 0.6408; val_best_f1_score: 0.7278; train_kl_reg_loss: 60366.0723; train_edge_recon_loss: 3501519.9876; train_gene_expr_recon_loss: 2908459.1831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6470345.2253; train_optim_loss: 6470345.2253; val_kl_reg_loss: 47749.6040; val_edge_recon_loss: 3539123.6538; val_gene_expr_recon_loss: 2648898.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6235771.2692; val_optim_loss: 6235771.2692

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.6990; val_auprc_score: 0.6923; val_best_acc_score: 0.6432; val_best_f1_score: 0.7287; train_kl_reg_loss: 52706.7175; train_edge_recon_loss: 3501330.2958; train_gene_expr_recon_loss: 2906674.2129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6460711.2267; train_optim_loss: 6460711.2267; val_kl_reg_loss: 57839.7338; val_edge_recon_loss: 3538375.8077; val_gene_expr_recon_loss: 2656215.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6252430.6795; val_optim_loss: 6252430.6795
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.7014; val_auprc_score: 0.6939; val_best_acc_score: 0.6450; val_best_f1_score: 0.7290; train_kl_reg_loss: 58379.6775; train_edge_recon_loss: 3501954.9499; train_gene_expr_recon_loss: 2902403.6795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6462738.2849; train_optim_loss: 6462738.2849; val_kl_reg_loss: 48192.0584; val_edge_recon_loss: 3532292.9679; val_gene_expr_recon_loss: 2656183.1987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6236668.2051; val_optim_loss: 6236668.2051
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.6941; val_auprc_score: 0.6876; val_best_acc_score: 0.6389; val_best_f1_score: 0.7254; train_kl_reg_loss: 56471.7510; train_edge_recon_loss: 3498355.0879; train_gene_expr_recon_loss: 2908170.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6462997.7922; train_optim_loss: 6462997.7922; val_kl_reg_loss: 47591.9433; val_edge_recon_loss: 3555874.7692; val_gene_expr_recon_loss: 2657884.0769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6261350.8205; val_optim_loss: 6261350.8205
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.7000; val_auprc_score: 0.6912; val_best_acc_score: 0.6443; val_best_f1_score: 0.7291; train_kl_reg_loss: 59258.9296; train_edge_recon_loss: 3497571.9535; train_gene_expr_recon_loss: 2905836.5254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6462667.4041; train_optim_loss: 6462667.4041; val_kl_reg_loss: 57467.9986; val_edge_recon_loss: 3536678.9487; val_gene_expr_recon_loss: 2657559.0128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6251705.9487; val_optim_loss: 6251705.9487

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 127 min 16 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.6992
val AUPRC score: 0.6919
val best accuracy score: 0.6418
val best F1 score: 0.7279
val target rna MSE score: 4.2181
val source rna MSE score: 1.5711
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0387
Val cat covariate2 mean sim diff: nan

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
