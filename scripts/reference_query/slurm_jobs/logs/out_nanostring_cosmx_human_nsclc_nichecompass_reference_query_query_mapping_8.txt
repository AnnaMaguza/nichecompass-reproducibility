Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--query_batches', 'batch4', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '03092023_020519_8', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 75351
Number of validation nodes: 8372
Number of training edges: 175771
Number of validation edges: 19530
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7030; val_auprc_score: 0.7225; val_best_acc_score: 0.6411; val_best_f1_score: 0.7283; train_kl_reg_loss: 31647.8498; train_edge_recon_loss: 3469749.0051; train_gene_expr_recon_loss: 5163236.8866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8664633.7267; train_optim_loss: 8664633.7267; val_kl_reg_loss: 31585.9337; val_edge_recon_loss: 3504582.0192; val_gene_expr_recon_loss: 4360735.3269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7896903.2821; val_optim_loss: 7896903.2821
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7014; val_auprc_score: 0.7186; val_best_acc_score: 0.6409; val_best_f1_score: 0.7283; train_kl_reg_loss: 31646.2618; train_edge_recon_loss: 3473170.6214; train_gene_expr_recon_loss: 4584853.4186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8089670.2994; train_optim_loss: 8089670.2994; val_kl_reg_loss: 31584.0025; val_edge_recon_loss: 3508231.1474; val_gene_expr_recon_loss: 4078850.9295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7618666.0385; val_optim_loss: 7618666.0385
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7011; val_auprc_score: 0.7196; val_best_acc_score: 0.6397; val_best_f1_score: 0.7272; train_kl_reg_loss: 31631.4658; train_edge_recon_loss: 3473136.5647; train_gene_expr_recon_loss: 4323020.2754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7827788.2922; train_optim_loss: 7827788.2922; val_kl_reg_loss: 31588.2864; val_edge_recon_loss: 3513028.7692; val_gene_expr_recon_loss: 3858022.9487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7402640.0256; val_optim_loss: 7402640.0256
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.6998; val_auprc_score: 0.7184; val_best_acc_score: 0.6378; val_best_f1_score: 0.7263; train_kl_reg_loss: 31653.0354; train_edge_recon_loss: 3477305.8328; train_gene_expr_recon_loss: 4121424.0189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7630382.8735; train_optim_loss: 7630382.8735; val_kl_reg_loss: 31665.2612; val_edge_recon_loss: 3516293.3269; val_gene_expr_recon_loss: 3679299.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7227257.9231; val_optim_loss: 7227257.9231
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7015; val_auprc_score: 0.7199; val_best_acc_score: 0.6384; val_best_f1_score: 0.7272; train_kl_reg_loss: 31623.9840; train_edge_recon_loss: 3473436.6076; train_gene_expr_recon_loss: 3955583.8140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7460644.4099; train_optim_loss: 7460644.4099; val_kl_reg_loss: 31604.5329; val_edge_recon_loss: 3509382.8333; val_gene_expr_recon_loss: 3527998.6282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7068985.9872; val_optim_loss: 7068985.9872
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7007; val_auprc_score: 0.7206; val_best_acc_score: 0.6386; val_best_f1_score: 0.7272; train_kl_reg_loss: 31649.7826; train_edge_recon_loss: 3473754.8336; train_gene_expr_recon_loss: 3853737.1112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7359141.7238; train_optim_loss: 7359141.7238; val_kl_reg_loss: 31567.5568; val_edge_recon_loss: 3512302.3397; val_gene_expr_recon_loss: 3425762.1923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6969632.0641; val_optim_loss: 6969632.0641
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7025; val_auprc_score: 0.7214; val_best_acc_score: 0.6394; val_best_f1_score: 0.7274; train_kl_reg_loss: 31633.8381; train_edge_recon_loss: 3471447.4644; train_gene_expr_recon_loss: 3758753.0509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7261834.3328; train_optim_loss: 7261834.3328; val_kl_reg_loss: 31581.2847; val_edge_recon_loss: 3505645.6731; val_gene_expr_recon_loss: 3355867.7051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6893094.6282; val_optim_loss: 6893094.6282
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7013; val_auprc_score: 0.7190; val_best_acc_score: 0.6400; val_best_f1_score: 0.7273; train_kl_reg_loss: 31637.4293; train_edge_recon_loss: 3473369.8147; train_gene_expr_recon_loss: 3698111.1156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7203118.3692; train_optim_loss: 7203118.3692; val_kl_reg_loss: 31621.3481; val_edge_recon_loss: 3508016.4423; val_gene_expr_recon_loss: 3290781.9423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6830419.7308; val_optim_loss: 6830419.7308
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.6992; val_auprc_score: 0.7186; val_best_acc_score: 0.6380; val_best_f1_score: 0.7269; train_kl_reg_loss: 31661.1615; train_edge_recon_loss: 3473825.5094; train_gene_expr_recon_loss: 3653156.7907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7158643.4782; train_optim_loss: 7158643.4782; val_kl_reg_loss: 31644.7360; val_edge_recon_loss: 3514015.7436; val_gene_expr_recon_loss: 3270177.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6815837.9872; val_optim_loss: 6815837.9872
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7024; val_auprc_score: 0.7201; val_best_acc_score: 0.6388; val_best_f1_score: 0.7272; train_kl_reg_loss: 31661.8807; train_edge_recon_loss: 3476252.0334; train_gene_expr_recon_loss: 3619983.0690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7127896.9767; train_optim_loss: 7127896.9767; val_kl_reg_loss: 31567.6189; val_edge_recon_loss: 3513386.2051; val_gene_expr_recon_loss: 3228001.5256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6772955.3462; val_optim_loss: 6772955.3462
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7017; val_auprc_score: 0.7195; val_best_acc_score: 0.6400; val_best_f1_score: 0.7280; train_kl_reg_loss: 31665.9590; train_edge_recon_loss: 3473928.1751; train_gene_expr_recon_loss: 3598643.4157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7104237.5465; train_optim_loss: 7104237.5465; val_kl_reg_loss: 31583.0151; val_edge_recon_loss: 3510703.8590; val_gene_expr_recon_loss: 3202145.7949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6744432.6538; val_optim_loss: 6744432.6538
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7021; val_auprc_score: 0.7199; val_best_acc_score: 0.6393; val_best_f1_score: 0.7276; train_kl_reg_loss: 31643.6345; train_edge_recon_loss: 3470448.0872; train_gene_expr_recon_loss: 3571766.0400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7073857.7747; train_optim_loss: 7073857.7747; val_kl_reg_loss: 31569.3489; val_edge_recon_loss: 3512218.2308; val_gene_expr_recon_loss: 3179740.3205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6723527.9231; val_optim_loss: 6723527.9231
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7002; val_auprc_score: 0.7170; val_best_acc_score: 0.6401; val_best_f1_score: 0.7269; train_kl_reg_loss: 31643.1017; train_edge_recon_loss: 3472019.7078; train_gene_expr_recon_loss: 3554195.8118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7057858.6308; train_optim_loss: 7057858.6308; val_kl_reg_loss: 31650.1273; val_edge_recon_loss: 3513079.9551; val_gene_expr_recon_loss: 3179636.6410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6724366.7436; val_optim_loss: 6724366.7436
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7037; val_auprc_score: 0.7222; val_best_acc_score: 0.6424; val_best_f1_score: 0.7287; train_kl_reg_loss: 31639.0311; train_edge_recon_loss: 3473005.5683; train_gene_expr_recon_loss: 3532706.3387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7037350.9419; train_optim_loss: 7037350.9419; val_kl_reg_loss: 31620.7250; val_edge_recon_loss: 3501882.4808; val_gene_expr_recon_loss: 3158657.5705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6692160.8333; val_optim_loss: 6692160.8333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7020; val_auprc_score: 0.7202; val_best_acc_score: 0.6401; val_best_f1_score: 0.7271; train_kl_reg_loss: 31659.3893; train_edge_recon_loss: 3473264.1432; train_gene_expr_recon_loss: 3525449.3699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7030372.8837; train_optim_loss: 7030372.8837; val_kl_reg_loss: 31543.6089; val_edge_recon_loss: 3510978.8910; val_gene_expr_recon_loss: 3144438.9103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6686961.4103; val_optim_loss: 6686961.4103
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7011; val_auprc_score: 0.7203; val_best_acc_score: 0.6387; val_best_f1_score: 0.7269; train_kl_reg_loss: 31658.7844; train_edge_recon_loss: 3474241.0305; train_gene_expr_recon_loss: 3518971.1177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7024870.9564; train_optim_loss: 7024870.9564; val_kl_reg_loss: 31596.0799; val_edge_recon_loss: 3514650.0897; val_gene_expr_recon_loss: 3136021.9103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6682268.0513; val_optim_loss: 6682268.0513
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7009; val_auprc_score: 0.7186; val_best_acc_score: 0.6404; val_best_f1_score: 0.7277; train_kl_reg_loss: 31641.8997; train_edge_recon_loss: 3474243.6083; train_gene_expr_recon_loss: 3495248.8983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7001134.4026; train_optim_loss: 7001134.4026; val_kl_reg_loss: 31622.7951; val_edge_recon_loss: 3509521.1731; val_gene_expr_recon_loss: 3120054.8526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6661198.7949; val_optim_loss: 6661198.7949
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7029; val_auprc_score: 0.7216; val_best_acc_score: 0.6398; val_best_f1_score: 0.7276; train_kl_reg_loss: 31651.0062; train_edge_recon_loss: 3471819.7078; train_gene_expr_recon_loss: 3488639.4775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6992110.1904; train_optim_loss: 6992110.1904; val_kl_reg_loss: 31584.8089; val_edge_recon_loss: 3511242.3077; val_gene_expr_recon_loss: 3117508.3141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6660335.4615; val_optim_loss: 6660335.4615
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7006; val_auprc_score: 0.7194; val_best_acc_score: 0.6388; val_best_f1_score: 0.7273; train_kl_reg_loss: 31647.1130; train_edge_recon_loss: 3475517.3503; train_gene_expr_recon_loss: 3487294.7180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6994459.1613; train_optim_loss: 6994459.1613; val_kl_reg_loss: 31657.7875; val_edge_recon_loss: 3514277.4231; val_gene_expr_recon_loss: 3111659.0449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6657594.2308; val_optim_loss: 6657594.2308
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7036; val_auprc_score: 0.7213; val_best_acc_score: 0.6413; val_best_f1_score: 0.7285; train_kl_reg_loss: 31662.0677; train_edge_recon_loss: 3470796.6512; train_gene_expr_recon_loss: 3476527.0218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6978985.7529; train_optim_loss: 6978985.7529; val_kl_reg_loss: 31617.2229; val_edge_recon_loss: 3504411.4295; val_gene_expr_recon_loss: 3100511.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6636540.0513; val_optim_loss: 6636540.0513
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7039; val_auprc_score: 0.7215; val_best_acc_score: 0.6411; val_best_f1_score: 0.7282; train_kl_reg_loss: 31659.5457; train_edge_recon_loss: 3473823.8161; train_gene_expr_recon_loss: 3463959.2965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6969442.6642; train_optim_loss: 6969442.6642; val_kl_reg_loss: 31649.5317; val_edge_recon_loss: 3499386.8269; val_gene_expr_recon_loss: 3100891.0705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6631927.4103; val_optim_loss: 6631927.4103
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7004; val_auprc_score: 0.7178; val_best_acc_score: 0.6394; val_best_f1_score: 0.7276; train_kl_reg_loss: 31657.7551; train_edge_recon_loss: 3474869.6897; train_gene_expr_recon_loss: 3460215.3699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6966742.8227; train_optim_loss: 6966742.8227; val_kl_reg_loss: 31619.1507; val_edge_recon_loss: 3513005.1026; val_gene_expr_recon_loss: 3092161.8590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6636786.1410; val_optim_loss: 6636786.1410
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.6999; val_auprc_score: 0.7186; val_best_acc_score: 0.6389; val_best_f1_score: 0.7268; train_kl_reg_loss: 31636.1790; train_edge_recon_loss: 3471619.0538; train_gene_expr_recon_loss: 3453463.3132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6956718.5436; train_optim_loss: 6956718.5436; val_kl_reg_loss: 31616.6103; val_edge_recon_loss: 3515244.9167; val_gene_expr_recon_loss: 3083452.7756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6630314.3077; val_optim_loss: 6630314.3077
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7000; val_auprc_score: 0.7196; val_best_acc_score: 0.6377; val_best_f1_score: 0.7267; train_kl_reg_loss: 31653.3834; train_edge_recon_loss: 3474659.2696; train_gene_expr_recon_loss: 3455918.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6962231.2093; train_optim_loss: 6962231.2093; val_kl_reg_loss: 31641.0589; val_edge_recon_loss: 3519241.1731; val_gene_expr_recon_loss: 3089662.0897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6640544.2821; val_optim_loss: 6640544.2821
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7040; val_auprc_score: 0.7212; val_best_acc_score: 0.6419; val_best_f1_score: 0.7284; train_kl_reg_loss: 31672.1518; train_edge_recon_loss: 3476396.0472; train_gene_expr_recon_loss: 3448902.6068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6956970.8038; train_optim_loss: 6956970.8038; val_kl_reg_loss: 31623.3187; val_edge_recon_loss: 3503087.3526; val_gene_expr_recon_loss: 3075709.8654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6610420.5641; val_optim_loss: 6610420.5641
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.6870; val_auprc_score: 0.6957; val_best_acc_score: 0.6372; val_best_f1_score: 0.7256; train_kl_reg_loss: 31630.0156; train_edge_recon_loss: 3480105.8895; train_gene_expr_recon_loss: 2604321.4506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6116057.3547; train_optim_loss: 6116057.3547; val_kl_reg_loss: 30460.2122; val_edge_recon_loss: 3518941.5769; val_gene_expr_recon_loss: 2563063.1603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6112464.9615; val_optim_loss: 6112464.9615
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.6873; val_auprc_score: 0.6985; val_best_acc_score: 0.6373; val_best_f1_score: 0.7254; train_kl_reg_loss: 31644.6116; train_edge_recon_loss: 3481134.2958; train_gene_expr_recon_loss: 2581928.8394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6094707.7427; train_optim_loss: 6094707.7427; val_kl_reg_loss: 30410.0410; val_edge_recon_loss: 3513857.0705; val_gene_expr_recon_loss: 2520397.8782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6064665.0000; val_optim_loss: 6064665.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.6848; val_auprc_score: 0.6948; val_best_acc_score: 0.6353; val_best_f1_score: 0.7247; train_kl_reg_loss: 31657.5001; train_edge_recon_loss: 3479651.3154; train_gene_expr_recon_loss: 2547542.2587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6058851.0741; train_optim_loss: 6058851.0741; val_kl_reg_loss: 30465.1643; val_edge_recon_loss: 3525939.4038; val_gene_expr_recon_loss: 2518579.8590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6074984.4103; val_optim_loss: 6074984.4103
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.6883; val_auprc_score: 0.6977; val_best_acc_score: 0.6367; val_best_f1_score: 0.7257; train_kl_reg_loss: 31641.5308; train_edge_recon_loss: 3477961.7326; train_gene_expr_recon_loss: 2541798.2406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6051401.5000; train_optim_loss: 6051401.5000; val_kl_reg_loss: 30363.5878; val_edge_recon_loss: 3511009.3077; val_gene_expr_recon_loss: 2501792.0705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6043165.0000; val_optim_loss: 6043165.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.6903; val_auprc_score: 0.7010; val_best_acc_score: 0.6381; val_best_f1_score: 0.7260; train_kl_reg_loss: 31633.6231; train_edge_recon_loss: 3478936.5203; train_gene_expr_recon_loss: 2535201.2129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6045771.3561; train_optim_loss: 6045771.3561; val_kl_reg_loss: 30417.9648; val_edge_recon_loss: 3512153.1795; val_gene_expr_recon_loss: 2505072.5577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6047643.6923; val_optim_loss: 6047643.6923
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.6879; val_auprc_score: 0.6965; val_best_acc_score: 0.6364; val_best_f1_score: 0.7252; train_kl_reg_loss: 31657.4128; train_edge_recon_loss: 3482544.4019; train_gene_expr_recon_loss: 2534140.2922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6048342.1076; train_optim_loss: 6048342.1076; val_kl_reg_loss: 30375.2345; val_edge_recon_loss: 3517461.9423; val_gene_expr_recon_loss: 2495293.8077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6043130.9872; val_optim_loss: 6043130.9872
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.6894; val_auprc_score: 0.6990; val_best_acc_score: 0.6377; val_best_f1_score: 0.7262; train_kl_reg_loss: 31637.3451; train_edge_recon_loss: 3481269.5414; train_gene_expr_recon_loss: 2527898.6911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6040805.5814; train_optim_loss: 6040805.5814; val_kl_reg_loss: 30407.4731; val_edge_recon_loss: 3509432.3333; val_gene_expr_recon_loss: 2501871.4679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6041711.2564; val_optim_loss: 6041711.2564
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.6900; val_auprc_score: 0.7015; val_best_acc_score: 0.6366; val_best_f1_score: 0.7257; train_kl_reg_loss: 31665.5650; train_edge_recon_loss: 3480203.8983; train_gene_expr_recon_loss: 2528412.8416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6040282.2951; train_optim_loss: 6040282.2951; val_kl_reg_loss: 30434.6068; val_edge_recon_loss: 3519520.0128; val_gene_expr_recon_loss: 2495741.5705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6045696.1282; val_optim_loss: 6045696.1282
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.6870; val_auprc_score: 0.6972; val_best_acc_score: 0.6366; val_best_f1_score: 0.7256; train_kl_reg_loss: 31652.7334; train_edge_recon_loss: 3481661.8314; train_gene_expr_recon_loss: 2523952.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6037266.8576; train_optim_loss: 6037266.8576; val_kl_reg_loss: 30486.1771; val_edge_recon_loss: 3516025.8462; val_gene_expr_recon_loss: 2495018.5128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6041530.5256; val_optim_loss: 6041530.5256
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.6874; val_auprc_score: 0.6981; val_best_acc_score: 0.6370; val_best_f1_score: 0.7258; train_kl_reg_loss: 31649.0893; train_edge_recon_loss: 3479757.8125; train_gene_expr_recon_loss: 2520173.4390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6031580.3474; train_optim_loss: 6031580.3474; val_kl_reg_loss: 30394.2938; val_edge_recon_loss: 3518631.1987; val_gene_expr_recon_loss: 2489026.3397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6038051.8718; val_optim_loss: 6038051.8718
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.6872; val_auprc_score: 0.6973; val_best_acc_score: 0.6358; val_best_f1_score: 0.7250; train_kl_reg_loss: 31650.8927; train_edge_recon_loss: 3479766.8583; train_gene_expr_recon_loss: 2519262.5327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6030680.2936; train_optim_loss: 6030680.2936; val_kl_reg_loss: 30398.7343; val_edge_recon_loss: 3521812.0962; val_gene_expr_recon_loss: 2492676.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6044886.8333; val_optim_loss: 6044886.8333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.6877; val_auprc_score: 0.6975; val_best_acc_score: 0.6375; val_best_f1_score: 0.7259; train_kl_reg_loss: 31638.3527; train_edge_recon_loss: 3482728.6250; train_gene_expr_recon_loss: 2513327.6119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6027694.5959; train_optim_loss: 6027694.5959; val_kl_reg_loss: 30451.2803; val_edge_recon_loss: 3511733.0064; val_gene_expr_recon_loss: 2495640.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6037824.7949; val_optim_loss: 6037824.7949
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.6885; val_auprc_score: 0.6984; val_best_acc_score: 0.6375; val_best_f1_score: 0.7257; train_kl_reg_loss: 31641.9495; train_edge_recon_loss: 3481203.1933; train_gene_expr_recon_loss: 2515858.1548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6028703.2834; train_optim_loss: 6028703.2834; val_kl_reg_loss: 30392.5329; val_edge_recon_loss: 3514224.1154; val_gene_expr_recon_loss: 2491214.6026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6035831.2436; val_optim_loss: 6035831.2436
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.6885; val_auprc_score: 0.6989; val_best_acc_score: 0.6374; val_best_f1_score: 0.7259; train_kl_reg_loss: 31642.4861; train_edge_recon_loss: 3481700.1308; train_gene_expr_recon_loss: 2514740.6134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6028083.2195; train_optim_loss: 6028083.2195; val_kl_reg_loss: 30348.6046; val_edge_recon_loss: 3516630.6410; val_gene_expr_recon_loss: 2481614.4615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6028593.6795; val_optim_loss: 6028593.6795
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.6897; val_auprc_score: 0.7004; val_best_acc_score: 0.6382; val_best_f1_score: 0.7260; train_kl_reg_loss: 31641.5702; train_edge_recon_loss: 3478730.1359; train_gene_expr_recon_loss: 2512195.3823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6022567.0785; train_optim_loss: 6022567.0785; val_kl_reg_loss: 30398.7312; val_edge_recon_loss: 3516283.7692; val_gene_expr_recon_loss: 2483890.0705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6030572.5897; val_optim_loss: 6030572.5897
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.6880; val_auprc_score: 0.6993; val_best_acc_score: 0.6366; val_best_f1_score: 0.7256; train_kl_reg_loss: 31635.4820; train_edge_recon_loss: 3482113.3001; train_gene_expr_recon_loss: 2512466.2711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6026215.0378; train_optim_loss: 6026215.0378; val_kl_reg_loss: 30394.2442; val_edge_recon_loss: 3522676.9231; val_gene_expr_recon_loss: 2483745.6346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6036816.7692; val_optim_loss: 6036816.7692
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.6862; val_auprc_score: 0.6955; val_best_acc_score: 0.6377; val_best_f1_score: 0.7263; train_kl_reg_loss: 31646.1653; train_edge_recon_loss: 3479344.0523; train_gene_expr_recon_loss: 2509902.3176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6020892.5494; train_optim_loss: 6020892.5494; val_kl_reg_loss: 30412.5090; val_edge_recon_loss: 3518563.0064; val_gene_expr_recon_loss: 2475659.3654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6024634.8333; val_optim_loss: 6024634.8333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.6907; val_auprc_score: 0.7005; val_best_acc_score: 0.6388; val_best_f1_score: 0.7260; train_kl_reg_loss: 31642.5544; train_edge_recon_loss: 3480631.5792; train_gene_expr_recon_loss: 2509322.1388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6021596.2733; train_optim_loss: 6021596.2733; val_kl_reg_loss: 30357.8444; val_edge_recon_loss: 3518464.0192; val_gene_expr_recon_loss: 2484078.0449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6032899.9103; val_optim_loss: 6032899.9103
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.6883; val_auprc_score: 0.6975; val_best_acc_score: 0.6381; val_best_f1_score: 0.7264; train_kl_reg_loss: 31640.1498; train_edge_recon_loss: 3480069.2536; train_gene_expr_recon_loss: 2506367.2943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6018076.6919; train_optim_loss: 6018076.6919; val_kl_reg_loss: 30426.5927; val_edge_recon_loss: 3513520.4423; val_gene_expr_recon_loss: 2481482.5064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6025429.5000; val_optim_loss: 6025429.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.6915; val_auprc_score: 0.7006; val_best_acc_score: 0.6406; val_best_f1_score: 0.7275; train_kl_reg_loss: 31625.6740; train_edge_recon_loss: 3479694.4949; train_gene_expr_recon_loss: 2505561.5022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6016881.6686; train_optim_loss: 6016881.6686; val_kl_reg_loss: 30371.3834; val_edge_recon_loss: 3502809.5641; val_gene_expr_recon_loss: 2475156.1923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6008337.1667; val_optim_loss: 6008337.1667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.6883; val_auprc_score: 0.6993; val_best_acc_score: 0.6382; val_best_f1_score: 0.7258; train_kl_reg_loss: 31649.0149; train_edge_recon_loss: 3478129.1504; train_gene_expr_recon_loss: 2508397.7769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6018175.9215; train_optim_loss: 6018175.9215; val_kl_reg_loss: 30384.5783; val_edge_recon_loss: 3518428.9231; val_gene_expr_recon_loss: 2478669.2051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6027482.6923; val_optim_loss: 6027482.6923
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.6920; val_auprc_score: 0.7033; val_best_acc_score: 0.6401; val_best_f1_score: 0.7271; train_kl_reg_loss: 31643.9277; train_edge_recon_loss: 3481337.9571; train_gene_expr_recon_loss: 2503504.8067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6016486.6817; train_optim_loss: 6016486.6817; val_kl_reg_loss: 30352.6037; val_edge_recon_loss: 3513055.1282; val_gene_expr_recon_loss: 2470174.5513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6013582.2692; val_optim_loss: 6013582.2692
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.6877; val_auprc_score: 0.6979; val_best_acc_score: 0.6376; val_best_f1_score: 0.7261; train_kl_reg_loss: 31644.6384; train_edge_recon_loss: 3477208.7217; train_gene_expr_recon_loss: 2505319.4520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6014172.8154; train_optim_loss: 6014172.8154; val_kl_reg_loss: 30431.8878; val_edge_recon_loss: 3514738.4295; val_gene_expr_recon_loss: 2478408.3077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6023578.6154; val_optim_loss: 6023578.6154
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.6897; val_auprc_score: 0.6984; val_best_acc_score: 0.6388; val_best_f1_score: 0.7265; train_kl_reg_loss: 31659.3580; train_edge_recon_loss: 3482295.5785; train_gene_expr_recon_loss: 2506099.5581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6020054.5015; train_optim_loss: 6020054.5015; val_kl_reg_loss: 30395.7920; val_edge_recon_loss: 3513912.5128; val_gene_expr_recon_loss: 2478992.8654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6023301.1667; val_optim_loss: 6023301.1667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.6885; val_auprc_score: 0.6988; val_best_acc_score: 0.6376; val_best_f1_score: 0.7263; train_kl_reg_loss: 31647.3611; train_edge_recon_loss: 3480373.7020; train_gene_expr_recon_loss: 2503318.6955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6015339.7500; train_optim_loss: 6015339.7500; val_kl_reg_loss: 30447.9923; val_edge_recon_loss: 3512895.9551; val_gene_expr_recon_loss: 2479481.8526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6022825.8077; val_optim_loss: 6022825.8077
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.6874; val_auprc_score: 0.6981; val_best_acc_score: 0.6358; val_best_f1_score: 0.7251; train_kl_reg_loss: 31632.7728; train_edge_recon_loss: 3480047.5959; train_gene_expr_recon_loss: 2503993.3983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6015673.7689; train_optim_loss: 6015673.7689; val_kl_reg_loss: 30385.3814; val_edge_recon_loss: 3517940.6154; val_gene_expr_recon_loss: 2471610.1474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6019936.1795; val_optim_loss: 6019936.1795
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.6836; val_auprc_score: 0.6942; val_best_acc_score: 0.6345; val_best_f1_score: 0.7240; train_kl_reg_loss: 31657.5726; train_edge_recon_loss: 3480552.5858; train_gene_expr_recon_loss: 2505653.6759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6017863.8241; train_optim_loss: 6017863.8241; val_kl_reg_loss: 30446.3461; val_edge_recon_loss: 3529274.8654; val_gene_expr_recon_loss: 2477907.9231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6037629.1282; val_optim_loss: 6037629.1282
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.6894; val_auprc_score: 0.7013; val_best_acc_score: 0.6359; val_best_f1_score: 0.7256; train_kl_reg_loss: 31649.8657; train_edge_recon_loss: 3478840.1642; train_gene_expr_recon_loss: 2506393.8147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6016883.8561; train_optim_loss: 6016883.8561; val_kl_reg_loss: 30391.4690; val_edge_recon_loss: 3514834.7372; val_gene_expr_recon_loss: 2473221.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6018448.0897; val_optim_loss: 6018448.0897

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 110 min 9 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.6882
val AUPRC score: 0.6985
val best accuracy score: 0.6379
val best F1 score: 0.7260
val target rna MSE score: 19.2197
val source rna MSE score: 1.4915
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0422

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
