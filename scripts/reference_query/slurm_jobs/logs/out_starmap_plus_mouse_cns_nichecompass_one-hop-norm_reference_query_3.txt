[True]
Run timestamp: 07072023_185811_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference_query_reference_only', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 193574
Number of validation nodes: 21508
Number of training edges: 896733
Number of validation edges: 99637
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9585; val_auprc_score: 0.9678; val_best_acc_score: 0.9434; val_best_f1_score: 0.9583; train_kl_reg_loss: 6650.2715; train_edge_recon_loss: 185455.7688; train_cat_covariates_contrastive_loss: 80112.5485; train_gene_expr_recon_loss: 109213.1249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381431.7138; train_optim_loss: 381431.7138; val_kl_reg_loss: 6155.9255; val_edge_recon_loss: 177430.4514; val_cat_covariates_contrastive_loss: 79019.8510; val_gene_expr_recon_loss: 95831.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358437.3058; val_optim_loss: 358437.3058
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9603; val_auprc_score: 0.9663; val_best_acc_score: 0.9534; val_best_f1_score: 0.9656; train_kl_reg_loss: 6246.4501; train_edge_recon_loss: 176414.3189; train_cat_covariates_contrastive_loss: 79315.7715; train_gene_expr_recon_loss: 93646.2053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355622.7453; train_optim_loss: 355622.7453; val_kl_reg_loss: 6145.7583; val_edge_recon_loss: 175796.2197; val_cat_covariates_contrastive_loss: 78803.4433; val_gene_expr_recon_loss: 91614.8599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352360.2777; val_optim_loss: 352360.2777
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9632; val_auprc_score: 0.9687; val_best_acc_score: 0.9575; val_best_f1_score: 0.9686; train_kl_reg_loss: 6192.1540; train_edge_recon_loss: 175806.8713; train_cat_covariates_contrastive_loss: 79244.8145; train_gene_expr_recon_loss: 90959.2780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352203.1178; train_optim_loss: 352203.1178; val_kl_reg_loss: 6074.1663; val_edge_recon_loss: 175183.1572; val_cat_covariates_contrastive_loss: 78868.3377; val_gene_expr_recon_loss: 90022.5503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350148.2114; val_optim_loss: 350148.2114
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9652; val_auprc_score: 0.9711; val_best_acc_score: 0.9595; val_best_f1_score: 0.9700; train_kl_reg_loss: 6201.9523; train_edge_recon_loss: 175706.8197; train_cat_covariates_contrastive_loss: 79232.3540; train_gene_expr_recon_loss: 89419.5795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350560.7042; train_optim_loss: 350560.7042; val_kl_reg_loss: 5950.7362; val_edge_recon_loss: 174927.3501; val_cat_covariates_contrastive_loss: 78959.0841; val_gene_expr_recon_loss: 88829.7636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348666.9334; val_optim_loss: 348666.9334
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9642; val_auprc_score: 0.9697; val_best_acc_score: 0.9609; val_best_f1_score: 0.9711; train_kl_reg_loss: 6228.6977; train_edge_recon_loss: 175446.7166; train_cat_covariates_contrastive_loss: 79240.2702; train_gene_expr_recon_loss: 88472.5494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349388.2337; train_optim_loss: 349388.2337; val_kl_reg_loss: 6113.5893; val_edge_recon_loss: 174370.8179; val_cat_covariates_contrastive_loss: 78920.0035; val_gene_expr_recon_loss: 87877.8800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347282.2902; val_optim_loss: 347282.2902
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9630; val_auprc_score: 0.9682; val_best_acc_score: 0.9610; val_best_f1_score: 0.9712; train_kl_reg_loss: 6265.2467; train_edge_recon_loss: 175392.6561; train_cat_covariates_contrastive_loss: 79253.4752; train_gene_expr_recon_loss: 87686.9916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348598.3697; train_optim_loss: 348598.3697; val_kl_reg_loss: 6118.8985; val_edge_recon_loss: 175002.2041; val_cat_covariates_contrastive_loss: 78965.8293; val_gene_expr_recon_loss: 87440.5097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347527.4410; val_optim_loss: 347527.4410
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9634; val_auprc_score: 0.9685; val_best_acc_score: 0.9622; val_best_f1_score: 0.9720; train_kl_reg_loss: 6281.7780; train_edge_recon_loss: 175198.7648; train_cat_covariates_contrastive_loss: 79236.6398; train_gene_expr_recon_loss: 87203.5557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347920.7383; train_optim_loss: 347920.7383; val_kl_reg_loss: 6370.8422; val_edge_recon_loss: 174790.0910; val_cat_covariates_contrastive_loss: 78921.7121; val_gene_expr_recon_loss: 86752.1245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346834.7698; val_optim_loss: 346834.7698
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9649; val_auprc_score: 0.9695; val_best_acc_score: 0.9634; val_best_f1_score: 0.9728; train_kl_reg_loss: 6300.8495; train_edge_recon_loss: 175106.8608; train_cat_covariates_contrastive_loss: 79241.1619; train_gene_expr_recon_loss: 86766.8577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347415.7300; train_optim_loss: 347415.7300; val_kl_reg_loss: 6264.4772; val_edge_recon_loss: 175509.6204; val_cat_covariates_contrastive_loss: 78968.9307; val_gene_expr_recon_loss: 86378.7895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347121.8195; val_optim_loss: 347121.8195
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9605; val_auprc_score: 0.9650; val_best_acc_score: 0.9617; val_best_f1_score: 0.9717; train_kl_reg_loss: 6318.6747; train_edge_recon_loss: 174929.8598; train_cat_covariates_contrastive_loss: 79228.3509; train_gene_expr_recon_loss: 86470.5202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346947.4060; train_optim_loss: 346947.4060; val_kl_reg_loss: 6378.0278; val_edge_recon_loss: 175060.4523; val_cat_covariates_contrastive_loss: 78924.0069; val_gene_expr_recon_loss: 86350.7554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346713.2411; val_optim_loss: 346713.2411
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9639; val_auprc_score: 0.9680; val_best_acc_score: 0.9645; val_best_f1_score: 0.9738; train_kl_reg_loss: 6333.1603; train_edge_recon_loss: 175006.7296; train_cat_covariates_contrastive_loss: 79203.2698; train_gene_expr_recon_loss: 86187.2016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346730.3608; train_optim_loss: 346730.3608; val_kl_reg_loss: 6293.9041; val_edge_recon_loss: 173737.4675; val_cat_covariates_contrastive_loss: 78919.7648; val_gene_expr_recon_loss: 86450.7588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345401.8935; val_optim_loss: 345401.8935
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9624; val_auprc_score: 0.9664; val_best_acc_score: 0.9636; val_best_f1_score: 0.9730; train_kl_reg_loss: 6361.2699; train_edge_recon_loss: 174994.5754; train_cat_covariates_contrastive_loss: 79211.8450; train_gene_expr_recon_loss: 85864.1076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346431.7978; train_optim_loss: 346431.7978; val_kl_reg_loss: 6322.3773; val_edge_recon_loss: 175564.8643; val_cat_covariates_contrastive_loss: 78882.4211; val_gene_expr_recon_loss: 85935.0732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346704.7376; val_optim_loss: 346704.7376
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9651; val_auprc_score: 0.9695; val_best_acc_score: 0.9642; val_best_f1_score: 0.9734; train_kl_reg_loss: 6387.4452; train_edge_recon_loss: 174980.6703; train_cat_covariates_contrastive_loss: 79214.5342; train_gene_expr_recon_loss: 85706.8094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346289.4592; train_optim_loss: 346289.4592; val_kl_reg_loss: 6220.8335; val_edge_recon_loss: 175684.7631; val_cat_covariates_contrastive_loss: 78989.7569; val_gene_expr_recon_loss: 86025.0589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346920.4123; val_optim_loss: 346920.4123
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9647; val_auprc_score: 0.9694; val_best_acc_score: 0.9640; val_best_f1_score: 0.9733; train_kl_reg_loss: 6402.3302; train_edge_recon_loss: 175196.2102; train_cat_covariates_contrastive_loss: 79205.7816; train_gene_expr_recon_loss: 85510.6181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346314.9401; train_optim_loss: 346314.9401; val_kl_reg_loss: 6188.5924; val_edge_recon_loss: 174862.4684; val_cat_covariates_contrastive_loss: 79031.9791; val_gene_expr_recon_loss: 85809.3393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345892.3791; val_optim_loss: 345892.3791
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9623; val_auprc_score: 0.9667; val_best_acc_score: 0.9637; val_best_f1_score: 0.9732; train_kl_reg_loss: 6417.3092; train_edge_recon_loss: 174915.1282; train_cat_covariates_contrastive_loss: 79196.5462; train_gene_expr_recon_loss: 85302.5445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345831.5283; train_optim_loss: 345831.5283; val_kl_reg_loss: 6412.1290; val_edge_recon_loss: 174476.6129; val_cat_covariates_contrastive_loss: 78943.8324; val_gene_expr_recon_loss: 85856.2537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345688.8256; val_optim_loss: 345688.8256

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9624; val_auprc_score: 0.9666; val_best_acc_score: 0.9643; val_best_f1_score: 0.9736; train_kl_reg_loss: 6410.9986; train_edge_recon_loss: 174529.1378; train_cat_covariates_contrastive_loss: 79207.3173; train_gene_expr_recon_loss: 84769.5447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344916.9983; train_optim_loss: 344916.9983; val_kl_reg_loss: 6385.8363; val_edge_recon_loss: 174725.3795; val_cat_covariates_contrastive_loss: 78892.0826; val_gene_expr_recon_loss: 85375.8882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345379.1849; val_optim_loss: 345379.1849
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9626; val_auprc_score: 0.9667; val_best_acc_score: 0.9646; val_best_f1_score: 0.9738; train_kl_reg_loss: 6412.8135; train_edge_recon_loss: 174928.7464; train_cat_covariates_contrastive_loss: 79205.8808; train_gene_expr_recon_loss: 84691.3104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345238.7512; train_optim_loss: 345238.7512; val_kl_reg_loss: 6340.8497; val_edge_recon_loss: 175023.9970; val_cat_covariates_contrastive_loss: 78947.2576; val_gene_expr_recon_loss: 85047.1355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345359.2372; val_optim_loss: 345359.2372
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9630; val_auprc_score: 0.9670; val_best_acc_score: 0.9650; val_best_f1_score: 0.9741; train_kl_reg_loss: 6405.0287; train_edge_recon_loss: 174696.2149; train_cat_covariates_contrastive_loss: 79189.4762; train_gene_expr_recon_loss: 84585.6498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344876.3695; train_optim_loss: 344876.3695; val_kl_reg_loss: 6302.2851; val_edge_recon_loss: 174435.2736; val_cat_covariates_contrastive_loss: 78951.1202; val_gene_expr_recon_loss: 85491.3925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345180.0721; val_optim_loss: 345180.0721
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9635; val_auprc_score: 0.9670; val_best_acc_score: 0.9660; val_best_f1_score: 0.9749; train_kl_reg_loss: 6402.7621; train_edge_recon_loss: 174685.4087; train_cat_covariates_contrastive_loss: 79204.6780; train_gene_expr_recon_loss: 84568.9017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344861.7500; train_optim_loss: 344861.7500; val_kl_reg_loss: 6380.9122; val_edge_recon_loss: 173626.7347; val_cat_covariates_contrastive_loss: 78905.0542; val_gene_expr_recon_loss: 85096.2888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344008.9885; val_optim_loss: 344008.9885
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9629; val_auprc_score: 0.9673; val_best_acc_score: 0.9646; val_best_f1_score: 0.9738; train_kl_reg_loss: 6402.6808; train_edge_recon_loss: 174623.3316; train_cat_covariates_contrastive_loss: 79182.0394; train_gene_expr_recon_loss: 84520.0104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344728.0617; train_optim_loss: 344728.0617; val_kl_reg_loss: 6294.3792; val_edge_recon_loss: 174676.6671; val_cat_covariates_contrastive_loss: 78976.5607; val_gene_expr_recon_loss: 85028.9164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344976.5233; val_optim_loss: 344976.5233
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9613; val_auprc_score: 0.9652; val_best_acc_score: 0.9640; val_best_f1_score: 0.9734; train_kl_reg_loss: 6410.0572; train_edge_recon_loss: 174853.6177; train_cat_covariates_contrastive_loss: 79204.8041; train_gene_expr_recon_loss: 84516.1064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344984.5854; train_optim_loss: 344984.5854; val_kl_reg_loss: 6361.2546; val_edge_recon_loss: 174021.9295; val_cat_covariates_contrastive_loss: 78945.4049; val_gene_expr_recon_loss: 84889.0910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344217.6808; val_optim_loss: 344217.6808
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9632; val_auprc_score: 0.9669; val_best_acc_score: 0.9648; val_best_f1_score: 0.9739; train_kl_reg_loss: 6415.3773; train_edge_recon_loss: 174603.5840; train_cat_covariates_contrastive_loss: 79208.5589; train_gene_expr_recon_loss: 84469.7233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344697.2432; train_optim_loss: 344697.2432; val_kl_reg_loss: 6333.3681; val_edge_recon_loss: 175399.5033; val_cat_covariates_contrastive_loss: 78918.8126; val_gene_expr_recon_loss: 84914.3170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345566.0010; val_optim_loss: 345566.0010
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9625; val_auprc_score: 0.9665; val_best_acc_score: 0.9650; val_best_f1_score: 0.9740; train_kl_reg_loss: 6411.8888; train_edge_recon_loss: 174732.4399; train_cat_covariates_contrastive_loss: 79202.5257; train_gene_expr_recon_loss: 84369.2816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344716.1366; train_optim_loss: 344716.1366; val_kl_reg_loss: 6299.5016; val_edge_recon_loss: 174779.7977; val_cat_covariates_contrastive_loss: 79012.6629; val_gene_expr_recon_loss: 84869.6618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344961.6260; val_optim_loss: 344961.6260

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9630; val_auprc_score: 0.9668; val_best_acc_score: 0.9652; val_best_f1_score: 0.9742; train_kl_reg_loss: 6407.1131; train_edge_recon_loss: 174804.8227; train_cat_covariates_contrastive_loss: 79203.2105; train_gene_expr_recon_loss: 84348.6587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344763.8054; train_optim_loss: 344763.8054; val_kl_reg_loss: 6331.1729; val_edge_recon_loss: 175300.5985; val_cat_covariates_contrastive_loss: 78922.9719; val_gene_expr_recon_loss: 84994.4015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345549.1470; val_optim_loss: 345549.1470
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9633; val_auprc_score: 0.9671; val_best_acc_score: 0.9654; val_best_f1_score: 0.9743; train_kl_reg_loss: 6415.7209; train_edge_recon_loss: 174898.0713; train_cat_covariates_contrastive_loss: 79197.9865; train_gene_expr_recon_loss: 84375.2994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344887.0786; train_optim_loss: 344887.0786; val_kl_reg_loss: 6341.9602; val_edge_recon_loss: 174781.0233; val_cat_covariates_contrastive_loss: 78966.9616; val_gene_expr_recon_loss: 84975.9535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345065.8986; val_optim_loss: 345065.8986
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9627; val_auprc_score: 0.9662; val_best_acc_score: 0.9647; val_best_f1_score: 0.9738; train_kl_reg_loss: 6408.4850; train_edge_recon_loss: 174725.7408; train_cat_covariates_contrastive_loss: 79184.8041; train_gene_expr_recon_loss: 84335.8912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344654.9214; train_optim_loss: 344654.9214; val_kl_reg_loss: 6334.9130; val_edge_recon_loss: 175143.1590; val_cat_covariates_contrastive_loss: 78954.5237; val_gene_expr_recon_loss: 85282.9827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345715.5807; val_optim_loss: 345715.5807
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9634; val_auprc_score: 0.9673; val_best_acc_score: 0.9651; val_best_f1_score: 0.9741; train_kl_reg_loss: 6412.7215; train_edge_recon_loss: 174667.0718; train_cat_covariates_contrastive_loss: 79205.8102; train_gene_expr_recon_loss: 84310.2931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344595.8957; train_optim_loss: 344595.8957; val_kl_reg_loss: 6349.7409; val_edge_recon_loss: 174789.0110; val_cat_covariates_contrastive_loss: 78955.8046; val_gene_expr_recon_loss: 84965.5253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345060.0810; val_optim_loss: 345060.0810

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 153 min 58 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9620
Val AUPRC score: 0.9657
Val best accuracy score: 0.9642
Val best F1 score: 0.9735
Val gene expr MSE score: 0.5129

Computing neighbor graph...
