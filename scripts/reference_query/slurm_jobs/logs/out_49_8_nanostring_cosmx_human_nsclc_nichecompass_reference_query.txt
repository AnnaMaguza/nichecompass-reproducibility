Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--query_batches', 'batch8', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '19102023_172905_49', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_cat_covariates_contrastive', '0.', '--contrastive_logits_pos_ratio', '0.', '--contrastive_logits_neg_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 68882
Number of validation nodes: 7654
Number of training edges: 162180
Number of validation edges: 18020
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9018; val_auprc_score: 0.9007; val_best_acc_score: 0.8207; val_best_f1_score: 0.8255; train_kl_reg_loss: 69728.8624; train_edge_recon_loss: 31696853.2114; train_gene_expr_recon_loss: 27455830.1009; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59229044.0631; train_optim_loss: 59229044.0631; val_kl_reg_loss: 70067.3572; val_edge_recon_loss: 32370822.7778; val_gene_expr_recon_loss: 24872972.9444; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57320494.6667; val_optim_loss: 57320494.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9020; val_auprc_score: 0.9024; val_best_acc_score: 0.8193; val_best_f1_score: 0.8242; train_kl_reg_loss: 69738.0938; train_edge_recon_loss: 31694481.0410; train_gene_expr_recon_loss: 23952488.9590; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55723340.0252; train_optim_loss: 55723340.0252; val_kl_reg_loss: 69882.1096; val_edge_recon_loss: 32425348.3333; val_gene_expr_recon_loss: 23080133.2222; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55581995.8889; val_optim_loss: 55581995.8889
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9024; val_auprc_score: 0.9023; val_best_acc_score: 0.8197; val_best_f1_score: 0.8250; train_kl_reg_loss: 69767.0672; train_edge_recon_loss: 31706576.3091; train_gene_expr_recon_loss: 22964100.2713; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54747075.6215; train_optim_loss: 54747075.6215; val_kl_reg_loss: 69909.7053; val_edge_recon_loss: 32402232.2222; val_gene_expr_recon_loss: 22652829.8889; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55131604.3333; val_optim_loss: 55131604.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9010; val_auprc_score: 0.8999; val_best_acc_score: 0.8187; val_best_f1_score: 0.8250; train_kl_reg_loss: 69731.7157; train_edge_recon_loss: 31719713.7476; train_gene_expr_recon_loss: 22609440.2208; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54405517.6909; train_optim_loss: 54405517.6909; val_kl_reg_loss: 69831.4974; val_edge_recon_loss: 32428528.0000; val_gene_expr_recon_loss: 22436605.2778; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54941596.7778; val_optim_loss: 54941596.7778
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9046; val_auprc_score: 0.9033; val_best_acc_score: 0.8218; val_best_f1_score: 0.8278; train_kl_reg_loss: 69704.8792; train_edge_recon_loss: 31692288.5994; train_gene_expr_recon_loss: 22459309.3123; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54227934.8391; train_optim_loss: 54227934.8391; val_kl_reg_loss: 69813.2578; val_edge_recon_loss: 32341832.4444; val_gene_expr_recon_loss: 22317210.1111; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54735487.6667; val_optim_loss: 54735487.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9023; val_auprc_score: 0.9013; val_best_acc_score: 0.8186; val_best_f1_score: 0.8254; train_kl_reg_loss: 69705.4391; train_edge_recon_loss: 31708025.8612; train_gene_expr_recon_loss: 22341362.3596; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54125725.6909; train_optim_loss: 54125725.6909; val_kl_reg_loss: 69751.9253; val_edge_recon_loss: 32391619.7222; val_gene_expr_recon_loss: 22121184.0556; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54589187.4444; val_optim_loss: 54589187.4444
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9018; val_auprc_score: 0.9013; val_best_acc_score: 0.8196; val_best_f1_score: 0.8243; train_kl_reg_loss: 69735.6547; train_edge_recon_loss: 31707398.6940; train_gene_expr_recon_loss: 22276305.5394; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54060071.9495; train_optim_loss: 54060071.9495; val_kl_reg_loss: 69907.0015; val_edge_recon_loss: 32400602.0000; val_gene_expr_recon_loss: 22099070.8333; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54576211.6667; val_optim_loss: 54576211.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9028; val_auprc_score: 0.9020; val_best_acc_score: 0.8193; val_best_f1_score: 0.8253; train_kl_reg_loss: 69766.0220; train_edge_recon_loss: 31712235.2492; train_gene_expr_recon_loss: 22178057.3628; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53966690.6751; train_optim_loss: 53966690.6751; val_kl_reg_loss: 69789.3275; val_edge_recon_loss: 32381792.3889; val_gene_expr_recon_loss: 22060456.0000; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54518669.8889; val_optim_loss: 54518669.8889
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9027; val_auprc_score: 0.9022; val_best_acc_score: 0.8203; val_best_f1_score: 0.8278; train_kl_reg_loss: 69724.7110; train_edge_recon_loss: 31720851.6782; train_gene_expr_recon_loss: 22099211.9685; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53896420.2650; train_optim_loss: 53896420.2650; val_kl_reg_loss: 69802.9162; val_edge_recon_loss: 32401614.3889; val_gene_expr_recon_loss: 22006122.7222; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54484171.6667; val_optim_loss: 54484171.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9030; val_auprc_score: 0.9028; val_best_acc_score: 0.8196; val_best_f1_score: 0.8257; train_kl_reg_loss: 69749.9829; train_edge_recon_loss: 31697316.4669; train_gene_expr_recon_loss: 22095332.4858; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53869030.7508; train_optim_loss: 53869030.7508; val_kl_reg_loss: 69928.6063; val_edge_recon_loss: 32366178.2778; val_gene_expr_recon_loss: 21890659.7222; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54333398.6667; val_optim_loss: 54333398.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8993; val_auprc_score: 0.8986; val_best_acc_score: 0.8161; val_best_f1_score: 0.8223; train_kl_reg_loss: 69729.8410; train_edge_recon_loss: 31705394.7634; train_gene_expr_recon_loss: 22064658.6940; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53846415.3312; train_optim_loss: 53846415.3312; val_kl_reg_loss: 69772.4664; val_edge_recon_loss: 32500128.7778; val_gene_expr_recon_loss: 21897697.0556; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54474229.8889; val_optim_loss: 54474229.8889
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9003; val_auprc_score: 0.8993; val_best_acc_score: 0.8166; val_best_f1_score: 0.8234; train_kl_reg_loss: 69721.6653; train_edge_recon_loss: 31704023.4826; train_gene_expr_recon_loss: 22036064.1199; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53816441.5142; train_optim_loss: 53816441.5142; val_kl_reg_loss: 69697.6226; val_edge_recon_loss: 32449237.2778; val_gene_expr_recon_loss: 21804556.7222; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54330123.6667; val_optim_loss: 54330123.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9025; val_auprc_score: 0.9025; val_best_acc_score: 0.8199; val_best_f1_score: 0.8250; train_kl_reg_loss: 69709.5026; train_edge_recon_loss: 31699533.3502; train_gene_expr_recon_loss: 22001816.1830; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53777691.1798; train_optim_loss: 53777691.1798; val_kl_reg_loss: 69942.6376; val_edge_recon_loss: 32396596.5000; val_gene_expr_recon_loss: 21900049.2222; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54373220.2222; val_optim_loss: 54373220.2222
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8997; val_auprc_score: 0.8979; val_best_acc_score: 0.8168; val_best_f1_score: 0.8238; train_kl_reg_loss: 69740.6798; train_edge_recon_loss: 31707819.1420; train_gene_expr_recon_loss: 21990363.7476; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53774555.3943; train_optim_loss: 53774555.3943; val_kl_reg_loss: 69953.2361; val_edge_recon_loss: 32408738.6111; val_gene_expr_recon_loss: 21811579.1667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54296902.7778; val_optim_loss: 54296902.7778
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9009; val_auprc_score: 0.8997; val_best_acc_score: 0.8193; val_best_f1_score: 0.8244; train_kl_reg_loss: 69734.9378; train_edge_recon_loss: 31702692.4669; train_gene_expr_recon_loss: 21950726.4038; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53729785.8549; train_optim_loss: 53729785.8549; val_kl_reg_loss: 69889.6102; val_edge_recon_loss: 32419093.5000; val_gene_expr_recon_loss: 21842496.7778; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54338112.1111; val_optim_loss: 54338112.1111
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9042; val_auprc_score: 0.9038; val_best_acc_score: 0.8226; val_best_f1_score: 0.8271; train_kl_reg_loss: 69729.3784; train_edge_recon_loss: 31693438.2145; train_gene_expr_recon_loss: 21955426.4290; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53725225.9432; train_optim_loss: 53725225.9432; val_kl_reg_loss: 69916.0645; val_edge_recon_loss: 32365974.9444; val_gene_expr_recon_loss: 21851270.4444; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54293793.4444; val_optim_loss: 54293793.4444
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9029; val_auprc_score: 0.9031; val_best_acc_score: 0.8189; val_best_f1_score: 0.8261; train_kl_reg_loss: 69745.1192; train_edge_recon_loss: 31725889.4385; train_gene_expr_recon_loss: 21933525.1230; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53735791.6972; train_optim_loss: 53735791.6972; val_kl_reg_loss: 69933.9993; val_edge_recon_loss: 32418813.7222; val_gene_expr_recon_loss: 21873827.3333; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54369207.1111; val_optim_loss: 54369207.1111
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9038; val_auprc_score: 0.9041; val_best_acc_score: 0.8213; val_best_f1_score: 0.8264; train_kl_reg_loss: 69753.2212; train_edge_recon_loss: 31717729.3628; train_gene_expr_recon_loss: 21950192.2334; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53744306.7886; train_optim_loss: 53744306.7886; val_kl_reg_loss: 69911.2520; val_edge_recon_loss: 32377792.3889; val_gene_expr_recon_loss: 21800662.3333; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54254997.8889; val_optim_loss: 54254997.8889
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9014; val_auprc_score: 0.9011; val_best_acc_score: 0.8175; val_best_f1_score: 0.8244; train_kl_reg_loss: 69725.3382; train_edge_recon_loss: 31695397.2114; train_gene_expr_recon_loss: 21908070.2713; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53679824.8328; train_optim_loss: 53679824.8328; val_kl_reg_loss: 69876.5935; val_edge_recon_loss: 32420615.1111; val_gene_expr_recon_loss: 21873041.6667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54370165.5556; val_optim_loss: 54370165.5556
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9003; val_auprc_score: 0.8983; val_best_acc_score: 0.8175; val_best_f1_score: 0.8250; train_kl_reg_loss: 69688.7347; train_edge_recon_loss: 31721240.1767; train_gene_expr_recon_loss: 21898063.2555; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53695624.1388; train_optim_loss: 53695624.1388; val_kl_reg_loss: 69968.2079; val_edge_recon_loss: 32418277.2222; val_gene_expr_recon_loss: 21823829.5000; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54318706.6667; val_optim_loss: 54318706.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9022; val_auprc_score: 0.9017; val_best_acc_score: 0.8184; val_best_f1_score: 0.8258; train_kl_reg_loss: 69753.7559; train_edge_recon_loss: 31717066.3722; train_gene_expr_recon_loss: 21914473.8170; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53707926.0189; train_optim_loss: 53707926.0189; val_kl_reg_loss: 69844.4648; val_edge_recon_loss: 32389611.0556; val_gene_expr_recon_loss: 21779463.2222; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54245551.0000; val_optim_loss: 54245551.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9016; val_auprc_score: 0.9006; val_best_acc_score: 0.8211; val_best_f1_score: 0.8267; train_kl_reg_loss: 69725.6473; train_edge_recon_loss: 31721203.0284; train_gene_expr_recon_loss: 21893516.3722; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53691077.1861; train_optim_loss: 53691077.1861; val_kl_reg_loss: 69901.6389; val_edge_recon_loss: 32433373.6111; val_gene_expr_recon_loss: 21801410.1111; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54311316.8889; val_optim_loss: 54311316.8889
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9019; val_auprc_score: 0.9012; val_best_acc_score: 0.8181; val_best_f1_score: 0.8248; train_kl_reg_loss: 69747.4397; train_edge_recon_loss: 31703271.2681; train_gene_expr_recon_loss: 21899947.2429; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53679598.0694; train_optim_loss: 53679598.0694; val_kl_reg_loss: 69864.6304; val_edge_recon_loss: 32358019.7778; val_gene_expr_recon_loss: 21849833.5000; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54284349.7778; val_optim_loss: 54284349.7778
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9019; val_auprc_score: 0.9016; val_best_acc_score: 0.8195; val_best_f1_score: 0.8259; train_kl_reg_loss: 69725.5435; train_edge_recon_loss: 31712187.1420; train_gene_expr_recon_loss: 21885465.8927; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53674010.5363; train_optim_loss: 53674010.5363; val_kl_reg_loss: 69774.2454; val_edge_recon_loss: 32418351.4444; val_gene_expr_recon_loss: 21791897.8889; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54286655.4444; val_optim_loss: 54286655.4444
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9015; val_auprc_score: 0.9001; val_best_acc_score: 0.8193; val_best_f1_score: 0.8254; train_kl_reg_loss: 69733.1497; train_edge_recon_loss: 31690061.4953; train_gene_expr_recon_loss: 21903369.9621; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53669796.5047; train_optim_loss: 53669796.5047; val_kl_reg_loss: 69857.5768; val_edge_recon_loss: 32401577.2778; val_gene_expr_recon_loss: 21764156.8889; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54242223.4444; val_optim_loss: 54242223.4444
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9008; val_auprc_score: 0.9001; val_best_acc_score: 0.8178; val_best_f1_score: 0.8252; train_kl_reg_loss: 69735.5973; train_edge_recon_loss: 31845689.0662; train_gene_expr_recon_loss: 21261558.0379; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53183614.6120; train_optim_loss: 53183614.6120; val_kl_reg_loss: 62530.4838; val_edge_recon_loss: 32560489.3889; val_gene_expr_recon_loss: 21165863.6667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53795515.5556; val_optim_loss: 53795515.5556
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9011; val_auprc_score: 0.9010; val_best_acc_score: 0.8174; val_best_f1_score: 0.8250; train_kl_reg_loss: 69756.9096; train_edge_recon_loss: 31851236.3975; train_gene_expr_recon_loss: 21248771.0158; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53176396.3155; train_optim_loss: 53176396.3155; val_kl_reg_loss: 62589.0383; val_edge_recon_loss: 32597791.3333; val_gene_expr_recon_loss: 21172566.8333; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53839579.4444; val_optim_loss: 53839579.4444
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9015; val_auprc_score: 0.9001; val_best_acc_score: 0.8185; val_best_f1_score: 0.8255; train_kl_reg_loss: 69759.6759; train_edge_recon_loss: 31837216.7634; train_gene_expr_recon_loss: 21204281.5962; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53117890.0063; train_optim_loss: 53117890.0063; val_kl_reg_loss: 62485.9771; val_edge_recon_loss: 32613616.6111; val_gene_expr_recon_loss: 21088287.6667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53771022.0000; val_optim_loss: 53771022.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9011; val_auprc_score: 0.9001; val_best_acc_score: 0.8180; val_best_f1_score: 0.8253; train_kl_reg_loss: 69719.4673; train_edge_recon_loss: 31849950.5868; train_gene_expr_recon_loss: 21242414.4795; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53168716.5552; train_optim_loss: 53168716.5552; val_kl_reg_loss: 62616.3459; val_edge_recon_loss: 32582250.1111; val_gene_expr_recon_loss: 21090377.0556; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53741875.5556; val_optim_loss: 53741875.5556
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9008; val_auprc_score: 0.9001; val_best_acc_score: 0.8172; val_best_f1_score: 0.8240; train_kl_reg_loss: 69685.8991; train_edge_recon_loss: 31836744.5426; train_gene_expr_recon_loss: 21210468.1199; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53123530.6751; train_optim_loss: 53123530.6751; val_kl_reg_loss: 62448.0553; val_edge_recon_loss: 32616772.1667; val_gene_expr_recon_loss: 21086322.9444; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53772175.2222; val_optim_loss: 53772175.2222
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9029; val_auprc_score: 0.9021; val_best_acc_score: 0.8202; val_best_f1_score: 0.8261; train_kl_reg_loss: 69746.3309; train_edge_recon_loss: 31861838.6183; train_gene_expr_recon_loss: 21227239.5899; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53165456.5931; train_optim_loss: 53165456.5931; val_kl_reg_loss: 62574.4947; val_edge_recon_loss: 32545670.3333; val_gene_expr_recon_loss: 21129847.1667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53744724.0000; val_optim_loss: 53744724.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8997; val_auprc_score: 0.8984; val_best_acc_score: 0.8175; val_best_f1_score: 0.8238; train_kl_reg_loss: 69717.5755; train_edge_recon_loss: 31847159.7603; train_gene_expr_recon_loss: 21197877.7287; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53121387.2050; train_optim_loss: 53121387.2050; val_kl_reg_loss: 62481.8843; val_edge_recon_loss: 32638999.9444; val_gene_expr_recon_loss: 21116570.6667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53824684.3333; val_optim_loss: 53824684.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9014; val_auprc_score: 0.9011; val_best_acc_score: 0.8188; val_best_f1_score: 0.8262; train_kl_reg_loss: 69713.9756; train_edge_recon_loss: 31842276.1767; train_gene_expr_recon_loss: 21219030.2145; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53137652.3028; train_optim_loss: 53137652.3028; val_kl_reg_loss: 62555.3453; val_edge_recon_loss: 32612653.0556; val_gene_expr_recon_loss: 21139116.0000; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53820956.4444; val_optim_loss: 53820956.4444

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9007; val_auprc_score: 0.9000; val_best_acc_score: 0.8187; val_best_f1_score: 0.8250; train_kl_reg_loss: 69761.2909; train_edge_recon_loss: 31831010.2839; train_gene_expr_recon_loss: 21238675.3186; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53146079.0032; train_optim_loss: 53146079.0032; val_kl_reg_loss: 62502.9797; val_edge_recon_loss: 32615526.5556; val_gene_expr_recon_loss: 21049094.9444; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53733756.7778; val_optim_loss: 53733756.7778
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9013; val_auprc_score: 0.9005; val_best_acc_score: 0.8190; val_best_f1_score: 0.8258; train_kl_reg_loss: 69689.1583; train_edge_recon_loss: 31830105.0032; train_gene_expr_recon_loss: 21196701.9243; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53103128.1262; train_optim_loss: 53103128.1262; val_kl_reg_loss: 62519.7032; val_edge_recon_loss: 32599213.7222; val_gene_expr_recon_loss: 21127911.6667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53796277.3333; val_optim_loss: 53796277.3333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8996; val_auprc_score: 0.8988; val_best_acc_score: 0.8153; val_best_f1_score: 0.8240; train_kl_reg_loss: 69728.6645; train_edge_recon_loss: 31848518.4038; train_gene_expr_recon_loss: 21204706.0063; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53129585.2366; train_optim_loss: 53129585.2366; val_kl_reg_loss: 62636.3289; val_edge_recon_loss: 32604469.2222; val_gene_expr_recon_loss: 21085373.9444; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53759111.6667; val_optim_loss: 53759111.6667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9016; val_auprc_score: 0.9010; val_best_acc_score: 0.8211; val_best_f1_score: 0.8255; train_kl_reg_loss: 69778.5236; train_edge_recon_loss: 31842085.7476; train_gene_expr_recon_loss: 21208228.9022; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53126725.2871; train_optim_loss: 53126725.2871; val_kl_reg_loss: 62540.5042; val_edge_recon_loss: 32587404.3889; val_gene_expr_recon_loss: 21129250.2778; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53785827.3333; val_optim_loss: 53785827.3333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9007; val_auprc_score: 0.8996; val_best_acc_score: 0.8173; val_best_f1_score: 0.8247; train_kl_reg_loss: 69728.5191; train_edge_recon_loss: 31864813.7603; train_gene_expr_recon_loss: 21205199.8864; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53146374.0315; train_optim_loss: 53146374.0315; val_kl_reg_loss: 62467.7164; val_edge_recon_loss: 32584478.0000; val_gene_expr_recon_loss: 21123470.3333; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53777047.7778; val_optim_loss: 53777047.7778

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9015; val_auprc_score: 0.8998; val_best_acc_score: 0.8180; val_best_f1_score: 0.8246; train_kl_reg_loss: 69705.6514; train_edge_recon_loss: 31833072.0315; train_gene_expr_recon_loss: 21218645.8927; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53128055.5457; train_optim_loss: 53128055.5457; val_kl_reg_loss: 62646.7206; val_edge_recon_loss: 32580242.2778; val_gene_expr_recon_loss: 21128810.5000; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53778331.1111; val_optim_loss: 53778331.1111
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9015; val_auprc_score: 0.9006; val_best_acc_score: 0.8193; val_best_f1_score: 0.8262; train_kl_reg_loss: 69690.5985; train_edge_recon_loss: 31836571.7035; train_gene_expr_recon_loss: 21216908.1262; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53129802.5237; train_optim_loss: 53129802.5237; val_kl_reg_loss: 62622.3651; val_edge_recon_loss: 32585199.6111; val_gene_expr_recon_loss: 21166727.3889; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53821181.3333; val_optim_loss: 53821181.3333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9024; val_auprc_score: 0.9010; val_best_acc_score: 0.8209; val_best_f1_score: 0.8269; train_kl_reg_loss: 69772.5406; train_edge_recon_loss: 31826516.5994; train_gene_expr_recon_loss: 21208319.9748; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53111241.1735; train_optim_loss: 53111241.1735; val_kl_reg_loss: 62502.4947; val_edge_recon_loss: 32564862.5000; val_gene_expr_recon_loss: 21165020.3333; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53799017.1111; val_optim_loss: 53799017.1111
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9028; val_auprc_score: 0.9023; val_best_acc_score: 0.8196; val_best_f1_score: 0.8273; train_kl_reg_loss: 69740.0358; train_edge_recon_loss: 31840215.1356; train_gene_expr_recon_loss: 21222959.7792; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53139546.9274; train_optim_loss: 53139546.9274; val_kl_reg_loss: 62637.9135; val_edge_recon_loss: 32545848.3333; val_gene_expr_recon_loss: 21110420.2222; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53725538.1111; val_optim_loss: 53725538.1111
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9024; val_auprc_score: 0.9013; val_best_acc_score: 0.8207; val_best_f1_score: 0.8262; train_kl_reg_loss: 69733.3107; train_edge_recon_loss: 31852164.3281; train_gene_expr_recon_loss: 21216088.6498; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53144618.3218; train_optim_loss: 53144618.3218; val_kl_reg_loss: 62618.3663; val_edge_recon_loss: 32547460.4444; val_gene_expr_recon_loss: 21088402.6667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53705113.2222; val_optim_loss: 53705113.2222
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8993; val_auprc_score: 0.8983; val_best_acc_score: 0.8157; val_best_f1_score: 0.8227; train_kl_reg_loss: 69744.1797; train_edge_recon_loss: 31846934.2524; train_gene_expr_recon_loss: 21210646.6435; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53133957.0978; train_optim_loss: 53133957.0978; val_kl_reg_loss: 62523.2489; val_edge_recon_loss: 32698950.6111; val_gene_expr_recon_loss: 21156783.7222; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53924889.5556; val_optim_loss: 53924889.5556
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9012; val_auprc_score: 0.9004; val_best_acc_score: 0.8202; val_best_f1_score: 0.8264; train_kl_reg_loss: 69758.2840; train_edge_recon_loss: 31832991.8801; train_gene_expr_recon_loss: 21250881.7098; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53160263.9243; train_optim_loss: 53160263.9243; val_kl_reg_loss: 62621.2094; val_edge_recon_loss: 32575763.2222; val_gene_expr_recon_loss: 21187397.6667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53832414.2222; val_optim_loss: 53832414.2222
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9008; val_auprc_score: 0.8996; val_best_acc_score: 0.8165; val_best_f1_score: 0.8249; train_kl_reg_loss: 69752.6941; train_edge_recon_loss: 31838166.5489; train_gene_expr_recon_loss: 21210936.9464; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53125488.2397; train_optim_loss: 53125488.2397; val_kl_reg_loss: 62438.8014; val_edge_recon_loss: 32574602.3889; val_gene_expr_recon_loss: 21149510.8889; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53793184.1111; val_optim_loss: 53793184.1111
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9003; val_auprc_score: 0.8988; val_best_acc_score: 0.8188; val_best_f1_score: 0.8242; train_kl_reg_loss: 69705.8751; train_edge_recon_loss: 31833264.8139; train_gene_expr_recon_loss: 21220067.7476; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53129670.3091; train_optim_loss: 53129670.3091; val_kl_reg_loss: 62485.1649; val_edge_recon_loss: 32630656.3889; val_gene_expr_recon_loss: 21069520.3889; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53769294.2222; val_optim_loss: 53769294.2222

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8989; val_auprc_score: 0.8967; val_best_acc_score: 0.8151; val_best_f1_score: 0.8230; train_kl_reg_loss: 69734.1493; train_edge_recon_loss: 31835866.3785; train_gene_expr_recon_loss: 21220436.8202; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53132669.2871; train_optim_loss: 53132669.2871; val_kl_reg_loss: 62454.6904; val_edge_recon_loss: 32635548.1667; val_gene_expr_recon_loss: 21091953.0556; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53796588.0000; val_optim_loss: 53796588.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9005; val_auprc_score: 0.8991; val_best_acc_score: 0.8186; val_best_f1_score: 0.8253; train_kl_reg_loss: 69713.4603; train_edge_recon_loss: 31850738.2650; train_gene_expr_recon_loss: 21203099.6404; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53130183.4322; train_optim_loss: 53130183.4322; val_kl_reg_loss: 62527.2703; val_edge_recon_loss: 32647272.2222; val_gene_expr_recon_loss: 21182269.6667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53898701.2222; val_optim_loss: 53898701.2222
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9020; val_auprc_score: 0.9006; val_best_acc_score: 0.8192; val_best_f1_score: 0.8270; train_kl_reg_loss: 69714.6067; train_edge_recon_loss: 31840911.8864; train_gene_expr_recon_loss: 21218621.7224; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53135880.2397; train_optim_loss: 53135880.2397; val_kl_reg_loss: 62519.6445; val_edge_recon_loss: 32532376.6667; val_gene_expr_recon_loss: 21127391.0556; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53728919.4444; val_optim_loss: 53728919.4444
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9004; val_auprc_score: 0.8994; val_best_acc_score: 0.8180; val_best_f1_score: 0.8247; train_kl_reg_loss: 69679.1484; train_edge_recon_loss: 31841410.7445; train_gene_expr_recon_loss: 21223296.9590; train_masked_gp_l1_reg_loss: 6631.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53141018.9527; train_optim_loss: 53141018.9527; val_kl_reg_loss: 62550.7293; val_edge_recon_loss: 32576436.0000; val_gene_expr_recon_loss: 21142704.1667; val_masked_gp_l1_reg_loss: 6631.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53788322.4444; val_optim_loss: 53788322.4444

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 60 min 54 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9024
val AUPRC score: 0.9011
val best accuracy score: 0.8202
val best F1 score: 0.8267
val target rna MSE score: 2.3352
val source rna MSE score: 0.3756
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0116
Val cat covariate2 mean sim diff: nan

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
