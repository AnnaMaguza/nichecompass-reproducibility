Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--query_batches', 'batch4', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '03092023_011939_7', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 75351
Number of validation nodes: 8372
Number of training edges: 175771
Number of validation edges: 19530
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8401; val_auprc_score: 0.8485; val_best_acc_score: 0.7502; val_best_f1_score: 0.7543; train_kl_reg_loss: 21888.6028; train_edge_recon_loss: 3337550.9528; train_gene_expr_recon_loss: 8118023.1337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 11477462.6948; train_optim_loss: 11477462.6948; val_kl_reg_loss: 22002.0604; val_edge_recon_loss: 3400993.8590; val_gene_expr_recon_loss: 6167339.9872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 9590335.9487; val_optim_loss: 9590335.9487
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8414; val_auprc_score: 0.8482; val_best_acc_score: 0.7513; val_best_f1_score: 0.7570; train_kl_reg_loss: 21883.9791; train_edge_recon_loss: 3337310.5087; train_gene_expr_recon_loss: 5439910.4782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8799104.9927; train_optim_loss: 8799104.9927; val_kl_reg_loss: 21972.4307; val_edge_recon_loss: 3392478.5256; val_gene_expr_recon_loss: 4802392.5256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8216843.4872; val_optim_loss: 8216843.4872
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8408; val_auprc_score: 0.8489; val_best_acc_score: 0.7513; val_best_f1_score: 0.7549; train_kl_reg_loss: 21883.8808; train_edge_recon_loss: 3337459.3154; train_gene_expr_recon_loss: 4423786.1177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7783129.2936; train_optim_loss: 7783129.2936; val_kl_reg_loss: 21973.2700; val_edge_recon_loss: 3397258.3846; val_gene_expr_recon_loss: 4086999.4936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7506231.1667; val_optim_loss: 7506231.1667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8416; val_auprc_score: 0.8498; val_best_acc_score: 0.7523; val_best_f1_score: 0.7556; train_kl_reg_loss: 21887.0615; train_edge_recon_loss: 3339019.9571; train_gene_expr_recon_loss: 3856054.1432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7216961.1395; train_optim_loss: 7216961.1395; val_kl_reg_loss: 21963.8498; val_edge_recon_loss: 3393551.6410; val_gene_expr_recon_loss: 3648254.8397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7063770.3462; val_optim_loss: 7063770.3462
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8402; val_auprc_score: 0.8487; val_best_acc_score: 0.7495; val_best_f1_score: 0.7549; train_kl_reg_loss: 21875.3290; train_edge_recon_loss: 3333604.8459; train_gene_expr_recon_loss: 3533698.7682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6889178.9404; train_optim_loss: 6889178.9404; val_kl_reg_loss: 21976.8752; val_edge_recon_loss: 3401848.1603; val_gene_expr_recon_loss: 3414852.1731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6838677.1923; val_optim_loss: 6838677.1923
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8435; val_auprc_score: 0.8509; val_best_acc_score: 0.7523; val_best_f1_score: 0.7580; train_kl_reg_loss: 21879.3974; train_edge_recon_loss: 3335960.4004; train_gene_expr_recon_loss: 3365155.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6722995.6410; train_optim_loss: 6722995.6410; val_kl_reg_loss: 22002.8244; val_edge_recon_loss: 3390440.1859; val_gene_expr_recon_loss: 3307946.3718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6720389.3974; val_optim_loss: 6720389.3974
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8416; val_auprc_score: 0.8480; val_best_acc_score: 0.7512; val_best_f1_score: 0.7573; train_kl_reg_loss: 21888.9488; train_edge_recon_loss: 3334570.0581; train_gene_expr_recon_loss: 3278421.3183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6634880.3343; train_optim_loss: 6634880.3343; val_kl_reg_loss: 21926.8400; val_edge_recon_loss: 3392619.7372; val_gene_expr_recon_loss: 3219262.5962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6633809.1923; val_optim_loss: 6633809.1923
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8428; val_auprc_score: 0.8508; val_best_acc_score: 0.7535; val_best_f1_score: 0.7570; train_kl_reg_loss: 21880.6416; train_edge_recon_loss: 3336157.7638; train_gene_expr_recon_loss: 3210177.9949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6568216.3939; train_optim_loss: 6568216.3939; val_kl_reg_loss: 21964.5035; val_edge_recon_loss: 3395038.1410; val_gene_expr_recon_loss: 3172525.7436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6589528.3974; val_optim_loss: 6589528.3974
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8435; val_auprc_score: 0.8518; val_best_acc_score: 0.7517; val_best_f1_score: 0.7571; train_kl_reg_loss: 21885.2597; train_edge_recon_loss: 3337161.6606; train_gene_expr_recon_loss: 3156448.6722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6515495.5901; train_optim_loss: 6515495.5901; val_kl_reg_loss: 21971.4477; val_edge_recon_loss: 3390644.7821; val_gene_expr_recon_loss: 3118275.1538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6530891.3718; val_optim_loss: 6530891.3718
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8441; val_auprc_score: 0.8514; val_best_acc_score: 0.7545; val_best_f1_score: 0.7591; train_kl_reg_loss: 21881.6842; train_edge_recon_loss: 3335824.6483; train_gene_expr_recon_loss: 3105620.2645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6463326.6076; train_optim_loss: 6463326.6076; val_kl_reg_loss: 21957.7807; val_edge_recon_loss: 3390681.1795; val_gene_expr_recon_loss: 3061155.0128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6473794.0000; val_optim_loss: 6473794.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8442; val_auprc_score: 0.8512; val_best_acc_score: 0.7537; val_best_f1_score: 0.7582; train_kl_reg_loss: 21881.2181; train_edge_recon_loss: 3335581.4804; train_gene_expr_recon_loss: 3057461.4230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6414924.1119; train_optim_loss: 6414924.1119; val_kl_reg_loss: 21973.8669; val_edge_recon_loss: 3388370.9167; val_gene_expr_recon_loss: 3026520.9038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6436865.6795; val_optim_loss: 6436865.6795
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8406; val_auprc_score: 0.8481; val_best_acc_score: 0.7509; val_best_f1_score: 0.7552; train_kl_reg_loss: 21876.8017; train_edge_recon_loss: 3335525.0560; train_gene_expr_recon_loss: 3010794.1308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6368195.9927; train_optim_loss: 6368195.9927; val_kl_reg_loss: 21983.2648; val_edge_recon_loss: 3398155.7628; val_gene_expr_recon_loss: 2967860.0513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6387999.0897; val_optim_loss: 6387999.0897
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8433; val_auprc_score: 0.8507; val_best_acc_score: 0.7544; val_best_f1_score: 0.7570; train_kl_reg_loss: 21864.9666; train_edge_recon_loss: 3334704.8692; train_gene_expr_recon_loss: 2961285.3656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6317855.1890; train_optim_loss: 6317855.1890; val_kl_reg_loss: 21969.9965; val_edge_recon_loss: 3393941.1282; val_gene_expr_recon_loss: 2938577.6987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6354488.8205; val_optim_loss: 6354488.8205
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8440; val_auprc_score: 0.8523; val_best_acc_score: 0.7537; val_best_f1_score: 0.7584; train_kl_reg_loss: 21876.3515; train_edge_recon_loss: 3337322.2922; train_gene_expr_recon_loss: 2927623.1192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6286821.7602; train_optim_loss: 6286821.7602; val_kl_reg_loss: 21982.3312; val_edge_recon_loss: 3394570.5962; val_gene_expr_recon_loss: 2894526.6538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6311079.5641; val_optim_loss: 6311079.5641
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8430; val_auprc_score: 0.8513; val_best_acc_score: 0.7530; val_best_f1_score: 0.7568; train_kl_reg_loss: 21885.7257; train_edge_recon_loss: 3335963.6185; train_gene_expr_recon_loss: 2892992.1163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6250841.4448; train_optim_loss: 6250841.4448; val_kl_reg_loss: 21950.5687; val_edge_recon_loss: 3395314.2051; val_gene_expr_recon_loss: 2857811.1859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6275075.9103; val_optim_loss: 6275075.9103
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8419; val_auprc_score: 0.8503; val_best_acc_score: 0.7520; val_best_f1_score: 0.7562; train_kl_reg_loss: 21885.3560; train_edge_recon_loss: 3337481.7333; train_gene_expr_recon_loss: 2858527.3336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6217894.4433; train_optim_loss: 6217894.4433; val_kl_reg_loss: 21951.8773; val_edge_recon_loss: 3397109.9551; val_gene_expr_recon_loss: 2832286.9103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6251348.6923; val_optim_loss: 6251348.6923
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8408; val_auprc_score: 0.8480; val_best_acc_score: 0.7504; val_best_f1_score: 0.7562; train_kl_reg_loss: 21882.4346; train_edge_recon_loss: 3336757.1686; train_gene_expr_recon_loss: 2830788.5211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6189428.1119; train_optim_loss: 6189428.1119; val_kl_reg_loss: 21978.4769; val_edge_recon_loss: 3393968.2244; val_gene_expr_recon_loss: 2803058.1154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6219004.7949; val_optim_loss: 6219004.7949
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8427; val_auprc_score: 0.8493; val_best_acc_score: 0.7526; val_best_f1_score: 0.7570; train_kl_reg_loss: 21873.0985; train_edge_recon_loss: 3338199.3438; train_gene_expr_recon_loss: 2799751.0930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6159823.5320; train_optim_loss: 6159823.5320; val_kl_reg_loss: 21951.7727; val_edge_recon_loss: 3391698.8333; val_gene_expr_recon_loss: 2776400.1026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6190050.6795; val_optim_loss: 6190050.6795
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8415; val_auprc_score: 0.8491; val_best_acc_score: 0.7496; val_best_f1_score: 0.7565; train_kl_reg_loss: 21879.0725; train_edge_recon_loss: 3334795.7551; train_gene_expr_recon_loss: 2779894.0116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6136568.8387; train_optim_loss: 6136568.8387; val_kl_reg_loss: 21962.6988; val_edge_recon_loss: 3393904.6859; val_gene_expr_recon_loss: 2747214.4231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6163081.7949; val_optim_loss: 6163081.7949
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8422; val_auprc_score: 0.8509; val_best_acc_score: 0.7516; val_best_f1_score: 0.7551; train_kl_reg_loss: 21875.2458; train_edge_recon_loss: 3337152.6969; train_gene_expr_recon_loss: 2755679.8154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6114707.7384; train_optim_loss: 6114707.7384; val_kl_reg_loss: 21969.5340; val_edge_recon_loss: 3398602.5192; val_gene_expr_recon_loss: 2730719.4551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6151291.5385; val_optim_loss: 6151291.5385
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8409; val_auprc_score: 0.8487; val_best_acc_score: 0.7508; val_best_f1_score: 0.7558; train_kl_reg_loss: 21874.5506; train_edge_recon_loss: 3335353.0850; train_gene_expr_recon_loss: 2739641.5836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6096869.2195; train_optim_loss: 6096869.2195; val_kl_reg_loss: 21979.9330; val_edge_recon_loss: 3395715.5833; val_gene_expr_recon_loss: 2721763.9936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6139459.5513; val_optim_loss: 6139459.5513
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8434; val_auprc_score: 0.8509; val_best_acc_score: 0.7513; val_best_f1_score: 0.7584; train_kl_reg_loss: 21874.3717; train_edge_recon_loss: 3335867.9469; train_gene_expr_recon_loss: 2721969.4964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6079711.8212; train_optim_loss: 6079711.8212; val_kl_reg_loss: 21959.6807; val_edge_recon_loss: 3387567.8782; val_gene_expr_recon_loss: 2699021.6218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6108549.1923; val_optim_loss: 6108549.1923
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8429; val_auprc_score: 0.8513; val_best_acc_score: 0.7534; val_best_f1_score: 0.7564; train_kl_reg_loss: 21884.0038; train_edge_recon_loss: 3338178.7078; train_gene_expr_recon_loss: 2708160.4731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6068223.1860; train_optim_loss: 6068223.1860; val_kl_reg_loss: 21963.0045; val_edge_recon_loss: 3394081.5192; val_gene_expr_recon_loss: 2687987.8013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6104032.3205; val_optim_loss: 6104032.3205
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8389; val_auprc_score: 0.8478; val_best_acc_score: 0.7478; val_best_f1_score: 0.7536; train_kl_reg_loss: 21883.0973; train_edge_recon_loss: 3335684.4462; train_gene_expr_recon_loss: 2695084.0734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6052651.6090; train_optim_loss: 6052651.6090; val_kl_reg_loss: 22006.4026; val_edge_recon_loss: 3399744.1026; val_gene_expr_recon_loss: 2677882.9679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6099633.5385; val_optim_loss: 6099633.5385
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8397; val_auprc_score: 0.8476; val_best_acc_score: 0.7481; val_best_f1_score: 0.7557; train_kl_reg_loss: 21875.5878; train_edge_recon_loss: 3335262.3706; train_gene_expr_recon_loss: 2680677.6112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6037815.5741; train_optim_loss: 6037815.5741; val_kl_reg_loss: 21987.2444; val_edge_recon_loss: 3401490.5962; val_gene_expr_recon_loss: 2651370.9231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6074848.7564; val_optim_loss: 6074848.7564
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8259; val_auprc_score: 0.8342; val_best_acc_score: 0.7376; val_best_f1_score: 0.7441; train_kl_reg_loss: 21880.7387; train_edge_recon_loss: 3377952.8212; train_gene_expr_recon_loss: 2400921.6570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5800755.2340; train_optim_loss: 5800755.2340; val_kl_reg_loss: 20160.1505; val_edge_recon_loss: 3431369.6026; val_gene_expr_recon_loss: 2398098.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5849628.7051; val_optim_loss: 5849628.7051
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8234; val_auprc_score: 0.8309; val_best_acc_score: 0.7347; val_best_f1_score: 0.7426; train_kl_reg_loss: 21879.4097; train_edge_recon_loss: 3379623.1279; train_gene_expr_recon_loss: 2385865.2347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5787367.7616; train_optim_loss: 5787367.7616; val_kl_reg_loss: 20069.3898; val_edge_recon_loss: 3434573.8846; val_gene_expr_recon_loss: 2386106.1731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5840749.4872; val_optim_loss: 5840749.4872
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8264; val_auprc_score: 0.8355; val_best_acc_score: 0.7355; val_best_f1_score: 0.7442; train_kl_reg_loss: 21877.9650; train_edge_recon_loss: 3378697.5894; train_gene_expr_recon_loss: 2376871.3292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5777446.8924; train_optim_loss: 5777446.8924; val_kl_reg_loss: 20039.9403; val_edge_recon_loss: 3426567.1282; val_gene_expr_recon_loss: 2379659.4487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5826266.5128; val_optim_loss: 5826266.5128
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8248; val_auprc_score: 0.8329; val_best_acc_score: 0.7367; val_best_f1_score: 0.7431; train_kl_reg_loss: 21884.5931; train_edge_recon_loss: 3380935.1439; train_gene_expr_recon_loss: 2372946.0283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5775765.7703; train_optim_loss: 5775765.7703; val_kl_reg_loss: 20060.6620; val_edge_recon_loss: 3433207.1603; val_gene_expr_recon_loss: 2367250.9679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5820518.8077; val_optim_loss: 5820518.8077
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8248; val_auprc_score: 0.8324; val_best_acc_score: 0.7353; val_best_f1_score: 0.7443; train_kl_reg_loss: 21890.0644; train_edge_recon_loss: 3380825.6570; train_gene_expr_recon_loss: 2370886.4666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5773602.1904; train_optim_loss: 5773602.1904; val_kl_reg_loss: 20045.4116; val_edge_recon_loss: 3429520.9359; val_gene_expr_recon_loss: 2376923.0449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5826489.4103; val_optim_loss: 5826489.4103
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8254; val_auprc_score: 0.8336; val_best_acc_score: 0.7370; val_best_f1_score: 0.7447; train_kl_reg_loss: 21884.9709; train_edge_recon_loss: 3384718.6366; train_gene_expr_recon_loss: 2370924.4935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5777528.1047; train_optim_loss: 5777528.1047; val_kl_reg_loss: 20055.6072; val_edge_recon_loss: 3431945.5513; val_gene_expr_recon_loss: 2376442.6218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5828443.7821; val_optim_loss: 5828443.7821
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8260; val_auprc_score: 0.8348; val_best_acc_score: 0.7373; val_best_f1_score: 0.7441; train_kl_reg_loss: 21893.5476; train_edge_recon_loss: 3378434.6097; train_gene_expr_recon_loss: 2369737.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5770065.6381; train_optim_loss: 5770065.6381; val_kl_reg_loss: 20044.3845; val_edge_recon_loss: 3427457.7821; val_gene_expr_recon_loss: 2366763.5128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5814265.6410; val_optim_loss: 5814265.6410
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8274; val_auprc_score: 0.8356; val_best_acc_score: 0.7383; val_best_f1_score: 0.7459; train_kl_reg_loss: 21885.1654; train_edge_recon_loss: 3380896.8517; train_gene_expr_recon_loss: 2367053.9055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5769835.9215; train_optim_loss: 5769835.9215; val_kl_reg_loss: 20039.6785; val_edge_recon_loss: 3424972.0962; val_gene_expr_recon_loss: 2372760.5385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5817772.3077; val_optim_loss: 5817772.3077
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8256; val_auprc_score: 0.8338; val_best_acc_score: 0.7366; val_best_f1_score: 0.7431; train_kl_reg_loss: 21874.9221; train_edge_recon_loss: 3381457.6628; train_gene_expr_recon_loss: 2361165.1359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5764497.7224; train_optim_loss: 5764497.7224; val_kl_reg_loss: 20038.4005; val_edge_recon_loss: 3431764.9872; val_gene_expr_recon_loss: 2361642.7885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5813446.1923; val_optim_loss: 5813446.1923
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8250; val_auprc_score: 0.8327; val_best_acc_score: 0.7360; val_best_f1_score: 0.7447; train_kl_reg_loss: 21883.5177; train_edge_recon_loss: 3380957.5640; train_gene_expr_recon_loss: 2360970.6475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5763811.7224; train_optim_loss: 5763811.7224; val_kl_reg_loss: 20022.5517; val_edge_recon_loss: 3432874.0064; val_gene_expr_recon_loss: 2367447.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5820344.0128; val_optim_loss: 5820344.0128
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8266; val_auprc_score: 0.8341; val_best_acc_score: 0.7373; val_best_f1_score: 0.7446; train_kl_reg_loss: 21881.0050; train_edge_recon_loss: 3383347.8765; train_gene_expr_recon_loss: 2359533.3670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5764762.2297; train_optim_loss: 5764762.2297; val_kl_reg_loss: 20051.0553; val_edge_recon_loss: 3424775.7308; val_gene_expr_recon_loss: 2362446.9423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5807273.7308; val_optim_loss: 5807273.7308
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8232; val_auprc_score: 0.8314; val_best_acc_score: 0.7350; val_best_f1_score: 0.7424; train_kl_reg_loss: 21882.9807; train_edge_recon_loss: 3380460.4026; train_gene_expr_recon_loss: 2357335.7907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5759679.1759; train_optim_loss: 5759679.1759; val_kl_reg_loss: 20058.7048; val_edge_recon_loss: 3437543.5064; val_gene_expr_recon_loss: 2362936.3782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5820538.5769; val_optim_loss: 5820538.5769
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8257; val_auprc_score: 0.8341; val_best_acc_score: 0.7354; val_best_f1_score: 0.7446; train_kl_reg_loss: 21887.7484; train_edge_recon_loss: 3381375.2442; train_gene_expr_recon_loss: 2357277.4390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5760540.4186; train_optim_loss: 5760540.4186; val_kl_reg_loss: 20057.9096; val_edge_recon_loss: 3427995.7179; val_gene_expr_recon_loss: 2370651.5064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5818705.1154; val_optim_loss: 5818705.1154
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8253; val_auprc_score: 0.8347; val_best_acc_score: 0.7351; val_best_f1_score: 0.7434; train_kl_reg_loss: 21890.6922; train_edge_recon_loss: 3382382.2173; train_gene_expr_recon_loss: 2357010.4724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5761283.3692; train_optim_loss: 5761283.3692; val_kl_reg_loss: 20048.2403; val_edge_recon_loss: 3431327.4615; val_gene_expr_recon_loss: 2355432.0064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5806807.7051; val_optim_loss: 5806807.7051
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8249; val_auprc_score: 0.8335; val_best_acc_score: 0.7365; val_best_f1_score: 0.7429; train_kl_reg_loss: 21888.0093; train_edge_recon_loss: 3382871.0923; train_gene_expr_recon_loss: 2354540.4876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5759299.5901; train_optim_loss: 5759299.5901; val_kl_reg_loss: 20073.0366; val_edge_recon_loss: 3433592.8077; val_gene_expr_recon_loss: 2361719.7179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5815385.5385; val_optim_loss: 5815385.5385
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8263; val_auprc_score: 0.8357; val_best_acc_score: 0.7360; val_best_f1_score: 0.7438; train_kl_reg_loss: 21882.3774; train_edge_recon_loss: 3379451.4695; train_gene_expr_recon_loss: 2352286.3314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5753620.1890; train_optim_loss: 5753620.1890; val_kl_reg_loss: 20037.7475; val_edge_recon_loss: 3431384.2756; val_gene_expr_recon_loss: 2352589.4295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5804011.4487; val_optim_loss: 5804011.4487
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8267; val_auprc_score: 0.8320; val_best_acc_score: 0.7395; val_best_f1_score: 0.7464; train_kl_reg_loss: 21899.1411; train_edge_recon_loss: 3382033.6512; train_gene_expr_recon_loss: 2351947.5734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5755880.3866; train_optim_loss: 5755880.3866; val_kl_reg_loss: 20032.4562; val_edge_recon_loss: 3422943.4615; val_gene_expr_recon_loss: 2355972.3782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5798948.2949; val_optim_loss: 5798948.2949
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8266; val_auprc_score: 0.8339; val_best_acc_score: 0.7375; val_best_f1_score: 0.7452; train_kl_reg_loss: 21875.6223; train_edge_recon_loss: 3380629.9637; train_gene_expr_recon_loss: 2349107.0967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5751612.6933; train_optim_loss: 5751612.6933; val_kl_reg_loss: 20051.4221; val_edge_recon_loss: 3427161.2756; val_gene_expr_recon_loss: 2355374.5641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5802587.2692; val_optim_loss: 5802587.2692
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8232; val_auprc_score: 0.8324; val_best_acc_score: 0.7347; val_best_f1_score: 0.7426; train_kl_reg_loss: 21878.3718; train_edge_recon_loss: 3382370.3583; train_gene_expr_recon_loss: 2350718.1570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5754966.8779; train_optim_loss: 5754966.8779; val_kl_reg_loss: 20059.1306; val_edge_recon_loss: 3434898.2821; val_gene_expr_recon_loss: 2356102.9038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5811060.3462; val_optim_loss: 5811060.3462
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8267; val_auprc_score: 0.8346; val_best_acc_score: 0.7392; val_best_f1_score: 0.7447; train_kl_reg_loss: 21878.6426; train_edge_recon_loss: 3381544.1265; train_gene_expr_recon_loss: 2348481.9368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5751904.7064; train_optim_loss: 5751904.7064; val_kl_reg_loss: 20051.9338; val_edge_recon_loss: 3429030.5769; val_gene_expr_recon_loss: 2352206.9423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5801289.4487; val_optim_loss: 5801289.4487
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8236; val_auprc_score: 0.8315; val_best_acc_score: 0.7346; val_best_f1_score: 0.7436; train_kl_reg_loss: 21886.0677; train_edge_recon_loss: 3381084.1701; train_gene_expr_recon_loss: 2347173.5487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5750143.7936; train_optim_loss: 5750143.7936; val_kl_reg_loss: 20056.9221; val_edge_recon_loss: 3435078.6154; val_gene_expr_recon_loss: 2353883.1282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5809018.6667; val_optim_loss: 5809018.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8239; val_auprc_score: 0.8321; val_best_acc_score: 0.7344; val_best_f1_score: 0.7435; train_kl_reg_loss: 21879.8424; train_edge_recon_loss: 3379780.5567; train_gene_expr_recon_loss: 2347260.5334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5748920.9433; train_optim_loss: 5748920.9433; val_kl_reg_loss: 20046.7319; val_edge_recon_loss: 3429160.3718; val_gene_expr_recon_loss: 2349021.5641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5798228.6923; val_optim_loss: 5798228.6923
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8248; val_auprc_score: 0.8327; val_best_acc_score: 0.7359; val_best_f1_score: 0.7436; train_kl_reg_loss: 21881.7149; train_edge_recon_loss: 3381162.7791; train_gene_expr_recon_loss: 2348568.8888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5751613.4026; train_optim_loss: 5751613.4026; val_kl_reg_loss: 20067.2035; val_edge_recon_loss: 3433803.2179; val_gene_expr_recon_loss: 2358143.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5812013.7051; val_optim_loss: 5812013.7051
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8242; val_auprc_score: 0.8334; val_best_acc_score: 0.7341; val_best_f1_score: 0.7433; train_kl_reg_loss: 21889.6475; train_edge_recon_loss: 3383359.4876; train_gene_expr_recon_loss: 2347528.0029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5752777.1294; train_optim_loss: 5752777.1294; val_kl_reg_loss: 20067.1526; val_edge_recon_loss: 3435129.3141; val_gene_expr_recon_loss: 2355023.4872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5810219.8846; val_optim_loss: 5810219.8846
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8244; val_auprc_score: 0.8330; val_best_acc_score: 0.7345; val_best_f1_score: 0.7431; train_kl_reg_loss: 21875.0729; train_edge_recon_loss: 3383194.7929; train_gene_expr_recon_loss: 2347006.5509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5752076.4230; train_optim_loss: 5752076.4230; val_kl_reg_loss: 20072.5885; val_edge_recon_loss: 3432797.8782; val_gene_expr_recon_loss: 2357465.5321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5810336.0000; val_optim_loss: 5810336.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8238; val_auprc_score: 0.8320; val_best_acc_score: 0.7360; val_best_f1_score: 0.7429; train_kl_reg_loss: 21876.2587; train_edge_recon_loss: 3379190.7028; train_gene_expr_recon_loss: 2345510.3786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5746577.3387; train_optim_loss: 5746577.3387; val_kl_reg_loss: 20049.3419; val_edge_recon_loss: 3433075.2756; val_gene_expr_recon_loss: 2349375.4744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5802500.1667; val_optim_loss: 5802500.1667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8253; val_auprc_score: 0.8333; val_best_acc_score: 0.7365; val_best_f1_score: 0.7448; train_kl_reg_loss: 21872.9684; train_edge_recon_loss: 3382187.5705; train_gene_expr_recon_loss: 2345737.5051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5749798.0480; train_optim_loss: 5749798.0480; val_kl_reg_loss: 20056.0529; val_edge_recon_loss: 3430850.8462; val_gene_expr_recon_loss: 2355825.2179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5806732.1410; val_optim_loss: 5806732.1410
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8262; val_auprc_score: 0.8343; val_best_acc_score: 0.7371; val_best_f1_score: 0.7446; train_kl_reg_loss: 21886.3688; train_edge_recon_loss: 3381986.7762; train_gene_expr_recon_loss: 2347251.9978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5751125.1323; train_optim_loss: 5751125.1323; val_kl_reg_loss: 20076.8323; val_edge_recon_loss: 3426947.9615; val_gene_expr_recon_loss: 2359482.7564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5806507.5385; val_optim_loss: 5806507.5385
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8245; val_auprc_score: 0.8311; val_best_acc_score: 0.7378; val_best_f1_score: 0.7436; train_kl_reg_loss: 21881.8115; train_edge_recon_loss: 3379033.9419; train_gene_expr_recon_loss: 2347129.1599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5748044.9099; train_optim_loss: 5748044.9099; val_kl_reg_loss: 20049.3610; val_edge_recon_loss: 3433766.6603; val_gene_expr_recon_loss: 2348030.4103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5801846.4615; val_optim_loss: 5801846.4615
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8257; val_auprc_score: 0.8333; val_best_acc_score: 0.7376; val_best_f1_score: 0.7438; train_kl_reg_loss: 21878.9493; train_edge_recon_loss: 3379320.9164; train_gene_expr_recon_loss: 2347668.0109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5748867.8590; train_optim_loss: 5748867.8590; val_kl_reg_loss: 20038.3947; val_edge_recon_loss: 3428453.2692; val_gene_expr_recon_loss: 2346016.3910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5794508.0641; val_optim_loss: 5794508.0641
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8228; val_auprc_score: 0.8303; val_best_acc_score: 0.7348; val_best_f1_score: 0.7424; train_kl_reg_loss: 21885.8424; train_edge_recon_loss: 3380161.5894; train_gene_expr_recon_loss: 2348075.5981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5750123.0363; train_optim_loss: 5750123.0363; val_kl_reg_loss: 20054.5599; val_edge_recon_loss: 3435789.4423; val_gene_expr_recon_loss: 2356795.1090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5812639.0897; val_optim_loss: 5812639.0897
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8233; val_auprc_score: 0.8322; val_best_acc_score: 0.7357; val_best_f1_score: 0.7415; train_kl_reg_loss: 21884.9018; train_edge_recon_loss: 3382479.4353; train_gene_expr_recon_loss: 2348151.4876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5752515.8241; train_optim_loss: 5752515.8241; val_kl_reg_loss: 20072.3358; val_edge_recon_loss: 3437779.9808; val_gene_expr_recon_loss: 2358173.4808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5816025.8077; val_optim_loss: 5816025.8077
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.8221; val_auprc_score: 0.8293; val_best_acc_score: 0.7336; val_best_f1_score: 0.7420; train_kl_reg_loss: 21881.5258; train_edge_recon_loss: 3383930.7951; train_gene_expr_recon_loss: 2345991.7078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5751804.0436; train_optim_loss: 5751804.0436; val_kl_reg_loss: 20067.3358; val_edge_recon_loss: 3438803.8462; val_gene_expr_recon_loss: 2353558.7051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5812429.9231; val_optim_loss: 5812429.9231
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.8251; val_auprc_score: 0.8339; val_best_acc_score: 0.7374; val_best_f1_score: 0.7423; train_kl_reg_loss: 21883.7971; train_edge_recon_loss: 3381209.0828; train_gene_expr_recon_loss: 2346807.2086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5749900.0901; train_optim_loss: 5749900.0901; val_kl_reg_loss: 20061.8938; val_edge_recon_loss: 3436082.2500; val_gene_expr_recon_loss: 2353610.0385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5809754.1795; val_optim_loss: 5809754.1795

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.8246; val_auprc_score: 0.8316; val_best_acc_score: 0.7370; val_best_f1_score: 0.7436; train_kl_reg_loss: 21894.0864; train_edge_recon_loss: 3382841.9549; train_gene_expr_recon_loss: 2348690.4826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5753426.5247; train_optim_loss: 5753426.5247; val_kl_reg_loss: 20041.9192; val_edge_recon_loss: 3434264.7436; val_gene_expr_recon_loss: 2353415.2179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5807721.8590; val_optim_loss: 5807721.8590
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.8265; val_auprc_score: 0.8346; val_best_acc_score: 0.7382; val_best_f1_score: 0.7450; train_kl_reg_loss: 21885.4529; train_edge_recon_loss: 3380039.2994; train_gene_expr_recon_loss: 2347884.0996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5749808.8459; train_optim_loss: 5749808.8459; val_kl_reg_loss: 20049.3074; val_edge_recon_loss: 3428167.9551; val_gene_expr_recon_loss: 2353022.9744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5801240.2051; val_optim_loss: 5801240.2051
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.8238; val_auprc_score: 0.8321; val_best_acc_score: 0.7358; val_best_f1_score: 0.7428; train_kl_reg_loss: 21891.6967; train_edge_recon_loss: 3383779.3946; train_gene_expr_recon_loss: 2348553.0320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5754224.1192; train_optim_loss: 5754224.1192; val_kl_reg_loss: 20062.6218; val_edge_recon_loss: 3434905.0449; val_gene_expr_recon_loss: 2352967.7244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5807935.3462; val_optim_loss: 5807935.3462
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.8255; val_auprc_score: 0.8342; val_best_acc_score: 0.7364; val_best_f1_score: 0.7438; train_kl_reg_loss: 21882.2626; train_edge_recon_loss: 3379485.5523; train_gene_expr_recon_loss: 2347663.5545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5749031.3605; train_optim_loss: 5749031.3605; val_kl_reg_loss: 20061.9647; val_edge_recon_loss: 3434327.4423; val_gene_expr_recon_loss: 2349008.6538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5803398.0385; val_optim_loss: 5803398.0385

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 132 min 56 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.8259
val AUPRC score: 0.8324
val best accuracy score: 0.7370
val best F1 score: 0.7456
val target rna MSE score: 13.2291
val source rna MSE score: 0.8576
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0408
Val cat covariate2 mean sim diff: nan

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
