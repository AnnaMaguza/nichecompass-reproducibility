[True]
Run timestamp: 07072023_185811_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference_query_reference_only', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 193574
Number of validation nodes: 21508
Number of training edges: 1323311
Number of validation edges: 147034
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9626; val_auprc_score: 0.9706; val_best_acc_score: 0.9530; val_best_f1_score: 0.9654; train_kl_reg_loss: 6304.7968; train_edge_recon_loss: 182746.7424; train_cat_covariates_contrastive_loss: 79722.6233; train_gene_expr_recon_loss: 104553.8532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373328.0157; train_optim_loss: 373328.0157; val_kl_reg_loss: 5864.6176; val_edge_recon_loss: 175358.8672; val_cat_covariates_contrastive_loss: 78752.7016; val_gene_expr_recon_loss: 93708.6963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 353684.8835; val_optim_loss: 353684.8835
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9644; val_auprc_score: 0.9696; val_best_acc_score: 0.9602; val_best_f1_score: 0.9706; train_kl_reg_loss: 5933.7582; train_edge_recon_loss: 175837.5225; train_cat_covariates_contrastive_loss: 79034.2729; train_gene_expr_recon_loss: 92071.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352877.3838; train_optim_loss: 352877.3838; val_kl_reg_loss: 5861.3189; val_edge_recon_loss: 175031.8387; val_cat_covariates_contrastive_loss: 78697.5405; val_gene_expr_recon_loss: 90511.1283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350101.8260; val_optim_loss: 350101.8260
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9642; val_auprc_score: 0.9685; val_best_acc_score: 0.9628; val_best_f1_score: 0.9725; train_kl_reg_loss: 5898.7961; train_edge_recon_loss: 175290.5686; train_cat_covariates_contrastive_loss: 78974.0105; train_gene_expr_recon_loss: 89996.9024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350160.2776; train_optim_loss: 350160.2776; val_kl_reg_loss: 5874.7652; val_edge_recon_loss: 174665.1313; val_cat_covariates_contrastive_loss: 78620.6146; val_gene_expr_recon_loss: 89262.4092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348422.9212; val_optim_loss: 348422.9212
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9652; val_auprc_score: 0.9694; val_best_acc_score: 0.9644; val_best_f1_score: 0.9736; train_kl_reg_loss: 5907.5944; train_edge_recon_loss: 175127.9294; train_cat_covariates_contrastive_loss: 78972.7026; train_gene_expr_recon_loss: 89067.2550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349075.4817; train_optim_loss: 349075.4817; val_kl_reg_loss: 5678.2181; val_edge_recon_loss: 174389.6143; val_cat_covariates_contrastive_loss: 78677.9946; val_gene_expr_recon_loss: 88488.0434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347233.8717; val_optim_loss: 347233.8717
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9643; val_auprc_score: 0.9678; val_best_acc_score: 0.9661; val_best_f1_score: 0.9749; train_kl_reg_loss: 5925.7742; train_edge_recon_loss: 174891.8722; train_cat_covariates_contrastive_loss: 78970.5320; train_gene_expr_recon_loss: 88478.6110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348266.7894; train_optim_loss: 348266.7894; val_kl_reg_loss: 5890.1835; val_edge_recon_loss: 174057.7179; val_cat_covariates_contrastive_loss: 78648.1214; val_gene_expr_recon_loss: 88238.5556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346834.5788; val_optim_loss: 346834.5788
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9637; val_auprc_score: 0.9673; val_best_acc_score: 0.9663; val_best_f1_score: 0.9750; train_kl_reg_loss: 5942.9091; train_edge_recon_loss: 174676.3070; train_cat_covariates_contrastive_loss: 78983.7410; train_gene_expr_recon_loss: 88041.3891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347644.3455; train_optim_loss: 347644.3455; val_kl_reg_loss: 5989.3528; val_edge_recon_loss: 174749.0463; val_cat_covariates_contrastive_loss: 78632.6430; val_gene_expr_recon_loss: 87757.0862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347128.1278; val_optim_loss: 347128.1278
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9639; val_auprc_score: 0.9680; val_best_acc_score: 0.9663; val_best_f1_score: 0.9750; train_kl_reg_loss: 5970.8755; train_edge_recon_loss: 174795.3343; train_cat_covariates_contrastive_loss: 78975.2278; train_gene_expr_recon_loss: 87815.4636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347556.9009; train_optim_loss: 347556.9009; val_kl_reg_loss: 5798.4383; val_edge_recon_loss: 174344.1991; val_cat_covariates_contrastive_loss: 78661.1175; val_gene_expr_recon_loss: 87720.4979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346524.2513; val_optim_loss: 346524.2513
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9642; val_auprc_score: 0.9684; val_best_acc_score: 0.9673; val_best_f1_score: 0.9757; train_kl_reg_loss: 5992.7675; train_edge_recon_loss: 174777.0067; train_cat_covariates_contrastive_loss: 78978.1940; train_gene_expr_recon_loss: 87508.1501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347256.1183; train_optim_loss: 347256.1183; val_kl_reg_loss: 5872.0207; val_edge_recon_loss: 174323.8716; val_cat_covariates_contrastive_loss: 78680.1738; val_gene_expr_recon_loss: 87532.6447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346408.7109; val_optim_loss: 346408.7109
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9666; val_auprc_score: 0.9707; val_best_acc_score: 0.9677; val_best_f1_score: 0.9761; train_kl_reg_loss: 6017.8359; train_edge_recon_loss: 174736.9762; train_cat_covariates_contrastive_loss: 78982.2516; train_gene_expr_recon_loss: 87311.3300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347048.3937; train_optim_loss: 347048.3937; val_kl_reg_loss: 5886.8710; val_edge_recon_loss: 173368.7549; val_cat_covariates_contrastive_loss: 78762.6933; val_gene_expr_recon_loss: 87357.7374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345376.0579; val_optim_loss: 345376.0579
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9672; val_auprc_score: 0.9708; val_best_acc_score: 0.9682; val_best_f1_score: 0.9764; train_kl_reg_loss: 6038.8684; train_edge_recon_loss: 174471.1426; train_cat_covariates_contrastive_loss: 78970.6560; train_gene_expr_recon_loss: 87131.3746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346612.0417; train_optim_loss: 346612.0417; val_kl_reg_loss: 6134.6114; val_edge_recon_loss: 174169.6248; val_cat_covariates_contrastive_loss: 78747.9141; val_gene_expr_recon_loss: 87217.5891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346269.7391; val_optim_loss: 346269.7391
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9657; val_auprc_score: 0.9690; val_best_acc_score: 0.9684; val_best_f1_score: 0.9766; train_kl_reg_loss: 6064.1396; train_edge_recon_loss: 174634.3708; train_cat_covariates_contrastive_loss: 78971.6729; train_gene_expr_recon_loss: 87023.9327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346694.1157; train_optim_loss: 346694.1157; val_kl_reg_loss: 6005.1141; val_edge_recon_loss: 173677.8822; val_cat_covariates_contrastive_loss: 78698.6906; val_gene_expr_recon_loss: 87210.3427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345592.0291; val_optim_loss: 345592.0291
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9647; val_auprc_score: 0.9678; val_best_acc_score: 0.9685; val_best_f1_score: 0.9766; train_kl_reg_loss: 6082.6107; train_edge_recon_loss: 174791.0346; train_cat_covariates_contrastive_loss: 78985.4264; train_gene_expr_recon_loss: 86888.9289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346748.0003; train_optim_loss: 346748.0003; val_kl_reg_loss: 5966.1410; val_edge_recon_loss: 174127.7477; val_cat_covariates_contrastive_loss: 78771.6459; val_gene_expr_recon_loss: 87317.5982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346183.1339; val_optim_loss: 346183.1339
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9674; val_auprc_score: 0.9718; val_best_acc_score: 0.9691; val_best_f1_score: 0.9770; train_kl_reg_loss: 6100.6687; train_edge_recon_loss: 174558.2190; train_cat_covariates_contrastive_loss: 78983.3573; train_gene_expr_recon_loss: 86754.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346396.6537; train_optim_loss: 346396.6537; val_kl_reg_loss: 6023.9046; val_edge_recon_loss: 174401.9396; val_cat_covariates_contrastive_loss: 78764.4675; val_gene_expr_recon_loss: 87180.9779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346371.2899; val_optim_loss: 346371.2899

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9664; val_auprc_score: 0.9697; val_best_acc_score: 0.9691; val_best_f1_score: 0.9771; train_kl_reg_loss: 6111.2704; train_edge_recon_loss: 174596.2437; train_cat_covariates_contrastive_loss: 78994.9800; train_gene_expr_recon_loss: 86323.7217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346026.2155; train_optim_loss: 346026.2155; val_kl_reg_loss: 6040.7189; val_edge_recon_loss: 173557.1023; val_cat_covariates_contrastive_loss: 78705.0747; val_gene_expr_recon_loss: 86882.9965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345185.8908; val_optim_loss: 345185.8908
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9649; val_auprc_score: 0.9681; val_best_acc_score: 0.9690; val_best_f1_score: 0.9769; train_kl_reg_loss: 6105.3898; train_edge_recon_loss: 174271.7838; train_cat_covariates_contrastive_loss: 78991.6191; train_gene_expr_recon_loss: 86237.9960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345606.7886; train_optim_loss: 345606.7886; val_kl_reg_loss: 6036.7526; val_edge_recon_loss: 174032.5827; val_cat_covariates_contrastive_loss: 78732.2099; val_gene_expr_recon_loss: 86740.3377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345541.8841; val_optim_loss: 345541.8841
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9655; val_auprc_score: 0.9685; val_best_acc_score: 0.9694; val_best_f1_score: 0.9773; train_kl_reg_loss: 6102.8752; train_edge_recon_loss: 174344.3945; train_cat_covariates_contrastive_loss: 78975.1960; train_gene_expr_recon_loss: 86229.1268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345651.5919; train_optim_loss: 345651.5919; val_kl_reg_loss: 6100.8040; val_edge_recon_loss: 173866.5041; val_cat_covariates_contrastive_loss: 78705.2817; val_gene_expr_recon_loss: 86971.9110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345644.5004; val_optim_loss: 345644.5004
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9658; val_auprc_score: 0.9686; val_best_acc_score: 0.9693; val_best_f1_score: 0.9772; train_kl_reg_loss: 6098.7182; train_edge_recon_loss: 174388.3006; train_cat_covariates_contrastive_loss: 78968.2447; train_gene_expr_recon_loss: 86202.7922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345658.0553; train_optim_loss: 345658.0553; val_kl_reg_loss: 6048.3481; val_edge_recon_loss: 174405.6944; val_cat_covariates_contrastive_loss: 78717.1185; val_gene_expr_recon_loss: 86811.8406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345983.0007; val_optim_loss: 345983.0007
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9657; val_auprc_score: 0.9686; val_best_acc_score: 0.9695; val_best_f1_score: 0.9774; train_kl_reg_loss: 6108.5223; train_edge_recon_loss: 174294.1464; train_cat_covariates_contrastive_loss: 78991.7557; train_gene_expr_recon_loss: 86140.7875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345535.2117; train_optim_loss: 345535.2117; val_kl_reg_loss: 6042.2346; val_edge_recon_loss: 173844.2705; val_cat_covariates_contrastive_loss: 78750.5466; val_gene_expr_recon_loss: 86919.7665; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345556.8177; val_optim_loss: 345556.8177

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9652; val_auprc_score: 0.9681; val_best_acc_score: 0.9693; val_best_f1_score: 0.9772; train_kl_reg_loss: 6110.6801; train_edge_recon_loss: 174252.1697; train_cat_covariates_contrastive_loss: 78986.3819; train_gene_expr_recon_loss: 86075.4095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345424.6414; train_optim_loss: 345424.6414; val_kl_reg_loss: 6080.6494; val_edge_recon_loss: 173962.7885; val_cat_covariates_contrastive_loss: 78712.9768; val_gene_expr_recon_loss: 86903.1734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345659.5877; val_optim_loss: 345659.5877
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9651; val_auprc_score: 0.9679; val_best_acc_score: 0.9691; val_best_f1_score: 0.9770; train_kl_reg_loss: 6111.1839; train_edge_recon_loss: 174443.7612; train_cat_covariates_contrastive_loss: 78975.4977; train_gene_expr_recon_loss: 86084.0388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345614.4818; train_optim_loss: 345614.4818; val_kl_reg_loss: 6079.7447; val_edge_recon_loss: 173810.9820; val_cat_covariates_contrastive_loss: 78697.2730; val_gene_expr_recon_loss: 86958.7770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345546.7763; val_optim_loss: 345546.7763
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9652; val_auprc_score: 0.9683; val_best_acc_score: 0.9692; val_best_f1_score: 0.9771; train_kl_reg_loss: 6110.0117; train_edge_recon_loss: 174372.6218; train_cat_covariates_contrastive_loss: 78984.4225; train_gene_expr_recon_loss: 86100.1159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345567.1716; train_optim_loss: 345567.1716; val_kl_reg_loss: 6070.4455; val_edge_recon_loss: 173388.4519; val_cat_covariates_contrastive_loss: 78735.7637; val_gene_expr_recon_loss: 86966.8432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345161.5030; val_optim_loss: 345161.5030
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9653; val_auprc_score: 0.9681; val_best_acc_score: 0.9695; val_best_f1_score: 0.9773; train_kl_reg_loss: 6115.0341; train_edge_recon_loss: 174372.2138; train_cat_covariates_contrastive_loss: 78993.3151; train_gene_expr_recon_loss: 86046.4157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345526.9787; train_optim_loss: 345526.9787; val_kl_reg_loss: 6053.3011; val_edge_recon_loss: 174204.2894; val_cat_covariates_contrastive_loss: 78707.0516; val_gene_expr_recon_loss: 86751.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345716.2914; val_optim_loss: 345716.2914
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9643; val_auprc_score: 0.9672; val_best_acc_score: 0.9690; val_best_f1_score: 0.9769; train_kl_reg_loss: 6115.1030; train_edge_recon_loss: 174304.3917; train_cat_covariates_contrastive_loss: 78999.2084; train_gene_expr_recon_loss: 86089.9689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345508.6723; train_optim_loss: 345508.6723; val_kl_reg_loss: 6069.8118; val_edge_recon_loss: 174333.1611; val_cat_covariates_contrastive_loss: 78700.6170; val_gene_expr_recon_loss: 86744.9307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345848.5204; val_optim_loss: 345848.5204
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9648; val_auprc_score: 0.9678; val_best_acc_score: 0.9692; val_best_f1_score: 0.9771; train_kl_reg_loss: 6111.6948; train_edge_recon_loss: 174347.1818; train_cat_covariates_contrastive_loss: 78980.1407; train_gene_expr_recon_loss: 86035.2817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345474.2991; train_optim_loss: 345474.2991; val_kl_reg_loss: 6075.9706; val_edge_recon_loss: 173672.1380; val_cat_covariates_contrastive_loss: 78711.4312; val_gene_expr_recon_loss: 86917.1604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345376.7010; val_optim_loss: 345376.7010
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9650; val_auprc_score: 0.9678; val_best_acc_score: 0.9694; val_best_f1_score: 0.9773; train_kl_reg_loss: 6111.7579; train_edge_recon_loss: 174340.0715; train_cat_covariates_contrastive_loss: 78982.8967; train_gene_expr_recon_loss: 86079.9562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345514.6824; train_optim_loss: 345514.6824; val_kl_reg_loss: 6049.5026; val_edge_recon_loss: 173688.6633; val_cat_covariates_contrastive_loss: 78693.8120; val_gene_expr_recon_loss: 86943.8854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345375.8637; val_optim_loss: 345375.8637

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9653; val_auprc_score: 0.9681; val_best_acc_score: 0.9694; val_best_f1_score: 0.9772; train_kl_reg_loss: 6105.8755; train_edge_recon_loss: 174108.9278; train_cat_covariates_contrastive_loss: 78986.1545; train_gene_expr_recon_loss: 86044.8804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345245.8382; train_optim_loss: 345245.8382; val_kl_reg_loss: 6064.3922; val_edge_recon_loss: 173486.9844; val_cat_covariates_contrastive_loss: 78692.8202; val_gene_expr_recon_loss: 86840.4470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345084.6437; val_optim_loss: 345084.6437
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9662; val_auprc_score: 0.9693; val_best_acc_score: 0.9699; val_best_f1_score: 0.9777; train_kl_reg_loss: 6112.1179; train_edge_recon_loss: 174481.0298; train_cat_covariates_contrastive_loss: 78995.8748; train_gene_expr_recon_loss: 86057.5855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345646.6079; train_optim_loss: 345646.6079; val_kl_reg_loss: 6069.7576; val_edge_recon_loss: 173099.9003; val_cat_covariates_contrastive_loss: 78675.7331; val_gene_expr_recon_loss: 86947.6946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344793.0859; val_optim_loss: 344793.0859
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9654; val_auprc_score: 0.9682; val_best_acc_score: 0.9695; val_best_f1_score: 0.9774; train_kl_reg_loss: 6112.2265; train_edge_recon_loss: 174349.8697; train_cat_covariates_contrastive_loss: 78971.6778; train_gene_expr_recon_loss: 86010.7415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345444.5155; train_optim_loss: 345444.5155; val_kl_reg_loss: 6065.1718; val_edge_recon_loss: 173952.7163; val_cat_covariates_contrastive_loss: 78703.3511; val_gene_expr_recon_loss: 86787.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345508.4336; val_optim_loss: 345508.4336
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9650; val_auprc_score: 0.9678; val_best_acc_score: 0.9694; val_best_f1_score: 0.9773; train_kl_reg_loss: 6110.8078; train_edge_recon_loss: 174323.7440; train_cat_covariates_contrastive_loss: 78986.5628; train_gene_expr_recon_loss: 86055.2912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345476.4054; train_optim_loss: 345476.4054; val_kl_reg_loss: 6069.4425; val_edge_recon_loss: 173753.9553; val_cat_covariates_contrastive_loss: 78774.0336; val_gene_expr_recon_loss: 86679.4503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345276.8822; val_optim_loss: 345276.8822
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9666; val_auprc_score: 0.9694; val_best_acc_score: 0.9697; val_best_f1_score: 0.9774; train_kl_reg_loss: 6111.4005; train_edge_recon_loss: 174380.1294; train_cat_covariates_contrastive_loss: 78979.9653; train_gene_expr_recon_loss: 86058.1898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345529.6855; train_optim_loss: 345529.6855; val_kl_reg_loss: 6071.9290; val_edge_recon_loss: 173929.7286; val_cat_covariates_contrastive_loss: 78677.1559; val_gene_expr_recon_loss: 86946.4261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345625.2394; val_optim_loss: 345625.2394
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9643; val_auprc_score: 0.9672; val_best_acc_score: 0.9689; val_best_f1_score: 0.9769; train_kl_reg_loss: 6112.1000; train_edge_recon_loss: 174487.0016; train_cat_covariates_contrastive_loss: 78968.9132; train_gene_expr_recon_loss: 86058.6749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345626.6891; train_optim_loss: 345626.6891; val_kl_reg_loss: 6069.1803; val_edge_recon_loss: 173790.7944; val_cat_covariates_contrastive_loss: 78680.2873; val_gene_expr_recon_loss: 86861.4999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345401.7606; val_optim_loss: 345401.7606

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9649; val_auprc_score: 0.9677; val_best_acc_score: 0.9689; val_best_f1_score: 0.9769; train_kl_reg_loss: 6111.2687; train_edge_recon_loss: 174243.4225; train_cat_covariates_contrastive_loss: 78979.3440; train_gene_expr_recon_loss: 86085.9520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345419.9869; train_optim_loss: 345419.9869; val_kl_reg_loss: 6066.5161; val_edge_recon_loss: 174065.2176; val_cat_covariates_contrastive_loss: 78711.9157; val_gene_expr_recon_loss: 86734.9591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345578.6081; val_optim_loss: 345578.6081
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9650; val_auprc_score: 0.9678; val_best_acc_score: 0.9693; val_best_f1_score: 0.9772; train_kl_reg_loss: 6111.2078; train_edge_recon_loss: 174429.7259; train_cat_covariates_contrastive_loss: 78970.7709; train_gene_expr_recon_loss: 86046.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345558.0657; train_optim_loss: 345558.0657; val_kl_reg_loss: 6066.4648; val_edge_recon_loss: 174122.8766; val_cat_covariates_contrastive_loss: 78714.2826; val_gene_expr_recon_loss: 86812.0155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345715.6380; val_optim_loss: 345715.6380
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9649; val_auprc_score: 0.9679; val_best_acc_score: 0.9691; val_best_f1_score: 0.9771; train_kl_reg_loss: 6110.9828; train_edge_recon_loss: 174251.3432; train_cat_covariates_contrastive_loss: 78976.0376; train_gene_expr_recon_loss: 86036.2125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345374.5764; train_optim_loss: 345374.5764; val_kl_reg_loss: 6067.2895; val_edge_recon_loss: 173751.9438; val_cat_covariates_contrastive_loss: 78723.4002; val_gene_expr_recon_loss: 86944.8420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345487.4763; val_optim_loss: 345487.4763
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9652; val_auprc_score: 0.9677; val_best_acc_score: 0.9690; val_best_f1_score: 0.9770; train_kl_reg_loss: 6111.6807; train_edge_recon_loss: 174446.6599; train_cat_covariates_contrastive_loss: 78992.4415; train_gene_expr_recon_loss: 86047.0372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345597.8196; train_optim_loss: 345597.8196; val_kl_reg_loss: 6066.7333; val_edge_recon_loss: 174323.3368; val_cat_covariates_contrastive_loss: 78701.8944; val_gene_expr_recon_loss: 86819.1575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345911.1224; val_optim_loss: 345911.1224

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 624 min 47 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9655
Val AUPRC score: 0.9684
Val best accuracy score: 0.9698
Val best F1 score: 0.9776
Val gene expr MSE score: 0.4810

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
