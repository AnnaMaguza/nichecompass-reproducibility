Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--query_batches', 'batch8', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '19102023_184159_46', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_cat_covariates_contrastive', '0.', '--contrastive_logits_pos_ratio', '0.', '--contrastive_logits_neg_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 68882
Number of validation nodes: 7654
Number of training edges: 162180
Number of validation edges: 18020
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8692; val_auprc_score: 0.8672; val_best_acc_score: 0.7851; val_best_f1_score: 0.7954; train_kl_reg_loss: 93242.6788; train_edge_recon_loss: 32446167.5142; train_gene_expr_recon_loss: 32561064.3218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65100474.2965; train_optim_loss: 65100474.2965; val_kl_reg_loss: 92972.1630; val_edge_recon_loss: 33244614.2778; val_gene_expr_recon_loss: 28944691.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62282278.4444; val_optim_loss: 62282278.4444
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8683; val_auprc_score: 0.8664; val_best_acc_score: 0.7845; val_best_f1_score: 0.7943; train_kl_reg_loss: 93242.7125; train_edge_recon_loss: 32422558.0189; train_gene_expr_recon_loss: 26441780.5426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58957581.3249; train_optim_loss: 58957581.3249; val_kl_reg_loss: 92942.3201; val_edge_recon_loss: 33250668.0000; val_gene_expr_recon_loss: 24966028.0556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58309638.5556; val_optim_loss: 58309638.5556
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8705; val_auprc_score: 0.8678; val_best_acc_score: 0.7872; val_best_f1_score: 0.7961; train_kl_reg_loss: 93269.9372; train_edge_recon_loss: 32413483.5268; train_gene_expr_recon_loss: 24018745.1735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56525498.6246; train_optim_loss: 56525498.6246; val_kl_reg_loss: 93154.0688; val_edge_recon_loss: 33162158.3333; val_gene_expr_recon_loss: 23599248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56854560.2222; val_optim_loss: 56854560.2222
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8708; val_auprc_score: 0.8688; val_best_acc_score: 0.7875; val_best_f1_score: 0.7972; train_kl_reg_loss: 93311.7068; train_edge_recon_loss: 32427829.3628; train_gene_expr_recon_loss: 23144586.5300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55665727.7603; train_optim_loss: 55665727.7603; val_kl_reg_loss: 93003.1543; val_edge_recon_loss: 33202359.0556; val_gene_expr_recon_loss: 23041604.3889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56336966.7778; val_optim_loss: 56336966.7778
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8692; val_auprc_score: 0.8672; val_best_acc_score: 0.7867; val_best_f1_score: 0.7963; train_kl_reg_loss: 93255.0357; train_edge_recon_loss: 32433306.6435; train_gene_expr_recon_loss: 22705719.5710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55232281.2114; train_optim_loss: 55232281.2114; val_kl_reg_loss: 92990.1569; val_edge_recon_loss: 33192601.1111; val_gene_expr_recon_loss: 22683787.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55969379.1111; val_optim_loss: 55969379.1111
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8691; val_auprc_score: 0.8669; val_best_acc_score: 0.7857; val_best_f1_score: 0.7964; train_kl_reg_loss: 93283.6761; train_edge_recon_loss: 32442400.4543; train_gene_expr_recon_loss: 22409114.4227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54944798.4227; train_optim_loss: 54944798.4227; val_kl_reg_loss: 92998.2378; val_edge_recon_loss: 33215780.2222; val_gene_expr_recon_loss: 22471487.2222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55780265.6667; val_optim_loss: 55780265.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8703; val_auprc_score: 0.8674; val_best_acc_score: 0.7865; val_best_f1_score: 0.7970; train_kl_reg_loss: 93257.3608; train_edge_recon_loss: 32443569.0852; train_gene_expr_recon_loss: 22204761.5962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54741587.9748; train_optim_loss: 54741587.9748; val_kl_reg_loss: 93145.0488; val_edge_recon_loss: 33170988.6667; val_gene_expr_recon_loss: 22299863.2778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55563997.3333; val_optim_loss: 55563997.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8695; val_auprc_score: 0.8662; val_best_acc_score: 0.7874; val_best_f1_score: 0.7976; train_kl_reg_loss: 93240.6649; train_edge_recon_loss: 32429226.8770; train_gene_expr_recon_loss: 22087479.0726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54609946.5489; train_optim_loss: 54609946.5489; val_kl_reg_loss: 92924.7773; val_edge_recon_loss: 33201925.2222; val_gene_expr_recon_loss: 22161064.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55455914.4444; val_optim_loss: 55455914.4444
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8683; val_auprc_score: 0.8670; val_best_acc_score: 0.7845; val_best_f1_score: 0.7953; train_kl_reg_loss: 93296.5116; train_edge_recon_loss: 32436964.6246; train_gene_expr_recon_loss: 21979978.6688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54510239.8360; train_optim_loss: 54510239.8360; val_kl_reg_loss: 93199.2283; val_edge_recon_loss: 33230572.2778; val_gene_expr_recon_loss: 22205794.0556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55529565.8889; val_optim_loss: 55529565.8889
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8714; val_auprc_score: 0.8696; val_best_acc_score: 0.7874; val_best_f1_score: 0.7965; train_kl_reg_loss: 93310.9544; train_edge_recon_loss: 32435207.1293; train_gene_expr_recon_loss: 21894598.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54423116.3155; train_optim_loss: 54423116.3155; val_kl_reg_loss: 92870.7793; val_edge_recon_loss: 33177477.3333; val_gene_expr_recon_loss: 22080218.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55350566.7778; val_optim_loss: 55350566.7778
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8698; val_auprc_score: 0.8667; val_best_acc_score: 0.7864; val_best_f1_score: 0.7969; train_kl_reg_loss: 93168.5915; train_edge_recon_loss: 32440652.1199; train_gene_expr_recon_loss: 21824855.3312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54358676.1640; train_optim_loss: 54358676.1640; val_kl_reg_loss: 93216.8746; val_edge_recon_loss: 33151861.0000; val_gene_expr_recon_loss: 21934794.7222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55179872.5556; val_optim_loss: 55179872.5556
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8714; val_auprc_score: 0.8687; val_best_acc_score: 0.7871; val_best_f1_score: 0.7962; train_kl_reg_loss: 93284.8838; train_edge_recon_loss: 32439353.6467; train_gene_expr_recon_loss: 21763287.4132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54295925.9937; train_optim_loss: 54295925.9937; val_kl_reg_loss: 92949.2806; val_edge_recon_loss: 33195091.4444; val_gene_expr_recon_loss: 21883742.5556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55171783.3333; val_optim_loss: 55171783.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8707; val_auprc_score: 0.8690; val_best_acc_score: 0.7866; val_best_f1_score: 0.7967; train_kl_reg_loss: 93234.2359; train_edge_recon_loss: 32429243.2366; train_gene_expr_recon_loss: 21719282.8517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54241760.3659; train_optim_loss: 54241760.3659; val_kl_reg_loss: 92951.8939; val_edge_recon_loss: 33181899.3333; val_gene_expr_recon_loss: 21835098.5556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55109949.8889; val_optim_loss: 55109949.8889
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8696; val_auprc_score: 0.8669; val_best_acc_score: 0.7860; val_best_f1_score: 0.7977; train_kl_reg_loss: 93195.8198; train_edge_recon_loss: 32430813.6404; train_gene_expr_recon_loss: 21682488.1073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54206497.5142; train_optim_loss: 54206497.5142; val_kl_reg_loss: 93027.3947; val_edge_recon_loss: 33223833.0556; val_gene_expr_recon_loss: 21859718.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55176579.0000; val_optim_loss: 55176579.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8695; val_auprc_score: 0.8672; val_best_acc_score: 0.7849; val_best_f1_score: 0.7956; train_kl_reg_loss: 93216.9764; train_edge_recon_loss: 32436657.5899; train_gene_expr_recon_loss: 21645659.0852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54175533.4637; train_optim_loss: 54175533.4637; val_kl_reg_loss: 93133.4497; val_edge_recon_loss: 33207904.3333; val_gene_expr_recon_loss: 21762366.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55063404.2222; val_optim_loss: 55063404.2222
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8698; val_auprc_score: 0.8681; val_best_acc_score: 0.7862; val_best_f1_score: 0.7957; train_kl_reg_loss: 93326.3534; train_edge_recon_loss: 32430408.5174; train_gene_expr_recon_loss: 21662270.5426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54186005.5394; train_optim_loss: 54186005.5394; val_kl_reg_loss: 93139.8418; val_edge_recon_loss: 33206311.2222; val_gene_expr_recon_loss: 21807640.0556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55107091.0000; val_optim_loss: 55107091.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8716; val_auprc_score: 0.8685; val_best_acc_score: 0.7872; val_best_f1_score: 0.7990; train_kl_reg_loss: 93302.5525; train_edge_recon_loss: 32412829.2240; train_gene_expr_recon_loss: 21630593.4448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54136725.2114; train_optim_loss: 54136725.2114; val_kl_reg_loss: 92902.8372; val_edge_recon_loss: 33124651.1111; val_gene_expr_recon_loss: 21739501.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54957055.7778; val_optim_loss: 54957055.7778
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8691; val_auprc_score: 0.8663; val_best_acc_score: 0.7859; val_best_f1_score: 0.7969; train_kl_reg_loss: 93266.2205; train_edge_recon_loss: 32436300.0757; train_gene_expr_recon_loss: 21628827.4826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54158393.7918; train_optim_loss: 54158393.7918; val_kl_reg_loss: 93215.8542; val_edge_recon_loss: 33245023.5556; val_gene_expr_recon_loss: 21794353.9444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55132593.4444; val_optim_loss: 55132593.4444
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8677; val_auprc_score: 0.8657; val_best_acc_score: 0.7834; val_best_f1_score: 0.7953; train_kl_reg_loss: 93249.7580; train_edge_recon_loss: 32430994.6120; train_gene_expr_recon_loss: 21593517.1356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54117761.3754; train_optim_loss: 54117761.3754; val_kl_reg_loss: 93056.0601; val_edge_recon_loss: 33218982.5556; val_gene_expr_recon_loss: 21695790.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55007829.2222; val_optim_loss: 55007829.2222
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8713; val_auprc_score: 0.8687; val_best_acc_score: 0.7865; val_best_f1_score: 0.7977; train_kl_reg_loss: 93253.9219; train_edge_recon_loss: 32428927.3312; train_gene_expr_recon_loss: 21581928.9211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54104110.1073; train_optim_loss: 54104110.1073; val_kl_reg_loss: 92941.1999; val_edge_recon_loss: 33167252.3889; val_gene_expr_recon_loss: 21732377.7222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54992571.3333; val_optim_loss: 54992571.3333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8677; val_auprc_score: 0.8654; val_best_acc_score: 0.7837; val_best_f1_score: 0.7936; train_kl_reg_loss: 93206.7451; train_edge_recon_loss: 32433677.3438; train_gene_expr_recon_loss: 21575560.2524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54102444.1893; train_optim_loss: 54102444.1893; val_kl_reg_loss: 92994.3572; val_edge_recon_loss: 33275848.8889; val_gene_expr_recon_loss: 21740904.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55109747.5556; val_optim_loss: 55109747.5556

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8719; val_auprc_score: 0.8708; val_best_acc_score: 0.7877; val_best_f1_score: 0.7979; train_kl_reg_loss: 93309.2995; train_edge_recon_loss: 32443991.5457; train_gene_expr_recon_loss: 21621289.8423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54158590.5615; train_optim_loss: 54158590.5615; val_kl_reg_loss: 93034.6413; val_edge_recon_loss: 33219563.2222; val_gene_expr_recon_loss: 21738976.1111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55051574.0000; val_optim_loss: 55051574.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8693; val_auprc_score: 0.8661; val_best_acc_score: 0.7868; val_best_f1_score: 0.7962; train_kl_reg_loss: 93241.6411; train_edge_recon_loss: 32428648.4795; train_gene_expr_recon_loss: 21606546.3155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54128436.4921; train_optim_loss: 54128436.4921; val_kl_reg_loss: 93097.5519; val_edge_recon_loss: 33198823.3889; val_gene_expr_recon_loss: 21757611.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55049532.6667; val_optim_loss: 55049532.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8700; val_auprc_score: 0.8676; val_best_acc_score: 0.7860; val_best_f1_score: 0.7969; train_kl_reg_loss: 93297.9355; train_edge_recon_loss: 32426157.6088; train_gene_expr_recon_loss: 21599053.9306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54118509.4006; train_optim_loss: 54118509.4006; val_kl_reg_loss: 93045.1037; val_edge_recon_loss: 33184181.8333; val_gene_expr_recon_loss: 21802759.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55079986.2222; val_optim_loss: 55079986.2222
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8695; val_auprc_score: 0.8680; val_best_acc_score: 0.7842; val_best_f1_score: 0.7963; train_kl_reg_loss: 93260.5570; train_edge_recon_loss: 32443072.7382; train_gene_expr_recon_loss: 21604566.4164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54140899.6719; train_optim_loss: 54140899.6719; val_kl_reg_loss: 92931.4199; val_edge_recon_loss: 33205485.3889; val_gene_expr_recon_loss: 21760304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55058721.1111; val_optim_loss: 55058721.1111

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 2 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.8609
val AUPRC score: 0.8589
val best accuracy score: 0.7763
val best F1 score: 0.7883
val target rna MSE score: 2.8016
val source rna MSE score: 0.3704
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0065
Val cat covariate2 mean sim diff: nan

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
