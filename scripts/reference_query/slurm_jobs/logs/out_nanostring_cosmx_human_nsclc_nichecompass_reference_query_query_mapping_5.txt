Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--query_batches', 'batch8', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '02092023_233857_1', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 68882
Number of validation nodes: 7654
Number of training edges: 162180
Number of validation edges: 18020
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8194; val_auprc_score: 0.8152; val_best_acc_score: 0.7403; val_best_f1_score: 0.7593; train_kl_reg_loss: 17237.6242; train_edge_recon_loss: 3150300.0394; train_gene_expr_recon_loss: 6140995.5363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 9308533.1719; train_optim_loss: 9308533.1719; val_kl_reg_loss: 17355.3121; val_edge_recon_loss: 3222924.4028; val_gene_expr_recon_loss: 3991935.3681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7232215.0833; val_optim_loss: 7232215.0833
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8185; val_auprc_score: 0.8145; val_best_acc_score: 0.7383; val_best_f1_score: 0.7569; train_kl_reg_loss: 17239.9710; train_edge_recon_loss: 3153132.9030; train_gene_expr_recon_loss: 5544831.2319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8715204.1262; train_optim_loss: 8715204.1262; val_kl_reg_loss: 17371.1245; val_edge_recon_loss: 3222793.7014; val_gene_expr_recon_loss: 3573285.5069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6813450.3333; val_optim_loss: 6813450.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8204; val_auprc_score: 0.8177; val_best_acc_score: 0.7400; val_best_f1_score: 0.7577; train_kl_reg_loss: 17245.2714; train_edge_recon_loss: 3151444.4968; train_gene_expr_recon_loss: 5163417.0379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8332106.8028; train_optim_loss: 8332106.8028; val_kl_reg_loss: 17356.2982; val_edge_recon_loss: 3224405.7708; val_gene_expr_recon_loss: 3306913.5694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6548675.6389; val_optim_loss: 6548675.6389
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8191; val_auprc_score: 0.8168; val_best_acc_score: 0.7394; val_best_f1_score: 0.7567; train_kl_reg_loss: 17240.8114; train_edge_recon_loss: 3149747.8328; train_gene_expr_recon_loss: 4910559.1640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8077547.8013; train_optim_loss: 8077547.8013; val_kl_reg_loss: 17352.3267; val_edge_recon_loss: 3225090.0972; val_gene_expr_recon_loss: 3105639.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6348081.9028; val_optim_loss: 6348081.9028
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8201; val_auprc_score: 0.8188; val_best_acc_score: 0.7394; val_best_f1_score: 0.7582; train_kl_reg_loss: 17243.2757; train_edge_recon_loss: 3149725.4148; train_gene_expr_recon_loss: 4743689.5986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7910658.2950; train_optim_loss: 7910658.2950; val_kl_reg_loss: 17346.0426; val_edge_recon_loss: 3222857.0139; val_gene_expr_recon_loss: 2999631.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6239835.0972; val_optim_loss: 6239835.0972
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8221; val_auprc_score: 0.8202; val_best_acc_score: 0.7410; val_best_f1_score: 0.7587; train_kl_reg_loss: 17239.6652; train_edge_recon_loss: 3152029.9866; train_gene_expr_recon_loss: 4650705.6901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7819975.3265; train_optim_loss: 7819975.3265; val_kl_reg_loss: 17352.8464; val_edge_recon_loss: 3217588.4236; val_gene_expr_recon_loss: 2951895.3611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6186836.6389; val_optim_loss: 6186836.6389
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8199; val_auprc_score: 0.8162; val_best_acc_score: 0.7405; val_best_f1_score: 0.7576; train_kl_reg_loss: 17236.5316; train_edge_recon_loss: 3151506.4700; train_gene_expr_recon_loss: 4576168.5702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7744911.5678; train_optim_loss: 7744911.5678; val_kl_reg_loss: 17338.2171; val_edge_recon_loss: 3226753.7708; val_gene_expr_recon_loss: 2915952.6181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6160044.6389; val_optim_loss: 6160044.6389
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8191; val_auprc_score: 0.8171; val_best_acc_score: 0.7394; val_best_f1_score: 0.7581; train_kl_reg_loss: 17245.3086; train_edge_recon_loss: 3148950.0536; train_gene_expr_recon_loss: 4545975.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7712171.2177; train_optim_loss: 7712171.2177; val_kl_reg_loss: 17360.4243; val_edge_recon_loss: 3227510.5972; val_gene_expr_recon_loss: 2904797.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6149668.3056; val_optim_loss: 6149668.3056
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8192; val_auprc_score: 0.8168; val_best_acc_score: 0.7413; val_best_f1_score: 0.7572; train_kl_reg_loss: 17240.9063; train_edge_recon_loss: 3149952.5008; train_gene_expr_recon_loss: 4559866.2145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7727059.6183; train_optim_loss: 7727059.6183; val_kl_reg_loss: 17364.4474; val_edge_recon_loss: 3223889.7986; val_gene_expr_recon_loss: 2885704.0278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6126958.2639; val_optim_loss: 6126958.2639
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8204; val_auprc_score: 0.8175; val_best_acc_score: 0.7412; val_best_f1_score: 0.7570; train_kl_reg_loss: 17238.2046; train_edge_recon_loss: 3150951.8218; train_gene_expr_recon_loss: 4507005.2129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7675195.2587; train_optim_loss: 7675195.2587; val_kl_reg_loss: 17362.8509; val_edge_recon_loss: 3226849.6111; val_gene_expr_recon_loss: 2875983.6389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6120196.1250; val_optim_loss: 6120196.1250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8197; val_auprc_score: 0.8173; val_best_acc_score: 0.7402; val_best_f1_score: 0.7575; train_kl_reg_loss: 17241.6277; train_edge_recon_loss: 3150797.1546; train_gene_expr_recon_loss: 4484205.7177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7652244.4732; train_optim_loss: 7652244.4732; val_kl_reg_loss: 17352.2300; val_edge_recon_loss: 3223883.2153; val_gene_expr_recon_loss: 2873480.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6114715.6111; val_optim_loss: 6114715.6111
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8190; val_auprc_score: 0.8162; val_best_acc_score: 0.7403; val_best_f1_score: 0.7579; train_kl_reg_loss: 17239.1041; train_edge_recon_loss: 3149266.6341; train_gene_expr_recon_loss: 4483247.0907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7649752.8265; train_optim_loss: 7649752.8265; val_kl_reg_loss: 17361.6856; val_edge_recon_loss: 3228798.1736; val_gene_expr_recon_loss: 2860234.9236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6106394.7639; val_optim_loss: 6106394.7639
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8175; val_auprc_score: 0.8128; val_best_acc_score: 0.7386; val_best_f1_score: 0.7568; train_kl_reg_loss: 17231.8667; train_edge_recon_loss: 3151322.1506; train_gene_expr_recon_loss: 4485715.1033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7654269.1278; train_optim_loss: 7654269.1278; val_kl_reg_loss: 17371.4298; val_edge_recon_loss: 3229702.9514; val_gene_expr_recon_loss: 2855551.7639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6102626.0972; val_optim_loss: 6102626.0972
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8181; val_auprc_score: 0.8154; val_best_acc_score: 0.7374; val_best_f1_score: 0.7562; train_kl_reg_loss: 17242.7627; train_edge_recon_loss: 3150205.8368; train_gene_expr_recon_loss: 4499744.6483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7667193.2492; train_optim_loss: 7667193.2492; val_kl_reg_loss: 17356.1471; val_edge_recon_loss: 3231430.9097; val_gene_expr_recon_loss: 2857845.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6106632.6250; val_optim_loss: 6106632.6250
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8204; val_auprc_score: 0.8173; val_best_acc_score: 0.7405; val_best_f1_score: 0.7586; train_kl_reg_loss: 17244.7352; train_edge_recon_loss: 3150455.0875; train_gene_expr_recon_loss: 4491946.1530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7659645.9669; train_optim_loss: 7659645.9669; val_kl_reg_loss: 17356.8047; val_edge_recon_loss: 3224442.2361; val_gene_expr_recon_loss: 2853249.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6095048.4306; val_optim_loss: 6095048.4306
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8165; val_auprc_score: 0.8126; val_best_acc_score: 0.7373; val_best_f1_score: 0.7561; train_kl_reg_loss: 17241.5962; train_edge_recon_loss: 3150881.7855; train_gene_expr_recon_loss: 4434098.2350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7602221.5946; train_optim_loss: 7602221.5946; val_kl_reg_loss: 17344.0216; val_edge_recon_loss: 3234759.1111; val_gene_expr_recon_loss: 2840019.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6092122.7500; val_optim_loss: 6092122.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8186; val_auprc_score: 0.8141; val_best_acc_score: 0.7396; val_best_f1_score: 0.7585; train_kl_reg_loss: 17243.7902; train_edge_recon_loss: 3149355.1065; train_gene_expr_recon_loss: 4448911.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7615510.6530; train_optim_loss: 7615510.6530; val_kl_reg_loss: 17349.5919; val_edge_recon_loss: 3223867.8264; val_gene_expr_recon_loss: 2838756.8403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6079974.2083; val_optim_loss: 6079974.2083
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8230; val_auprc_score: 0.8194; val_best_acc_score: 0.7424; val_best_f1_score: 0.7611; train_kl_reg_loss: 17237.5910; train_edge_recon_loss: 3150790.4022; train_gene_expr_recon_loss: 4443100.5323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7611128.5252; train_optim_loss: 7611128.5252; val_kl_reg_loss: 17352.8816; val_edge_recon_loss: 3215492.4375; val_gene_expr_recon_loss: 2840197.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6073043.1389; val_optim_loss: 6073043.1389
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8201; val_auprc_score: 0.8174; val_best_acc_score: 0.7410; val_best_f1_score: 0.7583; train_kl_reg_loss: 17247.7105; train_edge_recon_loss: 3149711.2129; train_gene_expr_recon_loss: 4454307.2153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7621266.1230; train_optim_loss: 7621266.1230; val_kl_reg_loss: 17324.0017; val_edge_recon_loss: 3224974.1042; val_gene_expr_recon_loss: 2839026.0069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6081324.0833; val_optim_loss: 6081324.0833
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8195; val_auprc_score: 0.8150; val_best_acc_score: 0.7408; val_best_f1_score: 0.7583; train_kl_reg_loss: 17232.4602; train_edge_recon_loss: 3148771.9448; train_gene_expr_recon_loss: 4432273.3099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7598277.7066; train_optim_loss: 7598277.7066; val_kl_reg_loss: 17354.9947; val_edge_recon_loss: 3222131.5903; val_gene_expr_recon_loss: 2833403.0069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6072889.6528; val_optim_loss: 6072889.6528
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8204; val_auprc_score: 0.8186; val_best_acc_score: 0.7411; val_best_f1_score: 0.7586; train_kl_reg_loss: 17247.3833; train_edge_recon_loss: 3151777.0812; train_gene_expr_recon_loss: 4428897.3896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7597921.8375; train_optim_loss: 7597921.8375; val_kl_reg_loss: 17360.3373; val_edge_recon_loss: 3222486.3889; val_gene_expr_recon_loss: 2840471.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6080318.1528; val_optim_loss: 6080318.1528
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8193; val_auprc_score: 0.8172; val_best_acc_score: 0.7401; val_best_f1_score: 0.7572; train_kl_reg_loss: 17241.4856; train_edge_recon_loss: 3148727.2500; train_gene_expr_recon_loss: 4434105.9369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7600074.6909; train_optim_loss: 7600074.6909; val_kl_reg_loss: 17357.3315; val_edge_recon_loss: 3226191.2986; val_gene_expr_recon_loss: 2834839.8056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6078388.4167; val_optim_loss: 6078388.4167
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8220; val_auprc_score: 0.8202; val_best_acc_score: 0.7426; val_best_f1_score: 0.7595; train_kl_reg_loss: 17234.4074; train_edge_recon_loss: 3150237.0489; train_gene_expr_recon_loss: 4439370.3793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7606841.8360; train_optim_loss: 7606841.8360; val_kl_reg_loss: 17341.9385; val_edge_recon_loss: 3218892.0139; val_gene_expr_recon_loss: 2832723.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6068956.9861; val_optim_loss: 6068956.9861
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8190; val_auprc_score: 0.8169; val_best_acc_score: 0.7391; val_best_f1_score: 0.7568; train_kl_reg_loss: 17242.5853; train_edge_recon_loss: 3151264.8967; train_gene_expr_recon_loss: 4463011.1506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7631518.6388; train_optim_loss: 7631518.6388; val_kl_reg_loss: 17365.7503; val_edge_recon_loss: 3230142.6806; val_gene_expr_recon_loss: 2833905.0069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6081413.4167; val_optim_loss: 6081413.4167
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8191; val_auprc_score: 0.8166; val_best_acc_score: 0.7398; val_best_f1_score: 0.7568; train_kl_reg_loss: 17249.2546; train_edge_recon_loss: 3148964.8391; train_gene_expr_recon_loss: 4430193.4077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7596407.4953; train_optim_loss: 7596407.4953; val_kl_reg_loss: 17355.6404; val_edge_recon_loss: 3224956.6736; val_gene_expr_recon_loss: 2838882.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6081194.5417; val_optim_loss: 6081194.5417
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8169; val_auprc_score: 0.8129; val_best_acc_score: 0.7367; val_best_f1_score: 0.7556; train_kl_reg_loss: 17244.5373; train_edge_recon_loss: 3149156.6625; train_gene_expr_recon_loss: 3230728.4416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6397129.6498; train_optim_loss: 6397129.6498; val_kl_reg_loss: 16667.6226; val_edge_recon_loss: 3223278.0972; val_gene_expr_recon_loss: 2242321.1181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5482266.8333; val_optim_loss: 5482266.8333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8139; val_auprc_score: 0.8118; val_best_acc_score: 0.7340; val_best_f1_score: 0.7532; train_kl_reg_loss: 17241.9043; train_edge_recon_loss: 3148321.6893; train_gene_expr_recon_loss: 3203821.5568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6369385.1562; train_optim_loss: 6369385.1562; val_kl_reg_loss: 16669.1087; val_edge_recon_loss: 3232197.1528; val_gene_expr_recon_loss: 2245774.2639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5494640.5833; val_optim_loss: 5494640.5833
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8126; val_auprc_score: 0.8085; val_best_acc_score: 0.7332; val_best_f1_score: 0.7524; train_kl_reg_loss: 17235.4960; train_edge_recon_loss: 3151273.4227; train_gene_expr_recon_loss: 3202390.5670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6370899.4858; train_optim_loss: 6370899.4858; val_kl_reg_loss: 16641.3156; val_edge_recon_loss: 3234787.8264; val_gene_expr_recon_loss: 2237315.9653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5488745.0833; val_optim_loss: 5488745.0833
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8129; val_auprc_score: 0.8097; val_best_acc_score: 0.7330; val_best_f1_score: 0.7531; train_kl_reg_loss: 17232.3941; train_edge_recon_loss: 3149665.1569; train_gene_expr_recon_loss: 3185471.5505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6352369.0962; train_optim_loss: 6352369.0962; val_kl_reg_loss: 16668.9309; val_edge_recon_loss: 3235310.6875; val_gene_expr_recon_loss: 2237484.2847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5489463.9167; val_optim_loss: 5489463.9167
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8130; val_auprc_score: 0.8086; val_best_acc_score: 0.7345; val_best_f1_score: 0.7523; train_kl_reg_loss: 17244.8897; train_edge_recon_loss: 3151479.5852; train_gene_expr_recon_loss: 3184416.6459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6353141.1293; train_optim_loss: 6353141.1293; val_kl_reg_loss: 16669.2550; val_edge_recon_loss: 3232698.9861; val_gene_expr_recon_loss: 2241783.9931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5491152.2361; val_optim_loss: 5491152.2361

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8169; val_auprc_score: 0.8127; val_best_acc_score: 0.7371; val_best_f1_score: 0.7558; train_kl_reg_loss: 17242.9483; train_edge_recon_loss: 3149989.2681; train_gene_expr_recon_loss: 3182467.4148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6349699.6183; train_optim_loss: 6349699.6183; val_kl_reg_loss: 16662.4876; val_edge_recon_loss: 3220348.2292; val_gene_expr_recon_loss: 2242215.0972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5479225.8333; val_optim_loss: 5479225.8333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8116; val_auprc_score: 0.8064; val_best_acc_score: 0.7332; val_best_f1_score: 0.7536; train_kl_reg_loss: 17241.4275; train_edge_recon_loss: 3150056.6175; train_gene_expr_recon_loss: 3198958.0536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6366256.0962; train_optim_loss: 6366256.0962; val_kl_reg_loss: 16672.0600; val_edge_recon_loss: 3231732.4097; val_gene_expr_recon_loss: 2233838.9722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5482243.4861; val_optim_loss: 5482243.4861
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8126; val_auprc_score: 0.8079; val_best_acc_score: 0.7345; val_best_f1_score: 0.7527; train_kl_reg_loss: 17239.7211; train_edge_recon_loss: 3152577.2011; train_gene_expr_recon_loss: 3206013.0174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6375829.9290; train_optim_loss: 6375829.9290; val_kl_reg_loss: 16665.1933; val_edge_recon_loss: 3238215.4028; val_gene_expr_recon_loss: 2241898.4132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5496778.9861; val_optim_loss: 5496778.9861
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8149; val_auprc_score: 0.8133; val_best_acc_score: 0.7360; val_best_f1_score: 0.7541; train_kl_reg_loss: 17236.4370; train_edge_recon_loss: 3150110.7326; train_gene_expr_recon_loss: 3189084.7200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6356431.8849; train_optim_loss: 6356431.8849; val_kl_reg_loss: 16675.7974; val_edge_recon_loss: 3228697.6319; val_gene_expr_recon_loss: 2236805.8611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5482179.2778; val_optim_loss: 5482179.2778
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8154; val_auprc_score: 0.8128; val_best_acc_score: 0.7369; val_best_f1_score: 0.7533; train_kl_reg_loss: 17244.3659; train_edge_recon_loss: 3151139.5055; train_gene_expr_recon_loss: 3193268.8785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6361652.7350; train_optim_loss: 6361652.7350; val_kl_reg_loss: 16664.0188; val_edge_recon_loss: 3230168.0764; val_gene_expr_recon_loss: 2238709.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5485541.7500; val_optim_loss: 5485541.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8150; val_auprc_score: 0.8119; val_best_acc_score: 0.7363; val_best_f1_score: 0.7543; train_kl_reg_loss: 17241.1019; train_edge_recon_loss: 3148991.3454; train_gene_expr_recon_loss: 3186553.2185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6352785.6498; train_optim_loss: 6352785.6498; val_kl_reg_loss: 16673.6362; val_edge_recon_loss: 3231626.8889; val_gene_expr_recon_loss: 2233703.7882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5482004.3056; val_optim_loss: 5482004.3056
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8151; val_auprc_score: 0.8118; val_best_acc_score: 0.7358; val_best_f1_score: 0.7547; train_kl_reg_loss: 17236.8413; train_edge_recon_loss: 3150821.2752; train_gene_expr_recon_loss: 3180686.2476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6348744.3817; train_optim_loss: 6348744.3817; val_kl_reg_loss: 16642.0202; val_edge_recon_loss: 3225701.3750; val_gene_expr_recon_loss: 2236269.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5478612.8472; val_optim_loss: 5478612.8472
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8160; val_auprc_score: 0.8144; val_best_acc_score: 0.7360; val_best_f1_score: 0.7542; train_kl_reg_loss: 17248.2075; train_edge_recon_loss: 3149214.5402; train_gene_expr_recon_loss: 3196874.2650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6363337.0158; train_optim_loss: 6363337.0158; val_kl_reg_loss: 16679.4778; val_edge_recon_loss: 3226156.3194; val_gene_expr_recon_loss: 2238892.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5481728.1250; val_optim_loss: 5481728.1250
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8135; val_auprc_score: 0.8093; val_best_acc_score: 0.7358; val_best_f1_score: 0.7548; train_kl_reg_loss: 17248.5354; train_edge_recon_loss: 3149779.0521; train_gene_expr_recon_loss: 3172355.3722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6339382.9779; train_optim_loss: 6339382.9779; val_kl_reg_loss: 16648.7313; val_edge_recon_loss: 3233465.7778; val_gene_expr_recon_loss: 2236502.4097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5486616.8889; val_optim_loss: 5486616.8889
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8158; val_auprc_score: 0.8127; val_best_acc_score: 0.7374; val_best_f1_score: 0.7548; train_kl_reg_loss: 17232.2202; train_edge_recon_loss: 3148225.7374; train_gene_expr_recon_loss: 3183963.3304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6349421.3013; train_optim_loss: 6349421.3013; val_kl_reg_loss: 16666.2135; val_edge_recon_loss: 3227512.9236; val_gene_expr_recon_loss: 2239128.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5483307.1250; val_optim_loss: 5483307.1250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8158; val_auprc_score: 0.8126; val_best_acc_score: 0.7368; val_best_f1_score: 0.7548; train_kl_reg_loss: 17241.1203; train_edge_recon_loss: 3149610.2271; train_gene_expr_recon_loss: 3185648.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6352499.9511; train_optim_loss: 6352499.9511; val_kl_reg_loss: 16667.3401; val_edge_recon_loss: 3230491.9653; val_gene_expr_recon_loss: 2236776.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5483935.7639; val_optim_loss: 5483935.7639

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8161; val_auprc_score: 0.8127; val_best_acc_score: 0.7367; val_best_f1_score: 0.7562; train_kl_reg_loss: 17242.5993; train_edge_recon_loss: 3151491.1640; train_gene_expr_recon_loss: 3183625.9306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6352359.6719; train_optim_loss: 6352359.6719; val_kl_reg_loss: 16646.8012; val_edge_recon_loss: 3226969.7153; val_gene_expr_recon_loss: 2231473.3681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5475089.8333; val_optim_loss: 5475089.8333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8167; val_auprc_score: 0.8126; val_best_acc_score: 0.7388; val_best_f1_score: 0.7557; train_kl_reg_loss: 17234.9870; train_edge_recon_loss: 3150169.1759; train_gene_expr_recon_loss: 3194072.9298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6361477.1088; train_optim_loss: 6361477.1088; val_kl_reg_loss: 16659.1070; val_edge_recon_loss: 3223467.7778; val_gene_expr_recon_loss: 2240179.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5480306.3750; val_optim_loss: 5480306.3750
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8121; val_auprc_score: 0.8085; val_best_acc_score: 0.7325; val_best_f1_score: 0.7528; train_kl_reg_loss: 17242.7862; train_edge_recon_loss: 3150033.1759; train_gene_expr_recon_loss: 3201322.6065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6368598.5662; train_optim_loss: 6368598.5662; val_kl_reg_loss: 16649.1090; val_edge_recon_loss: 3236870.3542; val_gene_expr_recon_loss: 2231419.5243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5484938.9306; val_optim_loss: 5484938.9306
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8155; val_auprc_score: 0.8117; val_best_acc_score: 0.7381; val_best_f1_score: 0.7548; train_kl_reg_loss: 17241.2157; train_edge_recon_loss: 3148813.1002; train_gene_expr_recon_loss: 3183471.9968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6349526.2997; train_optim_loss: 6349526.2997; val_kl_reg_loss: 16662.1075; val_edge_recon_loss: 3223474.1875; val_gene_expr_recon_loss: 2239318.6215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5479454.9444; val_optim_loss: 5479454.9444
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8172; val_auprc_score: 0.8139; val_best_acc_score: 0.7376; val_best_f1_score: 0.7572; train_kl_reg_loss: 17238.1504; train_edge_recon_loss: 3150958.2784; train_gene_expr_recon_loss: 3167829.3612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6336025.8013; train_optim_loss: 6336025.8013; val_kl_reg_loss: 16660.3944; val_edge_recon_loss: 3224365.4583; val_gene_expr_recon_loss: 2230651.8681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5471677.7361; val_optim_loss: 5471677.7361
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8131; val_auprc_score: 0.8096; val_best_acc_score: 0.7350; val_best_f1_score: 0.7531; train_kl_reg_loss: 17238.4350; train_edge_recon_loss: 3149863.9748; train_gene_expr_recon_loss: 3189108.8872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6356211.3013; train_optim_loss: 6356211.3013; val_kl_reg_loss: 16654.4043; val_edge_recon_loss: 3229844.6597; val_gene_expr_recon_loss: 2234644.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5481143.1528; val_optim_loss: 5481143.1528
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8147; val_auprc_score: 0.8108; val_best_acc_score: 0.7363; val_best_f1_score: 0.7545; train_kl_reg_loss: 17232.2291; train_edge_recon_loss: 3152332.0221; train_gene_expr_recon_loss: 3186703.5733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6356267.8344; train_optim_loss: 6356267.8344; val_kl_reg_loss: 16643.3716; val_edge_recon_loss: 3229524.5347; val_gene_expr_recon_loss: 2236311.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5482479.1250; val_optim_loss: 5482479.1250
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8129; val_auprc_score: 0.8079; val_best_acc_score: 0.7348; val_best_f1_score: 0.7539; train_kl_reg_loss: 17243.4988; train_edge_recon_loss: 3149833.0797; train_gene_expr_recon_loss: 3185032.4535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6352109.0379; train_optim_loss: 6352109.0379; val_kl_reg_loss: 16666.9665; val_edge_recon_loss: 3235933.6528; val_gene_expr_recon_loss: 2240273.3889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5492874.0000; val_optim_loss: 5492874.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8158; val_auprc_score: 0.8139; val_best_acc_score: 0.7357; val_best_f1_score: 0.7550; train_kl_reg_loss: 17242.6408; train_edge_recon_loss: 3150972.5237; train_gene_expr_recon_loss: 3199912.1688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6368127.3580; train_optim_loss: 6368127.3580; val_kl_reg_loss: 16638.6755; val_edge_recon_loss: 3228853.5903; val_gene_expr_recon_loss: 2237281.7153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5482774.0556; val_optim_loss: 5482774.0556

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8143; val_auprc_score: 0.8113; val_best_acc_score: 0.7363; val_best_f1_score: 0.7542; train_kl_reg_loss: 17239.8053; train_edge_recon_loss: 3149746.9369; train_gene_expr_recon_loss: 3186736.3218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6353723.0599; train_optim_loss: 6353723.0599; val_kl_reg_loss: 16636.1533; val_edge_recon_loss: 3235513.9167; val_gene_expr_recon_loss: 2232618.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5484769.0000; val_optim_loss: 5484769.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8144; val_auprc_score: 0.8119; val_best_acc_score: 0.7346; val_best_f1_score: 0.7534; train_kl_reg_loss: 17242.8911; train_edge_recon_loss: 3149455.8431; train_gene_expr_recon_loss: 3190680.0576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6357378.7760; train_optim_loss: 6357378.7760; val_kl_reg_loss: 16660.3862; val_edge_recon_loss: 3228319.6181; val_gene_expr_recon_loss: 2232981.7222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5477961.7361; val_optim_loss: 5477961.7361
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8145; val_auprc_score: 0.8101; val_best_acc_score: 0.7349; val_best_f1_score: 0.7546; train_kl_reg_loss: 17242.7033; train_edge_recon_loss: 3150853.1680; train_gene_expr_recon_loss: 3164638.8131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6332734.7019; train_optim_loss: 6332734.7019; val_kl_reg_loss: 16654.7875; val_edge_recon_loss: 3232033.4097; val_gene_expr_recon_loss: 2236278.0799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5484966.3472; val_optim_loss: 5484966.3472
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8135; val_auprc_score: 0.8101; val_best_acc_score: 0.7344; val_best_f1_score: 0.7536; train_kl_reg_loss: 17233.8775; train_edge_recon_loss: 3150245.8644; train_gene_expr_recon_loss: 3185328.1073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6352807.8628; train_optim_loss: 6352807.8628; val_kl_reg_loss: 16654.2095; val_edge_recon_loss: 3236214.1042; val_gene_expr_recon_loss: 2233350.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5486218.4583; val_optim_loss: 5486218.4583

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 104 min 56 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.8141
val AUPRC score: 0.8110
val best accuracy score: 0.7355
val best F1 score: 0.7546
val target rna MSE score: 15.3951
val source rna MSE score: 0.9448
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0061
Val cat covariate2 mean sim diff: nan

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
