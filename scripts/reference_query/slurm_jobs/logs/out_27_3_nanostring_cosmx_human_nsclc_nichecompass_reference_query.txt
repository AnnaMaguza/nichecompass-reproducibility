Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--query_batches', 'batch3', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '06102023_173136_27', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_cat_covariates_contrastive', '0.', '--contrastive_logits_pos_ratio', '0.', '--contrastive_logits_neg_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 82522
Number of validation nodes: 9169
Number of training edges: 195815
Number of validation edges: 21757
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9450; val_auprc_score: 0.9375; val_best_acc_score: 0.8776; val_best_f1_score: 0.8823; train_kl_reg_loss: 67047.9261; train_edge_recon_loss: 27360913.5091; train_gene_expr_recon_loss: 35062980.1619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62490941.6397; train_optim_loss: 62490941.6397; val_kl_reg_loss: 67203.2605; val_edge_recon_loss: 28096521.8605; val_gene_expr_recon_loss: 31739975.8605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59903701.0233; val_optim_loss: 59903701.0233
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9423; val_auprc_score: 0.9332; val_best_acc_score: 0.8759; val_best_f1_score: 0.8805; train_kl_reg_loss: 67032.1215; train_edge_recon_loss: 27338637.5666; train_gene_expr_recon_loss: 31061573.0601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58467242.6736; train_optim_loss: 58467242.6736; val_kl_reg_loss: 67254.3726; val_edge_recon_loss: 28145095.3023; val_gene_expr_recon_loss: 28448816.8837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56661166.5116; val_optim_loss: 56661166.5116
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9444; val_auprc_score: 0.9368; val_best_acc_score: 0.8756; val_best_f1_score: 0.8805; train_kl_reg_loss: 67079.3890; train_edge_recon_loss: 27335734.3655; train_gene_expr_recon_loss: 28608305.7076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56011119.4465; train_optim_loss: 56011119.4465; val_kl_reg_loss: 67266.9669; val_edge_recon_loss: 28128693.5349; val_gene_expr_recon_loss: 26966444.3256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55162405.0233; val_optim_loss: 55162405.0233
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9447; val_auprc_score: 0.9373; val_best_acc_score: 0.8779; val_best_f1_score: 0.8825; train_kl_reg_loss: 67052.9028; train_edge_recon_loss: 27356995.2950; train_gene_expr_recon_loss: 27530222.4334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54954270.5796; train_optim_loss: 54954270.5796; val_kl_reg_loss: 67236.7327; val_edge_recon_loss: 28090661.3488; val_gene_expr_recon_loss: 26127778.9302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54285677.2093; val_optim_loss: 54285677.2093
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9456; val_auprc_score: 0.9383; val_best_acc_score: 0.8786; val_best_f1_score: 0.8834; train_kl_reg_loss: 67084.3258; train_edge_recon_loss: 27337844.1775; train_gene_expr_recon_loss: 26934231.5352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54339160.0104; train_optim_loss: 54339160.0104; val_kl_reg_loss: 67364.1871; val_edge_recon_loss: 28082180.9767; val_gene_expr_recon_loss: 25783813.3488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53933358.4186; val_optim_loss: 53933358.4186
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9434; val_auprc_score: 0.9348; val_best_acc_score: 0.8759; val_best_f1_score: 0.8804; train_kl_reg_loss: 67047.6541; train_edge_recon_loss: 27354359.4517; train_gene_expr_recon_loss: 26621517.0496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54042924.1358; train_optim_loss: 54042924.1358; val_kl_reg_loss: 67378.4755; val_edge_recon_loss: 28116563.6279; val_gene_expr_recon_loss: 25509020.1860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53692962.3256; val_optim_loss: 53692962.3256
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9446; val_auprc_score: 0.9369; val_best_acc_score: 0.8758; val_best_f1_score: 0.8802; train_kl_reg_loss: 67086.7040; train_edge_recon_loss: 27345634.9869; train_gene_expr_recon_loss: 26360961.6554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53773683.2480; train_optim_loss: 53773683.2480; val_kl_reg_loss: 67187.9806; val_edge_recon_loss: 28127089.3953; val_gene_expr_recon_loss: 25314223.9070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53508501.3023; val_optim_loss: 53508501.3023
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9452; val_auprc_score: 0.9374; val_best_acc_score: 0.8779; val_best_f1_score: 0.8824; train_kl_reg_loss: 67027.9527; train_edge_recon_loss: 27374382.7050; train_gene_expr_recon_loss: 26170335.5718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53611746.2454; train_optim_loss: 53611746.2454; val_kl_reg_loss: 67381.6050; val_edge_recon_loss: 28073097.4419; val_gene_expr_recon_loss: 25185802.3256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53326281.9535; val_optim_loss: 53326281.9535
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9425; val_auprc_score: 0.9335; val_best_acc_score: 0.8738; val_best_f1_score: 0.8790; train_kl_reg_loss: 67082.6340; train_edge_recon_loss: 27357097.9948; train_gene_expr_recon_loss: 26015905.7911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53440086.3708; train_optim_loss: 53440086.3708; val_kl_reg_loss: 67329.1323; val_edge_recon_loss: 28145364.1860; val_gene_expr_recon_loss: 25020624.8837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53233318.3256; val_optim_loss: 53233318.3256
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9449; val_auprc_score: 0.9363; val_best_acc_score: 0.8789; val_best_f1_score: 0.8830; train_kl_reg_loss: 67050.7531; train_edge_recon_loss: 27363844.5117; train_gene_expr_recon_loss: 25899447.7807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53330343.0392; train_optim_loss: 53330343.0392; val_kl_reg_loss: 67319.5084; val_edge_recon_loss: 28059615.4884; val_gene_expr_recon_loss: 24876426.8372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53003361.8605; val_optim_loss: 53003361.8605
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9447; val_auprc_score: 0.9363; val_best_acc_score: 0.8776; val_best_f1_score: 0.8825; train_kl_reg_loss: 67068.5749; train_edge_recon_loss: 27353706.8773; train_gene_expr_recon_loss: 25804408.8355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53225184.2611; train_optim_loss: 53225184.2611; val_kl_reg_loss: 67199.3429; val_edge_recon_loss: 28056661.0698; val_gene_expr_recon_loss: 24843092.4651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52966952.8372; val_optim_loss: 52966952.8372
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9447; val_auprc_score: 0.9364; val_best_acc_score: 0.8759; val_best_f1_score: 0.8809; train_kl_reg_loss: 67057.5051; train_edge_recon_loss: 27354804.5170; train_gene_expr_recon_loss: 25706307.6762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53128169.7023; train_optim_loss: 53128169.7023; val_kl_reg_loss: 67267.9628; val_edge_recon_loss: 28076484.2791; val_gene_expr_recon_loss: 24703952.9302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52847705.3953; val_optim_loss: 52847705.3953
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9428; val_auprc_score: 0.9343; val_best_acc_score: 0.8755; val_best_f1_score: 0.8807; train_kl_reg_loss: 67044.1826; train_edge_recon_loss: 27353012.5901; train_gene_expr_recon_loss: 25635166.1149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53055222.9869; train_optim_loss: 53055222.9869; val_kl_reg_loss: 67350.2542; val_edge_recon_loss: 28138748.0465; val_gene_expr_recon_loss: 24673165.4419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52879263.7209; val_optim_loss: 52879263.7209
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9450; val_auprc_score: 0.9379; val_best_acc_score: 0.8775; val_best_f1_score: 0.8826; train_kl_reg_loss: 67058.8877; train_edge_recon_loss: 27344314.9243; train_gene_expr_recon_loss: 25632694.3029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53044068.1775; train_optim_loss: 53044068.1775; val_kl_reg_loss: 67363.2596; val_edge_recon_loss: 28083798.4186; val_gene_expr_recon_loss: 24642596.7907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52793758.6977; val_optim_loss: 52793758.6977
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9442; val_auprc_score: 0.9362; val_best_acc_score: 0.8765; val_best_f1_score: 0.8812; train_kl_reg_loss: 67032.6093; train_edge_recon_loss: 27374723.6292; train_gene_expr_recon_loss: 25550790.4961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52992546.7154; train_optim_loss: 52992546.7154; val_kl_reg_loss: 67285.6484; val_edge_recon_loss: 28101556.3721; val_gene_expr_recon_loss: 24537594.9302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52706436.8372; val_optim_loss: 52706436.8372
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9443; val_auprc_score: 0.9353; val_best_acc_score: 0.8772; val_best_f1_score: 0.8818; train_kl_reg_loss: 67038.0659; train_edge_recon_loss: 27355774.4230; train_gene_expr_recon_loss: 25501552.6266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52924365.1279; train_optim_loss: 52924365.1279; val_kl_reg_loss: 67229.8752; val_edge_recon_loss: 28087748.7907; val_gene_expr_recon_loss: 24552083.3488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52707061.9535; val_optim_loss: 52707061.9535
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9450; val_auprc_score: 0.9363; val_best_acc_score: 0.8793; val_best_f1_score: 0.8839; train_kl_reg_loss: 67085.0160; train_edge_recon_loss: 27337528.4595; train_gene_expr_recon_loss: 25542878.3238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52947491.7493; train_optim_loss: 52947491.7493; val_kl_reg_loss: 67420.1930; val_edge_recon_loss: 28058806.0465; val_gene_expr_recon_loss: 24545094.2791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52671320.7442; val_optim_loss: 52671320.7442
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9448; val_auprc_score: 0.9359; val_best_acc_score: 0.8785; val_best_f1_score: 0.8829; train_kl_reg_loss: 67047.5326; train_edge_recon_loss: 27344005.1018; train_gene_expr_recon_loss: 25437284.6997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52848337.3159; train_optim_loss: 52848337.3159; val_kl_reg_loss: 67165.2549; val_edge_recon_loss: 28045842.4186; val_gene_expr_recon_loss: 24526575.3023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52639582.6977; val_optim_loss: 52639582.6977
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9454; val_auprc_score: 0.9379; val_best_acc_score: 0.8778; val_best_f1_score: 0.8827; train_kl_reg_loss: 67082.6603; train_edge_recon_loss: 27360686.3394; train_gene_expr_recon_loss: 25441399.8799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52869168.7206; train_optim_loss: 52869168.7206; val_kl_reg_loss: 67312.7951; val_edge_recon_loss: 28072468.4651; val_gene_expr_recon_loss: 24485930.1395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52625711.2558; val_optim_loss: 52625711.2558
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9432; val_auprc_score: 0.9344; val_best_acc_score: 0.8754; val_best_f1_score: 0.8810; train_kl_reg_loss: 67054.1419; train_edge_recon_loss: 27356081.0183; train_gene_expr_recon_loss: 25418599.8172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52841735.0392; train_optim_loss: 52841735.0392; val_kl_reg_loss: 67303.3228; val_edge_recon_loss: 28112665.3953; val_gene_expr_recon_loss: 24525475.1628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52705444.0000; val_optim_loss: 52705444.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9437; val_auprc_score: 0.9351; val_best_acc_score: 0.8756; val_best_f1_score: 0.8800; train_kl_reg_loss: 67046.1625; train_edge_recon_loss: 27370504.5117; train_gene_expr_recon_loss: 25373997.7128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52811548.3342; train_optim_loss: 52811548.3342; val_kl_reg_loss: 67427.3457; val_edge_recon_loss: 28117554.0465; val_gene_expr_recon_loss: 24455834.7442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52640816.4651; val_optim_loss: 52640816.4651
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9447; val_auprc_score: 0.9364; val_best_acc_score: 0.8784; val_best_f1_score: 0.8826; train_kl_reg_loss: 67063.6249; train_edge_recon_loss: 27346671.7285; train_gene_expr_recon_loss: 25367378.1828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52781113.4726; train_optim_loss: 52781113.4726; val_kl_reg_loss: 67308.7371; val_edge_recon_loss: 28057170.6512; val_gene_expr_recon_loss: 24470135.5814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52594614.9767; val_optim_loss: 52594614.9767
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9445; val_auprc_score: 0.9362; val_best_acc_score: 0.8773; val_best_f1_score: 0.8815; train_kl_reg_loss: 67055.7412; train_edge_recon_loss: 27343158.3812; train_gene_expr_recon_loss: 25359767.8956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52769982.0470; train_optim_loss: 52769982.0470; val_kl_reg_loss: 67419.1068; val_edge_recon_loss: 28079060.2326; val_gene_expr_recon_loss: 24505584.0930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52652063.6279; val_optim_loss: 52652063.6279
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9443; val_auprc_score: 0.9354; val_best_acc_score: 0.8774; val_best_f1_score: 0.8823; train_kl_reg_loss: 67056.9930; train_edge_recon_loss: 27352634.6319; train_gene_expr_recon_loss: 25354457.6606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52774149.3786; train_optim_loss: 52774149.3786; val_kl_reg_loss: 67189.9099; val_edge_recon_loss: 28065896.9767; val_gene_expr_recon_loss: 24372627.3023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52505714.3256; val_optim_loss: 52505714.3256
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9435; val_auprc_score: 0.9356; val_best_acc_score: 0.8749; val_best_f1_score: 0.8801; train_kl_reg_loss: 67060.6700; train_edge_recon_loss: 27361464.3238; train_gene_expr_recon_loss: 25304198.2037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52732723.2063; train_optim_loss: 52732723.2063; val_kl_reg_loss: 67361.2756; val_edge_recon_loss: 28136132.3721; val_gene_expr_recon_loss: 24410465.4884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52613959.1628; val_optim_loss: 52613959.1628
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9446; val_auprc_score: 0.9367; val_best_acc_score: 0.8776; val_best_f1_score: 0.8821; train_kl_reg_loss: 67046.5360; train_edge_recon_loss: 27011201.6136; train_gene_expr_recon_loss: 25154534.8773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52232782.9974; train_optim_loss: 52232782.9974; val_kl_reg_loss: 60125.9230; val_edge_recon_loss: 27858480.3721; val_gene_expr_recon_loss: 24209363.3023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52127970.1395; val_optim_loss: 52127970.1395
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9454; val_auprc_score: 0.9378; val_best_acc_score: 0.8779; val_best_f1_score: 0.8827; train_kl_reg_loss: 67038.4565; train_edge_recon_loss: 27041001.4726; train_gene_expr_recon_loss: 25131173.5144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52239213.3368; train_optim_loss: 52239213.3368; val_kl_reg_loss: 60277.6310; val_edge_recon_loss: 27846146.6512; val_gene_expr_recon_loss: 24217612.2326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52124036.5581; val_optim_loss: 52124036.5581
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9449; val_auprc_score: 0.9364; val_best_acc_score: 0.8780; val_best_f1_score: 0.8825; train_kl_reg_loss: 67039.3703; train_edge_recon_loss: 27004099.1332; train_gene_expr_recon_loss: 25098774.0574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52169912.4804; train_optim_loss: 52169912.4804; val_kl_reg_loss: 60313.7316; val_edge_recon_loss: 27857202.1395; val_gene_expr_recon_loss: 24246953.4419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52164468.6512; val_optim_loss: 52164468.6512
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9439; val_auprc_score: 0.9348; val_best_acc_score: 0.8763; val_best_f1_score: 0.8818; train_kl_reg_loss: 67040.0361; train_edge_recon_loss: 27006254.7415; train_gene_expr_recon_loss: 25115054.3499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52188349.0235; train_optim_loss: 52188349.0235; val_kl_reg_loss: 60293.9397; val_edge_recon_loss: 27877909.3488; val_gene_expr_recon_loss: 24192703.5349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52130906.9767; val_optim_loss: 52130906.9767
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9436; val_auprc_score: 0.9349; val_best_acc_score: 0.8766; val_best_f1_score: 0.8814; train_kl_reg_loss: 67031.9762; train_edge_recon_loss: 27031789.5561; train_gene_expr_recon_loss: 25100046.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52198867.8851; train_optim_loss: 52198867.8851; val_kl_reg_loss: 60271.2086; val_edge_recon_loss: 27895852.4186; val_gene_expr_recon_loss: 24200250.1860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52156373.8605; val_optim_loss: 52156373.8605
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9446; val_auprc_score: 0.9359; val_best_acc_score: 0.8785; val_best_f1_score: 0.8831; train_kl_reg_loss: 67046.3702; train_edge_recon_loss: 27033605.7389; train_gene_expr_recon_loss: 25080784.1619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52181436.2715; train_optim_loss: 52181436.2715; val_kl_reg_loss: 60198.8931; val_edge_recon_loss: 27827742.5581; val_gene_expr_recon_loss: 24243315.4419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52131256.4651; val_optim_loss: 52131256.4651

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9431; val_auprc_score: 0.9339; val_best_acc_score: 0.8761; val_best_f1_score: 0.8811; train_kl_reg_loss: 67040.0208; train_edge_recon_loss: 27016148.2454; train_gene_expr_recon_loss: 25102784.8198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52185973.0757; train_optim_loss: 52185973.0757; val_kl_reg_loss: 60246.5519; val_edge_recon_loss: 27895277.6744; val_gene_expr_recon_loss: 24156746.1395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52112269.9535; val_optim_loss: 52112269.9535
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9445; val_auprc_score: 0.9361; val_best_acc_score: 0.8769; val_best_f1_score: 0.8818; train_kl_reg_loss: 67056.0291; train_edge_recon_loss: 27016311.7807; train_gene_expr_recon_loss: 25122518.4700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52205886.2768; train_optim_loss: 52205886.2768; val_kl_reg_loss: 60144.9919; val_edge_recon_loss: 27892914.7442; val_gene_expr_recon_loss: 24225690.6512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52178750.0465; val_optim_loss: 52178750.0465
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9446; val_auprc_score: 0.9362; val_best_acc_score: 0.8760; val_best_f1_score: 0.8814; train_kl_reg_loss: 67071.6964; train_edge_recon_loss: 27021015.3264; train_gene_expr_recon_loss: 25084922.9608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52173009.9321; train_optim_loss: 52173009.9321; val_kl_reg_loss: 60303.3885; val_edge_recon_loss: 27862677.6744; val_gene_expr_recon_loss: 24187030.1860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52110011.0698; val_optim_loss: 52110011.0698
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9464; val_auprc_score: 0.9380; val_best_acc_score: 0.8801; val_best_f1_score: 0.8846; train_kl_reg_loss: 67038.5239; train_edge_recon_loss: 27026138.5744; train_gene_expr_recon_loss: 25024974.2141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52118151.3211; train_optim_loss: 52118151.3211; val_kl_reg_loss: 60236.7833; val_edge_recon_loss: 27831346.5116; val_gene_expr_recon_loss: 24240220.6512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52131803.7209; val_optim_loss: 52131803.7209
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9430; val_auprc_score: 0.9336; val_best_acc_score: 0.8773; val_best_f1_score: 0.8822; train_kl_reg_loss: 67040.6602; train_edge_recon_loss: 27027728.4961; train_gene_expr_recon_loss: 25105347.2950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52200116.4700; train_optim_loss: 52200116.4700; val_kl_reg_loss: 60244.7705; val_edge_recon_loss: 27905093.3488; val_gene_expr_recon_loss: 24138535.6279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52103873.4884; val_optim_loss: 52103873.4884
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9448; val_auprc_score: 0.9363; val_best_acc_score: 0.8786; val_best_f1_score: 0.8833; train_kl_reg_loss: 67020.7653; train_edge_recon_loss: 27026432.5431; train_gene_expr_recon_loss: 25037420.3394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52130873.7337; train_optim_loss: 52130873.7337; val_kl_reg_loss: 60297.2214; val_edge_recon_loss: 27861443.0233; val_gene_expr_recon_loss: 24233808.5116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52155548.9302; val_optim_loss: 52155548.9302
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9449; val_auprc_score: 0.9366; val_best_acc_score: 0.8781; val_best_f1_score: 0.8833; train_kl_reg_loss: 67046.0238; train_edge_recon_loss: 27023985.9843; train_gene_expr_recon_loss: 25067947.8799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52158980.0000; train_optim_loss: 52158980.0000; val_kl_reg_loss: 60242.4487; val_edge_recon_loss: 27839378.0000; val_gene_expr_recon_loss: 24201468.2791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52101088.4651; val_optim_loss: 52101088.4651
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9447; val_auprc_score: 0.9350; val_best_acc_score: 0.8785; val_best_f1_score: 0.8832; train_kl_reg_loss: 67074.8899; train_edge_recon_loss: 27021751.2219; train_gene_expr_recon_loss: 25115000.0366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52203826.0888; train_optim_loss: 52203826.0888; val_kl_reg_loss: 60230.7023; val_edge_recon_loss: 27856649.8605; val_gene_expr_recon_loss: 24214289.2093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52131169.3953; val_optim_loss: 52131169.3953
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9441; val_auprc_score: 0.9352; val_best_acc_score: 0.8779; val_best_f1_score: 0.8826; train_kl_reg_loss: 67041.5187; train_edge_recon_loss: 27033235.6240; train_gene_expr_recon_loss: 25097265.2637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52197542.5483; train_optim_loss: 52197542.5483; val_kl_reg_loss: 60335.3839; val_edge_recon_loss: 27857054.9767; val_gene_expr_recon_loss: 24265683.0233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52183073.3953; val_optim_loss: 52183073.3953
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9454; val_auprc_score: 0.9378; val_best_acc_score: 0.8788; val_best_f1_score: 0.8832; train_kl_reg_loss: 67056.7386; train_edge_recon_loss: 27040008.1984; train_gene_expr_recon_loss: 25111650.9191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52218715.9791; train_optim_loss: 52218715.9791; val_kl_reg_loss: 60301.4883; val_edge_recon_loss: 27841605.5349; val_gene_expr_recon_loss: 24182494.3721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52084401.3953; val_optim_loss: 52084401.3953
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9432; val_auprc_score: 0.9351; val_best_acc_score: 0.8757; val_best_f1_score: 0.8808; train_kl_reg_loss: 67048.0496; train_edge_recon_loss: 27014990.4909; train_gene_expr_recon_loss: 25063280.6475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52145319.1227; train_optim_loss: 52145319.1227; val_kl_reg_loss: 60263.7775; val_edge_recon_loss: 27933587.7674; val_gene_expr_recon_loss: 24129924.0930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52123775.6279; val_optim_loss: 52123775.6279
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9467; val_auprc_score: 0.9386; val_best_acc_score: 0.8808; val_best_f1_score: 0.8850; train_kl_reg_loss: 67046.5856; train_edge_recon_loss: 27025854.2402; train_gene_expr_recon_loss: 25063157.7493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52156058.6110; train_optim_loss: 52156058.6110; val_kl_reg_loss: 60231.5292; val_edge_recon_loss: 27773629.6279; val_gene_expr_recon_loss: 24144418.0465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51978278.8837; val_optim_loss: 51978278.8837
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9462; val_auprc_score: 0.9385; val_best_acc_score: 0.8801; val_best_f1_score: 0.8840; train_kl_reg_loss: 67033.8861; train_edge_recon_loss: 27012170.1253; train_gene_expr_recon_loss: 25034036.1462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52113240.1149; train_optim_loss: 52113240.1149; val_kl_reg_loss: 60246.2970; val_edge_recon_loss: 27808367.2093; val_gene_expr_recon_loss: 24181976.3721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52050589.7674; val_optim_loss: 52050589.7674
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9455; val_auprc_score: 0.9376; val_best_acc_score: 0.8789; val_best_f1_score: 0.8836; train_kl_reg_loss: 67080.8942; train_edge_recon_loss: 26996462.3603; train_gene_expr_recon_loss: 25086801.0548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52150344.2820; train_optim_loss: 52150344.2820; val_kl_reg_loss: 60271.1421; val_edge_recon_loss: 27869787.6744; val_gene_expr_recon_loss: 24162635.5349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52092693.7674; val_optim_loss: 52092693.7674
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9454; val_auprc_score: 0.9376; val_best_acc_score: 0.8783; val_best_f1_score: 0.8826; train_kl_reg_loss: 67035.6560; train_edge_recon_loss: 27036182.1305; train_gene_expr_recon_loss: 25062187.4151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52165405.3055; train_optim_loss: 52165405.3055; val_kl_reg_loss: 60311.9381; val_edge_recon_loss: 27867642.6512; val_gene_expr_recon_loss: 24318604.5116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52246558.9767; val_optim_loss: 52246558.9767
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9456; val_auprc_score: 0.9379; val_best_acc_score: 0.8788; val_best_f1_score: 0.8836; train_kl_reg_loss: 66997.3531; train_edge_recon_loss: 27005187.4099; train_gene_expr_recon_loss: 25064957.5718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52137142.3812; train_optim_loss: 52137142.3812; val_kl_reg_loss: 60247.6304; val_edge_recon_loss: 27795894.6047; val_gene_expr_recon_loss: 24139806.1395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51995948.8372; val_optim_loss: 51995948.8372

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9438; val_auprc_score: 0.9347; val_best_acc_score: 0.8777; val_best_f1_score: 0.8820; train_kl_reg_loss: 67028.7485; train_edge_recon_loss: 27029099.0914; train_gene_expr_recon_loss: 25142252.1410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52238379.8956; train_optim_loss: 52238379.8956; val_kl_reg_loss: 60251.2480; val_edge_recon_loss: 27889002.5581; val_gene_expr_recon_loss: 24164338.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52113591.8140; val_optim_loss: 52113591.8140
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9454; val_auprc_score: 0.9373; val_best_acc_score: 0.8787; val_best_f1_score: 0.8833; train_kl_reg_loss: 67045.2177; train_edge_recon_loss: 27011832.1097; train_gene_expr_recon_loss: 25050087.6554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52128964.9922; train_optim_loss: 52128964.9922; val_kl_reg_loss: 60249.9588; val_edge_recon_loss: 27849537.5349; val_gene_expr_recon_loss: 24161807.2558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52071594.7907; val_optim_loss: 52071594.7907
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9442; val_auprc_score: 0.9362; val_best_acc_score: 0.8767; val_best_f1_score: 0.8817; train_kl_reg_loss: 67046.6768; train_edge_recon_loss: 27023617.1384; train_gene_expr_recon_loss: 25072645.3316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52163309.1802; train_optim_loss: 52163309.1802; val_kl_reg_loss: 60371.4969; val_edge_recon_loss: 27911930.6047; val_gene_expr_recon_loss: 24123231.3488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52095532.9302; val_optim_loss: 52095532.9302
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9453; val_auprc_score: 0.9379; val_best_acc_score: 0.8771; val_best_f1_score: 0.8816; train_kl_reg_loss: 67024.4446; train_edge_recon_loss: 27018288.8825; train_gene_expr_recon_loss: 25005373.9112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52090687.1227; train_optim_loss: 52090687.1227; val_kl_reg_loss: 60291.0518; val_edge_recon_loss: 27866845.8605; val_gene_expr_recon_loss: 24195437.0233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52122574.2326; val_optim_loss: 52122574.2326

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 81 min 0 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9452
val AUPRC score: 0.9371
val best accuracy score: 0.8781
val best F1 score: 0.8828
val target rna MSE score: 17.4076
val source rna MSE score: 0.8070
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0761
Val cat covariate2 mean sim diff: nan

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
