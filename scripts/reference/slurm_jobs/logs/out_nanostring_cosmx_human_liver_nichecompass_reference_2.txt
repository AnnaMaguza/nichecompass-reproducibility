[True]
Run timestamp: 01092023_182428_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_liver', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '1000000.0', '--contrastive_logits_neg_ratio', '0.0625', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '100.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1000, n_cat_covariates_embed_input: 0, n_hidden: 1000, n_latent: 1496, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1496, n_addon_gp_input: 100, n_cat_covariates_embed_input: 2, n_output: 1000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1496, n_addon_gp_input: 100, n_cat_covariates_embed_input: 2, n_output: 1000

--- INITIALIZING TRAINER ---
Number of training nodes: 299589
Number of validation nodes: 33288
Number of training edges: 691436
Number of validation edges: 76826
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8953; val_auprc_score: 0.8805; val_best_acc_score: 0.8177; val_best_f1_score: 0.8285; train_kl_reg_loss: 49839.7857; train_edge_recon_loss: 2942484.1989; train_gene_expr_recon_loss: 2756950.5326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34940.8112; train_global_loss: 5784215.3327; train_optim_loss: 5784215.3327; val_kl_reg_loss: 35523.2096; val_edge_recon_loss: 2825576.2831; val_gene_expr_recon_loss: 2536723.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9794.3701; val_global_loss: 5407617.2616; val_optim_loss: 5407617.2616
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9181; val_auprc_score: 0.9040; val_best_acc_score: 0.8430; val_best_f1_score: 0.8526; train_kl_reg_loss: 25929.2322; train_edge_recon_loss: 2713662.1273; train_gene_expr_recon_loss: 2410038.8248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7718.8308; train_global_loss: 5157349.0130; train_optim_loss: 5157349.0130; val_kl_reg_loss: 22078.7964; val_edge_recon_loss: 2780363.7897; val_gene_expr_recon_loss: 2282901.4040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6167.7358; val_global_loss: 5091511.4669; val_optim_loss: 5091511.4669
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9348; val_auprc_score: 0.9224; val_best_acc_score: 0.8637; val_best_f1_score: 0.8700; train_kl_reg_loss: 20833.3996; train_edge_recon_loss: 2684091.9012; train_gene_expr_recon_loss: 2195865.9942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5998.2219; train_global_loss: 4906789.5303; train_optim_loss: 4906789.5303; val_kl_reg_loss: 20516.2492; val_edge_recon_loss: 2757718.1573; val_gene_expr_recon_loss: 2106233.4570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5814.5820; val_global_loss: 4890282.3709; val_optim_loss: 4890282.3709
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9389; val_auprc_score: 0.9265; val_best_acc_score: 0.8709; val_best_f1_score: 0.8767; train_kl_reg_loss: 20419.2709; train_edge_recon_loss: 2667510.5625; train_gene_expr_recon_loss: 2056837.6038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5772.7132; train_global_loss: 4750540.1517; train_optim_loss: 4750540.1517; val_kl_reg_loss: 21063.9714; val_edge_recon_loss: 2752945.3642; val_gene_expr_recon_loss: 2004256.4776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5730.3677; val_global_loss: 4783996.3278; val_optim_loss: 4783996.3278
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9430; val_auprc_score: 0.9310; val_best_acc_score: 0.8759; val_best_f1_score: 0.8810; train_kl_reg_loss: 21100.2906; train_edge_recon_loss: 2659451.5342; train_gene_expr_recon_loss: 1971340.6462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5689.3928; train_global_loss: 4657581.8649; train_optim_loss: 4657581.8649; val_kl_reg_loss: 21725.2125; val_edge_recon_loss: 2743199.1772; val_gene_expr_recon_loss: 1940117.0522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5691.6436; val_global_loss: 4710732.9238; val_optim_loss: 4710732.9238
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9442; val_auprc_score: 0.9312; val_best_acc_score: 0.8778; val_best_f1_score: 0.8831; train_kl_reg_loss: 21730.8786; train_edge_recon_loss: 2657214.8364; train_gene_expr_recon_loss: 1919436.6266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5744.1053; train_global_loss: 4604126.4567; train_optim_loss: 4604126.4567; val_kl_reg_loss: 22430.9205; val_edge_recon_loss: 2741279.0795; val_gene_expr_recon_loss: 1905544.1391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5773.0410; val_global_loss: 4675027.1556; val_optim_loss: 4675027.1556
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9469; val_auprc_score: 0.9361; val_best_acc_score: 0.8804; val_best_f1_score: 0.8856; train_kl_reg_loss: 22152.5405; train_edge_recon_loss: 2652980.9006; train_gene_expr_recon_loss: 1886689.1910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5795.1910; train_global_loss: 4567617.8305; train_optim_loss: 4567617.8305; val_kl_reg_loss: 22149.1139; val_edge_recon_loss: 2737244.0546; val_gene_expr_recon_loss: 1887736.6267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5864.8018; val_global_loss: 4652994.8079; val_optim_loss: 4652994.8079
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9475; val_auprc_score: 0.9355; val_best_acc_score: 0.8829; val_best_f1_score: 0.8882; train_kl_reg_loss: 22462.9277; train_edge_recon_loss: 2652157.6040; train_gene_expr_recon_loss: 1864617.3896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5849.7305; train_global_loss: 4545087.6491; train_optim_loss: 4545087.6491; val_kl_reg_loss: 22915.0832; val_edge_recon_loss: 2741060.5646; val_gene_expr_recon_loss: 1857770.3386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5911.5776; val_global_loss: 4627657.4834; val_optim_loss: 4627657.4834
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9488; val_auprc_score: 0.9373; val_best_acc_score: 0.8839; val_best_f1_score: 0.8895; train_kl_reg_loss: 22588.9365; train_edge_recon_loss: 2651253.7755; train_gene_expr_recon_loss: 1849045.1341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5996.8438; train_global_loss: 4528884.6858; train_optim_loss: 4528884.6858; val_kl_reg_loss: 22900.4883; val_edge_recon_loss: 2737989.5116; val_gene_expr_recon_loss: 1850033.3916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6046.5605; val_global_loss: 4616969.8940; val_optim_loss: 4616969.8940
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9483; val_auprc_score: 0.9365; val_best_acc_score: 0.8836; val_best_f1_score: 0.8888; train_kl_reg_loss: 22691.4698; train_edge_recon_loss: 2648638.3723; train_gene_expr_recon_loss: 1837036.8325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6108.8922; train_global_loss: 4514475.5655; train_optim_loss: 4514475.5655; val_kl_reg_loss: 22987.3820; val_edge_recon_loss: 2735344.8162; val_gene_expr_recon_loss: 1839055.0108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6122.8989; val_global_loss: 4603510.2285; val_optim_loss: 4603510.2285
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9500; val_auprc_score: 0.9388; val_best_acc_score: 0.8866; val_best_f1_score: 0.8914; train_kl_reg_loss: 23022.2080; train_edge_recon_loss: 2647886.7548; train_gene_expr_recon_loss: 1827799.0115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6180.4793; train_global_loss: 4504888.4582; train_optim_loss: 4504888.4582; val_kl_reg_loss: 23178.7550; val_edge_recon_loss: 2729262.2715; val_gene_expr_recon_loss: 1842923.3634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6187.9697; val_global_loss: 4601552.4040; val_optim_loss: 4601552.4040
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9508; val_auprc_score: 0.9403; val_best_acc_score: 0.8867; val_best_f1_score: 0.8912; train_kl_reg_loss: 22927.2124; train_edge_recon_loss: 2646632.9752; train_gene_expr_recon_loss: 1822288.2916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6234.5040; train_global_loss: 4498082.9741; train_optim_loss: 4498082.9741; val_kl_reg_loss: 23339.0238; val_edge_recon_loss: 2734046.2914; val_gene_expr_recon_loss: 1828001.6043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6193.6743; val_global_loss: 4591580.4404; val_optim_loss: 4591580.4404
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9529; val_auprc_score: 0.9414; val_best_acc_score: 0.8912; val_best_f1_score: 0.8956; train_kl_reg_loss: 22879.1823; train_edge_recon_loss: 2645524.5786; train_gene_expr_recon_loss: 1814292.3236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6266.3194; train_global_loss: 4488962.4093; train_optim_loss: 4488962.4093; val_kl_reg_loss: 22872.5380; val_edge_recon_loss: 2728638.3146; val_gene_expr_recon_loss: 1817554.3353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6253.9746; val_global_loss: 4575319.1821; val_optim_loss: 4575319.1821
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9528; val_auprc_score: 0.9420; val_best_acc_score: 0.8909; val_best_f1_score: 0.8949; train_kl_reg_loss: 22982.0538; train_edge_recon_loss: 2644380.7420; train_gene_expr_recon_loss: 1810675.6998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6319.1745; train_global_loss: 4484357.6765; train_optim_loss: 4484357.6765; val_kl_reg_loss: 22728.5794; val_edge_recon_loss: 2733372.9454; val_gene_expr_recon_loss: 1816544.7368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6320.9199; val_global_loss: 4578967.2483; val_optim_loss: 4578967.2483
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9528; val_auprc_score: 0.9421; val_best_acc_score: 0.8899; val_best_f1_score: 0.8943; train_kl_reg_loss: 23064.2230; train_edge_recon_loss: 2642586.7209; train_gene_expr_recon_loss: 1804376.8619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6397.0738; train_global_loss: 4476424.8753; train_optim_loss: 4476424.8753; val_kl_reg_loss: 23302.0140; val_edge_recon_loss: 2730575.8096; val_gene_expr_recon_loss: 1807586.3046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6405.9893; val_global_loss: 4567870.1192; val_optim_loss: 4567870.1192
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9528; val_auprc_score: 0.9417; val_best_acc_score: 0.8909; val_best_f1_score: 0.8951; train_kl_reg_loss: 23223.8193; train_edge_recon_loss: 2643676.4891; train_gene_expr_recon_loss: 1800566.0418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6442.7935; train_global_loss: 4473909.1410; train_optim_loss: 4473909.1410; val_kl_reg_loss: 23157.5140; val_edge_recon_loss: 2732919.2252; val_gene_expr_recon_loss: 1807656.3228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6464.7729; val_global_loss: 4570198.0430; val_optim_loss: 4570198.0430
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9541; val_auprc_score: 0.9429; val_best_acc_score: 0.8921; val_best_f1_score: 0.8967; train_kl_reg_loss: 23183.1169; train_edge_recon_loss: 2642479.4497; train_gene_expr_recon_loss: 1795476.4737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6533.8490; train_global_loss: 4467672.8982; train_optim_loss: 4467672.8982; val_kl_reg_loss: 23897.8192; val_edge_recon_loss: 2723429.6407; val_gene_expr_recon_loss: 1799397.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6576.4346; val_global_loss: 4553301.8907; val_optim_loss: 4553301.8907
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9555; val_auprc_score: 0.9447; val_best_acc_score: 0.8947; val_best_f1_score: 0.8989; train_kl_reg_loss: 23385.0427; train_edge_recon_loss: 2642134.2631; train_gene_expr_recon_loss: 1792736.7254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6587.6011; train_global_loss: 4464843.6429; train_optim_loss: 4464843.6429; val_kl_reg_loss: 23395.5914; val_edge_recon_loss: 2726737.8626; val_gene_expr_recon_loss: 1799379.8618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6626.9409; val_global_loss: 4556140.3576; val_optim_loss: 4556140.3576
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9550; val_auprc_score: 0.9444; val_best_acc_score: 0.8936; val_best_f1_score: 0.8979; train_kl_reg_loss: 23453.0913; train_edge_recon_loss: 2641991.0740; train_gene_expr_recon_loss: 1788341.4186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6640.9634; train_global_loss: 4460426.5411; train_optim_loss: 4460426.5411; val_kl_reg_loss: 24004.4034; val_edge_recon_loss: 2725572.9752; val_gene_expr_recon_loss: 1799542.6026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6653.4409; val_global_loss: 4555773.4636; val_optim_loss: 4555773.4636
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9563; val_auprc_score: 0.9461; val_best_acc_score: 0.8957; val_best_f1_score: 0.8997; train_kl_reg_loss: 23467.5177; train_edge_recon_loss: 2639817.5574; train_gene_expr_recon_loss: 1783108.5597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6748.6122; train_global_loss: 4453142.2383; train_optim_loss: 4453142.2383; val_kl_reg_loss: 23925.7418; val_edge_recon_loss: 2722341.9387; val_gene_expr_recon_loss: 1798577.6556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6789.3105; val_global_loss: 4551634.8146; val_optim_loss: 4551634.8146
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9574; val_auprc_score: 0.9476; val_best_acc_score: 0.8971; val_best_f1_score: 0.9010; train_kl_reg_loss: 23520.0076; train_edge_recon_loss: 2639385.7102; train_gene_expr_recon_loss: 1780884.6155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6832.6888; train_global_loss: 4450623.0118; train_optim_loss: 4450623.0118; val_kl_reg_loss: 23905.1689; val_edge_recon_loss: 2720697.0248; val_gene_expr_recon_loss: 1786924.8104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6795.3018; val_global_loss: 4538322.5199; val_optim_loss: 4538322.5199
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9574; val_auprc_score: 0.9468; val_best_acc_score: 0.8977; val_best_f1_score: 0.9015; train_kl_reg_loss: 23652.7834; train_edge_recon_loss: 2639121.7230; train_gene_expr_recon_loss: 1779497.9113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6894.0153; train_global_loss: 4449166.4323; train_optim_loss: 4449166.4323; val_kl_reg_loss: 24018.5205; val_edge_recon_loss: 2723015.2997; val_gene_expr_recon_loss: 1787198.2119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6937.4785; val_global_loss: 4541169.5530; val_optim_loss: 4541169.5530
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9552; val_auprc_score: 0.9446; val_best_acc_score: 0.8932; val_best_f1_score: 0.8973; train_kl_reg_loss: 23891.0282; train_edge_recon_loss: 2640115.7876; train_gene_expr_recon_loss: 1788274.5324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7000.8956; train_global_loss: 4459282.2598; train_optim_loss: 4459282.2598; val_kl_reg_loss: 24768.9181; val_edge_recon_loss: 2726658.3642; val_gene_expr_recon_loss: 1793949.1192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7020.5581; val_global_loss: 4552396.9040; val_optim_loss: 4552396.9040
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9581; val_auprc_score: 0.9479; val_best_acc_score: 0.8983; val_best_f1_score: 0.9023; train_kl_reg_loss: 24158.2140; train_edge_recon_loss: 2638776.8997; train_gene_expr_recon_loss: 1775986.1505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6968.7607; train_global_loss: 4445890.0296; train_optim_loss: 4445890.0296; val_kl_reg_loss: 24364.3249; val_edge_recon_loss: 2723768.6821; val_gene_expr_recon_loss: 1782709.3228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6949.2729; val_global_loss: 4537791.8212; val_optim_loss: 4537791.8212
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9549; val_auprc_score: 0.9444; val_best_acc_score: 0.8922; val_best_f1_score: 0.8967; train_kl_reg_loss: 24162.8568; train_edge_recon_loss: 2640959.2798; train_gene_expr_recon_loss: 1778179.0812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7002.3268; train_global_loss: 4450303.5426; train_optim_loss: 4450303.5426; val_kl_reg_loss: 33498.8268; val_edge_recon_loss: 2755826.5596; val_gene_expr_recon_loss: 1877256.1217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8005.1367; val_global_loss: 4674586.5132; val_optim_loss: 4674586.5132
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9596; val_auprc_score: 0.9500; val_best_acc_score: 0.9000; val_best_f1_score: 0.9039; train_kl_reg_loss: 24635.8010; train_edge_recon_loss: 2637133.3192; train_gene_expr_recon_loss: 1772077.1300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7024.4987; train_global_loss: 4440870.7494; train_optim_loss: 4440870.7494; val_kl_reg_loss: 24236.1655; val_edge_recon_loss: 2721477.3444; val_gene_expr_recon_loss: 1777878.9810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7022.5747; val_global_loss: 4530614.9768; val_optim_loss: 4530614.9768
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9587; val_auprc_score: 0.9488; val_best_acc_score: 0.8990; val_best_f1_score: 0.9029; train_kl_reg_loss: 24218.0869; train_edge_recon_loss: 2637026.0357; train_gene_expr_recon_loss: 1769287.5439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7023.5617; train_global_loss: 4437555.2332; train_optim_loss: 4437555.2332; val_kl_reg_loss: 24271.2017; val_edge_recon_loss: 2720771.0762; val_gene_expr_recon_loss: 1779827.3493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6983.2598; val_global_loss: 4531853.1126; val_optim_loss: 4531853.1126
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9589; val_auprc_score: 0.9490; val_best_acc_score: 0.8993; val_best_f1_score: 0.9031; train_kl_reg_loss: 24208.4713; train_edge_recon_loss: 2637749.8790; train_gene_expr_recon_loss: 1766349.3311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7047.4481; train_global_loss: 4435355.1436; train_optim_loss: 4435355.1436; val_kl_reg_loss: 24469.9929; val_edge_recon_loss: 2723333.3560; val_gene_expr_recon_loss: 1784635.6002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7112.4346; val_global_loss: 4539551.4437; val_optim_loss: 4539551.4437
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7362; val_auprc_score: 0.7509; val_best_acc_score: 0.6690; val_best_f1_score: 0.6977; train_kl_reg_loss: 26841.3980; train_edge_recon_loss: 2696184.7232; train_gene_expr_recon_loss: 2346943.3965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10280.8471; train_global_loss: 5080250.3486; train_optim_loss: 5080250.3486; val_kl_reg_loss: 5178.2814; val_edge_recon_loss: 3242468.1970; val_gene_expr_recon_loss: 2843362.8692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36810.5234; val_global_loss: 6127819.8642; val_optim_loss: 6127819.8642
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9265; val_auprc_score: 0.9105; val_best_acc_score: 0.8561; val_best_f1_score: 0.8631; train_kl_reg_loss: 14039.4015; train_edge_recon_loss: 2696414.8040; train_gene_expr_recon_loss: 2442457.0716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11372.4099; train_global_loss: 5164283.6836; train_optim_loss: 5164283.6836; val_kl_reg_loss: 14860.0479; val_edge_recon_loss: 2755037.2500; val_gene_expr_recon_loss: 2372410.9040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7731.6675; val_global_loss: 5150039.6921; val_optim_loss: 5150039.6921

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9285; val_auprc_score: 0.9126; val_best_acc_score: 0.8581; val_best_f1_score: 0.8657; train_kl_reg_loss: 14994.3489; train_edge_recon_loss: 2655966.9865; train_gene_expr_recon_loss: 2369412.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6345.2789; train_global_loss: 5046719.5607; train_optim_loss: 5046719.5607; val_kl_reg_loss: 15093.4339; val_edge_recon_loss: 2751457.8940; val_gene_expr_recon_loss: 2359424.9586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6153.2715; val_global_loss: 5132129.8013; val_optim_loss: 5132129.8013
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9324; val_auprc_score: 0.9178; val_best_acc_score: 0.8624; val_best_f1_score: 0.8691; train_kl_reg_loss: 15218.9747; train_edge_recon_loss: 2653535.5231; train_gene_expr_recon_loss: 2350836.5031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5918.6736; train_global_loss: 5025509.6828; train_optim_loss: 5025509.6828; val_kl_reg_loss: 15454.1916; val_edge_recon_loss: 2744331.4503; val_gene_expr_recon_loss: 2334509.6755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5695.1831; val_global_loss: 5099990.3344; val_optim_loss: 5099990.3344
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9329; val_auprc_score: 0.9181; val_best_acc_score: 0.8631; val_best_f1_score: 0.8697; train_kl_reg_loss: 15670.9808; train_edge_recon_loss: 2653982.7644; train_gene_expr_recon_loss: 2319232.8653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5484.7765; train_global_loss: 4994371.3871; train_optim_loss: 4994371.3871; val_kl_reg_loss: 16150.7307; val_edge_recon_loss: 2749981.0066; val_gene_expr_recon_loss: 2286573.1474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5304.0908; val_global_loss: 5058008.8974; val_optim_loss: 5058008.8974
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9373; val_auprc_score: 0.9234; val_best_acc_score: 0.8684; val_best_f1_score: 0.8749; train_kl_reg_loss: 16499.2556; train_edge_recon_loss: 2654215.0068; train_gene_expr_recon_loss: 2242589.0698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5242.1044; train_global_loss: 4918545.4423; train_optim_loss: 4918545.4423; val_kl_reg_loss: 17084.8123; val_edge_recon_loss: 2748856.3974; val_gene_expr_recon_loss: 2178627.9048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5216.9419; val_global_loss: 4949786.1126; val_optim_loss: 4949786.1126

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 297 min 43 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.9599
val AUPRC score: 0.9503
val best accuracy score: 0.9011
val best F1 score: 0.9050
val target rna MSE score: 0.6456
val source rna MSE score: 0.0818
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
