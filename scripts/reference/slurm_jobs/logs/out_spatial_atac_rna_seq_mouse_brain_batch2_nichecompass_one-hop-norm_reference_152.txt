[True]
Run timestamp: 10102023_050815_152.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_152']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6566; val_auprc_score: 0.6431; val_best_acc_score: 0.5153; val_best_f1_score: 0.6731; train_kl_reg_loss: 41156.9542; train_edge_recon_loss: 733413.7339; train_gene_expr_recon_loss: 23418545.5758; train_masked_gp_l1_reg_loss: 106974.1909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3344582.8864; train_chrom_access_recon_loss: 2326733.1155; train_global_loss: 29971406.6364; train_optim_loss: 29971406.6364; val_kl_reg_loss: 61558.4639; val_edge_recon_loss: 812897.3438; val_gene_expr_recon_loss: 21667145.5000; val_masked_gp_l1_reg_loss: 85962.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2301766.7500; val_chrom_access_recon_loss: 2176244.7500; val_global_loss: 27105574.5000; val_optim_loss: 27105574.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6982; val_auprc_score: 0.6838; val_best_acc_score: 0.5701; val_best_f1_score: 0.6894; train_kl_reg_loss: 79136.2646; train_edge_recon_loss: 741472.4867; train_gene_expr_recon_loss: 21282153.2121; train_masked_gp_l1_reg_loss: 80179.2507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1530957.5994; train_chrom_access_recon_loss: 2204823.2500; train_global_loss: 25918721.8485; train_optim_loss: 25918721.8485; val_kl_reg_loss: 73193.1377; val_edge_recon_loss: 812144.4453; val_gene_expr_recon_loss: 20958812.5000; val_masked_gp_l1_reg_loss: 76665.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 936232.3125; val_chrom_access_recon_loss: 2131970.6250; val_global_loss: 24989018.5000; val_optim_loss: 24989018.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7859; val_auprc_score: 0.7801; val_best_acc_score: 0.6924; val_best_f1_score: 0.7367; train_kl_reg_loss: 74335.4580; train_edge_recon_loss: 733608.9886; train_gene_expr_recon_loss: 21029258.0606; train_masked_gp_l1_reg_loss: 76458.6424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 650330.7197; train_chrom_access_recon_loss: 2187733.7765; train_global_loss: 24751725.4848; train_optim_loss: 24751725.4848; val_kl_reg_loss: 72336.2627; val_edge_recon_loss: 808840.2422; val_gene_expr_recon_loss: 21036279.2500; val_masked_gp_l1_reg_loss: 76670.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 442581.7500; val_chrom_access_recon_loss: 2147956.4844; val_global_loss: 24584664.5000; val_optim_loss: 24584664.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8420; val_auprc_score: 0.8206; val_best_acc_score: 0.7260; val_best_f1_score: 0.7695; train_kl_reg_loss: 67621.4812; train_edge_recon_loss: 727925.5587; train_gene_expr_recon_loss: 20891250.6061; train_masked_gp_l1_reg_loss: 77647.9917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 341811.2760; train_chrom_access_recon_loss: 2176231.7614; train_global_loss: 24282488.6970; train_optim_loss: 24282488.6970; val_kl_reg_loss: 63211.3760; val_edge_recon_loss: 793576.2266; val_gene_expr_recon_loss: 20889510.0000; val_masked_gp_l1_reg_loss: 79168.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 267894.6562; val_chrom_access_recon_loss: 2139055.3750; val_global_loss: 24232415.0000; val_optim_loss: 24232415.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8698; val_auprc_score: 0.8356; val_best_acc_score: 0.7920; val_best_f1_score: 0.8106; train_kl_reg_loss: 62404.5836; train_edge_recon_loss: 713698.6278; train_gene_expr_recon_loss: 20733538.3636; train_masked_gp_l1_reg_loss: 80548.1004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 228781.1709; train_chrom_access_recon_loss: 2163106.4261; train_global_loss: 23982077.1515; train_optim_loss: 23982077.1515; val_kl_reg_loss: 61496.1201; val_edge_recon_loss: 727088.0859; val_gene_expr_recon_loss: 20770474.7500; val_masked_gp_l1_reg_loss: 82234.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 197116.2969; val_chrom_access_recon_loss: 2129208.6562; val_global_loss: 23967617.5000; val_optim_loss: 23967617.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8775; val_auprc_score: 0.8449; val_best_acc_score: 0.7998; val_best_f1_score: 0.8158; train_kl_reg_loss: 65819.9746; train_edge_recon_loss: 667527.2159; train_gene_expr_recon_loss: 20575783.4242; train_masked_gp_l1_reg_loss: 83177.8339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175497.2491; train_chrom_access_recon_loss: 2148242.4375; train_global_loss: 23716047.9697; train_optim_loss: 23716047.9697; val_kl_reg_loss: 67533.4912; val_edge_recon_loss: 652553.0156; val_gene_expr_recon_loss: 20467136.7500; val_masked_gp_l1_reg_loss: 83993.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156684.9062; val_chrom_access_recon_loss: 2092517.1719; val_global_loss: 23520418.0000; val_optim_loss: 23520418.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8889; val_auprc_score: 0.8563; val_best_acc_score: 0.8173; val_best_f1_score: 0.8314; train_kl_reg_loss: 72223.1205; train_edge_recon_loss: 636824.8059; train_gene_expr_recon_loss: 20493524.8788; train_masked_gp_l1_reg_loss: 84801.9426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143284.0393; train_chrom_access_recon_loss: 2143121.5568; train_global_loss: 23573780.6970; train_optim_loss: 23573780.6970; val_kl_reg_loss: 71512.2070; val_edge_recon_loss: 633476.5391; val_gene_expr_recon_loss: 20437849.7500; val_masked_gp_l1_reg_loss: 85880.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132293.2500; val_chrom_access_recon_loss: 2100804.7969; val_global_loss: 23461817.2500; val_optim_loss: 23461817.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8958; val_auprc_score: 0.8623; val_best_acc_score: 0.8251; val_best_f1_score: 0.8386; train_kl_reg_loss: 72786.9229; train_edge_recon_loss: 625427.9848; train_gene_expr_recon_loss: 20389473.4242; train_masked_gp_l1_reg_loss: 86703.0371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123880.5671; train_chrom_access_recon_loss: 2132839.7955; train_global_loss: 23431111.4848; train_optim_loss: 23431111.4848; val_kl_reg_loss: 68731.6816; val_edge_recon_loss: 625312.0938; val_gene_expr_recon_loss: 20206371.2500; val_masked_gp_l1_reg_loss: 87778.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117452.9688; val_chrom_access_recon_loss: 2087909.4219; val_global_loss: 23193553.7500; val_optim_loss: 23193553.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9085; val_auprc_score: 0.8818; val_best_acc_score: 0.8407; val_best_f1_score: 0.8521; train_kl_reg_loss: 72189.4905; train_edge_recon_loss: 616445.7377; train_gene_expr_recon_loss: 20268462.9091; train_masked_gp_l1_reg_loss: 88311.1165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111692.2763; train_chrom_access_recon_loss: 2121712.8693; train_global_loss: 23278814.2727; train_optim_loss: 23278814.2727; val_kl_reg_loss: 72457.5693; val_edge_recon_loss: 612380.7656; val_gene_expr_recon_loss: 20224010.0000; val_masked_gp_l1_reg_loss: 89168.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106997.5703; val_chrom_access_recon_loss: 2085302.5312; val_global_loss: 23190317.0000; val_optim_loss: 23190317.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9219; val_auprc_score: 0.9018; val_best_acc_score: 0.8466; val_best_f1_score: 0.8573; train_kl_reg_loss: 71148.6507; train_edge_recon_loss: 610494.5312; train_gene_expr_recon_loss: 20196233.4848; train_masked_gp_l1_reg_loss: 89640.1692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102759.4059; train_chrom_access_recon_loss: 2116277.3371; train_global_loss: 23186553.3939; train_optim_loss: 23186553.3939; val_kl_reg_loss: 71793.3418; val_edge_recon_loss: 609472.8281; val_gene_expr_recon_loss: 20053856.0000; val_masked_gp_l1_reg_loss: 90303.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99344.1172; val_chrom_access_recon_loss: 2075026.6250; val_global_loss: 22999796.7500; val_optim_loss: 22999796.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9177; val_auprc_score: 0.8958; val_best_acc_score: 0.8520; val_best_f1_score: 0.8624; train_kl_reg_loss: 70504.0663; train_edge_recon_loss: 605647.6449; train_gene_expr_recon_loss: 20122190.6667; train_masked_gp_l1_reg_loss: 90674.0162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95971.8919; train_chrom_access_recon_loss: 2109735.8295; train_global_loss: 23094724.1212; train_optim_loss: 23094724.1212; val_kl_reg_loss: 70170.5654; val_edge_recon_loss: 610288.8750; val_gene_expr_recon_loss: 19971925.2500; val_masked_gp_l1_reg_loss: 91144.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92794.3438; val_chrom_access_recon_loss: 2067341.5781; val_global_loss: 22903664.7500; val_optim_loss: 22903664.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9235; val_auprc_score: 0.9016; val_best_acc_score: 0.8571; val_best_f1_score: 0.8652; train_kl_reg_loss: 69428.0057; train_edge_recon_loss: 603945.6345; train_gene_expr_recon_loss: 20043185.9394; train_masked_gp_l1_reg_loss: 91595.7036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90394.0355; train_chrom_access_recon_loss: 2101518.5303; train_global_loss: 23000067.9394; train_optim_loss: 23000067.9394; val_kl_reg_loss: 66973.6172; val_edge_recon_loss: 605164.6094; val_gene_expr_recon_loss: 19924557.5000; val_masked_gp_l1_reg_loss: 92066.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88240.6875; val_chrom_access_recon_loss: 2050286.7500; val_global_loss: 22827288.7500; val_optim_loss: 22827288.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9278; val_auprc_score: 0.9015; val_best_acc_score: 0.8689; val_best_f1_score: 0.8751; train_kl_reg_loss: 68505.4345; train_edge_recon_loss: 599042.8816; train_gene_expr_recon_loss: 19978662.4848; train_masked_gp_l1_reg_loss: 92442.7367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86461.4496; train_chrom_access_recon_loss: 2094595.5852; train_global_loss: 22919710.5455; train_optim_loss: 22919710.5455; val_kl_reg_loss: 68806.6211; val_edge_recon_loss: 599503.7969; val_gene_expr_recon_loss: 19926496.5000; val_masked_gp_l1_reg_loss: 93136.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84824.6953; val_chrom_access_recon_loss: 2059622.8438; val_global_loss: 22832389.5000; val_optim_loss: 22832389.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9288; val_auprc_score: 0.9095; val_best_acc_score: 0.8635; val_best_f1_score: 0.8709; train_kl_reg_loss: 67773.6755; train_edge_recon_loss: 597343.9422; train_gene_expr_recon_loss: 19919240.6667; train_masked_gp_l1_reg_loss: 93310.3764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83382.8698; train_chrom_access_recon_loss: 2089339.4773; train_global_loss: 22850390.8182; train_optim_loss: 22850390.8182; val_kl_reg_loss: 66831.7612; val_edge_recon_loss: 606059.3672; val_gene_expr_recon_loss: 19849911.0000; val_masked_gp_l1_reg_loss: 93898.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83023.8438; val_chrom_access_recon_loss: 2028545.3594; val_global_loss: 22728269.2500; val_optim_loss: 22728269.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9376; val_auprc_score: 0.9190; val_best_acc_score: 0.8804; val_best_f1_score: 0.8841; train_kl_reg_loss: 66933.1979; train_edge_recon_loss: 594705.8428; train_gene_expr_recon_loss: 19845228.7576; train_masked_gp_l1_reg_loss: 94292.0994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81418.2598; train_chrom_access_recon_loss: 2081313.1307; train_global_loss: 22763891.5152; train_optim_loss: 22763891.5152; val_kl_reg_loss: 66894.6650; val_edge_recon_loss: 593697.5156; val_gene_expr_recon_loss: 19804514.7500; val_masked_gp_l1_reg_loss: 94755.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80665.3047; val_chrom_access_recon_loss: 2039621.8750; val_global_loss: 22680151.0000; val_optim_loss: 22680151.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9334; val_auprc_score: 0.9092; val_best_acc_score: 0.8740; val_best_f1_score: 0.8784; train_kl_reg_loss: 66411.6906; train_edge_recon_loss: 592407.6373; train_gene_expr_recon_loss: 19804340.3333; train_masked_gp_l1_reg_loss: 94832.4957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79696.2933; train_chrom_access_recon_loss: 2077161.3352; train_global_loss: 22714850.0000; train_optim_loss: 22714850.0000; val_kl_reg_loss: 65558.5137; val_edge_recon_loss: 597732.3438; val_gene_expr_recon_loss: 19813298.0000; val_masked_gp_l1_reg_loss: 95092.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79223.8047; val_chrom_access_recon_loss: 2048426.8906; val_global_loss: 22699331.7500; val_optim_loss: 22699331.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9389; val_auprc_score: 0.9212; val_best_acc_score: 0.8775; val_best_f1_score: 0.8817; train_kl_reg_loss: 65942.4471; train_edge_recon_loss: 590898.6117; train_gene_expr_recon_loss: 19737876.0909; train_masked_gp_l1_reg_loss: 95531.6533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78249.8406; train_chrom_access_recon_loss: 2071872.4583; train_global_loss: 22640371.0606; train_optim_loss: 22640371.0606; val_kl_reg_loss: 64708.8584; val_edge_recon_loss: 597111.0938; val_gene_expr_recon_loss: 19758097.2500; val_masked_gp_l1_reg_loss: 95784.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77141.9375; val_chrom_access_recon_loss: 2039817.9531; val_global_loss: 22632661.2500; val_optim_loss: 22632661.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9424; val_auprc_score: 0.9203; val_best_acc_score: 0.8842; val_best_f1_score: 0.8882; train_kl_reg_loss: 64898.5695; train_edge_recon_loss: 592183.2926; train_gene_expr_recon_loss: 19686339.4848; train_masked_gp_l1_reg_loss: 96146.6164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76710.0843; train_chrom_access_recon_loss: 2065990.1098; train_global_loss: 22582268.3636; train_optim_loss: 22582268.3636; val_kl_reg_loss: 64080.3276; val_edge_recon_loss: 591790.1016; val_gene_expr_recon_loss: 19449551.2500; val_masked_gp_l1_reg_loss: 96763.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76766.2812; val_chrom_access_recon_loss: 2032439.3750; val_global_loss: 22311391.0000; val_optim_loss: 22311391.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9389; val_auprc_score: 0.9191; val_best_acc_score: 0.8745; val_best_f1_score: 0.8810; train_kl_reg_loss: 64315.7944; train_edge_recon_loss: 589816.3390; train_gene_expr_recon_loss: 19658544.3939; train_masked_gp_l1_reg_loss: 97140.1064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75896.9128; train_chrom_access_recon_loss: 2063223.2083; train_global_loss: 22548936.7273; train_optim_loss: 22548936.7273; val_kl_reg_loss: 63327.4438; val_edge_recon_loss: 596934.5469; val_gene_expr_recon_loss: 19746999.5000; val_masked_gp_l1_reg_loss: 97545.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75716.5078; val_chrom_access_recon_loss: 2047055.2969; val_global_loss: 22627578.7500; val_optim_loss: 22627578.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9445; val_auprc_score: 0.9318; val_best_acc_score: 0.8869; val_best_f1_score: 0.8910; train_kl_reg_loss: 63904.5971; train_edge_recon_loss: 589842.3665; train_gene_expr_recon_loss: 19591734.9697; train_masked_gp_l1_reg_loss: 97769.4589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75072.8099; train_chrom_access_recon_loss: 2056291.1345; train_global_loss: 22474615.3333; train_optim_loss: 22474615.3333; val_kl_reg_loss: 63633.8569; val_edge_recon_loss: 595559.3125; val_gene_expr_recon_loss: 19656098.7500; val_masked_gp_l1_reg_loss: 98368.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74723.6953; val_chrom_access_recon_loss: 2019303.2969; val_global_loss: 22507687.0000; val_optim_loss: 22507687.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9489; val_auprc_score: 0.9304; val_best_acc_score: 0.8936; val_best_f1_score: 0.8977; train_kl_reg_loss: 63262.3271; train_edge_recon_loss: 587096.0871; train_gene_expr_recon_loss: 19528666.3333; train_masked_gp_l1_reg_loss: 98629.8532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74210.1819; train_chrom_access_recon_loss: 2051054.4432; train_global_loss: 22402918.9394; train_optim_loss: 22402918.9394; val_kl_reg_loss: 65068.3218; val_edge_recon_loss: 589948.6484; val_gene_expr_recon_loss: 19542205.7500; val_masked_gp_l1_reg_loss: 99154.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74480.4531; val_chrom_access_recon_loss: 2005987.8438; val_global_loss: 22376844.2500; val_optim_loss: 22376844.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9455; val_auprc_score: 0.9323; val_best_acc_score: 0.8845; val_best_f1_score: 0.8900; train_kl_reg_loss: 62874.4838; train_edge_recon_loss: 587317.2784; train_gene_expr_recon_loss: 19476167.9394; train_masked_gp_l1_reg_loss: 99446.3738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74049.4510; train_chrom_access_recon_loss: 2046420.4981; train_global_loss: 22346276.1818; train_optim_loss: 22346276.1818; val_kl_reg_loss: 61543.8423; val_edge_recon_loss: 590385.3594; val_gene_expr_recon_loss: 19593847.2500; val_masked_gp_l1_reg_loss: 99941.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73978.0312; val_chrom_access_recon_loss: 2030773.0469; val_global_loss: 22450469.5000; val_optim_loss: 22450469.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9480; val_auprc_score: 0.9253; val_best_acc_score: 0.8947; val_best_f1_score: 0.8987; train_kl_reg_loss: 62493.0851; train_edge_recon_loss: 585281.5795; train_gene_expr_recon_loss: 19438566.1515; train_masked_gp_l1_reg_loss: 96713.5360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60094.2067; train_chrom_access_recon_loss: 2038613.9280; train_global_loss: 22281762.4242; train_optim_loss: 22281762.4242; val_kl_reg_loss: 64019.8354; val_edge_recon_loss: 584905.5312; val_gene_expr_recon_loss: 19548356.5000; val_masked_gp_l1_reg_loss: 95311.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55552.9375; val_chrom_access_recon_loss: 2000468.1094; val_global_loss: 22348614.2500; val_optim_loss: 22348614.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9411; val_auprc_score: 0.9175; val_best_acc_score: 0.8858; val_best_f1_score: 0.8906; train_kl_reg_loss: 63274.2429; train_edge_recon_loss: 585944.9460; train_gene_expr_recon_loss: 19439760.6667; train_masked_gp_l1_reg_loss: 95073.1896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54863.3737; train_chrom_access_recon_loss: 2040282.8466; train_global_loss: 22279199.3030; train_optim_loss: 22279199.3030; val_kl_reg_loss: 64341.0679; val_edge_recon_loss: 594177.0547; val_gene_expr_recon_loss: 19561255.5000; val_masked_gp_l1_reg_loss: 94932.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54346.7461; val_chrom_access_recon_loss: 2003752.5469; val_global_loss: 22372804.5000; val_optim_loss: 22372804.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9451; val_auprc_score: 0.9220; val_best_acc_score: 0.8936; val_best_f1_score: 0.8970; train_kl_reg_loss: 63559.9922; train_edge_recon_loss: 583685.5256; train_gene_expr_recon_loss: 19428021.1818; train_masked_gp_l1_reg_loss: 94884.4876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54034.2693; train_chrom_access_recon_loss: 2038388.1686; train_global_loss: 22262573.3636; train_optim_loss: 22262573.3636; val_kl_reg_loss: 64072.3887; val_edge_recon_loss: 587414.4219; val_gene_expr_recon_loss: 19356903.2500; val_masked_gp_l1_reg_loss: 94876.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53737.4180; val_chrom_access_recon_loss: 1996047.3438; val_global_loss: 22153051.2500; val_optim_loss: 22153051.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9394; val_auprc_score: 0.9177; val_best_acc_score: 0.8799; val_best_f1_score: 0.8834; train_kl_reg_loss: 64284.0964; train_edge_recon_loss: 708002.9366; train_gene_expr_recon_loss: 18101407.3939; train_masked_gp_l1_reg_loss: 94619.2711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52550.0584; train_chrom_access_recon_loss: 1965359.5644; train_global_loss: 20986223.6364; train_optim_loss: 20986223.6364; val_kl_reg_loss: 26299.7275; val_edge_recon_loss: 714077.7578; val_gene_expr_recon_loss: 18032089.2500; val_masked_gp_l1_reg_loss: 94490.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52289.2812; val_chrom_access_recon_loss: 1889158.3281; val_global_loss: 20808405.0000; val_optim_loss: 20808405.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9437; val_auprc_score: 0.9246; val_best_acc_score: 0.8829; val_best_f1_score: 0.8894; train_kl_reg_loss: 64375.4643; train_edge_recon_loss: 693665.8153; train_gene_expr_recon_loss: 18049633.7273; train_masked_gp_l1_reg_loss: 94241.0392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52298.9651; train_chrom_access_recon_loss: 1923690.3845; train_global_loss: 20877905.4242; train_optim_loss: 20877905.4242; val_kl_reg_loss: 26726.5530; val_edge_recon_loss: 717432.5156; val_gene_expr_recon_loss: 18091092.0000; val_masked_gp_l1_reg_loss: 94009.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52210.4961; val_chrom_access_recon_loss: 1878333.7344; val_global_loss: 20859805.0000; val_optim_loss: 20859805.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9420; val_auprc_score: 0.9268; val_best_acc_score: 0.8767; val_best_f1_score: 0.8842; train_kl_reg_loss: 62162.7612; train_edge_recon_loss: 692440.9688; train_gene_expr_recon_loss: 18025798.1818; train_masked_gp_l1_reg_loss: 93761.5603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52079.8762; train_chrom_access_recon_loss: 1915071.3769; train_global_loss: 20841314.5455; train_optim_loss: 20841314.5455; val_kl_reg_loss: 27353.3970; val_edge_recon_loss: 712643.8984; val_gene_expr_recon_loss: 18023951.0000; val_masked_gp_l1_reg_loss: 93512.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51940.7148; val_chrom_access_recon_loss: 1887703.2969; val_global_loss: 20797103.7500; val_optim_loss: 20797103.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9381; val_auprc_score: 0.9164; val_best_acc_score: 0.8775; val_best_f1_score: 0.8846; train_kl_reg_loss: 60492.2491; train_edge_recon_loss: 688860.2074; train_gene_expr_recon_loss: 18013962.2121; train_masked_gp_l1_reg_loss: 93269.3781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51802.3374; train_chrom_access_recon_loss: 1911488.3958; train_global_loss: 20819874.4848; train_optim_loss: 20819874.4848; val_kl_reg_loss: 27049.6663; val_edge_recon_loss: 708658.3672; val_gene_expr_recon_loss: 18022231.2500; val_masked_gp_l1_reg_loss: 93022.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51653.0469; val_chrom_access_recon_loss: 1892162.7344; val_global_loss: 20794778.5000; val_optim_loss: 20794778.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9372; val_auprc_score: 0.9182; val_best_acc_score: 0.8748; val_best_f1_score: 0.8802; train_kl_reg_loss: 59029.4652; train_edge_recon_loss: 687363.0682; train_gene_expr_recon_loss: 17996247.8485; train_masked_gp_l1_reg_loss: 92784.0011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51463.3641; train_chrom_access_recon_loss: 1907213.0890; train_global_loss: 20794100.8485; train_optim_loss: 20794100.8485; val_kl_reg_loss: 25994.4575; val_edge_recon_loss: 709012.2188; val_gene_expr_recon_loss: 18161748.0000; val_masked_gp_l1_reg_loss: 92536.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51293.5820; val_chrom_access_recon_loss: 1883722.2344; val_global_loss: 20924307.0000; val_optim_loss: 20924307.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9378; val_auprc_score: 0.9217; val_best_acc_score: 0.8775; val_best_f1_score: 0.8843; train_kl_reg_loss: 57102.2757; train_edge_recon_loss: 685845.3939; train_gene_expr_recon_loss: 18006614.0606; train_masked_gp_l1_reg_loss: 92312.8039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51135.0461; train_chrom_access_recon_loss: 1907951.3920; train_global_loss: 20800960.9091; train_optim_loss: 20800960.9091; val_kl_reg_loss: 25890.5337; val_edge_recon_loss: 699509.8438; val_gene_expr_recon_loss: 18019632.2500; val_masked_gp_l1_reg_loss: 92078.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50970.5898; val_chrom_access_recon_loss: 1876179.4688; val_global_loss: 20764260.0000; val_optim_loss: 20764260.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9437; val_auprc_score: 0.9300; val_best_acc_score: 0.8767; val_best_f1_score: 0.8814; train_kl_reg_loss: 55303.7160; train_edge_recon_loss: 680441.1875; train_gene_expr_recon_loss: 18017681.8485; train_masked_gp_l1_reg_loss: 91845.3870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50772.3745; train_chrom_access_recon_loss: 1907105.8030; train_global_loss: 20803150.4242; train_optim_loss: 20803150.4242; val_kl_reg_loss: 23010.7104; val_edge_recon_loss: 695224.0391; val_gene_expr_recon_loss: 17927033.7500; val_masked_gp_l1_reg_loss: 91634.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50575.9375; val_chrom_access_recon_loss: 1866328.2344; val_global_loss: 20653807.0000; val_optim_loss: 20653807.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9379; val_auprc_score: 0.9208; val_best_acc_score: 0.8751; val_best_f1_score: 0.8813; train_kl_reg_loss: 53099.9359; train_edge_recon_loss: 676447.0076; train_gene_expr_recon_loss: 17989671.3636; train_masked_gp_l1_reg_loss: 91435.3499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50467.7594; train_chrom_access_recon_loss: 1905839.6439; train_global_loss: 20766961.2727; train_optim_loss: 20766961.2727; val_kl_reg_loss: 25019.4268; val_edge_recon_loss: 680407.2109; val_gene_expr_recon_loss: 18054632.2500; val_masked_gp_l1_reg_loss: 91237.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50267.0820; val_chrom_access_recon_loss: 1874927.2344; val_global_loss: 20776492.2500; val_optim_loss: 20776492.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9338; val_auprc_score: 0.9095; val_best_acc_score: 0.8735; val_best_f1_score: 0.8793; train_kl_reg_loss: 52570.0939; train_edge_recon_loss: 666238.2869; train_gene_expr_recon_loss: 17986072.4242; train_masked_gp_l1_reg_loss: 91051.1098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50102.9653; train_chrom_access_recon_loss: 1903088.3390; train_global_loss: 20749123.1515; train_optim_loss: 20749123.1515; val_kl_reg_loss: 25587.8484; val_edge_recon_loss: 667944.1484; val_gene_expr_recon_loss: 17946143.7500; val_masked_gp_l1_reg_loss: 90848.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49907.2695; val_chrom_access_recon_loss: 1860246.4219; val_global_loss: 20640678.0000; val_optim_loss: 20640678.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9373; val_auprc_score: 0.9193; val_best_acc_score: 0.8724; val_best_f1_score: 0.8775; train_kl_reg_loss: 51470.8129; train_edge_recon_loss: 660601.1951; train_gene_expr_recon_loss: 17975907.8182; train_masked_gp_l1_reg_loss: 90651.0774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49737.6896; train_chrom_access_recon_loss: 1900784.9223; train_global_loss: 20729153.4242; train_optim_loss: 20729153.4242; val_kl_reg_loss: 25796.4739; val_edge_recon_loss: 663993.0625; val_gene_expr_recon_loss: 17896282.0000; val_masked_gp_l1_reg_loss: 90437.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49536.8438; val_chrom_access_recon_loss: 1857932.2500; val_global_loss: 20583978.0000; val_optim_loss: 20583978.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9326; val_auprc_score: 0.9137; val_best_acc_score: 0.8662; val_best_f1_score: 0.8713; train_kl_reg_loss: 50858.2750; train_edge_recon_loss: 652158.6146; train_gene_expr_recon_loss: 17984891.3636; train_masked_gp_l1_reg_loss: 90256.5631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49356.7661; train_chrom_access_recon_loss: 1903728.8617; train_global_loss: 20731250.7273; train_optim_loss: 20731250.7273; val_kl_reg_loss: 26754.0911; val_edge_recon_loss: 654836.9609; val_gene_expr_recon_loss: 17910527.7500; val_masked_gp_l1_reg_loss: 90066.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49198.5078; val_chrom_access_recon_loss: 1860949.8125; val_global_loss: 20592333.0000; val_optim_loss: 20592333.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9337; val_auprc_score: 0.9119; val_best_acc_score: 0.8678; val_best_f1_score: 0.8753; train_kl_reg_loss: 50369.2670; train_edge_recon_loss: 646074.7509; train_gene_expr_recon_loss: 17971193.5455; train_masked_gp_l1_reg_loss: 89883.2675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49043.0557; train_chrom_access_recon_loss: 1902837.7235; train_global_loss: 20709401.5152; train_optim_loss: 20709401.5152; val_kl_reg_loss: 28071.2129; val_edge_recon_loss: 638736.2734; val_gene_expr_recon_loss: 18019125.2500; val_masked_gp_l1_reg_loss: 89682.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48830.8555; val_chrom_access_recon_loss: 1875901.2188; val_global_loss: 20700346.5000; val_optim_loss: 20700346.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9178; val_auprc_score: 0.8943; val_best_acc_score: 0.8503; val_best_f1_score: 0.8603; train_kl_reg_loss: 49916.6608; train_edge_recon_loss: 638580.3172; train_gene_expr_recon_loss: 17959880.7879; train_masked_gp_l1_reg_loss: 89509.1947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48686.3597; train_chrom_access_recon_loss: 1899301.4811; train_global_loss: 20685874.7576; train_optim_loss: 20685874.7576; val_kl_reg_loss: 29246.3804; val_edge_recon_loss: 640799.3281; val_gene_expr_recon_loss: 18043153.7500; val_masked_gp_l1_reg_loss: 89322.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48505.3906; val_chrom_access_recon_loss: 1862271.0938; val_global_loss: 20713298.7500; val_optim_loss: 20713298.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9226; val_auprc_score: 0.9053; val_best_acc_score: 0.8536; val_best_f1_score: 0.8616; train_kl_reg_loss: 49723.5137; train_edge_recon_loss: 632972.0379; train_gene_expr_recon_loss: 17967170.8182; train_masked_gp_l1_reg_loss: 89140.1510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48358.4723; train_chrom_access_recon_loss: 1900785.7424; train_global_loss: 20688150.6364; train_optim_loss: 20688150.6364; val_kl_reg_loss: 30527.9912; val_edge_recon_loss: 635916.3516; val_gene_expr_recon_loss: 18028174.0000; val_masked_gp_l1_reg_loss: 88944.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48199.0703; val_chrom_access_recon_loss: 1876946.8594; val_global_loss: 20708709.0000; val_optim_loss: 20708709.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9338; val_auprc_score: 0.9167; val_best_acc_score: 0.8667; val_best_f1_score: 0.8712; train_kl_reg_loss: 49593.7709; train_edge_recon_loss: 629666.1809; train_gene_expr_recon_loss: 17960102.4545; train_masked_gp_l1_reg_loss: 88790.8368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47458.0645; train_chrom_access_recon_loss: 1901419.9451; train_global_loss: 20677031.3333; train_optim_loss: 20677031.3333; val_kl_reg_loss: 31002.8059; val_edge_recon_loss: 626888.5938; val_gene_expr_recon_loss: 17932567.7500; val_masked_gp_l1_reg_loss: 88718.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47233.5664; val_chrom_access_recon_loss: 1871316.2656; val_global_loss: 20597727.2500; val_optim_loss: 20597727.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9216; val_auprc_score: 0.8974; val_best_acc_score: 0.8536; val_best_f1_score: 0.8600; train_kl_reg_loss: 49692.4777; train_edge_recon_loss: 630264.6089; train_gene_expr_recon_loss: 17964740.3636; train_masked_gp_l1_reg_loss: 88682.1849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47157.6113; train_chrom_access_recon_loss: 1900652.3731; train_global_loss: 20681189.4242; train_optim_loss: 20681189.4242; val_kl_reg_loss: 31093.2356; val_edge_recon_loss: 634633.6406; val_gene_expr_recon_loss: 18028132.5000; val_masked_gp_l1_reg_loss: 88650.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47089.2891; val_chrom_access_recon_loss: 1861056.2969; val_global_loss: 20690655.5000; val_optim_loss: 20690655.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9302; val_auprc_score: 0.9121; val_best_acc_score: 0.8632; val_best_f1_score: 0.8682; train_kl_reg_loss: 49710.5233; train_edge_recon_loss: 628338.5871; train_gene_expr_recon_loss: 17945849.5455; train_masked_gp_l1_reg_loss: 88623.4469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47041.3695; train_chrom_access_recon_loss: 1898774.1913; train_global_loss: 20658337.9091; train_optim_loss: 20658337.9091; val_kl_reg_loss: 31236.9270; val_edge_recon_loss: 628542.9453; val_gene_expr_recon_loss: 17978023.0000; val_masked_gp_l1_reg_loss: 88595.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46992.6992; val_chrom_access_recon_loss: 1866002.5781; val_global_loss: 20639393.2500; val_optim_loss: 20639393.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9284; val_auprc_score: 0.9102; val_best_acc_score: 0.8579; val_best_f1_score: 0.8644; train_kl_reg_loss: 49757.5739; train_edge_recon_loss: 626893.2102; train_gene_expr_recon_loss: 17955168.2424; train_masked_gp_l1_reg_loss: 88572.1438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46961.0048; train_chrom_access_recon_loss: 1900387.7784; train_global_loss: 20667740.0000; train_optim_loss: 20667740.0000; val_kl_reg_loss: 31348.6472; val_edge_recon_loss: 629062.5938; val_gene_expr_recon_loss: 17921282.5000; val_masked_gp_l1_reg_loss: 88546.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46920.2070; val_chrom_access_recon_loss: 1859472.0469; val_global_loss: 20576631.7500; val_optim_loss: 20576631.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9278; val_auprc_score: 0.9055; val_best_acc_score: 0.8651; val_best_f1_score: 0.8695; train_kl_reg_loss: 49698.4544; train_edge_recon_loss: 628494.8428; train_gene_expr_recon_loss: 17953275.0000; train_masked_gp_l1_reg_loss: 88523.5670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46891.4979; train_chrom_access_recon_loss: 1900041.5758; train_global_loss: 20666924.7576; train_optim_loss: 20666924.7576; val_kl_reg_loss: 31578.1316; val_edge_recon_loss: 626641.8594; val_gene_expr_recon_loss: 17979775.0000; val_masked_gp_l1_reg_loss: 88499.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46859.0508; val_chrom_access_recon_loss: 1858663.2031; val_global_loss: 20632018.5000; val_optim_loss: 20632018.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9300; val_auprc_score: 0.9075; val_best_acc_score: 0.8622; val_best_f1_score: 0.8692; train_kl_reg_loss: 49715.0929; train_edge_recon_loss: 625990.0303; train_gene_expr_recon_loss: 17966760.7576; train_masked_gp_l1_reg_loss: 88478.5115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46836.8507; train_chrom_access_recon_loss: 1902233.8201; train_global_loss: 20680015.2424; train_optim_loss: 20680015.2424; val_kl_reg_loss: 31607.8945; val_edge_recon_loss: 629823.1797; val_gene_expr_recon_loss: 18003096.0000; val_masked_gp_l1_reg_loss: 88453.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46807.6680; val_chrom_access_recon_loss: 1869687.2188; val_global_loss: 20669476.0000; val_optim_loss: 20669476.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9227; val_auprc_score: 0.9026; val_best_acc_score: 0.8533; val_best_f1_score: 0.8613; train_kl_reg_loss: 49694.9345; train_edge_recon_loss: 628665.9261; train_gene_expr_recon_loss: 17959176.8485; train_masked_gp_l1_reg_loss: 88430.6502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46789.3178; train_chrom_access_recon_loss: 1898755.1761; train_global_loss: 20671512.8485; train_optim_loss: 20671512.8485; val_kl_reg_loss: 31837.5942; val_edge_recon_loss: 626140.5547; val_gene_expr_recon_loss: 18015394.5000; val_masked_gp_l1_reg_loss: 88407.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46760.1211; val_chrom_access_recon_loss: 1865867.9844; val_global_loss: 20674408.5000; val_optim_loss: 20674408.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9231; val_auprc_score: 0.9025; val_best_acc_score: 0.8563; val_best_f1_score: 0.8621; train_kl_reg_loss: 49718.4808; train_edge_recon_loss: 624417.4962; train_gene_expr_recon_loss: 17966414.4848; train_masked_gp_l1_reg_loss: 88385.0348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46743.9289; train_chrom_access_recon_loss: 1899660.0701; train_global_loss: 20675339.3636; train_optim_loss: 20675339.3636; val_kl_reg_loss: 31959.9902; val_edge_recon_loss: 633349.8359; val_gene_expr_recon_loss: 17944960.7500; val_masked_gp_l1_reg_loss: 88359.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46714.4180; val_chrom_access_recon_loss: 1870279.6094; val_global_loss: 20615624.5000; val_optim_loss: 20615624.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9286; val_auprc_score: 0.9138; val_best_acc_score: 0.8595; val_best_f1_score: 0.8647; train_kl_reg_loss: 49768.3323; train_edge_recon_loss: 625347.9347; train_gene_expr_recon_loss: 17965997.6364; train_masked_gp_l1_reg_loss: 88343.6934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46638.3016; train_chrom_access_recon_loss: 1900547.3485; train_global_loss: 20676643.1212; train_optim_loss: 20676643.1212; val_kl_reg_loss: 31934.5706; val_edge_recon_loss: 629692.4531; val_gene_expr_recon_loss: 17941525.5000; val_masked_gp_l1_reg_loss: 88335.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46617.8555; val_chrom_access_recon_loss: 1885637.9688; val_global_loss: 20623744.2500; val_optim_loss: 20623744.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9231; val_auprc_score: 0.9051; val_best_acc_score: 0.8555; val_best_f1_score: 0.8613; train_kl_reg_loss: 49744.6399; train_edge_recon_loss: 624298.5047; train_gene_expr_recon_loss: 17945812.7121; train_masked_gp_l1_reg_loss: 88331.5845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46612.0967; train_chrom_access_recon_loss: 1898077.4337; train_global_loss: 20652876.9394; train_optim_loss: 20652876.9394; val_kl_reg_loss: 32093.9312; val_edge_recon_loss: 633305.2578; val_gene_expr_recon_loss: 17985572.5000; val_masked_gp_l1_reg_loss: 88327.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46606.1445; val_chrom_access_recon_loss: 1879491.0938; val_global_loss: 20665397.2500; val_optim_loss: 20665397.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9280; val_auprc_score: 0.9089; val_best_acc_score: 0.8616; val_best_f1_score: 0.8681; train_kl_reg_loss: 49722.7710; train_edge_recon_loss: 625542.7481; train_gene_expr_recon_loss: 17947756.3939; train_masked_gp_l1_reg_loss: 88324.2849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46601.6768; train_chrom_access_recon_loss: 1898703.3277; train_global_loss: 20656651.2727; train_optim_loss: 20656651.2727; val_kl_reg_loss: 32169.6304; val_edge_recon_loss: 628496.7422; val_gene_expr_recon_loss: 18012463.2500; val_masked_gp_l1_reg_loss: 88321.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46596.5898; val_chrom_access_recon_loss: 1871764.0312; val_global_loss: 20679811.7500; val_optim_loss: 20679811.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9277; val_auprc_score: 0.9121; val_best_acc_score: 0.8603; val_best_f1_score: 0.8689; train_kl_reg_loss: 49781.3093; train_edge_recon_loss: 627039.3400; train_gene_expr_recon_loss: 17955116.5758; train_masked_gp_l1_reg_loss: 88318.1076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46593.2271; train_chrom_access_recon_loss: 1899053.0473; train_global_loss: 20665901.6667; train_optim_loss: 20665901.6667; val_kl_reg_loss: 32171.6028; val_edge_recon_loss: 622119.4062; val_gene_expr_recon_loss: 17965702.0000; val_masked_gp_l1_reg_loss: 88314.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46589.3203; val_chrom_access_recon_loss: 1862583.9219; val_global_loss: 20617481.0000; val_optim_loss: 20617481.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 1 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9274
val AUPRC score: 0.9076
val best accuracy score: 0.8635
val best F1 score: 0.8684
val target rna MSE score: 1.5041
val source rna MSE score: 0.7839
val target atac MSE score: 0.3036
val source atac MSE score: 0.1332
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
