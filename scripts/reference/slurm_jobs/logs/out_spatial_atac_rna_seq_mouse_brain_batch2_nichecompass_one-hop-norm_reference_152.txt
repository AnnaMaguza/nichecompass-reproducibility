[True]
Run timestamp: 07082023_220559_152.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_152']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8749; val_auprc_score: 0.8859; val_best_acc_score: 0.5795; val_best_f1_score: 0.7022; train_kl_reg_loss: 55065.0845; train_edge_recon_loss: 3474152.9722; train_gene_expr_recon_loss: 1221283.6667; train_masked_gp_l1_reg_loss: 16346.9731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119016.8819; train_chrom_access_recon_loss: 744630.8889; train_global_loss: 5630496.5556; train_optim_loss: 5630496.5556; val_kl_reg_loss: 16689.0938; val_edge_recon_loss: 4060273.5000; val_gene_expr_recon_loss: 1064217.8750; val_masked_gp_l1_reg_loss: 12188.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116387.7422; val_chrom_access_recon_loss: 498300.5312; val_global_loss: 5768057.5000; val_optim_loss: 5768057.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8813; val_auprc_score: 0.8919; val_best_acc_score: 0.6109; val_best_f1_score: 0.7168; train_kl_reg_loss: 12823.0465; train_edge_recon_loss: 3475883.7500; train_gene_expr_recon_loss: 1029273.6528; train_masked_gp_l1_reg_loss: 10751.9348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114716.4288; train_chrom_access_recon_loss: 502216.9896; train_global_loss: 5145665.7222; train_optim_loss: 5145665.7222; val_kl_reg_loss: 6055.4082; val_edge_recon_loss: 4057828.0000; val_gene_expr_recon_loss: 946420.5625; val_masked_gp_l1_reg_loss: 9563.6152; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112682.5000; val_chrom_access_recon_loss: 480063.8750; val_global_loss: 5612614.0000; val_optim_loss: 5612614.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8774; val_auprc_score: 0.8865; val_best_acc_score: 0.5834; val_best_f1_score: 0.7033; train_kl_reg_loss: 15767.1565; train_edge_recon_loss: 3478616.5556; train_gene_expr_recon_loss: 928447.4444; train_masked_gp_l1_reg_loss: 9406.2746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111063.4740; train_chrom_access_recon_loss: 483898.4757; train_global_loss: 5027199.3333; train_optim_loss: 5027199.3333; val_kl_reg_loss: 10654.7461; val_edge_recon_loss: 4059411.0000; val_gene_expr_recon_loss: 873150.3750; val_masked_gp_l1_reg_loss: 9243.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109010.8516; val_chrom_access_recon_loss: 469285.6562; val_global_loss: 5530756.5000; val_optim_loss: 5530756.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8599; val_auprc_score: 0.8684; val_best_acc_score: 0.6319; val_best_f1_score: 0.7248; train_kl_reg_loss: 12377.0368; train_edge_recon_loss: 3477944.1944; train_gene_expr_recon_loss: 855308.1597; train_masked_gp_l1_reg_loss: 9011.0035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107255.4792; train_chrom_access_recon_loss: 471644.9722; train_global_loss: 4933541.1111; train_optim_loss: 4933541.1111; val_kl_reg_loss: 11499.3506; val_edge_recon_loss: 4054540.5000; val_gene_expr_recon_loss: 820945.8750; val_masked_gp_l1_reg_loss: 8728.5459; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104947.6562; val_chrom_access_recon_loss: 455689.6562; val_global_loss: 5456351.0000; val_optim_loss: 5456351.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8434; val_auprc_score: 0.8479; val_best_acc_score: 0.6867; val_best_f1_score: 0.7498; train_kl_reg_loss: 14087.2715; train_edge_recon_loss: 3476375.1389; train_gene_expr_recon_loss: 813294.2222; train_masked_gp_l1_reg_loss: 8573.9699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102925.8030; train_chrom_access_recon_loss: 461864.7222; train_global_loss: 4877121.3333; train_optim_loss: 4877121.3333; val_kl_reg_loss: 11721.9062; val_edge_recon_loss: 4045272.2500; val_gene_expr_recon_loss: 785525.7500; val_masked_gp_l1_reg_loss: 8427.1934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100295.5938; val_chrom_access_recon_loss: 449605.1250; val_global_loss: 5400847.5000; val_optim_loss: 5400847.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8402; val_auprc_score: 0.8398; val_best_acc_score: 0.7529; val_best_f1_score: 0.7737; train_kl_reg_loss: 14141.4038; train_edge_recon_loss: 3474979.3611; train_gene_expr_recon_loss: 780550.9514; train_masked_gp_l1_reg_loss: 8367.0383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98066.2240; train_chrom_access_recon_loss: 456395.0382; train_global_loss: 4832499.9444; train_optim_loss: 4832499.9444; val_kl_reg_loss: 12418.3926; val_edge_recon_loss: 4010993.0000; val_gene_expr_recon_loss: 761339.3750; val_masked_gp_l1_reg_loss: 8305.7373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95225.5625; val_chrom_access_recon_loss: 446306.6875; val_global_loss: 5334588.5000; val_optim_loss: 5334588.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8292; val_auprc_score: 0.8189; val_best_acc_score: 0.7293; val_best_f1_score: 0.7613; train_kl_reg_loss: 13667.5463; train_edge_recon_loss: 3463656.7500; train_gene_expr_recon_loss: 762406.3403; train_masked_gp_l1_reg_loss: 8286.5875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92894.9714; train_chrom_access_recon_loss: 452813.7153; train_global_loss: 4793726.0000; train_optim_loss: 4793726.0000; val_kl_reg_loss: 12545.4863; val_edge_recon_loss: 3914950.5000; val_gene_expr_recon_loss: 747340.6250; val_masked_gp_l1_reg_loss: 8266.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89966.0938; val_chrom_access_recon_loss: 444568.7500; val_global_loss: 5217638.0000; val_optim_loss: 5217638.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8394; val_auprc_score: 0.8269; val_best_acc_score: 0.7498; val_best_f1_score: 0.7741; train_kl_reg_loss: 10410.1356; train_edge_recon_loss: 3421536.0556; train_gene_expr_recon_loss: 758810.4444; train_masked_gp_l1_reg_loss: 8280.7586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87634.6389; train_chrom_access_recon_loss: 454210.4757; train_global_loss: 4740882.5556; train_optim_loss: 4740882.5556; val_kl_reg_loss: 6285.8525; val_edge_recon_loss: 3536444.2500; val_gene_expr_recon_loss: 755695.7500; val_masked_gp_l1_reg_loss: 8296.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84747.3047; val_chrom_access_recon_loss: 444846.6875; val_global_loss: 4836316.5000; val_optim_loss: 4836316.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8344; val_auprc_score: 0.8291; val_best_acc_score: 0.7529; val_best_f1_score: 0.7682; train_kl_reg_loss: 7914.7570; train_edge_recon_loss: 3198119.0556; train_gene_expr_recon_loss: 784393.9792; train_masked_gp_l1_reg_loss: 8320.6471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82528.9922; train_chrom_access_recon_loss: 451439.4653; train_global_loss: 4532716.9444; train_optim_loss: 4532716.9444; val_kl_reg_loss: 15848.9697; val_edge_recon_loss: 3047588.7500; val_gene_expr_recon_loss: 805937.5000; val_masked_gp_l1_reg_loss: 8329.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79833.2734; val_chrom_access_recon_loss: 448774.3750; val_global_loss: 4406313.0000; val_optim_loss: 4406313.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8659; val_auprc_score: 0.8579; val_best_acc_score: 0.7734; val_best_f1_score: 0.7997; train_kl_reg_loss: 23233.7632; train_edge_recon_loss: 2943336.6389; train_gene_expr_recon_loss: 794910.3333; train_masked_gp_l1_reg_loss: 8346.0028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77781.7396; train_chrom_access_recon_loss: 454211.9826; train_global_loss: 4301820.6111; train_optim_loss: 4301820.6111; val_kl_reg_loss: 31473.3887; val_edge_recon_loss: 2919993.5000; val_gene_expr_recon_loss: 773039.7500; val_masked_gp_l1_reg_loss: 8359.2920; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75264.3906; val_chrom_access_recon_loss: 445523.8125; val_global_loss: 4253654.5000; val_optim_loss: 4253654.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8865; val_auprc_score: 0.8652; val_best_acc_score: 0.8071; val_best_f1_score: 0.8290; train_kl_reg_loss: 38719.4288; train_edge_recon_loss: 2856615.7778; train_gene_expr_recon_loss: 776328.5764; train_masked_gp_l1_reg_loss: 8330.4680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73280.9861; train_chrom_access_recon_loss: 453507.8576; train_global_loss: 4206783.0556; train_optim_loss: 4206783.0556; val_kl_reg_loss: 40787.9844; val_edge_recon_loss: 2798926.5000; val_gene_expr_recon_loss: 758756.5625; val_masked_gp_l1_reg_loss: 8323.3506; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70812.1484; val_chrom_access_recon_loss: 443404.0625; val_global_loss: 4121010.5000; val_optim_loss: 4121010.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9083; val_auprc_score: 0.8828; val_best_acc_score: 0.8429; val_best_f1_score: 0.8543; train_kl_reg_loss: 41714.5898; train_edge_recon_loss: 2799984.8611; train_gene_expr_recon_loss: 758948.6042; train_masked_gp_l1_reg_loss: 8327.0990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68872.5243; train_chrom_access_recon_loss: 448598.4861; train_global_loss: 4126446.0833; train_optim_loss: 4126446.0833; val_kl_reg_loss: 39145.2070; val_edge_recon_loss: 2778883.0000; val_gene_expr_recon_loss: 746050.4375; val_masked_gp_l1_reg_loss: 8274.2197; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66458.8672; val_chrom_access_recon_loss: 441547.0625; val_global_loss: 4080358.7500; val_optim_loss: 4080358.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9280; val_auprc_score: 0.9083; val_best_acc_score: 0.8604; val_best_f1_score: 0.8679; train_kl_reg_loss: 38702.9201; train_edge_recon_loss: 2753209.1667; train_gene_expr_recon_loss: 754025.2708; train_masked_gp_l1_reg_loss: 8241.2879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64572.0087; train_chrom_access_recon_loss: 450182.0174; train_global_loss: 4068932.6944; train_optim_loss: 4068932.6944; val_kl_reg_loss: 35854.9375; val_edge_recon_loss: 2734120.7500; val_gene_expr_recon_loss: 743233.7500; val_masked_gp_l1_reg_loss: 8212.8330; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62248.3945; val_chrom_access_recon_loss: 440771.1562; val_global_loss: 4024442.0000; val_optim_loss: 4024442.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9339; val_auprc_score: 0.9143; val_best_acc_score: 0.8649; val_best_f1_score: 0.8724; train_kl_reg_loss: 37658.2118; train_edge_recon_loss: 2732843.3056; train_gene_expr_recon_loss: 748626.5764; train_masked_gp_l1_reg_loss: 8205.2189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60455.3941; train_chrom_access_recon_loss: 449062.9965; train_global_loss: 4036851.5833; train_optim_loss: 4036851.5833; val_kl_reg_loss: 36603.7891; val_edge_recon_loss: 2738702.0000; val_gene_expr_recon_loss: 739959.1250; val_masked_gp_l1_reg_loss: 8207.6084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58249.1094; val_chrom_access_recon_loss: 439729.4375; val_global_loss: 4021451.0000; val_optim_loss: 4021451.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9487; val_auprc_score: 0.9318; val_best_acc_score: 0.8860; val_best_f1_score: 0.8909; train_kl_reg_loss: 37709.9714; train_edge_recon_loss: 2717811.3333; train_gene_expr_recon_loss: 745017.8611; train_masked_gp_l1_reg_loss: 8242.1743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56584.5438; train_chrom_access_recon_loss: 446389.8646; train_global_loss: 4011755.7778; train_optim_loss: 4011755.7778; val_kl_reg_loss: 36401.4219; val_edge_recon_loss: 2739096.2500; val_gene_expr_recon_loss: 732006.0000; val_masked_gp_l1_reg_loss: 8262.5693; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54549.6562; val_chrom_access_recon_loss: 438549.6250; val_global_loss: 4008865.5000; val_optim_loss: 4008865.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9576; val_auprc_score: 0.9408; val_best_acc_score: 0.9045; val_best_f1_score: 0.9083; train_kl_reg_loss: 37801.5812; train_edge_recon_loss: 2701744.4167; train_gene_expr_recon_loss: 738118.6458; train_masked_gp_l1_reg_loss: 8264.2450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53007.0265; train_chrom_access_recon_loss: 444426.5312; train_global_loss: 3983362.4444; train_optim_loss: 3983362.4444; val_kl_reg_loss: 36803.7109; val_edge_recon_loss: 2705241.5000; val_gene_expr_recon_loss: 728304.8125; val_masked_gp_l1_reg_loss: 8270.1553; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51133.1953; val_chrom_access_recon_loss: 437603.7188; val_global_loss: 3967357.2500; val_optim_loss: 3967357.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9635; val_auprc_score: 0.9502; val_best_acc_score: 0.9167; val_best_f1_score: 0.9195; train_kl_reg_loss: 37573.6332; train_edge_recon_loss: 2690368.9444; train_gene_expr_recon_loss: 732134.2569; train_masked_gp_l1_reg_loss: 8272.6674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49726.0894; train_chrom_access_recon_loss: 442414.5764; train_global_loss: 3960490.0833; train_optim_loss: 3960490.0833; val_kl_reg_loss: 36819.8672; val_edge_recon_loss: 2699060.5000; val_gene_expr_recon_loss: 725307.1250; val_masked_gp_l1_reg_loss: 8270.3564; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48013.1055; val_chrom_access_recon_loss: 436914.8438; val_global_loss: 3954385.5000; val_optim_loss: 3954385.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9652; val_auprc_score: 0.9500; val_best_acc_score: 0.9192; val_best_f1_score: 0.9216; train_kl_reg_loss: 38431.1853; train_edge_recon_loss: 2670235.7778; train_gene_expr_recon_loss: 729134.5139; train_masked_gp_l1_reg_loss: 8282.4289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46730.5781; train_chrom_access_recon_loss: 442004.0104; train_global_loss: 3934818.5000; train_optim_loss: 3934818.5000; val_kl_reg_loss: 37798.8750; val_edge_recon_loss: 2698888.0000; val_gene_expr_recon_loss: 719936.4375; val_masked_gp_l1_reg_loss: 8303.1182; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45166.0352; val_chrom_access_recon_loss: 435976.5000; val_global_loss: 3946069.0000; val_optim_loss: 3946069.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9711; val_auprc_score: 0.9615; val_best_acc_score: 0.9233; val_best_f1_score: 0.9258; train_kl_reg_loss: 39349.4544; train_edge_recon_loss: 2669310.0278; train_gene_expr_recon_loss: 728918.3750; train_masked_gp_l1_reg_loss: 8325.5252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43987.3967; train_chrom_access_recon_loss: 442688.0660; train_global_loss: 3932578.8611; train_optim_loss: 3932578.8611; val_kl_reg_loss: 38407.0781; val_edge_recon_loss: 2668185.2500; val_gene_expr_recon_loss: 716810.3750; val_masked_gp_l1_reg_loss: 8352.3447; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42560.0781; val_chrom_access_recon_loss: 435247.2500; val_global_loss: 3909562.0000; val_optim_loss: 3909562.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9708; val_auprc_score: 0.9610; val_best_acc_score: 0.9272; val_best_f1_score: 0.9301; train_kl_reg_loss: 40154.7088; train_edge_recon_loss: 2672884.1667; train_gene_expr_recon_loss: 719365.5625; train_masked_gp_l1_reg_loss: 8371.6345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41484.2626; train_chrom_access_recon_loss: 441841.5208; train_global_loss: 3924101.9167; train_optim_loss: 3924101.9167; val_kl_reg_loss: 38808.4375; val_edge_recon_loss: 2670025.5000; val_gene_expr_recon_loss: 715520.0000; val_masked_gp_l1_reg_loss: 8391.0098; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40167.3281; val_chrom_access_recon_loss: 434500.8438; val_global_loss: 3907413.0000; val_optim_loss: 3907413.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9721; val_auprc_score: 0.9603; val_best_acc_score: 0.9272; val_best_f1_score: 0.9298; train_kl_reg_loss: 39734.4549; train_edge_recon_loss: 2681253.8611; train_gene_expr_recon_loss: 717789.9028; train_masked_gp_l1_reg_loss: 8402.8771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39185.2882; train_chrom_access_recon_loss: 439373.8194; train_global_loss: 3925740.2222; train_optim_loss: 3925740.2222; val_kl_reg_loss: 38350.6172; val_edge_recon_loss: 2691064.5000; val_gene_expr_recon_loss: 711442.2500; val_masked_gp_l1_reg_loss: 8414.8193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37984.1289; val_chrom_access_recon_loss: 433643.2500; val_global_loss: 3920899.5000; val_optim_loss: 3920899.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9723; val_auprc_score: 0.9628; val_best_acc_score: 0.9309; val_best_f1_score: 0.9334; train_kl_reg_loss: 38928.1150; train_edge_recon_loss: 2670452.2778; train_gene_expr_recon_loss: 715570.0000; train_masked_gp_l1_reg_loss: 8433.3740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37084.9826; train_chrom_access_recon_loss: 438771.5278; train_global_loss: 3909240.3611; train_optim_loss: 3909240.3611; val_kl_reg_loss: 37488.3047; val_edge_recon_loss: 2667571.5000; val_gene_expr_recon_loss: 705892.0000; val_masked_gp_l1_reg_loss: 8460.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35985.4883; val_chrom_access_recon_loss: 432870.2500; val_global_loss: 3888267.5000; val_optim_loss: 3888267.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9739; val_auprc_score: 0.9606; val_best_acc_score: 0.9344; val_best_f1_score: 0.9368; train_kl_reg_loss: 38307.1597; train_edge_recon_loss: 2664177.1667; train_gene_expr_recon_loss: 712846.4236; train_masked_gp_l1_reg_loss: 8481.2095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35151.6584; train_chrom_access_recon_loss: 438955.6389; train_global_loss: 3897919.1667; train_optim_loss: 3897919.1667; val_kl_reg_loss: 36938.6719; val_edge_recon_loss: 2668767.0000; val_gene_expr_recon_loss: 704548.6250; val_masked_gp_l1_reg_loss: 8504.8301; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34138.4453; val_chrom_access_recon_loss: 432140.3438; val_global_loss: 3885038.0000; val_optim_loss: 3885038.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9727; val_auprc_score: 0.9624; val_best_acc_score: 0.9309; val_best_f1_score: 0.9338; train_kl_reg_loss: 38813.7040; train_edge_recon_loss: 2664171.1111; train_gene_expr_recon_loss: 709347.1389; train_masked_gp_l1_reg_loss: 8531.0433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33391.9388; train_chrom_access_recon_loss: 440519.4167; train_global_loss: 3894774.4444; train_optim_loss: 3894774.4444; val_kl_reg_loss: 37985.4453; val_edge_recon_loss: 2685278.7500; val_gene_expr_recon_loss: 701870.6250; val_masked_gp_l1_reg_loss: 8560.3809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32483.6895; val_chrom_access_recon_loss: 431534.8750; val_global_loss: 3897714.0000; val_optim_loss: 3897714.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9755; val_auprc_score: 0.9672; val_best_acc_score: 0.9348; val_best_f1_score: 0.9368; train_kl_reg_loss: 38313.4531; train_edge_recon_loss: 2667148.3889; train_gene_expr_recon_loss: 708623.2431; train_masked_gp_l1_reg_loss: 8584.5419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31784.3299; train_chrom_access_recon_loss: 439068.6181; train_global_loss: 3893522.5833; train_optim_loss: 3893522.5833; val_kl_reg_loss: 36998.4688; val_edge_recon_loss: 2676046.5000; val_gene_expr_recon_loss: 702344.4375; val_masked_gp_l1_reg_loss: 8611.9160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30935.9746; val_chrom_access_recon_loss: 431046.1875; val_global_loss: 3885983.7500; val_optim_loss: 3885983.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9773; val_auprc_score: 0.9672; val_best_acc_score: 0.9407; val_best_f1_score: 0.9424; train_kl_reg_loss: 35960.4727; train_edge_recon_loss: 2672076.6667; train_gene_expr_recon_loss: 1027137.3819; train_masked_gp_l1_reg_loss: 8636.5778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30098.2352; train_chrom_access_recon_loss: 465360.0764; train_global_loss: 4239269.3611; train_optim_loss: 4239269.3611; val_kl_reg_loss: 14327.5049; val_edge_recon_loss: 2670560.7500; val_gene_expr_recon_loss: 1000243.0625; val_masked_gp_l1_reg_loss: 8654.9678; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28940.1992; val_chrom_access_recon_loss: 454366.9062; val_global_loss: 4177093.5000; val_optim_loss: 4177093.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9753; val_auprc_score: 0.9625; val_best_acc_score: 0.9387; val_best_f1_score: 0.9404; train_kl_reg_loss: 31568.5082; train_edge_recon_loss: 2658069.4722; train_gene_expr_recon_loss: 1016279.9097; train_masked_gp_l1_reg_loss: 8698.3994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27949.9065; train_chrom_access_recon_loss: 462871.4132; train_global_loss: 4205437.5556; train_optim_loss: 4205437.5556; val_kl_reg_loss: 14033.5215; val_edge_recon_loss: 2647955.5000; val_gene_expr_recon_loss: 1002037.7500; val_masked_gp_l1_reg_loss: 8745.6348; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26717.5234; val_chrom_access_recon_loss: 454367.2500; val_global_loss: 4153857.2500; val_optim_loss: 4153857.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9777; val_auprc_score: 0.9678; val_best_acc_score: 0.9394; val_best_f1_score: 0.9410; train_kl_reg_loss: 30485.3717; train_edge_recon_loss: 2656468.2778; train_gene_expr_recon_loss: 1013871.4028; train_masked_gp_l1_reg_loss: 8679.9746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26574.6738; train_chrom_access_recon_loss: 462127.2118; train_global_loss: 4198206.9167; train_optim_loss: 4198206.9167; val_kl_reg_loss: 14078.5449; val_edge_recon_loss: 2650770.5000; val_gene_expr_recon_loss: 1004628.0000; val_masked_gp_l1_reg_loss: 8618.0557; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26398.0508; val_chrom_access_recon_loss: 454606.2500; val_global_loss: 4159099.2500; val_optim_loss: 4159099.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9796; val_auprc_score: 0.9719; val_best_acc_score: 0.9396; val_best_f1_score: 0.9414; train_kl_reg_loss: 30283.9928; train_edge_recon_loss: 2664750.2778; train_gene_expr_recon_loss: 1015612.7569; train_masked_gp_l1_reg_loss: 8608.1168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26274.8917; train_chrom_access_recon_loss: 463097.3889; train_global_loss: 4208627.4167; train_optim_loss: 4208627.4167; val_kl_reg_loss: 13994.6758; val_edge_recon_loss: 2658384.5000; val_gene_expr_recon_loss: 1004517.8125; val_masked_gp_l1_reg_loss: 8590.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26119.2559; val_chrom_access_recon_loss: 454780.0312; val_global_loss: 4166387.0000; val_optim_loss: 4166387.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9745; val_auprc_score: 0.9619; val_best_acc_score: 0.9373; val_best_f1_score: 0.9393; train_kl_reg_loss: 30003.0204; train_edge_recon_loss: 2648369.4722; train_gene_expr_recon_loss: 1020416.7708; train_masked_gp_l1_reg_loss: 8582.5445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26000.0035; train_chrom_access_recon_loss: 463210.5208; train_global_loss: 4196582.3056; train_optim_loss: 4196582.3056; val_kl_reg_loss: 13942.3379; val_edge_recon_loss: 2666987.7500; val_gene_expr_recon_loss: 1003524.1250; val_masked_gp_l1_reg_loss: 8575.9756; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25855.0957; val_chrom_access_recon_loss: 454484.8750; val_global_loss: 4173370.0000; val_optim_loss: 4173370.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9761; val_auprc_score: 0.9651; val_best_acc_score: 0.9382; val_best_f1_score: 0.9401; train_kl_reg_loss: 29737.1641; train_edge_recon_loss: 2653819.9167; train_gene_expr_recon_loss: 1010285.9722; train_masked_gp_l1_reg_loss: 8575.2133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25746.4355; train_chrom_access_recon_loss: 462372.7326; train_global_loss: 4190537.4722; train_optim_loss: 4190537.4722; val_kl_reg_loss: 13891.6133; val_edge_recon_loss: 2664791.2500; val_gene_expr_recon_loss: 1002572.6250; val_masked_gp_l1_reg_loss: 8575.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25613.7988; val_chrom_access_recon_loss: 454450.9688; val_global_loss: 4169895.7500; val_optim_loss: 4169895.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 40 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9716
val AUPRC score: 0.9607
val best accuracy score: 0.9276
val best F1 score: 0.9305
val target rna MSE score: 3.8317
val source rna MSE score: 3.1459
val target atac MSE score: 0.1291
val source atac MSE score: 0.0209
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
