[True]
Run timestamp: 29072023_131113_135.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_135']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8849; val_auprc_score: 0.9034; val_best_acc_score: 0.5166; val_best_f1_score: 0.6740; train_kl_reg_loss: 12065.0983; train_edge_recon_loss: 34698144.0000; train_gene_expr_recon_loss: 7636287.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 18347524.0000; train_global_loss: 60694020.0000; train_optim_loss: 60694020.0000; val_kl_reg_loss: 7517.8340; val_edge_recon_loss: 40633556.0000; val_gene_expr_recon_loss: 6822327.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17848888.0000; val_global_loss: 65312288.0000; val_optim_loss: 65312288.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9048; val_auprc_score: 0.9166; val_best_acc_score: 0.5221; val_best_f1_score: 0.6762; train_kl_reg_loss: 5147.3468; train_edge_recon_loss: 34704188.0000; train_gene_expr_recon_loss: 6934598.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17416035.5556; train_global_loss: 59059968.8889; train_optim_loss: 59059968.8889; val_kl_reg_loss: 3418.3032; val_edge_recon_loss: 40629580.0000; val_gene_expr_recon_loss: 6972410.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17215600.0000; val_global_loss: 64821008.0000; val_optim_loss: 64821008.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9012; val_auprc_score: 0.9114; val_best_acc_score: 0.5121; val_best_f1_score: 0.6721; train_kl_reg_loss: 6675.5806; train_edge_recon_loss: 34714702.2222; train_gene_expr_recon_loss: 6835340.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17209506.0000; train_global_loss: 58766224.4444; train_optim_loss: 58766224.4444; val_kl_reg_loss: 10852.6426; val_edge_recon_loss: 40644384.0000; val_gene_expr_recon_loss: 6578970.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17200408.0000; val_global_loss: 64434616.0000; val_optim_loss: 64434616.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9021; val_auprc_score: 0.9162; val_best_acc_score: 0.5146; val_best_f1_score: 0.6731; train_kl_reg_loss: 24384.1658; train_edge_recon_loss: 34735832.0000; train_gene_expr_recon_loss: 6499045.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17137117.1111; train_global_loss: 58396379.1111; train_optim_loss: 58396379.1111; val_kl_reg_loss: 29086.2559; val_edge_recon_loss: 40644100.0000; val_gene_expr_recon_loss: 6350141.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17016884.0000; val_global_loss: 64040212.0000; val_optim_loss: 64040212.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8944; val_auprc_score: 0.9062; val_best_acc_score: 0.5158; val_best_f1_score: 0.6737; train_kl_reg_loss: 41992.4544; train_edge_recon_loss: 34733518.6667; train_gene_expr_recon_loss: 6277178.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16931473.5556; train_global_loss: 57984163.1111; train_optim_loss: 57984163.1111; val_kl_reg_loss: 36299.3516; val_edge_recon_loss: 40646004.0000; val_gene_expr_recon_loss: 6153125.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16823522.0000; val_global_loss: 63658952.0000; val_optim_loss: 63658952.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8959; val_auprc_score: 0.9076; val_best_acc_score: 0.5067; val_best_f1_score: 0.6697; train_kl_reg_loss: 63631.0651; train_edge_recon_loss: 34754132.8889; train_gene_expr_recon_loss: 6065068.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16805919.5556; train_global_loss: 57688752.0000; train_optim_loss: 57688752.0000; val_kl_reg_loss: 73708.8438; val_edge_recon_loss: 40651480.0000; val_gene_expr_recon_loss: 5833567.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16669713.0000; val_global_loss: 63228468.0000; val_optim_loss: 63228468.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8916; val_auprc_score: 0.9011; val_best_acc_score: 0.5081; val_best_f1_score: 0.6703; train_kl_reg_loss: 99145.2283; train_edge_recon_loss: 34715461.3333; train_gene_expr_recon_loss: 5737082.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16634157.1111; train_global_loss: 57185846.2222; train_optim_loss: 57185846.2222; val_kl_reg_loss: 101628.6875; val_edge_recon_loss: 40651828.0000; val_gene_expr_recon_loss: 5567437.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16569976.0000; val_global_loss: 62890868.0000; val_optim_loss: 62890868.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8899; val_auprc_score: 0.8976; val_best_acc_score: 0.5069; val_best_f1_score: 0.6697; train_kl_reg_loss: 129241.3854; train_edge_recon_loss: 34715377.7778; train_gene_expr_recon_loss: 5472095.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16394546.5556; train_global_loss: 56711260.0000; train_optim_loss: 56711260.0000; val_kl_reg_loss: 146818.5625; val_edge_recon_loss: 40652232.0000; val_gene_expr_recon_loss: 5299552.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16336676.0000; val_global_loss: 62435280.0000; val_optim_loss: 62435280.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8854; val_auprc_score: 0.8934; val_best_acc_score: 0.5101; val_best_f1_score: 0.6712; train_kl_reg_loss: 151981.4618; train_edge_recon_loss: 34722139.1111; train_gene_expr_recon_loss: 5246080.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16364217.4444; train_global_loss: 56484418.2222; train_optim_loss: 56484418.2222; val_kl_reg_loss: 92747.0625; val_edge_recon_loss: 40650356.0000; val_gene_expr_recon_loss: 5083412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16158356.0000; val_global_loss: 61984872.0000; val_optim_loss: 61984872.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8801; val_auprc_score: 0.8894; val_best_acc_score: 0.5093; val_best_f1_score: 0.6708; train_kl_reg_loss: 133480.1415; train_edge_recon_loss: 34759844.8889; train_gene_expr_recon_loss: 4963243.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16048674.8889; train_global_loss: 55905243.1111; train_optim_loss: 55905243.1111; val_kl_reg_loss: 113845.8438; val_edge_recon_loss: 40650144.0000; val_gene_expr_recon_loss: 4832432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16069288.0000; val_global_loss: 61665708.0000; val_optim_loss: 61665708.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8747; val_auprc_score: 0.8820; val_best_acc_score: 0.5085; val_best_f1_score: 0.6705; train_kl_reg_loss: 152949.8238; train_edge_recon_loss: 34739476.4444; train_gene_expr_recon_loss: 4753712.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16030526.3333; train_global_loss: 55676664.8889; train_optim_loss: 55676664.8889; val_kl_reg_loss: 147788.6250; val_edge_recon_loss: 40648852.0000; val_gene_expr_recon_loss: 4619307.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15953308.0000; val_global_loss: 61369256.0000; val_optim_loss: 61369256.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8632; val_auprc_score: 0.8728; val_best_acc_score: 0.5096; val_best_f1_score: 0.6709; train_kl_reg_loss: 155186.2969; train_edge_recon_loss: 34711753.7778; train_gene_expr_recon_loss: 4564177.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15944653.8889; train_global_loss: 55375771.1111; train_optim_loss: 55375771.1111; val_kl_reg_loss: 121129.0312; val_edge_recon_loss: 40648300.0000; val_gene_expr_recon_loss: 4471074.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15820040.0000; val_global_loss: 61060544.0000; val_optim_loss: 61060544.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8641; val_auprc_score: 0.8713; val_best_acc_score: 0.5131; val_best_f1_score: 0.6725; train_kl_reg_loss: 153445.5182; train_edge_recon_loss: 34746136.0000; train_gene_expr_recon_loss: 4418780.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15796711.5556; train_global_loss: 55115073.3333; train_optim_loss: 55115073.3333; val_kl_reg_loss: 111170.4609; val_edge_recon_loss: 40644724.0000; val_gene_expr_recon_loss: 4333399.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15710750.0000; val_global_loss: 60800048.0000; val_optim_loss: 60800048.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8575; val_auprc_score: 0.8623; val_best_acc_score: 0.5199; val_best_f1_score: 0.6756; train_kl_reg_loss: 146732.0946; train_edge_recon_loss: 34738506.6667; train_gene_expr_recon_loss: 4269813.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15676121.4444; train_global_loss: 54831173.3333; train_optim_loss: 54831173.3333; val_kl_reg_loss: 139149.7500; val_edge_recon_loss: 40641004.0000; val_gene_expr_recon_loss: 4212447.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15635382.0000; val_global_loss: 60627984.0000; val_optim_loss: 60627984.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8497; val_auprc_score: 0.8543; val_best_acc_score: 0.5340; val_best_f1_score: 0.6819; train_kl_reg_loss: 154468.0955; train_edge_recon_loss: 34734852.0000; train_gene_expr_recon_loss: 4195511.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15649369.3333; train_global_loss: 54734200.4444; train_optim_loss: 54734200.4444; val_kl_reg_loss: 117172.9219; val_edge_recon_loss: 40632928.0000; val_gene_expr_recon_loss: 4150589.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15548860.0000; val_global_loss: 60449548.0000; val_optim_loss: 60449548.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8604; val_auprc_score: 0.8634; val_best_acc_score: 0.5484; val_best_f1_score: 0.6884; train_kl_reg_loss: 147820.4540; train_edge_recon_loss: 34723688.4444; train_gene_expr_recon_loss: 4098669.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15475168.7778; train_global_loss: 54445347.5556; train_optim_loss: 54445347.5556; val_kl_reg_loss: 161659.7656; val_edge_recon_loss: 40625992.0000; val_gene_expr_recon_loss: 4060132.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15534490.0000; val_global_loss: 60382272.0000; val_optim_loss: 60382272.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8556; val_auprc_score: 0.8513; val_best_acc_score: 0.5954; val_best_f1_score: 0.7109; train_kl_reg_loss: 151745.2847; train_edge_recon_loss: 34720419.5556; train_gene_expr_recon_loss: 4056533.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15467427.3333; train_global_loss: 54396125.7778; train_optim_loss: 54396125.7778; val_kl_reg_loss: 113877.2188; val_edge_recon_loss: 40605352.0000; val_gene_expr_recon_loss: 4037827.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15467018.0000; val_global_loss: 60224072.0000; val_optim_loss: 60224072.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8776; val_auprc_score: 0.8723; val_best_acc_score: 0.6738; val_best_f1_score: 0.7514; train_kl_reg_loss: 155307.0278; train_edge_recon_loss: 34699098.6667; train_gene_expr_recon_loss: 4028549.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15508962.0000; train_global_loss: 54391916.8889; train_optim_loss: 54391916.8889; val_kl_reg_loss: 107122.3594; val_edge_recon_loss: 40554632.0000; val_gene_expr_recon_loss: 4019769.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15456282.0000; val_global_loss: 60137808.0000; val_optim_loss: 60137808.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8845; val_auprc_score: 0.8724; val_best_acc_score: 0.7641; val_best_f1_score: 0.8025; train_kl_reg_loss: 158811.7526; train_edge_recon_loss: 34639500.4444; train_gene_expr_recon_loss: 4008138.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15424161.2222; train_global_loss: 54230611.5556; train_optim_loss: 54230611.5556; val_kl_reg_loss: 123796.7188; val_edge_recon_loss: 40437824.0000; val_gene_expr_recon_loss: 3981977.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15419434.0000; val_global_loss: 59963032.0000; val_optim_loss: 59963032.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8888; val_auprc_score: 0.8699; val_best_acc_score: 0.8104; val_best_f1_score: 0.8237; train_kl_reg_loss: 162528.7135; train_edge_recon_loss: 34559407.5556; train_gene_expr_recon_loss: 3990949.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15455502.0000; train_global_loss: 54168387.1111; train_optim_loss: 54168387.1111; val_kl_reg_loss: 128546.3906; val_edge_recon_loss: 40098692.0000; val_gene_expr_recon_loss: 3973225.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15402266.0000; val_global_loss: 59602728.0000; val_optim_loss: 59602728.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8920; val_auprc_score: 0.8720; val_best_acc_score: 0.8015; val_best_f1_score: 0.8291; train_kl_reg_loss: 171004.7899; train_edge_recon_loss: 34414915.5556; train_gene_expr_recon_loss: 3976162.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15423265.8889; train_global_loss: 53985350.2222; train_optim_loss: 53985350.2222; val_kl_reg_loss: 116495.7656; val_edge_recon_loss: 38667472.0000; val_gene_expr_recon_loss: 4005693.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15456664.0000; val_global_loss: 58246324.0000; val_optim_loss: 58246324.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8866; val_auprc_score: 0.8555; val_best_acc_score: 0.8158; val_best_f1_score: 0.8347; train_kl_reg_loss: 141118.2066; train_edge_recon_loss: 34068607.5556; train_gene_expr_recon_loss: 4010027.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15481955.6667; train_global_loss: 53701709.7778; train_optim_loss: 53701709.7778; val_kl_reg_loss: 108506.7969; val_edge_recon_loss: 35009036.0000; val_gene_expr_recon_loss: 4077138.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15538705.0000; val_global_loss: 54733384.0000; val_optim_loss: 54733384.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8601; val_auprc_score: 0.8361; val_best_acc_score: 0.7778; val_best_f1_score: 0.8008; train_kl_reg_loss: 51150.6364; train_edge_recon_loss: 32976859.1111; train_gene_expr_recon_loss: 4169402.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15657669.7778; train_global_loss: 52855081.7778; train_optim_loss: 52855081.7778; val_kl_reg_loss: 10558.5332; val_edge_recon_loss: 30247170.0000; val_gene_expr_recon_loss: 4454147.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15873786.0000; val_global_loss: 50585664.0000; val_optim_loss: 50585664.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8696; val_auprc_score: 0.8525; val_best_acc_score: 0.7711; val_best_f1_score: 0.7971; train_kl_reg_loss: 15193.5394; train_edge_recon_loss: 29479876.2222; train_gene_expr_recon_loss: 4507145.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15968804.8889; train_global_loss: 49971019.1111; train_optim_loss: 49971019.1111; val_kl_reg_loss: 22086.1250; val_edge_recon_loss: 28559554.0000; val_gene_expr_recon_loss: 4426176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15995286.0000; val_global_loss: 49003104.0000; val_optim_loss: 49003104.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8732; val_auprc_score: 0.8542; val_best_acc_score: 0.7833; val_best_f1_score: 0.8072; train_kl_reg_loss: 28271.6914; train_edge_recon_loss: 28756522.4444; train_gene_expr_recon_loss: 4354917.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15906382.3333; train_global_loss: 49046093.7778; train_optim_loss: 49046093.7778; val_kl_reg_loss: 32654.8398; val_edge_recon_loss: 28490510.0000; val_gene_expr_recon_loss: 4311102.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15784717.0000; val_global_loss: 48618984.0000; val_optim_loss: 48618984.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8856; val_auprc_score: 0.8647; val_best_acc_score: 0.7974; val_best_f1_score: 0.8119; train_kl_reg_loss: 39206.5165; train_edge_recon_loss: 28450421.7778; train_gene_expr_recon_loss: 4298840.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15773670.1111; train_global_loss: 48562138.2222; train_optim_loss: 48562138.2222; val_kl_reg_loss: 37421.9141; val_edge_recon_loss: 28173786.0000; val_gene_expr_recon_loss: 4251043.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15772690.0000; val_global_loss: 48234944.0000; val_optim_loss: 48234944.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8930; val_auprc_score: 0.8719; val_best_acc_score: 0.8106; val_best_f1_score: 0.8241; train_kl_reg_loss: 45577.4119; train_edge_recon_loss: 28331314.8889; train_gene_expr_recon_loss: 4224479.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15647332.2222; train_global_loss: 48248704.4444; train_optim_loss: 48248704.4444; val_kl_reg_loss: 42021.0312; val_edge_recon_loss: 27966902.0000; val_gene_expr_recon_loss: 4201436.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15703346.0000; val_global_loss: 47913704.0000; val_optim_loss: 47913704.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9010; val_auprc_score: 0.8742; val_best_acc_score: 0.8240; val_best_f1_score: 0.8375; train_kl_reg_loss: 50587.2951; train_edge_recon_loss: 28063504.6667; train_gene_expr_recon_loss: 4151324.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15610625.1111; train_global_loss: 47876041.3333; train_optim_loss: 47876041.3333; val_kl_reg_loss: 46017.5977; val_edge_recon_loss: 27797908.0000; val_gene_expr_recon_loss: 4170864.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15662382.0000; val_global_loss: 47677172.0000; val_optim_loss: 47677172.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9087; val_auprc_score: 0.8817; val_best_acc_score: 0.8413; val_best_f1_score: 0.8534; train_kl_reg_loss: 54806.8498; train_edge_recon_loss: 27852478.4444; train_gene_expr_recon_loss: 4150135.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15611465.0000; train_global_loss: 47668885.7778; train_optim_loss: 47668885.7778; val_kl_reg_loss: 48803.0117; val_edge_recon_loss: 27958206.0000; val_gene_expr_recon_loss: 4139440.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15612550.0000; val_global_loss: 47759000.0000; val_optim_loss: 47759000.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9231; val_auprc_score: 0.8987; val_best_acc_score: 0.8611; val_best_f1_score: 0.8691; train_kl_reg_loss: 58928.8546; train_edge_recon_loss: 27583341.3333; train_gene_expr_recon_loss: 4109576.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15518714.5556; train_global_loss: 47270561.7778; train_optim_loss: 47270561.7778; val_kl_reg_loss: 52391.2266; val_edge_recon_loss: 27404844.0000; val_gene_expr_recon_loss: 4093648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15558591.0000; val_global_loss: 47109476.0000; val_optim_loss: 47109476.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9254; val_auprc_score: 0.8988; val_best_acc_score: 0.8673; val_best_f1_score: 0.8775; train_kl_reg_loss: 64482.5451; train_edge_recon_loss: 27398833.3333; train_gene_expr_recon_loss: 4056144.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15483859.8889; train_global_loss: 47003320.8889; train_optim_loss: 47003320.8889; val_kl_reg_loss: 58559.0312; val_edge_recon_loss: 27294478.0000; val_gene_expr_recon_loss: 4083904.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15568604.0000; val_global_loss: 47005544.0000; val_optim_loss: 47005544.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9286; val_auprc_score: 0.9080; val_best_acc_score: 0.8693; val_best_f1_score: 0.8788; train_kl_reg_loss: 72065.4592; train_edge_recon_loss: 27216820.8889; train_gene_expr_recon_loss: 4054494.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15511483.8889; train_global_loss: 46854865.3333; train_optim_loss: 46854865.3333; val_kl_reg_loss: 63975.2266; val_edge_recon_loss: 27460084.0000; val_gene_expr_recon_loss: 4057331.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15514296.0000; val_global_loss: 47095688.0000; val_optim_loss: 47095688.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9351; val_auprc_score: 0.9143; val_best_acc_score: 0.8787; val_best_f1_score: 0.8875; train_kl_reg_loss: 80591.3932; train_edge_recon_loss: 27115807.3333; train_gene_expr_recon_loss: 4058044.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15649334.0000; train_global_loss: 46903776.8889; train_optim_loss: 46903776.8889; val_kl_reg_loss: 68286.5625; val_edge_recon_loss: 27371418.0000; val_gene_expr_recon_loss: 4004188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15992151.0000; val_global_loss: 47436044.0000; val_optim_loss: 47436044.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9362; val_auprc_score: 0.9145; val_best_acc_score: 0.8786; val_best_f1_score: 0.8864; train_kl_reg_loss: 82120.0747; train_edge_recon_loss: 27645869.5556; train_gene_expr_recon_loss: 4054311.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15703681.8889; train_global_loss: 47485982.2222; train_optim_loss: 47485982.2222; val_kl_reg_loss: 69042.8047; val_edge_recon_loss: 27869680.0000; val_gene_expr_recon_loss: 4021032.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15620721.0000; val_global_loss: 47580476.0000; val_optim_loss: 47580476.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9265; val_auprc_score: 0.9004; val_best_acc_score: 0.8593; val_best_f1_score: 0.8708; train_kl_reg_loss: 77727.0269; train_edge_recon_loss: 27884879.3333; train_gene_expr_recon_loss: 4017262.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15428212.7778; train_global_loss: 47408082.2222; train_optim_loss: 47408082.2222; val_kl_reg_loss: 68622.6016; val_edge_recon_loss: 27834588.0000; val_gene_expr_recon_loss: 4027371.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15475058.0000; val_global_loss: 47405640.0000; val_optim_loss: 47405640.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9257; val_auprc_score: 0.8985; val_best_acc_score: 0.8623; val_best_f1_score: 0.8723; train_kl_reg_loss: 79620.2075; train_edge_recon_loss: 27694330.4444; train_gene_expr_recon_loss: 4024146.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15398040.2222; train_global_loss: 47196137.7778; train_optim_loss: 47196137.7778; val_kl_reg_loss: 66809.8438; val_edge_recon_loss: 27616724.0000; val_gene_expr_recon_loss: 4006924.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15479501.0000; val_global_loss: 47169960.0000; val_optim_loss: 47169960.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9284; val_auprc_score: 0.9067; val_best_acc_score: 0.8639; val_best_f1_score: 0.8724; train_kl_reg_loss: 78149.5382; train_edge_recon_loss: 27613287.3333; train_gene_expr_recon_loss: 4007929.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15459199.0000; train_global_loss: 47158565.7778; train_optim_loss: 47158565.7778; val_kl_reg_loss: 66144.3125; val_edge_recon_loss: 27778756.0000; val_gene_expr_recon_loss: 3990190.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15446578.0000; val_global_loss: 47281668.0000; val_optim_loss: 47281668.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9282; val_auprc_score: 0.9058; val_best_acc_score: 0.8631; val_best_f1_score: 0.8734; train_kl_reg_loss: 77675.3099; train_edge_recon_loss: 27506290.4444; train_gene_expr_recon_loss: 3994108.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15495656.1111; train_global_loss: 47073731.5556; train_optim_loss: 47073731.5556; val_kl_reg_loss: 65349.1328; val_edge_recon_loss: 27700772.0000; val_gene_expr_recon_loss: 3973763.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15409194.0000; val_global_loss: 47149080.0000; val_optim_loss: 47149080.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9290; val_auprc_score: 0.9064; val_best_acc_score: 0.8659; val_best_f1_score: 0.8748; train_kl_reg_loss: 77317.0634; train_edge_recon_loss: 27489773.1111; train_gene_expr_recon_loss: 3992181.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15418432.7778; train_global_loss: 46977704.4444; train_optim_loss: 46977704.4444; val_kl_reg_loss: 65528.8125; val_edge_recon_loss: 27746444.0000; val_gene_expr_recon_loss: 3970452.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15420945.0000; val_global_loss: 47203368.0000; val_optim_loss: 47203368.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 45 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9213
val AUPRC score: 0.8937
val best accuracy score: 0.8631
val best F1 score: 0.8739
val target rna MSE score: 3.0826
val source rna MSE score: 2.4859
val target atac MSE score: 0.7873
val source atac MSE score: 0.0198
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
