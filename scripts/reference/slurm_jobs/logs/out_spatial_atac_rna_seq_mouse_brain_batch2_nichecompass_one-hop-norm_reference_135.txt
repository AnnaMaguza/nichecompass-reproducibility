[True]
Run timestamp: 07082023_213822_135.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_135']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8736; val_auprc_score: 0.8909; val_best_acc_score: 0.5189; val_best_f1_score: 0.6751; train_kl_reg_loss: 45284.4566; train_edge_recon_loss: 3476526.2778; train_gene_expr_recon_loss: 1220464.6389; train_masked_gp_l1_reg_loss: 16630.8244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167127.1736; train_chrom_access_recon_loss: 2495979.5417; train_global_loss: 7422012.7778; train_optim_loss: 7422012.7778; val_kl_reg_loss: 18643.7305; val_edge_recon_loss: 4064122.7500; val_gene_expr_recon_loss: 1098626.0000; val_masked_gp_l1_reg_loss: 12774.5215; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162728.6250; val_chrom_access_recon_loss: 1616644.3750; val_global_loss: 6973540.0000; val_optim_loss: 6973540.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8657; val_auprc_score: 0.8820; val_best_acc_score: 0.5253; val_best_f1_score: 0.6777; train_kl_reg_loss: 15170.5803; train_edge_recon_loss: 3476994.3333; train_gene_expr_recon_loss: 990764.2083; train_masked_gp_l1_reg_loss: 11257.9123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159937.1615; train_chrom_access_recon_loss: 1497544.2778; train_global_loss: 6151668.5556; train_optim_loss: 6151668.5556; val_kl_reg_loss: 14762.5332; val_edge_recon_loss: 4063651.2500; val_gene_expr_recon_loss: 898633.2500; val_masked_gp_l1_reg_loss: 10006.5762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156481.0625; val_chrom_access_recon_loss: 1427274.8750; val_global_loss: 6570809.5000; val_optim_loss: 6570809.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8539; val_auprc_score: 0.8686; val_best_acc_score: 0.5311; val_best_f1_score: 0.6802; train_kl_reg_loss: 15696.6224; train_edge_recon_loss: 3479850.9167; train_gene_expr_recon_loss: 856256.2083; train_masked_gp_l1_reg_loss: 9828.4643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153574.1354; train_chrom_access_recon_loss: 1400459.6944; train_global_loss: 5915665.9444; train_optim_loss: 5915665.9444; val_kl_reg_loss: 16971.7734; val_edge_recon_loss: 4063362.0000; val_gene_expr_recon_loss: 832114.1250; val_masked_gp_l1_reg_loss: 9646.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149731.9375; val_chrom_access_recon_loss: 1391390.0000; val_global_loss: 6463217.0000; val_optim_loss: 6463217.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8537; val_auprc_score: 0.8700; val_best_acc_score: 0.5445; val_best_f1_score: 0.6858; train_kl_reg_loss: 17473.1046; train_edge_recon_loss: 3479788.9167; train_gene_expr_recon_loss: 811876.7639; train_masked_gp_l1_reg_loss: 9399.9100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146306.4653; train_chrom_access_recon_loss: 1374458.6250; train_global_loss: 5839303.9444; train_optim_loss: 5839303.9444; val_kl_reg_loss: 18496.9375; val_edge_recon_loss: 4062267.5000; val_gene_expr_recon_loss: 801691.5000; val_masked_gp_l1_reg_loss: 9125.5752; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141835.2969; val_chrom_access_recon_loss: 1373493.5000; val_global_loss: 6406910.5000; val_optim_loss: 6406910.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8578; val_auprc_score: 0.8631; val_best_acc_score: 0.5733; val_best_f1_score: 0.6983; train_kl_reg_loss: 19034.7216; train_edge_recon_loss: 3480727.3889; train_gene_expr_recon_loss: 786914.5417; train_masked_gp_l1_reg_loss: 8986.6687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138045.5434; train_chrom_access_recon_loss: 1361469.0556; train_global_loss: 5795177.6667; train_optim_loss: 5795177.6667; val_kl_reg_loss: 19667.7578; val_edge_recon_loss: 4059201.2500; val_gene_expr_recon_loss: 778363.1875; val_masked_gp_l1_reg_loss: 8824.1465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133229.6250; val_chrom_access_recon_loss: 1363147.3750; val_global_loss: 6362433.0000; val_optim_loss: 6362433.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8605; val_auprc_score: 0.8590; val_best_acc_score: 0.6288; val_best_f1_score: 0.7228; train_kl_reg_loss: 20511.4779; train_edge_recon_loss: 3480547.6111; train_gene_expr_recon_loss: 766144.5625; train_masked_gp_l1_reg_loss: 8745.5985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129295.8819; train_chrom_access_recon_loss: 1354131.2222; train_global_loss: 5759376.1111; train_optim_loss: 5759376.1111; val_kl_reg_loss: 19295.8027; val_edge_recon_loss: 4051344.7500; val_gene_expr_recon_loss: 760470.1875; val_masked_gp_l1_reg_loss: 8644.9834; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124363.9453; val_chrom_access_recon_loss: 1355058.2500; val_global_loss: 6319178.0000; val_optim_loss: 6319178.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8821; val_auprc_score: 0.8772; val_best_acc_score: 0.7487; val_best_f1_score: 0.7885; train_kl_reg_loss: 20605.2617; train_edge_recon_loss: 3480954.1389; train_gene_expr_recon_loss: 747820.2083; train_masked_gp_l1_reg_loss: 8604.8649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120448.3776; train_chrom_access_recon_loss: 1343062.6806; train_global_loss: 5721495.5000; train_optim_loss: 5721495.5000; val_kl_reg_loss: 19323.4414; val_edge_recon_loss: 4036916.5000; val_gene_expr_recon_loss: 744846.1250; val_masked_gp_l1_reg_loss: 8553.7832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115588.4766; val_chrom_access_recon_loss: 1349157.1250; val_global_loss: 6274385.5000; val_optim_loss: 6274385.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8903; val_auprc_score: 0.8783; val_best_acc_score: 0.8195; val_best_f1_score: 0.8250; train_kl_reg_loss: 20876.6000; train_edge_recon_loss: 3476694.6389; train_gene_expr_recon_loss: 735195.9028; train_masked_gp_l1_reg_loss: 8534.6395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111784.7413; train_chrom_access_recon_loss: 1338362.8611; train_global_loss: 5691449.3889; train_optim_loss: 5691449.3889; val_kl_reg_loss: 18788.5273; val_edge_recon_loss: 4003967.7500; val_gene_expr_recon_loss: 733004.6875; val_masked_gp_l1_reg_loss: 8504.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107099.6797; val_chrom_access_recon_loss: 1343633.0000; val_global_loss: 6214998.0000; val_optim_loss: 6214998.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8849; val_auprc_score: 0.8689; val_best_acc_score: 0.7700; val_best_f1_score: 0.8008; train_kl_reg_loss: 18862.0922; train_edge_recon_loss: 3469586.8333; train_gene_expr_recon_loss: 727693.3542; train_masked_gp_l1_reg_loss: 8503.2074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103494.3889; train_chrom_access_recon_loss: 1340745.1667; train_global_loss: 5668885.0556; train_optim_loss: 5668885.0556; val_kl_reg_loss: 15370.9688; val_edge_recon_loss: 3922165.2500; val_gene_expr_recon_loss: 728258.3125; val_masked_gp_l1_reg_loss: 8502.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99084.5234; val_chrom_access_recon_loss: 1340442.0000; val_global_loss: 6113823.5000; val_optim_loss: 6113823.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8991; val_auprc_score: 0.8822; val_best_acc_score: 0.8224; val_best_f1_score: 0.8304; train_kl_reg_loss: 14073.0484; train_edge_recon_loss: 3439445.5556; train_gene_expr_recon_loss: 726249.8958; train_masked_gp_l1_reg_loss: 8533.0084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95739.1276; train_chrom_access_recon_loss: 1335824.5833; train_global_loss: 5619865.2778; train_optim_loss: 5619865.2778; val_kl_reg_loss: 9975.2129; val_edge_recon_loss: 3635091.0000; val_gene_expr_recon_loss: 732263.0000; val_masked_gp_l1_reg_loss: 8560.8662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91675.8516; val_chrom_access_recon_loss: 1340331.2500; val_global_loss: 5817897.0000; val_optim_loss: 5817897.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8890; val_auprc_score: 0.8726; val_best_acc_score: 0.8072; val_best_f1_score: 0.8209; train_kl_reg_loss: 9505.4206; train_edge_recon_loss: 3248336.5278; train_gene_expr_recon_loss: 748502.1319; train_masked_gp_l1_reg_loss: 8609.0314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88660.7422; train_chrom_access_recon_loss: 1346585.3889; train_global_loss: 5450199.3333; train_optim_loss: 5450199.3333; val_kl_reg_loss: 12670.3477; val_edge_recon_loss: 2963163.2500; val_gene_expr_recon_loss: 788545.5625; val_masked_gp_l1_reg_loss: 8680.1699; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85064.1406; val_chrom_access_recon_loss: 1358239.2500; val_global_loss: 5216363.0000; val_optim_loss: 5216363.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9036; val_auprc_score: 0.8796; val_best_acc_score: 0.8359; val_best_f1_score: 0.8477; train_kl_reg_loss: 22673.2097; train_edge_recon_loss: 2852502.3889; train_gene_expr_recon_loss: 791280.5486; train_masked_gp_l1_reg_loss: 8719.9283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82500.8906; train_chrom_access_recon_loss: 1355605.0694; train_global_loss: 5113282.0556; train_optim_loss: 5113282.0556; val_kl_reg_loss: 33875.0703; val_edge_recon_loss: 2815137.2500; val_gene_expr_recon_loss: 778045.8750; val_masked_gp_l1_reg_loss: 8754.3887; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79467.3828; val_chrom_access_recon_loss: 1350518.0000; val_global_loss: 5065798.0000; val_optim_loss: 5065798.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9156; val_auprc_score: 0.8846; val_best_acc_score: 0.8558; val_best_f1_score: 0.8669; train_kl_reg_loss: 41061.5217; train_edge_recon_loss: 2758043.7500; train_gene_expr_recon_loss: 759896.4861; train_masked_gp_l1_reg_loss: 8756.4779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77238.4462; train_chrom_access_recon_loss: 1338563.4306; train_global_loss: 4983560.2778; train_optim_loss: 4983560.2778; val_kl_reg_loss: 47330.7617; val_edge_recon_loss: 2759116.0000; val_gene_expr_recon_loss: 756905.8750; val_masked_gp_l1_reg_loss: 8742.7363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74492.7109; val_chrom_access_recon_loss: 1340333.5000; val_global_loss: 4986921.5000; val_optim_loss: 4986921.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9162; val_auprc_score: 0.8901; val_best_acc_score: 0.8546; val_best_f1_score: 0.8635; train_kl_reg_loss: 48877.7400; train_edge_recon_loss: 2746613.4167; train_gene_expr_recon_loss: 739553.7361; train_masked_gp_l1_reg_loss: 8702.6059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72365.7587; train_chrom_access_recon_loss: 1330285.4306; train_global_loss: 4946398.7222; train_optim_loss: 4946398.7222; val_kl_reg_loss: 49694.1758; val_edge_recon_loss: 2797713.2500; val_gene_expr_recon_loss: 742536.9375; val_masked_gp_l1_reg_loss: 8660.7334; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69755.6328; val_chrom_access_recon_loss: 1334472.2500; val_global_loss: 5002833.0000; val_optim_loss: 5002833.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9236; val_auprc_score: 0.8988; val_best_acc_score: 0.8636; val_best_f1_score: 0.8735; train_kl_reg_loss: 48060.6089; train_edge_recon_loss: 2738872.2500; train_gene_expr_recon_loss: 731187.1944; train_masked_gp_l1_reg_loss: 8628.7099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67763.8602; train_chrom_access_recon_loss: 1323201.1667; train_global_loss: 4917713.7222; train_optim_loss: 4917713.7222; val_kl_reg_loss: 46364.3516; val_edge_recon_loss: 2742006.7500; val_gene_expr_recon_loss: 736212.6250; val_masked_gp_l1_reg_loss: 8588.3652; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65322.4180; val_chrom_access_recon_loss: 1329811.2500; val_global_loss: 4928305.5000; val_optim_loss: 4928305.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9273; val_auprc_score: 0.9065; val_best_acc_score: 0.8639; val_best_f1_score: 0.8735; train_kl_reg_loss: 44809.4180; train_edge_recon_loss: 2736259.6667; train_gene_expr_recon_loss: 724621.5278; train_masked_gp_l1_reg_loss: 8566.4082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63480.3720; train_chrom_access_recon_loss: 1322868.8611; train_global_loss: 4900606.2778; train_optim_loss: 4900606.2778; val_kl_reg_loss: 43473.0234; val_edge_recon_loss: 2755507.7500; val_gene_expr_recon_loss: 729821.0000; val_masked_gp_l1_reg_loss: 8546.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61241.0938; val_chrom_access_recon_loss: 1327319.6250; val_global_loss: 4925909.0000; val_optim_loss: 4925909.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9317; val_auprc_score: 0.9099; val_best_acc_score: 0.8739; val_best_f1_score: 0.8823; train_kl_reg_loss: 43980.2331; train_edge_recon_loss: 2720766.1111; train_gene_expr_recon_loss: 719967.8056; train_masked_gp_l1_reg_loss: 8540.3219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59571.1250; train_chrom_access_recon_loss: 1321725.4306; train_global_loss: 4874551.0556; train_optim_loss: 4874551.0556; val_kl_reg_loss: 43082.1484; val_edge_recon_loss: 2726386.0000; val_gene_expr_recon_loss: 726061.3750; val_masked_gp_l1_reg_loss: 8540.6035; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57540.4219; val_chrom_access_recon_loss: 1324146.6250; val_global_loss: 4885757.0000; val_optim_loss: 4885757.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9397; val_auprc_score: 0.9238; val_best_acc_score: 0.8797; val_best_f1_score: 0.8874; train_kl_reg_loss: 43929.0113; train_edge_recon_loss: 2730342.9167; train_gene_expr_recon_loss: 719076.6042; train_masked_gp_l1_reg_loss: 8544.5920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56029.2908; train_chrom_access_recon_loss: 1314119.5278; train_global_loss: 4872042.0000; train_optim_loss: 4872042.0000; val_kl_reg_loss: 43616.0625; val_edge_recon_loss: 2732300.2500; val_gene_expr_recon_loss: 720786.1250; val_masked_gp_l1_reg_loss: 8552.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54196.3594; val_chrom_access_recon_loss: 1320570.0000; val_global_loss: 4880021.0000; val_optim_loss: 4880021.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9400; val_auprc_score: 0.9236; val_best_acc_score: 0.8782; val_best_f1_score: 0.8879; train_kl_reg_loss: 42994.4674; train_edge_recon_loss: 2725226.0278; train_gene_expr_recon_loss: 712062.4167; train_masked_gp_l1_reg_loss: 8567.8674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52828.8121; train_chrom_access_recon_loss: 1312186.2500; train_global_loss: 4853865.9444; train_optim_loss: 4853865.9444; val_kl_reg_loss: 41847.3047; val_edge_recon_loss: 2721022.0000; val_gene_expr_recon_loss: 718373.6875; val_masked_gp_l1_reg_loss: 8569.2100; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51155.1367; val_chrom_access_recon_loss: 1318904.5000; val_global_loss: 4859872.0000; val_optim_loss: 4859872.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9393; val_auprc_score: 0.9153; val_best_acc_score: 0.8798; val_best_f1_score: 0.8876; train_kl_reg_loss: 42231.9253; train_edge_recon_loss: 2727123.3611; train_gene_expr_recon_loss: 711239.1736; train_masked_gp_l1_reg_loss: 8579.5326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49903.6510; train_chrom_access_recon_loss: 1308695.0417; train_global_loss: 4847772.7778; train_optim_loss: 4847772.7778; val_kl_reg_loss: 41316.4219; val_edge_recon_loss: 2735518.7500; val_gene_expr_recon_loss: 714252.5000; val_masked_gp_l1_reg_loss: 8590.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48371.3477; val_chrom_access_recon_loss: 1315973.0000; val_global_loss: 4864023.0000; val_optim_loss: 4864023.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9456; val_auprc_score: 0.9295; val_best_acc_score: 0.8879; val_best_f1_score: 0.8951; train_kl_reg_loss: 41896.5230; train_edge_recon_loss: 2711017.0278; train_gene_expr_recon_loss: 703284.5556; train_masked_gp_l1_reg_loss: 8603.7638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47228.1150; train_chrom_access_recon_loss: 1303341.0972; train_global_loss: 4815371.1111; train_optim_loss: 4815371.1111; val_kl_reg_loss: 41897.0469; val_edge_recon_loss: 2716565.7500; val_gene_expr_recon_loss: 712410.5000; val_masked_gp_l1_reg_loss: 8614.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45822.0508; val_chrom_access_recon_loss: 1313241.1250; val_global_loss: 4838551.0000; val_optim_loss: 4838551.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9457; val_auprc_score: 0.9247; val_best_acc_score: 0.8882; val_best_f1_score: 0.8954; train_kl_reg_loss: 42220.8572; train_edge_recon_loss: 2726581.0556; train_gene_expr_recon_loss: 705205.4444; train_masked_gp_l1_reg_loss: 8634.8663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44761.2869; train_chrom_access_recon_loss: 1311693.3889; train_global_loss: 4839096.8889; train_optim_loss: 4839096.8889; val_kl_reg_loss: 41501.1562; val_edge_recon_loss: 2728374.2500; val_gene_expr_recon_loss: 709945.7500; val_masked_gp_l1_reg_loss: 8669.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43465.3320; val_chrom_access_recon_loss: 1310664.5000; val_global_loss: 4842620.0000; val_optim_loss: 4842620.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9526; val_auprc_score: 0.9362; val_best_acc_score: 0.8968; val_best_f1_score: 0.9032; train_kl_reg_loss: 41137.7253; train_edge_recon_loss: 2720748.7778; train_gene_expr_recon_loss: 705340.9583; train_masked_gp_l1_reg_loss: 8695.9180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42491.8225; train_chrom_access_recon_loss: 1306511.7917; train_global_loss: 4824927.1111; train_optim_loss: 4824927.1111; val_kl_reg_loss: 40216.6172; val_edge_recon_loss: 2721727.5000; val_gene_expr_recon_loss: 706198.0000; val_masked_gp_l1_reg_loss: 8715.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41312.2852; val_chrom_access_recon_loss: 1308926.1250; val_global_loss: 4827096.0000; val_optim_loss: 4827096.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9512; val_auprc_score: 0.9333; val_best_acc_score: 0.8972; val_best_f1_score: 0.9038; train_kl_reg_loss: 40763.5464; train_edge_recon_loss: 2710646.0556; train_gene_expr_recon_loss: 699993.4306; train_masked_gp_l1_reg_loss: 8742.2861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40418.3207; train_chrom_access_recon_loss: 1300772.5972; train_global_loss: 4801336.0556; train_optim_loss: 4801336.0556; val_kl_reg_loss: 39715.5234; val_edge_recon_loss: 2732174.7500; val_gene_expr_recon_loss: 705356.1250; val_masked_gp_l1_reg_loss: 8760.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39319.5859; val_chrom_access_recon_loss: 1306569.3750; val_global_loss: 4831896.0000; val_optim_loss: 4831896.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9537; val_auprc_score: 0.9335; val_best_acc_score: 0.9037; val_best_f1_score: 0.9080; train_kl_reg_loss: 39989.6684; train_edge_recon_loss: 2719709.9444; train_gene_expr_recon_loss: 697775.0208; train_masked_gp_l1_reg_loss: 8778.9727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38499.0903; train_chrom_access_recon_loss: 1299467.1667; train_global_loss: 4804219.8333; train_optim_loss: 4804219.8333; val_kl_reg_loss: 39609.7891; val_edge_recon_loss: 2724483.0000; val_gene_expr_recon_loss: 702739.7500; val_masked_gp_l1_reg_loss: 8790.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37492.0000; val_chrom_access_recon_loss: 1305060.5000; val_global_loss: 4818176.0000; val_optim_loss: 4818176.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9566; val_auprc_score: 0.9419; val_best_acc_score: 0.9019; val_best_f1_score: 0.9064; train_kl_reg_loss: 38254.3889; train_edge_recon_loss: 2717081.2222; train_gene_expr_recon_loss: 1005009.6667; train_masked_gp_l1_reg_loss: 8799.3288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36487.6749; train_chrom_access_recon_loss: 1386930.1389; train_global_loss: 5192562.3889; train_optim_loss: 5192562.3889; val_kl_reg_loss: 12403.2607; val_edge_recon_loss: 2699202.2500; val_gene_expr_recon_loss: 1010510.1875; val_masked_gp_l1_reg_loss: 8783.0557; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35100.4336; val_chrom_access_recon_loss: 1392926.2500; val_global_loss: 5158925.5000; val_optim_loss: 5158925.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9589; val_auprc_score: 0.9425; val_best_acc_score: 0.9099; val_best_f1_score: 0.9134; train_kl_reg_loss: 33779.2556; train_edge_recon_loss: 2715517.6667; train_gene_expr_recon_loss: 991035.5139; train_masked_gp_l1_reg_loss: 8797.5699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33906.5948; train_chrom_access_recon_loss: 1375353.3889; train_global_loss: 5158390.1111; train_optim_loss: 5158390.1111; val_kl_reg_loss: 10430.2930; val_edge_recon_loss: 2721794.0000; val_gene_expr_recon_loss: 1002858.8750; val_masked_gp_l1_reg_loss: 8830.1660; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32417.6133; val_chrom_access_recon_loss: 1387700.6250; val_global_loss: 5164031.5000; val_optim_loss: 5164031.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9669; val_auprc_score: 0.9569; val_best_acc_score: 0.9174; val_best_f1_score: 0.9212; train_kl_reg_loss: 30024.7166; train_edge_recon_loss: 2696220.1667; train_gene_expr_recon_loss: 994117.0000; train_masked_gp_l1_reg_loss: 8858.7025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31274.8539; train_chrom_access_recon_loss: 1380240.1806; train_global_loss: 5140735.5556; train_optim_loss: 5140735.5556; val_kl_reg_loss: 10479.7471; val_edge_recon_loss: 2707826.7500; val_gene_expr_recon_loss: 994965.0000; val_masked_gp_l1_reg_loss: 8891.4365; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29885.9863; val_chrom_access_recon_loss: 1384979.6250; val_global_loss: 5137028.5000; val_optim_loss: 5137028.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9652; val_auprc_score: 0.9519; val_best_acc_score: 0.9192; val_best_f1_score: 0.9227; train_kl_reg_loss: 26962.7810; train_edge_recon_loss: 2686603.4722; train_gene_expr_recon_loss: 993725.8056; train_masked_gp_l1_reg_loss: 8918.9313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28853.3587; train_chrom_access_recon_loss: 1374329.3611; train_global_loss: 5119393.7222; train_optim_loss: 5119393.7222; val_kl_reg_loss: 9865.0801; val_edge_recon_loss: 2703042.2500; val_gene_expr_recon_loss: 998688.5000; val_masked_gp_l1_reg_loss: 8954.9424; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27613.4492; val_chrom_access_recon_loss: 1386125.6250; val_global_loss: 5134290.0000; val_optim_loss: 5134290.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9667; val_auprc_score: 0.9549; val_best_acc_score: 0.9200; val_best_f1_score: 0.9236; train_kl_reg_loss: 24756.0258; train_edge_recon_loss: 2676048.6944; train_gene_expr_recon_loss: 990253.3056; train_masked_gp_l1_reg_loss: 8891.3620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27430.5069; train_chrom_access_recon_loss: 1380233.1667; train_global_loss: 5107613.1111; train_optim_loss: 5107613.1111; val_kl_reg_loss: 9901.1348; val_edge_recon_loss: 2690698.5000; val_gene_expr_recon_loss: 995807.0000; val_masked_gp_l1_reg_loss: 8837.5557; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27224.9043; val_chrom_access_recon_loss: 1385402.6250; val_global_loss: 5117872.0000; val_optim_loss: 5117872.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9657; val_auprc_score: 0.9529; val_best_acc_score: 0.9165; val_best_f1_score: 0.9205; train_kl_reg_loss: 24393.9382; train_edge_recon_loss: 2661449.0278; train_gene_expr_recon_loss: 993529.3403; train_masked_gp_l1_reg_loss: 8828.1673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27096.9115; train_chrom_access_recon_loss: 1375601.1250; train_global_loss: 5090898.5000; train_optim_loss: 5090898.5000; val_kl_reg_loss: 9845.3818; val_edge_recon_loss: 2697620.7500; val_gene_expr_recon_loss: 996942.1875; val_masked_gp_l1_reg_loss: 8809.8857; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26932.4258; val_chrom_access_recon_loss: 1385693.5000; val_global_loss: 5125844.5000; val_optim_loss: 5125844.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9672; val_auprc_score: 0.9527; val_best_acc_score: 0.9210; val_best_f1_score: 0.9246; train_kl_reg_loss: 23892.0738; train_edge_recon_loss: 2678811.7500; train_gene_expr_recon_loss: 985529.3403; train_masked_gp_l1_reg_loss: 8801.2401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26813.0862; train_chrom_access_recon_loss: 1375344.8750; train_global_loss: 5099192.4444; train_optim_loss: 5099192.4444; val_kl_reg_loss: 9689.5498; val_edge_recon_loss: 2680721.2500; val_gene_expr_recon_loss: 995947.6250; val_masked_gp_l1_reg_loss: 8792.0254; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26667.4043; val_chrom_access_recon_loss: 1385289.8750; val_global_loss: 5107108.0000; val_optim_loss: 5107108.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9699; val_auprc_score: 0.9567; val_best_acc_score: 0.9266; val_best_f1_score: 0.9294; train_kl_reg_loss: 23357.1042; train_edge_recon_loss: 2667589.6667; train_gene_expr_recon_loss: 986372.0903; train_masked_gp_l1_reg_loss: 8786.9501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26556.5801; train_chrom_access_recon_loss: 1375415.0417; train_global_loss: 5088077.3889; train_optim_loss: 5088077.3889; val_kl_reg_loss: 9524.8418; val_edge_recon_loss: 2668730.0000; val_gene_expr_recon_loss: 996314.0000; val_masked_gp_l1_reg_loss: 8781.7051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26424.2930; val_chrom_access_recon_loss: 1385651.2500; val_global_loss: 5095426.0000; val_optim_loss: 5095426.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 4 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9562
val AUPRC score: 0.9414
val best accuracy score: 0.9000
val best F1 score: 0.9049
val target rna MSE score: 3.9690
val source rna MSE score: 3.4115
val target atac MSE score: 0.1365
val source atac MSE score: 0.0217
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
