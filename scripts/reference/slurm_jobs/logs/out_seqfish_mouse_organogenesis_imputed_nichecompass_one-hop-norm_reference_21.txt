[True]
Run timestamp: 01082023_070326_21.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_21']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9143; val_auprc_score: 0.9840; val_best_acc_score: 0.8533; val_best_f1_score: 0.9208; train_kl_reg_loss: 93869.0481; train_edge_recon_loss: 11773.0843; train_gene_expr_recon_loss: 5194540.4074; train_masked_gp_l1_reg_loss: 6701.2393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58826.6249; train_global_loss: 5365710.3796; train_optim_loss: 5365710.3796; val_kl_reg_loss: 83514.5339; val_edge_recon_loss: 11932.0641; val_gene_expr_recon_loss: 4437350.6667; val_masked_gp_l1_reg_loss: 6800.1665; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54461.3359; val_global_loss: 4594058.7500; val_optim_loss: 4594058.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8975; val_auprc_score: 0.9800; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 72171.9703; train_edge_recon_loss: 11931.8591; train_gene_expr_recon_loss: 3832086.4954; train_masked_gp_l1_reg_loss: 6614.8098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50967.0595; train_global_loss: 3973772.1713; train_optim_loss: 3973772.1713; val_kl_reg_loss: 67787.8932; val_edge_recon_loss: 12191.5718; val_gene_expr_recon_loss: 3337076.7083; val_masked_gp_l1_reg_loss: 6348.2129; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47620.9844; val_global_loss: 3471025.4167; val_optim_loss: 3471025.4167
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8650; val_auprc_score: 0.9750; val_best_acc_score: 0.8659; val_best_f1_score: 0.9274; train_kl_reg_loss: 64813.4038; train_edge_recon_loss: 11956.8049; train_gene_expr_recon_loss: 2910843.2824; train_masked_gp_l1_reg_loss: 6059.3639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44891.2015; train_global_loss: 3038564.0556; train_optim_loss: 3038564.0556; val_kl_reg_loss: 59268.1810; val_edge_recon_loss: 11519.0052; val_gene_expr_recon_loss: 2539135.5833; val_masked_gp_l1_reg_loss: 5804.2520; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42301.8672; val_global_loss: 2658028.8333; val_optim_loss: 2658028.8333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8509; val_auprc_score: 0.9698; val_best_acc_score: 0.8763; val_best_f1_score: 0.9317; train_kl_reg_loss: 59115.1768; train_edge_recon_loss: 11882.5280; train_gene_expr_recon_loss: 2391141.8611; train_masked_gp_l1_reg_loss: 5640.3904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40288.5650; train_global_loss: 2508068.5000; train_optim_loss: 2508068.5000; val_kl_reg_loss: 54584.8509; val_edge_recon_loss: 11822.9427; val_gene_expr_recon_loss: 2288247.1250; val_masked_gp_l1_reg_loss: 5510.3809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38443.1992; val_global_loss: 2398608.6667; val_optim_loss: 2398608.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8463; val_auprc_score: 0.9682; val_best_acc_score: 0.8659; val_best_f1_score: 0.9262; train_kl_reg_loss: 53359.9668; train_edge_recon_loss: 11800.4503; train_gene_expr_recon_loss: 2254591.4954; train_masked_gp_l1_reg_loss: 5442.5824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37136.1791; train_global_loss: 2362330.6759; train_optim_loss: 2362330.6759; val_kl_reg_loss: 48521.1615; val_edge_recon_loss: 11889.1961; val_gene_expr_recon_loss: 2222098.2083; val_masked_gp_l1_reg_loss: 5390.6572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36028.9609; val_global_loss: 2323928.2917; val_optim_loss: 2323928.2917
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8467; val_auprc_score: 0.9686; val_best_acc_score: 0.8786; val_best_f1_score: 0.9333; train_kl_reg_loss: 47838.8895; train_edge_recon_loss: 11811.7746; train_gene_expr_recon_loss: 2205286.9028; train_masked_gp_l1_reg_loss: 5366.5312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35457.1787; train_global_loss: 2305761.2963; train_optim_loss: 2305761.2963; val_kl_reg_loss: 43636.9408; val_edge_recon_loss: 11628.7064; val_gene_expr_recon_loss: 2184811.1250; val_masked_gp_l1_reg_loss: 5355.9497; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35097.1406; val_global_loss: 2280530.0417; val_optim_loss: 2280530.0417
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8619; val_auprc_score: 0.9709; val_best_acc_score: 0.8781; val_best_f1_score: 0.9321; train_kl_reg_loss: 43441.3248; train_edge_recon_loss: 11813.5173; train_gene_expr_recon_loss: 2173698.4954; train_masked_gp_l1_reg_loss: 5370.2038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34896.7128; train_global_loss: 2269220.2685; train_optim_loss: 2269220.2685; val_kl_reg_loss: 40083.9199; val_edge_recon_loss: 11781.1195; val_gene_expr_recon_loss: 2151365.1250; val_masked_gp_l1_reg_loss: 5398.2007; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34691.6562; val_global_loss: 2243320.1667; val_optim_loss: 2243320.1667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8727; val_auprc_score: 0.9740; val_best_acc_score: 0.8782; val_best_f1_score: 0.9328; train_kl_reg_loss: 39993.8270; train_edge_recon_loss: 11754.3162; train_gene_expr_recon_loss: 2147965.9074; train_masked_gp_l1_reg_loss: 5435.0775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34488.5553; train_global_loss: 2239637.6944; train_optim_loss: 2239637.6944; val_kl_reg_loss: 36975.1445; val_edge_recon_loss: 11707.2103; val_gene_expr_recon_loss: 2131945.0833; val_masked_gp_l1_reg_loss: 5478.5640; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34274.2734; val_global_loss: 2220380.1667; val_optim_loss: 2220380.1667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8745; val_auprc_score: 0.9726; val_best_acc_score: 0.8753; val_best_f1_score: 0.9307; train_kl_reg_loss: 37201.6808; train_edge_recon_loss: 11634.0745; train_gene_expr_recon_loss: 2125260.4259; train_masked_gp_l1_reg_loss: 5522.3512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34060.8524; train_global_loss: 2213679.4074; train_optim_loss: 2213679.4074; val_kl_reg_loss: 34632.6517; val_edge_recon_loss: 12053.3908; val_gene_expr_recon_loss: 2109620.5417; val_masked_gp_l1_reg_loss: 5570.7622; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33835.8672; val_global_loss: 2195713.0833; val_optim_loss: 2195713.0833
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8863; val_auprc_score: 0.9759; val_best_acc_score: 0.8848; val_best_f1_score: 0.9338; train_kl_reg_loss: 34838.9155; train_edge_recon_loss: 11689.6914; train_gene_expr_recon_loss: 2104994.5463; train_masked_gp_l1_reg_loss: 5618.0441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33613.5127; train_global_loss: 2190754.7222; train_optim_loss: 2190754.7222; val_kl_reg_loss: 32465.6624; val_edge_recon_loss: 11692.7544; val_gene_expr_recon_loss: 2088371.6875; val_masked_gp_l1_reg_loss: 5668.4814; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33381.9492; val_global_loss: 2171580.5833; val_optim_loss: 2171580.5833
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8852; val_auprc_score: 0.9761; val_best_acc_score: 0.8857; val_best_f1_score: 0.9352; train_kl_reg_loss: 32831.3309; train_edge_recon_loss: 11728.4692; train_gene_expr_recon_loss: 2086845.6435; train_masked_gp_l1_reg_loss: 5718.5594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33156.4060; train_global_loss: 2170280.4028; train_optim_loss: 2170280.4028; val_kl_reg_loss: 30818.6683; val_edge_recon_loss: 11449.5985; val_gene_expr_recon_loss: 2071412.8125; val_masked_gp_l1_reg_loss: 5772.2466; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32920.6484; val_global_loss: 2152374.1250; val_optim_loss: 2152374.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8929; val_auprc_score: 0.9776; val_best_acc_score: 0.8857; val_best_f1_score: 0.9352; train_kl_reg_loss: 31142.4719; train_edge_recon_loss: 11533.4825; train_gene_expr_recon_loss: 2067477.1319; train_masked_gp_l1_reg_loss: 5821.6803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32691.5132; train_global_loss: 2148666.2454; train_optim_loss: 2148666.2454; val_kl_reg_loss: 29218.7956; val_edge_recon_loss: 11674.1611; val_gene_expr_recon_loss: 2052098.0833; val_masked_gp_l1_reg_loss: 5874.3467; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32452.9570; val_global_loss: 2131318.3750; val_optim_loss: 2131318.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8923; val_auprc_score: 0.9779; val_best_acc_score: 0.8899; val_best_f1_score: 0.9378; train_kl_reg_loss: 29613.1074; train_edge_recon_loss: 11558.1812; train_gene_expr_recon_loss: 2050876.0324; train_masked_gp_l1_reg_loss: 5923.4110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32222.1497; train_global_loss: 2130192.8796; train_optim_loss: 2130192.8796; val_kl_reg_loss: 27857.7083; val_edge_recon_loss: 11274.9429; val_gene_expr_recon_loss: 2036507.9375; val_masked_gp_l1_reg_loss: 5974.2168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31982.7422; val_global_loss: 2113597.5417; val_optim_loss: 2113597.5417
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8954; val_auprc_score: 0.9782; val_best_acc_score: 0.8921; val_best_f1_score: 0.9386; train_kl_reg_loss: 28273.1444; train_edge_recon_loss: 11560.5433; train_gene_expr_recon_loss: 2034695.8009; train_masked_gp_l1_reg_loss: 6025.8398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31748.0312; train_global_loss: 2112303.3657; train_optim_loss: 2112303.3657; val_kl_reg_loss: 26743.7812; val_edge_recon_loss: 11366.9928; val_gene_expr_recon_loss: 2019460.2083; val_masked_gp_l1_reg_loss: 6082.9565; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31502.3203; val_global_loss: 2095156.3125; val_optim_loss: 2095156.3125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9004; val_auprc_score: 0.9794; val_best_acc_score: 0.8914; val_best_f1_score: 0.9378; train_kl_reg_loss: 27091.1683; train_edge_recon_loss: 11542.2216; train_gene_expr_recon_loss: 2018546.1852; train_masked_gp_l1_reg_loss: 6134.1165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31260.2076; train_global_loss: 2094573.9028; train_optim_loss: 2094573.9028; val_kl_reg_loss: 25530.7233; val_edge_recon_loss: 11585.8151; val_gene_expr_recon_loss: 2005896.9583; val_masked_gp_l1_reg_loss: 6188.5879; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31006.0508; val_global_loss: 2080208.1042; val_optim_loss: 2080208.1042
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9008; val_auprc_score: 0.9782; val_best_acc_score: 0.8925; val_best_f1_score: 0.9379; train_kl_reg_loss: 25993.5584; train_edge_recon_loss: 11482.9686; train_gene_expr_recon_loss: 2004358.9375; train_masked_gp_l1_reg_loss: 6241.2289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30756.9312; train_global_loss: 2078833.6366; train_optim_loss: 2078833.6366; val_kl_reg_loss: 24593.1497; val_edge_recon_loss: 11807.2035; val_gene_expr_recon_loss: 1988870.8125; val_masked_gp_l1_reg_loss: 6298.2900; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30496.6172; val_global_loss: 2062066.0625; val_optim_loss: 2062066.0625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8968; val_auprc_score: 0.9784; val_best_acc_score: 0.8944; val_best_f1_score: 0.9390; train_kl_reg_loss: 25022.9786; train_edge_recon_loss: 11427.8569; train_gene_expr_recon_loss: 1989216.5833; train_masked_gp_l1_reg_loss: 6350.7574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30242.2112; train_global_loss: 2062260.3843; train_optim_loss: 2062260.3843; val_kl_reg_loss: 23668.3333; val_edge_recon_loss: 11434.0449; val_gene_expr_recon_loss: 1977653.8333; val_masked_gp_l1_reg_loss: 6406.5986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29975.9336; val_global_loss: 2049138.7292; val_optim_loss: 2049138.7292
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9126; val_auprc_score: 0.9817; val_best_acc_score: 0.8965; val_best_f1_score: 0.9395; train_kl_reg_loss: 24105.0519; train_edge_recon_loss: 11388.8096; train_gene_expr_recon_loss: 1975908.8009; train_masked_gp_l1_reg_loss: 6457.9927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29714.7510; train_global_loss: 2047575.4120; train_optim_loss: 2047575.4120; val_kl_reg_loss: 22753.0641; val_edge_recon_loss: 11785.0783; val_gene_expr_recon_loss: 1962169.9792; val_masked_gp_l1_reg_loss: 6513.7231; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29441.8750; val_global_loss: 2032663.7708; val_optim_loss: 2032663.7708
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9083; val_auprc_score: 0.9805; val_best_acc_score: 0.8991; val_best_f1_score: 0.9419; train_kl_reg_loss: 23274.0324; train_edge_recon_loss: 11325.9684; train_gene_expr_recon_loss: 1962728.8472; train_masked_gp_l1_reg_loss: 6564.2948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29175.5423; train_global_loss: 2033068.6944; train_optim_loss: 2033068.6944; val_kl_reg_loss: 22087.0342; val_edge_recon_loss: 11461.2078; val_gene_expr_recon_loss: 1952028.3333; val_masked_gp_l1_reg_loss: 6619.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28897.7891; val_global_loss: 2021093.7083; val_optim_loss: 2021093.7083
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9097; val_auprc_score: 0.9811; val_best_acc_score: 0.8981; val_best_f1_score: 0.9418; train_kl_reg_loss: 22485.4280; train_edge_recon_loss: 11295.9438; train_gene_expr_recon_loss: 1950382.2801; train_masked_gp_l1_reg_loss: 6667.3913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28627.3563; train_global_loss: 2019458.4051; train_optim_loss: 2019458.4051; val_kl_reg_loss: 21350.8551; val_edge_recon_loss: 11460.6903; val_gene_expr_recon_loss: 1939886.8750; val_masked_gp_l1_reg_loss: 6723.1841; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28345.2637; val_global_loss: 2007766.7917; val_optim_loss: 2007766.7917
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9058; val_auprc_score: 0.9799; val_best_acc_score: 0.8989; val_best_f1_score: 0.9423; train_kl_reg_loss: 21763.1859; train_edge_recon_loss: 11386.1227; train_gene_expr_recon_loss: 1937962.8403; train_masked_gp_l1_reg_loss: 6769.6105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28072.0056; train_global_loss: 2005953.7685; train_optim_loss: 2005953.7685; val_kl_reg_loss: 20660.7035; val_edge_recon_loss: 11243.2980; val_gene_expr_recon_loss: 1927025.1458; val_masked_gp_l1_reg_loss: 6821.0449; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27788.1797; val_global_loss: 1993538.2917; val_optim_loss: 1993538.2917
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9158; val_auprc_score: 0.9826; val_best_acc_score: 0.9019; val_best_f1_score: 0.9437; train_kl_reg_loss: 21075.3131; train_edge_recon_loss: 11289.9235; train_gene_expr_recon_loss: 1926584.2431; train_masked_gp_l1_reg_loss: 6866.3919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27513.6213; train_global_loss: 1993329.4884; train_optim_loss: 1993329.4884; val_kl_reg_loss: 19978.4437; val_edge_recon_loss: 11301.7222; val_gene_expr_recon_loss: 1915552.1458; val_masked_gp_l1_reg_loss: 6916.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27228.9844; val_global_loss: 1980977.4375; val_optim_loss: 1980977.4375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9132; val_auprc_score: 0.9822; val_best_acc_score: 0.9027; val_best_f1_score: 0.9439; train_kl_reg_loss: 20432.7514; train_edge_recon_loss: 11234.0274; train_gene_expr_recon_loss: 1914647.0810; train_masked_gp_l1_reg_loss: 6962.3762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26956.0846; train_global_loss: 1980232.3264; train_optim_loss: 1980232.3264; val_kl_reg_loss: 19439.0928; val_edge_recon_loss: 11295.6883; val_gene_expr_recon_loss: 1905361.0208; val_masked_gp_l1_reg_loss: 7014.0864; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26673.8066; val_global_loss: 1969783.6875; val_optim_loss: 1969783.6875
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9179; val_auprc_score: 0.9827; val_best_acc_score: 0.9035; val_best_f1_score: 0.9442; train_kl_reg_loss: 19819.0894; train_edge_recon_loss: 11126.2399; train_gene_expr_recon_loss: 1904180.9144; train_masked_gp_l1_reg_loss: 7054.9380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26401.8968; train_global_loss: 1968583.0856; train_optim_loss: 1968583.0856; val_kl_reg_loss: 18819.3971; val_edge_recon_loss: 11263.8496; val_gene_expr_recon_loss: 1892522.4375; val_masked_gp_l1_reg_loss: 7101.7915; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26123.5059; val_global_loss: 1955830.9167; val_optim_loss: 1955830.9167
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9149; val_auprc_score: 0.9819; val_best_acc_score: 0.8984; val_best_f1_score: 0.9407; train_kl_reg_loss: 19230.9079; train_edge_recon_loss: 11185.1198; train_gene_expr_recon_loss: 1893461.6065; train_masked_gp_l1_reg_loss: 7142.7071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25856.8229; train_global_loss: 1956877.1667; train_optim_loss: 1956877.1667; val_kl_reg_loss: 18316.0820; val_edge_recon_loss: 11840.7121; val_gene_expr_recon_loss: 1883879.7292; val_masked_gp_l1_reg_loss: 7187.5933; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25581.4805; val_global_loss: 1946805.6458; val_optim_loss: 1946805.6458
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8956; val_auprc_score: 0.9794; val_best_acc_score: 0.8883; val_best_f1_score: 0.9354; train_kl_reg_loss: 52257.0116; train_edge_recon_loss: 11865.3972; train_gene_expr_recon_loss: 3530165.1296; train_masked_gp_l1_reg_loss: 8312.0299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25234.3049; train_global_loss: 3627833.8611; train_optim_loss: 3627833.8611; val_kl_reg_loss: 68659.9167; val_edge_recon_loss: 11652.5918; val_gene_expr_recon_loss: 2983073.3333; val_masked_gp_l1_reg_loss: 8575.4561; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24850.5508; val_global_loss: 3096811.8750; val_optim_loss: 3096811.8750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9008; val_auprc_score: 0.9779; val_best_acc_score: 0.8540; val_best_f1_score: 0.9213; train_kl_reg_loss: 257728.6474; train_edge_recon_loss: 11843.4230; train_gene_expr_recon_loss: 12239948.9861; train_masked_gp_l1_reg_loss: 8959.0690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24479.1626; train_global_loss: 12542959.2593; train_optim_loss: 12542959.2593; val_kl_reg_loss: 251928.2943; val_edge_recon_loss: 11868.3532; val_gene_expr_recon_loss: 3429398.3750; val_masked_gp_l1_reg_loss: 9196.6416; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24095.9570; val_global_loss: 3726487.7917; val_optim_loss: 3726487.7917
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9047; val_auprc_score: 0.9798; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 247116.4248; train_edge_recon_loss: 11908.7229; train_gene_expr_recon_loss: 6540476.2269; train_masked_gp_l1_reg_loss: 9059.0031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23730.4435; train_global_loss: 6832290.8472; train_optim_loss: 6832290.8472; val_kl_reg_loss: 260067.9531; val_edge_recon_loss: 11893.3965; val_gene_expr_recon_loss: 3452980.2917; val_masked_gp_l1_reg_loss: 8916.9053; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23353.1016; val_global_loss: 3757211.6250; val_optim_loss: 3757211.6250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8989; val_auprc_score: 0.9779; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 267767.4227; train_edge_recon_loss: 11912.8109; train_gene_expr_recon_loss: 5636950.7546; train_masked_gp_l1_reg_loss: 8775.6070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22992.7230; train_global_loss: 5948399.1667; train_optim_loss: 5948399.1667; val_kl_reg_loss: 272391.8438; val_edge_recon_loss: 11920.2816; val_gene_expr_recon_loss: 3785834.3333; val_masked_gp_l1_reg_loss: 8643.5332; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22620.7734; val_global_loss: 4101410.7083; val_optim_loss: 4101410.7083

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9008; val_auprc_score: 0.9789; val_best_acc_score: 0.8590; val_best_f1_score: 0.9241; train_kl_reg_loss: 273339.0234; train_edge_recon_loss: 11977.8128; train_gene_expr_recon_loss: 3354305.6898; train_masked_gp_l1_reg_loss: 8593.7675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22567.7475; train_global_loss: 3670784.0417; train_optim_loss: 3670784.0417; val_kl_reg_loss: 250821.8672; val_edge_recon_loss: 11461.9940; val_gene_expr_recon_loss: 3091266.2500; val_masked_gp_l1_reg_loss: 8556.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22526.3164; val_global_loss: 3384633.3750; val_optim_loss: 3384633.3750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8994; val_auprc_score: 0.9778; val_best_acc_score: 0.8497; val_best_f1_score: 0.9188; train_kl_reg_loss: 254550.2483; train_edge_recon_loss: 11988.6380; train_gene_expr_recon_loss: 3033707.2454; train_masked_gp_l1_reg_loss: 8535.4637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22489.1058; train_global_loss: 3331270.7222; train_optim_loss: 3331270.7222; val_kl_reg_loss: 238351.9766; val_edge_recon_loss: 12214.0264; val_gene_expr_recon_loss: 2968118.3750; val_masked_gp_l1_reg_loss: 8516.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22450.2383; val_global_loss: 3249651.1250; val_optim_loss: 3249651.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8940; val_auprc_score: 0.9768; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 243266.5914; train_edge_recon_loss: 11852.9706; train_gene_expr_recon_loss: 2945706.5231; train_masked_gp_l1_reg_loss: 8501.9249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22412.1004; train_global_loss: 3231740.1111; train_optim_loss: 3231740.1111; val_kl_reg_loss: 229350.1068; val_edge_recon_loss: 11888.1506; val_gene_expr_recon_loss: 2909834.7500; val_masked_gp_l1_reg_loss: 8487.8848; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22372.1875; val_global_loss: 3181933.2500; val_optim_loss: 3181933.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9018; val_auprc_score: 0.9781; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 234595.3264; train_edge_recon_loss: 11809.8552; train_gene_expr_recon_loss: 2899990.3889; train_masked_gp_l1_reg_loss: 8475.6523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22332.9423; train_global_loss: 3177204.1759; train_optim_loss: 3177204.1759; val_kl_reg_loss: 221463.5781; val_edge_recon_loss: 12097.1890; val_gene_expr_recon_loss: 2876655.0417; val_masked_gp_l1_reg_loss: 8463.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22291.8477; val_global_loss: 3140971.3333; val_optim_loss: 3140971.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 7 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9225
val AUPRC score: 0.9835
val best accuracy score: 0.9028
val best F1 score: 0.9437
val target rna MSE score: 23.6942
val source rna MSE score: 140.1001
Val cat covariate0 mean sim diff: -0.0001

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
