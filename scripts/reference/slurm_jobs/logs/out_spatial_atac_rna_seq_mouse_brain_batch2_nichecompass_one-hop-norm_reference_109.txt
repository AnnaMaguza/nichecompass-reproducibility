[True]
Run timestamp: 26072023_031647_109.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_109']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9671; val_auprc_score: 0.9675; val_best_acc_score: 0.8460; val_best_f1_score: 0.8206; train_kl_reg_loss: 1836.3326; train_edge_recon_loss: 34659626.6667; train_gene_expr_recon_loss: 323134.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1073487.7778; train_global_loss: 36058084.8889; train_optim_loss: 36058084.8889; val_kl_reg_loss: 795.4044; val_edge_recon_loss: 40374840.0000; val_gene_expr_recon_loss: 328304.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1095943.2500; val_global_loss: 41799884.0000; val_optim_loss: 41799884.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9395; val_auprc_score: 0.9347; val_best_acc_score: 0.8560; val_best_f1_score: 0.8599; train_kl_reg_loss: 562.7265; train_edge_recon_loss: 34615064.8889; train_gene_expr_recon_loss: 320333.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1073101.1667; train_global_loss: 36009061.3333; train_optim_loss: 36009061.3333; val_kl_reg_loss: 388.5941; val_edge_recon_loss: 37711620.0000; val_gene_expr_recon_loss: 325796.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1094053.7500; val_global_loss: 39131856.0000; val_optim_loss: 39131856.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8803; val_auprc_score: 0.8733; val_best_acc_score: 0.7858; val_best_f1_score: 0.8027; train_kl_reg_loss: 1146.1368; train_edge_recon_loss: 33613563.3333; train_gene_expr_recon_loss: 315699.9965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1070741.0278; train_global_loss: 35001150.6667; train_optim_loss: 35001150.6667; val_kl_reg_loss: 3651.1541; val_edge_recon_loss: 30095396.0000; val_gene_expr_recon_loss: 318759.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1089455.0000; val_global_loss: 31507264.0000; val_optim_loss: 31507264.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8877; val_auprc_score: 0.8737; val_best_acc_score: 0.8001; val_best_f1_score: 0.8201; train_kl_reg_loss: 12452.6496; train_edge_recon_loss: 28832261.1111; train_gene_expr_recon_loss: 318406.9653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1069216.3472; train_global_loss: 30232337.3333; train_optim_loss: 30232337.3333; val_kl_reg_loss: 26071.9180; val_edge_recon_loss: 28120368.0000; val_gene_expr_recon_loss: 325318.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1092125.1250; val_global_loss: 29563884.0000; val_optim_loss: 29563884.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9048; val_auprc_score: 0.8794; val_best_acc_score: 0.8309; val_best_f1_score: 0.8480; train_kl_reg_loss: 34317.1897; train_edge_recon_loss: 27622877.5556; train_gene_expr_recon_loss: 317043.6076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1066766.9444; train_global_loss: 29041005.3333; train_optim_loss: 29041005.3333; val_kl_reg_loss: 42159.8125; val_edge_recon_loss: 27498588.0000; val_gene_expr_recon_loss: 324266.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1087036.0000; val_global_loss: 28952050.0000; val_optim_loss: 28952050.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9313; val_auprc_score: 0.9111; val_best_acc_score: 0.8736; val_best_f1_score: 0.8806; train_kl_reg_loss: 45492.8194; train_edge_recon_loss: 27151901.7778; train_gene_expr_recon_loss: 313992.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1064370.8958; train_global_loss: 28575758.2222; train_optim_loss: 28575758.2222; val_kl_reg_loss: 48821.7344; val_edge_recon_loss: 26987404.0000; val_gene_expr_recon_loss: 316802.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1083611.3750; val_global_loss: 28436640.0000; val_optim_loss: 28436640.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9244; val_auprc_score: 0.8990; val_best_acc_score: 0.8638; val_best_f1_score: 0.8729; train_kl_reg_loss: 50131.1124; train_edge_recon_loss: 26973383.3333; train_gene_expr_recon_loss: 309762.3229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058626.0417; train_global_loss: 28391902.8889; train_optim_loss: 28391902.8889; val_kl_reg_loss: 50721.9688; val_edge_recon_loss: 27348128.0000; val_gene_expr_recon_loss: 313974.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1083673.5000; val_global_loss: 28796498.0000; val_optim_loss: 28796498.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9297; val_auprc_score: 0.9088; val_best_acc_score: 0.8638; val_best_f1_score: 0.8732; train_kl_reg_loss: 50447.5469; train_edge_recon_loss: 26914561.3333; train_gene_expr_recon_loss: 308041.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1066959.4722; train_global_loss: 28340010.0000; train_optim_loss: 28340010.0000; val_kl_reg_loss: 48555.1953; val_edge_recon_loss: 27306200.0000; val_gene_expr_recon_loss: 310501.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1080902.7500; val_global_loss: 28746160.0000; val_optim_loss: 28746160.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9389; val_auprc_score: 0.9223; val_best_acc_score: 0.8751; val_best_f1_score: 0.8833; train_kl_reg_loss: 46631.5074; train_edge_recon_loss: 26866653.7778; train_gene_expr_recon_loss: 304077.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1059126.5833; train_global_loss: 28276488.8889; train_optim_loss: 28276488.8889; val_kl_reg_loss: 44229.0703; val_edge_recon_loss: 27039986.0000; val_gene_expr_recon_loss: 308673.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1081491.6250; val_global_loss: 28474382.0000; val_optim_loss: 28474382.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9440; val_auprc_score: 0.9269; val_best_acc_score: 0.8851; val_best_f1_score: 0.8908; train_kl_reg_loss: 42306.9171; train_edge_recon_loss: 26802392.0000; train_gene_expr_recon_loss: 303244.9549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1059065.7847; train_global_loss: 28207010.0000; train_optim_loss: 28207010.0000; val_kl_reg_loss: 40248.5312; val_edge_recon_loss: 26925244.0000; val_gene_expr_recon_loss: 308624.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1076605.0000; val_global_loss: 28350720.0000; val_optim_loss: 28350720.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9525; val_auprc_score: 0.9346; val_best_acc_score: 0.8992; val_best_f1_score: 0.9034; train_kl_reg_loss: 38094.0247; train_edge_recon_loss: 26743530.2222; train_gene_expr_recon_loss: 301421.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1056116.9236; train_global_loss: 28139161.5556; train_optim_loss: 28139161.5556; val_kl_reg_loss: 36113.2109; val_edge_recon_loss: 26791220.0000; val_gene_expr_recon_loss: 308054.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1078626.0000; val_global_loss: 28214014.0000; val_optim_loss: 28214014.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9592; val_auprc_score: 0.9436; val_best_acc_score: 0.9049; val_best_f1_score: 0.9083; train_kl_reg_loss: 34260.2259; train_edge_recon_loss: 26578311.1111; train_gene_expr_recon_loss: 302601.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1054716.0694; train_global_loss: 27969888.2222; train_optim_loss: 27969888.2222; val_kl_reg_loss: 32511.2305; val_edge_recon_loss: 26726240.0000; val_gene_expr_recon_loss: 310984.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1079418.8750; val_global_loss: 28149154.0000; val_optim_loss: 28149154.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9579; val_auprc_score: 0.9422; val_best_acc_score: 0.9068; val_best_f1_score: 0.9105; train_kl_reg_loss: 31919.6810; train_edge_recon_loss: 26475642.4444; train_gene_expr_recon_loss: 299757.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1055284.2847; train_global_loss: 27862604.0000; train_optim_loss: 27862604.0000; val_kl_reg_loss: 31555.3789; val_edge_recon_loss: 26741704.0000; val_gene_expr_recon_loss: 304891.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1075296.3750; val_global_loss: 28153448.0000; val_optim_loss: 28153448.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9663; val_auprc_score: 0.9518; val_best_acc_score: 0.9197; val_best_f1_score: 0.9226; train_kl_reg_loss: 31477.7656; train_edge_recon_loss: 26419686.0000; train_gene_expr_recon_loss: 297197.5174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047438.4653; train_global_loss: 27795799.5556; train_optim_loss: 27795799.5556; val_kl_reg_loss: 31951.8945; val_edge_recon_loss: 26338404.0000; val_gene_expr_recon_loss: 300111.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1074436.6250; val_global_loss: 27744904.0000; val_optim_loss: 27744904.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9657; val_auprc_score: 0.9532; val_best_acc_score: 0.9179; val_best_f1_score: 0.9213; train_kl_reg_loss: 31797.7335; train_edge_recon_loss: 26455490.6667; train_gene_expr_recon_loss: 297112.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1053474.6806; train_global_loss: 27837874.8889; train_optim_loss: 27837874.8889; val_kl_reg_loss: 32093.3887; val_edge_recon_loss: 26605434.0000; val_gene_expr_recon_loss: 299043.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1069496.0000; val_global_loss: 28006068.0000; val_optim_loss: 28006068.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9692; val_auprc_score: 0.9561; val_best_acc_score: 0.9206; val_best_f1_score: 0.9245; train_kl_reg_loss: 31627.1957; train_edge_recon_loss: 26363176.4444; train_gene_expr_recon_loss: 293679.4931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1050119.9236; train_global_loss: 27738603.5556; train_optim_loss: 27738603.5556; val_kl_reg_loss: 31950.7090; val_edge_recon_loss: 26486352.0000; val_gene_expr_recon_loss: 297011.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1067826.2500; val_global_loss: 27883140.0000; val_optim_loss: 27883140.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9707; val_auprc_score: 0.9590; val_best_acc_score: 0.9258; val_best_f1_score: 0.9281; train_kl_reg_loss: 31378.1966; train_edge_recon_loss: 26405803.5556; train_gene_expr_recon_loss: 291005.1215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044634.0833; train_global_loss: 27772820.6667; train_optim_loss: 27772820.6667; val_kl_reg_loss: 31059.1641; val_edge_recon_loss: 26403370.0000; val_gene_expr_recon_loss: 295857.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1068436.1250; val_global_loss: 27798724.0000; val_optim_loss: 27798724.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9690; val_auprc_score: 0.9547; val_best_acc_score: 0.9251; val_best_f1_score: 0.9278; train_kl_reg_loss: 30982.2448; train_edge_recon_loss: 26367066.0000; train_gene_expr_recon_loss: 290030.2118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047713.9583; train_global_loss: 27735792.4444; train_optim_loss: 27735792.4444; val_kl_reg_loss: 30503.4531; val_edge_recon_loss: 26288744.0000; val_gene_expr_recon_loss: 295513.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1068004.0000; val_global_loss: 27682766.0000; val_optim_loss: 27682766.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9742; val_auprc_score: 0.9651; val_best_acc_score: 0.9302; val_best_f1_score: 0.9317; train_kl_reg_loss: 30687.1723; train_edge_recon_loss: 26316304.8889; train_gene_expr_recon_loss: 290246.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1045000.7778; train_global_loss: 27682239.1111; train_optim_loss: 27682239.1111; val_kl_reg_loss: 30866.4629; val_edge_recon_loss: 26330122.0000; val_gene_expr_recon_loss: 294613.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1063823.2500; val_global_loss: 27719426.0000; val_optim_loss: 27719426.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9747; val_auprc_score: 0.9653; val_best_acc_score: 0.9329; val_best_f1_score: 0.9354; train_kl_reg_loss: 30797.8008; train_edge_recon_loss: 26394971.5556; train_gene_expr_recon_loss: 288911.3299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048226.7917; train_global_loss: 27762907.1111; train_optim_loss: 27762907.1111; val_kl_reg_loss: 30365.3516; val_edge_recon_loss: 26225832.0000; val_gene_expr_recon_loss: 292861.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1064391.5000; val_global_loss: 27613452.0000; val_optim_loss: 27613452.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9733; val_auprc_score: 0.9587; val_best_acc_score: 0.9325; val_best_f1_score: 0.9347; train_kl_reg_loss: 30345.1007; train_edge_recon_loss: 26292793.7778; train_gene_expr_recon_loss: 287142.5208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044367.1389; train_global_loss: 27654648.4444; train_optim_loss: 27654648.4444; val_kl_reg_loss: 30072.5195; val_edge_recon_loss: 26274750.0000; val_gene_expr_recon_loss: 292896.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1065086.8750; val_global_loss: 27662804.0000; val_optim_loss: 27662804.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9716; val_auprc_score: 0.9556; val_best_acc_score: 0.9326; val_best_f1_score: 0.9346; train_kl_reg_loss: 30229.8652; train_edge_recon_loss: 26340865.3333; train_gene_expr_recon_loss: 285293.7292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1042838.9167; train_global_loss: 27699228.0000; train_optim_loss: 27699228.0000; val_kl_reg_loss: 28890.6855; val_edge_recon_loss: 26387840.0000; val_gene_expr_recon_loss: 290275.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1063088.1250; val_global_loss: 27770094.0000; val_optim_loss: 27770094.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9714; val_auprc_score: 0.9606; val_best_acc_score: 0.9287; val_best_f1_score: 0.9319; train_kl_reg_loss: 29241.1189; train_edge_recon_loss: 26302500.6667; train_gene_expr_recon_loss: 285463.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046404.2083; train_global_loss: 27663609.5556; train_optim_loss: 27663609.5556; val_kl_reg_loss: 28691.4102; val_edge_recon_loss: 26493832.0000; val_gene_expr_recon_loss: 287451.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058533.5000; val_global_loss: 27868510.0000; val_optim_loss: 27868510.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9747; val_auprc_score: 0.9636; val_best_acc_score: 0.9348; val_best_f1_score: 0.9373; train_kl_reg_loss: 28924.4212; train_edge_recon_loss: 26179346.0000; train_gene_expr_recon_loss: 284463.9132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1037369.8611; train_global_loss: 27530104.2222; train_optim_loss: 27530104.2222; val_kl_reg_loss: 28946.6484; val_edge_recon_loss: 26279094.0000; val_gene_expr_recon_loss: 287370.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059146.0000; val_global_loss: 27654556.0000; val_optim_loss: 27654556.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9733; val_auprc_score: 0.9617; val_best_acc_score: 0.9325; val_best_f1_score: 0.9353; train_kl_reg_loss: 29184.7843; train_edge_recon_loss: 26244535.7778; train_gene_expr_recon_loss: 280785.3472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1040562.6042; train_global_loss: 27595068.2222; train_optim_loss: 27595068.2222; val_kl_reg_loss: 29078.8711; val_edge_recon_loss: 26430600.0000; val_gene_expr_recon_loss: 286999.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1057362.6250; val_global_loss: 27804040.0000; val_optim_loss: 27804040.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9772; val_auprc_score: 0.9678; val_best_acc_score: 0.9352; val_best_f1_score: 0.9378; train_kl_reg_loss: 29335.1402; train_edge_recon_loss: 26273578.2222; train_gene_expr_recon_loss: 282911.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1041690.4028; train_global_loss: 27627515.5556; train_optim_loss: 27627515.5556; val_kl_reg_loss: 29142.2812; val_edge_recon_loss: 26207250.0000; val_gene_expr_recon_loss: 287708.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059698.5000; val_global_loss: 27583798.0000; val_optim_loss: 27583798.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9743; val_auprc_score: 0.9620; val_best_acc_score: 0.9349; val_best_f1_score: 0.9368; train_kl_reg_loss: 28976.9423; train_edge_recon_loss: 26367678.0000; train_gene_expr_recon_loss: 280442.3681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1033158.9306; train_global_loss: 27710256.4444; train_optim_loss: 27710256.4444; val_kl_reg_loss: 28905.9922; val_edge_recon_loss: 26206416.0000; val_gene_expr_recon_loss: 286108.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1056803.6250; val_global_loss: 27578234.0000; val_optim_loss: 27578234.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9746; val_auprc_score: 0.9630; val_best_acc_score: 0.9367; val_best_f1_score: 0.9385; train_kl_reg_loss: 29189.2402; train_edge_recon_loss: 26249585.1111; train_gene_expr_recon_loss: 281560.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1035424.5208; train_global_loss: 27595759.3333; train_optim_loss: 27595759.3333; val_kl_reg_loss: 29153.1680; val_edge_recon_loss: 26172226.0000; val_gene_expr_recon_loss: 287716.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059290.5000; val_global_loss: 27548386.0000; val_optim_loss: 27548386.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9758; val_auprc_score: 0.9664; val_best_acc_score: 0.9361; val_best_f1_score: 0.9380; train_kl_reg_loss: 29194.2865; train_edge_recon_loss: 26271639.3333; train_gene_expr_recon_loss: 281019.9132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1033281.0139; train_global_loss: 27615134.0000; train_optim_loss: 27615134.0000; val_kl_reg_loss: 28941.2617; val_edge_recon_loss: 26185498.0000; val_gene_expr_recon_loss: 285519.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058171.8750; val_global_loss: 27558132.0000; val_optim_loss: 27558132.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9746; val_auprc_score: 0.9647; val_best_acc_score: 0.9344; val_best_f1_score: 0.9365; train_kl_reg_loss: 28879.1228; train_edge_recon_loss: 26231177.3333; train_gene_expr_recon_loss: 279668.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1030174.2708; train_global_loss: 27569900.4444; train_optim_loss: 27569900.4444; val_kl_reg_loss: 28962.6055; val_edge_recon_loss: 26543710.0000; val_gene_expr_recon_loss: 287593.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058025.7500; val_global_loss: 27918292.0000; val_optim_loss: 27918292.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9730; val_auprc_score: 0.9614; val_best_acc_score: 0.9325; val_best_f1_score: 0.9348; train_kl_reg_loss: 28883.0671; train_edge_recon_loss: 26218413.3333; train_gene_expr_recon_loss: 280815.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1036143.6181; train_global_loss: 27564255.1111; train_optim_loss: 27564255.1111; val_kl_reg_loss: 28646.8047; val_edge_recon_loss: 26522374.0000; val_gene_expr_recon_loss: 286873.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058565.3750; val_global_loss: 27896460.0000; val_optim_loss: 27896460.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9760; val_auprc_score: 0.9635; val_best_acc_score: 0.9373; val_best_f1_score: 0.9393; train_kl_reg_loss: 28924.4327; train_edge_recon_loss: 26213497.3333; train_gene_expr_recon_loss: 280609.6076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1037944.3264; train_global_loss: 27560975.5556; train_optim_loss: 27560975.5556; val_kl_reg_loss: 28666.0742; val_edge_recon_loss: 26325954.0000; val_gene_expr_recon_loss: 286627.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058302.8750; val_global_loss: 27699550.0000; val_optim_loss: 27699550.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9770; val_auprc_score: 0.9634; val_best_acc_score: 0.9383; val_best_f1_score: 0.9401; train_kl_reg_loss: 28810.7990; train_edge_recon_loss: 26179298.0000; train_gene_expr_recon_loss: 281190.5590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1041509.5417; train_global_loss: 27530808.8889; train_optim_loss: 27530808.8889; val_kl_reg_loss: 28592.3262; val_edge_recon_loss: 26235340.0000; val_gene_expr_recon_loss: 286633.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1057628.2500; val_global_loss: 27608194.0000; val_optim_loss: 27608194.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9733; val_auprc_score: 0.9584; val_best_acc_score: 0.9333; val_best_f1_score: 0.9356; train_kl_reg_loss: 28704.9223; train_edge_recon_loss: 26333354.4444; train_gene_expr_recon_loss: 282098.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1037133.3403; train_global_loss: 27681290.8889; train_optim_loss: 27681290.8889; val_kl_reg_loss: 28556.8906; val_edge_recon_loss: 26442170.0000; val_gene_expr_recon_loss: 286799.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1057327.7500; val_global_loss: 27814854.0000; val_optim_loss: 27814854.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9752; val_auprc_score: 0.9621; val_best_acc_score: 0.9341; val_best_f1_score: 0.9365; train_kl_reg_loss: 28757.1395; train_edge_recon_loss: 26181894.0000; train_gene_expr_recon_loss: 282173.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1040361.2639; train_global_loss: 27533186.4444; train_optim_loss: 27533186.4444; val_kl_reg_loss: 28554.6719; val_edge_recon_loss: 26334768.0000; val_gene_expr_recon_loss: 286662.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1057996.3750; val_global_loss: 27707980.0000; val_optim_loss: 27707980.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9768; val_auprc_score: 0.9653; val_best_acc_score: 0.9382; val_best_f1_score: 0.9400; train_kl_reg_loss: 28738.8817; train_edge_recon_loss: 26196735.7778; train_gene_expr_recon_loss: 282793.5174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1035579.4444; train_global_loss: 27543847.5556; train_optim_loss: 27543847.5556; val_kl_reg_loss: 28475.5938; val_edge_recon_loss: 26318722.0000; val_gene_expr_recon_loss: 286434.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1057065.2500; val_global_loss: 27690698.0000; val_optim_loss: 27690698.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 5 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9766
Val AUPRC score: 0.9659
Val best accuracy score: 0.9367
Val best F1 score: 0.9391
Val gene expr MSE score: 0.8499
Val chrom access MSE score: 0.0939
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
