[True]
Run timestamp: 07082023_204808_109.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_109']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9432; val_auprc_score: 0.9521; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 45669.9165; train_edge_recon_loss: 3474100.6667; train_gene_expr_recon_loss: 629531.2917; train_masked_gp_l1_reg_loss: 4657.8940; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 802403.3403; train_global_loss: 4956363.1111; train_optim_loss: 4956363.1111; val_kl_reg_loss: 87440.9844; val_edge_recon_loss: 4064711.2500; val_gene_expr_recon_loss: 597494.8125; val_masked_gp_l1_reg_loss: 4293.3623; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 795488.3750; val_global_loss: 5549429.0000; val_optim_loss: 5549429.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9319; val_auprc_score: 0.9387; val_best_acc_score: 0.5070; val_best_f1_score: 0.6698; train_kl_reg_loss: 28376.5414; train_edge_recon_loss: 3479909.7778; train_gene_expr_recon_loss: 597415.3958; train_masked_gp_l1_reg_loss: 4248.7558; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 795117.1944; train_global_loss: 4905067.5556; train_optim_loss: 4905067.5556; val_kl_reg_loss: 69038.6016; val_edge_recon_loss: 4064292.2500; val_gene_expr_recon_loss: 572708.2500; val_masked_gp_l1_reg_loss: 4256.4165; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 786597.0625; val_global_loss: 5496892.5000; val_optim_loss: 5496892.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9291; val_auprc_score: 0.9381; val_best_acc_score: 0.5137; val_best_f1_score: 0.6727; train_kl_reg_loss: 21604.0358; train_edge_recon_loss: 3482932.0556; train_gene_expr_recon_loss: 568116.2222; train_masked_gp_l1_reg_loss: 4313.5074; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 779663.3264; train_global_loss: 4856629.2778; train_optim_loss: 4856629.2778; val_kl_reg_loss: 33864.2383; val_edge_recon_loss: 4063364.2500; val_gene_expr_recon_loss: 555323.3125; val_masked_gp_l1_reg_loss: 4375.4375; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 779831.1250; val_global_loss: 5436758.5000; val_optim_loss: 5436758.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9166; val_auprc_score: 0.9240; val_best_acc_score: 0.5705; val_best_f1_score: 0.6992; train_kl_reg_loss: 21148.9061; train_edge_recon_loss: 3482893.1944; train_gene_expr_recon_loss: 553711.2083; train_masked_gp_l1_reg_loss: 4398.5595; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 774010.5694; train_global_loss: 4836162.5556; train_optim_loss: 4836162.5556; val_kl_reg_loss: 24335.7285; val_edge_recon_loss: 4060997.2500; val_gene_expr_recon_loss: 538889.0000; val_masked_gp_l1_reg_loss: 4410.1079; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 773327.5625; val_global_loss: 5401959.5000; val_optim_loss: 5401959.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9042; val_auprc_score: 0.9037; val_best_acc_score: 0.7445; val_best_f1_score: 0.7904; train_kl_reg_loss: 18481.3889; train_edge_recon_loss: 3480450.5556; train_gene_expr_recon_loss: 532461.7569; train_masked_gp_l1_reg_loss: 4405.5429; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 763391.4931; train_global_loss: 4799190.7222; train_optim_loss: 4799190.7222; val_kl_reg_loss: 17559.9531; val_edge_recon_loss: 4048303.2500; val_gene_expr_recon_loss: 523404.3125; val_masked_gp_l1_reg_loss: 4394.6660; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 767360.7500; val_global_loss: 5361023.0000; val_optim_loss: 5361023.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8837; val_auprc_score: 0.8742; val_best_acc_score: 0.8005; val_best_f1_score: 0.8015; train_kl_reg_loss: 18232.1931; train_edge_recon_loss: 3478237.7778; train_gene_expr_recon_loss: 513331.0000; train_masked_gp_l1_reg_loss: 4389.3675; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 759125.6944; train_global_loss: 4773316.0556; train_optim_loss: 4773316.0556; val_kl_reg_loss: 21689.7422; val_edge_recon_loss: 3998445.7500; val_gene_expr_recon_loss: 504805.4688; val_masked_gp_l1_reg_loss: 4382.7837; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 761059.0625; val_global_loss: 5290383.0000; val_optim_loss: 5290383.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8915; val_auprc_score: 0.8814; val_best_acc_score: 0.8068; val_best_f1_score: 0.8197; train_kl_reg_loss: 17512.8541; train_edge_recon_loss: 3462575.2778; train_gene_expr_recon_loss: 501231.7118; train_masked_gp_l1_reg_loss: 4386.9671; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 760357.5139; train_global_loss: 4746064.2222; train_optim_loss: 4746064.2222; val_kl_reg_loss: 15060.0264; val_edge_recon_loss: 3733643.5000; val_gene_expr_recon_loss: 498780.3750; val_masked_gp_l1_reg_loss: 4391.1729; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 758177.9375; val_global_loss: 5010053.0000; val_optim_loss: 5010053.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8846; val_auprc_score: 0.8783; val_best_acc_score: 0.8003; val_best_f1_score: 0.8098; train_kl_reg_loss: 9263.9076; train_edge_recon_loss: 3265601.1111; train_gene_expr_recon_loss: 519152.9757; train_masked_gp_l1_reg_loss: 4406.0814; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 762596.3056; train_global_loss: 4561020.3889; train_optim_loss: 4561020.3889; val_kl_reg_loss: 9243.1934; val_edge_recon_loss: 2895854.0000; val_gene_expr_recon_loss: 569371.7500; val_masked_gp_l1_reg_loss: 4423.5645; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 780379.2500; val_global_loss: 4259272.0000; val_optim_loss: 4259272.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9074; val_auprc_score: 0.8872; val_best_acc_score: 0.8374; val_best_f1_score: 0.8506; train_kl_reg_loss: 18727.3914; train_edge_recon_loss: 2830338.0556; train_gene_expr_recon_loss: 562891.9861; train_masked_gp_l1_reg_loss: 4444.4128; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 777697.7500; train_global_loss: 4194099.6389; train_optim_loss: 4194099.6389; val_kl_reg_loss: 28408.4863; val_edge_recon_loss: 2751501.5000; val_gene_expr_recon_loss: 555420.3750; val_masked_gp_l1_reg_loss: 4459.5278; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 774023.5625; val_global_loss: 4113813.5000; val_optim_loss: 4113813.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9133; val_auprc_score: 0.8864; val_best_acc_score: 0.8525; val_best_f1_score: 0.8634; train_kl_reg_loss: 32599.7925; train_edge_recon_loss: 2761084.9167; train_gene_expr_recon_loss: 539645.0694; train_masked_gp_l1_reg_loss: 4473.9671; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 765430.6806; train_global_loss: 4103234.4444; train_optim_loss: 4103234.4444; val_kl_reg_loss: 34720.0859; val_edge_recon_loss: 2777803.2500; val_gene_expr_recon_loss: 532870.8750; val_masked_gp_l1_reg_loss: 4486.6021; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 764322.8750; val_global_loss: 4114203.5000; val_optim_loss: 4114203.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9258; val_auprc_score: 0.9022; val_best_acc_score: 0.8620; val_best_f1_score: 0.8734; train_kl_reg_loss: 35285.0317; train_edge_recon_loss: 2732423.1111; train_gene_expr_recon_loss: 522873.7014; train_masked_gp_l1_reg_loss: 4486.8747; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 757942.6875; train_global_loss: 4053011.3889; train_optim_loss: 4053011.3889; val_kl_reg_loss: 34303.6953; val_edge_recon_loss: 2749696.0000; val_gene_expr_recon_loss: 516841.8750; val_masked_gp_l1_reg_loss: 4478.0044; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 758902.7500; val_global_loss: 4064222.2500; val_optim_loss: 4064222.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9287; val_auprc_score: 0.9064; val_best_acc_score: 0.8732; val_best_f1_score: 0.8826; train_kl_reg_loss: 34006.7066; train_edge_recon_loss: 2731685.3333; train_gene_expr_recon_loss: 509961.3681; train_masked_gp_l1_reg_loss: 4483.8033; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 753892.6319; train_global_loss: 4034029.8333; train_optim_loss: 4034029.8333; val_kl_reg_loss: 33874.7969; val_edge_recon_loss: 2732204.2500; val_gene_expr_recon_loss: 511000.2500; val_masked_gp_l1_reg_loss: 4485.0161; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 755896.3750; val_global_loss: 4037460.5000; val_optim_loss: 4037460.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9424; val_auprc_score: 0.9249; val_best_acc_score: 0.8864; val_best_f1_score: 0.8929; train_kl_reg_loss: 34806.0629; train_edge_recon_loss: 2733063.8056; train_gene_expr_recon_loss: 503172.3854; train_masked_gp_l1_reg_loss: 4488.4911; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 750292.3750; train_global_loss: 4025823.0556; train_optim_loss: 4025823.0556; val_kl_reg_loss: 35941.2812; val_edge_recon_loss: 2712543.0000; val_gene_expr_recon_loss: 498767.5312; val_masked_gp_l1_reg_loss: 4491.0244; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 751786.3750; val_global_loss: 4003529.0000; val_optim_loss: 4003529.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9388; val_auprc_score: 0.9171; val_best_acc_score: 0.8879; val_best_f1_score: 0.8954; train_kl_reg_loss: 36898.5851; train_edge_recon_loss: 2713480.5000; train_gene_expr_recon_loss: 495557.8368; train_masked_gp_l1_reg_loss: 4498.1744; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 748282.1458; train_global_loss: 3998717.2500; train_optim_loss: 3998717.2500; val_kl_reg_loss: 37076.2031; val_edge_recon_loss: 2723294.5000; val_gene_expr_recon_loss: 494824.5625; val_masked_gp_l1_reg_loss: 4502.7793; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 749020.0000; val_global_loss: 4008718.0000; val_optim_loss: 4008718.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9483; val_auprc_score: 0.9313; val_best_acc_score: 0.8941; val_best_f1_score: 0.9010; train_kl_reg_loss: 36946.0148; train_edge_recon_loss: 2715772.6389; train_gene_expr_recon_loss: 491069.5208; train_masked_gp_l1_reg_loss: 4515.1439; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 745756.0069; train_global_loss: 3994059.3056; train_optim_loss: 3994059.3056; val_kl_reg_loss: 36411.7266; val_edge_recon_loss: 2707423.2500; val_gene_expr_recon_loss: 493391.3750; val_masked_gp_l1_reg_loss: 4526.4702; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 746967.3125; val_global_loss: 3988720.2500; val_optim_loss: 3988720.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9529; val_auprc_score: 0.9352; val_best_acc_score: 0.9018; val_best_f1_score: 0.9077; train_kl_reg_loss: 36350.7756; train_edge_recon_loss: 2717689.5556; train_gene_expr_recon_loss: 484112.7014; train_masked_gp_l1_reg_loss: 4541.9173; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 740993.6111; train_global_loss: 3983688.5000; train_optim_loss: 3983688.5000; val_kl_reg_loss: 35895.6172; val_edge_recon_loss: 2712115.2500; val_gene_expr_recon_loss: 486127.1562; val_masked_gp_l1_reg_loss: 4548.9053; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 743549.0000; val_global_loss: 3982236.0000; val_optim_loss: 3982236.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9606; val_auprc_score: 0.9476; val_best_acc_score: 0.9074; val_best_f1_score: 0.9123; train_kl_reg_loss: 35851.3372; train_edge_recon_loss: 2701360.7500; train_gene_expr_recon_loss: 483040.6007; train_masked_gp_l1_reg_loss: 4560.1424; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 740571.2708; train_global_loss: 3965384.1389; train_optim_loss: 3965384.1389; val_kl_reg_loss: 35107.9609; val_edge_recon_loss: 2705019.7500; val_gene_expr_recon_loss: 487888.6250; val_masked_gp_l1_reg_loss: 4573.1880; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 743435.3125; val_global_loss: 3976025.0000; val_optim_loss: 3976025.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9652; val_auprc_score: 0.9505; val_best_acc_score: 0.9186; val_best_f1_score: 0.9222; train_kl_reg_loss: 35195.5217; train_edge_recon_loss: 2694218.1389; train_gene_expr_recon_loss: 480501.2153; train_masked_gp_l1_reg_loss: 4590.5455; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 738901.7569; train_global_loss: 3953407.1944; train_optim_loss: 3953407.1944; val_kl_reg_loss: 34580.7031; val_edge_recon_loss: 2687170.2500; val_gene_expr_recon_loss: 488230.8750; val_masked_gp_l1_reg_loss: 4603.9116; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 742284.6250; val_global_loss: 3956870.5000; val_optim_loss: 3956870.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9655; val_auprc_score: 0.9513; val_best_acc_score: 0.9223; val_best_f1_score: 0.9256; train_kl_reg_loss: 35207.1784; train_edge_recon_loss: 2678144.2778; train_gene_expr_recon_loss: 478452.0069; train_masked_gp_l1_reg_loss: 4623.0387; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 737825.0972; train_global_loss: 3934251.6111; train_optim_loss: 3934251.6111; val_kl_reg_loss: 36105.7969; val_edge_recon_loss: 2676666.7500; val_gene_expr_recon_loss: 480864.8125; val_masked_gp_l1_reg_loss: 4639.1123; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 739848.1875; val_global_loss: 3938124.5000; val_optim_loss: 3938124.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9685; val_auprc_score: 0.9543; val_best_acc_score: 0.9219; val_best_f1_score: 0.9251; train_kl_reg_loss: 37465.7821; train_edge_recon_loss: 2663026.2222; train_gene_expr_recon_loss: 475646.8854; train_masked_gp_l1_reg_loss: 4655.7422; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 737362.8194; train_global_loss: 3918157.4167; train_optim_loss: 3918157.4167; val_kl_reg_loss: 36904.3828; val_edge_recon_loss: 2677733.5000; val_gene_expr_recon_loss: 472988.6250; val_masked_gp_l1_reg_loss: 4667.4795; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 736620.3125; val_global_loss: 3928914.2500; val_optim_loss: 3928914.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9723; val_auprc_score: 0.9608; val_best_acc_score: 0.9278; val_best_f1_score: 0.9304; train_kl_reg_loss: 37802.6102; train_edge_recon_loss: 2670474.3889; train_gene_expr_recon_loss: 470443.5104; train_masked_gp_l1_reg_loss: 4679.8498; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731098.2639; train_global_loss: 3914498.6667; train_optim_loss: 3914498.6667; val_kl_reg_loss: 37034.3750; val_edge_recon_loss: 2673395.7500; val_gene_expr_recon_loss: 474576.8750; val_masked_gp_l1_reg_loss: 4691.6450; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 736272.7500; val_global_loss: 3925971.5000; val_optim_loss: 3925971.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9735; val_auprc_score: 0.9618; val_best_acc_score: 0.9316; val_best_f1_score: 0.9341; train_kl_reg_loss: 37147.0386; train_edge_recon_loss: 2657901.8611; train_gene_expr_recon_loss: 467968.7153; train_masked_gp_l1_reg_loss: 4704.0971; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 733598.7569; train_global_loss: 3901320.4444; train_optim_loss: 3901320.4444; val_kl_reg_loss: 36712.5469; val_edge_recon_loss: 2660222.0000; val_gene_expr_recon_loss: 473057.3750; val_masked_gp_l1_reg_loss: 4711.0112; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 734834.2500; val_global_loss: 3909537.2500; val_optim_loss: 3909537.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9731; val_auprc_score: 0.9615; val_best_acc_score: 0.9336; val_best_f1_score: 0.9365; train_kl_reg_loss: 36664.0521; train_edge_recon_loss: 2662081.8889; train_gene_expr_recon_loss: 463862.1493; train_masked_gp_l1_reg_loss: 4712.9347; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 725962.5417; train_global_loss: 3893283.5278; train_optim_loss: 3893283.5278; val_kl_reg_loss: 35902.0859; val_edge_recon_loss: 2650607.2500; val_gene_expr_recon_loss: 467617.5000; val_masked_gp_l1_reg_loss: 4712.8936; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 732758.6875; val_global_loss: 3891598.5000; val_optim_loss: 3891598.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9738; val_auprc_score: 0.9645; val_best_acc_score: 0.9309; val_best_f1_score: 0.9334; train_kl_reg_loss: 35838.1046; train_edge_recon_loss: 2659646.5833; train_gene_expr_recon_loss: 462375.4965; train_masked_gp_l1_reg_loss: 4710.0535; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728378.7153; train_global_loss: 3890948.9722; train_optim_loss: 3890948.9722; val_kl_reg_loss: 35183.5625; val_edge_recon_loss: 2663682.0000; val_gene_expr_recon_loss: 472029.8750; val_masked_gp_l1_reg_loss: 4705.0400; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 732941.1875; val_global_loss: 3908541.7500; val_optim_loss: 3908541.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9741; val_auprc_score: 0.9612; val_best_acc_score: 0.9364; val_best_f1_score: 0.9383; train_kl_reg_loss: 35225.6415; train_edge_recon_loss: 2654738.6667; train_gene_expr_recon_loss: 460870.9896; train_masked_gp_l1_reg_loss: 4709.5992; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 726158.5764; train_global_loss: 3881703.5556; train_optim_loss: 3881703.5556; val_kl_reg_loss: 35608.6953; val_edge_recon_loss: 2671866.0000; val_gene_expr_recon_loss: 463327.0312; val_masked_gp_l1_reg_loss: 4703.5830; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 729202.8750; val_global_loss: 3904708.0000; val_optim_loss: 3904708.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9759; val_auprc_score: 0.9650; val_best_acc_score: 0.9368; val_best_f1_score: 0.9388; train_kl_reg_loss: 35607.2843; train_edge_recon_loss: 2656213.0556; train_gene_expr_recon_loss: 466714.7326; train_masked_gp_l1_reg_loss: 4716.8824; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728944.3403; train_global_loss: 3892196.3333; train_optim_loss: 3892196.3333; val_kl_reg_loss: 28132.2988; val_edge_recon_loss: 2641113.0000; val_gene_expr_recon_loss: 470742.6875; val_masked_gp_l1_reg_loss: 4719.4985; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 731276.6875; val_global_loss: 3875984.2500; val_optim_loss: 3875984.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9755; val_auprc_score: 0.9642; val_best_acc_score: 0.9373; val_best_f1_score: 0.9393; train_kl_reg_loss: 36468.6376; train_edge_recon_loss: 2650863.8611; train_gene_expr_recon_loss: 462810.2674; train_masked_gp_l1_reg_loss: 4720.7158; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724713.3333; train_global_loss: 3879576.7778; train_optim_loss: 3879576.7778; val_kl_reg_loss: 28885.9336; val_edge_recon_loss: 2656991.5000; val_gene_expr_recon_loss: 466182.2188; val_masked_gp_l1_reg_loss: 4716.4395; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 728087.6250; val_global_loss: 3884864.0000; val_optim_loss: 3884864.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9758; val_auprc_score: 0.9682; val_best_acc_score: 0.9332; val_best_f1_score: 0.9351; train_kl_reg_loss: 35290.1931; train_edge_recon_loss: 2653448.5556; train_gene_expr_recon_loss: 460783.7465; train_masked_gp_l1_reg_loss: 4717.4169; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724660.6528; train_global_loss: 3878900.6111; train_optim_loss: 3878900.6111; val_kl_reg_loss: 27326.1523; val_edge_recon_loss: 2661600.0000; val_gene_expr_recon_loss: 466232.4062; val_masked_gp_l1_reg_loss: 4711.6138; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 727280.0625; val_global_loss: 3887150.2500; val_optim_loss: 3887150.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9768; val_auprc_score: 0.9659; val_best_acc_score: 0.9334; val_best_f1_score: 0.9359; train_kl_reg_loss: 34449.6571; train_edge_recon_loss: 2640870.0833; train_gene_expr_recon_loss: 459760.4583; train_masked_gp_l1_reg_loss: 4717.1260; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724768.3750; train_global_loss: 3864565.7222; train_optim_loss: 3864565.7222; val_kl_reg_loss: 28843.1914; val_edge_recon_loss: 2657325.2500; val_gene_expr_recon_loss: 464761.2812; val_masked_gp_l1_reg_loss: 4718.2852; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 726602.6250; val_global_loss: 3882250.5000; val_optim_loss: 3882250.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9784; val_auprc_score: 0.9708; val_best_acc_score: 0.9426; val_best_f1_score: 0.9444; train_kl_reg_loss: 34730.5603; train_edge_recon_loss: 2653167.7778; train_gene_expr_recon_loss: 457530.4410; train_masked_gp_l1_reg_loss: 4727.8711; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 720102.9514; train_global_loss: 3870259.6667; train_optim_loss: 3870259.6667; val_kl_reg_loss: 28272.8203; val_edge_recon_loss: 2647546.7500; val_gene_expr_recon_loss: 465520.8750; val_masked_gp_l1_reg_loss: 4730.5469; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 725524.4375; val_global_loss: 3871595.5000; val_optim_loss: 3871595.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9781; val_auprc_score: 0.9687; val_best_acc_score: 0.9402; val_best_f1_score: 0.9418; train_kl_reg_loss: 33786.2357; train_edge_recon_loss: 2640356.7222; train_gene_expr_recon_loss: 457304.7292; train_masked_gp_l1_reg_loss: 4736.4799; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 721797.9931; train_global_loss: 3857982.0833; train_optim_loss: 3857982.0833; val_kl_reg_loss: 29342.7148; val_edge_recon_loss: 2648787.0000; val_gene_expr_recon_loss: 465095.2188; val_masked_gp_l1_reg_loss: 4735.2471; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 724736.0625; val_global_loss: 3872696.2500; val_optim_loss: 3872696.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9769; val_auprc_score: 0.9679; val_best_acc_score: 0.9386; val_best_f1_score: 0.9401; train_kl_reg_loss: 34447.0894; train_edge_recon_loss: 2637989.8056; train_gene_expr_recon_loss: 453852.8507; train_masked_gp_l1_reg_loss: 4742.6642; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 719366.7153; train_global_loss: 3850399.0556; train_optim_loss: 3850399.0556; val_kl_reg_loss: 29897.7773; val_edge_recon_loss: 2657727.5000; val_gene_expr_recon_loss: 456816.7812; val_masked_gp_l1_reg_loss: 4744.3506; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 720789.5625; val_global_loss: 3869975.7500; val_optim_loss: 3869975.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9779; val_auprc_score: 0.9691; val_best_acc_score: 0.9398; val_best_f1_score: 0.9420; train_kl_reg_loss: 34829.1454; train_edge_recon_loss: 2648565.8333; train_gene_expr_recon_loss: 453382.6181; train_masked_gp_l1_reg_loss: 4753.7917; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 717118.2222; train_global_loss: 3858649.5833; train_optim_loss: 3858649.5833; val_kl_reg_loss: 30183.5703; val_edge_recon_loss: 2659333.2500; val_gene_expr_recon_loss: 461241.3438; val_masked_gp_l1_reg_loss: 4758.4482; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722503.2500; val_global_loss: 3878019.7500; val_optim_loss: 3878019.7500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9767; val_auprc_score: 0.9679; val_best_acc_score: 0.9382; val_best_f1_score: 0.9400; train_kl_reg_loss: 33498.9839; train_edge_recon_loss: 2644094.6667; train_gene_expr_recon_loss: 452824.0382; train_masked_gp_l1_reg_loss: 4771.5001; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 718243.9792; train_global_loss: 3853433.1667; train_optim_loss: 3853433.1667; val_kl_reg_loss: 28983.8691; val_edge_recon_loss: 2647612.7500; val_gene_expr_recon_loss: 462806.0938; val_masked_gp_l1_reg_loss: 4774.6968; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722373.3125; val_global_loss: 3866550.5000; val_optim_loss: 3866550.5000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9795; val_auprc_score: 0.9715; val_best_acc_score: 0.9392; val_best_f1_score: 0.9411; train_kl_reg_loss: 32749.6812; train_edge_recon_loss: 2639686.5278; train_gene_expr_recon_loss: 451208.7396; train_masked_gp_l1_reg_loss: 4783.0642; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714373.8958; train_global_loss: 3842801.9444; train_optim_loss: 3842801.9444; val_kl_reg_loss: 29557.0156; val_edge_recon_loss: 2656461.2500; val_gene_expr_recon_loss: 455435.8750; val_masked_gp_l1_reg_loss: 4785.9658; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718352.2500; val_global_loss: 3864592.2500; val_optim_loss: 3864592.2500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9817; val_auprc_score: 0.9757; val_best_acc_score: 0.9452; val_best_f1_score: 0.9470; train_kl_reg_loss: 33239.3503; train_edge_recon_loss: 2637689.5556; train_gene_expr_recon_loss: 449430.5972; train_masked_gp_l1_reg_loss: 4795.5238; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714408.4444; train_global_loss: 3839563.4722; train_optim_loss: 3839563.4722; val_kl_reg_loss: 28996.7500; val_edge_recon_loss: 2634589.0000; val_gene_expr_recon_loss: 456953.8438; val_masked_gp_l1_reg_loss: 4799.2192; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718159.0000; val_global_loss: 3843497.7500; val_optim_loss: 3843497.7500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9797; val_auprc_score: 0.9706; val_best_acc_score: 0.9417; val_best_f1_score: 0.9432; train_kl_reg_loss: 32948.6806; train_edge_recon_loss: 2634041.7778; train_gene_expr_recon_loss: 449388.7812; train_masked_gp_l1_reg_loss: 4809.4671; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 715584.5347; train_global_loss: 3836773.2500; train_optim_loss: 3836773.2500; val_kl_reg_loss: 29157.2695; val_edge_recon_loss: 2642976.0000; val_gene_expr_recon_loss: 455774.3750; val_masked_gp_l1_reg_loss: 4816.1812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 717478.4375; val_global_loss: 3850202.2500; val_optim_loss: 3850202.2500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9778; val_auprc_score: 0.9691; val_best_acc_score: 0.9392; val_best_f1_score: 0.9416; train_kl_reg_loss: 32622.0707; train_edge_recon_loss: 2631647.0000; train_gene_expr_recon_loss: 447219.7326; train_masked_gp_l1_reg_loss: 4833.0759; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 710596.4583; train_global_loss: 3826918.3889; train_optim_loss: 3826918.3889; val_kl_reg_loss: 29233.9727; val_edge_recon_loss: 2642141.0000; val_gene_expr_recon_loss: 457507.1250; val_masked_gp_l1_reg_loss: 4840.3018; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718122.9375; val_global_loss: 3851845.2500; val_optim_loss: 3851845.2500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9787; val_auprc_score: 0.9672; val_best_acc_score: 0.9380; val_best_f1_score: 0.9398; train_kl_reg_loss: 32732.0104; train_edge_recon_loss: 2637271.8056; train_gene_expr_recon_loss: 447731.1632; train_masked_gp_l1_reg_loss: 4849.7890; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712072.7431; train_global_loss: 3834657.5278; train_optim_loss: 3834657.5278; val_kl_reg_loss: 28756.9043; val_edge_recon_loss: 2657002.7500; val_gene_expr_recon_loss: 454126.6562; val_masked_gp_l1_reg_loss: 4855.8491; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 715972.6250; val_global_loss: 3860715.0000; val_optim_loss: 3860715.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9809; val_auprc_score: 0.9724; val_best_acc_score: 0.9421; val_best_f1_score: 0.9435; train_kl_reg_loss: 31771.2348; train_edge_recon_loss: 2641561.1111; train_gene_expr_recon_loss: 445681.9896; train_masked_gp_l1_reg_loss: 4867.6784; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 710530.7083; train_global_loss: 3834412.7222; train_optim_loss: 3834412.7222; val_kl_reg_loss: 28396.4297; val_edge_recon_loss: 2644046.0000; val_gene_expr_recon_loss: 451885.7188; val_masked_gp_l1_reg_loss: 4873.7500; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714386.0000; val_global_loss: 3843588.0000; val_optim_loss: 3843588.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9799; val_auprc_score: 0.9697; val_best_acc_score: 0.9419; val_best_f1_score: 0.9442; train_kl_reg_loss: 31606.1372; train_edge_recon_loss: 2639364.4722; train_gene_expr_recon_loss: 445999.6667; train_masked_gp_l1_reg_loss: 4864.9673; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 710173.3125; train_global_loss: 3832008.5278; train_optim_loss: 3832008.5278; val_kl_reg_loss: 27784.7578; val_edge_recon_loss: 2639779.5000; val_gene_expr_recon_loss: 456695.1875; val_masked_gp_l1_reg_loss: 4854.0918; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 716616.0625; val_global_loss: 3845729.5000; val_optim_loss: 3845729.5000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9788; val_auprc_score: 0.9702; val_best_acc_score: 0.9411; val_best_f1_score: 0.9427; train_kl_reg_loss: 31456.5731; train_edge_recon_loss: 2632559.1111; train_gene_expr_recon_loss: 446817.5868; train_masked_gp_l1_reg_loss: 4849.2381; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712123.0903; train_global_loss: 3827805.6111; train_optim_loss: 3827805.6111; val_kl_reg_loss: 28005.1016; val_edge_recon_loss: 2647746.7500; val_gene_expr_recon_loss: 453360.5000; val_masked_gp_l1_reg_loss: 4843.0977; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714996.3125; val_global_loss: 3848951.5000; val_optim_loss: 3848951.5000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9800; val_auprc_score: 0.9730; val_best_acc_score: 0.9399; val_best_f1_score: 0.9416; train_kl_reg_loss: 31680.5512; train_edge_recon_loss: 2638425.7778; train_gene_expr_recon_loss: 445171.8229; train_masked_gp_l1_reg_loss: 4840.0698; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 708676.6458; train_global_loss: 3828794.8889; train_optim_loss: 3828794.8889; val_kl_reg_loss: 27889.8555; val_edge_recon_loss: 2651467.5000; val_gene_expr_recon_loss: 454866.6250; val_masked_gp_l1_reg_loss: 4836.5552; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 715448.7500; val_global_loss: 3854509.2500; val_optim_loss: 3854509.2500
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9800; val_auprc_score: 0.9709; val_best_acc_score: 0.9433; val_best_f1_score: 0.9450; train_kl_reg_loss: 31376.3848; train_edge_recon_loss: 2631608.2500; train_gene_expr_recon_loss: 445869.0069; train_masked_gp_l1_reg_loss: 4834.8734; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 707710.2847; train_global_loss: 3821398.8889; train_optim_loss: 3821398.8889; val_kl_reg_loss: 27843.9844; val_edge_recon_loss: 2644958.5000; val_gene_expr_recon_loss: 453883.7500; val_masked_gp_l1_reg_loss: 4832.8232; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 715093.9375; val_global_loss: 3846613.0000; val_optim_loss: 3846613.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 51 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9795
val AUPRC score: 0.9718
val best accuracy score: 0.9421
val best F1 score: 0.9441
val target rna MSE score: 0.3979
val source rna MSE score: 0.2192
val target atac MSE score: 0.1371
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
