[True]
Run timestamp: 10082023_231319_93.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_93']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7322; val_auprc_score: 0.7650; val_best_acc_score: 0.5232; val_best_f1_score: 0.6757; train_kl_reg_loss: 127571.1822; train_edge_recon_loss: 3827244.8912; train_gene_expr_recon_loss: 46246940.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27897405.5267; train_global_loss: 78099161.7405; train_optim_loss: 78099161.7405; val_kl_reg_loss: 84422.3276; val_edge_recon_loss: 4063803.0667; val_gene_expr_recon_loss: 39760257.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 26138272.0000; val_global_loss: 70046754.4000; val_optim_loss: 70046754.4000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7523; val_auprc_score: 0.7804; val_best_acc_score: 0.5253; val_best_f1_score: 0.6757; train_kl_reg_loss: 132122.1639; train_edge_recon_loss: 3752708.8531; train_gene_expr_recon_loss: 38700679.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 26053762.5496; train_global_loss: 68639273.5573; train_optim_loss: 68639273.5573; val_kl_reg_loss: 149918.8885; val_edge_recon_loss: 4063409.4000; val_gene_expr_recon_loss: 37624211.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25567246.8000; val_global_loss: 67404785.6000; val_optim_loss: 67404785.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7877; val_auprc_score: 0.8090; val_best_acc_score: 0.6762; val_best_f1_score: 0.7261; train_kl_reg_loss: 157056.3343; train_edge_recon_loss: 3627884.2405; train_gene_expr_recon_loss: 37472879.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25659821.3740; train_global_loss: 66917641.4046; train_optim_loss: 66917641.4046; val_kl_reg_loss: 170582.0615; val_edge_recon_loss: 4051456.8167; val_gene_expr_recon_loss: 36903321.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25356165.3333; val_global_loss: 66481525.8667; val_optim_loss: 66481525.8667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8543; val_auprc_score: 0.8557; val_best_acc_score: 0.7305; val_best_f1_score: 0.7626; train_kl_reg_loss: 158272.1927; train_edge_recon_loss: 3553240.9389; train_gene_expr_recon_loss: 36912424.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25491577.3893; train_global_loss: 66115515.2366; train_optim_loss: 66115515.2366; val_kl_reg_loss: 146967.5271; val_edge_recon_loss: 3994902.7500; val_gene_expr_recon_loss: 36459792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25154029.0667; val_global_loss: 65755690.6667; val_optim_loss: 65755690.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8875; val_auprc_score: 0.8810; val_best_acc_score: 0.8077; val_best_f1_score: 0.8204; train_kl_reg_loss: 137569.7062; train_edge_recon_loss: 3510642.5248; train_gene_expr_recon_loss: 36531304.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25285790.9924; train_global_loss: 65465307.2366; train_optim_loss: 65465307.2366; val_kl_reg_loss: 128219.0146; val_edge_recon_loss: 3748357.9000; val_gene_expr_recon_loss: 36182021.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25061868.5333; val_global_loss: 65120467.2000; val_optim_loss: 65120467.2000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8878; val_auprc_score: 0.8795; val_best_acc_score: 0.8069; val_best_f1_score: 0.8135; train_kl_reg_loss: 130554.9426; train_edge_recon_loss: 3252018.3779; train_gene_expr_recon_loss: 36258034.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25133819.6947; train_global_loss: 64774427.6336; train_optim_loss: 64774427.6336; val_kl_reg_loss: 160376.1281; val_edge_recon_loss: 3051207.6000; val_gene_expr_recon_loss: 35802530.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24853783.8667; val_global_loss: 63867899.2000; val_optim_loss: 63867899.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8882; val_auprc_score: 0.8785; val_best_acc_score: 0.8007; val_best_f1_score: 0.8161; train_kl_reg_loss: 167986.8542; train_edge_recon_loss: 3020177.4542; train_gene_expr_recon_loss: 36038126.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25037184.4122; train_global_loss: 64263475.6031; train_optim_loss: 64263475.6031; val_kl_reg_loss: 166970.6823; val_edge_recon_loss: 2992364.7667; val_gene_expr_recon_loss: 35567793.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24751178.1333; val_global_loss: 63478306.6667; val_optim_loss: 63478306.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9025; val_auprc_score: 0.8913; val_best_acc_score: 0.8199; val_best_f1_score: 0.8320; train_kl_reg_loss: 164714.6223; train_edge_recon_loss: 2979234.0992; train_gene_expr_recon_loss: 35843324.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24936915.8321; train_global_loss: 63924189.2214; train_optim_loss: 63924189.2214; val_kl_reg_loss: 149504.4385; val_edge_recon_loss: 3031558.4500; val_gene_expr_recon_loss: 35490324.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24586751.7333; val_global_loss: 63258139.4667; val_optim_loss: 63258139.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9161; val_auprc_score: 0.9034; val_best_acc_score: 0.8395; val_best_f1_score: 0.8481; train_kl_reg_loss: 151344.8492; train_edge_recon_loss: 2973263.7729; train_gene_expr_recon_loss: 35736784.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24876502.2901; train_global_loss: 63737895.4809; train_optim_loss: 63737895.4809; val_kl_reg_loss: 152192.5365; val_edge_recon_loss: 2927311.7000; val_gene_expr_recon_loss: 36024548.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24566643.2000; val_global_loss: 63670696.0000; val_optim_loss: 63670696.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9179; val_auprc_score: 0.9068; val_best_acc_score: 0.8430; val_best_f1_score: 0.8519; train_kl_reg_loss: 155810.7032; train_edge_recon_loss: 2919666.1050; train_gene_expr_recon_loss: 35570308.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24747862.6107; train_global_loss: 63393647.6031; train_optim_loss: 63393647.6031; val_kl_reg_loss: 155885.6583; val_edge_recon_loss: 2923366.4833; val_gene_expr_recon_loss: 35282216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24579316.8000; val_global_loss: 62940784.5333; val_optim_loss: 62940784.5333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9259; val_auprc_score: 0.9143; val_best_acc_score: 0.8557; val_best_f1_score: 0.8653; train_kl_reg_loss: 152914.1460; train_edge_recon_loss: 2891770.8969; train_gene_expr_recon_loss: 35364586.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24669830.6870; train_global_loss: 63079102.3206; train_optim_loss: 63079102.3206; val_kl_reg_loss: 149945.5229; val_edge_recon_loss: 2917664.0833; val_gene_expr_recon_loss: 35093340.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24469403.2000; val_global_loss: 62630352.5333; val_optim_loss: 62630352.5333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9331; val_auprc_score: 0.9226; val_best_acc_score: 0.8623; val_best_f1_score: 0.8700; train_kl_reg_loss: 146272.3148; train_edge_recon_loss: 2891923.6622; train_gene_expr_recon_loss: 35290426.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24657769.5725; train_global_loss: 62986392.2137; train_optim_loss: 62986392.2137; val_kl_reg_loss: 146943.6417; val_edge_recon_loss: 2877543.2167; val_gene_expr_recon_loss: 34959511.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24409879.3333; val_global_loss: 62393877.0667; val_optim_loss: 62393877.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9407; val_auprc_score: 0.9304; val_best_acc_score: 0.8721; val_best_f1_score: 0.8797; train_kl_reg_loss: 143051.3494; train_edge_recon_loss: 2860988.7844; train_gene_expr_recon_loss: 35220344.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24613058.3817; train_global_loss: 62837443.4504; train_optim_loss: 62837443.4504; val_kl_reg_loss: 139645.4802; val_edge_recon_loss: 2858275.8333; val_gene_expr_recon_loss: 34872619.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24318403.0667; val_global_loss: 62188943.4667; val_optim_loss: 62188943.4667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9391; val_auprc_score: 0.9280; val_best_acc_score: 0.8729; val_best_f1_score: 0.8788; train_kl_reg_loss: 139349.6113; train_edge_recon_loss: 2840251.9408; train_gene_expr_recon_loss: 35095296.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24539679.7099; train_global_loss: 62614577.6183; train_optim_loss: 62614577.6183; val_kl_reg_loss: 136933.8911; val_edge_recon_loss: 2872372.8167; val_gene_expr_recon_loss: 34862648.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24271044.9333; val_global_loss: 62143000.0000; val_optim_loss: 62143000.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9488; val_auprc_score: 0.9397; val_best_acc_score: 0.8826; val_best_f1_score: 0.8880; train_kl_reg_loss: 136411.1995; train_edge_recon_loss: 2828091.6775; train_gene_expr_recon_loss: 35003211.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24491143.1908; train_global_loss: 62458857.7710; train_optim_loss: 62458857.7710; val_kl_reg_loss: 136925.7979; val_edge_recon_loss: 2852934.7667; val_gene_expr_recon_loss: 34748417.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24320700.1333; val_global_loss: 62058977.8667; val_optim_loss: 62058977.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9498; val_auprc_score: 0.9406; val_best_acc_score: 0.8866; val_best_f1_score: 0.8905; train_kl_reg_loss: 132137.6384; train_edge_recon_loss: 2823584.3397; train_gene_expr_recon_loss: 34909321.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24444012.5649; train_global_loss: 62309056.5496; train_optim_loss: 62309056.5496; val_kl_reg_loss: 128183.7010; val_edge_recon_loss: 2830361.9333; val_gene_expr_recon_loss: 34547439.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24120046.2667; val_global_loss: 61626031.7333; val_optim_loss: 61626031.7333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9540; val_auprc_score: 0.9454; val_best_acc_score: 0.8919; val_best_f1_score: 0.8975; train_kl_reg_loss: 130121.5754; train_edge_recon_loss: 2805550.4828; train_gene_expr_recon_loss: 34869625.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24413442.8092; train_global_loss: 62218740.2748; train_optim_loss: 62218740.2748; val_kl_reg_loss: 127405.8823; val_edge_recon_loss: 2814547.6000; val_gene_expr_recon_loss: 34644130.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24237272.6667; val_global_loss: 61823356.5333; val_optim_loss: 61823356.5333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9583; val_auprc_score: 0.9516; val_best_acc_score: 0.8948; val_best_f1_score: 0.8991; train_kl_reg_loss: 127344.1370; train_edge_recon_loss: 2789823.4790; train_gene_expr_recon_loss: 34765182.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24358488.9160; train_global_loss: 62040839.1145; train_optim_loss: 62040839.1145; val_kl_reg_loss: 126008.5807; val_edge_recon_loss: 2791097.8167; val_gene_expr_recon_loss: 34684797.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24338581.3333; val_global_loss: 61940485.6000; val_optim_loss: 61940485.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9548; val_auprc_score: 0.9466; val_best_acc_score: 0.8907; val_best_f1_score: 0.8947; train_kl_reg_loss: 124928.8031; train_edge_recon_loss: 2786539.5878; train_gene_expr_recon_loss: 34702101.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24341541.8473; train_global_loss: 61955111.3893; train_optim_loss: 61955111.3893; val_kl_reg_loss: 122265.8589; val_edge_recon_loss: 2817816.6000; val_gene_expr_recon_loss: 34362804.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24044298.4000; val_global_loss: 61347184.8000; val_optim_loss: 61347184.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9610; val_auprc_score: 0.9547; val_best_acc_score: 0.9007; val_best_f1_score: 0.9043; train_kl_reg_loss: 123204.1260; train_edge_recon_loss: 2776812.6508; train_gene_expr_recon_loss: 34638413.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24301120.5496; train_global_loss: 61839550.8092; train_optim_loss: 61839550.8092; val_kl_reg_loss: 122128.9479; val_edge_recon_loss: 2775906.9833; val_gene_expr_recon_loss: 34402626.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24086145.3333; val_global_loss: 61386806.6667; val_optim_loss: 61386806.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9625; val_auprc_score: 0.9549; val_best_acc_score: 0.9018; val_best_f1_score: 0.9057; train_kl_reg_loss: 120470.9271; train_edge_recon_loss: 2771917.6355; train_gene_expr_recon_loss: 34626303.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24324271.2214; train_global_loss: 61842963.1756; train_optim_loss: 61842963.1756; val_kl_reg_loss: 120236.8766; val_edge_recon_loss: 2775503.9667; val_gene_expr_recon_loss: 34309004.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24070626.2667; val_global_loss: 61275371.7333; val_optim_loss: 61275371.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9651; val_auprc_score: 0.9562; val_best_acc_score: 0.9069; val_best_f1_score: 0.9096; train_kl_reg_loss: 117906.6024; train_edge_recon_loss: 2766402.3073; train_gene_expr_recon_loss: 34599660.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24328555.2214; train_global_loss: 61812524.6412; train_optim_loss: 61812524.6412; val_kl_reg_loss: 118343.7589; val_edge_recon_loss: 2769656.0167; val_gene_expr_recon_loss: 34399638.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24141128.4000; val_global_loss: 61428765.8667; val_optim_loss: 61428765.8667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9660; val_auprc_score: 0.9593; val_best_acc_score: 0.9042; val_best_f1_score: 0.9076; train_kl_reg_loss: 116202.5829; train_edge_recon_loss: 2756617.7538; train_gene_expr_recon_loss: 34493954.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24259513.7099; train_global_loss: 61626289.0076; train_optim_loss: 61626289.0076; val_kl_reg_loss: 114766.0807; val_edge_recon_loss: 2754631.4833; val_gene_expr_recon_loss: 34116851.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23926234.0000; val_global_loss: 60912482.6667; val_optim_loss: 60912482.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9616; val_auprc_score: 0.9543; val_best_acc_score: 0.8996; val_best_f1_score: 0.9041; train_kl_reg_loss: 114818.6164; train_edge_recon_loss: 2758254.7385; train_gene_expr_recon_loss: 34666375.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24346902.1221; train_global_loss: 61886350.8092; train_optim_loss: 61886350.8092; val_kl_reg_loss: 112080.9500; val_edge_recon_loss: 2777758.8000; val_gene_expr_recon_loss: 34509662.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24046414.9333; val_global_loss: 61445917.0667; val_optim_loss: 61445917.0667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9651; val_auprc_score: 0.9566; val_best_acc_score: 0.9039; val_best_f1_score: 0.9083; train_kl_reg_loss: 112920.1331; train_edge_recon_loss: 2751305.6355; train_gene_expr_recon_loss: 34468108.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24225581.0534; train_global_loss: 61557915.3893; train_optim_loss: 61557915.3893; val_kl_reg_loss: 113339.8302; val_edge_recon_loss: 2753007.5667; val_gene_expr_recon_loss: 34303377.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24109520.8000; val_global_loss: 61279245.8667; val_optim_loss: 61279245.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9698; val_auprc_score: 0.9643; val_best_acc_score: 0.9143; val_best_f1_score: 0.9169; train_kl_reg_loss: 118323.9018; train_edge_recon_loss: 2779357.8130; train_gene_expr_recon_loss: 34991841.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24373466.4122; train_global_loss: 62262989.3130; train_optim_loss: 62262989.3130; val_kl_reg_loss: 84417.8255; val_edge_recon_loss: 2768257.7000; val_gene_expr_recon_loss: 34806057.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24180708.2667; val_global_loss: 61839441.8667; val_optim_loss: 61839441.8667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9703; val_auprc_score: 0.9629; val_best_acc_score: 0.9146; val_best_f1_score: 0.9181; train_kl_reg_loss: 117551.9957; train_edge_recon_loss: 2755319.6221; train_gene_expr_recon_loss: 34910212.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24352709.5725; train_global_loss: 62135793.5267; train_optim_loss: 62135793.5267; val_kl_reg_loss: 87148.7146; val_edge_recon_loss: 2756077.9500; val_gene_expr_recon_loss: 34848624.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24317344.5333; val_global_loss: 62009195.7333; val_optim_loss: 62009195.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9707; val_auprc_score: 0.9655; val_best_acc_score: 0.9113; val_best_f1_score: 0.9150; train_kl_reg_loss: 115938.3862; train_edge_recon_loss: 2746651.9198; train_gene_expr_recon_loss: 34812576.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24298974.8092; train_global_loss: 61974141.7099; train_optim_loss: 61974141.7099; val_kl_reg_loss: 87148.3938; val_edge_recon_loss: 2761712.7000; val_gene_expr_recon_loss: 34479100.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24029103.8667; val_global_loss: 61357065.3333; val_optim_loss: 61357065.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9706; val_auprc_score: 0.9621; val_best_acc_score: 0.9162; val_best_f1_score: 0.9190; train_kl_reg_loss: 115803.7168; train_edge_recon_loss: 2751133.1260; train_gene_expr_recon_loss: 34821803.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24316684.2748; train_global_loss: 62005424.2443; train_optim_loss: 62005424.2443; val_kl_reg_loss: 87548.7823; val_edge_recon_loss: 2754415.9333; val_gene_expr_recon_loss: 34763778.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24188530.0000; val_global_loss: 61794273.6000; val_optim_loss: 61794273.6000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9682; val_auprc_score: 0.9583; val_best_acc_score: 0.9096; val_best_f1_score: 0.9142; train_kl_reg_loss: 115019.2357; train_edge_recon_loss: 2749284.4256; train_gene_expr_recon_loss: 34800947.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24295628.4733; train_global_loss: 61960879.1756; train_optim_loss: 61960879.1756; val_kl_reg_loss: 87860.5177; val_edge_recon_loss: 2743545.1833; val_gene_expr_recon_loss: 34543333.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24151751.0667; val_global_loss: 61526490.6667; val_optim_loss: 61526490.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9713; val_auprc_score: 0.9650; val_best_acc_score: 0.9146; val_best_f1_score: 0.9170; train_kl_reg_loss: 114539.1325; train_edge_recon_loss: 2749885.6679; train_gene_expr_recon_loss: 34803579.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24330457.3435; train_global_loss: 61998461.7405; train_optim_loss: 61998461.7405; val_kl_reg_loss: 87570.5073; val_edge_recon_loss: 2755614.3833; val_gene_expr_recon_loss: 34440569.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23980975.2000; val_global_loss: 61264729.6000; val_optim_loss: 61264729.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 9 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9693
val AUPRC score: 0.9644
val best accuracy score: 0.9091
val best F1 score: 0.9117
val target rna MSE score: 1.1019
val source rna MSE score: 124.0147
val target atac MSE score: 0.3387
val source atac MSE score: 2.5698
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
