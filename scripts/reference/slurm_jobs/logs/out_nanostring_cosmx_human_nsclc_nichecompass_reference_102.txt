[True, False, True]
Run timestamp: 29092023_233507_102.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_102']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 480575
Number of validation nodes: 53397
Number of training edges: 1134287
Number of validation edges: 126031
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8868; val_auprc_score: 0.9750; val_best_acc_score: 0.9052; val_best_f1_score: 0.9464; train_kl_reg_loss: 16124.3476; train_edge_recon_loss: 837157.5890; train_cat_covariates_contrastive_loss: 951498.1696; train_gene_expr_recon_loss: 2768560.3383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4573340.4464; train_optim_loss: 4573340.4464; val_kl_reg_loss: 18081.4843; val_edge_recon_loss: 832784.6589; val_cat_covariates_contrastive_loss: 950363.2874; val_gene_expr_recon_loss: 2435367.3836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4236596.8289; val_optim_loss: 4236596.8289
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9100; val_auprc_score: 0.9795; val_best_acc_score: 0.9176; val_best_f1_score: 0.9529; train_kl_reg_loss: 19708.1036; train_edge_recon_loss: 803209.7481; train_cat_covariates_contrastive_loss: 951965.5002; train_gene_expr_recon_loss: 2272470.7717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4047354.1261; train_optim_loss: 4047354.1261; val_kl_reg_loss: 20539.1918; val_edge_recon_loss: 823213.8735; val_cat_covariates_contrastive_loss: 951443.5691; val_gene_expr_recon_loss: 2149140.9717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3944337.6053; val_optim_loss: 3944337.6053
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9148; val_auprc_score: 0.9809; val_best_acc_score: 0.9197; val_best_f1_score: 0.9542; train_kl_reg_loss: 21714.2097; train_edge_recon_loss: 797625.1826; train_cat_covariates_contrastive_loss: 951899.9497; train_gene_expr_recon_loss: 2102016.8661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3873256.2071; train_optim_loss: 3873256.2071; val_kl_reg_loss: 21898.1607; val_edge_recon_loss: 821806.8806; val_cat_covariates_contrastive_loss: 952558.0714; val_gene_expr_recon_loss: 2065291.3775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3861554.4889; val_optim_loss: 3861554.4889
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9125; val_auprc_score: 0.9797; val_best_acc_score: 0.9178; val_best_f1_score: 0.9529; train_kl_reg_loss: 22619.4656; train_edge_recon_loss: 795288.5562; train_cat_covariates_contrastive_loss: 951610.3333; train_gene_expr_recon_loss: 2039526.5873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3809044.9404; train_optim_loss: 3809044.9404; val_kl_reg_loss: 23780.0309; val_edge_recon_loss: 831099.0020; val_cat_covariates_contrastive_loss: 950404.6668; val_gene_expr_recon_loss: 2030443.8305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3835727.5364; val_optim_loss: 3835727.5364
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9212; val_auprc_score: 0.9827; val_best_acc_score: 0.9167; val_best_f1_score: 0.9523; train_kl_reg_loss: 23206.9567; train_edge_recon_loss: 791127.9957; train_cat_covariates_contrastive_loss: 951577.9292; train_gene_expr_recon_loss: 2006719.8780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3772632.7608; train_optim_loss: 3772632.7608; val_kl_reg_loss: 22455.0046; val_edge_recon_loss: 818484.8117; val_cat_covariates_contrastive_loss: 952581.6538; val_gene_expr_recon_loss: 1997857.5506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3791379.0182; val_optim_loss: 3791379.0182
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9158; val_auprc_score: 0.9810; val_best_acc_score: 0.9186; val_best_f1_score: 0.9536; train_kl_reg_loss: 23494.1492; train_edge_recon_loss: 788642.8104; train_cat_covariates_contrastive_loss: 951448.1610; train_gene_expr_recon_loss: 1986785.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3750370.6802; train_optim_loss: 3750370.6802; val_kl_reg_loss: 24499.2865; val_edge_recon_loss: 807149.1364; val_cat_covariates_contrastive_loss: 949822.3882; val_gene_expr_recon_loss: 1978343.0673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3759813.8796; val_optim_loss: 3759813.8796
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9201; val_auprc_score: 0.9822; val_best_acc_score: 0.9187; val_best_f1_score: 0.9536; train_kl_reg_loss: 23844.8894; train_edge_recon_loss: 791639.2224; train_cat_covariates_contrastive_loss: 951442.1533; train_gene_expr_recon_loss: 1973353.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3740279.4993; train_optim_loss: 3740279.4993; val_kl_reg_loss: 23573.6259; val_edge_recon_loss: 815657.2854; val_cat_covariates_contrastive_loss: 952954.0792; val_gene_expr_recon_loss: 1966155.7864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3758340.7905; val_optim_loss: 3758340.7905
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9136; val_auprc_score: 0.9797; val_best_acc_score: 0.9210; val_best_f1_score: 0.9548; train_kl_reg_loss: 24105.6317; train_edge_recon_loss: 787821.8124; train_cat_covariates_contrastive_loss: 951425.2527; train_gene_expr_recon_loss: 1959164.7242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3722517.4208; train_optim_loss: 3722517.4208; val_kl_reg_loss: 25216.0961; val_edge_recon_loss: 825736.7303; val_cat_covariates_contrastive_loss: 948897.0205; val_gene_expr_recon_loss: 1954374.2050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3754224.0516; val_optim_loss: 3754224.0516
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9174; val_auprc_score: 0.9807; val_best_acc_score: 0.9236; val_best_f1_score: 0.9563; train_kl_reg_loss: 24368.0491; train_edge_recon_loss: 792033.3051; train_cat_covariates_contrastive_loss: 951448.6765; train_gene_expr_recon_loss: 1949693.2373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3717543.2666; train_optim_loss: 3717543.2666; val_kl_reg_loss: 25907.0911; val_edge_recon_loss: 811881.5157; val_cat_covariates_contrastive_loss: 948776.7181; val_gene_expr_recon_loss: 1944469.3699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3731034.6953; val_optim_loss: 3731034.6953
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9248; val_auprc_score: 0.9830; val_best_acc_score: 0.9235; val_best_f1_score: 0.9562; train_kl_reg_loss: 24579.2638; train_edge_recon_loss: 789855.0335; train_cat_covariates_contrastive_loss: 951585.1003; train_gene_expr_recon_loss: 1938748.0338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3704767.4297; train_optim_loss: 3704767.4297; val_kl_reg_loss: 25179.8562; val_edge_recon_loss: 812276.0572; val_cat_covariates_contrastive_loss: 950696.5144; val_gene_expr_recon_loss: 1942520.8785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3730673.3067; val_optim_loss: 3730673.3067
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9198; val_auprc_score: 0.9814; val_best_acc_score: 0.9229; val_best_f1_score: 0.9559; train_kl_reg_loss: 24863.2667; train_edge_recon_loss: 790421.2679; train_cat_covariates_contrastive_loss: 951701.4078; train_gene_expr_recon_loss: 1930372.4859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3697358.4285; train_optim_loss: 3697358.4285; val_kl_reg_loss: 24963.2647; val_edge_recon_loss: 819406.5283; val_cat_covariates_contrastive_loss: 950700.3502; val_gene_expr_recon_loss: 1925056.8406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3720126.9828; val_optim_loss: 3720126.9828
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9193; val_auprc_score: 0.9808; val_best_acc_score: 0.9258; val_best_f1_score: 0.9576; train_kl_reg_loss: 25098.5589; train_edge_recon_loss: 787825.2244; train_cat_covariates_contrastive_loss: 951674.6906; train_gene_expr_recon_loss: 1925356.9248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3689955.3925; train_optim_loss: 3689955.3925; val_kl_reg_loss: 25318.6476; val_edge_recon_loss: 820276.5205; val_cat_covariates_contrastive_loss: 950307.0962; val_gene_expr_recon_loss: 1921161.0354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3717063.2986; val_optim_loss: 3717063.2986
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9190; val_auprc_score: 0.9811; val_best_acc_score: 0.9234; val_best_f1_score: 0.9561; train_kl_reg_loss: 25279.7040; train_edge_recon_loss: 787443.8283; train_cat_covariates_contrastive_loss: 951640.7693; train_gene_expr_recon_loss: 1917802.5197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3682166.8214; train_optim_loss: 3682166.8214; val_kl_reg_loss: 26348.3274; val_edge_recon_loss: 818380.8148; val_cat_covariates_contrastive_loss: 949715.2809; val_gene_expr_recon_loss: 1917082.5137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3711526.9302; val_optim_loss: 3711526.9302
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9178; val_auprc_score: 0.9809; val_best_acc_score: 0.9187; val_best_f1_score: 0.9534; train_kl_reg_loss: 25476.6450; train_edge_recon_loss: 791475.3222; train_cat_covariates_contrastive_loss: 951699.5567; train_gene_expr_recon_loss: 1912066.9935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3680718.5164; train_optim_loss: 3680718.5164; val_kl_reg_loss: 25933.8769; val_edge_recon_loss: 817403.9742; val_cat_covariates_contrastive_loss: 951356.8639; val_gene_expr_recon_loss: 1912717.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3707412.0800; val_optim_loss: 3707412.0800
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9316; val_auprc_score: 0.9849; val_best_acc_score: 0.9281; val_best_f1_score: 0.9588; train_kl_reg_loss: 25641.8150; train_edge_recon_loss: 789619.7697; train_cat_covariates_contrastive_loss: 951910.8044; train_gene_expr_recon_loss: 1905858.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3673031.0329; train_optim_loss: 3673031.0329; val_kl_reg_loss: 24395.8687; val_edge_recon_loss: 812919.0337; val_cat_covariates_contrastive_loss: 955623.3798; val_gene_expr_recon_loss: 1903805.8067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3696744.0830; val_optim_loss: 3696744.0830
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9278; val_auprc_score: 0.9835; val_best_acc_score: 0.9270; val_best_f1_score: 0.9582; train_kl_reg_loss: 25714.4711; train_edge_recon_loss: 787023.9742; train_cat_covariates_contrastive_loss: 951898.2943; train_gene_expr_recon_loss: 1899809.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3664446.0985; train_optim_loss: 3664446.0985; val_kl_reg_loss: 25435.9119; val_edge_recon_loss: 815806.4165; val_cat_covariates_contrastive_loss: 951896.4294; val_gene_expr_recon_loss: 1900340.5294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3693479.2895; val_optim_loss: 3693479.2895
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9278; val_auprc_score: 0.9836; val_best_acc_score: 0.9264; val_best_f1_score: 0.9579; train_kl_reg_loss: 25979.6852; train_edge_recon_loss: 787456.4845; train_cat_covariates_contrastive_loss: 951795.0142; train_gene_expr_recon_loss: 1898333.5027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3663564.6849; train_optim_loss: 3663564.6849; val_kl_reg_loss: 25854.9045; val_edge_recon_loss: 812803.9929; val_cat_covariates_contrastive_loss: 952838.1293; val_gene_expr_recon_loss: 1894532.6108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3686029.6366; val_optim_loss: 3686029.6366
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9239; val_auprc_score: 0.9825; val_best_acc_score: 0.9229; val_best_f1_score: 0.9558; train_kl_reg_loss: 26099.9766; train_edge_recon_loss: 786930.9974; train_cat_covariates_contrastive_loss: 951769.3305; train_gene_expr_recon_loss: 1892437.1533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3657237.4552; train_optim_loss: 3657237.4552; val_kl_reg_loss: 27508.6954; val_edge_recon_loss: 812354.4810; val_cat_covariates_contrastive_loss: 949858.1733; val_gene_expr_recon_loss: 1893837.3563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3683558.6964; val_optim_loss: 3683558.6964
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9221; val_auprc_score: 0.9821; val_best_acc_score: 0.9240; val_best_f1_score: 0.9566; train_kl_reg_loss: 26163.0556; train_edge_recon_loss: 788619.3564; train_cat_covariates_contrastive_loss: 952079.9674; train_gene_expr_recon_loss: 1889068.5570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3655930.9373; train_optim_loss: 3655930.9373; val_kl_reg_loss: 25779.0047; val_edge_recon_loss: 806497.8105; val_cat_covariates_contrastive_loss: 951800.4180; val_gene_expr_recon_loss: 1896634.2829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3680711.5152; val_optim_loss: 3680711.5152
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9257; val_auprc_score: 0.9832; val_best_acc_score: 0.9254; val_best_f1_score: 0.9574; train_kl_reg_loss: 26343.1432; train_edge_recon_loss: 787684.6656; train_cat_covariates_contrastive_loss: 951995.8149; train_gene_expr_recon_loss: 1887349.4823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3653373.1062; train_optim_loss: 3653373.1062; val_kl_reg_loss: 26433.2876; val_edge_recon_loss: 813569.3773; val_cat_covariates_contrastive_loss: 952017.2535; val_gene_expr_recon_loss: 1881194.3578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3673214.2753; val_optim_loss: 3673214.2753
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9289; val_auprc_score: 0.9838; val_best_acc_score: 0.9259; val_best_f1_score: 0.9576; train_kl_reg_loss: 26386.7675; train_edge_recon_loss: 786034.5920; train_cat_covariates_contrastive_loss: 952010.6889; train_gene_expr_recon_loss: 1882456.9066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3646888.9541; train_optim_loss: 3646888.9541; val_kl_reg_loss: 25735.1991; val_edge_recon_loss: 818214.0693; val_cat_covariates_contrastive_loss: 953420.2100; val_gene_expr_recon_loss: 1891804.9828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3689174.4646; val_optim_loss: 3689174.4646
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9234; val_auprc_score: 0.9817; val_best_acc_score: 0.9272; val_best_f1_score: 0.9582; train_kl_reg_loss: 26534.5531; train_edge_recon_loss: 786660.2280; train_cat_covariates_contrastive_loss: 952085.6457; train_gene_expr_recon_loss: 1882670.7461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3647951.1748; train_optim_loss: 3647951.1748; val_kl_reg_loss: 27058.8632; val_edge_recon_loss: 819354.3672; val_cat_covariates_contrastive_loss: 950376.8527; val_gene_expr_recon_loss: 1887917.5213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3684707.6032; val_optim_loss: 3684707.6032
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9222; val_auprc_score: 0.9811; val_best_acc_score: 0.9285; val_best_f1_score: 0.9590; train_kl_reg_loss: 26710.6888; train_edge_recon_loss: 787166.2548; train_cat_covariates_contrastive_loss: 952148.9344; train_gene_expr_recon_loss: 1878228.4049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3644254.2832; train_optim_loss: 3644254.2832; val_kl_reg_loss: 27691.3750; val_edge_recon_loss: 816898.5982; val_cat_covariates_contrastive_loss: 949874.6093; val_gene_expr_recon_loss: 1878311.2950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3672775.8785; val_optim_loss: 3672775.8785
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9300; val_auprc_score: 0.9844; val_best_acc_score: 0.9234; val_best_f1_score: 0.9560; train_kl_reg_loss: 26586.0131; train_edge_recon_loss: 788212.3163; train_cat_covariates_contrastive_loss: 952035.6493; train_gene_expr_recon_loss: 1876572.3235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3643406.3043; train_optim_loss: 3643406.3043; val_kl_reg_loss: 26114.5794; val_edge_recon_loss: 817752.1576; val_cat_covariates_contrastive_loss: 953771.3262; val_gene_expr_recon_loss: 1873816.4919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3671454.5506; val_optim_loss: 3671454.5506
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9281; val_auprc_score: 0.9833; val_best_acc_score: 0.9286; val_best_f1_score: 0.9591; train_kl_reg_loss: 26692.8219; train_edge_recon_loss: 789670.3691; train_cat_covariates_contrastive_loss: 952148.2325; train_gene_expr_recon_loss: 1874737.5349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3643248.9593; train_optim_loss: 3643248.9593; val_kl_reg_loss: 27067.9658; val_edge_recon_loss: 810075.6032; val_cat_covariates_contrastive_loss: 951073.0716; val_gene_expr_recon_loss: 1875805.1761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3664021.8148; val_optim_loss: 3664021.8148
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9266; val_auprc_score: 0.9833; val_best_acc_score: 0.9252; val_best_f1_score: 0.9572; train_kl_reg_loss: 27824.8914; train_edge_recon_loss: 792147.1966; train_cat_covariates_contrastive_loss: 953397.2829; train_gene_expr_recon_loss: 1870804.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3644174.2868; train_optim_loss: 3644174.2868; val_kl_reg_loss: 23148.1896; val_edge_recon_loss: 809931.1490; val_cat_covariates_contrastive_loss: 952716.1698; val_gene_expr_recon_loss: 1867864.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3653660.4484; val_optim_loss: 3653660.4484
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9309; val_auprc_score: 0.9843; val_best_acc_score: 0.9278; val_best_f1_score: 0.9586; train_kl_reg_loss: 26460.5491; train_edge_recon_loss: 786300.1425; train_cat_covariates_contrastive_loss: 952319.7803; train_gene_expr_recon_loss: 1866012.5810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3631093.0493; train_optim_loss: 3631093.0493; val_kl_reg_loss: 24217.9500; val_edge_recon_loss: 817871.3864; val_cat_covariates_contrastive_loss: 954881.5121; val_gene_expr_recon_loss: 1864745.0243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3661715.8765; val_optim_loss: 3661715.8765
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9232; val_auprc_score: 0.9819; val_best_acc_score: 0.9258; val_best_f1_score: 0.9575; train_kl_reg_loss: 25940.4985; train_edge_recon_loss: 788560.2151; train_cat_covariates_contrastive_loss: 952138.6201; train_gene_expr_recon_loss: 1863723.9549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3630363.2878; train_optim_loss: 3630363.2878; val_kl_reg_loss: 25997.1194; val_edge_recon_loss: 815286.7047; val_cat_covariates_contrastive_loss: 950645.3492; val_gene_expr_recon_loss: 1863426.1685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3655355.3441; val_optim_loss: 3655355.3441
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9292; val_auprc_score: 0.9834; val_best_acc_score: 0.9278; val_best_f1_score: 0.9586; train_kl_reg_loss: 25824.5140; train_edge_recon_loss: 786993.4169; train_cat_covariates_contrastive_loss: 952134.7991; train_gene_expr_recon_loss: 1861748.2710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3626700.9984; train_optim_loss: 3626700.9984; val_kl_reg_loss: 24879.2431; val_edge_recon_loss: 816101.8388; val_cat_covariates_contrastive_loss: 951799.4355; val_gene_expr_recon_loss: 1860603.5086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3653384.0263; val_optim_loss: 3653384.0263
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9272; val_auprc_score: 0.9829; val_best_acc_score: 0.9304; val_best_f1_score: 0.9601; train_kl_reg_loss: 25863.9978; train_edge_recon_loss: 787807.7115; train_cat_covariates_contrastive_loss: 952249.7822; train_gene_expr_recon_loss: 1857655.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3623576.7737; train_optim_loss: 3623576.7737; val_kl_reg_loss: 25225.2520; val_edge_recon_loss: 815917.9970; val_cat_covariates_contrastive_loss: 950146.0137; val_gene_expr_recon_loss: 1875383.5967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3666672.8664; val_optim_loss: 3666672.8664
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9287; val_auprc_score: 0.9842; val_best_acc_score: 0.9219; val_best_f1_score: 0.9552; train_kl_reg_loss: 26373.9957; train_edge_recon_loss: 786858.4984; train_cat_covariates_contrastive_loss: 952607.4538; train_gene_expr_recon_loss: 1861573.8368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3627413.7849; train_optim_loss: 3627413.7849; val_kl_reg_loss: 23824.9913; val_edge_recon_loss: 805379.1789; val_cat_covariates_contrastive_loss: 953750.8355; val_gene_expr_recon_loss: 1858050.1518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3641005.1528; val_optim_loss: 3641005.1528
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9288; val_auprc_score: 0.9843; val_best_acc_score: 0.9216; val_best_f1_score: 0.9551; train_kl_reg_loss: 26173.6602; train_edge_recon_loss: 787670.6413; train_cat_covariates_contrastive_loss: 952270.0458; train_gene_expr_recon_loss: 1859123.6990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3625238.0503; train_optim_loss: 3625238.0503; val_kl_reg_loss: 24561.4208; val_edge_recon_loss: 805825.6088; val_cat_covariates_contrastive_loss: 955837.3975; val_gene_expr_recon_loss: 1861453.8846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3647678.3269; val_optim_loss: 3647678.3269
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9302; val_auprc_score: 0.9839; val_best_acc_score: 0.9279; val_best_f1_score: 0.9587; train_kl_reg_loss: 26094.9450; train_edge_recon_loss: 790230.8340; train_cat_covariates_contrastive_loss: 952047.0689; train_gene_expr_recon_loss: 1856587.7933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3624960.6389; train_optim_loss: 3624960.6389; val_kl_reg_loss: 25426.9126; val_edge_recon_loss: 812379.6374; val_cat_covariates_contrastive_loss: 953109.4995; val_gene_expr_recon_loss: 1854339.5648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3645255.6174; val_optim_loss: 3645255.6174
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9303; val_auprc_score: 0.9838; val_best_acc_score: 0.9290; val_best_f1_score: 0.9593; train_kl_reg_loss: 25965.8587; train_edge_recon_loss: 785928.6018; train_cat_covariates_contrastive_loss: 952108.8337; train_gene_expr_recon_loss: 1855054.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3619057.3331; train_optim_loss: 3619057.3331; val_kl_reg_loss: 25835.7872; val_edge_recon_loss: 816018.0696; val_cat_covariates_contrastive_loss: 952590.9532; val_gene_expr_recon_loss: 1857467.8877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3651912.7055; val_optim_loss: 3651912.7055
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9324; val_auprc_score: 0.9846; val_best_acc_score: 0.9281; val_best_f1_score: 0.9587; train_kl_reg_loss: 26627.2468; train_edge_recon_loss: 788897.0523; train_cat_covariates_contrastive_loss: 952669.5590; train_gene_expr_recon_loss: 1857683.4717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3625877.3339; train_optim_loss: 3625877.3339; val_kl_reg_loss: 25482.7316; val_edge_recon_loss: 807702.7576; val_cat_covariates_contrastive_loss: 954093.6490; val_gene_expr_recon_loss: 1859734.9889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3647014.1285; val_optim_loss: 3647014.1285

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9289; val_auprc_score: 0.9836; val_best_acc_score: 0.9292; val_best_f1_score: 0.9595; train_kl_reg_loss: 26739.2488; train_edge_recon_loss: 785055.3559; train_cat_covariates_contrastive_loss: 952307.4907; train_gene_expr_recon_loss: 1822283.4150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3586385.5114; train_optim_loss: 3586385.5114; val_kl_reg_loss: 26691.2770; val_edge_recon_loss: 798718.1039; val_cat_covariates_contrastive_loss: 951470.3578; val_gene_expr_recon_loss: 1826153.6068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3603033.3522; val_optim_loss: 3603033.3522
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9297; val_auprc_score: 0.9836; val_best_acc_score: 0.9296; val_best_f1_score: 0.9596; train_kl_reg_loss: 26405.3210; train_edge_recon_loss: 783112.4653; train_cat_covariates_contrastive_loss: 952072.2899; train_gene_expr_recon_loss: 1816932.4231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578522.4971; train_optim_loss: 3578522.4971; val_kl_reg_loss: 25649.4620; val_edge_recon_loss: 809080.6037; val_cat_covariates_contrastive_loss: 952344.9909; val_gene_expr_recon_loss: 1824163.1766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3611238.2368; val_optim_loss: 3611238.2368
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9288; val_auprc_score: 0.9833; val_best_acc_score: 0.9292; val_best_f1_score: 0.9593; train_kl_reg_loss: 26176.4581; train_edge_recon_loss: 787968.6426; train_cat_covariates_contrastive_loss: 951894.1463; train_gene_expr_recon_loss: 1814147.5736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3580186.8206; train_optim_loss: 3580186.8206; val_kl_reg_loss: 25995.8443; val_edge_recon_loss: 804902.3019; val_cat_covariates_contrastive_loss: 951316.8398; val_gene_expr_recon_loss: 1820163.2885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3602378.2864; val_optim_loss: 3602378.2864
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9295; val_auprc_score: 0.9832; val_best_acc_score: 0.9298; val_best_f1_score: 0.9596; train_kl_reg_loss: 25937.9014; train_edge_recon_loss: 782131.6538; train_cat_covariates_contrastive_loss: 951837.9764; train_gene_expr_recon_loss: 1812303.1229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3572210.6565; train_optim_loss: 3572210.6565; val_kl_reg_loss: 26358.6641; val_edge_recon_loss: 810040.4180; val_cat_covariates_contrastive_loss: 950397.9003; val_gene_expr_recon_loss: 1820780.0977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3607577.0810; val_optim_loss: 3607577.0810
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9306; val_auprc_score: 0.9837; val_best_acc_score: 0.9298; val_best_f1_score: 0.9598; train_kl_reg_loss: 25744.0730; train_edge_recon_loss: 781573.4194; train_cat_covariates_contrastive_loss: 951643.9609; train_gene_expr_recon_loss: 1811524.2769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3570485.7289; train_optim_loss: 3570485.7289; val_kl_reg_loss: 25244.7097; val_edge_recon_loss: 807121.3841; val_cat_covariates_contrastive_loss: 951700.0633; val_gene_expr_recon_loss: 1817261.0688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3601327.2267; val_optim_loss: 3601327.2267
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9336; val_auprc_score: 0.9846; val_best_acc_score: 0.9297; val_best_f1_score: 0.9597; train_kl_reg_loss: 25531.3695; train_edge_recon_loss: 780885.1333; train_cat_covariates_contrastive_loss: 951705.4031; train_gene_expr_recon_loss: 1810694.4413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3568816.3434; train_optim_loss: 3568816.3434; val_kl_reg_loss: 25139.9349; val_edge_recon_loss: 809217.4152; val_cat_covariates_contrastive_loss: 951671.5714; val_gene_expr_recon_loss: 1818222.5840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3604251.5030; val_optim_loss: 3604251.5030
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9319; val_auprc_score: 0.9843; val_best_acc_score: 0.9297; val_best_f1_score: 0.9597; train_kl_reg_loss: 25313.4163; train_edge_recon_loss: 782598.5268; train_cat_covariates_contrastive_loss: 951405.3981; train_gene_expr_recon_loss: 1809970.2490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3569287.5886; train_optim_loss: 3569287.5886; val_kl_reg_loss: 24884.2767; val_edge_recon_loss: 809320.0709; val_cat_covariates_contrastive_loss: 952973.4479; val_gene_expr_recon_loss: 1816123.8310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3603301.6306; val_optim_loss: 3603301.6306
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9304; val_auprc_score: 0.9839; val_best_acc_score: 0.9293; val_best_f1_score: 0.9596; train_kl_reg_loss: 25271.0231; train_edge_recon_loss: 782228.7138; train_cat_covariates_contrastive_loss: 951462.1226; train_gene_expr_recon_loss: 1809132.0034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3568093.8639; train_optim_loss: 3568093.8639; val_kl_reg_loss: 25468.2217; val_edge_recon_loss: 807113.6688; val_cat_covariates_contrastive_loss: 950974.5967; val_gene_expr_recon_loss: 1816265.1189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3599821.6063; val_optim_loss: 3599821.6063
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9331; val_auprc_score: 0.9845; val_best_acc_score: 0.9292; val_best_f1_score: 0.9594; train_kl_reg_loss: 25221.5251; train_edge_recon_loss: 783493.7490; train_cat_covariates_contrastive_loss: 951326.4658; train_gene_expr_recon_loss: 1808940.0969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3568981.8399; train_optim_loss: 3568981.8399; val_kl_reg_loss: 24846.7511; val_edge_recon_loss: 808055.4171; val_cat_covariates_contrastive_loss: 951473.6460; val_gene_expr_recon_loss: 1817612.5881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3601988.4059; val_optim_loss: 3601988.4059
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9324; val_auprc_score: 0.9845; val_best_acc_score: 0.9303; val_best_f1_score: 0.9601; train_kl_reg_loss: 24941.4159; train_edge_recon_loss: 784815.7002; train_cat_covariates_contrastive_loss: 951427.7869; train_gene_expr_recon_loss: 1807862.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3569047.4671; train_optim_loss: 3569047.4671; val_kl_reg_loss: 24748.2973; val_edge_recon_loss: 802003.1374; val_cat_covariates_contrastive_loss: 951609.1379; val_gene_expr_recon_loss: 1813945.1245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3592305.6964; val_optim_loss: 3592305.6964
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9340; val_auprc_score: 0.9848; val_best_acc_score: 0.9297; val_best_f1_score: 0.9595; train_kl_reg_loss: 24954.2314; train_edge_recon_loss: 785353.2949; train_cat_covariates_contrastive_loss: 951226.7809; train_gene_expr_recon_loss: 1808212.9713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3569747.2780; train_optim_loss: 3569747.2780; val_kl_reg_loss: 24342.0984; val_edge_recon_loss: 808586.5640; val_cat_covariates_contrastive_loss: 952458.3742; val_gene_expr_recon_loss: 1815915.0622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3601302.1043; val_optim_loss: 3601302.1043
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9348; val_auprc_score: 0.9849; val_best_acc_score: 0.9314; val_best_f1_score: 0.9606; train_kl_reg_loss: 24924.6475; train_edge_recon_loss: 781926.5071; train_cat_covariates_contrastive_loss: 951060.2263; train_gene_expr_recon_loss: 1806889.3023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3564800.6846; train_optim_loss: 3564800.6846; val_kl_reg_loss: 24565.7204; val_edge_recon_loss: 805459.2766; val_cat_covariates_contrastive_loss: 951476.1194; val_gene_expr_recon_loss: 1815866.2768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3597367.3978; val_optim_loss: 3597367.3978
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9305; val_auprc_score: 0.9835; val_best_acc_score: 0.9295; val_best_f1_score: 0.9596; train_kl_reg_loss: 24705.4425; train_edge_recon_loss: 782342.5309; train_cat_covariates_contrastive_loss: 951009.0411; train_gene_expr_recon_loss: 1806764.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3564821.4992; train_optim_loss: 3564821.4992; val_kl_reg_loss: 24996.4165; val_edge_recon_loss: 812566.3664; val_cat_covariates_contrastive_loss: 950639.2472; val_gene_expr_recon_loss: 1816968.5152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3605170.5435; val_optim_loss: 3605170.5435
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9345; val_auprc_score: 0.9849; val_best_acc_score: 0.9299; val_best_f1_score: 0.9597; train_kl_reg_loss: 24702.8973; train_edge_recon_loss: 782576.8918; train_cat_covariates_contrastive_loss: 950987.3365; train_gene_expr_recon_loss: 1806529.7221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3564796.8460; train_optim_loss: 3564796.8460; val_kl_reg_loss: 24442.2770; val_edge_recon_loss: 808654.8193; val_cat_covariates_contrastive_loss: 951047.3401; val_gene_expr_recon_loss: 1814419.0501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3598563.4828; val_optim_loss: 3598563.4828

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9336; val_auprc_score: 0.9847; val_best_acc_score: 0.9299; val_best_f1_score: 0.9598; train_kl_reg_loss: 24695.2982; train_edge_recon_loss: 783339.1915; train_cat_covariates_contrastive_loss: 950898.3786; train_gene_expr_recon_loss: 1803070.7901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3562003.6569; train_optim_loss: 3562003.6569; val_kl_reg_loss: 24599.2784; val_edge_recon_loss: 809078.9509; val_cat_covariates_contrastive_loss: 950970.3902; val_gene_expr_recon_loss: 1811840.0486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3596488.6660; val_optim_loss: 3596488.6660
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9329; val_auprc_score: 0.9844; val_best_acc_score: 0.9300; val_best_f1_score: 0.9598; train_kl_reg_loss: 24628.7750; train_edge_recon_loss: 784174.5807; train_cat_covariates_contrastive_loss: 950899.8616; train_gene_expr_recon_loss: 1802135.8972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3561839.1151; train_optim_loss: 3561839.1151; val_kl_reg_loss: 24456.3112; val_edge_recon_loss: 806913.0488; val_cat_covariates_contrastive_loss: 951060.1549; val_gene_expr_recon_loss: 1813267.0891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3595696.6083; val_optim_loss: 3595696.6083
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9334; val_auprc_score: 0.9844; val_best_acc_score: 0.9302; val_best_f1_score: 0.9599; train_kl_reg_loss: 24585.7364; train_edge_recon_loss: 781130.2930; train_cat_covariates_contrastive_loss: 950950.3439; train_gene_expr_recon_loss: 1802008.0465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558674.4189; train_optim_loss: 3558674.4189; val_kl_reg_loss: 24412.1425; val_edge_recon_loss: 805418.7500; val_cat_covariates_contrastive_loss: 951003.0455; val_gene_expr_recon_loss: 1811327.6174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3592161.5516; val_optim_loss: 3592161.5516
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9330; val_auprc_score: 0.9847; val_best_acc_score: 0.9302; val_best_f1_score: 0.9600; train_kl_reg_loss: 24505.0188; train_edge_recon_loss: 782075.5590; train_cat_covariates_contrastive_loss: 950951.2396; train_gene_expr_recon_loss: 1801942.4715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559474.2855; train_optim_loss: 3559474.2855; val_kl_reg_loss: 24451.5771; val_edge_recon_loss: 804850.9962; val_cat_covariates_contrastive_loss: 952135.0792; val_gene_expr_recon_loss: 1811482.2758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3592919.9271; val_optim_loss: 3592919.9271
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9316; val_auprc_score: 0.9836; val_best_acc_score: 0.9310; val_best_f1_score: 0.9603; train_kl_reg_loss: 24578.4411; train_edge_recon_loss: 781783.7794; train_cat_covariates_contrastive_loss: 950874.2755; train_gene_expr_recon_loss: 1801626.0075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558862.5038; train_optim_loss: 3558862.5038; val_kl_reg_loss: 24418.4676; val_edge_recon_loss: 810041.2606; val_cat_covariates_contrastive_loss: 951259.3176; val_gene_expr_recon_loss: 1812372.5673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3598091.6174; val_optim_loss: 3598091.6174
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9304; val_auprc_score: 0.9837; val_best_acc_score: 0.9307; val_best_f1_score: 0.9603; train_kl_reg_loss: 24545.3894; train_edge_recon_loss: 781293.9868; train_cat_covariates_contrastive_loss: 950908.4209; train_gene_expr_recon_loss: 1801941.1643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558688.9628; train_optim_loss: 3558688.9628; val_kl_reg_loss: 24644.2678; val_edge_recon_loss: 805935.8902; val_cat_covariates_contrastive_loss: 950180.3269; val_gene_expr_recon_loss: 1810881.3796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3591641.8684; val_optim_loss: 3591641.8684
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9315; val_auprc_score: 0.9840; val_best_acc_score: 0.9299; val_best_f1_score: 0.9598; train_kl_reg_loss: 24530.8147; train_edge_recon_loss: 783623.1924; train_cat_covariates_contrastive_loss: 950828.8134; train_gene_expr_recon_loss: 1801613.1366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3560595.9570; train_optim_loss: 3560595.9570; val_kl_reg_loss: 24543.6290; val_edge_recon_loss: 806139.0018; val_cat_covariates_contrastive_loss: 950710.2189; val_gene_expr_recon_loss: 1810718.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3592110.9433; val_optim_loss: 3592110.9433
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9321; val_auprc_score: 0.9841; val_best_acc_score: 0.9301; val_best_f1_score: 0.9599; train_kl_reg_loss: 24505.8982; train_edge_recon_loss: 786072.3445; train_cat_covariates_contrastive_loss: 950882.6696; train_gene_expr_recon_loss: 1801756.8694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3563217.7837; train_optim_loss: 3563217.7837; val_kl_reg_loss: 24464.4780; val_edge_recon_loss: 812796.1979; val_cat_covariates_contrastive_loss: 950878.9742; val_gene_expr_recon_loss: 1811874.1437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3600013.8026; val_optim_loss: 3600013.8026
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9351; val_auprc_score: 0.9853; val_best_acc_score: 0.9307; val_best_f1_score: 0.9602; train_kl_reg_loss: 24538.6907; train_edge_recon_loss: 782174.0877; train_cat_covariates_contrastive_loss: 950904.5587; train_gene_expr_recon_loss: 1802072.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559689.3388; train_optim_loss: 3559689.3388; val_kl_reg_loss: 24275.7534; val_edge_recon_loss: 805266.9982; val_cat_covariates_contrastive_loss: 951340.0688; val_gene_expr_recon_loss: 1811577.4226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3592460.2358; val_optim_loss: 3592460.2358
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9332; val_auprc_score: 0.9843; val_best_acc_score: 0.9303; val_best_f1_score: 0.9599; train_kl_reg_loss: 24531.6526; train_edge_recon_loss: 782199.1951; train_cat_covariates_contrastive_loss: 950970.1033; train_gene_expr_recon_loss: 1801724.6116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559425.5611; train_optim_loss: 3559425.5611; val_kl_reg_loss: 24518.6884; val_edge_recon_loss: 810841.7133; val_cat_covariates_contrastive_loss: 950186.0622; val_gene_expr_recon_loss: 1812461.8350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3598008.2935; val_optim_loss: 3598008.2935

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9313; val_auprc_score: 0.9837; val_best_acc_score: 0.9299; val_best_f1_score: 0.9597; train_kl_reg_loss: 24562.9090; train_edge_recon_loss: 784209.7703; train_cat_covariates_contrastive_loss: 950690.4037; train_gene_expr_recon_loss: 1800756.3383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3560219.4220; train_optim_loss: 3560219.4220; val_kl_reg_loss: 24466.3701; val_edge_recon_loss: 811874.4608; val_cat_covariates_contrastive_loss: 950562.2186; val_gene_expr_recon_loss: 1812448.0056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3599351.0617; val_optim_loss: 3599351.0617
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9335; val_auprc_score: 0.9845; val_best_acc_score: 0.9301; val_best_f1_score: 0.9598; train_kl_reg_loss: 24526.9298; train_edge_recon_loss: 782310.4216; train_cat_covariates_contrastive_loss: 950763.5341; train_gene_expr_recon_loss: 1801033.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558634.2831; train_optim_loss: 3558634.2831; val_kl_reg_loss: 24469.2831; val_edge_recon_loss: 808907.4777; val_cat_covariates_contrastive_loss: 950488.8178; val_gene_expr_recon_loss: 1811471.4909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3595337.0587; val_optim_loss: 3595337.0587
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9320; val_auprc_score: 0.9843; val_best_acc_score: 0.9304; val_best_f1_score: 0.9599; train_kl_reg_loss: 24495.7293; train_edge_recon_loss: 782665.1813; train_cat_covariates_contrastive_loss: 950764.2219; train_gene_expr_recon_loss: 1801055.7686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558980.8984; train_optim_loss: 3558980.8984; val_kl_reg_loss: 24414.5577; val_edge_recon_loss: 802475.0047; val_cat_covariates_contrastive_loss: 950793.9600; val_gene_expr_recon_loss: 1810882.4307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3588565.9524; val_optim_loss: 3588565.9524
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9319; val_auprc_score: 0.9839; val_best_acc_score: 0.9297; val_best_f1_score: 0.9595; train_kl_reg_loss: 24494.6647; train_edge_recon_loss: 783412.5048; train_cat_covariates_contrastive_loss: 950742.3405; train_gene_expr_recon_loss: 1801095.0413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559744.5508; train_optim_loss: 3559744.5508; val_kl_reg_loss: 24398.0309; val_edge_recon_loss: 815082.6166; val_cat_covariates_contrastive_loss: 950312.9195; val_gene_expr_recon_loss: 1812435.1412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3602228.6964; val_optim_loss: 3602228.6964
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9343; val_auprc_score: 0.9848; val_best_acc_score: 0.9305; val_best_f1_score: 0.9601; train_kl_reg_loss: 24495.1695; train_edge_recon_loss: 782032.1185; train_cat_covariates_contrastive_loss: 950845.2439; train_gene_expr_recon_loss: 1800390.4546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3557762.9861; train_optim_loss: 3557762.9861; val_kl_reg_loss: 24449.2906; val_edge_recon_loss: 808708.2513; val_cat_covariates_contrastive_loss: 950701.6126; val_gene_expr_recon_loss: 1811806.8512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3595666.0030; val_optim_loss: 3595666.0030
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9341; val_auprc_score: 0.9847; val_best_acc_score: 0.9305; val_best_f1_score: 0.9601; train_kl_reg_loss: 24520.0973; train_edge_recon_loss: 781208.2624; train_cat_covariates_contrastive_loss: 950861.7866; train_gene_expr_recon_loss: 1800988.4636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3557578.6081; train_optim_loss: 3557578.6081; val_kl_reg_loss: 24467.3143; val_edge_recon_loss: 808850.2120; val_cat_covariates_contrastive_loss: 950531.5440; val_gene_expr_recon_loss: 1811941.5941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3595790.6660; val_optim_loss: 3595790.6660
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.9338; val_auprc_score: 0.9846; val_best_acc_score: 0.9308; val_best_f1_score: 0.9603; train_kl_reg_loss: 24525.2337; train_edge_recon_loss: 783992.3347; train_cat_covariates_contrastive_loss: 950879.2385; train_gene_expr_recon_loss: 1801151.6813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3560548.4870; train_optim_loss: 3560548.4870; val_kl_reg_loss: 24503.6091; val_edge_recon_loss: 806896.9097; val_cat_covariates_contrastive_loss: 950666.1521; val_gene_expr_recon_loss: 1811972.0597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3594038.7328; val_optim_loss: 3594038.7328

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9326; val_auprc_score: 0.9844; val_best_acc_score: 0.9301; val_best_f1_score: 0.9599; train_kl_reg_loss: 24554.6019; train_edge_recon_loss: 781888.2845; train_cat_covariates_contrastive_loss: 950774.8608; train_gene_expr_recon_loss: 1800704.2497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3557921.9967; train_optim_loss: 3557921.9967; val_kl_reg_loss: 24470.0798; val_edge_recon_loss: 804040.9370; val_cat_covariates_contrastive_loss: 950782.4970; val_gene_expr_recon_loss: 1810758.3725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3590051.8816; val_optim_loss: 3590051.8816
Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.9334; val_auprc_score: 0.9845; val_best_acc_score: 0.9311; val_best_f1_score: 0.9604; train_kl_reg_loss: 24538.5810; train_edge_recon_loss: 780715.9649; train_cat_covariates_contrastive_loss: 950739.7916; train_gene_expr_recon_loss: 1800380.8612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3556375.1991; train_optim_loss: 3556375.1991; val_kl_reg_loss: 24437.4358; val_edge_recon_loss: 807233.3373; val_cat_covariates_contrastive_loss: 950377.7019; val_gene_expr_recon_loss: 1812297.7262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3594346.1933; val_optim_loss: 3594346.1933
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.9331; val_auprc_score: 0.9846; val_best_acc_score: 0.9308; val_best_f1_score: 0.9603; train_kl_reg_loss: 24529.2362; train_edge_recon_loss: 780366.8917; train_cat_covariates_contrastive_loss: 950706.5392; train_gene_expr_recon_loss: 1801075.7244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3556678.3928; train_optim_loss: 3556678.3928; val_kl_reg_loss: 24429.8186; val_edge_recon_loss: 803345.0296; val_cat_covariates_contrastive_loss: 951105.9572; val_gene_expr_recon_loss: 1809662.7222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3588543.5213; val_optim_loss: 3588543.5213
Epoch 70/400 |███-----------------| 17.5% val_auroc_score: 0.9336; val_auprc_score: 0.9845; val_best_acc_score: 0.9302; val_best_f1_score: 0.9600; train_kl_reg_loss: 24507.4203; train_edge_recon_loss: 781370.3925; train_cat_covariates_contrastive_loss: 950855.2505; train_gene_expr_recon_loss: 1800164.9645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3556898.0288; train_optim_loss: 3556898.0288; val_kl_reg_loss: 24451.4850; val_edge_recon_loss: 805059.3364; val_cat_covariates_contrastive_loss: 950584.5339; val_gene_expr_recon_loss: 1810141.2186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3590236.5719; val_optim_loss: 3590236.5719
Epoch 71/400 |███-----------------| 17.8% val_auroc_score: 0.9333; val_auprc_score: 0.9847; val_best_acc_score: 0.9308; val_best_f1_score: 0.9603; train_kl_reg_loss: 24519.8175; train_edge_recon_loss: 781594.6875; train_cat_covariates_contrastive_loss: 950802.2476; train_gene_expr_recon_loss: 1800947.5116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3557864.2637; train_optim_loss: 3557864.2637; val_kl_reg_loss: 24420.6089; val_edge_recon_loss: 803075.2257; val_cat_covariates_contrastive_loss: 951767.4712; val_gene_expr_recon_loss: 1808783.3654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3588046.6721; val_optim_loss: 3588046.6721
Epoch 72/400 |███-----------------| 18.0% val_auroc_score: 0.9316; val_auprc_score: 0.9840; val_best_acc_score: 0.9294; val_best_f1_score: 0.9595; train_kl_reg_loss: 24500.3290; train_edge_recon_loss: 781862.9408; train_cat_covariates_contrastive_loss: 950871.3370; train_gene_expr_recon_loss: 1800371.3394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3557605.9451; train_optim_loss: 3557605.9451; val_kl_reg_loss: 24420.9982; val_edge_recon_loss: 811802.0519; val_cat_covariates_contrastive_loss: 950662.7280; val_gene_expr_recon_loss: 1811220.9823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3598106.7530; val_optim_loss: 3598106.7530
Epoch 73/400 |███-----------------| 18.2% val_auroc_score: 0.9339; val_auprc_score: 0.9847; val_best_acc_score: 0.9309; val_best_f1_score: 0.9604; train_kl_reg_loss: 24520.2200; train_edge_recon_loss: 784238.7387; train_cat_covariates_contrastive_loss: 950900.2829; train_gene_expr_recon_loss: 1801144.3718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3560803.6132; train_optim_loss: 3560803.6132; val_kl_reg_loss: 24416.6641; val_edge_recon_loss: 810386.3849; val_cat_covariates_contrastive_loss: 950430.9056; val_gene_expr_recon_loss: 1810871.7343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3596105.6923; val_optim_loss: 3596105.6923
Epoch 74/400 |███-----------------| 18.5% val_auroc_score: 0.9331; val_auprc_score: 0.9846; val_best_acc_score: 0.9304; val_best_f1_score: 0.9600; train_kl_reg_loss: 24511.5534; train_edge_recon_loss: 780139.9842; train_cat_covariates_contrastive_loss: 950910.8235; train_gene_expr_recon_loss: 1800401.0785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3555963.4393; train_optim_loss: 3555963.4393; val_kl_reg_loss: 24416.3374; val_edge_recon_loss: 806844.8105; val_cat_covariates_contrastive_loss: 950794.5066; val_gene_expr_recon_loss: 1810009.2535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3592064.9049; val_optim_loss: 3592064.9049
Epoch 75/400 |███-----------------| 18.8% val_auroc_score: 0.9328; val_auprc_score: 0.9843; val_best_acc_score: 0.9299; val_best_f1_score: 0.9598; train_kl_reg_loss: 24514.2137; train_edge_recon_loss: 779599.8687; train_cat_covariates_contrastive_loss: 950793.3725; train_gene_expr_recon_loss: 1801424.4973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3556331.9526; train_optim_loss: 3556331.9526; val_kl_reg_loss: 24400.5890; val_edge_recon_loss: 807648.1984; val_cat_covariates_contrastive_loss: 951045.9254; val_gene_expr_recon_loss: 1809939.9924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3593034.7065; val_optim_loss: 3593034.7065

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 76/400 |███-----------------| 19.0% val_auroc_score: 0.9350; val_auprc_score: 0.9849; val_best_acc_score: 0.9311; val_best_f1_score: 0.9604; train_kl_reg_loss: 24508.5604; train_edge_recon_loss: 783376.9706; train_cat_covariates_contrastive_loss: 950993.8620; train_gene_expr_recon_loss: 1800938.8035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559818.1987; train_optim_loss: 3559818.1987; val_kl_reg_loss: 24414.3690; val_edge_recon_loss: 804803.1192; val_cat_covariates_contrastive_loss: 950955.7050; val_gene_expr_recon_loss: 1812510.3001; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3592683.5000; val_optim_loss: 3592683.5000
Epoch 77/400 |███-----------------| 19.2% val_auroc_score: 0.9318; val_auprc_score: 0.9837; val_best_acc_score: 0.9303; val_best_f1_score: 0.9599; train_kl_reg_loss: 24516.8056; train_edge_recon_loss: 782330.8929; train_cat_covariates_contrastive_loss: 950759.0357; train_gene_expr_recon_loss: 1801039.0105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558645.7413; train_optim_loss: 3558645.7413; val_kl_reg_loss: 24435.0791; val_edge_recon_loss: 813274.1166; val_cat_covariates_contrastive_loss: 950686.5564; val_gene_expr_recon_loss: 1811763.6159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3600159.3573; val_optim_loss: 3600159.3573
Epoch 78/400 |███-----------------| 19.5% val_auroc_score: 0.9342; val_auprc_score: 0.9845; val_best_acc_score: 0.9307; val_best_f1_score: 0.9602; train_kl_reg_loss: 24501.2227; train_edge_recon_loss: 783352.0662; train_cat_covariates_contrastive_loss: 950883.2039; train_gene_expr_recon_loss: 1800732.2556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559468.7506; train_optim_loss: 3559468.7506; val_kl_reg_loss: 24435.8065; val_edge_recon_loss: 811489.0800; val_cat_covariates_contrastive_loss: 951125.4421; val_gene_expr_recon_loss: 1812200.7748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3599251.1123; val_optim_loss: 3599251.1123
Epoch 79/400 |███-----------------| 19.8% val_auroc_score: 0.9350; val_auprc_score: 0.9854; val_best_acc_score: 0.9312; val_best_f1_score: 0.9604; train_kl_reg_loss: 24499.8954; train_edge_recon_loss: 783204.0354; train_cat_covariates_contrastive_loss: 950907.4531; train_gene_expr_recon_loss: 1800672.7098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559284.0909; train_optim_loss: 3559284.0909; val_kl_reg_loss: 24433.6244; val_edge_recon_loss: 800923.6255; val_cat_covariates_contrastive_loss: 951141.1791; val_gene_expr_recon_loss: 1810382.2389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3586880.6721; val_optim_loss: 3586880.6721
Epoch 80/400 |████----------------| 20.0% val_auroc_score: 0.9341; val_auprc_score: 0.9846; val_best_acc_score: 0.9305; val_best_f1_score: 0.9599; train_kl_reg_loss: 24498.8121; train_edge_recon_loss: 782903.6486; train_cat_covariates_contrastive_loss: 950895.5442; train_gene_expr_recon_loss: 1800894.8877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559192.8919; train_optim_loss: 3559192.8919; val_kl_reg_loss: 24443.5127; val_edge_recon_loss: 812878.7735; val_cat_covariates_contrastive_loss: 951262.6184; val_gene_expr_recon_loss: 1812192.9362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3600777.8441; val_optim_loss: 3600777.8441
Epoch 81/400 |████----------------| 20.2% val_auroc_score: 0.9340; val_auprc_score: 0.9847; val_best_acc_score: 0.9304; val_best_f1_score: 0.9600; train_kl_reg_loss: 24507.9775; train_edge_recon_loss: 778973.1469; train_cat_covariates_contrastive_loss: 950790.7499; train_gene_expr_recon_loss: 1801219.3864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3555491.2594; train_optim_loss: 3555491.2594; val_kl_reg_loss: 24429.6901; val_edge_recon_loss: 804777.5251; val_cat_covariates_contrastive_loss: 950689.4868; val_gene_expr_recon_loss: 1811130.8163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3591027.5121; val_optim_loss: 3591027.5121
Epoch 82/400 |████----------------| 20.5% val_auroc_score: 0.9315; val_auprc_score: 0.9839; val_best_acc_score: 0.9296; val_best_f1_score: 0.9596; train_kl_reg_loss: 24494.4535; train_edge_recon_loss: 782248.1619; train_cat_covariates_contrastive_loss: 950675.3470; train_gene_expr_recon_loss: 1801176.0743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558594.0350; train_optim_loss: 3558594.0350; val_kl_reg_loss: 24400.7562; val_edge_recon_loss: 812428.8689; val_cat_covariates_contrastive_loss: 951060.8257; val_gene_expr_recon_loss: 1810957.8917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3598848.3492; val_optim_loss: 3598848.3492
Epoch 83/400 |████----------------| 20.8% val_auroc_score: 0.9322; val_auprc_score: 0.9840; val_best_acc_score: 0.9301; val_best_f1_score: 0.9598; train_kl_reg_loss: 24502.7468; train_edge_recon_loss: 782279.0117; train_cat_covariates_contrastive_loss: 950902.5297; train_gene_expr_recon_loss: 1800835.2321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558519.5219; train_optim_loss: 3558519.5219; val_kl_reg_loss: 24464.6973; val_edge_recon_loss: 809223.4965; val_cat_covariates_contrastive_loss: 950499.6549; val_gene_expr_recon_loss: 1811744.7323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3595932.5759; val_optim_loss: 3595932.5759

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000005e-09.

Epoch 84/400 |████----------------| 21.0% val_auroc_score: 0.9332; val_auprc_score: 0.9844; val_best_acc_score: 0.9304; val_best_f1_score: 0.9601; train_kl_reg_loss: 24501.2029; train_edge_recon_loss: 779657.9948; train_cat_covariates_contrastive_loss: 950679.1462; train_gene_expr_recon_loss: 1800624.8411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3555463.1824; train_optim_loss: 3555463.1824; val_kl_reg_loss: 24436.5445; val_edge_recon_loss: 807534.9178; val_cat_covariates_contrastive_loss: 950433.8350; val_gene_expr_recon_loss: 1811357.7915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3593763.0881; val_optim_loss: 3593763.0881
Epoch 85/400 |████----------------| 21.2% val_auroc_score: 0.9335; val_auprc_score: 0.9846; val_best_acc_score: 0.9307; val_best_f1_score: 0.9603; train_kl_reg_loss: 24500.7849; train_edge_recon_loss: 782546.9572; train_cat_covariates_contrastive_loss: 950792.2448; train_gene_expr_recon_loss: 1801028.1465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558868.1323; train_optim_loss: 3558868.1323; val_kl_reg_loss: 24427.1289; val_edge_recon_loss: 805112.8168; val_cat_covariates_contrastive_loss: 951275.3173; val_gene_expr_recon_loss: 1810468.6746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3591283.9291; val_optim_loss: 3591283.9291
Epoch 86/400 |████----------------| 21.5% val_auroc_score: 0.9351; val_auprc_score: 0.9849; val_best_acc_score: 0.9304; val_best_f1_score: 0.9600; train_kl_reg_loss: 24499.2504; train_edge_recon_loss: 781695.1980; train_cat_covariates_contrastive_loss: 950932.9888; train_gene_expr_recon_loss: 1800945.4359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558072.8740; train_optim_loss: 3558072.8740; val_kl_reg_loss: 24412.4464; val_edge_recon_loss: 808414.7280; val_cat_covariates_contrastive_loss: 951322.7012; val_gene_expr_recon_loss: 1811325.6589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3595475.5344; val_optim_loss: 3595475.5344
Epoch 87/400 |████----------------| 21.8% val_auroc_score: 0.9315; val_auprc_score: 0.9841; val_best_acc_score: 0.9297; val_best_f1_score: 0.9596; train_kl_reg_loss: 24503.0322; train_edge_recon_loss: 781753.4176; train_cat_covariates_contrastive_loss: 950935.8993; train_gene_expr_recon_loss: 1801239.7151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558432.0633; train_optim_loss: 3558432.0633; val_kl_reg_loss: 24419.0547; val_edge_recon_loss: 807427.0478; val_cat_covariates_contrastive_loss: 951206.3287; val_gene_expr_recon_loss: 1811201.9954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3594254.4211; val_optim_loss: 3594254.4211

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1071 min 55 sec.
Using best model state, which was in epoch 79.

--- MODEL EVALUATION ---
val AUROC score: 0.9052
val AUPRC score: 0.9713
val best accuracy score: 0.9259
val best F1 score: 0.9574
val target rna MSE score: 0.3231
val source rna MSE score: 0.1116
Val cat covariate0 mean sim diff: -0.0006
Val cat covariate1 mean sim diff: -0.0720
Val cat covariate2 mean sim diff: -0.0008

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
