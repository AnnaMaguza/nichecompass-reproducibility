[True, False, True]
Run timestamp: 30082023_133253_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_filtered', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 883, n_cat_covariates_embed_input: 0, n_hidden: 883, n_latent: 1484, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1484, n_addon_gp_input: 10, n_cat_covariates_embed_input: 38, n_output: 883
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1484, n_addon_gp_input: 10, n_cat_covariates_embed_input: 38, n_output: 883

--- INITIALIZING TRAINER ---
Number of training nodes: 549457
Number of validation nodes: 61051
Number of training edges: 1296467
Number of validation edges: 144051
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8666; val_auprc_score: 0.9760; val_best_acc_score: 0.9007; val_best_f1_score: 0.9453; train_kl_reg_loss: 11914.2660; train_edge_recon_loss: 740364.3418; train_cat_covariates_contrastive_loss: 949689.2017; train_gene_expr_recon_loss: 2149026.7300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3850994.5410; train_optim_loss: 3850994.5410; val_kl_reg_loss: 15173.0995; val_edge_recon_loss: 748825.2870; val_cat_covariates_contrastive_loss: 947189.6837; val_gene_expr_recon_loss: 1959683.3843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3670871.4566; val_optim_loss: 3670871.4566
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8699; val_auprc_score: 0.9762; val_best_acc_score: 0.9033; val_best_f1_score: 0.9466; train_kl_reg_loss: 17934.5256; train_edge_recon_loss: 719981.8119; train_cat_covariates_contrastive_loss: 952379.5851; train_gene_expr_recon_loss: 1794288.4781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3484584.4012; train_optim_loss: 3484584.4012; val_kl_reg_loss: 20726.4330; val_edge_recon_loss: 747549.7262; val_cat_covariates_contrastive_loss: 950512.2586; val_gene_expr_recon_loss: 1678378.9286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3397167.3484; val_optim_loss: 3397167.3484
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8900; val_auprc_score: 0.9806; val_best_acc_score: 0.9072; val_best_f1_score: 0.9487; train_kl_reg_loss: 20747.7488; train_edge_recon_loss: 712572.4321; train_cat_covariates_contrastive_loss: 953306.3549; train_gene_expr_recon_loss: 1628411.5336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3315038.0702; train_optim_loss: 3315038.0702; val_kl_reg_loss: 21472.7818; val_edge_recon_loss: 740096.2161; val_cat_covariates_contrastive_loss: 953680.8728; val_gene_expr_recon_loss: 1592054.5550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3307304.4167; val_optim_loss: 3307304.4167
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8823; val_auprc_score: 0.9785; val_best_acc_score: 0.9094; val_best_f1_score: 0.9496; train_kl_reg_loss: 21338.5058; train_edge_recon_loss: 710657.5988; train_cat_covariates_contrastive_loss: 953926.6761; train_gene_expr_recon_loss: 1572048.1337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3257970.9149; train_optim_loss: 3257970.9149; val_kl_reg_loss: 21707.9045; val_edge_recon_loss: 742205.9361; val_cat_covariates_contrastive_loss: 951789.5798; val_gene_expr_recon_loss: 1554109.2872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3269812.7039; val_optim_loss: 3269812.7039
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8948; val_auprc_score: 0.9819; val_best_acc_score: 0.9093; val_best_f1_score: 0.9498; train_kl_reg_loss: 21398.0560; train_edge_recon_loss: 708565.8901; train_cat_covariates_contrastive_loss: 953525.1598; train_gene_expr_recon_loss: 1544959.7633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3228448.8695; train_optim_loss: 3228448.8695; val_kl_reg_loss: 19080.6839; val_edge_recon_loss: 736313.9054; val_cat_covariates_contrastive_loss: 961323.2394; val_gene_expr_recon_loss: 1538685.8608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3255403.6897; val_optim_loss: 3255403.6897
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8851; val_auprc_score: 0.9787; val_best_acc_score: 0.9107; val_best_f1_score: 0.9503; train_kl_reg_loss: 21316.7926; train_edge_recon_loss: 706565.3738; train_cat_covariates_contrastive_loss: 953114.6938; train_gene_expr_recon_loss: 1526081.9247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3207078.7838; train_optim_loss: 3207078.7838; val_kl_reg_loss: 23134.0474; val_edge_recon_loss: 735582.2462; val_cat_covariates_contrastive_loss: 949322.5895; val_gene_expr_recon_loss: 1518175.0745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3226213.9592; val_optim_loss: 3226213.9592
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8993; val_auprc_score: 0.9821; val_best_acc_score: 0.9136; val_best_f1_score: 0.9519; train_kl_reg_loss: 21489.8476; train_edge_recon_loss: 706375.2348; train_cat_covariates_contrastive_loss: 952855.9203; train_gene_expr_recon_loss: 1512969.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3193690.7829; train_optim_loss: 3193690.7829; val_kl_reg_loss: 21827.2444; val_edge_recon_loss: 733548.9464; val_cat_covariates_contrastive_loss: 952195.3852; val_gene_expr_recon_loss: 1506485.2855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3214056.8626; val_optim_loss: 3214056.8626
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8962; val_auprc_score: 0.9814; val_best_acc_score: 0.9119; val_best_f1_score: 0.9510; train_kl_reg_loss: 21707.6916; train_edge_recon_loss: 705821.5686; train_cat_covariates_contrastive_loss: 952833.7008; train_gene_expr_recon_loss: 1503167.1130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3183530.0724; train_optim_loss: 3183530.0724; val_kl_reg_loss: 20962.6679; val_edge_recon_loss: 730465.7928; val_cat_covariates_contrastive_loss: 952795.8599; val_gene_expr_recon_loss: 1507465.8418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3211690.1684; val_optim_loss: 3211690.1684
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8976; val_auprc_score: 0.9814; val_best_acc_score: 0.9135; val_best_f1_score: 0.9519; train_kl_reg_loss: 21885.1150; train_edge_recon_loss: 704743.4545; train_cat_covariates_contrastive_loss: 952568.9918; train_gene_expr_recon_loss: 1493423.6949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3172621.2582; train_optim_loss: 3172621.2582; val_kl_reg_loss: 22333.7371; val_edge_recon_loss: 734668.8446; val_cat_covariates_contrastive_loss: 951129.8980; val_gene_expr_recon_loss: 1489647.8413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3197780.3262; val_optim_loss: 3197780.3262
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9038; val_auprc_score: 0.9829; val_best_acc_score: 0.9145; val_best_f1_score: 0.9524; train_kl_reg_loss: 22128.5445; train_edge_recon_loss: 704276.7747; train_cat_covariates_contrastive_loss: 952528.8769; train_gene_expr_recon_loss: 1485746.2322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3164680.4285; train_optim_loss: 3164680.4285; val_kl_reg_loss: 21588.0648; val_edge_recon_loss: 730869.8026; val_cat_covariates_contrastive_loss: 954493.4406; val_gene_expr_recon_loss: 1482311.1228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3189262.4317; val_optim_loss: 3189262.4317
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9001; val_auprc_score: 0.9817; val_best_acc_score: 0.9126; val_best_f1_score: 0.9512; train_kl_reg_loss: 22271.2504; train_edge_recon_loss: 706445.7470; train_cat_covariates_contrastive_loss: 952498.2907; train_gene_expr_recon_loss: 1477928.0849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3159143.3727; train_optim_loss: 3159143.3727; val_kl_reg_loss: 21839.3392; val_edge_recon_loss: 744069.9355; val_cat_covariates_contrastive_loss: 952524.8936; val_gene_expr_recon_loss: 1473161.1423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3191595.3174; val_optim_loss: 3191595.3174
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9051; val_auprc_score: 0.9834; val_best_acc_score: 0.9137; val_best_f1_score: 0.9519; train_kl_reg_loss: 22396.1791; train_edge_recon_loss: 701534.8554; train_cat_covariates_contrastive_loss: 952537.8449; train_gene_expr_recon_loss: 1473915.4329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3150384.3098; train_optim_loss: 3150384.3098; val_kl_reg_loss: 21029.3203; val_edge_recon_loss: 727677.8505; val_cat_covariates_contrastive_loss: 957189.7586; val_gene_expr_recon_loss: 1473187.8360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3179084.7606; val_optim_loss: 3179084.7606
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9084; val_auprc_score: 0.9844; val_best_acc_score: 0.9167; val_best_f1_score: 0.9537; train_kl_reg_loss: 22522.1848; train_edge_recon_loss: 704301.6665; train_cat_covariates_contrastive_loss: 952531.8388; train_gene_expr_recon_loss: 1467638.0057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3146993.6952; train_optim_loss: 3146993.6952; val_kl_reg_loss: 21562.3421; val_edge_recon_loss: 720596.6425; val_cat_covariates_contrastive_loss: 956303.1902; val_gene_expr_recon_loss: 1465530.9597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3163993.1285; val_optim_loss: 3163993.1285
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9075; val_auprc_score: 0.9835; val_best_acc_score: 0.9174; val_best_f1_score: 0.9540; train_kl_reg_loss: 22579.8814; train_edge_recon_loss: 700499.6293; train_cat_covariates_contrastive_loss: 952344.7836; train_gene_expr_recon_loss: 1463512.4704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3138936.7676; train_optim_loss: 3138936.7676; val_kl_reg_loss: 22245.6867; val_edge_recon_loss: 728484.7963; val_cat_covariates_contrastive_loss: 952372.8927; val_gene_expr_recon_loss: 1460909.8005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3164013.1826; val_optim_loss: 3164013.1826
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8919; val_auprc_score: 0.9800; val_best_acc_score: 0.9140; val_best_f1_score: 0.9521; train_kl_reg_loss: 22644.6909; train_edge_recon_loss: 703081.4684; train_cat_covariates_contrastive_loss: 952490.8276; train_gene_expr_recon_loss: 1460652.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3138869.9079; train_optim_loss: 3138869.9079; val_kl_reg_loss: 24783.9646; val_edge_recon_loss: 734553.9716; val_cat_covariates_contrastive_loss: 948825.1250; val_gene_expr_recon_loss: 1463907.5226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3172070.5798; val_optim_loss: 3172070.5798
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8978; val_auprc_score: 0.9814; val_best_acc_score: 0.9173; val_best_f1_score: 0.9539; train_kl_reg_loss: 22725.5439; train_edge_recon_loss: 700174.1996; train_cat_covariates_contrastive_loss: 952160.7333; train_gene_expr_recon_loss: 1457294.7408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3132355.2170; train_optim_loss: 3132355.2170; val_kl_reg_loss: 24023.7280; val_edge_recon_loss: 721629.7250; val_cat_covariates_contrastive_loss: 949245.1602; val_gene_expr_recon_loss: 1457701.5656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3152600.1791; val_optim_loss: 3152600.1791
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9042; val_auprc_score: 0.9829; val_best_acc_score: 0.9118; val_best_f1_score: 0.9509; train_kl_reg_loss: 22790.1967; train_edge_recon_loss: 703704.7530; train_cat_covariates_contrastive_loss: 952299.0380; train_gene_expr_recon_loss: 1453510.5022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3132304.4855; train_optim_loss: 3132304.4855; val_kl_reg_loss: 22924.6649; val_edge_recon_loss: 729579.1917; val_cat_covariates_contrastive_loss: 952718.6243; val_gene_expr_recon_loss: 1459919.6529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3165142.1356; val_optim_loss: 3165142.1356
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9086; val_auprc_score: 0.9837; val_best_acc_score: 0.9195; val_best_f1_score: 0.9552; train_kl_reg_loss: 22892.1596; train_edge_recon_loss: 701017.9544; train_cat_covariates_contrastive_loss: 952263.2946; train_gene_expr_recon_loss: 1451575.3695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3127748.7790; train_optim_loss: 3127748.7790; val_kl_reg_loss: 22433.6023; val_edge_recon_loss: 723649.5915; val_cat_covariates_contrastive_loss: 952906.5689; val_gene_expr_recon_loss: 1454680.9406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3153670.6968; val_optim_loss: 3153670.6968
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9077; val_auprc_score: 0.9830; val_best_acc_score: 0.9215; val_best_f1_score: 0.9562; train_kl_reg_loss: 22843.5275; train_edge_recon_loss: 699231.4801; train_cat_covariates_contrastive_loss: 952104.2321; train_gene_expr_recon_loss: 1447498.5382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3121677.7767; train_optim_loss: 3121677.7767; val_kl_reg_loss: 24106.7922; val_edge_recon_loss: 724882.0160; val_cat_covariates_contrastive_loss: 949922.4085; val_gene_expr_recon_loss: 1451589.4987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3150500.7261; val_optim_loss: 3150500.7261
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9027; val_auprc_score: 0.9822; val_best_acc_score: 0.9150; val_best_f1_score: 0.9526; train_kl_reg_loss: 22855.0730; train_edge_recon_loss: 701089.0705; train_cat_covariates_contrastive_loss: 952122.3529; train_gene_expr_recon_loss: 1447136.5442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3123203.0427; train_optim_loss: 3123203.0427; val_kl_reg_loss: 24204.5252; val_edge_recon_loss: 730111.2648; val_cat_covariates_contrastive_loss: 950535.8497; val_gene_expr_recon_loss: 1450102.2425; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3154953.8883; val_optim_loss: 3154953.8883
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8945; val_auprc_score: 0.9804; val_best_acc_score: 0.9129; val_best_f1_score: 0.9515; train_kl_reg_loss: 22937.6319; train_edge_recon_loss: 701267.1294; train_cat_covariates_contrastive_loss: 952123.0414; train_gene_expr_recon_loss: 1443300.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3119627.9992; train_optim_loss: 3119627.9992; val_kl_reg_loss: 24188.1648; val_edge_recon_loss: 732573.4461; val_cat_covariates_contrastive_loss: 949303.9967; val_gene_expr_recon_loss: 1448487.7163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3154553.3112; val_optim_loss: 3154553.3112
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9088; val_auprc_score: 0.9840; val_best_acc_score: 0.9149; val_best_f1_score: 0.9527; train_kl_reg_loss: 23025.0776; train_edge_recon_loss: 700412.1107; train_cat_covariates_contrastive_loss: 952276.3053; train_gene_expr_recon_loss: 1445103.1997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3120816.6965; train_optim_loss: 3120816.6965; val_kl_reg_loss: 21701.8554; val_edge_recon_loss: 730491.4120; val_cat_covariates_contrastive_loss: 955004.1868; val_gene_expr_recon_loss: 1441510.8466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3148708.3050; val_optim_loss: 3148708.3050
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9026; val_auprc_score: 0.9819; val_best_acc_score: 0.9185; val_best_f1_score: 0.9546; train_kl_reg_loss: 22887.8860; train_edge_recon_loss: 700443.0899; train_cat_covariates_contrastive_loss: 951960.7862; train_gene_expr_recon_loss: 1439013.5852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3114305.3494; train_optim_loss: 3114305.3494; val_kl_reg_loss: 23221.0543; val_edge_recon_loss: 730825.0427; val_cat_covariates_contrastive_loss: 949760.7216; val_gene_expr_recon_loss: 1437411.7952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3141218.6170; val_optim_loss: 3141218.6170
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9103; val_auprc_score: 0.9848; val_best_acc_score: 0.9138; val_best_f1_score: 0.9522; train_kl_reg_loss: 22871.7341; train_edge_recon_loss: 701786.0688; train_cat_covariates_contrastive_loss: 951977.1491; train_gene_expr_recon_loss: 1439748.0831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3116383.0357; train_optim_loss: 3116383.0357; val_kl_reg_loss: 22539.9396; val_edge_recon_loss: 721519.8971; val_cat_covariates_contrastive_loss: 957423.2318; val_gene_expr_recon_loss: 1469168.1999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3170651.2571; val_optim_loss: 3170651.2571
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9145; val_auprc_score: 0.9848; val_best_acc_score: 0.9186; val_best_f1_score: 0.9546; train_kl_reg_loss: 23125.0915; train_edge_recon_loss: 701287.7539; train_cat_covariates_contrastive_loss: 952136.0969; train_gene_expr_recon_loss: 1439529.1598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3116078.1022; train_optim_loss: 3116078.1022; val_kl_reg_loss: 22745.7378; val_edge_recon_loss: 730297.2245; val_cat_covariates_contrastive_loss: 953297.3746; val_gene_expr_recon_loss: 1439359.3852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3145699.7199; val_optim_loss: 3145699.7199
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8834; val_auprc_score: 0.9799; val_best_acc_score: 0.9037; val_best_f1_score: 0.9465; train_kl_reg_loss: 46992.5915; train_edge_recon_loss: 701698.3839; train_cat_covariates_contrastive_loss: 952623.3326; train_gene_expr_recon_loss: 1494287.3897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3195601.7002; train_optim_loss: 3195601.7002; val_kl_reg_loss: 20160.2241; val_edge_recon_loss: 753438.2518; val_cat_covariates_contrastive_loss: 948997.6277; val_gene_expr_recon_loss: 2029768.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3752364.5869; val_optim_loss: 3752364.5869
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8865; val_auprc_score: 0.9817; val_best_acc_score: 0.9065; val_best_f1_score: 0.9485; train_kl_reg_loss: 49353923.4265; train_edge_recon_loss: 701727.2198; train_cat_covariates_contrastive_loss: 953237.5184; train_gene_expr_recon_loss: 1613584.6700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52622474.0660; train_optim_loss: 52622474.0660; val_kl_reg_loss: 133942.6517; val_edge_recon_loss: 787362.5618; val_cat_covariates_contrastive_loss: 963410.6753; val_gene_expr_recon_loss: 2537254.9787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4421970.8777; val_optim_loss: 4421970.8777

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9096; val_auprc_score: 0.9840; val_best_acc_score: 0.9205; val_best_f1_score: 0.9557; train_kl_reg_loss: 37444.8249; train_edge_recon_loss: 716356.9062; train_cat_covariates_contrastive_loss: 954553.3969; train_gene_expr_recon_loss: 1701380.9455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3409736.0746; train_optim_loss: 3409736.0746; val_kl_reg_loss: 31843.1508; val_edge_recon_loss: 717190.8508; val_cat_covariates_contrastive_loss: 953655.3695; val_gene_expr_recon_loss: 1535788.2509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3238477.6223; val_optim_loss: 3238477.6223
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9138; val_auprc_score: 0.9847; val_best_acc_score: 0.9210; val_best_f1_score: 0.9559; train_kl_reg_loss: 28793.5969; train_edge_recon_loss: 697300.0472; train_cat_covariates_contrastive_loss: 954063.5716; train_gene_expr_recon_loss: 1492761.7378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3172918.9551; train_optim_loss: 3172918.9551; val_kl_reg_loss: 27278.3977; val_edge_recon_loss: 721011.0255; val_cat_covariates_contrastive_loss: 955307.8041; val_gene_expr_recon_loss: 1480460.0563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3184057.2961; val_optim_loss: 3184057.2961
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9111; val_auprc_score: 0.9841; val_best_acc_score: 0.9203; val_best_f1_score: 0.9556; train_kl_reg_loss: 26895.2902; train_edge_recon_loss: 698135.6749; train_cat_covariates_contrastive_loss: 953345.0432; train_gene_expr_recon_loss: 1462633.8972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3141009.9057; train_optim_loss: 3141009.9057; val_kl_reg_loss: 26311.3468; val_edge_recon_loss: 723639.4438; val_cat_covariates_contrastive_loss: 953128.4630; val_gene_expr_recon_loss: 1457396.4034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3160475.6613; val_optim_loss: 3160475.6613
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9112; val_auprc_score: 0.9842; val_best_acc_score: 0.9187; val_best_f1_score: 0.9547; train_kl_reg_loss: 25886.2642; train_edge_recon_loss: 699588.3485; train_cat_covariates_contrastive_loss: 953337.8756; train_gene_expr_recon_loss: 1445564.8099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3124377.2952; train_optim_loss: 3124377.2952; val_kl_reg_loss: 25293.5744; val_edge_recon_loss: 722495.7037; val_cat_covariates_contrastive_loss: 953655.7797; val_gene_expr_recon_loss: 1445396.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3146841.1436; val_optim_loss: 3146841.1436

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 601 min 24 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.8544
val AUPRC score: 0.9627
val best accuracy score: 0.9111
val best F1 score: 0.9502
val target rna MSE score: 0.2456
val source rna MSE score: 0.0623
Val cat covariate0 mean sim diff: -0.0018
Val cat covariate1 mean sim diff: -0.0565
Val cat covariate2 mean sim diff: -0.0018

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
