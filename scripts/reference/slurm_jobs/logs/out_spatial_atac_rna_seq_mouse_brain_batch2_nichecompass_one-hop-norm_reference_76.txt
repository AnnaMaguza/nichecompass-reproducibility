[True]
Run timestamp: 07082023_194637_76.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_76']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9123; val_auprc_score: 0.9195; val_best_acc_score: 0.5112; val_best_f1_score: 0.6716; train_kl_reg_loss: 10399.3665; train_edge_recon_loss: 350192.2535; train_gene_expr_recon_loss: 631438.9583; train_masked_gp_l1_reg_loss: 8856.4562; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 798990.7431; train_global_loss: 1799877.8056; train_optim_loss: 1799877.8056; val_kl_reg_loss: 9261.8984; val_edge_recon_loss: 406445.7188; val_gene_expr_recon_loss: 586047.8750; val_masked_gp_l1_reg_loss: 7476.2441; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 781121.7500; val_global_loss: 1790353.5000; val_optim_loss: 1790353.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8788; val_auprc_score: 0.8858; val_best_acc_score: 0.5295; val_best_f1_score: 0.6799; train_kl_reg_loss: 12847.6500; train_edge_recon_loss: 355720.4028; train_gene_expr_recon_loss: 570361.2847; train_masked_gp_l1_reg_loss: 6988.1722; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 784177.5903; train_global_loss: 1730095.0556; train_optim_loss: 1730095.0556; val_kl_reg_loss: 15978.0146; val_edge_recon_loss: 406358.3438; val_gene_expr_recon_loss: 534631.0000; val_masked_gp_l1_reg_loss: 6608.7939; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 766437.8125; val_global_loss: 1730014.0000; val_optim_loss: 1730014.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8798; val_auprc_score: 0.8863; val_best_acc_score: 0.5406; val_best_f1_score: 0.6845; train_kl_reg_loss: 18961.4349; train_edge_recon_loss: 359918.6736; train_gene_expr_recon_loss: 522710.6389; train_masked_gp_l1_reg_loss: 6624.1935; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 770834.2639; train_global_loss: 1679049.2083; train_optim_loss: 1679049.2083; val_kl_reg_loss: 19838.3945; val_edge_recon_loss: 406273.5000; val_gene_expr_recon_loss: 500358.6875; val_masked_gp_l1_reg_loss: 6662.9438; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 753471.7500; val_global_loss: 1686605.2500; val_optim_loss: 1686605.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8823; val_auprc_score: 0.8799; val_best_acc_score: 0.5831; val_best_f1_score: 0.7019; train_kl_reg_loss: 21520.6128; train_edge_recon_loss: 360673.0556; train_gene_expr_recon_loss: 498067.0035; train_masked_gp_l1_reg_loss: 6607.5346; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 760000.9722; train_global_loss: 1646869.1667; train_optim_loss: 1646869.1667; val_kl_reg_loss: 19795.4551; val_edge_recon_loss: 405781.2188; val_gene_expr_recon_loss: 481259.8438; val_masked_gp_l1_reg_loss: 6506.4512; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 744233.8750; val_global_loss: 1657576.7500; val_optim_loss: 1657576.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8886; val_auprc_score: 0.8860; val_best_acc_score: 0.6870; val_best_f1_score: 0.7543; train_kl_reg_loss: 22532.2007; train_edge_recon_loss: 360320.7361; train_gene_expr_recon_loss: 478723.2153; train_masked_gp_l1_reg_loss: 6440.4380; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 748443.5972; train_global_loss: 1616460.2083; train_optim_loss: 1616460.2083; val_kl_reg_loss: 22102.5391; val_edge_recon_loss: 404692.6562; val_gene_expr_recon_loss: 467266.2500; val_masked_gp_l1_reg_loss: 6346.8501; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 736711.3750; val_global_loss: 1637119.7500; val_optim_loss: 1637119.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8815; val_auprc_score: 0.8786; val_best_acc_score: 0.7774; val_best_f1_score: 0.8043; train_kl_reg_loss: 23723.8633; train_edge_recon_loss: 359881.0868; train_gene_expr_recon_loss: 464328.9028; train_masked_gp_l1_reg_loss: 6293.8864; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 738618.4792; train_global_loss: 1592846.2361; train_optim_loss: 1592846.2361; val_kl_reg_loss: 23609.1328; val_edge_recon_loss: 402680.3125; val_gene_expr_recon_loss: 457060.6250; val_masked_gp_l1_reg_loss: 6223.3647; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 730324.4375; val_global_loss: 1619897.8750; val_optim_loss: 1619897.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8908; val_auprc_score: 0.8894; val_best_acc_score: 0.8103; val_best_f1_score: 0.8015; train_kl_reg_loss: 24457.0365; train_edge_recon_loss: 359114.2882; train_gene_expr_recon_loss: 457542.8021; train_masked_gp_l1_reg_loss: 6186.1295; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 738638.8264; train_global_loss: 1585939.0694; train_optim_loss: 1585939.0694; val_kl_reg_loss: 24863.2539; val_edge_recon_loss: 398065.8438; val_gene_expr_recon_loss: 449454.7500; val_masked_gp_l1_reg_loss: 6136.3770; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 725070.2500; val_global_loss: 1603590.5000; val_optim_loss: 1603590.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9054; val_auprc_score: 0.8958; val_best_acc_score: 0.8199; val_best_f1_score: 0.8342; train_kl_reg_loss: 25165.4271; train_edge_recon_loss: 357405.7535; train_gene_expr_recon_loss: 451729.5729; train_masked_gp_l1_reg_loss: 6120.5978; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 730846.5278; train_global_loss: 1571267.8889; train_optim_loss: 1571267.8889; val_kl_reg_loss: 24439.9336; val_edge_recon_loss: 387598.7812; val_gene_expr_recon_loss: 444151.0625; val_masked_gp_l1_reg_loss: 6092.0244; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 720769.3125; val_global_loss: 1583051.0000; val_optim_loss: 1583051.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9148; val_auprc_score: 0.9026; val_best_acc_score: 0.8345; val_best_f1_score: 0.8443; train_kl_reg_loss: 24883.8665; train_edge_recon_loss: 351041.5972; train_gene_expr_recon_loss: 447502.8646; train_masked_gp_l1_reg_loss: 6094.9296; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 729695.9583; train_global_loss: 1559219.2083; train_optim_loss: 1559219.2083; val_kl_reg_loss: 25596.2578; val_edge_recon_loss: 355676.5000; val_gene_expr_recon_loss: 441323.4062; val_masked_gp_l1_reg_loss: 6090.4614; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718322.0000; val_global_loss: 1547008.5000; val_optim_loss: 1547008.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9119; val_auprc_score: 0.8995; val_best_acc_score: 0.8255; val_best_f1_score: 0.8327; train_kl_reg_loss: 28914.5753; train_edge_recon_loss: 330326.4097; train_gene_expr_recon_loss: 446176.4271; train_masked_gp_l1_reg_loss: 6108.5197; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728562.3611; train_global_loss: 1540088.2778; train_optim_loss: 1540088.2778; val_kl_reg_loss: 33291.3594; val_edge_recon_loss: 319790.5000; val_gene_expr_recon_loss: 441805.2500; val_masked_gp_l1_reg_loss: 6140.3096; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718249.4375; val_global_loss: 1519276.8750; val_optim_loss: 1519276.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9215; val_auprc_score: 0.9055; val_best_acc_score: 0.8426; val_best_f1_score: 0.8485; train_kl_reg_loss: 34403.2094; train_edge_recon_loss: 315242.0972; train_gene_expr_recon_loss: 440850.0417; train_masked_gp_l1_reg_loss: 6174.9939; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 722606.9028; train_global_loss: 1519277.2222; train_optim_loss: 1519277.2222; val_kl_reg_loss: 31463.0371; val_edge_recon_loss: 312070.4375; val_gene_expr_recon_loss: 438425.6562; val_masked_gp_l1_reg_loss: 6213.3633; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 715307.2500; val_global_loss: 1503479.7500; val_optim_loss: 1503479.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9290; val_auprc_score: 0.9114; val_best_acc_score: 0.8569; val_best_f1_score: 0.8618; train_kl_reg_loss: 33771.4549; train_edge_recon_loss: 309883.8056; train_gene_expr_recon_loss: 439138.1910; train_masked_gp_l1_reg_loss: 6245.0732; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 723030.9861; train_global_loss: 1512069.4722; train_optim_loss: 1512069.4722; val_kl_reg_loss: 32969.7969; val_edge_recon_loss: 309550.5625; val_gene_expr_recon_loss: 435963.1250; val_masked_gp_l1_reg_loss: 6281.8623; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 712338.1875; val_global_loss: 1497103.5000; val_optim_loss: 1497103.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9340; val_auprc_score: 0.9168; val_best_acc_score: 0.8643; val_best_f1_score: 0.8711; train_kl_reg_loss: 33836.6766; train_edge_recon_loss: 306728.5347; train_gene_expr_recon_loss: 437175.4792; train_masked_gp_l1_reg_loss: 6312.1780; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 720798.1458; train_global_loss: 1504851.0139; train_optim_loss: 1504851.0139; val_kl_reg_loss: 32891.1016; val_edge_recon_loss: 305554.5000; val_gene_expr_recon_loss: 432655.3750; val_masked_gp_l1_reg_loss: 6342.9688; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709813.5000; val_global_loss: 1487257.5000; val_optim_loss: 1487257.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9420; val_auprc_score: 0.9257; val_best_acc_score: 0.8789; val_best_f1_score: 0.8852; train_kl_reg_loss: 34196.9071; train_edge_recon_loss: 302662.8056; train_gene_expr_recon_loss: 434843.6076; train_masked_gp_l1_reg_loss: 6368.8823; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 717668.8542; train_global_loss: 1495741.0417; train_optim_loss: 1495741.0417; val_kl_reg_loss: 32986.3984; val_edge_recon_loss: 302347.0625; val_gene_expr_recon_loss: 431030.0000; val_masked_gp_l1_reg_loss: 6385.9092; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707723.5625; val_global_loss: 1480473.0000; val_optim_loss: 1480473.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9457; val_auprc_score: 0.9326; val_best_acc_score: 0.8817; val_best_f1_score: 0.8875; train_kl_reg_loss: 34057.6228; train_edge_recon_loss: 302617.5938; train_gene_expr_recon_loss: 432046.6181; train_masked_gp_l1_reg_loss: 6408.0359; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 715100.4722; train_global_loss: 1490230.3333; train_optim_loss: 1490230.3333; val_kl_reg_loss: 32821.3984; val_edge_recon_loss: 302198.0938; val_gene_expr_recon_loss: 428783.3125; val_masked_gp_l1_reg_loss: 6420.0781; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 705781.0625; val_global_loss: 1476004.0000; val_optim_loss: 1476004.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9479; val_auprc_score: 0.9339; val_best_acc_score: 0.8861; val_best_f1_score: 0.8927; train_kl_reg_loss: 34085.1871; train_edge_recon_loss: 300539.0764; train_gene_expr_recon_loss: 430855.8264; train_masked_gp_l1_reg_loss: 6441.2654; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 713196.0694; train_global_loss: 1485117.4028; train_optim_loss: 1485117.4028; val_kl_reg_loss: 32721.6562; val_edge_recon_loss: 300834.3750; val_gene_expr_recon_loss: 427509.4375; val_masked_gp_l1_reg_loss: 6458.3477; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 704013.2500; val_global_loss: 1471537.1250; val_optim_loss: 1471537.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9531; val_auprc_score: 0.9384; val_best_acc_score: 0.8937; val_best_f1_score: 0.8971; train_kl_reg_loss: 33757.9935; train_edge_recon_loss: 298734.6319; train_gene_expr_recon_loss: 425815.9826; train_masked_gp_l1_reg_loss: 6481.0143; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 706829.2431; train_global_loss: 1471618.8889; train_optim_loss: 1471618.8889; val_kl_reg_loss: 33105.9492; val_edge_recon_loss: 299300.9062; val_gene_expr_recon_loss: 425733.8750; val_masked_gp_l1_reg_loss: 6500.7324; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 701612.5000; val_global_loss: 1466254.0000; val_optim_loss: 1466254.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9544; val_auprc_score: 0.9389; val_best_acc_score: 0.8992; val_best_f1_score: 0.9017; train_kl_reg_loss: 33680.0547; train_edge_recon_loss: 298747.7917; train_gene_expr_recon_loss: 427113.5729; train_masked_gp_l1_reg_loss: 6517.5426; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 710522.0903; train_global_loss: 1476581.0694; train_optim_loss: 1476581.0694; val_kl_reg_loss: 32757.3125; val_edge_recon_loss: 298757.7500; val_gene_expr_recon_loss: 424471.3750; val_masked_gp_l1_reg_loss: 6534.6216; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 699937.8750; val_global_loss: 1462459.0000; val_optim_loss: 1462459.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9582; val_auprc_score: 0.9487; val_best_acc_score: 0.8994; val_best_f1_score: 0.9019; train_kl_reg_loss: 33740.1248; train_edge_recon_loss: 297039.3819; train_gene_expr_recon_loss: 422801.8160; train_masked_gp_l1_reg_loss: 6559.6217; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703822.7986; train_global_loss: 1463963.7361; train_optim_loss: 1463963.7361; val_kl_reg_loss: 32867.8047; val_edge_recon_loss: 298660.0625; val_gene_expr_recon_loss: 423306.0312; val_masked_gp_l1_reg_loss: 6573.8125; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 698190.4375; val_global_loss: 1459598.1250; val_optim_loss: 1459598.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9620; val_auprc_score: 0.9523; val_best_acc_score: 0.9049; val_best_f1_score: 0.9075; train_kl_reg_loss: 33640.4023; train_edge_recon_loss: 297227.4583; train_gene_expr_recon_loss: 422995.2396; train_masked_gp_l1_reg_loss: 6591.1336; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704463.5903; train_global_loss: 1464917.8194; train_optim_loss: 1464917.8194; val_kl_reg_loss: 32375.6992; val_edge_recon_loss: 297303.7188; val_gene_expr_recon_loss: 421972.8438; val_masked_gp_l1_reg_loss: 6605.9521; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 696224.0625; val_global_loss: 1454482.2500; val_optim_loss: 1454482.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9632; val_auprc_score: 0.9517; val_best_acc_score: 0.9072; val_best_f1_score: 0.9100; train_kl_reg_loss: 33250.5916; train_edge_recon_loss: 297236.3854; train_gene_expr_recon_loss: 421046.2986; train_masked_gp_l1_reg_loss: 6623.3423; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704114.9931; train_global_loss: 1462271.5972; train_optim_loss: 1462271.5972; val_kl_reg_loss: 33057.4961; val_edge_recon_loss: 295622.4375; val_gene_expr_recon_loss: 420244.0625; val_masked_gp_l1_reg_loss: 6638.7744; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694644.1250; val_global_loss: 1450206.8750; val_optim_loss: 1450206.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9685; val_auprc_score: 0.9567; val_best_acc_score: 0.9154; val_best_f1_score: 0.9160; train_kl_reg_loss: 33060.4510; train_edge_recon_loss: 296195.3819; train_gene_expr_recon_loss: 420847.5382; train_masked_gp_l1_reg_loss: 6661.6175; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 702766.9653; train_global_loss: 1459531.9306; train_optim_loss: 1459531.9306; val_kl_reg_loss: 32307.6348; val_edge_recon_loss: 295640.1250; val_gene_expr_recon_loss: 420131.5625; val_masked_gp_l1_reg_loss: 6672.2515; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694023.0000; val_global_loss: 1448774.5000; val_optim_loss: 1448774.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9655; val_auprc_score: 0.9534; val_best_acc_score: 0.9101; val_best_f1_score: 0.9130; train_kl_reg_loss: 32921.3778; train_edge_recon_loss: 295963.1701; train_gene_expr_recon_loss: 419087.3472; train_masked_gp_l1_reg_loss: 6693.1324; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 699023.1806; train_global_loss: 1453688.1944; train_optim_loss: 1453688.1944; val_kl_reg_loss: 32542.3203; val_edge_recon_loss: 295835.6875; val_gene_expr_recon_loss: 418261.5000; val_masked_gp_l1_reg_loss: 6708.2930; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692597.1875; val_global_loss: 1445945.0000; val_optim_loss: 1445945.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9704; val_auprc_score: 0.9600; val_best_acc_score: 0.9161; val_best_f1_score: 0.9186; train_kl_reg_loss: 33002.7005; train_edge_recon_loss: 294696.2569; train_gene_expr_recon_loss: 418049.7569; train_masked_gp_l1_reg_loss: 6725.7095; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 697905.0486; train_global_loss: 1450379.5000; train_optim_loss: 1450379.5000; val_kl_reg_loss: 31985.6406; val_edge_recon_loss: 294520.2188; val_gene_expr_recon_loss: 418256.5000; val_masked_gp_l1_reg_loss: 6737.1870; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 690951.8750; val_global_loss: 1442451.5000; val_optim_loss: 1442451.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9701; val_auprc_score: 0.9580; val_best_acc_score: 0.9170; val_best_f1_score: 0.9194; train_kl_reg_loss: 32702.9789; train_edge_recon_loss: 294844.6667; train_gene_expr_recon_loss: 415927.9097; train_masked_gp_l1_reg_loss: 6754.1566; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 697164.3264; train_global_loss: 1447394.0417; train_optim_loss: 1447394.0417; val_kl_reg_loss: 32006.7539; val_edge_recon_loss: 296735.3438; val_gene_expr_recon_loss: 416591.8125; val_masked_gp_l1_reg_loss: 6766.6084; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 688836.1250; val_global_loss: 1440936.6250; val_optim_loss: 1440936.6250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9680; val_auprc_score: 0.9594; val_best_acc_score: 0.9111; val_best_f1_score: 0.9139; train_kl_reg_loss: 33486.7075; train_edge_recon_loss: 317959.5382; train_gene_expr_recon_loss: 434646.9410; train_masked_gp_l1_reg_loss: 6788.2752; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 713480.4653; train_global_loss: 1506361.9167; train_optim_loss: 1506361.9167; val_kl_reg_loss: 16567.5879; val_edge_recon_loss: 308326.5000; val_gene_expr_recon_loss: 434161.5625; val_masked_gp_l1_reg_loss: 6794.3408; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 701639.4375; val_global_loss: 1467489.3750; val_optim_loss: 1467489.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9685; val_auprc_score: 0.9604; val_best_acc_score: 0.9162; val_best_f1_score: 0.9187; train_kl_reg_loss: 28811.7140; train_edge_recon_loss: 301354.2396; train_gene_expr_recon_loss: 431704.9306; train_masked_gp_l1_reg_loss: 6794.3743; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 705905.2500; train_global_loss: 1474570.5000; train_optim_loss: 1474570.5000; val_kl_reg_loss: 21186.9707; val_edge_recon_loss: 295591.2500; val_gene_expr_recon_loss: 432755.4688; val_masked_gp_l1_reg_loss: 6788.0312; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 700716.0625; val_global_loss: 1457037.7500; val_optim_loss: 1457037.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9691; val_auprc_score: 0.9617; val_best_acc_score: 0.9135; val_best_f1_score: 0.9152; train_kl_reg_loss: 27722.0265; train_edge_recon_loss: 294347.0347; train_gene_expr_recon_loss: 427925.5556; train_masked_gp_l1_reg_loss: 6777.5177; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704992.8681; train_global_loss: 1461765.0000; train_optim_loss: 1461765.0000; val_kl_reg_loss: 22830.1094; val_edge_recon_loss: 295924.0000; val_gene_expr_recon_loss: 430214.6875; val_masked_gp_l1_reg_loss: 6758.2256; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 698431.0000; val_global_loss: 1454158.0000; val_optim_loss: 1454158.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9711; val_auprc_score: 0.9592; val_best_acc_score: 0.9214; val_best_f1_score: 0.9234; train_kl_reg_loss: 27015.4618; train_edge_recon_loss: 292512.9167; train_gene_expr_recon_loss: 426108.8993; train_masked_gp_l1_reg_loss: 6743.3936; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704414.0972; train_global_loss: 1456794.7778; train_optim_loss: 1456794.7778; val_kl_reg_loss: 23968.3984; val_edge_recon_loss: 289583.9062; val_gene_expr_recon_loss: 428325.8750; val_masked_gp_l1_reg_loss: 6723.1533; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 697231.6875; val_global_loss: 1445833.0000; val_optim_loss: 1445833.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9712; val_auprc_score: 0.9618; val_best_acc_score: 0.9229; val_best_f1_score: 0.9248; train_kl_reg_loss: 27513.4605; train_edge_recon_loss: 291826.0729; train_gene_expr_recon_loss: 427139.1910; train_masked_gp_l1_reg_loss: 6689.2707; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704649.3125; train_global_loss: 1457817.2778; train_optim_loss: 1457817.2778; val_kl_reg_loss: 24120.2461; val_edge_recon_loss: 291882.6562; val_gene_expr_recon_loss: 427667.9375; val_masked_gp_l1_reg_loss: 6657.7305; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 696820.7500; val_global_loss: 1447149.3750; val_optim_loss: 1447149.3750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9715; val_auprc_score: 0.9579; val_best_acc_score: 0.9219; val_best_f1_score: 0.9238; train_kl_reg_loss: 27173.3657; train_edge_recon_loss: 291837.0035; train_gene_expr_recon_loss: 428413.7326; train_masked_gp_l1_reg_loss: 6648.8735; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704259.7986; train_global_loss: 1458332.7500; train_optim_loss: 1458332.7500; val_kl_reg_loss: 24108.0234; val_edge_recon_loss: 292581.9688; val_gene_expr_recon_loss: 427533.2500; val_masked_gp_l1_reg_loss: 6635.2368; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 696760.2500; val_global_loss: 1447618.7500; val_optim_loss: 1447618.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9690; val_auprc_score: 0.9599; val_best_acc_score: 0.9171; val_best_f1_score: 0.9195; train_kl_reg_loss: 27185.1443; train_edge_recon_loss: 292859.3646; train_gene_expr_recon_loss: 425108.5903; train_masked_gp_l1_reg_loss: 6627.6641; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703852.2778; train_global_loss: 1455633.0278; train_optim_loss: 1455633.0278; val_kl_reg_loss: 23767.7422; val_edge_recon_loss: 293208.6562; val_gene_expr_recon_loss: 427912.0938; val_masked_gp_l1_reg_loss: 6618.6890; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 696704.3750; val_global_loss: 1448211.5000; val_optim_loss: 1448211.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9730; val_auprc_score: 0.9621; val_best_acc_score: 0.9243; val_best_f1_score: 0.9259; train_kl_reg_loss: 27062.0200; train_edge_recon_loss: 291169.1042; train_gene_expr_recon_loss: 428346.8333; train_masked_gp_l1_reg_loss: 6613.0997; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703298.6667; train_global_loss: 1456489.7083; train_optim_loss: 1456489.7083; val_kl_reg_loss: 24223.0117; val_edge_recon_loss: 292913.9062; val_gene_expr_recon_loss: 427153.1250; val_masked_gp_l1_reg_loss: 6607.0469; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 696476.9375; val_global_loss: 1447374.0000; val_optim_loss: 1447374.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 25 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9716
val AUPRC score: 0.9643
val best accuracy score: 0.9171
val best F1 score: 0.9194
val target rna MSE score: 0.5025
val source rna MSE score: 0.3512
val target atac MSE score: 0.1331
val source atac MSE score: 0.0186
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
