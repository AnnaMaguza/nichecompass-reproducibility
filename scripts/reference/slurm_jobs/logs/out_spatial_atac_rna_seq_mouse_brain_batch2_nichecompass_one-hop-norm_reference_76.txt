[True]
Run timestamp: 07092023_182403_76.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_76']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2398 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5114, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6087; val_auprc_score: 0.6187; val_best_acc_score: 0.5038; val_best_f1_score: 0.6682; train_kl_reg_loss: 68075.0655; train_edge_recon_loss: 3590715.0417; train_gene_expr_recon_loss: 20857813.0303; train_masked_gp_l1_reg_loss: 145144.8539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6013520.5758; train_chrom_access_recon_loss: 6174939.0000; train_global_loss: 36850207.6061; train_optim_loss: 36850207.6061; val_kl_reg_loss: 93914.3516; val_edge_recon_loss: 4065307.3438; val_gene_expr_recon_loss: 19277979.5000; val_masked_gp_l1_reg_loss: 128980.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2575947.0000; val_chrom_access_recon_loss: 5963212.8125; val_global_loss: 32105341.0000; val_optim_loss: 32105341.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6928; val_auprc_score: 0.6769; val_best_acc_score: 0.5416; val_best_f1_score: 0.6798; train_kl_reg_loss: 129716.5276; train_edge_recon_loss: 3554829.6174; train_gene_expr_recon_loss: 18808324.2424; train_masked_gp_l1_reg_loss: 120439.7830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1107081.9313; train_chrom_access_recon_loss: 5847735.8258; train_global_loss: 29568127.9697; train_optim_loss: 29568127.9697; val_kl_reg_loss: 149813.2188; val_edge_recon_loss: 4062723.9062; val_gene_expr_recon_loss: 18815264.2500; val_masked_gp_l1_reg_loss: 115808.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 411107.1875; val_chrom_access_recon_loss: 5876122.3125; val_global_loss: 29430839.7500; val_optim_loss: 29430839.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7040; val_auprc_score: 0.6882; val_best_acc_score: 0.6413; val_best_f1_score: 0.6827; train_kl_reg_loss: 122237.6512; train_edge_recon_loss: 3536098.8258; train_gene_expr_recon_loss: 18526486.9697; train_masked_gp_l1_reg_loss: 114268.8468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 279618.9060; train_chrom_access_recon_loss: 5798015.4394; train_global_loss: 28376726.6061; train_optim_loss: 28376726.6061; val_kl_reg_loss: 129946.1533; val_edge_recon_loss: 4048122.1562; val_gene_expr_recon_loss: 18497668.2500; val_masked_gp_l1_reg_loss: 114153.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 203020.7188; val_chrom_access_recon_loss: 5872480.3125; val_global_loss: 28865390.7500; val_optim_loss: 28865390.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7878; val_auprc_score: 0.7759; val_best_acc_score: 0.7104; val_best_f1_score: 0.7438; train_kl_reg_loss: 109849.1997; train_edge_recon_loss: 3520407.6023; train_gene_expr_recon_loss: 18375451.9394; train_masked_gp_l1_reg_loss: 116449.9245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171920.4688; train_chrom_access_recon_loss: 5764173.9545; train_global_loss: 28058253.0303; train_optim_loss: 28058253.0303; val_kl_reg_loss: 104496.5068; val_edge_recon_loss: 3946792.3750; val_gene_expr_recon_loss: 18229865.7500; val_masked_gp_l1_reg_loss: 118548.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149498.7969; val_chrom_access_recon_loss: 5786691.5000; val_global_loss: 28335891.7500; val_optim_loss: 28335891.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8114; val_auprc_score: 0.7803; val_best_acc_score: 0.7418; val_best_f1_score: 0.7688; train_kl_reg_loss: 91567.0606; train_edge_recon_loss: 3425215.0038; train_gene_expr_recon_loss: 18257325.2424; train_masked_gp_l1_reg_loss: 122031.9100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138093.8124; train_chrom_access_recon_loss: 5728325.7879; train_global_loss: 27762558.7879; train_optim_loss: 27762558.7879; val_kl_reg_loss: 87773.8857; val_edge_recon_loss: 3356934.8750; val_gene_expr_recon_loss: 18175670.2500; val_masked_gp_l1_reg_loss: 126271.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128465.2734; val_chrom_access_recon_loss: 5729495.6875; val_global_loss: 27604612.7500; val_optim_loss: 27604612.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8564; val_auprc_score: 0.8319; val_best_acc_score: 0.7663; val_best_f1_score: 0.7924; train_kl_reg_loss: 109563.2657; train_edge_recon_loss: 3105230.3750; train_gene_expr_recon_loss: 18166265.7879; train_masked_gp_l1_reg_loss: 131635.9856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123599.1969; train_chrom_access_recon_loss: 5693224.3485; train_global_loss: 27329518.8788; train_optim_loss: 27329518.8788; val_kl_reg_loss: 122689.7910; val_edge_recon_loss: 3024858.2188; val_gene_expr_recon_loss: 18178538.2500; val_masked_gp_l1_reg_loss: 135251.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119315.2656; val_chrom_access_recon_loss: 5733892.8125; val_global_loss: 27314547.0000; val_optim_loss: 27314547.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8683; val_auprc_score: 0.8219; val_best_acc_score: 0.8036; val_best_f1_score: 0.8207; train_kl_reg_loss: 124635.5335; train_edge_recon_loss: 2991048.1705; train_gene_expr_recon_loss: 18072473.5455; train_masked_gp_l1_reg_loss: 136858.5102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115874.6296; train_chrom_access_recon_loss: 5664071.2348; train_global_loss: 27104961.8182; train_optim_loss: 27104961.8182; val_kl_reg_loss: 122055.0049; val_edge_recon_loss: 2973952.5938; val_gene_expr_recon_loss: 18095330.0000; val_masked_gp_l1_reg_loss: 138154.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113301.7500; val_chrom_access_recon_loss: 5727949.5000; val_global_loss: 27170743.2500; val_optim_loss: 27170743.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8846; val_auprc_score: 0.8500; val_best_acc_score: 0.8146; val_best_f1_score: 0.8275; train_kl_reg_loss: 122569.6887; train_edge_recon_loss: 2924321.2841; train_gene_expr_recon_loss: 17962082.9697; train_masked_gp_l1_reg_loss: 139789.8565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111584.4317; train_chrom_access_recon_loss: 5631039.1742; train_global_loss: 26891387.3636; train_optim_loss: 26891387.3636; val_kl_reg_loss: 123189.8828; val_edge_recon_loss: 2962271.5000; val_gene_expr_recon_loss: 17960551.0000; val_masked_gp_l1_reg_loss: 141695.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111234.5547; val_chrom_access_recon_loss: 5675071.2500; val_global_loss: 26974014.2500; val_optim_loss: 26974014.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8977; val_auprc_score: 0.8684; val_best_acc_score: 0.8342; val_best_f1_score: 0.8456; train_kl_reg_loss: 125400.7152; train_edge_recon_loss: 2880695.3636; train_gene_expr_recon_loss: 17880701.5758; train_masked_gp_l1_reg_loss: 142682.2225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109541.2944; train_chrom_access_recon_loss: 5615002.6818; train_global_loss: 26754023.8485; train_optim_loss: 26754023.8485; val_kl_reg_loss: 128323.9639; val_edge_recon_loss: 2872888.2500; val_gene_expr_recon_loss: 17987716.0000; val_masked_gp_l1_reg_loss: 143865.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108746.9688; val_chrom_access_recon_loss: 5675995.5625; val_global_loss: 26917535.5000; val_optim_loss: 26917535.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9011; val_auprc_score: 0.8663; val_best_acc_score: 0.8313; val_best_f1_score: 0.8465; train_kl_reg_loss: 128896.1256; train_edge_recon_loss: 2853543.2121; train_gene_expr_recon_loss: 17790493.5152; train_masked_gp_l1_reg_loss: 144894.4008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107750.8242; train_chrom_access_recon_loss: 5589722.0000; train_global_loss: 26615300.1515; train_optim_loss: 26615300.1515; val_kl_reg_loss: 122246.3271; val_edge_recon_loss: 2881106.5000; val_gene_expr_recon_loss: 17863922.0000; val_masked_gp_l1_reg_loss: 146052.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107121.8906; val_chrom_access_recon_loss: 5645188.7500; val_global_loss: 26765638.2500; val_optim_loss: 26765638.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9048; val_auprc_score: 0.8757; val_best_acc_score: 0.8426; val_best_f1_score: 0.8520; train_kl_reg_loss: 124290.2103; train_edge_recon_loss: 2840718.0871; train_gene_expr_recon_loss: 17711797.7273; train_masked_gp_l1_reg_loss: 147246.1828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105954.4857; train_chrom_access_recon_loss: 5567948.9848; train_global_loss: 26497955.7273; train_optim_loss: 26497955.7273; val_kl_reg_loss: 123389.6680; val_edge_recon_loss: 2848189.6875; val_gene_expr_recon_loss: 17692462.0000; val_masked_gp_l1_reg_loss: 148617.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105515.9297; val_chrom_access_recon_loss: 5611924.1875; val_global_loss: 26530099.0000; val_optim_loss: 26530099.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9037; val_auprc_score: 0.8758; val_best_acc_score: 0.8366; val_best_f1_score: 0.8470; train_kl_reg_loss: 125853.8232; train_edge_recon_loss: 2814661.1932; train_gene_expr_recon_loss: 17640236.2727; train_masked_gp_l1_reg_loss: 149275.3883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104245.4561; train_chrom_access_recon_loss: 5547096.6970; train_global_loss: 26381368.7879; train_optim_loss: 26381368.7879; val_kl_reg_loss: 127238.5771; val_edge_recon_loss: 2882417.3438; val_gene_expr_recon_loss: 17693731.5000; val_masked_gp_l1_reg_loss: 150119.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103249.3281; val_chrom_access_recon_loss: 5574265.8125; val_global_loss: 26531023.5000; val_optim_loss: 26531023.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9132; val_auprc_score: 0.8847; val_best_acc_score: 0.8482; val_best_f1_score: 0.8570; train_kl_reg_loss: 123917.7112; train_edge_recon_loss: 2817348.8674; train_gene_expr_recon_loss: 17590823.5152; train_masked_gp_l1_reg_loss: 151040.1411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102818.8105; train_chrom_access_recon_loss: 5527659.1818; train_global_loss: 26313608.3636; train_optim_loss: 26313608.3636; val_kl_reg_loss: 126781.3877; val_edge_recon_loss: 2829579.0625; val_gene_expr_recon_loss: 17596430.0000; val_masked_gp_l1_reg_loss: 151880.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102452.8203; val_chrom_access_recon_loss: 5549627.5625; val_global_loss: 26356749.7500; val_optim_loss: 26356749.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9213; val_auprc_score: 0.8963; val_best_acc_score: 0.8589; val_best_f1_score: 0.8664; train_kl_reg_loss: 123843.3147; train_edge_recon_loss: 2809291.7159; train_gene_expr_recon_loss: 17526269.3636; train_masked_gp_l1_reg_loss: 152528.2450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101855.2710; train_chrom_access_recon_loss: 5513194.8485; train_global_loss: 26226982.6667; train_optim_loss: 26226982.6667; val_kl_reg_loss: 119052.5781; val_edge_recon_loss: 2834125.7500; val_gene_expr_recon_loss: 17643766.0000; val_masked_gp_l1_reg_loss: 153537.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102274.6875; val_chrom_access_recon_loss: 5598571.6875; val_global_loss: 26451327.7500; val_optim_loss: 26451327.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9192; val_auprc_score: 0.8946; val_best_acc_score: 0.8541; val_best_f1_score: 0.8667; train_kl_reg_loss: 123549.3370; train_edge_recon_loss: 2798411.6932; train_gene_expr_recon_loss: 17472123.3333; train_masked_gp_l1_reg_loss: 153944.4351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101476.6893; train_chrom_access_recon_loss: 5488835.0379; train_global_loss: 26138340.4848; train_optim_loss: 26138340.4848; val_kl_reg_loss: 121027.2539; val_edge_recon_loss: 2820839.0625; val_gene_expr_recon_loss: 17747192.0000; val_masked_gp_l1_reg_loss: 154833.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101372.5938; val_chrom_access_recon_loss: 5671991.3125; val_global_loss: 26617255.7500; val_optim_loss: 26617255.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9249; val_auprc_score: 0.9044; val_best_acc_score: 0.8635; val_best_f1_score: 0.8697; train_kl_reg_loss: 122314.1745; train_edge_recon_loss: 2788955.5227; train_gene_expr_recon_loss: 17419101.6818; train_masked_gp_l1_reg_loss: 155394.2898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101011.8711; train_chrom_access_recon_loss: 5472857.6515; train_global_loss: 26059635.0606; train_optim_loss: 26059635.0606; val_kl_reg_loss: 121820.0732; val_edge_recon_loss: 2802615.5938; val_gene_expr_recon_loss: 17494397.7500; val_masked_gp_l1_reg_loss: 155886.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100654.9766; val_chrom_access_recon_loss: 5645352.8750; val_global_loss: 26320725.7500; val_optim_loss: 26320725.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9236; val_auprc_score: 0.8972; val_best_acc_score: 0.8619; val_best_f1_score: 0.8698; train_kl_reg_loss: 120261.6496; train_edge_recon_loss: 2778371.3371; train_gene_expr_recon_loss: 17372333.4242; train_masked_gp_l1_reg_loss: 156563.5152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100309.3642; train_chrom_access_recon_loss: 5460336.8030; train_global_loss: 25988176.3030; train_optim_loss: 25988176.3030; val_kl_reg_loss: 117336.3154; val_edge_recon_loss: 2828952.6562; val_gene_expr_recon_loss: 17539150.5000; val_masked_gp_l1_reg_loss: 157358.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100284.7422; val_chrom_access_recon_loss: 5582237.3750; val_global_loss: 26325319.0000; val_optim_loss: 26325319.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9290; val_auprc_score: 0.9055; val_best_acc_score: 0.8694; val_best_f1_score: 0.8759; train_kl_reg_loss: 118412.7290; train_edge_recon_loss: 2787938.7159; train_gene_expr_recon_loss: 17316768.5455; train_masked_gp_l1_reg_loss: 157805.9728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99438.7940; train_chrom_access_recon_loss: 5436239.0227; train_global_loss: 25916603.7879; train_optim_loss: 25916603.7879; val_kl_reg_loss: 117884.1670; val_edge_recon_loss: 2794599.4375; val_gene_expr_recon_loss: 17300957.5000; val_masked_gp_l1_reg_loss: 158252.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98750.3047; val_chrom_access_recon_loss: 5502476.5000; val_global_loss: 25972919.2500; val_optim_loss: 25972919.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9281; val_auprc_score: 0.9090; val_best_acc_score: 0.8667; val_best_f1_score: 0.8731; train_kl_reg_loss: 119347.5446; train_edge_recon_loss: 2775286.9394; train_gene_expr_recon_loss: 17283576.9697; train_masked_gp_l1_reg_loss: 159073.6001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98773.1126; train_chrom_access_recon_loss: 5429832.0303; train_global_loss: 25865890.6061; train_optim_loss: 25865890.6061; val_kl_reg_loss: 115138.5566; val_edge_recon_loss: 2814753.2500; val_gene_expr_recon_loss: 17389029.7500; val_masked_gp_l1_reg_loss: 159870.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98614.8516; val_chrom_access_recon_loss: 5514504.8125; val_global_loss: 26091910.2500; val_optim_loss: 26091910.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9291; val_auprc_score: 0.9010; val_best_acc_score: 0.8689; val_best_f1_score: 0.8757; train_kl_reg_loss: 118174.4392; train_edge_recon_loss: 2761979.8106; train_gene_expr_recon_loss: 17229035.5000; train_masked_gp_l1_reg_loss: 160097.9467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98289.7167; train_chrom_access_recon_loss: 5417022.0833; train_global_loss: 25784599.4848; train_optim_loss: 25784599.4848; val_kl_reg_loss: 120493.9893; val_edge_recon_loss: 2772513.3438; val_gene_expr_recon_loss: 17249343.6250; val_masked_gp_l1_reg_loss: 160891.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98358.5625; val_chrom_access_recon_loss: 5479496.1250; val_global_loss: 25881097.0000; val_optim_loss: 25881097.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9334; val_auprc_score: 0.9109; val_best_acc_score: 0.8692; val_best_f1_score: 0.8762; train_kl_reg_loss: 117104.5450; train_edge_recon_loss: 2767040.5606; train_gene_expr_recon_loss: 17203297.4091; train_masked_gp_l1_reg_loss: 161283.0807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98076.9685; train_chrom_access_recon_loss: 5404213.3485; train_global_loss: 25751016.0303; train_optim_loss: 25751016.0303; val_kl_reg_loss: 116221.5225; val_edge_recon_loss: 2815956.5625; val_gene_expr_recon_loss: 17149904.3750; val_masked_gp_l1_reg_loss: 161994.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98096.6328; val_chrom_access_recon_loss: 5434226.1875; val_global_loss: 25776399.0000; val_optim_loss: 25776399.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9333; val_auprc_score: 0.9134; val_best_acc_score: 0.8745; val_best_f1_score: 0.8803; train_kl_reg_loss: 118393.1084; train_edge_recon_loss: 2759886.3712; train_gene_expr_recon_loss: 17161777.7273; train_masked_gp_l1_reg_loss: 162229.1406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97719.3073; train_chrom_access_recon_loss: 5385098.3409; train_global_loss: 25685103.9697; train_optim_loss: 25685103.9697; val_kl_reg_loss: 118379.9385; val_edge_recon_loss: 2806891.3750; val_gene_expr_recon_loss: 17075933.6250; val_masked_gp_l1_reg_loss: 162564.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97592.8672; val_chrom_access_recon_loss: 5420042.5000; val_global_loss: 25681403.2500; val_optim_loss: 25681403.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9331; val_auprc_score: 0.9148; val_best_acc_score: 0.8729; val_best_f1_score: 0.8779; train_kl_reg_loss: 117129.5382; train_edge_recon_loss: 2758985.4886; train_gene_expr_recon_loss: 17129211.1212; train_masked_gp_l1_reg_loss: 162970.3875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97771.5163; train_chrom_access_recon_loss: 5374447.5985; train_global_loss: 25640515.5455; train_optim_loss: 25640515.5455; val_kl_reg_loss: 118718.7998; val_edge_recon_loss: 2812339.8750; val_gene_expr_recon_loss: 17143984.0000; val_masked_gp_l1_reg_loss: 163426.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97647.8672; val_chrom_access_recon_loss: 5411345.9375; val_global_loss: 25747462.7500; val_optim_loss: 25747462.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9298; val_auprc_score: 0.9028; val_best_acc_score: 0.8753; val_best_f1_score: 0.8815; train_kl_reg_loss: 115251.7906; train_edge_recon_loss: 2751645.0871; train_gene_expr_recon_loss: 17085361.0152; train_masked_gp_l1_reg_loss: 163871.2609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97591.7373; train_chrom_access_recon_loss: 5362458.9848; train_global_loss: 25576179.6970; train_optim_loss: 25576179.6970; val_kl_reg_loss: 114053.1904; val_edge_recon_loss: 2800346.7500; val_gene_expr_recon_loss: 17145538.0000; val_masked_gp_l1_reg_loss: 164216.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97415.1406; val_chrom_access_recon_loss: 5432116.1250; val_global_loss: 25753686.5000; val_optim_loss: 25753686.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9419; val_auprc_score: 0.9261; val_best_acc_score: 0.8842; val_best_f1_score: 0.8888; train_kl_reg_loss: 114912.8413; train_edge_recon_loss: 2756586.1174; train_gene_expr_recon_loss: 17059647.5303; train_masked_gp_l1_reg_loss: 164798.2114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97295.6263; train_chrom_access_recon_loss: 5352060.3864; train_global_loss: 25545300.6364; train_optim_loss: 25545300.6364; val_kl_reg_loss: 117806.8926; val_edge_recon_loss: 2793825.5312; val_gene_expr_recon_loss: 17017413.5000; val_masked_gp_l1_reg_loss: 165075.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96954.4141; val_chrom_access_recon_loss: 5423116.0000; val_global_loss: 25614191.7500; val_optim_loss: 25614191.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9391; val_auprc_score: 0.9240; val_best_acc_score: 0.8802; val_best_f1_score: 0.8840; train_kl_reg_loss: 120955.9588; train_edge_recon_loss: 2812188.0265; train_gene_expr_recon_loss: 16583667.8030; train_masked_gp_l1_reg_loss: 163250.9920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94793.2318; train_chrom_access_recon_loss: 5234017.8409; train_global_loss: 25008873.6061; train_optim_loss: 25008873.6061; val_kl_reg_loss: 76109.1953; val_edge_recon_loss: 2794841.7188; val_gene_expr_recon_loss: 16533796.5000; val_masked_gp_l1_reg_loss: 162344.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95356.6641; val_chrom_access_recon_loss: 5295716.5000; val_global_loss: 24958164.2500; val_optim_loss: 24958164.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9357; val_auprc_score: 0.9093; val_best_acc_score: 0.8780; val_best_f1_score: 0.8841; train_kl_reg_loss: 125573.5005; train_edge_recon_loss: 2775138.3068; train_gene_expr_recon_loss: 16485696.4091; train_masked_gp_l1_reg_loss: 161847.9013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94475.1849; train_chrom_access_recon_loss: 5160786.9848; train_global_loss: 24803518.2424; train_optim_loss: 24803518.2424; val_kl_reg_loss: 83319.1475; val_edge_recon_loss: 2804898.1562; val_gene_expr_recon_loss: 16469834.7500; val_masked_gp_l1_reg_loss: 161283.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94160.8203; val_chrom_access_recon_loss: 5178286.8125; val_global_loss: 24791782.7500; val_optim_loss: 24791782.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9414; val_auprc_score: 0.9250; val_best_acc_score: 0.8788; val_best_f1_score: 0.8851; train_kl_reg_loss: 116408.7077; train_edge_recon_loss: 2766693.2576; train_gene_expr_recon_loss: 16427796.8485; train_masked_gp_l1_reg_loss: 161233.7455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93663.8782; train_chrom_access_recon_loss: 5134816.1364; train_global_loss: 24700612.5455; train_optim_loss: 24700612.5455; val_kl_reg_loss: 85888.1201; val_edge_recon_loss: 2809524.1562; val_gene_expr_recon_loss: 16579177.6250; val_masked_gp_l1_reg_loss: 161186.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93661.8438; val_chrom_access_recon_loss: 5228474.2500; val_global_loss: 24957912.0000; val_optim_loss: 24957912.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9445; val_auprc_score: 0.9278; val_best_acc_score: 0.8864; val_best_f1_score: 0.8909; train_kl_reg_loss: 112175.5741; train_edge_recon_loss: 2756502.9773; train_gene_expr_recon_loss: 16380059.0909; train_masked_gp_l1_reg_loss: 160971.3632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93080.6310; train_chrom_access_recon_loss: 5122885.9848; train_global_loss: 24625675.5758; train_optim_loss: 24625675.5758; val_kl_reg_loss: 90938.4238; val_edge_recon_loss: 2748357.8438; val_gene_expr_recon_loss: 16392297.1250; val_masked_gp_l1_reg_loss: 160807.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92866.9375; val_chrom_access_recon_loss: 5138792.8750; val_global_loss: 24624059.5000; val_optim_loss: 24624059.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9456; val_auprc_score: 0.9289; val_best_acc_score: 0.8920; val_best_f1_score: 0.8953; train_kl_reg_loss: 111781.6688; train_edge_recon_loss: 2751624.6780; train_gene_expr_recon_loss: 16309865.0152; train_masked_gp_l1_reg_loss: 160468.8651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92339.9665; train_chrom_access_recon_loss: 5096054.0000; train_global_loss: 24522134.0909; train_optim_loss: 24522134.0909; val_kl_reg_loss: 93948.1533; val_edge_recon_loss: 2765508.0625; val_gene_expr_recon_loss: 16424106.2500; val_masked_gp_l1_reg_loss: 160145.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91958.9375; val_chrom_access_recon_loss: 5254697.6875; val_global_loss: 24790364.2500; val_optim_loss: 24790364.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9417; val_auprc_score: 0.9197; val_best_acc_score: 0.8864; val_best_f1_score: 0.8917; train_kl_reg_loss: 107674.6192; train_edge_recon_loss: 2740156.6780; train_gene_expr_recon_loss: 16277355.0758; train_masked_gp_l1_reg_loss: 159953.5601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91999.1004; train_chrom_access_recon_loss: 5078086.1667; train_global_loss: 24455225.2424; train_optim_loss: 24455225.2424; val_kl_reg_loss: 93633.0391; val_edge_recon_loss: 2800973.0000; val_gene_expr_recon_loss: 16533445.2500; val_masked_gp_l1_reg_loss: 159948.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92233.8438; val_chrom_access_recon_loss: 5178471.1875; val_global_loss: 24858704.7500; val_optim_loss: 24858704.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9439; val_auprc_score: 0.9236; val_best_acc_score: 0.8888; val_best_f1_score: 0.8937; train_kl_reg_loss: 105136.2770; train_edge_recon_loss: 2739271.1023; train_gene_expr_recon_loss: 16242823.4394; train_masked_gp_l1_reg_loss: 159834.0933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91778.1081; train_chrom_access_recon_loss: 5069459.5303; train_global_loss: 24408302.6970; train_optim_loss: 24408302.6970; val_kl_reg_loss: 94174.8418; val_edge_recon_loss: 2768031.2812; val_gene_expr_recon_loss: 16208402.2500; val_masked_gp_l1_reg_loss: 159793.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92044.8984; val_chrom_access_recon_loss: 5160302.2500; val_global_loss: 24482748.7500; val_optim_loss: 24482748.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9524; val_auprc_score: 0.9333; val_best_acc_score: 0.8990; val_best_f1_score: 0.9021; train_kl_reg_loss: 105701.2857; train_edge_recon_loss: 2736400.1136; train_gene_expr_recon_loss: 16215812.0909; train_masked_gp_l1_reg_loss: 159481.3388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91355.2650; train_chrom_access_recon_loss: 5057793.1061; train_global_loss: 24366543.2424; train_optim_loss: 24366543.2424; val_kl_reg_loss: 96684.6074; val_edge_recon_loss: 2751675.9375; val_gene_expr_recon_loss: 16296510.2500; val_masked_gp_l1_reg_loss: 159252.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90649.3125; val_chrom_access_recon_loss: 5141880.0000; val_global_loss: 24536653.0000; val_optim_loss: 24536653.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9463; val_auprc_score: 0.9260; val_best_acc_score: 0.8941; val_best_f1_score: 0.8981; train_kl_reg_loss: 103623.8808; train_edge_recon_loss: 2731857.3409; train_gene_expr_recon_loss: 16180666.8182; train_masked_gp_l1_reg_loss: 159118.1977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90795.9625; train_chrom_access_recon_loss: 5048202.4848; train_global_loss: 24314264.6667; train_optim_loss: 24314264.6667; val_kl_reg_loss: 96065.4688; val_edge_recon_loss: 2756518.1250; val_gene_expr_recon_loss: 16309362.7500; val_masked_gp_l1_reg_loss: 159195.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90945.5781; val_chrom_access_recon_loss: 5137476.5000; val_global_loss: 24549564.7500; val_optim_loss: 24549564.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9503; val_auprc_score: 0.9355; val_best_acc_score: 0.8974; val_best_f1_score: 0.9024; train_kl_reg_loss: 103375.0146; train_edge_recon_loss: 2734307.1098; train_gene_expr_recon_loss: 16160645.0000; train_masked_gp_l1_reg_loss: 158993.5971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90872.8790; train_chrom_access_recon_loss: 5040033.7273; train_global_loss: 24288227.5758; train_optim_loss: 24288227.5758; val_kl_reg_loss: 98220.8447; val_edge_recon_loss: 2789694.6875; val_gene_expr_recon_loss: 16088410.3750; val_masked_gp_l1_reg_loss: 158832.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90600.0234; val_chrom_access_recon_loss: 5098037.6875; val_global_loss: 24323795.2500; val_optim_loss: 24323795.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9451; val_auprc_score: 0.9262; val_best_acc_score: 0.8917; val_best_f1_score: 0.8956; train_kl_reg_loss: 104409.1463; train_edge_recon_loss: 2724768.6288; train_gene_expr_recon_loss: 16120508.5909; train_masked_gp_l1_reg_loss: 158629.3094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90442.5700; train_chrom_access_recon_loss: 5035237.5833; train_global_loss: 24233995.7576; train_optim_loss: 24233995.7576; val_kl_reg_loss: 97959.1387; val_edge_recon_loss: 2786239.5000; val_gene_expr_recon_loss: 16121608.2500; val_masked_gp_l1_reg_loss: 158502.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89860.5156; val_chrom_access_recon_loss: 5096339.0000; val_global_loss: 24350507.5000; val_optim_loss: 24350507.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9503; val_auprc_score: 0.9332; val_best_acc_score: 0.8936; val_best_f1_score: 0.8990; train_kl_reg_loss: 101928.1851; train_edge_recon_loss: 2726132.9545; train_gene_expr_recon_loss: 16110523.4091; train_masked_gp_l1_reg_loss: 158652.0369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90481.9644; train_chrom_access_recon_loss: 5029427.7576; train_global_loss: 24217146.2424; train_optim_loss: 24217146.2424; val_kl_reg_loss: 101192.7305; val_edge_recon_loss: 2776900.1250; val_gene_expr_recon_loss: 16266417.5000; val_masked_gp_l1_reg_loss: 158643.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90626.5156; val_chrom_access_recon_loss: 5145172.5625; val_global_loss: 24538953.2500; val_optim_loss: 24538953.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9523; val_auprc_score: 0.9343; val_best_acc_score: 0.9019; val_best_f1_score: 0.9064; train_kl_reg_loss: 101998.8170; train_edge_recon_loss: 2727201.1212; train_gene_expr_recon_loss: 16077627.3182; train_masked_gp_l1_reg_loss: 158691.6224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90506.1572; train_chrom_access_recon_loss: 5016841.7273; train_global_loss: 24172866.7576; train_optim_loss: 24172866.7576; val_kl_reg_loss: 99979.2617; val_edge_recon_loss: 2749573.2500; val_gene_expr_recon_loss: 16192107.6250; val_masked_gp_l1_reg_loss: 158722.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90086.1172; val_chrom_access_recon_loss: 5136131.0000; val_global_loss: 24426598.2500; val_optim_loss: 24426598.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9517; val_auprc_score: 0.9303; val_best_acc_score: 0.9030; val_best_f1_score: 0.9064; train_kl_reg_loss: 102278.8932; train_edge_recon_loss: 2722900.5000; train_gene_expr_recon_loss: 16065982.8485; train_masked_gp_l1_reg_loss: 158670.9413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90218.2352; train_chrom_access_recon_loss: 5017520.3409; train_global_loss: 24157572.0606; train_optim_loss: 24157572.0606; val_kl_reg_loss: 100351.3730; val_edge_recon_loss: 2731973.8750; val_gene_expr_recon_loss: 16184136.3750; val_masked_gp_l1_reg_loss: 158801.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90616.6562; val_chrom_access_recon_loss: 5071210.8125; val_global_loss: 24337090.5000; val_optim_loss: 24337090.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9516; val_auprc_score: 0.9291; val_best_acc_score: 0.8987; val_best_f1_score: 0.9029; train_kl_reg_loss: 101771.3615; train_edge_recon_loss: 2713594.7500; train_gene_expr_recon_loss: 16049131.9242; train_masked_gp_l1_reg_loss: 157145.3035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72996.0176; train_chrom_access_recon_loss: 5010946.4394; train_global_loss: 24105585.6364; train_optim_loss: 24105585.6364; val_kl_reg_loss: 98430.3701; val_edge_recon_loss: 2754420.4062; val_gene_expr_recon_loss: 16108481.2500; val_masked_gp_l1_reg_loss: 156490.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69298.4375; val_chrom_access_recon_loss: 5111041.6250; val_global_loss: 24298161.2500; val_optim_loss: 24298161.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9507; val_auprc_score: 0.9267; val_best_acc_score: 0.9003; val_best_f1_score: 0.9043; train_kl_reg_loss: 103325.8542; train_edge_recon_loss: 2711307.0720; train_gene_expr_recon_loss: 16043813.6061; train_masked_gp_l1_reg_loss: 156348.3911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69021.1203; train_chrom_access_recon_loss: 5010892.6894; train_global_loss: 24094708.9091; train_optim_loss: 24094708.9091; val_kl_reg_loss: 99470.7520; val_edge_recon_loss: 2746294.0312; val_gene_expr_recon_loss: 16341653.0000; val_masked_gp_l1_reg_loss: 156237.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68704.1094; val_chrom_access_recon_loss: 5132189.8125; val_global_loss: 24544550.0000; val_optim_loss: 24544550.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9582; val_auprc_score: 0.9434; val_best_acc_score: 0.9087; val_best_f1_score: 0.9117; train_kl_reg_loss: 103852.9338; train_edge_recon_loss: 2716534.6364; train_gene_expr_recon_loss: 16036563.7121; train_masked_gp_l1_reg_loss: 156201.8956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68564.1888; train_chrom_access_recon_loss: 5004295.3106; train_global_loss: 24086013.0909; train_optim_loss: 24086013.0909; val_kl_reg_loss: 99938.3477; val_edge_recon_loss: 2747875.0000; val_gene_expr_recon_loss: 16146741.3750; val_masked_gp_l1_reg_loss: 156167.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68389.0703; val_chrom_access_recon_loss: 5043531.3125; val_global_loss: 24262643.7500; val_optim_loss: 24262643.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9486; val_auprc_score: 0.9261; val_best_acc_score: 0.8968; val_best_f1_score: 0.9018; train_kl_reg_loss: 103733.8994; train_edge_recon_loss: 2727226.4432; train_gene_expr_recon_loss: 16032198.3182; train_masked_gp_l1_reg_loss: 156144.4370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68327.7815; train_chrom_access_recon_loss: 5002384.9470; train_global_loss: 24090015.6364; train_optim_loss: 24090015.6364; val_kl_reg_loss: 100989.6533; val_edge_recon_loss: 2771724.2188; val_gene_expr_recon_loss: 16214208.2500; val_masked_gp_l1_reg_loss: 156125.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68249.4453; val_chrom_access_recon_loss: 5105578.3750; val_global_loss: 24416877.2500; val_optim_loss: 24416877.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9524; val_auprc_score: 0.9341; val_best_acc_score: 0.8992; val_best_f1_score: 0.9034; train_kl_reg_loss: 104103.4193; train_edge_recon_loss: 2718287.6515; train_gene_expr_recon_loss: 16032124.5758; train_masked_gp_l1_reg_loss: 156114.5270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68133.8942; train_chrom_access_recon_loss: 5004484.4773; train_global_loss: 24083248.2424; train_optim_loss: 24083248.2424; val_kl_reg_loss: 100520.4766; val_edge_recon_loss: 2759305.9688; val_gene_expr_recon_loss: 16109196.5000; val_masked_gp_l1_reg_loss: 156106.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68180.1328; val_chrom_access_recon_loss: 5087686.3750; val_global_loss: 24280995.0000; val_optim_loss: 24280995.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9537; val_auprc_score: 0.9363; val_best_acc_score: 0.9041; val_best_f1_score: 0.9075; train_kl_reg_loss: 104819.6764; train_edge_recon_loss: 2718842.8902; train_gene_expr_recon_loss: 16033279.7879; train_masked_gp_l1_reg_loss: 156106.7079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68068.1650; train_chrom_access_recon_loss: 5004175.0758; train_global_loss: 24085292.4242; train_optim_loss: 24085292.4242; val_kl_reg_loss: 100758.3906; val_edge_recon_loss: 2724900.7188; val_gene_expr_recon_loss: 16188044.8750; val_masked_gp_l1_reg_loss: 156085.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67869.4766; val_chrom_access_recon_loss: 5136019.3750; val_global_loss: 24373679.2500; val_optim_loss: 24373679.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9559; val_auprc_score: 0.9363; val_best_acc_score: 0.9052; val_best_f1_score: 0.9085; train_kl_reg_loss: 104713.0516; train_edge_recon_loss: 2714559.6856; train_gene_expr_recon_loss: 16028133.3182; train_masked_gp_l1_reg_loss: 156083.1996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67755.0948; train_chrom_access_recon_loss: 5003627.9621; train_global_loss: 24074872.4242; train_optim_loss: 24074872.4242; val_kl_reg_loss: 100610.9131; val_edge_recon_loss: 2748655.6562; val_gene_expr_recon_loss: 16183657.0000; val_masked_gp_l1_reg_loss: 156087.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67757.5391; val_chrom_access_recon_loss: 5062995.2500; val_global_loss: 24319765.0000; val_optim_loss: 24319765.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9558; val_auprc_score: 0.9432; val_best_acc_score: 0.9030; val_best_f1_score: 0.9066; train_kl_reg_loss: 104483.2289; train_edge_recon_loss: 2723674.6098; train_gene_expr_recon_loss: 16018933.6364; train_masked_gp_l1_reg_loss: 155917.2064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65866.9654; train_chrom_access_recon_loss: 5000920.3333; train_global_loss: 24069795.8182; train_optim_loss: 24069795.8182; val_kl_reg_loss: 100071.0293; val_edge_recon_loss: 2751400.0625; val_gene_expr_recon_loss: 16011200.8750; val_masked_gp_l1_reg_loss: 155842.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65475.0820; val_chrom_access_recon_loss: 5056840.6250; val_global_loss: 24140830.5000; val_optim_loss: 24140830.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9480; val_auprc_score: 0.9243; val_best_acc_score: 0.8963; val_best_f1_score: 0.9005; train_kl_reg_loss: 104309.1594; train_edge_recon_loss: 2713835.9167; train_gene_expr_recon_loss: 16037088.7879; train_masked_gp_l1_reg_loss: 155816.5800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65417.7981; train_chrom_access_recon_loss: 5006813.6515; train_global_loss: 24083282.0606; train_optim_loss: 24083282.0606; val_kl_reg_loss: 100517.4150; val_edge_recon_loss: 2746761.6250; val_gene_expr_recon_loss: 16182478.2500; val_masked_gp_l1_reg_loss: 155795.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65382.7344; val_chrom_access_recon_loss: 5113102.2500; val_global_loss: 24364037.0000; val_optim_loss: 24364037.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9509; val_auprc_score: 0.9356; val_best_acc_score: 0.8998; val_best_f1_score: 0.9047; train_kl_reg_loss: 104334.6299; train_edge_recon_loss: 2721639.0227; train_gene_expr_recon_loss: 16027718.9697; train_masked_gp_l1_reg_loss: 155785.2327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65357.3747; train_chrom_access_recon_loss: 4998937.8333; train_global_loss: 24073772.9697; train_optim_loss: 24073772.9697; val_kl_reg_loss: 100888.9062; val_edge_recon_loss: 2767710.4375; val_gene_expr_recon_loss: 16227301.8750; val_masked_gp_l1_reg_loss: 155775.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65330.0000; val_chrom_access_recon_loss: 5069528.1875; val_global_loss: 24386536.2500; val_optim_loss: 24386536.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9546; val_auprc_score: 0.9410; val_best_acc_score: 0.9062; val_best_f1_score: 0.9095; train_kl_reg_loss: 104380.7140; train_edge_recon_loss: 2716482.1894; train_gene_expr_recon_loss: 16028594.2273; train_masked_gp_l1_reg_loss: 155769.9197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65315.9904; train_chrom_access_recon_loss: 5002858.4091; train_global_loss: 24073401.5152; train_optim_loss: 24073401.5152; val_kl_reg_loss: 100638.2812; val_edge_recon_loss: 2742827.3750; val_gene_expr_recon_loss: 16196221.6250; val_masked_gp_l1_reg_loss: 155765.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65293.9766; val_chrom_access_recon_loss: 5076864.5625; val_global_loss: 24337611.7500; val_optim_loss: 24337611.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9544; val_auprc_score: 0.9392; val_best_acc_score: 0.9035; val_best_f1_score: 0.9071; train_kl_reg_loss: 104289.1921; train_edge_recon_loss: 2724494.3712; train_gene_expr_recon_loss: 16015702.5909; train_masked_gp_l1_reg_loss: 155761.0919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65275.4226; train_chrom_access_recon_loss: 5005615.5530; train_global_loss: 24071138.1515; train_optim_loss: 24071138.1515; val_kl_reg_loss: 101487.4121; val_edge_recon_loss: 2765165.5625; val_gene_expr_recon_loss: 16023720.0000; val_masked_gp_l1_reg_loss: 155755.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65268.6602; val_chrom_access_recon_loss: 5012137.9375; val_global_loss: 24123535.5000; val_optim_loss: 24123535.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9527; val_auprc_score: 0.9352; val_best_acc_score: 0.9003; val_best_f1_score: 0.9043; train_kl_reg_loss: 104557.5850; train_edge_recon_loss: 2722715.7576; train_gene_expr_recon_loss: 16022310.5000; train_masked_gp_l1_reg_loss: 155753.0753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65243.9201; train_chrom_access_recon_loss: 5003760.1288; train_global_loss: 24074340.9091; train_optim_loss: 24074340.9091; val_kl_reg_loss: 100784.0400; val_edge_recon_loss: 2756437.8750; val_gene_expr_recon_loss: 15964892.0000; val_masked_gp_l1_reg_loss: 155747.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65227.9727; val_chrom_access_recon_loss: 5036494.8750; val_global_loss: 24079584.7500; val_optim_loss: 24079584.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9491; val_auprc_score: 0.9315; val_best_acc_score: 0.8998; val_best_f1_score: 0.9039; train_kl_reg_loss: 104513.0700; train_edge_recon_loss: 2712703.6250; train_gene_expr_recon_loss: 16020575.6364; train_masked_gp_l1_reg_loss: 155748.8359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65226.9155; train_chrom_access_recon_loss: 5002058.6061; train_global_loss: 24060826.3636; train_optim_loss: 24060826.3636; val_kl_reg_loss: 101423.3154; val_edge_recon_loss: 2741443.4375; val_gene_expr_recon_loss: 16137178.6250; val_masked_gp_l1_reg_loss: 155746.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65209.8242; val_chrom_access_recon_loss: 5136163.0000; val_global_loss: 24337164.0000; val_optim_loss: 24337164.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9447; val_auprc_score: 0.9190; val_best_acc_score: 0.8933; val_best_f1_score: 0.8987; train_kl_reg_loss: 104684.3581; train_edge_recon_loss: 2718928.2462; train_gene_expr_recon_loss: 16023660.7424; train_masked_gp_l1_reg_loss: 155744.9171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65198.7451; train_chrom_access_recon_loss: 5002509.7045; train_global_loss: 24070726.6970; train_optim_loss: 24070726.6970; val_kl_reg_loss: 101155.4766; val_edge_recon_loss: 2787232.7812; val_gene_expr_recon_loss: 16111078.6250; val_masked_gp_l1_reg_loss: 155742.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65181.8906; val_chrom_access_recon_loss: 5038269.7500; val_global_loss: 24258661.0000; val_optim_loss: 24258661.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9534; val_auprc_score: 0.9395; val_best_acc_score: 0.9009; val_best_f1_score: 0.9048; train_kl_reg_loss: 104626.4138; train_edge_recon_loss: 2720155.3939; train_gene_expr_recon_loss: 16034554.5152; train_masked_gp_l1_reg_loss: 155744.6075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65182.1379; train_chrom_access_recon_loss: 5002090.2273; train_global_loss: 24082353.3333; train_optim_loss: 24082353.3333; val_kl_reg_loss: 100949.2998; val_edge_recon_loss: 2762198.3125; val_gene_expr_recon_loss: 16101432.7500; val_masked_gp_l1_reg_loss: 155741.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65173.6133; val_chrom_access_recon_loss: 5058055.3750; val_global_loss: 24243551.0000; val_optim_loss: 24243551.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9478; val_auprc_score: 0.9243; val_best_acc_score: 0.8982; val_best_f1_score: 0.9025; train_kl_reg_loss: 104391.2552; train_edge_recon_loss: 2719734.6439; train_gene_expr_recon_loss: 16029842.5303; train_masked_gp_l1_reg_loss: 155740.9252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65150.0698; train_chrom_access_recon_loss: 5000037.8182; train_global_loss: 24074897.3939; train_optim_loss: 24074897.3939; val_kl_reg_loss: 101308.5742; val_edge_recon_loss: 2741606.4062; val_gene_expr_recon_loss: 16245351.2500; val_masked_gp_l1_reg_loss: 155739.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65146.5742; val_chrom_access_recon_loss: 5119187.3750; val_global_loss: 24428339.2500; val_optim_loss: 24428339.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9579; val_auprc_score: 0.9426; val_best_acc_score: 0.9073; val_best_f1_score: 0.9105; train_kl_reg_loss: 104583.8848; train_edge_recon_loss: 2718268.4735; train_gene_expr_recon_loss: 16028476.1970; train_masked_gp_l1_reg_loss: 155721.8634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64956.9590; train_chrom_access_recon_loss: 5002607.2273; train_global_loss: 24074614.5455; train_optim_loss: 24074614.5455; val_kl_reg_loss: 101375.4668; val_edge_recon_loss: 2725841.8750; val_gene_expr_recon_loss: 16133715.6250; val_masked_gp_l1_reg_loss: 155714.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64916.5195; val_chrom_access_recon_loss: 5132118.4375; val_global_loss: 24313682.0000; val_optim_loss: 24313682.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9568; val_auprc_score: 0.9401; val_best_acc_score: 0.9100; val_best_f1_score: 0.9128; train_kl_reg_loss: 104454.9380; train_edge_recon_loss: 2722121.9356; train_gene_expr_recon_loss: 16017362.7121; train_masked_gp_l1_reg_loss: 155712.2415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64912.5449; train_chrom_access_recon_loss: 5003683.2879; train_global_loss: 24068247.6667; train_optim_loss: 24068247.6667; val_kl_reg_loss: 100815.6465; val_edge_recon_loss: 2740980.6250; val_gene_expr_recon_loss: 15986325.8750; val_masked_gp_l1_reg_loss: 155709.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64908.2930; val_chrom_access_recon_loss: 5055370.8125; val_global_loss: 24104111.2500; val_optim_loss: 24104111.2500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9558; val_auprc_score: 0.9424; val_best_acc_score: 0.9052; val_best_f1_score: 0.9076; train_kl_reg_loss: 104515.3801; train_edge_recon_loss: 2715585.9697; train_gene_expr_recon_loss: 16015169.6818; train_masked_gp_l1_reg_loss: 155708.6496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64905.1255; train_chrom_access_recon_loss: 5001741.0833; train_global_loss: 24057625.7576; train_optim_loss: 24057625.7576; val_kl_reg_loss: 101419.4492; val_edge_recon_loss: 2772087.1562; val_gene_expr_recon_loss: 16113096.6250; val_masked_gp_l1_reg_loss: 155707.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64901.8867; val_chrom_access_recon_loss: 5091700.3750; val_global_loss: 24298914.0000; val_optim_loss: 24298914.0000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9567; val_auprc_score: 0.9391; val_best_acc_score: 0.9105; val_best_f1_score: 0.9133; train_kl_reg_loss: 104596.1173; train_edge_recon_loss: 2725353.1705; train_gene_expr_recon_loss: 16036733.2273; train_masked_gp_l1_reg_loss: 155706.6667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64900.2878; train_chrom_access_recon_loss: 5008756.9015; train_global_loss: 24096046.3636; train_optim_loss: 24096046.3636; val_kl_reg_loss: 101476.4209; val_edge_recon_loss: 2735760.7188; val_gene_expr_recon_loss: 16093088.2500; val_masked_gp_l1_reg_loss: 155705.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64897.9258; val_chrom_access_recon_loss: 5062697.3750; val_global_loss: 24213627.0000; val_optim_loss: 24213627.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 23 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9479
val AUPRC score: 0.9278
val best accuracy score: 0.8974
val best F1 score: 0.9017
val target rna MSE score: 1.4546
val source rna MSE score: 0.4107
val target atac MSE score: 0.3307
val source atac MSE score: 0.0728
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
