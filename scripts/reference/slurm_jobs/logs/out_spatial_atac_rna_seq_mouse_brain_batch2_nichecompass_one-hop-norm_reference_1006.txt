[True]
Run timestamp: 10082023_133711_1006.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1006']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7673; val_auprc_score: 0.7856; val_best_acc_score: 0.5178; val_best_f1_score: 0.6738; train_kl_reg_loss: 100799.5931; train_edge_recon_loss: 3581372.9656; train_gene_expr_recon_loss: 14340953.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2184260.4227; train_global_loss: 20207386.1221; train_optim_loss: 20207386.1221; val_kl_reg_loss: 160461.2125; val_edge_recon_loss: 4063903.4000; val_gene_expr_recon_loss: 12886148.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 2079924.5000; val_global_loss: 19190438.1333; val_optim_loss: 19190438.1333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8166; val_auprc_score: 0.8244; val_best_acc_score: 0.7323; val_best_f1_score: 0.7394; train_kl_reg_loss: 122499.3564; train_edge_recon_loss: 3536323.6889; train_gene_expr_recon_loss: 12597159.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2058160.5258; train_global_loss: 18314143.0076; train_optim_loss: 18314143.0076; val_kl_reg_loss: 97544.5568; val_edge_recon_loss: 4030840.7000; val_gene_expr_recon_loss: 12615216.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 2046771.2417; val_global_loss: 18790373.6000; val_optim_loss: 18790373.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8990; val_auprc_score: 0.8924; val_best_acc_score: 0.8246; val_best_f1_score: 0.8336; train_kl_reg_loss: 92111.0533; train_edge_recon_loss: 3462848.1737; train_gene_expr_recon_loss: 12387852.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2032460.7204; train_global_loss: 17975272.5802; train_optim_loss: 17975272.5802; val_kl_reg_loss: 79804.9901; val_edge_recon_loss: 3266407.2167; val_gene_expr_recon_loss: 12476927.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 2028377.4417; val_global_loss: 17851517.0667; val_optim_loss: 17851517.0667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9178; val_auprc_score: 0.9028; val_best_acc_score: 0.8477; val_best_f1_score: 0.8572; train_kl_reg_loss: 117688.9593; train_edge_recon_loss: 2931656.2481; train_gene_expr_recon_loss: 12264625.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2012453.5076; train_global_loss: 17326424.3969; train_optim_loss: 17326424.3969; val_kl_reg_loss: 121244.2422; val_edge_recon_loss: 2898155.3000; val_gene_expr_recon_loss: 12393979.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 2020067.9500; val_global_loss: 17433446.5333; val_optim_loss: 17433446.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9288; val_auprc_score: 0.9146; val_best_acc_score: 0.8649; val_best_f1_score: 0.8726; train_kl_reg_loss: 121705.9934; train_edge_recon_loss: 2840064.5458; train_gene_expr_recon_loss: 12114885.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1991021.8216; train_global_loss: 17067678.1756; train_optim_loss: 17067678.1756; val_kl_reg_loss: 125514.2203; val_edge_recon_loss: 2838414.0000; val_gene_expr_recon_loss: 12222644.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1990295.1917; val_global_loss: 17176867.6667; val_optim_loss: 17176867.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9316; val_auprc_score: 0.9118; val_best_acc_score: 0.8709; val_best_f1_score: 0.8784; train_kl_reg_loss: 113734.9637; train_edge_recon_loss: 2834393.2080; train_gene_expr_recon_loss: 12002381.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1974978.9189; train_global_loss: 16925488.7405; train_optim_loss: 16925488.7405; val_kl_reg_loss: 107655.6589; val_edge_recon_loss: 2834665.9500; val_gene_expr_recon_loss: 12122356.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1973014.2083; val_global_loss: 17037692.0000; val_optim_loss: 17037692.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9332; val_auprc_score: 0.9199; val_best_acc_score: 0.8662; val_best_f1_score: 0.8745; train_kl_reg_loss: 108952.0817; train_edge_recon_loss: 2817914.2347; train_gene_expr_recon_loss: 11889652.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1957653.5792; train_global_loss: 16774171.8855; train_optim_loss: 16774171.8855; val_kl_reg_loss: 101267.8094; val_edge_recon_loss: 2843366.6833; val_gene_expr_recon_loss: 12012976.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1960759.0833; val_global_loss: 16918369.8000; val_optim_loss: 16918369.8000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9363; val_auprc_score: 0.9213; val_best_acc_score: 0.8738; val_best_f1_score: 0.8807; train_kl_reg_loss: 102273.0239; train_edge_recon_loss: 2808556.8531; train_gene_expr_recon_loss: 11801054.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1943820.2471; train_global_loss: 16655704.3740; train_optim_loss: 16655704.3740; val_kl_reg_loss: 96267.3422; val_edge_recon_loss: 2806857.1500; val_gene_expr_recon_loss: 11936617.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1951582.7500; val_global_loss: 16791325.1333; val_optim_loss: 16791325.1333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9329; val_auprc_score: 0.9177; val_best_acc_score: 0.8715; val_best_f1_score: 0.8777; train_kl_reg_loss: 98060.3421; train_edge_recon_loss: 2793128.0019; train_gene_expr_recon_loss: 11724648.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1930909.0124; train_global_loss: 16546745.9924; train_optim_loss: 16546745.9924; val_kl_reg_loss: 95929.4526; val_edge_recon_loss: 2807954.7667; val_gene_expr_recon_loss: 11844080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1943415.2083; val_global_loss: 16691379.4000; val_optim_loss: 16691379.4000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9421; val_auprc_score: 0.9271; val_best_acc_score: 0.8781; val_best_f1_score: 0.8836; train_kl_reg_loss: 94170.1457; train_edge_recon_loss: 2780077.8015; train_gene_expr_recon_loss: 11655907.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1920844.9513; train_global_loss: 16451000.0992; train_optim_loss: 16451000.0992; val_kl_reg_loss: 90897.2089; val_edge_recon_loss: 2790756.1833; val_gene_expr_recon_loss: 11825261.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1935666.1000; val_global_loss: 16642580.7333; val_optim_loss: 16642580.7333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9368; val_auprc_score: 0.9177; val_best_acc_score: 0.8836; val_best_f1_score: 0.8908; train_kl_reg_loss: 89069.8494; train_edge_recon_loss: 2775894.5019; train_gene_expr_recon_loss: 11591311.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1909085.8092; train_global_loss: 16365362.0229; train_optim_loss: 16365362.0229; val_kl_reg_loss: 87335.3427; val_edge_recon_loss: 2782551.2833; val_gene_expr_recon_loss: 11756826.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1922193.1500; val_global_loss: 16548906.3333; val_optim_loss: 16548906.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9481; val_auprc_score: 0.9349; val_best_acc_score: 0.8880; val_best_f1_score: 0.8939; train_kl_reg_loss: 86298.3146; train_edge_recon_loss: 2769794.5821; train_gene_expr_recon_loss: 11536283.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1901328.6031; train_global_loss: 16293704.4580; train_optim_loss: 16293704.4580; val_kl_reg_loss: 83648.2901; val_edge_recon_loss: 2747155.9333; val_gene_expr_recon_loss: 11700829.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1907729.6667; val_global_loss: 16439363.8000; val_optim_loss: 16439363.8000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9448; val_auprc_score: 0.9303; val_best_acc_score: 0.8835; val_best_f1_score: 0.8874; train_kl_reg_loss: 83571.9194; train_edge_recon_loss: 2757241.8626; train_gene_expr_recon_loss: 11472110.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1889580.0267; train_global_loss: 16202503.8168; train_optim_loss: 16202503.8168; val_kl_reg_loss: 81208.1667; val_edge_recon_loss: 2778812.1000; val_gene_expr_recon_loss: 11618879.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1898982.7583; val_global_loss: 16377882.3333; val_optim_loss: 16377882.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9473; val_auprc_score: 0.9305; val_best_acc_score: 0.8910; val_best_f1_score: 0.8951; train_kl_reg_loss: 81352.8322; train_edge_recon_loss: 2748985.4065; train_gene_expr_recon_loss: 11433674.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1884554.6403; train_global_loss: 16148566.9237; train_optim_loss: 16148566.9237; val_kl_reg_loss: 82075.5891; val_edge_recon_loss: 2748555.7667; val_gene_expr_recon_loss: 11633213.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1895216.4833; val_global_loss: 16359061.6667; val_optim_loss: 16359061.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9501; val_auprc_score: 0.9360; val_best_acc_score: 0.8929; val_best_f1_score: 0.8980; train_kl_reg_loss: 78759.4645; train_edge_recon_loss: 2735613.3760; train_gene_expr_recon_loss: 11395691.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1878344.8760; train_global_loss: 16088409.2366; train_optim_loss: 16088409.2366; val_kl_reg_loss: 77060.0229; val_edge_recon_loss: 2722482.0167; val_gene_expr_recon_loss: 11526747.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1879240.7667; val_global_loss: 16205530.4667; val_optim_loss: 16205530.4667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9556; val_auprc_score: 0.9437; val_best_acc_score: 0.8975; val_best_f1_score: 0.9026; train_kl_reg_loss: 78063.0166; train_edge_recon_loss: 2729903.6355; train_gene_expr_recon_loss: 11346532.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1870839.2748; train_global_loss: 16025338.2061; train_optim_loss: 16025338.2061; val_kl_reg_loss: 80811.3859; val_edge_recon_loss: 2716150.1667; val_gene_expr_recon_loss: 11476222.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1882689.8167; val_global_loss: 16155873.6667; val_optim_loss: 16155873.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9592; val_auprc_score: 0.9489; val_best_acc_score: 0.9007; val_best_f1_score: 0.9054; train_kl_reg_loss: 75574.9315; train_edge_recon_loss: 2725866.5439; train_gene_expr_recon_loss: 11311290.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1864224.9418; train_global_loss: 15976957.2061; train_optim_loss: 15976957.2061; val_kl_reg_loss: 74035.0411; val_edge_recon_loss: 2720309.9333; val_gene_expr_recon_loss: 11483047.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1868470.0583; val_global_loss: 16145862.7333; val_optim_loss: 16145862.7333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9601; val_auprc_score: 0.9519; val_best_acc_score: 0.8996; val_best_f1_score: 0.9029; train_kl_reg_loss: 75480.1199; train_edge_recon_loss: 2703045.3664; train_gene_expr_recon_loss: 11274521.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1857708.9695; train_global_loss: 15910755.5954; train_optim_loss: 15910755.5954; val_kl_reg_loss: 72548.5240; val_edge_recon_loss: 2733208.6333; val_gene_expr_recon_loss: 11416662.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1864074.7083; val_global_loss: 16086494.0667; val_optim_loss: 16086494.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9618; val_auprc_score: 0.9475; val_best_acc_score: 0.9077; val_best_f1_score: 0.9114; train_kl_reg_loss: 73433.5618; train_edge_recon_loss: 2701935.0897; train_gene_expr_recon_loss: 11245533.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1853406.0239; train_global_loss: 15874307.9237; train_optim_loss: 15874307.9237; val_kl_reg_loss: 70980.6786; val_edge_recon_loss: 2711624.2500; val_gene_expr_recon_loss: 11444450.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1858197.7083; val_global_loss: 16085252.8000; val_optim_loss: 16085252.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9643; val_auprc_score: 0.9525; val_best_acc_score: 0.9107; val_best_f1_score: 0.9146; train_kl_reg_loss: 73051.9808; train_edge_recon_loss: 2687085.5630; train_gene_expr_recon_loss: 11210974.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1846658.2624; train_global_loss: 15817770.2672; train_optim_loss: 15817770.2672; val_kl_reg_loss: 73759.9021; val_edge_recon_loss: 2698246.9333; val_gene_expr_recon_loss: 11399973.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1861201.2667; val_global_loss: 16033181.2000; val_optim_loss: 16033181.2000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9669; val_auprc_score: 0.9582; val_best_acc_score: 0.9142; val_best_f1_score: 0.9172; train_kl_reg_loss: 71027.4596; train_edge_recon_loss: 2696105.4218; train_gene_expr_recon_loss: 11189818.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1845730.6326; train_global_loss: 15802681.5038; train_optim_loss: 15802681.5038; val_kl_reg_loss: 68937.5552; val_edge_recon_loss: 2708154.9500; val_gene_expr_recon_loss: 11321805.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1854877.2250; val_global_loss: 15953775.6000; val_optim_loss: 15953775.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9710; val_auprc_score: 0.9625; val_best_acc_score: 0.9166; val_best_f1_score: 0.9196; train_kl_reg_loss: 70183.2499; train_edge_recon_loss: 2684605.5305; train_gene_expr_recon_loss: 11163529.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1841745.7042; train_global_loss: 15760064.1450; train_optim_loss: 15760064.1450; val_kl_reg_loss: 70676.0521; val_edge_recon_loss: 2709005.4667; val_gene_expr_recon_loss: 11344442.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1855305.7167; val_global_loss: 15979429.9333; val_optim_loss: 15979429.9333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9675; val_auprc_score: 0.9587; val_best_acc_score: 0.9144; val_best_f1_score: 0.9186; train_kl_reg_loss: 68743.4794; train_edge_recon_loss: 2689981.5496; train_gene_expr_recon_loss: 11137483.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1836514.3731; train_global_loss: 15732723.3511; train_optim_loss: 15732723.3511; val_kl_reg_loss: 70320.8562; val_edge_recon_loss: 2698667.3333; val_gene_expr_recon_loss: 11295923.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1847224.3417; val_global_loss: 15912136.1333; val_optim_loss: 15912136.1333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9696; val_auprc_score: 0.9602; val_best_acc_score: 0.9194; val_best_f1_score: 0.9210; train_kl_reg_loss: 67936.9874; train_edge_recon_loss: 2673475.5821; train_gene_expr_recon_loss: 11116325.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1833072.6288; train_global_loss: 15690810.8702; train_optim_loss: 15690810.8702; val_kl_reg_loss: 68668.5594; val_edge_recon_loss: 2697288.7667; val_gene_expr_recon_loss: 11287069.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1845431.3333; val_global_loss: 15898458.6000; val_optim_loss: 15898458.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9727; val_auprc_score: 0.9617; val_best_acc_score: 0.9245; val_best_f1_score: 0.9257; train_kl_reg_loss: 66485.0361; train_edge_recon_loss: 2677568.5553; train_gene_expr_recon_loss: 11081756.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1830411.4580; train_global_loss: 15656221.5420; train_optim_loss: 15656221.5420; val_kl_reg_loss: 65798.0081; val_edge_recon_loss: 2703342.5667; val_gene_expr_recon_loss: 11264814.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1837180.9583; val_global_loss: 15871136.0667; val_optim_loss: 15871136.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9757; val_auprc_score: 0.9692; val_best_acc_score: 0.9279; val_best_f1_score: 0.9297; train_kl_reg_loss: 66907.8262; train_edge_recon_loss: 2683525.5744; train_gene_expr_recon_loss: 11173885.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1867064.9943; train_global_loss: 15791384.1527; train_optim_loss: 15791384.1527; val_kl_reg_loss: 54252.1120; val_edge_recon_loss: 2698281.1833; val_gene_expr_recon_loss: 11384580.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1876579.4667; val_global_loss: 16013692.8667; val_optim_loss: 16013692.8667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9732; val_auprc_score: 0.9636; val_best_acc_score: 0.9248; val_best_f1_score: 0.9281; train_kl_reg_loss: 64790.9811; train_edge_recon_loss: 2678731.2653; train_gene_expr_recon_loss: 11139664.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1859206.7824; train_global_loss: 15742393.8473; train_optim_loss: 15742393.8473; val_kl_reg_loss: 52781.5555; val_edge_recon_loss: 2695104.5333; val_gene_expr_recon_loss: 11296178.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1864587.1583; val_global_loss: 15908651.6667; val_optim_loss: 15908651.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9769; val_auprc_score: 0.9701; val_best_acc_score: 0.9333; val_best_f1_score: 0.9360; train_kl_reg_loss: 61365.3299; train_edge_recon_loss: 2678632.5305; train_gene_expr_recon_loss: 11128336.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1856941.7405; train_global_loss: 15725275.9924; train_optim_loss: 15725275.9924; val_kl_reg_loss: 54487.2336; val_edge_recon_loss: 2682067.7667; val_gene_expr_recon_loss: 11347294.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1868527.4583; val_global_loss: 15952376.7333; val_optim_loss: 15952376.7333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9784; val_auprc_score: 0.9717; val_best_acc_score: 0.9353; val_best_f1_score: 0.9367; train_kl_reg_loss: 60220.5940; train_edge_recon_loss: 2674358.1527; train_gene_expr_recon_loss: 11103758.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1850327.4055; train_global_loss: 15688664.9466; train_optim_loss: 15688664.9466; val_kl_reg_loss: 51277.4018; val_edge_recon_loss: 2675136.3333; val_gene_expr_recon_loss: 11291879.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1853012.3667; val_global_loss: 15871305.6000; val_optim_loss: 15871305.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9764; val_auprc_score: 0.9695; val_best_acc_score: 0.9298; val_best_f1_score: 0.9322; train_kl_reg_loss: 58874.0168; train_edge_recon_loss: 2669860.7233; train_gene_expr_recon_loss: 11089255.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1852326.7414; train_global_loss: 15670317.4122; train_optim_loss: 15670317.4122; val_kl_reg_loss: 53284.2826; val_edge_recon_loss: 2687242.0667; val_gene_expr_recon_loss: 11272313.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1857226.5250; val_global_loss: 15870066.9333; val_optim_loss: 15870066.9333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9759; val_auprc_score: 0.9701; val_best_acc_score: 0.9301; val_best_f1_score: 0.9320; train_kl_reg_loss: 59668.7321; train_edge_recon_loss: 2663738.6450; train_gene_expr_recon_loss: 11073406.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1850751.5410; train_global_loss: 15647565.1221; train_optim_loss: 15647565.1221; val_kl_reg_loss: 53708.0534; val_edge_recon_loss: 2701781.2667; val_gene_expr_recon_loss: 11300316.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1860720.5167; val_global_loss: 15916525.8000; val_optim_loss: 15916525.8000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9743; val_auprc_score: 0.9632; val_best_acc_score: 0.9320; val_best_f1_score: 0.9336; train_kl_reg_loss: 59821.0397; train_edge_recon_loss: 2660790.1565; train_gene_expr_recon_loss: 11072452.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1848003.2662; train_global_loss: 15641067.0611; train_optim_loss: 15641067.0611; val_kl_reg_loss: 53892.3370; val_edge_recon_loss: 2684610.2500; val_gene_expr_recon_loss: 11265347.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1860230.8417; val_global_loss: 15864081.2667; val_optim_loss: 15864081.2667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9810; val_auprc_score: 0.9761; val_best_acc_score: 0.9395; val_best_f1_score: 0.9406; train_kl_reg_loss: 59812.7398; train_edge_recon_loss: 2663052.3130; train_gene_expr_recon_loss: 11072650.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1849604.6603; train_global_loss: 15645119.7786; train_optim_loss: 15645119.7786; val_kl_reg_loss: 54385.9878; val_edge_recon_loss: 2648192.4167; val_gene_expr_recon_loss: 11288669.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1866685.5917; val_global_loss: 15857933.8000; val_optim_loss: 15857933.8000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9772; val_auprc_score: 0.9693; val_best_acc_score: 0.9363; val_best_f1_score: 0.9381; train_kl_reg_loss: 59725.5267; train_edge_recon_loss: 2662676.7538; train_gene_expr_recon_loss: 11067280.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1846846.4866; train_global_loss: 15636529.6489; train_optim_loss: 15636529.6489; val_kl_reg_loss: 54460.4641; val_edge_recon_loss: 2678344.4167; val_gene_expr_recon_loss: 11308602.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1862091.9667; val_global_loss: 15903499.1333; val_optim_loss: 15903499.1333
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9776; val_auprc_score: 0.9702; val_best_acc_score: 0.9360; val_best_f1_score: 0.9383; train_kl_reg_loss: 59564.5174; train_edge_recon_loss: 2659941.1393; train_gene_expr_recon_loss: 11066772.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1848083.9924; train_global_loss: 15634361.9466; train_optim_loss: 15634361.9466; val_kl_reg_loss: 53862.5318; val_edge_recon_loss: 2690949.7333; val_gene_expr_recon_loss: 11269228.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1858572.3917; val_global_loss: 15872613.0667; val_optim_loss: 15872613.0667
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9756; val_auprc_score: 0.9630; val_best_acc_score: 0.9333; val_best_f1_score: 0.9352; train_kl_reg_loss: 59028.6182; train_edge_recon_loss: 2660073.6050; train_gene_expr_recon_loss: 11065424.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1848936.2166; train_global_loss: 15633463.1832; train_optim_loss: 15633463.1832; val_kl_reg_loss: 54634.0719; val_edge_recon_loss: 2683380.7667; val_gene_expr_recon_loss: 11231506.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1853714.0667; val_global_loss: 15823235.0000; val_optim_loss: 15823235.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9774; val_auprc_score: 0.9682; val_best_acc_score: 0.9337; val_best_f1_score: 0.9359; train_kl_reg_loss: 58899.9707; train_edge_recon_loss: 2663014.3015; train_gene_expr_recon_loss: 11055818.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1846741.8483; train_global_loss: 15624474.2595; train_optim_loss: 15624474.2595; val_kl_reg_loss: 54260.9310; val_edge_recon_loss: 2689288.0000; val_gene_expr_recon_loss: 11287398.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1873551.2583; val_global_loss: 15904499.2667; val_optim_loss: 15904499.2667
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9781; val_auprc_score: 0.9715; val_best_acc_score: 0.9356; val_best_f1_score: 0.9373; train_kl_reg_loss: 58702.6865; train_edge_recon_loss: 2663382.5248; train_gene_expr_recon_loss: 11052178.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1845779.0019; train_global_loss: 15620042.6641; train_optim_loss: 15620042.6641; val_kl_reg_loss: 54331.4271; val_edge_recon_loss: 2671781.6500; val_gene_expr_recon_loss: 11234628.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1860769.9417; val_global_loss: 15821511.2667; val_optim_loss: 15821511.2667
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9792; val_auprc_score: 0.9724; val_best_acc_score: 0.9363; val_best_f1_score: 0.9378; train_kl_reg_loss: 58966.3737; train_edge_recon_loss: 2661299.6431; train_gene_expr_recon_loss: 11060171.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1847869.7662; train_global_loss: 15628307.4046; train_optim_loss: 15628307.4046; val_kl_reg_loss: 54089.3654; val_edge_recon_loss: 2668152.4167; val_gene_expr_recon_loss: 11268067.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1858818.2583; val_global_loss: 15849127.0000; val_optim_loss: 15849127.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9787; val_auprc_score: 0.9719; val_best_acc_score: 0.9402; val_best_f1_score: 0.9419; train_kl_reg_loss: 58080.4422; train_edge_recon_loss: 2667541.0935; train_gene_expr_recon_loss: 11047662.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1845610.9618; train_global_loss: 15618895.3588; train_optim_loss: 15618895.3588; val_kl_reg_loss: 53841.2521; val_edge_recon_loss: 2648982.3333; val_gene_expr_recon_loss: 11226249.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1862217.1500; val_global_loss: 15791289.7333; val_optim_loss: 15791289.7333
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9775; val_auprc_score: 0.9677; val_best_acc_score: 0.9344; val_best_f1_score: 0.9369; train_kl_reg_loss: 57935.6401; train_edge_recon_loss: 2658744.9771; train_gene_expr_recon_loss: 11055522.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1845644.9771; train_global_loss: 15617848.1603; train_optim_loss: 15617848.1603; val_kl_reg_loss: 53825.1138; val_edge_recon_loss: 2674592.8500; val_gene_expr_recon_loss: 11222128.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1856654.1750; val_global_loss: 15807200.4000; val_optim_loss: 15807200.4000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9804; val_auprc_score: 0.9749; val_best_acc_score: 0.9406; val_best_f1_score: 0.9420; train_kl_reg_loss: 57814.2846; train_edge_recon_loss: 2661611.1489; train_gene_expr_recon_loss: 11045488.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1845949.5515; train_global_loss: 15610863.2672; train_optim_loss: 15610863.2672; val_kl_reg_loss: 54309.6911; val_edge_recon_loss: 2667696.2333; val_gene_expr_recon_loss: 11272170.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1862329.4833; val_global_loss: 15856505.5333; val_optim_loss: 15856505.5333
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9801; val_auprc_score: 0.9754; val_best_acc_score: 0.9386; val_best_f1_score: 0.9400; train_kl_reg_loss: 57128.5968; train_edge_recon_loss: 2659828.9065; train_gene_expr_recon_loss: 11039601.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1843979.4427; train_global_loss: 15600538.3893; train_optim_loss: 15600538.3893; val_kl_reg_loss: 53556.1971; val_edge_recon_loss: 2657148.4833; val_gene_expr_recon_loss: 11258373.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1863411.0667; val_global_loss: 15832489.0667; val_optim_loss: 15832489.0667
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9792; val_auprc_score: 0.9723; val_best_acc_score: 0.9426; val_best_f1_score: 0.9440; train_kl_reg_loss: 57407.2814; train_edge_recon_loss: 2658218.0229; train_gene_expr_recon_loss: 11049222.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1845834.0181; train_global_loss: 15610681.5038; train_optim_loss: 15610681.5038; val_kl_reg_loss: 53348.4932; val_edge_recon_loss: 2664975.8833; val_gene_expr_recon_loss: 11209940.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1849978.8833; val_global_loss: 15778244.0667; val_optim_loss: 15778244.0667
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9801; val_auprc_score: 0.9745; val_best_acc_score: 0.9375; val_best_f1_score: 0.9393; train_kl_reg_loss: 57104.5950; train_edge_recon_loss: 2655876.8702; train_gene_expr_recon_loss: 11046482.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1845128.9552; train_global_loss: 15604593.3664; train_optim_loss: 15604593.3664; val_kl_reg_loss: 53026.2622; val_edge_recon_loss: 2659659.7167; val_gene_expr_recon_loss: 11260444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1861500.5500; val_global_loss: 15834630.4667; val_optim_loss: 15834630.4667
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9810; val_auprc_score: 0.9766; val_best_acc_score: 0.9382; val_best_f1_score: 0.9397; train_kl_reg_loss: 56561.1187; train_edge_recon_loss: 2653616.1164; train_gene_expr_recon_loss: 11032800.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1843422.2538; train_global_loss: 15586399.9389; train_optim_loss: 15586399.9389; val_kl_reg_loss: 53759.8107; val_edge_recon_loss: 2675431.4000; val_gene_expr_recon_loss: 11297440.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1863944.7500; val_global_loss: 15890576.1333; val_optim_loss: 15890576.1333
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9814; val_auprc_score: 0.9763; val_best_acc_score: 0.9409; val_best_f1_score: 0.9423; train_kl_reg_loss: 56233.2172; train_edge_recon_loss: 2661408.7710; train_gene_expr_recon_loss: 11045472.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1847328.2443; train_global_loss: 15610443.1069; train_optim_loss: 15610443.1069; val_kl_reg_loss: 53149.7305; val_edge_recon_loss: 2670620.3500; val_gene_expr_recon_loss: 11241355.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1858520.3500; val_global_loss: 15823646.6000; val_optim_loss: 15823646.6000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9812; val_auprc_score: 0.9722; val_best_acc_score: 0.9433; val_best_f1_score: 0.9447; train_kl_reg_loss: 56076.9711; train_edge_recon_loss: 2652688.5382; train_gene_expr_recon_loss: 11027133.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1844117.4466; train_global_loss: 15580016.0305; train_optim_loss: 15580016.0305; val_kl_reg_loss: 53588.0073; val_edge_recon_loss: 2653744.9833; val_gene_expr_recon_loss: 11260636.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1860951.0750; val_global_loss: 15828920.3333; val_optim_loss: 15828920.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9821; val_auprc_score: 0.9759; val_best_acc_score: 0.9429; val_best_f1_score: 0.9443; train_kl_reg_loss: 56465.7121; train_edge_recon_loss: 2657577.0000; train_gene_expr_recon_loss: 11025397.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1842641.8435; train_global_loss: 15582082.5191; train_optim_loss: 15582082.5191; val_kl_reg_loss: 53599.1229; val_edge_recon_loss: 2666238.5667; val_gene_expr_recon_loss: 11275769.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1867368.0917; val_global_loss: 15862975.4000; val_optim_loss: 15862975.4000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9798; val_auprc_score: 0.9726; val_best_acc_score: 0.9433; val_best_f1_score: 0.9447; train_kl_reg_loss: 56169.5511; train_edge_recon_loss: 2647416.1641; train_gene_expr_recon_loss: 11022349.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1842754.4924; train_global_loss: 15568689.3511; train_optim_loss: 15568689.3511; val_kl_reg_loss: 53347.7232; val_edge_recon_loss: 2654413.8833; val_gene_expr_recon_loss: 11268120.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1854338.1250; val_global_loss: 15830220.6000; val_optim_loss: 15830220.6000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9815; val_auprc_score: 0.9737; val_best_acc_score: 0.9419; val_best_f1_score: 0.9433; train_kl_reg_loss: 56087.2861; train_edge_recon_loss: 2657878.6927; train_gene_expr_recon_loss: 11022978.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1842304.7376; train_global_loss: 15579249.6183; train_optim_loss: 15579249.6183; val_kl_reg_loss: 53269.9971; val_edge_recon_loss: 2679452.4667; val_gene_expr_recon_loss: 11227079.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1852444.7250; val_global_loss: 15812246.2667; val_optim_loss: 15812246.2667
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9788; val_auprc_score: 0.9728; val_best_acc_score: 0.9391; val_best_f1_score: 0.9408; train_kl_reg_loss: 55999.2527; train_edge_recon_loss: 2659546.5115; train_gene_expr_recon_loss: 11026036.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1840767.3874; train_global_loss: 15582349.5191; train_optim_loss: 15582349.5191; val_kl_reg_loss: 53302.8633; val_edge_recon_loss: 2692176.6667; val_gene_expr_recon_loss: 11247750.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1855702.2250; val_global_loss: 15848932.3333; val_optim_loss: 15848932.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 86 min 39 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9774
val AUPRC score: 0.9701
val best accuracy score: 0.9376
val best F1 score: 0.9398
val target rna MSE score: 0.7980
val source rna MSE score: 0.1774
val target atac MSE score: 0.5531
val source atac MSE score: 0.1331
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
