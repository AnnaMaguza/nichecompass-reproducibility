[True]
Run timestamp: 01082023_083621_55.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_55']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9084; val_auprc_score: 0.9819; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 120499.4245; train_edge_recon_loss: 117324.4200; train_gene_expr_recon_loss: 5077428.7685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59051.9047; train_global_loss: 5374304.5370; train_optim_loss: 5374304.5370; val_kl_reg_loss: 123303.5885; val_edge_recon_loss: 120820.6797; val_gene_expr_recon_loss: 4429540.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54735.6328; val_global_loss: 4728400.0833; val_optim_loss: 4728400.0833
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8843; val_auprc_score: 0.9783; val_best_acc_score: 0.8584; val_best_f1_score: 0.9238; train_kl_reg_loss: 101789.2595; train_edge_recon_loss: 119068.2565; train_gene_expr_recon_loss: 3950881.3472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51305.7810; train_global_loss: 4223044.6435; train_optim_loss: 4223044.6435; val_kl_reg_loss: 78935.8333; val_edge_recon_loss: 115152.1120; val_gene_expr_recon_loss: 3344650.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48029.0781; val_global_loss: 3586767.5000; val_optim_loss: 3586767.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8561; val_auprc_score: 0.9714; val_best_acc_score: 0.8655; val_best_f1_score: 0.9265; train_kl_reg_loss: 76596.1766; train_edge_recon_loss: 119489.1984; train_gene_expr_recon_loss: 2624005.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45262.1980; train_global_loss: 2865352.8611; train_optim_loss: 2865352.8611; val_kl_reg_loss: 67575.5000; val_edge_recon_loss: 119431.3724; val_gene_expr_recon_loss: 2324319.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42608.4688; val_global_loss: 2553934.4583; val_optim_loss: 2553934.4583
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8392; val_auprc_score: 0.9678; val_best_acc_score: 0.8759; val_best_f1_score: 0.9324; train_kl_reg_loss: 64200.5865; train_edge_recon_loss: 118909.5453; train_gene_expr_recon_loss: 2272370.2269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40508.5881; train_global_loss: 2495988.9444; train_optim_loss: 2495988.9444; val_kl_reg_loss: 56869.4284; val_edge_recon_loss: 114544.5885; val_gene_expr_recon_loss: 2240213.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38573.8672; val_global_loss: 2450200.7917; val_optim_loss: 2450200.7917
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8325; val_auprc_score: 0.9635; val_best_acc_score: 0.8768; val_best_f1_score: 0.9323; train_kl_reg_loss: 54960.8346; train_edge_recon_loss: 118139.9384; train_gene_expr_recon_loss: 2220554.9491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37184.6824; train_global_loss: 2430840.3981; train_optim_loss: 2430840.3981; val_kl_reg_loss: 49401.5326; val_edge_recon_loss: 118221.1016; val_gene_expr_recon_loss: 2208222.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35992.2578; val_global_loss: 2411837.5833; val_optim_loss: 2411837.5833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8414; val_auprc_score: 0.9660; val_best_acc_score: 0.8764; val_best_f1_score: 0.9319; train_kl_reg_loss: 48726.1610; train_edge_recon_loss: 116182.2182; train_gene_expr_recon_loss: 2188342.6713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35334.1693; train_global_loss: 2388585.2222; train_optim_loss: 2388585.2222; val_kl_reg_loss: 44662.5781; val_edge_recon_loss: 118668.5651; val_gene_expr_recon_loss: 2179550.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34885.8555; val_global_loss: 2377767.7917; val_optim_loss: 2377767.7917
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8553; val_auprc_score: 0.9689; val_best_acc_score: 0.8741; val_best_f1_score: 0.9301; train_kl_reg_loss: 44212.1871; train_edge_recon_loss: 115456.7627; train_gene_expr_recon_loss: 2162127.7269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34597.1415; train_global_loss: 2356393.8148; train_optim_loss: 2356393.8148; val_kl_reg_loss: 40806.1204; val_edge_recon_loss: 119538.1966; val_gene_expr_recon_loss: 2156482.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34299.5703; val_global_loss: 2351126.1250; val_optim_loss: 2351126.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8625; val_auprc_score: 0.9707; val_best_acc_score: 0.8761; val_best_f1_score: 0.9314; train_kl_reg_loss: 40779.8268; train_edge_recon_loss: 114121.8125; train_gene_expr_recon_loss: 2139010.8241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34006.0680; train_global_loss: 2327918.5093; train_optim_loss: 2327918.5093; val_kl_reg_loss: 37853.3203; val_edge_recon_loss: 116824.0560; val_gene_expr_recon_loss: 2131099.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33697.3789; val_global_loss: 2319474.5000; val_optim_loss: 2319474.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8774; val_auprc_score: 0.9747; val_best_acc_score: 0.8850; val_best_f1_score: 0.9363; train_kl_reg_loss: 38103.2718; train_edge_recon_loss: 113705.8297; train_gene_expr_recon_loss: 2117057.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33394.1277; train_global_loss: 2302260.3426; train_optim_loss: 2302260.3426; val_kl_reg_loss: 35277.9310; val_edge_recon_loss: 112127.2344; val_gene_expr_recon_loss: 2111997.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33076.3711; val_global_loss: 2292478.4583; val_optim_loss: 2292478.4583
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8861; val_auprc_score: 0.9750; val_best_acc_score: 0.8887; val_best_f1_score: 0.9360; train_kl_reg_loss: 35975.6808; train_edge_recon_loss: 112443.9473; train_gene_expr_recon_loss: 2097516.9560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32768.0254; train_global_loss: 2278704.5926; train_optim_loss: 2278704.5926; val_kl_reg_loss: 33785.4993; val_edge_recon_loss: 115381.0911; val_gene_expr_recon_loss: 2091338.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32447.6172; val_global_loss: 2272952.7500; val_optim_loss: 2272952.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8906; val_auprc_score: 0.9765; val_best_acc_score: 0.8965; val_best_f1_score: 0.9409; train_kl_reg_loss: 34264.4821; train_edge_recon_loss: 111458.5752; train_gene_expr_recon_loss: 2078311.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32138.9051; train_global_loss: 2256173.6389; train_optim_loss: 2256173.6389; val_kl_reg_loss: 32491.8268; val_edge_recon_loss: 111926.4674; val_gene_expr_recon_loss: 2075574.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31819.9023; val_global_loss: 2251812.9583; val_optim_loss: 2251812.9583
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8960; val_auprc_score: 0.9768; val_best_acc_score: 0.9018; val_best_f1_score: 0.9442; train_kl_reg_loss: 32925.3695; train_edge_recon_loss: 110135.8519; train_gene_expr_recon_loss: 2059911.4236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31512.5358; train_global_loss: 2234485.1528; train_optim_loss: 2234485.1528; val_kl_reg_loss: 31330.8945; val_edge_recon_loss: 111314.7682; val_gene_expr_recon_loss: 2055120.5208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31194.5215; val_global_loss: 2228960.6250; val_optim_loss: 2228960.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9092; val_auprc_score: 0.9808; val_best_acc_score: 0.9084; val_best_f1_score: 0.9476; train_kl_reg_loss: 31819.3266; train_edge_recon_loss: 110494.1878; train_gene_expr_recon_loss: 2042482.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30887.0866; train_global_loss: 2215683.1296; train_optim_loss: 2215683.1296; val_kl_reg_loss: 30222.9860; val_edge_recon_loss: 109272.1263; val_gene_expr_recon_loss: 2038207.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30569.4941; val_global_loss: 2208271.8750; val_optim_loss: 2208271.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9107; val_auprc_score: 0.9809; val_best_acc_score: 0.9112; val_best_f1_score: 0.9493; train_kl_reg_loss: 30921.1929; train_edge_recon_loss: 107948.1664; train_gene_expr_recon_loss: 2025785.8287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30261.1960; train_global_loss: 2194916.3843; train_optim_loss: 2194916.3843; val_kl_reg_loss: 29607.5270; val_edge_recon_loss: 108043.6029; val_gene_expr_recon_loss: 2020878.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29940.2168; val_global_loss: 2188470.3750; val_optim_loss: 2188470.3750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9138; val_auprc_score: 0.9812; val_best_acc_score: 0.9127; val_best_f1_score: 0.9501; train_kl_reg_loss: 30074.2501; train_edge_recon_loss: 107472.9495; train_gene_expr_recon_loss: 2010007.0046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29628.5013; train_global_loss: 2177182.6991; train_optim_loss: 2177182.6991; val_kl_reg_loss: 28790.3298; val_edge_recon_loss: 108537.4857; val_gene_expr_recon_loss: 2006333.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29303.7539; val_global_loss: 2172965.0000; val_optim_loss: 2172965.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9091; val_auprc_score: 0.9795; val_best_acc_score: 0.9130; val_best_f1_score: 0.9501; train_kl_reg_loss: 29382.5503; train_edge_recon_loss: 106865.1934; train_gene_expr_recon_loss: 1994328.1852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28990.1371; train_global_loss: 2159566.0509; train_optim_loss: 2159566.0509; val_kl_reg_loss: 28141.8258; val_edge_recon_loss: 110049.2174; val_gene_expr_recon_loss: 1991135.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28663.5137; val_global_loss: 2157990.0000; val_optim_loss: 2157990.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9171; val_auprc_score: 0.9814; val_best_acc_score: 0.9190; val_best_f1_score: 0.9537; train_kl_reg_loss: 28715.1343; train_edge_recon_loss: 106373.5344; train_gene_expr_recon_loss: 1979791.4144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28349.3165; train_global_loss: 2143229.4028; train_optim_loss: 2143229.4028; val_kl_reg_loss: 27443.8258; val_edge_recon_loss: 104310.5065; val_gene_expr_recon_loss: 1975258.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28024.2656; val_global_loss: 2135037.2917; val_optim_loss: 2135037.2917
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9206; val_auprc_score: 0.9827; val_best_acc_score: 0.9206; val_best_f1_score: 0.9546; train_kl_reg_loss: 28104.2219; train_edge_recon_loss: 104637.2773; train_gene_expr_recon_loss: 1965992.8912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27712.0604; train_global_loss: 2126446.4769; train_optim_loss: 2126446.4769; val_kl_reg_loss: 26806.5641; val_edge_recon_loss: 105361.2057; val_gene_expr_recon_loss: 1961913.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27390.0273; val_global_loss: 2121471.2500; val_optim_loss: 2121471.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9196; val_auprc_score: 0.9825; val_best_acc_score: 0.9202; val_best_f1_score: 0.9544; train_kl_reg_loss: 27472.8529; train_edge_recon_loss: 103186.2348; train_gene_expr_recon_loss: 1951960.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27080.1733; train_global_loss: 2109700.0787; train_optim_loss: 2109700.0787; val_kl_reg_loss: 26162.8958; val_edge_recon_loss: 104878.6836; val_gene_expr_recon_loss: 1947161.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26761.1543; val_global_loss: 2104963.8542; val_optim_loss: 2104963.8542
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9168; val_auprc_score: 0.9808; val_best_acc_score: 0.9226; val_best_f1_score: 0.9555; train_kl_reg_loss: 26802.1998; train_edge_recon_loss: 102729.2742; train_gene_expr_recon_loss: 1938759.3148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26455.5613; train_global_loss: 2094746.3356; train_optim_loss: 2094746.3356; val_kl_reg_loss: 25569.8275; val_edge_recon_loss: 105791.8724; val_gene_expr_recon_loss: 1937489.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26139.7363; val_global_loss: 2094990.7708; val_optim_loss: 2094990.7708
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9174; val_auprc_score: 0.9820; val_best_acc_score: 0.9234; val_best_f1_score: 0.9563; train_kl_reg_loss: 26166.8354; train_edge_recon_loss: 102620.7264; train_gene_expr_recon_loss: 1926555.1088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25837.2926; train_global_loss: 2081179.9653; train_optim_loss: 2081179.9653; val_kl_reg_loss: 25011.8216; val_edge_recon_loss: 101706.6341; val_gene_expr_recon_loss: 1924101.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25526.2734; val_global_loss: 2076346.5625; val_optim_loss: 2076346.5625
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9277; val_auprc_score: 0.9838; val_best_acc_score: 0.9279; val_best_f1_score: 0.9586; train_kl_reg_loss: 25634.4272; train_edge_recon_loss: 100342.5657; train_gene_expr_recon_loss: 1914009.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25229.4317; train_global_loss: 2065216.0093; train_optim_loss: 2065216.0093; val_kl_reg_loss: 24628.7038; val_edge_recon_loss: 101915.3086; val_gene_expr_recon_loss: 1910617.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24924.0410; val_global_loss: 2062085.3542; val_optim_loss: 2062085.3542
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9273; val_auprc_score: 0.9844; val_best_acc_score: 0.9274; val_best_f1_score: 0.9584; train_kl_reg_loss: 25138.1719; train_edge_recon_loss: 100345.6165; train_gene_expr_recon_loss: 1902525.5764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24632.1650; train_global_loss: 2052641.5231; train_optim_loss: 2052641.5231; val_kl_reg_loss: 24210.5609; val_edge_recon_loss: 101010.5208; val_gene_expr_recon_loss: 1899273.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24332.0664; val_global_loss: 2048826.8958; val_optim_loss: 2048826.8958
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9298; val_auprc_score: 0.9845; val_best_acc_score: 0.9292; val_best_f1_score: 0.9593; train_kl_reg_loss: 24541.9753; train_edge_recon_loss: 100014.2609; train_gene_expr_recon_loss: 1890827.0880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24046.8915; train_global_loss: 2039430.2083; train_optim_loss: 2039430.2083; val_kl_reg_loss: 23521.4443; val_edge_recon_loss: 101660.4779; val_gene_expr_recon_loss: 1891115.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23754.7285; val_global_loss: 2040051.9583; val_optim_loss: 2040051.9583
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9355; val_auprc_score: 0.9866; val_best_acc_score: 0.9342; val_best_f1_score: 0.9622; train_kl_reg_loss: 24100.5079; train_edge_recon_loss: 99562.8662; train_gene_expr_recon_loss: 1879957.4491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23477.7318; train_global_loss: 2027098.5625; train_optim_loss: 2027098.5625; val_kl_reg_loss: 23036.0000; val_edge_recon_loss: 97637.4844; val_gene_expr_recon_loss: 1877288.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23192.5234; val_global_loss: 2021154.2500; val_optim_loss: 2021154.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9136; val_auprc_score: 0.9805; val_best_acc_score: 0.9087; val_best_f1_score: 0.9472; train_kl_reg_loss: 20325.0687; train_edge_recon_loss: 110586.4180; train_gene_expr_recon_loss: 3529522.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22747.5434; train_global_loss: 3683181.6806; train_optim_loss: 3683181.6806; val_kl_reg_loss: 19662.5146; val_edge_recon_loss: 115033.2839; val_gene_expr_recon_loss: 3077247.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22240.8105; val_global_loss: 3234184.2917; val_optim_loss: 3234184.2917
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9183; val_auprc_score: 0.9816; val_best_acc_score: 0.9186; val_best_f1_score: 0.9534; train_kl_reg_loss: 20678.7148; train_edge_recon_loss: 108411.9427; train_gene_expr_recon_loss: 2807829.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21753.0907; train_global_loss: 2958673.1296; train_optim_loss: 2958673.1296; val_kl_reg_loss: 18681.3825; val_edge_recon_loss: 107505.7279; val_gene_expr_recon_loss: 2608070.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21252.0625; val_global_loss: 2755509.2500; val_optim_loss: 2755509.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9213; val_auprc_score: 0.9832; val_best_acc_score: 0.9244; val_best_f1_score: 0.9568; train_kl_reg_loss: 19393.2534; train_edge_recon_loss: 105158.7251; train_gene_expr_recon_loss: 2454225.8935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20779.0011; train_global_loss: 2599556.8565; train_optim_loss: 2599556.8565; val_kl_reg_loss: 17931.0964; val_edge_recon_loss: 101466.5417; val_gene_expr_recon_loss: 2352031.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20292.8281; val_global_loss: 2491721.8750; val_optim_loss: 2491721.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9258; val_auprc_score: 0.9831; val_best_acc_score: 0.9232; val_best_f1_score: 0.9559; train_kl_reg_loss: 18712.5172; train_edge_recon_loss: 101238.5179; train_gene_expr_recon_loss: 2258908.3009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19833.7032; train_global_loss: 2398693.0417; train_optim_loss: 2398693.0417; val_kl_reg_loss: 17414.6230; val_edge_recon_loss: 101125.4206; val_gene_expr_recon_loss: 2197080.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19362.6211; val_global_loss: 2334982.9167; val_optim_loss: 2334982.9167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9298; val_auprc_score: 0.9854; val_best_acc_score: 0.9282; val_best_f1_score: 0.9588; train_kl_reg_loss: 18313.4759; train_edge_recon_loss: 98239.1034; train_gene_expr_recon_loss: 2184676.3981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19299.7122; train_global_loss: 2320528.6898; train_optim_loss: 2320528.6898; val_kl_reg_loss: 17387.5964; val_edge_recon_loss: 96807.3216; val_gene_expr_recon_loss: 2186140.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19248.4492; val_global_loss: 2319583.4583; val_optim_loss: 2319583.4583
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9259; val_auprc_score: 0.9833; val_best_acc_score: 0.9240; val_best_f1_score: 0.9561; train_kl_reg_loss: 18240.3886; train_edge_recon_loss: 97727.7386; train_gene_expr_recon_loss: 2173935.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19201.8313; train_global_loss: 2309105.9537; train_optim_loss: 2309105.9537; val_kl_reg_loss: 17162.8828; val_edge_recon_loss: 103514.6706; val_gene_expr_recon_loss: 2177496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19153.1641; val_global_loss: 2317326.7917; val_optim_loss: 2317326.7917
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9228; val_auprc_score: 0.9831; val_best_acc_score: 0.9258; val_best_f1_score: 0.9574; train_kl_reg_loss: 18155.6783; train_edge_recon_loss: 98362.4476; train_gene_expr_recon_loss: 2164197.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19105.5462; train_global_loss: 2299821.5324; train_optim_loss: 2299821.5324; val_kl_reg_loss: 17095.5690; val_edge_recon_loss: 99714.5339; val_gene_expr_recon_loss: 2165065.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19055.7578; val_global_loss: 2300931.5417; val_optim_loss: 2300931.5417
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9230; val_auprc_score: 0.9809; val_best_acc_score: 0.9277; val_best_f1_score: 0.9585; train_kl_reg_loss: 18084.5998; train_edge_recon_loss: 98249.8668; train_gene_expr_recon_loss: 2155613.4491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19006.9551; train_global_loss: 2290954.8611; train_optim_loss: 2290954.8611; val_kl_reg_loss: 17083.3118; val_edge_recon_loss: 98112.1615; val_gene_expr_recon_loss: 2161088.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18955.9004; val_global_loss: 2295239.7083; val_optim_loss: 2295239.7083

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 47 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9339
val AUPRC score: 0.9850
val best accuracy score: 0.9314
val best F1 score: 0.9605
val target rna MSE score: 23.4214
val source rna MSE score: 145.0934
Val cat covariate0 mean sim diff: -0.0029

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
