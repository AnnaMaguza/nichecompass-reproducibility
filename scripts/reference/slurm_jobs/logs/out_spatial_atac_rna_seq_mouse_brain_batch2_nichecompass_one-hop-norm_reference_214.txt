[True]
Run timestamp: 10102023_091714_214.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_214']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7454; val_auprc_score: 0.7791; val_best_acc_score: 0.5329; val_best_f1_score: 0.6800; train_kl_reg_loss: 63935.4737; train_edge_recon_loss: 741567.3325; train_gene_expr_recon_loss: 22037512.4733; train_masked_gp_l1_reg_loss: 94799.0015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2406311.5515; train_chrom_access_recon_loss: 6694334.0267; train_global_loss: 32038459.8931; train_optim_loss: 32038459.8931; val_kl_reg_loss: 73802.7630; val_edge_recon_loss: 812697.8583; val_gene_expr_recon_loss: 20930353.6000; val_masked_gp_l1_reg_loss: 75674.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 907353.9375; val_chrom_access_recon_loss: 6488957.0000; val_global_loss: 29288839.0667; val_optim_loss: 29288839.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8813; val_auprc_score: 0.8810; val_best_acc_score: 0.8042; val_best_f1_score: 0.8122; train_kl_reg_loss: 71455.1248; train_edge_recon_loss: 733137.8302; train_gene_expr_recon_loss: 20828291.8015; train_masked_gp_l1_reg_loss: 73760.6381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 490260.9783; train_chrom_access_recon_loss: 6469642.0687; train_global_loss: 28666548.3359; train_optim_loss: 28666548.3359; val_kl_reg_loss: 65455.6529; val_edge_recon_loss: 802285.9333; val_gene_expr_recon_loss: 20659879.8667; val_masked_gp_l1_reg_loss: 74080.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 271948.0625; val_chrom_access_recon_loss: 6396706.6333; val_global_loss: 28270356.0000; val_optim_loss: 28270356.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8948; val_auprc_score: 0.8872; val_best_acc_score: 0.8045; val_best_f1_score: 0.8182; train_kl_reg_loss: 60925.4408; train_edge_recon_loss: 709483.1975; train_gene_expr_recon_loss: 20565783.7710; train_masked_gp_l1_reg_loss: 76585.9773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 206103.5024; train_chrom_access_recon_loss: 6395470.1908; train_global_loss: 28014352.0153; train_optim_loss: 28014352.0153; val_kl_reg_loss: 58134.8268; val_edge_recon_loss: 691023.5500; val_gene_expr_recon_loss: 20348021.6000; val_masked_gp_l1_reg_loss: 79372.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163558.8281; val_chrom_access_recon_loss: 6331151.3667; val_global_loss: 27671261.2000; val_optim_loss: 27671261.2000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9091; val_auprc_score: 0.8987; val_best_acc_score: 0.8257; val_best_f1_score: 0.8320; train_kl_reg_loss: 67862.1143; train_edge_recon_loss: 643306.7223; train_gene_expr_recon_loss: 20314404.4733; train_masked_gp_l1_reg_loss: 81121.1074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142347.4692; train_chrom_access_recon_loss: 6321948.8282; train_global_loss: 27570990.5191; train_optim_loss: 27570990.5191; val_kl_reg_loss: 69559.9156; val_edge_recon_loss: 634004.7458; val_gene_expr_recon_loss: 20096819.7333; val_masked_gp_l1_reg_loss: 83121.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125886.5078; val_chrom_access_recon_loss: 6285781.0667; val_global_loss: 27295173.4667; val_optim_loss: 27295173.4667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9213; val_auprc_score: 0.9070; val_best_acc_score: 0.8425; val_best_f1_score: 0.8508; train_kl_reg_loss: 68808.3998; train_edge_recon_loss: 620212.5978; train_gene_expr_recon_loss: 20138574.2901; train_masked_gp_l1_reg_loss: 84422.1998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115332.5987; train_chrom_access_recon_loss: 6278385.9809; train_global_loss: 27305736.0763; train_optim_loss: 27305736.0763; val_kl_reg_loss: 69535.0802; val_edge_recon_loss: 614502.0583; val_gene_expr_recon_loss: 19905104.8000; val_masked_gp_l1_reg_loss: 85677.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107613.5078; val_chrom_access_recon_loss: 6224129.2667; val_global_loss: 27006563.3333; val_optim_loss: 27006563.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9316; val_auprc_score: 0.9177; val_best_acc_score: 0.8579; val_best_f1_score: 0.8675; train_kl_reg_loss: 67700.9579; train_edge_recon_loss: 609168.7328; train_gene_expr_recon_loss: 19975063.0382; train_masked_gp_l1_reg_loss: 86936.5620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101868.0967; train_chrom_access_recon_loss: 6229347.7366; train_global_loss: 27070085.1450; train_optim_loss: 27070085.1450; val_kl_reg_loss: 65069.2096; val_edge_recon_loss: 610072.9542; val_gene_expr_recon_loss: 19790705.3333; val_masked_gp_l1_reg_loss: 88298.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97170.2812; val_chrom_access_recon_loss: 6188929.5667; val_global_loss: 26840245.2000; val_optim_loss: 26840245.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9414; val_auprc_score: 0.9289; val_best_acc_score: 0.8748; val_best_f1_score: 0.8812; train_kl_reg_loss: 66205.7472; train_edge_recon_loss: 604371.4857; train_gene_expr_recon_loss: 19826117.6183; train_masked_gp_l1_reg_loss: 89065.6626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93268.9430; train_chrom_access_recon_loss: 6182033.3969; train_global_loss: 26861062.8855; train_optim_loss: 26861062.8855; val_kl_reg_loss: 65602.3966; val_edge_recon_loss: 606011.8167; val_gene_expr_recon_loss: 19757770.5333; val_masked_gp_l1_reg_loss: 90176.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89664.6719; val_chrom_access_recon_loss: 6182324.7000; val_global_loss: 26791549.3333; val_optim_loss: 26791549.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9491; val_auprc_score: 0.9390; val_best_acc_score: 0.8821; val_best_f1_score: 0.8879; train_kl_reg_loss: 65116.9803; train_edge_recon_loss: 597698.9280; train_gene_expr_recon_loss: 19733759.2214; train_masked_gp_l1_reg_loss: 90778.4011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86809.7994; train_chrom_access_recon_loss: 6157191.3015; train_global_loss: 26731354.7634; train_optim_loss: 26731354.7634; val_kl_reg_loss: 63773.6581; val_edge_recon_loss: 598524.7375; val_gene_expr_recon_loss: 19644607.7333; val_masked_gp_l1_reg_loss: 91741.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85038.2422; val_chrom_access_recon_loss: 6129768.8000; val_global_loss: 26613454.9333; val_optim_loss: 26613454.9333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9487; val_auprc_score: 0.9358; val_best_acc_score: 0.8851; val_best_f1_score: 0.8896; train_kl_reg_loss: 64216.1341; train_edge_recon_loss: 592874.4346; train_gene_expr_recon_loss: 19610849.1145; train_masked_gp_l1_reg_loss: 92239.0251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82435.0236; train_chrom_access_recon_loss: 6113241.2634; train_global_loss: 26555855.0076; train_optim_loss: 26555855.0076; val_kl_reg_loss: 61589.1469; val_edge_recon_loss: 598347.9208; val_gene_expr_recon_loss: 19545299.7333; val_masked_gp_l1_reg_loss: 92918.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80275.6875; val_chrom_access_recon_loss: 6125158.4667; val_global_loss: 26503589.4667; val_optim_loss: 26503589.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9523; val_auprc_score: 0.9404; val_best_acc_score: 0.8906; val_best_f1_score: 0.8957; train_kl_reg_loss: 63007.8231; train_edge_recon_loss: 590447.4986; train_gene_expr_recon_loss: 19509913.5725; train_masked_gp_l1_reg_loss: 93523.9320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79130.5162; train_chrom_access_recon_loss: 6081392.2023; train_global_loss: 26417415.5420; train_optim_loss: 26417415.5420; val_kl_reg_loss: 63577.9104; val_edge_recon_loss: 591929.5000; val_gene_expr_recon_loss: 19402314.8000; val_masked_gp_l1_reg_loss: 94255.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77817.5391; val_chrom_access_recon_loss: 6035739.4333; val_global_loss: 26265635.7333; val_optim_loss: 26265635.7333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9548; val_auprc_score: 0.9433; val_best_acc_score: 0.8948; val_best_f1_score: 0.8996; train_kl_reg_loss: 62411.5194; train_edge_recon_loss: 587347.4389; train_gene_expr_recon_loss: 19413818.2748; train_masked_gp_l1_reg_loss: 94584.1427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76804.8774; train_chrom_access_recon_loss: 6051696.2557; train_global_loss: 26286662.4885; train_optim_loss: 26286662.4885; val_kl_reg_loss: 61375.6042; val_edge_recon_loss: 589980.2208; val_gene_expr_recon_loss: 19394590.1333; val_masked_gp_l1_reg_loss: 95153.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76220.8906; val_chrom_access_recon_loss: 6041072.3667; val_global_loss: 26258392.2667; val_optim_loss: 26258392.2667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9582; val_auprc_score: 0.9465; val_best_acc_score: 0.9018; val_best_f1_score: 0.9052; train_kl_reg_loss: 61450.1159; train_edge_recon_loss: 584679.2085; train_gene_expr_recon_loss: 19330884.4275; train_masked_gp_l1_reg_loss: 95841.8600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75444.4946; train_chrom_access_recon_loss: 6022799.0878; train_global_loss: 26171099.2672; train_optim_loss: 26171099.2672; val_kl_reg_loss: 59920.6844; val_edge_recon_loss: 584555.5667; val_gene_expr_recon_loss: 19237088.6667; val_masked_gp_l1_reg_loss: 96441.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74738.0703; val_chrom_access_recon_loss: 6008616.8667; val_global_loss: 26061361.7333; val_optim_loss: 26061361.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9611; val_auprc_score: 0.9475; val_best_acc_score: 0.9070; val_best_f1_score: 0.9102; train_kl_reg_loss: 60739.5877; train_edge_recon_loss: 583122.6417; train_gene_expr_recon_loss: 19251749.4809; train_masked_gp_l1_reg_loss: 96965.7224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74381.5032; train_chrom_access_recon_loss: 5989078.6756; train_global_loss: 26056037.7863; train_optim_loss: 26056037.7863; val_kl_reg_loss: 60134.8393; val_edge_recon_loss: 583736.0417; val_gene_expr_recon_loss: 19185801.0667; val_masked_gp_l1_reg_loss: 97748.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74039.2344; val_chrom_access_recon_loss: 5989394.6000; val_global_loss: 25990854.6667; val_optim_loss: 25990854.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9624; val_auprc_score: 0.9513; val_best_acc_score: 0.9092; val_best_f1_score: 0.9113; train_kl_reg_loss: 60156.8692; train_edge_recon_loss: 581497.8240; train_gene_expr_recon_loss: 19171116.9924; train_masked_gp_l1_reg_loss: 98323.6410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73785.1261; train_chrom_access_recon_loss: 5957715.3511; train_global_loss: 25942595.8473; train_optim_loss: 25942595.8473; val_kl_reg_loss: 60276.0167; val_edge_recon_loss: 581495.8542; val_gene_expr_recon_loss: 19073830.8000; val_masked_gp_l1_reg_loss: 98883.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73585.5859; val_chrom_access_recon_loss: 5944731.7667; val_global_loss: 25832804.0000; val_optim_loss: 25832804.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9633; val_auprc_score: 0.9517; val_best_acc_score: 0.9099; val_best_f1_score: 0.9120; train_kl_reg_loss: 59477.5259; train_edge_recon_loss: 581148.7538; train_gene_expr_recon_loss: 19090141.0076; train_masked_gp_l1_reg_loss: 99815.1129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73221.1154; train_chrom_access_recon_loss: 5926067.1374; train_global_loss: 25829870.5191; train_optim_loss: 25829870.5191; val_kl_reg_loss: 59320.5786; val_edge_recon_loss: 584718.0750; val_gene_expr_recon_loss: 19022257.3333; val_masked_gp_l1_reg_loss: 101017.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73587.0469; val_chrom_access_recon_loss: 5945728.7333; val_global_loss: 25786630.5333; val_optim_loss: 25786630.5333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9630; val_auprc_score: 0.9520; val_best_acc_score: 0.9100; val_best_f1_score: 0.9133; train_kl_reg_loss: 58863.2058; train_edge_recon_loss: 580620.7557; train_gene_expr_recon_loss: 19012042.6107; train_masked_gp_l1_reg_loss: 101499.7594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73040.1561; train_chrom_access_recon_loss: 5900988.0344; train_global_loss: 25727054.5191; train_optim_loss: 25727054.5191; val_kl_reg_loss: 58890.4221; val_edge_recon_loss: 582351.7250; val_gene_expr_recon_loss: 18981289.4667; val_masked_gp_l1_reg_loss: 102622.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73578.0781; val_chrom_access_recon_loss: 5894157.3333; val_global_loss: 25692889.0667; val_optim_loss: 25692889.0667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9645; val_auprc_score: 0.9562; val_best_acc_score: 0.9076; val_best_f1_score: 0.9116; train_kl_reg_loss: 58337.2487; train_edge_recon_loss: 578780.7266; train_gene_expr_recon_loss: 18929193.0534; train_masked_gp_l1_reg_loss: 103449.3149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72878.4132; train_chrom_access_recon_loss: 5870921.3893; train_global_loss: 25613560.3511; train_optim_loss: 25613560.3511; val_kl_reg_loss: 57806.4958; val_edge_recon_loss: 582246.1833; val_gene_expr_recon_loss: 18989960.8000; val_masked_gp_l1_reg_loss: 104381.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73351.6172; val_chrom_access_recon_loss: 5896029.5000; val_global_loss: 25703777.0667; val_optim_loss: 25703777.0667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9668; val_auprc_score: 0.9575; val_best_acc_score: 0.9170; val_best_f1_score: 0.9194; train_kl_reg_loss: 57977.8144; train_edge_recon_loss: 578339.0253; train_gene_expr_recon_loss: 18870319.1145; train_masked_gp_l1_reg_loss: 105425.7846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72950.7202; train_chrom_access_recon_loss: 5853656.3282; train_global_loss: 25538668.7634; train_optim_loss: 25538668.7634; val_kl_reg_loss: 58103.7768; val_edge_recon_loss: 577093.5292; val_gene_expr_recon_loss: 18904752.0000; val_masked_gp_l1_reg_loss: 106527.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72863.3750; val_chrom_access_recon_loss: 5892123.6333; val_global_loss: 25611464.5333; val_optim_loss: 25611464.5333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9634; val_auprc_score: 0.9517; val_best_acc_score: 0.9112; val_best_f1_score: 0.9154; train_kl_reg_loss: 57541.6681; train_edge_recon_loss: 578749.3931; train_gene_expr_recon_loss: 18784146.8855; train_masked_gp_l1_reg_loss: 107509.5562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72691.0197; train_chrom_access_recon_loss: 5820272.9504; train_global_loss: 25420911.2672; train_optim_loss: 25420911.2672; val_kl_reg_loss: 58094.0206; val_edge_recon_loss: 577915.8667; val_gene_expr_recon_loss: 18777832.6667; val_masked_gp_l1_reg_loss: 108842.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73338.3281; val_chrom_access_recon_loss: 5855644.0333; val_global_loss: 25451666.5333; val_optim_loss: 25451666.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9668; val_auprc_score: 0.9542; val_best_acc_score: 0.9170; val_best_f1_score: 0.9202; train_kl_reg_loss: 57468.7404; train_edge_recon_loss: 577398.4399; train_gene_expr_recon_loss: 18713448.1985; train_masked_gp_l1_reg_loss: 109644.8721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72902.9028; train_chrom_access_recon_loss: 5793760.0458; train_global_loss: 25324623.2366; train_optim_loss: 25324623.2366; val_kl_reg_loss: 57199.5565; val_edge_recon_loss: 578765.8042; val_gene_expr_recon_loss: 18747753.7333; val_masked_gp_l1_reg_loss: 110543.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73281.6172; val_chrom_access_recon_loss: 5848215.7000; val_global_loss: 25415761.0667; val_optim_loss: 25415761.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9650; val_auprc_score: 0.9514; val_best_acc_score: 0.9174; val_best_f1_score: 0.9200; train_kl_reg_loss: 57526.2204; train_edge_recon_loss: 578403.9070; train_gene_expr_recon_loss: 18652536.2443; train_masked_gp_l1_reg_loss: 111321.4156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73003.8887; train_chrom_access_recon_loss: 5782167.1260; train_global_loss: 25254958.8244; train_optim_loss: 25254958.8244; val_kl_reg_loss: 56979.8701; val_edge_recon_loss: 578193.7083; val_gene_expr_recon_loss: 18652478.1333; val_masked_gp_l1_reg_loss: 112435.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73707.7891; val_chrom_access_recon_loss: 5810136.7667; val_global_loss: 25283932.5333; val_optim_loss: 25283932.5333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9637; val_auprc_score: 0.9538; val_best_acc_score: 0.9151; val_best_f1_score: 0.9187; train_kl_reg_loss: 57949.7227; train_edge_recon_loss: 577216.7333; train_gene_expr_recon_loss: 18572768.2137; train_masked_gp_l1_reg_loss: 113016.8195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73246.1551; train_chrom_access_recon_loss: 5756636.7748; train_global_loss: 25150834.4275; train_optim_loss: 25150834.4275; val_kl_reg_loss: 58000.7924; val_edge_recon_loss: 578987.2833; val_gene_expr_recon_loss: 18571930.4000; val_masked_gp_l1_reg_loss: 113546.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73203.3438; val_chrom_access_recon_loss: 5780085.0667; val_global_loss: 25175753.0667; val_optim_loss: 25175753.0667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9632; val_auprc_score: 0.9537; val_best_acc_score: 0.9103; val_best_f1_score: 0.9147; train_kl_reg_loss: 58580.2784; train_edge_recon_loss: 577534.9113; train_gene_expr_recon_loss: 18503027.3740; train_masked_gp_l1_reg_loss: 113979.9393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72967.1730; train_chrom_access_recon_loss: 5729887.8626; train_global_loss: 25055977.5725; train_optim_loss: 25055977.5725; val_kl_reg_loss: 58333.1289; val_edge_recon_loss: 579585.9000; val_gene_expr_recon_loss: 18445227.6000; val_masked_gp_l1_reg_loss: 114659.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73397.8750; val_chrom_access_recon_loss: 5732003.7333; val_global_loss: 25003208.1333; val_optim_loss: 25003208.1333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9652; val_auprc_score: 0.9553; val_best_acc_score: 0.9154; val_best_f1_score: 0.9182; train_kl_reg_loss: 58999.4626; train_edge_recon_loss: 576068.2953; train_gene_expr_recon_loss: 18458171.2366; train_masked_gp_l1_reg_loss: 115347.9252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73356.6486; train_chrom_access_recon_loss: 5716705.8702; train_global_loss: 24998649.3435; train_optim_loss: 24998649.3435; val_kl_reg_loss: 58117.1448; val_edge_recon_loss: 585032.1917; val_gene_expr_recon_loss: 18591860.1333; val_masked_gp_l1_reg_loss: 115864.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73710.8516; val_chrom_access_recon_loss: 5766376.2000; val_global_loss: 25190960.0000; val_optim_loss: 25190960.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9621; val_auprc_score: 0.9518; val_best_acc_score: 0.9126; val_best_f1_score: 0.9164; train_kl_reg_loss: 59523.5734; train_edge_recon_loss: 578683.6469; train_gene_expr_recon_loss: 18404628.8397; train_masked_gp_l1_reg_loss: 116221.9244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73652.9027; train_chrom_access_recon_loss: 5695076.8588; train_global_loss: 24927787.7405; train_optim_loss: 24927787.7405; val_kl_reg_loss: 59588.2013; val_edge_recon_loss: 583223.3208; val_gene_expr_recon_loss: 18458313.0667; val_masked_gp_l1_reg_loss: 116767.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73648.1562; val_chrom_access_recon_loss: 5723728.2333; val_global_loss: 25015268.8000; val_optim_loss: 25015268.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9495; val_auprc_score: 0.9406; val_best_acc_score: 0.8839; val_best_f1_score: 0.8900; train_kl_reg_loss: 53675.5318; train_edge_recon_loss: 629011.0582; train_gene_expr_recon_loss: 17973986.0534; train_masked_gp_l1_reg_loss: 114535.1805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63895.4886; train_chrom_access_recon_loss: 5691614.1450; train_global_loss: 24526717.5420; train_optim_loss: 24526717.5420; val_kl_reg_loss: 35054.4711; val_edge_recon_loss: 609281.2083; val_gene_expr_recon_loss: 17941498.5333; val_masked_gp_l1_reg_loss: 112730.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60982.6016; val_chrom_access_recon_loss: 5672802.4000; val_global_loss: 24432348.6667; val_optim_loss: 24432348.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9434; val_auprc_score: 0.9260; val_best_acc_score: 0.8839; val_best_f1_score: 0.8898; train_kl_reg_loss: 54326.8873; train_edge_recon_loss: 593281.3802; train_gene_expr_recon_loss: 17849925.9466; train_masked_gp_l1_reg_loss: 111969.4280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61317.3488; train_chrom_access_recon_loss: 5676368.4618; train_global_loss: 24347189.6794; train_optim_loss: 24347189.6794; val_kl_reg_loss: 41418.0018; val_edge_recon_loss: 595062.2083; val_gene_expr_recon_loss: 17852230.0000; val_masked_gp_l1_reg_loss: 111175.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61332.1211; val_chrom_access_recon_loss: 5687650.8333; val_global_loss: 24348869.3333; val_optim_loss: 24348869.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9555; val_auprc_score: 0.9434; val_best_acc_score: 0.8995; val_best_f1_score: 0.9040; train_kl_reg_loss: 53531.1720; train_edge_recon_loss: 587110.7462; train_gene_expr_recon_loss: 17762088.7786; train_masked_gp_l1_reg_loss: 110573.4150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61532.5904; train_chrom_access_recon_loss: 5648467.1565; train_global_loss: 24223304.0305; train_optim_loss: 24223304.0305; val_kl_reg_loss: 43917.7875; val_edge_recon_loss: 582134.0750; val_gene_expr_recon_loss: 17744733.2667; val_masked_gp_l1_reg_loss: 109860.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61356.0703; val_chrom_access_recon_loss: 5641149.8333; val_global_loss: 24183151.0667; val_optim_loss: 24183151.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9538; val_auprc_score: 0.9407; val_best_acc_score: 0.8980; val_best_f1_score: 0.9020; train_kl_reg_loss: 53125.0232; train_edge_recon_loss: 583502.6555; train_gene_expr_recon_loss: 17715042.6107; train_masked_gp_l1_reg_loss: 109552.1375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61774.2232; train_chrom_access_recon_loss: 5648601.4618; train_global_loss: 24171598.1374; train_optim_loss: 24171598.1374; val_kl_reg_loss: 44779.4651; val_edge_recon_loss: 584456.9958; val_gene_expr_recon_loss: 17737084.1333; val_masked_gp_l1_reg_loss: 108997.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61137.1211; val_chrom_access_recon_loss: 5644442.5667; val_global_loss: 24180899.3333; val_optim_loss: 24180899.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9571; val_auprc_score: 0.9466; val_best_acc_score: 0.8994; val_best_f1_score: 0.9048; train_kl_reg_loss: 53105.0321; train_edge_recon_loss: 581926.6718; train_gene_expr_recon_loss: 17653813.9466; train_masked_gp_l1_reg_loss: 108746.0245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61232.9278; train_chrom_access_recon_loss: 5635079.6183; train_global_loss: 24093903.9847; train_optim_loss: 24093903.9847; val_kl_reg_loss: 45903.6854; val_edge_recon_loss: 583705.1125; val_gene_expr_recon_loss: 17715905.6000; val_masked_gp_l1_reg_loss: 108501.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61251.5352; val_chrom_access_recon_loss: 5637329.0000; val_global_loss: 24152597.6000; val_optim_loss: 24152597.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9576; val_auprc_score: 0.9457; val_best_acc_score: 0.8984; val_best_f1_score: 0.9034; train_kl_reg_loss: 53189.0425; train_edge_recon_loss: 578801.3354; train_gene_expr_recon_loss: 17612461.1603; train_masked_gp_l1_reg_loss: 108205.9123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61325.5223; train_chrom_access_recon_loss: 5621653.9847; train_global_loss: 24035637.0840; train_optim_loss: 24035637.0840; val_kl_reg_loss: 47388.8901; val_edge_recon_loss: 581227.6708; val_gene_expr_recon_loss: 17709334.3333; val_masked_gp_l1_reg_loss: 107963.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61555.5586; val_chrom_access_recon_loss: 5623186.4333; val_global_loss: 24130657.3333; val_optim_loss: 24130657.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9544; val_auprc_score: 0.9391; val_best_acc_score: 0.9039; val_best_f1_score: 0.9086; train_kl_reg_loss: 53320.0626; train_edge_recon_loss: 578370.6307; train_gene_expr_recon_loss: 17588820.0916; train_masked_gp_l1_reg_loss: 107793.3306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61715.7475; train_chrom_access_recon_loss: 5622337.3893; train_global_loss: 24012357.4962; train_optim_loss: 24012357.4962; val_kl_reg_loss: 49111.5268; val_edge_recon_loss: 581545.7500; val_gene_expr_recon_loss: 17761305.7333; val_masked_gp_l1_reg_loss: 107627.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61647.0508; val_chrom_access_recon_loss: 5682222.0000; val_global_loss: 24243461.4667; val_optim_loss: 24243461.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9574; val_auprc_score: 0.9422; val_best_acc_score: 0.9065; val_best_f1_score: 0.9100; train_kl_reg_loss: 53356.4321; train_edge_recon_loss: 577224.0305; train_gene_expr_recon_loss: 17545162.5115; train_masked_gp_l1_reg_loss: 107421.1125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61658.7473; train_chrom_access_recon_loss: 5616437.3435; train_global_loss: 23961260.0763; train_optim_loss: 23961260.0763; val_kl_reg_loss: 48220.2695; val_edge_recon_loss: 580501.8917; val_gene_expr_recon_loss: 17671014.8000; val_masked_gp_l1_reg_loss: 107243.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62536.7734; val_chrom_access_recon_loss: 5641391.4000; val_global_loss: 24110908.4000; val_optim_loss: 24110908.4000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9579; val_auprc_score: 0.9431; val_best_acc_score: 0.9065; val_best_f1_score: 0.9103; train_kl_reg_loss: 54137.6843; train_edge_recon_loss: 575638.9585; train_gene_expr_recon_loss: 17527863.7634; train_masked_gp_l1_reg_loss: 106848.4624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61894.8239; train_chrom_access_recon_loss: 5619072.8244; train_global_loss: 23945456.6260; train_optim_loss: 23945456.6260; val_kl_reg_loss: 49925.1794; val_edge_recon_loss: 576693.1875; val_gene_expr_recon_loss: 17666254.5333; val_masked_gp_l1_reg_loss: 106421.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62140.0742; val_chrom_access_recon_loss: 5622345.0667; val_global_loss: 24083780.1333; val_optim_loss: 24083780.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9554; val_auprc_score: 0.9420; val_best_acc_score: 0.9053; val_best_f1_score: 0.9088; train_kl_reg_loss: 54766.7854; train_edge_recon_loss: 576637.3850; train_gene_expr_recon_loss: 17489102.7099; train_masked_gp_l1_reg_loss: 106093.4623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61999.8688; train_chrom_access_recon_loss: 5608567.6565; train_global_loss: 23897167.8321; train_optim_loss: 23897167.8321; val_kl_reg_loss: 51059.2750; val_edge_recon_loss: 577569.3542; val_gene_expr_recon_loss: 17644896.9333; val_masked_gp_l1_reg_loss: 105797.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61992.2031; val_chrom_access_recon_loss: 5601373.7333; val_global_loss: 24042689.2000; val_optim_loss: 24042689.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9566; val_auprc_score: 0.9431; val_best_acc_score: 0.9081; val_best_f1_score: 0.9115; train_kl_reg_loss: 54773.9173; train_edge_recon_loss: 574898.0224; train_gene_expr_recon_loss: 17467332.8244; train_masked_gp_l1_reg_loss: 105830.3571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61997.4235; train_chrom_access_recon_loss: 5612887.9427; train_global_loss: 23877720.7481; train_optim_loss: 23877720.7481; val_kl_reg_loss: 51086.7888; val_edge_recon_loss: 577571.9458; val_gene_expr_recon_loss: 17541956.8667; val_masked_gp_l1_reg_loss: 105734.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62125.7461; val_chrom_access_recon_loss: 5594837.0667; val_global_loss: 23933312.9333; val_optim_loss: 23933312.9333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9584; val_auprc_score: 0.9437; val_best_acc_score: 0.9066; val_best_f1_score: 0.9105; train_kl_reg_loss: 54345.2295; train_edge_recon_loss: 575722.6765; train_gene_expr_recon_loss: 17437124.7328; train_masked_gp_l1_reg_loss: 105712.2952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62007.4641; train_chrom_access_recon_loss: 5601057.9771; train_global_loss: 23835970.3664; train_optim_loss: 23835970.3664; val_kl_reg_loss: 50850.5023; val_edge_recon_loss: 580512.2958; val_gene_expr_recon_loss: 17622224.8000; val_masked_gp_l1_reg_loss: 105658.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62296.3164; val_chrom_access_recon_loss: 5616053.6667; val_global_loss: 24037595.2000; val_optim_loss: 24037595.2000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9534; val_auprc_score: 0.9388; val_best_acc_score: 0.9006; val_best_f1_score: 0.9036; train_kl_reg_loss: 217617560.3397; train_edge_recon_loss: 586148.8302; train_gene_expr_recon_loss: 17629650.4656; train_masked_gp_l1_reg_loss: 105723.5085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62244.9853; train_chrom_access_recon_loss: 5623922.0649; train_global_loss: 241625260.1679; train_optim_loss: 241625260.1679; val_kl_reg_loss: 45438.1086; val_edge_recon_loss: 598117.0625; val_gene_expr_recon_loss: 17796300.0667; val_masked_gp_l1_reg_loss: 103525.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62435.5820; val_chrom_access_recon_loss: 5619678.4667; val_global_loss: 24225496.1333; val_optim_loss: 24225496.1333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9552; val_auprc_score: 0.9406; val_best_acc_score: 0.8981; val_best_f1_score: 0.9031; train_kl_reg_loss: 53203.8426; train_edge_recon_loss: 581674.1469; train_gene_expr_recon_loss: 17685985.1221; train_masked_gp_l1_reg_loss: 101079.4597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62090.8489; train_chrom_access_recon_loss: 5617393.5573; train_global_loss: 24101427.1145; train_optim_loss: 24101427.1145; val_kl_reg_loss: 692589.4133; val_edge_recon_loss: 595071.8417; val_gene_expr_recon_loss: 17795605.8667; val_masked_gp_l1_reg_loss: 100331.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61929.7305; val_chrom_access_recon_loss: 5632181.9667; val_global_loss: 24877710.5333; val_optim_loss: 24877710.5333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9544; val_auprc_score: 0.9427; val_best_acc_score: 0.8957; val_best_f1_score: 0.9005; train_kl_reg_loss: 26503215.4286; train_edge_recon_loss: 599055.0386; train_gene_expr_recon_loss: 17883453.6794; train_masked_gp_l1_reg_loss: 96859.2780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61697.3808; train_chrom_access_recon_loss: 5662081.3130; train_global_loss: 50806363.6947; train_optim_loss: 50806363.6947; val_kl_reg_loss: 59186.7669; val_edge_recon_loss: 607953.3417; val_gene_expr_recon_loss: 18012666.2667; val_masked_gp_l1_reg_loss: 92733.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60654.9648; val_chrom_access_recon_loss: 5648808.3000; val_global_loss: 24482002.8000; val_optim_loss: 24482002.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9554; val_auprc_score: 0.9381; val_best_acc_score: 0.9041; val_best_f1_score: 0.9085; train_kl_reg_loss: 111089411.9962; train_edge_recon_loss: 594055.8783; train_gene_expr_recon_loss: 17820526.8702; train_masked_gp_l1_reg_loss: 89860.2733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51429.4637; train_chrom_access_recon_loss: 5632083.7710; train_global_loss: 135277364.0000; train_optim_loss: 135277364.0000; val_kl_reg_loss: 57591.6070; val_edge_recon_loss: 588061.0000; val_gene_expr_recon_loss: 17846378.1333; val_masked_gp_l1_reg_loss: 88695.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49918.2812; val_chrom_access_recon_loss: 5651760.6667; val_global_loss: 24282405.4667; val_optim_loss: 24282405.4667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9559; val_auprc_score: 0.9412; val_best_acc_score: 0.9034; val_best_f1_score: 0.9073; train_kl_reg_loss: 62891.4957; train_edge_recon_loss: 586977.3531; train_gene_expr_recon_loss: 17716932.1298; train_masked_gp_l1_reg_loss: 88377.4072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49482.0660; train_chrom_access_recon_loss: 5616568.2901; train_global_loss: 24121228.8855; train_optim_loss: 24121228.8855; val_kl_reg_loss: 61429.1917; val_edge_recon_loss: 586346.4750; val_gene_expr_recon_loss: 17742942.1333; val_masked_gp_l1_reg_loss: 88097.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48999.1484; val_chrom_access_recon_loss: 5632197.8000; val_global_loss: 24160013.6000; val_optim_loss: 24160013.6000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9531; val_auprc_score: 0.9366; val_best_acc_score: 0.8972; val_best_f1_score: 0.9022; train_kl_reg_loss: 66127.1389; train_edge_recon_loss: 583392.6460; train_gene_expr_recon_loss: 17665051.0840; train_masked_gp_l1_reg_loss: 87992.5144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48695.2906; train_chrom_access_recon_loss: 5608426.9351; train_global_loss: 24059685.6336; train_optim_loss: 24059685.6336; val_kl_reg_loss: 62051.1346; val_edge_recon_loss: 586120.9792; val_gene_expr_recon_loss: 17802032.9333; val_masked_gp_l1_reg_loss: 87886.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48390.8516; val_chrom_access_recon_loss: 5649681.8000; val_global_loss: 24236163.0667; val_optim_loss: 24236163.0667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9556; val_auprc_score: 0.9391; val_best_acc_score: 0.9011; val_best_f1_score: 0.9062; train_kl_reg_loss: 64808.0638; train_edge_recon_loss: 583038.8688; train_gene_expr_recon_loss: 17649544.7557; train_masked_gp_l1_reg_loss: 87790.6545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48178.4018; train_chrom_access_recon_loss: 5605282.4733; train_global_loss: 24038643.2672; train_optim_loss: 24038643.2672; val_kl_reg_loss: 101871.4570; val_edge_recon_loss: 585014.1667; val_gene_expr_recon_loss: 17737805.8667; val_masked_gp_l1_reg_loss: 87768.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47948.3086; val_chrom_access_recon_loss: 5642296.8000; val_global_loss: 24202704.0000; val_optim_loss: 24202704.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 48 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9562
val AUPRC score: 0.9427
val best accuracy score: 0.9026
val best F1 score: 0.9075
val target rna MSE score: 2.0600
val source rna MSE score: 0.4613
val target atac MSE score: 0.3358
val source atac MSE score: 0.1051
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
