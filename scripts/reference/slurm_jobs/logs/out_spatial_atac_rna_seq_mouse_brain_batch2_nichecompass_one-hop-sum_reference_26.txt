[True]
Run timestamp: 10082023_200139_26.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_26']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6731; val_auprc_score: 0.7233; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 81404.2892; train_edge_recon_loss: 3683873.1469; train_gene_expr_recon_loss: 27657774.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4133411.8855; train_global_loss: 35556463.6336; train_optim_loss: 35556463.6336; val_kl_reg_loss: 108456.9484; val_edge_recon_loss: 4065393.1667; val_gene_expr_recon_loss: 23596186.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3919762.2000; val_global_loss: 31689798.6667; val_optim_loss: 31689798.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7664; val_auprc_score: 0.7835; val_best_acc_score: 0.6769; val_best_f1_score: 0.7165; train_kl_reg_loss: 153779.5505; train_edge_recon_loss: 3579146.9466; train_gene_expr_recon_loss: 22874476.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3852223.7805; train_global_loss: 30459626.8397; train_optim_loss: 30459626.8397; val_kl_reg_loss: 197580.7594; val_edge_recon_loss: 4044246.5500; val_gene_expr_recon_loss: 22322072.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3820866.5333; val_global_loss: 30384766.8000; val_optim_loss: 30384766.8000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7926; val_auprc_score: 0.8056; val_best_acc_score: 0.7009; val_best_f1_score: 0.7312; train_kl_reg_loss: 144874.6647; train_edge_recon_loss: 3535124.1584; train_gene_expr_recon_loss: 22265070.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3804130.6546; train_global_loss: 29749199.9237; train_optim_loss: 29749199.9237; val_kl_reg_loss: 131694.8656; val_edge_recon_loss: 3903041.4167; val_gene_expr_recon_loss: 22028361.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3794260.1000; val_global_loss: 29857358.2667; val_optim_loss: 29857358.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8217; val_auprc_score: 0.8351; val_best_acc_score: 0.7315; val_best_f1_score: 0.7464; train_kl_reg_loss: 117677.6362; train_edge_recon_loss: 3397347.4027; train_gene_expr_recon_loss: 22056484.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3780494.0458; train_global_loss: 29352004.0916; train_optim_loss: 29352004.0916; val_kl_reg_loss: 114923.5714; val_edge_recon_loss: 3307855.9667; val_gene_expr_recon_loss: 22109480.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3808447.9000; val_global_loss: 29340707.8667; val_optim_loss: 29340707.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8445; val_auprc_score: 0.8536; val_best_acc_score: 0.7467; val_best_f1_score: 0.7627; train_kl_reg_loss: 136457.1000; train_edge_recon_loss: 3155996.1908; train_gene_expr_recon_loss: 21900803.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3759760.5458; train_global_loss: 28953017.5420; train_optim_loss: 28953017.5420; val_kl_reg_loss: 144137.1969; val_edge_recon_loss: 3129209.5833; val_gene_expr_recon_loss: 21743876.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3758893.5833; val_global_loss: 28776116.9333; val_optim_loss: 28776116.9333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8691; val_auprc_score: 0.8692; val_best_acc_score: 0.7781; val_best_f1_score: 0.7815; train_kl_reg_loss: 136943.1654; train_edge_recon_loss: 3077281.6527; train_gene_expr_recon_loss: 21753666.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3744217.4542; train_global_loss: 28712108.5191; train_optim_loss: 28712108.5191; val_kl_reg_loss: 130914.6266; val_edge_recon_loss: 3068971.1333; val_gene_expr_recon_loss: 21695580.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3745052.1833; val_global_loss: 28640518.2667; val_optim_loss: 28640518.2667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8979; val_auprc_score: 0.8923; val_best_acc_score: 0.8107; val_best_f1_score: 0.8229; train_kl_reg_loss: 131896.6109; train_edge_recon_loss: 2997695.9294; train_gene_expr_recon_loss: 21640282.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3729988.8607; train_global_loss: 28499863.6641; train_optim_loss: 28499863.6641; val_kl_reg_loss: 119947.0688; val_edge_recon_loss: 2994415.1500; val_gene_expr_recon_loss: 21604160.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3740870.2000; val_global_loss: 28459393.2000; val_optim_loss: 28459393.2000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9207; val_auprc_score: 0.9067; val_best_acc_score: 0.8530; val_best_f1_score: 0.8617; train_kl_reg_loss: 128092.3244; train_edge_recon_loss: 2917969.7214; train_gene_expr_recon_loss: 21533851.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3717838.6317; train_global_loss: 28297751.9389; train_optim_loss: 28297751.9389; val_kl_reg_loss: 128294.5417; val_edge_recon_loss: 2890754.9167; val_gene_expr_recon_loss: 21438698.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3713997.5333; val_global_loss: 28171745.2000; val_optim_loss: 28171745.2000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9298; val_auprc_score: 0.9192; val_best_acc_score: 0.8585; val_best_f1_score: 0.8653; train_kl_reg_loss: 129417.1525; train_edge_recon_loss: 2868219.9695; train_gene_expr_recon_loss: 21419116.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3702866.0191; train_global_loss: 28119619.3588; train_optim_loss: 28119619.3588; val_kl_reg_loss: 132092.6938; val_edge_recon_loss: 2871901.0667; val_gene_expr_recon_loss: 21268898.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3686315.4167; val_global_loss: 27959208.0000; val_optim_loss: 27959208.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9387; val_auprc_score: 0.9265; val_best_acc_score: 0.8738; val_best_f1_score: 0.8790; train_kl_reg_loss: 127608.6505; train_edge_recon_loss: 2841771.1221; train_gene_expr_recon_loss: 21348413.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3695451.1469; train_global_loss: 28013244.0000; train_optim_loss: 28013244.0000; val_kl_reg_loss: 125092.8807; val_edge_recon_loss: 2819871.4000; val_gene_expr_recon_loss: 21227770.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3687124.5167; val_global_loss: 27859859.2000; val_optim_loss: 27859859.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9338; val_auprc_score: 0.9223; val_best_acc_score: 0.8677; val_best_f1_score: 0.8751; train_kl_reg_loss: 124363.5481; train_edge_recon_loss: 2828039.0859; train_gene_expr_recon_loss: 21240494.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3682318.1393; train_global_loss: 27875215.1298; train_optim_loss: 27875215.1298; val_kl_reg_loss: 117817.0359; val_edge_recon_loss: 2868607.8333; val_gene_expr_recon_loss: 21195809.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3684730.0833; val_global_loss: 27866964.1333; val_optim_loss: 27866964.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9364; val_auprc_score: 0.9203; val_best_acc_score: 0.8740; val_best_f1_score: 0.8811; train_kl_reg_loss: 119250.4973; train_edge_recon_loss: 2809865.8473; train_gene_expr_recon_loss: 21155605.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3667610.1527; train_global_loss: 27752332.1374; train_optim_loss: 27752332.1374; val_kl_reg_loss: 118680.9187; val_edge_recon_loss: 2834896.0167; val_gene_expr_recon_loss: 21012808.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3663232.0500; val_global_loss: 27629618.1333; val_optim_loss: 27629618.1333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9388; val_auprc_score: 0.9225; val_best_acc_score: 0.8812; val_best_f1_score: 0.8856; train_kl_reg_loss: 115401.3138; train_edge_recon_loss: 2806393.3378; train_gene_expr_recon_loss: 21087215.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3659346.2099; train_global_loss: 27668356.1374; train_optim_loss: 27668356.1374; val_kl_reg_loss: 111612.0724; val_edge_recon_loss: 2807114.6167; val_gene_expr_recon_loss: 20991989.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3646102.8333; val_global_loss: 27556818.8000; val_optim_loss: 27556818.8000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9404; val_auprc_score: 0.9276; val_best_acc_score: 0.8793; val_best_f1_score: 0.8850; train_kl_reg_loss: 110367.8624; train_edge_recon_loss: 2797337.8149; train_gene_expr_recon_loss: 21057749.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3656683.3740; train_global_loss: 27622138.1374; train_optim_loss: 27622138.1374; val_kl_reg_loss: 108561.0896; val_edge_recon_loss: 2817148.4000; val_gene_expr_recon_loss: 20948850.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3664266.4667; val_global_loss: 27538826.6667; val_optim_loss: 27538826.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9468; val_auprc_score: 0.9326; val_best_acc_score: 0.8895; val_best_f1_score: 0.8941; train_kl_reg_loss: 108202.8853; train_edge_recon_loss: 2783653.8378; train_gene_expr_recon_loss: 20988402.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3648673.3721; train_global_loss: 27528932.8855; train_optim_loss: 27528932.8855; val_kl_reg_loss: 103722.9797; val_edge_recon_loss: 2781122.9167; val_gene_expr_recon_loss: 20944307.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3648866.0000; val_global_loss: 27478019.7333; val_optim_loss: 27478019.7333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9462; val_auprc_score: 0.9326; val_best_acc_score: 0.8836; val_best_f1_score: 0.8901; train_kl_reg_loss: 104290.0927; train_edge_recon_loss: 2775368.5076; train_gene_expr_recon_loss: 20945346.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3643504.6908; train_global_loss: 27468509.5115; train_optim_loss: 27468509.5115; val_kl_reg_loss: 104476.3396; val_edge_recon_loss: 2794989.6833; val_gene_expr_recon_loss: 20873194.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3648570.4167; val_global_loss: 27421231.0667; val_optim_loss: 27421231.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9523; val_auprc_score: 0.9387; val_best_acc_score: 0.8944; val_best_f1_score: 0.8989; train_kl_reg_loss: 102846.8368; train_edge_recon_loss: 2764497.1622; train_gene_expr_recon_loss: 20895261.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3635697.5477; train_global_loss: 27398302.6718; train_optim_loss: 27398302.6718; val_kl_reg_loss: 102709.4474; val_edge_recon_loss: 2768184.7000; val_gene_expr_recon_loss: 20910831.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3644026.7333; val_global_loss: 27425752.4000; val_optim_loss: 27425752.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9508; val_auprc_score: 0.9398; val_best_acc_score: 0.8922; val_best_f1_score: 0.8972; train_kl_reg_loss: 101013.6656; train_edge_recon_loss: 2758120.8645; train_gene_expr_recon_loss: 20879874.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3635412.7424; train_global_loss: 27374422.1069; train_optim_loss: 27374422.1069; val_kl_reg_loss: 98487.2635; val_edge_recon_loss: 2767658.6833; val_gene_expr_recon_loss: 20864504.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3646569.9500; val_global_loss: 27377220.0000; val_optim_loss: 27377220.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9525; val_auprc_score: 0.9411; val_best_acc_score: 0.8911; val_best_f1_score: 0.8947; train_kl_reg_loss: 98558.9419; train_edge_recon_loss: 2755179.2939; train_gene_expr_recon_loss: 20841178.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3632150.7729; train_global_loss: 27327067.1908; train_optim_loss: 27327067.1908; val_kl_reg_loss: 98196.8703; val_edge_recon_loss: 2771943.8500; val_gene_expr_recon_loss: 20740439.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3626743.8500; val_global_loss: 27237323.7333; val_optim_loss: 27237323.7333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9549; val_auprc_score: 0.9465; val_best_acc_score: 0.8937; val_best_f1_score: 0.8984; train_kl_reg_loss: 97281.2183; train_edge_recon_loss: 2745438.7882; train_gene_expr_recon_loss: 20775136.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3621433.4256; train_global_loss: 27239289.3588; train_optim_loss: 27239289.3588; val_kl_reg_loss: 96399.0307; val_edge_recon_loss: 2747348.1833; val_gene_expr_recon_loss: 20775898.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3629173.0000; val_global_loss: 27248818.6667; val_optim_loss: 27248818.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9559; val_auprc_score: 0.9442; val_best_acc_score: 0.8987; val_best_f1_score: 0.9033; train_kl_reg_loss: 93863.5102; train_edge_recon_loss: 2747491.9561; train_gene_expr_recon_loss: 20748070.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3617458.3416; train_global_loss: 27206884.6260; train_optim_loss: 27206884.6260; val_kl_reg_loss: 93612.3823; val_edge_recon_loss: 2750301.0000; val_gene_expr_recon_loss: 20677504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3608919.8167; val_global_loss: 27130337.3333; val_optim_loss: 27130337.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9574; val_auprc_score: 0.9441; val_best_acc_score: 0.9049; val_best_f1_score: 0.9079; train_kl_reg_loss: 93257.0435; train_edge_recon_loss: 2742634.0916; train_gene_expr_recon_loss: 20723578.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3618676.4389; train_global_loss: 27178146.4885; train_optim_loss: 27178146.4885; val_kl_reg_loss: 92911.7266; val_edge_recon_loss: 2747684.3500; val_gene_expr_recon_loss: 20621551.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3604469.6500; val_global_loss: 27066616.8000; val_optim_loss: 27066616.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9641; val_auprc_score: 0.9570; val_best_acc_score: 0.9081; val_best_f1_score: 0.9119; train_kl_reg_loss: 90423.2447; train_edge_recon_loss: 2736571.0878; train_gene_expr_recon_loss: 20699635.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3614028.5382; train_global_loss: 27140657.9695; train_optim_loss: 27140657.9695; val_kl_reg_loss: 91105.0063; val_edge_recon_loss: 2729021.5167; val_gene_expr_recon_loss: 20604031.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3603259.8500; val_global_loss: 27027417.7333; val_optim_loss: 27027417.7333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9596; val_auprc_score: 0.9464; val_best_acc_score: 0.9095; val_best_f1_score: 0.9136; train_kl_reg_loss: 89624.8512; train_edge_recon_loss: 2727120.4466; train_gene_expr_recon_loss: 20678865.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3613362.0038; train_global_loss: 27108972.2595; train_optim_loss: 27108972.2595; val_kl_reg_loss: 89210.1135; val_edge_recon_loss: 2745068.6500; val_gene_expr_recon_loss: 20581003.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3614872.3500; val_global_loss: 27030154.9333; val_optim_loss: 27030154.9333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9647; val_auprc_score: 0.9575; val_best_acc_score: 0.9104; val_best_f1_score: 0.9129; train_kl_reg_loss: 88395.7324; train_edge_recon_loss: 2720340.3111; train_gene_expr_recon_loss: 20662091.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3613502.7863; train_global_loss: 27084330.6870; train_optim_loss: 27084330.6870; val_kl_reg_loss: 89548.0547; val_edge_recon_loss: 2743061.8333; val_gene_expr_recon_loss: 20644528.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3607020.6667; val_global_loss: 27084159.2000; val_optim_loss: 27084159.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9648; val_auprc_score: 0.9559; val_best_acc_score: 0.9104; val_best_f1_score: 0.9141; train_kl_reg_loss: 95690.1090; train_edge_recon_loss: 2764386.7786; train_gene_expr_recon_loss: 21468128.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3719584.8721; train_global_loss: 28047789.9695; train_optim_loss: 28047789.9695; val_kl_reg_loss: 49815.0565; val_edge_recon_loss: 2763392.4333; val_gene_expr_recon_loss: 21341144.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3691526.2333; val_global_loss: 27845878.0000; val_optim_loss: 27845878.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9636; val_auprc_score: 0.9533; val_best_acc_score: 0.9123; val_best_f1_score: 0.9160; train_kl_reg_loss: 94050.3564; train_edge_recon_loss: 2734308.0076; train_gene_expr_recon_loss: 21349639.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3684368.5992; train_global_loss: 27862366.4122; train_optim_loss: 27862366.4122; val_kl_reg_loss: 53620.1794; val_edge_recon_loss: 2738104.0167; val_gene_expr_recon_loss: 21328572.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3691461.3333; val_global_loss: 27811757.8667; val_optim_loss: 27811757.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9620; val_auprc_score: 0.9493; val_best_acc_score: 0.9092; val_best_f1_score: 0.9131; train_kl_reg_loss: 91045.3565; train_edge_recon_loss: 2732339.1870; train_gene_expr_recon_loss: 21267951.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3672417.1889; train_global_loss: 27763752.9466; train_optim_loss: 27763752.9466; val_kl_reg_loss: 52931.4701; val_edge_recon_loss: 2734351.1667; val_gene_expr_recon_loss: 21290411.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3675753.4833; val_global_loss: 27753447.0667; val_optim_loss: 27753447.0667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9643; val_auprc_score: 0.9547; val_best_acc_score: 0.9151; val_best_f1_score: 0.9179; train_kl_reg_loss: 90300.2194; train_edge_recon_loss: 2720115.1832; train_gene_expr_recon_loss: 21274521.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3675957.2061; train_global_loss: 27760894.3664; train_optim_loss: 27760894.3664; val_kl_reg_loss: 53134.0833; val_edge_recon_loss: 2734140.0667; val_gene_expr_recon_loss: 21212399.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3668782.6667; val_global_loss: 27668456.2667; val_optim_loss: 27668456.2667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9639; val_auprc_score: 0.9529; val_best_acc_score: 0.9120; val_best_f1_score: 0.9160; train_kl_reg_loss: 89829.7424; train_edge_recon_loss: 2731099.3817; train_gene_expr_recon_loss: 21283853.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3673453.4790; train_global_loss: 27778236.1679; train_optim_loss: 27778236.1679; val_kl_reg_loss: 53799.0807; val_edge_recon_loss: 2725525.7500; val_gene_expr_recon_loss: 21220441.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3680804.0833; val_global_loss: 27680570.0000; val_optim_loss: 27680570.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9673; val_auprc_score: 0.9581; val_best_acc_score: 0.9161; val_best_f1_score: 0.9186; train_kl_reg_loss: 89205.2616; train_edge_recon_loss: 2722551.0305; train_gene_expr_recon_loss: 21297788.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3672885.1622; train_global_loss: 27782429.5420; train_optim_loss: 27782429.5420; val_kl_reg_loss: 53893.2201; val_edge_recon_loss: 2726972.5000; val_gene_expr_recon_loss: 21220470.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3668904.5000; val_global_loss: 27670241.2000; val_optim_loss: 27670241.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 55 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9616
val AUPRC score: 0.9516
val best accuracy score: 0.9091
val best F1 score: 0.9114
val target rna MSE score: 1.0152
val source rna MSE score: 29.6447
val target atac MSE score: 0.5700
val source atac MSE score: 6.1660
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
