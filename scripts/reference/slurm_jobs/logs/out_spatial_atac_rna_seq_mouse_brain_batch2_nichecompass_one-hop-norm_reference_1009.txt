[True]
Run timestamp: 10082023_134044_1009.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1009']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7771; val_auprc_score: 0.7953; val_best_acc_score: 0.5317; val_best_f1_score: 0.6792; train_kl_reg_loss: 109153.9614; train_edge_recon_loss: 3557450.3340; train_gene_expr_recon_loss: 14240104.8473; train_masked_gp_l1_reg_loss: 72924.7125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 234113.3817; train_chrom_access_recon_loss: 2168424.8349; train_global_loss: 20382172.1832; train_optim_loss: 20382172.1832; val_kl_reg_loss: 139654.2073; val_edge_recon_loss: 4063236.0333; val_gene_expr_recon_loss: 12919046.4667; val_masked_gp_l1_reg_loss: 67151.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 216071.6250; val_chrom_access_recon_loss: 2121688.2583; val_global_loss: 19526848.5333; val_optim_loss: 19526848.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8551; val_auprc_score: 0.8609; val_best_acc_score: 0.7658; val_best_f1_score: 0.7492; train_kl_reg_loss: 125295.4391; train_edge_recon_loss: 3534464.3779; train_gene_expr_recon_loss: 12606293.6107; train_masked_gp_l1_reg_loss: 66955.7714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197080.4568; train_chrom_access_recon_loss: 2055133.5534; train_global_loss: 18585223.2672; train_optim_loss: 18585223.2672; val_kl_reg_loss: 117647.6016; val_edge_recon_loss: 3991515.8500; val_gene_expr_recon_loss: 12584493.0667; val_masked_gp_l1_reg_loss: 68357.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178475.8438; val_chrom_access_recon_loss: 2071185.6917; val_global_loss: 19011675.7333; val_optim_loss: 19011675.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8980; val_auprc_score: 0.8837; val_best_acc_score: 0.8178; val_best_f1_score: 0.8336; train_kl_reg_loss: 99615.4589; train_edge_recon_loss: 3329643.9981; train_gene_expr_recon_loss: 12403264.8702; train_masked_gp_l1_reg_loss: 71408.1198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162130.5736; train_chrom_access_recon_loss: 2028793.2414; train_global_loss: 18094856.2366; train_optim_loss: 18094856.2366; val_kl_reg_loss: 124523.4708; val_edge_recon_loss: 2969407.6500; val_gene_expr_recon_loss: 12473318.1333; val_masked_gp_l1_reg_loss: 75509.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146735.5000; val_chrom_access_recon_loss: 2054513.6167; val_global_loss: 17844007.6000; val_optim_loss: 17844007.6000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9255; val_auprc_score: 0.9113; val_best_acc_score: 0.8616; val_best_f1_score: 0.8704; train_kl_reg_loss: 130511.5935; train_edge_recon_loss: 2903737.3912; train_gene_expr_recon_loss: 12269035.6489; train_masked_gp_l1_reg_loss: 77370.0224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133857.7719; train_chrom_access_recon_loss: 2009553.3082; train_global_loss: 17524065.6794; train_optim_loss: 17524065.6794; val_kl_reg_loss: 137446.0411; val_edge_recon_loss: 2857760.4500; val_gene_expr_recon_loss: 12402311.5333; val_masked_gp_l1_reg_loss: 79744.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121964.0156; val_chrom_access_recon_loss: 2046449.0083; val_global_loss: 17645674.8667; val_optim_loss: 17645674.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9243; val_auprc_score: 0.9076; val_best_acc_score: 0.8620; val_best_f1_score: 0.8707; train_kl_reg_loss: 133640.3395; train_edge_recon_loss: 2841815.7099; train_gene_expr_recon_loss: 12122315.9466; train_masked_gp_l1_reg_loss: 81465.8888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112327.7190; train_chrom_access_recon_loss: 1989700.0448; train_global_loss: 17281265.6641; train_optim_loss: 17281265.6641; val_kl_reg_loss: 130394.2708; val_edge_recon_loss: 2841441.9000; val_gene_expr_recon_loss: 12207689.7333; val_masked_gp_l1_reg_loss: 83262.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103771.9141; val_chrom_access_recon_loss: 2027744.4750; val_global_loss: 17394305.6000; val_optim_loss: 17394305.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9329; val_auprc_score: 0.9194; val_best_acc_score: 0.8661; val_best_f1_score: 0.8750; train_kl_reg_loss: 125552.5991; train_edge_recon_loss: 2827462.5115; train_gene_expr_recon_loss: 12020734.5115; train_masked_gp_l1_reg_loss: 84993.4722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96788.8966; train_chrom_access_recon_loss: 1973374.2004; train_global_loss: 17128906.1756; train_optim_loss: 17128906.1756; val_kl_reg_loss: 127021.6344; val_edge_recon_loss: 2865464.5000; val_gene_expr_recon_loss: 12094555.3333; val_masked_gp_l1_reg_loss: 86631.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90217.0703; val_chrom_access_recon_loss: 2022121.2167; val_global_loss: 17286011.8667; val_optim_loss: 17286011.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9344; val_auprc_score: 0.9175; val_best_acc_score: 0.8703; val_best_f1_score: 0.8773; train_kl_reg_loss: 121810.0293; train_edge_recon_loss: 2814143.0496; train_gene_expr_recon_loss: 11900390.6565; train_masked_gp_l1_reg_loss: 88074.0838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84614.2578; train_chrom_access_recon_loss: 1955110.9571; train_global_loss: 16964143.0534; train_optim_loss: 16964143.0534; val_kl_reg_loss: 120997.0547; val_edge_recon_loss: 2819300.0333; val_gene_expr_recon_loss: 12001254.0000; val_masked_gp_l1_reg_loss: 89547.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79170.8984; val_chrom_access_recon_loss: 1995266.1750; val_global_loss: 17105536.2000; val_optim_loss: 17105536.2000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9414; val_auprc_score: 0.9270; val_best_acc_score: 0.8804; val_best_f1_score: 0.8873; train_kl_reg_loss: 114460.9442; train_edge_recon_loss: 2815163.0630; train_gene_expr_recon_loss: 11814157.6641; train_masked_gp_l1_reg_loss: 90836.6254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74476.2179; train_chrom_access_recon_loss: 1943207.7977; train_global_loss: 16852302.3130; train_optim_loss: 16852302.3130; val_kl_reg_loss: 118549.7375; val_edge_recon_loss: 2804554.6167; val_gene_expr_recon_loss: 11922776.6000; val_masked_gp_l1_reg_loss: 91971.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69929.0312; val_chrom_access_recon_loss: 1987757.2083; val_global_loss: 16995538.2667; val_optim_loss: 16995538.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9406; val_auprc_score: 0.9248; val_best_acc_score: 0.8831; val_best_f1_score: 0.8902; train_kl_reg_loss: 111693.0720; train_edge_recon_loss: 2795745.1813; train_gene_expr_recon_loss: 11742165.4809; train_masked_gp_l1_reg_loss: 93093.4316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65699.2550; train_chrom_access_recon_loss: 1928826.4599; train_global_loss: 16737222.9084; train_optim_loss: 16737222.9084; val_kl_reg_loss: 108720.0063; val_edge_recon_loss: 2801560.4500; val_gene_expr_recon_loss: 11854284.3333; val_masked_gp_l1_reg_loss: 94392.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61840.3398; val_chrom_access_recon_loss: 1973001.8083; val_global_loss: 16893799.5333; val_optim_loss: 16893799.5333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9429; val_auprc_score: 0.9289; val_best_acc_score: 0.8797; val_best_f1_score: 0.8858; train_kl_reg_loss: 107773.6495; train_edge_recon_loss: 2792988.0420; train_gene_expr_recon_loss: 11658954.4504; train_masked_gp_l1_reg_loss: 95222.6261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58455.5048; train_chrom_access_recon_loss: 1917265.3111; train_global_loss: 16630659.6183; train_optim_loss: 16630659.6183; val_kl_reg_loss: 108685.4375; val_edge_recon_loss: 2802068.1000; val_gene_expr_recon_loss: 11754035.8667; val_masked_gp_l1_reg_loss: 96221.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55237.5625; val_chrom_access_recon_loss: 1959435.7750; val_global_loss: 16775684.2667; val_optim_loss: 16775684.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9416; val_auprc_score: 0.9266; val_best_acc_score: 0.8787; val_best_f1_score: 0.8839; train_kl_reg_loss: 104048.6576; train_edge_recon_loss: 2782639.7271; train_gene_expr_recon_loss: 11603752.9924; train_masked_gp_l1_reg_loss: 97067.0550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52579.9690; train_chrom_access_recon_loss: 1906984.0477; train_global_loss: 16547072.4885; train_optim_loss: 16547072.4885; val_kl_reg_loss: 106643.9578; val_edge_recon_loss: 2821619.7000; val_gene_expr_recon_loss: 11705103.1333; val_masked_gp_l1_reg_loss: 98010.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50088.2148; val_chrom_access_recon_loss: 1950587.2000; val_global_loss: 16732052.8667; val_optim_loss: 16732052.8667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9469; val_auprc_score: 0.9320; val_best_acc_score: 0.8864; val_best_f1_score: 0.8910; train_kl_reg_loss: 101486.8570; train_edge_recon_loss: 2769738.9733; train_gene_expr_recon_loss: 11556701.8779; train_masked_gp_l1_reg_loss: 98984.5861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47881.3787; train_chrom_access_recon_loss: 1899481.6555; train_global_loss: 16474275.3206; train_optim_loss: 16474275.3206; val_kl_reg_loss: 101259.9036; val_edge_recon_loss: 2796472.4667; val_gene_expr_recon_loss: 11695406.7333; val_masked_gp_l1_reg_loss: 99938.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45913.3398; val_chrom_access_recon_loss: 1949171.7000; val_global_loss: 16688162.7333; val_optim_loss: 16688162.7333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9474; val_auprc_score: 0.9345; val_best_acc_score: 0.8879; val_best_f1_score: 0.8938; train_kl_reg_loss: 98407.7733; train_edge_recon_loss: 2766319.0439; train_gene_expr_recon_loss: 11496098.0458; train_masked_gp_l1_reg_loss: 100726.9241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44059.9377; train_chrom_access_recon_loss: 1889685.3330; train_global_loss: 16395296.9618; train_optim_loss: 16395296.9618; val_kl_reg_loss: 100090.1750; val_edge_recon_loss: 2771623.4833; val_gene_expr_recon_loss: 11615913.7333; val_masked_gp_l1_reg_loss: 101596.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42290.3438; val_chrom_access_recon_loss: 1930087.1167; val_global_loss: 16561601.2667; val_optim_loss: 16561601.2667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9586; val_auprc_score: 0.9461; val_best_acc_score: 0.9047; val_best_f1_score: 0.9081; train_kl_reg_loss: 98188.8300; train_edge_recon_loss: 2754216.3149; train_gene_expr_recon_loss: 11455398.6107; train_masked_gp_l1_reg_loss: 102334.8520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40662.5487; train_chrom_access_recon_loss: 1881991.6775; train_global_loss: 16332792.8473; train_optim_loss: 16332792.8473; val_kl_reg_loss: 98440.0990; val_edge_recon_loss: 2743215.4833; val_gene_expr_recon_loss: 11541613.4667; val_masked_gp_l1_reg_loss: 103246.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39261.7188; val_chrom_access_recon_loss: 1920331.8417; val_global_loss: 16446108.8000; val_optim_loss: 16446108.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9536; val_auprc_score: 0.9404; val_best_acc_score: 0.8956; val_best_f1_score: 0.9006; train_kl_reg_loss: 95971.6372; train_edge_recon_loss: 2743073.5172; train_gene_expr_recon_loss: 11409616.9695; train_masked_gp_l1_reg_loss: 103998.8476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37872.2329; train_chrom_access_recon_loss: 1876838.6842; train_global_loss: 16267371.8550; train_optim_loss: 16267371.8550; val_kl_reg_loss: 96383.0693; val_edge_recon_loss: 2759067.0833; val_gene_expr_recon_loss: 11501322.8000; val_masked_gp_l1_reg_loss: 104925.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36574.3047; val_chrom_access_recon_loss: 1912236.5250; val_global_loss: 16410509.5333; val_optim_loss: 16410509.5333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9617; val_auprc_score: 0.9541; val_best_acc_score: 0.8994; val_best_f1_score: 0.9046; train_kl_reg_loss: 94992.8167; train_edge_recon_loss: 2734315.9389; train_gene_expr_recon_loss: 11374952.4198; train_masked_gp_l1_reg_loss: 105601.1977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35415.1585; train_chrom_access_recon_loss: 1869420.7710; train_global_loss: 16214698.3282; train_optim_loss: 16214698.3282; val_kl_reg_loss: 93469.7302; val_edge_recon_loss: 2737794.4667; val_gene_expr_recon_loss: 11489479.0000; val_masked_gp_l1_reg_loss: 106369.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34290.7461; val_chrom_access_recon_loss: 1907586.8917; val_global_loss: 16368990.2667; val_optim_loss: 16368990.2667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9625; val_auprc_score: 0.9541; val_best_acc_score: 0.9034; val_best_f1_score: 0.9062; train_kl_reg_loss: 94203.8104; train_edge_recon_loss: 2721925.5935; train_gene_expr_recon_loss: 11346612.6107; train_masked_gp_l1_reg_loss: 107031.8780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33332.6835; train_chrom_access_recon_loss: 1864180.9313; train_global_loss: 16167287.5115; train_optim_loss: 16167287.5115; val_kl_reg_loss: 92212.8375; val_edge_recon_loss: 2740847.2500; val_gene_expr_recon_loss: 11435884.6000; val_masked_gp_l1_reg_loss: 107828.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32381.2051; val_chrom_access_recon_loss: 1895462.7833; val_global_loss: 16304617.2667; val_optim_loss: 16304617.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9661; val_auprc_score: 0.9567; val_best_acc_score: 0.9109; val_best_f1_score: 0.9136; train_kl_reg_loss: 93490.8474; train_edge_recon_loss: 2722093.7805; train_gene_expr_recon_loss: 11307916.5496; train_masked_gp_l1_reg_loss: 108460.9996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31471.3665; train_chrom_access_recon_loss: 1857886.6603; train_global_loss: 16121320.1832; train_optim_loss: 16121320.1832; val_kl_reg_loss: 93783.5312; val_edge_recon_loss: 2712729.1667; val_gene_expr_recon_loss: 11433840.8667; val_masked_gp_l1_reg_loss: 109168.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30654.0312; val_chrom_access_recon_loss: 1902608.4833; val_global_loss: 16282784.1333; val_optim_loss: 16282784.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9652; val_auprc_score: 0.9533; val_best_acc_score: 0.9107; val_best_f1_score: 0.9132; train_kl_reg_loss: 93051.5324; train_edge_recon_loss: 2719277.3244; train_gene_expr_recon_loss: 11278305.6641; train_masked_gp_l1_reg_loss: 109793.6907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29954.0746; train_chrom_access_recon_loss: 1854908.3073; train_global_loss: 16085290.6718; train_optim_loss: 16085290.6718; val_kl_reg_loss: 93873.3031; val_edge_recon_loss: 2715634.3167; val_gene_expr_recon_loss: 11394769.3333; val_masked_gp_l1_reg_loss: 110313.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29231.3105; val_chrom_access_recon_loss: 1888201.9667; val_global_loss: 16232023.0000; val_optim_loss: 16232023.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9668; val_auprc_score: 0.9593; val_best_acc_score: 0.9101; val_best_f1_score: 0.9143; train_kl_reg_loss: 92343.1614; train_edge_recon_loss: 2712378.9046; train_gene_expr_recon_loss: 11252288.9084; train_masked_gp_l1_reg_loss: 110963.5778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28659.0669; train_chrom_access_recon_loss: 1849626.0964; train_global_loss: 16046259.8092; train_optim_loss: 16046259.8092; val_kl_reg_loss: 92696.2776; val_edge_recon_loss: 2711275.5500; val_gene_expr_recon_loss: 11358280.5333; val_masked_gp_l1_reg_loss: 111454.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28059.4238; val_chrom_access_recon_loss: 1887754.2833; val_global_loss: 16189519.8000; val_optim_loss: 16189519.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9640; val_auprc_score: 0.9524; val_best_acc_score: 0.9112; val_best_f1_score: 0.9150; train_kl_reg_loss: 90865.0747; train_edge_recon_loss: 2710884.8492; train_gene_expr_recon_loss: 11230605.0458; train_masked_gp_l1_reg_loss: 112455.4850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27560.3326; train_chrom_access_recon_loss: 1847465.9084; train_global_loss: 16019836.7634; train_optim_loss: 16019836.7634; val_kl_reg_loss: 91010.2219; val_edge_recon_loss: 2734776.5167; val_gene_expr_recon_loss: 11360845.0000; val_masked_gp_l1_reg_loss: 112858.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27075.0742; val_chrom_access_recon_loss: 1885234.7667; val_global_loss: 16211799.5333; val_optim_loss: 16211799.5333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9667; val_auprc_score: 0.9550; val_best_acc_score: 0.9155; val_best_f1_score: 0.9175; train_kl_reg_loss: 89924.3547; train_edge_recon_loss: 2704101.0267; train_gene_expr_recon_loss: 11198401.3435; train_masked_gp_l1_reg_loss: 113372.0917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26645.9090; train_chrom_access_recon_loss: 1841197.2519; train_global_loss: 15973642.0382; train_optim_loss: 15973642.0382; val_kl_reg_loss: 93258.0786; val_edge_recon_loss: 2734027.4833; val_gene_expr_recon_loss: 11297906.7333; val_masked_gp_l1_reg_loss: 113982.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26192.4766; val_chrom_access_recon_loss: 1883272.2167; val_global_loss: 16148639.4000; val_optim_loss: 16148639.4000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9722; val_auprc_score: 0.9644; val_best_acc_score: 0.9244; val_best_f1_score: 0.9256; train_kl_reg_loss: 88308.5103; train_edge_recon_loss: 2704618.4427; train_gene_expr_recon_loss: 11172686.7023; train_masked_gp_l1_reg_loss: 114548.5236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25869.8700; train_chrom_access_recon_loss: 1837004.5515; train_global_loss: 15943036.6107; train_optim_loss: 15943036.6107; val_kl_reg_loss: 88657.6562; val_edge_recon_loss: 2701741.9833; val_gene_expr_recon_loss: 11289734.6000; val_masked_gp_l1_reg_loss: 115083.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25516.0156; val_chrom_access_recon_loss: 1878677.5917; val_global_loss: 16099411.7333; val_optim_loss: 16099411.7333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9727; val_auprc_score: 0.9651; val_best_acc_score: 0.9220; val_best_f1_score: 0.9246; train_kl_reg_loss: 87821.9880; train_edge_recon_loss: 2706401.6145; train_gene_expr_recon_loss: 11148807.8550; train_masked_gp_l1_reg_loss: 115616.9434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25172.7308; train_chrom_access_recon_loss: 1833041.8779; train_global_loss: 15916863.0153; train_optim_loss: 15916863.0153; val_kl_reg_loss: 89249.5099; val_edge_recon_loss: 2716956.4667; val_gene_expr_recon_loss: 11267294.9333; val_masked_gp_l1_reg_loss: 115982.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24823.7090; val_chrom_access_recon_loss: 1878502.6250; val_global_loss: 16092809.6667; val_optim_loss: 16092809.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9711; val_auprc_score: 0.9618; val_best_acc_score: 0.9250; val_best_f1_score: 0.9274; train_kl_reg_loss: 89183.7597; train_edge_recon_loss: 2701224.2385; train_gene_expr_recon_loss: 11126336.4733; train_masked_gp_l1_reg_loss: 116471.2300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24520.1000; train_chrom_access_recon_loss: 1831290.9981; train_global_loss: 15889026.7863; train_optim_loss: 15889026.7863; val_kl_reg_loss: 88709.8266; val_edge_recon_loss: 2700573.5500; val_gene_expr_recon_loss: 11276027.4000; val_masked_gp_l1_reg_loss: 117115.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24283.6641; val_chrom_access_recon_loss: 1866893.5333; val_global_loss: 16073604.2667; val_optim_loss: 16073604.2667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9586; val_auprc_score: 0.9450; val_best_acc_score: 0.9070; val_best_f1_score: 0.9099; train_kl_reg_loss: 110891.9377; train_edge_recon_loss: 2793272.6069; train_gene_expr_recon_loss: 11758249.2595; train_masked_gp_l1_reg_loss: 117540.0265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23248.6550; train_chrom_access_recon_loss: 1902516.2767; train_global_loss: 16705718.7634; train_optim_loss: 16705718.7634; val_kl_reg_loss: 16366.3562; val_edge_recon_loss: 2866621.4833; val_gene_expr_recon_loss: 12396486.4000; val_masked_gp_l1_reg_loss: 119651.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23321.4512; val_chrom_access_recon_loss: 1968449.1167; val_global_loss: 17390896.2667; val_optim_loss: 17390896.2667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9422; val_auprc_score: 0.9241; val_best_acc_score: 0.8895; val_best_f1_score: 0.8954; train_kl_reg_loss: 90224.6130; train_edge_recon_loss: 2830711.5191; train_gene_expr_recon_loss: 12807398.9008; train_masked_gp_l1_reg_loss: 120805.9643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24542.1090; train_chrom_access_recon_loss: 1954206.7681; train_global_loss: 17827889.9008; train_optim_loss: 17827889.9008; val_kl_reg_loss: 17854.4402; val_edge_recon_loss: 2785529.2667; val_gene_expr_recon_loss: 13164933.8000; val_masked_gp_l1_reg_loss: 119671.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24992.0801; val_chrom_access_recon_loss: 2004557.0083; val_global_loss: 18117538.6667; val_optim_loss: 18117538.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9344; val_auprc_score: 0.9130; val_best_acc_score: 0.8820; val_best_f1_score: 0.8871; train_kl_reg_loss: 47462.5915; train_edge_recon_loss: 2746041.2023; train_gene_expr_recon_loss: 12999754.5267; train_masked_gp_l1_reg_loss: 116323.5039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24649.1941; train_chrom_access_recon_loss: 1959048.8712; train_global_loss: 17893279.8626; train_optim_loss: 17893279.8626; val_kl_reg_loss: 24660.1348; val_edge_recon_loss: 2756135.1167; val_gene_expr_recon_loss: 13077588.2667; val_masked_gp_l1_reg_loss: 112518.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24154.7852; val_chrom_access_recon_loss: 2000391.1833; val_global_loss: 17995447.4667; val_optim_loss: 17995447.4667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9454; val_auprc_score: 0.9263; val_best_acc_score: 0.8941; val_best_f1_score: 0.8988; train_kl_reg_loss: 39008.5008; train_edge_recon_loss: 2738039.3092; train_gene_expr_recon_loss: 12924013.8092; train_masked_gp_l1_reg_loss: 108764.7792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23777.3961; train_chrom_access_recon_loss: 1953941.3244; train_global_loss: 17787545.0916; train_optim_loss: 17787545.0916; val_kl_reg_loss: 25773.0599; val_edge_recon_loss: 2733395.4500; val_gene_expr_recon_loss: 13044433.4667; val_masked_gp_l1_reg_loss: 105103.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23433.5898; val_chrom_access_recon_loss: 1990689.5583; val_global_loss: 17922828.6667; val_optim_loss: 17922828.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9461; val_auprc_score: 0.9310; val_best_acc_score: 0.8918; val_best_f1_score: 0.8982; train_kl_reg_loss: 38494.3902; train_edge_recon_loss: 2730401.3111; train_gene_expr_recon_loss: 12871974.8779; train_masked_gp_l1_reg_loss: 104348.0831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23266.6954; train_chrom_access_recon_loss: 1949622.0573; train_global_loss: 17718107.2672; train_optim_loss: 17718107.2672; val_kl_reg_loss: 26019.3633; val_edge_recon_loss: 2712212.5000; val_gene_expr_recon_loss: 13118454.4667; val_masked_gp_l1_reg_loss: 103918.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23122.4160; val_chrom_access_recon_loss: 1987271.3583; val_global_loss: 17970998.8000; val_optim_loss: 17970998.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9468; val_auprc_score: 0.9290; val_best_acc_score: 0.8953; val_best_f1_score: 0.9001; train_kl_reg_loss: 39099.4286; train_edge_recon_loss: 2728976.1794; train_gene_expr_recon_loss: 12895183.5420; train_masked_gp_l1_reg_loss: 103516.2810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22753.8159; train_chrom_access_recon_loss: 1950567.2023; train_global_loss: 17740096.4580; train_optim_loss: 17740096.4580; val_kl_reg_loss: 27496.1385; val_edge_recon_loss: 2732048.4333; val_gene_expr_recon_loss: 13036009.7333; val_masked_gp_l1_reg_loss: 103082.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22432.6484; val_chrom_access_recon_loss: 1990703.4000; val_global_loss: 17911772.6667; val_optim_loss: 17911772.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9466; val_auprc_score: 0.9281; val_best_acc_score: 0.8928; val_best_f1_score: 0.8973; train_kl_reg_loss: 38791.8490; train_edge_recon_loss: 2734321.9580; train_gene_expr_recon_loss: 12877705.7710; train_masked_gp_l1_reg_loss: 102642.8557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22212.5586; train_chrom_access_recon_loss: 1949954.8807; train_global_loss: 17725629.8015; train_optim_loss: 17725629.8015; val_kl_reg_loss: 27384.1257; val_edge_recon_loss: 2736346.0000; val_gene_expr_recon_loss: 12927509.1333; val_masked_gp_l1_reg_loss: 102192.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22009.3438; val_chrom_access_recon_loss: 1986778.2667; val_global_loss: 17802218.2000; val_optim_loss: 17802218.2000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9307; val_auprc_score: 0.9126; val_best_acc_score: 0.8673; val_best_f1_score: 0.8716; train_kl_reg_loss: 37775.6316; train_edge_recon_loss: 2766172.7958; train_gene_expr_recon_loss: 12874498.6336; train_masked_gp_l1_reg_loss: 101744.7279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21856.6956; train_chrom_access_recon_loss: 2061803.0191; train_global_loss: 17863851.5344; train_optim_loss: 17863851.5344; val_kl_reg_loss: 16480.3895; val_edge_recon_loss: 2795762.4500; val_gene_expr_recon_loss: 12969690.0667; val_masked_gp_l1_reg_loss: 101313.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21731.0215; val_chrom_access_recon_loss: 1997376.9833; val_global_loss: 17902353.8667; val_optim_loss: 17902353.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 48 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9737
val AUPRC score: 0.9639
val best accuracy score: 0.9247
val best F1 score: 0.9273
val target rna MSE score: 4.3365
val source rna MSE score: 3.0551
val target atac MSE score: 0.6111
val source atac MSE score: 0.1727
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
