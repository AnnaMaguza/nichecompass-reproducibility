[True]
Run timestamp: 10102023_091957_215.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_215']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6771; val_auprc_score: 0.6644; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 67350.8609; train_edge_recon_loss: 749665.5066; train_gene_expr_recon_loss: 23410824.8485; train_masked_gp_l1_reg_loss: 39438.4645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4173687.6061; train_chrom_access_recon_loss: 6926397.3030; train_global_loss: 35367364.8485; train_optim_loss: 35367364.8485; val_kl_reg_loss: 102927.1943; val_edge_recon_loss: 813146.0312; val_gene_expr_recon_loss: 21418720.0000; val_masked_gp_l1_reg_loss: 44743.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2971336.5000; val_chrom_access_recon_loss: 6709408.6875; val_global_loss: 32060282.2500; val_optim_loss: 32060282.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6736; val_auprc_score: 0.6622; val_best_acc_score: 0.5473; val_best_f1_score: 0.6832; train_kl_reg_loss: 91128.1416; train_edge_recon_loss: 749405.1648; train_gene_expr_recon_loss: 21187701.9091; train_masked_gp_l1_reg_loss: 44589.6271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2045237.9621; train_chrom_access_recon_loss: 6595403.2424; train_global_loss: 30713465.8182; train_optim_loss: 30713465.8182; val_kl_reg_loss: 89945.1523; val_edge_recon_loss: 812589.3516; val_gene_expr_recon_loss: 21016164.5000; val_masked_gp_l1_reg_loss: 44670.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1312790.3750; val_chrom_access_recon_loss: 6572021.2500; val_global_loss: 29848180.2500; val_optim_loss: 29848180.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7363; val_auprc_score: 0.7229; val_best_acc_score: 0.6470; val_best_f1_score: 0.7068; train_kl_reg_loss: 79780.4280; train_edge_recon_loss: 738911.1809; train_gene_expr_recon_loss: 20996547.1515; train_masked_gp_l1_reg_loss: 44842.9624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 940876.3220; train_chrom_access_recon_loss: 6556034.5379; train_global_loss: 29356992.6970; train_optim_loss: 29356992.6970; val_kl_reg_loss: 78523.9395; val_edge_recon_loss: 809691.8906; val_gene_expr_recon_loss: 21130494.0000; val_masked_gp_l1_reg_loss: 45187.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 662653.0625; val_chrom_access_recon_loss: 6666667.3750; val_global_loss: 29393219.0000; val_optim_loss: 29393219.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8151; val_auprc_score: 0.7863; val_best_acc_score: 0.7093; val_best_f1_score: 0.7590; train_kl_reg_loss: 71317.1384; train_edge_recon_loss: 730244.0843; train_gene_expr_recon_loss: 20849683.3939; train_masked_gp_l1_reg_loss: 45816.4556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 516674.1245; train_chrom_access_recon_loss: 6518022.5682; train_global_loss: 28731757.9091; train_optim_loss: 28731757.9091; val_kl_reg_loss: 70490.3369; val_edge_recon_loss: 790393.9531; val_gene_expr_recon_loss: 20811499.0000; val_masked_gp_l1_reg_loss: 46717.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 403538.8438; val_chrom_access_recon_loss: 6568494.0625; val_global_loss: 28691133.2500; val_optim_loss: 28691133.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8738; val_auprc_score: 0.8411; val_best_acc_score: 0.8039; val_best_f1_score: 0.8173; train_kl_reg_loss: 65630.2346; train_edge_recon_loss: 711807.2775; train_gene_expr_recon_loss: 20705532.3939; train_masked_gp_l1_reg_loss: 47687.8704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 338357.6307; train_chrom_access_recon_loss: 6482089.7652; train_global_loss: 28351105.2424; train_optim_loss: 28351105.2424; val_kl_reg_loss: 63946.1162; val_edge_recon_loss: 720898.1172; val_gene_expr_recon_loss: 20767288.2500; val_masked_gp_l1_reg_loss: 48569.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 285134.8125; val_chrom_access_recon_loss: 6571654.0000; val_global_loss: 28457490.5000; val_optim_loss: 28457490.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8834; val_auprc_score: 0.8556; val_best_acc_score: 0.8052; val_best_f1_score: 0.8181; train_kl_reg_loss: 69823.3401; train_edge_recon_loss: 661972.1307; train_gene_expr_recon_loss: 20563595.7879; train_masked_gp_l1_reg_loss: 49753.4309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 250013.4619; train_chrom_access_recon_loss: 6445145.1894; train_global_loss: 28040303.3333; train_optim_loss: 28040303.3333; val_kl_reg_loss: 76967.8564; val_edge_recon_loss: 646804.5469; val_gene_expr_recon_loss: 20531432.0000; val_masked_gp_l1_reg_loss: 50971.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 220454.2656; val_chrom_access_recon_loss: 6495024.0000; val_global_loss: 28021654.2500; val_optim_loss: 28021654.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8917; val_auprc_score: 0.8567; val_best_acc_score: 0.8305; val_best_f1_score: 0.8413; train_kl_reg_loss: 76019.8416; train_edge_recon_loss: 629862.5473; train_gene_expr_recon_loss: 20459066.2424; train_masked_gp_l1_reg_loss: 51960.5096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199800.0746; train_chrom_access_recon_loss: 6412656.5455; train_global_loss: 27829365.9091; train_optim_loss: 27829365.9091; val_kl_reg_loss: 76079.2217; val_edge_recon_loss: 626045.6719; val_gene_expr_recon_loss: 20536605.0000; val_masked_gp_l1_reg_loss: 52905.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182848.8594; val_chrom_access_recon_loss: 6541981.3750; val_global_loss: 28016465.7500; val_optim_loss: 28016465.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9019; val_auprc_score: 0.8730; val_best_acc_score: 0.8302; val_best_f1_score: 0.8388; train_kl_reg_loss: 74346.1899; train_edge_recon_loss: 620913.0322; train_gene_expr_recon_loss: 20360488.3030; train_masked_gp_l1_reg_loss: 53780.4987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169110.4915; train_chrom_access_recon_loss: 6386971.3258; train_global_loss: 27665610.0909; train_optim_loss: 27665610.0909; val_kl_reg_loss: 74944.4609; val_edge_recon_loss: 620010.5391; val_gene_expr_recon_loss: 20228447.0000; val_masked_gp_l1_reg_loss: 54580.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157046.2344; val_chrom_access_recon_loss: 6413127.1875; val_global_loss: 27548155.2500; val_optim_loss: 27548155.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9078; val_auprc_score: 0.8750; val_best_acc_score: 0.8369; val_best_f1_score: 0.8491; train_kl_reg_loss: 72937.3677; train_edge_recon_loss: 613518.9962; train_gene_expr_recon_loss: 20259752.6364; train_masked_gp_l1_reg_loss: 55295.2397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148076.1868; train_chrom_access_recon_loss: 6361162.2424; train_global_loss: 27510742.7273; train_optim_loss: 27510742.7273; val_kl_reg_loss: 69924.0811; val_edge_recon_loss: 610209.4766; val_gene_expr_recon_loss: 20336470.7500; val_masked_gp_l1_reg_loss: 55964.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139997.5156; val_chrom_access_recon_loss: 6403384.5625; val_global_loss: 27615950.2500; val_optim_loss: 27615950.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9054; val_auprc_score: 0.8742; val_best_acc_score: 0.8388; val_best_f1_score: 0.8516; train_kl_reg_loss: 71811.7480; train_edge_recon_loss: 605896.0947; train_gene_expr_recon_loss: 20176749.1212; train_masked_gp_l1_reg_loss: 56643.6745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133850.1934; train_chrom_access_recon_loss: 6330390.3182; train_global_loss: 27375341.2727; train_optim_loss: 27375341.2727; val_kl_reg_loss: 71844.8721; val_edge_recon_loss: 609202.5703; val_gene_expr_recon_loss: 20278780.0000; val_masked_gp_l1_reg_loss: 57212.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128745.0234; val_chrom_access_recon_loss: 6430161.4375; val_global_loss: 27575946.7500; val_optim_loss: 27575946.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9091; val_auprc_score: 0.8804; val_best_acc_score: 0.8426; val_best_f1_score: 0.8564; train_kl_reg_loss: 69645.4548; train_edge_recon_loss: 605024.7983; train_gene_expr_recon_loss: 20115155.5758; train_masked_gp_l1_reg_loss: 57812.2645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124410.6532; train_chrom_access_recon_loss: 6312472.9242; train_global_loss: 27284521.6061; train_optim_loss: 27284521.6061; val_kl_reg_loss: 69589.7852; val_edge_recon_loss: 608739.4766; val_gene_expr_recon_loss: 20276408.0000; val_masked_gp_l1_reg_loss: 58377.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120485.7422; val_chrom_access_recon_loss: 6420478.1250; val_global_loss: 27554079.2500; val_optim_loss: 27554079.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9161; val_auprc_score: 0.8970; val_best_acc_score: 0.8501; val_best_f1_score: 0.8603; train_kl_reg_loss: 68560.7823; train_edge_recon_loss: 601725.1222; train_gene_expr_recon_loss: 20023936.3939; train_masked_gp_l1_reg_loss: 58847.7861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117585.5779; train_chrom_access_recon_loss: 6285997.6818; train_global_loss: 27156653.4242; train_optim_loss: 27156653.4242; val_kl_reg_loss: 66542.8711; val_edge_recon_loss: 605185.1328; val_gene_expr_recon_loss: 20280010.5000; val_masked_gp_l1_reg_loss: 59356.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114968.8125; val_chrom_access_recon_loss: 6471151.1250; val_global_loss: 27597214.0000; val_optim_loss: 27597214.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9176; val_auprc_score: 0.8934; val_best_acc_score: 0.8493; val_best_f1_score: 0.8609; train_kl_reg_loss: 66730.7628; train_edge_recon_loss: 600655.4167; train_gene_expr_recon_loss: 19981231.2727; train_masked_gp_l1_reg_loss: 58871.0438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96947.5903; train_chrom_access_recon_loss: 6269676.0152; train_global_loss: 27074112.0303; train_optim_loss: 27074112.0303; val_kl_reg_loss: 69176.5781; val_edge_recon_loss: 604927.2266; val_gene_expr_recon_loss: 20286887.7500; val_masked_gp_l1_reg_loss: 58566.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90711.5547; val_chrom_access_recon_loss: 6483422.6875; val_global_loss: 27593692.0000; val_optim_loss: 27593692.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9149; val_auprc_score: 0.8887; val_best_acc_score: 0.8517; val_best_f1_score: 0.8597; train_kl_reg_loss: 68356.7019; train_edge_recon_loss: 598426.1525; train_gene_expr_recon_loss: 19983677.5455; train_masked_gp_l1_reg_loss: 58491.9273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89544.1397; train_chrom_access_recon_loss: 6269720.7652; train_global_loss: 27068217.1212; train_optim_loss: 27068217.1212; val_kl_reg_loss: 68929.8193; val_edge_recon_loss: 601292.5234; val_gene_expr_recon_loss: 20105488.5000; val_masked_gp_l1_reg_loss: 58445.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88692.4922; val_chrom_access_recon_loss: 6393869.5625; val_global_loss: 27316718.0000; val_optim_loss: 27316718.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9040; val_auprc_score: 0.8692; val_best_acc_score: 0.8409; val_best_f1_score: 0.8552; train_kl_reg_loss: 68356.5758; train_edge_recon_loss: 598374.8011; train_gene_expr_recon_loss: 19974704.2727; train_masked_gp_l1_reg_loss: 58456.1812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87991.6656; train_chrom_access_recon_loss: 6261380.3106; train_global_loss: 27049263.9091; train_optim_loss: 27049263.9091; val_kl_reg_loss: 70058.1396; val_edge_recon_loss: 603201.1250; val_gene_expr_recon_loss: 20096152.0000; val_masked_gp_l1_reg_loss: 58481.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87392.5156; val_chrom_access_recon_loss: 6367445.6875; val_global_loss: 27282731.0000; val_optim_loss: 27282731.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9172; val_auprc_score: 0.8857; val_best_acc_score: 0.8552; val_best_f1_score: 0.8673; train_kl_reg_loss: 68540.0685; train_edge_recon_loss: 599030.0833; train_gene_expr_recon_loss: 19959483.6970; train_masked_gp_l1_reg_loss: 58494.7398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86749.4658; train_chrom_access_recon_loss: 6253832.7803; train_global_loss: 27026130.8485; train_optim_loss: 27026130.8485; val_kl_reg_loss: 69758.1211; val_edge_recon_loss: 593850.3359; val_gene_expr_recon_loss: 19849463.0000; val_masked_gp_l1_reg_loss: 58523.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86238.0469; val_chrom_access_recon_loss: 6330863.5625; val_global_loss: 26988696.7500; val_optim_loss: 26988696.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9139; val_auprc_score: 0.8901; val_best_acc_score: 0.8471; val_best_f1_score: 0.8573; train_kl_reg_loss: 68853.6046; train_edge_recon_loss: 598417.8456; train_gene_expr_recon_loss: 19948619.0000; train_masked_gp_l1_reg_loss: 58546.1519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85644.6824; train_chrom_access_recon_loss: 6260517.4848; train_global_loss: 27020598.5758; train_optim_loss: 27020598.5758; val_kl_reg_loss: 69836.4980; val_edge_recon_loss: 603921.0938; val_gene_expr_recon_loss: 20013107.0000; val_masked_gp_l1_reg_loss: 58582.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85223.1016; val_chrom_access_recon_loss: 6302275.6250; val_global_loss: 27132946.5000; val_optim_loss: 27132946.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9165; val_auprc_score: 0.8926; val_best_acc_score: 0.8560; val_best_f1_score: 0.8683; train_kl_reg_loss: 68966.1032; train_edge_recon_loss: 598582.8239; train_gene_expr_recon_loss: 19922747.0606; train_masked_gp_l1_reg_loss: 58625.8538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84659.2313; train_chrom_access_recon_loss: 6250672.6894; train_global_loss: 26984253.7576; train_optim_loss: 26984253.7576; val_kl_reg_loss: 69989.3838; val_edge_recon_loss: 595433.2812; val_gene_expr_recon_loss: 20035534.5000; val_masked_gp_l1_reg_loss: 58663.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84185.4531; val_chrom_access_recon_loss: 6349607.8750; val_global_loss: 27193415.2500; val_optim_loss: 27193415.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9137; val_auprc_score: 0.8904; val_best_acc_score: 0.8412; val_best_f1_score: 0.8544; train_kl_reg_loss: 68894.4942; train_edge_recon_loss: 597932.7699; train_gene_expr_recon_loss: 19943600.6061; train_masked_gp_l1_reg_loss: 58690.2102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83636.4257; train_chrom_access_recon_loss: 6258973.4167; train_global_loss: 27011727.9697; train_optim_loss: 27011727.9697; val_kl_reg_loss: 69653.7139; val_edge_recon_loss: 603168.3281; val_gene_expr_recon_loss: 20068436.0000; val_masked_gp_l1_reg_loss: 58724.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83249.6797; val_chrom_access_recon_loss: 6345403.3750; val_global_loss: 27228635.2500; val_optim_loss: 27228635.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9130; val_auprc_score: 0.8839; val_best_acc_score: 0.8458; val_best_f1_score: 0.8534; train_kl_reg_loss: 68413.4751; train_edge_recon_loss: 597480.1458; train_gene_expr_recon_loss: 19927860.0303; train_masked_gp_l1_reg_loss: 58753.4680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82726.7377; train_chrom_access_recon_loss: 6247669.9621; train_global_loss: 26982903.7273; train_optim_loss: 26982903.7273; val_kl_reg_loss: 69596.7158; val_edge_recon_loss: 602958.7266; val_gene_expr_recon_loss: 19950802.0000; val_masked_gp_l1_reg_loss: 58797.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82317.6484; val_chrom_access_recon_loss: 6310255.2500; val_global_loss: 27074729.0000; val_optim_loss: 27074729.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9203; val_auprc_score: 0.8967; val_best_acc_score: 0.8501; val_best_f1_score: 0.8613; train_kl_reg_loss: 68520.0836; train_edge_recon_loss: 595953.4394; train_gene_expr_recon_loss: 19923366.0606; train_masked_gp_l1_reg_loss: 58744.8905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80477.9031; train_chrom_access_recon_loss: 6246785.8182; train_global_loss: 26973848.3030; train_optim_loss: 26973848.3030; val_kl_reg_loss: 69293.5068; val_edge_recon_loss: 595297.6250; val_gene_expr_recon_loss: 19927653.7500; val_masked_gp_l1_reg_loss: 58705.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79740.4688; val_chrom_access_recon_loss: 6345649.3125; val_global_loss: 27076339.7500; val_optim_loss: 27076339.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9179; val_auprc_score: 0.8946; val_best_acc_score: 0.8455; val_best_f1_score: 0.8585; train_kl_reg_loss: 68524.7025; train_edge_recon_loss: 596561.8722; train_gene_expr_recon_loss: 19929334.3030; train_masked_gp_l1_reg_loss: 58693.1097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79554.0968; train_chrom_access_recon_loss: 6252376.5303; train_global_loss: 26985044.6061; train_optim_loss: 26985044.6061; val_kl_reg_loss: 69733.7510; val_edge_recon_loss: 601759.6016; val_gene_expr_recon_loss: 20008250.0000; val_masked_gp_l1_reg_loss: 58685.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79407.5625; val_chrom_access_recon_loss: 6364036.1250; val_global_loss: 27181873.2500; val_optim_loss: 27181873.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9200; val_auprc_score: 0.8940; val_best_acc_score: 0.8552; val_best_f1_score: 0.8671; train_kl_reg_loss: 68565.6244; train_edge_recon_loss: 596489.3314; train_gene_expr_recon_loss: 19916243.9394; train_masked_gp_l1_reg_loss: 58683.3288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79310.5331; train_chrom_access_recon_loss: 6243526.7197; train_global_loss: 26962819.5758; train_optim_loss: 26962819.5758; val_kl_reg_loss: 69857.5732; val_edge_recon_loss: 598381.6016; val_gene_expr_recon_loss: 20026020.5000; val_masked_gp_l1_reg_loss: 58680.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79216.6406; val_chrom_access_recon_loss: 6332679.5625; val_global_loss: 27164835.2500; val_optim_loss: 27164835.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9151; val_auprc_score: 0.8920; val_best_acc_score: 0.8450; val_best_f1_score: 0.8576; train_kl_reg_loss: 68565.0375; train_edge_recon_loss: 598937.6373; train_gene_expr_recon_loss: 19913968.1515; train_masked_gp_l1_reg_loss: 58679.6452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79145.0837; train_chrom_access_recon_loss: 6245159.6894; train_global_loss: 26964455.3333; train_optim_loss: 26964455.3333; val_kl_reg_loss: 69345.8682; val_edge_recon_loss: 602696.3438; val_gene_expr_recon_loss: 19869512.0000; val_masked_gp_l1_reg_loss: 58682.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79072.8984; val_chrom_access_recon_loss: 6334195.2500; val_global_loss: 27013503.0000; val_optim_loss: 27013503.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 24 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
val AUROC score: 0.9153
val AUPRC score: 0.8904
val best accuracy score: 0.8487
val best F1 score: 0.8565
val target rna MSE score: 6.3326
val source rna MSE score: 6.7977
val target atac MSE score: 0.3662
val source atac MSE score: 0.2155
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
