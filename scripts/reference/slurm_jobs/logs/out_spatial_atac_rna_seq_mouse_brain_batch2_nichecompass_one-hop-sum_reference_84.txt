[True]
Run timestamp: 10082023_225247_84.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_84']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7795; val_auprc_score: 0.7948; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 153385.0509; train_edge_recon_loss: 3830644.3912; train_gene_expr_recon_loss: 44815272.2748; train_masked_gp_l1_reg_loss: 79261.9908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244066.3396; train_chrom_access_recon_loss: 16261893.1298; train_global_loss: 65384523.3893; train_optim_loss: 65384523.3893; val_kl_reg_loss: 117657.4000; val_edge_recon_loss: 4065274.6500; val_gene_expr_recon_loss: 39286410.4000; val_masked_gp_l1_reg_loss: 77417.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 238943.8438; val_chrom_access_recon_loss: 15936249.8000; val_global_loss: 59721952.2667; val_optim_loss: 59721952.2667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7717; val_auprc_score: 0.7916; val_best_acc_score: 0.5131; val_best_f1_score: 0.6715; train_kl_reg_loss: 148208.6558; train_edge_recon_loss: 3762594.4046; train_gene_expr_recon_loss: 38785431.5115; train_masked_gp_l1_reg_loss: 79745.6213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233867.5372; train_chrom_access_recon_loss: 15501866.6870; train_global_loss: 58511714.1374; train_optim_loss: 58511714.1374; val_kl_reg_loss: 157374.3833; val_edge_recon_loss: 4063952.1500; val_gene_expr_recon_loss: 38292773.6000; val_masked_gp_l1_reg_loss: 82808.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 228322.5625; val_chrom_access_recon_loss: 15793267.6667; val_global_loss: 58618499.2000; val_optim_loss: 58618499.2000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8341; val_auprc_score: 0.8416; val_best_acc_score: 0.7555; val_best_f1_score: 0.7593; train_kl_reg_loss: 186118.6355; train_edge_recon_loss: 3581417.2710; train_gene_expr_recon_loss: 37087763.6641; train_masked_gp_l1_reg_loss: 80549.0844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221940.1499; train_chrom_access_recon_loss: 15300362.0840; train_global_loss: 56458151.0229; train_optim_loss: 56458151.0229; val_kl_reg_loss: 178017.6823; val_edge_recon_loss: 4022871.3667; val_gene_expr_recon_loss: 37177385.0667; val_masked_gp_l1_reg_loss: 79144.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 215421.9531; val_chrom_access_recon_loss: 15557274.2667; val_global_loss: 57230112.0000; val_optim_loss: 57230112.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8777; val_auprc_score: 0.8693; val_best_acc_score: 0.7957; val_best_f1_score: 0.8093; train_kl_reg_loss: 166615.9357; train_edge_recon_loss: 3531833.4008; train_gene_expr_recon_loss: 36564385.5573; train_masked_gp_l1_reg_loss: 79752.7702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209124.8500; train_chrom_access_recon_loss: 15195725.7557; train_global_loss: 55747438.0458; train_optim_loss: 55747438.0458; val_kl_reg_loss: 148169.2552; val_edge_recon_loss: 3804475.0000; val_gene_expr_recon_loss: 37089922.9333; val_masked_gp_l1_reg_loss: 81536.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202881.1719; val_chrom_access_recon_loss: 15521054.6667; val_global_loss: 56848038.4000; val_optim_loss: 56848038.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8882; val_auprc_score: 0.8777; val_best_acc_score: 0.7994; val_best_f1_score: 0.8169; train_kl_reg_loss: 169115.8505; train_edge_recon_loss: 3255932.2233; train_gene_expr_recon_loss: 36324070.7176; train_masked_gp_l1_reg_loss: 82324.4118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 196979.5823; train_chrom_access_recon_loss: 15131853.7328; train_global_loss: 55160276.2748; train_optim_loss: 55160276.2748; val_kl_reg_loss: 193284.8229; val_edge_recon_loss: 3078189.3333; val_gene_expr_recon_loss: 36853504.8000; val_masked_gp_l1_reg_loss: 83278.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 191126.9219; val_chrom_access_recon_loss: 15454473.9333; val_global_loss: 55853860.5333; val_optim_loss: 55853860.5333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9029; val_auprc_score: 0.8929; val_best_acc_score: 0.8160; val_best_f1_score: 0.8258; train_kl_reg_loss: 192428.9104; train_edge_recon_loss: 3026920.3244; train_gene_expr_recon_loss: 36064194.8397; train_masked_gp_l1_reg_loss: 84288.0012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185701.5119; train_chrom_access_recon_loss: 15043178.6870; train_global_loss: 54596712.0916; train_optim_loss: 54596712.0916; val_kl_reg_loss: 197522.1583; val_edge_recon_loss: 2989620.9000; val_gene_expr_recon_loss: 36593226.1333; val_masked_gp_l1_reg_loss: 86045.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 180425.1406; val_chrom_access_recon_loss: 15419213.2667; val_global_loss: 55466050.9333; val_optim_loss: 55466050.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9195; val_auprc_score: 0.9108; val_best_acc_score: 0.8385; val_best_f1_score: 0.8481; train_kl_reg_loss: 190135.5203; train_edge_recon_loss: 2968443.5935; train_gene_expr_recon_loss: 35841638.8397; train_masked_gp_l1_reg_loss: 86617.9470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175689.0416; train_chrom_access_recon_loss: 14970627.4656; train_global_loss: 54233152.2137; train_optim_loss: 54233152.2137; val_kl_reg_loss: 195819.0260; val_edge_recon_loss: 2916562.2167; val_gene_expr_recon_loss: 36336369.3333; val_masked_gp_l1_reg_loss: 87415.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171112.9219; val_chrom_access_recon_loss: 15325089.8000; val_global_loss: 55032369.0667; val_optim_loss: 55032369.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9265; val_auprc_score: 0.9141; val_best_acc_score: 0.8556; val_best_f1_score: 0.8641; train_kl_reg_loss: 183717.1378; train_edge_recon_loss: 2927454.2805; train_gene_expr_recon_loss: 35629074.7328; train_masked_gp_l1_reg_loss: 88741.0229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166968.6675; train_chrom_access_recon_loss: 14899937.5115; train_global_loss: 53895893.4046; train_optim_loss: 53895893.4046; val_kl_reg_loss: 189020.5198; val_edge_recon_loss: 2926471.7167; val_gene_expr_recon_loss: 36295663.4667; val_masked_gp_l1_reg_loss: 90152.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162877.1406; val_chrom_access_recon_loss: 15288876.0000; val_global_loss: 54953059.7333; val_optim_loss: 54953059.7333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9373; val_auprc_score: 0.9286; val_best_acc_score: 0.8642; val_best_f1_score: 0.8719; train_kl_reg_loss: 179509.0425; train_edge_recon_loss: 2901890.1737; train_gene_expr_recon_loss: 35476729.1908; train_masked_gp_l1_reg_loss: 90833.2521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158973.2267; train_chrom_access_recon_loss: 14847357.9771; train_global_loss: 53655293.0076; train_optim_loss: 53655293.0076; val_kl_reg_loss: 177755.3667; val_edge_recon_loss: 2907229.0833; val_gene_expr_recon_loss: 36047648.2667; val_masked_gp_l1_reg_loss: 91911.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155071.3438; val_chrom_access_recon_loss: 15265116.6000; val_global_loss: 54644733.6000; val_optim_loss: 54644733.6000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9433; val_auprc_score: 0.9311; val_best_acc_score: 0.8810; val_best_f1_score: 0.8881; train_kl_reg_loss: 174657.9634; train_edge_recon_loss: 2876499.7118; train_gene_expr_recon_loss: 35342017.4809; train_masked_gp_l1_reg_loss: 92935.5174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151423.9624; train_chrom_access_recon_loss: 14810062.1908; train_global_loss: 53447596.7023; train_optim_loss: 53447596.7023; val_kl_reg_loss: 167818.8667; val_edge_recon_loss: 2857985.7000; val_gene_expr_recon_loss: 35880202.4000; val_masked_gp_l1_reg_loss: 93763.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147730.2812; val_chrom_access_recon_loss: 15156883.3333; val_global_loss: 54304386.4000; val_optim_loss: 54304386.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9497; val_auprc_score: 0.9397; val_best_acc_score: 0.8874; val_best_f1_score: 0.8934; train_kl_reg_loss: 169040.1887; train_edge_recon_loss: 2861439.9905; train_gene_expr_recon_loss: 35201625.1908; train_masked_gp_l1_reg_loss: 95045.8884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144296.2496; train_chrom_access_recon_loss: 14766346.6031; train_global_loss: 53237794.1985; train_optim_loss: 53237794.1985; val_kl_reg_loss: 169396.8469; val_edge_recon_loss: 2857201.3333; val_gene_expr_recon_loss: 35845741.3333; val_masked_gp_l1_reg_loss: 96201.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140921.2812; val_chrom_access_recon_loss: 15182668.9333; val_global_loss: 54292129.0667; val_optim_loss: 54292129.0667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9517; val_auprc_score: 0.9400; val_best_acc_score: 0.8915; val_best_f1_score: 0.8966; train_kl_reg_loss: 164729.2615; train_edge_recon_loss: 2831486.3130; train_gene_expr_recon_loss: 35090612.1832; train_masked_gp_l1_reg_loss: 97164.4358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137684.8265; train_chrom_access_recon_loss: 14729614.6489; train_global_loss: 53051291.6031; train_optim_loss: 53051291.6031; val_kl_reg_loss: 168989.7302; val_edge_recon_loss: 2834187.6833; val_gene_expr_recon_loss: 35644497.0667; val_masked_gp_l1_reg_loss: 98384.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134659.7188; val_chrom_access_recon_loss: 15138606.5333; val_global_loss: 54019325.0667; val_optim_loss: 54019325.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9528; val_auprc_score: 0.9412; val_best_acc_score: 0.8926; val_best_f1_score: 0.8971; train_kl_reg_loss: 161721.3551; train_edge_recon_loss: 2822697.4408; train_gene_expr_recon_loss: 34980525.3893; train_masked_gp_l1_reg_loss: 99286.3130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131771.8511; train_chrom_access_recon_loss: 14693936.3969; train_global_loss: 52889938.2595; train_optim_loss: 52889938.2595; val_kl_reg_loss: 158941.9750; val_edge_recon_loss: 2836173.4167; val_gene_expr_recon_loss: 35513155.7333; val_masked_gp_l1_reg_loss: 100108.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128961.5703; val_chrom_access_recon_loss: 15058822.0667; val_global_loss: 53796161.6000; val_optim_loss: 53796161.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9581; val_auprc_score: 0.9483; val_best_acc_score: 0.8971; val_best_f1_score: 0.9010; train_kl_reg_loss: 157419.1194; train_edge_recon_loss: 2803824.3931; train_gene_expr_recon_loss: 34909979.5267; train_masked_gp_l1_reg_loss: 101318.2902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126371.9117; train_chrom_access_recon_loss: 14688873.0840; train_global_loss: 52787786.4427; train_optim_loss: 52787786.4427; val_kl_reg_loss: 154994.1146; val_edge_recon_loss: 2809700.2833; val_gene_expr_recon_loss: 35360856.0000; val_masked_gp_l1_reg_loss: 102666.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123849.9609; val_chrom_access_recon_loss: 15027553.0000; val_global_loss: 53579619.7333; val_optim_loss: 53579619.7333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9618; val_auprc_score: 0.9522; val_best_acc_score: 0.9039; val_best_f1_score: 0.9061; train_kl_reg_loss: 152971.8305; train_edge_recon_loss: 2807488.5668; train_gene_expr_recon_loss: 34768716.7786; train_masked_gp_l1_reg_loss: 103589.7596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121427.2448; train_chrom_access_recon_loss: 14643204.1985; train_global_loss: 52597398.4427; train_optim_loss: 52597398.4427; val_kl_reg_loss: 151828.7156; val_edge_recon_loss: 2812707.8667; val_gene_expr_recon_loss: 35376668.0000; val_masked_gp_l1_reg_loss: 104657.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119061.6719; val_chrom_access_recon_loss: 14995194.9333; val_global_loss: 53560115.2000; val_optim_loss: 53560115.2000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9636; val_auprc_score: 0.9558; val_best_acc_score: 0.9046; val_best_f1_score: 0.9080; train_kl_reg_loss: 151035.7067; train_edge_recon_loss: 2790547.5630; train_gene_expr_recon_loss: 34646059.7405; train_masked_gp_l1_reg_loss: 105635.4294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116735.7109; train_chrom_access_recon_loss: 14601283.9389; train_global_loss: 52411298.4733; train_optim_loss: 52411298.4733; val_kl_reg_loss: 149501.4062; val_edge_recon_loss: 2820917.7000; val_gene_expr_recon_loss: 35176585.3333; val_masked_gp_l1_reg_loss: 106772.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114459.7266; val_chrom_access_recon_loss: 14989124.3333; val_global_loss: 53357360.2667; val_optim_loss: 53357360.2667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9680; val_auprc_score: 0.9604; val_best_acc_score: 0.9113; val_best_f1_score: 0.9148; train_kl_reg_loss: 147915.6151; train_edge_recon_loss: 2785940.3206; train_gene_expr_recon_loss: 34615732.7634; train_masked_gp_l1_reg_loss: 107818.3621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112328.0906; train_chrom_access_recon_loss: 14611699.9695; train_global_loss: 52381435.0840; train_optim_loss: 52381435.0840; val_kl_reg_loss: 146500.8229; val_edge_recon_loss: 2793065.3000; val_gene_expr_recon_loss: 35039104.5333; val_masked_gp_l1_reg_loss: 108900.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110266.7266; val_chrom_access_recon_loss: 14877969.7333; val_global_loss: 53075808.2667; val_optim_loss: 53075808.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9710; val_auprc_score: 0.9661; val_best_acc_score: 0.9169; val_best_f1_score: 0.9188; train_kl_reg_loss: 145527.4957; train_edge_recon_loss: 2775525.2214; train_gene_expr_recon_loss: 34512350.2443; train_masked_gp_l1_reg_loss: 109984.4959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108263.7388; train_chrom_access_recon_loss: 14582113.5725; train_global_loss: 52233764.7634; train_optim_loss: 52233764.7634; val_kl_reg_loss: 146015.7417; val_edge_recon_loss: 2790404.7667; val_gene_expr_recon_loss: 35153454.4000; val_masked_gp_l1_reg_loss: 110953.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106266.8203; val_chrom_access_recon_loss: 14981865.8000; val_global_loss: 53288959.7333; val_optim_loss: 53288959.7333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9718; val_auprc_score: 0.9629; val_best_acc_score: 0.9181; val_best_f1_score: 0.9202; train_kl_reg_loss: 142768.1573; train_edge_recon_loss: 2773681.4790; train_gene_expr_recon_loss: 34499101.3740; train_masked_gp_l1_reg_loss: 112045.5896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104445.0156; train_chrom_access_recon_loss: 14590415.8855; train_global_loss: 52222457.4046; train_optim_loss: 52222457.4046; val_kl_reg_loss: 141296.8219; val_edge_recon_loss: 2781308.6667; val_gene_expr_recon_loss: 35003857.0667; val_masked_gp_l1_reg_loss: 113121.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102562.3516; val_chrom_access_recon_loss: 14912172.4000; val_global_loss: 53054319.4667; val_optim_loss: 53054319.4667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9698; val_auprc_score: 0.9647; val_best_acc_score: 0.9122; val_best_f1_score: 0.9146; train_kl_reg_loss: 140428.2870; train_edge_recon_loss: 2767568.2366; train_gene_expr_recon_loss: 34398013.2977; train_masked_gp_l1_reg_loss: 114311.2559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100849.1855; train_chrom_access_recon_loss: 14555580.6870; train_global_loss: 52076750.9618; train_optim_loss: 52076750.9618; val_kl_reg_loss: 137206.9375; val_edge_recon_loss: 2795086.5833; val_gene_expr_recon_loss: 35069766.9333; val_masked_gp_l1_reg_loss: 115411.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99214.0234; val_chrom_access_recon_loss: 14920428.8000; val_global_loss: 53137117.0667; val_optim_loss: 53137117.0667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9730; val_auprc_score: 0.9675; val_best_acc_score: 0.9219; val_best_f1_score: 0.9244; train_kl_reg_loss: 138944.2866; train_edge_recon_loss: 2766242.2538; train_gene_expr_recon_loss: 34324926.3969; train_masked_gp_l1_reg_loss: 116459.6304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97600.2674; train_chrom_access_recon_loss: 14540073.1832; train_global_loss: 51984245.7710; train_optim_loss: 51984245.7710; val_kl_reg_loss: 136863.7687; val_edge_recon_loss: 2769837.2500; val_gene_expr_recon_loss: 34898306.6667; val_masked_gp_l1_reg_loss: 118015.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96034.0000; val_chrom_access_recon_loss: 14938030.8000; val_global_loss: 52957087.2000; val_optim_loss: 52957087.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9765; val_auprc_score: 0.9726; val_best_acc_score: 0.9251; val_best_f1_score: 0.9271; train_kl_reg_loss: 136514.2031; train_edge_recon_loss: 2763386.3378; train_gene_expr_recon_loss: 34253841.4809; train_masked_gp_l1_reg_loss: 118771.2459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94647.5142; train_chrom_access_recon_loss: 14523131.2595; train_global_loss: 51890292.0916; train_optim_loss: 51890292.0916; val_kl_reg_loss: 136046.3208; val_edge_recon_loss: 2778206.0500; val_gene_expr_recon_loss: 34980988.8000; val_masked_gp_l1_reg_loss: 119578.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93195.3828; val_chrom_access_recon_loss: 14917484.0667; val_global_loss: 53025501.6000; val_optim_loss: 53025501.6000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9753; val_auprc_score: 0.9702; val_best_acc_score: 0.9225; val_best_f1_score: 0.9256; train_kl_reg_loss: 136001.5574; train_edge_recon_loss: 2753480.6832; train_gene_expr_recon_loss: 34186716.5038; train_masked_gp_l1_reg_loss: 120690.2762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91855.5050; train_chrom_access_recon_loss: 14502772.7634; train_global_loss: 51791517.3130; train_optim_loss: 51791517.3130; val_kl_reg_loss: 133706.4120; val_edge_recon_loss: 2773298.0333; val_gene_expr_recon_loss: 34718258.8000; val_masked_gp_l1_reg_loss: 121794.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90563.7578; val_chrom_access_recon_loss: 14816200.4667; val_global_loss: 52653823.2000; val_optim_loss: 52653823.2000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9752; val_auprc_score: 0.9703; val_best_acc_score: 0.9256; val_best_f1_score: 0.9276; train_kl_reg_loss: 134647.7100; train_edge_recon_loss: 2757392.4179; train_gene_expr_recon_loss: 34120705.7252; train_masked_gp_l1_reg_loss: 122791.6293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89332.8628; train_chrom_access_recon_loss: 14504079.8855; train_global_loss: 51728949.8626; train_optim_loss: 51728949.8626; val_kl_reg_loss: 134567.2896; val_edge_recon_loss: 2753018.7833; val_gene_expr_recon_loss: 34758145.6000; val_masked_gp_l1_reg_loss: 123780.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88058.5938; val_chrom_access_recon_loss: 14836760.9333; val_global_loss: 52694332.0000; val_optim_loss: 52694332.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9770; val_auprc_score: 0.9736; val_best_acc_score: 0.9279; val_best_f1_score: 0.9296; train_kl_reg_loss: 132613.8331; train_edge_recon_loss: 2756565.1718; train_gene_expr_recon_loss: 34079060.0153; train_masked_gp_l1_reg_loss: 124977.0256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86936.1507; train_chrom_access_recon_loss: 14501882.1908; train_global_loss: 51682034.2595; train_optim_loss: 51682034.2595; val_kl_reg_loss: 131754.4828; val_edge_recon_loss: 2772990.5833; val_gene_expr_recon_loss: 34809828.5333; val_masked_gp_l1_reg_loss: 125892.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85824.3906; val_chrom_access_recon_loss: 14939191.7333; val_global_loss: 52865481.0667; val_optim_loss: 52865481.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9743; val_auprc_score: 0.9676; val_best_acc_score: 0.9194; val_best_f1_score: 0.9208; train_kl_reg_loss: 147272.6753; train_edge_recon_loss: 2837265.4084; train_gene_expr_recon_loss: 36228574.7786; train_masked_gp_l1_reg_loss: 126387.5799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90478.1701; train_chrom_access_recon_loss: 14796951.6947; train_global_loss: 54226930.0458; train_optim_loss: 54226930.0458; val_kl_reg_loss: 60220.5589; val_edge_recon_loss: 2796523.3667; val_gene_expr_recon_loss: 36568067.2000; val_masked_gp_l1_reg_loss: 126750.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91812.9297; val_chrom_access_recon_loss: 15097130.6667; val_global_loss: 54740506.4000; val_optim_loss: 54740506.4000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9760; val_auprc_score: 0.9721; val_best_acc_score: 0.9229; val_best_f1_score: 0.9251; train_kl_reg_loss: 138159.9693; train_edge_recon_loss: 2792962.5267; train_gene_expr_recon_loss: 35842865.1908; train_masked_gp_l1_reg_loss: 126558.1690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91173.8151; train_chrom_access_recon_loss: 14740746.4198; train_global_loss: 53732465.9542; train_optim_loss: 53732465.9542; val_kl_reg_loss: 70860.8870; val_edge_recon_loss: 2765944.3500; val_gene_expr_recon_loss: 36490079.7333; val_masked_gp_l1_reg_loss: 126086.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90028.5781; val_chrom_access_recon_loss: 15185550.5333; val_global_loss: 54728552.0000; val_optim_loss: 54728552.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9735; val_auprc_score: 0.9670; val_best_acc_score: 0.9225; val_best_f1_score: 0.9247; train_kl_reg_loss: 129642.4505; train_edge_recon_loss: 2766767.0821; train_gene_expr_recon_loss: 35707827.5115; train_masked_gp_l1_reg_loss: 125726.1604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89762.0458; train_chrom_access_recon_loss: 14702231.7252; train_global_loss: 53521956.5802; train_optim_loss: 53521956.5802; val_kl_reg_loss: 73926.2620; val_edge_recon_loss: 2777899.9333; val_gene_expr_recon_loss: 36325221.6000; val_masked_gp_l1_reg_loss: 125558.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89508.6172; val_chrom_access_recon_loss: 15087647.7333; val_global_loss: 54479763.2000; val_optim_loss: 54479763.2000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9738; val_auprc_score: 0.9660; val_best_acc_score: 0.9252; val_best_f1_score: 0.9273; train_kl_reg_loss: 128709.6889; train_edge_recon_loss: 2758387.3817; train_gene_expr_recon_loss: 35688303.6947; train_masked_gp_l1_reg_loss: 125453.2300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89278.8652; train_chrom_access_recon_loss: 14706426.0992; train_global_loss: 53496558.9924; train_optim_loss: 53496558.9924; val_kl_reg_loss: 75745.5813; val_edge_recon_loss: 2763867.6667; val_gene_expr_recon_loss: 36274731.7333; val_masked_gp_l1_reg_loss: 125341.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89060.0312; val_chrom_access_recon_loss: 15044866.0000; val_global_loss: 54373610.6667; val_optim_loss: 54373610.6667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9751; val_auprc_score: 0.9706; val_best_acc_score: 0.9212; val_best_f1_score: 0.9246; train_kl_reg_loss: 127088.6556; train_edge_recon_loss: 2759291.0573; train_gene_expr_recon_loss: 35680033.0992; train_masked_gp_l1_reg_loss: 125223.7343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88834.1463; train_chrom_access_recon_loss: 14713264.8168; train_global_loss: 53493735.5420; train_optim_loss: 53493735.5420; val_kl_reg_loss: 77353.6464; val_edge_recon_loss: 2778837.7667; val_gene_expr_recon_loss: 36208223.4667; val_masked_gp_l1_reg_loss: 125111.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88597.4219; val_chrom_access_recon_loss: 15028264.8000; val_global_loss: 54306386.9333; val_optim_loss: 54306386.9333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9735; val_auprc_score: 0.9676; val_best_acc_score: 0.9233; val_best_f1_score: 0.9257; train_kl_reg_loss: 125453.6353; train_edge_recon_loss: 2749286.4561; train_gene_expr_recon_loss: 35664548.4580; train_masked_gp_l1_reg_loss: 124994.1885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88360.5491; train_chrom_access_recon_loss: 14706798.0840; train_global_loss: 53459441.8015; train_optim_loss: 53459441.8015; val_kl_reg_loss: 79348.8521; val_edge_recon_loss: 2768808.7333; val_gene_expr_recon_loss: 36314310.1333; val_masked_gp_l1_reg_loss: 124868.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88116.9219; val_chrom_access_recon_loss: 15068908.0000; val_global_loss: 54444359.7333; val_optim_loss: 54444359.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 25 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9761
val AUPRC score: 0.9721
val best accuracy score: 0.9248
val best F1 score: 0.9269
val target rna MSE score: 1.5621
val source rna MSE score: 40.9372
val target atac MSE score: 0.3701
val source atac MSE score: 3.3319
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
