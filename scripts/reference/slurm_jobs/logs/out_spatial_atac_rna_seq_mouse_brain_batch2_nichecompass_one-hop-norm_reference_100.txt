[True]
Run timestamp: 26072023_030453_100.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_100']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9047; val_auprc_score: 0.9157; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6992.8564; train_edge_recon_loss: 3487138.8611; train_gene_expr_recon_loss: 31394743.5556; train_masked_gp_l1_reg_loss: 1925.4988; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10777361.2222; train_global_loss: 45668162.2222; train_optim_loss: 45668162.2222; val_kl_reg_loss: 39730.0859; val_edge_recon_loss: 4065870.7500; val_gene_expr_recon_loss: 29525588.0000; val_masked_gp_l1_reg_loss: 1994.3198; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10522499.0000; val_global_loss: 44155684.0000; val_optim_loss: 44155684.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8895; val_auprc_score: 0.8988; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 59255.3186; train_edge_recon_loss: 3557556.2500; train_gene_expr_recon_loss: 28619716.0000; train_masked_gp_l1_reg_loss: 2101.2643; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10709255.4444; train_global_loss: 42947884.4444; train_optim_loss: 42947884.4444; val_kl_reg_loss: 66985.0547; val_edge_recon_loss: 4066005.0000; val_gene_expr_recon_loss: 26575536.0000; val_masked_gp_l1_reg_loss: 2251.6318; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10301246.0000; val_global_loss: 41012024.0000; val_optim_loss: 41012024.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8763; val_auprc_score: 0.8864; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 105194.3003; train_edge_recon_loss: 3622366.8333; train_gene_expr_recon_loss: 25910298.0000; train_masked_gp_l1_reg_loss: 2375.0812; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10369964.4444; train_global_loss: 40010198.6667; train_optim_loss: 40010198.6667; val_kl_reg_loss: 77327.1953; val_edge_recon_loss: 4065948.5000; val_gene_expr_recon_loss: 24567272.0000; val_masked_gp_l1_reg_loss: 2519.0640; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10082768.0000; val_global_loss: 38795836.0000; val_optim_loss: 38795836.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8709; val_auprc_score: 0.8792; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 137840.2917; train_edge_recon_loss: 3661927.4722; train_gene_expr_recon_loss: 24334207.7778; train_masked_gp_l1_reg_loss: 2598.1056; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10214451.7778; train_global_loss: 38351025.3333; train_optim_loss: 38351025.3333; val_kl_reg_loss: 123306.3125; val_edge_recon_loss: 4065945.7500; val_gene_expr_recon_loss: 23489444.0000; val_masked_gp_l1_reg_loss: 2672.6904; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9935250.0000; val_global_loss: 37616616.0000; val_optim_loss: 37616616.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8651; val_auprc_score: 0.8720; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 170122.0677; train_edge_recon_loss: 3656426.2222; train_gene_expr_recon_loss: 23328663.3333; train_masked_gp_l1_reg_loss: 2704.8939; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10083935.3333; train_global_loss: 37241851.5556; train_optim_loss: 37241851.5556; val_kl_reg_loss: 141148.7188; val_edge_recon_loss: 4065815.0000; val_gene_expr_recon_loss: 22589040.0000; val_masked_gp_l1_reg_loss: 2735.0605; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9840306.0000; val_global_loss: 36639048.0000; val_optim_loss: 36639048.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8666; val_auprc_score: 0.8694; val_best_acc_score: 0.5040; val_best_f1_score: 0.6685; train_kl_reg_loss: 189116.1059; train_edge_recon_loss: 3655588.8611; train_gene_expr_recon_loss: 22584177.7778; train_masked_gp_l1_reg_loss: 2748.5203; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9951702.3333; train_global_loss: 36383333.3333; train_optim_loss: 36383333.3333; val_kl_reg_loss: 186064.2812; val_edge_recon_loss: 4065677.5000; val_gene_expr_recon_loss: 21943638.0000; val_masked_gp_l1_reg_loss: 2758.2500; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9749851.0000; val_global_loss: 35947988.0000; val_optim_loss: 35947988.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8627; val_auprc_score: 0.8610; val_best_acc_score: 0.5082; val_best_f1_score: 0.6703; train_kl_reg_loss: 220148.6667; train_edge_recon_loss: 3651268.8611; train_gene_expr_recon_loss: 21961868.0000; train_masked_gp_l1_reg_loss: 2757.5859; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9884847.3333; train_global_loss: 35720889.3333; train_optim_loss: 35720889.3333; val_kl_reg_loss: 147896.7812; val_edge_recon_loss: 4065359.5000; val_gene_expr_recon_loss: 21568452.0000; val_masked_gp_l1_reg_loss: 2753.9653; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9701288.0000; val_global_loss: 35485752.0000; val_optim_loss: 35485752.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8742; val_auprc_score: 0.8728; val_best_acc_score: 0.5031; val_best_f1_score: 0.6680; train_kl_reg_loss: 202238.9844; train_edge_recon_loss: 3662816.9167; train_gene_expr_recon_loss: 21724288.2222; train_masked_gp_l1_reg_loss: 2752.4309; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9895296.5556; train_global_loss: 35487392.4444; train_optim_loss: 35487392.4444; val_kl_reg_loss: 165376.6719; val_edge_recon_loss: 4065477.5000; val_gene_expr_recon_loss: 21339786.0000; val_masked_gp_l1_reg_loss: 2751.2568; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9678769.0000; val_global_loss: 35252160.0000; val_optim_loss: 35252160.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8779; val_auprc_score: 0.8731; val_best_acc_score: 0.5089; val_best_f1_score: 0.6706; train_kl_reg_loss: 211111.8108; train_edge_recon_loss: 3644051.0278; train_gene_expr_recon_loss: 21430297.3333; train_masked_gp_l1_reg_loss: 2750.2886; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9814457.4444; train_global_loss: 35102667.1111; train_optim_loss: 35102667.1111; val_kl_reg_loss: 204462.0312; val_edge_recon_loss: 4065024.5000; val_gene_expr_recon_loss: 21165992.0000; val_masked_gp_l1_reg_loss: 2748.6365; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9646523.0000; val_global_loss: 35084748.0000; val_optim_loss: 35084748.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8755; val_auprc_score: 0.8684; val_best_acc_score: 0.5201; val_best_f1_score: 0.6755; train_kl_reg_loss: 214949.1875; train_edge_recon_loss: 3636480.0556; train_gene_expr_recon_loss: 21498468.0000; train_masked_gp_l1_reg_loss: 2749.3398; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9854022.6667; train_global_loss: 35206669.7778; train_optim_loss: 35206669.7778; val_kl_reg_loss: 159251.2812; val_edge_recon_loss: 4064129.2500; val_gene_expr_recon_loss: 21016860.0000; val_masked_gp_l1_reg_loss: 2750.4883; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9624605.0000; val_global_loss: 34867596.0000; val_optim_loss: 34867596.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8748; val_auprc_score: 0.8650; val_best_acc_score: 0.5395; val_best_f1_score: 0.6842; train_kl_reg_loss: 207459.8524; train_edge_recon_loss: 3631727.0278; train_gene_expr_recon_loss: 21247920.6667; train_masked_gp_l1_reg_loss: 2754.0606; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9795706.0000; train_global_loss: 34885568.0000; train_optim_loss: 34885568.0000; val_kl_reg_loss: 181656.7969; val_edge_recon_loss: 4062927.2500; val_gene_expr_recon_loss: 20932346.0000; val_masked_gp_l1_reg_loss: 2758.4829; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9606602.0000; val_global_loss: 34786288.0000; val_optim_loss: 34786288.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8826; val_auprc_score: 0.8733; val_best_acc_score: 0.5742; val_best_f1_score: 0.7000; train_kl_reg_loss: 207314.1597; train_edge_recon_loss: 3620522.3611; train_gene_expr_recon_loss: 21136308.6667; train_masked_gp_l1_reg_loss: 2763.2988; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9757850.6667; train_global_loss: 34724759.5556; train_optim_loss: 34724759.5556; val_kl_reg_loss: 190970.6250; val_edge_recon_loss: 4060720.7500; val_gene_expr_recon_loss: 20906286.0000; val_masked_gp_l1_reg_loss: 2768.7637; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9603347.0000; val_global_loss: 34764092.0000; val_optim_loss: 34764092.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8906; val_auprc_score: 0.8831; val_best_acc_score: 0.6136; val_best_f1_score: 0.7190; train_kl_reg_loss: 206731.4514; train_edge_recon_loss: 3607827.2222; train_gene_expr_recon_loss: 21185637.7778; train_masked_gp_l1_reg_loss: 2773.0310; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9757067.1111; train_global_loss: 34760036.8889; train_optim_loss: 34760036.8889; val_kl_reg_loss: 171949.6562; val_edge_recon_loss: 4058058.2500; val_gene_expr_recon_loss: 20821032.0000; val_masked_gp_l1_reg_loss: 2778.6431; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9578243.0000; val_global_loss: 34632060.0000; val_optim_loss: 34632060.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8961; val_auprc_score: 0.8847; val_best_acc_score: 0.6626; val_best_f1_score: 0.7444; train_kl_reg_loss: 199984.7240; train_edge_recon_loss: 3605205.5556; train_gene_expr_recon_loss: 21045560.6667; train_masked_gp_l1_reg_loss: 2784.3957; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9713117.6667; train_global_loss: 34566653.7778; train_optim_loss: 34566653.7778; val_kl_reg_loss: 165834.5312; val_edge_recon_loss: 4054391.0000; val_gene_expr_recon_loss: 20760058.0000; val_masked_gp_l1_reg_loss: 2791.6743; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9568759.0000; val_global_loss: 34551836.0000; val_optim_loss: 34551836.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9066; val_auprc_score: 0.8975; val_best_acc_score: 0.7214; val_best_f1_score: 0.7776; train_kl_reg_loss: 194382.5729; train_edge_recon_loss: 3599423.8611; train_gene_expr_recon_loss: 21093590.2222; train_masked_gp_l1_reg_loss: 2797.2460; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9750071.5556; train_global_loss: 34640265.3333; train_optim_loss: 34640265.3333; val_kl_reg_loss: 172102.1875; val_edge_recon_loss: 4048552.0000; val_gene_expr_recon_loss: 20720474.0000; val_masked_gp_l1_reg_loss: 2805.7141; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9563289.0000; val_global_loss: 34507224.0000; val_optim_loss: 34507224.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9060; val_auprc_score: 0.8933; val_best_acc_score: 0.7708; val_best_f1_score: 0.8073; train_kl_reg_loss: 192188.8090; train_edge_recon_loss: 3591146.7500; train_gene_expr_recon_loss: 20949888.4444; train_masked_gp_l1_reg_loss: 2814.1468; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9720695.8889; train_global_loss: 34456733.3333; train_optim_loss: 34456733.3333; val_kl_reg_loss: 152067.4375; val_edge_recon_loss: 4040681.7500; val_gene_expr_recon_loss: 20682038.0000; val_masked_gp_l1_reg_loss: 2823.5388; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9541740.0000; val_global_loss: 34419352.0000; val_optim_loss: 34419352.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9140; val_auprc_score: 0.9042; val_best_acc_score: 0.8036; val_best_f1_score: 0.8272; train_kl_reg_loss: 183977.7552; train_edge_recon_loss: 3591556.9722; train_gene_expr_recon_loss: 20856006.6667; train_masked_gp_l1_reg_loss: 2832.6184; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9709130.0000; train_global_loss: 34343504.4444; train_optim_loss: 34343504.4444; val_kl_reg_loss: 162705.2969; val_edge_recon_loss: 4030620.5000; val_gene_expr_recon_loss: 20630746.0000; val_masked_gp_l1_reg_loss: 2841.3669; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9533464.0000; val_global_loss: 34360376.0000; val_optim_loss: 34360376.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9179; val_auprc_score: 0.9033; val_best_acc_score: 0.8403; val_best_f1_score: 0.8514; train_kl_reg_loss: 184805.3281; train_edge_recon_loss: 3577001.5556; train_gene_expr_recon_loss: 20849957.7778; train_masked_gp_l1_reg_loss: 2848.1957; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9697676.5556; train_global_loss: 34312290.2222; train_optim_loss: 34312290.2222; val_kl_reg_loss: 152600.6250; val_edge_recon_loss: 4016180.0000; val_gene_expr_recon_loss: 20581320.0000; val_masked_gp_l1_reg_loss: 2855.9778; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9517600.0000; val_global_loss: 34270556.0000; val_optim_loss: 34270556.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9195; val_auprc_score: 0.9055; val_best_acc_score: 0.8507; val_best_f1_score: 0.8546; train_kl_reg_loss: 175772.6094; train_edge_recon_loss: 3573580.2222; train_gene_expr_recon_loss: 20652274.4444; train_masked_gp_l1_reg_loss: 2862.0933; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9654524.8889; train_global_loss: 34059014.2222; train_optim_loss: 34059014.2222; val_kl_reg_loss: 166970.6406; val_edge_recon_loss: 3999078.0000; val_gene_expr_recon_loss: 20553068.0000; val_masked_gp_l1_reg_loss: 2869.2332; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9517950.0000; val_global_loss: 34239936.0000; val_optim_loss: 34239936.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9179; val_auprc_score: 0.9032; val_best_acc_score: 0.8398; val_best_f1_score: 0.8358; train_kl_reg_loss: 177120.5556; train_edge_recon_loss: 3559810.2778; train_gene_expr_recon_loss: 20786270.2222; train_masked_gp_l1_reg_loss: 2874.6847; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9684467.7778; train_global_loss: 34210543.5556; train_optim_loss: 34210543.5556; val_kl_reg_loss: 131421.0156; val_edge_recon_loss: 3970230.2500; val_gene_expr_recon_loss: 20549770.0000; val_masked_gp_l1_reg_loss: 2881.8501; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9520351.0000; val_global_loss: 34174656.0000; val_optim_loss: 34174656.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9173; val_auprc_score: 0.9006; val_best_acc_score: 0.8235; val_best_f1_score: 0.8193; train_kl_reg_loss: 164061.4931; train_edge_recon_loss: 3560673.2222; train_gene_expr_recon_loss: 20627580.8889; train_masked_gp_l1_reg_loss: 2888.3289; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9649014.7778; train_global_loss: 34004219.3333; train_optim_loss: 34004219.3333; val_kl_reg_loss: 159475.3438; val_edge_recon_loss: 3936362.2500; val_gene_expr_recon_loss: 20491848.0000; val_masked_gp_l1_reg_loss: 2896.6011; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9496578.0000; val_global_loss: 34087160.0000; val_optim_loss: 34087160.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9161; val_auprc_score: 0.8977; val_best_acc_score: 0.8134; val_best_f1_score: 0.8371; train_kl_reg_loss: 168006.8038; train_edge_recon_loss: 3534926.6667; train_gene_expr_recon_loss: 20652008.4444; train_masked_gp_l1_reg_loss: 2903.0154; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9650862.7778; train_global_loss: 34008707.5556; train_optim_loss: 34008707.5556; val_kl_reg_loss: 136474.2812; val_edge_recon_loss: 3887680.5000; val_gene_expr_recon_loss: 20482810.0000; val_masked_gp_l1_reg_loss: 2910.7471; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9502293.0000; val_global_loss: 34012168.0000; val_optim_loss: 34012168.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9148; val_auprc_score: 0.8920; val_best_acc_score: 0.8362; val_best_f1_score: 0.8509; train_kl_reg_loss: 155263.4757; train_edge_recon_loss: 3523927.7778; train_gene_expr_recon_loss: 20693094.6667; train_masked_gp_l1_reg_loss: 2918.8289; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9659314.7778; train_global_loss: 34034519.5556; train_optim_loss: 34034519.5556; val_kl_reg_loss: 135598.8125; val_edge_recon_loss: 3821509.0000; val_gene_expr_recon_loss: 20442108.0000; val_masked_gp_l1_reg_loss: 2929.2129; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9480332.0000; val_global_loss: 33882480.0000; val_optim_loss: 33882480.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9164; val_auprc_score: 0.8963; val_best_acc_score: 0.8437; val_best_f1_score: 0.8527; train_kl_reg_loss: 153347.3021; train_edge_recon_loss: 3488815.6111; train_gene_expr_recon_loss: 20602522.6667; train_masked_gp_l1_reg_loss: 2938.1621; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9663323.3333; train_global_loss: 33910946.6667; train_optim_loss: 33910946.6667; val_kl_reg_loss: 128869.3984; val_edge_recon_loss: 3725873.5000; val_gene_expr_recon_loss: 20418090.0000; val_masked_gp_l1_reg_loss: 2947.5239; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9461945.0000; val_global_loss: 33737724.0000; val_optim_loss: 33737724.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9197; val_auprc_score: 0.9028; val_best_acc_score: 0.8449; val_best_f1_score: 0.8507; train_kl_reg_loss: 143514.3498; train_edge_recon_loss: 3450846.6389; train_gene_expr_recon_loss: 20650757.5556; train_masked_gp_l1_reg_loss: 2954.3606; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9613833.6667; train_global_loss: 33861907.1111; train_optim_loss: 33861907.1111; val_kl_reg_loss: 124253.2422; val_edge_recon_loss: 3592701.7500; val_gene_expr_recon_loss: 20426390.0000; val_masked_gp_l1_reg_loss: 2964.1882; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9477648.0000; val_global_loss: 33623956.0000; val_optim_loss: 33623956.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9213; val_auprc_score: 0.9025; val_best_acc_score: 0.8401; val_best_f1_score: 0.8527; train_kl_reg_loss: 156172.7752; train_edge_recon_loss: 3566806.1944; train_gene_expr_recon_loss: 21152360.0000; train_masked_gp_l1_reg_loss: 2975.8181; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9626266.1111; train_global_loss: 34504580.4444; train_optim_loss: 34504580.4444; val_kl_reg_loss: 61938.9570; val_edge_recon_loss: 3721010.7500; val_gene_expr_recon_loss: 20840670.0000; val_masked_gp_l1_reg_loss: 2999.4780; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9514961.0000; val_global_loss: 34141580.0000; val_optim_loss: 34141580.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9111; val_auprc_score: 0.8980; val_best_acc_score: 0.8077; val_best_f1_score: 0.8274; train_kl_reg_loss: 109761.3056; train_edge_recon_loss: 3616709.4722; train_gene_expr_recon_loss: 21225686.0000; train_masked_gp_l1_reg_loss: 3037.0527; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9777808.3333; train_global_loss: 34733003.1111; train_optim_loss: 34733003.1111; val_kl_reg_loss: 67720.3750; val_edge_recon_loss: 3872953.7500; val_gene_expr_recon_loss: 20707308.0000; val_masked_gp_l1_reg_loss: 3085.6123; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9500340.0000; val_global_loss: 34151408.0000; val_optim_loss: 34151408.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9099; val_auprc_score: 0.8978; val_best_acc_score: 0.8033; val_best_f1_score: 0.8260; train_kl_reg_loss: 71539.4141; train_edge_recon_loss: 3681130.8611; train_gene_expr_recon_loss: 21285954.2222; train_masked_gp_l1_reg_loss: 3124.9123; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9762659.6667; train_global_loss: 34804409.3333; train_optim_loss: 34804409.3333; val_kl_reg_loss: 54516.6094; val_edge_recon_loss: 3873274.5000; val_gene_expr_recon_loss: 20875830.0000; val_masked_gp_l1_reg_loss: 3179.2908; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9526033.0000; val_global_loss: 34332832.0000; val_optim_loss: 34332832.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9010; val_auprc_score: 0.8845; val_best_acc_score: 0.8085; val_best_f1_score: 0.8129; train_kl_reg_loss: 89506.2704; train_edge_recon_loss: 3628778.2222; train_gene_expr_recon_loss: 20880892.8889; train_masked_gp_l1_reg_loss: 3223.0364; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9632725.1111; train_global_loss: 34235125.3333; train_optim_loss: 34235125.3333; val_kl_reg_loss: 75284.3125; val_edge_recon_loss: 3916861.5000; val_gene_expr_recon_loss: 20593914.0000; val_masked_gp_l1_reg_loss: 3266.4473; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9471190.0000; val_global_loss: 34060516.0000; val_optim_loss: 34060516.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9088; val_auprc_score: 0.8970; val_best_acc_score: 0.8168; val_best_f1_score: 0.8152; train_kl_reg_loss: 89610.3203; train_edge_recon_loss: 3625476.5000; train_gene_expr_recon_loss: 20867912.4444; train_masked_gp_l1_reg_loss: 3268.5332; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9648707.1111; train_global_loss: 34234974.2222; train_optim_loss: 34234974.2222; val_kl_reg_loss: 81451.5781; val_edge_recon_loss: 3907304.5000; val_gene_expr_recon_loss: 20581150.0000; val_masked_gp_l1_reg_loss: 3270.7202; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9477319.0000; val_global_loss: 34050496.0000; val_optim_loss: 34050496.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9040; val_auprc_score: 0.8872; val_best_acc_score: 0.8100; val_best_f1_score: 0.8208; train_kl_reg_loss: 100137.7378; train_edge_recon_loss: 3621560.7500; train_gene_expr_recon_loss: 20859646.4444; train_masked_gp_l1_reg_loss: 3271.8812; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9705921.8889; train_global_loss: 34290537.7778; train_optim_loss: 34290537.7778; val_kl_reg_loss: 85784.8281; val_edge_recon_loss: 3901378.7500; val_gene_expr_recon_loss: 20556524.0000; val_masked_gp_l1_reg_loss: 3272.9749; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9474929.0000; val_global_loss: 34021888.0000; val_optim_loss: 34021888.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9066; val_auprc_score: 0.8884; val_best_acc_score: 0.8103; val_best_f1_score: 0.8185; train_kl_reg_loss: 98279.8568; train_edge_recon_loss: 3606424.7222; train_gene_expr_recon_loss: 20839911.7778; train_masked_gp_l1_reg_loss: 3273.3089; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9652101.3333; train_global_loss: 34199992.4444; train_optim_loss: 34199992.4444; val_kl_reg_loss: 87929.1719; val_edge_recon_loss: 3904839.5000; val_gene_expr_recon_loss: 20550410.0000; val_masked_gp_l1_reg_loss: 3273.7771; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9476815.0000; val_global_loss: 34023268.0000; val_optim_loss: 34023268.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9074; val_auprc_score: 0.8923; val_best_acc_score: 0.8115; val_best_f1_score: 0.8212; train_kl_reg_loss: 101517.1024; train_edge_recon_loss: 3592247.8611; train_gene_expr_recon_loss: 20808710.8889; train_masked_gp_l1_reg_loss: 3274.4337; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9642552.6667; train_global_loss: 34148302.2222; train_optim_loss: 34148302.2222; val_kl_reg_loss: 92071.3750; val_edge_recon_loss: 3901855.7500; val_gene_expr_recon_loss: 20551542.0000; val_masked_gp_l1_reg_loss: 3275.0806; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9472241.0000; val_global_loss: 34020984.0000; val_optim_loss: 34020984.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9282
Val AUPRC score: 0.9163
Val best accuracy score: 0.8430
Val best F1 score: 0.8559
Val gene expr MSE score: 0.4936
Val chrom access MSE score: 0.0843
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
