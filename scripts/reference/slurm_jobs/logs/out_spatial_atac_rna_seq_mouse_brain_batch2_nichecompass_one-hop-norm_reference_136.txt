[True]
Run timestamp: 07082023_213933_136.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_136']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9579; val_auprc_score: 0.9578; val_best_acc_score: 0.8820; val_best_f1_score: 0.8847; train_kl_reg_loss: 4060.3576; train_edge_recon_loss: 3467741.6389; train_gene_expr_recon_loss: 622120.0764; train_masked_gp_l1_reg_loss: 4653.2217; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 264663.2691; train_global_loss: 4363238.5556; train_optim_loss: 4363238.5556; val_kl_reg_loss: 1247.4421; val_edge_recon_loss: 4042745.7500; val_gene_expr_recon_loss: 618636.3125; val_masked_gp_l1_reg_loss: 4105.5156; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 266184.2812; val_global_loss: 4932919.5000; val_optim_loss: 4932919.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9412; val_auprc_score: 0.9325; val_best_acc_score: 0.8711; val_best_f1_score: 0.8743; train_kl_reg_loss: 1186.8311; train_edge_recon_loss: 3459686.2222; train_gene_expr_recon_loss: 607814.5000; train_masked_gp_l1_reg_loss: 3858.2999; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 263913.7934; train_global_loss: 4336459.5556; train_optim_loss: 4336459.5556; val_kl_reg_loss: 934.8275; val_edge_recon_loss: 3817385.5000; val_gene_expr_recon_loss: 599492.6875; val_masked_gp_l1_reg_loss: 3657.7810; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 264662.2188; val_global_loss: 4686133.0000; val_optim_loss: 4686133.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9175; val_auprc_score: 0.9027; val_best_acc_score: 0.8436; val_best_f1_score: 0.8528; train_kl_reg_loss: 2144.7140; train_edge_recon_loss: 3320864.5833; train_gene_expr_recon_loss: 586749.5347; train_masked_gp_l1_reg_loss: 3650.2718; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 263731.5208; train_global_loss: 4177140.6667; train_optim_loss: 4177140.6667; val_kl_reg_loss: 6388.3003; val_edge_recon_loss: 2965505.0000; val_gene_expr_recon_loss: 578699.4375; val_masked_gp_l1_reg_loss: 3672.9272; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 262610.0000; val_global_loss: 3816875.7500; val_optim_loss: 3816875.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9263; val_auprc_score: 0.9104; val_best_acc_score: 0.8615; val_best_f1_score: 0.8705; train_kl_reg_loss: 18751.5671; train_edge_recon_loss: 2804113.2778; train_gene_expr_recon_loss: 577966.6319; train_masked_gp_l1_reg_loss: 3631.6437; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261651.4705; train_global_loss: 3666114.5833; train_optim_loss: 3666114.5833; val_kl_reg_loss: 33733.1445; val_edge_recon_loss: 2729522.5000; val_gene_expr_recon_loss: 584527.6875; val_masked_gp_l1_reg_loss: 3542.2373; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 262492.2812; val_global_loss: 3613818.0000; val_optim_loss: 3613818.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9278; val_auprc_score: 0.9116; val_best_acc_score: 0.8634; val_best_f1_score: 0.8716; train_kl_reg_loss: 39530.8607; train_edge_recon_loss: 2720089.5833; train_gene_expr_recon_loss: 567441.3750; train_masked_gp_l1_reg_loss: 3492.3546; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 260855.2882; train_global_loss: 3591409.5000; train_optim_loss: 3591409.5000; val_kl_reg_loss: 38279.0391; val_edge_recon_loss: 2746080.5000; val_gene_expr_recon_loss: 557710.2500; val_masked_gp_l1_reg_loss: 3462.9812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260009.5156; val_global_loss: 3605542.2500; val_optim_loss: 3605542.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9293; val_auprc_score: 0.9091; val_best_acc_score: 0.8685; val_best_f1_score: 0.8746; train_kl_reg_loss: 35743.9583; train_edge_recon_loss: 2716157.2500; train_gene_expr_recon_loss: 551342.1319; train_masked_gp_l1_reg_loss: 3463.0965; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 257982.5781; train_global_loss: 3564688.9167; train_optim_loss: 3564688.9167; val_kl_reg_loss: 30224.6680; val_edge_recon_loss: 2740965.2500; val_gene_expr_recon_loss: 548228.5000; val_masked_gp_l1_reg_loss: 3464.4668; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 258884.1094; val_global_loss: 3581767.0000; val_optim_loss: 3581767.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9343; val_auprc_score: 0.9131; val_best_acc_score: 0.8764; val_best_f1_score: 0.8841; train_kl_reg_loss: 30382.7908; train_edge_recon_loss: 2711149.1389; train_gene_expr_recon_loss: 541487.4306; train_masked_gp_l1_reg_loss: 3483.7693; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 257182.0365; train_global_loss: 3543685.2222; train_optim_loss: 3543685.2222; val_kl_reg_loss: 30412.1953; val_edge_recon_loss: 2733186.0000; val_gene_expr_recon_loss: 537099.1250; val_masked_gp_l1_reg_loss: 3507.0400; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257480.8594; val_global_loss: 3561685.2500; val_optim_loss: 3561685.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9451; val_auprc_score: 0.9275; val_best_acc_score: 0.8871; val_best_f1_score: 0.8927; train_kl_reg_loss: 31529.1782; train_edge_recon_loss: 2704161.5556; train_gene_expr_recon_loss: 532544.6319; train_masked_gp_l1_reg_loss: 3528.8608; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 255956.6302; train_global_loss: 3527720.8889; train_optim_loss: 3527720.8889; val_kl_reg_loss: 29298.3828; val_edge_recon_loss: 2722838.7500; val_gene_expr_recon_loss: 530288.1875; val_masked_gp_l1_reg_loss: 3557.7576; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256340.6250; val_global_loss: 3542324.0000; val_optim_loss: 3542324.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9452; val_auprc_score: 0.9272; val_best_acc_score: 0.8863; val_best_f1_score: 0.8926; train_kl_reg_loss: 29699.9562; train_edge_recon_loss: 2700562.5556; train_gene_expr_recon_loss: 523324.3750; train_masked_gp_l1_reg_loss: 3580.3021; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 255311.3038; train_global_loss: 3512478.4722; train_optim_loss: 3512478.4722; val_kl_reg_loss: 27194.3145; val_edge_recon_loss: 2716889.7500; val_gene_expr_recon_loss: 528099.2500; val_masked_gp_l1_reg_loss: 3613.4548; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 255629.9375; val_global_loss: 3531426.7500; val_optim_loss: 3531426.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9553; val_auprc_score: 0.9383; val_best_acc_score: 0.9020; val_best_f1_score: 0.9070; train_kl_reg_loss: 28167.3023; train_edge_recon_loss: 2696292.7222; train_gene_expr_recon_loss: 518836.2431; train_masked_gp_l1_reg_loss: 3645.7850; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254113.0069; train_global_loss: 3501055.0556; train_optim_loss: 3501055.0556; val_kl_reg_loss: 26784.2695; val_edge_recon_loss: 2693492.5000; val_gene_expr_recon_loss: 514530.3125; val_masked_gp_l1_reg_loss: 3683.0007; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 254257.2969; val_global_loss: 3492747.2500; val_optim_loss: 3492747.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9557; val_auprc_score: 0.9386; val_best_acc_score: 0.9061; val_best_f1_score: 0.9109; train_kl_reg_loss: 27820.8947; train_edge_recon_loss: 2680759.2500; train_gene_expr_recon_loss: 510956.6736; train_masked_gp_l1_reg_loss: 3723.7902; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 253227.0625; train_global_loss: 3476487.6667; train_optim_loss: 3476487.6667; val_kl_reg_loss: 26564.5703; val_edge_recon_loss: 2670568.5000; val_gene_expr_recon_loss: 508167.1250; val_masked_gp_l1_reg_loss: 3768.7373; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253239.6250; val_global_loss: 3462308.5000; val_optim_loss: 3462308.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9571; val_auprc_score: 0.9398; val_best_acc_score: 0.9039; val_best_f1_score: 0.9076; train_kl_reg_loss: 28484.1988; train_edge_recon_loss: 2672110.6389; train_gene_expr_recon_loss: 505477.6493; train_masked_gp_l1_reg_loss: 3805.4687; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251417.7083; train_global_loss: 3461295.6667; train_optim_loss: 3461295.6667; val_kl_reg_loss: 27577.0645; val_edge_recon_loss: 2686246.7500; val_gene_expr_recon_loss: 507510.0625; val_masked_gp_l1_reg_loss: 3843.0310; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252778.0000; val_global_loss: 3477954.7500; val_optim_loss: 3477954.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9624; val_auprc_score: 0.9503; val_best_acc_score: 0.9084; val_best_f1_score: 0.9116; train_kl_reg_loss: 29347.4470; train_edge_recon_loss: 2667128.6944; train_gene_expr_recon_loss: 499801.8576; train_masked_gp_l1_reg_loss: 3879.3382; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250686.1337; train_global_loss: 3450843.4444; train_optim_loss: 3450843.4444; val_kl_reg_loss: 28709.8047; val_edge_recon_loss: 2666132.5000; val_gene_expr_recon_loss: 506018.8438; val_masked_gp_l1_reg_loss: 3918.6863; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252033.6406; val_global_loss: 3456813.5000; val_optim_loss: 3456813.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9608; val_auprc_score: 0.9434; val_best_acc_score: 0.9091; val_best_f1_score: 0.9135; train_kl_reg_loss: 29150.8596; train_edge_recon_loss: 2662519.5278; train_gene_expr_recon_loss: 493446.4167; train_masked_gp_l1_reg_loss: 3957.6239; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248915.3681; train_global_loss: 3437989.7778; train_optim_loss: 3437989.7778; val_kl_reg_loss: 28009.8105; val_edge_recon_loss: 2681318.0000; val_gene_expr_recon_loss: 497250.9688; val_masked_gp_l1_reg_loss: 3995.4111; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250892.3125; val_global_loss: 3461466.5000; val_optim_loss: 3461466.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9643; val_auprc_score: 0.9501; val_best_acc_score: 0.9151; val_best_f1_score: 0.9186; train_kl_reg_loss: 29688.3889; train_edge_recon_loss: 2654185.8889; train_gene_expr_recon_loss: 491386.0868; train_masked_gp_l1_reg_loss: 4024.7942; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249720.8576; train_global_loss: 3429006.0000; train_optim_loss: 3429006.0000; val_kl_reg_loss: 28086.2188; val_edge_recon_loss: 2663365.2500; val_gene_expr_recon_loss: 492618.2812; val_masked_gp_l1_reg_loss: 4052.4707; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250399.4062; val_global_loss: 3438521.7500; val_optim_loss: 3438521.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9623; val_auprc_score: 0.9479; val_best_acc_score: 0.9131; val_best_f1_score: 0.9161; train_kl_reg_loss: 28147.1356; train_edge_recon_loss: 2662486.1111; train_gene_expr_recon_loss: 487724.7257; train_masked_gp_l1_reg_loss: 4082.1294; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247995.1198; train_global_loss: 3430435.2222; train_optim_loss: 3430435.2222; val_kl_reg_loss: 26540.5508; val_edge_recon_loss: 2668055.5000; val_gene_expr_recon_loss: 489788.6875; val_masked_gp_l1_reg_loss: 4119.4844; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249850.4375; val_global_loss: 3438354.7500; val_optim_loss: 3438354.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9646; val_auprc_score: 0.9494; val_best_acc_score: 0.9126; val_best_f1_score: 0.9160; train_kl_reg_loss: 28696.9288; train_edge_recon_loss: 2658720.9167; train_gene_expr_recon_loss: 484368.6389; train_masked_gp_l1_reg_loss: 4151.8273; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247987.3594; train_global_loss: 3423925.6389; train_optim_loss: 3423925.6389; val_kl_reg_loss: 27861.6562; val_edge_recon_loss: 2678389.5000; val_gene_expr_recon_loss: 480142.1250; val_masked_gp_l1_reg_loss: 4187.3901; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248482.9062; val_global_loss: 3439064.0000; val_optim_loss: 3439064.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9687; val_auprc_score: 0.9554; val_best_acc_score: 0.9220; val_best_f1_score: 0.9235; train_kl_reg_loss: 28114.4885; train_edge_recon_loss: 2650131.0000; train_gene_expr_recon_loss: 480789.2847; train_masked_gp_l1_reg_loss: 4222.3349; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247171.5868; train_global_loss: 3410428.6944; train_optim_loss: 3410428.6944; val_kl_reg_loss: 26368.6133; val_edge_recon_loss: 2679377.0000; val_gene_expr_recon_loss: 483795.5625; val_masked_gp_l1_reg_loss: 4252.8633; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248681.0312; val_global_loss: 3442474.7500; val_optim_loss: 3442474.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9702; val_auprc_score: 0.9583; val_best_acc_score: 0.9268; val_best_f1_score: 0.9289; train_kl_reg_loss: 27554.8342; train_edge_recon_loss: 2647315.9444; train_gene_expr_recon_loss: 476796.5486; train_masked_gp_l1_reg_loss: 4279.2842; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246779.0399; train_global_loss: 3402725.6111; train_optim_loss: 3402725.6111; val_kl_reg_loss: 26985.0918; val_edge_recon_loss: 2645123.2500; val_gene_expr_recon_loss: 482158.9062; val_masked_gp_l1_reg_loss: 4307.4570; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248472.7344; val_global_loss: 3407047.5000; val_optim_loss: 3407047.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9688; val_auprc_score: 0.9576; val_best_acc_score: 0.9235; val_best_f1_score: 0.9265; train_kl_reg_loss: 27816.3748; train_edge_recon_loss: 2647054.5278; train_gene_expr_recon_loss: 473189.8819; train_masked_gp_l1_reg_loss: 4338.6668; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246803.7708; train_global_loss: 3399203.2500; train_optim_loss: 3399203.2500; val_kl_reg_loss: 27666.3750; val_edge_recon_loss: 2681702.0000; val_gene_expr_recon_loss: 481481.3125; val_masked_gp_l1_reg_loss: 4363.4727; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248147.2344; val_global_loss: 3443360.5000; val_optim_loss: 3443360.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9697; val_auprc_score: 0.9554; val_best_acc_score: 0.9255; val_best_f1_score: 0.9282; train_kl_reg_loss: 28245.6573; train_edge_recon_loss: 2639556.0000; train_gene_expr_recon_loss: 472542.1007; train_masked_gp_l1_reg_loss: 4377.9418; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246524.1858; train_global_loss: 3391245.8889; train_optim_loss: 3391245.8889; val_kl_reg_loss: 25899.3301; val_edge_recon_loss: 2647968.2500; val_gene_expr_recon_loss: 476063.4688; val_masked_gp_l1_reg_loss: 4391.7705; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247084.7656; val_global_loss: 3401407.5000; val_optim_loss: 3401407.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9751; val_auprc_score: 0.9678; val_best_acc_score: 0.9310; val_best_f1_score: 0.9330; train_kl_reg_loss: 27759.8819; train_edge_recon_loss: 2633794.9167; train_gene_expr_recon_loss: 470537.9792; train_masked_gp_l1_reg_loss: 4417.1465; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245208.3142; train_global_loss: 3381718.2222; train_optim_loss: 3381718.2222; val_kl_reg_loss: 28152.4863; val_edge_recon_loss: 2654063.5000; val_gene_expr_recon_loss: 473912.8125; val_masked_gp_l1_reg_loss: 4440.0073; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246585.0312; val_global_loss: 3407153.7500; val_optim_loss: 3407153.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9759; val_auprc_score: 0.9665; val_best_acc_score: 0.9342; val_best_f1_score: 0.9365; train_kl_reg_loss: 28281.4970; train_edge_recon_loss: 2627995.7778; train_gene_expr_recon_loss: 469805.6424; train_masked_gp_l1_reg_loss: 4464.8267; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246031.7882; train_global_loss: 3376579.5000; train_optim_loss: 3376579.5000; val_kl_reg_loss: 26676.3164; val_edge_recon_loss: 2631813.2500; val_gene_expr_recon_loss: 474634.1875; val_masked_gp_l1_reg_loss: 4486.4492; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246591.5312; val_global_loss: 3384201.7500; val_optim_loss: 3384201.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9780; val_auprc_score: 0.9707; val_best_acc_score: 0.9365; val_best_f1_score: 0.9383; train_kl_reg_loss: 27829.4896; train_edge_recon_loss: 2622786.2778; train_gene_expr_recon_loss: 464032.2639; train_masked_gp_l1_reg_loss: 4509.7381; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243905.5816; train_global_loss: 3363063.3611; train_optim_loss: 3363063.3611; val_kl_reg_loss: 28146.4062; val_edge_recon_loss: 2629608.5000; val_gene_expr_recon_loss: 471004.5625; val_masked_gp_l1_reg_loss: 4530.5801; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245848.9531; val_global_loss: 3379139.0000; val_optim_loss: 3379139.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9748; val_auprc_score: 0.9645; val_best_acc_score: 0.9306; val_best_f1_score: 0.9330; train_kl_reg_loss: 29481.8422; train_edge_recon_loss: 2629474.1111; train_gene_expr_recon_loss: 463554.0347; train_masked_gp_l1_reg_loss: 4546.8287; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243461.7882; train_global_loss: 3370518.5278; train_optim_loss: 3370518.5278; val_kl_reg_loss: 27988.4395; val_edge_recon_loss: 2638436.2500; val_gene_expr_recon_loss: 468773.3750; val_masked_gp_l1_reg_loss: 4566.0708; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245424.4844; val_global_loss: 3385188.5000; val_optim_loss: 3385188.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9751; val_auprc_score: 0.9664; val_best_acc_score: 0.9332; val_best_f1_score: 0.9353; train_kl_reg_loss: 28084.6504; train_edge_recon_loss: 2636985.6667; train_gene_expr_recon_loss: 468526.1389; train_masked_gp_l1_reg_loss: 4599.9003; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244693.2049; train_global_loss: 3382889.4444; train_optim_loss: 3382889.4444; val_kl_reg_loss: 20938.9258; val_edge_recon_loss: 2632747.2500; val_gene_expr_recon_loss: 478100.0000; val_masked_gp_l1_reg_loss: 4620.8940; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246437.2812; val_global_loss: 3382844.5000; val_optim_loss: 3382844.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9786; val_auprc_score: 0.9719; val_best_acc_score: 0.9392; val_best_f1_score: 0.9410; train_kl_reg_loss: 27997.5482; train_edge_recon_loss: 2630004.0556; train_gene_expr_recon_loss: 466393.0347; train_masked_gp_l1_reg_loss: 4634.1631; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244727.5556; train_global_loss: 3373756.4444; train_optim_loss: 3373756.4444; val_kl_reg_loss: 21085.4336; val_edge_recon_loss: 2634649.7500; val_gene_expr_recon_loss: 472685.1250; val_masked_gp_l1_reg_loss: 4642.8066; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245515.6719; val_global_loss: 3378579.0000; val_optim_loss: 3378579.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9761; val_auprc_score: 0.9646; val_best_acc_score: 0.9348; val_best_f1_score: 0.9371; train_kl_reg_loss: 27032.6126; train_edge_recon_loss: 2621089.6389; train_gene_expr_recon_loss: 462938.3056; train_masked_gp_l1_reg_loss: 4656.1147; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243535.8802; train_global_loss: 3359252.5556; train_optim_loss: 3359252.5556; val_kl_reg_loss: 21522.1250; val_edge_recon_loss: 2648109.0000; val_gene_expr_recon_loss: 468538.6250; val_masked_gp_l1_reg_loss: 4665.8579; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244994.3125; val_global_loss: 3387829.5000; val_optim_loss: 3387829.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9790; val_auprc_score: 0.9710; val_best_acc_score: 0.9403; val_best_f1_score: 0.9422; train_kl_reg_loss: 26966.3236; train_edge_recon_loss: 2619052.8333; train_gene_expr_recon_loss: 459524.2535; train_masked_gp_l1_reg_loss: 4677.0456; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243203.8594; train_global_loss: 3353424.2778; train_optim_loss: 3353424.2778; val_kl_reg_loss: 21212.5605; val_edge_recon_loss: 2630546.0000; val_gene_expr_recon_loss: 474670.6875; val_masked_gp_l1_reg_loss: 4684.5596; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245107.8125; val_global_loss: 3376221.5000; val_optim_loss: 3376221.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9782; val_auprc_score: 0.9708; val_best_acc_score: 0.9368; val_best_f1_score: 0.9392; train_kl_reg_loss: 26561.1671; train_edge_recon_loss: 2620850.3056; train_gene_expr_recon_loss: 463730.8854; train_masked_gp_l1_reg_loss: 4694.4346; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242940.5017; train_global_loss: 3358777.3056; train_optim_loss: 3358777.3056; val_kl_reg_loss: 21989.2344; val_edge_recon_loss: 2652583.0000; val_gene_expr_recon_loss: 466953.4375; val_masked_gp_l1_reg_loss: 4700.9619; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244265.3125; val_global_loss: 3390492.0000; val_optim_loss: 3390492.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9807; val_auprc_score: 0.9742; val_best_acc_score: 0.9438; val_best_f1_score: 0.9453; train_kl_reg_loss: 26774.2515; train_edge_recon_loss: 2631044.1944; train_gene_expr_recon_loss: 458931.0347; train_masked_gp_l1_reg_loss: 4720.2058; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242601.2535; train_global_loss: 3364070.9722; train_optim_loss: 3364070.9722; val_kl_reg_loss: 21967.2988; val_edge_recon_loss: 2633789.7500; val_gene_expr_recon_loss: 463212.1250; val_masked_gp_l1_reg_loss: 4732.3184; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243461.9844; val_global_loss: 3367163.2500; val_optim_loss: 3367163.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9805; val_auprc_score: 0.9740; val_best_acc_score: 0.9466; val_best_f1_score: 0.9478; train_kl_reg_loss: 25889.8652; train_edge_recon_loss: 2619505.8333; train_gene_expr_recon_loss: 456386.8576; train_masked_gp_l1_reg_loss: 4748.2774; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241439.6024; train_global_loss: 3347970.5000; train_optim_loss: 3347970.5000; val_kl_reg_loss: 22160.2402; val_edge_recon_loss: 2630333.5000; val_gene_expr_recon_loss: 467491.1250; val_masked_gp_l1_reg_loss: 4759.0366; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243914.5938; val_global_loss: 3368658.5000; val_optim_loss: 3368658.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9803; val_auprc_score: 0.9727; val_best_acc_score: 0.9404; val_best_f1_score: 0.9427; train_kl_reg_loss: 26746.3872; train_edge_recon_loss: 2622263.3056; train_gene_expr_recon_loss: 458927.9201; train_masked_gp_l1_reg_loss: 4768.0792; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241909.7153; train_global_loss: 3354615.3611; train_optim_loss: 3354615.3611; val_kl_reg_loss: 23067.4766; val_edge_recon_loss: 2630649.7500; val_gene_expr_recon_loss: 466512.8125; val_masked_gp_l1_reg_loss: 4775.1094; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243687.2500; val_global_loss: 3368692.2500; val_optim_loss: 3368692.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9835; val_auprc_score: 0.9773; val_best_acc_score: 0.9472; val_best_f1_score: 0.9485; train_kl_reg_loss: 26214.2365; train_edge_recon_loss: 2623452.1111; train_gene_expr_recon_loss: 452937.2222; train_masked_gp_l1_reg_loss: 4789.2047; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240935.4479; train_global_loss: 3348328.2222; train_optim_loss: 3348328.2222; val_kl_reg_loss: 22236.4062; val_edge_recon_loss: 2620329.5000; val_gene_expr_recon_loss: 464218.7812; val_masked_gp_l1_reg_loss: 4793.5747; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243275.9062; val_global_loss: 3354854.2500; val_optim_loss: 3354854.2500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9837; val_auprc_score: 0.9774; val_best_acc_score: 0.9480; val_best_f1_score: 0.9497; train_kl_reg_loss: 25124.4531; train_edge_recon_loss: 2619771.2500; train_gene_expr_recon_loss: 452811.3750; train_masked_gp_l1_reg_loss: 4799.1229; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240656.6424; train_global_loss: 3343162.8056; train_optim_loss: 3343162.8056; val_kl_reg_loss: 22474.8496; val_edge_recon_loss: 2624542.0000; val_gene_expr_recon_loss: 458844.5625; val_masked_gp_l1_reg_loss: 4805.0493; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242041.1562; val_global_loss: 3352707.5000; val_optim_loss: 3352707.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9838; val_auprc_score: 0.9787; val_best_acc_score: 0.9507; val_best_f1_score: 0.9523; train_kl_reg_loss: 25537.8333; train_edge_recon_loss: 2615020.0000; train_gene_expr_recon_loss: 451068.9479; train_masked_gp_l1_reg_loss: 4817.9224; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240013.2708; train_global_loss: 3336457.9722; train_optim_loss: 3336457.9722; val_kl_reg_loss: 22746.9453; val_edge_recon_loss: 2611155.5000; val_gene_expr_recon_loss: 459878.9375; val_masked_gp_l1_reg_loss: 4831.0576; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242292.1406; val_global_loss: 3340904.7500; val_optim_loss: 3340904.7500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9838; val_auprc_score: 0.9783; val_best_acc_score: 0.9493; val_best_f1_score: 0.9505; train_kl_reg_loss: 25878.3906; train_edge_recon_loss: 2610186.8889; train_gene_expr_recon_loss: 450700.0000; train_masked_gp_l1_reg_loss: 4845.6363; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240603.3090; train_global_loss: 3332214.2778; train_optim_loss: 3332214.2778; val_kl_reg_loss: 22453.0078; val_edge_recon_loss: 2633315.2500; val_gene_expr_recon_loss: 460898.5625; val_masked_gp_l1_reg_loss: 4856.2993; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242233.4062; val_global_loss: 3363756.5000; val_optim_loss: 3363756.5000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9827; val_auprc_score: 0.9767; val_best_acc_score: 0.9487; val_best_f1_score: 0.9501; train_kl_reg_loss: 24382.5332; train_edge_recon_loss: 2608678.6944; train_gene_expr_recon_loss: 451278.3438; train_masked_gp_l1_reg_loss: 4871.9375; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239875.0990; train_global_loss: 3329086.5278; train_optim_loss: 3329086.5278; val_kl_reg_loss: 22592.4688; val_edge_recon_loss: 2626893.5000; val_gene_expr_recon_loss: 459429.3750; val_masked_gp_l1_reg_loss: 4881.8066; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241791.2188; val_global_loss: 3355588.5000; val_optim_loss: 3355588.5000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9838; val_auprc_score: 0.9778; val_best_acc_score: 0.9479; val_best_f1_score: 0.9495; train_kl_reg_loss: 26265.9099; train_edge_recon_loss: 2601975.0556; train_gene_expr_recon_loss: 447267.7361; train_masked_gp_l1_reg_loss: 4894.7939; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239459.5469; train_global_loss: 3319863.0556; train_optim_loss: 3319863.0556; val_kl_reg_loss: 23927.5859; val_edge_recon_loss: 2611740.0000; val_gene_expr_recon_loss: 456747.3750; val_masked_gp_l1_reg_loss: 4904.4141; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241278.3125; val_global_loss: 3338597.7500; val_optim_loss: 3338597.7500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9846; val_auprc_score: 0.9762; val_best_acc_score: 0.9532; val_best_f1_score: 0.9542; train_kl_reg_loss: 25659.1656; train_edge_recon_loss: 2605447.8889; train_gene_expr_recon_loss: 447504.4931; train_masked_gp_l1_reg_loss: 4919.2761; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239382.7795; train_global_loss: 3322913.6944; train_optim_loss: 3322913.6944; val_kl_reg_loss: 22409.9746; val_edge_recon_loss: 2627648.7500; val_gene_expr_recon_loss: 459358.5938; val_masked_gp_l1_reg_loss: 4930.0059; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241547.5625; val_global_loss: 3355894.7500; val_optim_loss: 3355894.7500
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9849; val_auprc_score: 0.9777; val_best_acc_score: 0.9504; val_best_f1_score: 0.9516; train_kl_reg_loss: 24733.0356; train_edge_recon_loss: 2608296.5000; train_gene_expr_recon_loss: 446682.3715; train_masked_gp_l1_reg_loss: 4945.7434; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238797.5191; train_global_loss: 3323455.1667; train_optim_loss: 3323455.1667; val_kl_reg_loss: 22757.1953; val_edge_recon_loss: 2619196.2500; val_gene_expr_recon_loss: 457524.3125; val_masked_gp_l1_reg_loss: 4954.9360; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241232.0000; val_global_loss: 3345664.7500; val_optim_loss: 3345664.7500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9848; val_auprc_score: 0.9795; val_best_acc_score: 0.9532; val_best_f1_score: 0.9545; train_kl_reg_loss: 25285.6361; train_edge_recon_loss: 2606367.8333; train_gene_expr_recon_loss: 447509.2604; train_masked_gp_l1_reg_loss: 4964.0728; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238787.7378; train_global_loss: 3322914.5000; train_optim_loss: 3322914.5000; val_kl_reg_loss: 23001.8809; val_edge_recon_loss: 2626206.7500; val_gene_expr_recon_loss: 457185.0000; val_masked_gp_l1_reg_loss: 4972.1387; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240590.2031; val_global_loss: 3351956.2500; val_optim_loss: 3351956.2500
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9856; val_auprc_score: 0.9806; val_best_acc_score: 0.9506; val_best_f1_score: 0.9519; train_kl_reg_loss: 24335.1552; train_edge_recon_loss: 2609003.0556; train_gene_expr_recon_loss: 446481.7812; train_masked_gp_l1_reg_loss: 4990.2018; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238163.6302; train_global_loss: 3322973.8889; train_optim_loss: 3322973.8889; val_kl_reg_loss: 21972.0586; val_edge_recon_loss: 2616166.2500; val_gene_expr_recon_loss: 456461.3125; val_masked_gp_l1_reg_loss: 4999.3623; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240589.9688; val_global_loss: 3340188.7500; val_optim_loss: 3340188.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9850; val_auprc_score: 0.9767; val_best_acc_score: 0.9543; val_best_f1_score: 0.9552; train_kl_reg_loss: 23869.0636; train_edge_recon_loss: 2606013.8889; train_gene_expr_recon_loss: 444579.7361; train_masked_gp_l1_reg_loss: 4986.3511; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237786.6580; train_global_loss: 3317235.6944; train_optim_loss: 3317235.6944; val_kl_reg_loss: 22013.6035; val_edge_recon_loss: 2619584.5000; val_gene_expr_recon_loss: 454124.0938; val_masked_gp_l1_reg_loss: 4972.7324; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240314.3750; val_global_loss: 3341009.0000; val_optim_loss: 3341009.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9875; val_auprc_score: 0.9811; val_best_acc_score: 0.9559; val_best_f1_score: 0.9569; train_kl_reg_loss: 23939.4727; train_edge_recon_loss: 2605257.8889; train_gene_expr_recon_loss: 445458.6146; train_masked_gp_l1_reg_loss: 4967.7384; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238004.7170; train_global_loss: 3317628.4167; train_optim_loss: 3317628.4167; val_kl_reg_loss: 22030.5547; val_edge_recon_loss: 2611007.0000; val_gene_expr_recon_loss: 455837.5000; val_masked_gp_l1_reg_loss: 4961.1221; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240479.7188; val_global_loss: 3334315.7500; val_optim_loss: 3334315.7500
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9869; val_auprc_score: 0.9808; val_best_acc_score: 0.9561; val_best_f1_score: 0.9572; train_kl_reg_loss: 24258.8895; train_edge_recon_loss: 2595754.1944; train_gene_expr_recon_loss: 443478.5000; train_masked_gp_l1_reg_loss: 4958.0448; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238293.5434; train_global_loss: 3306743.1111; train_optim_loss: 3306743.1111; val_kl_reg_loss: 22522.1406; val_edge_recon_loss: 2626301.2500; val_gene_expr_recon_loss: 454988.7500; val_masked_gp_l1_reg_loss: 4954.3535; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240395.3906; val_global_loss: 3349162.0000; val_optim_loss: 3349162.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9872; val_auprc_score: 0.9840; val_best_acc_score: 0.9543; val_best_f1_score: 0.9556; train_kl_reg_loss: 24665.0560; train_edge_recon_loss: 2603273.3889; train_gene_expr_recon_loss: 443426.1944; train_masked_gp_l1_reg_loss: 4952.2922; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237710.2396; train_global_loss: 3314027.0833; train_optim_loss: 3314027.0833; val_kl_reg_loss: 22711.1816; val_edge_recon_loss: 2618527.7500; val_gene_expr_recon_loss: 454152.9688; val_masked_gp_l1_reg_loss: 4949.8091; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240262.5000; val_global_loss: 3340604.2500; val_optim_loss: 3340604.2500
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9862; val_auprc_score: 0.9789; val_best_acc_score: 0.9576; val_best_f1_score: 0.9586; train_kl_reg_loss: 24830.6005; train_edge_recon_loss: 2604534.4167; train_gene_expr_recon_loss: 441542.8576; train_masked_gp_l1_reg_loss: 4948.9511; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238611.1701; train_global_loss: 3314468.0833; train_optim_loss: 3314468.0833; val_kl_reg_loss: 22813.3613; val_edge_recon_loss: 2616300.2500; val_gene_expr_recon_loss: 454065.1875; val_masked_gp_l1_reg_loss: 4947.5952; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240184.2969; val_global_loss: 3338310.5000; val_optim_loss: 3338310.5000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9856; val_auprc_score: 0.9806; val_best_acc_score: 0.9566; val_best_f1_score: 0.9578; train_kl_reg_loss: 24822.4030; train_edge_recon_loss: 2602061.5556; train_gene_expr_recon_loss: 444137.4444; train_masked_gp_l1_reg_loss: 4947.1879; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238727.0799; train_global_loss: 3314695.6944; train_optim_loss: 3314695.6944; val_kl_reg_loss: 22574.5371; val_edge_recon_loss: 2607436.2500; val_gene_expr_recon_loss: 454852.5312; val_masked_gp_l1_reg_loss: 4946.4473; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240295.3438; val_global_loss: 3330105.0000; val_optim_loss: 3330105.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9884; val_auprc_score: 0.9850; val_best_acc_score: 0.9603; val_best_f1_score: 0.9612; train_kl_reg_loss: 24605.2010; train_edge_recon_loss: 2602380.8056; train_gene_expr_recon_loss: 443324.3438; train_masked_gp_l1_reg_loss: 4946.6188; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238741.2274; train_global_loss: 3313998.2778; train_optim_loss: 3313998.2778; val_kl_reg_loss: 22590.7324; val_edge_recon_loss: 2601040.0000; val_gene_expr_recon_loss: 453734.5625; val_masked_gp_l1_reg_loss: 4946.5693; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240117.5781; val_global_loss: 3322429.2500; val_optim_loss: 3322429.2500
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9876; val_auprc_score: 0.9820; val_best_acc_score: 0.9566; val_best_f1_score: 0.9575; train_kl_reg_loss: 24559.1118; train_edge_recon_loss: 2602132.6944; train_gene_expr_recon_loss: 441549.0243; train_masked_gp_l1_reg_loss: 4947.4072; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237141.3316; train_global_loss: 3310329.5278; train_optim_loss: 3310329.5278; val_kl_reg_loss: 22699.9375; val_edge_recon_loss: 2628469.5000; val_gene_expr_recon_loss: 454048.3125; val_masked_gp_l1_reg_loss: 4947.8740; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240130.2031; val_global_loss: 3350295.7500; val_optim_loss: 3350295.7500
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9875; val_auprc_score: 0.9831; val_best_acc_score: 0.9573; val_best_f1_score: 0.9584; train_kl_reg_loss: 24974.8266; train_edge_recon_loss: 2597322.8333; train_gene_expr_recon_loss: 443378.4965; train_masked_gp_l1_reg_loss: 4948.3994; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238205.9045; train_global_loss: 3308830.3611; train_optim_loss: 3308830.3611; val_kl_reg_loss: 22921.4062; val_edge_recon_loss: 2608552.7500; val_gene_expr_recon_loss: 453775.8750; val_masked_gp_l1_reg_loss: 4948.5635; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240156.0781; val_global_loss: 3330354.5000; val_optim_loss: 3330354.5000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9867; val_auprc_score: 0.9810; val_best_acc_score: 0.9558; val_best_f1_score: 0.9570; train_kl_reg_loss: 25034.7947; train_edge_recon_loss: 2602220.0833; train_gene_expr_recon_loss: 442270.5660; train_masked_gp_l1_reg_loss: 4949.2685; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236677.2222; train_global_loss: 3311151.8889; train_optim_loss: 3311151.8889; val_kl_reg_loss: 22868.9492; val_edge_recon_loss: 2626336.7500; val_gene_expr_recon_loss: 452906.1875; val_masked_gp_l1_reg_loss: 4949.8613; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239969.8906; val_global_loss: 3347031.7500; val_optim_loss: 3347031.7500
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9867; val_auprc_score: 0.9819; val_best_acc_score: 0.9559; val_best_f1_score: 0.9568; train_kl_reg_loss: 24971.1923; train_edge_recon_loss: 2603553.6389; train_gene_expr_recon_loss: 442848.0451; train_masked_gp_l1_reg_loss: 4950.8979; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238117.3681; train_global_loss: 3314441.1389; train_optim_loss: 3314441.1389; val_kl_reg_loss: 22872.0488; val_edge_recon_loss: 2618532.2500; val_gene_expr_recon_loss: 453752.3125; val_masked_gp_l1_reg_loss: 4951.6060; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240053.4844; val_global_loss: 3340161.5000; val_optim_loss: 3340161.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9870; val_auprc_score: 0.9825; val_best_acc_score: 0.9539; val_best_f1_score: 0.9551; train_kl_reg_loss: 24994.3277; train_edge_recon_loss: 2599466.7222; train_gene_expr_recon_loss: 442558.1181; train_masked_gp_l1_reg_loss: 4950.3095; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238458.9896; train_global_loss: 3310428.4444; train_optim_loss: 3310428.4444; val_kl_reg_loss: 22893.6562; val_edge_recon_loss: 2622084.0000; val_gene_expr_recon_loss: 453661.7500; val_masked_gp_l1_reg_loss: 4948.9897; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240046.6094; val_global_loss: 3343635.0000; val_optim_loss: 3343635.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9863; val_auprc_score: 0.9804; val_best_acc_score: 0.9562; val_best_f1_score: 0.9574; train_kl_reg_loss: 24927.1528; train_edge_recon_loss: 2602878.9167; train_gene_expr_recon_loss: 441986.6458; train_masked_gp_l1_reg_loss: 4948.5571; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237260.7691; train_global_loss: 3312002.0278; train_optim_loss: 3312002.0278; val_kl_reg_loss: 22844.0859; val_edge_recon_loss: 2611546.5000; val_gene_expr_recon_loss: 453593.3125; val_masked_gp_l1_reg_loss: 4947.9580; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240051.9531; val_global_loss: 3332983.7500; val_optim_loss: 3332983.7500
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9852; val_auprc_score: 0.9774; val_best_acc_score: 0.9574; val_best_f1_score: 0.9582; train_kl_reg_loss: 24970.7303; train_edge_recon_loss: 2601746.3056; train_gene_expr_recon_loss: 443269.3924; train_masked_gp_l1_reg_loss: 4947.6412; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239054.2795; train_global_loss: 3313988.3333; train_optim_loss: 3313988.3333; val_kl_reg_loss: 22942.3945; val_edge_recon_loss: 2618464.2500; val_gene_expr_recon_loss: 453575.8125; val_masked_gp_l1_reg_loss: 4947.3057; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240051.1406; val_global_loss: 3339981.0000; val_optim_loss: 3339981.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9863; val_auprc_score: 0.9787; val_best_acc_score: 0.9555; val_best_f1_score: 0.9567; train_kl_reg_loss: 25020.4323; train_edge_recon_loss: 2608655.3056; train_gene_expr_recon_loss: 442140.5486; train_masked_gp_l1_reg_loss: 4947.1601; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237560.8160; train_global_loss: 3318324.3056; train_optim_loss: 3318324.3056; val_kl_reg_loss: 22903.9746; val_edge_recon_loss: 2613865.7500; val_gene_expr_recon_loss: 453424.7500; val_masked_gp_l1_reg_loss: 4946.9717; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240041.4062; val_global_loss: 3335183.0000; val_optim_loss: 3335183.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 13 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9861
val AUPRC score: 0.9816
val best accuracy score: 0.9554
val best F1 score: 0.9563
val target rna MSE score: 0.4247
val source rna MSE score: 0.2791
val target atac MSE score: 0.1343
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
