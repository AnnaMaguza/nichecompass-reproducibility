[True]
Run timestamp: 07082023_170332_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8665; val_auprc_score: 0.8894; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11045.8357; train_edge_recon_loss: 35896.0213; train_gene_expr_recon_loss: 1367373.5833; train_masked_gp_l1_reg_loss: 4495.7024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119270.4748; train_chrom_access_recon_loss: 3553705.9306; train_global_loss: 5091787.5278; train_optim_loss: 5091787.5278; val_kl_reg_loss: 6692.9473; val_edge_recon_loss: 40660.6445; val_gene_expr_recon_loss: 1202665.2500; val_masked_gp_l1_reg_loss: 3863.7349; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116926.9844; val_chrom_access_recon_loss: 1761879.5000; val_global_loss: 3132689.0000; val_optim_loss: 3132689.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8831; val_auprc_score: 0.9016; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5389.9505; train_edge_recon_loss: 36393.9961; train_gene_expr_recon_loss: 1098963.1389; train_masked_gp_l1_reg_loss: 3733.6502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115588.9922; train_chrom_access_recon_loss: 1551668.7778; train_global_loss: 2811738.5278; train_optim_loss: 2811738.5278; val_kl_reg_loss: 4258.7285; val_edge_recon_loss: 40660.2930; val_gene_expr_recon_loss: 1035716.6250; val_masked_gp_l1_reg_loss: 3747.0667; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114048.4766; val_chrom_access_recon_loss: 1455179.6250; val_global_loss: 2653611.0000; val_optim_loss: 2653611.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8896; val_auprc_score: 0.9041; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5055.9929; train_edge_recon_loss: 36369.2522; train_gene_expr_recon_loss: 994477.8681; train_masked_gp_l1_reg_loss: 3974.4655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112936.1693; train_chrom_access_recon_loss: 1442711.1389; train_global_loss: 2595524.8889; train_optim_loss: 2595524.8889; val_kl_reg_loss: 7078.4062; val_edge_recon_loss: 40661.1641; val_gene_expr_recon_loss: 942908.6250; val_masked_gp_l1_reg_loss: 4253.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111563.6562; val_chrom_access_recon_loss: 1419916.5000; val_global_loss: 2526381.5000; val_optim_loss: 2526381.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8863; val_auprc_score: 0.9027; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11420.6844; train_edge_recon_loss: 37651.8164; train_gene_expr_recon_loss: 885930.7083; train_masked_gp_l1_reg_loss: 4364.5816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110458.1033; train_chrom_access_recon_loss: 1406185.3750; train_global_loss: 2456011.2778; train_optim_loss: 2456011.2778; val_kl_reg_loss: 16748.2461; val_edge_recon_loss: 40662.0391; val_gene_expr_recon_loss: 836873.5000; val_masked_gp_l1_reg_loss: 4439.6636; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109045.4297; val_chrom_access_recon_loss: 1387610.7500; val_global_loss: 2395379.7500; val_optim_loss: 2395379.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8755; val_auprc_score: 0.8925; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20080.5449; train_edge_recon_loss: 38792.9041; train_gene_expr_recon_loss: 797339.0833; train_masked_gp_l1_reg_loss: 4440.6121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107809.7031; train_chrom_access_recon_loss: 1375013.5139; train_global_loss: 2343476.3889; train_optim_loss: 2343476.3889; val_kl_reg_loss: 21467.3359; val_edge_recon_loss: 40661.8867; val_gene_expr_recon_loss: 770236.3750; val_masked_gp_l1_reg_loss: 4418.9326; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106170.0391; val_chrom_access_recon_loss: 1362143.7500; val_global_loss: 2305098.5000; val_optim_loss: 2305098.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8814; val_auprc_score: 0.8949; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 22227.2912; train_edge_recon_loss: 38943.1970; train_gene_expr_recon_loss: 748206.0208; train_masked_gp_l1_reg_loss: 4393.5962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104702.0234; train_chrom_access_recon_loss: 1356548.8056; train_global_loss: 2275020.9444; train_optim_loss: 2275020.9444; val_kl_reg_loss: 22202.5098; val_edge_recon_loss: 40660.8516; val_gene_expr_recon_loss: 736974.5000; val_masked_gp_l1_reg_loss: 4361.5483; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102777.8516; val_chrom_access_recon_loss: 1342094.3750; val_global_loss: 2249071.7500; val_optim_loss: 2249071.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8591; val_auprc_score: 0.8618; val_best_acc_score: 0.5026; val_best_f1_score: 0.6678; train_kl_reg_loss: 23111.2541; train_edge_recon_loss: 38970.2418; train_gene_expr_recon_loss: 724641.2292; train_masked_gp_l1_reg_loss: 4338.6860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101127.8368; train_chrom_access_recon_loss: 1347602.5139; train_global_loss: 2239791.7222; train_optim_loss: 2239791.7222; val_kl_reg_loss: 22602.5898; val_edge_recon_loss: 40655.9922; val_gene_expr_recon_loss: 715401.0000; val_masked_gp_l1_reg_loss: 4306.4126; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99014.5156; val_chrom_access_recon_loss: 1329256.0000; val_global_loss: 2211236.5000; val_optim_loss: 2211236.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8442; val_auprc_score: 0.8361; val_best_acc_score: 0.5229; val_best_f1_score: 0.6768; train_kl_reg_loss: 23457.1845; train_edge_recon_loss: 39014.7192; train_gene_expr_recon_loss: 699310.1944; train_masked_gp_l1_reg_loss: 4292.3261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97269.1710; train_chrom_access_recon_loss: 1326484.2917; train_global_loss: 2189827.9167; train_optim_loss: 2189827.9167; val_kl_reg_loss: 23388.7344; val_edge_recon_loss: 40640.6758; val_gene_expr_recon_loss: 698818.3125; val_masked_gp_l1_reg_loss: 4266.0103; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95065.3516; val_chrom_access_recon_loss: 1321541.1250; val_global_loss: 2183720.2500; val_optim_loss: 2183720.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8309; val_auprc_score: 0.8152; val_best_acc_score: 0.5679; val_best_f1_score: 0.6967; train_kl_reg_loss: 24281.0447; train_edge_recon_loss: 39018.9891; train_gene_expr_recon_loss: 687064.9792; train_masked_gp_l1_reg_loss: 4244.1106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93277.4826; train_chrom_access_recon_loss: 1319389.6250; train_global_loss: 2167276.2500; train_optim_loss: 2167276.2500; val_kl_reg_loss: 24492.8359; val_edge_recon_loss: 40613.8359; val_gene_expr_recon_loss: 686211.3750; val_masked_gp_l1_reg_loss: 4211.5791; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91031.7812; val_chrom_access_recon_loss: 1315336.0000; val_global_loss: 2161897.5000; val_optim_loss: 2161897.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8128; val_auprc_score: 0.7995; val_best_acc_score: 0.6219; val_best_f1_score: 0.7216; train_kl_reg_loss: 24228.2027; train_edge_recon_loss: 39105.0703; train_gene_expr_recon_loss: 676692.4375; train_masked_gp_l1_reg_loss: 4191.6799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89233.8325; train_chrom_access_recon_loss: 1314127.6667; train_global_loss: 2147578.9722; train_optim_loss: 2147578.9722; val_kl_reg_loss: 22757.0312; val_edge_recon_loss: 40579.5586; val_gene_expr_recon_loss: 676368.3125; val_masked_gp_l1_reg_loss: 4163.5552; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86994.6875; val_chrom_access_recon_loss: 1310276.1250; val_global_loss: 2141139.2500; val_optim_loss: 2141139.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8111; val_auprc_score: 0.7993; val_best_acc_score: 0.6455; val_best_f1_score: 0.7329; train_kl_reg_loss: 24050.3648; train_edge_recon_loss: 39113.2049; train_gene_expr_recon_loss: 668708.5972; train_masked_gp_l1_reg_loss: 4145.2919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85235.1094; train_chrom_access_recon_loss: 1311706.1528; train_global_loss: 2132958.7500; train_optim_loss: 2132958.7500; val_kl_reg_loss: 22631.2930; val_edge_recon_loss: 40557.4727; val_gene_expr_recon_loss: 669512.2500; val_masked_gp_l1_reg_loss: 4120.3857; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83055.2188; val_chrom_access_recon_loss: 1306370.5000; val_global_loss: 2126247.0000; val_optim_loss: 2126247.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8106; val_auprc_score: 0.8010; val_best_acc_score: 0.6663; val_best_f1_score: 0.7418; train_kl_reg_loss: 24136.8989; train_edge_recon_loss: 39149.2613; train_gene_expr_recon_loss: 664841.8056; train_masked_gp_l1_reg_loss: 4111.6743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81352.6667; train_chrom_access_recon_loss: 1312434.7361; train_global_loss: 2126027.0000; train_optim_loss: 2126027.0000; val_kl_reg_loss: 22492.6250; val_edge_recon_loss: 40531.5977; val_gene_expr_recon_loss: 664299.5000; val_masked_gp_l1_reg_loss: 4095.0923; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79250.0312; val_chrom_access_recon_loss: 1303041.5000; val_global_loss: 2113710.5000; val_optim_loss: 2113710.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8176; val_auprc_score: 0.8112; val_best_acc_score: 0.6764; val_best_f1_score: 0.7460; train_kl_reg_loss: 23797.6421; train_edge_recon_loss: 39135.4913; train_gene_expr_recon_loss: 659496.7986; train_masked_gp_l1_reg_loss: 4093.2545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77622.6641; train_chrom_access_recon_loss: 1309636.4306; train_global_loss: 2113782.2500; train_optim_loss: 2113782.2500; val_kl_reg_loss: 22515.4688; val_edge_recon_loss: 40519.9531; val_gene_expr_recon_loss: 660227.7500; val_masked_gp_l1_reg_loss: 4080.7393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75614.9844; val_chrom_access_recon_loss: 1299995.1250; val_global_loss: 2102954.0000; val_optim_loss: 2102954.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8201; val_auprc_score: 0.8104; val_best_acc_score: 0.6792; val_best_f1_score: 0.7476; train_kl_reg_loss: 23281.7528; train_edge_recon_loss: 39124.5790; train_gene_expr_recon_loss: 656393.2431; train_masked_gp_l1_reg_loss: 4079.1852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74062.4731; train_chrom_access_recon_loss: 1301568.0139; train_global_loss: 2098509.2500; train_optim_loss: 2098509.2500; val_kl_reg_loss: 22728.8281; val_edge_recon_loss: 40521.8047; val_gene_expr_recon_loss: 656837.8750; val_masked_gp_l1_reg_loss: 4067.5854; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72149.6250; val_chrom_access_recon_loss: 1297375.5000; val_global_loss: 2093681.2500; val_optim_loss: 2093681.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8351; val_auprc_score: 0.8287; val_best_acc_score: 0.7026; val_best_f1_score: 0.7589; train_kl_reg_loss: 22870.1445; train_edge_recon_loss: 39103.7509; train_gene_expr_recon_loss: 655439.5347; train_masked_gp_l1_reg_loss: 4068.1782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70672.8264; train_chrom_access_recon_loss: 1303009.8889; train_global_loss: 2095164.3056; train_optim_loss: 2095164.3056; val_kl_reg_loss: 21067.6250; val_edge_recon_loss: 40499.6914; val_gene_expr_recon_loss: 655818.2500; val_masked_gp_l1_reg_loss: 4063.2361; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68854.7188; val_chrom_access_recon_loss: 1294732.7500; val_global_loss: 2085036.2500; val_optim_loss: 2085036.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8429; val_auprc_score: 0.8398; val_best_acc_score: 0.7114; val_best_f1_score: 0.7631; train_kl_reg_loss: 22303.1330; train_edge_recon_loss: 39069.4727; train_gene_expr_recon_loss: 650616.3611; train_masked_gp_l1_reg_loss: 4062.0303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67457.4036; train_chrom_access_recon_loss: 1303022.0694; train_global_loss: 2086530.4444; train_optim_loss: 2086530.4444; val_kl_reg_loss: 20774.5742; val_edge_recon_loss: 40489.5742; val_gene_expr_recon_loss: 653606.2500; val_masked_gp_l1_reg_loss: 4055.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65737.4844; val_chrom_access_recon_loss: 1292890.7500; val_global_loss: 2077554.0000; val_optim_loss: 2077554.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8573; val_auprc_score: 0.8492; val_best_acc_score: 0.7317; val_best_f1_score: 0.7741; train_kl_reg_loss: 21811.3728; train_edge_recon_loss: 39035.9905; train_gene_expr_recon_loss: 652088.8403; train_masked_gp_l1_reg_loss: 4055.8228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64415.8724; train_chrom_access_recon_loss: 1300500.9583; train_global_loss: 2081908.8750; train_optim_loss: 2081908.8750; val_kl_reg_loss: 20448.5020; val_edge_recon_loss: 40459.1484; val_gene_expr_recon_loss: 651477.0625; val_masked_gp_l1_reg_loss: 4053.1226; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62789.1836; val_chrom_access_recon_loss: 1292771.5000; val_global_loss: 2071998.5000; val_optim_loss: 2071998.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8691; val_auprc_score: 0.8571; val_best_acc_score: 0.7577; val_best_f1_score: 0.7898; train_kl_reg_loss: 21344.0371; train_edge_recon_loss: 38999.7561; train_gene_expr_recon_loss: 646966.6250; train_masked_gp_l1_reg_loss: 4056.6717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61548.0855; train_chrom_access_recon_loss: 1299052.5694; train_global_loss: 2071967.7222; train_optim_loss: 2071967.7222; val_kl_reg_loss: 19773.7227; val_edge_recon_loss: 40436.5859; val_gene_expr_recon_loss: 650299.5000; val_masked_gp_l1_reg_loss: 4055.5376; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60019.4219; val_chrom_access_recon_loss: 1290625.7500; val_global_loss: 2065210.5000; val_optim_loss: 2065210.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8724; val_auprc_score: 0.8636; val_best_acc_score: 0.7707; val_best_f1_score: 0.7965; train_kl_reg_loss: 20830.9054; train_edge_recon_loss: 38959.4010; train_gene_expr_recon_loss: 645080.1528; train_masked_gp_l1_reg_loss: 4063.3912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58849.0864; train_chrom_access_recon_loss: 1296473.0139; train_global_loss: 2064255.9722; train_optim_loss: 2064255.9722; val_kl_reg_loss: 19228.9414; val_edge_recon_loss: 40416.5195; val_gene_expr_recon_loss: 649058.4375; val_masked_gp_l1_reg_loss: 4062.6436; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57403.7539; val_chrom_access_recon_loss: 1288814.3750; val_global_loss: 2058984.6250; val_optim_loss: 2058984.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8827; val_auprc_score: 0.8672; val_best_acc_score: 0.8009; val_best_f1_score: 0.8165; train_kl_reg_loss: 20384.0953; train_edge_recon_loss: 38911.9883; train_gene_expr_recon_loss: 643320.8958; train_masked_gp_l1_reg_loss: 4065.6198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56301.3611; train_chrom_access_recon_loss: 1291951.2083; train_global_loss: 2054935.1528; train_optim_loss: 2054935.1528; val_kl_reg_loss: 18723.2832; val_edge_recon_loss: 40380.5000; val_gene_expr_recon_loss: 648109.2500; val_masked_gp_l1_reg_loss: 4060.2378; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54948.6133; val_chrom_access_recon_loss: 1286894.5000; val_global_loss: 2053116.3750; val_optim_loss: 2053116.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8923; val_auprc_score: 0.8830; val_best_acc_score: 0.8160; val_best_f1_score: 0.8262; train_kl_reg_loss: 20071.6918; train_edge_recon_loss: 38870.1493; train_gene_expr_recon_loss: 642482.2014; train_masked_gp_l1_reg_loss: 4068.4255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53919.5881; train_chrom_access_recon_loss: 1288381.4583; train_global_loss: 2047793.5278; train_optim_loss: 2047793.5278; val_kl_reg_loss: 18851.9551; val_edge_recon_loss: 40331.2930; val_gene_expr_recon_loss: 645879.0000; val_masked_gp_l1_reg_loss: 4070.8384; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52648.9531; val_chrom_access_recon_loss: 1285077.2500; val_global_loss: 2046859.2500; val_optim_loss: 2046859.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8940; val_auprc_score: 0.8823; val_best_acc_score: 0.8215; val_best_f1_score: 0.8299; train_kl_reg_loss: 19609.0879; train_edge_recon_loss: 38817.8181; train_gene_expr_recon_loss: 642749.7569; train_masked_gp_l1_reg_loss: 4077.4234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51678.5161; train_chrom_access_recon_loss: 1293071.4444; train_global_loss: 2050004.0278; train_optim_loss: 2050004.0278; val_kl_reg_loss: 19149.7227; val_edge_recon_loss: 40310.1016; val_gene_expr_recon_loss: 644059.3750; val_masked_gp_l1_reg_loss: 4076.0679; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50483.7656; val_chrom_access_recon_loss: 1283068.3750; val_global_loss: 2041147.3750; val_optim_loss: 2041147.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9026; val_auprc_score: 0.8907; val_best_acc_score: 0.8298; val_best_f1_score: 0.8334; train_kl_reg_loss: 19420.3140; train_edge_recon_loss: 38776.6797; train_gene_expr_recon_loss: 641278.6042; train_masked_gp_l1_reg_loss: 4083.2956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49572.9813; train_chrom_access_recon_loss: 1289325.5833; train_global_loss: 2042457.4306; train_optim_loss: 2042457.4306; val_kl_reg_loss: 18448.5430; val_edge_recon_loss: 40249.9844; val_gene_expr_recon_loss: 643278.0625; val_masked_gp_l1_reg_loss: 4084.1038; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48450.0352; val_chrom_access_recon_loss: 1281539.0000; val_global_loss: 2036049.7500; val_optim_loss: 2036049.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9115; val_auprc_score: 0.9013; val_best_acc_score: 0.8379; val_best_f1_score: 0.8367; train_kl_reg_loss: 19057.9371; train_edge_recon_loss: 38706.2014; train_gene_expr_recon_loss: 639874.9097; train_masked_gp_l1_reg_loss: 4088.1226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47592.5221; train_chrom_access_recon_loss: 1284333.7083; train_global_loss: 2033653.4306; train_optim_loss: 2033653.4306; val_kl_reg_loss: 17939.2949; val_edge_recon_loss: 40180.9258; val_gene_expr_recon_loss: 642465.3750; val_masked_gp_l1_reg_loss: 4090.1292; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46536.4023; val_chrom_access_recon_loss: 1279766.8750; val_global_loss: 2030979.0000; val_optim_loss: 2030979.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9197; val_auprc_score: 0.9059; val_best_acc_score: 0.8434; val_best_f1_score: 0.8378; train_kl_reg_loss: 18820.5139; train_edge_recon_loss: 38621.4813; train_gene_expr_recon_loss: 636901.0625; train_masked_gp_l1_reg_loss: 4098.0297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45731.8537; train_chrom_access_recon_loss: 1281920.7917; train_global_loss: 2026093.7222; train_optim_loss: 2026093.7222; val_kl_reg_loss: 17626.1758; val_edge_recon_loss: 40051.1641; val_gene_expr_recon_loss: 641531.8125; val_masked_gp_l1_reg_loss: 4097.3770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44738.6250; val_chrom_access_recon_loss: 1278025.0000; val_global_loss: 2026070.1250; val_optim_loss: 2026070.1250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9253; val_auprc_score: 0.9142; val_best_acc_score: 0.8554; val_best_f1_score: 0.8596; train_kl_reg_loss: 15641.5074; train_edge_recon_loss: 39731.2821; train_gene_expr_recon_loss: 915779.3819; train_masked_gp_l1_reg_loss: 4166.7401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43856.5699; train_chrom_access_recon_loss: 1359841.4306; train_global_loss: 2379016.9444; train_optim_loss: 2379016.9444; val_kl_reg_loss: 15579.6807; val_edge_recon_loss: 40261.3398; val_gene_expr_recon_loss: 907674.2500; val_masked_gp_l1_reg_loss: 4302.0220; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42695.2344; val_chrom_access_recon_loss: 1343283.2500; val_global_loss: 2353795.7500; val_optim_loss: 2353795.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9274; val_auprc_score: 0.9157; val_best_acc_score: 0.8561; val_best_f1_score: 0.8573; train_kl_reg_loss: 15809.9016; train_edge_recon_loss: 39727.6098; train_gene_expr_recon_loss: 905861.3264; train_masked_gp_l1_reg_loss: 4404.4889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41741.9089; train_chrom_access_recon_loss: 1350753.5694; train_global_loss: 2358298.7778; train_optim_loss: 2358298.7778; val_kl_reg_loss: 15606.9004; val_edge_recon_loss: 40201.7812; val_gene_expr_recon_loss: 900369.1250; val_masked_gp_l1_reg_loss: 4539.6880; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40563.1875; val_chrom_access_recon_loss: 1341670.8750; val_global_loss: 2342951.5000; val_optim_loss: 2342951.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9315; val_auprc_score: 0.9211; val_best_acc_score: 0.8554; val_best_f1_score: 0.8537; train_kl_reg_loss: 16093.1483; train_edge_recon_loss: 39692.6094; train_gene_expr_recon_loss: 900925.6806; train_masked_gp_l1_reg_loss: 4625.4966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39654.8316; train_chrom_access_recon_loss: 1351941.4306; train_global_loss: 2352933.1944; train_optim_loss: 2352933.1944; val_kl_reg_loss: 15591.3672; val_edge_recon_loss: 40122.9453; val_gene_expr_recon_loss: 895264.5000; val_masked_gp_l1_reg_loss: 4720.4287; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38544.6797; val_chrom_access_recon_loss: 1339386.5000; val_global_loss: 2333630.5000; val_optim_loss: 2333630.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9342; val_auprc_score: 0.9232; val_best_acc_score: 0.8506; val_best_f1_score: 0.8451; train_kl_reg_loss: 16218.3356; train_edge_recon_loss: 39651.4084; train_gene_expr_recon_loss: 891975.5139; train_masked_gp_l1_reg_loss: 4778.3143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37700.7904; train_chrom_access_recon_loss: 1342497.9722; train_global_loss: 2332822.3056; train_optim_loss: 2332822.3056; val_kl_reg_loss: 15411.9443; val_edge_recon_loss: 40039.6797; val_gene_expr_recon_loss: 891372.7500; val_masked_gp_l1_reg_loss: 4840.9263; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36671.6445; val_chrom_access_recon_loss: 1337723.2500; val_global_loss: 2326060.2500; val_optim_loss: 2326060.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9318; val_auprc_score: 0.9216; val_best_acc_score: 0.8448; val_best_f1_score: 0.8391; train_kl_reg_loss: 16374.9610; train_edge_recon_loss: 39623.1224; train_gene_expr_recon_loss: 893553.0000; train_masked_gp_l1_reg_loss: 4829.4015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36558.1997; train_chrom_access_recon_loss: 1348072.5694; train_global_loss: 2339011.2778; train_optim_loss: 2339011.2778; val_kl_reg_loss: 15064.5361; val_edge_recon_loss: 40025.1680; val_gene_expr_recon_loss: 891261.2500; val_masked_gp_l1_reg_loss: 4817.9131; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36419.5312; val_chrom_access_recon_loss: 1337699.2500; val_global_loss: 2325287.5000; val_optim_loss: 2325287.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9285; val_auprc_score: 0.9155; val_best_acc_score: 0.8448; val_best_f1_score: 0.8390; train_kl_reg_loss: 16091.6426; train_edge_recon_loss: 39600.0061; train_gene_expr_recon_loss: 889643.3194; train_masked_gp_l1_reg_loss: 4815.8453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36321.3850; train_chrom_access_recon_loss: 1346726.6944; train_global_loss: 2333198.8611; train_optim_loss: 2333198.8611; val_kl_reg_loss: 15056.7910; val_edge_recon_loss: 40040.3711; val_gene_expr_recon_loss: 890852.8750; val_masked_gp_l1_reg_loss: 4812.5186; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36197.9727; val_chrom_access_recon_loss: 1337368.3750; val_global_loss: 2324329.0000; val_optim_loss: 2324329.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9348; val_auprc_score: 0.9209; val_best_acc_score: 0.8511; val_best_f1_score: 0.8444; train_kl_reg_loss: 16153.3222; train_edge_recon_loss: 39599.9653; train_gene_expr_recon_loss: 888227.9931; train_masked_gp_l1_reg_loss: 4811.4885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36104.4032; train_chrom_access_recon_loss: 1341855.0556; train_global_loss: 2326752.2222; train_optim_loss: 2326752.2222; val_kl_reg_loss: 15153.7773; val_edge_recon_loss: 39989.1953; val_gene_expr_recon_loss: 890517.5625; val_masked_gp_l1_reg_loss: 4810.6221; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35989.0508; val_chrom_access_recon_loss: 1337347.0000; val_global_loss: 2323807.2500; val_optim_loss: 2323807.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9330; val_auprc_score: 0.9225; val_best_acc_score: 0.8467; val_best_f1_score: 0.8401; train_kl_reg_loss: 16196.7243; train_edge_recon_loss: 39583.6107; train_gene_expr_recon_loss: 887158.8472; train_masked_gp_l1_reg_loss: 4810.8500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35899.3012; train_chrom_access_recon_loss: 1342000.5556; train_global_loss: 2325649.8889; train_optim_loss: 2325649.8889; val_kl_reg_loss: 15175.1641; val_edge_recon_loss: 40000.7773; val_gene_expr_recon_loss: 890149.2500; val_masked_gp_l1_reg_loss: 4811.5503; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35790.1758; val_chrom_access_recon_loss: 1337062.2500; val_global_loss: 2322989.2500; val_optim_loss: 2322989.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9202
val AUPRC score: 0.9080
val best accuracy score: 0.8503
val best F1 score: 0.8560
val target rna MSE score: 3.9805
val source rna MSE score: 3.1827
val target atac MSE score: 0.1351
val source atac MSE score: 0.0197
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
