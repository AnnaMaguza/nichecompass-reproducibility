[True]
Run timestamp: 26072023_033409_128.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_128']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9636; val_auprc_score: 0.9643; val_best_acc_score: 0.5862; val_best_f1_score: 0.7068; train_kl_reg_loss: 20530.9071; train_edge_recon_loss: 34689498.2222; train_gene_expr_recon_loss: 3150059.1944; train_masked_gp_l1_reg_loss: 1861.1146; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1077050.2986; train_global_loss: 38939000.4444; train_optim_loss: 38939000.4444; val_kl_reg_loss: 35878.8750; val_edge_recon_loss: 40599248.0000; val_gene_expr_recon_loss: 3066073.2500; val_masked_gp_l1_reg_loss: 1852.2134; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1074460.6250; val_global_loss: 44777512.0000; val_optim_loss: 44777512.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9533; val_auprc_score: 0.9542; val_best_acc_score: 0.7352; val_best_f1_score: 0.7887; train_kl_reg_loss: 18323.4729; train_edge_recon_loss: 34701972.8889; train_gene_expr_recon_loss: 3113889.3056; train_masked_gp_l1_reg_loss: 1903.8729; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1110112.5694; train_global_loss: 38946202.2222; train_optim_loss: 38946202.2222; val_kl_reg_loss: 4681.6890; val_edge_recon_loss: 40524436.0000; val_gene_expr_recon_loss: 2988123.2500; val_masked_gp_l1_reg_loss: 1998.1079; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1071201.2500; val_global_loss: 44590440.0000; val_optim_loss: 44590440.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9297; val_auprc_score: 0.9317; val_best_acc_score: 0.8380; val_best_f1_score: 0.8498; train_kl_reg_loss: 4184.4231; train_edge_recon_loss: 34687928.0000; train_gene_expr_recon_loss: 2958160.5278; train_masked_gp_l1_reg_loss: 2113.6370; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1070536.8750; train_global_loss: 38722922.6667; train_optim_loss: 38722922.6667; val_kl_reg_loss: 5513.0205; val_edge_recon_loss: 40273048.0000; val_gene_expr_recon_loss: 2882015.7500; val_masked_gp_l1_reg_loss: 2274.8989; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1063475.0000; val_global_loss: 44226328.0000; val_optim_loss: 44226328.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9093; val_auprc_score: 0.9004; val_best_acc_score: 0.8196; val_best_f1_score: 0.8348; train_kl_reg_loss: 9838.8363; train_edge_recon_loss: 34644118.6667; train_gene_expr_recon_loss: 2847736.4167; train_masked_gp_l1_reg_loss: 2410.8822; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1064380.7361; train_global_loss: 38568484.0000; train_optim_loss: 38568484.0000; val_kl_reg_loss: 6538.4258; val_edge_recon_loss: 38142304.0000; val_gene_expr_recon_loss: 2786171.7500; val_masked_gp_l1_reg_loss: 2575.9106; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1054880.3750; val_global_loss: 41992472.0000; val_optim_loss: 41992472.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8532; val_auprc_score: 0.8429; val_best_acc_score: 0.7549; val_best_f1_score: 0.7871; train_kl_reg_loss: 3702.3220; train_edge_recon_loss: 33688094.2222; train_gene_expr_recon_loss: 2834242.6667; train_masked_gp_l1_reg_loss: 2700.1706; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1061225.7847; train_global_loss: 37589964.8889; train_optim_loss: 37589964.8889; val_kl_reg_loss: 3706.9585; val_edge_recon_loss: 30664826.0000; val_gene_expr_recon_loss: 2857619.5000; val_masked_gp_l1_reg_loss: 2850.0637; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059928.5000; val_global_loss: 34588932.0000; val_optim_loss: 34588932.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8611; val_auprc_score: 0.8576; val_best_acc_score: 0.7630; val_best_f1_score: 0.7864; train_kl_reg_loss: 11185.8794; train_edge_recon_loss: 29751746.6667; train_gene_expr_recon_loss: 2881165.2778; train_masked_gp_l1_reg_loss: 2949.2262; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1062781.7361; train_global_loss: 33709829.1111; train_optim_loss: 33709829.1111; val_kl_reg_loss: 22937.4258; val_edge_recon_loss: 28916470.0000; val_gene_expr_recon_loss: 2896525.7500; val_masked_gp_l1_reg_loss: 3051.0718; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061199.7500; val_global_loss: 32900186.0000; val_optim_loss: 32900186.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8727; val_auprc_score: 0.8588; val_best_acc_score: 0.7794; val_best_f1_score: 0.7937; train_kl_reg_loss: 34593.4134; train_edge_recon_loss: 28585092.0000; train_gene_expr_recon_loss: 2818079.7222; train_masked_gp_l1_reg_loss: 3108.1938; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1053998.0347; train_global_loss: 32494871.3333; train_optim_loss: 32494871.3333; val_kl_reg_loss: 44405.1641; val_edge_recon_loss: 28445860.0000; val_gene_expr_recon_loss: 2735080.5000; val_masked_gp_l1_reg_loss: 3180.8484; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1046086.4375; val_global_loss: 32274612.0000; val_optim_loss: 32274612.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8732; val_auprc_score: 0.8506; val_best_acc_score: 0.7851; val_best_f1_score: 0.8040; train_kl_reg_loss: 51035.7747; train_edge_recon_loss: 28324010.6667; train_gene_expr_recon_loss: 2695497.6389; train_masked_gp_l1_reg_loss: 3239.4634; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046343.7569; train_global_loss: 32120126.8889; train_optim_loss: 32120126.8889; val_kl_reg_loss: 53964.2109; val_edge_recon_loss: 28447532.0000; val_gene_expr_recon_loss: 2683303.2500; val_masked_gp_l1_reg_loss: 3308.9307; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1045356.6875; val_global_loss: 32233464.0000; val_optim_loss: 32233464.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8846; val_auprc_score: 0.8546; val_best_acc_score: 0.8102; val_best_f1_score: 0.8262; train_kl_reg_loss: 59518.2161; train_edge_recon_loss: 27842487.7778; train_gene_expr_recon_loss: 2668885.2778; train_masked_gp_l1_reg_loss: 3360.7092; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1045601.8333; train_global_loss: 31619854.0000; train_optim_loss: 31619854.0000; val_kl_reg_loss: 60353.6484; val_edge_recon_loss: 28303906.0000; val_gene_expr_recon_loss: 2644875.7500; val_masked_gp_l1_reg_loss: 3422.5720; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1042094.0625; val_global_loss: 32054652.0000; val_optim_loss: 32054652.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9137; val_auprc_score: 0.8817; val_best_acc_score: 0.8515; val_best_f1_score: 0.8622; train_kl_reg_loss: 62661.5191; train_edge_recon_loss: 27649161.5556; train_gene_expr_recon_loss: 2630836.5000; train_masked_gp_l1_reg_loss: 3465.2534; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1035226.1319; train_global_loss: 31381350.6667; train_optim_loss: 31381350.6667; val_kl_reg_loss: 62479.6484; val_edge_recon_loss: 27324590.0000; val_gene_expr_recon_loss: 2621906.0000; val_masked_gp_l1_reg_loss: 3515.3169; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1037279.7500; val_global_loss: 31049772.0000; val_optim_loss: 31049772.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9182; val_auprc_score: 0.8885; val_best_acc_score: 0.8614; val_best_f1_score: 0.8696; train_kl_reg_loss: 65715.4748; train_edge_recon_loss: 27145474.8889; train_gene_expr_recon_loss: 2589396.0000; train_masked_gp_l1_reg_loss: 3552.5676; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1036887.3125; train_global_loss: 30841025.7778; train_optim_loss: 30841025.7778; val_kl_reg_loss: 66241.5938; val_edge_recon_loss: 27409228.0000; val_gene_expr_recon_loss: 2586051.0000; val_masked_gp_l1_reg_loss: 3598.4583; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1033689.2500; val_global_loss: 31098808.0000; val_optim_loss: 31098808.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9270; val_auprc_score: 0.9054; val_best_acc_score: 0.8636; val_best_f1_score: 0.8713; train_kl_reg_loss: 72143.2882; train_edge_recon_loss: 27053659.5556; train_gene_expr_recon_loss: 2570002.6944; train_masked_gp_l1_reg_loss: 3636.7879; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1034104.1181; train_global_loss: 30733545.3333; train_optim_loss: 30733545.3333; val_kl_reg_loss: 72735.8672; val_edge_recon_loss: 27281484.0000; val_gene_expr_recon_loss: 2575226.0000; val_masked_gp_l1_reg_loss: 3683.8708; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1028589.7500; val_global_loss: 30961720.0000; val_optim_loss: 30961720.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9305; val_auprc_score: 0.9086; val_best_acc_score: 0.8678; val_best_f1_score: 0.8754; train_kl_reg_loss: 75385.2109; train_edge_recon_loss: 27091744.8889; train_gene_expr_recon_loss: 2561601.8056; train_masked_gp_l1_reg_loss: 3722.4403; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1027688.5139; train_global_loss: 30760142.4444; train_optim_loss: 30760142.4444; val_kl_reg_loss: 72588.8203; val_edge_recon_loss: 27369064.0000; val_gene_expr_recon_loss: 2535964.7500; val_masked_gp_l1_reg_loss: 3770.0068; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026230.6875; val_global_loss: 31007616.0000; val_optim_loss: 31007616.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9362; val_auprc_score: 0.9151; val_best_acc_score: 0.8802; val_best_f1_score: 0.8867; train_kl_reg_loss: 74852.9167; train_edge_recon_loss: 27156819.7778; train_gene_expr_recon_loss: 2510063.4167; train_masked_gp_l1_reg_loss: 3809.1170; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1024203.2500; train_global_loss: 30769748.4444; train_optim_loss: 30769748.4444; val_kl_reg_loss: 73095.7656; val_edge_recon_loss: 27124738.0000; val_gene_expr_recon_loss: 2522178.5000; val_masked_gp_l1_reg_loss: 3855.6372; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1025072.3750; val_global_loss: 30748940.0000; val_optim_loss: 30748940.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9343; val_auprc_score: 0.9129; val_best_acc_score: 0.8740; val_best_f1_score: 0.8824; train_kl_reg_loss: 75392.1944; train_edge_recon_loss: 27037912.2222; train_gene_expr_recon_loss: 2478130.2222; train_masked_gp_l1_reg_loss: 3890.8881; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1019841.7153; train_global_loss: 30615167.3333; train_optim_loss: 30615167.3333; val_kl_reg_loss: 72217.1172; val_edge_recon_loss: 27234236.0000; val_gene_expr_recon_loss: 2482747.7500; val_masked_gp_l1_reg_loss: 3931.8750; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022572.0000; val_global_loss: 30815706.0000; val_optim_loss: 30815706.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9375; val_auprc_score: 0.9146; val_best_acc_score: 0.8837; val_best_f1_score: 0.8912; train_kl_reg_loss: 75910.8655; train_edge_recon_loss: 27019964.6667; train_gene_expr_recon_loss: 2442986.6389; train_masked_gp_l1_reg_loss: 3963.0242; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1018331.3819; train_global_loss: 30561156.6667; train_optim_loss: 30561156.6667; val_kl_reg_loss: 73291.0469; val_edge_recon_loss: 26964826.0000; val_gene_expr_recon_loss: 2461255.2500; val_masked_gp_l1_reg_loss: 3999.8010; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1021072.2500; val_global_loss: 30524446.0000; val_optim_loss: 30524446.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9413; val_auprc_score: 0.9222; val_best_acc_score: 0.8855; val_best_f1_score: 0.8928; train_kl_reg_loss: 76436.5530; train_edge_recon_loss: 26887285.7778; train_gene_expr_recon_loss: 2430268.5833; train_masked_gp_l1_reg_loss: 4027.6219; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1016176.2014; train_global_loss: 30414194.2222; train_optim_loss: 30414194.2222; val_kl_reg_loss: 75165.2188; val_edge_recon_loss: 27054840.0000; val_gene_expr_recon_loss: 2437780.7500; val_masked_gp_l1_reg_loss: 4061.5215; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1017301.2500; val_global_loss: 30589150.0000; val_optim_loss: 30589150.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9444; val_auprc_score: 0.9239; val_best_acc_score: 0.8864; val_best_f1_score: 0.8941; train_kl_reg_loss: 78835.5998; train_edge_recon_loss: 26902192.6667; train_gene_expr_recon_loss: 2424502.3333; train_masked_gp_l1_reg_loss: 4088.7488; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1020075.0625; train_global_loss: 30429694.4444; train_optim_loss: 30429694.4444; val_kl_reg_loss: 75107.5938; val_edge_recon_loss: 27083846.0000; val_gene_expr_recon_loss: 2420785.2500; val_masked_gp_l1_reg_loss: 4120.4072; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015324.6875; val_global_loss: 30599184.0000; val_optim_loss: 30599184.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9409; val_auprc_score: 0.9225; val_best_acc_score: 0.8826; val_best_f1_score: 0.8902; train_kl_reg_loss: 79356.7613; train_edge_recon_loss: 26923051.1111; train_gene_expr_recon_loss: 2404213.3889; train_masked_gp_l1_reg_loss: 4146.5105; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1013931.7292; train_global_loss: 30424699.5556; train_optim_loss: 30424699.5556; val_kl_reg_loss: 76428.2031; val_edge_recon_loss: 27163986.0000; val_gene_expr_recon_loss: 2389232.7500; val_masked_gp_l1_reg_loss: 4177.2661; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1012434.1250; val_global_loss: 30646258.0000; val_optim_loss: 30646258.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9476; val_auprc_score: 0.9242; val_best_acc_score: 0.8910; val_best_f1_score: 0.8970; train_kl_reg_loss: 79349.1884; train_edge_recon_loss: 27050662.8889; train_gene_expr_recon_loss: 2374648.6389; train_masked_gp_l1_reg_loss: 4201.4435; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1008343.0486; train_global_loss: 30517205.5556; train_optim_loss: 30517205.5556; val_kl_reg_loss: 76144.4531; val_edge_recon_loss: 26841136.0000; val_gene_expr_recon_loss: 2412644.2500; val_masked_gp_l1_reg_loss: 4230.0918; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015282.3125; val_global_loss: 30349436.0000; val_optim_loss: 30349436.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9525; val_auprc_score: 0.9335; val_best_acc_score: 0.8968; val_best_f1_score: 0.9030; train_kl_reg_loss: 78966.7760; train_edge_recon_loss: 26856283.1111; train_gene_expr_recon_loss: 2362679.6667; train_masked_gp_l1_reg_loss: 4253.4106; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1012438.6667; train_global_loss: 30314621.5556; train_optim_loss: 30314621.5556; val_kl_reg_loss: 75347.5469; val_edge_recon_loss: 26703686.0000; val_gene_expr_recon_loss: 2384713.0000; val_masked_gp_l1_reg_loss: 4280.2969; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1011466.9375; val_global_loss: 30179494.0000; val_optim_loss: 30179494.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9553; val_auprc_score: 0.9394; val_best_acc_score: 0.9030; val_best_f1_score: 0.9080; train_kl_reg_loss: 77561.6832; train_edge_recon_loss: 26806553.5556; train_gene_expr_recon_loss: 2353963.3611; train_masked_gp_l1_reg_loss: 4298.6210; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1009198.2153; train_global_loss: 30251575.3333; train_optim_loss: 30251575.3333; val_kl_reg_loss: 74010.1797; val_edge_recon_loss: 26838204.0000; val_gene_expr_recon_loss: 2378999.0000; val_masked_gp_l1_reg_loss: 4319.5708; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010401.0000; val_global_loss: 30305932.0000; val_optim_loss: 30305932.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9578; val_auprc_score: 0.9397; val_best_acc_score: 0.9076; val_best_f1_score: 0.9120; train_kl_reg_loss: 77103.8012; train_edge_recon_loss: 26741680.4444; train_gene_expr_recon_loss: 2345142.2778; train_masked_gp_l1_reg_loss: 4332.5825; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007110.2153; train_global_loss: 30175369.5556; train_optim_loss: 30175369.5556; val_kl_reg_loss: 74989.9297; val_edge_recon_loss: 26805500.0000; val_gene_expr_recon_loss: 2366098.7500; val_masked_gp_l1_reg_loss: 4346.3198; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1009098.3125; val_global_loss: 30260032.0000; val_optim_loss: 30260032.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9591; val_auprc_score: 0.9418; val_best_acc_score: 0.9096; val_best_f1_score: 0.9137; train_kl_reg_loss: 77940.8967; train_edge_recon_loss: 26805450.2222; train_gene_expr_recon_loss: 2343633.8889; train_masked_gp_l1_reg_loss: 4355.9921; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007020.5139; train_global_loss: 30238401.1111; train_optim_loss: 30238401.1111; val_kl_reg_loss: 74859.9219; val_edge_recon_loss: 26671076.0000; val_gene_expr_recon_loss: 2386314.2500; val_masked_gp_l1_reg_loss: 4365.1045; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1009917.3125; val_global_loss: 30146534.0000; val_optim_loss: 30146534.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9615; val_auprc_score: 0.9492; val_best_acc_score: 0.9101; val_best_f1_score: 0.9137; train_kl_reg_loss: 78704.1207; train_edge_recon_loss: 26597681.7778; train_gene_expr_recon_loss: 2337156.2500; train_masked_gp_l1_reg_loss: 4369.4023; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011780.2222; train_global_loss: 30029691.7778; train_optim_loss: 30029691.7778; val_kl_reg_loss: 77787.7031; val_edge_recon_loss: 26506206.0000; val_gene_expr_recon_loss: 2351674.0000; val_masked_gp_l1_reg_loss: 4375.6318; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005711.6875; val_global_loss: 29945756.0000; val_optim_loss: 29945756.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9579; val_auprc_score: 0.9419; val_best_acc_score: 0.9065; val_best_f1_score: 0.9092; train_kl_reg_loss: 81249.4366; train_edge_recon_loss: 26507966.8889; train_gene_expr_recon_loss: 2341171.6667; train_masked_gp_l1_reg_loss: 4382.8931; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003660.5208; train_global_loss: 29938431.7778; train_optim_loss: 29938431.7778; val_kl_reg_loss: 79664.4219; val_edge_recon_loss: 26737282.0000; val_gene_expr_recon_loss: 2364935.7500; val_masked_gp_l1_reg_loss: 4390.6445; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003770.2500; val_global_loss: 30190042.0000; val_optim_loss: 30190042.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9611; val_auprc_score: 0.9485; val_best_acc_score: 0.9091; val_best_f1_score: 0.9126; train_kl_reg_loss: 82517.2179; train_edge_recon_loss: 26459890.4444; train_gene_expr_recon_loss: 2326454.3889; train_masked_gp_l1_reg_loss: 4399.7985; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007598.3472; train_global_loss: 29880860.0000; train_optim_loss: 29880860.0000; val_kl_reg_loss: 80530.8281; val_edge_recon_loss: 26637306.0000; val_gene_expr_recon_loss: 2356952.5000; val_masked_gp_l1_reg_loss: 4410.7085; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004097.8750; val_global_loss: 30083296.0000; val_optim_loss: 30083296.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9604; val_auprc_score: 0.9435; val_best_acc_score: 0.9092; val_best_f1_score: 0.9131; train_kl_reg_loss: 82307.9444; train_edge_recon_loss: 26607948.0000; train_gene_expr_recon_loss: 2320566.0000; train_masked_gp_l1_reg_loss: 4423.6217; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003027.9722; train_global_loss: 30018273.7778; train_optim_loss: 30018273.7778; val_kl_reg_loss: 79981.0078; val_edge_recon_loss: 26589468.0000; val_gene_expr_recon_loss: 2330685.5000; val_masked_gp_l1_reg_loss: 4440.0879; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 999995.7500; val_global_loss: 30004572.0000; val_optim_loss: 30004572.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9636; val_auprc_score: 0.9462; val_best_acc_score: 0.9109; val_best_f1_score: 0.9148; train_kl_reg_loss: 83600.8984; train_edge_recon_loss: 26546042.2222; train_gene_expr_recon_loss: 2294671.7222; train_masked_gp_l1_reg_loss: 4453.5044; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 991638.2639; train_global_loss: 29920406.4444; train_optim_loss: 29920406.4444; val_kl_reg_loss: 82146.1562; val_edge_recon_loss: 26731374.0000; val_gene_expr_recon_loss: 2323770.5000; val_masked_gp_l1_reg_loss: 4469.3882; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 999081.5000; val_global_loss: 30140842.0000; val_optim_loss: 30140842.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9641; val_auprc_score: 0.9496; val_best_acc_score: 0.9107; val_best_f1_score: 0.9131; train_kl_reg_loss: 84443.3177; train_edge_recon_loss: 26472570.2222; train_gene_expr_recon_loss: 2284258.0833; train_masked_gp_l1_reg_loss: 4470.2414; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 997230.9583; train_global_loss: 29842972.8889; train_optim_loss: 29842972.8889; val_kl_reg_loss: 82093.1719; val_edge_recon_loss: 26690632.0000; val_gene_expr_recon_loss: 2319411.5000; val_masked_gp_l1_reg_loss: 4470.7222; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 999929.9375; val_global_loss: 30096538.0000; val_optim_loss: 30096538.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9618; val_auprc_score: 0.9489; val_best_acc_score: 0.9076; val_best_f1_score: 0.9109; train_kl_reg_loss: 84554.1207; train_edge_recon_loss: 26501554.0000; train_gene_expr_recon_loss: 2294170.7778; train_masked_gp_l1_reg_loss: 4471.0913; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994872.0972; train_global_loss: 29879622.4444; train_optim_loss: 29879622.4444; val_kl_reg_loss: 82489.2656; val_edge_recon_loss: 26725296.0000; val_gene_expr_recon_loss: 2321084.0000; val_masked_gp_l1_reg_loss: 4471.6758; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998836.9375; val_global_loss: 30132178.0000; val_optim_loss: 30132178.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9654; val_auprc_score: 0.9509; val_best_acc_score: 0.9144; val_best_f1_score: 0.9166; train_kl_reg_loss: 84959.1076; train_edge_recon_loss: 26510050.4444; train_gene_expr_recon_loss: 2301233.9167; train_masked_gp_l1_reg_loss: 4472.4099; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003128.7986; train_global_loss: 29903844.2222; train_optim_loss: 29903844.2222; val_kl_reg_loss: 82186.5938; val_edge_recon_loss: 26563832.0000; val_gene_expr_recon_loss: 2318114.5000; val_masked_gp_l1_reg_loss: 4473.3662; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998494.5000; val_global_loss: 29967100.0000; val_optim_loss: 29967100.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9662; val_auprc_score: 0.9545; val_best_acc_score: 0.9142; val_best_f1_score: 0.9165; train_kl_reg_loss: 85133.2118; train_edge_recon_loss: 26402537.3333; train_gene_expr_recon_loss: 2304071.7500; train_masked_gp_l1_reg_loss: 4474.3019; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002730.6389; train_global_loss: 29798947.5556; train_optim_loss: 29798947.5556; val_kl_reg_loss: 81906.5938; val_edge_recon_loss: 26675260.0000; val_gene_expr_recon_loss: 2318632.0000; val_masked_gp_l1_reg_loss: 4475.2739; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998934.0000; val_global_loss: 30079208.0000; val_optim_loss: 30079208.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9584
Val AUPRC score: 0.9429
Val best accuracy score: 0.9064
Val best F1 score: 0.9104
Val gene expr MSE score: 0.5792
Val chrom access MSE score: 0.0897
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
