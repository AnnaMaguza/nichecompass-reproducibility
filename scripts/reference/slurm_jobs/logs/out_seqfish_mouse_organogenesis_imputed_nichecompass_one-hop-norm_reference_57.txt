[True]
Run timestamp: 01082023_084318_57.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_57']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8988; val_auprc_score: 0.9807; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 164087.3070; train_edge_recon_loss: 117281.7756; train_gene_expr_recon_loss: 4702009.6481; train_masked_gp_l1_reg_loss: 6763.0721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59037.3961; train_global_loss: 5049179.2130; train_optim_loss: 5049179.2130; val_kl_reg_loss: 174758.3672; val_edge_recon_loss: 118466.3099; val_gene_expr_recon_loss: 3976286.3333; val_masked_gp_l1_reg_loss: 6990.1030; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54820.9297; val_global_loss: 4331322.0833; val_optim_loss: 4331322.0833
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8892; val_auprc_score: 0.9793; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 127562.1168; train_edge_recon_loss: 120597.9764; train_gene_expr_recon_loss: 3421057.4352; train_masked_gp_l1_reg_loss: 6902.6600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51409.1157; train_global_loss: 3727529.3056; train_optim_loss: 3727529.3056; val_kl_reg_loss: 90772.6094; val_edge_recon_loss: 118389.0924; val_gene_expr_recon_loss: 2867077.0833; val_masked_gp_l1_reg_loss: 6779.8540; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48084.6406; val_global_loss: 3131103.2500; val_optim_loss: 3131103.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8596; val_auprc_score: 0.9724; val_best_acc_score: 0.8639; val_best_f1_score: 0.9264; train_kl_reg_loss: 82646.9604; train_edge_recon_loss: 118962.8987; train_gene_expr_recon_loss: 2642643.1435; train_masked_gp_l1_reg_loss: 6659.6145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45278.3791; train_global_loss: 2896191.0231; train_optim_loss: 2896191.0231; val_kl_reg_loss: 69978.7656; val_edge_recon_loss: 116556.8776; val_gene_expr_recon_loss: 2516793.0833; val_masked_gp_l1_reg_loss: 6545.2793; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42595.0703; val_global_loss: 2752468.9583; val_optim_loss: 2752468.9583
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8527; val_auprc_score: 0.9692; val_best_acc_score: 0.8801; val_best_f1_score: 0.9335; train_kl_reg_loss: 64079.3316; train_edge_recon_loss: 119312.3799; train_gene_expr_recon_loss: 2460651.1667; train_masked_gp_l1_reg_loss: 6468.0311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40471.4230; train_global_loss: 2690982.3611; train_optim_loss: 2690982.3611; val_kl_reg_loss: 53983.5560; val_edge_recon_loss: 118922.9141; val_gene_expr_recon_loss: 2356367.6667; val_masked_gp_l1_reg_loss: 6421.9946; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38517.4102; val_global_loss: 2574213.6250; val_optim_loss: 2574213.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8442; val_auprc_score: 0.9672; val_best_acc_score: 0.8696; val_best_f1_score: 0.9287; train_kl_reg_loss: 55739.8532; train_edge_recon_loss: 117664.0161; train_gene_expr_recon_loss: 2398857.9630; train_masked_gp_l1_reg_loss: 6374.2172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37127.0083; train_global_loss: 2615763.0509; train_optim_loss: 2615763.0509; val_kl_reg_loss: 48065.8600; val_edge_recon_loss: 120219.2617; val_gene_expr_recon_loss: 2368098.9583; val_masked_gp_l1_reg_loss: 6328.4941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35936.3906; val_global_loss: 2578649.0833; val_optim_loss: 2578649.0833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8440; val_auprc_score: 0.9670; val_best_acc_score: 0.8814; val_best_f1_score: 0.9343; train_kl_reg_loss: 46183.4935; train_edge_recon_loss: 117345.1891; train_gene_expr_recon_loss: 2256565.4630; train_masked_gp_l1_reg_loss: 6360.4953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35285.3537; train_global_loss: 2461739.9907; train_optim_loss: 2461739.9907; val_kl_reg_loss: 43661.2057; val_edge_recon_loss: 115973.2747; val_gene_expr_recon_loss: 2194523.2917; val_masked_gp_l1_reg_loss: 6382.5200; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34843.1914; val_global_loss: 2395383.5000; val_optim_loss: 2395383.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8515; val_auprc_score: 0.9679; val_best_acc_score: 0.8788; val_best_f1_score: 0.9327; train_kl_reg_loss: 43376.2914; train_edge_recon_loss: 117394.2237; train_gene_expr_recon_loss: 2179424.5602; train_masked_gp_l1_reg_loss: 6373.7798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34562.0313; train_global_loss: 2381130.8843; train_optim_loss: 2381130.8843; val_kl_reg_loss: 40310.8581; val_edge_recon_loss: 119760.3151; val_gene_expr_recon_loss: 2162145.4583; val_masked_gp_l1_reg_loss: 6365.8457; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34270.6055; val_global_loss: 2362852.9167; val_optim_loss: 2362852.9167
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8511; val_auprc_score: 0.9684; val_best_acc_score: 0.8811; val_best_f1_score: 0.9345; train_kl_reg_loss: 40275.3892; train_edge_recon_loss: 115441.4023; train_gene_expr_recon_loss: 2154055.4676; train_masked_gp_l1_reg_loss: 6368.6705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33983.0383; train_global_loss: 2350123.9583; train_optim_loss: 2350123.9583; val_kl_reg_loss: 37527.3522; val_edge_recon_loss: 115364.3659; val_gene_expr_recon_loss: 2137831.7083; val_masked_gp_l1_reg_loss: 6377.7051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33680.7695; val_global_loss: 2330781.9583; val_optim_loss: 2330781.9583
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8566; val_auprc_score: 0.9690; val_best_acc_score: 0.8773; val_best_f1_score: 0.9323; train_kl_reg_loss: 37787.5803; train_edge_recon_loss: 115547.1282; train_gene_expr_recon_loss: 2131083.4352; train_masked_gp_l1_reg_loss: 6393.2944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33383.9916; train_global_loss: 2324195.4028; train_optim_loss: 2324195.4028; val_kl_reg_loss: 35557.1159; val_edge_recon_loss: 117214.5951; val_gene_expr_recon_loss: 2120172.2917; val_masked_gp_l1_reg_loss: 6412.2920; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33072.6953; val_global_loss: 2312429.0417; val_optim_loss: 2312429.0417
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8669; val_auprc_score: 0.9714; val_best_acc_score: 0.8829; val_best_f1_score: 0.9344; train_kl_reg_loss: 35761.6359; train_edge_recon_loss: 114386.9313; train_gene_expr_recon_loss: 2109980.5625; train_masked_gp_l1_reg_loss: 6434.3359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32768.4439; train_global_loss: 2299331.9074; train_optim_loss: 2299331.9074; val_kl_reg_loss: 33406.0475; val_edge_recon_loss: 114412.4688; val_gene_expr_recon_loss: 2096073.9792; val_masked_gp_l1_reg_loss: 6459.8965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32451.9883; val_global_loss: 2282804.5000; val_optim_loss: 2282804.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8804; val_auprc_score: 0.9738; val_best_acc_score: 0.8890; val_best_f1_score: 0.9382; train_kl_reg_loss: 34067.3388; train_edge_recon_loss: 113273.2150; train_gene_expr_recon_loss: 2089802.3912; train_masked_gp_l1_reg_loss: 6488.4938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32144.3562; train_global_loss: 2275775.7778; train_optim_loss: 2275775.7778; val_kl_reg_loss: 32304.2871; val_edge_recon_loss: 111178.9740; val_gene_expr_recon_loss: 2076027.2500; val_masked_gp_l1_reg_loss: 6519.3350; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31825.0078; val_global_loss: 2257854.7083; val_optim_loss: 2257854.7083
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8859; val_auprc_score: 0.9756; val_best_acc_score: 0.8908; val_best_f1_score: 0.9383; train_kl_reg_loss: 32634.6100; train_edge_recon_loss: 112416.7201; train_gene_expr_recon_loss: 2069731.1944; train_masked_gp_l1_reg_loss: 6551.1343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31514.5622; train_global_loss: 2252848.2315; train_optim_loss: 2252848.2315; val_kl_reg_loss: 30973.5247; val_edge_recon_loss: 110627.4062; val_gene_expr_recon_loss: 2057379.4583; val_masked_gp_l1_reg_loss: 6586.7207; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31191.6406; val_global_loss: 2236758.8750; val_optim_loss: 2236758.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8915; val_auprc_score: 0.9760; val_best_acc_score: 0.8939; val_best_f1_score: 0.9396; train_kl_reg_loss: 31547.9829; train_edge_recon_loss: 110017.6551; train_gene_expr_recon_loss: 2050432.4884; train_masked_gp_l1_reg_loss: 6621.0609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30879.0339; train_global_loss: 2229498.2361; train_optim_loss: 2229498.2361; val_kl_reg_loss: 29844.4535; val_edge_recon_loss: 113411.9753; val_gene_expr_recon_loss: 2038393.9792; val_masked_gp_l1_reg_loss: 6658.6729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30553.4023; val_global_loss: 2218862.6250; val_optim_loss: 2218862.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8934; val_auprc_score: 0.9772; val_best_acc_score: 0.8959; val_best_f1_score: 0.9409; train_kl_reg_loss: 30429.9367; train_edge_recon_loss: 108399.2402; train_gene_expr_recon_loss: 2033711.6782; train_masked_gp_l1_reg_loss: 6694.3744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30236.0107; train_global_loss: 2209471.2593; train_optim_loss: 2209471.2593; val_kl_reg_loss: 28966.7487; val_edge_recon_loss: 111228.2435; val_gene_expr_recon_loss: 2019728.3333; val_masked_gp_l1_reg_loss: 6731.8604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29905.2383; val_global_loss: 2196560.3333; val_optim_loss: 2196560.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8963; val_auprc_score: 0.9776; val_best_acc_score: 0.9026; val_best_f1_score: 0.9447; train_kl_reg_loss: 29545.9935; train_edge_recon_loss: 107851.8775; train_gene_expr_recon_loss: 2016769.2407; train_masked_gp_l1_reg_loss: 6769.3711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29582.9041; train_global_loss: 2190519.3611; train_optim_loss: 2190519.3611; val_kl_reg_loss: 28083.5195; val_edge_recon_loss: 107489.5299; val_gene_expr_recon_loss: 2006556.7292; val_masked_gp_l1_reg_loss: 6809.3809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29246.0273; val_global_loss: 2178185.2917; val_optim_loss: 2178185.2917
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9062; val_auprc_score: 0.9786; val_best_acc_score: 0.9074; val_best_f1_score: 0.9470; train_kl_reg_loss: 28672.4040; train_edge_recon_loss: 106063.9501; train_gene_expr_recon_loss: 2000464.1065; train_masked_gp_l1_reg_loss: 6847.7243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28916.6463; train_global_loss: 2170964.8056; train_optim_loss: 2170964.8056; val_kl_reg_loss: 27331.7129; val_edge_recon_loss: 110163.3594; val_gene_expr_recon_loss: 1989673.0417; val_masked_gp_l1_reg_loss: 6889.7939; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28573.4062; val_global_loss: 2162631.3750; val_optim_loss: 2162631.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9105; val_auprc_score: 0.9809; val_best_acc_score: 0.9139; val_best_f1_score: 0.9509; train_kl_reg_loss: 27864.1159; train_edge_recon_loss: 104710.6503; train_gene_expr_recon_loss: 1985668.4884; train_masked_gp_l1_reg_loss: 6929.4176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28240.4567; train_global_loss: 2153413.1065; train_optim_loss: 2153413.1065; val_kl_reg_loss: 26568.7370; val_edge_recon_loss: 104171.8789; val_gene_expr_recon_loss: 1974432.8750; val_masked_gp_l1_reg_loss: 6972.5879; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27896.0078; val_global_loss: 2140042.0000; val_optim_loss: 2140042.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9032; val_auprc_score: 0.9785; val_best_acc_score: 0.9119; val_best_f1_score: 0.9497; train_kl_reg_loss: 27168.5788; train_edge_recon_loss: 104840.6892; train_gene_expr_recon_loss: 1971689.9120; train_masked_gp_l1_reg_loss: 7014.1700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27563.5561; train_global_loss: 2138276.8843; train_optim_loss: 2138276.8843; val_kl_reg_loss: 25986.8464; val_edge_recon_loss: 105939.8203; val_gene_expr_recon_loss: 1961267.0000; val_masked_gp_l1_reg_loss: 7058.7021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27219.2422; val_global_loss: 2127471.5833; val_optim_loss: 2127471.5833
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9098; val_auprc_score: 0.9800; val_best_acc_score: 0.9174; val_best_f1_score: 0.9528; train_kl_reg_loss: 26561.7518; train_edge_recon_loss: 103188.2057; train_gene_expr_recon_loss: 1957202.1065; train_masked_gp_l1_reg_loss: 7102.9756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26889.2282; train_global_loss: 2120944.2593; train_optim_loss: 2120944.2593; val_kl_reg_loss: 25228.0785; val_edge_recon_loss: 102634.9427; val_gene_expr_recon_loss: 1948472.7292; val_masked_gp_l1_reg_loss: 7148.9087; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26547.2109; val_global_loss: 2110031.8333; val_optim_loss: 2110031.8333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9256; val_auprc_score: 0.9837; val_best_acc_score: 0.9172; val_best_f1_score: 0.9523; train_kl_reg_loss: 25856.2220; train_edge_recon_loss: 102560.4868; train_gene_expr_recon_loss: 1943689.7685; train_masked_gp_l1_reg_loss: 7191.5009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26221.1649; train_global_loss: 2105519.1644; train_optim_loss: 2105519.1644; val_kl_reg_loss: 24586.6136; val_edge_recon_loss: 106289.6029; val_gene_expr_recon_loss: 1934107.2292; val_masked_gp_l1_reg_loss: 7238.0215; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25883.9844; val_global_loss: 2098105.4167; val_optim_loss: 2098105.4167
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9170; val_auprc_score: 0.9811; val_best_acc_score: 0.9197; val_best_f1_score: 0.9542; train_kl_reg_loss: 25037.6485; train_edge_recon_loss: 100539.8973; train_gene_expr_recon_loss: 1931144.3102; train_masked_gp_l1_reg_loss: 7280.7847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25568.4603; train_global_loss: 2089571.0972; train_optim_loss: 2089571.0972; val_kl_reg_loss: 23737.5322; val_edge_recon_loss: 101208.5872; val_gene_expr_recon_loss: 1920508.7708; val_masked_gp_l1_reg_loss: 7327.5088; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25243.0762; val_global_loss: 2078025.5417; val_optim_loss: 2078025.5417
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9232; val_auprc_score: 0.9837; val_best_acc_score: 0.9216; val_best_f1_score: 0.9551; train_kl_reg_loss: 24363.4961; train_edge_recon_loss: 99968.5706; train_gene_expr_recon_loss: 1918607.7940; train_masked_gp_l1_reg_loss: 7368.9924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24933.6448; train_global_loss: 2075242.4861; train_optim_loss: 2075242.4861; val_kl_reg_loss: 23289.1592; val_edge_recon_loss: 100806.6745; val_gene_expr_recon_loss: 1911886.0000; val_masked_gp_l1_reg_loss: 7413.6567; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24616.1016; val_global_loss: 2068011.5833; val_optim_loss: 2068011.5833
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9277; val_auprc_score: 0.9850; val_best_acc_score: 0.9230; val_best_f1_score: 0.9557; train_kl_reg_loss: 23692.8593; train_edge_recon_loss: 99353.1209; train_gene_expr_recon_loss: 1906675.2407; train_masked_gp_l1_reg_loss: 7455.8082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24316.4179; train_global_loss: 2061493.4282; train_optim_loss: 2061493.4282; val_kl_reg_loss: 22478.7741; val_edge_recon_loss: 100502.6810; val_gene_expr_recon_loss: 1896644.3333; val_masked_gp_l1_reg_loss: 7501.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24009.1367; val_global_loss: 2051136.2708; val_optim_loss: 2051136.2708
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9266; val_auprc_score: 0.9832; val_best_acc_score: 0.9255; val_best_f1_score: 0.9571; train_kl_reg_loss: 23049.7454; train_edge_recon_loss: 99579.6021; train_gene_expr_recon_loss: 1894696.2894; train_masked_gp_l1_reg_loss: 7541.9441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23720.1047; train_global_loss: 2048587.6852; train_optim_loss: 2048587.6852; val_kl_reg_loss: 22029.8457; val_edge_recon_loss: 100310.1263; val_gene_expr_recon_loss: 1887722.1250; val_masked_gp_l1_reg_loss: 7586.6904; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23422.0918; val_global_loss: 2041070.9583; val_optim_loss: 2041070.9583
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9266; val_auprc_score: 0.9829; val_best_acc_score: 0.9254; val_best_f1_score: 0.9569; train_kl_reg_loss: 22380.3618; train_edge_recon_loss: 98506.1136; train_gene_expr_recon_loss: 1883616.3912; train_masked_gp_l1_reg_loss: 7628.2235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23142.9391; train_global_loss: 2035274.0347; train_optim_loss: 2035274.0347; val_kl_reg_loss: 21172.7054; val_edge_recon_loss: 101750.7852; val_gene_expr_recon_loss: 1875177.1042; val_masked_gp_l1_reg_loss: 7672.1333; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22856.2891; val_global_loss: 2028628.9583; val_optim_loss: 2028628.9583
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8565; val_auprc_score: 0.9707; val_best_acc_score: 0.8592; val_best_f1_score: 0.9240; train_kl_reg_loss: 1840192.7952; train_edge_recon_loss: 115156.8479; train_gene_expr_recon_loss: 18265204.4352; train_masked_gp_l1_reg_loss: 9141.2100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22421.5628; train_global_loss: 20252117.0833; train_optim_loss: 20252117.0833; val_kl_reg_loss: 196227.8724; val_edge_recon_loss: 116531.8060; val_gene_expr_recon_loss: 3796697.5417; val_masked_gp_l1_reg_loss: 10105.7236; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21923.4062; val_global_loss: 4141486.4583; val_optim_loss: 4141486.4583
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8471; val_auprc_score: 0.9690; val_best_acc_score: 0.8646; val_best_f1_score: 0.9249; train_kl_reg_loss: 126518.9326; train_edge_recon_loss: 118639.7714; train_gene_expr_recon_loss: 3108846.8056; train_masked_gp_l1_reg_loss: 10126.3343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21444.3882; train_global_loss: 3385576.2407; train_optim_loss: 3385576.2407; val_kl_reg_loss: 80112.1354; val_edge_recon_loss: 120068.9857; val_gene_expr_recon_loss: 2722955.3750; val_masked_gp_l1_reg_loss: 10062.8496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20953.5391; val_global_loss: 2954152.7500; val_optim_loss: 2954152.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8510; val_auprc_score: 0.9708; val_best_acc_score: 0.8584; val_best_f1_score: 0.9217; train_kl_reg_loss: 69023.3114; train_edge_recon_loss: 119661.4880; train_gene_expr_recon_loss: 2575847.8657; train_masked_gp_l1_reg_loss: 10005.6228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20491.3533; train_global_loss: 2795029.6574; train_optim_loss: 2795029.6574; val_kl_reg_loss: 56119.2676; val_edge_recon_loss: 118269.8490; val_gene_expr_recon_loss: 2442787.2500; val_masked_gp_l1_reg_loss: 9957.6260; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20016.3047; val_global_loss: 2647150.3750; val_optim_loss: 2647150.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8480; val_auprc_score: 0.9697; val_best_acc_score: 0.8546; val_best_f1_score: 0.9214; train_kl_reg_loss: 58532.4935; train_edge_recon_loss: 118571.4540; train_gene_expr_recon_loss: 2404021.0000; train_masked_gp_l1_reg_loss: 9921.9413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19567.6046; train_global_loss: 2610614.4861; train_optim_loss: 2610614.4861; val_kl_reg_loss: 54798.8066; val_edge_recon_loss: 119282.5638; val_gene_expr_recon_loss: 2302432.2500; val_masked_gp_l1_reg_loss: 9887.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19106.9512; val_global_loss: 2505508.3333; val_optim_loss: 2505508.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8581; val_auprc_score: 0.9714; val_best_acc_score: 0.8560; val_best_f1_score: 0.9202; train_kl_reg_loss: 55893.3781; train_edge_recon_loss: 119477.7778; train_gene_expr_recon_loss: 2296274.9630; train_masked_gp_l1_reg_loss: 9877.0278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19045.1003; train_global_loss: 2500568.2685; train_optim_loss: 2500568.2685; val_kl_reg_loss: 53451.7227; val_edge_recon_loss: 121575.3294; val_gene_expr_recon_loss: 2286056.5000; val_masked_gp_l1_reg_loss: 9871.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18994.8926; val_global_loss: 2489950.5417; val_optim_loss: 2489950.5417
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8552; val_auprc_score: 0.9704; val_best_acc_score: 0.8546; val_best_f1_score: 0.9210; train_kl_reg_loss: 54642.6759; train_edge_recon_loss: 119028.1007; train_gene_expr_recon_loss: 2284481.1852; train_masked_gp_l1_reg_loss: 9868.9730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18949.3260; train_global_loss: 2486970.2731; train_optim_loss: 2486970.2731; val_kl_reg_loss: 52283.8815; val_edge_recon_loss: 121237.3359; val_gene_expr_recon_loss: 2272700.3333; val_masked_gp_l1_reg_loss: 9866.0361; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18901.7598; val_global_loss: 2474989.3750; val_optim_loss: 2474989.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8545; val_auprc_score: 0.9703; val_best_acc_score: 0.8552; val_best_f1_score: 0.9217; train_kl_reg_loss: 53426.8474; train_edge_recon_loss: 117504.1277; train_gene_expr_recon_loss: 2271949.4120; train_masked_gp_l1_reg_loss: 9863.3937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18855.2140; train_global_loss: 2471598.9861; train_optim_loss: 2471598.9861; val_kl_reg_loss: 51109.0768; val_edge_recon_loss: 120103.7865; val_gene_expr_recon_loss: 2261773.0000; val_masked_gp_l1_reg_loss: 9860.7412; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18806.5586; val_global_loss: 2461653.0833; val_optim_loss: 2461653.0833
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8556; val_auprc_score: 0.9701; val_best_acc_score: 0.8557; val_best_f1_score: 0.9218; train_kl_reg_loss: 52287.1454; train_edge_recon_loss: 118406.8702; train_gene_expr_recon_loss: 2259883.8750; train_masked_gp_l1_reg_loss: 9857.9801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18758.8095; train_global_loss: 2459194.6806; train_optim_loss: 2459194.6806; val_kl_reg_loss: 50067.5736; val_edge_recon_loss: 120842.1901; val_gene_expr_recon_loss: 2248435.1667; val_masked_gp_l1_reg_loss: 9855.1699; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18708.8477; val_global_loss: 2447908.9583; val_optim_loss: 2447908.9583

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 29 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9287
val AUPRC score: 0.9832
val best accuracy score: 0.9282
val best F1 score: 0.9586
val target rna MSE score: 22.8335
val source rna MSE score: 133.6830
Val cat covariate0 mean sim diff: -0.0015

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
