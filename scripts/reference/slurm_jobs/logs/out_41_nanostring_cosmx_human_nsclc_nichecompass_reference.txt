[True, False, True]
Run timestamp: 19102023_172844_41.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_41']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 631979
Number of validation nodes: 70220
Number of training edges: 1492281
Number of validation edges: 165809
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8939; val_auprc_score: 0.9825; val_best_acc_score: 0.9161; val_best_f1_score: 0.9540; train_kl_reg_loss: 33758.8668; train_edge_recon_loss: 6409590.7971; train_gene_expr_recon_loss: 26349160.9022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 298984.8132; train_global_loss: 33091495.3949; train_optim_loss: 33091495.3949; val_kl_reg_loss: 33828.0271; val_edge_recon_loss: 6505305.6651; val_gene_expr_recon_loss: 23432819.5864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178427.2031; val_global_loss: 30150381.2778; val_optim_loss: 30150381.2778
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9132; val_auprc_score: 0.9858; val_best_acc_score: 0.9267; val_best_f1_score: 0.9595; train_kl_reg_loss: 38141.5490; train_edge_recon_loss: 6195013.2530; train_gene_expr_recon_loss: 22377211.9925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180109.8638; train_global_loss: 28790476.6477; train_optim_loss: 28790476.6477; val_kl_reg_loss: 41528.5762; val_edge_recon_loss: 6428406.7546; val_gene_expr_recon_loss: 21825058.8457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181176.5781; val_global_loss: 28476170.1852; val_optim_loss: 28476170.1852
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9139; val_auprc_score: 0.9860; val_best_acc_score: 0.9261; val_best_f1_score: 0.9592; train_kl_reg_loss: 305879.1096; train_edge_recon_loss: 6253195.0472; train_gene_expr_recon_loss: 24216332.3204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 396101.8397; train_global_loss: 31171508.3136; train_optim_loss: 31171508.3136; val_kl_reg_loss: 38114.8803; val_edge_recon_loss: 6422580.8256; val_gene_expr_recon_loss: 22378487.6173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199914.9375; val_global_loss: 29039097.3025; val_optim_loss: 29039097.3025
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9183; val_auprc_score: 0.9867; val_best_acc_score: 0.9278; val_best_f1_score: 0.9601; train_kl_reg_loss: 47224.1946; train_edge_recon_loss: 6172317.0700; train_gene_expr_recon_loss: 21780811.8593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178232.7022; train_global_loss: 28178585.8388; train_optim_loss: 28178585.8388; val_kl_reg_loss: 53554.8975; val_edge_recon_loss: 6446937.9614; val_gene_expr_recon_loss: 21493312.2778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171753.1406; val_global_loss: 28165559.0864; val_optim_loss: 28165559.0864
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9231; val_auprc_score: 0.9872; val_best_acc_score: 0.9315; val_best_f1_score: 0.9620; train_kl_reg_loss: 58093.3229; train_edge_recon_loss: 6150436.3986; train_gene_expr_recon_loss: 21251542.5317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176159.2521; train_global_loss: 27636231.4923; train_optim_loss: 27636231.4923; val_kl_reg_loss: 62986.6397; val_edge_recon_loss: 6418366.9367; val_gene_expr_recon_loss: 21238181.4198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179882.7188; val_global_loss: 27899416.9753; val_optim_loss: 27899416.9753
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9225; val_auprc_score: 0.9876; val_best_acc_score: 0.9300; val_best_f1_score: 0.9613; train_kl_reg_loss: 63627.5541; train_edge_recon_loss: 6149487.3478; train_gene_expr_recon_loss: 21030357.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181525.2154; train_global_loss: 27424997.7022; train_optim_loss: 27424997.7022; val_kl_reg_loss: 64884.9874; val_edge_recon_loss: 6343306.8873; val_gene_expr_recon_loss: 21005866.6543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182737.6250; val_global_loss: 27596796.5864; val_optim_loss: 27596796.5864
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9242; val_auprc_score: 0.9874; val_best_acc_score: 0.9307; val_best_f1_score: 0.9616; train_kl_reg_loss: 68862.2441; train_edge_recon_loss: 6148252.5454; train_gene_expr_recon_loss: 20845749.2439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 184070.4305; train_global_loss: 27246934.4439; train_optim_loss: 27246934.4439; val_kl_reg_loss: 71282.3314; val_edge_recon_loss: 6453845.1204; val_gene_expr_recon_loss: 20888690.9691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 184896.0938; val_global_loss: 27598714.4383; val_optim_loss: 27598714.4383
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8378; val_auprc_score: 0.9706; val_best_acc_score: 0.9064; val_best_f1_score: 0.9492; train_kl_reg_loss: 143235179558.2614; train_edge_recon_loss: 6185671.4161; train_gene_expr_recon_loss: 21991727.7235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 215959.5390; train_global_loss: 143263572070.0336; train_optim_loss: 143263572070.0336; val_kl_reg_loss: 29097902.5555; val_edge_recon_loss: 7067961.5957; val_gene_expr_recon_loss: 28365021.7222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1013709.6250; val_global_loss: 65544592.7469; val_optim_loss: 65544592.7469
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9245; val_auprc_score: 0.9875; val_best_acc_score: 0.9326; val_best_f1_score: 0.9626; train_kl_reg_loss: 70708.9981; train_edge_recon_loss: 6153761.2315; train_gene_expr_recon_loss: 22595504.8967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 304196.0286; train_global_loss: 29124171.1177; train_optim_loss: 29124171.1177; val_kl_reg_loss: 75582.8776; val_edge_recon_loss: 6390424.2917; val_gene_expr_recon_loss: 21358669.2778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181002.9688; val_global_loss: 28005678.4691; val_optim_loss: 28005678.4691
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9220; val_auprc_score: 0.9869; val_best_acc_score: 0.9316; val_best_f1_score: 0.9621; train_kl_reg_loss: 31869059020.5995; train_edge_recon_loss: 6186013.9834; train_gene_expr_recon_loss: 21990203.2144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 182870.1711; train_global_loss: 31897418255.1966; train_optim_loss: 31897418255.1966; val_kl_reg_loss: 73570.7775; val_edge_recon_loss: 6386281.2222; val_gene_expr_recon_loss: 21920186.2469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182023.7500; val_global_loss: 28562062.2593; val_optim_loss: 28562062.2593

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9258; val_auprc_score: 0.9877; val_best_acc_score: 0.9331; val_best_f1_score: 0.9628; train_kl_reg_loss: 79935.8774; train_edge_recon_loss: 6143468.3268; train_gene_expr_recon_loss: 21232557.2515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123753.4886; train_global_loss: 27579714.9283; train_optim_loss: 27579714.9283; val_kl_reg_loss: 84274.1271; val_edge_recon_loss: 6428489.4969; val_gene_expr_recon_loss: 21114101.6975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118103.8750; val_global_loss: 27744969.3210; val_optim_loss: 27744969.3210
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9288; val_auprc_score: 0.9883; val_best_acc_score: 0.9340; val_best_f1_score: 0.9634; train_kl_reg_loss: 86325.8109; train_edge_recon_loss: 6135202.6937; train_gene_expr_recon_loss: 20843428.5557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115263.1204; train_global_loss: 27180220.1894; train_optim_loss: 27180220.1894; val_kl_reg_loss: 88741.3481; val_edge_recon_loss: 6447973.9738; val_gene_expr_recon_loss: 20812162.6235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112914.9844; val_global_loss: 27461791.9630; val_optim_loss: 27461791.9630
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9305; val_auprc_score: 0.9886; val_best_acc_score: 0.9344; val_best_f1_score: 0.9637; train_kl_reg_loss: 89144.5404; train_edge_recon_loss: 6132876.9250; train_gene_expr_recon_loss: 20609531.6247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111233.2151; train_global_loss: 26942786.3081; train_optim_loss: 26942786.3081; val_kl_reg_loss: 90154.6800; val_edge_recon_loss: 6393191.1713; val_gene_expr_recon_loss: 20644205.0679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109996.6250; val_global_loss: 27237546.9691; val_optim_loss: 27237546.9691
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9327; val_auprc_score: 0.9891; val_best_acc_score: 0.9351; val_best_f1_score: 0.9640; train_kl_reg_loss: 89652.7896; train_edge_recon_loss: 6145682.5864; train_gene_expr_recon_loss: 20481447.2336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109037.9503; train_global_loss: 26825820.5352; train_optim_loss: 26825820.5352; val_kl_reg_loss: 89804.3092; val_edge_recon_loss: 6394477.5617; val_gene_expr_recon_loss: 20562436.6543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108241.1016; val_global_loss: 27154960.4877; val_optim_loss: 27154960.4877
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9324; val_auprc_score: 0.9891; val_best_acc_score: 0.9359; val_best_f1_score: 0.9645; train_kl_reg_loss: 88891.2570; train_edge_recon_loss: 6134812.1646; train_gene_expr_recon_loss: 20407744.6683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107734.9276; train_global_loss: 26739183.0271; train_optim_loss: 26739183.0271; val_kl_reg_loss: 87770.4995; val_edge_recon_loss: 6390485.2623; val_gene_expr_recon_loss: 20499760.5864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107239.8672; val_global_loss: 27085256.3951; val_optim_loss: 27085256.3951
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9364; val_auprc_score: 0.9897; val_best_acc_score: 0.9371; val_best_f1_score: 0.9651; train_kl_reg_loss: 86411.9234; train_edge_recon_loss: 6116244.6149; train_gene_expr_recon_loss: 20331193.3235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106950.0582; train_global_loss: 26640799.9334; train_optim_loss: 26640799.9334; val_kl_reg_loss: 86630.1027; val_edge_recon_loss: 6413208.2099; val_gene_expr_recon_loss: 20420572.2037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106438.7188; val_global_loss: 27026848.4877; val_optim_loss: 27026848.4877
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9371; val_auprc_score: 0.9899; val_best_acc_score: 0.9380; val_best_f1_score: 0.9656; train_kl_reg_loss: 85541.1783; train_edge_recon_loss: 6124678.0722; train_gene_expr_recon_loss: 20278397.7544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106287.2165; train_global_loss: 26594904.2367; train_optim_loss: 26594904.2367; val_kl_reg_loss: 85269.7296; val_edge_recon_loss: 6284003.1944; val_gene_expr_recon_loss: 20357075.3210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106003.5391; val_global_loss: 26832352.2346; val_optim_loss: 26832352.2346
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9378; val_auprc_score: 0.9901; val_best_acc_score: 0.9370; val_best_f1_score: 0.9650; train_kl_reg_loss: 84522.2166; train_edge_recon_loss: 6107135.1238; train_gene_expr_recon_loss: 20235639.3770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105737.2558; train_global_loss: 26533033.9911; train_optim_loss: 26533033.9911; val_kl_reg_loss: 84761.0408; val_edge_recon_loss: 6382160.8133; val_gene_expr_recon_loss: 20346709.4259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105577.5469; val_global_loss: 26919209.3272; val_optim_loss: 26919209.3272
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9374; val_auprc_score: 0.9898; val_best_acc_score: 0.9370; val_best_f1_score: 0.9650; train_kl_reg_loss: 84046.9255; train_edge_recon_loss: 6135897.3114; train_gene_expr_recon_loss: 20201243.5403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105328.7011; train_global_loss: 26526516.4453; train_optim_loss: 26526516.4453; val_kl_reg_loss: 83503.7212; val_edge_recon_loss: 6393555.6898; val_gene_expr_recon_loss: 20303663.9506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105259.5859; val_global_loss: 26885983.3704; val_optim_loss: 26885983.3704
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9374; val_auprc_score: 0.9899; val_best_acc_score: 0.9369; val_best_f1_score: 0.9650; train_kl_reg_loss: 83272.8517; train_edge_recon_loss: 6121730.4859; train_gene_expr_recon_loss: 20169632.8261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105106.6348; train_global_loss: 26479742.7822; train_optim_loss: 26479742.7822; val_kl_reg_loss: 83870.9874; val_edge_recon_loss: 6391416.3681; val_gene_expr_recon_loss: 20285939.6605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104765.8203; val_global_loss: 26865993.0123; val_optim_loss: 26865993.0123
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9397; val_auprc_score: 0.9904; val_best_acc_score: 0.9381; val_best_f1_score: 0.9655; train_kl_reg_loss: 83058.8524; train_edge_recon_loss: 6095046.7838; train_gene_expr_recon_loss: 20142002.6305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104731.6511; train_global_loss: 26424839.9115; train_optim_loss: 26424839.9115; val_kl_reg_loss: 83234.8965; val_edge_recon_loss: 6381214.8943; val_gene_expr_recon_loss: 20261307.7716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104593.4375; val_global_loss: 26830351.6111; val_optim_loss: 26830351.6111
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9398; val_auprc_score: 0.9904; val_best_acc_score: 0.9386; val_best_f1_score: 0.9659; train_kl_reg_loss: 82634.5451; train_edge_recon_loss: 6119202.7936; train_gene_expr_recon_loss: 20110631.9492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104420.8090; train_global_loss: 26416890.1002; train_optim_loss: 26416890.1002; val_kl_reg_loss: 82503.0809; val_edge_recon_loss: 6360571.5262; val_gene_expr_recon_loss: 20230666.5864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104250.8828; val_global_loss: 26777991.2037; val_optim_loss: 26777991.2037
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9416; val_auprc_score: 0.9909; val_best_acc_score: 0.9400; val_best_f1_score: 0.9666; train_kl_reg_loss: 82063.7259; train_edge_recon_loss: 6120930.4891; train_gene_expr_recon_loss: 20076292.5057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104134.1464; train_global_loss: 26383420.8563; train_optim_loss: 26383420.8563; val_kl_reg_loss: 82228.9096; val_edge_recon_loss: 6284144.7701; val_gene_expr_recon_loss: 20196061.9259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103959.0781; val_global_loss: 26666395.6049; val_optim_loss: 26666395.6049
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9398; val_auprc_score: 0.9902; val_best_acc_score: 0.9379; val_best_f1_score: 0.9655; train_kl_reg_loss: 81474.0599; train_edge_recon_loss: 6095904.6533; train_gene_expr_recon_loss: 20050421.8937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103947.8147; train_global_loss: 26331748.4041; train_optim_loss: 26331748.4041; val_kl_reg_loss: 82354.4764; val_edge_recon_loss: 6435094.8997; val_gene_expr_recon_loss: 20166899.0802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103952.8672; val_global_loss: 26788300.4877; val_optim_loss: 26788300.4877
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9418; val_auprc_score: 0.9907; val_best_acc_score: 0.9405; val_best_f1_score: 0.9670; train_kl_reg_loss: 81431.2878; train_edge_recon_loss: 6107817.4864; train_gene_expr_recon_loss: 20030184.6079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103788.0509; train_global_loss: 26323221.4642; train_optim_loss: 26323221.4642; val_kl_reg_loss: 80863.5705; val_edge_recon_loss: 6320848.6474; val_gene_expr_recon_loss: 20174369.0123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103827.9453; val_global_loss: 26679909.2469; val_optim_loss: 26679909.2469
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9410; val_auprc_score: 0.9905; val_best_acc_score: 0.9409; val_best_f1_score: 0.9672; train_kl_reg_loss: 82545.6385; train_edge_recon_loss: 6124495.6168; train_gene_expr_recon_loss: 20188572.9523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104263.3743; train_global_loss: 26499877.5774; train_optim_loss: 26499877.5774; val_kl_reg_loss: 59598.5684; val_edge_recon_loss: 6352921.9460; val_gene_expr_recon_loss: 20264698.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101578.3906; val_global_loss: 26778797.4568; val_optim_loss: 26778797.4568
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9417; val_auprc_score: 0.9906; val_best_acc_score: 0.9409; val_best_f1_score: 0.9673; train_kl_reg_loss: 81073.4830; train_edge_recon_loss: 6116784.5261; train_gene_expr_recon_loss: 20111045.2322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99373.5116; train_global_loss: 26408276.7643; train_optim_loss: 26408276.7643; val_kl_reg_loss: 60232.7197; val_edge_recon_loss: 6302567.8920; val_gene_expr_recon_loss: 20206835.1235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97563.8828; val_global_loss: 26667199.7840; val_optim_loss: 26667199.7840

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9436; val_auprc_score: 0.9909; val_best_acc_score: 0.9410; val_best_f1_score: 0.9671; train_kl_reg_loss: 79713.2182; train_edge_recon_loss: 6124425.0652; train_gene_expr_recon_loss: 20094249.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90220.4179; train_global_loss: 26388607.9732; train_optim_loss: 26388607.9732; val_kl_reg_loss: 60086.4544; val_edge_recon_loss: 6388676.8627; val_gene_expr_recon_loss: 20253432.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89555.4062; val_global_loss: 26791751.7037; val_optim_loss: 26791751.7037
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9428; val_auprc_score: 0.9909; val_best_acc_score: 0.9408; val_best_f1_score: 0.9671; train_kl_reg_loss: 79250.3549; train_edge_recon_loss: 6116807.5105; train_gene_expr_recon_loss: 20091888.3973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89192.7245; train_global_loss: 26377138.9976; train_optim_loss: 26377138.9976; val_kl_reg_loss: 60525.7179; val_edge_recon_loss: 6391233.5201; val_gene_expr_recon_loss: 20230839.2531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88843.1406; val_global_loss: 26771442.4938; val_optim_loss: 26771442.4938
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9419; val_auprc_score: 0.9908; val_best_acc_score: 0.9407; val_best_f1_score: 0.9671; train_kl_reg_loss: 78747.0883; train_edge_recon_loss: 6124086.6097; train_gene_expr_recon_loss: 20085190.4967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88603.2341; train_global_loss: 26376627.4134; train_optim_loss: 26376627.4134; val_kl_reg_loss: 60754.7852; val_edge_recon_loss: 6311751.7731; val_gene_expr_recon_loss: 20227818.6728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88349.1641; val_global_loss: 26688675.2222; val_optim_loss: 26688675.2222
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9401; val_auprc_score: 0.9903; val_best_acc_score: 0.9393; val_best_f1_score: 0.9662; train_kl_reg_loss: 78125.4767; train_edge_recon_loss: 6098851.0622; train_gene_expr_recon_loss: 20076801.1499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88223.6272; train_global_loss: 26342001.3276; train_optim_loss: 26342001.3276; val_kl_reg_loss: 60761.4183; val_edge_recon_loss: 6452419.7485; val_gene_expr_recon_loss: 20202980.8827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88092.6094; val_global_loss: 26804254.0247; val_optim_loss: 26804254.0247

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 395 min 10 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9383
val AUPRC score: 0.9900
val best accuracy score: 0.9388
val best F1 score: 0.9661
val target rna MSE score: 0.9234
val source rna MSE score: 0.3129
Val cat covariate0 mean sim diff: -0.0023
Val cat covariate1 mean sim diff: -0.0560
Val cat covariate2 mean sim diff: -0.0012

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
