[True]
Run timestamp: 29072023_121820_93.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_93']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8802; val_auprc_score: 0.9011; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3385.5944; train_edge_recon_loss: 3482180.5833; train_gene_expr_recon_loss: 71414792.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1898209.1528; train_global_loss: 76798568.0000; train_optim_loss: 76798568.0000; val_kl_reg_loss: 19428.4258; val_edge_recon_loss: 4065936.0000; val_gene_expr_recon_loss: 62867336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1786663.7500; val_global_loss: 68739360.0000; val_optim_loss: 68739360.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9012; val_auprc_score: 0.9120; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 36679.7724; train_edge_recon_loss: 3524063.8056; train_gene_expr_recon_loss: 61138066.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1844982.2639; train_global_loss: 66543792.4444; train_optim_loss: 66543792.4444; val_kl_reg_loss: 39950.8125; val_edge_recon_loss: 4066142.7500; val_gene_expr_recon_loss: 59040868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1779786.2500; val_global_loss: 64926748.0000; val_optim_loss: 64926748.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9002; val_auprc_score: 0.9150; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 69964.3555; train_edge_recon_loss: 3555728.2778; train_gene_expr_recon_loss: 57292048.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1743327.9722; train_global_loss: 62661069.3333; train_optim_loss: 62661069.3333; val_kl_reg_loss: 54624.3594; val_edge_recon_loss: 4066149.0000; val_gene_expr_recon_loss: 55750332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1733587.2500; val_global_loss: 61604692.0000; val_optim_loss: 61604692.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8950; val_auprc_score: 0.9070; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 104132.1892; train_edge_recon_loss: 3592766.7500; train_gene_expr_recon_loss: 53847209.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1730577.9444; train_global_loss: 59274687.5556; train_optim_loss: 59274687.5556; val_kl_reg_loss: 129824.5000; val_edge_recon_loss: 4066122.2500; val_gene_expr_recon_loss: 52681760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1736706.2500; val_global_loss: 58614416.0000; val_optim_loss: 58614416.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8834; val_auprc_score: 0.8945; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 145719.8264; train_edge_recon_loss: 3602237.1389; train_gene_expr_recon_loss: 51355752.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1722268.3889; train_global_loss: 56825978.6667; train_optim_loss: 56825978.6667; val_kl_reg_loss: 143572.0625; val_edge_recon_loss: 4066054.0000; val_gene_expr_recon_loss: 50063908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1690438.6250; val_global_loss: 55963976.0000; val_optim_loss: 55963976.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8739; val_auprc_score: 0.8861; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 167024.1545; train_edge_recon_loss: 3611436.4444; train_gene_expr_recon_loss: 48901070.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1681703.8889; train_global_loss: 54361235.1111; train_optim_loss: 54361235.1111; val_kl_reg_loss: 135376.8281; val_edge_recon_loss: 4065931.2500; val_gene_expr_recon_loss: 47943256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1671474.2500; val_global_loss: 53816040.0000; val_optim_loss: 53816040.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8588; val_auprc_score: 0.8649; val_best_acc_score: 0.5024; val_best_f1_score: 0.6677; train_kl_reg_loss: 175529.5747; train_edge_recon_loss: 3615174.8889; train_gene_expr_recon_loss: 46669925.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1662316.3750; train_global_loss: 52122946.2222; train_optim_loss: 52122946.2222; val_kl_reg_loss: 144530.7812; val_edge_recon_loss: 4065804.0000; val_gene_expr_recon_loss: 46148300.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1649241.7500; val_global_loss: 52007876.0000; val_optim_loss: 52007876.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8643; val_auprc_score: 0.8762; val_best_acc_score: 0.5057; val_best_f1_score: 0.6692; train_kl_reg_loss: 184741.5434; train_edge_recon_loss: 3611329.4444; train_gene_expr_recon_loss: 45182640.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1646610.1111; train_global_loss: 50625321.3333; train_optim_loss: 50625321.3333; val_kl_reg_loss: 152229.2188; val_edge_recon_loss: 4065622.7500; val_gene_expr_recon_loss: 44604152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1629278.5000; val_global_loss: 50451284.0000; val_optim_loss: 50451284.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8583; val_auprc_score: 0.8658; val_best_acc_score: 0.5066; val_best_f1_score: 0.6696; train_kl_reg_loss: 186701.8385; train_edge_recon_loss: 3611943.5833; train_gene_expr_recon_loss: 43640160.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1617835.9028; train_global_loss: 49056641.3333; train_optim_loss: 49056641.3333; val_kl_reg_loss: 153545.4375; val_edge_recon_loss: 4065499.0000; val_gene_expr_recon_loss: 43381504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1611805.5000; val_global_loss: 49212352.0000; val_optim_loss: 49212352.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8543; val_auprc_score: 0.8627; val_best_acc_score: 0.5116; val_best_f1_score: 0.6717; train_kl_reg_loss: 187831.4219; train_edge_recon_loss: 3609691.9167; train_gene_expr_recon_loss: 42799332.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1610346.8333; train_global_loss: 48207203.5556; train_optim_loss: 48207203.5556; val_kl_reg_loss: 152942.7188; val_edge_recon_loss: 4065210.5000; val_gene_expr_recon_loss: 42323640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1598197.0000; val_global_loss: 48139988.0000; val_optim_loss: 48139988.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8601; val_auprc_score: 0.8671; val_best_acc_score: 0.5166; val_best_f1_score: 0.6738; train_kl_reg_loss: 192923.0399; train_edge_recon_loss: 3599195.5833; train_gene_expr_recon_loss: 41710614.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1591696.7500; train_global_loss: 47094429.3333; train_optim_loss: 47094429.3333; val_kl_reg_loss: 162968.9688; val_edge_recon_loss: 4064793.2500; val_gene_expr_recon_loss: 41537796.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1588917.0000; val_global_loss: 47354476.0000; val_optim_loss: 47354476.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8648; val_auprc_score: 0.8715; val_best_acc_score: 0.5220; val_best_f1_score: 0.6760; train_kl_reg_loss: 186662.0920; train_edge_recon_loss: 3595487.9722; train_gene_expr_recon_loss: 40894598.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1586162.4722; train_global_loss: 46262911.5556; train_optim_loss: 46262911.5556; val_kl_reg_loss: 139292.9531; val_edge_recon_loss: 4064201.0000; val_gene_expr_recon_loss: 40872804.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1578126.2500; val_global_loss: 46654424.0000; val_optim_loss: 46654424.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8580; val_auprc_score: 0.8636; val_best_acc_score: 0.5252; val_best_f1_score: 0.6773; train_kl_reg_loss: 184973.6267; train_edge_recon_loss: 3590485.0556; train_gene_expr_recon_loss: 40491547.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1581537.9861; train_global_loss: 45848544.0000; train_optim_loss: 45848544.0000; val_kl_reg_loss: 154388.4844; val_edge_recon_loss: 4063806.5000; val_gene_expr_recon_loss: 40221188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1565199.2500; val_global_loss: 46004584.0000; val_optim_loss: 46004584.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8640; val_auprc_score: 0.8627; val_best_acc_score: 0.5418; val_best_f1_score: 0.6848; train_kl_reg_loss: 176615.3385; train_edge_recon_loss: 3588175.0833; train_gene_expr_recon_loss: 39812933.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1561673.3194; train_global_loss: 45139397.3333; train_optim_loss: 45139397.3333; val_kl_reg_loss: 147398.5312; val_edge_recon_loss: 4062486.0000; val_gene_expr_recon_loss: 39805748.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1560546.2500; val_global_loss: 45576180.0000; val_optim_loss: 45576180.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8702; val_auprc_score: 0.8701; val_best_acc_score: 0.5574; val_best_f1_score: 0.6918; train_kl_reg_loss: 175386.2049; train_edge_recon_loss: 3581349.1111; train_gene_expr_recon_loss: 39380748.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1564666.5417; train_global_loss: 44702150.2222; train_optim_loss: 44702150.2222; val_kl_reg_loss: 150364.0938; val_edge_recon_loss: 4061719.0000; val_gene_expr_recon_loss: 39468260.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1555950.5000; val_global_loss: 45236296.0000; val_optim_loss: 45236296.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8669; val_auprc_score: 0.8597; val_best_acc_score: 0.5881; val_best_f1_score: 0.7064; train_kl_reg_loss: 174501.4497; train_edge_recon_loss: 3578240.8333; train_gene_expr_recon_loss: 39400836.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1564293.9583; train_global_loss: 44717872.4444; train_optim_loss: 44717872.4444; val_kl_reg_loss: 127385.1641; val_edge_recon_loss: 4060012.0000; val_gene_expr_recon_loss: 39217768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1549331.0000; val_global_loss: 44954496.0000; val_optim_loss: 44954496.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8695; val_auprc_score: 0.8668; val_best_acc_score: 0.6027; val_best_f1_score: 0.7129; train_kl_reg_loss: 170846.9167; train_edge_recon_loss: 3577369.9722; train_gene_expr_recon_loss: 38864099.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1547136.7917; train_global_loss: 44159452.8889; train_optim_loss: 44159452.8889; val_kl_reg_loss: 141133.3594; val_edge_recon_loss: 4058751.2500; val_gene_expr_recon_loss: 38959716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1545276.2500; val_global_loss: 44704876.0000; val_optim_loss: 44704876.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8735; val_auprc_score: 0.8720; val_best_acc_score: 0.6268; val_best_f1_score: 0.7245; train_kl_reg_loss: 165321.9323; train_edge_recon_loss: 3573558.8333; train_gene_expr_recon_loss: 38470664.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1545745.0972; train_global_loss: 43755289.7778; train_optim_loss: 43755289.7778; val_kl_reg_loss: 148212.4062; val_edge_recon_loss: 4056635.2500; val_gene_expr_recon_loss: 38836940.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1543785.6250; val_global_loss: 44585572.0000; val_optim_loss: 44585572.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8723; val_auprc_score: 0.8663; val_best_acc_score: 0.6645; val_best_f1_score: 0.7438; train_kl_reg_loss: 165804.7031; train_edge_recon_loss: 3564923.1111; train_gene_expr_recon_loss: 38655957.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1547541.3056; train_global_loss: 43934226.6667; train_optim_loss: 43934226.6667; val_kl_reg_loss: 134321.0938; val_edge_recon_loss: 4053677.5000; val_gene_expr_recon_loss: 38666688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1539491.7500; val_global_loss: 44394180.0000; val_optim_loss: 44394180.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8722; val_auprc_score: 0.8698; val_best_acc_score: 0.6921; val_best_f1_score: 0.7581; train_kl_reg_loss: 160829.0556; train_edge_recon_loss: 3566233.9167; train_gene_expr_recon_loss: 38642776.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1544007.2222; train_global_loss: 43913846.6667; train_optim_loss: 43913846.6667; val_kl_reg_loss: 137407.6875; val_edge_recon_loss: 4050441.7500; val_gene_expr_recon_loss: 38527396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537690.5000; val_global_loss: 44252936.0000; val_optim_loss: 44252936.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8688; val_auprc_score: 0.8611; val_best_acc_score: 0.7261; val_best_f1_score: 0.7754; train_kl_reg_loss: 160431.0799; train_edge_recon_loss: 3561957.9444; train_gene_expr_recon_loss: 38229436.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1535207.2222; train_global_loss: 43487031.5556; train_optim_loss: 43487031.5556; val_kl_reg_loss: 114487.1875; val_edge_recon_loss: 4045209.2500; val_gene_expr_recon_loss: 38525136.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1535598.7500; val_global_loss: 44220432.0000; val_optim_loss: 44220432.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8674; val_auprc_score: 0.8615; val_best_acc_score: 0.7247; val_best_f1_score: 0.7729; train_kl_reg_loss: 151916.8863; train_edge_recon_loss: 3570347.8056; train_gene_expr_recon_loss: 38151625.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1535919.0139; train_global_loss: 43409808.8889; train_optim_loss: 43409808.8889; val_kl_reg_loss: 133110.7188; val_edge_recon_loss: 4043876.0000; val_gene_expr_recon_loss: 38331512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1532441.6250; val_global_loss: 44040940.0000; val_optim_loss: 44040940.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8736; val_auprc_score: 0.8660; val_best_acc_score: 0.7584; val_best_f1_score: 0.7915; train_kl_reg_loss: 157499.1684; train_edge_recon_loss: 3553054.1111; train_gene_expr_recon_loss: 38026352.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1531713.5278; train_global_loss: 43268619.1111; train_optim_loss: 43268619.1111; val_kl_reg_loss: 120395.9688; val_edge_recon_loss: 4038704.7500; val_gene_expr_recon_loss: 38271544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1531332.8750; val_global_loss: 43961976.0000; val_optim_loss: 43961976.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8787; val_auprc_score: 0.8718; val_best_acc_score: 0.7811; val_best_f1_score: 0.8028; train_kl_reg_loss: 146846.3802; train_edge_recon_loss: 3557513.2778; train_gene_expr_recon_loss: 38038875.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1529632.6944; train_global_loss: 43272868.4444; train_optim_loss: 43272868.4444; val_kl_reg_loss: 120934.5781; val_edge_recon_loss: 4032124.5000; val_gene_expr_recon_loss: 38256440.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1530093.3750; val_global_loss: 43939592.0000; val_optim_loss: 43939592.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8775; val_auprc_score: 0.8685; val_best_acc_score: 0.7914; val_best_f1_score: 0.8062; train_kl_reg_loss: 147302.2413; train_edge_recon_loss: 3550335.7500; train_gene_expr_recon_loss: 37984849.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1533352.5694; train_global_loss: 43215840.4444; train_optim_loss: 43215840.4444; val_kl_reg_loss: 119459.6406; val_edge_recon_loss: 4026109.0000; val_gene_expr_recon_loss: 38160248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1529623.3750; val_global_loss: 43835440.0000; val_optim_loss: 43835440.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8870; val_auprc_score: 0.8733; val_best_acc_score: 0.8017; val_best_f1_score: 0.8196; train_kl_reg_loss: 186265.0894; train_edge_recon_loss: 3615985.8889; train_gene_expr_recon_loss: 38048318.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1525508.0556; train_global_loss: 43376077.7778; train_optim_loss: 43376077.7778; val_kl_reg_loss: 111419.2969; val_edge_recon_loss: 4029335.5000; val_gene_expr_recon_loss: 38167320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1528298.7500; val_global_loss: 43836376.0000; val_optim_loss: 43836376.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8919; val_auprc_score: 0.8861; val_best_acc_score: 0.7763; val_best_f1_score: 0.8062; train_kl_reg_loss: 149159.7483; train_edge_recon_loss: 3592656.8056; train_gene_expr_recon_loss: 37824150.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1523086.0139; train_global_loss: 43089053.3333; train_optim_loss: 43089053.3333; val_kl_reg_loss: 114547.0156; val_edge_recon_loss: 4036066.7500; val_gene_expr_recon_loss: 38120824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1527314.7500; val_global_loss: 43798752.0000; val_optim_loss: 43798752.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8830; val_auprc_score: 0.8722; val_best_acc_score: 0.7631; val_best_f1_score: 0.7976; train_kl_reg_loss: 138995.5165; train_edge_recon_loss: 3602959.5833; train_gene_expr_recon_loss: 37849119.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1525864.7083; train_global_loss: 43116938.6667; train_optim_loss: 43116938.6667; val_kl_reg_loss: 134296.9688; val_edge_recon_loss: 4037557.2500; val_gene_expr_recon_loss: 38027600.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1523493.0000; val_global_loss: 43722948.0000; val_optim_loss: 43722948.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8853; val_auprc_score: 0.8717; val_best_acc_score: 0.7858; val_best_f1_score: 0.8104; train_kl_reg_loss: 152968.6250; train_edge_recon_loss: 3597214.2500; train_gene_expr_recon_loss: 37994653.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1531471.3750; train_global_loss: 43276307.1111; train_optim_loss: 43276307.1111; val_kl_reg_loss: 95410.3438; val_edge_recon_loss: 4030810.2500; val_gene_expr_recon_loss: 38075912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1523116.5000; val_global_loss: 43725248.0000; val_optim_loss: 43725248.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8885; val_auprc_score: 0.8760; val_best_acc_score: 0.7979; val_best_f1_score: 0.8191; train_kl_reg_loss: 148371.0417; train_edge_recon_loss: 3611066.8333; train_gene_expr_recon_loss: 37775031.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1518134.5833; train_global_loss: 43052603.5556; train_optim_loss: 43052603.5556; val_kl_reg_loss: 89337.6875; val_edge_recon_loss: 4029241.7500; val_gene_expr_recon_loss: 38016576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522845.0000; val_global_loss: 43658000.0000; val_optim_loss: 43658000.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8806; val_auprc_score: 0.8736; val_best_acc_score: 0.7418; val_best_f1_score: 0.7845; train_kl_reg_loss: 112360.8819; train_edge_recon_loss: 3645215.6389; train_gene_expr_recon_loss: 37912079.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1521253.6667; train_global_loss: 43190909.3333; train_optim_loss: 43190909.3333; val_kl_reg_loss: 112750.7344; val_edge_recon_loss: 4035457.7500; val_gene_expr_recon_loss: 38206496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1524740.5000; val_global_loss: 43879444.0000; val_optim_loss: 43879444.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8678; val_auprc_score: 0.8646; val_best_acc_score: 0.7122; val_best_f1_score: 0.7656; train_kl_reg_loss: 105327.7630; train_edge_recon_loss: 3610474.5556; train_gene_expr_recon_loss: 38153845.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1527648.3889; train_global_loss: 43397296.0000; train_optim_loss: 43397296.0000; val_kl_reg_loss: 44836.5820; val_edge_recon_loss: 4034205.7500; val_gene_expr_recon_loss: 38600624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1526365.6250; val_global_loss: 44206032.0000; val_optim_loss: 44206032.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8602; val_auprc_score: 0.8630; val_best_acc_score: 0.7018; val_best_f1_score: 0.7581; train_kl_reg_loss: 86124.4193; train_edge_recon_loss: 3648759.4722; train_gene_expr_recon_loss: 38654620.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1533372.7639; train_global_loss: 43922876.0000; train_optim_loss: 43922876.0000; val_kl_reg_loss: 31334.4023; val_edge_recon_loss: 4034041.2500; val_gene_expr_recon_loss: 39427840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1533973.5000; val_global_loss: 45027188.0000; val_optim_loss: 45027188.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8447; val_auprc_score: 0.8451; val_best_acc_score: 0.6745; val_best_f1_score: 0.7442; train_kl_reg_loss: 42742.9499; train_edge_recon_loss: 3734307.4167; train_gene_expr_recon_loss: 39566559.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1530986.7917; train_global_loss: 44874595.5556; train_optim_loss: 44874595.5556; val_kl_reg_loss: 29050.2383; val_edge_recon_loss: 4039071.2500; val_gene_expr_recon_loss: 39177200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1531932.8750; val_global_loss: 44777252.0000; val_optim_loss: 44777252.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8463; val_auprc_score: 0.8480; val_best_acc_score: 0.6494; val_best_f1_score: 0.7326; train_kl_reg_loss: 43867.7064; train_edge_recon_loss: 3654430.2222; train_gene_expr_recon_loss: 38492192.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1535308.7500; train_global_loss: 43725799.1111; train_optim_loss: 43725799.1111; val_kl_reg_loss: 70753.8281; val_edge_recon_loss: 4045539.0000; val_gene_expr_recon_loss: 38143344.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522707.6250; val_global_loss: 43782344.0000; val_optim_loss: 43782344.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8472; val_auprc_score: 0.8482; val_best_acc_score: 0.6523; val_best_f1_score: 0.7343; train_kl_reg_loss: 92989.5061; train_edge_recon_loss: 3567449.1944; train_gene_expr_recon_loss: 38094539.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1528905.4306; train_global_loss: 43283883.5556; train_optim_loss: 43283883.5556; val_kl_reg_loss: 73046.2578; val_edge_recon_loss: 4045724.5000; val_gene_expr_recon_loss: 38128456.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522784.2500; val_global_loss: 43770012.0000; val_optim_loss: 43770012.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8454; val_auprc_score: 0.8474; val_best_acc_score: 0.6583; val_best_f1_score: 0.7369; train_kl_reg_loss: 65908.7036; train_edge_recon_loss: 3603485.0000; train_gene_expr_recon_loss: 37788050.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1527417.9306; train_global_loss: 42984860.4444; train_optim_loss: 42984860.4444; val_kl_reg_loss: 58428.9453; val_edge_recon_loss: 4044459.5000; val_gene_expr_recon_loss: 38126244.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522175.5000; val_global_loss: 43751308.0000; val_optim_loss: 43751308.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.8463; val_auprc_score: 0.8441; val_best_acc_score: 0.6516; val_best_f1_score: 0.7338; train_kl_reg_loss: 72041.3811; train_edge_recon_loss: 3590797.8333; train_gene_expr_recon_loss: 37945228.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1527325.2083; train_global_loss: 43135392.0000; train_optim_loss: 43135392.0000; val_kl_reg_loss: 81717.3672; val_edge_recon_loss: 4045991.0000; val_gene_expr_recon_loss: 38087524.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522801.7500; val_global_loss: 43738032.0000; val_optim_loss: 43738032.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 28 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.8909
val AUPRC score: 0.8822
val best accuracy score: 0.7999
val best F1 score: 0.8205
val target rna MSE score: 1.5842
val source rna MSE score: 1.8138
val target atac MSE score: 0.1423
val source atac MSE score: 0.0176
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
