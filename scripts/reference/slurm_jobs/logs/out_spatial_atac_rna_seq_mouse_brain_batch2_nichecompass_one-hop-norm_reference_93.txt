[True]
Run timestamp: 07082023_201828_93.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_93']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8790; val_auprc_score: 0.8950; val_best_acc_score: 0.5224; val_best_f1_score: 0.6767; train_kl_reg_loss: 17391.1481; train_edge_recon_loss: 349605.3368; train_gene_expr_recon_loss: 1132845.5417; train_masked_gp_l1_reg_loss: 4547.2014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166810.3160; train_chrom_access_recon_loss: 745530.5833; train_global_loss: 2416730.0972; train_optim_loss: 2416730.0972; val_kl_reg_loss: 5302.2627; val_edge_recon_loss: 406401.2812; val_gene_expr_recon_loss: 992417.7500; val_masked_gp_l1_reg_loss: 4062.5376; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162213.5000; val_chrom_access_recon_loss: 498655.5312; val_global_loss: 2069052.7500; val_optim_loss: 2069052.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8756; val_auprc_score: 0.8891; val_best_acc_score: 0.5085; val_best_f1_score: 0.6705; train_kl_reg_loss: 7524.0836; train_edge_recon_loss: 352178.1667; train_gene_expr_recon_loss: 919082.9306; train_masked_gp_l1_reg_loss: 3987.6475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159188.6545; train_chrom_access_recon_loss: 485624.7257; train_global_loss: 1927586.2222; train_optim_loss: 1927586.2222; val_kl_reg_loss: 11287.3945; val_edge_recon_loss: 406525.0312; val_gene_expr_recon_loss: 845636.5625; val_masked_gp_l1_reg_loss: 3979.6902; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155367.1875; val_chrom_access_recon_loss: 471980.4688; val_global_loss: 1894776.5000; val_optim_loss: 1894776.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8703; val_auprc_score: 0.8876; val_best_acc_score: 0.5115; val_best_f1_score: 0.6718; train_kl_reg_loss: 14186.5356; train_edge_recon_loss: 356721.5660; train_gene_expr_recon_loss: 815346.8056; train_masked_gp_l1_reg_loss: 4058.1141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151993.2031; train_chrom_access_recon_loss: 469340.9062; train_global_loss: 1811647.0972; train_optim_loss: 1811647.0972; val_kl_reg_loss: 13666.6055; val_edge_recon_loss: 406513.0625; val_gene_expr_recon_loss: 781983.2500; val_masked_gp_l1_reg_loss: 4145.5059; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147449.7188; val_chrom_access_recon_loss: 458323.5312; val_global_loss: 1812081.6250; val_optim_loss: 1812081.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8620; val_auprc_score: 0.8793; val_best_acc_score: 0.5172; val_best_f1_score: 0.6740; train_kl_reg_loss: 14870.2061; train_edge_recon_loss: 356449.8299; train_gene_expr_recon_loss: 769462.7083; train_masked_gp_l1_reg_loss: 4178.7452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143378.8750; train_chrom_access_recon_loss: 456020.4271; train_global_loss: 1744360.7778; train_optim_loss: 1744360.7778; val_kl_reg_loss: 16949.0156; val_edge_recon_loss: 406474.4375; val_gene_expr_recon_loss: 749674.2500; val_masked_gp_l1_reg_loss: 4207.1504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138117.4375; val_chrom_access_recon_loss: 452683.3125; val_global_loss: 1768105.5000; val_optim_loss: 1768105.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8558; val_auprc_score: 0.8730; val_best_acc_score: 0.5280; val_best_f1_score: 0.6772; train_kl_reg_loss: 17832.6174; train_edge_recon_loss: 358336.3229; train_gene_expr_recon_loss: 738782.0556; train_masked_gp_l1_reg_loss: 4211.5703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133697.7960; train_chrom_access_recon_loss: 452471.1424; train_global_loss: 1705331.4722; train_optim_loss: 1705331.4722; val_kl_reg_loss: 18013.1445; val_edge_recon_loss: 406298.7500; val_gene_expr_recon_loss: 729412.3750; val_masked_gp_l1_reg_loss: 4207.6353; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128112.9688; val_chrom_access_recon_loss: 448825.3750; val_global_loss: 1734870.2500; val_optim_loss: 1734870.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8525; val_auprc_score: 0.8594; val_best_acc_score: 0.5323; val_best_f1_score: 0.6771; train_kl_reg_loss: 17929.3869; train_edge_recon_loss: 358021.3715; train_gene_expr_recon_loss: 725243.5764; train_masked_gp_l1_reg_loss: 4210.8494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123628.2005; train_chrom_access_recon_loss: 449311.1597; train_global_loss: 1678344.5694; train_optim_loss: 1678344.5694; val_kl_reg_loss: 17936.1113; val_edge_recon_loss: 406018.9062; val_gene_expr_recon_loss: 715679.1875; val_masked_gp_l1_reg_loss: 4208.1782; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118044.8047; val_chrom_access_recon_loss: 446299.6250; val_global_loss: 1708186.7500; val_optim_loss: 1708186.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8479; val_auprc_score: 0.8537; val_best_acc_score: 0.5699; val_best_f1_score: 0.6927; train_kl_reg_loss: 18458.7480; train_edge_recon_loss: 357895.9653; train_gene_expr_recon_loss: 712084.9931; train_masked_gp_l1_reg_loss: 4217.8811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113667.0582; train_chrom_access_recon_loss: 448272.0660; train_global_loss: 1654596.6944; train_optim_loss: 1654596.6944; val_kl_reg_loss: 18789.1172; val_edge_recon_loss: 405453.4062; val_gene_expr_recon_loss: 703061.8750; val_masked_gp_l1_reg_loss: 4221.0342; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108261.1797; val_chrom_access_recon_loss: 444067.4688; val_global_loss: 1683854.0000; val_optim_loss: 1683854.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8293; val_auprc_score: 0.8343; val_best_acc_score: 0.6362; val_best_f1_score: 0.7211; train_kl_reg_loss: 18558.3748; train_edge_recon_loss: 357513.8472; train_gene_expr_recon_loss: 699638.3611; train_masked_gp_l1_reg_loss: 4232.1099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104081.6719; train_chrom_access_recon_loss: 444641.3854; train_global_loss: 1628665.7361; train_optim_loss: 1628665.7361; val_kl_reg_loss: 17329.5469; val_edge_recon_loss: 404233.3750; val_gene_expr_recon_loss: 695907.8750; val_masked_gp_l1_reg_loss: 4236.0190; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98951.7812; val_chrom_access_recon_loss: 442616.5000; val_global_loss: 1663275.0000; val_optim_loss: 1663275.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8224; val_auprc_score: 0.8303; val_best_acc_score: 0.6773; val_best_f1_score: 0.7366; train_kl_reg_loss: 18985.0089; train_edge_recon_loss: 357205.4479; train_gene_expr_recon_loss: 691229.9514; train_masked_gp_l1_reg_loss: 4243.9543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95040.4089; train_chrom_access_recon_loss: 443831.8090; train_global_loss: 1610536.5972; train_optim_loss: 1610536.5972; val_kl_reg_loss: 18795.0703; val_edge_recon_loss: 402609.0625; val_gene_expr_recon_loss: 687606.6250; val_masked_gp_l1_reg_loss: 4245.9229; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90260.1172; val_chrom_access_recon_loss: 441232.9062; val_global_loss: 1644749.6250; val_optim_loss: 1644749.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8114; val_auprc_score: 0.8158; val_best_acc_score: 0.7191; val_best_f1_score: 0.7464; train_kl_reg_loss: 18937.9868; train_edge_recon_loss: 356526.9132; train_gene_expr_recon_loss: 684064.2847; train_masked_gp_l1_reg_loss: 4257.9728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86644.1241; train_chrom_access_recon_loss: 441991.7743; train_global_loss: 1592423.0694; train_optim_loss: 1592423.0694; val_kl_reg_loss: 18602.9648; val_edge_recon_loss: 400022.3125; val_gene_expr_recon_loss: 682524.5000; val_masked_gp_l1_reg_loss: 4262.8115; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82254.3828; val_chrom_access_recon_loss: 440173.0000; val_global_loss: 1627839.8750; val_optim_loss: 1627839.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8077; val_auprc_score: 0.8117; val_best_acc_score: 0.7216; val_best_f1_score: 0.7307; train_kl_reg_loss: 18909.8173; train_edge_recon_loss: 355647.8368; train_gene_expr_recon_loss: 680727.3542; train_masked_gp_l1_reg_loss: 4273.6989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78976.3533; train_chrom_access_recon_loss: 442490.1354; train_global_loss: 1581025.1806; train_optim_loss: 1581025.1806; val_kl_reg_loss: 18442.6250; val_edge_recon_loss: 397157.2188; val_gene_expr_recon_loss: 678355.6250; val_masked_gp_l1_reg_loss: 4282.0073; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75015.9844; val_chrom_access_recon_loss: 438783.5000; val_global_loss: 1612037.0000; val_optim_loss: 1612037.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8154; val_auprc_score: 0.8161; val_best_acc_score: 0.7164; val_best_f1_score: 0.7454; train_kl_reg_loss: 18668.0451; train_edge_recon_loss: 354464.9062; train_gene_expr_recon_loss: 674158.6250; train_masked_gp_l1_reg_loss: 4298.0808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72092.1441; train_chrom_access_recon_loss: 439231.3403; train_global_loss: 1562913.1528; train_optim_loss: 1562913.1528; val_kl_reg_loss: 16902.7539; val_edge_recon_loss: 392105.5000; val_gene_expr_recon_loss: 676938.0000; val_masked_gp_l1_reg_loss: 4306.8755; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68566.8125; val_chrom_access_recon_loss: 437893.1562; val_global_loss: 1596713.1250; val_optim_loss: 1596713.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8211; val_auprc_score: 0.8200; val_best_acc_score: 0.7215; val_best_f1_score: 0.7516; train_kl_reg_loss: 18579.4071; train_edge_recon_loss: 352549.9306; train_gene_expr_recon_loss: 676467.7153; train_masked_gp_l1_reg_loss: 4321.2434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65977.1771; train_chrom_access_recon_loss: 439692.3403; train_global_loss: 1557587.8472; train_optim_loss: 1557587.8472; val_kl_reg_loss: 17005.9336; val_edge_recon_loss: 386499.8438; val_gene_expr_recon_loss: 673638.1250; val_masked_gp_l1_reg_loss: 4333.6812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62844.3945; val_chrom_access_recon_loss: 436880.8125; val_global_loss: 1581202.7500; val_optim_loss: 1581202.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8389; val_auprc_score: 0.8350; val_best_acc_score: 0.7510; val_best_f1_score: 0.7620; train_kl_reg_loss: 18367.0412; train_edge_recon_loss: 349938.1250; train_gene_expr_recon_loss: 671871.6944; train_masked_gp_l1_reg_loss: 4357.1442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60543.2422; train_chrom_access_recon_loss: 438379.5278; train_global_loss: 1543456.7778; train_optim_loss: 1543456.7778; val_kl_reg_loss: 17210.6289; val_edge_recon_loss: 377021.8438; val_gene_expr_recon_loss: 671271.2500; val_masked_gp_l1_reg_loss: 4376.5723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57766.2109; val_chrom_access_recon_loss: 436076.5625; val_global_loss: 1563723.2500; val_optim_loss: 1563723.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8505; val_auprc_score: 0.8478; val_best_acc_score: 0.7635; val_best_f1_score: 0.7742; train_kl_reg_loss: 17990.0833; train_edge_recon_loss: 345845.0382; train_gene_expr_recon_loss: 668545.1319; train_masked_gp_l1_reg_loss: 4401.7609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55722.8038; train_chrom_access_recon_loss: 436640.1042; train_global_loss: 1529144.9028; train_optim_loss: 1529144.9028; val_kl_reg_loss: 17651.3867; val_edge_recon_loss: 364469.7812; val_gene_expr_recon_loss: 669385.0625; val_masked_gp_l1_reg_loss: 4421.9819; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53251.9922; val_chrom_access_recon_loss: 435597.0312; val_global_loss: 1544777.2500; val_optim_loss: 1544777.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8722; val_auprc_score: 0.8657; val_best_acc_score: 0.7871; val_best_f1_score: 0.7922; train_kl_reg_loss: 18854.0260; train_edge_recon_loss: 337228.9826; train_gene_expr_recon_loss: 666547.7083; train_masked_gp_l1_reg_loss: 4446.3110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51435.1576; train_chrom_access_recon_loss: 437649.6979; train_global_loss: 1516161.8889; train_optim_loss: 1516161.8889; val_kl_reg_loss: 19479.5156; val_edge_recon_loss: 335583.6875; val_gene_expr_recon_loss: 670772.3750; val_masked_gp_l1_reg_loss: 4472.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49240.1641; val_chrom_access_recon_loss: 435395.0625; val_global_loss: 1514943.2500; val_optim_loss: 1514943.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8822; val_auprc_score: 0.8710; val_best_acc_score: 0.7957; val_best_f1_score: 0.8090; train_kl_reg_loss: 23447.9275; train_edge_recon_loss: 321402.3125; train_gene_expr_recon_loss: 673005.8889; train_masked_gp_l1_reg_loss: 4503.5243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47625.9588; train_chrom_access_recon_loss: 436006.6910; train_global_loss: 1505992.3194; train_optim_loss: 1505992.3194; val_kl_reg_loss: 25726.1016; val_edge_recon_loss: 317089.1875; val_gene_expr_recon_loss: 668813.6875; val_masked_gp_l1_reg_loss: 4537.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45671.9453; val_chrom_access_recon_loss: 434708.6562; val_global_loss: 1496546.6250; val_optim_loss: 1496546.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9053; val_auprc_score: 0.8932; val_best_acc_score: 0.8239; val_best_f1_score: 0.8328; train_kl_reg_loss: 27534.3557; train_edge_recon_loss: 310871.3750; train_gene_expr_recon_loss: 665669.8889; train_masked_gp_l1_reg_loss: 4567.4578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44240.2700; train_chrom_access_recon_loss: 434901.5625; train_global_loss: 1487784.8889; train_optim_loss: 1487784.8889; val_kl_reg_loss: 26389.0527; val_edge_recon_loss: 308695.0625; val_gene_expr_recon_loss: 668013.0000; val_masked_gp_l1_reg_loss: 4599.1313; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42501.9922; val_chrom_access_recon_loss: 433979.0625; val_global_loss: 1484177.2500; val_optim_loss: 1484177.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9243; val_auprc_score: 0.9083; val_best_acc_score: 0.8496; val_best_f1_score: 0.8562; train_kl_reg_loss: 26603.9251; train_edge_recon_loss: 305826.2153; train_gene_expr_recon_loss: 666945.3611; train_masked_gp_l1_reg_loss: 4629.3787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41214.1871; train_chrom_access_recon_loss: 434872.0868; train_global_loss: 1480091.1389; train_optim_loss: 1480091.1389; val_kl_reg_loss: 25347.0215; val_edge_recon_loss: 302046.8438; val_gene_expr_recon_loss: 666598.5000; val_masked_gp_l1_reg_loss: 4664.1479; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39645.8359; val_chrom_access_recon_loss: 433209.0938; val_global_loss: 1471511.3750; val_optim_loss: 1471511.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9300; val_auprc_score: 0.9146; val_best_acc_score: 0.8615; val_best_f1_score: 0.8702; train_kl_reg_loss: 26051.5987; train_edge_recon_loss: 301508.9931; train_gene_expr_recon_loss: 664796.1389; train_masked_gp_l1_reg_loss: 4692.8279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38485.7678; train_chrom_access_recon_loss: 434860.9340; train_global_loss: 1470396.2361; train_optim_loss: 1470396.2361; val_kl_reg_loss: 25397.3047; val_edge_recon_loss: 299886.0312; val_gene_expr_recon_loss: 664916.1250; val_masked_gp_l1_reg_loss: 4723.9404; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37061.4648; val_chrom_access_recon_loss: 432353.2188; val_global_loss: 1464338.1250; val_optim_loss: 1464338.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9338; val_auprc_score: 0.9121; val_best_acc_score: 0.8659; val_best_f1_score: 0.8747; train_kl_reg_loss: 26364.0319; train_edge_recon_loss: 298265.9062; train_gene_expr_recon_loss: 663236.0208; train_masked_gp_l1_reg_loss: 4749.8684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36007.4844; train_chrom_access_recon_loss: 432897.5347; train_global_loss: 1461520.8472; train_optim_loss: 1461520.8472; val_kl_reg_loss: 25969.1094; val_edge_recon_loss: 296201.2500; val_gene_expr_recon_loss: 662626.1250; val_masked_gp_l1_reg_loss: 4781.3535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34722.4609; val_chrom_access_recon_loss: 431505.6250; val_global_loss: 1455806.0000; val_optim_loss: 1455806.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9381; val_auprc_score: 0.9245; val_best_acc_score: 0.8688; val_best_f1_score: 0.8769; train_kl_reg_loss: 26731.3982; train_edge_recon_loss: 295853.6597; train_gene_expr_recon_loss: 659209.6042; train_masked_gp_l1_reg_loss: 4808.4724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33776.2795; train_chrom_access_recon_loss: 432550.7292; train_global_loss: 1452930.1667; train_optim_loss: 1452930.1667; val_kl_reg_loss: 26783.9707; val_edge_recon_loss: 296021.9062; val_gene_expr_recon_loss: 660792.5000; val_masked_gp_l1_reg_loss: 4831.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32612.0137; val_chrom_access_recon_loss: 430712.3125; val_global_loss: 1451754.7500; val_optim_loss: 1451754.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9362; val_auprc_score: 0.9151; val_best_acc_score: 0.8713; val_best_f1_score: 0.8785; train_kl_reg_loss: 27130.8637; train_edge_recon_loss: 294673.3542; train_gene_expr_recon_loss: 659537.8194; train_masked_gp_l1_reg_loss: 4851.6790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31743.1330; train_chrom_access_recon_loss: 432802.9097; train_global_loss: 1450739.7639; train_optim_loss: 1450739.7639; val_kl_reg_loss: 26908.2949; val_edge_recon_loss: 295855.7500; val_gene_expr_recon_loss: 659698.9375; val_masked_gp_l1_reg_loss: 4871.5127; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30673.4688; val_chrom_access_recon_loss: 429976.7500; val_global_loss: 1447984.7500; val_optim_loss: 1447984.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9431; val_auprc_score: 0.9296; val_best_acc_score: 0.8779; val_best_f1_score: 0.8848; train_kl_reg_loss: 26742.0284; train_edge_recon_loss: 294998.8299; train_gene_expr_recon_loss: 658809.9444; train_masked_gp_l1_reg_loss: 4891.9171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29884.0872; train_chrom_access_recon_loss: 431268.3299; train_global_loss: 1446595.1389; train_optim_loss: 1446595.1389; val_kl_reg_loss: 25842.1875; val_edge_recon_loss: 294650.5625; val_gene_expr_recon_loss: 658454.8750; val_masked_gp_l1_reg_loss: 4910.8936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28914.6445; val_chrom_access_recon_loss: 429358.9375; val_global_loss: 1442132.0000; val_optim_loss: 1442132.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9417; val_auprc_score: 0.9232; val_best_acc_score: 0.8763; val_best_f1_score: 0.8817; train_kl_reg_loss: 26485.5310; train_edge_recon_loss: 293294.0868; train_gene_expr_recon_loss: 655541.9444; train_masked_gp_l1_reg_loss: 4928.6445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28194.3095; train_chrom_access_recon_loss: 429769.1806; train_global_loss: 1438213.6806; train_optim_loss: 1438213.6806; val_kl_reg_loss: 26195.1953; val_edge_recon_loss: 294085.2500; val_gene_expr_recon_loss: 657509.2500; val_masked_gp_l1_reg_loss: 4947.5815; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27303.4570; val_chrom_access_recon_loss: 428511.1875; val_global_loss: 1438551.8750; val_optim_loss: 1438551.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9343; val_auprc_score: 0.9157; val_best_acc_score: 0.8674; val_best_f1_score: 0.8746; train_kl_reg_loss: 25290.7589; train_edge_recon_loss: 297949.7604; train_gene_expr_recon_loss: 890033.2292; train_masked_gp_l1_reg_loss: 5026.6828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26479.2038; train_chrom_access_recon_loss: 456430.1771; train_global_loss: 1701209.8194; train_optim_loss: 1701209.8194; val_kl_reg_loss: 15312.6250; val_edge_recon_loss: 297247.5938; val_gene_expr_recon_loss: 889622.6875; val_masked_gp_l1_reg_loss: 5140.3931; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25359.4766; val_chrom_access_recon_loss: 452918.6562; val_global_loss: 1685601.3750; val_optim_loss: 1685601.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9375; val_auprc_score: 0.9196; val_best_acc_score: 0.8698; val_best_f1_score: 0.8780; train_kl_reg_loss: 23465.4303; train_edge_recon_loss: 293628.7188; train_gene_expr_recon_loss: 888958.8264; train_masked_gp_l1_reg_loss: 5237.3778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24433.5367; train_chrom_access_recon_loss: 453090.1007; train_global_loss: 1688814.0417; train_optim_loss: 1688814.0417; val_kl_reg_loss: 15388.4482; val_edge_recon_loss: 293014.8750; val_gene_expr_recon_loss: 885175.2500; val_masked_gp_l1_reg_loss: 5352.8115; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23292.5859; val_chrom_access_recon_loss: 452345.9375; val_global_loss: 1674569.7500; val_optim_loss: 1674569.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9394; val_auprc_score: 0.9210; val_best_acc_score: 0.8773; val_best_f1_score: 0.8841; train_kl_reg_loss: 21647.3954; train_edge_recon_loss: 291814.1215; train_gene_expr_recon_loss: 883014.2708; train_masked_gp_l1_reg_loss: 5434.0129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22429.6723; train_chrom_access_recon_loss: 452944.1181; train_global_loss: 1677283.5417; train_optim_loss: 1677283.5417; val_kl_reg_loss: 16621.3262; val_edge_recon_loss: 290814.8125; val_gene_expr_recon_loss: 881041.5000; val_masked_gp_l1_reg_loss: 5526.3823; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21382.7930; val_chrom_access_recon_loss: 451611.3750; val_global_loss: 1666998.1250; val_optim_loss: 1666998.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9510; val_auprc_score: 0.9378; val_best_acc_score: 0.8891; val_best_f1_score: 0.8932; train_kl_reg_loss: 20899.3192; train_edge_recon_loss: 289332.4826; train_gene_expr_recon_loss: 879075.3056; train_masked_gp_l1_reg_loss: 5589.1343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20603.0898; train_chrom_access_recon_loss: 453071.0278; train_global_loss: 1668570.3611; train_optim_loss: 1668570.3611; val_kl_reg_loss: 17386.7949; val_edge_recon_loss: 287241.8125; val_gene_expr_recon_loss: 878632.3125; val_masked_gp_l1_reg_loss: 5660.2437; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19664.9961; val_chrom_access_recon_loss: 451148.2500; val_global_loss: 1659734.3750; val_optim_loss: 1659734.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9473; val_auprc_score: 0.9314; val_best_acc_score: 0.8887; val_best_f1_score: 0.8948; train_kl_reg_loss: 20603.0734; train_edge_recon_loss: 287526.2812; train_gene_expr_recon_loss: 874252.4028; train_masked_gp_l1_reg_loss: 5651.5145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19497.7370; train_chrom_access_recon_loss: 451977.8958; train_global_loss: 1659508.9167; train_optim_loss: 1659508.9167; val_kl_reg_loss: 17526.8262; val_edge_recon_loss: 289488.7188; val_gene_expr_recon_loss: 876934.8750; val_masked_gp_l1_reg_loss: 5643.2256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19318.0312; val_chrom_access_recon_loss: 450861.9062; val_global_loss: 1659773.5000; val_optim_loss: 1659773.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9507; val_auprc_score: 0.9350; val_best_acc_score: 0.8887; val_best_f1_score: 0.8933; train_kl_reg_loss: 20557.1406; train_edge_recon_loss: 287947.6076; train_gene_expr_recon_loss: 876097.3958; train_masked_gp_l1_reg_loss: 5643.1332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19217.8244; train_chrom_access_recon_loss: 451447.6597; train_global_loss: 1660910.7500; train_optim_loss: 1660910.7500; val_kl_reg_loss: 17506.0703; val_edge_recon_loss: 287925.1562; val_gene_expr_recon_loss: 877111.5625; val_masked_gp_l1_reg_loss: 5642.1772; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19086.5977; val_chrom_access_recon_loss: 450913.9062; val_global_loss: 1658185.3750; val_optim_loss: 1658185.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9478; val_auprc_score: 0.9338; val_best_acc_score: 0.8851; val_best_f1_score: 0.8903; train_kl_reg_loss: 20449.4948; train_edge_recon_loss: 288135.9653; train_gene_expr_recon_loss: 875971.6667; train_masked_gp_l1_reg_loss: 5642.7636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18993.3539; train_chrom_access_recon_loss: 454292.0660; train_global_loss: 1663485.3194; train_optim_loss: 1663485.3194; val_kl_reg_loss: 17516.1328; val_edge_recon_loss: 288281.9062; val_gene_expr_recon_loss: 876583.2500; val_masked_gp_l1_reg_loss: 5643.8237; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18879.9023; val_chrom_access_recon_loss: 450785.9375; val_global_loss: 1657691.0000; val_optim_loss: 1657691.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9510; val_auprc_score: 0.9390; val_best_acc_score: 0.8853; val_best_f1_score: 0.8898; train_kl_reg_loss: 20358.2357; train_edge_recon_loss: 287901.2153; train_gene_expr_recon_loss: 871975.1111; train_masked_gp_l1_reg_loss: 5645.3581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18794.4377; train_chrom_access_recon_loss: 450603.7743; train_global_loss: 1655278.1111; train_optim_loss: 1655278.1111; val_kl_reg_loss: 17600.6367; val_edge_recon_loss: 289899.4375; val_gene_expr_recon_loss: 876359.3750; val_masked_gp_l1_reg_loss: 5647.6904; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18692.6055; val_chrom_access_recon_loss: 450764.2188; val_global_loss: 1658964.1250; val_optim_loss: 1658964.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9422
val AUPRC score: 0.9274
val best accuracy score: 0.8787
val best F1 score: 0.8842
val target rna MSE score: 3.6065
val source rna MSE score: 3.1494
val target atac MSE score: 0.1343
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
