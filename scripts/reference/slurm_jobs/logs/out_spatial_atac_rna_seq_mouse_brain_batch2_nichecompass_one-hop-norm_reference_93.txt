[True]
Run timestamp: 10102023_010152_93.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_93']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7734; val_auprc_score: 0.7962; val_best_acc_score: 0.5249; val_best_f1_score: 0.6766; train_kl_reg_loss: 76740.0552; train_edge_recon_loss: 3509003.6011; train_gene_expr_recon_loss: 13299528.5496; train_masked_gp_l1_reg_loss: 45730.6415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3368518.9303; train_chrom_access_recon_loss: 6677811.9427; train_global_loss: 26977333.6794; train_optim_loss: 26977333.6794; val_kl_reg_loss: 101040.3891; val_edge_recon_loss: 4063680.3000; val_gene_expr_recon_loss: 12692070.3333; val_masked_gp_l1_reg_loss: 52074.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 500557.2500; val_chrom_access_recon_loss: 6551902.7333; val_global_loss: 23961325.4667; val_optim_loss: 23961325.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8292; val_auprc_score: 0.8382; val_best_acc_score: 0.7443; val_best_f1_score: 0.7610; train_kl_reg_loss: 86948.1430; train_edge_recon_loss: 3499056.3702; train_gene_expr_recon_loss: 12534870.9160; train_masked_gp_l1_reg_loss: 56071.9894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 279828.5912; train_chrom_access_recon_loss: 6460535.4160; train_global_loss: 22917311.5420; train_optim_loss: 22917311.5420; val_kl_reg_loss: 75329.8422; val_edge_recon_loss: 3855060.7667; val_gene_expr_recon_loss: 12556701.2000; val_masked_gp_l1_reg_loss: 59431.5898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 184997.2812; val_chrom_access_recon_loss: 6482138.0000; val_global_loss: 23213658.8000; val_optim_loss: 23213658.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9169; val_auprc_score: 0.8982; val_best_acc_score: 0.8495; val_best_f1_score: 0.8593; train_kl_reg_loss: 90443.7155; train_edge_recon_loss: 3029420.0496; train_gene_expr_recon_loss: 12394216.7786; train_masked_gp_l1_reg_loss: 65410.1260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156828.6681; train_chrom_access_recon_loss: 6375504.2824; train_global_loss: 22111823.6031; train_optim_loss: 22111823.6031; val_kl_reg_loss: 112448.1870; val_edge_recon_loss: 2857124.5333; val_gene_expr_recon_loss: 12406625.9333; val_masked_gp_l1_reg_loss: 70036.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136353.2969; val_chrom_access_recon_loss: 6379050.9333; val_global_loss: 21961639.4667; val_optim_loss: 21961639.4667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9288; val_auprc_score: 0.9150; val_best_acc_score: 0.8587; val_best_f1_score: 0.8674; train_kl_reg_loss: 108116.9039; train_edge_recon_loss: 2828255.5305; train_gene_expr_recon_loss: 12263684.4580; train_masked_gp_l1_reg_loss: 72846.8182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128170.6333; train_chrom_access_recon_loss: 6311858.4275; train_global_loss: 21712932.8244; train_optim_loss: 21712932.8244; val_kl_reg_loss: 110442.1349; val_edge_recon_loss: 2836536.5667; val_gene_expr_recon_loss: 12269197.6667; val_masked_gp_l1_reg_loss: 74921.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122637.5703; val_chrom_access_recon_loss: 6312700.7667; val_global_loss: 21726435.8667; val_optim_loss: 21726435.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9316; val_auprc_score: 0.9175; val_best_acc_score: 0.8654; val_best_f1_score: 0.8733; train_kl_reg_loss: 103231.3290; train_edge_recon_loss: 2812858.8263; train_gene_expr_recon_loss: 12169565.9237; train_masked_gp_l1_reg_loss: 76651.4908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119741.5597; train_chrom_access_recon_loss: 6268791.6794; train_global_loss: 21550840.7328; train_optim_loss: 21550840.7328; val_kl_reg_loss: 99022.2812; val_edge_recon_loss: 2819936.5167; val_gene_expr_recon_loss: 12143715.7333; val_masked_gp_l1_reg_loss: 78435.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117849.8906; val_chrom_access_recon_loss: 6291937.4000; val_global_loss: 21550896.6667; val_optim_loss: 21550896.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9343; val_auprc_score: 0.9182; val_best_acc_score: 0.8744; val_best_f1_score: 0.8819; train_kl_reg_loss: 97343.2567; train_edge_recon_loss: 2799778.9790; train_gene_expr_recon_loss: 12045889.1527; train_masked_gp_l1_reg_loss: 79523.1347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115760.7204; train_chrom_access_recon_loss: 6208235.4809; train_global_loss: 21346530.7176; train_optim_loss: 21346530.7176; val_kl_reg_loss: 96836.4964; val_edge_recon_loss: 2785929.7833; val_gene_expr_recon_loss: 12058482.6000; val_masked_gp_l1_reg_loss: 80839.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114700.5781; val_chrom_access_recon_loss: 6237221.3667; val_global_loss: 21374011.3333; val_optim_loss: 21374011.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9422; val_auprc_score: 0.9302; val_best_acc_score: 0.8808; val_best_f1_score: 0.8861; train_kl_reg_loss: 93845.3380; train_edge_recon_loss: 2794054.5248; train_gene_expr_recon_loss: 11967176.7023; train_masked_gp_l1_reg_loss: 81827.9436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112955.1943; train_chrom_access_recon_loss: 6179272.2977; train_global_loss: 21229131.9084; train_optim_loss: 21229131.9084; val_kl_reg_loss: 94157.5776; val_edge_recon_loss: 2799184.4167; val_gene_expr_recon_loss: 12016329.9333; val_masked_gp_l1_reg_loss: 82835.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111463.7266; val_chrom_access_recon_loss: 6252081.2000; val_global_loss: 21356051.8667; val_optim_loss: 21356051.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9416; val_auprc_score: 0.9272; val_best_acc_score: 0.8835; val_best_f1_score: 0.8895; train_kl_reg_loss: 90955.3224; train_edge_recon_loss: 2768905.5420; train_gene_expr_recon_loss: 11890179.9542; train_masked_gp_l1_reg_loss: 83558.9685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110129.8714; train_chrom_access_recon_loss: 6135493.6260; train_global_loss: 21079223.3282; train_optim_loss: 21079223.3282; val_kl_reg_loss: 92185.3458; val_edge_recon_loss: 2783386.4833; val_gene_expr_recon_loss: 11875535.9333; val_masked_gp_l1_reg_loss: 84335.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108367.1797; val_chrom_access_recon_loss: 6188877.5667; val_global_loss: 21132687.3333; val_optim_loss: 21132687.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9471; val_auprc_score: 0.9327; val_best_acc_score: 0.8857; val_best_f1_score: 0.8906; train_kl_reg_loss: 91054.0540; train_edge_recon_loss: 2752195.4523; train_gene_expr_recon_loss: 11808772.0305; train_masked_gp_l1_reg_loss: 84936.8913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107208.4314; train_chrom_access_recon_loss: 6096671.4924; train_global_loss: 20940838.4122; train_optim_loss: 20940838.4122; val_kl_reg_loss: 90780.6573; val_edge_recon_loss: 2769340.2667; val_gene_expr_recon_loss: 11835920.0667; val_masked_gp_l1_reg_loss: 85498.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106221.0078; val_chrom_access_recon_loss: 6126398.1000; val_global_loss: 21014158.1333; val_optim_loss: 21014158.1333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9557; val_auprc_score: 0.9451; val_best_acc_score: 0.8941; val_best_f1_score: 0.8981; train_kl_reg_loss: 87983.8659; train_edge_recon_loss: 2748260.3912; train_gene_expr_recon_loss: 11761907.6336; train_masked_gp_l1_reg_loss: 86167.0035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105376.9556; train_chrom_access_recon_loss: 6068180.6107; train_global_loss: 20857876.4580; train_optim_loss: 20857876.4580; val_kl_reg_loss: 87120.6193; val_edge_recon_loss: 2749198.9500; val_gene_expr_recon_loss: 11840253.6667; val_masked_gp_l1_reg_loss: 86681.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104313.3984; val_chrom_access_recon_loss: 6134939.0000; val_global_loss: 21002506.4000; val_optim_loss: 21002506.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9592; val_auprc_score: 0.9502; val_best_acc_score: 0.9029; val_best_f1_score: 0.9065; train_kl_reg_loss: 88828.7575; train_edge_recon_loss: 2726008.9752; train_gene_expr_recon_loss: 11718348.2748; train_masked_gp_l1_reg_loss: 87108.0782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103917.2122; train_chrom_access_recon_loss: 6046929.7481; train_global_loss: 20771141.0534; train_optim_loss: 20771141.0534; val_kl_reg_loss: 90393.6828; val_edge_recon_loss: 2725038.0500; val_gene_expr_recon_loss: 11727512.6667; val_masked_gp_l1_reg_loss: 87621.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102840.9688; val_chrom_access_recon_loss: 6083835.0667; val_global_loss: 20817241.4667; val_optim_loss: 20817241.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9613; val_auprc_score: 0.9501; val_best_acc_score: 0.9058; val_best_f1_score: 0.9102; train_kl_reg_loss: 86723.2657; train_edge_recon_loss: 2729624.6336; train_gene_expr_recon_loss: 11657330.9695; train_masked_gp_l1_reg_loss: 87825.9636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102759.8828; train_chrom_access_recon_loss: 6009360.9237; train_global_loss: 20673625.6489; train_optim_loss: 20673625.6489; val_kl_reg_loss: 87595.3484; val_edge_recon_loss: 2741698.6000; val_gene_expr_recon_loss: 11728894.2000; val_masked_gp_l1_reg_loss: 88152.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102897.7344; val_chrom_access_recon_loss: 6069300.4667; val_global_loss: 20818538.6667; val_optim_loss: 20818538.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9569; val_auprc_score: 0.9432; val_best_acc_score: 0.9031; val_best_f1_score: 0.9066; train_kl_reg_loss: 85307.6568; train_edge_recon_loss: 2722407.7004; train_gene_expr_recon_loss: 11608433.6947; train_masked_gp_l1_reg_loss: 88385.6196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101912.3241; train_chrom_access_recon_loss: 5981404.7405; train_global_loss: 20587851.8626; train_optim_loss: 20587851.8626; val_kl_reg_loss: 87243.1323; val_edge_recon_loss: 2747955.3833; val_gene_expr_recon_loss: 11661661.4000; val_masked_gp_l1_reg_loss: 88632.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102189.2266; val_chrom_access_recon_loss: 6020672.6333; val_global_loss: 20708354.1333; val_optim_loss: 20708354.1333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9658; val_auprc_score: 0.9560; val_best_acc_score: 0.9109; val_best_f1_score: 0.9147; train_kl_reg_loss: 84831.8225; train_edge_recon_loss: 2714844.2691; train_gene_expr_recon_loss: 11589017.1069; train_masked_gp_l1_reg_loss: 88618.0502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101020.1562; train_chrom_access_recon_loss: 5967233.7519; train_global_loss: 20545565.2977; train_optim_loss: 20545565.2977; val_kl_reg_loss: 86898.9391; val_edge_recon_loss: 2717819.4833; val_gene_expr_recon_loss: 11614019.0000; val_masked_gp_l1_reg_loss: 88910.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100884.3828; val_chrom_access_recon_loss: 5987888.4667; val_global_loss: 20596419.7333; val_optim_loss: 20596419.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9668; val_auprc_score: 0.9573; val_best_acc_score: 0.9143; val_best_f1_score: 0.9168; train_kl_reg_loss: 84054.1915; train_edge_recon_loss: 2705800.9141; train_gene_expr_recon_loss: 11541072.4122; train_masked_gp_l1_reg_loss: 88950.8185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100006.8952; train_chrom_access_recon_loss: 5943331.3053; train_global_loss: 20463216.4427; train_optim_loss: 20463216.4427; val_kl_reg_loss: 86241.7943; val_edge_recon_loss: 2728463.4833; val_gene_expr_recon_loss: 11670433.2000; val_masked_gp_l1_reg_loss: 89032.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99437.8203; val_chrom_access_recon_loss: 6017702.9667; val_global_loss: 20691312.5333; val_optim_loss: 20691312.5333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9678; val_auprc_score: 0.9581; val_best_acc_score: 0.9175; val_best_f1_score: 0.9207; train_kl_reg_loss: 83427.3882; train_edge_recon_loss: 2712805.9046; train_gene_expr_recon_loss: 11508120.4351; train_masked_gp_l1_reg_loss: 89045.3033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98713.4401; train_chrom_access_recon_loss: 5920480.3550; train_global_loss: 20412592.7939; train_optim_loss: 20412592.7939; val_kl_reg_loss: 83105.2766; val_edge_recon_loss: 2729269.5500; val_gene_expr_recon_loss: 11551733.5333; val_masked_gp_l1_reg_loss: 89061.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98434.7266; val_chrom_access_recon_loss: 5975166.1000; val_global_loss: 20526771.4667; val_optim_loss: 20526771.4667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9683; val_auprc_score: 0.9573; val_best_acc_score: 0.9216; val_best_f1_score: 0.9241; train_kl_reg_loss: 82616.2140; train_edge_recon_loss: 2704331.4103; train_gene_expr_recon_loss: 11484057.7099; train_masked_gp_l1_reg_loss: 89021.7612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97762.1836; train_chrom_access_recon_loss: 5907904.9733; train_global_loss: 20365694.2443; train_optim_loss: 20365694.2443; val_kl_reg_loss: 82141.5437; val_edge_recon_loss: 2734118.0833; val_gene_expr_recon_loss: 11540665.3333; val_masked_gp_l1_reg_loss: 88902.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97807.8438; val_chrom_access_recon_loss: 5963151.8667; val_global_loss: 20506788.0000; val_optim_loss: 20506788.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9692; val_auprc_score: 0.9607; val_best_acc_score: 0.9190; val_best_f1_score: 0.9219; train_kl_reg_loss: 81485.4218; train_edge_recon_loss: 2700457.5229; train_gene_expr_recon_loss: 11457699.8244; train_masked_gp_l1_reg_loss: 88862.0674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97228.7966; train_chrom_access_recon_loss: 5888194.8168; train_global_loss: 20313928.5191; train_optim_loss: 20313928.5191; val_kl_reg_loss: 83188.9130; val_edge_recon_loss: 2719738.6833; val_gene_expr_recon_loss: 11486217.2000; val_masked_gp_l1_reg_loss: 88811.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96876.5703; val_chrom_access_recon_loss: 5890745.6000; val_global_loss: 20365578.4000; val_optim_loss: 20365578.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9726; val_auprc_score: 0.9640; val_best_acc_score: 0.9274; val_best_f1_score: 0.9301; train_kl_reg_loss: 80773.0518; train_edge_recon_loss: 2692493.5210; train_gene_expr_recon_loss: 11439080.6565; train_masked_gp_l1_reg_loss: 88731.8603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96693.5193; train_chrom_access_recon_loss: 5867181.0038; train_global_loss: 20264953.5573; train_optim_loss: 20264953.5573; val_kl_reg_loss: 77196.6500; val_edge_recon_loss: 2704808.7333; val_gene_expr_recon_loss: 11509068.2000; val_masked_gp_l1_reg_loss: 88592.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96010.3438; val_chrom_access_recon_loss: 5905517.8667; val_global_loss: 20381194.1333; val_optim_loss: 20381194.1333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9754; val_auprc_score: 0.9712; val_best_acc_score: 0.9272; val_best_f1_score: 0.9293; train_kl_reg_loss: 79705.1650; train_edge_recon_loss: 2699672.4466; train_gene_expr_recon_loss: 11414815.3893; train_masked_gp_l1_reg_loss: 88520.9303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96356.6378; train_chrom_access_recon_loss: 5858857.5458; train_global_loss: 20237928.0611; train_optim_loss: 20237928.0611; val_kl_reg_loss: 82609.1922; val_edge_recon_loss: 2714731.8833; val_gene_expr_recon_loss: 11442697.0000; val_masked_gp_l1_reg_loss: 88476.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96442.1875; val_chrom_access_recon_loss: 5891297.3667; val_global_loss: 20316253.0667; val_optim_loss: 20316253.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9782; val_auprc_score: 0.9731; val_best_acc_score: 0.9357; val_best_f1_score: 0.9370; train_kl_reg_loss: 79869.8916; train_edge_recon_loss: 2695209.3263; train_gene_expr_recon_loss: 11399222.3053; train_masked_gp_l1_reg_loss: 88181.8128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95875.0765; train_chrom_access_recon_loss: 5833293.3359; train_global_loss: 20191651.6031; train_optim_loss: 20191651.6031; val_kl_reg_loss: 76254.2318; val_edge_recon_loss: 2690484.7000; val_gene_expr_recon_loss: 11411135.5333; val_masked_gp_l1_reg_loss: 88359.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96702.0859; val_chrom_access_recon_loss: 5866461.0000; val_global_loss: 20229396.5333; val_optim_loss: 20229396.5333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9776; val_auprc_score: 0.9718; val_best_acc_score: 0.9332; val_best_f1_score: 0.9343; train_kl_reg_loss: 78184.5649; train_edge_recon_loss: 2689742.0095; train_gene_expr_recon_loss: 11367957.7252; train_masked_gp_l1_reg_loss: 88110.1718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95899.2453; train_chrom_access_recon_loss: 5812907.6679; train_global_loss: 20132801.4046; train_optim_loss: 20132801.4046; val_kl_reg_loss: 80180.8234; val_edge_recon_loss: 2699656.1833; val_gene_expr_recon_loss: 11429722.0667; val_masked_gp_l1_reg_loss: 87919.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95557.5234; val_chrom_access_recon_loss: 5865705.9000; val_global_loss: 20258742.8000; val_optim_loss: 20258742.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9736; val_auprc_score: 0.9667; val_best_acc_score: 0.9275; val_best_f1_score: 0.9296; train_kl_reg_loss: 78118.6871; train_edge_recon_loss: 2682785.9828; train_gene_expr_recon_loss: 11355782.2901; train_masked_gp_l1_reg_loss: 87795.4611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95522.6759; train_chrom_access_recon_loss: 5804421.3550; train_global_loss: 20104426.3969; train_optim_loss: 20104426.3969; val_kl_reg_loss: 77760.0969; val_edge_recon_loss: 2719441.9000; val_gene_expr_recon_loss: 11401981.4667; val_masked_gp_l1_reg_loss: 87871.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95478.1328; val_chrom_access_recon_loss: 5863043.9333; val_global_loss: 20245576.6667; val_optim_loss: 20245576.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9795; val_auprc_score: 0.9744; val_best_acc_score: 0.9355; val_best_f1_score: 0.9370; train_kl_reg_loss: 76781.7370; train_edge_recon_loss: 2687105.0439; train_gene_expr_recon_loss: 11331089.3740; train_masked_gp_l1_reg_loss: 87706.9210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95347.0457; train_chrom_access_recon_loss: 5781813.0687; train_global_loss: 20059843.1908; train_optim_loss: 20059843.1908; val_kl_reg_loss: 78156.2786; val_edge_recon_loss: 2696447.1833; val_gene_expr_recon_loss: 11407064.3333; val_masked_gp_l1_reg_loss: 87871.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96140.9766; val_chrom_access_recon_loss: 5854627.7000; val_global_loss: 20220308.5333; val_optim_loss: 20220308.5333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9801; val_auprc_score: 0.9754; val_best_acc_score: 0.9391; val_best_f1_score: 0.9406; train_kl_reg_loss: 77545.2983; train_edge_recon_loss: 2681669.8836; train_gene_expr_recon_loss: 11332404.8855; train_masked_gp_l1_reg_loss: 87399.2914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95446.5382; train_chrom_access_recon_loss: 5777280.3359; train_global_loss: 20051746.1985; train_optim_loss: 20051746.1985; val_kl_reg_loss: 77535.8104; val_edge_recon_loss: 2695604.9167; val_gene_expr_recon_loss: 11408911.2000; val_masked_gp_l1_reg_loss: 87353.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96294.8203; val_chrom_access_recon_loss: 5870016.4333; val_global_loss: 20235716.5333; val_optim_loss: 20235716.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9800; val_auprc_score: 0.9717; val_best_acc_score: 0.9394; val_best_f1_score: 0.9412; train_kl_reg_loss: 77357.2452; train_edge_recon_loss: 2677921.8321; train_gene_expr_recon_loss: 11325376.1756; train_masked_gp_l1_reg_loss: 87156.7824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95546.8164; train_chrom_access_recon_loss: 5769668.6489; train_global_loss: 20033027.5420; train_optim_loss: 20033027.5420; val_kl_reg_loss: 75554.2521; val_edge_recon_loss: 2691875.2500; val_gene_expr_recon_loss: 11405969.1333; val_masked_gp_l1_reg_loss: 86918.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95270.9062; val_chrom_access_recon_loss: 5873139.7000; val_global_loss: 20228727.2000; val_optim_loss: 20228727.2000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9803; val_auprc_score: 0.9731; val_best_acc_score: 0.9421; val_best_f1_score: 0.9439; train_kl_reg_loss: 76597.6313; train_edge_recon_loss: 2672831.5000; train_gene_expr_recon_loss: 11293532.8473; train_masked_gp_l1_reg_loss: 86868.2601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95171.3575; train_chrom_access_recon_loss: 5747113.5115; train_global_loss: 19972115.0687; train_optim_loss: 19972115.0687; val_kl_reg_loss: 78886.2385; val_edge_recon_loss: 2677540.6167; val_gene_expr_recon_loss: 11390563.0000; val_masked_gp_l1_reg_loss: 86747.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95301.9219; val_chrom_access_recon_loss: 5845476.8667; val_global_loss: 20174516.6667; val_optim_loss: 20174516.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9799; val_auprc_score: 0.9725; val_best_acc_score: 0.9379; val_best_f1_score: 0.9394; train_kl_reg_loss: 75217.7769; train_edge_recon_loss: 2677989.2099; train_gene_expr_recon_loss: 11293001.0534; train_masked_gp_l1_reg_loss: 86609.8096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95496.0829; train_chrom_access_recon_loss: 5740593.8053; train_global_loss: 19968907.8168; train_optim_loss: 19968907.8168; val_kl_reg_loss: 75252.1953; val_edge_recon_loss: 2686242.3667; val_gene_expr_recon_loss: 11326564.5333; val_masked_gp_l1_reg_loss: 86519.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95881.2031; val_chrom_access_recon_loss: 5818348.6333; val_global_loss: 20088807.6000; val_optim_loss: 20088807.6000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9812; val_auprc_score: 0.9756; val_best_acc_score: 0.9414; val_best_f1_score: 0.9425; train_kl_reg_loss: 75571.8307; train_edge_recon_loss: 2671278.7786; train_gene_expr_recon_loss: 11297566.7099; train_masked_gp_l1_reg_loss: 86334.4284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95622.7149; train_chrom_access_recon_loss: 5735462.7519; train_global_loss: 19961837.1603; train_optim_loss: 19961837.1603; val_kl_reg_loss: 75225.0401; val_edge_recon_loss: 2691411.9000; val_gene_expr_recon_loss: 11343866.1333; val_masked_gp_l1_reg_loss: 86135.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95323.8672; val_chrom_access_recon_loss: 5818192.1667; val_global_loss: 20110154.2667; val_optim_loss: 20110154.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9820; val_auprc_score: 0.9765; val_best_acc_score: 0.9417; val_best_f1_score: 0.9433; train_kl_reg_loss: 75605.6633; train_edge_recon_loss: 2674549.1546; train_gene_expr_recon_loss: 11263962.0229; train_masked_gp_l1_reg_loss: 85928.4074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95521.2248; train_chrom_access_recon_loss: 5717017.3015; train_global_loss: 19912583.8779; train_optim_loss: 19912583.8779; val_kl_reg_loss: 75861.7615; val_edge_recon_loss: 2687528.0667; val_gene_expr_recon_loss: 11372078.6000; val_masked_gp_l1_reg_loss: 85695.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95559.9297; val_chrom_access_recon_loss: 5790381.1000; val_global_loss: 20107104.2667; val_optim_loss: 20107104.2667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9824; val_auprc_score: 0.9773; val_best_acc_score: 0.9456; val_best_f1_score: 0.9466; train_kl_reg_loss: 74870.7217; train_edge_recon_loss: 2672689.8092; train_gene_expr_recon_loss: 11251133.1908; train_masked_gp_l1_reg_loss: 85583.1857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95743.4293; train_chrom_access_recon_loss: 5699523.4656; train_global_loss: 19879543.7252; train_optim_loss: 19879543.7252; val_kl_reg_loss: 74393.7568; val_edge_recon_loss: 2692098.0500; val_gene_expr_recon_loss: 11377444.7333; val_masked_gp_l1_reg_loss: 85389.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96460.9609; val_chrom_access_recon_loss: 5813938.9667; val_global_loss: 20139726.4000; val_optim_loss: 20139726.4000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9824; val_auprc_score: 0.9787; val_best_acc_score: 0.9426; val_best_f1_score: 0.9440; train_kl_reg_loss: 75043.4361; train_edge_recon_loss: 2670671.6489; train_gene_expr_recon_loss: 11251654.8855; train_masked_gp_l1_reg_loss: 85018.2959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95896.4924; train_chrom_access_recon_loss: 5698852.8321; train_global_loss: 19877137.5420; train_optim_loss: 19877137.5420; val_kl_reg_loss: 72244.6177; val_edge_recon_loss: 2689499.8000; val_gene_expr_recon_loss: 11334457.3333; val_masked_gp_l1_reg_loss: 84918.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96131.9688; val_chrom_access_recon_loss: 5808996.8667; val_global_loss: 20086249.6000; val_optim_loss: 20086249.6000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9852; val_auprc_score: 0.9797; val_best_acc_score: 0.9480; val_best_f1_score: 0.9494; train_kl_reg_loss: 74178.1830; train_edge_recon_loss: 2677825.2004; train_gene_expr_recon_loss: 11241863.7939; train_masked_gp_l1_reg_loss: 84696.6893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96189.7809; train_chrom_access_recon_loss: 5689854.0725; train_global_loss: 19864607.7405; train_optim_loss: 19864607.7405; val_kl_reg_loss: 75224.8656; val_edge_recon_loss: 2678239.3000; val_gene_expr_recon_loss: 11304651.3333; val_masked_gp_l1_reg_loss: 84476.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96266.1094; val_chrom_access_recon_loss: 5793466.7333; val_global_loss: 20032324.0000; val_optim_loss: 20032324.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9852; val_auprc_score: 0.9824; val_best_acc_score: 0.9465; val_best_f1_score: 0.9479; train_kl_reg_loss: 74938.4733; train_edge_recon_loss: 2666566.9141; train_gene_expr_recon_loss: 11233265.8931; train_masked_gp_l1_reg_loss: 84323.3189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96080.4625; train_chrom_access_recon_loss: 5673539.3931; train_global_loss: 19828714.5038; train_optim_loss: 19828714.5038; val_kl_reg_loss: 73565.7693; val_edge_recon_loss: 2679005.3000; val_gene_expr_recon_loss: 11287884.6667; val_masked_gp_l1_reg_loss: 84162.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96566.1172; val_chrom_access_recon_loss: 5753333.8000; val_global_loss: 19974518.6667; val_optim_loss: 19974518.6667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9834; val_auprc_score: 0.9767; val_best_acc_score: 0.9483; val_best_f1_score: 0.9492; train_kl_reg_loss: 74299.5338; train_edge_recon_loss: 2667322.3206; train_gene_expr_recon_loss: 11227701.8168; train_masked_gp_l1_reg_loss: 84074.0489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96327.1515; train_chrom_access_recon_loss: 5668852.2214; train_global_loss: 19818577.1450; train_optim_loss: 19818577.1450; val_kl_reg_loss: 74262.5297; val_edge_recon_loss: 2670691.5000; val_gene_expr_recon_loss: 11296122.3333; val_masked_gp_l1_reg_loss: 83922.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96974.3203; val_chrom_access_recon_loss: 5771603.6000; val_global_loss: 19993575.8667; val_optim_loss: 19993575.8667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9865; val_auprc_score: 0.9830; val_best_acc_score: 0.9491; val_best_f1_score: 0.9503; train_kl_reg_loss: 74422.8777; train_edge_recon_loss: 2663385.5744; train_gene_expr_recon_loss: 11224616.1908; train_masked_gp_l1_reg_loss: 83700.7443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96441.8768; train_chrom_access_recon_loss: 5670599.5038; train_global_loss: 19813166.6870; train_optim_loss: 19813166.6870; val_kl_reg_loss: 74346.0031; val_edge_recon_loss: 2678918.2333; val_gene_expr_recon_loss: 11335125.6000; val_masked_gp_l1_reg_loss: 83672.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97026.4062; val_chrom_access_recon_loss: 5798917.2667; val_global_loss: 20068005.4667; val_optim_loss: 20068005.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9844; val_auprc_score: 0.9766; val_best_acc_score: 0.9469; val_best_f1_score: 0.9483; train_kl_reg_loss: 74126.1284; train_edge_recon_loss: 2669988.7557; train_gene_expr_recon_loss: 11208540.0992; train_masked_gp_l1_reg_loss: 83382.0437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96717.1643; train_chrom_access_recon_loss: 5655106.9618; train_global_loss: 19787861.2519; train_optim_loss: 19787861.2519; val_kl_reg_loss: 76169.3010; val_edge_recon_loss: 2686725.8833; val_gene_expr_recon_loss: 11289293.2000; val_masked_gp_l1_reg_loss: 83014.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97255.0234; val_chrom_access_recon_loss: 5751512.5667; val_global_loss: 19983970.0000; val_optim_loss: 19983970.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9865; val_auprc_score: 0.9816; val_best_acc_score: 0.9511; val_best_f1_score: 0.9519; train_kl_reg_loss: 74218.9485; train_edge_recon_loss: 2663625.0191; train_gene_expr_recon_loss: 11220182.9389; train_masked_gp_l1_reg_loss: 82866.8794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96946.1124; train_chrom_access_recon_loss: 5650033.7634; train_global_loss: 19787873.6183; train_optim_loss: 19787873.6183; val_kl_reg_loss: 74369.8552; val_edge_recon_loss: 2680071.8333; val_gene_expr_recon_loss: 11265976.1333; val_masked_gp_l1_reg_loss: 82894.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97156.1406; val_chrom_access_recon_loss: 5748236.8000; val_global_loss: 19948705.4667; val_optim_loss: 19948705.4667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9852; val_auprc_score: 0.9810; val_best_acc_score: 0.9503; val_best_f1_score: 0.9517; train_kl_reg_loss: 73424.5253; train_edge_recon_loss: 2667004.1450; train_gene_expr_recon_loss: 11202685.5115; train_masked_gp_l1_reg_loss: 82614.9234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97166.7423; train_chrom_access_recon_loss: 5643624.1565; train_global_loss: 19766520.0153; train_optim_loss: 19766520.0153; val_kl_reg_loss: 70849.2901; val_edge_recon_loss: 2688854.4000; val_gene_expr_recon_loss: 11288090.9333; val_masked_gp_l1_reg_loss: 82374.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97784.6953; val_chrom_access_recon_loss: 5768155.3000; val_global_loss: 19996108.8000; val_optim_loss: 19996108.8000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9862; val_auprc_score: 0.9766; val_best_acc_score: 0.9549; val_best_f1_score: 0.9559; train_kl_reg_loss: 72501.0921; train_edge_recon_loss: 2665123.2290; train_gene_expr_recon_loss: 11192708.1756; train_masked_gp_l1_reg_loss: 82203.1876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97297.3010; train_chrom_access_recon_loss: 5636909.9656; train_global_loss: 19746742.9313; train_optim_loss: 19746742.9313; val_kl_reg_loss: 75910.0844; val_edge_recon_loss: 2668548.6167; val_gene_expr_recon_loss: 11303713.0667; val_masked_gp_l1_reg_loss: 82448.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98230.6094; val_chrom_access_recon_loss: 5753144.9667; val_global_loss: 19981995.7333; val_optim_loss: 19981995.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9863; val_auprc_score: 0.9790; val_best_acc_score: 0.9506; val_best_f1_score: 0.9515; train_kl_reg_loss: 73201.7954; train_edge_recon_loss: 2660236.1298; train_gene_expr_recon_loss: 11192034.7176; train_masked_gp_l1_reg_loss: 82106.5938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97517.5772; train_chrom_access_recon_loss: 5638203.8855; train_global_loss: 19743300.7634; train_optim_loss: 19743300.7634; val_kl_reg_loss: 73775.9984; val_edge_recon_loss: 2679679.8667; val_gene_expr_recon_loss: 11272591.1333; val_masked_gp_l1_reg_loss: 81987.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98090.6953; val_chrom_access_recon_loss: 5782115.4667; val_global_loss: 19988241.3333; val_optim_loss: 19988241.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9864; val_auprc_score: 0.9807; val_best_acc_score: 0.9551; val_best_f1_score: 0.9560; train_kl_reg_loss: 72941.9841; train_edge_recon_loss: 2665096.4752; train_gene_expr_recon_loss: 11195165.6260; train_masked_gp_l1_reg_loss: 81709.7200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97751.3529; train_chrom_access_recon_loss: 5632826.1947; train_global_loss: 19745491.4504; train_optim_loss: 19745491.4504; val_kl_reg_loss: 71378.7589; val_edge_recon_loss: 2675975.5333; val_gene_expr_recon_loss: 11269843.1333; val_masked_gp_l1_reg_loss: 81327.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97614.2031; val_chrom_access_recon_loss: 5769649.8333; val_global_loss: 19965788.2667; val_optim_loss: 19965788.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9843; val_auprc_score: 0.9775; val_best_acc_score: 0.9558; val_best_f1_score: 0.9567; train_kl_reg_loss: 73635.2901; train_edge_recon_loss: 2659889.7863; train_gene_expr_recon_loss: 11168679.6794; train_masked_gp_l1_reg_loss: 79921.4777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73804.9030; train_chrom_access_recon_loss: 5607985.3282; train_global_loss: 19663916.4427; train_optim_loss: 19663916.4427; val_kl_reg_loss: 75932.1151; val_edge_recon_loss: 2668646.2500; val_gene_expr_recon_loss: 11288757.3333; val_masked_gp_l1_reg_loss: 79560.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70559.6328; val_chrom_access_recon_loss: 5750847.8333; val_global_loss: 19934303.7333; val_optim_loss: 19934303.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9898; val_auprc_score: 0.9876; val_best_acc_score: 0.9601; val_best_f1_score: 0.9608; train_kl_reg_loss: 75957.3154; train_edge_recon_loss: 2658263.7233; train_gene_expr_recon_loss: 11167942.9618; train_masked_gp_l1_reg_loss: 79479.5358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70089.9484; train_chrom_access_recon_loss: 5611001.5496; train_global_loss: 19662734.9313; train_optim_loss: 19662734.9313; val_kl_reg_loss: 77423.4635; val_edge_recon_loss: 2656273.9667; val_gene_expr_recon_loss: 11275136.6667; val_masked_gp_l1_reg_loss: 79425.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69605.7891; val_chrom_access_recon_loss: 5715621.2667; val_global_loss: 19873486.1333; val_optim_loss: 19873486.1333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9872; val_auprc_score: 0.9836; val_best_acc_score: 0.9557; val_best_f1_score: 0.9565; train_kl_reg_loss: 76739.4780; train_edge_recon_loss: 2655944.0210; train_gene_expr_recon_loss: 11167203.3053; train_masked_gp_l1_reg_loss: 79399.7644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69317.4799; train_chrom_access_recon_loss: 5603737.0611; train_global_loss: 19652341.1450; train_optim_loss: 19652341.1450; val_kl_reg_loss: 76936.6583; val_edge_recon_loss: 2676458.4000; val_gene_expr_recon_loss: 11276075.4000; val_masked_gp_l1_reg_loss: 79324.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69071.4609; val_chrom_access_recon_loss: 5738981.0000; val_global_loss: 19916846.2667; val_optim_loss: 19916846.2667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9877; val_auprc_score: 0.9811; val_best_acc_score: 0.9561; val_best_f1_score: 0.9569; train_kl_reg_loss: 77145.9316; train_edge_recon_loss: 2651757.0553; train_gene_expr_recon_loss: 11158928.3359; train_masked_gp_l1_reg_loss: 79296.1451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68852.1251; train_chrom_access_recon_loss: 5602204.5496; train_global_loss: 19638184.1679; train_optim_loss: 19638184.1679; val_kl_reg_loss: 77937.1984; val_edge_recon_loss: 2670171.2833; val_gene_expr_recon_loss: 11247254.2000; val_masked_gp_l1_reg_loss: 79268.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68594.7422; val_chrom_access_recon_loss: 5718912.5667; val_global_loss: 19862138.0000; val_optim_loss: 19862138.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9878; val_auprc_score: 0.9847; val_best_acc_score: 0.9541; val_best_f1_score: 0.9549; train_kl_reg_loss: 77012.7296; train_edge_recon_loss: 2659731.8187; train_gene_expr_recon_loss: 11164869.6336; train_masked_gp_l1_reg_loss: 79235.0794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68406.3882; train_chrom_access_recon_loss: 5600619.5038; train_global_loss: 19649875.0534; train_optim_loss: 19649875.0534; val_kl_reg_loss: 77272.0245; val_edge_recon_loss: 2677224.8500; val_gene_expr_recon_loss: 11220762.5333; val_masked_gp_l1_reg_loss: 79230.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68218.5391; val_chrom_access_recon_loss: 5721355.1000; val_global_loss: 19844064.5333; val_optim_loss: 19844064.5333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9878; val_auprc_score: 0.9845; val_best_acc_score: 0.9563; val_best_f1_score: 0.9575; train_kl_reg_loss: 76280.7990; train_edge_recon_loss: 2656710.7004; train_gene_expr_recon_loss: 11161947.0611; train_masked_gp_l1_reg_loss: 79201.9256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68011.4519; train_chrom_access_recon_loss: 5597914.2901; train_global_loss: 19640066.1985; train_optim_loss: 19640066.1985; val_kl_reg_loss: 76657.2792; val_edge_recon_loss: 2675971.3167; val_gene_expr_recon_loss: 11204350.8000; val_masked_gp_l1_reg_loss: 79190.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67945.7266; val_chrom_access_recon_loss: 5716004.4333; val_global_loss: 19820120.0000; val_optim_loss: 19820120.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9878; val_auprc_score: 0.9832; val_best_acc_score: 0.9558; val_best_f1_score: 0.9568; train_kl_reg_loss: 76618.2971; train_edge_recon_loss: 2658497.4637; train_gene_expr_recon_loss: 11172113.8015; train_masked_gp_l1_reg_loss: 79168.1067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67706.9007; train_chrom_access_recon_loss: 5601535.2099; train_global_loss: 19655639.8473; train_optim_loss: 19655639.8473; val_kl_reg_loss: 77229.2812; val_edge_recon_loss: 2673832.5000; val_gene_expr_recon_loss: 11289307.2000; val_masked_gp_l1_reg_loss: 79174.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67519.0703; val_chrom_access_recon_loss: 5741296.2333; val_global_loss: 19928359.0667; val_optim_loss: 19928359.0667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9878; val_auprc_score: 0.9826; val_best_acc_score: 0.9554; val_best_f1_score: 0.9567; train_kl_reg_loss: 77001.6758; train_edge_recon_loss: 2655313.1966; train_gene_expr_recon_loss: 11158991.1832; train_masked_gp_l1_reg_loss: 79139.6567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67350.2495; train_chrom_access_recon_loss: 5593413.2252; train_global_loss: 19631209.1756; train_optim_loss: 19631209.1756; val_kl_reg_loss: 78745.2047; val_edge_recon_loss: 2686608.9167; val_gene_expr_recon_loss: 11262391.8667; val_masked_gp_l1_reg_loss: 79101.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67190.8750; val_chrom_access_recon_loss: 5738155.3333; val_global_loss: 19912194.4000; val_optim_loss: 19912194.4000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9885; val_auprc_score: 0.9849; val_best_acc_score: 0.9584; val_best_f1_score: 0.9591; train_kl_reg_loss: 77314.6014; train_edge_recon_loss: 2655397.2901; train_gene_expr_recon_loss: 11157388.1298; train_masked_gp_l1_reg_loss: 79068.1448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66971.2518; train_chrom_access_recon_loss: 5595733.1336; train_global_loss: 19631872.5649; train_optim_loss: 19631872.5649; val_kl_reg_loss: 77883.5292; val_edge_recon_loss: 2671046.3000; val_gene_expr_recon_loss: 11263971.0000; val_masked_gp_l1_reg_loss: 79075.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66802.3750; val_chrom_access_recon_loss: 5745380.1333; val_global_loss: 19904159.0667; val_optim_loss: 19904159.0667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9895; val_auprc_score: 0.9848; val_best_acc_score: 0.9601; val_best_f1_score: 0.9608; train_kl_reg_loss: 76926.3229; train_edge_recon_loss: 2655968.7538; train_gene_expr_recon_loss: 11162816.7710; train_masked_gp_l1_reg_loss: 79050.6381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66667.3563; train_chrom_access_recon_loss: 5594914.7481; train_global_loss: 19636344.4885; train_optim_loss: 19636344.4885; val_kl_reg_loss: 78483.0432; val_edge_recon_loss: 2665304.3000; val_gene_expr_recon_loss: 11304447.0667; val_masked_gp_l1_reg_loss: 79017.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66544.9844; val_chrom_access_recon_loss: 5753672.4000; val_global_loss: 19947468.4000; val_optim_loss: 19947468.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9898; val_auprc_score: 0.9874; val_best_acc_score: 0.9592; val_best_f1_score: 0.9601; train_kl_reg_loss: 77212.8843; train_edge_recon_loss: 2653425.2538; train_gene_expr_recon_loss: 11156025.6031; train_masked_gp_l1_reg_loss: 78851.7761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64140.4617; train_chrom_access_recon_loss: 5596939.3359; train_global_loss: 19626595.1298; train_optim_loss: 19626595.1298; val_kl_reg_loss: 78125.2063; val_edge_recon_loss: 2656483.5167; val_gene_expr_recon_loss: 11217666.0667; val_masked_gp_l1_reg_loss: 78795.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63772.4688; val_chrom_access_recon_loss: 5717671.1000; val_global_loss: 19812514.0000; val_optim_loss: 19812514.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9887; val_auprc_score: 0.9838; val_best_acc_score: 0.9590; val_best_f1_score: 0.9597; train_kl_reg_loss: 77256.5028; train_edge_recon_loss: 2651332.7882; train_gene_expr_recon_loss: 11156423.7939; train_masked_gp_l1_reg_loss: 78780.2297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63672.5353; train_chrom_access_recon_loss: 5590856.1985; train_global_loss: 19618322.1374; train_optim_loss: 19618322.1374; val_kl_reg_loss: 78510.0365; val_edge_recon_loss: 2660163.4333; val_gene_expr_recon_loss: 11299653.6000; val_masked_gp_l1_reg_loss: 78771.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63607.6016; val_chrom_access_recon_loss: 5741021.7000; val_global_loss: 19921727.8667; val_optim_loss: 19921727.8667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9877; val_auprc_score: 0.9823; val_best_acc_score: 0.9535; val_best_f1_score: 0.9545; train_kl_reg_loss: 77159.2748; train_edge_recon_loss: 2658049.7271; train_gene_expr_recon_loss: 11155506.9008; train_masked_gp_l1_reg_loss: 78765.9676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63556.7168; train_chrom_access_recon_loss: 5594509.2099; train_global_loss: 19627547.8473; train_optim_loss: 19627547.8473; val_kl_reg_loss: 77715.0401; val_edge_recon_loss: 2668655.6167; val_gene_expr_recon_loss: 11261427.3333; val_masked_gp_l1_reg_loss: 78759.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63503.2734; val_chrom_access_recon_loss: 5712898.4667; val_global_loss: 19862959.6000; val_optim_loss: 19862959.6000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9879; val_auprc_score: 0.9835; val_best_acc_score: 0.9580; val_best_f1_score: 0.9587; train_kl_reg_loss: 77251.9258; train_edge_recon_loss: 2653406.2252; train_gene_expr_recon_loss: 11158543.8321; train_masked_gp_l1_reg_loss: 78755.7006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63465.2086; train_chrom_access_recon_loss: 5590243.0229; train_global_loss: 19621665.9847; train_optim_loss: 19621665.9847; val_kl_reg_loss: 78124.2651; val_edge_recon_loss: 2667036.2333; val_gene_expr_recon_loss: 11283885.3333; val_masked_gp_l1_reg_loss: 78752.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63433.1484; val_chrom_access_recon_loss: 5744535.1667; val_global_loss: 19915766.2667; val_optim_loss: 19915766.2667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9877; val_auprc_score: 0.9828; val_best_acc_score: 0.9553; val_best_f1_score: 0.9565; train_kl_reg_loss: 76962.8408; train_edge_recon_loss: 2651489.0916; train_gene_expr_recon_loss: 11155485.2824; train_masked_gp_l1_reg_loss: 78748.2638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63395.1163; train_chrom_access_recon_loss: 5591390.7557; train_global_loss: 19617471.3435; train_optim_loss: 19617471.3435; val_kl_reg_loss: 77994.4708; val_edge_recon_loss: 2657281.6000; val_gene_expr_recon_loss: 11247576.2000; val_masked_gp_l1_reg_loss: 78743.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63358.8945; val_chrom_access_recon_loss: 5709489.7333; val_global_loss: 19834443.7333; val_optim_loss: 19834443.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9888; val_auprc_score: 0.9828; val_best_acc_score: 0.9608; val_best_f1_score: 0.9617; train_kl_reg_loss: 77279.6172; train_edge_recon_loss: 2656685.0878; train_gene_expr_recon_loss: 11158854.0840; train_masked_gp_l1_reg_loss: 78727.3528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63119.1539; train_chrom_access_recon_loss: 5590997.3855; train_global_loss: 19625662.5954; train_optim_loss: 19625662.5954; val_kl_reg_loss: 78351.3448; val_edge_recon_loss: 2648957.5833; val_gene_expr_recon_loss: 11241021.2667; val_masked_gp_l1_reg_loss: 78721.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63084.4688; val_chrom_access_recon_loss: 5722695.4667; val_global_loss: 19832831.0667; val_optim_loss: 19832831.0667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9879; val_auprc_score: 0.9847; val_best_acc_score: 0.9558; val_best_f1_score: 0.9567; train_kl_reg_loss: 77287.1456; train_edge_recon_loss: 2658146.3492; train_gene_expr_recon_loss: 11156956.2290; train_masked_gp_l1_reg_loss: 78720.2770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63075.4545; train_chrom_access_recon_loss: 5592910.8092; train_global_loss: 19627096.0916; train_optim_loss: 19627096.0916; val_kl_reg_loss: 78384.5490; val_edge_recon_loss: 2673451.6167; val_gene_expr_recon_loss: 11284556.5333; val_masked_gp_l1_reg_loss: 78718.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63067.8555; val_chrom_access_recon_loss: 5722983.4333; val_global_loss: 19901163.3333; val_optim_loss: 19901163.3333
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9880; val_auprc_score: 0.9816; val_best_acc_score: 0.9576; val_best_f1_score: 0.9585; train_kl_reg_loss: 77332.6345; train_edge_recon_loss: 2648872.4580; train_gene_expr_recon_loss: 11164706.8092; train_masked_gp_l1_reg_loss: 78718.1046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63060.8423; train_chrom_access_recon_loss: 5595820.4198; train_global_loss: 19628511.2519; train_optim_loss: 19628511.2519; val_kl_reg_loss: 78069.4760; val_edge_recon_loss: 2671923.7833; val_gene_expr_recon_loss: 11280873.3333; val_masked_gp_l1_reg_loss: 78717.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63054.9375; val_chrom_access_recon_loss: 5735167.5000; val_global_loss: 19907806.1333; val_optim_loss: 19907806.1333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9906; val_auprc_score: 0.9880; val_best_acc_score: 0.9607; val_best_f1_score: 0.9612; train_kl_reg_loss: 77180.0084; train_edge_recon_loss: 2652267.7519; train_gene_expr_recon_loss: 11147560.9466; train_masked_gp_l1_reg_loss: 78716.8822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63049.7043; train_chrom_access_recon_loss: 5584968.8244; train_global_loss: 19603744.0458; train_optim_loss: 19603744.0458; val_kl_reg_loss: 78225.5385; val_edge_recon_loss: 2668751.7167; val_gene_expr_recon_loss: 11211273.0667; val_masked_gp_l1_reg_loss: 78716.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63043.6953; val_chrom_access_recon_loss: 5726001.1000; val_global_loss: 19826011.3333; val_optim_loss: 19826011.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 26 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9876
val AUPRC score: 0.9838
val best accuracy score: 0.9568
val best F1 score: 0.9577
val target rna MSE score: 1.2044
val source rna MSE score: 0.4683
val target atac MSE score: 0.3440
val source atac MSE score: 0.0952
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
