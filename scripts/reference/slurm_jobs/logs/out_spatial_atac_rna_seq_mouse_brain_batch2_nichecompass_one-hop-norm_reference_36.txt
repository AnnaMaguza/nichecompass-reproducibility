[True]
Run timestamp: 07082023_181609_36.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_36']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9050; val_auprc_score: 0.9214; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6435.1072; train_edge_recon_loss: 35650.5148; train_gene_expr_recon_loss: 1211456.8333; train_masked_gp_l1_reg_loss: 15694.6181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166689.5625; train_chrom_access_recon_loss: 782202.8542; train_global_loss: 2218129.4861; train_optim_loss: 2218129.4861; val_kl_reg_loss: 5038.0137; val_edge_recon_loss: 40659.3086; val_gene_expr_recon_loss: 1019780.0000; val_masked_gp_l1_reg_loss: 10462.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161751.1250; val_chrom_access_recon_loss: 505958.6875; val_global_loss: 1743649.2500; val_optim_loss: 1743649.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9133; val_auprc_score: 0.9218; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7681.7452; train_edge_recon_loss: 36767.6780; train_gene_expr_recon_loss: 924336.4653; train_masked_gp_l1_reg_loss: 8855.4587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158725.3333; train_chrom_access_recon_loss: 490225.8264; train_global_loss: 1626592.4861; train_optim_loss: 1626592.4861; val_kl_reg_loss: 12533.8652; val_edge_recon_loss: 40661.0117; val_gene_expr_recon_loss: 827647.5000; val_masked_gp_l1_reg_loss: 8052.9302; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154957.2656; val_chrom_access_recon_loss: 476177.0938; val_global_loss: 1520029.6250; val_optim_loss: 1520029.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8949; val_auprc_score: 0.9082; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14115.2205; train_edge_recon_loss: 38053.7522; train_gene_expr_recon_loss: 796974.8681; train_masked_gp_l1_reg_loss: 8617.6833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151607.6042; train_chrom_access_recon_loss: 467540.6215; train_global_loss: 1476909.7083; train_optim_loss: 1476909.7083; val_kl_reg_loss: 13989.0957; val_edge_recon_loss: 40658.8516; val_gene_expr_recon_loss: 769425.0000; val_masked_gp_l1_reg_loss: 9058.4355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147125.5469; val_chrom_access_recon_loss: 458084.2188; val_global_loss: 1438341.1250; val_optim_loss: 1438341.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8824; val_auprc_score: 0.8932; val_best_acc_score: 0.5046; val_best_f1_score: 0.6687; train_kl_reg_loss: 17722.8178; train_edge_recon_loss: 38426.4379; train_gene_expr_recon_loss: 749353.9514; train_masked_gp_l1_reg_loss: 9147.9532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143154.1701; train_chrom_access_recon_loss: 455447.3299; train_global_loss: 1413252.7083; train_optim_loss: 1413252.7083; val_kl_reg_loss: 19112.4180; val_edge_recon_loss: 40656.8711; val_gene_expr_recon_loss: 732842.1875; val_masked_gp_l1_reg_loss: 9256.5381; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137986.2812; val_chrom_access_recon_loss: 452854.7812; val_global_loss: 1392709.1250; val_optim_loss: 1392709.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8939; val_auprc_score: 0.8980; val_best_acc_score: 0.5140; val_best_f1_score: 0.6728; train_kl_reg_loss: 18834.7999; train_edge_recon_loss: 38612.4748; train_gene_expr_recon_loss: 719912.5278; train_masked_gp_l1_reg_loss: 9289.9492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133651.9340; train_chrom_access_recon_loss: 450696.2153; train_global_loss: 1370997.9167; train_optim_loss: 1370997.9167; val_kl_reg_loss: 19195.1914; val_edge_recon_loss: 40650.3086; val_gene_expr_recon_loss: 710596.8750; val_masked_gp_l1_reg_loss: 9335.8887; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128189.6875; val_chrom_access_recon_loss: 448504.8438; val_global_loss: 1356472.7500; val_optim_loss: 1356472.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8864; val_auprc_score: 0.8869; val_best_acc_score: 0.5195; val_best_f1_score: 0.6751; train_kl_reg_loss: 20208.0263; train_edge_recon_loss: 38771.6853; train_gene_expr_recon_loss: 706341.6806; train_masked_gp_l1_reg_loss: 9341.5774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123808.7300; train_chrom_access_recon_loss: 448753.4410; train_global_loss: 1347225.1528; train_optim_loss: 1347225.1528; val_kl_reg_loss: 19270.0352; val_edge_recon_loss: 40642.0039; val_gene_expr_recon_loss: 694229.8750; val_masked_gp_l1_reg_loss: 9307.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118347.8516; val_chrom_access_recon_loss: 445581.8750; val_global_loss: 1327379.0000; val_optim_loss: 1327379.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8689; val_auprc_score: 0.8698; val_best_acc_score: 0.5303; val_best_f1_score: 0.6797; train_kl_reg_loss: 20574.9015; train_edge_recon_loss: 38826.9371; train_gene_expr_recon_loss: 690835.9583; train_masked_gp_l1_reg_loss: 9285.9493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114057.3698; train_chrom_access_recon_loss: 443438.8160; train_global_loss: 1317019.9306; train_optim_loss: 1317019.9306; val_kl_reg_loss: 20994.1074; val_edge_recon_loss: 40635.0430; val_gene_expr_recon_loss: 682194.0000; val_masked_gp_l1_reg_loss: 9250.7705; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108753.7031; val_chrom_access_recon_loss: 443397.2188; val_global_loss: 1305224.7500; val_optim_loss: 1305224.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8652; val_auprc_score: 0.8586; val_best_acc_score: 0.5544; val_best_f1_score: 0.6906; train_kl_reg_loss: 21254.2287; train_edge_recon_loss: 38896.6168; train_gene_expr_recon_loss: 678812.6181; train_masked_gp_l1_reg_loss: 9214.3509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104654.0000; train_chrom_access_recon_loss: 443072.3368; train_global_loss: 1295904.1528; train_optim_loss: 1295904.1528; val_kl_reg_loss: 20823.0117; val_edge_recon_loss: 40621.7812; val_gene_expr_recon_loss: 675020.8750; val_masked_gp_l1_reg_loss: 9165.7598; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99627.0469; val_chrom_access_recon_loss: 441694.1875; val_global_loss: 1286952.7500; val_optim_loss: 1286952.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8608; val_auprc_score: 0.8577; val_best_acc_score: 0.5697; val_best_f1_score: 0.6975; train_kl_reg_loss: 21509.2546; train_edge_recon_loss: 38914.7734; train_gene_expr_recon_loss: 671783.2708; train_masked_gp_l1_reg_loss: 9122.1430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95783.6589; train_chrom_access_recon_loss: 440625.2951; train_global_loss: 1277738.4028; train_optim_loss: 1277738.4028; val_kl_reg_loss: 20433.7480; val_edge_recon_loss: 40612.8281; val_gene_expr_recon_loss: 670309.1875; val_masked_gp_l1_reg_loss: 9068.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91091.7344; val_chrom_access_recon_loss: 440267.0000; val_global_loss: 1271782.8750; val_optim_loss: 1271782.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8601; val_auprc_score: 0.8536; val_best_acc_score: 0.6028; val_best_f1_score: 0.7131; train_kl_reg_loss: 21472.8533; train_edge_recon_loss: 38929.7296; train_gene_expr_recon_loss: 665998.7847; train_masked_gp_l1_reg_loss: 9035.1039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87552.4861; train_chrom_access_recon_loss: 440362.7153; train_global_loss: 1263351.6806; train_optim_loss: 1263351.6806; val_kl_reg_loss: 20900.3281; val_edge_recon_loss: 40596.8086; val_gene_expr_recon_loss: 665332.7500; val_masked_gp_l1_reg_loss: 8994.0957; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83254.3281; val_chrom_access_recon_loss: 438846.8750; val_global_loss: 1257925.2500; val_optim_loss: 1257925.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8661; val_auprc_score: 0.8623; val_best_acc_score: 0.6268; val_best_f1_score: 0.7243; train_kl_reg_loss: 21666.9136; train_edge_recon_loss: 38950.8576; train_gene_expr_recon_loss: 662499.5278; train_masked_gp_l1_reg_loss: 8971.1348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80042.2491; train_chrom_access_recon_loss: 436014.9583; train_global_loss: 1248145.6389; train_optim_loss: 1248145.6389; val_kl_reg_loss: 20973.1484; val_edge_recon_loss: 40584.0078; val_gene_expr_recon_loss: 661740.2500; val_masked_gp_l1_reg_loss: 8940.0010; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76160.1406; val_chrom_access_recon_loss: 437726.9062; val_global_loss: 1246124.3750; val_optim_loss: 1246124.3750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8723; val_auprc_score: 0.8682; val_best_acc_score: 0.6866; val_best_f1_score: 0.7558; train_kl_reg_loss: 21571.7719; train_edge_recon_loss: 38942.8911; train_gene_expr_recon_loss: 661157.5556; train_masked_gp_l1_reg_loss: 8925.4106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73290.8420; train_chrom_access_recon_loss: 439085.9479; train_global_loss: 1242974.4167; train_optim_loss: 1242974.4167; val_kl_reg_loss: 20638.3828; val_edge_recon_loss: 40550.6445; val_gene_expr_recon_loss: 659005.8750; val_masked_gp_l1_reg_loss: 8897.8965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69822.8594; val_chrom_access_recon_loss: 436593.1250; val_global_loss: 1235508.7500; val_optim_loss: 1235508.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8773; val_auprc_score: 0.8728; val_best_acc_score: 0.7264; val_best_f1_score: 0.7764; train_kl_reg_loss: 21288.8924; train_edge_recon_loss: 38902.5360; train_gene_expr_recon_loss: 660884.0278; train_masked_gp_l1_reg_loss: 8884.6625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67254.0894; train_chrom_access_recon_loss: 439180.7465; train_global_loss: 1236394.9722; train_optim_loss: 1236394.9722; val_kl_reg_loss: 20315.1914; val_edge_recon_loss: 40513.1328; val_gene_expr_recon_loss: 656639.0000; val_masked_gp_l1_reg_loss: 8866.7549; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64157.9727; val_chrom_access_recon_loss: 435548.5938; val_global_loss: 1226040.6250; val_optim_loss: 1226040.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8854; val_auprc_score: 0.8833; val_best_acc_score: 0.7626; val_best_f1_score: 0.7959; train_kl_reg_loss: 21122.2179; train_edge_recon_loss: 38887.4614; train_gene_expr_recon_loss: 653005.2222; train_masked_gp_l1_reg_loss: 8857.0883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61867.3086; train_chrom_access_recon_loss: 435358.7674; train_global_loss: 1219098.0972; train_optim_loss: 1219098.0972; val_kl_reg_loss: 20262.7422; val_edge_recon_loss: 40468.2188; val_gene_expr_recon_loss: 654072.3750; val_masked_gp_l1_reg_loss: 8838.5957; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59095.6602; val_chrom_access_recon_loss: 434734.3750; val_global_loss: 1217472.0000; val_optim_loss: 1217472.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8937; val_auprc_score: 0.8850; val_best_acc_score: 0.8058; val_best_f1_score: 0.8210; train_kl_reg_loss: 20670.1957; train_edge_recon_loss: 38820.0668; train_gene_expr_recon_loss: 657068.9444; train_masked_gp_l1_reg_loss: 8829.3735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57037.8181; train_chrom_access_recon_loss: 436929.2118; train_global_loss: 1219355.6111; train_optim_loss: 1219355.6111; val_kl_reg_loss: 19477.2109; val_edge_recon_loss: 40387.0273; val_gene_expr_recon_loss: 653090.5000; val_masked_gp_l1_reg_loss: 8819.7490; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54552.2422; val_chrom_access_recon_loss: 434125.7812; val_global_loss: 1210452.5000; val_optim_loss: 1210452.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8950; val_auprc_score: 0.8860; val_best_acc_score: 0.8124; val_best_f1_score: 0.8204; train_kl_reg_loss: 20579.7216; train_edge_recon_loss: 38773.2856; train_gene_expr_recon_loss: 652607.1597; train_masked_gp_l1_reg_loss: 8817.7985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52713.5291; train_chrom_access_recon_loss: 434908.4792; train_global_loss: 1208399.9861; train_optim_loss: 1208399.9861; val_kl_reg_loss: 18509.4102; val_edge_recon_loss: 40298.4688; val_gene_expr_recon_loss: 653306.3750; val_masked_gp_l1_reg_loss: 8807.1396; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50479.9141; val_chrom_access_recon_loss: 433330.8125; val_global_loss: 1204732.1250; val_optim_loss: 1204732.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8977; val_auprc_score: 0.8900; val_best_acc_score: 0.8191; val_best_f1_score: 0.8249; train_kl_reg_loss: 20196.9219; train_edge_recon_loss: 38713.1115; train_gene_expr_recon_loss: 653469.9028; train_masked_gp_l1_reg_loss: 8808.1699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48839.5069; train_chrom_access_recon_loss: 433958.8715; train_global_loss: 1203986.5000; train_optim_loss: 1203986.5000; val_kl_reg_loss: 18879.6875; val_edge_recon_loss: 40280.3711; val_gene_expr_recon_loss: 649639.1250; val_masked_gp_l1_reg_loss: 8802.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46840.6680; val_chrom_access_recon_loss: 432451.4688; val_global_loss: 1196893.6250; val_optim_loss: 1196893.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9039; val_auprc_score: 0.8939; val_best_acc_score: 0.8294; val_best_f1_score: 0.8296; train_kl_reg_loss: 19892.8362; train_edge_recon_loss: 38652.6589; train_gene_expr_recon_loss: 649481.4653; train_masked_gp_l1_reg_loss: 8802.5579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45355.2231; train_chrom_access_recon_loss: 431640.4271; train_global_loss: 1193825.1667; train_optim_loss: 1193825.1667; val_kl_reg_loss: 18846.6523; val_edge_recon_loss: 40218.6289; val_gene_expr_recon_loss: 647703.2500; val_masked_gp_l1_reg_loss: 8800.3623; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43543.4336; val_chrom_access_recon_loss: 431749.9062; val_global_loss: 1190862.2500; val_optim_loss: 1190862.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9101; val_auprc_score: 0.9034; val_best_acc_score: 0.8328; val_best_f1_score: 0.8292; train_kl_reg_loss: 19679.6207; train_edge_recon_loss: 38600.2656; train_gene_expr_recon_loss: 646523.2083; train_masked_gp_l1_reg_loss: 8800.5232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42198.8811; train_chrom_access_recon_loss: 429802.8924; train_global_loss: 1185605.3750; train_optim_loss: 1185605.3750; val_kl_reg_loss: 18618.3047; val_edge_recon_loss: 40158.6367; val_gene_expr_recon_loss: 646238.5000; val_masked_gp_l1_reg_loss: 8800.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40554.7891; val_chrom_access_recon_loss: 431096.0938; val_global_loss: 1185466.7500; val_optim_loss: 1185466.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9235; val_auprc_score: 0.9142; val_best_acc_score: 0.8425; val_best_f1_score: 0.8351; train_kl_reg_loss: 19376.5714; train_edge_recon_loss: 38550.0399; train_gene_expr_recon_loss: 643648.9028; train_masked_gp_l1_reg_loss: 8798.3556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39334.7474; train_chrom_access_recon_loss: 430061.7535; train_global_loss: 1179770.3611; train_optim_loss: 1179770.3611; val_kl_reg_loss: 18575.5469; val_edge_recon_loss: 40086.7656; val_gene_expr_recon_loss: 644713.5625; val_masked_gp_l1_reg_loss: 8791.7393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37844.0664; val_chrom_access_recon_loss: 430450.8438; val_global_loss: 1180462.5000; val_optim_loss: 1180462.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9246; val_auprc_score: 0.9113; val_best_acc_score: 0.8378; val_best_f1_score: 0.8278; train_kl_reg_loss: 19226.1997; train_edge_recon_loss: 38485.4431; train_gene_expr_recon_loss: 644827.5764; train_masked_gp_l1_reg_loss: 8788.7314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36734.1771; train_chrom_access_recon_loss: 432499.8264; train_global_loss: 1180561.9583; train_optim_loss: 1180561.9583; val_kl_reg_loss: 18477.0547; val_edge_recon_loss: 40014.7578; val_gene_expr_recon_loss: 643283.8750; val_masked_gp_l1_reg_loss: 8789.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35383.2227; val_chrom_access_recon_loss: 429685.3438; val_global_loss: 1175634.2500; val_optim_loss: 1175634.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9258; val_auprc_score: 0.9122; val_best_acc_score: 0.8317; val_best_f1_score: 0.8188; train_kl_reg_loss: 18952.7444; train_edge_recon_loss: 38403.6992; train_gene_expr_recon_loss: 640442.2639; train_masked_gp_l1_reg_loss: 8795.9813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34379.6042; train_chrom_access_recon_loss: 428534.0312; train_global_loss: 1169508.3333; train_optim_loss: 1169508.3333; val_kl_reg_loss: 18088.5664; val_edge_recon_loss: 39926.1680; val_gene_expr_recon_loss: 642291.7500; val_masked_gp_l1_reg_loss: 8794.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33147.4023; val_chrom_access_recon_loss: 429074.4062; val_global_loss: 1171322.5000; val_optim_loss: 1171322.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9359; val_auprc_score: 0.9255; val_best_acc_score: 0.8320; val_best_f1_score: 0.8263; train_kl_reg_loss: 18748.8051; train_edge_recon_loss: 38328.7161; train_gene_expr_recon_loss: 643096.6181; train_masked_gp_l1_reg_loss: 8798.4844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32229.3275; train_chrom_access_recon_loss: 429985.3333; train_global_loss: 1171187.2917; train_optim_loss: 1171187.2917; val_kl_reg_loss: 17853.4570; val_edge_recon_loss: 39813.0742; val_gene_expr_recon_loss: 641277.4375; val_masked_gp_l1_reg_loss: 8795.5088; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31107.3086; val_chrom_access_recon_loss: 428426.8125; val_global_loss: 1167273.6250; val_optim_loss: 1167273.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9358; val_auprc_score: 0.9266; val_best_acc_score: 0.8259; val_best_f1_score: 0.8368; train_kl_reg_loss: 18534.5113; train_edge_recon_loss: 38260.7873; train_gene_expr_recon_loss: 638557.2292; train_masked_gp_l1_reg_loss: 8793.2126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30274.0428; train_chrom_access_recon_loss: 426861.5833; train_global_loss: 1161281.3750; train_optim_loss: 1161281.3750; val_kl_reg_loss: 17706.7734; val_edge_recon_loss: 39759.8477; val_gene_expr_recon_loss: 640229.1875; val_masked_gp_l1_reg_loss: 8792.4131; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29248.2305; val_chrom_access_recon_loss: 428027.8438; val_global_loss: 1163764.3750; val_optim_loss: 1163764.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9441; val_auprc_score: 0.9382; val_best_acc_score: 0.8267; val_best_f1_score: 0.8456; train_kl_reg_loss: 18422.1838; train_edge_recon_loss: 38202.8368; train_gene_expr_recon_loss: 636791.5278; train_masked_gp_l1_reg_loss: 8795.5105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28479.9885; train_chrom_access_recon_loss: 427225.2118; train_global_loss: 1157917.2639; train_optim_loss: 1157917.2639; val_kl_reg_loss: 17474.0039; val_edge_recon_loss: 39683.0430; val_gene_expr_recon_loss: 639311.7500; val_masked_gp_l1_reg_loss: 8798.2412; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27542.8086; val_chrom_access_recon_loss: 427113.3438; val_global_loss: 1159923.2500; val_optim_loss: 1159923.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9369; val_auprc_score: 0.9289; val_best_acc_score: 0.8495; val_best_f1_score: 0.8412; train_kl_reg_loss: 14519.0614; train_edge_recon_loss: 39347.0091; train_gene_expr_recon_loss: 961662.6458; train_masked_gp_l1_reg_loss: 9022.8441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26705.5699; train_chrom_access_recon_loss: 452925.2465; train_global_loss: 1504182.3750; train_optim_loss: 1504182.3750; val_kl_reg_loss: 11447.9355; val_edge_recon_loss: 39953.9258; val_gene_expr_recon_loss: 955687.8750; val_masked_gp_l1_reg_loss: 9459.4189; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25564.5742; val_chrom_access_recon_loss: 450908.6562; val_global_loss: 1493022.3750; val_optim_loss: 1493022.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9384; val_auprc_score: 0.9308; val_best_acc_score: 0.8538; val_best_f1_score: 0.8466; train_kl_reg_loss: 13310.5324; train_edge_recon_loss: 39462.3950; train_gene_expr_recon_loss: 953174.7500; train_masked_gp_l1_reg_loss: 9856.8371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24630.9347; train_chrom_access_recon_loss: 451389.8194; train_global_loss: 1491825.2639; train_optim_loss: 1491825.2639; val_kl_reg_loss: 11604.0762; val_edge_recon_loss: 40013.3867; val_gene_expr_recon_loss: 948062.0000; val_masked_gp_l1_reg_loss: 10314.7051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23491.6211; val_chrom_access_recon_loss: 450128.6562; val_global_loss: 1483614.3750; val_optim_loss: 1483614.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9363; val_auprc_score: 0.9278; val_best_acc_score: 0.8432; val_best_f1_score: 0.8342; train_kl_reg_loss: 13545.3966; train_edge_recon_loss: 39481.5408; train_gene_expr_recon_loss: 947360.6875; train_masked_gp_l1_reg_loss: 10616.1360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22642.6938; train_chrom_access_recon_loss: 449003.0312; train_global_loss: 1482649.5000; train_optim_loss: 1482649.5000; val_kl_reg_loss: 11885.7852; val_edge_recon_loss: 39901.1758; val_gene_expr_recon_loss: 941660.9375; val_masked_gp_l1_reg_loss: 10921.6221; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21622.0293; val_chrom_access_recon_loss: 449145.4062; val_global_loss: 1475136.8750; val_optim_loss: 1475136.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9421; val_auprc_score: 0.9341; val_best_acc_score: 0.8413; val_best_f1_score: 0.8380; train_kl_reg_loss: 13649.7279; train_edge_recon_loss: 39344.2461; train_gene_expr_recon_loss: 943443.7639; train_masked_gp_l1_reg_loss: 11120.4834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20869.9223; train_chrom_access_recon_loss: 450186.3854; train_global_loss: 1478614.5139; train_optim_loss: 1478614.5139; val_kl_reg_loss: 12568.5273; val_edge_recon_loss: 39754.8633; val_gene_expr_recon_loss: 936237.5000; val_masked_gp_l1_reg_loss: 11333.3652; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19965.6797; val_chrom_access_recon_loss: 448561.7812; val_global_loss: 1468421.7500; val_optim_loss: 1468421.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9436; val_auprc_score: 0.9370; val_best_acc_score: 0.8452; val_best_f1_score: 0.8361; train_kl_reg_loss: 13722.0326; train_edge_recon_loss: 39277.7843; train_gene_expr_recon_loss: 937107.3611; train_masked_gp_l1_reg_loss: 11268.0224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19801.7465; train_chrom_access_recon_loss: 449553.6285; train_global_loss: 1470730.5972; train_optim_loss: 1470730.5972; val_kl_reg_loss: 12842.5762; val_edge_recon_loss: 39767.4023; val_gene_expr_recon_loss: 935543.1875; val_masked_gp_l1_reg_loss: 11215.4277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19625.0293; val_chrom_access_recon_loss: 448477.4062; val_global_loss: 1467471.0000; val_optim_loss: 1467471.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9445; val_auprc_score: 0.9332; val_best_acc_score: 0.8455; val_best_f1_score: 0.8363; train_kl_reg_loss: 13921.0610; train_edge_recon_loss: 39293.5443; train_gene_expr_recon_loss: 936344.3681; train_masked_gp_l1_reg_loss: 11205.6249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19526.7914; train_chrom_access_recon_loss: 447876.4444; train_global_loss: 1468167.7917; train_optim_loss: 1468167.7917; val_kl_reg_loss: 12848.2910; val_edge_recon_loss: 39753.3555; val_gene_expr_recon_loss: 935157.6250; val_masked_gp_l1_reg_loss: 11186.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19398.2129; val_chrom_access_recon_loss: 448399.8125; val_global_loss: 1466743.8750; val_optim_loss: 1466743.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9419; val_auprc_score: 0.9329; val_best_acc_score: 0.8397; val_best_f1_score: 0.8381; train_kl_reg_loss: 13810.8979; train_edge_recon_loss: 39272.1163; train_gene_expr_recon_loss: 933836.8333; train_masked_gp_l1_reg_loss: 11179.1119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19307.4225; train_chrom_access_recon_loss: 448278.8368; train_global_loss: 1465685.2361; train_optim_loss: 1465685.2361; val_kl_reg_loss: 12796.5879; val_edge_recon_loss: 39740.4570; val_gene_expr_recon_loss: 934768.6250; val_masked_gp_l1_reg_loss: 11171.8613; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19197.1875; val_chrom_access_recon_loss: 448285.9375; val_global_loss: 1465960.7500; val_optim_loss: 1465960.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9402; val_auprc_score: 0.9305; val_best_acc_score: 0.8395; val_best_f1_score: 0.8413; train_kl_reg_loss: 13857.8557; train_edge_recon_loss: 39267.5768; train_gene_expr_recon_loss: 938632.3958; train_masked_gp_l1_reg_loss: 11170.0423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19114.1352; train_chrom_access_recon_loss: 448668.9931; train_global_loss: 1470710.9861; train_optim_loss: 1470710.9861; val_kl_reg_loss: 12849.3613; val_edge_recon_loss: 39742.1797; val_gene_expr_recon_loss: 934389.8750; val_masked_gp_l1_reg_loss: 11169.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19015.2656; val_chrom_access_recon_loss: 448223.0938; val_global_loss: 1465389.3750; val_optim_loss: 1465389.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9464
val AUPRC score: 0.9401
val best accuracy score: 0.8618
val best F1 score: 0.8559
val target rna MSE score: 3.7169
val source rna MSE score: 3.1640
val target atac MSE score: 0.1363
val source atac MSE score: 0.0192
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
