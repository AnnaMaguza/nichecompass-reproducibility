[True]
Run timestamp: 09102023_210617_36.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_36']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6729; val_auprc_score: 0.6483; val_best_acc_score: 0.5113; val_best_f1_score: 0.6714; train_kl_reg_loss: 44037.8561; train_edge_recon_loss: 3505767.2462; train_gene_expr_recon_loss: 13982951.2576; train_masked_gp_l1_reg_loss: 88429.6547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3020129.9148; train_chrom_access_recon_loss: 1001889.2500; train_global_loss: 21643205.2424; train_optim_loss: 21643205.2424; val_kl_reg_loss: 89231.4736; val_edge_recon_loss: 4064526.0625; val_gene_expr_recon_loss: 13166287.2500; val_masked_gp_l1_reg_loss: 75441.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1718389.5000; val_chrom_access_recon_loss: 950884.5781; val_global_loss: 20064761.5000; val_optim_loss: 20064761.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6988; val_auprc_score: 0.6870; val_best_acc_score: 0.6163; val_best_f1_score: 0.7029; train_kl_reg_loss: 87379.6322; train_edge_recon_loss: 3516162.2311; train_gene_expr_recon_loss: 12803878.0303; train_masked_gp_l1_reg_loss: 73034.9672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 950397.9460; train_chrom_access_recon_loss: 951728.5360; train_global_loss: 18382581.3636; train_optim_loss: 18382581.3636; val_kl_reg_loss: 79437.6748; val_edge_recon_loss: 4057574.9375; val_gene_expr_recon_loss: 12951877.7500; val_masked_gp_l1_reg_loss: 73553.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 461326.1875; val_chrom_access_recon_loss: 945060.1875; val_global_loss: 18568830.7500; val_optim_loss: 18568830.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7407; val_auprc_score: 0.7315; val_best_acc_score: 0.6652; val_best_f1_score: 0.7083; train_kl_reg_loss: 81755.2102; train_edge_recon_loss: 3507891.5379; train_gene_expr_recon_loss: 12674968.2576; train_masked_gp_l1_reg_loss: 74847.2461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 304340.0902; train_chrom_access_recon_loss: 945189.5341; train_global_loss: 17588991.7273; train_optim_loss: 17588991.7273; val_kl_reg_loss: 79257.4287; val_edge_recon_loss: 4028040.8125; val_gene_expr_recon_loss: 12733376.2500; val_masked_gp_l1_reg_loss: 76693.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 203318.7344; val_chrom_access_recon_loss: 938905.4141; val_global_loss: 18059591.7500; val_optim_loss: 18059591.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7925; val_auprc_score: 0.7830; val_best_acc_score: 0.7155; val_best_f1_score: 0.7501; train_kl_reg_loss: 68322.2062; train_edge_recon_loss: 3478181.6212; train_gene_expr_recon_loss: 12582344.5000; train_masked_gp_l1_reg_loss: 78215.3389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160081.9183; train_chrom_access_recon_loss: 939372.7301; train_global_loss: 17306518.3030; train_optim_loss: 17306518.3030; val_kl_reg_loss: 47192.7676; val_edge_recon_loss: 3645042.8438; val_gene_expr_recon_loss: 12822668.7500; val_masked_gp_l1_reg_loss: 80326.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127954.0625; val_chrom_access_recon_loss: 929857.3438; val_global_loss: 17653042.7500; val_optim_loss: 17653042.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8071; val_auprc_score: 0.7957; val_best_acc_score: 0.7222; val_best_f1_score: 0.7472; train_kl_reg_loss: 61615.5850; train_edge_recon_loss: 3190412.7500; train_gene_expr_recon_loss: 12545789.4848; train_masked_gp_l1_reg_loss: 83634.6964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112310.9749; train_chrom_access_recon_loss: 936111.1657; train_global_loss: 16929874.6667; train_optim_loss: 16929874.6667; val_kl_reg_loss: 67817.4004; val_edge_recon_loss: 3229051.7500; val_gene_expr_recon_loss: 12633532.3750; val_masked_gp_l1_reg_loss: 90168.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102281.8984; val_chrom_access_recon_loss: 926498.7266; val_global_loss: 17049350.3750; val_optim_loss: 17049350.3750
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8640; val_auprc_score: 0.8295; val_best_acc_score: 0.7966; val_best_f1_score: 0.8148; train_kl_reg_loss: 77779.5276; train_edge_recon_loss: 2971569.5644; train_gene_expr_recon_loss: 12494584.2121; train_masked_gp_l1_reg_loss: 95992.8326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95663.2288; train_chrom_access_recon_loss: 930593.3759; train_global_loss: 16666182.6818; train_optim_loss: 16666182.6818; val_kl_reg_loss: 80637.9316; val_edge_recon_loss: 3006785.1562; val_gene_expr_recon_loss: 12620458.8750; val_masked_gp_l1_reg_loss: 98198.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90556.8438; val_chrom_access_recon_loss: 927899.3203; val_global_loss: 16824536.3750; val_optim_loss: 16824536.3750
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8890; val_auprc_score: 0.8596; val_best_acc_score: 0.8189; val_best_f1_score: 0.8330; train_kl_reg_loss: 88974.4130; train_edge_recon_loss: 2854649.0379; train_gene_expr_recon_loss: 12385623.7727; train_masked_gp_l1_reg_loss: 99316.3388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87244.5122; train_chrom_access_recon_loss: 925215.7244; train_global_loss: 16441023.9091; train_optim_loss: 16441023.9091; val_kl_reg_loss: 93605.9961; val_edge_recon_loss: 2886280.5312; val_gene_expr_recon_loss: 12480995.3750; val_masked_gp_l1_reg_loss: 100907.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84337.6641; val_chrom_access_recon_loss: 919738.6797; val_global_loss: 16565865.5000; val_optim_loss: 16565865.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9036; val_auprc_score: 0.8778; val_best_acc_score: 0.8418; val_best_f1_score: 0.8506; train_kl_reg_loss: 93023.1757; train_edge_recon_loss: 2820580.7803; train_gene_expr_recon_loss: 12290341.3939; train_masked_gp_l1_reg_loss: 101374.5109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81782.5162; train_chrom_access_recon_loss: 920432.7348; train_global_loss: 16307535.0455; train_optim_loss: 16307535.0455; val_kl_reg_loss: 95998.6992; val_edge_recon_loss: 2842606.4375; val_gene_expr_recon_loss: 12404348.0000; val_masked_gp_l1_reg_loss: 101861.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79065.2031; val_chrom_access_recon_loss: 912174.9531; val_global_loss: 16436055.2500; val_optim_loss: 16436055.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9090; val_auprc_score: 0.8828; val_best_acc_score: 0.8477; val_best_f1_score: 0.8583; train_kl_reg_loss: 95959.9917; train_edge_recon_loss: 2812590.0530; train_gene_expr_recon_loss: 12236431.7273; train_masked_gp_l1_reg_loss: 102015.7892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77404.3427; train_chrom_access_recon_loss: 917700.9413; train_global_loss: 16242102.9242; train_optim_loss: 16242102.9242; val_kl_reg_loss: 93468.2861; val_edge_recon_loss: 2805859.5000; val_gene_expr_recon_loss: 12535939.6250; val_masked_gp_l1_reg_loss: 102145.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75493.3672; val_chrom_access_recon_loss: 923510.1250; val_global_loss: 16536415.7500; val_optim_loss: 16536415.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9035; val_auprc_score: 0.8718; val_best_acc_score: 0.8444; val_best_f1_score: 0.8550; train_kl_reg_loss: 93366.1024; train_edge_recon_loss: 2800670.4659; train_gene_expr_recon_loss: 12190718.6364; train_masked_gp_l1_reg_loss: 102352.1048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73873.1522; train_chrom_access_recon_loss: 913864.3021; train_global_loss: 16174844.6212; train_optim_loss: 16174844.6212; val_kl_reg_loss: 96575.7236; val_edge_recon_loss: 2803972.3438; val_gene_expr_recon_loss: 12424128.0000; val_masked_gp_l1_reg_loss: 102465.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72172.8906; val_chrom_access_recon_loss: 916686.3281; val_global_loss: 16416000.2500; val_optim_loss: 16416000.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8932; val_auprc_score: 0.8549; val_best_acc_score: 0.8345; val_best_f1_score: 0.8474; train_kl_reg_loss: 93053.8913; train_edge_recon_loss: 2787266.0606; train_gene_expr_recon_loss: 12131609.8182; train_masked_gp_l1_reg_loss: 102729.0971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71811.0936; train_chrom_access_recon_loss: 909795.0720; train_global_loss: 16096264.9848; train_optim_loss: 16096264.9848; val_kl_reg_loss: 96387.8594; val_edge_recon_loss: 2867869.6250; val_gene_expr_recon_loss: 12326822.3750; val_masked_gp_l1_reg_loss: 103008.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71550.2656; val_chrom_access_recon_loss: 910903.4766; val_global_loss: 16376542.5000; val_optim_loss: 16376542.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9042; val_auprc_score: 0.8685; val_best_acc_score: 0.8442; val_best_f1_score: 0.8564; train_kl_reg_loss: 93776.7879; train_edge_recon_loss: 2787613.9053; train_gene_expr_recon_loss: 12096611.7576; train_masked_gp_l1_reg_loss: 103306.6816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70426.8524; train_chrom_access_recon_loss: 907639.9555; train_global_loss: 16059375.9091; train_optim_loss: 16059375.9091; val_kl_reg_loss: 92557.8408; val_edge_recon_loss: 2824732.3750; val_gene_expr_recon_loss: 12287153.6250; val_masked_gp_l1_reg_loss: 103565.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69432.6562; val_chrom_access_recon_loss: 901973.1406; val_global_loss: 16279416.1250; val_optim_loss: 16279416.1250
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9088; val_auprc_score: 0.8733; val_best_acc_score: 0.8506; val_best_f1_score: 0.8580; train_kl_reg_loss: 90445.3615; train_edge_recon_loss: 2788741.2424; train_gene_expr_recon_loss: 12041429.2121; train_masked_gp_l1_reg_loss: 103913.5617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69008.4529; train_chrom_access_recon_loss: 903444.9934; train_global_loss: 15996982.8182; train_optim_loss: 15996982.8182; val_kl_reg_loss: 88887.5186; val_edge_recon_loss: 2799979.1875; val_gene_expr_recon_loss: 12203587.7500; val_masked_gp_l1_reg_loss: 104459.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68649.9922; val_chrom_access_recon_loss: 891793.8828; val_global_loss: 16157358.2500; val_optim_loss: 16157358.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9033; val_auprc_score: 0.8704; val_best_acc_score: 0.8439; val_best_f1_score: 0.8530; train_kl_reg_loss: 87143.6336; train_edge_recon_loss: 2777463.0000; train_gene_expr_recon_loss: 12017256.2424; train_masked_gp_l1_reg_loss: 104618.2116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68239.7680; train_chrom_access_recon_loss: 902040.2680; train_global_loss: 15956761.1970; train_optim_loss: 15956761.1970; val_kl_reg_loss: 85810.5098; val_edge_recon_loss: 2859343.8125; val_gene_expr_recon_loss: 12288514.5000; val_masked_gp_l1_reg_loss: 105014.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68444.2969; val_chrom_access_recon_loss: 910792.5547; val_global_loss: 16317919.6250; val_optim_loss: 16317919.6250
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9126; val_auprc_score: 0.8821; val_best_acc_score: 0.8541; val_best_f1_score: 0.8626; train_kl_reg_loss: 86136.8430; train_edge_recon_loss: 2773676.2121; train_gene_expr_recon_loss: 11965482.5758; train_masked_gp_l1_reg_loss: 105268.2502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67421.5623; train_chrom_access_recon_loss: 898205.8930; train_global_loss: 15896191.3636; train_optim_loss: 15896191.3636; val_kl_reg_loss: 88115.9414; val_edge_recon_loss: 2827547.4375; val_gene_expr_recon_loss: 12096952.6250; val_masked_gp_l1_reg_loss: 105411.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66379.6875; val_chrom_access_recon_loss: 890005.6172; val_global_loss: 16074413.6250; val_optim_loss: 16074413.6250
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9228; val_auprc_score: 0.8940; val_best_acc_score: 0.8630; val_best_f1_score: 0.8677; train_kl_reg_loss: 85284.2023; train_edge_recon_loss: 2761911.3447; train_gene_expr_recon_loss: 11943030.4848; train_masked_gp_l1_reg_loss: 105653.4355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66027.3195; train_chrom_access_recon_loss: 896333.2519; train_global_loss: 15858240.1212; train_optim_loss: 15858240.1212; val_kl_reg_loss: 85559.8027; val_edge_recon_loss: 2792011.4062; val_gene_expr_recon_loss: 12043878.2500; val_masked_gp_l1_reg_loss: 106164.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66060.9766; val_chrom_access_recon_loss: 895059.6250; val_global_loss: 15988735.3750; val_optim_loss: 15988735.3750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9161; val_auprc_score: 0.8869; val_best_acc_score: 0.8584; val_best_f1_score: 0.8658; train_kl_reg_loss: 85010.8088; train_edge_recon_loss: 2760068.2727; train_gene_expr_recon_loss: 11895184.7424; train_masked_gp_l1_reg_loss: 106275.3436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65384.3706; train_chrom_access_recon_loss: 893427.0388; train_global_loss: 15805350.7273; train_optim_loss: 15805350.7273; val_kl_reg_loss: 87137.8057; val_edge_recon_loss: 2836260.2812; val_gene_expr_recon_loss: 12218051.3750; val_masked_gp_l1_reg_loss: 106335.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65000.3906; val_chrom_access_recon_loss: 899817.8047; val_global_loss: 16212603.1250; val_optim_loss: 16212603.1250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9249; val_auprc_score: 0.8921; val_best_acc_score: 0.8689; val_best_f1_score: 0.8763; train_kl_reg_loss: 84174.6409; train_edge_recon_loss: 2742311.9962; train_gene_expr_recon_loss: 11864543.5606; train_masked_gp_l1_reg_loss: 106597.4421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64533.2810; train_chrom_access_recon_loss: 891444.2292; train_global_loss: 15753605.1515; train_optim_loss: 15753605.1515; val_kl_reg_loss: 85062.3447; val_edge_recon_loss: 2785340.5312; val_gene_expr_recon_loss: 12043393.6250; val_masked_gp_l1_reg_loss: 107045.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64924.6484; val_chrom_access_recon_loss: 889854.1016; val_global_loss: 15975620.5000; val_optim_loss: 15975620.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9241; val_auprc_score: 0.8958; val_best_acc_score: 0.8667; val_best_f1_score: 0.8737; train_kl_reg_loss: 84272.8569; train_edge_recon_loss: 2753595.9886; train_gene_expr_recon_loss: 11844323.5000; train_masked_gp_l1_reg_loss: 107166.7638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64044.3613; train_chrom_access_recon_loss: 889427.3911; train_global_loss: 15742830.9848; train_optim_loss: 15742830.9848; val_kl_reg_loss: 85027.3887; val_edge_recon_loss: 2761458.8750; val_gene_expr_recon_loss: 11993196.5000; val_masked_gp_l1_reg_loss: 107159.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63231.0078; val_chrom_access_recon_loss: 884307.0703; val_global_loss: 15894380.0000; val_optim_loss: 15894380.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9218; val_auprc_score: 0.8979; val_best_acc_score: 0.8608; val_best_f1_score: 0.8678; train_kl_reg_loss: 81959.7158; train_edge_recon_loss: 2750128.8295; train_gene_expr_recon_loss: 11807652.7576; train_masked_gp_l1_reg_loss: 107535.6989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63112.6793; train_chrom_access_recon_loss: 886122.3286; train_global_loss: 15696512.0152; train_optim_loss: 15696512.0152; val_kl_reg_loss: 83579.1260; val_edge_recon_loss: 2803353.8750; val_gene_expr_recon_loss: 11868472.3750; val_masked_gp_l1_reg_loss: 107839.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63053.3242; val_chrom_access_recon_loss: 884085.8438; val_global_loss: 15810384.2500; val_optim_loss: 15810384.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9233; val_auprc_score: 0.8924; val_best_acc_score: 0.8638; val_best_f1_score: 0.8711; train_kl_reg_loss: 82608.5112; train_edge_recon_loss: 2732392.7083; train_gene_expr_recon_loss: 11786848.7879; train_masked_gp_l1_reg_loss: 107912.3465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62519.6020; train_chrom_access_recon_loss: 884964.1117; train_global_loss: 15657246.2121; train_optim_loss: 15657246.2121; val_kl_reg_loss: 80830.4395; val_edge_recon_loss: 2804248.8750; val_gene_expr_recon_loss: 11900267.2500; val_masked_gp_l1_reg_loss: 108130.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62406.0625; val_chrom_access_recon_loss: 875353.4922; val_global_loss: 15831236.1250; val_optim_loss: 15831236.1250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9364; val_auprc_score: 0.9177; val_best_acc_score: 0.8740; val_best_f1_score: 0.8798; train_kl_reg_loss: 79731.7827; train_edge_recon_loss: 2737363.6023; train_gene_expr_recon_loss: 11762945.1061; train_masked_gp_l1_reg_loss: 108371.1639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62189.9352; train_chrom_access_recon_loss: 883154.0057; train_global_loss: 15633755.6212; train_optim_loss: 15633755.6212; val_kl_reg_loss: 82923.3027; val_edge_recon_loss: 2770035.6562; val_gene_expr_recon_loss: 11985238.8750; val_masked_gp_l1_reg_loss: 108722.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61895.2891; val_chrom_access_recon_loss: 884007.6953; val_global_loss: 15892823.6250; val_optim_loss: 15892823.6250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9401; val_auprc_score: 0.9170; val_best_acc_score: 0.8831; val_best_f1_score: 0.8895; train_kl_reg_loss: 81079.4020; train_edge_recon_loss: 2732345.3561; train_gene_expr_recon_loss: 11737279.7121; train_masked_gp_l1_reg_loss: 108774.8163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61700.8664; train_chrom_access_recon_loss: 880605.2718; train_global_loss: 15601785.4545; train_optim_loss: 15601785.4545; val_kl_reg_loss: 79196.5000; val_edge_recon_loss: 2765181.8125; val_gene_expr_recon_loss: 11809626.2500; val_masked_gp_l1_reg_loss: 108730.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61348.1055; val_chrom_access_recon_loss: 877217.4062; val_global_loss: 15701300.0000; val_optim_loss: 15701300.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9404; val_auprc_score: 0.9158; val_best_acc_score: 0.8872; val_best_f1_score: 0.8932; train_kl_reg_loss: 80695.3896; train_edge_recon_loss: 2725410.3030; train_gene_expr_recon_loss: 11713110.3030; train_masked_gp_l1_reg_loss: 109056.3250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61208.4377; train_chrom_access_recon_loss: 878007.0445; train_global_loss: 15567487.8030; train_optim_loss: 15567487.8030; val_kl_reg_loss: 82364.2959; val_edge_recon_loss: 2728380.2188; val_gene_expr_recon_loss: 11880296.6250; val_masked_gp_l1_reg_loss: 109245.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60998.2344; val_chrom_access_recon_loss: 877325.0312; val_global_loss: 15738610.1250; val_optim_loss: 15738610.1250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9399; val_auprc_score: 0.9176; val_best_acc_score: 0.8834; val_best_f1_score: 0.8876; train_kl_reg_loss: 80729.5879; train_edge_recon_loss: 2713011.8826; train_gene_expr_recon_loss: 11692875.9242; train_masked_gp_l1_reg_loss: 109395.9264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60641.6981; train_chrom_access_recon_loss: 876823.3636; train_global_loss: 15533478.3485; train_optim_loss: 15533478.3485; val_kl_reg_loss: 78827.3379; val_edge_recon_loss: 2766443.5938; val_gene_expr_recon_loss: 11771324.2500; val_masked_gp_l1_reg_loss: 109519.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60561.3320; val_chrom_access_recon_loss: 871518.8281; val_global_loss: 15658195.0000; val_optim_loss: 15658195.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9411; val_auprc_score: 0.9244; val_best_acc_score: 0.8807; val_best_f1_score: 0.8859; train_kl_reg_loss: 79809.1642; train_edge_recon_loss: 2721874.5947; train_gene_expr_recon_loss: 11675563.9545; train_masked_gp_l1_reg_loss: 109651.7286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60343.6257; train_chrom_access_recon_loss: 875888.5473; train_global_loss: 15523131.5758; train_optim_loss: 15523131.5758; val_kl_reg_loss: 81645.5137; val_edge_recon_loss: 2774151.4375; val_gene_expr_recon_loss: 11788021.1250; val_masked_gp_l1_reg_loss: 109844.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60533.7852; val_chrom_access_recon_loss: 870286.8906; val_global_loss: 15684484.0000; val_optim_loss: 15684484.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9459; val_auprc_score: 0.9202; val_best_acc_score: 0.8939; val_best_f1_score: 0.8970; train_kl_reg_loss: 80736.8107; train_edge_recon_loss: 2715545.1402; train_gene_expr_recon_loss: 11664495.9545; train_masked_gp_l1_reg_loss: 109903.7873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60100.7969; train_chrom_access_recon_loss: 873939.8248; train_global_loss: 15504722.3333; train_optim_loss: 15504722.3333; val_kl_reg_loss: 82005.8291; val_edge_recon_loss: 2711878.4375; val_gene_expr_recon_loss: 11927903.7500; val_masked_gp_l1_reg_loss: 110094.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59984.2148; val_chrom_access_recon_loss: 873974.2891; val_global_loss: 15765840.2500; val_optim_loss: 15765840.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9498; val_auprc_score: 0.9350; val_best_acc_score: 0.8920; val_best_f1_score: 0.8954; train_kl_reg_loss: 79589.6809; train_edge_recon_loss: 2716160.7917; train_gene_expr_recon_loss: 11644032.4394; train_masked_gp_l1_reg_loss: 110054.7201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59705.9798; train_chrom_access_recon_loss: 872815.2254; train_global_loss: 15482358.8030; train_optim_loss: 15482358.8030; val_kl_reg_loss: 78563.2861; val_edge_recon_loss: 2767358.0625; val_gene_expr_recon_loss: 11849319.5000; val_masked_gp_l1_reg_loss: 110258.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60112.6836; val_chrom_access_recon_loss: 869279.7812; val_global_loss: 15734891.6250; val_optim_loss: 15734891.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9512; val_auprc_score: 0.9307; val_best_acc_score: 0.8960; val_best_f1_score: 0.8994; train_kl_reg_loss: 78490.5460; train_edge_recon_loss: 2708599.6970; train_gene_expr_recon_loss: 11618009.5909; train_masked_gp_l1_reg_loss: 110270.4762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59622.1445; train_chrom_access_recon_loss: 871626.0028; train_global_loss: 15446618.5152; train_optim_loss: 15446618.5152; val_kl_reg_loss: 79246.8174; val_edge_recon_loss: 2722704.3125; val_gene_expr_recon_loss: 11758444.8750; val_masked_gp_l1_reg_loss: 110569.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59540.4727; val_chrom_access_recon_loss: 874452.4922; val_global_loss: 15604957.2500; val_optim_loss: 15604957.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9479; val_auprc_score: 0.9322; val_best_acc_score: 0.8920; val_best_f1_score: 0.8961; train_kl_reg_loss: 78455.6697; train_edge_recon_loss: 2706583.3144; train_gene_expr_recon_loss: 11597579.1364; train_masked_gp_l1_reg_loss: 110522.1635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59348.3088; train_chrom_access_recon_loss: 869080.2718; train_global_loss: 15421568.8788; train_optim_loss: 15421568.8788; val_kl_reg_loss: 79895.2061; val_edge_recon_loss: 2728138.3438; val_gene_expr_recon_loss: 11736977.0000; val_masked_gp_l1_reg_loss: 110652.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59494.0352; val_chrom_access_recon_loss: 864051.4219; val_global_loss: 15579209.0000; val_optim_loss: 15579209.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9518; val_auprc_score: 0.9324; val_best_acc_score: 0.8987; val_best_f1_score: 0.9028; train_kl_reg_loss: 79714.5207; train_edge_recon_loss: 2705248.4545; train_gene_expr_recon_loss: 11581504.0303; train_masked_gp_l1_reg_loss: 110661.3936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59206.9547; train_chrom_access_recon_loss: 867458.7841; train_global_loss: 15403794.2273; train_optim_loss: 15403794.2273; val_kl_reg_loss: 82371.5176; val_edge_recon_loss: 2729810.1250; val_gene_expr_recon_loss: 11798595.8750; val_masked_gp_l1_reg_loss: 110738.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58941.2383; val_chrom_access_recon_loss: 872254.1875; val_global_loss: 15652710.7500; val_optim_loss: 15652710.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9579; val_auprc_score: 0.9441; val_best_acc_score: 0.9027; val_best_f1_score: 0.9066; train_kl_reg_loss: 79371.0079; train_edge_recon_loss: 2702408.9697; train_gene_expr_recon_loss: 11569515.5152; train_masked_gp_l1_reg_loss: 110674.2315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59045.7939; train_chrom_access_recon_loss: 866857.4688; train_global_loss: 15387872.9697; train_optim_loss: 15387872.9697; val_kl_reg_loss: 80968.1729; val_edge_recon_loss: 2709086.3125; val_gene_expr_recon_loss: 11600413.6250; val_masked_gp_l1_reg_loss: 110832.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58945.9844; val_chrom_access_recon_loss: 860547.9766; val_global_loss: 15420795.1250; val_optim_loss: 15420795.1250
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9531; val_auprc_score: 0.9324; val_best_acc_score: 0.8995; val_best_f1_score: 0.9017; train_kl_reg_loss: 77953.9177; train_edge_recon_loss: 2711900.0189; train_gene_expr_recon_loss: 11575030.5909; train_masked_gp_l1_reg_loss: 110928.5414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58986.7094; train_chrom_access_recon_loss: 867344.2699; train_global_loss: 15402144.1667; train_optim_loss: 15402144.1667; val_kl_reg_loss: 82187.6543; val_edge_recon_loss: 2723306.9688; val_gene_expr_recon_loss: 11766650.7500; val_masked_gp_l1_reg_loss: 111034.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59040.1875; val_chrom_access_recon_loss: 859715.2891; val_global_loss: 15601935.5000; val_optim_loss: 15601935.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9519; val_auprc_score: 0.9363; val_best_acc_score: 0.8952; val_best_f1_score: 0.8988; train_kl_reg_loss: 79157.8439; train_edge_recon_loss: 2693769.3258; train_gene_expr_recon_loss: 11548434.0000; train_masked_gp_l1_reg_loss: 111020.5168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58966.6314; train_chrom_access_recon_loss: 864894.5938; train_global_loss: 15356243.0758; train_optim_loss: 15356243.0758; val_kl_reg_loss: 82867.0811; val_edge_recon_loss: 2727612.3438; val_gene_expr_recon_loss: 11678299.3750; val_masked_gp_l1_reg_loss: 111050.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58840.9531; val_chrom_access_recon_loss: 856655.0938; val_global_loss: 15515326.0000; val_optim_loss: 15515326.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9530; val_auprc_score: 0.9378; val_best_acc_score: 0.8990; val_best_f1_score: 0.9045; train_kl_reg_loss: 79047.2363; train_edge_recon_loss: 2691533.0076; train_gene_expr_recon_loss: 11537383.1061; train_masked_gp_l1_reg_loss: 111039.6229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58797.3492; train_chrom_access_recon_loss: 864522.1449; train_global_loss: 15342322.2727; train_optim_loss: 15342322.2727; val_kl_reg_loss: 78725.0518; val_edge_recon_loss: 2714173.2500; val_gene_expr_recon_loss: 11718492.1250; val_masked_gp_l1_reg_loss: 111105.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58918.6836; val_chrom_access_recon_loss: 862992.3281; val_global_loss: 15544406.7500; val_optim_loss: 15544406.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9567; val_auprc_score: 0.9403; val_best_acc_score: 0.9073; val_best_f1_score: 0.9107; train_kl_reg_loss: 77682.9558; train_edge_recon_loss: 2691823.8333; train_gene_expr_recon_loss: 11516927.7879; train_masked_gp_l1_reg_loss: 111186.3722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58977.8640; train_chrom_access_recon_loss: 862352.1203; train_global_loss: 15318950.8636; train_optim_loss: 15318950.8636; val_kl_reg_loss: 75557.5596; val_edge_recon_loss: 2742318.7812; val_gene_expr_recon_loss: 11721235.6250; val_masked_gp_l1_reg_loss: 111187.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58860.0781; val_chrom_access_recon_loss: 857916.6484; val_global_loss: 15567076.6250; val_optim_loss: 15567076.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9558; val_auprc_score: 0.9413; val_best_acc_score: 0.9022; val_best_f1_score: 0.9068; train_kl_reg_loss: 76722.3635; train_edge_recon_loss: 2689336.8485; train_gene_expr_recon_loss: 11508646.0606; train_masked_gp_l1_reg_loss: 108285.2335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47982.1378; train_chrom_access_recon_loss: 861604.4612; train_global_loss: 15292577.1364; train_optim_loss: 15292577.1364; val_kl_reg_loss: 80110.4551; val_edge_recon_loss: 2742240.8438; val_gene_expr_recon_loss: 11722335.6250; val_masked_gp_l1_reg_loss: 107189.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45131.6289; val_chrom_access_recon_loss: 857861.8672; val_global_loss: 15554870.8750; val_optim_loss: 15554870.8750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9534; val_auprc_score: 0.9318; val_best_acc_score: 0.9046; val_best_f1_score: 0.9088; train_kl_reg_loss: 78708.9600; train_edge_recon_loss: 2693480.8409; train_gene_expr_recon_loss: 11505689.7424; train_masked_gp_l1_reg_loss: 106996.1948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44764.3728; train_chrom_access_recon_loss: 860113.2756; train_global_loss: 15289753.3636; train_optim_loss: 15289753.3636; val_kl_reg_loss: 79259.3525; val_edge_recon_loss: 2705916.3125; val_gene_expr_recon_loss: 11620543.8750; val_masked_gp_l1_reg_loss: 106894.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44477.1250; val_chrom_access_recon_loss: 852256.1016; val_global_loss: 15409347.8750; val_optim_loss: 15409347.8750
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9515; val_auprc_score: 0.9321; val_best_acc_score: 0.9009; val_best_f1_score: 0.9056; train_kl_reg_loss: 79776.8284; train_edge_recon_loss: 2691794.4659; train_gene_expr_recon_loss: 11500661.9091; train_masked_gp_l1_reg_loss: 106841.7938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44277.2031; train_chrom_access_recon_loss: 860134.5606; train_global_loss: 15283486.6515; train_optim_loss: 15283486.6515; val_kl_reg_loss: 81093.2646; val_edge_recon_loss: 2704755.2500; val_gene_expr_recon_loss: 11588170.0000; val_masked_gp_l1_reg_loss: 106824.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44180.8047; val_chrom_access_recon_loss: 854367.9375; val_global_loss: 15379391.5000; val_optim_loss: 15379391.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9542; val_auprc_score: 0.9361; val_best_acc_score: 0.9025; val_best_f1_score: 0.9071; train_kl_reg_loss: 79924.6006; train_edge_recon_loss: 2696422.5606; train_gene_expr_recon_loss: 11483602.9545; train_masked_gp_l1_reg_loss: 106791.0160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44056.2497; train_chrom_access_recon_loss: 859038.6278; train_global_loss: 15269836.0455; train_optim_loss: 15269836.0455; val_kl_reg_loss: 80997.3291; val_edge_recon_loss: 2722576.7188; val_gene_expr_recon_loss: 11652728.2500; val_masked_gp_l1_reg_loss: 106775.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43978.8906; val_chrom_access_recon_loss: 859920.0703; val_global_loss: 15466977.2500; val_optim_loss: 15466977.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9569; val_auprc_score: 0.9428; val_best_acc_score: 0.9057; val_best_f1_score: 0.9097; train_kl_reg_loss: 79918.9440; train_edge_recon_loss: 2684668.2841; train_gene_expr_recon_loss: 11487060.7273; train_masked_gp_l1_reg_loss: 106767.1819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43899.9779; train_chrom_access_recon_loss: 859279.7670; train_global_loss: 15261594.8182; train_optim_loss: 15261594.8182; val_kl_reg_loss: 81076.0957; val_edge_recon_loss: 2728085.1562; val_gene_expr_recon_loss: 11713191.5000; val_masked_gp_l1_reg_loss: 106762.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43798.6523; val_chrom_access_recon_loss: 858840.8281; val_global_loss: 15531755.6250; val_optim_loss: 15531755.6250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9518; val_auprc_score: 0.9285; val_best_acc_score: 0.9009; val_best_f1_score: 0.9049; train_kl_reg_loss: 80040.4097; train_edge_recon_loss: 2692976.2955; train_gene_expr_recon_loss: 11484723.3485; train_masked_gp_l1_reg_loss: 106755.2642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43709.6941; train_chrom_access_recon_loss: 859300.0407; train_global_loss: 15267505.0303; train_optim_loss: 15267505.0303; val_kl_reg_loss: 81344.1826; val_edge_recon_loss: 2719621.3438; val_gene_expr_recon_loss: 11689396.2500; val_masked_gp_l1_reg_loss: 106746.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43705.4727; val_chrom_access_recon_loss: 872660.6406; val_global_loss: 15513474.3750; val_optim_loss: 15513474.3750
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9545; val_auprc_score: 0.9328; val_best_acc_score: 0.9097; val_best_f1_score: 0.9140; train_kl_reg_loss: 79615.8147; train_edge_recon_loss: 2694645.6174; train_gene_expr_recon_loss: 11487086.4242; train_masked_gp_l1_reg_loss: 106740.8651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43625.5332; train_chrom_access_recon_loss: 859558.6449; train_global_loss: 15271272.9091; train_optim_loss: 15271272.9091; val_kl_reg_loss: 80576.0752; val_edge_recon_loss: 2705121.0625; val_gene_expr_recon_loss: 11667080.3750; val_masked_gp_l1_reg_loss: 106744.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43552.9844; val_chrom_access_recon_loss: 851944.1172; val_global_loss: 15455018.7500; val_optim_loss: 15455018.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9541; val_auprc_score: 0.9362; val_best_acc_score: 0.9033; val_best_f1_score: 0.9064; train_kl_reg_loss: 79450.4465; train_edge_recon_loss: 2688954.4886; train_gene_expr_recon_loss: 11485976.7121; train_masked_gp_l1_reg_loss: 106444.0939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42503.2268; train_chrom_access_recon_loss: 859618.6941; train_global_loss: 15262947.5455; train_optim_loss: 15262947.5455; val_kl_reg_loss: 80814.8125; val_edge_recon_loss: 2720224.7812; val_gene_expr_recon_loss: 11626834.0000; val_masked_gp_l1_reg_loss: 106307.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42236.0234; val_chrom_access_recon_loss: 853179.5234; val_global_loss: 15429597.2500; val_optim_loss: 15429597.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9557; val_auprc_score: 0.9346; val_best_acc_score: 0.9044; val_best_f1_score: 0.9084; train_kl_reg_loss: 79616.4228; train_edge_recon_loss: 2696599.7008; train_gene_expr_recon_loss: 11493174.2121; train_masked_gp_l1_reg_loss: 106273.8813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42188.4434; train_chrom_access_recon_loss: 861146.9309; train_global_loss: 15278999.6667; train_optim_loss: 15278999.6667; val_kl_reg_loss: 80534.2490; val_edge_recon_loss: 2734380.6250; val_gene_expr_recon_loss: 11607774.8750; val_masked_gp_l1_reg_loss: 106249.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42156.7227; val_chrom_access_recon_loss: 856450.7188; val_global_loss: 15427547.3750; val_optim_loss: 15427547.3750
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9492; val_auprc_score: 0.9280; val_best_acc_score: 0.8984; val_best_f1_score: 0.9036; train_kl_reg_loss: 79816.3514; train_edge_recon_loss: 2693778.4318; train_gene_expr_recon_loss: 11482933.3939; train_masked_gp_l1_reg_loss: 106237.9263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42132.2077; train_chrom_access_recon_loss: 858961.9735; train_global_loss: 15263860.2879; train_optim_loss: 15263860.2879; val_kl_reg_loss: 81176.7012; val_edge_recon_loss: 2751696.1250; val_gene_expr_recon_loss: 11642343.0000; val_masked_gp_l1_reg_loss: 106230.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42108.0820; val_chrom_access_recon_loss: 858388.8984; val_global_loss: 15481942.8750; val_optim_loss: 15481942.8750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9527; val_auprc_score: 0.9345; val_best_acc_score: 0.8998; val_best_f1_score: 0.9048; train_kl_reg_loss: 79824.5664; train_edge_recon_loss: 2696830.8182; train_gene_expr_recon_loss: 11491283.6061; train_masked_gp_l1_reg_loss: 106224.3043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42092.2939; train_chrom_access_recon_loss: 860092.3750; train_global_loss: 15276348.0152; train_optim_loss: 15276348.0152; val_kl_reg_loss: 80883.3223; val_edge_recon_loss: 2734320.7812; val_gene_expr_recon_loss: 11596918.3750; val_masked_gp_l1_reg_loss: 106217.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42073.2852; val_chrom_access_recon_loss: 856857.6562; val_global_loss: 15417271.1250; val_optim_loss: 15417271.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 33 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9480
val AUPRC score: 0.9247
val best accuracy score: 0.8947
val best F1 score: 0.9004
val target rna MSE score: 1.2385
val source rna MSE score: 0.5970
val target atac MSE score: 0.4760
val source atac MSE score: 0.1942
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
