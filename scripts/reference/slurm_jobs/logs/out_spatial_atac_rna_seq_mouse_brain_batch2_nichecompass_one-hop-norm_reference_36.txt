[True]
Run timestamp: 26072023_014355_36.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_36']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8963; val_auprc_score: 0.9112; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16866.4549; train_edge_recon_loss: 355887.1632; train_gene_expr_recon_loss: 3206904.0000; train_masked_gp_l1_reg_loss: 1876.0808; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108427825.7778; train_global_loss: 112009358.2222; train_optim_loss: 112009358.2222; val_kl_reg_loss: 57133.0312; val_edge_recon_loss: 406609.3438; val_gene_expr_recon_loss: 3125866.0000; val_masked_gp_l1_reg_loss: 1920.7314; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 108949448.0000; val_global_loss: 112540976.0000; val_optim_loss: 112540976.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9026; val_auprc_score: 0.9118; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 30593.5082; train_edge_recon_loss: 379094.9410; train_gene_expr_recon_loss: 2930406.6944; train_masked_gp_l1_reg_loss: 2023.5252; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106109568.0000; train_global_loss: 109451686.2222; train_optim_loss: 109451686.2222; val_kl_reg_loss: 36475.1328; val_edge_recon_loss: 406609.9375; val_gene_expr_recon_loss: 2855271.7500; val_masked_gp_l1_reg_loss: 2174.2671; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106830080.0000; val_global_loss: 110130608.0000; val_optim_loss: 110130608.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8919; val_auprc_score: 0.8966; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 48925.3043; train_edge_recon_loss: 390157.7847; train_gene_expr_recon_loss: 2653534.1111; train_masked_gp_l1_reg_loss: 2304.2029; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102514734.2222; train_global_loss: 105609656.0000; train_optim_loss: 105609656.0000; val_kl_reg_loss: 66575.2109; val_edge_recon_loss: 406607.7812; val_gene_expr_recon_loss: 2644257.5000; val_masked_gp_l1_reg_loss: 2450.6321; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104129872.0000; val_global_loss: 107249760.0000; val_optim_loss: 107249760.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8745; val_auprc_score: 0.8798; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 63873.1471; train_edge_recon_loss: 398263.5000; train_gene_expr_recon_loss: 2494734.0556; train_masked_gp_l1_reg_loss: 2531.9730; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100873992.8889; train_global_loss: 103833394.6667; train_optim_loss: 103833394.6667; val_kl_reg_loss: 69055.7188; val_edge_recon_loss: 406602.1562; val_gene_expr_recon_loss: 2529225.2500; val_masked_gp_l1_reg_loss: 2614.5657; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102969048.0000; val_global_loss: 105976544.0000; val_optim_loss: 105976544.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8554; val_auprc_score: 0.8554; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 80884.8924; train_edge_recon_loss: 399036.1354; train_gene_expr_recon_loss: 2417883.5833; train_masked_gp_l1_reg_loss: 2654.9776; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100114957.3333; train_global_loss: 103015416.8889; train_optim_loss: 103015416.8889; val_kl_reg_loss: 90546.6562; val_edge_recon_loss: 406601.6250; val_gene_expr_recon_loss: 2439801.7500; val_masked_gp_l1_reg_loss: 2688.0615; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101771112.0000; val_global_loss: 104710752.0000; val_optim_loss: 104710752.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8811; val_auprc_score: 0.8822; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 95602.5938; train_edge_recon_loss: 402740.4444; train_gene_expr_recon_loss: 2341405.3889; train_masked_gp_l1_reg_loss: 2693.6041; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99228507.5556; train_global_loss: 102070948.4444; train_optim_loss: 102070948.4444; val_kl_reg_loss: 99780.6797; val_edge_recon_loss: 406598.8750; val_gene_expr_recon_loss: 2368238.5000; val_masked_gp_l1_reg_loss: 2691.4148; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101027280.0000; val_global_loss: 103904592.0000; val_optim_loss: 103904592.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8926; val_auprc_score: 0.8895; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 106240.4375; train_edge_recon_loss: 403745.1458; train_gene_expr_recon_loss: 2263812.2500; train_masked_gp_l1_reg_loss: 2678.0001; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98061567.1111; train_global_loss: 100838040.8889; train_optim_loss: 100838040.8889; val_kl_reg_loss: 115133.6719; val_edge_recon_loss: 406592.7500; val_gene_expr_recon_loss: 2315926.2500; val_masked_gp_l1_reg_loss: 2657.6951; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100413240.0000; val_global_loss: 103253552.0000; val_optim_loss: 103253552.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8936; val_auprc_score: 0.8880; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 116136.6562; train_edge_recon_loss: 404384.8438; train_gene_expr_recon_loss: 2221983.8333; train_masked_gp_l1_reg_loss: 2638.6264; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97369365.3333; train_global_loss: 100114509.3333; train_optim_loss: 100114509.3333; val_kl_reg_loss: 120459.9062; val_edge_recon_loss: 406575.9688; val_gene_expr_recon_loss: 2275149.2500; val_masked_gp_l1_reg_loss: 2613.4648; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100298200.0000; val_global_loss: 103103000.0000; val_optim_loss: 103103000.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8962; val_auprc_score: 0.8880; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 122390.4557; train_edge_recon_loss: 404582.4792; train_gene_expr_recon_loss: 2183784.3611; train_masked_gp_l1_reg_loss: 2594.2473; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97894045.3333; train_global_loss: 100607396.4444; train_optim_loss: 100607396.4444; val_kl_reg_loss: 123435.1719; val_edge_recon_loss: 406529.5312; val_gene_expr_recon_loss: 2246237.0000; val_masked_gp_l1_reg_loss: 2569.3088; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99888752.0000; val_global_loss: 102667520.0000; val_optim_loss: 102667520.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8710; val_auprc_score: 0.8593; val_best_acc_score: 0.5112; val_best_f1_score: 0.6717; train_kl_reg_loss: 126525.9531; train_edge_recon_loss: 404308.1111; train_gene_expr_recon_loss: 2170027.4444; train_masked_gp_l1_reg_loss: 2548.6359; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97402366.2222; train_global_loss: 100105777.7778; train_optim_loss: 100105777.7778; val_kl_reg_loss: 126458.4062; val_edge_recon_loss: 406444.4062; val_gene_expr_recon_loss: 2222915.0000; val_masked_gp_l1_reg_loss: 2523.5181; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99724704.0000; val_global_loss: 102483048.0000; val_optim_loss: 102483048.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8577; val_auprc_score: 0.8544; val_best_acc_score: 0.5416; val_best_f1_score: 0.6852; train_kl_reg_loss: 128346.0243; train_edge_recon_loss: 404630.0694; train_gene_expr_recon_loss: 2155166.2778; train_masked_gp_l1_reg_loss: 2504.7558; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97270856.0000; train_global_loss: 99961502.2222; train_optim_loss: 99961502.2222; val_kl_reg_loss: 124549.3438; val_edge_recon_loss: 406300.0000; val_gene_expr_recon_loss: 2206514.2500; val_masked_gp_l1_reg_loss: 2481.4407; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99629336.0000; val_global_loss: 102369184.0000; val_optim_loss: 102369184.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8533; val_auprc_score: 0.8513; val_best_acc_score: 0.5678; val_best_f1_score: 0.6966; train_kl_reg_loss: 128093.2639; train_edge_recon_loss: 404515.1146; train_gene_expr_recon_loss: 2120736.7500; train_masked_gp_l1_reg_loss: 2463.8667; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96747967.1111; train_global_loss: 99403777.7778; train_optim_loss: 99403777.7778; val_kl_reg_loss: 123415.6719; val_edge_recon_loss: 406172.9062; val_gene_expr_recon_loss: 2194696.0000; val_masked_gp_l1_reg_loss: 2442.2703; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99420384.0000; val_global_loss: 102147112.0000; val_optim_loss: 102147112.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8604; val_auprc_score: 0.8571; val_best_acc_score: 0.5965; val_best_f1_score: 0.7097; train_kl_reg_loss: 128185.4983; train_edge_recon_loss: 404139.3229; train_gene_expr_recon_loss: 2114293.7778; train_masked_gp_l1_reg_loss: 2428.2733; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96510656.8889; train_global_loss: 99159704.0000; train_optim_loss: 99159704.0000; val_kl_reg_loss: 120474.6719; val_edge_recon_loss: 406007.5000; val_gene_expr_recon_loss: 2189780.7500; val_masked_gp_l1_reg_loss: 2409.7029; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99333944.0000; val_global_loss: 102052616.0000; val_optim_loss: 102052616.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8676; val_auprc_score: 0.8619; val_best_acc_score: 0.6275; val_best_f1_score: 0.7247; train_kl_reg_loss: 126796.6102; train_edge_recon_loss: 404103.3681; train_gene_expr_recon_loss: 2102474.8056; train_masked_gp_l1_reg_loss: 2397.5773; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96416322.6667; train_global_loss: 99052094.2222; train_optim_loss: 99052094.2222; val_kl_reg_loss: 119520.2344; val_edge_recon_loss: 405827.5625; val_gene_expr_recon_loss: 2179387.5000; val_masked_gp_l1_reg_loss: 2382.9697; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99182208.0000; val_global_loss: 101889328.0000; val_optim_loss: 101889328.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8778; val_auprc_score: 0.8706; val_best_acc_score: 0.6711; val_best_f1_score: 0.7475; train_kl_reg_loss: 126128.3906; train_edge_recon_loss: 403914.3715; train_gene_expr_recon_loss: 2102112.4861; train_masked_gp_l1_reg_loss: 2374.0303; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96519688.0000; train_global_loss: 99154216.8889; train_optim_loss: 99154216.8889; val_kl_reg_loss: 114646.3438; val_edge_recon_loss: 405607.5000; val_gene_expr_recon_loss: 2176607.7500; val_masked_gp_l1_reg_loss: 2360.3271; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99083312.0000; val_global_loss: 101782536.0000; val_optim_loss: 101782536.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8879; val_auprc_score: 0.8778; val_best_acc_score: 0.7137; val_best_f1_score: 0.7717; train_kl_reg_loss: 124780.7882; train_edge_recon_loss: 403549.3090; train_gene_expr_recon_loss: 2103704.1389; train_masked_gp_l1_reg_loss: 2351.5959; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96508923.5556; train_global_loss: 99143309.3333; train_optim_loss: 99143309.3333; val_kl_reg_loss: 115195.3984; val_edge_recon_loss: 405372.7812; val_gene_expr_recon_loss: 2171161.0000; val_masked_gp_l1_reg_loss: 2340.1714; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99000824.0000; val_global_loss: 101694896.0000; val_optim_loss: 101694896.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8954; val_auprc_score: 0.8821; val_best_acc_score: 0.7582; val_best_f1_score: 0.7983; train_kl_reg_loss: 123414.0825; train_edge_recon_loss: 403322.9826; train_gene_expr_recon_loss: 2088963.3889; train_masked_gp_l1_reg_loss: 2334.4787; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96491267.5556; train_global_loss: 99109303.1111; train_optim_loss: 99109303.1111; val_kl_reg_loss: 113175.3594; val_edge_recon_loss: 404968.6875; val_gene_expr_recon_loss: 2167297.5000; val_masked_gp_l1_reg_loss: 2324.1628; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98857552.0000; val_global_loss: 101545320.0000; val_optim_loss: 101545320.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8997; val_auprc_score: 0.8836; val_best_acc_score: 0.8001; val_best_f1_score: 0.8254; train_kl_reg_loss: 122488.9262; train_edge_recon_loss: 402725.1632; train_gene_expr_recon_loss: 2088145.5139; train_masked_gp_l1_reg_loss: 2317.2569; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95768250.6667; train_global_loss: 98383927.1111; train_optim_loss: 98383927.1111; val_kl_reg_loss: 112400.6719; val_edge_recon_loss: 404370.4688; val_gene_expr_recon_loss: 2164296.7500; val_masked_gp_l1_reg_loss: 2307.6587; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98777128.0000; val_global_loss: 101460504.0000; val_optim_loss: 101460504.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8973; val_auprc_score: 0.8858; val_best_acc_score: 0.8010; val_best_f1_score: 0.8232; train_kl_reg_loss: 121536.6597; train_edge_recon_loss: 402525.2257; train_gene_expr_recon_loss: 2090723.5000; train_masked_gp_l1_reg_loss: 2302.0273; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96178813.3333; train_global_loss: 98795900.4444; train_optim_loss: 98795900.4444; val_kl_reg_loss: 112182.3906; val_edge_recon_loss: 403737.3438; val_gene_expr_recon_loss: 2160128.0000; val_masked_gp_l1_reg_loss: 2293.0962; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98691264.0000; val_global_loss: 101369608.0000; val_optim_loss: 101369608.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9047; val_auprc_score: 0.8934; val_best_acc_score: 0.8169; val_best_f1_score: 0.8309; train_kl_reg_loss: 119803.8767; train_edge_recon_loss: 401636.8819; train_gene_expr_recon_loss: 2077625.8472; train_masked_gp_l1_reg_loss: 2288.2301; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95602782.2222; train_global_loss: 98204137.7778; train_optim_loss: 98204137.7778; val_kl_reg_loss: 112919.3984; val_edge_recon_loss: 402674.1250; val_gene_expr_recon_loss: 2156908.5000; val_masked_gp_l1_reg_loss: 2280.3057; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98638080.0000; val_global_loss: 101312864.0000; val_optim_loss: 101312864.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8977; val_auprc_score: 0.8834; val_best_acc_score: 0.8111; val_best_f1_score: 0.8228; train_kl_reg_loss: 120318.8047; train_edge_recon_loss: 400337.5312; train_gene_expr_recon_loss: 2099236.6528; train_masked_gp_l1_reg_loss: 2276.3667; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96271373.3333; train_global_loss: 98893543.1111; train_optim_loss: 98893543.1111; val_kl_reg_loss: 111840.8438; val_edge_recon_loss: 401870.2500; val_gene_expr_recon_loss: 2152974.5000; val_masked_gp_l1_reg_loss: 2269.3135; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98505240.0000; val_global_loss: 101174192.0000; val_optim_loss: 101174192.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8928; val_auprc_score: 0.8727; val_best_acc_score: 0.8096; val_best_f1_score: 0.8180; train_kl_reg_loss: 118693.3472; train_edge_recon_loss: 399499.6215; train_gene_expr_recon_loss: 2094097.1389; train_masked_gp_l1_reg_loss: 2266.4192; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95688163.5556; train_global_loss: 98302719.1111; train_optim_loss: 98302719.1111; val_kl_reg_loss: 110735.9375; val_edge_recon_loss: 400814.8125; val_gene_expr_recon_loss: 2150407.0000; val_masked_gp_l1_reg_loss: 2259.3091; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98435424.0000; val_global_loss: 101099640.0000; val_optim_loss: 101099640.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8972; val_auprc_score: 0.8831; val_best_acc_score: 0.8111; val_best_f1_score: 0.8139; train_kl_reg_loss: 117622.6181; train_edge_recon_loss: 398495.2431; train_gene_expr_recon_loss: 2079379.9583; train_masked_gp_l1_reg_loss: 2255.2591; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95953466.6667; train_global_loss: 98551218.6667; train_optim_loss: 98551218.6667; val_kl_reg_loss: 105683.8281; val_edge_recon_loss: 399570.0938; val_gene_expr_recon_loss: 2148908.2500; val_masked_gp_l1_reg_loss: 2248.4126; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98338088.0000; val_global_loss: 100994496.0000; val_optim_loss: 100994496.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8999; val_auprc_score: 0.8845; val_best_acc_score: 0.8095; val_best_f1_score: 0.8080; train_kl_reg_loss: 115832.1293; train_edge_recon_loss: 397156.7049; train_gene_expr_recon_loss: 2075462.3194; train_masked_gp_l1_reg_loss: 2245.1447; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95698080.8889; train_global_loss: 98288776.8889; train_optim_loss: 98288776.8889; val_kl_reg_loss: 103244.0547; val_edge_recon_loss: 398103.5625; val_gene_expr_recon_loss: 2147344.7500; val_masked_gp_l1_reg_loss: 2239.0898; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98231160.0000; val_global_loss: 100882088.0000; val_optim_loss: 100882088.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9048; val_auprc_score: 0.8913; val_best_acc_score: 0.8142; val_best_f1_score: 0.8115; train_kl_reg_loss: 114258.8438; train_edge_recon_loss: 396168.7465; train_gene_expr_recon_loss: 2075330.8889; train_masked_gp_l1_reg_loss: 2237.0878; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95701056.8889; train_global_loss: 98289052.4444; train_optim_loss: 98289052.4444; val_kl_reg_loss: 101429.4766; val_edge_recon_loss: 396625.6562; val_gene_expr_recon_loss: 2143882.2500; val_masked_gp_l1_reg_loss: 2232.2837; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98088952.0000; val_global_loss: 100733120.0000; val_optim_loss: 100733120.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9035; val_auprc_score: 0.8815; val_best_acc_score: 0.8254; val_best_f1_score: 0.8297; train_kl_reg_loss: 131515.4714; train_edge_recon_loss: 396929.4062; train_gene_expr_recon_loss: 2227615.7778; train_masked_gp_l1_reg_loss: 2246.8799; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97588974.2222; train_global_loss: 100347280.8889; train_optim_loss: 100347280.8889; val_kl_reg_loss: 71618.0469; val_edge_recon_loss: 399368.0938; val_gene_expr_recon_loss: 2264312.2500; val_masked_gp_l1_reg_loss: 2266.6733; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99672320.0000; val_global_loss: 102409888.0000; val_optim_loss: 102409888.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9031; val_auprc_score: 0.8854; val_best_acc_score: 0.8205; val_best_f1_score: 0.8273; train_kl_reg_loss: 132570.0998; train_edge_recon_loss: 395311.9896; train_gene_expr_recon_loss: 2188669.4444; train_masked_gp_l1_reg_loss: 2278.2067; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97335264.0000; train_global_loss: 100054094.2222; train_optim_loss: 100054094.2222; val_kl_reg_loss: 75948.4297; val_edge_recon_loss: 400223.6875; val_gene_expr_recon_loss: 2246502.2500; val_masked_gp_l1_reg_loss: 2283.5229; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99701296.0000; val_global_loss: 102426256.0000; val_optim_loss: 102426256.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9057; val_auprc_score: 0.8900; val_best_acc_score: 0.8236; val_best_f1_score: 0.8287; train_kl_reg_loss: 125844.1181; train_edge_recon_loss: 396741.3472; train_gene_expr_recon_loss: 2165230.4722; train_masked_gp_l1_reg_loss: 2279.7121; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97216822.2222; train_global_loss: 99906917.3333; train_optim_loss: 99906917.3333; val_kl_reg_loss: 74077.7578; val_edge_recon_loss: 399935.8438; val_gene_expr_recon_loss: 2238635.7500; val_masked_gp_l1_reg_loss: 2272.0798; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99460984.0000; val_global_loss: 102175904.0000; val_optim_loss: 102175904.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9034; val_auprc_score: 0.8840; val_best_acc_score: 0.8213; val_best_f1_score: 0.8258; train_kl_reg_loss: 117146.2378; train_edge_recon_loss: 398240.9340; train_gene_expr_recon_loss: 2169797.1111; train_masked_gp_l1_reg_loss: 2265.2680; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96690568.8889; train_global_loss: 99378019.5556; train_optim_loss: 99378019.5556; val_kl_reg_loss: 72507.1016; val_edge_recon_loss: 399470.1562; val_gene_expr_recon_loss: 2235702.5000; val_masked_gp_l1_reg_loss: 2255.9917; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99624528.0000; val_global_loss: 102334464.0000; val_optim_loss: 102334464.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9063; val_auprc_score: 0.8872; val_best_acc_score: 0.8223; val_best_f1_score: 0.8262; train_kl_reg_loss: 111833.6797; train_edge_recon_loss: 397733.2292; train_gene_expr_recon_loss: 2159424.0833; train_masked_gp_l1_reg_loss: 2254.8786; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96555704.0000; train_global_loss: 99226950.2222; train_optim_loss: 99226950.2222; val_kl_reg_loss: 72769.6875; val_edge_recon_loss: 399350.0938; val_gene_expr_recon_loss: 2235302.7500; val_masked_gp_l1_reg_loss: 2253.4102; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99538240.0000; val_global_loss: 102247920.0000; val_optim_loss: 102247920.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9068; val_auprc_score: 0.8898; val_best_acc_score: 0.8224; val_best_f1_score: 0.8266; train_kl_reg_loss: 114899.7934; train_edge_recon_loss: 397242.2639; train_gene_expr_recon_loss: 2181799.8611; train_masked_gp_l1_reg_loss: 2252.2347; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97297119.1111; train_global_loss: 99993312.0000; train_optim_loss: 99993312.0000; val_kl_reg_loss: 75919.6250; val_edge_recon_loss: 399332.6875; val_gene_expr_recon_loss: 2234685.0000; val_masked_gp_l1_reg_loss: 2250.7324; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99549224.0000; val_global_loss: 102261408.0000; val_optim_loss: 102261408.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9118; val_auprc_score: 0.8933; val_best_acc_score: 0.8297; val_best_f1_score: 0.8321; train_kl_reg_loss: 116007.0599; train_edge_recon_loss: 396761.1319; train_gene_expr_recon_loss: 2154599.2500; train_masked_gp_l1_reg_loss: 2249.4486; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96977644.4444; train_global_loss: 99647262.2222; train_optim_loss: 99647262.2222; val_kl_reg_loss: 74878.6484; val_edge_recon_loss: 399281.8125; val_gene_expr_recon_loss: 2234128.0000; val_masked_gp_l1_reg_loss: 2247.8643; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99534968.0000; val_global_loss: 102245504.0000; val_optim_loss: 102245504.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9096; val_auprc_score: 0.8929; val_best_acc_score: 0.8250; val_best_f1_score: 0.8285; train_kl_reg_loss: 114271.9062; train_edge_recon_loss: 397385.4861; train_gene_expr_recon_loss: 2163729.9444; train_masked_gp_l1_reg_loss: 2246.7320; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96849024.8889; train_global_loss: 99526658.6667; train_optim_loss: 99526658.6667; val_kl_reg_loss: 74407.8281; val_edge_recon_loss: 399155.1250; val_gene_expr_recon_loss: 2231553.0000; val_masked_gp_l1_reg_loss: 2245.4092; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99493760.0000; val_global_loss: 102201120.0000; val_optim_loss: 102201120.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 36 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9073
Val AUPRC score: 0.8922
Val best accuracy score: 0.8208
Val best F1 score: 0.8243
Val gene expr MSE score: 0.7035
Val chrom access MSE score: 0.0928
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
