[True]
Run timestamp: 07092023_153857_36.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_36']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2398 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5114, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6615; val_auprc_score: 0.6479; val_best_acc_score: 0.5081; val_best_f1_score: 0.6697; train_kl_reg_loss: 52388.5562; train_edge_recon_loss: 3551250.2424; train_gene_expr_recon_loss: 12410626.3939; train_masked_gp_l1_reg_loss: 56254.4381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 811816.9025; train_chrom_access_recon_loss: 10287285.0758; train_global_loss: 27169621.4242; train_optim_loss: 27169621.4242; val_kl_reg_loss: 109407.5645; val_edge_recon_loss: 4064896.1562; val_gene_expr_recon_loss: 11560431.5000; val_masked_gp_l1_reg_loss: 51485.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 615190.7500; val_chrom_access_recon_loss: 9955694.2500; val_global_loss: 26357105.7500; val_optim_loss: 26357105.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6998; val_auprc_score: 0.6788; val_best_acc_score: 0.5790; val_best_f1_score: 0.6964; train_kl_reg_loss: 105499.6392; train_edge_recon_loss: 3529676.1364; train_gene_expr_recon_loss: 11252210.7727; train_masked_gp_l1_reg_loss: 48478.3289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 449041.5327; train_chrom_access_recon_loss: 9754331.2879; train_global_loss: 25139237.6667; train_optim_loss: 25139237.6667; val_kl_reg_loss: 106086.7764; val_edge_recon_loss: 4061084.5000; val_gene_expr_recon_loss: 11144929.8750; val_masked_gp_l1_reg_loss: 46937.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 310043.8125; val_chrom_access_recon_loss: 9669549.3750; val_global_loss: 25338632.7500; val_optim_loss: 25338632.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7739; val_auprc_score: 0.7619; val_best_acc_score: 0.7055; val_best_f1_score: 0.6981; train_kl_reg_loss: 95392.3835; train_edge_recon_loss: 3519255.0795; train_gene_expr_recon_loss: 11108443.9545; train_masked_gp_l1_reg_loss: 47376.8362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231097.6868; train_chrom_access_recon_loss: 9667416.8333; train_global_loss: 24668982.7879; train_optim_loss: 24668982.7879; val_kl_reg_loss: 92796.1611; val_edge_recon_loss: 4026116.1250; val_gene_expr_recon_loss: 11162775.0000; val_masked_gp_l1_reg_loss: 48473.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169927.2344; val_chrom_access_recon_loss: 9673358.0000; val_global_loss: 25173445.5000; val_optim_loss: 25173445.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8302; val_auprc_score: 0.7899; val_best_acc_score: 0.7665; val_best_f1_score: 0.7926; train_kl_reg_loss: 77762.5417; train_edge_recon_loss: 3476942.9280; train_gene_expr_recon_loss: 11015046.8939; train_masked_gp_l1_reg_loss: 50265.1910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136405.1231; train_chrom_access_recon_loss: 9610339.2424; train_global_loss: 24366761.8788; train_optim_loss: 24366761.8788; val_kl_reg_loss: 54922.7144; val_edge_recon_loss: 3540033.1562; val_gene_expr_recon_loss: 11129565.7500; val_masked_gp_l1_reg_loss: 52474.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110005.9219; val_chrom_access_recon_loss: 9616123.3750; val_global_loss: 24503125.0000; val_optim_loss: 24503125.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8284; val_auprc_score: 0.7857; val_best_acc_score: 0.7499; val_best_f1_score: 0.7887; train_kl_reg_loss: 83680.4354; train_edge_recon_loss: 3084809.7462; train_gene_expr_recon_loss: 10962220.6667; train_masked_gp_l1_reg_loss: 54966.0391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94401.2675; train_chrom_access_recon_loss: 9562508.7121; train_global_loss: 23842586.6970; train_optim_loss: 23842586.6970; val_kl_reg_loss: 111533.1465; val_edge_recon_loss: 3012039.9375; val_gene_expr_recon_loss: 10992420.2500; val_masked_gp_l1_reg_loss: 56643.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81023.7734; val_chrom_access_recon_loss: 9529770.5000; val_global_loss: 23783431.7500; val_optim_loss: 23783431.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8570; val_auprc_score: 0.8258; val_best_acc_score: 0.7762; val_best_f1_score: 0.7992; train_kl_reg_loss: 104218.7840; train_edge_recon_loss: 2958274.7689; train_gene_expr_recon_loss: 10878147.9091; train_masked_gp_l1_reg_loss: 57548.3128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71933.3948; train_chrom_access_recon_loss: 9500506.1515; train_global_loss: 23570629.1818; train_optim_loss: 23570629.1818; val_kl_reg_loss: 96574.3877; val_edge_recon_loss: 2940981.8438; val_gene_expr_recon_loss: 10873216.3750; val_masked_gp_l1_reg_loss: 58777.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64169.5781; val_chrom_access_recon_loss: 9451219.5000; val_global_loss: 23484940.0000; val_optim_loss: 23484940.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8716; val_auprc_score: 0.8414; val_best_acc_score: 0.7920; val_best_f1_score: 0.8120; train_kl_reg_loss: 97822.1322; train_edge_recon_loss: 2942321.2727; train_gene_expr_recon_loss: 10815999.9697; train_masked_gp_l1_reg_loss: 59784.8465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58958.7568; train_chrom_access_recon_loss: 9446892.1212; train_global_loss: 23421779.0909; train_optim_loss: 23421779.0909; val_kl_reg_loss: 87998.6807; val_edge_recon_loss: 2895684.9688; val_gene_expr_recon_loss: 10859493.8750; val_masked_gp_l1_reg_loss: 61041.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54364.9531; val_chrom_access_recon_loss: 9442167.3750; val_global_loss: 23400750.7500; val_optim_loss: 23400750.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8656; val_auprc_score: 0.8171; val_best_acc_score: 0.7950; val_best_f1_score: 0.8236; train_kl_reg_loss: 92428.9177; train_edge_recon_loss: 2890838.4280; train_gene_expr_recon_loss: 10763453.6364; train_masked_gp_l1_reg_loss: 62133.7841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50910.9043; train_chrom_access_recon_loss: 9404631.4091; train_global_loss: 23264397.0000; train_optim_loss: 23264397.0000; val_kl_reg_loss: 93786.0713; val_edge_recon_loss: 2878009.0000; val_gene_expr_recon_loss: 10816351.0000; val_masked_gp_l1_reg_loss: 63173.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48008.5039; val_chrom_access_recon_loss: 9424730.0000; val_global_loss: 23324058.5000; val_optim_loss: 23324058.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8888; val_auprc_score: 0.8478; val_best_acc_score: 0.8246; val_best_f1_score: 0.8392; train_kl_reg_loss: 93310.6928; train_edge_recon_loss: 2859857.7727; train_gene_expr_recon_loss: 10709172.1364; train_masked_gp_l1_reg_loss: 64125.3087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45520.6339; train_chrom_access_recon_loss: 9369362.1212; train_global_loss: 23141348.6061; train_optim_loss: 23141348.6061; val_kl_reg_loss: 90387.2451; val_edge_recon_loss: 2858138.7812; val_gene_expr_recon_loss: 10809526.6250; val_masked_gp_l1_reg_loss: 65111.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43646.4062; val_chrom_access_recon_loss: 9449301.7500; val_global_loss: 23316111.5000; val_optim_loss: 23316111.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8899; val_auprc_score: 0.8553; val_best_acc_score: 0.8224; val_best_f1_score: 0.8398; train_kl_reg_loss: 95930.7144; train_edge_recon_loss: 2809393.4773; train_gene_expr_recon_loss: 10664240.2121; train_masked_gp_l1_reg_loss: 65983.0275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41775.4375; train_chrom_access_recon_loss: 9324476.4394; train_global_loss: 23001799.2424; train_optim_loss: 23001799.2424; val_kl_reg_loss: 98521.1211; val_edge_recon_loss: 2848125.8750; val_gene_expr_recon_loss: 10702246.8750; val_masked_gp_l1_reg_loss: 66956.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40479.7227; val_chrom_access_recon_loss: 9299810.1250; val_global_loss: 23056140.0000; val_optim_loss: 23056140.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9010; val_auprc_score: 0.8652; val_best_acc_score: 0.8342; val_best_f1_score: 0.8460; train_kl_reg_loss: 93380.8479; train_edge_recon_loss: 2805619.5076; train_gene_expr_recon_loss: 10624524.4091; train_masked_gp_l1_reg_loss: 67733.5806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39210.1281; train_chrom_access_recon_loss: 9296134.4091; train_global_loss: 22926602.8788; train_optim_loss: 22926602.8788; val_kl_reg_loss: 89973.9463; val_edge_recon_loss: 2854636.6562; val_gene_expr_recon_loss: 10684625.6250; val_masked_gp_l1_reg_loss: 68677.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38243.2969; val_chrom_access_recon_loss: 9275764.2500; val_global_loss: 23011920.7500; val_optim_loss: 23011920.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9144; val_auprc_score: 0.8849; val_best_acc_score: 0.8525; val_best_f1_score: 0.8627; train_kl_reg_loss: 89839.9164; train_edge_recon_loss: 2794341.7311; train_gene_expr_recon_loss: 10588318.6212; train_masked_gp_l1_reg_loss: 69382.1252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37259.1059; train_chrom_access_recon_loss: 9263589.4697; train_global_loss: 22842730.9697; train_optim_loss: 22842730.9697; val_kl_reg_loss: 93118.5244; val_edge_recon_loss: 2804000.0000; val_gene_expr_recon_loss: 10673430.5000; val_masked_gp_l1_reg_loss: 70210.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36402.5586; val_chrom_access_recon_loss: 9352888.0000; val_global_loss: 23030050.7500; val_optim_loss: 23030050.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9224; val_auprc_score: 0.8898; val_best_acc_score: 0.8611; val_best_f1_score: 0.8723; train_kl_reg_loss: 91606.1747; train_edge_recon_loss: 2778678.8902; train_gene_expr_recon_loss: 10554288.5455; train_masked_gp_l1_reg_loss: 70846.7356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35830.4505; train_chrom_access_recon_loss: 9234162.6667; train_global_loss: 22765413.5152; train_optim_loss: 22765413.5152; val_kl_reg_loss: 90489.6836; val_edge_recon_loss: 2788159.3125; val_gene_expr_recon_loss: 10544892.3750; val_masked_gp_l1_reg_loss: 71669.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35436.4570; val_chrom_access_recon_loss: 9251595.2500; val_global_loss: 22782242.5000; val_optim_loss: 22782242.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9325; val_auprc_score: 0.9086; val_best_acc_score: 0.8726; val_best_f1_score: 0.8821; train_kl_reg_loss: 90963.7115; train_edge_recon_loss: 2763305.4432; train_gene_expr_recon_loss: 10504532.2879; train_masked_gp_l1_reg_loss: 72232.4062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34796.5215; train_chrom_access_recon_loss: 9186537.3939; train_global_loss: 22652367.7273; train_optim_loss: 22652367.7273; val_kl_reg_loss: 89735.9492; val_edge_recon_loss: 2751084.3438; val_gene_expr_recon_loss: 10648789.7500; val_masked_gp_l1_reg_loss: 72966.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34317.9453; val_chrom_access_recon_loss: 9223086.8750; val_global_loss: 22819980.7500; val_optim_loss: 22819980.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9207; val_auprc_score: 0.8886; val_best_acc_score: 0.8600; val_best_f1_score: 0.8686; train_kl_reg_loss: 89417.9910; train_edge_recon_loss: 2763715.5455; train_gene_expr_recon_loss: 10477698.1970; train_masked_gp_l1_reg_loss: 73499.5143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33840.7846; train_chrom_access_recon_loss: 9158787.6970; train_global_loss: 22596959.6667; train_optim_loss: 22596959.6667; val_kl_reg_loss: 93910.7422; val_edge_recon_loss: 2797338.0625; val_gene_expr_recon_loss: 10542797.6250; val_masked_gp_l1_reg_loss: 74075.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33294.2773; val_chrom_access_recon_loss: 9193360.0000; val_global_loss: 22734775.2500; val_optim_loss: 22734775.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9229; val_auprc_score: 0.8896; val_best_acc_score: 0.8678; val_best_f1_score: 0.8756; train_kl_reg_loss: 89577.6548; train_edge_recon_loss: 2748614.4394; train_gene_expr_recon_loss: 10451163.7879; train_masked_gp_l1_reg_loss: 74559.3124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33055.4993; train_chrom_access_recon_loss: 9124620.8485; train_global_loss: 22521591.4545; train_optim_loss: 22521591.4545; val_kl_reg_loss: 90221.5547; val_edge_recon_loss: 2786223.6562; val_gene_expr_recon_loss: 10513569.8750; val_masked_gp_l1_reg_loss: 75222.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32729.2539; val_chrom_access_recon_loss: 9183369.6250; val_global_loss: 22681336.7500; val_optim_loss: 22681336.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9289; val_auprc_score: 0.8958; val_best_acc_score: 0.8708; val_best_f1_score: 0.8803; train_kl_reg_loss: 88403.9548; train_edge_recon_loss: 2740295.0492; train_gene_expr_recon_loss: 10422271.0000; train_masked_gp_l1_reg_loss: 75747.4308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32421.7284; train_chrom_access_recon_loss: 9107658.6212; train_global_loss: 22466797.7879; train_optim_loss: 22466797.7879; val_kl_reg_loss: 86938.3184; val_edge_recon_loss: 2753278.4688; val_gene_expr_recon_loss: 10575781.0000; val_masked_gp_l1_reg_loss: 76188.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32213.4883; val_chrom_access_recon_loss: 9229307.1250; val_global_loss: 22753707.0000; val_optim_loss: 22753707.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9365; val_auprc_score: 0.9127; val_best_acc_score: 0.8710; val_best_f1_score: 0.8796; train_kl_reg_loss: 86763.4779; train_edge_recon_loss: 2746242.3485; train_gene_expr_recon_loss: 10396944.7727; train_masked_gp_l1_reg_loss: 76745.2353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31947.8311; train_chrom_access_recon_loss: 9077025.8333; train_global_loss: 22415669.6970; train_optim_loss: 22415669.6970; val_kl_reg_loss: 84075.3496; val_edge_recon_loss: 2801104.8438; val_gene_expr_recon_loss: 10494443.3750; val_masked_gp_l1_reg_loss: 77355.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31827.2891; val_chrom_access_recon_loss: 9197890.0000; val_global_loss: 22686695.2500; val_optim_loss: 22686695.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9314; val_auprc_score: 0.9017; val_best_acc_score: 0.8721; val_best_f1_score: 0.8802; train_kl_reg_loss: 84414.5129; train_edge_recon_loss: 2743487.8902; train_gene_expr_recon_loss: 10372310.4545; train_masked_gp_l1_reg_loss: 77775.5528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31497.5240; train_chrom_access_recon_loss: 9056655.8939; train_global_loss: 22366141.6970; train_optim_loss: 22366141.6970; val_kl_reg_loss: 86754.8486; val_edge_recon_loss: 2799265.3125; val_gene_expr_recon_loss: 10401309.1250; val_masked_gp_l1_reg_loss: 78233.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31319.8555; val_chrom_access_recon_loss: 8995978.0625; val_global_loss: 22392861.7500; val_optim_loss: 22392861.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9386; val_auprc_score: 0.9152; val_best_acc_score: 0.8804; val_best_f1_score: 0.8888; train_kl_reg_loss: 83795.4622; train_edge_recon_loss: 2731862.9053; train_gene_expr_recon_loss: 10343604.0455; train_masked_gp_l1_reg_loss: 78701.9914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31091.0199; train_chrom_access_recon_loss: 9026330.7424; train_global_loss: 22295386.2424; train_optim_loss: 22295386.2424; val_kl_reg_loss: 85557.3271; val_edge_recon_loss: 2758181.6562; val_gene_expr_recon_loss: 10379225.7500; val_masked_gp_l1_reg_loss: 79215.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30765.4297; val_chrom_access_recon_loss: 9062390.5000; val_global_loss: 22395335.0000; val_optim_loss: 22395335.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9405; val_auprc_score: 0.9199; val_best_acc_score: 0.8866; val_best_f1_score: 0.8938; train_kl_reg_loss: 84020.3710; train_edge_recon_loss: 2724248.2121; train_gene_expr_recon_loss: 10329598.5909; train_masked_gp_l1_reg_loss: 79666.7831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30645.2783; train_chrom_access_recon_loss: 9003729.8939; train_global_loss: 22251908.9697; train_optim_loss: 22251908.9697; val_kl_reg_loss: 81361.8486; val_edge_recon_loss: 2759771.8125; val_gene_expr_recon_loss: 10387256.5000; val_masked_gp_l1_reg_loss: 80117.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30531.4297; val_chrom_access_recon_loss: 9051087.7500; val_global_loss: 22390126.0000; val_optim_loss: 22390126.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9395; val_auprc_score: 0.9180; val_best_acc_score: 0.8818; val_best_f1_score: 0.8887; train_kl_reg_loss: 82856.2654; train_edge_recon_loss: 2718416.8977; train_gene_expr_recon_loss: 10291727.4091; train_masked_gp_l1_reg_loss: 80458.4490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30229.6288; train_chrom_access_recon_loss: 8971855.6970; train_global_loss: 22175544.4545; train_optim_loss: 22175544.4545; val_kl_reg_loss: 81945.2529; val_edge_recon_loss: 2761260.1562; val_gene_expr_recon_loss: 10307901.7500; val_masked_gp_l1_reg_loss: 80980.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30323.8770; val_chrom_access_recon_loss: 9048966.3750; val_global_loss: 22311378.5000; val_optim_loss: 22311378.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9482; val_auprc_score: 0.9307; val_best_acc_score: 0.8960; val_best_f1_score: 0.9001; train_kl_reg_loss: 81659.5792; train_edge_recon_loss: 2715729.6288; train_gene_expr_recon_loss: 10277029.1970; train_masked_gp_l1_reg_loss: 81346.2436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29986.8750; train_chrom_access_recon_loss: 8952519.6364; train_global_loss: 22138271.3939; train_optim_loss: 22138271.3939; val_kl_reg_loss: 81987.5117; val_edge_recon_loss: 2733692.7188; val_gene_expr_recon_loss: 10348348.8750; val_masked_gp_l1_reg_loss: 81834.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29758.3555; val_chrom_access_recon_loss: 9128490.5000; val_global_loss: 22404111.5000; val_optim_loss: 22404111.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9478; val_auprc_score: 0.9310; val_best_acc_score: 0.8939; val_best_f1_score: 0.8991; train_kl_reg_loss: 80772.7333; train_edge_recon_loss: 2705577.8636; train_gene_expr_recon_loss: 10250844.8636; train_masked_gp_l1_reg_loss: 82200.5014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29544.6619; train_chrom_access_recon_loss: 8920654.8788; train_global_loss: 22069595.4545; train_optim_loss: 22069595.4545; val_kl_reg_loss: 81568.6768; val_edge_recon_loss: 2721058.8438; val_gene_expr_recon_loss: 10227267.5000; val_masked_gp_l1_reg_loss: 82681.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29435.1250; val_chrom_access_recon_loss: 8891983.0000; val_global_loss: 22033995.2500; val_optim_loss: 22033995.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9488; val_auprc_score: 0.9268; val_best_acc_score: 0.8944; val_best_f1_score: 0.9004; train_kl_reg_loss: 81532.6291; train_edge_recon_loss: 2698380.6591; train_gene_expr_recon_loss: 10233559.3485; train_masked_gp_l1_reg_loss: 82995.7473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29264.3098; train_chrom_access_recon_loss: 8901252.2045; train_global_loss: 22026984.9394; train_optim_loss: 22026984.9394; val_kl_reg_loss: 80040.3320; val_edge_recon_loss: 2741908.1875; val_gene_expr_recon_loss: 10309781.2500; val_masked_gp_l1_reg_loss: 83381.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29099.4785; val_chrom_access_recon_loss: 8997324.2500; val_global_loss: 22241535.0000; val_optim_loss: 22241535.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9430; val_auprc_score: 0.9187; val_best_acc_score: 0.8890; val_best_f1_score: 0.8964; train_kl_reg_loss: 85049.3063; train_edge_recon_loss: 2739214.7841; train_gene_expr_recon_loss: 10048178.6515; train_masked_gp_l1_reg_loss: 82773.7842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27044.2744; train_chrom_access_recon_loss: 8746917.0379; train_global_loss: 21729177.7273; train_optim_loss: 21729177.7273; val_kl_reg_loss: 55131.0762; val_edge_recon_loss: 2755763.0312; val_gene_expr_recon_loss: 10162259.2500; val_masked_gp_l1_reg_loss: 82601.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26671.1426; val_chrom_access_recon_loss: 8787502.8750; val_global_loss: 21869929.0000; val_optim_loss: 21869929.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9421; val_auprc_score: 0.9176; val_best_acc_score: 0.8925; val_best_f1_score: 0.8987; train_kl_reg_loss: 85915.8337; train_edge_recon_loss: 2722929.2841; train_gene_expr_recon_loss: 10007308.5909; train_masked_gp_l1_reg_loss: 82646.8073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26489.4772; train_chrom_access_recon_loss: 8690019.8636; train_global_loss: 21615309.9091; train_optim_loss: 21615309.9091; val_kl_reg_loss: 61239.0190; val_edge_recon_loss: 2766290.8750; val_gene_expr_recon_loss: 10127082.5000; val_masked_gp_l1_reg_loss: 82812.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26411.4023; val_chrom_access_recon_loss: 8691785.9375; val_global_loss: 21755621.2500; val_optim_loss: 21755621.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9546; val_auprc_score: 0.9369; val_best_acc_score: 0.9027; val_best_f1_score: 0.9071; train_kl_reg_loss: 81856.7846; train_edge_recon_loss: 2713918.0417; train_gene_expr_recon_loss: 9992149.1061; train_masked_gp_l1_reg_loss: 82950.3704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26368.7085; train_chrom_access_recon_loss: 8666832.1061; train_global_loss: 21564075.0000; train_optim_loss: 21564075.0000; val_kl_reg_loss: 61883.4966; val_edge_recon_loss: 2748743.2812; val_gene_expr_recon_loss: 10107633.6250; val_masked_gp_l1_reg_loss: 83213.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26330.4902; val_chrom_access_recon_loss: 8647170.3750; val_global_loss: 21674975.2500; val_optim_loss: 21674975.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9447; val_auprc_score: 0.9248; val_best_acc_score: 0.8928; val_best_f1_score: 0.8984; train_kl_reg_loss: 80537.9336; train_edge_recon_loss: 2701433.7841; train_gene_expr_recon_loss: 9972025.2576; train_masked_gp_l1_reg_loss: 83269.1576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26202.4118; train_chrom_access_recon_loss: 8647202.4621; train_global_loss: 21510671.0909; train_optim_loss: 21510671.0909; val_kl_reg_loss: 61667.0063; val_edge_recon_loss: 2772160.3125; val_gene_expr_recon_loss: 10096250.5000; val_masked_gp_l1_reg_loss: 83346.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26068.8262; val_chrom_access_recon_loss: 8704527.5000; val_global_loss: 21744020.5000; val_optim_loss: 21744020.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9496; val_auprc_score: 0.9277; val_best_acc_score: 0.8995; val_best_f1_score: 0.9049; train_kl_reg_loss: 76949.0352; train_edge_recon_loss: 2703821.7197; train_gene_expr_recon_loss: 9952119.5303; train_masked_gp_l1_reg_loss: 83535.5135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26010.0537; train_chrom_access_recon_loss: 8630415.9545; train_global_loss: 21472851.6970; train_optim_loss: 21472851.6970; val_kl_reg_loss: 64419.5845; val_edge_recon_loss: 2756050.8125; val_gene_expr_recon_loss: 10021017.6250; val_masked_gp_l1_reg_loss: 83683.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25913.1094; val_chrom_access_recon_loss: 8654876.6250; val_global_loss: 21605960.5000; val_optim_loss: 21605960.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9490; val_auprc_score: 0.9239; val_best_acc_score: 0.9049; val_best_f1_score: 0.9097; train_kl_reg_loss: 75440.3314; train_edge_recon_loss: 2707240.4318; train_gene_expr_recon_loss: 9928900.2576; train_masked_gp_l1_reg_loss: 83807.6458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25812.1050; train_chrom_access_recon_loss: 8613995.0076; train_global_loss: 21435195.8788; train_optim_loss: 21435195.8788; val_kl_reg_loss: 64390.3374; val_edge_recon_loss: 2728957.7812; val_gene_expr_recon_loss: 10026313.3750; val_masked_gp_l1_reg_loss: 83972.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25633.5879; val_chrom_access_recon_loss: 8586769.0000; val_global_loss: 21516036.5000; val_optim_loss: 21516036.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9498; val_auprc_score: 0.9284; val_best_acc_score: 0.8984; val_best_f1_score: 0.9037; train_kl_reg_loss: 74406.6432; train_edge_recon_loss: 2697587.2462; train_gene_expr_recon_loss: 9907560.5758; train_masked_gp_l1_reg_loss: 84122.7831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25608.4394; train_chrom_access_recon_loss: 8586633.8485; train_global_loss: 21375919.4545; train_optim_loss: 21375919.4545; val_kl_reg_loss: 64250.4209; val_edge_recon_loss: 2757718.3438; val_gene_expr_recon_loss: 9951441.0000; val_masked_gp_l1_reg_loss: 84356.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25518.5586; val_chrom_access_recon_loss: 8641132.6250; val_global_loss: 21524417.5000; val_optim_loss: 21524417.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9530; val_auprc_score: 0.9335; val_best_acc_score: 0.9060; val_best_f1_score: 0.9098; train_kl_reg_loss: 72046.3430; train_edge_recon_loss: 2696680.2727; train_gene_expr_recon_loss: 9891595.6061; train_masked_gp_l1_reg_loss: 84542.4463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25412.1529; train_chrom_access_recon_loss: 8569523.8712; train_global_loss: 21339800.7273; train_optim_loss: 21339800.7273; val_kl_reg_loss: 64667.6396; val_edge_recon_loss: 2715338.9062; val_gene_expr_recon_loss: 9980346.7500; val_masked_gp_l1_reg_loss: 84721.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25325.5332; val_chrom_access_recon_loss: 8628000.2500; val_global_loss: 21498401.2500; val_optim_loss: 21498401.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9543; val_auprc_score: 0.9372; val_best_acc_score: 0.9038; val_best_f1_score: 0.9089; train_kl_reg_loss: 71880.4560; train_edge_recon_loss: 2685891.4356; train_gene_expr_recon_loss: 9875867.2879; train_masked_gp_l1_reg_loss: 84870.9119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25272.5893; train_chrom_access_recon_loss: 8555918.9621; train_global_loss: 21299701.6364; train_optim_loss: 21299701.6364; val_kl_reg_loss: 67329.7734; val_edge_recon_loss: 2717677.4375; val_gene_expr_recon_loss: 10039334.3750; val_masked_gp_l1_reg_loss: 85096.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25119.9551; val_chrom_access_recon_loss: 8652433.6250; val_global_loss: 21586991.7500; val_optim_loss: 21586991.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9521; val_auprc_score: 0.9313; val_best_acc_score: 0.9025; val_best_f1_score: 0.9079; train_kl_reg_loss: 70779.5891; train_edge_recon_loss: 2689664.7235; train_gene_expr_recon_loss: 9866010.6212; train_masked_gp_l1_reg_loss: 85224.6351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25052.3647; train_chrom_access_recon_loss: 8547354.9015; train_global_loss: 21284086.8788; train_optim_loss: 21284086.8788; val_kl_reg_loss: 65266.7349; val_edge_recon_loss: 2710721.3750; val_gene_expr_recon_loss: 9971648.5000; val_masked_gp_l1_reg_loss: 85399.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24951.3750; val_chrom_access_recon_loss: 8587560.5000; val_global_loss: 21445546.5000; val_optim_loss: 21445546.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9521; val_auprc_score: 0.9351; val_best_acc_score: 0.9006; val_best_f1_score: 0.9044; train_kl_reg_loss: 70978.2071; train_edge_recon_loss: 2686713.4167; train_gene_expr_recon_loss: 9839848.5606; train_masked_gp_l1_reg_loss: 85554.2147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24937.5483; train_chrom_access_recon_loss: 8518665.6515; train_global_loss: 21226697.5758; train_optim_loss: 21226697.5758; val_kl_reg_loss: 66597.4448; val_edge_recon_loss: 2743047.9688; val_gene_expr_recon_loss: 9965876.0000; val_masked_gp_l1_reg_loss: 85656.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24788.2773; val_chrom_access_recon_loss: 8590849.4375; val_global_loss: 21476815.7500; val_optim_loss: 21476815.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9536; val_auprc_score: 0.9274; val_best_acc_score: 0.9041; val_best_f1_score: 0.9073; train_kl_reg_loss: 69856.4815; train_edge_recon_loss: 2687999.6856; train_gene_expr_recon_loss: 9821148.9091; train_masked_gp_l1_reg_loss: 85789.5481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24778.9439; train_chrom_access_recon_loss: 8504495.9167; train_global_loss: 21194069.4848; train_optim_loss: 21194069.4848; val_kl_reg_loss: 67238.5425; val_edge_recon_loss: 2722740.9375; val_gene_expr_recon_loss: 9839441.8750; val_masked_gp_l1_reg_loss: 85978.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24705.6875; val_chrom_access_recon_loss: 8531215.5625; val_global_loss: 21271321.2500; val_optim_loss: 21271321.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9566; val_auprc_score: 0.9389; val_best_acc_score: 0.9046; val_best_f1_score: 0.9075; train_kl_reg_loss: 68958.5105; train_edge_recon_loss: 2695190.8371; train_gene_expr_recon_loss: 9810194.3636; train_masked_gp_l1_reg_loss: 86092.9762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24620.6756; train_chrom_access_recon_loss: 8483701.3030; train_global_loss: 21168758.7576; train_optim_loss: 21168758.7576; val_kl_reg_loss: 64389.4448; val_edge_recon_loss: 2736262.5000; val_gene_expr_recon_loss: 9876040.5000; val_masked_gp_l1_reg_loss: 86306.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24595.5938; val_chrom_access_recon_loss: 8539636.1250; val_global_loss: 21327230.7500; val_optim_loss: 21327230.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9511; val_auprc_score: 0.9237; val_best_acc_score: 0.9054; val_best_f1_score: 0.9097; train_kl_reg_loss: 68012.8875; train_edge_recon_loss: 2679972.7008; train_gene_expr_recon_loss: 9802777.7273; train_masked_gp_l1_reg_loss: 86436.7759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24532.4767; train_chrom_access_recon_loss: 8477898.4394; train_global_loss: 21139631.0303; train_optim_loss: 21139631.0303; val_kl_reg_loss: 66105.7324; val_edge_recon_loss: 2734746.4688; val_gene_expr_recon_loss: 10017242.8750; val_masked_gp_l1_reg_loss: 86555.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24454.7090; val_chrom_access_recon_loss: 8628559.1250; val_global_loss: 21557665.7500; val_optim_loss: 21557665.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9585; val_auprc_score: 0.9367; val_best_acc_score: 0.9092; val_best_f1_score: 0.9133; train_kl_reg_loss: 67011.3612; train_edge_recon_loss: 2680412.3712; train_gene_expr_recon_loss: 9793002.5000; train_masked_gp_l1_reg_loss: 86699.1740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24375.9676; train_chrom_access_recon_loss: 8460349.4318; train_global_loss: 21111850.9091; train_optim_loss: 21111850.9091; val_kl_reg_loss: 65202.8682; val_edge_recon_loss: 2689093.3125; val_gene_expr_recon_loss: 9882509.1250; val_masked_gp_l1_reg_loss: 86892.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24347.7363; val_chrom_access_recon_loss: 8483047.9375; val_global_loss: 21231093.5000; val_optim_loss: 21231093.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9608; val_auprc_score: 0.9447; val_best_acc_score: 0.9164; val_best_f1_score: 0.9187; train_kl_reg_loss: 66983.7421; train_edge_recon_loss: 2678025.4621; train_gene_expr_recon_loss: 9774058.6515; train_masked_gp_l1_reg_loss: 86943.1825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24251.4762; train_chrom_access_recon_loss: 8440316.6212; train_global_loss: 21070579.1515; train_optim_loss: 21070579.1515; val_kl_reg_loss: 65929.9858; val_edge_recon_loss: 2700769.3750; val_gene_expr_recon_loss: 9911986.0000; val_masked_gp_l1_reg_loss: 87087.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24210.2539; val_chrom_access_recon_loss: 8589146.0000; val_global_loss: 21379129.5000; val_optim_loss: 21379129.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9631; val_auprc_score: 0.9490; val_best_acc_score: 0.9167; val_best_f1_score: 0.9174; train_kl_reg_loss: 67258.9871; train_edge_recon_loss: 2669974.5417; train_gene_expr_recon_loss: 9764906.5909; train_masked_gp_l1_reg_loss: 87221.4676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24163.8329; train_chrom_access_recon_loss: 8431082.4318; train_global_loss: 21044607.7879; train_optim_loss: 21044607.7879; val_kl_reg_loss: 63034.8896; val_edge_recon_loss: 2727035.2812; val_gene_expr_recon_loss: 9901729.6250; val_masked_gp_l1_reg_loss: 87323.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24081.8027; val_chrom_access_recon_loss: 8541666.6250; val_global_loss: 21344872.2500; val_optim_loss: 21344872.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9564; val_auprc_score: 0.9373; val_best_acc_score: 0.9068; val_best_f1_score: 0.9105; train_kl_reg_loss: 67040.4007; train_edge_recon_loss: 2675059.7689; train_gene_expr_recon_loss: 9746268.2424; train_masked_gp_l1_reg_loss: 87466.9396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24058.3619; train_chrom_access_recon_loss: 8404985.1970; train_global_loss: 21004878.8182; train_optim_loss: 21004878.8182; val_kl_reg_loss: 64005.4980; val_edge_recon_loss: 2710419.6875; val_gene_expr_recon_loss: 9775060.6250; val_masked_gp_l1_reg_loss: 87630.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23984.5840; val_chrom_access_recon_loss: 8386894.8125; val_global_loss: 21047995.5000; val_optim_loss: 21047995.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9523; val_auprc_score: 0.9252; val_best_acc_score: 0.9049; val_best_f1_score: 0.9096; train_kl_reg_loss: 66511.6961; train_edge_recon_loss: 2669324.4356; train_gene_expr_recon_loss: 9746870.4091; train_masked_gp_l1_reg_loss: 87705.7396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23889.2969; train_chrom_access_recon_loss: 8404851.4091; train_global_loss: 20999152.9697; train_optim_loss: 20999152.9697; val_kl_reg_loss: 64747.7148; val_edge_recon_loss: 2733830.1562; val_gene_expr_recon_loss: 9871440.2500; val_masked_gp_l1_reg_loss: 87842.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23893.1914; val_chrom_access_recon_loss: 8460962.5000; val_global_loss: 21242716.5000; val_optim_loss: 21242716.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9597; val_auprc_score: 0.9445; val_best_acc_score: 0.9111; val_best_f1_score: 0.9148; train_kl_reg_loss: 65370.7775; train_edge_recon_loss: 2671864.1667; train_gene_expr_recon_loss: 9732120.0758; train_masked_gp_l1_reg_loss: 87982.7629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23818.2829; train_chrom_access_recon_loss: 8383599.8106; train_global_loss: 20964755.9091; train_optim_loss: 20964755.9091; val_kl_reg_loss: 62560.9038; val_edge_recon_loss: 2726819.3750; val_gene_expr_recon_loss: 9745467.6250; val_masked_gp_l1_reg_loss: 88173.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23855.1699; val_chrom_access_recon_loss: 8350861.4375; val_global_loss: 20997737.2500; val_optim_loss: 20997737.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9623; val_auprc_score: 0.9459; val_best_acc_score: 0.9167; val_best_f1_score: 0.9201; train_kl_reg_loss: 65480.6036; train_edge_recon_loss: 2671170.2917; train_gene_expr_recon_loss: 9720652.3182; train_masked_gp_l1_reg_loss: 88228.8603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23765.2362; train_chrom_access_recon_loss: 8377789.6894; train_global_loss: 20947087.0909; train_optim_loss: 20947087.0909; val_kl_reg_loss: 61392.5049; val_edge_recon_loss: 2684041.0938; val_gene_expr_recon_loss: 9873228.8750; val_masked_gp_l1_reg_loss: 88336.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23676.9922; val_chrom_access_recon_loss: 8447154.3750; val_global_loss: 21177830.0000; val_optim_loss: 21177830.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9571; val_auprc_score: 0.9370; val_best_acc_score: 0.9143; val_best_f1_score: 0.9183; train_kl_reg_loss: 64301.3970; train_edge_recon_loss: 2674736.6326; train_gene_expr_recon_loss: 9714502.1667; train_masked_gp_l1_reg_loss: 88457.1838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23662.1890; train_chrom_access_recon_loss: 8375177.2197; train_global_loss: 20940836.6667; train_optim_loss: 20940836.6667; val_kl_reg_loss: 64273.4478; val_edge_recon_loss: 2708680.0625; val_gene_expr_recon_loss: 9779951.2500; val_masked_gp_l1_reg_loss: 88518.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23634.3789; val_chrom_access_recon_loss: 8511314.0625; val_global_loss: 21176370.5000; val_optim_loss: 21176370.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9600; val_auprc_score: 0.9399; val_best_acc_score: 0.9175; val_best_f1_score: 0.9211; train_kl_reg_loss: 64683.7658; train_edge_recon_loss: 2674105.5644; train_gene_expr_recon_loss: 9704832.5909; train_masked_gp_l1_reg_loss: 88606.6396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23594.1855; train_chrom_access_recon_loss: 8357684.5076; train_global_loss: 20913507.2727; train_optim_loss: 20913507.2727; val_kl_reg_loss: 62256.2422; val_edge_recon_loss: 2724096.6562; val_gene_expr_recon_loss: 9820292.3750; val_masked_gp_l1_reg_loss: 88713.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23551.8730; val_chrom_access_recon_loss: 8384631.8750; val_global_loss: 21103542.7500; val_optim_loss: 21103542.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9610; val_auprc_score: 0.9378; val_best_acc_score: 0.9167; val_best_f1_score: 0.9204; train_kl_reg_loss: 64225.3720; train_edge_recon_loss: 2678208.7235; train_gene_expr_recon_loss: 9705661.2727; train_masked_gp_l1_reg_loss: 88849.3883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23462.8423; train_chrom_access_recon_loss: 8359088.0758; train_global_loss: 20919495.8485; train_optim_loss: 20919495.8485; val_kl_reg_loss: 62429.8354; val_edge_recon_loss: 2710770.3750; val_gene_expr_recon_loss: 9802879.0000; val_masked_gp_l1_reg_loss: 88917.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23238.6523; val_chrom_access_recon_loss: 8339703.3125; val_global_loss: 21027939.2500; val_optim_loss: 21027939.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9643; val_auprc_score: 0.9475; val_best_acc_score: 0.9159; val_best_f1_score: 0.9196; train_kl_reg_loss: 64480.4741; train_edge_recon_loss: 2677234.1250; train_gene_expr_recon_loss: 9686125.9242; train_masked_gp_l1_reg_loss: 88343.6036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21478.5848; train_chrom_access_recon_loss: 8336782.6288; train_global_loss: 20874445.4545; train_optim_loss: 20874445.4545; val_kl_reg_loss: 64049.5493; val_edge_recon_loss: 2695756.3750; val_gene_expr_recon_loss: 9933358.2500; val_masked_gp_l1_reg_loss: 88085.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21013.9590; val_chrom_access_recon_loss: 8437941.1250; val_global_loss: 21240204.2500; val_optim_loss: 21240204.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9635; val_auprc_score: 0.9446; val_best_acc_score: 0.9189; val_best_f1_score: 0.9224; train_kl_reg_loss: 65001.5724; train_edge_recon_loss: 2669900.5379; train_gene_expr_recon_loss: 9680899.3030; train_masked_gp_l1_reg_loss: 88012.8185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20893.8659; train_chrom_access_recon_loss: 8335879.5758; train_global_loss: 20860587.7576; train_optim_loss: 20860587.7576; val_kl_reg_loss: 63198.6680; val_edge_recon_loss: 2715533.6875; val_gene_expr_recon_loss: 9794071.0000; val_masked_gp_l1_reg_loss: 87970.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20798.6562; val_chrom_access_recon_loss: 8402879.6250; val_global_loss: 21084453.2500; val_optim_loss: 21084453.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9617; val_auprc_score: 0.9413; val_best_acc_score: 0.9170; val_best_f1_score: 0.9207; train_kl_reg_loss: 65036.3320; train_edge_recon_loss: 2670288.4811; train_gene_expr_recon_loss: 9680952.5909; train_masked_gp_l1_reg_loss: 87948.7002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20722.1333; train_chrom_access_recon_loss: 8327489.1667; train_global_loss: 20852437.3333; train_optim_loss: 20852437.3333; val_kl_reg_loss: 64233.7446; val_edge_recon_loss: 2684064.7500; val_gene_expr_recon_loss: 9732684.2500; val_masked_gp_l1_reg_loss: 87932.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20660.5371; val_chrom_access_recon_loss: 8439287.3125; val_global_loss: 21028863.7500; val_optim_loss: 21028863.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9617; val_auprc_score: 0.9484; val_best_acc_score: 0.9156; val_best_f1_score: 0.9194; train_kl_reg_loss: 65413.4493; train_edge_recon_loss: 2672235.7576; train_gene_expr_recon_loss: 9680012.1970; train_masked_gp_l1_reg_loss: 87927.8479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20613.0436; train_chrom_access_recon_loss: 8333661.5152; train_global_loss: 20859863.6667; train_optim_loss: 20859863.6667; val_kl_reg_loss: 64272.4067; val_edge_recon_loss: 2691724.2812; val_gene_expr_recon_loss: 9795325.1250; val_masked_gp_l1_reg_loss: 87921.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20570.7344; val_chrom_access_recon_loss: 8404234.7500; val_global_loss: 21064049.5000; val_optim_loss: 21064049.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 30 min 8 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9646
val AUPRC score: 0.9503
val best accuracy score: 0.9172
val best F1 score: 0.9209
val target rna MSE score: 1.3302
val source rna MSE score: 0.4304
val target atac MSE score: 0.3234
val source atac MSE score: 0.0730
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
