[True]
Run timestamp: 10082023_220229_68.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_68']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6846; val_auprc_score: 0.7304; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 131848.3281; train_edge_recon_loss: 3840877.3225; train_gene_expr_recon_loss: 45028301.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1381753.4866; train_global_loss: 50382781.1298; train_optim_loss: 50382781.1298; val_kl_reg_loss: 152913.0802; val_edge_recon_loss: 4065834.5667; val_gene_expr_recon_loss: 38705077.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1298582.0167; val_global_loss: 44222407.2000; val_optim_loss: 44222407.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7030; val_auprc_score: 0.7427; val_best_acc_score: 0.5032; val_best_f1_score: 0.6677; train_kl_reg_loss: 138150.0623; train_edge_recon_loss: 3765151.7672; train_gene_expr_recon_loss: 38722611.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1292861.4361; train_global_loss: 43918775.2977; train_optim_loss: 43918775.2977; val_kl_reg_loss: 87855.2484; val_edge_recon_loss: 4065039.6000; val_gene_expr_recon_loss: 38030417.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1288968.1500; val_global_loss: 43472280.0000; val_optim_loss: 43472280.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7509; val_auprc_score: 0.7767; val_best_acc_score: 0.6044; val_best_f1_score: 0.7020; train_kl_reg_loss: 162888.8946; train_edge_recon_loss: 3602482.6107; train_gene_expr_recon_loss: 37491976.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1275166.3073; train_global_loss: 42532513.9542; train_optim_loss: 42532513.9542; val_kl_reg_loss: 159309.5427; val_edge_recon_loss: 4059160.5333; val_gene_expr_recon_loss: 36994943.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1263273.8500; val_global_loss: 42476687.7333; val_optim_loss: 42476687.7333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8495; val_auprc_score: 0.8544; val_best_acc_score: 0.7696; val_best_f1_score: 0.7630; train_kl_reg_loss: 156469.6558; train_edge_recon_loss: 3549821.7786; train_gene_expr_recon_loss: 36807395.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1261117.5868; train_global_loss: 41774804.7023; train_optim_loss: 41774804.7023; val_kl_reg_loss: 145633.7396; val_edge_recon_loss: 4019296.3500; val_gene_expr_recon_loss: 36592516.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1257979.8750; val_global_loss: 42015426.9333; val_optim_loss: 42015426.9333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8967; val_auprc_score: 0.8893; val_best_acc_score: 0.8111; val_best_f1_score: 0.8284; train_kl_reg_loss: 137951.8297; train_edge_recon_loss: 3511596.3378; train_gene_expr_recon_loss: 36423188.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1255904.8492; train_global_loss: 41328642.0153; train_optim_loss: 41328642.0153; val_kl_reg_loss: 120691.4479; val_edge_recon_loss: 3648828.2667; val_gene_expr_recon_loss: 36315300.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1253400.9667; val_global_loss: 41338221.8667; val_optim_loss: 41338221.8667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8823; val_auprc_score: 0.8710; val_best_acc_score: 0.7953; val_best_f1_score: 0.8105; train_kl_reg_loss: 147365.1212; train_edge_recon_loss: 3146248.8511; train_gene_expr_recon_loss: 36185619.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1249764.1431; train_global_loss: 40728997.4656; train_optim_loss: 40728997.4656; val_kl_reg_loss: 163253.7729; val_edge_recon_loss: 3081525.0667; val_gene_expr_recon_loss: 35997044.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1247318.8333; val_global_loss: 40489141.6000; val_optim_loss: 40489141.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8920; val_auprc_score: 0.8802; val_best_acc_score: 0.8072; val_best_f1_score: 0.8224; train_kl_reg_loss: 167686.2053; train_edge_recon_loss: 3002599.8244; train_gene_expr_recon_loss: 35961393.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1245331.2805; train_global_loss: 40377010.3817; train_optim_loss: 40377010.3817; val_kl_reg_loss: 165007.7062; val_edge_recon_loss: 2997252.6833; val_gene_expr_recon_loss: 35932485.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1248053.0250; val_global_loss: 40342798.4000; val_optim_loss: 40342798.4000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9086; val_auprc_score: 0.8981; val_best_acc_score: 0.8293; val_best_f1_score: 0.8406; train_kl_reg_loss: 159833.6660; train_edge_recon_loss: 2972317.7939; train_gene_expr_recon_loss: 35728161.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1238994.4532; train_global_loss: 40099307.8473; train_optim_loss: 40099307.8473; val_kl_reg_loss: 152872.3104; val_edge_recon_loss: 2937803.4000; val_gene_expr_recon_loss: 35821403.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1244214.8167; val_global_loss: 40156293.3333; val_optim_loss: 40156293.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9187; val_auprc_score: 0.9079; val_best_acc_score: 0.8389; val_best_f1_score: 0.8522; train_kl_reg_loss: 152012.9014; train_edge_recon_loss: 2940224.4332; train_gene_expr_recon_loss: 35557560.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1234846.2929; train_global_loss: 39884643.8168; train_optim_loss: 39884643.8168; val_kl_reg_loss: 147259.8927; val_edge_recon_loss: 2922466.7333; val_gene_expr_recon_loss: 35407933.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1236546.1500; val_global_loss: 39714206.6667; val_optim_loss: 39714206.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9205; val_auprc_score: 0.9058; val_best_acc_score: 0.8472; val_best_f1_score: 0.8594; train_kl_reg_loss: 149675.1633; train_edge_recon_loss: 2890839.8740; train_gene_expr_recon_loss: 35378493.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1229575.2595; train_global_loss: 39648583.8168; train_optim_loss: 39648583.8168; val_kl_reg_loss: 147452.4604; val_edge_recon_loss: 2894452.0667; val_gene_expr_recon_loss: 35384012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1230664.1333; val_global_loss: 39656581.3333; val_optim_loss: 39656581.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9301; val_auprc_score: 0.9140; val_best_acc_score: 0.8643; val_best_f1_score: 0.8745; train_kl_reg_loss: 147312.9616; train_edge_recon_loss: 2868876.1279; train_gene_expr_recon_loss: 35254861.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1227635.5897; train_global_loss: 39498686.2290; train_optim_loss: 39498686.2290; val_kl_reg_loss: 148579.1562; val_edge_recon_loss: 2843490.3333; val_gene_expr_recon_loss: 35197581.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1228142.5333; val_global_loss: 39417793.6000; val_optim_loss: 39417793.6000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9296; val_auprc_score: 0.9158; val_best_acc_score: 0.8600; val_best_f1_score: 0.8682; train_kl_reg_loss: 144104.1205; train_edge_recon_loss: 2862288.4103; train_gene_expr_recon_loss: 35136522.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1224531.2548; train_global_loss: 39367446.1985; train_optim_loss: 39367446.1985; val_kl_reg_loss: 138966.3458; val_edge_recon_loss: 2884602.5333; val_gene_expr_recon_loss: 34977263.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1222069.0333; val_global_loss: 39222901.0667; val_optim_loss: 39222901.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9369; val_auprc_score: 0.9232; val_best_acc_score: 0.8743; val_best_f1_score: 0.8819; train_kl_reg_loss: 140711.3718; train_edge_recon_loss: 2855137.7939; train_gene_expr_recon_loss: 35054479.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1221836.1097; train_global_loss: 39272164.9466; train_optim_loss: 39272164.9466; val_kl_reg_loss: 133672.3547; val_edge_recon_loss: 2865286.2833; val_gene_expr_recon_loss: 35180252.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1229336.6000; val_global_loss: 39408548.0000; val_optim_loss: 39408548.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9447; val_auprc_score: 0.9354; val_best_acc_score: 0.8779; val_best_f1_score: 0.8847; train_kl_reg_loss: 134532.8219; train_edge_recon_loss: 2833390.7347; train_gene_expr_recon_loss: 34975817.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1220907.9761; train_global_loss: 39164649.5267; train_optim_loss: 39164649.5267; val_kl_reg_loss: 132400.4297; val_edge_recon_loss: 2831522.6500; val_gene_expr_recon_loss: 34942279.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1225733.1333; val_global_loss: 39131936.5333; val_optim_loss: 39131936.5333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9470; val_auprc_score: 0.9383; val_best_acc_score: 0.8797; val_best_f1_score: 0.8841; train_kl_reg_loss: 132062.7851; train_edge_recon_loss: 2829206.1527; train_gene_expr_recon_loss: 34900697.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1218946.3120; train_global_loss: 39080912.6107; train_optim_loss: 39080912.6107; val_kl_reg_loss: 134524.6833; val_edge_recon_loss: 2827392.3500; val_gene_expr_recon_loss: 34926172.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1218382.0500; val_global_loss: 39106472.8000; val_optim_loss: 39106472.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9507; val_auprc_score: 0.9416; val_best_acc_score: 0.8853; val_best_f1_score: 0.8899; train_kl_reg_loss: 127673.2445; train_edge_recon_loss: 2808403.7767; train_gene_expr_recon_loss: 34792168.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1216472.3406; train_global_loss: 38944717.4962; train_optim_loss: 38944717.4962; val_kl_reg_loss: 123620.5620; val_edge_recon_loss: 2808583.2000; val_gene_expr_recon_loss: 34822195.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1216865.8500; val_global_loss: 38971265.6000; val_optim_loss: 38971265.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9563; val_auprc_score: 0.9491; val_best_acc_score: 0.8925; val_best_f1_score: 0.8981; train_kl_reg_loss: 125548.5369; train_edge_recon_loss: 2803306.5248; train_gene_expr_recon_loss: 34702464.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1214251.6594; train_global_loss: 38845570.8092; train_optim_loss: 38845570.8092; val_kl_reg_loss: 123282.0625; val_edge_recon_loss: 2802882.3667; val_gene_expr_recon_loss: 34739553.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1215929.6500; val_global_loss: 38881647.4667; val_optim_loss: 38881647.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9547; val_auprc_score: 0.9461; val_best_acc_score: 0.8934; val_best_f1_score: 0.8974; train_kl_reg_loss: 123294.2986; train_edge_recon_loss: 2789410.8015; train_gene_expr_recon_loss: 34641397.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1213617.4399; train_global_loss: 38767720.1527; train_optim_loss: 38767720.1527; val_kl_reg_loss: 121703.4557; val_edge_recon_loss: 2795263.3167; val_gene_expr_recon_loss: 34624942.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1214248.9583; val_global_loss: 38756158.4000; val_optim_loss: 38756158.4000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9601; val_auprc_score: 0.9517; val_best_acc_score: 0.9019; val_best_f1_score: 0.9060; train_kl_reg_loss: 120135.3305; train_edge_recon_loss: 2783243.4962; train_gene_expr_recon_loss: 34575613.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1212947.1842; train_global_loss: 38691939.0229; train_optim_loss: 38691939.0229; val_kl_reg_loss: 117570.5188; val_edge_recon_loss: 2766655.6500; val_gene_expr_recon_loss: 34579676.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1214239.8917; val_global_loss: 38678142.6667; val_optim_loss: 38678142.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9639; val_auprc_score: 0.9562; val_best_acc_score: 0.9069; val_best_f1_score: 0.9075; train_kl_reg_loss: 118031.2241; train_edge_recon_loss: 2774242.0000; train_gene_expr_recon_loss: 34524304.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1211248.6985; train_global_loss: 38627826.2290; train_optim_loss: 38627826.2290; val_kl_reg_loss: 116098.9089; val_edge_recon_loss: 2793641.3833; val_gene_expr_recon_loss: 34642577.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1214827.2333; val_global_loss: 38767144.0000; val_optim_loss: 38767144.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9699; val_auprc_score: 0.9639; val_best_acc_score: 0.9140; val_best_f1_score: 0.9162; train_kl_reg_loss: 115774.3579; train_edge_recon_loss: 2771929.2080; train_gene_expr_recon_loss: 34470107.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1211002.5391; train_global_loss: 38568812.7939; train_optim_loss: 38568812.7939; val_kl_reg_loss: 115615.1891; val_edge_recon_loss: 2760088.5500; val_gene_expr_recon_loss: 34462534.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1210211.8750; val_global_loss: 38548449.8667; val_optim_loss: 38548449.8667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9644; val_auprc_score: 0.9572; val_best_acc_score: 0.9045; val_best_f1_score: 0.9078; train_kl_reg_loss: 115432.2289; train_edge_recon_loss: 2758709.2481; train_gene_expr_recon_loss: 34428030.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1210554.6594; train_global_loss: 38512726.8092; train_optim_loss: 38512726.8092; val_kl_reg_loss: 116290.5318; val_edge_recon_loss: 2798715.4833; val_gene_expr_recon_loss: 34606669.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1217803.4750; val_global_loss: 38739479.7333; val_optim_loss: 38739479.7333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9689; val_auprc_score: 0.9595; val_best_acc_score: 0.9170; val_best_f1_score: 0.9193; train_kl_reg_loss: 112601.6016; train_edge_recon_loss: 2758867.4656; train_gene_expr_recon_loss: 34402935.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1210125.0229; train_global_loss: 38484529.5573; train_optim_loss: 38484529.5573; val_kl_reg_loss: 109769.3615; val_edge_recon_loss: 2772601.0333; val_gene_expr_recon_loss: 34349726.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1209871.8333; val_global_loss: 38441969.3333; val_optim_loss: 38441969.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9712; val_auprc_score: 0.9646; val_best_acc_score: 0.9184; val_best_f1_score: 0.9209; train_kl_reg_loss: 111863.7693; train_edge_recon_loss: 2749484.9218; train_gene_expr_recon_loss: 34261655.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1207062.5611; train_global_loss: 38330066.9924; train_optim_loss: 38330066.9924; val_kl_reg_loss: 109710.2547; val_edge_recon_loss: 2752589.7000; val_gene_expr_recon_loss: 34463151.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1208358.9417; val_global_loss: 38533810.4000; val_optim_loss: 38533810.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9713; val_auprc_score: 0.9640; val_best_acc_score: 0.9213; val_best_f1_score: 0.9241; train_kl_reg_loss: 109930.3099; train_edge_recon_loss: 2739341.2595; train_gene_expr_recon_loss: 34256876.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1208404.1441; train_global_loss: 38314552.3969; train_optim_loss: 38314552.3969; val_kl_reg_loss: 108138.7797; val_edge_recon_loss: 2747010.1167; val_gene_expr_recon_loss: 34350906.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1207721.9083; val_global_loss: 38413776.5333; val_optim_loss: 38413776.5333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9239; val_auprc_score: 0.9028; val_best_acc_score: 0.8601; val_best_f1_score: 0.8707; train_kl_reg_loss: 126356.7110; train_edge_recon_loss: 2982878.3912; train_gene_expr_recon_loss: 41533904.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1277248.5544; train_global_loss: 45920387.9695; train_optim_loss: 45920387.9695; val_kl_reg_loss: 11898.5350; val_edge_recon_loss: 2901488.4167; val_gene_expr_recon_loss: 40974205.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1271111.9750; val_global_loss: 45158703.7333; val_optim_loss: 45158703.7333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9284; val_auprc_score: 0.9079; val_best_acc_score: 0.8700; val_best_f1_score: 0.8760; train_kl_reg_loss: 92354.6709; train_edge_recon_loss: 2827764.9561; train_gene_expr_recon_loss: 40500409.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1264785.8263; train_global_loss: 44685314.9618; train_optim_loss: 44685314.9618; val_kl_reg_loss: 14032.7339; val_edge_recon_loss: 2820138.7000; val_gene_expr_recon_loss: 40098207.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1262863.1750; val_global_loss: 44195242.4000; val_optim_loss: 44195242.4000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9353; val_auprc_score: 0.9140; val_best_acc_score: 0.8804; val_best_f1_score: 0.8862; train_kl_reg_loss: 57824.5401; train_edge_recon_loss: 2780279.9313; train_gene_expr_recon_loss: 39851626.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1259368.6002; train_global_loss: 43949099.2977; train_optim_loss: 43949099.2977; val_kl_reg_loss: 18002.2370; val_edge_recon_loss: 2739706.7500; val_gene_expr_recon_loss: 39673763.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1262288.5917; val_global_loss: 43693760.5333; val_optim_loss: 43693760.5333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9357; val_auprc_score: 0.9179; val_best_acc_score: 0.8739; val_best_f1_score: 0.8803; train_kl_reg_loss: 45869.9858; train_edge_recon_loss: 2748280.6718; train_gene_expr_recon_loss: 39387525.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1256489.9990; train_global_loss: 43438166.1374; train_optim_loss: 43438166.1374; val_kl_reg_loss: 20261.9857; val_edge_recon_loss: 2762383.2167; val_gene_expr_recon_loss: 39212618.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1256581.5833; val_global_loss: 43251845.6000; val_optim_loss: 43251845.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9350; val_auprc_score: 0.9143; val_best_acc_score: 0.8777; val_best_f1_score: 0.8832; train_kl_reg_loss: 40660.2737; train_edge_recon_loss: 2753361.7061; train_gene_expr_recon_loss: 39134485.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1253442.7805; train_global_loss: 43181949.6794; train_optim_loss: 43181949.6794; val_kl_reg_loss: 20939.1922; val_edge_recon_loss: 2732969.8000; val_gene_expr_recon_loss: 39099510.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1253954.9750; val_global_loss: 43107374.6667; val_optim_loss: 43107374.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9325; val_auprc_score: 0.9125; val_best_acc_score: 0.8764; val_best_f1_score: 0.8820; train_kl_reg_loss: 41204.3796; train_edge_recon_loss: 2744556.9466; train_gene_expr_recon_loss: 39118142.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1253834.5458; train_global_loss: 43157738.5954; train_optim_loss: 43157738.5954; val_kl_reg_loss: 21892.2023; val_edge_recon_loss: 2740502.4833; val_gene_expr_recon_loss: 39049699.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1248910.5250; val_global_loss: 43061005.0667; val_optim_loss: 43061005.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9321; val_auprc_score: 0.9121; val_best_acc_score: 0.8747; val_best_f1_score: 0.8833; train_kl_reg_loss: 41617.3593; train_edge_recon_loss: 2742697.1221; train_gene_expr_recon_loss: 39100550.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1253767.0677; train_global_loss: 43138632.2748; train_optim_loss: 43138632.2748; val_kl_reg_loss: 22513.5957; val_edge_recon_loss: 2765046.0333; val_gene_expr_recon_loss: 39005949.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1252779.8833; val_global_loss: 43046288.2667; val_optim_loss: 43046288.2667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9356; val_auprc_score: 0.9163; val_best_acc_score: 0.8775; val_best_f1_score: 0.8835; train_kl_reg_loss: 41369.2572; train_edge_recon_loss: 2728398.4218; train_gene_expr_recon_loss: 39031534.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1251303.8960; train_global_loss: 43052605.7099; train_optim_loss: 43052605.7099; val_kl_reg_loss: 22725.6702; val_edge_recon_loss: 2735366.4500; val_gene_expr_recon_loss: 38948679.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1251227.1250; val_global_loss: 42957998.9333; val_optim_loss: 42957998.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 44 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9675
val AUPRC score: 0.9557
val best accuracy score: 0.9173
val best F1 score: 0.9208
val target rna MSE score: 1.5712
val source rna MSE score: 45.6542
val target atac MSE score: 0.6107
val source atac MSE score: 9.5785
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
