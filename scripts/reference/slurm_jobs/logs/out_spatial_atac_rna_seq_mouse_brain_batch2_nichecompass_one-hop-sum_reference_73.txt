[True]
Run timestamp: 10082023_221521_73.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_73']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7930; val_auprc_score: 0.8012; val_best_acc_score: 0.5745; val_best_f1_score: 0.6983; train_kl_reg_loss: 220785.7910; train_edge_recon_loss: 3710020.5019; train_gene_expr_recon_loss: 50094168.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 78085021.0992; train_global_loss: 132109996.0916; train_optim_loss: 132109996.0916; val_kl_reg_loss: 143415.3823; val_edge_recon_loss: 4061342.2167; val_gene_expr_recon_loss: 39117645.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 69065376.0000; val_global_loss: 112387779.2000; val_optim_loss: 112387779.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7771; val_auprc_score: 0.7923; val_best_acc_score: 0.6452; val_best_f1_score: 0.7207; train_kl_reg_loss: 165090.0524; train_edge_recon_loss: 3775397.2176; train_gene_expr_recon_loss: 38594509.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 69646564.8550; train_global_loss: 112181560.8550; train_optim_loss: 112181560.8550; val_kl_reg_loss: 353979.3531; val_edge_recon_loss: 4057383.1667; val_gene_expr_recon_loss: 37298647.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68343529.8667; val_global_loss: 110053539.7333; val_optim_loss: 110053539.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8244; val_auprc_score: 0.8366; val_best_acc_score: 0.7409; val_best_f1_score: 0.7278; train_kl_reg_loss: 178042.1549; train_edge_recon_loss: 3639371.3149; train_gene_expr_recon_loss: 37569357.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68972629.4351; train_global_loss: 110359401.0382; train_optim_loss: 110359401.0382; val_kl_reg_loss: 117112.3625; val_edge_recon_loss: 4032856.6500; val_gene_expr_recon_loss: 36987144.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68334172.8000; val_global_loss: 109471286.9333; val_optim_loss: 109471286.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8556; val_auprc_score: 0.8593; val_best_acc_score: 0.7607; val_best_f1_score: 0.7822; train_kl_reg_loss: 160359.8895; train_edge_recon_loss: 3592094.4866; train_gene_expr_recon_loss: 37475455.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68900363.5115; train_global_loss: 110128273.5267; train_optim_loss: 110128273.5267; val_kl_reg_loss: 152102.7885; val_edge_recon_loss: 3919038.2000; val_gene_expr_recon_loss: 36509612.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67813018.6667; val_global_loss: 108393772.2667; val_optim_loss: 108393772.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8739; val_auprc_score: 0.8678; val_best_acc_score: 0.7860; val_best_f1_score: 0.7986; train_kl_reg_loss: 138693.4281; train_edge_recon_loss: 3424071.8645; train_gene_expr_recon_loss: 36700747.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68155894.2901; train_global_loss: 108419407.1450; train_optim_loss: 108419407.1450; val_kl_reg_loss: 144688.9740; val_edge_recon_loss: 3229049.4167; val_gene_expr_recon_loss: 36364645.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67525671.2000; val_global_loss: 107264053.8667; val_optim_loss: 107264053.8667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8808; val_auprc_score: 0.8698; val_best_acc_score: 0.7933; val_best_f1_score: 0.8127; train_kl_reg_loss: 179826.5508; train_edge_recon_loss: 3081047.4256; train_gene_expr_recon_loss: 36435627.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67800616.0611; train_global_loss: 107497117.8015; train_optim_loss: 107497117.8015; val_kl_reg_loss: 190114.9906; val_edge_recon_loss: 3051514.3167; val_gene_expr_recon_loss: 35972552.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67025554.6667; val_global_loss: 106239737.0667; val_optim_loss: 106239737.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8885; val_auprc_score: 0.8785; val_best_acc_score: 0.8015; val_best_f1_score: 0.8231; train_kl_reg_loss: 184540.4467; train_edge_recon_loss: 3007892.6298; train_gene_expr_recon_loss: 36185690.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67353205.3740; train_global_loss: 106731328.9771; train_optim_loss: 106731328.9771; val_kl_reg_loss: 183296.0771; val_edge_recon_loss: 2995278.6333; val_gene_expr_recon_loss: 35778405.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66777532.0000; val_global_loss: 105734512.5333; val_optim_loss: 105734512.5333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8977; val_auprc_score: 0.8866; val_best_acc_score: 0.8134; val_best_f1_score: 0.8317; train_kl_reg_loss: 177153.6344; train_edge_recon_loss: 2967436.9504; train_gene_expr_recon_loss: 35980827.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66988364.2748; train_global_loss: 106113782.1069; train_optim_loss: 106113782.1069; val_kl_reg_loss: 171809.5667; val_edge_recon_loss: 2955728.6000; val_gene_expr_recon_loss: 35631758.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66655732.0000; val_global_loss: 105415028.8000; val_optim_loss: 105415028.8000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9013; val_auprc_score: 0.8889; val_best_acc_score: 0.8160; val_best_f1_score: 0.8333; train_kl_reg_loss: 169074.5495; train_edge_recon_loss: 2943339.8187; train_gene_expr_recon_loss: 35813401.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66758145.3435; train_global_loss: 105683961.8321; train_optim_loss: 105683961.8321; val_kl_reg_loss: 165299.3948; val_edge_recon_loss: 2969525.5667; val_gene_expr_recon_loss: 35441583.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65865049.6000; val_global_loss: 104441458.1333; val_optim_loss: 104441458.1333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9080; val_auprc_score: 0.8932; val_best_acc_score: 0.8267; val_best_f1_score: 0.8424; train_kl_reg_loss: 167422.1343; train_edge_recon_loss: 2903469.4389; train_gene_expr_recon_loss: 35619492.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66302601.7405; train_global_loss: 104992985.9542; train_optim_loss: 104992985.9542; val_kl_reg_loss: 164518.1625; val_edge_recon_loss: 2898775.8833; val_gene_expr_recon_loss: 35215052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65676039.4667; val_global_loss: 103954386.1333; val_optim_loss: 103954386.1333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9130; val_auprc_score: 0.8976; val_best_acc_score: 0.8325; val_best_f1_score: 0.8456; train_kl_reg_loss: 162747.4302; train_edge_recon_loss: 2893362.4370; train_gene_expr_recon_loss: 35537025.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66256920.0000; train_global_loss: 104850055.1450; train_optim_loss: 104850055.1450; val_kl_reg_loss: 157385.4677; val_edge_recon_loss: 2915420.1667; val_gene_expr_recon_loss: 35082668.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65397792.2667; val_global_loss: 103553266.6667; val_optim_loss: 103553266.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9260; val_auprc_score: 0.9142; val_best_acc_score: 0.8502; val_best_f1_score: 0.8582; train_kl_reg_loss: 157828.4734; train_edge_recon_loss: 2885615.7729; train_gene_expr_recon_loss: 35429263.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66083459.1450; train_global_loss: 104556167.1450; train_optim_loss: 104556167.1450; val_kl_reg_loss: 154773.8740; val_edge_recon_loss: 2885869.6000; val_gene_expr_recon_loss: 34953495.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64974288.8000; val_global_loss: 102968428.8000; val_optim_loss: 102968428.8000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9325; val_auprc_score: 0.9212; val_best_acc_score: 0.8556; val_best_f1_score: 0.8641; train_kl_reg_loss: 155221.0357; train_edge_recon_loss: 2864309.3454; train_gene_expr_recon_loss: 35306690.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65792763.8168; train_global_loss: 104118984.7939; train_optim_loss: 104118984.7939; val_kl_reg_loss: 144066.2292; val_edge_recon_loss: 2869931.5667; val_gene_expr_recon_loss: 35003147.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65278100.8000; val_global_loss: 103295246.4000; val_optim_loss: 103295246.4000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9327; val_auprc_score: 0.9219; val_best_acc_score: 0.8569; val_best_f1_score: 0.8632; train_kl_reg_loss: 150222.0134; train_edge_recon_loss: 2868581.7691; train_gene_expr_recon_loss: 35286135.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65455202.1069; train_global_loss: 103760141.0687; train_optim_loss: 103760141.0687; val_kl_reg_loss: 141965.9312; val_edge_recon_loss: 2870097.3333; val_gene_expr_recon_loss: 34963317.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64998465.3333; val_global_loss: 102973844.8000; val_optim_loss: 102973844.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9346; val_auprc_score: 0.9215; val_best_acc_score: 0.8584; val_best_f1_score: 0.8685; train_kl_reg_loss: 148856.3557; train_edge_recon_loss: 2846470.2405; train_gene_expr_recon_loss: 35090281.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65267353.8626; train_global_loss: 103352962.3817; train_optim_loss: 103352962.3817; val_kl_reg_loss: 150316.5042; val_edge_recon_loss: 2858980.8833; val_gene_expr_recon_loss: 34758090.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64493821.8667; val_global_loss: 102261210.1333; val_optim_loss: 102261210.1333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9342; val_auprc_score: 0.9228; val_best_acc_score: 0.8607; val_best_f1_score: 0.8712; train_kl_reg_loss: 146090.3650; train_edge_recon_loss: 2849842.0611; train_gene_expr_recon_loss: 35199428.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65492224.7023; train_global_loss: 103687585.7099; train_optim_loss: 103687585.7099; val_kl_reg_loss: 120691.7229; val_edge_recon_loss: 2889881.4667; val_gene_expr_recon_loss: 35122565.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65144995.2000; val_global_loss: 103278133.3333; val_optim_loss: 103278133.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9394; val_auprc_score: 0.9268; val_best_acc_score: 0.8696; val_best_f1_score: 0.8776; train_kl_reg_loss: 142021.4186; train_edge_recon_loss: 2849974.4981; train_gene_expr_recon_loss: 35026960.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65095234.8397; train_global_loss: 103114191.8779; train_optim_loss: 103114191.8779; val_kl_reg_loss: 136919.7630; val_edge_recon_loss: 2843161.9500; val_gene_expr_recon_loss: 34685748.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64162517.0667; val_global_loss: 101828346.1333; val_optim_loss: 101828346.1333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9423; val_auprc_score: 0.9326; val_best_acc_score: 0.8723; val_best_f1_score: 0.8786; train_kl_reg_loss: 145831.4829; train_edge_recon_loss: 2819505.5172; train_gene_expr_recon_loss: 35020769.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65020658.3206; train_global_loss: 103006765.1298; train_optim_loss: 103006765.1298; val_kl_reg_loss: 147076.3396; val_edge_recon_loss: 2843040.3333; val_gene_expr_recon_loss: 34709374.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64485937.8667; val_global_loss: 102185429.8667; val_optim_loss: 102185429.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9476; val_auprc_score: 0.9394; val_best_acc_score: 0.8813; val_best_f1_score: 0.8865; train_kl_reg_loss: 150483.5606; train_edge_recon_loss: 2826083.9141; train_gene_expr_recon_loss: 35006834.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64971348.3664; train_global_loss: 102954750.8397; train_optim_loss: 102954750.8397; val_kl_reg_loss: 167666.6125; val_edge_recon_loss: 2817756.8000; val_gene_expr_recon_loss: 34946878.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64583975.7333; val_global_loss: 102516278.4000; val_optim_loss: 102516278.4000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9352; val_auprc_score: 0.9224; val_best_acc_score: 0.8661; val_best_f1_score: 0.8729; train_kl_reg_loss: 174938.5716; train_edge_recon_loss: 2839855.1851; train_gene_expr_recon_loss: 35475256.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65130612.1221; train_global_loss: 103620661.9847; train_optim_loss: 103620661.9847; val_kl_reg_loss: 150287.7854; val_edge_recon_loss: 2849530.0333; val_gene_expr_recon_loss: 35114194.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65107602.1333; val_global_loss: 103221613.8667; val_optim_loss: 103221613.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9441; val_auprc_score: 0.9306; val_best_acc_score: 0.8794; val_best_f1_score: 0.8862; train_kl_reg_loss: 142119.6399; train_edge_recon_loss: 2808163.4599; train_gene_expr_recon_loss: 35205538.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64923935.3588; train_global_loss: 103079757.4351; train_optim_loss: 103079757.4351; val_kl_reg_loss: 146240.4542; val_edge_recon_loss: 2816033.6833; val_gene_expr_recon_loss: 34447014.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63806883.4667; val_global_loss: 101216172.2667; val_optim_loss: 101216172.2667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9492; val_auprc_score: 0.9388; val_best_acc_score: 0.8861; val_best_f1_score: 0.8907; train_kl_reg_loss: 145333.5796; train_edge_recon_loss: 2792067.6927; train_gene_expr_recon_loss: 34755723.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64586474.3817; train_global_loss: 102279599.5115; train_optim_loss: 102279599.5115; val_kl_reg_loss: 142772.0958; val_edge_recon_loss: 2774757.7333; val_gene_expr_recon_loss: 34444637.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63997258.6667; val_global_loss: 101359425.6000; val_optim_loss: 101359425.6000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9557; val_auprc_score: 0.9485; val_best_acc_score: 0.8891; val_best_f1_score: 0.8932; train_kl_reg_loss: 140367.3510; train_edge_recon_loss: 2784604.5611; train_gene_expr_recon_loss: 34715443.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64508371.1756; train_global_loss: 102148787.0534; train_optim_loss: 102148787.0534; val_kl_reg_loss: 135247.7052; val_edge_recon_loss: 2783774.7667; val_gene_expr_recon_loss: 34284446.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63321926.1333; val_global_loss: 100525395.2000; val_optim_loss: 100525395.2000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9509; val_auprc_score: 0.9412; val_best_acc_score: 0.8857; val_best_f1_score: 0.8902; train_kl_reg_loss: 134100.4945; train_edge_recon_loss: 2793264.2615; train_gene_expr_recon_loss: 34647652.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64334735.2366; train_global_loss: 101909752.3664; train_optim_loss: 101909752.3664; val_kl_reg_loss: 133392.8073; val_edge_recon_loss: 2802949.7833; val_gene_expr_recon_loss: 34265881.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63282550.4000; val_global_loss: 100484772.8000; val_optim_loss: 100484772.8000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9473; val_auprc_score: 0.9362; val_best_acc_score: 0.8816; val_best_f1_score: 0.8886; train_kl_reg_loss: 130090.8961; train_edge_recon_loss: 2793531.9008; train_gene_expr_recon_loss: 34906257.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64447896.4580; train_global_loss: 102277776.8550; train_optim_loss: 102277776.8550; val_kl_reg_loss: 125381.3198; val_edge_recon_loss: 2803121.9167; val_gene_expr_recon_loss: 34389352.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63722032.2667; val_global_loss: 101039889.0667; val_optim_loss: 101039889.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9527; val_auprc_score: 0.9460; val_best_acc_score: 0.8837; val_best_f1_score: 0.8884; train_kl_reg_loss: 140162.4927; train_edge_recon_loss: 2819191.2615; train_gene_expr_recon_loss: 35777171.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64875784.0916; train_global_loss: 103612309.9237; train_optim_loss: 103612309.9237; val_kl_reg_loss: 101351.5964; val_edge_recon_loss: 2829189.6167; val_gene_expr_recon_loss: 34808172.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63799355.4667; val_global_loss: 101538068.8000; val_optim_loss: 101538068.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9521; val_auprc_score: 0.9424; val_best_acc_score: 0.8870; val_best_f1_score: 0.8930; train_kl_reg_loss: 145198.7934; train_edge_recon_loss: 2791968.1546; train_gene_expr_recon_loss: 35102873.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64544261.4656; train_global_loss: 102584301.6183; train_optim_loss: 102584301.6183; val_kl_reg_loss: 96781.0630; val_edge_recon_loss: 2800933.6000; val_gene_expr_recon_loss: 34774919.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63888186.4000; val_global_loss: 101560821.3333; val_optim_loss: 101560821.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9574; val_auprc_score: 0.9490; val_best_acc_score: 0.8960; val_best_f1_score: 0.9006; train_kl_reg_loss: 139153.0314; train_edge_recon_loss: 2784975.9637; train_gene_expr_recon_loss: 35160540.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64631014.7481; train_global_loss: 102715683.9084; train_optim_loss: 102715683.9084; val_kl_reg_loss: 92960.5333; val_edge_recon_loss: 2789102.6667; val_gene_expr_recon_loss: 34745023.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63771615.7333; val_global_loss: 101398701.8667; val_optim_loss: 101398701.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9570; val_auprc_score: 0.9494; val_best_acc_score: 0.8937; val_best_f1_score: 0.8980; train_kl_reg_loss: 135285.7708; train_edge_recon_loss: 2775954.4656; train_gene_expr_recon_loss: 35058820.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64450896.8244; train_global_loss: 102420957.7405; train_optim_loss: 102420957.7405; val_kl_reg_loss: 94172.2505; val_edge_recon_loss: 2792224.4833; val_gene_expr_recon_loss: 34771410.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63796898.4000; val_global_loss: 101454705.6000; val_optim_loss: 101454705.6000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9567; val_auprc_score: 0.9469; val_best_acc_score: 0.8979; val_best_f1_score: 0.9012; train_kl_reg_loss: 134879.2492; train_edge_recon_loss: 2778764.3397; train_gene_expr_recon_loss: 35099036.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64343632.8244; train_global_loss: 102356312.9771; train_optim_loss: 102356312.9771; val_kl_reg_loss: 94221.2312; val_edge_recon_loss: 2776936.0000; val_gene_expr_recon_loss: 35016597.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64092961.3333; val_global_loss: 101980716.2667; val_optim_loss: 101980716.2667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9535; val_auprc_score: 0.9439; val_best_acc_score: 0.8887; val_best_f1_score: 0.8947; train_kl_reg_loss: 134925.5242; train_edge_recon_loss: 2767481.8263; train_gene_expr_recon_loss: 35131119.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64359708.7634; train_global_loss: 102393235.6031; train_optim_loss: 102393235.6031; val_kl_reg_loss: 94659.1307; val_edge_recon_loss: 2775516.4000; val_gene_expr_recon_loss: 34801413.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63359931.7333; val_global_loss: 101031520.5333; val_optim_loss: 101031520.5333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9597; val_auprc_score: 0.9540; val_best_acc_score: 0.8957; val_best_f1_score: 0.9010; train_kl_reg_loss: 134360.4415; train_edge_recon_loss: 2773713.4447; train_gene_expr_recon_loss: 35166097.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64397260.0000; train_global_loss: 102471431.4504; train_optim_loss: 102471431.4504; val_kl_reg_loss: 95703.8339; val_edge_recon_loss: 2768567.1833; val_gene_expr_recon_loss: 34882914.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63838643.4667; val_global_loss: 101585828.8000; val_optim_loss: 101585828.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 4 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9528
val AUPRC score: 0.9421
val best accuracy score: 0.8879
val best F1 score: 0.8944
val target rna MSE score: 1.0471
val source rna MSE score: 70.9751
val target atac MSE score: 0.1216
val source atac MSE score: 0.8870
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
