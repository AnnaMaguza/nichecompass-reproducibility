[True]
Run timestamp: 10082023_125425_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.2', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.2
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2602, n_latent: 2602, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7320; val_auprc_score: 0.7615; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 119208.1106; train_edge_recon_loss: 3579484.9198; train_gene_expr_recon_loss: 9780672.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1594254.1059; train_global_loss: 15073619.4198; train_optim_loss: 15073619.4198; val_kl_reg_loss: 122150.8474; val_edge_recon_loss: 4065496.8333; val_gene_expr_recon_loss: 8469384.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1486134.8917; val_global_loss: 14143166.9333; val_optim_loss: 14143166.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8217; val_auprc_score: 0.8298; val_best_acc_score: 0.7326; val_best_f1_score: 0.7284; train_kl_reg_loss: 116402.7281; train_edge_recon_loss: 3538256.1870; train_gene_expr_recon_loss: 8421208.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1482939.2261; train_global_loss: 13558807.0382; train_optim_loss: 13558807.0382; val_kl_reg_loss: 113270.6651; val_edge_recon_loss: 4021743.1000; val_gene_expr_recon_loss: 8175608.6333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1447833.0250; val_global_loss: 13758455.5333; val_optim_loss: 13758455.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8913; val_auprc_score: 0.8876; val_best_acc_score: 0.8064; val_best_f1_score: 0.8134; train_kl_reg_loss: 92806.0493; train_edge_recon_loss: 3427376.0553; train_gene_expr_recon_loss: 8249343.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1460269.0515; train_global_loss: 13229794.4809; train_optim_loss: 13229794.4809; val_kl_reg_loss: 82686.6536; val_edge_recon_loss: 3240753.3667; val_gene_expr_recon_loss: 8104663.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1433822.9250; val_global_loss: 12861927.0000; val_optim_loss: 12861927.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9057; val_auprc_score: 0.8874; val_best_acc_score: 0.8328; val_best_f1_score: 0.8410; train_kl_reg_loss: 114137.1855; train_edge_recon_loss: 2969845.5763; train_gene_expr_recon_loss: 8172080.5153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1447801.9857; train_global_loss: 12703865.2901; train_optim_loss: 12703865.2901; val_kl_reg_loss: 119104.3396; val_edge_recon_loss: 2894420.4667; val_gene_expr_recon_loss: 8039173.5667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1421426.4833; val_global_loss: 12474124.8667; val_optim_loss: 12474124.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9119; val_auprc_score: 0.8920; val_best_acc_score: 0.8411; val_best_f1_score: 0.8512; train_kl_reg_loss: 119776.7593; train_edge_recon_loss: 2861146.6698; train_gene_expr_recon_loss: 8075789.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1431846.4237; train_global_loss: 12488559.2214; train_optim_loss: 12488559.2214; val_kl_reg_loss: 114843.1495; val_edge_recon_loss: 2871016.7000; val_gene_expr_recon_loss: 7966357.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1415479.2833; val_global_loss: 12367696.4000; val_optim_loss: 12367696.4000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9251; val_auprc_score: 0.9045; val_best_acc_score: 0.8619; val_best_f1_score: 0.8689; train_kl_reg_loss: 112882.1692; train_edge_recon_loss: 2842063.0324; train_gene_expr_recon_loss: 8003927.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1430873.0782; train_global_loss: 12389746.2748; train_optim_loss: 12389746.2748; val_kl_reg_loss: 109858.0130; val_edge_recon_loss: 2823138.8500; val_gene_expr_recon_loss: 7871602.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1408295.5250; val_global_loss: 12212894.8667; val_optim_loss: 12212894.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9239; val_auprc_score: 0.9053; val_best_acc_score: 0.8579; val_best_f1_score: 0.8667; train_kl_reg_loss: 107909.1209; train_edge_recon_loss: 2825041.5248; train_gene_expr_recon_loss: 7940721.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1422279.2147; train_global_loss: 12295951.3588; train_optim_loss: 12295951.3588; val_kl_reg_loss: 103862.3943; val_edge_recon_loss: 2814958.3500; val_gene_expr_recon_loss: 7816524.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1390370.6833; val_global_loss: 12125716.2667; val_optim_loss: 12125716.2667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9299; val_auprc_score: 0.9170; val_best_acc_score: 0.8634; val_best_f1_score: 0.8715; train_kl_reg_loss: 103912.9700; train_edge_recon_loss: 2813879.5878; train_gene_expr_recon_loss: 7891357.3321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1418510.3378; train_global_loss: 12227660.2977; train_optim_loss: 12227660.2977; val_kl_reg_loss: 98329.2510; val_edge_recon_loss: 2824887.3333; val_gene_expr_recon_loss: 7790089.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1386485.6583; val_global_loss: 12099792.1333; val_optim_loss: 12099792.1333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9377; val_auprc_score: 0.9210; val_best_acc_score: 0.8727; val_best_f1_score: 0.8808; train_kl_reg_loss: 100874.0948; train_edge_recon_loss: 2800461.9714; train_gene_expr_recon_loss: 7849487.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1405104.0601; train_global_loss: 12155927.8550; train_optim_loss: 12155927.8550; val_kl_reg_loss: 100754.7234; val_edge_recon_loss: 2787190.2000; val_gene_expr_recon_loss: 7730064.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1379267.9000; val_global_loss: 11997276.8000; val_optim_loss: 11997276.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9384; val_auprc_score: 0.9209; val_best_acc_score: 0.8758; val_best_f1_score: 0.8836; train_kl_reg_loss: 98179.2374; train_edge_recon_loss: 2787531.2424; train_gene_expr_recon_loss: 7798500.8130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1388147.3912; train_global_loss: 12072358.6489; train_optim_loss: 12072358.6489; val_kl_reg_loss: 97804.0422; val_edge_recon_loss: 2769313.6333; val_gene_expr_recon_loss: 7699179.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1366117.8583; val_global_loss: 11932415.5333; val_optim_loss: 11932415.5333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9420; val_auprc_score: 0.9253; val_best_acc_score: 0.8777; val_best_f1_score: 0.8839; train_kl_reg_loss: 94582.4238; train_edge_recon_loss: 2770944.9542; train_gene_expr_recon_loss: 7764898.1183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1380577.9227; train_global_loss: 12011003.4427; train_optim_loss: 12011003.4427; val_kl_reg_loss: 91559.5714; val_edge_recon_loss: 2776020.9333; val_gene_expr_recon_loss: 7668755.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1359716.2417; val_global_loss: 11896052.4000; val_optim_loss: 11896052.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9401; val_auprc_score: 0.9263; val_best_acc_score: 0.8743; val_best_f1_score: 0.8827; train_kl_reg_loss: 93179.7924; train_edge_recon_loss: 2754950.0496; train_gene_expr_recon_loss: 7729182.1412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1373816.5334; train_global_loss: 11951128.5191; train_optim_loss: 11951128.5191; val_kl_reg_loss: 88752.5182; val_edge_recon_loss: 2776553.9000; val_gene_expr_recon_loss: 7631727.7667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1355141.3250; val_global_loss: 11852175.3333; val_optim_loss: 11852175.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9428; val_auprc_score: 0.9257; val_best_acc_score: 0.8822; val_best_f1_score: 0.8892; train_kl_reg_loss: 90461.2165; train_edge_recon_loss: 2754802.5573; train_gene_expr_recon_loss: 7701931.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1368151.0382; train_global_loss: 11915345.9847; train_optim_loss: 11915345.9847; val_kl_reg_loss: 91524.9932; val_edge_recon_loss: 2777197.2667; val_gene_expr_recon_loss: 7561621.6333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1343947.3250; val_global_loss: 11774291.1333; val_optim_loss: 11774291.1333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9462; val_auprc_score: 0.9339; val_best_acc_score: 0.8794; val_best_f1_score: 0.8847; train_kl_reg_loss: 88371.4965; train_edge_recon_loss: 2748590.2347; train_gene_expr_recon_loss: 7671580.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1361179.2939; train_global_loss: 11869720.9924; train_optim_loss: 11869720.9924; val_kl_reg_loss: 87062.2708; val_edge_recon_loss: 2768220.5667; val_gene_expr_recon_loss: 7558045.3667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1337415.6083; val_global_loss: 11750743.7333; val_optim_loss: 11750743.7333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9523; val_auprc_score: 0.9383; val_best_acc_score: 0.8942; val_best_f1_score: 0.8991; train_kl_reg_loss: 86066.2985; train_edge_recon_loss: 2742928.8511; train_gene_expr_recon_loss: 7651978.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1357731.9456; train_global_loss: 11838705.3817; train_optim_loss: 11838705.3817; val_kl_reg_loss: 82100.5865; val_edge_recon_loss: 2742567.9167; val_gene_expr_recon_loss: 7580733.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1345483.1833; val_global_loss: 11750884.8000; val_optim_loss: 11750884.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9513; val_auprc_score: 0.9359; val_best_acc_score: 0.8952; val_best_f1_score: 0.8994; train_kl_reg_loss: 84245.4933; train_edge_recon_loss: 2730190.1088; train_gene_expr_recon_loss: 7627815.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1352905.2605; train_global_loss: 11795156.7099; train_optim_loss: 11795156.7099; val_kl_reg_loss: 80916.4911; val_edge_recon_loss: 2768769.6500; val_gene_expr_recon_loss: 7529508.2333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1335045.4083; val_global_loss: 11714239.6000; val_optim_loss: 11714239.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9503; val_auprc_score: 0.9346; val_best_acc_score: 0.8925; val_best_f1_score: 0.8979; train_kl_reg_loss: 82384.9512; train_edge_recon_loss: 2733460.0420; train_gene_expr_recon_loss: 7602495.5916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1347966.6908; train_global_loss: 11766307.3053; train_optim_loss: 11766307.3053; val_kl_reg_loss: 79523.7245; val_edge_recon_loss: 2748349.4667; val_gene_expr_recon_loss: 7534749.9667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1332728.4750; val_global_loss: 11695351.6000; val_optim_loss: 11695351.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9602; val_auprc_score: 0.9481; val_best_acc_score: 0.9065; val_best_f1_score: 0.9099; train_kl_reg_loss: 80483.3781; train_edge_recon_loss: 2725413.6908; train_gene_expr_recon_loss: 7587417.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1345119.2204; train_global_loss: 11738433.4504; train_optim_loss: 11738433.4504; val_kl_reg_loss: 81419.3349; val_edge_recon_loss: 2708734.6500; val_gene_expr_recon_loss: 7515631.4333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1326618.3583; val_global_loss: 11632403.8000; val_optim_loss: 11632403.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9585; val_auprc_score: 0.9454; val_best_acc_score: 0.9037; val_best_f1_score: 0.9081; train_kl_reg_loss: 79022.4869; train_edge_recon_loss: 2715570.9809; train_gene_expr_recon_loss: 7564957.9733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1341387.2786; train_global_loss: 11700938.6947; train_optim_loss: 11700938.6947; val_kl_reg_loss: 78300.4245; val_edge_recon_loss: 2729150.3333; val_gene_expr_recon_loss: 7477200.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1327824.2250; val_global_loss: 11612475.3333; val_optim_loss: 11612475.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9621; val_auprc_score: 0.9509; val_best_acc_score: 0.9112; val_best_f1_score: 0.9159; train_kl_reg_loss: 76900.5281; train_edge_recon_loss: 2720685.4943; train_gene_expr_recon_loss: 7550773.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1338053.7672; train_global_loss: 11686413.0076; train_optim_loss: 11686413.0076; val_kl_reg_loss: 72972.4104; val_edge_recon_loss: 2727496.6333; val_gene_expr_recon_loss: 7469758.2333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1319527.1750; val_global_loss: 11589754.2000; val_optim_loss: 11589754.2000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9595; val_auprc_score: 0.9457; val_best_acc_score: 0.9068; val_best_f1_score: 0.9109; train_kl_reg_loss: 75026.2967; train_edge_recon_loss: 2716925.8874; train_gene_expr_recon_loss: 7536290.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1335925.4227; train_global_loss: 11664168.0000; train_optim_loss: 11664168.0000; val_kl_reg_loss: 75647.9328; val_edge_recon_loss: 2731826.0333; val_gene_expr_recon_loss: 7457453.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1319445.1500; val_global_loss: 11584372.6667; val_optim_loss: 11584372.6667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9637; val_auprc_score: 0.9528; val_best_acc_score: 0.9093; val_best_f1_score: 0.9129; train_kl_reg_loss: 73089.6616; train_edge_recon_loss: 2713214.5802; train_gene_expr_recon_loss: 7517163.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1331547.0821; train_global_loss: 11635014.4733; train_optim_loss: 11635014.4733; val_kl_reg_loss: 71454.6474; val_edge_recon_loss: 2725135.4000; val_gene_expr_recon_loss: 7465899.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1319037.4417; val_global_loss: 11581526.5333; val_optim_loss: 11581526.5333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9644; val_auprc_score: 0.9540; val_best_acc_score: 0.9108; val_best_f1_score: 0.9139; train_kl_reg_loss: 72769.0005; train_edge_recon_loss: 2707644.1698; train_gene_expr_recon_loss: 7503561.4389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1330676.8273; train_global_loss: 11614651.4962; train_optim_loss: 11614651.4962; val_kl_reg_loss: 74660.0427; val_edge_recon_loss: 2732245.6500; val_gene_expr_recon_loss: 7428552.7667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1319168.6833; val_global_loss: 11554627.2667; val_optim_loss: 11554627.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9657; val_auprc_score: 0.9552; val_best_acc_score: 0.9115; val_best_f1_score: 0.9150; train_kl_reg_loss: 71031.5906; train_edge_recon_loss: 2700532.1737; train_gene_expr_recon_loss: 7496078.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1329795.5515; train_global_loss: 11597438.1298; train_optim_loss: 11597438.1298; val_kl_reg_loss: 69152.1812; val_edge_recon_loss: 2712487.7000; val_gene_expr_recon_loss: 7438379.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1317182.8917; val_global_loss: 11537202.4000; val_optim_loss: 11537202.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9635; val_auprc_score: 0.9503; val_best_acc_score: 0.9124; val_best_f1_score: 0.9171; train_kl_reg_loss: 70402.9722; train_edge_recon_loss: 2695285.6489; train_gene_expr_recon_loss: 7483106.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1325611.1107; train_global_loss: 11574406.1145; train_optim_loss: 11574406.1145; val_kl_reg_loss: 70350.4344; val_edge_recon_loss: 2706968.5333; val_gene_expr_recon_loss: 7384044.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1307181.9333; val_global_loss: 11468545.5333; val_optim_loss: 11468545.5333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9503; val_auprc_score: 0.9381; val_best_acc_score: 0.8936; val_best_f1_score: 0.8970; train_kl_reg_loss: 99672.0636; train_edge_recon_loss: 2841717.8302; train_gene_expr_recon_loss: 9518428.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1502926.0534; train_global_loss: 13962744.7786; train_optim_loss: 13962744.7786; val_kl_reg_loss: 5260.6867; val_edge_recon_loss: 2794233.0167; val_gene_expr_recon_loss: 9897164.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1506695.3917; val_global_loss: 14203353.3333; val_optim_loss: 14203353.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8616; val_auprc_score: 0.8486; val_best_acc_score: 0.7700; val_best_f1_score: 0.7860; train_kl_reg_loss: 61903.5258; train_edge_recon_loss: 2795856.8836; train_gene_expr_recon_loss: 10013900.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1515760.8206; train_global_loss: 14387421.6489; train_optim_loss: 14387421.6489; val_kl_reg_loss: 2477.2013; val_edge_recon_loss: 2961652.5667; val_gene_expr_recon_loss: 10004352.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1500029.2833; val_global_loss: 14468511.1333; val_optim_loss: 14468511.1333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9136; val_auprc_score: 0.8970; val_best_acc_score: 0.8340; val_best_f1_score: 0.8402; train_kl_reg_loss: 34230.5259; train_edge_recon_loss: 2889775.7061; train_gene_expr_recon_loss: 10063045.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1515181.4695; train_global_loss: 14502233.2901; train_optim_loss: 14502233.2901; val_kl_reg_loss: 3624.7564; val_edge_recon_loss: 2825860.4333; val_gene_expr_recon_loss: 9925432.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1499714.6167; val_global_loss: 14254632.2667; val_optim_loss: 14254632.2667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9536; val_auprc_score: 0.9373; val_best_acc_score: 0.9053; val_best_f1_score: 0.9103; train_kl_reg_loss: 26849.4664; train_edge_recon_loss: 2734966.5382; train_gene_expr_recon_loss: 9598618.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1499310.6374; train_global_loss: 13859744.9771; train_optim_loss: 13859744.9771; val_kl_reg_loss: 7753.0724; val_edge_recon_loss: 2717147.2000; val_gene_expr_recon_loss: 9312374.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1477291.0417; val_global_loss: 13514565.8667; val_optim_loss: 13514565.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9533; val_auprc_score: 0.9353; val_best_acc_score: 0.9051; val_best_f1_score: 0.9089; train_kl_reg_loss: 27402.7448; train_edge_recon_loss: 2698146.8263; train_gene_expr_recon_loss: 9346293.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1490390.6565; train_global_loss: 13562233.9542; train_optim_loss: 13562233.9542; val_kl_reg_loss: 8270.0091; val_edge_recon_loss: 2715870.9167; val_gene_expr_recon_loss: 9195312.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1470084.0333; val_global_loss: 13389537.2667; val_optim_loss: 13389537.2667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9511; val_auprc_score: 0.9320; val_best_acc_score: 0.9042; val_best_f1_score: 0.9086; train_kl_reg_loss: 27035.1864; train_edge_recon_loss: 2700476.6603; train_gene_expr_recon_loss: 9336730.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1489786.2023; train_global_loss: 13554028.6870; train_optim_loss: 13554028.6870; val_kl_reg_loss: 8178.9524; val_edge_recon_loss: 2728509.9167; val_gene_expr_recon_loss: 9204332.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1475467.2583; val_global_loss: 13416488.4000; val_optim_loss: 13416488.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9516; val_auprc_score: 0.9327; val_best_acc_score: 0.9003; val_best_f1_score: 0.9056; train_kl_reg_loss: 26538.5598; train_edge_recon_loss: 2698881.3340; train_gene_expr_recon_loss: 9321121.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1488812.3950; train_global_loss: 13535353.9084; train_optim_loss: 13535353.9084; val_kl_reg_loss: 8524.8733; val_edge_recon_loss: 2722595.3667; val_gene_expr_recon_loss: 9224877.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1471431.3500; val_global_loss: 13427428.9333; val_optim_loss: 13427428.9333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9563; val_auprc_score: 0.9397; val_best_acc_score: 0.9068; val_best_f1_score: 0.9106; train_kl_reg_loss: 26171.2456; train_edge_recon_loss: 2697322.5191; train_gene_expr_recon_loss: 9285017.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1486138.9838; train_global_loss: 13494650.5191; train_optim_loss: 13494650.5191; val_kl_reg_loss: 8723.6105; val_edge_recon_loss: 2712169.4000; val_gene_expr_recon_loss: 9145737.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1465591.4417; val_global_loss: 13332222.1333; val_optim_loss: 13332222.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 3 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9656
val AUPRC score: 0.9530
val best accuracy score: 0.9146
val best F1 score: 0.9187
val target rna MSE score: 1.3456
val source rna MSE score: 0.6241
val target atac MSE score: 0.6352
val source atac MSE score: 0.2262
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
