[True]
Run timestamp: 24072023_161026_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8904; val_auprc_score: 0.9040; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 5027.8369; train_edge_recon_loss: 350964.6319; train_gene_expr_recon_loss: 3114052.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10767893.1111; train_global_loss: 14237938.0000; train_optim_loss: 14237938.0000; val_kl_reg_loss: 14390.0127; val_edge_recon_loss: 406584.2500; val_gene_expr_recon_loss: 3020770.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10813367.0000; val_global_loss: 14255112.0000; val_optim_loss: 14255112.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8719; val_auprc_score: 0.8810; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 23870.8457; train_edge_recon_loss: 365569.7326; train_gene_expr_recon_loss: 2849109.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10578702.8889; train_global_loss: 13817252.5556; train_optim_loss: 13817252.5556; val_kl_reg_loss: 32839.1641; val_edge_recon_loss: 406581.2812; val_gene_expr_recon_loss: 2721019.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10536713.0000; val_global_loss: 13697153.0000; val_optim_loss: 13697153.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8657; val_auprc_score: 0.8757; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 46253.9935; train_edge_recon_loss: 383409.6840; train_gene_expr_recon_loss: 2570252.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10284638.4444; train_global_loss: 13284554.6667; train_optim_loss: 13284554.6667; val_kl_reg_loss: 57425.8203; val_edge_recon_loss: 406593.5625; val_gene_expr_recon_loss: 2489680.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10292330.0000; val_global_loss: 13246030.0000; val_optim_loss: 13246030.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8793; val_auprc_score: 0.8827; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 64775.8424; train_edge_recon_loss: 394385.3333; train_gene_expr_recon_loss: 2395111.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10030966.0000; train_global_loss: 12885238.4444; train_optim_loss: 12885238.4444; val_kl_reg_loss: 73455.5156; val_edge_recon_loss: 406588.5000; val_gene_expr_recon_loss: 2374693.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10119303.0000; val_global_loss: 12974040.0000; val_optim_loss: 12974040.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8842; val_auprc_score: 0.8839; val_best_acc_score: 0.5019; val_best_f1_score: 0.6675; train_kl_reg_loss: 78812.4219; train_edge_recon_loss: 397214.3194; train_gene_expr_recon_loss: 2293575.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9908234.0000; train_global_loss: 12677837.0000; train_optim_loss: 12677837.0000; val_kl_reg_loss: 75705.8594; val_edge_recon_loss: 406568.1562; val_gene_expr_recon_loss: 2298961.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10018805.0000; val_global_loss: 12800040.0000; val_optim_loss: 12800040.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8797; val_auprc_score: 0.8757; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 83376.8984; train_edge_recon_loss: 397820.6181; train_gene_expr_recon_loss: 2236061.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9847621.1111; train_global_loss: 12564879.8889; train_optim_loss: 12564879.8889; val_kl_reg_loss: 82854.4297; val_edge_recon_loss: 406541.0312; val_gene_expr_recon_loss: 2244962.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9952650.0000; val_global_loss: 12687008.0000; val_optim_loss: 12687008.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8709; val_auprc_score: 0.8658; val_best_acc_score: 0.5100; val_best_f1_score: 0.6711; train_kl_reg_loss: 85581.6675; train_edge_recon_loss: 398663.5729; train_gene_expr_recon_loss: 2190493.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9771455.3333; train_global_loss: 12446194.1111; train_optim_loss: 12446194.1111; val_kl_reg_loss: 82838.6406; val_edge_recon_loss: 406487.8125; val_gene_expr_recon_loss: 2209445.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9908465.0000; val_global_loss: 12607236.0000; val_optim_loss: 12607236.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8734; val_auprc_score: 0.8720; val_best_acc_score: 0.5229; val_best_f1_score: 0.6768; train_kl_reg_loss: 86804.1102; train_edge_recon_loss: 397196.9583; train_gene_expr_recon_loss: 2157247.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9802867.1111; train_global_loss: 12444116.1111; train_optim_loss: 12444116.1111; val_kl_reg_loss: 81761.1562; val_edge_recon_loss: 406388.5312; val_gene_expr_recon_loss: 2184598.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9893900.0000; val_global_loss: 12566648.0000; val_optim_loss: 12566648.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8743; val_auprc_score: 0.8682; val_best_acc_score: 0.5450; val_best_f1_score: 0.6868; train_kl_reg_loss: 85198.4236; train_edge_recon_loss: 396197.6111; train_gene_expr_recon_loss: 2142418.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9742998.4444; train_global_loss: 12366812.5556; train_optim_loss: 12366812.5556; val_kl_reg_loss: 78424.0000; val_edge_recon_loss: 406252.3438; val_gene_expr_recon_loss: 2170923.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9875990.0000; val_global_loss: 12531589.0000; val_optim_loss: 12531589.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8779; val_auprc_score: 0.8680; val_best_acc_score: 0.6058; val_best_f1_score: 0.7155; train_kl_reg_loss: 82679.4193; train_edge_recon_loss: 395229.6354; train_gene_expr_recon_loss: 2123455.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9690394.8889; train_global_loss: 12291759.6667; train_optim_loss: 12291759.6667; val_kl_reg_loss: 75338.0469; val_edge_recon_loss: 405960.9688; val_gene_expr_recon_loss: 2161106.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9845188.0000; val_global_loss: 12487593.0000; val_optim_loss: 12487593.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8843; val_auprc_score: 0.8779; val_best_acc_score: 0.6686; val_best_f1_score: 0.7471; train_kl_reg_loss: 80962.7595; train_edge_recon_loss: 393342.6111; train_gene_expr_recon_loss: 2119277.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9710053.5556; train_global_loss: 12303636.5556; train_optim_loss: 12303636.5556; val_kl_reg_loss: 74075.5156; val_edge_recon_loss: 405532.7500; val_gene_expr_recon_loss: 2154517.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9837724.0000; val_global_loss: 12471850.0000; val_optim_loss: 12471850.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8913; val_auprc_score: 0.8833; val_best_acc_score: 0.7369; val_best_f1_score: 0.7848; train_kl_reg_loss: 78288.5642; train_edge_recon_loss: 391822.3681; train_gene_expr_recon_loss: 2123122.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9727745.0000; train_global_loss: 12320978.5556; train_optim_loss: 12320978.5556; val_kl_reg_loss: 72706.1328; val_edge_recon_loss: 404714.8125; val_gene_expr_recon_loss: 2146942.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9817253.0000; val_global_loss: 12441616.0000; val_optim_loss: 12441616.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8846; val_auprc_score: 0.8710; val_best_acc_score: 0.7786; val_best_f1_score: 0.8068; train_kl_reg_loss: 77087.3759; train_edge_recon_loss: 389820.0278; train_gene_expr_recon_loss: 2108010.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9665923.7778; train_global_loss: 12240842.0000; train_optim_loss: 12240842.0000; val_kl_reg_loss: 70744.0156; val_edge_recon_loss: 403694.0312; val_gene_expr_recon_loss: 2140897.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9807792.0000; val_global_loss: 12423128.0000; val_optim_loss: 12423128.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8900; val_auprc_score: 0.8818; val_best_acc_score: 0.8056; val_best_f1_score: 0.8175; train_kl_reg_loss: 74401.1415; train_edge_recon_loss: 388074.6354; train_gene_expr_recon_loss: 2104641.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9674702.7778; train_global_loss: 12241819.4444; train_optim_loss: 12241819.4444; val_kl_reg_loss: 66220.0000; val_edge_recon_loss: 401977.9062; val_gene_expr_recon_loss: 2135804.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9791925.0000; val_global_loss: 12395927.0000; val_optim_loss: 12395927.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8893; val_auprc_score: 0.8769; val_best_acc_score: 0.8083; val_best_f1_score: 0.8081; train_kl_reg_loss: 72301.6363; train_edge_recon_loss: 386772.1493; train_gene_expr_recon_loss: 2096353.6806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9684845.2222; train_global_loss: 12240272.7778; train_optim_loss: 12240272.7778; val_kl_reg_loss: 66451.8125; val_edge_recon_loss: 400093.7812; val_gene_expr_recon_loss: 2131432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9792337.0000; val_global_loss: 12390314.0000; val_optim_loss: 12390314.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8939; val_auprc_score: 0.8774; val_best_acc_score: 0.7980; val_best_f1_score: 0.7904; train_kl_reg_loss: 71451.4679; train_edge_recon_loss: 384340.9896; train_gene_expr_recon_loss: 2079388.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9634961.0000; train_global_loss: 12170141.7778; train_optim_loss: 12170141.7778; val_kl_reg_loss: 63524.5078; val_edge_recon_loss: 396481.0625; val_gene_expr_recon_loss: 2128099.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9783353.0000; val_global_loss: 12371458.0000; val_optim_loss: 12371458.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8876; val_auprc_score: 0.8700; val_best_acc_score: 0.7755; val_best_f1_score: 0.8092; train_kl_reg_loss: 69303.9679; train_edge_recon_loss: 381925.6111; train_gene_expr_recon_loss: 2082856.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9636846.8889; train_global_loss: 12170932.4444; train_optim_loss: 12170932.4444; val_kl_reg_loss: 64847.5547; val_edge_recon_loss: 392540.5625; val_gene_expr_recon_loss: 2121788.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9759408.0000; val_global_loss: 12338585.0000; val_optim_loss: 12338585.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8970; val_auprc_score: 0.8827; val_best_acc_score: 0.8060; val_best_f1_score: 0.8255; train_kl_reg_loss: 69427.3047; train_edge_recon_loss: 377892.9931; train_gene_expr_recon_loss: 2087223.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9650533.3333; train_global_loss: 12185077.5556; train_optim_loss: 12185077.5556; val_kl_reg_loss: 63898.6719; val_edge_recon_loss: 386992.9062; val_gene_expr_recon_loss: 2121641.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9760589.0000; val_global_loss: 12333122.0000; val_optim_loss: 12333122.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9017; val_auprc_score: 0.8849; val_best_acc_score: 0.8219; val_best_f1_score: 0.8331; train_kl_reg_loss: 68593.1306; train_edge_recon_loss: 374029.0312; train_gene_expr_recon_loss: 2084636.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9678777.2222; train_global_loss: 12206036.2222; train_optim_loss: 12206036.2222; val_kl_reg_loss: 62772.5703; val_edge_recon_loss: 379717.8125; val_gene_expr_recon_loss: 2119749.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9763254.0000; val_global_loss: 12325494.0000; val_optim_loss: 12325494.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9034; val_auprc_score: 0.8880; val_best_acc_score: 0.8255; val_best_f1_score: 0.8311; train_kl_reg_loss: 68269.3038; train_edge_recon_loss: 369247.7917; train_gene_expr_recon_loss: 2079991.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9624047.6667; train_global_loss: 12141556.3333; train_optim_loss: 12141556.3333; val_kl_reg_loss: 63853.1367; val_edge_recon_loss: 370916.6250; val_gene_expr_recon_loss: 2115369.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9745103.0000; val_global_loss: 12295242.0000; val_optim_loss: 12295242.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8999; val_auprc_score: 0.8838; val_best_acc_score: 0.8211; val_best_f1_score: 0.8308; train_kl_reg_loss: 69241.1372; train_edge_recon_loss: 363262.8924; train_gene_expr_recon_loss: 2069866.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9601039.0000; train_global_loss: 12103409.1111; train_optim_loss: 12103409.1111; val_kl_reg_loss: 66891.7969; val_edge_recon_loss: 365621.1250; val_gene_expr_recon_loss: 2113302.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9734725.0000; val_global_loss: 12280540.0000; val_optim_loss: 12280540.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9070; val_auprc_score: 0.8913; val_best_acc_score: 0.8255; val_best_f1_score: 0.8368; train_kl_reg_loss: 70397.7378; train_edge_recon_loss: 358455.2049; train_gene_expr_recon_loss: 2070673.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9534825.0000; train_global_loss: 12034351.0000; train_optim_loss: 12034351.0000; val_kl_reg_loss: 66506.5000; val_edge_recon_loss: 356440.0312; val_gene_expr_recon_loss: 2110245.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9713719.0000; val_global_loss: 12246910.0000; val_optim_loss: 12246910.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9116; val_auprc_score: 0.8990; val_best_acc_score: 0.8293; val_best_f1_score: 0.8388; train_kl_reg_loss: 71342.5252; train_edge_recon_loss: 352692.5139; train_gene_expr_recon_loss: 2080942.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9617302.5556; train_global_loss: 12122279.6667; train_optim_loss: 12122279.6667; val_kl_reg_loss: 68973.5703; val_edge_recon_loss: 351599.0312; val_gene_expr_recon_loss: 2109322.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9718246.0000; val_global_loss: 12248141.0000; val_optim_loss: 12248141.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9009; val_auprc_score: 0.8816; val_best_acc_score: 0.8177; val_best_f1_score: 0.8296; train_kl_reg_loss: 71846.4627; train_edge_recon_loss: 348959.2326; train_gene_expr_recon_loss: 2073484.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9580959.3333; train_global_loss: 12075249.3333; train_optim_loss: 12075249.3333; val_kl_reg_loss: 67739.0156; val_edge_recon_loss: 349075.5625; val_gene_expr_recon_loss: 2107956.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9717865.0000; val_global_loss: 12242636.0000; val_optim_loss: 12242636.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9112; val_auprc_score: 0.8991; val_best_acc_score: 0.8296; val_best_f1_score: 0.8358; train_kl_reg_loss: 70978.3481; train_edge_recon_loss: 346277.0451; train_gene_expr_recon_loss: 2066555.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9573689.6667; train_global_loss: 12057499.7778; train_optim_loss: 12057499.7778; val_kl_reg_loss: 67854.8672; val_edge_recon_loss: 346790.7188; val_gene_expr_recon_loss: 2104001.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9702859.0000; val_global_loss: 12221506.0000; val_optim_loss: 12221506.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9136; val_auprc_score: 0.8974; val_best_acc_score: 0.8309; val_best_f1_score: 0.8425; train_kl_reg_loss: 71665.8099; train_edge_recon_loss: 370547.6597; train_gene_expr_recon_loss: 2120196.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9664669.5556; train_global_loss: 12227079.7778; train_optim_loss: 12227079.7778; val_kl_reg_loss: 46902.9922; val_edge_recon_loss: 372254.3125; val_gene_expr_recon_loss: 2150281.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9731134.0000; val_global_loss: 12300573.0000; val_optim_loss: 12300573.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9150; val_auprc_score: 0.8917; val_best_acc_score: 0.8354; val_best_f1_score: 0.8469; train_kl_reg_loss: 68424.6055; train_edge_recon_loss: 365958.3194; train_gene_expr_recon_loss: 2107425.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9625007.8889; train_global_loss: 12166816.8889; train_optim_loss: 12166816.8889; val_kl_reg_loss: 47854.3984; val_edge_recon_loss: 372696.2500; val_gene_expr_recon_loss: 2143531.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9728428.0000; val_global_loss: 12292510.0000; val_optim_loss: 12292510.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9146; val_auprc_score: 0.8968; val_best_acc_score: 0.8340; val_best_f1_score: 0.8453; train_kl_reg_loss: 63558.0282; train_edge_recon_loss: 365498.8299; train_gene_expr_recon_loss: 2107649.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9569017.8889; train_global_loss: 12105723.7778; train_optim_loss: 12105723.7778; val_kl_reg_loss: 48214.6602; val_edge_recon_loss: 371128.9688; val_gene_expr_recon_loss: 2151997.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9725005.0000; val_global_loss: 12296346.0000; val_optim_loss: 12296346.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9189; val_auprc_score: 0.9032; val_best_acc_score: 0.8417; val_best_f1_score: 0.8503; train_kl_reg_loss: 62164.6467; train_edge_recon_loss: 363327.8993; train_gene_expr_recon_loss: 2112913.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9581802.5556; train_global_loss: 12120208.5556; train_optim_loss: 12120208.5556; val_kl_reg_loss: 47137.5469; val_edge_recon_loss: 366706.4688; val_gene_expr_recon_loss: 2151602.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9732439.0000; val_global_loss: 12297886.0000; val_optim_loss: 12297886.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9183; val_auprc_score: 0.9019; val_best_acc_score: 0.8364; val_best_f1_score: 0.8461; train_kl_reg_loss: 60595.2882; train_edge_recon_loss: 362612.7049; train_gene_expr_recon_loss: 2120696.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9602284.0000; train_global_loss: 12146188.5556; train_optim_loss: 12146188.5556; val_kl_reg_loss: 49646.8906; val_edge_recon_loss: 366389.5625; val_gene_expr_recon_loss: 2149785.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9729990.0000; val_global_loss: 12295812.0000; val_optim_loss: 12295812.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9152; val_auprc_score: 0.8972; val_best_acc_score: 0.8356; val_best_f1_score: 0.8454; train_kl_reg_loss: 61505.6758; train_edge_recon_loss: 361792.7604; train_gene_expr_recon_loss: 2100474.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9535053.7778; train_global_loss: 12058826.7778; train_optim_loss: 12058826.7778; val_kl_reg_loss: 48157.4414; val_edge_recon_loss: 365668.7812; val_gene_expr_recon_loss: 2148878.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9729096.0000; val_global_loss: 12291800.0000; val_optim_loss: 12291800.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9174; val_auprc_score: 0.8970; val_best_acc_score: 0.8390; val_best_f1_score: 0.8480; train_kl_reg_loss: 60214.2600; train_edge_recon_loss: 361763.9410; train_gene_expr_recon_loss: 2105318.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9593735.6667; train_global_loss: 12121032.7778; train_optim_loss: 12121032.7778; val_kl_reg_loss: 48698.0469; val_edge_recon_loss: 365039.2812; val_gene_expr_recon_loss: 2150613.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9731776.0000; val_global_loss: 12296127.0000; val_optim_loss: 12296127.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9209; val_auprc_score: 0.9040; val_best_acc_score: 0.8382; val_best_f1_score: 0.8475; train_kl_reg_loss: 60892.5890; train_edge_recon_loss: 361432.4236; train_gene_expr_recon_loss: 2111542.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9573987.7778; train_global_loss: 12107855.0000; train_optim_loss: 12107855.0000; val_kl_reg_loss: 48353.7734; val_edge_recon_loss: 365620.6562; val_gene_expr_recon_loss: 2145951.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9713780.0000; val_global_loss: 12273706.0000; val_optim_loss: 12273706.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 5 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9187
Val AUPRC score: 0.9008
Val best accuracy score: 0.8366
Val best F1 score: 0.8477
Val gene expr MSE score: 0.5424
Val chrom access MSE score: 0.0893
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
