[True]
Run timestamp: 29072023_095630_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8656; val_auprc_score: 0.8909; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11416.2165; train_edge_recon_loss: 356218.2014; train_gene_expr_recon_loss: 710739.2708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 180906056.8889; train_global_loss: 181984432.0000; train_optim_loss: 181984432.0000; val_kl_reg_loss: 12494.3975; val_edge_recon_loss: 406586.5000; val_gene_expr_recon_loss: 706315.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 173145600.0000; val_global_loss: 174270992.0000; val_optim_loss: 174270992.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8678; val_auprc_score: 0.8864; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 18135.2654; train_edge_recon_loss: 368701.6632; train_gene_expr_recon_loss: 684129.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 172594286.2222; train_global_loss: 173665251.5556; train_optim_loss: 173665251.5556; val_kl_reg_loss: 23263.1211; val_edge_recon_loss: 406614.7188; val_gene_expr_recon_loss: 630313.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 169707600.0000; val_global_loss: 170767792.0000; val_optim_loss: 170767792.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8697; val_auprc_score: 0.8909; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 31403.8077; train_edge_recon_loss: 384204.7118; train_gene_expr_recon_loss: 632831.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 169524798.2222; train_global_loss: 170573235.5556; train_optim_loss: 170573235.5556; val_kl_reg_loss: 38413.7500; val_edge_recon_loss: 406620.4375; val_gene_expr_recon_loss: 634417.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 166592928.0000; val_global_loss: 167672384.0000; val_optim_loss: 167672384.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8554; val_auprc_score: 0.8750; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 46784.1224; train_edge_recon_loss: 392452.1111; train_gene_expr_recon_loss: 623846.7014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 166699226.6667; train_global_loss: 167762311.1111; train_optim_loss: 167762311.1111; val_kl_reg_loss: 54677.9570; val_edge_recon_loss: 406620.5938; val_gene_expr_recon_loss: 601818.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 164501104.0000; val_global_loss: 165564224.0000; val_optim_loss: 165564224.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8559; val_auprc_score: 0.8753; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 58089.6502; train_edge_recon_loss: 395796.1250; train_gene_expr_recon_loss: 603629.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 165478540.4444; train_global_loss: 166536058.6667; train_optim_loss: 166536058.6667; val_kl_reg_loss: 59240.2305; val_edge_recon_loss: 406619.0938; val_gene_expr_recon_loss: 599193.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 163135744.0000; val_global_loss: 164200800.0000; val_optim_loss: 164200800.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8487; val_auprc_score: 0.8701; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 68299.8585; train_edge_recon_loss: 397067.2569; train_gene_expr_recon_loss: 597900.6042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 164391678.2222; train_global_loss: 165454944.0000; train_optim_loss: 165454944.0000; val_kl_reg_loss: 69518.3281; val_edge_recon_loss: 406619.9062; val_gene_expr_recon_loss: 584805.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162450880.0000; val_global_loss: 163511824.0000; val_optim_loss: 163511824.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8423; val_auprc_score: 0.8648; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 72927.1988; train_edge_recon_loss: 399229.9792; train_gene_expr_recon_loss: 585220.6319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 163649959.1111; train_global_loss: 164707336.8889; train_optim_loss: 164707336.8889; val_kl_reg_loss: 70076.1484; val_edge_recon_loss: 406616.4062; val_gene_expr_recon_loss: 578967.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 161078912.0000; val_global_loss: 162134576.0000; val_optim_loss: 162134576.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8409; val_auprc_score: 0.8586; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 77996.0495; train_edge_recon_loss: 397580.4097; train_gene_expr_recon_loss: 581418.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 162571134.2222; train_global_loss: 163628128.0000; train_optim_loss: 163628128.0000; val_kl_reg_loss: 76561.2188; val_edge_recon_loss: 406610.7500; val_gene_expr_recon_loss: 566440.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 160641056.0000; val_global_loss: 161690672.0000; val_optim_loss: 161690672.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8333; val_auprc_score: 0.8489; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 79794.8151; train_edge_recon_loss: 399352.5451; train_gene_expr_recon_loss: 568459.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 162090942.2222; train_global_loss: 163138551.1111; train_optim_loss: 163138551.1111; val_kl_reg_loss: 78428.7812; val_edge_recon_loss: 406603.4688; val_gene_expr_recon_loss: 555878.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159743904.0000; val_global_loss: 160784816.0000; val_optim_loss: 160784816.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8246; val_auprc_score: 0.8372; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 82520.2266; train_edge_recon_loss: 398335.8750; train_gene_expr_recon_loss: 555053.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161926328.8889; train_global_loss: 162962238.2222; train_optim_loss: 162962238.2222; val_kl_reg_loss: 77938.0234; val_edge_recon_loss: 406592.2188; val_gene_expr_recon_loss: 541619.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158955744.0000; val_global_loss: 159981888.0000; val_optim_loss: 159981888.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8184; val_auprc_score: 0.8284; val_best_acc_score: 0.5027; val_best_f1_score: 0.6679; train_kl_reg_loss: 80849.4002; train_edge_recon_loss: 397517.2431; train_gene_expr_recon_loss: 540125.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160062595.5556; train_global_loss: 161081088.0000; train_optim_loss: 161081088.0000; val_kl_reg_loss: 77033.2344; val_edge_recon_loss: 406575.7500; val_gene_expr_recon_loss: 525832.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158317728.0000; val_global_loss: 159327168.0000; val_optim_loss: 159327168.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8144; val_auprc_score: 0.8224; val_best_acc_score: 0.5049; val_best_f1_score: 0.6688; train_kl_reg_loss: 78565.9722; train_edge_recon_loss: 398043.7361; train_gene_expr_recon_loss: 519317.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157524775.1111; train_global_loss: 158520705.7778; train_optim_loss: 158520705.7778; val_kl_reg_loss: 78525.0234; val_edge_recon_loss: 406558.5938; val_gene_expr_recon_loss: 507270.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 157189008.0000; val_global_loss: 158181360.0000; val_optim_loss: 158181360.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8174; val_auprc_score: 0.8259; val_best_acc_score: 0.5096; val_best_f1_score: 0.6709; train_kl_reg_loss: 78966.7066; train_edge_recon_loss: 398927.8021; train_gene_expr_recon_loss: 503010.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 158337495.1111; train_global_loss: 159318400.0000; train_optim_loss: 159318400.0000; val_kl_reg_loss: 73898.1562; val_edge_recon_loss: 406527.5625; val_gene_expr_recon_loss: 491890.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156385376.0000; val_global_loss: 157357696.0000; val_optim_loss: 157357696.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8086; val_auprc_score: 0.8141; val_best_acc_score: 0.5129; val_best_f1_score: 0.6725; train_kl_reg_loss: 79703.5981; train_edge_recon_loss: 395480.8021; train_gene_expr_recon_loss: 487661.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157025843.5556; train_global_loss: 157988691.5556; train_optim_loss: 157988691.5556; val_kl_reg_loss: 75478.0312; val_edge_recon_loss: 406507.6875; val_gene_expr_recon_loss: 475430.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155493568.0000; val_global_loss: 156450976.0000; val_optim_loss: 156450976.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8075; val_auprc_score: 0.8158; val_best_acc_score: 0.5186; val_best_f1_score: 0.6749; train_kl_reg_loss: 77905.0599; train_edge_recon_loss: 396220.4132; train_gene_expr_recon_loss: 469818.1215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155582245.3333; train_global_loss: 156526188.4444; train_optim_loss: 156526188.4444; val_kl_reg_loss: 75478.5781; val_edge_recon_loss: 406477.6875; val_gene_expr_recon_loss: 461100.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154754912.0000; val_global_loss: 155697968.0000; val_optim_loss: 155697968.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8025; val_auprc_score: 0.8085; val_best_acc_score: 0.5220; val_best_f1_score: 0.6763; train_kl_reg_loss: 78017.6953; train_edge_recon_loss: 394521.8021; train_gene_expr_recon_loss: 458424.2049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155516728.8889; train_global_loss: 156447690.6667; train_optim_loss: 156447690.6667; val_kl_reg_loss: 73680.0859; val_edge_recon_loss: 406453.4062; val_gene_expr_recon_loss: 448956.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153993824.0000; val_global_loss: 154922912.0000; val_optim_loss: 154922912.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8056; val_auprc_score: 0.8098; val_best_acc_score: 0.5251; val_best_f1_score: 0.6776; train_kl_reg_loss: 77052.7344; train_edge_recon_loss: 393218.7396; train_gene_expr_recon_loss: 445923.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154851777.7778; train_global_loss: 155767975.1111; train_optim_loss: 155767975.1111; val_kl_reg_loss: 72701.7109; val_edge_recon_loss: 406409.7188; val_gene_expr_recon_loss: 439837.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153067520.0000; val_global_loss: 153986464.0000; val_optim_loss: 153986464.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8092; val_auprc_score: 0.8135; val_best_acc_score: 0.5333; val_best_f1_score: 0.6809; train_kl_reg_loss: 76774.5773; train_edge_recon_loss: 392037.0938; train_gene_expr_recon_loss: 438238.2153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153971905.7778; train_global_loss: 154878956.4444; train_optim_loss: 154878956.4444; val_kl_reg_loss: 72346.5312; val_edge_recon_loss: 406361.6875; val_gene_expr_recon_loss: 431796.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152956512.0000; val_global_loss: 153867024.0000; val_optim_loss: 153867024.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8166; val_auprc_score: 0.8220; val_best_acc_score: 0.5342; val_best_f1_score: 0.6809; train_kl_reg_loss: 75800.1085; train_edge_recon_loss: 391523.0833; train_gene_expr_recon_loss: 430486.1736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153831829.3333; train_global_loss: 154729639.1111; train_optim_loss: 154729639.1111; val_kl_reg_loss: 74073.1406; val_edge_recon_loss: 406342.4688; val_gene_expr_recon_loss: 423537.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152394656.0000; val_global_loss: 153298608.0000; val_optim_loss: 153298608.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8217; val_auprc_score: 0.8269; val_best_acc_score: 0.5482; val_best_f1_score: 0.6868; train_kl_reg_loss: 76603.0477; train_edge_recon_loss: 389741.0347; train_gene_expr_recon_loss: 425429.2396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153589118.2222; train_global_loss: 154480890.6667; train_optim_loss: 154480890.6667; val_kl_reg_loss: 69177.3438; val_edge_recon_loss: 406216.0000; val_gene_expr_recon_loss: 420726.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152321408.0000; val_global_loss: 153217520.0000; val_optim_loss: 153217520.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8344; val_auprc_score: 0.8401; val_best_acc_score: 0.5601; val_best_f1_score: 0.6921; train_kl_reg_loss: 76226.7587; train_edge_recon_loss: 388687.0208; train_gene_expr_recon_loss: 418058.5660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152404183.1111; train_global_loss: 153287155.5556; train_optim_loss: 153287155.5556; val_kl_reg_loss: 71937.2656; val_edge_recon_loss: 406132.1875; val_gene_expr_recon_loss: 413731.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151856880.0000; val_global_loss: 152748688.0000; val_optim_loss: 152748688.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8402; val_auprc_score: 0.8432; val_best_acc_score: 0.5759; val_best_f1_score: 0.6986; train_kl_reg_loss: 73994.2196; train_edge_recon_loss: 389571.4028; train_gene_expr_recon_loss: 417418.6910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153489594.6667; train_global_loss: 154370577.7778; train_optim_loss: 154370577.7778; val_kl_reg_loss: 68658.4375; val_edge_recon_loss: 406009.1875; val_gene_expr_recon_loss: 411694.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151658688.0000; val_global_loss: 152545056.0000; val_optim_loss: 152545056.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8463; val_auprc_score: 0.8433; val_best_acc_score: 0.6001; val_best_f1_score: 0.7097; train_kl_reg_loss: 74779.5538; train_edge_recon_loss: 387306.8993; train_gene_expr_recon_loss: 413013.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152202327.1111; train_global_loss: 153077427.5556; train_optim_loss: 153077427.5556; val_kl_reg_loss: 68982.2812; val_edge_recon_loss: 405817.4688; val_gene_expr_recon_loss: 408055.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151633680.0000; val_global_loss: 152516528.0000; val_optim_loss: 152516528.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8507; val_auprc_score: 0.8429; val_best_acc_score: 0.6304; val_best_f1_score: 0.7240; train_kl_reg_loss: 74062.1562; train_edge_recon_loss: 386837.0799; train_gene_expr_recon_loss: 407283.1736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152232318.2222; train_global_loss: 153100501.3333; train_optim_loss: 153100501.3333; val_kl_reg_loss: 68583.1016; val_edge_recon_loss: 405617.9375; val_gene_expr_recon_loss: 404682.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151278240.0000; val_global_loss: 152157120.0000; val_optim_loss: 152157120.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8599; val_auprc_score: 0.8550; val_best_acc_score: 0.6660; val_best_f1_score: 0.7418; train_kl_reg_loss: 72974.4931; train_edge_recon_loss: 387069.1771; train_gene_expr_recon_loss: 407656.5799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152837888.0000; train_global_loss: 153705589.3333; train_optim_loss: 153705589.3333; val_kl_reg_loss: 70272.3438; val_edge_recon_loss: 405326.1250; val_gene_expr_recon_loss: 400913.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151074176.0000; val_global_loss: 151950688.0000; val_optim_loss: 151950688.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8706; val_auprc_score: 0.8635; val_best_acc_score: 0.6925; val_best_f1_score: 0.7571; train_kl_reg_loss: 73170.4418; train_edge_recon_loss: 393406.3194; train_gene_expr_recon_loss: 405500.5521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153540229.3333; train_global_loss: 154412309.3333; train_optim_loss: 154412309.3333; val_kl_reg_loss: 58686.5547; val_edge_recon_loss: 405104.9375; val_gene_expr_recon_loss: 401854.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151242992.0000; val_global_loss: 152108640.0000; val_optim_loss: 152108640.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8726; val_auprc_score: 0.8691; val_best_acc_score: 0.7101; val_best_f1_score: 0.7665; train_kl_reg_loss: 69519.3307; train_edge_recon_loss: 392685.0208; train_gene_expr_recon_loss: 400909.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152135390.2222; train_global_loss: 152998506.6667; train_optim_loss: 152998506.6667; val_kl_reg_loss: 63254.8828; val_edge_recon_loss: 404906.1250; val_gene_expr_recon_loss: 398213.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151093520.0000; val_global_loss: 151959888.0000; val_optim_loss: 151959888.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8725; val_auprc_score: 0.8666; val_best_acc_score: 0.7270; val_best_f1_score: 0.7744; train_kl_reg_loss: 70507.1953; train_edge_recon_loss: 391634.9861; train_gene_expr_recon_loss: 400353.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152200199.1111; train_global_loss: 153062696.8889; train_optim_loss: 153062696.8889; val_kl_reg_loss: 61036.1758; val_edge_recon_loss: 404576.6562; val_gene_expr_recon_loss: 395909.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150547136.0000; val_global_loss: 151408656.0000; val_optim_loss: 151408656.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8761; val_auprc_score: 0.8722; val_best_acc_score: 0.7455; val_best_f1_score: 0.7852; train_kl_reg_loss: 69780.6441; train_edge_recon_loss: 393508.2986; train_gene_expr_recon_loss: 399932.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152150920.8889; train_global_loss: 153014142.2222; train_optim_loss: 153014142.2222; val_kl_reg_loss: 56068.8438; val_edge_recon_loss: 404302.5312; val_gene_expr_recon_loss: 396729.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150973056.0000; val_global_loss: 151830160.0000; val_optim_loss: 151830160.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8819; val_auprc_score: 0.8729; val_best_acc_score: 0.7696; val_best_f1_score: 0.7997; train_kl_reg_loss: 65962.5569; train_edge_recon_loss: 394096.7639; train_gene_expr_recon_loss: 399235.3299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152603607.1111; train_global_loss: 153462899.5556; train_optim_loss: 153462899.5556; val_kl_reg_loss: 55315.4375; val_edge_recon_loss: 403902.7812; val_gene_expr_recon_loss: 393870.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150862336.0000; val_global_loss: 151715424.0000; val_optim_loss: 151715424.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8779; val_auprc_score: 0.8653; val_best_acc_score: 0.7842; val_best_f1_score: 0.8060; train_kl_reg_loss: 63770.9761; train_edge_recon_loss: 395787.7431; train_gene_expr_recon_loss: 396086.7951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151845466.6667; train_global_loss: 152701112.8889; train_optim_loss: 152701112.8889; val_kl_reg_loss: 55763.5000; val_edge_recon_loss: 403357.3438; val_gene_expr_recon_loss: 392593.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150585120.0000; val_global_loss: 151436832.0000; val_optim_loss: 151436832.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8875; val_auprc_score: 0.8732; val_best_acc_score: 0.8023; val_best_f1_score: 0.8185; train_kl_reg_loss: 64496.5148; train_edge_recon_loss: 393384.3785; train_gene_expr_recon_loss: 394942.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151803701.3333; train_global_loss: 152656526.2222; train_optim_loss: 152656526.2222; val_kl_reg_loss: 54154.9297; val_edge_recon_loss: 402987.5938; val_gene_expr_recon_loss: 392109.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150702064.0000; val_global_loss: 151551312.0000; val_optim_loss: 151551312.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8895; val_auprc_score: 0.8799; val_best_acc_score: 0.7982; val_best_f1_score: 0.8164; train_kl_reg_loss: 59701.4978; train_edge_recon_loss: 400166.3542; train_gene_expr_recon_loss: 395380.9965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152370961.7778; train_global_loss: 153226209.7778; train_optim_loss: 153226209.7778; val_kl_reg_loss: 55794.3477; val_edge_recon_loss: 403233.3750; val_gene_expr_recon_loss: 389411.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150794656.0000; val_global_loss: 151643088.0000; val_optim_loss: 151643088.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8842; val_auprc_score: 0.8717; val_best_acc_score: 0.7992; val_best_f1_score: 0.8164; train_kl_reg_loss: 60914.3698; train_edge_recon_loss: 397818.2326; train_gene_expr_recon_loss: 393007.4201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151552712.8889; train_global_loss: 152404453.3333; train_optim_loss: 152404453.3333; val_kl_reg_loss: 56128.1250; val_edge_recon_loss: 402971.6562; val_gene_expr_recon_loss: 390385.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150393664.0000; val_global_loss: 151243152.0000; val_optim_loss: 151243152.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8865; val_auprc_score: 0.8793; val_best_acc_score: 0.7933; val_best_f1_score: 0.8119; train_kl_reg_loss: 62707.9284; train_edge_recon_loss: 395082.8438; train_gene_expr_recon_loss: 392834.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151573370.6667; train_global_loss: 152423992.8889; train_optim_loss: 152423992.8889; val_kl_reg_loss: 57675.1406; val_edge_recon_loss: 402944.6562; val_gene_expr_recon_loss: 389708.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150534672.0000; val_global_loss: 151385008.0000; val_optim_loss: 151385008.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8875; val_auprc_score: 0.8768; val_best_acc_score: 0.7995; val_best_f1_score: 0.8163; train_kl_reg_loss: 62311.2643; train_edge_recon_loss: 394791.0243; train_gene_expr_recon_loss: 392225.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151981331.5556; train_global_loss: 152830659.5556; train_optim_loss: 152830659.5556; val_kl_reg_loss: 57236.8281; val_edge_recon_loss: 402948.4688; val_gene_expr_recon_loss: 389374.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150494752.0000; val_global_loss: 151344304.0000; val_optim_loss: 151344304.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8911; val_auprc_score: 0.8789; val_best_acc_score: 0.8054; val_best_f1_score: 0.8205; train_kl_reg_loss: 63430.3568; train_edge_recon_loss: 393833.5833; train_gene_expr_recon_loss: 394907.3924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152062769.7778; train_global_loss: 152914940.4444; train_optim_loss: 152914940.4444; val_kl_reg_loss: 57900.2734; val_edge_recon_loss: 402772.7500; val_gene_expr_recon_loss: 389541.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150441344.0000; val_global_loss: 151291552.0000; val_optim_loss: 151291552.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.8880; val_auprc_score: 0.8762; val_best_acc_score: 0.8042; val_best_f1_score: 0.8193; train_kl_reg_loss: 63234.1068; train_edge_recon_loss: 393171.5556; train_gene_expr_recon_loss: 394792.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151544533.3333; train_global_loss: 152395731.5556; train_optim_loss: 152395731.5556; val_kl_reg_loss: 57855.6406; val_edge_recon_loss: 402740.4062; val_gene_expr_recon_loss: 389497.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150440768.0000; val_global_loss: 151290864.0000; val_optim_loss: 151290864.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.8866; val_auprc_score: 0.8707; val_best_acc_score: 0.8054; val_best_f1_score: 0.8202; train_kl_reg_loss: 63395.4319; train_edge_recon_loss: 392879.9340; train_gene_expr_recon_loss: 392759.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151496088.8889; train_global_loss: 152345125.3333; train_optim_loss: 152345125.3333; val_kl_reg_loss: 57981.3984; val_edge_recon_loss: 402922.5625; val_gene_expr_recon_loss: 389105.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150352096.0000; val_global_loss: 151202112.0000; val_optim_loss: 151202112.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.8892; val_auprc_score: 0.8745; val_best_acc_score: 0.8064; val_best_f1_score: 0.8209; train_kl_reg_loss: 63768.1254; train_edge_recon_loss: 392803.5139; train_gene_expr_recon_loss: 392977.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152026419.5556; train_global_loss: 152875968.0000; train_optim_loss: 152875968.0000; val_kl_reg_loss: 58066.1602; val_edge_recon_loss: 402797.0625; val_gene_expr_recon_loss: 389504.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150388672.0000; val_global_loss: 151239040.0000; val_optim_loss: 151239040.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.8880; val_auprc_score: 0.8753; val_best_acc_score: 0.8060; val_best_f1_score: 0.8205; train_kl_reg_loss: 64030.9019; train_edge_recon_loss: 392656.4653; train_gene_expr_recon_loss: 393392.7049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151437777.7778; train_global_loss: 152287856.0000; train_optim_loss: 152287856.0000; val_kl_reg_loss: 57915.5938; val_edge_recon_loss: 402717.4688; val_gene_expr_recon_loss: 388860.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150045376.0000; val_global_loss: 150894864.0000; val_optim_loss: 150894864.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.8859; val_auprc_score: 0.8719; val_best_acc_score: 0.8015; val_best_f1_score: 0.8171; train_kl_reg_loss: 63521.2470; train_edge_recon_loss: 392851.2708; train_gene_expr_recon_loss: 393613.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151923077.3333; train_global_loss: 152773063.1111; train_optim_loss: 152773063.1111; val_kl_reg_loss: 58157.0391; val_edge_recon_loss: 402776.1875; val_gene_expr_recon_loss: 389484.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150475232.0000; val_global_loss: 151325648.0000; val_optim_loss: 151325648.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.8860; val_auprc_score: 0.8706; val_best_acc_score: 0.8044; val_best_f1_score: 0.8193; train_kl_reg_loss: 63955.1185; train_edge_recon_loss: 392637.7917; train_gene_expr_recon_loss: 392579.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151974330.6667; train_global_loss: 152823504.0000; train_optim_loss: 152823504.0000; val_kl_reg_loss: 58039.8672; val_edge_recon_loss: 402662.2188; val_gene_expr_recon_loss: 389686.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150365728.0000; val_global_loss: 151216112.0000; val_optim_loss: 151216112.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.8862; val_auprc_score: 0.8727; val_best_acc_score: 0.8041; val_best_f1_score: 0.8190; train_kl_reg_loss: 63892.5647; train_edge_recon_loss: 392429.0139; train_gene_expr_recon_loss: 394001.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152371550.2222; train_global_loss: 153221870.2222; train_optim_loss: 153221870.2222; val_kl_reg_loss: 58218.9609; val_edge_recon_loss: 402675.1250; val_gene_expr_recon_loss: 389885.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150507712.0000; val_global_loss: 151358496.0000; val_optim_loss: 151358496.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.8891; val_auprc_score: 0.8774; val_best_acc_score: 0.8049; val_best_f1_score: 0.8196; train_kl_reg_loss: 64091.7244; train_edge_recon_loss: 392321.7951; train_gene_expr_recon_loss: 394841.0174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152645102.2222; train_global_loss: 153496357.3333; train_optim_loss: 153496357.3333; val_kl_reg_loss: 58374.6016; val_edge_recon_loss: 402746.9375; val_gene_expr_recon_loss: 389467.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150398464.0000; val_global_loss: 151249056.0000; val_optim_loss: 151249056.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.8872; val_auprc_score: 0.8746; val_best_acc_score: 0.8041; val_best_f1_score: 0.8191; train_kl_reg_loss: 64280.6189; train_edge_recon_loss: 392248.1944; train_gene_expr_recon_loss: 396300.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152336522.6667; train_global_loss: 153189351.1111; train_optim_loss: 153189351.1111; val_kl_reg_loss: 58518.7422; val_edge_recon_loss: 402777.2812; val_gene_expr_recon_loss: 389657.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150663808.0000; val_global_loss: 151514768.0000; val_optim_loss: 151514768.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.8909; val_auprc_score: 0.8777; val_best_acc_score: 0.8114; val_best_f1_score: 0.8246; train_kl_reg_loss: 63927.7066; train_edge_recon_loss: 392276.0938; train_gene_expr_recon_loss: 391246.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151458337.7778; train_global_loss: 152305786.6667; train_optim_loss: 152305786.6667; val_kl_reg_loss: 58541.9570; val_edge_recon_loss: 402573.2500; val_gene_expr_recon_loss: 390099.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150703200.0000; val_global_loss: 151554416.0000; val_optim_loss: 151554416.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.8894; val_auprc_score: 0.8817; val_best_acc_score: 0.8021; val_best_f1_score: 0.8174; train_kl_reg_loss: 63956.4253; train_edge_recon_loss: 392382.7674; train_gene_expr_recon_loss: 393719.6181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152278208.0000; train_global_loss: 153128266.6667; train_optim_loss: 153128266.6667; val_kl_reg_loss: 58440.2031; val_edge_recon_loss: 402794.7812; val_gene_expr_recon_loss: 389478.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150355392.0000; val_global_loss: 151206112.0000; val_optim_loss: 151206112.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.8917; val_auprc_score: 0.8817; val_best_acc_score: 0.8040; val_best_f1_score: 0.8189; train_kl_reg_loss: 64452.9171; train_edge_recon_loss: 392103.0938; train_gene_expr_recon_loss: 392868.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151299404.4444; train_global_loss: 152148830.2222; train_optim_loss: 152148830.2222; val_kl_reg_loss: 58401.5078; val_edge_recon_loss: 402762.4688; val_gene_expr_recon_loss: 389550.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150550832.0000; val_global_loss: 151401552.0000; val_optim_loss: 151401552.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 16 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.8896
val AUPRC score: 0.8774
val best accuracy score: 0.8083
val best F1 score: 0.8223
val target rna MSE score: 9.6741
val source rna MSE score: 8.7428
val target atac MSE score: 0.1178
val source atac MSE score: 0.0174
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
