[True]
Run timestamp: 07082023_173141_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8883; val_auprc_score: 0.9071; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 15222.0640; train_edge_recon_loss: 36438.2561; train_gene_expr_recon_loss: 1325812.8889; train_masked_gp_l1_reg_loss: 8465.8161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167361.4549; train_chrom_access_recon_loss: 2679309.5417; train_global_loss: 4232610.0000; train_optim_loss: 4232610.0000; val_kl_reg_loss: 13215.9609; val_edge_recon_loss: 40660.7891; val_gene_expr_recon_loss: 1068753.7500; val_masked_gp_l1_reg_loss: 6651.5098; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163033.6094; val_chrom_access_recon_loss: 1710423.7500; val_global_loss: 3002739.5000; val_optim_loss: 3002739.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8888; val_auprc_score: 0.9037; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14353.0552; train_edge_recon_loss: 38157.2005; train_gene_expr_recon_loss: 952127.8750; train_masked_gp_l1_reg_loss: 6034.1688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160407.9288; train_chrom_access_recon_loss: 1574412.2917; train_global_loss: 2745492.5278; train_optim_loss: 2745492.5278; val_kl_reg_loss: 13972.1895; val_edge_recon_loss: 40661.2734; val_gene_expr_recon_loss: 841235.6250; val_masked_gp_l1_reg_loss: 5649.3560; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157235.6094; val_chrom_access_recon_loss: 1417058.7500; val_global_loss: 2475812.7500; val_optim_loss: 2475812.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8938; val_auprc_score: 0.9095; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16046.0293; train_edge_recon_loss: 38317.5087; train_gene_expr_recon_loss: 813716.9236; train_masked_gp_l1_reg_loss: 5855.7824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154645.5399; train_chrom_access_recon_loss: 1408402.7778; train_global_loss: 2436984.6111; train_optim_loss: 2436984.6111; val_kl_reg_loss: 17575.9297; val_edge_recon_loss: 40661.5117; val_gene_expr_recon_loss: 770882.3125; val_masked_gp_l1_reg_loss: 6122.8472; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151255.5469; val_chrom_access_recon_loss: 1370136.8750; val_global_loss: 2356635.0000; val_optim_loss: 2356635.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8902; val_auprc_score: 0.9066; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19736.1044; train_edge_recon_loss: 38705.6367; train_gene_expr_recon_loss: 766759.5069; train_masked_gp_l1_reg_loss: 6179.0642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148225.2031; train_chrom_access_recon_loss: 1374382.0000; train_global_loss: 2353987.5000; train_optim_loss: 2353987.5000; val_kl_reg_loss: 19527.4961; val_edge_recon_loss: 40661.3008; val_gene_expr_recon_loss: 739757.6250; val_masked_gp_l1_reg_loss: 6218.4673; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144231.0312; val_chrom_access_recon_loss: 1349304.2500; val_global_loss: 2299700.0000; val_optim_loss: 2299700.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8836; val_auprc_score: 0.8971; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20730.0523; train_edge_recon_loss: 38812.8325; train_gene_expr_recon_loss: 738691.7708; train_masked_gp_l1_reg_loss: 6243.1161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140785.9149; train_chrom_access_recon_loss: 1355102.5972; train_global_loss: 2300366.2778; train_optim_loss: 2300366.2778; val_kl_reg_loss: 20738.6562; val_edge_recon_loss: 40659.7070; val_gene_expr_recon_loss: 721162.8750; val_masked_gp_l1_reg_loss: 6262.8735; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136386.2500; val_chrom_access_recon_loss: 1336586.6250; val_global_loss: 2261797.0000; val_optim_loss: 2261797.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8709; val_auprc_score: 0.8756; val_best_acc_score: 0.5026; val_best_f1_score: 0.6678; train_kl_reg_loss: 22409.8724; train_edge_recon_loss: 38947.7378; train_gene_expr_recon_loss: 720107.6875; train_masked_gp_l1_reg_loss: 6266.2041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132777.6285; train_chrom_access_recon_loss: 1339561.2917; train_global_loss: 2260070.3889; train_optim_loss: 2260070.3889; val_kl_reg_loss: 21973.4180; val_edge_recon_loss: 40656.6367; val_gene_expr_recon_loss: 705380.1250; val_masked_gp_l1_reg_loss: 6250.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128240.2500; val_chrom_access_recon_loss: 1327212.7500; val_global_loss: 2229713.5000; val_optim_loss: 2229713.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8714; val_auprc_score: 0.8714; val_best_acc_score: 0.5124; val_best_f1_score: 0.6722; train_kl_reg_loss: 23326.0072; train_edge_recon_loss: 39010.6992; train_gene_expr_recon_loss: 707639.5694; train_masked_gp_l1_reg_loss: 6235.4984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124613.1024; train_chrom_access_recon_loss: 1338694.2500; train_global_loss: 2239519.1944; train_optim_loss: 2239519.1944; val_kl_reg_loss: 22415.2773; val_edge_recon_loss: 40649.6094; val_gene_expr_recon_loss: 693855.1250; val_masked_gp_l1_reg_loss: 6211.1714; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120098.5312; val_chrom_access_recon_loss: 1320094.3750; val_global_loss: 2203324.0000; val_optim_loss: 2203324.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8668; val_auprc_score: 0.8631; val_best_acc_score: 0.5263; val_best_f1_score: 0.6783; train_kl_reg_loss: 23873.0792; train_edge_recon_loss: 39053.0864; train_gene_expr_recon_loss: 693236.1389; train_masked_gp_l1_reg_loss: 6198.5570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116559.4826; train_chrom_access_recon_loss: 1324338.3333; train_global_loss: 2203258.6944; train_optim_loss: 2203258.6944; val_kl_reg_loss: 23237.7500; val_edge_recon_loss: 40636.1953; val_gene_expr_recon_loss: 683521.4375; val_masked_gp_l1_reg_loss: 6180.5322; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112196.7578; val_chrom_access_recon_loss: 1314232.1250; val_global_loss: 2180004.7500; val_optim_loss: 2180004.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8459; val_auprc_score: 0.8388; val_best_acc_score: 0.5517; val_best_f1_score: 0.6883; train_kl_reg_loss: 24640.4334; train_edge_recon_loss: 39098.4527; train_gene_expr_recon_loss: 680101.0139; train_masked_gp_l1_reg_loss: 6165.5102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108837.1684; train_chrom_access_recon_loss: 1324512.0694; train_global_loss: 2183354.6389; train_optim_loss: 2183354.6389; val_kl_reg_loss: 24379.3164; val_edge_recon_loss: 40616.5117; val_gene_expr_recon_loss: 673845.8750; val_masked_gp_l1_reg_loss: 6142.4976; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104714.6797; val_chrom_access_recon_loss: 1309226.3750; val_global_loss: 2158925.2500; val_optim_loss: 2158925.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8322; val_auprc_score: 0.8316; val_best_acc_score: 0.5816; val_best_f1_score: 0.7005; train_kl_reg_loss: 25059.6975; train_edge_recon_loss: 39133.9023; train_gene_expr_recon_loss: 669320.3611; train_masked_gp_l1_reg_loss: 6131.8054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101566.8741; train_chrom_access_recon_loss: 1311111.6806; train_global_loss: 2152324.2778; train_optim_loss: 2152324.2778; val_kl_reg_loss: 24383.9805; val_edge_recon_loss: 40591.3125; val_gene_expr_recon_loss: 666782.5625; val_masked_gp_l1_reg_loss: 6116.3779; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97729.1719; val_chrom_access_recon_loss: 1304875.2500; val_global_loss: 2140478.7500; val_optim_loss: 2140478.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8194; val_auprc_score: 0.8140; val_best_acc_score: 0.6175; val_best_f1_score: 0.7164; train_kl_reg_loss: 25597.8181; train_edge_recon_loss: 39162.9566; train_gene_expr_recon_loss: 666954.8333; train_masked_gp_l1_reg_loss: 6112.5766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94834.7274; train_chrom_access_recon_loss: 1310533.4028; train_global_loss: 2143196.3333; train_optim_loss: 2143196.3333; val_kl_reg_loss: 24295.1035; val_edge_recon_loss: 40554.8945; val_gene_expr_recon_loss: 661664.1250; val_masked_gp_l1_reg_loss: 6105.3418; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91316.6797; val_chrom_access_recon_loss: 1300777.7500; val_global_loss: 2124714.0000; val_optim_loss: 2124714.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8199; val_auprc_score: 0.8214; val_best_acc_score: 0.6358; val_best_f1_score: 0.7258; train_kl_reg_loss: 25495.2450; train_edge_recon_loss: 39176.1389; train_gene_expr_recon_loss: 664986.5833; train_masked_gp_l1_reg_loss: 6100.3844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88686.8611; train_chrom_access_recon_loss: 1311565.2917; train_global_loss: 2136010.4722; train_optim_loss: 2136010.4722; val_kl_reg_loss: 25143.3535; val_edge_recon_loss: 40544.0469; val_gene_expr_recon_loss: 656842.4375; val_masked_gp_l1_reg_loss: 6093.8696; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85500.0312; val_chrom_access_recon_loss: 1297621.2500; val_global_loss: 2111745.0000; val_optim_loss: 2111745.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8250; val_auprc_score: 0.8218; val_best_acc_score: 0.6567; val_best_f1_score: 0.7354; train_kl_reg_loss: 25271.2101; train_edge_recon_loss: 39170.6007; train_gene_expr_recon_loss: 660143.1667; train_masked_gp_l1_reg_loss: 6091.7509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83110.8819; train_chrom_access_recon_loss: 1304357.3750; train_global_loss: 2118144.9306; train_optim_loss: 2118144.9306; val_kl_reg_loss: 24370.6875; val_edge_recon_loss: 40518.8398; val_gene_expr_recon_loss: 653822.6250; val_masked_gp_l1_reg_loss: 6086.6313; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80208.5625; val_chrom_access_recon_loss: 1294902.3750; val_global_loss: 2099909.7500; val_optim_loss: 2099909.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8391; val_auprc_score: 0.8360; val_best_acc_score: 0.6876; val_best_f1_score: 0.7510; train_kl_reg_loss: 24860.6968; train_edge_recon_loss: 39146.6189; train_gene_expr_recon_loss: 656973.9097; train_masked_gp_l1_reg_loss: 6091.9780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78030.6224; train_chrom_access_recon_loss: 1302543.6944; train_global_loss: 2107647.5139; train_optim_loss: 2107647.5139; val_kl_reg_loss: 23538.9336; val_edge_recon_loss: 40490.6914; val_gene_expr_recon_loss: 651386.6250; val_masked_gp_l1_reg_loss: 6092.1494; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75388.4766; val_chrom_access_recon_loss: 1292244.7500; val_global_loss: 2089141.6250; val_optim_loss: 2089141.6250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8452; val_auprc_score: 0.8453; val_best_acc_score: 0.7013; val_best_f1_score: 0.7559; train_kl_reg_loss: 24388.2578; train_edge_recon_loss: 39119.6875; train_gene_expr_recon_loss: 657018.7708; train_masked_gp_l1_reg_loss: 6100.6386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73397.9965; train_chrom_access_recon_loss: 1305592.1528; train_global_loss: 2105617.4861; train_optim_loss: 2105617.4861; val_kl_reg_loss: 23026.7617; val_edge_recon_loss: 40472.3086; val_gene_expr_recon_loss: 649119.2500; val_masked_gp_l1_reg_loss: 6101.9697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70969.5391; val_chrom_access_recon_loss: 1289934.1250; val_global_loss: 2079624.0000; val_optim_loss: 2079624.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8605; val_auprc_score: 0.8606; val_best_acc_score: 0.7312; val_best_f1_score: 0.7723; train_kl_reg_loss: 23835.4907; train_edge_recon_loss: 39093.6610; train_gene_expr_recon_loss: 652651.2569; train_masked_gp_l1_reg_loss: 6109.0935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69147.5165; train_chrom_access_recon_loss: 1296945.3611; train_global_loss: 2087782.3750; train_optim_loss: 2087782.3750; val_kl_reg_loss: 22504.6953; val_edge_recon_loss: 40437.8789; val_gene_expr_recon_loss: 647129.1250; val_masked_gp_l1_reg_loss: 6114.0420; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66922.9844; val_chrom_access_recon_loss: 1287790.7500; val_global_loss: 2070899.5000; val_optim_loss: 2070899.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8752; val_auprc_score: 0.8766; val_best_acc_score: 0.7604; val_best_f1_score: 0.7902; train_kl_reg_loss: 23347.0122; train_edge_recon_loss: 39055.6753; train_gene_expr_recon_loss: 647728.0764; train_masked_gp_l1_reg_loss: 6118.2287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65248.1819; train_chrom_access_recon_loss: 1287451.8750; train_global_loss: 2068949.0694; train_optim_loss: 2068949.0694; val_kl_reg_loss: 22807.6367; val_edge_recon_loss: 40418.3438; val_gene_expr_recon_loss: 644523.0000; val_masked_gp_l1_reg_loss: 6117.6909; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63204.5703; val_chrom_access_recon_loss: 1285621.6250; val_global_loss: 2062692.8750; val_optim_loss: 2062692.8750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8772; val_auprc_score: 0.8710; val_best_acc_score: 0.7847; val_best_f1_score: 0.8032; train_kl_reg_loss: 22978.2435; train_edge_recon_loss: 39021.9622; train_gene_expr_recon_loss: 646086.4514; train_masked_gp_l1_reg_loss: 6120.2144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61660.4505; train_chrom_access_recon_loss: 1293968.0000; train_global_loss: 2069835.3194; train_optim_loss: 2069835.3194; val_kl_reg_loss: 21765.6875; val_edge_recon_loss: 40367.8438; val_gene_expr_recon_loss: 643409.3125; val_masked_gp_l1_reg_loss: 6120.4756; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59772.5156; val_chrom_access_recon_loss: 1283470.8750; val_global_loss: 2054906.7500; val_optim_loss: 2054906.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8856; val_auprc_score: 0.8770; val_best_acc_score: 0.8032; val_best_f1_score: 0.8120; train_kl_reg_loss: 22780.4891; train_edge_recon_loss: 38985.6480; train_gene_expr_recon_loss: 647442.6806; train_masked_gp_l1_reg_loss: 6125.9406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58344.0399; train_chrom_access_recon_loss: 1296651.7083; train_global_loss: 2070330.5000; train_optim_loss: 2070330.5000; val_kl_reg_loss: 20575.6504; val_edge_recon_loss: 40285.2969; val_gene_expr_recon_loss: 643982.1250; val_masked_gp_l1_reg_loss: 6126.8428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56595.7617; val_chrom_access_recon_loss: 1284073.2500; val_global_loss: 2051638.8750; val_optim_loss: 2051638.8750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8990; val_auprc_score: 0.8908; val_best_acc_score: 0.8246; val_best_f1_score: 0.8296; train_kl_reg_loss: 22302.8648; train_edge_recon_loss: 38934.8155; train_gene_expr_recon_loss: 648679.8819; train_masked_gp_l1_reg_loss: 6137.0624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55286.8498; train_chrom_access_recon_loss: 1293490.8056; train_global_loss: 2064832.2639; train_optim_loss: 2064832.2639; val_kl_reg_loss: 20776.6602; val_edge_recon_loss: 40265.5703; val_gene_expr_recon_loss: 641090.5625; val_masked_gp_l1_reg_loss: 6137.6357; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53673.5547; val_chrom_access_recon_loss: 1281427.8750; val_global_loss: 2043371.8750; val_optim_loss: 2043371.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9043; val_auprc_score: 0.8976; val_best_acc_score: 0.8285; val_best_f1_score: 0.8297; train_kl_reg_loss: 21964.2289; train_edge_recon_loss: 38871.4362; train_gene_expr_recon_loss: 646282.0208; train_masked_gp_l1_reg_loss: 6144.3875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52457.8264; train_chrom_access_recon_loss: 1293174.8611; train_global_loss: 2058894.7778; train_optim_loss: 2058894.7778; val_kl_reg_loss: 20091.3555; val_edge_recon_loss: 40202.6055; val_gene_expr_recon_loss: 640396.6250; val_masked_gp_l1_reg_loss: 6146.2573; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50958.4180; val_chrom_access_recon_loss: 1279934.8750; val_global_loss: 2037730.1250; val_optim_loss: 2037730.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9045; val_auprc_score: 0.8958; val_best_acc_score: 0.8281; val_best_f1_score: 0.8280; train_kl_reg_loss: 21635.8403; train_edge_recon_loss: 38826.0747; train_gene_expr_recon_loss: 642860.6111; train_masked_gp_l1_reg_loss: 6161.2251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49838.6975; train_chrom_access_recon_loss: 1293441.3333; train_global_loss: 2052763.7639; train_optim_loss: 2052763.7639; val_kl_reg_loss: 20055.1680; val_edge_recon_loss: 40164.8867; val_gene_expr_recon_loss: 638739.6875; val_masked_gp_l1_reg_loss: 6165.5278; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48450.8203; val_chrom_access_recon_loss: 1277739.2500; val_global_loss: 2031315.2500; val_optim_loss: 2031315.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9139; val_auprc_score: 0.9058; val_best_acc_score: 0.8370; val_best_f1_score: 0.8342; train_kl_reg_loss: 21305.2689; train_edge_recon_loss: 38774.1228; train_gene_expr_recon_loss: 641824.4583; train_masked_gp_l1_reg_loss: 6169.3873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47408.0508; train_chrom_access_recon_loss: 1287851.3056; train_global_loss: 2043332.5972; train_optim_loss: 2043332.5972; val_kl_reg_loss: 20192.2930; val_edge_recon_loss: 40112.6641; val_gene_expr_recon_loss: 636880.5000; val_masked_gp_l1_reg_loss: 6167.1631; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46115.0078; val_chrom_access_recon_loss: 1275498.7500; val_global_loss: 2024966.3750; val_optim_loss: 2024966.3750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9157; val_auprc_score: 0.8985; val_best_acc_score: 0.8395; val_best_f1_score: 0.8355; train_kl_reg_loss: 21070.8479; train_edge_recon_loss: 38739.8164; train_gene_expr_recon_loss: 639823.1458; train_masked_gp_l1_reg_loss: 6170.1821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45140.4440; train_chrom_access_recon_loss: 1282907.5417; train_global_loss: 2033851.9444; train_optim_loss: 2033851.9444; val_kl_reg_loss: 20172.1367; val_edge_recon_loss: 40080.2188; val_gene_expr_recon_loss: 635612.8750; val_masked_gp_l1_reg_loss: 6171.3765; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43931.2070; val_chrom_access_recon_loss: 1273692.6250; val_global_loss: 2019660.5000; val_optim_loss: 2019660.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9242; val_auprc_score: 0.9168; val_best_acc_score: 0.8451; val_best_f1_score: 0.8377; train_kl_reg_loss: 20851.7127; train_edge_recon_loss: 38666.5773; train_gene_expr_recon_loss: 639381.0972; train_masked_gp_l1_reg_loss: 6176.4171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43024.7678; train_chrom_access_recon_loss: 1279912.4306; train_global_loss: 2028012.9722; train_optim_loss: 2028012.9722; val_kl_reg_loss: 20030.4062; val_edge_recon_loss: 40010.4805; val_gene_expr_recon_loss: 634588.0000; val_masked_gp_l1_reg_loss: 6178.9941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41903.8359; val_chrom_access_recon_loss: 1271341.8750; val_global_loss: 2014053.5000; val_optim_loss: 2014053.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9221; val_auprc_score: 0.9100; val_best_acc_score: 0.8375; val_best_f1_score: 0.8506; train_kl_reg_loss: 17885.2255; train_edge_recon_loss: 40094.2031; train_gene_expr_recon_loss: 946107.4514; train_masked_gp_l1_reg_loss: 6300.8506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40898.5981; train_chrom_access_recon_loss: 1350246.8194; train_global_loss: 2401533.1944; train_optim_loss: 2401533.1944; val_kl_reg_loss: 15710.7520; val_edge_recon_loss: 40364.0234; val_gene_expr_recon_loss: 932921.7500; val_masked_gp_l1_reg_loss: 6536.5093; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39567.1719; val_chrom_access_recon_loss: 1341648.0000; val_global_loss: 2376748.2500; val_optim_loss: 2376748.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9232; val_auprc_score: 0.9143; val_best_acc_score: 0.8394; val_best_f1_score: 0.8525; train_kl_reg_loss: 16373.4137; train_edge_recon_loss: 40116.5234; train_gene_expr_recon_loss: 933027.1667; train_masked_gp_l1_reg_loss: 6739.2240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38488.0864; train_chrom_access_recon_loss: 1355716.7222; train_global_loss: 2390461.1667; train_optim_loss: 2390461.1667; val_kl_reg_loss: 14705.8408; val_edge_recon_loss: 40371.0859; val_gene_expr_recon_loss: 925833.9375; val_masked_gp_l1_reg_loss: 6974.3545; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37163.8242; val_chrom_access_recon_loss: 1339473.6250; val_global_loss: 2364522.7500; val_optim_loss: 2364522.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9282; val_auprc_score: 0.9150; val_best_acc_score: 0.8514; val_best_f1_score: 0.8606; train_kl_reg_loss: 15952.5126; train_edge_recon_loss: 40114.1163; train_gene_expr_recon_loss: 925520.1181; train_masked_gp_l1_reg_loss: 7117.9603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36161.1458; train_chrom_access_recon_loss: 1349239.5417; train_global_loss: 2374105.4167; train_optim_loss: 2374105.4167; val_kl_reg_loss: 14543.4893; val_edge_recon_loss: 40336.4141; val_gene_expr_recon_loss: 920217.8125; val_masked_gp_l1_reg_loss: 7274.8726; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34949.6445; val_chrom_access_recon_loss: 1337340.1250; val_global_loss: 2354662.2500; val_optim_loss: 2354662.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9285; val_auprc_score: 0.9171; val_best_acc_score: 0.8580; val_best_f1_score: 0.8648; train_kl_reg_loss: 15936.1597; train_edge_recon_loss: 40110.7556; train_gene_expr_recon_loss: 927727.3472; train_masked_gp_l1_reg_loss: 7369.0806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34049.4562; train_chrom_access_recon_loss: 1350231.1806; train_global_loss: 2375423.9722; train_optim_loss: 2375423.9722; val_kl_reg_loss: 14362.9736; val_edge_recon_loss: 40304.7070; val_gene_expr_recon_loss: 916008.7500; val_masked_gp_l1_reg_loss: 7466.7476; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32961.3906; val_chrom_access_recon_loss: 1335705.8750; val_global_loss: 2346810.5000; val_optim_loss: 2346810.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9309; val_auprc_score: 0.9173; val_best_acc_score: 0.8628; val_best_f1_score: 0.8689; train_kl_reg_loss: 15681.4403; train_edge_recon_loss: 40095.2973; train_gene_expr_recon_loss: 918020.3264; train_masked_gp_l1_reg_loss: 7437.8979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32796.5859; train_chrom_access_recon_loss: 1342625.4028; train_global_loss: 2356656.9722; train_optim_loss: 2356656.9722; val_kl_reg_loss: 14503.8594; val_edge_recon_loss: 40303.6172; val_gene_expr_recon_loss: 915590.6250; val_masked_gp_l1_reg_loss: 7415.3950; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32612.0469; val_chrom_access_recon_loss: 1335935.5000; val_global_loss: 2346361.0000; val_optim_loss: 2346361.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9281; val_auprc_score: 0.9164; val_best_acc_score: 0.8560; val_best_f1_score: 0.8635; train_kl_reg_loss: 15929.8146; train_edge_recon_loss: 40100.1003; train_gene_expr_recon_loss: 918320.7014; train_masked_gp_l1_reg_loss: 7412.4608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32499.5423; train_chrom_access_recon_loss: 1342911.7639; train_global_loss: 2357174.4444; train_optim_loss: 2357174.4444; val_kl_reg_loss: 14657.9229; val_edge_recon_loss: 40305.8906; val_gene_expr_recon_loss: 914917.7500; val_masked_gp_l1_reg_loss: 7405.3071; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32354.3789; val_chrom_access_recon_loss: 1335342.6250; val_global_loss: 2344984.0000; val_optim_loss: 2344984.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9307; val_auprc_score: 0.9188; val_best_acc_score: 0.8631; val_best_f1_score: 0.8691; train_kl_reg_loss: 15918.1285; train_edge_recon_loss: 40095.8576; train_gene_expr_recon_loss: 918698.6528; train_masked_gp_l1_reg_loss: 7402.2102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32248.8466; train_chrom_access_recon_loss: 1350186.3611; train_global_loss: 2364550.0833; train_optim_loss: 2364550.0833; val_kl_reg_loss: 14545.8652; val_edge_recon_loss: 40302.5195; val_gene_expr_recon_loss: 914582.5000; val_masked_gp_l1_reg_loss: 7398.9189; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32119.7168; val_chrom_access_recon_loss: 1334850.0000; val_global_loss: 2343799.5000; val_optim_loss: 2343799.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9314; val_auprc_score: 0.9209; val_best_acc_score: 0.8601; val_best_f1_score: 0.8665; train_kl_reg_loss: 15841.4129; train_edge_recon_loss: 40080.9093; train_gene_expr_recon_loss: 922255.2153; train_masked_gp_l1_reg_loss: 7397.8873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32020.9913; train_chrom_access_recon_loss: 1350468.2778; train_global_loss: 2368064.7222; train_optim_loss: 2368064.7222; val_kl_reg_loss: 14582.0312; val_edge_recon_loss: 40300.5039; val_gene_expr_recon_loss: 914383.8125; val_masked_gp_l1_reg_loss: 7397.6226; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31902.5879; val_chrom_access_recon_loss: 1335080.7500; val_global_loss: 2343647.2500; val_optim_loss: 2343647.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 32 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9219
val AUPRC score: 0.9112
val best accuracy score: 0.8323
val best F1 score: 0.8486
val target rna MSE score: 3.6406
val source rna MSE score: 3.1352
val target atac MSE score: 0.1310
val source atac MSE score: 0.0192
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
