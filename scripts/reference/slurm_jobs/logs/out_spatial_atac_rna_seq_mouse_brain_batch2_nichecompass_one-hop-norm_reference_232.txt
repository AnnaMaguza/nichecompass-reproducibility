[True]
Run timestamp: 10102023_102323_232.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_232']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6914; val_auprc_score: 0.6627; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 47094.7663; train_edge_recon_loss: 744617.3655; train_gene_expr_recon_loss: 23311843.4242; train_masked_gp_l1_reg_loss: 105918.1722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3326980.3977; train_chrom_access_recon_loss: 6956173.6061; train_global_loss: 34492627.6970; train_optim_loss: 34492627.6970; val_kl_reg_loss: 71309.5117; val_edge_recon_loss: 813071.9922; val_gene_expr_recon_loss: 21184381.7500; val_masked_gp_l1_reg_loss: 85101.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2258898.5000; val_chrom_access_recon_loss: 6624811.8125; val_global_loss: 31037575.0000; val_optim_loss: 31037575.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7166; val_auprc_score: 0.7054; val_best_acc_score: 0.5605; val_best_f1_score: 0.6887; train_kl_reg_loss: 82057.3002; train_edge_recon_loss: 747553.6335; train_gene_expr_recon_loss: 21275534.5758; train_masked_gp_l1_reg_loss: 77964.2380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1468942.2273; train_chrom_access_recon_loss: 6597695.0682; train_global_loss: 30249747.2424; train_optim_loss: 30249747.2424; val_kl_reg_loss: 83385.5898; val_edge_recon_loss: 812421.0625; val_gene_expr_recon_loss: 21063576.2500; val_masked_gp_l1_reg_loss: 73945.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 866976.0000; val_chrom_access_recon_loss: 6628806.5625; val_global_loss: 29529111.5000; val_optim_loss: 29529111.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7739; val_auprc_score: 0.7629; val_best_acc_score: 0.6797; val_best_f1_score: 0.7307; train_kl_reg_loss: 78352.4922; train_edge_recon_loss: 739182.7121; train_gene_expr_recon_loss: 21058724.3333; train_masked_gp_l1_reg_loss: 72756.7525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 591233.3310; train_chrom_access_recon_loss: 6555903.0076; train_global_loss: 29096152.6364; train_optim_loss: 29096152.6364; val_kl_reg_loss: 67701.1787; val_edge_recon_loss: 809733.6250; val_gene_expr_recon_loss: 20662783.0000; val_masked_gp_l1_reg_loss: 72568.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 395863.8750; val_chrom_access_recon_loss: 6461402.3750; val_global_loss: 28470052.5000; val_optim_loss: 28470052.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8324; val_auprc_score: 0.8093; val_best_acc_score: 0.7297; val_best_f1_score: 0.7421; train_kl_reg_loss: 71635.5312; train_edge_recon_loss: 732941.4678; train_gene_expr_recon_loss: 20890491.0303; train_masked_gp_l1_reg_loss: 73139.3933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 304596.0357; train_chrom_access_recon_loss: 6510403.1894; train_global_loss: 28583206.3939; train_optim_loss: 28583206.3939; val_kl_reg_loss: 71362.8311; val_edge_recon_loss: 798754.2188; val_gene_expr_recon_loss: 20729782.2500; val_masked_gp_l1_reg_loss: 74175.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239954.9531; val_chrom_access_recon_loss: 6469559.2500; val_global_loss: 28383589.0000; val_optim_loss: 28383589.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8789; val_auprc_score: 0.8563; val_best_acc_score: 0.8015; val_best_f1_score: 0.8227; train_kl_reg_loss: 66450.5991; train_edge_recon_loss: 722835.0038; train_gene_expr_recon_loss: 20757994.6667; train_masked_gp_l1_reg_loss: 75332.5163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 208191.8433; train_chrom_access_recon_loss: 6473965.9015; train_global_loss: 28304770.3939; train_optim_loss: 28304770.3939; val_kl_reg_loss: 60016.8398; val_edge_recon_loss: 759746.0703; val_gene_expr_recon_loss: 20269226.2500; val_masked_gp_l1_reg_loss: 76937.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183098.6875; val_chrom_access_recon_loss: 6427962.8125; val_global_loss: 27776987.7500; val_optim_loss: 27776987.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8902; val_auprc_score: 0.8583; val_best_acc_score: 0.8197; val_best_f1_score: 0.8370; train_kl_reg_loss: 64907.5651; train_edge_recon_loss: 688411.7509; train_gene_expr_recon_loss: 20597643.8182; train_masked_gp_l1_reg_loss: 78549.1926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165515.8930; train_chrom_access_recon_loss: 6431064.6364; train_global_loss: 28026092.7879; train_optim_loss: 28026092.7879; val_kl_reg_loss: 69660.6484; val_edge_recon_loss: 666836.8984; val_gene_expr_recon_loss: 20415707.0000; val_masked_gp_l1_reg_loss: 80040.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149827.9844; val_chrom_access_recon_loss: 6389577.1875; val_global_loss: 27771650.0000; val_optim_loss: 27771650.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8994; val_auprc_score: 0.8712; val_best_acc_score: 0.8254; val_best_f1_score: 0.8373; train_kl_reg_loss: 75508.4441; train_edge_recon_loss: 639412.7519; train_gene_expr_recon_loss: 20487238.6364; train_masked_gp_l1_reg_loss: 81190.6436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137585.0014; train_chrom_access_recon_loss: 6406802.1061; train_global_loss: 27827737.3636; train_optim_loss: 27827737.3636; val_kl_reg_loss: 77784.9717; val_edge_recon_loss: 629365.5781; val_gene_expr_recon_loss: 20294538.5000; val_masked_gp_l1_reg_loss: 82525.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127270.7734; val_chrom_access_recon_loss: 6430336.1250; val_global_loss: 27641821.0000; val_optim_loss: 27641821.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8990; val_auprc_score: 0.8626; val_best_acc_score: 0.8280; val_best_f1_score: 0.8410; train_kl_reg_loss: 77719.7737; train_edge_recon_loss: 624405.9441; train_gene_expr_recon_loss: 20399009.2727; train_masked_gp_l1_reg_loss: 83291.3480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119566.2855; train_chrom_access_recon_loss: 6379078.2424; train_global_loss: 27683070.9697; train_optim_loss: 27683070.9697; val_kl_reg_loss: 74882.5205; val_edge_recon_loss: 633504.5156; val_gene_expr_recon_loss: 20068211.7500; val_masked_gp_l1_reg_loss: 84427.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113171.8594; val_chrom_access_recon_loss: 6377808.4375; val_global_loss: 27352007.2500; val_optim_loss: 27352007.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9132; val_auprc_score: 0.8898; val_best_acc_score: 0.8426; val_best_f1_score: 0.8525; train_kl_reg_loss: 76269.2946; train_edge_recon_loss: 619202.0028; train_gene_expr_recon_loss: 20308220.5758; train_masked_gp_l1_reg_loss: 85159.4835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108037.1886; train_chrom_access_recon_loss: 6353576.4545; train_global_loss: 27550464.9091; train_optim_loss: 27550464.9091; val_kl_reg_loss: 74581.5508; val_edge_recon_loss: 618204.5234; val_gene_expr_recon_loss: 20077825.5000; val_masked_gp_l1_reg_loss: 85853.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103438.9922; val_chrom_access_recon_loss: 6305503.8750; val_global_loss: 27265407.5000; val_optim_loss: 27265407.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9162; val_auprc_score: 0.8916; val_best_acc_score: 0.8431; val_best_f1_score: 0.8518; train_kl_reg_loss: 74955.1871; train_edge_recon_loss: 612012.7320; train_gene_expr_recon_loss: 20208292.4242; train_masked_gp_l1_reg_loss: 86315.4570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99952.1420; train_chrom_access_recon_loss: 6328894.8485; train_global_loss: 27410422.6667; train_optim_loss: 27410422.6667; val_kl_reg_loss: 72097.7373; val_edge_recon_loss: 617333.8438; val_gene_expr_recon_loss: 20061747.5000; val_masked_gp_l1_reg_loss: 86930.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96510.4219; val_chrom_access_recon_loss: 6294469.5625; val_global_loss: 27229088.7500; val_optim_loss: 27229088.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9084; val_auprc_score: 0.8785; val_best_acc_score: 0.8375; val_best_f1_score: 0.8518; train_kl_reg_loss: 73742.4161; train_edge_recon_loss: 610104.5379; train_gene_expr_recon_loss: 20138899.3939; train_masked_gp_l1_reg_loss: 87596.3845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93207.0312; train_chrom_access_recon_loss: 6306913.7348; train_global_loss: 27310463.1818; train_optim_loss: 27310463.1818; val_kl_reg_loss: 71961.7021; val_edge_recon_loss: 621779.8594; val_gene_expr_recon_loss: 20183055.2500; val_masked_gp_l1_reg_loss: 88075.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91039.4922; val_chrom_access_recon_loss: 6308692.1250; val_global_loss: 27364604.7500; val_optim_loss: 27364604.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9229; val_auprc_score: 0.8948; val_best_acc_score: 0.8573; val_best_f1_score: 0.8665; train_kl_reg_loss: 72591.6694; train_edge_recon_loss: 605771.3390; train_gene_expr_recon_loss: 20070460.2121; train_masked_gp_l1_reg_loss: 88791.3435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88291.9165; train_chrom_access_recon_loss: 6287662.4242; train_global_loss: 27213569.0303; train_optim_loss: 27213569.0303; val_kl_reg_loss: 70414.7881; val_edge_recon_loss: 605106.6094; val_gene_expr_recon_loss: 19776885.2500; val_masked_gp_l1_reg_loss: 89497.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86212.5859; val_chrom_access_recon_loss: 6198894.4375; val_global_loss: 26827010.7500; val_optim_loss: 26827010.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9303; val_auprc_score: 0.9061; val_best_acc_score: 0.8638; val_best_f1_score: 0.8721; train_kl_reg_loss: 71269.8815; train_edge_recon_loss: 604168.1354; train_gene_expr_recon_loss: 20008841.5455; train_masked_gp_l1_reg_loss: 89686.1597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84382.4388; train_chrom_access_recon_loss: 6266637.8106; train_global_loss: 27124985.7273; train_optim_loss: 27124985.7273; val_kl_reg_loss: 70522.8174; val_edge_recon_loss: 601307.1016; val_gene_expr_recon_loss: 19928500.0000; val_masked_gp_l1_reg_loss: 90418.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82773.7188; val_chrom_access_recon_loss: 6274663.0625; val_global_loss: 27048185.2500; val_optim_loss: 27048185.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9283; val_auprc_score: 0.9096; val_best_acc_score: 0.8579; val_best_f1_score: 0.8680; train_kl_reg_loss: 69940.2522; train_edge_recon_loss: 601107.3343; train_gene_expr_recon_loss: 19935007.9091; train_masked_gp_l1_reg_loss: 90670.9004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81148.5518; train_chrom_access_recon_loss: 6244850.9773; train_global_loss: 27022726.1515; train_optim_loss: 27022726.1515; val_kl_reg_loss: 70464.5518; val_edge_recon_loss: 606680.7656; val_gene_expr_recon_loss: 19761748.0000; val_masked_gp_l1_reg_loss: 91214.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79989.4297; val_chrom_access_recon_loss: 6241902.4375; val_global_loss: 26851999.7500; val_optim_loss: 26851999.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9299; val_auprc_score: 0.9050; val_best_acc_score: 0.8700; val_best_f1_score: 0.8783; train_kl_reg_loss: 69427.3648; train_edge_recon_loss: 599369.0445; train_gene_expr_recon_loss: 19891158.7273; train_masked_gp_l1_reg_loss: 91521.0161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78678.3804; train_chrom_access_recon_loss: 6223222.5076; train_global_loss: 26953377.0909; train_optim_loss: 26953377.0909; val_kl_reg_loss: 68589.0234; val_edge_recon_loss: 598741.7188; val_gene_expr_recon_loss: 19778071.7500; val_masked_gp_l1_reg_loss: 92048.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77937.6328; val_chrom_access_recon_loss: 6204084.9375; val_global_loss: 26819473.5000; val_optim_loss: 26819473.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9363; val_auprc_score: 0.9190; val_best_acc_score: 0.8692; val_best_f1_score: 0.8765; train_kl_reg_loss: 68689.1160; train_edge_recon_loss: 597896.2775; train_gene_expr_recon_loss: 19816988.9394; train_masked_gp_l1_reg_loss: 92460.4991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76828.6078; train_chrom_access_recon_loss: 6206137.4318; train_global_loss: 26859001.0606; train_optim_loss: 26859001.0606; val_kl_reg_loss: 68229.7354; val_edge_recon_loss: 599906.1094; val_gene_expr_recon_loss: 19786263.7500; val_masked_gp_l1_reg_loss: 93056.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76079.0234; val_chrom_access_recon_loss: 6194908.6250; val_global_loss: 26818444.0000; val_optim_loss: 26818444.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9336; val_auprc_score: 0.9125; val_best_acc_score: 0.8721; val_best_f1_score: 0.8784; train_kl_reg_loss: 68094.9239; train_edge_recon_loss: 594162.0057; train_gene_expr_recon_loss: 19789609.9697; train_masked_gp_l1_reg_loss: 93068.1772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75404.5833; train_chrom_access_recon_loss: 6197290.6591; train_global_loss: 26817630.1515; train_optim_loss: 26817630.1515; val_kl_reg_loss: 67288.3125; val_edge_recon_loss: 598829.9062; val_gene_expr_recon_loss: 19420058.2500; val_masked_gp_l1_reg_loss: 93565.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75003.5078; val_chrom_access_recon_loss: 6164922.7500; val_global_loss: 26419669.2500; val_optim_loss: 26419669.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9367; val_auprc_score: 0.9192; val_best_acc_score: 0.8684; val_best_f1_score: 0.8766; train_kl_reg_loss: 67328.2720; train_edge_recon_loss: 593563.3428; train_gene_expr_recon_loss: 19731413.7273; train_masked_gp_l1_reg_loss: 93890.9659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74188.8196; train_chrom_access_recon_loss: 6170000.2273; train_global_loss: 26730385.1212; train_optim_loss: 26730385.1212; val_kl_reg_loss: 67397.2168; val_edge_recon_loss: 595855.8281; val_gene_expr_recon_loss: 19442332.7500; val_masked_gp_l1_reg_loss: 94459.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74036.4922; val_chrom_access_recon_loss: 6138194.6875; val_global_loss: 26412276.2500; val_optim_loss: 26412276.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9481; val_auprc_score: 0.9348; val_best_acc_score: 0.8898; val_best_f1_score: 0.8945; train_kl_reg_loss: 66534.8269; train_edge_recon_loss: 593020.4356; train_gene_expr_recon_loss: 19686289.0606; train_masked_gp_l1_reg_loss: 94559.2707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73376.9679; train_chrom_access_recon_loss: 6158090.7803; train_global_loss: 26671871.5152; train_optim_loss: 26671871.5152; val_kl_reg_loss: 65079.8691; val_edge_recon_loss: 593951.1875; val_gene_expr_recon_loss: 19596362.7500; val_masked_gp_l1_reg_loss: 95004.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73116.6953; val_chrom_access_recon_loss: 6227201.1875; val_global_loss: 26650714.7500; val_optim_loss: 26650714.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9391; val_auprc_score: 0.9199; val_best_acc_score: 0.8812; val_best_f1_score: 0.8878; train_kl_reg_loss: 66252.1831; train_edge_recon_loss: 591840.1989; train_gene_expr_recon_loss: 19655185.4848; train_masked_gp_l1_reg_loss: 95248.4756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72600.7403; train_chrom_access_recon_loss: 6149598.5682; train_global_loss: 26630725.7576; train_optim_loss: 26630725.7576; val_kl_reg_loss: 64736.5381; val_edge_recon_loss: 595761.4766; val_gene_expr_recon_loss: 19429845.5000; val_masked_gp_l1_reg_loss: 95471.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72491.3281; val_chrom_access_recon_loss: 6094363.1250; val_global_loss: 26352670.5000; val_optim_loss: 26352670.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9437; val_auprc_score: 0.9254; val_best_acc_score: 0.8869; val_best_f1_score: 0.8934; train_kl_reg_loss: 65432.1567; train_edge_recon_loss: 591330.5284; train_gene_expr_recon_loss: 19580737.9697; train_masked_gp_l1_reg_loss: 95798.7536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71966.9975; train_chrom_access_recon_loss: 6119013.1818; train_global_loss: 26524279.5152; train_optim_loss: 26524279.5152; val_kl_reg_loss: 66372.9756; val_edge_recon_loss: 592920.1797; val_gene_expr_recon_loss: 19483346.0000; val_masked_gp_l1_reg_loss: 96225.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71985.4141; val_chrom_access_recon_loss: 6091785.5000; val_global_loss: 26402637.0000; val_optim_loss: 26402637.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9450; val_auprc_score: 0.9270; val_best_acc_score: 0.8885; val_best_f1_score: 0.8956; train_kl_reg_loss: 64826.9873; train_edge_recon_loss: 590137.4839; train_gene_expr_recon_loss: 19541096.3636; train_masked_gp_l1_reg_loss: 96509.5143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71502.9008; train_chrom_access_recon_loss: 6105512.3485; train_global_loss: 26469585.7576; train_optim_loss: 26469585.7576; val_kl_reg_loss: 63699.1021; val_edge_recon_loss: 590284.9844; val_gene_expr_recon_loss: 19349782.5000; val_masked_gp_l1_reg_loss: 97045.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71348.0469; val_chrom_access_recon_loss: 6119571.1250; val_global_loss: 26291731.0000; val_optim_loss: 26291731.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9480; val_auprc_score: 0.9314; val_best_acc_score: 0.8915; val_best_f1_score: 0.8974; train_kl_reg_loss: 64489.4466; train_edge_recon_loss: 588381.2301; train_gene_expr_recon_loss: 19484670.6364; train_masked_gp_l1_reg_loss: 97312.7582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70938.1193; train_chrom_access_recon_loss: 6091053.6667; train_global_loss: 26396845.9697; train_optim_loss: 26396845.9697; val_kl_reg_loss: 62760.5239; val_edge_recon_loss: 587733.8984; val_gene_expr_recon_loss: 19408482.7500; val_masked_gp_l1_reg_loss: 97576.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70700.4531; val_chrom_access_recon_loss: 6099850.8750; val_global_loss: 26327104.2500; val_optim_loss: 26327104.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9472; val_auprc_score: 0.9338; val_best_acc_score: 0.8866; val_best_f1_score: 0.8934; train_kl_reg_loss: 63969.9665; train_edge_recon_loss: 589612.2595; train_gene_expr_recon_loss: 19441772.0909; train_masked_gp_l1_reg_loss: 97875.5200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70330.1489; train_chrom_access_recon_loss: 6070078.4318; train_global_loss: 26333638.5455; train_optim_loss: 26333638.5455; val_kl_reg_loss: 64097.4375; val_edge_recon_loss: 595648.6953; val_gene_expr_recon_loss: 19297096.5000; val_masked_gp_l1_reg_loss: 98514.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70804.6250; val_chrom_access_recon_loss: 6101698.1875; val_global_loss: 26227858.7500; val_optim_loss: 26227858.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9442; val_auprc_score: 0.9260; val_best_acc_score: 0.8858; val_best_f1_score: 0.8917; train_kl_reg_loss: 63550.6733; train_edge_recon_loss: 585927.4991; train_gene_expr_recon_loss: 19403351.8182; train_masked_gp_l1_reg_loss: 98796.3877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70273.9339; train_chrom_access_recon_loss: 6056367.6515; train_global_loss: 26278268.0909; train_optim_loss: 26278268.0909; val_kl_reg_loss: 62283.1460; val_edge_recon_loss: 593217.7969; val_gene_expr_recon_loss: 19156612.2500; val_masked_gp_l1_reg_loss: 99191.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70319.6016; val_chrom_access_recon_loss: 6031911.1250; val_global_loss: 26013536.7500; val_optim_loss: 26013536.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9490; val_auprc_score: 0.9361; val_best_acc_score: 0.8917; val_best_f1_score: 0.8962; train_kl_reg_loss: 63191.5156; train_edge_recon_loss: 584320.8911; train_gene_expr_recon_loss: 19363266.5455; train_masked_gp_l1_reg_loss: 99592.9397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69997.6310; train_chrom_access_recon_loss: 6034095.4167; train_global_loss: 26214465.0909; train_optim_loss: 26214465.0909; val_kl_reg_loss: 64180.0044; val_edge_recon_loss: 592237.7734; val_gene_expr_recon_loss: 19340301.2500; val_masked_gp_l1_reg_loss: 99994.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70063.3906; val_chrom_access_recon_loss: 6114326.3750; val_global_loss: 26281103.5000; val_optim_loss: 26281103.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9485; val_auprc_score: 0.9276; val_best_acc_score: 0.8931; val_best_f1_score: 0.8979; train_kl_reg_loss: 62573.7369; train_edge_recon_loss: 588231.9583; train_gene_expr_recon_loss: 19344538.8788; train_masked_gp_l1_reg_loss: 100214.9324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69817.4388; train_chrom_access_recon_loss: 6031840.1515; train_global_loss: 26197217.0909; train_optim_loss: 26197217.0909; val_kl_reg_loss: 63092.8081; val_edge_recon_loss: 590315.2188; val_gene_expr_recon_loss: 19231624.5000; val_masked_gp_l1_reg_loss: 100814.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69854.3359; val_chrom_access_recon_loss: 6037402.3750; val_global_loss: 26093103.5000; val_optim_loss: 26093103.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9507; val_auprc_score: 0.9375; val_best_acc_score: 0.8971; val_best_f1_score: 0.9005; train_kl_reg_loss: 62142.5338; train_edge_recon_loss: 584245.5814; train_gene_expr_recon_loss: 19296555.3333; train_masked_gp_l1_reg_loss: 101196.2512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69650.2525; train_chrom_access_recon_loss: 6012218.4091; train_global_loss: 26126008.5758; train_optim_loss: 26126008.5758; val_kl_reg_loss: 62580.3125; val_edge_recon_loss: 592921.8750; val_gene_expr_recon_loss: 19050316.7500; val_masked_gp_l1_reg_loss: 101557.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69596.3984; val_chrom_access_recon_loss: 6001012.7500; val_global_loss: 25877985.7500; val_optim_loss: 25877985.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9468; val_auprc_score: 0.9256; val_best_acc_score: 0.8880; val_best_f1_score: 0.8941; train_kl_reg_loss: 61900.4703; train_edge_recon_loss: 585240.1468; train_gene_expr_recon_loss: 19242950.1212; train_masked_gp_l1_reg_loss: 101954.6306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69730.2692; train_chrom_access_recon_loss: 5994608.7348; train_global_loss: 26056384.7273; train_optim_loss: 26056384.7273; val_kl_reg_loss: 61901.4478; val_edge_recon_loss: 588403.0547; val_gene_expr_recon_loss: 19066941.0000; val_masked_gp_l1_reg_loss: 102466.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69807.4297; val_chrom_access_recon_loss: 6026517.3750; val_global_loss: 25916036.5000; val_optim_loss: 25916036.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9525; val_auprc_score: 0.9400; val_best_acc_score: 0.8944; val_best_f1_score: 0.8991; train_kl_reg_loss: 61560.5268; train_edge_recon_loss: 585052.2159; train_gene_expr_recon_loss: 19226980.2121; train_masked_gp_l1_reg_loss: 102717.8214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69667.9646; train_chrom_access_recon_loss: 5976414.6894; train_global_loss: 26022393.3636; train_optim_loss: 26022393.3636; val_kl_reg_loss: 62121.0220; val_edge_recon_loss: 591990.0938; val_gene_expr_recon_loss: 19212530.5000; val_masked_gp_l1_reg_loss: 103204.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69596.8047; val_chrom_access_recon_loss: 5998961.3125; val_global_loss: 26038402.7500; val_optim_loss: 26038402.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9492; val_auprc_score: 0.9324; val_best_acc_score: 0.8987; val_best_f1_score: 0.9026; train_kl_reg_loss: 61622.0254; train_edge_recon_loss: 583912.8939; train_gene_expr_recon_loss: 19187777.2424; train_masked_gp_l1_reg_loss: 103579.9779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69569.2736; train_chrom_access_recon_loss: 5964168.2955; train_global_loss: 25970629.7273; train_optim_loss: 25970629.7273; val_kl_reg_loss: 61469.5098; val_edge_recon_loss: 587554.8438; val_gene_expr_recon_loss: 19183822.7500; val_masked_gp_l1_reg_loss: 104055.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69784.2812; val_chrom_access_recon_loss: 6015623.0000; val_global_loss: 26022310.2500; val_optim_loss: 26022310.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9574; val_auprc_score: 0.9474; val_best_acc_score: 0.8998; val_best_f1_score: 0.9036; train_kl_reg_loss: 61108.9253; train_edge_recon_loss: 582515.0256; train_gene_expr_recon_loss: 19137152.9697; train_masked_gp_l1_reg_loss: 104488.3291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69712.9020; train_chrom_access_recon_loss: 5941894.8485; train_global_loss: 25896873.3030; train_optim_loss: 25896873.3030; val_kl_reg_loss: 61521.5298; val_edge_recon_loss: 587448.8516; val_gene_expr_recon_loss: 19040763.2500; val_masked_gp_l1_reg_loss: 104989.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69867.4922; val_chrom_access_recon_loss: 5962347.6250; val_global_loss: 25826939.5000; val_optim_loss: 25826939.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9516; val_auprc_score: 0.9395; val_best_acc_score: 0.8944; val_best_f1_score: 0.8983; train_kl_reg_loss: 60669.8095; train_edge_recon_loss: 582724.4072; train_gene_expr_recon_loss: 19100570.0606; train_masked_gp_l1_reg_loss: 105402.1777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69828.8346; train_chrom_access_recon_loss: 5929412.6894; train_global_loss: 25848608.2424; train_optim_loss: 25848608.2424; val_kl_reg_loss: 60559.8511; val_edge_recon_loss: 589059.9453; val_gene_expr_recon_loss: 19014043.2500; val_masked_gp_l1_reg_loss: 105884.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69944.4766; val_chrom_access_recon_loss: 5927718.0000; val_global_loss: 25767209.2500; val_optim_loss: 25767209.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9552; val_auprc_score: 0.9407; val_best_acc_score: 0.8971; val_best_f1_score: 0.9017; train_kl_reg_loss: 60747.1810; train_edge_recon_loss: 581397.6231; train_gene_expr_recon_loss: 19066201.1515; train_masked_gp_l1_reg_loss: 106354.9045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69928.4560; train_chrom_access_recon_loss: 5913102.8636; train_global_loss: 25797732.1818; train_optim_loss: 25797732.1818; val_kl_reg_loss: 61126.9990; val_edge_recon_loss: 588809.7734; val_gene_expr_recon_loss: 19170282.2500; val_masked_gp_l1_reg_loss: 106883.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69974.0156; val_chrom_access_recon_loss: 5954572.1250; val_global_loss: 25951649.2500; val_optim_loss: 25951649.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9534; val_auprc_score: 0.9379; val_best_acc_score: 0.8971; val_best_f1_score: 0.9016; train_kl_reg_loss: 60451.8741; train_edge_recon_loss: 581437.4347; train_gene_expr_recon_loss: 19024898.3636; train_masked_gp_l1_reg_loss: 107182.0052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69888.0118; train_chrom_access_recon_loss: 5897666.8485; train_global_loss: 25741524.5152; train_optim_loss: 25741524.5152; val_kl_reg_loss: 59260.0059; val_edge_recon_loss: 590538.9922; val_gene_expr_recon_loss: 18990320.2500; val_masked_gp_l1_reg_loss: 107845.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70544.5625; val_chrom_access_recon_loss: 5979554.7500; val_global_loss: 25798064.0000; val_optim_loss: 25798064.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9556; val_auprc_score: 0.9413; val_best_acc_score: 0.8974; val_best_f1_score: 0.9018; train_kl_reg_loss: 60307.9392; train_edge_recon_loss: 581661.9489; train_gene_expr_recon_loss: 18995151.9394; train_masked_gp_l1_reg_loss: 108188.5340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70298.5472; train_chrom_access_recon_loss: 5879901.7121; train_global_loss: 25695510.8182; train_optim_loss: 25695510.8182; val_kl_reg_loss: 59616.6733; val_edge_recon_loss: 585146.1641; val_gene_expr_recon_loss: 19037321.7500; val_masked_gp_l1_reg_loss: 108648.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70183.0625; val_chrom_access_recon_loss: 5889142.7500; val_global_loss: 25750059.0000; val_optim_loss: 25750059.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9516; val_auprc_score: 0.9398; val_best_acc_score: 0.8920; val_best_f1_score: 0.8985; train_kl_reg_loss: 60067.7061; train_edge_recon_loss: 581779.9811; train_gene_expr_recon_loss: 18956093.4242; train_masked_gp_l1_reg_loss: 109112.1364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70270.7518; train_chrom_access_recon_loss: 5868904.7045; train_global_loss: 25646228.6364; train_optim_loss: 25646228.6364; val_kl_reg_loss: 59621.2324; val_edge_recon_loss: 589124.7266; val_gene_expr_recon_loss: 18877155.2500; val_masked_gp_l1_reg_loss: 109581.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70724.4766; val_chrom_access_recon_loss: 5867588.3750; val_global_loss: 25573795.5000; val_optim_loss: 25573795.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9452; val_auprc_score: 0.9260; val_best_acc_score: 0.8853; val_best_f1_score: 0.8932; train_kl_reg_loss: 59933.7560; train_edge_recon_loss: 581376.1723; train_gene_expr_recon_loss: 18940440.0909; train_masked_gp_l1_reg_loss: 109901.1059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70588.0511; train_chrom_access_recon_loss: 5858722.9470; train_global_loss: 25620962.2727; train_optim_loss: 25620962.2727; val_kl_reg_loss: 61124.7773; val_edge_recon_loss: 594940.8047; val_gene_expr_recon_loss: 18926511.2500; val_masked_gp_l1_reg_loss: 110437.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71221.5234; val_chrom_access_recon_loss: 5955474.7500; val_global_loss: 25719712.2500; val_optim_loss: 25719712.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9516; val_auprc_score: 0.9350; val_best_acc_score: 0.8992; val_best_f1_score: 0.9037; train_kl_reg_loss: 60006.8448; train_edge_recon_loss: 581249.9527; train_gene_expr_recon_loss: 18886619.0303; train_masked_gp_l1_reg_loss: 110731.0974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70666.5198; train_chrom_access_recon_loss: 5844472.7500; train_global_loss: 25553746.4848; train_optim_loss: 25553746.4848; val_kl_reg_loss: 59728.6440; val_edge_recon_loss: 584450.4453; val_gene_expr_recon_loss: 18770132.2500; val_masked_gp_l1_reg_loss: 111263.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70930.5156; val_chrom_access_recon_loss: 5873774.9375; val_global_loss: 25470280.7500; val_optim_loss: 25470280.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9491; val_auprc_score: 0.9326; val_best_acc_score: 0.8933; val_best_f1_score: 0.8988; train_kl_reg_loss: 59902.1543; train_edge_recon_loss: 580653.1383; train_gene_expr_recon_loss: 18861481.6364; train_masked_gp_l1_reg_loss: 111558.8084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70708.3944; train_chrom_access_recon_loss: 5829218.0833; train_global_loss: 25513522.1515; train_optim_loss: 25513522.1515; val_kl_reg_loss: 59837.3828; val_edge_recon_loss: 589604.0078; val_gene_expr_recon_loss: 18813714.5000; val_masked_gp_l1_reg_loss: 112082.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70982.3203; val_chrom_access_recon_loss: 5858806.8750; val_global_loss: 25505026.5000; val_optim_loss: 25505026.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9468; val_auprc_score: 0.9302; val_best_acc_score: 0.8923; val_best_f1_score: 0.8967; train_kl_reg_loss: 59770.4276; train_edge_recon_loss: 579663.6960; train_gene_expr_recon_loss: 18838836.8182; train_masked_gp_l1_reg_loss: 112368.4407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70948.3587; train_chrom_access_recon_loss: 5819841.4848; train_global_loss: 25481429.3030; train_optim_loss: 25481429.3030; val_kl_reg_loss: 60517.5781; val_edge_recon_loss: 593737.5078; val_gene_expr_recon_loss: 18928420.7500; val_masked_gp_l1_reg_loss: 112808.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71153.3125; val_chrom_access_recon_loss: 5914696.3125; val_global_loss: 25681333.5000; val_optim_loss: 25681333.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9547; val_auprc_score: 0.9393; val_best_acc_score: 0.8976; val_best_f1_score: 0.9032; train_kl_reg_loss: 60048.8520; train_edge_recon_loss: 580698.2330; train_gene_expr_recon_loss: 18789348.1212; train_masked_gp_l1_reg_loss: 113110.5768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71057.5166; train_chrom_access_recon_loss: 5806777.2576; train_global_loss: 25421040.3636; train_optim_loss: 25421040.3636; val_kl_reg_loss: 60160.4604; val_edge_recon_loss: 585650.2031; val_gene_expr_recon_loss: 18773021.2500; val_masked_gp_l1_reg_loss: 113791.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71598.5156; val_chrom_access_recon_loss: 5833759.4375; val_global_loss: 25437981.2500; val_optim_loss: 25437981.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9553; val_auprc_score: 0.9416; val_best_acc_score: 0.8939; val_best_f1_score: 0.8990; train_kl_reg_loss: 60088.3955; train_edge_recon_loss: 579666.4905; train_gene_expr_recon_loss: 18789927.6364; train_masked_gp_l1_reg_loss: 114016.5251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71348.2781; train_chrom_access_recon_loss: 5802720.6667; train_global_loss: 25417767.7879; train_optim_loss: 25417767.7879; val_kl_reg_loss: 59949.7930; val_edge_recon_loss: 591582.4531; val_gene_expr_recon_loss: 18880469.5000; val_masked_gp_l1_reg_loss: 114434.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71355.4844; val_chrom_access_recon_loss: 5876942.8125; val_global_loss: 25594734.2500; val_optim_loss: 25594734.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9501; val_auprc_score: 0.9337; val_best_acc_score: 0.8958; val_best_f1_score: 0.9003; train_kl_reg_loss: 59991.8165; train_edge_recon_loss: 581244.2642; train_gene_expr_recon_loss: 18729158.0303; train_masked_gp_l1_reg_loss: 114602.0750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71393.4579; train_chrom_access_recon_loss: 5783315.9621; train_global_loss: 25339705.6061; train_optim_loss: 25339705.6061; val_kl_reg_loss: 58861.2788; val_edge_recon_loss: 590844.4375; val_gene_expr_recon_loss: 18803739.2500; val_masked_gp_l1_reg_loss: 115183.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71552.2500; val_chrom_access_recon_loss: 5904619.3750; val_global_loss: 25544800.5000; val_optim_loss: 25544800.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9498; val_auprc_score: 0.9332; val_best_acc_score: 0.8995; val_best_f1_score: 0.9022; train_kl_reg_loss: 60069.9309; train_edge_recon_loss: 580960.8239; train_gene_expr_recon_loss: 18706070.5758; train_masked_gp_l1_reg_loss: 115277.8713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71615.7895; train_chrom_access_recon_loss: 5771761.9545; train_global_loss: 25305756.7879; train_optim_loss: 25305756.7879; val_kl_reg_loss: 59421.3486; val_edge_recon_loss: 586434.1094; val_gene_expr_recon_loss: 19056147.5000; val_masked_gp_l1_reg_loss: 115721.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71506.7266; val_chrom_access_recon_loss: 5963942.6250; val_global_loss: 25853173.7500; val_optim_loss: 25853173.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9518; val_auprc_score: 0.9369; val_best_acc_score: 0.9017; val_best_f1_score: 0.9053; train_kl_reg_loss: 60155.3818; train_edge_recon_loss: 580689.2112; train_gene_expr_recon_loss: 18687672.0606; train_masked_gp_l1_reg_loss: 115930.0932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71817.3606; train_chrom_access_recon_loss: 5761635.9848; train_global_loss: 25277900.3030; train_optim_loss: 25277900.3030; val_kl_reg_loss: 60010.1621; val_edge_recon_loss: 588315.6484; val_gene_expr_recon_loss: 18745058.2500; val_masked_gp_l1_reg_loss: 116279.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71993.5625; val_chrom_access_recon_loss: 5890776.8750; val_global_loss: 25472435.2500; val_optim_loss: 25472435.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9557; val_auprc_score: 0.9406; val_best_acc_score: 0.9006; val_best_f1_score: 0.9051; train_kl_reg_loss: 60157.0191; train_edge_recon_loss: 578145.6383; train_gene_expr_recon_loss: 18634331.8182; train_masked_gp_l1_reg_loss: 112833.9911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58475.0304; train_chrom_access_recon_loss: 5743855.7652; train_global_loss: 25187799.5758; train_optim_loss: 25187799.5758; val_kl_reg_loss: 60195.5244; val_edge_recon_loss: 587061.9766; val_gene_expr_recon_loss: 18561295.2500; val_masked_gp_l1_reg_loss: 111328.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54460.7344; val_chrom_access_recon_loss: 5808414.5000; val_global_loss: 25182755.5000; val_optim_loss: 25182755.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9535; val_auprc_score: 0.9397; val_best_acc_score: 0.8982; val_best_f1_score: 0.9030; train_kl_reg_loss: 60447.6800; train_edge_recon_loss: 579541.9688; train_gene_expr_recon_loss: 18629010.2727; train_masked_gp_l1_reg_loss: 111087.1837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53924.8820; train_chrom_access_recon_loss: 5738917.0227; train_global_loss: 25172928.9394; train_optim_loss: 25172928.9394; val_kl_reg_loss: 60709.4907; val_edge_recon_loss: 586282.5938; val_gene_expr_recon_loss: 18761677.5000; val_masked_gp_l1_reg_loss: 110977.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53560.1406; val_chrom_access_recon_loss: 5892454.6250; val_global_loss: 25465662.5000; val_optim_loss: 25465662.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9553; val_auprc_score: 0.9369; val_best_acc_score: 0.9019; val_best_f1_score: 0.9062; train_kl_reg_loss: 60480.0681; train_edge_recon_loss: 579087.5852; train_gene_expr_recon_loss: 18636274.6364; train_masked_gp_l1_reg_loss: 110926.5934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53320.3488; train_chrom_access_recon_loss: 5743646.7045; train_global_loss: 25183736.0303; train_optim_loss: 25183736.0303; val_kl_reg_loss: 60872.4297; val_edge_recon_loss: 583417.0156; val_gene_expr_recon_loss: 18804002.2500; val_masked_gp_l1_reg_loss: 110914.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53066.9453; val_chrom_access_recon_loss: 5922992.4375; val_global_loss: 25535264.2500; val_optim_loss: 25535264.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9563; val_auprc_score: 0.9453; val_best_acc_score: 0.9033; val_best_f1_score: 0.9075; train_kl_reg_loss: 60611.0437; train_edge_recon_loss: 580200.3277; train_gene_expr_recon_loss: 18638275.1515; train_masked_gp_l1_reg_loss: 110933.2092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52925.6550; train_chrom_access_recon_loss: 5741379.6288; train_global_loss: 25184324.9394; train_optim_loss: 25184324.9394; val_kl_reg_loss: 60774.0659; val_edge_recon_loss: 587547.7188; val_gene_expr_recon_loss: 18839791.7500; val_masked_gp_l1_reg_loss: 110953.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52753.6133; val_chrom_access_recon_loss: 5914639.2500; val_global_loss: 25566461.2500; val_optim_loss: 25566461.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9523; val_auprc_score: 0.9361; val_best_acc_score: 0.8955; val_best_f1_score: 0.9019; train_kl_reg_loss: 60604.0778; train_edge_recon_loss: 580825.8277; train_gene_expr_recon_loss: 18626602.6061; train_masked_gp_l1_reg_loss: 110974.4305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52624.9499; train_chrom_access_recon_loss: 5741316.7803; train_global_loss: 25172948.6364; train_optim_loss: 25172948.6364; val_kl_reg_loss: 61022.5635; val_edge_recon_loss: 588247.0078; val_gene_expr_recon_loss: 18721667.2500; val_masked_gp_l1_reg_loss: 111005.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52480.2422; val_chrom_access_recon_loss: 5900341.7500; val_global_loss: 25434763.2500; val_optim_loss: 25434763.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9545; val_auprc_score: 0.9394; val_best_acc_score: 0.9019; val_best_f1_score: 0.9062; train_kl_reg_loss: 60604.8697; train_edge_recon_loss: 578495.1818; train_gene_expr_recon_loss: 18616588.1818; train_masked_gp_l1_reg_loss: 110666.2911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51155.3472; train_chrom_access_recon_loss: 5737982.2879; train_global_loss: 25155492.0909; train_optim_loss: 25155492.0909; val_kl_reg_loss: 61168.1382; val_edge_recon_loss: 589075.0469; val_gene_expr_recon_loss: 18808835.5000; val_masked_gp_l1_reg_loss: 110501.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50781.2422; val_chrom_access_recon_loss: 5901258.1875; val_global_loss: 25521621.2500; val_optim_loss: 25521621.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9512; val_auprc_score: 0.9344; val_best_acc_score: 0.8966; val_best_f1_score: 0.9017; train_kl_reg_loss: 60621.4470; train_edge_recon_loss: 578797.2178; train_gene_expr_recon_loss: 18603133.1818; train_masked_gp_l1_reg_loss: 110460.2910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50727.0235; train_chrom_access_recon_loss: 5729565.5909; train_global_loss: 25133304.9697; train_optim_loss: 25133304.9697; val_kl_reg_loss: 61304.8066; val_edge_recon_loss: 584759.1328; val_gene_expr_recon_loss: 18775659.0000; val_masked_gp_l1_reg_loss: 110437.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50685.3203; val_chrom_access_recon_loss: 5925354.0625; val_global_loss: 25508200.5000; val_optim_loss: 25508200.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9487; val_auprc_score: 0.9309; val_best_acc_score: 0.8976; val_best_f1_score: 0.9025; train_kl_reg_loss: 60655.4009; train_edge_recon_loss: 579157.1866; train_gene_expr_recon_loss: 18612360.3333; train_masked_gp_l1_reg_loss: 110424.0655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50652.2084; train_chrom_access_recon_loss: 5729199.8030; train_global_loss: 25142448.7879; train_optim_loss: 25142448.7879; val_kl_reg_loss: 61110.0229; val_edge_recon_loss: 587214.8750; val_gene_expr_recon_loss: 18896529.5000; val_masked_gp_l1_reg_loss: 110413.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50622.9961; val_chrom_access_recon_loss: 5884305.1250; val_global_loss: 25590195.7500; val_optim_loss: 25590195.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9525; val_auprc_score: 0.9366; val_best_acc_score: 0.8976; val_best_f1_score: 0.9026; train_kl_reg_loss: 60644.5375; train_edge_recon_loss: 579201.8712; train_gene_expr_recon_loss: 18605866.2727; train_masked_gp_l1_reg_loss: 110407.1126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50596.8630; train_chrom_access_recon_loss: 5732977.0833; train_global_loss: 25139693.7273; train_optim_loss: 25139693.7273; val_kl_reg_loss: 61146.4243; val_edge_recon_loss: 587254.7578; val_gene_expr_recon_loss: 18932560.0000; val_masked_gp_l1_reg_loss: 110407.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50575.4570; val_chrom_access_recon_loss: 5940385.8125; val_global_loss: 25682331.2500; val_optim_loss: 25682331.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 18 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9493
val AUPRC score: 0.9348
val best accuracy score: 0.8896
val best F1 score: 0.8950
val target rna MSE score: 1.1758
val source rna MSE score: 0.6947
val target atac MSE score: 0.3170
val source atac MSE score: 0.1275
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
