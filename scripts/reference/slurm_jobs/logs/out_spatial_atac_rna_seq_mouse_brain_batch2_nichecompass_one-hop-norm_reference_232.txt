[True]
Run timestamp: 07092023_014409_232.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_232']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1123 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5626, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1123
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1123

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6414; val_auprc_score: 0.6334; val_best_acc_score: 0.5011; val_best_f1_score: 0.6670; train_kl_reg_loss: 54848.9588; train_edge_recon_loss: 3564099.1098; train_gene_expr_recon_loss: 16560322.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1452220.4527; train_chrom_access_recon_loss: 6317327.9924; train_global_loss: 27948819.2424; train_optim_loss: 27948819.2424; val_kl_reg_loss: 41458.4341; val_edge_recon_loss: 4065332.9688; val_gene_expr_recon_loss: 15199374.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1089442.2500; val_chrom_access_recon_loss: 6017233.3125; val_global_loss: 26412842.0000; val_optim_loss: 26412842.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6819; val_auprc_score: 0.6561; val_best_acc_score: 0.5443; val_best_f1_score: 0.6837; train_kl_reg_loss: 101635.6178; train_edge_recon_loss: 3540144.1439; train_gene_expr_recon_loss: 14967476.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 785970.3456; train_chrom_access_recon_loss: 6010927.7197; train_global_loss: 25406154.3333; train_optim_loss: 25406154.3333; val_kl_reg_loss: 121794.9092; val_edge_recon_loss: 4062869.8438; val_gene_expr_recon_loss: 14890399.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 533833.6250; val_chrom_access_recon_loss: 5930291.3750; val_global_loss: 25539190.0000; val_optim_loss: 25539190.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7179; val_auprc_score: 0.6999; val_best_acc_score: 0.6306; val_best_f1_score: 0.7039; train_kl_reg_loss: 102808.8567; train_edge_recon_loss: 3520554.7008; train_gene_expr_recon_loss: 14693405.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 393166.6383; train_chrom_access_recon_loss: 5938446.7955; train_global_loss: 24648382.2727; train_optim_loss: 24648382.2727; val_kl_reg_loss: 96583.0869; val_edge_recon_loss: 4050591.0312; val_gene_expr_recon_loss: 14499920.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 285246.2500; val_chrom_access_recon_loss: 5910004.1250; val_global_loss: 24842344.2500; val_optim_loss: 24842344.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7805; val_auprc_score: 0.7593; val_best_acc_score: 0.7020; val_best_f1_score: 0.7286; train_kl_reg_loss: 92238.7591; train_edge_recon_loss: 3511283.4583; train_gene_expr_recon_loss: 14536474.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224305.9482; train_chrom_access_recon_loss: 5896795.2121; train_global_loss: 24261098.1212; train_optim_loss: 24261098.1212; val_kl_reg_loss: 83581.9619; val_edge_recon_loss: 3980751.4375; val_gene_expr_recon_loss: 14442052.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 176142.1562; val_chrom_access_recon_loss: 5802929.6250; val_global_loss: 24485457.2500; val_optim_loss: 24485457.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8311; val_auprc_score: 0.8070; val_best_acc_score: 0.7539; val_best_f1_score: 0.7902; train_kl_reg_loss: 75867.5053; train_edge_recon_loss: 3417088.3106; train_gene_expr_recon_loss: 14458008.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146818.5562; train_chrom_access_recon_loss: 5869278.0682; train_global_loss: 23967061.1515; train_optim_loss: 23967061.1515; val_kl_reg_loss: 70749.9570; val_edge_recon_loss: 3204641.5625; val_gene_expr_recon_loss: 14513373.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122953.3828; val_chrom_access_recon_loss: 5858861.1875; val_global_loss: 23770580.0000; val_optim_loss: 23770580.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8382; val_auprc_score: 0.8021; val_best_acc_score: 0.7520; val_best_f1_score: 0.7928; train_kl_reg_loss: 99973.5661; train_edge_recon_loss: 3033063.4015; train_gene_expr_recon_loss: 14380502.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108386.6791; train_chrom_access_recon_loss: 5841090.7348; train_global_loss: 23463016.3636; train_optim_loss: 23463016.3636; val_kl_reg_loss: 93280.6660; val_edge_recon_loss: 3000306.6250; val_gene_expr_recon_loss: 14362557.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96080.3047; val_chrom_access_recon_loss: 5823021.5000; val_global_loss: 23375246.2500; val_optim_loss: 23375246.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8361; val_auprc_score: 0.7994; val_best_acc_score: 0.7394; val_best_f1_score: 0.7832; train_kl_reg_loss: 107341.9973; train_edge_recon_loss: 2962804.8258; train_gene_expr_recon_loss: 14296054.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86969.8479; train_chrom_access_recon_loss: 5807991.3561; train_global_loss: 23261161.9091; train_optim_loss: 23261161.9091; val_kl_reg_loss: 107096.9355; val_edge_recon_loss: 3010710.7812; val_gene_expr_recon_loss: 14171350.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79066.7109; val_chrom_access_recon_loss: 5707070.8125; val_global_loss: 23075295.5000; val_optim_loss: 23075295.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8632; val_auprc_score: 0.8353; val_best_acc_score: 0.7695; val_best_f1_score: 0.7957; train_kl_reg_loss: 101831.7389; train_edge_recon_loss: 2943670.9621; train_gene_expr_recon_loss: 14217277.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73019.8756; train_chrom_access_recon_loss: 5783372.8561; train_global_loss: 23119173.1818; train_optim_loss: 23119173.1818; val_kl_reg_loss: 97465.9834; val_edge_recon_loss: 2946271.5000; val_gene_expr_recon_loss: 14445363.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67833.8594; val_chrom_access_recon_loss: 5893514.8125; val_global_loss: 23450449.5000; val_optim_loss: 23450449.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8735; val_auprc_score: 0.8503; val_best_acc_score: 0.7837; val_best_f1_score: 0.8030; train_kl_reg_loss: 98091.3648; train_edge_recon_loss: 2931143.8864; train_gene_expr_recon_loss: 14134251.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63549.1457; train_chrom_access_recon_loss: 5749735.4545; train_global_loss: 22976771.7576; train_optim_loss: 22976771.7576; val_kl_reg_loss: 96994.0322; val_edge_recon_loss: 2925684.4062; val_gene_expr_recon_loss: 14097976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60390.7461; val_chrom_access_recon_loss: 5706409.0000; val_global_loss: 22887453.2500; val_optim_loss: 22887453.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8653; val_auprc_score: 0.8309; val_best_acc_score: 0.7923; val_best_f1_score: 0.8081; train_kl_reg_loss: 94495.4400; train_edge_recon_loss: 2903321.4735; train_gene_expr_recon_loss: 14078286.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57385.5967; train_chrom_access_recon_loss: 5722794.1742; train_global_loss: 22856282.7273; train_optim_loss: 22856282.7273; val_kl_reg_loss: 94165.6094; val_edge_recon_loss: 2909719.2188; val_gene_expr_recon_loss: 14165111.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54829.3438; val_chrom_access_recon_loss: 5792663.0625; val_global_loss: 23016489.5000; val_optim_loss: 23016489.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8704; val_auprc_score: 0.8346; val_best_acc_score: 0.7966; val_best_f1_score: 0.8203; train_kl_reg_loss: 90427.4474; train_edge_recon_loss: 2879265.0985; train_gene_expr_recon_loss: 14016797.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53222.9715; train_chrom_access_recon_loss: 5701842.2197; train_global_loss: 22741555.7879; train_optim_loss: 22741555.7879; val_kl_reg_loss: 94779.6436; val_edge_recon_loss: 2903579.7812; val_gene_expr_recon_loss: 14158735.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51615.6484; val_chrom_access_recon_loss: 5706219.1250; val_global_loss: 22914930.0000; val_optim_loss: 22914930.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8891; val_auprc_score: 0.8528; val_best_acc_score: 0.8216; val_best_f1_score: 0.8444; train_kl_reg_loss: 90476.8401; train_edge_recon_loss: 2835094.6705; train_gene_expr_recon_loss: 13969449.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50262.1665; train_chrom_access_recon_loss: 5681384.9470; train_global_loss: 22626667.5455; train_optim_loss: 22626667.5455; val_kl_reg_loss: 88426.5039; val_edge_recon_loss: 2826462.2188; val_gene_expr_recon_loss: 13987986.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49002.2969; val_chrom_access_recon_loss: 5623784.2500; val_global_loss: 22575661.7500; val_optim_loss: 22575661.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8990; val_auprc_score: 0.8683; val_best_acc_score: 0.8356; val_best_f1_score: 0.8534; train_kl_reg_loss: 90653.2106; train_edge_recon_loss: 2822576.1477; train_gene_expr_recon_loss: 13925344.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47996.4908; train_chrom_access_recon_loss: 5666981.1136; train_global_loss: 22553551.0909; train_optim_loss: 22553551.0909; val_kl_reg_loss: 87397.5957; val_edge_recon_loss: 2813300.4062; val_gene_expr_recon_loss: 14062731.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47269.7734; val_chrom_access_recon_loss: 5650971.5000; val_global_loss: 22661671.5000; val_optim_loss: 22661671.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8959; val_auprc_score: 0.8514; val_best_acc_score: 0.8337; val_best_f1_score: 0.8485; train_kl_reg_loss: 88529.4756; train_edge_recon_loss: 2816115.9848; train_gene_expr_recon_loss: 13879877.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46373.3217; train_chrom_access_recon_loss: 5644972.0303; train_global_loss: 22475868.5152; train_optim_loss: 22475868.5152; val_kl_reg_loss: 86766.3467; val_edge_recon_loss: 2814825.8750; val_gene_expr_recon_loss: 13903830.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45702.7422; val_chrom_access_recon_loss: 5616468.3750; val_global_loss: 22467593.7500; val_optim_loss: 22467593.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9016; val_auprc_score: 0.8705; val_best_acc_score: 0.8366; val_best_f1_score: 0.8520; train_kl_reg_loss: 86794.9495; train_edge_recon_loss: 2787089.7462; train_gene_expr_recon_loss: 13824520.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45070.6141; train_chrom_access_recon_loss: 5623934.1515; train_global_loss: 22367410.4545; train_optim_loss: 22367410.4545; val_kl_reg_loss: 84550.4111; val_edge_recon_loss: 2810308.1562; val_gene_expr_recon_loss: 13878034.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44562.0117; val_chrom_access_recon_loss: 5613859.3750; val_global_loss: 22431313.7500; val_optim_loss: 22431313.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9036; val_auprc_score: 0.8707; val_best_acc_score: 0.8375; val_best_f1_score: 0.8480; train_kl_reg_loss: 85875.4679; train_edge_recon_loss: 2794328.1439; train_gene_expr_recon_loss: 13790436.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43974.2099; train_chrom_access_recon_loss: 5610552.3939; train_global_loss: 22325166.7576; train_optim_loss: 22325166.7576; val_kl_reg_loss: 82192.6328; val_edge_recon_loss: 2820306.3438; val_gene_expr_recon_loss: 13775348.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43725.6484; val_chrom_access_recon_loss: 5571330.3750; val_global_loss: 22292904.2500; val_optim_loss: 22292904.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9090; val_auprc_score: 0.8769; val_best_acc_score: 0.8409; val_best_f1_score: 0.8528; train_kl_reg_loss: 84806.0272; train_edge_recon_loss: 2777184.6174; train_gene_expr_recon_loss: 13759322.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43132.0585; train_chrom_access_recon_loss: 5592667.0606; train_global_loss: 22257112.0000; train_optim_loss: 22257112.0000; val_kl_reg_loss: 82001.3740; val_edge_recon_loss: 2824127.5625; val_gene_expr_recon_loss: 13896912.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42816.9297; val_chrom_access_recon_loss: 5579500.1875; val_global_loss: 22425357.7500; val_optim_loss: 22425357.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9142; val_auprc_score: 0.8899; val_best_acc_score: 0.8514; val_best_f1_score: 0.8581; train_kl_reg_loss: 82891.7811; train_edge_recon_loss: 2776502.5644; train_gene_expr_recon_loss: 13723182.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42420.6897; train_chrom_access_recon_loss: 5584568.0985; train_global_loss: 22209565.6061; train_optim_loss: 22209565.6061; val_kl_reg_loss: 81576.7090; val_edge_recon_loss: 2820009.5625; val_gene_expr_recon_loss: 13882590.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42037.4727; val_chrom_access_recon_loss: 5619436.0625; val_global_loss: 22445649.7500; val_optim_loss: 22445649.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9061; val_auprc_score: 0.8739; val_best_acc_score: 0.8474; val_best_f1_score: 0.8570; train_kl_reg_loss: 81478.8346; train_edge_recon_loss: 2757524.5417; train_gene_expr_recon_loss: 13678756.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41823.5387; train_chrom_access_recon_loss: 5563599.8864; train_global_loss: 22123183.7879; train_optim_loss: 22123183.7879; val_kl_reg_loss: 81654.8115; val_edge_recon_loss: 2814476.1250; val_gene_expr_recon_loss: 13651859.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41508.5000; val_chrom_access_recon_loss: 5565331.8750; val_global_loss: 22154830.7500; val_optim_loss: 22154830.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9279; val_auprc_score: 0.9011; val_best_acc_score: 0.8700; val_best_f1_score: 0.8774; train_kl_reg_loss: 79434.1855; train_edge_recon_loss: 2765534.0455; train_gene_expr_recon_loss: 13641077.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41183.7314; train_chrom_access_recon_loss: 5545546.9773; train_global_loss: 22072776.3030; train_optim_loss: 22072776.3030; val_kl_reg_loss: 80286.5000; val_edge_recon_loss: 2773452.2812; val_gene_expr_recon_loss: 13818288.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41126.4492; val_chrom_access_recon_loss: 5607312.2500; val_global_loss: 22320465.2500; val_optim_loss: 22320465.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9124; val_auprc_score: 0.8825; val_best_acc_score: 0.8536; val_best_f1_score: 0.8676; train_kl_reg_loss: 80673.0878; train_edge_recon_loss: 2753537.6439; train_gene_expr_recon_loss: 13625310.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40871.0135; train_chrom_access_recon_loss: 5538386.5303; train_global_loss: 22038778.6364; train_optim_loss: 22038778.6364; val_kl_reg_loss: 81387.0898; val_edge_recon_loss: 2823986.6562; val_gene_expr_recon_loss: 13831761.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40911.2500; val_chrom_access_recon_loss: 5576205.7500; val_global_loss: 22354252.0000; val_optim_loss: 22354252.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9199; val_auprc_score: 0.8892; val_best_acc_score: 0.8635; val_best_f1_score: 0.8748; train_kl_reg_loss: 79808.1036; train_edge_recon_loss: 2737937.3409; train_gene_expr_recon_loss: 13584662.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40523.1503; train_chrom_access_recon_loss: 5521417.8939; train_global_loss: 21964349.3636; train_optim_loss: 21964349.3636; val_kl_reg_loss: 77675.4180; val_edge_recon_loss: 2794525.1562; val_gene_expr_recon_loss: 13639860.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40346.5273; val_chrom_access_recon_loss: 5541691.2500; val_global_loss: 22094098.5000; val_optim_loss: 22094098.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9287; val_auprc_score: 0.8972; val_best_acc_score: 0.8670; val_best_f1_score: 0.8764; train_kl_reg_loss: 78418.0365; train_edge_recon_loss: 2738807.3447; train_gene_expr_recon_loss: 13565521.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40087.6947; train_chrom_access_recon_loss: 5512557.8485; train_global_loss: 21935392.3636; train_optim_loss: 21935392.3636; val_kl_reg_loss: 78633.1621; val_edge_recon_loss: 2756484.4688; val_gene_expr_recon_loss: 13626968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40237.5078; val_chrom_access_recon_loss: 5527869.0625; val_global_loss: 22030192.7500; val_optim_loss: 22030192.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9321; val_auprc_score: 0.9050; val_best_acc_score: 0.8681; val_best_f1_score: 0.8764; train_kl_reg_loss: 78017.6431; train_edge_recon_loss: 2731542.3826; train_gene_expr_recon_loss: 13530452.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39929.8893; train_chrom_access_recon_loss: 5498740.0530; train_global_loss: 21878683.0000; train_optim_loss: 21878683.0000; val_kl_reg_loss: 75529.4238; val_edge_recon_loss: 2757788.9062; val_gene_expr_recon_loss: 13470031.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39896.9258; val_chrom_access_recon_loss: 5484919.1875; val_global_loss: 21828165.2500; val_optim_loss: 21828165.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9288; val_auprc_score: 0.8942; val_best_acc_score: 0.8729; val_best_f1_score: 0.8815; train_kl_reg_loss: 75682.6654; train_edge_recon_loss: 2718875.8182; train_gene_expr_recon_loss: 13504144.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39676.4278; train_chrom_access_recon_loss: 5483585.0227; train_global_loss: 21821964.9394; train_optim_loss: 21821964.9394; val_kl_reg_loss: 76434.6133; val_edge_recon_loss: 2754443.7812; val_gene_expr_recon_loss: 13475775.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39588.6953; val_chrom_access_recon_loss: 5454128.3750; val_global_loss: 21800371.0000; val_optim_loss: 21800371.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9302; val_auprc_score: 0.9019; val_best_acc_score: 0.8694; val_best_f1_score: 0.8776; train_kl_reg_loss: 74343.8845; train_edge_recon_loss: 2723069.7500; train_gene_expr_recon_loss: 13471881.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39308.2324; train_chrom_access_recon_loss: 5476567.7879; train_global_loss: 21785171.0909; train_optim_loss: 21785171.0909; val_kl_reg_loss: 74819.1045; val_edge_recon_loss: 2757689.2812; val_gene_expr_recon_loss: 13469809.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39226.9062; val_chrom_access_recon_loss: 5493839.3750; val_global_loss: 21835384.7500; val_optim_loss: 21835384.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9297; val_auprc_score: 0.9021; val_best_acc_score: 0.8751; val_best_f1_score: 0.8832; train_kl_reg_loss: 75520.9416; train_edge_recon_loss: 2716600.7803; train_gene_expr_recon_loss: 13454231.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39075.2182; train_chrom_access_recon_loss: 5462898.7500; train_global_loss: 21748326.6970; train_optim_loss: 21748326.6970; val_kl_reg_loss: 76644.0879; val_edge_recon_loss: 2717207.9375; val_gene_expr_recon_loss: 13512585.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39113.4609; val_chrom_access_recon_loss: 5503428.0000; val_global_loss: 21848978.5000; val_optim_loss: 21848978.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9281; val_auprc_score: 0.8984; val_best_acc_score: 0.8732; val_best_f1_score: 0.8803; train_kl_reg_loss: 73427.1600; train_edge_recon_loss: 2714315.4053; train_gene_expr_recon_loss: 13414110.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39014.0510; train_chrom_access_recon_loss: 5451766.2576; train_global_loss: 21692633.4545; train_optim_loss: 21692633.4545; val_kl_reg_loss: 70038.5518; val_edge_recon_loss: 2758289.5000; val_gene_expr_recon_loss: 13485247.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38896.0195; val_chrom_access_recon_loss: 5447501.0000; val_global_loss: 21799972.2500; val_optim_loss: 21799972.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9380; val_auprc_score: 0.9194; val_best_acc_score: 0.8812; val_best_f1_score: 0.8870; train_kl_reg_loss: 72859.9441; train_edge_recon_loss: 2717409.3485; train_gene_expr_recon_loss: 13407942.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38792.1030; train_chrom_access_recon_loss: 5443879.6970; train_global_loss: 21680883.6364; train_optim_loss: 21680883.6364; val_kl_reg_loss: 71940.8975; val_edge_recon_loss: 2756059.9375; val_gene_expr_recon_loss: 13586588.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38742.4180; val_chrom_access_recon_loss: 5489286.0000; val_global_loss: 21942617.5000; val_optim_loss: 21942617.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9397; val_auprc_score: 0.9145; val_best_acc_score: 0.8837; val_best_f1_score: 0.8895; train_kl_reg_loss: 71636.6175; train_edge_recon_loss: 2711946.7879; train_gene_expr_recon_loss: 13384140.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38632.6978; train_chrom_access_recon_loss: 5434830.0985; train_global_loss: 21641186.4545; train_optim_loss: 21641186.4545; val_kl_reg_loss: 70867.6182; val_edge_recon_loss: 2740706.8750; val_gene_expr_recon_loss: 13438519.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38642.0977; val_chrom_access_recon_loss: 5494126.4375; val_global_loss: 21782862.2500; val_optim_loss: 21782862.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9438; val_auprc_score: 0.9206; val_best_acc_score: 0.8847; val_best_f1_score: 0.8914; train_kl_reg_loss: 71339.8155; train_edge_recon_loss: 2707622.5038; train_gene_expr_recon_loss: 13366375.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38573.8669; train_chrom_access_recon_loss: 5420980.3561; train_global_loss: 21604892.0303; train_optim_loss: 21604892.0303; val_kl_reg_loss: 70048.7744; val_edge_recon_loss: 2736027.7812; val_gene_expr_recon_loss: 13471310.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38438.4961; val_chrom_access_recon_loss: 5389204.1875; val_global_loss: 21705029.2500; val_optim_loss: 21705029.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9393; val_auprc_score: 0.9159; val_best_acc_score: 0.8788; val_best_f1_score: 0.8844; train_kl_reg_loss: 70126.4134; train_edge_recon_loss: 2705138.1326; train_gene_expr_recon_loss: 13349779.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38423.9593; train_chrom_access_recon_loss: 5416262.6364; train_global_loss: 21579730.7576; train_optim_loss: 21579730.7576; val_kl_reg_loss: 71577.6191; val_edge_recon_loss: 2750031.8750; val_gene_expr_recon_loss: 13475879.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38389.8281; val_chrom_access_recon_loss: 5453853.5625; val_global_loss: 21789732.7500; val_optim_loss: 21789732.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9433; val_auprc_score: 0.9241; val_best_acc_score: 0.8845; val_best_f1_score: 0.8912; train_kl_reg_loss: 69361.1644; train_edge_recon_loss: 2697082.1705; train_gene_expr_recon_loss: 13333812.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38296.6414; train_chrom_access_recon_loss: 5409485.8636; train_global_loss: 21548038.7576; train_optim_loss: 21548038.7576; val_kl_reg_loss: 70072.0635; val_edge_recon_loss: 2736658.8438; val_gene_expr_recon_loss: 13294715.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38362.7539; val_chrom_access_recon_loss: 5387902.1875; val_global_loss: 21527711.7500; val_optim_loss: 21527711.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9508; val_auprc_score: 0.9312; val_best_acc_score: 0.8949; val_best_f1_score: 0.8993; train_kl_reg_loss: 68048.1800; train_edge_recon_loss: 2701421.7992; train_gene_expr_recon_loss: 13304616.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38244.8240; train_chrom_access_recon_loss: 5397074.1818; train_global_loss: 21509405.0606; train_optim_loss: 21509405.0606; val_kl_reg_loss: 67139.4102; val_edge_recon_loss: 2713477.5312; val_gene_expr_recon_loss: 13372965.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38199.4922; val_chrom_access_recon_loss: 5409077.6250; val_global_loss: 21600859.5000; val_optim_loss: 21600859.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9539; val_auprc_score: 0.9389; val_best_acc_score: 0.8968; val_best_f1_score: 0.9020; train_kl_reg_loss: 68699.1078; train_edge_recon_loss: 2693627.3182; train_gene_expr_recon_loss: 13289464.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38142.2048; train_chrom_access_recon_loss: 5390316.7121; train_global_loss: 21480249.3333; train_optim_loss: 21480249.3333; val_kl_reg_loss: 68467.5449; val_edge_recon_loss: 2688111.9688; val_gene_expr_recon_loss: 13350271.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38051.4414; val_chrom_access_recon_loss: 5370130.5000; val_global_loss: 21515032.7500; val_optim_loss: 21515032.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9505; val_auprc_score: 0.9309; val_best_acc_score: 0.8984; val_best_f1_score: 0.9018; train_kl_reg_loss: 68651.7655; train_edge_recon_loss: 2681682.7386; train_gene_expr_recon_loss: 13264518.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38008.7771; train_chrom_access_recon_loss: 5384003.7273; train_global_loss: 21436865.1818; train_optim_loss: 21436865.1818; val_kl_reg_loss: 66873.1973; val_edge_recon_loss: 2697894.4688; val_gene_expr_recon_loss: 13293165.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37940.8008; val_chrom_access_recon_loss: 5367447.3750; val_global_loss: 21463322.0000; val_optim_loss: 21463322.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9457; val_auprc_score: 0.9245; val_best_acc_score: 0.8931; val_best_f1_score: 0.8983; train_kl_reg_loss: 67355.2979; train_edge_recon_loss: 2689339.1061; train_gene_expr_recon_loss: 13259806.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37891.9783; train_chrom_access_recon_loss: 5376172.8939; train_global_loss: 21430566.1212; train_optim_loss: 21430566.1212; val_kl_reg_loss: 66026.0845; val_edge_recon_loss: 2714205.5312; val_gene_expr_recon_loss: 13229283.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37880.1055; val_chrom_access_recon_loss: 5339001.2500; val_global_loss: 21386396.2500; val_optim_loss: 21386396.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9494; val_auprc_score: 0.9288; val_best_acc_score: 0.8966; val_best_f1_score: 0.9003; train_kl_reg_loss: 67826.2853; train_edge_recon_loss: 2687079.2765; train_gene_expr_recon_loss: 13238634.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37840.3005; train_chrom_access_recon_loss: 5365774.8030; train_global_loss: 21397154.8485; train_optim_loss: 21397154.8485; val_kl_reg_loss: 66866.3926; val_edge_recon_loss: 2711483.3125; val_gene_expr_recon_loss: 13305560.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38050.4375; val_chrom_access_recon_loss: 5393122.0625; val_global_loss: 21515081.7500; val_optim_loss: 21515081.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9508; val_auprc_score: 0.9310; val_best_acc_score: 0.8952; val_best_f1_score: 0.8987; train_kl_reg_loss: 66021.2090; train_edge_recon_loss: 2688326.9318; train_gene_expr_recon_loss: 13233849.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37880.5315; train_chrom_access_recon_loss: 5365225.4848; train_global_loss: 21391303.9697; train_optim_loss: 21391303.9697; val_kl_reg_loss: 65847.4248; val_edge_recon_loss: 2727793.3125; val_gene_expr_recon_loss: 13244424.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37980.1406; val_chrom_access_recon_loss: 5358881.5000; val_global_loss: 21434926.2500; val_optim_loss: 21434926.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9522; val_auprc_score: 0.9296; val_best_acc_score: 0.8976; val_best_f1_score: 0.9028; train_kl_reg_loss: 65280.7494; train_edge_recon_loss: 2683998.5833; train_gene_expr_recon_loss: 13212160.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37938.8159; train_chrom_access_recon_loss: 5355710.6364; train_global_loss: 21355089.0606; train_optim_loss: 21355089.0606; val_kl_reg_loss: 66563.7998; val_edge_recon_loss: 2705550.1562; val_gene_expr_recon_loss: 13307605.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37915.0312; val_chrom_access_recon_loss: 5371520.0625; val_global_loss: 21489155.0000; val_optim_loss: 21489155.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9490; val_auprc_score: 0.9263; val_best_acc_score: 0.8933; val_best_f1_score: 0.8969; train_kl_reg_loss: 65788.3957; train_edge_recon_loss: 2683608.1932; train_gene_expr_recon_loss: 13199909.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37849.0362; train_chrom_access_recon_loss: 5345161.5682; train_global_loss: 21332316.6970; train_optim_loss: 21332316.6970; val_kl_reg_loss: 65654.9507; val_edge_recon_loss: 2698640.2188; val_gene_expr_recon_loss: 13386052.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37830.1406; val_chrom_access_recon_loss: 5410902.5000; val_global_loss: 21599079.7500; val_optim_loss: 21599079.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9545; val_auprc_score: 0.9376; val_best_acc_score: 0.8939; val_best_f1_score: 0.8996; train_kl_reg_loss: 65645.0524; train_edge_recon_loss: 2669248.1970; train_gene_expr_recon_loss: 13190500.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32601.9310; train_chrom_access_recon_loss: 5342951.2424; train_global_loss: 21300946.7273; train_optim_loss: 21300946.7273; val_kl_reg_loss: 66487.9507; val_edge_recon_loss: 2709346.6875; val_gene_expr_recon_loss: 13398072.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30980.4590; val_chrom_access_recon_loss: 5389930.1875; val_global_loss: 21594817.5000; val_optim_loss: 21594817.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9529; val_auprc_score: 0.9322; val_best_acc_score: 0.8982; val_best_f1_score: 0.9026; train_kl_reg_loss: 66309.6831; train_edge_recon_loss: 2681379.4432; train_gene_expr_recon_loss: 13171067.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30750.2174; train_chrom_access_recon_loss: 5336514.1970; train_global_loss: 21286020.7576; train_optim_loss: 21286020.7576; val_kl_reg_loss: 66866.1670; val_edge_recon_loss: 2701768.0000; val_gene_expr_recon_loss: 13281492.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30577.3613; val_chrom_access_recon_loss: 5308831.3125; val_global_loss: 21389535.5000; val_optim_loss: 21389535.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9459; val_auprc_score: 0.9182; val_best_acc_score: 0.8949; val_best_f1_score: 0.9004; train_kl_reg_loss: 66740.3655; train_edge_recon_loss: 2678521.9583; train_gene_expr_recon_loss: 13178910.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30481.0009; train_chrom_access_recon_loss: 5336186.4621; train_global_loss: 21290839.9394; train_optim_loss: 21290839.9394; val_kl_reg_loss: 66425.1953; val_edge_recon_loss: 2717283.2500; val_gene_expr_recon_loss: 13286724.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30403.7227; val_chrom_access_recon_loss: 5341288.8750; val_global_loss: 21442126.5000; val_optim_loss: 21442126.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9497; val_auprc_score: 0.9292; val_best_acc_score: 0.8987; val_best_f1_score: 0.9020; train_kl_reg_loss: 66284.1958; train_edge_recon_loss: 2681034.2841; train_gene_expr_recon_loss: 13175289.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30358.5851; train_chrom_access_recon_loss: 5331737.8864; train_global_loss: 21284704.4242; train_optim_loss: 21284704.4242; val_kl_reg_loss: 66707.8838; val_edge_recon_loss: 2711337.9062; val_gene_expr_recon_loss: 13184523.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30295.4219; val_chrom_access_recon_loss: 5331837.2500; val_global_loss: 21324702.0000; val_optim_loss: 21324702.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9524; val_auprc_score: 0.9361; val_best_acc_score: 0.8915; val_best_f1_score: 0.8963; train_kl_reg_loss: 66778.1076; train_edge_recon_loss: 2678113.5644; train_gene_expr_recon_loss: 13167041.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30260.8508; train_chrom_access_recon_loss: 5331644.7348; train_global_loss: 21273838.1818; train_optim_loss: 21273838.1818; val_kl_reg_loss: 66966.2939; val_edge_recon_loss: 2741279.4688; val_gene_expr_recon_loss: 13288148.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30232.5938; val_chrom_access_recon_loss: 5425120.5625; val_global_loss: 21551747.2500; val_optim_loss: 21551747.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9553; val_auprc_score: 0.9413; val_best_acc_score: 0.8979; val_best_f1_score: 0.9015; train_kl_reg_loss: 66697.4080; train_edge_recon_loss: 2683315.0265; train_gene_expr_recon_loss: 13171944.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30187.1017; train_chrom_access_recon_loss: 5333342.5606; train_global_loss: 21285486.9697; train_optim_loss: 21285486.9697; val_kl_reg_loss: 66841.0381; val_edge_recon_loss: 2711300.4375; val_gene_expr_recon_loss: 13291215.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30168.1602; val_chrom_access_recon_loss: 5351500.7500; val_global_loss: 21451025.5000; val_optim_loss: 21451025.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9483; val_auprc_score: 0.9260; val_best_acc_score: 0.8971; val_best_f1_score: 0.9011; train_kl_reg_loss: 66497.0320; train_edge_recon_loss: 2680821.9205; train_gene_expr_recon_loss: 13175546.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30154.4304; train_chrom_access_recon_loss: 5333927.7197; train_global_loss: 21286947.5455; train_optim_loss: 21286947.5455; val_kl_reg_loss: 66323.1123; val_edge_recon_loss: 2711536.1250; val_gene_expr_recon_loss: 13332587.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30127.1113; val_chrom_access_recon_loss: 5371987.0000; val_global_loss: 21512561.2500; val_optim_loss: 21512561.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9504; val_auprc_score: 0.9297; val_best_acc_score: 0.8966; val_best_f1_score: 0.8991; train_kl_reg_loss: 66165.4373; train_edge_recon_loss: 2669203.3939; train_gene_expr_recon_loss: 13163654.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30104.0007; train_chrom_access_recon_loss: 5330808.1288; train_global_loss: 21259935.4545; train_optim_loss: 21259935.4545; val_kl_reg_loss: 67002.0439; val_edge_recon_loss: 2708289.0938; val_gene_expr_recon_loss: 13215584.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30071.2832; val_chrom_access_recon_loss: 5288937.5000; val_global_loss: 21309884.0000; val_optim_loss: 21309884.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9528; val_auprc_score: 0.9368; val_best_acc_score: 0.8974; val_best_f1_score: 0.9016; train_kl_reg_loss: 66622.1431; train_edge_recon_loss: 2680517.3258; train_gene_expr_recon_loss: 13162508.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30054.7511; train_chrom_access_recon_loss: 5328002.6212; train_global_loss: 21267705.2727; train_optim_loss: 21267705.2727; val_kl_reg_loss: 67008.2607; val_edge_recon_loss: 2714316.7500; val_gene_expr_recon_loss: 13260319.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30033.1055; val_chrom_access_recon_loss: 5411815.1250; val_global_loss: 21483493.2500; val_optim_loss: 21483493.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9529; val_auprc_score: 0.9372; val_best_acc_score: 0.8998; val_best_f1_score: 0.9042; train_kl_reg_loss: 66677.1902; train_edge_recon_loss: 2670908.7424; train_gene_expr_recon_loss: 13163231.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30017.0443; train_chrom_access_recon_loss: 5329569.7576; train_global_loss: 21260404.5758; train_optim_loss: 21260404.5758; val_kl_reg_loss: 66761.2100; val_edge_recon_loss: 2700831.7188; val_gene_expr_recon_loss: 13180791.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29990.2109; val_chrom_access_recon_loss: 5331439.3750; val_global_loss: 21309813.7500; val_optim_loss: 21309813.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9495; val_auprc_score: 0.9288; val_best_acc_score: 0.8974; val_best_f1_score: 0.9013; train_kl_reg_loss: 66864.3308; train_edge_recon_loss: 2672361.3409; train_gene_expr_recon_loss: 13164788.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29974.9012; train_chrom_access_recon_loss: 5336184.7121; train_global_loss: 21270173.3333; train_optim_loss: 21270173.3333; val_kl_reg_loss: 67286.7217; val_edge_recon_loss: 2717045.0938; val_gene_expr_recon_loss: 13341598.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29962.8965; val_chrom_access_recon_loss: 5414155.7500; val_global_loss: 21570049.2500; val_optim_loss: 21570049.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9588; val_auprc_score: 0.9388; val_best_acc_score: 0.9060; val_best_f1_score: 0.9093; train_kl_reg_loss: 66948.3691; train_edge_recon_loss: 2689375.0265; train_gene_expr_recon_loss: 13158657.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29947.8485; train_chrom_access_recon_loss: 5323706.1212; train_global_loss: 21268634.4545; train_optim_loss: 21268634.4545; val_kl_reg_loss: 66937.7803; val_edge_recon_loss: 2685316.0312; val_gene_expr_recon_loss: 13244761.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29901.6992; val_chrom_access_recon_loss: 5352911.0625; val_global_loss: 21379828.0000; val_optim_loss: 21379828.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9530; val_auprc_score: 0.9367; val_best_acc_score: 0.8974; val_best_f1_score: 0.9030; train_kl_reg_loss: 66835.2404; train_edge_recon_loss: 2665158.8144; train_gene_expr_recon_loss: 13172097.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29903.4804; train_chrom_access_recon_loss: 5330187.8030; train_global_loss: 21264182.5152; train_optim_loss: 21264182.5152; val_kl_reg_loss: 66994.8828; val_edge_recon_loss: 2719935.3750; val_gene_expr_recon_loss: 13193923.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29887.5215; val_chrom_access_recon_loss: 5328167.8750; val_global_loss: 21338909.7500; val_optim_loss: 21338909.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9516; val_auprc_score: 0.9322; val_best_acc_score: 0.8971; val_best_f1_score: 0.9019; train_kl_reg_loss: 66256.7172; train_edge_recon_loss: 2674309.8712; train_gene_expr_recon_loss: 13145856.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29870.4364; train_chrom_access_recon_loss: 5323599.0682; train_global_loss: 21239892.6667; train_optim_loss: 21239892.6667; val_kl_reg_loss: 66631.2544; val_edge_recon_loss: 2708546.0312; val_gene_expr_recon_loss: 13128405.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29850.9863; val_chrom_access_recon_loss: 5318243.1250; val_global_loss: 21251677.2500; val_optim_loss: 21251677.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9524; val_auprc_score: 0.9337; val_best_acc_score: 0.9006; val_best_f1_score: 0.9037; train_kl_reg_loss: 66459.1864; train_edge_recon_loss: 2670561.5227; train_gene_expr_recon_loss: 13162216.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29834.7237; train_chrom_access_recon_loss: 5330207.2045; train_global_loss: 21259279.1818; train_optim_loss: 21259279.1818; val_kl_reg_loss: 66528.4932; val_edge_recon_loss: 2703681.2812; val_gene_expr_recon_loss: 13144992.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29826.1484; val_chrom_access_recon_loss: 5361640.7500; val_global_loss: 21306669.2500; val_optim_loss: 21306669.2500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9475; val_auprc_score: 0.9216; val_best_acc_score: 0.8896; val_best_f1_score: 0.8963; train_kl_reg_loss: 66853.2482; train_edge_recon_loss: 2666739.7538; train_gene_expr_recon_loss: 13159400.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29819.3090; train_chrom_access_recon_loss: 5327566.5833; train_global_loss: 21250379.6970; train_optim_loss: 21250379.6970; val_kl_reg_loss: 67228.8311; val_edge_recon_loss: 2729536.7188; val_gene_expr_recon_loss: 13132716.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29776.5938; val_chrom_access_recon_loss: 5335507.7500; val_global_loss: 21294766.5000; val_optim_loss: 21294766.5000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9534; val_auprc_score: 0.9342; val_best_acc_score: 0.8966; val_best_f1_score: 0.9018; train_kl_reg_loss: 66309.1410; train_edge_recon_loss: 2683757.2538; train_gene_expr_recon_loss: 13157925.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29760.1637; train_chrom_access_recon_loss: 5324410.8864; train_global_loss: 21262163.1818; train_optim_loss: 21262163.1818; val_kl_reg_loss: 66577.3740; val_edge_recon_loss: 2707488.0000; val_gene_expr_recon_loss: 13305978.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29770.7031; val_chrom_access_recon_loss: 5448033.2500; val_global_loss: 21557847.7500; val_optim_loss: 21557847.7500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9579; val_auprc_score: 0.9432; val_best_acc_score: 0.9025; val_best_f1_score: 0.9062; train_kl_reg_loss: 65983.3400; train_edge_recon_loss: 2678249.5909; train_gene_expr_recon_loss: 13137583.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29757.2823; train_chrom_access_recon_loss: 5320627.3561; train_global_loss: 21232201.0606; train_optim_loss: 21232201.0606; val_kl_reg_loss: 66367.6963; val_edge_recon_loss: 2697266.4688; val_gene_expr_recon_loss: 13178381.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29705.0234; val_chrom_access_recon_loss: 5307588.1875; val_global_loss: 21279309.5000; val_optim_loss: 21279309.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9533; val_auprc_score: 0.9343; val_best_acc_score: 0.8984; val_best_f1_score: 0.9045; train_kl_reg_loss: 65640.9715; train_edge_recon_loss: 2672934.1591; train_gene_expr_recon_loss: 13143143.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29169.8695; train_chrom_access_recon_loss: 5322763.8485; train_global_loss: 21233652.0606; train_optim_loss: 21233652.0606; val_kl_reg_loss: 66041.1831; val_edge_recon_loss: 2708616.6250; val_gene_expr_recon_loss: 13161949.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29014.7461; val_chrom_access_recon_loss: 5389616.5625; val_global_loss: 21355239.5000; val_optim_loss: 21355239.5000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9513; val_auprc_score: 0.9331; val_best_acc_score: 0.8987; val_best_f1_score: 0.9032; train_kl_reg_loss: 65705.1043; train_edge_recon_loss: 2671897.8826; train_gene_expr_recon_loss: 13157904.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28988.8710; train_chrom_access_recon_loss: 5323047.0833; train_global_loss: 21247543.2121; train_optim_loss: 21247543.2121; val_kl_reg_loss: 66286.9863; val_edge_recon_loss: 2723856.7812; val_gene_expr_recon_loss: 13284002.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28970.9531; val_chrom_access_recon_loss: 5369189.9375; val_global_loss: 21472307.5000; val_optim_loss: 21472307.5000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9524; val_auprc_score: 0.9326; val_best_acc_score: 0.8982; val_best_f1_score: 0.9043; train_kl_reg_loss: 65738.2518; train_edge_recon_loss: 2674703.9318; train_gene_expr_recon_loss: 13152457.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28959.0701; train_chrom_access_recon_loss: 5325430.1439; train_global_loss: 21247289.1818; train_optim_loss: 21247289.1818; val_kl_reg_loss: 65667.2412; val_edge_recon_loss: 2693680.2188; val_gene_expr_recon_loss: 13224803.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28949.3828; val_chrom_access_recon_loss: 5333890.7500; val_global_loss: 21346990.7500; val_optim_loss: 21346990.7500
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9577; val_auprc_score: 0.9433; val_best_acc_score: 0.9001; val_best_f1_score: 0.9059; train_kl_reg_loss: 65722.9369; train_edge_recon_loss: 2675229.2424; train_gene_expr_recon_loss: 13139862.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28941.4123; train_chrom_access_recon_loss: 5319946.6667; train_global_loss: 21229702.7273; train_optim_loss: 21229702.7273; val_kl_reg_loss: 66193.2910; val_edge_recon_loss: 2700300.9062; val_gene_expr_recon_loss: 13250927.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28933.1602; val_chrom_access_recon_loss: 5383158.8750; val_global_loss: 21429513.0000; val_optim_loss: 21429513.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 10 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9557
val AUPRC score: 0.9412
val best accuracy score: 0.9009
val best F1 score: 0.9036
val target rna MSE score: 0.8112
val source rna MSE score: 0.2102
val target atac MSE score: 0.4918
val source atac MSE score: 0.1050
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
