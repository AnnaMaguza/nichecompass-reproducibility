[True]
Run timestamp: 07082023_222327_162.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_162']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8880; val_auprc_score: 0.8980; val_best_acc_score: 0.5590; val_best_f1_score: 0.6928; train_kl_reg_loss: 50138.5081; train_edge_recon_loss: 3475725.8056; train_gene_expr_recon_loss: 1131949.6806; train_masked_gp_l1_reg_loss: 16493.8855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167196.3872; train_chrom_access_recon_loss: 722692.4444; train_global_loss: 5564196.7222; train_optim_loss: 5564196.7222; val_kl_reg_loss: 17752.4668; val_edge_recon_loss: 4061125.7500; val_gene_expr_recon_loss: 971626.9375; val_masked_gp_l1_reg_loss: 12305.1611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162498.1719; val_chrom_access_recon_loss: 499023.4375; val_global_loss: 5724331.5000; val_optim_loss: 5724331.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8796; val_auprc_score: 0.8902; val_best_acc_score: 0.5940; val_best_f1_score: 0.7093; train_kl_reg_loss: 13453.7333; train_edge_recon_loss: 3477716.2222; train_gene_expr_recon_loss: 922679.1806; train_masked_gp_l1_reg_loss: 10583.5487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159386.6094; train_chrom_access_recon_loss: 487103.0903; train_global_loss: 5070922.0556; train_optim_loss: 5070922.0556; val_kl_reg_loss: 10705.8750; val_edge_recon_loss: 4059037.2500; val_gene_expr_recon_loss: 867428.2500; val_masked_gp_l1_reg_loss: 9130.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155485.9688; val_chrom_access_recon_loss: 467645.0312; val_global_loss: 5569432.0000; val_optim_loss: 5569432.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8634; val_auprc_score: 0.8733; val_best_acc_score: 0.6319; val_best_f1_score: 0.7269; train_kl_reg_loss: 13177.0858; train_edge_recon_loss: 3477911.0000; train_gene_expr_recon_loss: 848581.4306; train_masked_gp_l1_reg_loss: 8919.7100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152155.7361; train_chrom_access_recon_loss: 467680.5729; train_global_loss: 4968425.5000; train_optim_loss: 4968425.5000; val_kl_reg_loss: 14587.8086; val_edge_recon_loss: 4054751.5000; val_gene_expr_recon_loss: 819657.1250; val_masked_gp_l1_reg_loss: 8693.5244; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147754.0312; val_chrom_access_recon_loss: 457974.1250; val_global_loss: 5503418.0000; val_optim_loss: 5503418.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8521; val_auprc_score: 0.8528; val_best_acc_score: 0.7203; val_best_f1_score: 0.7685; train_kl_reg_loss: 14346.6043; train_edge_recon_loss: 3477542.4444; train_gene_expr_recon_loss: 809589.1875; train_masked_gp_l1_reg_loss: 8426.9495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143832.1979; train_chrom_access_recon_loss: 459737.8160; train_global_loss: 4913475.3333; train_optim_loss: 4913475.3333; val_kl_reg_loss: 13781.5283; val_edge_recon_loss: 4035440.7500; val_gene_expr_recon_loss: 793224.6250; val_masked_gp_l1_reg_loss: 8175.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138725.0938; val_chrom_access_recon_loss: 452658.7500; val_global_loss: 5442006.0000; val_optim_loss: 5442006.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8358; val_auprc_score: 0.8266; val_best_acc_score: 0.7532; val_best_f1_score: 0.7595; train_kl_reg_loss: 14278.8626; train_edge_recon_loss: 3473529.8889; train_gene_expr_recon_loss: 782552.7917; train_masked_gp_l1_reg_loss: 8065.3468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134421.8333; train_chrom_access_recon_loss: 455547.1493; train_global_loss: 4868395.9444; train_optim_loss: 4868395.9444; val_kl_reg_loss: 12238.5996; val_edge_recon_loss: 3986975.5000; val_gene_expr_recon_loss: 771950.1250; val_masked_gp_l1_reg_loss: 7941.7998; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128961.7578; val_chrom_access_recon_loss: 449489.1250; val_global_loss: 5357557.0000; val_optim_loss: 5357557.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8345; val_auprc_score: 0.8190; val_best_acc_score: 0.7517; val_best_f1_score: 0.7741; train_kl_reg_loss: 11531.2090; train_edge_recon_loss: 3450490.5278; train_gene_expr_recon_loss: 771185.2083; train_masked_gp_l1_reg_loss: 7896.0141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124560.6372; train_chrom_access_recon_loss: 454147.0347; train_global_loss: 4819810.7222; train_optim_loss: 4819810.7222; val_kl_reg_loss: 8359.0137; val_edge_recon_loss: 3731533.5000; val_gene_expr_recon_loss: 765322.2500; val_masked_gp_l1_reg_loss: 7850.0269; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119079.4688; val_chrom_access_recon_loss: 448363.0938; val_global_loss: 5080507.5000; val_optim_loss: 5080507.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8366; val_auprc_score: 0.8230; val_best_acc_score: 0.7540; val_best_f1_score: 0.7822; train_kl_reg_loss: 7674.4393; train_edge_recon_loss: 3285723.6944; train_gene_expr_recon_loss: 786603.5625; train_masked_gp_l1_reg_loss: 7835.8385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114831.0009; train_chrom_access_recon_loss: 454904.0903; train_global_loss: 4657572.6667; train_optim_loss: 4657572.6667; val_kl_reg_loss: 11469.3359; val_edge_recon_loss: 3065564.0000; val_gene_expr_recon_loss: 813824.4375; val_masked_gp_l1_reg_loss: 7806.5449; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109673.2656; val_chrom_access_recon_loss: 452330.9688; val_global_loss: 4460668.5000; val_optim_loss: 4460668.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8757; val_auprc_score: 0.8724; val_best_acc_score: 0.7778; val_best_f1_score: 0.7888; train_kl_reg_loss: 24288.4194; train_edge_recon_loss: 2955887.3611; train_gene_expr_recon_loss: 801582.8403; train_masked_gp_l1_reg_loss: 7840.5176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105755.5260; train_chrom_access_recon_loss: 457699.3785; train_global_loss: 4353054.1111; train_optim_loss: 4353054.1111; val_kl_reg_loss: 40093.7344; val_edge_recon_loss: 2900387.2500; val_gene_expr_recon_loss: 783330.3750; val_masked_gp_l1_reg_loss: 7840.0361; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100937.3438; val_chrom_access_recon_loss: 448661.5625; val_global_loss: 4281250.5000; val_optim_loss: 4281250.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8795; val_auprc_score: 0.8566; val_best_acc_score: 0.7982; val_best_f1_score: 0.8135; train_kl_reg_loss: 49734.3220; train_edge_recon_loss: 2875275.6111; train_gene_expr_recon_loss: 768380.0972; train_masked_gp_l1_reg_loss: 7815.9829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97244.3281; train_chrom_access_recon_loss: 451545.0625; train_global_loss: 4249995.4167; train_optim_loss: 4249995.4167; val_kl_reg_loss: 52300.7305; val_edge_recon_loss: 2863969.5000; val_gene_expr_recon_loss: 763169.0000; val_masked_gp_l1_reg_loss: 7807.8687; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92679.6406; val_chrom_access_recon_loss: 446651.3125; val_global_loss: 4226578.0000; val_optim_loss: 4226578.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9032; val_auprc_score: 0.8774; val_best_acc_score: 0.8292; val_best_f1_score: 0.8409; train_kl_reg_loss: 49088.0208; train_edge_recon_loss: 2821789.4167; train_gene_expr_recon_loss: 757675.0208; train_masked_gp_l1_reg_loss: 7814.1090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89203.3394; train_chrom_access_recon_loss: 449427.3229; train_global_loss: 4174997.2500; train_optim_loss: 4174997.2500; val_kl_reg_loss: 39738.2891; val_edge_recon_loss: 2824432.7500; val_gene_expr_recon_loss: 754007.0625; val_masked_gp_l1_reg_loss: 7797.8784; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84957.6641; val_chrom_access_recon_loss: 444650.0938; val_global_loss: 4155583.7500; val_optim_loss: 4155583.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9152; val_auprc_score: 0.8871; val_best_acc_score: 0.8558; val_best_f1_score: 0.8653; train_kl_reg_loss: 37114.9701; train_edge_recon_loss: 2769492.3889; train_gene_expr_recon_loss: 753705.6111; train_masked_gp_l1_reg_loss: 7772.0737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81800.7439; train_chrom_access_recon_loss: 448832.5312; train_global_loss: 4098718.3611; train_optim_loss: 4098718.3611; val_kl_reg_loss: 34639.9219; val_edge_recon_loss: 2771373.0000; val_gene_expr_recon_loss: 751224.3750; val_masked_gp_l1_reg_loss: 7731.8428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78009.4453; val_chrom_access_recon_loss: 443742.6250; val_global_loss: 4086721.5000; val_optim_loss: 4086721.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9252; val_auprc_score: 0.9018; val_best_acc_score: 0.8624; val_best_f1_score: 0.8714; train_kl_reg_loss: 39193.8381; train_edge_recon_loss: 2739437.4722; train_gene_expr_recon_loss: 750505.3542; train_masked_gp_l1_reg_loss: 7711.3557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75224.7552; train_chrom_access_recon_loss: 447065.4757; train_global_loss: 4059138.3056; train_optim_loss: 4059138.3056; val_kl_reg_loss: 42025.6367; val_edge_recon_loss: 2760962.2500; val_gene_expr_recon_loss: 745701.7500; val_masked_gp_l1_reg_loss: 7711.8018; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71881.0312; val_chrom_access_recon_loss: 442305.2188; val_global_loss: 4070587.7500; val_optim_loss: 4070587.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9268; val_auprc_score: 0.9033; val_best_acc_score: 0.8657; val_best_f1_score: 0.8757; train_kl_reg_loss: 44946.6827; train_edge_recon_loss: 2727214.4167; train_gene_expr_recon_loss: 741219.6806; train_masked_gp_l1_reg_loss: 7710.4872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69414.7726; train_chrom_access_recon_loss: 445677.6042; train_global_loss: 4036183.5556; train_optim_loss: 4036183.5556; val_kl_reg_loss: 43874.1953; val_edge_recon_loss: 2757658.0000; val_gene_expr_recon_loss: 738986.5000; val_masked_gp_l1_reg_loss: 7717.5044; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66428.8906; val_chrom_access_recon_loss: 440773.2812; val_global_loss: 4055438.5000; val_optim_loss: 4055438.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9358; val_auprc_score: 0.9150; val_best_acc_score: 0.8781; val_best_f1_score: 0.8855; train_kl_reg_loss: 43707.9822; train_edge_recon_loss: 2727858.5000; train_gene_expr_recon_loss: 736213.5000; train_masked_gp_l1_reg_loss: 7727.6018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64223.0477; train_chrom_access_recon_loss: 443478.2465; train_global_loss: 4023208.8611; train_optim_loss: 4023208.8611; val_kl_reg_loss: 40186.9883; val_edge_recon_loss: 2736038.5000; val_gene_expr_recon_loss: 734042.1250; val_masked_gp_l1_reg_loss: 7751.4526; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61563.3789; val_chrom_access_recon_loss: 439910.5000; val_global_loss: 4019493.0000; val_optim_loss: 4019493.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9333; val_auprc_score: 0.9059; val_best_acc_score: 0.8818; val_best_f1_score: 0.8894; train_kl_reg_loss: 40600.7465; train_edge_recon_loss: 2716670.3611; train_gene_expr_recon_loss: 732645.6389; train_masked_gp_l1_reg_loss: 7762.4725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59571.7370; train_chrom_access_recon_loss: 444642.4062; train_global_loss: 4001893.3333; train_optim_loss: 4001893.3333; val_kl_reg_loss: 38633.5078; val_edge_recon_loss: 2739325.7500; val_gene_expr_recon_loss: 729747.3750; val_masked_gp_l1_reg_loss: 7775.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57169.3281; val_chrom_access_recon_loss: 439103.6562; val_global_loss: 4011755.2500; val_optim_loss: 4011755.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9436; val_auprc_score: 0.9187; val_best_acc_score: 0.8911; val_best_f1_score: 0.8969; train_kl_reg_loss: 39837.8203; train_edge_recon_loss: 2719090.8056; train_gene_expr_recon_loss: 727604.1458; train_masked_gp_l1_reg_loss: 7808.3389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55376.4640; train_chrom_access_recon_loss: 443043.0139; train_global_loss: 3992760.5556; train_optim_loss: 3992760.5556; val_kl_reg_loss: 37297.3594; val_edge_recon_loss: 2718488.2500; val_gene_expr_recon_loss: 726987.4375; val_masked_gp_l1_reg_loss: 7831.3701; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53197.9375; val_chrom_access_recon_loss: 438321.3750; val_global_loss: 3982123.5000; val_optim_loss: 3982123.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9412; val_auprc_score: 0.9178; val_best_acc_score: 0.8882; val_best_f1_score: 0.8948; train_kl_reg_loss: 37428.4505; train_edge_recon_loss: 2712737.3889; train_gene_expr_recon_loss: 726957.2361; train_masked_gp_l1_reg_loss: 7861.3457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51586.6224; train_chrom_access_recon_loss: 441778.9306; train_global_loss: 3978350.0000; train_optim_loss: 3978350.0000; val_kl_reg_loss: 34867.4805; val_edge_recon_loss: 2746013.0000; val_gene_expr_recon_loss: 722320.8125; val_masked_gp_l1_reg_loss: 7889.5254; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49640.8203; val_chrom_access_recon_loss: 437669.3438; val_global_loss: 3998400.7500; val_optim_loss: 3998400.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9505; val_auprc_score: 0.9331; val_best_acc_score: 0.9006; val_best_f1_score: 0.9066; train_kl_reg_loss: 36302.3516; train_edge_recon_loss: 2719517.6944; train_gene_expr_recon_loss: 721134.5278; train_masked_gp_l1_reg_loss: 7933.7582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48196.6241; train_chrom_access_recon_loss: 442539.6354; train_global_loss: 3975624.6389; train_optim_loss: 3975624.6389; val_kl_reg_loss: 34659.7969; val_edge_recon_loss: 2691714.2500; val_gene_expr_recon_loss: 719570.8125; val_masked_gp_l1_reg_loss: 7962.8760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46433.3672; val_chrom_access_recon_loss: 436830.1875; val_global_loss: 3937171.2500; val_optim_loss: 3937171.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9481; val_auprc_score: 0.9291; val_best_acc_score: 0.8952; val_best_f1_score: 0.9016; train_kl_reg_loss: 36139.7144; train_edge_recon_loss: 2718483.8611; train_gene_expr_recon_loss: 720314.3958; train_masked_gp_l1_reg_loss: 7997.6866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45131.9210; train_chrom_access_recon_loss: 439869.4896; train_global_loss: 3967937.0833; train_optim_loss: 3967937.0833; val_kl_reg_loss: 34429.3281; val_edge_recon_loss: 2711490.7500; val_gene_expr_recon_loss: 717358.2500; val_masked_gp_l1_reg_loss: 8043.4912; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43558.1562; val_chrom_access_recon_loss: 435950.1875; val_global_loss: 3950830.2500; val_optim_loss: 3950830.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9534; val_auprc_score: 0.9377; val_best_acc_score: 0.8999; val_best_f1_score: 0.9062; train_kl_reg_loss: 35689.8937; train_edge_recon_loss: 2716181.4167; train_gene_expr_recon_loss: 719229.8403; train_masked_gp_l1_reg_loss: 8074.1550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42391.5425; train_chrom_access_recon_loss: 440226.8056; train_global_loss: 3961793.7222; train_optim_loss: 3961793.7222; val_kl_reg_loss: 34679.0078; val_edge_recon_loss: 2705149.2500; val_gene_expr_recon_loss: 712707.0000; val_masked_gp_l1_reg_loss: 8111.3604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40973.8516; val_chrom_access_recon_loss: 435152.5312; val_global_loss: 3936772.7500; val_optim_loss: 3936772.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9560; val_auprc_score: 0.9433; val_best_acc_score: 0.9012; val_best_f1_score: 0.9073; train_kl_reg_loss: 35701.6727; train_edge_recon_loss: 2713175.1944; train_gene_expr_recon_loss: 712762.6736; train_masked_gp_l1_reg_loss: 8149.2862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39908.9436; train_chrom_access_recon_loss: 439411.4271; train_global_loss: 3949109.1389; train_optim_loss: 3949109.1389; val_kl_reg_loss: 35080.1602; val_edge_recon_loss: 2715557.0000; val_gene_expr_recon_loss: 710249.3750; val_masked_gp_l1_reg_loss: 8186.6802; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38599.2578; val_chrom_access_recon_loss: 434624.1250; val_global_loss: 3942296.5000; val_optim_loss: 3942296.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9585; val_auprc_score: 0.9427; val_best_acc_score: 0.9066; val_best_f1_score: 0.9120; train_kl_reg_loss: 36391.6780; train_edge_recon_loss: 2698541.1111; train_gene_expr_recon_loss: 711207.6389; train_masked_gp_l1_reg_loss: 8223.8943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37628.3542; train_chrom_access_recon_loss: 437535.6632; train_global_loss: 3929528.4167; train_optim_loss: 3929528.4167; val_kl_reg_loss: 34778.0117; val_edge_recon_loss: 2693419.7500; val_gene_expr_recon_loss: 709167.3125; val_masked_gp_l1_reg_loss: 8276.7998; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36438.6328; val_chrom_access_recon_loss: 433881.5000; val_global_loss: 3915962.0000; val_optim_loss: 3915962.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9562; val_auprc_score: 0.9410; val_best_acc_score: 0.9041; val_best_f1_score: 0.9086; train_kl_reg_loss: 35907.4214; train_edge_recon_loss: 2715495.6389; train_gene_expr_recon_loss: 708809.5556; train_masked_gp_l1_reg_loss: 8316.6592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35562.2491; train_chrom_access_recon_loss: 438404.2222; train_global_loss: 3942495.7500; train_optim_loss: 3942495.7500; val_kl_reg_loss: 34166.2461; val_edge_recon_loss: 2716456.7500; val_gene_expr_recon_loss: 708067.5625; val_masked_gp_l1_reg_loss: 8354.3662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34473.3438; val_chrom_access_recon_loss: 433356.8438; val_global_loss: 3934874.7500; val_optim_loss: 3934874.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9585; val_auprc_score: 0.9457; val_best_acc_score: 0.9043; val_best_f1_score: 0.9088; train_kl_reg_loss: 35061.0352; train_edge_recon_loss: 2712352.8056; train_gene_expr_recon_loss: 705646.2083; train_masked_gp_l1_reg_loss: 8392.7664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33668.8789; train_chrom_access_recon_loss: 436704.0625; train_global_loss: 3931825.8333; train_optim_loss: 3931825.8333; val_kl_reg_loss: 33427.4219; val_edge_recon_loss: 2725026.0000; val_gene_expr_recon_loss: 706058.7500; val_masked_gp_l1_reg_loss: 8428.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32683.8672; val_chrom_access_recon_loss: 432862.2500; val_global_loss: 3938486.7500; val_optim_loss: 3938486.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9618; val_auprc_score: 0.9497; val_best_acc_score: 0.9111; val_best_f1_score: 0.9159; train_kl_reg_loss: 34965.3368; train_edge_recon_loss: 2700933.7500; train_gene_expr_recon_loss: 704329.0694; train_masked_gp_l1_reg_loss: 8468.5115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31957.4666; train_chrom_access_recon_loss: 435637.7951; train_global_loss: 3916291.8333; train_optim_loss: 3916291.8333; val_kl_reg_loss: 33621.0859; val_edge_recon_loss: 2715055.2500; val_gene_expr_recon_loss: 703541.3750; val_masked_gp_l1_reg_loss: 8507.5820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31064.1094; val_chrom_access_recon_loss: 432147.9062; val_global_loss: 3923937.0000; val_optim_loss: 3923937.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9641; val_auprc_score: 0.9519; val_best_acc_score: 0.9123; val_best_f1_score: 0.9164; train_kl_reg_loss: 31633.0382; train_edge_recon_loss: 2695989.9444; train_gene_expr_recon_loss: 965604.8194; train_masked_gp_l1_reg_loss: 8522.7551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30130.2891; train_chrom_access_recon_loss: 466432.4444; train_global_loss: 4198313.1944; train_optim_loss: 4198313.1944; val_kl_reg_loss: 9712.6172; val_edge_recon_loss: 2703638.2500; val_gene_expr_recon_loss: 947219.2500; val_masked_gp_l1_reg_loss: 8488.8262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28821.0645; val_chrom_access_recon_loss: 457764.2188; val_global_loss: 4155644.0000; val_optim_loss: 4155644.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9672; val_auprc_score: 0.9555; val_best_acc_score: 0.9170; val_best_f1_score: 0.9198; train_kl_reg_loss: 27908.5773; train_edge_recon_loss: 2703714.1111; train_gene_expr_recon_loss: 951395.0000; train_masked_gp_l1_reg_loss: 8413.5618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28603.7674; train_chrom_access_recon_loss: 463817.0903; train_global_loss: 4183852.0833; train_optim_loss: 4183852.0833; val_kl_reg_loss: 9605.1846; val_edge_recon_loss: 2695662.0000; val_gene_expr_recon_loss: 950561.6250; val_masked_gp_l1_reg_loss: 8336.2334; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28343.0625; val_chrom_access_recon_loss: 458178.4688; val_global_loss: 4150686.7500; val_optim_loss: 4150686.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9663; val_auprc_score: 0.9541; val_best_acc_score: 0.9178; val_best_f1_score: 0.9215; train_kl_reg_loss: 27579.7893; train_edge_recon_loss: 2694804.1944; train_gene_expr_recon_loss: 958189.3750; train_masked_gp_l1_reg_loss: 8320.8873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28182.7042; train_chrom_access_recon_loss: 462974.0590; train_global_loss: 4180051.0000; train_optim_loss: 4180051.0000; val_kl_reg_loss: 9816.7598; val_edge_recon_loss: 2664833.7500; val_gene_expr_recon_loss: 958551.1250; val_masked_gp_l1_reg_loss: 8296.0967; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27973.9727; val_chrom_access_recon_loss: 459034.5625; val_global_loss: 4128506.0000; val_optim_loss: 4128506.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9664; val_auprc_score: 0.9495; val_best_acc_score: 0.9158; val_best_f1_score: 0.9190; train_kl_reg_loss: 27423.6456; train_edge_recon_loss: 2672810.0833; train_gene_expr_recon_loss: 959242.1111; train_masked_gp_l1_reg_loss: 8281.6517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27818.2867; train_chrom_access_recon_loss: 463823.6181; train_global_loss: 4159399.4444; train_optim_loss: 4159399.4444; val_kl_reg_loss: 9798.4658; val_edge_recon_loss: 2692883.5000; val_gene_expr_recon_loss: 955801.7500; val_masked_gp_l1_reg_loss: 8266.2002; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27627.5430; val_chrom_access_recon_loss: 458734.9062; val_global_loss: 4153112.5000; val_optim_loss: 4153112.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9688; val_auprc_score: 0.9557; val_best_acc_score: 0.9210; val_best_f1_score: 0.9237; train_kl_reg_loss: 26907.8589; train_edge_recon_loss: 2675944.6667; train_gene_expr_recon_loss: 962666.9861; train_masked_gp_l1_reg_loss: 8258.1173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27481.4707; train_chrom_access_recon_loss: 465146.1979; train_global_loss: 4166405.2778; train_optim_loss: 4166405.2778; val_kl_reg_loss: 9533.2188; val_edge_recon_loss: 2675169.0000; val_gene_expr_recon_loss: 953349.5000; val_masked_gp_l1_reg_loss: 8250.1084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27302.6523; val_chrom_access_recon_loss: 458393.7500; val_global_loss: 4131998.2500; val_optim_loss: 4131998.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 53 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9575
val AUPRC score: 0.9434
val best accuracy score: 0.9088
val best F1 score: 0.9122
val target rna MSE score: 4.0073
val source rna MSE score: 3.2539
val target atac MSE score: 0.1352
val source atac MSE score: 0.0214
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
