Run timestamp: 21062023_105847_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '12', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', '4', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 3033 highly variable or gene program relevant genes.
Keeping 2198 genes after filtering genes not in gp dict.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 2198, n_cond_embed_input: 4, n_layers: 1, n_hidden: 1508, n_latent: 1508, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1508, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1508, n_cond_embed_input: 4, n_addon_input: 0, n_output: 4396
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 2198, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 28792
Number of validation nodes: 3199
Number of training edges: 193705
Number of validation edges: 21522
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8779; val_auprc_score: 0.9601; val_best_acc_score: 0.8801; val_best_f1_score: 0.9279; train_kl_reg_loss: 70214.0269; train_edge_recon_loss: 163418.5162; train_gene_expr_recon_loss: 1336096.0141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1569728.5546; train_optim_loss: 1569728.5546; val_kl_reg_loss: 63878.4844; val_edge_recon_loss: 157885.1717; val_gene_expr_recon_loss: 952108.2415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1173871.8693; val_optim_loss: 1173871.8693
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9008; val_auprc_score: 0.9657; val_best_acc_score: 0.8969; val_best_f1_score: 0.9366; train_kl_reg_loss: 54143.7399; train_edge_recon_loss: 161221.7352; train_gene_expr_recon_loss: 914214.7507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1129580.2217; train_optim_loss: 1129580.2217; val_kl_reg_loss: 45059.6085; val_edge_recon_loss: 159288.6491; val_gene_expr_recon_loss: 884812.9744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1089161.2330; val_optim_loss: 1089161.2330
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9103; val_auprc_score: 0.9694; val_best_acc_score: 0.9090; val_best_f1_score: 0.9450; train_kl_reg_loss: 42153.4366; train_edge_recon_loss: 154226.6882; train_gene_expr_recon_loss: 869358.3586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1065738.4855; train_optim_loss: 1065738.4855; val_kl_reg_loss: 38699.0105; val_edge_recon_loss: 152548.8047; val_gene_expr_recon_loss: 852122.8381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1043370.6591; val_optim_loss: 1043370.6591
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9137; val_auprc_score: 0.9713; val_best_acc_score: 0.9082; val_best_f1_score: 0.9444; train_kl_reg_loss: 36897.7748; train_edge_recon_loss: 146488.4451; train_gene_expr_recon_loss: 843392.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1026778.6641; train_optim_loss: 1026778.6641; val_kl_reg_loss: 34328.3233; val_edge_recon_loss: 142672.3235; val_gene_expr_recon_loss: 829550.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1006551.3665; val_optim_loss: 1006551.3665
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9189; val_auprc_score: 0.9735; val_best_acc_score: 0.9082; val_best_f1_score: 0.9445; train_kl_reg_loss: 32893.8486; train_edge_recon_loss: 141510.7395; train_gene_expr_recon_loss: 823237.9355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 997642.5247; train_optim_loss: 997642.5247; val_kl_reg_loss: 31299.5498; val_edge_recon_loss: 140297.6658; val_gene_expr_recon_loss: 812349.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 983946.5256; val_optim_loss: 983946.5256
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9272; val_auprc_score: 0.9769; val_best_acc_score: 0.9161; val_best_f1_score: 0.9491; train_kl_reg_loss: 29930.8963; train_edge_recon_loss: 137725.5836; train_gene_expr_recon_loss: 806018.7868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 973675.2688; train_optim_loss: 973675.2688; val_kl_reg_loss: 27838.1433; val_edge_recon_loss: 134193.8629; val_gene_expr_recon_loss: 797285.2330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 959317.2330; val_optim_loss: 959317.2330
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9316; val_auprc_score: 0.9779; val_best_acc_score: 0.9190; val_best_f1_score: 0.9512; train_kl_reg_loss: 27351.0503; train_edge_recon_loss: 135068.6724; train_gene_expr_recon_loss: 790737.2543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 953156.9773; train_optim_loss: 953156.9773; val_kl_reg_loss: 25464.1067; val_edge_recon_loss: 129873.8526; val_gene_expr_recon_loss: 784797.3608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 940135.3182; val_optim_loss: 940135.3182
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9452; val_auprc_score: 0.9827; val_best_acc_score: 0.9228; val_best_f1_score: 0.9529; train_kl_reg_loss: 25026.3364; train_edge_recon_loss: 132629.1414; train_gene_expr_recon_loss: 777491.2296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 935146.7069; train_optim_loss: 935146.7069; val_kl_reg_loss: 23427.6032; val_edge_recon_loss: 132206.6644; val_gene_expr_recon_loss: 770783.5369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 926417.8011; val_optim_loss: 926417.8011
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9508; val_auprc_score: 0.9839; val_best_acc_score: 0.9275; val_best_f1_score: 0.9559; train_kl_reg_loss: 23084.1184; train_edge_recon_loss: 130923.5891; train_gene_expr_recon_loss: 765573.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 919581.5641; train_optim_loss: 919581.5641; val_kl_reg_loss: 21821.3049; val_edge_recon_loss: 127087.3807; val_gene_expr_recon_loss: 758112.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 907021.3438; val_optim_loss: 907021.3438
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9597; val_auprc_score: 0.9867; val_best_acc_score: 0.9330; val_best_f1_score: 0.9590; train_kl_reg_loss: 21374.1850; train_edge_recon_loss: 127826.9422; train_gene_expr_recon_loss: 755880.4734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 905081.6007; train_optim_loss: 905081.6007; val_kl_reg_loss: 19961.1286; val_edge_recon_loss: 130638.2496; val_gene_expr_recon_loss: 748871.8892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 899471.2756; val_optim_loss: 899471.2756
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9656; val_auprc_score: 0.9884; val_best_acc_score: 0.9425; val_best_f1_score: 0.9645; train_kl_reg_loss: 19802.6267; train_edge_recon_loss: 125818.2176; train_gene_expr_recon_loss: 746159.5967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 891780.4421; train_optim_loss: 891780.4421; val_kl_reg_loss: 18569.9989; val_edge_recon_loss: 126193.3853; val_gene_expr_recon_loss: 740539.4432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 885302.8267; val_optim_loss: 885302.8267
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9671; val_auprc_score: 0.9888; val_best_acc_score: 0.9495; val_best_f1_score: 0.9689; train_kl_reg_loss: 18360.8538; train_edge_recon_loss: 123901.1378; train_gene_expr_recon_loss: 737207.6595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 879469.6487; train_optim_loss: 879469.6487; val_kl_reg_loss: 16931.9204; val_edge_recon_loss: 120459.8082; val_gene_expr_recon_loss: 732301.7074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 869693.4347; val_optim_loss: 869693.4347
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9722; val_auprc_score: 0.9912; val_best_acc_score: 0.9533; val_best_f1_score: 0.9713; train_kl_reg_loss: 16940.5260; train_edge_recon_loss: 122058.1896; train_gene_expr_recon_loss: 729314.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 868312.7720; train_optim_loss: 868312.7720; val_kl_reg_loss: 15893.9804; val_edge_recon_loss: 119829.7717; val_gene_expr_recon_loss: 723757.6278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 859481.3835; val_optim_loss: 859481.3835
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9734; val_auprc_score: 0.9908; val_best_acc_score: 0.9559; val_best_f1_score: 0.9727; train_kl_reg_loss: 15645.9673; train_edge_recon_loss: 119967.8935; train_gene_expr_recon_loss: 721916.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 857530.3329; train_optim_loss: 857530.3329; val_kl_reg_loss: 14427.9241; val_edge_recon_loss: 119808.6726; val_gene_expr_recon_loss: 718160.4943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 852397.0938; val_optim_loss: 852397.0938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9737; val_auprc_score: 0.9907; val_best_acc_score: 0.9583; val_best_f1_score: 0.9742; train_kl_reg_loss: 14275.9325; train_edge_recon_loss: 118588.1622; train_gene_expr_recon_loss: 715508.4089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 848372.5039; train_optim_loss: 848372.5039; val_kl_reg_loss: 13424.2935; val_edge_recon_loss: 120514.8540; val_gene_expr_recon_loss: 710591.6960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 844530.8466; val_optim_loss: 844530.8466
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9761; val_auprc_score: 0.9919; val_best_acc_score: 0.9599; val_best_f1_score: 0.9752; train_kl_reg_loss: 13004.1803; train_edge_recon_loss: 116491.6085; train_gene_expr_recon_loss: 708941.1174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 838436.9095; train_optim_loss: 838436.9095; val_kl_reg_loss: 12174.4654; val_edge_recon_loss: 113917.5394; val_gene_expr_recon_loss: 704380.1989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 830472.2017; val_optim_loss: 830472.2017
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9742; val_auprc_score: 0.9907; val_best_acc_score: 0.9594; val_best_f1_score: 0.9748; train_kl_reg_loss: 11896.8361; train_edge_recon_loss: 115616.3519; train_gene_expr_recon_loss: 703043.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 830556.6296; train_optim_loss: 830556.6296; val_kl_reg_loss: 11349.9866; val_edge_recon_loss: 113822.9755; val_gene_expr_recon_loss: 698768.0795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 823941.0455; val_optim_loss: 823941.0455
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9781; val_auprc_score: 0.9918; val_best_acc_score: 0.9626; val_best_f1_score: 0.9768; train_kl_reg_loss: 10871.0493; train_edge_recon_loss: 113669.9843; train_gene_expr_recon_loss: 697943.7385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 822484.7734; train_optim_loss: 822484.7734; val_kl_reg_loss: 10130.1091; val_edge_recon_loss: 115027.4702; val_gene_expr_recon_loss: 693873.0511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 819030.6278; val_optim_loss: 819030.6278
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9773; val_auprc_score: 0.9915; val_best_acc_score: 0.9625; val_best_f1_score: 0.9768; train_kl_reg_loss: 10020.4876; train_edge_recon_loss: 112608.3508; train_gene_expr_recon_loss: 692854.4882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 815483.3283; train_optim_loss: 815483.3283; val_kl_reg_loss: 9303.5057; val_edge_recon_loss: 110308.6705; val_gene_expr_recon_loss: 689226.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 808838.6790; val_optim_loss: 808838.6790
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9822; val_auprc_score: 0.9943; val_best_acc_score: 0.9644; val_best_f1_score: 0.9779; train_kl_reg_loss: 9256.4094; train_edge_recon_loss: 111728.7026; train_gene_expr_recon_loss: 687970.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 808955.5234; train_optim_loss: 808955.5234; val_kl_reg_loss: 8722.9623; val_edge_recon_loss: 108229.4810; val_gene_expr_recon_loss: 684511.1108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 801463.5568; val_optim_loss: 801463.5568
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9817; val_auprc_score: 0.9933; val_best_acc_score: 0.9660; val_best_f1_score: 0.9788; train_kl_reg_loss: 8622.3235; train_edge_recon_loss: 110474.2325; train_gene_expr_recon_loss: 683727.7977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 802824.3539; train_optim_loss: 802824.3539; val_kl_reg_loss: 8382.8237; val_edge_recon_loss: 112527.5938; val_gene_expr_recon_loss: 679688.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 800598.4858; val_optim_loss: 800598.4858
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9796; val_auprc_score: 0.9922; val_best_acc_score: 0.9647; val_best_f1_score: 0.9781; train_kl_reg_loss: 8130.0743; train_edge_recon_loss: 110000.4662; train_gene_expr_recon_loss: 679628.3092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 797758.8490; train_optim_loss: 797758.8490; val_kl_reg_loss: 7736.4071; val_edge_recon_loss: 109551.6005; val_gene_expr_recon_loss: 676809.3977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 794097.4091; val_optim_loss: 794097.4091
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9803; val_auprc_score: 0.9931; val_best_acc_score: 0.9648; val_best_f1_score: 0.9781; train_kl_reg_loss: 7737.6395; train_edge_recon_loss: 109389.2782; train_gene_expr_recon_loss: 675815.1711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 792942.0888; train_optim_loss: 792942.0888; val_kl_reg_loss: 7372.7369; val_edge_recon_loss: 107113.0124; val_gene_expr_recon_loss: 673064.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 787549.9432; val_optim_loss: 787549.9432
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9820; val_auprc_score: 0.9939; val_best_acc_score: 0.9681; val_best_f1_score: 0.9802; train_kl_reg_loss: 7445.4641; train_edge_recon_loss: 109155.6102; train_gene_expr_recon_loss: 672703.8118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 789304.8875; train_optim_loss: 789304.8875; val_kl_reg_loss: 7048.6442; val_edge_recon_loss: 106397.9705; val_gene_expr_recon_loss: 670275.3352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 783721.9517; val_optim_loss: 783721.9517
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9833; val_auprc_score: 0.9941; val_best_acc_score: 0.9681; val_best_f1_score: 0.9801; train_kl_reg_loss: 7230.4122; train_edge_recon_loss: 108912.5841; train_gene_expr_recon_loss: 669431.9530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 785574.9510; train_optim_loss: 785574.9510; val_kl_reg_loss: 7096.8636; val_edge_recon_loss: 111573.1300; val_gene_expr_recon_loss: 667081.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 785751.8665; val_optim_loss: 785751.8665
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9819; val_auprc_score: 0.9937; val_best_acc_score: 0.9664; val_best_f1_score: 0.9792; train_kl_reg_loss: 6403.7852; train_edge_recon_loss: 108717.4142; train_gene_expr_recon_loss: 667281.9013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 782403.1003; train_optim_loss: 782403.1003; val_kl_reg_loss: 5744.5251; val_edge_recon_loss: 108690.9755; val_gene_expr_recon_loss: 664330.3409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 778765.8466; val_optim_loss: 778765.8466
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9827; val_auprc_score: 0.9931; val_best_acc_score: 0.9684; val_best_f1_score: 0.9804; train_kl_reg_loss: 6081.4480; train_edge_recon_loss: 107848.5334; train_gene_expr_recon_loss: 664284.3365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 778214.3171; train_optim_loss: 778214.3171; val_kl_reg_loss: 5603.8614; val_edge_recon_loss: 107417.6729; val_gene_expr_recon_loss: 663205.7528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 776227.2841; val_optim_loss: 776227.2841
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9827; val_auprc_score: 0.9939; val_best_acc_score: 0.9687; val_best_f1_score: 0.9805; train_kl_reg_loss: 5904.9675; train_edge_recon_loss: 107689.1172; train_gene_expr_recon_loss: 662455.2819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 776049.3664; train_optim_loss: 776049.3664; val_kl_reg_loss: 5703.8537; val_edge_recon_loss: 108942.6772; val_gene_expr_recon_loss: 660431.2216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 775077.7500; val_optim_loss: 775077.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9829; val_auprc_score: 0.9939; val_best_acc_score: 0.9655; val_best_f1_score: 0.9786; train_kl_reg_loss: 6299.7365; train_edge_recon_loss: 109317.7926; train_gene_expr_recon_loss: 669498.2207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 785115.7536; train_optim_loss: 785115.7536; val_kl_reg_loss: 5632.4641; val_edge_recon_loss: 107025.9091; val_gene_expr_recon_loss: 661325.6761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 773984.0455; val_optim_loss: 773984.0455
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9462; val_auprc_score: 0.9831; val_best_acc_score: 0.9156; val_best_f1_score: 0.9482; train_kl_reg_loss: 8029.9741; train_edge_recon_loss: 126892.6100; train_gene_expr_recon_loss: 777420.0704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 912342.6556; train_optim_loss: 912342.6556; val_kl_reg_loss: 4786.1233; val_edge_recon_loss: 115379.4304; val_gene_expr_recon_loss: 695207.5142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 815373.0739; val_optim_loss: 815373.0739
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9526; val_auprc_score: 0.9844; val_best_acc_score: 0.9251; val_best_f1_score: 0.9541; train_kl_reg_loss: 5203.7093; train_edge_recon_loss: 112244.7057; train_gene_expr_recon_loss: 689832.9434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 807281.3595; train_optim_loss: 807281.3595; val_kl_reg_loss: 4938.2766; val_edge_recon_loss: 113360.0941; val_gene_expr_recon_loss: 682257.3977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 800555.7670; val_optim_loss: 800555.7670
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9576; val_auprc_score: 0.9864; val_best_acc_score: 0.9306; val_best_f1_score: 0.9573; train_kl_reg_loss: 5162.3188; train_edge_recon_loss: 110446.4510; train_gene_expr_recon_loss: 681501.7184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 797110.4862; train_optim_loss: 797110.4862; val_kl_reg_loss: 4918.1621; val_edge_recon_loss: 112218.3633; val_gene_expr_recon_loss: 678359.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 795496.5057; val_optim_loss: 795496.5057

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9582; val_auprc_score: 0.9861; val_best_acc_score: 0.9333; val_best_f1_score: 0.9589; train_kl_reg_loss: 5122.8504; train_edge_recon_loss: 110485.9697; train_gene_expr_recon_loss: 678435.0474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 794043.8681; train_optim_loss: 794043.8681; val_kl_reg_loss: 4917.9873; val_edge_recon_loss: 105393.1982; val_gene_expr_recon_loss: 677119.5369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 787430.7244; val_optim_loss: 787430.7244
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9610; val_auprc_score: 0.9877; val_best_acc_score: 0.9332; val_best_f1_score: 0.9589; train_kl_reg_loss: 5119.4525; train_edge_recon_loss: 109534.7443; train_gene_expr_recon_loss: 677826.5671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 792480.7632; train_optim_loss: 792480.7632; val_kl_reg_loss: 4921.2237; val_edge_recon_loss: 109575.2475; val_gene_expr_recon_loss: 676182.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 790678.5909; val_optim_loss: 790678.5909
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9598; val_auprc_score: 0.9865; val_best_acc_score: 0.9353; val_best_f1_score: 0.9601; train_kl_reg_loss: 5110.0841; train_edge_recon_loss: 109838.8306; train_gene_expr_recon_loss: 677236.0217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 792184.9385; train_optim_loss: 792184.9385; val_kl_reg_loss: 4890.4429; val_edge_recon_loss: 111041.4972; val_gene_expr_recon_loss: 676997.6477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 792929.5795; val_optim_loss: 792929.5795

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 64 min 46 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9818
Val AUPRC score: 0.9933
Val best accuracy score: 0.9643
Val best F1 score: 0.9779
Val gene expr MSE score: 640.5782

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
