[True]
Run timestamp: 10082023_225334_86.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_86']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7380; val_auprc_score: 0.7683; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 120484.7649; train_edge_recon_loss: 3818340.0897; train_gene_expr_recon_loss: 45461789.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4115309.6679; train_global_loss: 53515924.3664; train_optim_loss: 53515924.3664; val_kl_reg_loss: 103377.8042; val_edge_recon_loss: 4065767.8333; val_gene_expr_recon_loss: 39544448.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3937189.7667; val_global_loss: 47650784.0000; val_optim_loss: 47650784.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7475; val_auprc_score: 0.7805; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 131445.6165; train_edge_recon_loss: 3729604.5668; train_gene_expr_recon_loss: 38880532.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3877346.9771; train_global_loss: 46618929.2519; train_optim_loss: 46618929.2519; val_kl_reg_loss: 201903.9073; val_edge_recon_loss: 4065080.7000; val_gene_expr_recon_loss: 37939222.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3851287.9333; val_global_loss: 46057496.0000; val_optim_loss: 46057496.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7625; val_auprc_score: 0.7883; val_best_acc_score: 0.5794; val_best_f1_score: 0.6941; train_kl_reg_loss: 166733.6517; train_edge_recon_loss: 3606752.4561; train_gene_expr_recon_loss: 37310557.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3816885.5286; train_global_loss: 44900929.0076; train_optim_loss: 44900929.0076; val_kl_reg_loss: 181729.9375; val_edge_recon_loss: 4060900.2000; val_gene_expr_recon_loss: 37153864.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3818039.1500; val_global_loss: 45214534.1333; val_optim_loss: 45214534.1333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8663; val_auprc_score: 0.8648; val_best_acc_score: 0.7757; val_best_f1_score: 0.7704; train_kl_reg_loss: 161654.4148; train_edge_recon_loss: 3556459.9084; train_gene_expr_recon_loss: 36636343.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3779041.9523; train_global_loss: 44133500.2748; train_optim_loss: 44133500.2748; val_kl_reg_loss: 144469.1688; val_edge_recon_loss: 4021657.5167; val_gene_expr_recon_loss: 36840654.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3798429.0667; val_global_loss: 44805210.1333; val_optim_loss: 44805210.1333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9005; val_auprc_score: 0.8923; val_best_acc_score: 0.8150; val_best_f1_score: 0.8307; train_kl_reg_loss: 142545.5665; train_edge_recon_loss: 3523931.9981; train_gene_expr_recon_loss: 36317502.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3762795.7672; train_global_loss: 43746775.6947; train_optim_loss: 43746775.6947; val_kl_reg_loss: 131820.6604; val_edge_recon_loss: 3789973.0000; val_gene_expr_recon_loss: 36466219.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3770490.6000; val_global_loss: 44158504.8000; val_optim_loss: 44158504.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8891; val_auprc_score: 0.8792; val_best_acc_score: 0.7988; val_best_f1_score: 0.8160; train_kl_reg_loss: 132777.4910; train_edge_recon_loss: 3228338.3912; train_gene_expr_recon_loss: 36085044.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3744939.3034; train_global_loss: 43191099.6031; train_optim_loss: 43191099.6031; val_kl_reg_loss: 163522.3354; val_edge_recon_loss: 3032894.6833; val_gene_expr_recon_loss: 36173048.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3738167.1500; val_global_loss: 43107632.5333; val_optim_loss: 43107632.5333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8954; val_auprc_score: 0.8856; val_best_acc_score: 0.8092; val_best_f1_score: 0.8245; train_kl_reg_loss: 167013.8203; train_edge_recon_loss: 3022561.5687; train_gene_expr_recon_loss: 35863247.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3729605.1756; train_global_loss: 42782428.4580; train_optim_loss: 42782428.4580; val_kl_reg_loss: 165263.5312; val_edge_recon_loss: 3025460.6833; val_gene_expr_recon_loss: 35929876.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3723851.4333; val_global_loss: 42844451.7333; val_optim_loss: 42844451.7333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9085; val_auprc_score: 0.8995; val_best_acc_score: 0.8266; val_best_f1_score: 0.8355; train_kl_reg_loss: 160230.2766; train_edge_recon_loss: 2981544.0630; train_gene_expr_recon_loss: 35654802.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3714526.8111; train_global_loss: 42511103.7557; train_optim_loss: 42511103.7557; val_kl_reg_loss: 161558.2594; val_edge_recon_loss: 2953668.3000; val_gene_expr_recon_loss: 35976521.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3751796.1167; val_global_loss: 42843544.2667; val_optim_loss: 42843544.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9125; val_auprc_score: 0.9045; val_best_acc_score: 0.8294; val_best_f1_score: 0.8403; train_kl_reg_loss: 153639.0969; train_edge_recon_loss: 2963047.6317; train_gene_expr_recon_loss: 35452763.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3696473.9160; train_global_loss: 42265924.1832; train_optim_loss: 42265924.1832; val_kl_reg_loss: 149256.8604; val_edge_recon_loss: 2948154.0500; val_gene_expr_recon_loss: 35736034.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3713347.1000; val_global_loss: 42546792.5333; val_optim_loss: 42546792.5333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9221; val_auprc_score: 0.9100; val_best_acc_score: 0.8522; val_best_f1_score: 0.8621; train_kl_reg_loss: 147760.2860; train_edge_recon_loss: 2919796.5229; train_gene_expr_recon_loss: 35318873.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3688158.0668; train_global_loss: 42074588.3664; train_optim_loss: 42074588.3664; val_kl_reg_loss: 141337.1552; val_edge_recon_loss: 2909634.2167; val_gene_expr_recon_loss: 35460927.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3694450.5500; val_global_loss: 42206348.2667; val_optim_loss: 42206348.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9256; val_auprc_score: 0.9114; val_best_acc_score: 0.8527; val_best_f1_score: 0.8641; train_kl_reg_loss: 144607.2127; train_edge_recon_loss: 2884023.8550; train_gene_expr_recon_loss: 35199710.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3677421.2786; train_global_loss: 41905763.0840; train_optim_loss: 41905763.0840; val_kl_reg_loss: 146886.1906; val_edge_recon_loss: 2854967.3333; val_gene_expr_recon_loss: 35335185.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3685951.6500; val_global_loss: 42022990.6667; val_optim_loss: 42022990.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9294; val_auprc_score: 0.9164; val_best_acc_score: 0.8604; val_best_f1_score: 0.8686; train_kl_reg_loss: 145412.1466; train_edge_recon_loss: 2864457.8492; train_gene_expr_recon_loss: 35146714.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3672695.0286; train_global_loss: 41829279.2366; train_optim_loss: 41829279.2366; val_kl_reg_loss: 143295.6406; val_edge_recon_loss: 2853228.1167; val_gene_expr_recon_loss: 35392396.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3682589.7833; val_global_loss: 42071509.8667; val_optim_loss: 42071509.8667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9338; val_auprc_score: 0.9220; val_best_acc_score: 0.8685; val_best_f1_score: 0.8761; train_kl_reg_loss: 140303.2916; train_edge_recon_loss: 2848626.9447; train_gene_expr_recon_loss: 35017802.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3661970.3244; train_global_loss: 41668702.9618; train_optim_loss: 41668702.9618; val_kl_reg_loss: 137862.1240; val_edge_recon_loss: 2851614.9167; val_gene_expr_recon_loss: 35041039.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3643647.3167; val_global_loss: 41674163.4667; val_optim_loss: 41674163.4667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9377; val_auprc_score: 0.9246; val_best_acc_score: 0.8742; val_best_f1_score: 0.8811; train_kl_reg_loss: 137765.4687; train_edge_recon_loss: 2834432.4542; train_gene_expr_recon_loss: 34907645.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3654777.9905; train_global_loss: 41534621.2824; train_optim_loss: 41534621.2824; val_kl_reg_loss: 135256.0969; val_edge_recon_loss: 2828522.6500; val_gene_expr_recon_loss: 35155752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3667624.8500; val_global_loss: 41787155.2000; val_optim_loss: 41787155.2000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9426; val_auprc_score: 0.9294; val_best_acc_score: 0.8828; val_best_f1_score: 0.8890; train_kl_reg_loss: 135625.2519; train_edge_recon_loss: 2820296.5076; train_gene_expr_recon_loss: 34841948.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3647543.8340; train_global_loss: 41445414.4427; train_optim_loss: 41445414.4427; val_kl_reg_loss: 134654.6375; val_edge_recon_loss: 2818519.0000; val_gene_expr_recon_loss: 35077731.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3661700.3167; val_global_loss: 41692605.3333; val_optim_loss: 41692605.3333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9451; val_auprc_score: 0.9334; val_best_acc_score: 0.8809; val_best_f1_score: 0.8868; train_kl_reg_loss: 132284.7350; train_edge_recon_loss: 2815446.2615; train_gene_expr_recon_loss: 34800049.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3646627.6164; train_global_loss: 41394408.0000; train_optim_loss: 41394408.0000; val_kl_reg_loss: 131772.4146; val_edge_recon_loss: 2822319.5333; val_gene_expr_recon_loss: 35069780.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3667738.5500; val_global_loss: 41691610.6667; val_optim_loss: 41691610.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9469; val_auprc_score: 0.9310; val_best_acc_score: 0.8884; val_best_f1_score: 0.8935; train_kl_reg_loss: 131327.7514; train_edge_recon_loss: 2795560.9332; train_gene_expr_recon_loss: 34705573.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3638753.7118; train_global_loss: 41271215.6641; train_optim_loss: 41271215.6641; val_kl_reg_loss: 127184.6245; val_edge_recon_loss: 2797588.4833; val_gene_expr_recon_loss: 34958812.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3659938.5833; val_global_loss: 41543525.0667; val_optim_loss: 41543525.0667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9492; val_auprc_score: 0.9373; val_best_acc_score: 0.8843; val_best_f1_score: 0.8894; train_kl_reg_loss: 127520.9976; train_edge_recon_loss: 2790598.1469; train_gene_expr_recon_loss: 34636199.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3633572.3836; train_global_loss: 41187890.9008; train_optim_loss: 41187890.9008; val_kl_reg_loss: 123866.0620; val_edge_recon_loss: 2814580.2000; val_gene_expr_recon_loss: 34931973.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3655457.2667; val_global_loss: 41525876.2667; val_optim_loss: 41525876.2667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9555; val_auprc_score: 0.9450; val_best_acc_score: 0.8963; val_best_f1_score: 0.8996; train_kl_reg_loss: 123987.5104; train_edge_recon_loss: 2783872.3588; train_gene_expr_recon_loss: 34583161.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3632834.7405; train_global_loss: 41123856.5496; train_optim_loss: 41123856.5496; val_kl_reg_loss: 122768.9172; val_edge_recon_loss: 2771518.0833; val_gene_expr_recon_loss: 34963842.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3661497.8000; val_global_loss: 41519627.7333; val_optim_loss: 41519627.7333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9548; val_auprc_score: 0.9431; val_best_acc_score: 0.8942; val_best_f1_score: 0.8983; train_kl_reg_loss: 121787.7877; train_edge_recon_loss: 2767411.9695; train_gene_expr_recon_loss: 34530551.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3628722.7424; train_global_loss: 41048473.9237; train_optim_loss: 41048473.9237; val_kl_reg_loss: 119874.5906; val_edge_recon_loss: 2787602.6667; val_gene_expr_recon_loss: 34847241.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3656121.5500; val_global_loss: 41410839.4667; val_optim_loss: 41410839.4667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9576; val_auprc_score: 0.9470; val_best_acc_score: 0.9020; val_best_f1_score: 0.9063; train_kl_reg_loss: 119103.9719; train_edge_recon_loss: 2761724.7214; train_gene_expr_recon_loss: 34469263.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3623237.1813; train_global_loss: 40973329.8015; train_optim_loss: 40973329.8015; val_kl_reg_loss: 116408.9714; val_edge_recon_loss: 2763029.2667; val_gene_expr_recon_loss: 34731564.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3637176.5000; val_global_loss: 41248179.2000; val_optim_loss: 41248179.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9555; val_auprc_score: 0.9454; val_best_acc_score: 0.8899; val_best_f1_score: 0.8938; train_kl_reg_loss: 115709.8138; train_edge_recon_loss: 2763722.0420; train_gene_expr_recon_loss: 34405685.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3619373.5477; train_global_loss: 40904490.7786; train_optim_loss: 40904490.7786; val_kl_reg_loss: 116069.5448; val_edge_recon_loss: 2771210.4667; val_gene_expr_recon_loss: 34690198.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3625600.9333; val_global_loss: 41203079.4667; val_optim_loss: 41203079.4667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9617; val_auprc_score: 0.9533; val_best_acc_score: 0.8985; val_best_f1_score: 0.9029; train_kl_reg_loss: 115186.3033; train_edge_recon_loss: 2758143.4370; train_gene_expr_recon_loss: 34385172.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3620298.5992; train_global_loss: 40878801.2519; train_optim_loss: 40878801.2519; val_kl_reg_loss: 111806.9187; val_edge_recon_loss: 2751665.1500; val_gene_expr_recon_loss: 34599166.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3625449.7000; val_global_loss: 41088088.0000; val_optim_loss: 41088088.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9593; val_auprc_score: 0.9514; val_best_acc_score: 0.8996; val_best_f1_score: 0.9039; train_kl_reg_loss: 111855.6892; train_edge_recon_loss: 2757479.7080; train_gene_expr_recon_loss: 34360102.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3619854.0363; train_global_loss: 40849292.3969; train_optim_loss: 40849292.3969; val_kl_reg_loss: 112738.1073; val_edge_recon_loss: 2763802.5833; val_gene_expr_recon_loss: 34616103.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3628884.0167; val_global_loss: 41121527.4667; val_optim_loss: 41121527.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9665; val_auprc_score: 0.9614; val_best_acc_score: 0.9064; val_best_f1_score: 0.9077; train_kl_reg_loss: 110395.4847; train_edge_recon_loss: 2742405.1603; train_gene_expr_recon_loss: 34284222.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3614257.2977; train_global_loss: 40751280.3664; train_optim_loss: 40751280.3664; val_kl_reg_loss: 109125.9651; val_edge_recon_loss: 2754682.6500; val_gene_expr_recon_loss: 34738126.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3633344.2500; val_global_loss: 41235278.6667; val_optim_loss: 41235278.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9607; val_auprc_score: 0.9530; val_best_acc_score: 0.9026; val_best_f1_score: 0.9059; train_kl_reg_loss: 130077.1256; train_edge_recon_loss: 2905299.6336; train_gene_expr_recon_loss: 37705933.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3784353.8168; train_global_loss: 44525664.1527; train_optim_loss: 44525664.1527; val_kl_reg_loss: 29709.2250; val_edge_recon_loss: 2864749.5333; val_gene_expr_recon_loss: 37583898.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3773109.4833; val_global_loss: 44251466.6667; val_optim_loss: 44251466.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9504; val_auprc_score: 0.9355; val_best_acc_score: 0.8901; val_best_f1_score: 0.8963; train_kl_reg_loss: 130607.1006; train_edge_recon_loss: 2855814.6317; train_gene_expr_recon_loss: 37485260.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3754141.4332; train_global_loss: 44225823.6947; train_optim_loss: 44225823.6947; val_kl_reg_loss: 21996.8195; val_edge_recon_loss: 2926593.0333; val_gene_expr_recon_loss: 38949222.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3791470.6000; val_global_loss: 45689283.2000; val_optim_loss: 45689283.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9533; val_auprc_score: 0.9419; val_best_acc_score: 0.8975; val_best_f1_score: 0.9002; train_kl_reg_loss: 131404.7773; train_edge_recon_loss: 2892358.0706; train_gene_expr_recon_loss: 38857536.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3769735.4981; train_global_loss: 45651034.9008; train_optim_loss: 45651034.9008; val_kl_reg_loss: 22155.9283; val_edge_recon_loss: 2880837.1500; val_gene_expr_recon_loss: 39217520.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3788294.3833; val_global_loss: 45908808.2667; val_optim_loss: 45908808.2667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9504; val_auprc_score: 0.9391; val_best_acc_score: 0.8921; val_best_f1_score: 0.8977; train_kl_reg_loss: 129268.5812; train_edge_recon_loss: 2870668.6947; train_gene_expr_recon_loss: 38926417.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3769191.6737; train_global_loss: 45695546.1985; train_optim_loss: 45695546.1985; val_kl_reg_loss: 23440.1659; val_edge_recon_loss: 2866553.9500; val_gene_expr_recon_loss: 39226970.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3772019.3333; val_global_loss: 45888984.0000; val_optim_loss: 45888984.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9515; val_auprc_score: 0.9410; val_best_acc_score: 0.8945; val_best_f1_score: 0.8985; train_kl_reg_loss: 125962.0337; train_edge_recon_loss: 2865592.9351; train_gene_expr_recon_loss: 39072103.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3774182.8168; train_global_loss: 45837841.4351; train_optim_loss: 45837841.4351; val_kl_reg_loss: 24647.6083; val_edge_recon_loss: 2848453.5667; val_gene_expr_recon_loss: 39481348.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3796321.5833; val_global_loss: 46150771.7333; val_optim_loss: 46150771.7333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9533; val_auprc_score: 0.9439; val_best_acc_score: 0.8948; val_best_f1_score: 0.8997; train_kl_reg_loss: 122691.0796; train_edge_recon_loss: 2848203.3511; train_gene_expr_recon_loss: 39073636.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3772260.2156; train_global_loss: 45816791.0229; train_optim_loss: 45816791.0229; val_kl_reg_loss: 24333.2892; val_edge_recon_loss: 2852924.0000; val_gene_expr_recon_loss: 39531041.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3807478.3667; val_global_loss: 46215777.3333; val_optim_loss: 46215777.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 35 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9591
val AUPRC score: 0.9492
val best accuracy score: 0.9025
val best F1 score: 0.9062
val target rna MSE score: 2.0407
val source rna MSE score: 45.1366
val target atac MSE score: 0.6135
val source atac MSE score: 6.6756
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
