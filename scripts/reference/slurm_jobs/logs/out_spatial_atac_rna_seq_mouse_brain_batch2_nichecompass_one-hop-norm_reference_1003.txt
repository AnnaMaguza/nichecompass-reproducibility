[True]
Run timestamp: 10082023_132821_1003.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1003']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7727; val_auprc_score: 0.7890; val_best_acc_score: 0.5275; val_best_f1_score: 0.6781; train_kl_reg_loss: 108194.2197; train_edge_recon_loss: 3580529.5592; train_gene_expr_recon_loss: 14518293.7710; train_masked_gp_l1_reg_loss: 73227.8647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 230966.5590; train_chrom_access_recon_loss: 732285.5386; train_global_loss: 19243497.3511; train_optim_loss: 19243497.3511; val_kl_reg_loss: 172659.3271; val_edge_recon_loss: 4063496.7500; val_gene_expr_recon_loss: 12926737.4667; val_masked_gp_l1_reg_loss: 66759.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 210877.0938; val_chrom_access_recon_loss: 689701.6708; val_global_loss: 18130232.9333; val_optim_loss: 18130232.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8408; val_auprc_score: 0.8477; val_best_acc_score: 0.7544; val_best_f1_score: 0.7598; train_kl_reg_loss: 125083.8680; train_edge_recon_loss: 3535601.3168; train_gene_expr_recon_loss: 12655264.1374; train_masked_gp_l1_reg_loss: 65519.8687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 191451.1264; train_chrom_access_recon_loss: 686127.3793; train_global_loss: 17259047.6641; train_optim_loss: 17259047.6641; val_kl_reg_loss: 121688.2198; val_edge_recon_loss: 4014445.4167; val_gene_expr_recon_loss: 12626161.4667; val_masked_gp_l1_reg_loss: 66646.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172806.5156; val_chrom_access_recon_loss: 679795.1875; val_global_loss: 17681543.0000; val_optim_loss: 17681543.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8308; val_auprc_score: 0.8399; val_best_acc_score: 0.7390; val_best_f1_score: 0.7537; train_kl_reg_loss: 104803.7685; train_edge_recon_loss: 3365396.4561; train_gene_expr_recon_loss: 12455712.5573; train_masked_gp_l1_reg_loss: 69609.5368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156995.1580; train_chrom_access_recon_loss: 677371.9528; train_global_loss: 16829889.4962; train_optim_loss: 16829889.4962; val_kl_reg_loss: 127027.0182; val_edge_recon_loss: 3159230.6167; val_gene_expr_recon_loss: 12530644.2667; val_masked_gp_l1_reg_loss: 72916.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142411.1719; val_chrom_access_recon_loss: 674398.9875; val_global_loss: 16706627.8000; val_optim_loss: 16706627.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9067; val_auprc_score: 0.8990; val_best_acc_score: 0.8242; val_best_f1_score: 0.8312; train_kl_reg_loss: 123611.3166; train_edge_recon_loss: 3036551.7004; train_gene_expr_recon_loss: 12317226.3893; train_masked_gp_l1_reg_loss: 75561.6634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131178.2193; train_chrom_access_recon_loss: 671871.1422; train_global_loss: 16356000.6336; train_optim_loss: 16356000.6336; val_kl_reg_loss: 119431.6141; val_edge_recon_loss: 2938373.7000; val_gene_expr_recon_loss: 12388883.8000; val_masked_gp_l1_reg_loss: 77932.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120928.8672; val_chrom_access_recon_loss: 668774.2083; val_global_loss: 16314324.7333; val_optim_loss: 16314324.7333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9287; val_auprc_score: 0.9113; val_best_acc_score: 0.8636; val_best_f1_score: 0.8718; train_kl_reg_loss: 123800.4668; train_edge_recon_loss: 2876996.3607; train_gene_expr_recon_loss: 12170901.4580; train_masked_gp_l1_reg_loss: 80519.2031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111803.3279; train_chrom_access_recon_loss: 665245.2576; train_global_loss: 16029266.1145; train_optim_loss: 16029266.1145; val_kl_reg_loss: 125360.1354; val_edge_recon_loss: 2846056.2167; val_gene_expr_recon_loss: 12221706.4667; val_masked_gp_l1_reg_loss: 82575.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103093.7500; val_chrom_access_recon_loss: 660563.6375; val_global_loss: 16039356.5333; val_optim_loss: 16039356.5333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9318; val_auprc_score: 0.9179; val_best_acc_score: 0.8667; val_best_f1_score: 0.8759; train_kl_reg_loss: 125430.4298; train_edge_recon_loss: 2832794.4981; train_gene_expr_recon_loss: 12048685.0153; train_masked_gp_l1_reg_loss: 84285.2579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95922.5522; train_chrom_access_recon_loss: 658923.4423; train_global_loss: 15846041.1756; train_optim_loss: 15846041.1756; val_kl_reg_loss: 120051.3635; val_edge_recon_loss: 2833383.8500; val_gene_expr_recon_loss: 12118739.0667; val_masked_gp_l1_reg_loss: 85886.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89032.4844; val_chrom_access_recon_loss: 659838.1875; val_global_loss: 15906930.4000; val_optim_loss: 15906930.4000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9335; val_auprc_score: 0.9197; val_best_acc_score: 0.8684; val_best_f1_score: 0.8765; train_kl_reg_loss: 116342.5490; train_edge_recon_loss: 2819897.5305; train_gene_expr_recon_loss: 11927762.0305; train_masked_gp_l1_reg_loss: 87464.2969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83270.6209; train_chrom_access_recon_loss: 652839.1498; train_global_loss: 15687576.1527; train_optim_loss: 15687576.1527; val_kl_reg_loss: 115244.2698; val_edge_recon_loss: 2820722.4500; val_gene_expr_recon_loss: 11959113.1333; val_masked_gp_l1_reg_loss: 88927.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77696.3906; val_chrom_access_recon_loss: 649923.6333; val_global_loss: 15711627.6000; val_optim_loss: 15711627.6000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9449; val_auprc_score: 0.9334; val_best_acc_score: 0.8835; val_best_f1_score: 0.8899; train_kl_reg_loss: 111796.1637; train_edge_recon_loss: 2812693.2519; train_gene_expr_recon_loss: 11855188.6718; train_masked_gp_l1_reg_loss: 90345.7578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72988.9953; train_chrom_access_recon_loss: 648908.6942; train_global_loss: 15591921.4427; train_optim_loss: 15591921.4427; val_kl_reg_loss: 109349.9224; val_edge_recon_loss: 2803689.4667; val_gene_expr_recon_loss: 11916280.8667; val_masked_gp_l1_reg_loss: 91779.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68485.0469; val_chrom_access_recon_loss: 647633.8750; val_global_loss: 15637218.2000; val_optim_loss: 15637218.2000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9406; val_auprc_score: 0.9238; val_best_acc_score: 0.8826; val_best_f1_score: 0.8864; train_kl_reg_loss: 107882.7045; train_edge_recon_loss: 2807184.7595; train_gene_expr_recon_loss: 11771647.2901; train_masked_gp_l1_reg_loss: 92929.7212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64594.5432; train_chrom_access_recon_loss: 645013.1908; train_global_loss: 15489252.2672; train_optim_loss: 15489252.2672; val_kl_reg_loss: 105629.8391; val_edge_recon_loss: 2831387.2667; val_gene_expr_recon_loss: 11843847.6667; val_masked_gp_l1_reg_loss: 94266.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60952.7539; val_chrom_access_recon_loss: 642816.8833; val_global_loss: 15578900.8000; val_optim_loss: 15578900.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9397; val_auprc_score: 0.9227; val_best_acc_score: 0.8814; val_best_f1_score: 0.8868; train_kl_reg_loss: 105600.7387; train_edge_recon_loss: 2786953.8683; train_gene_expr_recon_loss: 11700455.8168; train_masked_gp_l1_reg_loss: 95339.8071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57777.9613; train_chrom_access_recon_loss: 640800.7739; train_global_loss: 15386928.9313; train_optim_loss: 15386928.9313; val_kl_reg_loss: 103398.1406; val_edge_recon_loss: 2808572.4000; val_gene_expr_recon_loss: 11778376.6000; val_masked_gp_l1_reg_loss: 96603.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54899.2852; val_chrom_access_recon_loss: 641236.9792; val_global_loss: 15483086.4000; val_optim_loss: 15483086.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9449; val_auprc_score: 0.9291; val_best_acc_score: 0.8909; val_best_f1_score: 0.8974; train_kl_reg_loss: 101994.4629; train_edge_recon_loss: 2781887.5305; train_gene_expr_recon_loss: 11636544.4427; train_masked_gp_l1_reg_loss: 97504.7149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52229.3482; train_chrom_access_recon_loss: 637763.0940; train_global_loss: 15307923.6489; train_optim_loss: 15307923.6489; val_kl_reg_loss: 97415.6354; val_edge_recon_loss: 2785928.6333; val_gene_expr_recon_loss: 11669027.0667; val_masked_gp_l1_reg_loss: 98543.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49742.9688; val_chrom_access_recon_loss: 633886.9542; val_global_loss: 15334545.1333; val_optim_loss: 15334545.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9453; val_auprc_score: 0.9304; val_best_acc_score: 0.8872; val_best_f1_score: 0.8927; train_kl_reg_loss: 100694.0087; train_edge_recon_loss: 2772589.9695; train_gene_expr_recon_loss: 11581178.1756; train_masked_gp_l1_reg_loss: 99543.8237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47630.0884; train_chrom_access_recon_loss: 634868.1698; train_global_loss: 15236504.2977; train_optim_loss: 15236504.2977; val_kl_reg_loss: 104485.9969; val_edge_recon_loss: 2782216.6000; val_gene_expr_recon_loss: 11635869.0000; val_masked_gp_l1_reg_loss: 100566.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45584.9922; val_chrom_access_recon_loss: 634163.3458; val_global_loss: 15302886.0000; val_optim_loss: 15302886.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9520; val_auprc_score: 0.9373; val_best_acc_score: 0.8972; val_best_f1_score: 0.9034; train_kl_reg_loss: 98774.4976; train_edge_recon_loss: 2760988.4485; train_gene_expr_recon_loss: 11525233.1298; train_masked_gp_l1_reg_loss: 101180.6196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43853.3632; train_chrom_access_recon_loss: 632034.6994; train_global_loss: 15162064.7176; train_optim_loss: 15162064.7176; val_kl_reg_loss: 95834.8875; val_edge_recon_loss: 2746385.8167; val_gene_expr_recon_loss: 11585804.4000; val_masked_gp_l1_reg_loss: 101807.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42183.4062; val_chrom_access_recon_loss: 627620.4125; val_global_loss: 15199636.4000; val_optim_loss: 15199636.4000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9546; val_auprc_score: 0.9388; val_best_acc_score: 0.8961; val_best_f1_score: 0.9009; train_kl_reg_loss: 97270.8696; train_edge_recon_loss: 2756739.4733; train_gene_expr_recon_loss: 11473192.2061; train_masked_gp_l1_reg_loss: 102739.4745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40504.4531; train_chrom_access_recon_loss: 629135.4442; train_global_loss: 15099581.8931; train_optim_loss: 15099581.8931; val_kl_reg_loss: 94205.6083; val_edge_recon_loss: 2756423.7500; val_gene_expr_recon_loss: 11552206.5333; val_masked_gp_l1_reg_loss: 103693.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39017.1758; val_chrom_access_recon_loss: 627518.5042; val_global_loss: 15173065.5333; val_optim_loss: 15173065.5333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9589; val_auprc_score: 0.9471; val_best_acc_score: 0.9051; val_best_f1_score: 0.9091; train_kl_reg_loss: 95465.6965; train_edge_recon_loss: 2744201.8111; train_gene_expr_recon_loss: 11434998.7023; train_masked_gp_l1_reg_loss: 104515.2897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37609.9094; train_chrom_access_recon_loss: 627162.1570; train_global_loss: 15043953.6031; train_optim_loss: 15043953.6031; val_kl_reg_loss: 93060.1250; val_edge_recon_loss: 2766722.1333; val_gene_expr_recon_loss: 11503348.6667; val_masked_gp_l1_reg_loss: 105515.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36355.3789; val_chrom_access_recon_loss: 622866.1417; val_global_loss: 15127867.0667; val_optim_loss: 15127867.0667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9590; val_auprc_score: 0.9476; val_best_acc_score: 0.9051; val_best_f1_score: 0.9082; train_kl_reg_loss: 94751.5462; train_edge_recon_loss: 2733422.1679; train_gene_expr_recon_loss: 11396974.0687; train_masked_gp_l1_reg_loss: 106211.9229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35133.1722; train_chrom_access_recon_loss: 624944.6183; train_global_loss: 14991437.4885; train_optim_loss: 14991437.4885; val_kl_reg_loss: 92049.3984; val_edge_recon_loss: 2746562.4000; val_gene_expr_recon_loss: 11438052.8000; val_masked_gp_l1_reg_loss: 107279.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34012.0547; val_chrom_access_recon_loss: 623909.6542; val_global_loss: 15041865.2667; val_optim_loss: 15041865.2667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9626; val_auprc_score: 0.9506; val_best_acc_score: 0.9103; val_best_f1_score: 0.9140; train_kl_reg_loss: 93490.8145; train_edge_recon_loss: 2727603.4523; train_gene_expr_recon_loss: 11359556.5878; train_masked_gp_l1_reg_loss: 107803.6274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32983.5050; train_chrom_access_recon_loss: 623314.8135; train_global_loss: 14944752.8702; train_optim_loss: 14944752.8702; val_kl_reg_loss: 94279.6589; val_edge_recon_loss: 2740751.2667; val_gene_expr_recon_loss: 11413739.2667; val_masked_gp_l1_reg_loss: 108685.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31965.6895; val_chrom_access_recon_loss: 621020.2917; val_global_loss: 15010441.4000; val_optim_loss: 15010441.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9681; val_auprc_score: 0.9557; val_best_acc_score: 0.9193; val_best_f1_score: 0.9208; train_kl_reg_loss: 93234.3226; train_edge_recon_loss: 2720963.0344; train_gene_expr_recon_loss: 11321663.6031; train_masked_gp_l1_reg_loss: 109319.8817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31068.1335; train_chrom_access_recon_loss: 621842.0253; train_global_loss: 14898090.9389; train_optim_loss: 14898090.9389; val_kl_reg_loss: 90508.1755; val_edge_recon_loss: 2721039.7833; val_gene_expr_recon_loss: 11370324.0667; val_masked_gp_l1_reg_loss: 109930.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30135.3340; val_chrom_access_recon_loss: 617946.5500; val_global_loss: 14939884.6000; val_optim_loss: 14939884.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9649; val_auprc_score: 0.9518; val_best_acc_score: 0.9185; val_best_f1_score: 0.9218; train_kl_reg_loss: 92649.0027; train_edge_recon_loss: 2715430.9523; train_gene_expr_recon_loss: 11290055.9695; train_masked_gp_l1_reg_loss: 110578.8022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29380.8795; train_chrom_access_recon_loss: 619605.4742; train_global_loss: 14857701.0687; train_optim_loss: 14857701.0687; val_kl_reg_loss: 95163.4047; val_edge_recon_loss: 2729115.8000; val_gene_expr_recon_loss: 11349665.4000; val_masked_gp_l1_reg_loss: 111237.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28654.0098; val_chrom_access_recon_loss: 617793.6000; val_global_loss: 14931629.8000; val_optim_loss: 14931629.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9692; val_auprc_score: 0.9560; val_best_acc_score: 0.9210; val_best_f1_score: 0.9242; train_kl_reg_loss: 91644.6484; train_edge_recon_loss: 2714911.5573; train_gene_expr_recon_loss: 11256993.0687; train_masked_gp_l1_reg_loss: 111827.9744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28003.2152; train_chrom_access_recon_loss: 618244.6636; train_global_loss: 14821625.0534; train_optim_loss: 14821625.0534; val_kl_reg_loss: 91697.3927; val_edge_recon_loss: 2732948.8500; val_gene_expr_recon_loss: 11366354.8667; val_masked_gp_l1_reg_loss: 112498.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27319.4219; val_chrom_access_recon_loss: 618195.2542; val_global_loss: 14949014.3333; val_optim_loss: 14949014.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9691; val_auprc_score: 0.9591; val_best_acc_score: 0.9220; val_best_f1_score: 0.9251; train_kl_reg_loss: 90023.3931; train_edge_recon_loss: 2712371.0363; train_gene_expr_recon_loss: 11233787.7405; train_masked_gp_l1_reg_loss: 113154.6184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26798.8208; train_chrom_access_recon_loss: 617132.6904; train_global_loss: 14793268.3130; train_optim_loss: 14793268.3130; val_kl_reg_loss: 90824.6792; val_edge_recon_loss: 2713831.8667; val_gene_expr_recon_loss: 11328282.5333; val_masked_gp_l1_reg_loss: 113588.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26167.8105; val_chrom_access_recon_loss: 616994.0083; val_global_loss: 14889690.0667; val_optim_loss: 14889690.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9699; val_auprc_score: 0.9600; val_best_acc_score: 0.9197; val_best_f1_score: 0.9221; train_kl_reg_loss: 89124.3142; train_edge_recon_loss: 2708510.7634; train_gene_expr_recon_loss: 11204706.4809; train_masked_gp_l1_reg_loss: 114225.2109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25701.1711; train_chrom_access_recon_loss: 615745.5048; train_global_loss: 14758013.3664; train_optim_loss: 14758013.3664; val_kl_reg_loss: 90748.1167; val_edge_recon_loss: 2721842.6667; val_gene_expr_recon_loss: 11264861.2000; val_masked_gp_l1_reg_loss: 114742.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25240.8125; val_chrom_access_recon_loss: 612437.2625; val_global_loss: 14829873.1333; val_optim_loss: 14829873.1333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9714; val_auprc_score: 0.9644; val_best_acc_score: 0.9217; val_best_f1_score: 0.9243; train_kl_reg_loss: 89784.2134; train_edge_recon_loss: 2700366.0210; train_gene_expr_recon_loss: 11184831.2214; train_masked_gp_l1_reg_loss: 115271.7526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24853.3777; train_chrom_access_recon_loss: 615285.4117; train_global_loss: 14730391.9847; train_optim_loss: 14730391.9847; val_kl_reg_loss: 88829.8057; val_edge_recon_loss: 2715294.4833; val_gene_expr_recon_loss: 11276103.2000; val_masked_gp_l1_reg_loss: 115946.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24518.7832; val_chrom_access_recon_loss: 613137.4000; val_global_loss: 14833830.9333; val_optim_loss: 14833830.9333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9725; val_auprc_score: 0.9628; val_best_acc_score: 0.9267; val_best_f1_score: 0.9290; train_kl_reg_loss: 88765.0394; train_edge_recon_loss: 2697577.4695; train_gene_expr_recon_loss: 11168578.3053; train_masked_gp_l1_reg_loss: 116348.9318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24084.3964; train_chrom_access_recon_loss: 614482.1503; train_global_loss: 14709836.2595; train_optim_loss: 14709836.2595; val_kl_reg_loss: 89830.8016; val_edge_recon_loss: 2706847.7500; val_gene_expr_recon_loss: 11268740.6667; val_masked_gp_l1_reg_loss: 116841.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23772.6602; val_chrom_access_recon_loss: 614176.8625; val_global_loss: 14820211.1333; val_optim_loss: 14820211.1333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9743; val_auprc_score: 0.9667; val_best_acc_score: 0.9325; val_best_f1_score: 0.9342; train_kl_reg_loss: 87279.8033; train_edge_recon_loss: 2698041.2405; train_gene_expr_recon_loss: 11144514.2290; train_masked_gp_l1_reg_loss: 117284.7257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23473.2362; train_chrom_access_recon_loss: 613170.8531; train_global_loss: 14683764.0382; train_optim_loss: 14683764.0382; val_kl_reg_loss: 87609.5688; val_edge_recon_loss: 2690350.7333; val_gene_expr_recon_loss: 11234838.5333; val_masked_gp_l1_reg_loss: 117802.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23164.1113; val_chrom_access_recon_loss: 610764.0000; val_global_loss: 14764529.7333; val_optim_loss: 14764529.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9715; val_auprc_score: 0.9629; val_best_acc_score: 0.9205; val_best_f1_score: 0.9235; train_kl_reg_loss: 100863.9297; train_edge_recon_loss: 2758541.4828; train_gene_expr_recon_loss: 11597879.2290; train_masked_gp_l1_reg_loss: 118182.9372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21252.8754; train_chrom_access_recon_loss: 633484.4241; train_global_loss: 15230204.9237; train_optim_loss: 15230204.9237; val_kl_reg_loss: 40640.3846; val_edge_recon_loss: 2738831.8667; val_gene_expr_recon_loss: 11695304.3333; val_masked_gp_l1_reg_loss: 118531.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20054.1074; val_chrom_access_recon_loss: 632506.7417; val_global_loss: 15245869.2667; val_optim_loss: 15245869.2667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9664; val_auprc_score: 0.9541; val_best_acc_score: 0.9173; val_best_f1_score: 0.9204; train_kl_reg_loss: 80806.7916; train_edge_recon_loss: 2715546.1508; train_gene_expr_recon_loss: 11506772.8473; train_masked_gp_l1_reg_loss: 118280.7270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19386.6382; train_chrom_access_recon_loss: 630615.8144; train_global_loss: 15071408.9542; train_optim_loss: 15071408.9542; val_kl_reg_loss: 48090.1880; val_edge_recon_loss: 2738665.0000; val_gene_expr_recon_loss: 11621472.2000; val_masked_gp_l1_reg_loss: 117861.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18906.6523; val_chrom_access_recon_loss: 627667.0042; val_global_loss: 15172663.4000; val_optim_loss: 15172663.4000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9718; val_auprc_score: 0.9617; val_best_acc_score: 0.9285; val_best_f1_score: 0.9307; train_kl_reg_loss: 71763.9336; train_edge_recon_loss: 2698153.4790; train_gene_expr_recon_loss: 11486985.3130; train_masked_gp_l1_reg_loss: 117234.6471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18611.4934; train_chrom_access_recon_loss: 629719.9299; train_global_loss: 15022468.8550; train_optim_loss: 15022468.8550; val_kl_reg_loss: 52319.3573; val_edge_recon_loss: 2698662.5500; val_gene_expr_recon_loss: 11555352.4000; val_masked_gp_l1_reg_loss: 116547.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18437.6914; val_chrom_access_recon_loss: 626206.9708; val_global_loss: 15067526.4667; val_optim_loss: 15067526.4667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9759; val_auprc_score: 0.9688; val_best_acc_score: 0.9328; val_best_f1_score: 0.9345; train_kl_reg_loss: 68422.5360; train_edge_recon_loss: 2693432.0248; train_gene_expr_recon_loss: 11454761.4885; train_masked_gp_l1_reg_loss: 115784.0792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18257.0493; train_chrom_access_recon_loss: 628477.0048; train_global_loss: 14979134.0916; train_optim_loss: 14979134.0916; val_kl_reg_loss: 53178.9891; val_edge_recon_loss: 2677241.0833; val_gene_expr_recon_loss: 11545156.5333; val_masked_gp_l1_reg_loss: 115031.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18190.6504; val_chrom_access_recon_loss: 627935.1292; val_global_loss: 15036733.8667; val_optim_loss: 15036733.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9745; val_auprc_score: 0.9661; val_best_acc_score: 0.9338; val_best_f1_score: 0.9355; train_kl_reg_loss: 67379.5927; train_edge_recon_loss: 2687529.4389; train_gene_expr_recon_loss: 11432481.0840; train_masked_gp_l1_reg_loss: 114407.3213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18057.8436; train_chrom_access_recon_loss: 628713.4962; train_global_loss: 14948568.8015; train_optim_loss: 14948568.8015; val_kl_reg_loss: 55144.6659; val_edge_recon_loss: 2685734.5333; val_gene_expr_recon_loss: 11572953.1333; val_masked_gp_l1_reg_loss: 114190.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17996.7734; val_chrom_access_recon_loss: 628007.8958; val_global_loss: 15074028.1333; val_optim_loss: 15074028.1333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9700; val_auprc_score: 0.9590; val_best_acc_score: 0.9264; val_best_f1_score: 0.9287; train_kl_reg_loss: 67356.9666; train_edge_recon_loss: 2690819.2252; train_gene_expr_recon_loss: 11423111.7481; train_masked_gp_l1_reg_loss: 114068.7121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17970.4274; train_chrom_access_recon_loss: 627901.2562; train_global_loss: 14941228.2748; train_optim_loss: 14941228.2748; val_kl_reg_loss: 55466.9820; val_edge_recon_loss: 2710034.9833; val_gene_expr_recon_loss: 11541433.4000; val_masked_gp_l1_reg_loss: 113956.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17946.4727; val_chrom_access_recon_loss: 626871.7958; val_global_loss: 15065710.2667; val_optim_loss: 15065710.2667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9739; val_auprc_score: 0.9639; val_best_acc_score: 0.9325; val_best_f1_score: 0.9344; train_kl_reg_loss: 67721.7244; train_edge_recon_loss: 2681841.6927; train_gene_expr_recon_loss: 11421821.5191; train_masked_gp_l1_reg_loss: 113844.3678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17918.1464; train_chrom_access_recon_loss: 628125.6231; train_global_loss: 14931273.0000; train_optim_loss: 14931273.0000; val_kl_reg_loss: 56507.5128; val_edge_recon_loss: 2689695.8000; val_gene_expr_recon_loss: 11543408.8000; val_masked_gp_l1_reg_loss: 113740.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17893.0332; val_chrom_access_recon_loss: 626184.8542; val_global_loss: 15047430.0000; val_optim_loss: 15047430.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9757; val_auprc_score: 0.9655; val_best_acc_score: 0.9305; val_best_f1_score: 0.9328; train_kl_reg_loss: 67400.0229; train_edge_recon_loss: 2683435.8874; train_gene_expr_recon_loss: 11418397.7634; train_masked_gp_l1_reg_loss: 113627.1750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17868.3371; train_chrom_access_recon_loss: 627519.0525; train_global_loss: 14928248.3130; train_optim_loss: 14928248.3130; val_kl_reg_loss: 57060.4982; val_edge_recon_loss: 2678204.1500; val_gene_expr_recon_loss: 11521461.6667; val_masked_gp_l1_reg_loss: 113526.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17842.3223; val_chrom_access_recon_loss: 624771.9833; val_global_loss: 15012867.2667; val_optim_loss: 15012867.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 44 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9741
val AUPRC score: 0.9650
val best accuracy score: 0.9330
val best F1 score: 0.9359
val target rna MSE score: 4.1601
val source rna MSE score: 10.4774
val target atac MSE score: 0.5715
val source atac MSE score: 11.0519
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
