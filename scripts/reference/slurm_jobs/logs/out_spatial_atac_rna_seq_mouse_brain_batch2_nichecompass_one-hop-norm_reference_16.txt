[True]
Run timestamp: 07082023_173207_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9173; val_auprc_score: 0.9233; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 81951.5574; train_edge_recon_loss: 36487.1489; train_gene_expr_recon_loss: 664106.9375; train_masked_gp_l1_reg_loss: 16800.9916; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 809626.7083; train_global_loss: 1608973.3472; train_optim_loss: 1608973.3472; val_kl_reg_loss: 25746.5000; val_edge_recon_loss: 40661.6289; val_gene_expr_recon_loss: 573331.8750; val_masked_gp_l1_reg_loss: 13624.5195; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 788484.1250; val_global_loss: 1441848.6250; val_optim_loss: 1441848.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9137; val_auprc_score: 0.9197; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 33220.1406; train_edge_recon_loss: 39565.7591; train_gene_expr_recon_loss: 550313.0868; train_masked_gp_l1_reg_loss: 12543.1041; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 776201.4653; train_global_loss: 1411843.5556; train_optim_loss: 1411843.5556; val_kl_reg_loss: 36302.4062; val_edge_recon_loss: 40661.8047; val_gene_expr_recon_loss: 528515.6250; val_masked_gp_l1_reg_loss: 11592.3555; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 771221.5625; val_global_loss: 1388293.7500; val_optim_loss: 1388293.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9106; val_auprc_score: 0.9167; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 33443.3329; train_edge_recon_loss: 39531.9488; train_gene_expr_recon_loss: 519375.3333; train_masked_gp_l1_reg_loss: 11379.8799; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 758783.7153; train_global_loss: 1362514.2083; train_optim_loss: 1362514.2083; val_kl_reg_loss: 30953.5508; val_edge_recon_loss: 40660.2031; val_gene_expr_recon_loss: 501314.5625; val_masked_gp_l1_reg_loss: 11132.2021; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 761223.0000; val_global_loss: 1345283.5000; val_optim_loss: 1345283.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9054; val_auprc_score: 0.9082; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 31999.1484; train_edge_recon_loss: 39433.9714; train_gene_expr_recon_loss: 488780.1979; train_masked_gp_l1_reg_loss: 10848.7113; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 749732.3472; train_global_loss: 1320794.3750; train_optim_loss: 1320794.3750; val_kl_reg_loss: 32384.0469; val_edge_recon_loss: 40657.4805; val_gene_expr_recon_loss: 480652.5312; val_masked_gp_l1_reg_loss: 10496.0928; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 753430.3750; val_global_loss: 1317620.5000; val_optim_loss: 1317620.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8881; val_auprc_score: 0.8864; val_best_acc_score: 0.5071; val_best_f1_score: 0.6699; train_kl_reg_loss: 31402.1556; train_edge_recon_loss: 39381.2812; train_gene_expr_recon_loss: 475140.4549; train_masked_gp_l1_reg_loss: 10207.8610; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 743005.3889; train_global_loss: 1299137.1389; train_optim_loss: 1299137.1389; val_kl_reg_loss: 32397.0391; val_edge_recon_loss: 40649.8320; val_gene_expr_recon_loss: 469029.0000; val_masked_gp_l1_reg_loss: 9841.4238; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 746375.6250; val_global_loss: 1298293.0000; val_optim_loss: 1298293.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8634; val_auprc_score: 0.8592; val_best_acc_score: 0.5663; val_best_f1_score: 0.6964; train_kl_reg_loss: 32085.5078; train_edge_recon_loss: 39344.6510; train_gene_expr_recon_loss: 464119.2188; train_masked_gp_l1_reg_loss: 9588.4784; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 735693.7431; train_global_loss: 1280831.6250; train_optim_loss: 1280831.6250; val_kl_reg_loss: 32941.8203; val_edge_recon_loss: 40618.0898; val_gene_expr_recon_loss: 458239.4688; val_masked_gp_l1_reg_loss: 9304.2998; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 739352.1250; val_global_loss: 1280455.7500; val_optim_loss: 1280455.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8452; val_auprc_score: 0.8343; val_best_acc_score: 0.6517; val_best_f1_score: 0.7363; train_kl_reg_loss: 32904.1372; train_edge_recon_loss: 39315.9388; train_gene_expr_recon_loss: 457404.8889; train_masked_gp_l1_reg_loss: 9119.4195; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 733632.4444; train_global_loss: 1272376.8472; train_optim_loss: 1272376.8472; val_kl_reg_loss: 31126.9688; val_edge_recon_loss: 40545.7422; val_gene_expr_recon_loss: 449782.0000; val_masked_gp_l1_reg_loss: 8899.2764; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 733757.8750; val_global_loss: 1264111.8750; val_optim_loss: 1264111.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8505; val_auprc_score: 0.8425; val_best_acc_score: 0.6902; val_best_f1_score: 0.7549; train_kl_reg_loss: 32753.4757; train_edge_recon_loss: 39307.0334; train_gene_expr_recon_loss: 448445.2778; train_masked_gp_l1_reg_loss: 8772.3678; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728771.0069; train_global_loss: 1258049.1667; train_optim_loss: 1258049.1667; val_kl_reg_loss: 32994.5234; val_edge_recon_loss: 40484.5156; val_gene_expr_recon_loss: 440595.7188; val_masked_gp_l1_reg_loss: 8630.6201; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 727740.8750; val_global_loss: 1250446.2500; val_optim_loss: 1250446.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8640; val_auprc_score: 0.8586; val_best_acc_score: 0.7270; val_best_f1_score: 0.7738; train_kl_reg_loss: 33175.8151; train_edge_recon_loss: 39294.8615; train_gene_expr_recon_loss: 438326.9514; train_masked_gp_l1_reg_loss: 8548.6761; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 721547.0417; train_global_loss: 1240893.3611; train_optim_loss: 1240893.3611; val_kl_reg_loss: 32998.2812; val_edge_recon_loss: 40411.0352; val_gene_expr_recon_loss: 434012.0625; val_masked_gp_l1_reg_loss: 8450.2588; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 723229.3750; val_global_loss: 1239101.0000; val_optim_loss: 1239101.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8726; val_auprc_score: 0.8699; val_best_acc_score: 0.7638; val_best_f1_score: 0.7935; train_kl_reg_loss: 33174.0013; train_edge_recon_loss: 39268.2578; train_gene_expr_recon_loss: 433475.7951; train_masked_gp_l1_reg_loss: 8391.5254; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 715187.0833; train_global_loss: 1229496.6806; train_optim_loss: 1229496.6806; val_kl_reg_loss: 31660.6523; val_edge_recon_loss: 40349.0508; val_gene_expr_recon_loss: 429958.0000; val_masked_gp_l1_reg_loss: 8325.5967; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 719460.6250; val_global_loss: 1229753.8750; val_optim_loss: 1229753.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8793; val_auprc_score: 0.8747; val_best_acc_score: 0.7796; val_best_f1_score: 0.8011; train_kl_reg_loss: 32796.9195; train_edge_recon_loss: 39239.5286; train_gene_expr_recon_loss: 428340.0035; train_masked_gp_l1_reg_loss: 8290.1238; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 713017.9583; train_global_loss: 1221684.5278; train_optim_loss: 1221684.5278; val_kl_reg_loss: 32082.7500; val_edge_recon_loss: 40301.5234; val_gene_expr_recon_loss: 425569.7500; val_masked_gp_l1_reg_loss: 8249.5127; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 715803.7500; val_global_loss: 1222007.2500; val_optim_loss: 1222007.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8913; val_auprc_score: 0.8883; val_best_acc_score: 0.8037; val_best_f1_score: 0.8165; train_kl_reg_loss: 32694.8234; train_edge_recon_loss: 39227.1645; train_gene_expr_recon_loss: 423678.8368; train_masked_gp_l1_reg_loss: 8227.2062; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 709833.5278; train_global_loss: 1213661.5556; train_optim_loss: 1213661.5556; val_kl_reg_loss: 31453.1855; val_edge_recon_loss: 40248.0469; val_gene_expr_recon_loss: 422573.1250; val_masked_gp_l1_reg_loss: 8197.3379; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 712838.3750; val_global_loss: 1215310.1250; val_optim_loss: 1215310.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8964; val_auprc_score: 0.8919; val_best_acc_score: 0.8161; val_best_f1_score: 0.8239; train_kl_reg_loss: 32217.4789; train_edge_recon_loss: 39209.0312; train_gene_expr_recon_loss: 423420.8646; train_masked_gp_l1_reg_loss: 8182.0486; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 710224.2917; train_global_loss: 1213253.6944; train_optim_loss: 1213253.6944; val_kl_reg_loss: 30094.2500; val_edge_recon_loss: 40231.5117; val_gene_expr_recon_loss: 420843.8750; val_masked_gp_l1_reg_loss: 8165.1147; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 710591.9375; val_global_loss: 1209926.7500; val_optim_loss: 1209926.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9144; val_auprc_score: 0.9113; val_best_acc_score: 0.8417; val_best_f1_score: 0.8449; train_kl_reg_loss: 31841.3685; train_edge_recon_loss: 39203.7665; train_gene_expr_recon_loss: 419714.4583; train_masked_gp_l1_reg_loss: 8158.2245; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704568.4722; train_global_loss: 1203486.2917; train_optim_loss: 1203486.2917; val_kl_reg_loss: 30843.9609; val_edge_recon_loss: 40203.8867; val_gene_expr_recon_loss: 417763.9375; val_masked_gp_l1_reg_loss: 8148.1030; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707636.1250; val_global_loss: 1204596.0000; val_optim_loss: 1204596.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9182; val_auprc_score: 0.9111; val_best_acc_score: 0.8492; val_best_f1_score: 0.8487; train_kl_reg_loss: 31586.9154; train_edge_recon_loss: 39182.1094; train_gene_expr_recon_loss: 419024.4306; train_masked_gp_l1_reg_loss: 8146.7944; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703162.3681; train_global_loss: 1201102.6111; train_optim_loss: 1201102.6111; val_kl_reg_loss: 29440.9180; val_edge_recon_loss: 40142.2695; val_gene_expr_recon_loss: 416891.0938; val_masked_gp_l1_reg_loss: 8136.2158; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 705672.0625; val_global_loss: 1200282.5000; val_optim_loss: 1200282.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9279; val_auprc_score: 0.9249; val_best_acc_score: 0.8581; val_best_f1_score: 0.8566; train_kl_reg_loss: 31072.4952; train_edge_recon_loss: 39150.4831; train_gene_expr_recon_loss: 415020.4965; train_masked_gp_l1_reg_loss: 8136.0365; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 699907.0833; train_global_loss: 1193286.5833; train_optim_loss: 1193286.5833; val_kl_reg_loss: 30695.9473; val_edge_recon_loss: 40142.4844; val_gene_expr_recon_loss: 413914.5625; val_masked_gp_l1_reg_loss: 8134.4634; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 702737.9375; val_global_loss: 1195625.3750; val_optim_loss: 1195625.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9271; val_auprc_score: 0.9164; val_best_acc_score: 0.8549; val_best_f1_score: 0.8519; train_kl_reg_loss: 30748.9718; train_edge_recon_loss: 39112.0460; train_gene_expr_recon_loss: 415199.9271; train_masked_gp_l1_reg_loss: 8131.8991; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 701889.2847; train_global_loss: 1195082.1111; train_optim_loss: 1195082.1111; val_kl_reg_loss: 29871.3945; val_edge_recon_loss: 40080.8203; val_gene_expr_recon_loss: 412761.5938; val_masked_gp_l1_reg_loss: 8132.1816; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 700749.0000; val_global_loss: 1191595.0000; val_optim_loss: 1191595.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9305; val_auprc_score: 0.9195; val_best_acc_score: 0.8499; val_best_f1_score: 0.8437; train_kl_reg_loss: 30435.3622; train_edge_recon_loss: 39061.4431; train_gene_expr_recon_loss: 412643.2118; train_masked_gp_l1_reg_loss: 8132.9655; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 693353.0764; train_global_loss: 1183626.0556; train_optim_loss: 1183626.0556; val_kl_reg_loss: 27981.9238; val_edge_recon_loss: 40008.3711; val_gene_expr_recon_loss: 412624.5625; val_masked_gp_l1_reg_loss: 8130.6543; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 699902.1875; val_global_loss: 1188647.7500; val_optim_loss: 1188647.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9374; val_auprc_score: 0.9303; val_best_acc_score: 0.8566; val_best_f1_score: 0.8504; train_kl_reg_loss: 29755.9618; train_edge_recon_loss: 39022.1758; train_gene_expr_recon_loss: 412511.6458; train_masked_gp_l1_reg_loss: 8133.8796; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 694661.1736; train_global_loss: 1184084.8472; train_optim_loss: 1184084.8472; val_kl_reg_loss: 29196.9492; val_edge_recon_loss: 39986.7422; val_gene_expr_recon_loss: 410292.3750; val_masked_gp_l1_reg_loss: 8135.6372; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 697417.6250; val_global_loss: 1185029.2500; val_optim_loss: 1185029.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9408; val_auprc_score: 0.9312; val_best_acc_score: 0.8525; val_best_f1_score: 0.8435; train_kl_reg_loss: 29630.6426; train_edge_recon_loss: 38984.6645; train_gene_expr_recon_loss: 411007.8021; train_masked_gp_l1_reg_loss: 8142.6629; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 691373.8819; train_global_loss: 1179139.6528; train_optim_loss: 1179139.6528; val_kl_reg_loss: 27392.7988; val_edge_recon_loss: 39917.5508; val_gene_expr_recon_loss: 410322.0625; val_masked_gp_l1_reg_loss: 8147.5825; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 696540.6250; val_global_loss: 1182320.6250; val_optim_loss: 1182320.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9431; val_auprc_score: 0.9366; val_best_acc_score: 0.8557; val_best_f1_score: 0.8463; train_kl_reg_loss: 29219.8939; train_edge_recon_loss: 38945.6345; train_gene_expr_recon_loss: 411220.0243; train_masked_gp_l1_reg_loss: 8154.9665; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 693382.7222; train_global_loss: 1180923.2361; train_optim_loss: 1180923.2361; val_kl_reg_loss: 27809.9141; val_edge_recon_loss: 39887.1094; val_gene_expr_recon_loss: 408727.7812; val_masked_gp_l1_reg_loss: 8160.9126; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694402.8750; val_global_loss: 1178988.6250; val_optim_loss: 1178988.6250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9422; val_auprc_score: 0.9321; val_best_acc_score: 0.8539; val_best_f1_score: 0.8447; train_kl_reg_loss: 28782.7350; train_edge_recon_loss: 38916.6055; train_gene_expr_recon_loss: 407389.0799; train_masked_gp_l1_reg_loss: 8164.3741; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690780.3889; train_global_loss: 1174033.1806; train_optim_loss: 1174033.1806; val_kl_reg_loss: 28147.7793; val_edge_recon_loss: 39852.1797; val_gene_expr_recon_loss: 407448.3125; val_masked_gp_l1_reg_loss: 8161.4062; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692438.0625; val_global_loss: 1176047.7500; val_optim_loss: 1176047.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9447; val_auprc_score: 0.9355; val_best_acc_score: 0.8483; val_best_f1_score: 0.8353; train_kl_reg_loss: 28624.4776; train_edge_recon_loss: 38875.8220; train_gene_expr_recon_loss: 408610.4896; train_masked_gp_l1_reg_loss: 8162.8702; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 687282.7708; train_global_loss: 1171556.4167; train_optim_loss: 1171556.4167; val_kl_reg_loss: 26349.0000; val_edge_recon_loss: 39796.3594; val_gene_expr_recon_loss: 407731.1250; val_masked_gp_l1_reg_loss: 8168.2300; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 692104.9375; val_global_loss: 1174149.6250; val_optim_loss: 1174149.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9434; val_auprc_score: 0.9344; val_best_acc_score: 0.8465; val_best_f1_score: 0.8372; train_kl_reg_loss: 28161.4887; train_edge_recon_loss: 38839.5703; train_gene_expr_recon_loss: 407451.1875; train_masked_gp_l1_reg_loss: 8176.9385; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 689192.4722; train_global_loss: 1171821.6528; train_optim_loss: 1171821.6528; val_kl_reg_loss: 26689.1562; val_edge_recon_loss: 39788.5898; val_gene_expr_recon_loss: 406279.5625; val_masked_gp_l1_reg_loss: 8176.7539; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 690344.6875; val_global_loss: 1171278.7500; val_optim_loss: 1171278.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9447; val_auprc_score: 0.9347; val_best_acc_score: 0.8425; val_best_f1_score: 0.8433; train_kl_reg_loss: 27817.4705; train_edge_recon_loss: 38793.6159; train_gene_expr_recon_loss: 404419.4861; train_masked_gp_l1_reg_loss: 8182.6777; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 682775.2361; train_global_loss: 1161988.5000; train_optim_loss: 1161988.5000; val_kl_reg_loss: 26179.1914; val_edge_recon_loss: 39749.6328; val_gene_expr_recon_loss: 405692.5625; val_masked_gp_l1_reg_loss: 8188.9019; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 689111.0000; val_global_loss: 1168921.2500; val_optim_loss: 1168921.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9426; val_auprc_score: 0.9351; val_best_acc_score: 0.8697; val_best_f1_score: 0.8780; train_kl_reg_loss: 26396.6328; train_edge_recon_loss: 40204.0195; train_gene_expr_recon_loss: 412890.5208; train_masked_gp_l1_reg_loss: 8203.1425; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 691376.5972; train_global_loss: 1179070.9167; train_optim_loss: 1179070.9167; val_kl_reg_loss: 22922.8516; val_edge_recon_loss: 40356.9570; val_gene_expr_recon_loss: 412909.4375; val_masked_gp_l1_reg_loss: 8203.9551; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 697217.0000; val_global_loss: 1181610.2500; val_optim_loss: 1181610.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9410; val_auprc_score: 0.9304; val_best_acc_score: 0.8659; val_best_f1_score: 0.8745; train_kl_reg_loss: 24863.4755; train_edge_recon_loss: 40241.6276; train_gene_expr_recon_loss: 413471.5104; train_masked_gp_l1_reg_loss: 8190.0640; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 692529.2778; train_global_loss: 1179295.9583; train_optim_loss: 1179295.9583; val_kl_reg_loss: 22105.5410; val_edge_recon_loss: 40362.2852; val_gene_expr_recon_loss: 411796.8438; val_masked_gp_l1_reg_loss: 8174.2290; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 696357.6875; val_global_loss: 1178796.6250; val_optim_loss: 1178796.6250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9449; val_auprc_score: 0.9375; val_best_acc_score: 0.8703; val_best_f1_score: 0.8775; train_kl_reg_loss: 23654.4460; train_edge_recon_loss: 40231.5404; train_gene_expr_recon_loss: 411004.4826; train_masked_gp_l1_reg_loss: 8168.2677; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 688411.2986; train_global_loss: 1171470.0278; train_optim_loss: 1171470.0278; val_kl_reg_loss: 21821.3535; val_edge_recon_loss: 40334.0859; val_gene_expr_recon_loss: 410660.2500; val_masked_gp_l1_reg_loss: 8152.4736; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694963.9375; val_global_loss: 1175932.1250; val_optim_loss: 1175932.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9470; val_auprc_score: 0.9403; val_best_acc_score: 0.8744; val_best_f1_score: 0.8796; train_kl_reg_loss: 23073.9102; train_edge_recon_loss: 40193.9206; train_gene_expr_recon_loss: 410248.4097; train_masked_gp_l1_reg_loss: 8144.0725; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 689286.4306; train_global_loss: 1170946.7361; train_optim_loss: 1170946.7361; val_kl_reg_loss: 20512.8750; val_edge_recon_loss: 40286.1328; val_gene_expr_recon_loss: 410796.8750; val_masked_gp_l1_reg_loss: 8126.7842; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694733.1250; val_global_loss: 1174455.7500; val_optim_loss: 1174455.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9469; val_auprc_score: 0.9417; val_best_acc_score: 0.8720; val_best_f1_score: 0.8781; train_kl_reg_loss: 22657.6745; train_edge_recon_loss: 40175.7400; train_gene_expr_recon_loss: 410463.3785; train_masked_gp_l1_reg_loss: 8058.2657; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690808.4931; train_global_loss: 1172163.5278; train_optim_loss: 1172163.5278; val_kl_reg_loss: 21477.1367; val_edge_recon_loss: 40296.8906; val_gene_expr_recon_loss: 409633.2500; val_masked_gp_l1_reg_loss: 8000.1592; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694071.3125; val_global_loss: 1173478.7500; val_optim_loss: 1173478.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9477; val_auprc_score: 0.9411; val_best_acc_score: 0.8759; val_best_f1_score: 0.8814; train_kl_reg_loss: 22455.3346; train_edge_recon_loss: 40169.9227; train_gene_expr_recon_loss: 408026.9062; train_masked_gp_l1_reg_loss: 7983.6182; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690141.7639; train_global_loss: 1168777.5556; train_optim_loss: 1168777.5556; val_kl_reg_loss: 21492.1367; val_edge_recon_loss: 40298.3828; val_gene_expr_recon_loss: 409491.8125; val_masked_gp_l1_reg_loss: 7958.6353; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693797.5625; val_global_loss: 1173038.5000; val_optim_loss: 1173038.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9499; val_auprc_score: 0.9442; val_best_acc_score: 0.8798; val_best_f1_score: 0.8844; train_kl_reg_loss: 22571.3507; train_edge_recon_loss: 40169.6372; train_gene_expr_recon_loss: 409104.8090; train_masked_gp_l1_reg_loss: 7945.9338; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 687919.0972; train_global_loss: 1167710.8194; train_optim_loss: 1167710.8194; val_kl_reg_loss: 20959.3398; val_edge_recon_loss: 40288.8672; val_gene_expr_recon_loss: 409827.8125; val_masked_gp_l1_reg_loss: 7931.7539; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693854.8125; val_global_loss: 1172862.6250; val_optim_loss: 1172862.6250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9486; val_auprc_score: 0.9411; val_best_acc_score: 0.8774; val_best_f1_score: 0.8822; train_kl_reg_loss: 22490.9032; train_edge_recon_loss: 40168.5356; train_gene_expr_recon_loss: 411781.9965; train_masked_gp_l1_reg_loss: 7924.0998; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690816.8681; train_global_loss: 1173182.3889; train_optim_loss: 1173182.3889; val_kl_reg_loss: 21029.5742; val_edge_recon_loss: 40282.4922; val_gene_expr_recon_loss: 409649.3750; val_masked_gp_l1_reg_loss: 7915.7031; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693712.1250; val_global_loss: 1172589.2500; val_optim_loss: 1172589.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 17 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9448
val AUPRC score: 0.9377
val best accuracy score: 0.8705
val best F1 score: 0.8773
val target rna MSE score: 0.4816
val source rna MSE score: 0.2413
val target atac MSE score: 0.1347
val source atac MSE score: 0.0179
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
