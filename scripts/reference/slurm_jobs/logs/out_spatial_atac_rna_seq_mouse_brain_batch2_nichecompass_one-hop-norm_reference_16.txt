[True]
Run timestamp: 26072023_011708_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8909; val_auprc_score: 0.9081; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 59184.3565; train_edge_recon_loss: 353994.6875; train_gene_expr_recon_loss: 313746.3438; train_masked_gp_l1_reg_loss: 1665.3530; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 111190088.8889; train_global_loss: 111918680.0000; train_optim_loss: 111918680.0000; val_kl_reg_loss: 36493.2422; val_edge_recon_loss: 406614.4375; val_gene_expr_recon_loss: 296832.3750; val_masked_gp_l1_reg_loss: 1542.3167; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106395480.0000; val_global_loss: 107136960.0000; val_optim_loss: 107136960.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9015; val_auprc_score: 0.9086; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 28439.6706; train_edge_recon_loss: 376849.3889; train_gene_expr_recon_loss: 292128.0243; train_masked_gp_l1_reg_loss: 1555.3137; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107623409.7778; train_global_loss: 108322382.2222; train_optim_loss: 108322382.2222; val_kl_reg_loss: 29707.8633; val_edge_recon_loss: 406611.8750; val_gene_expr_recon_loss: 277353.7812; val_masked_gp_l1_reg_loss: 1600.0641; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104554088.0000; val_global_loss: 105269360.0000; val_optim_loss: 105269360.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8940; val_auprc_score: 0.8978; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 39444.4425; train_edge_recon_loss: 387836.6181; train_gene_expr_recon_loss: 273828.7188; train_masked_gp_l1_reg_loss: 1664.7981; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 105369322.6667; train_global_loss: 106072097.7778; train_optim_loss: 106072097.7778; val_kl_reg_loss: 47885.2031; val_edge_recon_loss: 406610.8438; val_gene_expr_recon_loss: 257755.8125; val_masked_gp_l1_reg_loss: 1740.0917; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102528088.0000; val_global_loss: 103242080.0000; val_optim_loss: 103242080.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8644; val_auprc_score: 0.8686; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 55459.2487; train_edge_recon_loss: 396506.0417; train_gene_expr_recon_loss: 252797.3177; train_masked_gp_l1_reg_loss: 1771.8649; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102275936.8889; train_global_loss: 102982471.1111; train_optim_loss: 102982471.1111; val_kl_reg_loss: 64647.0156; val_edge_recon_loss: 406597.1250; val_gene_expr_recon_loss: 246510.2812; val_masked_gp_l1_reg_loss: 1791.9626; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100874784.0000; val_global_loss: 101594328.0000; val_optim_loss: 101594328.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8463; val_auprc_score: 0.8481; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 71816.4397; train_edge_recon_loss: 398966.9618; train_gene_expr_recon_loss: 242170.9167; train_masked_gp_l1_reg_loss: 1786.3673; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100136283.5556; train_global_loss: 100851024.8889; train_optim_loss: 100851024.8889; val_kl_reg_loss: 78357.6250; val_edge_recon_loss: 406592.4062; val_gene_expr_recon_loss: 237667.7656; val_masked_gp_l1_reg_loss: 1766.6919; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99542992.0000; val_global_loss: 100267376.0000; val_optim_loss: 100267376.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8444; val_auprc_score: 0.8531; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 87095.2188; train_edge_recon_loss: 401098.3889; train_gene_expr_recon_loss: 234640.3281; train_masked_gp_l1_reg_loss: 1737.9162; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99110603.5556; train_global_loss: 99835176.0000; train_optim_loss: 99835176.0000; val_kl_reg_loss: 92467.3594; val_edge_recon_loss: 406588.5938; val_gene_expr_recon_loss: 232489.6562; val_masked_gp_l1_reg_loss: 1695.3668; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98682784.0000; val_global_loss: 99416024.0000; val_optim_loss: 99416024.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8536; val_auprc_score: 0.8576; val_best_acc_score: 0.5032; val_best_f1_score: 0.6681; train_kl_reg_loss: 98437.7439; train_edge_recon_loss: 402713.5417; train_gene_expr_recon_loss: 230356.1250; train_masked_gp_l1_reg_loss: 1658.4053; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98347856.0000; train_global_loss: 99081020.4444; train_optim_loss: 99081020.4444; val_kl_reg_loss: 103391.9062; val_edge_recon_loss: 406579.1875; val_gene_expr_recon_loss: 228722.5938; val_masked_gp_l1_reg_loss: 1611.1090; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98386624.0000; val_global_loss: 99126928.0000; val_optim_loss: 99126928.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8680; val_auprc_score: 0.8650; val_best_acc_score: 0.5059; val_best_f1_score: 0.6693; train_kl_reg_loss: 109410.9245; train_edge_recon_loss: 403345.9340; train_gene_expr_recon_loss: 225713.9358; train_masked_gp_l1_reg_loss: 1573.0612; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98984245.3333; train_global_loss: 99724288.0000; train_optim_loss: 99724288.0000; val_kl_reg_loss: 108926.4453; val_edge_recon_loss: 406556.5312; val_gene_expr_recon_loss: 224988.5312; val_masked_gp_l1_reg_loss: 1521.4944; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97989256.0000; val_global_loss: 98731248.0000; val_optim_loss: 98731248.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8741; val_auprc_score: 0.8631; val_best_acc_score: 0.5101; val_best_f1_score: 0.6711; train_kl_reg_loss: 114694.9679; train_edge_recon_loss: 403509.4514; train_gene_expr_recon_loss: 223379.4184; train_masked_gp_l1_reg_loss: 1486.3945; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98022010.6667; train_global_loss: 98765081.7778; train_optim_loss: 98765081.7778; val_kl_reg_loss: 114467.0312; val_edge_recon_loss: 406510.2188; val_gene_expr_recon_loss: 221778.2812; val_masked_gp_l1_reg_loss: 1441.9092; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97712224.0000; val_global_loss: 98456424.0000; val_optim_loss: 98456424.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8711; val_auprc_score: 0.8603; val_best_acc_score: 0.5190; val_best_f1_score: 0.6748; train_kl_reg_loss: 120543.3542; train_edge_recon_loss: 403317.8229; train_gene_expr_recon_loss: 219975.4774; train_masked_gp_l1_reg_loss: 1412.4461; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97911880.0000; train_global_loss: 98657129.7778; train_optim_loss: 98657129.7778; val_kl_reg_loss: 121417.9062; val_edge_recon_loss: 406409.5938; val_gene_expr_recon_loss: 219258.6406; val_masked_gp_l1_reg_loss: 1375.4136; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97471848.0000; val_global_loss: 98220312.0000; val_optim_loss: 98220312.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8559; val_auprc_score: 0.8453; val_best_acc_score: 0.5503; val_best_f1_score: 0.6886; train_kl_reg_loss: 125114.1207; train_edge_recon_loss: 403717.8854; train_gene_expr_recon_loss: 217191.0087; train_masked_gp_l1_reg_loss: 1350.2497; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96835503.1111; train_global_loss: 97582876.4444; train_optim_loss: 97582876.4444; val_kl_reg_loss: 123081.9062; val_edge_recon_loss: 406231.0938; val_gene_expr_recon_loss: 217437.7188; val_masked_gp_l1_reg_loss: 1319.1364; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97283056.0000; val_global_loss: 98031128.0000; val_optim_loss: 98031128.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8482; val_auprc_score: 0.8396; val_best_acc_score: 0.5997; val_best_f1_score: 0.7115; train_kl_reg_loss: 128709.1042; train_edge_recon_loss: 403518.8229; train_gene_expr_recon_loss: 216880.7274; train_masked_gp_l1_reg_loss: 1299.5704; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97945561.7778; train_global_loss: 98695970.6667; train_optim_loss: 98695970.6667; val_kl_reg_loss: 121240.3359; val_edge_recon_loss: 405954.3438; val_gene_expr_recon_loss: 216006.9219; val_masked_gp_l1_reg_loss: 1274.1454; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97062976.0000; val_global_loss: 97807448.0000; val_optim_loss: 97807448.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8369; val_auprc_score: 0.8266; val_best_acc_score: 0.6157; val_best_f1_score: 0.7185; train_kl_reg_loss: 129110.9497; train_edge_recon_loss: 403376.8542; train_gene_expr_recon_loss: 216738.5608; train_masked_gp_l1_reg_loss: 1258.2119; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97948376.0000; train_global_loss: 98698859.5556; train_optim_loss: 98698859.5556; val_kl_reg_loss: 117392.8594; val_edge_recon_loss: 405848.0938; val_gene_expr_recon_loss: 215271.6250; val_masked_gp_l1_reg_loss: 1238.2329; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96955920.0000; val_global_loss: 97695672.0000; val_optim_loss: 97695672.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8464; val_auprc_score: 0.8403; val_best_acc_score: 0.6377; val_best_f1_score: 0.7291; train_kl_reg_loss: 126694.3542; train_edge_recon_loss: 403450.1944; train_gene_expr_recon_loss: 213995.8576; train_masked_gp_l1_reg_loss: 1227.3580; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97022282.6667; train_global_loss: 97767650.6667; train_optim_loss: 97767650.6667; val_kl_reg_loss: 117946.5938; val_edge_recon_loss: 405660.5000; val_gene_expr_recon_loss: 214779.1875; val_masked_gp_l1_reg_loss: 1210.3877; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96931480.0000; val_global_loss: 97671080.0000; val_optim_loss: 97671080.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8477; val_auprc_score: 0.8426; val_best_acc_score: 0.6579; val_best_f1_score: 0.7383; train_kl_reg_loss: 128815.7674; train_edge_recon_loss: 403027.2674; train_gene_expr_recon_loss: 214067.5677; train_masked_gp_l1_reg_loss: 1202.0649; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97366068.4444; train_global_loss: 98113182.2222; train_optim_loss: 98113182.2222; val_kl_reg_loss: 116629.3828; val_edge_recon_loss: 405495.8750; val_gene_expr_recon_loss: 214102.3125; val_masked_gp_l1_reg_loss: 1188.4227; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96795960.0000; val_global_loss: 97533376.0000; val_optim_loss: 97533376.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8537; val_auprc_score: 0.8488; val_best_acc_score: 0.6826; val_best_f1_score: 0.7505; train_kl_reg_loss: 126426.5842; train_edge_recon_loss: 402889.9479; train_gene_expr_recon_loss: 212921.5885; train_masked_gp_l1_reg_loss: 1182.8765; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96642327.1111; train_global_loss: 97385750.2222; train_optim_loss: 97385750.2222; val_kl_reg_loss: 115134.0078; val_edge_recon_loss: 405240.8438; val_gene_expr_recon_loss: 213418.6562; val_masked_gp_l1_reg_loss: 1172.3347; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96518432.0000; val_global_loss: 97253400.0000; val_optim_loss: 97253400.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8621; val_auprc_score: 0.8517; val_best_acc_score: 0.7321; val_best_f1_score: 0.7782; train_kl_reg_loss: 125903.8429; train_edge_recon_loss: 402631.1528; train_gene_expr_recon_loss: 211225.7448; train_masked_gp_l1_reg_loss: 1165.1045; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96087432.0000; train_global_loss: 96828358.2222; train_optim_loss: 96828358.2222; val_kl_reg_loss: 112560.4531; val_edge_recon_loss: 404797.3750; val_gene_expr_recon_loss: 212899.7188; val_masked_gp_l1_reg_loss: 1153.0221; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96403552.0000; val_global_loss: 97134960.0000; val_optim_loss: 97134960.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8705; val_auprc_score: 0.8618; val_best_acc_score: 0.7546; val_best_f1_score: 0.7902; train_kl_reg_loss: 124378.7274; train_edge_recon_loss: 402076.7014; train_gene_expr_recon_loss: 212554.7969; train_masked_gp_l1_reg_loss: 1149.4202; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96543436.4444; train_global_loss: 97283594.6667; train_optim_loss: 97283594.6667; val_kl_reg_loss: 110892.2656; val_edge_recon_loss: 404541.6875; val_gene_expr_recon_loss: 212469.2031; val_masked_gp_l1_reg_loss: 1142.5360; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96329336.0000; val_global_loss: 97058384.0000; val_optim_loss: 97058384.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8740; val_auprc_score: 0.8630; val_best_acc_score: 0.7811; val_best_f1_score: 0.8044; train_kl_reg_loss: 123617.2613; train_edge_recon_loss: 401398.0069; train_gene_expr_recon_loss: 211959.3993; train_masked_gp_l1_reg_loss: 1141.9057; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96676830.2222; train_global_loss: 97414945.7778; train_optim_loss: 97414945.7778; val_kl_reg_loss: 109804.6406; val_edge_recon_loss: 403851.0938; val_gene_expr_recon_loss: 212550.2812; val_masked_gp_l1_reg_loss: 1135.0215; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96414648.0000; val_global_loss: 97141992.0000; val_optim_loss: 97141992.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8796; val_auprc_score: 0.8663; val_best_acc_score: 0.7952; val_best_f1_score: 0.8105; train_kl_reg_loss: 120665.2578; train_edge_recon_loss: 400809.0556; train_gene_expr_recon_loss: 211012.8663; train_masked_gp_l1_reg_loss: 1133.3554; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96406162.6667; train_global_loss: 97139783.1111; train_optim_loss: 97139783.1111; val_kl_reg_loss: 108151.7344; val_edge_recon_loss: 402959.7500; val_gene_expr_recon_loss: 211938.8125; val_masked_gp_l1_reg_loss: 1126.9501; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96262984.0000; val_global_loss: 96987160.0000; val_optim_loss: 96987160.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8819; val_auprc_score: 0.8702; val_best_acc_score: 0.7913; val_best_f1_score: 0.8021; train_kl_reg_loss: 118187.7960; train_edge_recon_loss: 399892.4792; train_gene_expr_recon_loss: 209728.8160; train_masked_gp_l1_reg_loss: 1127.1961; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96344268.4444; train_global_loss: 97073204.4444; train_optim_loss: 97073204.4444; val_kl_reg_loss: 108132.7969; val_edge_recon_loss: 402101.5312; val_gene_expr_recon_loss: 211765.0625; val_masked_gp_l1_reg_loss: 1124.5275; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96236248.0000; val_global_loss: 96959368.0000; val_optim_loss: 96959368.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8818; val_auprc_score: 0.8691; val_best_acc_score: 0.7937; val_best_f1_score: 0.7991; train_kl_reg_loss: 119376.9132; train_edge_recon_loss: 398510.5938; train_gene_expr_recon_loss: 210956.4931; train_masked_gp_l1_reg_loss: 1125.1890; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96474560.8889; train_global_loss: 97204529.7778; train_optim_loss: 97204529.7778; val_kl_reg_loss: 107233.0156; val_edge_recon_loss: 400885.9375; val_gene_expr_recon_loss: 211199.9219; val_masked_gp_l1_reg_loss: 1120.2867; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95992496.0000; val_global_loss: 96712936.0000; val_optim_loss: 96712936.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8849; val_auprc_score: 0.8694; val_best_acc_score: 0.7932; val_best_f1_score: 0.7940; train_kl_reg_loss: 116958.7925; train_edge_recon_loss: 398096.0243; train_gene_expr_recon_loss: 210372.2014; train_masked_gp_l1_reg_loss: 1121.9848; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96668475.5556; train_global_loss: 97395024.8889; train_optim_loss: 97395024.8889; val_kl_reg_loss: 105227.2656; val_edge_recon_loss: 399439.3750; val_gene_expr_recon_loss: 211317.6562; val_masked_gp_l1_reg_loss: 1118.5269; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95948464.0000; val_global_loss: 96665568.0000; val_optim_loss: 96665568.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8870; val_auprc_score: 0.8749; val_best_acc_score: 0.7914; val_best_f1_score: 0.7911; train_kl_reg_loss: 117224.8542; train_edge_recon_loss: 396356.8785; train_gene_expr_recon_loss: 210556.9792; train_masked_gp_l1_reg_loss: 1119.5020; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96567274.6667; train_global_loss: 97292533.3333; train_optim_loss: 97292533.3333; val_kl_reg_loss: 106565.0938; val_edge_recon_loss: 398184.2500; val_gene_expr_recon_loss: 210644.1250; val_masked_gp_l1_reg_loss: 1115.7545; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95802776.0000; val_global_loss: 96519288.0000; val_optim_loss: 96519288.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8871; val_auprc_score: 0.8759; val_best_acc_score: 0.7901; val_best_f1_score: 0.7951; train_kl_reg_loss: 114684.2934; train_edge_recon_loss: 395340.9896; train_gene_expr_recon_loss: 208711.2656; train_masked_gp_l1_reg_loss: 1116.7860; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95779688.0000; train_global_loss: 96499541.3333; train_optim_loss: 96499541.3333; val_kl_reg_loss: 111059.3828; val_edge_recon_loss: 396998.0625; val_gene_expr_recon_loss: 210571.6719; val_masked_gp_l1_reg_loss: 1113.9749; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95891312.0000; val_global_loss: 96611056.0000; val_optim_loss: 96611056.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8872; val_auprc_score: 0.8730; val_best_acc_score: 0.7961; val_best_f1_score: 0.8028; train_kl_reg_loss: 115731.0799; train_edge_recon_loss: 399242.2118; train_gene_expr_recon_loss: 211047.3941; train_masked_gp_l1_reg_loss: 1116.2562; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96401545.7778; train_global_loss: 97128682.6667; train_optim_loss: 97128682.6667; val_kl_reg_loss: 100554.1406; val_edge_recon_loss: 400243.0938; val_gene_expr_recon_loss: 211257.0938; val_masked_gp_l1_reg_loss: 1114.4673; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95910712.0000; val_global_loss: 96623880.0000; val_optim_loss: 96623880.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8943; val_auprc_score: 0.8838; val_best_acc_score: 0.8033; val_best_f1_score: 0.8053; train_kl_reg_loss: 116813.5964; train_edge_recon_loss: 397600.7812; train_gene_expr_recon_loss: 210149.4514; train_masked_gp_l1_reg_loss: 1109.7116; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95893330.6667; train_global_loss: 96619004.4444; train_optim_loss: 96619004.4444; val_kl_reg_loss: 101986.8906; val_edge_recon_loss: 399090.5000; val_gene_expr_recon_loss: 210706.6094; val_masked_gp_l1_reg_loss: 1102.0770; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95917456.0000; val_global_loss: 96630344.0000; val_optim_loss: 96630344.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8970; val_auprc_score: 0.8845; val_best_acc_score: 0.8052; val_best_f1_score: 0.8049; train_kl_reg_loss: 114674.3307; train_edge_recon_loss: 397814.9653; train_gene_expr_recon_loss: 210621.4566; train_masked_gp_l1_reg_loss: 1096.2520; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96151885.3333; train_global_loss: 96876092.4444; train_optim_loss: 96876092.4444; val_kl_reg_loss: 99586.5938; val_edge_recon_loss: 398966.6875; val_gene_expr_recon_loss: 210733.4531; val_masked_gp_l1_reg_loss: 1089.4158; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96009144.0000; val_global_loss: 96719520.0000; val_optim_loss: 96719520.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8870; val_auprc_score: 0.8720; val_best_acc_score: 0.7961; val_best_f1_score: 0.7969; train_kl_reg_loss: 113102.2561; train_edge_recon_loss: 397539.2917; train_gene_expr_recon_loss: 209136.6059; train_masked_gp_l1_reg_loss: 1085.8572; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96032351.1111; train_global_loss: 96753215.1111; train_optim_loss: 96753215.1111; val_kl_reg_loss: 98359.5859; val_edge_recon_loss: 398852.1250; val_gene_expr_recon_loss: 210678.0938; val_masked_gp_l1_reg_loss: 1081.7590; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95949080.0000; val_global_loss: 96658048.0000; val_optim_loss: 96658048.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8922; val_auprc_score: 0.8809; val_best_acc_score: 0.8023; val_best_f1_score: 0.8017; train_kl_reg_loss: 113725.4167; train_edge_recon_loss: 397339.6250; train_gene_expr_recon_loss: 209056.8247; train_masked_gp_l1_reg_loss: 1079.9347; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95942469.3333; train_global_loss: 96663671.1111; train_optim_loss: 96663671.1111; val_kl_reg_loss: 99789.0156; val_edge_recon_loss: 398751.5625; val_gene_expr_recon_loss: 210327.5781; val_masked_gp_l1_reg_loss: 1077.5640; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95870552.0000; val_global_loss: 96580496.0000; val_optim_loss: 96580496.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8923; val_auprc_score: 0.8739; val_best_acc_score: 0.8050; val_best_f1_score: 0.8035; train_kl_reg_loss: 115211.7431; train_edge_recon_loss: 397342.0035; train_gene_expr_recon_loss: 209754.3889; train_masked_gp_l1_reg_loss: 1075.8731; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96470612.4444; train_global_loss: 97193996.4444; train_optim_loss: 97193996.4444; val_kl_reg_loss: 100425.6250; val_edge_recon_loss: 398443.7500; val_gene_expr_recon_loss: 210450.1250; val_masked_gp_l1_reg_loss: 1073.8035; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95929048.0000; val_global_loss: 96639440.0000; val_optim_loss: 96639440.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8939; val_auprc_score: 0.8804; val_best_acc_score: 0.8030; val_best_f1_score: 0.8013; train_kl_reg_loss: 114175.3299; train_edge_recon_loss: 397090.5625; train_gene_expr_recon_loss: 209066.8264; train_masked_gp_l1_reg_loss: 1072.5508; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95544387.5556; train_global_loss: 96265792.8889; train_optim_loss: 96265792.8889; val_kl_reg_loss: 99981.7812; val_edge_recon_loss: 398332.8438; val_gene_expr_recon_loss: 210338.2031; val_masked_gp_l1_reg_loss: 1071.0126; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95858272.0000; val_global_loss: 96567992.0000; val_optim_loss: 96567992.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 29 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.8880
Val AUPRC score: 0.8740
Val best accuracy score: 0.7963
Val best F1 score: 0.8066
Val gene expr MSE score: 0.5262
Val chrom access MSE score: 0.0861
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
