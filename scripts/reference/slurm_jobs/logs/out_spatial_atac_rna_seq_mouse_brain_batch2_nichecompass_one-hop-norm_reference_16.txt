[True]
Run timestamp: 07092023_135041_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.5890; val_auprc_score: 0.5986; val_best_acc_score: 0.5016; val_best_f1_score: 0.6670; train_kl_reg_loss: 52646.2199; train_edge_recon_loss: 3547470.3485; train_gene_expr_recon_loss: 16909868.8182; train_masked_gp_l1_reg_loss: 177668.9886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9893621.0038; train_chrom_access_recon_loss: 3015228.6780; train_global_loss: 33596504.0606; train_optim_loss: 33596504.0606; val_kl_reg_loss: 91832.4717; val_edge_recon_loss: 4065525.9062; val_gene_expr_recon_loss: 16033796.5000; val_masked_gp_l1_reg_loss: 169214.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3458077.2500; val_chrom_access_recon_loss: 2941297.9375; val_global_loss: 26759744.5000; val_optim_loss: 26759744.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6224; val_auprc_score: 0.6186; val_best_acc_score: 0.5236; val_best_f1_score: 0.6733; train_kl_reg_loss: 110628.6241; train_edge_recon_loss: 3545450.7235; train_gene_expr_recon_loss: 14971523.0455; train_masked_gp_l1_reg_loss: 160829.9332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1244559.7230; train_chrom_access_recon_loss: 2845905.1061; train_global_loss: 22878896.7879; train_optim_loss: 22878896.7879; val_kl_reg_loss: 131671.8896; val_edge_recon_loss: 4063705.0312; val_gene_expr_recon_loss: 15162920.1250; val_masked_gp_l1_reg_loss: 154100.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 409300.0312; val_chrom_access_recon_loss: 2899723.8125; val_global_loss: 22821420.2500; val_optim_loss: 22821420.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6506; val_auprc_score: 0.6388; val_best_acc_score: 0.5457; val_best_f1_score: 0.6792; train_kl_reg_loss: 115932.4154; train_edge_recon_loss: 3534253.7538; train_gene_expr_recon_loss: 14618596.1515; train_masked_gp_l1_reg_loss: 152672.1875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 306698.1477; train_chrom_access_recon_loss: 2810708.0265; train_global_loss: 21538860.4848; train_optim_loss: 21538860.4848; val_kl_reg_loss: 124037.1123; val_edge_recon_loss: 4062343.1250; val_gene_expr_recon_loss: 15148432.1250; val_masked_gp_l1_reg_loss: 150822.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 238811.2188; val_chrom_access_recon_loss: 2907040.2500; val_global_loss: 22631486.5000; val_optim_loss: 22631486.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7304; val_auprc_score: 0.7249; val_best_acc_score: 0.6413; val_best_f1_score: 0.7038; train_kl_reg_loss: 112849.0120; train_edge_recon_loss: 3529213.0682; train_gene_expr_recon_loss: 14464234.0758; train_masked_gp_l1_reg_loss: 150466.2199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209242.8961; train_chrom_access_recon_loss: 2788855.8750; train_global_loss: 21254860.8788; train_optim_loss: 21254860.8788; val_kl_reg_loss: 124759.8271; val_edge_recon_loss: 4052222.8438; val_gene_expr_recon_loss: 14909377.8750; val_masked_gp_l1_reg_loss: 150939.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 186325.8594; val_chrom_access_recon_loss: 2832750.7812; val_global_loss: 22256377.5000; val_optim_loss: 22256377.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8113; val_auprc_score: 0.7847; val_best_acc_score: 0.7313; val_best_f1_score: 0.7123; train_kl_reg_loss: 107052.3939; train_edge_recon_loss: 3522337.3939; train_gene_expr_recon_loss: 14369288.3788; train_masked_gp_l1_reg_loss: 151979.0062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 174746.8004; train_chrom_access_recon_loss: 2779794.2348; train_global_loss: 21105198.3333; train_optim_loss: 21105198.3333; val_kl_reg_loss: 112359.4902; val_edge_recon_loss: 4018831.4062; val_gene_expr_recon_loss: 14819353.2500; val_masked_gp_l1_reg_loss: 153320.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163015.6562; val_chrom_access_recon_loss: 2830532.5938; val_global_loss: 22097413.0000; val_optim_loss: 22097413.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8703; val_auprc_score: 0.8405; val_best_acc_score: 0.8028; val_best_f1_score: 0.8132; train_kl_reg_loss: 95186.7956; train_edge_recon_loss: 3492626.4394; train_gene_expr_recon_loss: 14285490.8182; train_masked_gp_l1_reg_loss: 155258.7090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154296.5189; train_chrom_access_recon_loss: 2757966.3295; train_global_loss: 20940825.6667; train_optim_loss: 20940825.6667; val_kl_reg_loss: 84929.9336; val_edge_recon_loss: 3655789.8438; val_gene_expr_recon_loss: 14779082.0000; val_masked_gp_l1_reg_loss: 158768.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147141.1875; val_chrom_access_recon_loss: 2841939.7812; val_global_loss: 21667651.5000; val_optim_loss: 21667651.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8877; val_auprc_score: 0.8491; val_best_acc_score: 0.8238; val_best_f1_score: 0.8414; train_kl_reg_loss: 101668.0677; train_edge_recon_loss: 3133968.6439; train_gene_expr_recon_loss: 14280970.5606; train_masked_gp_l1_reg_loss: 166650.0062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143762.1579; train_chrom_access_recon_loss: 2747684.9924; train_global_loss: 20574704.3939; train_optim_loss: 20574704.3939; val_kl_reg_loss: 100470.8594; val_edge_recon_loss: 3147876.9062; val_gene_expr_recon_loss: 14719379.0000; val_masked_gp_l1_reg_loss: 173682.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141022.7969; val_chrom_access_recon_loss: 2814734.3438; val_global_loss: 21097164.7500; val_optim_loss: 21097164.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8823; val_auprc_score: 0.8522; val_best_acc_score: 0.8154; val_best_f1_score: 0.8337; train_kl_reg_loss: 113776.9570; train_edge_recon_loss: 2983419.7992; train_gene_expr_recon_loss: 14195316.7879; train_masked_gp_l1_reg_loss: 175072.2746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140055.8482; train_chrom_access_recon_loss: 2733160.2765; train_global_loss: 20340802.1515; train_optim_loss: 20340802.1515; val_kl_reg_loss: 133663.4346; val_edge_recon_loss: 2992547.9688; val_gene_expr_recon_loss: 14593340.7500; val_masked_gp_l1_reg_loss: 176827.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136696.6875; val_chrom_access_recon_loss: 2824261.1250; val_global_loss: 20857337.5000; val_optim_loss: 20857337.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8884; val_auprc_score: 0.8552; val_best_acc_score: 0.8219; val_best_f1_score: 0.8367; train_kl_reg_loss: 134039.4046; train_edge_recon_loss: 2899463.0455; train_gene_expr_recon_loss: 14099673.6818; train_masked_gp_l1_reg_loss: 178110.8116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134130.9295; train_chrom_access_recon_loss: 2717454.8750; train_global_loss: 20162872.7273; train_optim_loss: 20162872.7273; val_kl_reg_loss: 137457.1660; val_edge_recon_loss: 2931297.7188; val_gene_expr_recon_loss: 14580345.6250; val_masked_gp_l1_reg_loss: 179393.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132268.1250; val_chrom_access_recon_loss: 2805125.0625; val_global_loss: 20765887.2500; val_optim_loss: 20765887.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8996; val_auprc_score: 0.8692; val_best_acc_score: 0.8310; val_best_f1_score: 0.8468; train_kl_reg_loss: 134309.5816; train_edge_recon_loss: 2872712.1439; train_gene_expr_recon_loss: 14037756.3182; train_masked_gp_l1_reg_loss: 180805.4401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131033.2913; train_chrom_access_recon_loss: 2706441.5379; train_global_loss: 20063058.3030; train_optim_loss: 20063058.3030; val_kl_reg_loss: 132228.7715; val_edge_recon_loss: 2890508.8750; val_gene_expr_recon_loss: 14456172.8750; val_masked_gp_l1_reg_loss: 182348.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130294.0391; val_chrom_access_recon_loss: 2776249.5000; val_global_loss: 20567802.0000; val_optim_loss: 20567802.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9098; val_auprc_score: 0.8809; val_best_acc_score: 0.8399; val_best_f1_score: 0.8539; train_kl_reg_loss: 136677.9053; train_edge_recon_loss: 2862141.7955; train_gene_expr_recon_loss: 13997282.6061; train_masked_gp_l1_reg_loss: 183408.7616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130035.1855; train_chrom_access_recon_loss: 2695979.0909; train_global_loss: 20005525.1212; train_optim_loss: 20005525.1212; val_kl_reg_loss: 132016.8662; val_edge_recon_loss: 2850143.9688; val_gene_expr_recon_loss: 14287941.6250; val_masked_gp_l1_reg_loss: 184403.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129991.5469; val_chrom_access_recon_loss: 2725864.0000; val_global_loss: 20310362.7500; val_optim_loss: 20310362.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8970; val_auprc_score: 0.8604; val_best_acc_score: 0.8356; val_best_f1_score: 0.8493; train_kl_reg_loss: 134393.6727; train_edge_recon_loss: 2853376.8333; train_gene_expr_recon_loss: 13945732.6970; train_masked_gp_l1_reg_loss: 185158.8598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129785.8260; train_chrom_access_recon_loss: 2685724.5492; train_global_loss: 19934172.3333; train_optim_loss: 19934172.3333; val_kl_reg_loss: 135316.7295; val_edge_recon_loss: 2918186.9062; val_gene_expr_recon_loss: 14349237.0000; val_masked_gp_l1_reg_loss: 186094.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129547.1172; val_chrom_access_recon_loss: 2737054.5938; val_global_loss: 20455437.2500; val_optim_loss: 20455437.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9161; val_auprc_score: 0.8872; val_best_acc_score: 0.8512; val_best_f1_score: 0.8613; train_kl_reg_loss: 133266.3027; train_edge_recon_loss: 2839028.2992; train_gene_expr_recon_loss: 13895868.6212; train_masked_gp_l1_reg_loss: 186776.3241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129655.3331; train_chrom_access_recon_loss: 2674656.0985; train_global_loss: 19859250.7576; train_optim_loss: 19859250.7576; val_kl_reg_loss: 129280.4883; val_edge_recon_loss: 2836912.4688; val_gene_expr_recon_loss: 14372386.7500; val_masked_gp_l1_reg_loss: 187798.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129403.7344; val_chrom_access_recon_loss: 2769125.6250; val_global_loss: 20424907.0000; val_optim_loss: 20424907.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9066; val_auprc_score: 0.8727; val_best_acc_score: 0.8436; val_best_f1_score: 0.8549; train_kl_reg_loss: 132481.4951; train_edge_recon_loss: 2829231.2538; train_gene_expr_recon_loss: 13861267.6970; train_masked_gp_l1_reg_loss: 188514.6982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129418.2211; train_chrom_access_recon_loss: 2668413.5606; train_global_loss: 19809326.8485; train_optim_loss: 19809326.8485; val_kl_reg_loss: 135842.7891; val_edge_recon_loss: 2846753.5625; val_gene_expr_recon_loss: 14229127.8750; val_masked_gp_l1_reg_loss: 189122.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129839.2969; val_chrom_access_recon_loss: 2750701.0312; val_global_loss: 20281387.2500; val_optim_loss: 20281387.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9175; val_auprc_score: 0.8903; val_best_acc_score: 0.8552; val_best_f1_score: 0.8643; train_kl_reg_loss: 132039.3492; train_edge_recon_loss: 2815786.8864; train_gene_expr_recon_loss: 13813624.1212; train_masked_gp_l1_reg_loss: 189567.9607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129946.0722; train_chrom_access_recon_loss: 2658597.6174; train_global_loss: 19739561.7879; train_optim_loss: 19739561.7879; val_kl_reg_loss: 132532.5186; val_edge_recon_loss: 2839065.8438; val_gene_expr_recon_loss: 14207108.3750; val_masked_gp_l1_reg_loss: 190291.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130151.8281; val_chrom_access_recon_loss: 2735031.7188; val_global_loss: 20234182.5000; val_optim_loss: 20234182.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9217; val_auprc_score: 0.8948; val_best_acc_score: 0.8528; val_best_f1_score: 0.8636; train_kl_reg_loss: 133612.7820; train_edge_recon_loss: 2809752.3144; train_gene_expr_recon_loss: 13770918.0455; train_masked_gp_l1_reg_loss: 190578.1532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129797.1701; train_chrom_access_recon_loss: 2651870.2841; train_global_loss: 19686528.8182; train_optim_loss: 19686528.8182; val_kl_reg_loss: 132325.6436; val_edge_recon_loss: 2843069.3750; val_gene_expr_recon_loss: 14203672.1250; val_masked_gp_l1_reg_loss: 191229.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130152.2031; val_chrom_access_recon_loss: 2720041.0312; val_global_loss: 20220490.2500; val_optim_loss: 20220490.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9251; val_auprc_score: 0.8947; val_best_acc_score: 0.8630; val_best_f1_score: 0.8724; train_kl_reg_loss: 131069.6082; train_edge_recon_loss: 2798426.1326; train_gene_expr_recon_loss: 13739148.0455; train_masked_gp_l1_reg_loss: 191323.3475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129997.8181; train_chrom_access_recon_loss: 2643524.4394; train_global_loss: 19633489.3939; train_optim_loss: 19633489.3939; val_kl_reg_loss: 127581.7861; val_edge_recon_loss: 2808872.9375; val_gene_expr_recon_loss: 14099475.3750; val_masked_gp_l1_reg_loss: 191865.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130369.2344; val_chrom_access_recon_loss: 2693169.5312; val_global_loss: 20051335.5000; val_optim_loss: 20051335.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9210; val_auprc_score: 0.8903; val_best_acc_score: 0.8579; val_best_f1_score: 0.8692; train_kl_reg_loss: 131748.2229; train_edge_recon_loss: 2791076.9735; train_gene_expr_recon_loss: 13702139.7727; train_masked_gp_l1_reg_loss: 192197.9482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129820.9897; train_chrom_access_recon_loss: 2634594.9432; train_global_loss: 19581578.8788; train_optim_loss: 19581578.8788; val_kl_reg_loss: 133081.3359; val_edge_recon_loss: 2834611.9688; val_gene_expr_recon_loss: 14028092.5000; val_masked_gp_l1_reg_loss: 192684.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130345.5938; val_chrom_access_recon_loss: 2668001.3125; val_global_loss: 19986817.5000; val_optim_loss: 19986817.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9233; val_auprc_score: 0.8946; val_best_acc_score: 0.8643; val_best_f1_score: 0.8733; train_kl_reg_loss: 131733.6935; train_edge_recon_loss: 2792279.1667; train_gene_expr_recon_loss: 13674650.7273; train_masked_gp_l1_reg_loss: 192922.6849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129933.9644; train_chrom_access_recon_loss: 2629903.2159; train_global_loss: 19551423.6061; train_optim_loss: 19551423.6061; val_kl_reg_loss: 131450.3740; val_edge_recon_loss: 2838820.5312; val_gene_expr_recon_loss: 13970673.2500; val_masked_gp_l1_reg_loss: 193118.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129477.2031; val_chrom_access_recon_loss: 2668788.9062; val_global_loss: 19932329.0000; val_optim_loss: 19932329.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9320; val_auprc_score: 0.9107; val_best_acc_score: 0.8729; val_best_f1_score: 0.8813; train_kl_reg_loss: 131636.7586; train_edge_recon_loss: 2791783.1098; train_gene_expr_recon_loss: 13638272.0303; train_masked_gp_l1_reg_loss: 193241.5021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129673.7802; train_chrom_access_recon_loss: 2624003.0530; train_global_loss: 19508610.2727; train_optim_loss: 19508610.2727; val_kl_reg_loss: 132690.1885; val_edge_recon_loss: 2790844.4062; val_gene_expr_recon_loss: 14023002.3750; val_masked_gp_l1_reg_loss: 193856.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129837.0391; val_chrom_access_recon_loss: 2688612.1875; val_global_loss: 19958843.2500; val_optim_loss: 19958843.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9308; val_auprc_score: 0.9118; val_best_acc_score: 0.8614; val_best_f1_score: 0.8695; train_kl_reg_loss: 129186.5572; train_edge_recon_loss: 2781812.7614; train_gene_expr_recon_loss: 13622783.2576; train_masked_gp_l1_reg_loss: 193777.8580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129726.7043; train_chrom_access_recon_loss: 2616567.9545; train_global_loss: 19473855.0303; train_optim_loss: 19473855.0303; val_kl_reg_loss: 130237.7988; val_edge_recon_loss: 2838818.6562; val_gene_expr_recon_loss: 14053539.7500; val_masked_gp_l1_reg_loss: 194117.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129329.7422; val_chrom_access_recon_loss: 2700706.5000; val_global_loss: 20046750.5000; val_optim_loss: 20046750.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9212; val_auprc_score: 0.8909; val_best_acc_score: 0.8659; val_best_f1_score: 0.8743; train_kl_reg_loss: 129938.7456; train_edge_recon_loss: 2768456.2045; train_gene_expr_recon_loss: 13596219.6212; train_masked_gp_l1_reg_loss: 194381.3016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129311.6327; train_chrom_access_recon_loss: 2610416.4015; train_global_loss: 19428724.0909; train_optim_loss: 19428724.0909; val_kl_reg_loss: 130396.1123; val_edge_recon_loss: 2801935.1250; val_gene_expr_recon_loss: 14010710.6250; val_masked_gp_l1_reg_loss: 194965.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129681.2109; val_chrom_access_recon_loss: 2676534.1250; val_global_loss: 19944224.2500; val_optim_loss: 19944224.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9281; val_auprc_score: 0.8970; val_best_acc_score: 0.8726; val_best_f1_score: 0.8799; train_kl_reg_loss: 130396.5007; train_edge_recon_loss: 2784731.6326; train_gene_expr_recon_loss: 13561196.4242; train_masked_gp_l1_reg_loss: 194820.4974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129118.9880; train_chrom_access_recon_loss: 2602572.7841; train_global_loss: 19402836.8182; train_optim_loss: 19402836.8182; val_kl_reg_loss: 132941.0322; val_edge_recon_loss: 2793941.9375; val_gene_expr_recon_loss: 13898286.7500; val_masked_gp_l1_reg_loss: 194841.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129294.7422; val_chrom_access_recon_loss: 2658874.9062; val_global_loss: 19808180.7500; val_optim_loss: 19808180.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9303; val_auprc_score: 0.9031; val_best_acc_score: 0.8716; val_best_f1_score: 0.8795; train_kl_reg_loss: 129013.7894; train_edge_recon_loss: 2775522.9129; train_gene_expr_recon_loss: 13547174.1061; train_masked_gp_l1_reg_loss: 194932.9403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128816.2502; train_chrom_access_recon_loss: 2599314.8826; train_global_loss: 19374774.8182; train_optim_loss: 19374774.8182; val_kl_reg_loss: 134645.5166; val_edge_recon_loss: 2801196.9375; val_gene_expr_recon_loss: 14002617.0000; val_masked_gp_l1_reg_loss: 194877.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128500.7656; val_chrom_access_recon_loss: 2651913.1562; val_global_loss: 19913750.7500; val_optim_loss: 19913750.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9320; val_auprc_score: 0.9063; val_best_acc_score: 0.8710; val_best_f1_score: 0.8784; train_kl_reg_loss: 129477.5732; train_edge_recon_loss: 2769380.7689; train_gene_expr_recon_loss: 13522670.0455; train_masked_gp_l1_reg_loss: 194956.5211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128243.8884; train_chrom_access_recon_loss: 2591707.6515; train_global_loss: 19336436.5455; train_optim_loss: 19336436.5455; val_kl_reg_loss: 132453.1650; val_edge_recon_loss: 2807621.1250; val_gene_expr_recon_loss: 13951788.5000; val_masked_gp_l1_reg_loss: 195221.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128437.6641; val_chrom_access_recon_loss: 2657234.9062; val_global_loss: 19872758.0000; val_optim_loss: 19872758.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9356; val_auprc_score: 0.9097; val_best_acc_score: 0.8759; val_best_f1_score: 0.8823; train_kl_reg_loss: 145541.7354; train_edge_recon_loss: 2836944.4659; train_gene_expr_recon_loss: 13081992.2424; train_masked_gp_l1_reg_loss: 193251.0464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128064.6813; train_chrom_access_recon_loss: 2527633.4053; train_global_loss: 18913427.6364; train_optim_loss: 18913427.6364; val_kl_reg_loss: 83755.9033; val_edge_recon_loss: 2829487.1875; val_gene_expr_recon_loss: 13613848.8750; val_masked_gp_l1_reg_loss: 193120.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128786.6250; val_chrom_access_recon_loss: 2600034.3750; val_global_loss: 19449032.7500; val_optim_loss: 19449032.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9342; val_auprc_score: 0.9091; val_best_acc_score: 0.8718; val_best_f1_score: 0.8773; train_kl_reg_loss: 138365.3453; train_edge_recon_loss: 2792114.8826; train_gene_expr_recon_loss: 13029687.4848; train_masked_gp_l1_reg_loss: 193393.6357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128757.9590; train_chrom_access_recon_loss: 2494667.4432; train_global_loss: 18776986.5455; train_optim_loss: 18776986.5455; val_kl_reg_loss: 94993.9238; val_edge_recon_loss: 2806581.6250; val_gene_expr_recon_loss: 13403688.5000; val_masked_gp_l1_reg_loss: 193384.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128597.6250; val_chrom_access_recon_loss: 2541293.6875; val_global_loss: 19168540.0000; val_optim_loss: 19168540.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9293; val_auprc_score: 0.9008; val_best_acc_score: 0.8740; val_best_f1_score: 0.8803; train_kl_reg_loss: 132247.9415; train_edge_recon_loss: 2768939.5038; train_gene_expr_recon_loss: 13007039.4394; train_masked_gp_l1_reg_loss: 192975.5410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127443.5279; train_chrom_access_recon_loss: 2487635.6818; train_global_loss: 18716281.7273; train_optim_loss: 18716281.7273; val_kl_reg_loss: 100914.6699; val_edge_recon_loss: 2820941.1250; val_gene_expr_recon_loss: 13373048.5000; val_masked_gp_l1_reg_loss: 192495.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127070.9688; val_chrom_access_recon_loss: 2530793.5312; val_global_loss: 19145264.0000; val_optim_loss: 19145264.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9333; val_auprc_score: 0.8995; val_best_acc_score: 0.8769; val_best_f1_score: 0.8849; train_kl_reg_loss: 123819.7891; train_edge_recon_loss: 2762359.4129; train_gene_expr_recon_loss: 12971678.8788; train_masked_gp_l1_reg_loss: 191846.3696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126507.5305; train_chrom_access_recon_loss: 2477727.9394; train_global_loss: 18653939.9697; train_optim_loss: 18653939.9697; val_kl_reg_loss: 107779.9463; val_edge_recon_loss: 2793211.6250; val_gene_expr_recon_loss: 13477229.7500; val_masked_gp_l1_reg_loss: 191313.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125912.3359; val_chrom_access_recon_loss: 2570769.4375; val_global_loss: 19266217.0000; val_optim_loss: 19266217.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9388; val_auprc_score: 0.9156; val_best_acc_score: 0.8769; val_best_f1_score: 0.8820; train_kl_reg_loss: 122568.4138; train_edge_recon_loss: 2776120.4318; train_gene_expr_recon_loss: 12957364.9091; train_masked_gp_l1_reg_loss: 190444.9770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125601.8658; train_chrom_access_recon_loss: 2474864.5568; train_global_loss: 18646965.2727; train_optim_loss: 18646965.2727; val_kl_reg_loss: 108181.6436; val_edge_recon_loss: 2796572.8750; val_gene_expr_recon_loss: 13444826.1250; val_masked_gp_l1_reg_loss: 189860.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124900.7500; val_chrom_access_recon_loss: 2554234.4062; val_global_loss: 19218575.7500; val_optim_loss: 19218575.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9389; val_auprc_score: 0.9170; val_best_acc_score: 0.8783; val_best_f1_score: 0.8843; train_kl_reg_loss: 120704.8742; train_edge_recon_loss: 2761514.5000; train_gene_expr_recon_loss: 12936412.5909; train_masked_gp_l1_reg_loss: 189054.0438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124711.9575; train_chrom_access_recon_loss: 2469798.5000; train_global_loss: 18602196.4545; train_optim_loss: 18602196.4545; val_kl_reg_loss: 113363.9443; val_edge_recon_loss: 2789678.7188; val_gene_expr_recon_loss: 13357433.6250; val_masked_gp_l1_reg_loss: 188424.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124814.0234; val_chrom_access_recon_loss: 2535322.3125; val_global_loss: 19109037.5000; val_optim_loss: 19109037.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9333; val_auprc_score: 0.9092; val_best_acc_score: 0.8692; val_best_f1_score: 0.8761; train_kl_reg_loss: 120127.1789; train_edge_recon_loss: 2752883.3750; train_gene_expr_recon_loss: 12916091.2727; train_masked_gp_l1_reg_loss: 187800.9912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124386.3619; train_chrom_access_recon_loss: 2466277.3788; train_global_loss: 18567566.5152; train_optim_loss: 18567566.5152; val_kl_reg_loss: 113847.2432; val_edge_recon_loss: 2797431.4375; val_gene_expr_recon_loss: 13461034.8750; val_masked_gp_l1_reg_loss: 187174.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124184.3047; val_chrom_access_recon_loss: 2579657.6875; val_global_loss: 19263329.5000; val_optim_loss: 19263329.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9443; val_auprc_score: 0.9231; val_best_acc_score: 0.8882; val_best_f1_score: 0.8925; train_kl_reg_loss: 118580.2264; train_edge_recon_loss: 2748803.6856; train_gene_expr_recon_loss: 12897629.8939; train_masked_gp_l1_reg_loss: 186646.9616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123714.5392; train_chrom_access_recon_loss: 2460962.5227; train_global_loss: 18536337.9091; train_optim_loss: 18536337.9091; val_kl_reg_loss: 114832.9561; val_edge_recon_loss: 2762729.1250; val_gene_expr_recon_loss: 13353284.1250; val_masked_gp_l1_reg_loss: 186637.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124514.6641; val_chrom_access_recon_loss: 2517706.0938; val_global_loss: 19059705.0000; val_optim_loss: 19059705.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9424; val_auprc_score: 0.9147; val_best_acc_score: 0.8850; val_best_f1_score: 0.8918; train_kl_reg_loss: 119062.3063; train_edge_recon_loss: 2756355.9470; train_gene_expr_recon_loss: 12885167.4091; train_masked_gp_l1_reg_loss: 186010.1162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123456.6987; train_chrom_access_recon_loss: 2456870.7424; train_global_loss: 18526923.2424; train_optim_loss: 18526923.2424; val_kl_reg_loss: 117645.5723; val_edge_recon_loss: 2762419.9688; val_gene_expr_recon_loss: 13093843.6250; val_masked_gp_l1_reg_loss: 185698.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123156.9141; val_chrom_access_recon_loss: 2496170.5938; val_global_loss: 18778934.7500; val_optim_loss: 18778934.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9478; val_auprc_score: 0.9252; val_best_acc_score: 0.8920; val_best_f1_score: 0.8970; train_kl_reg_loss: 121283.2274; train_edge_recon_loss: 2746759.6856; train_gene_expr_recon_loss: 12864764.7273; train_masked_gp_l1_reg_loss: 185085.1877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123054.7309; train_chrom_access_recon_loss: 2452275.8485; train_global_loss: 18493223.4545; train_optim_loss: 18493223.4545; val_kl_reg_loss: 121640.6924; val_edge_recon_loss: 2768448.9375; val_gene_expr_recon_loss: 13422451.5000; val_masked_gp_l1_reg_loss: 184719.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123237.0625; val_chrom_access_recon_loss: 2544947.7500; val_global_loss: 19165445.2500; val_optim_loss: 19165445.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9399; val_auprc_score: 0.9132; val_best_acc_score: 0.8842; val_best_f1_score: 0.8912; train_kl_reg_loss: 119795.0772; train_edge_recon_loss: 2744342.2462; train_gene_expr_recon_loss: 12849144.9091; train_masked_gp_l1_reg_loss: 184430.9029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122861.9976; train_chrom_access_recon_loss: 2447443.3826; train_global_loss: 18468018.5455; train_optim_loss: 18468018.5455; val_kl_reg_loss: 116227.2051; val_edge_recon_loss: 2798855.1875; val_gene_expr_recon_loss: 13253443.7500; val_masked_gp_l1_reg_loss: 184122.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122165.0156; val_chrom_access_recon_loss: 2498814.6562; val_global_loss: 18973628.7500; val_optim_loss: 18973628.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9443; val_auprc_score: 0.9202; val_best_acc_score: 0.8882; val_best_f1_score: 0.8942; train_kl_reg_loss: 117772.9678; train_edge_recon_loss: 2735554.2121; train_gene_expr_recon_loss: 12821913.1212; train_masked_gp_l1_reg_loss: 183937.6233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122567.5147; train_chrom_access_recon_loss: 2442147.0038; train_global_loss: 18423892.6061; train_optim_loss: 18423892.6061; val_kl_reg_loss: 113958.6064; val_edge_recon_loss: 2776870.6562; val_gene_expr_recon_loss: 13136316.2500; val_masked_gp_l1_reg_loss: 184047.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123792.8672; val_chrom_access_recon_loss: 2494443.1250; val_global_loss: 18829428.5000; val_optim_loss: 18829428.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9439; val_auprc_score: 0.9254; val_best_acc_score: 0.8823; val_best_f1_score: 0.8892; train_kl_reg_loss: 117708.4316; train_edge_recon_loss: 2747846.4167; train_gene_expr_recon_loss: 12803930.7121; train_masked_gp_l1_reg_loss: 183772.3447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122588.7920; train_chrom_access_recon_loss: 2435230.1212; train_global_loss: 18411076.8485; train_optim_loss: 18411076.8485; val_kl_reg_loss: 117698.8398; val_edge_recon_loss: 2792121.1875; val_gene_expr_recon_loss: 13251511.7500; val_masked_gp_l1_reg_loss: 183495.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122400.0156; val_chrom_access_recon_loss: 2514081.7812; val_global_loss: 18981308.5000; val_optim_loss: 18981308.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9476; val_auprc_score: 0.9264; val_best_acc_score: 0.8923; val_best_f1_score: 0.8974; train_kl_reg_loss: 119831.2564; train_edge_recon_loss: 2738104.1364; train_gene_expr_recon_loss: 12785025.6970; train_masked_gp_l1_reg_loss: 180478.6908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91340.9962; train_chrom_access_recon_loss: 2431151.8712; train_global_loss: 18345932.5758; train_optim_loss: 18345932.5758; val_kl_reg_loss: 119123.0078; val_edge_recon_loss: 2781934.9688; val_gene_expr_recon_loss: 13208600.2500; val_masked_gp_l1_reg_loss: 179324.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85362.1953; val_chrom_access_recon_loss: 2502170.9062; val_global_loss: 18876515.2500; val_optim_loss: 18876515.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9489; val_auprc_score: 0.9289; val_best_acc_score: 0.8923; val_best_f1_score: 0.8968; train_kl_reg_loss: 119873.5711; train_edge_recon_loss: 2740250.9886; train_gene_expr_recon_loss: 12778820.5909; train_masked_gp_l1_reg_loss: 179071.4676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84975.0935; train_chrom_access_recon_loss: 2430339.2008; train_global_loss: 18333330.7879; train_optim_loss: 18333330.7879; val_kl_reg_loss: 117687.5557; val_edge_recon_loss: 2766107.8750; val_gene_expr_recon_loss: 13104948.8750; val_masked_gp_l1_reg_loss: 178884.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84635.6797; val_chrom_access_recon_loss: 2473654.9688; val_global_loss: 18725919.5000; val_optim_loss: 18725919.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9512; val_auprc_score: 0.9288; val_best_acc_score: 0.9006; val_best_f1_score: 0.9051; train_kl_reg_loss: 119862.4569; train_edge_recon_loss: 2742301.2045; train_gene_expr_recon_loss: 12781547.8182; train_masked_gp_l1_reg_loss: 178800.8977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84454.2121; train_chrom_access_recon_loss: 2431216.9659; train_global_loss: 18338183.4545; train_optim_loss: 18338183.4545; val_kl_reg_loss: 118705.5654; val_edge_recon_loss: 2736447.5312; val_gene_expr_recon_loss: 13221930.6250; val_masked_gp_l1_reg_loss: 178705.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84159.6094; val_chrom_access_recon_loss: 2513737.0000; val_global_loss: 18853685.7500; val_optim_loss: 18853685.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9513; val_auprc_score: 0.9349; val_best_acc_score: 0.8912; val_best_f1_score: 0.8966; train_kl_reg_loss: 121159.7744; train_edge_recon_loss: 2734519.2083; train_gene_expr_recon_loss: 12778876.8485; train_masked_gp_l1_reg_loss: 178653.1560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84060.0810; train_chrom_access_recon_loss: 2428857.0114; train_global_loss: 18326126.1212; train_optim_loss: 18326126.1212; val_kl_reg_loss: 119251.5420; val_edge_recon_loss: 2769988.0000; val_gene_expr_recon_loss: 13205908.2500; val_masked_gp_l1_reg_loss: 178594.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83967.1953; val_chrom_access_recon_loss: 2494680.4688; val_global_loss: 18852390.2500; val_optim_loss: 18852390.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9502; val_auprc_score: 0.9282; val_best_acc_score: 0.8966; val_best_f1_score: 0.9014; train_kl_reg_loss: 121299.2836; train_edge_recon_loss: 2737813.1174; train_gene_expr_recon_loss: 12773736.0455; train_masked_gp_l1_reg_loss: 178566.2143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83922.8150; train_chrom_access_recon_loss: 2428075.9621; train_global_loss: 18323413.3030; train_optim_loss: 18323413.3030; val_kl_reg_loss: 120059.0176; val_edge_recon_loss: 2757505.0938; val_gene_expr_recon_loss: 13309989.0000; val_masked_gp_l1_reg_loss: 178542.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83890.2812; val_chrom_access_recon_loss: 2533117.0625; val_global_loss: 18983102.0000; val_optim_loss: 18983102.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9443; val_auprc_score: 0.9179; val_best_acc_score: 0.8901; val_best_f1_score: 0.8962; train_kl_reg_loss: 121397.5811; train_edge_recon_loss: 2730162.5455; train_gene_expr_recon_loss: 12776519.6061; train_masked_gp_l1_reg_loss: 178465.0966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83654.3045; train_chrom_access_recon_loss: 2428049.1326; train_global_loss: 18318248.2121; train_optim_loss: 18318248.2121; val_kl_reg_loss: 119133.3740; val_edge_recon_loss: 2780658.9375; val_gene_expr_recon_loss: 13145138.1250; val_masked_gp_l1_reg_loss: 178449.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83602.0469; val_chrom_access_recon_loss: 2492292.4688; val_global_loss: 18799274.0000; val_optim_loss: 18799274.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9456; val_auprc_score: 0.9228; val_best_acc_score: 0.8877; val_best_f1_score: 0.8929; train_kl_reg_loss: 121650.2495; train_edge_recon_loss: 2748539.4356; train_gene_expr_recon_loss: 12776751.6970; train_masked_gp_l1_reg_loss: 178149.1364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80197.6154; train_chrom_access_recon_loss: 2428246.5644; train_global_loss: 18333534.5758; train_optim_loss: 18333534.5758; val_kl_reg_loss: 119206.0039; val_edge_recon_loss: 2798737.8438; val_gene_expr_recon_loss: 13214195.6250; val_masked_gp_l1_reg_loss: 178019.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79534.8047; val_chrom_access_recon_loss: 2504466.6562; val_global_loss: 18894160.0000; val_optim_loss: 18894160.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9487; val_auprc_score: 0.9270; val_best_acc_score: 0.8933; val_best_f1_score: 0.8985; train_kl_reg_loss: 121477.0650; train_edge_recon_loss: 2738922.2765; train_gene_expr_recon_loss: 12771079.5303; train_masked_gp_l1_reg_loss: 177977.8331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79484.5178; train_chrom_access_recon_loss: 2426120.6515; train_global_loss: 18315061.7576; train_optim_loss: 18315061.7576; val_kl_reg_loss: 120259.5146; val_edge_recon_loss: 2756739.1250; val_gene_expr_recon_loss: 13261532.0000; val_masked_gp_l1_reg_loss: 177943.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79435.3203; val_chrom_access_recon_loss: 2503833.0000; val_global_loss: 18899743.2500; val_optim_loss: 18899743.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9507; val_auprc_score: 0.9322; val_best_acc_score: 0.8907; val_best_f1_score: 0.8961; train_kl_reg_loss: 121803.3320; train_edge_recon_loss: 2733476.3939; train_gene_expr_recon_loss: 12772262.9091; train_masked_gp_l1_reg_loss: 177922.4974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79399.2911; train_chrom_access_recon_loss: 2428102.2689; train_global_loss: 18312966.5758; train_optim_loss: 18312966.5758; val_kl_reg_loss: 120059.6377; val_edge_recon_loss: 2772876.5625; val_gene_expr_recon_loss: 13216615.2500; val_masked_gp_l1_reg_loss: 177904.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79365.2188; val_chrom_access_recon_loss: 2498925.9062; val_global_loss: 18865746.5000; val_optim_loss: 18865746.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9450; val_auprc_score: 0.9187; val_best_acc_score: 0.8890; val_best_f1_score: 0.8941; train_kl_reg_loss: 121891.4154; train_edge_recon_loss: 2741498.2500; train_gene_expr_recon_loss: 12774833.1667; train_masked_gp_l1_reg_loss: 177893.7758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79362.2656; train_chrom_access_recon_loss: 2426997.8409; train_global_loss: 18322476.6364; train_optim_loss: 18322476.6364; val_kl_reg_loss: 119956.0244; val_edge_recon_loss: 2765466.0938; val_gene_expr_recon_loss: 13284345.3750; val_masked_gp_l1_reg_loss: 177876.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79331.1484; val_chrom_access_recon_loss: 2503468.8750; val_global_loss: 18930443.2500; val_optim_loss: 18930443.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 19 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9554
val AUPRC score: 0.9391
val best accuracy score: 0.8968
val best F1 score: 0.9007
val target rna MSE score: 1.0959
val source rna MSE score: 0.4321
val target atac MSE score: 0.3481
val source atac MSE score: 0.0765
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
