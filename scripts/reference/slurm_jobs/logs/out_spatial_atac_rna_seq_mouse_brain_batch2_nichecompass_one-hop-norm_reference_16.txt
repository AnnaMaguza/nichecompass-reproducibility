[True]
Run timestamp: 09102023_193711_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6310; val_auprc_score: 0.6083; val_best_acc_score: 0.5059; val_best_f1_score: 0.6685; train_kl_reg_loss: 38015.5827; train_edge_recon_loss: 3516464.2008; train_gene_expr_recon_loss: 14200437.4394; train_masked_gp_l1_reg_loss: 137118.3404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4680886.0871; train_chrom_access_recon_loss: 2335895.2083; train_global_loss: 24908816.7273; train_optim_loss: 24908816.7273; val_kl_reg_loss: 82222.6875; val_edge_recon_loss: 4064688.5625; val_gene_expr_recon_loss: 13050427.7500; val_masked_gp_l1_reg_loss: 114973.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2322379.7500; val_chrom_access_recon_loss: 2253087.1250; val_global_loss: 21887780.2500; val_optim_loss: 21887780.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6693; val_auprc_score: 0.6508; val_best_acc_score: 0.5868; val_best_f1_score: 0.6919; train_kl_reg_loss: 84232.9850; train_edge_recon_loss: 3515820.2841; train_gene_expr_recon_loss: 12845372.6364; train_masked_gp_l1_reg_loss: 107591.8922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1139089.9157; train_chrom_access_recon_loss: 2213167.8958; train_global_loss: 19905275.5455; train_optim_loss: 19905275.5455; val_kl_reg_loss: 86711.7861; val_edge_recon_loss: 4059607.7500; val_gene_expr_recon_loss: 12691386.3750; val_masked_gp_l1_reg_loss: 104210.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 478282.9375; val_chrom_access_recon_loss: 2216353.3750; val_global_loss: 19636551.5000; val_optim_loss: 19636551.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7092; val_auprc_score: 0.6952; val_best_acc_score: 0.6392; val_best_f1_score: 0.6933; train_kl_reg_loss: 84912.7983; train_edge_recon_loss: 3514930.7689; train_gene_expr_recon_loss: 12661819.8030; train_masked_gp_l1_reg_loss: 103940.2028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 307436.0367; train_chrom_access_recon_loss: 2192070.3277; train_global_loss: 18865109.9697; train_optim_loss: 18865109.9697; val_kl_reg_loss: 81863.7549; val_edge_recon_loss: 4052932.3438; val_gene_expr_recon_loss: 12764414.0000; val_masked_gp_l1_reg_loss: 104256.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 204921.9219; val_chrom_access_recon_loss: 2212956.6250; val_global_loss: 19421345.0000; val_optim_loss: 19421345.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7857; val_auprc_score: 0.7636; val_best_acc_score: 0.6771; val_best_f1_score: 0.7350; train_kl_reg_loss: 78944.5410; train_edge_recon_loss: 3508202.2273; train_gene_expr_recon_loss: 12572302.6970; train_masked_gp_l1_reg_loss: 104687.6528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165711.2353; train_chrom_access_recon_loss: 2179842.3428; train_global_loss: 18609690.7576; train_optim_loss: 18609690.7576; val_kl_reg_loss: 66091.5322; val_edge_recon_loss: 3978897.5625; val_gene_expr_recon_loss: 12518876.8750; val_masked_gp_l1_reg_loss: 105285.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136927.4688; val_chrom_access_recon_loss: 2192433.0938; val_global_loss: 18998511.5000; val_optim_loss: 18998511.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8325; val_auprc_score: 0.8038; val_best_acc_score: 0.7585; val_best_f1_score: 0.7808; train_kl_reg_loss: 63366.4483; train_edge_recon_loss: 3392433.4129; train_gene_expr_recon_loss: 12504854.6515; train_masked_gp_l1_reg_loss: 107973.1520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123642.7544; train_chrom_access_recon_loss: 2169631.5795; train_global_loss: 18361902.0303; train_optim_loss: 18361902.0303; val_kl_reg_loss: 71727.3320; val_edge_recon_loss: 3150628.7188; val_gene_expr_recon_loss: 12447249.7500; val_masked_gp_l1_reg_loss: 113517.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114326.6953; val_chrom_access_recon_loss: 2185007.4531; val_global_loss: 18082457.2500; val_optim_loss: 18082457.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8626; val_auprc_score: 0.8218; val_best_acc_score: 0.7947; val_best_f1_score: 0.8098; train_kl_reg_loss: 81159.1887; train_edge_recon_loss: 3001411.6932; train_gene_expr_recon_loss: 12464831.1818; train_masked_gp_l1_reg_loss: 121010.7371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111000.4955; train_chrom_access_recon_loss: 2163440.6534; train_global_loss: 17942854.0606; train_optim_loss: 17942854.0606; val_kl_reg_loss: 93113.2393; val_edge_recon_loss: 2960322.7188; val_gene_expr_recon_loss: 12433005.3750; val_masked_gp_l1_reg_loss: 123136.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106535.8438; val_chrom_access_recon_loss: 2169378.4375; val_global_loss: 17885492.0000; val_optim_loss: 17885492.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8809; val_auprc_score: 0.8429; val_best_acc_score: 0.8203; val_best_f1_score: 0.8335; train_kl_reg_loss: 99528.1014; train_edge_recon_loss: 2892289.1667; train_gene_expr_recon_loss: 12362119.4091; train_masked_gp_l1_reg_loss: 124241.9777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102975.0284; train_chrom_access_recon_loss: 2146318.2292; train_global_loss: 17727471.8788; train_optim_loss: 17727471.8788; val_kl_reg_loss: 99347.0938; val_edge_recon_loss: 2884878.5625; val_gene_expr_recon_loss: 12297530.2500; val_masked_gp_l1_reg_loss: 125204.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98312.1094; val_chrom_access_recon_loss: 2149638.1719; val_global_loss: 17654911.2500; val_optim_loss: 17654911.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8862; val_auprc_score: 0.8491; val_best_acc_score: 0.8262; val_best_f1_score: 0.8406; train_kl_reg_loss: 104897.6869; train_edge_recon_loss: 2846923.7652; train_gene_expr_recon_loss: 12313812.0758; train_masked_gp_l1_reg_loss: 126124.1071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94652.6140; train_chrom_access_recon_loss: 2140154.7860; train_global_loss: 17626564.9848; train_optim_loss: 17626564.9848; val_kl_reg_loss: 103843.5869; val_edge_recon_loss: 2864550.1250; val_gene_expr_recon_loss: 12235232.7500; val_masked_gp_l1_reg_loss: 127038.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91816.3594; val_chrom_access_recon_loss: 2156088.2500; val_global_loss: 17578569.7500; val_optim_loss: 17578569.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8977; val_auprc_score: 0.8716; val_best_acc_score: 0.8318; val_best_f1_score: 0.8453; train_kl_reg_loss: 105978.3284; train_edge_recon_loss: 2844762.9621; train_gene_expr_recon_loss: 12251684.2424; train_masked_gp_l1_reg_loss: 127637.2559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90157.4953; train_chrom_access_recon_loss: 2128734.8390; train_global_loss: 17548955.0606; train_optim_loss: 17548955.0606; val_kl_reg_loss: 105836.1035; val_edge_recon_loss: 2835217.9062; val_gene_expr_recon_loss: 12107296.7500; val_masked_gp_l1_reg_loss: 128533.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89373.9297; val_chrom_access_recon_loss: 2123855.3125; val_global_loss: 17390113.0000; val_optim_loss: 17390113.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9055; val_auprc_score: 0.8758; val_best_acc_score: 0.8420; val_best_f1_score: 0.8515; train_kl_reg_loss: 103031.0966; train_edge_recon_loss: 2832077.7348; train_gene_expr_recon_loss: 12194286.4394; train_masked_gp_l1_reg_loss: 128765.4096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88419.5988; train_chrom_access_recon_loss: 2119639.6648; train_global_loss: 17466219.8485; train_optim_loss: 17466219.8485; val_kl_reg_loss: 104856.8008; val_edge_recon_loss: 2850541.3750; val_gene_expr_recon_loss: 12244191.8750; val_masked_gp_l1_reg_loss: 129342.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87876.6797; val_chrom_access_recon_loss: 2162875.2969; val_global_loss: 17579684.0000; val_optim_loss: 17579684.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9054; val_auprc_score: 0.8822; val_best_acc_score: 0.8364; val_best_f1_score: 0.8493; train_kl_reg_loss: 104047.3748; train_edge_recon_loss: 2802696.6326; train_gene_expr_recon_loss: 12150886.8030; train_masked_gp_l1_reg_loss: 129604.5070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87864.1070; train_chrom_access_recon_loss: 2113460.0246; train_global_loss: 17388559.4242; train_optim_loss: 17388559.4242; val_kl_reg_loss: 105917.6475; val_edge_recon_loss: 2806998.0000; val_gene_expr_recon_loss: 12118053.5000; val_masked_gp_l1_reg_loss: 129974.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87563.3750; val_chrom_access_recon_loss: 2121447.6562; val_global_loss: 17369954.7500; val_optim_loss: 17369954.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9125; val_auprc_score: 0.8883; val_best_acc_score: 0.8512; val_best_f1_score: 0.8582; train_kl_reg_loss: 104387.5732; train_edge_recon_loss: 2808719.2955; train_gene_expr_recon_loss: 12097068.9697; train_masked_gp_l1_reg_loss: 130082.6151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86614.4196; train_chrom_access_recon_loss: 2103904.8845; train_global_loss: 17330777.6818; train_optim_loss: 17330777.6818; val_kl_reg_loss: 103779.8740; val_edge_recon_loss: 2826200.1875; val_gene_expr_recon_loss: 11967474.5000; val_masked_gp_l1_reg_loss: 130383.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85933.6094; val_chrom_access_recon_loss: 2107331.6094; val_global_loss: 17221103.2500; val_optim_loss: 17221103.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9066; val_auprc_score: 0.8744; val_best_acc_score: 0.8482; val_best_f1_score: 0.8589; train_kl_reg_loss: 101071.1907; train_edge_recon_loss: 2786753.0000; train_gene_expr_recon_loss: 12059250.0455; train_masked_gp_l1_reg_loss: 130505.2733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84940.8868; train_chrom_access_recon_loss: 2100634.8750; train_global_loss: 17263155.2576; train_optim_loss: 17263155.2576; val_kl_reg_loss: 100030.0576; val_edge_recon_loss: 2817356.4688; val_gene_expr_recon_loss: 12006464.1250; val_masked_gp_l1_reg_loss: 131011.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84723.2188; val_chrom_access_recon_loss: 2083087.4375; val_global_loss: 17222673.0000; val_optim_loss: 17222673.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9076; val_auprc_score: 0.8731; val_best_acc_score: 0.8458; val_best_f1_score: 0.8585; train_kl_reg_loss: 100183.8924; train_edge_recon_loss: 2786398.9621; train_gene_expr_recon_loss: 12033769.8939; train_masked_gp_l1_reg_loss: 130830.9298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83654.4280; train_chrom_access_recon_loss: 2096721.9564; train_global_loss: 17231559.9242; train_optim_loss: 17231559.9242; val_kl_reg_loss: 96889.1201; val_edge_recon_loss: 2829416.1562; val_gene_expr_recon_loss: 12038278.1250; val_masked_gp_l1_reg_loss: 131277.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83058.7031; val_chrom_access_recon_loss: 2118931.7812; val_global_loss: 17297851.0000; val_optim_loss: 17297851.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9077; val_auprc_score: 0.8787; val_best_acc_score: 0.8450; val_best_f1_score: 0.8558; train_kl_reg_loss: 98995.9755; train_edge_recon_loss: 2782847.6780; train_gene_expr_recon_loss: 11984635.5000; train_masked_gp_l1_reg_loss: 131306.3487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82235.4379; train_chrom_access_recon_loss: 2085412.8712; train_global_loss: 17165433.6818; train_optim_loss: 17165433.6818; val_kl_reg_loss: 99102.6006; val_edge_recon_loss: 2856549.0938; val_gene_expr_recon_loss: 11958682.7500; val_masked_gp_l1_reg_loss: 131110.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81176.8984; val_chrom_access_recon_loss: 2125149.2031; val_global_loss: 17251771.0000; val_optim_loss: 17251771.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8982; val_auprc_score: 0.8672; val_best_acc_score: 0.8388; val_best_f1_score: 0.8507; train_kl_reg_loss: 97874.1229; train_edge_recon_loss: 2781928.3977; train_gene_expr_recon_loss: 11953716.3636; train_masked_gp_l1_reg_loss: 131431.9858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80735.6803; train_chrom_access_recon_loss: 2081437.6856; train_global_loss: 17127124.2727; train_optim_loss: 17127124.2727; val_kl_reg_loss: 91722.9131; val_edge_recon_loss: 2901479.5000; val_gene_expr_recon_loss: 11878253.2500; val_masked_gp_l1_reg_loss: 131550.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80156.7656; val_chrom_access_recon_loss: 2081867.3125; val_global_loss: 17165029.7500; val_optim_loss: 17165029.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9118; val_auprc_score: 0.8796; val_best_acc_score: 0.8493; val_best_f1_score: 0.8576; train_kl_reg_loss: 95702.8249; train_edge_recon_loss: 2777632.3371; train_gene_expr_recon_loss: 11923876.2273; train_masked_gp_l1_reg_loss: 131568.8885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79884.6319; train_chrom_access_recon_loss: 2074985.6212; train_global_loss: 17083650.6061; train_optim_loss: 17083650.6061; val_kl_reg_loss: 95757.7705; val_edge_recon_loss: 2836677.4688; val_gene_expr_recon_loss: 11875706.7500; val_masked_gp_l1_reg_loss: 131974.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79020.6406; val_chrom_access_recon_loss: 2093577.1250; val_global_loss: 17112713.8750; val_optim_loss: 17112713.8750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9213; val_auprc_score: 0.9016; val_best_acc_score: 0.8557; val_best_f1_score: 0.8654; train_kl_reg_loss: 95378.9750; train_edge_recon_loss: 2782877.6970; train_gene_expr_recon_loss: 11893913.2879; train_masked_gp_l1_reg_loss: 132326.4216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78926.9690; train_chrom_access_recon_loss: 2070291.8163; train_global_loss: 17053715.1818; train_optim_loss: 17053715.1818; val_kl_reg_loss: 92043.1094; val_edge_recon_loss: 2816013.2812; val_gene_expr_recon_loss: 11821582.3750; val_masked_gp_l1_reg_loss: 132318.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78366.7891; val_chrom_access_recon_loss: 2079414.3125; val_global_loss: 17019738.1250; val_optim_loss: 17019738.1250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9164; val_auprc_score: 0.8971; val_best_acc_score: 0.8495; val_best_f1_score: 0.8563; train_kl_reg_loss: 95475.9994; train_edge_recon_loss: 2772528.8220; train_gene_expr_recon_loss: 11869745.5455; train_masked_gp_l1_reg_loss: 132462.2214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77931.5999; train_chrom_access_recon_loss: 2065905.0606; train_global_loss: 17014049.2273; train_optim_loss: 17014049.2273; val_kl_reg_loss: 98630.2002; val_edge_recon_loss: 2805350.1875; val_gene_expr_recon_loss: 11784596.7500; val_masked_gp_l1_reg_loss: 132637.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77830.7812; val_chrom_access_recon_loss: 2096068.7344; val_global_loss: 16995113.6250; val_optim_loss: 16995113.6250
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9166; val_auprc_score: 0.8868; val_best_acc_score: 0.8493; val_best_f1_score: 0.8604; train_kl_reg_loss: 94267.4585; train_edge_recon_loss: 2768591.1250; train_gene_expr_recon_loss: 11851862.3788; train_masked_gp_l1_reg_loss: 132763.3899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77607.7791; train_chrom_access_recon_loss: 2061792.0909; train_global_loss: 16986884.1970; train_optim_loss: 16986884.1970; val_kl_reg_loss: 92811.2354; val_edge_recon_loss: 2808672.6875; val_gene_expr_recon_loss: 11927480.6250; val_masked_gp_l1_reg_loss: 133093.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78023.9141; val_chrom_access_recon_loss: 2095534.2031; val_global_loss: 17135616.7500; val_optim_loss: 17135616.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9198; val_auprc_score: 0.8969; val_best_acc_score: 0.8530; val_best_f1_score: 0.8636; train_kl_reg_loss: 95221.3338; train_edge_recon_loss: 2746631.1894; train_gene_expr_recon_loss: 11824650.4394; train_masked_gp_l1_reg_loss: 132899.9482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77412.9470; train_chrom_access_recon_loss: 2056914.0947; train_global_loss: 16933730.0606; train_optim_loss: 16933730.0606; val_kl_reg_loss: 93529.9756; val_edge_recon_loss: 2810835.8750; val_gene_expr_recon_loss: 11795736.7500; val_masked_gp_l1_reg_loss: 133081.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77831.7891; val_chrom_access_recon_loss: 2068741.6875; val_global_loss: 16979757.1250; val_optim_loss: 16979757.1250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9160; val_auprc_score: 0.8862; val_best_acc_score: 0.8565; val_best_f1_score: 0.8663; train_kl_reg_loss: 94042.0697; train_edge_recon_loss: 2747607.0417; train_gene_expr_recon_loss: 11796864.8182; train_masked_gp_l1_reg_loss: 133287.1522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77465.6300; train_chrom_access_recon_loss: 2050731.3314; train_global_loss: 16899997.8788; train_optim_loss: 16899997.8788; val_kl_reg_loss: 97035.5439; val_edge_recon_loss: 2819836.3438; val_gene_expr_recon_loss: 11773571.8750; val_masked_gp_l1_reg_loss: 133289.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77534.5234; val_chrom_access_recon_loss: 2081433.6562; val_global_loss: 16982702.1250; val_optim_loss: 16982702.1250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9195; val_auprc_score: 0.8950; val_best_acc_score: 0.8514; val_best_f1_score: 0.8589; train_kl_reg_loss: 94442.5336; train_edge_recon_loss: 2757698.2273; train_gene_expr_recon_loss: 11768887.2273; train_masked_gp_l1_reg_loss: 133334.7375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77727.4667; train_chrom_access_recon_loss: 2047450.7538; train_global_loss: 16879540.9545; train_optim_loss: 16879540.9545; val_kl_reg_loss: 92673.0654; val_edge_recon_loss: 2812594.1875; val_gene_expr_recon_loss: 11692530.1250; val_masked_gp_l1_reg_loss: 133380.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78349.1953; val_chrom_access_recon_loss: 2047130.1406; val_global_loss: 16856656.7500; val_optim_loss: 16856656.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9278; val_auprc_score: 0.9024; val_best_acc_score: 0.8635; val_best_f1_score: 0.8719; train_kl_reg_loss: 92214.9941; train_edge_recon_loss: 2753514.7159; train_gene_expr_recon_loss: 11740572.0758; train_masked_gp_l1_reg_loss: 133454.8094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78305.6403; train_chrom_access_recon_loss: 2041919.8617; train_global_loss: 16839982.1061; train_optim_loss: 16839982.1061; val_kl_reg_loss: 94868.6123; val_edge_recon_loss: 2776555.6250; val_gene_expr_recon_loss: 11840152.6250; val_masked_gp_l1_reg_loss: 133543.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78320.0234; val_chrom_access_recon_loss: 2072092.7031; val_global_loss: 16995533.8750; val_optim_loss: 16995533.8750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9284; val_auprc_score: 0.9056; val_best_acc_score: 0.8710; val_best_f1_score: 0.8781; train_kl_reg_loss: 92884.9026; train_edge_recon_loss: 2739331.7538; train_gene_expr_recon_loss: 11721073.4697; train_masked_gp_l1_reg_loss: 133572.4384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78890.7386; train_chrom_access_recon_loss: 2038133.6364; train_global_loss: 16803886.9848; train_optim_loss: 16803886.9848; val_kl_reg_loss: 91674.1289; val_edge_recon_loss: 2764292.8750; val_gene_expr_recon_loss: 11701706.6250; val_masked_gp_l1_reg_loss: 133655.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79262.6719; val_chrom_access_recon_loss: 2042058.1094; val_global_loss: 16812651.1250; val_optim_loss: 16812651.1250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9272; val_auprc_score: 0.9027; val_best_acc_score: 0.8619; val_best_f1_score: 0.8699; train_kl_reg_loss: 125591.3198; train_edge_recon_loss: 2899242.5227; train_gene_expr_recon_loss: 10669182.8030; train_masked_gp_l1_reg_loss: 134589.0573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77001.3349; train_chrom_access_recon_loss: 1891742.2481; train_global_loss: 15797349.3485; train_optim_loss: 15797349.3485; val_kl_reg_loss: 32728.2732; val_edge_recon_loss: 2852356.1250; val_gene_expr_recon_loss: 10667314.6250; val_masked_gp_l1_reg_loss: 135066.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78501.4297; val_chrom_access_recon_loss: 1890709.0000; val_global_loss: 15656676.0000; val_optim_loss: 15656676.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9198; val_auprc_score: 0.8914; val_best_acc_score: 0.8538; val_best_f1_score: 0.8656; train_kl_reg_loss: 95926.0414; train_edge_recon_loss: 2776194.1174; train_gene_expr_recon_loss: 10605901.2727; train_masked_gp_l1_reg_loss: 133836.8878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79217.1900; train_chrom_access_recon_loss: 1861097.9034; train_global_loss: 15552173.3939; train_optim_loss: 15552173.3939; val_kl_reg_loss: 44027.4097; val_edge_recon_loss: 2799658.3750; val_gene_expr_recon_loss: 10630388.7500; val_masked_gp_l1_reg_loss: 132478.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79498.3516; val_chrom_access_recon_loss: 1899927.5000; val_global_loss: 15585979.1250; val_optim_loss: 15585979.1250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9256; val_auprc_score: 0.8970; val_best_acc_score: 0.8635; val_best_f1_score: 0.8713; train_kl_reg_loss: 77245.8266; train_edge_recon_loss: 2766088.7576; train_gene_expr_recon_loss: 10569384.3636; train_masked_gp_l1_reg_loss: 130756.9277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79289.1487; train_chrom_access_recon_loss: 1855690.8883; train_global_loss: 15478455.9697; train_optim_loss: 15478455.9697; val_kl_reg_loss: 50470.6396; val_edge_recon_loss: 2799434.9375; val_gene_expr_recon_loss: 10589544.0000; val_masked_gp_l1_reg_loss: 128967.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78800.7422; val_chrom_access_recon_loss: 1876356.2500; val_global_loss: 15523573.8750; val_optim_loss: 15523573.8750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9284; val_auprc_score: 0.9060; val_best_acc_score: 0.8638; val_best_f1_score: 0.8721; train_kl_reg_loss: 72428.4785; train_edge_recon_loss: 2748609.2841; train_gene_expr_recon_loss: 10557412.8939; train_masked_gp_l1_reg_loss: 127073.9873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78648.8074; train_chrom_access_recon_loss: 1853574.7652; train_global_loss: 15437748.2879; train_optim_loss: 15437748.2879; val_kl_reg_loss: 53879.8950; val_edge_recon_loss: 2765554.5312; val_gene_expr_recon_loss: 10545376.3750; val_masked_gp_l1_reg_loss: 125389.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78634.2969; val_chrom_access_recon_loss: 1855095.1406; val_global_loss: 15423929.8750; val_optim_loss: 15423929.8750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9254; val_auprc_score: 0.8961; val_best_acc_score: 0.8649; val_best_f1_score: 0.8741; train_kl_reg_loss: 71653.1538; train_edge_recon_loss: 2736414.5720; train_gene_expr_recon_loss: 10529457.3030; train_masked_gp_l1_reg_loss: 123690.3005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78186.8198; train_chrom_access_recon_loss: 1846618.2614; train_global_loss: 15386020.4545; train_optim_loss: 15386020.4545; val_kl_reg_loss: 62199.0498; val_edge_recon_loss: 2761003.4062; val_gene_expr_recon_loss: 10494748.1250; val_masked_gp_l1_reg_loss: 122043.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77737.7188; val_chrom_access_recon_loss: 1854504.7656; val_global_loss: 15372237.2500; val_optim_loss: 15372237.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9281; val_auprc_score: 0.9042; val_best_acc_score: 0.8654; val_best_f1_score: 0.8746; train_kl_reg_loss: 71960.9124; train_edge_recon_loss: 2719673.2689; train_gene_expr_recon_loss: 10505702.5303; train_masked_gp_l1_reg_loss: 120614.8419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77447.1352; train_chrom_access_recon_loss: 1841386.6875; train_global_loss: 15336785.1970; train_optim_loss: 15336785.1970; val_kl_reg_loss: 61801.8354; val_edge_recon_loss: 2747585.2188; val_gene_expr_recon_loss: 10524962.6250; val_masked_gp_l1_reg_loss: 119365.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77336.3672; val_chrom_access_recon_loss: 1860669.3438; val_global_loss: 15391721.1250; val_optim_loss: 15391721.1250
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9264; val_auprc_score: 0.9002; val_best_acc_score: 0.8684; val_best_f1_score: 0.8770; train_kl_reg_loss: 68818.3619; train_edge_recon_loss: 2720893.7348; train_gene_expr_recon_loss: 10499876.1212; train_masked_gp_l1_reg_loss: 118371.1042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77077.9929; train_chrom_access_recon_loss: 1840192.3769; train_global_loss: 15325229.7273; train_optim_loss: 15325229.7273; val_kl_reg_loss: 60914.0332; val_edge_recon_loss: 2774873.6562; val_gene_expr_recon_loss: 10436373.8750; val_masked_gp_l1_reg_loss: 117517.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76750.4219; val_chrom_access_recon_loss: 1842984.4844; val_global_loss: 15309413.1250; val_optim_loss: 15309413.1250
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9343; val_auprc_score: 0.9081; val_best_acc_score: 0.8748; val_best_f1_score: 0.8805; train_kl_reg_loss: 67692.8200; train_edge_recon_loss: 2730840.2917; train_gene_expr_recon_loss: 10485052.9091; train_masked_gp_l1_reg_loss: 116713.3108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76809.6483; train_chrom_access_recon_loss: 1839623.9148; train_global_loss: 15316732.8030; train_optim_loss: 15316732.8030; val_kl_reg_loss: 62937.2236; val_edge_recon_loss: 2753824.2188; val_gene_expr_recon_loss: 10478043.0000; val_masked_gp_l1_reg_loss: 116042.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76264.7422; val_chrom_access_recon_loss: 1836723.2812; val_global_loss: 15323835.8750; val_optim_loss: 15323835.8750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9395; val_auprc_score: 0.9211; val_best_acc_score: 0.8767; val_best_f1_score: 0.8822; train_kl_reg_loss: 69097.8333; train_edge_recon_loss: 2712317.8750; train_gene_expr_recon_loss: 10477729.1970; train_masked_gp_l1_reg_loss: 115292.2496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75741.3408; train_chrom_access_recon_loss: 1836768.7879; train_global_loss: 15286947.3788; train_optim_loss: 15286947.3788; val_kl_reg_loss: 66268.1284; val_edge_recon_loss: 2753622.2188; val_gene_expr_recon_loss: 10468489.5000; val_masked_gp_l1_reg_loss: 114541.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74853.0156; val_chrom_access_recon_loss: 1867174.5156; val_global_loss: 15344949.3750; val_optim_loss: 15344949.3750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9352; val_auprc_score: 0.9178; val_best_acc_score: 0.8753; val_best_f1_score: 0.8830; train_kl_reg_loss: 68518.8837; train_edge_recon_loss: 2720351.0417; train_gene_expr_recon_loss: 10451060.5606; train_masked_gp_l1_reg_loss: 113961.3348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74955.3693; train_chrom_access_recon_loss: 1830278.0814; train_global_loss: 15259125.4242; train_optim_loss: 15259125.4242; val_kl_reg_loss: 63285.9155; val_edge_recon_loss: 2748052.2812; val_gene_expr_recon_loss: 10481826.1250; val_masked_gp_l1_reg_loss: 113317.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75108.3750; val_chrom_access_recon_loss: 1862855.3125; val_global_loss: 15344445.5000; val_optim_loss: 15344445.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9344; val_auprc_score: 0.9085; val_best_acc_score: 0.8748; val_best_f1_score: 0.8796; train_kl_reg_loss: 69245.6042; train_edge_recon_loss: 2710032.1174; train_gene_expr_recon_loss: 10431559.5606; train_masked_gp_l1_reg_loss: 112653.8043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74705.0761; train_chrom_access_recon_loss: 1825530.2689; train_global_loss: 15223726.4242; train_optim_loss: 15223726.4242; val_kl_reg_loss: 66982.8970; val_edge_recon_loss: 2766733.7812; val_gene_expr_recon_loss: 10464309.1250; val_masked_gp_l1_reg_loss: 112060.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74461.2734; val_chrom_access_recon_loss: 1860433.8281; val_global_loss: 15344980.5000; val_optim_loss: 15344980.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9373; val_auprc_score: 0.9179; val_best_acc_score: 0.8740; val_best_f1_score: 0.8797; train_kl_reg_loss: 70332.2016; train_edge_recon_loss: 2718637.5985; train_gene_expr_recon_loss: 10390841.9394; train_masked_gp_l1_reg_loss: 109505.7847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61938.9985; train_chrom_access_recon_loss: 1815356.6080; train_global_loss: 15166613.1061; train_optim_loss: 15166613.1061; val_kl_reg_loss: 67571.5088; val_edge_recon_loss: 2742624.7188; val_gene_expr_recon_loss: 10301837.8750; val_masked_gp_l1_reg_loss: 108773.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59267.2852; val_chrom_access_recon_loss: 1804732.5781; val_global_loss: 15084807.8750; val_optim_loss: 15084807.8750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9337; val_auprc_score: 0.9096; val_best_acc_score: 0.8756; val_best_f1_score: 0.8825; train_kl_reg_loss: 70697.3815; train_edge_recon_loss: 2709667.2045; train_gene_expr_recon_loss: 10375108.9848; train_masked_gp_l1_reg_loss: 108621.2395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58959.6235; train_chrom_access_recon_loss: 1812332.5379; train_global_loss: 15135386.9394; train_optim_loss: 15135386.9394; val_kl_reg_loss: 67825.3926; val_edge_recon_loss: 2769308.9375; val_gene_expr_recon_loss: 10325431.8750; val_masked_gp_l1_reg_loss: 108527.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58709.5898; val_chrom_access_recon_loss: 1825568.6406; val_global_loss: 15155372.7500; val_optim_loss: 15155372.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9309; val_auprc_score: 0.8969; val_best_acc_score: 0.8702; val_best_f1_score: 0.8793; train_kl_reg_loss: 71307.4414; train_edge_recon_loss: 2707168.1705; train_gene_expr_recon_loss: 10375332.0455; train_masked_gp_l1_reg_loss: 108436.2848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58571.3195; train_chrom_access_recon_loss: 1812220.8106; train_global_loss: 15133035.9697; train_optim_loss: 15133035.9697; val_kl_reg_loss: 68400.8389; val_edge_recon_loss: 2761154.1875; val_gene_expr_recon_loss: 10327182.8750; val_masked_gp_l1_reg_loss: 108318.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58338.3750; val_chrom_access_recon_loss: 1818051.6250; val_global_loss: 15141446.5000; val_optim_loss: 15141446.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9335; val_auprc_score: 0.9116; val_best_acc_score: 0.8726; val_best_f1_score: 0.8816; train_kl_reg_loss: 71678.0668; train_edge_recon_loss: 2716440.6364; train_gene_expr_recon_loss: 10373962.8636; train_masked_gp_l1_reg_loss: 108244.1400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58208.8786; train_chrom_access_recon_loss: 1811008.7614; train_global_loss: 15139543.3182; train_optim_loss: 15139543.3182; val_kl_reg_loss: 68143.2832; val_edge_recon_loss: 2747031.5938; val_gene_expr_recon_loss: 10306151.7500; val_masked_gp_l1_reg_loss: 108155.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58122.5391; val_chrom_access_recon_loss: 1815076.1406; val_global_loss: 15102680.8750; val_optim_loss: 15102680.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9398; val_auprc_score: 0.9212; val_best_acc_score: 0.8778; val_best_f1_score: 0.8854; train_kl_reg_loss: 71355.2453; train_edge_recon_loss: 2707832.1553; train_gene_expr_recon_loss: 10365182.0455; train_masked_gp_l1_reg_loss: 108097.1491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58032.9722; train_chrom_access_recon_loss: 1809079.0455; train_global_loss: 15119578.5758; train_optim_loss: 15119578.5758; val_kl_reg_loss: 68469.2930; val_edge_recon_loss: 2733317.2500; val_gene_expr_recon_loss: 10412223.6250; val_masked_gp_l1_reg_loss: 108029.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57921.7383; val_chrom_access_recon_loss: 1838955.7344; val_global_loss: 15218918.0000; val_optim_loss: 15218918.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9398; val_auprc_score: 0.9168; val_best_acc_score: 0.8786; val_best_f1_score: 0.8860; train_kl_reg_loss: 71383.6207; train_edge_recon_loss: 2708100.0000; train_gene_expr_recon_loss: 10382690.6818; train_masked_gp_l1_reg_loss: 107770.1832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56575.3821; train_chrom_access_recon_loss: 1812563.1155; train_global_loss: 15139083.1061; train_optim_loss: 15139083.1061; val_kl_reg_loss: 68346.2529; val_edge_recon_loss: 2712353.0938; val_gene_expr_recon_loss: 10286135.7500; val_masked_gp_l1_reg_loss: 107687.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56297.1172; val_chrom_access_recon_loss: 1814195.3125; val_global_loss: 15045015.5000; val_optim_loss: 15045015.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9322; val_auprc_score: 0.9083; val_best_acc_score: 0.8716; val_best_f1_score: 0.8788; train_kl_reg_loss: 71409.3456; train_edge_recon_loss: 2703726.7083; train_gene_expr_recon_loss: 10370219.9091; train_masked_gp_l1_reg_loss: 107663.2214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56258.2222; train_chrom_access_recon_loss: 1811905.8106; train_global_loss: 15121183.2273; train_optim_loss: 15121183.2273; val_kl_reg_loss: 68619.6309; val_edge_recon_loss: 2771389.6562; val_gene_expr_recon_loss: 10295611.6250; val_masked_gp_l1_reg_loss: 107645.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56232.1172; val_chrom_access_recon_loss: 1819078.0000; val_global_loss: 15118576.8750; val_optim_loss: 15118576.8750
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9384; val_auprc_score: 0.9149; val_best_acc_score: 0.8743; val_best_f1_score: 0.8803; train_kl_reg_loss: 71419.2809; train_edge_recon_loss: 2703231.4318; train_gene_expr_recon_loss: 10363778.4697; train_masked_gp_l1_reg_loss: 107632.6456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56212.7509; train_chrom_access_recon_loss: 1810093.8826; train_global_loss: 15112368.4242; train_optim_loss: 15112368.4242; val_kl_reg_loss: 68974.7051; val_edge_recon_loss: 2723843.3750; val_gene_expr_recon_loss: 10352966.2500; val_masked_gp_l1_reg_loss: 107620.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56188.5273; val_chrom_access_recon_loss: 1821653.7344; val_global_loss: 15131248.2500; val_optim_loss: 15131248.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9341; val_auprc_score: 0.9080; val_best_acc_score: 0.8716; val_best_f1_score: 0.8782; train_kl_reg_loss: 71588.3243; train_edge_recon_loss: 2699421.0114; train_gene_expr_recon_loss: 10363179.6667; train_masked_gp_l1_reg_loss: 107610.0450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56173.1482; train_chrom_access_recon_loss: 1809181.1383; train_global_loss: 15107153.3030; train_optim_loss: 15107153.3030; val_kl_reg_loss: 68528.5547; val_edge_recon_loss: 2767466.4688; val_gene_expr_recon_loss: 10300210.7500; val_masked_gp_l1_reg_loss: 107600.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56154.9258; val_chrom_access_recon_loss: 1816278.0469; val_global_loss: 15116238.6250; val_optim_loss: 15116238.6250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9343; val_auprc_score: 0.9120; val_best_acc_score: 0.8753; val_best_f1_score: 0.8838; train_kl_reg_loss: 71513.9608; train_edge_recon_loss: 2717668.4545; train_gene_expr_recon_loss: 10368161.8030; train_masked_gp_l1_reg_loss: 107592.6171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56141.2915; train_chrom_access_recon_loss: 1812126.2879; train_global_loss: 15133204.4091; train_optim_loss: 15133204.4091; val_kl_reg_loss: 68629.3018; val_edge_recon_loss: 2749491.2812; val_gene_expr_recon_loss: 10322485.2500; val_masked_gp_l1_reg_loss: 107582.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56127.3359; val_chrom_access_recon_loss: 1812669.6250; val_global_loss: 15116985.8750; val_optim_loss: 15116985.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9348; val_auprc_score: 0.9067; val_best_acc_score: 0.8721; val_best_f1_score: 0.8801; train_kl_reg_loss: 71520.2908; train_edge_recon_loss: 2715310.0303; train_gene_expr_recon_loss: 10374363.0303; train_masked_gp_l1_reg_loss: 107556.3249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55991.2202; train_chrom_access_recon_loss: 1811515.4375; train_global_loss: 15136256.1515; train_optim_loss: 15136256.1515; val_kl_reg_loss: 68831.3242; val_edge_recon_loss: 2725786.9688; val_gene_expr_recon_loss: 10387000.8750; val_masked_gp_l1_reg_loss: 107548.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55964.8672; val_chrom_access_recon_loss: 1827457.1719; val_global_loss: 15172590.3750; val_optim_loss: 15172590.3750
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9366; val_auprc_score: 0.9187; val_best_acc_score: 0.8745; val_best_f1_score: 0.8794; train_kl_reg_loss: 71453.0959; train_edge_recon_loss: 2715250.2727; train_gene_expr_recon_loss: 10368344.6061; train_masked_gp_l1_reg_loss: 107546.3562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55961.5619; train_chrom_access_recon_loss: 1810406.7405; train_global_loss: 15128962.6667; train_optim_loss: 15128962.6667; val_kl_reg_loss: 68553.1318; val_edge_recon_loss: 2760151.6562; val_gene_expr_recon_loss: 10313453.3750; val_masked_gp_l1_reg_loss: 107544.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55958.7344; val_chrom_access_recon_loss: 1829879.1562; val_global_loss: 15135541.7500; val_optim_loss: 15135541.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9402; val_auprc_score: 0.9149; val_best_acc_score: 0.8842; val_best_f1_score: 0.8898; train_kl_reg_loss: 71450.6957; train_edge_recon_loss: 2709137.2727; train_gene_expr_recon_loss: 10371645.1970; train_masked_gp_l1_reg_loss: 107543.1681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55955.9898; train_chrom_access_recon_loss: 1810944.7917; train_global_loss: 15126677.1515; train_optim_loss: 15126677.1515; val_kl_reg_loss: 69050.8555; val_edge_recon_loss: 2734612.3125; val_gene_expr_recon_loss: 10414503.0000; val_masked_gp_l1_reg_loss: 107541.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55953.7188; val_chrom_access_recon_loss: 1839598.7344; val_global_loss: 15221260.8750; val_optim_loss: 15221260.8750
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9368; val_auprc_score: 0.9148; val_best_acc_score: 0.8708; val_best_f1_score: 0.8764; train_kl_reg_loss: 71467.2309; train_edge_recon_loss: 2707750.5606; train_gene_expr_recon_loss: 10369896.7879; train_masked_gp_l1_reg_loss: 107540.2946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55951.6359; train_chrom_access_recon_loss: 1809827.9451; train_global_loss: 15122434.4545; train_optim_loss: 15122434.4545; val_kl_reg_loss: 68930.5781; val_edge_recon_loss: 2746420.8750; val_gene_expr_recon_loss: 10390839.8750; val_masked_gp_l1_reg_loss: 107539.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55949.5000; val_chrom_access_recon_loss: 1815609.4844; val_global_loss: 15185289.1250; val_optim_loss: 15185289.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 4 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9376
val AUPRC score: 0.9085
val best accuracy score: 0.8767
val best F1 score: 0.8837
val target rna MSE score: 1.9336
val source rna MSE score: 0.8842
val target atac MSE score: 0.3198
val source atac MSE score: 0.1352
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
