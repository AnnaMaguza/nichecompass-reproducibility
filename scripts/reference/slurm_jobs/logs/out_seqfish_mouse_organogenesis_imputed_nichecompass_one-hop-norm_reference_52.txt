[True]
Run timestamp: 08082023_004426_52.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_52']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8913; val_auprc_score: 0.9776; val_best_acc_score: 0.8564; val_best_f1_score: 0.9223; train_kl_reg_loss: 140718.2526; train_edge_recon_loss: 118473.8199; train_gene_expr_recon_loss: 3772215.4639; train_masked_gp_l1_reg_loss: 17988.3230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176716.6480; train_global_loss: 4226112.5409; train_optim_loss: 4226112.5409; val_kl_reg_loss: 124225.4336; val_edge_recon_loss: 120537.5462; val_gene_expr_recon_loss: 2890686.1875; val_masked_gp_l1_reg_loss: 15066.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168367.2812; val_global_loss: 3318883.1667; val_optim_loss: 3318883.1667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8774; val_auprc_score: 0.9734; val_best_acc_score: 0.8976; val_best_f1_score: 0.9426; train_kl_reg_loss: 104144.2223; train_edge_recon_loss: 119185.2586; train_gene_expr_recon_loss: 2719811.8894; train_masked_gp_l1_reg_loss: 13685.5033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156845.3173; train_global_loss: 3113672.1755; train_optim_loss: 3113672.1755; val_kl_reg_loss: 84540.2129; val_edge_recon_loss: 119388.2910; val_gene_expr_recon_loss: 2344094.8958; val_masked_gp_l1_reg_loss: 12977.5244; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144700.1562; val_global_loss: 2705701.1667; val_optim_loss: 2705701.1667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8933; val_auprc_score: 0.9763; val_best_acc_score: 0.8916; val_best_f1_score: 0.9400; train_kl_reg_loss: 79960.9503; train_edge_recon_loss: 117331.5108; train_gene_expr_recon_loss: 2289942.0938; train_masked_gp_l1_reg_loss: 12579.7326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132684.8826; train_global_loss: 2632499.1683; train_optim_loss: 2632499.1683; val_kl_reg_loss: 71697.3939; val_edge_recon_loss: 118445.3457; val_gene_expr_recon_loss: 2253336.0833; val_masked_gp_l1_reg_loss: 12344.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120693.3125; val_global_loss: 2576516.3333; val_optim_loss: 2576516.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9058; val_auprc_score: 0.9785; val_best_acc_score: 0.9041; val_best_f1_score: 0.9460; train_kl_reg_loss: 68406.1861; train_edge_recon_loss: 116913.6011; train_gene_expr_recon_loss: 2219528.7596; train_masked_gp_l1_reg_loss: 12335.6422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109970.6424; train_global_loss: 2527154.8389; train_optim_loss: 2527154.8389; val_kl_reg_loss: 63428.0244; val_edge_recon_loss: 119309.8288; val_gene_expr_recon_loss: 2190314.0417; val_masked_gp_l1_reg_loss: 12385.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99719.9844; val_global_loss: 2485157.1667; val_optim_loss: 2485157.1667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9143; val_auprc_score: 0.9807; val_best_acc_score: 0.9188; val_best_f1_score: 0.9536; train_kl_reg_loss: 60816.2053; train_edge_recon_loss: 115375.0783; train_gene_expr_recon_loss: 2166050.4135; train_masked_gp_l1_reg_loss: 12485.0534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91023.8745; train_global_loss: 2445750.6394; train_optim_loss: 2445750.6394; val_kl_reg_loss: 56918.5908; val_edge_recon_loss: 115003.1523; val_gene_expr_recon_loss: 2144016.8542; val_masked_gp_l1_reg_loss: 12599.3057; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82815.3594; val_global_loss: 2411353.1042; val_optim_loss: 2411353.1042
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9268; val_auprc_score: 0.9841; val_best_acc_score: 0.9216; val_best_f1_score: 0.9546; train_kl_reg_loss: 55549.5331; train_edge_recon_loss: 115308.8692; train_gene_expr_recon_loss: 2122251.5817; train_masked_gp_l1_reg_loss: 12720.5403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75905.8252; train_global_loss: 2381736.3486; train_optim_loss: 2381736.3486; val_kl_reg_loss: 53135.5384; val_edge_recon_loss: 114264.3379; val_gene_expr_recon_loss: 2102088.9583; val_masked_gp_l1_reg_loss: 12853.7412; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69388.8359; val_global_loss: 2351731.3125; val_optim_loss: 2351731.3125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9321; val_auprc_score: 0.9852; val_best_acc_score: 0.9259; val_best_f1_score: 0.9577; train_kl_reg_loss: 51592.3655; train_edge_recon_loss: 113970.2997; train_gene_expr_recon_loss: 2084849.5144; train_masked_gp_l1_reg_loss: 12993.1257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63945.5753; train_global_loss: 2327350.8726; train_optim_loss: 2327350.8726; val_kl_reg_loss: 49644.1878; val_edge_recon_loss: 114859.9694; val_gene_expr_recon_loss: 2067906.3021; val_masked_gp_l1_reg_loss: 13136.0244; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58822.5195; val_global_loss: 2304368.9792; val_optim_loss: 2304368.9792
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9389; val_auprc_score: 0.9864; val_best_acc_score: 0.9325; val_best_f1_score: 0.9611; train_kl_reg_loss: 48466.5609; train_edge_recon_loss: 112916.5479; train_gene_expr_recon_loss: 2052740.6442; train_masked_gp_l1_reg_loss: 13275.2736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54559.5426; train_global_loss: 2281958.5745; train_optim_loss: 2281958.5745; val_kl_reg_loss: 46770.1517; val_edge_recon_loss: 113861.7357; val_gene_expr_recon_loss: 2038338.5938; val_masked_gp_l1_reg_loss: 13419.4629; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50546.9141; val_global_loss: 2262937.0208; val_optim_loss: 2262937.0208
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9463; val_auprc_score: 0.9881; val_best_acc_score: 0.9366; val_best_f1_score: 0.9632; train_kl_reg_loss: 45988.4778; train_edge_recon_loss: 112497.4162; train_gene_expr_recon_loss: 2023797.2139; train_masked_gp_l1_reg_loss: 13553.6808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47181.3167; train_global_loss: 2243018.1154; train_optim_loss: 2243018.1154; val_kl_reg_loss: 44471.5133; val_edge_recon_loss: 113198.9896; val_gene_expr_recon_loss: 2010319.2396; val_masked_gp_l1_reg_loss: 13693.6768; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44025.0195; val_global_loss: 2225708.5000; val_optim_loss: 2225708.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9506; val_auprc_score: 0.9885; val_best_acc_score: 0.9413; val_best_f1_score: 0.9663; train_kl_reg_loss: 43923.1361; train_edge_recon_loss: 110623.2817; train_gene_expr_recon_loss: 1997237.9123; train_masked_gp_l1_reg_loss: 13824.8883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41362.4237; train_global_loss: 2206971.6394; train_optim_loss: 2206971.6394; val_kl_reg_loss: 42345.4557; val_edge_recon_loss: 112113.7708; val_gene_expr_recon_loss: 1985318.3854; val_masked_gp_l1_reg_loss: 13962.5684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38871.4102; val_global_loss: 2192611.6250; val_optim_loss: 2192611.6250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9546; val_auprc_score: 0.9899; val_best_acc_score: 0.9434; val_best_f1_score: 0.9673; train_kl_reg_loss: 42148.7653; train_edge_recon_loss: 110879.6940; train_gene_expr_recon_loss: 1973606.0829; train_masked_gp_l1_reg_loss: 14088.3218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36770.5319; train_global_loss: 2177493.3966; train_optim_loss: 2177493.3966; val_kl_reg_loss: 40715.4163; val_edge_recon_loss: 111105.6654; val_gene_expr_recon_loss: 1962462.0208; val_masked_gp_l1_reg_loss: 14211.4541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34787.0664; val_global_loss: 2163281.5833; val_optim_loss: 2163281.5833
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9592; val_auprc_score: 0.9909; val_best_acc_score: 0.9467; val_best_f1_score: 0.9690; train_kl_reg_loss: 40643.0534; train_edge_recon_loss: 110224.6938; train_gene_expr_recon_loss: 1950795.5144; train_masked_gp_l1_reg_loss: 14328.6564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33087.2800; train_global_loss: 2149079.2163; train_optim_loss: 2149079.2163; val_kl_reg_loss: 39791.5885; val_edge_recon_loss: 109652.8431; val_gene_expr_recon_loss: 1940863.0312; val_masked_gp_l1_reg_loss: 14450.0918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31454.0859; val_global_loss: 2136211.5208; val_optim_loss: 2136211.5208
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9595; val_auprc_score: 0.9900; val_best_acc_score: 0.9477; val_best_f1_score: 0.9698; train_kl_reg_loss: 39267.7183; train_edge_recon_loss: 108944.0182; train_gene_expr_recon_loss: 1930229.6695; train_masked_gp_l1_reg_loss: 14559.1386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30080.1747; train_global_loss: 2123080.7115; train_optim_loss: 2123080.7115; val_kl_reg_loss: 38674.5544; val_edge_recon_loss: 110814.2174; val_gene_expr_recon_loss: 1921073.7604; val_masked_gp_l1_reg_loss: 14673.6777; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28738.5840; val_global_loss: 2113974.7917; val_optim_loss: 2113974.7917
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9605; val_auprc_score: 0.9909; val_best_acc_score: 0.9493; val_best_f1_score: 0.9706; train_kl_reg_loss: 37961.7858; train_edge_recon_loss: 108715.9995; train_gene_expr_recon_loss: 1910548.0228; train_masked_gp_l1_reg_loss: 14773.3561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27580.9414; train_global_loss: 2099580.1238; train_optim_loss: 2099580.1238; val_kl_reg_loss: 37391.8210; val_edge_recon_loss: 110343.7142; val_gene_expr_recon_loss: 1901732.1875; val_masked_gp_l1_reg_loss: 14874.6230; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26450.5840; val_global_loss: 2090792.9688; val_optim_loss: 2090792.9688
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9654; val_auprc_score: 0.9924; val_best_acc_score: 0.9525; val_best_f1_score: 0.9726; train_kl_reg_loss: 36819.8545; train_edge_recon_loss: 107353.1839; train_gene_expr_recon_loss: 1891961.8702; train_masked_gp_l1_reg_loss: 14969.4791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25501.9986; train_global_loss: 2076606.3774; train_optim_loss: 2076606.3774; val_kl_reg_loss: 36148.9570; val_edge_recon_loss: 108603.9232; val_gene_expr_recon_loss: 1883564.6979; val_masked_gp_l1_reg_loss: 15067.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24564.7852; val_global_loss: 2067949.3542; val_optim_loss: 2067949.3542
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9668; val_auprc_score: 0.9927; val_best_acc_score: 0.9546; val_best_f1_score: 0.9737; train_kl_reg_loss: 35778.3926; train_edge_recon_loss: 106561.8521; train_gene_expr_recon_loss: 1874439.5613; train_masked_gp_l1_reg_loss: 15156.2996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23729.9630; train_global_loss: 2055666.0601; train_optim_loss: 2055666.0601; val_kl_reg_loss: 34841.5628; val_edge_recon_loss: 107430.9818; val_gene_expr_recon_loss: 1866374.7812; val_masked_gp_l1_reg_loss: 15245.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22922.7539; val_global_loss: 2046815.1979; val_optim_loss: 2046815.1979
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9669; val_auprc_score: 0.9921; val_best_acc_score: 0.9554; val_best_f1_score: 0.9741; train_kl_reg_loss: 34817.3095; train_edge_recon_loss: 105825.8558; train_gene_expr_recon_loss: 1857437.1707; train_masked_gp_l1_reg_loss: 15329.1430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22214.0613; train_global_loss: 2035623.5505; train_optim_loss: 2035623.5505; val_kl_reg_loss: 33911.6198; val_edge_recon_loss: 107431.3385; val_gene_expr_recon_loss: 1850943.6146; val_masked_gp_l1_reg_loss: 15409.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21537.8203; val_global_loss: 2029234.3438; val_optim_loss: 2029234.3438
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9691; val_auprc_score: 0.9925; val_best_acc_score: 0.9575; val_best_f1_score: 0.9754; train_kl_reg_loss: 33809.9360; train_edge_recon_loss: 105120.5858; train_gene_expr_recon_loss: 1841892.2212; train_masked_gp_l1_reg_loss: 15488.4619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20911.7459; train_global_loss: 2017222.9543; train_optim_loss: 2017222.9543; val_kl_reg_loss: 33134.1686; val_edge_recon_loss: 104325.4583; val_gene_expr_recon_loss: 1833881.9792; val_masked_gp_l1_reg_loss: 15568.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20299.8574; val_global_loss: 2007210.2292; val_optim_loss: 2007210.2292
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9699; val_auprc_score: 0.9931; val_best_acc_score: 0.9591; val_best_f1_score: 0.9763; train_kl_reg_loss: 32949.4251; train_edge_recon_loss: 104189.8220; train_gene_expr_recon_loss: 1826576.7837; train_masked_gp_l1_reg_loss: 15639.1700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19766.5532; train_global_loss: 1999121.7536; train_optim_loss: 1999121.7536; val_kl_reg_loss: 31501.5866; val_edge_recon_loss: 104039.5938; val_gene_expr_recon_loss: 1822388.9896; val_masked_gp_l1_reg_loss: 15708.8574; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19250.3516; val_global_loss: 1992889.4375; val_optim_loss: 1992889.4375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9720; val_auprc_score: 0.9934; val_best_acc_score: 0.9602; val_best_f1_score: 0.9769; train_kl_reg_loss: 31959.1723; train_edge_recon_loss: 103703.4352; train_gene_expr_recon_loss: 1812034.7764; train_masked_gp_l1_reg_loss: 15771.0663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18779.4304; train_global_loss: 1982247.8702; train_optim_loss: 1982247.8702; val_kl_reg_loss: 31276.2581; val_edge_recon_loss: 103820.6764; val_gene_expr_recon_loss: 1805360.6250; val_masked_gp_l1_reg_loss: 15841.1465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18324.0742; val_global_loss: 1974622.7917; val_optim_loss: 1974622.7917
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9713; val_auprc_score: 0.9934; val_best_acc_score: 0.9595; val_best_f1_score: 0.9765; train_kl_reg_loss: 31048.5268; train_edge_recon_loss: 102325.8252; train_gene_expr_recon_loss: 1798568.6863; train_masked_gp_l1_reg_loss: 15890.0866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17909.4883; train_global_loss: 1965742.6130; train_optim_loss: 1965742.6130; val_kl_reg_loss: 30502.8260; val_edge_recon_loss: 104345.8555; val_gene_expr_recon_loss: 1791138.4062; val_masked_gp_l1_reg_loss: 15951.1631; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17515.9492; val_global_loss: 1959454.2083; val_optim_loss: 1959454.2083
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9727; val_auprc_score: 0.9938; val_best_acc_score: 0.9617; val_best_f1_score: 0.9779; train_kl_reg_loss: 30043.3057; train_edge_recon_loss: 102055.0839; train_gene_expr_recon_loss: 1785978.5541; train_masked_gp_l1_reg_loss: 15986.5596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17148.5135; train_global_loss: 1951212.0252; train_optim_loss: 1951212.0252; val_kl_reg_loss: 29259.2741; val_edge_recon_loss: 101852.0169; val_gene_expr_recon_loss: 1780836.3542; val_masked_gp_l1_reg_loss: 16029.7871; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16797.0098; val_global_loss: 1944774.3750; val_optim_loss: 1944774.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9731; val_auprc_score: 0.9939; val_best_acc_score: 0.9633; val_best_f1_score: 0.9787; train_kl_reg_loss: 29069.8544; train_edge_recon_loss: 101399.9757; train_gene_expr_recon_loss: 1773244.0120; train_masked_gp_l1_reg_loss: 16058.1497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16496.7603; train_global_loss: 1936268.7572; train_optim_loss: 1936268.7572; val_kl_reg_loss: 27640.8232; val_edge_recon_loss: 100956.6803; val_gene_expr_recon_loss: 1769246.5521; val_masked_gp_l1_reg_loss: 16083.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16202.7305; val_global_loss: 1930130.5000; val_optim_loss: 1930130.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9740; val_auprc_score: 0.9937; val_best_acc_score: 0.9631; val_best_f1_score: 0.9787; train_kl_reg_loss: 27939.2659; train_edge_recon_loss: 100319.7280; train_gene_expr_recon_loss: 1761111.4087; train_masked_gp_l1_reg_loss: 16091.8583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15912.8853; train_global_loss: 1921375.1442; train_optim_loss: 1921375.1442; val_kl_reg_loss: 26619.2054; val_edge_recon_loss: 99747.3483; val_gene_expr_recon_loss: 1754699.4688; val_masked_gp_l1_reg_loss: 16103.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15654.3496; val_global_loss: 1912823.7812; val_optim_loss: 1912823.7812
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9751; val_auprc_score: 0.9944; val_best_acc_score: 0.9636; val_best_f1_score: 0.9789; train_kl_reg_loss: 26878.6091; train_edge_recon_loss: 99040.1744; train_gene_expr_recon_loss: 1748660.3618; train_masked_gp_l1_reg_loss: 16095.4295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15411.8766; train_global_loss: 1906086.4555; train_optim_loss: 1906086.4555; val_kl_reg_loss: 26509.0692; val_edge_recon_loss: 99604.9232; val_gene_expr_recon_loss: 1746156.5417; val_masked_gp_l1_reg_loss: 16090.3604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15176.7969; val_global_loss: 1903537.6562; val_optim_loss: 1903537.6562
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.7779; val_auprc_score: 0.9415; val_best_acc_score: 0.8647; val_best_f1_score: 0.9263; train_kl_reg_loss: 11451.3095; train_edge_recon_loss: 111253.1925; train_gene_expr_recon_loss: 3612126.5144; train_masked_gp_l1_reg_loss: 22743.7523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11937.8768; train_global_loss: 3769512.6418; train_optim_loss: 3769512.6418; val_kl_reg_loss: 6891.2358; val_edge_recon_loss: 117888.9264; val_gene_expr_recon_loss: 2542878.3333; val_masked_gp_l1_reg_loss: 24792.1191; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9426.3975; val_global_loss: 2701877.0208; val_optim_loss: 2701877.0208
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.6407; val_auprc_score: 0.8958; val_best_acc_score: 0.8644; val_best_f1_score: 0.9263; train_kl_reg_loss: 7662.0468; train_edge_recon_loss: 109727.5500; train_gene_expr_recon_loss: 2266272.6226; train_masked_gp_l1_reg_loss: 23628.7344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8244.0408; train_global_loss: 2415534.9760; train_optim_loss: 2415534.9760; val_kl_reg_loss: 7555.3869; val_edge_recon_loss: 116125.0866; val_gene_expr_recon_loss: 2094771.5625; val_masked_gp_l1_reg_loss: 22458.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7328.7817; val_global_loss: 2248239.0417; val_optim_loss: 2248239.0417
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.6708; val_auprc_score: 0.9064; val_best_acc_score: 0.8670; val_best_f1_score: 0.9276; train_kl_reg_loss: 8295.9854; train_edge_recon_loss: 106609.1732; train_gene_expr_recon_loss: 2025952.4315; train_masked_gp_l1_reg_loss: 21453.2154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6743.6756; train_global_loss: 2169054.4663; train_optim_loss: 2169054.4663; val_kl_reg_loss: 7730.9618; val_edge_recon_loss: 114375.1120; val_gene_expr_recon_loss: 1976438.9167; val_masked_gp_l1_reg_loss: 20543.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6234.1211; val_global_loss: 2125322.4583; val_optim_loss: 2125322.4583
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.7677; val_auprc_score: 0.9401; val_best_acc_score: 0.8795; val_best_f1_score: 0.9332; train_kl_reg_loss: 7915.7862; train_edge_recon_loss: 105112.2941; train_gene_expr_recon_loss: 1946961.2284; train_masked_gp_l1_reg_loss: 19795.6475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5841.4348; train_global_loss: 2085626.3798; train_optim_loss: 2085626.3798; val_kl_reg_loss: 7462.2253; val_edge_recon_loss: 111497.3711; val_gene_expr_recon_loss: 1925720.0625; val_masked_gp_l1_reg_loss: 19095.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5477.4404; val_global_loss: 2069252.5312; val_optim_loss: 2069252.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.7760; val_auprc_score: 0.9426; val_best_acc_score: 0.8831; val_best_f1_score: 0.9353; train_kl_reg_loss: 7754.6146; train_edge_recon_loss: 102979.3480; train_gene_expr_recon_loss: 1921906.5925; train_masked_gp_l1_reg_loss: 18937.5340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5321.6023; train_global_loss: 2056899.6911; train_optim_loss: 2056899.6911; val_kl_reg_loss: 7424.6702; val_edge_recon_loss: 109949.8177; val_gene_expr_recon_loss: 1921574.0312; val_masked_gp_l1_reg_loss: 18860.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5275.2271; val_global_loss: 2063084.5312; val_optim_loss: 2063084.5312
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.7831; val_auprc_score: 0.9442; val_best_acc_score: 0.8854; val_best_f1_score: 0.9365; train_kl_reg_loss: 7709.7483; train_edge_recon_loss: 102814.9799; train_gene_expr_recon_loss: 1918253.1418; train_masked_gp_l1_reg_loss: 18794.7213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5241.7692; train_global_loss: 2052814.3498; train_optim_loss: 2052814.3498; val_kl_reg_loss: 7366.6154; val_edge_recon_loss: 108683.9844; val_gene_expr_recon_loss: 1920340.3854; val_masked_gp_l1_reg_loss: 18727.4355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5206.8760; val_global_loss: 2060325.2396; val_optim_loss: 2060325.2396
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.7912; val_auprc_score: 0.9460; val_best_acc_score: 0.8834; val_best_f1_score: 0.9351; train_kl_reg_loss: 7690.1059; train_edge_recon_loss: 102506.3718; train_gene_expr_recon_loss: 1914832.4014; train_masked_gp_l1_reg_loss: 18659.1135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5172.7700; train_global_loss: 2048860.7656; train_optim_loss: 2048860.7656; val_kl_reg_loss: 7387.3497; val_edge_recon_loss: 111221.7025; val_gene_expr_recon_loss: 1916226.5833; val_masked_gp_l1_reg_loss: 18588.6895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5137.5923; val_global_loss: 2058562.0000; val_optim_loss: 2058562.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.7964; val_auprc_score: 0.9464; val_best_acc_score: 0.8840; val_best_f1_score: 0.9357; train_kl_reg_loss: 7635.7782; train_edge_recon_loss: 101929.2203; train_gene_expr_recon_loss: 1912040.8642; train_masked_gp_l1_reg_loss: 18517.2483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5102.0463; train_global_loss: 2045225.1659; train_optim_loss: 2045225.1659; val_kl_reg_loss: 7296.7491; val_edge_recon_loss: 110028.1009; val_gene_expr_recon_loss: 1912967.9896; val_masked_gp_l1_reg_loss: 18445.4707; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5065.6562; val_global_loss: 2053803.9583; val_optim_loss: 2053803.9583

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 91 min 53 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9755
val AUPRC score: 0.9943
val best accuracy score: 0.9636
val best F1 score: 0.9789
val target rna MSE score: 21.6272
val source rna MSE score: 223.0609
Val cat covariate0 mean sim diff: -0.0011

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
