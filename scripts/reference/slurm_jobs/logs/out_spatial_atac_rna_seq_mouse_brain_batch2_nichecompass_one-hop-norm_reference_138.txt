[True]
Run timestamp: 26072023_034858_138.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_138']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9641; val_auprc_score: 0.9649; val_best_acc_score: 0.7753; val_best_f1_score: 0.8143; train_kl_reg_loss: 5138.8043; train_edge_recon_loss: 34671108.0000; train_gene_expr_recon_loss: 3160118.1389; train_masked_gp_l1_reg_loss: 1867.6655; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10744923.2222; train_global_loss: 48583156.8889; train_optim_loss: 48583156.8889; val_kl_reg_loss: 4877.3179; val_edge_recon_loss: 40515572.0000; val_gene_expr_recon_loss: 3120137.0000; val_masked_gp_l1_reg_loss: 1860.3904; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10997912.0000; val_global_loss: 54640356.0000; val_optim_loss: 54640356.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9318; val_auprc_score: 0.9287; val_best_acc_score: 0.8473; val_best_f1_score: 0.8521; train_kl_reg_loss: 3777.7258; train_edge_recon_loss: 34681968.0000; train_gene_expr_recon_loss: 3067947.1667; train_masked_gp_l1_reg_loss: 1917.4165; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10696447.2222; train_global_loss: 48452056.0000; train_optim_loss: 48452056.0000; val_kl_reg_loss: 4533.7578; val_edge_recon_loss: 40137848.0000; val_gene_expr_recon_loss: 3007701.5000; val_masked_gp_l1_reg_loss: 2022.4736; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10911641.0000; val_global_loss: 54063744.0000; val_optim_loss: 54063744.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9026; val_auprc_score: 0.8892; val_best_acc_score: 0.8188; val_best_f1_score: 0.8348; train_kl_reg_loss: 5939.9360; train_edge_recon_loss: 34562856.4444; train_gene_expr_recon_loss: 2952112.8611; train_masked_gp_l1_reg_loss: 2150.0419; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10649202.1111; train_global_loss: 48172261.3333; train_optim_loss: 48172261.3333; val_kl_reg_loss: 5010.0283; val_edge_recon_loss: 35921472.0000; val_gene_expr_recon_loss: 2872945.2500; val_masked_gp_l1_reg_loss: 2325.8940; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10810250.0000; val_global_loss: 49612000.0000; val_optim_loss: 49612000.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8471; val_auprc_score: 0.8371; val_best_acc_score: 0.7497; val_best_f1_score: 0.7852; train_kl_reg_loss: 4649.9009; train_edge_recon_loss: 31928898.2222; train_gene_expr_recon_loss: 2899355.1944; train_masked_gp_l1_reg_loss: 2469.2763; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10565205.6667; train_global_loss: 45400579.1111; train_optim_loss: 45400579.1111; val_kl_reg_loss: 11496.3008; val_edge_recon_loss: 29345394.0000; val_gene_expr_recon_loss: 2905982.5000; val_masked_gp_l1_reg_loss: 2634.7549; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10836929.0000; val_global_loss: 43102436.0000; val_optim_loss: 43102436.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8659; val_auprc_score: 0.8565; val_best_acc_score: 0.7665; val_best_f1_score: 0.7917; train_kl_reg_loss: 24069.7952; train_edge_recon_loss: 28620527.3333; train_gene_expr_recon_loss: 2872328.0000; train_masked_gp_l1_reg_loss: 2738.2482; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10494300.3333; train_global_loss: 42013963.5556; train_optim_loss: 42013963.5556; val_kl_reg_loss: 44751.1797; val_edge_recon_loss: 28673368.0000; val_gene_expr_recon_loss: 2818457.2500; val_masked_gp_l1_reg_loss: 2853.4829; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10696072.0000; val_global_loss: 42235504.0000; val_optim_loss: 42235504.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8763; val_auprc_score: 0.8631; val_best_acc_score: 0.7800; val_best_f1_score: 0.7984; train_kl_reg_loss: 55641.1636; train_edge_recon_loss: 28494244.8889; train_gene_expr_recon_loss: 2736765.3056; train_masked_gp_l1_reg_loss: 2932.6315; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10395425.1111; train_global_loss: 41685009.7778; train_optim_loss: 41685009.7778; val_kl_reg_loss: 70151.8125; val_edge_recon_loss: 28510416.0000; val_gene_expr_recon_loss: 2693954.5000; val_masked_gp_l1_reg_loss: 3024.7537; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10611167.0000; val_global_loss: 41888712.0000; val_optim_loss: 41888712.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8853; val_auprc_score: 0.8699; val_best_acc_score: 0.7940; val_best_f1_score: 0.8091; train_kl_reg_loss: 77263.1806; train_edge_recon_loss: 28390200.6667; train_gene_expr_recon_loss: 2641106.3333; train_masked_gp_l1_reg_loss: 3093.0566; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10289424.8889; train_global_loss: 41401088.0000; train_optim_loss: 41401088.0000; val_kl_reg_loss: 85872.7812; val_edge_recon_loss: 28414356.0000; val_gene_expr_recon_loss: 2597226.2500; val_masked_gp_l1_reg_loss: 3173.5632; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10502346.0000; val_global_loss: 41602976.0000; val_optim_loss: 41602976.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8795; val_auprc_score: 0.8577; val_best_acc_score: 0.7963; val_best_f1_score: 0.8027; train_kl_reg_loss: 90029.6476; train_edge_recon_loss: 28423601.3333; train_gene_expr_recon_loss: 2570973.6667; train_masked_gp_l1_reg_loss: 3231.5165; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10221997.2222; train_global_loss: 41309832.8889; train_optim_loss: 41309832.8889; val_kl_reg_loss: 96131.1406; val_edge_recon_loss: 28582630.0000; val_gene_expr_recon_loss: 2545982.7500; val_masked_gp_l1_reg_loss: 3298.6260; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10444446.0000; val_global_loss: 41672488.0000; val_optim_loss: 41672488.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8869; val_auprc_score: 0.8597; val_best_acc_score: 0.8065; val_best_f1_score: 0.8215; train_kl_reg_loss: 98755.8299; train_edge_recon_loss: 28168540.0000; train_gene_expr_recon_loss: 2515633.6111; train_masked_gp_l1_reg_loss: 3347.0968; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10226993.2222; train_global_loss: 41013269.3333; train_optim_loss: 41013269.3333; val_kl_reg_loss: 101567.1562; val_edge_recon_loss: 28190300.0000; val_gene_expr_recon_loss: 2494983.7500; val_masked_gp_l1_reg_loss: 3402.0725; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10383828.0000; val_global_loss: 41174080.0000; val_optim_loss: 41174080.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9013; val_auprc_score: 0.8709; val_best_acc_score: 0.8331; val_best_f1_score: 0.8453; train_kl_reg_loss: 102401.0113; train_edge_recon_loss: 27898229.5556; train_gene_expr_recon_loss: 2481256.3889; train_masked_gp_l1_reg_loss: 3440.4189; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10125384.4444; train_global_loss: 40610712.4444; train_optim_loss: 40610712.4444; val_kl_reg_loss: 106989.3125; val_edge_recon_loss: 27757820.0000; val_gene_expr_recon_loss: 2471034.7500; val_masked_gp_l1_reg_loss: 3483.4656; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10359859.0000; val_global_loss: 40699188.0000; val_optim_loss: 40699188.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9117; val_auprc_score: 0.8772; val_best_acc_score: 0.8533; val_best_f1_score: 0.8652; train_kl_reg_loss: 111301.4158; train_edge_recon_loss: 27512138.4444; train_gene_expr_recon_loss: 2463726.3056; train_masked_gp_l1_reg_loss: 3512.3730; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10129887.8889; train_global_loss: 40220566.6667; train_optim_loss: 40220566.6667; val_kl_reg_loss: 119524.5625; val_edge_recon_loss: 27656880.0000; val_gene_expr_recon_loss: 2512917.7500; val_masked_gp_l1_reg_loss: 3546.6860; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10324247.0000; val_global_loss: 40617116.0000; val_optim_loss: 40617116.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9255; val_auprc_score: 0.9003; val_best_acc_score: 0.8670; val_best_f1_score: 0.8766; train_kl_reg_loss: 117630.0182; train_edge_recon_loss: 27430858.4444; train_gene_expr_recon_loss: 2459588.4167; train_masked_gp_l1_reg_loss: 3575.9422; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10084647.4444; train_global_loss: 40096300.4444; train_optim_loss: 40096300.4444; val_kl_reg_loss: 116993.9375; val_edge_recon_loss: 27520170.0000; val_gene_expr_recon_loss: 2450501.5000; val_masked_gp_l1_reg_loss: 3609.8794; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10311562.0000; val_global_loss: 40402840.0000; val_optim_loss: 40402840.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9211; val_auprc_score: 0.8902; val_best_acc_score: 0.8641; val_best_f1_score: 0.8716; train_kl_reg_loss: 110786.9314; train_edge_recon_loss: 27330437.3333; train_gene_expr_recon_loss: 2406566.7222; train_masked_gp_l1_reg_loss: 3636.0165; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10023711.4444; train_global_loss: 39875137.7778; train_optim_loss: 39875137.7778; val_kl_reg_loss: 114404.8438; val_edge_recon_loss: 27552568.0000; val_gene_expr_recon_loss: 2438732.0000; val_masked_gp_l1_reg_loss: 3666.9934; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10291991.0000; val_global_loss: 40401360.0000; val_optim_loss: 40401360.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9260; val_auprc_score: 0.9009; val_best_acc_score: 0.8661; val_best_f1_score: 0.8721; train_kl_reg_loss: 114577.4800; train_edge_recon_loss: 27148873.1111; train_gene_expr_recon_loss: 2404101.5278; train_masked_gp_l1_reg_loss: 3695.1070; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9986737.0000; train_global_loss: 39657984.4444; train_optim_loss: 39657984.4444; val_kl_reg_loss: 121665.5078; val_edge_recon_loss: 27538306.0000; val_gene_expr_recon_loss: 2390740.2500; val_masked_gp_l1_reg_loss: 3730.1682; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10224333.0000; val_global_loss: 40278776.0000; val_optim_loss: 40278776.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9334; val_auprc_score: 0.9107; val_best_acc_score: 0.8743; val_best_f1_score: 0.8821; train_kl_reg_loss: 122522.9340; train_edge_recon_loss: 27102006.2222; train_gene_expr_recon_loss: 2384566.9722; train_masked_gp_l1_reg_loss: 3756.6933; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10013060.2222; train_global_loss: 39625913.3333; train_optim_loss: 39625913.3333; val_kl_reg_loss: 132293.6875; val_edge_recon_loss: 27364516.0000; val_gene_expr_recon_loss: 2350013.2500; val_masked_gp_l1_reg_loss: 3787.7510; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10197851.0000; val_global_loss: 40048464.0000; val_optim_loss: 40048464.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9364; val_auprc_score: 0.9120; val_best_acc_score: 0.8778; val_best_f1_score: 0.8849; train_kl_reg_loss: 128457.8134; train_edge_recon_loss: 27167259.3333; train_gene_expr_recon_loss: 2339418.1389; train_masked_gp_l1_reg_loss: 3807.3116; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9890740.2222; train_global_loss: 39529682.2222; train_optim_loss: 39529682.2222; val_kl_reg_loss: 135689.8906; val_edge_recon_loss: 27416572.0000; val_gene_expr_recon_loss: 2321450.2500; val_masked_gp_l1_reg_loss: 3829.9482; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10161383.0000; val_global_loss: 40038924.0000; val_optim_loss: 40038924.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9370; val_auprc_score: 0.9156; val_best_acc_score: 0.8812; val_best_f1_score: 0.8883; train_kl_reg_loss: 134670.9540; train_edge_recon_loss: 27117256.8889; train_gene_expr_recon_loss: 2318927.3056; train_masked_gp_l1_reg_loss: 3847.6592; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9940755.3333; train_global_loss: 39515457.7778; train_optim_loss: 39515457.7778; val_kl_reg_loss: 139639.5156; val_edge_recon_loss: 27209666.0000; val_gene_expr_recon_loss: 2327952.0000; val_masked_gp_l1_reg_loss: 3868.8809; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10154412.0000; val_global_loss: 39835536.0000; val_optim_loss: 39835536.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9407; val_auprc_score: 0.9178; val_best_acc_score: 0.8844; val_best_f1_score: 0.8889; train_kl_reg_loss: 139572.1042; train_edge_recon_loss: 27069711.3333; train_gene_expr_recon_loss: 2302592.9167; train_masked_gp_l1_reg_loss: 3885.5894; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9942688.7778; train_global_loss: 39458449.7778; train_optim_loss: 39458449.7778; val_kl_reg_loss: 143462.6719; val_edge_recon_loss: 27283156.0000; val_gene_expr_recon_loss: 2304816.7500; val_masked_gp_l1_reg_loss: 3906.8079; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10123361.0000; val_global_loss: 39858700.0000; val_optim_loss: 39858700.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9429; val_auprc_score: 0.9214; val_best_acc_score: 0.8875; val_best_f1_score: 0.8940; train_kl_reg_loss: 143313.2031; train_edge_recon_loss: 26975860.6667; train_gene_expr_recon_loss: 2294570.3611; train_masked_gp_l1_reg_loss: 3925.2524; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9869600.0000; train_global_loss: 39287269.3333; train_optim_loss: 39287269.3333; val_kl_reg_loss: 147459.7812; val_edge_recon_loss: 27088896.0000; val_gene_expr_recon_loss: 2300494.0000; val_masked_gp_l1_reg_loss: 3947.2480; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10101915.0000; val_global_loss: 39642712.0000; val_optim_loss: 39642712.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9527; val_auprc_score: 0.9368; val_best_acc_score: 0.8973; val_best_f1_score: 0.9010; train_kl_reg_loss: 145317.9774; train_edge_recon_loss: 27152117.1111; train_gene_expr_recon_loss: 2284224.7222; train_masked_gp_l1_reg_loss: 3965.7179; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9860591.2222; train_global_loss: 39446216.8889; train_optim_loss: 39446216.8889; val_kl_reg_loss: 147784.5000; val_edge_recon_loss: 26718428.0000; val_gene_expr_recon_loss: 2275678.7500; val_masked_gp_l1_reg_loss: 3986.2131; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10080111.0000; val_global_loss: 39225988.0000; val_optim_loss: 39225988.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9463; val_auprc_score: 0.9273; val_best_acc_score: 0.8884; val_best_f1_score: 0.8942; train_kl_reg_loss: 145142.7969; train_edge_recon_loss: 27068980.0000; train_gene_expr_recon_loss: 2265850.2778; train_masked_gp_l1_reg_loss: 4003.5320; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9818236.6667; train_global_loss: 39302213.7778; train_optim_loss: 39302213.7778; val_kl_reg_loss: 147364.0469; val_edge_recon_loss: 26967582.0000; val_gene_expr_recon_loss: 2269822.0000; val_masked_gp_l1_reg_loss: 4022.3955; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10081272.0000; val_global_loss: 39470064.0000; val_optim_loss: 39470064.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9452; val_auprc_score: 0.9248; val_best_acc_score: 0.8891; val_best_f1_score: 0.8935; train_kl_reg_loss: 145749.5017; train_edge_recon_loss: 27016822.8889; train_gene_expr_recon_loss: 2254083.3333; train_masked_gp_l1_reg_loss: 4038.1117; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9786759.8889; train_global_loss: 39207454.2222; train_optim_loss: 39207454.2222; val_kl_reg_loss: 148435.0000; val_edge_recon_loss: 27283520.0000; val_gene_expr_recon_loss: 2251911.7500; val_masked_gp_l1_reg_loss: 4056.9072; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10060975.0000; val_global_loss: 39748900.0000; val_optim_loss: 39748900.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9504; val_auprc_score: 0.9336; val_best_acc_score: 0.8968; val_best_f1_score: 0.9007; train_kl_reg_loss: 146380.7691; train_edge_recon_loss: 27049950.2222; train_gene_expr_recon_loss: 2249161.2222; train_masked_gp_l1_reg_loss: 4071.8672; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9817348.8889; train_global_loss: 39266912.8889; train_optim_loss: 39266912.8889; val_kl_reg_loss: 147929.1094; val_edge_recon_loss: 27045078.0000; val_gene_expr_recon_loss: 2254880.2500; val_masked_gp_l1_reg_loss: 4088.9375; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10042741.0000; val_global_loss: 39494716.0000; val_optim_loss: 39494716.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9532; val_auprc_score: 0.9366; val_best_acc_score: 0.8985; val_best_f1_score: 0.9028; train_kl_reg_loss: 146479.4635; train_edge_recon_loss: 27010600.0000; train_gene_expr_recon_loss: 2242196.8889; train_masked_gp_l1_reg_loss: 4101.9373; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9828332.1111; train_global_loss: 39231710.2222; train_optim_loss: 39231710.2222; val_kl_reg_loss: 145860.5312; val_edge_recon_loss: 27035878.0000; val_gene_expr_recon_loss: 2232257.2500; val_masked_gp_l1_reg_loss: 4116.9668; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10025590.0000; val_global_loss: 39443704.0000; val_optim_loss: 39443704.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9519; val_auprc_score: 0.9358; val_best_acc_score: 0.8979; val_best_f1_score: 0.9034; train_kl_reg_loss: 145237.9670; train_edge_recon_loss: 26971991.1111; train_gene_expr_recon_loss: 2227495.8056; train_masked_gp_l1_reg_loss: 4117.3915; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9803157.5556; train_global_loss: 39152000.4444; train_optim_loss: 39152000.4444; val_kl_reg_loss: 144954.0625; val_edge_recon_loss: 27012700.0000; val_gene_expr_recon_loss: 2233273.2500; val_masked_gp_l1_reg_loss: 4117.2876; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10019643.0000; val_global_loss: 39414688.0000; val_optim_loss: 39414688.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9554; val_auprc_score: 0.9374; val_best_acc_score: 0.9010; val_best_f1_score: 0.9062; train_kl_reg_loss: 142395.9167; train_edge_recon_loss: 27132034.2222; train_gene_expr_recon_loss: 2292023.8889; train_masked_gp_l1_reg_loss: 4117.1185; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9840304.4444; train_global_loss: 39410876.8889; train_optim_loss: 39410876.8889; val_kl_reg_loss: 46927.9141; val_edge_recon_loss: 27084740.0000; val_gene_expr_recon_loss: 2381084.0000; val_masked_gp_l1_reg_loss: 4117.3931; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10233923.0000; val_global_loss: 39750792.0000; val_optim_loss: 39750792.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9546; val_auprc_score: 0.9397; val_best_acc_score: 0.9003; val_best_f1_score: 0.9057; train_kl_reg_loss: 142718.4358; train_edge_recon_loss: 26970746.4444; train_gene_expr_recon_loss: 2332278.2500; train_masked_gp_l1_reg_loss: 4118.3995; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9905984.7778; train_global_loss: 39355846.2222; train_optim_loss: 39355846.2222; val_kl_reg_loss: 47247.5078; val_edge_recon_loss: 27324570.0000; val_gene_expr_recon_loss: 2314611.2500; val_masked_gp_l1_reg_loss: 4120.0342; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10137923.0000; val_global_loss: 39828472.0000; val_optim_loss: 39828472.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9553; val_auprc_score: 0.9386; val_best_acc_score: 0.8999; val_best_f1_score: 0.9054; train_kl_reg_loss: 143285.5694; train_edge_recon_loss: 26981784.6667; train_gene_expr_recon_loss: 2311420.8056; train_masked_gp_l1_reg_loss: 4121.5197; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9876396.8889; train_global_loss: 39317009.7778; train_optim_loss: 39317009.7778; val_kl_reg_loss: 46658.6328; val_edge_recon_loss: 27230278.0000; val_gene_expr_recon_loss: 2334800.7500; val_masked_gp_l1_reg_loss: 4123.4771; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10148544.0000; val_global_loss: 39764404.0000; val_optim_loss: 39764404.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 52 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9450
Val AUPRC score: 0.9283
Val best accuracy score: 0.8864
Val best F1 score: 0.8928
Val gene expr MSE score: 0.8413
Val chrom access MSE score: 0.0928
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
