[True]
Run timestamp: 07082023_214510_138.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_138']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8851; val_auprc_score: 0.9035; val_best_acc_score: 0.5319; val_best_f1_score: 0.6808; train_kl_reg_loss: 28391.4841; train_edge_recon_loss: 3475758.2222; train_gene_expr_recon_loss: 1161266.3472; train_masked_gp_l1_reg_loss: 4649.4412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167052.7882; train_chrom_access_recon_loss: 754136.9375; train_global_loss: 5591255.1111; train_optim_loss: 5591255.1111; val_kl_reg_loss: 8430.5293; val_edge_recon_loss: 4063075.5000; val_gene_expr_recon_loss: 956511.8125; val_masked_gp_l1_reg_loss: 4290.3921; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162512.0156; val_chrom_access_recon_loss: 492192.5312; val_global_loss: 5687013.0000; val_optim_loss: 5687013.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8735; val_auprc_score: 0.8871; val_best_acc_score: 0.5368; val_best_f1_score: 0.6824; train_kl_reg_loss: 10928.1768; train_edge_recon_loss: 3473667.4167; train_gene_expr_recon_loss: 926098.9097; train_masked_gp_l1_reg_loss: 4230.3797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159629.2326; train_chrom_access_recon_loss: 486418.8507; train_global_loss: 5060973.0000; train_optim_loss: 5060973.0000; val_kl_reg_loss: 11558.3691; val_edge_recon_loss: 4062692.2500; val_gene_expr_recon_loss: 841906.2500; val_masked_gp_l1_reg_loss: 4220.6504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155962.3281; val_chrom_access_recon_loss: 464128.9688; val_global_loss: 5540469.0000; val_optim_loss: 5540469.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8629; val_auprc_score: 0.8772; val_best_acc_score: 0.5581; val_best_f1_score: 0.6910; train_kl_reg_loss: 16245.6912; train_edge_recon_loss: 3477840.0278; train_gene_expr_recon_loss: 833357.5208; train_masked_gp_l1_reg_loss: 4290.7159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152648.7483; train_chrom_access_recon_loss: 465703.0069; train_global_loss: 4950085.5556; train_optim_loss: 4950085.5556; val_kl_reg_loss: 13372.1641; val_edge_recon_loss: 4060464.5000; val_gene_expr_recon_loss: 792785.6250; val_masked_gp_l1_reg_loss: 4378.5186; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148181.4844; val_chrom_access_recon_loss: 454672.4062; val_global_loss: 5473855.0000; val_optim_loss: 5473855.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8617; val_auprc_score: 0.8752; val_best_acc_score: 0.5768; val_best_f1_score: 0.6980; train_kl_reg_loss: 16274.6592; train_edge_recon_loss: 3477141.6944; train_gene_expr_recon_loss: 794135.6806; train_masked_gp_l1_reg_loss: 4425.5805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144227.9740; train_chrom_access_recon_loss: 456324.2708; train_global_loss: 4892529.9444; train_optim_loss: 4892529.9444; val_kl_reg_loss: 16877.2773; val_edge_recon_loss: 4057165.7500; val_gene_expr_recon_loss: 764914.2500; val_masked_gp_l1_reg_loss: 4466.8550; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139142.5781; val_chrom_access_recon_loss: 449889.7500; val_global_loss: 5432456.0000; val_optim_loss: 5432456.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8667; val_auprc_score: 0.8699; val_best_acc_score: 0.6448; val_best_f1_score: 0.7310; train_kl_reg_loss: 18783.6413; train_edge_recon_loss: 3478680.6944; train_gene_expr_recon_loss: 772229.5208; train_masked_gp_l1_reg_loss: 4489.6244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134927.4288; train_chrom_access_recon_loss: 452924.6424; train_global_loss: 4862035.6111; train_optim_loss: 4862035.6111; val_kl_reg_loss: 16501.1328; val_edge_recon_loss: 4051392.0000; val_gene_expr_recon_loss: 744130.3750; val_masked_gp_l1_reg_loss: 4514.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129619.5000; val_chrom_access_recon_loss: 446540.5625; val_global_loss: 5392697.5000; val_optim_loss: 5392697.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8647; val_auprc_score: 0.8588; val_best_acc_score: 0.7377; val_best_f1_score: 0.7813; train_kl_reg_loss: 18260.9297; train_edge_recon_loss: 3479067.7222; train_gene_expr_recon_loss: 750020.0625; train_masked_gp_l1_reg_loss: 4540.8405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125374.5139; train_chrom_access_recon_loss: 450001.0590; train_global_loss: 4827265.1667; train_optim_loss: 4827265.1667; val_kl_reg_loss: 17263.6367; val_edge_recon_loss: 4035162.0000; val_gene_expr_recon_loss: 727679.8750; val_masked_gp_l1_reg_loss: 4569.1270; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120092.4844; val_chrom_access_recon_loss: 444174.6250; val_global_loss: 5348941.5000; val_optim_loss: 5348941.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8580; val_auprc_score: 0.8536; val_best_acc_score: 0.7762; val_best_f1_score: 0.7849; train_kl_reg_loss: 18473.7934; train_edge_recon_loss: 3476638.1389; train_gene_expr_recon_loss: 738612.4236; train_masked_gp_l1_reg_loss: 4594.1616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115934.5668; train_chrom_access_recon_loss: 448863.0347; train_global_loss: 4803116.1667; train_optim_loss: 4803116.1667; val_kl_reg_loss: 15581.5527; val_edge_recon_loss: 3998457.5000; val_gene_expr_recon_loss: 715960.1250; val_masked_gp_l1_reg_loss: 4624.7993; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110805.8984; val_chrom_access_recon_loss: 442565.5625; val_global_loss: 5287995.5000; val_optim_loss: 5287995.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8580; val_auprc_score: 0.8437; val_best_acc_score: 0.7767; val_best_f1_score: 0.7948; train_kl_reg_loss: 15173.0243; train_edge_recon_loss: 3463642.9167; train_gene_expr_recon_loss: 729249.5208; train_masked_gp_l1_reg_loss: 4660.5276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106854.5738; train_chrom_access_recon_loss: 448859.3194; train_global_loss: 4768440.0000; train_optim_loss: 4768440.0000; val_kl_reg_loss: 11068.3174; val_edge_recon_loss: 3776078.0000; val_gene_expr_recon_loss: 714673.2500; val_masked_gp_l1_reg_loss: 4703.3638; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102021.8828; val_chrom_access_recon_loss: 441836.8125; val_global_loss: 5050382.0000; val_optim_loss: 5050382.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8481; val_auprc_score: 0.8392; val_best_acc_score: 0.7544; val_best_f1_score: 0.7852; train_kl_reg_loss: 8419.4003; train_edge_recon_loss: 3324522.5000; train_gene_expr_recon_loss: 736631.4444; train_masked_gp_l1_reg_loss: 4755.1804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98379.4340; train_chrom_access_recon_loss: 445753.5035; train_global_loss: 4618461.4444; train_optim_loss: 4618461.4444; val_kl_reg_loss: 8006.3945; val_edge_recon_loss: 3057494.5000; val_gene_expr_recon_loss: 754541.3750; val_masked_gp_l1_reg_loss: 4828.1807; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94026.3672; val_chrom_access_recon_loss: 445325.5000; val_global_loss: 4364222.5000; val_optim_loss: 4364222.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8448; val_auprc_score: 0.8352; val_best_acc_score: 0.7437; val_best_f1_score: 0.7752; train_kl_reg_loss: 18720.2406; train_edge_recon_loss: 2981086.0556; train_gene_expr_recon_loss: 777523.0000; train_masked_gp_l1_reg_loss: 4909.8359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90819.0851; train_chrom_access_recon_loss: 450487.2847; train_global_loss: 4323545.4444; train_optim_loss: 4323545.4444; val_kl_reg_loss: 32851.8555; val_edge_recon_loss: 2967963.0000; val_gene_expr_recon_loss: 740259.0000; val_masked_gp_l1_reg_loss: 5013.2524; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86909.2188; val_chrom_access_recon_loss: 443676.7500; val_global_loss: 4276673.0000; val_optim_loss: 4276673.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8668; val_auprc_score: 0.8539; val_best_acc_score: 0.7757; val_best_f1_score: 0.7854; train_kl_reg_loss: 43758.6324; train_edge_recon_loss: 2908398.8333; train_gene_expr_recon_loss: 744796.8403; train_masked_gp_l1_reg_loss: 5050.3939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83944.8455; train_chrom_access_recon_loss: 446803.6597; train_global_loss: 4232753.3056; train_optim_loss: 4232753.3056; val_kl_reg_loss: 48877.8242; val_edge_recon_loss: 2909757.5000; val_gene_expr_recon_loss: 726986.3125; val_masked_gp_l1_reg_loss: 5079.3862; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80338.1953; val_chrom_access_recon_loss: 441685.7500; val_global_loss: 4212725.0000; val_optim_loss: 4212725.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8958; val_auprc_score: 0.8680; val_best_acc_score: 0.8185; val_best_f1_score: 0.8286; train_kl_reg_loss: 51805.4293; train_edge_recon_loss: 2835600.5556; train_gene_expr_recon_loss: 734822.4444; train_masked_gp_l1_reg_loss: 5099.3836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77666.5373; train_chrom_access_recon_loss: 445841.1389; train_global_loss: 4150835.5000; train_optim_loss: 4150835.5000; val_kl_reg_loss: 45740.4219; val_edge_recon_loss: 2797743.7500; val_gene_expr_recon_loss: 724168.1250; val_masked_gp_l1_reg_loss: 5124.2832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74420.0312; val_chrom_access_recon_loss: 440803.3750; val_global_loss: 4088000.0000; val_optim_loss: 4088000.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9247; val_auprc_score: 0.8997; val_best_acc_score: 0.8636; val_best_f1_score: 0.8722; train_kl_reg_loss: 42494.4340; train_edge_recon_loss: 2755500.4444; train_gene_expr_recon_loss: 737785.6458; train_masked_gp_l1_reg_loss: 5149.0574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71996.5972; train_chrom_access_recon_loss: 444682.7882; train_global_loss: 4057608.9167; train_optim_loss: 4057608.9167; val_kl_reg_loss: 37622.8008; val_edge_recon_loss: 2742417.2500; val_gene_expr_recon_loss: 720176.1875; val_masked_gp_l1_reg_loss: 5174.3428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69097.0234; val_chrom_access_recon_loss: 439670.5938; val_global_loss: 4014158.0000; val_optim_loss: 4014158.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9352; val_auprc_score: 0.9142; val_best_acc_score: 0.8751; val_best_f1_score: 0.8820; train_kl_reg_loss: 39775.4891; train_edge_recon_loss: 2734192.2222; train_gene_expr_recon_loss: 731837.0486; train_masked_gp_l1_reg_loss: 5191.5623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66964.8872; train_chrom_access_recon_loss: 445071.2674; train_global_loss: 4023032.4167; train_optim_loss: 4023032.4167; val_kl_reg_loss: 38823.6211; val_edge_recon_loss: 2723102.2500; val_gene_expr_recon_loss: 717892.2500; val_masked_gp_l1_reg_loss: 5207.1587; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64370.6055; val_chrom_access_recon_loss: 438836.4375; val_global_loss: 3988232.2500; val_optim_loss: 3988232.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9348; val_auprc_score: 0.9169; val_best_acc_score: 0.8711; val_best_f1_score: 0.8789; train_kl_reg_loss: 42339.0551; train_edge_recon_loss: 2730456.5556; train_gene_expr_recon_loss: 726191.4375; train_masked_gp_l1_reg_loss: 5221.2048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62440.0299; train_chrom_access_recon_loss: 444892.7882; train_global_loss: 4011541.1111; train_optim_loss: 4011541.1111; val_kl_reg_loss: 40034.8125; val_edge_recon_loss: 2734319.2500; val_gene_expr_recon_loss: 710808.5625; val_masked_gp_l1_reg_loss: 5225.2417; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60105.2695; val_chrom_access_recon_loss: 437662.4062; val_global_loss: 3988155.5000; val_optim_loss: 3988155.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9346; val_auprc_score: 0.9112; val_best_acc_score: 0.8760; val_best_f1_score: 0.8849; train_kl_reg_loss: 43016.6554; train_edge_recon_loss: 2711369.3056; train_gene_expr_recon_loss: 718219.1944; train_masked_gp_l1_reg_loss: 5236.4417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58379.5768; train_chrom_access_recon_loss: 441120.0556; train_global_loss: 3977341.1111; train_optim_loss: 3977341.1111; val_kl_reg_loss: 41182.1445; val_edge_recon_loss: 2719409.2500; val_gene_expr_recon_loss: 708155.8750; val_masked_gp_l1_reg_loss: 5239.0850; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56274.9258; val_chrom_access_recon_loss: 437055.2188; val_global_loss: 3967316.7500; val_optim_loss: 3967316.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9442; val_auprc_score: 0.9309; val_best_acc_score: 0.8810; val_best_f1_score: 0.8890; train_kl_reg_loss: 43033.3177; train_edge_recon_loss: 2722357.2500; train_gene_expr_recon_loss: 716701.6389; train_masked_gp_l1_reg_loss: 5243.5693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54704.8997; train_chrom_access_recon_loss: 441679.8819; train_global_loss: 3983720.4444; train_optim_loss: 3983720.4444; val_kl_reg_loss: 41321.9414; val_edge_recon_loss: 2739581.5000; val_gene_expr_recon_loss: 701238.2500; val_masked_gp_l1_reg_loss: 5244.3623; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52792.6719; val_chrom_access_recon_loss: 436172.1562; val_global_loss: 3976351.0000; val_optim_loss: 3976351.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9448; val_auprc_score: 0.9271; val_best_acc_score: 0.8832; val_best_f1_score: 0.8899; train_kl_reg_loss: 40881.6324; train_edge_recon_loss: 2717867.4167; train_gene_expr_recon_loss: 711512.3889; train_masked_gp_l1_reg_loss: 5256.2873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51367.8585; train_chrom_access_recon_loss: 440122.6458; train_global_loss: 3967008.1389; train_optim_loss: 3967008.1389; val_kl_reg_loss: 38791.9219; val_edge_recon_loss: 2713506.5000; val_gene_expr_recon_loss: 699660.2500; val_masked_gp_l1_reg_loss: 5263.2837; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49631.8438; val_chrom_access_recon_loss: 435435.2500; val_global_loss: 3942289.0000; val_optim_loss: 3942289.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9479; val_auprc_score: 0.9330; val_best_acc_score: 0.8892; val_best_f1_score: 0.8950; train_kl_reg_loss: 39473.6098; train_edge_recon_loss: 2712333.4444; train_gene_expr_recon_loss: 707731.7708; train_masked_gp_l1_reg_loss: 5272.4618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48339.0933; train_chrom_access_recon_loss: 439185.7674; train_global_loss: 3952336.1667; train_optim_loss: 3952336.1667; val_kl_reg_loss: 36651.6016; val_edge_recon_loss: 2707103.0000; val_gene_expr_recon_loss: 698825.1250; val_masked_gp_l1_reg_loss: 5281.6689; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46764.4180; val_chrom_access_recon_loss: 434819.3750; val_global_loss: 3929445.0000; val_optim_loss: 3929445.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9513; val_auprc_score: 0.9372; val_best_acc_score: 0.8884; val_best_f1_score: 0.8941; train_kl_reg_loss: 37754.4727; train_edge_recon_loss: 2717435.0000; train_gene_expr_recon_loss: 710223.0833; train_masked_gp_l1_reg_loss: 5291.4521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45584.1549; train_chrom_access_recon_loss: 439684.7500; train_global_loss: 3955972.9167; train_optim_loss: 3955972.9167; val_kl_reg_loss: 35335.1016; val_edge_recon_loss: 2719500.0000; val_gene_expr_recon_loss: 696010.6250; val_masked_gp_l1_reg_loss: 5301.4980; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44156.2695; val_chrom_access_recon_loss: 434191.4688; val_global_loss: 3934494.7500; val_optim_loss: 3934494.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9508; val_auprc_score: 0.9342; val_best_acc_score: 0.8898; val_best_f1_score: 0.8957; train_kl_reg_loss: 36153.3438; train_edge_recon_loss: 2699928.1389; train_gene_expr_recon_loss: 708650.5278; train_masked_gp_l1_reg_loss: 5309.5442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43091.4822; train_chrom_access_recon_loss: 437573.6528; train_global_loss: 3930706.7222; train_optim_loss: 3930706.7222; val_kl_reg_loss: 33916.2969; val_edge_recon_loss: 2710462.7500; val_gene_expr_recon_loss: 695749.1250; val_masked_gp_l1_reg_loss: 5317.5610; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41796.4531; val_chrom_access_recon_loss: 433529.9688; val_global_loss: 3920772.0000; val_optim_loss: 3920772.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9572; val_auprc_score: 0.9422; val_best_acc_score: 0.8989; val_best_f1_score: 0.9047; train_kl_reg_loss: 34698.5326; train_edge_recon_loss: 2693898.8056; train_gene_expr_recon_loss: 702374.3958; train_masked_gp_l1_reg_loss: 5330.5854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40832.9688; train_chrom_access_recon_loss: 437476.7465; train_global_loss: 3914612.0278; train_optim_loss: 3914612.0278; val_kl_reg_loss: 31660.7656; val_edge_recon_loss: 2718608.0000; val_gene_expr_recon_loss: 703256.2500; val_masked_gp_l1_reg_loss: 5341.1284; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39651.6562; val_chrom_access_recon_loss: 433877.8438; val_global_loss: 3932395.7500; val_optim_loss: 3932395.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9629; val_auprc_score: 0.9438; val_best_acc_score: 0.9159; val_best_f1_score: 0.9193; train_kl_reg_loss: 33453.2227; train_edge_recon_loss: 2683186.1667; train_gene_expr_recon_loss: 704514.5625; train_masked_gp_l1_reg_loss: 5349.3496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38777.4345; train_chrom_access_recon_loss: 435852.8299; train_global_loss: 3901133.5278; train_optim_loss: 3901133.5278; val_kl_reg_loss: 32748.3281; val_edge_recon_loss: 2673806.2500; val_gene_expr_recon_loss: 691901.8750; val_masked_gp_l1_reg_loss: 5350.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37709.2656; val_chrom_access_recon_loss: 432363.6875; val_global_loss: 3873880.0000; val_optim_loss: 3873880.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9630; val_auprc_score: 0.9459; val_best_acc_score: 0.9158; val_best_f1_score: 0.9192; train_kl_reg_loss: 34859.4714; train_edge_recon_loss: 2674660.5000; train_gene_expr_recon_loss: 701628.2083; train_masked_gp_l1_reg_loss: 5361.1081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36904.7296; train_chrom_access_recon_loss: 435359.3750; train_global_loss: 3888773.4167; train_optim_loss: 3888773.4167; val_kl_reg_loss: 33618.2266; val_edge_recon_loss: 2694410.5000; val_gene_expr_recon_loss: 689900.4375; val_masked_gp_l1_reg_loss: 5367.5029; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35933.4492; val_chrom_access_recon_loss: 431650.0625; val_global_loss: 3890880.2500; val_optim_loss: 3890880.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9667; val_auprc_score: 0.9533; val_best_acc_score: 0.9162; val_best_f1_score: 0.9195; train_kl_reg_loss: 36554.9110; train_edge_recon_loss: 2660661.5000; train_gene_expr_recon_loss: 701548.3542; train_masked_gp_l1_reg_loss: 5375.5392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35196.7010; train_chrom_access_recon_loss: 435074.2465; train_global_loss: 3874411.3333; train_optim_loss: 3874411.3333; val_kl_reg_loss: 36309.2266; val_edge_recon_loss: 2691877.7500; val_gene_expr_recon_loss: 692537.5625; val_masked_gp_l1_reg_loss: 5375.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34296.2578; val_chrom_access_recon_loss: 431575.2500; val_global_loss: 3891971.7500; val_optim_loss: 3891971.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9656; val_auprc_score: 0.9511; val_best_acc_score: 0.9221; val_best_f1_score: 0.9253; train_kl_reg_loss: 36014.7669; train_edge_recon_loss: 2650983.9167; train_gene_expr_recon_loss: 996205.2569; train_masked_gp_l1_reg_loss: 5413.0367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33370.4937; train_chrom_access_recon_loss: 459672.7222; train_global_loss: 4181660.1944; train_optim_loss: 4181660.1944; val_kl_reg_loss: 24681.6602; val_edge_recon_loss: 2669222.7500; val_gene_expr_recon_loss: 980407.4375; val_masked_gp_l1_reg_loss: 5471.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32082.0000; val_chrom_access_recon_loss: 454381.5000; val_global_loss: 4166247.0000; val_optim_loss: 4166247.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9738; val_auprc_score: 0.9622; val_best_acc_score: 0.9310; val_best_f1_score: 0.9329; train_kl_reg_loss: 31825.9859; train_edge_recon_loss: 2653477.8333; train_gene_expr_recon_loss: 990061.1806; train_masked_gp_l1_reg_loss: 5523.5478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30970.6261; train_chrom_access_recon_loss: 459950.4444; train_global_loss: 4171809.6111; train_optim_loss: 4171809.6111; val_kl_reg_loss: 23039.6094; val_edge_recon_loss: 2660054.5000; val_gene_expr_recon_loss: 970313.8750; val_masked_gp_l1_reg_loss: 5582.1050; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29585.3105; val_chrom_access_recon_loss: 453115.9688; val_global_loss: 4141691.2500; val_optim_loss: 4141691.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9734; val_auprc_score: 0.9614; val_best_acc_score: 0.9298; val_best_f1_score: 0.9319; train_kl_reg_loss: 30566.1756; train_edge_recon_loss: 2664218.7500; train_gene_expr_recon_loss: 985614.5694; train_masked_gp_l1_reg_loss: 5578.2839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29381.6669; train_chrom_access_recon_loss: 458188.8646; train_global_loss: 4173548.3056; train_optim_loss: 4173548.3056; val_kl_reg_loss: 22900.1582; val_edge_recon_loss: 2637838.2500; val_gene_expr_recon_loss: 976056.5000; val_masked_gp_l1_reg_loss: 5571.4893; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29147.8516; val_chrom_access_recon_loss: 453846.7188; val_global_loss: 4125361.0000; val_optim_loss: 4125361.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9696; val_auprc_score: 0.9563; val_best_acc_score: 0.9219; val_best_f1_score: 0.9254; train_kl_reg_loss: 30326.5069; train_edge_recon_loss: 2649688.4444; train_gene_expr_recon_loss: 989165.3264; train_masked_gp_l1_reg_loss: 5568.9034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29002.9887; train_chrom_access_recon_loss: 458854.0660; train_global_loss: 4162606.2222; train_optim_loss: 4162606.2222; val_kl_reg_loss: 22614.3359; val_edge_recon_loss: 2686634.0000; val_gene_expr_recon_loss: 973424.1250; val_masked_gp_l1_reg_loss: 5566.0254; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28815.0547; val_chrom_access_recon_loss: 453469.8750; val_global_loss: 4170523.5000; val_optim_loss: 4170523.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9711; val_auprc_score: 0.9594; val_best_acc_score: 0.9281; val_best_f1_score: 0.9310; train_kl_reg_loss: 29961.4340; train_edge_recon_loss: 2656654.1667; train_gene_expr_recon_loss: 984215.0903; train_masked_gp_l1_reg_loss: 5566.1714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28673.9759; train_chrom_access_recon_loss: 458012.7361; train_global_loss: 4163083.5000; train_optim_loss: 4163083.5000; val_kl_reg_loss: 22498.0020; val_edge_recon_loss: 2651391.0000; val_gene_expr_recon_loss: 973832.3750; val_masked_gp_l1_reg_loss: 5566.7632; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28503.2441; val_chrom_access_recon_loss: 453462.0000; val_global_loss: 4135253.5000; val_optim_loss: 4135253.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9720; val_auprc_score: 0.9599; val_best_acc_score: 0.9310; val_best_f1_score: 0.9329; train_kl_reg_loss: 29687.7858; train_edge_recon_loss: 2656774.3611; train_gene_expr_recon_loss: 985084.1111; train_masked_gp_l1_reg_loss: 5567.7432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28376.4180; train_chrom_access_recon_loss: 458242.5278; train_global_loss: 4163732.9722; train_optim_loss: 4163732.9722; val_kl_reg_loss: 22302.9375; val_edge_recon_loss: 2657779.5000; val_gene_expr_recon_loss: 973138.6250; val_masked_gp_l1_reg_loss: 5569.3662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28222.8418; val_chrom_access_recon_loss: 453387.1250; val_global_loss: 4140400.0000; val_optim_loss: 4140400.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 21 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9666
val AUPRC score: 0.9549
val best accuracy score: 0.9159
val best F1 score: 0.9197
val target rna MSE score: 3.6953
val source rna MSE score: 3.0603
val target atac MSE score: 0.1320
val source atac MSE score: 0.0208
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
