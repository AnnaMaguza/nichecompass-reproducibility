[True]
Run timestamp: 10102023_061400_167.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_167']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6881; val_auprc_score: 0.6689; val_best_acc_score: 0.5097; val_best_f1_score: 0.6705; train_kl_reg_loss: 53894.4343; train_edge_recon_loss: 740644.2244; train_gene_expr_recon_loss: 23136878.1212; train_masked_gp_l1_reg_loss: 41457.2535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4074362.1439; train_chrom_access_recon_loss: 2315598.6155; train_global_loss: 30362834.8485; train_optim_loss: 30362834.8485; val_kl_reg_loss: 59883.6255; val_edge_recon_loss: 812941.0703; val_gene_expr_recon_loss: 21206887.0000; val_masked_gp_l1_reg_loss: 47478.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2777728.0000; val_chrom_access_recon_loss: 2178726.2812; val_global_loss: 27083643.7500; val_optim_loss: 27083643.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7087; val_auprc_score: 0.6935; val_best_acc_score: 0.5355; val_best_f1_score: 0.6788; train_kl_reg_loss: 76064.4918; train_edge_recon_loss: 740969.7292; train_gene_expr_recon_loss: 21287992.7576; train_masked_gp_l1_reg_loss: 48965.6734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1836940.3466; train_chrom_access_recon_loss: 2206688.6932; train_global_loss: 26197621.5758; train_optim_loss: 26197621.5758; val_kl_reg_loss: 74634.7402; val_edge_recon_loss: 812577.3906; val_gene_expr_recon_loss: 21008398.0000; val_masked_gp_l1_reg_loss: 49975.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1118221.3750; val_chrom_access_recon_loss: 2156938.9062; val_global_loss: 25220747.5000; val_optim_loss: 25220747.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7360; val_auprc_score: 0.7262; val_best_acc_score: 0.5846; val_best_f1_score: 0.6977; train_kl_reg_loss: 66262.0306; train_edge_recon_loss: 732551.6875; train_gene_expr_recon_loss: 21108086.3333; train_masked_gp_l1_reg_loss: 51334.9271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 781755.2197; train_chrom_access_recon_loss: 2190903.4659; train_global_loss: 24930893.8182; train_optim_loss: 24930893.8182; val_kl_reg_loss: 62047.8853; val_edge_recon_loss: 811739.9922; val_gene_expr_recon_loss: 20440104.2500; val_masked_gp_l1_reg_loss: 52370.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 533448.5000; val_chrom_access_recon_loss: 2135970.9688; val_global_loss: 24035681.0000; val_optim_loss: 24035681.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7850; val_auprc_score: 0.7714; val_best_acc_score: 0.7171; val_best_f1_score: 0.7071; train_kl_reg_loss: 63400.6854; train_edge_recon_loss: 728694.7131; train_gene_expr_recon_loss: 20931918.6061; train_masked_gp_l1_reg_loss: 52525.4814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 405790.2476; train_chrom_access_recon_loss: 2177402.0890; train_global_loss: 24359731.9091; train_optim_loss: 24359731.9091; val_kl_reg_loss: 58884.2358; val_edge_recon_loss: 803300.6172; val_gene_expr_recon_loss: 20594775.5000; val_masked_gp_l1_reg_loss: 52912.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 310763.6875; val_chrom_access_recon_loss: 2119198.8281; val_global_loss: 23939835.0000; val_optim_loss: 23939835.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8494; val_auprc_score: 0.8169; val_best_acc_score: 0.7765; val_best_f1_score: 0.7950; train_kl_reg_loss: 58762.7392; train_edge_recon_loss: 717587.8068; train_gene_expr_recon_loss: 20748453.6667; train_masked_gp_l1_reg_loss: 53759.5082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 263129.5748; train_chrom_access_recon_loss: 2161688.5114; train_global_loss: 24003381.6667; train_optim_loss: 24003381.6667; val_kl_reg_loss: 56711.8257; val_edge_recon_loss: 756823.9844; val_gene_expr_recon_loss: 20415044.0000; val_masked_gp_l1_reg_loss: 54662.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227705.1562; val_chrom_access_recon_loss: 2097258.3125; val_global_loss: 23608206.5000; val_optim_loss: 23608206.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8671; val_auprc_score: 0.8319; val_best_acc_score: 0.7939; val_best_f1_score: 0.8138; train_kl_reg_loss: 59081.0276; train_edge_recon_loss: 681786.6506; train_gene_expr_recon_loss: 20588143.9394; train_masked_gp_l1_reg_loss: 55451.7072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 203910.6998; train_chrom_access_recon_loss: 2148006.3523; train_global_loss: 23736380.4545; train_optim_loss: 23736380.4545; val_kl_reg_loss: 64862.2290; val_edge_recon_loss: 651055.0078; val_gene_expr_recon_loss: 20596718.2500; val_masked_gp_l1_reg_loss: 56204.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181772.4219; val_chrom_access_recon_loss: 2127425.2500; val_global_loss: 23678036.5000; val_optim_loss: 23678036.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8807; val_auprc_score: 0.8515; val_best_acc_score: 0.8039; val_best_f1_score: 0.8225; train_kl_reg_loss: 67562.1635; train_edge_recon_loss: 640594.0275; train_gene_expr_recon_loss: 20496385.8485; train_masked_gp_l1_reg_loss: 57177.1522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165314.5850; train_chrom_access_recon_loss: 2139973.6515; train_global_loss: 23567007.6364; train_optim_loss: 23567007.6364; val_kl_reg_loss: 68722.3965; val_edge_recon_loss: 633131.6016; val_gene_expr_recon_loss: 20283309.7500; val_masked_gp_l1_reg_loss: 58059.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151049.4531; val_chrom_access_recon_loss: 2106627.3125; val_global_loss: 23300901.0000; val_optim_loss: 23300901.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8866; val_auprc_score: 0.8550; val_best_acc_score: 0.8141; val_best_f1_score: 0.8316; train_kl_reg_loss: 67379.5501; train_edge_recon_loss: 629829.3172; train_gene_expr_recon_loss: 20395915.3030; train_masked_gp_l1_reg_loss: 58735.5418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140209.4564; train_chrom_access_recon_loss: 2132218.5436; train_global_loss: 23424287.9394; train_optim_loss: 23424287.9394; val_kl_reg_loss: 65183.0083; val_edge_recon_loss: 628960.8984; val_gene_expr_recon_loss: 19962160.2500; val_masked_gp_l1_reg_loss: 59392.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130155.2969; val_chrom_access_recon_loss: 2045044.8906; val_global_loss: 22890897.2500; val_optim_loss: 22890897.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8949; val_auprc_score: 0.8658; val_best_acc_score: 0.8221; val_best_f1_score: 0.8388; train_kl_reg_loss: 66159.0164; train_edge_recon_loss: 619763.9792; train_gene_expr_recon_loss: 20305368.6970; train_masked_gp_l1_reg_loss: 59974.2778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124044.8738; train_chrom_access_recon_loss: 2122216.7973; train_global_loss: 23297527.7879; train_optim_loss: 23297527.7879; val_kl_reg_loss: 65026.3618; val_edge_recon_loss: 620763.7734; val_gene_expr_recon_loss: 19983792.2500; val_masked_gp_l1_reg_loss: 60514.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118498.4453; val_chrom_access_recon_loss: 2074014.9219; val_global_loss: 22922609.0000; val_optim_loss: 22922609.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9075; val_auprc_score: 0.8838; val_best_acc_score: 0.8299; val_best_f1_score: 0.8454; train_kl_reg_loss: 66128.8586; train_edge_recon_loss: 610281.8958; train_gene_expr_recon_loss: 20211347.1818; train_masked_gp_l1_reg_loss: 61016.7824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114671.6405; train_chrom_access_recon_loss: 2115185.7614; train_global_loss: 23178632.1515; train_optim_loss: 23178632.1515; val_kl_reg_loss: 66596.9609; val_edge_recon_loss: 612407.4375; val_gene_expr_recon_loss: 20057819.7500; val_masked_gp_l1_reg_loss: 61626.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111038.6172; val_chrom_access_recon_loss: 2079194.2969; val_global_loss: 22988682.0000; val_optim_loss: 22988682.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9173; val_auprc_score: 0.8918; val_best_acc_score: 0.8509; val_best_f1_score: 0.8575; train_kl_reg_loss: 65386.9125; train_edge_recon_loss: 603475.0871; train_gene_expr_recon_loss: 20148904.0606; train_masked_gp_l1_reg_loss: 62079.2112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107668.3017; train_chrom_access_recon_loss: 2108515.6061; train_global_loss: 23096029.1818; train_optim_loss: 23096029.1818; val_kl_reg_loss: 66531.6211; val_edge_recon_loss: 603078.5078; val_gene_expr_recon_loss: 19956254.5000; val_masked_gp_l1_reg_loss: 62600.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104257.5234; val_chrom_access_recon_loss: 2081848.5938; val_global_loss: 22874571.5000; val_optim_loss: 22874571.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9161; val_auprc_score: 0.8877; val_best_acc_score: 0.8463; val_best_f1_score: 0.8581; train_kl_reg_loss: 64518.1529; train_edge_recon_loss: 601461.9972; train_gene_expr_recon_loss: 20064363.1212; train_masked_gp_l1_reg_loss: 62983.6497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101481.5268; train_chrom_access_recon_loss: 2101591.1932; train_global_loss: 22996399.8182; train_optim_loss: 22996399.8182; val_kl_reg_loss: 66012.7715; val_edge_recon_loss: 596779.1719; val_gene_expr_recon_loss: 19739524.2500; val_masked_gp_l1_reg_loss: 63374.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98448.4297; val_chrom_access_recon_loss: 2036520.1250; val_global_loss: 22600658.2500; val_optim_loss: 22600658.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9165; val_auprc_score: 0.8893; val_best_acc_score: 0.8463; val_best_f1_score: 0.8586; train_kl_reg_loss: 64144.2461; train_edge_recon_loss: 598080.1733; train_gene_expr_recon_loss: 19993431.1818; train_masked_gp_l1_reg_loss: 63715.4638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96249.2461; train_chrom_access_recon_loss: 2094991.4205; train_global_loss: 22910611.8182; train_optim_loss: 22910611.8182; val_kl_reg_loss: 62775.8774; val_edge_recon_loss: 601258.1094; val_gene_expr_recon_loss: 19548237.5000; val_masked_gp_l1_reg_loss: 64085.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95312.4375; val_chrom_access_recon_loss: 2019037.4688; val_global_loss: 22390707.0000; val_optim_loss: 22390707.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9257; val_auprc_score: 0.9061; val_best_acc_score: 0.8581; val_best_f1_score: 0.8665; train_kl_reg_loss: 63242.3162; train_edge_recon_loss: 592523.0161; train_gene_expr_recon_loss: 19924270.9394; train_masked_gp_l1_reg_loss: 64512.6171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93422.2681; train_chrom_access_recon_loss: 2087904.6250; train_global_loss: 22825875.5758; train_optim_loss: 22825875.5758; val_kl_reg_loss: 61507.3008; val_edge_recon_loss: 601912.3281; val_gene_expr_recon_loss: 19643627.5000; val_masked_gp_l1_reg_loss: 64902.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91639.7500; val_chrom_access_recon_loss: 2054554.6094; val_global_loss: 22518143.2500; val_optim_loss: 22518143.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9282; val_auprc_score: 0.9076; val_best_acc_score: 0.8589; val_best_f1_score: 0.8675; train_kl_reg_loss: 62190.1669; train_edge_recon_loss: 594046.1496; train_gene_expr_recon_loss: 19862903.9394; train_masked_gp_l1_reg_loss: 65231.1051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90449.1856; train_chrom_access_recon_loss: 2082343.3182; train_global_loss: 22757163.9091; train_optim_loss: 22757163.9091; val_kl_reg_loss: 61855.3315; val_edge_recon_loss: 594705.3125; val_gene_expr_recon_loss: 19657576.7500; val_masked_gp_l1_reg_loss: 65537.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89520.7188; val_chrom_access_recon_loss: 2030106.1719; val_global_loss: 22499302.0000; val_optim_loss: 22499302.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9310; val_auprc_score: 0.9024; val_best_acc_score: 0.8638; val_best_f1_score: 0.8723; train_kl_reg_loss: 61299.6380; train_edge_recon_loss: 591540.1222; train_gene_expr_recon_loss: 19825324.3030; train_masked_gp_l1_reg_loss: 65830.0433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88675.5329; train_chrom_access_recon_loss: 2075339.2273; train_global_loss: 22708008.7576; train_optim_loss: 22708008.7576; val_kl_reg_loss: 60309.9707; val_edge_recon_loss: 592495.1094; val_gene_expr_recon_loss: 19576108.7500; val_masked_gp_l1_reg_loss: 66211.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88575.9375; val_chrom_access_recon_loss: 2031534.8438; val_global_loss: 22415236.0000; val_optim_loss: 22415236.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9280; val_auprc_score: 0.9039; val_best_acc_score: 0.8641; val_best_f1_score: 0.8705; train_kl_reg_loss: 60600.8200; train_edge_recon_loss: 588575.8428; train_gene_expr_recon_loss: 19752307.3030; train_masked_gp_l1_reg_loss: 66483.1286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87316.5388; train_chrom_access_recon_loss: 2070306.9962; train_global_loss: 22625590.7576; train_optim_loss: 22625590.7576; val_kl_reg_loss: 62921.4268; val_edge_recon_loss: 596909.9453; val_gene_expr_recon_loss: 19607729.2500; val_masked_gp_l1_reg_loss: 66799.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86828.6484; val_chrom_access_recon_loss: 2017072.1719; val_global_loss: 22438260.7500; val_optim_loss: 22438260.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9414; val_auprc_score: 0.9250; val_best_acc_score: 0.8786; val_best_f1_score: 0.8823; train_kl_reg_loss: 61657.6649; train_edge_recon_loss: 586808.5701; train_gene_expr_recon_loss: 19721164.3333; train_masked_gp_l1_reg_loss: 66250.9109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69279.0239; train_chrom_access_recon_loss: 2065519.0152; train_global_loss: 22570679.5152; train_optim_loss: 22570679.5152; val_kl_reg_loss: 61486.3281; val_edge_recon_loss: 587322.8047; val_gene_expr_recon_loss: 19601122.5000; val_masked_gp_l1_reg_loss: 65910.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63532.4219; val_chrom_access_recon_loss: 2033978.7188; val_global_loss: 22413352.5000; val_optim_loss: 22413352.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9392; val_auprc_score: 0.9205; val_best_acc_score: 0.8729; val_best_f1_score: 0.8788; train_kl_reg_loss: 61154.3330; train_edge_recon_loss: 586027.2850; train_gene_expr_recon_loss: 19695264.1515; train_masked_gp_l1_reg_loss: 65835.6803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62734.2137; train_chrom_access_recon_loss: 2061652.2121; train_global_loss: 22532667.9394; train_optim_loss: 22532667.9394; val_kl_reg_loss: 61219.3726; val_edge_recon_loss: 590716.5156; val_gene_expr_recon_loss: 19512075.7500; val_masked_gp_l1_reg_loss: 65798.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62253.9922; val_chrom_access_recon_loss: 2020176.7031; val_global_loss: 22312240.7500; val_optim_loss: 22312240.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9376; val_auprc_score: 0.9178; val_best_acc_score: 0.8710; val_best_f1_score: 0.8769; train_kl_reg_loss: 61270.0236; train_edge_recon_loss: 586120.0710; train_gene_expr_recon_loss: 19704142.5152; train_masked_gp_l1_reg_loss: 65804.8308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61902.5049; train_chrom_access_recon_loss: 2062250.9602; train_global_loss: 22541490.9394; train_optim_loss: 22541490.9394; val_kl_reg_loss: 61778.7959; val_edge_recon_loss: 588784.8594; val_gene_expr_recon_loss: 19662599.7500; val_masked_gp_l1_reg_loss: 65796.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61628.7422; val_chrom_access_recon_loss: 2061544.9219; val_global_loss: 22502132.0000; val_optim_loss: 22502132.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9414; val_auprc_score: 0.9230; val_best_acc_score: 0.8802; val_best_f1_score: 0.8837; train_kl_reg_loss: 61390.8907; train_edge_recon_loss: 586559.7112; train_gene_expr_recon_loss: 19669658.0909; train_masked_gp_l1_reg_loss: 65811.5998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61353.1802; train_chrom_access_recon_loss: 2058834.7557; train_global_loss: 22503608.3333; train_optim_loss: 22503608.3333; val_kl_reg_loss: 61882.6030; val_edge_recon_loss: 585216.3906; val_gene_expr_recon_loss: 19514536.0000; val_masked_gp_l1_reg_loss: 65832.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61166.8477; val_chrom_access_recon_loss: 2033903.3281; val_global_loss: 22322536.5000; val_optim_loss: 22322536.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9317; val_auprc_score: 0.9088; val_best_acc_score: 0.8686; val_best_f1_score: 0.8754; train_kl_reg_loss: 61271.8269; train_edge_recon_loss: 586609.8750; train_gene_expr_recon_loss: 19671795.9091; train_masked_gp_l1_reg_loss: 65839.8836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60919.9455; train_chrom_access_recon_loss: 2060749.6591; train_global_loss: 22507187.0909; train_optim_loss: 22507187.0909; val_kl_reg_loss: 61744.3745; val_edge_recon_loss: 594759.3516; val_gene_expr_recon_loss: 19465502.2500; val_masked_gp_l1_reg_loss: 65849.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60774.8750; val_chrom_access_recon_loss: 2020749.7500; val_global_loss: 22269379.7500; val_optim_loss: 22269379.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9414; val_auprc_score: 0.9243; val_best_acc_score: 0.8812; val_best_f1_score: 0.8859; train_kl_reg_loss: 61604.6026; train_edge_recon_loss: 585748.8873; train_gene_expr_recon_loss: 19689841.6970; train_masked_gp_l1_reg_loss: 65882.5110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60534.3159; train_chrom_access_recon_loss: 2062958.1326; train_global_loss: 22526570.0303; train_optim_loss: 22526570.0303; val_kl_reg_loss: 62018.9170; val_edge_recon_loss: 592542.8281; val_gene_expr_recon_loss: 19398491.7500; val_masked_gp_l1_reg_loss: 65911.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60432.7422; val_chrom_access_recon_loss: 2012707.9375; val_global_loss: 22192105.7500; val_optim_loss: 22192105.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9373; val_auprc_score: 0.9166; val_best_acc_score: 0.8761; val_best_f1_score: 0.8800; train_kl_reg_loss: 61575.5116; train_edge_recon_loss: 585389.6506; train_gene_expr_recon_loss: 19679735.6061; train_masked_gp_l1_reg_loss: 65923.8168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60185.5556; train_chrom_access_recon_loss: 2060734.2197; train_global_loss: 22513544.3939; train_optim_loss: 22513544.3939; val_kl_reg_loss: 61560.9946; val_edge_recon_loss: 590510.6953; val_gene_expr_recon_loss: 19339611.0000; val_masked_gp_l1_reg_loss: 65956.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60043.4922; val_chrom_access_recon_loss: 2003019.9062; val_global_loss: 22120703.0000; val_optim_loss: 22120703.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9406; val_auprc_score: 0.9250; val_best_acc_score: 0.8804; val_best_f1_score: 0.8846; train_kl_reg_loss: 61736.8878; train_edge_recon_loss: 585494.8475; train_gene_expr_recon_loss: 19667196.2424; train_masked_gp_l1_reg_loss: 65967.1700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59848.8208; train_chrom_access_recon_loss: 2059347.9602; train_global_loss: 22499591.8182; train_optim_loss: 22499591.8182; val_kl_reg_loss: 61819.4189; val_edge_recon_loss: 585269.6250; val_gene_expr_recon_loss: 19597940.7500; val_masked_gp_l1_reg_loss: 65984.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59681.7305; val_chrom_access_recon_loss: 2039620.6250; val_global_loss: 22410316.2500; val_optim_loss: 22410316.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9369; val_auprc_score: 0.9189; val_best_acc_score: 0.8662; val_best_f1_score: 0.8744; train_kl_reg_loss: 63828.9491; train_edge_recon_loss: 702868.8239; train_gene_expr_recon_loss: 18487930.5152; train_masked_gp_l1_reg_loss: 65852.5011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58286.0278; train_chrom_access_recon_loss: 2044929.4583; train_global_loss: 21423696.2121; train_optim_loss: 21423696.2121; val_kl_reg_loss: 26253.9314; val_edge_recon_loss: 710043.5938; val_gene_expr_recon_loss: 18396518.5000; val_masked_gp_l1_reg_loss: 65778.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57885.7812; val_chrom_access_recon_loss: 1945655.2031; val_global_loss: 21202134.7500; val_optim_loss: 21202134.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9336; val_auprc_score: 0.9129; val_best_acc_score: 0.8595; val_best_f1_score: 0.8703; train_kl_reg_loss: 64846.4019; train_edge_recon_loss: 685281.8343; train_gene_expr_recon_loss: 18451003.1515; train_masked_gp_l1_reg_loss: 65702.7991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57801.3599; train_chrom_access_recon_loss: 1962992.0038; train_global_loss: 21287627.4242; train_optim_loss: 21287627.4242; val_kl_reg_loss: 27032.4014; val_edge_recon_loss: 708341.3984; val_gene_expr_recon_loss: 18314974.0000; val_masked_gp_l1_reg_loss: 65621.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57713.3086; val_chrom_access_recon_loss: 1916634.7969; val_global_loss: 21090319.2500; val_optim_loss: 21090319.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9350; val_auprc_score: 0.9165; val_best_acc_score: 0.8665; val_best_f1_score: 0.8723; train_kl_reg_loss: 61220.0951; train_edge_recon_loss: 681967.6742; train_gene_expr_recon_loss: 18437769.2121; train_masked_gp_l1_reg_loss: 65543.1755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57599.5160; train_chrom_access_recon_loss: 1950272.4110; train_global_loss: 21254372.0000; train_optim_loss: 21254372.0000; val_kl_reg_loss: 26689.1875; val_edge_recon_loss: 703772.1719; val_gene_expr_recon_loss: 18339604.0000; val_masked_gp_l1_reg_loss: 65466.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57372.9922; val_chrom_access_recon_loss: 1908612.7969; val_global_loss: 21101516.0000; val_optim_loss: 21101516.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9388; val_auprc_score: 0.9183; val_best_acc_score: 0.8684; val_best_f1_score: 0.8761; train_kl_reg_loss: 59122.0806; train_edge_recon_loss: 679703.2320; train_gene_expr_recon_loss: 18419517.7273; train_masked_gp_l1_reg_loss: 65373.2797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57170.4814; train_chrom_access_recon_loss: 1944108.2633; train_global_loss: 21224995.0303; train_optim_loss: 21224995.0303; val_kl_reg_loss: 26294.3479; val_edge_recon_loss: 698605.1875; val_gene_expr_recon_loss: 18273154.7500; val_masked_gp_l1_reg_loss: 65276.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56975.8125; val_chrom_access_recon_loss: 1914168.1875; val_global_loss: 21034474.7500; val_optim_loss: 21034474.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9422; val_auprc_score: 0.9231; val_best_acc_score: 0.8756; val_best_f1_score: 0.8816; train_kl_reg_loss: 56727.5339; train_edge_recon_loss: 674653.8788; train_gene_expr_recon_loss: 18386649.1818; train_masked_gp_l1_reg_loss: 65187.0484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56774.2143; train_chrom_access_recon_loss: 1938831.7955; train_global_loss: 21178823.6667; train_optim_loss: 21178823.6667; val_kl_reg_loss: 26142.3052; val_edge_recon_loss: 688449.9453; val_gene_expr_recon_loss: 18387305.0000; val_masked_gp_l1_reg_loss: 65093.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56517.4727; val_chrom_access_recon_loss: 1919636.0312; val_global_loss: 21143145.2500; val_optim_loss: 21143145.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9348; val_auprc_score: 0.9165; val_best_acc_score: 0.8684; val_best_f1_score: 0.8743; train_kl_reg_loss: 55054.2270; train_edge_recon_loss: 669643.5758; train_gene_expr_recon_loss: 18390636.3030; train_masked_gp_l1_reg_loss: 64996.8183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56287.5264; train_chrom_access_recon_loss: 1938761.8447; train_global_loss: 21175380.2424; train_optim_loss: 21175380.2424; val_kl_reg_loss: 25131.8044; val_edge_recon_loss: 684388.6016; val_gene_expr_recon_loss: 18082254.7500; val_masked_gp_l1_reg_loss: 64899.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56035.8203; val_chrom_access_recon_loss: 1884487.0312; val_global_loss: 20797198.2500; val_optim_loss: 20797198.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9400; val_auprc_score: 0.9220; val_best_acc_score: 0.8764; val_best_f1_score: 0.8816; train_kl_reg_loss: 53734.0932; train_edge_recon_loss: 663853.3116; train_gene_expr_recon_loss: 18381232.4545; train_masked_gp_l1_reg_loss: 64809.7640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55826.5789; train_chrom_access_recon_loss: 1937698.3087; train_global_loss: 21157154.3939; train_optim_loss: 21157154.3939; val_kl_reg_loss: 25662.4875; val_edge_recon_loss: 672230.9375; val_gene_expr_recon_loss: 18210883.7500; val_masked_gp_l1_reg_loss: 64726.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55602.2109; val_chrom_access_recon_loss: 1900599.1719; val_global_loss: 20929704.5000; val_optim_loss: 20929704.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9395; val_auprc_score: 0.9261; val_best_acc_score: 0.8721; val_best_f1_score: 0.8766; train_kl_reg_loss: 52055.6899; train_edge_recon_loss: 657148.3883; train_gene_expr_recon_loss: 18374708.7576; train_masked_gp_l1_reg_loss: 64636.7483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55389.1172; train_chrom_access_recon_loss: 1937088.3712; train_global_loss: 21141027.0000; train_optim_loss: 21141027.0000; val_kl_reg_loss: 25564.4585; val_edge_recon_loss: 658962.2891; val_gene_expr_recon_loss: 18172291.2500; val_masked_gp_l1_reg_loss: 64535.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55119.6172; val_chrom_access_recon_loss: 1890558.5469; val_global_loss: 20867033.0000; val_optim_loss: 20867033.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9342; val_auprc_score: 0.9196; val_best_acc_score: 0.8665; val_best_f1_score: 0.8721; train_kl_reg_loss: 50867.3181; train_edge_recon_loss: 648589.2491; train_gene_expr_recon_loss: 18376509.9091; train_masked_gp_l1_reg_loss: 64449.1828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54882.4154; train_chrom_access_recon_loss: 1935992.9242; train_global_loss: 21131291.2121; train_optim_loss: 21131291.2121; val_kl_reg_loss: 25813.5781; val_edge_recon_loss: 653458.6562; val_gene_expr_recon_loss: 18136534.0000; val_masked_gp_l1_reg_loss: 64367.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54667.8555; val_chrom_access_recon_loss: 1912609.3438; val_global_loss: 20847451.5000; val_optim_loss: 20847451.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9294; val_auprc_score: 0.9115; val_best_acc_score: 0.8635; val_best_f1_score: 0.8683; train_kl_reg_loss: 49712.8064; train_edge_recon_loss: 640432.7576; train_gene_expr_recon_loss: 18386993.7879; train_masked_gp_l1_reg_loss: 64287.9251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54433.7783; train_chrom_access_recon_loss: 1938371.0436; train_global_loss: 21134232.1515; train_optim_loss: 21134232.1515; val_kl_reg_loss: 27476.9897; val_edge_recon_loss: 640383.6875; val_gene_expr_recon_loss: 18200890.2500; val_masked_gp_l1_reg_loss: 64196.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54202.6758; val_chrom_access_recon_loss: 1921123.5938; val_global_loss: 20908272.7500; val_optim_loss: 20908272.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9335; val_auprc_score: 0.9121; val_best_acc_score: 0.8716; val_best_f1_score: 0.8784; train_kl_reg_loss: 49582.4177; train_edge_recon_loss: 636232.7973; train_gene_expr_recon_loss: 18350951.8182; train_masked_gp_l1_reg_loss: 64167.7630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53304.4296; train_chrom_access_recon_loss: 1933474.0341; train_global_loss: 21087713.0606; train_optim_loss: 21087713.0606; val_kl_reg_loss: 27541.9836; val_edge_recon_loss: 639680.8750; val_gene_expr_recon_loss: 18293457.2500; val_masked_gp_l1_reg_loss: 64144.6523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53041.4805; val_chrom_access_recon_loss: 1925274.9688; val_global_loss: 21003141.2500; val_optim_loss: 21003141.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9324; val_auprc_score: 0.9139; val_best_acc_score: 0.8662; val_best_f1_score: 0.8737; train_kl_reg_loss: 49601.9306; train_edge_recon_loss: 635270.3314; train_gene_expr_recon_loss: 18388020.9091; train_masked_gp_l1_reg_loss: 64130.8784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52956.8046; train_chrom_access_recon_loss: 1968040.5057; train_global_loss: 21158021.3939; train_optim_loss: 21158021.3939; val_kl_reg_loss: 28784.7427; val_edge_recon_loss: 638199.1250; val_gene_expr_recon_loss: 18322083.5000; val_masked_gp_l1_reg_loss: 64113.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52882.9297; val_chrom_access_recon_loss: 2028139.9219; val_global_loss: 21134203.2500; val_optim_loss: 21134203.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9299; val_auprc_score: 0.9095; val_best_acc_score: 0.8646; val_best_f1_score: 0.8730; train_kl_reg_loss: 51261.1006; train_edge_recon_loss: 634164.3305; train_gene_expr_recon_loss: 18428934.6667; train_masked_gp_l1_reg_loss: 64079.2418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52769.0920; train_chrom_access_recon_loss: 2058438.4527; train_global_loss: 21289646.7576; train_optim_loss: 21289646.7576; val_kl_reg_loss: 28669.0369; val_edge_recon_loss: 639559.8672; val_gene_expr_recon_loss: 18210344.2500; val_masked_gp_l1_reg_loss: 64053.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52639.6406; val_chrom_access_recon_loss: 1982256.2188; val_global_loss: 20977523.5000; val_optim_loss: 20977523.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9307; val_auprc_score: 0.9103; val_best_acc_score: 0.8630; val_best_f1_score: 0.8713; train_kl_reg_loss: 51069.5954; train_edge_recon_loss: 633987.7055; train_gene_expr_recon_loss: 18388034.6970; train_masked_gp_l1_reg_loss: 64037.0552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52525.6214; train_chrom_access_recon_loss: 2022274.3523; train_global_loss: 21211928.9394; train_optim_loss: 21211928.9394; val_kl_reg_loss: 28757.8853; val_edge_recon_loss: 639819.9688; val_gene_expr_recon_loss: 18250668.5000; val_masked_gp_l1_reg_loss: 64021.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52411.1562; val_chrom_access_recon_loss: 1968500.5312; val_global_loss: 21004180.2500; val_optim_loss: 21004180.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 30 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9388
val AUPRC score: 0.9208
val best accuracy score: 0.8718
val best F1 score: 0.8780
val target rna MSE score: 1.7636
val source rna MSE score: 0.7737
val target atac MSE score: 0.3349
val source atac MSE score: 0.1944
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
