[True]
Run timestamp: 07092023_021847_240.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_240']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2393 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5107, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2393
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2393

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6731; val_auprc_score: 0.6485; val_best_acc_score: 0.5126; val_best_f1_score: 0.6717; train_kl_reg_loss: 43603.0305; train_edge_recon_loss: 3560641.3523; train_gene_expr_recon_loss: 12762279.1667; train_masked_gp_l1_reg_loss: 34138.1584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5593941.9432; train_chrom_access_recon_loss: 10289314.4242; train_global_loss: 32283918.1212; train_optim_loss: 32283918.1212; val_kl_reg_loss: 79521.9824; val_edge_recon_loss: 4064726.8125; val_gene_expr_recon_loss: 11562658.6250; val_masked_gp_l1_reg_loss: 32607.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2033082.5000; val_chrom_access_recon_loss: 9647911.3750; val_global_loss: 27420508.5000; val_optim_loss: 27420508.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6982; val_auprc_score: 0.6798; val_best_acc_score: 0.5712; val_best_f1_score: 0.6897; train_kl_reg_loss: 100911.9226; train_edge_recon_loss: 3536583.4924; train_gene_expr_recon_loss: 11344488.5606; train_masked_gp_l1_reg_loss: 30051.2886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 745651.8523; train_chrom_access_recon_loss: 9756245.6515; train_global_loss: 25513932.6970; train_optim_loss: 25513932.6970; val_kl_reg_loss: 114020.7666; val_edge_recon_loss: 4060492.6875; val_gene_expr_recon_loss: 11238323.8750; val_masked_gp_l1_reg_loss: 28595.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 237319.1875; val_chrom_access_recon_loss: 9611945.3750; val_global_loss: 25290697.5000; val_optim_loss: 25290697.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7292; val_auprc_score: 0.6983; val_best_acc_score: 0.6706; val_best_f1_score: 0.7016; train_kl_reg_loss: 97448.7592; train_edge_recon_loss: 3520748.9508; train_gene_expr_recon_loss: 11147640.0303; train_masked_gp_l1_reg_loss: 28461.7607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175330.9394; train_chrom_access_recon_loss: 9665371.5606; train_global_loss: 24635002.0303; train_optim_loss: 24635002.0303; val_kl_reg_loss: 91487.3633; val_edge_recon_loss: 4047136.4062; val_gene_expr_recon_loss: 11139305.7500; val_masked_gp_l1_reg_loss: 28593.4473; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141373.8594; val_chrom_access_recon_loss: 9530023.7500; val_global_loss: 24977919.7500; val_optim_loss: 24977919.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7721; val_auprc_score: 0.7464; val_best_acc_score: 0.6762; val_best_f1_score: 0.7360; train_kl_reg_loss: 86917.2150; train_edge_recon_loss: 3509569.6856; train_gene_expr_recon_loss: 11046097.3939; train_masked_gp_l1_reg_loss: 29279.3926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127946.5384; train_chrom_access_recon_loss: 9598442.7576; train_global_loss: 24398253.0606; train_optim_loss: 24398253.0606; val_kl_reg_loss: 85593.1025; val_edge_recon_loss: 3981847.4688; val_gene_expr_recon_loss: 10975185.8750; val_masked_gp_l1_reg_loss: 30197.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118184.6016; val_chrom_access_recon_loss: 9480248.3750; val_global_loss: 24671257.7500; val_optim_loss: 24671257.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8156; val_auprc_score: 0.8058; val_best_acc_score: 0.7332; val_best_f1_score: 0.7564; train_kl_reg_loss: 74065.5484; train_edge_recon_loss: 3472601.6212; train_gene_expr_recon_loss: 10984690.3485; train_masked_gp_l1_reg_loss: 31318.3543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111441.2269; train_chrom_access_recon_loss: 9548680.7727; train_global_loss: 24222797.8788; train_optim_loss: 24222797.8788; val_kl_reg_loss: 61357.7417; val_edge_recon_loss: 3662540.6250; val_gene_expr_recon_loss: 10852428.8750; val_masked_gp_l1_reg_loss: 32494.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105709.6406; val_chrom_access_recon_loss: 9388538.3750; val_global_loss: 24103069.7500; val_optim_loss: 24103069.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8670; val_auprc_score: 0.8517; val_best_acc_score: 0.7859; val_best_f1_score: 0.7950; train_kl_reg_loss: 64591.9573; train_edge_recon_loss: 3236821.0379; train_gene_expr_recon_loss: 10927575.8636; train_masked_gp_l1_reg_loss: 34201.0489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102071.3311; train_chrom_access_recon_loss: 9484265.0000; train_global_loss: 23849526.2424; train_optim_loss: 23849526.2424; val_kl_reg_loss: 73532.4229; val_edge_recon_loss: 3098428.2188; val_gene_expr_recon_loss: 11013109.1250; val_masked_gp_l1_reg_loss: 35409.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99269.2812; val_chrom_access_recon_loss: 9581097.1250; val_global_loss: 23900844.5000; val_optim_loss: 23900844.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8912; val_auprc_score: 0.8581; val_best_acc_score: 0.8208; val_best_f1_score: 0.8349; train_kl_reg_loss: 87472.2940; train_edge_recon_loss: 2969005.2083; train_gene_expr_recon_loss: 10873940.6061; train_masked_gp_l1_reg_loss: 36455.2214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98906.9590; train_chrom_access_recon_loss: 9451037.0455; train_global_loss: 23516817.2424; train_optim_loss: 23516817.2424; val_kl_reg_loss: 96441.9648; val_edge_recon_loss: 2933466.6250; val_gene_expr_recon_loss: 10761030.6250; val_masked_gp_l1_reg_loss: 37512.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97663.2734; val_chrom_access_recon_loss: 9289967.1250; val_global_loss: 23216082.0000; val_optim_loss: 23216082.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9092; val_auprc_score: 0.8777; val_best_acc_score: 0.8418; val_best_f1_score: 0.8531; train_kl_reg_loss: 100445.0560; train_edge_recon_loss: 2862918.6174; train_gene_expr_recon_loss: 10807503.6667; train_masked_gp_l1_reg_loss: 37897.9830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95918.3973; train_chrom_access_recon_loss: 9393250.8636; train_global_loss: 23297934.5152; train_optim_loss: 23297934.5152; val_kl_reg_loss: 94973.3828; val_edge_recon_loss: 2876513.7500; val_gene_expr_recon_loss: 10737942.6250; val_masked_gp_l1_reg_loss: 38549.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94542.6875; val_chrom_access_recon_loss: 9242190.1250; val_global_loss: 23084712.7500; val_optim_loss: 23084712.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9133; val_auprc_score: 0.8866; val_best_acc_score: 0.8466; val_best_f1_score: 0.8568; train_kl_reg_loss: 99889.5600; train_edge_recon_loss: 2838595.3333; train_gene_expr_recon_loss: 10765146.2121; train_masked_gp_l1_reg_loss: 39152.0952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93103.6889; train_chrom_access_recon_loss: 9360586.4848; train_global_loss: 23196473.3939; train_optim_loss: 23196473.3939; val_kl_reg_loss: 97261.7393; val_edge_recon_loss: 2850100.4688; val_gene_expr_recon_loss: 10669029.3750; val_masked_gp_l1_reg_loss: 39813.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91713.9219; val_chrom_access_recon_loss: 9178927.6250; val_global_loss: 22926847.2500; val_optim_loss: 22926847.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9190; val_auprc_score: 0.8977; val_best_acc_score: 0.8530; val_best_f1_score: 0.8628; train_kl_reg_loss: 100397.3320; train_edge_recon_loss: 2804703.2576; train_gene_expr_recon_loss: 10710037.5606; train_masked_gp_l1_reg_loss: 40366.3786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90646.2404; train_chrom_access_recon_loss: 9316818.3939; train_global_loss: 23062969.0909; train_optim_loss: 23062969.0909; val_kl_reg_loss: 101309.1445; val_edge_recon_loss: 2836269.1562; val_gene_expr_recon_loss: 10720303.0000; val_masked_gp_l1_reg_loss: 40861.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89710.1562; val_chrom_access_recon_loss: 9270541.1250; val_global_loss: 23058993.5000; val_optim_loss: 23058993.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9217; val_auprc_score: 0.8959; val_best_acc_score: 0.8622; val_best_f1_score: 0.8711; train_kl_reg_loss: 99115.5043; train_edge_recon_loss: 2799560.3523; train_gene_expr_recon_loss: 10670082.7424; train_masked_gp_l1_reg_loss: 41341.8068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89101.7765; train_chrom_access_recon_loss: 9277772.0606; train_global_loss: 22976974.3333; train_optim_loss: 22976974.3333; val_kl_reg_loss: 95308.3926; val_edge_recon_loss: 2796703.9688; val_gene_expr_recon_loss: 10573170.2500; val_masked_gp_l1_reg_loss: 41810.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88543.5781; val_chrom_access_recon_loss: 9196059.1250; val_global_loss: 22791596.7500; val_optim_loss: 22791596.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9219; val_auprc_score: 0.8976; val_best_acc_score: 0.8595; val_best_f1_score: 0.8681; train_kl_reg_loss: 96190.8944; train_edge_recon_loss: 2800825.9848; train_gene_expr_recon_loss: 10634739.5152; train_masked_gp_l1_reg_loss: 42326.7132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88188.8095; train_chrom_access_recon_loss: 9253008.1515; train_global_loss: 22915280.1212; train_optim_loss: 22915280.1212; val_kl_reg_loss: 94926.2969; val_edge_recon_loss: 2814919.7188; val_gene_expr_recon_loss: 10615179.7500; val_masked_gp_l1_reg_loss: 42772.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87654.8516; val_chrom_access_recon_loss: 9149422.7500; val_global_loss: 22804875.7500; val_optim_loss: 22804875.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9295; val_auprc_score: 0.9021; val_best_acc_score: 0.8684; val_best_f1_score: 0.8750; train_kl_reg_loss: 95470.2852; train_edge_recon_loss: 2795271.5720; train_gene_expr_recon_loss: 10587681.1667; train_masked_gp_l1_reg_loss: 43175.1435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87217.2663; train_chrom_access_recon_loss: 9212705.0000; train_global_loss: 22821520.5152; train_optim_loss: 22821520.5152; val_kl_reg_loss: 94134.8076; val_edge_recon_loss: 2792318.0312; val_gene_expr_recon_loss: 10580395.6250; val_masked_gp_l1_reg_loss: 43538.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86822.0938; val_chrom_access_recon_loss: 9122033.3750; val_global_loss: 22719243.2500; val_optim_loss: 22719243.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9245; val_auprc_score: 0.8969; val_best_acc_score: 0.8649; val_best_f1_score: 0.8737; train_kl_reg_loss: 94512.1226; train_edge_recon_loss: 2771086.0417; train_gene_expr_recon_loss: 10558140.7121; train_masked_gp_l1_reg_loss: 43970.8014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86740.8213; train_chrom_access_recon_loss: 9190827.3788; train_global_loss: 22745277.8788; train_optim_loss: 22745277.8788; val_kl_reg_loss: 91113.4639; val_edge_recon_loss: 2804040.4688; val_gene_expr_recon_loss: 10479506.8750; val_masked_gp_l1_reg_loss: 44396.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86597.8281; val_chrom_access_recon_loss: 9072246.3750; val_global_loss: 22577901.0000; val_optim_loss: 22577901.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9195; val_auprc_score: 0.8859; val_best_acc_score: 0.8662; val_best_f1_score: 0.8744; train_kl_reg_loss: 94050.6431; train_edge_recon_loss: 2764318.9280; train_gene_expr_recon_loss: 10516447.5606; train_masked_gp_l1_reg_loss: 44774.3258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85970.3576; train_chrom_access_recon_loss: 9157349.3182; train_global_loss: 22662911.0606; train_optim_loss: 22662911.0606; val_kl_reg_loss: 92711.4111; val_edge_recon_loss: 2799200.4062; val_gene_expr_recon_loss: 10433043.6250; val_masked_gp_l1_reg_loss: 45174.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86035.8516; val_chrom_access_recon_loss: 8959647.6250; val_global_loss: 22415814.5000; val_optim_loss: 22415814.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9301; val_auprc_score: 0.9021; val_best_acc_score: 0.8761; val_best_f1_score: 0.8822; train_kl_reg_loss: 92259.7959; train_edge_recon_loss: 2761204.8977; train_gene_expr_recon_loss: 10482580.3788; train_masked_gp_l1_reg_loss: 45479.6333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85976.4865; train_chrom_access_recon_loss: 9124673.1970; train_global_loss: 22592174.3333; train_optim_loss: 22592174.3333; val_kl_reg_loss: 90302.8623; val_edge_recon_loss: 2774117.0000; val_gene_expr_recon_loss: 10401005.8750; val_masked_gp_l1_reg_loss: 45854.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86127.1094; val_chrom_access_recon_loss: 9001096.1250; val_global_loss: 22398502.5000; val_optim_loss: 22398502.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9295; val_auprc_score: 0.9073; val_best_acc_score: 0.8710; val_best_f1_score: 0.8781; train_kl_reg_loss: 91923.9083; train_edge_recon_loss: 2760339.9205; train_gene_expr_recon_loss: 10460312.7273; train_masked_gp_l1_reg_loss: 46183.5758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85804.5160; train_chrom_access_recon_loss: 9102279.8636; train_global_loss: 22546844.4848; train_optim_loss: 22546844.4848; val_kl_reg_loss: 89351.3271; val_edge_recon_loss: 2790276.6250; val_gene_expr_recon_loss: 10398084.3750; val_masked_gp_l1_reg_loss: 46537.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85891.8906; val_chrom_access_recon_loss: 9002995.2500; val_global_loss: 22413136.2500; val_optim_loss: 22413136.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9321; val_auprc_score: 0.9057; val_best_acc_score: 0.8812; val_best_f1_score: 0.8869; train_kl_reg_loss: 90469.6853; train_edge_recon_loss: 2756619.8750; train_gene_expr_recon_loss: 10420140.4091; train_masked_gp_l1_reg_loss: 46832.0640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86029.2720; train_chrom_access_recon_loss: 9067828.6364; train_global_loss: 22467919.9697; train_optim_loss: 22467919.9697; val_kl_reg_loss: 90827.1729; val_edge_recon_loss: 2783259.1250; val_gene_expr_recon_loss: 10374631.3750; val_masked_gp_l1_reg_loss: 47190.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85545.0156; val_chrom_access_recon_loss: 8988659.0000; val_global_loss: 22370112.7500; val_optim_loss: 22370112.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9360; val_auprc_score: 0.9084; val_best_acc_score: 0.8799; val_best_f1_score: 0.8853; train_kl_reg_loss: 89220.4626; train_edge_recon_loss: 2749803.3144; train_gene_expr_recon_loss: 10396991.7576; train_masked_gp_l1_reg_loss: 47506.1953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86069.7232; train_chrom_access_recon_loss: 9050675.9545; train_global_loss: 22420267.3636; train_optim_loss: 22420267.3636; val_kl_reg_loss: 89292.6162; val_edge_recon_loss: 2761602.0000; val_gene_expr_recon_loss: 10313745.2500; val_masked_gp_l1_reg_loss: 47852.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85965.7969; val_chrom_access_recon_loss: 8932872.6250; val_global_loss: 22231331.5000; val_optim_loss: 22231331.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9350; val_auprc_score: 0.9082; val_best_acc_score: 0.8783; val_best_f1_score: 0.8834; train_kl_reg_loss: 88290.9710; train_edge_recon_loss: 2737553.7159; train_gene_expr_recon_loss: 10375925.1818; train_masked_gp_l1_reg_loss: 48135.6748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86237.7347; train_chrom_access_recon_loss: 9027148.1515; train_global_loss: 22363291.3636; train_optim_loss: 22363291.3636; val_kl_reg_loss: 85627.6094; val_edge_recon_loss: 2780200.5312; val_gene_expr_recon_loss: 10397288.1250; val_masked_gp_l1_reg_loss: 48466.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86281.5781; val_chrom_access_recon_loss: 8956268.8750; val_global_loss: 22354133.0000; val_optim_loss: 22354133.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9387; val_auprc_score: 0.9130; val_best_acc_score: 0.8853; val_best_f1_score: 0.8905; train_kl_reg_loss: 88089.6944; train_edge_recon_loss: 2740184.5379; train_gene_expr_recon_loss: 10345159.0758; train_masked_gp_l1_reg_loss: 48745.4313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86278.5819; train_chrom_access_recon_loss: 8997957.9091; train_global_loss: 22306415.2424; train_optim_loss: 22306415.2424; val_kl_reg_loss: 88692.9922; val_edge_recon_loss: 2770008.5625; val_gene_expr_recon_loss: 10306248.3750; val_masked_gp_l1_reg_loss: 49034.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86135.2109; val_chrom_access_recon_loss: 8872177.5000; val_global_loss: 22172297.0000; val_optim_loss: 22172297.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9360; val_auprc_score: 0.9099; val_best_acc_score: 0.8786; val_best_f1_score: 0.8855; train_kl_reg_loss: 87502.4425; train_edge_recon_loss: 2731874.4318; train_gene_expr_recon_loss: 10320680.2273; train_masked_gp_l1_reg_loss: 49289.0874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86096.9957; train_chrom_access_recon_loss: 8982200.5000; train_global_loss: 22257643.7273; train_optim_loss: 22257643.7273; val_kl_reg_loss: 85687.2031; val_edge_recon_loss: 2781292.6562; val_gene_expr_recon_loss: 10250899.3750; val_masked_gp_l1_reg_loss: 49650.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86563.9844; val_chrom_access_recon_loss: 8836543.3125; val_global_loss: 22090636.2500; val_optim_loss: 22090636.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9413; val_auprc_score: 0.9162; val_best_acc_score: 0.8823; val_best_f1_score: 0.8876; train_kl_reg_loss: 87297.5790; train_edge_recon_loss: 2738850.9167; train_gene_expr_recon_loss: 10300218.7879; train_masked_gp_l1_reg_loss: 49815.9487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86214.5207; train_chrom_access_recon_loss: 8951876.4091; train_global_loss: 22214274.2121; train_optim_loss: 22214274.2121; val_kl_reg_loss: 84811.3760; val_edge_recon_loss: 2764602.4062; val_gene_expr_recon_loss: 10239106.5000; val_masked_gp_l1_reg_loss: 50223.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86479.0469; val_chrom_access_recon_loss: 8834150.7500; val_global_loss: 22059374.0000; val_optim_loss: 22059374.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9479; val_auprc_score: 0.9307; val_best_acc_score: 0.8896; val_best_f1_score: 0.8950; train_kl_reg_loss: 86289.7151; train_edge_recon_loss: 2734162.9280; train_gene_expr_recon_loss: 10274300.3182; train_masked_gp_l1_reg_loss: 50438.4781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86299.8228; train_chrom_access_recon_loss: 8921289.5303; train_global_loss: 22152780.9697; train_optim_loss: 22152780.9697; val_kl_reg_loss: 84201.2637; val_edge_recon_loss: 2768707.0000; val_gene_expr_recon_loss: 10250352.1250; val_masked_gp_l1_reg_loss: 50592.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86430.2500; val_chrom_access_recon_loss: 8809525.6250; val_global_loss: 22049809.0000; val_optim_loss: 22049809.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9461; val_auprc_score: 0.9270; val_best_acc_score: 0.8917; val_best_f1_score: 0.8965; train_kl_reg_loss: 84367.4428; train_edge_recon_loss: 2730202.4735; train_gene_expr_recon_loss: 10263410.4545; train_masked_gp_l1_reg_loss: 50912.8755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86490.0444; train_chrom_access_recon_loss: 8910643.0758; train_global_loss: 22126026.0909; train_optim_loss: 22126026.0909; val_kl_reg_loss: 84699.2373; val_edge_recon_loss: 2766486.9375; val_gene_expr_recon_loss: 10246155.3750; val_masked_gp_l1_reg_loss: 51258.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86573.0859; val_chrom_access_recon_loss: 8918378.2500; val_global_loss: 22153551.7500; val_optim_loss: 22153551.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9476; val_auprc_score: 0.9286; val_best_acc_score: 0.8923; val_best_f1_score: 0.8956; train_kl_reg_loss: 84640.6277; train_edge_recon_loss: 2717709.7614; train_gene_expr_recon_loss: 10236788.5455; train_masked_gp_l1_reg_loss: 51446.1245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86684.4709; train_chrom_access_recon_loss: 8885429.0303; train_global_loss: 22062698.5455; train_optim_loss: 22062698.5455; val_kl_reg_loss: 85370.7705; val_edge_recon_loss: 2748915.9375; val_gene_expr_recon_loss: 10170983.5000; val_masked_gp_l1_reg_loss: 51796.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86752.6484; val_chrom_access_recon_loss: 8803858.3750; val_global_loss: 21947677.5000; val_optim_loss: 21947677.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9449; val_auprc_score: 0.9220; val_best_acc_score: 0.8909; val_best_f1_score: 0.8956; train_kl_reg_loss: 83957.3827; train_edge_recon_loss: 2710705.6136; train_gene_expr_recon_loss: 10215408.6970; train_masked_gp_l1_reg_loss: 51945.4025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86760.3140; train_chrom_access_recon_loss: 8865893.6212; train_global_loss: 22014671.0303; train_optim_loss: 22014671.0303; val_kl_reg_loss: 84993.7090; val_edge_recon_loss: 2755008.6875; val_gene_expr_recon_loss: 10229023.1250; val_masked_gp_l1_reg_loss: 52164.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86946.0469; val_chrom_access_recon_loss: 8838680.5000; val_global_loss: 22046816.7500; val_optim_loss: 22046816.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9437; val_auprc_score: 0.9169; val_best_acc_score: 0.8941; val_best_f1_score: 0.8981; train_kl_reg_loss: 84418.3846; train_edge_recon_loss: 2712234.5720; train_gene_expr_recon_loss: 10206120.4848; train_masked_gp_l1_reg_loss: 52375.5521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86895.4457; train_chrom_access_recon_loss: 8850443.3788; train_global_loss: 21992487.7879; train_optim_loss: 21992487.7879; val_kl_reg_loss: 83486.4043; val_edge_recon_loss: 2753289.7500; val_gene_expr_recon_loss: 10180468.2500; val_masked_gp_l1_reg_loss: 52622.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86785.3438; val_chrom_access_recon_loss: 8737899.2500; val_global_loss: 21894551.5000; val_optim_loss: 21894551.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9467; val_auprc_score: 0.9267; val_best_acc_score: 0.8933; val_best_f1_score: 0.8984; train_kl_reg_loss: 83019.8281; train_edge_recon_loss: 2717588.5985; train_gene_expr_recon_loss: 10189837.9545; train_masked_gp_l1_reg_loss: 52845.2643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86888.0118; train_chrom_access_recon_loss: 8830367.0833; train_global_loss: 21960546.7273; train_optim_loss: 21960546.7273; val_kl_reg_loss: 82076.2275; val_edge_recon_loss: 2737857.1875; val_gene_expr_recon_loss: 10126209.3750; val_masked_gp_l1_reg_loss: 53139.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86902.8125; val_chrom_access_recon_loss: 8698669.6250; val_global_loss: 21784854.7500; val_optim_loss: 21784854.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9501; val_auprc_score: 0.9289; val_best_acc_score: 0.8939; val_best_f1_score: 0.8976; train_kl_reg_loss: 82606.2923; train_edge_recon_loss: 2714484.2765; train_gene_expr_recon_loss: 10170573.9394; train_masked_gp_l1_reg_loss: 53334.1162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86910.6370; train_chrom_access_recon_loss: 8814705.5379; train_global_loss: 21922614.8182; train_optim_loss: 21922614.8182; val_kl_reg_loss: 82044.8506; val_edge_recon_loss: 2755930.7188; val_gene_expr_recon_loss: 10138895.5000; val_masked_gp_l1_reg_loss: 53637.8477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87205.5234; val_chrom_access_recon_loss: 8776786.2500; val_global_loss: 21894501.5000; val_optim_loss: 21894501.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9482; val_auprc_score: 0.9293; val_best_acc_score: 0.8923; val_best_f1_score: 0.8969; train_kl_reg_loss: 81864.8089; train_edge_recon_loss: 2709476.4659; train_gene_expr_recon_loss: 10164548.3030; train_masked_gp_l1_reg_loss: 53785.9255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87126.2473; train_chrom_access_recon_loss: 8795981.4545; train_global_loss: 21892783.1212; train_optim_loss: 21892783.1212; val_kl_reg_loss: 80697.9346; val_edge_recon_loss: 2764280.9688; val_gene_expr_recon_loss: 10158626.6250; val_masked_gp_l1_reg_loss: 54018.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87316.7500; val_chrom_access_recon_loss: 8709414.5000; val_global_loss: 21854356.7500; val_optim_loss: 21854356.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9478; val_auprc_score: 0.9269; val_best_acc_score: 0.8979; val_best_f1_score: 0.9024; train_kl_reg_loss: 81411.8149; train_edge_recon_loss: 2700498.1023; train_gene_expr_recon_loss: 10147004.3333; train_masked_gp_l1_reg_loss: 54235.1841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87351.0286; train_chrom_access_recon_loss: 8783543.9394; train_global_loss: 21854044.4545; train_optim_loss: 21854044.4545; val_kl_reg_loss: 81230.9414; val_edge_recon_loss: 2758358.0312; val_gene_expr_recon_loss: 10110794.0000; val_masked_gp_l1_reg_loss: 54498.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87755.3281; val_chrom_access_recon_loss: 8680137.5625; val_global_loss: 21772773.7500; val_optim_loss: 21772773.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9529; val_auprc_score: 0.9354; val_best_acc_score: 0.9044; val_best_f1_score: 0.9064; train_kl_reg_loss: 82112.4751; train_edge_recon_loss: 2706262.9545; train_gene_expr_recon_loss: 10122820.3636; train_masked_gp_l1_reg_loss: 54675.2678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87555.6670; train_chrom_access_recon_loss: 8749928.7500; train_global_loss: 21803355.5455; train_optim_loss: 21803355.5455; val_kl_reg_loss: 82369.8555; val_edge_recon_loss: 2727443.2188; val_gene_expr_recon_loss: 10122090.2500; val_masked_gp_l1_reg_loss: 54865.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87694.7344; val_chrom_access_recon_loss: 8738299.1250; val_global_loss: 21812762.7500; val_optim_loss: 21812762.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9488; val_auprc_score: 0.9266; val_best_acc_score: 0.8949; val_best_f1_score: 0.9008; train_kl_reg_loss: 80988.8696; train_edge_recon_loss: 2698244.8902; train_gene_expr_recon_loss: 10112318.1818; train_masked_gp_l1_reg_loss: 55080.4266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88033.3903; train_chrom_access_recon_loss: 8730623.6894; train_global_loss: 21765289.2727; train_optim_loss: 21765289.2727; val_kl_reg_loss: 79266.2393; val_edge_recon_loss: 2749407.3125; val_gene_expr_recon_loss: 10114784.2500; val_masked_gp_l1_reg_loss: 55314.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88160.7656; val_chrom_access_recon_loss: 8756651.3125; val_global_loss: 21843583.7500; val_optim_loss: 21843583.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9485; val_auprc_score: 0.9277; val_best_acc_score: 0.8928; val_best_f1_score: 0.8982; train_kl_reg_loss: 80147.8393; train_edge_recon_loss: 2700180.6667; train_gene_expr_recon_loss: 10097743.8939; train_masked_gp_l1_reg_loss: 55470.6346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88287.3406; train_chrom_access_recon_loss: 8716510.5530; train_global_loss: 21738341.0000; train_optim_loss: 21738341.0000; val_kl_reg_loss: 80353.8965; val_edge_recon_loss: 2751510.5312; val_gene_expr_recon_loss: 10104496.3750; val_masked_gp_l1_reg_loss: 55745.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88288.9219; val_chrom_access_recon_loss: 8651908.6250; val_global_loss: 21732304.2500; val_optim_loss: 21732304.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9578; val_auprc_score: 0.9402; val_best_acc_score: 0.9057; val_best_f1_score: 0.9106; train_kl_reg_loss: 81349.0613; train_edge_recon_loss: 2697025.7386; train_gene_expr_recon_loss: 10085814.8485; train_masked_gp_l1_reg_loss: 55889.0752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88634.3576; train_chrom_access_recon_loss: 8706168.3333; train_global_loss: 21714881.3939; train_optim_loss: 21714881.3939; val_kl_reg_loss: 80389.9277; val_edge_recon_loss: 2708706.6875; val_gene_expr_recon_loss: 10067733.5000; val_masked_gp_l1_reg_loss: 56062.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88661.6172; val_chrom_access_recon_loss: 8671030.0625; val_global_loss: 21672584.2500; val_optim_loss: 21672584.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9571; val_auprc_score: 0.9431; val_best_acc_score: 0.9057; val_best_f1_score: 0.9096; train_kl_reg_loss: 80515.9455; train_edge_recon_loss: 2698200.0909; train_gene_expr_recon_loss: 10071605.0758; train_masked_gp_l1_reg_loss: 56266.7886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88666.0107; train_chrom_access_recon_loss: 8685113.6212; train_global_loss: 21680367.4848; train_optim_loss: 21680367.4848; val_kl_reg_loss: 81028.9541; val_edge_recon_loss: 2714182.0625; val_gene_expr_recon_loss: 10150126.7500; val_masked_gp_l1_reg_loss: 56396.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89095.6094; val_chrom_access_recon_loss: 8755561.7500; val_global_loss: 21846391.7500; val_optim_loss: 21846391.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9582; val_auprc_score: 0.9396; val_best_acc_score: 0.9049; val_best_f1_score: 0.9086; train_kl_reg_loss: 79639.9388; train_edge_recon_loss: 2693588.8485; train_gene_expr_recon_loss: 10056946.7121; train_masked_gp_l1_reg_loss: 56589.1603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89063.6738; train_chrom_access_recon_loss: 8673003.9470; train_global_loss: 21648832.1818; train_optim_loss: 21648832.1818; val_kl_reg_loss: 80408.3340; val_edge_recon_loss: 2749024.5312; val_gene_expr_recon_loss: 10037360.2500; val_masked_gp_l1_reg_loss: 56796.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89098.6484; val_chrom_access_recon_loss: 8667062.1250; val_global_loss: 21679750.0000; val_optim_loss: 21679750.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9584; val_auprc_score: 0.9430; val_best_acc_score: 0.9060; val_best_f1_score: 0.9095; train_kl_reg_loss: 79289.1212; train_edge_recon_loss: 2695226.1136; train_gene_expr_recon_loss: 10038764.5606; train_masked_gp_l1_reg_loss: 56969.5559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89355.1335; train_chrom_access_recon_loss: 8651257.8939; train_global_loss: 21610862.3333; train_optim_loss: 21610862.3333; val_kl_reg_loss: 79894.4756; val_edge_recon_loss: 2736727.8125; val_gene_expr_recon_loss: 10024417.6250; val_masked_gp_l1_reg_loss: 57266.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89214.4609; val_chrom_access_recon_loss: 8678957.5000; val_global_loss: 21666478.7500; val_optim_loss: 21666478.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9552; val_auprc_score: 0.9386; val_best_acc_score: 0.9046; val_best_f1_score: 0.9079; train_kl_reg_loss: 79333.9089; train_edge_recon_loss: 2691528.5038; train_gene_expr_recon_loss: 10038595.8485; train_masked_gp_l1_reg_loss: 57374.3120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89362.3371; train_chrom_access_recon_loss: 8637725.6288; train_global_loss: 21593920.3333; train_optim_loss: 21593920.3333; val_kl_reg_loss: 78479.5723; val_edge_recon_loss: 2732521.9062; val_gene_expr_recon_loss: 10105797.5000; val_masked_gp_l1_reg_loss: 57488.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89729.4922; val_chrom_access_recon_loss: 8590672.0625; val_global_loss: 21654688.7500; val_optim_loss: 21654688.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9529; val_auprc_score: 0.9333; val_best_acc_score: 0.8987; val_best_f1_score: 0.9038; train_kl_reg_loss: 78871.4643; train_edge_recon_loss: 2693931.8182; train_gene_expr_recon_loss: 10022510.0909; train_masked_gp_l1_reg_loss: 57651.0724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89568.6031; train_chrom_access_recon_loss: 8616640.3182; train_global_loss: 21559173.4545; train_optim_loss: 21559173.4545; val_kl_reg_loss: 78610.6318; val_edge_recon_loss: 2755894.7812; val_gene_expr_recon_loss: 10047925.2500; val_masked_gp_l1_reg_loss: 57967.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90322.4531; val_chrom_access_recon_loss: 8587480.0000; val_global_loss: 21618199.7500; val_optim_loss: 21618199.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9564; val_auprc_score: 0.9352; val_best_acc_score: 0.9138; val_best_f1_score: 0.9172; train_kl_reg_loss: 78977.1670; train_edge_recon_loss: 2689769.9545; train_gene_expr_recon_loss: 10006226.2879; train_masked_gp_l1_reg_loss: 58036.4364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89757.0394; train_chrom_access_recon_loss: 8602216.9091; train_global_loss: 21524983.8182; train_optim_loss: 21524983.8182; val_kl_reg_loss: 79016.2656; val_edge_recon_loss: 2701641.0312; val_gene_expr_recon_loss: 10039627.8750; val_masked_gp_l1_reg_loss: 58232.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89956.8828; val_chrom_access_recon_loss: 8568183.6875; val_global_loss: 21536659.0000; val_optim_loss: 21536659.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9577; val_auprc_score: 0.9410; val_best_acc_score: 0.9076; val_best_f1_score: 0.9092; train_kl_reg_loss: 78953.8726; train_edge_recon_loss: 2689509.0000; train_gene_expr_recon_loss: 10001950.6515; train_masked_gp_l1_reg_loss: 58346.2901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89753.6057; train_chrom_access_recon_loss: 8590664.3939; train_global_loss: 21509177.8485; train_optim_loss: 21509177.8485; val_kl_reg_loss: 77839.3086; val_edge_recon_loss: 2717022.6250; val_gene_expr_recon_loss: 10032772.2500; val_masked_gp_l1_reg_loss: 58452.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89737.6172; val_chrom_access_recon_loss: 8587435.6250; val_global_loss: 21563259.7500; val_optim_loss: 21563259.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9583; val_auprc_score: 0.9385; val_best_acc_score: 0.9100; val_best_f1_score: 0.9135; train_kl_reg_loss: 77609.4323; train_edge_recon_loss: 2696924.7159; train_gene_expr_recon_loss: 9994911.4848; train_masked_gp_l1_reg_loss: 58607.0584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89713.0365; train_chrom_access_recon_loss: 8570093.6439; train_global_loss: 21487859.4242; train_optim_loss: 21487859.4242; val_kl_reg_loss: 75982.0273; val_edge_recon_loss: 2697345.8438; val_gene_expr_recon_loss: 10048933.7500; val_masked_gp_l1_reg_loss: 58832.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89888.6250; val_chrom_access_recon_loss: 8549174.9375; val_global_loss: 21520158.7500; val_optim_loss: 21520158.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9588; val_auprc_score: 0.9438; val_best_acc_score: 0.9076; val_best_f1_score: 0.9115; train_kl_reg_loss: 77684.0405; train_edge_recon_loss: 2689104.2879; train_gene_expr_recon_loss: 9978582.8182; train_masked_gp_l1_reg_loss: 58903.4083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89698.8145; train_chrom_access_recon_loss: 8557474.9394; train_global_loss: 21451448.4848; train_optim_loss: 21451448.4848; val_kl_reg_loss: 77634.2236; val_edge_recon_loss: 2701759.7812; val_gene_expr_recon_loss: 9971027.7500; val_masked_gp_l1_reg_loss: 58994.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89543.3516; val_chrom_access_recon_loss: 8595258.6250; val_global_loss: 21494218.5000; val_optim_loss: 21494218.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9585; val_auprc_score: 0.9387; val_best_acc_score: 0.9092; val_best_f1_score: 0.9128; train_kl_reg_loss: 77880.6489; train_edge_recon_loss: 2693340.7576; train_gene_expr_recon_loss: 9971248.0000; train_masked_gp_l1_reg_loss: 59157.3678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89725.6222; train_chrom_access_recon_loss: 8542566.5758; train_global_loss: 21433918.7576; train_optim_loss: 21433918.7576; val_kl_reg_loss: 76933.6074; val_edge_recon_loss: 2715079.5000; val_gene_expr_recon_loss: 9889666.1250; val_masked_gp_l1_reg_loss: 59379.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89909.8203; val_chrom_access_recon_loss: 8534860.8750; val_global_loss: 21365829.2500; val_optim_loss: 21365829.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9634; val_auprc_score: 0.9530; val_best_acc_score: 0.9092; val_best_f1_score: 0.9117; train_kl_reg_loss: 77274.4884; train_edge_recon_loss: 2687503.3447; train_gene_expr_recon_loss: 9962515.3636; train_masked_gp_l1_reg_loss: 59481.4851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89846.7938; train_chrom_access_recon_loss: 8531927.7348; train_global_loss: 21408549.2121; train_optim_loss: 21408549.2121; val_kl_reg_loss: 77529.8633; val_edge_recon_loss: 2733459.0312; val_gene_expr_recon_loss: 9983453.8750; val_masked_gp_l1_reg_loss: 59678.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89629.1016; val_chrom_access_recon_loss: 8578861.1875; val_global_loss: 21522612.0000; val_optim_loss: 21522612.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9619; val_auprc_score: 0.9456; val_best_acc_score: 0.9100; val_best_f1_score: 0.9142; train_kl_reg_loss: 76620.4117; train_edge_recon_loss: 2683070.1894; train_gene_expr_recon_loss: 9957534.1212; train_masked_gp_l1_reg_loss: 59802.6442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89822.1199; train_chrom_access_recon_loss: 8515055.1515; train_global_loss: 21381904.8485; train_optim_loss: 21381904.8485; val_kl_reg_loss: 77301.0557; val_edge_recon_loss: 2698707.5625; val_gene_expr_recon_loss: 10039074.1250; val_masked_gp_l1_reg_loss: 59950.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89522.0625; val_chrom_access_recon_loss: 8606801.1250; val_global_loss: 21571356.7500; val_optim_loss: 21571356.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9646; val_auprc_score: 0.9525; val_best_acc_score: 0.9116; val_best_f1_score: 0.9146; train_kl_reg_loss: 76864.3666; train_edge_recon_loss: 2684536.8712; train_gene_expr_recon_loss: 9951083.5758; train_masked_gp_l1_reg_loss: 60089.9103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89744.5542; train_chrom_access_recon_loss: 8504379.9773; train_global_loss: 21366699.3636; train_optim_loss: 21366699.3636; val_kl_reg_loss: 75841.2646; val_edge_recon_loss: 2719276.8125; val_gene_expr_recon_loss: 9864593.5000; val_masked_gp_l1_reg_loss: 60211.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89862.1484; val_chrom_access_recon_loss: 8458206.2500; val_global_loss: 21267991.0000; val_optim_loss: 21267991.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9619; val_auprc_score: 0.9475; val_best_acc_score: 0.9105; val_best_f1_score: 0.9143; train_kl_reg_loss: 76214.9371; train_edge_recon_loss: 2696716.7992; train_gene_expr_recon_loss: 9944987.0000; train_masked_gp_l1_reg_loss: 60352.4171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89756.1900; train_chrom_access_recon_loss: 8488031.2424; train_global_loss: 21356058.5455; train_optim_loss: 21356058.5455; val_kl_reg_loss: 77530.1807; val_edge_recon_loss: 2714270.8750; val_gene_expr_recon_loss: 10001248.3750; val_masked_gp_l1_reg_loss: 60476.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89626.1328; val_chrom_access_recon_loss: 8577091.3125; val_global_loss: 21520242.5000; val_optim_loss: 21520242.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9592; val_auprc_score: 0.9433; val_best_acc_score: 0.9062; val_best_f1_score: 0.9107; train_kl_reg_loss: 76585.0612; train_edge_recon_loss: 2684313.2652; train_gene_expr_recon_loss: 9940808.6212; train_masked_gp_l1_reg_loss: 60624.6443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89718.6519; train_chrom_access_recon_loss: 8480196.5303; train_global_loss: 21332246.6970; train_optim_loss: 21332246.6970; val_kl_reg_loss: 77299.2588; val_edge_recon_loss: 2725554.5625; val_gene_expr_recon_loss: 9944126.5000; val_masked_gp_l1_reg_loss: 60776.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89011.6094; val_chrom_access_recon_loss: 8516471.2500; val_global_loss: 21413239.2500; val_optim_loss: 21413239.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9604; val_auprc_score: 0.9404; val_best_acc_score: 0.9135; val_best_f1_score: 0.9158; train_kl_reg_loss: 76370.3971; train_edge_recon_loss: 2687914.0985; train_gene_expr_recon_loss: 9929768.6818; train_masked_gp_l1_reg_loss: 60848.9818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89580.5515; train_chrom_access_recon_loss: 8462997.0455; train_global_loss: 21307479.7879; train_optim_loss: 21307479.7879; val_kl_reg_loss: 75043.1055; val_edge_recon_loss: 2709447.8750; val_gene_expr_recon_loss: 9994664.8750; val_masked_gp_l1_reg_loss: 61041.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89705.1016; val_chrom_access_recon_loss: 8550886.3750; val_global_loss: 21480787.7500; val_optim_loss: 21480787.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9597; val_auprc_score: 0.9413; val_best_acc_score: 0.9132; val_best_f1_score: 0.9154; train_kl_reg_loss: 76041.0208; train_edge_recon_loss: 2681844.4735; train_gene_expr_recon_loss: 9921221.5606; train_masked_gp_l1_reg_loss: 61082.6909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89616.1979; train_chrom_access_recon_loss: 8450753.8636; train_global_loss: 21280559.7576; train_optim_loss: 21280559.7576; val_kl_reg_loss: 76837.3721; val_edge_recon_loss: 2710901.2500; val_gene_expr_recon_loss: 9933293.5000; val_masked_gp_l1_reg_loss: 61208.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89683.7734; val_chrom_access_recon_loss: 8483644.3125; val_global_loss: 21355568.2500; val_optim_loss: 21355568.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9587; val_auprc_score: 0.9417; val_best_acc_score: 0.9084; val_best_f1_score: 0.9121; train_kl_reg_loss: 76590.7371; train_edge_recon_loss: 2678086.8371; train_gene_expr_recon_loss: 9902875.6970; train_masked_gp_l1_reg_loss: 60569.4683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69917.5977; train_chrom_access_recon_loss: 8418757.7121; train_global_loss: 21206798.0303; train_optim_loss: 21206798.0303; val_kl_reg_loss: 77670.3945; val_edge_recon_loss: 2744731.5000; val_gene_expr_recon_loss: 10035713.0000; val_masked_gp_l1_reg_loss: 60150.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66117.9844; val_chrom_access_recon_loss: 8642432.6875; val_global_loss: 21626815.5000; val_optim_loss: 21626815.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9639; val_auprc_score: 0.9510; val_best_acc_score: 0.9172; val_best_f1_score: 0.9201; train_kl_reg_loss: 77670.7674; train_edge_recon_loss: 2681127.4697; train_gene_expr_recon_loss: 9898829.5758; train_masked_gp_l1_reg_loss: 60033.6987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65742.4297; train_chrom_access_recon_loss: 8414688.7727; train_global_loss: 21198092.5455; train_optim_loss: 21198092.5455; val_kl_reg_loss: 78010.0078; val_edge_recon_loss: 2728758.0000; val_gene_expr_recon_loss: 9920289.0000; val_masked_gp_l1_reg_loss: 59960.5820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65525.9570; val_chrom_access_recon_loss: 8431475.0625; val_global_loss: 21284018.7500; val_optim_loss: 21284018.7500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9681; val_auprc_score: 0.9573; val_best_acc_score: 0.9229; val_best_f1_score: 0.9250; train_kl_reg_loss: 77929.2356; train_edge_recon_loss: 2681470.8409; train_gene_expr_recon_loss: 9903313.3333; train_masked_gp_l1_reg_loss: 59936.8720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65467.5183; train_chrom_access_recon_loss: 8415585.6364; train_global_loss: 21203703.3636; train_optim_loss: 21203703.3636; val_kl_reg_loss: 78270.5264; val_edge_recon_loss: 2688386.5625; val_gene_expr_recon_loss: 9962701.5000; val_masked_gp_l1_reg_loss: 59907.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65212.0820; val_chrom_access_recon_loss: 8473732.7500; val_global_loss: 21328210.7500; val_optim_loss: 21328210.7500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9653; val_auprc_score: 0.9523; val_best_acc_score: 0.9172; val_best_f1_score: 0.9201; train_kl_reg_loss: 78393.9664; train_edge_recon_loss: 2686310.3258; train_gene_expr_recon_loss: 9906781.9545; train_masked_gp_l1_reg_loss: 59897.2068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65119.3930; train_chrom_access_recon_loss: 8421375.6364; train_global_loss: 21217878.6364; train_optim_loss: 21217878.6364; val_kl_reg_loss: 79504.4688; val_edge_recon_loss: 2711812.6875; val_gene_expr_recon_loss: 10008202.5000; val_masked_gp_l1_reg_loss: 59889.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65030.4180; val_chrom_access_recon_loss: 8539058.3750; val_global_loss: 21463497.7500; val_optim_loss: 21463497.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 32 min 0 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9581
val AUPRC score: 0.9413
val best accuracy score: 0.9124
val best F1 score: 0.9166
val target rna MSE score: 1.2428
val source rna MSE score: 0.3943
val target atac MSE score: 0.3171
val source atac MSE score: 0.0669
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
