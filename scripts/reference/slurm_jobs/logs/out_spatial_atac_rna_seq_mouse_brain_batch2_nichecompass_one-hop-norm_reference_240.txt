[True]
Run timestamp: 10102023_105225_240.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_240']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6972; val_auprc_score: 0.6684; val_best_acc_score: 0.5234; val_best_f1_score: 0.6752; train_kl_reg_loss: 33149.7587; train_edge_recon_loss: 720423.0426; train_gene_expr_recon_loss: 23450090.6061; train_masked_gp_l1_reg_loss: 151780.9254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5052376.5379; train_chrom_access_recon_loss: 6977479.1667; train_global_loss: 36385300.1212; train_optim_loss: 36385300.1212; val_kl_reg_loss: 76406.6641; val_edge_recon_loss: 812783.2656; val_gene_expr_recon_loss: 21586147.7500; val_masked_gp_l1_reg_loss: 121946.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2925788.2500; val_chrom_access_recon_loss: 6608818.5000; val_global_loss: 32131890.5000; val_optim_loss: 32131890.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6996; val_auprc_score: 0.6903; val_best_acc_score: 0.5449; val_best_f1_score: 0.6816; train_kl_reg_loss: 80801.3319; train_edge_recon_loss: 741956.0038; train_gene_expr_recon_loss: 21225044.9394; train_masked_gp_l1_reg_loss: 110167.6950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1656415.9593; train_chrom_access_recon_loss: 6605113.1667; train_global_loss: 30419498.7879; train_optim_loss: 30419498.7879; val_kl_reg_loss: 78010.7051; val_edge_recon_loss: 812513.4219; val_gene_expr_recon_loss: 20997839.5000; val_masked_gp_l1_reg_loss: 104298.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 834063.1250; val_chrom_access_recon_loss: 6516647.1250; val_global_loss: 29343372.7500; val_optim_loss: 29343372.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7589; val_auprc_score: 0.7493; val_best_acc_score: 0.6274; val_best_f1_score: 0.7146; train_kl_reg_loss: 78817.9225; train_edge_recon_loss: 738455.6544; train_gene_expr_recon_loss: 20995228.5152; train_masked_gp_l1_reg_loss: 102017.4940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 552057.5365; train_chrom_access_recon_loss: 6563145.0000; train_global_loss: 29029722.1818; train_optim_loss: 29029722.1818; val_kl_reg_loss: 79273.9678; val_edge_recon_loss: 811195.9531; val_gene_expr_recon_loss: 20904800.0000; val_masked_gp_l1_reg_loss: 100878.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 365848.8438; val_chrom_access_recon_loss: 6485477.8125; val_global_loss: 28747473.5000; val_optim_loss: 28747473.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7938; val_auprc_score: 0.7835; val_best_acc_score: 0.7211; val_best_f1_score: 0.7393; train_kl_reg_loss: 73793.1976; train_edge_recon_loss: 733612.9157; train_gene_expr_recon_loss: 20853112.4848; train_masked_gp_l1_reg_loss: 100771.2398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 284004.4820; train_chrom_access_recon_loss: 6524798.1515; train_global_loss: 28570092.3939; train_optim_loss: 28570092.3939; val_kl_reg_loss: 71678.0088; val_edge_recon_loss: 805982.0000; val_gene_expr_recon_loss: 20773737.7500; val_masked_gp_l1_reg_loss: 101134.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225589.5781; val_chrom_access_recon_loss: 6434967.8125; val_global_loss: 28413089.7500; val_optim_loss: 28413089.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8430; val_auprc_score: 0.8229; val_best_acc_score: 0.7313; val_best_f1_score: 0.7601; train_kl_reg_loss: 69759.5548; train_edge_recon_loss: 728941.8163; train_gene_expr_recon_loss: 20721134.3030; train_masked_gp_l1_reg_loss: 101617.5482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 196701.6482; train_chrom_access_recon_loss: 6485702.6061; train_global_loss: 28303857.6061; train_optim_loss: 28303857.6061; val_kl_reg_loss: 62938.5024; val_edge_recon_loss: 793792.2812; val_gene_expr_recon_loss: 20685378.2500; val_masked_gp_l1_reg_loss: 102835.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174447.7188; val_chrom_access_recon_loss: 6413905.8750; val_global_loss: 28233299.2500; val_optim_loss: 28233299.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8692; val_auprc_score: 0.8419; val_best_acc_score: 0.7969; val_best_f1_score: 0.8082; train_kl_reg_loss: 65326.9510; train_edge_recon_loss: 721396.9508; train_gene_expr_recon_loss: 20580934.5455; train_masked_gp_l1_reg_loss: 103914.9946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159987.1316; train_chrom_access_recon_loss: 6447320.9545; train_global_loss: 28078881.5455; train_optim_loss: 28078881.5455; val_kl_reg_loss: 61862.1870; val_edge_recon_loss: 764123.3828; val_gene_expr_recon_loss: 20504838.7500; val_masked_gp_l1_reg_loss: 105244.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148090.1719; val_chrom_access_recon_loss: 6350844.7500; val_global_loss: 27935003.0000; val_optim_loss: 27935003.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8740; val_auprc_score: 0.8436; val_best_acc_score: 0.8041; val_best_f1_score: 0.8218; train_kl_reg_loss: 63508.2449; train_edge_recon_loss: 698056.4422; train_gene_expr_recon_loss: 20459805.7273; train_masked_gp_l1_reg_loss: 106640.1392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139543.1359; train_chrom_access_recon_loss: 6417726.7955; train_global_loss: 27885280.4848; train_optim_loss: 27885280.4848; val_kl_reg_loss: 64234.2163; val_edge_recon_loss: 684443.8906; val_gene_expr_recon_loss: 20656233.5000; val_masked_gp_l1_reg_loss: 108431.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133116.5312; val_chrom_access_recon_loss: 6342897.0000; val_global_loss: 27989356.5000; val_optim_loss: 27989356.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8738; val_auprc_score: 0.8438; val_best_acc_score: 0.8004; val_best_f1_score: 0.8235; train_kl_reg_loss: 72545.1981; train_edge_recon_loss: 654095.5739; train_gene_expr_recon_loss: 20355166.3636; train_masked_gp_l1_reg_loss: 109734.6615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126822.5927; train_chrom_access_recon_loss: 6390571.3485; train_global_loss: 27708935.6364; train_optim_loss: 27708935.6364; val_kl_reg_loss: 74057.3203; val_edge_recon_loss: 641589.7422; val_gene_expr_recon_loss: 20431538.7500; val_masked_gp_l1_reg_loss: 110787.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120452.9297; val_chrom_access_recon_loss: 6328841.0000; val_global_loss: 27707267.2500; val_optim_loss: 27707267.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8772; val_auprc_score: 0.8529; val_best_acc_score: 0.7953; val_best_f1_score: 0.8203; train_kl_reg_loss: 77643.4290; train_edge_recon_loss: 633166.3078; train_gene_expr_recon_loss: 20274584.5758; train_masked_gp_l1_reg_loss: 111771.4315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115977.3002; train_chrom_access_recon_loss: 6373340.7348; train_global_loss: 27586483.7576; train_optim_loss: 27586483.7576; val_kl_reg_loss: 76545.7236; val_edge_recon_loss: 637478.6172; val_gene_expr_recon_loss: 20360374.2500; val_masked_gp_l1_reg_loss: 112856.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111700.0469; val_chrom_access_recon_loss: 6344424.6875; val_global_loss: 27643379.5000; val_optim_loss: 27643379.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8772; val_auprc_score: 0.8379; val_best_acc_score: 0.8020; val_best_f1_score: 0.8227; train_kl_reg_loss: 77310.2193; train_edge_recon_loss: 628184.4034; train_gene_expr_recon_loss: 20213596.0909; train_masked_gp_l1_reg_loss: 113265.6151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108526.5096; train_chrom_access_recon_loss: 6349734.5227; train_global_loss: 27490617.6970; train_optim_loss: 27490617.6970; val_kl_reg_loss: 76982.0273; val_edge_recon_loss: 630012.9219; val_gene_expr_recon_loss: 20100050.0000; val_masked_gp_l1_reg_loss: 113960.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105861.3594; val_chrom_access_recon_loss: 6237065.1250; val_global_loss: 27263932.0000; val_optim_loss: 27263932.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8911; val_auprc_score: 0.8627; val_best_acc_score: 0.8092; val_best_f1_score: 0.8259; train_kl_reg_loss: 76919.4435; train_edge_recon_loss: 622313.3352; train_gene_expr_recon_loss: 20119658.9394; train_masked_gp_l1_reg_loss: 114515.9455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103786.3585; train_chrom_access_recon_loss: 6317143.3864; train_global_loss: 27354337.4545; train_optim_loss: 27354337.4545; val_kl_reg_loss: 75807.3096; val_edge_recon_loss: 628338.9609; val_gene_expr_recon_loss: 20161099.5000; val_masked_gp_l1_reg_loss: 114995.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102406.2422; val_chrom_access_recon_loss: 6289386.6875; val_global_loss: 27372035.0000; val_optim_loss: 27372035.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8952; val_auprc_score: 0.8665; val_best_acc_score: 0.8232; val_best_f1_score: 0.8418; train_kl_reg_loss: 76026.3187; train_edge_recon_loss: 620373.8210; train_gene_expr_recon_loss: 20023743.9091; train_masked_gp_l1_reg_loss: 115459.9025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100233.9102; train_chrom_access_recon_loss: 6290956.2879; train_global_loss: 27226794.0303; train_optim_loss: 27226794.0303; val_kl_reg_loss: 74739.7354; val_edge_recon_loss: 618564.3125; val_gene_expr_recon_loss: 20062924.2500; val_masked_gp_l1_reg_loss: 116122.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98927.5703; val_chrom_access_recon_loss: 6231469.5000; val_global_loss: 27202747.2500; val_optim_loss: 27202747.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8963; val_auprc_score: 0.8705; val_best_acc_score: 0.8181; val_best_f1_score: 0.8353; train_kl_reg_loss: 75832.1237; train_edge_recon_loss: 615564.2708; train_gene_expr_recon_loss: 19984484.1515; train_masked_gp_l1_reg_loss: 116244.5053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97726.8772; train_chrom_access_recon_loss: 6275758.4318; train_global_loss: 27165610.0303; train_optim_loss: 27165610.0303; val_kl_reg_loss: 75120.6025; val_edge_recon_loss: 620550.5312; val_gene_expr_recon_loss: 19772303.2500; val_masked_gp_l1_reg_loss: 116934.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97405.0469; val_chrom_access_recon_loss: 6165350.3750; val_global_loss: 26847664.7500; val_optim_loss: 26847664.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9057; val_auprc_score: 0.8841; val_best_acc_score: 0.8297; val_best_f1_score: 0.8466; train_kl_reg_loss: 75091.0276; train_edge_recon_loss: 613352.3362; train_gene_expr_recon_loss: 19921702.4242; train_masked_gp_l1_reg_loss: 117108.6490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95921.9925; train_chrom_access_recon_loss: 6256800.7500; train_global_loss: 27079977.1818; train_optim_loss: 27079977.1818; val_kl_reg_loss: 75440.2646; val_edge_recon_loss: 615044.4453; val_gene_expr_recon_loss: 20110677.0000; val_masked_gp_l1_reg_loss: 117744.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95248.6719; val_chrom_access_recon_loss: 6286893.1250; val_global_loss: 27301046.7500; val_optim_loss: 27301046.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9031; val_auprc_score: 0.8762; val_best_acc_score: 0.8283; val_best_f1_score: 0.8452; train_kl_reg_loss: 74688.6870; train_edge_recon_loss: 610182.9223; train_gene_expr_recon_loss: 19842067.3030; train_masked_gp_l1_reg_loss: 118020.3629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94171.9561; train_chrom_access_recon_loss: 6227577.4394; train_global_loss: 26966708.6970; train_optim_loss: 26966708.6970; val_kl_reg_loss: 74305.9297; val_edge_recon_loss: 621366.9609; val_gene_expr_recon_loss: 19980725.7500; val_masked_gp_l1_reg_loss: 118262.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92616.6250; val_chrom_access_recon_loss: 6172410.5000; val_global_loss: 27059687.0000; val_optim_loss: 27059687.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9212; val_auprc_score: 0.9010; val_best_acc_score: 0.8471; val_best_f1_score: 0.8595; train_kl_reg_loss: 74079.2815; train_edge_recon_loss: 607402.6184; train_gene_expr_recon_loss: 19793444.1515; train_masked_gp_l1_reg_loss: 118607.7638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92397.6017; train_chrom_access_recon_loss: 6211190.4318; train_global_loss: 26897121.8788; train_optim_loss: 26897121.8788; val_kl_reg_loss: 73670.7305; val_edge_recon_loss: 607029.8672; val_gene_expr_recon_loss: 19818164.7500; val_masked_gp_l1_reg_loss: 119237.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91465.7266; val_chrom_access_recon_loss: 6154497.5625; val_global_loss: 26864067.2500; val_optim_loss: 26864067.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9235; val_auprc_score: 0.8995; val_best_acc_score: 0.8509; val_best_f1_score: 0.8632; train_kl_reg_loss: 73366.5826; train_edge_recon_loss: 607883.5388; train_gene_expr_recon_loss: 19747390.3030; train_masked_gp_l1_reg_loss: 119443.4735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90808.4210; train_chrom_access_recon_loss: 6194400.4773; train_global_loss: 26833292.7273; train_optim_loss: 26833292.7273; val_kl_reg_loss: 74588.1191; val_edge_recon_loss: 609573.2344; val_gene_expr_recon_loss: 19892455.2500; val_masked_gp_l1_reg_loss: 119550.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90136.0312; val_chrom_access_recon_loss: 6147487.5000; val_global_loss: 26933789.7500; val_optim_loss: 26933789.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9184; val_auprc_score: 0.8938; val_best_acc_score: 0.8512; val_best_f1_score: 0.8610; train_kl_reg_loss: 74464.4254; train_edge_recon_loss: 604509.4157; train_gene_expr_recon_loss: 19708196.2121; train_masked_gp_l1_reg_loss: 114640.7784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70138.0014; train_chrom_access_recon_loss: 6176233.5985; train_global_loss: 26748182.4545; train_optim_loss: 26748182.4545; val_kl_reg_loss: 75090.0938; val_edge_recon_loss: 608829.9922; val_gene_expr_recon_loss: 19830330.2500; val_masked_gp_l1_reg_loss: 112739.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64311.9648; val_chrom_access_recon_loss: 6159748.5625; val_global_loss: 26851051.2500; val_optim_loss: 26851051.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9197; val_auprc_score: 0.8957; val_best_acc_score: 0.8477; val_best_f1_score: 0.8609; train_kl_reg_loss: 75174.3512; train_edge_recon_loss: 604477.2831; train_gene_expr_recon_loss: 19694358.0606; train_masked_gp_l1_reg_loss: 112475.5233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63573.4377; train_chrom_access_recon_loss: 6168009.1364; train_global_loss: 26718067.5152; train_optim_loss: 26718067.5152; val_kl_reg_loss: 75522.5352; val_edge_recon_loss: 607802.4297; val_gene_expr_recon_loss: 19782932.7500; val_masked_gp_l1_reg_loss: 112323.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63160.2695; val_chrom_access_recon_loss: 6170004.4375; val_global_loss: 26811745.7500; val_optim_loss: 26811745.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9186; val_auprc_score: 0.8963; val_best_acc_score: 0.8485; val_best_f1_score: 0.8602; train_kl_reg_loss: 75521.1446; train_edge_recon_loss: 603363.6686; train_gene_expr_recon_loss: 19693579.7576; train_masked_gp_l1_reg_loss: 112239.2880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62741.4875; train_chrom_access_recon_loss: 6173166.3485; train_global_loss: 26720611.8182; train_optim_loss: 26720611.8182; val_kl_reg_loss: 76173.5293; val_edge_recon_loss: 610798.6172; val_gene_expr_recon_loss: 19546168.0000; val_masked_gp_l1_reg_loss: 112255.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62561.6094; val_chrom_access_recon_loss: 6112617.4375; val_global_loss: 26520575.7500; val_optim_loss: 26520575.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9182; val_auprc_score: 0.8905; val_best_acc_score: 0.8509; val_best_f1_score: 0.8605; train_kl_reg_loss: 75708.3690; train_edge_recon_loss: 604190.7102; train_gene_expr_recon_loss: 19682791.0000; train_masked_gp_l1_reg_loss: 112202.4757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62266.0834; train_chrom_access_recon_loss: 6160388.2576; train_global_loss: 26697546.9394; train_optim_loss: 26697546.9394; val_kl_reg_loss: 76079.0420; val_edge_recon_loss: 611678.0156; val_gene_expr_recon_loss: 19832763.7500; val_masked_gp_l1_reg_loss: 112212.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61982.0820; val_chrom_access_recon_loss: 6137654.8125; val_global_loss: 26832369.5000; val_optim_loss: 26832369.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9266; val_auprc_score: 0.9045; val_best_acc_score: 0.8546; val_best_f1_score: 0.8627; train_kl_reg_loss: 75738.3570; train_edge_recon_loss: 604669.5909; train_gene_expr_recon_loss: 19677127.8182; train_masked_gp_l1_reg_loss: 112167.1532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61753.9192; train_chrom_access_recon_loss: 6165313.9470; train_global_loss: 26696770.6970; train_optim_loss: 26696770.6970; val_kl_reg_loss: 76489.9951; val_edge_recon_loss: 608996.1406; val_gene_expr_recon_loss: 19849314.5000; val_masked_gp_l1_reg_loss: 112197.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61536.9570; val_chrom_access_recon_loss: 6196742.6250; val_global_loss: 26905277.0000; val_optim_loss: 26905277.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9218; val_auprc_score: 0.8979; val_best_acc_score: 0.8512; val_best_f1_score: 0.8611; train_kl_reg_loss: 76008.5220; train_edge_recon_loss: 602280.8920; train_gene_expr_recon_loss: 19661501.6667; train_masked_gp_l1_reg_loss: 112168.4384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61321.0214; train_chrom_access_recon_loss: 6158128.4621; train_global_loss: 26671409.0606; train_optim_loss: 26671409.0606; val_kl_reg_loss: 76497.7881; val_edge_recon_loss: 609064.2188; val_gene_expr_recon_loss: 19904204.2500; val_masked_gp_l1_reg_loss: 112135.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61118.6445; val_chrom_access_recon_loss: 6167466.1875; val_global_loss: 26930486.2500; val_optim_loss: 26930486.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9258; val_auprc_score: 0.9065; val_best_acc_score: 0.8544; val_best_f1_score: 0.8666; train_kl_reg_loss: 76057.6009; train_edge_recon_loss: 603262.3835; train_gene_expr_recon_loss: 19659507.8182; train_masked_gp_l1_reg_loss: 112128.7481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60866.3788; train_chrom_access_recon_loss: 6158308.0303; train_global_loss: 26670131.0909; train_optim_loss: 26670131.0909; val_kl_reg_loss: 76774.7129; val_edge_recon_loss: 603375.1797; val_gene_expr_recon_loss: 19812785.0000; val_masked_gp_l1_reg_loss: 112098.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60682.8320; val_chrom_access_recon_loss: 6221520.1875; val_global_loss: 26887235.0000; val_optim_loss: 26887235.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9286; val_auprc_score: 0.9078; val_best_acc_score: 0.8622; val_best_f1_score: 0.8719; train_kl_reg_loss: 76281.2533; train_edge_recon_loss: 602178.4460; train_gene_expr_recon_loss: 19654194.2424; train_masked_gp_l1_reg_loss: 111576.8584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58736.3531; train_chrom_access_recon_loss: 6153112.5379; train_global_loss: 26656079.4242; train_optim_loss: 26656079.4242; val_kl_reg_loss: 76760.5527; val_edge_recon_loss: 605390.3281; val_gene_expr_recon_loss: 19759631.2500; val_masked_gp_l1_reg_loss: 111331.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58113.6328; val_chrom_access_recon_loss: 6144293.3125; val_global_loss: 26755521.5000; val_optim_loss: 26755521.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9234; val_auprc_score: 0.8990; val_best_acc_score: 0.8528; val_best_f1_score: 0.8652; train_kl_reg_loss: 76295.8952; train_edge_recon_loss: 601671.6297; train_gene_expr_recon_loss: 19676052.6970; train_masked_gp_l1_reg_loss: 111271.5365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57986.4187; train_chrom_access_recon_loss: 6158977.9848; train_global_loss: 26682256.3030; train_optim_loss: 26682256.3030; val_kl_reg_loss: 76663.4453; val_edge_recon_loss: 605750.5859; val_gene_expr_recon_loss: 19695540.2500; val_masked_gp_l1_reg_loss: 111231.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57895.9062; val_chrom_access_recon_loss: 6120263.2500; val_global_loss: 26667345.2500; val_optim_loss: 26667345.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9247; val_auprc_score: 0.9020; val_best_acc_score: 0.8525; val_best_f1_score: 0.8637; train_kl_reg_loss: 76321.9599; train_edge_recon_loss: 601947.4725; train_gene_expr_recon_loss: 19657094.7576; train_masked_gp_l1_reg_loss: 111207.9706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57836.8533; train_chrom_access_recon_loss: 6156184.6591; train_global_loss: 26660593.7576; train_optim_loss: 26660593.7576; val_kl_reg_loss: 76927.8887; val_edge_recon_loss: 605317.4141; val_gene_expr_recon_loss: 19622512.0000; val_masked_gp_l1_reg_loss: 111195.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57787.5078; val_chrom_access_recon_loss: 6102227.5625; val_global_loss: 26575968.5000; val_optim_loss: 26575968.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9241; val_auprc_score: 0.8982; val_best_acc_score: 0.8549; val_best_f1_score: 0.8625; train_kl_reg_loss: 76318.8793; train_edge_recon_loss: 602496.8778; train_gene_expr_recon_loss: 19663105.3636; train_masked_gp_l1_reg_loss: 111183.8477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57744.1389; train_chrom_access_recon_loss: 6154921.5682; train_global_loss: 26665770.6970; train_optim_loss: 26665770.6970; val_kl_reg_loss: 76979.5859; val_edge_recon_loss: 613165.6797; val_gene_expr_recon_loss: 19835664.0000; val_masked_gp_l1_reg_loss: 111178.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57709.2422; val_chrom_access_recon_loss: 6127714.0625; val_global_loss: 26822411.2500; val_optim_loss: 26822411.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 36 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
val AUROC score: 0.9244
val AUPRC score: 0.9040
val best accuracy score: 0.8552
val best F1 score: 0.8651
val target rna MSE score: 1.1696
val source rna MSE score: 0.6048
val target atac MSE score: 0.3155
val source atac MSE score: 0.1312
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
