[True]
Run timestamp: 08082023_004626_54.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_54']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9189; val_auprc_score: 0.9833; val_best_acc_score: 0.8538; val_best_f1_score: 0.9212; train_kl_reg_loss: 251401.2594; train_edge_recon_loss: 117552.8012; train_gene_expr_recon_loss: 6118497.3558; train_masked_gp_l1_reg_loss: 10830.7162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176345.2688; train_global_loss: 6674627.2981; train_optim_loss: 6674627.2981; val_kl_reg_loss: 520915.4557; val_edge_recon_loss: 118999.9863; val_gene_expr_recon_loss: 5566759.8750; val_masked_gp_l1_reg_loss: 11420.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168969.1875; val_global_loss: 6387064.4167; val_optim_loss: 6387064.4167
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9031; val_auprc_score: 0.9807; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 598204.2353; train_edge_recon_loss: 118928.2944; train_gene_expr_recon_loss: 4676320.4880; train_masked_gp_l1_reg_loss: 11397.6383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159477.4510; train_global_loss: 5564328.1370; train_optim_loss: 5564328.1370; val_kl_reg_loss: 355414.3802; val_edge_recon_loss: 119644.7708; val_gene_expr_recon_loss: 3528969.5208; val_masked_gp_l1_reg_loss: 11125.8115; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149277.7031; val_global_loss: 4164432.2083; val_optim_loss: 4164432.2083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9103; val_auprc_score: 0.9820; val_best_acc_score: 0.8523; val_best_f1_score: 0.9202; train_kl_reg_loss: 276098.8275; train_edge_recon_loss: 118492.9780; train_gene_expr_recon_loss: 4972387.9712; train_masked_gp_l1_reg_loss: 11071.5490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140205.3730; train_global_loss: 5518256.6683; train_optim_loss: 5518256.6683; val_kl_reg_loss: 291201.6458; val_edge_recon_loss: 119915.7721; val_gene_expr_recon_loss: 3593339.8333; val_masked_gp_l1_reg_loss: 10996.2490; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131071.2188; val_global_loss: 4146524.7500; val_optim_loss: 4146524.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8951; val_auprc_score: 0.9759; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 85820219.3565; train_edge_recon_loss: 117064.4554; train_gene_expr_recon_loss: 18382025.7019; train_masked_gp_l1_reg_loss: 11292.6755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124441.0521; train_global_loss: 104455040.0264; train_optim_loss: 104455040.0264; val_kl_reg_loss: 1332372.6146; val_edge_recon_loss: 120075.6335; val_gene_expr_recon_loss: 4703744.8750; val_masked_gp_l1_reg_loss: 11547.2012; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118480.1484; val_global_loss: 6286220.0417; val_optim_loss: 6286220.0417
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9118; val_auprc_score: 0.9812; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 155956403.5553; train_edge_recon_loss: 118334.5454; train_gene_expr_recon_loss: 11630742.6034; train_masked_gp_l1_reg_loss: 11311.8067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110417.2267; train_global_loss: 167827212.2163; train_optim_loss: 167827212.2163; val_kl_reg_loss: 424974.8828; val_edge_recon_loss: 120805.7396; val_gene_expr_recon_loss: 3948871.2708; val_masked_gp_l1_reg_loss: 11202.5674; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103952.3906; val_global_loss: 4609806.8750; val_optim_loss: 4609806.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8948; val_auprc_score: 0.9726; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 194017187.6815; train_edge_recon_loss: 118992.7885; train_gene_expr_recon_loss: 8290452.7981; train_masked_gp_l1_reg_loss: 11273.9615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99376.4457; train_global_loss: 202537283.1154; train_optim_loss: 202537283.1154; val_kl_reg_loss: 1862252.3333; val_edge_recon_loss: 119203.5970; val_gene_expr_recon_loss: 4359574.2500; val_masked_gp_l1_reg_loss: 11307.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94640.0000; val_global_loss: 6446977.2083; val_optim_loss: 6446977.2083
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9106; val_auprc_score: 0.9805; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 36644329.1556; train_edge_recon_loss: 119316.1048; train_gene_expr_recon_loss: 6990902.5361; train_masked_gp_l1_reg_loss: 11241.8887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89894.1125; train_global_loss: 43855681.5048; train_optim_loss: 43855681.5048; val_kl_reg_loss: 601800.0677; val_edge_recon_loss: 118511.6406; val_gene_expr_recon_loss: 3907069.4792; val_masked_gp_l1_reg_loss: 11074.8926; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85559.4531; val_global_loss: 4724015.6250; val_optim_loss: 4724015.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9103; val_auprc_score: 0.9810; val_best_acc_score: 0.8490; val_best_f1_score: 0.9183; train_kl_reg_loss: 361461.1976; train_edge_recon_loss: 118641.1342; train_gene_expr_recon_loss: 3849991.4207; train_masked_gp_l1_reg_loss: 11074.7676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83119.6944; train_global_loss: 4424288.1827; train_optim_loss: 4424288.1827; val_kl_reg_loss: 239959.8789; val_edge_recon_loss: 122527.0879; val_gene_expr_recon_loss: 3761104.0833; val_masked_gp_l1_reg_loss: 11131.1338; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80749.2344; val_global_loss: 4215471.4583; val_optim_loss: 4215471.4583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9127; val_auprc_score: 0.9824; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 234415.1629; train_edge_recon_loss: 119221.0299; train_gene_expr_recon_loss: 3735968.8726; train_masked_gp_l1_reg_loss: 11126.0366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80406.3616; train_global_loss: 4181137.4567; train_optim_loss: 4181137.4567; val_kl_reg_loss: 223479.4857; val_edge_recon_loss: 119336.5065; val_gene_expr_recon_loss: 3725308.6042; val_masked_gp_l1_reg_loss: 11127.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80131.9609; val_global_loss: 4159384.6458; val_optim_loss: 4159384.6458
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9118; val_auprc_score: 0.9824; val_best_acc_score: 0.8554; val_best_f1_score: 0.9221; train_kl_reg_loss: 220174.3344; train_edge_recon_loss: 119811.8866; train_gene_expr_recon_loss: 3672124.2957; train_masked_gp_l1_reg_loss: 11135.7579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79881.8950; train_global_loss: 4103128.1947; train_optim_loss: 4103128.1947; val_kl_reg_loss: 212852.8281; val_edge_recon_loss: 117722.6719; val_gene_expr_recon_loss: 3663141.6875; val_masked_gp_l1_reg_loss: 11142.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79623.0547; val_global_loss: 4084483.1667; val_optim_loss: 4084483.1667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9134; val_auprc_score: 0.9825; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 209964.2485; train_edge_recon_loss: 119628.8151; train_gene_expr_recon_loss: 3639387.6538; train_masked_gp_l1_reg_loss: 11149.6903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79357.0746; train_global_loss: 4059487.5072; train_optim_loss: 4059487.5072; val_kl_reg_loss: 203698.3854; val_edge_recon_loss: 120535.5195; val_gene_expr_recon_loss: 3597785.7083; val_masked_gp_l1_reg_loss: 11157.9736; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79084.8281; val_global_loss: 4012262.3750; val_optim_loss: 4012262.3750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9105; val_auprc_score: 0.9821; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 197773.7341; train_edge_recon_loss: 119621.6461; train_gene_expr_recon_loss: 2980863.5192; train_masked_gp_l1_reg_loss: 11203.4142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78874.7054; train_global_loss: 3388337.0288; train_optim_loss: 3388337.0288; val_kl_reg_loss: 192391.6888; val_edge_recon_loss: 120180.5918; val_gene_expr_recon_loss: 2499945.7917; val_masked_gp_l1_reg_loss: 11283.3291; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78712.1406; val_global_loss: 2902513.5833; val_optim_loss: 2902513.5833
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9117; val_auprc_score: 0.9823; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 192179.5999; train_edge_recon_loss: 119143.7918; train_gene_expr_recon_loss: 2338158.1346; train_masked_gp_l1_reg_loss: 11323.0530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78457.9343; train_global_loss: 2739262.5264; train_optim_loss: 2739262.5264; val_kl_reg_loss: 187816.7839; val_edge_recon_loss: 119007.4303; val_gene_expr_recon_loss: 2303569.5208; val_masked_gp_l1_reg_loss: 11349.2246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78162.9219; val_global_loss: 2699906.0000; val_optim_loss: 2699906.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9118; val_auprc_score: 0.9826; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 186351.2652; train_edge_recon_loss: 119126.8755; train_gene_expr_recon_loss: 2296903.2837; train_masked_gp_l1_reg_loss: 11359.6869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77834.8084; train_global_loss: 2691575.9135; train_optim_loss: 2691575.9135; val_kl_reg_loss: 181365.7930; val_edge_recon_loss: 118278.7025; val_gene_expr_recon_loss: 2296363.9792; val_masked_gp_l1_reg_loss: 11368.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77495.8828; val_global_loss: 2684872.7292; val_optim_loss: 2684872.7292
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9134; val_auprc_score: 0.9828; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 179824.9841; train_edge_recon_loss: 119331.6377; train_gene_expr_recon_loss: 2290078.1514; train_masked_gp_l1_reg_loss: 11374.4538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77160.4648; train_global_loss: 2677769.6947; train_optim_loss: 2677769.6947; val_kl_reg_loss: 174932.8529; val_edge_recon_loss: 118763.8574; val_gene_expr_recon_loss: 2290665.7708; val_masked_gp_l1_reg_loss: 11379.8223; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76814.6953; val_global_loss: 2672557.0000; val_optim_loss: 2672557.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9127; val_auprc_score: 0.9828; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 173965.3980; train_edge_recon_loss: 118872.0011; train_gene_expr_recon_loss: 2285006.3413; train_masked_gp_l1_reg_loss: 11384.3952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76471.0141; train_global_loss: 2665699.1683; train_optim_loss: 2665699.1683; val_kl_reg_loss: 169739.9909; val_edge_recon_loss: 118488.1562; val_gene_expr_recon_loss: 2285519.0000; val_masked_gp_l1_reg_loss: 11388.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76117.4453; val_global_loss: 2661253.1458; val_optim_loss: 2661253.1458
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9140; val_auprc_score: 0.9829; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 168849.7192; train_edge_recon_loss: 119277.9350; train_gene_expr_recon_loss: 2280691.2957; train_masked_gp_l1_reg_loss: 11392.1367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75768.4052; train_global_loss: 2655979.4736; train_optim_loss: 2655979.4736; val_kl_reg_loss: 164745.5052; val_edge_recon_loss: 120615.8822; val_gene_expr_recon_loss: 2280963.1250; val_masked_gp_l1_reg_loss: 11394.8691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75407.2578; val_global_loss: 2653126.4792; val_optim_loss: 2653126.4792
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9119; val_auprc_score: 0.9822; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 164364.6128; train_edge_recon_loss: 119263.8638; train_gene_expr_recon_loss: 2276908.0649; train_masked_gp_l1_reg_loss: 11397.2486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75049.4736; train_global_loss: 2646983.2596; train_optim_loss: 2646983.2596; val_kl_reg_loss: 160435.3919; val_edge_recon_loss: 121319.1927; val_gene_expr_recon_loss: 2276107.4583; val_masked_gp_l1_reg_loss: 11399.2051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74683.1172; val_global_loss: 2643944.3125; val_optim_loss: 2643944.3125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9138; val_auprc_score: 0.9831; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 160300.4483; train_edge_recon_loss: 119025.7203; train_gene_expr_recon_loss: 2273126.9255; train_masked_gp_l1_reg_loss: 11400.8558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74318.8855; train_global_loss: 2638172.8389; train_optim_loss: 2638172.8389; val_kl_reg_loss: 156893.4544; val_edge_recon_loss: 118908.1992; val_gene_expr_recon_loss: 2272533.3333; val_masked_gp_l1_reg_loss: 11402.4619; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73946.0000; val_global_loss: 2633683.4583; val_optim_loss: 2633683.4583
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9109; val_auprc_score: 0.9824; val_best_acc_score: 0.8549; val_best_f1_score: 0.9218; train_kl_reg_loss: 156689.9715; train_edge_recon_loss: 119086.3150; train_gene_expr_recon_loss: 2269528.7452; train_masked_gp_l1_reg_loss: 11403.2029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73574.2496; train_global_loss: 2630282.4952; train_optim_loss: 2630282.4952; val_kl_reg_loss: 153285.6823; val_edge_recon_loss: 117902.6790; val_gene_expr_recon_loss: 2267632.0833; val_masked_gp_l1_reg_loss: 11403.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73192.8828; val_global_loss: 2623416.9583; val_optim_loss: 2623416.9583
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9115; val_auprc_score: 0.9829; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 153356.6544; train_edge_recon_loss: 119397.9121; train_gene_expr_recon_loss: 2265369.2476; train_masked_gp_l1_reg_loss: 11403.4193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72818.9210; train_global_loss: 2622346.1659; train_optim_loss: 2622346.1659; val_kl_reg_loss: 150116.4062; val_edge_recon_loss: 118474.5130; val_gene_expr_recon_loss: 2263370.3750; val_masked_gp_l1_reg_loss: 11402.6035; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72433.6875; val_global_loss: 2615797.5208; val_optim_loss: 2615797.5208
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9097; val_auprc_score: 0.9824; val_best_acc_score: 0.8557; val_best_f1_score: 0.9222; train_kl_reg_loss: 150342.2592; train_edge_recon_loss: 119430.1391; train_gene_expr_recon_loss: 2261987.6875; train_masked_gp_l1_reg_loss: 11401.5827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72050.2689; train_global_loss: 2615211.9567; train_optim_loss: 2615211.9567; val_kl_reg_loss: 147621.7695; val_edge_recon_loss: 117207.4733; val_gene_expr_recon_loss: 2261010.6667; val_masked_gp_l1_reg_loss: 11399.7217; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71657.3750; val_global_loss: 2608897.0417; val_optim_loss: 2608897.0417
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9106; val_auprc_score: 0.9819; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 147583.4277; train_edge_recon_loss: 119603.2118; train_gene_expr_recon_loss: 2258095.5457; train_masked_gp_l1_reg_loss: 11397.5431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71267.4561; train_global_loss: 2607947.1971; train_optim_loss: 2607947.1971; val_kl_reg_loss: 145052.1250; val_edge_recon_loss: 121102.6426; val_gene_expr_recon_loss: 2259188.8542; val_masked_gp_l1_reg_loss: 11395.3525; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70871.0391; val_global_loss: 2607609.8542; val_optim_loss: 2607609.8542
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9116; val_auprc_score: 0.9827; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 145050.2360; train_edge_recon_loss: 118442.4512; train_gene_expr_recon_loss: 2254685.9471; train_masked_gp_l1_reg_loss: 11392.4789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70475.5811; train_global_loss: 2600046.7019; train_optim_loss: 2600046.7019; val_kl_reg_loss: 142684.8125; val_edge_recon_loss: 120077.6882; val_gene_expr_recon_loss: 2255637.3125; val_masked_gp_l1_reg_loss: 11389.9072; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70072.0547; val_global_loss: 2599861.8125; val_optim_loss: 2599861.8125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9086; val_auprc_score: 0.9819; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 142631.4854; train_edge_recon_loss: 119262.2619; train_gene_expr_recon_loss: 2251325.4952; train_masked_gp_l1_reg_loss: 11386.1765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69674.5251; train_global_loss: 2594279.9519; train_optim_loss: 2594279.9519; val_kl_reg_loss: 140188.8776; val_edge_recon_loss: 119862.3665; val_gene_expr_recon_loss: 2250192.2708; val_masked_gp_l1_reg_loss: 11381.9121; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69264.1562; val_global_loss: 2590889.7292; val_optim_loss: 2590889.7292
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9043; val_auprc_score: 0.9806; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 126588.0655; train_edge_recon_loss: 119600.3855; train_gene_expr_recon_loss: 4342071.2260; train_masked_gp_l1_reg_loss: 11636.7404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68254.9156; train_global_loss: 4668151.3029; train_optim_loss: 4668151.3029; val_kl_reg_loss: 118492.9492; val_edge_recon_loss: 119927.8574; val_gene_expr_recon_loss: 4226602.2083; val_masked_gp_l1_reg_loss: 11792.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67161.6797; val_global_loss: 4543977.0417; val_optim_loss: 4543977.0417
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9028; val_auprc_score: 0.9802; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 121999.4075; train_edge_recon_loss: 119378.8625; train_gene_expr_recon_loss: 4175374.5024; train_masked_gp_l1_reg_loss: 11856.3388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66146.6522; train_global_loss: 4494755.7404; train_optim_loss: 4494755.7404; val_kl_reg_loss: 117207.9271; val_edge_recon_loss: 119857.3008; val_gene_expr_recon_loss: 4139936.2917; val_masked_gp_l1_reg_loss: 11906.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65143.8711; val_global_loss: 4454051.5000; val_optim_loss: 4454051.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9045; val_auprc_score: 0.9809; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 119273.3730; train_edge_recon_loss: 119768.4066; train_gene_expr_recon_loss: 4098457.6659; train_masked_gp_l1_reg_loss: 11936.8107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64220.3354; train_global_loss: 4413656.6779; train_optim_loss: 4413656.6779; val_kl_reg_loss: 115362.5293; val_edge_recon_loss: 119127.1419; val_gene_expr_recon_loss: 4070899.7917; val_masked_gp_l1_reg_loss: 11962.0947; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63306.5469; val_global_loss: 4380658.0000; val_optim_loss: 4380658.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9020; val_auprc_score: 0.9795; val_best_acc_score: 0.8499; val_best_f1_score: 0.9189; train_kl_reg_loss: 116821.7709; train_edge_recon_loss: 119537.9204; train_gene_expr_recon_loss: 4034917.5000; train_masked_gp_l1_reg_loss: 11978.4991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62455.8482; train_global_loss: 4345711.5481; train_optim_loss: 4345711.5481; val_kl_reg_loss: 113505.4772; val_edge_recon_loss: 121726.4512; val_gene_expr_recon_loss: 4010070.3125; val_masked_gp_l1_reg_loss: 11992.3770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61608.2266; val_global_loss: 4318902.7500; val_optim_loss: 4318902.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9030; val_auprc_score: 0.9808; val_best_acc_score: 0.8542; val_best_f1_score: 0.9214; train_kl_reg_loss: 115562.2076; train_edge_recon_loss: 119250.5104; train_gene_expr_recon_loss: 4002360.0312; train_masked_gp_l1_reg_loss: 11992.2482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61516.9179; train_global_loss: 4310681.9519; train_optim_loss: 4310681.9519; val_kl_reg_loss: 113277.5625; val_edge_recon_loss: 118701.5573; val_gene_expr_recon_loss: 4004658.7292; val_masked_gp_l1_reg_loss: 11992.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61431.5664; val_global_loss: 4310062.2917; val_optim_loss: 4310062.2917
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9040; val_auprc_score: 0.9804; val_best_acc_score: 0.8514; val_best_f1_score: 0.9198; train_kl_reg_loss: 115329.5941; train_edge_recon_loss: 119748.9690; train_gene_expr_recon_loss: 3996730.5649; train_masked_gp_l1_reg_loss: 11993.8055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61347.3839; train_global_loss: 4305150.3077; train_optim_loss: 4305150.3077; val_kl_reg_loss: 113167.4557; val_edge_recon_loss: 120810.3822; val_gene_expr_recon_loss: 4001646.0417; val_masked_gp_l1_reg_loss: 11994.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61260.8164; val_global_loss: 4308879.3750; val_optim_loss: 4308879.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9038; val_auprc_score: 0.9809; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 115166.9939; train_edge_recon_loss: 119360.2212; train_gene_expr_recon_loss: 3992337.8798; train_masked_gp_l1_reg_loss: 11995.5188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61174.4861; train_global_loss: 4300035.1058; train_optim_loss: 4300035.1058; val_kl_reg_loss: 112902.3809; val_edge_recon_loss: 118104.5781; val_gene_expr_recon_loss: 3998777.2292; val_masked_gp_l1_reg_loss: 11996.1729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61085.6719; val_global_loss: 4302865.6667; val_optim_loss: 4302865.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9042; val_auprc_score: 0.9808; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 114861.0626; train_edge_recon_loss: 119242.5290; train_gene_expr_recon_loss: 3986997.9471; train_masked_gp_l1_reg_loss: 11996.8447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60996.9517; train_global_loss: 4294095.3365; train_optim_loss: 4294095.3365; val_kl_reg_loss: 112770.0560; val_edge_recon_loss: 120230.2389; val_gene_expr_recon_loss: 3990728.4583; val_masked_gp_l1_reg_loss: 11997.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60905.7422; val_global_loss: 4296631.7500; val_optim_loss: 4296631.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 72 min 10 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9048
val AUPRC score: 0.9807
val best accuracy score: 0.8529
val best F1 score: 0.9206
val target rna MSE score: 19.0014
val source rna MSE score: 88.6019
Val cat covariate0 mean sim diff: -0.0000

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
