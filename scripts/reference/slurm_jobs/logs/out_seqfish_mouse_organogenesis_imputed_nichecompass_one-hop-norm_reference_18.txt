[True]
Run timestamp: 27072023_063554_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8189; val_auprc_score: 0.9623; val_best_acc_score: 0.8615; val_best_f1_score: 0.9249; train_kl_reg_loss: 87782.7912; train_edge_recon_loss: 117320.7977; train_gene_expr_recon_loss: 1509857.3529; train_masked_gp_l1_reg_loss: 10422.2705; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1725383.2116; train_optim_loss: 1725383.2116; val_kl_reg_loss: 73228.9460; val_edge_recon_loss: 117320.1683; val_gene_expr_recon_loss: 1056658.8646; val_masked_gp_l1_reg_loss: 8724.5039; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1255932.4740; val_optim_loss: 1255932.4740
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8266; val_auprc_score: 0.9631; val_best_acc_score: 0.8681; val_best_f1_score: 0.9277; train_kl_reg_loss: 59518.2841; train_edge_recon_loss: 118876.9295; train_gene_expr_recon_loss: 1011172.2738; train_masked_gp_l1_reg_loss: 8819.2940; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1198386.7849; train_optim_loss: 1198386.7849; val_kl_reg_loss: 50662.7103; val_edge_recon_loss: 116676.5160; val_gene_expr_recon_loss: 968442.3984; val_masked_gp_l1_reg_loss: 9181.9424; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1144963.6146; val_optim_loss: 1144963.6146
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8435; val_auprc_score: 0.9656; val_best_acc_score: 0.8636; val_best_f1_score: 0.9246; train_kl_reg_loss: 45375.6670; train_edge_recon_loss: 114959.5995; train_gene_expr_recon_loss: 944849.8837; train_masked_gp_l1_reg_loss: 9633.2507; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1114818.4012; train_optim_loss: 1114818.4012; val_kl_reg_loss: 41169.0068; val_edge_recon_loss: 119181.2842; val_gene_expr_recon_loss: 921044.1797; val_masked_gp_l1_reg_loss: 10068.6602; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1091463.0938; val_optim_loss: 1091463.0938
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8552; val_auprc_score: 0.9701; val_best_acc_score: 0.8742; val_best_f1_score: 0.9307; train_kl_reg_loss: 37884.3253; train_edge_recon_loss: 111503.9210; train_gene_expr_recon_loss: 907120.4605; train_masked_gp_l1_reg_loss: 10476.5797; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1066985.2852; train_optim_loss: 1066985.2852; val_kl_reg_loss: 35531.7686; val_edge_recon_loss: 109959.5212; val_gene_expr_recon_loss: 890058.5052; val_masked_gp_l1_reg_loss: 10888.3740; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1046438.1589; val_optim_loss: 1046438.1589
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8664; val_auprc_score: 0.9711; val_best_acc_score: 0.8711; val_best_f1_score: 0.9288; train_kl_reg_loss: 33306.0561; train_edge_recon_loss: 111203.6452; train_gene_expr_recon_loss: 878429.1113; train_masked_gp_l1_reg_loss: 11272.9786; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1034211.7892; train_optim_loss: 1034211.7892; val_kl_reg_loss: 31442.4785; val_edge_recon_loss: 111919.8792; val_gene_expr_recon_loss: 864845.2943; val_masked_gp_l1_reg_loss: 11636.1963; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1019843.8411; val_optim_loss: 1019843.8411
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8828; val_auprc_score: 0.9757; val_best_acc_score: 0.8779; val_best_f1_score: 0.9323; train_kl_reg_loss: 30266.1357; train_edge_recon_loss: 108249.4665; train_gene_expr_recon_loss: 855178.7529; train_masked_gp_l1_reg_loss: 11984.3020; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1005678.6549; train_optim_loss: 1005678.6549; val_kl_reg_loss: 29141.2551; val_edge_recon_loss: 108091.7965; val_gene_expr_recon_loss: 843152.6172; val_masked_gp_l1_reg_loss: 12312.6738; val_group_lasso_reg_loss: 0.0000; val_global_loss: 992698.3568; val_optim_loss: 992698.3568
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8899; val_auprc_score: 0.9768; val_best_acc_score: 0.8826; val_best_f1_score: 0.9340; train_kl_reg_loss: 28252.2147; train_edge_recon_loss: 105613.9038; train_gene_expr_recon_loss: 835858.8070; train_masked_gp_l1_reg_loss: 12620.9415; train_group_lasso_reg_loss: 0.0000; train_global_loss: 982345.8692; train_optim_loss: 982345.8692; val_kl_reg_loss: 27267.5736; val_edge_recon_loss: 104907.4867; val_gene_expr_recon_loss: 825136.5990; val_masked_gp_l1_reg_loss: 12919.2148; val_group_lasso_reg_loss: 0.0000; val_global_loss: 970230.8516; val_optim_loss: 970230.8516
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8941; val_auprc_score: 0.9780; val_best_acc_score: 0.8891; val_best_f1_score: 0.9367; train_kl_reg_loss: 26553.2450; train_edge_recon_loss: 103703.0834; train_gene_expr_recon_loss: 818845.0509; train_masked_gp_l1_reg_loss: 13173.2248; train_group_lasso_reg_loss: 0.0000; train_global_loss: 962274.6038; train_optim_loss: 962274.6038; val_kl_reg_loss: 25849.1614; val_edge_recon_loss: 102423.0306; val_gene_expr_recon_loss: 809119.5885; val_masked_gp_l1_reg_loss: 13413.6152; val_group_lasso_reg_loss: 0.0000; val_global_loss: 950805.4115; val_optim_loss: 950805.4115
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8988; val_auprc_score: 0.9776; val_best_acc_score: 0.8935; val_best_f1_score: 0.9393; train_kl_reg_loss: 25134.1213; train_edge_recon_loss: 102161.1875; train_gene_expr_recon_loss: 804115.1122; train_masked_gp_l1_reg_loss: 13623.6125; train_group_lasso_reg_loss: 0.0000; train_global_loss: 945034.0328; train_optim_loss: 945034.0328; val_kl_reg_loss: 24482.2232; val_edge_recon_loss: 102081.1829; val_gene_expr_recon_loss: 795134.5417; val_masked_gp_l1_reg_loss: 13823.1943; val_group_lasso_reg_loss: 0.0000; val_global_loss: 935521.1380; val_optim_loss: 935521.1380
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9143; val_auprc_score: 0.9816; val_best_acc_score: 0.9019; val_best_f1_score: 0.9437; train_kl_reg_loss: 23802.4161; train_edge_recon_loss: 99624.7887; train_gene_expr_recon_loss: 790686.7956; train_masked_gp_l1_reg_loss: 13994.6361; train_group_lasso_reg_loss: 0.0000; train_global_loss: 928108.6337; train_optim_loss: 928108.6337; val_kl_reg_loss: 23324.5823; val_edge_recon_loss: 99996.6107; val_gene_expr_recon_loss: 782624.9036; val_masked_gp_l1_reg_loss: 14151.0273; val_group_lasso_reg_loss: 0.0000; val_global_loss: 920097.0938; val_optim_loss: 920097.0938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9170; val_auprc_score: 0.9821; val_best_acc_score: 0.9102; val_best_f1_score: 0.9489; train_kl_reg_loss: 22472.6521; train_edge_recon_loss: 99192.5884; train_gene_expr_recon_loss: 778739.3901; train_masked_gp_l1_reg_loss: 14283.9991; train_group_lasso_reg_loss: 0.0000; train_global_loss: 914688.6314; train_optim_loss: 914688.6314; val_kl_reg_loss: 21748.0508; val_edge_recon_loss: 96117.5605; val_gene_expr_recon_loss: 771693.3542; val_masked_gp_l1_reg_loss: 14387.7559; val_group_lasso_reg_loss: 0.0000; val_global_loss: 903946.7109; val_optim_loss: 903946.7109
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9180; val_auprc_score: 0.9829; val_best_acc_score: 0.9122; val_best_f1_score: 0.9500; train_kl_reg_loss: 21207.2795; train_edge_recon_loss: 96340.6652; train_gene_expr_recon_loss: 767544.0895; train_masked_gp_l1_reg_loss: 14476.2178; train_group_lasso_reg_loss: 0.0000; train_global_loss: 899568.2517; train_optim_loss: 899568.2517; val_kl_reg_loss: 20596.7812; val_edge_recon_loss: 94619.0042; val_gene_expr_recon_loss: 760206.6250; val_masked_gp_l1_reg_loss: 14543.6602; val_group_lasso_reg_loss: 0.0000; val_global_loss: 889966.1016; val_optim_loss: 889966.1016
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9195; val_auprc_score: 0.9828; val_best_acc_score: 0.9139; val_best_f1_score: 0.9508; train_kl_reg_loss: 20032.4315; train_edge_recon_loss: 95396.8852; train_gene_expr_recon_loss: 757378.7994; train_masked_gp_l1_reg_loss: 14575.6383; train_group_lasso_reg_loss: 0.0000; train_global_loss: 887383.7506; train_optim_loss: 887383.7506; val_kl_reg_loss: 19298.6296; val_edge_recon_loss: 94697.0391; val_gene_expr_recon_loss: 750696.7266; val_masked_gp_l1_reg_loss: 14583.1445; val_group_lasso_reg_loss: 0.0000; val_global_loss: 879275.5156; val_optim_loss: 879275.5156
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9245; val_auprc_score: 0.9826; val_best_acc_score: 0.9151; val_best_f1_score: 0.9516; train_kl_reg_loss: 18823.0800; train_edge_recon_loss: 93538.1146; train_gene_expr_recon_loss: 747898.2212; train_masked_gp_l1_reg_loss: 14553.6866; train_group_lasso_reg_loss: 0.0000; train_global_loss: 874813.1061; train_optim_loss: 874813.1061; val_kl_reg_loss: 18235.8340; val_edge_recon_loss: 95483.0339; val_gene_expr_recon_loss: 742114.7760; val_masked_gp_l1_reg_loss: 14504.3945; val_group_lasso_reg_loss: 0.0000; val_global_loss: 870338.0182; val_optim_loss: 870338.0182
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9295; val_auprc_score: 0.9851; val_best_acc_score: 0.9195; val_best_f1_score: 0.9539; train_kl_reg_loss: 17691.4741; train_edge_recon_loss: 92053.3073; train_gene_expr_recon_loss: 739217.5131; train_masked_gp_l1_reg_loss: 14406.9138; train_group_lasso_reg_loss: 0.0000; train_global_loss: 863369.2119; train_optim_loss: 863369.2119; val_kl_reg_loss: 17101.3180; val_edge_recon_loss: 92755.0566; val_gene_expr_recon_loss: 733176.8177; val_masked_gp_l1_reg_loss: 14290.1670; val_group_lasso_reg_loss: 0.0000; val_global_loss: 857323.3828; val_optim_loss: 857323.3828
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9314; val_auprc_score: 0.9842; val_best_acc_score: 0.9182; val_best_f1_score: 0.9529; train_kl_reg_loss: 16591.1017; train_edge_recon_loss: 91019.5737; train_gene_expr_recon_loss: 731324.7311; train_masked_gp_l1_reg_loss: 14131.9868; train_group_lasso_reg_loss: 0.0000; train_global_loss: 853067.3922; train_optim_loss: 853067.3922; val_kl_reg_loss: 16090.2156; val_edge_recon_loss: 93676.0127; val_gene_expr_recon_loss: 725786.9479; val_masked_gp_l1_reg_loss: 13951.8320; val_group_lasso_reg_loss: 0.0000; val_global_loss: 849504.9922; val_optim_loss: 849504.9922
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9349; val_auprc_score: 0.9859; val_best_acc_score: 0.9275; val_best_f1_score: 0.9583; train_kl_reg_loss: 15630.1664; train_edge_recon_loss: 90548.6491; train_gene_expr_recon_loss: 724213.8733; train_masked_gp_l1_reg_loss: 13752.6682; train_group_lasso_reg_loss: 0.0000; train_global_loss: 844145.3576; train_optim_loss: 844145.3576; val_kl_reg_loss: 15144.5760; val_edge_recon_loss: 90755.2881; val_gene_expr_recon_loss: 719063.5599; val_masked_gp_l1_reg_loss: 13528.3291; val_group_lasso_reg_loss: 0.0000; val_global_loss: 838491.7318; val_optim_loss: 838491.7318
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9362; val_auprc_score: 0.9860; val_best_acc_score: 0.9292; val_best_f1_score: 0.9596; train_kl_reg_loss: 14694.3731; train_edge_recon_loss: 88699.4809; train_gene_expr_recon_loss: 717279.5962; train_masked_gp_l1_reg_loss: 13284.0605; train_group_lasso_reg_loss: 0.0000; train_global_loss: 833957.5137; train_optim_loss: 833957.5137; val_kl_reg_loss: 14118.9639; val_edge_recon_loss: 87330.5033; val_gene_expr_recon_loss: 713298.8151; val_masked_gp_l1_reg_loss: 13026.2207; val_group_lasso_reg_loss: 0.0000; val_global_loss: 827774.5391; val_optim_loss: 827774.5391
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9393; val_auprc_score: 0.9875; val_best_acc_score: 0.9314; val_best_f1_score: 0.9605; train_kl_reg_loss: 13800.7955; train_edge_recon_loss: 88144.1172; train_gene_expr_recon_loss: 710984.7009; train_masked_gp_l1_reg_loss: 12752.3959; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825682.0081; train_optim_loss: 825682.0081; val_kl_reg_loss: 13315.3893; val_edge_recon_loss: 85426.4580; val_gene_expr_recon_loss: 709097.8021; val_masked_gp_l1_reg_loss: 12468.1787; val_group_lasso_reg_loss: 0.0000; val_global_loss: 820307.8359; val_optim_loss: 820307.8359
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9372; val_auprc_score: 0.9855; val_best_acc_score: 0.9286; val_best_f1_score: 0.9590; train_kl_reg_loss: 12958.7112; train_edge_recon_loss: 87403.2504; train_gene_expr_recon_loss: 705232.8436; train_masked_gp_l1_reg_loss: 12176.9185; train_group_lasso_reg_loss: 0.0000; train_global_loss: 817771.7233; train_optim_loss: 817771.7233; val_kl_reg_loss: 12637.6762; val_edge_recon_loss: 89439.4450; val_gene_expr_recon_loss: 701046.2630; val_masked_gp_l1_reg_loss: 11875.8477; val_group_lasso_reg_loss: 0.0000; val_global_loss: 814999.2578; val_optim_loss: 814999.2578
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9327; val_auprc_score: 0.9847; val_best_acc_score: 0.9310; val_best_f1_score: 0.9605; train_kl_reg_loss: 12278.5883; train_edge_recon_loss: 85561.5521; train_gene_expr_recon_loss: 699712.1491; train_masked_gp_l1_reg_loss: 11595.8824; train_group_lasso_reg_loss: 0.0000; train_global_loss: 809148.1695; train_optim_loss: 809148.1695; val_kl_reg_loss: 11875.1803; val_edge_recon_loss: 84494.9982; val_gene_expr_recon_loss: 695786.8438; val_masked_gp_l1_reg_loss: 11305.8867; val_group_lasso_reg_loss: 0.0000; val_global_loss: 803462.9010; val_optim_loss: 803462.9010
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9440; val_auprc_score: 0.9883; val_best_acc_score: 0.9315; val_best_f1_score: 0.9606; train_kl_reg_loss: 11660.1119; train_edge_recon_loss: 85799.3121; train_gene_expr_recon_loss: 695028.6340; train_masked_gp_l1_reg_loss: 11039.3907; train_group_lasso_reg_loss: 0.0000; train_global_loss: 803527.4535; train_optim_loss: 803527.4535; val_kl_reg_loss: 11373.1667; val_edge_recon_loss: 84421.0745; val_gene_expr_recon_loss: 691396.4115; val_masked_gp_l1_reg_loss: 10791.6328; val_group_lasso_reg_loss: 0.0000; val_global_loss: 797982.2734; val_optim_loss: 797982.2734
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9444; val_auprc_score: 0.9875; val_best_acc_score: 0.9309; val_best_f1_score: 0.9600; train_kl_reg_loss: 11129.5006; train_edge_recon_loss: 84302.1790; train_gene_expr_recon_loss: 690120.2616; train_masked_gp_l1_reg_loss: 10552.4147; train_group_lasso_reg_loss: 0.0000; train_global_loss: 796104.3581; train_optim_loss: 796104.3581; val_kl_reg_loss: 10907.7205; val_edge_recon_loss: 84368.0065; val_gene_expr_recon_loss: 686810.5755; val_masked_gp_l1_reg_loss: 10333.4180; val_group_lasso_reg_loss: 0.0000; val_global_loss: 792419.7396; val_optim_loss: 792419.7396
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9414; val_auprc_score: 0.9869; val_best_acc_score: 0.9329; val_best_f1_score: 0.9614; train_kl_reg_loss: 10677.1197; train_edge_recon_loss: 84054.0443; train_gene_expr_recon_loss: 685894.9451; train_masked_gp_l1_reg_loss: 10138.3569; train_group_lasso_reg_loss: 0.0000; train_global_loss: 790764.4669; train_optim_loss: 790764.4669; val_kl_reg_loss: 10384.5256; val_edge_recon_loss: 83236.9476; val_gene_expr_recon_loss: 682531.0807; val_masked_gp_l1_reg_loss: 9948.2295; val_group_lasso_reg_loss: 0.0000; val_global_loss: 786100.7995; val_optim_loss: 786100.7995
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9423; val_auprc_score: 0.9871; val_best_acc_score: 0.9354; val_best_f1_score: 0.9628; train_kl_reg_loss: 10296.2818; train_edge_recon_loss: 83958.1064; train_gene_expr_recon_loss: 681838.9337; train_masked_gp_l1_reg_loss: 9791.4038; train_group_lasso_reg_loss: 0.0000; train_global_loss: 785884.7235; train_optim_loss: 785884.7235; val_kl_reg_loss: 10110.0268; val_edge_recon_loss: 81844.2321; val_gene_expr_recon_loss: 678239.7839; val_masked_gp_l1_reg_loss: 9636.1338; val_group_lasso_reg_loss: 0.0000; val_global_loss: 779830.1719; val_optim_loss: 779830.1719
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9348; val_auprc_score: 0.9862; val_best_acc_score: 0.9249; val_best_f1_score: 0.9566; train_kl_reg_loss: 8758.1722; train_edge_recon_loss: 84616.2695; train_gene_expr_recon_loss: 718727.5916; train_masked_gp_l1_reg_loss: 9782.2928; train_group_lasso_reg_loss: 0.0000; train_global_loss: 821884.3215; train_optim_loss: 821884.3215; val_kl_reg_loss: 6937.9803; val_edge_recon_loss: 83368.6042; val_gene_expr_recon_loss: 705247.0312; val_masked_gp_l1_reg_loss: 9423.3516; val_group_lasso_reg_loss: 0.0000; val_global_loss: 804976.9948; val_optim_loss: 804976.9948
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9312; val_auprc_score: 0.9847; val_best_acc_score: 0.9218; val_best_f1_score: 0.9550; train_kl_reg_loss: 8130.2456; train_edge_recon_loss: 83756.2900; train_gene_expr_recon_loss: 702945.2352; train_masked_gp_l1_reg_loss: 9153.8016; train_group_lasso_reg_loss: 0.0000; train_global_loss: 803985.5767; train_optim_loss: 803985.5767; val_kl_reg_loss: 7027.2555; val_edge_recon_loss: 85590.6908; val_gene_expr_recon_loss: 698246.1641; val_masked_gp_l1_reg_loss: 8931.9980; val_group_lasso_reg_loss: 0.0000; val_global_loss: 799796.1146; val_optim_loss: 799796.1146
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9364; val_auprc_score: 0.9853; val_best_acc_score: 0.9271; val_best_f1_score: 0.9580; train_kl_reg_loss: 7677.6455; train_edge_recon_loss: 81712.7217; train_gene_expr_recon_loss: 697004.5198; train_masked_gp_l1_reg_loss: 8777.1521; train_group_lasso_reg_loss: 0.0000; train_global_loss: 795172.0422; train_optim_loss: 795172.0422; val_kl_reg_loss: 6956.6089; val_edge_recon_loss: 82743.0745; val_gene_expr_recon_loss: 693058.1562; val_masked_gp_l1_reg_loss: 8623.9512; val_group_lasso_reg_loss: 0.0000; val_global_loss: 791381.7734; val_optim_loss: 791381.7734
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9456; val_auprc_score: 0.9879; val_best_acc_score: 0.9309; val_best_f1_score: 0.9602; train_kl_reg_loss: 7365.5483; train_edge_recon_loss: 81583.3215; train_gene_expr_recon_loss: 692155.3110; train_masked_gp_l1_reg_loss: 8502.5904; train_group_lasso_reg_loss: 0.0000; train_global_loss: 789606.7709; train_optim_loss: 789606.7709; val_kl_reg_loss: 6865.1614; val_edge_recon_loss: 82454.9834; val_gene_expr_recon_loss: 689174.0000; val_masked_gp_l1_reg_loss: 8409.0908; val_group_lasso_reg_loss: 0.0000; val_global_loss: 786903.2109; val_optim_loss: 786903.2109

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9486; val_auprc_score: 0.9894; val_best_acc_score: 0.9329; val_best_f1_score: 0.9612; train_kl_reg_loss: 7196.8078; train_edge_recon_loss: 80524.9385; train_gene_expr_recon_loss: 689289.4346; train_masked_gp_l1_reg_loss: 8302.1606; train_group_lasso_reg_loss: 0.0000; train_global_loss: 785313.3419; train_optim_loss: 785313.3419; val_kl_reg_loss: 6819.8731; val_edge_recon_loss: 78998.5140; val_gene_expr_recon_loss: 687897.2161; val_masked_gp_l1_reg_loss: 8281.1445; val_group_lasso_reg_loss: 0.0000; val_global_loss: 781996.7292; val_optim_loss: 781996.7292
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9419; val_auprc_score: 0.9870; val_best_acc_score: 0.9312; val_best_f1_score: 0.9604; train_kl_reg_loss: 7184.6854; train_edge_recon_loss: 81049.1680; train_gene_expr_recon_loss: 688894.8119; train_masked_gp_l1_reg_loss: 8270.0895; train_group_lasso_reg_loss: 0.0000; train_global_loss: 785398.7567; train_optim_loss: 785398.7567; val_kl_reg_loss: 6832.8717; val_edge_recon_loss: 80654.3397; val_gene_expr_recon_loss: 687881.6198; val_masked_gp_l1_reg_loss: 8257.1689; val_group_lasso_reg_loss: 0.0000; val_global_loss: 783626.0156; val_optim_loss: 783626.0156
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9414; val_auprc_score: 0.9868; val_best_acc_score: 0.9279; val_best_f1_score: 0.9585; train_kl_reg_loss: 7175.0441; train_edge_recon_loss: 81393.3327; train_gene_expr_recon_loss: 688882.5669; train_masked_gp_l1_reg_loss: 8247.8418; train_group_lasso_reg_loss: 0.0000; train_global_loss: 785698.7901; train_optim_loss: 785698.7901; val_kl_reg_loss: 6802.8320; val_edge_recon_loss: 83727.0023; val_gene_expr_recon_loss: 688074.8880; val_masked_gp_l1_reg_loss: 8238.5684; val_group_lasso_reg_loss: 0.0000; val_global_loss: 786843.2865; val_optim_loss: 786843.2865
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9449; val_auprc_score: 0.9881; val_best_acc_score: 0.9312; val_best_f1_score: 0.9604; train_kl_reg_loss: 7155.5293; train_edge_recon_loss: 80927.6752; train_gene_expr_recon_loss: 688459.6689; train_masked_gp_l1_reg_loss: 8228.2767; train_group_lasso_reg_loss: 0.0000; train_global_loss: 784771.1506; train_optim_loss: 784771.1506; val_kl_reg_loss: 6799.9387; val_edge_recon_loss: 80276.2666; val_gene_expr_recon_loss: 687194.9583; val_masked_gp_l1_reg_loss: 8216.6484; val_group_lasso_reg_loss: 0.0000; val_global_loss: 782487.7917; val_optim_loss: 782487.7917

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 96 min 59 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9343
Val AUPRC score: 0.9862
Val best accuracy score: 0.9214
Val best F1 score: 0.9549
Val gene expr MSE score: 86635.3960
Val cat covariate0 mean sim diff: -0.0036

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
