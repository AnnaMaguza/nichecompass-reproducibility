[True, False, True]
Run timestamp: 05102023_213259_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0078125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 631979
Number of validation nodes: 70220
Number of training edges: 1492281
Number of validation edges: 165809
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8675; val_auprc_score: 0.9748; val_best_acc_score: 0.9163; val_best_f1_score: 0.9540; train_kl_reg_loss: 15963.4757; train_edge_recon_loss: 644045.5619; train_cat_covariates_contrastive_loss: 949030.1912; train_gene_expr_recon_loss: 2633649.8581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4242689.0904; train_optim_loss: 4242689.0904; val_kl_reg_loss: 18922.5707; val_edge_recon_loss: 656817.9051; val_cat_covariates_contrastive_loss: 948043.2450; val_gene_expr_recon_loss: 2310336.0386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3934119.7554; val_optim_loss: 3934119.7554
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8909; val_auprc_score: 0.9788; val_best_acc_score: 0.9241; val_best_f1_score: 0.9581; train_kl_reg_loss: 19667.2877; train_edge_recon_loss: 623668.4973; train_cat_covariates_contrastive_loss: 949289.5062; train_gene_expr_recon_loss: 2202216.0101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3794841.3004; train_optim_loss: 3794841.3004; val_kl_reg_loss: 21161.7170; val_edge_recon_loss: 648564.7995; val_cat_covariates_contrastive_loss: 947187.2328; val_gene_expr_recon_loss: 2118765.6844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3735679.4336; val_optim_loss: 3735679.4336
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9061; val_auprc_score: 0.9823; val_best_acc_score: 0.9288; val_best_f1_score: 0.9607; train_kl_reg_loss: 20523.7183; train_edge_recon_loss: 617051.0840; train_cat_covariates_contrastive_loss: 948955.0877; train_gene_expr_recon_loss: 2091181.0286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3677710.9182; train_optim_loss: 3677710.9182; val_kl_reg_loss: 20068.5413; val_edge_recon_loss: 637213.1284; val_cat_covariates_contrastive_loss: 948659.5204; val_gene_expr_recon_loss: 2060728.7203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3666669.9167; val_optim_loss: 3666669.9167
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9114; val_auprc_score: 0.9836; val_best_acc_score: 0.9327; val_best_f1_score: 0.9628; train_kl_reg_loss: 20937.0984; train_edge_recon_loss: 614700.4583; train_cat_covariates_contrastive_loss: 948660.8236; train_gene_expr_recon_loss: 2047612.9095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3631911.2884; train_optim_loss: 3631911.2884; val_kl_reg_loss: 21895.8042; val_edge_recon_loss: 635993.2838; val_cat_covariates_contrastive_loss: 947829.9136; val_gene_expr_recon_loss: 2032706.1346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3638425.1343; val_optim_loss: 3638425.1343
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9201; val_auprc_score: 0.9855; val_best_acc_score: 0.9357; val_best_f1_score: 0.9644; train_kl_reg_loss: 21281.3645; train_edge_recon_loss: 612719.2871; train_cat_covariates_contrastive_loss: 948586.1665; train_gene_expr_recon_loss: 2023514.4708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3606101.2865; train_optim_loss: 3606101.2865; val_kl_reg_loss: 20696.6185; val_edge_recon_loss: 635607.9265; val_cat_covariates_contrastive_loss: 950121.8819; val_gene_expr_recon_loss: 2010158.5883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3616585.0123; val_optim_loss: 3616585.0123
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9172; val_auprc_score: 0.9845; val_best_acc_score: 0.9348; val_best_f1_score: 0.9639; train_kl_reg_loss: 21641.5634; train_edge_recon_loss: 613535.3957; train_cat_covariates_contrastive_loss: 948522.5847; train_gene_expr_recon_loss: 2005773.3313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3589472.8744; train_optim_loss: 3589472.8744; val_kl_reg_loss: 22672.3785; val_edge_recon_loss: 631876.4805; val_cat_covariates_contrastive_loss: 947702.0349; val_gene_expr_recon_loss: 1995171.1435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3597422.0332; val_optim_loss: 3597422.0332
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9159; val_auprc_score: 0.9843; val_best_acc_score: 0.9346; val_best_f1_score: 0.9638; train_kl_reg_loss: 21991.3981; train_edge_recon_loss: 611584.7978; train_cat_covariates_contrastive_loss: 948542.6134; train_gene_expr_recon_loss: 1991401.9814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3573520.7888; train_optim_loss: 3573520.7888; val_kl_reg_loss: 22609.4219; val_edge_recon_loss: 635052.0413; val_cat_covariates_contrastive_loss: 947902.2002; val_gene_expr_recon_loss: 1984890.3198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3590453.9807; val_optim_loss: 3590453.9807
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9228; val_auprc_score: 0.9854; val_best_acc_score: 0.9378; val_best_f1_score: 0.9655; train_kl_reg_loss: 22343.4886; train_edge_recon_loss: 610295.1117; train_cat_covariates_contrastive_loss: 948571.8709; train_gene_expr_recon_loss: 1978627.5392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559838.0084; train_optim_loss: 3559838.0084; val_kl_reg_loss: 23339.3492; val_edge_recon_loss: 638687.9974; val_cat_covariates_contrastive_loss: 947727.1784; val_gene_expr_recon_loss: 1975701.3769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3585455.9028; val_optim_loss: 3585455.9028
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9246; val_auprc_score: 0.9860; val_best_acc_score: 0.9381; val_best_f1_score: 0.9657; train_kl_reg_loss: 22629.6473; train_edge_recon_loss: 609946.0430; train_cat_covariates_contrastive_loss: 948711.5608; train_gene_expr_recon_loss: 1967383.6073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3548670.8557; train_optim_loss: 3548670.8557; val_kl_reg_loss: 22588.0744; val_edge_recon_loss: 634648.7190; val_cat_covariates_contrastive_loss: 948950.0276; val_gene_expr_recon_loss: 1960427.7658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3566614.5779; val_optim_loss: 3566614.5779
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9240; val_auprc_score: 0.9857; val_best_acc_score: 0.9394; val_best_f1_score: 0.9664; train_kl_reg_loss: 22958.0498; train_edge_recon_loss: 609386.5069; train_cat_covariates_contrastive_loss: 948737.1125; train_gene_expr_recon_loss: 1960362.6371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3541444.3067; train_optim_loss: 3541444.3067; val_kl_reg_loss: 23815.9977; val_edge_recon_loss: 632521.3168; val_cat_covariates_contrastive_loss: 947642.5044; val_gene_expr_recon_loss: 1956785.6505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3560765.4645; val_optim_loss: 3560765.4645
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9269; val_auprc_score: 0.9869; val_best_acc_score: 0.9379; val_best_f1_score: 0.9656; train_kl_reg_loss: 23101.4521; train_edge_recon_loss: 610561.7870; train_cat_covariates_contrastive_loss: 948733.7306; train_gene_expr_recon_loss: 1953650.4247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3536047.3955; train_optim_loss: 3536047.3955; val_kl_reg_loss: 22217.8387; val_edge_recon_loss: 632298.9123; val_cat_covariates_contrastive_loss: 951329.8420; val_gene_expr_recon_loss: 1947026.4703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3552873.0687; val_optim_loss: 3552873.0687
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9282; val_auprc_score: 0.9866; val_best_acc_score: 0.9401; val_best_f1_score: 0.9667; train_kl_reg_loss: 23230.1192; train_edge_recon_loss: 608630.6765; train_cat_covariates_contrastive_loss: 948729.8768; train_gene_expr_recon_loss: 1947954.3582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3528545.0303; train_optim_loss: 3528545.0303; val_kl_reg_loss: 22558.3167; val_edge_recon_loss: 635871.2199; val_cat_covariates_contrastive_loss: 950406.1649; val_gene_expr_recon_loss: 1954733.9255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3563569.6204; val_optim_loss: 3563569.6204
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9285; val_auprc_score: 0.9868; val_best_acc_score: 0.9393; val_best_f1_score: 0.9663; train_kl_reg_loss: 23391.5061; train_edge_recon_loss: 610955.3965; train_cat_covariates_contrastive_loss: 948727.8340; train_gene_expr_recon_loss: 1945372.8511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3528447.5886; train_optim_loss: 3528447.5886; val_kl_reg_loss: 23273.7367; val_edge_recon_loss: 627004.7022; val_cat_covariates_contrastive_loss: 949925.2348; val_gene_expr_recon_loss: 1938744.3036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3538947.9715; val_optim_loss: 3538947.9715
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9249; val_auprc_score: 0.9857; val_best_acc_score: 0.9415; val_best_f1_score: 0.9675; train_kl_reg_loss: 23539.2084; train_edge_recon_loss: 610370.7349; train_cat_covariates_contrastive_loss: 948690.6354; train_gene_expr_recon_loss: 1938789.6681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3521390.2479; train_optim_loss: 3521390.2479; val_kl_reg_loss: 24621.8798; val_edge_recon_loss: 629735.4932; val_cat_covariates_contrastive_loss: 947280.2267; val_gene_expr_recon_loss: 1939246.2091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3540883.8040; val_optim_loss: 3540883.8040
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9331; val_auprc_score: 0.9879; val_best_acc_score: 0.9414; val_best_f1_score: 0.9674; train_kl_reg_loss: 23469.1630; train_edge_recon_loss: 608777.5193; train_cat_covariates_contrastive_loss: 948719.5310; train_gene_expr_recon_loss: 1934504.2690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3515470.4829; train_optim_loss: 3515470.4829; val_kl_reg_loss: 22631.3460; val_edge_recon_loss: 628835.8347; val_cat_covariates_contrastive_loss: 950663.2766; val_gene_expr_recon_loss: 1937138.5656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3539269.0231; val_optim_loss: 3539269.0231
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9268; val_auprc_score: 0.9861; val_best_acc_score: 0.9392; val_best_f1_score: 0.9663; train_kl_reg_loss: 23550.2075; train_edge_recon_loss: 609336.7168; train_cat_covariates_contrastive_loss: 948727.0253; train_gene_expr_recon_loss: 1935404.3567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3517018.3033; train_optim_loss: 3517018.3033; val_kl_reg_loss: 23486.2601; val_edge_recon_loss: 627406.4091; val_cat_covariates_contrastive_loss: 948636.0828; val_gene_expr_recon_loss: 1928899.1427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3528427.8897; val_optim_loss: 3528427.8897
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9299; val_auprc_score: 0.9869; val_best_acc_score: 0.9398; val_best_f1_score: 0.9666; train_kl_reg_loss: 23593.8425; train_edge_recon_loss: 607472.8334; train_cat_covariates_contrastive_loss: 948711.3791; train_gene_expr_recon_loss: 1929101.3482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3508879.4018; train_optim_loss: 3508879.4018; val_kl_reg_loss: 23391.2784; val_edge_recon_loss: 628949.8797; val_cat_covariates_contrastive_loss: 949512.9126; val_gene_expr_recon_loss: 1933125.0282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3534979.1111; val_optim_loss: 3534979.1111
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9265; val_auprc_score: 0.9861; val_best_acc_score: 0.9401; val_best_f1_score: 0.9668; train_kl_reg_loss: 5419709119568.1025; train_edge_recon_loss: 612213.7332; train_cat_covariates_contrastive_loss: 948956.1768; train_gene_expr_recon_loss: 2117984.7423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5419712794487.4473; train_optim_loss: 5419712794487.4473; val_kl_reg_loss: 26433.9611; val_edge_recon_loss: 628944.6174; val_cat_covariates_contrastive_loss: 948709.9315; val_gene_expr_recon_loss: 2031545.2176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3635633.7276; val_optim_loss: 3635633.7276
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9273; val_auprc_score: 0.9862; val_best_acc_score: 0.9403; val_best_f1_score: 0.9669; train_kl_reg_loss: 25751.7830; train_edge_recon_loss: 607924.3714; train_cat_covariates_contrastive_loss: 949549.8464; train_gene_expr_recon_loss: 2010493.5061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3593719.5021; train_optim_loss: 3593719.5021; val_kl_reg_loss: 26407.4565; val_edge_recon_loss: 627579.8052; val_cat_covariates_contrastive_loss: 948573.9416; val_gene_expr_recon_loss: 1990819.4923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3593380.6929; val_optim_loss: 3593380.6929
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9204; val_auprc_score: 0.9845; val_best_acc_score: 0.9372; val_best_f1_score: 0.9651; train_kl_reg_loss: 25788.8828; train_edge_recon_loss: 611803.2044; train_cat_covariates_contrastive_loss: 949482.6095; train_gene_expr_recon_loss: 1980186.5320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3567261.2292; train_optim_loss: 3567261.2292; val_kl_reg_loss: 27510.8730; val_edge_recon_loss: 630923.4846; val_cat_covariates_contrastive_loss: 947873.3787; val_gene_expr_recon_loss: 1972034.2230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3578341.9552; val_optim_loss: 3578341.9552

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9326; val_auprc_score: 0.9872; val_best_acc_score: 0.9425; val_best_f1_score: 0.9680; train_kl_reg_loss: 26201.7627; train_edge_recon_loss: 605922.0766; train_cat_covariates_contrastive_loss: 949519.8669; train_gene_expr_recon_loss: 1942468.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3524112.2917; train_optim_loss: 3524112.2917; val_kl_reg_loss: 26042.9751; val_edge_recon_loss: 627850.0325; val_cat_covariates_contrastive_loss: 949816.0554; val_gene_expr_recon_loss: 1941164.5694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3544873.6358; val_optim_loss: 3544873.6358
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9311; val_auprc_score: 0.9869; val_best_acc_score: 0.9415; val_best_f1_score: 0.9675; train_kl_reg_loss: 26181.7436; train_edge_recon_loss: 607806.1881; train_cat_covariates_contrastive_loss: 949474.5397; train_gene_expr_recon_loss: 1935034.4454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3518496.9181; train_optim_loss: 3518496.9181; val_kl_reg_loss: 25999.8928; val_edge_recon_loss: 634100.2086; val_cat_covariates_contrastive_loss: 949627.0376; val_gene_expr_recon_loss: 1934875.5787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3544602.7215; val_optim_loss: 3544602.7215
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9319; val_auprc_score: 0.9874; val_best_acc_score: 0.9426; val_best_f1_score: 0.9681; train_kl_reg_loss: 26108.9872; train_edge_recon_loss: 607503.8302; train_cat_covariates_contrastive_loss: 949383.8111; train_gene_expr_recon_loss: 1930209.0654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3513205.6955; train_optim_loss: 3513205.6955; val_kl_reg_loss: 25745.6231; val_edge_recon_loss: 618357.2498; val_cat_covariates_contrastive_loss: 950293.6647; val_gene_expr_recon_loss: 1930487.4610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3524884.0015; val_optim_loss: 3524884.0015
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9307; val_auprc_score: 0.9865; val_best_acc_score: 0.9412; val_best_f1_score: 0.9672; train_kl_reg_loss: 25983.7548; train_edge_recon_loss: 607049.5056; train_cat_covariates_contrastive_loss: 949396.0370; train_gene_expr_recon_loss: 1926173.2130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3508602.5085; train_optim_loss: 3508602.5085; val_kl_reg_loss: 26428.3897; val_edge_recon_loss: 637914.0506; val_cat_covariates_contrastive_loss: 949032.9199; val_gene_expr_recon_loss: 1927149.0451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3540524.3997; val_optim_loss: 3540524.3997
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9331; val_auprc_score: 0.9873; val_best_acc_score: 0.9421; val_best_f1_score: 0.9678; train_kl_reg_loss: 25834.5067; train_edge_recon_loss: 606780.5939; train_cat_covariates_contrastive_loss: 949311.9133; train_gene_expr_recon_loss: 1922463.9496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3504390.9627; train_optim_loss: 3504390.9627; val_kl_reg_loss: 25636.3785; val_edge_recon_loss: 627576.5291; val_cat_covariates_contrastive_loss: 949532.4674; val_gene_expr_recon_loss: 1922516.6813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3525262.0602; val_optim_loss: 3525262.0602
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9296; val_auprc_score: 0.9870; val_best_acc_score: 0.9411; val_best_f1_score: 0.9673; train_kl_reg_loss: 24029.5866; train_edge_recon_loss: 610919.8922; train_cat_covariates_contrastive_loss: 951933.8397; train_gene_expr_recon_loss: 1749188.7956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3336072.1149; train_optim_loss: 3336072.1149; val_kl_reg_loss: 13685.6365; val_edge_recon_loss: 625426.4741; val_cat_covariates_contrastive_loss: 950574.1296; val_gene_expr_recon_loss: 1726023.7616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3315709.9892; val_optim_loss: 3315709.9892
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9285; val_auprc_score: 0.9865; val_best_acc_score: 0.9403; val_best_f1_score: 0.9668; train_kl_reg_loss: 20370.6340; train_edge_recon_loss: 609145.3813; train_cat_covariates_contrastive_loss: 949230.1732; train_gene_expr_recon_loss: 1717387.3560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3296133.5439; train_optim_loss: 3296133.5439; val_kl_reg_loss: 15138.4476; val_edge_recon_loss: 631197.7323; val_cat_covariates_contrastive_loss: 948201.5579; val_gene_expr_recon_loss: 1711021.8221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3305559.5586; val_optim_loss: 3305559.5586
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9308; val_auprc_score: 0.9872; val_best_acc_score: 0.9404; val_best_f1_score: 0.9669; train_kl_reg_loss: 18681.3549; train_edge_recon_loss: 608338.3432; train_cat_covariates_contrastive_loss: 948205.8526; train_gene_expr_recon_loss: 1703413.2218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3278638.7725; train_optim_loss: 3278638.7725; val_kl_reg_loss: 15244.8202; val_edge_recon_loss: 628321.3544; val_cat_covariates_contrastive_loss: 949397.4724; val_gene_expr_recon_loss: 1696943.2963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3289906.9383; val_optim_loss: 3289906.9383
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9281; val_auprc_score: 0.9860; val_best_acc_score: 0.9408; val_best_f1_score: 0.9671; train_kl_reg_loss: 18033.3651; train_edge_recon_loss: 610312.9308; train_cat_covariates_contrastive_loss: 947925.7832; train_gene_expr_recon_loss: 1691904.9918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3268177.0722; train_optim_loss: 3268177.0722; val_kl_reg_loss: 15746.8928; val_edge_recon_loss: 633356.9884; val_cat_covariates_contrastive_loss: 947612.5584; val_gene_expr_recon_loss: 1687618.7704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3284335.2083; val_optim_loss: 3284335.2083
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9308; val_auprc_score: 0.9869; val_best_acc_score: 0.9410; val_best_f1_score: 0.9673; train_kl_reg_loss: 17849.7025; train_edge_recon_loss: 606505.9242; train_cat_covariates_contrastive_loss: 948031.2408; train_gene_expr_recon_loss: 1682368.4353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3254755.2997; train_optim_loss: 3254755.2997; val_kl_reg_loss: 15402.8971; val_edge_recon_loss: 624240.6225; val_cat_covariates_contrastive_loss: 948052.6682; val_gene_expr_recon_loss: 1678265.2450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265961.4375; val_optim_loss: 3265961.4375
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9289; val_auprc_score: 0.9868; val_best_acc_score: 0.9405; val_best_f1_score: 0.9671; train_kl_reg_loss: 17450.7821; train_edge_recon_loss: 607488.5004; train_cat_covariates_contrastive_loss: 947691.0547; train_gene_expr_recon_loss: 1675884.4018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3248514.7382; train_optim_loss: 3248514.7382; val_kl_reg_loss: 15887.2875; val_edge_recon_loss: 620289.9151; val_cat_covariates_contrastive_loss: 947908.9749; val_gene_expr_recon_loss: 1672245.1613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3256331.3465; val_optim_loss: 3256331.3465
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9303; val_auprc_score: 0.9869; val_best_acc_score: 0.9400; val_best_f1_score: 0.9667; train_kl_reg_loss: 17182.1785; train_edge_recon_loss: 606491.9465; train_cat_covariates_contrastive_loss: 947610.4793; train_gene_expr_recon_loss: 1668194.9208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3239479.5271; train_optim_loss: 3239479.5271; val_kl_reg_loss: 16322.1683; val_edge_recon_loss: 628513.4221; val_cat_covariates_contrastive_loss: 947889.6647; val_gene_expr_recon_loss: 1673016.3032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265741.5556; val_optim_loss: 3265741.5556
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9288; val_auprc_score: 0.9866; val_best_acc_score: 0.9415; val_best_f1_score: 0.9676; train_kl_reg_loss: 16966.7464; train_edge_recon_loss: 607083.6334; train_cat_covariates_contrastive_loss: 947465.1302; train_gene_expr_recon_loss: 1662567.9079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3234083.4172; train_optim_loss: 3234083.4172; val_kl_reg_loss: 16289.9363; val_edge_recon_loss: 620618.7316; val_cat_covariates_contrastive_loss: 947266.0922; val_gene_expr_recon_loss: 1660307.5239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3244482.2724; val_optim_loss: 3244482.2724
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9288; val_auprc_score: 0.9867; val_best_acc_score: 0.9413; val_best_f1_score: 0.9675; train_kl_reg_loss: 16847.3225; train_edge_recon_loss: 606689.9634; train_cat_covariates_contrastive_loss: 947369.7252; train_gene_expr_recon_loss: 1657565.8985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3228472.9088; train_optim_loss: 3228472.9088; val_kl_reg_loss: 16211.5238; val_edge_recon_loss: 622385.0223; val_cat_covariates_contrastive_loss: 947107.4371; val_gene_expr_recon_loss: 1654558.6123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3240262.5918; val_optim_loss: 3240262.5918
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9315; val_auprc_score: 0.9869; val_best_acc_score: 0.9409; val_best_f1_score: 0.9672; train_kl_reg_loss: 16950.6995; train_edge_recon_loss: 607234.6599; train_cat_covariates_contrastive_loss: 947670.8976; train_gene_expr_recon_loss: 1650955.2035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222811.4611; train_optim_loss: 3222811.4611; val_kl_reg_loss: 15129.8928; val_edge_recon_loss: 633939.6030; val_cat_covariates_contrastive_loss: 947334.8077; val_gene_expr_recon_loss: 1645219.3688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3241623.6744; val_optim_loss: 3241623.6744
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9296; val_auprc_score: 0.9866; val_best_acc_score: 0.9406; val_best_f1_score: 0.9670; train_kl_reg_loss: 16844.5583; train_edge_recon_loss: 605358.9105; train_cat_covariates_contrastive_loss: 947468.0738; train_gene_expr_recon_loss: 1643884.5320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3213556.0731; train_optim_loss: 3213556.0731; val_kl_reg_loss: 14948.4821; val_edge_recon_loss: 623214.8061; val_cat_covariates_contrastive_loss: 947936.6553; val_gene_expr_recon_loss: 1641576.1439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3227676.0733; val_optim_loss: 3227676.0733
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9294; val_auprc_score: 0.9864; val_best_acc_score: 0.9407; val_best_f1_score: 0.9671; train_kl_reg_loss: 16547.3133; train_edge_recon_loss: 607468.2143; train_cat_covariates_contrastive_loss: 947293.4458; train_gene_expr_recon_loss: 1639374.6015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3210683.5740; train_optim_loss: 3210683.5740; val_kl_reg_loss: 14972.6522; val_edge_recon_loss: 631445.6544; val_cat_covariates_contrastive_loss: 947921.8584; val_gene_expr_recon_loss: 1637511.8677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3231852.0255; val_optim_loss: 3231852.0255
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9307; val_auprc_score: 0.9870; val_best_acc_score: 0.9406; val_best_f1_score: 0.9671; train_kl_reg_loss: 16304.2108; train_edge_recon_loss: 605837.1981; train_cat_covariates_contrastive_loss: 947068.1968; train_gene_expr_recon_loss: 1634609.9751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3203819.5816; train_optim_loss: 3203819.5816; val_kl_reg_loss: 15312.9137; val_edge_recon_loss: 626919.5949; val_cat_covariates_contrastive_loss: 946960.8632; val_gene_expr_recon_loss: 1633588.6215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3222782.0062; val_optim_loss: 3222782.0062
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9344; val_auprc_score: 0.9878; val_best_acc_score: 0.9422; val_best_f1_score: 0.9678; train_kl_reg_loss: 16139.2881; train_edge_recon_loss: 606525.4357; train_cat_covariates_contrastive_loss: 946930.9516; train_gene_expr_recon_loss: 1631382.7443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3200978.4183; train_optim_loss: 3200978.4183; val_kl_reg_loss: 15115.5241; val_edge_recon_loss: 626184.1529; val_cat_covariates_contrastive_loss: 947584.3534; val_gene_expr_recon_loss: 1632359.1026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3221243.1312; val_optim_loss: 3221243.1312
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9328; val_auprc_score: 0.9873; val_best_acc_score: 0.9417; val_best_f1_score: 0.9676; train_kl_reg_loss: 15996.6841; train_edge_recon_loss: 604943.3583; train_cat_covariates_contrastive_loss: 946902.2683; train_gene_expr_recon_loss: 1630476.3681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3198318.6815; train_optim_loss: 3198318.6815; val_kl_reg_loss: 14828.5470; val_edge_recon_loss: 632002.2604; val_cat_covariates_contrastive_loss: 947631.1109; val_gene_expr_recon_loss: 1629014.6671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3223476.5872; val_optim_loss: 3223476.5872
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9316; val_auprc_score: 0.9870; val_best_acc_score: 0.9412; val_best_f1_score: 0.9673; train_kl_reg_loss: 15879.9370; train_edge_recon_loss: 605311.9834; train_cat_covariates_contrastive_loss: 946901.5499; train_gene_expr_recon_loss: 1628075.4035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3196168.8752; train_optim_loss: 3196168.8752; val_kl_reg_loss: 15259.9016; val_edge_recon_loss: 632080.6383; val_cat_covariates_contrastive_loss: 946788.0745; val_gene_expr_recon_loss: 1626683.6998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3220812.3179; val_optim_loss: 3220812.3179
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9309; val_auprc_score: 0.9868; val_best_acc_score: 0.9421; val_best_f1_score: 0.9678; train_kl_reg_loss: 15749.1704; train_edge_recon_loss: 605424.4993; train_cat_covariates_contrastive_loss: 946708.2229; train_gene_expr_recon_loss: 1626047.7248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3193929.6166; train_optim_loss: 3193929.6166; val_kl_reg_loss: 15291.9643; val_edge_recon_loss: 621686.2525; val_cat_covariates_contrastive_loss: 946780.8302; val_gene_expr_recon_loss: 1625704.3611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3209463.4059; val_optim_loss: 3209463.4059
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9308; val_auprc_score: 0.9868; val_best_acc_score: 0.9423; val_best_f1_score: 0.9680; train_kl_reg_loss: 15682.4995; train_edge_recon_loss: 606328.9218; train_cat_covariates_contrastive_loss: 946748.0554; train_gene_expr_recon_loss: 1624246.2064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3193005.6834; train_optim_loss: 3193005.6834; val_kl_reg_loss: 15416.5564; val_edge_recon_loss: 624260.9428; val_cat_covariates_contrastive_loss: 946421.5664; val_gene_expr_recon_loss: 1622364.7924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3208463.8596; val_optim_loss: 3208463.8596
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9349; val_auprc_score: 0.9880; val_best_acc_score: 0.9428; val_best_f1_score: 0.9683; train_kl_reg_loss: 15614.1040; train_edge_recon_loss: 605070.4163; train_cat_covariates_contrastive_loss: 946640.2375; train_gene_expr_recon_loss: 1621456.7382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3188781.4967; train_optim_loss: 3188781.4967; val_kl_reg_loss: 14867.4737; val_edge_recon_loss: 621431.8536; val_cat_covariates_contrastive_loss: 947167.1782; val_gene_expr_recon_loss: 1618258.1640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3201724.6775; val_optim_loss: 3201724.6775
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9324; val_auprc_score: 0.9873; val_best_acc_score: 0.9421; val_best_f1_score: 0.9678; train_kl_reg_loss: 15617.3926; train_edge_recon_loss: 604762.5094; train_cat_covariates_contrastive_loss: 946544.7555; train_gene_expr_recon_loss: 1616982.3719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3183907.0299; train_optim_loss: 3183907.0299; val_kl_reg_loss: 15122.6686; val_edge_recon_loss: 626302.0949; val_cat_covariates_contrastive_loss: 946342.8210; val_gene_expr_recon_loss: 1614029.7867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3201797.3688; val_optim_loss: 3201797.3688
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9322; val_auprc_score: 0.9871; val_best_acc_score: 0.9434; val_best_f1_score: 0.9686; train_kl_reg_loss: 15527.0517; train_edge_recon_loss: 605344.2328; train_cat_covariates_contrastive_loss: 946491.2591; train_gene_expr_recon_loss: 1612717.2838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3180079.8264; train_optim_loss: 3180079.8264; val_kl_reg_loss: 14743.5588; val_edge_recon_loss: 623994.2953; val_cat_covariates_contrastive_loss: 946806.3941; val_gene_expr_recon_loss: 1615921.4221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3201465.6752; val_optim_loss: 3201465.6752
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9326; val_auprc_score: 0.9874; val_best_acc_score: 0.9420; val_best_f1_score: 0.9678; train_kl_reg_loss: 15499.4869; train_edge_recon_loss: 603841.5912; train_cat_covariates_contrastive_loss: 946411.8738; train_gene_expr_recon_loss: 1612347.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3178100.3069; train_optim_loss: 3178100.3069; val_kl_reg_loss: 14721.3488; val_edge_recon_loss: 625170.5199; val_cat_covariates_contrastive_loss: 946899.3229; val_gene_expr_recon_loss: 1611449.7319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3198240.9213; val_optim_loss: 3198240.9213
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9307; val_auprc_score: 0.9870; val_best_acc_score: 0.9408; val_best_f1_score: 0.9671; train_kl_reg_loss: 15529.6120; train_edge_recon_loss: 605670.8997; train_cat_covariates_contrastive_loss: 946609.3268; train_gene_expr_recon_loss: 1610037.3933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3177847.2342; train_optim_loss: 3177847.2342; val_kl_reg_loss: 14706.8275; val_edge_recon_loss: 624523.0421; val_cat_covariates_contrastive_loss: 946348.4578; val_gene_expr_recon_loss: 1609579.8167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3195158.1412; val_optim_loss: 3195158.1412
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9330; val_auprc_score: 0.9874; val_best_acc_score: 0.9430; val_best_f1_score: 0.9684; train_kl_reg_loss: 15497.9468; train_edge_recon_loss: 604506.4094; train_cat_covariates_contrastive_loss: 946576.3140; train_gene_expr_recon_loss: 1607873.2460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3174453.9146; train_optim_loss: 3174453.9146; val_kl_reg_loss: 14452.8869; val_edge_recon_loss: 621846.6671; val_cat_covariates_contrastive_loss: 946910.3765; val_gene_expr_recon_loss: 1606312.4159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3189522.3410; val_optim_loss: 3189522.3410
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9323; val_auprc_score: 0.9871; val_best_acc_score: 0.9421; val_best_f1_score: 0.9678; train_kl_reg_loss: 15299.4998; train_edge_recon_loss: 607445.5974; train_cat_covariates_contrastive_loss: 946423.0302; train_gene_expr_recon_loss: 1606220.9999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3175389.1260; train_optim_loss: 3175389.1260; val_kl_reg_loss: 14745.0878; val_edge_recon_loss: 628218.3342; val_cat_covariates_contrastive_loss: 946322.0060; val_gene_expr_recon_loss: 1607424.9977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3196710.4321; val_optim_loss: 3196710.4321
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9346; val_auprc_score: 0.9880; val_best_acc_score: 0.9418; val_best_f1_score: 0.9677; train_kl_reg_loss: 15205.7662; train_edge_recon_loss: 605231.3041; train_cat_covariates_contrastive_loss: 946397.0254; train_gene_expr_recon_loss: 1605224.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3172058.6968; train_optim_loss: 3172058.6968; val_kl_reg_loss: 14499.0660; val_edge_recon_loss: 623531.2249; val_cat_covariates_contrastive_loss: 946717.2392; val_gene_expr_recon_loss: 1602603.2604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3187350.7932; val_optim_loss: 3187350.7932
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9275; val_auprc_score: 0.9858; val_best_acc_score: 0.9406; val_best_f1_score: 0.9670; train_kl_reg_loss: 15137.5104; train_edge_recon_loss: 604380.7316; train_cat_covariates_contrastive_loss: 946293.9516; train_gene_expr_recon_loss: 1602611.2015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3168423.3938; train_optim_loss: 3168423.3938; val_kl_reg_loss: 15140.8102; val_edge_recon_loss: 636522.6215; val_cat_covariates_contrastive_loss: 945650.4298; val_gene_expr_recon_loss: 1601913.4140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3199227.2662; val_optim_loss: 3199227.2662
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9341; val_auprc_score: 0.9875; val_best_acc_score: 0.9427; val_best_f1_score: 0.9681; train_kl_reg_loss: 15065.6952; train_edge_recon_loss: 606064.3321; train_cat_covariates_contrastive_loss: 946248.8710; train_gene_expr_recon_loss: 1601537.3946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3168916.2926; train_optim_loss: 3168916.2926; val_kl_reg_loss: 14554.1945; val_edge_recon_loss: 623319.7545; val_cat_covariates_contrastive_loss: 946575.9500; val_gene_expr_recon_loss: 1600864.4657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3185314.3704; val_optim_loss: 3185314.3704
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9339; val_auprc_score: 0.9874; val_best_acc_score: 0.9421; val_best_f1_score: 0.9678; train_kl_reg_loss: 15040.7662; train_edge_recon_loss: 604967.3803; train_cat_covariates_contrastive_loss: 946268.2023; train_gene_expr_recon_loss: 1600056.9115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166333.2605; train_optim_loss: 3166333.2605; val_kl_reg_loss: 14678.1758; val_edge_recon_loss: 628822.0556; val_cat_covariates_contrastive_loss: 946098.4120; val_gene_expr_recon_loss: 1601292.0162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3190890.6528; val_optim_loss: 3190890.6528
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9347; val_auprc_score: 0.9876; val_best_acc_score: 0.9438; val_best_f1_score: 0.9688; train_kl_reg_loss: 14968.3361; train_edge_recon_loss: 604981.4571; train_cat_covariates_contrastive_loss: 946197.6658; train_gene_expr_recon_loss: 1600304.4849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166451.9427; train_optim_loss: 3166451.9427; val_kl_reg_loss: 14562.5436; val_edge_recon_loss: 623006.9444; val_cat_covariates_contrastive_loss: 946533.2936; val_gene_expr_recon_loss: 1600002.1547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3184104.9398; val_optim_loss: 3184104.9398
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9325; val_auprc_score: 0.9871; val_best_acc_score: 0.9428; val_best_f1_score: 0.9682; train_kl_reg_loss: 14979.8415; train_edge_recon_loss: 605641.7277; train_cat_covariates_contrastive_loss: 946179.0247; train_gene_expr_recon_loss: 1599297.6151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166098.2075; train_optim_loss: 3166098.2075; val_kl_reg_loss: 14442.4115; val_edge_recon_loss: 620145.5690; val_cat_covariates_contrastive_loss: 946467.5473; val_gene_expr_recon_loss: 1598549.7793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3179605.3071; val_optim_loss: 3179605.3071
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9344; val_auprc_score: 0.9877; val_best_acc_score: 0.9418; val_best_f1_score: 0.9676; train_kl_reg_loss: 14950.7917; train_edge_recon_loss: 606598.9658; train_cat_covariates_contrastive_loss: 946202.8826; train_gene_expr_recon_loss: 1597957.0895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3165709.7308; train_optim_loss: 3165709.7308; val_kl_reg_loss: 14556.9967; val_edge_recon_loss: 625240.2513; val_cat_covariates_contrastive_loss: 946212.7512; val_gene_expr_recon_loss: 1597467.5440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3183477.5394; val_optim_loss: 3183477.5394
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9343; val_auprc_score: 0.9877; val_best_acc_score: 0.9433; val_best_f1_score: 0.9685; train_kl_reg_loss: 14943.9928; train_edge_recon_loss: 604328.3257; train_cat_covariates_contrastive_loss: 946134.1841; train_gene_expr_recon_loss: 1597517.2174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3162923.7241; train_optim_loss: 3162923.7241; val_kl_reg_loss: 14755.9294; val_edge_recon_loss: 622967.0316; val_cat_covariates_contrastive_loss: 945983.4211; val_gene_expr_recon_loss: 1597381.2469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3181087.6289; val_optim_loss: 3181087.6289
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9338; val_auprc_score: 0.9874; val_best_acc_score: 0.9425; val_best_f1_score: 0.9680; train_kl_reg_loss: 14858.0370; train_edge_recon_loss: 607072.5946; train_cat_covariates_contrastive_loss: 946038.7717; train_gene_expr_recon_loss: 1598638.5796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166607.9851; train_optim_loss: 3166607.9851; val_kl_reg_loss: 14626.5771; val_edge_recon_loss: 628836.1747; val_cat_covariates_contrastive_loss: 945788.5220; val_gene_expr_recon_loss: 1600091.5941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3189342.8704; val_optim_loss: 3189342.8704
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9357; val_auprc_score: 0.9879; val_best_acc_score: 0.9433; val_best_f1_score: 0.9685; train_kl_reg_loss: 14809.1094; train_edge_recon_loss: 604603.1754; train_cat_covariates_contrastive_loss: 945992.6274; train_gene_expr_recon_loss: 1597009.9705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3162414.8822; train_optim_loss: 3162414.8822; val_kl_reg_loss: 14645.5591; val_edge_recon_loss: 618388.9542; val_cat_covariates_contrastive_loss: 946090.6971; val_gene_expr_recon_loss: 1596280.9618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3175406.1721; val_optim_loss: 3175406.1721
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9355; val_auprc_score: 0.9878; val_best_acc_score: 0.9437; val_best_f1_score: 0.9687; train_kl_reg_loss: 14795.5633; train_edge_recon_loss: 604438.8936; train_cat_covariates_contrastive_loss: 945929.5551; train_gene_expr_recon_loss: 1595756.7737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3160920.7874; train_optim_loss: 3160920.7874; val_kl_reg_loss: 14415.7081; val_edge_recon_loss: 626660.2718; val_cat_covariates_contrastive_loss: 946569.5432; val_gene_expr_recon_loss: 1596535.3191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3184180.8403; val_optim_loss: 3184180.8403
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9357; val_auprc_score: 0.9879; val_best_acc_score: 0.9431; val_best_f1_score: 0.9684; train_kl_reg_loss: 14771.9000; train_edge_recon_loss: 607152.0239; train_cat_covariates_contrastive_loss: 945909.9296; train_gene_expr_recon_loss: 1595873.5554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3163707.4116; train_optim_loss: 3163707.4116; val_kl_reg_loss: 14558.8669; val_edge_recon_loss: 622267.5442; val_cat_covariates_contrastive_loss: 946488.1009; val_gene_expr_recon_loss: 1596368.1786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3179682.6921; val_optim_loss: 3179682.6921
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9363; val_auprc_score: 0.9880; val_best_acc_score: 0.9440; val_best_f1_score: 0.9689; train_kl_reg_loss: 14759.6564; train_edge_recon_loss: 605175.0579; train_cat_covariates_contrastive_loss: 945931.0401; train_gene_expr_recon_loss: 1595293.1173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3161158.8722; train_optim_loss: 3161158.8722; val_kl_reg_loss: 14564.8711; val_edge_recon_loss: 623338.2817; val_cat_covariates_contrastive_loss: 945896.5137; val_gene_expr_recon_loss: 1596058.6748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3179858.3465; val_optim_loss: 3179858.3465
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9346; val_auprc_score: 0.9874; val_best_acc_score: 0.9435; val_best_f1_score: 0.9685; train_kl_reg_loss: 14768.4319; train_edge_recon_loss: 601192.8992; train_cat_covariates_contrastive_loss: 945903.3062; train_gene_expr_recon_loss: 1594754.5332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3156619.1682; train_optim_loss: 3156619.1682; val_kl_reg_loss: 14569.4930; val_edge_recon_loss: 631966.4850; val_cat_covariates_contrastive_loss: 945877.0891; val_gene_expr_recon_loss: 1596451.8221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3188864.8889; val_optim_loss: 3188864.8889

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9351; val_auprc_score: 0.9877; val_best_acc_score: 0.9436; val_best_f1_score: 0.9686; train_kl_reg_loss: 14726.2308; train_edge_recon_loss: 605251.4374; train_cat_covariates_contrastive_loss: 945839.2547; train_gene_expr_recon_loss: 1591940.2192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3157757.1443; train_optim_loss: 3157757.1443; val_kl_reg_loss: 14514.9160; val_edge_recon_loss: 623765.6332; val_cat_covariates_contrastive_loss: 945790.9246; val_gene_expr_recon_loss: 1592719.6073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3176791.0849; val_optim_loss: 3176791.0849
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.9347; val_auprc_score: 0.9880; val_best_acc_score: 0.9432; val_best_f1_score: 0.9685; train_kl_reg_loss: 14778.2600; train_edge_recon_loss: 602617.1148; train_cat_covariates_contrastive_loss: 945845.0167; train_gene_expr_recon_loss: 1591495.0622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3154735.4521; train_optim_loss: 3154735.4521; val_kl_reg_loss: 14551.4684; val_edge_recon_loss: 619295.6653; val_cat_covariates_contrastive_loss: 946278.1682; val_gene_expr_recon_loss: 1592581.9981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3172707.3017; val_optim_loss: 3172707.3017
Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9336; val_auprc_score: 0.9874; val_best_acc_score: 0.9438; val_best_f1_score: 0.9687; train_kl_reg_loss: 14800.7797; train_edge_recon_loss: 605243.2355; train_cat_covariates_contrastive_loss: 945825.3734; train_gene_expr_recon_loss: 1591673.0402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3157542.4297; train_optim_loss: 3157542.4297; val_kl_reg_loss: 14584.2293; val_edge_recon_loss: 623357.7641; val_cat_covariates_contrastive_loss: 945987.4306; val_gene_expr_recon_loss: 1590790.6034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3174720.0216; val_optim_loss: 3174720.0216
Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.9352; val_auprc_score: 0.9877; val_best_acc_score: 0.9433; val_best_f1_score: 0.9686; train_kl_reg_loss: 14810.0059; train_edge_recon_loss: 604743.3430; train_cat_covariates_contrastive_loss: 945855.2153; train_gene_expr_recon_loss: 1591502.8641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3156911.4294; train_optim_loss: 3156911.4294; val_kl_reg_loss: 14538.2333; val_edge_recon_loss: 622106.5858; val_cat_covariates_contrastive_loss: 945910.5679; val_gene_expr_recon_loss: 1592356.0451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3174911.4344; val_optim_loss: 3174911.4344
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.9364; val_auprc_score: 0.9879; val_best_acc_score: 0.9438; val_best_f1_score: 0.9687; train_kl_reg_loss: 14757.6176; train_edge_recon_loss: 603963.3856; train_cat_covariates_contrastive_loss: 945826.3983; train_gene_expr_recon_loss: 1591501.9485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3156049.3514; train_optim_loss: 3156049.3514; val_kl_reg_loss: 14502.4068; val_edge_recon_loss: 623112.3848; val_cat_covariates_contrastive_loss: 945849.2566; val_gene_expr_recon_loss: 1590629.2434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3174093.2886; val_optim_loss: 3174093.2886
Epoch 70/400 |███-----------------| 17.5% val_auroc_score: 0.9359; val_auprc_score: 0.9878; val_best_acc_score: 0.9438; val_best_f1_score: 0.9687; train_kl_reg_loss: 14714.2743; train_edge_recon_loss: 603924.3554; train_cat_covariates_contrastive_loss: 945829.3167; train_gene_expr_recon_loss: 1591254.4287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3155722.3758; train_optim_loss: 3155722.3758; val_kl_reg_loss: 14589.2159; val_edge_recon_loss: 625262.7207; val_cat_covariates_contrastive_loss: 945764.8005; val_gene_expr_recon_loss: 1593974.4850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3179591.2145; val_optim_loss: 3179591.2145

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 71/400 |███-----------------| 17.8% val_auroc_score: 0.9334; val_auprc_score: 0.9872; val_best_acc_score: 0.9434; val_best_f1_score: 0.9685; train_kl_reg_loss: 14752.0946; train_edge_recon_loss: 603841.8821; train_cat_covariates_contrastive_loss: 945825.1627; train_gene_expr_recon_loss: 1591187.2084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3155606.3465; train_optim_loss: 3155606.3465; val_kl_reg_loss: 14565.6481; val_edge_recon_loss: 625899.7664; val_cat_covariates_contrastive_loss: 945886.4574; val_gene_expr_recon_loss: 1591797.9691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3178149.8372; val_optim_loss: 3178149.8372
Epoch 72/400 |███-----------------| 18.0% val_auroc_score: 0.9339; val_auprc_score: 0.9874; val_best_acc_score: 0.9432; val_best_f1_score: 0.9684; train_kl_reg_loss: 14760.3650; train_edge_recon_loss: 603723.2537; train_cat_covariates_contrastive_loss: 945856.0823; train_gene_expr_recon_loss: 1590971.2936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3155310.9966; train_optim_loss: 3155310.9966; val_kl_reg_loss: 14594.1096; val_edge_recon_loss: 626996.0010; val_cat_covariates_contrastive_loss: 945931.5540; val_gene_expr_recon_loss: 1591358.4992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3178880.1674; val_optim_loss: 3178880.1674
Epoch 73/400 |███-----------------| 18.2% val_auroc_score: 0.9348; val_auprc_score: 0.9876; val_best_acc_score: 0.9439; val_best_f1_score: 0.9688; train_kl_reg_loss: 14757.2097; train_edge_recon_loss: 605370.7109; train_cat_covariates_contrastive_loss: 945708.6006; train_gene_expr_recon_loss: 1591408.3745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3157244.8953; train_optim_loss: 3157244.8953; val_kl_reg_loss: 14600.2255; val_edge_recon_loss: 625353.6993; val_cat_covariates_contrastive_loss: 945802.8611; val_gene_expr_recon_loss: 1592148.4579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3177905.2438; val_optim_loss: 3177905.2438
Epoch 74/400 |███-----------------| 18.5% val_auroc_score: 0.9368; val_auprc_score: 0.9882; val_best_acc_score: 0.9439; val_best_f1_score: 0.9688; train_kl_reg_loss: 14741.0212; train_edge_recon_loss: 604730.8879; train_cat_covariates_contrastive_loss: 945799.5141; train_gene_expr_recon_loss: 1590987.1882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3156258.6101; train_optim_loss: 3156258.6101; val_kl_reg_loss: 14590.0512; val_edge_recon_loss: 623173.9830; val_cat_covariates_contrastive_loss: 945864.6530; val_gene_expr_recon_loss: 1592524.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3176153.0193; val_optim_loss: 3176153.0193

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1234 min 44 sec.
Using best model state, which was in epoch 66.

--- MODEL EVALUATION ---
val AUROC score: 0.9254
val AUPRC score: 0.9836
val best accuracy score: 0.9426
val best F1 score: 0.9681
val target rna MSE score: 0.1928
val source rna MSE score: 0.1750
Val cat covariate0 mean sim diff: -0.0007
Val cat covariate1 mean sim diff: -0.0585
Val cat covariate2 mean sim diff: 0.0002

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
