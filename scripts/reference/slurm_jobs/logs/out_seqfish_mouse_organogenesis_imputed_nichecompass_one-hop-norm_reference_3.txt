Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9573; val_auprc_score: 0.9902; val_best_acc_score: 0.9474; val_best_f1_score: 0.9697; train_kl_reg_loss: 8920.4475; train_edge_recon_loss: 79274.0009; train_gene_expr_recon_loss: 1406955.4166; train_masked_gp_l1_reg_loss: 7290.9052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3857.6735; train_global_loss: 1506298.4445; train_optim_loss: 1506298.4445; val_kl_reg_loss: 8901.1269; val_edge_recon_loss: 78119.7320; val_gene_expr_recon_loss: 1407373.1328; val_masked_gp_l1_reg_loss: 7289.7529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3841.0938; val_global_loss: 1505524.8542; val_optim_loss: 1505524.8542
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9548; val_auprc_score: 0.9898; val_best_acc_score: 0.9473; val_best_f1_score: 0.9696; train_kl_reg_loss: 8920.0166; train_edge_recon_loss: 79202.4088; train_gene_expr_recon_loss: 1407092.6765; train_masked_gp_l1_reg_loss: 7291.5529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3825.6749; train_global_loss: 1506332.3352; train_optim_loss: 1506332.3352; val_kl_reg_loss: 8917.7701; val_edge_recon_loss: 79451.9889; val_gene_expr_recon_loss: 1407539.2266; val_masked_gp_l1_reg_loss: 7292.7090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3810.8923; val_global_loss: 1507012.6328; val_optim_loss: 1507012.6328
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9570; val_auprc_score: 0.9908; val_best_acc_score: 0.9466; val_best_f1_score: 0.9693; train_kl_reg_loss: 8956.0066; train_edge_recon_loss: 80201.8835; train_gene_expr_recon_loss: 1406883.2401; train_masked_gp_l1_reg_loss: 7295.4315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3796.6922; train_global_loss: 1507133.2526; train_optim_loss: 1507133.2526; val_kl_reg_loss: 8959.5707; val_edge_recon_loss: 78809.8075; val_gene_expr_recon_loss: 1408028.1927; val_masked_gp_l1_reg_loss: 7297.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3783.5742; val_global_loss: 1506879.1979; val_optim_loss: 1506879.1979
[True]
Run timestamp: 02082023_013111_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '5', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8672; val_auprc_score: 0.9730; val_best_acc_score: 0.8703; val_best_f1_score: 0.9278; train_kl_reg_loss: 39951.6325; train_edge_recon_loss: 113336.7434; train_gene_expr_recon_loss: 2393524.7440; train_masked_gp_l1_reg_loss: 9981.5740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36593.7098; train_global_loss: 2593388.4092; train_optim_loss: 2593388.4092; val_kl_reg_loss: 28304.1748; val_edge_recon_loss: 108761.2047; val_gene_expr_recon_loss: 2014257.7890; val_masked_gp_l1_reg_loss: 11693.1143; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28127.3242; val_global_loss: 2191143.4247; val_optim_loss: 2191143.4247
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9547; val_auprc_score: 0.9892; val_best_acc_score: 0.9456; val_best_f1_score: 0.9686; train_kl_reg_loss: 8960.8379; train_edge_recon_loss: 79319.4658; train_gene_expr_recon_loss: 1406956.4456; train_masked_gp_l1_reg_loss: 7299.8673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3769.0511; train_global_loss: 1506305.6654; train_optim_loss: 1506305.6654; val_kl_reg_loss: 9009.3938; val_edge_recon_loss: 81448.0964; val_gene_expr_recon_loss: 1407213.2161; val_masked_gp_l1_reg_loss: 7301.5698; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3755.0093; val_global_loss: 1508727.3229; val_optim_loss: 1508727.3229
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9598; val_auprc_score: 0.9908; val_best_acc_score: 0.9463; val_best_f1_score: 0.9689; train_kl_reg_loss: 8992.9410; train_edge_recon_loss: 80582.1063; train_gene_expr_recon_loss: 1406839.5233; train_masked_gp_l1_reg_loss: 7303.1878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3741.3434; train_global_loss: 1507459.1012; train_optim_loss: 1507459.1012; val_kl_reg_loss: 9038.9115; val_edge_recon_loss: 81131.7612; val_gene_expr_recon_loss: 1408310.6068; val_masked_gp_l1_reg_loss: 7307.9199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3730.3999; val_global_loss: 1509519.5286; val_optim_loss: 1509519.5286
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9096; val_auprc_score: 0.9812; val_best_acc_score: 0.9030; val_best_f1_score: 0.9448; train_kl_reg_loss: 25077.8424; train_edge_recon_loss: 102340.1076; train_gene_expr_recon_loss: 1913362.3799; train_masked_gp_l1_reg_loss: 13266.3034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23738.4870; train_global_loss: 2077785.1162; train_optim_loss: 2077785.1162; val_kl_reg_loss: 22804.7193; val_edge_recon_loss: 99349.9016; val_gene_expr_recon_loss: 1824369.8911; val_masked_gp_l1_reg_loss: 14547.6416; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20105.7383; val_global_loss: 1981177.8938; val_optim_loss: 1981177.8938

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9567; val_auprc_score: 0.9902; val_best_acc_score: 0.9470; val_best_f1_score: 0.9695; train_kl_reg_loss: 8976.9961; train_edge_recon_loss: 79420.4121; train_gene_expr_recon_loss: 1406613.0177; train_masked_gp_l1_reg_loss: 7275.7756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3722.1539; train_global_loss: 1506008.3578; train_optim_loss: 1506008.3578; val_kl_reg_loss: 8995.9739; val_edge_recon_loss: 79226.7822; val_gene_expr_recon_loss: 1406071.7344; val_masked_gp_l1_reg_loss: 7271.3389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3718.9771; val_global_loss: 1505284.8698; val_optim_loss: 1505284.8698
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9252; val_auprc_score: 0.9843; val_best_acc_score: 0.9222; val_best_f1_score: 0.9557; train_kl_reg_loss: 20579.9652; train_edge_recon_loss: 97005.0025; train_gene_expr_recon_loss: 1763921.5115; train_masked_gp_l1_reg_loss: 15306.0629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17740.8220; train_global_loss: 1914553.3645; train_optim_loss: 1914553.3645; val_kl_reg_loss: 18332.4523; val_edge_recon_loss: 91937.7322; val_gene_expr_recon_loss: 1706303.3978; val_masked_gp_l1_reg_loss: 15767.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15844.0996; val_global_loss: 1848185.7110; val_optim_loss: 1848185.7110
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9591; val_auprc_score: 0.9907; val_best_acc_score: 0.9484; val_best_f1_score: 0.9702; train_kl_reg_loss: 8977.7610; train_edge_recon_loss: 79654.2226; train_gene_expr_recon_loss: 1406594.5084; train_masked_gp_l1_reg_loss: 7270.7818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3717.0290; train_global_loss: 1506214.3032; train_optim_loss: 1506214.3032; val_kl_reg_loss: 8965.3604; val_edge_recon_loss: 79942.5736; val_gene_expr_recon_loss: 1407105.4401; val_masked_gp_l1_reg_loss: 7270.7139; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3715.0120; val_global_loss: 1506999.1146; val_optim_loss: 1506999.1146
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9633; val_auprc_score: 0.9922; val_best_acc_score: 0.9511; val_best_f1_score: 0.9719; train_kl_reg_loss: 8982.5180; train_edge_recon_loss: 79695.9096; train_gene_expr_recon_loss: 1406458.6843; train_masked_gp_l1_reg_loss: 7270.7362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3713.1917; train_global_loss: 1506121.0337; train_optim_loss: 1506121.0337; val_kl_reg_loss: 8979.8665; val_edge_recon_loss: 77844.8232; val_gene_expr_recon_loss: 1406853.8151; val_masked_gp_l1_reg_loss: 7270.9248; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3711.3789; val_global_loss: 1504660.7630; val_optim_loss: 1504660.7630
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9375; val_auprc_score: 0.9866; val_best_acc_score: 0.9258; val_best_f1_score: 0.9575; train_kl_reg_loss: 16380.0949; train_edge_recon_loss: 91940.2761; train_gene_expr_recon_loss: 1664150.3027; train_masked_gp_l1_reg_loss: 15423.0726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14490.4870; train_global_loss: 1802384.2315; train_optim_loss: 1802384.2315; val_kl_reg_loss: 14604.0252; val_edge_recon_loss: 89453.4648; val_gene_expr_recon_loss: 1626570.8790; val_masked_gp_l1_reg_loss: 14603.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13305.7207; val_global_loss: 1758537.3656; val_optim_loss: 1758537.3656
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9590; val_auprc_score: 0.9914; val_best_acc_score: 0.9478; val_best_f1_score: 0.9698; train_kl_reg_loss: 8984.1415; train_edge_recon_loss: 79754.3710; train_gene_expr_recon_loss: 1406691.6166; train_masked_gp_l1_reg_loss: 7271.1897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3709.7717; train_global_loss: 1506411.0892; train_optim_loss: 1506411.0892; val_kl_reg_loss: 8982.5202; val_edge_recon_loss: 79353.5203; val_gene_expr_recon_loss: 1407232.3750; val_masked_gp_l1_reg_loss: 7271.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3708.0737; val_global_loss: 1506548.0339; val_optim_loss: 1506548.0339
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9449; val_auprc_score: 0.9874; val_best_acc_score: 0.9325; val_best_f1_score: 0.9612; train_kl_reg_loss: 12791.9350; train_edge_recon_loss: 87090.8770; train_gene_expr_recon_loss: 1595980.9928; train_masked_gp_l1_reg_loss: 13165.3700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12279.8198; train_global_loss: 1721308.9961; train_optim_loss: 1721308.9961; val_kl_reg_loss: 11575.5284; val_edge_recon_loss: 84030.1169; val_gene_expr_recon_loss: 1568500.8978; val_masked_gp_l1_reg_loss: 11723.3213; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11267.2510; val_global_loss: 1687097.1667; val_optim_loss: 1687097.1667
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9630; val_auprc_score: 0.9919; val_best_acc_score: 0.9483; val_best_f1_score: 0.9702; train_kl_reg_loss: 8980.3901; train_edge_recon_loss: 79667.6584; train_gene_expr_recon_loss: 1406510.0564; train_masked_gp_l1_reg_loss: 7271.8369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3706.4819; train_global_loss: 1506136.4198; train_optim_loss: 1506136.4198; val_kl_reg_loss: 9014.0849; val_edge_recon_loss: 78897.9403; val_gene_expr_recon_loss: 1407122.0078; val_masked_gp_l1_reg_loss: 7272.3608; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3704.8635; val_global_loss: 1506011.2865; val_optim_loss: 1506011.2865
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9439; val_auprc_score: 0.9868; val_best_acc_score: 0.9348; val_best_f1_score: 0.9623; train_kl_reg_loss: 10804.2215; train_edge_recon_loss: 84189.5664; train_gene_expr_recon_loss: 1546715.8529; train_masked_gp_l1_reg_loss: 10678.5709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10273.3190; train_global_loss: 1662661.5291; train_optim_loss: 1662661.5291; val_kl_reg_loss: 10318.2102; val_edge_recon_loss: 85854.5881; val_gene_expr_recon_loss: 1526186.5040; val_masked_gp_l1_reg_loss: 9860.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9328.4316; val_global_loss: 1641548.4288; val_optim_loss: 1641548.4288
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9559; val_auprc_score: 0.9902; val_best_acc_score: 0.9467; val_best_f1_score: 0.9693; train_kl_reg_loss: 8976.6594; train_edge_recon_loss: 79942.8027; train_gene_expr_recon_loss: 1406487.9823; train_masked_gp_l1_reg_loss: 7272.7174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3703.2511; train_global_loss: 1506383.4142; train_optim_loss: 1506383.4142; val_kl_reg_loss: 8961.0090; val_edge_recon_loss: 78026.5697; val_gene_expr_recon_loss: 1406287.0833; val_masked_gp_l1_reg_loss: 7272.7925; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3701.5742; val_global_loss: 1504249.0312; val_optim_loss: 1504249.0312
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9568; val_auprc_score: 0.9900; val_best_acc_score: 0.9449; val_best_f1_score: 0.9681; train_kl_reg_loss: 8991.1573; train_edge_recon_loss: 80201.4510; train_gene_expr_recon_loss: 1406589.9747; train_masked_gp_l1_reg_loss: 7273.1333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3699.8520; train_global_loss: 1506755.5767; train_optim_loss: 1506755.5767; val_kl_reg_loss: 9037.9203; val_edge_recon_loss: 82679.5354; val_gene_expr_recon_loss: 1407732.2526; val_masked_gp_l1_reg_loss: 7273.4380; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3698.2886; val_global_loss: 1510421.4609; val_optim_loss: 1510421.4609
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9533; val_auprc_score: 0.9898; val_best_acc_score: 0.9388; val_best_f1_score: 0.9647; train_kl_reg_loss: 9876.7134; train_edge_recon_loss: 83155.4204; train_gene_expr_recon_loss: 1511011.0136; train_masked_gp_l1_reg_loss: 9391.4401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8558.3765; train_global_loss: 1621992.9639; train_optim_loss: 1621992.9639; val_kl_reg_loss: 9540.1756; val_edge_recon_loss: 82221.3032; val_gene_expr_recon_loss: 1495835.2124; val_masked_gp_l1_reg_loss: 9012.8262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7897.2046; val_global_loss: 1604506.8105; val_optim_loss: 1604506.8105
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9573; val_auprc_score: 0.9901; val_best_acc_score: 0.9465; val_best_f1_score: 0.9690; train_kl_reg_loss: 8990.1978; train_edge_recon_loss: 79677.5129; train_gene_expr_recon_loss: 1406629.1363; train_masked_gp_l1_reg_loss: 7273.7671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3696.7884; train_global_loss: 1506267.4081; train_optim_loss: 1506267.4081; val_kl_reg_loss: 8970.6968; val_edge_recon_loss: 81223.8359; val_gene_expr_recon_loss: 1407041.1667; val_masked_gp_l1_reg_loss: 7273.9736; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3694.9009; val_global_loss: 1508204.5703; val_optim_loss: 1508204.5703
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9527; val_auprc_score: 0.9887; val_best_acc_score: 0.9392; val_best_f1_score: 0.9648; train_kl_reg_loss: 9374.7656; train_edge_recon_loss: 82087.0572; train_gene_expr_recon_loss: 1484946.2584; train_masked_gp_l1_reg_loss: 8804.8945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7477.4254; train_global_loss: 1592690.4013; train_optim_loss: 1592690.4013; val_kl_reg_loss: 9449.9206; val_edge_recon_loss: 83076.0081; val_gene_expr_recon_loss: 1475946.7742; val_masked_gp_l1_reg_loss: 8620.3330; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7156.9814; val_global_loss: 1584250.0820; val_optim_loss: 1584250.0820
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9580; val_auprc_score: 0.9909; val_best_acc_score: 0.9458; val_best_f1_score: 0.9687; train_kl_reg_loss: 8991.9818; train_edge_recon_loss: 80232.7405; train_gene_expr_recon_loss: 1406679.6515; train_masked_gp_l1_reg_loss: 7274.2450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3693.4017; train_global_loss: 1506872.0148; train_optim_loss: 1506872.0148; val_kl_reg_loss: 9015.1460; val_edge_recon_loss: 80904.8000; val_gene_expr_recon_loss: 1407688.8828; val_masked_gp_l1_reg_loss: 7274.8740; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3692.1631; val_global_loss: 1508575.8359; val_optim_loss: 1508575.8359
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9584; val_auprc_score: 0.9911; val_best_acc_score: 0.9447; val_best_f1_score: 0.9680; train_kl_reg_loss: 8996.3048; train_edge_recon_loss: 79517.3303; train_gene_expr_recon_loss: 1406511.1023; train_masked_gp_l1_reg_loss: 7275.0479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3690.5634; train_global_loss: 1505990.3555; train_optim_loss: 1505990.3555; val_kl_reg_loss: 8972.0659; val_edge_recon_loss: 80094.1501; val_gene_expr_recon_loss: 1406348.3594; val_masked_gp_l1_reg_loss: 7275.4482; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3688.8521; val_global_loss: 1506378.9479; val_optim_loss: 1506378.9479
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9556; val_auprc_score: 0.9893; val_best_acc_score: 0.9435; val_best_f1_score: 0.9672; train_kl_reg_loss: 9124.4919; train_edge_recon_loss: 80977.7584; train_gene_expr_recon_loss: 1466371.9734; train_masked_gp_l1_reg_loss: 8492.7822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6963.7174; train_global_loss: 1571930.7243; train_optim_loss: 1571930.7243; val_kl_reg_loss: 8954.4091; val_edge_recon_loss: 82193.7363; val_gene_expr_recon_loss: 1457602.6263; val_masked_gp_l1_reg_loss: 8368.2510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6789.1904; val_global_loss: 1563908.2769; val_optim_loss: 1563908.2769

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9593; val_auprc_score: 0.9908; val_best_acc_score: 0.9491; val_best_f1_score: 0.9705; train_kl_reg_loss: 9002.9165; train_edge_recon_loss: 79236.2121; train_gene_expr_recon_loss: 1406448.5140; train_masked_gp_l1_reg_loss: 7271.7802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3688.0852; train_global_loss: 1505647.5148; train_optim_loss: 1505647.5148; val_kl_reg_loss: 8970.2979; val_edge_recon_loss: 79229.2665; val_gene_expr_recon_loss: 1406785.4818; val_masked_gp_l1_reg_loss: 7271.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3687.8193; val_global_loss: 1505943.9740; val_optim_loss: 1505943.9740
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9593; val_auprc_score: 0.9913; val_best_acc_score: 0.9468; val_best_f1_score: 0.9693; train_kl_reg_loss: 8975.9924; train_edge_recon_loss: 81358.4642; train_gene_expr_recon_loss: 1453698.0007; train_masked_gp_l1_reg_loss: 8252.4188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6616.0115; train_global_loss: 1558900.8861; train_optim_loss: 1558900.8861; val_kl_reg_loss: 8896.6476; val_edge_recon_loss: 79787.0321; val_gene_expr_recon_loss: 1447604.1788; val_masked_gp_l1_reg_loss: 8098.3076; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6428.5107; val_global_loss: 1550814.6022; val_optim_loss: 1550814.6022
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9564; val_auprc_score: 0.9899; val_best_acc_score: 0.9464; val_best_f1_score: 0.9692; train_kl_reg_loss: 8990.2684; train_edge_recon_loss: 79478.7950; train_gene_expr_recon_loss: 1406551.3154; train_masked_gp_l1_reg_loss: 7270.9254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3687.6187; train_global_loss: 1505978.9297; train_optim_loss: 1505978.9297; val_kl_reg_loss: 8991.8195; val_edge_recon_loss: 78482.4368; val_gene_expr_recon_loss: 1406945.3151; val_masked_gp_l1_reg_loss: 7270.8652; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3687.4346; val_global_loss: 1505377.8229; val_optim_loss: 1505377.8229
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9573; val_auprc_score: 0.9909; val_best_acc_score: 0.9446; val_best_f1_score: 0.9681; train_kl_reg_loss: 8985.1092; train_edge_recon_loss: 80958.4073; train_gene_expr_recon_loss: 1406322.2122; train_masked_gp_l1_reg_loss: 7270.8443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3687.2512; train_global_loss: 1507223.8523; train_optim_loss: 1507223.8523; val_kl_reg_loss: 9038.9896; val_edge_recon_loss: 79020.4424; val_gene_expr_recon_loss: 1407555.3984; val_masked_gp_l1_reg_loss: 7270.8291; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3687.0261; val_global_loss: 1506572.7057; val_optim_loss: 1506572.7057
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9569; val_auprc_score: 0.9903; val_best_acc_score: 0.9455; val_best_f1_score: 0.9686; train_kl_reg_loss: 8881.1749; train_edge_recon_loss: 80624.2557; train_gene_expr_recon_loss: 1445658.2479; train_masked_gp_l1_reg_loss: 8030.4574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6258.8016; train_global_loss: 1549452.9421; train_optim_loss: 1549452.9421; val_kl_reg_loss: 8816.6413; val_edge_recon_loss: 79661.3824; val_gene_expr_recon_loss: 1441227.4368; val_masked_gp_l1_reg_loss: 7924.5220; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6081.8896; val_global_loss: 1543711.8347; val_optim_loss: 1543711.8347
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9553; val_auprc_score: 0.9901; val_best_acc_score: 0.9450; val_best_f1_score: 0.9684; train_kl_reg_loss: 8991.0939; train_edge_recon_loss: 79992.0516; train_gene_expr_recon_loss: 1406519.1698; train_masked_gp_l1_reg_loss: 7270.8346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3686.8670; train_global_loss: 1506460.0494; train_optim_loss: 1506460.0494; val_kl_reg_loss: 8995.2493; val_edge_recon_loss: 79682.6722; val_gene_expr_recon_loss: 1407486.4844; val_masked_gp_l1_reg_loss: 7270.8257; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3686.6973; val_global_loss: 1507122.0260; val_optim_loss: 1507122.0260
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9584; val_auprc_score: 0.9899; val_best_acc_score: 0.9467; val_best_f1_score: 0.9692; train_kl_reg_loss: 8804.1906; train_edge_recon_loss: 80593.3522; train_gene_expr_recon_loss: 1440163.8935; train_masked_gp_l1_reg_loss: 7869.3567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5944.8437; train_global_loss: 1543375.6355; train_optim_loss: 1543375.6355; val_kl_reg_loss: 8731.7159; val_edge_recon_loss: 81432.0119; val_gene_expr_recon_loss: 1439781.5323; val_masked_gp_l1_reg_loss: 7797.2319; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5823.4907; val_global_loss: 1543566.0108; val_optim_loss: 1543566.0108

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 186 min 3 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9624
val AUPRC score: 0.9921
val best accuracy score: 0.9476
val best F1 score: 0.9696
val target rna MSE score: 0.8089
val source rna MSE score: 0.4700
Val cat covariate0 mean sim diff: -0.0007

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9577; val_auprc_score: 0.9905; val_best_acc_score: 0.9444; val_best_f1_score: 0.9679; train_kl_reg_loss: 8751.1600; train_edge_recon_loss: 80521.5777; train_gene_expr_recon_loss: 1435945.4205; train_masked_gp_l1_reg_loss: 7743.3059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5712.7426; train_global_loss: 1538674.2079; train_optim_loss: 1538674.2079; val_kl_reg_loss: 8836.9528; val_edge_recon_loss: 81987.2575; val_gene_expr_recon_loss: 1435421.0739; val_masked_gp_l1_reg_loss: 7710.0801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5624.2236; val_global_loss: 1539579.6613; val_optim_loss: 1539579.6613
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9581; val_auprc_score: 0.9901; val_best_acc_score: 0.9472; val_best_f1_score: 0.9694; train_kl_reg_loss: 8715.3177; train_edge_recon_loss: 80553.3103; train_gene_expr_recon_loss: 1433250.7361; train_masked_gp_l1_reg_loss: 7676.0103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5548.0634; train_global_loss: 1535743.4358; train_optim_loss: 1535743.4358; val_kl_reg_loss: 8560.2044; val_edge_recon_loss: 80462.3427; val_gene_expr_recon_loss: 1430930.2755; val_masked_gp_l1_reg_loss: 7636.3154; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5463.7212; val_global_loss: 1533052.9462; val_optim_loss: 1533052.9462
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9007; val_auprc_score: 0.9788; val_best_acc_score: 0.9032; val_best_f1_score: 0.9449; train_kl_reg_loss: 8758.6838; train_edge_recon_loss: 82198.6154; train_gene_expr_recon_loss: 1449992.8714; train_masked_gp_l1_reg_loss: 7802.4712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5420.2490; train_global_loss: 1554172.8941; train_optim_loss: 1554172.8941; val_kl_reg_loss: 7088.4598; val_edge_recon_loss: 101028.0172; val_gene_expr_recon_loss: 1652367.7272; val_masked_gp_l1_reg_loss: 11143.0137; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6057.5493; val_global_loss: 1777684.7043; val_optim_loss: 1777684.7043
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9384; val_auprc_score: 0.9866; val_best_acc_score: 0.9299; val_best_f1_score: 0.9596; train_kl_reg_loss: 8210.7409; train_edge_recon_loss: 82894.2187; train_gene_expr_recon_loss: 1476432.9510; train_masked_gp_l1_reg_loss: 8912.9812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6108.8640; train_global_loss: 1582559.7590; train_optim_loss: 1582559.7590; val_kl_reg_loss: 7957.6744; val_edge_recon_loss: 81852.3054; val_gene_expr_recon_loss: 1453652.9677; val_masked_gp_l1_reg_loss: 8194.9248; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5989.2275; val_global_loss: 1557647.0820; val_optim_loss: 1557647.0820
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9444; val_auprc_score: 0.9875; val_best_acc_score: 0.9356; val_best_f1_score: 0.9630; train_kl_reg_loss: 8033.9370; train_edge_recon_loss: 81019.9183; train_gene_expr_recon_loss: 1450564.8910; train_masked_gp_l1_reg_loss: 7957.9773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5834.5023; train_global_loss: 1553411.2257; train_optim_loss: 1553411.2257; val_kl_reg_loss: 8034.1683; val_edge_recon_loss: 80169.6771; val_gene_expr_recon_loss: 1445677.2849; val_masked_gp_l1_reg_loss: 7790.3296; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5655.5029; val_global_loss: 1547327.0081; val_optim_loss: 1547327.0081
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9427; val_auprc_score: 0.9875; val_best_acc_score: 0.9359; val_best_f1_score: 0.9631; train_kl_reg_loss: 8078.3757; train_edge_recon_loss: 80644.3361; train_gene_expr_recon_loss: 1445085.5242; train_masked_gp_l1_reg_loss: 7662.3549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5487.1082; train_global_loss: 1546957.7036; train_optim_loss: 1546957.7036; val_kl_reg_loss: 7963.5574; val_edge_recon_loss: 80557.8881; val_gene_expr_recon_loss: 1443031.1640; val_masked_gp_l1_reg_loss: 7552.0063; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5323.7427; val_global_loss: 1544428.3575; val_optim_loss: 1544428.3575

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9500; val_auprc_score: 0.9895; val_best_acc_score: 0.9408; val_best_f1_score: 0.9661; train_kl_reg_loss: 8059.4565; train_edge_recon_loss: 81272.3621; train_gene_expr_recon_loss: 1441469.6090; train_masked_gp_l1_reg_loss: 7249.3264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5231.1216; train_global_loss: 1543281.8725; train_optim_loss: 1543281.8725; val_kl_reg_loss: 8010.7891; val_edge_recon_loss: 78469.6415; val_gene_expr_recon_loss: 1440268.0188; val_masked_gp_l1_reg_loss: 7212.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5193.4058; val_global_loss: 1539154.4516; val_optim_loss: 1539154.4516
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9463; val_auprc_score: 0.9886; val_best_acc_score: 0.9387; val_best_f1_score: 0.9647; train_kl_reg_loss: 8110.9249; train_edge_recon_loss: 80907.7157; train_gene_expr_recon_loss: 1441025.8516; train_masked_gp_l1_reg_loss: 7192.1875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5157.7803; train_global_loss: 1542394.4595; train_optim_loss: 1542394.4595; val_kl_reg_loss: 8097.4959; val_edge_recon_loss: 78815.7309; val_gene_expr_recon_loss: 1439231.0430; val_masked_gp_l1_reg_loss: 7171.3184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5123.5273; val_global_loss: 1538439.1411; val_optim_loss: 1538439.1411
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9463; val_auprc_score: 0.9880; val_best_acc_score: 0.9387; val_best_f1_score: 0.9647; train_kl_reg_loss: 8143.1549; train_edge_recon_loss: 80591.6712; train_gene_expr_recon_loss: 1440589.3063; train_masked_gp_l1_reg_loss: 7152.0214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5087.5238; train_global_loss: 1541563.6807; train_optim_loss: 1541563.6807; val_kl_reg_loss: 8149.1171; val_edge_recon_loss: 79802.1286; val_gene_expr_recon_loss: 1439089.5981; val_masked_gp_l1_reg_loss: 7129.6318; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5049.2095; val_global_loss: 1539219.7164; val_optim_loss: 1539219.7164
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9456; val_auprc_score: 0.9881; val_best_acc_score: 0.9377; val_best_f1_score: 0.9642; train_kl_reg_loss: 8189.7080; train_edge_recon_loss: 80708.5832; train_gene_expr_recon_loss: 1440069.0715; train_masked_gp_l1_reg_loss: 7107.9015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5017.3576; train_global_loss: 1541092.6235; train_optim_loss: 1541092.6235; val_kl_reg_loss: 8212.1722; val_edge_recon_loss: 79341.4100; val_gene_expr_recon_loss: 1439822.0739; val_masked_gp_l1_reg_loss: 7080.7881; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4980.5171; val_global_loss: 1539436.9113; val_optim_loss: 1539436.9113

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 116 min 54 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
val AUROC score: 0.9616
val AUPRC score: 0.9913
val best accuracy score: 0.9462
val best F1 score: 0.9688
val target rna MSE score: 1.0000
val source rna MSE score: 0.5072
Val cat covariate0 mean sim diff: -0.0033

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
