[True]
Run timestamp: 10102023_101022_227.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_227']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7164; val_auprc_score: 0.7016; val_best_acc_score: 0.5003; val_best_f1_score: 0.6667; train_kl_reg_loss: 59978.4917; train_edge_recon_loss: 743649.1259; train_gene_expr_recon_loss: 23057235.3333; train_masked_gp_l1_reg_loss: 42223.5142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3951341.3409; train_chrom_access_recon_loss: 2976898.6136; train_global_loss: 30831326.7273; train_optim_loss: 30831326.7273; val_kl_reg_loss: 64672.9302; val_edge_recon_loss: 813048.5625; val_gene_expr_recon_loss: 21276563.0000; val_masked_gp_l1_reg_loss: 48218.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2567880.0000; val_chrom_access_recon_loss: 2839363.8438; val_global_loss: 27609745.7500; val_optim_loss: 27609745.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7080; val_auprc_score: 0.6861; val_best_acc_score: 0.5986; val_best_f1_score: 0.7024; train_kl_reg_loss: 74878.6997; train_edge_recon_loss: 742619.2206; train_gene_expr_recon_loss: 21338672.9697; train_masked_gp_l1_reg_loss: 50213.8736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1627714.6638; train_chrom_access_recon_loss: 2840982.8864; train_global_loss: 26675082.3030; train_optim_loss: 26675082.3030; val_kl_reg_loss: 71563.5928; val_edge_recon_loss: 811866.2734; val_gene_expr_recon_loss: 20948413.0000; val_masked_gp_l1_reg_loss: 50672.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 938153.8750; val_chrom_access_recon_loss: 2776912.1250; val_global_loss: 25597581.5000; val_optim_loss: 25597581.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7569; val_auprc_score: 0.7352; val_best_acc_score: 0.6854; val_best_f1_score: 0.7109; train_kl_reg_loss: 71902.4403; train_edge_recon_loss: 734917.9157; train_gene_expr_recon_loss: 21064940.7273; train_masked_gp_l1_reg_loss: 51234.0387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 639577.5758; train_chrom_access_recon_loss: 2818862.1818; train_global_loss: 25381434.7273; train_optim_loss: 25381434.7273; val_kl_reg_loss: 67630.8350; val_edge_recon_loss: 807979.1562; val_gene_expr_recon_loss: 20845879.5000; val_masked_gp_l1_reg_loss: 51906.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 431428.5938; val_chrom_access_recon_loss: 2831038.4062; val_global_loss: 25035861.7500; val_optim_loss: 25035861.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8331; val_auprc_score: 0.8144; val_best_acc_score: 0.7031; val_best_f1_score: 0.7563; train_kl_reg_loss: 66205.8156; train_edge_recon_loss: 726533.2917; train_gene_expr_recon_loss: 20904172.3030; train_masked_gp_l1_reg_loss: 52713.1228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 335707.4981; train_chrom_access_recon_loss: 2801390.5417; train_global_loss: 24886722.4242; train_optim_loss: 24886722.4242; val_kl_reg_loss: 63441.5503; val_edge_recon_loss: 792422.7500; val_gene_expr_recon_loss: 20550190.5000; val_masked_gp_l1_reg_loss: 53615.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 268387.5000; val_chrom_access_recon_loss: 2744090.2812; val_global_loss: 24472148.7500; val_optim_loss: 24472148.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8784; val_auprc_score: 0.8460; val_best_acc_score: 0.8109; val_best_f1_score: 0.8233; train_kl_reg_loss: 60437.1229; train_edge_recon_loss: 713602.5994; train_gene_expr_recon_loss: 20723821.8788; train_masked_gp_l1_reg_loss: 54555.3722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235430.0182; train_chrom_access_recon_loss: 2783526.1818; train_global_loss: 24571373.3333; train_optim_loss: 24571373.3333; val_kl_reg_loss: 59684.7480; val_edge_recon_loss: 743037.1094; val_gene_expr_recon_loss: 20679519.5000; val_masked_gp_l1_reg_loss: 55480.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 206352.0156; val_chrom_access_recon_loss: 2769463.4375; val_global_loss: 24513536.5000; val_optim_loss: 24513536.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8866; val_auprc_score: 0.8502; val_best_acc_score: 0.8176; val_best_f1_score: 0.8352; train_kl_reg_loss: 60159.6287; train_edge_recon_loss: 674351.3570; train_gene_expr_recon_loss: 20571875.0606; train_masked_gp_l1_reg_loss: 56350.1875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186011.5324; train_chrom_access_recon_loss: 2766632.5303; train_global_loss: 24315380.3333; train_optim_loss: 24315380.3333; val_kl_reg_loss: 65684.1748; val_edge_recon_loss: 651131.3594; val_gene_expr_recon_loss: 20307493.0000; val_masked_gp_l1_reg_loss: 57293.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167525.5156; val_chrom_access_recon_loss: 2713321.3125; val_global_loss: 23962449.5000; val_optim_loss: 23962449.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8977; val_auprc_score: 0.8630; val_best_acc_score: 0.8318; val_best_f1_score: 0.8411; train_kl_reg_loss: 70886.0221; train_edge_recon_loss: 629406.9773; train_gene_expr_recon_loss: 20472948.2121; train_masked_gp_l1_reg_loss: 58222.3451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154874.7635; train_chrom_access_recon_loss: 2755558.1894; train_global_loss: 24141896.5152; train_optim_loss: 24141896.5152; val_kl_reg_loss: 69421.4268; val_edge_recon_loss: 619888.3906; val_gene_expr_recon_loss: 20220848.7500; val_masked_gp_l1_reg_loss: 59109.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144406.6875; val_chrom_access_recon_loss: 2718937.7500; val_global_loss: 23832612.2500; val_optim_loss: 23832612.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9032; val_auprc_score: 0.8753; val_best_acc_score: 0.8321; val_best_f1_score: 0.8416; train_kl_reg_loss: 71638.2176; train_edge_recon_loss: 618399.7500; train_gene_expr_recon_loss: 20379391.6061; train_masked_gp_l1_reg_loss: 59813.3066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135178.9788; train_chrom_access_recon_loss: 2743445.4697; train_global_loss: 24007867.4848; train_optim_loss: 24007867.4848; val_kl_reg_loss: 68909.4863; val_edge_recon_loss: 617121.5703; val_gene_expr_recon_loss: 20184624.7500; val_masked_gp_l1_reg_loss: 60589.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126847.0625; val_chrom_access_recon_loss: 2693214.4062; val_global_loss: 23751307.5000; val_optim_loss: 23751307.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9029; val_auprc_score: 0.8710; val_best_acc_score: 0.8340; val_best_f1_score: 0.8471; train_kl_reg_loss: 70359.2727; train_edge_recon_loss: 608840.4318; train_gene_expr_recon_loss: 20287687.7879; train_masked_gp_l1_reg_loss: 61218.1606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122199.3989; train_chrom_access_recon_loss: 2731680.3220; train_global_loss: 23881985.3333; train_optim_loss: 23881985.3333; val_kl_reg_loss: 68116.4277; val_edge_recon_loss: 613252.2891; val_gene_expr_recon_loss: 20068816.5000; val_masked_gp_l1_reg_loss: 61778.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116790.4141; val_chrom_access_recon_loss: 2703329.4062; val_global_loss: 23632082.7500; val_optim_loss: 23632082.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8972; val_auprc_score: 0.8585; val_best_acc_score: 0.8313; val_best_f1_score: 0.8451; train_kl_reg_loss: 68867.4165; train_edge_recon_loss: 606417.0777; train_gene_expr_recon_loss: 20201226.3030; train_masked_gp_l1_reg_loss: 62190.0046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113958.8104; train_chrom_access_recon_loss: 2721861.8939; train_global_loss: 23774521.5455; train_optim_loss: 23774521.5455; val_kl_reg_loss: 68295.3809; val_edge_recon_loss: 614260.0859; val_gene_expr_recon_loss: 20225175.7500; val_masked_gp_l1_reg_loss: 62755.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111300.4375; val_chrom_access_recon_loss: 2736642.5312; val_global_loss: 23818429.7500; val_optim_loss: 23818429.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9028; val_auprc_score: 0.8707; val_best_acc_score: 0.8399; val_best_f1_score: 0.8526; train_kl_reg_loss: 67370.8052; train_edge_recon_loss: 603400.2756; train_gene_expr_recon_loss: 20146134.2727; train_masked_gp_l1_reg_loss: 63114.2963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108569.5284; train_chrom_access_recon_loss: 2717610.1439; train_global_loss: 23706199.3333; train_optim_loss: 23706199.3333; val_kl_reg_loss: 65547.4126; val_edge_recon_loss: 611721.4844; val_gene_expr_recon_loss: 19840958.7500; val_masked_gp_l1_reg_loss: 63514.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106485.8828; val_chrom_access_recon_loss: 2708164.3750; val_global_loss: 23396392.2500; val_optim_loss: 23396392.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9085; val_auprc_score: 0.8782; val_best_acc_score: 0.8385; val_best_f1_score: 0.8513; train_kl_reg_loss: 65912.1744; train_edge_recon_loss: 598966.6676; train_gene_expr_recon_loss: 20057374.7576; train_masked_gp_l1_reg_loss: 63837.2179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103419.1364; train_chrom_access_recon_loss: 2705334.3485; train_global_loss: 23594844.2727; train_optim_loss: 23594844.2727; val_kl_reg_loss: 65235.7402; val_edge_recon_loss: 612176.2734; val_gene_expr_recon_loss: 20043142.0000; val_masked_gp_l1_reg_loss: 64275.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101489.2266; val_chrom_access_recon_loss: 2672062.0312; val_global_loss: 23558382.2500; val_optim_loss: 23558382.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9158; val_auprc_score: 0.8912; val_best_acc_score: 0.8538; val_best_f1_score: 0.8621; train_kl_reg_loss: 64895.0784; train_edge_recon_loss: 598285.4261; train_gene_expr_recon_loss: 20002449.6061; train_masked_gp_l1_reg_loss: 64580.3984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99031.6860; train_chrom_access_recon_loss: 2695337.4508; train_global_loss: 23524579.5152; train_optim_loss: 23524579.5152; val_kl_reg_loss: 62555.0791; val_edge_recon_loss: 607846.1250; val_gene_expr_recon_loss: 19732387.0000; val_masked_gp_l1_reg_loss: 64986.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97587.3125; val_chrom_access_recon_loss: 2645653.8438; val_global_loss: 23211015.7500; val_optim_loss: 23211015.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9167; val_auprc_score: 0.8855; val_best_acc_score: 0.8536; val_best_f1_score: 0.8652; train_kl_reg_loss: 63754.5991; train_edge_recon_loss: 595316.7803; train_gene_expr_recon_loss: 19938529.1818; train_masked_gp_l1_reg_loss: 65219.2279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95261.6580; train_chrom_access_recon_loss: 2687413.4697; train_global_loss: 23445494.6061; train_optim_loss: 23445494.6061; val_kl_reg_loss: 62094.8696; val_edge_recon_loss: 598267.2812; val_gene_expr_recon_loss: 19931614.2500; val_masked_gp_l1_reg_loss: 65512.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94179.8984; val_chrom_access_recon_loss: 2707123.4688; val_global_loss: 23458792.0000; val_optim_loss: 23458792.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9181; val_auprc_score: 0.8943; val_best_acc_score: 0.8544; val_best_f1_score: 0.8652; train_kl_reg_loss: 62752.4477; train_edge_recon_loss: 591549.5180; train_gene_expr_recon_loss: 19875699.7576; train_masked_gp_l1_reg_loss: 65842.1861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92252.2788; train_chrom_access_recon_loss: 2679605.0303; train_global_loss: 23367701.2424; train_optim_loss: 23367701.2424; val_kl_reg_loss: 60592.9185; val_edge_recon_loss: 601399.9062; val_gene_expr_recon_loss: 19742762.2500; val_masked_gp_l1_reg_loss: 66095.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90977.6172; val_chrom_access_recon_loss: 2646424.5000; val_global_loss: 23208253.2500; val_optim_loss: 23208253.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9271; val_auprc_score: 0.9129; val_best_acc_score: 0.8595; val_best_f1_score: 0.8697; train_kl_reg_loss: 61560.7989; train_edge_recon_loss: 592388.3646; train_gene_expr_recon_loss: 19818160.6364; train_masked_gp_l1_reg_loss: 66434.3690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90183.9219; train_chrom_access_recon_loss: 2670241.6098; train_global_loss: 23298969.8788; train_optim_loss: 23298969.8788; val_kl_reg_loss: 60328.2275; val_edge_recon_loss: 593227.2969; val_gene_expr_recon_loss: 19778625.2500; val_masked_gp_l1_reg_loss: 66756.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89262.8750; val_chrom_access_recon_loss: 2654696.3438; val_global_loss: 23242894.5000; val_optim_loss: 23242894.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9324; val_auprc_score: 0.9141; val_best_acc_score: 0.8675; val_best_f1_score: 0.8749; train_kl_reg_loss: 61101.1558; train_edge_recon_loss: 588449.4432; train_gene_expr_recon_loss: 19768947.7576; train_masked_gp_l1_reg_loss: 67056.5875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88440.6952; train_chrom_access_recon_loss: 2663288.5644; train_global_loss: 23237283.7879; train_optim_loss: 23237283.7879; val_kl_reg_loss: 59818.5034; val_edge_recon_loss: 597156.6875; val_gene_expr_recon_loss: 19538387.7500; val_masked_gp_l1_reg_loss: 67332.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88204.0859; val_chrom_access_recon_loss: 2636649.4688; val_global_loss: 22987548.5000; val_optim_loss: 22987548.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9299; val_auprc_score: 0.9147; val_best_acc_score: 0.8600; val_best_f1_score: 0.8673; train_kl_reg_loss: 60616.9928; train_edge_recon_loss: 585836.8163; train_gene_expr_recon_loss: 19709986.0606; train_masked_gp_l1_reg_loss: 67656.8178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87116.0917; train_chrom_access_recon_loss: 2656277.4848; train_global_loss: 23167490.3636; train_optim_loss: 23167490.3636; val_kl_reg_loss: 59637.3965; val_edge_recon_loss: 598769.2109; val_gene_expr_recon_loss: 19637360.7500; val_masked_gp_l1_reg_loss: 67954.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87051.2109; val_chrom_access_recon_loss: 2652285.5625; val_global_loss: 23103059.0000; val_optim_loss: 23103059.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9345; val_auprc_score: 0.9127; val_best_acc_score: 0.8735; val_best_f1_score: 0.8790; train_kl_reg_loss: 59643.0399; train_edge_recon_loss: 585497.3902; train_gene_expr_recon_loss: 19685019.9091; train_masked_gp_l1_reg_loss: 68249.3110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86805.8851; train_chrom_access_recon_loss: 2652041.8826; train_global_loss: 23137257.3030; train_optim_loss: 23137257.3030; val_kl_reg_loss: 58662.8081; val_edge_recon_loss: 596245.5156; val_gene_expr_recon_loss: 19224558.5000; val_masked_gp_l1_reg_loss: 68685.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86505.3750; val_chrom_access_recon_loss: 2602584.2500; val_global_loss: 22637243.5000; val_optim_loss: 22637243.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9368; val_auprc_score: 0.9159; val_best_acc_score: 0.8716; val_best_f1_score: 0.8799; train_kl_reg_loss: 58924.7685; train_edge_recon_loss: 584420.6733; train_gene_expr_recon_loss: 19605239.2121; train_masked_gp_l1_reg_loss: 68887.9001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86171.2184; train_chrom_access_recon_loss: 2642371.6212; train_global_loss: 23046015.4242; train_optim_loss: 23046015.4242; val_kl_reg_loss: 58398.4976; val_edge_recon_loss: 590223.3750; val_gene_expr_recon_loss: 19347159.0000; val_masked_gp_l1_reg_loss: 69221.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85893.4531; val_chrom_access_recon_loss: 2616510.8438; val_global_loss: 22767407.7500; val_optim_loss: 22767407.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9346; val_auprc_score: 0.9123; val_best_acc_score: 0.8759; val_best_f1_score: 0.8833; train_kl_reg_loss: 58335.9985; train_edge_recon_loss: 585285.7178; train_gene_expr_recon_loss: 19554656.6061; train_masked_gp_l1_reg_loss: 69505.3104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85699.3584; train_chrom_access_recon_loss: 2632301.1212; train_global_loss: 22985783.9697; train_optim_loss: 22985783.9697; val_kl_reg_loss: 56761.0098; val_edge_recon_loss: 589369.1953; val_gene_expr_recon_loss: 19480572.2500; val_masked_gp_l1_reg_loss: 69833.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85780.4062; val_chrom_access_recon_loss: 2619293.1562; val_global_loss: 22901609.7500; val_optim_loss: 22901609.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9377; val_auprc_score: 0.9175; val_best_acc_score: 0.8818; val_best_f1_score: 0.8870; train_kl_reg_loss: 57754.3761; train_edge_recon_loss: 583100.1259; train_gene_expr_recon_loss: 19512738.9091; train_masked_gp_l1_reg_loss: 70205.6061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85315.1847; train_chrom_access_recon_loss: 2625743.8523; train_global_loss: 22934857.8182; train_optim_loss: 22934857.8182; val_kl_reg_loss: 56910.7188; val_edge_recon_loss: 584269.7266; val_gene_expr_recon_loss: 19470232.0000; val_masked_gp_l1_reg_loss: 70483.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85912.6562; val_chrom_access_recon_loss: 2621668.3750; val_global_loss: 22889476.7500; val_optim_loss: 22889476.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9406; val_auprc_score: 0.9254; val_best_acc_score: 0.8753; val_best_f1_score: 0.8817; train_kl_reg_loss: 57191.5150; train_edge_recon_loss: 582493.9110; train_gene_expr_recon_loss: 19449464.3333; train_masked_gp_l1_reg_loss: 70811.4740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85437.5668; train_chrom_access_recon_loss: 2616932.1098; train_global_loss: 22862331.0000; train_optim_loss: 22862331.0000; val_kl_reg_loss: 57339.8887; val_edge_recon_loss: 588988.2500; val_gene_expr_recon_loss: 19324390.5000; val_masked_gp_l1_reg_loss: 71211.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84622.2500; val_chrom_access_recon_loss: 2598859.6250; val_global_loss: 22725412.5000; val_optim_loss: 22725412.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9423; val_auprc_score: 0.9193; val_best_acc_score: 0.8818; val_best_f1_score: 0.8887; train_kl_reg_loss: 57597.6373; train_edge_recon_loss: 579795.1780; train_gene_expr_recon_loss: 19438322.3939; train_masked_gp_l1_reg_loss: 70678.6512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67218.1522; train_chrom_access_recon_loss: 2613527.8258; train_global_loss: 22827139.9091; train_optim_loss: 22827139.9091; val_kl_reg_loss: 57503.6802; val_edge_recon_loss: 583078.3594; val_gene_expr_recon_loss: 19268863.0000; val_masked_gp_l1_reg_loss: 70365.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61599.1523; val_chrom_access_recon_loss: 2586072.8750; val_global_loss: 22627483.7500; val_optim_loss: 22627483.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9439; val_auprc_score: 0.9272; val_best_acc_score: 0.8812; val_best_f1_score: 0.8875; train_kl_reg_loss: 58119.5960; train_edge_recon_loss: 580402.1515; train_gene_expr_recon_loss: 19422193.3636; train_masked_gp_l1_reg_loss: 70293.2290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60681.5245; train_chrom_access_recon_loss: 2609237.7803; train_global_loss: 22800927.5758; train_optim_loss: 22800927.5758; val_kl_reg_loss: 58249.2212; val_edge_recon_loss: 586565.4609; val_gene_expr_recon_loss: 19415738.5000; val_masked_gp_l1_reg_loss: 70251.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60183.2500; val_chrom_access_recon_loss: 2627185.3125; val_global_loss: 22818174.7500; val_optim_loss: 22818174.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9396; val_auprc_score: 0.9246; val_best_acc_score: 0.8743; val_best_f1_score: 0.8789; train_kl_reg_loss: 58243.3019; train_edge_recon_loss: 580613.0104; train_gene_expr_recon_loss: 19417136.6364; train_masked_gp_l1_reg_loss: 70260.2098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59806.7363; train_chrom_access_recon_loss: 2609531.8333; train_global_loss: 22795591.6364; train_optim_loss: 22795591.6364; val_kl_reg_loss: 57964.8149; val_edge_recon_loss: 592667.8984; val_gene_expr_recon_loss: 19251873.5000; val_masked_gp_l1_reg_loss: 70263.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59458.6523; val_chrom_access_recon_loss: 2597755.3438; val_global_loss: 22629983.7500; val_optim_loss: 22629983.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9485; val_auprc_score: 0.9348; val_best_acc_score: 0.8885; val_best_f1_score: 0.8944; train_kl_reg_loss: 58260.8500; train_edge_recon_loss: 580399.8333; train_gene_expr_recon_loss: 19413618.0000; train_masked_gp_l1_reg_loss: 70280.3118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59231.6537; train_chrom_access_recon_loss: 2611252.2462; train_global_loss: 22793043.0606; train_optim_loss: 22793043.0606; val_kl_reg_loss: 58250.7729; val_edge_recon_loss: 579817.6406; val_gene_expr_recon_loss: 19401074.5000; val_masked_gp_l1_reg_loss: 70309.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59110.3945; val_chrom_access_recon_loss: 2599432.2812; val_global_loss: 22767995.0000; val_optim_loss: 22767995.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9422; val_auprc_score: 0.9278; val_best_acc_score: 0.8751; val_best_f1_score: 0.8818; train_kl_reg_loss: 58261.9071; train_edge_recon_loss: 580510.3580; train_gene_expr_recon_loss: 19414262.7879; train_masked_gp_l1_reg_loss: 70322.9940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58899.1131; train_chrom_access_recon_loss: 2610245.8182; train_global_loss: 22792502.8182; train_optim_loss: 22792502.8182; val_kl_reg_loss: 57970.7827; val_edge_recon_loss: 590128.7578; val_gene_expr_recon_loss: 19216834.7500; val_masked_gp_l1_reg_loss: 70349.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58650.1602; val_chrom_access_recon_loss: 2594055.8125; val_global_loss: 22587990.0000; val_optim_loss: 22587990.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9387; val_auprc_score: 0.9192; val_best_acc_score: 0.8775; val_best_f1_score: 0.8860; train_kl_reg_loss: 58274.4230; train_edge_recon_loss: 581404.0710; train_gene_expr_recon_loss: 19408901.2121; train_masked_gp_l1_reg_loss: 70382.9016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58504.0263; train_chrom_access_recon_loss: 2608695.3295; train_global_loss: 22786161.9394; train_optim_loss: 22786161.9394; val_kl_reg_loss: 58014.3740; val_edge_recon_loss: 587278.6797; val_gene_expr_recon_loss: 19192016.2500; val_masked_gp_l1_reg_loss: 70406.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58326.4258; val_chrom_access_recon_loss: 2577396.0000; val_global_loss: 22543437.2500; val_optim_loss: 22543437.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9446; val_auprc_score: 0.9304; val_best_acc_score: 0.8829; val_best_f1_score: 0.8889; train_kl_reg_loss: 58270.8199; train_edge_recon_loss: 581465.3144; train_gene_expr_recon_loss: 19396294.5455; train_masked_gp_l1_reg_loss: 70441.7388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58166.3648; train_chrom_access_recon_loss: 2606338.9470; train_global_loss: 22770977.8182; train_optim_loss: 22770977.8182; val_kl_reg_loss: 57900.4082; val_edge_recon_loss: 586165.5781; val_gene_expr_recon_loss: 19168470.5000; val_masked_gp_l1_reg_loss: 70471.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58009.9883; val_chrom_access_recon_loss: 2570623.7500; val_global_loss: 22511642.2500; val_optim_loss: 22511642.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9331; val_auprc_score: 0.9106; val_best_acc_score: 0.8745; val_best_f1_score: 0.8799; train_kl_reg_loss: 58328.2687; train_edge_recon_loss: 577338.9716; train_gene_expr_recon_loss: 19399486.0303; train_masked_gp_l1_reg_loss: 70502.5146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57799.3656; train_chrom_access_recon_loss: 2608111.8295; train_global_loss: 22771567.0606; train_optim_loss: 22771567.0606; val_kl_reg_loss: 58521.5742; val_edge_recon_loss: 589360.2500; val_gene_expr_recon_loss: 19314368.2500; val_masked_gp_l1_reg_loss: 70556.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57824.4102; val_chrom_access_recon_loss: 2601066.4062; val_global_loss: 22691696.5000; val_optim_loss: 22691696.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9443; val_auprc_score: 0.9246; val_best_acc_score: 0.8834; val_best_f1_score: 0.8888; train_kl_reg_loss: 58391.1988; train_edge_recon_loss: 579341.2784; train_gene_expr_recon_loss: 19375863.9091; train_masked_gp_l1_reg_loss: 70585.5545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57560.5498; train_chrom_access_recon_loss: 2602890.1742; train_global_loss: 22744632.8182; train_optim_loss: 22744632.8182; val_kl_reg_loss: 57928.5352; val_edge_recon_loss: 586380.6484; val_gene_expr_recon_loss: 19267240.0000; val_masked_gp_l1_reg_loss: 70619.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57507.1758; val_chrom_access_recon_loss: 2594420.0312; val_global_loss: 22634097.0000; val_optim_loss: 22634097.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9407; val_auprc_score: 0.9191; val_best_acc_score: 0.8821; val_best_f1_score: 0.8872; train_kl_reg_loss: 58277.4923; train_edge_recon_loss: 578731.7064; train_gene_expr_recon_loss: 19373837.1515; train_masked_gp_l1_reg_loss: 70652.1830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57317.5520; train_chrom_access_recon_loss: 2603470.3788; train_global_loss: 22742286.3939; train_optim_loss: 22742286.3939; val_kl_reg_loss: 58430.3652; val_edge_recon_loss: 587814.9844; val_gene_expr_recon_loss: 19331856.2500; val_masked_gp_l1_reg_loss: 70687.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57229.7344; val_chrom_access_recon_loss: 2595490.5312; val_global_loss: 22701509.7500; val_optim_loss: 22701509.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9498; val_auprc_score: 0.9377; val_best_acc_score: 0.8890; val_best_f1_score: 0.8940; train_kl_reg_loss: 58406.9498; train_edge_recon_loss: 579055.0256; train_gene_expr_recon_loss: 19386222.7576; train_masked_gp_l1_reg_loss: 70734.2714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57044.4084; train_chrom_access_recon_loss: 2604653.9432; train_global_loss: 22756117.3939; train_optim_loss: 22756117.3939; val_kl_reg_loss: 58074.8091; val_edge_recon_loss: 581336.7500; val_gene_expr_recon_loss: 19207185.0000; val_masked_gp_l1_reg_loss: 70765.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56828.6758; val_chrom_access_recon_loss: 2570751.6250; val_global_loss: 22544942.0000; val_optim_loss: 22544942.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9465; val_auprc_score: 0.9288; val_best_acc_score: 0.8872; val_best_f1_score: 0.8924; train_kl_reg_loss: 58362.6148; train_edge_recon_loss: 577744.9962; train_gene_expr_recon_loss: 19361426.6667; train_masked_gp_l1_reg_loss: 70713.5257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55060.2659; train_chrom_access_recon_loss: 2603350.2992; train_global_loss: 22726658.5455; train_optim_loss: 22726658.5455; val_kl_reg_loss: 58139.8721; val_edge_recon_loss: 583012.5391; val_gene_expr_recon_loss: 19307584.5000; val_masked_gp_l1_reg_loss: 70676.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54462.7500; val_chrom_access_recon_loss: 2598354.1875; val_global_loss: 22672229.2500; val_optim_loss: 22672229.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9400; val_auprc_score: 0.9187; val_best_acc_score: 0.8783; val_best_f1_score: 0.8829; train_kl_reg_loss: 58439.1344; train_edge_recon_loss: 581133.4110; train_gene_expr_recon_loss: 19371653.8182; train_masked_gp_l1_reg_loss: 70667.1931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54345.5758; train_chrom_access_recon_loss: 2603143.5189; train_global_loss: 22739382.5758; train_optim_loss: 22739382.5758; val_kl_reg_loss: 58192.4810; val_edge_recon_loss: 585995.4766; val_gene_expr_recon_loss: 19354161.2500; val_masked_gp_l1_reg_loss: 70659.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54249.2617; val_chrom_access_recon_loss: 2575200.5000; val_global_loss: 22698459.2500; val_optim_loss: 22698459.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9450; val_auprc_score: 0.9276; val_best_acc_score: 0.8864; val_best_f1_score: 0.8899; train_kl_reg_loss: 58390.7878; train_edge_recon_loss: 580022.5672; train_gene_expr_recon_loss: 19371331.9394; train_masked_gp_l1_reg_loss: 70658.2522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54193.9402; train_chrom_access_recon_loss: 2600429.2500; train_global_loss: 22735026.7879; train_optim_loss: 22735026.7879; val_kl_reg_loss: 57735.9458; val_edge_recon_loss: 583804.5312; val_gene_expr_recon_loss: 19093602.0000; val_masked_gp_l1_reg_loss: 70655.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54138.3438; val_chrom_access_recon_loss: 2573570.4375; val_global_loss: 22433506.7500; val_optim_loss: 22433506.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9417; val_auprc_score: 0.9202; val_best_acc_score: 0.8807; val_best_f1_score: 0.8877; train_kl_reg_loss: 58317.4441; train_edge_recon_loss: 578913.4792; train_gene_expr_recon_loss: 19373274.0303; train_masked_gp_l1_reg_loss: 70656.7881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54100.9235; train_chrom_access_recon_loss: 2602536.1970; train_global_loss: 22737798.9697; train_optim_loss: 22737798.9697; val_kl_reg_loss: 58416.6392; val_edge_recon_loss: 581457.1484; val_gene_expr_recon_loss: 19477594.2500; val_masked_gp_l1_reg_loss: 70657.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54064.1758; val_chrom_access_recon_loss: 2604991.0938; val_global_loss: 22847181.2500; val_optim_loss: 22847181.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9401; val_auprc_score: 0.9222; val_best_acc_score: 0.8778; val_best_f1_score: 0.8830; train_kl_reg_loss: 58376.3857; train_edge_recon_loss: 579102.7888; train_gene_expr_recon_loss: 19370515.6667; train_masked_gp_l1_reg_loss: 70659.8746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54032.9970; train_chrom_access_recon_loss: 2602946.4621; train_global_loss: 22735634.3030; train_optim_loss: 22735634.3030; val_kl_reg_loss: 58391.7090; val_edge_recon_loss: 586734.8672; val_gene_expr_recon_loss: 19241390.7500; val_masked_gp_l1_reg_loss: 70663.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54009.3477; val_chrom_access_recon_loss: 2612193.2812; val_global_loss: 22623384.5000; val_optim_loss: 22623384.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9457; val_auprc_score: 0.9334; val_best_acc_score: 0.8796; val_best_f1_score: 0.8847; train_kl_reg_loss: 58362.2744; train_edge_recon_loss: 579006.4195; train_gene_expr_recon_loss: 19339912.8788; train_masked_gp_l1_reg_loss: 70665.6903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53975.0486; train_chrom_access_recon_loss: 2596042.1894; train_global_loss: 22697964.5455; train_optim_loss: 22697964.5455; val_kl_reg_loss: 58094.7734; val_edge_recon_loss: 591337.2578; val_gene_expr_recon_loss: 19350021.7500; val_masked_gp_l1_reg_loss: 70668.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53949.7734; val_chrom_access_recon_loss: 2600956.8125; val_global_loss: 22725029.0000; val_optim_loss: 22725029.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9487; val_auprc_score: 0.9378; val_best_acc_score: 0.8818; val_best_f1_score: 0.8874; train_kl_reg_loss: 58346.2756; train_edge_recon_loss: 578671.5303; train_gene_expr_recon_loss: 19358151.8182; train_masked_gp_l1_reg_loss: 70671.3427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53921.7683; train_chrom_access_recon_loss: 2601846.9205; train_global_loss: 22721609.3030; train_optim_loss: 22721609.3030; val_kl_reg_loss: 57945.2573; val_edge_recon_loss: 590270.9375; val_gene_expr_recon_loss: 19257291.0000; val_masked_gp_l1_reg_loss: 70675.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53902.5508; val_chrom_access_recon_loss: 2585381.7812; val_global_loss: 22615465.7500; val_optim_loss: 22615465.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9433; val_auprc_score: 0.9240; val_best_acc_score: 0.8845; val_best_f1_score: 0.8883; train_kl_reg_loss: 58392.6284; train_edge_recon_loss: 579079.9820; train_gene_expr_recon_loss: 19373871.9091; train_masked_gp_l1_reg_loss: 70670.1277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53722.7604; train_chrom_access_recon_loss: 2601550.7879; train_global_loss: 22737288.0000; train_optim_loss: 22737288.0000; val_kl_reg_loss: 58121.5068; val_edge_recon_loss: 585108.7656; val_gene_expr_recon_loss: 19203061.7500; val_masked_gp_l1_reg_loss: 70666.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53662.4375; val_chrom_access_recon_loss: 2584764.3125; val_global_loss: 22555384.2500; val_optim_loss: 22555384.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9471; val_auprc_score: 0.9286; val_best_acc_score: 0.8882; val_best_f1_score: 0.8924; train_kl_reg_loss: 58411.1322; train_edge_recon_loss: 578005.6373; train_gene_expr_recon_loss: 19361504.3333; train_masked_gp_l1_reg_loss: 70665.4309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53651.4002; train_chrom_access_recon_loss: 2604815.7765; train_global_loss: 22727053.6061; train_optim_loss: 22727053.6061; val_kl_reg_loss: 58184.2959; val_edge_recon_loss: 584774.8047; val_gene_expr_recon_loss: 19258430.2500; val_masked_gp_l1_reg_loss: 70664.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53641.6094; val_chrom_access_recon_loss: 2616750.3750; val_global_loss: 22642445.7500; val_optim_loss: 22642445.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9436; val_auprc_score: 0.9245; val_best_acc_score: 0.8831; val_best_f1_score: 0.8897; train_kl_reg_loss: 58370.3672; train_edge_recon_loss: 579639.6212; train_gene_expr_recon_loss: 19361510.7273; train_masked_gp_l1_reg_loss: 70664.3525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53635.5996; train_chrom_access_recon_loss: 2603564.9621; train_global_loss: 22727385.3636; train_optim_loss: 22727385.3636; val_kl_reg_loss: 58230.0947; val_edge_recon_loss: 585050.6641; val_gene_expr_recon_loss: 19300511.2500; val_masked_gp_l1_reg_loss: 70664.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53629.0273; val_chrom_access_recon_loss: 2593743.6250; val_global_loss: 22661829.7500; val_optim_loss: 22661829.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9499; val_auprc_score: 0.9385; val_best_acc_score: 0.8853; val_best_f1_score: 0.8914; train_kl_reg_loss: 58392.1681; train_edge_recon_loss: 579099.4441; train_gene_expr_recon_loss: 19371508.6667; train_masked_gp_l1_reg_loss: 70664.0677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53624.9066; train_chrom_access_recon_loss: 2602618.9356; train_global_loss: 22735908.2424; train_optim_loss: 22735908.2424; val_kl_reg_loss: 57888.1426; val_edge_recon_loss: 583848.8438; val_gene_expr_recon_loss: 19277239.2500; val_masked_gp_l1_reg_loss: 70664.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53620.5195; val_chrom_access_recon_loss: 2571611.5938; val_global_loss: 22614871.5000; val_optim_loss: 22614871.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 18 min 20 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9409
val AUPRC score: 0.9175
val best accuracy score: 0.8821
val best F1 score: 0.8888
val target rna MSE score: 1.0920
val source rna MSE score: 0.5992
val target atac MSE score: 0.4646
val source atac MSE score: 0.1934
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
