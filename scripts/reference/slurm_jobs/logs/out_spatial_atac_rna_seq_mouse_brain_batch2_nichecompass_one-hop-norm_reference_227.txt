[True]
Run timestamp: 07092023_010339_227.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_227']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2944 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 6573, n_cat_covariates_embed_input: 0, n_hidden: 2386, n_latent: 2286, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2944
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2944

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7840; val_auprc_score: 0.8028; val_best_acc_score: 0.5606; val_best_f1_score: 0.6899; train_kl_reg_loss: 68493.4421; train_edge_recon_loss: 3560288.1126; train_gene_expr_recon_loss: 14961979.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 913827.8726; train_chrom_access_recon_loss: 13431013.9237; train_global_loss: 32935603.0382; train_optim_loss: 32935603.0382; val_kl_reg_loss: 95424.5771; val_edge_recon_loss: 4061748.2833; val_gene_expr_recon_loss: 14202763.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 485135.9375; val_chrom_access_recon_loss: 13307265.9333; val_global_loss: 32152338.0000; val_optim_loss: 32152338.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8579; val_auprc_score: 0.8617; val_best_acc_score: 0.7658; val_best_f1_score: 0.7403; train_kl_reg_loss: 91652.2784; train_edge_recon_loss: 3515790.5706; train_gene_expr_recon_loss: 13826146.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 296462.4306; train_chrom_access_recon_loss: 12847007.6412; train_global_loss: 30577059.4198; train_optim_loss: 30577059.4198; val_kl_reg_loss: 82198.2854; val_edge_recon_loss: 3989286.5000; val_gene_expr_recon_loss: 13882186.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179981.3594; val_chrom_access_recon_loss: 13123276.2000; val_global_loss: 31256928.8000; val_optim_loss: 31256928.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8869; val_auprc_score: 0.8800; val_best_acc_score: 0.7972; val_best_f1_score: 0.8105; train_kl_reg_loss: 73114.1256; train_edge_recon_loss: 3276141.1355; train_gene_expr_recon_loss: 13615938.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134536.0437; train_chrom_access_recon_loss: 12680592.9466; train_global_loss: 29780323.0687; train_optim_loss: 29780323.0687; val_kl_reg_loss: 99860.1016; val_edge_recon_loss: 2978746.5167; val_gene_expr_recon_loss: 13713810.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102015.4219; val_chrom_access_recon_loss: 12949115.6667; val_global_loss: 29843548.6667; val_optim_loss: 29843548.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9064; val_auprc_score: 0.8891; val_best_acc_score: 0.8293; val_best_f1_score: 0.8412; train_kl_reg_loss: 94611.9164; train_edge_recon_loss: 2910855.9408; train_gene_expr_recon_loss: 13447883.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84109.7701; train_chrom_access_recon_loss: 12528117.8321; train_global_loss: 29065579.0076; train_optim_loss: 29065579.0076; val_kl_reg_loss: 91190.9276; val_edge_recon_loss: 2860536.2500; val_gene_expr_recon_loss: 13583785.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70392.1641; val_chrom_access_recon_loss: 12821386.3333; val_global_loss: 29427290.5333; val_optim_loss: 29427290.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9285; val_auprc_score: 0.9116; val_best_acc_score: 0.8632; val_best_f1_score: 0.8724; train_kl_reg_loss: 93585.6344; train_edge_recon_loss: 2841192.4389; train_gene_expr_recon_loss: 13302190.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62539.8686; train_chrom_access_recon_loss: 12411752.8397; train_global_loss: 28711261.1298; train_optim_loss: 28711261.1298; val_kl_reg_loss: 95192.4406; val_edge_recon_loss: 2825672.6000; val_gene_expr_recon_loss: 13477792.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56363.7148; val_chrom_access_recon_loss: 12686689.1333; val_global_loss: 29141710.9333; val_optim_loss: 29141710.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9371; val_auprc_score: 0.9209; val_best_acc_score: 0.8697; val_best_f1_score: 0.8784; train_kl_reg_loss: 92387.4599; train_edge_recon_loss: 2806372.1145; train_gene_expr_recon_loss: 13181846.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52402.4671; train_chrom_access_recon_loss: 12296357.2290; train_global_loss: 28429365.4809; train_optim_loss: 28429365.4809; val_kl_reg_loss: 87313.8594; val_edge_recon_loss: 2789235.4167; val_gene_expr_recon_loss: 13353745.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49162.7031; val_chrom_access_recon_loss: 12598134.1333; val_global_loss: 28877591.8667; val_optim_loss: 28877591.8667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9443; val_auprc_score: 0.9294; val_best_acc_score: 0.8789; val_best_f1_score: 0.8860; train_kl_reg_loss: 87872.3006; train_edge_recon_loss: 2777860.6565; train_gene_expr_recon_loss: 13089837.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46864.3671; train_chrom_access_recon_loss: 12207496.4275; train_global_loss: 28209931.3282; train_optim_loss: 28209931.3282; val_kl_reg_loss: 89274.5688; val_edge_recon_loss: 2799692.1833; val_gene_expr_recon_loss: 13230963.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44763.8086; val_chrom_access_recon_loss: 12461580.2000; val_global_loss: 28626274.2667; val_optim_loss: 28626274.2667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9500; val_auprc_score: 0.9351; val_best_acc_score: 0.8882; val_best_f1_score: 0.8927; train_kl_reg_loss: 84757.3328; train_edge_recon_loss: 2764973.4332; train_gene_expr_recon_loss: 12994272.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43554.3575; train_chrom_access_recon_loss: 12117277.5267; train_global_loss: 28004835.2824; train_optim_loss: 28004835.2824; val_kl_reg_loss: 84346.3240; val_edge_recon_loss: 2758715.5667; val_gene_expr_recon_loss: 13169597.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42535.2305; val_chrom_access_recon_loss: 12411720.8667; val_global_loss: 28466915.3333; val_optim_loss: 28466915.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9502; val_auprc_score: 0.9357; val_best_acc_score: 0.8926; val_best_f1_score: 0.8960; train_kl_reg_loss: 82683.1678; train_edge_recon_loss: 2754025.4218; train_gene_expr_recon_loss: 12915308.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41660.9941; train_chrom_access_recon_loss: 12047605.5802; train_global_loss: 27841284.0000; train_optim_loss: 27841284.0000; val_kl_reg_loss: 82082.5500; val_edge_recon_loss: 2746288.7333; val_gene_expr_recon_loss: 13064958.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41232.9883; val_chrom_access_recon_loss: 12335995.4000; val_global_loss: 28270558.6667; val_optim_loss: 28270558.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9565; val_auprc_score: 0.9434; val_best_acc_score: 0.8969; val_best_f1_score: 0.9007; train_kl_reg_loss: 79133.4412; train_edge_recon_loss: 2737232.2901; train_gene_expr_recon_loss: 12842362.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40395.1611; train_chrom_access_recon_loss: 11967854.8168; train_global_loss: 27666977.9542; train_optim_loss: 27666977.9542; val_kl_reg_loss: 79687.6604; val_edge_recon_loss: 2747385.5333; val_gene_expr_recon_loss: 12985658.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40181.7031; val_chrom_access_recon_loss: 12282268.6667; val_global_loss: 28135181.8667; val_optim_loss: 28135181.8667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9559; val_auprc_score: 0.9400; val_best_acc_score: 0.8995; val_best_f1_score: 0.9043; train_kl_reg_loss: 78533.4184; train_edge_recon_loss: 2730475.2481; train_gene_expr_recon_loss: 12767039.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39460.5214; train_chrom_access_recon_loss: 11896841.7176; train_global_loss: 27512350.3206; train_optim_loss: 27512350.3206; val_kl_reg_loss: 77950.5896; val_edge_recon_loss: 2732583.2333; val_gene_expr_recon_loss: 12979717.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39011.7539; val_chrom_access_recon_loss: 12240307.9333; val_global_loss: 28069571.2000; val_optim_loss: 28069571.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9602; val_auprc_score: 0.9507; val_best_acc_score: 0.8995; val_best_f1_score: 0.9028; train_kl_reg_loss: 74841.2164; train_edge_recon_loss: 2725171.7309; train_gene_expr_recon_loss: 12710380.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38600.7774; train_chrom_access_recon_loss: 11843060.7634; train_global_loss: 27392054.5954; train_optim_loss: 27392054.5954; val_kl_reg_loss: 74155.0042; val_edge_recon_loss: 2747194.6000; val_gene_expr_recon_loss: 12910229.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38489.8164; val_chrom_access_recon_loss: 12140293.2000; val_global_loss: 27910362.4000; val_optim_loss: 27910362.4000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9560; val_auprc_score: 0.9414; val_best_acc_score: 0.9023; val_best_f1_score: 0.9058; train_kl_reg_loss: 74484.8737; train_edge_recon_loss: 2718050.1412; train_gene_expr_recon_loss: 12657287.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38028.1558; train_chrom_access_recon_loss: 11794327.5115; train_global_loss: 27282177.8931; train_optim_loss: 27282177.8931; val_kl_reg_loss: 75018.4031; val_edge_recon_loss: 2732460.0167; val_gene_expr_recon_loss: 12818174.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37988.3828; val_chrom_access_recon_loss: 12064280.4667; val_global_loss: 27727921.3333; val_optim_loss: 27727921.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9639; val_auprc_score: 0.9534; val_best_acc_score: 0.9086; val_best_f1_score: 0.9118; train_kl_reg_loss: 72174.1216; train_edge_recon_loss: 2702155.8569; train_gene_expr_recon_loss: 12606296.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37698.9364; train_chrom_access_recon_loss: 11730843.4504; train_global_loss: 27149169.0534; train_optim_loss: 27149169.0534; val_kl_reg_loss: 71496.4516; val_edge_recon_loss: 2729738.6333; val_gene_expr_recon_loss: 12773336.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37388.8320; val_chrom_access_recon_loss: 12046130.3333; val_global_loss: 27658091.0667; val_optim_loss: 27658091.0667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9668; val_auprc_score: 0.9573; val_best_acc_score: 0.9116; val_best_f1_score: 0.9145; train_kl_reg_loss: 70149.8903; train_edge_recon_loss: 2700045.6966; train_gene_expr_recon_loss: 12560115.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37380.0758; train_chrom_access_recon_loss: 11688061.3817; train_global_loss: 27055752.3664; train_optim_loss: 27055752.3664; val_kl_reg_loss: 72129.2437; val_edge_recon_loss: 2723205.6333; val_gene_expr_recon_loss: 12718788.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37122.9844; val_chrom_access_recon_loss: 11951090.2667; val_global_loss: 27502336.4000; val_optim_loss: 27502336.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9671; val_auprc_score: 0.9584; val_best_acc_score: 0.9150; val_best_f1_score: 0.9172; train_kl_reg_loss: 69274.2225; train_edge_recon_loss: 2701913.9027; train_gene_expr_recon_loss: 12506989.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37112.2729; train_chrom_access_recon_loss: 11626524.1832; train_global_loss: 26941814.3969; train_optim_loss: 26941814.3969; val_kl_reg_loss: 68394.4393; val_edge_recon_loss: 2713878.1167; val_gene_expr_recon_loss: 12658153.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36939.5195; val_chrom_access_recon_loss: 11872438.0667; val_global_loss: 27349804.1333; val_optim_loss: 27349804.1333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9679; val_auprc_score: 0.9597; val_best_acc_score: 0.9166; val_best_f1_score: 0.9192; train_kl_reg_loss: 67830.6179; train_edge_recon_loss: 2698833.8416; train_gene_expr_recon_loss: 12470161.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36909.7229; train_chrom_access_recon_loss: 11587438.2672; train_global_loss: 26861174.0305; train_optim_loss: 26861174.0305; val_kl_reg_loss: 64657.7466; val_edge_recon_loss: 2726593.2833; val_gene_expr_recon_loss: 12637807.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36819.9023; val_chrom_access_recon_loss: 11885537.8000; val_global_loss: 27351416.4000; val_optim_loss: 27351416.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9662; val_auprc_score: 0.9559; val_best_acc_score: 0.9142; val_best_f1_score: 0.9172; train_kl_reg_loss: 65717.6379; train_edge_recon_loss: 2694735.2653; train_gene_expr_recon_loss: 12442501.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36699.4861; train_chrom_access_recon_loss: 11562982.8779; train_global_loss: 26802637.1603; train_optim_loss: 26802637.1603; val_kl_reg_loss: 65988.7016; val_edge_recon_loss: 2713956.4833; val_gene_expr_recon_loss: 12602478.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36767.8516; val_chrom_access_recon_loss: 11887509.2000; val_global_loss: 27306700.8000; val_optim_loss: 27306700.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9682; val_auprc_score: 0.9574; val_best_acc_score: 0.9196; val_best_f1_score: 0.9224; train_kl_reg_loss: 65300.2672; train_edge_recon_loss: 2691488.8798; train_gene_expr_recon_loss: 12403823.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36613.7876; train_chrom_access_recon_loss: 11512045.2977; train_global_loss: 26709272.2137; train_optim_loss: 26709272.2137; val_kl_reg_loss: 63742.9693; val_edge_recon_loss: 2683800.0833; val_gene_expr_recon_loss: 12600539.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36521.7656; val_chrom_access_recon_loss: 11880073.7333; val_global_loss: 27264678.5333; val_optim_loss: 27264678.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9723; val_auprc_score: 0.9631; val_best_acc_score: 0.9251; val_best_f1_score: 0.9277; train_kl_reg_loss: 64235.8169; train_edge_recon_loss: 2682445.3588; train_gene_expr_recon_loss: 12374431.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36506.6710; train_chrom_access_recon_loss: 11475728.8779; train_global_loss: 26633348.5344; train_optim_loss: 26633348.5344; val_kl_reg_loss: 65396.2346; val_edge_recon_loss: 2682147.0333; val_gene_expr_recon_loss: 12604719.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36721.7383; val_chrom_access_recon_loss: 11838654.2667; val_global_loss: 27227638.5333; val_optim_loss: 27227638.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9733; val_auprc_score: 0.9658; val_best_acc_score: 0.9272; val_best_f1_score: 0.9299; train_kl_reg_loss: 63633.1154; train_edge_recon_loss: 2681832.3836; train_gene_expr_recon_loss: 12340644.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36591.5230; train_chrom_access_recon_loss: 11439271.3893; train_global_loss: 26561973.2977; train_optim_loss: 26561973.2977; val_kl_reg_loss: 61187.0789; val_edge_recon_loss: 2683481.5167; val_gene_expr_recon_loss: 12597804.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36591.0508; val_chrom_access_recon_loss: 11853183.4000; val_global_loss: 27232247.3333; val_optim_loss: 27232247.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9773; val_auprc_score: 0.9718; val_best_acc_score: 0.9303; val_best_f1_score: 0.9330; train_kl_reg_loss: 62188.0200; train_edge_recon_loss: 2676626.9447; train_gene_expr_recon_loss: 12313241.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36476.2085; train_chrom_access_recon_loss: 11401866.2977; train_global_loss: 26490399.3893; train_optim_loss: 26490399.3893; val_kl_reg_loss: 63282.6943; val_edge_recon_loss: 2673282.8667; val_gene_expr_recon_loss: 12530697.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36770.6172; val_chrom_access_recon_loss: 11798402.8000; val_global_loss: 27102436.9333; val_optim_loss: 27102436.9333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9764; val_auprc_score: 0.9696; val_best_acc_score: 0.9312; val_best_f1_score: 0.9334; train_kl_reg_loss: 62385.2202; train_edge_recon_loss: 2670777.6279; train_gene_expr_recon_loss: 12284739.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36563.4350; train_chrom_access_recon_loss: 11372856.6870; train_global_loss: 26427322.0153; train_optim_loss: 26427322.0153; val_kl_reg_loss: 61544.8466; val_edge_recon_loss: 2688157.9667; val_gene_expr_recon_loss: 12491850.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36858.7344; val_chrom_access_recon_loss: 11754265.6000; val_global_loss: 27032677.4667; val_optim_loss: 27032677.4667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9760; val_auprc_score: 0.9696; val_best_acc_score: 0.9297; val_best_f1_score: 0.9320; train_kl_reg_loss: 61706.6640; train_edge_recon_loss: 2669105.1450; train_gene_expr_recon_loss: 12277652.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36594.0730; train_chrom_access_recon_loss: 11358223.8550; train_global_loss: 26403282.5038; train_optim_loss: 26403282.5038; val_kl_reg_loss: 61032.5367; val_edge_recon_loss: 2678788.1833; val_gene_expr_recon_loss: 12542838.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37073.8203; val_chrom_access_recon_loss: 11778135.8667; val_global_loss: 27097868.6667; val_optim_loss: 27097868.6667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9782; val_auprc_score: 0.9704; val_best_acc_score: 0.9356; val_best_f1_score: 0.9383; train_kl_reg_loss: 60925.6478; train_edge_recon_loss: 2669723.4809; train_gene_expr_recon_loss: 12249970.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36763.4691; train_chrom_access_recon_loss: 11326244.9695; train_global_loss: 26343627.9389; train_optim_loss: 26343627.9389; val_kl_reg_loss: 60626.7562; val_edge_recon_loss: 2692207.9833; val_gene_expr_recon_loss: 12508848.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36920.7656; val_chrom_access_recon_loss: 11744199.0000; val_global_loss: 27042802.9333; val_optim_loss: 27042802.9333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9786; val_auprc_score: 0.9709; val_best_acc_score: 0.9361; val_best_f1_score: 0.9380; train_kl_reg_loss: 60751.0865; train_edge_recon_loss: 2663592.5344; train_gene_expr_recon_loss: 12225020.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36743.6078; train_chrom_access_recon_loss: 11307127.0763; train_global_loss: 26293235.2977; train_optim_loss: 26293235.2977; val_kl_reg_loss: 58806.5945; val_edge_recon_loss: 2671647.4000; val_gene_expr_recon_loss: 12468916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37048.3750; val_chrom_access_recon_loss: 11702775.2000; val_global_loss: 26939193.4667; val_optim_loss: 26939193.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9804; val_auprc_score: 0.9762; val_best_acc_score: 0.9368; val_best_f1_score: 0.9386; train_kl_reg_loss: 59423.1033; train_edge_recon_loss: 2663617.7347; train_gene_expr_recon_loss: 12205387.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36841.3292; train_chrom_access_recon_loss: 11275996.3053; train_global_loss: 26241265.6031; train_optim_loss: 26241265.6031; val_kl_reg_loss: 58321.3344; val_edge_recon_loss: 2671727.3500; val_gene_expr_recon_loss: 12491700.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36754.5117; val_chrom_access_recon_loss: 11706511.9333; val_global_loss: 26965015.7333; val_optim_loss: 26965015.7333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9820; val_auprc_score: 0.9773; val_best_acc_score: 0.9390; val_best_f1_score: 0.9406; train_kl_reg_loss: 59153.5678; train_edge_recon_loss: 2664614.2195; train_gene_expr_recon_loss: 12183597.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36836.9711; train_chrom_access_recon_loss: 11249036.7481; train_global_loss: 26193238.9771; train_optim_loss: 26193238.9771; val_kl_reg_loss: 57071.5729; val_edge_recon_loss: 2678400.7333; val_gene_expr_recon_loss: 12440480.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36924.0898; val_chrom_access_recon_loss: 11685424.2667; val_global_loss: 26898301.0667; val_optim_loss: 26898301.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9823; val_auprc_score: 0.9785; val_best_acc_score: 0.9418; val_best_f1_score: 0.9434; train_kl_reg_loss: 58340.7472; train_edge_recon_loss: 2659532.2424; train_gene_expr_recon_loss: 12169814.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36976.8315; train_chrom_access_recon_loss: 11223876.0153; train_global_loss: 26148540.8092; train_optim_loss: 26148540.8092; val_kl_reg_loss: 58663.1852; val_edge_recon_loss: 2640237.5833; val_gene_expr_recon_loss: 12430659.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37087.7734; val_chrom_access_recon_loss: 11656447.8667; val_global_loss: 26823095.7333; val_optim_loss: 26823095.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9807; val_auprc_score: 0.9751; val_best_acc_score: 0.9384; val_best_f1_score: 0.9401; train_kl_reg_loss: 58063.7100; train_edge_recon_loss: 2662190.9561; train_gene_expr_recon_loss: 12146637.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37109.1280; train_chrom_access_recon_loss: 11195709.8092; train_global_loss: 26099711.4198; train_optim_loss: 26099711.4198; val_kl_reg_loss: 56014.4844; val_edge_recon_loss: 2666595.2667; val_gene_expr_recon_loss: 12345655.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37130.4492; val_chrom_access_recon_loss: 11570419.8000; val_global_loss: 26675815.0667; val_optim_loss: 26675815.0667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9829; val_auprc_score: 0.9787; val_best_acc_score: 0.9423; val_best_f1_score: 0.9435; train_kl_reg_loss: 57229.0232; train_edge_recon_loss: 2666529.3359; train_gene_expr_recon_loss: 12147348.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37099.9497; train_chrom_access_recon_loss: 11190939.6412; train_global_loss: 26099146.2443; train_optim_loss: 26099146.2443; val_kl_reg_loss: 57697.8945; val_edge_recon_loss: 2674238.4667; val_gene_expr_recon_loss: 12348052.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37354.9883; val_chrom_access_recon_loss: 11621394.9333; val_global_loss: 26738738.5333; val_optim_loss: 26738738.5333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9841; val_auprc_score: 0.9780; val_best_acc_score: 0.9452; val_best_f1_score: 0.9465; train_kl_reg_loss: 57307.9369; train_edge_recon_loss: 2657277.2099; train_gene_expr_recon_loss: 12124710.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37259.9931; train_chrom_access_recon_loss: 11168946.1908; train_global_loss: 26045502.1374; train_optim_loss: 26045502.1374; val_kl_reg_loss: 58974.8263; val_edge_recon_loss: 2663664.4500; val_gene_expr_recon_loss: 12364160.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37436.3047; val_chrom_access_recon_loss: 11560241.0000; val_global_loss: 26684476.2667; val_optim_loss: 26684476.2667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9853; val_auprc_score: 0.9801; val_best_acc_score: 0.9495; val_best_f1_score: 0.9510; train_kl_reg_loss: 57518.0683; train_edge_recon_loss: 2657262.3721; train_gene_expr_recon_loss: 12114498.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37329.9484; train_chrom_access_recon_loss: 11147646.4275; train_global_loss: 26014255.0992; train_optim_loss: 26014255.0992; val_kl_reg_loss: 55031.4516; val_edge_recon_loss: 2673108.3000; val_gene_expr_recon_loss: 12371287.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37346.3086; val_chrom_access_recon_loss: 11591058.6000; val_global_loss: 26727831.3333; val_optim_loss: 26727831.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9836; val_auprc_score: 0.9781; val_best_acc_score: 0.9449; val_best_f1_score: 0.9464; train_kl_reg_loss: 57023.9491; train_edge_recon_loss: 2654631.9237; train_gene_expr_recon_loss: 12092757.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37395.1579; train_chrom_access_recon_loss: 11124382.8626; train_global_loss: 25966190.9618; train_optim_loss: 25966190.9618; val_kl_reg_loss: 57443.1964; val_edge_recon_loss: 2666065.2333; val_gene_expr_recon_loss: 12382650.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37547.2852; val_chrom_access_recon_loss: 11557174.8667; val_global_loss: 26700880.6667; val_optim_loss: 26700880.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9862; val_auprc_score: 0.9831; val_best_acc_score: 0.9480; val_best_f1_score: 0.9492; train_kl_reg_loss: 57824.5118; train_edge_recon_loss: 2653194.8053; train_gene_expr_recon_loss: 12077615.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30920.3818; train_chrom_access_recon_loss: 11103560.7634; train_global_loss: 25923115.6336; train_optim_loss: 25923115.6336; val_kl_reg_loss: 58406.2841; val_edge_recon_loss: 2652433.9833; val_gene_expr_recon_loss: 12362490.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29592.1816; val_chrom_access_recon_loss: 11570045.6000; val_global_loss: 26672967.8667; val_optim_loss: 26672967.8667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9850; val_auprc_score: 0.9811; val_best_acc_score: 0.9461; val_best_f1_score: 0.9476; train_kl_reg_loss: 58096.3818; train_edge_recon_loss: 2647931.3282; train_gene_expr_recon_loss: 12065408.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29370.2194; train_chrom_access_recon_loss: 11087173.5344; train_global_loss: 25887980.2443; train_optim_loss: 25887980.2443; val_kl_reg_loss: 58300.6628; val_edge_recon_loss: 2682304.5167; val_gene_expr_recon_loss: 12379243.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29232.7266; val_chrom_access_recon_loss: 11636241.2667; val_global_loss: 26785323.4667; val_optim_loss: 26785323.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9874; val_auprc_score: 0.9854; val_best_acc_score: 0.9508; val_best_f1_score: 0.9520; train_kl_reg_loss: 58007.6910; train_edge_recon_loss: 2650201.1622; train_gene_expr_recon_loss: 12063234.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29118.5139; train_chrom_access_recon_loss: 11087355.2366; train_global_loss: 25887916.9924; train_optim_loss: 25887916.9924; val_kl_reg_loss: 58239.6000; val_edge_recon_loss: 2643411.6167; val_gene_expr_recon_loss: 12361441.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29013.9102; val_chrom_access_recon_loss: 11607294.0000; val_global_loss: 26699400.6667; val_optim_loss: 26699400.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9876; val_auprc_score: 0.9853; val_best_acc_score: 0.9500; val_best_f1_score: 0.9511; train_kl_reg_loss: 58046.8856; train_edge_recon_loss: 2651489.1260; train_gene_expr_recon_loss: 12064576.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28921.4363; train_chrom_access_recon_loss: 11082148.1221; train_global_loss: 25885182.3969; train_optim_loss: 25885182.3969; val_kl_reg_loss: 58482.9461; val_edge_recon_loss: 2661859.9167; val_gene_expr_recon_loss: 12373009.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28881.2617; val_chrom_access_recon_loss: 11583069.8000; val_global_loss: 26705303.6000; val_optim_loss: 26705303.6000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9866; val_auprc_score: 0.9835; val_best_acc_score: 0.9485; val_best_f1_score: 0.9499; train_kl_reg_loss: 58318.3721; train_edge_recon_loss: 2652274.3282; train_gene_expr_recon_loss: 12049976.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28809.9319; train_chrom_access_recon_loss: 11076786.8321; train_global_loss: 25866165.8779; train_optim_loss: 25866165.8779; val_kl_reg_loss: 58581.5396; val_edge_recon_loss: 2648873.3333; val_gene_expr_recon_loss: 12341968.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28755.2773; val_chrom_access_recon_loss: 11542390.8000; val_global_loss: 26620569.3333; val_optim_loss: 26620569.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9872; val_auprc_score: 0.9847; val_best_acc_score: 0.9475; val_best_f1_score: 0.9490; train_kl_reg_loss: 58268.6950; train_edge_recon_loss: 2646647.9523; train_gene_expr_recon_loss: 12056651.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28699.9078; train_chrom_access_recon_loss: 11073538.5954; train_global_loss: 25863807.1145; train_optim_loss: 25863807.1145; val_kl_reg_loss: 58894.6836; val_edge_recon_loss: 2659865.2833; val_gene_expr_recon_loss: 12326079.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28676.9219; val_chrom_access_recon_loss: 11542097.6000; val_global_loss: 26615613.7333; val_optim_loss: 26615613.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9875; val_auprc_score: 0.9849; val_best_acc_score: 0.9510; val_best_f1_score: 0.9522; train_kl_reg_loss: 58176.1533; train_edge_recon_loss: 2648156.5630; train_gene_expr_recon_loss: 12054286.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28608.4763; train_chrom_access_recon_loss: 11076641.7405; train_global_loss: 25865869.0840; train_optim_loss: 25865869.0840; val_kl_reg_loss: 58356.8078; val_edge_recon_loss: 2663270.8333; val_gene_expr_recon_loss: 12389283.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28573.7207; val_chrom_access_recon_loss: 11577470.4667; val_global_loss: 26716955.8667; val_optim_loss: 26716955.8667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9873; val_auprc_score: 0.9830; val_best_acc_score: 0.9506; val_best_f1_score: 0.9518; train_kl_reg_loss: 58311.6852; train_edge_recon_loss: 2649314.9885; train_gene_expr_recon_loss: 12054895.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28514.3707; train_chrom_access_recon_loss: 11071031.8931; train_global_loss: 25862068.3511; train_optim_loss: 25862068.3511; val_kl_reg_loss: 58233.6070; val_edge_recon_loss: 2660487.7667; val_gene_expr_recon_loss: 12296260.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28473.7793; val_chrom_access_recon_loss: 11495886.4667; val_global_loss: 26539342.6667; val_optim_loss: 26539342.6667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9887; val_auprc_score: 0.9838; val_best_acc_score: 0.9530; val_best_f1_score: 0.9536; train_kl_reg_loss: 58314.9971; train_edge_recon_loss: 2645468.8263; train_gene_expr_recon_loss: 12055658.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28428.2552; train_chrom_access_recon_loss: 11077032.8702; train_global_loss: 25864903.0992; train_optim_loss: 25864903.0992; val_kl_reg_loss: 58105.0872; val_edge_recon_loss: 2655654.7167; val_gene_expr_recon_loss: 12306479.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28374.5664; val_chrom_access_recon_loss: 11499675.8000; val_global_loss: 26548290.5333; val_optim_loss: 26548290.5333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9866; val_auprc_score: 0.9817; val_best_acc_score: 0.9510; val_best_f1_score: 0.9521; train_kl_reg_loss: 57911.2832; train_edge_recon_loss: 2655660.4924; train_gene_expr_recon_loss: 12056256.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28339.5917; train_chrom_access_recon_loss: 11072818.8550; train_global_loss: 25870986.9313; train_optim_loss: 25870986.9313; val_kl_reg_loss: 58136.6464; val_edge_recon_loss: 2653838.8833; val_gene_expr_recon_loss: 12328974.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28285.1035; val_chrom_access_recon_loss: 11557801.8000; val_global_loss: 26627037.2000; val_optim_loss: 26627037.2000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9866; val_auprc_score: 0.9815; val_best_acc_score: 0.9510; val_best_f1_score: 0.9522; train_kl_reg_loss: 57827.5175; train_edge_recon_loss: 2648646.3435; train_gene_expr_recon_loss: 12045099.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28251.4825; train_chrom_access_recon_loss: 11067776.0000; train_global_loss: 25847600.9160; train_optim_loss: 25847600.9160; val_kl_reg_loss: 57972.8242; val_edge_recon_loss: 2657266.1000; val_gene_expr_recon_loss: 12324809.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28217.8652; val_chrom_access_recon_loss: 11527424.8667; val_global_loss: 26595690.9333; val_optim_loss: 26595690.9333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9870; val_auprc_score: 0.9820; val_best_acc_score: 0.9545; val_best_f1_score: 0.9550; train_kl_reg_loss: 57724.6096; train_edge_recon_loss: 2650864.4523; train_gene_expr_recon_loss: 12046698.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28188.2595; train_chrom_access_recon_loss: 11064431.9695; train_global_loss: 25847908.1527; train_optim_loss: 25847908.1527; val_kl_reg_loss: 57376.1781; val_edge_recon_loss: 2658054.4833; val_gene_expr_recon_loss: 12346857.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28148.7188; val_chrom_access_recon_loss: 11599663.8667; val_global_loss: 26690101.3333; val_optim_loss: 26690101.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9868; val_auprc_score: 0.9820; val_best_acc_score: 0.9500; val_best_f1_score: 0.9508; train_kl_reg_loss: 57393.5103; train_edge_recon_loss: 2651987.8607; train_gene_expr_recon_loss: 12046123.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27474.1165; train_chrom_access_recon_loss: 11060441.8779; train_global_loss: 25843420.4275; train_optim_loss: 25843420.4275; val_kl_reg_loss: 57826.6560; val_edge_recon_loss: 2674027.3500; val_gene_expr_recon_loss: 12324845.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27331.0371; val_chrom_access_recon_loss: 11545980.8000; val_global_loss: 26630011.3333; val_optim_loss: 26630011.3333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9880; val_auprc_score: 0.9840; val_best_acc_score: 0.9531; val_best_f1_score: 0.9536; train_kl_reg_loss: 57665.5772; train_edge_recon_loss: 2653459.4790; train_gene_expr_recon_loss: 12043367.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27302.9967; train_chrom_access_recon_loss: 11059165.3359; train_global_loss: 25840960.8855; train_optim_loss: 25840960.8855; val_kl_reg_loss: 57834.0505; val_edge_recon_loss: 2659094.4167; val_gene_expr_recon_loss: 12336046.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27280.1523; val_chrom_access_recon_loss: 11583944.3333; val_global_loss: 26664199.4667; val_optim_loss: 26664199.4667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9875; val_auprc_score: 0.9831; val_best_acc_score: 0.9511; val_best_f1_score: 0.9517; train_kl_reg_loss: 57664.1661; train_edge_recon_loss: 2651153.2405; train_gene_expr_recon_loss: 12039096.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27264.2390; train_chrom_access_recon_loss: 11057118.6870; train_global_loss: 25832296.7786; train_optim_loss: 25832296.7786; val_kl_reg_loss: 57928.1807; val_edge_recon_loss: 2654270.1833; val_gene_expr_recon_loss: 12331382.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27251.7812; val_chrom_access_recon_loss: 11562785.0000; val_global_loss: 26633617.3333; val_optim_loss: 26633617.3333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9871; val_auprc_score: 0.9835; val_best_acc_score: 0.9485; val_best_f1_score: 0.9498; train_kl_reg_loss: 57696.9421; train_edge_recon_loss: 2653944.2214; train_gene_expr_recon_loss: 12030916.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27238.0593; train_chrom_access_recon_loss: 11049098.7328; train_global_loss: 25818894.1527; train_optim_loss: 25818894.1527; val_kl_reg_loss: 57863.7693; val_edge_recon_loss: 2670571.3167; val_gene_expr_recon_loss: 12349994.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27227.8633; val_chrom_access_recon_loss: 11552639.0667; val_global_loss: 26658296.8000; val_optim_loss: 26658296.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 62 min 57 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9884
val AUPRC score: 0.9866
val best accuracy score: 0.9515
val best F1 score: 0.9527
val target rna MSE score: 0.9616
val source rna MSE score: 0.1956
val target atac MSE score: 0.3644
val source atac MSE score: 0.0556
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
