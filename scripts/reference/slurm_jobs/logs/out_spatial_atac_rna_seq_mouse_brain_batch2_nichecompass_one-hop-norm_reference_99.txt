[True]
Run timestamp: 07082023_202849_99.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_99']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8745; val_auprc_score: 0.8892; val_best_acc_score: 0.5132; val_best_f1_score: 0.6725; train_kl_reg_loss: 15046.4725; train_edge_recon_loss: 349840.5833; train_gene_expr_recon_loss: 1141948.2778; train_masked_gp_l1_reg_loss: 16353.8431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167205.9497; train_chrom_access_recon_loss: 724236.3264; train_global_loss: 2414631.4167; train_optim_loss: 2414631.4167; val_kl_reg_loss: 6233.1289; val_edge_recon_loss: 406467.5625; val_gene_expr_recon_loss: 1009462.3750; val_masked_gp_l1_reg_loss: 11884.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162733.7500; val_chrom_access_recon_loss: 512365.4688; val_global_loss: 2109146.7500; val_optim_loss: 2109146.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8774; val_auprc_score: 0.8920; val_best_acc_score: 0.5074; val_best_f1_score: 0.6700; train_kl_reg_loss: 8449.5787; train_edge_recon_loss: 352638.9722; train_gene_expr_recon_loss: 924044.8681; train_masked_gp_l1_reg_loss: 10210.4034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159974.9705; train_chrom_access_recon_loss: 489606.6493; train_global_loss: 1944925.4444; train_optim_loss: 1944925.4444; val_kl_reg_loss: 12719.5508; val_edge_recon_loss: 406541.5000; val_gene_expr_recon_loss: 833795.4375; val_masked_gp_l1_reg_loss: 9108.5020; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156478.2969; val_chrom_access_recon_loss: 469374.7500; val_global_loss: 1888018.0000; val_optim_loss: 1888018.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8763; val_auprc_score: 0.8885; val_best_acc_score: 0.5141; val_best_f1_score: 0.6730; train_kl_reg_loss: 14634.6497; train_edge_recon_loss: 356939.1979; train_gene_expr_recon_loss: 807048.3333; train_masked_gp_l1_reg_loss: 9350.9591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153295.0660; train_chrom_access_recon_loss: 465625.7257; train_global_loss: 1806893.9028; train_optim_loss: 1806893.9028; val_kl_reg_loss: 13810.6602; val_edge_recon_loss: 406496.9375; val_gene_expr_recon_loss: 780249.3750; val_masked_gp_l1_reg_loss: 9535.1689; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149007.0781; val_chrom_access_recon_loss: 454977.7812; val_global_loss: 1814077.0000; val_optim_loss: 1814077.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8807; val_auprc_score: 0.8888; val_best_acc_score: 0.5182; val_best_f1_score: 0.6744; train_kl_reg_loss: 15589.8811; train_edge_recon_loss: 356624.0903; train_gene_expr_recon_loss: 767668.8056; train_masked_gp_l1_reg_loss: 9481.4870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145234.9983; train_chrom_access_recon_loss: 455618.6389; train_global_loss: 1750217.8750; train_optim_loss: 1750217.8750; val_kl_reg_loss: 17108.2461; val_edge_recon_loss: 406450.0938; val_gene_expr_recon_loss: 745883.3750; val_masked_gp_l1_reg_loss: 9470.2295; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140375.9062; val_chrom_access_recon_loss: 450077.5938; val_global_loss: 1769365.5000; val_optim_loss: 1769365.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8882; val_auprc_score: 0.8911; val_best_acc_score: 0.5245; val_best_f1_score: 0.6758; train_kl_reg_loss: 17907.8661; train_edge_recon_loss: 357872.1250; train_gene_expr_recon_loss: 740152.9097; train_masked_gp_l1_reg_loss: 9468.6461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136302.1823; train_chrom_access_recon_loss: 450263.1562; train_global_loss: 1711966.8611; train_optim_loss: 1711966.8611; val_kl_reg_loss: 18007.8477; val_edge_recon_loss: 406273.0000; val_gene_expr_recon_loss: 724590.0000; val_masked_gp_l1_reg_loss: 9447.7939; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131145.8438; val_chrom_access_recon_loss: 446026.4062; val_global_loss: 1735490.8750; val_optim_loss: 1735490.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8836; val_auprc_score: 0.8817; val_best_acc_score: 0.5575; val_best_f1_score: 0.6891; train_kl_reg_loss: 18663.6345; train_edge_recon_loss: 357840.2569; train_gene_expr_recon_loss: 724938.2014; train_masked_gp_l1_reg_loss: 9459.5539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126983.9991; train_chrom_access_recon_loss: 450465.8715; train_global_loss: 1688351.5694; train_optim_loss: 1688351.5694; val_kl_reg_loss: 17263.4375; val_edge_recon_loss: 405857.0938; val_gene_expr_recon_loss: 710009.2500; val_masked_gp_l1_reg_loss: 9442.4697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121789.8594; val_chrom_access_recon_loss: 443711.6250; val_global_loss: 1708073.7500; val_optim_loss: 1708073.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8740; val_auprc_score: 0.8789; val_best_acc_score: 0.6055; val_best_f1_score: 0.7106; train_kl_reg_loss: 18551.1430; train_edge_recon_loss: 358101.6319; train_gene_expr_recon_loss: 706578.2986; train_masked_gp_l1_reg_loss: 9434.5701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117700.4323; train_chrom_access_recon_loss: 448626.4340; train_global_loss: 1658992.4722; train_optim_loss: 1658992.4722; val_kl_reg_loss: 17901.9922; val_edge_recon_loss: 405361.8438; val_gene_expr_recon_loss: 697697.3125; val_masked_gp_l1_reg_loss: 9403.3037; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112636.3672; val_chrom_access_recon_loss: 441666.5000; val_global_loss: 1684667.2500; val_optim_loss: 1684667.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8592; val_auprc_score: 0.8632; val_best_acc_score: 0.6505; val_best_f1_score: 0.7309; train_kl_reg_loss: 19308.0441; train_edge_recon_loss: 357472.7465; train_gene_expr_recon_loss: 700191.2014; train_masked_gp_l1_reg_loss: 9381.5139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108712.4887; train_chrom_access_recon_loss: 445571.3785; train_global_loss: 1640637.4028; train_optim_loss: 1640637.4028; val_kl_reg_loss: 18764.7441; val_edge_recon_loss: 404519.1562; val_gene_expr_recon_loss: 689039.0000; val_masked_gp_l1_reg_loss: 9351.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103888.0000; val_chrom_access_recon_loss: 439970.4062; val_global_loss: 1665532.5000; val_optim_loss: 1665532.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8439; val_auprc_score: 0.8483; val_best_acc_score: 0.7231; val_best_f1_score: 0.7639; train_kl_reg_loss: 19389.2780; train_edge_recon_loss: 357229.0486; train_gene_expr_recon_loss: 690961.6597; train_masked_gp_l1_reg_loss: 9342.0552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100189.4957; train_chrom_access_recon_loss: 442805.1181; train_global_loss: 1619916.6111; train_optim_loss: 1619916.6111; val_kl_reg_loss: 17970.7461; val_edge_recon_loss: 403087.3750; val_gene_expr_recon_loss: 683068.0625; val_masked_gp_l1_reg_loss: 9315.7676; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95671.9531; val_chrom_access_recon_loss: 438612.7812; val_global_loss: 1647726.7500; val_optim_loss: 1647726.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8493; val_auprc_score: 0.8525; val_best_acc_score: 0.7705; val_best_f1_score: 0.7738; train_kl_reg_loss: 19151.4998; train_edge_recon_loss: 356445.9306; train_gene_expr_recon_loss: 687089.9583; train_masked_gp_l1_reg_loss: 9306.2701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92236.7517; train_chrom_access_recon_loss: 442758.3646; train_global_loss: 1606988.7500; train_optim_loss: 1606988.7500; val_kl_reg_loss: 17459.0898; val_edge_recon_loss: 399829.5938; val_gene_expr_recon_loss: 678583.1250; val_masked_gp_l1_reg_loss: 9283.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88052.4141; val_chrom_access_recon_loss: 437576.1250; val_global_loss: 1630783.8750; val_optim_loss: 1630783.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8441; val_auprc_score: 0.8418; val_best_acc_score: 0.7542; val_best_f1_score: 0.7557; train_kl_reg_loss: 18906.6395; train_edge_recon_loss: 355564.1562; train_gene_expr_recon_loss: 682784.5278; train_masked_gp_l1_reg_loss: 9283.5219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84915.4757; train_chrom_access_recon_loss: 441218.8125; train_global_loss: 1592673.0972; train_optim_loss: 1592673.0972; val_kl_reg_loss: 18483.5938; val_edge_recon_loss: 395807.7188; val_gene_expr_recon_loss: 673856.6250; val_masked_gp_l1_reg_loss: 9271.6396; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81116.8594; val_chrom_access_recon_loss: 436460.0625; val_global_loss: 1614996.5000; val_optim_loss: 1614996.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8516; val_auprc_score: 0.8469; val_best_acc_score: 0.7451; val_best_f1_score: 0.7769; train_kl_reg_loss: 18805.8420; train_edge_recon_loss: 353827.1042; train_gene_expr_recon_loss: 680422.8403; train_masked_gp_l1_reg_loss: 9275.8391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78284.4089; train_chrom_access_recon_loss: 440289.1597; train_global_loss: 1580905.1944; train_optim_loss: 1580905.1944; val_kl_reg_loss: 18940.3828; val_edge_recon_loss: 390077.3438; val_gene_expr_recon_loss: 671700.2500; val_masked_gp_l1_reg_loss: 9279.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74860.7500; val_chrom_access_recon_loss: 435548.3750; val_global_loss: 1600407.1250; val_optim_loss: 1600407.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8640; val_auprc_score: 0.8615; val_best_acc_score: 0.7828; val_best_f1_score: 0.7874; train_kl_reg_loss: 18507.1734; train_edge_recon_loss: 351507.4444; train_gene_expr_recon_loss: 677839.4306; train_masked_gp_l1_reg_loss: 9295.5227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72318.1033; train_chrom_access_recon_loss: 438808.5660; train_global_loss: 1568276.2361; train_optim_loss: 1568276.2361; val_kl_reg_loss: 17835.8086; val_edge_recon_loss: 381499.3438; val_gene_expr_recon_loss: 668658.8750; val_masked_gp_l1_reg_loss: 9305.2256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69245.0469; val_chrom_access_recon_loss: 434658.6562; val_global_loss: 1581202.8750; val_optim_loss: 1581202.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8709; val_auprc_score: 0.8660; val_best_acc_score: 0.7897; val_best_f1_score: 0.7999; train_kl_reg_loss: 18107.9395; train_edge_recon_loss: 347813.9514; train_gene_expr_recon_loss: 673933.2569; train_masked_gp_l1_reg_loss: 9326.3342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66962.4844; train_chrom_access_recon_loss: 439101.5590; train_global_loss: 1555245.5139; train_optim_loss: 1555245.5139; val_kl_reg_loss: 16936.2070; val_edge_recon_loss: 366766.9062; val_gene_expr_recon_loss: 668940.2500; val_masked_gp_l1_reg_loss: 9336.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64185.1172; val_chrom_access_recon_loss: 434097.5625; val_global_loss: 1560262.5000; val_optim_loss: 1560262.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8795; val_auprc_score: 0.8777; val_best_acc_score: 0.7921; val_best_f1_score: 0.8012; train_kl_reg_loss: 17962.1602; train_edge_recon_loss: 341236.7500; train_gene_expr_recon_loss: 673491.2847; train_masked_gp_l1_reg_loss: 9358.5212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62132.7370; train_chrom_access_recon_loss: 438814.6667; train_global_loss: 1542996.1111; train_optim_loss: 1542996.1111; val_kl_reg_loss: 17780.3281; val_edge_recon_loss: 350474.9688; val_gene_expr_recon_loss: 667880.5000; val_masked_gp_l1_reg_loss: 9377.8447; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59637.7930; val_chrom_access_recon_loss: 433493.7500; val_global_loss: 1538645.2500; val_optim_loss: 1538645.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8852; val_auprc_score: 0.8829; val_best_acc_score: 0.7990; val_best_f1_score: 0.8047; train_kl_reg_loss: 19522.0069; train_edge_recon_loss: 330780.3958; train_gene_expr_recon_loss: 671595.0000; train_masked_gp_l1_reg_loss: 9407.5882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57784.8815; train_chrom_access_recon_loss: 437381.2118; train_global_loss: 1526471.0833; train_optim_loss: 1526471.0833; val_kl_reg_loss: 21023.8398; val_edge_recon_loss: 330300.5938; val_gene_expr_recon_loss: 668008.0000; val_masked_gp_l1_reg_loss: 9451.9150; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55538.4727; val_chrom_access_recon_loss: 433165.5625; val_global_loss: 1517488.5000; val_optim_loss: 1517488.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9012; val_auprc_score: 0.8953; val_best_acc_score: 0.8169; val_best_f1_score: 0.8194; train_kl_reg_loss: 24191.0853; train_edge_recon_loss: 317175.2986; train_gene_expr_recon_loss: 668152.6597; train_masked_gp_l1_reg_loss: 9494.8028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53873.3303; train_chrom_access_recon_loss: 436652.2083; train_global_loss: 1509539.4028; train_optim_loss: 1509539.4028; val_kl_reg_loss: 26184.9199; val_edge_recon_loss: 312495.3438; val_gene_expr_recon_loss: 666608.7500; val_masked_gp_l1_reg_loss: 9541.9551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51843.4375; val_chrom_access_recon_loss: 432454.9375; val_global_loss: 1499129.2500; val_optim_loss: 1499129.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9178; val_auprc_score: 0.9076; val_best_acc_score: 0.8403; val_best_f1_score: 0.8445; train_kl_reg_loss: 27568.1571; train_edge_recon_loss: 308404.5174; train_gene_expr_recon_loss: 671108.3889; train_masked_gp_l1_reg_loss: 9580.7214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50336.9792; train_chrom_access_recon_loss: 435634.1146; train_global_loss: 1502632.8611; train_optim_loss: 1502632.8611; val_kl_reg_loss: 26460.0508; val_edge_recon_loss: 307588.9688; val_gene_expr_recon_loss: 664382.1250; val_masked_gp_l1_reg_loss: 9628.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48503.7969; val_chrom_access_recon_loss: 431702.2500; val_global_loss: 1488266.0000; val_optim_loss: 1488266.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9294; val_auprc_score: 0.9167; val_best_acc_score: 0.8615; val_best_f1_score: 0.8643; train_kl_reg_loss: 26731.7216; train_edge_recon_loss: 304842.6701; train_gene_expr_recon_loss: 669972.2986; train_masked_gp_l1_reg_loss: 9666.9199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47137.6914; train_chrom_access_recon_loss: 436992.3472; train_global_loss: 1495343.6944; train_optim_loss: 1495343.6944; val_kl_reg_loss: 25449.5449; val_edge_recon_loss: 305640.1562; val_gene_expr_recon_loss: 663556.5000; val_masked_gp_l1_reg_loss: 9707.3105; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45458.6719; val_chrom_access_recon_loss: 431116.6562; val_global_loss: 1480928.7500; val_optim_loss: 1480928.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9382; val_auprc_score: 0.9266; val_best_acc_score: 0.8696; val_best_f1_score: 0.8747; train_kl_reg_loss: 26432.6660; train_edge_recon_loss: 300285.3819; train_gene_expr_recon_loss: 665217.2778; train_masked_gp_l1_reg_loss: 9745.4594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44212.1957; train_chrom_access_recon_loss: 434623.1424; train_global_loss: 1480516.1250; train_optim_loss: 1480516.1250; val_kl_reg_loss: 26423.3125; val_edge_recon_loss: 298623.5938; val_gene_expr_recon_loss: 661097.2500; val_masked_gp_l1_reg_loss: 9776.8418; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42686.8828; val_chrom_access_recon_loss: 430213.7812; val_global_loss: 1468821.6250; val_optim_loss: 1468821.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9449; val_auprc_score: 0.9336; val_best_acc_score: 0.8812; val_best_f1_score: 0.8846; train_kl_reg_loss: 27129.6671; train_edge_recon_loss: 297151.7639; train_gene_expr_recon_loss: 663381.5208; train_masked_gp_l1_reg_loss: 9794.4007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41541.6780; train_chrom_access_recon_loss: 434006.2049; train_global_loss: 1473005.2083; train_optim_loss: 1473005.2083; val_kl_reg_loss: 25983.7715; val_edge_recon_loss: 294536.0000; val_gene_expr_recon_loss: 661176.2500; val_masked_gp_l1_reg_loss: 9810.3604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40140.3047; val_chrom_access_recon_loss: 429820.1250; val_global_loss: 1461466.7500; val_optim_loss: 1461466.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9469; val_auprc_score: 0.9350; val_best_acc_score: 0.8806; val_best_f1_score: 0.8855; train_kl_reg_loss: 26989.1228; train_edge_recon_loss: 296070.4931; train_gene_expr_recon_loss: 660781.6250; train_masked_gp_l1_reg_loss: 9829.4680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39094.2843; train_chrom_access_recon_loss: 433234.9375; train_global_loss: 1465999.9167; train_optim_loss: 1465999.9167; val_kl_reg_loss: 26510.1934; val_edge_recon_loss: 294213.4688; val_gene_expr_recon_loss: 657896.3750; val_masked_gp_l1_reg_loss: 9845.1543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37815.0039; val_chrom_access_recon_loss: 428747.8125; val_global_loss: 1455028.0000; val_optim_loss: 1455028.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9474; val_auprc_score: 0.9384; val_best_acc_score: 0.8821; val_best_f1_score: 0.8842; train_kl_reg_loss: 26926.8917; train_edge_recon_loss: 294126.6875; train_gene_expr_recon_loss: 659483.6181; train_masked_gp_l1_reg_loss: 9854.8823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36860.4583; train_chrom_access_recon_loss: 432861.0694; train_global_loss: 1460113.5972; train_optim_loss: 1460113.5972; val_kl_reg_loss: 26746.3203; val_edge_recon_loss: 294972.2812; val_gene_expr_recon_loss: 657624.8750; val_masked_gp_l1_reg_loss: 9870.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35686.0586; val_chrom_access_recon_loss: 428180.8750; val_global_loss: 1453081.2500; val_optim_loss: 1453081.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9446; val_auprc_score: 0.9277; val_best_acc_score: 0.8812; val_best_f1_score: 0.8865; train_kl_reg_loss: 27083.4475; train_edge_recon_loss: 294468.3299; train_gene_expr_recon_loss: 658767.7292; train_masked_gp_l1_reg_loss: 9882.2183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34809.5369; train_chrom_access_recon_loss: 432155.4688; train_global_loss: 1457166.7361; train_optim_loss: 1457166.7361; val_kl_reg_loss: 26127.7129; val_edge_recon_loss: 293755.1250; val_gene_expr_recon_loss: 655798.1250; val_masked_gp_l1_reg_loss: 9897.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33730.5312; val_chrom_access_recon_loss: 427387.2188; val_global_loss: 1446696.2500; val_optim_loss: 1446696.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9535; val_auprc_score: 0.9438; val_best_acc_score: 0.8905; val_best_f1_score: 0.8930; train_kl_reg_loss: 26720.8283; train_edge_recon_loss: 293215.9722; train_gene_expr_recon_loss: 658607.0000; train_masked_gp_l1_reg_loss: 9908.4029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32925.5443; train_chrom_access_recon_loss: 432254.1250; train_global_loss: 1453631.8750; train_optim_loss: 1453631.8750; val_kl_reg_loss: 26528.0977; val_edge_recon_loss: 293198.1562; val_gene_expr_recon_loss: 655040.0000; val_masked_gp_l1_reg_loss: 9927.7158; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31928.2461; val_chrom_access_recon_loss: 426507.0938; val_global_loss: 1443129.2500; val_optim_loss: 1443129.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9453; val_auprc_score: 0.9323; val_best_acc_score: 0.8802; val_best_f1_score: 0.8828; train_kl_reg_loss: 24491.2708; train_edge_recon_loss: 297974.8854; train_gene_expr_recon_loss: 956945.3125; train_masked_gp_l1_reg_loss: 10053.4961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31022.4349; train_chrom_access_recon_loss: 455099.3229; train_global_loss: 1775586.7083; train_optim_loss: 1775586.7083; val_kl_reg_loss: 12975.9355; val_edge_recon_loss: 296655.2812; val_gene_expr_recon_loss: 950539.0625; val_masked_gp_l1_reg_loss: 10286.2451; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29803.3203; val_chrom_access_recon_loss: 451336.4375; val_global_loss: 1751596.2500; val_optim_loss: 1751596.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9485; val_auprc_score: 0.9383; val_best_acc_score: 0.8851; val_best_f1_score: 0.8869; train_kl_reg_loss: 22895.1291; train_edge_recon_loss: 292992.9028; train_gene_expr_recon_loss: 958336.9167; train_masked_gp_l1_reg_loss: 10526.3930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28801.9742; train_chrom_access_recon_loss: 455605.5729; train_global_loss: 1769158.8611; train_optim_loss: 1769158.8611; val_kl_reg_loss: 13374.7344; val_edge_recon_loss: 293630.5312; val_gene_expr_recon_loss: 946003.1250; val_masked_gp_l1_reg_loss: 10821.0957; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27569.4922; val_chrom_access_recon_loss: 450738.2812; val_global_loss: 1742137.2500; val_optim_loss: 1742137.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9546; val_auprc_score: 0.9429; val_best_acc_score: 0.8967; val_best_f1_score: 0.8994; train_kl_reg_loss: 20855.0946; train_edge_recon_loss: 290903.6632; train_gene_expr_recon_loss: 949920.3542; train_masked_gp_l1_reg_loss: 11030.2247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26630.9468; train_chrom_access_recon_loss: 453324.9722; train_global_loss: 1752665.2500; train_optim_loss: 1752665.2500; val_kl_reg_loss: 14164.7979; val_edge_recon_loss: 288030.1562; val_gene_expr_recon_loss: 941849.2500; val_masked_gp_l1_reg_loss: 11267.1270; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25489.5078; val_chrom_access_recon_loss: 450232.6562; val_global_loss: 1731033.5000; val_optim_loss: 1731033.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9504; val_auprc_score: 0.9396; val_best_acc_score: 0.8866; val_best_f1_score: 0.8904; train_kl_reg_loss: 19847.8305; train_edge_recon_loss: 288635.3542; train_gene_expr_recon_loss: 943529.4375; train_masked_gp_l1_reg_loss: 11429.6493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24637.9800; train_chrom_access_recon_loss: 452268.2257; train_global_loss: 1740348.5000; train_optim_loss: 1740348.5000; val_kl_reg_loss: 15402.8555; val_edge_recon_loss: 291253.5312; val_gene_expr_recon_loss: 937366.6250; val_masked_gp_l1_reg_loss: 11616.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23611.4668; val_chrom_access_recon_loss: 449546.3750; val_global_loss: 1728797.6250; val_optim_loss: 1728797.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9537; val_auprc_score: 0.9379; val_best_acc_score: 0.8971; val_best_f1_score: 0.9000; train_kl_reg_loss: 19776.7055; train_edge_recon_loss: 286571.1389; train_gene_expr_recon_loss: 944255.6181; train_masked_gp_l1_reg_loss: 11554.7714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23442.5571; train_chrom_access_recon_loss: 453584.0729; train_global_loss: 1739184.9028; train_optim_loss: 1739184.9028; val_kl_reg_loss: 15490.3359; val_edge_recon_loss: 286487.0000; val_gene_expr_recon_loss: 936262.1875; val_masked_gp_l1_reg_loss: 11506.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23257.5703; val_chrom_access_recon_loss: 449550.7812; val_global_loss: 1722554.2500; val_optim_loss: 1722554.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9505; val_auprc_score: 0.9376; val_best_acc_score: 0.8906; val_best_f1_score: 0.8944; train_kl_reg_loss: 19750.2457; train_edge_recon_loss: 287442.3160; train_gene_expr_recon_loss: 939032.8750; train_masked_gp_l1_reg_loss: 11501.7086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23150.3767; train_chrom_access_recon_loss: 452293.7951; train_global_loss: 1733171.3194; train_optim_loss: 1733171.3194; val_kl_reg_loss: 15645.3633; val_edge_recon_loss: 290593.1250; val_gene_expr_recon_loss: 935639.7500; val_masked_gp_l1_reg_loss: 11488.4268; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23010.7695; val_chrom_access_recon_loss: 449352.3438; val_global_loss: 1725729.7500; val_optim_loss: 1725729.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9564; val_auprc_score: 0.9464; val_best_acc_score: 0.8929; val_best_f1_score: 0.8964; train_kl_reg_loss: 19526.9219; train_edge_recon_loss: 287131.9618; train_gene_expr_recon_loss: 938311.4097; train_masked_gp_l1_reg_loss: 11484.7650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22910.2424; train_chrom_access_recon_loss: 452015.8646; train_global_loss: 1731381.1250; train_optim_loss: 1731381.1250; val_kl_reg_loss: 15494.9805; val_edge_recon_loss: 288748.1562; val_gene_expr_recon_loss: 935659.1250; val_masked_gp_l1_reg_loss: 11482.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22787.8105; val_chrom_access_recon_loss: 449443.0312; val_global_loss: 1723615.2500; val_optim_loss: 1723615.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9542; val_auprc_score: 0.9398; val_best_acc_score: 0.8998; val_best_f1_score: 0.9024; train_kl_reg_loss: 19474.2129; train_edge_recon_loss: 287201.7014; train_gene_expr_recon_loss: 938221.7986; train_masked_gp_l1_reg_loss: 11483.0573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22694.8941; train_chrom_access_recon_loss: 453128.9410; train_global_loss: 1732204.5694; train_optim_loss: 1732204.5694; val_kl_reg_loss: 15631.5732; val_edge_recon_loss: 288789.0312; val_gene_expr_recon_loss: 935067.9375; val_masked_gp_l1_reg_loss: 11486.2100; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22583.5332; val_chrom_access_recon_loss: 449238.8125; val_global_loss: 1722797.0000; val_optim_loss: 1722797.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9446
val AUPRC score: 0.9301
val best accuracy score: 0.8798
val best F1 score: 0.8842
val target rna MSE score: 3.7736
val source rna MSE score: 3.1057
val target atac MSE score: 0.1331
val source atac MSE score: 0.0209
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
