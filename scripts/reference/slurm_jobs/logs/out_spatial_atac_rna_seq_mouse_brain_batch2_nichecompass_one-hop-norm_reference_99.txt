[True]
Run timestamp: 10102023_011235_99.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_99']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6547; val_auprc_score: 0.6308; val_best_acc_score: 0.5043; val_best_f1_score: 0.6685; train_kl_reg_loss: 43408.6204; train_edge_recon_loss: 3504390.9773; train_gene_expr_recon_loss: 13998785.2121; train_masked_gp_l1_reg_loss: 33031.8842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3632559.1080; train_chrom_access_recon_loss: 4959438.9091; train_global_loss: 26171614.7576; train_optim_loss: 26171614.7576; val_kl_reg_loss: 100434.5703; val_edge_recon_loss: 4064805.6562; val_gene_expr_recon_loss: 13193249.8750; val_masked_gp_l1_reg_loss: 39543.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1999896.3750; val_chrom_access_recon_loss: 4813453.3750; val_global_loss: 24211383.2500; val_optim_loss: 24211383.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7088; val_auprc_score: 0.6850; val_best_acc_score: 0.5965; val_best_f1_score: 0.7044; train_kl_reg_loss: 90482.9196; train_edge_recon_loss: 3515496.0379; train_gene_expr_recon_loss: 12810772.2424; train_masked_gp_l1_reg_loss: 41006.0814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1081830.5019; train_chrom_access_recon_loss: 4731205.6061; train_global_loss: 22270793.3333; train_optim_loss: 22270793.3333; val_kl_reg_loss: 108350.6230; val_edge_recon_loss: 4060581.6562; val_gene_expr_recon_loss: 12895894.7500; val_masked_gp_l1_reg_loss: 42574.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 521775.3438; val_chrom_access_recon_loss: 4777657.2500; val_global_loss: 22406833.5000; val_optim_loss: 22406833.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7612; val_auprc_score: 0.7489; val_best_acc_score: 0.6784; val_best_f1_score: 0.7114; train_kl_reg_loss: 84091.8134; train_edge_recon_loss: 3508276.2273; train_gene_expr_recon_loss: 12651509.7424; train_masked_gp_l1_reg_loss: 43605.3129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 351871.3835; train_chrom_access_recon_loss: 4691979.6212; train_global_loss: 21331334.2727; train_optim_loss: 21331334.2727; val_kl_reg_loss: 85014.6562; val_edge_recon_loss: 4019047.9688; val_gene_expr_recon_loss: 12841789.6250; val_masked_gp_l1_reg_loss: 44726.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 242306.5000; val_chrom_access_recon_loss: 4752404.0000; val_global_loss: 21985289.2500; val_optim_loss: 21985289.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8388; val_auprc_score: 0.8246; val_best_acc_score: 0.7534; val_best_f1_score: 0.7728; train_kl_reg_loss: 66820.3952; train_edge_recon_loss: 3449968.8902; train_gene_expr_recon_loss: 12575612.7576; train_masked_gp_l1_reg_loss: 46277.2535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 193141.3281; train_chrom_access_recon_loss: 4673369.6364; train_global_loss: 21005190.2121; train_optim_loss: 21005190.2121; val_kl_reg_loss: 57220.6187; val_edge_recon_loss: 3375744.9688; val_gene_expr_recon_loss: 12692059.3750; val_masked_gp_l1_reg_loss: 48166.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155594.3594; val_chrom_access_recon_loss: 4735529.8125; val_global_loss: 21064315.5000; val_optim_loss: 21064315.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8863; val_auprc_score: 0.8624; val_best_acc_score: 0.8152; val_best_f1_score: 0.8326; train_kl_reg_loss: 82435.3445; train_edge_recon_loss: 2993361.3902; train_gene_expr_recon_loss: 12532308.0000; train_masked_gp_l1_reg_loss: 51175.8467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133254.5097; train_chrom_access_recon_loss: 4648291.3788; train_global_loss: 20440826.6061; train_optim_loss: 20440826.6061; val_kl_reg_loss: 99107.3350; val_edge_recon_loss: 2872454.0938; val_gene_expr_recon_loss: 12575377.5000; val_masked_gp_l1_reg_loss: 53493.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116922.1406; val_chrom_access_recon_loss: 4644861.6875; val_global_loss: 20362216.2500; val_optim_loss: 20362216.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8873; val_auprc_score: 0.8562; val_best_acc_score: 0.8200; val_best_f1_score: 0.8349; train_kl_reg_loss: 98942.4510; train_edge_recon_loss: 2861804.2462; train_gene_expr_recon_loss: 12434140.7424; train_masked_gp_l1_reg_loss: 54834.1239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109795.2978; train_chrom_access_recon_loss: 4614555.9924; train_global_loss: 20174072.9091; train_optim_loss: 20174072.9091; val_kl_reg_loss: 103735.5732; val_edge_recon_loss: 2865271.1562; val_gene_expr_recon_loss: 12578443.5000; val_masked_gp_l1_reg_loss: 56139.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103918.5547; val_chrom_access_recon_loss: 4649888.6875; val_global_loss: 20357398.2500; val_optim_loss: 20357398.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8989; val_auprc_score: 0.8738; val_best_acc_score: 0.8272; val_best_f1_score: 0.8426; train_kl_reg_loss: 99049.2732; train_edge_recon_loss: 2826586.7992; train_gene_expr_recon_loss: 12337124.7121; train_masked_gp_l1_reg_loss: 57329.6558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100534.7849; train_chrom_access_recon_loss: 4588552.6667; train_global_loss: 20009177.9091; train_optim_loss: 20009177.9091; val_kl_reg_loss: 97933.1895; val_edge_recon_loss: 2844546.2500; val_gene_expr_recon_loss: 12379765.5000; val_masked_gp_l1_reg_loss: 58399.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97372.9609; val_chrom_access_recon_loss: 4568920.0938; val_global_loss: 20046936.7500; val_optim_loss: 20046936.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8931; val_auprc_score: 0.8568; val_best_acc_score: 0.8361; val_best_f1_score: 0.8501; train_kl_reg_loss: 96504.5030; train_edge_recon_loss: 2807927.6023; train_gene_expr_recon_loss: 12273581.2879; train_masked_gp_l1_reg_loss: 59390.5838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94522.9160; train_chrom_access_recon_loss: 4574645.5530; train_global_loss: 19906572.3333; train_optim_loss: 19906572.3333; val_kl_reg_loss: 95168.7109; val_edge_recon_loss: 2854308.5000; val_gene_expr_recon_loss: 12413246.0000; val_masked_gp_l1_reg_loss: 60462.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91884.2266; val_chrom_access_recon_loss: 4639128.0000; val_global_loss: 20154198.0000; val_optim_loss: 20154198.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9065; val_auprc_score: 0.8808; val_best_acc_score: 0.8383; val_best_f1_score: 0.8512; train_kl_reg_loss: 96931.5227; train_edge_recon_loss: 2800529.1439; train_gene_expr_recon_loss: 12217000.4091; train_masked_gp_l1_reg_loss: 61271.8290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89328.5128; train_chrom_access_recon_loss: 4555934.9394; train_global_loss: 19820996.3030; train_optim_loss: 19820996.3030; val_kl_reg_loss: 90749.3721; val_edge_recon_loss: 2810677.8125; val_gene_expr_recon_loss: 12306592.0000; val_masked_gp_l1_reg_loss: 62007.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86678.4766; val_chrom_access_recon_loss: 4604713.0000; val_global_loss: 19961417.2500; val_optim_loss: 19961417.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9150; val_auprc_score: 0.8852; val_best_acc_score: 0.8541; val_best_f1_score: 0.8635; train_kl_reg_loss: 90131.0773; train_edge_recon_loss: 2788190.4621; train_gene_expr_recon_loss: 12182808.5909; train_masked_gp_l1_reg_loss: 62904.6178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85134.2726; train_chrom_access_recon_loss: 4540635.7197; train_global_loss: 19749804.7273; train_optim_loss: 19749804.7273; val_kl_reg_loss: 95039.6270; val_edge_recon_loss: 2779638.1875; val_gene_expr_recon_loss: 12292367.0000; val_masked_gp_l1_reg_loss: 63578.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83455.1484; val_chrom_access_recon_loss: 4588853.6875; val_global_loss: 19902932.0000; val_optim_loss: 19902932.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9036; val_auprc_score: 0.8753; val_best_acc_score: 0.8431; val_best_f1_score: 0.8522; train_kl_reg_loss: 90062.2934; train_edge_recon_loss: 2799698.3561; train_gene_expr_recon_loss: 12126901.4091; train_masked_gp_l1_reg_loss: 64214.5956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81952.2119; train_chrom_access_recon_loss: 4525942.3220; train_global_loss: 19688771.1212; train_optim_loss: 19688771.1212; val_kl_reg_loss: 91225.2754; val_edge_recon_loss: 2865514.8750; val_gene_expr_recon_loss: 12186360.8750; val_masked_gp_l1_reg_loss: 64960.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81434.8906; val_chrom_access_recon_loss: 4545383.3125; val_global_loss: 19834880.5000; val_optim_loss: 19834880.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9184; val_auprc_score: 0.8931; val_best_acc_score: 0.8525; val_best_f1_score: 0.8614; train_kl_reg_loss: 87227.4536; train_edge_recon_loss: 2781720.7765; train_gene_expr_recon_loss: 12069281.2879; train_masked_gp_l1_reg_loss: 65578.7563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79981.1191; train_chrom_access_recon_loss: 4503773.8864; train_global_loss: 19587563.3333; train_optim_loss: 19587563.3333; val_kl_reg_loss: 88733.2354; val_edge_recon_loss: 2793475.4688; val_gene_expr_recon_loss: 12240239.6250; val_masked_gp_l1_reg_loss: 66144.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78640.9297; val_chrom_access_recon_loss: 4534682.7500; val_global_loss: 19801916.2500; val_optim_loss: 19801916.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9169; val_auprc_score: 0.8850; val_best_acc_score: 0.8624; val_best_f1_score: 0.8705; train_kl_reg_loss: 87311.0906; train_edge_recon_loss: 2773479.7689; train_gene_expr_recon_loss: 12039694.5303; train_masked_gp_l1_reg_loss: 66684.5254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77944.4496; train_chrom_access_recon_loss: 4491899.1667; train_global_loss: 19537013.3939; train_optim_loss: 19537013.3939; val_kl_reg_loss: 89674.7764; val_edge_recon_loss: 2788541.0000; val_gene_expr_recon_loss: 12179874.7500; val_masked_gp_l1_reg_loss: 67263.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78317.6172; val_chrom_access_recon_loss: 4509153.5000; val_global_loss: 19712826.2500; val_optim_loss: 19712826.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9223; val_auprc_score: 0.8961; val_best_acc_score: 0.8611; val_best_f1_score: 0.8697; train_kl_reg_loss: 84510.5344; train_edge_recon_loss: 2773921.1780; train_gene_expr_recon_loss: 12001808.5303; train_masked_gp_l1_reg_loss: 67829.2538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77308.9989; train_chrom_access_recon_loss: 4480321.7500; train_global_loss: 19485700.4848; train_optim_loss: 19485700.4848; val_kl_reg_loss: 83667.6348; val_edge_recon_loss: 2779324.7188; val_gene_expr_recon_loss: 12164889.6250; val_masked_gp_l1_reg_loss: 68394.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76894.1016; val_chrom_access_recon_loss: 4516980.0625; val_global_loss: 19690151.2500; val_optim_loss: 19690151.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9193; val_auprc_score: 0.8922; val_best_acc_score: 0.8608; val_best_f1_score: 0.8680; train_kl_reg_loss: 83738.9906; train_edge_recon_loss: 2765071.4659; train_gene_expr_recon_loss: 11962667.1818; train_masked_gp_l1_reg_loss: 68760.1489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76123.0891; train_chrom_access_recon_loss: 4462190.5227; train_global_loss: 19418551.4242; train_optim_loss: 19418551.4242; val_kl_reg_loss: 86259.6211; val_edge_recon_loss: 2794218.3750; val_gene_expr_recon_loss: 12147396.6250; val_masked_gp_l1_reg_loss: 69238.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75358.3906; val_chrom_access_recon_loss: 4540840.3438; val_global_loss: 19713311.7500; val_optim_loss: 19713311.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9186; val_auprc_score: 0.8914; val_best_acc_score: 0.8603; val_best_f1_score: 0.8699; train_kl_reg_loss: 84838.7747; train_edge_recon_loss: 2751055.8826; train_gene_expr_recon_loss: 11922149.8333; train_masked_gp_l1_reg_loss: 69617.9587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74824.2188; train_chrom_access_recon_loss: 4446632.3485; train_global_loss: 19349119.2121; train_optim_loss: 19349119.2121; val_kl_reg_loss: 87132.5332; val_edge_recon_loss: 2802645.0625; val_gene_expr_recon_loss: 11997015.0000; val_masked_gp_l1_reg_loss: 70087.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74736.9844; val_chrom_access_recon_loss: 4467940.0000; val_global_loss: 19499557.7500; val_optim_loss: 19499557.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9231; val_auprc_score: 0.8941; val_best_acc_score: 0.8630; val_best_f1_score: 0.8723; train_kl_reg_loss: 84731.4478; train_edge_recon_loss: 2747332.9545; train_gene_expr_recon_loss: 11895927.6667; train_masked_gp_l1_reg_loss: 70394.9782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74043.8291; train_chrom_access_recon_loss: 4439606.9015; train_global_loss: 19312037.6667; train_optim_loss: 19312037.6667; val_kl_reg_loss: 84712.9805; val_edge_recon_loss: 2788302.4688; val_gene_expr_recon_loss: 12018467.3750; val_masked_gp_l1_reg_loss: 70735.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73753.1953; val_chrom_access_recon_loss: 4457562.9375; val_global_loss: 19493534.0000; val_optim_loss: 19493534.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9156; val_auprc_score: 0.8837; val_best_acc_score: 0.8584; val_best_f1_score: 0.8685; train_kl_reg_loss: 82419.6527; train_edge_recon_loss: 2737191.0568; train_gene_expr_recon_loss: 11871434.9242; train_masked_gp_l1_reg_loss: 71070.2700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73197.7063; train_chrom_access_recon_loss: 4428700.5909; train_global_loss: 19264014.2727; train_optim_loss: 19264014.2727; val_kl_reg_loss: 83855.7070; val_edge_recon_loss: 2798274.8438; val_gene_expr_recon_loss: 11915421.1250; val_masked_gp_l1_reg_loss: 71518.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73293.4766; val_chrom_access_recon_loss: 4435551.8125; val_global_loss: 19377915.7500; val_optim_loss: 19377915.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9186; val_auprc_score: 0.8881; val_best_acc_score: 0.8651; val_best_f1_score: 0.8745; train_kl_reg_loss: 80681.8593; train_edge_recon_loss: 2736189.5038; train_gene_expr_recon_loss: 11838554.0909; train_masked_gp_l1_reg_loss: 71775.0842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72676.1038; train_chrom_access_recon_loss: 4412308.7879; train_global_loss: 19212185.3333; train_optim_loss: 19212185.3333; val_kl_reg_loss: 80153.2637; val_edge_recon_loss: 2807468.7812; val_gene_expr_recon_loss: 11930065.0000; val_masked_gp_l1_reg_loss: 72002.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72246.6562; val_chrom_access_recon_loss: 4415289.8125; val_global_loss: 19377226.0000; val_optim_loss: 19377226.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9305; val_auprc_score: 0.9002; val_best_acc_score: 0.8726; val_best_f1_score: 0.8796; train_kl_reg_loss: 80639.8002; train_edge_recon_loss: 2724507.2576; train_gene_expr_recon_loss: 11817145.8182; train_masked_gp_l1_reg_loss: 72311.4313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71775.4863; train_chrom_access_recon_loss: 4402982.6250; train_global_loss: 19169362.4242; train_optim_loss: 19169362.4242; val_kl_reg_loss: 80093.7812; val_edge_recon_loss: 2795772.0938; val_gene_expr_recon_loss: 12026644.7500; val_masked_gp_l1_reg_loss: 72656.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71681.2031; val_chrom_access_recon_loss: 4471334.0000; val_global_loss: 19518181.7500; val_optim_loss: 19518181.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9363; val_auprc_score: 0.9149; val_best_acc_score: 0.8724; val_best_f1_score: 0.8797; train_kl_reg_loss: 80125.3861; train_edge_recon_loss: 2735221.4962; train_gene_expr_recon_loss: 11778841.9091; train_masked_gp_l1_reg_loss: 72925.7847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71414.3884; train_chrom_access_recon_loss: 4386062.6894; train_global_loss: 19124591.7576; train_optim_loss: 19124591.7576; val_kl_reg_loss: 79733.7656; val_edge_recon_loss: 2760152.6875; val_gene_expr_recon_loss: 11842328.1250; val_masked_gp_l1_reg_loss: 73142.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70854.0391; val_chrom_access_recon_loss: 4430956.5625; val_global_loss: 19257168.2500; val_optim_loss: 19257168.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9360; val_auprc_score: 0.9130; val_best_acc_score: 0.8821; val_best_f1_score: 0.8894; train_kl_reg_loss: 78371.2544; train_edge_recon_loss: 2720534.8182; train_gene_expr_recon_loss: 11766892.4242; train_masked_gp_l1_reg_loss: 73439.3797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70612.2704; train_chrom_access_recon_loss: 4380664.3939; train_global_loss: 19090514.6970; train_optim_loss: 19090514.6970; val_kl_reg_loss: 79549.9941; val_edge_recon_loss: 2754440.0312; val_gene_expr_recon_loss: 11932028.2500; val_masked_gp_l1_reg_loss: 73725.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70724.0078; val_chrom_access_recon_loss: 4468204.3750; val_global_loss: 19378673.2500; val_optim_loss: 19378673.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9398; val_auprc_score: 0.9116; val_best_acc_score: 0.8850; val_best_f1_score: 0.8919; train_kl_reg_loss: 78298.2631; train_edge_recon_loss: 2715188.2765; train_gene_expr_recon_loss: 11739830.1515; train_masked_gp_l1_reg_loss: 73973.3636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70351.7215; train_chrom_access_recon_loss: 4365296.4356; train_global_loss: 19042938.3030; train_optim_loss: 19042938.3030; val_kl_reg_loss: 80695.3184; val_edge_recon_loss: 2755233.3750; val_gene_expr_recon_loss: 11859614.5000; val_masked_gp_l1_reg_loss: 74240.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70345.1875; val_chrom_access_recon_loss: 4398374.8750; val_global_loss: 19238504.5000; val_optim_loss: 19238504.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9417; val_auprc_score: 0.9201; val_best_acc_score: 0.8845; val_best_f1_score: 0.8901; train_kl_reg_loss: 79110.1677; train_edge_recon_loss: 2716892.4318; train_gene_expr_recon_loss: 11714704.5303; train_masked_gp_l1_reg_loss: 74386.9806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69877.1378; train_chrom_access_recon_loss: 4352242.4356; train_global_loss: 19007213.6061; train_optim_loss: 19007213.6061; val_kl_reg_loss: 79807.1533; val_edge_recon_loss: 2753002.0000; val_gene_expr_recon_loss: 11833484.3750; val_masked_gp_l1_reg_loss: 74691.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69937.4062; val_chrom_access_recon_loss: 4396882.5000; val_global_loss: 19207804.2500; val_optim_loss: 19207804.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9369; val_auprc_score: 0.9103; val_best_acc_score: 0.8796; val_best_f1_score: 0.8867; train_kl_reg_loss: 76853.3596; train_edge_recon_loss: 2718566.2500; train_gene_expr_recon_loss: 11684441.7727; train_masked_gp_l1_reg_loss: 74904.1507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69803.7688; train_chrom_access_recon_loss: 4336785.0417; train_global_loss: 18961354.3636; train_optim_loss: 18961354.3636; val_kl_reg_loss: 78347.2129; val_edge_recon_loss: 2745299.7188; val_gene_expr_recon_loss: 11781688.5000; val_masked_gp_l1_reg_loss: 75014.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69240.1094; val_chrom_access_recon_loss: 4375507.1875; val_global_loss: 19125097.7500; val_optim_loss: 19125097.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9317; val_auprc_score: 0.9058; val_best_acc_score: 0.8780; val_best_f1_score: 0.8850; train_kl_reg_loss: 100491.9183; train_edge_recon_loss: 2838991.6970; train_gene_expr_recon_loss: 10512808.8636; train_masked_gp_l1_reg_loss: 74815.5529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65779.7152; train_chrom_access_recon_loss: 4032703.7992; train_global_loss: 17625591.5758; train_optim_loss: 17625591.5758; val_kl_reg_loss: 25754.5244; val_edge_recon_loss: 2806030.3125; val_gene_expr_recon_loss: 10560419.1250; val_masked_gp_l1_reg_loss: 74276.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66604.7969; val_chrom_access_recon_loss: 4010519.3750; val_global_loss: 17543604.5000; val_optim_loss: 17543604.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9348; val_auprc_score: 0.9092; val_best_acc_score: 0.8753; val_best_f1_score: 0.8818; train_kl_reg_loss: 78286.5920; train_edge_recon_loss: 2745580.1061; train_gene_expr_recon_loss: 10447698.2121; train_masked_gp_l1_reg_loss: 73486.8482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66826.6770; train_chrom_access_recon_loss: 3959755.4205; train_global_loss: 17371633.9091; train_optim_loss: 17371633.9091; val_kl_reg_loss: 32699.6643; val_edge_recon_loss: 2782013.0625; val_gene_expr_recon_loss: 10593846.1250; val_masked_gp_l1_reg_loss: 72711.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67011.8359; val_chrom_access_recon_loss: 4020270.9062; val_global_loss: 17568552.7500; val_optim_loss: 17568552.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9453; val_auprc_score: 0.9171; val_best_acc_score: 0.8893; val_best_f1_score: 0.8940; train_kl_reg_loss: 64442.4447; train_edge_recon_loss: 2727142.4129; train_gene_expr_recon_loss: 10431150.9545; train_masked_gp_l1_reg_loss: 71868.2580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66993.7683; train_chrom_access_recon_loss: 3954644.3144; train_global_loss: 17316242.2424; train_optim_loss: 17316242.2424; val_kl_reg_loss: 38083.8394; val_edge_recon_loss: 2704657.8750; val_gene_expr_recon_loss: 10495941.1250; val_masked_gp_l1_reg_loss: 71080.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67063.4062; val_chrom_access_recon_loss: 3979162.9062; val_global_loss: 17355989.5000; val_optim_loss: 17355989.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9450; val_auprc_score: 0.9227; val_best_acc_score: 0.8874; val_best_f1_score: 0.8915; train_kl_reg_loss: 58083.7050; train_edge_recon_loss: 2726010.5568; train_gene_expr_recon_loss: 10399280.7424; train_masked_gp_l1_reg_loss: 70380.2509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67051.1789; train_chrom_access_recon_loss: 3937830.2273; train_global_loss: 17258636.7121; train_optim_loss: 17258636.7121; val_kl_reg_loss: 38193.2622; val_edge_recon_loss: 2730394.6562; val_gene_expr_recon_loss: 10467484.8750; val_masked_gp_l1_reg_loss: 69674.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67163.3125; val_chrom_access_recon_loss: 3943738.4375; val_global_loss: 17316649.0000; val_optim_loss: 17316649.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9403; val_auprc_score: 0.9188; val_best_acc_score: 0.8804; val_best_f1_score: 0.8878; train_kl_reg_loss: 56047.1861; train_edge_recon_loss: 2716962.1591; train_gene_expr_recon_loss: 10388418.1515; train_masked_gp_l1_reg_loss: 69027.1596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66903.0470; train_chrom_access_recon_loss: 3935832.8068; train_global_loss: 17233190.5152; train_optim_loss: 17233190.5152; val_kl_reg_loss: 39871.4326; val_edge_recon_loss: 2738400.3438; val_gene_expr_recon_loss: 10485137.2500; val_masked_gp_l1_reg_loss: 68398.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67039.1016; val_chrom_access_recon_loss: 3962517.3125; val_global_loss: 17361364.2500; val_optim_loss: 17361364.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9474; val_auprc_score: 0.9249; val_best_acc_score: 0.8984; val_best_f1_score: 0.9035; train_kl_reg_loss: 54980.7258; train_edge_recon_loss: 2706189.3712; train_gene_expr_recon_loss: 10372074.9091; train_masked_gp_l1_reg_loss: 67852.5324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66839.8588; train_chrom_access_recon_loss: 3928116.3977; train_global_loss: 17196053.7121; train_optim_loss: 17196053.7121; val_kl_reg_loss: 42376.5103; val_edge_recon_loss: 2690782.4688; val_gene_expr_recon_loss: 10448265.0000; val_masked_gp_l1_reg_loss: 67277.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66676.9297; val_chrom_access_recon_loss: 3945362.2812; val_global_loss: 17260741.0000; val_optim_loss: 17260741.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9396; val_auprc_score: 0.9075; val_best_acc_score: 0.8839; val_best_f1_score: 0.8902; train_kl_reg_loss: 57253.1768; train_edge_recon_loss: 2694083.5114; train_gene_expr_recon_loss: 10359529.6515; train_masked_gp_l1_reg_loss: 66760.3384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66593.5460; train_chrom_access_recon_loss: 3925425.2689; train_global_loss: 17169645.5152; train_optim_loss: 17169645.5152; val_kl_reg_loss: 43146.2822; val_edge_recon_loss: 2745196.5938; val_gene_expr_recon_loss: 10568368.6250; val_masked_gp_l1_reg_loss: 66285.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66925.7422; val_chrom_access_recon_loss: 4014680.3438; val_global_loss: 17504603.0000; val_optim_loss: 17504603.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9466; val_auprc_score: 0.9240; val_best_acc_score: 0.8912; val_best_f1_score: 0.8952; train_kl_reg_loss: 55676.2209; train_edge_recon_loss: 2692477.5909; train_gene_expr_recon_loss: 10348975.6818; train_masked_gp_l1_reg_loss: 65869.8727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66632.6418; train_chrom_access_recon_loss: 3921537.3750; train_global_loss: 17151169.3182; train_optim_loss: 17151169.3182; val_kl_reg_loss: 44620.3726; val_edge_recon_loss: 2734853.6562; val_gene_expr_recon_loss: 10413291.6250; val_masked_gp_l1_reg_loss: 65441.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66594.9297; val_chrom_access_recon_loss: 3913887.7188; val_global_loss: 17238690.2500; val_optim_loss: 17238690.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9382; val_auprc_score: 0.9097; val_best_acc_score: 0.8794; val_best_f1_score: 0.8873; train_kl_reg_loss: 53902.3176; train_edge_recon_loss: 2696138.7955; train_gene_expr_recon_loss: 10334896.0758; train_masked_gp_l1_reg_loss: 65096.6608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66539.5773; train_chrom_access_recon_loss: 3915287.8674; train_global_loss: 17131861.3030; train_optim_loss: 17131861.3030; val_kl_reg_loss: 44706.2788; val_edge_recon_loss: 2740453.0000; val_gene_expr_recon_loss: 10340571.0000; val_masked_gp_l1_reg_loss: 64749.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66299.0859; val_chrom_access_recon_loss: 3937655.2812; val_global_loss: 17194433.5000; val_optim_loss: 17194433.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9441; val_auprc_score: 0.9184; val_best_acc_score: 0.8874; val_best_f1_score: 0.8936; train_kl_reg_loss: 55719.6105; train_edge_recon_loss: 2694233.2008; train_gene_expr_recon_loss: 10317848.8788; train_masked_gp_l1_reg_loss: 64359.4105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66359.2005; train_chrom_access_recon_loss: 3908989.7045; train_global_loss: 17107509.8485; train_optim_loss: 17107509.8485; val_kl_reg_loss: 43557.6909; val_edge_recon_loss: 2711002.3750; val_gene_expr_recon_loss: 10434740.7500; val_masked_gp_l1_reg_loss: 64049.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66529.3594; val_chrom_access_recon_loss: 3929175.2812; val_global_loss: 17249054.7500; val_optim_loss: 17249054.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9458; val_auprc_score: 0.9226; val_best_acc_score: 0.8915; val_best_f1_score: 0.8965; train_kl_reg_loss: 55181.4942; train_edge_recon_loss: 2687850.5265; train_gene_expr_recon_loss: 10304364.6061; train_masked_gp_l1_reg_loss: 63770.2682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66340.8754; train_chrom_access_recon_loss: 3904254.9167; train_global_loss: 17081762.6818; train_optim_loss: 17081762.6818; val_kl_reg_loss: 43824.4497; val_edge_recon_loss: 2712087.0938; val_gene_expr_recon_loss: 10457933.2500; val_masked_gp_l1_reg_loss: 63516.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66335.2109; val_chrom_access_recon_loss: 3947943.8438; val_global_loss: 17291640.7500; val_optim_loss: 17291640.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9426; val_auprc_score: 0.9212; val_best_acc_score: 0.8826; val_best_f1_score: 0.8898; train_kl_reg_loss: 54851.4612; train_edge_recon_loss: 2691871.3864; train_gene_expr_recon_loss: 10280869.8788; train_masked_gp_l1_reg_loss: 63272.2504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66344.5056; train_chrom_access_recon_loss: 3894990.2614; train_global_loss: 17052199.7424; train_optim_loss: 17052199.7424; val_kl_reg_loss: 43836.9907; val_edge_recon_loss: 2743082.4062; val_gene_expr_recon_loss: 10434246.2500; val_masked_gp_l1_reg_loss: 63044.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66370.7266; val_chrom_access_recon_loss: 3918226.6250; val_global_loss: 17268807.2500; val_optim_loss: 17268807.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9487; val_auprc_score: 0.9301; val_best_acc_score: 0.8909; val_best_f1_score: 0.8974; train_kl_reg_loss: 55048.6770; train_edge_recon_loss: 2680542.5455; train_gene_expr_recon_loss: 10271659.5303; train_masked_gp_l1_reg_loss: 62774.8404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66344.1603; train_chrom_access_recon_loss: 3891226.8144; train_global_loss: 17027596.4091; train_optim_loss: 17027596.4091; val_kl_reg_loss: 45503.1006; val_edge_recon_loss: 2723541.9688; val_gene_expr_recon_loss: 10338788.3750; val_masked_gp_l1_reg_loss: 62554.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66219.8438; val_chrom_access_recon_loss: 3943621.2812; val_global_loss: 17180228.7500; val_optim_loss: 17180228.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9480; val_auprc_score: 0.9222; val_best_acc_score: 0.8974; val_best_f1_score: 0.9018; train_kl_reg_loss: 53284.0656; train_edge_recon_loss: 2686078.8826; train_gene_expr_recon_loss: 10263225.8182; train_masked_gp_l1_reg_loss: 62301.9816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66168.3398; train_chrom_access_recon_loss: 3887985.9356; train_global_loss: 17019045.0152; train_optim_loss: 17019045.0152; val_kl_reg_loss: 45640.0850; val_edge_recon_loss: 2721914.0312; val_gene_expr_recon_loss: 10308114.5000; val_masked_gp_l1_reg_loss: 62067.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66170.9922; val_chrom_access_recon_loss: 3894254.9375; val_global_loss: 17098161.6250; val_optim_loss: 17098161.6250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9497; val_auprc_score: 0.9313; val_best_acc_score: 0.8958; val_best_f1_score: 0.8999; train_kl_reg_loss: 53057.1950; train_edge_recon_loss: 2679672.2424; train_gene_expr_recon_loss: 10254981.2879; train_masked_gp_l1_reg_loss: 61836.8897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66087.7955; train_chrom_access_recon_loss: 3882708.5379; train_global_loss: 16998343.9394; train_optim_loss: 16998343.9394; val_kl_reg_loss: 45798.3774; val_edge_recon_loss: 2711166.0000; val_gene_expr_recon_loss: 10331107.2500; val_masked_gp_l1_reg_loss: 61585.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66150.7891; val_chrom_access_recon_loss: 3908819.6875; val_global_loss: 17124628.1250; val_optim_loss: 17124628.1250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9513; val_auprc_score: 0.9265; val_best_acc_score: 0.8990; val_best_f1_score: 0.9035; train_kl_reg_loss: 53221.2397; train_edge_recon_loss: 2682757.2008; train_gene_expr_recon_loss: 10244331.5455; train_masked_gp_l1_reg_loss: 61358.8482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66138.0914; train_chrom_access_recon_loss: 3882946.8826; train_global_loss: 16990753.7121; train_optim_loss: 16990753.7121; val_kl_reg_loss: 46031.1753; val_edge_recon_loss: 2684474.2812; val_gene_expr_recon_loss: 10331362.2500; val_masked_gp_l1_reg_loss: 61144.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66225.7812; val_chrom_access_recon_loss: 3918089.9688; val_global_loss: 17107328.2500; val_optim_loss: 17107328.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9545; val_auprc_score: 0.9344; val_best_acc_score: 0.9044; val_best_f1_score: 0.9078; train_kl_reg_loss: 53321.0142; train_edge_recon_loss: 2681658.2008; train_gene_expr_recon_loss: 10231113.3636; train_masked_gp_l1_reg_loss: 60880.0294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66088.5292; train_chrom_access_recon_loss: 3880161.2235; train_global_loss: 16973222.4091; train_optim_loss: 16973222.4091; val_kl_reg_loss: 47608.3457; val_edge_recon_loss: 2681923.0938; val_gene_expr_recon_loss: 10363172.0000; val_masked_gp_l1_reg_loss: 60607.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66014.4922; val_chrom_access_recon_loss: 3914609.3750; val_global_loss: 17133933.7500; val_optim_loss: 17133933.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9540; val_auprc_score: 0.9329; val_best_acc_score: 0.9046; val_best_f1_score: 0.9080; train_kl_reg_loss: 52198.0288; train_edge_recon_loss: 2686803.5038; train_gene_expr_recon_loss: 10222562.1818; train_masked_gp_l1_reg_loss: 60360.7984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66078.8088; train_chrom_access_recon_loss: 3872280.6591; train_global_loss: 16960283.9091; train_optim_loss: 16960283.9091; val_kl_reg_loss: 46396.9678; val_edge_recon_loss: 2702848.8750; val_gene_expr_recon_loss: 10181640.6250; val_masked_gp_l1_reg_loss: 60106.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66053.6953; val_chrom_access_recon_loss: 3871379.3125; val_global_loss: 16928426.2500; val_optim_loss: 16928426.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9538; val_auprc_score: 0.9313; val_best_acc_score: 0.9049; val_best_f1_score: 0.9102; train_kl_reg_loss: 52253.4240; train_edge_recon_loss: 2674995.5227; train_gene_expr_recon_loss: 10210497.6667; train_masked_gp_l1_reg_loss: 59844.2050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65921.0275; train_chrom_access_recon_loss: 3869164.2273; train_global_loss: 16932676.0909; train_optim_loss: 16932676.0909; val_kl_reg_loss: 46489.0981; val_edge_recon_loss: 2705156.3750; val_gene_expr_recon_loss: 10252404.1250; val_masked_gp_l1_reg_loss: 59585.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65861.4531; val_chrom_access_recon_loss: 3877955.2500; val_global_loss: 17007451.6250; val_optim_loss: 17007451.6250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9540; val_auprc_score: 0.9304; val_best_acc_score: 0.9105; val_best_f1_score: 0.9143; train_kl_reg_loss: 50508.4960; train_edge_recon_loss: 2678685.8902; train_gene_expr_recon_loss: 10212840.1364; train_masked_gp_l1_reg_loss: 59383.8080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65990.7470; train_chrom_access_recon_loss: 3869792.4545; train_global_loss: 16937201.3939; train_optim_loss: 16937201.3939; val_kl_reg_loss: 45365.2783; val_edge_recon_loss: 2715433.0625; val_gene_expr_recon_loss: 10326795.6250; val_masked_gp_l1_reg_loss: 59190.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65917.7812; val_chrom_access_recon_loss: 3891325.9062; val_global_loss: 17104029.0000; val_optim_loss: 17104029.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9525; val_auprc_score: 0.9256; val_best_acc_score: 0.9054; val_best_f1_score: 0.9102; train_kl_reg_loss: 51081.3524; train_edge_recon_loss: 2685846.2045; train_gene_expr_recon_loss: 10198379.7727; train_masked_gp_l1_reg_loss: 59007.0693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65916.8875; train_chrom_access_recon_loss: 3865191.0758; train_global_loss: 16925422.4545; train_optim_loss: 16925422.4545; val_kl_reg_loss: 47842.3975; val_edge_recon_loss: 2694899.2812; val_gene_expr_recon_loss: 10276168.6250; val_masked_gp_l1_reg_loss: 58791.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66016.5859; val_chrom_access_recon_loss: 3877934.8750; val_global_loss: 17021653.8750; val_optim_loss: 17021653.8750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9607; val_auprc_score: 0.9385; val_best_acc_score: 0.9194; val_best_f1_score: 0.9233; train_kl_reg_loss: 50992.9198; train_edge_recon_loss: 2673567.6023; train_gene_expr_recon_loss: 10185129.8030; train_masked_gp_l1_reg_loss: 58646.3444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65923.1445; train_chrom_access_recon_loss: 3856056.7045; train_global_loss: 16890316.4242; train_optim_loss: 16890316.4242; val_kl_reg_loss: 46579.5664; val_edge_recon_loss: 2662541.1875; val_gene_expr_recon_loss: 10272910.3750; val_masked_gp_l1_reg_loss: 58437.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66030.6641; val_chrom_access_recon_loss: 3915423.5938; val_global_loss: 17021922.8750; val_optim_loss: 17021922.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9553; val_auprc_score: 0.9303; val_best_acc_score: 0.9124; val_best_f1_score: 0.9162; train_kl_reg_loss: 50164.0822; train_edge_recon_loss: 2672724.7955; train_gene_expr_recon_loss: 10172190.3182; train_masked_gp_l1_reg_loss: 58137.1809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56704.9679; train_chrom_access_recon_loss: 3850923.3182; train_global_loss: 16860844.6970; train_optim_loss: 16860844.6970; val_kl_reg_loss: 47684.6729; val_edge_recon_loss: 2695246.2500; val_gene_expr_recon_loss: 10269160.1250; val_masked_gp_l1_reg_loss: 58021.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54681.9219; val_chrom_access_recon_loss: 3877935.8438; val_global_loss: 17002731.1250; val_optim_loss: 17002731.1250
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9562; val_auprc_score: 0.9348; val_best_acc_score: 0.9073; val_best_f1_score: 0.9124; train_kl_reg_loss: 51665.1463; train_edge_recon_loss: 2676344.5909; train_gene_expr_recon_loss: 10160780.4697; train_masked_gp_l1_reg_loss: 57976.6591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54366.8408; train_chrom_access_recon_loss: 3845913.7235; train_global_loss: 16847047.3636; train_optim_loss: 16847047.3636; val_kl_reg_loss: 47304.6494; val_edge_recon_loss: 2701048.3438; val_gene_expr_recon_loss: 10211563.7500; val_masked_gp_l1_reg_loss: 57938.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54116.7188; val_chrom_access_recon_loss: 3848199.5000; val_global_loss: 16920172.3750; val_optim_loss: 16920172.3750
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9508; val_auprc_score: 0.9276; val_best_acc_score: 0.9041; val_best_f1_score: 0.9096; train_kl_reg_loss: 52408.5755; train_edge_recon_loss: 2665300.3598; train_gene_expr_recon_loss: 10167636.8485; train_masked_gp_l1_reg_loss: 57914.0737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53916.2688; train_chrom_access_recon_loss: 3850515.2311; train_global_loss: 16847691.3030; train_optim_loss: 16847691.3030; val_kl_reg_loss: 47554.4453; val_edge_recon_loss: 2691096.0000; val_gene_expr_recon_loss: 10253860.0000; val_masked_gp_l1_reg_loss: 57890.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53724.1406; val_chrom_access_recon_loss: 3877876.5312; val_global_loss: 16982001.2500; val_optim_loss: 16982001.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9531; val_auprc_score: 0.9282; val_best_acc_score: 0.9038; val_best_f1_score: 0.9087; train_kl_reg_loss: 52575.2061; train_edge_recon_loss: 2671807.5606; train_gene_expr_recon_loss: 10152232.5758; train_masked_gp_l1_reg_loss: 57871.0957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53598.0669; train_chrom_access_recon_loss: 3842285.1705; train_global_loss: 16830369.8788; train_optim_loss: 16830369.8788; val_kl_reg_loss: 47835.9106; val_edge_recon_loss: 2707952.4062; val_gene_expr_recon_loss: 10281475.1250; val_masked_gp_l1_reg_loss: 57847.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53489.7109; val_chrom_access_recon_loss: 3875568.7500; val_global_loss: 17024169.8750; val_optim_loss: 17024169.8750
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9524; val_auprc_score: 0.9324; val_best_acc_score: 0.9027; val_best_f1_score: 0.9073; train_kl_reg_loss: 52992.4023; train_edge_recon_loss: 2679616.3182; train_gene_expr_recon_loss: 10157506.6061; train_masked_gp_l1_reg_loss: 57824.3937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53375.2920; train_chrom_access_recon_loss: 3843857.1439; train_global_loss: 16845171.9848; train_optim_loss: 16845171.9848; val_kl_reg_loss: 47809.2539; val_edge_recon_loss: 2702017.0000; val_gene_expr_recon_loss: 10300484.6250; val_masked_gp_l1_reg_loss: 57803.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53287.2656; val_chrom_access_recon_loss: 3849824.1875; val_global_loss: 17011224.7500; val_optim_loss: 17011224.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9522; val_auprc_score: 0.9269; val_best_acc_score: 0.9014; val_best_f1_score: 0.9068; train_kl_reg_loss: 52440.0820; train_edge_recon_loss: 2670813.7992; train_gene_expr_recon_loss: 10153327.2727; train_masked_gp_l1_reg_loss: 57779.9686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53176.0940; train_chrom_access_recon_loss: 3842663.1250; train_global_loss: 16830200.4091; train_optim_loss: 16830200.4091; val_kl_reg_loss: 48271.2939; val_edge_recon_loss: 2717145.4688; val_gene_expr_recon_loss: 10283676.1250; val_masked_gp_l1_reg_loss: 57763.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53079.8984; val_chrom_access_recon_loss: 3905600.9688; val_global_loss: 17065538.0000; val_optim_loss: 17065538.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9593; val_auprc_score: 0.9426; val_best_acc_score: 0.9124; val_best_f1_score: 0.9168; train_kl_reg_loss: 52757.9611; train_edge_recon_loss: 2671738.2121; train_gene_expr_recon_loss: 10152422.1364; train_masked_gp_l1_reg_loss: 57734.3366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52106.2917; train_chrom_access_recon_loss: 3841121.2348; train_global_loss: 16827880.2121; train_optim_loss: 16827880.2121; val_kl_reg_loss: 48363.0728; val_edge_recon_loss: 2671793.2812; val_gene_expr_recon_loss: 10278982.7500; val_masked_gp_l1_reg_loss: 57721.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51910.2344; val_chrom_access_recon_loss: 3873299.5312; val_global_loss: 16982069.8750; val_optim_loss: 16982069.8750
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9546; val_auprc_score: 0.9342; val_best_acc_score: 0.9062; val_best_f1_score: 0.9110; train_kl_reg_loss: 52972.7757; train_edge_recon_loss: 2666733.3106; train_gene_expr_recon_loss: 10160494.0000; train_masked_gp_l1_reg_loss: 57716.3478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51879.9593; train_chrom_access_recon_loss: 3846955.6174; train_global_loss: 16836751.9242; train_optim_loss: 16836751.9242; val_kl_reg_loss: 48461.2358; val_edge_recon_loss: 2707670.1875; val_gene_expr_recon_loss: 10293079.0000; val_masked_gp_l1_reg_loss: 57712.2070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51855.9375; val_chrom_access_recon_loss: 3863523.2812; val_global_loss: 17022301.8750; val_optim_loss: 17022301.8750
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9565; val_auprc_score: 0.9372; val_best_acc_score: 0.9116; val_best_f1_score: 0.9156; train_kl_reg_loss: 52850.2675; train_edge_recon_loss: 2673196.7841; train_gene_expr_recon_loss: 10160428.8636; train_masked_gp_l1_reg_loss: 57708.7254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51835.3231; train_chrom_access_recon_loss: 3843477.2727; train_global_loss: 16839497.3030; train_optim_loss: 16839497.3030; val_kl_reg_loss: 48757.0479; val_edge_recon_loss: 2679685.2812; val_gene_expr_recon_loss: 10264602.3750; val_masked_gp_l1_reg_loss: 57705.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51811.4219; val_chrom_access_recon_loss: 3864620.7812; val_global_loss: 16967181.6250; val_optim_loss: 16967181.6250
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9599; val_auprc_score: 0.9426; val_best_acc_score: 0.9140; val_best_f1_score: 0.9170; train_kl_reg_loss: 52910.3873; train_edge_recon_loss: 2667029.4962; train_gene_expr_recon_loss: 10148690.5606; train_masked_gp_l1_reg_loss: 57702.8882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51801.8449; train_chrom_access_recon_loss: 3842231.7879; train_global_loss: 16820366.8636; train_optim_loss: 16820366.8636; val_kl_reg_loss: 48699.2871; val_edge_recon_loss: 2678562.9062; val_gene_expr_recon_loss: 10300509.5000; val_masked_gp_l1_reg_loss: 57700.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51783.8164; val_chrom_access_recon_loss: 3914415.8750; val_global_loss: 17051671.2500; val_optim_loss: 17051671.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 21 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9535
val AUPRC score: 0.9331
val best accuracy score: 0.9014
val best F1 score: 0.9067
val target rna MSE score: 1.8738
val source rna MSE score: 1.0181
val target atac MSE score: 0.4932
val source atac MSE score: 0.2003
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
