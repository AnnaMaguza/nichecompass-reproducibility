[True]
Run timestamp: 01082023_084842_59.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_59']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9192; val_auprc_score: 0.9841; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 45887.4509; train_edge_recon_loss: 115913.1068; train_gene_expr_recon_loss: 5689473.1204; train_masked_gp_l1_reg_loss: 12401.9262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58951.3983; train_global_loss: 5922627.0463; train_optim_loss: 5922627.0463; val_kl_reg_loss: 79474.4232; val_edge_recon_loss: 119748.2747; val_gene_expr_recon_loss: 4226293.1667; val_masked_gp_l1_reg_loss: 11586.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54627.0273; val_global_loss: 4491728.8333; val_optim_loss: 4491728.8333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9063; val_auprc_score: 0.9822; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 79335.2486; train_edge_recon_loss: 118818.0326; train_gene_expr_recon_loss: 3900973.5046; train_masked_gp_l1_reg_loss: 10541.7015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51197.3601; train_global_loss: 4160865.8056; train_optim_loss: 4160865.8056; val_kl_reg_loss: 71897.6497; val_edge_recon_loss: 119388.0052; val_gene_expr_recon_loss: 3470182.0000; val_masked_gp_l1_reg_loss: 9713.9746; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47932.7695; val_global_loss: 3719114.3750; val_optim_loss: 3719114.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8666; val_auprc_score: 0.9732; val_best_acc_score: 0.8586; val_best_f1_score: 0.9237; train_kl_reg_loss: 70746.0971; train_edge_recon_loss: 119350.9900; train_gene_expr_recon_loss: 3030523.3009; train_masked_gp_l1_reg_loss: 9243.8285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45251.5486; train_global_loss: 3275115.7870; train_optim_loss: 3275115.7870; val_kl_reg_loss: 64163.7988; val_edge_recon_loss: 116872.2266; val_gene_expr_recon_loss: 2659435.5417; val_masked_gp_l1_reg_loss: 8877.5566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42688.5742; val_global_loss: 2892037.5417; val_optim_loss: 2892037.5417
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8635; val_auprc_score: 0.9728; val_best_acc_score: 0.8742; val_best_f1_score: 0.9312; train_kl_reg_loss: 62556.3738; train_edge_recon_loss: 118465.3377; train_gene_expr_recon_loss: 2506942.6111; train_masked_gp_l1_reg_loss: 8689.5348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40681.6092; train_global_loss: 2737335.4676; train_optim_loss: 2737335.4676; val_kl_reg_loss: 55815.6406; val_edge_recon_loss: 117104.2122; val_gene_expr_recon_loss: 2405976.7083; val_masked_gp_l1_reg_loss: 8571.3271; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38850.1914; val_global_loss: 2626318.0417; val_optim_loss: 2626318.0417
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8587; val_auprc_score: 0.9705; val_best_acc_score: 0.8766; val_best_f1_score: 0.9304; train_kl_reg_loss: 53779.0315; train_edge_recon_loss: 117851.4737; train_gene_expr_recon_loss: 2303114.8750; train_masked_gp_l1_reg_loss: 8591.7034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37567.1269; train_global_loss: 2520904.2361; train_optim_loss: 2520904.2361; val_kl_reg_loss: 48821.9538; val_edge_recon_loss: 120921.7865; val_gene_expr_recon_loss: 2236252.2917; val_masked_gp_l1_reg_loss: 8592.8848; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36491.4062; val_global_loss: 2451080.5417; val_optim_loss: 2451080.5417
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8449; val_auprc_score: 0.9671; val_best_acc_score: 0.8773; val_best_f1_score: 0.9322; train_kl_reg_loss: 47798.3548; train_edge_recon_loss: 117782.5162; train_gene_expr_recon_loss: 2215004.5139; train_masked_gp_l1_reg_loss: 8626.5860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35955.9439; train_global_loss: 2425167.8935; train_optim_loss: 2425167.8935; val_kl_reg_loss: 43207.2891; val_edge_recon_loss: 118862.2031; val_gene_expr_recon_loss: 2194654.8333; val_masked_gp_l1_reg_loss: 8704.9199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35641.0117; val_global_loss: 2401070.2917; val_optim_loss: 2401070.2917
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8474; val_auprc_score: 0.9674; val_best_acc_score: 0.8804; val_best_f1_score: 0.9339; train_kl_reg_loss: 43189.5000; train_edge_recon_loss: 115702.6223; train_gene_expr_recon_loss: 2182042.7546; train_masked_gp_l1_reg_loss: 8799.7826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35487.6368; train_global_loss: 2385222.3056; train_optim_loss: 2385222.3056; val_kl_reg_loss: 39841.5456; val_edge_recon_loss: 117652.5026; val_gene_expr_recon_loss: 2168002.0417; val_masked_gp_l1_reg_loss: 8910.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35332.2578; val_global_loss: 2369738.3333; val_optim_loss: 2369738.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8592; val_auprc_score: 0.9702; val_best_acc_score: 0.8811; val_best_f1_score: 0.9342; train_kl_reg_loss: 39902.4949; train_edge_recon_loss: 115141.0790; train_gene_expr_recon_loss: 2156667.0694; train_masked_gp_l1_reg_loss: 9019.6776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35178.3412; train_global_loss: 2355908.6481; train_optim_loss: 2355908.6481; val_kl_reg_loss: 37254.5547; val_edge_recon_loss: 116120.4622; val_gene_expr_recon_loss: 2146232.6250; val_masked_gp_l1_reg_loss: 9147.0264; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35015.4141; val_global_loss: 2343770.0833; val_optim_loss: 2343770.0833
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8693; val_auprc_score: 0.9724; val_best_acc_score: 0.8811; val_best_f1_score: 0.9336; train_kl_reg_loss: 37444.9852; train_edge_recon_loss: 113566.0985; train_gene_expr_recon_loss: 2135680.7176; train_masked_gp_l1_reg_loss: 9271.7005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34850.9374; train_global_loss: 2330814.4259; train_optim_loss: 2330814.4259; val_kl_reg_loss: 34978.7025; val_edge_recon_loss: 115986.4414; val_gene_expr_recon_loss: 2124001.7500; val_masked_gp_l1_reg_loss: 9409.5576; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34676.8555; val_global_loss: 2319053.1250; val_optim_loss: 2319053.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8695; val_auprc_score: 0.9723; val_best_acc_score: 0.8846; val_best_f1_score: 0.9360; train_kl_reg_loss: 35495.8520; train_edge_recon_loss: 114008.6198; train_gene_expr_recon_loss: 2115353.2269; train_masked_gp_l1_reg_loss: 9538.3914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34503.9846; train_global_loss: 2308900.0463; train_optim_loss: 2308900.0463; val_kl_reg_loss: 33266.9720; val_edge_recon_loss: 113316.0781; val_gene_expr_recon_loss: 2103836.7083; val_masked_gp_l1_reg_loss: 9673.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34322.1641; val_global_loss: 2294415.5000; val_optim_loss: 2294415.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8846; val_auprc_score: 0.9740; val_best_acc_score: 0.8916; val_best_f1_score: 0.9388; train_kl_reg_loss: 33918.8850; train_edge_recon_loss: 112548.2296; train_gene_expr_recon_loss: 2098301.1019; train_masked_gp_l1_reg_loss: 9799.8230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34140.3877; train_global_loss: 2288708.4398; train_optim_loss: 2288708.4398; val_kl_reg_loss: 31948.4170; val_edge_recon_loss: 114882.1849; val_gene_expr_recon_loss: 2088404.6667; val_masked_gp_l1_reg_loss: 9932.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33949.5938; val_global_loss: 2279117.7917; val_optim_loss: 2279117.7917
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8858; val_auprc_score: 0.9750; val_best_acc_score: 0.8974; val_best_f1_score: 0.9418; train_kl_reg_loss: 32644.7078; train_edge_recon_loss: 111132.6683; train_gene_expr_recon_loss: 2080988.5162; train_masked_gp_l1_reg_loss: 10054.6555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33761.4410; train_global_loss: 2268581.9676; train_optim_loss: 2268581.9676; val_kl_reg_loss: 30967.3861; val_edge_recon_loss: 110675.2083; val_gene_expr_recon_loss: 2073414.1250; val_masked_gp_l1_reg_loss: 10187.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33564.0156; val_global_loss: 2258807.9583; val_optim_loss: 2258807.9583
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8954; val_auprc_score: 0.9773; val_best_acc_score: 0.8978; val_best_f1_score: 0.9419; train_kl_reg_loss: 31658.9990; train_edge_recon_loss: 110770.2844; train_gene_expr_recon_loss: 2065771.4005; train_masked_gp_l1_reg_loss: 10302.6028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33369.3485; train_global_loss: 2251872.6389; train_optim_loss: 2251872.6389; val_kl_reg_loss: 30134.2972; val_edge_recon_loss: 111967.2161; val_gene_expr_recon_loss: 2058092.0208; val_masked_gp_l1_reg_loss: 10428.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33165.2773; val_global_loss: 2243787.2083; val_optim_loss: 2243787.2083
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8950; val_auprc_score: 0.9769; val_best_acc_score: 0.9020; val_best_f1_score: 0.9442; train_kl_reg_loss: 30740.0100; train_edge_recon_loss: 108521.3961; train_gene_expr_recon_loss: 2050841.6829; train_masked_gp_l1_reg_loss: 10545.7251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32965.5476; train_global_loss: 2233614.3704; train_optim_loss: 2233614.3704; val_kl_reg_loss: 29115.7015; val_edge_recon_loss: 109101.2292; val_gene_expr_recon_loss: 2043016.3542; val_masked_gp_l1_reg_loss: 10672.4912; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32756.7402; val_global_loss: 2224662.5000; val_optim_loss: 2224662.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8979; val_auprc_score: 0.9782; val_best_acc_score: 0.9042; val_best_f1_score: 0.9453; train_kl_reg_loss: 29890.2074; train_edge_recon_loss: 108101.0968; train_gene_expr_recon_loss: 2037636.3773; train_masked_gp_l1_reg_loss: 10785.8298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32552.8382; train_global_loss: 2218966.3472; train_optim_loss: 2218966.3472; val_kl_reg_loss: 28407.6009; val_edge_recon_loss: 108573.6406; val_gene_expr_recon_loss: 2029313.2083; val_masked_gp_l1_reg_loss: 10909.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32340.2168; val_global_loss: 2209544.2083; val_optim_loss: 2209544.2083
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9062; val_auprc_score: 0.9802; val_best_acc_score: 0.9099; val_best_f1_score: 0.9487; train_kl_reg_loss: 29239.7310; train_edge_recon_loss: 107316.9349; train_gene_expr_recon_loss: 2023591.1574; train_masked_gp_l1_reg_loss: 11022.2841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32134.8622; train_global_loss: 2203304.9583; train_optim_loss: 2203304.9583; val_kl_reg_loss: 27806.0342; val_edge_recon_loss: 105386.9805; val_gene_expr_recon_loss: 2017623.5625; val_masked_gp_l1_reg_loss: 11143.1455; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31920.9277; val_global_loss: 2193880.8750; val_optim_loss: 2193880.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9032; val_auprc_score: 0.9792; val_best_acc_score: 0.9096; val_best_f1_score: 0.9482; train_kl_reg_loss: 28695.3639; train_edge_recon_loss: 106163.2614; train_gene_expr_recon_loss: 2010784.4375; train_masked_gp_l1_reg_loss: 11254.8690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31714.9489; train_global_loss: 2188612.8796; train_optim_loss: 2188612.8796; val_kl_reg_loss: 27373.9629; val_edge_recon_loss: 106685.2422; val_gene_expr_recon_loss: 2001996.9375; val_masked_gp_l1_reg_loss: 11378.5986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31501.7480; val_global_loss: 2178936.4167; val_optim_loss: 2178936.4167
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9112; val_auprc_score: 0.9801; val_best_acc_score: 0.9124; val_best_f1_score: 0.9496; train_kl_reg_loss: 28167.0170; train_edge_recon_loss: 105888.2792; train_gene_expr_recon_loss: 1997733.7083; train_masked_gp_l1_reg_loss: 11482.6247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31296.7959; train_global_loss: 2174568.4444; train_optim_loss: 2174568.4444; val_kl_reg_loss: 26841.8135; val_edge_recon_loss: 107816.2956; val_gene_expr_recon_loss: 1988431.4792; val_masked_gp_l1_reg_loss: 11597.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31084.0137; val_global_loss: 2165771.3750; val_optim_loss: 2165771.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9137; val_auprc_score: 0.9805; val_best_acc_score: 0.9167; val_best_f1_score: 0.9521; train_kl_reg_loss: 27586.3853; train_edge_recon_loss: 105028.6283; train_gene_expr_recon_loss: 1985311.0486; train_masked_gp_l1_reg_loss: 11697.6434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30879.6959; train_global_loss: 2160503.3935; train_optim_loss: 2160503.3935; val_kl_reg_loss: 26221.5837; val_edge_recon_loss: 105794.0534; val_gene_expr_recon_loss: 1975816.6458; val_masked_gp_l1_reg_loss: 11809.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30668.9277; val_global_loss: 2150310.7500; val_optim_loss: 2150310.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9186; val_auprc_score: 0.9826; val_best_acc_score: 0.9161; val_best_f1_score: 0.9517; train_kl_reg_loss: 27135.0093; train_edge_recon_loss: 103461.6914; train_gene_expr_recon_loss: 1973161.6389; train_masked_gp_l1_reg_loss: 11908.0627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30466.1267; train_global_loss: 2146132.5185; train_optim_loss: 2146132.5185; val_kl_reg_loss: 26051.3197; val_edge_recon_loss: 105708.9049; val_gene_expr_recon_loss: 1964735.6250; val_masked_gp_l1_reg_loss: 12017.9150; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30256.6230; val_global_loss: 2138770.3333; val_optim_loss: 2138770.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9186; val_auprc_score: 0.9812; val_best_acc_score: 0.9143; val_best_f1_score: 0.9510; train_kl_reg_loss: 26732.6871; train_edge_recon_loss: 104486.9339; train_gene_expr_recon_loss: 1961359.0556; train_masked_gp_l1_reg_loss: 12112.5810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30055.8951; train_global_loss: 2134747.1528; train_optim_loss: 2134747.1528; val_kl_reg_loss: 25546.1279; val_edge_recon_loss: 104599.2005; val_gene_expr_recon_loss: 1955860.1042; val_masked_gp_l1_reg_loss: 12216.1660; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29848.1250; val_global_loss: 2128069.7917; val_optim_loss: 2128069.7917
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9205; val_auprc_score: 0.9831; val_best_acc_score: 0.9201; val_best_f1_score: 0.9545; train_kl_reg_loss: 26318.4949; train_edge_recon_loss: 102021.1139; train_gene_expr_recon_loss: 1949779.2685; train_masked_gp_l1_reg_loss: 12310.2600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29649.7640; train_global_loss: 2120078.9167; train_optim_loss: 2120078.9167; val_kl_reg_loss: 25244.5316; val_edge_recon_loss: 102296.2435; val_gene_expr_recon_loss: 1944157.2917; val_masked_gp_l1_reg_loss: 12412.0176; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29444.4512; val_global_loss: 2113554.5417; val_optim_loss: 2113554.5417
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9248; val_auprc_score: 0.9837; val_best_acc_score: 0.9223; val_best_f1_score: 0.9554; train_kl_reg_loss: 25914.4912; train_edge_recon_loss: 101969.0422; train_gene_expr_recon_loss: 1938640.9769; train_masked_gp_l1_reg_loss: 12501.1061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29249.2283; train_global_loss: 2108274.8634; train_optim_loss: 2108274.8634; val_kl_reg_loss: 24764.3848; val_edge_recon_loss: 104195.0443; val_gene_expr_recon_loss: 1931194.3958; val_masked_gp_l1_reg_loss: 12597.3936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29046.3672; val_global_loss: 2101797.5625; val_optim_loss: 2101797.5625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9303; val_auprc_score: 0.9850; val_best_acc_score: 0.9257; val_best_f1_score: 0.9573; train_kl_reg_loss: 25544.1451; train_edge_recon_loss: 101727.8487; train_gene_expr_recon_loss: 1927635.6921; train_masked_gp_l1_reg_loss: 12682.6797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28851.6468; train_global_loss: 2096442.0069; train_optim_loss: 2096442.0069; val_kl_reg_loss: 24424.9141; val_edge_recon_loss: 102283.3398; val_gene_expr_recon_loss: 1921369.1875; val_masked_gp_l1_reg_loss: 12775.1162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28649.6445; val_global_loss: 2089502.1875; val_optim_loss: 2089502.1875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9262; val_auprc_score: 0.9843; val_best_acc_score: 0.9227; val_best_f1_score: 0.9554; train_kl_reg_loss: 25164.1192; train_edge_recon_loss: 100769.4810; train_gene_expr_recon_loss: 1916786.8056; train_masked_gp_l1_reg_loss: 12858.8183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28455.1965; train_global_loss: 2084034.4190; train_optim_loss: 2084034.4190; val_kl_reg_loss: 24112.0495; val_edge_recon_loss: 103883.8542; val_gene_expr_recon_loss: 1912518.0417; val_masked_gp_l1_reg_loss: 12953.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28253.7969; val_global_loss: 2081720.9583; val_optim_loss: 2081720.9583
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8619; val_auprc_score: 0.9711; val_best_acc_score: 0.8630; val_best_f1_score: 0.9254; train_kl_reg_loss: 15946.6742; train_edge_recon_loss: 111087.8271; train_gene_expr_recon_loss: 3767579.2639; train_masked_gp_l1_reg_loss: 16315.6820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27975.3820; train_global_loss: 3938904.8333; train_optim_loss: 3938904.8333; val_kl_reg_loss: 15495.4113; val_edge_recon_loss: 116944.4948; val_gene_expr_recon_loss: 3296610.3750; val_masked_gp_l1_reg_loss: 17163.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27659.1172; val_global_loss: 3473873.0000; val_optim_loss: 3473873.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8833; val_auprc_score: 0.9757; val_best_acc_score: 0.8973; val_best_f1_score: 0.9414; train_kl_reg_loss: 17410.4093; train_edge_recon_loss: 113146.6684; train_gene_expr_recon_loss: 3026339.2593; train_masked_gp_l1_reg_loss: 16694.6720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27348.5369; train_global_loss: 3200939.5509; train_optim_loss: 3200939.5509; val_kl_reg_loss: 16945.2949; val_edge_recon_loss: 111202.0586; val_gene_expr_recon_loss: 2779178.9583; val_masked_gp_l1_reg_loss: 16346.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27026.0703; val_global_loss: 2950698.7917; val_optim_loss: 2950698.7917
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8912; val_auprc_score: 0.9755; val_best_acc_score: 0.9044; val_best_f1_score: 0.9452; train_kl_reg_loss: 17150.7989; train_edge_recon_loss: 108423.6105; train_gene_expr_recon_loss: 2617862.5556; train_masked_gp_l1_reg_loss: 16201.6651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26715.5964; train_global_loss: 2786354.2593; train_optim_loss: 2786354.2593; val_kl_reg_loss: 15373.6836; val_edge_recon_loss: 110944.2070; val_gene_expr_recon_loss: 2461140.3333; val_masked_gp_l1_reg_loss: 16097.0332; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26393.3789; val_global_loss: 2629948.7083; val_optim_loss: 2629948.7083
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8880; val_auprc_score: 0.9755; val_best_acc_score: 0.9101; val_best_f1_score: 0.9489; train_kl_reg_loss: 16286.7286; train_edge_recon_loss: 105665.0191; train_gene_expr_recon_loss: 2375628.8472; train_masked_gp_l1_reg_loss: 16032.8804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26083.1878; train_global_loss: 2539696.6806; train_optim_loss: 2539696.6806; val_kl_reg_loss: 15036.3830; val_edge_recon_loss: 103040.3398; val_gene_expr_recon_loss: 2282891.8333; val_masked_gp_l1_reg_loss: 15962.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25761.2734; val_global_loss: 2442692.5833; val_optim_loss: 2442692.5833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8958; val_auprc_score: 0.9766; val_best_acc_score: 0.9124; val_best_f1_score: 0.9502; train_kl_reg_loss: 16098.1942; train_edge_recon_loss: 103625.4408; train_gene_expr_recon_loss: 2283190.3889; train_masked_gp_l1_reg_loss: 15909.6766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25713.3611; train_global_loss: 2444537.0370; train_optim_loss: 2444537.0370; val_kl_reg_loss: 14993.9046; val_edge_recon_loss: 102289.7279; val_gene_expr_recon_loss: 2276450.5000; val_masked_gp_l1_reg_loss: 15890.4932; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25676.9922; val_global_loss: 2435301.6250; val_optim_loss: 2435301.6250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8934; val_auprc_score: 0.9751; val_best_acc_score: 0.9110; val_best_f1_score: 0.9490; train_kl_reg_loss: 16112.8143; train_edge_recon_loss: 103709.9806; train_gene_expr_recon_loss: 2269080.0926; train_masked_gp_l1_reg_loss: 15880.8142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25644.5891; train_global_loss: 2430428.3009; train_optim_loss: 2430428.3009; val_kl_reg_loss: 14980.5509; val_edge_recon_loss: 105234.3815; val_gene_expr_recon_loss: 2266860.6667; val_masked_gp_l1_reg_loss: 15872.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25610.7773; val_global_loss: 2428558.6250; val_optim_loss: 2428558.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8923; val_auprc_score: 0.9761; val_best_acc_score: 0.9129; val_best_f1_score: 0.9504; train_kl_reg_loss: 16080.1165; train_edge_recon_loss: 103120.8571; train_gene_expr_recon_loss: 2257621.8889; train_masked_gp_l1_reg_loss: 15863.6881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25577.5383; train_global_loss: 2418264.0741; train_optim_loss: 2418264.0741; val_kl_reg_loss: 14904.9928; val_edge_recon_loss: 102918.2448; val_gene_expr_recon_loss: 2243187.9167; val_masked_gp_l1_reg_loss: 15854.6895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25542.7773; val_global_loss: 2402408.6667; val_optim_loss: 2402408.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8874; val_auprc_score: 0.9738; val_best_acc_score: 0.9117; val_best_f1_score: 0.9498; train_kl_reg_loss: 16055.8179; train_edge_recon_loss: 102548.9792; train_gene_expr_recon_loss: 2246706.0602; train_masked_gp_l1_reg_loss: 15846.6138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25508.5229; train_global_loss: 2406666.0046; train_optim_loss: 2406666.0046; val_kl_reg_loss: 14949.0251; val_edge_recon_loss: 103346.1771; val_gene_expr_recon_loss: 2241362.7500; val_masked_gp_l1_reg_loss: 15837.9707; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25472.6465; val_global_loss: 2400968.7083; val_optim_loss: 2400968.7083

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 57 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9249
val AUPRC score: 0.9833
val best accuracy score: 0.9232
val best F1 score: 0.9562
val target rna MSE score: 22.4335
val source rna MSE score: 130.9720
Val cat covariate0 mean sim diff: -0.0032

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
