[True]
Run timestamp: 07092023_041709_261.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_261']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 984 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 4613, n_cat_covariates_embed_input: 0, n_hidden: 2386, n_latent: 2286, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 984
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 984

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7348; val_auprc_score: 0.7653; val_best_acc_score: 0.5323; val_best_f1_score: 0.6765; train_kl_reg_loss: 71184.6140; train_edge_recon_loss: 3547282.5668; train_gene_expr_recon_loss: 14873884.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 897788.2285; train_chrom_access_recon_loss: 5703909.6641; train_global_loss: 25094049.8321; train_optim_loss: 25094049.8321; val_kl_reg_loss: 105356.3906; val_edge_recon_loss: 4063026.6500; val_gene_expr_recon_loss: 13814260.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 460241.7500; val_chrom_access_recon_loss: 5584023.1667; val_global_loss: 24026908.9333; val_optim_loss: 24026908.9333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8241; val_auprc_score: 0.8318; val_best_acc_score: 0.7404; val_best_f1_score: 0.7299; train_kl_reg_loss: 87799.3961; train_edge_recon_loss: 3512239.9809; train_gene_expr_recon_loss: 13848818.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 274639.7521; train_chrom_access_recon_loss: 5473137.1260; train_global_loss: 23196634.6107; train_optim_loss: 23196634.6107; val_kl_reg_loss: 71133.2740; val_edge_recon_loss: 3949715.9333; val_gene_expr_recon_loss: 13515574.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162111.6250; val_chrom_access_recon_loss: 5479864.2000; val_global_loss: 23178400.0000; val_optim_loss: 23178400.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8658; val_auprc_score: 0.8590; val_best_acc_score: 0.7622; val_best_f1_score: 0.7920; train_kl_reg_loss: 76670.7185; train_edge_recon_loss: 3222089.4885; train_gene_expr_recon_loss: 13661649.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120832.1959; train_chrom_access_recon_loss: 5417780.9656; train_global_loss: 22499023.1145; train_optim_loss: 22499023.1145; val_kl_reg_loss: 101004.6094; val_edge_recon_loss: 2974286.7167; val_gene_expr_recon_loss: 13422655.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91817.4531; val_chrom_access_recon_loss: 5448888.5667; val_global_loss: 22038652.6667; val_optim_loss: 22038652.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8951; val_auprc_score: 0.8835; val_best_acc_score: 0.8104; val_best_f1_score: 0.8230; train_kl_reg_loss: 97423.1504; train_edge_recon_loss: 2943236.4752; train_gene_expr_recon_loss: 13473535.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76583.8900; train_chrom_access_recon_loss: 5346729.8702; train_global_loss: 21937508.4885; train_optim_loss: 21937508.4885; val_kl_reg_loss: 91202.4302; val_edge_recon_loss: 2909531.8833; val_gene_expr_recon_loss: 13271607.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65281.0195; val_chrom_access_recon_loss: 5391283.2333; val_global_loss: 21728906.1333; val_optim_loss: 21728906.1333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9090; val_auprc_score: 0.8917; val_best_acc_score: 0.8339; val_best_f1_score: 0.8479; train_kl_reg_loss: 89242.7519; train_edge_recon_loss: 2881420.4389; train_gene_expr_recon_loss: 13327202.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58462.6634; train_chrom_access_recon_loss: 5295407.2519; train_global_loss: 21651735.9542; train_optim_loss: 21651735.9542; val_kl_reg_loss: 86237.6656; val_edge_recon_loss: 2859377.1667; val_gene_expr_recon_loss: 13117306.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52567.2500; val_chrom_access_recon_loss: 5328608.4667; val_global_loss: 21444097.2000; val_optim_loss: 21444097.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9182; val_auprc_score: 0.9012; val_best_acc_score: 0.8437; val_best_f1_score: 0.8563; train_kl_reg_loss: 86999.4766; train_edge_recon_loss: 2815106.7328; train_gene_expr_recon_loss: 13210639.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49313.2697; train_chrom_access_recon_loss: 5249130.2863; train_global_loss: 21411189.7405; train_optim_loss: 21411189.7405; val_kl_reg_loss: 86566.4167; val_edge_recon_loss: 2824209.5500; val_gene_expr_recon_loss: 13015881.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46755.0234; val_chrom_access_recon_loss: 5289578.9000; val_global_loss: 21262991.7333; val_optim_loss: 21262991.7333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9327; val_auprc_score: 0.9167; val_best_acc_score: 0.8630; val_best_f1_score: 0.8719; train_kl_reg_loss: 83774.8167; train_edge_recon_loss: 2782758.7844; train_gene_expr_recon_loss: 13108222.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44913.8159; train_chrom_access_recon_loss: 5210743.3359; train_global_loss: 21230412.9771; train_optim_loss: 21230412.9771; val_kl_reg_loss: 83220.3385; val_edge_recon_loss: 2772474.6000; val_gene_expr_recon_loss: 12943953.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43321.8398; val_chrom_access_recon_loss: 5244838.3000; val_global_loss: 21087808.6667; val_optim_loss: 21087808.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9449; val_auprc_score: 0.9330; val_best_acc_score: 0.8802; val_best_f1_score: 0.8851; train_kl_reg_loss: 81537.9826; train_edge_recon_loss: 2768489.1298; train_gene_expr_recon_loss: 13008697.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41887.8170; train_chrom_access_recon_loss: 5168237.9084; train_global_loss: 21068849.9695; train_optim_loss: 21068849.9695; val_kl_reg_loss: 84612.8057; val_edge_recon_loss: 2753012.3500; val_gene_expr_recon_loss: 12849284.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40581.9727; val_chrom_access_recon_loss: 5218550.4667; val_global_loss: 20946041.7333; val_optim_loss: 20946041.7333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9513; val_auprc_score: 0.9404; val_best_acc_score: 0.8901; val_best_f1_score: 0.8958; train_kl_reg_loss: 78658.5165; train_edge_recon_loss: 2752991.2080; train_gene_expr_recon_loss: 12927855.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39574.8106; train_chrom_access_recon_loss: 5134321.1908; train_global_loss: 20933401.0687; train_optim_loss: 20933401.0687; val_kl_reg_loss: 76752.2391; val_edge_recon_loss: 2742410.3167; val_gene_expr_recon_loss: 12772092.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38723.6797; val_chrom_access_recon_loss: 5193245.2000; val_global_loss: 20823223.8667; val_optim_loss: 20823223.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9522; val_auprc_score: 0.9395; val_best_acc_score: 0.8948; val_best_f1_score: 0.8998; train_kl_reg_loss: 78059.4698; train_edge_recon_loss: 2728086.5229; train_gene_expr_recon_loss: 12863677.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37792.4102; train_chrom_access_recon_loss: 5108542.2901; train_global_loss: 20816158.1221; train_optim_loss: 20816158.1221; val_kl_reg_loss: 74497.9667; val_edge_recon_loss: 2752976.5333; val_gene_expr_recon_loss: 12738212.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37118.0742; val_chrom_access_recon_loss: 5177465.4667; val_global_loss: 20780270.2667; val_optim_loss: 20780270.2667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9525; val_auprc_score: 0.9393; val_best_acc_score: 0.8954; val_best_f1_score: 0.9011; train_kl_reg_loss: 74381.5248; train_edge_recon_loss: 2731157.1107; train_gene_expr_recon_loss: 12783807.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36469.8570; train_chrom_access_recon_loss: 5074248.1565; train_global_loss: 20700064.4122; train_optim_loss: 20700064.4122; val_kl_reg_loss: 76187.5828; val_edge_recon_loss: 2754467.0500; val_gene_expr_recon_loss: 12584112.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35900.8555; val_chrom_access_recon_loss: 5110203.1000; val_global_loss: 20560871.2000; val_optim_loss: 20560871.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9565; val_auprc_score: 0.9417; val_best_acc_score: 0.8998; val_best_f1_score: 0.9055; train_kl_reg_loss: 73234.1356; train_edge_recon_loss: 2721385.6737; train_gene_expr_recon_loss: 12725776.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35176.0245; train_chrom_access_recon_loss: 5051983.0649; train_global_loss: 20607555.5878; train_optim_loss: 20607555.5878; val_kl_reg_loss: 71444.0385; val_edge_recon_loss: 2732800.9000; val_gene_expr_recon_loss: 12537388.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35073.4375; val_chrom_access_recon_loss: 5105613.8333; val_global_loss: 20482320.2667; val_optim_loss: 20482320.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9663; val_auprc_score: 0.9567; val_best_acc_score: 0.9134; val_best_f1_score: 0.9172; train_kl_reg_loss: 70373.6481; train_edge_recon_loss: 2702486.2023; train_gene_expr_recon_loss: 12683022.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34263.5646; train_chrom_access_recon_loss: 5032295.2405; train_global_loss: 20522440.9618; train_optim_loss: 20522440.9618; val_kl_reg_loss: 68715.0495; val_edge_recon_loss: 2684739.1833; val_gene_expr_recon_loss: 12590128.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34183.8242; val_chrom_access_recon_loss: 5079347.9000; val_global_loss: 20457114.4000; val_optim_loss: 20457114.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9606; val_auprc_score: 0.9478; val_best_acc_score: 0.9078; val_best_f1_score: 0.9126; train_kl_reg_loss: 68941.3806; train_edge_recon_loss: 2697018.3950; train_gene_expr_recon_loss: 12630021.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33701.0443; train_chrom_access_recon_loss: 5012108.2786; train_global_loss: 20441790.5496; train_optim_loss: 20441790.5496; val_kl_reg_loss: 68171.1068; val_edge_recon_loss: 2723750.2167; val_gene_expr_recon_loss: 12507338.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33340.0469; val_chrom_access_recon_loss: 5073762.0333; val_global_loss: 20406361.6000; val_optim_loss: 20406361.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9607; val_auprc_score: 0.9480; val_best_acc_score: 0.9120; val_best_f1_score: 0.9167; train_kl_reg_loss: 67015.8030; train_edge_recon_loss: 2696297.5248; train_gene_expr_recon_loss: 12587410.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33041.9811; train_chrom_access_recon_loss: 4988793.8435; train_global_loss: 20372559.3435; train_optim_loss: 20372559.3435; val_kl_reg_loss: 63999.2833; val_edge_recon_loss: 2700650.1667; val_gene_expr_recon_loss: 12467777.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33073.9258; val_chrom_access_recon_loss: 5051950.8000; val_global_loss: 20317451.3333; val_optim_loss: 20317451.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9625; val_auprc_score: 0.9510; val_best_acc_score: 0.9085; val_best_f1_score: 0.9130; train_kl_reg_loss: 64648.9337; train_edge_recon_loss: 2700313.6870; train_gene_expr_recon_loss: 12535723.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32695.3506; train_chrom_access_recon_loss: 4966367.4771; train_global_loss: 20299748.7481; train_optim_loss: 20299748.7481; val_kl_reg_loss: 65261.4667; val_edge_recon_loss: 2721456.2500; val_gene_expr_recon_loss: 12399135.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32706.5801; val_chrom_access_recon_loss: 5024688.0667; val_global_loss: 20243247.6000; val_optim_loss: 20243247.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9656; val_auprc_score: 0.9540; val_best_acc_score: 0.9161; val_best_f1_score: 0.9197; train_kl_reg_loss: 63030.5141; train_edge_recon_loss: 2695539.8779; train_gene_expr_recon_loss: 12497357.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32454.0380; train_chrom_access_recon_loss: 4949767.8550; train_global_loss: 20238149.5420; train_optim_loss: 20238149.5420; val_kl_reg_loss: 62653.6581; val_edge_recon_loss: 2715303.5167; val_gene_expr_recon_loss: 12325524.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32524.2422; val_chrom_access_recon_loss: 5002544.5000; val_global_loss: 20138549.7333; val_optim_loss: 20138549.7333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9659; val_auprc_score: 0.9549; val_best_acc_score: 0.9190; val_best_f1_score: 0.9216; train_kl_reg_loss: 63152.7335; train_edge_recon_loss: 2684952.4885; train_gene_expr_recon_loss: 12473812.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32198.7043; train_chrom_access_recon_loss: 4934827.2405; train_global_loss: 20188943.3740; train_optim_loss: 20188943.3740; val_kl_reg_loss: 63517.6628; val_edge_recon_loss: 2688280.3167; val_gene_expr_recon_loss: 12353031.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32073.0234; val_chrom_access_recon_loss: 5002173.3333; val_global_loss: 20139076.0000; val_optim_loss: 20139076.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9653; val_auprc_score: 0.9556; val_best_acc_score: 0.9119; val_best_f1_score: 0.9151; train_kl_reg_loss: 62376.2752; train_edge_recon_loss: 2676771.4447; train_gene_expr_recon_loss: 12428570.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32020.4720; train_chrom_access_recon_loss: 4918354.7214; train_global_loss: 20118093.8473; train_optim_loss: 20118093.8473; val_kl_reg_loss: 62367.5680; val_edge_recon_loss: 2703764.7167; val_gene_expr_recon_loss: 12309798.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31718.0625; val_chrom_access_recon_loss: 4981935.9333; val_global_loss: 20089584.6667; val_optim_loss: 20089584.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9676; val_auprc_score: 0.9584; val_best_acc_score: 0.9146; val_best_f1_score: 0.9174; train_kl_reg_loss: 61170.8818; train_edge_recon_loss: 2677921.3244; train_gene_expr_recon_loss: 12401267.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31900.1255; train_chrom_access_recon_loss: 4905162.0496; train_global_loss: 20077421.9542; train_optim_loss: 20077421.9542; val_kl_reg_loss: 59628.3339; val_edge_recon_loss: 2698963.9167; val_gene_expr_recon_loss: 12297808.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31965.8301; val_chrom_access_recon_loss: 4969995.9667; val_global_loss: 20058362.9333; val_optim_loss: 20058362.9333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9661; val_auprc_score: 0.9528; val_best_acc_score: 0.9158; val_best_f1_score: 0.9193; train_kl_reg_loss: 60305.8651; train_edge_recon_loss: 2676171.7156; train_gene_expr_recon_loss: 12373727.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31859.1203; train_chrom_access_recon_loss: 4896391.2137; train_global_loss: 20038455.7099; train_optim_loss: 20038455.7099; val_kl_reg_loss: 60426.9747; val_edge_recon_loss: 2700484.6167; val_gene_expr_recon_loss: 12237689.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31974.9551; val_chrom_access_recon_loss: 4945677.8000; val_global_loss: 19976253.7333; val_optim_loss: 19976253.7333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9730; val_auprc_score: 0.9662; val_best_acc_score: 0.9213; val_best_f1_score: 0.9238; train_kl_reg_loss: 59479.8568; train_edge_recon_loss: 2678253.5992; train_gene_expr_recon_loss: 12347822.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31938.5951; train_chrom_access_recon_loss: 4881111.6183; train_global_loss: 19998606.5038; train_optim_loss: 19998606.5038; val_kl_reg_loss: 59927.7107; val_edge_recon_loss: 2669870.8833; val_gene_expr_recon_loss: 12228263.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31722.1719; val_chrom_access_recon_loss: 4945614.2333; val_global_loss: 19935398.2667; val_optim_loss: 19935398.2667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9708; val_auprc_score: 0.9616; val_best_acc_score: 0.9198; val_best_f1_score: 0.9238; train_kl_reg_loss: 58098.5062; train_edge_recon_loss: 2676038.8760; train_gene_expr_recon_loss: 12333022.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31786.7789; train_chrom_access_recon_loss: 4874058.9733; train_global_loss: 19973005.8015; train_optim_loss: 19973005.8015; val_kl_reg_loss: 56982.6742; val_edge_recon_loss: 2682483.2333; val_gene_expr_recon_loss: 12171146.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32053.3965; val_chrom_access_recon_loss: 4945212.7667; val_global_loss: 19887877.7333; val_optim_loss: 19887877.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9726; val_auprc_score: 0.9623; val_best_acc_score: 0.9255; val_best_f1_score: 0.9281; train_kl_reg_loss: 57441.5615; train_edge_recon_loss: 2670889.3874; train_gene_expr_recon_loss: 12305359.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31920.2914; train_chrom_access_recon_loss: 4856067.1832; train_global_loss: 19921678.2290; train_optim_loss: 19921678.2290; val_kl_reg_loss: 56183.8578; val_edge_recon_loss: 2688419.2500; val_gene_expr_recon_loss: 12232531.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31956.0918; val_chrom_access_recon_loss: 4955956.4000; val_global_loss: 19965046.9333; val_optim_loss: 19965046.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9742; val_auprc_score: 0.9640; val_best_acc_score: 0.9283; val_best_f1_score: 0.9311; train_kl_reg_loss: 56577.6130; train_edge_recon_loss: 2662742.2309; train_gene_expr_recon_loss: 12274669.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31972.8935; train_chrom_access_recon_loss: 4843927.6527; train_global_loss: 19869889.5573; train_optim_loss: 19869889.5573; val_kl_reg_loss: 57027.5115; val_edge_recon_loss: 2682783.5500; val_gene_expr_recon_loss: 12207538.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32090.3281; val_chrom_access_recon_loss: 4931262.1667; val_global_loss: 19910702.0000; val_optim_loss: 19910702.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9758; val_auprc_score: 0.9687; val_best_acc_score: 0.9321; val_best_f1_score: 0.9346; train_kl_reg_loss: 56234.7881; train_edge_recon_loss: 2674441.0630; train_gene_expr_recon_loss: 12216751.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28303.5035; train_chrom_access_recon_loss: 4852168.8435; train_global_loss: 19827899.9389; train_optim_loss: 19827899.9389; val_kl_reg_loss: 48200.2185; val_edge_recon_loss: 2682097.3667; val_gene_expr_recon_loss: 12105102.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27764.2578; val_chrom_access_recon_loss: 4909111.3333; val_global_loss: 19772275.2000; val_optim_loss: 19772275.2000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9763; val_auprc_score: 0.9676; val_best_acc_score: 0.9332; val_best_f1_score: 0.9340; train_kl_reg_loss: 54999.6837; train_edge_recon_loss: 2668627.7653; train_gene_expr_recon_loss: 12186407.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27454.3360; train_chrom_access_recon_loss: 4836167.6603; train_global_loss: 19773656.9313; train_optim_loss: 19773656.9313; val_kl_reg_loss: 47793.9148; val_edge_recon_loss: 2677082.1000; val_gene_expr_recon_loss: 12093459.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26946.7285; val_chrom_access_recon_loss: 4903138.3333; val_global_loss: 19748421.0667; val_optim_loss: 19748421.0667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9785; val_auprc_score: 0.9721; val_best_acc_score: 0.9355; val_best_f1_score: 0.9371; train_kl_reg_loss: 54096.1172; train_edge_recon_loss: 2667080.5668; train_gene_expr_recon_loss: 12167946.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26787.0929; train_chrom_access_recon_loss: 4829656.2099; train_global_loss: 19745566.9771; train_optim_loss: 19745566.9771; val_kl_reg_loss: 47117.1628; val_edge_recon_loss: 2661288.2500; val_gene_expr_recon_loss: 12064041.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26735.6387; val_chrom_access_recon_loss: 4875768.3333; val_global_loss: 19674951.0667; val_optim_loss: 19674951.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9778; val_auprc_score: 0.9717; val_best_acc_score: 0.9365; val_best_f1_score: 0.9390; train_kl_reg_loss: 53040.2301; train_edge_recon_loss: 2674662.4847; train_gene_expr_recon_loss: 12138412.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26787.6281; train_chrom_access_recon_loss: 4818082.3664; train_global_loss: 19710985.1603; train_optim_loss: 19710985.1603; val_kl_reg_loss: 46467.5536; val_edge_recon_loss: 2673534.1333; val_gene_expr_recon_loss: 12125018.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26940.8027; val_chrom_access_recon_loss: 4928411.2333; val_global_loss: 19800372.2667; val_optim_loss: 19800372.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9812; val_auprc_score: 0.9747; val_best_acc_score: 0.9386; val_best_f1_score: 0.9401; train_kl_reg_loss: 52339.9543; train_edge_recon_loss: 2660369.5153; train_gene_expr_recon_loss: 12132041.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26856.1478; train_chrom_access_recon_loss: 4813811.5267; train_global_loss: 19685418.2901; train_optim_loss: 19685418.2901; val_kl_reg_loss: 47468.8430; val_edge_recon_loss: 2658215.0167; val_gene_expr_recon_loss: 12040399.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26973.2949; val_chrom_access_recon_loss: 4877907.9333; val_global_loss: 19650964.0000; val_optim_loss: 19650964.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9781; val_auprc_score: 0.9710; val_best_acc_score: 0.9356; val_best_f1_score: 0.9373; train_kl_reg_loss: 51103.1300; train_edge_recon_loss: 2661678.8454; train_gene_expr_recon_loss: 12120219.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27018.1095; train_chrom_access_recon_loss: 4811149.8702; train_global_loss: 19671169.9542; train_optim_loss: 19671169.9542; val_kl_reg_loss: 46249.3133; val_edge_recon_loss: 2669467.9833; val_gene_expr_recon_loss: 11994719.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27029.0410; val_chrom_access_recon_loss: 4860137.4000; val_global_loss: 19597603.8667; val_optim_loss: 19597603.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9812; val_auprc_score: 0.9760; val_best_acc_score: 0.9407; val_best_f1_score: 0.9422; train_kl_reg_loss: 50061.8469; train_edge_recon_loss: 2656560.5954; train_gene_expr_recon_loss: 12094280.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27123.5672; train_chrom_access_recon_loss: 4801134.2443; train_global_loss: 19629160.5802; train_optim_loss: 19629160.5802; val_kl_reg_loss: 46001.4021; val_edge_recon_loss: 2667888.2000; val_gene_expr_recon_loss: 12038612.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27203.6465; val_chrom_access_recon_loss: 4863532.9667; val_global_loss: 19643238.5333; val_optim_loss: 19643238.5333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9795; val_auprc_score: 0.9718; val_best_acc_score: 0.9375; val_best_f1_score: 0.9392; train_kl_reg_loss: 49417.1085; train_edge_recon_loss: 2661737.8511; train_gene_expr_recon_loss: 12083557.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27229.0024; train_chrom_access_recon_loss: 4794195.9809; train_global_loss: 19616137.1756; train_optim_loss: 19616137.1756; val_kl_reg_loss: 46256.0190; val_edge_recon_loss: 2652892.4500; val_gene_expr_recon_loss: 12051417.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27221.9609; val_chrom_access_recon_loss: 4882081.9667; val_global_loss: 19659870.0000; val_optim_loss: 19659870.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9804; val_auprc_score: 0.9723; val_best_acc_score: 0.9376; val_best_f1_score: 0.9397; train_kl_reg_loss: 48787.8604; train_edge_recon_loss: 2655202.4790; train_gene_expr_recon_loss: 12078673.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27311.2555; train_chrom_access_recon_loss: 4796761.5573; train_global_loss: 19606736.1832; train_optim_loss: 19606736.1832; val_kl_reg_loss: 45332.8971; val_edge_recon_loss: 2691521.5167; val_gene_expr_recon_loss: 11984527.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27373.4805; val_chrom_access_recon_loss: 4849474.1000; val_global_loss: 19598229.6000; val_optim_loss: 19598229.6000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9841; val_auprc_score: 0.9803; val_best_acc_score: 0.9435; val_best_f1_score: 0.9447; train_kl_reg_loss: 47773.5886; train_edge_recon_loss: 2666068.2481; train_gene_expr_recon_loss: 12066705.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27434.7915; train_chrom_access_recon_loss: 4788360.8435; train_global_loss: 19596342.5496; train_optim_loss: 19596342.5496; val_kl_reg_loss: 43506.9034; val_edge_recon_loss: 2662777.0833; val_gene_expr_recon_loss: 12005707.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27579.5859; val_chrom_access_recon_loss: 4863377.9000; val_global_loss: 19602948.8000; val_optim_loss: 19602948.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9827; val_auprc_score: 0.9738; val_best_acc_score: 0.9419; val_best_f1_score: 0.9435; train_kl_reg_loss: 48059.7031; train_edge_recon_loss: 2650265.3321; train_gene_expr_recon_loss: 12027752.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24981.1025; train_chrom_access_recon_loss: 4772178.3130; train_global_loss: 19523237.2519; train_optim_loss: 19523237.2519; val_kl_reg_loss: 46389.7888; val_edge_recon_loss: 2659050.7333; val_gene_expr_recon_loss: 11955149.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24613.9531; val_chrom_access_recon_loss: 4860479.0000; val_global_loss: 19545682.8000; val_optim_loss: 19545682.8000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9806; val_auprc_score: 0.9729; val_best_acc_score: 0.9369; val_best_f1_score: 0.9379; train_kl_reg_loss: 49535.8100; train_edge_recon_loss: 2648220.4943; train_gene_expr_recon_loss: 12026444.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24512.3825; train_chrom_access_recon_loss: 4771649.1870; train_global_loss: 19520362.0000; train_optim_loss: 19520362.0000; val_kl_reg_loss: 47046.0437; val_edge_recon_loss: 2683325.6000; val_gene_expr_recon_loss: 12027974.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24402.1445; val_chrom_access_recon_loss: 4869541.2000; val_global_loss: 19652289.3333; val_optim_loss: 19652289.3333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9825; val_auprc_score: 0.9783; val_best_acc_score: 0.9396; val_best_f1_score: 0.9417; train_kl_reg_loss: 49617.1510; train_edge_recon_loss: 2648934.7061; train_gene_expr_recon_loss: 12028391.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24332.6684; train_chrom_access_recon_loss: 4774416.6794; train_global_loss: 19525692.3206; train_optim_loss: 19525692.3206; val_kl_reg_loss: 47179.9497; val_edge_recon_loss: 2651120.2833; val_gene_expr_recon_loss: 11984077.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24261.2344; val_chrom_access_recon_loss: 4851581.7333; val_global_loss: 19558220.2667; val_optim_loss: 19558220.2667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9805; val_auprc_score: 0.9741; val_best_acc_score: 0.9396; val_best_f1_score: 0.9406; train_kl_reg_loss: 49400.8707; train_edge_recon_loss: 2651875.4389; train_gene_expr_recon_loss: 12025575.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24213.9307; train_chrom_access_recon_loss: 4771972.0763; train_global_loss: 19523037.6641; train_optim_loss: 19523037.6641; val_kl_reg_loss: 47216.3135; val_edge_recon_loss: 2684942.0667; val_gene_expr_recon_loss: 11991184.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24167.9590; val_chrom_access_recon_loss: 4878450.8333; val_global_loss: 19625961.7333; val_optim_loss: 19625961.7333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9844; val_auprc_score: 0.9778; val_best_acc_score: 0.9421; val_best_f1_score: 0.9433; train_kl_reg_loss: 49227.4879; train_edge_recon_loss: 2650548.1565; train_gene_expr_recon_loss: 12020471.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24119.4432; train_chrom_access_recon_loss: 4772283.6183; train_global_loss: 19516649.7863; train_optim_loss: 19516649.7863; val_kl_reg_loss: 46634.4154; val_edge_recon_loss: 2662468.5000; val_gene_expr_recon_loss: 12002139.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24064.5059; val_chrom_access_recon_loss: 4853130.2333; val_global_loss: 19588437.8667; val_optim_loss: 19588437.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9846; val_auprc_score: 0.9792; val_best_acc_score: 0.9457; val_best_f1_score: 0.9469; train_kl_reg_loss: 48977.8609; train_edge_recon_loss: 2649562.9618; train_gene_expr_recon_loss: 12028379.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23799.0396; train_chrom_access_recon_loss: 4770952.7519; train_global_loss: 19521672.3359; train_optim_loss: 19521672.3359; val_kl_reg_loss: 47115.0924; val_edge_recon_loss: 2645461.9833; val_gene_expr_recon_loss: 12042726.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23768.1719; val_chrom_access_recon_loss: 4890457.2333; val_global_loss: 19649528.2667; val_optim_loss: 19649528.2667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9825; val_auprc_score: 0.9783; val_best_acc_score: 0.9406; val_best_f1_score: 0.9421; train_kl_reg_loss: 49095.3245; train_edge_recon_loss: 2645658.3664; train_gene_expr_recon_loss: 12019643.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23759.1903; train_chrom_access_recon_loss: 4769386.4542; train_global_loss: 19507542.8550; train_optim_loss: 19507542.8550; val_kl_reg_loss: 46919.2893; val_edge_recon_loss: 2655916.4500; val_gene_expr_recon_loss: 12001330.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23750.9043; val_chrom_access_recon_loss: 4864612.1667; val_global_loss: 19592530.1333; val_optim_loss: 19592530.1333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9840; val_auprc_score: 0.9807; val_best_acc_score: 0.9434; val_best_f1_score: 0.9447; train_kl_reg_loss: 49084.3750; train_edge_recon_loss: 2648274.7691; train_gene_expr_recon_loss: 12020528.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23744.1247; train_chrom_access_recon_loss: 4769334.0267; train_global_loss: 19510965.6947; train_optim_loss: 19510965.6947; val_kl_reg_loss: 47170.0398; val_edge_recon_loss: 2652077.4500; val_gene_expr_recon_loss: 12002294.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23737.7559; val_chrom_access_recon_loss: 4865975.5667; val_global_loss: 19591256.1333; val_optim_loss: 19591256.1333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9850; val_auprc_score: 0.9810; val_best_acc_score: 0.9438; val_best_f1_score: 0.9445; train_kl_reg_loss: 49282.9727; train_edge_recon_loss: 2644306.6660; train_gene_expr_recon_loss: 12011291.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23731.2344; train_chrom_access_recon_loss: 4771350.5305; train_global_loss: 19499962.7786; train_optim_loss: 19499962.7786; val_kl_reg_loss: 47131.8779; val_edge_recon_loss: 2648249.9833; val_gene_expr_recon_loss: 11998620.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23725.3281; val_chrom_access_recon_loss: 4848522.2333; val_global_loss: 19566249.2000; val_optim_loss: 19566249.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 67 min 10 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9823
val AUPRC score: 0.9741
val best accuracy score: 0.9404
val best F1 score: 0.9419
val target rna MSE score: 0.9320
val source rna MSE score: 0.2177
val target atac MSE score: 0.5241
val source atac MSE score: 0.0821
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
