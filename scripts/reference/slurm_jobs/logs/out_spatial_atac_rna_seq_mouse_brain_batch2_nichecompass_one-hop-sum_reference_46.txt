[True]
Run timestamp: 10082023_205637_46.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_46']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7879; val_auprc_score: 0.8096; val_best_acc_score: 0.5253; val_best_f1_score: 0.6756; train_kl_reg_loss: 182565.6991; train_edge_recon_loss: 3873987.8416; train_gene_expr_recon_loss: 28742122.2901; train_masked_gp_l1_reg_loss: 80540.8123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244778.1178; train_chrom_access_recon_loss: 124907846.9008; train_global_loss: 158031841.2214; train_optim_loss: 158031841.2214; val_kl_reg_loss: 200009.2333; val_edge_recon_loss: 4063083.8167; val_gene_expr_recon_loss: 23561015.8667; val_masked_gp_l1_reg_loss: 76570.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240178.3750; val_chrom_access_recon_loss: 115071264.0000; val_global_loss: 143212120.5333; val_optim_loss: 143212120.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8088; val_auprc_score: 0.8256; val_best_acc_score: 0.7160; val_best_f1_score: 0.7291; train_kl_reg_loss: 202438.6304; train_edge_recon_loss: 3720730.5840; train_gene_expr_recon_loss: 23033711.4046; train_masked_gp_l1_reg_loss: 73086.6814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233057.7090; train_chrom_access_recon_loss: 115707385.7099; train_global_loss: 142970410.0153; train_optim_loss: 142970410.0153; val_kl_reg_loss: 195195.5125; val_edge_recon_loss: 4005992.7167; val_gene_expr_recon_loss: 22293811.4667; val_masked_gp_l1_reg_loss: 70869.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224693.4062; val_chrom_access_recon_loss: 113178789.3333; val_global_loss: 139969353.6000; val_optim_loss: 139969353.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8767; val_auprc_score: 0.8729; val_best_acc_score: 0.7856; val_best_f1_score: 0.7947; train_kl_reg_loss: 198442.3756; train_edge_recon_loss: 3469012.0477; train_gene_expr_recon_loss: 22303058.0305; train_masked_gp_l1_reg_loss: 70988.8581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 215742.9962; train_chrom_access_recon_loss: 114533712.6718; train_global_loss: 140790956.6412; train_optim_loss: 140790956.6412; val_kl_reg_loss: 202925.1938; val_edge_recon_loss: 3229082.5167; val_gene_expr_recon_loss: 22094546.8000; val_masked_gp_l1_reg_loss: 72023.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 206674.6562; val_chrom_access_recon_loss: 112378763.7333; val_global_loss: 138184014.9333; val_optim_loss: 138184014.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8951; val_auprc_score: 0.8833; val_best_acc_score: 0.8077; val_best_f1_score: 0.8233; train_kl_reg_loss: 229394.6243; train_edge_recon_loss: 3108893.6660; train_gene_expr_recon_loss: 22074613.3740; train_masked_gp_l1_reg_loss: 72902.8663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197967.7964; train_chrom_access_recon_loss: 113838506.3206; train_global_loss: 139522278.2290; train_optim_loss: 139522278.2290; val_kl_reg_loss: 225811.0208; val_edge_recon_loss: 3060236.7833; val_gene_expr_recon_loss: 21930621.8667; val_masked_gp_l1_reg_loss: 74173.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189405.8125; val_chrom_access_recon_loss: 112218065.0667; val_global_loss: 137698316.8000; val_optim_loss: 137698316.8000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9095; val_auprc_score: 0.9002; val_best_acc_score: 0.8275; val_best_f1_score: 0.8402; train_kl_reg_loss: 226552.8824; train_edge_recon_loss: 3025806.0019; train_gene_expr_recon_loss: 21929919.5420; train_masked_gp_l1_reg_loss: 74873.7463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181571.2855; train_chrom_access_recon_loss: 113234048.4885; train_global_loss: 138672771.6031; train_optim_loss: 138672771.6031; val_kl_reg_loss: 211648.2250; val_edge_recon_loss: 3009035.5667; val_gene_expr_recon_loss: 21740321.2000; val_masked_gp_l1_reg_loss: 75717.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173949.4062; val_chrom_access_recon_loss: 111288449.0667; val_global_loss: 136499121.6000; val_optim_loss: 136499121.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9208; val_auprc_score: 0.9109; val_best_acc_score: 0.8434; val_best_f1_score: 0.8527; train_kl_reg_loss: 215388.3401; train_edge_recon_loss: 2981875.1794; train_gene_expr_recon_loss: 21760801.0992; train_masked_gp_l1_reg_loss: 76557.7797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166925.3218; train_chrom_access_recon_loss: 112472897.0992; train_global_loss: 137674444.8855; train_optim_loss: 137674444.8855; val_kl_reg_loss: 207316.0052; val_edge_recon_loss: 2973749.7000; val_gene_expr_recon_loss: 21619517.6000; val_masked_gp_l1_reg_loss: 77493.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160136.6875; val_chrom_access_recon_loss: 110899814.9333; val_global_loss: 135938025.6000; val_optim_loss: 135938025.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9336; val_auprc_score: 0.9241; val_best_acc_score: 0.8579; val_best_f1_score: 0.8659; train_kl_reg_loss: 210136.0902; train_edge_recon_loss: 2935585.0305; train_gene_expr_recon_loss: 21612913.1908; train_masked_gp_l1_reg_loss: 78397.5125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154021.6503; train_chrom_access_recon_loss: 111711457.8321; train_global_loss: 136702511.2061; train_optim_loss: 136702511.2061; val_kl_reg_loss: 211076.3656; val_edge_recon_loss: 2917922.6833; val_gene_expr_recon_loss: 21612040.5333; val_masked_gp_l1_reg_loss: 79309.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148126.8281; val_chrom_access_recon_loss: 110890883.2000; val_global_loss: 135859356.8000; val_optim_loss: 135859356.8000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9409; val_auprc_score: 0.9290; val_best_acc_score: 0.8693; val_best_f1_score: 0.8768; train_kl_reg_loss: 206660.8010; train_edge_recon_loss: 2903851.9866; train_gene_expr_recon_loss: 21550871.3435; train_masked_gp_l1_reg_loss: 80330.4682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142761.0111; train_chrom_access_recon_loss: 111542300.8244; train_global_loss: 136426777.0992; train_optim_loss: 136426777.0992; val_kl_reg_loss: 200971.0990; val_edge_recon_loss: 2897174.6500; val_gene_expr_recon_loss: 21413895.7333; val_masked_gp_l1_reg_loss: 81304.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137628.2656; val_chrom_access_recon_loss: 109850525.3333; val_global_loss: 134581498.6667; val_optim_loss: 134581498.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9380; val_auprc_score: 0.9282; val_best_acc_score: 0.8646; val_best_f1_score: 0.8739; train_kl_reg_loss: 200416.8664; train_edge_recon_loss: 2878463.8664; train_gene_expr_recon_loss: 21447387.6336; train_masked_gp_l1_reg_loss: 82327.7833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132823.6175; train_chrom_access_recon_loss: 110994056.3053; train_global_loss: 135735475.8473; train_optim_loss: 135735475.8473; val_kl_reg_loss: 194558.4896; val_edge_recon_loss: 2912793.3667; val_gene_expr_recon_loss: 21355108.8000; val_masked_gp_l1_reg_loss: 83246.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128031.8125; val_chrom_access_recon_loss: 109745676.2667; val_global_loss: 134419415.4667; val_optim_loss: 134419415.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9433; val_auprc_score: 0.9335; val_best_acc_score: 0.8731; val_best_f1_score: 0.8809; train_kl_reg_loss: 195845.4894; train_edge_recon_loss: 2861594.0229; train_gene_expr_recon_loss: 21367878.7176; train_masked_gp_l1_reg_loss: 84118.3847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123708.8048; train_chrom_access_recon_loss: 110700889.6489; train_global_loss: 135334034.9313; train_optim_loss: 135334034.9313; val_kl_reg_loss: 190497.6448; val_edge_recon_loss: 2864495.9833; val_gene_expr_recon_loss: 21208051.4667; val_masked_gp_l1_reg_loss: 85235.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119512.1250; val_chrom_access_recon_loss: 108459090.6667; val_global_loss: 132926883.2000; val_optim_loss: 132926883.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9454; val_auprc_score: 0.9341; val_best_acc_score: 0.8791; val_best_f1_score: 0.8867; train_kl_reg_loss: 190178.2221; train_edge_recon_loss: 2852239.8302; train_gene_expr_recon_loss: 21272251.2061; train_masked_gp_l1_reg_loss: 86052.2142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115602.0831; train_chrom_access_recon_loss: 110060784.6107; train_global_loss: 134577108.1527; train_optim_loss: 134577108.1527; val_kl_reg_loss: 187688.1521; val_edge_recon_loss: 2873883.9833; val_gene_expr_recon_loss: 21237829.8667; val_masked_gp_l1_reg_loss: 86811.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111800.2188; val_chrom_access_recon_loss: 109010891.7333; val_global_loss: 133508907.7333; val_optim_loss: 133508907.7333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9493; val_auprc_score: 0.9398; val_best_acc_score: 0.8870; val_best_f1_score: 0.8930; train_kl_reg_loss: 183483.0867; train_edge_recon_loss: 2836443.3454; train_gene_expr_recon_loss: 21228842.9160; train_masked_gp_l1_reg_loss: 87689.0490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108415.4573; train_chrom_access_recon_loss: 109837436.0916; train_global_loss: 134282310.4733; train_optim_loss: 134282310.4733; val_kl_reg_loss: 182644.3927; val_edge_recon_loss: 2843906.6000; val_gene_expr_recon_loss: 21131128.4000; val_masked_gp_l1_reg_loss: 88627.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105122.0547; val_chrom_access_recon_loss: 108897714.6667; val_global_loss: 133249143.4667; val_optim_loss: 133249143.4667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9561; val_auprc_score: 0.9485; val_best_acc_score: 0.8954; val_best_f1_score: 0.9009; train_kl_reg_loss: 179573.5089; train_edge_recon_loss: 2822674.7042; train_gene_expr_recon_loss: 21224974.7786; train_masked_gp_l1_reg_loss: 89423.0919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102156.7165; train_chrom_access_recon_loss: 109469426.5038; train_global_loss: 133888229.0076; train_optim_loss: 133888229.0076; val_kl_reg_loss: 175610.0708; val_edge_recon_loss: 2824399.9833; val_gene_expr_recon_loss: 21081005.6000; val_masked_gp_l1_reg_loss: 90228.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99328.4531; val_chrom_access_recon_loss: 107849912.0000; val_global_loss: 132120484.2667; val_optim_loss: 132120484.2667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9568; val_auprc_score: 0.9501; val_best_acc_score: 0.8934; val_best_f1_score: 0.8986; train_kl_reg_loss: 176059.1174; train_edge_recon_loss: 2818610.2824; train_gene_expr_recon_loss: 21097252.7786; train_masked_gp_l1_reg_loss: 91063.5109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96660.7226; train_chrom_access_recon_loss: 109031524.8244; train_global_loss: 133311170.6260; train_optim_loss: 133311170.6260; val_kl_reg_loss: 176470.0000; val_edge_recon_loss: 2832011.0500; val_gene_expr_recon_loss: 20976898.0000; val_masked_gp_l1_reg_loss: 91826.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94218.3516; val_chrom_access_recon_loss: 107297410.1333; val_global_loss: 131468833.0667; val_optim_loss: 131468833.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9602; val_auprc_score: 0.9533; val_best_acc_score: 0.9003; val_best_f1_score: 0.9048; train_kl_reg_loss: 173045.2805; train_edge_recon_loss: 2804357.8225; train_gene_expr_recon_loss: 21028469.2672; train_masked_gp_l1_reg_loss: 92542.0340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91958.6208; train_chrom_access_recon_loss: 108690508.5802; train_global_loss: 132880881.4046; train_optim_loss: 132880881.4046; val_kl_reg_loss: 169197.5406; val_edge_recon_loss: 2817941.4833; val_gene_expr_recon_loss: 20905870.1333; val_masked_gp_l1_reg_loss: 93375.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89792.2031; val_chrom_access_recon_loss: 107079762.1333; val_global_loss: 131155939.7333; val_optim_loss: 131155939.7333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9610; val_auprc_score: 0.9526; val_best_acc_score: 0.9035; val_best_f1_score: 0.9079; train_kl_reg_loss: 168419.2439; train_edge_recon_loss: 2806363.1145; train_gene_expr_recon_loss: 21000293.3740; train_masked_gp_l1_reg_loss: 94135.7420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87960.4534; train_chrom_access_recon_loss: 108461226.2595; train_global_loss: 132618397.4351; train_optim_loss: 132618397.4351; val_kl_reg_loss: 164711.7302; val_edge_recon_loss: 2812607.1167; val_gene_expr_recon_loss: 20911062.9333; val_masked_gp_l1_reg_loss: 95014.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86199.2188; val_chrom_access_recon_loss: 107157046.9333; val_global_loss: 131226643.2000; val_optim_loss: 131226643.2000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9604; val_auprc_score: 0.9539; val_best_acc_score: 0.8992; val_best_f1_score: 0.9038; train_kl_reg_loss: 164703.2607; train_edge_recon_loss: 2801550.4084; train_gene_expr_recon_loss: 20939424.8092; train_masked_gp_l1_reg_loss: 95703.6375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84567.1069; train_chrom_access_recon_loss: 108065880.3053; train_global_loss: 132151829.4351; train_optim_loss: 132151829.4351; val_kl_reg_loss: 164370.7490; val_edge_recon_loss: 2825263.7833; val_gene_expr_recon_loss: 20952524.4000; val_masked_gp_l1_reg_loss: 96319.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82983.5625; val_chrom_access_recon_loss: 107502707.2000; val_global_loss: 131624169.0667; val_optim_loss: 131624169.0667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9645; val_auprc_score: 0.9556; val_best_acc_score: 0.9042; val_best_f1_score: 0.9089; train_kl_reg_loss: 161577.2450; train_edge_recon_loss: 2795039.9847; train_gene_expr_recon_loss: 20915813.1908; train_masked_gp_l1_reg_loss: 97064.5092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81424.0584; train_chrom_access_recon_loss: 108074336.0000; train_global_loss: 132125255.6336; train_optim_loss: 132125255.6336; val_kl_reg_loss: 159032.9469; val_edge_recon_loss: 2820401.8667; val_gene_expr_recon_loss: 20857891.2000; val_masked_gp_l1_reg_loss: 97834.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79956.4375; val_chrom_access_recon_loss: 106811685.3333; val_global_loss: 130826801.0667; val_optim_loss: 130826801.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9671; val_auprc_score: 0.9577; val_best_acc_score: 0.9104; val_best_f1_score: 0.9144; train_kl_reg_loss: 158562.0798; train_edge_recon_loss: 2783895.6469; train_gene_expr_recon_loss: 20892134.2595; train_masked_gp_l1_reg_loss: 98597.9321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78592.3966; train_chrom_access_recon_loss: 107944773.4351; train_global_loss: 131956555.8473; train_optim_loss: 131956555.8473; val_kl_reg_loss: 162582.5573; val_edge_recon_loss: 2785150.2833; val_gene_expr_recon_loss: 20805572.9333; val_masked_gp_l1_reg_loss: 99361.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77113.0859; val_chrom_access_recon_loss: 106769682.6667; val_global_loss: 130699465.0667; val_optim_loss: 130699465.0667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9690; val_auprc_score: 0.9620; val_best_acc_score: 0.9116; val_best_f1_score: 0.9161; train_kl_reg_loss: 157430.6881; train_edge_recon_loss: 2781697.2615; train_gene_expr_recon_loss: 20851883.7710; train_masked_gp_l1_reg_loss: 99922.2564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75830.9246; train_chrom_access_recon_loss: 107567246.9008; train_global_loss: 131534011.8473; train_optim_loss: 131534011.8473; val_kl_reg_loss: 155388.7167; val_edge_recon_loss: 2801764.3833; val_gene_expr_recon_loss: 20843676.4000; val_masked_gp_l1_reg_loss: 100496.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74571.4219; val_chrom_access_recon_loss: 106545023.4667; val_global_loss: 130520921.6000; val_optim_loss: 130520921.6000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9690; val_auprc_score: 0.9598; val_best_acc_score: 0.9173; val_best_f1_score: 0.9195; train_kl_reg_loss: 154576.1898; train_edge_recon_loss: 2774676.9485; train_gene_expr_recon_loss: 20811617.2519; train_masked_gp_l1_reg_loss: 101195.3203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73240.9470; train_chrom_access_recon_loss: 107424773.1908; train_global_loss: 131340079.8168; train_optim_loss: 131340079.8168; val_kl_reg_loss: 152257.2354; val_edge_recon_loss: 2796346.5000; val_gene_expr_recon_loss: 20729347.4667; val_masked_gp_l1_reg_loss: 101649.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71974.3984; val_chrom_access_recon_loss: 106014784.5333; val_global_loss: 129866360.5333; val_optim_loss: 129866360.5333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9724; val_auprc_score: 0.9655; val_best_acc_score: 0.9202; val_best_f1_score: 0.9222; train_kl_reg_loss: 153610.7444; train_edge_recon_loss: 2770659.1393; train_gene_expr_recon_loss: 20809796.2290; train_masked_gp_l1_reg_loss: 102469.2489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70749.4199; train_chrom_access_recon_loss: 107441623.7557; train_global_loss: 131348908.9466; train_optim_loss: 131348908.9466; val_kl_reg_loss: 154286.5219; val_edge_recon_loss: 2766844.9500; val_gene_expr_recon_loss: 20813238.4000; val_masked_gp_l1_reg_loss: 103046.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69606.8047; val_chrom_access_recon_loss: 106360359.4667; val_global_loss: 130267381.8667; val_optim_loss: 130267381.8667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9688; val_auprc_score: 0.9598; val_best_acc_score: 0.9175; val_best_f1_score: 0.9206; train_kl_reg_loss: 151594.2519; train_edge_recon_loss: 2771038.6298; train_gene_expr_recon_loss: 20788118.8702; train_masked_gp_l1_reg_loss: 103744.6294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68544.1211; train_chrom_access_recon_loss: 107284842.8092; train_global_loss: 131167883.1756; train_optim_loss: 131167883.1756; val_kl_reg_loss: 150032.4792; val_edge_recon_loss: 2790789.7667; val_gene_expr_recon_loss: 20647462.5333; val_masked_gp_l1_reg_loss: 104306.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67474.5938; val_chrom_access_recon_loss: 105215856.5333; val_global_loss: 128975921.0667; val_optim_loss: 128975921.0667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9710; val_auprc_score: 0.9646; val_best_acc_score: 0.9181; val_best_f1_score: 0.9216; train_kl_reg_loss: 150138.0471; train_edge_recon_loss: 2772013.2099; train_gene_expr_recon_loss: 20743210.1832; train_masked_gp_l1_reg_loss: 104907.0126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66406.1887; train_chrom_access_recon_loss: 106985710.5954; train_global_loss: 130822384.8550; train_optim_loss: 130822384.8550; val_kl_reg_loss: 151398.6792; val_edge_recon_loss: 2780142.0833; val_gene_expr_recon_loss: 20700226.2667; val_masked_gp_l1_reg_loss: 105572.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65550.0859; val_chrom_access_recon_loss: 105629281.6000; val_global_loss: 129432171.2000; val_optim_loss: 129432171.2000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9706; val_auprc_score: 0.9660; val_best_acc_score: 0.9182; val_best_f1_score: 0.9210; train_kl_reg_loss: 149884.1721; train_edge_recon_loss: 2766712.7080; train_gene_expr_recon_loss: 20725618.3664; train_masked_gp_l1_reg_loss: 106151.0410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64594.7507; train_chrom_access_recon_loss: 106834541.3740; train_global_loss: 130647502.9008; train_optim_loss: 130647502.9008; val_kl_reg_loss: 151093.8542; val_edge_recon_loss: 2793433.8833; val_gene_expr_recon_loss: 20686319.3333; val_masked_gp_l1_reg_loss: 106634.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63763.2070; val_chrom_access_recon_loss: 105692886.4000; val_global_loss: 129494130.6667; val_optim_loss: 129494130.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9696; val_auprc_score: 0.9643; val_best_acc_score: 0.9120; val_best_f1_score: 0.9153; train_kl_reg_loss: 165461.4967; train_edge_recon_loss: 2856734.7099; train_gene_expr_recon_loss: 21906795.4198; train_masked_gp_l1_reg_loss: 104874.0893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63787.1367; train_chrom_access_recon_loss: 108733506.0763; train_global_loss: 133831158.5954; train_optim_loss: 133831158.5954; val_kl_reg_loss: 71367.7766; val_edge_recon_loss: 2825509.5500; val_gene_expr_recon_loss: 21672228.4000; val_masked_gp_l1_reg_loss: 103757.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63120.5156; val_chrom_access_recon_loss: 107202306.1333; val_global_loss: 131938289.0667; val_optim_loss: 131938289.0667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9723; val_auprc_score: 0.9679; val_best_acc_score: 0.9166; val_best_f1_score: 0.9197; train_kl_reg_loss: 147864.9441; train_edge_recon_loss: 2795453.9943; train_gene_expr_recon_loss: 21732888.3511; train_masked_gp_l1_reg_loss: 103249.1629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62247.1135; train_chrom_access_recon_loss: 108327875.6641; train_global_loss: 133169579.4198; train_optim_loss: 133169579.4198; val_kl_reg_loss: 77909.2635; val_edge_recon_loss: 2804404.5667; val_gene_expr_recon_loss: 21612579.4667; val_masked_gp_l1_reg_loss: 102761.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61175.5977; val_chrom_access_recon_loss: 106938139.2000; val_global_loss: 131596970.1333; val_optim_loss: 131596970.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9699; val_auprc_score: 0.9607; val_best_acc_score: 0.9144; val_best_f1_score: 0.9171; train_kl_reg_loss: 141396.3873; train_edge_recon_loss: 2781936.5992; train_gene_expr_recon_loss: 21724780.2443; train_masked_gp_l1_reg_loss: 102321.0565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60914.0233; train_chrom_access_recon_loss: 108392127.1450; train_global_loss: 133203475.4198; train_optim_loss: 133203475.4198; val_kl_reg_loss: 77692.9187; val_edge_recon_loss: 2791026.7833; val_gene_expr_recon_loss: 21737935.8667; val_masked_gp_l1_reg_loss: 102186.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60723.8711; val_chrom_access_recon_loss: 107273158.4000; val_global_loss: 132042723.2000; val_optim_loss: 132042723.2000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9711; val_auprc_score: 0.9655; val_best_acc_score: 0.9135; val_best_f1_score: 0.9156; train_kl_reg_loss: 141852.9345; train_edge_recon_loss: 2786354.4599; train_gene_expr_recon_loss: 21826352.0458; train_masked_gp_l1_reg_loss: 102111.9739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60594.1225; train_chrom_access_recon_loss: 108609294.5954; train_global_loss: 133526560.0611; train_optim_loss: 133526560.0611; val_kl_reg_loss: 79594.7500; val_edge_recon_loss: 2811510.6833; val_gene_expr_recon_loss: 21725908.9333; val_masked_gp_l1_reg_loss: 102039.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60462.7383; val_chrom_access_recon_loss: 106858136.5333; val_global_loss: 131637652.2667; val_optim_loss: 131637652.2667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9726; val_auprc_score: 0.9668; val_best_acc_score: 0.9194; val_best_f1_score: 0.9225; train_kl_reg_loss: 140819.6534; train_edge_recon_loss: 2778281.4542; train_gene_expr_recon_loss: 21793537.8473; train_masked_gp_l1_reg_loss: 101944.7979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60319.6538; train_chrom_access_recon_loss: 108338134.4122; train_global_loss: 133213038.4122; train_optim_loss: 133213038.4122; val_kl_reg_loss: 81375.6464; val_edge_recon_loss: 2767007.2833; val_gene_expr_recon_loss: 21676529.4667; val_masked_gp_l1_reg_loss: 101831.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60171.4961; val_chrom_access_recon_loss: 106691046.4000; val_global_loss: 131377961.6000; val_optim_loss: 131377961.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9731; val_auprc_score: 0.9691; val_best_acc_score: 0.9163; val_best_f1_score: 0.9197; train_kl_reg_loss: 139777.0571; train_edge_recon_loss: 2782306.5477; train_gene_expr_recon_loss: 21785343.5573; train_masked_gp_l1_reg_loss: 101719.3860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60027.1283; train_chrom_access_recon_loss: 108359476.5191; train_global_loss: 133228649.6489; train_optim_loss: 133228649.6489; val_kl_reg_loss: 83295.1286; val_edge_recon_loss: 2785359.8500; val_gene_expr_recon_loss: 21758644.1333; val_masked_gp_l1_reg_loss: 101606.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59868.8477; val_chrom_access_recon_loss: 107319683.7333; val_global_loss: 132108456.5333; val_optim_loss: 132108456.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 55 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9714
val AUPRC score: 0.9676
val best accuracy score: 0.9163
val best F1 score: 0.9196
val target rna MSE score: 2.4072
val source rna MSE score: 466.6369
val target atac MSE score: 0.1218
val source atac MSE score: 1.0205
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
