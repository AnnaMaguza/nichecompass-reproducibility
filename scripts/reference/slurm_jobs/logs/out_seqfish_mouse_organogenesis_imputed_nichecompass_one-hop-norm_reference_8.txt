[True]
Run timestamp: 02082023_124523_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '12', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9013; val_auprc_score: 0.9778; val_best_acc_score: 0.9050; val_best_f1_score: 0.9456; train_kl_reg_loss: 47665.3382; train_edge_recon_loss: 944552.3498; train_gene_expr_recon_loss: 2311587.5709; train_masked_gp_l1_reg_loss: 12681.0304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59560.0028; train_global_loss: 3376046.2949; train_optim_loss: 3376046.2949; val_kl_reg_loss: 38847.3828; val_edge_recon_loss: 869334.8094; val_gene_expr_recon_loss: 1959081.5513; val_masked_gp_l1_reg_loss: 15801.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37373.6133; val_global_loss: 2920438.7590; val_optim_loss: 2920438.7590
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9319; val_auprc_score: 0.9846; val_best_acc_score: 0.9372; val_best_f1_score: 0.9638; train_kl_reg_loss: 30216.4051; train_edge_recon_loss: 828686.8567; train_gene_expr_recon_loss: 1839364.4895; train_masked_gp_l1_reg_loss: 16744.5383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29308.4841; train_global_loss: 2744320.7772; train_optim_loss: 2744320.7772; val_kl_reg_loss: 23333.8303; val_edge_recon_loss: 802753.5607; val_gene_expr_recon_loss: 1745019.6682; val_masked_gp_l1_reg_loss: 16154.4160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23613.9180; val_global_loss: 2610875.5486; val_optim_loss: 2610875.5486
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9570; val_auprc_score: 0.9905; val_best_acc_score: 0.9501; val_best_f1_score: 0.9712; train_kl_reg_loss: 19643.2696; train_edge_recon_loss: 801772.4409; train_gene_expr_recon_loss: 1680798.7329; train_masked_gp_l1_reg_loss: 13703.7655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20092.3931; train_global_loss: 2536010.6022; train_optim_loss: 2536010.6022; val_kl_reg_loss: 16588.4940; val_edge_recon_loss: 785666.4175; val_gene_expr_recon_loss: 1626200.5171; val_masked_gp_l1_reg_loss: 11509.3115; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17138.4121; val_global_loss: 2457103.1727; val_optim_loss: 2457103.1727
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9603; val_auprc_score: 0.9911; val_best_acc_score: 0.9527; val_best_f1_score: 0.9727; train_kl_reg_loss: 15891.3043; train_edge_recon_loss: 789631.9559; train_gene_expr_recon_loss: 1587154.6466; train_masked_gp_l1_reg_loss: 10310.8852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14868.1633; train_global_loss: 2417856.9547; train_optim_loss: 2417856.9547; val_kl_reg_loss: 15077.0830; val_edge_recon_loss: 777300.5420; val_gene_expr_recon_loss: 1554216.0791; val_masked_gp_l1_reg_loss: 9440.8770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12734.9854; val_global_loss: 2368769.6987; val_optim_loss: 2368769.6987
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9617; val_auprc_score: 0.9909; val_best_acc_score: 0.9567; val_best_f1_score: 0.9749; train_kl_reg_loss: 14787.9881; train_edge_recon_loss: 784955.9678; train_gene_expr_recon_loss: 1530535.5261; train_masked_gp_l1_reg_loss: 8990.9556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11186.6774; train_global_loss: 2350457.1141; train_optim_loss: 2350457.1141; val_kl_reg_loss: 14830.5788; val_edge_recon_loss: 797548.5499; val_gene_expr_recon_loss: 1511867.4353; val_masked_gp_l1_reg_loss: 8648.7314; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10008.0166; val_global_loss: 2342903.3183; val_optim_loss: 2342903.3183
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9657; val_auprc_score: 0.9918; val_best_acc_score: 0.9600; val_best_f1_score: 0.9768; train_kl_reg_loss: 13981.7471; train_edge_recon_loss: 777710.2545; train_gene_expr_recon_loss: 1497454.0903; train_masked_gp_l1_reg_loss: 8542.5334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9672.3307; train_global_loss: 2307360.9559; train_optim_loss: 2307360.9559; val_kl_reg_loss: 13955.2790; val_edge_recon_loss: 786299.3867; val_gene_expr_recon_loss: 1485248.1331; val_masked_gp_l1_reg_loss: 8447.4082; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9226.3184; val_global_loss: 2303176.5405; val_optim_loss: 2303176.5405
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9709; val_auprc_score: 0.9935; val_best_acc_score: 0.9630; val_best_f1_score: 0.9785; train_kl_reg_loss: 13507.0053; train_edge_recon_loss: 775710.4756; train_gene_expr_recon_loss: 1478876.9473; train_masked_gp_l1_reg_loss: 8366.1928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8852.1397; train_global_loss: 2285312.7629; train_optim_loss: 2285312.7629; val_kl_reg_loss: 13224.2648; val_edge_recon_loss: 782113.9211; val_gene_expr_recon_loss: 1474164.1025; val_masked_gp_l1_reg_loss: 8252.0039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8421.3896; val_global_loss: 2286175.7824; val_optim_loss: 2286175.7824
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9697; val_auprc_score: 0.9930; val_best_acc_score: 0.9637; val_best_f1_score: 0.9789; train_kl_reg_loss: 13307.3034; train_edge_recon_loss: 778156.1415; train_gene_expr_recon_loss: 1467998.4548; train_masked_gp_l1_reg_loss: 8316.4476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8251.5223; train_global_loss: 2276029.8695; train_optim_loss: 2276029.8695; val_kl_reg_loss: 12858.5492; val_edge_recon_loss: 773887.8880; val_gene_expr_recon_loss: 1463455.8813; val_masked_gp_l1_reg_loss: 8303.7861; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8042.1392; val_global_loss: 2266548.3219; val_optim_loss: 2266548.3219
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9721; val_auprc_score: 0.9934; val_best_acc_score: 0.9633; val_best_f1_score: 0.9787; train_kl_reg_loss: 13128.3737; train_edge_recon_loss: 775675.6743; train_gene_expr_recon_loss: 1460567.5858; train_masked_gp_l1_reg_loss: 8279.2409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7779.2997; train_global_loss: 2265430.1742; train_optim_loss: 2265430.1742; val_kl_reg_loss: 12822.5591; val_edge_recon_loss: 793844.4384; val_gene_expr_recon_loss: 1458529.3723; val_masked_gp_l1_reg_loss: 8343.1729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7609.4854; val_global_loss: 2281149.1187; val_optim_loss: 2281149.1187
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9707; val_auprc_score: 0.9927; val_best_acc_score: 0.9651; val_best_f1_score: 0.9797; train_kl_reg_loss: 12805.5754; train_edge_recon_loss: 772990.4400; train_gene_expr_recon_loss: 1456366.8875; train_masked_gp_l1_reg_loss: 8377.1258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7424.0218; train_global_loss: 2257964.0499; train_optim_loss: 2257964.0499; val_kl_reg_loss: 12342.4309; val_edge_recon_loss: 776208.4281; val_gene_expr_recon_loss: 1453811.9200; val_masked_gp_l1_reg_loss: 8333.1104; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7267.1377; val_global_loss: 2257963.0279; val_optim_loss: 2257963.0279
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9699; val_auprc_score: 0.9929; val_best_acc_score: 0.9632; val_best_f1_score: 0.9786; train_kl_reg_loss: 12874.1408; train_edge_recon_loss: 768770.3427; train_gene_expr_recon_loss: 1453777.3529; train_masked_gp_l1_reg_loss: 8380.2624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7110.9178; train_global_loss: 2250913.0167; train_optim_loss: 2250913.0167; val_kl_reg_loss: 13154.5310; val_edge_recon_loss: 780728.7496; val_gene_expr_recon_loss: 1452851.1502; val_masked_gp_l1_reg_loss: 8394.7520; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6942.1123; val_global_loss: 2262071.1772; val_optim_loss: 2262071.1772
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9712; val_auprc_score: 0.9931; val_best_acc_score: 0.9654; val_best_f1_score: 0.9799; train_kl_reg_loss: 12863.0397; train_edge_recon_loss: 774752.6221; train_gene_expr_recon_loss: 1450956.0558; train_masked_gp_l1_reg_loss: 8362.9812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6714.0686; train_global_loss: 2253648.7674; train_optim_loss: 2253648.7674; val_kl_reg_loss: 12557.8218; val_edge_recon_loss: 774564.5908; val_gene_expr_recon_loss: 1451416.8067; val_masked_gp_l1_reg_loss: 8391.1514; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6524.3770; val_global_loss: 2253454.9469; val_optim_loss: 2253454.9469
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9722; val_auprc_score: 0.9933; val_best_acc_score: 0.9671; val_best_f1_score: 0.9810; train_kl_reg_loss: 12664.8882; train_edge_recon_loss: 777448.2416; train_gene_expr_recon_loss: 1450438.5461; train_masked_gp_l1_reg_loss: 8424.2681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6365.7829; train_global_loss: 2255341.7271; train_optim_loss: 2255341.7271; val_kl_reg_loss: 12967.8108; val_edge_recon_loss: 769326.0656; val_gene_expr_recon_loss: 1450234.4397; val_masked_gp_l1_reg_loss: 8359.7285; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6132.0923; val_global_loss: 2247020.0585; val_optim_loss: 2247020.0585
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9744; val_auprc_score: 0.9939; val_best_acc_score: 0.9663; val_best_f1_score: 0.9804; train_kl_reg_loss: 12412.9559; train_edge_recon_loss: 774504.1313; train_gene_expr_recon_loss: 1450207.4710; train_masked_gp_l1_reg_loss: 8450.4123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6068.3074; train_global_loss: 2251643.2788; train_optim_loss: 2251643.2788; val_kl_reg_loss: 12102.7988; val_edge_recon_loss: 787061.6414; val_gene_expr_recon_loss: 1450420.2914; val_masked_gp_l1_reg_loss: 8421.9033; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5902.6763; val_global_loss: 2263909.4649; val_optim_loss: 2263909.4649
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9708; val_auprc_score: 0.9930; val_best_acc_score: 0.9647; val_best_f1_score: 0.9795; train_kl_reg_loss: 12550.7865; train_edge_recon_loss: 773490.1007; train_gene_expr_recon_loss: 1450087.3263; train_masked_gp_l1_reg_loss: 8460.4819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5797.6588; train_global_loss: 2250386.3558; train_optim_loss: 2250386.3558; val_kl_reg_loss: 12875.4802; val_edge_recon_loss: 772302.6978; val_gene_expr_recon_loss: 1449305.4694; val_masked_gp_l1_reg_loss: 8468.1621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5645.6328; val_global_loss: 2248597.6403; val_optim_loss: 2248597.6403
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9743; val_auprc_score: 0.9939; val_best_acc_score: 0.9660; val_best_f1_score: 0.9802; train_kl_reg_loss: 12707.2684; train_edge_recon_loss: 774005.3413; train_gene_expr_recon_loss: 1448499.3997; train_masked_gp_l1_reg_loss: 8444.0708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5535.1849; train_global_loss: 2249191.2633; train_optim_loss: 2249191.2633; val_kl_reg_loss: 12950.6407; val_edge_recon_loss: 776344.7408; val_gene_expr_recon_loss: 1448801.1799; val_masked_gp_l1_reg_loss: 8429.8066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5358.7451; val_global_loss: 2251885.0540; val_optim_loss: 2251885.0540
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9729; val_auprc_score: 0.9935; val_best_acc_score: 0.9660; val_best_f1_score: 0.9802; train_kl_reg_loss: 12599.8259; train_edge_recon_loss: 777377.7526; train_gene_expr_recon_loss: 1448430.8998; train_masked_gp_l1_reg_loss: 8479.8873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5353.4654; train_global_loss: 2252241.8364; train_optim_loss: 2252241.8364; val_kl_reg_loss: 12698.9028; val_edge_recon_loss: 787546.4577; val_gene_expr_recon_loss: 1447715.7257; val_masked_gp_l1_reg_loss: 8421.0605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5228.4790; val_global_loss: 2261610.5926; val_optim_loss: 2261610.5926

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9738; val_auprc_score: 0.9936; val_best_acc_score: 0.9671; val_best_f1_score: 0.9809; train_kl_reg_loss: 12634.6054; train_edge_recon_loss: 771980.6176; train_gene_expr_recon_loss: 1442466.8360; train_masked_gp_l1_reg_loss: 8063.9849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5047.6338; train_global_loss: 2240193.6791; train_optim_loss: 2240193.6791; val_kl_reg_loss: 12861.9794; val_edge_recon_loss: 776202.9595; val_gene_expr_recon_loss: 1442529.0881; val_masked_gp_l1_reg_loss: 8050.5967; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4977.6812; val_global_loss: 2244622.2842; val_optim_loss: 2244622.2842
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9740; val_auprc_score: 0.9938; val_best_acc_score: 0.9678; val_best_f1_score: 0.9813; train_kl_reg_loss: 12740.4327; train_edge_recon_loss: 773804.6632; train_gene_expr_recon_loss: 1442203.3515; train_masked_gp_l1_reg_loss: 8049.4892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4918.7253; train_global_loss: 2241716.6656; train_optim_loss: 2241716.6656; val_kl_reg_loss: 12822.8909; val_edge_recon_loss: 778376.6765; val_gene_expr_recon_loss: 1442462.9982; val_masked_gp_l1_reg_loss: 8047.4990; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4852.0820; val_global_loss: 2246562.0629; val_optim_loss: 2246562.0629
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9735; val_auprc_score: 0.9935; val_best_acc_score: 0.9679; val_best_f1_score: 0.9814; train_kl_reg_loss: 12698.5636; train_edge_recon_loss: 770124.6459; train_gene_expr_recon_loss: 1441699.6665; train_masked_gp_l1_reg_loss: 8061.6540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4820.4665; train_global_loss: 2237404.9928; train_optim_loss: 2237404.9928; val_kl_reg_loss: 12705.3221; val_edge_recon_loss: 774931.3651; val_gene_expr_recon_loss: 1442326.9110; val_masked_gp_l1_reg_loss: 8081.2036; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4790.7344; val_global_loss: 2242835.6043; val_optim_loss: 2242835.6043
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9737; val_auprc_score: 0.9937; val_best_acc_score: 0.9698; val_best_f1_score: 0.9824; train_kl_reg_loss: 12774.3114; train_edge_recon_loss: 768816.9269; train_gene_expr_recon_loss: 1441681.9319; train_masked_gp_l1_reg_loss: 8090.0110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4742.9702; train_global_loss: 2236106.1495; train_optim_loss: 2236106.1495; val_kl_reg_loss: 12849.5847; val_edge_recon_loss: 775121.9065; val_gene_expr_recon_loss: 1440548.2068; val_masked_gp_l1_reg_loss: 8096.3521; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4704.0278; val_global_loss: 2241319.9514; val_optim_loss: 2241319.9514
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9752; val_auprc_score: 0.9940; val_best_acc_score: 0.9688; val_best_f1_score: 0.9819; train_kl_reg_loss: 12596.2177; train_edge_recon_loss: 761619.8015; train_gene_expr_recon_loss: 1441511.9098; train_masked_gp_l1_reg_loss: 8120.7475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4677.4375; train_global_loss: 2228526.1136; train_optim_loss: 2228526.1136; val_kl_reg_loss: 12524.9495; val_edge_recon_loss: 773071.3516; val_gene_expr_recon_loss: 1441835.4730; val_masked_gp_l1_reg_loss: 8139.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4661.0894; val_global_loss: 2240232.0351; val_optim_loss: 2240232.0351
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9740; val_auprc_score: 0.9938; val_best_acc_score: 0.9686; val_best_f1_score: 0.9818; train_kl_reg_loss: 12565.5809; train_edge_recon_loss: 769201.9619; train_gene_expr_recon_loss: 1441614.7505; train_masked_gp_l1_reg_loss: 8159.0379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4636.1787; train_global_loss: 2236177.5083; train_optim_loss: 2236177.5083; val_kl_reg_loss: 12737.7838; val_edge_recon_loss: 777104.5189; val_gene_expr_recon_loss: 1441581.8381; val_masked_gp_l1_reg_loss: 8170.8486; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4599.3203; val_global_loss: 2244194.1547; val_optim_loss: 2244194.1547
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9751; val_auprc_score: 0.9939; val_best_acc_score: 0.9687; val_best_f1_score: 0.9818; train_kl_reg_loss: 12585.2950; train_edge_recon_loss: 768151.5643; train_gene_expr_recon_loss: 1441344.5117; train_masked_gp_l1_reg_loss: 8176.6611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4582.2224; train_global_loss: 2234840.2550; train_optim_loss: 2234840.2550; val_kl_reg_loss: 12553.2814; val_edge_recon_loss: 775879.2630; val_gene_expr_recon_loss: 1440877.0441; val_masked_gp_l1_reg_loss: 8196.5166; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4566.3916; val_global_loss: 2242072.5845; val_optim_loss: 2242072.5845
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9761; val_auprc_score: 0.9946; val_best_acc_score: 0.9691; val_best_f1_score: 0.9821; train_kl_reg_loss: 12606.5321; train_edge_recon_loss: 764467.4477; train_gene_expr_recon_loss: 1441251.3737; train_masked_gp_l1_reg_loss: 8199.3321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4530.4808; train_global_loss: 2231055.1654; train_optim_loss: 2231055.1654; val_kl_reg_loss: 12762.1978; val_edge_recon_loss: 766291.9564; val_gene_expr_recon_loss: 1441505.0171; val_masked_gp_l1_reg_loss: 8212.7646; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4521.6777; val_global_loss: 2233293.6655; val_optim_loss: 2233293.6655
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9767; val_auprc_score: 0.9948; val_best_acc_score: 0.9672; val_best_f1_score: 0.9810; train_kl_reg_loss: 10901.5617; train_edge_recon_loss: 770117.8599; train_gene_expr_recon_loss: 1665192.6031; train_masked_gp_l1_reg_loss: 8223.8283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3574.2368; train_global_loss: 2458010.0986; train_optim_loss: 2458010.0986; val_kl_reg_loss: 7650.8801; val_edge_recon_loss: 770143.9236; val_gene_expr_recon_loss: 1651938.8058; val_masked_gp_l1_reg_loss: 8226.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2770.5359; val_global_loss: 2440730.8579; val_optim_loss: 2440730.8579
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9739; val_auprc_score: 0.9938; val_best_acc_score: 0.9668; val_best_f1_score: 0.9807; train_kl_reg_loss: 10085.0130; train_edge_recon_loss: 772249.4144; train_gene_expr_recon_loss: 1640923.6181; train_masked_gp_l1_reg_loss: 8240.1484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2198.5473; train_global_loss: 2433696.7420; train_optim_loss: 2433696.7420; val_kl_reg_loss: 7619.6140; val_edge_recon_loss: 778635.4456; val_gene_expr_recon_loss: 1640476.9586; val_masked_gp_l1_reg_loss: 8247.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1705.3663; val_global_loss: 2436684.5054; val_optim_loss: 2436684.5054
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9743; val_auprc_score: 0.9938; val_best_acc_score: 0.9683; val_best_f1_score: 0.9816; train_kl_reg_loss: 9801.4153; train_edge_recon_loss: 769311.2127; train_gene_expr_recon_loss: 1631973.2650; train_masked_gp_l1_reg_loss: 8230.5069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1344.3126; train_global_loss: 2420660.7081; train_optim_loss: 2420660.7081; val_kl_reg_loss: 7714.4246; val_edge_recon_loss: 775011.8473; val_gene_expr_recon_loss: 1631000.0540; val_masked_gp_l1_reg_loss: 8231.4316; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1036.1749; val_global_loss: 2422994.0773; val_optim_loss: 2422994.0773
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9740; val_auprc_score: 0.9935; val_best_acc_score: 0.9684; val_best_f1_score: 0.9816; train_kl_reg_loss: 9474.8078; train_edge_recon_loss: 769676.2015; train_gene_expr_recon_loss: 1626334.2637; train_masked_gp_l1_reg_loss: 8227.9459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 818.0421; train_global_loss: 2414531.2569; train_optim_loss: 2414531.2569; val_kl_reg_loss: 7715.0547; val_edge_recon_loss: 781076.1450; val_gene_expr_recon_loss: 1624973.5414; val_masked_gp_l1_reg_loss: 8230.6064; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 633.7098; val_global_loss: 2422628.9946; val_optim_loss: 2422628.9946

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9752; val_auprc_score: 0.9936; val_best_acc_score: 0.9684; val_best_f1_score: 0.9817; train_kl_reg_loss: 9267.1087; train_edge_recon_loss: 765153.5986; train_gene_expr_recon_loss: 1623376.9182; train_masked_gp_l1_reg_loss: 8195.4402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 608.3982; train_global_loss: 2406601.4537; train_optim_loss: 2406601.4537; val_kl_reg_loss: 7760.6433; val_edge_recon_loss: 773326.7995; val_gene_expr_recon_loss: 1627470.2518; val_masked_gp_l1_reg_loss: 8193.3486; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 588.1090; val_global_loss: 2417338.9460; val_optim_loss: 2417338.9460
