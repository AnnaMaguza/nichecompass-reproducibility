[True]
Run timestamp: 01082023_061010_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9282; val_auprc_score: 0.9865; val_best_acc_score: 0.8511; val_best_f1_score: 0.9196; train_kl_reg_loss: 11361.5940; train_edge_recon_loss: 11454.3618; train_gene_expr_recon_loss: 549572.2280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116114.6014; train_global_loss: 688502.7882; train_optim_loss: 688502.7882; val_kl_reg_loss: 12452.4644; val_edge_recon_loss: 12103.0788; val_gene_expr_recon_loss: 434380.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105107.6406; val_global_loss: 564043.4792; val_optim_loss: 564043.4792
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9124; val_auprc_score: 0.9823; val_best_acc_score: 0.8506; val_best_f1_score: 0.9193; train_kl_reg_loss: 12491.3492; train_edge_recon_loss: 11517.9219; train_gene_expr_recon_loss: 406808.0810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95428.3446; train_global_loss: 526245.6968; train_optim_loss: 526245.6968; val_kl_reg_loss: 11507.0583; val_edge_recon_loss: 12144.3804; val_gene_expr_recon_loss: 373730.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85999.5938; val_global_loss: 483381.0625; val_optim_loss: 483381.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8943; val_auprc_score: 0.9792; val_best_acc_score: 0.8598; val_best_f1_score: 0.9240; train_kl_reg_loss: 11472.3284; train_edge_recon_loss: 11641.0256; train_gene_expr_recon_loss: 331388.7517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78197.9750; train_global_loss: 432700.0816; train_optim_loss: 432700.0816; val_kl_reg_loss: 10791.8704; val_edge_recon_loss: 11941.2100; val_gene_expr_recon_loss: 285026.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70640.4219; val_global_loss: 378399.9271; val_optim_loss: 378399.9271
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8573; val_auprc_score: 0.9717; val_best_acc_score: 0.8700; val_best_f1_score: 0.9281; train_kl_reg_loss: 10883.7802; train_edge_recon_loss: 11651.5908; train_gene_expr_recon_loss: 260229.9343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63983.9490; train_global_loss: 346749.2541; train_optim_loss: 346749.2541; val_kl_reg_loss: 10306.0456; val_edge_recon_loss: 11941.8545; val_gene_expr_recon_loss: 242464.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57383.2070; val_global_loss: 322095.7135; val_optim_loss: 322095.7135
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8547; val_auprc_score: 0.9708; val_best_acc_score: 0.8738; val_best_f1_score: 0.9309; train_kl_reg_loss: 10120.9773; train_edge_recon_loss: 11397.6342; train_gene_expr_recon_loss: 237362.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51840.1182; train_global_loss: 310721.6100; train_optim_loss: 310721.6100; val_kl_reg_loss: 9406.2088; val_edge_recon_loss: 11713.6496; val_gene_expr_recon_loss: 231510.7786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46623.3359; val_global_loss: 299253.9740; val_optim_loss: 299253.9740
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8529; val_auprc_score: 0.9684; val_best_acc_score: 0.8753; val_best_f1_score: 0.9306; train_kl_reg_loss: 9268.0518; train_edge_recon_loss: 11352.3278; train_gene_expr_recon_loss: 230123.1435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42758.3485; train_global_loss: 293501.8709; train_optim_loss: 293501.8709; val_kl_reg_loss: 8644.3162; val_edge_recon_loss: 12073.5158; val_gene_expr_recon_loss: 227345.7995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39338.0664; val_global_loss: 287401.6979; val_optim_loss: 287401.6979
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8536; val_auprc_score: 0.9690; val_best_acc_score: 0.8752; val_best_f1_score: 0.9310; train_kl_reg_loss: 8623.3047; train_edge_recon_loss: 11343.5476; train_gene_expr_recon_loss: 225767.7413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36611.6579; train_global_loss: 282346.2517; train_optim_loss: 282346.2517; val_kl_reg_loss: 8117.4600; val_edge_recon_loss: 11709.7215; val_gene_expr_recon_loss: 222891.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33942.7109; val_global_loss: 276661.1302; val_optim_loss: 276661.1302
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8663; val_auprc_score: 0.9724; val_best_acc_score: 0.8747; val_best_f1_score: 0.9302; train_kl_reg_loss: 8155.8452; train_edge_recon_loss: 11380.5748; train_gene_expr_recon_loss: 222535.3762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31663.0598; train_global_loss: 273734.8565; train_optim_loss: 273734.8565; val_kl_reg_loss: 7717.7434; val_edge_recon_loss: 11696.4006; val_gene_expr_recon_loss: 220290.7760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29442.1406; val_global_loss: 269147.0573; val_optim_loss: 269147.0573
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8667; val_auprc_score: 0.9717; val_best_acc_score: 0.8788; val_best_f1_score: 0.9318; train_kl_reg_loss: 7792.3690; train_edge_recon_loss: 11283.5477; train_gene_expr_recon_loss: 219716.1019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27564.7052; train_global_loss: 266356.7228; train_optim_loss: 266356.7228; val_kl_reg_loss: 7368.5661; val_edge_recon_loss: 11714.2318; val_gene_expr_recon_loss: 217741.7057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25742.4062; val_global_loss: 262566.9010; val_optim_loss: 262566.9010
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8745; val_auprc_score: 0.9739; val_best_acc_score: 0.8807; val_best_f1_score: 0.9326; train_kl_reg_loss: 7508.1865; train_edge_recon_loss: 11095.1590; train_gene_expr_recon_loss: 217269.8652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24201.3837; train_global_loss: 260074.5938; train_optim_loss: 260074.5938; val_kl_reg_loss: 7110.1799; val_edge_recon_loss: 11618.1574; val_gene_expr_recon_loss: 215292.8255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22708.3203; val_global_loss: 256729.4844; val_optim_loss: 256729.4844
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8816; val_auprc_score: 0.9746; val_best_acc_score: 0.8840; val_best_f1_score: 0.9338; train_kl_reg_loss: 7280.2467; train_edge_recon_loss: 11110.4703; train_gene_expr_recon_loss: 215082.1108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21442.7303; train_global_loss: 254915.5579; train_optim_loss: 254915.5579; val_kl_reg_loss: 7001.5710; val_edge_recon_loss: 11648.2419; val_gene_expr_recon_loss: 213219.1068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20213.0684; val_global_loss: 252081.9818; val_optim_loss: 252081.9818
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8921; val_auprc_score: 0.9775; val_best_acc_score: 0.8842; val_best_f1_score: 0.9343; train_kl_reg_loss: 7099.4385; train_edge_recon_loss: 11052.9437; train_gene_expr_recon_loss: 213126.3319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19159.5150; train_global_loss: 250438.2297; train_optim_loss: 250438.2297; val_kl_reg_loss: 6757.4839; val_edge_recon_loss: 11630.2612; val_gene_expr_recon_loss: 211488.1745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18134.9414; val_global_loss: 248010.8568; val_optim_loss: 248010.8568
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8965; val_auprc_score: 0.9772; val_best_acc_score: 0.8875; val_best_f1_score: 0.9364; train_kl_reg_loss: 6941.6963; train_edge_recon_loss: 11037.6499; train_gene_expr_recon_loss: 211318.8238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17249.9934; train_global_loss: 246548.1635; train_optim_loss: 246548.1635; val_kl_reg_loss: 6641.8631; val_edge_recon_loss: 11557.1496; val_gene_expr_recon_loss: 209573.3854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16386.3477; val_global_loss: 244158.7448; val_optim_loss: 244158.7448
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9010; val_auprc_score: 0.9800; val_best_acc_score: 0.8923; val_best_f1_score: 0.9387; train_kl_reg_loss: 6811.8754; train_edge_recon_loss: 11080.0389; train_gene_expr_recon_loss: 209614.6053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15638.4174; train_global_loss: 243144.9349; train_optim_loss: 243144.9349; val_kl_reg_loss: 6458.3635; val_edge_recon_loss: 11207.3960; val_gene_expr_recon_loss: 208249.0339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14907.7324; val_global_loss: 240822.5260; val_optim_loss: 240822.5260
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9031; val_auprc_score: 0.9790; val_best_acc_score: 0.8911; val_best_f1_score: 0.9373; train_kl_reg_loss: 6687.6186; train_edge_recon_loss: 11052.4312; train_gene_expr_recon_loss: 208039.6331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14271.9404; train_global_loss: 240051.6244; train_optim_loss: 240051.6244; val_kl_reg_loss: 6412.6071; val_edge_recon_loss: 11709.9334; val_gene_expr_recon_loss: 206482.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13650.6660; val_global_loss: 238255.3464; val_optim_loss: 238255.3464
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9003; val_auprc_score: 0.9795; val_best_acc_score: 0.8919; val_best_f1_score: 0.9385; train_kl_reg_loss: 6563.1292; train_edge_recon_loss: 10982.5761; train_gene_expr_recon_loss: 206554.0101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13112.8839; train_global_loss: 237212.5992; train_optim_loss: 237212.5992; val_kl_reg_loss: 6281.8486; val_edge_recon_loss: 11463.4878; val_gene_expr_recon_loss: 205023.5807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12586.3105; val_global_loss: 235355.2266; val_optim_loss: 235355.2266
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9047; val_auprc_score: 0.9802; val_best_acc_score: 0.8935; val_best_f1_score: 0.9391; train_kl_reg_loss: 6429.8987; train_edge_recon_loss: 11024.1754; train_gene_expr_recon_loss: 205138.3275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12131.7431; train_global_loss: 234724.1438; train_optim_loss: 234724.1438; val_kl_reg_loss: 6178.0098; val_edge_recon_loss: 11430.1348; val_gene_expr_recon_loss: 203534.4089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11686.0098; val_global_loss: 232828.5703; val_optim_loss: 232828.5703
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9092; val_auprc_score: 0.9810; val_best_acc_score: 0.8945; val_best_f1_score: 0.9392; train_kl_reg_loss: 6298.8989; train_edge_recon_loss: 10850.9084; train_gene_expr_recon_loss: 203694.5532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11300.1308; train_global_loss: 232144.4910; train_optim_loss: 232144.4910; val_kl_reg_loss: 5986.6867; val_edge_recon_loss: 11611.3820; val_gene_expr_recon_loss: 202174.1901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10921.6133; val_global_loss: 230693.8698; val_optim_loss: 230693.8698
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9138; val_auprc_score: 0.9822; val_best_acc_score: 0.8993; val_best_f1_score: 0.9418; train_kl_reg_loss: 6159.1500; train_edge_recon_loss: 10916.0948; train_gene_expr_recon_loss: 202372.7474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10587.6699; train_global_loss: 230035.6617; train_optim_loss: 230035.6617; val_kl_reg_loss: 5893.2266; val_edge_recon_loss: 11494.8107; val_gene_expr_recon_loss: 200658.1901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10262.2539; val_global_loss: 228308.4766; val_optim_loss: 228308.4766
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9154; val_auprc_score: 0.9823; val_best_acc_score: 0.8987; val_best_f1_score: 0.9418; train_kl_reg_loss: 6015.6774; train_edge_recon_loss: 10932.5648; train_gene_expr_recon_loss: 201002.8776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9977.4424; train_global_loss: 227928.5622; train_optim_loss: 227928.5622; val_kl_reg_loss: 5799.5093; val_edge_recon_loss: 11206.7451; val_gene_expr_recon_loss: 199220.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9691.1084; val_global_loss: 225918.2604; val_optim_loss: 225918.2604
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9120; val_auprc_score: 0.9816; val_best_acc_score: 0.8947; val_best_f1_score: 0.9390; train_kl_reg_loss: 5876.3810; train_edge_recon_loss: 10838.8178; train_gene_expr_recon_loss: 199741.4410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9448.2545; train_global_loss: 225904.8950; train_optim_loss: 225904.8950; val_kl_reg_loss: 5608.9867; val_edge_recon_loss: 11361.9303; val_gene_expr_recon_loss: 197903.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9204.7598; val_global_loss: 224079.1510; val_optim_loss: 224079.1510
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9137; val_auprc_score: 0.9826; val_best_acc_score: 0.9009; val_best_f1_score: 0.9425; train_kl_reg_loss: 5737.7757; train_edge_recon_loss: 10807.8774; train_gene_expr_recon_loss: 198520.1493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8991.2624; train_global_loss: 224057.0637; train_optim_loss: 224057.0637; val_kl_reg_loss: 5435.3831; val_edge_recon_loss: 10951.3773; val_gene_expr_recon_loss: 197126.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8780.8496; val_global_loss: 222294.5703; val_optim_loss: 222294.5703
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9210; val_auprc_score: 0.9835; val_best_acc_score: 0.9030; val_best_f1_score: 0.9432; train_kl_reg_loss: 5601.7839; train_edge_recon_loss: 10727.2454; train_gene_expr_recon_loss: 197275.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8596.8439; train_global_loss: 222201.2086; train_optim_loss: 222201.2086; val_kl_reg_loss: 5329.0730; val_edge_recon_loss: 11325.4080; val_gene_expr_recon_loss: 195760.5260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8413.1484; val_global_loss: 220828.1615; val_optim_loss: 220828.1615
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9151; val_auprc_score: 0.9829; val_best_acc_score: 0.9017; val_best_f1_score: 0.9436; train_kl_reg_loss: 5477.8260; train_edge_recon_loss: 10614.0294; train_gene_expr_recon_loss: 196034.8328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8246.9466; train_global_loss: 220373.6348; train_optim_loss: 220373.6348; val_kl_reg_loss: 5200.9701; val_edge_recon_loss: 11020.3748; val_gene_expr_recon_loss: 194549.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8082.9434; val_global_loss: 218854.2057; val_optim_loss: 218854.2057
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9235; val_auprc_score: 0.9843; val_best_acc_score: 0.9039; val_best_f1_score: 0.9442; train_kl_reg_loss: 5355.9261; train_edge_recon_loss: 10705.5378; train_gene_expr_recon_loss: 194857.4890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7934.8887; train_global_loss: 218853.8403; train_optim_loss: 218853.8403; val_kl_reg_loss: 5049.6136; val_edge_recon_loss: 11327.0601; val_gene_expr_recon_loss: 193704.9740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7795.0337; val_global_loss: 217876.6797; val_optim_loss: 217876.6797
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9101; val_auprc_score: 0.9808; val_best_acc_score: 0.8972; val_best_f1_score: 0.9405; train_kl_reg_loss: 3797.5765; train_edge_recon_loss: 10738.2529; train_gene_expr_recon_loss: 331178.8160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6785.3118; train_global_loss: 352499.9543; train_optim_loss: 352499.9543; val_kl_reg_loss: 3163.3939; val_edge_recon_loss: 11243.6463; val_gene_expr_recon_loss: 292158.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5702.8037; val_global_loss: 312267.9635; val_optim_loss: 312267.9635
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9229; val_auprc_score: 0.9845; val_best_acc_score: 0.9075; val_best_f1_score: 0.9470; train_kl_reg_loss: 3244.8792; train_edge_recon_loss: 10610.1754; train_gene_expr_recon_loss: 271679.5865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5060.3451; train_global_loss: 290594.9867; train_optim_loss: 290594.9867; val_kl_reg_loss: 2935.0821; val_edge_recon_loss: 10561.4766; val_gene_expr_recon_loss: 252613.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4540.6035; val_global_loss: 270650.4010; val_optim_loss: 270650.4010
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9222; val_auprc_score: 0.9848; val_best_acc_score: 0.9098; val_best_f1_score: 0.9485; train_kl_reg_loss: 2989.3012; train_edge_recon_loss: 10399.7609; train_gene_expr_recon_loss: 242119.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4208.5009; train_global_loss: 259717.4407; train_optim_loss: 259717.4407; val_kl_reg_loss: 2745.3101; val_edge_recon_loss: 10329.0946; val_gene_expr_recon_loss: 230527.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3918.0479; val_global_loss: 247520.2161; val_optim_loss: 247520.2161
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9249; val_auprc_score: 0.9838; val_best_acc_score: 0.9128; val_best_f1_score: 0.9492; train_kl_reg_loss: 2789.9736; train_edge_recon_loss: 10215.3865; train_gene_expr_recon_loss: 225178.8356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3706.4244; train_global_loss: 241890.6201; train_optim_loss: 241890.6201; val_kl_reg_loss: 2547.7201; val_edge_recon_loss: 10690.0365; val_gene_expr_recon_loss: 218060.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3511.8535; val_global_loss: 234809.9583; val_optim_loss: 234809.9583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9225; val_auprc_score: 0.9838; val_best_acc_score: 0.9125; val_best_f1_score: 0.9496; train_kl_reg_loss: 2692.0442; train_edge_recon_loss: 10142.1032; train_gene_expr_recon_loss: 218628.1751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3433.0913; train_global_loss: 234895.4135; train_optim_loss: 234895.4135; val_kl_reg_loss: 2535.5430; val_edge_recon_loss: 10232.9634; val_gene_expr_recon_loss: 216804.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3402.5610; val_global_loss: 232975.4036; val_optim_loss: 232975.4036
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9261; val_auprc_score: 0.9847; val_best_acc_score: 0.9147; val_best_f1_score: 0.9507; train_kl_reg_loss: 2678.8560; train_edge_recon_loss: 10006.9814; train_gene_expr_recon_loss: 217710.7124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3385.3209; train_global_loss: 233781.8709; train_optim_loss: 233781.8709; val_kl_reg_loss: 2522.7069; val_edge_recon_loss: 10348.7913; val_gene_expr_recon_loss: 215819.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3367.8489; val_global_loss: 232059.1120; val_optim_loss: 232059.1120
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9204; val_auprc_score: 0.9822; val_best_acc_score: 0.9137; val_best_f1_score: 0.9500; train_kl_reg_loss: 2660.4083; train_edge_recon_loss: 10074.0511; train_gene_expr_recon_loss: 216831.3096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3351.1537; train_global_loss: 232916.9219; train_optim_loss: 232916.9219; val_kl_reg_loss: 2511.0324; val_edge_recon_loss: 10534.2520; val_gene_expr_recon_loss: 215094.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3334.0173; val_global_loss: 231473.6562; val_optim_loss: 231473.6562
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9254; val_auprc_score: 0.9843; val_best_acc_score: 0.9154; val_best_f1_score: 0.9507; train_kl_reg_loss: 2645.4645; train_edge_recon_loss: 10110.4880; train_gene_expr_recon_loss: 215949.7263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3317.1755; train_global_loss: 232022.8533; train_optim_loss: 232022.8533; val_kl_reg_loss: 2494.6860; val_edge_recon_loss: 10359.5649; val_gene_expr_recon_loss: 214396.2474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3299.7229; val_global_loss: 230550.2161; val_optim_loss: 230550.2161

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 24 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9197
val AUPRC score: 0.9837
val best accuracy score: 0.9065
val best F1 score: 0.9461
val target rna MSE score: 22.7191
val source rna MSE score: 94.8354
Val cat covariate0 mean sim diff: -0.0008

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
