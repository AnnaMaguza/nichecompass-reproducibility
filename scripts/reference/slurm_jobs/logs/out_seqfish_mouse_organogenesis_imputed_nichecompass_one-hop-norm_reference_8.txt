[True]
Run timestamp: 02082023_024002_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8701; val_auprc_score: 0.9740; val_best_acc_score: 0.8747; val_best_f1_score: 0.9306; train_kl_reg_loss: 41538.0064; train_edge_recon_loss: 113552.1789; train_gene_expr_recon_loss: 2398523.6392; train_masked_gp_l1_reg_loss: 10041.7084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67378.3774; train_global_loss: 2631033.9098; train_optim_loss: 2631033.9098; val_kl_reg_loss: 28645.6153; val_edge_recon_loss: 106923.4350; val_gene_expr_recon_loss: 2006552.2715; val_masked_gp_l1_reg_loss: 11616.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44975.7891; val_global_loss: 2198713.5699; val_optim_loss: 2198713.5699
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9077; val_auprc_score: 0.9805; val_best_acc_score: 0.9048; val_best_f1_score: 0.9459; train_kl_reg_loss: 26023.5286; train_edge_recon_loss: 102989.2175; train_gene_expr_recon_loss: 1910797.7376; train_masked_gp_l1_reg_loss: 13140.7082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34193.1265; train_global_loss: 2087144.3218; train_optim_loss: 2087144.3218; val_kl_reg_loss: 24377.2781; val_edge_recon_loss: 100309.5613; val_gene_expr_recon_loss: 1828116.6438; val_masked_gp_l1_reg_loss: 14396.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26267.0098; val_global_loss: 1993466.6116; val_optim_loss: 1993466.6116
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9225; val_auprc_score: 0.9832; val_best_acc_score: 0.9198; val_best_f1_score: 0.9542; train_kl_reg_loss: 22519.1667; train_edge_recon_loss: 98695.7599; train_gene_expr_recon_loss: 1768386.9589; train_masked_gp_l1_reg_loss: 15258.9121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22144.6937; train_global_loss: 1927005.4904; train_optim_loss: 1927005.4904; val_kl_reg_loss: 21371.7406; val_edge_recon_loss: 97554.7631; val_gene_expr_recon_loss: 1712675.9395; val_masked_gp_l1_reg_loss: 15927.5254; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19007.2617; val_global_loss: 1866537.1882; val_optim_loss: 1866537.1882
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9306; val_auprc_score: 0.9849; val_best_acc_score: 0.9256; val_best_f1_score: 0.9575; train_kl_reg_loss: 19685.5446; train_edge_recon_loss: 94330.1056; train_gene_expr_recon_loss: 1671797.3729; train_masked_gp_l1_reg_loss: 16194.9076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17075.4388; train_global_loss: 1819083.3659; train_optim_loss: 1819083.3659; val_kl_reg_loss: 18151.3368; val_edge_recon_loss: 93785.8770; val_gene_expr_recon_loss: 1633719.4731; val_masked_gp_l1_reg_loss: 16185.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15575.6191; val_global_loss: 1777417.4422; val_optim_loss: 1777417.4422
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9421; val_auprc_score: 0.9873; val_best_acc_score: 0.9347; val_best_f1_score: 0.9626; train_kl_reg_loss: 16583.9556; train_edge_recon_loss: 91109.0582; train_gene_expr_recon_loss: 1599213.2652; train_masked_gp_l1_reg_loss: 15427.0566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14656.5880; train_global_loss: 1736989.9265; train_optim_loss: 1736989.9265; val_kl_reg_loss: 15001.4553; val_edge_recon_loss: 89337.0646; val_gene_expr_recon_loss: 1568469.9368; val_masked_gp_l1_reg_loss: 14302.7168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13852.9082; val_global_loss: 1700964.0820; val_optim_loss: 1700964.0820
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9447; val_auprc_score: 0.9878; val_best_acc_score: 0.9378; val_best_f1_score: 0.9644; train_kl_reg_loss: 13640.5237; train_edge_recon_loss: 87133.5458; train_gene_expr_recon_loss: 1546171.6498; train_masked_gp_l1_reg_loss: 12875.0137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12898.6991; train_global_loss: 1672719.4315; train_optim_loss: 1672719.4315; val_kl_reg_loss: 12669.1898; val_edge_recon_loss: 83850.7377; val_gene_expr_recon_loss: 1527030.2392; val_masked_gp_l1_reg_loss: 11534.6504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11842.9346; val_global_loss: 1646927.6707; val_optim_loss: 1646927.6707
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9493; val_auprc_score: 0.9884; val_best_acc_score: 0.9395; val_best_f1_score: 0.9653; train_kl_reg_loss: 11694.9361; train_edge_recon_loss: 84651.2561; train_gene_expr_recon_loss: 1510515.1755; train_masked_gp_l1_reg_loss: 10566.6946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10787.1262; train_global_loss: 1628215.1880; train_optim_loss: 1628215.1880; val_kl_reg_loss: 11158.1660; val_edge_recon_loss: 84146.5427; val_gene_expr_recon_loss: 1494396.2634; val_masked_gp_l1_reg_loss: 9824.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9883.5410; val_global_loss: 1609408.9745; val_optim_loss: 1609408.9745
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9484; val_auprc_score: 0.9881; val_best_acc_score: 0.9410; val_best_f1_score: 0.9661; train_kl_reg_loss: 10577.3559; train_edge_recon_loss: 82874.6089; train_gene_expr_recon_loss: 1485351.0387; train_masked_gp_l1_reg_loss: 9422.9450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9149.7085; train_global_loss: 1597375.6567; train_optim_loss: 1597375.6567; val_kl_reg_loss: 10161.6544; val_edge_recon_loss: 82572.7679; val_gene_expr_recon_loss: 1473430.2056; val_masked_gp_l1_reg_loss: 9109.1025; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8409.6475; val_global_loss: 1583683.3737; val_optim_loss: 1583683.3737
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9514; val_auprc_score: 0.9896; val_best_acc_score: 0.9407; val_best_f1_score: 0.9660; train_kl_reg_loss: 9920.8432; train_edge_recon_loss: 81955.1207; train_gene_expr_recon_loss: 1466978.2969; train_masked_gp_l1_reg_loss: 8889.3506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7832.0590; train_global_loss: 1575575.6725; train_optim_loss: 1575575.6725; val_kl_reg_loss: 9869.8417; val_edge_recon_loss: 80652.6232; val_gene_expr_recon_loss: 1459364.1438; val_masked_gp_l1_reg_loss: 8748.4238; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7413.7314; val_global_loss: 1566048.7272; val_optim_loss: 1566048.7272
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9554; val_auprc_score: 0.9897; val_best_acc_score: 0.9457; val_best_f1_score: 0.9687; train_kl_reg_loss: 9497.9768; train_edge_recon_loss: 81910.1909; train_gene_expr_recon_loss: 1454793.8314; train_masked_gp_l1_reg_loss: 8567.1761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7168.6582; train_global_loss: 1561937.8309; train_optim_loss: 1561937.8309; val_kl_reg_loss: 9358.9344; val_edge_recon_loss: 80170.8565; val_gene_expr_recon_loss: 1450000.8642; val_masked_gp_l1_reg_loss: 8421.1963; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6967.5688; val_global_loss: 1554919.5296; val_optim_loss: 1554919.5296
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9550; val_auprc_score: 0.9893; val_best_acc_score: 0.9469; val_best_f1_score: 0.9693; train_kl_reg_loss: 9250.6718; train_edge_recon_loss: 81001.2129; train_gene_expr_recon_loss: 1446920.1825; train_masked_gp_l1_reg_loss: 8287.4675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6757.5167; train_global_loss: 1552217.0500; train_optim_loss: 1552217.0500; val_kl_reg_loss: 9160.6845; val_edge_recon_loss: 82097.4061; val_gene_expr_recon_loss: 1442679.6707; val_masked_gp_l1_reg_loss: 8150.0981; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6540.8306; val_global_loss: 1548628.7648; val_optim_loss: 1548628.7648
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9476; val_auprc_score: 0.9873; val_best_acc_score: 0.9449; val_best_f1_score: 0.9682; train_kl_reg_loss: 9089.6885; train_edge_recon_loss: 80403.9320; train_gene_expr_recon_loss: 1441623.1970; train_masked_gp_l1_reg_loss: 8065.2336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6354.4643; train_global_loss: 1545536.5151; train_optim_loss: 1545536.5151; val_kl_reg_loss: 8965.0705; val_edge_recon_loss: 81587.9265; val_gene_expr_recon_loss: 1437896.6223; val_masked_gp_l1_reg_loss: 7960.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6161.3613; val_global_loss: 1542571.3723; val_optim_loss: 1542571.3723
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9590; val_auprc_score: 0.9910; val_best_acc_score: 0.9476; val_best_f1_score: 0.9698; train_kl_reg_loss: 8958.4300; train_edge_recon_loss: 80816.8461; train_gene_expr_recon_loss: 1438066.1761; train_masked_gp_l1_reg_loss: 7899.5695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6022.8679; train_global_loss: 1541763.8931; train_optim_loss: 1541763.8931; val_kl_reg_loss: 8990.3259; val_edge_recon_loss: 79594.6208; val_gene_expr_recon_loss: 1437629.5995; val_masked_gp_l1_reg_loss: 7849.9600; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5918.2383; val_global_loss: 1539982.7970; val_optim_loss: 1539982.7970
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9555; val_auprc_score: 0.9899; val_best_acc_score: 0.9471; val_best_f1_score: 0.9695; train_kl_reg_loss: 8857.7935; train_edge_recon_loss: 80090.0307; train_gene_expr_recon_loss: 1435225.8636; train_masked_gp_l1_reg_loss: 7766.4094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5765.2411; train_global_loss: 1537705.3369; train_optim_loss: 1537705.3369; val_kl_reg_loss: 8934.8844; val_edge_recon_loss: 79981.9513; val_gene_expr_recon_loss: 1434737.1909; val_masked_gp_l1_reg_loss: 7724.5723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5666.5796; val_global_loss: 1537045.2782; val_optim_loss: 1537045.2782
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9552; val_auprc_score: 0.9896; val_best_acc_score: 0.9473; val_best_f1_score: 0.9695; train_kl_reg_loss: 8788.9941; train_edge_recon_loss: 80424.8050; train_gene_expr_recon_loss: 1433001.4316; train_masked_gp_l1_reg_loss: 7686.4806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5572.8185; train_global_loss: 1535474.5302; train_optim_loss: 1535474.5302; val_kl_reg_loss: 9020.2673; val_edge_recon_loss: 80003.1057; val_gene_expr_recon_loss: 1435661.0108; val_masked_gp_l1_reg_loss: 7655.3716; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5499.3359; val_global_loss: 1537839.1304; val_optim_loss: 1537839.1304
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9525; val_auprc_score: 0.9883; val_best_acc_score: 0.9470; val_best_f1_score: 0.9695; train_kl_reg_loss: 8715.0663; train_edge_recon_loss: 79944.9379; train_gene_expr_recon_loss: 1431444.9712; train_masked_gp_l1_reg_loss: 7626.6855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5448.7117; train_global_loss: 1533180.3732; train_optim_loss: 1533180.3732; val_kl_reg_loss: 8676.9443; val_edge_recon_loss: 79166.3570; val_gene_expr_recon_loss: 1429791.3616; val_masked_gp_l1_reg_loss: 7587.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5410.1299; val_global_loss: 1530632.4140; val_optim_loss: 1530632.4140
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9602; val_auprc_score: 0.9906; val_best_acc_score: 0.9469; val_best_f1_score: 0.9693; train_kl_reg_loss: 8675.4819; train_edge_recon_loss: 80239.6468; train_gene_expr_recon_loss: 1430103.6576; train_masked_gp_l1_reg_loss: 7600.0369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5390.5608; train_global_loss: 1532009.3837; train_optim_loss: 1532009.3837; val_kl_reg_loss: 8757.7263; val_edge_recon_loss: 82435.7615; val_gene_expr_recon_loss: 1427762.2527; val_masked_gp_l1_reg_loss: 7529.2324; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5372.4443; val_global_loss: 1531857.4879; val_optim_loss: 1531857.4879
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9582; val_auprc_score: 0.9902; val_best_acc_score: 0.9495; val_best_f1_score: 0.9709; train_kl_reg_loss: 8639.0891; train_edge_recon_loss: 80588.0856; train_gene_expr_recon_loss: 1428402.4912; train_masked_gp_l1_reg_loss: 7537.0713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5307.9216; train_global_loss: 1530474.6616; train_optim_loss: 1530474.6616; val_kl_reg_loss: 8673.0161; val_edge_recon_loss: 80053.2989; val_gene_expr_recon_loss: 1428670.0551; val_masked_gp_l1_reg_loss: 7522.6318; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5246.7700; val_global_loss: 1530165.7446; val_optim_loss: 1530165.7446
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9600; val_auprc_score: 0.9907; val_best_acc_score: 0.9488; val_best_f1_score: 0.9705; train_kl_reg_loss: 8599.2076; train_edge_recon_loss: 79913.2551; train_gene_expr_recon_loss: 1427712.4098; train_masked_gp_l1_reg_loss: 7512.7485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5174.4795; train_global_loss: 1528912.1024; train_optim_loss: 1528912.1024; val_kl_reg_loss: 8607.0590; val_edge_recon_loss: 79259.4804; val_gene_expr_recon_loss: 1426137.5444; val_masked_gp_l1_reg_loss: 7493.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5097.6846; val_global_loss: 1526595.4610; val_optim_loss: 1526595.4610
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9552; val_auprc_score: 0.9897; val_best_acc_score: 0.9477; val_best_f1_score: 0.9698; train_kl_reg_loss: 8581.2925; train_edge_recon_loss: 80316.3598; train_gene_expr_recon_loss: 1427023.9011; train_masked_gp_l1_reg_loss: 7496.2218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5019.2857; train_global_loss: 1528437.0594; train_optim_loss: 1528437.0594; val_kl_reg_loss: 8700.6381; val_edge_recon_loss: 81324.0437; val_gene_expr_recon_loss: 1428065.4812; val_masked_gp_l1_reg_loss: 7484.6162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4975.7930; val_global_loss: 1530550.5403; val_optim_loss: 1530550.5403
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9606; val_auprc_score: 0.9914; val_best_acc_score: 0.9491; val_best_f1_score: 0.9705; train_kl_reg_loss: 8551.2077; train_edge_recon_loss: 79724.4129; train_gene_expr_recon_loss: 1426354.1366; train_masked_gp_l1_reg_loss: 7471.6158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4893.9497; train_global_loss: 1526995.3260; train_optim_loss: 1526995.3260; val_kl_reg_loss: 8537.3461; val_edge_recon_loss: 82049.1635; val_gene_expr_recon_loss: 1425506.6452; val_masked_gp_l1_reg_loss: 7452.4365; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4816.0503; val_global_loss: 1528361.5349; val_optim_loss: 1528361.5349
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9581; val_auprc_score: 0.9907; val_best_acc_score: 0.9500; val_best_f1_score: 0.9711; train_kl_reg_loss: 8534.6026; train_edge_recon_loss: 80480.2000; train_gene_expr_recon_loss: 1426190.4040; train_masked_gp_l1_reg_loss: 7472.3992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4792.2316; train_global_loss: 1527469.8389; train_optim_loss: 1527469.8389; val_kl_reg_loss: 8471.4036; val_edge_recon_loss: 79646.4635; val_gene_expr_recon_loss: 1424824.3226; val_masked_gp_l1_reg_loss: 7456.6821; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4745.3003; val_global_loss: 1525144.0632; val_optim_loss: 1525144.0632
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9517; val_auprc_score: 0.9893; val_best_acc_score: 0.9413; val_best_f1_score: 0.9660; train_kl_reg_loss: 8518.9361; train_edge_recon_loss: 80287.8233; train_gene_expr_recon_loss: 1427152.9999; train_masked_gp_l1_reg_loss: 7474.0436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4721.0453; train_global_loss: 1528154.8504; train_optim_loss: 1528154.8504; val_kl_reg_loss: 8644.5269; val_edge_recon_loss: 86067.8763; val_gene_expr_recon_loss: 1523630.9449; val_masked_gp_l1_reg_loss: 8151.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4843.4346; val_global_loss: 1631338.4731; val_optim_loss: 1631338.4731
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9501; val_auprc_score: 0.9881; val_best_acc_score: 0.9428; val_best_f1_score: 0.9670; train_kl_reg_loss: 8362.0885; train_edge_recon_loss: 80236.0223; train_gene_expr_recon_loss: 1444937.7188; train_masked_gp_l1_reg_loss: 8062.6125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5261.0263; train_global_loss: 1546859.4674; train_optim_loss: 1546859.4674; val_kl_reg_loss: 8472.8144; val_edge_recon_loss: 80906.0791; val_gene_expr_recon_loss: 1434955.1586; val_masked_gp_l1_reg_loss: 7563.4839; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5021.2734; val_global_loss: 1536918.8051; val_optim_loss: 1536918.8051
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9551; val_auprc_score: 0.9897; val_best_acc_score: 0.9449; val_best_f1_score: 0.9681; train_kl_reg_loss: 8353.0111; train_edge_recon_loss: 79861.9907; train_gene_expr_recon_loss: 1433163.1991; train_masked_gp_l1_reg_loss: 7474.9230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4907.2627; train_global_loss: 1533760.3883; train_optim_loss: 1533760.3883; val_kl_reg_loss: 8223.1320; val_edge_recon_loss: 80690.1265; val_gene_expr_recon_loss: 1431928.2191; val_masked_gp_l1_reg_loss: 7427.2749; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4810.2812; val_global_loss: 1533078.9731; val_optim_loss: 1533078.9731
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9531; val_auprc_score: 0.9898; val_best_acc_score: 0.9430; val_best_f1_score: 0.9672; train_kl_reg_loss: 7647.7348; train_edge_recon_loss: 79770.3992; train_gene_expr_recon_loss: 1434351.3392; train_masked_gp_l1_reg_loss: 7292.1517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4774.6366; train_global_loss: 1533836.2608; train_optim_loss: 1533836.2608; val_kl_reg_loss: 7471.4888; val_edge_recon_loss: 79324.3804; val_gene_expr_recon_loss: 1432938.5591; val_masked_gp_l1_reg_loss: 7263.4658; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4736.0591; val_global_loss: 1531733.9288; val_optim_loss: 1531733.9288

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9530; val_auprc_score: 0.9895; val_best_acc_score: 0.9434; val_best_f1_score: 0.9674; train_kl_reg_loss: 7372.4259; train_edge_recon_loss: 80490.5349; train_gene_expr_recon_loss: 1677156.0106; train_masked_gp_l1_reg_loss: 7033.5880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3869.5270; train_global_loss: 1775922.0898; train_optim_loss: 1775922.0898; val_kl_reg_loss: 6445.2364; val_edge_recon_loss: 78740.7194; val_gene_expr_recon_loss: 1648710.9435; val_masked_gp_l1_reg_loss: 6997.8184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3215.8835; val_global_loss: 1744110.6492; val_optim_loss: 1744110.6492
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9505; val_auprc_score: 0.9882; val_best_acc_score: 0.9426; val_best_f1_score: 0.9667; train_kl_reg_loss: 7195.4313; train_edge_recon_loss: 80239.6720; train_gene_expr_recon_loss: 1642057.4648; train_masked_gp_l1_reg_loss: 6987.3274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2716.3889; train_global_loss: 1739196.2852; train_optim_loss: 1739196.2852; val_kl_reg_loss: 6398.3982; val_edge_recon_loss: 79983.1513; val_gene_expr_recon_loss: 1636217.3683; val_masked_gp_l1_reg_loss: 6978.3408; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2269.5215; val_global_loss: 1731846.7890; val_optim_loss: 1731846.7890
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9505; val_auprc_score: 0.9885; val_best_acc_score: 0.9410; val_best_f1_score: 0.9658; train_kl_reg_loss: 7088.0394; train_edge_recon_loss: 80002.9119; train_gene_expr_recon_loss: 1630922.3286; train_masked_gp_l1_reg_loss: 6967.6334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1915.0736; train_global_loss: 1726895.9861; train_optim_loss: 1726895.9861; val_kl_reg_loss: 6436.3232; val_edge_recon_loss: 81195.4947; val_gene_expr_recon_loss: 1632484.9583; val_masked_gp_l1_reg_loss: 6956.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1599.6783; val_global_loss: 1728673.2755; val_optim_loss: 1728673.2755
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9497; val_auprc_score: 0.9884; val_best_acc_score: 0.9456; val_best_f1_score: 0.9687; train_kl_reg_loss: 6996.2436; train_edge_recon_loss: 78963.3048; train_gene_expr_recon_loss: 1625610.1077; train_masked_gp_l1_reg_loss: 6953.3288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1349.0612; train_global_loss: 1719872.0466; train_optim_loss: 1719872.0466; val_kl_reg_loss: 6461.5719; val_edge_recon_loss: 78513.3976; val_gene_expr_recon_loss: 1629229.6788; val_masked_gp_l1_reg_loss: 6947.8374; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1123.1309; val_global_loss: 1722275.6519; val_optim_loss: 1722275.6519

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 208 min 37 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9539
val AUPRC score: 0.9893
val best accuracy score: 0.9464
val best F1 score: 0.9690
val target rna MSE score: 1.0236
val source rna MSE score: 0.5650
Val cat covariate0 mean sim diff: -0.0056

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
