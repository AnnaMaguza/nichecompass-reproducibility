[True]
Run timestamp: 10082023_181915_35.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_35']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7255; val_auprc_score: 0.7572; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 125555.3949; train_edge_recon_loss: 3716131.8569; train_gene_expr_recon_loss: 26415457.2519; train_masked_gp_l1_reg_loss: 73592.5827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240775.0769; train_chrom_access_recon_loss: 4098380.6050; train_global_loss: 34669892.9618; train_optim_loss: 34669892.9618; val_kl_reg_loss: 154672.0646; val_edge_recon_loss: 4065835.3333; val_gene_expr_recon_loss: 23195929.6000; val_masked_gp_l1_reg_loss: 73318.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230975.7344; val_chrom_access_recon_loss: 3918727.5500; val_global_loss: 31639458.4000; val_optim_loss: 31639458.4000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7655; val_auprc_score: 0.7869; val_best_acc_score: 0.5486; val_best_f1_score: 0.6851; train_kl_reg_loss: 168421.5113; train_edge_recon_loss: 3599123.6107; train_gene_expr_recon_loss: 22701583.2672; train_masked_gp_l1_reg_loss: 70788.3878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 220296.8979; train_chrom_access_recon_loss: 3849532.0267; train_global_loss: 30609745.8321; train_optim_loss: 30609745.8321; val_kl_reg_loss: 157268.3844; val_edge_recon_loss: 4061989.7333; val_gene_expr_recon_loss: 22463174.1333; val_masked_gp_l1_reg_loss: 69965.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209367.6094; val_chrom_access_recon_loss: 3855248.5833; val_global_loss: 30817014.9333; val_optim_loss: 30817014.9333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8532; val_auprc_score: 0.8581; val_best_acc_score: 0.7598; val_best_f1_score: 0.7817; train_kl_reg_loss: 157172.4439; train_edge_recon_loss: 3557813.2156; train_gene_expr_recon_loss: 22249543.1450; train_masked_gp_l1_reg_loss: 70066.9157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199088.7168; train_chrom_access_recon_loss: 3810721.4981; train_global_loss: 30044405.7863; train_optim_loss: 30044405.7863; val_kl_reg_loss: 143699.2635; val_edge_recon_loss: 4040585.7667; val_gene_expr_recon_loss: 22045472.4000; val_masked_gp_l1_reg_loss: 70810.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189009.6094; val_chrom_access_recon_loss: 3810596.0667; val_global_loss: 30300173.7333; val_optim_loss: 30300173.7333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8876; val_auprc_score: 0.8834; val_best_acc_score: 0.7986; val_best_f1_score: 0.8181; train_kl_reg_loss: 137237.1539; train_edge_recon_loss: 3530099.7710; train_gene_expr_recon_loss: 22014883.1603; train_masked_gp_l1_reg_loss: 72202.8349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 179935.2093; train_chrom_access_recon_loss: 3788808.5802; train_global_loss: 29723166.5649; train_optim_loss: 29723166.5649; val_kl_reg_loss: 119959.2630; val_edge_recon_loss: 3883793.5167; val_gene_expr_recon_loss: 21817538.2667; val_masked_gp_l1_reg_loss: 74056.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171387.2500; val_chrom_access_recon_loss: 3777627.5333; val_global_loss: 29844362.0000; val_optim_loss: 29844362.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8923; val_auprc_score: 0.8843; val_best_acc_score: 0.8025; val_best_f1_score: 0.8149; train_kl_reg_loss: 133432.9410; train_edge_recon_loss: 3253512.2672; train_gene_expr_recon_loss: 21821071.0534; train_masked_gp_l1_reg_loss: 76436.7100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164103.1289; train_chrom_access_recon_loss: 3763329.1260; train_global_loss: 29211885.1450; train_optim_loss: 29211885.1450; val_kl_reg_loss: 159177.3802; val_edge_recon_loss: 3025155.5500; val_gene_expr_recon_loss: 21693968.1333; val_masked_gp_l1_reg_loss: 78385.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157024.5312; val_chrom_access_recon_loss: 3768613.3167; val_global_loss: 28882324.4000; val_optim_loss: 28882324.4000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9029; val_auprc_score: 0.8898; val_best_acc_score: 0.8226; val_best_f1_score: 0.8310; train_kl_reg_loss: 161098.0539; train_edge_recon_loss: 2981642.9122; train_gene_expr_recon_loss: 21639315.2672; train_masked_gp_l1_reg_loss: 79923.2182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150355.8708; train_chrom_access_recon_loss: 3738884.1412; train_global_loss: 28751219.4656; train_optim_loss: 28751219.4656; val_kl_reg_loss: 160675.7469; val_edge_recon_loss: 2966763.9667; val_gene_expr_recon_loss: 21516078.6667; val_masked_gp_l1_reg_loss: 81603.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143724.2188; val_chrom_access_recon_loss: 3744546.4167; val_global_loss: 28613391.8667; val_optim_loss: 28613391.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9165; val_auprc_score: 0.9015; val_best_acc_score: 0.8418; val_best_f1_score: 0.8521; train_kl_reg_loss: 152204.1929; train_edge_recon_loss: 2933203.4733; train_gene_expr_recon_loss: 21546539.0992; train_masked_gp_l1_reg_loss: 82915.3656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137746.6130; train_chrom_access_recon_loss: 3727263.4122; train_global_loss: 28579872.0611; train_optim_loss: 28579872.0611; val_kl_reg_loss: 151250.7219; val_edge_recon_loss: 2933183.3333; val_gene_expr_recon_loss: 21538315.4667; val_masked_gp_l1_reg_loss: 84330.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132047.6875; val_chrom_access_recon_loss: 3753031.4833; val_global_loss: 28592158.9333; val_optim_loss: 28592158.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9255; val_auprc_score: 0.9142; val_best_acc_score: 0.8496; val_best_f1_score: 0.8598; train_kl_reg_loss: 151898.6432; train_edge_recon_loss: 2894926.6260; train_gene_expr_recon_loss: 21433450.1985; train_masked_gp_l1_reg_loss: 85638.5498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127004.9773; train_chrom_access_recon_loss: 3713920.1775; train_global_loss: 28406839.0840; train_optim_loss: 28406839.0840; val_kl_reg_loss: 149932.3010; val_edge_recon_loss: 2883400.1333; val_gene_expr_recon_loss: 21398527.0667; val_masked_gp_l1_reg_loss: 87045.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122226.6328; val_chrom_access_recon_loss: 3741719.4167; val_global_loss: 28382850.6667; val_optim_loss: 28382850.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9327; val_auprc_score: 0.9205; val_best_acc_score: 0.8628; val_best_f1_score: 0.8727; train_kl_reg_loss: 146434.4589; train_edge_recon_loss: 2874979.5573; train_gene_expr_recon_loss: 21362363.5420; train_masked_gp_l1_reg_loss: 88294.6046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117899.2304; train_chrom_access_recon_loss: 3708291.7557; train_global_loss: 28298263.1145; train_optim_loss: 28298263.1145; val_kl_reg_loss: 145047.4927; val_edge_recon_loss: 2868019.4167; val_gene_expr_recon_loss: 21310546.4000; val_masked_gp_l1_reg_loss: 89461.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113753.3438; val_chrom_access_recon_loss: 3723975.8167; val_global_loss: 28250805.0667; val_optim_loss: 28250805.0667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9354; val_auprc_score: 0.9219; val_best_acc_score: 0.8634; val_best_f1_score: 0.8726; train_kl_reg_loss: 143104.6555; train_edge_recon_loss: 2850248.5668; train_gene_expr_recon_loss: 21246118.9771; train_masked_gp_l1_reg_loss: 90654.6213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110180.2995; train_chrom_access_recon_loss: 3689050.8111; train_global_loss: 28129358.0305; train_optim_loss: 28129358.0305; val_kl_reg_loss: 139037.5521; val_edge_recon_loss: 2881750.0167; val_gene_expr_recon_loss: 21231482.6667; val_masked_gp_l1_reg_loss: 91864.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106549.8047; val_chrom_access_recon_loss: 3719538.5667; val_global_loss: 28170222.9333; val_optim_loss: 28170222.9333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9378; val_auprc_score: 0.9260; val_best_acc_score: 0.8666; val_best_f1_score: 0.8734; train_kl_reg_loss: 137546.3926; train_edge_recon_loss: 2837804.5534; train_gene_expr_recon_loss: 21192633.0992; train_masked_gp_l1_reg_loss: 92981.9491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103193.6854; train_chrom_access_recon_loss: 3680793.1985; train_global_loss: 28044952.8550; train_optim_loss: 28044952.8550; val_kl_reg_loss: 141730.7271; val_edge_recon_loss: 2851071.2333; val_gene_expr_recon_loss: 21089835.4667; val_masked_gp_l1_reg_loss: 94079.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99888.0391; val_chrom_access_recon_loss: 3688696.1333; val_global_loss: 27965301.6000; val_optim_loss: 27965301.6000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9464; val_auprc_score: 0.9321; val_best_acc_score: 0.8829; val_best_f1_score: 0.8890; train_kl_reg_loss: 134458.7072; train_edge_recon_loss: 2827422.7271; train_gene_expr_recon_loss: 21110802.7023; train_masked_gp_l1_reg_loss: 95145.9492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96768.2770; train_chrom_access_recon_loss: 3670626.2137; train_global_loss: 27935224.5649; train_optim_loss: 27935224.5649; val_kl_reg_loss: 128937.4286; val_edge_recon_loss: 2821384.4667; val_gene_expr_recon_loss: 21089967.8667; val_masked_gp_l1_reg_loss: 96226.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93624.4844; val_chrom_access_recon_loss: 3682767.7333; val_global_loss: 27912907.4667; val_optim_loss: 27912907.4667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9509; val_auprc_score: 0.9410; val_best_acc_score: 0.8882; val_best_f1_score: 0.8941; train_kl_reg_loss: 131781.4235; train_edge_recon_loss: 2801906.3588; train_gene_expr_recon_loss: 21067686.7634; train_masked_gp_l1_reg_loss: 97286.4925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90684.4286; train_chrom_access_recon_loss: 3664719.9198; train_global_loss: 27854065.3130; train_optim_loss: 27854065.3130; val_kl_reg_loss: 130761.0974; val_edge_recon_loss: 2797616.6000; val_gene_expr_recon_loss: 20976090.9333; val_masked_gp_l1_reg_loss: 98432.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87795.0938; val_chrom_access_recon_loss: 3666868.7167; val_global_loss: 27757565.4667; val_optim_loss: 27757565.4667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9541; val_auprc_score: 0.9428; val_best_acc_score: 0.8922; val_best_f1_score: 0.8956; train_kl_reg_loss: 129567.3557; train_edge_recon_loss: 2783680.6183; train_gene_expr_recon_loss: 20998270.8092; train_masked_gp_l1_reg_loss: 99358.6594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85178.9399; train_chrom_access_recon_loss: 3654767.1565; train_global_loss: 27750823.6031; train_optim_loss: 27750823.6031; val_kl_reg_loss: 128841.7615; val_edge_recon_loss: 2782259.2833; val_gene_expr_recon_loss: 20975123.3333; val_masked_gp_l1_reg_loss: 100330.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82593.8906; val_chrom_access_recon_loss: 3666041.5500; val_global_loss: 27735190.1333; val_optim_loss: 27735190.1333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9629; val_auprc_score: 0.9542; val_best_acc_score: 0.9030; val_best_f1_score: 0.9066; train_kl_reg_loss: 127200.6755; train_edge_recon_loss: 2785273.6393; train_gene_expr_recon_loss: 20960077.7252; train_masked_gp_l1_reg_loss: 101245.1104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80220.3368; train_chrom_access_recon_loss: 3648188.7786; train_global_loss: 27702206.4427; train_optim_loss: 27702206.4427; val_kl_reg_loss: 123955.2302; val_edge_recon_loss: 2769190.6500; val_gene_expr_recon_loss: 20895932.0000; val_masked_gp_l1_reg_loss: 102391.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77891.3047; val_chrom_access_recon_loss: 3658376.3000; val_global_loss: 27627738.1333; val_optim_loss: 27627738.1333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9651; val_auprc_score: 0.9548; val_best_acc_score: 0.9077; val_best_f1_score: 0.9107; train_kl_reg_loss: 124330.4278; train_edge_recon_loss: 2772870.2080; train_gene_expr_recon_loss: 20900619.0992; train_masked_gp_l1_reg_loss: 103253.1645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75757.6663; train_chrom_access_recon_loss: 3643687.5229; train_global_loss: 27620518.1527; train_optim_loss: 27620518.1527; val_kl_reg_loss: 125021.1880; val_edge_recon_loss: 2766233.9333; val_gene_expr_recon_loss: 20827569.2000; val_masked_gp_l1_reg_loss: 104202.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73662.3281; val_chrom_access_recon_loss: 3651098.3167; val_global_loss: 27547786.5333; val_optim_loss: 27547786.5333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9677; val_auprc_score: 0.9592; val_best_acc_score: 0.9116; val_best_f1_score: 0.9142; train_kl_reg_loss: 123269.4782; train_edge_recon_loss: 2759411.9427; train_gene_expr_recon_loss: 20872261.5420; train_masked_gp_l1_reg_loss: 104971.3402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71783.5086; train_chrom_access_recon_loss: 3638154.4561; train_global_loss: 27569852.2443; train_optim_loss: 27569852.2443; val_kl_reg_loss: 122449.9422; val_edge_recon_loss: 2747783.7500; val_gene_expr_recon_loss: 20886283.7333; val_masked_gp_l1_reg_loss: 105979.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69970.1172; val_chrom_access_recon_loss: 3656819.0833; val_global_loss: 27589286.4000; val_optim_loss: 27589286.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9669; val_auprc_score: 0.9594; val_best_acc_score: 0.9076; val_best_f1_score: 0.9105; train_kl_reg_loss: 120925.0943; train_edge_recon_loss: 2757098.1660; train_gene_expr_recon_loss: 20821365.7405; train_masked_gp_l1_reg_loss: 106855.0716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68369.5606; train_chrom_access_recon_loss: 3629861.5439; train_global_loss: 27504475.1450; train_optim_loss: 27504475.1450; val_kl_reg_loss: 120323.8740; val_edge_recon_loss: 2752445.1667; val_gene_expr_recon_loss: 20765834.8000; val_masked_gp_l1_reg_loss: 107646.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66699.2734; val_chrom_access_recon_loss: 3652802.5167; val_global_loss: 27465752.1333; val_optim_loss: 27465752.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9665; val_auprc_score: 0.9517; val_best_acc_score: 0.9147; val_best_f1_score: 0.9161; train_kl_reg_loss: 119236.2111; train_edge_recon_loss: 2748485.3702; train_gene_expr_recon_loss: 20782716.7786; train_masked_gp_l1_reg_loss: 108544.6317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65239.6080; train_chrom_access_recon_loss: 3626564.3263; train_global_loss: 27450786.9313; train_optim_loss: 27450786.9313; val_kl_reg_loss: 120334.4703; val_edge_recon_loss: 2747978.8833; val_gene_expr_recon_loss: 20789931.3333; val_masked_gp_l1_reg_loss: 109329.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63815.4062; val_chrom_access_recon_loss: 3634055.8000; val_global_loss: 27465446.0000; val_optim_loss: 27465446.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9688; val_auprc_score: 0.9619; val_best_acc_score: 0.9139; val_best_f1_score: 0.9166; train_kl_reg_loss: 117861.2527; train_edge_recon_loss: 2738364.1698; train_gene_expr_recon_loss: 20747522.4427; train_masked_gp_l1_reg_loss: 110295.1744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62463.9417; train_chrom_access_recon_loss: 3622032.9981; train_global_loss: 27398539.9695; train_optim_loss: 27398539.9695; val_kl_reg_loss: 115577.2047; val_edge_recon_loss: 2753205.3333; val_gene_expr_recon_loss: 20675380.1333; val_masked_gp_l1_reg_loss: 111050.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61097.5078; val_chrom_access_recon_loss: 3640612.4000; val_global_loss: 27356922.9333; val_optim_loss: 27356922.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9698; val_auprc_score: 0.9618; val_best_acc_score: 0.9170; val_best_f1_score: 0.9195; train_kl_reg_loss: 115543.5151; train_edge_recon_loss: 2739439.7958; train_gene_expr_recon_loss: 20731568.5496; train_masked_gp_l1_reg_loss: 111980.6421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59911.0925; train_chrom_access_recon_loss: 3622852.0725; train_global_loss: 27381295.6794; train_optim_loss: 27381295.6794; val_kl_reg_loss: 116442.0328; val_edge_recon_loss: 2754242.9167; val_gene_expr_recon_loss: 20730237.4667; val_masked_gp_l1_reg_loss: 112696.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58698.3945; val_chrom_access_recon_loss: 3648781.3333; val_global_loss: 27421098.0000; val_optim_loss: 27421098.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9724; val_auprc_score: 0.9648; val_best_acc_score: 0.9214; val_best_f1_score: 0.9234; train_kl_reg_loss: 113729.7840; train_edge_recon_loss: 2740120.9256; train_gene_expr_recon_loss: 20659572.4885; train_masked_gp_l1_reg_loss: 113591.1387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57584.4620; train_chrom_access_recon_loss: 3612212.5859; train_global_loss: 27296811.5420; train_optim_loss: 27296811.5420; val_kl_reg_loss: 115279.9068; val_edge_recon_loss: 2732345.9500; val_gene_expr_recon_loss: 20628596.6667; val_masked_gp_l1_reg_loss: 114578.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56469.1289; val_chrom_access_recon_loss: 3626674.5833; val_global_loss: 27273945.3333; val_optim_loss: 27273945.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9718; val_auprc_score: 0.9650; val_best_acc_score: 0.9177; val_best_f1_score: 0.9212; train_kl_reg_loss: 112046.4196; train_edge_recon_loss: 2736854.7271; train_gene_expr_recon_loss: 20643575.4809; train_masked_gp_l1_reg_loss: 115388.2667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55497.5748; train_chrom_access_recon_loss: 3612142.0401; train_global_loss: 27275504.6412; train_optim_loss: 27275504.6412; val_kl_reg_loss: 114791.8646; val_edge_recon_loss: 2739005.1667; val_gene_expr_recon_loss: 20668614.2667; val_masked_gp_l1_reg_loss: 116220.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54490.1484; val_chrom_access_recon_loss: 3632789.7000; val_global_loss: 27325910.9333; val_optim_loss: 27325910.9333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9749; val_auprc_score: 0.9685; val_best_acc_score: 0.9250; val_best_f1_score: 0.9281; train_kl_reg_loss: 110726.4683; train_edge_recon_loss: 2734253.3588; train_gene_expr_recon_loss: 20620814.7176; train_masked_gp_l1_reg_loss: 116988.5087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53622.6825; train_chrom_access_recon_loss: 3611856.6756; train_global_loss: 27248262.5802; train_optim_loss: 27248262.5802; val_kl_reg_loss: 112416.9292; val_edge_recon_loss: 2743760.7167; val_gene_expr_recon_loss: 20648119.3333; val_masked_gp_l1_reg_loss: 117830.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52774.3672; val_chrom_access_recon_loss: 3635842.6833; val_global_loss: 27310743.7333; val_optim_loss: 27310743.7333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9721; val_auprc_score: 0.9647; val_best_acc_score: 0.9233; val_best_f1_score: 0.9250; train_kl_reg_loss: 109714.3647; train_edge_recon_loss: 2724656.1813; train_gene_expr_recon_loss: 20577108.0763; train_masked_gp_l1_reg_loss: 118657.2711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51927.2689; train_chrom_access_recon_loss: 3604616.1317; train_global_loss: 27186679.4046; train_optim_loss: 27186679.4046; val_kl_reg_loss: 107905.6349; val_edge_recon_loss: 2750006.1667; val_gene_expr_recon_loss: 20592949.2000; val_masked_gp_l1_reg_loss: 119480.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51112.2695; val_chrom_access_recon_loss: 3628035.6167; val_global_loss: 27249488.4000; val_optim_loss: 27249488.4000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9375; val_auprc_score: 0.9246; val_best_acc_score: 0.8680; val_best_f1_score: 0.8743; train_kl_reg_loss: 131021.0779; train_edge_recon_loss: 2969654.0840; train_gene_expr_recon_loss: 24612616.6107; train_masked_gp_l1_reg_loss: 122509.5757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55074.2555; train_chrom_access_recon_loss: 3884717.0324; train_global_loss: 31775592.7176; train_optim_loss: 31775592.7176; val_kl_reg_loss: 14193.8939; val_edge_recon_loss: 2864401.9667; val_gene_expr_recon_loss: 25014309.0667; val_masked_gp_l1_reg_loss: 122296.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56111.7734; val_chrom_access_recon_loss: 3876306.5333; val_global_loss: 31947619.6000; val_optim_loss: 31947619.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9502; val_auprc_score: 0.9391; val_best_acc_score: 0.8888; val_best_f1_score: 0.8936; train_kl_reg_loss: 63501.4821; train_edge_recon_loss: 2784120.1298; train_gene_expr_recon_loss: 24679528.2901; train_masked_gp_l1_reg_loss: 118895.5985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54360.5156; train_chrom_access_recon_loss: 3848364.4656; train_global_loss: 31548770.2901; train_optim_loss: 31548770.2901; val_kl_reg_loss: 20204.9993; val_edge_recon_loss: 2763140.0833; val_gene_expr_recon_loss: 24380995.2000; val_masked_gp_l1_reg_loss: 115392.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52389.3789; val_chrom_access_recon_loss: 3854903.9167; val_global_loss: 31187026.2667; val_optim_loss: 31187026.2667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9528; val_auprc_score: 0.9417; val_best_acc_score: 0.8936; val_best_f1_score: 0.8996; train_kl_reg_loss: 44314.0754; train_edge_recon_loss: 2727343.5038; train_gene_expr_recon_loss: 24258761.3435; train_masked_gp_l1_reg_loss: 112071.1752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50662.7385; train_chrom_access_recon_loss: 3824710.5878; train_global_loss: 31017863.6641; train_optim_loss: 31017863.6641; val_kl_reg_loss: 26985.5219; val_edge_recon_loss: 2725658.8000; val_gene_expr_recon_loss: 24034742.5333; val_masked_gp_l1_reg_loss: 108716.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48948.9883; val_chrom_access_recon_loss: 3836204.5833; val_global_loss: 30781255.7333; val_optim_loss: 30781255.7333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9550; val_auprc_score: 0.9372; val_best_acc_score: 0.8999; val_best_f1_score: 0.9039; train_kl_reg_loss: 40328.3225; train_edge_recon_loss: 2707653.2080; train_gene_expr_recon_loss: 23973380.8244; train_masked_gp_l1_reg_loss: 105634.3193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47376.0255; train_chrom_access_recon_loss: 3809814.3187; train_global_loss: 30684186.8550; train_optim_loss: 30684186.8550; val_kl_reg_loss: 29431.7628; val_edge_recon_loss: 2711443.8667; val_gene_expr_recon_loss: 23818618.2667; val_masked_gp_l1_reg_loss: 102547.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45723.3320; val_chrom_access_recon_loss: 3817687.9000; val_global_loss: 30525453.7333; val_optim_loss: 30525453.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9508; val_auprc_score: 0.9328; val_best_acc_score: 0.8968; val_best_f1_score: 0.9008; train_kl_reg_loss: 40965.0554; train_edge_recon_loss: 2706853.8626; train_gene_expr_recon_loss: 23805799.0076; train_masked_gp_l1_reg_loss: 101902.6316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45505.4130; train_chrom_access_recon_loss: 3797851.1660; train_global_loss: 30498876.9618; train_optim_loss: 30498876.9618; val_kl_reg_loss: 29733.9845; val_edge_recon_loss: 2728547.8500; val_gene_expr_recon_loss: 23887790.5333; val_masked_gp_l1_reg_loss: 101562.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45319.6719; val_chrom_access_recon_loss: 3836360.2667; val_global_loss: 30629314.5333; val_optim_loss: 30629314.5333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9581; val_auprc_score: 0.9448; val_best_acc_score: 0.9061; val_best_f1_score: 0.9096; train_kl_reg_loss: 40703.0873; train_edge_recon_loss: 2700153.3931; train_gene_expr_recon_loss: 23810357.3435; train_masked_gp_l1_reg_loss: 101247.7643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45146.3218; train_chrom_access_recon_loss: 3803112.9943; train_global_loss: 30500720.8855; train_optim_loss: 30500720.8855; val_kl_reg_loss: 29973.6382; val_edge_recon_loss: 2687770.3167; val_gene_expr_recon_loss: 23790852.0000; val_masked_gp_l1_reg_loss: 100923.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44968.1680; val_chrom_access_recon_loss: 3835030.2500; val_global_loss: 30489518.4000; val_optim_loss: 30489518.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9515; val_auprc_score: 0.9346; val_best_acc_score: 0.8957; val_best_f1_score: 0.9008; train_kl_reg_loss: 40524.7398; train_edge_recon_loss: 2705261.4790; train_gene_expr_recon_loss: 23793350.7481; train_masked_gp_l1_reg_loss: 100595.5549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44790.9232; train_chrom_access_recon_loss: 3801181.7519; train_global_loss: 30485705.0076; train_optim_loss: 30485705.0076; val_kl_reg_loss: 30491.7319; val_edge_recon_loss: 2743978.9333; val_gene_expr_recon_loss: 23678222.0000; val_masked_gp_l1_reg_loss: 100255.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44604.5898; val_chrom_access_recon_loss: 3810175.0833; val_global_loss: 30407727.7333; val_optim_loss: 30407727.7333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9518; val_auprc_score: 0.9361; val_best_acc_score: 0.8968; val_best_f1_score: 0.9023; train_kl_reg_loss: 40514.5392; train_edge_recon_loss: 2700995.5210; train_gene_expr_recon_loss: 23744445.0534; train_masked_gp_l1_reg_loss: 99913.7156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44421.2308; train_chrom_access_recon_loss: 3797478.8015; train_global_loss: 30427768.7786; train_optim_loss: 30427768.7786; val_kl_reg_loss: 30894.9009; val_edge_recon_loss: 2731765.5667; val_gene_expr_recon_loss: 23754652.4000; val_masked_gp_l1_reg_loss: 99563.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44236.9219; val_chrom_access_recon_loss: 3821884.9500; val_global_loss: 30482997.4667; val_optim_loss: 30482997.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 3 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9752
val AUPRC score: 0.9692
val best accuracy score: 0.9275
val best F1 score: 0.9289
val target rna MSE score: 4.3646
val source rna MSE score: 544.1532
val target atac MSE score: 0.6098
val source atac MSE score: 8.0036
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
