[True]
Run timestamp: 10082023_212347_55.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_55']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7801; val_auprc_score: 0.8023; val_best_acc_score: 0.5866; val_best_f1_score: 0.6991; train_kl_reg_loss: 4926806.1353; train_edge_recon_loss: 3956816.8626; train_gene_expr_recon_loss: 47596671.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25734243.5573; train_global_loss: 82214537.8015; train_optim_loss: 82214537.8015; val_kl_reg_loss: 160492.3302; val_edge_recon_loss: 4059867.6333; val_gene_expr_recon_loss: 39336977.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23307056.0000; val_global_loss: 66864392.5333; val_optim_loss: 66864392.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7843; val_auprc_score: 0.8004; val_best_acc_score: 0.6927; val_best_f1_score: 0.7302; train_kl_reg_loss: 193387.7146; train_edge_recon_loss: 3837021.8740; train_gene_expr_recon_loss: 38975282.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 23269097.8473; train_global_loss: 66274790.2290; train_optim_loss: 66274790.2290; val_kl_reg_loss: 190326.7479; val_edge_recon_loss: 3938925.2500; val_gene_expr_recon_loss: 37660557.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23127781.4667; val_global_loss: 64917590.4000; val_optim_loss: 64917590.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8176; val_auprc_score: 0.8231; val_best_acc_score: 0.7289; val_best_f1_score: 0.7479; train_kl_reg_loss: 208160.8418; train_edge_recon_loss: 3523556.1966; train_gene_expr_recon_loss: 37353005.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22990375.9847; train_global_loss: 64075098.8702; train_optim_loss: 64075098.8702; val_kl_reg_loss: 226708.9750; val_edge_recon_loss: 3399536.9000; val_gene_expr_recon_loss: 37041325.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22907927.3333; val_global_loss: 63575498.9333; val_optim_loss: 63575498.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8661; val_auprc_score: 0.8666; val_best_acc_score: 0.7715; val_best_f1_score: 0.7796; train_kl_reg_loss: 245933.3639; train_edge_recon_loss: 3190498.4504; train_gene_expr_recon_loss: 36844753.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22816259.5725; train_global_loss: 63097444.8855; train_optim_loss: 63097444.8855; val_kl_reg_loss: 236599.5125; val_edge_recon_loss: 3149693.1333; val_gene_expr_recon_loss: 36761231.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22792497.8667; val_global_loss: 62940021.6000; val_optim_loss: 62940021.6000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8901; val_auprc_score: 0.8788; val_best_acc_score: 0.8052; val_best_f1_score: 0.8170; train_kl_reg_loss: 232090.7172; train_edge_recon_loss: 3069320.2805; train_gene_expr_recon_loss: 36509998.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22661338.0611; train_global_loss: 62472748.2137; train_optim_loss: 62472748.2137; val_kl_reg_loss: 215589.4354; val_edge_recon_loss: 3041935.7000; val_gene_expr_recon_loss: 36655561.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22765769.0667; val_global_loss: 62678855.4667; val_optim_loss: 62678855.4667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9115; val_auprc_score: 0.9010; val_best_acc_score: 0.8359; val_best_f1_score: 0.8451; train_kl_reg_loss: 219508.6595; train_edge_recon_loss: 3006526.6546; train_gene_expr_recon_loss: 36224790.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22501447.7557; train_global_loss: 61952273.4351; train_optim_loss: 61952273.4351; val_kl_reg_loss: 215583.3563; val_edge_recon_loss: 2976068.8167; val_gene_expr_recon_loss: 36285247.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22611878.2667; val_global_loss: 62088778.1333; val_optim_loss: 62088778.1333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9244; val_auprc_score: 0.9114; val_best_acc_score: 0.8506; val_best_f1_score: 0.8594; train_kl_reg_loss: 213551.3862; train_edge_recon_loss: 2945937.0935; train_gene_expr_recon_loss: 36061956.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22447123.8168; train_global_loss: 61668568.1527; train_optim_loss: 61668568.1527; val_kl_reg_loss: 210214.9823; val_edge_recon_loss: 2920702.2833; val_gene_expr_recon_loss: 36025095.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22449482.5333; val_global_loss: 61605496.2667; val_optim_loss: 61605496.2667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9354; val_auprc_score: 0.9266; val_best_acc_score: 0.8638; val_best_f1_score: 0.8716; train_kl_reg_loss: 204462.2487; train_edge_recon_loss: 2910412.3416; train_gene_expr_recon_loss: 35836475.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22308306.1679; train_global_loss: 61259656.1527; train_optim_loss: 61259656.1527; val_kl_reg_loss: 197846.4448; val_edge_recon_loss: 2898424.7167; val_gene_expr_recon_loss: 35783182.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22259391.8667; val_global_loss: 61138845.6000; val_optim_loss: 61138845.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9397; val_auprc_score: 0.9290; val_best_acc_score: 0.8756; val_best_f1_score: 0.8800; train_kl_reg_loss: 196416.1304; train_edge_recon_loss: 2880216.0286; train_gene_expr_recon_loss: 35666846.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22233215.6489; train_global_loss: 60976694.6260; train_optim_loss: 60976694.6260; val_kl_reg_loss: 188859.9542; val_edge_recon_loss: 2881932.2667; val_gene_expr_recon_loss: 35765740.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22194254.1333; val_global_loss: 61030786.1333; val_optim_loss: 61030786.1333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9438; val_auprc_score: 0.9338; val_best_acc_score: 0.8767; val_best_f1_score: 0.8829; train_kl_reg_loss: 188452.6682; train_edge_recon_loss: 2870004.7672; train_gene_expr_recon_loss: 35529874.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22153316.1221; train_global_loss: 60741648.3664; train_optim_loss: 60741648.3664; val_kl_reg_loss: 183241.0958; val_edge_recon_loss: 2880879.3833; val_gene_expr_recon_loss: 35506211.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22169903.7333; val_global_loss: 60740236.2667; val_optim_loss: 60740236.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9462; val_auprc_score: 0.9354; val_best_acc_score: 0.8833; val_best_f1_score: 0.8899; train_kl_reg_loss: 181732.3267; train_edge_recon_loss: 2856451.2996; train_gene_expr_recon_loss: 35351529.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22038987.5420; train_global_loss: 60428700.6107; train_optim_loss: 60428700.6107; val_kl_reg_loss: 176785.9615; val_edge_recon_loss: 2855171.8667; val_gene_expr_recon_loss: 35307068.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21997918.9333; val_global_loss: 60336945.6000; val_optim_loss: 60336945.6000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9507; val_auprc_score: 0.9415; val_best_acc_score: 0.8902; val_best_f1_score: 0.8948; train_kl_reg_loss: 174464.3031; train_edge_recon_loss: 2840282.1126; train_gene_expr_recon_loss: 35253621.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22021190.9160; train_global_loss: 60289559.1450; train_optim_loss: 60289559.1450; val_kl_reg_loss: 175433.5521; val_edge_recon_loss: 2835822.5167; val_gene_expr_recon_loss: 35258242.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21985409.8667; val_global_loss: 60254908.5333; val_optim_loss: 60254908.5333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9542; val_auprc_score: 0.9457; val_best_acc_score: 0.8949; val_best_f1_score: 0.8982; train_kl_reg_loss: 170261.4476; train_edge_recon_loss: 2820489.5954; train_gene_expr_recon_loss: 35072449.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21893036.8397; train_global_loss: 59956236.8855; train_optim_loss: 59956236.8855; val_kl_reg_loss: 171573.7917; val_edge_recon_loss: 2818715.4833; val_gene_expr_recon_loss: 35079658.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21879086.1333; val_global_loss: 59949033.6000; val_optim_loss: 59949033.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9564; val_auprc_score: 0.9472; val_best_acc_score: 0.8988; val_best_f1_score: 0.9029; train_kl_reg_loss: 166229.6407; train_edge_recon_loss: 2804239.3760; train_gene_expr_recon_loss: 34968508.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21841525.9847; train_global_loss: 59780503.7252; train_optim_loss: 59780503.7252; val_kl_reg_loss: 160975.6990; val_edge_recon_loss: 2812457.7833; val_gene_expr_recon_loss: 35018761.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21839313.2000; val_global_loss: 59831508.2667; val_optim_loss: 59831508.2667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9608; val_auprc_score: 0.9525; val_best_acc_score: 0.9039; val_best_f1_score: 0.9078; train_kl_reg_loss: 160855.4065; train_edge_recon_loss: 2800901.3893; train_gene_expr_recon_loss: 34849848.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21763407.7863; train_global_loss: 59575013.2214; train_optim_loss: 59575013.2214; val_kl_reg_loss: 157319.4646; val_edge_recon_loss: 2820724.8833; val_gene_expr_recon_loss: 34878526.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21744174.8000; val_global_loss: 59600745.6000; val_optim_loss: 59600745.6000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9631; val_auprc_score: 0.9554; val_best_acc_score: 0.9047; val_best_f1_score: 0.9084; train_kl_reg_loss: 155679.3671; train_edge_recon_loss: 2794555.2080; train_gene_expr_recon_loss: 34807608.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21746990.8397; train_global_loss: 59504833.1908; train_optim_loss: 59504833.1908; val_kl_reg_loss: 154139.5187; val_edge_recon_loss: 2805128.2833; val_gene_expr_recon_loss: 34881168.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21817019.8667; val_global_loss: 59657456.0000; val_optim_loss: 59657456.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9667; val_auprc_score: 0.9589; val_best_acc_score: 0.9124; val_best_f1_score: 0.9152; train_kl_reg_loss: 153431.0324; train_edge_recon_loss: 2791642.9008; train_gene_expr_recon_loss: 34691008.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21660512.0000; train_global_loss: 59296594.5344; train_optim_loss: 59296594.5344; val_kl_reg_loss: 152091.4104; val_edge_recon_loss: 2779100.8500; val_gene_expr_recon_loss: 34833116.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21730479.6000; val_global_loss: 59494787.4667; val_optim_loss: 59494787.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9662; val_auprc_score: 0.9598; val_best_acc_score: 0.9116; val_best_f1_score: 0.9156; train_kl_reg_loss: 150633.4365; train_edge_recon_loss: 2774246.8168; train_gene_expr_recon_loss: 34595238.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21632758.5038; train_global_loss: 59152877.5573; train_optim_loss: 59152877.5573; val_kl_reg_loss: 154165.7521; val_edge_recon_loss: 2794381.5000; val_gene_expr_recon_loss: 34899833.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21887497.2000; val_global_loss: 59735877.0667; val_optim_loss: 59735877.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9669; val_auprc_score: 0.9569; val_best_acc_score: 0.9147; val_best_f1_score: 0.9180; train_kl_reg_loss: 146706.4518; train_edge_recon_loss: 2783311.7042; train_gene_expr_recon_loss: 34547699.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21599874.6260; train_global_loss: 59077592.7939; train_optim_loss: 59077592.7939; val_kl_reg_loss: 144401.2719; val_edge_recon_loss: 2785888.6000; val_gene_expr_recon_loss: 34581756.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21602568.2667; val_global_loss: 59114614.6667; val_optim_loss: 59114614.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9718; val_auprc_score: 0.9667; val_best_acc_score: 0.9200; val_best_f1_score: 0.9232; train_kl_reg_loss: 143755.7539; train_edge_recon_loss: 2774246.2118; train_gene_expr_recon_loss: 34448777.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21578490.5344; train_global_loss: 58945269.7405; train_optim_loss: 58945269.7405; val_kl_reg_loss: 146137.8229; val_edge_recon_loss: 2781459.6000; val_gene_expr_recon_loss: 34708813.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21660123.2000; val_global_loss: 59296534.6667; val_optim_loss: 59296534.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9715; val_auprc_score: 0.9668; val_best_acc_score: 0.9193; val_best_f1_score: 0.9228; train_kl_reg_loss: 143352.0586; train_edge_recon_loss: 2768024.4981; train_gene_expr_recon_loss: 34373155.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21551569.2214; train_global_loss: 58836101.1603; train_optim_loss: 58836101.1603; val_kl_reg_loss: 140570.0229; val_edge_recon_loss: 2782758.7333; val_gene_expr_recon_loss: 34492951.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21465747.8667; val_global_loss: 58882027.7333; val_optim_loss: 58882027.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9721; val_auprc_score: 0.9651; val_best_acc_score: 0.9233; val_best_f1_score: 0.9256; train_kl_reg_loss: 139540.5129; train_edge_recon_loss: 2768805.6489; train_gene_expr_recon_loss: 34294120.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21512534.8092; train_global_loss: 58715001.4351; train_optim_loss: 58715001.4351; val_kl_reg_loss: 137526.4979; val_edge_recon_loss: 2775827.3667; val_gene_expr_recon_loss: 34424802.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21548352.8000; val_global_loss: 58886509.6000; val_optim_loss: 58886509.6000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9700; val_auprc_score: 0.9644; val_best_acc_score: 0.9190; val_best_f1_score: 0.9231; train_kl_reg_loss: 138250.6097; train_edge_recon_loss: 2757411.0916; train_gene_expr_recon_loss: 34222198.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21485072.6412; train_global_loss: 58602932.8244; train_optim_loss: 58602932.8244; val_kl_reg_loss: 135388.3656; val_edge_recon_loss: 2772199.3667; val_gene_expr_recon_loss: 34344844.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21471548.9333; val_global_loss: 58723980.0000; val_optim_loss: 58723980.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9670; val_auprc_score: 0.9595; val_best_acc_score: 0.9131; val_best_f1_score: 0.9175; train_kl_reg_loss: 135444.0243; train_edge_recon_loss: 2768360.3950; train_gene_expr_recon_loss: 34575271.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21511394.7176; train_global_loss: 58990470.3817; train_optim_loss: 58990470.3817; val_kl_reg_loss: 156619.4823; val_edge_recon_loss: 2852045.5167; val_gene_expr_recon_loss: 35205452.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21646384.1333; val_global_loss: 59860501.3333; val_optim_loss: 59860501.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9554; val_auprc_score: 0.9463; val_best_acc_score: 0.8963; val_best_f1_score: 0.8992; train_kl_reg_loss: 190013665.4776; train_edge_recon_loss: 2858518.1584; train_gene_expr_recon_loss: 36223724.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21798089.4656; train_global_loss: 250894001.5878; train_optim_loss: 250894001.5878; val_kl_reg_loss: 139561.3875; val_edge_recon_loss: 2900631.9500; val_gene_expr_recon_loss: 36308566.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21781193.2000; val_global_loss: 61129952.5333; val_optim_loss: 61129952.5333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9620; val_auprc_score: 0.9560; val_best_acc_score: 0.9030; val_best_f1_score: 0.9053; train_kl_reg_loss: 351752.0262; train_edge_recon_loss: 2850038.2195; train_gene_expr_recon_loss: 35458040.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21605865.5878; train_global_loss: 60265696.0305; train_optim_loss: 60265696.0305; val_kl_reg_loss: 122944.7693; val_edge_recon_loss: 2830733.8167; val_gene_expr_recon_loss: 35535430.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21616801.4667; val_global_loss: 60105910.4000; val_optim_loss: 60105910.4000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9589; val_auprc_score: 0.9482; val_best_acc_score: 0.9010; val_best_f1_score: 0.9057; train_kl_reg_loss: 175406.8466; train_edge_recon_loss: 2800149.3531; train_gene_expr_recon_loss: 35657621.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21556823.3893; train_global_loss: 60190000.8550; train_optim_loss: 60190000.8550; val_kl_reg_loss: 118783.2604; val_edge_recon_loss: 2820471.9000; val_gene_expr_recon_loss: 35434062.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21621719.4667; val_global_loss: 59995037.0667; val_optim_loss: 59995037.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9643; val_auprc_score: 0.9559; val_best_acc_score: 0.9057; val_best_f1_score: 0.9102; train_kl_reg_loss: 154650.3461; train_edge_recon_loss: 2792652.1431; train_gene_expr_recon_loss: 34971661.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21504758.3969; train_global_loss: 59423723.1145; train_optim_loss: 59423723.1145; val_kl_reg_loss: 122048.4057; val_edge_recon_loss: 2796929.1667; val_gene_expr_recon_loss: 35102998.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21576965.7333; val_global_loss: 59598941.8667; val_optim_loss: 59598941.8667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9675; val_auprc_score: 0.9604; val_best_acc_score: 0.9142; val_best_f1_score: 0.9170; train_kl_reg_loss: 156975.6873; train_edge_recon_loss: 2783137.9618; train_gene_expr_recon_loss: 34877362.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21458903.3588; train_global_loss: 59276379.9389; train_optim_loss: 59276379.9389; val_kl_reg_loss: 123689.3568; val_edge_recon_loss: 2764237.0667; val_gene_expr_recon_loss: 34938741.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21525916.1333; val_global_loss: 59352583.7333; val_optim_loss: 59352583.7333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9672; val_auprc_score: 0.9605; val_best_acc_score: 0.9135; val_best_f1_score: 0.9162; train_kl_reg_loss: 156944.6980; train_edge_recon_loss: 2785234.8302; train_gene_expr_recon_loss: 34865698.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21489854.7176; train_global_loss: 59297732.7939; train_optim_loss: 59297732.7939; val_kl_reg_loss: 123173.3021; val_edge_recon_loss: 2786175.6333; val_gene_expr_recon_loss: 35329455.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21547269.7333; val_global_loss: 59786074.4000; val_optim_loss: 59786074.4000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9650; val_auprc_score: 0.9568; val_best_acc_score: 0.9117; val_best_f1_score: 0.9146; train_kl_reg_loss: 156368.2193; train_edge_recon_loss: 2782386.2233; train_gene_expr_recon_loss: 34908527.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21456679.5420; train_global_loss: 59303961.4351; train_optim_loss: 59303961.4351; val_kl_reg_loss: 123592.2667; val_edge_recon_loss: 2814261.2500; val_gene_expr_recon_loss: 35022408.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21576840.2667; val_global_loss: 59537102.1333; val_optim_loss: 59537102.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 27 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9719
val AUPRC score: 0.9647
val best accuracy score: 0.9228
val best F1 score: 0.9260
val target rna MSE score: 0.9299
val source rna MSE score: 14.8372
val target atac MSE score: 0.1221
val source atac MSE score: 1.0108
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
