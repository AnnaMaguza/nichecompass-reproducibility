[True]
Run timestamp: 26072023_021259_58.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_58']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9559; val_auprc_score: 0.9580; val_best_acc_score: 0.7952; val_best_f1_score: 0.7498; train_kl_reg_loss: 769.1620; train_edge_recon_loss: 3464027.6389; train_gene_expr_recon_loss: 320762.5174; train_masked_gp_l1_reg_loss: 1547.1062; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1078319.9722; train_global_loss: 4865426.2778; train_optim_loss: 4865426.2778; val_kl_reg_loss: 544.4731; val_edge_recon_loss: 4009188.7500; val_gene_expr_recon_loss: 320647.8438; val_masked_gp_l1_reg_loss: 1216.0684; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1085202.6250; val_global_loss: 5416799.5000; val_optim_loss: 5416799.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8858; val_auprc_score: 0.8768; val_best_acc_score: 0.8005; val_best_f1_score: 0.8090; train_kl_reg_loss: 768.4536; train_edge_recon_loss: 3425521.5833; train_gene_expr_recon_loss: 311000.8403; train_masked_gp_l1_reg_loss: 1078.7405; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1077333.4444; train_global_loss: 4815703.0000; train_optim_loss: 4815703.0000; val_kl_reg_loss: 1792.8383; val_edge_recon_loss: 3305482.2500; val_gene_expr_recon_loss: 308917.0312; val_masked_gp_l1_reg_loss: 975.8979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1077906.3750; val_global_loss: 4695074.5000; val_optim_loss: 4695074.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8803; val_auprc_score: 0.8740; val_best_acc_score: 0.7797; val_best_f1_score: 0.7937; train_kl_reg_loss: 8040.4903; train_edge_recon_loss: 3021704.8056; train_gene_expr_recon_loss: 304769.7569; train_masked_gp_l1_reg_loss: 987.0122; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1069802.6250; train_global_loss: 4405304.7222; train_optim_loss: 4405304.7222; val_kl_reg_loss: 19794.0820; val_edge_recon_loss: 2867946.2500; val_gene_expr_recon_loss: 310224.6875; val_masked_gp_l1_reg_loss: 1005.5554; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1079633.2500; val_global_loss: 4278604.0000; val_optim_loss: 4278604.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9105; val_auprc_score: 0.8896; val_best_acc_score: 0.8329; val_best_f1_score: 0.8432; train_kl_reg_loss: 27408.3917; train_edge_recon_loss: 2784911.5000; train_gene_expr_recon_loss: 304716.3368; train_masked_gp_l1_reg_loss: 1005.2016; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1063138.1736; train_global_loss: 4181179.6389; train_optim_loss: 4181179.6389; val_kl_reg_loss: 30974.8320; val_edge_recon_loss: 2755525.7500; val_gene_expr_recon_loss: 302790.8750; val_masked_gp_l1_reg_loss: 1012.2478; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1072224.2500; val_global_loss: 4162528.0000; val_optim_loss: 4162528.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9283; val_auprc_score: 0.9053; val_best_acc_score: 0.8659; val_best_f1_score: 0.8734; train_kl_reg_loss: 29664.8082; train_edge_recon_loss: 2730698.2500; train_gene_expr_recon_loss: 297855.1076; train_masked_gp_l1_reg_loss: 1029.7080; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1062554.1667; train_global_loss: 4121801.9444; train_optim_loss: 4121801.9444; val_kl_reg_loss: 26144.0820; val_edge_recon_loss: 2738938.7500; val_gene_expr_recon_loss: 296580.3125; val_masked_gp_l1_reg_loss: 1057.4440; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1065915.1250; val_global_loss: 4128635.5000; val_optim_loss: 4128635.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9406; val_auprc_score: 0.9220; val_best_acc_score: 0.8775; val_best_f1_score: 0.8851; train_kl_reg_loss: 23766.9622; train_edge_recon_loss: 2699275.0278; train_gene_expr_recon_loss: 292005.0139; train_masked_gp_l1_reg_loss: 1090.0272; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1055659.5556; train_global_loss: 4071796.6389; train_optim_loss: 4071796.6389; val_kl_reg_loss: 22406.8164; val_edge_recon_loss: 2696292.0000; val_gene_expr_recon_loss: 293647.6562; val_masked_gp_l1_reg_loss: 1125.1635; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1064227.8750; val_global_loss: 4077699.5000; val_optim_loss: 4077699.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9499; val_auprc_score: 0.9329; val_best_acc_score: 0.8946; val_best_f1_score: 0.9002; train_kl_reg_loss: 23101.6921; train_edge_recon_loss: 2685783.4444; train_gene_expr_recon_loss: 291722.5451; train_masked_gp_l1_reg_loss: 1153.0800; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060162.8472; train_global_loss: 4061923.6667; train_optim_loss: 4061923.6667; val_kl_reg_loss: 22708.9727; val_edge_recon_loss: 2692394.0000; val_gene_expr_recon_loss: 289439.0000; val_masked_gp_l1_reg_loss: 1188.8962; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1060788.3750; val_global_loss: 4066519.5000; val_optim_loss: 4066519.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9523; val_auprc_score: 0.9346; val_best_acc_score: 0.8981; val_best_f1_score: 0.9026; train_kl_reg_loss: 22417.0955; train_edge_recon_loss: 2667188.3611; train_gene_expr_recon_loss: 286742.4861; train_masked_gp_l1_reg_loss: 1219.3446; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1053062.0972; train_global_loss: 4030629.3611; train_optim_loss: 4030629.3611; val_kl_reg_loss: 21866.5898; val_edge_recon_loss: 2681943.2500; val_gene_expr_recon_loss: 288486.7188; val_masked_gp_l1_reg_loss: 1254.4227; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1056556.2500; val_global_loss: 4050107.2500; val_optim_loss: 4050107.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9564; val_auprc_score: 0.9408; val_best_acc_score: 0.9035; val_best_f1_score: 0.9066; train_kl_reg_loss: 22600.9562; train_edge_recon_loss: 2661191.1944; train_gene_expr_recon_loss: 282473.8125; train_masked_gp_l1_reg_loss: 1277.0311; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043817.8542; train_global_loss: 4011360.8611; train_optim_loss: 4011360.8611; val_kl_reg_loss: 22762.5508; val_edge_recon_loss: 2682804.7500; val_gene_expr_recon_loss: 282251.7188; val_masked_gp_l1_reg_loss: 1307.3236; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1052865.8750; val_global_loss: 4041992.0000; val_optim_loss: 4041992.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9558; val_auprc_score: 0.9371; val_best_acc_score: 0.9047; val_best_f1_score: 0.9091; train_kl_reg_loss: 23736.5371; train_edge_recon_loss: 2663683.3611; train_gene_expr_recon_loss: 278406.9375; train_masked_gp_l1_reg_loss: 1333.1410; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046265.6528; train_global_loss: 4013425.6111; train_optim_loss: 4013425.6111; val_kl_reg_loss: 22931.7578; val_edge_recon_loss: 2686625.5000; val_gene_expr_recon_loss: 278593.8125; val_masked_gp_l1_reg_loss: 1367.0459; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048460.6875; val_global_loss: 4037978.7500; val_optim_loss: 4037978.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9638; val_auprc_score: 0.9508; val_best_acc_score: 0.9135; val_best_f1_score: 0.9173; train_kl_reg_loss: 23331.2760; train_edge_recon_loss: 2648891.3889; train_gene_expr_recon_loss: 274124.1042; train_masked_gp_l1_reg_loss: 1395.7862; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1041266.5347; train_global_loss: 3989009.1111; train_optim_loss: 3989009.1111; val_kl_reg_loss: 22701.9297; val_edge_recon_loss: 2642724.5000; val_gene_expr_recon_loss: 273810.3125; val_masked_gp_l1_reg_loss: 1430.5398; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1044166.8750; val_global_loss: 3984834.0000; val_optim_loss: 3984834.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9605; val_auprc_score: 0.9463; val_best_acc_score: 0.9142; val_best_f1_score: 0.9176; train_kl_reg_loss: 23193.7604; train_edge_recon_loss: 2665092.0833; train_gene_expr_recon_loss: 271414.8646; train_masked_gp_l1_reg_loss: 1458.1958; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1034816.6806; train_global_loss: 3995975.6111; train_optim_loss: 3995975.6111; val_kl_reg_loss: 22960.4004; val_edge_recon_loss: 2662282.0000; val_gene_expr_recon_loss: 271977.9688; val_masked_gp_l1_reg_loss: 1496.0681; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1040746.1875; val_global_loss: 3999462.7500; val_optim_loss: 3999462.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9652; val_auprc_score: 0.9519; val_best_acc_score: 0.9204; val_best_f1_score: 0.9233; train_kl_reg_loss: 22883.6148; train_edge_recon_loss: 2658326.0278; train_gene_expr_recon_loss: 265877.6337; train_masked_gp_l1_reg_loss: 1521.9505; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1031559.0208; train_global_loss: 3980168.1667; train_optim_loss: 3980168.1667; val_kl_reg_loss: 21709.7734; val_edge_recon_loss: 2665859.5000; val_gene_expr_recon_loss: 271222.3438; val_masked_gp_l1_reg_loss: 1552.9766; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1043021.1250; val_global_loss: 4003365.5000; val_optim_loss: 4003365.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9674; val_auprc_score: 0.9544; val_best_acc_score: 0.9201; val_best_f1_score: 0.9223; train_kl_reg_loss: 22485.5373; train_edge_recon_loss: 2660574.7500; train_gene_expr_recon_loss: 265556.0920; train_masked_gp_l1_reg_loss: 1577.4664; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1030059.9931; train_global_loss: 3980253.8056; train_optim_loss: 3980253.8056; val_kl_reg_loss: 22612.1699; val_edge_recon_loss: 2681133.7500; val_gene_expr_recon_loss: 262309.9688; val_masked_gp_l1_reg_loss: 1608.6448; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032385.1250; val_global_loss: 4000050.0000; val_optim_loss: 4000050.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9675; val_auprc_score: 0.9526; val_best_acc_score: 0.9208; val_best_f1_score: 0.9241; train_kl_reg_loss: 23125.9451; train_edge_recon_loss: 2653208.1667; train_gene_expr_recon_loss: 260700.1545; train_masked_gp_l1_reg_loss: 1634.7713; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1023981.2361; train_global_loss: 3962650.2222; train_optim_loss: 3962650.2222; val_kl_reg_loss: 22184.8730; val_edge_recon_loss: 2648421.2500; val_gene_expr_recon_loss: 263765.7812; val_masked_gp_l1_reg_loss: 1660.1964; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032537.5000; val_global_loss: 3968569.5000; val_optim_loss: 3968569.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9707; val_auprc_score: 0.9575; val_best_acc_score: 0.9252; val_best_f1_score: 0.9277; train_kl_reg_loss: 22572.2496; train_edge_recon_loss: 2650433.3333; train_gene_expr_recon_loss: 259836.3854; train_masked_gp_l1_reg_loss: 1681.3043; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1017033.4722; train_global_loss: 3951556.7500; train_optim_loss: 3951556.7500; val_kl_reg_loss: 22702.3711; val_edge_recon_loss: 2639868.0000; val_gene_expr_recon_loss: 262717.8125; val_masked_gp_l1_reg_loss: 1710.4487; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1031619.7500; val_global_loss: 3958618.2500; val_optim_loss: 3958618.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9695; val_auprc_score: 0.9564; val_best_acc_score: 0.9217; val_best_f1_score: 0.9252; train_kl_reg_loss: 23617.3815; train_edge_recon_loss: 2650245.8333; train_gene_expr_recon_loss: 257245.4670; train_masked_gp_l1_reg_loss: 1733.9129; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1021843.3472; train_global_loss: 3954685.9722; train_optim_loss: 3954685.9722; val_kl_reg_loss: 24047.9941; val_edge_recon_loss: 2662203.5000; val_gene_expr_recon_loss: 257446.9844; val_masked_gp_l1_reg_loss: 1759.5786; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027564.6875; val_global_loss: 3973022.7500; val_optim_loss: 3973022.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9684; val_auprc_score: 0.9564; val_best_acc_score: 0.9236; val_best_f1_score: 0.9262; train_kl_reg_loss: 24179.0265; train_edge_recon_loss: 2647934.5278; train_gene_expr_recon_loss: 252710.8212; train_masked_gp_l1_reg_loss: 1778.6298; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1013425.9028; train_global_loss: 3940028.9444; train_optim_loss: 3940028.9444; val_kl_reg_loss: 23479.0703; val_edge_recon_loss: 2672857.0000; val_gene_expr_recon_loss: 255871.0000; val_masked_gp_l1_reg_loss: 1799.3688; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1023677.1250; val_global_loss: 3977683.5000; val_optim_loss: 3977683.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9727; val_auprc_score: 0.9626; val_best_acc_score: 0.9291; val_best_f1_score: 0.9313; train_kl_reg_loss: 24022.9175; train_edge_recon_loss: 2638409.3611; train_gene_expr_recon_loss: 252886.3490; train_masked_gp_l1_reg_loss: 1819.5882; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1019494.3889; train_global_loss: 3936632.5833; train_optim_loss: 3936632.5833; val_kl_reg_loss: 23214.2891; val_edge_recon_loss: 2642306.0000; val_gene_expr_recon_loss: 254808.2031; val_masked_gp_l1_reg_loss: 1839.8291; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022313.0000; val_global_loss: 3944481.2500; val_optim_loss: 3944481.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9725; val_auprc_score: 0.9622; val_best_acc_score: 0.9298; val_best_f1_score: 0.9320; train_kl_reg_loss: 23810.7556; train_edge_recon_loss: 2642726.5000; train_gene_expr_recon_loss: 251166.2083; train_masked_gp_l1_reg_loss: 1860.8733; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1010223.2778; train_global_loss: 3929787.5556; train_optim_loss: 3929787.5556; val_kl_reg_loss: 23365.7617; val_edge_recon_loss: 2662227.5000; val_gene_expr_recon_loss: 252004.9062; val_masked_gp_l1_reg_loss: 1883.4824; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1019343.8750; val_global_loss: 3958825.5000; val_optim_loss: 3958825.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9744; val_auprc_score: 0.9636; val_best_acc_score: 0.9286; val_best_f1_score: 0.9310; train_kl_reg_loss: 23846.4607; train_edge_recon_loss: 2650813.0833; train_gene_expr_recon_loss: 248579.2101; train_masked_gp_l1_reg_loss: 1903.4339; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1015641.4653; train_global_loss: 3940783.6667; train_optim_loss: 3940783.6667; val_kl_reg_loss: 23055.8281; val_edge_recon_loss: 2651856.2500; val_gene_expr_recon_loss: 252995.3125; val_masked_gp_l1_reg_loss: 1926.0778; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1021716.1875; val_global_loss: 3951549.5000; val_optim_loss: 3951549.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9724; val_auprc_score: 0.9620; val_best_acc_score: 0.9299; val_best_f1_score: 0.9328; train_kl_reg_loss: 23462.3548; train_edge_recon_loss: 2652098.5000; train_gene_expr_recon_loss: 247799.7656; train_masked_gp_l1_reg_loss: 1945.7532; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011778.7986; train_global_loss: 3937085.1389; train_optim_loss: 3937085.1389; val_kl_reg_loss: 23133.1172; val_edge_recon_loss: 2648009.0000; val_gene_expr_recon_loss: 252162.8906; val_masked_gp_l1_reg_loss: 1967.0476; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1020378.3125; val_global_loss: 3945650.2500; val_optim_loss: 3945650.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9726; val_auprc_score: 0.9595; val_best_acc_score: 0.9326; val_best_f1_score: 0.9350; train_kl_reg_loss: 23427.4716; train_edge_recon_loss: 2652065.0833; train_gene_expr_recon_loss: 247372.7274; train_masked_gp_l1_reg_loss: 1982.9046; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011798.1250; train_global_loss: 3936646.2222; train_optim_loss: 3936646.2222; val_kl_reg_loss: 22798.8809; val_edge_recon_loss: 2642662.5000; val_gene_expr_recon_loss: 250073.9062; val_masked_gp_l1_reg_loss: 1998.2725; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1017311.8750; val_global_loss: 3934845.5000; val_optim_loss: 3934845.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9732; val_auprc_score: 0.9596; val_best_acc_score: 0.9317; val_best_f1_score: 0.9343; train_kl_reg_loss: 23533.7005; train_edge_recon_loss: 2639505.6667; train_gene_expr_recon_loss: 245781.6146; train_masked_gp_l1_reg_loss: 2012.8813; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1009334.5208; train_global_loss: 3920168.3889; train_optim_loss: 3920168.3889; val_kl_reg_loss: 23549.0879; val_edge_recon_loss: 2660928.7500; val_gene_expr_recon_loss: 247676.4375; val_masked_gp_l1_reg_loss: 2029.7031; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014872.6875; val_global_loss: 3949056.7500; val_optim_loss: 3949056.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9729; val_auprc_score: 0.9566; val_best_acc_score: 0.9324; val_best_f1_score: 0.9350; train_kl_reg_loss: 23916.0441; train_edge_recon_loss: 2640065.9167; train_gene_expr_recon_loss: 242296.1684; train_masked_gp_l1_reg_loss: 2043.2185; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1006387.3194; train_global_loss: 3914708.6389; train_optim_loss: 3914708.6389; val_kl_reg_loss: 23849.9375; val_edge_recon_loss: 2641309.7500; val_gene_expr_recon_loss: 247157.3594; val_masked_gp_l1_reg_loss: 2058.6326; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015025.3125; val_global_loss: 3929401.0000; val_optim_loss: 3929401.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9751; val_auprc_score: 0.9667; val_best_acc_score: 0.9294; val_best_f1_score: 0.9321; train_kl_reg_loss: 23835.6658; train_edge_recon_loss: 2641805.0278; train_gene_expr_recon_loss: 250226.4028; train_masked_gp_l1_reg_loss: 2076.6129; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014732.9514; train_global_loss: 3932676.6944; train_optim_loss: 3932676.6944; val_kl_reg_loss: 13089.2471; val_edge_recon_loss: 2652914.7500; val_gene_expr_recon_loss: 257051.2812; val_masked_gp_l1_reg_loss: 2092.4663; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1023432.2500; val_global_loss: 3948580.0000; val_optim_loss: 3948580.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9757; val_auprc_score: 0.9652; val_best_acc_score: 0.9344; val_best_f1_score: 0.9365; train_kl_reg_loss: 22442.3277; train_edge_recon_loss: 2638199.2778; train_gene_expr_recon_loss: 249949.2656; train_masked_gp_l1_reg_loss: 2099.0428; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1016234.1250; train_global_loss: 3928924.0000; train_optim_loss: 3928924.0000; val_kl_reg_loss: 12803.7441; val_edge_recon_loss: 2645503.5000; val_gene_expr_recon_loss: 256568.4062; val_masked_gp_l1_reg_loss: 2104.8691; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1023523.3750; val_global_loss: 3940504.0000; val_optim_loss: 3940504.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9748; val_auprc_score: 0.9643; val_best_acc_score: 0.9332; val_best_f1_score: 0.9355; train_kl_reg_loss: 21558.8453; train_edge_recon_loss: 2632312.2500; train_gene_expr_recon_loss: 247340.1007; train_masked_gp_l1_reg_loss: 2110.5285; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011643.1250; train_global_loss: 3914964.8333; train_optim_loss: 3914964.8333; val_kl_reg_loss: 13189.7656; val_edge_recon_loss: 2647734.5000; val_gene_expr_recon_loss: 253370.9062; val_masked_gp_l1_reg_loss: 2115.8748; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018877.8125; val_global_loss: 3935288.7500; val_optim_loss: 3935288.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9758; val_auprc_score: 0.9679; val_best_acc_score: 0.9306; val_best_f1_score: 0.9327; train_kl_reg_loss: 21721.5347; train_edge_recon_loss: 2635471.5556; train_gene_expr_recon_loss: 246178.9653; train_masked_gp_l1_reg_loss: 2120.4700; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1006746.8819; train_global_loss: 3912239.3056; train_optim_loss: 3912239.3056; val_kl_reg_loss: 13824.2188; val_edge_recon_loss: 2658506.0000; val_gene_expr_recon_loss: 246419.8750; val_masked_gp_l1_reg_loss: 2125.7427; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1012031.5000; val_global_loss: 3932907.2500; val_optim_loss: 3932907.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9755; val_auprc_score: 0.9643; val_best_acc_score: 0.9342; val_best_f1_score: 0.9365; train_kl_reg_loss: 21137.8791; train_edge_recon_loss: 2632963.4444; train_gene_expr_recon_loss: 244264.6944; train_masked_gp_l1_reg_loss: 2122.6294; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1001501.4167; train_global_loss: 3901989.9444; train_optim_loss: 3901989.9444; val_kl_reg_loss: 13100.6074; val_edge_recon_loss: 2642198.5000; val_gene_expr_recon_loss: 251511.6875; val_masked_gp_l1_reg_loss: 2118.9158; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1017247.7500; val_global_loss: 3926177.5000; val_optim_loss: 3926177.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9768; val_auprc_score: 0.9689; val_best_acc_score: 0.9347; val_best_f1_score: 0.9363; train_kl_reg_loss: 20457.5382; train_edge_recon_loss: 2627503.3611; train_gene_expr_recon_loss: 246296.0764; train_masked_gp_l1_reg_loss: 2117.3331; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1001053.4931; train_global_loss: 3897427.7222; train_optim_loss: 3897427.7222; val_kl_reg_loss: 13269.0801; val_edge_recon_loss: 2635322.2500; val_gene_expr_recon_loss: 248407.3906; val_masked_gp_l1_reg_loss: 2115.2275; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014114.1250; val_global_loss: 3913228.0000; val_optim_loss: 3913228.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9741; val_auprc_score: 0.9629; val_best_acc_score: 0.9321; val_best_f1_score: 0.9346; train_kl_reg_loss: 20604.2266; train_edge_recon_loss: 2635919.5833; train_gene_expr_recon_loss: 243349.9323; train_masked_gp_l1_reg_loss: 2114.4624; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 998642.5347; train_global_loss: 3900630.7778; train_optim_loss: 3900630.7778; val_kl_reg_loss: 13247.1074; val_edge_recon_loss: 2660648.7500; val_gene_expr_recon_loss: 249758.2656; val_masked_gp_l1_reg_loss: 2113.7319; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016858.5000; val_global_loss: 3942626.2500; val_optim_loss: 3942626.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9768; val_auprc_score: 0.9687; val_best_acc_score: 0.9336; val_best_f1_score: 0.9352; train_kl_reg_loss: 20234.7984; train_edge_recon_loss: 2625119.3056; train_gene_expr_recon_loss: 244579.2378; train_masked_gp_l1_reg_loss: 2113.3416; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005138.9514; train_global_loss: 3897185.6111; train_optim_loss: 3897185.6111; val_kl_reg_loss: 13095.6309; val_edge_recon_loss: 2651739.5000; val_gene_expr_recon_loss: 249264.5312; val_masked_gp_l1_reg_loss: 2112.8928; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015836.1250; val_global_loss: 3932049.0000; val_optim_loss: 3932049.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9796; val_auprc_score: 0.9720; val_best_acc_score: 0.9413; val_best_f1_score: 0.9423; train_kl_reg_loss: 20044.4993; train_edge_recon_loss: 2636508.5556; train_gene_expr_recon_loss: 244131.2378; train_masked_gp_l1_reg_loss: 2112.9097; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002562.9097; train_global_loss: 3905360.0556; train_optim_loss: 3905360.0556; val_kl_reg_loss: 13027.4014; val_edge_recon_loss: 2625233.7500; val_gene_expr_recon_loss: 248570.6875; val_masked_gp_l1_reg_loss: 2112.9592; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014104.0000; val_global_loss: 3903049.0000; val_optim_loss: 3903049.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9749; val_auprc_score: 0.9608; val_best_acc_score: 0.9337; val_best_f1_score: 0.9360; train_kl_reg_loss: 19974.7817; train_edge_recon_loss: 2629548.4167; train_gene_expr_recon_loss: 244438.6476; train_masked_gp_l1_reg_loss: 2113.1641; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1006798.6319; train_global_loss: 3902873.7222; train_optim_loss: 3902873.7222; val_kl_reg_loss: 13063.7773; val_edge_recon_loss: 2635368.5000; val_gene_expr_recon_loss: 249565.6719; val_masked_gp_l1_reg_loss: 2113.3108; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016164.8750; val_global_loss: 3916276.0000; val_optim_loss: 3916276.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9762; val_auprc_score: 0.9679; val_best_acc_score: 0.9324; val_best_f1_score: 0.9347; train_kl_reg_loss: 19731.7617; train_edge_recon_loss: 2628541.3333; train_gene_expr_recon_loss: 244524.1858; train_masked_gp_l1_reg_loss: 2113.5805; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002627.3125; train_global_loss: 3897538.2500; train_optim_loss: 3897538.2500; val_kl_reg_loss: 13077.6465; val_edge_recon_loss: 2651424.5000; val_gene_expr_recon_loss: 249245.0469; val_masked_gp_l1_reg_loss: 2113.7737; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015165.8750; val_global_loss: 3931027.0000; val_optim_loss: 3931027.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9746; val_auprc_score: 0.9627; val_best_acc_score: 0.9325; val_best_f1_score: 0.9349; train_kl_reg_loss: 19742.0994; train_edge_recon_loss: 2628292.8611; train_gene_expr_recon_loss: 244414.1215; train_masked_gp_l1_reg_loss: 2114.1093; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007888.0278; train_global_loss: 3902451.1944; train_optim_loss: 3902451.1944; val_kl_reg_loss: 13040.5469; val_edge_recon_loss: 2643720.2500; val_gene_expr_recon_loss: 249106.1094; val_masked_gp_l1_reg_loss: 2114.5300; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015259.5625; val_global_loss: 3923240.7500; val_optim_loss: 3923240.7500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9795; val_auprc_score: 0.9683; val_best_acc_score: 0.9390; val_best_f1_score: 0.9408; train_kl_reg_loss: 19681.8698; train_edge_recon_loss: 2626599.1944; train_gene_expr_recon_loss: 242619.2257; train_masked_gp_l1_reg_loss: 2114.9614; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1001317.2569; train_global_loss: 3892332.5000; train_optim_loss: 3892332.5000; val_kl_reg_loss: 13017.7617; val_edge_recon_loss: 2614703.0000; val_gene_expr_recon_loss: 249342.8125; val_masked_gp_l1_reg_loss: 2115.3953; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014958.7500; val_global_loss: 3894137.7500; val_optim_loss: 3894137.7500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9782; val_auprc_score: 0.9694; val_best_acc_score: 0.9379; val_best_f1_score: 0.9395; train_kl_reg_loss: 19597.7229; train_edge_recon_loss: 2637423.5556; train_gene_expr_recon_loss: 245831.3941; train_masked_gp_l1_reg_loss: 2115.6843; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1013517.7361; train_global_loss: 3918486.1389; train_optim_loss: 3918486.1389; val_kl_reg_loss: 13021.0498; val_edge_recon_loss: 2632609.0000; val_gene_expr_recon_loss: 248882.7969; val_masked_gp_l1_reg_loss: 2115.9580; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014016.6875; val_global_loss: 3910645.5000; val_optim_loss: 3910645.5000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9783; val_auprc_score: 0.9714; val_best_acc_score: 0.9349; val_best_f1_score: 0.9369; train_kl_reg_loss: 19563.6552; train_edge_recon_loss: 2622791.2500; train_gene_expr_recon_loss: 244433.5608; train_masked_gp_l1_reg_loss: 2116.3680; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003267.3264; train_global_loss: 3892172.1667; train_optim_loss: 3892172.1667; val_kl_reg_loss: 12923.3213; val_edge_recon_loss: 2642012.2500; val_gene_expr_recon_loss: 249074.5781; val_masked_gp_l1_reg_loss: 2116.8982; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014374.8750; val_global_loss: 3920502.0000; val_optim_loss: 3920502.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9786; val_auprc_score: 0.9717; val_best_acc_score: 0.9367; val_best_f1_score: 0.9380; train_kl_reg_loss: 19294.4965; train_edge_recon_loss: 2629372.4444; train_gene_expr_recon_loss: 244888.3889; train_masked_gp_l1_reg_loss: 2117.5669; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005671.1250; train_global_loss: 3901344.0556; train_optim_loss: 3901344.0556; val_kl_reg_loss: 13021.8604; val_edge_recon_loss: 2638871.2500; val_gene_expr_recon_loss: 248935.1250; val_masked_gp_l1_reg_loss: 2118.0830; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014636.5625; val_global_loss: 3917582.5000; val_optim_loss: 3917582.5000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9798; val_auprc_score: 0.9737; val_best_acc_score: 0.9388; val_best_f1_score: 0.9401; train_kl_reg_loss: 19478.5788; train_edge_recon_loss: 2626817.1389; train_gene_expr_recon_loss: 243448.0660; train_masked_gp_l1_reg_loss: 2118.4347; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005921.4167; train_global_loss: 3897783.6667; train_optim_loss: 3897783.6667; val_kl_reg_loss: 13182.4961; val_edge_recon_loss: 2633076.0000; val_gene_expr_recon_loss: 248540.7031; val_masked_gp_l1_reg_loss: 2118.7903; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014152.2500; val_global_loss: 3911070.2500; val_optim_loss: 3911070.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9779; val_auprc_score: 0.9699; val_best_acc_score: 0.9371; val_best_f1_score: 0.9391; train_kl_reg_loss: 19523.6352; train_edge_recon_loss: 2621098.4722; train_gene_expr_recon_loss: 244508.7396; train_masked_gp_l1_reg_loss: 2118.4566; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003900.2847; train_global_loss: 3891149.6667; train_optim_loss: 3891149.6667; val_kl_reg_loss: 13209.4170; val_edge_recon_loss: 2636717.7500; val_gene_expr_recon_loss: 248783.5938; val_masked_gp_l1_reg_loss: 2118.1616; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015776.4375; val_global_loss: 3916605.5000; val_optim_loss: 3916605.5000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9796; val_auprc_score: 0.9746; val_best_acc_score: 0.9365; val_best_f1_score: 0.9385; train_kl_reg_loss: 19396.4141; train_edge_recon_loss: 2621282.9167; train_gene_expr_recon_loss: 243582.4601; train_masked_gp_l1_reg_loss: 2118.1068; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1000740.6181; train_global_loss: 3887120.5000; train_optim_loss: 3887120.5000; val_kl_reg_loss: 13182.2012; val_edge_recon_loss: 2636774.5000; val_gene_expr_recon_loss: 248616.6250; val_masked_gp_l1_reg_loss: 2118.0093; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013624.6250; val_global_loss: 3914316.0000; val_optim_loss: 3914316.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9763; val_auprc_score: 0.9668; val_best_acc_score: 0.9341; val_best_f1_score: 0.9359; train_kl_reg_loss: 19489.8824; train_edge_recon_loss: 2622292.1111; train_gene_expr_recon_loss: 243294.2865; train_masked_gp_l1_reg_loss: 2117.9529; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002527.7431; train_global_loss: 3889722.0556; train_optim_loss: 3889722.0556; val_kl_reg_loss: 13231.6455; val_edge_recon_loss: 2656607.0000; val_gene_expr_recon_loss: 248508.2188; val_masked_gp_l1_reg_loss: 2117.9026; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014127.8750; val_global_loss: 3934593.0000; val_optim_loss: 3934593.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9782; val_auprc_score: 0.9708; val_best_acc_score: 0.9386; val_best_f1_score: 0.9399; train_kl_reg_loss: 19437.9852; train_edge_recon_loss: 2623698.0833; train_gene_expr_recon_loss: 244122.6753; train_masked_gp_l1_reg_loss: 2117.9025; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003710.2361; train_global_loss: 3893086.9444; train_optim_loss: 3893086.9444; val_kl_reg_loss: 13149.0312; val_edge_recon_loss: 2642072.7500; val_gene_expr_recon_loss: 248566.0469; val_masked_gp_l1_reg_loss: 2117.9009; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013881.5625; val_global_loss: 3919787.2500; val_optim_loss: 3919787.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 47 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9755
Val AUPRC score: 0.9670
Val best accuracy score: 0.9316
Val best F1 score: 0.9340
Val gene expr MSE score: 0.5968
Val chrom access MSE score: 0.0897
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
