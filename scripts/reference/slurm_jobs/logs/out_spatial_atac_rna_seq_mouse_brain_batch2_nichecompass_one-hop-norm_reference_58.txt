[True]
Run timestamp: 07092023_170854_58.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_58']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 799 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3515, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6353; val_auprc_score: 0.6206; val_best_acc_score: 0.5137; val_best_f1_score: 0.6719; train_kl_reg_loss: 84242.8828; train_edge_recon_loss: 3547943.8106; train_gene_expr_recon_loss: 20680010.4242; train_masked_gp_l1_reg_loss: 145247.0531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6038054.1591; train_chrom_access_recon_loss: 885488.7945; train_global_loss: 31380987.0303; train_optim_loss: 31380987.0303; val_kl_reg_loss: 128580.3887; val_edge_recon_loss: 4064604.1875; val_gene_expr_recon_loss: 18793445.0000; val_masked_gp_l1_reg_loss: 125037.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2589277.7500; val_chrom_access_recon_loss: 825343.8828; val_global_loss: 26526289.7500; val_optim_loss: 26526289.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6728; val_auprc_score: 0.6579; val_best_acc_score: 0.6075; val_best_f1_score: 0.6912; train_kl_reg_loss: 137755.7013; train_edge_recon_loss: 3543603.4545; train_gene_expr_recon_loss: 18770328.5152; train_masked_gp_l1_reg_loss: 115881.1239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1110267.7808; train_chrom_access_recon_loss: 837337.0587; train_global_loss: 24515173.8485; train_optim_loss: 24515173.8485; val_kl_reg_loss: 120472.9766; val_edge_recon_loss: 4057503.4688; val_gene_expr_recon_loss: 18506615.2500; val_masked_gp_l1_reg_loss: 112544.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 403652.5312; val_chrom_access_recon_loss: 819789.0859; val_global_loss: 24020577.0000; val_optim_loss: 24020577.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7468; val_auprc_score: 0.7282; val_best_acc_score: 0.6634; val_best_f1_score: 0.7130; train_kl_reg_loss: 122727.5962; train_edge_recon_loss: 3533389.5303; train_gene_expr_recon_loss: 18574724.8788; train_masked_gp_l1_reg_loss: 113316.0047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 271917.8615; train_chrom_access_recon_loss: 830453.8665; train_global_loss: 23446529.6667; train_optim_loss: 23446529.6667; val_kl_reg_loss: 107664.1592; val_edge_recon_loss: 4031879.9375; val_gene_expr_recon_loss: 18385581.2500; val_masked_gp_l1_reg_loss: 114980.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 197154.8438; val_chrom_access_recon_loss: 817125.3203; val_global_loss: 23654384.7500; val_optim_loss: 23654384.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7692; val_auprc_score: 0.7514; val_best_acc_score: 0.7028; val_best_f1_score: 0.7302; train_kl_reg_loss: 103709.2746; train_edge_recon_loss: 3510678.9091; train_gene_expr_recon_loss: 18437485.8182; train_masked_gp_l1_reg_loss: 117486.3754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170069.4858; train_chrom_access_recon_loss: 825568.4356; train_global_loss: 23164998.4242; train_optim_loss: 23164998.4242; val_kl_reg_loss: 97561.2197; val_edge_recon_loss: 3807409.2812; val_gene_expr_recon_loss: 18106622.8750; val_masked_gp_l1_reg_loss: 120766.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149317.7969; val_chrom_access_recon_loss: 805872.1641; val_global_loss: 23087549.2500; val_optim_loss: 23087549.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8496; val_auprc_score: 0.8315; val_best_acc_score: 0.7708; val_best_f1_score: 0.7892; train_kl_reg_loss: 84980.7431; train_edge_recon_loss: 3289407.9886; train_gene_expr_recon_loss: 18349628.1212; train_masked_gp_l1_reg_loss: 123424.9522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136307.0110; train_chrom_access_recon_loss: 821946.3011; train_global_loss: 22805695.1515; train_optim_loss: 22805695.1515; val_kl_reg_loss: 98023.9482; val_edge_recon_loss: 3121786.6875; val_gene_expr_recon_loss: 18123850.2500; val_masked_gp_l1_reg_loss: 126840.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125284.9609; val_chrom_access_recon_loss: 806503.4922; val_global_loss: 22402288.5000; val_optim_loss: 22402288.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8335; val_auprc_score: 0.8067; val_best_acc_score: 0.7574; val_best_f1_score: 0.7782; train_kl_reg_loss: 109263.9936; train_edge_recon_loss: 3053053.3826; train_gene_expr_recon_loss: 18304983.3333; train_masked_gp_l1_reg_loss: 130604.6634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118157.2710; train_chrom_access_recon_loss: 817484.3778; train_global_loss: 22533547.0000; train_optim_loss: 22533547.0000; val_kl_reg_loss: 107877.9502; val_edge_recon_loss: 3113379.9062; val_gene_expr_recon_loss: 18148761.5000; val_masked_gp_l1_reg_loss: 134510.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113426.6328; val_chrom_access_recon_loss: 795132.2734; val_global_loss: 22413088.0000; val_optim_loss: 22413088.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8966; val_auprc_score: 0.8647; val_best_acc_score: 0.8318; val_best_f1_score: 0.8437; train_kl_reg_loss: 118621.9622; train_edge_recon_loss: 2937952.2652; train_gene_expr_recon_loss: 18200292.0000; train_masked_gp_l1_reg_loss: 135955.8326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107525.3597; train_chrom_access_recon_loss: 813039.9669; train_global_loss: 22313387.6061; train_optim_loss: 22313387.6061; val_kl_reg_loss: 126015.1279; val_edge_recon_loss: 2874702.4375; val_gene_expr_recon_loss: 18070640.2500; val_masked_gp_l1_reg_loss: 137968.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104851.4141; val_chrom_access_recon_loss: 802214.1797; val_global_loss: 22116392.0000; val_optim_loss: 22116392.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8986; val_auprc_score: 0.8694; val_best_acc_score: 0.8334; val_best_f1_score: 0.8474; train_kl_reg_loss: 128091.3845; train_edge_recon_loss: 2872330.1136; train_gene_expr_recon_loss: 18085651.1818; train_masked_gp_l1_reg_loss: 140130.3916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104557.8614; train_chrom_access_recon_loss: 809208.4962; train_global_loss: 22139969.3939; train_optim_loss: 22139969.3939; val_kl_reg_loss: 131948.8906; val_edge_recon_loss: 2890543.9688; val_gene_expr_recon_loss: 17909529.0000; val_masked_gp_l1_reg_loss: 142131.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104844.5547; val_chrom_access_recon_loss: 799994.3516; val_global_loss: 21978992.7500; val_optim_loss: 21978992.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9071; val_auprc_score: 0.8809; val_best_acc_score: 0.8415; val_best_f1_score: 0.8548; train_kl_reg_loss: 129709.2262; train_edge_recon_loss: 2855140.1136; train_gene_expr_recon_loss: 17957448.2727; train_masked_gp_l1_reg_loss: 143783.7401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103867.8629; train_chrom_access_recon_loss: 805415.1458; train_global_loss: 21995364.3939; train_optim_loss: 21995364.3939; val_kl_reg_loss: 126930.7617; val_edge_recon_loss: 2848918.9375; val_gene_expr_recon_loss: 17704550.2500; val_masked_gp_l1_reg_loss: 145521.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102605.3594; val_chrom_access_recon_loss: 794596.0391; val_global_loss: 21723123.7500; val_optim_loss: 21723123.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9081; val_auprc_score: 0.8757; val_best_acc_score: 0.8463; val_best_f1_score: 0.8573; train_kl_reg_loss: 128682.3602; train_edge_recon_loss: 2854440.9318; train_gene_expr_recon_loss: 17861303.6061; train_masked_gp_l1_reg_loss: 147031.2393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101156.1357; train_chrom_access_recon_loss: 802468.7188; train_global_loss: 21895083.0000; train_optim_loss: 21895083.0000; val_kl_reg_loss: 126449.8506; val_edge_recon_loss: 2846839.5312; val_gene_expr_recon_loss: 17626993.7500; val_masked_gp_l1_reg_loss: 148312.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99164.9141; val_chrom_access_recon_loss: 783987.0625; val_global_loss: 21631746.0000; val_optim_loss: 21631746.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9046; val_auprc_score: 0.8759; val_best_acc_score: 0.8356; val_best_f1_score: 0.8488; train_kl_reg_loss: 127852.4090; train_edge_recon_loss: 2818802.6591; train_gene_expr_recon_loss: 17778566.0000; train_masked_gp_l1_reg_loss: 149362.2280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98252.6076; train_chrom_access_recon_loss: 799238.1098; train_global_loss: 21772073.9697; train_optim_loss: 21772073.9697; val_kl_reg_loss: 121014.2432; val_edge_recon_loss: 2884859.2500; val_gene_expr_recon_loss: 17695535.7500; val_masked_gp_l1_reg_loss: 150718.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97657.0156; val_chrom_access_recon_loss: 786314.9531; val_global_loss: 21736100.2500; val_optim_loss: 21736100.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9134; val_auprc_score: 0.8920; val_best_acc_score: 0.8452; val_best_f1_score: 0.8556; train_kl_reg_loss: 123881.9278; train_edge_recon_loss: 2832176.8295; train_gene_expr_recon_loss: 17711463.1970; train_masked_gp_l1_reg_loss: 151521.4946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96941.9705; train_chrom_access_recon_loss: 796015.1591; train_global_loss: 21712000.6970; train_optim_loss: 21712000.6970; val_kl_reg_loss: 125820.2109; val_edge_recon_loss: 2863234.1250; val_gene_expr_recon_loss: 17518473.5000; val_masked_gp_l1_reg_loss: 152576.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96074.3672; val_chrom_access_recon_loss: 784752.7344; val_global_loss: 21540930.5000; val_optim_loss: 21540930.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9158; val_auprc_score: 0.8929; val_best_acc_score: 0.8544; val_best_f1_score: 0.8625; train_kl_reg_loss: 123014.4366; train_edge_recon_loss: 2831359.9735; train_gene_expr_recon_loss: 17650066.2727; train_masked_gp_l1_reg_loss: 152954.4335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96163.3467; train_chrom_access_recon_loss: 793716.9867; train_global_loss: 21647275.6364; train_optim_loss: 21647275.6364; val_kl_reg_loss: 120767.0654; val_edge_recon_loss: 2860217.4062; val_gene_expr_recon_loss: 17469369.2500; val_masked_gp_l1_reg_loss: 153839.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97235.6641; val_chrom_access_recon_loss: 777285.0312; val_global_loss: 21478714.7500; val_optim_loss: 21478714.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9229; val_auprc_score: 0.8997; val_best_acc_score: 0.8598; val_best_f1_score: 0.8666; train_kl_reg_loss: 120082.7957; train_edge_recon_loss: 2809560.6439; train_gene_expr_recon_loss: 17584295.3333; train_masked_gp_l1_reg_loss: 154513.6915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97103.4773; train_chrom_access_recon_loss: 790775.5483; train_global_loss: 21556331.6970; train_optim_loss: 21556331.6970; val_kl_reg_loss: 121512.7871; val_edge_recon_loss: 2831920.6562; val_gene_expr_recon_loss: 17375455.7500; val_masked_gp_l1_reg_loss: 155274.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97998.4766; val_chrom_access_recon_loss: 779473.7812; val_global_loss: 21361635.0000; val_optim_loss: 21361635.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9199; val_auprc_score: 0.8947; val_best_acc_score: 0.8608; val_best_f1_score: 0.8693; train_kl_reg_loss: 121581.3865; train_edge_recon_loss: 2794294.9697; train_gene_expr_recon_loss: 17511738.3182; train_masked_gp_l1_reg_loss: 155686.5824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98391.1624; train_chrom_access_recon_loss: 788542.4290; train_global_loss: 21470234.8788; train_optim_loss: 21470234.8788; val_kl_reg_loss: 119254.7412; val_edge_recon_loss: 2844183.8750; val_gene_expr_recon_loss: 17541728.6250; val_masked_gp_l1_reg_loss: 156083.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99000.6484; val_chrom_access_recon_loss: 789076.8203; val_global_loss: 21549327.5000; val_optim_loss: 21549327.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9248; val_auprc_score: 0.9012; val_best_acc_score: 0.8684; val_best_f1_score: 0.8755; train_kl_reg_loss: 118076.5289; train_edge_recon_loss: 2806553.4470; train_gene_expr_recon_loss: 17469174.8939; train_masked_gp_l1_reg_loss: 156839.3670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98479.0271; train_chrom_access_recon_loss: 786234.8816; train_global_loss: 21435358.0909; train_optim_loss: 21435358.0909; val_kl_reg_loss: 116736.5342; val_edge_recon_loss: 2804320.4688; val_gene_expr_recon_loss: 17525443.1250; val_masked_gp_l1_reg_loss: 157313.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98717.7969; val_chrom_access_recon_loss: 778754.1172; val_global_loss: 21481286.7500; val_optim_loss: 21481286.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9224; val_auprc_score: 0.8990; val_best_acc_score: 0.8659; val_best_f1_score: 0.8730; train_kl_reg_loss: 119056.3259; train_edge_recon_loss: 2778744.4205; train_gene_expr_recon_loss: 17396278.0909; train_masked_gp_l1_reg_loss: 157948.4541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98000.3812; train_chrom_access_recon_loss: 782300.6023; train_global_loss: 21332328.3636; train_optim_loss: 21332328.3636; val_kl_reg_loss: 119049.3867; val_edge_recon_loss: 2832537.2188; val_gene_expr_recon_loss: 17240475.6250; val_masked_gp_l1_reg_loss: 158609.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97641.6016; val_chrom_access_recon_loss: 769486.7969; val_global_loss: 21217801.0000; val_optim_loss: 21217801.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9323; val_auprc_score: 0.9100; val_best_acc_score: 0.8743; val_best_f1_score: 0.8808; train_kl_reg_loss: 115221.0607; train_edge_recon_loss: 2791938.1477; train_gene_expr_recon_loss: 17354196.8636; train_masked_gp_l1_reg_loss: 159234.5194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97425.6056; train_chrom_access_recon_loss: 781134.4460; train_global_loss: 21299150.5152; train_optim_loss: 21299150.5152; val_kl_reg_loss: 114408.2617; val_edge_recon_loss: 2804267.0000; val_gene_expr_recon_loss: 17187950.5000; val_masked_gp_l1_reg_loss: 159946.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97058.3203; val_chrom_access_recon_loss: 768814.2969; val_global_loss: 21132443.5000; val_optim_loss: 21132443.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9338; val_auprc_score: 0.9116; val_best_acc_score: 0.8786; val_best_f1_score: 0.8857; train_kl_reg_loss: 115798.4672; train_edge_recon_loss: 2785506.9962; train_gene_expr_recon_loss: 17315697.2121; train_masked_gp_l1_reg_loss: 160500.5677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96651.2359; train_chrom_access_recon_loss: 779586.9100; train_global_loss: 21253741.1515; train_optim_loss: 21253741.1515; val_kl_reg_loss: 115311.4873; val_edge_recon_loss: 2797826.1250; val_gene_expr_recon_loss: 17123389.5000; val_masked_gp_l1_reg_loss: 160982.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96132.9219; val_chrom_access_recon_loss: 765088.2734; val_global_loss: 21058729.7500; val_optim_loss: 21058729.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9319; val_auprc_score: 0.9120; val_best_acc_score: 0.8748; val_best_f1_score: 0.8808; train_kl_reg_loss: 116116.8301; train_edge_recon_loss: 2765071.3788; train_gene_expr_recon_loss: 17272066.5758; train_masked_gp_l1_reg_loss: 161385.4830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95942.9290; train_chrom_access_recon_loss: 777626.2756; train_global_loss: 21188209.3333; train_optim_loss: 21188209.3333; val_kl_reg_loss: 115427.6621; val_edge_recon_loss: 2830920.1250; val_gene_expr_recon_loss: 17262261.2500; val_masked_gp_l1_reg_loss: 162092.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95931.2578; val_chrom_access_recon_loss: 768639.1328; val_global_loss: 21235272.2500; val_optim_loss: 21235272.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9304; val_auprc_score: 0.8987; val_best_acc_score: 0.8802; val_best_f1_score: 0.8870; train_kl_reg_loss: 116428.6987; train_edge_recon_loss: 2768601.1288; train_gene_expr_recon_loss: 17234036.5758; train_masked_gp_l1_reg_loss: 162480.7571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96062.8544; train_chrom_access_recon_loss: 776741.7633; train_global_loss: 21154351.8182; train_optim_loss: 21154351.8182; val_kl_reg_loss: 117365.7822; val_edge_recon_loss: 2799576.1875; val_gene_expr_recon_loss: 16970325.8750; val_masked_gp_l1_reg_loss: 163002.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96050.9375; val_chrom_access_recon_loss: 758452.2109; val_global_loss: 20904772.2500; val_optim_loss: 20904772.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9384; val_auprc_score: 0.9192; val_best_acc_score: 0.8874; val_best_f1_score: 0.8929; train_kl_reg_loss: 114802.0374; train_edge_recon_loss: 2761413.1894; train_gene_expr_recon_loss: 17190832.1364; train_masked_gp_l1_reg_loss: 163400.9598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95554.4755; train_chrom_access_recon_loss: 774222.1420; train_global_loss: 21100224.8485; train_optim_loss: 21100224.8485; val_kl_reg_loss: 113545.5508; val_edge_recon_loss: 2800398.7812; val_gene_expr_recon_loss: 17220780.0000; val_masked_gp_l1_reg_loss: 163707.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95005.6875; val_chrom_access_recon_loss: 769968.4609; val_global_loss: 21163406.5000; val_optim_loss: 21163406.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9422; val_auprc_score: 0.9283; val_best_acc_score: 0.8845; val_best_f1_score: 0.8910; train_kl_reg_loss: 114973.9324; train_edge_recon_loss: 2764447.6061; train_gene_expr_recon_loss: 17148345.4394; train_masked_gp_l1_reg_loss: 164368.9221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95413.5662; train_chrom_access_recon_loss: 772397.6922; train_global_loss: 21059947.0303; train_optim_loss: 21059947.0303; val_kl_reg_loss: 111192.1436; val_edge_recon_loss: 2765986.8750; val_gene_expr_recon_loss: 17028953.2500; val_masked_gp_l1_reg_loss: 164992.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95995.0547; val_chrom_access_recon_loss: 753147.9609; val_global_loss: 20920268.5000; val_optim_loss: 20920268.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9525; val_auprc_score: 0.9420; val_best_acc_score: 0.8949; val_best_f1_score: 0.8993; train_kl_reg_loss: 113843.5438; train_edge_recon_loss: 2748527.6402; train_gene_expr_recon_loss: 17113093.2273; train_masked_gp_l1_reg_loss: 165379.2995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95749.8917; train_chrom_access_recon_loss: 770870.5568; train_global_loss: 21007464.3333; train_optim_loss: 21007464.3333; val_kl_reg_loss: 113793.3555; val_edge_recon_loss: 2759446.7500; val_gene_expr_recon_loss: 17023200.7500; val_masked_gp_l1_reg_loss: 165976.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95904.7734; val_chrom_access_recon_loss: 767591.4609; val_global_loss: 20925912.2500; val_optim_loss: 20925912.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9516; val_auprc_score: 0.9392; val_best_acc_score: 0.8987; val_best_f1_score: 0.9028; train_kl_reg_loss: 114308.9648; train_edge_recon_loss: 2752890.2348; train_gene_expr_recon_loss: 17076295.0758; train_masked_gp_l1_reg_loss: 166367.1406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95922.5309; train_chrom_access_recon_loss: 768917.2595; train_global_loss: 20974701.2727; train_optim_loss: 20974701.2727; val_kl_reg_loss: 114978.0176; val_edge_recon_loss: 2756042.2812; val_gene_expr_recon_loss: 17114211.8750; val_masked_gp_l1_reg_loss: 167069.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96616.8359; val_chrom_access_recon_loss: 759868.1641; val_global_loss: 21008786.0000; val_optim_loss: 21008786.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9440; val_auprc_score: 0.9230; val_best_acc_score: 0.8890; val_best_f1_score: 0.8932; train_kl_reg_loss: 129828.9235; train_edge_recon_loss: 2795779.4356; train_gene_expr_recon_loss: 16819801.5303; train_masked_gp_l1_reg_loss: 163068.0649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70034.2768; train_chrom_access_recon_loss: 773773.7197; train_global_loss: 20752286.1212; train_optim_loss: 20752286.1212; val_kl_reg_loss: 89703.6631; val_edge_recon_loss: 2819826.7188; val_gene_expr_recon_loss: 16591890.7500; val_masked_gp_l1_reg_loss: 161078.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61395.5586; val_chrom_access_recon_loss: 750749.3594; val_global_loss: 20474644.2500; val_optim_loss: 20474644.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9393; val_auprc_score: 0.9191; val_best_acc_score: 0.8880; val_best_f1_score: 0.8938; train_kl_reg_loss: 136154.2910; train_edge_recon_loss: 2800022.4659; train_gene_expr_recon_loss: 16678936.4848; train_masked_gp_l1_reg_loss: 160563.8809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59511.7481; train_chrom_access_recon_loss: 752805.4830; train_global_loss: 20587994.1818; train_optim_loss: 20587994.1818; val_kl_reg_loss: 91903.5732; val_edge_recon_loss: 2843286.5938; val_gene_expr_recon_loss: 16700342.3750; val_masked_gp_l1_reg_loss: 160242.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58364.4648; val_chrom_access_recon_loss: 746648.4922; val_global_loss: 20600787.0000; val_optim_loss: 20600787.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9484; val_auprc_score: 0.9296; val_best_acc_score: 0.8936; val_best_f1_score: 0.8977; train_kl_reg_loss: 136707.6091; train_edge_recon_loss: 2786272.4432; train_gene_expr_recon_loss: 16653960.0152; train_masked_gp_l1_reg_loss: 160053.3014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57700.8230; train_chrom_access_recon_loss: 750078.0483; train_global_loss: 20544772.3636; train_optim_loss: 20544772.3636; val_kl_reg_loss: 92599.2256; val_edge_recon_loss: 2827336.5938; val_gene_expr_recon_loss: 16644144.3750; val_masked_gp_l1_reg_loss: 159898.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57133.6172; val_chrom_access_recon_loss: 741284.0156; val_global_loss: 20522396.7500; val_optim_loss: 20522396.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9498; val_auprc_score: 0.9339; val_best_acc_score: 0.8893; val_best_f1_score: 0.8952; train_kl_reg_loss: 135628.9543; train_edge_recon_loss: 2782203.8939; train_gene_expr_recon_loss: 16639707.6818; train_masked_gp_l1_reg_loss: 159827.8359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56916.0188; train_chrom_access_recon_loss: 749930.1534; train_global_loss: 20524214.5152; train_optim_loss: 20524214.5152; val_kl_reg_loss: 91379.4414; val_edge_recon_loss: 2799166.0312; val_gene_expr_recon_loss: 16596727.3750; val_masked_gp_l1_reg_loss: 159747.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56741.5977; val_chrom_access_recon_loss: 738436.3906; val_global_loss: 20442199.2500; val_optim_loss: 20442199.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9400; val_auprc_score: 0.9143; val_best_acc_score: 0.8904; val_best_f1_score: 0.8970; train_kl_reg_loss: 133526.9326; train_edge_recon_loss: 2780059.4053; train_gene_expr_recon_loss: 16647430.4242; train_masked_gp_l1_reg_loss: 159696.9389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56593.8730; train_chrom_access_recon_loss: 749430.9631; train_global_loss: 20526738.3939; train_optim_loss: 20526738.3939; val_kl_reg_loss: 93342.6621; val_edge_recon_loss: 2826921.0312; val_gene_expr_recon_loss: 16481296.6250; val_masked_gp_l1_reg_loss: 159672.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56704.2539; val_chrom_access_recon_loss: 732285.4844; val_global_loss: 20350222.2500; val_optim_loss: 20350222.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9441; val_auprc_score: 0.9198; val_best_acc_score: 0.8904; val_best_f1_score: 0.8955; train_kl_reg_loss: 132709.4373; train_edge_recon_loss: 2775682.9659; train_gene_expr_recon_loss: 16625737.2121; train_masked_gp_l1_reg_loss: 159652.1622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56661.5488; train_chrom_access_recon_loss: 749197.6998; train_global_loss: 20499641.0909; train_optim_loss: 20499641.0909; val_kl_reg_loss: 92360.4746; val_edge_recon_loss: 2815188.1250; val_gene_expr_recon_loss: 16541290.6250; val_masked_gp_l1_reg_loss: 159605.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56600.7930; val_chrom_access_recon_loss: 741405.5938; val_global_loss: 20406450.7500; val_optim_loss: 20406450.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9500; val_auprc_score: 0.9390; val_best_acc_score: 0.8923; val_best_f1_score: 0.8970; train_kl_reg_loss: 131838.4026; train_edge_recon_loss: 2768692.3826; train_gene_expr_recon_loss: 16611373.4091; train_masked_gp_l1_reg_loss: 159593.2796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56630.6990; train_chrom_access_recon_loss: 749531.3134; train_global_loss: 20477659.5455; train_optim_loss: 20477659.5455; val_kl_reg_loss: 93981.8760; val_edge_recon_loss: 2798241.3438; val_gene_expr_recon_loss: 16532484.1250; val_masked_gp_l1_reg_loss: 159572.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56634.7227; val_chrom_access_recon_loss: 732499.4844; val_global_loss: 20373412.7500; val_optim_loss: 20373412.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9456; val_auprc_score: 0.9291; val_best_acc_score: 0.8904; val_best_f1_score: 0.8952; train_kl_reg_loss: 130509.6887; train_edge_recon_loss: 2770211.8182; train_gene_expr_recon_loss: 16601980.4545; train_masked_gp_l1_reg_loss: 159533.1908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56659.4416; train_chrom_access_recon_loss: 749424.5473; train_global_loss: 20468319.0606; train_optim_loss: 20468319.0606; val_kl_reg_loss: 94141.6426; val_edge_recon_loss: 2810547.5625; val_gene_expr_recon_loss: 16591374.2500; val_masked_gp_l1_reg_loss: 159527.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56748.5508; val_chrom_access_recon_loss: 752300.0781; val_global_loss: 20464639.7500; val_optim_loss: 20464639.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9526; val_auprc_score: 0.9386; val_best_acc_score: 0.8982; val_best_f1_score: 0.9030; train_kl_reg_loss: 128856.6027; train_edge_recon_loss: 2764419.2348; train_gene_expr_recon_loss: 16598122.9091; train_masked_gp_l1_reg_loss: 159527.0251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56837.3796; train_chrom_access_recon_loss: 749177.6629; train_global_loss: 20456940.9394; train_optim_loss: 20456940.9394; val_kl_reg_loss: 94174.5391; val_edge_recon_loss: 2781521.5625; val_gene_expr_recon_loss: 16548302.6250; val_masked_gp_l1_reg_loss: 159526.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56993.9766; val_chrom_access_recon_loss: 744507.5156; val_global_loss: 20385026.5000; val_optim_loss: 20385026.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9475; val_auprc_score: 0.9333; val_best_acc_score: 0.8896; val_best_f1_score: 0.8922; train_kl_reg_loss: 128789.5355; train_edge_recon_loss: 2762358.7386; train_gene_expr_recon_loss: 16576323.3182; train_masked_gp_l1_reg_loss: 159354.0159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55114.8307; train_chrom_access_recon_loss: 747904.9725; train_global_loss: 20429845.2727; train_optim_loss: 20429845.2727; val_kl_reg_loss: 94264.5654; val_edge_recon_loss: 2834043.6250; val_gene_expr_recon_loss: 16385261.5000; val_masked_gp_l1_reg_loss: 159269.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54761.2695; val_chrom_access_recon_loss: 732509.4297; val_global_loss: 20260111.2500; val_optim_loss: 20260111.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9519; val_auprc_score: 0.9351; val_best_acc_score: 0.8990; val_best_f1_score: 0.9030; train_kl_reg_loss: 128881.7348; train_edge_recon_loss: 2758689.8333; train_gene_expr_recon_loss: 16593929.0909; train_masked_gp_l1_reg_loss: 159235.2464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54738.2771; train_chrom_access_recon_loss: 748508.6591; train_global_loss: 20443982.7576; train_optim_loss: 20443982.7576; val_kl_reg_loss: 95575.2617; val_edge_recon_loss: 2789393.4062; val_gene_expr_recon_loss: 16618196.2500; val_masked_gp_l1_reg_loss: 159206.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54725.1172; val_chrom_access_recon_loss: 737772.7500; val_global_loss: 20454870.0000; val_optim_loss: 20454870.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9468; val_auprc_score: 0.9277; val_best_acc_score: 0.8960; val_best_f1_score: 0.9009; train_kl_reg_loss: 128667.3041; train_edge_recon_loss: 2774021.4735; train_gene_expr_recon_loss: 16587852.1061; train_masked_gp_l1_reg_loss: 159194.5578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54716.6196; train_chrom_access_recon_loss: 748350.4413; train_global_loss: 20452802.3030; train_optim_loss: 20452802.3030; val_kl_reg_loss: 95636.4141; val_edge_recon_loss: 2792737.1562; val_gene_expr_recon_loss: 16612782.8750; val_masked_gp_l1_reg_loss: 159178.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54707.1875; val_chrom_access_recon_loss: 737566.2344; val_global_loss: 20452609.0000; val_optim_loss: 20452609.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9475; val_auprc_score: 0.9286; val_best_acc_score: 0.8923; val_best_f1_score: 0.8967; train_kl_reg_loss: 128750.7932; train_edge_recon_loss: 2754120.9015; train_gene_expr_recon_loss: 16610397.2879; train_masked_gp_l1_reg_loss: 159167.9782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54707.1017; train_chrom_access_recon_loss: 749160.2481; train_global_loss: 20456304.4545; train_optim_loss: 20456304.4545; val_kl_reg_loss: 95075.7539; val_edge_recon_loss: 2796221.8125; val_gene_expr_recon_loss: 16625488.7500; val_masked_gp_l1_reg_loss: 159157.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54706.7656; val_chrom_access_recon_loss: 739667.5781; val_global_loss: 20470318.0000; val_optim_loss: 20470318.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9412; val_auprc_score: 0.9161; val_best_acc_score: 0.8864; val_best_f1_score: 0.8932; train_kl_reg_loss: 128618.2978; train_edge_recon_loss: 2760117.3561; train_gene_expr_recon_loss: 16582790.1667; train_masked_gp_l1_reg_loss: 159150.9811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54702.4639; train_chrom_access_recon_loss: 748466.1487; train_global_loss: 20433845.3636; train_optim_loss: 20433845.3636; val_kl_reg_loss: 95560.9883; val_edge_recon_loss: 2808285.8750; val_gene_expr_recon_loss: 16462669.6250; val_masked_gp_l1_reg_loss: 159146.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54712.9180; val_chrom_access_recon_loss: 737084.4062; val_global_loss: 20317459.0000; val_optim_loss: 20317459.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9415; val_auprc_score: 0.9214; val_best_acc_score: 0.8864; val_best_f1_score: 0.8921; train_kl_reg_loss: 128642.6399; train_edge_recon_loss: 2769845.9318; train_gene_expr_recon_loss: 16591350.0152; train_masked_gp_l1_reg_loss: 159127.8973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54525.7540; train_chrom_access_recon_loss: 748201.6932; train_global_loss: 20451694.0606; train_optim_loss: 20451694.0606; val_kl_reg_loss: 96255.8711; val_edge_recon_loss: 2802829.9688; val_gene_expr_recon_loss: 16567797.1250; val_masked_gp_l1_reg_loss: 159119.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54491.2500; val_chrom_access_recon_loss: 734218.4688; val_global_loss: 20414713.2500; val_optim_loss: 20414713.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9447; val_auprc_score: 0.9252; val_best_acc_score: 0.8898; val_best_f1_score: 0.8944; train_kl_reg_loss: 128684.6554; train_edge_recon_loss: 2753923.0947; train_gene_expr_recon_loss: 16590603.8636; train_masked_gp_l1_reg_loss: 159115.8674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54489.3223; train_chrom_access_recon_loss: 749138.9375; train_global_loss: 20435955.6667; train_optim_loss: 20435955.6667; val_kl_reg_loss: 95018.4551; val_edge_recon_loss: 2814414.9375; val_gene_expr_recon_loss: 16496154.6250; val_masked_gp_l1_reg_loss: 159112.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54488.5938; val_chrom_access_recon_loss: 738286.2656; val_global_loss: 20357474.7500; val_optim_loss: 20357474.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9471; val_auprc_score: 0.9311; val_best_acc_score: 0.8920; val_best_f1_score: 0.8971; train_kl_reg_loss: 128732.6951; train_edge_recon_loss: 2769760.1667; train_gene_expr_recon_loss: 16593775.1212; train_masked_gp_l1_reg_loss: 159110.9089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54488.2300; train_chrom_access_recon_loss: 748275.3892; train_global_loss: 20454142.4848; train_optim_loss: 20454142.4848; val_kl_reg_loss: 95335.0430; val_edge_recon_loss: 2792746.3750; val_gene_expr_recon_loss: 16682161.3750; val_masked_gp_l1_reg_loss: 159109.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54486.9336; val_chrom_access_recon_loss: 741045.5156; val_global_loss: 20524884.5000; val_optim_loss: 20524884.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9475; val_auprc_score: 0.9299; val_best_acc_score: 0.8952; val_best_f1_score: 0.8999; train_kl_reg_loss: 128727.7586; train_edge_recon_loss: 2769616.1818; train_gene_expr_recon_loss: 16584716.6515; train_masked_gp_l1_reg_loss: 159107.8788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54486.7823; train_chrom_access_recon_loss: 747727.5436; train_global_loss: 20444382.3333; train_optim_loss: 20444382.3333; val_kl_reg_loss: 95310.9531; val_edge_recon_loss: 2778013.3438; val_gene_expr_recon_loss: 16322337.8750; val_masked_gp_l1_reg_loss: 159106.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54486.5977; val_chrom_access_recon_loss: 737803.8828; val_global_loss: 20147058.0000; val_optim_loss: 20147058.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9447; val_auprc_score: 0.9241; val_best_acc_score: 0.8909; val_best_f1_score: 0.8963; train_kl_reg_loss: 128524.1784; train_edge_recon_loss: 2774768.6250; train_gene_expr_recon_loss: 16587530.7424; train_masked_gp_l1_reg_loss: 159105.7668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54485.9850; train_chrom_access_recon_loss: 749147.6004; train_global_loss: 20453562.7879; train_optim_loss: 20453562.7879; val_kl_reg_loss: 95119.0898; val_edge_recon_loss: 2804404.5312; val_gene_expr_recon_loss: 16605002.8750; val_masked_gp_l1_reg_loss: 159104.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54486.5117; val_chrom_access_recon_loss: 747469.6484; val_global_loss: 20465586.2500; val_optim_loss: 20465586.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9487; val_auprc_score: 0.9330; val_best_acc_score: 0.8949; val_best_f1_score: 0.8972; train_kl_reg_loss: 128725.0070; train_edge_recon_loss: 2758015.1136; train_gene_expr_recon_loss: 16601959.1515; train_masked_gp_l1_reg_loss: 159103.5537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54485.9629; train_chrom_access_recon_loss: 748849.5881; train_global_loss: 20451138.6061; train_optim_loss: 20451138.6061; val_kl_reg_loss: 95927.8369; val_edge_recon_loss: 2807884.5938; val_gene_expr_recon_loss: 16544416.5000; val_masked_gp_l1_reg_loss: 159102.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54485.7734; val_chrom_access_recon_loss: 738421.7344; val_global_loss: 20400238.0000; val_optim_loss: 20400238.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9453; val_auprc_score: 0.9217; val_best_acc_score: 0.8968; val_best_f1_score: 0.9013; train_kl_reg_loss: 128661.8396; train_edge_recon_loss: 2766248.3523; train_gene_expr_recon_loss: 16587640.6970; train_masked_gp_l1_reg_loss: 159101.7443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54485.3864; train_chrom_access_recon_loss: 748540.5852; train_global_loss: 20444678.8485; train_optim_loss: 20444678.8485; val_kl_reg_loss: 94682.3613; val_edge_recon_loss: 2787278.4688; val_gene_expr_recon_loss: 16470204.3750; val_masked_gp_l1_reg_loss: 159100.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54485.1992; val_chrom_access_recon_loss: 736382.1250; val_global_loss: 20302133.0000; val_optim_loss: 20302133.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9454; val_auprc_score: 0.9275; val_best_acc_score: 0.8890; val_best_f1_score: 0.8948; train_kl_reg_loss: 128792.2251; train_edge_recon_loss: 2768029.1932; train_gene_expr_recon_loss: 16592720.4848; train_masked_gp_l1_reg_loss: 159099.9316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54484.6645; train_chrom_access_recon_loss: 749432.0369; train_global_loss: 20452558.2121; train_optim_loss: 20452558.2121; val_kl_reg_loss: 95568.1641; val_edge_recon_loss: 2799231.6562; val_gene_expr_recon_loss: 16642954.2500; val_masked_gp_l1_reg_loss: 159098.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54484.3438; val_chrom_access_recon_loss: 738183.0469; val_global_loss: 20489519.0000; val_optim_loss: 20489519.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9533; val_auprc_score: 0.9394; val_best_acc_score: 0.8979; val_best_f1_score: 0.9019; train_kl_reg_loss: 128493.2926; train_edge_recon_loss: 2764993.3106; train_gene_expr_recon_loss: 16584874.7424; train_masked_gp_l1_reg_loss: 159097.0357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54466.2051; train_chrom_access_recon_loss: 748988.9678; train_global_loss: 20440913.6667; train_optim_loss: 20440913.6667; val_kl_reg_loss: 95571.2490; val_edge_recon_loss: 2787570.8438; val_gene_expr_recon_loss: 16598468.3750; val_masked_gp_l1_reg_loss: 159096.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54462.9453; val_chrom_access_recon_loss: 751931.8828; val_global_loss: 20447100.5000; val_optim_loss: 20447100.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9451; val_auprc_score: 0.9257; val_best_acc_score: 0.8904; val_best_f1_score: 0.8966; train_kl_reg_loss: 128676.5644; train_edge_recon_loss: 2764972.4697; train_gene_expr_recon_loss: 16576787.2879; train_masked_gp_l1_reg_loss: 159095.8890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54462.8524; train_chrom_access_recon_loss: 748032.8258; train_global_loss: 20432027.2121; train_optim_loss: 20432027.2121; val_kl_reg_loss: 95027.8438; val_edge_recon_loss: 2793697.9062; val_gene_expr_recon_loss: 16635558.0000; val_masked_gp_l1_reg_loss: 159095.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54462.7383; val_chrom_access_recon_loss: 743916.6953; val_global_loss: 20481758.0000; val_optim_loss: 20481758.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9523; val_auprc_score: 0.9382; val_best_acc_score: 0.8990; val_best_f1_score: 0.9025; train_kl_reg_loss: 128439.9039; train_edge_recon_loss: 2757118.6705; train_gene_expr_recon_loss: 16588941.6364; train_masked_gp_l1_reg_loss: 159095.3980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54462.6750; train_chrom_access_recon_loss: 748111.0284; train_global_loss: 20436169.2727; train_optim_loss: 20436169.2727; val_kl_reg_loss: 95149.9443; val_edge_recon_loss: 2806250.1562; val_gene_expr_recon_loss: 16636092.2500; val_masked_gp_l1_reg_loss: 159095.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54462.5781; val_chrom_access_recon_loss: 751689.8906; val_global_loss: 20502740.5000; val_optim_loss: 20502740.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9423; val_auprc_score: 0.9217; val_best_acc_score: 0.8890; val_best_f1_score: 0.8923; train_kl_reg_loss: 128479.2661; train_edge_recon_loss: 2763838.2083; train_gene_expr_recon_loss: 16590810.0303; train_masked_gp_l1_reg_loss: 159095.0552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54462.6045; train_chrom_access_recon_loss: 748930.3087; train_global_loss: 20445615.2727; train_optim_loss: 20445615.2727; val_kl_reg_loss: 95504.0596; val_edge_recon_loss: 2832110.7188; val_gene_expr_recon_loss: 16466588.0000; val_masked_gp_l1_reg_loss: 159094.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54462.5352; val_chrom_access_recon_loss: 735098.0547; val_global_loss: 20342856.7500; val_optim_loss: 20342856.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 14 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9428
val AUPRC score: 0.9221
val best accuracy score: 0.8888
val best F1 score: 0.8944
val target rna MSE score: 1.3288
val source rna MSE score: 0.4318
val target atac MSE score: 0.4621
val source atac MSE score: 0.1050
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
