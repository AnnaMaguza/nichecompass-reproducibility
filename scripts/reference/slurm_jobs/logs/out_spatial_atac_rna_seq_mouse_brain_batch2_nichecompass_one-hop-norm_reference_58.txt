[True]
Run timestamp: 24072023_165821_58.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_58']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9636; val_auprc_score: 0.9654; val_best_acc_score: 0.8791; val_best_f1_score: 0.8665; train_kl_reg_loss: 1843.1314; train_edge_recon_loss: 34661846.6667; train_gene_expr_recon_loss: 323887.1597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10876790.3333; train_global_loss: 45864367.5556; train_optim_loss: 45864367.5556; val_kl_reg_loss: 1250.7356; val_edge_recon_loss: 40438364.0000; val_gene_expr_recon_loss: 324065.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10794360.0000; val_global_loss: 51558040.0000; val_optim_loss: 51558040.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9415; val_auprc_score: 0.9443; val_best_acc_score: 0.7804; val_best_f1_score: 0.8004; train_kl_reg_loss: 777.8648; train_edge_recon_loss: 34627536.4444; train_gene_expr_recon_loss: 322611.6840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10804319.2222; train_global_loss: 45755244.4444; train_optim_loss: 45755244.4444; val_kl_reg_loss: 440.7368; val_edge_recon_loss: 39728292.0000; val_gene_expr_recon_loss: 321063.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10767122.0000; val_global_loss: 50816920.0000; val_optim_loss: 50816920.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9026; val_auprc_score: 0.8933; val_best_acc_score: 0.8170; val_best_f1_score: 0.8308; train_kl_reg_loss: 615.8076; train_edge_recon_loss: 34367456.4444; train_gene_expr_recon_loss: 318197.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10732645.4444; train_global_loss: 45418915.5556; train_optim_loss: 45418915.5556; val_kl_reg_loss: 1122.2175; val_edge_recon_loss: 33032554.0000; val_gene_expr_recon_loss: 314953.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10698041.0000; val_global_loss: 44046672.0000; val_optim_loss: 44046672.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8705; val_auprc_score: 0.8636; val_best_acc_score: 0.7707; val_best_f1_score: 0.7944; train_kl_reg_loss: 5040.0321; train_edge_recon_loss: 30723117.1111; train_gene_expr_recon_loss: 312820.5764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10696501.8889; train_global_loss: 41737479.5556; train_optim_loss: 41737479.5556; val_kl_reg_loss: 14784.6543; val_edge_recon_loss: 28585288.0000; val_gene_expr_recon_loss: 317162.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10702529.0000; val_global_loss: 39619764.0000; val_optim_loss: 39619764.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8761; val_auprc_score: 0.8532; val_best_acc_score: 0.7893; val_best_f1_score: 0.8118; train_kl_reg_loss: 25114.8878; train_edge_recon_loss: 28184997.5556; train_gene_expr_recon_loss: 310980.0174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10704243.4444; train_global_loss: 39225336.8889; train_optim_loss: 39225336.8889; val_kl_reg_loss: 35254.6719; val_edge_recon_loss: 27785656.0000; val_gene_expr_recon_loss: 312856.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10657767.0000; val_global_loss: 38791532.0000; val_optim_loss: 38791532.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8919; val_auprc_score: 0.8632; val_best_acc_score: 0.8155; val_best_f1_score: 0.8352; train_kl_reg_loss: 40226.0911; train_edge_recon_loss: 27833769.7778; train_gene_expr_recon_loss: 306958.1285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10590848.8889; train_global_loss: 38771802.6667; train_optim_loss: 38771802.6667; val_kl_reg_loss: 45879.9453; val_edge_recon_loss: 27844142.0000; val_gene_expr_recon_loss: 303832.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10534527.0000; val_global_loss: 38728380.0000; val_optim_loss: 38728380.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9141; val_auprc_score: 0.8873; val_best_acc_score: 0.8514; val_best_f1_score: 0.8631; train_kl_reg_loss: 47459.1181; train_edge_recon_loss: 27407254.4444; train_gene_expr_recon_loss: 302921.1181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10515600.1111; train_global_loss: 38273234.6667; train_optim_loss: 38273234.6667; val_kl_reg_loss: 48482.6172; val_edge_recon_loss: 27472988.0000; val_gene_expr_recon_loss: 296256.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10497274.0000; val_global_loss: 38315000.0000; val_optim_loss: 38315000.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9184; val_auprc_score: 0.8905; val_best_acc_score: 0.8596; val_best_f1_score: 0.8671; train_kl_reg_loss: 49523.4301; train_edge_recon_loss: 27154076.0000; train_gene_expr_recon_loss: 293892.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10460495.4444; train_global_loss: 37957986.6667; train_optim_loss: 37957986.6667; val_kl_reg_loss: 53592.3828; val_edge_recon_loss: 27464596.0000; val_gene_expr_recon_loss: 290708.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10464028.0000; val_global_loss: 38272924.0000; val_optim_loss: 38272924.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9230; val_auprc_score: 0.8990; val_best_acc_score: 0.8624; val_best_f1_score: 0.8710; train_kl_reg_loss: 53019.9266; train_edge_recon_loss: 27042172.4444; train_gene_expr_recon_loss: 288792.5069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10468102.5556; train_global_loss: 37852088.0000; train_optim_loss: 37852088.0000; val_kl_reg_loss: 53458.9922; val_edge_recon_loss: 27420762.0000; val_gene_expr_recon_loss: 286720.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10385680.0000; val_global_loss: 38146620.0000; val_optim_loss: 38146620.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9339; val_auprc_score: 0.9134; val_best_acc_score: 0.8704; val_best_f1_score: 0.8778; train_kl_reg_loss: 52307.8181; train_edge_recon_loss: 27100319.3333; train_gene_expr_recon_loss: 284680.1458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10366286.1111; train_global_loss: 37803592.4444; train_optim_loss: 37803592.4444; val_kl_reg_loss: 50517.2969; val_edge_recon_loss: 27041476.0000; val_gene_expr_recon_loss: 282540.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10381450.0000; val_global_loss: 37755984.0000; val_optim_loss: 37755984.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9392; val_auprc_score: 0.9202; val_best_acc_score: 0.8812; val_best_f1_score: 0.8891; train_kl_reg_loss: 50611.4306; train_edge_recon_loss: 26848069.3333; train_gene_expr_recon_loss: 279415.8403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10304535.2222; train_global_loss: 37482632.4444; train_optim_loss: 37482632.4444; val_kl_reg_loss: 50788.5859; val_edge_recon_loss: 26967854.0000; val_gene_expr_recon_loss: 279411.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10310117.0000; val_global_loss: 37608172.0000; val_optim_loss: 37608172.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9412; val_auprc_score: 0.9215; val_best_acc_score: 0.8840; val_best_f1_score: 0.8905; train_kl_reg_loss: 49554.2717; train_edge_recon_loss: 26966418.8889; train_gene_expr_recon_loss: 276708.7847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10301529.6667; train_global_loss: 37594212.0000; train_optim_loss: 37594212.0000; val_kl_reg_loss: 49869.1797; val_edge_recon_loss: 26887872.0000; val_gene_expr_recon_loss: 274920.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10275587.0000; val_global_loss: 37488248.0000; val_optim_loss: 37488248.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9463; val_auprc_score: 0.9280; val_best_acc_score: 0.8894; val_best_f1_score: 0.8966; train_kl_reg_loss: 49147.6706; train_edge_recon_loss: 26914911.1111; train_gene_expr_recon_loss: 273702.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10253182.1111; train_global_loss: 37490942.6667; train_optim_loss: 37490942.6667; val_kl_reg_loss: 48830.6719; val_edge_recon_loss: 27029496.0000; val_gene_expr_recon_loss: 271763.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10250005.0000; val_global_loss: 37600096.0000; val_optim_loss: 37600096.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9497; val_auprc_score: 0.9293; val_best_acc_score: 0.8984; val_best_f1_score: 0.9043; train_kl_reg_loss: 49707.2513; train_edge_recon_loss: 26928574.8889; train_gene_expr_recon_loss: 272472.2118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10240817.5556; train_global_loss: 37491571.5556; train_optim_loss: 37491571.5556; val_kl_reg_loss: 47291.4102; val_edge_recon_loss: 26904872.0000; val_gene_expr_recon_loss: 270377.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10228290.0000; val_global_loss: 37450832.0000; val_optim_loss: 37450832.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9596; val_auprc_score: 0.9454; val_best_acc_score: 0.9077; val_best_f1_score: 0.9123; train_kl_reg_loss: 48131.8359; train_edge_recon_loss: 26720379.7778; train_gene_expr_recon_loss: 267698.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10209064.0000; train_global_loss: 37245273.3333; train_optim_loss: 37245273.3333; val_kl_reg_loss: 47803.2891; val_edge_recon_loss: 26728418.0000; val_gene_expr_recon_loss: 267472.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10175158.0000; val_global_loss: 37218852.0000; val_optim_loss: 37218852.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9644; val_auprc_score: 0.9502; val_best_acc_score: 0.9130; val_best_f1_score: 0.9173; train_kl_reg_loss: 49005.9948; train_edge_recon_loss: 26547782.2222; train_gene_expr_recon_loss: 265959.7743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10158410.2222; train_global_loss: 37021157.7778; train_optim_loss: 37021157.7778; val_kl_reg_loss: 50125.9375; val_edge_recon_loss: 26649600.0000; val_gene_expr_recon_loss: 263618.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10162965.0000; val_global_loss: 37126308.0000; val_optim_loss: 37126308.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9608; val_auprc_score: 0.9460; val_best_acc_score: 0.9115; val_best_f1_score: 0.9161; train_kl_reg_loss: 52008.1523; train_edge_recon_loss: 26501228.2222; train_gene_expr_recon_loss: 263241.6024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10167480.7778; train_global_loss: 36983958.6667; train_optim_loss: 36983958.6667; val_kl_reg_loss: 53901.6641; val_edge_recon_loss: 26395610.0000; val_gene_expr_recon_loss: 259584.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10118862.0000; val_global_loss: 36827960.0000; val_optim_loss: 36827960.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9645; val_auprc_score: 0.9481; val_best_acc_score: 0.9154; val_best_f1_score: 0.9188; train_kl_reg_loss: 55529.5139; train_edge_recon_loss: 26435611.3333; train_gene_expr_recon_loss: 258874.1319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10121728.3333; train_global_loss: 36871743.1111; train_optim_loss: 36871743.1111; val_kl_reg_loss: 56238.4336; val_edge_recon_loss: 26548932.0000; val_gene_expr_recon_loss: 260456.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10124503.0000; val_global_loss: 36990128.0000; val_optim_loss: 36990128.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9684; val_auprc_score: 0.9539; val_best_acc_score: 0.9262; val_best_f1_score: 0.9297; train_kl_reg_loss: 58214.7860; train_edge_recon_loss: 26443194.4444; train_gene_expr_recon_loss: 256204.6788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10117665.8889; train_global_loss: 36875279.5556; train_optim_loss: 36875279.5556; val_kl_reg_loss: 59419.1367; val_edge_recon_loss: 26382888.0000; val_gene_expr_recon_loss: 257191.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10072143.0000; val_global_loss: 36771644.0000; val_optim_loss: 36771644.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9680; val_auprc_score: 0.9563; val_best_acc_score: 0.9240; val_best_f1_score: 0.9261; train_kl_reg_loss: 60544.1502; train_edge_recon_loss: 26460813.1111; train_gene_expr_recon_loss: 254653.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10038723.1111; train_global_loss: 36814733.3333; train_optim_loss: 36814733.3333; val_kl_reg_loss: 60429.2305; val_edge_recon_loss: 26625696.0000; val_gene_expr_recon_loss: 254380.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10055175.0000; val_global_loss: 36995680.0000; val_optim_loss: 36995680.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9689; val_auprc_score: 0.9585; val_best_acc_score: 0.9247; val_best_f1_score: 0.9275; train_kl_reg_loss: 61685.7357; train_edge_recon_loss: 26420445.5556; train_gene_expr_recon_loss: 252430.9896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10050222.3333; train_global_loss: 36784785.7778; train_optim_loss: 36784785.7778; val_kl_reg_loss: 62375.3086; val_edge_recon_loss: 26371556.0000; val_gene_expr_recon_loss: 253490.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10031862.0000; val_global_loss: 36719284.0000; val_optim_loss: 36719284.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9710; val_auprc_score: 0.9604; val_best_acc_score: 0.9258; val_best_f1_score: 0.9280; train_kl_reg_loss: 62571.5582; train_edge_recon_loss: 26478657.3333; train_gene_expr_recon_loss: 250450.9948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10023436.3333; train_global_loss: 36815116.0000; train_optim_loss: 36815116.0000; val_kl_reg_loss: 63178.6875; val_edge_recon_loss: 26492814.0000; val_gene_expr_recon_loss: 250584.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10002763.0000; val_global_loss: 36809340.0000; val_optim_loss: 36809340.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9715; val_auprc_score: 0.9606; val_best_acc_score: 0.9281; val_best_f1_score: 0.9310; train_kl_reg_loss: 65644.3498; train_edge_recon_loss: 26463086.4444; train_gene_expr_recon_loss: 249542.8299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10016668.8889; train_global_loss: 36794942.6667; train_optim_loss: 36794942.6667; val_kl_reg_loss: 64611.6758; val_edge_recon_loss: 26592282.0000; val_gene_expr_recon_loss: 248985.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9984566.0000; val_global_loss: 36890448.0000; val_optim_loss: 36890448.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9691; val_auprc_score: 0.9565; val_best_acc_score: 0.9255; val_best_f1_score: 0.9282; train_kl_reg_loss: 65498.2101; train_edge_recon_loss: 26345406.6667; train_gene_expr_recon_loss: 246908.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9984600.1111; train_global_loss: 36642415.1111; train_optim_loss: 36642415.1111; val_kl_reg_loss: 67080.4375; val_edge_recon_loss: 26478636.0000; val_gene_expr_recon_loss: 249565.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9960575.0000; val_global_loss: 36755856.0000; val_optim_loss: 36755856.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9708; val_auprc_score: 0.9578; val_best_acc_score: 0.9275; val_best_f1_score: 0.9306; train_kl_reg_loss: 68116.2865; train_edge_recon_loss: 26436018.2222; train_gene_expr_recon_loss: 247071.5069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9973117.8889; train_global_loss: 36724324.4444; train_optim_loss: 36724324.4444; val_kl_reg_loss: 67785.6250; val_edge_recon_loss: 26361906.0000; val_gene_expr_recon_loss: 245959.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9930276.0000; val_global_loss: 36605928.0000; val_optim_loss: 36605928.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9712; val_auprc_score: 0.9573; val_best_acc_score: 0.9295; val_best_f1_score: 0.9317; train_kl_reg_loss: 68185.5877; train_edge_recon_loss: 26427344.4444; train_gene_expr_recon_loss: 244329.2465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9880146.0000; train_global_loss: 36620005.3333; train_optim_loss: 36620005.3333; val_kl_reg_loss: 68581.5000; val_edge_recon_loss: 26552486.0000; val_gene_expr_recon_loss: 246230.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9935556.0000; val_global_loss: 36802856.0000; val_optim_loss: 36802856.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9701; val_auprc_score: 0.9561; val_best_acc_score: 0.9274; val_best_f1_score: 0.9298; train_kl_reg_loss: 70337.4280; train_edge_recon_loss: 26393923.3333; train_gene_expr_recon_loss: 243890.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9908580.3333; train_global_loss: 36616732.0000; train_optim_loss: 36616732.0000; val_kl_reg_loss: 72292.9375; val_edge_recon_loss: 26547128.0000; val_gene_expr_recon_loss: 245819.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9895222.0000; val_global_loss: 36760464.0000; val_optim_loss: 36760464.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9732; val_auprc_score: 0.9624; val_best_acc_score: 0.9324; val_best_f1_score: 0.9346; train_kl_reg_loss: 72098.0495; train_edge_recon_loss: 26390797.1111; train_gene_expr_recon_loss: 243599.8628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9901054.3333; train_global_loss: 36607549.3333; train_optim_loss: 36607549.3333; val_kl_reg_loss: 70884.7344; val_edge_recon_loss: 26364366.0000; val_gene_expr_recon_loss: 241796.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9887256.0000; val_global_loss: 36564304.0000; val_optim_loss: 36564304.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9718; val_auprc_score: 0.9596; val_best_acc_score: 0.9271; val_best_f1_score: 0.9304; train_kl_reg_loss: 71896.7405; train_edge_recon_loss: 26392690.6667; train_gene_expr_recon_loss: 240750.3351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9872473.3333; train_global_loss: 36577811.5556; train_optim_loss: 36577811.5556; val_kl_reg_loss: 71588.4609; val_edge_recon_loss: 26476868.0000; val_gene_expr_recon_loss: 243201.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9891512.0000; val_global_loss: 36683168.0000; val_optim_loss: 36683168.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9699; val_auprc_score: 0.9582; val_best_acc_score: 0.9297; val_best_f1_score: 0.9328; train_kl_reg_loss: 72299.2917; train_edge_recon_loss: 26314549.3333; train_gene_expr_recon_loss: 239774.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9831195.7778; train_global_loss: 36457818.6667; train_optim_loss: 36457818.6667; val_kl_reg_loss: 74357.6016; val_edge_recon_loss: 26610198.0000; val_gene_expr_recon_loss: 239223.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9833758.0000; val_global_loss: 36757536.0000; val_optim_loss: 36757536.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9711; val_auprc_score: 0.9595; val_best_acc_score: 0.9293; val_best_f1_score: 0.9316; train_kl_reg_loss: 73832.7361; train_edge_recon_loss: 26317239.3333; train_gene_expr_recon_loss: 237697.1458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9826895.3333; train_global_loss: 36455664.4444; train_optim_loss: 36455664.4444; val_kl_reg_loss: 73186.0781; val_edge_recon_loss: 26616094.0000; val_gene_expr_recon_loss: 243417.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9885333.0000; val_global_loss: 36818032.0000; val_optim_loss: 36818032.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9675; val_auprc_score: 0.9517; val_best_acc_score: 0.9250; val_best_f1_score: 0.9285; train_kl_reg_loss: 74659.7656; train_edge_recon_loss: 26383171.1111; train_gene_expr_recon_loss: 239111.0226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9842216.2222; train_global_loss: 36539157.3333; train_optim_loss: 36539157.3333; val_kl_reg_loss: 74104.1953; val_edge_recon_loss: 26708126.0000; val_gene_expr_recon_loss: 240312.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9838386.0000; val_global_loss: 36860928.0000; val_optim_loss: 36860928.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9761; val_auprc_score: 0.9662; val_best_acc_score: 0.9369; val_best_f1_score: 0.9393; train_kl_reg_loss: 74335.1050; train_edge_recon_loss: 26349784.4444; train_gene_expr_recon_loss: 237504.0660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9800918.3333; train_global_loss: 36462542.2222; train_optim_loss: 36462542.2222; val_kl_reg_loss: 74483.2734; val_edge_recon_loss: 26451846.0000; val_gene_expr_recon_loss: 238123.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9817926.0000; val_global_loss: 36582380.0000; val_optim_loss: 36582380.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9725; val_auprc_score: 0.9572; val_best_acc_score: 0.9340; val_best_f1_score: 0.9366; train_kl_reg_loss: 75570.8238; train_edge_recon_loss: 26304506.8889; train_gene_expr_recon_loss: 237311.5660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9835298.5556; train_global_loss: 36452688.4444; train_optim_loss: 36452688.4444; val_kl_reg_loss: 74631.0938; val_edge_recon_loss: 26449006.0000; val_gene_expr_recon_loss: 239329.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9837412.0000; val_global_loss: 36600380.0000; val_optim_loss: 36600380.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9729; val_auprc_score: 0.9595; val_best_acc_score: 0.9305; val_best_f1_score: 0.9334; train_kl_reg_loss: 75409.1398; train_edge_recon_loss: 26294442.8889; train_gene_expr_recon_loss: 238321.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9851762.7778; train_global_loss: 36459937.3333; train_optim_loss: 36459937.3333; val_kl_reg_loss: 74726.3359; val_edge_recon_loss: 26414660.0000; val_gene_expr_recon_loss: 238542.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9823923.0000; val_global_loss: 36551852.0000; val_optim_loss: 36551852.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9716; val_auprc_score: 0.9610; val_best_acc_score: 0.9338; val_best_f1_score: 0.9365; train_kl_reg_loss: 75501.5495; train_edge_recon_loss: 26432913.3333; train_gene_expr_recon_loss: 236471.0243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9731601.5556; train_global_loss: 36476487.5556; train_optim_loss: 36476487.5556; val_kl_reg_loss: 74912.3828; val_edge_recon_loss: 26492726.0000; val_gene_expr_recon_loss: 238875.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9833868.0000; val_global_loss: 36640384.0000; val_optim_loss: 36640384.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9730; val_auprc_score: 0.9605; val_best_acc_score: 0.9322; val_best_f1_score: 0.9350; train_kl_reg_loss: 75187.1988; train_edge_recon_loss: 26355172.2222; train_gene_expr_recon_loss: 235927.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9775992.3333; train_global_loss: 36442278.2222; train_optim_loss: 36442278.2222; val_kl_reg_loss: 74952.6562; val_edge_recon_loss: 26465758.0000; val_gene_expr_recon_loss: 238538.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9826288.0000; val_global_loss: 36605536.0000; val_optim_loss: 36605536.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9744; val_auprc_score: 0.9645; val_best_acc_score: 0.9336; val_best_f1_score: 0.9362; train_kl_reg_loss: 75631.0938; train_edge_recon_loss: 26349854.8889; train_gene_expr_recon_loss: 237608.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9812893.2222; train_global_loss: 36475988.4444; train_optim_loss: 36475988.4444; val_kl_reg_loss: 74753.3125; val_edge_recon_loss: 26339536.0000; val_gene_expr_recon_loss: 238575.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9818837.0000; val_global_loss: 36471704.0000; val_optim_loss: 36471704.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9751; val_auprc_score: 0.9635; val_best_acc_score: 0.9345; val_best_f1_score: 0.9370; train_kl_reg_loss: 75570.1701; train_edge_recon_loss: 26328890.8889; train_gene_expr_recon_loss: 236462.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9790245.0000; train_global_loss: 36431168.4444; train_optim_loss: 36431168.4444; val_kl_reg_loss: 75381.6094; val_edge_recon_loss: 26452180.0000; val_gene_expr_recon_loss: 238136.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9799840.0000; val_global_loss: 36565536.0000; val_optim_loss: 36565536.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9719; val_auprc_score: 0.9595; val_best_acc_score: 0.9316; val_best_f1_score: 0.9346; train_kl_reg_loss: 75787.6458; train_edge_recon_loss: 26288603.1111; train_gene_expr_recon_loss: 235906.4201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9783262.7778; train_global_loss: 36383560.4444; train_optim_loss: 36383560.4444; val_kl_reg_loss: 74892.4844; val_edge_recon_loss: 26438678.0000; val_gene_expr_recon_loss: 238645.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9811487.0000; val_global_loss: 36563704.0000; val_optim_loss: 36563704.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9763; val_auprc_score: 0.9674; val_best_acc_score: 0.9342; val_best_f1_score: 0.9369; train_kl_reg_loss: 76765.0234; train_edge_recon_loss: 26287325.3333; train_gene_expr_recon_loss: 237922.0017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9790853.4444; train_global_loss: 36392865.7778; train_optim_loss: 36392865.7778; val_kl_reg_loss: 75149.6328; val_edge_recon_loss: 26434242.0000; val_gene_expr_recon_loss: 237831.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9811137.0000; val_global_loss: 36558360.0000; val_optim_loss: 36558360.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9760; val_auprc_score: 0.9664; val_best_acc_score: 0.9334; val_best_f1_score: 0.9362; train_kl_reg_loss: 76313.8333; train_edge_recon_loss: 26306048.8889; train_gene_expr_recon_loss: 236545.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9757200.5556; train_global_loss: 36376108.4444; train_optim_loss: 36376108.4444; val_kl_reg_loss: 75685.2812; val_edge_recon_loss: 26500598.0000; val_gene_expr_recon_loss: 238657.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9825993.0000; val_global_loss: 36640936.0000; val_optim_loss: 36640936.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9708; val_auprc_score: 0.9565; val_best_acc_score: 0.9291; val_best_f1_score: 0.9328; train_kl_reg_loss: 76280.2335; train_edge_recon_loss: 26303057.3333; train_gene_expr_recon_loss: 235867.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9757099.8889; train_global_loss: 36372304.0000; train_optim_loss: 36372304.0000; val_kl_reg_loss: 75475.7812; val_edge_recon_loss: 26543504.0000; val_gene_expr_recon_loss: 238313.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9811702.0000; val_global_loss: 36668996.0000; val_optim_loss: 36668996.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9748; val_auprc_score: 0.9637; val_best_acc_score: 0.9326; val_best_f1_score: 0.9356; train_kl_reg_loss: 76287.9401; train_edge_recon_loss: 26307645.5556; train_gene_expr_recon_loss: 237186.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9817168.5556; train_global_loss: 36438288.4444; train_optim_loss: 36438288.4444; val_kl_reg_loss: 74933.6562; val_edge_recon_loss: 26409710.0000; val_gene_expr_recon_loss: 237956.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9804851.0000; val_global_loss: 36527452.0000; val_optim_loss: 36527452.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9731; val_auprc_score: 0.9627; val_best_acc_score: 0.9334; val_best_f1_score: 0.9360; train_kl_reg_loss: 76186.8733; train_edge_recon_loss: 26268312.2222; train_gene_expr_recon_loss: 236792.6632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9838068.4444; train_global_loss: 36419360.4444; train_optim_loss: 36419360.4444; val_kl_reg_loss: 75601.5156; val_edge_recon_loss: 26329594.0000; val_gene_expr_recon_loss: 238184.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9817640.0000; val_global_loss: 36461020.0000; val_optim_loss: 36461020.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9731; val_auprc_score: 0.9620; val_best_acc_score: 0.9324; val_best_f1_score: 0.9352; train_kl_reg_loss: 76752.0113; train_edge_recon_loss: 26346431.1111; train_gene_expr_recon_loss: 236520.2049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9835285.8889; train_global_loss: 36494988.8889; train_optim_loss: 36494988.8889; val_kl_reg_loss: 75619.6484; val_edge_recon_loss: 26807746.0000; val_gene_expr_recon_loss: 238420.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9819111.0000; val_global_loss: 36940896.0000; val_optim_loss: 36940896.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9723; val_auprc_score: 0.9570; val_best_acc_score: 0.9360; val_best_f1_score: 0.9384; train_kl_reg_loss: 77074.8160; train_edge_recon_loss: 26310563.7778; train_gene_expr_recon_loss: 235836.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9785043.8889; train_global_loss: 36408518.6667; train_optim_loss: 36408518.6667; val_kl_reg_loss: 75473.6562; val_edge_recon_loss: 26310882.0000; val_gene_expr_recon_loss: 238225.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9806473.0000; val_global_loss: 36431056.0000; val_optim_loss: 36431056.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9725; val_auprc_score: 0.9616; val_best_acc_score: 0.9314; val_best_f1_score: 0.9343; train_kl_reg_loss: 76008.5339; train_edge_recon_loss: 26289848.4444; train_gene_expr_recon_loss: 234970.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9718639.3333; train_global_loss: 36319465.7778; train_optim_loss: 36319465.7778; val_kl_reg_loss: 75851.2812; val_edge_recon_loss: 26587900.0000; val_gene_expr_recon_loss: 238305.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9820814.0000; val_global_loss: 36722872.0000; val_optim_loss: 36722872.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9714; val_auprc_score: 0.9587; val_best_acc_score: 0.9299; val_best_f1_score: 0.9330; train_kl_reg_loss: 76857.4566; train_edge_recon_loss: 26296776.2222; train_gene_expr_recon_loss: 236527.3559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9750335.0000; train_global_loss: 36360496.0000; train_optim_loss: 36360496.0000; val_kl_reg_loss: 75800.9062; val_edge_recon_loss: 26590512.0000; val_gene_expr_recon_loss: 238391.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9821838.0000; val_global_loss: 36726544.0000; val_optim_loss: 36726544.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9736; val_auprc_score: 0.9621; val_best_acc_score: 0.9328; val_best_f1_score: 0.9355; train_kl_reg_loss: 76349.8385; train_edge_recon_loss: 26285699.5556; train_gene_expr_recon_loss: 237242.3872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9749386.4444; train_global_loss: 36348679.1111; train_optim_loss: 36348679.1111; val_kl_reg_loss: 75255.2578; val_edge_recon_loss: 26384202.0000; val_gene_expr_recon_loss: 238296.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9810204.0000; val_global_loss: 36507960.0000; val_optim_loss: 36507960.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9727; val_auprc_score: 0.9576; val_best_acc_score: 0.9303; val_best_f1_score: 0.9333; train_kl_reg_loss: 76030.6797; train_edge_recon_loss: 26313261.1111; train_gene_expr_recon_loss: 235430.8698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9733996.4444; train_global_loss: 36358718.6667; train_optim_loss: 36358718.6667; val_kl_reg_loss: 75699.2812; val_edge_recon_loss: 26494720.0000; val_gene_expr_recon_loss: 238336.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9815496.0000; val_global_loss: 36624252.0000; val_optim_loss: 36624252.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9706; val_auprc_score: 0.9588; val_best_acc_score: 0.9333; val_best_f1_score: 0.9360; train_kl_reg_loss: 75942.2318; train_edge_recon_loss: 26393537.5556; train_gene_expr_recon_loss: 236929.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9795770.6667; train_global_loss: 36502180.0000; train_optim_loss: 36502180.0000; val_kl_reg_loss: 75457.7500; val_edge_recon_loss: 26423594.0000; val_gene_expr_recon_loss: 238243.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9820961.0000; val_global_loss: 36558256.0000; val_optim_loss: 36558256.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9745; val_auprc_score: 0.9650; val_best_acc_score: 0.9324; val_best_f1_score: 0.9351; train_kl_reg_loss: 76262.8715; train_edge_recon_loss: 26330379.3333; train_gene_expr_recon_loss: 237359.9201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9784434.8889; train_global_loss: 36428437.3333; train_optim_loss: 36428437.3333; val_kl_reg_loss: 75516.1250; val_edge_recon_loss: 26315508.0000; val_gene_expr_recon_loss: 238143.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9806062.0000; val_global_loss: 36435232.0000; val_optim_loss: 36435232.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9721; val_auprc_score: 0.9601; val_best_acc_score: 0.9307; val_best_f1_score: 0.9337; train_kl_reg_loss: 76084.4436; train_edge_recon_loss: 26326704.4444; train_gene_expr_recon_loss: 237212.2170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9794085.1111; train_global_loss: 36434087.1111; train_optim_loss: 36434087.1111; val_kl_reg_loss: 75693.0469; val_edge_recon_loss: 26449188.0000; val_gene_expr_recon_loss: 238170.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9823403.0000; val_global_loss: 36586456.0000; val_optim_loss: 36586456.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9721; val_auprc_score: 0.9596; val_best_acc_score: 0.9314; val_best_f1_score: 0.9348; train_kl_reg_loss: 76474.1076; train_edge_recon_loss: 26321866.6667; train_gene_expr_recon_loss: 235731.9132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9759447.0000; train_global_loss: 36393520.4444; train_optim_loss: 36393520.4444; val_kl_reg_loss: 75425.4375; val_edge_recon_loss: 26371032.0000; val_gene_expr_recon_loss: 238268.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9810337.0000; val_global_loss: 36495064.0000; val_optim_loss: 36495064.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 13 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
Val AUROC score: 0.9756
Val AUPRC score: 0.9626
Val best accuracy score: 0.9384
Val best F1 score: 0.9406
Val gene expr MSE score: 0.6108
Val chrom access MSE score: 0.0883
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
