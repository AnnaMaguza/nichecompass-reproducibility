[True, False, True]
Run timestamp: 06102023_193135_28.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_28']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 480575
Number of validation nodes: 53397
Number of training edges: 1134287
Number of validation edges: 126031
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8987; val_auprc_score: 0.9774; val_best_acc_score: 0.9032; val_best_f1_score: 0.9449; train_kl_reg_loss: 24083.5919; train_edge_recon_loss: 8188412.8531; train_gene_expr_recon_loss: 27622529.9422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35835026.4106; train_optim_loss: 35835026.4106; val_kl_reg_loss: 26349.6179; val_edge_recon_loss: 8322995.1883; val_gene_expr_recon_loss: 24701009.9514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 33050354.7773; val_optim_loss: 33050354.7773
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9057; val_auprc_score: 0.9792; val_best_acc_score: 0.9051; val_best_f1_score: 0.9460; train_kl_reg_loss: 30818.5759; train_edge_recon_loss: 7960520.6173; train_gene_expr_recon_loss: 23302333.8042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31293672.9865; train_optim_loss: 31293672.9865; val_kl_reg_loss: 34053.9435; val_edge_recon_loss: 8280005.7652; val_gene_expr_recon_loss: 22314041.2874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30628100.9069; val_optim_loss: 30628100.9069
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9131; val_auprc_score: 0.9804; val_best_acc_score: 0.9119; val_best_f1_score: 0.9496; train_kl_reg_loss: 38213.4862; train_edge_recon_loss: 7939043.7685; train_gene_expr_recon_loss: 21854958.6182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29832215.9016; train_optim_loss: 29832215.9016; val_kl_reg_loss: 43682.4078; val_edge_recon_loss: 8270295.4291; val_gene_expr_recon_loss: 21526532.0567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29840509.8785; val_optim_loss: 29840509.8785
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9158; val_auprc_score: 0.9812; val_best_acc_score: 0.9131; val_best_f1_score: 0.9502; train_kl_reg_loss: 44607.5481; train_edge_recon_loss: 7935290.6843; train_gene_expr_recon_loss: 21320807.8998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29300706.1372; train_optim_loss: 29300706.1372; val_kl_reg_loss: 45900.0863; val_edge_recon_loss: 8314690.9474; val_gene_expr_recon_loss: 21203223.5870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29563814.6559; val_optim_loss: 29563814.6559
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9198; val_auprc_score: 0.9822; val_best_acc_score: 0.9168; val_best_f1_score: 0.9523; train_kl_reg_loss: 49170.4656; train_edge_recon_loss: 7890075.7780; train_gene_expr_recon_loss: 21057893.2834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28997139.5307; train_optim_loss: 28997139.5307; val_kl_reg_loss: 50518.2352; val_edge_recon_loss: 8200761.0385; val_gene_expr_recon_loss: 21022035.7490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29273314.9960; val_optim_loss: 29273314.9960
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9218; val_auprc_score: 0.9826; val_best_acc_score: 0.9176; val_best_f1_score: 0.9527; train_kl_reg_loss: 52867.9776; train_edge_recon_loss: 7880073.9693; train_gene_expr_recon_loss: 20894511.2491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28827453.1977; train_optim_loss: 28827453.1977; val_kl_reg_loss: 53964.8409; val_edge_recon_loss: 8263069.6538; val_gene_expr_recon_loss: 20872963.6518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29189998.1781; val_optim_loss: 29189998.1781
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9239; val_auprc_score: 0.9833; val_best_acc_score: 0.9200; val_best_f1_score: 0.9542; train_kl_reg_loss: 56642.0753; train_edge_recon_loss: 7890756.4722; train_gene_expr_recon_loss: 20767761.7319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28715160.2681; train_optim_loss: 28715160.2681; val_kl_reg_loss: 59615.8809; val_edge_recon_loss: 8153845.8381; val_gene_expr_recon_loss: 20761805.5223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28975267.2794; val_optim_loss: 28975267.2794
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9250; val_auprc_score: 0.9834; val_best_acc_score: 0.9191; val_best_f1_score: 0.9535; train_kl_reg_loss: 60991.1147; train_edge_recon_loss: 7893603.5379; train_gene_expr_recon_loss: 20674769.4125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28629364.0659; train_optim_loss: 28629364.0659; val_kl_reg_loss: 62954.8805; val_edge_recon_loss: 8208306.0729; val_gene_expr_recon_loss: 20693831.8866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28965092.7854; val_optim_loss: 28965092.7854
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9179; val_auprc_score: 0.9812; val_best_acc_score: 0.9174; val_best_f1_score: 0.9526; train_kl_reg_loss: 39047.2206; train_edge_recon_loss: 7992699.6780; train_gene_expr_recon_loss: 24920447.4684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32952194.3375; train_optim_loss: 32952194.3375; val_kl_reg_loss: 33501.4058; val_edge_recon_loss: 8273372.1640; val_gene_expr_recon_loss: 23480266.0243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31787139.6032; val_optim_loss: 31787139.6032
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9252; val_auprc_score: 0.9836; val_best_acc_score: 0.9191; val_best_f1_score: 0.9536; train_kl_reg_loss: 54402.1780; train_edge_recon_loss: 7911718.8833; train_gene_expr_recon_loss: 21870551.4567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29836672.5343; train_optim_loss: 29836672.5343; val_kl_reg_loss: 63028.0774; val_edge_recon_loss: 8166780.5506; val_gene_expr_recon_loss: 21411575.1417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29641383.7409; val_optim_loss: 29641383.7409
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9270; val_auprc_score: 0.9837; val_best_acc_score: 0.9200; val_best_f1_score: 0.9540; train_kl_reg_loss: 68771.2984; train_edge_recon_loss: 7861014.1760; train_gene_expr_recon_loss: 21091381.3637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29021166.8159; train_optim_loss: 29021166.8159; val_kl_reg_loss: 74853.9207; val_edge_recon_loss: 8283070.9170; val_gene_expr_recon_loss: 20918033.7814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29275958.6397; val_optim_loss: 29275958.6397
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9258; val_auprc_score: 0.9836; val_best_acc_score: 0.9207; val_best_f1_score: 0.9546; train_kl_reg_loss: 77620.3867; train_edge_recon_loss: 7890934.1171; train_gene_expr_recon_loss: 20799350.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28767904.7572; train_optim_loss: 28767904.7572; val_kl_reg_loss: 82628.9126; val_edge_recon_loss: 8193592.6883; val_gene_expr_recon_loss: 20728504.9069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29004726.5344; val_optim_loss: 29004726.5344

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9296; val_auprc_score: 0.9848; val_best_acc_score: 0.9226; val_best_f1_score: 0.9556; train_kl_reg_loss: 79497.3214; train_edge_recon_loss: 7882150.8888; train_gene_expr_recon_loss: 20450315.8303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28411964.0442; train_optim_loss: 28411964.0442; val_kl_reg_loss: 79580.7183; val_edge_recon_loss: 8121932.1984; val_gene_expr_recon_loss: 20504195.6761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28705708.6154; val_optim_loss: 28705708.6154
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9308; val_auprc_score: 0.9850; val_best_acc_score: 0.9243; val_best_f1_score: 0.9566; train_kl_reg_loss: 78646.2421; train_edge_recon_loss: 7862349.5747; train_gene_expr_recon_loss: 20378881.3800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28319877.1922; train_optim_loss: 28319877.1922; val_kl_reg_loss: 77863.9161; val_edge_recon_loss: 8113965.9453; val_gene_expr_recon_loss: 20415602.4130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28607432.2834; val_optim_loss: 28607432.2834
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9315; val_auprc_score: 0.9848; val_best_acc_score: 0.9235; val_best_f1_score: 0.9559; train_kl_reg_loss: 77416.4187; train_edge_recon_loss: 7859578.1485; train_gene_expr_recon_loss: 20328311.5018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28265306.0551; train_optim_loss: 28265306.0551; val_kl_reg_loss: 77649.3951; val_edge_recon_loss: 8288237.4453; val_gene_expr_recon_loss: 20407951.9028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28773838.7287; val_optim_loss: 28773838.7287
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9322; val_auprc_score: 0.9852; val_best_acc_score: 0.9234; val_best_f1_score: 0.9561; train_kl_reg_loss: 76581.2412; train_edge_recon_loss: 7851195.7996; train_gene_expr_recon_loss: 20292541.7392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28220318.7852; train_optim_loss: 28220318.7852; val_kl_reg_loss: 76152.7716; val_edge_recon_loss: 8151749.1903; val_gene_expr_recon_loss: 20368104.7854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28596006.7530; val_optim_loss: 28596006.7530
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9340; val_auprc_score: 0.9854; val_best_acc_score: 0.9251; val_best_f1_score: 0.9569; train_kl_reg_loss: 75801.0309; train_edge_recon_loss: 7895623.0921; train_gene_expr_recon_loss: 20266343.4206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28237767.5334; train_optim_loss: 28237767.5334; val_kl_reg_loss: 75624.6893; val_edge_recon_loss: 8221612.0789; val_gene_expr_recon_loss: 20358256.3644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28655493.1822; val_optim_loss: 28655493.1822
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9325; val_auprc_score: 0.9853; val_best_acc_score: 0.9247; val_best_f1_score: 0.9568; train_kl_reg_loss: 75228.8188; train_edge_recon_loss: 7860601.3892; train_gene_expr_recon_loss: 20251282.9693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28187113.1733; train_optim_loss: 28187113.1733; val_kl_reg_loss: 75195.7104; val_edge_recon_loss: 8124370.9575; val_gene_expr_recon_loss: 20333552.6964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28533119.4008; val_optim_loss: 28533119.4008
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9324; val_auprc_score: 0.9851; val_best_acc_score: 0.9247; val_best_f1_score: 0.9568; train_kl_reg_loss: 75148.4869; train_edge_recon_loss: 7854118.8786; train_gene_expr_recon_loss: 20218849.5749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28148116.9161; train_optim_loss: 28148116.9161; val_kl_reg_loss: 75100.8450; val_edge_recon_loss: 8213046.4960; val_gene_expr_recon_loss: 20322649.1660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28610796.5506; val_optim_loss: 28610796.5506
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9338; val_auprc_score: 0.9856; val_best_acc_score: 0.9250; val_best_f1_score: 0.9570; train_kl_reg_loss: 74442.4289; train_edge_recon_loss: 7862761.8973; train_gene_expr_recon_loss: 20203135.1877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28140339.5036; train_optim_loss: 28140339.5036; val_kl_reg_loss: 74555.2427; val_edge_recon_loss: 8196568.5121; val_gene_expr_recon_loss: 20295889.6680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28567013.4656; val_optim_loss: 28567013.4656
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9352; val_auprc_score: 0.9859; val_best_acc_score: 0.9244; val_best_f1_score: 0.9566; train_kl_reg_loss: 73555.5818; train_edge_recon_loss: 7872502.1880; train_gene_expr_recon_loss: 20176001.0560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28122058.8312; train_optim_loss: 28122058.8312; val_kl_reg_loss: 73697.5712; val_edge_recon_loss: 8194028.6984; val_gene_expr_recon_loss: 20277508.8745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28545235.1660; val_optim_loss: 28545235.1660
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9354; val_auprc_score: 0.9861; val_best_acc_score: 0.9264; val_best_f1_score: 0.9576; train_kl_reg_loss: 72433.4480; train_edge_recon_loss: 7841794.4889; train_gene_expr_recon_loss: 20163129.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28077357.6318; train_optim_loss: 28077357.6318; val_kl_reg_loss: 71981.0541; val_edge_recon_loss: 8090767.3826; val_gene_expr_recon_loss: 20250860.7449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28413609.2713; val_optim_loss: 28413609.2713
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9352; val_auprc_score: 0.9859; val_best_acc_score: 0.9263; val_best_f1_score: 0.9577; train_kl_reg_loss: 71965.6184; train_edge_recon_loss: 7854794.2419; train_gene_expr_recon_loss: 20152896.5162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28079656.3989; train_optim_loss: 28079656.3989; val_kl_reg_loss: 72402.2643; val_edge_recon_loss: 8137226.1134; val_gene_expr_recon_loss: 20251937.0931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28461565.5385; val_optim_loss: 28461565.5385
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9347; val_auprc_score: 0.9858; val_best_acc_score: 0.9258; val_best_f1_score: 0.9575; train_kl_reg_loss: 71596.6268; train_edge_recon_loss: 7875755.0514; train_gene_expr_recon_loss: 20137534.3060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28084885.9928; train_optim_loss: 28084885.9928; val_kl_reg_loss: 71505.7460; val_edge_recon_loss: 8140434.7368; val_gene_expr_recon_loss: 20255504.2591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28467444.7530; val_optim_loss: 28467444.7530
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9367; val_auprc_score: 0.9861; val_best_acc_score: 0.9272; val_best_f1_score: 0.9581; train_kl_reg_loss: 71102.3099; train_edge_recon_loss: 7843115.2624; train_gene_expr_recon_loss: 20131024.6218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28045242.2112; train_optim_loss: 28045242.2112; val_kl_reg_loss: 70923.6425; val_edge_recon_loss: 8129832.2045; val_gene_expr_recon_loss: 20223743.5628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 28424499.3846; val_optim_loss: 28424499.3846
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9321; val_auprc_score: 0.9851; val_best_acc_score: 0.9264; val_best_f1_score: 0.9578; train_kl_reg_loss: 70046.9227; train_edge_recon_loss: 7903223.7283; train_gene_expr_recon_loss: 18731254.8971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26704525.5596; train_optim_loss: 26704525.5596; val_kl_reg_loss: 34665.8901; val_edge_recon_loss: 8153024.0202; val_gene_expr_recon_loss: 18567156.9717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26754846.9636; val_optim_loss: 26754846.9636
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9358; val_auprc_score: 0.9859; val_best_acc_score: 0.9269; val_best_f1_score: 0.9580; train_kl_reg_loss: 69128.5005; train_edge_recon_loss: 7895281.9594; train_gene_expr_recon_loss: 18436845.7130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26401256.1408; train_optim_loss: 26401256.1408; val_kl_reg_loss: 34560.7240; val_edge_recon_loss: 8221233.1397; val_gene_expr_recon_loss: 18436775.2065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26692569.0445; val_optim_loss: 26692569.0445
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9343; val_auprc_score: 0.9855; val_best_acc_score: 0.9272; val_best_f1_score: 0.9583; train_kl_reg_loss: 65391.3139; train_edge_recon_loss: 7869326.3170; train_gene_expr_recon_loss: 18273489.8357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26208207.4639; train_optim_loss: 26208207.4639; val_kl_reg_loss: 34839.0113; val_edge_recon_loss: 8153909.8360; val_gene_expr_recon_loss: 18281119.4656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26469868.2591; val_optim_loss: 26469868.2591
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9354; val_auprc_score: 0.9857; val_best_acc_score: 0.9268; val_best_f1_score: 0.9579; train_kl_reg_loss: 60783.0875; train_edge_recon_loss: 7863880.6435; train_gene_expr_recon_loss: 18142533.0343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 26067196.7825; train_optim_loss: 26067196.7825; val_kl_reg_loss: 35562.8626; val_edge_recon_loss: 8218665.3826; val_gene_expr_recon_loss: 18178060.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26432288.1943; val_optim_loss: 26432288.1943
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9346; val_auprc_score: 0.9858; val_best_acc_score: 0.9271; val_best_f1_score: 0.9581; train_kl_reg_loss: 56681.6024; train_edge_recon_loss: 7876501.7234; train_gene_expr_recon_loss: 18046518.8294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25979702.1597; train_optim_loss: 25979702.1597; val_kl_reg_loss: 36209.1501; val_edge_recon_loss: 8104500.5870; val_gene_expr_recon_loss: 18083997.5709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26224707.2713; val_optim_loss: 26224707.2713
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9355; val_auprc_score: 0.9859; val_best_acc_score: 0.9272; val_best_f1_score: 0.9582; train_kl_reg_loss: 53977.2260; train_edge_recon_loss: 7863883.8991; train_gene_expr_recon_loss: 17994354.8430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25912215.9684; train_optim_loss: 25912215.9684; val_kl_reg_loss: 37331.2727; val_edge_recon_loss: 8162690.4352; val_gene_expr_recon_loss: 18057444.2834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26257465.9595; val_optim_loss: 26257465.9595
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9354; val_auprc_score: 0.9857; val_best_acc_score: 0.9281; val_best_f1_score: 0.9587; train_kl_reg_loss: 52093.3132; train_edge_recon_loss: 7862245.3048; train_gene_expr_recon_loss: 17941846.5713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25856185.2085; train_optim_loss: 25856185.2085; val_kl_reg_loss: 37259.6540; val_edge_recon_loss: 8138296.5709; val_gene_expr_recon_loss: 18000357.0850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26175913.2713; val_optim_loss: 26175913.2713
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9361; val_auprc_score: 0.9861; val_best_acc_score: 0.9285; val_best_f1_score: 0.9590; train_kl_reg_loss: 50993.5677; train_edge_recon_loss: 7891978.6870; train_gene_expr_recon_loss: 17889619.1286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25832591.3926; train_optim_loss: 25832591.3926; val_kl_reg_loss: 37954.7614; val_edge_recon_loss: 8075691.3947; val_gene_expr_recon_loss: 17944379.6113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26058025.8300; val_optim_loss: 26058025.8300
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9363; val_auprc_score: 0.9860; val_best_acc_score: 0.9268; val_best_f1_score: 0.9579; train_kl_reg_loss: 50689.8334; train_edge_recon_loss: 7873954.3380; train_gene_expr_recon_loss: 17857371.1620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25782015.3294; train_optim_loss: 25782015.3294; val_kl_reg_loss: 38779.4792; val_edge_recon_loss: 8154602.7530; val_gene_expr_recon_loss: 17917318.0324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26110700.2834; val_optim_loss: 26110700.2834
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9360; val_auprc_score: 0.9859; val_best_acc_score: 0.9281; val_best_f1_score: 0.9586; train_kl_reg_loss: 50608.8712; train_edge_recon_loss: 7870384.8184; train_gene_expr_recon_loss: 17820518.5745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25741512.2509; train_optim_loss: 25741512.2509; val_kl_reg_loss: 39049.2935; val_edge_recon_loss: 8130266.9089; val_gene_expr_recon_loss: 17903745.7085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26073061.9352; val_optim_loss: 26073061.9352
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9377; val_auprc_score: 0.9865; val_best_acc_score: 0.9277; val_best_f1_score: 0.9585; train_kl_reg_loss: 50192.7772; train_edge_recon_loss: 7852407.5325; train_gene_expr_recon_loss: 17795544.9725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25698145.2969; train_optim_loss: 25698145.2969; val_kl_reg_loss: 39804.5342; val_edge_recon_loss: 8122008.5445; val_gene_expr_recon_loss: 17873401.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26035214.7773; val_optim_loss: 26035214.7773
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9346; val_auprc_score: 0.9858; val_best_acc_score: 0.9268; val_best_f1_score: 0.9580; train_kl_reg_loss: 50051.1701; train_edge_recon_loss: 7853592.7640; train_gene_expr_recon_loss: 17778219.2541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25681863.1670; train_optim_loss: 25681863.1670; val_kl_reg_loss: 40336.8125; val_edge_recon_loss: 8098328.2672; val_gene_expr_recon_loss: 17848229.3482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25986894.3968; val_optim_loss: 25986894.3968
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9355; val_auprc_score: 0.9859; val_best_acc_score: 0.9267; val_best_f1_score: 0.9579; train_kl_reg_loss: 49821.2969; train_edge_recon_loss: 7841677.1992; train_gene_expr_recon_loss: 17753182.3339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25644680.8457; train_optim_loss: 25644680.8457; val_kl_reg_loss: 41086.0643; val_edge_recon_loss: 8182861.1862; val_gene_expr_recon_loss: 17824011.7530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26047958.9960; val_optim_loss: 26047958.9960
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9360; val_auprc_score: 0.9860; val_best_acc_score: 0.9278; val_best_f1_score: 0.9585; train_kl_reg_loss: 49754.7791; train_edge_recon_loss: 7844273.8651; train_gene_expr_recon_loss: 17735635.8741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25629664.5469; train_optim_loss: 25629664.5469; val_kl_reg_loss: 41251.3482; val_edge_recon_loss: 8115739.7105; val_gene_expr_recon_loss: 17825917.9352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25982908.9474; val_optim_loss: 25982908.9474
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9380; val_auprc_score: 0.9863; val_best_acc_score: 0.9278; val_best_f1_score: 0.9584; train_kl_reg_loss: 49698.9686; train_edge_recon_loss: 7847373.1464; train_gene_expr_recon_loss: 17723476.2721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25620548.3764; train_optim_loss: 25620548.3764; val_kl_reg_loss: 41420.6040; val_edge_recon_loss: 8193445.6579; val_gene_expr_recon_loss: 17808125.4575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26042991.7571; val_optim_loss: 26042991.7571
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9335; val_auprc_score: 0.9851; val_best_acc_score: 0.9264; val_best_f1_score: 0.9577; train_kl_reg_loss: 49504.5014; train_edge_recon_loss: 7839138.8102; train_gene_expr_recon_loss: 17705173.6259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25593816.9359; train_optim_loss: 25593816.9359; val_kl_reg_loss: 42060.3949; val_edge_recon_loss: 8232467.9312; val_gene_expr_recon_loss: 17788623.7976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26063152.1296; val_optim_loss: 26063152.1296
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9372; val_auprc_score: 0.9860; val_best_acc_score: 0.9287; val_best_f1_score: 0.9590; train_kl_reg_loss: 49793.2528; train_edge_recon_loss: 7830560.1496; train_gene_expr_recon_loss: 17680014.6503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25560368.0487; train_optim_loss: 25560368.0487; val_kl_reg_loss: 41787.3639; val_edge_recon_loss: 8170270.6113; val_gene_expr_recon_loss: 17776593.0040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25988651.0769; val_optim_loss: 25988651.0769
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9360; val_auprc_score: 0.9859; val_best_acc_score: 0.9271; val_best_f1_score: 0.9581; train_kl_reg_loss: 49610.1664; train_edge_recon_loss: 7874611.1909; train_gene_expr_recon_loss: 17656516.9292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25580738.2870; train_optim_loss: 25580738.2870; val_kl_reg_loss: 41758.1009; val_edge_recon_loss: 8178754.1012; val_gene_expr_recon_loss: 17754623.5830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25975135.7733; val_optim_loss: 25975135.7733
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9368; val_auprc_score: 0.9860; val_best_acc_score: 0.9287; val_best_f1_score: 0.9591; train_kl_reg_loss: 49525.2569; train_edge_recon_loss: 7847879.3836; train_gene_expr_recon_loss: 17643650.6494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25541055.2933; train_optim_loss: 25541055.2933; val_kl_reg_loss: 42404.7312; val_edge_recon_loss: 8124684.1680; val_gene_expr_recon_loss: 17739409.7692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25906498.6802; val_optim_loss: 25906498.6802
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9357; val_auprc_score: 0.9857; val_best_acc_score: 0.9284; val_best_f1_score: 0.9589; train_kl_reg_loss: 49630.7921; train_edge_recon_loss: 7845207.5487; train_gene_expr_recon_loss: 17650851.7653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25545690.0984; train_optim_loss: 25545690.0984; val_kl_reg_loss: 42694.6914; val_edge_recon_loss: 8123904.9372; val_gene_expr_recon_loss: 17738166.9069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25904766.5830; val_optim_loss: 25904766.5830
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9361; val_auprc_score: 0.9860; val_best_acc_score: 0.9282; val_best_f1_score: 0.9588; train_kl_reg_loss: 49264.8420; train_edge_recon_loss: 7832267.5526; train_gene_expr_recon_loss: 17643080.9729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25524613.3511; train_optim_loss: 25524613.3511; val_kl_reg_loss: 42791.8497; val_edge_recon_loss: 8106467.3745; val_gene_expr_recon_loss: 17712015.6680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25861274.8988; val_optim_loss: 25861274.8988
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9383; val_auprc_score: 0.9866; val_best_acc_score: 0.9281; val_best_f1_score: 0.9587; train_kl_reg_loss: 49159.5099; train_edge_recon_loss: 7820256.0866; train_gene_expr_recon_loss: 17621678.1931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25491093.7861; train_optim_loss: 25491093.7861; val_kl_reg_loss: 42773.5704; val_edge_recon_loss: 8160405.8623; val_gene_expr_recon_loss: 17719405.5304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25922584.9312; val_optim_loss: 25922584.9312
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9385; val_auprc_score: 0.9864; val_best_acc_score: 0.9292; val_best_f1_score: 0.9593; train_kl_reg_loss: 48908.2982; train_edge_recon_loss: 7845271.6257; train_gene_expr_recon_loss: 17603875.3876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25498055.3321; train_optim_loss: 25498055.3321; val_kl_reg_loss: 42896.4351; val_edge_recon_loss: 8192048.7105; val_gene_expr_recon_loss: 17700566.7126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25935511.9190; val_optim_loss: 25935511.9190
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9388; val_auprc_score: 0.9864; val_best_acc_score: 0.9291; val_best_f1_score: 0.9591; train_kl_reg_loss: 48957.1600; train_edge_recon_loss: 7860901.0963; train_gene_expr_recon_loss: 17594621.4851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25504479.7374; train_optim_loss: 25504479.7374; val_kl_reg_loss: 42115.1315; val_edge_recon_loss: 8130123.7389; val_gene_expr_recon_loss: 17668909.8785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25841148.7368; val_optim_loss: 25841148.7368
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9366; val_auprc_score: 0.9860; val_best_acc_score: 0.9278; val_best_f1_score: 0.9585; train_kl_reg_loss: 49142.8466; train_edge_recon_loss: 7854201.1097; train_gene_expr_recon_loss: 17577653.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25480997.8222; train_optim_loss: 25480997.8222; val_kl_reg_loss: 42901.6289; val_edge_recon_loss: 8169177.3320; val_gene_expr_recon_loss: 17662897.2794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25874976.1377; val_optim_loss: 25874976.1377
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9383; val_auprc_score: 0.9867; val_best_acc_score: 0.9291; val_best_f1_score: 0.9592; train_kl_reg_loss: 49316.8429; train_edge_recon_loss: 7873988.5174; train_gene_expr_recon_loss: 17562547.2347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25485852.6191; train_optim_loss: 25485852.6191; val_kl_reg_loss: 42711.1779; val_edge_recon_loss: 8016179.8077; val_gene_expr_recon_loss: 17664649.7814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25723540.7530; val_optim_loss: 25723540.7530
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9388; val_auprc_score: 0.9867; val_best_acc_score: 0.9291; val_best_f1_score: 0.9591; train_kl_reg_loss: 49146.2181; train_edge_recon_loss: 7879701.7823; train_gene_expr_recon_loss: 17549748.3736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25478596.3502; train_optim_loss: 25478596.3502; val_kl_reg_loss: 42746.3886; val_edge_recon_loss: 8107565.9089; val_gene_expr_recon_loss: 17639177.3522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25789489.7733; val_optim_loss: 25789489.7733
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9394; val_auprc_score: 0.9869; val_best_acc_score: 0.9299; val_best_f1_score: 0.9596; train_kl_reg_loss: 49389.6410; train_edge_recon_loss: 7833455.4779; train_gene_expr_recon_loss: 17539417.3732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25422262.4901; train_optim_loss: 25422262.4901; val_kl_reg_loss: 42913.3069; val_edge_recon_loss: 8029537.3360; val_gene_expr_recon_loss: 17634621.0202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25707071.6599; val_optim_loss: 25707071.6599
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9397; val_auprc_score: 0.9868; val_best_acc_score: 0.9295; val_best_f1_score: 0.9594; train_kl_reg_loss: 48837.4373; train_edge_recon_loss: 7849298.7926; train_gene_expr_recon_loss: 17538001.4693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25436137.6977; train_optim_loss: 25436137.6977; val_kl_reg_loss: 42496.2317; val_edge_recon_loss: 8134159.7429; val_gene_expr_recon_loss: 17613725.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25790381.2551; val_optim_loss: 25790381.2551
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9396; val_auprc_score: 0.9868; val_best_acc_score: 0.9301; val_best_f1_score: 0.9597; train_kl_reg_loss: 48834.1981; train_edge_recon_loss: 7821689.5093; train_gene_expr_recon_loss: 17524550.0113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25395073.7374; train_optim_loss: 25395073.7374; val_kl_reg_loss: 42931.8404; val_edge_recon_loss: 8096693.1316; val_gene_expr_recon_loss: 17615548.8543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25755173.8704; val_optim_loss: 25755173.8704
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9407; val_auprc_score: 0.9871; val_best_acc_score: 0.9300; val_best_f1_score: 0.9597; train_kl_reg_loss: 48904.1080; train_edge_recon_loss: 7858085.8653; train_gene_expr_recon_loss: 17512573.8249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25419563.7843; train_optim_loss: 25419563.7843; val_kl_reg_loss: 43294.4127; val_edge_recon_loss: 8140692.5850; val_gene_expr_recon_loss: 17605904.9514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25789891.9433; val_optim_loss: 25789891.9433
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9385; val_auprc_score: 0.9865; val_best_acc_score: 0.9293; val_best_f1_score: 0.9593; train_kl_reg_loss: 48653.8503; train_edge_recon_loss: 7846602.2204; train_gene_expr_recon_loss: 17504441.2906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25399697.3493; train_optim_loss: 25399697.3493; val_kl_reg_loss: 43412.5666; val_edge_recon_loss: 8115581.7632; val_gene_expr_recon_loss: 17602837.1174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25761831.4251; val_optim_loss: 25761831.4251

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9400; val_auprc_score: 0.9866; val_best_acc_score: 0.9304; val_best_f1_score: 0.9599; train_kl_reg_loss: 48425.1886; train_edge_recon_loss: 7824495.1593; train_gene_expr_recon_loss: 17475730.2671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25348650.6020; train_optim_loss: 25348650.6020; val_kl_reg_loss: 42927.1416; val_edge_recon_loss: 8123223.4939; val_gene_expr_recon_loss: 17580494.4858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25746645.0850; val_optim_loss: 25746645.0850
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9376; val_auprc_score: 0.9861; val_best_acc_score: 0.9295; val_best_f1_score: 0.9594; train_kl_reg_loss: 48261.1551; train_edge_recon_loss: 7826524.9398; train_gene_expr_recon_loss: 17471359.0736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25346145.1661; train_optim_loss: 25346145.1661; val_kl_reg_loss: 42866.3494; val_edge_recon_loss: 8189425.2429; val_gene_expr_recon_loss: 17578105.0891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25810396.6640; val_optim_loss: 25810396.6640
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9399; val_auprc_score: 0.9867; val_best_acc_score: 0.9301; val_best_f1_score: 0.9599; train_kl_reg_loss: 48235.0461; train_edge_recon_loss: 7830657.1146; train_gene_expr_recon_loss: 17460938.4097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25339830.5713; train_optim_loss: 25339830.5713; val_kl_reg_loss: 42973.7914; val_edge_recon_loss: 8088960.4960; val_gene_expr_recon_loss: 17551935.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25683869.5709; val_optim_loss: 25683869.5709
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9379; val_auprc_score: 0.9864; val_best_acc_score: 0.9292; val_best_f1_score: 0.9593; train_kl_reg_loss: 48236.7129; train_edge_recon_loss: 7823726.0557; train_gene_expr_recon_loss: 17453609.2297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25325572.0000; train_optim_loss: 25325572.0000; val_kl_reg_loss: 42917.5911; val_edge_recon_loss: 8131833.9008; val_gene_expr_recon_loss: 17528415.8866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25703167.3684; val_optim_loss: 25703167.3684
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9399; val_auprc_score: 0.9869; val_best_acc_score: 0.9300; val_best_f1_score: 0.9598; train_kl_reg_loss: 48138.3321; train_edge_recon_loss: 7846352.0411; train_gene_expr_recon_loss: 17445805.7811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25340296.1796; train_optim_loss: 25340296.1796; val_kl_reg_loss: 42996.8488; val_edge_recon_loss: 8085083.2206; val_gene_expr_recon_loss: 17542717.9514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25670798.0000; val_optim_loss: 25670798.0000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9391; val_auprc_score: 0.9868; val_best_acc_score: 0.9299; val_best_f1_score: 0.9597; train_kl_reg_loss: 48166.7140; train_edge_recon_loss: 7837823.9269; train_gene_expr_recon_loss: 17452418.9522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25338409.6101; train_optim_loss: 25338409.6101; val_kl_reg_loss: 42979.2335; val_edge_recon_loss: 8020899.0081; val_gene_expr_recon_loss: 17552650.2186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25616528.3887; val_optim_loss: 25616528.3887
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9407; val_auprc_score: 0.9870; val_best_acc_score: 0.9310; val_best_f1_score: 0.9602; train_kl_reg_loss: 48135.8643; train_edge_recon_loss: 7835868.2421; train_gene_expr_recon_loss: 17435454.7518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25319458.8592; train_optim_loss: 25319458.8592; val_kl_reg_loss: 42995.8047; val_edge_recon_loss: 8072822.8279; val_gene_expr_recon_loss: 17539545.4291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25655364.0243; val_optim_loss: 25655364.0243
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9390; val_auprc_score: 0.9866; val_best_acc_score: 0.9296; val_best_f1_score: 0.9595; train_kl_reg_loss: 48122.7311; train_edge_recon_loss: 7848521.8306; train_gene_expr_recon_loss: 17442811.4170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25339455.9720; train_optim_loss: 25339455.9720; val_kl_reg_loss: 43013.8595; val_edge_recon_loss: 8113143.8603; val_gene_expr_recon_loss: 17551724.3279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25707882.0729; val_optim_loss: 25707882.0729
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.9389; val_auprc_score: 0.9866; val_best_acc_score: 0.9296; val_best_f1_score: 0.9595; train_kl_reg_loss: 48154.3526; train_edge_recon_loss: 7824399.6634; train_gene_expr_recon_loss: 17442617.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25315171.4143; train_optim_loss: 25315171.4143; val_kl_reg_loss: 43077.6888; val_edge_recon_loss: 8121460.6053; val_gene_expr_recon_loss: 17533650.5182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25698188.8502; val_optim_loss: 25698188.8502
Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9399; val_auprc_score: 0.9870; val_best_acc_score: 0.9300; val_best_f1_score: 0.9597; train_kl_reg_loss: 48136.6925; train_edge_recon_loss: 7814927.2978; train_gene_expr_recon_loss: 17439214.7306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25302278.6913; train_optim_loss: 25302278.6913; val_kl_reg_loss: 43075.5219; val_edge_recon_loss: 8114398.4069; val_gene_expr_recon_loss: 17541612.1174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25699086.0648; val_optim_loss: 25699086.0648

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.9389; val_auprc_score: 0.9864; val_best_acc_score: 0.9297; val_best_f1_score: 0.9595; train_kl_reg_loss: 48095.8748; train_edge_recon_loss: 7832742.6045; train_gene_expr_recon_loss: 17430258.1643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25311096.6552; train_optim_loss: 25311096.6552; val_kl_reg_loss: 43057.4373; val_edge_recon_loss: 8163017.4777; val_gene_expr_recon_loss: 17546972.2996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25753047.1903; val_optim_loss: 25753047.1903
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.9390; val_auprc_score: 0.9864; val_best_acc_score: 0.9289; val_best_f1_score: 0.9590; train_kl_reg_loss: 48077.7786; train_edge_recon_loss: 7834391.5839; train_gene_expr_recon_loss: 17434804.4003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25317273.7843; train_optim_loss: 25317273.7843; val_kl_reg_loss: 42978.5882; val_edge_recon_loss: 8207137.8300; val_gene_expr_recon_loss: 17533667.8300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25783784.2267; val_optim_loss: 25783784.2267
Epoch 70/400 |███-----------------| 17.5% val_auroc_score: 0.9389; val_auprc_score: 0.9864; val_best_acc_score: 0.9295; val_best_f1_score: 0.9594; train_kl_reg_loss: 48085.2226; train_edge_recon_loss: 7849102.3028; train_gene_expr_recon_loss: 17435471.7744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25332659.3096; train_optim_loss: 25332659.3096; val_kl_reg_loss: 43066.0263; val_edge_recon_loss: 8142527.0425; val_gene_expr_recon_loss: 17544665.9676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25730258.9474; val_optim_loss: 25730258.9474
Epoch 71/400 |███-----------------| 17.8% val_auroc_score: 0.9387; val_auprc_score: 0.9866; val_best_acc_score: 0.9296; val_best_f1_score: 0.9595; train_kl_reg_loss: 48111.1848; train_edge_recon_loss: 7813063.9273; train_gene_expr_recon_loss: 17433606.6778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25294781.7717; train_optim_loss: 25294781.7717; val_kl_reg_loss: 43003.1093; val_edge_recon_loss: 8103797.7389; val_gene_expr_recon_loss: 17533328.8745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25680129.7085; val_optim_loss: 25680129.7085

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 648 min 55 sec.
Using best model state, which was in epoch 63.

--- MODEL EVALUATION ---
val AUROC score: 0.9394
val AUPRC score: 0.9868
val best accuracy score: 0.9303
val best F1 score: 0.9599
val target rna MSE score: 0.4986
val source rna MSE score: 0.1698
Val cat covariate0 mean sim diff: -0.0003
Val cat covariate1 mean sim diff: -0.0609
Val cat covariate2 mean sim diff: 0.0004

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
