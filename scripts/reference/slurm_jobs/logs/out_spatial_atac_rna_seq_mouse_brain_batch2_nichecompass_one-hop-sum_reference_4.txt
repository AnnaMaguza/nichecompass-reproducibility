[True]
Run timestamp: 10082023_182716_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7873; val_auprc_score: 0.8066; val_best_acc_score: 0.6062; val_best_f1_score: 0.7081; train_kl_reg_loss: 218517.9181; train_edge_recon_loss: 3874009.4237; train_gene_expr_recon_loss: 28068394.5954; train_masked_gp_l1_reg_loss: 74662.8551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244341.8813; train_chrom_access_recon_loss: 25496529.1450; train_global_loss: 57976455.9389; train_optim_loss: 57976455.9389; val_kl_reg_loss: 240571.7135; val_edge_recon_loss: 4059697.7333; val_gene_expr_recon_loss: 23469143.6000; val_masked_gp_l1_reg_loss: 69688.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239545.7031; val_chrom_access_recon_loss: 23384959.0667; val_global_loss: 51463605.8667; val_optim_loss: 51463605.8667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8194; val_auprc_score: 0.8340; val_best_acc_score: 0.7226; val_best_f1_score: 0.7228; train_kl_reg_loss: 224569.9784; train_edge_recon_loss: 3699582.1641; train_gene_expr_recon_loss: 22853329.0687; train_masked_gp_l1_reg_loss: 67884.9696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232690.5296; train_chrom_access_recon_loss: 23164358.6565; train_global_loss: 50242415.3588; train_optim_loss: 50242415.3588; val_kl_reg_loss: 202247.7615; val_edge_recon_loss: 4015874.1833; val_gene_expr_recon_loss: 22739200.8000; val_masked_gp_l1_reg_loss: 68347.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225420.9062; val_chrom_access_recon_loss: 23232954.2667; val_global_loss: 50484044.5333; val_optim_loss: 50484044.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8478; val_auprc_score: 0.8589; val_best_acc_score: 0.7643; val_best_f1_score: 0.7641; train_kl_reg_loss: 185814.6604; train_edge_recon_loss: 3522919.8359; train_gene_expr_recon_loss: 22413781.4962; train_masked_gp_l1_reg_loss: 69438.7442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217914.7697; train_chrom_access_recon_loss: 23005805.2672; train_global_loss: 49415674.9618; train_optim_loss: 49415674.9618; val_kl_reg_loss: 181352.6917; val_edge_recon_loss: 3498409.0667; val_gene_expr_recon_loss: 22308055.8667; val_masked_gp_l1_reg_loss: 70590.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209991.7656; val_chrom_access_recon_loss: 22971192.5333; val_global_loss: 49239592.2667; val_optim_loss: 49239592.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9104; val_auprc_score: 0.9012; val_best_acc_score: 0.8321; val_best_f1_score: 0.8391; train_kl_reg_loss: 203673.5938; train_edge_recon_loss: 3159769.9103; train_gene_expr_recon_loss: 22140119.4198; train_masked_gp_l1_reg_loss: 72065.6205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 202210.2793; train_chrom_access_recon_loss: 22829018.7328; train_global_loss: 48606857.4351; train_optim_loss: 48606857.4351; val_kl_reg_loss: 209360.7760; val_edge_recon_loss: 3023012.2000; val_gene_expr_recon_loss: 22195569.7333; val_masked_gp_l1_reg_loss: 73358.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 194430.5156; val_chrom_access_recon_loss: 23021747.2000; val_global_loss: 48717478.4000; val_optim_loss: 48717478.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9280; val_auprc_score: 0.9162; val_best_acc_score: 0.8552; val_best_f1_score: 0.8623; train_kl_reg_loss: 214512.1604; train_edge_recon_loss: 2952068.1698; train_gene_expr_recon_loss: 21938625.5725; train_masked_gp_l1_reg_loss: 74600.5138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187077.3551; train_chrom_access_recon_loss: 22636128.1374; train_global_loss: 48003011.9695; train_optim_loss: 48003011.9695; val_kl_reg_loss: 206603.7031; val_edge_recon_loss: 2930999.2000; val_gene_expr_recon_loss: 21973858.1333; val_masked_gp_l1_reg_loss: 75904.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179789.3125; val_chrom_access_recon_loss: 22731420.8000; val_global_loss: 48098576.2667; val_optim_loss: 48098576.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9306; val_auprc_score: 0.9136; val_best_acc_score: 0.8632; val_best_f1_score: 0.8705; train_kl_reg_loss: 203074.5519; train_edge_recon_loss: 2906854.4332; train_gene_expr_recon_loss: 21808685.4198; train_masked_gp_l1_reg_loss: 77257.0853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173083.4429; train_chrom_access_recon_loss: 22563617.2061; train_global_loss: 47732571.9084; train_optim_loss: 47732571.9084; val_kl_reg_loss: 199461.4969; val_edge_recon_loss: 2917776.4333; val_gene_expr_recon_loss: 21815582.6667; val_masked_gp_l1_reg_loss: 78468.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166561.3281; val_chrom_access_recon_loss: 22656932.1333; val_global_loss: 47834783.2000; val_optim_loss: 47834783.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9352; val_auprc_score: 0.9225; val_best_acc_score: 0.8655; val_best_f1_score: 0.8746; train_kl_reg_loss: 195132.7659; train_edge_recon_loss: 2877319.3969; train_gene_expr_recon_loss: 21626706.1374; train_masked_gp_l1_reg_loss: 79531.2489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160655.3214; train_chrom_access_recon_loss: 22400653.3740; train_global_loss: 47339998.1985; train_optim_loss: 47339998.1985; val_kl_reg_loss: 191922.2875; val_edge_recon_loss: 2880884.2833; val_gene_expr_recon_loss: 21731915.3333; val_masked_gp_l1_reg_loss: 80784.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154971.7031; val_chrom_access_recon_loss: 22661444.6667; val_global_loss: 47701922.6667; val_optim_loss: 47701922.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9397; val_auprc_score: 0.9270; val_best_acc_score: 0.8712; val_best_f1_score: 0.8799; train_kl_reg_loss: 185662.3131; train_edge_recon_loss: 2856708.8073; train_gene_expr_recon_loss: 21542851.3282; train_masked_gp_l1_reg_loss: 81823.2826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149796.5584; train_chrom_access_recon_loss: 22372172.6718; train_global_loss: 47189014.9618; train_optim_loss: 47189014.9618; val_kl_reg_loss: 180874.1146; val_edge_recon_loss: 2858376.1167; val_gene_expr_recon_loss: 21538291.3333; val_masked_gp_l1_reg_loss: 82998.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144781.0156; val_chrom_access_recon_loss: 22420830.2667; val_global_loss: 47226151.4667; val_optim_loss: 47226151.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9469; val_auprc_score: 0.9364; val_best_acc_score: 0.8822; val_best_f1_score: 0.8880; train_kl_reg_loss: 177699.6365; train_edge_recon_loss: 2847012.8359; train_gene_expr_recon_loss: 21407025.4046; train_masked_gp_l1_reg_loss: 84047.9648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140069.1623; train_chrom_access_recon_loss: 22210607.7099; train_global_loss: 46866462.7786; train_optim_loss: 46866462.7786; val_kl_reg_loss: 179932.6865; val_edge_recon_loss: 2838740.4500; val_gene_expr_recon_loss: 21482811.4667; val_masked_gp_l1_reg_loss: 85122.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135598.7812; val_chrom_access_recon_loss: 22297992.2667; val_global_loss: 47020196.8000; val_optim_loss: 47020196.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9550; val_auprc_score: 0.9458; val_best_acc_score: 0.8959; val_best_f1_score: 0.9009; train_kl_reg_loss: 171698.4332; train_edge_recon_loss: 2835908.6240; train_gene_expr_recon_loss: 21309999.1908; train_masked_gp_l1_reg_loss: 86133.5531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131198.3065; train_chrom_access_recon_loss: 22109068.0763; train_global_loss: 46644006.3206; train_optim_loss: 46644006.3206; val_kl_reg_loss: 169933.7406; val_edge_recon_loss: 2822798.4167; val_gene_expr_recon_loss: 21353883.2000; val_masked_gp_l1_reg_loss: 87071.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126995.9219; val_chrom_access_recon_loss: 22202169.2000; val_global_loss: 46762852.2667; val_optim_loss: 46762852.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9533; val_auprc_score: 0.9421; val_best_acc_score: 0.8925; val_best_f1_score: 0.8983; train_kl_reg_loss: 165359.8944; train_edge_recon_loss: 2813881.0592; train_gene_expr_recon_loss: 21230337.8168; train_masked_gp_l1_reg_loss: 88170.3355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123137.2266; train_chrom_access_recon_loss: 22029475.0229; train_global_loss: 46450361.4046; train_optim_loss: 46450361.4046; val_kl_reg_loss: 164459.3104; val_edge_recon_loss: 2810967.3333; val_gene_expr_recon_loss: 21427161.3333; val_masked_gp_l1_reg_loss: 89251.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119380.6641; val_chrom_access_recon_loss: 22229701.4667; val_global_loss: 46840921.3333; val_optim_loss: 46840921.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9561; val_auprc_score: 0.9482; val_best_acc_score: 0.8965; val_best_f1_score: 0.9012; train_kl_reg_loss: 160432.2151; train_edge_recon_loss: 2798275.6756; train_gene_expr_recon_loss: 21142537.4046; train_masked_gp_l1_reg_loss: 90385.0956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115905.2163; train_chrom_access_recon_loss: 21944056.2595; train_global_loss: 46251591.8473; train_optim_loss: 46251591.8473; val_kl_reg_loss: 153017.3615; val_edge_recon_loss: 2803703.1667; val_gene_expr_recon_loss: 21319859.4667; val_masked_gp_l1_reg_loss: 91900.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112587.1719; val_chrom_access_recon_loss: 22129516.9333; val_global_loss: 46610585.0667; val_optim_loss: 46610585.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9607; val_auprc_score: 0.9527; val_best_acc_score: 0.9015; val_best_f1_score: 0.9049; train_kl_reg_loss: 156684.9229; train_edge_recon_loss: 2801478.4771; train_gene_expr_recon_loss: 21102466.0153; train_masked_gp_l1_reg_loss: 92461.5846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109388.1442; train_chrom_access_recon_loss: 21898523.3893; train_global_loss: 46161002.7176; train_optim_loss: 46161002.7176; val_kl_reg_loss: 154725.3802; val_edge_recon_loss: 2817379.4000; val_gene_expr_recon_loss: 21240058.5333; val_masked_gp_l1_reg_loss: 93327.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106306.8828; val_chrom_access_recon_loss: 22116373.7333; val_global_loss: 46528170.9333; val_optim_loss: 46528170.9333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9682; val_auprc_score: 0.9605; val_best_acc_score: 0.9146; val_best_f1_score: 0.9171; train_kl_reg_loss: 152479.8959; train_edge_recon_loss: 2789732.8588; train_gene_expr_recon_loss: 21050815.0382; train_masked_gp_l1_reg_loss: 94173.2684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103444.3069; train_chrom_access_recon_loss: 21855425.7710; train_global_loss: 46046071.0229; train_optim_loss: 46046071.0229; val_kl_reg_loss: 151659.0177; val_edge_recon_loss: 2781560.8500; val_gene_expr_recon_loss: 21097021.7333; val_masked_gp_l1_reg_loss: 95117.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100615.1641; val_chrom_access_recon_loss: 21907706.2667; val_global_loss: 46133682.4000; val_optim_loss: 46133682.4000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9669; val_auprc_score: 0.9580; val_best_acc_score: 0.9167; val_best_f1_score: 0.9199; train_kl_reg_loss: 149528.8843; train_edge_recon_loss: 2779366.0038; train_gene_expr_recon_loss: 20971009.0076; train_masked_gp_l1_reg_loss: 95936.1355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98062.4247; train_chrom_access_recon_loss: 21775394.5802; train_global_loss: 45869296.7939; train_optim_loss: 45869296.7939; val_kl_reg_loss: 148219.8323; val_edge_recon_loss: 2769176.3667; val_gene_expr_recon_loss: 21043597.0667; val_masked_gp_l1_reg_loss: 97016.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95478.4297; val_chrom_access_recon_loss: 21956531.3333; val_global_loss: 46110018.6667; val_optim_loss: 46110018.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9678; val_auprc_score: 0.9591; val_best_acc_score: 0.9146; val_best_f1_score: 0.9172; train_kl_reg_loss: 145709.5357; train_edge_recon_loss: 2772972.9065; train_gene_expr_recon_loss: 20925717.9084; train_masked_gp_l1_reg_loss: 97846.2796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93187.5348; train_chrom_access_recon_loss: 21739272.4275; train_global_loss: 45774706.5954; train_optim_loss: 45774706.5954; val_kl_reg_loss: 147506.3458; val_edge_recon_loss: 2781899.2500; val_gene_expr_recon_loss: 21017178.0000; val_masked_gp_l1_reg_loss: 98705.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90861.8828; val_chrom_access_recon_loss: 21779025.8667; val_global_loss: 45915177.6000; val_optim_loss: 45915177.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9719; val_auprc_score: 0.9654; val_best_acc_score: 0.9202; val_best_f1_score: 0.9229; train_kl_reg_loss: 144450.5905; train_edge_recon_loss: 2767638.8760; train_gene_expr_recon_loss: 20854509.4198; train_masked_gp_l1_reg_loss: 99606.5140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88688.7753; train_chrom_access_recon_loss: 21656753.5115; train_global_loss: 45611647.7863; train_optim_loss: 45611647.7863; val_kl_reg_loss: 143573.4885; val_edge_recon_loss: 2756864.8667; val_gene_expr_recon_loss: 21080404.4000; val_masked_gp_l1_reg_loss: 100480.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86508.7266; val_chrom_access_recon_loss: 22038940.2667; val_global_loss: 46206770.9333; val_optim_loss: 46206770.9333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9731; val_auprc_score: 0.9684; val_best_acc_score: 0.9206; val_best_f1_score: 0.9237; train_kl_reg_loss: 139972.2963; train_edge_recon_loss: 2768382.7615; train_gene_expr_recon_loss: 20803563.9237; train_masked_gp_l1_reg_loss: 101392.2053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84489.3494; train_chrom_access_recon_loss: 21615457.1145; train_global_loss: 45513257.7710; train_optim_loss: 45513257.7710; val_kl_reg_loss: 139020.0573; val_edge_recon_loss: 2760439.6000; val_gene_expr_recon_loss: 20954934.1333; val_masked_gp_l1_reg_loss: 102329.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82570.1562; val_chrom_access_recon_loss: 21698920.5333; val_global_loss: 45738213.6000; val_optim_loss: 45738213.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9728; val_auprc_score: 0.9672; val_best_acc_score: 0.9233; val_best_f1_score: 0.9255; train_kl_reg_loss: 137972.8817; train_edge_recon_loss: 2764413.6450; train_gene_expr_recon_loss: 20785655.6031; train_masked_gp_l1_reg_loss: 103216.5784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80711.8435; train_chrom_access_recon_loss: 21591920.6260; train_global_loss: 45463891.0840; train_optim_loss: 45463891.0840; val_kl_reg_loss: 134739.7469; val_edge_recon_loss: 2758774.1333; val_gene_expr_recon_loss: 20929407.7333; val_masked_gp_l1_reg_loss: 104013.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78746.2578; val_chrom_access_recon_loss: 21730173.8667; val_global_loss: 45735855.4667; val_optim_loss: 45735855.4667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9704; val_auprc_score: 0.9612; val_best_acc_score: 0.9212; val_best_f1_score: 0.9244; train_kl_reg_loss: 135741.5481; train_edge_recon_loss: 2757214.1221; train_gene_expr_recon_loss: 20730818.6260; train_masked_gp_l1_reg_loss: 104902.5661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77037.6134; train_chrom_access_recon_loss: 21519189.6489; train_global_loss: 45324903.9695; train_optim_loss: 45324903.9695; val_kl_reg_loss: 135506.3875; val_edge_recon_loss: 2765472.8333; val_gene_expr_recon_loss: 20903031.6000; val_masked_gp_l1_reg_loss: 105842.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75424.4219; val_chrom_access_recon_loss: 21692525.4667; val_global_loss: 45677802.1333; val_optim_loss: 45677802.1333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9688; val_auprc_score: 0.9603; val_best_acc_score: 0.9188; val_best_f1_score: 0.9223; train_kl_reg_loss: 133598.8473; train_edge_recon_loss: 2755677.6565; train_gene_expr_recon_loss: 20714836.1221; train_masked_gp_l1_reg_loss: 106735.6928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74010.9000; train_chrom_access_recon_loss: 21515684.4885; train_global_loss: 45300543.6031; train_optim_loss: 45300543.6031; val_kl_reg_loss: 128259.7260; val_edge_recon_loss: 2777941.2833; val_gene_expr_recon_loss: 20894658.9333; val_masked_gp_l1_reg_loss: 108315.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72623.3672; val_chrom_access_recon_loss: 21766633.2000; val_global_loss: 45748433.3333; val_optim_loss: 45748433.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9748; val_auprc_score: 0.9683; val_best_acc_score: 0.9275; val_best_f1_score: 0.9305; train_kl_reg_loss: 132967.3838; train_edge_recon_loss: 2743794.2252; train_gene_expr_recon_loss: 20665031.5115; train_masked_gp_l1_reg_loss: 109128.2067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71218.4481; train_chrom_access_recon_loss: 21469443.8473; train_global_loss: 45191583.5725; train_optim_loss: 45191583.5725; val_kl_reg_loss: 130802.6620; val_edge_recon_loss: 2749422.2667; val_gene_expr_recon_loss: 20834177.8667; val_masked_gp_l1_reg_loss: 110862.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69922.6406; val_chrom_access_recon_loss: 21689629.7333; val_global_loss: 45584816.8000; val_optim_loss: 45584816.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9739; val_auprc_score: 0.9665; val_best_acc_score: 0.9235; val_best_f1_score: 0.9259; train_kl_reg_loss: 131893.4581; train_edge_recon_loss: 2746133.9637; train_gene_expr_recon_loss: 20633806.8702; train_masked_gp_l1_reg_loss: 111412.0079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68731.5632; train_chrom_access_recon_loss: 21457867.0687; train_global_loss: 45149845.0687; train_optim_loss: 45149845.0687; val_kl_reg_loss: 129936.8911; val_edge_recon_loss: 2773530.0500; val_gene_expr_recon_loss: 20829224.6667; val_masked_gp_l1_reg_loss: 112322.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67421.2578; val_chrom_access_recon_loss: 21679829.2000; val_global_loss: 45592265.3333; val_optim_loss: 45592265.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9771; val_auprc_score: 0.9723; val_best_acc_score: 0.9341; val_best_f1_score: 0.9357; train_kl_reg_loss: 128947.6138; train_edge_recon_loss: 2739382.8321; train_gene_expr_recon_loss: 20612135.0534; train_masked_gp_l1_reg_loss: 112879.0993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66307.1037; train_chrom_access_recon_loss: 21458230.9313; train_global_loss: 45117882.5954; train_optim_loss: 45117882.5954; val_kl_reg_loss: 127023.7016; val_edge_recon_loss: 2749008.8000; val_gene_expr_recon_loss: 20744572.6667; val_masked_gp_l1_reg_loss: 113528.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65230.4336; val_chrom_access_recon_loss: 21485877.8667; val_global_loss: 45285241.3333; val_optim_loss: 45285241.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9780; val_auprc_score: 0.9719; val_best_acc_score: 0.9330; val_best_f1_score: 0.9353; train_kl_reg_loss: 127408.5992; train_edge_recon_loss: 2735354.8588; train_gene_expr_recon_loss: 20561804.7481; train_masked_gp_l1_reg_loss: 114371.0896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64191.9832; train_chrom_access_recon_loss: 21393125.0382; train_global_loss: 44996255.9084; train_optim_loss: 44996255.9084; val_kl_reg_loss: 125446.3036; val_edge_recon_loss: 2736672.7333; val_gene_expr_recon_loss: 20776587.4667; val_masked_gp_l1_reg_loss: 115216.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63193.5234; val_chrom_access_recon_loss: 21632909.6000; val_global_loss: 45450026.1333; val_optim_loss: 45450026.1333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9760; val_auprc_score: 0.9690; val_best_acc_score: 0.9321; val_best_f1_score: 0.9344; train_kl_reg_loss: 134017.6924; train_edge_recon_loss: 2791608.1660; train_gene_expr_recon_loss: 21353722.3664; train_masked_gp_l1_reg_loss: 114382.8352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62839.9043; train_chrom_access_recon_loss: 21619132.6260; train_global_loss: 46075703.4504; train_optim_loss: 46075703.4504; val_kl_reg_loss: 71629.7068; val_edge_recon_loss: 2763509.3500; val_gene_expr_recon_loss: 21357871.8667; val_masked_gp_l1_reg_loss: 114384.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61849.8594; val_chrom_access_recon_loss: 21723011.6000; val_global_loss: 46092256.2667; val_optim_loss: 46092256.2667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9747; val_auprc_score: 0.9694; val_best_acc_score: 0.9259; val_best_f1_score: 0.9270; train_kl_reg_loss: 126013.4287; train_edge_recon_loss: 2743284.3015; train_gene_expr_recon_loss: 21259163.1908; train_masked_gp_l1_reg_loss: 114645.6233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60785.2524; train_chrom_access_recon_loss: 21600424.7634; train_global_loss: 45904316.6718; train_optim_loss: 45904316.6718; val_kl_reg_loss: 75086.1229; val_edge_recon_loss: 2753298.1500; val_gene_expr_recon_loss: 21340395.4667; val_masked_gp_l1_reg_loss: 114793.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59831.1445; val_chrom_access_recon_loss: 21715797.0667; val_global_loss: 46059202.6667; val_optim_loss: 46059202.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9758; val_auprc_score: 0.9701; val_best_acc_score: 0.9291; val_best_f1_score: 0.9318; train_kl_reg_loss: 117468.4735; train_edge_recon_loss: 2729681.4790; train_gene_expr_recon_loss: 21189591.9542; train_masked_gp_l1_reg_loss: 114822.2427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58871.1077; train_chrom_access_recon_loss: 21576969.8473; train_global_loss: 45787405.1908; train_optim_loss: 45787405.1908; val_kl_reg_loss: 83644.5693; val_edge_recon_loss: 2730945.2667; val_gene_expr_recon_loss: 21324023.2000; val_masked_gp_l1_reg_loss: 114676.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57820.1172; val_chrom_access_recon_loss: 21779398.9333; val_global_loss: 46090508.5333; val_optim_loss: 46090508.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9749; val_auprc_score: 0.9685; val_best_acc_score: 0.9255; val_best_f1_score: 0.9277; train_kl_reg_loss: 114410.2347; train_edge_recon_loss: 2730116.4828; train_gene_expr_recon_loss: 21154981.7252; train_masked_gp_l1_reg_loss: 114215.1317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57453.8242; train_chrom_access_recon_loss: 21584394.7176; train_global_loss: 45755572.2748; train_optim_loss: 45755572.2748; val_kl_reg_loss: 84212.9255; val_edge_recon_loss: 2745291.2333; val_gene_expr_recon_loss: 21260845.8667; val_masked_gp_l1_reg_loss: 114061.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57186.3906; val_chrom_access_recon_loss: 21690710.5333; val_global_loss: 45952308.2667; val_optim_loss: 45952308.2667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9781; val_auprc_score: 0.9729; val_best_acc_score: 0.9262; val_best_f1_score: 0.9288; train_kl_reg_loss: 113670.8011; train_edge_recon_loss: 2721917.2748; train_gene_expr_recon_loss: 21127128.8855; train_masked_gp_l1_reg_loss: 113979.9501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56988.5725; train_chrom_access_recon_loss: 21537562.1832; train_global_loss: 45671247.8473; train_optim_loss: 45671247.8473; val_kl_reg_loss: 85325.9104; val_edge_recon_loss: 2733084.0500; val_gene_expr_recon_loss: 21300312.4000; val_masked_gp_l1_reg_loss: 113913.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56814.8555; val_chrom_access_recon_loss: 21739818.6667; val_global_loss: 46029268.8000; val_optim_loss: 46029268.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9749; val_auprc_score: 0.9698; val_best_acc_score: 0.9255; val_best_f1_score: 0.9279; train_kl_reg_loss: 113016.6670; train_edge_recon_loss: 2725218.7996; train_gene_expr_recon_loss: 21116528.0763; train_masked_gp_l1_reg_loss: 113854.0022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56683.9215; train_chrom_access_recon_loss: 21558741.7557; train_global_loss: 45684042.9924; train_optim_loss: 45684042.9924; val_kl_reg_loss: 85442.1698; val_edge_recon_loss: 2746611.3667; val_gene_expr_recon_loss: 21320872.6667; val_masked_gp_l1_reg_loss: 113800.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56468.6016; val_chrom_access_recon_loss: 21866953.3333; val_global_loss: 46190146.9333; val_optim_loss: 46190146.9333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9777; val_auprc_score: 0.9719; val_best_acc_score: 0.9301; val_best_f1_score: 0.9320; train_kl_reg_loss: 112037.3435; train_edge_recon_loss: 2718744.3378; train_gene_expr_recon_loss: 21149436.5191; train_masked_gp_l1_reg_loss: 113763.2585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56278.2261; train_chrom_access_recon_loss: 21583747.0687; train_global_loss: 45734006.6565; train_optim_loss: 45734006.6565; val_kl_reg_loss: 85490.8094; val_edge_recon_loss: 2741668.7667; val_gene_expr_recon_loss: 21305878.5333; val_masked_gp_l1_reg_loss: 113717.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56106.5430; val_chrom_access_recon_loss: 21781128.1333; val_global_loss: 46083989.8667; val_optim_loss: 46083989.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 52 min 32 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9773
val AUPRC score: 0.9725
val best accuracy score: 0.9321
val best F1 score: 0.9343
val target rna MSE score: 1.1436
val source rna MSE score: 33.1136
val target atac MSE score: 0.1279
val source atac MSE score: 1.7003
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
