[True]
Run timestamp: 09102023_230324_68.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_68']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6733; val_auprc_score: 0.6599; val_best_acc_score: 0.5040; val_best_f1_score: 0.6682; train_kl_reg_loss: 43599.7467; train_edge_recon_loss: 3521915.6667; train_gene_expr_recon_loss: 14078824.5909; train_masked_gp_l1_reg_loss: 94156.6802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2964260.0436; train_chrom_access_recon_loss: 3021542.0227; train_global_loss: 23724298.4848; train_optim_loss: 23724298.4848; val_kl_reg_loss: 64778.9199; val_edge_recon_loss: 4065118.7812; val_gene_expr_recon_loss: 13165290.1250; val_masked_gp_l1_reg_loss: 80874.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1646883.3750; val_chrom_access_recon_loss: 2880549.9688; val_global_loss: 21903496.2500; val_optim_loss: 21903496.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6999; val_auprc_score: 0.6708; val_best_acc_score: 0.5416; val_best_f1_score: 0.6830; train_kl_reg_loss: 84810.8179; train_edge_recon_loss: 3515931.9621; train_gene_expr_recon_loss: 12824233.0606; train_masked_gp_l1_reg_loss: 76956.1861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 900064.0000; train_chrom_access_recon_loss: 2845587.9886; train_global_loss: 20247584.0303; train_optim_loss: 20247584.0303; val_kl_reg_loss: 79549.6602; val_edge_recon_loss: 4062690.8438; val_gene_expr_recon_loss: 12708080.0000; val_masked_gp_l1_reg_loss: 74796.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 436167.6875; val_chrom_access_recon_loss: 2808637.5312; val_global_loss: 20169922.2500; val_optim_loss: 20169922.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7250; val_auprc_score: 0.7090; val_best_acc_score: 0.6494; val_best_f1_score: 0.7093; train_kl_reg_loss: 84747.3305; train_edge_recon_loss: 3512671.5795; train_gene_expr_recon_loss: 12630809.2121; train_masked_gp_l1_reg_loss: 74407.5810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 290427.6402; train_chrom_access_recon_loss: 2815272.8523; train_global_loss: 19408336.2121; train_optim_loss: 19408336.2121; val_kl_reg_loss: 83985.9199; val_edge_recon_loss: 4030745.7500; val_gene_expr_recon_loss: 12705805.5000; val_masked_gp_l1_reg_loss: 75243.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 196475.5156; val_chrom_access_recon_loss: 2815566.4062; val_global_loss: 19907822.7500; val_optim_loss: 19907822.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7724; val_auprc_score: 0.7523; val_best_acc_score: 0.6985; val_best_f1_score: 0.7392; train_kl_reg_loss: 72226.7382; train_edge_recon_loss: 3481470.6136; train_gene_expr_recon_loss: 12536957.1212; train_masked_gp_l1_reg_loss: 76660.8967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155296.4867; train_chrom_access_recon_loss: 2800123.2008; train_global_loss: 19122735.1212; train_optim_loss: 19122735.1212; val_kl_reg_loss: 63829.4556; val_edge_recon_loss: 3698964.4375; val_gene_expr_recon_loss: 12646794.5000; val_masked_gp_l1_reg_loss: 78837.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125093.0000; val_chrom_access_recon_loss: 2848524.3438; val_global_loss: 19462043.5000; val_optim_loss: 19462043.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8202; val_auprc_score: 0.7803; val_best_acc_score: 0.7431; val_best_f1_score: 0.7868; train_kl_reg_loss: 69381.6356; train_edge_recon_loss: 3188419.8333; train_gene_expr_recon_loss: 12496277.7424; train_masked_gp_l1_reg_loss: 84568.5001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110929.7517; train_chrom_access_recon_loss: 2789669.4280; train_global_loss: 18739246.9091; train_optim_loss: 18739246.9091; val_kl_reg_loss: 87810.4346; val_edge_recon_loss: 3047911.6562; val_gene_expr_recon_loss: 12790424.3750; val_masked_gp_l1_reg_loss: 92216.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101249.0078; val_chrom_access_recon_loss: 2818235.7500; val_global_loss: 18937848.2500; val_optim_loss: 18937848.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8426; val_auprc_score: 0.8170; val_best_acc_score: 0.7493; val_best_f1_score: 0.7921; train_kl_reg_loss: 99282.9600; train_edge_recon_loss: 2945355.8636; train_gene_expr_recon_loss: 12417521.9697; train_masked_gp_l1_reg_loss: 92921.2648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93617.9652; train_chrom_access_recon_loss: 2775849.9962; train_global_loss: 18424550.0000; train_optim_loss: 18424550.0000; val_kl_reg_loss: 94253.3096; val_edge_recon_loss: 2926126.2812; val_gene_expr_recon_loss: 12393832.8750; val_masked_gp_l1_reg_loss: 93212.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86328.6406; val_chrom_access_recon_loss: 2772461.4688; val_global_loss: 18366215.7500; val_optim_loss: 18366215.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8568; val_auprc_score: 0.8189; val_best_acc_score: 0.7684; val_best_f1_score: 0.8016; train_kl_reg_loss: 94514.9492; train_edge_recon_loss: 2953076.5417; train_gene_expr_recon_loss: 12348230.7273; train_masked_gp_l1_reg_loss: 93121.7425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80937.1081; train_chrom_access_recon_loss: 2759033.4924; train_global_loss: 18328914.4848; train_optim_loss: 18328914.4848; val_kl_reg_loss: 92982.6631; val_edge_recon_loss: 2844075.1875; val_gene_expr_recon_loss: 12540801.8750; val_masked_gp_l1_reg_loss: 93188.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76741.1875; val_chrom_access_recon_loss: 2788111.8750; val_global_loss: 18435901.5000; val_optim_loss: 18435901.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8564; val_auprc_score: 0.8117; val_best_acc_score: 0.7840; val_best_f1_score: 0.8043; train_kl_reg_loss: 94031.9461; train_edge_recon_loss: 2915480.2538; train_gene_expr_recon_loss: 12269724.5000; train_masked_gp_l1_reg_loss: 93545.8660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73225.6132; train_chrom_access_recon_loss: 2745071.0606; train_global_loss: 18191079.3939; train_optim_loss: 18191079.3939; val_kl_reg_loss: 89552.3379; val_edge_recon_loss: 2961963.7188; val_gene_expr_recon_loss: 12398408.7500; val_masked_gp_l1_reg_loss: 94067.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71012.9688; val_chrom_access_recon_loss: 2773477.5938; val_global_loss: 18388483.5000; val_optim_loss: 18388483.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8635; val_auprc_score: 0.8209; val_best_acc_score: 0.7950; val_best_f1_score: 0.8118; train_kl_reg_loss: 88688.8543; train_edge_recon_loss: 2905124.1780; train_gene_expr_recon_loss: 12213807.4091; train_masked_gp_l1_reg_loss: 94604.3815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69707.0389; train_chrom_access_recon_loss: 2733901.3750; train_global_loss: 18105833.1212; train_optim_loss: 18105833.1212; val_kl_reg_loss: 82408.1006; val_edge_recon_loss: 2918053.9688; val_gene_expr_recon_loss: 12405786.8750; val_masked_gp_l1_reg_loss: 95199.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69648.7656; val_chrom_access_recon_loss: 2766241.3125; val_global_loss: 18337338.2500; val_optim_loss: 18337338.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8650; val_auprc_score: 0.8231; val_best_acc_score: 0.8009; val_best_f1_score: 0.8223; train_kl_reg_loss: 83154.5256; train_edge_recon_loss: 2863422.0000; train_gene_expr_recon_loss: 12176460.6667; train_masked_gp_l1_reg_loss: 96221.0916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69371.3588; train_chrom_access_recon_loss: 2727414.8561; train_global_loss: 18016044.5758; train_optim_loss: 18016044.5758; val_kl_reg_loss: 87164.0996; val_edge_recon_loss: 2893995.8438; val_gene_expr_recon_loss: 12287091.1250; val_masked_gp_l1_reg_loss: 97272.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68239.2031; val_chrom_access_recon_loss: 2739692.4688; val_global_loss: 18173455.7500; val_optim_loss: 18173455.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8778; val_auprc_score: 0.8386; val_best_acc_score: 0.8165; val_best_f1_score: 0.8352; train_kl_reg_loss: 88925.6668; train_edge_recon_loss: 2828134.0795; train_gene_expr_recon_loss: 12115466.1212; train_masked_gp_l1_reg_loss: 97978.6323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67121.6858; train_chrom_access_recon_loss: 2715569.7273; train_global_loss: 17913195.9697; train_optim_loss: 17913195.9697; val_kl_reg_loss: 85954.0439; val_edge_recon_loss: 2873194.7188; val_gene_expr_recon_loss: 12245398.6250; val_masked_gp_l1_reg_loss: 99110.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66040.7031; val_chrom_access_recon_loss: 2729534.2188; val_global_loss: 18099233.7500; val_optim_loss: 18099233.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8893; val_auprc_score: 0.8503; val_best_acc_score: 0.8275; val_best_f1_score: 0.8425; train_kl_reg_loss: 90440.0956; train_edge_recon_loss: 2804842.4167; train_gene_expr_recon_loss: 12067666.0606; train_masked_gp_l1_reg_loss: 99483.8568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64348.3739; train_chrom_access_recon_loss: 2706737.3598; train_global_loss: 17833518.0303; train_optim_loss: 17833518.0303; val_kl_reg_loss: 87649.3584; val_edge_recon_loss: 2831546.2500; val_gene_expr_recon_loss: 12198665.0000; val_masked_gp_l1_reg_loss: 100482.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63767.0664; val_chrom_access_recon_loss: 2738685.3750; val_global_loss: 18020795.0000; val_optim_loss: 18020795.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9109; val_auprc_score: 0.8835; val_best_acc_score: 0.8436; val_best_f1_score: 0.8539; train_kl_reg_loss: 91061.6429; train_edge_recon_loss: 2792065.6212; train_gene_expr_recon_loss: 12034241.5000; train_masked_gp_l1_reg_loss: 100799.6269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62635.5668; train_chrom_access_recon_loss: 2697453.6326; train_global_loss: 17778257.5455; train_optim_loss: 17778257.5455; val_kl_reg_loss: 88564.8301; val_edge_recon_loss: 2767030.6562; val_gene_expr_recon_loss: 12353546.1250; val_masked_gp_l1_reg_loss: 101635.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62171.3477; val_chrom_access_recon_loss: 2776320.4062; val_global_loss: 18149268.2500; val_optim_loss: 18149268.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8992; val_auprc_score: 0.8619; val_best_acc_score: 0.8366; val_best_f1_score: 0.8506; train_kl_reg_loss: 90942.0875; train_edge_recon_loss: 2785245.3220; train_gene_expr_recon_loss: 11999469.5758; train_masked_gp_l1_reg_loss: 101841.4186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61146.8729; train_chrom_access_recon_loss: 2689776.8144; train_global_loss: 17728422.0303; train_optim_loss: 17728422.0303; val_kl_reg_loss: 90733.3076; val_edge_recon_loss: 2796840.8750; val_gene_expr_recon_loss: 12241206.8750; val_masked_gp_l1_reg_loss: 102152.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60488.8398; val_chrom_access_recon_loss: 2726589.5312; val_global_loss: 18018011.5000; val_optim_loss: 18018011.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9028; val_auprc_score: 0.8638; val_best_acc_score: 0.8423; val_best_f1_score: 0.8562; train_kl_reg_loss: 90227.4979; train_edge_recon_loss: 2768867.2235; train_gene_expr_recon_loss: 11957064.1818; train_masked_gp_l1_reg_loss: 102904.2004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60155.4412; train_chrom_access_recon_loss: 2680790.3295; train_global_loss: 17660008.7576; train_optim_loss: 17660008.7576; val_kl_reg_loss: 88547.2314; val_edge_recon_loss: 2821227.8438; val_gene_expr_recon_loss: 12114285.1250; val_masked_gp_l1_reg_loss: 103278.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60475.3906; val_chrom_access_recon_loss: 2694997.9688; val_global_loss: 17882811.5000; val_optim_loss: 17882811.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8957; val_auprc_score: 0.8574; val_best_acc_score: 0.8399; val_best_f1_score: 0.8548; train_kl_reg_loss: 89512.7036; train_edge_recon_loss: 2782661.1742; train_gene_expr_recon_loss: 11935724.9242; train_masked_gp_l1_reg_loss: 103585.2114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59766.4603; train_chrom_access_recon_loss: 2674822.8409; train_global_loss: 17646073.1818; train_optim_loss: 17646073.1818; val_kl_reg_loss: 89970.5068; val_edge_recon_loss: 2837633.7188; val_gene_expr_recon_loss: 12150820.0000; val_masked_gp_l1_reg_loss: 103977.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59549.9727; val_chrom_access_recon_loss: 2745695.4375; val_global_loss: 17987647.0000; val_optim_loss: 17987647.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9129; val_auprc_score: 0.8842; val_best_acc_score: 0.8506; val_best_f1_score: 0.8613; train_kl_reg_loss: 88564.6637; train_edge_recon_loss: 2762574.5076; train_gene_expr_recon_loss: 11905271.2727; train_masked_gp_l1_reg_loss: 104405.6755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59388.8889; train_chrom_access_recon_loss: 2668408.7992; train_global_loss: 17588613.9091; train_optim_loss: 17588613.9091; val_kl_reg_loss: 88621.7256; val_edge_recon_loss: 2790140.3438; val_gene_expr_recon_loss: 11935781.0000; val_masked_gp_l1_reg_loss: 104667.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59533.1367; val_chrom_access_recon_loss: 2667857.8438; val_global_loss: 17646600.8750; val_optim_loss: 17646600.8750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9134; val_auprc_score: 0.8822; val_best_acc_score: 0.8533; val_best_f1_score: 0.8628; train_kl_reg_loss: 88943.4688; train_edge_recon_loss: 2747590.2765; train_gene_expr_recon_loss: 11862872.0152; train_masked_gp_l1_reg_loss: 105049.3441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59808.1033; train_chrom_access_recon_loss: 2657208.2538; train_global_loss: 17521471.3939; train_optim_loss: 17521471.3939; val_kl_reg_loss: 87333.8809; val_edge_recon_loss: 2783717.2812; val_gene_expr_recon_loss: 11972373.8750; val_masked_gp_l1_reg_loss: 105202.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60099.9219; val_chrom_access_recon_loss: 2662773.3438; val_global_loss: 17671500.2500; val_optim_loss: 17671500.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9124; val_auprc_score: 0.8774; val_best_acc_score: 0.8568; val_best_f1_score: 0.8655; train_kl_reg_loss: 86423.3335; train_edge_recon_loss: 2765435.3750; train_gene_expr_recon_loss: 11825553.7727; train_masked_gp_l1_reg_loss: 105465.7763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59968.3395; train_chrom_access_recon_loss: 2650270.7955; train_global_loss: 17493117.5606; train_optim_loss: 17493117.5606; val_kl_reg_loss: 84539.6074; val_edge_recon_loss: 2787182.3750; val_gene_expr_recon_loss: 11937109.0000; val_masked_gp_l1_reg_loss: 106101.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60162.0742; val_chrom_access_recon_loss: 2647264.5000; val_global_loss: 17622358.7500; val_optim_loss: 17622358.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9210; val_auprc_score: 0.8972; val_best_acc_score: 0.8587; val_best_f1_score: 0.8680; train_kl_reg_loss: 84862.3413; train_edge_recon_loss: 2751620.1477; train_gene_expr_recon_loss: 11805298.3333; train_masked_gp_l1_reg_loss: 106229.9502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60205.3233; train_chrom_access_recon_loss: 2647989.7424; train_global_loss: 17456205.8788; train_optim_loss: 17456205.8788; val_kl_reg_loss: 85023.6221; val_edge_recon_loss: 2788451.7500; val_gene_expr_recon_loss: 11982838.6250; val_masked_gp_l1_reg_loss: 106394.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60034.9375; val_chrom_access_recon_loss: 2680171.3125; val_global_loss: 17702915.7500; val_optim_loss: 17702915.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9164; val_auprc_score: 0.8880; val_best_acc_score: 0.8571; val_best_f1_score: 0.8651; train_kl_reg_loss: 86509.3732; train_edge_recon_loss: 2739570.2652; train_gene_expr_recon_loss: 11783285.5303; train_masked_gp_l1_reg_loss: 106657.0574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59830.1749; train_chrom_access_recon_loss: 2639197.4545; train_global_loss: 17415049.7879; train_optim_loss: 17415049.7879; val_kl_reg_loss: 87504.3252; val_edge_recon_loss: 2806260.8750; val_gene_expr_recon_loss: 12059824.6250; val_masked_gp_l1_reg_loss: 106982.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59794.3828; val_chrom_access_recon_loss: 2676667.9375; val_global_loss: 17797035.0000; val_optim_loss: 17797035.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9291; val_auprc_score: 0.8981; val_best_acc_score: 0.8718; val_best_f1_score: 0.8796; train_kl_reg_loss: 85191.6802; train_edge_recon_loss: 2739315.6894; train_gene_expr_recon_loss: 11762370.8636; train_masked_gp_l1_reg_loss: 106944.1674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59813.3346; train_chrom_access_recon_loss: 2634157.5379; train_global_loss: 17387793.2576; train_optim_loss: 17387793.2576; val_kl_reg_loss: 84962.2275; val_edge_recon_loss: 2742933.7812; val_gene_expr_recon_loss: 12058154.6250; val_masked_gp_l1_reg_loss: 107330.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60013.7109; val_chrom_access_recon_loss: 2676078.9688; val_global_loss: 17729473.7500; val_optim_loss: 17729473.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9372; val_auprc_score: 0.9095; val_best_acc_score: 0.8794; val_best_f1_score: 0.8853; train_kl_reg_loss: 83509.8403; train_edge_recon_loss: 2743539.4508; train_gene_expr_recon_loss: 11741596.0606; train_masked_gp_l1_reg_loss: 107488.6924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59390.5149; train_chrom_access_recon_loss: 2628269.8068; train_global_loss: 17363794.1970; train_optim_loss: 17363794.1970; val_kl_reg_loss: 82631.3174; val_edge_recon_loss: 2723519.6562; val_gene_expr_recon_loss: 11875149.7500; val_masked_gp_l1_reg_loss: 107802.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59083.3359; val_chrom_access_recon_loss: 2666517.8438; val_global_loss: 17514703.7500; val_optim_loss: 17514703.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9246; val_auprc_score: 0.8989; val_best_acc_score: 0.8641; val_best_f1_score: 0.8752; train_kl_reg_loss: 82535.2506; train_edge_recon_loss: 2737494.9621; train_gene_expr_recon_loss: 11709830.1061; train_masked_gp_l1_reg_loss: 107967.1597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59259.9176; train_chrom_access_recon_loss: 2621772.6023; train_global_loss: 17318860.0152; train_optim_loss: 17318860.0152; val_kl_reg_loss: 81874.0879; val_edge_recon_loss: 2783854.0000; val_gene_expr_recon_loss: 11824225.3750; val_masked_gp_l1_reg_loss: 108217.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59435.2656; val_chrom_access_recon_loss: 2627133.3438; val_global_loss: 17484738.7500; val_optim_loss: 17484738.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9370; val_auprc_score: 0.9161; val_best_acc_score: 0.8764; val_best_f1_score: 0.8832; train_kl_reg_loss: 81606.7995; train_edge_recon_loss: 2734603.6136; train_gene_expr_recon_loss: 11690645.0758; train_masked_gp_l1_reg_loss: 108398.6250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58708.0555; train_chrom_access_recon_loss: 2618092.0871; train_global_loss: 17292054.3030; train_optim_loss: 17292054.3030; val_kl_reg_loss: 80235.0439; val_edge_recon_loss: 2776580.7188; val_gene_expr_recon_loss: 11861941.8750; val_masked_gp_l1_reg_loss: 108592.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58791.1211; val_chrom_access_recon_loss: 2641597.0000; val_global_loss: 17527738.7500; val_optim_loss: 17527738.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9296; val_auprc_score: 0.9038; val_best_acc_score: 0.8716; val_best_f1_score: 0.8789; train_kl_reg_loss: 106179.5675; train_edge_recon_loss: 2813261.0871; train_gene_expr_recon_loss: 11074636.0909; train_masked_gp_l1_reg_loss: 108884.2017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54777.6030; train_chrom_access_recon_loss: 2511825.3523; train_global_loss: 16669563.8788; train_optim_loss: 16669563.8788; val_kl_reg_loss: 39292.0034; val_edge_recon_loss: 2801093.4375; val_gene_expr_recon_loss: 11155498.6250; val_masked_gp_l1_reg_loss: 109125.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54219.8086; val_chrom_access_recon_loss: 2492820.7188; val_global_loss: 16652049.7500; val_optim_loss: 16652049.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9415; val_auprc_score: 0.9228; val_best_acc_score: 0.8764; val_best_f1_score: 0.8834; train_kl_reg_loss: 91028.3575; train_edge_recon_loss: 2752208.2614; train_gene_expr_recon_loss: 11034478.5152; train_masked_gp_l1_reg_loss: 109273.5547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54255.7318; train_chrom_access_recon_loss: 2480818.4924; train_global_loss: 16522063.0303; train_optim_loss: 16522063.0303; val_kl_reg_loss: 42994.5044; val_edge_recon_loss: 2783704.0000; val_gene_expr_recon_loss: 11125234.1250; val_masked_gp_l1_reg_loss: 109357.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54558.5547; val_chrom_access_recon_loss: 2481241.5938; val_global_loss: 16597091.1250; val_optim_loss: 16597091.1250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9348; val_auprc_score: 0.9097; val_best_acc_score: 0.8753; val_best_f1_score: 0.8823; train_kl_reg_loss: 82142.1610; train_edge_recon_loss: 2737414.1364; train_gene_expr_recon_loss: 10999103.4091; train_masked_gp_l1_reg_loss: 109269.4184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54511.9408; train_chrom_access_recon_loss: 2473912.4432; train_global_loss: 16456353.6061; train_optim_loss: 16456353.6061; val_kl_reg_loss: 50788.4277; val_edge_recon_loss: 2808499.2500; val_gene_expr_recon_loss: 11107241.1250; val_masked_gp_l1_reg_loss: 109084.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54489.4883; val_chrom_access_recon_loss: 2479250.2500; val_global_loss: 16609352.0000; val_optim_loss: 16609352.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9452; val_auprc_score: 0.9250; val_best_acc_score: 0.8861; val_best_f1_score: 0.8918; train_kl_reg_loss: 76075.8076; train_edge_recon_loss: 2725064.1402; train_gene_expr_recon_loss: 10993276.0152; train_masked_gp_l1_reg_loss: 108742.6675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54452.1895; train_chrom_access_recon_loss: 2473978.8902; train_global_loss: 16431589.8788; train_optim_loss: 16431589.8788; val_kl_reg_loss: 53007.4141; val_edge_recon_loss: 2722332.5625; val_gene_expr_recon_loss: 11063916.6250; val_masked_gp_l1_reg_loss: 108369.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54516.5273; val_chrom_access_recon_loss: 2495531.7188; val_global_loss: 16497675.6250; val_optim_loss: 16497675.6250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9471; val_auprc_score: 0.9299; val_best_acc_score: 0.8872; val_best_f1_score: 0.8914; train_kl_reg_loss: 69836.1844; train_edge_recon_loss: 2723214.6667; train_gene_expr_recon_loss: 10973443.1667; train_masked_gp_l1_reg_loss: 108040.5661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54437.7517; train_chrom_access_recon_loss: 2467560.2765; train_global_loss: 16396532.6212; train_optim_loss: 16396532.6212; val_kl_reg_loss: 53972.3643; val_edge_recon_loss: 2756473.5938; val_gene_expr_recon_loss: 11212702.2500; val_masked_gp_l1_reg_loss: 107823.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54347.6172; val_chrom_access_recon_loss: 2491604.9375; val_global_loss: 16676925.3750; val_optim_loss: 16676925.3750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9415; val_auprc_score: 0.9170; val_best_acc_score: 0.8861; val_best_f1_score: 0.8922; train_kl_reg_loss: 69082.9949; train_edge_recon_loss: 2713732.3030; train_gene_expr_recon_loss: 10956307.8182; train_masked_gp_l1_reg_loss: 107508.1680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54266.2721; train_chrom_access_recon_loss: 2464323.7614; train_global_loss: 16365221.2424; train_optim_loss: 16365221.2424; val_kl_reg_loss: 58643.8677; val_edge_recon_loss: 2718735.8438; val_gene_expr_recon_loss: 11117551.1250; val_masked_gp_l1_reg_loss: 107297.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54187.1875; val_chrom_access_recon_loss: 2493058.5000; val_global_loss: 16549474.2500; val_optim_loss: 16549474.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9372; val_auprc_score: 0.9060; val_best_acc_score: 0.8818; val_best_f1_score: 0.8870; train_kl_reg_loss: 68560.5121; train_edge_recon_loss: 2707609.7424; train_gene_expr_recon_loss: 10929397.2424; train_masked_gp_l1_reg_loss: 106811.5437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54271.9407; train_chrom_access_recon_loss: 2460992.0909; train_global_loss: 16327643.0758; train_optim_loss: 16327643.0758; val_kl_reg_loss: 58185.4258; val_edge_recon_loss: 2747584.9375; val_gene_expr_recon_loss: 10930806.7500; val_masked_gp_l1_reg_loss: 106239.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54462.0195; val_chrom_access_recon_loss: 2464915.1562; val_global_loss: 16362194.2500; val_optim_loss: 16362194.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9392; val_auprc_score: 0.9088; val_best_acc_score: 0.8845; val_best_f1_score: 0.8899; train_kl_reg_loss: 66659.4237; train_edge_recon_loss: 2712379.0455; train_gene_expr_recon_loss: 10917123.3788; train_masked_gp_l1_reg_loss: 106024.4364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54271.0912; train_chrom_access_recon_loss: 2457183.0682; train_global_loss: 16313640.4091; train_optim_loss: 16313640.4091; val_kl_reg_loss: 58232.7842; val_edge_recon_loss: 2749364.9062; val_gene_expr_recon_loss: 10959799.2500; val_masked_gp_l1_reg_loss: 105754.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54031.3281; val_chrom_access_recon_loss: 2452704.6250; val_global_loss: 16379887.7500; val_optim_loss: 16379887.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9483; val_auprc_score: 0.9354; val_best_acc_score: 0.8839; val_best_f1_score: 0.8925; train_kl_reg_loss: 65639.9492; train_edge_recon_loss: 2703841.0758; train_gene_expr_recon_loss: 10899670.9545; train_masked_gp_l1_reg_loss: 105390.3699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54266.5990; train_chrom_access_recon_loss: 2451180.0341; train_global_loss: 16279988.8788; train_optim_loss: 16279988.8788; val_kl_reg_loss: 60219.3037; val_edge_recon_loss: 2747348.1250; val_gene_expr_recon_loss: 11096784.1250; val_masked_gp_l1_reg_loss: 105118.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54175.5977; val_chrom_access_recon_loss: 2502097.1875; val_global_loss: 16565742.7500; val_optim_loss: 16565742.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9432; val_auprc_score: 0.9227; val_best_acc_score: 0.8837; val_best_f1_score: 0.8898; train_kl_reg_loss: 66806.6750; train_edge_recon_loss: 2695430.1250; train_gene_expr_recon_loss: 10884324.4545; train_masked_gp_l1_reg_loss: 104815.0584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54029.6457; train_chrom_access_recon_loss: 2448611.1023; train_global_loss: 16254017.0000; train_optim_loss: 16254017.0000; val_kl_reg_loss: 59958.2808; val_edge_recon_loss: 2754589.7188; val_gene_expr_recon_loss: 11061372.2500; val_masked_gp_l1_reg_loss: 104481.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53962.0430; val_chrom_access_recon_loss: 2476334.4688; val_global_loss: 16510697.7500; val_optim_loss: 16510697.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9492; val_auprc_score: 0.9242; val_best_acc_score: 0.8963; val_best_f1_score: 0.9003; train_kl_reg_loss: 66872.3411; train_edge_recon_loss: 2700681.4811; train_gene_expr_recon_loss: 10874196.7879; train_masked_gp_l1_reg_loss: 104335.1294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54032.1525; train_chrom_access_recon_loss: 2447961.2386; train_global_loss: 16248079.1212; train_optim_loss: 16248079.1212; val_kl_reg_loss: 60478.7998; val_edge_recon_loss: 2747623.3125; val_gene_expr_recon_loss: 10902151.8750; val_masked_gp_l1_reg_loss: 104199.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53976.1992; val_chrom_access_recon_loss: 2461262.0938; val_global_loss: 16329691.8750; val_optim_loss: 16329691.8750
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9464; val_auprc_score: 0.9276; val_best_acc_score: 0.8882; val_best_f1_score: 0.8949; train_kl_reg_loss: 66393.8385; train_edge_recon_loss: 2698389.4091; train_gene_expr_recon_loss: 10858811.4545; train_masked_gp_l1_reg_loss: 103868.7319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53881.3594; train_chrom_access_recon_loss: 2442989.4848; train_global_loss: 16224334.3030; train_optim_loss: 16224334.3030; val_kl_reg_loss: 60837.5117; val_edge_recon_loss: 2735254.1250; val_gene_expr_recon_loss: 11003257.2500; val_masked_gp_l1_reg_loss: 103701.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54057.6797; val_chrom_access_recon_loss: 2468425.1250; val_global_loss: 16425533.7500; val_optim_loss: 16425533.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9574; val_auprc_score: 0.9476; val_best_acc_score: 0.8992; val_best_f1_score: 0.9044; train_kl_reg_loss: 67160.8661; train_edge_recon_loss: 2707461.2045; train_gene_expr_recon_loss: 10839801.8182; train_masked_gp_l1_reg_loss: 103428.6473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53875.7337; train_chrom_access_recon_loss: 2440197.0455; train_global_loss: 16211925.2879; train_optim_loss: 16211925.2879; val_kl_reg_loss: 58358.3853; val_edge_recon_loss: 2728432.0312; val_gene_expr_recon_loss: 10995666.3750; val_masked_gp_l1_reg_loss: 103186.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53724.6016; val_chrom_access_recon_loss: 2462262.3125; val_global_loss: 16401631.2500; val_optim_loss: 16401631.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9458; val_auprc_score: 0.9255; val_best_acc_score: 0.8890; val_best_f1_score: 0.8949; train_kl_reg_loss: 68523.3058; train_edge_recon_loss: 2695840.8485; train_gene_expr_recon_loss: 10830036.7121; train_masked_gp_l1_reg_loss: 102988.6036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53673.7659; train_chrom_access_recon_loss: 2439295.7083; train_global_loss: 16190359.0152; train_optim_loss: 16190359.0152; val_kl_reg_loss: 61435.5757; val_edge_recon_loss: 2752808.4375; val_gene_expr_recon_loss: 10956415.2500; val_masked_gp_l1_reg_loss: 102654.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53531.5078; val_chrom_access_recon_loss: 2445795.8438; val_global_loss: 16372641.2500; val_optim_loss: 16372641.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9454; val_auprc_score: 0.9234; val_best_acc_score: 0.8928; val_best_f1_score: 0.8987; train_kl_reg_loss: 66936.6290; train_edge_recon_loss: 2701358.4773; train_gene_expr_recon_loss: 10818193.6818; train_masked_gp_l1_reg_loss: 102405.2515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53513.0671; train_chrom_access_recon_loss: 2437023.3902; train_global_loss: 16179430.4697; train_optim_loss: 16179430.4697; val_kl_reg_loss: 61716.4580; val_edge_recon_loss: 2735755.4688; val_gene_expr_recon_loss: 10957825.7500; val_masked_gp_l1_reg_loss: 102275.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53586.9961; val_chrom_access_recon_loss: 2458839.0625; val_global_loss: 16369999.0000; val_optim_loss: 16369999.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9511; val_auprc_score: 0.9348; val_best_acc_score: 0.8928; val_best_f1_score: 0.8978; train_kl_reg_loss: 67629.0218; train_edge_recon_loss: 2690426.1667; train_gene_expr_recon_loss: 10805427.3030; train_masked_gp_l1_reg_loss: 100472.2599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46042.1494; train_chrom_access_recon_loss: 2434950.1477; train_global_loss: 16144946.9091; train_optim_loss: 16144946.9091; val_kl_reg_loss: 62862.6880; val_edge_recon_loss: 2736393.8125; val_gene_expr_recon_loss: 11093781.7500; val_masked_gp_l1_reg_loss: 99811.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44448.0547; val_chrom_access_recon_loss: 2485502.5000; val_global_loss: 16522800.5000; val_optim_loss: 16522800.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9508; val_auprc_score: 0.9298; val_best_acc_score: 0.8990; val_best_f1_score: 0.9025; train_kl_reg_loss: 68261.2057; train_edge_recon_loss: 2695369.2083; train_gene_expr_recon_loss: 10795864.0455; train_masked_gp_l1_reg_loss: 99684.0951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44245.6155; train_chrom_access_recon_loss: 2430834.7348; train_global_loss: 16134258.8333; train_optim_loss: 16134258.8333; val_kl_reg_loss: 62471.6875; val_edge_recon_loss: 2707529.8438; val_gene_expr_recon_loss: 10867676.6250; val_masked_gp_l1_reg_loss: 99608.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44113.0078; val_chrom_access_recon_loss: 2440073.5312; val_global_loss: 16221473.7500; val_optim_loss: 16221473.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9431; val_auprc_score: 0.9173; val_best_acc_score: 0.8901; val_best_f1_score: 0.8953; train_kl_reg_loss: 69127.0984; train_edge_recon_loss: 2699683.4621; train_gene_expr_recon_loss: 10788123.5000; train_masked_gp_l1_reg_loss: 99534.3517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43975.0366; train_chrom_access_recon_loss: 2430999.6136; train_global_loss: 16131443.1515; train_optim_loss: 16131443.1515; val_kl_reg_loss: 62322.4111; val_edge_recon_loss: 2738624.1875; val_gene_expr_recon_loss: 10925594.2500; val_masked_gp_l1_reg_loss: 99484.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43835.0195; val_chrom_access_recon_loss: 2446638.2500; val_global_loss: 16316498.2500; val_optim_loss: 16316498.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9441; val_auprc_score: 0.9206; val_best_acc_score: 0.8898; val_best_f1_score: 0.8946; train_kl_reg_loss: 69053.4869; train_edge_recon_loss: 2687742.6705; train_gene_expr_recon_loss: 10787725.6061; train_masked_gp_l1_reg_loss: 99458.0752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43798.0558; train_chrom_access_recon_loss: 2431774.4659; train_global_loss: 16119552.1970; train_optim_loss: 16119552.1970; val_kl_reg_loss: 62605.8496; val_edge_recon_loss: 2727142.2188; val_gene_expr_recon_loss: 10852477.6250; val_masked_gp_l1_reg_loss: 99434.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43701.7109; val_chrom_access_recon_loss: 2425312.9688; val_global_loss: 16210674.6250; val_optim_loss: 16210674.6250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9482; val_auprc_score: 0.9283; val_best_acc_score: 0.8944; val_best_f1_score: 0.8984; train_kl_reg_loss: 69480.5221; train_edge_recon_loss: 2685601.5492; train_gene_expr_recon_loss: 10791865.8636; train_masked_gp_l1_reg_loss: 99405.1990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43629.7127; train_chrom_access_recon_loss: 2430208.1894; train_global_loss: 16120191.0455; train_optim_loss: 16120191.0455; val_kl_reg_loss: 62907.3188; val_edge_recon_loss: 2747425.4375; val_gene_expr_recon_loss: 10986185.7500; val_masked_gp_l1_reg_loss: 99393.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43570.6680; val_chrom_access_recon_loss: 2462845.9375; val_global_loss: 16402328.2500; val_optim_loss: 16402328.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9521; val_auprc_score: 0.9351; val_best_acc_score: 0.8982; val_best_f1_score: 0.9017; train_kl_reg_loss: 68938.3065; train_edge_recon_loss: 2678559.2765; train_gene_expr_recon_loss: 10793173.0606; train_masked_gp_l1_reg_loss: 99347.7010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43495.6358; train_chrom_access_recon_loss: 2432235.8068; train_global_loss: 16115749.8333; train_optim_loss: 16115749.8333; val_kl_reg_loss: 62257.1523; val_edge_recon_loss: 2713801.7188; val_gene_expr_recon_loss: 10916324.8750; val_masked_gp_l1_reg_loss: 99335.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43447.1914; val_chrom_access_recon_loss: 2482374.9062; val_global_loss: 16317541.8750; val_optim_loss: 16317541.8750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9503; val_auprc_score: 0.9274; val_best_acc_score: 0.8992; val_best_f1_score: 0.9026; train_kl_reg_loss: 69086.8074; train_edge_recon_loss: 2695246.8258; train_gene_expr_recon_loss: 10782686.2273; train_masked_gp_l1_reg_loss: 99310.8762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43401.9536; train_chrom_access_recon_loss: 2428528.8258; train_global_loss: 16118261.5909; train_optim_loss: 16118261.5909; val_kl_reg_loss: 63203.3550; val_edge_recon_loss: 2724034.2500; val_gene_expr_recon_loss: 11012975.7500; val_masked_gp_l1_reg_loss: 99286.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43287.4375; val_chrom_access_recon_loss: 2472254.1875; val_global_loss: 16415041.6250; val_optim_loss: 16415041.6250
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9491; val_auprc_score: 0.9301; val_best_acc_score: 0.8992; val_best_f1_score: 0.9027; train_kl_reg_loss: 69399.9183; train_edge_recon_loss: 2692901.0152; train_gene_expr_recon_loss: 10787444.5909; train_masked_gp_l1_reg_loss: 99267.6816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43245.3771; train_chrom_access_recon_loss: 2429301.6591; train_global_loss: 16121560.2576; train_optim_loss: 16121560.2576; val_kl_reg_loss: 62758.9414; val_edge_recon_loss: 2711432.9375; val_gene_expr_recon_loss: 11050156.0000; val_masked_gp_l1_reg_loss: 99239.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43177.7969; val_chrom_access_recon_loss: 2482996.3125; val_global_loss: 16449762.5000; val_optim_loss: 16449762.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9516; val_auprc_score: 0.9312; val_best_acc_score: 0.8984; val_best_f1_score: 0.9025; train_kl_reg_loss: 69463.8542; train_edge_recon_loss: 2693493.4356; train_gene_expr_recon_loss: 10791149.4394; train_masked_gp_l1_reg_loss: 99059.7101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42404.0546; train_chrom_access_recon_loss: 2432610.4659; train_global_loss: 16128181.0000; train_optim_loss: 16128181.0000; val_kl_reg_loss: 62362.4277; val_edge_recon_loss: 2713223.1875; val_gene_expr_recon_loss: 10949142.5000; val_masked_gp_l1_reg_loss: 98982.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42254.7266; val_chrom_access_recon_loss: 2473392.4688; val_global_loss: 16339358.1250; val_optim_loss: 16339358.1250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9511; val_auprc_score: 0.9357; val_best_acc_score: 0.8955; val_best_f1_score: 0.8993; train_kl_reg_loss: 69398.8233; train_edge_recon_loss: 2688519.5189; train_gene_expr_recon_loss: 10783694.1667; train_masked_gp_l1_reg_loss: 98960.1577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42238.4260; train_chrom_access_recon_loss: 2430337.5568; train_global_loss: 16113148.6515; train_optim_loss: 16113148.6515; val_kl_reg_loss: 62329.7500; val_edge_recon_loss: 2742163.1562; val_gene_expr_recon_loss: 10852576.8750; val_masked_gp_l1_reg_loss: 98942.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42223.4062; val_chrom_access_recon_loss: 2443619.4688; val_global_loss: 16241855.3750; val_optim_loss: 16241855.3750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9511; val_auprc_score: 0.9310; val_best_acc_score: 0.8947; val_best_f1_score: 0.8987; train_kl_reg_loss: 69324.4912; train_edge_recon_loss: 2690445.1477; train_gene_expr_recon_loss: 10778916.5455; train_masked_gp_l1_reg_loss: 98933.5844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42207.4124; train_chrom_access_recon_loss: 2429119.8674; train_global_loss: 16108947.0455; train_optim_loss: 16108947.0455; val_kl_reg_loss: 62973.0020; val_edge_recon_loss: 2692866.5938; val_gene_expr_recon_loss: 10894003.5000; val_masked_gp_l1_reg_loss: 98925.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42194.5469; val_chrom_access_recon_loss: 2461900.4375; val_global_loss: 16252864.7500; val_optim_loss: 16252864.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9476; val_auprc_score: 0.9267; val_best_acc_score: 0.8958; val_best_f1_score: 0.8996; train_kl_reg_loss: 69352.2205; train_edge_recon_loss: 2682111.4659; train_gene_expr_recon_loss: 10775739.0909; train_masked_gp_l1_reg_loss: 98920.1091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42187.1687; train_chrom_access_recon_loss: 2429338.0379; train_global_loss: 16097648.0455; train_optim_loss: 16097648.0455; val_kl_reg_loss: 62401.1006; val_edge_recon_loss: 2737705.5000; val_gene_expr_recon_loss: 10950576.0000; val_masked_gp_l1_reg_loss: 98913.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42177.2812; val_chrom_access_recon_loss: 2447935.7500; val_global_loss: 16339709.3750; val_optim_loss: 16339709.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 56 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9452
val AUPRC score: 0.9269
val best accuracy score: 0.8898
val best F1 score: 0.8941
val target rna MSE score: 1.5743
val source rna MSE score: 0.8409
val target atac MSE score: 0.4796
val source atac MSE score: 0.2031
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
