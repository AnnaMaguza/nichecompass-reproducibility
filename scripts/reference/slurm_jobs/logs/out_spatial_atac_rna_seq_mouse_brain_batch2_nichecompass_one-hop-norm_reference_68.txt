[True]
Run timestamp: 07082023_192711_68.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_68']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8936; val_auprc_score: 0.9079; val_best_acc_score: 0.5018; val_best_f1_score: 0.6674; train_kl_reg_loss: 19335.0963; train_edge_recon_loss: 349795.6979; train_gene_expr_recon_loss: 1279326.1389; train_masked_gp_l1_reg_loss: 8684.8848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119432.8299; train_chrom_access_recon_loss: 2570046.3194; train_global_loss: 4346620.8889; train_optim_loss: 4346620.8889; val_kl_reg_loss: 7115.5068; val_edge_recon_loss: 406539.6875; val_gene_expr_recon_loss: 1167690.7500; val_masked_gp_l1_reg_loss: 7323.5654; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117226.2812; val_chrom_access_recon_loss: 1690158.1250; val_global_loss: 3396054.0000; val_optim_loss: 3396054.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9118; val_auprc_score: 0.9186; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 6628.8294; train_edge_recon_loss: 351630.7917; train_gene_expr_recon_loss: 1084928.0764; train_masked_gp_l1_reg_loss: 6969.8719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115884.7778; train_chrom_access_recon_loss: 1539759.9861; train_global_loss: 3105802.3611; train_optim_loss: 3105802.3611; val_kl_reg_loss: 6936.0049; val_edge_recon_loss: 406555.7188; val_gene_expr_recon_loss: 1003091.7500; val_masked_gp_l1_reg_loss: 6821.7144; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114230.5938; val_chrom_access_recon_loss: 1510698.0000; val_global_loss: 3048334.0000; val_optim_loss: 3048334.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9089; val_auprc_score: 0.9134; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8692.2014; train_edge_recon_loss: 353823.7118; train_gene_expr_recon_loss: 951975.8125; train_masked_gp_l1_reg_loss: 7063.8955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112935.6250; train_chrom_access_recon_loss: 1448647.1806; train_global_loss: 2883138.5278; train_optim_loss: 2883138.5278; val_kl_reg_loss: 12368.5898; val_edge_recon_loss: 406580.9062; val_gene_expr_recon_loss: 887725.8750; val_masked_gp_l1_reg_loss: 7363.3545; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111331.7500; val_chrom_access_recon_loss: 1453294.2500; val_global_loss: 2878664.7500; val_optim_loss: 2878664.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9061; val_auprc_score: 0.9136; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 15331.8470; train_edge_recon_loss: 357910.6979; train_gene_expr_recon_loss: 849262.4722; train_masked_gp_l1_reg_loss: 7464.7327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110037.1970; train_chrom_access_recon_loss: 1411790.8333; train_global_loss: 2751797.8056; train_optim_loss: 2751797.8056; val_kl_reg_loss: 17063.9551; val_edge_recon_loss: 406590.6250; val_gene_expr_recon_loss: 805311.2500; val_masked_gp_l1_reg_loss: 7516.2090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108373.3672; val_chrom_access_recon_loss: 1413495.8750; val_global_loss: 2758351.5000; val_optim_loss: 2758351.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9007; val_auprc_score: 0.9078; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 17881.9345; train_edge_recon_loss: 359530.2292; train_gene_expr_recon_loss: 790357.5764; train_masked_gp_l1_reg_loss: 7520.6048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106941.6458; train_chrom_access_recon_loss: 1367837.8194; train_global_loss: 2650069.8056; train_optim_loss: 2650069.8056; val_kl_reg_loss: 18793.8730; val_edge_recon_loss: 406575.9688; val_gene_expr_recon_loss: 764854.6875; val_masked_gp_l1_reg_loss: 7510.7959; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105084.2969; val_chrom_access_recon_loss: 1382391.5000; val_global_loss: 2685211.0000; val_optim_loss: 2685211.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9050; val_auprc_score: 0.9096; val_best_acc_score: 0.5063; val_best_f1_score: 0.6695; train_kl_reg_loss: 19773.9041; train_edge_recon_loss: 359815.5243; train_gene_expr_recon_loss: 754131.8889; train_masked_gp_l1_reg_loss: 7486.4132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103499.9948; train_chrom_access_recon_loss: 1348085.3889; train_global_loss: 2592793.1389; train_optim_loss: 2592793.1389; val_kl_reg_loss: 20326.7461; val_edge_recon_loss: 406538.3750; val_gene_expr_recon_loss: 737450.6250; val_masked_gp_l1_reg_loss: 7429.8213; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101460.2969; val_chrom_access_recon_loss: 1368002.2500; val_global_loss: 2641208.0000; val_optim_loss: 2641208.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8992; val_auprc_score: 0.9009; val_best_acc_score: 0.5162; val_best_f1_score: 0.6736; train_kl_reg_loss: 20266.9646; train_edge_recon_loss: 359657.0764; train_gene_expr_recon_loss: 730463.5486; train_masked_gp_l1_reg_loss: 7387.3235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99746.2778; train_chrom_access_recon_loss: 1337906.3611; train_global_loss: 2555427.5833; train_optim_loss: 2555427.5833; val_kl_reg_loss: 20525.6094; val_edge_recon_loss: 406429.2500; val_gene_expr_recon_loss: 718129.0000; val_masked_gp_l1_reg_loss: 7323.2168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97564.7031; val_chrom_access_recon_loss: 1358036.7500; val_global_loss: 2608008.5000; val_optim_loss: 2608008.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8838; val_auprc_score: 0.8790; val_best_acc_score: 0.5604; val_best_f1_score: 0.6925; train_kl_reg_loss: 20932.1198; train_edge_recon_loss: 359367.3368; train_gene_expr_recon_loss: 715909.8194; train_masked_gp_l1_reg_loss: 7274.9650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95775.4158; train_chrom_access_recon_loss: 1333308.9444; train_global_loss: 2532568.6389; train_optim_loss: 2532568.6389; val_kl_reg_loss: 20000.9453; val_edge_recon_loss: 406101.0625; val_gene_expr_recon_loss: 703039.6875; val_masked_gp_l1_reg_loss: 7202.1655; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93517.7422; val_chrom_access_recon_loss: 1351445.2500; val_global_loss: 2581307.0000; val_optim_loss: 2581307.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8724; val_auprc_score: 0.8745; val_best_acc_score: 0.6404; val_best_f1_score: 0.7308; train_kl_reg_loss: 21508.8279; train_edge_recon_loss: 359286.2882; train_gene_expr_recon_loss: 699477.7292; train_masked_gp_l1_reg_loss: 7159.2782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91696.0634; train_chrom_access_recon_loss: 1323952.9583; train_global_loss: 2503081.1667; train_optim_loss: 2503081.1667; val_kl_reg_loss: 20817.3477; val_edge_recon_loss: 405605.2500; val_gene_expr_recon_loss: 691104.1250; val_masked_gp_l1_reg_loss: 7094.5947; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89412.8203; val_chrom_access_recon_loss: 1345840.8750; val_global_loss: 2559875.0000; val_optim_loss: 2559875.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8539; val_auprc_score: 0.8516; val_best_acc_score: 0.7092; val_best_f1_score: 0.7640; train_kl_reg_loss: 22115.0777; train_edge_recon_loss: 359384.0139; train_gene_expr_recon_loss: 687361.5069; train_masked_gp_l1_reg_loss: 7063.7752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87588.1693; train_chrom_access_recon_loss: 1321214.1528; train_global_loss: 2484726.7222; train_optim_loss: 2484726.7222; val_kl_reg_loss: 22494.7891; val_edge_recon_loss: 404795.8125; val_gene_expr_recon_loss: 682733.5000; val_masked_gp_l1_reg_loss: 7008.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85318.5312; val_chrom_access_recon_loss: 1341078.3750; val_global_loss: 2543429.7500; val_optim_loss: 2543429.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8351; val_auprc_score: 0.8265; val_best_acc_score: 0.7406; val_best_f1_score: 0.7688; train_kl_reg_loss: 22754.8780; train_edge_recon_loss: 359148.6632; train_gene_expr_recon_loss: 682459.1319; train_masked_gp_l1_reg_loss: 6976.5895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83529.9679; train_chrom_access_recon_loss: 1315732.6111; train_global_loss: 2470601.8889; train_optim_loss: 2470601.8889; val_kl_reg_loss: 22581.7129; val_edge_recon_loss: 403385.0938; val_gene_expr_recon_loss: 675989.6250; val_masked_gp_l1_reg_loss: 6928.8325; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81308.5000; val_chrom_access_recon_loss: 1336835.6250; val_global_loss: 2527029.5000; val_optim_loss: 2527029.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8344; val_auprc_score: 0.8267; val_best_acc_score: 0.7495; val_best_f1_score: 0.7506; train_kl_reg_loss: 22979.6576; train_edge_recon_loss: 358767.9028; train_gene_expr_recon_loss: 674380.0139; train_masked_gp_l1_reg_loss: 6906.2351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79563.0130; train_chrom_access_recon_loss: 1306378.8333; train_global_loss: 2448975.5833; train_optim_loss: 2448975.5833; val_kl_reg_loss: 20635.2891; val_edge_recon_loss: 401056.2500; val_gene_expr_recon_loss: 673112.5625; val_masked_gp_l1_reg_loss: 6873.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77404.0156; val_chrom_access_recon_loss: 1334132.7500; val_global_loss: 2513214.7500; val_optim_loss: 2513214.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8348; val_auprc_score: 0.8270; val_best_acc_score: 0.7357; val_best_f1_score: 0.7540; train_kl_reg_loss: 22892.7791; train_edge_recon_loss: 358092.0486; train_gene_expr_recon_loss: 669754.8264; train_masked_gp_l1_reg_loss: 6867.1386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75725.1059; train_chrom_access_recon_loss: 1303567.9861; train_global_loss: 2436899.9167; train_optim_loss: 2436899.9167; val_kl_reg_loss: 20624.1113; val_edge_recon_loss: 398494.4375; val_gene_expr_recon_loss: 669307.0000; val_masked_gp_l1_reg_loss: 6842.0605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73647.8281; val_chrom_access_recon_loss: 1331415.6250; val_global_loss: 2500331.0000; val_optim_loss: 2500331.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8394; val_auprc_score: 0.8351; val_best_acc_score: 0.7317; val_best_f1_score: 0.7704; train_kl_reg_loss: 22156.6018; train_edge_recon_loss: 356977.1354; train_gene_expr_recon_loss: 664952.3819; train_masked_gp_l1_reg_loss: 6839.7802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72031.2118; train_chrom_access_recon_loss: 1298723.6111; train_global_loss: 2421680.7500; train_optim_loss: 2421680.7500; val_kl_reg_loss: 21684.7305; val_edge_recon_loss: 394823.6562; val_gene_expr_recon_loss: 666080.5000; val_masked_gp_l1_reg_loss: 6830.7573; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70036.0859; val_chrom_access_recon_loss: 1328659.8750; val_global_loss: 2488115.5000; val_optim_loss: 2488115.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8437; val_auprc_score: 0.8385; val_best_acc_score: 0.7577; val_best_f1_score: 0.7768; train_kl_reg_loss: 21680.5768; train_edge_recon_loss: 355558.7257; train_gene_expr_recon_loss: 665370.2292; train_masked_gp_l1_reg_loss: 6833.9322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68489.9210; train_chrom_access_recon_loss: 1299483.3889; train_global_loss: 2417416.7500; train_optim_loss: 2417416.7500; val_kl_reg_loss: 21664.0664; val_edge_recon_loss: 389418.4688; val_gene_expr_recon_loss: 664216.5000; val_masked_gp_l1_reg_loss: 6826.9751; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66585.5312; val_chrom_access_recon_loss: 1325829.2500; val_global_loss: 2474540.7500; val_optim_loss: 2474540.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8510; val_auprc_score: 0.8404; val_best_acc_score: 0.7739; val_best_f1_score: 0.7826; train_kl_reg_loss: 21164.4618; train_edge_recon_loss: 353513.5868; train_gene_expr_recon_loss: 662392.3819; train_masked_gp_l1_reg_loss: 6835.5469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65116.5130; train_chrom_access_recon_loss: 1292659.4722; train_global_loss: 2401681.9722; train_optim_loss: 2401681.9722; val_kl_reg_loss: 19924.5449; val_edge_recon_loss: 382012.4688; val_gene_expr_recon_loss: 662866.1875; val_masked_gp_l1_reg_loss: 6836.6221; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63306.0547; val_chrom_access_recon_loss: 1323880.2500; val_global_loss: 2458826.0000; val_optim_loss: 2458826.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8588; val_auprc_score: 0.8471; val_best_acc_score: 0.7767; val_best_f1_score: 0.7906; train_kl_reg_loss: 20405.0130; train_edge_recon_loss: 350810.6562; train_gene_expr_recon_loss: 663227.0903; train_masked_gp_l1_reg_loss: 6856.1535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61916.8433; train_chrom_access_recon_loss: 1300819.1528; train_global_loss: 2404034.9722; train_optim_loss: 2404034.9722; val_kl_reg_loss: 19529.2344; val_edge_recon_loss: 372793.5000; val_gene_expr_recon_loss: 661683.7500; val_masked_gp_l1_reg_loss: 6866.0566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60205.6211; val_chrom_access_recon_loss: 1322568.0000; val_global_loss: 2443646.0000; val_optim_loss: 2443646.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8769; val_auprc_score: 0.8661; val_best_acc_score: 0.7998; val_best_f1_score: 0.8096; train_kl_reg_loss: 19708.1204; train_edge_recon_loss: 346247.1979; train_gene_expr_recon_loss: 659070.8819; train_masked_gp_l1_reg_loss: 6884.8979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58892.4280; train_chrom_access_recon_loss: 1293003.8611; train_global_loss: 2383807.4444; train_optim_loss: 2383807.4444; val_kl_reg_loss: 18920.4648; val_edge_recon_loss: 359892.4688; val_gene_expr_recon_loss: 661329.0000; val_masked_gp_l1_reg_loss: 6898.9771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57281.7578; val_chrom_access_recon_loss: 1320776.7500; val_global_loss: 2425099.5000; val_optim_loss: 2425099.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8896; val_auprc_score: 0.8778; val_best_acc_score: 0.8102; val_best_f1_score: 0.8186; train_kl_reg_loss: 19386.9510; train_edge_recon_loss: 339505.2500; train_gene_expr_recon_loss: 661436.9306; train_masked_gp_l1_reg_loss: 6921.3322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56049.3194; train_chrom_access_recon_loss: 1293776.3472; train_global_loss: 2377076.1667; train_optim_loss: 2377076.1667; val_kl_reg_loss: 19344.9531; val_edge_recon_loss: 343299.4688; val_gene_expr_recon_loss: 661565.3750; val_masked_gp_l1_reg_loss: 6941.3140; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54532.4297; val_chrom_access_recon_loss: 1319020.0000; val_global_loss: 2404703.5000; val_optim_loss: 2404703.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9037; val_auprc_score: 0.8919; val_best_acc_score: 0.8294; val_best_f1_score: 0.8370; train_kl_reg_loss: 20769.2910; train_edge_recon_loss: 327802.1493; train_gene_expr_recon_loss: 661862.1597; train_masked_gp_l1_reg_loss: 6968.0829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53376.2912; train_chrom_access_recon_loss: 1295253.4306; train_global_loss: 2366031.3889; train_optim_loss: 2366031.3889; val_kl_reg_loss: 22616.0859; val_edge_recon_loss: 322077.7812; val_gene_expr_recon_loss: 662455.3750; val_masked_gp_l1_reg_loss: 6998.6582; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51952.6211; val_chrom_access_recon_loss: 1318104.5000; val_global_loss: 2384205.0000; val_optim_loss: 2384205.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9130; val_auprc_score: 0.9016; val_best_acc_score: 0.8358; val_best_f1_score: 0.8474; train_kl_reg_loss: 25690.3743; train_edge_recon_loss: 313538.3681; train_gene_expr_recon_loss: 663132.0694; train_masked_gp_l1_reg_loss: 7035.2858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50867.9796; train_chrom_access_recon_loss: 1296618.3750; train_global_loss: 2356882.4444; train_optim_loss: 2356882.4444; val_kl_reg_loss: 28700.7305; val_edge_recon_loss: 309130.3438; val_gene_expr_recon_loss: 661347.3125; val_masked_gp_l1_reg_loss: 7070.7783; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49539.0391; val_chrom_access_recon_loss: 1316397.2500; val_global_loss: 2372185.5000; val_optim_loss: 2372185.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9094; val_auprc_score: 0.8920; val_best_acc_score: 0.8371; val_best_f1_score: 0.8467; train_kl_reg_loss: 29792.3270; train_edge_recon_loss: 305001.8056; train_gene_expr_recon_loss: 660427.8611; train_masked_gp_l1_reg_loss: 7102.5815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48532.1940; train_chrom_access_recon_loss: 1290243.3194; train_global_loss: 2341100.1111; train_optim_loss: 2341100.1111; val_kl_reg_loss: 30365.3047; val_edge_recon_loss: 307913.5000; val_gene_expr_recon_loss: 658467.8750; val_masked_gp_l1_reg_loss: 7127.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47295.4766; val_chrom_access_recon_loss: 1313329.8750; val_global_loss: 2364499.5000; val_optim_loss: 2364499.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9200; val_auprc_score: 0.9001; val_best_acc_score: 0.8496; val_best_f1_score: 0.8586; train_kl_reg_loss: 29935.3802; train_edge_recon_loss: 302178.3125; train_gene_expr_recon_loss: 657105.9861; train_masked_gp_l1_reg_loss: 7149.4099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46353.0200; train_chrom_access_recon_loss: 1285842.5417; train_global_loss: 2328564.6111; train_optim_loss: 2328564.6111; val_kl_reg_loss: 29127.1523; val_edge_recon_loss: 301617.0312; val_gene_expr_recon_loss: 657619.5000; val_masked_gp_l1_reg_loss: 7172.6729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45189.3438; val_chrom_access_recon_loss: 1311322.2500; val_global_loss: 2352048.0000; val_optim_loss: 2352048.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9229; val_auprc_score: 0.9056; val_best_acc_score: 0.8531; val_best_f1_score: 0.8609; train_kl_reg_loss: 29331.6936; train_edge_recon_loss: 300255.8125; train_gene_expr_recon_loss: 656374.2708; train_masked_gp_l1_reg_loss: 7195.7797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44303.8290; train_chrom_access_recon_loss: 1284164.6250; train_global_loss: 2321626.0000; train_optim_loss: 2321626.0000; val_kl_reg_loss: 29261.7637; val_edge_recon_loss: 300241.3750; val_gene_expr_recon_loss: 655877.5000; val_masked_gp_l1_reg_loss: 7213.1987; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43211.3516; val_chrom_access_recon_loss: 1309606.6250; val_global_loss: 2345411.7500; val_optim_loss: 2345411.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9252; val_auprc_score: 0.9060; val_best_acc_score: 0.8561; val_best_f1_score: 0.8653; train_kl_reg_loss: 29360.4564; train_edge_recon_loss: 299886.0347; train_gene_expr_recon_loss: 654207.7431; train_masked_gp_l1_reg_loss: 7232.9360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42377.3364; train_chrom_access_recon_loss: 1280783.8056; train_global_loss: 2313848.3611; train_optim_loss: 2313848.3611; val_kl_reg_loss: 28866.3555; val_edge_recon_loss: 300656.0000; val_gene_expr_recon_loss: 654629.1875; val_masked_gp_l1_reg_loss: 7247.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41349.5000; val_chrom_access_recon_loss: 1307595.5000; val_global_loss: 2340344.2500; val_optim_loss: 2340344.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9286; val_auprc_score: 0.9088; val_best_acc_score: 0.8592; val_best_f1_score: 0.8674; train_kl_reg_loss: 26144.3062; train_edge_recon_loss: 315281.1667; train_gene_expr_recon_loss: 996752.7847; train_masked_gp_l1_reg_loss: 7343.7323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40434.9080; train_chrom_access_recon_loss: 1353895.0833; train_global_loss: 2739851.9444; train_optim_loss: 2739851.9444; val_kl_reg_loss: 13392.6484; val_edge_recon_loss: 306122.9688; val_gene_expr_recon_loss: 997775.3750; val_masked_gp_l1_reg_loss: 7510.2661; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39234.8398; val_chrom_access_recon_loss: 1384216.0000; val_global_loss: 2748252.0000; val_optim_loss: 2748252.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9347; val_auprc_score: 0.9179; val_best_acc_score: 0.8666; val_best_f1_score: 0.8752; train_kl_reg_loss: 27054.8835; train_edge_recon_loss: 304026.2188; train_gene_expr_recon_loss: 997135.4514; train_masked_gp_l1_reg_loss: 7686.8911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38251.5295; train_chrom_access_recon_loss: 1362789.2917; train_global_loss: 2736944.3056; train_optim_loss: 2736944.3056; val_kl_reg_loss: 15174.6865; val_edge_recon_loss: 299813.7500; val_gene_expr_recon_loss: 991597.0000; val_masked_gp_l1_reg_loss: 7896.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37037.8203; val_chrom_access_recon_loss: 1381877.8750; val_global_loss: 2733397.5000; val_optim_loss: 2733397.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9342; val_auprc_score: 0.9180; val_best_acc_score: 0.8636; val_best_f1_score: 0.8720; train_kl_reg_loss: 24803.0395; train_edge_recon_loss: 298927.7188; train_gene_expr_recon_loss: 987709.5278; train_masked_gp_l1_reg_loss: 8043.3785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36102.5221; train_chrom_access_recon_loss: 1353181.4444; train_global_loss: 2708767.6667; train_optim_loss: 2708767.6667; val_kl_reg_loss: 17152.4258; val_edge_recon_loss: 300305.0625; val_gene_expr_recon_loss: 985693.5625; val_masked_gp_l1_reg_loss: 8206.3135; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34958.1172; val_chrom_access_recon_loss: 1379142.2500; val_global_loss: 2725457.7500; val_optim_loss: 2725457.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9350; val_auprc_score: 0.9169; val_best_acc_score: 0.8654; val_best_f1_score: 0.8735; train_kl_reg_loss: 23516.5111; train_edge_recon_loss: 296885.8056; train_gene_expr_recon_loss: 980567.2222; train_masked_gp_l1_reg_loss: 8316.0207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34085.4314; train_chrom_access_recon_loss: 1348396.5556; train_global_loss: 2691767.5278; train_optim_loss: 2691767.5278; val_kl_reg_loss: 18911.6289; val_edge_recon_loss: 297035.9688; val_gene_expr_recon_loss: 981767.8750; val_masked_gp_l1_reg_loss: 8439.7568; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33023.8867; val_chrom_access_recon_loss: 1376988.2500; val_global_loss: 2716167.5000; val_optim_loss: 2716167.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9342; val_auprc_score: 0.9160; val_best_acc_score: 0.8619; val_best_f1_score: 0.8712; train_kl_reg_loss: 23458.5727; train_edge_recon_loss: 295601.9306; train_gene_expr_recon_loss: 978545.0764; train_masked_gp_l1_reg_loss: 8417.0160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32906.5295; train_chrom_access_recon_loss: 1350403.0139; train_global_loss: 2689332.1667; train_optim_loss: 2689332.1667; val_kl_reg_loss: 19036.7461; val_edge_recon_loss: 297204.6562; val_gene_expr_recon_loss: 980831.3750; val_masked_gp_l1_reg_loss: 8396.6982; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32762.9062; val_chrom_access_recon_loss: 1376407.5000; val_global_loss: 2714640.0000; val_optim_loss: 2714640.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9365; val_auprc_score: 0.9203; val_best_acc_score: 0.8655; val_best_f1_score: 0.8748; train_kl_reg_loss: 23306.6897; train_edge_recon_loss: 295808.1007; train_gene_expr_recon_loss: 977926.6319; train_masked_gp_l1_reg_loss: 8395.2752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32661.3405; train_chrom_access_recon_loss: 1354083.3472; train_global_loss: 2692181.4167; train_optim_loss: 2692181.4167; val_kl_reg_loss: 19123.5078; val_edge_recon_loss: 294299.7812; val_gene_expr_recon_loss: 980944.1250; val_masked_gp_l1_reg_loss: 8390.9551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32534.0527; val_chrom_access_recon_loss: 1376494.0000; val_global_loss: 2711786.5000; val_optim_loss: 2711786.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9386; val_auprc_score: 0.9244; val_best_acc_score: 0.8665; val_best_f1_score: 0.8748; train_kl_reg_loss: 23120.3852; train_edge_recon_loss: 293741.6076; train_gene_expr_recon_loss: 972631.5903; train_masked_gp_l1_reg_loss: 8390.4690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32437.5731; train_chrom_access_recon_loss: 1342548.5833; train_global_loss: 2672870.1667; train_optim_loss: 2672870.1667; val_kl_reg_loss: 19084.5547; val_edge_recon_loss: 294608.2188; val_gene_expr_recon_loss: 980249.6875; val_masked_gp_l1_reg_loss: 8390.7441; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32318.6875; val_chrom_access_recon_loss: 1376251.0000; val_global_loss: 2710903.0000; val_optim_loss: 2710903.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9344; val_auprc_score: 0.9172; val_best_acc_score: 0.8643; val_best_f1_score: 0.8727; train_kl_reg_loss: 23131.0169; train_edge_recon_loss: 296025.1424; train_gene_expr_recon_loss: 976513.5208; train_masked_gp_l1_reg_loss: 8392.4617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32226.2170; train_chrom_access_recon_loss: 1352196.1667; train_global_loss: 2688484.5278; train_optim_loss: 2688484.5278; val_kl_reg_loss: 19119.3125; val_edge_recon_loss: 295618.5000; val_gene_expr_recon_loss: 980123.6875; val_masked_gp_l1_reg_loss: 8395.4355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32113.7852; val_chrom_access_recon_loss: 1376189.7500; val_global_loss: 2711560.5000; val_optim_loss: 2711560.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9313
val AUPRC score: 0.9152
val best accuracy score: 0.8623
val best F1 score: 0.8718
val target rna MSE score: 3.8750
val source rna MSE score: 3.2343
val target atac MSE score: 0.1384
val source atac MSE score: 0.0205
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
