[True]
Run timestamp: 10082023_212520_57.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_57']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7100; val_auprc_score: 0.7527; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 87134.3066; train_edge_recon_loss: 3791768.0515; train_gene_expr_recon_loss: 46478132.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5545266.0420; train_global_loss: 55902300.6718; train_optim_loss: 55902300.6718; val_kl_reg_loss: 85649.5526; val_edge_recon_loss: 4065409.3333; val_gene_expr_recon_loss: 39746225.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5285167.6333; val_global_loss: 49182451.7333; val_optim_loss: 49182451.7333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7459; val_auprc_score: 0.7749; val_best_acc_score: 0.5298; val_best_f1_score: 0.6771; train_kl_reg_loss: 155684.3515; train_edge_recon_loss: 3639785.0954; train_gene_expr_recon_loss: 38650985.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5205351.0954; train_global_loss: 47651806.5038; train_optim_loss: 47651806.5038; val_kl_reg_loss: 203458.2052; val_edge_recon_loss: 4063255.7500; val_gene_expr_recon_loss: 37837833.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5186516.5333; val_global_loss: 47291064.2667; val_optim_loss: 47291064.2667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8207; val_auprc_score: 0.8378; val_best_acc_score: 0.7087; val_best_f1_score: 0.7440; train_kl_reg_loss: 168347.5401; train_edge_recon_loss: 3562250.0439; train_gene_expr_recon_loss: 37100081.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5129766.9351; train_global_loss: 45960446.3206; train_optim_loss: 45960446.3206; val_kl_reg_loss: 142618.8292; val_edge_recon_loss: 4048705.3333; val_gene_expr_recon_loss: 37115184.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5159045.6000; val_global_loss: 46465554.6667; val_optim_loss: 46465554.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9005; val_auprc_score: 0.8915; val_best_acc_score: 0.8122; val_best_f1_score: 0.8312; train_kl_reg_loss: 150575.2239; train_edge_recon_loss: 3538897.7099; train_gene_expr_recon_loss: 36557662.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5079955.1527; train_global_loss: 45327090.2901; train_optim_loss: 45327090.2901; val_kl_reg_loss: 133871.1458; val_edge_recon_loss: 3887120.1000; val_gene_expr_recon_loss: 36849688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5141461.6333; val_global_loss: 46012141.0667; val_optim_loss: 46012141.0667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8983; val_auprc_score: 0.8883; val_best_acc_score: 0.8165; val_best_f1_score: 0.8292; train_kl_reg_loss: 138395.3128; train_edge_recon_loss: 3281926.2519; train_gene_expr_recon_loss: 36375589.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5074214.0191; train_global_loss: 44870124.7634; train_optim_loss: 44870124.7634; val_kl_reg_loss: 170706.8021; val_edge_recon_loss: 3027981.1833; val_gene_expr_recon_loss: 36460402.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5094923.6667; val_global_loss: 44754013.8667; val_optim_loss: 44754013.8667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9053; val_auprc_score: 0.8919; val_best_acc_score: 0.8281; val_best_f1_score: 0.8425; train_kl_reg_loss: 172135.8875; train_edge_recon_loss: 2999425.8531; train_gene_expr_recon_loss: 36115245.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5042235.4351; train_global_loss: 44329042.9618; train_optim_loss: 44329042.9618; val_kl_reg_loss: 172548.8010; val_edge_recon_loss: 2963577.5833; val_gene_expr_recon_loss: 36404152.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5109185.3667; val_global_loss: 44649465.0667; val_optim_loss: 44649465.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9135; val_auprc_score: 0.9004; val_best_acc_score: 0.8402; val_best_f1_score: 0.8528; train_kl_reg_loss: 165111.4511; train_edge_recon_loss: 2950112.5420; train_gene_expr_recon_loss: 35885505.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5013350.0992; train_global_loss: 44014079.8168; train_optim_loss: 44014079.8168; val_kl_reg_loss: 166418.3427; val_edge_recon_loss: 2949103.3500; val_gene_expr_recon_loss: 36119714.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5056671.8000; val_global_loss: 44291908.8000; val_optim_loss: 44291908.8000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9247; val_auprc_score: 0.9127; val_best_acc_score: 0.8515; val_best_f1_score: 0.8624; train_kl_reg_loss: 159742.4494; train_edge_recon_loss: 2905284.8435; train_gene_expr_recon_loss: 35684096.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4991955.2023; train_global_loss: 43741078.5649; train_optim_loss: 43741078.5649; val_kl_reg_loss: 158208.1646; val_edge_recon_loss: 2904323.1500; val_gene_expr_recon_loss: 36026081.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5042225.5000; val_global_loss: 44130838.1333; val_optim_loss: 44130838.1333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9353; val_auprc_score: 0.9227; val_best_acc_score: 0.8697; val_best_f1_score: 0.8777; train_kl_reg_loss: 155504.3402; train_edge_recon_loss: 2869008.1794; train_gene_expr_recon_loss: 35510380.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4970959.2977; train_global_loss: 43505852.5496; train_optim_loss: 43505852.5496; val_kl_reg_loss: 153443.7906; val_edge_recon_loss: 2866973.8167; val_gene_expr_recon_loss: 35771997.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5013691.6000; val_global_loss: 43806106.9333; val_optim_loss: 43806106.9333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9408; val_auprc_score: 0.9300; val_best_acc_score: 0.8729; val_best_f1_score: 0.8796; train_kl_reg_loss: 151599.4763; train_edge_recon_loss: 2852852.8034; train_gene_expr_recon_loss: 35362867.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4955102.1412; train_global_loss: 43322421.3130; train_optim_loss: 43322421.3130; val_kl_reg_loss: 146825.8531; val_edge_recon_loss: 2854653.6500; val_gene_expr_recon_loss: 35841554.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5039358.1667; val_global_loss: 43882393.6000; val_optim_loss: 43882393.6000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9478; val_auprc_score: 0.9357; val_best_acc_score: 0.8829; val_best_f1_score: 0.8898; train_kl_reg_loss: 147198.9246; train_edge_recon_loss: 2845445.5592; train_gene_expr_recon_loss: 35244671.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4941950.4122; train_global_loss: 43179266.8702; train_optim_loss: 43179266.8702; val_kl_reg_loss: 144466.2990; val_edge_recon_loss: 2809379.7000; val_gene_expr_recon_loss: 35625546.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4981718.1667; val_global_loss: 43561111.2000; val_optim_loss: 43561111.2000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9484; val_auprc_score: 0.9374; val_best_acc_score: 0.8825; val_best_f1_score: 0.8900; train_kl_reg_loss: 142004.0425; train_edge_recon_loss: 2822614.2405; train_gene_expr_recon_loss: 35128739.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4930093.5649; train_global_loss: 43023451.5420; train_optim_loss: 43023451.5420; val_kl_reg_loss: 140823.7260; val_edge_recon_loss: 2818429.1667; val_gene_expr_recon_loss: 35508866.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4984964.0667; val_global_loss: 43453083.2000; val_optim_loss: 43453083.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9536; val_auprc_score: 0.9446; val_best_acc_score: 0.8903; val_best_f1_score: 0.8947; train_kl_reg_loss: 140085.3166; train_edge_recon_loss: 2800872.4580; train_gene_expr_recon_loss: 35011082.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4916662.6641; train_global_loss: 42868703.2366; train_optim_loss: 42868703.2366; val_kl_reg_loss: 140996.5917; val_edge_recon_loss: 2817681.4167; val_gene_expr_recon_loss: 35454348.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4988983.0333; val_global_loss: 43402009.8667; val_optim_loss: 43402009.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9554; val_auprc_score: 0.9453; val_best_acc_score: 0.8932; val_best_f1_score: 0.8980; train_kl_reg_loss: 136164.1171; train_edge_recon_loss: 2804172.9866; train_gene_expr_recon_loss: 34928156.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4908831.9618; train_global_loss: 42777325.3435; train_optim_loss: 42777325.3435; val_kl_reg_loss: 134644.7547; val_edge_recon_loss: 2816055.2333; val_gene_expr_recon_loss: 35161504.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4943508.5667; val_global_loss: 43055713.3333; val_optim_loss: 43055713.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9564; val_auprc_score: 0.9458; val_best_acc_score: 0.8979; val_best_f1_score: 0.9026; train_kl_reg_loss: 132123.1464; train_edge_recon_loss: 2796649.0515; train_gene_expr_recon_loss: 34830985.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4898767.4008; train_global_loss: 42658525.1298; train_optim_loss: 42658525.1298; val_kl_reg_loss: 132720.3745; val_edge_recon_loss: 2798850.7667; val_gene_expr_recon_loss: 35188816.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4954141.5333; val_global_loss: 43074529.3333; val_optim_loss: 43074529.3333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9614; val_auprc_score: 0.9502; val_best_acc_score: 0.9019; val_best_f1_score: 0.9061; train_kl_reg_loss: 128886.2316; train_edge_recon_loss: 2780485.1565; train_gene_expr_recon_loss: 34750466.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4891430.8473; train_global_loss: 42551268.6107; train_optim_loss: 42551268.6107; val_kl_reg_loss: 126552.0323; val_edge_recon_loss: 2789815.8000; val_gene_expr_recon_loss: 35265614.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4957706.5000; val_global_loss: 43139689.0667; val_optim_loss: 43139689.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9651; val_auprc_score: 0.9578; val_best_acc_score: 0.9064; val_best_f1_score: 0.9101; train_kl_reg_loss: 124849.8116; train_edge_recon_loss: 2785181.7462; train_gene_expr_recon_loss: 34641101.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4878839.6260; train_global_loss: 42429972.7023; train_optim_loss: 42429972.7023; val_kl_reg_loss: 124198.4099; val_edge_recon_loss: 2757480.5667; val_gene_expr_recon_loss: 35050532.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4959854.2000; val_global_loss: 42892065.3333; val_optim_loss: 42892065.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9661; val_auprc_score: 0.9599; val_best_acc_score: 0.9072; val_best_f1_score: 0.9112; train_kl_reg_loss: 122692.7334; train_edge_recon_loss: 2777489.5782; train_gene_expr_recon_loss: 34608209.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4878349.8855; train_global_loss: 42386741.1908; train_optim_loss: 42386741.1908; val_kl_reg_loss: 121446.2724; val_edge_recon_loss: 2751794.1667; val_gene_expr_recon_loss: 35016929.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4948166.6000; val_global_loss: 42838336.5333; val_optim_loss: 42838336.5333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9649; val_auprc_score: 0.9559; val_best_acc_score: 0.9060; val_best_f1_score: 0.9109; train_kl_reg_loss: 120934.5094; train_edge_recon_loss: 2763415.7481; train_gene_expr_recon_loss: 34533482.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4870515.6221; train_global_loss: 42288348.1832; train_optim_loss: 42288348.1832; val_kl_reg_loss: 119437.0312; val_edge_recon_loss: 2766580.2333; val_gene_expr_recon_loss: 34838510.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4905944.2667; val_global_loss: 42630471.4667; val_optim_loss: 42630471.4667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9647; val_auprc_score: 0.9571; val_best_acc_score: 0.9080; val_best_f1_score: 0.9117; train_kl_reg_loss: 119100.1264; train_edge_recon_loss: 2752670.5515; train_gene_expr_recon_loss: 34487194.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4871056.6985; train_global_loss: 42230022.0763; train_optim_loss: 42230022.0763; val_kl_reg_loss: 119381.1339; val_edge_recon_loss: 2773164.0500; val_gene_expr_recon_loss: 34877777.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4921413.9000; val_global_loss: 42691736.5333; val_optim_loss: 42691736.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9704; val_auprc_score: 0.9650; val_best_acc_score: 0.9139; val_best_f1_score: 0.9165; train_kl_reg_loss: 116080.4560; train_edge_recon_loss: 2757656.7366; train_gene_expr_recon_loss: 34397471.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4860009.7901; train_global_loss: 42131218.9313; train_optim_loss: 42131218.9313; val_kl_reg_loss: 112834.2719; val_edge_recon_loss: 2748008.3500; val_gene_expr_recon_loss: 34972266.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4937753.1333; val_global_loss: 42770862.1333; val_optim_loss: 42770862.1333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9662; val_auprc_score: 0.9576; val_best_acc_score: 0.9100; val_best_f1_score: 0.9129; train_kl_reg_loss: 114177.4484; train_edge_recon_loss: 2745370.4160; train_gene_expr_recon_loss: 34348714.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4857905.6450; train_global_loss: 42066168.3359; train_optim_loss: 42066168.3359; val_kl_reg_loss: 115262.3510; val_edge_recon_loss: 2764647.7000; val_gene_expr_recon_loss: 34816437.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4932248.0333; val_global_loss: 42628595.4667; val_optim_loss: 42628595.4667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9697; val_auprc_score: 0.9636; val_best_acc_score: 0.9109; val_best_f1_score: 0.9136; train_kl_reg_loss: 112621.8915; train_edge_recon_loss: 2743775.8874; train_gene_expr_recon_loss: 34299570.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4859149.0649; train_global_loss: 42015117.5573; train_optim_loss: 42015117.5573; val_kl_reg_loss: 113481.8000; val_edge_recon_loss: 2767923.0833; val_gene_expr_recon_loss: 34757066.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4912230.7667; val_global_loss: 42550702.6667; val_optim_loss: 42550702.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9710; val_auprc_score: 0.9637; val_best_acc_score: 0.9166; val_best_f1_score: 0.9198; train_kl_reg_loss: 111331.2623; train_edge_recon_loss: 2746146.5458; train_gene_expr_recon_loss: 34240166.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4854545.5840; train_global_loss: 41952189.4351; train_optim_loss: 41952189.4351; val_kl_reg_loss: 110977.9104; val_edge_recon_loss: 2732596.4667; val_gene_expr_recon_loss: 34693042.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4908856.8333; val_global_loss: 42445473.6000; val_optim_loss: 42445473.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9734; val_auprc_score: 0.9662; val_best_acc_score: 0.9182; val_best_f1_score: 0.9200; train_kl_reg_loss: 109526.3820; train_edge_recon_loss: 2732174.3969; train_gene_expr_recon_loss: 34216012.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4851279.1679; train_global_loss: 41908992.0305; train_optim_loss: 41908992.0305; val_kl_reg_loss: 109108.5052; val_edge_recon_loss: 2739434.7333; val_gene_expr_recon_loss: 34573693.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4908960.9000; val_global_loss: 42331197.6000; val_optim_loss: 42331197.6000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9716; val_auprc_score: 0.9642; val_best_acc_score: 0.9193; val_best_f1_score: 0.9220; train_kl_reg_loss: 107971.4144; train_edge_recon_loss: 2754996.1660; train_gene_expr_recon_loss: 34904416.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4900196.1985; train_global_loss: 42667580.4580; train_optim_loss: 42667580.4580; val_kl_reg_loss: 81110.4724; val_edge_recon_loss: 2763275.1167; val_gene_expr_recon_loss: 35221743.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4939555.4333; val_global_loss: 43005684.8000; val_optim_loss: 43005684.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9729; val_auprc_score: 0.9649; val_best_acc_score: 0.9227; val_best_f1_score: 0.9245; train_kl_reg_loss: 107306.6145; train_edge_recon_loss: 2739120.9485; train_gene_expr_recon_loss: 34834204.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4902841.1336; train_global_loss: 42583473.2519; train_optim_loss: 42583473.2519; val_kl_reg_loss: 82661.7047; val_edge_recon_loss: 2746018.9000; val_gene_expr_recon_loss: 35353049.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4972429.5333; val_global_loss: 43154158.6667; val_optim_loss: 43154158.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9748; val_auprc_score: 0.9704; val_best_acc_score: 0.9228; val_best_f1_score: 0.9257; train_kl_reg_loss: 102847.8219; train_edge_recon_loss: 2738831.3740; train_gene_expr_recon_loss: 34701041.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4883173.4160; train_global_loss: 42425893.9542; train_optim_loss: 42425893.9542; val_kl_reg_loss: 82379.0859; val_edge_recon_loss: 2739851.7167; val_gene_expr_recon_loss: 35189245.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4949063.2000; val_global_loss: 42960539.7333; val_optim_loss: 42960539.7333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9750; val_auprc_score: 0.9703; val_best_acc_score: 0.9239; val_best_f1_score: 0.9261; train_kl_reg_loss: 99533.2060; train_edge_recon_loss: 2729017.1794; train_gene_expr_recon_loss: 34625389.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4875561.6908; train_global_loss: 42329501.3435; train_optim_loss: 42329501.3435; val_kl_reg_loss: 82133.2089; val_edge_recon_loss: 2735690.4833; val_gene_expr_recon_loss: 34894153.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4892564.8667; val_global_loss: 42604542.1333; val_optim_loss: 42604542.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9764; val_auprc_score: 0.9681; val_best_acc_score: 0.9307; val_best_f1_score: 0.9325; train_kl_reg_loss: 98347.7066; train_edge_recon_loss: 2723360.9695; train_gene_expr_recon_loss: 34605705.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4881586.7519; train_global_loss: 42309000.7023; train_optim_loss: 42309000.7023; val_kl_reg_loss: 83852.7542; val_edge_recon_loss: 2723755.6500; val_gene_expr_recon_loss: 34976775.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4916234.8333; val_global_loss: 42700618.4000; val_optim_loss: 42700618.4000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9767; val_auprc_score: 0.9729; val_best_acc_score: 0.9245; val_best_f1_score: 0.9274; train_kl_reg_loss: 98267.8732; train_edge_recon_loss: 2718376.6775; train_gene_expr_recon_loss: 34545022.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4875428.6412; train_global_loss: 42237095.7863; train_optim_loss: 42237095.7863; val_kl_reg_loss: 84298.4349; val_edge_recon_loss: 2726274.7333; val_gene_expr_recon_loss: 34995750.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4914044.8000; val_global_loss: 42720368.2667; val_optim_loss: 42720368.2667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9759; val_auprc_score: 0.9688; val_best_acc_score: 0.9287; val_best_f1_score: 0.9305; train_kl_reg_loss: 98374.0881; train_edge_recon_loss: 2706441.8607; train_gene_expr_recon_loss: 34551495.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4874751.1183; train_global_loss: 42231062.8702; train_optim_loss: 42231062.8702; val_kl_reg_loss: 84863.7490; val_edge_recon_loss: 2715898.9500; val_gene_expr_recon_loss: 35062070.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4927014.9667; val_global_loss: 42789847.4667; val_optim_loss: 42789847.4667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9782; val_auprc_score: 0.9747; val_best_acc_score: 0.9295; val_best_f1_score: 0.9313; train_kl_reg_loss: 98048.1644; train_edge_recon_loss: 2716537.5401; train_gene_expr_recon_loss: 34555431.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4878282.1145; train_global_loss: 42248298.9008; train_optim_loss: 42248298.9008; val_kl_reg_loss: 84218.3250; val_edge_recon_loss: 2726654.2333; val_gene_expr_recon_loss: 35114576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4948138.9667; val_global_loss: 42873587.2000; val_optim_loss: 42873587.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 46 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9708
val AUPRC score: 0.9642
val best accuracy score: 0.9175
val best F1 score: 0.9200
val target rna MSE score: 1.0974
val source rna MSE score: 21.8242
val target atac MSE score: 0.3501
val source atac MSE score: 2.9997
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
