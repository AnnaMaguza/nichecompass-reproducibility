[True]
Run timestamp: 01082023_092529_77.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_77']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8956; val_auprc_score: 0.9794; val_best_acc_score: 0.8524; val_best_f1_score: 0.9202; train_kl_reg_loss: 43085.8138; train_edge_recon_loss: 1032901.3414; train_gene_expr_recon_loss: 527795.0498; train_masked_gp_l1_reg_loss: 10493.4303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58239.0145; train_global_loss: 1672514.6574; train_optim_loss: 1672514.6574; val_kl_reg_loss: 26515.5462; val_edge_recon_loss: 1212497.9583; val_gene_expr_recon_loss: 456792.4479; val_masked_gp_l1_reg_loss: 9468.7686; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53008.6914; val_global_loss: 1758283.4375; val_optim_loss: 1758283.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8925; val_auprc_score: 0.9793; val_best_acc_score: 0.8634; val_best_f1_score: 0.9255; train_kl_reg_loss: 22688.4433; train_edge_recon_loss: 1028119.8275; train_gene_expr_recon_loss: 420308.2321; train_masked_gp_l1_reg_loss: 8906.4038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48644.7529; train_global_loss: 1528667.6551; train_optim_loss: 1528667.6551; val_kl_reg_loss: 13183.0519; val_edge_recon_loss: 1215399.8542; val_gene_expr_recon_loss: 364443.7396; val_masked_gp_l1_reg_loss: 8490.1465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44605.2539; val_global_loss: 1646122.0417; val_optim_loss: 1646122.0417
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8778; val_auprc_score: 0.9774; val_best_acc_score: 0.8680; val_best_f1_score: 0.9275; train_kl_reg_loss: 13564.2579; train_edge_recon_loss: 1027360.6921; train_gene_expr_recon_loss: 313282.7668; train_masked_gp_l1_reg_loss: 8236.8845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41341.2588; train_global_loss: 1403785.8634; train_optim_loss: 1403785.8634; val_kl_reg_loss: 13121.0667; val_edge_recon_loss: 1167626.7500; val_gene_expr_recon_loss: 276448.4479; val_masked_gp_l1_reg_loss: 7997.7354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38047.3359; val_global_loss: 1503241.3542; val_optim_loss: 1503241.3542
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8386; val_auprc_score: 0.9667; val_best_acc_score: 0.8778; val_best_f1_score: 0.9325; train_kl_reg_loss: 12325.4483; train_edge_recon_loss: 1019484.2049; train_gene_expr_recon_loss: 266497.8808; train_masked_gp_l1_reg_loss: 7866.4386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35076.5106; train_global_loss: 1341250.4676; train_optim_loss: 1341250.4676; val_kl_reg_loss: 9274.7573; val_edge_recon_loss: 1152062.8958; val_gene_expr_recon_loss: 261320.7917; val_masked_gp_l1_reg_loss: 7784.0107; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32173.7012; val_global_loss: 1462616.1875; val_optim_loss: 1462616.1875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8408; val_auprc_score: 0.9642; val_best_acc_score: 0.8864; val_best_f1_score: 0.9368; train_kl_reg_loss: 10799.9755; train_edge_recon_loss: 938635.9051; train_gene_expr_recon_loss: 271315.6467; train_masked_gp_l1_reg_loss: 7898.5070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29894.6178; train_global_loss: 1258544.6435; train_optim_loss: 1258544.6435; val_kl_reg_loss: 15984.3853; val_edge_recon_loss: 897387.1979; val_gene_expr_recon_loss: 266629.1458; val_masked_gp_l1_reg_loss: 8039.4521; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27793.7598; val_global_loss: 1215833.9375; val_optim_loss: 1215833.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8537; val_auprc_score: 0.9688; val_best_acc_score: 0.9001; val_best_f1_score: 0.9444; train_kl_reg_loss: 17957.2810; train_edge_recon_loss: 871482.4907; train_gene_expr_recon_loss: 260644.5101; train_masked_gp_l1_reg_loss: 8048.6861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26225.1759; train_global_loss: 1184358.1412; train_optim_loss: 1184358.1412; val_kl_reg_loss: 15802.2603; val_edge_recon_loss: 871981.3125; val_gene_expr_recon_loss: 259367.1589; val_masked_gp_l1_reg_loss: 8047.4443; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24843.7695; val_global_loss: 1180042.0000; val_optim_loss: 1180042.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8566; val_auprc_score: 0.9689; val_best_acc_score: 0.9081; val_best_f1_score: 0.9488; train_kl_reg_loss: 17690.4532; train_edge_recon_loss: 872787.8218; train_gene_expr_recon_loss: 253918.4251; train_masked_gp_l1_reg_loss: 8046.0089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23718.5949; train_global_loss: 1176161.2963; train_optim_loss: 1176161.2963; val_kl_reg_loss: 14823.7611; val_edge_recon_loss: 846658.6250; val_gene_expr_recon_loss: 255303.7370; val_masked_gp_l1_reg_loss: 8040.6011; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22601.0625; val_global_loss: 1147427.8333; val_optim_loss: 1147427.8333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8607; val_auprc_score: 0.9666; val_best_acc_score: 0.9073; val_best_f1_score: 0.9478; train_kl_reg_loss: 16006.3739; train_edge_recon_loss: 852737.5764; train_gene_expr_recon_loss: 249920.1973; train_masked_gp_l1_reg_loss: 8025.9843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21613.6755; train_global_loss: 1148303.8032; train_optim_loss: 1148303.8032; val_kl_reg_loss: 15564.3927; val_edge_recon_loss: 857924.7604; val_gene_expr_recon_loss: 249861.9062; val_masked_gp_l1_reg_loss: 8019.0239; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20628.4160; val_global_loss: 1151998.4167; val_optim_loss: 1151998.4167
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8797; val_auprc_score: 0.9726; val_best_acc_score: 0.9114; val_best_f1_score: 0.9500; train_kl_reg_loss: 16988.0507; train_edge_recon_loss: 831675.5208; train_gene_expr_recon_loss: 244716.4358; train_masked_gp_l1_reg_loss: 7988.5925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19752.2863; train_global_loss: 1121120.8924; train_optim_loss: 1121120.8924; val_kl_reg_loss: 17352.8766; val_edge_recon_loss: 829446.0938; val_gene_expr_recon_loss: 241387.1771; val_masked_gp_l1_reg_loss: 7952.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18882.0195; val_global_loss: 1115021.0417; val_optim_loss: 1115021.0417
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8948; val_auprc_score: 0.9768; val_best_acc_score: 0.9081; val_best_f1_score: 0.9478; train_kl_reg_loss: 18179.9523; train_edge_recon_loss: 827908.8067; train_gene_expr_recon_loss: 239920.0920; train_masked_gp_l1_reg_loss: 7911.4679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18138.7391; train_global_loss: 1112059.0694; train_optim_loss: 1112059.0694; val_kl_reg_loss: 16770.2777; val_edge_recon_loss: 832614.0104; val_gene_expr_recon_loss: 239959.3802; val_masked_gp_l1_reg_loss: 7845.7051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17396.8281; val_global_loss: 1114586.2917; val_optim_loss: 1114586.2917
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9016; val_auprc_score: 0.9774; val_best_acc_score: 0.9110; val_best_f1_score: 0.9493; train_kl_reg_loss: 17258.8596; train_edge_recon_loss: 836669.2604; train_gene_expr_recon_loss: 235810.5475; train_masked_gp_l1_reg_loss: 7766.6193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16775.0369; train_global_loss: 1114280.3264; train_optim_loss: 1114280.3264; val_kl_reg_loss: 15144.7111; val_edge_recon_loss: 829025.8750; val_gene_expr_recon_loss: 235565.7865; val_masked_gp_l1_reg_loss: 7672.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16172.6836; val_global_loss: 1103581.5104; val_optim_loss: 1103581.5104
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9034; val_auprc_score: 0.9785; val_best_acc_score: 0.9117; val_best_f1_score: 0.9497; train_kl_reg_loss: 15999.1024; train_edge_recon_loss: 815743.8044; train_gene_expr_recon_loss: 232228.5055; train_masked_gp_l1_reg_loss: 7566.1581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15666.2081; train_global_loss: 1087203.7766; train_optim_loss: 1087203.7766; val_kl_reg_loss: 15626.9284; val_edge_recon_loss: 832548.3854; val_gene_expr_recon_loss: 229641.1068; val_masked_gp_l1_reg_loss: 7449.6982; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15187.1191; val_global_loss: 1100453.2708; val_optim_loss: 1100453.2708
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9275; val_auprc_score: 0.9846; val_best_acc_score: 0.9228; val_best_f1_score: 0.9558; train_kl_reg_loss: 15278.2642; train_edge_recon_loss: 813418.2326; train_gene_expr_recon_loss: 228815.1704; train_masked_gp_l1_reg_loss: 7320.0037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14788.2610; train_global_loss: 1079619.9421; train_optim_loss: 1079619.9421; val_kl_reg_loss: 14868.8729; val_edge_recon_loss: 820323.5729; val_gene_expr_recon_loss: 226671.8438; val_masked_gp_l1_reg_loss: 7171.8071; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14390.1660; val_global_loss: 1083426.2083; val_optim_loss: 1083426.2083
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9236; val_auprc_score: 0.9828; val_best_acc_score: 0.9248; val_best_f1_score: 0.9569; train_kl_reg_loss: 15136.1675; train_edge_recon_loss: 806368.0486; train_gene_expr_recon_loss: 225022.5668; train_masked_gp_l1_reg_loss: 7003.9698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14052.8215; train_global_loss: 1067583.5660; train_optim_loss: 1067583.5660; val_kl_reg_loss: 14982.1167; val_edge_recon_loss: 806730.0938; val_gene_expr_recon_loss: 222722.7943; val_masked_gp_l1_reg_loss: 6815.8770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13708.0654; val_global_loss: 1064958.9896; val_optim_loss: 1064958.9896
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9343; val_auprc_score: 0.9851; val_best_acc_score: 0.9316; val_best_f1_score: 0.9606; train_kl_reg_loss: 14900.8329; train_edge_recon_loss: 796850.9583; train_gene_expr_recon_loss: 221226.9167; train_masked_gp_l1_reg_loss: 6621.5617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13373.0408; train_global_loss: 1052973.3067; train_optim_loss: 1052973.3067; val_kl_reg_loss: 13945.6794; val_edge_recon_loss: 783097.0208; val_gene_expr_recon_loss: 219200.3438; val_masked_gp_l1_reg_loss: 6417.1504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13059.0352; val_global_loss: 1035719.2188; val_optim_loss: 1035719.2188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9351; val_auprc_score: 0.9858; val_best_acc_score: 0.9295; val_best_f1_score: 0.9594; train_kl_reg_loss: 14416.9588; train_edge_recon_loss: 795191.6435; train_gene_expr_recon_loss: 218004.4068; train_masked_gp_l1_reg_loss: 6208.9996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12763.7314; train_global_loss: 1046585.7431; train_optim_loss: 1046585.7431; val_kl_reg_loss: 13503.9268; val_edge_recon_loss: 795737.1562; val_gene_expr_recon_loss: 215961.9635; val_masked_gp_l1_reg_loss: 5991.7168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12456.5186; val_global_loss: 1043651.2604; val_optim_loss: 1043651.2604
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9349; val_auprc_score: 0.9854; val_best_acc_score: 0.9301; val_best_f1_score: 0.9598; train_kl_reg_loss: 13511.6201; train_edge_recon_loss: 795532.1285; train_gene_expr_recon_loss: 215168.7523; train_masked_gp_l1_reg_loss: 5786.0996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12182.0041; train_global_loss: 1042180.6146; train_optim_loss: 1042180.6146; val_kl_reg_loss: 12518.7266; val_edge_recon_loss: 799780.3958; val_gene_expr_recon_loss: 213989.2760; val_masked_gp_l1_reg_loss: 5572.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11903.7344; val_global_loss: 1043764.9062; val_optim_loss: 1043764.9062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9340; val_auprc_score: 0.9852; val_best_acc_score: 0.9274; val_best_f1_score: 0.9581; train_kl_reg_loss: 12587.9444; train_edge_recon_loss: 794668.3391; train_gene_expr_recon_loss: 212766.5527; train_masked_gp_l1_reg_loss: 5365.6676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11656.0147; train_global_loss: 1037044.5278; train_optim_loss: 1037044.5278; val_kl_reg_loss: 12199.6735; val_edge_recon_loss: 803731.8542; val_gene_expr_recon_loss: 211263.2578; val_masked_gp_l1_reg_loss: 5153.2061; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11406.9707; val_global_loss: 1043755.0104; val_optim_loss: 1043755.0104
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9345; val_auprc_score: 0.9852; val_best_acc_score: 0.9314; val_best_f1_score: 0.9607; train_kl_reg_loss: 12091.2299; train_edge_recon_loss: 787050.7002; train_gene_expr_recon_loss: 210261.9572; train_masked_gp_l1_reg_loss: 4949.2407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11166.3000; train_global_loss: 1025519.4236; train_optim_loss: 1025519.4236; val_kl_reg_loss: 11172.4562; val_edge_recon_loss: 784040.5000; val_gene_expr_recon_loss: 209117.6536; val_masked_gp_l1_reg_loss: 4746.1533; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10924.0820; val_global_loss: 1020000.8229; val_optim_loss: 1020000.8229
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9453; val_auprc_score: 0.9871; val_best_acc_score: 0.9338; val_best_f1_score: 0.9615; train_kl_reg_loss: 11817.2563; train_edge_recon_loss: 792914.1910; train_gene_expr_recon_loss: 208135.8785; train_masked_gp_l1_reg_loss: 4562.5164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10699.5943; train_global_loss: 1028129.4282; train_optim_loss: 1028129.4282; val_kl_reg_loss: 10972.3265; val_edge_recon_loss: 824942.4583; val_gene_expr_recon_loss: 206880.8438; val_masked_gp_l1_reg_loss: 4376.2837; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10465.0918; val_global_loss: 1057637.0000; val_optim_loss: 1057637.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9360; val_auprc_score: 0.9858; val_best_acc_score: 0.9309; val_best_f1_score: 0.9600; train_kl_reg_loss: 11729.1771; train_edge_recon_loss: 793788.6215; train_gene_expr_recon_loss: 205974.6479; train_masked_gp_l1_reg_loss: 4211.2363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10226.3906; train_global_loss: 1025930.0833; train_optim_loss: 1025930.0833; val_kl_reg_loss: 12003.5856; val_edge_recon_loss: 813277.0729; val_gene_expr_recon_loss: 204488.4141; val_masked_gp_l1_reg_loss: 4043.0002; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9972.4521; val_global_loss: 1043784.5312; val_optim_loss: 1043784.5312
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9436; val_auprc_score: 0.9886; val_best_acc_score: 0.9340; val_best_f1_score: 0.9619; train_kl_reg_loss: 11600.2739; train_edge_recon_loss: 789686.5197; train_gene_expr_recon_loss: 203896.2390; train_masked_gp_l1_reg_loss: 3892.8104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9726.6257; train_global_loss: 1018802.4769; train_optim_loss: 1018802.4769; val_kl_reg_loss: 11170.7106; val_edge_recon_loss: 783642.1562; val_gene_expr_recon_loss: 203204.3281; val_masked_gp_l1_reg_loss: 3743.3335; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9464.2129; val_global_loss: 1011224.7188; val_optim_loss: 1011224.7188
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9418; val_auprc_score: 0.9862; val_best_acc_score: 0.9315; val_best_f1_score: 0.9606; train_kl_reg_loss: 10864.8707; train_edge_recon_loss: 781410.7940; train_gene_expr_recon_loss: 202183.9742; train_masked_gp_l1_reg_loss: 3612.7338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9226.0895; train_global_loss: 1007298.4618; train_optim_loss: 1007298.4618; val_kl_reg_loss: 10614.5256; val_edge_recon_loss: 798693.1979; val_gene_expr_recon_loss: 201224.0182; val_masked_gp_l1_reg_loss: 3481.3599; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8981.7295; val_global_loss: 1022994.8646; val_optim_loss: 1022994.8646
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9469; val_auprc_score: 0.9882; val_best_acc_score: 0.9332; val_best_f1_score: 0.9615; train_kl_reg_loss: 10771.1574; train_edge_recon_loss: 777740.3646; train_gene_expr_recon_loss: 200519.6667; train_masked_gp_l1_reg_loss: 3367.5134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8751.8824; train_global_loss: 1001150.5833; train_optim_loss: 1001150.5833; val_kl_reg_loss: 10384.7772; val_edge_recon_loss: 802331.5625; val_gene_expr_recon_loss: 199946.1276; val_masked_gp_l1_reg_loss: 3255.2781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8506.0898; val_global_loss: 1024423.8021; val_optim_loss: 1024423.8021
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9480; val_auprc_score: 0.9885; val_best_acc_score: 0.9375; val_best_f1_score: 0.9640; train_kl_reg_loss: 10706.4514; train_edge_recon_loss: 792266.5694; train_gene_expr_recon_loss: 199021.1062; train_masked_gp_l1_reg_loss: 3151.9940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8266.2819; train_global_loss: 1013412.3889; train_optim_loss: 1013412.3889; val_kl_reg_loss: 10216.7121; val_edge_recon_loss: 789964.1667; val_gene_expr_recon_loss: 198073.6562; val_masked_gp_l1_reg_loss: 3049.7246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8034.3271; val_global_loss: 1009338.6042; val_optim_loss: 1009338.6042
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9451; val_auprc_score: 0.9876; val_best_acc_score: 0.9323; val_best_f1_score: 0.9606; train_kl_reg_loss: 10426.2133; train_edge_recon_loss: 787107.4641; train_gene_expr_recon_loss: 197528.0914; train_masked_gp_l1_reg_loss: 2963.0276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7811.4801; train_global_loss: 1005836.2789; train_optim_loss: 1005836.2789; val_kl_reg_loss: 10427.0368; val_edge_recon_loss: 810480.7917; val_gene_expr_recon_loss: 196738.5469; val_masked_gp_l1_reg_loss: 2874.4678; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7577.7710; val_global_loss: 1028098.5729; val_optim_loss: 1028098.5729
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9534; val_auprc_score: 0.9898; val_best_acc_score: 0.9392; val_best_f1_score: 0.9648; train_kl_reg_loss: 10096.4592; train_edge_recon_loss: 774435.1701; train_gene_expr_recon_loss: 196218.9068; train_masked_gp_l1_reg_loss: 2800.7187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7356.0570; train_global_loss: 990907.3137; train_optim_loss: 990907.3137; val_kl_reg_loss: 9387.4193; val_edge_recon_loss: 786134.1250; val_gene_expr_recon_loss: 195324.8438; val_masked_gp_l1_reg_loss: 2728.1694; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7130.6436; val_global_loss: 1000705.1979; val_optim_loss: 1000705.1979
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9504; val_auprc_score: 0.9885; val_best_acc_score: 0.9402; val_best_f1_score: 0.9655; train_kl_reg_loss: 9934.4987; train_edge_recon_loss: 779939.1678; train_gene_expr_recon_loss: 194944.6418; train_masked_gp_l1_reg_loss: 2660.3985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6922.6105; train_global_loss: 994401.3310; train_optim_loss: 994401.3310; val_kl_reg_loss: 9573.9111; val_edge_recon_loss: 793332.3333; val_gene_expr_recon_loss: 194368.8750; val_masked_gp_l1_reg_loss: 2590.8450; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6707.0942; val_global_loss: 1006573.1042; val_optim_loss: 1006573.1042
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9556; val_auprc_score: 0.9907; val_best_acc_score: 0.9421; val_best_f1_score: 0.9667; train_kl_reg_loss: 9599.9308; train_edge_recon_loss: 777028.7060; train_gene_expr_recon_loss: 193824.8137; train_masked_gp_l1_reg_loss: 2533.1776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6515.2665; train_global_loss: 989501.8900; train_optim_loss: 989501.8900; val_kl_reg_loss: 9306.8441; val_edge_recon_loss: 764652.8750; val_gene_expr_recon_loss: 193209.3932; val_masked_gp_l1_reg_loss: 2477.1475; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6312.9048; val_global_loss: 975959.1146; val_optim_loss: 975959.1146
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9598; val_auprc_score: 0.9911; val_best_acc_score: 0.9436; val_best_f1_score: 0.9673; train_kl_reg_loss: 9658.2286; train_edge_recon_loss: 782179.3854; train_gene_expr_recon_loss: 192758.3383; train_masked_gp_l1_reg_loss: 2427.7609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6129.4294; train_global_loss: 993153.1481; train_optim_loss: 993153.1481; val_kl_reg_loss: 9330.6890; val_edge_recon_loss: 786073.4688; val_gene_expr_recon_loss: 192292.9062; val_masked_gp_l1_reg_loss: 2380.2991; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5943.0996; val_global_loss: 996020.4792; val_optim_loss: 996020.4792
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9567; val_auprc_score: 0.9903; val_best_acc_score: 0.9453; val_best_f1_score: 0.9682; train_kl_reg_loss: 9583.1721; train_edge_recon_loss: 776371.0764; train_gene_expr_recon_loss: 191592.2266; train_masked_gp_l1_reg_loss: 2334.3725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5766.1466; train_global_loss: 985647.0035; train_optim_loss: 985647.0035; val_kl_reg_loss: 9034.9419; val_edge_recon_loss: 781670.8854; val_gene_expr_recon_loss: 190992.7344; val_masked_gp_l1_reg_loss: 2290.2566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5593.1162; val_global_loss: 989581.9479; val_optim_loss: 989581.9479
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9615; val_auprc_score: 0.9907; val_best_acc_score: 0.9455; val_best_f1_score: 0.9681; train_kl_reg_loss: 9444.3260; train_edge_recon_loss: 771376.0081; train_gene_expr_recon_loss: 190598.0104; train_masked_gp_l1_reg_loss: 2251.7458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5432.0866; train_global_loss: 979102.1736; train_optim_loss: 979102.1736; val_kl_reg_loss: 9054.7855; val_edge_recon_loss: 796336.7292; val_gene_expr_recon_loss: 189827.1458; val_masked_gp_l1_reg_loss: 2206.9675; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5267.2373; val_global_loss: 1002692.8438; val_optim_loss: 1002692.8438
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9553; val_auprc_score: 0.9896; val_best_acc_score: 0.9467; val_best_f1_score: 0.9692; train_kl_reg_loss: 9294.5559; train_edge_recon_loss: 784209.9062; train_gene_expr_recon_loss: 189494.7109; train_masked_gp_l1_reg_loss: 2172.4791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5117.9481; train_global_loss: 990289.5961; train_optim_loss: 990289.5961; val_kl_reg_loss: 9323.7274; val_edge_recon_loss: 786841.8021; val_gene_expr_recon_loss: 188773.6016; val_masked_gp_l1_reg_loss: 2135.2195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4965.7808; val_global_loss: 992040.1562; val_optim_loss: 992040.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9629; val_auprc_score: 0.9917; val_best_acc_score: 0.9499; val_best_f1_score: 0.9710; train_kl_reg_loss: 9448.8920; train_edge_recon_loss: 769373.8657; train_gene_expr_recon_loss: 188847.8345; train_masked_gp_l1_reg_loss: 2065.4174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4918.9820; train_global_loss: 974654.9988; train_optim_loss: 974654.9988; val_kl_reg_loss: 9117.7498; val_edge_recon_loss: 774715.9896; val_gene_expr_recon_loss: 188618.7969; val_masked_gp_l1_reg_loss: 2047.0222; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4896.4062; val_global_loss: 979395.9167; val_optim_loss: 979395.9167
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9602; val_auprc_score: 0.9909; val_best_acc_score: 0.9486; val_best_f1_score: 0.9703; train_kl_reg_loss: 9220.1776; train_edge_recon_loss: 765648.8484; train_gene_expr_recon_loss: 188790.0492; train_masked_gp_l1_reg_loss: 2043.4978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4881.4747; train_global_loss: 970584.0463; train_optim_loss: 970584.0463; val_kl_reg_loss: 8914.6714; val_edge_recon_loss: 776775.1146; val_gene_expr_recon_loss: 188808.1406; val_masked_gp_l1_reg_loss: 2040.3888; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4866.2686; val_global_loss: 981404.5625; val_optim_loss: 981404.5625
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9620; val_auprc_score: 0.9905; val_best_acc_score: 0.9464; val_best_f1_score: 0.9687; train_kl_reg_loss: 9179.0431; train_edge_recon_loss: 772710.2176; train_gene_expr_recon_loss: 188679.4392; train_masked_gp_l1_reg_loss: 2037.6830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4851.4294; train_global_loss: 977457.8125; train_optim_loss: 977457.8125; val_kl_reg_loss: 8873.6676; val_edge_recon_loss: 803301.8438; val_gene_expr_recon_loss: 188372.8854; val_masked_gp_l1_reg_loss: 2034.9441; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4835.8926; val_global_loss: 1007419.2083; val_optim_loss: 1007419.2083
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9626; val_auprc_score: 0.9908; val_best_acc_score: 0.9506; val_best_f1_score: 0.9714; train_kl_reg_loss: 9148.8738; train_edge_recon_loss: 768371.4363; train_gene_expr_recon_loss: 188542.4630; train_masked_gp_l1_reg_loss: 2032.0372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4821.2462; train_global_loss: 972916.0602; train_optim_loss: 972916.0602; val_kl_reg_loss: 8906.8364; val_edge_recon_loss: 779619.0938; val_gene_expr_recon_loss: 188796.2917; val_masked_gp_l1_reg_loss: 2028.7524; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4805.8213; val_global_loss: 984156.7812; val_optim_loss: 984156.7812

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 12 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9530
val AUPRC score: 0.9886
val best accuracy score: 0.9390
val best F1 score: 0.9644
val target rna MSE score: 15.0000
val source rna MSE score: 6.5436
Val cat covariate0 mean sim diff: -0.0028

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
