[True]
Run timestamp: 01082023_080432_46.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_46']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9155; val_auprc_score: 0.9837; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 28439.6114; train_edge_recon_loss: 109074.1920; train_gene_expr_recon_loss: 565878.9242; train_masked_gp_l1_reg_loss: 6085.6878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115505.7700; train_global_loss: 824984.1898; train_optim_loss: 824984.1898; val_kl_reg_loss: 19999.4769; val_edge_recon_loss: 117588.9076; val_gene_expr_recon_loss: 456933.3021; val_masked_gp_l1_reg_loss: 6018.0562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104081.7891; val_global_loss: 704621.5521; val_optim_loss: 704621.5521
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9058; val_auprc_score: 0.9819; val_best_acc_score: 0.8569; val_best_f1_score: 0.9229; train_kl_reg_loss: 19688.4281; train_edge_recon_loss: 109550.8605; train_gene_expr_recon_loss: 420360.2535; train_masked_gp_l1_reg_loss: 5786.2068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94193.7917; train_global_loss: 649579.5440; train_optim_loss: 649579.5440; val_kl_reg_loss: 15872.9334; val_edge_recon_loss: 116294.7292; val_gene_expr_recon_loss: 372269.2760; val_masked_gp_l1_reg_loss: 5605.6201; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84645.8672; val_global_loss: 594688.4375; val_optim_loss: 594688.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8926; val_auprc_score: 0.9788; val_best_acc_score: 0.8584; val_best_f1_score: 0.9232; train_kl_reg_loss: 15683.3687; train_edge_recon_loss: 109381.4476; train_gene_expr_recon_loss: 318867.1921; train_masked_gp_l1_reg_loss: 5476.1581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76627.1095; train_global_loss: 526035.2766; train_optim_loss: 526035.2766; val_kl_reg_loss: 14625.9191; val_edge_recon_loss: 120990.4440; val_gene_expr_recon_loss: 272674.5208; val_masked_gp_l1_reg_loss: 5345.0137; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68640.1094; val_global_loss: 482276.0000; val_optim_loss: 482276.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8683; val_auprc_score: 0.9744; val_best_acc_score: 0.8771; val_best_f1_score: 0.9315; train_kl_reg_loss: 14566.3235; train_edge_recon_loss: 108556.5078; train_gene_expr_recon_loss: 257095.6672; train_masked_gp_l1_reg_loss: 5240.1516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61377.7954; train_global_loss: 446836.4427; train_optim_loss: 446836.4427; val_kl_reg_loss: 13573.2274; val_edge_recon_loss: 119080.2292; val_gene_expr_recon_loss: 247000.6354; val_masked_gp_l1_reg_loss: 5156.1533; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54188.3125; val_global_loss: 438998.5573; val_optim_loss: 438998.5573
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8401; val_auprc_score: 0.9671; val_best_acc_score: 0.8744; val_best_f1_score: 0.9300; train_kl_reg_loss: 13607.9122; train_edge_recon_loss: 108733.2633; train_gene_expr_recon_loss: 243186.3362; train_masked_gp_l1_reg_loss: 5118.9595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48232.8423; train_global_loss: 418879.3177; train_optim_loss: 418879.3177; val_kl_reg_loss: 12267.4902; val_edge_recon_loss: 118701.5586; val_gene_expr_recon_loss: 239023.2474; val_masked_gp_l1_reg_loss: 5097.4600; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42670.1328; val_global_loss: 417759.8854; val_optim_loss: 417759.8854
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8330; val_auprc_score: 0.9634; val_best_acc_score: 0.8759; val_best_f1_score: 0.9307; train_kl_reg_loss: 12795.3140; train_edge_recon_loss: 106295.2280; train_gene_expr_recon_loss: 236962.5732; train_masked_gp_l1_reg_loss: 5097.8186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38600.2120; train_global_loss: 399751.1476; train_optim_loss: 399751.1476; val_kl_reg_loss: 12363.5936; val_edge_recon_loss: 113447.9987; val_gene_expr_recon_loss: 234593.2943; val_masked_gp_l1_reg_loss: 5112.2026; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35026.4141; val_global_loss: 400543.4844; val_optim_loss: 400543.4844
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8342; val_auprc_score: 0.9627; val_best_acc_score: 0.8774; val_best_f1_score: 0.9322; train_kl_reg_loss: 12889.1049; train_edge_recon_loss: 102916.8076; train_gene_expr_recon_loss: 233087.9988; train_masked_gp_l1_reg_loss: 5149.8743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32246.1526; train_global_loss: 386289.9410; train_optim_loss: 386289.9410; val_kl_reg_loss: 12739.3070; val_edge_recon_loss: 105656.0755; val_gene_expr_recon_loss: 230944.2161; val_masked_gp_l1_reg_loss: 5195.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29567.9609; val_global_loss: 384102.9271; val_optim_loss: 384102.9271
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8444; val_auprc_score: 0.9656; val_best_acc_score: 0.8864; val_best_f1_score: 0.9365; train_kl_reg_loss: 13007.5739; train_edge_recon_loss: 100109.2705; train_gene_expr_recon_loss: 229640.5446; train_masked_gp_l1_reg_loss: 5236.7448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27363.8871; train_global_loss: 375358.0208; train_optim_loss: 375358.0208; val_kl_reg_loss: 12279.6800; val_edge_recon_loss: 101338.3841; val_gene_expr_recon_loss: 227548.6458; val_masked_gp_l1_reg_loss: 5277.0713; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25261.0000; val_global_loss: 371704.7760; val_optim_loss: 371704.7760
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8540; val_auprc_score: 0.9663; val_best_acc_score: 0.8881; val_best_f1_score: 0.9369; train_kl_reg_loss: 12768.7212; train_edge_recon_loss: 97841.7093; train_gene_expr_recon_loss: 226575.5263; train_masked_gp_l1_reg_loss: 5309.7440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23541.7494; train_global_loss: 366037.4525; train_optim_loss: 366037.4525; val_kl_reg_loss: 12627.4562; val_edge_recon_loss: 103565.4336; val_gene_expr_recon_loss: 224061.4193; val_masked_gp_l1_reg_loss: 5343.8306; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21895.8301; val_global_loss: 367494.0052; val_optim_loss: 367494.0052
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8580; val_auprc_score: 0.9684; val_best_acc_score: 0.8926; val_best_f1_score: 0.9398; train_kl_reg_loss: 12598.1532; train_edge_recon_loss: 97132.1775; train_gene_expr_recon_loss: 223794.9326; train_masked_gp_l1_reg_loss: 5373.5822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20559.2456; train_global_loss: 359458.0932; train_optim_loss: 359458.0932; val_kl_reg_loss: 11591.3564; val_edge_recon_loss: 99037.0104; val_gene_expr_recon_loss: 222271.3307; val_masked_gp_l1_reg_loss: 5403.4082; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19285.7734; val_global_loss: 357588.8854; val_optim_loss: 357588.8854
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8616; val_auprc_score: 0.9695; val_best_acc_score: 0.8920; val_best_f1_score: 0.9398; train_kl_reg_loss: 12267.0712; train_edge_recon_loss: 97284.1937; train_gene_expr_recon_loss: 221288.6308; train_masked_gp_l1_reg_loss: 5431.9816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18247.8817; train_global_loss: 354519.7575; train_optim_loss: 354519.7575; val_kl_reg_loss: 12317.6532; val_edge_recon_loss: 98538.3464; val_gene_expr_recon_loss: 219098.3776; val_masked_gp_l1_reg_loss: 5460.9590; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17251.4824; val_global_loss: 352666.8125; val_optim_loss: 352666.8125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8694; val_auprc_score: 0.9712; val_best_acc_score: 0.8968; val_best_f1_score: 0.9421; train_kl_reg_loss: 12149.8250; train_edge_recon_loss: 95775.2879; train_gene_expr_recon_loss: 218980.4664; train_masked_gp_l1_reg_loss: 5485.5562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16438.8421; train_global_loss: 348829.9792; train_optim_loss: 348829.9792; val_kl_reg_loss: 12010.5410; val_edge_recon_loss: 98238.8672; val_gene_expr_recon_loss: 217134.2812; val_masked_gp_l1_reg_loss: 5513.3003; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15658.6367; val_global_loss: 348555.6302; val_optim_loss: 348555.6302
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8729; val_auprc_score: 0.9717; val_best_acc_score: 0.9040; val_best_f1_score: 0.9460; train_kl_reg_loss: 11916.8052; train_edge_recon_loss: 95555.7378; train_gene_expr_recon_loss: 216839.4433; train_masked_gp_l1_reg_loss: 5538.3776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15016.1438; train_global_loss: 344866.5075; train_optim_loss: 344866.5075; val_kl_reg_loss: 11734.4567; val_edge_recon_loss: 95054.2344; val_gene_expr_recon_loss: 215604.6172; val_masked_gp_l1_reg_loss: 5562.1660; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14395.4941; val_global_loss: 342350.9635; val_optim_loss: 342350.9635
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8879; val_auprc_score: 0.9748; val_best_acc_score: 0.9050; val_best_f1_score: 0.9462; train_kl_reg_loss: 11820.3372; train_edge_recon_loss: 94310.2459; train_gene_expr_recon_loss: 214735.3620; train_masked_gp_l1_reg_loss: 5582.1233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13882.0956; train_global_loss: 340330.1644; train_optim_loss: 340330.1644; val_kl_reg_loss: 11422.6979; val_edge_recon_loss: 95492.7474; val_gene_expr_recon_loss: 213045.8385; val_masked_gp_l1_reg_loss: 5600.9282; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13383.5684; val_global_loss: 338945.7917; val_optim_loss: 338945.7917
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8981; val_auprc_score: 0.9772; val_best_acc_score: 0.9087; val_best_f1_score: 0.9484; train_kl_reg_loss: 11783.6529; train_edge_recon_loss: 94039.7442; train_gene_expr_recon_loss: 212927.9988; train_masked_gp_l1_reg_loss: 5614.9724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12968.4113; train_global_loss: 337334.7836; train_optim_loss: 337334.7836; val_kl_reg_loss: 11421.6077; val_edge_recon_loss: 93799.7474; val_gene_expr_recon_loss: 211081.0599; val_masked_gp_l1_reg_loss: 5629.0728; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12567.8164; val_global_loss: 334499.2917; val_optim_loss: 334499.2917
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9140; val_auprc_score: 0.9807; val_best_acc_score: 0.9184; val_best_f1_score: 0.9532; train_kl_reg_loss: 11800.9861; train_edge_recon_loss: 91800.3038; train_gene_expr_recon_loss: 211076.3108; train_masked_gp_l1_reg_loss: 5634.5420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12227.3581; train_global_loss: 332539.5006; train_optim_loss: 332539.5006; val_kl_reg_loss: 11543.1340; val_edge_recon_loss: 92305.2643; val_gene_expr_recon_loss: 209881.3958; val_masked_gp_l1_reg_loss: 5639.1729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11902.4844; val_global_loss: 331271.4792; val_optim_loss: 331271.4792
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9108; val_auprc_score: 0.9803; val_best_acc_score: 0.9196; val_best_f1_score: 0.9544; train_kl_reg_loss: 11691.9693; train_edge_recon_loss: 91613.5243; train_gene_expr_recon_loss: 209393.3139; train_masked_gp_l1_reg_loss: 5637.3338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11606.6919; train_global_loss: 329942.8362; train_optim_loss: 329942.8362; val_kl_reg_loss: 11003.5330; val_edge_recon_loss: 89132.7148; val_gene_expr_recon_loss: 208048.9479; val_masked_gp_l1_reg_loss: 5633.6108; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11324.9355; val_global_loss: 325143.7604; val_optim_loss: 325143.7604
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9200; val_auprc_score: 0.9815; val_best_acc_score: 0.9199; val_best_f1_score: 0.9541; train_kl_reg_loss: 11251.2648; train_edge_recon_loss: 90274.7167; train_gene_expr_recon_loss: 207717.0697; train_masked_gp_l1_reg_loss: 5621.4964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11066.4129; train_global_loss: 325930.9583; train_optim_loss: 325930.9583; val_kl_reg_loss: 10517.4162; val_edge_recon_loss: 93658.5677; val_gene_expr_recon_loss: 205896.4922; val_masked_gp_l1_reg_loss: 5606.4287; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10804.5029; val_global_loss: 326483.4115; val_optim_loss: 326483.4115
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9174; val_auprc_score: 0.9826; val_best_acc_score: 0.9230; val_best_f1_score: 0.9561; train_kl_reg_loss: 10961.6458; train_edge_recon_loss: 89871.8105; train_gene_expr_recon_loss: 206140.0095; train_masked_gp_l1_reg_loss: 5584.8928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10583.5396; train_global_loss: 323141.8964; train_optim_loss: 323141.8964; val_kl_reg_loss: 10503.2762; val_edge_recon_loss: 89137.9193; val_gene_expr_recon_loss: 204576.1354; val_masked_gp_l1_reg_loss: 5558.3564; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10359.5166; val_global_loss: 320135.2031; val_optim_loss: 320135.2031
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9169; val_auprc_score: 0.9804; val_best_acc_score: 0.9201; val_best_f1_score: 0.9542; train_kl_reg_loss: 10657.4059; train_edge_recon_loss: 88996.4252; train_gene_expr_recon_loss: 204520.4421; train_masked_gp_l1_reg_loss: 5524.0618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10163.1795; train_global_loss: 319861.5145; train_optim_loss: 319861.5145; val_kl_reg_loss: 10121.7415; val_edge_recon_loss: 92012.2826; val_gene_expr_recon_loss: 203165.5625; val_masked_gp_l1_reg_loss: 5485.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9974.3184; val_global_loss: 320758.9583; val_optim_loss: 320758.9583
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9256; val_auprc_score: 0.9835; val_best_acc_score: 0.9252; val_best_f1_score: 0.9573; train_kl_reg_loss: 10121.4826; train_edge_recon_loss: 88316.3216; train_gene_expr_recon_loss: 203030.8681; train_masked_gp_l1_reg_loss: 5440.1479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9793.9920; train_global_loss: 316702.8096; train_optim_loss: 316702.8096; val_kl_reg_loss: 9641.1951; val_edge_recon_loss: 88168.7266; val_gene_expr_recon_loss: 201767.7839; val_masked_gp_l1_reg_loss: 5391.4424; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9624.0020; val_global_loss: 314593.1406; val_optim_loss: 314593.1406
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9238; val_auprc_score: 0.9822; val_best_acc_score: 0.9263; val_best_f1_score: 0.9577; train_kl_reg_loss: 9826.7344; train_edge_recon_loss: 88537.3474; train_gene_expr_recon_loss: 201492.0625; train_masked_gp_l1_reg_loss: 5333.9934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9467.3862; train_global_loss: 314657.5237; train_optim_loss: 314657.5237; val_kl_reg_loss: 9554.2588; val_edge_recon_loss: 88459.5742; val_gene_expr_recon_loss: 200025.0391; val_masked_gp_l1_reg_loss: 5273.2720; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9314.0352; val_global_loss: 312626.1875; val_optim_loss: 312626.1875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9316; val_auprc_score: 0.9847; val_best_acc_score: 0.9254; val_best_f1_score: 0.9574; train_kl_reg_loss: 9381.1359; train_edge_recon_loss: 86217.1748; train_gene_expr_recon_loss: 200025.0972; train_masked_gp_l1_reg_loss: 5207.4910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9170.6931; train_global_loss: 310001.5897; train_optim_loss: 310001.5897; val_kl_reg_loss: 9330.1657; val_edge_recon_loss: 87148.8802; val_gene_expr_recon_loss: 198758.9896; val_masked_gp_l1_reg_loss: 5137.0049; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9030.9902; val_global_loss: 309406.0365; val_optim_loss: 309406.0365
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9382; val_auprc_score: 0.9871; val_best_acc_score: 0.9316; val_best_f1_score: 0.9612; train_kl_reg_loss: 9012.6572; train_edge_recon_loss: 86083.7556; train_gene_expr_recon_loss: 198605.2587; train_masked_gp_l1_reg_loss: 5061.1701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8898.1975; train_global_loss: 307661.0370; train_optim_loss: 307661.0370; val_kl_reg_loss: 8367.4453; val_edge_recon_loss: 84104.1927; val_gene_expr_recon_loss: 197449.5938; val_masked_gp_l1_reg_loss: 4980.6416; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8767.0918; val_global_loss: 303668.9792; val_optim_loss: 303668.9792
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9349; val_auprc_score: 0.9850; val_best_acc_score: 0.9294; val_best_f1_score: 0.9595; train_kl_reg_loss: 8661.6894; train_edge_recon_loss: 85487.9790; train_gene_expr_recon_loss: 197187.7321; train_masked_gp_l1_reg_loss: 4897.9946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8638.1890; train_global_loss: 304873.5833; train_optim_loss: 304873.5833; val_kl_reg_loss: 7726.5802; val_edge_recon_loss: 87369.7044; val_gene_expr_recon_loss: 195908.8880; val_masked_gp_l1_reg_loss: 4810.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8507.8525; val_global_loss: 304323.8281; val_optim_loss: 304323.8281
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9366; val_auprc_score: 0.9863; val_best_acc_score: 0.9273; val_best_f1_score: 0.9583; train_kl_reg_loss: 5743.6602; train_edge_recon_loss: 84979.7036; train_gene_expr_recon_loss: 326472.0133; train_masked_gp_l1_reg_loss: 4780.3614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7109.9640; train_global_loss: 429085.7014; train_optim_loss: 429085.7014; val_kl_reg_loss: 3378.8505; val_edge_recon_loss: 82293.6484; val_gene_expr_recon_loss: 282410.2917; val_masked_gp_l1_reg_loss: 4748.7280; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5637.6074; val_global_loss: 378469.1042; val_optim_loss: 378469.1042
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9398; val_auprc_score: 0.9856; val_best_acc_score: 0.9331; val_best_f1_score: 0.9616; train_kl_reg_loss: 4141.1883; train_edge_recon_loss: 80910.7526; train_gene_expr_recon_loss: 261369.5518; train_masked_gp_l1_reg_loss: 4641.9189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4776.9832; train_global_loss: 355840.3929; train_optim_loss: 355840.3929; val_kl_reg_loss: 2834.3747; val_edge_recon_loss: 81079.3971; val_gene_expr_recon_loss: 243513.8698; val_masked_gp_l1_reg_loss: 4509.5693; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4096.1943; val_global_loss: 336033.3906; val_optim_loss: 336033.3906
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9445; val_auprc_score: 0.9874; val_best_acc_score: 0.9306; val_best_f1_score: 0.9595; train_kl_reg_loss: 3508.8098; train_edge_recon_loss: 80309.7289; train_gene_expr_recon_loss: 233492.0854; train_masked_gp_l1_reg_loss: 4364.1239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3694.0624; train_global_loss: 325368.8096; train_optim_loss: 325368.8096; val_kl_reg_loss: 2698.2871; val_edge_recon_loss: 85015.7188; val_gene_expr_recon_loss: 224165.0182; val_masked_gp_l1_reg_loss: 4213.2432; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3355.2371; val_global_loss: 319447.5312; val_optim_loss: 319447.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9458; val_auprc_score: 0.9878; val_best_acc_score: 0.9345; val_best_f1_score: 0.9623; train_kl_reg_loss: 3141.9531; train_edge_recon_loss: 79318.5511; train_gene_expr_recon_loss: 224071.3605; train_masked_gp_l1_reg_loss: 4174.0810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3262.0557; train_global_loss: 313967.9988; train_optim_loss: 313967.9988; val_kl_reg_loss: 2560.0186; val_edge_recon_loss: 81069.7109; val_gene_expr_recon_loss: 223203.2083; val_masked_gp_l1_reg_loss: 4153.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3220.5942; val_global_loss: 314207.3333; val_optim_loss: 314207.3333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9500; val_auprc_score: 0.9893; val_best_acc_score: 0.9383; val_best_f1_score: 0.9643; train_kl_reg_loss: 3031.0075; train_edge_recon_loss: 79581.4524; train_gene_expr_recon_loss: 222854.9349; train_masked_gp_l1_reg_loss: 4138.9094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3194.7901; train_global_loss: 312801.0949; train_optim_loss: 312801.0949; val_kl_reg_loss: 2470.0894; val_edge_recon_loss: 79507.8125; val_gene_expr_recon_loss: 222023.8880; val_masked_gp_l1_reg_loss: 4123.7979; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3168.7710; val_global_loss: 311294.3854; val_optim_loss: 311294.3854
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9471; val_auprc_score: 0.9886; val_best_acc_score: 0.9376; val_best_f1_score: 0.9641; train_kl_reg_loss: 2985.5898; train_edge_recon_loss: 78562.2682; train_gene_expr_recon_loss: 221756.6739; train_masked_gp_l1_reg_loss: 4108.8153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3144.1676; train_global_loss: 310557.5133; train_optim_loss: 310557.5133; val_kl_reg_loss: 2483.8828; val_edge_recon_loss: 79391.0469; val_gene_expr_recon_loss: 220842.0234; val_masked_gp_l1_reg_loss: 4093.4021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3119.1309; val_global_loss: 309929.4792; val_optim_loss: 309929.4792
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9478; val_auprc_score: 0.9887; val_best_acc_score: 0.9390; val_best_f1_score: 0.9647; train_kl_reg_loss: 2944.9085; train_edge_recon_loss: 79297.2124; train_gene_expr_recon_loss: 220690.9465; train_masked_gp_l1_reg_loss: 4078.1675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3094.8746; train_global_loss: 310106.1105; train_optim_loss: 310106.1105; val_kl_reg_loss: 2481.4166; val_edge_recon_loss: 79245.7292; val_gene_expr_recon_loss: 219610.6432; val_masked_gp_l1_reg_loss: 4062.3408; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3069.8972; val_global_loss: 308470.0365; val_optim_loss: 308470.0365

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 56 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9337
val AUPRC score: 0.9848
val best accuracy score: 0.9274
val best F1 score: 0.9587
val target rna MSE score: 26.3076
val source rna MSE score: 73.6447
Val cat covariate0 mean sim diff: -0.0016

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
