[True]
Run timestamp: 10082023_204907_43.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_43']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7883; val_auprc_score: 0.8016; val_best_acc_score: 0.5755; val_best_f1_score: 0.6958; train_kl_reg_loss: 327869.4572; train_edge_recon_loss: 3936264.2195; train_gene_expr_recon_loss: 31864510.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 134272961.0992; train_global_loss: 170401604.7634; train_optim_loss: 170401604.7634; val_kl_reg_loss: 133262.1948; val_edge_recon_loss: 4061105.6833; val_gene_expr_recon_loss: 24314731.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 116293110.4000; val_global_loss: 144802209.0667; val_optim_loss: 144802209.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7702; val_auprc_score: 0.7996; val_best_acc_score: 0.6668; val_best_f1_score: 0.7121; train_kl_reg_loss: 156158.5714; train_edge_recon_loss: 3908789.0878; train_gene_expr_recon_loss: 24019361.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 116747590.6565; train_global_loss: 144831899.7252; train_optim_loss: 144831899.7252; val_kl_reg_loss: 79788.8651; val_edge_recon_loss: 4047615.4667; val_gene_expr_recon_loss: 22938945.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 114474210.1333; val_global_loss: 141540558.9333; val_optim_loss: 141540558.9333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8298; val_auprc_score: 0.8340; val_best_acc_score: 0.7309; val_best_f1_score: 0.7585; train_kl_reg_loss: 149123.8555; train_edge_recon_loss: 3805546.8130; train_gene_expr_recon_loss: 22792226.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 115383136.1221; train_global_loss: 142130032.8550; train_optim_loss: 142130032.8550; val_kl_reg_loss: 180844.7802; val_edge_recon_loss: 3917543.0167; val_gene_expr_recon_loss: 22128950.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 113374366.9333; val_global_loss: 139601705.0667; val_optim_loss: 139601705.0667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8573; val_auprc_score: 0.8506; val_best_acc_score: 0.7595; val_best_f1_score: 0.7893; train_kl_reg_loss: 151581.3221; train_edge_recon_loss: 3578199.6947; train_gene_expr_recon_loss: 22930738.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 115641826.7481; train_global_loss: 142302346.4427; train_optim_loss: 142302346.4427; val_kl_reg_loss: 136662.6578; val_edge_recon_loss: 3438425.7833; val_gene_expr_recon_loss: 22177573.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 113095703.4667; val_global_loss: 138848364.2667; val_optim_loss: 138848364.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8627; val_auprc_score: 0.8598; val_best_acc_score: 0.7643; val_best_f1_score: 0.7884; train_kl_reg_loss: 152458.4738; train_edge_recon_loss: 3281441.0840; train_gene_expr_recon_loss: 22567805.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113987609.4656; train_global_loss: 139989314.0763; train_optim_loss: 139989314.0763; val_kl_reg_loss: 167007.9604; val_edge_recon_loss: 3175535.7000; val_gene_expr_recon_loss: 21923459.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112791554.6667; val_global_loss: 138057556.8000; val_optim_loss: 138057556.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8761; val_auprc_score: 0.8688; val_best_acc_score: 0.7887; val_best_f1_score: 0.8038; train_kl_reg_loss: 192018.3231; train_edge_recon_loss: 3096505.1508; train_gene_expr_recon_loss: 21940395.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113069633.2214; train_global_loss: 138298552.0611; train_optim_loss: 138298552.0611; val_kl_reg_loss: 193960.6854; val_edge_recon_loss: 3062299.9333; val_gene_expr_recon_loss: 21833356.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112506883.2000; val_global_loss: 137596499.7333; val_optim_loss: 137596499.7333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8876; val_auprc_score: 0.8782; val_best_acc_score: 0.8038; val_best_f1_score: 0.8186; train_kl_reg_loss: 197150.5726; train_edge_recon_loss: 3050105.4981; train_gene_expr_recon_loss: 21795379.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 112346706.1374; train_global_loss: 137389341.4351; train_optim_loss: 137389341.4351; val_kl_reg_loss: 192760.3385; val_edge_recon_loss: 3035870.9000; val_gene_expr_recon_loss: 21550563.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111177444.8000; val_global_loss: 135956638.9333; val_optim_loss: 135956638.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9015; val_auprc_score: 0.8897; val_best_acc_score: 0.8220; val_best_f1_score: 0.8331; train_kl_reg_loss: 191711.5923; train_edge_recon_loss: 3000284.0305; train_gene_expr_recon_loss: 21655350.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111714035.3588; train_global_loss: 136561381.6183; train_optim_loss: 136561381.6183; val_kl_reg_loss: 183681.7354; val_edge_recon_loss: 2990239.9167; val_gene_expr_recon_loss: 21449251.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110292178.6667; val_global_loss: 134915351.4667; val_optim_loss: 134915351.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9124; val_auprc_score: 0.9001; val_best_acc_score: 0.8319; val_best_f1_score: 0.8444; train_kl_reg_loss: 186260.1282; train_edge_recon_loss: 2957450.1565; train_gene_expr_recon_loss: 21558816.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111377546.0763; train_global_loss: 136080072.3664; train_optim_loss: 136080072.3664; val_kl_reg_loss: 178864.2771; val_edge_recon_loss: 2927298.6500; val_gene_expr_recon_loss: 21350759.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110094864.0000; val_global_loss: 134551787.2000; val_optim_loss: 134551787.2000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9171; val_auprc_score: 0.9050; val_best_acc_score: 0.8401; val_best_f1_score: 0.8507; train_kl_reg_loss: 179513.7127; train_edge_recon_loss: 2927722.5878; train_gene_expr_recon_loss: 21463296.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110735602.0153; train_global_loss: 135306135.2061; train_optim_loss: 135306135.2061; val_kl_reg_loss: 173382.6969; val_edge_recon_loss: 2925872.4500; val_gene_expr_recon_loss: 21276855.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109795822.4000; val_global_loss: 134171933.3333; val_optim_loss: 134171933.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9215; val_auprc_score: 0.9075; val_best_acc_score: 0.8473; val_best_f1_score: 0.8589; train_kl_reg_loss: 176103.6240; train_edge_recon_loss: 2899050.3645; train_gene_expr_recon_loss: 21368214.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110236470.9008; train_global_loss: 134679839.4504; train_optim_loss: 134679839.4504; val_kl_reg_loss: 173964.8823; val_edge_recon_loss: 2924895.1833; val_gene_expr_recon_loss: 21246712.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109821062.4000; val_global_loss: 134166636.2667; val_optim_loss: 134166636.2667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9131; val_auprc_score: 0.8977; val_best_acc_score: 0.8395; val_best_f1_score: 0.8532; train_kl_reg_loss: 208456.1165; train_edge_recon_loss: 2897363.1851; train_gene_expr_recon_loss: 21680652.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110499445.8626; train_global_loss: 135285917.3130; train_optim_loss: 135285917.3130; val_kl_reg_loss: 177449.6021; val_edge_recon_loss: 2916265.8667; val_gene_expr_recon_loss: 21229714.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109499803.2000; val_global_loss: 133823234.1333; val_optim_loss: 133823234.1333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9183; val_auprc_score: 0.9032; val_best_acc_score: 0.8496; val_best_f1_score: 0.8611; train_kl_reg_loss: 626350.0446; train_edge_recon_loss: 2926004.7958; train_gene_expr_recon_loss: 21538487.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110924407.3282; train_global_loss: 136015250.2595; train_optim_loss: 136015250.2595; val_kl_reg_loss: 184366.9771; val_edge_recon_loss: 2881629.7000; val_gene_expr_recon_loss: 21137330.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108200418.1333; val_global_loss: 132403745.0667; val_optim_loss: 132403745.0667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9121; val_auprc_score: 0.8965; val_best_acc_score: 0.8389; val_best_f1_score: 0.8506; train_kl_reg_loss: 4130486770.8619; train_edge_recon_loss: 2946855.5134; train_gene_expr_recon_loss: 21633489.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110055517.0687; train_global_loss: 4265122816.9160; train_optim_loss: 4265122816.9160; val_kl_reg_loss: 10913184.9823; val_edge_recon_loss: 3107243.2833; val_gene_expr_recon_loss: 21607136.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109163134.4000; val_global_loss: 144790700.2667; val_optim_loss: 144790700.2667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9147; val_auprc_score: 0.9013; val_best_acc_score: 0.8371; val_best_f1_score: 0.8511; train_kl_reg_loss: 539073264.2931; train_edge_recon_loss: 3040372.1985; train_gene_expr_recon_loss: 23242244.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 114137304.3664; train_global_loss: 679493202.8702; train_optim_loss: 679493202.8702; val_kl_reg_loss: 204039.0625; val_edge_recon_loss: 3014539.7667; val_gene_expr_recon_loss: 22115504.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110036331.7333; val_global_loss: 135370416.0000; val_optim_loss: 135370416.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9115; val_auprc_score: 0.8946; val_best_acc_score: 0.8411; val_best_f1_score: 0.8534; train_kl_reg_loss: 425987618.6900; train_edge_recon_loss: 2978309.4427; train_gene_expr_recon_loss: 21826186.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110093733.8015; train_global_loss: 560885845.3130; train_optim_loss: 560885845.3130; val_kl_reg_loss: 204438.1990; val_edge_recon_loss: 2949907.7667; val_gene_expr_recon_loss: 21623992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108946768.0000; val_global_loss: 133725106.6667; val_optim_loss: 133725106.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9211; val_auprc_score: 0.9084; val_best_acc_score: 0.8498; val_best_f1_score: 0.8592; train_kl_reg_loss: 858016.1484; train_edge_recon_loss: 2943807.7061; train_gene_expr_recon_loss: 21584332.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109339145.6489; train_global_loss: 134725302.1679; train_optim_loss: 134725302.1679; val_kl_reg_loss: 187863.2708; val_edge_recon_loss: 2943410.1500; val_gene_expr_recon_loss: 21328722.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108754172.2667; val_global_loss: 133214168.0000; val_optim_loss: 133214168.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9171; val_auprc_score: 0.9034; val_best_acc_score: 0.8422; val_best_f1_score: 0.8516; train_kl_reg_loss: 194711.1820; train_edge_recon_loss: 2940579.2939; train_gene_expr_recon_loss: 21424664.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109385724.0305; train_global_loss: 133945679.5725; train_optim_loss: 133945679.5725; val_kl_reg_loss: 195521.9021; val_edge_recon_loss: 2963156.4333; val_gene_expr_recon_loss: 21237829.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108370358.9333; val_global_loss: 132766866.1333; val_optim_loss: 132766866.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9158; val_auprc_score: 0.9018; val_best_acc_score: 0.8416; val_best_f1_score: 0.8519; train_kl_reg_loss: 199927.5549; train_edge_recon_loss: 2916965.8492; train_gene_expr_recon_loss: 21370251.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108929370.5038; train_global_loss: 133416515.6641; train_optim_loss: 133416515.6641; val_kl_reg_loss: 199499.8948; val_edge_recon_loss: 2941550.5667; val_gene_expr_recon_loss: 21204850.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108051857.6000; val_global_loss: 132397758.4000; val_optim_loss: 132397758.4000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9156; val_auprc_score: 0.9019; val_best_acc_score: 0.8390; val_best_f1_score: 0.8513; train_kl_reg_loss: 203064.7275; train_edge_recon_loss: 2908852.2405; train_gene_expr_recon_loss: 21312723.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108809975.6336; train_global_loss: 133234615.9389; train_optim_loss: 133234615.9389; val_kl_reg_loss: 200578.2990; val_edge_recon_loss: 2924879.4833; val_gene_expr_recon_loss: 21116416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107192003.2000; val_global_loss: 131433876.8000; val_optim_loss: 131433876.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9148; val_auprc_score: 0.8989; val_best_acc_score: 0.8441; val_best_f1_score: 0.8548; train_kl_reg_loss: 205024.5479; train_edge_recon_loss: 2906946.6088; train_gene_expr_recon_loss: 21328060.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108939825.2824; train_global_loss: 133379856.5496; train_optim_loss: 133379856.5496; val_kl_reg_loss: 203767.6802; val_edge_recon_loss: 2913921.1833; val_gene_expr_recon_loss: 21169382.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107782580.2667; val_global_loss: 132069653.3333; val_optim_loss: 132069653.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9213; val_auprc_score: 0.9072; val_best_acc_score: 0.8494; val_best_f1_score: 0.8599; train_kl_reg_loss: 252876.1052; train_edge_recon_loss: 2891366.0324; train_gene_expr_recon_loss: 21328432.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108758284.0305; train_global_loss: 133230959.2061; train_optim_loss: 133230959.2061; val_kl_reg_loss: 200933.8052; val_edge_recon_loss: 2890988.7667; val_gene_expr_recon_loss: 21219177.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108116469.8667; val_global_loss: 132427569.0667; val_optim_loss: 132427569.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9162; val_auprc_score: 0.9019; val_best_acc_score: 0.8420; val_best_f1_score: 0.8541; train_kl_reg_loss: 202665.3575; train_edge_recon_loss: 2891340.1603; train_gene_expr_recon_loss: 21237278.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108427619.2977; train_global_loss: 132758903.0840; train_optim_loss: 132758903.0840; val_kl_reg_loss: 198457.3948; val_edge_recon_loss: 2911386.6000; val_gene_expr_recon_loss: 21068387.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107170157.8667; val_global_loss: 131348389.8667; val_optim_loss: 131348389.8667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9174; val_auprc_score: 0.9011; val_best_acc_score: 0.8447; val_best_f1_score: 0.8591; train_kl_reg_loss: 213162.6149; train_edge_recon_loss: 2891743.1832; train_gene_expr_recon_loss: 21235427.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108547404.1527; train_global_loss: 132887736.7328; train_optim_loss: 132887736.7328; val_kl_reg_loss: 196354.4094; val_edge_recon_loss: 2892420.6667; val_gene_expr_recon_loss: 21063135.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107689337.6000; val_global_loss: 131841248.0000; val_optim_loss: 131841248.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9221; val_auprc_score: 0.9064; val_best_acc_score: 0.8492; val_best_f1_score: 0.8609; train_kl_reg_loss: 201890.6201; train_edge_recon_loss: 2886775.7710; train_gene_expr_recon_loss: 21241193.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108466030.1069; train_global_loss: 132795890.0763; train_optim_loss: 132795890.0763; val_kl_reg_loss: 199301.3333; val_edge_recon_loss: 2881115.4167; val_gene_expr_recon_loss: 21145672.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108278811.7333; val_global_loss: 132504900.2667; val_optim_loss: 132504900.2667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9211; val_auprc_score: 0.9044; val_best_acc_score: 0.8498; val_best_f1_score: 0.8595; train_kl_reg_loss: 200764.3279; train_edge_recon_loss: 2926804.3645; train_gene_expr_recon_loss: 21832666.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109453199.0840; train_global_loss: 134413434.5649; train_optim_loss: 134413434.5649; val_kl_reg_loss: 111976.7729; val_edge_recon_loss: 2929234.6333; val_gene_expr_recon_loss: 21467098.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107790438.9333; val_global_loss: 132298749.3333; val_optim_loss: 132298749.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9229; val_auprc_score: 0.9097; val_best_acc_score: 0.8475; val_best_f1_score: 0.8605; train_kl_reg_loss: 201170.2853; train_edge_recon_loss: 2935676.8912; train_gene_expr_recon_loss: 21588890.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108949043.0534; train_global_loss: 133674780.0305; train_optim_loss: 133674780.0305; val_kl_reg_loss: 113040.8141; val_edge_recon_loss: 2928793.2167; val_gene_expr_recon_loss: 21557043.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108635973.8667; val_global_loss: 133234853.3333; val_optim_loss: 133234853.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9241; val_auprc_score: 0.9098; val_best_acc_score: 0.8523; val_best_f1_score: 0.8651; train_kl_reg_loss: 200432.5281; train_edge_recon_loss: 2932965.2882; train_gene_expr_recon_loss: 21519228.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108941239.9389; train_global_loss: 133593865.7710; train_optim_loss: 133593865.7710; val_kl_reg_loss: 112367.2130; val_edge_recon_loss: 2920272.9500; val_gene_expr_recon_loss: 21492673.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108446554.6667; val_global_loss: 132971869.3333; val_optim_loss: 132971869.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9166; val_auprc_score: 0.9018; val_best_acc_score: 0.8438; val_best_f1_score: 0.8545; train_kl_reg_loss: 327190.2242; train_edge_recon_loss: 2923363.8435; train_gene_expr_recon_loss: 21526291.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108952288.4275; train_global_loss: 133729133.5573; train_optim_loss: 133729133.5573; val_kl_reg_loss: 112128.6172; val_edge_recon_loss: 2931686.0167; val_gene_expr_recon_loss: 21476646.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108218939.7333; val_global_loss: 132739400.5333; val_optim_loss: 132739400.5333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9179; val_auprc_score: 0.9019; val_best_acc_score: 0.8437; val_best_f1_score: 0.8552; train_kl_reg_loss: 200518.7513; train_edge_recon_loss: 2933599.7214; train_gene_expr_recon_loss: 21564933.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109134376.2443; train_global_loss: 133833428.2137; train_optim_loss: 133833428.2137; val_kl_reg_loss: 112090.6938; val_edge_recon_loss: 2942323.7833; val_gene_expr_recon_loss: 21405180.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108281199.4667; val_global_loss: 132740796.2667; val_optim_loss: 132740796.2667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9144; val_auprc_score: 0.8996; val_best_acc_score: 0.8407; val_best_f1_score: 0.8513; train_kl_reg_loss: 200293.5734; train_edge_recon_loss: 2922528.7519; train_gene_expr_recon_loss: 21563474.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108998722.0763; train_global_loss: 133685019.2977; train_optim_loss: 133685019.2977; val_kl_reg_loss: 111208.8214; val_edge_recon_loss: 2970644.9667; val_gene_expr_recon_loss: 21390801.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108329523.2000; val_global_loss: 132802179.2000; val_optim_loss: 132802179.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 37 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9130
val AUPRC score: 0.9003
val best accuracy score: 0.8354
val best F1 score: 0.8480
val target rna MSE score: 1.5694
val source rna MSE score: 189.8134
val target atac MSE score: 0.1495
val source atac MSE score: 1.0235
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
