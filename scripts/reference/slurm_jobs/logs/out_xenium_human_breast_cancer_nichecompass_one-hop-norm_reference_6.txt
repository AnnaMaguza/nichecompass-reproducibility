Run timestamp: 20062023_165327_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 313, n_cond_embed_input: 2, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1302, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cond_embed_input: 2, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 254127
Number of validation nodes: 28236
Number of training edges: 1717813
Number of validation edges: 190868
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9853; val_auprc_score: 0.9909; val_best_acc_score: 0.9534; val_best_f1_score: 0.9654; train_kl_reg_loss: 5127.4244; train_edge_recon_loss: 181425.6358; train_gene_expr_recon_loss: 74308.1186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260861.1791; train_optim_loss: 260861.1791; val_kl_reg_loss: 4719.7875; val_edge_recon_loss: 177350.7787; val_gene_expr_recon_loss: 68151.2682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250221.8348; val_optim_loss: 250221.8348
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9891; val_auprc_score: 0.9933; val_best_acc_score: 0.9614; val_best_f1_score: 0.9712; train_kl_reg_loss: 4865.5446; train_edge_recon_loss: 177323.8790; train_gene_expr_recon_loss: 67083.8479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 249273.2716; train_optim_loss: 249273.2716; val_kl_reg_loss: 4877.3996; val_edge_recon_loss: 177611.9337; val_gene_expr_recon_loss: 66430.2139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248919.5470; val_optim_loss: 248919.5470
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9913; val_auprc_score: 0.9945; val_best_acc_score: 0.9657; val_best_f1_score: 0.9744; train_kl_reg_loss: 4886.5785; train_edge_recon_loss: 176922.0429; train_gene_expr_recon_loss: 65992.7317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 247801.3530; train_optim_loss: 247801.3530; val_kl_reg_loss: 4854.5631; val_edge_recon_loss: 177313.2848; val_gene_expr_recon_loss: 65706.5108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247874.3590; val_optim_loss: 247874.3590
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9923; val_auprc_score: 0.9952; val_best_acc_score: 0.9692; val_best_f1_score: 0.9769; train_kl_reg_loss: 4900.5292; train_edge_recon_loss: 176599.2041; train_gene_expr_recon_loss: 65526.8325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 247026.5661; train_optim_loss: 247026.5661; val_kl_reg_loss: 4850.0533; val_edge_recon_loss: 176517.2790; val_gene_expr_recon_loss: 65401.4464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246768.7789; val_optim_loss: 246768.7789
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9928; val_auprc_score: 0.9955; val_best_acc_score: 0.9709; val_best_f1_score: 0.9782; train_kl_reg_loss: 4920.6999; train_edge_recon_loss: 176458.9468; train_gene_expr_recon_loss: 65284.4882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246664.1350; train_optim_loss: 246664.1350; val_kl_reg_loss: 4886.2800; val_edge_recon_loss: 176412.9520; val_gene_expr_recon_loss: 65211.4512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246510.6833; val_optim_loss: 246510.6833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9926; val_auprc_score: 0.9955; val_best_acc_score: 0.9711; val_best_f1_score: 0.9784; train_kl_reg_loss: 4938.6846; train_edge_recon_loss: 176515.4731; train_gene_expr_recon_loss: 65086.0658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246540.2234; train_optim_loss: 246540.2234; val_kl_reg_loss: 4902.4294; val_edge_recon_loss: 176240.9000; val_gene_expr_recon_loss: 65091.7654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246235.0944; val_optim_loss: 246235.0944
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9931; val_auprc_score: 0.9957; val_best_acc_score: 0.9718; val_best_f1_score: 0.9789; train_kl_reg_loss: 4950.4462; train_edge_recon_loss: 176368.4230; train_gene_expr_recon_loss: 64997.2651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246316.1341; train_optim_loss: 246316.1341; val_kl_reg_loss: 4858.8292; val_edge_recon_loss: 176444.6111; val_gene_expr_recon_loss: 65000.3048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246303.7445; val_optim_loss: 246303.7445
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9934; val_auprc_score: 0.9958; val_best_acc_score: 0.9722; val_best_f1_score: 0.9792; train_kl_reg_loss: 4954.6922; train_edge_recon_loss: 176390.8654; train_gene_expr_recon_loss: 64894.4674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246240.0248; train_optim_loss: 246240.0248; val_kl_reg_loss: 4845.8649; val_edge_recon_loss: 176388.4657; val_gene_expr_recon_loss: 64990.9497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246225.2795; val_optim_loss: 246225.2795
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9928; val_auprc_score: 0.9955; val_best_acc_score: 0.9711; val_best_f1_score: 0.9783; train_kl_reg_loss: 4967.9484; train_edge_recon_loss: 176287.5877; train_gene_expr_recon_loss: 64841.3395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246096.8754; train_optim_loss: 246096.8754; val_kl_reg_loss: 4877.8866; val_edge_recon_loss: 176419.2138; val_gene_expr_recon_loss: 64863.5891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246160.6889; val_optim_loss: 246160.6889
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9938; val_auprc_score: 0.9961; val_best_acc_score: 0.9735; val_best_f1_score: 0.9801; train_kl_reg_loss: 4969.9911; train_edge_recon_loss: 176225.7839; train_gene_expr_recon_loss: 64792.3898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245988.1650; train_optim_loss: 245988.1650; val_kl_reg_loss: 4941.4468; val_edge_recon_loss: 176437.0084; val_gene_expr_recon_loss: 64881.3721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246259.8275; val_optim_loss: 246259.8275
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9939; val_auprc_score: 0.9963; val_best_acc_score: 0.9728; val_best_f1_score: 0.9796; train_kl_reg_loss: 4982.3002; train_edge_recon_loss: 176218.3559; train_gene_expr_recon_loss: 64733.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245933.8100; train_optim_loss: 245933.8100; val_kl_reg_loss: 4939.2962; val_edge_recon_loss: 176491.5823; val_gene_expr_recon_loss: 64768.1499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246199.0292; val_optim_loss: 246199.0292
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9936; val_auprc_score: 0.9960; val_best_acc_score: 0.9736; val_best_f1_score: 0.9802; train_kl_reg_loss: 4986.5177; train_edge_recon_loss: 175943.6531; train_gene_expr_recon_loss: 64696.8771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245627.0478; train_optim_loss: 245627.0478; val_kl_reg_loss: 4977.3752; val_edge_recon_loss: 175881.0440; val_gene_expr_recon_loss: 64758.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245616.5817; val_optim_loss: 245616.5817
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9944; val_auprc_score: 0.9965; val_best_acc_score: 0.9750; val_best_f1_score: 0.9813; train_kl_reg_loss: 4989.0872; train_edge_recon_loss: 176153.0091; train_gene_expr_recon_loss: 64654.3877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245796.4840; train_optim_loss: 245796.4840; val_kl_reg_loss: 5000.2577; val_edge_recon_loss: 175975.0089; val_gene_expr_recon_loss: 64715.1897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245690.4558; val_optim_loss: 245690.4558
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9942; val_auprc_score: 0.9964; val_best_acc_score: 0.9742; val_best_f1_score: 0.9807; train_kl_reg_loss: 4997.2533; train_edge_recon_loss: 175972.5242; train_gene_expr_recon_loss: 64646.4949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245616.2720; train_optim_loss: 245616.2720; val_kl_reg_loss: 4964.8249; val_edge_recon_loss: 175958.1606; val_gene_expr_recon_loss: 64702.9460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245625.9318; val_optim_loss: 245625.9318
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9940; val_auprc_score: 0.9963; val_best_acc_score: 0.9744; val_best_f1_score: 0.9808; train_kl_reg_loss: 5003.0481; train_edge_recon_loss: 175879.4590; train_gene_expr_recon_loss: 64583.9072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245466.4141; train_optim_loss: 245466.4141; val_kl_reg_loss: 5013.3087; val_edge_recon_loss: 175897.8096; val_gene_expr_recon_loss: 64680.3134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245591.4318; val_optim_loss: 245591.4318
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9941; val_auprc_score: 0.9964; val_best_acc_score: 0.9744; val_best_f1_score: 0.9808; train_kl_reg_loss: 5007.7597; train_edge_recon_loss: 176123.8808; train_gene_expr_recon_loss: 64575.4776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245707.1179; train_optim_loss: 245707.1179; val_kl_reg_loss: 5003.9439; val_edge_recon_loss: 176304.1947; val_gene_expr_recon_loss: 64649.4462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245957.5849; val_optim_loss: 245957.5849
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9945; val_auprc_score: 0.9966; val_best_acc_score: 0.9758; val_best_f1_score: 0.9818; train_kl_reg_loss: 5011.0690; train_edge_recon_loss: 175915.0181; train_gene_expr_recon_loss: 64552.8823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245478.9697; train_optim_loss: 245478.9697; val_kl_reg_loss: 4957.8464; val_edge_recon_loss: 175988.0942; val_gene_expr_recon_loss: 64643.8194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245589.7606; val_optim_loss: 245589.7606
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9941; val_auprc_score: 0.9963; val_best_acc_score: 0.9749; val_best_f1_score: 0.9812; train_kl_reg_loss: 5017.8049; train_edge_recon_loss: 175843.5334; train_gene_expr_recon_loss: 64527.6921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245389.0303; train_optim_loss: 245389.0303; val_kl_reg_loss: 4998.5308; val_edge_recon_loss: 175809.4417; val_gene_expr_recon_loss: 64668.4251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245476.3972; val_optim_loss: 245476.3972
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9941; val_auprc_score: 0.9963; val_best_acc_score: 0.9747; val_best_f1_score: 0.9810; train_kl_reg_loss: 5018.9832; train_edge_recon_loss: 175987.2265; train_gene_expr_recon_loss: 64510.3348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245516.5447; train_optim_loss: 245516.5447; val_kl_reg_loss: 4942.1489; val_edge_recon_loss: 176018.8553; val_gene_expr_recon_loss: 64567.0072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245528.0110; val_optim_loss: 245528.0110
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9945; val_auprc_score: 0.9966; val_best_acc_score: 0.9760; val_best_f1_score: 0.9820; train_kl_reg_loss: 5022.8947; train_edge_recon_loss: 175919.5883; train_gene_expr_recon_loss: 64492.0183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245434.5012; train_optim_loss: 245434.5012; val_kl_reg_loss: 4999.4689; val_edge_recon_loss: 175912.4564; val_gene_expr_recon_loss: 64594.3016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245506.2271; val_optim_loss: 245506.2271
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9944; val_auprc_score: 0.9965; val_best_acc_score: 0.9760; val_best_f1_score: 0.9820; train_kl_reg_loss: 5023.2065; train_edge_recon_loss: 175996.9986; train_gene_expr_recon_loss: 64479.1196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245499.3247; train_optim_loss: 245499.3247; val_kl_reg_loss: 5011.3823; val_edge_recon_loss: 175537.6395; val_gene_expr_recon_loss: 64615.8767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245164.8986; val_optim_loss: 245164.8986
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9947; val_auprc_score: 0.9967; val_best_acc_score: 0.9766; val_best_f1_score: 0.9824; train_kl_reg_loss: 5027.9967; train_edge_recon_loss: 175944.5175; train_gene_expr_recon_loss: 64461.2412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245433.7554; train_optim_loss: 245433.7554; val_kl_reg_loss: 4992.5065; val_edge_recon_loss: 175652.8721; val_gene_expr_recon_loss: 64593.5361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245238.9144; val_optim_loss: 245238.9144
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9944; val_auprc_score: 0.9965; val_best_acc_score: 0.9757; val_best_f1_score: 0.9818; train_kl_reg_loss: 5025.5101; train_edge_recon_loss: 175561.3778; train_gene_expr_recon_loss: 64426.2360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245013.1243; train_optim_loss: 245013.1243; val_kl_reg_loss: 5002.9072; val_edge_recon_loss: 175382.6213; val_gene_expr_recon_loss: 64542.3111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244927.8397; val_optim_loss: 244927.8397
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9946; val_auprc_score: 0.9967; val_best_acc_score: 0.9766; val_best_f1_score: 0.9825; train_kl_reg_loss: 5033.5404; train_edge_recon_loss: 175693.5546; train_gene_expr_recon_loss: 64428.4467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245155.5414; train_optim_loss: 245155.5414; val_kl_reg_loss: 4963.9916; val_edge_recon_loss: 175317.7649; val_gene_expr_recon_loss: 64500.6231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244782.3793; val_optim_loss: 244782.3793
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9949; val_auprc_score: 0.9968; val_best_acc_score: 0.9773; val_best_f1_score: 0.9829; train_kl_reg_loss: 5032.3792; train_edge_recon_loss: 175716.1234; train_gene_expr_recon_loss: 64426.2671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245174.7696; train_optim_loss: 245174.7696; val_kl_reg_loss: 4988.0835; val_edge_recon_loss: 175071.0759; val_gene_expr_recon_loss: 64609.3719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244668.5312; val_optim_loss: 244668.5312
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9946; val_auprc_score: 0.9967; val_best_acc_score: 0.9764; val_best_f1_score: 0.9823; train_kl_reg_loss: 3935.9931; train_edge_recon_loss: 175516.6964; train_gene_expr_recon_loss: 64388.2589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243840.9487; train_optim_loss: 243840.9487; val_kl_reg_loss: 3530.9193; val_edge_recon_loss: 175342.1633; val_gene_expr_recon_loss: 64607.3872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243480.4700; val_optim_loss: 243480.4700
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9944; val_auprc_score: 0.9964; val_best_acc_score: 0.9754; val_best_f1_score: 0.9815; train_kl_reg_loss: 3641.7111; train_edge_recon_loss: 175537.0031; train_gene_expr_recon_loss: 64385.9326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243564.6469; train_optim_loss: 243564.6469; val_kl_reg_loss: 3535.6530; val_edge_recon_loss: 176386.7956; val_gene_expr_recon_loss: 64529.5567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244452.0050; val_optim_loss: 244452.0050
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9946; val_auprc_score: 0.9966; val_best_acc_score: 0.9767; val_best_f1_score: 0.9825; train_kl_reg_loss: 3563.3764; train_edge_recon_loss: 175497.7453; train_gene_expr_recon_loss: 64369.4963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243430.6181; train_optim_loss: 243430.6181; val_kl_reg_loss: 3497.3876; val_edge_recon_loss: 175794.7162; val_gene_expr_recon_loss: 64591.9926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243884.0965; val_optim_loss: 243884.0965
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9942; val_auprc_score: 0.9964; val_best_acc_score: 0.9756; val_best_f1_score: 0.9817; train_kl_reg_loss: 3528.1753; train_edge_recon_loss: 175241.7594; train_gene_expr_recon_loss: 64365.6969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243135.6315; train_optim_loss: 243135.6315; val_kl_reg_loss: 3492.9104; val_edge_recon_loss: 175359.0262; val_gene_expr_recon_loss: 64461.6727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243313.6097; val_optim_loss: 243313.6097
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9945; val_auprc_score: 0.9965; val_best_acc_score: 0.9771; val_best_f1_score: 0.9828; train_kl_reg_loss: 3499.5481; train_edge_recon_loss: 175198.1859; train_gene_expr_recon_loss: 64375.5771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243073.3113; train_optim_loss: 243073.3113; val_kl_reg_loss: 3478.7311; val_edge_recon_loss: 175407.7260; val_gene_expr_recon_loss: 64519.8303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243406.2868; val_optim_loss: 243406.2868
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9943; val_auprc_score: 0.9964; val_best_acc_score: 0.9763; val_best_f1_score: 0.9823; train_kl_reg_loss: 3485.1976; train_edge_recon_loss: 175157.3638; train_gene_expr_recon_loss: 64343.2627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242985.8239; train_optim_loss: 242985.8239; val_kl_reg_loss: 3409.9623; val_edge_recon_loss: 175374.8454; val_gene_expr_recon_loss: 64559.6009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243344.4090; val_optim_loss: 243344.4090
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9945; val_auprc_score: 0.9965; val_best_acc_score: 0.9767; val_best_f1_score: 0.9825; train_kl_reg_loss: 3465.5362; train_edge_recon_loss: 175167.0583; train_gene_expr_recon_loss: 64359.5260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242992.1204; train_optim_loss: 242992.1204; val_kl_reg_loss: 3411.1157; val_edge_recon_loss: 176170.9832; val_gene_expr_recon_loss: 64533.7503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244115.8488; val_optim_loss: 244115.8488

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9945; val_auprc_score: 0.9966; val_best_acc_score: 0.9773; val_best_f1_score: 0.9830; train_kl_reg_loss: 3443.3228; train_edge_recon_loss: 175224.7534; train_gene_expr_recon_loss: 64097.9450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242766.0214; train_optim_loss: 242766.0214; val_kl_reg_loss: 3397.2181; val_edge_recon_loss: 175232.2398; val_gene_expr_recon_loss: 64326.0297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242955.4871; val_optim_loss: 242955.4871
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9950; val_auprc_score: 0.9969; val_best_acc_score: 0.9777; val_best_f1_score: 0.9833; train_kl_reg_loss: 3438.4240; train_edge_recon_loss: 175006.0239; train_gene_expr_recon_loss: 64032.7404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242477.1882; train_optim_loss: 242477.1882; val_kl_reg_loss: 3398.2697; val_edge_recon_loss: 175300.4981; val_gene_expr_recon_loss: 64262.1748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242960.9423; val_optim_loss: 242960.9423
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9951; val_auprc_score: 0.9969; val_best_acc_score: 0.9780; val_best_f1_score: 0.9834; train_kl_reg_loss: 3435.2666; train_edge_recon_loss: 175057.2554; train_gene_expr_recon_loss: 64040.1552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242532.6771; train_optim_loss: 242532.6771; val_kl_reg_loss: 3398.9260; val_edge_recon_loss: 176131.6721; val_gene_expr_recon_loss: 64213.1782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243743.7771; val_optim_loss: 243743.7771
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9950; val_auprc_score: 0.9969; val_best_acc_score: 0.9777; val_best_f1_score: 0.9833; train_kl_reg_loss: 3433.9288; train_edge_recon_loss: 175113.3413; train_gene_expr_recon_loss: 64023.0398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242570.3101; train_optim_loss: 242570.3101; val_kl_reg_loss: 3396.6488; val_edge_recon_loss: 175731.9147; val_gene_expr_recon_loss: 64267.6858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243396.2492; val_optim_loss: 243396.2492

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9950; val_auprc_score: 0.9968; val_best_acc_score: 0.9782; val_best_f1_score: 0.9836; train_kl_reg_loss: 3431.2091; train_edge_recon_loss: 175129.8091; train_gene_expr_recon_loss: 63991.2268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242552.2449; train_optim_loss: 242552.2449; val_kl_reg_loss: 3399.5828; val_edge_recon_loss: 175489.1888; val_gene_expr_recon_loss: 64170.4323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243059.2041; val_optim_loss: 243059.2041
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9949; val_auprc_score: 0.9968; val_best_acc_score: 0.9777; val_best_f1_score: 0.9832; train_kl_reg_loss: 3432.6104; train_edge_recon_loss: 175002.4767; train_gene_expr_recon_loss: 63968.8567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242403.9436; train_optim_loss: 242403.9436; val_kl_reg_loss: 3398.8805; val_edge_recon_loss: 175562.0922; val_gene_expr_recon_loss: 64254.7839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243215.7578; val_optim_loss: 243215.7578
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9951; val_auprc_score: 0.9970; val_best_acc_score: 0.9780; val_best_f1_score: 0.9835; train_kl_reg_loss: 3431.5552; train_edge_recon_loss: 175008.4193; train_gene_expr_recon_loss: 63954.0193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242393.9939; train_optim_loss: 242393.9939; val_kl_reg_loss: 3401.0804; val_edge_recon_loss: 175232.0617; val_gene_expr_recon_loss: 64156.4118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242789.5538; val_optim_loss: 242789.5538
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9948; val_auprc_score: 0.9967; val_best_acc_score: 0.9780; val_best_f1_score: 0.9835; train_kl_reg_loss: 3428.9893; train_edge_recon_loss: 175087.4291; train_gene_expr_recon_loss: 63965.6841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242482.1024; train_optim_loss: 242482.1024; val_kl_reg_loss: 3394.5471; val_edge_recon_loss: 175420.5912; val_gene_expr_recon_loss: 64196.2397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243011.3785; val_optim_loss: 243011.3785
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9950; val_auprc_score: 0.9969; val_best_acc_score: 0.9783; val_best_f1_score: 0.9837; train_kl_reg_loss: 3427.7344; train_edge_recon_loss: 175079.6508; train_gene_expr_recon_loss: 63995.0021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242502.3873; train_optim_loss: 242502.3873; val_kl_reg_loss: 3398.9818; val_edge_recon_loss: 175479.4832; val_gene_expr_recon_loss: 64235.0844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243113.5491; val_optim_loss: 243113.5491
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9952; val_auprc_score: 0.9970; val_best_acc_score: 0.9779; val_best_f1_score: 0.9834; train_kl_reg_loss: 3427.7584; train_edge_recon_loss: 175005.2496; train_gene_expr_recon_loss: 63970.2923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242403.3005; train_optim_loss: 242403.3005; val_kl_reg_loss: 3398.3110; val_edge_recon_loss: 175698.7983; val_gene_expr_recon_loss: 64199.3529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243296.4619; val_optim_loss: 243296.4619

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9950; val_auprc_score: 0.9969; val_best_acc_score: 0.9779; val_best_f1_score: 0.9835; train_kl_reg_loss: 3428.7308; train_edge_recon_loss: 175004.9801; train_gene_expr_recon_loss: 63963.3775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242397.0887; train_optim_loss: 242397.0887; val_kl_reg_loss: 3397.1362; val_edge_recon_loss: 174920.2934; val_gene_expr_recon_loss: 64184.2415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242501.6708; val_optim_loss: 242501.6708
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9951; val_auprc_score: 0.9970; val_best_acc_score: 0.9782; val_best_f1_score: 0.9836; train_kl_reg_loss: 3428.2619; train_edge_recon_loss: 174897.8926; train_gene_expr_recon_loss: 63987.7555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242313.9100; train_optim_loss: 242313.9100; val_kl_reg_loss: 3397.6794; val_edge_recon_loss: 175292.9295; val_gene_expr_recon_loss: 64210.7922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242901.4007; val_optim_loss: 242901.4007
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9950; val_auprc_score: 0.9968; val_best_acc_score: 0.9781; val_best_f1_score: 0.9835; train_kl_reg_loss: 3427.5802; train_edge_recon_loss: 175058.8450; train_gene_expr_recon_loss: 63955.8639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242442.2890; train_optim_loss: 242442.2890; val_kl_reg_loss: 3396.6461; val_edge_recon_loss: 175632.6175; val_gene_expr_recon_loss: 64209.9628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243239.2259; val_optim_loss: 243239.2259
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9950; val_auprc_score: 0.9969; val_best_acc_score: 0.9781; val_best_f1_score: 0.9835; train_kl_reg_loss: 3428.7137; train_edge_recon_loss: 175027.1049; train_gene_expr_recon_loss: 63962.3901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242418.2086; train_optim_loss: 242418.2086; val_kl_reg_loss: 3398.1932; val_edge_recon_loss: 175551.0414; val_gene_expr_recon_loss: 64194.1424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243143.3759; val_optim_loss: 243143.3759

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9950; val_auprc_score: 0.9968; val_best_acc_score: 0.9782; val_best_f1_score: 0.9836; train_kl_reg_loss: 3428.8946; train_edge_recon_loss: 175014.2956; train_gene_expr_recon_loss: 63959.0205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242402.2107; train_optim_loss: 242402.2107; val_kl_reg_loss: 3397.6052; val_edge_recon_loss: 175155.9113; val_gene_expr_recon_loss: 64184.6260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242738.1426; val_optim_loss: 242738.1426
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9949; val_auprc_score: 0.9968; val_best_acc_score: 0.9781; val_best_f1_score: 0.9835; train_kl_reg_loss: 3428.4919; train_edge_recon_loss: 174968.0824; train_gene_expr_recon_loss: 63962.7089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242359.2833; train_optim_loss: 242359.2833; val_kl_reg_loss: 3398.1067; val_edge_recon_loss: 175581.1761; val_gene_expr_recon_loss: 64184.5741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243163.8573; val_optim_loss: 243163.8573
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9949; val_auprc_score: 0.9967; val_best_acc_score: 0.9777; val_best_f1_score: 0.9833; train_kl_reg_loss: 3428.4456; train_edge_recon_loss: 175098.2849; train_gene_expr_recon_loss: 63969.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242496.3906; train_optim_loss: 242496.3906; val_kl_reg_loss: 3397.8448; val_edge_recon_loss: 175392.0108; val_gene_expr_recon_loss: 64204.6700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242994.5261; val_optim_loss: 242994.5261

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 854 min 40 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9950
Val AUPRC score: 0.9967
Val best accuracy score: 0.9784
Val best F1 score: 0.9838
Val gene expr MSE score: 1.5275

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
