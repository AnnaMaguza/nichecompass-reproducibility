[True]
Run timestamp: 29072023_123550_107.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_107']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8743; val_auprc_score: 0.8911; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19331.6384; train_edge_recon_loss: 3512199.1111; train_gene_expr_recon_loss: 69737815.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 181713256.8889; train_global_loss: 254982600.8889; train_optim_loss: 254982600.8889; val_kl_reg_loss: 31099.9062; val_edge_recon_loss: 4065941.2500; val_gene_expr_recon_loss: 63952456.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 172160992.0000; val_global_loss: 240210496.0000; val_optim_loss: 240210496.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8806; val_auprc_score: 0.8989; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 45091.9748; train_edge_recon_loss: 3613662.9444; train_gene_expr_recon_loss: 64684079.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 171731646.2222; train_global_loss: 240074476.4444; train_optim_loss: 240074476.4444; val_kl_reg_loss: 34753.0547; val_edge_recon_loss: 4066116.2500; val_gene_expr_recon_loss: 61528024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 170149952.0000; val_global_loss: 235778848.0000; val_optim_loss: 235778848.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8710; val_auprc_score: 0.8867; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 62352.0707; train_edge_recon_loss: 3666031.5278; train_gene_expr_recon_loss: 60871261.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 169375964.4444; train_global_loss: 233975612.4444; train_optim_loss: 233975612.4444; val_kl_reg_loss: 83956.6094; val_edge_recon_loss: 4066131.7500; val_gene_expr_recon_loss: 59126472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 167749888.0000; val_global_loss: 231026448.0000; val_optim_loss: 231026448.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8623; val_auprc_score: 0.8776; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 110463.2405; train_edge_recon_loss: 3690219.7222; train_gene_expr_recon_loss: 58638021.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 166366824.8889; train_global_loss: 228805528.8889; train_optim_loss: 228805528.8889; val_kl_reg_loss: 149326.1719; val_edge_recon_loss: 4066138.5000; val_gene_expr_recon_loss: 56785304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 165824784.0000; val_global_loss: 226825552.0000; val_optim_loss: 226825552.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8682; val_auprc_score: 0.8843; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 142394.1259; train_edge_recon_loss: 3705740.5278; train_gene_expr_recon_loss: 55803712.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 165340750.2222; train_global_loss: 224992599.1111; train_optim_loss: 224992599.1111; val_kl_reg_loss: 158746.0469; val_edge_recon_loss: 4066112.2500; val_gene_expr_recon_loss: 54493024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 164200064.0000; val_global_loss: 222917952.0000; val_optim_loss: 222917952.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8694; val_auprc_score: 0.8798; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 173262.5347; train_edge_recon_loss: 3696064.4444; train_gene_expr_recon_loss: 54188353.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 164502090.6667; train_global_loss: 222559768.8889; train_optim_loss: 222559768.8889; val_kl_reg_loss: 176522.9219; val_edge_recon_loss: 4066074.2500; val_gene_expr_recon_loss: 52473756.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162669088.0000; val_global_loss: 219385440.0000; val_optim_loss: 219385440.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8618; val_auprc_score: 0.8688; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 192683.1024; train_edge_recon_loss: 3682818.4444; train_gene_expr_recon_loss: 51912104.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 162053685.3333; train_global_loss: 217841292.4444; train_optim_loss: 217841292.4444; val_kl_reg_loss: 188443.6562; val_edge_recon_loss: 4065991.2500; val_gene_expr_recon_loss: 50331980.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 161264928.0000; val_global_loss: 215851344.0000; val_optim_loss: 215851344.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8582; val_auprc_score: 0.8633; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 212286.8767; train_edge_recon_loss: 3678978.5000; train_gene_expr_recon_loss: 49350122.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160954538.6667; train_global_loss: 214195925.3333; train_optim_loss: 214195925.3333; val_kl_reg_loss: 170519.0000; val_edge_recon_loss: 4065879.0000; val_gene_expr_recon_loss: 48158696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 160145504.0000; val_global_loss: 212540608.0000; val_optim_loss: 212540608.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8601; val_auprc_score: 0.8643; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 201404.8559; train_edge_recon_loss: 3681700.8333; train_gene_expr_recon_loss: 47484720.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 159519619.5556; train_global_loss: 210887445.3333; train_optim_loss: 210887445.3333; val_kl_reg_loss: 205567.6719; val_edge_recon_loss: 4065762.2500; val_gene_expr_recon_loss: 46076656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158802688.0000; val_global_loss: 209150672.0000; val_optim_loss: 209150672.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8453; val_auprc_score: 0.8521; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 220641.1250; train_edge_recon_loss: 3645080.0556; train_gene_expr_recon_loss: 45287942.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157574497.7778; train_global_loss: 206728161.7778; train_optim_loss: 206728161.7778; val_kl_reg_loss: 187250.3438; val_edge_recon_loss: 4065692.2500; val_gene_expr_recon_loss: 44257056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 157326192.0000; val_global_loss: 205836192.0000; val_optim_loss: 205836192.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8350; val_auprc_score: 0.8411; val_best_acc_score: 0.5067; val_best_f1_score: 0.6697; train_kl_reg_loss: 221439.2205; train_edge_recon_loss: 3642453.7778; train_gene_expr_recon_loss: 43624838.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156870215.1111; train_global_loss: 204358947.5556; train_optim_loss: 204358947.5556; val_kl_reg_loss: 179462.9219; val_edge_recon_loss: 4065388.7500; val_gene_expr_recon_loss: 42771288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156467904.0000; val_global_loss: 203484048.0000; val_optim_loss: 203484048.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8208; val_auprc_score: 0.8275; val_best_acc_score: 0.5097; val_best_f1_score: 0.6709; train_kl_reg_loss: 222883.6215; train_edge_recon_loss: 3633081.0000; train_gene_expr_recon_loss: 42374206.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156906588.4444; train_global_loss: 203136757.3333; train_optim_loss: 203136757.3333; val_kl_reg_loss: 178006.0938; val_edge_recon_loss: 4065164.2500; val_gene_expr_recon_loss: 41675120.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155776448.0000; val_global_loss: 201694736.0000; val_optim_loss: 201694736.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8168; val_auprc_score: 0.8225; val_best_acc_score: 0.5206; val_best_f1_score: 0.6758; train_kl_reg_loss: 222285.5677; train_edge_recon_loss: 3631256.0833; train_gene_expr_recon_loss: 41288578.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155691813.3333; train_global_loss: 200833934.2222; train_optim_loss: 200833934.2222; val_kl_reg_loss: 160866.6562; val_edge_recon_loss: 4064642.5000; val_gene_expr_recon_loss: 40786148.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154903904.0000; val_global_loss: 199915552.0000; val_optim_loss: 199915552.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8095; val_auprc_score: 0.8155; val_best_acc_score: 0.5236; val_best_f1_score: 0.6770; train_kl_reg_loss: 219194.2535; train_edge_recon_loss: 3633759.6944; train_gene_expr_recon_loss: 40359720.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154627904.0000; train_global_loss: 198840576.0000; train_optim_loss: 198840576.0000; val_kl_reg_loss: 171615.1094; val_edge_recon_loss: 4064384.5000; val_gene_expr_recon_loss: 40118412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154533504.0000; val_global_loss: 198887920.0000; val_optim_loss: 198887920.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8047; val_auprc_score: 0.8073; val_best_acc_score: 0.5302; val_best_f1_score: 0.6799; train_kl_reg_loss: 220299.4149; train_edge_recon_loss: 3615484.1389; train_gene_expr_recon_loss: 40012874.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154823740.4444; train_global_loss: 198672398.2222; train_optim_loss: 198672398.2222; val_kl_reg_loss: 175915.5781; val_edge_recon_loss: 4063995.0000; val_gene_expr_recon_loss: 39571992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154031312.0000; val_global_loss: 197843216.0000; val_optim_loss: 197843216.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8045; val_auprc_score: 0.8104; val_best_acc_score: 0.5323; val_best_f1_score: 0.6807; train_kl_reg_loss: 213974.0903; train_edge_recon_loss: 3617805.5000; train_gene_expr_recon_loss: 39232433.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153480344.8889; train_global_loss: 196544560.0000; train_optim_loss: 196544560.0000; val_kl_reg_loss: 182272.5312; val_edge_recon_loss: 4063770.5000; val_gene_expr_recon_loss: 39159588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153341984.0000; val_global_loss: 196747616.0000; val_optim_loss: 196747616.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8107; val_auprc_score: 0.8132; val_best_acc_score: 0.5407; val_best_f1_score: 0.6844; train_kl_reg_loss: 215688.7587; train_edge_recon_loss: 3609828.2500; train_gene_expr_recon_loss: 39474401.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153817000.8889; train_global_loss: 197116919.1111; train_optim_loss: 197116919.1111; val_kl_reg_loss: 190447.5938; val_edge_recon_loss: 4063219.5000; val_gene_expr_recon_loss: 38883064.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153275840.0000; val_global_loss: 196412576.0000; val_optim_loss: 196412576.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8094; val_auprc_score: 0.8114; val_best_acc_score: 0.5445; val_best_f1_score: 0.6855; train_kl_reg_loss: 212581.0035; train_edge_recon_loss: 3607421.2222; train_gene_expr_recon_loss: 38986780.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153100755.5556; train_global_loss: 195907537.7778; train_optim_loss: 195907537.7778; val_kl_reg_loss: 175251.9375; val_edge_recon_loss: 4062911.0000; val_gene_expr_recon_loss: 38680356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152974288.0000; val_global_loss: 195892800.0000; val_optim_loss: 195892800.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8102; val_auprc_score: 0.8116; val_best_acc_score: 0.5608; val_best_f1_score: 0.6929; train_kl_reg_loss: 211347.8316; train_edge_recon_loss: 3603869.1111; train_gene_expr_recon_loss: 39135260.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154331253.3333; train_global_loss: 197281731.5556; train_optim_loss: 197281731.5556; val_kl_reg_loss: 162193.5938; val_edge_recon_loss: 4061971.5000; val_gene_expr_recon_loss: 38614976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152957376.0000; val_global_loss: 195796512.0000; val_optim_loss: 195796512.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8141; val_auprc_score: 0.8157; val_best_acc_score: 0.5618; val_best_f1_score: 0.6931; train_kl_reg_loss: 202763.0104; train_edge_recon_loss: 3609983.6667; train_gene_expr_recon_loss: 38585838.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152107598.2222; train_global_loss: 194506181.3333; train_optim_loss: 194506181.3333; val_kl_reg_loss: 166433.1719; val_edge_recon_loss: 4061679.5000; val_gene_expr_recon_loss: 38358420.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152564160.0000; val_global_loss: 195150688.0000; val_optim_loss: 195150688.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8227; val_auprc_score: 0.8207; val_best_acc_score: 0.5683; val_best_f1_score: 0.6955; train_kl_reg_loss: 210913.5451; train_edge_recon_loss: 3592658.1389; train_gene_expr_recon_loss: 38567875.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152778650.6667; train_global_loss: 195150101.3333; train_optim_loss: 195150101.3333; val_kl_reg_loss: 179323.1250; val_edge_recon_loss: 4060930.5000; val_gene_expr_recon_loss: 38317392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152515808.0000; val_global_loss: 195073456.0000; val_optim_loss: 195073456.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8300; val_auprc_score: 0.8310; val_best_acc_score: 0.5877; val_best_f1_score: 0.7041; train_kl_reg_loss: 201785.0017; train_edge_recon_loss: 3597783.6944; train_gene_expr_recon_loss: 38645572.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153018897.7778; train_global_loss: 195464039.1111; train_optim_loss: 195464039.1111; val_kl_reg_loss: 158073.8438; val_edge_recon_loss: 4059748.2500; val_gene_expr_recon_loss: 38305968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152469024.0000; val_global_loss: 194992816.0000; val_optim_loss: 194992816.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8253; val_auprc_score: 0.8221; val_best_acc_score: 0.5916; val_best_f1_score: 0.7055; train_kl_reg_loss: 198156.8993; train_edge_recon_loss: 3599958.5000; train_gene_expr_recon_loss: 38384241.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152216049.7778; train_global_loss: 194398408.8889; train_optim_loss: 194398408.8889; val_kl_reg_loss: 164503.1562; val_edge_recon_loss: 4059371.7500; val_gene_expr_recon_loss: 38130224.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152120528.0000; val_global_loss: 194474624.0000; val_optim_loss: 194474624.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8418; val_auprc_score: 0.8370; val_best_acc_score: 0.6091; val_best_f1_score: 0.7139; train_kl_reg_loss: 199881.8125; train_edge_recon_loss: 3590818.1667; train_gene_expr_recon_loss: 38285966.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153328432.0000; train_global_loss: 195405098.6667; train_optim_loss: 195405098.6667; val_kl_reg_loss: 163572.2812; val_edge_recon_loss: 4058332.7500; val_gene_expr_recon_loss: 38078908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152150752.0000; val_global_loss: 194451568.0000; val_optim_loss: 194451568.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8468; val_auprc_score: 0.8412; val_best_acc_score: 0.6241; val_best_f1_score: 0.7213; train_kl_reg_loss: 195246.4965; train_edge_recon_loss: 3590035.5556; train_gene_expr_recon_loss: 38322270.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152545544.8889; train_global_loss: 194653095.1111; train_optim_loss: 194653095.1111; val_kl_reg_loss: 161136.6250; val_edge_recon_loss: 4057165.7500; val_gene_expr_recon_loss: 38030564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151947552.0000; val_global_loss: 194196416.0000; val_optim_loss: 194196416.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8573; val_auprc_score: 0.8513; val_best_acc_score: 0.6106; val_best_f1_score: 0.7157; train_kl_reg_loss: 161361.6597; train_edge_recon_loss: 3892843.0278; train_gene_expr_recon_loss: 38926323.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153600874.6667; train_global_loss: 196581400.8889; train_optim_loss: 196581400.8889; val_kl_reg_loss: 80697.1562; val_edge_recon_loss: 4058203.0000; val_gene_expr_recon_loss: 38183948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152614512.0000; val_global_loss: 194937360.0000; val_optim_loss: 194937360.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8595; val_auprc_score: 0.8502; val_best_acc_score: 0.5100; val_best_f1_score: 0.6711; train_kl_reg_loss: 96167.4957; train_edge_recon_loss: 3914481.8333; train_gene_expr_recon_loss: 39106747.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153166458.6667; train_global_loss: 196283854.2222; train_optim_loss: 196283854.2222; val_kl_reg_loss: 65761.7578; val_edge_recon_loss: 4064476.2500; val_gene_expr_recon_loss: 38756728.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152796800.0000; val_global_loss: 195683776.0000; val_optim_loss: 195683776.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8286; val_auprc_score: 0.8187; val_best_acc_score: 0.5115; val_best_f1_score: 0.6717; train_kl_reg_loss: 84604.6337; train_edge_recon_loss: 3917920.3889; train_gene_expr_recon_loss: 39072174.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153352016.0000; train_global_loss: 196426714.6667; train_optim_loss: 196426714.6667; val_kl_reg_loss: 51245.6094; val_edge_recon_loss: 4064569.5000; val_gene_expr_recon_loss: 39085992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152970048.0000; val_global_loss: 196171856.0000; val_optim_loss: 196171856.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8376; val_auprc_score: 0.8306; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 61908.8806; train_edge_recon_loss: 3888160.7778; train_gene_expr_recon_loss: 39101395.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153059667.5556; train_global_loss: 196111134.2222; train_optim_loss: 196111134.2222; val_kl_reg_loss: 59515.9844; val_edge_recon_loss: 4065322.5000; val_gene_expr_recon_loss: 38365728.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152567984.0000; val_global_loss: 195058560.0000; val_optim_loss: 195058560.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8288; val_auprc_score: 0.8178; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 63101.2925; train_edge_recon_loss: 3889253.7222; train_gene_expr_recon_loss: 38809079.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153553674.6667; train_global_loss: 196315109.3333; train_optim_loss: 196315109.3333; val_kl_reg_loss: 57662.4883; val_edge_recon_loss: 4065284.5000; val_gene_expr_recon_loss: 38334944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152370080.0000; val_global_loss: 194827968.0000; val_optim_loss: 194827968.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8397; val_auprc_score: 0.8274; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 63097.9774; train_edge_recon_loss: 3871800.3333; train_gene_expr_recon_loss: 38419262.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152706021.3333; train_global_loss: 195060183.1111; train_optim_loss: 195060183.1111; val_kl_reg_loss: 61755.5391; val_edge_recon_loss: 4065203.7500; val_gene_expr_recon_loss: 38239772.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152262480.0000; val_global_loss: 194629216.0000; val_optim_loss: 194629216.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8378; val_auprc_score: 0.8286; val_best_acc_score: 0.5024; val_best_f1_score: 0.6677; train_kl_reg_loss: 70328.8819; train_edge_recon_loss: 3833283.2222; train_gene_expr_recon_loss: 38426112.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152280336.0000; train_global_loss: 194610058.6667; train_optim_loss: 194610058.6667; val_kl_reg_loss: 69758.8906; val_edge_recon_loss: 4065178.7500; val_gene_expr_recon_loss: 38207972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151960752.0000; val_global_loss: 194303664.0000; val_optim_loss: 194303664.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8374; val_auprc_score: 0.8285; val_best_acc_score: 0.5040; val_best_f1_score: 0.6685; train_kl_reg_loss: 77452.8212; train_edge_recon_loss: 3796413.9444; train_gene_expr_recon_loss: 38398633.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152667246.2222; train_global_loss: 194939747.5556; train_optim_loss: 194939747.5556; val_kl_reg_loss: 73874.3438; val_edge_recon_loss: 4065024.2500; val_gene_expr_recon_loss: 38197760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152368832.0000; val_global_loss: 194705488.0000; val_optim_loss: 194705488.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8477
val AUPRC score: 0.8405
val best accuracy score: 0.6093
val best F1 score: 0.7148
val target rna MSE score: 3.8356
val source rna MSE score: 3.2771
val target atac MSE score: 0.1188
val source atac MSE score: 0.0176
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
