[True]
Run timestamp: 26072023_031326_107.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_107']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8996; val_auprc_score: 0.9095; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13183.6142; train_edge_recon_loss: 3498960.9444; train_gene_expr_recon_loss: 31574830.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107433239.1111; train_global_loss: 142520213.3333; train_optim_loss: 142520213.3333; val_kl_reg_loss: 42238.7656; val_edge_recon_loss: 4065729.5000; val_gene_expr_recon_loss: 29444622.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 107058648.0000; val_global_loss: 140611232.0000; val_optim_loss: 140611232.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8949; val_auprc_score: 0.8982; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 56516.4397; train_edge_recon_loss: 3560325.2222; train_gene_expr_recon_loss: 29099116.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106256742.2222; train_global_loss: 138972700.4444; train_optim_loss: 138972700.4444; val_kl_reg_loss: 79408.1250; val_edge_recon_loss: 4065860.2500; val_gene_expr_recon_loss: 26977996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104904840.0000; val_global_loss: 136028096.0000; val_optim_loss: 136028096.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8920; val_auprc_score: 0.8917; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 106355.4184; train_edge_recon_loss: 3639867.6389; train_gene_expr_recon_loss: 26281164.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 103182031.1111; train_global_loss: 133209419.5556; train_optim_loss: 133209419.5556; val_kl_reg_loss: 140483.4844; val_edge_recon_loss: 4065896.5000; val_gene_expr_recon_loss: 24775876.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102514640.0000; val_global_loss: 131496896.0000; val_optim_loss: 131496896.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8965; val_auprc_score: 0.8921; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 166279.1146; train_edge_recon_loss: 3681476.2222; train_gene_expr_recon_loss: 24482666.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101123379.5556; train_global_loss: 129453800.8889; train_optim_loss: 129453800.8889; val_kl_reg_loss: 152278.2500; val_edge_recon_loss: 4065903.5000; val_gene_expr_recon_loss: 23280786.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100918448.0000; val_global_loss: 128417416.0000; val_optim_loss: 128417416.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8964; val_auprc_score: 0.8874; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 194721.7413; train_edge_recon_loss: 3701256.3611; train_gene_expr_recon_loss: 23217978.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99521636.4444; train_global_loss: 126635592.0000; train_optim_loss: 126635592.0000; val_kl_reg_loss: 218696.4062; val_edge_recon_loss: 4065744.0000; val_gene_expr_recon_loss: 22352124.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99746856.0000; val_global_loss: 126383424.0000; val_optim_loss: 126383424.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8945; val_auprc_score: 0.8895; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 240577.2135; train_edge_recon_loss: 3690519.0833; train_gene_expr_recon_loss: 22360953.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98607672.0000; train_global_loss: 124899722.6667; train_optim_loss: 124899722.6667; val_kl_reg_loss: 202399.2812; val_edge_recon_loss: 4065513.5000; val_gene_expr_recon_loss: 21704976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98964584.0000; val_global_loss: 124937472.0000; val_optim_loss: 124937472.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8876; val_auprc_score: 0.8811; val_best_acc_score: 0.5030; val_best_f1_score: 0.6680; train_kl_reg_loss: 254781.4913; train_edge_recon_loss: 3687794.3333; train_gene_expr_recon_loss: 21880364.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98032111.1111; train_global_loss: 123855052.4444; train_optim_loss: 123855052.4444; val_kl_reg_loss: 208539.5781; val_edge_recon_loss: 4065169.5000; val_gene_expr_recon_loss: 21335430.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98603504.0000; val_global_loss: 124212640.0000; val_optim_loss: 124212640.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8770; val_auprc_score: 0.8720; val_best_acc_score: 0.5078; val_best_f1_score: 0.6701; train_kl_reg_loss: 259954.3958; train_edge_recon_loss: 3687508.5278; train_gene_expr_recon_loss: 21585753.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97881079.1111; train_global_loss: 123414296.0000; train_optim_loss: 123414296.0000; val_kl_reg_loss: 228345.9375; val_edge_recon_loss: 4064767.7500; val_gene_expr_recon_loss: 21089288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98315160.0000; val_global_loss: 123697560.0000; val_optim_loss: 123697560.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8852; val_auprc_score: 0.8794; val_best_acc_score: 0.5186; val_best_f1_score: 0.6750; train_kl_reg_loss: 275668.1146; train_edge_recon_loss: 3664268.5000; train_gene_expr_recon_loss: 21451787.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97897141.3333; train_global_loss: 123288864.8889; train_optim_loss: 123288864.8889; val_kl_reg_loss: 198757.4531; val_edge_recon_loss: 4063936.7500; val_gene_expr_recon_loss: 20953284.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97928832.0000; val_global_loss: 123144808.0000; val_optim_loss: 123144808.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8849; val_auprc_score: 0.8767; val_best_acc_score: 0.5376; val_best_f1_score: 0.6836; train_kl_reg_loss: 261222.3993; train_edge_recon_loss: 3681531.9722; train_gene_expr_recon_loss: 21371982.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98259825.7778; train_global_loss: 123574562.6667; train_optim_loss: 123574562.6667; val_kl_reg_loss: 216942.5312; val_edge_recon_loss: 4062999.7500; val_gene_expr_recon_loss: 20845810.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97937464.0000; val_global_loss: 123063216.0000; val_optim_loss: 123063216.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8917; val_auprc_score: 0.8854; val_best_acc_score: 0.5719; val_best_f1_score: 0.6997; train_kl_reg_loss: 270267.2014; train_edge_recon_loss: 3652782.0833; train_gene_expr_recon_loss: 21237295.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97573575.1111; train_global_loss: 122733920.0000; train_optim_loss: 122733920.0000; val_kl_reg_loss: 212817.7500; val_edge_recon_loss: 4061735.2500; val_gene_expr_recon_loss: 20787598.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97661192.0000; val_global_loss: 122723344.0000; val_optim_loss: 122723344.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8965; val_auprc_score: 0.8851; val_best_acc_score: 0.6071; val_best_f1_score: 0.7171; train_kl_reg_loss: 259597.6059; train_edge_recon_loss: 3653820.2222; train_gene_expr_recon_loss: 21265344.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97127245.3333; train_global_loss: 122306008.0000; train_optim_loss: 122306008.0000; val_kl_reg_loss: 228698.2188; val_edge_recon_loss: 4060168.7500; val_gene_expr_recon_loss: 20716860.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97560080.0000; val_global_loss: 122565808.0000; val_optim_loss: 122565808.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9016; val_auprc_score: 0.8926; val_best_acc_score: 0.6486; val_best_f1_score: 0.7385; train_kl_reg_loss: 257432.6736; train_edge_recon_loss: 3648915.8333; train_gene_expr_recon_loss: 21052056.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97026546.6667; train_global_loss: 121984950.2222; train_optim_loss: 121984950.2222; val_kl_reg_loss: 222089.7656; val_edge_recon_loss: 4058020.7500; val_gene_expr_recon_loss: 20692012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97579712.0000; val_global_loss: 122551832.0000; val_optim_loss: 122551832.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9023; val_auprc_score: 0.8915; val_best_acc_score: 0.6995; val_best_f1_score: 0.7662; train_kl_reg_loss: 259984.7118; train_edge_recon_loss: 3639116.6944; train_gene_expr_recon_loss: 20993686.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96981099.5556; train_global_loss: 121873887.1111; train_optim_loss: 121873887.1111; val_kl_reg_loss: 213803.1875; val_edge_recon_loss: 4054534.2500; val_gene_expr_recon_loss: 20644280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97355888.0000; val_global_loss: 122268504.0000; val_optim_loss: 122268504.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9001; val_auprc_score: 0.8860; val_best_acc_score: 0.7357; val_best_f1_score: 0.7862; train_kl_reg_loss: 252935.0382; train_edge_recon_loss: 3639738.5833; train_gene_expr_recon_loss: 20833154.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96652610.6667; train_global_loss: 121378436.4444; train_optim_loss: 121378436.4444; val_kl_reg_loss: 226722.4375; val_edge_recon_loss: 4050219.7500; val_gene_expr_recon_loss: 20587662.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97234264.0000; val_global_loss: 122098864.0000; val_optim_loss: 122098864.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8923; val_auprc_score: 0.8806; val_best_acc_score: 0.7714; val_best_f1_score: 0.8066; train_kl_reg_loss: 253551.4462; train_edge_recon_loss: 3627384.8889; train_gene_expr_recon_loss: 20738119.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96787057.7778; train_global_loss: 121406114.6667; train_optim_loss: 121406114.6667; val_kl_reg_loss: 205804.2812; val_edge_recon_loss: 4045085.2500; val_gene_expr_recon_loss: 20562530.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97147512.0000; val_global_loss: 121960928.0000; val_optim_loss: 121960928.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9041; val_auprc_score: 0.8902; val_best_acc_score: 0.8052; val_best_f1_score: 0.8257; train_kl_reg_loss: 245941.1215; train_edge_recon_loss: 3629677.9167; train_gene_expr_recon_loss: 20893181.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96636607.1111; train_global_loss: 121405408.0000; train_optim_loss: 121405408.0000; val_kl_reg_loss: 219056.9062; val_edge_recon_loss: 4035422.7500; val_gene_expr_recon_loss: 20544000.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97111888.0000; val_global_loss: 121910368.0000; val_optim_loss: 121910368.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9038; val_auprc_score: 0.8960; val_best_acc_score: 0.8215; val_best_f1_score: 0.8318; train_kl_reg_loss: 246221.4688; train_edge_recon_loss: 3618594.3611; train_gene_expr_recon_loss: 20795830.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96045813.3333; train_global_loss: 120706461.3333; train_optim_loss: 120706461.3333; val_kl_reg_loss: 193688.9375; val_edge_recon_loss: 4025718.5000; val_gene_expr_recon_loss: 20517858.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97051944.0000; val_global_loss: 121789208.0000; val_optim_loss: 121789208.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8944; val_auprc_score: 0.8798; val_best_acc_score: 0.8155; val_best_f1_score: 0.8200; train_kl_reg_loss: 237787.3681; train_edge_recon_loss: 3622659.5000; train_gene_expr_recon_loss: 20840390.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96505538.6667; train_global_loss: 121206375.1111; train_optim_loss: 121206375.1111; val_kl_reg_loss: 200861.3594; val_edge_recon_loss: 4013246.5000; val_gene_expr_recon_loss: 20455470.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96910952.0000; val_global_loss: 121580528.0000; val_optim_loss: 121580528.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8968; val_auprc_score: 0.8808; val_best_acc_score: 0.8110; val_best_f1_score: 0.8058; train_kl_reg_loss: 240451.4844; train_edge_recon_loss: 3604488.3889; train_gene_expr_recon_loss: 20854052.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96735399.1111; train_global_loss: 121434390.2222; train_optim_loss: 121434390.2222; val_kl_reg_loss: 181617.6875; val_edge_recon_loss: 3989121.5000; val_gene_expr_recon_loss: 20458740.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96944624.0000; val_global_loss: 121574104.0000; val_optim_loss: 121574104.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9015; val_auprc_score: 0.8859; val_best_acc_score: 0.8092; val_best_f1_score: 0.7979; train_kl_reg_loss: 226629.8090; train_edge_recon_loss: 3613081.6667; train_gene_expr_recon_loss: 20821071.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96897331.5556; train_global_loss: 121558113.7778; train_optim_loss: 121558113.7778; val_kl_reg_loss: 202844.2188; val_edge_recon_loss: 3967686.2500; val_gene_expr_recon_loss: 20415476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96673840.0000; val_global_loss: 121259848.0000; val_optim_loss: 121259848.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8991; val_auprc_score: 0.8851; val_best_acc_score: 0.7860; val_best_f1_score: 0.8177; train_kl_reg_loss: 236744.4531; train_edge_recon_loss: 3582856.7222; train_gene_expr_recon_loss: 20651279.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95580296.8889; train_global_loss: 120051177.7778; train_optim_loss: 120051177.7778; val_kl_reg_loss: 179667.9688; val_edge_recon_loss: 3935238.0000; val_gene_expr_recon_loss: 20388956.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96541952.0000; val_global_loss: 121045816.0000; val_optim_loss: 121045816.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8962; val_auprc_score: 0.8796; val_best_acc_score: 0.7968; val_best_f1_score: 0.8210; train_kl_reg_loss: 214648.7726; train_edge_recon_loss: 3587628.0278; train_gene_expr_recon_loss: 20607425.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96153099.5556; train_global_loss: 120562801.7778; train_optim_loss: 120562801.7778; val_kl_reg_loss: 176658.5000; val_edge_recon_loss: 3893775.0000; val_gene_expr_recon_loss: 20375438.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96648448.0000; val_global_loss: 121094320.0000; val_optim_loss: 121094320.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8931; val_auprc_score: 0.8785; val_best_acc_score: 0.7996; val_best_f1_score: 0.8189; train_kl_reg_loss: 215449.6736; train_edge_recon_loss: 3566259.1111; train_gene_expr_recon_loss: 20498520.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95606800.8889; train_global_loss: 119887029.3333; train_optim_loss: 119887029.3333; val_kl_reg_loss: 183372.2344; val_edge_recon_loss: 3842556.7500; val_gene_expr_recon_loss: 20350362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96438824.0000; val_global_loss: 120815120.0000; val_optim_loss: 120815120.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8993; val_auprc_score: 0.8831; val_best_acc_score: 0.8150; val_best_f1_score: 0.8253; train_kl_reg_loss: 210712.1302; train_edge_recon_loss: 3544031.9167; train_gene_expr_recon_loss: 20679278.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95893793.7778; train_global_loss: 120327816.0000; train_optim_loss: 120327816.0000; val_kl_reg_loss: 168610.7188; val_edge_recon_loss: 3780751.2500; val_gene_expr_recon_loss: 20361296.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96564080.0000; val_global_loss: 120874736.0000; val_optim_loss: 120874736.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9204; val_auprc_score: 0.9042; val_best_acc_score: 0.8390; val_best_f1_score: 0.8347; train_kl_reg_loss: 177940.8993; train_edge_recon_loss: 3844480.1111; train_gene_expr_recon_loss: 20954050.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95973347.5556; train_global_loss: 120949820.4444; train_optim_loss: 120949820.4444; val_kl_reg_loss: 107583.7812; val_edge_recon_loss: 3968129.2500; val_gene_expr_recon_loss: 20579898.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96920792.0000; val_global_loss: 121576400.0000; val_optim_loss: 121576400.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9092; val_auprc_score: 0.8903; val_best_acc_score: 0.8164; val_best_f1_score: 0.8367; train_kl_reg_loss: 112956.3524; train_edge_recon_loss: 3950772.3333; train_gene_expr_recon_loss: 21061240.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96530444.4444; train_global_loss: 121655412.4444; train_optim_loss: 121655412.4444; val_kl_reg_loss: 88910.7500; val_edge_recon_loss: 4031181.7500; val_gene_expr_recon_loss: 20592918.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96731456.0000; val_global_loss: 121444464.0000; val_optim_loss: 121444464.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9025; val_auprc_score: 0.8842; val_best_acc_score: 0.8094; val_best_f1_score: 0.8314; train_kl_reg_loss: 88887.8819; train_edge_recon_loss: 3967438.3333; train_gene_expr_recon_loss: 21130734.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97178884.4444; train_global_loss: 122365945.7778; train_optim_loss: 122365945.7778; val_kl_reg_loss: 84306.7422; val_edge_recon_loss: 4035093.5000; val_gene_expr_recon_loss: 20595712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96666616.0000; val_global_loss: 121381728.0000; val_optim_loss: 121381728.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9059; val_auprc_score: 0.8874; val_best_acc_score: 0.8139; val_best_f1_score: 0.8345; train_kl_reg_loss: 88415.0443; train_edge_recon_loss: 3938911.8056; train_gene_expr_recon_loss: 21161520.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96673169.7778; train_global_loss: 121862016.0000; train_optim_loss: 121862016.0000; val_kl_reg_loss: 73815.0156; val_edge_recon_loss: 4035389.2500; val_gene_expr_recon_loss: 20622248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96884992.0000; val_global_loss: 121616448.0000; val_optim_loss: 121616448.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9054; val_auprc_score: 0.8876; val_best_acc_score: 0.8116; val_best_f1_score: 0.8327; train_kl_reg_loss: 84346.2891; train_edge_recon_loss: 3970360.3889; train_gene_expr_recon_loss: 20877781.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96264416.0000; train_global_loss: 121196904.8889; train_optim_loss: 121196904.8889; val_kl_reg_loss: 79280.1406; val_edge_recon_loss: 4034426.0000; val_gene_expr_recon_loss: 20576530.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96725440.0000; val_global_loss: 121415680.0000; val_optim_loss: 121415680.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9080; val_auprc_score: 0.8887; val_best_acc_score: 0.8222; val_best_f1_score: 0.8412; train_kl_reg_loss: 91567.0460; train_edge_recon_loss: 3948218.5556; train_gene_expr_recon_loss: 20846678.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95926170.6667; train_global_loss: 120812634.6667; train_optim_loss: 120812634.6667; val_kl_reg_loss: 84556.5781; val_edge_recon_loss: 4034419.2500; val_gene_expr_recon_loss: 20552996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96694296.0000; val_global_loss: 121366272.0000; val_optim_loss: 121366272.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9098; val_auprc_score: 0.8932; val_best_acc_score: 0.8224; val_best_f1_score: 0.8405; train_kl_reg_loss: 96322.7743; train_edge_recon_loss: 3932886.8056; train_gene_expr_recon_loss: 20933153.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96058863.1111; train_global_loss: 121021227.5556; train_optim_loss: 121021227.5556; val_kl_reg_loss: 87973.8906; val_edge_recon_loss: 4033612.2500; val_gene_expr_recon_loss: 20542334.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96625416.0000; val_global_loss: 121289336.0000; val_optim_loss: 121289336.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 47 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9142
Val AUPRC score: 0.8979
Val best accuracy score: 0.8310
Val best F1 score: 0.8277
Val gene expr MSE score: 0.3859
Val chrom access MSE score: 0.0864
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
