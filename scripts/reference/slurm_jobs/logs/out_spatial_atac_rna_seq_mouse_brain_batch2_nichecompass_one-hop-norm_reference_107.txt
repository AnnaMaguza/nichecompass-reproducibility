[True]
Run timestamp: 07082023_204710_107.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_107']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9052; val_auprc_score: 0.9143; val_best_acc_score: 0.5213; val_best_f1_score: 0.6760; train_kl_reg_loss: 12585.6349; train_edge_recon_loss: 348417.3264; train_gene_expr_recon_loss: 1208653.0278; train_masked_gp_l1_reg_loss: 15768.8788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119489.9861; train_chrom_access_recon_loss: 703631.0486; train_global_loss: 2408545.9028; train_optim_loss: 2408545.9028; val_kl_reg_loss: 2675.8516; val_edge_recon_loss: 406387.3438; val_gene_expr_recon_loss: 1078024.2500; val_masked_gp_l1_reg_loss: 10573.2559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117174.4375; val_chrom_access_recon_loss: 495765.4375; val_global_loss: 2110600.7500; val_optim_loss: 2110600.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9024; val_auprc_score: 0.9137; val_best_acc_score: 0.5043; val_best_f1_score: 0.6685; train_kl_reg_loss: 4853.5137; train_edge_recon_loss: 350554.7014; train_gene_expr_recon_loss: 1002994.7778; train_masked_gp_l1_reg_loss: 8714.7119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115646.7578; train_chrom_access_recon_loss: 492188.4271; train_global_loss: 1974952.8611; train_optim_loss: 1974952.8611; val_kl_reg_loss: 9523.5859; val_edge_recon_loss: 406537.8125; val_gene_expr_recon_loss: 914492.4375; val_masked_gp_l1_reg_loss: 7590.7861; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113697.9688; val_chrom_access_recon_loss: 484344.9688; val_global_loss: 1936187.6250; val_optim_loss: 1936187.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8910; val_auprc_score: 0.9008; val_best_acc_score: 0.5075; val_best_f1_score: 0.6700; train_kl_reg_loss: 12440.8360; train_edge_recon_loss: 355875.0208; train_gene_expr_recon_loss: 875856.9722; train_masked_gp_l1_reg_loss: 7997.7741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112085.9826; train_chrom_access_recon_loss: 489414.6736; train_global_loss: 1853671.2639; train_optim_loss: 1853671.2639; val_kl_reg_loss: 11487.5391; val_edge_recon_loss: 406536.5625; val_gene_expr_recon_loss: 835910.5000; val_masked_gp_l1_reg_loss: 8325.2354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110028.5078; val_chrom_access_recon_loss: 465766.5938; val_global_loss: 1838055.0000; val_optim_loss: 1838055.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8767; val_auprc_score: 0.8927; val_best_acc_score: 0.5136; val_best_f1_score: 0.6726; train_kl_reg_loss: 14349.3227; train_edge_recon_loss: 356199.3264; train_gene_expr_recon_loss: 810510.0625; train_masked_gp_l1_reg_loss: 8339.2933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108304.0122; train_chrom_access_recon_loss: 467328.5382; train_global_loss: 1765030.5278; train_optim_loss: 1765030.5278; val_kl_reg_loss: 16265.8828; val_edge_recon_loss: 406515.3750; val_gene_expr_recon_loss: 775870.1250; val_masked_gp_l1_reg_loss: 8435.2002; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106071.0000; val_chrom_access_recon_loss: 452260.7500; val_global_loss: 1765418.3750; val_optim_loss: 1765418.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8663; val_auprc_score: 0.8765; val_best_acc_score: 0.5229; val_best_f1_score: 0.6763; train_kl_reg_loss: 17685.6402; train_edge_recon_loss: 358156.8785; train_gene_expr_recon_loss: 759453.9792; train_masked_gp_l1_reg_loss: 8502.5997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104135.6363; train_chrom_access_recon_loss: 454738.3125; train_global_loss: 1702673.0000; train_optim_loss: 1702673.0000; val_kl_reg_loss: 18211.0430; val_edge_recon_loss: 406391.5312; val_gene_expr_recon_loss: 741463.1875; val_masked_gp_l1_reg_loss: 8545.3105; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101634.7500; val_chrom_access_recon_loss: 445453.5000; val_global_loss: 1721699.2500; val_optim_loss: 1721699.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8711; val_auprc_score: 0.8751; val_best_acc_score: 0.5307; val_best_f1_score: 0.6776; train_kl_reg_loss: 18545.5475; train_edge_recon_loss: 358047.2743; train_gene_expr_recon_loss: 731639.3681; train_masked_gp_l1_reg_loss: 8577.8801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99534.1832; train_chrom_access_recon_loss: 450631.8299; train_global_loss: 1666976.0972; train_optim_loss: 1666976.0972; val_kl_reg_loss: 19057.0312; val_edge_recon_loss: 406119.5938; val_gene_expr_recon_loss: 719811.0625; val_masked_gp_l1_reg_loss: 8596.8496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96858.0312; val_chrom_access_recon_loss: 441864.7500; val_global_loss: 1692307.3750; val_optim_loss: 1692307.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8657; val_auprc_score: 0.8661; val_best_acc_score: 0.6048; val_best_f1_score: 0.7104; train_kl_reg_loss: 18771.5723; train_edge_recon_loss: 357905.3889; train_gene_expr_recon_loss: 714526.6250; train_masked_gp_l1_reg_loss: 8618.0329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94654.3021; train_chrom_access_recon_loss: 449282.0764; train_global_loss: 1643757.9861; train_optim_loss: 1643757.9861; val_kl_reg_loss: 17404.4414; val_edge_recon_loss: 405340.9062; val_gene_expr_recon_loss: 705117.0625; val_masked_gp_l1_reg_loss: 8625.2334; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91879.4141; val_chrom_access_recon_loss: 439356.9688; val_global_loss: 1667724.0000; val_optim_loss: 1667724.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8514; val_auprc_score: 0.8521; val_best_acc_score: 0.6757; val_best_f1_score: 0.7423; train_kl_reg_loss: 19041.2305; train_edge_recon_loss: 357550.2986; train_gene_expr_recon_loss: 697780.1389; train_masked_gp_l1_reg_loss: 8638.4180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89653.3368; train_chrom_access_recon_loss: 444101.9931; train_global_loss: 1616765.3889; train_optim_loss: 1616765.3889; val_kl_reg_loss: 18862.4922; val_edge_recon_loss: 404169.1250; val_gene_expr_recon_loss: 693140.2500; val_masked_gp_l1_reg_loss: 8633.9902; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86874.9141; val_chrom_access_recon_loss: 437570.0312; val_global_loss: 1649250.7500; val_optim_loss: 1649250.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8424; val_auprc_score: 0.8421; val_best_acc_score: 0.7458; val_best_f1_score: 0.7698; train_kl_reg_loss: 19309.0710; train_edge_recon_loss: 356816.3264; train_gene_expr_recon_loss: 686735.8403; train_masked_gp_l1_reg_loss: 8639.3415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84678.6771; train_chrom_access_recon_loss: 441028.4757; train_global_loss: 1597207.7222; train_optim_loss: 1597207.7222; val_kl_reg_loss: 18522.2773; val_edge_recon_loss: 401420.1562; val_gene_expr_recon_loss: 685259.6250; val_masked_gp_l1_reg_loss: 8645.8701; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81949.0625; val_chrom_access_recon_loss: 436062.0000; val_global_loss: 1631859.0000; val_optim_loss: 1631859.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8494; val_auprc_score: 0.8439; val_best_acc_score: 0.7650; val_best_f1_score: 0.7508; train_kl_reg_loss: 19225.1758; train_edge_recon_loss: 356053.9861; train_gene_expr_recon_loss: 681259.0972; train_masked_gp_l1_reg_loss: 8660.5973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79807.2448; train_chrom_access_recon_loss: 441569.0799; train_global_loss: 1586575.1806; train_optim_loss: 1586575.1806; val_kl_reg_loss: 17210.1426; val_edge_recon_loss: 396567.9375; val_gene_expr_recon_loss: 681078.0000; val_masked_gp_l1_reg_loss: 8671.1338; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77153.8672; val_chrom_access_recon_loss: 434778.9688; val_global_loss: 1615460.1250; val_optim_loss: 1615460.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8507; val_auprc_score: 0.8451; val_best_acc_score: 0.7404; val_best_f1_score: 0.7722; train_kl_reg_loss: 18856.8472; train_edge_recon_loss: 354344.6632; train_gene_expr_recon_loss: 682864.6736; train_masked_gp_l1_reg_loss: 8688.9355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75084.6632; train_chrom_access_recon_loss: 440444.3368; train_global_loss: 1580284.1250; train_optim_loss: 1580284.1250; val_kl_reg_loss: 18944.5312; val_edge_recon_loss: 391705.7188; val_gene_expr_recon_loss: 675520.3750; val_masked_gp_l1_reg_loss: 8707.2725; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72530.1641; val_chrom_access_recon_loss: 434091.5938; val_global_loss: 1601499.6250; val_optim_loss: 1601499.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8630; val_auprc_score: 0.8604; val_best_acc_score: 0.7746; val_best_f1_score: 0.7854; train_kl_reg_loss: 18843.7682; train_edge_recon_loss: 352206.1562; train_gene_expr_recon_loss: 672429.2083; train_masked_gp_l1_reg_loss: 8736.5864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70549.4861; train_chrom_access_recon_loss: 439113.7569; train_global_loss: 1561878.9167; train_optim_loss: 1561878.9167; val_kl_reg_loss: 17755.4219; val_edge_recon_loss: 383038.9375; val_gene_expr_recon_loss: 672966.8750; val_masked_gp_l1_reg_loss: 8756.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68107.8984; val_chrom_access_recon_loss: 433108.6562; val_global_loss: 1583734.6250; val_optim_loss: 1583734.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8693; val_auprc_score: 0.8671; val_best_acc_score: 0.7824; val_best_f1_score: 0.7941; train_kl_reg_loss: 18309.7550; train_edge_recon_loss: 348846.8472; train_gene_expr_recon_loss: 674924.4375; train_masked_gp_l1_reg_loss: 8785.7217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66220.3993; train_chrom_access_recon_loss: 439475.5694; train_global_loss: 1556562.7083; train_optim_loss: 1556562.7083; val_kl_reg_loss: 16911.9766; val_edge_recon_loss: 371675.7812; val_gene_expr_recon_loss: 672084.5000; val_masked_gp_l1_reg_loss: 8817.6201; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63896.9766; val_chrom_access_recon_loss: 432479.7500; val_global_loss: 1565866.6250; val_optim_loss: 1565866.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8829; val_auprc_score: 0.8807; val_best_acc_score: 0.8026; val_best_f1_score: 0.8060; train_kl_reg_loss: 18181.5990; train_edge_recon_loss: 343690.5278; train_gene_expr_recon_loss: 672272.5764; train_masked_gp_l1_reg_loss: 8856.2051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62118.0838; train_chrom_access_recon_loss: 439013.9965; train_global_loss: 1544133.0139; train_optim_loss: 1544133.0139; val_kl_reg_loss: 17505.9961; val_edge_recon_loss: 357559.2500; val_gene_expr_recon_loss: 669142.6250; val_masked_gp_l1_reg_loss: 8899.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59933.1055; val_chrom_access_recon_loss: 431857.9062; val_global_loss: 1544898.3750; val_optim_loss: 1544898.3750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8951; val_auprc_score: 0.8898; val_best_acc_score: 0.8176; val_best_f1_score: 0.8214; train_kl_reg_loss: 18378.3789; train_edge_recon_loss: 336156.4583; train_gene_expr_recon_loss: 668605.5278; train_masked_gp_l1_reg_loss: 8944.4393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58267.3203; train_chrom_access_recon_loss: 437643.6354; train_global_loss: 1527995.7639; train_optim_loss: 1527995.7639; val_kl_reg_loss: 18148.3438; val_edge_recon_loss: 338374.3438; val_gene_expr_recon_loss: 670387.8750; val_masked_gp_l1_reg_loss: 9001.8018; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56227.2578; val_chrom_access_recon_loss: 431362.7500; val_global_loss: 1523502.3750; val_optim_loss: 1523502.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9096; val_auprc_score: 0.9035; val_best_acc_score: 0.8320; val_best_f1_score: 0.8403; train_kl_reg_loss: 20269.9874; train_edge_recon_loss: 323068.9444; train_gene_expr_recon_loss: 669782.9375; train_masked_gp_l1_reg_loss: 9054.3587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54681.4449; train_chrom_access_recon_loss: 436584.7326; train_global_loss: 1513442.4306; train_optim_loss: 1513442.4306; val_kl_reg_loss: 21511.8867; val_edge_recon_loss: 319182.9688; val_gene_expr_recon_loss: 669791.0000; val_masked_gp_l1_reg_loss: 9119.9912; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52791.9688; val_chrom_access_recon_loss: 430925.9688; val_global_loss: 1503323.8750; val_optim_loss: 1503323.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9234; val_auprc_score: 0.9114; val_best_acc_score: 0.8523; val_best_f1_score: 0.8583; train_kl_reg_loss: 25120.1165; train_edge_recon_loss: 310054.8681; train_gene_expr_recon_loss: 670133.6597; train_masked_gp_l1_reg_loss: 9174.2997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51363.3550; train_chrom_access_recon_loss: 437680.2882; train_global_loss: 1503526.5556; train_optim_loss: 1503526.5556; val_kl_reg_loss: 26931.1836; val_edge_recon_loss: 304246.2500; val_gene_expr_recon_loss: 669053.1250; val_masked_gp_l1_reg_loss: 9229.8994; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49616.9844; val_chrom_access_recon_loss: 430251.9375; val_global_loss: 1489329.2500; val_optim_loss: 1489329.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9275; val_auprc_score: 0.9121; val_best_acc_score: 0.8622; val_best_f1_score: 0.8690; train_kl_reg_loss: 28697.1968; train_edge_recon_loss: 301829.3194; train_gene_expr_recon_loss: 666806.1250; train_masked_gp_l1_reg_loss: 9277.7616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48300.9158; train_chrom_access_recon_loss: 434182.4410; train_global_loss: 1489093.7500; train_optim_loss: 1489093.7500; val_kl_reg_loss: 27848.0625; val_edge_recon_loss: 299742.3750; val_gene_expr_recon_loss: 666277.4375; val_masked_gp_l1_reg_loss: 9329.1650; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46689.2812; val_chrom_access_recon_loss: 429312.2500; val_global_loss: 1479198.6250; val_optim_loss: 1479198.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9341; val_auprc_score: 0.9195; val_best_acc_score: 0.8673; val_best_f1_score: 0.8717; train_kl_reg_loss: 27956.2954; train_edge_recon_loss: 300090.0660; train_gene_expr_recon_loss: 664737.1667; train_masked_gp_l1_reg_loss: 9368.4824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45472.7174; train_chrom_access_recon_loss: 435463.1076; train_global_loss: 1483087.8333; train_optim_loss: 1483087.8333; val_kl_reg_loss: 26098.5527; val_edge_recon_loss: 298722.7812; val_gene_expr_recon_loss: 664709.3750; val_masked_gp_l1_reg_loss: 9409.5801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43983.6406; val_chrom_access_recon_loss: 428681.1875; val_global_loss: 1471605.1250; val_optim_loss: 1471605.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9295; val_auprc_score: 0.9123; val_best_acc_score: 0.8612; val_best_f1_score: 0.8690; train_kl_reg_loss: 26584.5827; train_edge_recon_loss: 298719.0590; train_gene_expr_recon_loss: 662399.9653; train_masked_gp_l1_reg_loss: 9441.9134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42861.0760; train_chrom_access_recon_loss: 434058.1458; train_global_loss: 1474064.7222; train_optim_loss: 1474064.7222; val_kl_reg_loss: 25864.8633; val_edge_recon_loss: 299241.6875; val_gene_expr_recon_loss: 662780.2500; val_masked_gp_l1_reg_loss: 9469.5645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41486.4922; val_chrom_access_recon_loss: 427844.2812; val_global_loss: 1466687.1250; val_optim_loss: 1466687.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9367; val_auprc_score: 0.9248; val_best_acc_score: 0.8657; val_best_f1_score: 0.8725; train_kl_reg_loss: 26639.1176; train_edge_recon_loss: 297325.7917; train_gene_expr_recon_loss: 660925.8681; train_masked_gp_l1_reg_loss: 9496.8711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40452.7365; train_chrom_access_recon_loss: 431878.1701; train_global_loss: 1466718.5694; train_optim_loss: 1466718.5694; val_kl_reg_loss: 26239.1914; val_edge_recon_loss: 295850.4062; val_gene_expr_recon_loss: 660971.0625; val_masked_gp_l1_reg_loss: 9532.5986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39192.4688; val_chrom_access_recon_loss: 427179.1562; val_global_loss: 1458964.8750; val_optim_loss: 1458964.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9380; val_auprc_score: 0.9241; val_best_acc_score: 0.8715; val_best_f1_score: 0.8764; train_kl_reg_loss: 26452.8956; train_edge_recon_loss: 296299.7708; train_gene_expr_recon_loss: 661085.9306; train_masked_gp_l1_reg_loss: 9557.4204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38248.7405; train_chrom_access_recon_loss: 432976.0382; train_global_loss: 1464620.8056; train_optim_loss: 1464620.8056; val_kl_reg_loss: 25733.7656; val_edge_recon_loss: 294413.3438; val_gene_expr_recon_loss: 659467.0000; val_masked_gp_l1_reg_loss: 9585.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37087.2617; val_chrom_access_recon_loss: 426565.6875; val_global_loss: 1452852.7500; val_optim_loss: 1452852.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9409; val_auprc_score: 0.9256; val_best_acc_score: 0.8748; val_best_f1_score: 0.8797; train_kl_reg_loss: 26256.1313; train_edge_recon_loss: 295301.8542; train_gene_expr_recon_loss: 657026.6181; train_masked_gp_l1_reg_loss: 9606.3333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36210.5786; train_chrom_access_recon_loss: 431917.1840; train_global_loss: 1456318.6806; train_optim_loss: 1456318.6806; val_kl_reg_loss: 25809.2754; val_edge_recon_loss: 294747.8750; val_gene_expr_recon_loss: 658490.4375; val_masked_gp_l1_reg_loss: 9635.3545; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35133.8867; val_chrom_access_recon_loss: 425953.8438; val_global_loss: 1449770.7500; val_optim_loss: 1449770.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9378; val_auprc_score: 0.9179; val_best_acc_score: 0.8735; val_best_f1_score: 0.8802; train_kl_reg_loss: 26302.8351; train_edge_recon_loss: 293993.0417; train_gene_expr_recon_loss: 659565.6597; train_masked_gp_l1_reg_loss: 9657.5196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34326.6775; train_chrom_access_recon_loss: 432409.3924; train_global_loss: 1456255.1389; train_optim_loss: 1456255.1389; val_kl_reg_loss: 25801.9258; val_edge_recon_loss: 294473.4375; val_gene_expr_recon_loss: 657189.0000; val_masked_gp_l1_reg_loss: 9688.2236; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33337.4648; val_chrom_access_recon_loss: 425426.5625; val_global_loss: 1445916.6250; val_optim_loss: 1445916.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9456; val_auprc_score: 0.9321; val_best_acc_score: 0.8802; val_best_f1_score: 0.8849; train_kl_reg_loss: 26378.9546; train_edge_recon_loss: 293045.9271; train_gene_expr_recon_loss: 655606.6250; train_masked_gp_l1_reg_loss: 9713.0171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32597.5588; train_chrom_access_recon_loss: 430248.7847; train_global_loss: 1447590.9028; train_optim_loss: 1447590.9028; val_kl_reg_loss: 25946.7168; val_edge_recon_loss: 294388.5938; val_gene_expr_recon_loss: 655358.2500; val_masked_gp_l1_reg_loss: 9740.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31689.1250; val_chrom_access_recon_loss: 424648.5938; val_global_loss: 1441771.8750; val_optim_loss: 1441771.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9438; val_auprc_score: 0.9267; val_best_acc_score: 0.8791; val_best_f1_score: 0.8841; train_kl_reg_loss: 24942.5816; train_edge_recon_loss: 304685.8125; train_gene_expr_recon_loss: 953993.5069; train_masked_gp_l1_reg_loss: 9862.6961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30858.0764; train_chrom_access_recon_loss: 454973.2326; train_global_loss: 1779315.8889; train_optim_loss: 1779315.8889; val_kl_reg_loss: 10804.7383; val_edge_recon_loss: 300461.3750; val_gene_expr_recon_loss: 945145.3750; val_masked_gp_l1_reg_loss: 10074.8926; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29741.9375; val_chrom_access_recon_loss: 449371.4375; val_global_loss: 1745599.7500; val_optim_loss: 1745599.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9451; val_auprc_score: 0.9260; val_best_acc_score: 0.8825; val_best_f1_score: 0.8864; train_kl_reg_loss: 24166.4286; train_edge_recon_loss: 296871.4375; train_gene_expr_recon_loss: 948950.4028; train_masked_gp_l1_reg_loss: 10304.1898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28817.3991; train_chrom_access_recon_loss: 457425.0035; train_global_loss: 1766534.8472; train_optim_loss: 1766534.8472; val_kl_reg_loss: 11378.1836; val_edge_recon_loss: 296924.4688; val_gene_expr_recon_loss: 938599.6250; val_masked_gp_l1_reg_loss: 10592.0723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27677.7441; val_chrom_access_recon_loss: 448638.9688; val_global_loss: 1733811.1250; val_optim_loss: 1733811.1250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9499; val_auprc_score: 0.9382; val_best_acc_score: 0.8874; val_best_f1_score: 0.8915; train_kl_reg_loss: 20637.1168; train_edge_recon_loss: 293817.5278; train_gene_expr_recon_loss: 933935.2778; train_masked_gp_l1_reg_loss: 10783.2572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26807.4946; train_chrom_access_recon_loss: 452571.9861; train_global_loss: 1738552.6667; train_optim_loss: 1738552.6667; val_kl_reg_loss: 12164.1543; val_edge_recon_loss: 292685.3438; val_gene_expr_recon_loss: 934871.8750; val_masked_gp_l1_reg_loss: 11004.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25750.0430; val_chrom_access_recon_loss: 448144.1250; val_global_loss: 1724620.2500; val_optim_loss: 1724620.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9479; val_auprc_score: 0.9330; val_best_acc_score: 0.8844; val_best_f1_score: 0.8888; train_kl_reg_loss: 19469.6215; train_edge_recon_loss: 290474.0208; train_gene_expr_recon_loss: 937562.7778; train_masked_gp_l1_reg_loss: 11148.6246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24956.5371; train_chrom_access_recon_loss: 455420.6250; train_global_loss: 1739032.2083; train_optim_loss: 1739032.2083; val_kl_reg_loss: 13431.3906; val_edge_recon_loss: 291257.7812; val_gene_expr_recon_loss: 930853.0000; val_masked_gp_l1_reg_loss: 11313.5557; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23995.1094; val_chrom_access_recon_loss: 447480.7188; val_global_loss: 1718331.6250; val_optim_loss: 1718331.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9457; val_auprc_score: 0.9275; val_best_acc_score: 0.8860; val_best_f1_score: 0.8899; train_kl_reg_loss: 19097.7031; train_edge_recon_loss: 288726.2465; train_gene_expr_recon_loss: 928706.8333; train_masked_gp_l1_reg_loss: 11245.1071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23877.5786; train_chrom_access_recon_loss: 452762.4583; train_global_loss: 1724415.9444; train_optim_loss: 1724415.9444; val_kl_reg_loss: 13689.9092; val_edge_recon_loss: 289240.2812; val_gene_expr_recon_loss: 930128.9375; val_masked_gp_l1_reg_loss: 11189.6201; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23736.7930; val_chrom_access_recon_loss: 447366.1562; val_global_loss: 1715351.6250; val_optim_loss: 1715351.6250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9468; val_auprc_score: 0.9307; val_best_acc_score: 0.8871; val_best_f1_score: 0.8912; train_kl_reg_loss: 18931.9293; train_edge_recon_loss: 289187.8646; train_gene_expr_recon_loss: 928394.3333; train_masked_gp_l1_reg_loss: 11183.0365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23641.4811; train_chrom_access_recon_loss: 453335.8403; train_global_loss: 1724674.4861; train_optim_loss: 1724674.4861; val_kl_reg_loss: 13646.6562; val_edge_recon_loss: 290691.5938; val_gene_expr_recon_loss: 930044.7500; val_masked_gp_l1_reg_loss: 11166.8838; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23521.3105; val_chrom_access_recon_loss: 447398.0000; val_global_loss: 1716469.1250; val_optim_loss: 1716469.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9475; val_auprc_score: 0.9310; val_best_acc_score: 0.8857; val_best_f1_score: 0.8899; train_kl_reg_loss: 18781.2993; train_edge_recon_loss: 288880.8333; train_gene_expr_recon_loss: 928851.7847; train_masked_gp_l1_reg_loss: 11161.4353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23431.9004; train_chrom_access_recon_loss: 453629.2743; train_global_loss: 1724736.5278; train_optim_loss: 1724736.5278; val_kl_reg_loss: 13715.2412; val_edge_recon_loss: 289140.1562; val_gene_expr_recon_loss: 929405.1250; val_masked_gp_l1_reg_loss: 11156.1572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23322.1777; val_chrom_access_recon_loss: 447219.3750; val_global_loss: 1713958.1250; val_optim_loss: 1713958.1250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9464; val_auprc_score: 0.9270; val_best_acc_score: 0.8848; val_best_f1_score: 0.8903; train_kl_reg_loss: 18701.8181; train_edge_recon_loss: 288291.3403; train_gene_expr_recon_loss: 928764.5139; train_masked_gp_l1_reg_loss: 11155.4176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23237.6530; train_chrom_access_recon_loss: 452955.3229; train_global_loss: 1723106.0694; train_optim_loss: 1723106.0694; val_kl_reg_loss: 13718.5186; val_edge_recon_loss: 289843.9375; val_gene_expr_recon_loss: 929228.5000; val_masked_gp_l1_reg_loss: 11155.7510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23135.6836; val_chrom_access_recon_loss: 447260.7500; val_global_loss: 1714343.1250; val_optim_loss: 1714343.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9458
val AUPRC score: 0.9299
val best accuracy score: 0.8844
val best F1 score: 0.8889
val target rna MSE score: 3.8251
val source rna MSE score: 3.2217
val target atac MSE score: 0.1320
val source atac MSE score: 0.0197
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
