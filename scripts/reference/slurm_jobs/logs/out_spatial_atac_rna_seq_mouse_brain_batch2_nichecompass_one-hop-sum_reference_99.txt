[True]
Run timestamp: 10082023_233156_99.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_99']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7389; val_auprc_score: 0.7643; val_best_acc_score: 0.5050; val_best_f1_score: 0.6679; train_kl_reg_loss: 82016.3539; train_edge_recon_loss: 3802615.0725; train_gene_expr_recon_loss: 46427949.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27755209.4351; train_global_loss: 78067789.8626; train_optim_loss: 78067789.8626; val_kl_reg_loss: 91699.3786; val_edge_recon_loss: 4064837.4000; val_gene_expr_recon_loss: 39651102.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25867427.4667; val_global_loss: 69675067.2000; val_optim_loss: 69675067.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7520; val_auprc_score: 0.7793; val_best_acc_score: 0.6179; val_best_f1_score: 0.7063; train_kl_reg_loss: 169607.4511; train_edge_recon_loss: 3667215.6660; train_gene_expr_recon_loss: 38179915.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25876130.9771; train_global_loss: 67892869.4962; train_optim_loss: 67892869.4962; val_kl_reg_loss: 235747.0896; val_edge_recon_loss: 4057776.4500; val_gene_expr_recon_loss: 37490468.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25360978.4000; val_global_loss: 67144970.1333; val_optim_loss: 67144970.1333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8450; val_auprc_score: 0.8487; val_best_acc_score: 0.7505; val_best_f1_score: 0.7326; train_kl_reg_loss: 187863.2752; train_edge_recon_loss: 3568718.1107; train_gene_expr_recon_loss: 37049645.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25590151.6489; train_global_loss: 66396378.2901; train_optim_loss: 66396378.2901; val_kl_reg_loss: 188362.1115; val_edge_recon_loss: 4020829.8000; val_gene_expr_recon_loss: 37089372.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25305796.5333; val_global_loss: 66604361.0667; val_optim_loss: 66604361.0667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8862; val_auprc_score: 0.8817; val_best_acc_score: 0.7990; val_best_f1_score: 0.8150; train_kl_reg_loss: 158917.3802; train_edge_recon_loss: 3519421.4466; train_gene_expr_recon_loss: 36616029.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25372749.8626; train_global_loss: 65667118.2901; train_optim_loss: 65667118.2901; val_kl_reg_loss: 133669.0125; val_edge_recon_loss: 3583486.1833; val_gene_expr_recon_loss: 36719749.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25127534.1333; val_global_loss: 65564438.6667; val_optim_loss: 65564438.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8764; val_auprc_score: 0.8710; val_best_acc_score: 0.7812; val_best_f1_score: 0.7972; train_kl_reg_loss: 161231.7428; train_edge_recon_loss: 3175601.8282; train_gene_expr_recon_loss: 36437066.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25321243.8779; train_global_loss: 65095144.4885; train_optim_loss: 65095144.4885; val_kl_reg_loss: 186978.6281; val_edge_recon_loss: 3081770.3000; val_gene_expr_recon_loss: 36427102.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24953401.3333; val_global_loss: 64649252.8000; val_optim_loss: 64649252.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8955; val_auprc_score: 0.8849; val_best_acc_score: 0.8099; val_best_f1_score: 0.8193; train_kl_reg_loss: 179717.2149; train_edge_recon_loss: 3040857.2271; train_gene_expr_recon_loss: 36108572.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25102885.7252; train_global_loss: 64432032.8244; train_optim_loss: 64432032.8244; val_kl_reg_loss: 174170.1146; val_edge_recon_loss: 3006786.9500; val_gene_expr_recon_loss: 36276473.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24924025.6000; val_global_loss: 64381455.2000; val_optim_loss: 64381455.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9094; val_auprc_score: 0.8974; val_best_acc_score: 0.8252; val_best_f1_score: 0.8357; train_kl_reg_loss: 173038.5116; train_edge_recon_loss: 2983999.7424; train_gene_expr_recon_loss: 35923388.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25022865.0687; train_global_loss: 64103291.7252; train_optim_loss: 64103291.7252; val_kl_reg_loss: 167978.6823; val_edge_recon_loss: 2957682.2000; val_gene_expr_recon_loss: 36235658.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24957792.4000; val_global_loss: 64319112.0000; val_optim_loss: 64319112.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9183; val_auprc_score: 0.9034; val_best_acc_score: 0.8425; val_best_f1_score: 0.8520; train_kl_reg_loss: 167430.7462; train_edge_recon_loss: 2933659.2767; train_gene_expr_recon_loss: 35706480.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24899383.0687; train_global_loss: 63706953.1603; train_optim_loss: 63706953.1603; val_kl_reg_loss: 162587.8615; val_edge_recon_loss: 2916583.3667; val_gene_expr_recon_loss: 36017538.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24728419.6000; val_global_loss: 63825129.8667; val_optim_loss: 63825129.8667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9302; val_auprc_score: 0.9200; val_best_acc_score: 0.8587; val_best_f1_score: 0.8643; train_kl_reg_loss: 163740.8078; train_edge_recon_loss: 2904409.3454; train_gene_expr_recon_loss: 35572382.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24837555.8321; train_global_loss: 63478088.5191; train_optim_loss: 63478088.5191; val_kl_reg_loss: 161662.6396; val_edge_recon_loss: 2907474.5167; val_gene_expr_recon_loss: 35543190.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24441854.4000; val_global_loss: 63054182.1333; val_optim_loss: 63054182.1333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9305; val_auprc_score: 0.9210; val_best_acc_score: 0.8620; val_best_f1_score: 0.8699; train_kl_reg_loss: 159844.7657; train_edge_recon_loss: 2879431.2786; train_gene_expr_recon_loss: 35398178.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24742999.4351; train_global_loss: 63180454.1679; train_optim_loss: 63180454.1679; val_kl_reg_loss: 160510.0156; val_edge_recon_loss: 2919455.6833; val_gene_expr_recon_loss: 35579665.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24581339.8667; val_global_loss: 63240971.7333; val_optim_loss: 63240971.7333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9440; val_auprc_score: 0.9354; val_best_acc_score: 0.8760; val_best_f1_score: 0.8807; train_kl_reg_loss: 154823.3916; train_edge_recon_loss: 2867487.7519; train_gene_expr_recon_loss: 35343396.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24726246.5649; train_global_loss: 63091953.9847; train_optim_loss: 63091953.9847; val_kl_reg_loss: 152490.4781; val_edge_recon_loss: 2853702.7167; val_gene_expr_recon_loss: 35557797.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24596429.0667; val_global_loss: 63160420.2667; val_optim_loss: 63160420.2667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9455; val_auprc_score: 0.9373; val_best_acc_score: 0.8779; val_best_f1_score: 0.8854; train_kl_reg_loss: 151166.5427; train_edge_recon_loss: 2851201.4924; train_gene_expr_recon_loss: 35202704.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24647906.4733; train_global_loss: 62852979.0229; train_optim_loss: 62852979.0229; val_kl_reg_loss: 149335.2406; val_edge_recon_loss: 2867277.5500; val_gene_expr_recon_loss: 35317206.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24401361.2000; val_global_loss: 62735180.8000; val_optim_loss: 62735180.8000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9477; val_auprc_score: 0.9391; val_best_acc_score: 0.8851; val_best_f1_score: 0.8905; train_kl_reg_loss: 146361.1752; train_edge_recon_loss: 2838179.4218; train_gene_expr_recon_loss: 35098140.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24578766.4275; train_global_loss: 62661447.7863; train_optim_loss: 62661447.7863; val_kl_reg_loss: 143948.4375; val_edge_recon_loss: 2819019.7833; val_gene_expr_recon_loss: 35436679.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24409205.6000; val_global_loss: 62808854.1333; val_optim_loss: 62808854.1333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9552; val_auprc_score: 0.9473; val_best_acc_score: 0.8950; val_best_f1_score: 0.8996; train_kl_reg_loss: 142620.3040; train_edge_recon_loss: 2811575.2615; train_gene_expr_recon_loss: 34974700.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24515171.1145; train_global_loss: 62444067.3893; train_optim_loss: 62444067.3893; val_kl_reg_loss: 141520.5646; val_edge_recon_loss: 2817143.6000; val_gene_expr_recon_loss: 35159525.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24381940.0000; val_global_loss: 62500129.3333; val_optim_loss: 62500129.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9544; val_auprc_score: 0.9441; val_best_acc_score: 0.8911; val_best_f1_score: 0.8955; train_kl_reg_loss: 139760.5837; train_edge_recon_loss: 2808639.9561; train_gene_expr_recon_loss: 34907975.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24481504.8244; train_global_loss: 62337880.7634; train_optim_loss: 62337880.7634; val_kl_reg_loss: 137917.4917; val_edge_recon_loss: 2808941.0333; val_gene_expr_recon_loss: 35051740.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24243898.4000; val_global_loss: 62242497.0667; val_optim_loss: 62242497.0667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9540; val_auprc_score: 0.9457; val_best_acc_score: 0.8914; val_best_f1_score: 0.8974; train_kl_reg_loss: 136154.9112; train_edge_recon_loss: 2805316.5821; train_gene_expr_recon_loss: 34852433.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24430289.6031; train_global_loss: 62224195.0534; train_optim_loss: 62224195.0534; val_kl_reg_loss: 136828.4885; val_edge_recon_loss: 2818074.6000; val_gene_expr_recon_loss: 34999589.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24173742.1333; val_global_loss: 62128234.6667; val_optim_loss: 62128234.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9605; val_auprc_score: 0.9527; val_best_acc_score: 0.9000; val_best_f1_score: 0.9038; train_kl_reg_loss: 134126.2498; train_edge_recon_loss: 2789592.1698; train_gene_expr_recon_loss: 34751416.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24389964.5038; train_global_loss: 62065099.3893; train_optim_loss: 62065099.3893; val_kl_reg_loss: 131902.5562; val_edge_recon_loss: 2799216.6000; val_gene_expr_recon_loss: 34904854.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24156927.4667; val_global_loss: 61992900.8000; val_optim_loss: 61992900.8000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9616; val_auprc_score: 0.9537; val_best_acc_score: 0.9011; val_best_f1_score: 0.9046; train_kl_reg_loss: 131061.0254; train_edge_recon_loss: 2784611.1450; train_gene_expr_recon_loss: 34701707.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24387408.2290; train_global_loss: 62004787.4809; train_optim_loss: 62004787.4809; val_kl_reg_loss: 128989.7526; val_edge_recon_loss: 2800273.5000; val_gene_expr_recon_loss: 34834576.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24128937.2000; val_global_loss: 61892776.8000; val_optim_loss: 61892776.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9643; val_auprc_score: 0.9566; val_best_acc_score: 0.9062; val_best_f1_score: 0.9099; train_kl_reg_loss: 128790.7485; train_edge_recon_loss: 2779073.8340; train_gene_expr_recon_loss: 34633702.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24358766.3206; train_global_loss: 61900333.7099; train_optim_loss: 61900333.7099; val_kl_reg_loss: 125375.4276; val_edge_recon_loss: 2781667.1500; val_gene_expr_recon_loss: 34919021.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24143174.2667; val_global_loss: 61969237.6000; val_optim_loss: 61969237.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9646; val_auprc_score: 0.9594; val_best_acc_score: 0.9031; val_best_f1_score: 0.9071; train_kl_reg_loss: 126568.4264; train_edge_recon_loss: 2766782.1393; train_gene_expr_recon_loss: 34596567.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24363563.4809; train_global_loss: 61853481.6794; train_optim_loss: 61853481.6794; val_kl_reg_loss: 122625.3745; val_edge_recon_loss: 2776249.6167; val_gene_expr_recon_loss: 34801523.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24092781.6000; val_global_loss: 61793180.0000; val_optim_loss: 61793180.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9660; val_auprc_score: 0.9597; val_best_acc_score: 0.9066; val_best_f1_score: 0.9097; train_kl_reg_loss: 123736.4168; train_edge_recon_loss: 2757659.4905; train_gene_expr_recon_loss: 34468979.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24259792.8092; train_global_loss: 61610167.8779; train_optim_loss: 61610167.8779; val_kl_reg_loss: 126168.8521; val_edge_recon_loss: 2766227.8500; val_gene_expr_recon_loss: 34811477.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24158438.9333; val_global_loss: 61862313.6000; val_optim_loss: 61862313.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9657; val_auprc_score: 0.9583; val_best_acc_score: 0.9091; val_best_f1_score: 0.9127; train_kl_reg_loss: 121845.3112; train_edge_recon_loss: 2757410.9122; train_gene_expr_recon_loss: 34426252.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24245351.4046; train_global_loss: 61550860.7023; train_optim_loss: 61550860.7023; val_kl_reg_loss: 121026.4219; val_edge_recon_loss: 2758284.2167; val_gene_expr_recon_loss: 34651707.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24083716.9333; val_global_loss: 61614735.7333; val_optim_loss: 61614735.7333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9710; val_auprc_score: 0.9656; val_best_acc_score: 0.9163; val_best_f1_score: 0.9192; train_kl_reg_loss: 120113.3409; train_edge_recon_loss: 2752902.1260; train_gene_expr_recon_loss: 34353999.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24215858.0458; train_global_loss: 61442873.3740; train_optim_loss: 61442873.3740; val_kl_reg_loss: 117352.0229; val_edge_recon_loss: 2766712.9000; val_gene_expr_recon_loss: 34660640.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24031150.9333; val_global_loss: 61575856.5333; val_optim_loss: 61575856.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9705; val_auprc_score: 0.9637; val_best_acc_score: 0.9159; val_best_f1_score: 0.9193; train_kl_reg_loss: 117432.5370; train_edge_recon_loss: 2743872.5992; train_gene_expr_recon_loss: 34315684.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24208878.0000; train_global_loss: 61385866.9924; train_optim_loss: 61385866.9924; val_kl_reg_loss: 118596.0833; val_edge_recon_loss: 2754965.0167; val_gene_expr_recon_loss: 34618400.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24061377.2000; val_global_loss: 61553339.4667; val_optim_loss: 61553339.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9673; val_auprc_score: 0.9611; val_best_acc_score: 0.9143; val_best_f1_score: 0.9178; train_kl_reg_loss: 114919.9630; train_edge_recon_loss: 2743132.2156; train_gene_expr_recon_loss: 34294092.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24211407.6183; train_global_loss: 61363552.6412; train_optim_loss: 61363552.6412; val_kl_reg_loss: 116863.8104; val_edge_recon_loss: 2767025.4000; val_gene_expr_recon_loss: 34517875.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23982604.8000; val_global_loss: 61384369.0667; val_optim_loss: 61384369.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9692; val_auprc_score: 0.9609; val_best_acc_score: 0.9155; val_best_f1_score: 0.9189; train_kl_reg_loss: 122536.6859; train_edge_recon_loss: 2795636.6584; train_gene_expr_recon_loss: 35552752.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24563499.3130; train_global_loss: 63034424.9160; train_optim_loss: 63034424.9160; val_kl_reg_loss: 67055.3839; val_edge_recon_loss: 2801289.0500; val_gene_expr_recon_loss: 35601220.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24289228.5333; val_global_loss: 62758792.8000; val_optim_loss: 62758792.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9693; val_auprc_score: 0.9617; val_best_acc_score: 0.9205; val_best_f1_score: 0.9233; train_kl_reg_loss: 120424.3893; train_edge_recon_loss: 2764993.2882; train_gene_expr_recon_loss: 35335782.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24489141.7405; train_global_loss: 62710342.1985; train_optim_loss: 62710342.1985; val_kl_reg_loss: 70533.5250; val_edge_recon_loss: 2758214.3667; val_gene_expr_recon_loss: 35429893.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24175472.5333; val_global_loss: 62434114.6667; val_optim_loss: 62434114.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9699; val_auprc_score: 0.9636; val_best_acc_score: 0.9181; val_best_f1_score: 0.9214; train_kl_reg_loss: 112895.9070; train_edge_recon_loss: 2744594.7137; train_gene_expr_recon_loss: 35299511.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24489946.5802; train_global_loss: 62646948.6718; train_optim_loss: 62646948.6718; val_kl_reg_loss: 71670.9385; val_edge_recon_loss: 2758120.0333; val_gene_expr_recon_loss: 35529157.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24328420.8000; val_global_loss: 62687368.8000; val_optim_loss: 62687368.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9732; val_auprc_score: 0.9683; val_best_acc_score: 0.9204; val_best_f1_score: 0.9233; train_kl_reg_loss: 106416.5008; train_edge_recon_loss: 2750674.1756; train_gene_expr_recon_loss: 35208725.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24462626.0763; train_global_loss: 62528441.8931; train_optim_loss: 62528441.8931; val_kl_reg_loss: 71897.7036; val_edge_recon_loss: 2738727.6833; val_gene_expr_recon_loss: 35506244.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24341725.2000; val_global_loss: 62658594.9333; val_optim_loss: 62658594.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9715; val_auprc_score: 0.9642; val_best_acc_score: 0.9216; val_best_f1_score: 0.9237; train_kl_reg_loss: 104719.3350; train_edge_recon_loss: 2737733.3626; train_gene_expr_recon_loss: 35134931.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24428965.3282; train_global_loss: 62406350.0763; train_optim_loss: 62406350.0763; val_kl_reg_loss: 73543.2302; val_edge_recon_loss: 2727816.7500; val_gene_expr_recon_loss: 35324338.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24256629.8667; val_global_loss: 62382328.2667; val_optim_loss: 62382328.2667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9700; val_auprc_score: 0.9627; val_best_acc_score: 0.9175; val_best_f1_score: 0.9203; train_kl_reg_loss: 105242.3325; train_edge_recon_loss: 2732174.6069; train_gene_expr_recon_loss: 35125347.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24414101.5115; train_global_loss: 62376866.4122; train_optim_loss: 62376866.4122; val_kl_reg_loss: 74597.7266; val_edge_recon_loss: 2759590.0167; val_gene_expr_recon_loss: 35310025.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24152464.9333; val_global_loss: 62296678.4000; val_optim_loss: 62296678.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9738; val_auprc_score: 0.9693; val_best_acc_score: 0.9198; val_best_f1_score: 0.9221; train_kl_reg_loss: 104665.9797; train_edge_recon_loss: 2744441.5191; train_gene_expr_recon_loss: 35136072.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24433128.8397; train_global_loss: 62418308.5191; train_optim_loss: 62418308.5191; val_kl_reg_loss: 74613.2016; val_edge_recon_loss: 2738215.7667; val_gene_expr_recon_loss: 35571338.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24244890.6667; val_global_loss: 62629058.6667; val_optim_loss: 62629058.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9712; val_auprc_score: 0.9665; val_best_acc_score: 0.9163; val_best_f1_score: 0.9178; train_kl_reg_loss: 104329.3038; train_edge_recon_loss: 2738281.8092; train_gene_expr_recon_loss: 35193603.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24438042.9313; train_global_loss: 62474257.9542; train_optim_loss: 62474257.9542; val_kl_reg_loss: 75306.7870; val_edge_recon_loss: 2762387.0000; val_gene_expr_recon_loss: 35672198.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24339209.7333; val_global_loss: 62849102.6667; val_optim_loss: 62849102.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 53 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9723
val AUPRC score: 0.9682
val best accuracy score: 0.9205
val best F1 score: 0.9230
val target rna MSE score: 1.2174
val source rna MSE score: 22.7692
val target atac MSE score: 0.3411
val source atac MSE score: 2.9269
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
