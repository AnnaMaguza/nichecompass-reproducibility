[True]
Run timestamp: 27072023_021125_122.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_122']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8898; val_auprc_score: 0.9756; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 8916420.5619; train_edge_recon_loss: 11558946.1581; train_gene_expr_recon_loss: 17594810.2651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38070177.1721; train_optim_loss: 38070177.1721; val_kl_reg_loss: 5302118.2708; val_edge_recon_loss: 11812297.5000; val_gene_expr_recon_loss: 6535594.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23650010.4167; val_optim_loss: 23650010.4167
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8818; val_auprc_score: 0.9762; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 3666684.9872; train_edge_recon_loss: 11719889.4791; train_gene_expr_recon_loss: 13846876.8651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29233451.3814; train_optim_loss: 29233451.3814; val_kl_reg_loss: 622584.8906; val_edge_recon_loss: 11882591.5000; val_gene_expr_recon_loss: 4881187.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17386364.2083; val_optim_loss: 17386364.2083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8845; val_auprc_score: 0.9777; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 1002979.2799; train_edge_recon_loss: 11670452.5116; train_gene_expr_recon_loss: 7549645.0651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20223076.8791; train_optim_loss: 20223076.8791; val_kl_reg_loss: 139718.1055; val_edge_recon_loss: 12079173.2917; val_gene_expr_recon_loss: 3502758.3854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15721649.7917; val_optim_loss: 15721649.7917
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8523; val_auprc_score: 0.9698; val_best_acc_score: 0.8605; val_best_f1_score: 0.9240; train_kl_reg_loss: 171719.5964; train_edge_recon_loss: 11210138.5442; train_gene_expr_recon_loss: 3861578.6663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15243436.7674; train_optim_loss: 15243436.7674; val_kl_reg_loss: 71631.8005; val_edge_recon_loss: 11875519.5000; val_gene_expr_recon_loss: 2945599.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14892750.4583; val_optim_loss: 14892750.4583
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8549; val_auprc_score: 0.9657; val_best_acc_score: 0.8724; val_best_f1_score: 0.9271; train_kl_reg_loss: 81104.6317; train_edge_recon_loss: 10577245.4605; train_gene_expr_recon_loss: 1942720.5919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12601070.6977; train_optim_loss: 12601070.6977; val_kl_reg_loss: 50829.3848; val_edge_recon_loss: 11732893.6667; val_gene_expr_recon_loss: 1526420.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13310143.3750; val_optim_loss: 13310143.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8527; val_auprc_score: 0.9664; val_best_acc_score: 0.8888; val_best_f1_score: 0.9381; train_kl_reg_loss: 35414.1317; train_edge_recon_loss: 9607619.5558; train_gene_expr_recon_loss: 1405539.3401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11048573.0279; train_optim_loss: 11048573.0279; val_kl_reg_loss: 36134.7191; val_edge_recon_loss: 8914262.4583; val_gene_expr_recon_loss: 1301938.3177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10252335.4167; val_optim_loss: 10252335.4167
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8600; val_auprc_score: 0.9683; val_best_acc_score: 0.8952; val_best_f1_score: 0.9412; train_kl_reg_loss: 45321.1888; train_edge_recon_loss: 8517350.5209; train_gene_expr_recon_loss: 1220681.6808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9783353.4023; train_optim_loss: 9783353.4023; val_kl_reg_loss: 48837.2873; val_edge_recon_loss: 8551927.1458; val_gene_expr_recon_loss: 1153370.1510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9754134.6667; val_optim_loss: 9754134.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8671; val_auprc_score: 0.9683; val_best_acc_score: 0.8946; val_best_f1_score: 0.9403; train_kl_reg_loss: 48810.4114; train_edge_recon_loss: 8408119.0558; train_gene_expr_recon_loss: 1118544.8733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9575474.3209; train_optim_loss: 9575474.3209; val_kl_reg_loss: 44889.6951; val_edge_recon_loss: 8588136.6250; val_gene_expr_recon_loss: 1083675.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9716701.6875; val_optim_loss: 9716701.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8766; val_auprc_score: 0.9719; val_best_acc_score: 0.8931; val_best_f1_score: 0.9391; train_kl_reg_loss: 44436.9190; train_edge_recon_loss: 8269198.6791; train_gene_expr_recon_loss: 1059827.6041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9373463.2163; train_optim_loss: 9373463.2163; val_kl_reg_loss: 40740.4979; val_edge_recon_loss: 8300448.3542; val_gene_expr_recon_loss: 1035930.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9377119.1250; val_optim_loss: 9377119.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8955; val_auprc_score: 0.9767; val_best_acc_score: 0.9035; val_best_f1_score: 0.9449; train_kl_reg_loss: 40441.0230; train_edge_recon_loss: 8102634.8535; train_gene_expr_recon_loss: 1021373.7834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9164449.6256; train_optim_loss: 9164449.6256; val_kl_reg_loss: 37257.4546; val_edge_recon_loss: 8109287.6042; val_gene_expr_recon_loss: 1002231.5755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9148776.5417; val_optim_loss: 9148776.5417
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8998; val_auprc_score: 0.9775; val_best_acc_score: 0.9106; val_best_f1_score: 0.9489; train_kl_reg_loss: 36596.5528; train_edge_recon_loss: 8093625.4419; train_gene_expr_recon_loss: 992954.1299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9123176.1209; train_optim_loss: 9123176.1209; val_kl_reg_loss: 33828.3962; val_edge_recon_loss: 8092987.4375; val_gene_expr_recon_loss: 979497.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9106313.4583; val_optim_loss: 9106313.4583
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9044; val_auprc_score: 0.9788; val_best_acc_score: 0.9162; val_best_f1_score: 0.9519; train_kl_reg_loss: 32268.8497; train_edge_recon_loss: 8036926.1163; train_gene_expr_recon_loss: 971201.7631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9040396.7465; train_optim_loss: 9040396.7465; val_kl_reg_loss: 28396.4704; val_edge_recon_loss: 7972855.6042; val_gene_expr_recon_loss: 959800.3490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8961052.5208; val_optim_loss: 8961052.5208
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9146; val_auprc_score: 0.9808; val_best_acc_score: 0.9179; val_best_f1_score: 0.9531; train_kl_reg_loss: 28448.2330; train_edge_recon_loss: 8020176.7047; train_gene_expr_recon_loss: 952235.3985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9000860.2860; train_optim_loss: 9000860.2860; val_kl_reg_loss: 26513.3997; val_edge_recon_loss: 8005392.3125; val_gene_expr_recon_loss: 939580.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8971486.5625; val_optim_loss: 8971486.5625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9180; val_auprc_score: 0.9822; val_best_acc_score: 0.9165; val_best_f1_score: 0.9520; train_kl_reg_loss: 25162.7510; train_edge_recon_loss: 7910511.5721; train_gene_expr_recon_loss: 935281.1962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8870955.5302; train_optim_loss: 8870955.5302; val_kl_reg_loss: 24331.6053; val_edge_recon_loss: 8088419.3333; val_gene_expr_recon_loss: 925397.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9038148.8333; val_optim_loss: 9038148.8333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9263; val_auprc_score: 0.9848; val_best_acc_score: 0.9219; val_best_f1_score: 0.9552; train_kl_reg_loss: 22619.1963; train_edge_recon_loss: 7967964.9605; train_gene_expr_recon_loss: 919743.7616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8910327.9326; train_optim_loss: 8910327.9326; val_kl_reg_loss: 21219.8140; val_edge_recon_loss: 7838248.5208; val_gene_expr_recon_loss: 910038.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8769506.4792; val_optim_loss: 8769506.4792
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9283; val_auprc_score: 0.9846; val_best_acc_score: 0.9200; val_best_f1_score: 0.9540; train_kl_reg_loss: 20982.1846; train_edge_recon_loss: 7923599.4488; train_gene_expr_recon_loss: 905694.7698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8850276.3884; train_optim_loss: 8850276.3884; val_kl_reg_loss: 20957.0795; val_edge_recon_loss: 8174472.8125; val_gene_expr_recon_loss: 898609.2240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9094039.1042; val_optim_loss: 9094039.1042
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9273; val_auprc_score: 0.9835; val_best_acc_score: 0.9205; val_best_f1_score: 0.9546; train_kl_reg_loss: 21115.9468; train_edge_recon_loss: 7830733.5209; train_gene_expr_recon_loss: 893908.6087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8745758.1047; train_optim_loss: 8745758.1047; val_kl_reg_loss: 19656.2094; val_edge_recon_loss: 7906979.7292; val_gene_expr_recon_loss: 886349.3776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8812985.1667; val_optim_loss: 8812985.1667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9340; val_auprc_score: 0.9850; val_best_acc_score: 0.9269; val_best_f1_score: 0.9579; train_kl_reg_loss: 22114.6299; train_edge_recon_loss: 7834326.0558; train_gene_expr_recon_loss: 883755.0721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8740195.7907; train_optim_loss: 8740195.7907; val_kl_reg_loss: 21840.2335; val_edge_recon_loss: 7857136.6042; val_gene_expr_recon_loss: 876866.0182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8755842.8750; val_optim_loss: 8755842.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9321; val_auprc_score: 0.9840; val_best_acc_score: 0.9250; val_best_f1_score: 0.9570; train_kl_reg_loss: 22481.2538; train_edge_recon_loss: 7828085.6326; train_gene_expr_recon_loss: 873698.7561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8724265.6349; train_optim_loss: 8724265.6349; val_kl_reg_loss: 21949.8035; val_edge_recon_loss: 7839632.5000; val_gene_expr_recon_loss: 867013.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8728595.3958; val_optim_loss: 8728595.3958
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9311; val_auprc_score: 0.9851; val_best_acc_score: 0.9153; val_best_f1_score: 0.9516; train_kl_reg_loss: 22492.9379; train_edge_recon_loss: 7830377.1395; train_gene_expr_recon_loss: 863941.8172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8716811.9209; train_optim_loss: 8716811.9209; val_kl_reg_loss: 23497.9723; val_edge_recon_loss: 8017029.1458; val_gene_expr_recon_loss: 858157.1979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8898684.2708; val_optim_loss: 8898684.2708
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9378; val_auprc_score: 0.9867; val_best_acc_score: 0.9228; val_best_f1_score: 0.9557; train_kl_reg_loss: 23083.6184; train_edge_recon_loss: 7829367.2930; train_gene_expr_recon_loss: 855393.3596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8707844.2558; train_optim_loss: 8707844.2558; val_kl_reg_loss: 25596.3490; val_edge_recon_loss: 7823138.2083; val_gene_expr_recon_loss: 850804.2526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8699538.8958; val_optim_loss: 8699538.8958
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9388; val_auprc_score: 0.9865; val_best_acc_score: 0.9268; val_best_f1_score: 0.9576; train_kl_reg_loss: 25321.7463; train_edge_recon_loss: 7814790.2535; train_gene_expr_recon_loss: 847195.4395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8687307.4372; train_optim_loss: 8687307.4372; val_kl_reg_loss: 24326.8738; val_edge_recon_loss: 7874324.5625; val_gene_expr_recon_loss: 840996.4401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8739647.8750; val_optim_loss: 8739647.8750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9405; val_auprc_score: 0.9864; val_best_acc_score: 0.9297; val_best_f1_score: 0.9596; train_kl_reg_loss: 25734.2675; train_edge_recon_loss: 7902352.8605; train_gene_expr_recon_loss: 838826.9090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8766914.0116; train_optim_loss: 8766914.0116; val_kl_reg_loss: 23089.5242; val_edge_recon_loss: 8006281.6667; val_gene_expr_recon_loss: 834119.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8863490.7917; val_optim_loss: 8863490.7917
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9365; val_auprc_score: 0.9865; val_best_acc_score: 0.9196; val_best_f1_score: 0.9536; train_kl_reg_loss: 26081.9806; train_edge_recon_loss: 7896761.5512; train_gene_expr_recon_loss: 831212.1448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8754055.6628; train_optim_loss: 8754055.6628; val_kl_reg_loss: 26601.3838; val_edge_recon_loss: 7951310.8542; val_gene_expr_recon_loss: 826225.5208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8804137.7292; val_optim_loss: 8804137.7292
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9375; val_auprc_score: 0.9852; val_best_acc_score: 0.9244; val_best_f1_score: 0.9563; train_kl_reg_loss: 25223.4891; train_edge_recon_loss: 7796188.5837; train_gene_expr_recon_loss: 824048.7061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8645460.7767; train_optim_loss: 8645460.7767; val_kl_reg_loss: 23057.9637; val_edge_recon_loss: 8163201.0625; val_gene_expr_recon_loss: 819084.4714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9005343.4583; val_optim_loss: 9005343.4583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9406; val_auprc_score: 0.9864; val_best_acc_score: 0.9289; val_best_f1_score: 0.9588; train_kl_reg_loss: 23587.8940; train_edge_recon_loss: 7722716.6581; train_gene_expr_recon_loss: 824894.6360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8571199.1628; train_optim_loss: 8571199.1628; val_kl_reg_loss: 8100.9705; val_edge_recon_loss: 8231764.4583; val_gene_expr_recon_loss: 822532.0495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9062397.4792; val_optim_loss: 9062397.4792
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9393; val_auprc_score: 0.9868; val_best_acc_score: 0.9225; val_best_f1_score: 0.9551; train_kl_reg_loss: 23158.2110; train_edge_recon_loss: 7781436.6279; train_gene_expr_recon_loss: 823819.7953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8628414.6093; train_optim_loss: 8628414.6093; val_kl_reg_loss: 8200.7646; val_edge_recon_loss: 8266851.8750; val_gene_expr_recon_loss: 822275.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9097328.6250; val_optim_loss: 9097328.6250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9423; val_auprc_score: 0.9875; val_best_acc_score: 0.9306; val_best_f1_score: 0.9599; train_kl_reg_loss: 22572.5197; train_edge_recon_loss: 7900787.7442; train_gene_expr_recon_loss: 822802.7703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8746163.0558; train_optim_loss: 8746163.0558; val_kl_reg_loss: 8017.3154; val_edge_recon_loss: 7857137.3750; val_gene_expr_recon_loss: 822056.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8687210.7708; val_optim_loss: 8687210.7708
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9437; val_auprc_score: 0.9873; val_best_acc_score: 0.9326; val_best_f1_score: 0.9611; train_kl_reg_loss: 21872.2788; train_edge_recon_loss: 7757451.8488; train_gene_expr_recon_loss: 821951.5538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8601275.6860; train_optim_loss: 8601275.6860; val_kl_reg_loss: 7787.4011; val_edge_recon_loss: 7699149.5000; val_gene_expr_recon_loss: 820434.8021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8527371.7292; val_optim_loss: 8527371.7292
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9506; val_auprc_score: 0.9899; val_best_acc_score: 0.9316; val_best_f1_score: 0.9603; train_kl_reg_loss: 21238.1402; train_edge_recon_loss: 7838511.6977; train_gene_expr_recon_loss: 821405.9794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8681155.8093; train_optim_loss: 8681155.8093; val_kl_reg_loss: 7685.1933; val_edge_recon_loss: 7806025.8333; val_gene_expr_recon_loss: 820073.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8633784.2500; val_optim_loss: 8633784.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9443; val_auprc_score: 0.9880; val_best_acc_score: 0.9315; val_best_f1_score: 0.9604; train_kl_reg_loss: 20701.6818; train_edge_recon_loss: 7706333.3907; train_gene_expr_recon_loss: 820091.6605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8547126.7581; train_optim_loss: 8547126.7581; val_kl_reg_loss: 7453.8738; val_edge_recon_loss: 7644012.6250; val_gene_expr_recon_loss: 818369.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8469835.8125; val_optim_loss: 8469835.8125
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9457; val_auprc_score: 0.9890; val_best_acc_score: 0.9275; val_best_f1_score: 0.9583; train_kl_reg_loss: 19928.5690; train_edge_recon_loss: 7793182.8302; train_gene_expr_recon_loss: 819588.8035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8632700.2047; train_optim_loss: 8632700.2047; val_kl_reg_loss: 7480.0611; val_edge_recon_loss: 7801425.6667; val_gene_expr_recon_loss: 817312.7240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8626218.3750; val_optim_loss: 8626218.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9447; val_auprc_score: 0.9879; val_best_acc_score: 0.9293; val_best_f1_score: 0.9589; train_kl_reg_loss: 19610.6436; train_edge_recon_loss: 7810334.6000; train_gene_expr_recon_loss: 818730.0971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8648675.3233; train_optim_loss: 8648675.3233; val_kl_reg_loss: 7319.4065; val_edge_recon_loss: 7929343.4792; val_gene_expr_recon_loss: 817182.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8753845.6042; val_optim_loss: 8753845.6042
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9413; val_auprc_score: 0.9868; val_best_acc_score: 0.9264; val_best_f1_score: 0.9571; train_kl_reg_loss: 18876.1420; train_edge_recon_loss: 7749719.5651; train_gene_expr_recon_loss: 817719.6381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8586315.3302; train_optim_loss: 8586315.3302; val_kl_reg_loss: 7206.4283; val_edge_recon_loss: 8192795.4167; val_gene_expr_recon_loss: 816426.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9016427.8333; val_optim_loss: 9016427.8333
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9429; val_auprc_score: 0.9873; val_best_acc_score: 0.9288; val_best_f1_score: 0.9588; train_kl_reg_loss: 18452.4900; train_edge_recon_loss: 7883660.9698; train_gene_expr_recon_loss: 816291.4820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8718404.9791; train_optim_loss: 8718404.9791; val_kl_reg_loss: 7262.0556; val_edge_recon_loss: 7929906.3750; val_gene_expr_recon_loss: 815621.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8752789.9583; val_optim_loss: 8752789.9583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9419; val_auprc_score: 0.9868; val_best_acc_score: 0.9294; val_best_f1_score: 0.9592; train_kl_reg_loss: 18047.4814; train_edge_recon_loss: 7738638.9535; train_gene_expr_recon_loss: 816207.4616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8572893.8791; train_optim_loss: 8572893.8791; val_kl_reg_loss: 7197.7571; val_edge_recon_loss: 7823048.0000; val_gene_expr_recon_loss: 814711.8854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8644957.6458; val_optim_loss: 8644957.6458
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9464; val_auprc_score: 0.9888; val_best_acc_score: 0.9303; val_best_f1_score: 0.9598; train_kl_reg_loss: 18014.6001; train_edge_recon_loss: 7721641.1000; train_gene_expr_recon_loss: 815818.7349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8555474.4558; train_optim_loss: 8555474.4558; val_kl_reg_loss: 7209.3700; val_edge_recon_loss: 7846330.0000; val_gene_expr_recon_loss: 814561.4714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8668100.8750; val_optim_loss: 8668100.8750
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9462; val_auprc_score: 0.9881; val_best_acc_score: 0.9305; val_best_f1_score: 0.9600; train_kl_reg_loss: 18009.6130; train_edge_recon_loss: 7829547.4767; train_gene_expr_recon_loss: 815694.3977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8663251.4953; train_optim_loss: 8663251.4953; val_kl_reg_loss: 7240.7433; val_edge_recon_loss: 7691972.2708; val_gene_expr_recon_loss: 814847.5026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8514060.5625; val_optim_loss: 8514060.5625
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9456; val_auprc_score: 0.9884; val_best_acc_score: 0.9298; val_best_f1_score: 0.9596; train_kl_reg_loss: 17985.8232; train_edge_recon_loss: 7747601.0000; train_gene_expr_recon_loss: 815628.9491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8581215.8116; train_optim_loss: 8581215.8116; val_kl_reg_loss: 7210.4353; val_edge_recon_loss: 7889296.3333; val_gene_expr_recon_loss: 814248.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8710755.5208; val_optim_loss: 8710755.5208

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 4 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9414
Val AUPRC score: 0.9870
Val best accuracy score: 0.9303
Val best F1 score: 0.9597
Val gene expr MSE score: 48759.8503
Val cat covariate0 mean sim diff: -0.0003

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
