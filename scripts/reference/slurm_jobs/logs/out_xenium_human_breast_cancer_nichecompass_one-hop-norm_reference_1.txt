Run timestamp: 20062023_154812_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 313, n_cond_embed_input: 2, n_layers: 1, n_hidden: 313, n_latent: 1302, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1302, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1302, n_cond_embed_input: 2, n_addon_input: 0, n_output: 626
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 254127
Number of validation nodes: 28236
Number of training edges: 600721
Number of validation edges: 66746
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9165; val_auprc_score: 0.9419; val_best_acc_score: 0.8737; val_best_f1_score: 0.9089; train_kl_reg_loss: 5503.6688; train_edge_recon_loss: 195567.1202; train_gene_expr_recon_loss: 94696.2908; train_masked_gp_l1_reg_loss: 1232.9108; train_group_lasso_reg_loss: 0.0000; train_global_loss: 296999.9915; train_optim_loss: 296999.9915; val_kl_reg_loss: 6491.1729; val_edge_recon_loss: 186006.7987; val_gene_expr_recon_loss: 82228.8764; val_masked_gp_l1_reg_loss: 1108.5533; val_group_lasso_reg_loss: 0.0000; val_global_loss: 275835.4099; val_optim_loss: 275835.4099
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9424; val_auprc_score: 0.9593; val_best_acc_score: 0.9054; val_best_f1_score: 0.9313; train_kl_reg_loss: 6248.3441; train_edge_recon_loss: 182564.6246; train_gene_expr_recon_loss: 79251.1024; train_masked_gp_l1_reg_loss: 1131.1260; train_group_lasso_reg_loss: 0.0000; train_global_loss: 269195.1975; train_optim_loss: 269195.1975; val_kl_reg_loss: 5869.2800; val_edge_recon_loss: 183635.0662; val_gene_expr_recon_loss: 76584.1195; val_masked_gp_l1_reg_loss: 1167.2319; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267255.6820; val_optim_loss: 267255.6820
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9517; val_auprc_score: 0.9661; val_best_acc_score: 0.9140; val_best_f1_score: 0.9371; train_kl_reg_loss: 5799.3502; train_edge_recon_loss: 180859.4471; train_gene_expr_recon_loss: 75230.8719; train_masked_gp_l1_reg_loss: 1193.8695; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263083.5402; train_optim_loss: 263083.5402; val_kl_reg_loss: 5494.4148; val_edge_recon_loss: 184090.2243; val_gene_expr_recon_loss: 73876.1126; val_masked_gp_l1_reg_loss: 1214.4000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264675.1581; val_optim_loss: 264675.1581
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9583; val_auprc_score: 0.9711; val_best_acc_score: 0.9198; val_best_f1_score: 0.9412; train_kl_reg_loss: 5479.2032; train_edge_recon_loss: 180216.3406; train_gene_expr_recon_loss: 72874.8207; train_masked_gp_l1_reg_loss: 1213.5396; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259783.9042; train_optim_loss: 259783.9042; val_kl_reg_loss: 5277.4101; val_edge_recon_loss: 182208.0947; val_gene_expr_recon_loss: 71694.9913; val_masked_gp_l1_reg_loss: 1211.4806; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260391.9743; val_optim_loss: 260391.9743
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9616; val_auprc_score: 0.9733; val_best_acc_score: 0.9237; val_best_f1_score: 0.9441; train_kl_reg_loss: 5279.9944; train_edge_recon_loss: 179436.6577; train_gene_expr_recon_loss: 71094.2803; train_masked_gp_l1_reg_loss: 1197.5792; train_group_lasso_reg_loss: 0.0000; train_global_loss: 257008.5117; train_optim_loss: 257008.5117; val_kl_reg_loss: 4995.1102; val_edge_recon_loss: 181591.8722; val_gene_expr_recon_loss: 70057.4494; val_masked_gp_l1_reg_loss: 1183.1422; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257827.5708; val_optim_loss: 257827.5708
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9656; val_auprc_score: 0.9770; val_best_acc_score: 0.9280; val_best_f1_score: 0.9470; train_kl_reg_loss: 5112.7251; train_edge_recon_loss: 178896.7350; train_gene_expr_recon_loss: 69652.7843; train_masked_gp_l1_reg_loss: 1158.2929; train_group_lasso_reg_loss: 0.0000; train_global_loss: 254820.5375; train_optim_loss: 254820.5375; val_kl_reg_loss: 4882.5795; val_edge_recon_loss: 181374.7482; val_gene_expr_recon_loss: 68839.7142; val_masked_gp_l1_reg_loss: 1132.4465; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256229.4945; val_optim_loss: 256229.4945
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9683; val_auprc_score: 0.9791; val_best_acc_score: 0.9304; val_best_f1_score: 0.9488; train_kl_reg_loss: 5013.9601; train_edge_recon_loss: 178345.8746; train_gene_expr_recon_loss: 68512.1607; train_masked_gp_l1_reg_loss: 1105.9609; train_group_lasso_reg_loss: 0.0000; train_global_loss: 252977.9556; train_optim_loss: 252977.9556; val_kl_reg_loss: 4819.4814; val_edge_recon_loss: 180910.3364; val_gene_expr_recon_loss: 67848.6236; val_masked_gp_l1_reg_loss: 1079.5745; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254658.0193; val_optim_loss: 254658.0193
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9696; val_auprc_score: 0.9796; val_best_acc_score: 0.9330; val_best_f1_score: 0.9505; train_kl_reg_loss: 4945.3587; train_edge_recon_loss: 178427.4533; train_gene_expr_recon_loss: 67567.1021; train_masked_gp_l1_reg_loss: 1052.7716; train_group_lasso_reg_loss: 0.0000; train_global_loss: 251992.6864; train_optim_loss: 251992.6864; val_kl_reg_loss: 4751.1275; val_edge_recon_loss: 180921.7178; val_gene_expr_recon_loss: 66920.8727; val_masked_gp_l1_reg_loss: 1028.1272; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253621.8447; val_optim_loss: 253621.8447
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9707; val_auprc_score: 0.9803; val_best_acc_score: 0.9347; val_best_f1_score: 0.9516; train_kl_reg_loss: 4910.4369; train_edge_recon_loss: 178344.7567; train_gene_expr_recon_loss: 66813.8537; train_masked_gp_l1_reg_loss: 1005.9991; train_group_lasso_reg_loss: 0.0000; train_global_loss: 251075.0466; train_optim_loss: 251075.0466; val_kl_reg_loss: 4753.4779; val_edge_recon_loss: 181447.0441; val_gene_expr_recon_loss: 66280.1804; val_masked_gp_l1_reg_loss: 985.6807; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253466.3888; val_optim_loss: 253466.3888
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9706; val_auprc_score: 0.9809; val_best_acc_score: 0.9338; val_best_f1_score: 0.9511; train_kl_reg_loss: 4889.9220; train_edge_recon_loss: 177914.6674; train_gene_expr_recon_loss: 66174.5360; train_masked_gp_l1_reg_loss: 965.1592; train_group_lasso_reg_loss: 0.0000; train_global_loss: 249944.2848; train_optim_loss: 249944.2848; val_kl_reg_loss: 4707.3584; val_edge_recon_loss: 181050.1903; val_gene_expr_recon_loss: 65775.9989; val_masked_gp_l1_reg_loss: 949.0039; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252482.5515; val_optim_loss: 252482.5515
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9732; val_auprc_score: 0.9827; val_best_acc_score: 0.9368; val_best_f1_score: 0.9531; train_kl_reg_loss: 4873.6846; train_edge_recon_loss: 177761.4006; train_gene_expr_recon_loss: 65624.3880; train_masked_gp_l1_reg_loss: 931.7945; train_group_lasso_reg_loss: 0.0000; train_global_loss: 249191.2671; train_optim_loss: 249191.2671; val_kl_reg_loss: 4743.1122; val_edge_recon_loss: 181497.5818; val_gene_expr_recon_loss: 65223.0404; val_masked_gp_l1_reg_loss: 917.4893; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252381.2169; val_optim_loss: 252381.2169
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9717; val_auprc_score: 0.9814; val_best_acc_score: 0.9375; val_best_f1_score: 0.9539; train_kl_reg_loss: 4872.7278; train_edge_recon_loss: 177918.6280; train_gene_expr_recon_loss: 65174.6606; train_masked_gp_l1_reg_loss: 905.8684; train_group_lasso_reg_loss: 0.0000; train_global_loss: 248871.8845; train_optim_loss: 248871.8845; val_kl_reg_loss: 4762.4649; val_edge_recon_loss: 180007.3934; val_gene_expr_recon_loss: 64805.2960; val_masked_gp_l1_reg_loss: 895.5970; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250470.7491; val_optim_loss: 250470.7491
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9728; val_auprc_score: 0.9819; val_best_acc_score: 0.9378; val_best_f1_score: 0.9538; train_kl_reg_loss: 4874.2415; train_edge_recon_loss: 177647.4427; train_gene_expr_recon_loss: 64769.5962; train_masked_gp_l1_reg_loss: 884.7206; train_group_lasso_reg_loss: 0.0000; train_global_loss: 248176.0013; train_optim_loss: 248176.0013; val_kl_reg_loss: 4700.6812; val_edge_recon_loss: 181607.9329; val_gene_expr_recon_loss: 64468.8897; val_masked_gp_l1_reg_loss: 875.9995; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251653.5009; val_optim_loss: 251653.5009
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9733; val_auprc_score: 0.9825; val_best_acc_score: 0.9380; val_best_f1_score: 0.9540; train_kl_reg_loss: 4870.6756; train_edge_recon_loss: 177926.8149; train_gene_expr_recon_loss: 64387.2424; train_masked_gp_l1_reg_loss: 866.0984; train_group_lasso_reg_loss: 0.0000; train_global_loss: 248050.8300; train_optim_loss: 248050.8300; val_kl_reg_loss: 4744.7974; val_edge_recon_loss: 181518.4108; val_gene_expr_recon_loss: 64090.3212; val_masked_gp_l1_reg_loss: 857.4639; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251210.9963; val_optim_loss: 251210.9963
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9744; val_auprc_score: 0.9834; val_best_acc_score: 0.9395; val_best_f1_score: 0.9553; train_kl_reg_loss: 4885.5602; train_edge_recon_loss: 177615.0979; train_gene_expr_recon_loss: 64061.1279; train_masked_gp_l1_reg_loss: 850.7815; train_group_lasso_reg_loss: 0.0000; train_global_loss: 247412.5672; train_optim_loss: 247412.5672; val_kl_reg_loss: 4775.7577; val_edge_recon_loss: 180299.5046; val_gene_expr_recon_loss: 63715.0142; val_masked_gp_l1_reg_loss: 844.9845; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249635.2629; val_optim_loss: 249635.2629
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9746; val_auprc_score: 0.9830; val_best_acc_score: 0.9397; val_best_f1_score: 0.9554; train_kl_reg_loss: 4881.7221; train_edge_recon_loss: 177550.5521; train_gene_expr_recon_loss: 63782.8246; train_masked_gp_l1_reg_loss: 837.1163; train_group_lasso_reg_loss: 0.0000; train_global_loss: 247052.2147; train_optim_loss: 247052.2147; val_kl_reg_loss: 4784.8046; val_edge_recon_loss: 181487.4256; val_gene_expr_recon_loss: 63538.0797; val_masked_gp_l1_reg_loss: 833.3780; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250643.6866; val_optim_loss: 250643.6866
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9749; val_auprc_score: 0.9834; val_best_acc_score: 0.9409; val_best_f1_score: 0.9563; train_kl_reg_loss: 4883.8175; train_edge_recon_loss: 177324.9177; train_gene_expr_recon_loss: 63540.8057; train_masked_gp_l1_reg_loss: 825.7779; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246575.3194; train_optim_loss: 246575.3194; val_kl_reg_loss: 4829.7968; val_edge_recon_loss: 180694.4393; val_gene_expr_recon_loss: 63289.0862; val_masked_gp_l1_reg_loss: 820.7256; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249634.0423; val_optim_loss: 249634.0423
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9750; val_auprc_score: 0.9833; val_best_acc_score: 0.9411; val_best_f1_score: 0.9563; train_kl_reg_loss: 4887.1345; train_edge_recon_loss: 177670.7562; train_gene_expr_recon_loss: 63266.8006; train_masked_gp_l1_reg_loss: 815.0199; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246639.7098; train_optim_loss: 246639.7098; val_kl_reg_loss: 4732.0832; val_edge_recon_loss: 181012.9384; val_gene_expr_recon_loss: 62979.4625; val_masked_gp_l1_reg_loss: 810.6095; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249535.0947; val_optim_loss: 249535.0947
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9748; val_auprc_score: 0.9832; val_best_acc_score: 0.9412; val_best_f1_score: 0.9566; train_kl_reg_loss: 4889.3680; train_edge_recon_loss: 177542.8787; train_gene_expr_recon_loss: 63026.2487; train_masked_gp_l1_reg_loss: 806.0853; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246264.5808; train_optim_loss: 246264.5808; val_kl_reg_loss: 4738.4047; val_edge_recon_loss: 180127.6783; val_gene_expr_recon_loss: 62895.3194; val_masked_gp_l1_reg_loss: 802.2089; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248563.6057; val_optim_loss: 248563.6057
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9745; val_auprc_score: 0.9831; val_best_acc_score: 0.9407; val_best_f1_score: 0.9563; train_kl_reg_loss: 4898.7373; train_edge_recon_loss: 177409.9917; train_gene_expr_recon_loss: 62841.1579; train_masked_gp_l1_reg_loss: 795.2298; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245945.1171; train_optim_loss: 245945.1171; val_kl_reg_loss: 4768.5502; val_edge_recon_loss: 180968.4154; val_gene_expr_recon_loss: 62711.1324; val_masked_gp_l1_reg_loss: 792.1270; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249240.2224; val_optim_loss: 249240.2224
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9768; val_auprc_score: 0.9848; val_best_acc_score: 0.9434; val_best_f1_score: 0.9581; train_kl_reg_loss: 4906.7459; train_edge_recon_loss: 177284.5071; train_gene_expr_recon_loss: 62677.5664; train_masked_gp_l1_reg_loss: 786.7781; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245655.5975; train_optim_loss: 245655.5975; val_kl_reg_loss: 4847.9033; val_edge_recon_loss: 180197.6186; val_gene_expr_recon_loss: 62487.4825; val_masked_gp_l1_reg_loss: 783.2079; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248316.2077; val_optim_loss: 248316.2077
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9762; val_auprc_score: 0.9844; val_best_acc_score: 0.9422; val_best_f1_score: 0.9571; train_kl_reg_loss: 4904.2848; train_edge_recon_loss: 177347.5517; train_gene_expr_recon_loss: 62496.6835; train_masked_gp_l1_reg_loss: 779.8666; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245528.3864; train_optim_loss: 245528.3864; val_kl_reg_loss: 4805.5967; val_edge_recon_loss: 180648.0037; val_gene_expr_recon_loss: 62239.3222; val_masked_gp_l1_reg_loss: 778.4412; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248471.3594; val_optim_loss: 248471.3594
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9769; val_auprc_score: 0.9849; val_best_acc_score: 0.9433; val_best_f1_score: 0.9581; train_kl_reg_loss: 4906.8492; train_edge_recon_loss: 177632.1486; train_gene_expr_recon_loss: 62364.5686; train_masked_gp_l1_reg_loss: 775.6616; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245679.2273; train_optim_loss: 245679.2273; val_kl_reg_loss: 4779.4033; val_edge_recon_loss: 180471.9504; val_gene_expr_recon_loss: 62218.9800; val_masked_gp_l1_reg_loss: 772.1879; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248242.5184; val_optim_loss: 248242.5184
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9756; val_auprc_score: 0.9838; val_best_acc_score: 0.9426; val_best_f1_score: 0.9576; train_kl_reg_loss: 4917.2358; train_edge_recon_loss: 177214.4390; train_gene_expr_recon_loss: 62252.1593; train_masked_gp_l1_reg_loss: 770.4717; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245154.3059; train_optim_loss: 245154.3059; val_kl_reg_loss: 4726.7298; val_edge_recon_loss: 181326.9605; val_gene_expr_recon_loss: 62021.1131; val_masked_gp_l1_reg_loss: 769.8079; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248844.6167; val_optim_loss: 248844.6167
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9773; val_auprc_score: 0.9849; val_best_acc_score: 0.9446; val_best_f1_score: 0.9589; train_kl_reg_loss: 4908.8436; train_edge_recon_loss: 177352.8141; train_gene_expr_recon_loss: 62111.4400; train_masked_gp_l1_reg_loss: 766.7773; train_group_lasso_reg_loss: 0.0000; train_global_loss: 245139.8744; train_optim_loss: 245139.8744; val_kl_reg_loss: 4782.2246; val_edge_recon_loss: 180065.8649; val_gene_expr_recon_loss: 61978.5797; val_masked_gp_l1_reg_loss: 764.8948; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247591.5597; val_optim_loss: 247591.5597
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9741; val_auprc_score: 0.9831; val_best_acc_score: 0.9396; val_best_f1_score: 0.9551; train_kl_reg_loss: 3075.3866; train_edge_recon_loss: 177156.8306; train_gene_expr_recon_loss: 62132.1017; train_masked_gp_l1_reg_loss: 781.7062; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243146.0247; train_optim_loss: 243146.0247; val_kl_reg_loss: 2382.0244; val_edge_recon_loss: 181837.9752; val_gene_expr_recon_loss: 61988.6137; val_masked_gp_l1_reg_loss: 791.2809; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246999.8952; val_optim_loss: 246999.8952
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9763; val_auprc_score: 0.9847; val_best_acc_score: 0.9417; val_best_f1_score: 0.9567; train_kl_reg_loss: 2744.2003; train_edge_recon_loss: 177092.0621; train_gene_expr_recon_loss: 62020.3063; train_masked_gp_l1_reg_loss: 792.3100; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242648.8791; train_optim_loss: 242648.8791; val_kl_reg_loss: 2397.9678; val_edge_recon_loss: 181161.1121; val_gene_expr_recon_loss: 61903.7314; val_masked_gp_l1_reg_loss: 796.6373; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246259.4531; val_optim_loss: 246259.4531
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9751; val_auprc_score: 0.9836; val_best_acc_score: 0.9413; val_best_f1_score: 0.9565; train_kl_reg_loss: 2668.2366; train_edge_recon_loss: 177007.9744; train_gene_expr_recon_loss: 61915.8905; train_masked_gp_l1_reg_loss: 796.0971; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242388.1992; train_optim_loss: 242388.1992; val_kl_reg_loss: 2389.6941; val_edge_recon_loss: 180984.0193; val_gene_expr_recon_loss: 61795.8456; val_masked_gp_l1_reg_loss: 799.0679; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245968.6213; val_optim_loss: 245968.6213
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9759; val_auprc_score: 0.9842; val_best_acc_score: 0.9419; val_best_f1_score: 0.9569; train_kl_reg_loss: 2606.6798; train_edge_recon_loss: 177088.6450; train_gene_expr_recon_loss: 61815.5695; train_masked_gp_l1_reg_loss: 798.3607; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242309.2563; train_optim_loss: 242309.2563; val_kl_reg_loss: 2404.0332; val_edge_recon_loss: 181378.0800; val_gene_expr_recon_loss: 61725.0090; val_masked_gp_l1_reg_loss: 801.0410; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246308.1682; val_optim_loss: 246308.1682
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9757; val_auprc_score: 0.9840; val_best_acc_score: 0.9421; val_best_f1_score: 0.9572; train_kl_reg_loss: 2581.2624; train_edge_recon_loss: 176778.7375; train_gene_expr_recon_loss: 61742.4475; train_masked_gp_l1_reg_loss: 801.5822; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241904.0295; train_optim_loss: 241904.0295; val_kl_reg_loss: 2397.9082; val_edge_recon_loss: 180871.6691; val_gene_expr_recon_loss: 61616.7631; val_masked_gp_l1_reg_loss: 803.4180; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245689.7665; val_optim_loss: 245689.7665
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9771; val_auprc_score: 0.9851; val_best_acc_score: 0.9429; val_best_f1_score: 0.9578; train_kl_reg_loss: 2553.1560; train_edge_recon_loss: 176472.7487; train_gene_expr_recon_loss: 61683.7292; train_masked_gp_l1_reg_loss: 802.6451; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241512.2791; train_optim_loss: 241512.2791; val_kl_reg_loss: 2396.4867; val_edge_recon_loss: 180523.8263; val_gene_expr_recon_loss: 61564.6588; val_masked_gp_l1_reg_loss: 803.1093; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245288.0818; val_optim_loss: 245288.0818
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9766; val_auprc_score: 0.9846; val_best_acc_score: 0.9434; val_best_f1_score: 0.9580; train_kl_reg_loss: 2529.4956; train_edge_recon_loss: 176620.6938; train_gene_expr_recon_loss: 61581.7237; train_masked_gp_l1_reg_loss: 803.8498; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241535.7623; train_optim_loss: 241535.7623; val_kl_reg_loss: 2395.9326; val_edge_recon_loss: 180178.2316; val_gene_expr_recon_loss: 61508.7518; val_masked_gp_l1_reg_loss: 804.8516; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244887.7730; val_optim_loss: 244887.7730
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9763; val_auprc_score: 0.9842; val_best_acc_score: 0.9427; val_best_f1_score: 0.9575; train_kl_reg_loss: 2514.6738; train_edge_recon_loss: 176412.0599; train_gene_expr_recon_loss: 61528.1683; train_masked_gp_l1_reg_loss: 806.4217; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241261.3237; train_optim_loss: 241261.3237; val_kl_reg_loss: 2362.7066; val_edge_recon_loss: 181478.5570; val_gene_expr_recon_loss: 61463.3162; val_masked_gp_l1_reg_loss: 808.2056; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246112.7858; val_optim_loss: 246112.7858
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9762; val_auprc_score: 0.9844; val_best_acc_score: 0.9425; val_best_f1_score: 0.9575; train_kl_reg_loss: 2505.4173; train_edge_recon_loss: 176942.9033; train_gene_expr_recon_loss: 61475.8076; train_masked_gp_l1_reg_loss: 809.4999; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241733.6278; train_optim_loss: 241733.6278; val_kl_reg_loss: 2382.5712; val_edge_recon_loss: 180367.8079; val_gene_expr_recon_loss: 61475.6390; val_masked_gp_l1_reg_loss: 807.7094; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245033.7233; val_optim_loss: 245033.7233
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9773; val_auprc_score: 0.9851; val_best_acc_score: 0.9442; val_best_f1_score: 0.9588; train_kl_reg_loss: 2496.0169; train_edge_recon_loss: 176254.5702; train_gene_expr_recon_loss: 61441.0695; train_masked_gp_l1_reg_loss: 807.9826; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240999.6397; train_optim_loss: 240999.6397; val_kl_reg_loss: 2368.6172; val_edge_recon_loss: 180027.9789; val_gene_expr_recon_loss: 61346.6234; val_masked_gp_l1_reg_loss: 808.6171; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244551.8318; val_optim_loss: 244551.8318
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9768; val_auprc_score: 0.9843; val_best_acc_score: 0.9442; val_best_f1_score: 0.9586; train_kl_reg_loss: 2483.5341; train_edge_recon_loss: 176484.5280; train_gene_expr_recon_loss: 61363.1421; train_masked_gp_l1_reg_loss: 807.3956; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241138.5996; train_optim_loss: 241138.5996; val_kl_reg_loss: 2393.4223; val_edge_recon_loss: 180802.4945; val_gene_expr_recon_loss: 61247.5487; val_masked_gp_l1_reg_loss: 808.2620; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245251.7325; val_optim_loss: 245251.7325
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9774; val_auprc_score: 0.9850; val_best_acc_score: 0.9444; val_best_f1_score: 0.9587; train_kl_reg_loss: 2473.5442; train_edge_recon_loss: 176447.7766; train_gene_expr_recon_loss: 61347.5866; train_masked_gp_l1_reg_loss: 809.8684; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241078.7753; train_optim_loss: 241078.7753; val_kl_reg_loss: 2341.7568; val_edge_recon_loss: 181439.9081; val_gene_expr_recon_loss: 61240.9798; val_masked_gp_l1_reg_loss: 811.7573; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245834.3952; val_optim_loss: 245834.3952
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9777; val_auprc_score: 0.9854; val_best_acc_score: 0.9451; val_best_f1_score: 0.9592; train_kl_reg_loss: 2458.2414; train_edge_recon_loss: 176729.1699; train_gene_expr_recon_loss: 61298.2439; train_masked_gp_l1_reg_loss: 811.2005; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241296.8557; train_optim_loss: 241296.8557; val_kl_reg_loss: 2351.9656; val_edge_recon_loss: 181043.6719; val_gene_expr_recon_loss: 61161.4228; val_masked_gp_l1_reg_loss: 811.0062; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245368.0588; val_optim_loss: 245368.0588

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9777; val_auprc_score: 0.9855; val_best_acc_score: 0.9447; val_best_f1_score: 0.9589; train_kl_reg_loss: 2443.1932; train_edge_recon_loss: 176396.8048; train_gene_expr_recon_loss: 61223.0399; train_masked_gp_l1_reg_loss: 791.4368; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240854.4754; train_optim_loss: 240854.4754; val_kl_reg_loss: 2336.8497; val_edge_recon_loss: 181152.0744; val_gene_expr_recon_loss: 61135.9750; val_masked_gp_l1_reg_loss: 789.3078; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245414.2132; val_optim_loss: 245414.2132
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9774; val_auprc_score: 0.9851; val_best_acc_score: 0.9446; val_best_f1_score: 0.9589; train_kl_reg_loss: 2442.3260; train_edge_recon_loss: 176336.4919; train_gene_expr_recon_loss: 61178.7719; train_masked_gp_l1_reg_loss: 789.3862; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240746.9767; train_optim_loss: 240746.9767; val_kl_reg_loss: 2330.5675; val_edge_recon_loss: 180753.0873; val_gene_expr_recon_loss: 61116.0864; val_masked_gp_l1_reg_loss: 789.7015; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244989.4439; val_optim_loss: 244989.4439
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9783; val_auprc_score: 0.9858; val_best_acc_score: 0.9458; val_best_f1_score: 0.9598; train_kl_reg_loss: 2436.5563; train_edge_recon_loss: 176151.4758; train_gene_expr_recon_loss: 61181.0243; train_masked_gp_l1_reg_loss: 789.7912; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240558.8476; train_optim_loss: 240558.8476; val_kl_reg_loss: 2338.2504; val_edge_recon_loss: 180113.3051; val_gene_expr_recon_loss: 61122.0850; val_masked_gp_l1_reg_loss: 790.2189; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244363.8594; val_optim_loss: 244363.8594
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9775; val_auprc_score: 0.9849; val_best_acc_score: 0.9449; val_best_f1_score: 0.9592; train_kl_reg_loss: 2437.1875; train_edge_recon_loss: 176476.3175; train_gene_expr_recon_loss: 61164.6595; train_masked_gp_l1_reg_loss: 790.3482; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240868.5129; train_optim_loss: 240868.5129; val_kl_reg_loss: 2330.1999; val_edge_recon_loss: 181183.5607; val_gene_expr_recon_loss: 61115.4561; val_masked_gp_l1_reg_loss: 790.6888; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245419.9053; val_optim_loss: 245419.9053
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9780; val_auprc_score: 0.9856; val_best_acc_score: 0.9455; val_best_f1_score: 0.9596; train_kl_reg_loss: 2438.3484; train_edge_recon_loss: 176445.7886; train_gene_expr_recon_loss: 61189.0881; train_masked_gp_l1_reg_loss: 791.0312; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240864.2556; train_optim_loss: 240864.2556; val_kl_reg_loss: 2344.9104; val_edge_recon_loss: 181113.7840; val_gene_expr_recon_loss: 61090.2171; val_masked_gp_l1_reg_loss: 791.6301; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245340.5358; val_optim_loss: 245340.5358
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9786; val_auprc_score: 0.9857; val_best_acc_score: 0.9462; val_best_f1_score: 0.9601; train_kl_reg_loss: 2442.6972; train_edge_recon_loss: 176267.3208; train_gene_expr_recon_loss: 61177.4286; train_masked_gp_l1_reg_loss: 791.6509; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240679.0973; train_optim_loss: 240679.0973; val_kl_reg_loss: 2332.2308; val_edge_recon_loss: 179900.6654; val_gene_expr_recon_loss: 61057.7495; val_masked_gp_l1_reg_loss: 792.1371; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244082.7877; val_optim_loss: 244082.7877
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9779; val_auprc_score: 0.9855; val_best_acc_score: 0.9451; val_best_f1_score: 0.9593; train_kl_reg_loss: 2438.4370; train_edge_recon_loss: 176390.7934; train_gene_expr_recon_loss: 61139.2494; train_masked_gp_l1_reg_loss: 791.9807; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240760.4602; train_optim_loss: 240760.4602; val_kl_reg_loss: 2324.2685; val_edge_recon_loss: 181424.6691; val_gene_expr_recon_loss: 61103.5126; val_masked_gp_l1_reg_loss: 792.1411; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245644.5910; val_optim_loss: 245644.5910
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9785; val_auprc_score: 0.9855; val_best_acc_score: 0.9466; val_best_f1_score: 0.9604; train_kl_reg_loss: 2431.1965; train_edge_recon_loss: 176371.0815; train_gene_expr_recon_loss: 61163.4473; train_masked_gp_l1_reg_loss: 792.3040; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240758.0290; train_optim_loss: 240758.0290; val_kl_reg_loss: 2327.8080; val_edge_recon_loss: 179615.8557; val_gene_expr_recon_loss: 61029.1328; val_masked_gp_l1_reg_loss: 792.7019; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243765.5000; val_optim_loss: 243765.5000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9782; val_auprc_score: 0.9857; val_best_acc_score: 0.9452; val_best_f1_score: 0.9594; train_kl_reg_loss: 2433.4792; train_edge_recon_loss: 176284.0877; train_gene_expr_recon_loss: 61101.8421; train_masked_gp_l1_reg_loss: 792.7081; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240612.1171; train_optim_loss: 240612.1171; val_kl_reg_loss: 2325.9221; val_edge_recon_loss: 180261.0119; val_gene_expr_recon_loss: 61062.0538; val_masked_gp_l1_reg_loss: 792.9839; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244441.9706; val_optim_loss: 244441.9706
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9785; val_auprc_score: 0.9861; val_best_acc_score: 0.9455; val_best_f1_score: 0.9595; train_kl_reg_loss: 2431.9202; train_edge_recon_loss: 176440.6617; train_gene_expr_recon_loss: 61156.1545; train_masked_gp_l1_reg_loss: 793.0992; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240821.8347; train_optim_loss: 240821.8347; val_kl_reg_loss: 2329.1012; val_edge_recon_loss: 180561.7638; val_gene_expr_recon_loss: 61034.3008; val_masked_gp_l1_reg_loss: 793.3627; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244718.5230; val_optim_loss: 244718.5230
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9779; val_auprc_score: 0.9855; val_best_acc_score: 0.9449; val_best_f1_score: 0.9591; train_kl_reg_loss: 2430.3583; train_edge_recon_loss: 176508.5985; train_gene_expr_recon_loss: 61121.2881; train_masked_gp_l1_reg_loss: 793.3806; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240853.6247; train_optim_loss: 240853.6247; val_kl_reg_loss: 2328.8844; val_edge_recon_loss: 181014.1471; val_gene_expr_recon_loss: 61027.0531; val_masked_gp_l1_reg_loss: 793.6619; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245163.7408; val_optim_loss: 245163.7408

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9770; val_auprc_score: 0.9849; val_best_acc_score: 0.9439; val_best_f1_score: 0.9583; train_kl_reg_loss: 2428.4837; train_edge_recon_loss: 176339.2832; train_gene_expr_recon_loss: 61121.7493; train_masked_gp_l1_reg_loss: 791.2821; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240680.7972; train_optim_loss: 240680.7972; val_kl_reg_loss: 2330.7603; val_edge_recon_loss: 182047.6590; val_gene_expr_recon_loss: 60999.6432; val_masked_gp_l1_reg_loss: 790.8786; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246168.9384; val_optim_loss: 246168.9384
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9785; val_auprc_score: 0.9861; val_best_acc_score: 0.9458; val_best_f1_score: 0.9598; train_kl_reg_loss: 2427.0016; train_edge_recon_loss: 176656.1124; train_gene_expr_recon_loss: 61126.4267; train_masked_gp_l1_reg_loss: 790.8198; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241000.3593; train_optim_loss: 241000.3593; val_kl_reg_loss: 2327.9584; val_edge_recon_loss: 180652.5956; val_gene_expr_recon_loss: 61067.8274; val_masked_gp_l1_reg_loss: 790.8247; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244839.2105; val_optim_loss: 244839.2105
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9784; val_auprc_score: 0.9859; val_best_acc_score: 0.9459; val_best_f1_score: 0.9599; train_kl_reg_loss: 2426.0105; train_edge_recon_loss: 176504.8395; train_gene_expr_recon_loss: 61115.6026; train_masked_gp_l1_reg_loss: 790.8205; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240837.2736; train_optim_loss: 240837.2736; val_kl_reg_loss: 2329.9011; val_edge_recon_loss: 180039.2197; val_gene_expr_recon_loss: 61078.0855; val_masked_gp_l1_reg_loss: 790.8281; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244238.0349; val_optim_loss: 244238.0349

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 89 min 4 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9776
Val AUPRC score: 0.9853
Val best accuracy score: 0.9454
Val best F1 score: 0.9595
Val gene expr MSE score: 1.3521

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
