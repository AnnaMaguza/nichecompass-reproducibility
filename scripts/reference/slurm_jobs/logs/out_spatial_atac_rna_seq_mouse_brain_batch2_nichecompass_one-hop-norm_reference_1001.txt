[True]
Run timestamp: 10082023_132614_1001.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1001']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7638; val_auprc_score: 0.7811; val_best_acc_score: 0.5119; val_best_f1_score: 0.6716; train_kl_reg_loss: 94340.0425; train_edge_recon_loss: 3572656.4962; train_gene_expr_recon_loss: 14487919.8244; train_masked_gp_l1_reg_loss: 75737.3767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235477.7380; train_chrom_access_recon_loss: 735753.3383; train_global_loss: 19201884.7939; train_optim_loss: 19201884.7939; val_kl_reg_loss: 121367.5995; val_edge_recon_loss: 4064321.3000; val_gene_expr_recon_loss: 12917972.2000; val_masked_gp_l1_reg_loss: 70205.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 217724.9531; val_chrom_access_recon_loss: 696254.0292; val_global_loss: 18087844.9333; val_optim_loss: 18087844.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8344; val_auprc_score: 0.8394; val_best_acc_score: 0.7482; val_best_f1_score: 0.7687; train_kl_reg_loss: 120972.1524; train_edge_recon_loss: 3534215.6260; train_gene_expr_recon_loss: 12645257.2519; train_masked_gp_l1_reg_loss: 68673.1451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 198284.9141; train_chrom_access_recon_loss: 689047.0615; train_global_loss: 17256450.2672; train_optim_loss: 17256450.2672; val_kl_reg_loss: 103223.5932; val_edge_recon_loss: 4020929.0333; val_gene_expr_recon_loss: 12602211.0000; val_masked_gp_l1_reg_loss: 69611.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179231.6094; val_chrom_access_recon_loss: 685500.2417; val_global_loss: 17660707.8667; val_optim_loss: 17660707.8667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8465; val_auprc_score: 0.8454; val_best_acc_score: 0.7548; val_best_f1_score: 0.7693; train_kl_reg_loss: 100596.9249; train_edge_recon_loss: 3384755.4447; train_gene_expr_recon_loss: 12443007.4885; train_masked_gp_l1_reg_loss: 72484.7137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162511.4810; train_chrom_access_recon_loss: 680704.8521; train_global_loss: 16844060.9618; train_optim_loss: 16844060.9618; val_kl_reg_loss: 132845.0083; val_edge_recon_loss: 3163683.6500; val_gene_expr_recon_loss: 12469725.7333; val_masked_gp_l1_reg_loss: 77037.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146711.3281; val_chrom_access_recon_loss: 681172.8208; val_global_loss: 16671176.0667; val_optim_loss: 16671176.0667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8817; val_auprc_score: 0.8668; val_best_acc_score: 0.7749; val_best_f1_score: 0.7995; train_kl_reg_loss: 128259.1734; train_edge_recon_loss: 2992874.2252; train_gene_expr_recon_loss: 12295995.7557; train_masked_gp_l1_reg_loss: 79311.4005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133677.6652; train_chrom_access_recon_loss: 672851.3287; train_global_loss: 16302969.6183; train_optim_loss: 16302969.6183; val_kl_reg_loss: 124138.3125; val_edge_recon_loss: 2957819.8333; val_gene_expr_recon_loss: 12272749.2667; val_masked_gp_l1_reg_loss: 81321.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121593.8750; val_chrom_access_recon_loss: 670548.7333; val_global_loss: 16228171.9333; val_optim_loss: 16228171.9333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9053; val_auprc_score: 0.8925; val_best_acc_score: 0.8215; val_best_f1_score: 0.8301; train_kl_reg_loss: 118801.7513; train_edge_recon_loss: 2931241.9714; train_gene_expr_recon_loss: 12147289.6641; train_masked_gp_l1_reg_loss: 82880.6301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111746.0966; train_chrom_access_recon_loss: 667179.3860; train_global_loss: 16059139.5802; train_optim_loss: 16059139.5802; val_kl_reg_loss: 111398.1807; val_edge_recon_loss: 2928724.5833; val_gene_expr_recon_loss: 12135154.0000; val_masked_gp_l1_reg_loss: 84729.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102892.9297; val_chrom_access_recon_loss: 663534.4292; val_global_loss: 16026433.4667; val_optim_loss: 16026433.4667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9215; val_auprc_score: 0.9037; val_best_acc_score: 0.8565; val_best_f1_score: 0.8643; train_kl_reg_loss: 111129.6905; train_edge_recon_loss: 2885690.8702; train_gene_expr_recon_loss: 12033992.0840; train_masked_gp_l1_reg_loss: 86458.2817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95850.2973; train_chrom_access_recon_loss: 661205.1403; train_global_loss: 15874326.3664; train_optim_loss: 15874326.3664; val_kl_reg_loss: 111204.4312; val_edge_recon_loss: 2862331.0500; val_gene_expr_recon_loss: 12017341.6667; val_masked_gp_l1_reg_loss: 88091.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89348.1406; val_chrom_access_recon_loss: 656205.7375; val_global_loss: 15824522.0000; val_optim_loss: 15824522.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9277; val_auprc_score: 0.9122; val_best_acc_score: 0.8581; val_best_f1_score: 0.8671; train_kl_reg_loss: 114952.4916; train_edge_recon_loss: 2835296.8702; train_gene_expr_recon_loss: 11932040.1832; train_masked_gp_l1_reg_loss: 89602.2612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83698.4425; train_chrom_access_recon_loss: 656199.2944; train_global_loss: 15711789.5191; train_optim_loss: 15711789.5191; val_kl_reg_loss: 115246.3016; val_edge_recon_loss: 2838900.3167; val_gene_expr_recon_loss: 11950161.2000; val_masked_gp_l1_reg_loss: 90903.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78261.1641; val_chrom_access_recon_loss: 653153.4500; val_global_loss: 15726626.3333; val_optim_loss: 15726626.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9358; val_auprc_score: 0.9215; val_best_acc_score: 0.8732; val_best_f1_score: 0.8786; train_kl_reg_loss: 111489.9246; train_edge_recon_loss: 2820133.8740; train_gene_expr_recon_loss: 11837165.2061; train_masked_gp_l1_reg_loss: 92159.2072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73490.5212; train_chrom_access_recon_loss: 650725.9041; train_global_loss: 15585164.5573; train_optim_loss: 15585164.5573; val_kl_reg_loss: 114190.9109; val_edge_recon_loss: 2818904.0667; val_gene_expr_recon_loss: 11838536.0667; val_masked_gp_l1_reg_loss: 93460.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68933.8047; val_chrom_access_recon_loss: 649891.8000; val_global_loss: 15583917.0000; val_optim_loss: 15583917.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9316; val_auprc_score: 0.9139; val_best_acc_score: 0.8700; val_best_f1_score: 0.8777; train_kl_reg_loss: 107630.0083; train_edge_recon_loss: 2802307.9847; train_gene_expr_recon_loss: 11768048.9618; train_masked_gp_l1_reg_loss: 94596.1583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65091.2523; train_chrom_access_recon_loss: 646948.7719; train_global_loss: 15484623.2137; train_optim_loss: 15484623.2137; val_kl_reg_loss: 103825.2302; val_edge_recon_loss: 2838606.4833; val_gene_expr_recon_loss: 11799934.6667; val_masked_gp_l1_reg_loss: 95887.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61441.1992; val_chrom_access_recon_loss: 644944.4625; val_global_loss: 15544639.8667; val_optim_loss: 15544639.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9415; val_auprc_score: 0.9288; val_best_acc_score: 0.8783; val_best_f1_score: 0.8816; train_kl_reg_loss: 105436.0478; train_edge_recon_loss: 2790394.8607; train_gene_expr_recon_loss: 11696997.6870; train_masked_gp_l1_reg_loss: 96761.9715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58172.0182; train_chrom_access_recon_loss: 642950.0052; train_global_loss: 15390712.6183; train_optim_loss: 15390712.6183; val_kl_reg_loss: 105755.1146; val_edge_recon_loss: 2791534.3667; val_gene_expr_recon_loss: 11663833.9333; val_masked_gp_l1_reg_loss: 97707.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55226.7695; val_chrom_access_recon_loss: 636989.9833; val_global_loss: 15351048.4667; val_optim_loss: 15351048.4667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9429; val_auprc_score: 0.9304; val_best_acc_score: 0.8813; val_best_f1_score: 0.8850; train_kl_reg_loss: 104180.7139; train_edge_recon_loss: 2780333.6660; train_gene_expr_recon_loss: 11626071.7786; train_masked_gp_l1_reg_loss: 98626.9581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52597.2372; train_chrom_access_recon_loss: 638644.5339; train_global_loss: 15300454.9771; train_optim_loss: 15300454.9771; val_kl_reg_loss: 104800.1260; val_edge_recon_loss: 2773730.5500; val_gene_expr_recon_loss: 11641964.8667; val_masked_gp_l1_reg_loss: 99815.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50328.7891; val_chrom_access_recon_loss: 636397.0958; val_global_loss: 15307037.6000; val_optim_loss: 15307037.6000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9457; val_auprc_score: 0.9337; val_best_acc_score: 0.8817; val_best_f1_score: 0.8871; train_kl_reg_loss: 102546.2781; train_edge_recon_loss: 2761498.1145; train_gene_expr_recon_loss: 11574249.6565; train_masked_gp_l1_reg_loss: 100499.8652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48189.1548; train_chrom_access_recon_loss: 636121.3554; train_global_loss: 15223104.3740; train_optim_loss: 15223104.3740; val_kl_reg_loss: 100918.3073; val_edge_recon_loss: 2772261.5333; val_gene_expr_recon_loss: 11582300.5333; val_masked_gp_l1_reg_loss: 101394.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46279.2773; val_chrom_access_recon_loss: 633367.6833; val_global_loss: 15236522.0000; val_optim_loss: 15236522.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9423; val_auprc_score: 0.9281; val_best_acc_score: 0.8833; val_best_f1_score: 0.8867; train_kl_reg_loss: 98580.5156; train_edge_recon_loss: 2757672.6966; train_gene_expr_recon_loss: 11525511.9847; train_masked_gp_l1_reg_loss: 102233.7721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44555.6914; train_chrom_access_recon_loss: 633217.5611; train_global_loss: 15161772.1908; train_optim_loss: 15161772.1908; val_kl_reg_loss: 100134.8969; val_edge_recon_loss: 2791031.3667; val_gene_expr_recon_loss: 11608433.7333; val_masked_gp_l1_reg_loss: 103190.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42934.3711; val_chrom_access_recon_loss: 633152.9458; val_global_loss: 15278877.8667; val_optim_loss: 15278877.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9482; val_auprc_score: 0.9324; val_best_acc_score: 0.8894; val_best_f1_score: 0.8942; train_kl_reg_loss: 96487.6060; train_edge_recon_loss: 2753773.3531; train_gene_expr_recon_loss: 11467553.9618; train_masked_gp_l1_reg_loss: 103977.4822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41373.8975; train_chrom_access_recon_loss: 630034.1980; train_global_loss: 15093200.4809; train_optim_loss: 15093200.4809; val_kl_reg_loss: 97969.6854; val_edge_recon_loss: 2751837.4167; val_gene_expr_recon_loss: 11482208.6667; val_masked_gp_l1_reg_loss: 104778.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39926.6953; val_chrom_access_recon_loss: 629932.1792; val_global_loss: 15106654.0667; val_optim_loss: 15106654.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9525; val_auprc_score: 0.9408; val_best_acc_score: 0.8934; val_best_f1_score: 0.8970; train_kl_reg_loss: 96428.8272; train_edge_recon_loss: 2739477.7500; train_gene_expr_recon_loss: 11436608.6412; train_masked_gp_l1_reg_loss: 105517.7302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38643.5083; train_chrom_access_recon_loss: 628532.8497; train_global_loss: 15045209.2443; train_optim_loss: 15045209.2443; val_kl_reg_loss: 96353.8479; val_edge_recon_loss: 2763232.0167; val_gene_expr_recon_loss: 11453457.7333; val_masked_gp_l1_reg_loss: 106333.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37518.2812; val_chrom_access_recon_loss: 627296.0250; val_global_loss: 15084190.8000; val_optim_loss: 15084190.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9522; val_auprc_score: 0.9400; val_best_acc_score: 0.8897; val_best_f1_score: 0.8945; train_kl_reg_loss: 93649.6389; train_edge_recon_loss: 2740227.9332; train_gene_expr_recon_loss: 11389658.7023; train_masked_gp_l1_reg_loss: 107116.0146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36453.4467; train_chrom_access_recon_loss: 625632.1474; train_global_loss: 14992737.8473; train_optim_loss: 14992737.8473; val_kl_reg_loss: 94215.3609; val_edge_recon_loss: 2746269.4500; val_gene_expr_recon_loss: 11436584.4667; val_masked_gp_l1_reg_loss: 108042.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35382.7148; val_chrom_access_recon_loss: 626243.4083; val_global_loss: 15046737.6000; val_optim_loss: 15046737.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9583; val_auprc_score: 0.9448; val_best_acc_score: 0.9011; val_best_f1_score: 0.9038; train_kl_reg_loss: 93197.9124; train_edge_recon_loss: 2723049.4447; train_gene_expr_recon_loss: 11353339.5878; train_masked_gp_l1_reg_loss: 108625.9329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34411.1377; train_chrom_access_recon_loss: 624082.0286; train_global_loss: 14936706.0840; train_optim_loss: 14936706.0840; val_kl_reg_loss: 89834.0865; val_edge_recon_loss: 2723854.4167; val_gene_expr_recon_loss: 11403513.9333; val_masked_gp_l1_reg_loss: 109361.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33552.2578; val_chrom_access_recon_loss: 623179.3000; val_global_loss: 14983294.6667; val_optim_loss: 14983294.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9646; val_auprc_score: 0.9545; val_best_acc_score: 0.9072; val_best_f1_score: 0.9104; train_kl_reg_loss: 92336.7753; train_edge_recon_loss: 2723566.2805; train_gene_expr_recon_loss: 11328328.7786; train_masked_gp_l1_reg_loss: 109937.7651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32673.7116; train_chrom_access_recon_loss: 622428.7052; train_global_loss: 14909272.0763; train_optim_loss: 14909272.0763; val_kl_reg_loss: 91876.3474; val_edge_recon_loss: 2734923.0000; val_gene_expr_recon_loss: 11381446.5333; val_masked_gp_l1_reg_loss: 110525.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31928.4355; val_chrom_access_recon_loss: 621281.6792; val_global_loss: 14971980.6000; val_optim_loss: 14971980.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9630; val_auprc_score: 0.9545; val_best_acc_score: 0.9051; val_best_f1_score: 0.9092; train_kl_reg_loss: 91868.2462; train_edge_recon_loss: 2716701.6336; train_gene_expr_recon_loss: 11302333.0611; train_masked_gp_l1_reg_loss: 111246.9854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31192.6935; train_chrom_access_recon_loss: 620706.2476; train_global_loss: 14874048.8244; train_optim_loss: 14874048.8244; val_kl_reg_loss: 89563.9937; val_edge_recon_loss: 2725995.0500; val_gene_expr_recon_loss: 11326977.6667; val_masked_gp_l1_reg_loss: 111886.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30495.5996; val_chrom_access_recon_loss: 619549.8583; val_global_loss: 14904469.5333; val_optim_loss: 14904469.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9655; val_auprc_score: 0.9574; val_best_acc_score: 0.9093; val_best_f1_score: 0.9115; train_kl_reg_loss: 90680.0928; train_edge_recon_loss: 2709158.3282; train_gene_expr_recon_loss: 11264369.8321; train_masked_gp_l1_reg_loss: 112439.7556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29883.2589; train_chrom_access_recon_loss: 619139.9513; train_global_loss: 14825671.2290; train_optim_loss: 14825671.2290; val_kl_reg_loss: 89151.2703; val_edge_recon_loss: 2719576.3333; val_gene_expr_recon_loss: 11307021.0000; val_masked_gp_l1_reg_loss: 113073.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29329.1445; val_chrom_access_recon_loss: 619331.0875; val_global_loss: 14877481.6000; val_optim_loss: 14877481.6000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9644; val_auprc_score: 0.9561; val_best_acc_score: 0.9088; val_best_f1_score: 0.9126; train_kl_reg_loss: 89726.8228; train_edge_recon_loss: 2708985.1088; train_gene_expr_recon_loss: 11239121.0534; train_masked_gp_l1_reg_loss: 113554.9491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28762.3888; train_chrom_access_recon_loss: 617851.1369; train_global_loss: 14798001.4046; train_optim_loss: 14798001.4046; val_kl_reg_loss: 89867.6703; val_edge_recon_loss: 2725228.4333; val_gene_expr_recon_loss: 11263129.0667; val_masked_gp_l1_reg_loss: 113938.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28147.2227; val_chrom_access_recon_loss: 617536.6250; val_global_loss: 14837846.8667; val_optim_loss: 14837846.8667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9677; val_auprc_score: 0.9599; val_best_acc_score: 0.9126; val_best_f1_score: 0.9151; train_kl_reg_loss: 87800.6526; train_edge_recon_loss: 2712821.0019; train_gene_expr_recon_loss: 11206262.2824; train_masked_gp_l1_reg_loss: 114567.3169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27733.6119; train_chrom_access_recon_loss: 616304.0868; train_global_loss: 14765489.0076; train_optim_loss: 14765489.0076; val_kl_reg_loss: 86968.1625; val_edge_recon_loss: 2721057.9333; val_gene_expr_recon_loss: 11276186.2000; val_masked_gp_l1_reg_loss: 115105.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27257.4883; val_chrom_access_recon_loss: 618190.8625; val_global_loss: 14844765.0667; val_optim_loss: 14844765.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9670; val_auprc_score: 0.9592; val_best_acc_score: 0.9162; val_best_f1_score: 0.9187; train_kl_reg_loss: 88182.1668; train_edge_recon_loss: 2700753.7557; train_gene_expr_recon_loss: 11193630.3664; train_masked_gp_l1_reg_loss: 115729.3555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26827.2223; train_chrom_access_recon_loss: 615637.3464; train_global_loss: 14740760.0916; train_optim_loss: 14740760.0916; val_kl_reg_loss: 86853.8307; val_edge_recon_loss: 2728218.1500; val_gene_expr_recon_loss: 11234003.8667; val_masked_gp_l1_reg_loss: 116370.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26459.4688; val_chrom_access_recon_loss: 614661.9833; val_global_loss: 14806568.0000; val_optim_loss: 14806568.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9683; val_auprc_score: 0.9586; val_best_acc_score: 0.9161; val_best_f1_score: 0.9184; train_kl_reg_loss: 87280.6045; train_edge_recon_loss: 2705083.2939; train_gene_expr_recon_loss: 11176563.1374; train_masked_gp_l1_reg_loss: 116763.5694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26055.4336; train_chrom_access_recon_loss: 615132.7013; train_global_loss: 14726878.6947; train_optim_loss: 14726878.6947; val_kl_reg_loss: 86342.7167; val_edge_recon_loss: 2716451.6333; val_gene_expr_recon_loss: 11231733.6000; val_masked_gp_l1_reg_loss: 117285.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25710.4062; val_chrom_access_recon_loss: 614330.5292; val_global_loss: 14791854.6000; val_optim_loss: 14791854.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9712; val_auprc_score: 0.9621; val_best_acc_score: 0.9184; val_best_f1_score: 0.9211; train_kl_reg_loss: 86856.7501; train_edge_recon_loss: 2701371.5763; train_gene_expr_recon_loss: 11155882.0000; train_masked_gp_l1_reg_loss: 117699.8441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25374.8559; train_chrom_access_recon_loss: 613694.2929; train_global_loss: 14700879.2214; train_optim_loss: 14700879.2214; val_kl_reg_loss: 86848.6333; val_edge_recon_loss: 2706108.4333; val_gene_expr_recon_loss: 11220513.8667; val_masked_gp_l1_reg_loss: 118166.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25097.0508; val_chrom_access_recon_loss: 612445.9333; val_global_loss: 14769180.0667; val_optim_loss: 14769180.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9690; val_auprc_score: 0.9578; val_best_acc_score: 0.9166; val_best_f1_score: 0.9185; train_kl_reg_loss: 102066.9150; train_edge_recon_loss: 2744110.5954; train_gene_expr_recon_loss: 11481654.3130; train_masked_gp_l1_reg_loss: 117730.6411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23314.4860; train_chrom_access_recon_loss: 631149.2996; train_global_loss: 15100026.3206; train_optim_loss: 15100026.3206; val_kl_reg_loss: 38207.3544; val_edge_recon_loss: 2742343.0333; val_gene_expr_recon_loss: 11511751.4000; val_masked_gp_l1_reg_loss: 118369.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22708.4082; val_chrom_access_recon_loss: 630928.0042; val_global_loss: 15064307.8000; val_optim_loss: 15064307.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9701; val_auprc_score: 0.9627; val_best_acc_score: 0.9189; val_best_f1_score: 0.9209; train_kl_reg_loss: 89711.6160; train_edge_recon_loss: 2724587.5115; train_gene_expr_recon_loss: 11505026.9847; train_masked_gp_l1_reg_loss: 119006.9869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22529.1009; train_chrom_access_recon_loss: 630206.7433; train_global_loss: 15091068.8855; train_optim_loss: 15091068.8855; val_kl_reg_loss: 38256.8758; val_edge_recon_loss: 2727041.7833; val_gene_expr_recon_loss: 11653835.4667; val_masked_gp_l1_reg_loss: 119539.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22438.8438; val_chrom_access_recon_loss: 638200.0000; val_global_loss: 15199313.0000; val_optim_loss: 15199313.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9683; val_auprc_score: 0.9589; val_best_acc_score: 0.9150; val_best_f1_score: 0.9180; train_kl_reg_loss: 81111.0321; train_edge_recon_loss: 2716565.9218; train_gene_expr_recon_loss: 11540879.0000; train_masked_gp_l1_reg_loss: 119677.3532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22325.4417; train_chrom_access_recon_loss: 630208.9008; train_global_loss: 15110767.6565; train_optim_loss: 15110767.6565; val_kl_reg_loss: 39813.6083; val_edge_recon_loss: 2724713.9167; val_gene_expr_recon_loss: 11626422.4667; val_masked_gp_l1_reg_loss: 119623.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22193.0703; val_chrom_access_recon_loss: 629098.9750; val_global_loss: 15161865.0000; val_optim_loss: 15161865.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9678; val_auprc_score: 0.9591; val_best_acc_score: 0.9140; val_best_f1_score: 0.9161; train_kl_reg_loss: 75604.8521; train_edge_recon_loss: 2709976.3378; train_gene_expr_recon_loss: 11589680.5802; train_masked_gp_l1_reg_loss: 119389.8352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21809.7805; train_chrom_access_recon_loss: 629418.4127; train_global_loss: 15145879.6794; train_optim_loss: 15145879.6794; val_kl_reg_loss: 35155.0732; val_edge_recon_loss: 2731861.2833; val_gene_expr_recon_loss: 11775919.9333; val_masked_gp_l1_reg_loss: 119496.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21421.1465; val_chrom_access_recon_loss: 630228.1583; val_global_loss: 15314081.4000; val_optim_loss: 15314081.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9678; val_auprc_score: 0.9616; val_best_acc_score: 0.9112; val_best_f1_score: 0.9133; train_kl_reg_loss: 77483.6440; train_edge_recon_loss: 2717680.0401; train_gene_expr_recon_loss: 11688589.7099; train_masked_gp_l1_reg_loss: 119072.2079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21297.2204; train_chrom_access_recon_loss: 631495.4237; train_global_loss: 15255618.3359; train_optim_loss: 15255618.3359; val_kl_reg_loss: 34359.0396; val_edge_recon_loss: 2730377.8333; val_gene_expr_recon_loss: 11765421.9333; val_masked_gp_l1_reg_loss: 118992.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21237.1133; val_chrom_access_recon_loss: 633011.7208; val_global_loss: 15303399.6000; val_optim_loss: 15303399.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9645; val_auprc_score: 0.9510; val_best_acc_score: 0.9126; val_best_f1_score: 0.9149; train_kl_reg_loss: 77568.6052; train_edge_recon_loss: 2712044.1221; train_gene_expr_recon_loss: 11682657.0000; train_masked_gp_l1_reg_loss: 118950.1422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21205.1263; train_chrom_access_recon_loss: 630886.6684; train_global_loss: 15243311.6412; train_optim_loss: 15243311.6412; val_kl_reg_loss: 35180.4010; val_edge_recon_loss: 2728880.2667; val_gene_expr_recon_loss: 11755038.4667; val_masked_gp_l1_reg_loss: 118908.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21173.7617; val_chrom_access_recon_loss: 631404.1583; val_global_loss: 15290585.3333; val_optim_loss: 15290585.3333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9702; val_auprc_score: 0.9628; val_best_acc_score: 0.9144; val_best_f1_score: 0.9159; train_kl_reg_loss: 77722.6366; train_edge_recon_loss: 2712763.1412; train_gene_expr_recon_loss: 11674288.2137; train_masked_gp_l1_reg_loss: 118863.5537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21144.4700; train_chrom_access_recon_loss: 630602.7443; train_global_loss: 15235384.7023; train_optim_loss: 15235384.7023; val_kl_reg_loss: 34291.8401; val_edge_recon_loss: 2720232.3167; val_gene_expr_recon_loss: 11798732.2667; val_masked_gp_l1_reg_loss: 118816.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21110.7949; val_chrom_access_recon_loss: 633314.9375; val_global_loss: 15326499.2000; val_optim_loss: 15326499.2000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9655; val_auprc_score: 0.9557; val_best_acc_score: 0.9095; val_best_f1_score: 0.9122; train_kl_reg_loss: 77832.7141; train_edge_recon_loss: 2715028.2996; train_gene_expr_recon_loss: 11680818.6107; train_masked_gp_l1_reg_loss: 118785.2276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21083.8250; train_chrom_access_recon_loss: 631085.8836; train_global_loss: 15244634.5878; train_optim_loss: 15244634.5878; val_kl_reg_loss: 33708.3318; val_edge_recon_loss: 2725354.1667; val_gene_expr_recon_loss: 11767088.6667; val_masked_gp_l1_reg_loss: 118740.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21052.4316; val_chrom_access_recon_loss: 633254.8125; val_global_loss: 15299198.0667; val_optim_loss: 15299198.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 5 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9700
val AUPRC score: 0.9602
val best accuracy score: 0.9174
val best F1 score: 0.9203
val target rna MSE score: 3.4647
val source rna MSE score: 7.4496
val target atac MSE score: 0.5654
val source atac MSE score: 0.1669
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
