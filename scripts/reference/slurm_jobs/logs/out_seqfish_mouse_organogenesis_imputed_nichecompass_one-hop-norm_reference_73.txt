[True]
Run timestamp: 01082023_092051_73.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_73']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9229; val_auprc_score: 0.9851; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 88745.7422; train_edge_recon_loss: 1060500.0162; train_gene_expr_recon_loss: 569197.2176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58255.8541; train_global_loss: 1776698.8218; train_optim_loss: 1776698.8218; val_kl_reg_loss: 59357.3913; val_edge_recon_loss: 1218369.7083; val_gene_expr_recon_loss: 470127.9323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52945.4336; val_global_loss: 1800800.3542; val_optim_loss: 1800800.3542
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9163; val_auprc_score: 0.9822; val_best_acc_score: 0.8497; val_best_f1_score: 0.9187; train_kl_reg_loss: 83472.7673; train_edge_recon_loss: 1058721.0046; train_gene_expr_recon_loss: 467548.3299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48663.1696; train_global_loss: 1658405.2685; train_optim_loss: 1658405.2685; val_kl_reg_loss: 81189.2318; val_edge_recon_loss: 1222125.2500; val_gene_expr_recon_loss: 349901.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44614.5781; val_global_loss: 1697830.2292; val_optim_loss: 1697830.2292
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9157; val_auprc_score: 0.9841; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 48744.8615; train_edge_recon_loss: 1051105.3044; train_gene_expr_recon_loss: 322874.8623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41117.2619; train_global_loss: 1463842.3079; train_optim_loss: 1463842.3079; val_kl_reg_loss: 30500.8652; val_edge_recon_loss: 1189507.7292; val_gene_expr_recon_loss: 272436.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37590.1797; val_global_loss: 1530035.6458; val_optim_loss: 1530035.6458
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9069; val_auprc_score: 0.9822; val_best_acc_score: 0.8583; val_best_f1_score: 0.9234; train_kl_reg_loss: 26552.2018; train_edge_recon_loss: 1041798.1227; train_gene_expr_recon_loss: 269970.4039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34483.9917; train_global_loss: 1372804.7245; train_optim_loss: 1372804.7245; val_kl_reg_loss: 19611.9193; val_edge_recon_loss: 1184507.2292; val_gene_expr_recon_loss: 258641.6771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31479.0781; val_global_loss: 1494239.9375; val_optim_loss: 1494239.9375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9013; val_auprc_score: 0.9799; val_best_acc_score: 0.8561; val_best_f1_score: 0.9216; train_kl_reg_loss: 18782.8049; train_edge_recon_loss: 1041963.6898; train_gene_expr_recon_loss: 256309.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29071.0389; train_global_loss: 1346127.4491; train_optim_loss: 1346127.4491; val_kl_reg_loss: 17611.0771; val_edge_recon_loss: 1243092.2500; val_gene_expr_recon_loss: 251068.2682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26834.4941; val_global_loss: 1538606.1042; val_optim_loss: 1538606.1042
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8957; val_auprc_score: 0.9797; val_best_acc_score: 0.8685; val_best_f1_score: 0.9281; train_kl_reg_loss: 15647.3353; train_edge_recon_loss: 1032710.6343; train_gene_expr_recon_loss: 249812.1157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25218.1383; train_global_loss: 1323388.2245; train_optim_loss: 1323388.2245; val_kl_reg_loss: 14010.3291; val_edge_recon_loss: 1193097.1042; val_gene_expr_recon_loss: 245620.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23818.0938; val_global_loss: 1476546.3542; val_optim_loss: 1476546.3542
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8948; val_auprc_score: 0.9802; val_best_acc_score: 0.8779; val_best_f1_score: 0.9326; train_kl_reg_loss: 13206.3566; train_edge_recon_loss: 1031884.6863; train_gene_expr_recon_loss: 244665.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22689.9505; train_global_loss: 1312446.6644; train_optim_loss: 1312446.6644; val_kl_reg_loss: 13016.2575; val_edge_recon_loss: 1188421.7292; val_gene_expr_recon_loss: 241481.0964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21560.0371; val_global_loss: 1464479.0833; val_optim_loss: 1464479.0833
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8784; val_auprc_score: 0.9761; val_best_acc_score: 0.8770; val_best_f1_score: 0.9300; train_kl_reg_loss: 11646.6384; train_edge_recon_loss: 1028235.3970; train_gene_expr_recon_loss: 239985.7425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20542.9907; train_global_loss: 1300410.7662; train_optim_loss: 1300410.7662; val_kl_reg_loss: 9640.6605; val_edge_recon_loss: 1177927.9583; val_gene_expr_recon_loss: 236857.7943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19527.6836; val_global_loss: 1443954.0417; val_optim_loss: 1443954.0417
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8589; val_auprc_score: 0.9708; val_best_acc_score: 0.8894; val_best_f1_score: 0.9389; train_kl_reg_loss: 9792.1844; train_edge_recon_loss: 1022424.1088; train_gene_expr_recon_loss: 236316.5637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18635.0118; train_global_loss: 1287167.8704; train_optim_loss: 1287167.8704; val_kl_reg_loss: 7668.9152; val_edge_recon_loss: 1101093.1979; val_gene_expr_recon_loss: 235057.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17753.4980; val_global_loss: 1361573.2917; val_optim_loss: 1361573.2917
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8390; val_auprc_score: 0.9639; val_best_acc_score: 0.8885; val_best_f1_score: 0.9377; train_kl_reg_loss: 7684.2572; train_edge_recon_loss: 940253.9294; train_gene_expr_recon_loss: 243250.8721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17159.9776; train_global_loss: 1208349.0463; train_optim_loss: 1208349.0463; val_kl_reg_loss: 12278.0521; val_edge_recon_loss: 888207.1250; val_gene_expr_recon_loss: 240597.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16720.4043; val_global_loss: 1157802.8125; val_optim_loss: 1157802.8125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8441; val_auprc_score: 0.9660; val_best_acc_score: 0.8950; val_best_f1_score: 0.9415; train_kl_reg_loss: 14107.0049; train_edge_recon_loss: 876275.8692; train_gene_expr_recon_loss: 236742.5810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16161.3925; train_global_loss: 1143286.8507; train_optim_loss: 1143286.8507; val_kl_reg_loss: 12607.9393; val_edge_recon_loss: 878806.8333; val_gene_expr_recon_loss: 233527.8255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15568.9219; val_global_loss: 1140511.4792; val_optim_loss: 1140511.4792
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8458; val_auprc_score: 0.9659; val_best_acc_score: 0.9006; val_best_f1_score: 0.9445; train_kl_reg_loss: 14102.5210; train_edge_recon_loss: 869329.6250; train_gene_expr_recon_loss: 231212.8637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15028.6723; train_global_loss: 1129673.6644; train_optim_loss: 1129673.6644; val_kl_reg_loss: 12771.4303; val_edge_recon_loss: 878102.9583; val_gene_expr_recon_loss: 228065.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14480.6191; val_global_loss: 1133420.2708; val_optim_loss: 1133420.2708
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8490; val_auprc_score: 0.9672; val_best_acc_score: 0.9029; val_best_f1_score: 0.9456; train_kl_reg_loss: 12866.8995; train_edge_recon_loss: 863401.9815; train_gene_expr_recon_loss: 226869.2017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13975.8775; train_global_loss: 1117113.9630; train_optim_loss: 1117113.9630; val_kl_reg_loss: 11789.2785; val_edge_recon_loss: 872449.5000; val_gene_expr_recon_loss: 225690.8646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13478.5039; val_global_loss: 1123408.1667; val_optim_loss: 1123408.1667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8550; val_auprc_score: 0.9684; val_best_acc_score: 0.9080; val_best_f1_score: 0.9483; train_kl_reg_loss: 12450.4919; train_edge_recon_loss: 855874.7569; train_gene_expr_recon_loss: 223605.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13039.7923; train_global_loss: 1104970.2164; train_optim_loss: 1104970.2164; val_kl_reg_loss: 11783.4704; val_edge_recon_loss: 853740.2396; val_gene_expr_recon_loss: 221833.0052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12606.1309; val_global_loss: 1099962.8542; val_optim_loss: 1099962.8542
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8529; val_auprc_score: 0.9678; val_best_acc_score: 0.9070; val_best_f1_score: 0.9480; train_kl_reg_loss: 11619.7207; train_edge_recon_loss: 858739.1609; train_gene_expr_recon_loss: 220635.1100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12214.0531; train_global_loss: 1103208.0451; train_optim_loss: 1103208.0451; val_kl_reg_loss: 9841.0225; val_edge_recon_loss: 840704.1875; val_gene_expr_recon_loss: 218869.1510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11826.5430; val_global_loss: 1081240.8854; val_optim_loss: 1081240.8854
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8661; val_auprc_score: 0.9714; val_best_acc_score: 0.9039; val_best_f1_score: 0.9462; train_kl_reg_loss: 10521.8065; train_edge_recon_loss: 850170.2315; train_gene_expr_recon_loss: 218640.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11500.9410; train_global_loss: 1090833.1551; train_optim_loss: 1090833.1551; val_kl_reg_loss: 10525.7681; val_edge_recon_loss: 825653.9167; val_gene_expr_recon_loss: 217380.6146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11186.2754; val_global_loss: 1064746.5625; val_optim_loss: 1064746.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8846; val_auprc_score: 0.9748; val_best_acc_score: 0.9091; val_best_f1_score: 0.9486; train_kl_reg_loss: 10575.0999; train_edge_recon_loss: 830267.5764; train_gene_expr_recon_loss: 216405.3866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10927.8129; train_global_loss: 1068175.8681; train_optim_loss: 1068175.8681; val_kl_reg_loss: 11412.3250; val_edge_recon_loss: 818983.6042; val_gene_expr_recon_loss: 213687.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10671.2500; val_global_loss: 1054754.7917; val_optim_loss: 1054754.7917
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8912; val_auprc_score: 0.9755; val_best_acc_score: 0.9075; val_best_f1_score: 0.9474; train_kl_reg_loss: 11329.9435; train_edge_recon_loss: 818558.1690; train_gene_expr_recon_loss: 213269.1253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10415.9865; train_global_loss: 1053573.2315; train_optim_loss: 1053573.2315; val_kl_reg_loss: 11472.5088; val_edge_recon_loss: 841597.6042; val_gene_expr_recon_loss: 211710.9974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10158.9248; val_global_loss: 1074939.9792; val_optim_loss: 1074939.9792
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8956; val_auprc_score: 0.9766; val_best_acc_score: 0.9129; val_best_f1_score: 0.9506; train_kl_reg_loss: 10894.0770; train_edge_recon_loss: 815236.6076; train_gene_expr_recon_loss: 210890.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9918.1999; train_global_loss: 1046939.5220; train_optim_loss: 1046939.5220; val_kl_reg_loss: 9738.5926; val_edge_recon_loss: 818043.8958; val_gene_expr_recon_loss: 209242.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9682.3857; val_global_loss: 1046707.7917; val_optim_loss: 1046707.7917
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9120; val_auprc_score: 0.9800; val_best_acc_score: 0.9188; val_best_f1_score: 0.9533; train_kl_reg_loss: 10086.6932; train_edge_recon_loss: 810509.5081; train_gene_expr_recon_loss: 208844.9965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9472.2856; train_global_loss: 1038913.4826; train_optim_loss: 1038913.4826; val_kl_reg_loss: 8670.3963; val_edge_recon_loss: 817017.6562; val_gene_expr_recon_loss: 207904.1120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9260.5088; val_global_loss: 1042852.6875; val_optim_loss: 1042852.6875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9227; val_auprc_score: 0.9828; val_best_acc_score: 0.9254; val_best_f1_score: 0.9574; train_kl_reg_loss: 9526.7786; train_edge_recon_loss: 795481.2488; train_gene_expr_recon_loss: 207077.7503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9077.9472; train_global_loss: 1021163.7269; train_optim_loss: 1021163.7269; val_kl_reg_loss: 9951.1242; val_edge_recon_loss: 793094.2188; val_gene_expr_recon_loss: 205447.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8887.5039; val_global_loss: 1017380.6250; val_optim_loss: 1017380.6250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9331; val_auprc_score: 0.9850; val_best_acc_score: 0.9277; val_best_f1_score: 0.9586; train_kl_reg_loss: 10051.6093; train_edge_recon_loss: 799379.6574; train_gene_expr_recon_loss: 204909.9650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8692.2112; train_global_loss: 1023033.4398; train_optim_loss: 1023033.4398; val_kl_reg_loss: 9785.4875; val_edge_recon_loss: 807990.8750; val_gene_expr_recon_loss: 203804.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8494.2178; val_global_loss: 1030074.8958; val_optim_loss: 1030074.8958
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9324; val_auprc_score: 0.9854; val_best_acc_score: 0.9268; val_best_f1_score: 0.9579; train_kl_reg_loss: 9949.6702; train_edge_recon_loss: 797275.5440; train_gene_expr_recon_loss: 203139.1317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8295.0547; train_global_loss: 1018659.4074; train_optim_loss: 1018659.4074; val_kl_reg_loss: 9551.4303; val_edge_recon_loss: 810407.7188; val_gene_expr_recon_loss: 202000.0651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8084.2197; val_global_loss: 1030043.4688; val_optim_loss: 1030043.4688
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9331; val_auprc_score: 0.9846; val_best_acc_score: 0.9290; val_best_f1_score: 0.9590; train_kl_reg_loss: 9644.7256; train_edge_recon_loss: 797462.4977; train_gene_expr_recon_loss: 201441.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7870.6927; train_global_loss: 1016419.3264; train_optim_loss: 1016419.3264; val_kl_reg_loss: 9030.7936; val_edge_recon_loss: 808407.4688; val_gene_expr_recon_loss: 200441.5990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7652.3955; val_global_loss: 1025532.2500; val_optim_loss: 1025532.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9310; val_auprc_score: 0.9843; val_best_acc_score: 0.9271; val_best_f1_score: 0.9581; train_kl_reg_loss: 9907.5205; train_edge_recon_loss: 780336.2905; train_gene_expr_recon_loss: 199766.6606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7440.2771; train_global_loss: 997450.7488; train_optim_loss: 997450.7488; val_kl_reg_loss: 9381.7072; val_edge_recon_loss: 808389.7604; val_gene_expr_recon_loss: 198962.9115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7212.6572; val_global_loss: 1023947.0312; val_optim_loss: 1023947.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9390; val_auprc_score: 0.9869; val_best_acc_score: 0.9309; val_best_f1_score: 0.9603; train_kl_reg_loss: 9835.1624; train_edge_recon_loss: 792847.7431; train_gene_expr_recon_loss: 198954.1076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7160.6674; train_global_loss: 1008797.6748; train_optim_loss: 1008797.6748; val_kl_reg_loss: 9504.3135; val_edge_recon_loss: 779014.5208; val_gene_expr_recon_loss: 198578.5130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7130.0342; val_global_loss: 994227.3958; val_optim_loss: 994227.3958
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9369; val_auprc_score: 0.9863; val_best_acc_score: 0.9278; val_best_f1_score: 0.9584; train_kl_reg_loss: 9687.4485; train_edge_recon_loss: 785216.2014; train_gene_expr_recon_loss: 198728.2338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7106.6820; train_global_loss: 1000738.5648; train_optim_loss: 1000738.5648; val_kl_reg_loss: 9385.3285; val_edge_recon_loss: 803068.1042; val_gene_expr_recon_loss: 198518.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7082.6177; val_global_loss: 1018054.5312; val_optim_loss: 1018054.5312
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9397; val_auprc_score: 0.9863; val_best_acc_score: 0.9303; val_best_f1_score: 0.9597; train_kl_reg_loss: 9554.2760; train_edge_recon_loss: 793226.7581; train_gene_expr_recon_loss: 198656.1817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7059.2460; train_global_loss: 1008496.4630; train_optim_loss: 1008496.4630; val_kl_reg_loss: 9191.2676; val_edge_recon_loss: 808805.8646; val_gene_expr_recon_loss: 198743.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7035.0933; val_global_loss: 1023775.7396; val_optim_loss: 1023775.7396
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9424; val_auprc_score: 0.9877; val_best_acc_score: 0.9317; val_best_f1_score: 0.9606; train_kl_reg_loss: 9407.3646; train_edge_recon_loss: 787822.6701; train_gene_expr_recon_loss: 198539.0726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7011.8688; train_global_loss: 1002780.9757; train_optim_loss: 1002780.9757; val_kl_reg_loss: 9063.5208; val_edge_recon_loss: 785003.8021; val_gene_expr_recon_loss: 198243.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6987.4463; val_global_loss: 999297.7812; val_optim_loss: 999297.7812
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9425; val_auprc_score: 0.9871; val_best_acc_score: 0.9335; val_best_f1_score: 0.9615; train_kl_reg_loss: 9351.4089; train_edge_recon_loss: 791297.3681; train_gene_expr_recon_loss: 198416.2133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6963.8779; train_global_loss: 1006028.8681; train_optim_loss: 1006028.8681; val_kl_reg_loss: 8929.8586; val_edge_recon_loss: 794167.8229; val_gene_expr_recon_loss: 197894.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6939.3584; val_global_loss: 1007931.8854; val_optim_loss: 1007931.8854

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9414; val_auprc_score: 0.9859; val_best_acc_score: 0.9279; val_best_f1_score: 0.9582; train_kl_reg_loss: 9251.9886; train_edge_recon_loss: 784142.6539; train_gene_expr_recon_loss: 198315.4968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6934.0871; train_global_loss: 998644.2118; train_optim_loss: 998644.2118; val_kl_reg_loss: 8975.8662; val_edge_recon_loss: 822890.4062; val_gene_expr_recon_loss: 198237.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6930.9233; val_global_loss: 1037034.8125; val_optim_loss: 1037034.8125
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9427; val_auprc_score: 0.9881; val_best_acc_score: 0.9321; val_best_f1_score: 0.9607; train_kl_reg_loss: 9290.1957; train_edge_recon_loss: 797772.6042; train_gene_expr_recon_loss: 198271.0894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6928.4445; train_global_loss: 1012262.3310; train_optim_loss: 1012262.3310; val_kl_reg_loss: 9016.0698; val_edge_recon_loss: 789137.8229; val_gene_expr_recon_loss: 198100.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6925.8682; val_global_loss: 1003180.2604; val_optim_loss: 1003180.2604
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9408; val_auprc_score: 0.9864; val_best_acc_score: 0.9310; val_best_f1_score: 0.9599; train_kl_reg_loss: 9310.7807; train_edge_recon_loss: 784618.8600; train_gene_expr_recon_loss: 198250.4022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6923.3578; train_global_loss: 999103.4039; train_optim_loss: 999103.4039; val_kl_reg_loss: 9050.4661; val_edge_recon_loss: 812553.1667; val_gene_expr_recon_loss: 197694.1849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6920.7441; val_global_loss: 1026218.5417; val_optim_loss: 1026218.5417
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9413; val_auprc_score: 0.9864; val_best_acc_score: 0.9317; val_best_f1_score: 0.9605; train_kl_reg_loss: 9276.0976; train_edge_recon_loss: 778566.7558; train_gene_expr_recon_loss: 198245.4601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6918.1616; train_global_loss: 993006.4780; train_optim_loss: 993006.4780; val_kl_reg_loss: 8994.5296; val_edge_recon_loss: 789507.2917; val_gene_expr_recon_loss: 198143.1224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6915.4795; val_global_loss: 1003560.4479; val_optim_loss: 1003560.4479

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 24 min 31 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.9308
val AUPRC score: 0.9838
val best accuracy score: 0.9293
val best F1 score: 0.9591
val target rna MSE score: 63.7963
val source rna MSE score: 10.4540
Val cat covariate0 mean sim diff: -0.0083

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
