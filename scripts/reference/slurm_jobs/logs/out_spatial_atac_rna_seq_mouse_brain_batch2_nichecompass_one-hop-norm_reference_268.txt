[True]
Run timestamp: 10102023_124820_268.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_268']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6692; val_auprc_score: 0.6500; val_best_acc_score: 0.5008; val_best_f1_score: 0.6669; train_kl_reg_loss: 50171.0010; train_edge_recon_loss: 741890.0237; train_gene_expr_recon_loss: 23229108.6061; train_masked_gp_l1_reg_loss: 146122.2513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4986411.1856; train_chrom_access_recon_loss: 4981069.1288; train_global_loss: 34134772.2727; train_optim_loss: 34134772.2727; val_kl_reg_loss: 84474.2861; val_edge_recon_loss: 813118.9609; val_gene_expr_recon_loss: 22087327.5000; val_masked_gp_l1_reg_loss: 119505.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2864804.7500; val_chrom_access_recon_loss: 4845831.9375; val_global_loss: 30815062.5000; val_optim_loss: 30815062.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6724; val_auprc_score: 0.6464; val_best_acc_score: 0.5494; val_best_f1_score: 0.6850; train_kl_reg_loss: 75650.0617; train_edge_recon_loss: 745732.8693; train_gene_expr_recon_loss: 21462225.7879; train_masked_gp_l1_reg_loss: 111194.6985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1630986.0530; train_chrom_access_recon_loss: 4746661.7576; train_global_loss: 28772451.3030; train_optim_loss: 28772451.3030; val_kl_reg_loss: 72581.7627; val_edge_recon_loss: 812521.6484; val_gene_expr_recon_loss: 21310670.2500; val_masked_gp_l1_reg_loss: 104717.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 835340.2500; val_chrom_access_recon_loss: 4780919.5625; val_global_loss: 27916751.2500; val_optim_loss: 27916751.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7058; val_auprc_score: 0.6933; val_best_acc_score: 0.6099; val_best_f1_score: 0.7028; train_kl_reg_loss: 78217.9967; train_edge_recon_loss: 739829.3456; train_gene_expr_recon_loss: 21155118.7576; train_masked_gp_l1_reg_loss: 102825.0058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 561749.9394; train_chrom_access_recon_loss: 4701955.6970; train_global_loss: 27339696.8485; train_optim_loss: 27339696.8485; val_kl_reg_loss: 80047.4707; val_edge_recon_loss: 811556.9141; val_gene_expr_recon_loss: 21288940.5000; val_masked_gp_l1_reg_loss: 101530.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 380432.1875; val_chrom_access_recon_loss: 4862436.4375; val_global_loss: 27524943.0000; val_optim_loss: 27524943.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7907; val_auprc_score: 0.7653; val_best_acc_score: 0.7235; val_best_f1_score: 0.7407; train_kl_reg_loss: 74827.9061; train_edge_recon_loss: 734895.4498; train_gene_expr_recon_loss: 21009657.0606; train_masked_gp_l1_reg_loss: 101244.5740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 295839.2261; train_chrom_access_recon_loss: 4673365.5152; train_global_loss: 26889829.6667; train_optim_loss: 26889829.6667; val_kl_reg_loss: 66946.4727; val_edge_recon_loss: 807691.8594; val_gene_expr_recon_loss: 21063206.0000; val_masked_gp_l1_reg_loss: 101042.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 232061.1250; val_chrom_access_recon_loss: 4773013.1250; val_global_loss: 27043961.5000; val_optim_loss: 27043961.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8463; val_auprc_score: 0.8202; val_best_acc_score: 0.7364; val_best_f1_score: 0.7785; train_kl_reg_loss: 70350.8395; train_edge_recon_loss: 729662.5814; train_gene_expr_recon_loss: 20847428.3636; train_masked_gp_l1_reg_loss: 101822.7949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197523.8241; train_chrom_access_recon_loss: 4641477.9697; train_global_loss: 26588266.5152; train_optim_loss: 26588266.5152; val_kl_reg_loss: 70627.9082; val_edge_recon_loss: 795365.3203; val_gene_expr_recon_loss: 20836455.5000; val_masked_gp_l1_reg_loss: 102935.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169762.2969; val_chrom_access_recon_loss: 4730984.1875; val_global_loss: 26706131.0000; val_optim_loss: 26706131.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8688; val_auprc_score: 0.8428; val_best_acc_score: 0.7974; val_best_f1_score: 0.8090; train_kl_reg_loss: 66221.5630; train_edge_recon_loss: 720593.6136; train_gene_expr_recon_loss: 20732607.6667; train_masked_gp_l1_reg_loss: 103822.2345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152915.9373; train_chrom_access_recon_loss: 4622594.7500; train_global_loss: 26398755.5455; train_optim_loss: 26398755.5455; val_kl_reg_loss: 66239.2305; val_edge_recon_loss: 753591.7188; val_gene_expr_recon_loss: 20819875.2500; val_masked_gp_l1_reg_loss: 105144.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140828.3125; val_chrom_access_recon_loss: 4753583.0625; val_global_loss: 26639261.5000; val_optim_loss: 26639261.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8821; val_auprc_score: 0.8563; val_best_acc_score: 0.8135; val_best_f1_score: 0.8269; train_kl_reg_loss: 65741.6433; train_edge_recon_loss: 688702.3807; train_gene_expr_recon_loss: 20602845.8485; train_masked_gp_l1_reg_loss: 106166.5140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136270.2441; train_chrom_access_recon_loss: 4594778.9773; train_global_loss: 26194505.6667; train_optim_loss: 26194505.6667; val_kl_reg_loss: 69689.4424; val_edge_recon_loss: 673608.1172; val_gene_expr_recon_loss: 20572438.5000; val_masked_gp_l1_reg_loss: 107500.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134065.5781; val_chrom_access_recon_loss: 4644209.1250; val_global_loss: 26201511.5000; val_optim_loss: 26201511.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8905; val_auprc_score: 0.8518; val_best_acc_score: 0.8259; val_best_f1_score: 0.8369; train_kl_reg_loss: 77113.2871; train_edge_recon_loss: 643215.4384; train_gene_expr_recon_loss: 20494266.9394; train_masked_gp_l1_reg_loss: 108672.5779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130652.8234; train_chrom_access_recon_loss: 4575224.1515; train_global_loss: 26029144.8485; train_optim_loss: 26029144.8485; val_kl_reg_loss: 78381.9561; val_edge_recon_loss: 645319.5469; val_gene_expr_recon_loss: 20719130.2500; val_masked_gp_l1_reg_loss: 110260.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126988.8984; val_chrom_access_recon_loss: 4689082.5000; val_global_loss: 26369162.2500; val_optim_loss: 26369162.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9024; val_auprc_score: 0.8761; val_best_acc_score: 0.8321; val_best_f1_score: 0.8424; train_kl_reg_loss: 82027.6187; train_edge_recon_loss: 626175.8371; train_gene_expr_recon_loss: 20382104.0909; train_masked_gp_l1_reg_loss: 111179.6211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123432.6437; train_chrom_access_recon_loss: 4552288.8939; train_global_loss: 25877208.6364; train_optim_loss: 25877208.6364; val_kl_reg_loss: 80644.2881; val_edge_recon_loss: 628181.0469; val_gene_expr_recon_loss: 20276957.0000; val_masked_gp_l1_reg_loss: 112460.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120079.3828; val_chrom_access_recon_loss: 4590056.8125; val_global_loss: 25808379.5000; val_optim_loss: 25808379.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9091; val_auprc_score: 0.8864; val_best_acc_score: 0.8401; val_best_f1_score: 0.8501; train_kl_reg_loss: 81845.3301; train_edge_recon_loss: 617811.2519; train_gene_expr_recon_loss: 20279038.9394; train_masked_gp_l1_reg_loss: 113041.9078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116752.6609; train_chrom_access_recon_loss: 4540198.6515; train_global_loss: 25748689.0000; train_optim_loss: 25748689.0000; val_kl_reg_loss: 80901.0205; val_edge_recon_loss: 615857.7188; val_gene_expr_recon_loss: 20235950.0000; val_masked_gp_l1_reg_loss: 114082.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114027.1641; val_chrom_access_recon_loss: 4617213.5000; val_global_loss: 25778032.2500; val_optim_loss: 25778032.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9033; val_auprc_score: 0.8679; val_best_acc_score: 0.8431; val_best_f1_score: 0.8539; train_kl_reg_loss: 80690.7827; train_edge_recon_loss: 616375.3598; train_gene_expr_recon_loss: 20184087.4242; train_masked_gp_l1_reg_loss: 114695.6147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111648.4393; train_chrom_access_recon_loss: 4516310.4015; train_global_loss: 25623808.0606; train_optim_loss: 25623808.0606; val_kl_reg_loss: 81635.0859; val_edge_recon_loss: 619348.4766; val_gene_expr_recon_loss: 20154622.0000; val_masked_gp_l1_reg_loss: 115465.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109373.2266; val_chrom_access_recon_loss: 4584353.3125; val_global_loss: 25664798.5000; val_optim_loss: 25664798.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9111; val_auprc_score: 0.8809; val_best_acc_score: 0.8434; val_best_f1_score: 0.8544; train_kl_reg_loss: 79833.3413; train_edge_recon_loss: 613565.9290; train_gene_expr_recon_loss: 20122578.9394; train_masked_gp_l1_reg_loss: 115681.2283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108158.9673; train_chrom_access_recon_loss: 4505686.5076; train_global_loss: 25545504.6970; train_optim_loss: 25545504.6970; val_kl_reg_loss: 78272.6455; val_edge_recon_loss: 615573.5938; val_gene_expr_recon_loss: 20174952.7500; val_masked_gp_l1_reg_loss: 115941.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106300.8594; val_chrom_access_recon_loss: 4544931.5000; val_global_loss: 25635972.0000; val_optim_loss: 25635972.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9110; val_auprc_score: 0.8842; val_best_acc_score: 0.8444; val_best_f1_score: 0.8564; train_kl_reg_loss: 78295.1412; train_edge_recon_loss: 612763.8504; train_gene_expr_recon_loss: 20052287.1818; train_masked_gp_l1_reg_loss: 116554.0439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105135.8610; train_chrom_access_recon_loss: 4487701.7727; train_global_loss: 25452737.7273; train_optim_loss: 25452737.7273; val_kl_reg_loss: 81129.8809; val_edge_recon_loss: 613420.4531; val_gene_expr_recon_loss: 20018494.2500; val_masked_gp_l1_reg_loss: 117105.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103839.1562; val_chrom_access_recon_loss: 4583868.6875; val_global_loss: 25517859.7500; val_optim_loss: 25517859.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9117; val_auprc_score: 0.8849; val_best_acc_score: 0.8506; val_best_f1_score: 0.8580; train_kl_reg_loss: 77984.8281; train_edge_recon_loss: 609668.3580; train_gene_expr_recon_loss: 20002998.7273; train_masked_gp_l1_reg_loss: 117314.1483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102606.7633; train_chrom_access_recon_loss: 4474789.3182; train_global_loss: 25385361.9697; train_optim_loss: 25385361.9697; val_kl_reg_loss: 77762.1924; val_edge_recon_loss: 612012.2969; val_gene_expr_recon_loss: 19930597.2500; val_masked_gp_l1_reg_loss: 118070.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102234.1328; val_chrom_access_recon_loss: 4580812.1875; val_global_loss: 25421487.5000; val_optim_loss: 25421487.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9185; val_auprc_score: 0.8980; val_best_acc_score: 0.8506; val_best_f1_score: 0.8601; train_kl_reg_loss: 76835.5893; train_edge_recon_loss: 608552.9318; train_gene_expr_recon_loss: 19927304.6364; train_masked_gp_l1_reg_loss: 118410.1005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100520.8802; train_chrom_access_recon_loss: 4457343.3333; train_global_loss: 25288967.3939; train_optim_loss: 25288967.3939; val_kl_reg_loss: 76195.9121; val_edge_recon_loss: 616106.2891; val_gene_expr_recon_loss: 19970829.2500; val_masked_gp_l1_reg_loss: 118538.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99499.6016; val_chrom_access_recon_loss: 4550981.3125; val_global_loss: 25432150.5000; val_optim_loss: 25432150.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9224; val_auprc_score: 0.8945; val_best_acc_score: 0.8563; val_best_f1_score: 0.8649; train_kl_reg_loss: 76165.8046; train_edge_recon_loss: 607272.1913; train_gene_expr_recon_loss: 19853238.3636; train_masked_gp_l1_reg_loss: 118790.3774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98611.5357; train_chrom_access_recon_loss: 4439384.2652; train_global_loss: 25193462.3636; train_optim_loss: 25193462.3636; val_kl_reg_loss: 75409.6133; val_edge_recon_loss: 611162.0781; val_gene_expr_recon_loss: 19716353.5000; val_masked_gp_l1_reg_loss: 119153.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97710.0547; val_chrom_access_recon_loss: 4510536.7500; val_global_loss: 25130326.0000; val_optim_loss: 25130326.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9247; val_auprc_score: 0.9037; val_best_acc_score: 0.8573; val_best_f1_score: 0.8676; train_kl_reg_loss: 75742.9171; train_edge_recon_loss: 604415.1581; train_gene_expr_recon_loss: 19807538.7879; train_masked_gp_l1_reg_loss: 119422.9940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96880.4995; train_chrom_access_recon_loss: 4430134.5000; train_global_loss: 25134135.2121; train_optim_loss: 25134135.2121; val_kl_reg_loss: 74928.3945; val_edge_recon_loss: 606056.8672; val_gene_expr_recon_loss: 19844340.0000; val_masked_gp_l1_reg_loss: 120002.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96907.0156; val_chrom_access_recon_loss: 4509376.7500; val_global_loss: 25251612.2500; val_optim_loss: 25251612.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9256; val_auprc_score: 0.9012; val_best_acc_score: 0.8552; val_best_f1_score: 0.8614; train_kl_reg_loss: 74968.4190; train_edge_recon_loss: 604288.8390; train_gene_expr_recon_loss: 19779036.3939; train_masked_gp_l1_reg_loss: 120318.5946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95783.7682; train_chrom_access_recon_loss: 4421013.3561; train_global_loss: 25095409.5152; train_optim_loss: 25095409.5152; val_kl_reg_loss: 75235.4951; val_edge_recon_loss: 613951.6875; val_gene_expr_recon_loss: 19773213.5000; val_masked_gp_l1_reg_loss: 120764.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95143.9062; val_chrom_access_recon_loss: 4493318.5000; val_global_loss: 25171627.5000; val_optim_loss: 25171627.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9232; val_auprc_score: 0.8991; val_best_acc_score: 0.8606; val_best_f1_score: 0.8670; train_kl_reg_loss: 74537.2545; train_edge_recon_loss: 602323.1562; train_gene_expr_recon_loss: 19695356.3333; train_masked_gp_l1_reg_loss: 121091.5662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94573.9347; train_chrom_access_recon_loss: 4399613.9621; train_global_loss: 24987496.3333; train_optim_loss: 24987496.3333; val_kl_reg_loss: 73984.7812; val_edge_recon_loss: 612042.8984; val_gene_expr_recon_loss: 19688610.5000; val_masked_gp_l1_reg_loss: 121552.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94188.1875; val_chrom_access_recon_loss: 4468177.8750; val_global_loss: 25058556.0000; val_optim_loss: 25058556.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9355; val_auprc_score: 0.9176; val_best_acc_score: 0.8694; val_best_f1_score: 0.8745; train_kl_reg_loss: 73910.6013; train_edge_recon_loss: 601995.4896; train_gene_expr_recon_loss: 19652184.0606; train_masked_gp_l1_reg_loss: 121763.8130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93502.4542; train_chrom_access_recon_loss: 4385474.2273; train_global_loss: 24928830.5455; train_optim_loss: 24928830.5455; val_kl_reg_loss: 73488.6846; val_edge_recon_loss: 606121.8203; val_gene_expr_recon_loss: 19624254.2500; val_masked_gp_l1_reg_loss: 122440.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93309.5625; val_chrom_access_recon_loss: 4433600.0625; val_global_loss: 24953214.2500; val_optim_loss: 24953214.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9290; val_auprc_score: 0.9036; val_best_acc_score: 0.8667; val_best_f1_score: 0.8728; train_kl_reg_loss: 73351.9901; train_edge_recon_loss: 598405.5047; train_gene_expr_recon_loss: 19614059.8182; train_masked_gp_l1_reg_loss: 122562.6326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92660.6162; train_chrom_access_recon_loss: 4369959.3409; train_global_loss: 24870999.9394; train_optim_loss: 24870999.9394; val_kl_reg_loss: 73675.6631; val_edge_recon_loss: 600656.3359; val_gene_expr_recon_loss: 19669154.2500; val_masked_gp_l1_reg_loss: 123345.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92908.8125; val_chrom_access_recon_loss: 4464071.5000; val_global_loss: 25023812.0000; val_optim_loss: 25023812.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9316; val_auprc_score: 0.9144; val_best_acc_score: 0.8614; val_best_f1_score: 0.8702; train_kl_reg_loss: 73267.1445; train_edge_recon_loss: 596676.9053; train_gene_expr_recon_loss: 19559527.0909; train_masked_gp_l1_reg_loss: 123444.3344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92074.1199; train_chrom_access_recon_loss: 4352389.9470; train_global_loss: 24797379.7576; train_optim_loss: 24797379.7576; val_kl_reg_loss: 73568.4307; val_edge_recon_loss: 605681.6797; val_gene_expr_recon_loss: 19627036.2500; val_masked_gp_l1_reg_loss: 123683.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91612.8359; val_chrom_access_recon_loss: 4418965.7500; val_global_loss: 24940548.2500; val_optim_loss: 24940548.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9370; val_auprc_score: 0.9161; val_best_acc_score: 0.8732; val_best_f1_score: 0.8805; train_kl_reg_loss: 72621.5839; train_edge_recon_loss: 596040.8097; train_gene_expr_recon_loss: 19519505.7879; train_masked_gp_l1_reg_loss: 124121.4085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91428.9780; train_chrom_access_recon_loss: 4340369.5341; train_global_loss: 24744088.0000; train_optim_loss: 24744088.0000; val_kl_reg_loss: 73557.8887; val_edge_recon_loss: 599383.1953; val_gene_expr_recon_loss: 19645526.5000; val_masked_gp_l1_reg_loss: 124652.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91120.9609; val_chrom_access_recon_loss: 4442048.6250; val_global_loss: 24976288.5000; val_optim_loss: 24976288.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9283; val_auprc_score: 0.9005; val_best_acc_score: 0.8646; val_best_f1_score: 0.8732; train_kl_reg_loss: 72421.7717; train_edge_recon_loss: 597606.3248; train_gene_expr_recon_loss: 19466399.1818; train_masked_gp_l1_reg_loss: 124966.2872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90787.9504; train_chrom_access_recon_loss: 4316830.2121; train_global_loss: 24669011.7879; train_optim_loss: 24669011.7879; val_kl_reg_loss: 71402.0283; val_edge_recon_loss: 607261.2578; val_gene_expr_recon_loss: 19175865.2500; val_masked_gp_l1_reg_loss: 125391.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90886.2422; val_chrom_access_recon_loss: 4352848.8125; val_global_loss: 24423655.2500; val_optim_loss: 24423655.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9401; val_auprc_score: 0.9232; val_best_acc_score: 0.8735; val_best_f1_score: 0.8795; train_kl_reg_loss: 71906.1637; train_edge_recon_loss: 595809.9991; train_gene_expr_recon_loss: 19441139.3939; train_masked_gp_l1_reg_loss: 125715.6101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90756.0022; train_chrom_access_recon_loss: 4305480.3295; train_global_loss: 24630807.5455; train_optim_loss: 24630807.5455; val_kl_reg_loss: 70787.2646; val_edge_recon_loss: 601427.0781; val_gene_expr_recon_loss: 19409318.2500; val_masked_gp_l1_reg_loss: 126065.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90218.2031; val_chrom_access_recon_loss: 4387495.9375; val_global_loss: 24685313.0000; val_optim_loss: 24685313.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9306; val_auprc_score: 0.9137; val_best_acc_score: 0.8573; val_best_f1_score: 0.8647; train_kl_reg_loss: 64883.2620; train_edge_recon_loss: 667833.8703; train_gene_expr_recon_loss: 18492156.5152; train_masked_gp_l1_reg_loss: 125099.3875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87313.7944; train_chrom_access_recon_loss: 4192024.8333; train_global_loss: 23629311.8788; train_optim_loss: 23629311.8788; val_kl_reg_loss: 39830.8384; val_edge_recon_loss: 637889.0469; val_gene_expr_recon_loss: 18556680.7500; val_masked_gp_l1_reg_loss: 124484.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85339.3672; val_chrom_access_recon_loss: 4270529.4688; val_global_loss: 23714754.0000; val_optim_loss: 23714754.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9251; val_auprc_score: 0.9019; val_best_acc_score: 0.8619; val_best_f1_score: 0.8694; train_kl_reg_loss: 64398.9168; train_edge_recon_loss: 617735.4148; train_gene_expr_recon_loss: 18445794.9091; train_masked_gp_l1_reg_loss: 123353.6436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84835.9917; train_chrom_access_recon_loss: 4159434.8409; train_global_loss: 23495553.9091; train_optim_loss: 23495553.9091; val_kl_reg_loss: 50173.1602; val_edge_recon_loss: 614321.3750; val_gene_expr_recon_loss: 18582843.7500; val_masked_gp_l1_reg_loss: 122614.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84673.7344; val_chrom_access_recon_loss: 4263593.5938; val_global_loss: 23718219.5000; val_optim_loss: 23718219.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9338; val_auprc_score: 0.9158; val_best_acc_score: 0.8641; val_best_f1_score: 0.8710; train_kl_reg_loss: 63526.2758; train_edge_recon_loss: 602826.9678; train_gene_expr_recon_loss: 18399005.0000; train_masked_gp_l1_reg_loss: 121899.0762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84255.7893; train_chrom_access_recon_loss: 4147448.0455; train_global_loss: 23418961.3333; train_optim_loss: 23418961.3333; val_kl_reg_loss: 55182.2661; val_edge_recon_loss: 602091.7812; val_gene_expr_recon_loss: 18516124.2500; val_masked_gp_l1_reg_loss: 121301.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83639.5703; val_chrom_access_recon_loss: 4211465.6562; val_global_loss: 23589806.5000; val_optim_loss: 23589806.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9332; val_auprc_score: 0.9091; val_best_acc_score: 0.8670; val_best_f1_score: 0.8754; train_kl_reg_loss: 62861.9614; train_edge_recon_loss: 595304.5057; train_gene_expr_recon_loss: 18362391.4848; train_masked_gp_l1_reg_loss: 120958.5716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83707.7096; train_chrom_access_recon_loss: 4133357.4545; train_global_loss: 23358581.6970; train_optim_loss: 23358581.6970; val_kl_reg_loss: 56703.7822; val_edge_recon_loss: 597277.0703; val_gene_expr_recon_loss: 18327650.5000; val_masked_gp_l1_reg_loss: 120721.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83651.7031; val_chrom_access_recon_loss: 4202681.1875; val_global_loss: 23388686.5000; val_optim_loss: 23388686.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9388; val_auprc_score: 0.9186; val_best_acc_score: 0.8748; val_best_f1_score: 0.8789; train_kl_reg_loss: 62516.8089; train_edge_recon_loss: 595009.8248; train_gene_expr_recon_loss: 18309887.0303; train_masked_gp_l1_reg_loss: 120611.5691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83349.1407; train_chrom_access_recon_loss: 4124064.5076; train_global_loss: 23295438.5758; train_optim_loss: 23295438.5758; val_kl_reg_loss: 58433.3604; val_edge_recon_loss: 596216.7969; val_gene_expr_recon_loss: 18287305.7500; val_masked_gp_l1_reg_loss: 120402.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83021.1719; val_chrom_access_recon_loss: 4189910.1250; val_global_loss: 23335290.2500; val_optim_loss: 23335290.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9300; val_auprc_score: 0.9072; val_best_acc_score: 0.8638; val_best_f1_score: 0.8698; train_kl_reg_loss: 60628.7334; train_edge_recon_loss: 596107.9527; train_gene_expr_recon_loss: 18315194.2727; train_masked_gp_l1_reg_loss: 120188.8205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83128.5896; train_chrom_access_recon_loss: 4117984.1780; train_global_loss: 23293232.7879; train_optim_loss: 23293232.7879; val_kl_reg_loss: 50205.0762; val_edge_recon_loss: 609229.8516; val_gene_expr_recon_loss: 18475400.2500; val_masked_gp_l1_reg_loss: 119953.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84346.3594; val_chrom_access_recon_loss: 4275843.0625; val_global_loss: 23614978.2500; val_optim_loss: 23614978.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9379; val_auprc_score: 0.9199; val_best_acc_score: 0.8708; val_best_f1_score: 0.8782; train_kl_reg_loss: 60163.1989; train_edge_recon_loss: 598941.8826; train_gene_expr_recon_loss: 18302980.7273; train_masked_gp_l1_reg_loss: 118794.9380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83446.7741; train_chrom_access_recon_loss: 4115411.6742; train_global_loss: 23279739.2727; train_optim_loss: 23279739.2727; val_kl_reg_loss: 59375.9785; val_edge_recon_loss: 598574.0703; val_gene_expr_recon_loss: 18257212.5000; val_masked_gp_l1_reg_loss: 117856.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83471.1250; val_chrom_access_recon_loss: 4168041.7812; val_global_loss: 23284532.7500; val_optim_loss: 23284532.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9384; val_auprc_score: 0.9135; val_best_acc_score: 0.8735; val_best_f1_score: 0.8788; train_kl_reg_loss: 62092.2733; train_edge_recon_loss: 594888.8078; train_gene_expr_recon_loss: 18248512.8485; train_masked_gp_l1_reg_loss: 117667.7272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82420.2908; train_chrom_access_recon_loss: 4110593.6250; train_global_loss: 23216175.3939; train_optim_loss: 23216175.3939; val_kl_reg_loss: 58978.9365; val_edge_recon_loss: 595426.8750; val_gene_expr_recon_loss: 18206824.5000; val_masked_gp_l1_reg_loss: 117107.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81910.5000; val_chrom_access_recon_loss: 4219732.1250; val_global_loss: 23279980.5000; val_optim_loss: 23279980.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9279; val_auprc_score: 0.9057; val_best_acc_score: 0.8616; val_best_f1_score: 0.8713; train_kl_reg_loss: 70743.7783; train_edge_recon_loss: 597969.9271; train_gene_expr_recon_loss: 18202757.0909; train_masked_gp_l1_reg_loss: 116543.2777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81447.3493; train_chrom_access_recon_loss: 4105772.3674; train_global_loss: 23175233.6970; train_optim_loss: 23175233.6970; val_kl_reg_loss: 60754.2568; val_edge_recon_loss: 601406.4922; val_gene_expr_recon_loss: 18237570.7500; val_masked_gp_l1_reg_loss: 115235.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80929.6562; val_chrom_access_recon_loss: 4169336.9062; val_global_loss: 23265235.2500; val_optim_loss: 23265235.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9423; val_auprc_score: 0.9246; val_best_acc_score: 0.8769; val_best_f1_score: 0.8839; train_kl_reg_loss: 64666.3360; train_edge_recon_loss: 590223.5938; train_gene_expr_recon_loss: 18187897.4242; train_masked_gp_l1_reg_loss: 114935.7053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81180.0838; train_chrom_access_recon_loss: 4105112.8636; train_global_loss: 23144016.1515; train_optim_loss: 23144016.1515; val_kl_reg_loss: 61263.4224; val_edge_recon_loss: 595920.1797; val_gene_expr_recon_loss: 18203364.7500; val_masked_gp_l1_reg_loss: 114770.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81218.0234; val_chrom_access_recon_loss: 4202221.3125; val_global_loss: 23258757.7500; val_optim_loss: 23258757.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9311; val_auprc_score: 0.9071; val_best_acc_score: 0.8684; val_best_f1_score: 0.8768; train_kl_reg_loss: 64458.9641; train_edge_recon_loss: 589731.3523; train_gene_expr_recon_loss: 18140779.5606; train_masked_gp_l1_reg_loss: 114702.3943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81140.8453; train_chrom_access_recon_loss: 4092108.1818; train_global_loss: 23082921.1818; train_optim_loss: 23082921.1818; val_kl_reg_loss: 62831.5361; val_edge_recon_loss: 595914.0469; val_gene_expr_recon_loss: 18217086.0000; val_masked_gp_l1_reg_loss: 114797.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81271.2812; val_chrom_access_recon_loss: 4213819.0000; val_global_loss: 23285721.0000; val_optim_loss: 23285721.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9187; val_auprc_score: 0.8928; val_best_acc_score: 0.8512; val_best_f1_score: 0.8599; train_kl_reg_loss: 62785.5114; train_edge_recon_loss: 598233.8021; train_gene_expr_recon_loss: 18247862.8182; train_masked_gp_l1_reg_loss: 114851.4341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81215.2470; train_chrom_access_recon_loss: 4107083.2121; train_global_loss: 23212032.2121; train_optim_loss: 23212032.2121; val_kl_reg_loss: 56053.4277; val_edge_recon_loss: 610602.7344; val_gene_expr_recon_loss: 18241319.2500; val_masked_gp_l1_reg_loss: 113897.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82038.6172; val_chrom_access_recon_loss: 4161583.5625; val_global_loss: 23265495.2500; val_optim_loss: 23265495.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9121; val_auprc_score: 0.8831; val_best_acc_score: 0.8512; val_best_f1_score: 0.8617; train_kl_reg_loss: 73619.3746; train_edge_recon_loss: 605927.9441; train_gene_expr_recon_loss: 18284311.3333; train_masked_gp_l1_reg_loss: 112152.5301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80576.1321; train_chrom_access_recon_loss: 4109936.5795; train_global_loss: 23266524.0909; train_optim_loss: 23266524.0909; val_kl_reg_loss: 56908.4688; val_edge_recon_loss: 623208.9219; val_gene_expr_recon_loss: 18256011.7500; val_masked_gp_l1_reg_loss: 110859.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80081.4688; val_chrom_access_recon_loss: 4173777.0312; val_global_loss: 23300847.7500; val_optim_loss: 23300847.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9279; val_auprc_score: 0.9052; val_best_acc_score: 0.8632; val_best_f1_score: 0.8710; train_kl_reg_loss: 66016.2283; train_edge_recon_loss: 603602.1525; train_gene_expr_recon_loss: 18156224.3333; train_masked_gp_l1_reg_loss: 110241.5600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79307.4368; train_chrom_access_recon_loss: 4099138.3068; train_global_loss: 23114530.2424; train_optim_loss: 23114530.2424; val_kl_reg_loss: 59178.2393; val_edge_recon_loss: 640020.7578; val_gene_expr_recon_loss: 18331958.0000; val_masked_gp_l1_reg_loss: 110167.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79208.0859; val_chrom_access_recon_loss: 4216094.0625; val_global_loss: 23436627.2500; val_optim_loss: 23436627.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9282; val_auprc_score: 0.9001; val_best_acc_score: 0.8667; val_best_f1_score: 0.8743; train_kl_reg_loss: 61041.2386; train_edge_recon_loss: 621515.9716; train_gene_expr_recon_loss: 18155935.5758; train_masked_gp_l1_reg_loss: 106997.8944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66496.8703; train_chrom_access_recon_loss: 4091508.0038; train_global_loss: 23103495.5152; train_optim_loss: 23103495.5152; val_kl_reg_loss: 57920.0308; val_edge_recon_loss: 617731.2656; val_gene_expr_recon_loss: 18149587.2500; val_masked_gp_l1_reg_loss: 105805.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63439.2461; val_chrom_access_recon_loss: 4157668.3125; val_global_loss: 23152152.7500; val_optim_loss: 23152152.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9225; val_auprc_score: 0.9021; val_best_acc_score: 0.8555; val_best_f1_score: 0.8636; train_kl_reg_loss: 63859.0948; train_edge_recon_loss: 611267.1960; train_gene_expr_recon_loss: 18101631.6667; train_masked_gp_l1_reg_loss: 105529.8973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62832.4671; train_chrom_access_recon_loss: 4078893.2500; train_global_loss: 23024013.7576; train_optim_loss: 23024013.7576; val_kl_reg_loss: 58607.4409; val_edge_recon_loss: 616641.7656; val_gene_expr_recon_loss: 17954047.8750; val_masked_gp_l1_reg_loss: 105340.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62343.1250; val_chrom_access_recon_loss: 4108365.9375; val_global_loss: 22905346.7500; val_optim_loss: 22905346.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9274; val_auprc_score: 0.9033; val_best_acc_score: 0.8665; val_best_f1_score: 0.8747; train_kl_reg_loss: 61203.7112; train_edge_recon_loss: 606310.8722; train_gene_expr_recon_loss: 18087868.5152; train_masked_gp_l1_reg_loss: 105261.1913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61995.7357; train_chrom_access_recon_loss: 4076763.3030; train_global_loss: 22999403.3030; train_optim_loss: 22999403.3030; val_kl_reg_loss: 59822.6812; val_edge_recon_loss: 607397.3438; val_gene_expr_recon_loss: 18340427.2500; val_masked_gp_l1_reg_loss: 105221.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61727.8984; val_chrom_access_recon_loss: 4189970.6875; val_global_loss: 23364567.7500; val_optim_loss: 23364567.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9273; val_auprc_score: 0.9090; val_best_acc_score: 0.8630; val_best_f1_score: 0.8715; train_kl_reg_loss: 61888.5046; train_edge_recon_loss: 602236.5199; train_gene_expr_recon_loss: 18074455.0000; train_masked_gp_l1_reg_loss: 105181.7395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61478.9631; train_chrom_access_recon_loss: 4071397.1629; train_global_loss: 22976638.0000; train_optim_loss: 22976638.0000; val_kl_reg_loss: 60434.3857; val_edge_recon_loss: 606318.7891; val_gene_expr_recon_loss: 18083142.5000; val_masked_gp_l1_reg_loss: 105153.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61187.3242; val_chrom_access_recon_loss: 4126161.5000; val_global_loss: 23042399.2500; val_optim_loss: 23042399.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9290; val_auprc_score: 0.9017; val_best_acc_score: 0.8716; val_best_f1_score: 0.8787; train_kl_reg_loss: 62854.5164; train_edge_recon_loss: 598263.2112; train_gene_expr_recon_loss: 18085928.3333; train_masked_gp_l1_reg_loss: 105126.2198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60962.0922; train_chrom_access_recon_loss: 4077692.2159; train_global_loss: 22990826.5758; train_optim_loss: 22990826.5758; val_kl_reg_loss: 61296.0933; val_edge_recon_loss: 601649.3359; val_gene_expr_recon_loss: 18194907.5000; val_masked_gp_l1_reg_loss: 105165.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60811.4414; val_chrom_access_recon_loss: 4147773.1250; val_global_loss: 23171604.2500; val_optim_loss: 23171604.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9297; val_auprc_score: 0.9020; val_best_acc_score: 0.8670; val_best_f1_score: 0.8736; train_kl_reg_loss: 63523.1341; train_edge_recon_loss: 597334.8239; train_gene_expr_recon_loss: 18053326.6970; train_masked_gp_l1_reg_loss: 105132.1663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60579.0518; train_chrom_access_recon_loss: 4070786.2917; train_global_loss: 22950682.2424; train_optim_loss: 22950682.2424; val_kl_reg_loss: 61702.9502; val_edge_recon_loss: 599837.9531; val_gene_expr_recon_loss: 18154566.7500; val_masked_gp_l1_reg_loss: 105119.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60339.4180; val_chrom_access_recon_loss: 4171344.0000; val_global_loss: 23152911.2500; val_optim_loss: 23152911.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9255; val_auprc_score: 0.9049; val_best_acc_score: 0.8611; val_best_f1_score: 0.8690; train_kl_reg_loss: 63764.2370; train_edge_recon_loss: 597664.2642; train_gene_expr_recon_loss: 18071580.1515; train_masked_gp_l1_reg_loss: 104815.4093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58957.1552; train_chrom_access_recon_loss: 4070518.0644; train_global_loss: 22967299.1818; train_optim_loss: 22967299.1818; val_kl_reg_loss: 61700.7178; val_edge_recon_loss: 604766.0547; val_gene_expr_recon_loss: 18020748.7500; val_masked_gp_l1_reg_loss: 104686.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58591.5391; val_chrom_access_recon_loss: 4114374.8750; val_global_loss: 22964868.0000; val_optim_loss: 22964868.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9353; val_auprc_score: 0.9155; val_best_acc_score: 0.8729; val_best_f1_score: 0.8791; train_kl_reg_loss: 64197.7607; train_edge_recon_loss: 597238.2992; train_gene_expr_recon_loss: 18067057.6364; train_masked_gp_l1_reg_loss: 104657.1634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58504.3131; train_chrom_access_recon_loss: 4072362.2500; train_global_loss: 22964017.4242; train_optim_loss: 22964017.4242; val_kl_reg_loss: 61868.3887; val_edge_recon_loss: 599797.3906; val_gene_expr_recon_loss: 18197668.0000; val_masked_gp_l1_reg_loss: 104630.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58430.1992; val_chrom_access_recon_loss: 4135199.9375; val_global_loss: 23157593.5000; val_optim_loss: 23157593.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9300; val_auprc_score: 0.9094; val_best_acc_score: 0.8718; val_best_f1_score: 0.8780; train_kl_reg_loss: 63983.9060; train_edge_recon_loss: 598042.3703; train_gene_expr_recon_loss: 18068039.6061; train_masked_gp_l1_reg_loss: 104610.9996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58375.4181; train_chrom_access_recon_loss: 4071668.7462; train_global_loss: 22964721.0000; train_optim_loss: 22964721.0000; val_kl_reg_loss: 62135.4932; val_edge_recon_loss: 606471.8672; val_gene_expr_recon_loss: 18160676.5000; val_masked_gp_l1_reg_loss: 104596.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58320.4609; val_chrom_access_recon_loss: 4160612.5625; val_global_loss: 23152812.5000; val_optim_loss: 23152812.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9357; val_auprc_score: 0.9142; val_best_acc_score: 0.8700; val_best_f1_score: 0.8765; train_kl_reg_loss: 64037.6887; train_edge_recon_loss: 598395.4261; train_gene_expr_recon_loss: 18080191.2424; train_masked_gp_l1_reg_loss: 104590.8187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58292.7923; train_chrom_access_recon_loss: 4074271.7727; train_global_loss: 22979779.6364; train_optim_loss: 22979779.6364; val_kl_reg_loss: 62377.2549; val_edge_recon_loss: 600806.6172; val_gene_expr_recon_loss: 18217177.2500; val_masked_gp_l1_reg_loss: 104588.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58252.9531; val_chrom_access_recon_loss: 4141479.6875; val_global_loss: 23184681.0000; val_optim_loss: 23184681.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 43 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9297
val AUPRC score: 0.9046
val best accuracy score: 0.8678
val best F1 score: 0.8746
val target rna MSE score: 1.6721
val source rna MSE score: 1.3033
val target atac MSE score: 0.4882
val source atac MSE score: 0.2320
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
