[True]
Run timestamp: 07092023_050654_268.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_268']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1123 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5626, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1123
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1123

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6541; val_auprc_score: 0.6273; val_best_acc_score: 0.5091; val_best_f1_score: 0.6708; train_kl_reg_loss: 62944.2918; train_edge_recon_loss: 3551741.9697; train_gene_expr_recon_loss: 16543967.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1472437.2538; train_chrom_access_recon_loss: 6303146.9545; train_global_loss: 27934238.4242; train_optim_loss: 27934238.4242; val_kl_reg_loss: 150819.7461; val_edge_recon_loss: 4064958.9062; val_gene_expr_recon_loss: 14872234.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1127133.6250; val_chrom_access_recon_loss: 5922182.5625; val_global_loss: 26137329.7500; val_optim_loss: 26137329.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6664; val_auprc_score: 0.6420; val_best_acc_score: 0.5833; val_best_f1_score: 0.6961; train_kl_reg_loss: 111427.1458; train_edge_recon_loss: 3533282.1515; train_gene_expr_recon_loss: 14837972.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 829237.2225; train_chrom_access_recon_loss: 5982007.4924; train_global_loss: 25293925.8485; train_optim_loss: 25293925.8485; val_kl_reg_loss: 105377.5830; val_edge_recon_loss: 4060840.0938; val_gene_expr_recon_loss: 14501908.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 577024.2500; val_chrom_access_recon_loss: 5893409.0000; val_global_loss: 25138558.7500; val_optim_loss: 25138558.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7181; val_auprc_score: 0.6988; val_best_acc_score: 0.6488; val_best_f1_score: 0.7042; train_kl_reg_loss: 104623.5549; train_edge_recon_loss: 3522676.1023; train_gene_expr_recon_loss: 14618018.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 431377.3802; train_chrom_access_recon_loss: 5927053.1818; train_global_loss: 24603749.0606; train_optim_loss: 24603749.0606; val_kl_reg_loss: 98054.5146; val_edge_recon_loss: 4051080.5938; val_gene_expr_recon_loss: 14369336.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 317448.2812; val_chrom_access_recon_loss: 5787136.5625; val_global_loss: 24623056.2500; val_optim_loss: 24623056.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7886; val_auprc_score: 0.7677; val_best_acc_score: 0.6940; val_best_f1_score: 0.7261; train_kl_reg_loss: 93729.2174; train_edge_recon_loss: 3513295.7955; train_gene_expr_recon_loss: 14496671.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 252334.9231; train_chrom_access_recon_loss: 5893488.4470; train_global_loss: 24249520.2727; train_optim_loss: 24249520.2727; val_kl_reg_loss: 97795.7363; val_edge_recon_loss: 3994514.9688; val_gene_expr_recon_loss: 14262291.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199457.1406; val_chrom_access_recon_loss: 5774460.0000; val_global_loss: 24328520.5000; val_optim_loss: 24328520.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8576; val_auprc_score: 0.8258; val_best_acc_score: 0.7818; val_best_f1_score: 0.8000; train_kl_reg_loss: 78679.0094; train_edge_recon_loss: 3475903.0303; train_gene_expr_recon_loss: 14405948.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166476.3305; train_chrom_access_recon_loss: 5857742.5758; train_global_loss: 23984749.7273; train_optim_loss: 23984749.7273; val_kl_reg_loss: 61222.0181; val_edge_recon_loss: 3660291.2812; val_gene_expr_recon_loss: 14322817.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139498.2969; val_chrom_access_recon_loss: 5772826.6875; val_global_loss: 23956656.0000; val_optim_loss: 23956656.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8568; val_auprc_score: 0.8219; val_best_acc_score: 0.7797; val_best_f1_score: 0.8052; train_kl_reg_loss: 76168.4097; train_edge_recon_loss: 3153043.1667; train_gene_expr_recon_loss: 14361731.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122433.0079; train_chrom_access_recon_loss: 5842150.1742; train_global_loss: 23555526.5455; train_optim_loss: 23555526.5455; val_kl_reg_loss: 94826.9941; val_edge_recon_loss: 2989687.3125; val_gene_expr_recon_loss: 14093141.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107675.4141; val_chrom_access_recon_loss: 5724545.2500; val_global_loss: 23009877.0000; val_optim_loss: 23009877.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8844; val_auprc_score: 0.8571; val_best_acc_score: 0.8079; val_best_f1_score: 0.8279; train_kl_reg_loss: 104858.5803; train_edge_recon_loss: 2899921.6742; train_gene_expr_recon_loss: 14269029.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95633.3510; train_chrom_access_recon_loss: 5803357.6061; train_global_loss: 23172800.5152; train_optim_loss: 23172800.5152; val_kl_reg_loss: 105337.5039; val_edge_recon_loss: 2873006.3438; val_gene_expr_recon_loss: 14152719.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85099.3750; val_chrom_access_recon_loss: 5685802.6250; val_global_loss: 22901965.5000; val_optim_loss: 22901965.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8996; val_auprc_score: 0.8680; val_best_acc_score: 0.8342; val_best_f1_score: 0.8450; train_kl_reg_loss: 106547.4711; train_edge_recon_loss: 2851465.5947; train_gene_expr_recon_loss: 14189670.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78178.3320; train_chrom_access_recon_loss: 5780479.8864; train_global_loss: 23006341.6364; train_optim_loss: 23006341.6364; val_kl_reg_loss: 102874.0078; val_edge_recon_loss: 2875810.3750; val_gene_expr_recon_loss: 14019736.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72093.8672; val_chrom_access_recon_loss: 5688740.7500; val_global_loss: 22759255.2500; val_optim_loss: 22759255.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8952; val_auprc_score: 0.8630; val_best_acc_score: 0.8334; val_best_f1_score: 0.8468; train_kl_reg_loss: 107685.0683; train_edge_recon_loss: 2838546.4811; train_gene_expr_recon_loss: 14121311.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67594.0896; train_chrom_access_recon_loss: 5751838.1136; train_global_loss: 22886975.6061; train_optim_loss: 22886975.6061; val_kl_reg_loss: 100517.9639; val_edge_recon_loss: 2873938.5625; val_gene_expr_recon_loss: 13879294.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64420.1523; val_chrom_access_recon_loss: 5664301.1875; val_global_loss: 22582472.7500; val_optim_loss: 22582472.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8916; val_auprc_score: 0.8563; val_best_acc_score: 0.8353; val_best_f1_score: 0.8469; train_kl_reg_loss: 101451.5266; train_edge_recon_loss: 2828265.4659; train_gene_expr_recon_loss: 14056278.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61249.7024; train_chrom_access_recon_loss: 5728683.8788; train_global_loss: 22775928.8485; train_optim_loss: 22775928.8485; val_kl_reg_loss: 104095.5693; val_edge_recon_loss: 2899464.8125; val_gene_expr_recon_loss: 13744857.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58631.8711; val_chrom_access_recon_loss: 5570562.0000; val_global_loss: 22377611.5000; val_optim_loss: 22377611.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9044; val_auprc_score: 0.8744; val_best_acc_score: 0.8393; val_best_f1_score: 0.8489; train_kl_reg_loss: 101322.1719; train_edge_recon_loss: 2818848.2765; train_gene_expr_recon_loss: 13990826.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56335.6682; train_chrom_access_recon_loss: 5702899.7652; train_global_loss: 22670232.6667; train_optim_loss: 22670232.6667; val_kl_reg_loss: 100831.9541; val_edge_recon_loss: 2870793.6875; val_gene_expr_recon_loss: 13699299.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54516.8594; val_chrom_access_recon_loss: 5520986.7500; val_global_loss: 22246429.0000; val_optim_loss: 22246429.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9120; val_auprc_score: 0.8819; val_best_acc_score: 0.8525; val_best_f1_score: 0.8582; train_kl_reg_loss: 97262.1534; train_edge_recon_loss: 2816035.8371; train_gene_expr_recon_loss: 13944975.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52713.3710; train_chrom_access_recon_loss: 5688234.3864; train_global_loss: 22599221.3636; train_optim_loss: 22599221.3636; val_kl_reg_loss: 95543.3760; val_edge_recon_loss: 2836292.2500; val_gene_expr_recon_loss: 13711169.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51389.8203; val_chrom_access_recon_loss: 5565861.3750; val_global_loss: 22260256.5000; val_optim_loss: 22260256.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9130; val_auprc_score: 0.8757; val_best_acc_score: 0.8557; val_best_f1_score: 0.8647; train_kl_reg_loss: 95916.6148; train_edge_recon_loss: 2789978.0303; train_gene_expr_recon_loss: 13889949.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50204.0532; train_chrom_access_recon_loss: 5664791.2500; train_global_loss: 22490838.9091; train_optim_loss: 22490838.9091; val_kl_reg_loss: 91977.1504; val_edge_recon_loss: 2801751.6562; val_gene_expr_recon_loss: 13523512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49183.5469; val_chrom_access_recon_loss: 5506183.2500; val_global_loss: 21972608.0000; val_optim_loss: 21972608.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9134; val_auprc_score: 0.8872; val_best_acc_score: 0.8482; val_best_f1_score: 0.8605; train_kl_reg_loss: 92033.7850; train_edge_recon_loss: 2803023.8561; train_gene_expr_recon_loss: 13857142.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48064.8471; train_chrom_access_recon_loss: 5651237.9242; train_global_loss: 22451502.8788; train_optim_loss: 22451502.8788; val_kl_reg_loss: 88524.8477; val_edge_recon_loss: 2821778.0625; val_gene_expr_recon_loss: 13624285.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47374.1211; val_chrom_access_recon_loss: 5557615.4375; val_global_loss: 22139578.0000; val_optim_loss: 22139578.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9165; val_auprc_score: 0.8911; val_best_acc_score: 0.8573; val_best_f1_score: 0.8646; train_kl_reg_loss: 89500.2480; train_edge_recon_loss: 2780343.2159; train_gene_expr_recon_loss: 13809992.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46378.0371; train_chrom_access_recon_loss: 5630073.4318; train_global_loss: 22356287.1212; train_optim_loss: 22356287.1212; val_kl_reg_loss: 87496.5615; val_edge_recon_loss: 2833345.0000; val_gene_expr_recon_loss: 13635730.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45501.9219; val_chrom_access_recon_loss: 5502699.1875; val_global_loss: 22104772.7500; val_optim_loss: 22104772.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9133; val_auprc_score: 0.8842; val_best_acc_score: 0.8579; val_best_f1_score: 0.8672; train_kl_reg_loss: 88167.4268; train_edge_recon_loss: 2775367.0341; train_gene_expr_recon_loss: 13772761.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44647.3317; train_chrom_access_recon_loss: 5616599.4773; train_global_loss: 22297542.6970; train_optim_loss: 22297542.6970; val_kl_reg_loss: 85196.6357; val_edge_recon_loss: 2840512.0000; val_gene_expr_recon_loss: 13534311.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44131.6602; val_chrom_access_recon_loss: 5503627.1250; val_global_loss: 22007779.5000; val_optim_loss: 22007779.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9225; val_auprc_score: 0.8990; val_best_acc_score: 0.8657; val_best_f1_score: 0.8735; train_kl_reg_loss: 86205.6333; train_edge_recon_loss: 2761175.5492; train_gene_expr_recon_loss: 13723123.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43487.3571; train_chrom_access_recon_loss: 5595407.9545; train_global_loss: 22209399.5152; train_optim_loss: 22209399.5152; val_kl_reg_loss: 86839.4668; val_edge_recon_loss: 2775004.1875; val_gene_expr_recon_loss: 13718701.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42907.7617; val_chrom_access_recon_loss: 5507308.1250; val_global_loss: 22130761.2500; val_optim_loss: 22130761.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9183; val_auprc_score: 0.8909; val_best_acc_score: 0.8649; val_best_f1_score: 0.8731; train_kl_reg_loss: 86052.4831; train_edge_recon_loss: 2761875.5606; train_gene_expr_recon_loss: 13690945.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37249.6038; train_chrom_access_recon_loss: 5584021.4621; train_global_loss: 22160144.4242; train_optim_loss: 22160144.4242; val_kl_reg_loss: 87093.4355; val_edge_recon_loss: 2791142.2812; val_gene_expr_recon_loss: 13446571.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35289.1445; val_chrom_access_recon_loss: 5438851.8125; val_global_loss: 21798948.2500; val_optim_loss: 21798948.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9184; val_auprc_score: 0.8903; val_best_acc_score: 0.8600; val_best_f1_score: 0.8700; train_kl_reg_loss: 86278.0478; train_edge_recon_loss: 2766802.5909; train_gene_expr_recon_loss: 13695877.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34997.8743; train_chrom_access_recon_loss: 5581533.4394; train_global_loss: 22165489.1818; train_optim_loss: 22165489.1818; val_kl_reg_loss: 88025.5547; val_edge_recon_loss: 2784674.8438; val_gene_expr_recon_loss: 13614522.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34837.2852; val_chrom_access_recon_loss: 5514824.4375; val_global_loss: 22036885.0000; val_optim_loss: 22036885.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9176; val_auprc_score: 0.8878; val_best_acc_score: 0.8649; val_best_f1_score: 0.8731; train_kl_reg_loss: 86162.4567; train_edge_recon_loss: 2773757.4545; train_gene_expr_recon_loss: 13686569.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34702.3906; train_chrom_access_recon_loss: 5576856.3485; train_global_loss: 22158048.0606; train_optim_loss: 22158048.0606; val_kl_reg_loss: 85895.6689; val_edge_recon_loss: 2796281.0312; val_gene_expr_recon_loss: 13473806.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34590.0820; val_chrom_access_recon_loss: 5404318.1250; val_global_loss: 21794891.0000; val_optim_loss: 21794891.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9224; val_auprc_score: 0.8934; val_best_acc_score: 0.8673; val_best_f1_score: 0.8759; train_kl_reg_loss: 85637.7654; train_edge_recon_loss: 2762444.6174; train_gene_expr_recon_loss: 13683962.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34481.4434; train_chrom_access_recon_loss: 5575058.6212; train_global_loss: 22141585.3939; train_optim_loss: 22141585.3939; val_kl_reg_loss: 85468.8223; val_edge_recon_loss: 2801401.0312; val_gene_expr_recon_loss: 13453347.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34391.5234; val_chrom_access_recon_loss: 5414246.9375; val_global_loss: 21788856.5000; val_optim_loss: 21788856.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9224; val_auprc_score: 0.9008; val_best_acc_score: 0.8641; val_best_f1_score: 0.8732; train_kl_reg_loss: 85870.6199; train_edge_recon_loss: 2753882.1098; train_gene_expr_recon_loss: 13679658.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34280.4961; train_chrom_access_recon_loss: 5573511.7576; train_global_loss: 22127203.6667; train_optim_loss: 22127203.6667; val_kl_reg_loss: 85951.8477; val_edge_recon_loss: 2817681.0312; val_gene_expr_recon_loss: 13566147.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34205.0156; val_chrom_access_recon_loss: 5492312.3125; val_global_loss: 21996297.7500; val_optim_loss: 21996297.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9219; val_auprc_score: 0.8997; val_best_acc_score: 0.8665; val_best_f1_score: 0.8745; train_kl_reg_loss: 85506.5224; train_edge_recon_loss: 2753594.3144; train_gene_expr_recon_loss: 13674599.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34107.3364; train_chrom_access_recon_loss: 5571838.6439; train_global_loss: 22119646.5455; train_optim_loss: 22119646.5455; val_kl_reg_loss: 85364.1494; val_edge_recon_loss: 2764324.2500; val_gene_expr_recon_loss: 13651518.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34026.4844; val_chrom_access_recon_loss: 5471343.3750; val_global_loss: 22006576.0000; val_optim_loss: 22006576.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9250; val_auprc_score: 0.8966; val_best_acc_score: 0.8726; val_best_f1_score: 0.8796; train_kl_reg_loss: 85287.4862; train_edge_recon_loss: 2757112.8485; train_gene_expr_recon_loss: 13677591.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33943.2827; train_chrom_access_recon_loss: 5570057.7652; train_global_loss: 22123992.7273; train_optim_loss: 22123992.7273; val_kl_reg_loss: 85333.6064; val_edge_recon_loss: 2788556.7500; val_gene_expr_recon_loss: 13437262.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33877.0703; val_chrom_access_recon_loss: 5432742.2500; val_global_loss: 21777771.7500; val_optim_loss: 21777771.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9202; val_auprc_score: 0.8931; val_best_acc_score: 0.8643; val_best_f1_score: 0.8740; train_kl_reg_loss: 84735.5202; train_edge_recon_loss: 2756711.8826; train_gene_expr_recon_loss: 13674182.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33785.8059; train_chrom_access_recon_loss: 5572822.8333; train_global_loss: 22122238.6970; train_optim_loss: 22122238.6970; val_kl_reg_loss: 85110.6787; val_edge_recon_loss: 2783327.2812; val_gene_expr_recon_loss: 13525897.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33697.0469; val_chrom_access_recon_loss: 5485757.0625; val_global_loss: 21913789.5000; val_optim_loss: 21913789.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9257; val_auprc_score: 0.8992; val_best_acc_score: 0.8710; val_best_f1_score: 0.8784; train_kl_reg_loss: 89655.9607; train_edge_recon_loss: 2758310.4508; train_gene_expr_recon_loss: 13727841.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32615.8368; train_chrom_access_recon_loss: 5684251.7500; train_global_loss: 22292675.3939; train_optim_loss: 22292675.3939; val_kl_reg_loss: 79235.5537; val_edge_recon_loss: 2775204.7188; val_gene_expr_recon_loss: 13420306.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31675.2188; val_chrom_access_recon_loss: 5467487.3125; val_global_loss: 21773908.2500; val_optim_loss: 21773908.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9238; val_auprc_score: 0.8951; val_best_acc_score: 0.8694; val_best_f1_score: 0.8768; train_kl_reg_loss: 90776.9304; train_edge_recon_loss: 2767052.1439; train_gene_expr_recon_loss: 13621900.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31168.4180; train_chrom_access_recon_loss: 5581967.9470; train_global_loss: 22092866.4545; train_optim_loss: 22092866.4545; val_kl_reg_loss: 79291.5977; val_edge_recon_loss: 2794815.1562; val_gene_expr_recon_loss: 13527420.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30730.6270; val_chrom_access_recon_loss: 5496300.8125; val_global_loss: 21928559.0000; val_optim_loss: 21928559.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9198; val_auprc_score: 0.8900; val_best_acc_score: 0.8622; val_best_f1_score: 0.8717; train_kl_reg_loss: 90123.5524; train_edge_recon_loss: 2773960.0758; train_gene_expr_recon_loss: 13592242.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30452.7057; train_chrom_access_recon_loss: 5562073.3485; train_global_loss: 22048851.9697; train_optim_loss: 22048851.9697; val_kl_reg_loss: 78391.9785; val_edge_recon_loss: 2806795.9062; val_gene_expr_recon_loss: 13325150.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30196.3984; val_chrom_access_recon_loss: 5428182.0625; val_global_loss: 21668716.0000; val_optim_loss: 21668716.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9225; val_auprc_score: 0.8970; val_best_acc_score: 0.8675; val_best_f1_score: 0.8753; train_kl_reg_loss: 90062.1364; train_edge_recon_loss: 2766359.1250; train_gene_expr_recon_loss: 13592982.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29999.8959; train_chrom_access_recon_loss: 5560598.8788; train_global_loss: 22040002.0303; train_optim_loss: 22040002.0303; val_kl_reg_loss: 78281.2695; val_edge_recon_loss: 2790430.0312; val_gene_expr_recon_loss: 13517010.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29815.5586; val_chrom_access_recon_loss: 5490681.5625; val_global_loss: 21906220.2500; val_optim_loss: 21906220.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9246; val_auprc_score: 0.8994; val_best_acc_score: 0.8692; val_best_f1_score: 0.8777; train_kl_reg_loss: 89303.7019; train_edge_recon_loss: 2762434.0379; train_gene_expr_recon_loss: 13585724.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29704.6184; train_chrom_access_recon_loss: 5556959.1742; train_global_loss: 22024126.3636; train_optim_loss: 22024126.3636; val_kl_reg_loss: 77422.3320; val_edge_recon_loss: 2814057.0938; val_gene_expr_recon_loss: 13400061.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29575.9941; val_chrom_access_recon_loss: 5455065.1250; val_global_loss: 21776182.0000; val_optim_loss: 21776182.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9210; val_auprc_score: 0.8921; val_best_acc_score: 0.8667; val_best_f1_score: 0.8749; train_kl_reg_loss: 88750.3526; train_edge_recon_loss: 2752551.5038; train_gene_expr_recon_loss: 13571919.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29471.6214; train_chrom_access_recon_loss: 5553920.2955; train_global_loss: 21996613.0303; train_optim_loss: 21996613.0303; val_kl_reg_loss: 78709.6865; val_edge_recon_loss: 2786373.7812; val_gene_expr_recon_loss: 13416557.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29380.2734; val_chrom_access_recon_loss: 5425930.9375; val_global_loss: 21736951.5000; val_optim_loss: 21736951.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9197; val_auprc_score: 0.8911; val_best_acc_score: 0.8643; val_best_f1_score: 0.8716; train_kl_reg_loss: 88726.2540; train_edge_recon_loss: 2767919.2311; train_gene_expr_recon_loss: 13558012.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29325.7527; train_chrom_access_recon_loss: 5547174.9697; train_global_loss: 21991158.5758; train_optim_loss: 21991158.5758; val_kl_reg_loss: 77964.8086; val_edge_recon_loss: 2811834.2812; val_gene_expr_recon_loss: 13442120.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29256.2617; val_chrom_access_recon_loss: 5437327.8125; val_global_loss: 21798503.5000; val_optim_loss: 21798503.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9179; val_auprc_score: 0.8833; val_best_acc_score: 0.8662; val_best_f1_score: 0.8732; train_kl_reg_loss: 88210.2598; train_edge_recon_loss: 2759388.5227; train_gene_expr_recon_loss: 13570462.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28981.8755; train_chrom_access_recon_loss: 5550552.8636; train_global_loss: 21997596.3636; train_optim_loss: 21997596.3636; val_kl_reg_loss: 78023.9854; val_edge_recon_loss: 2805174.5625; val_gene_expr_recon_loss: 13442145.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28915.4238; val_chrom_access_recon_loss: 5426420.3750; val_global_loss: 21780679.0000; val_optim_loss: 21780679.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9224; val_auprc_score: 0.8911; val_best_acc_score: 0.8700; val_best_f1_score: 0.8765; train_kl_reg_loss: 88038.5056; train_edge_recon_loss: 2763945.8447; train_gene_expr_recon_loss: 13564114.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28898.5027; train_chrom_access_recon_loss: 5548532.1894; train_global_loss: 21993529.4545; train_optim_loss: 21993529.4545; val_kl_reg_loss: 78175.1201; val_edge_recon_loss: 2786677.3750; val_gene_expr_recon_loss: 13356733.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28883.0078; val_chrom_access_recon_loss: 5409802.2500; val_global_loss: 21660272.2500; val_optim_loss: 21660272.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9218; val_auprc_score: 0.8890; val_best_acc_score: 0.8641; val_best_f1_score: 0.8744; train_kl_reg_loss: 88196.2086; train_edge_recon_loss: 2769039.6439; train_gene_expr_recon_loss: 13567650.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28869.6075; train_chrom_access_recon_loss: 5550106.2652; train_global_loss: 22003862.8182; train_optim_loss: 22003862.8182; val_kl_reg_loss: 77616.2852; val_edge_recon_loss: 2793126.2500; val_gene_expr_recon_loss: 13388875.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28857.0898; val_chrom_access_recon_loss: 5405176.6875; val_global_loss: 21693652.2500; val_optim_loss: 21693652.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9202; val_auprc_score: 0.8895; val_best_acc_score: 0.8662; val_best_f1_score: 0.8749; train_kl_reg_loss: 87881.6853; train_edge_recon_loss: 2769149.6439; train_gene_expr_recon_loss: 13572484.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28848.0268; train_chrom_access_recon_loss: 5550246.6515; train_global_loss: 22008610.3939; train_optim_loss: 22008610.3939; val_kl_reg_loss: 77391.8076; val_edge_recon_loss: 2791736.4375; val_gene_expr_recon_loss: 13343801.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28837.7500; val_chrom_access_recon_loss: 5407155.1250; val_global_loss: 21648922.2500; val_optim_loss: 21648922.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9233; val_auprc_score: 0.9018; val_best_acc_score: 0.8673; val_best_f1_score: 0.8755; train_kl_reg_loss: 87898.8107; train_edge_recon_loss: 2756417.9053; train_gene_expr_recon_loss: 13558067.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28828.1254; train_chrom_access_recon_loss: 5546884.9924; train_global_loss: 21978097.4242; train_optim_loss: 21978097.4242; val_kl_reg_loss: 77351.7783; val_edge_recon_loss: 2808180.0938; val_gene_expr_recon_loss: 13389514.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28818.0020; val_chrom_access_recon_loss: 5432215.0000; val_global_loss: 21736080.2500; val_optim_loss: 21736080.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9235; val_auprc_score: 0.9029; val_best_acc_score: 0.8673; val_best_f1_score: 0.8754; train_kl_reg_loss: 87869.2507; train_edge_recon_loss: 2761664.8636; train_gene_expr_recon_loss: 13569960.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28810.4606; train_chrom_access_recon_loss: 5549807.5909; train_global_loss: 21998112.6970; train_optim_loss: 21998112.6970; val_kl_reg_loss: 77354.2490; val_edge_recon_loss: 2789992.2812; val_gene_expr_recon_loss: 13468884.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28800.4727; val_chrom_access_recon_loss: 5446669.9375; val_global_loss: 21811700.2500; val_optim_loss: 21811700.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9314; val_auprc_score: 0.9044; val_best_acc_score: 0.8759; val_best_f1_score: 0.8826; train_kl_reg_loss: 88007.8442; train_edge_recon_loss: 2760577.5076; train_gene_expr_recon_loss: 13561048.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28793.4031; train_chrom_access_recon_loss: 5543317.7273; train_global_loss: 21981745.2727; train_optim_loss: 21981745.2727; val_kl_reg_loss: 77180.7441; val_edge_recon_loss: 2755991.8438; val_gene_expr_recon_loss: 13367086.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28783.8203; val_chrom_access_recon_loss: 5392220.3750; val_global_loss: 21621263.2500; val_optim_loss: 21621263.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9254; val_auprc_score: 0.8987; val_best_acc_score: 0.8673; val_best_f1_score: 0.8759; train_kl_reg_loss: 87811.3219; train_edge_recon_loss: 2761706.6250; train_gene_expr_recon_loss: 13555550.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28776.3783; train_chrom_access_recon_loss: 5540576.6667; train_global_loss: 21974421.1818; train_optim_loss: 21974421.1818; val_kl_reg_loss: 77830.9492; val_edge_recon_loss: 2796204.6875; val_gene_expr_recon_loss: 13352987.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28767.4043; val_chrom_access_recon_loss: 5399631.8750; val_global_loss: 21655422.2500; val_optim_loss: 21655422.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9240; val_auprc_score: 0.8968; val_best_acc_score: 0.8713; val_best_f1_score: 0.8795; train_kl_reg_loss: 87605.4004; train_edge_recon_loss: 2756975.4962; train_gene_expr_recon_loss: 13553691.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28760.9247; train_chrom_access_recon_loss: 5533292.4545; train_global_loss: 21960326.0606; train_optim_loss: 21960326.0606; val_kl_reg_loss: 76687.6641; val_edge_recon_loss: 2820878.2812; val_gene_expr_recon_loss: 13448373.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28752.4629; val_chrom_access_recon_loss: 5457062.1875; val_global_loss: 21831753.5000; val_optim_loss: 21831753.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9206; val_auprc_score: 0.8884; val_best_acc_score: 0.8638; val_best_f1_score: 0.8733; train_kl_reg_loss: 87739.8442; train_edge_recon_loss: 2765100.0076; train_gene_expr_recon_loss: 13567624.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28742.5555; train_chrom_access_recon_loss: 5548203.0076; train_global_loss: 21997409.4848; train_optim_loss: 21997409.4848; val_kl_reg_loss: 77485.3643; val_edge_recon_loss: 2786568.8125; val_gene_expr_recon_loss: 13359194.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28734.6855; val_chrom_access_recon_loss: 5398129.0625; val_global_loss: 21650112.7500; val_optim_loss: 21650112.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9253; val_auprc_score: 0.8943; val_best_acc_score: 0.8694; val_best_f1_score: 0.8767; train_kl_reg_loss: 87915.3701; train_edge_recon_loss: 2760048.0189; train_gene_expr_recon_loss: 13559460.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28727.6607; train_chrom_access_recon_loss: 5535700.3636; train_global_loss: 21971852.0909; train_optim_loss: 21971852.0909; val_kl_reg_loss: 77856.7793; val_edge_recon_loss: 2788614.4375; val_gene_expr_recon_loss: 13378778.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28718.2500; val_chrom_access_recon_loss: 5409213.7500; val_global_loss: 21683181.2500; val_optim_loss: 21683181.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9244; val_auprc_score: 0.8998; val_best_acc_score: 0.8673; val_best_f1_score: 0.8743; train_kl_reg_loss: 87738.0214; train_edge_recon_loss: 2758456.4545; train_gene_expr_recon_loss: 13554031.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28689.2720; train_chrom_access_recon_loss: 5537219.5985; train_global_loss: 21966134.6061; train_optim_loss: 21966134.6061; val_kl_reg_loss: 77314.2764; val_edge_recon_loss: 2803858.2188; val_gene_expr_recon_loss: 13277352.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28682.8086; val_chrom_access_recon_loss: 5364470.0625; val_global_loss: 21551678.2500; val_optim_loss: 21551678.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9279; val_auprc_score: 0.9026; val_best_acc_score: 0.8718; val_best_f1_score: 0.8797; train_kl_reg_loss: 87796.9690; train_edge_recon_loss: 2760641.2159; train_gene_expr_recon_loss: 13548875.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28681.3043; train_chrom_access_recon_loss: 5532992.1212; train_global_loss: 21958987.4545; train_optim_loss: 21958987.4545; val_kl_reg_loss: 77753.0693; val_edge_recon_loss: 2779886.8438; val_gene_expr_recon_loss: 13351143.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28679.8281; val_chrom_access_recon_loss: 5441981.8750; val_global_loss: 21679444.7500; val_optim_loss: 21679444.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9202; val_auprc_score: 0.8884; val_best_acc_score: 0.8649; val_best_f1_score: 0.8744; train_kl_reg_loss: 87735.1683; train_edge_recon_loss: 2764024.6970; train_gene_expr_recon_loss: 13564887.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28678.5091; train_chrom_access_recon_loss: 5541396.2121; train_global_loss: 21986721.7879; train_optim_loss: 21986721.7879; val_kl_reg_loss: 77953.4482; val_edge_recon_loss: 2818896.3750; val_gene_expr_recon_loss: 13450658.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28677.2012; val_chrom_access_recon_loss: 5451321.8125; val_global_loss: 21827507.5000; val_optim_loss: 21827507.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9205; val_auprc_score: 0.8884; val_best_acc_score: 0.8665; val_best_f1_score: 0.8744; train_kl_reg_loss: 87777.5342; train_edge_recon_loss: 2756565.6553; train_gene_expr_recon_loss: 13573855.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28676.1481; train_chrom_access_recon_loss: 5545522.6288; train_global_loss: 21992396.8182; train_optim_loss: 21992396.8182; val_kl_reg_loss: 77693.0674; val_edge_recon_loss: 2790750.4688; val_gene_expr_recon_loss: 13380754.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28674.9199; val_chrom_access_recon_loss: 5445100.8750; val_global_loss: 21722974.0000; val_optim_loss: 21722974.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9277; val_auprc_score: 0.9025; val_best_acc_score: 0.8732; val_best_f1_score: 0.8801; train_kl_reg_loss: 87805.1565; train_edge_recon_loss: 2762762.6174; train_gene_expr_recon_loss: 13560267.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28673.7583; train_chrom_access_recon_loss: 5534892.7273; train_global_loss: 21974401.2424; train_optim_loss: 21974401.2424; val_kl_reg_loss: 77973.2988; val_edge_recon_loss: 2773259.2188; val_gene_expr_recon_loss: 13555183.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28672.6738; val_chrom_access_recon_loss: 5536032.7500; val_global_loss: 21971121.7500; val_optim_loss: 21971121.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9156; val_auprc_score: 0.8883; val_best_acc_score: 0.8579; val_best_f1_score: 0.8675; train_kl_reg_loss: 87912.2749; train_edge_recon_loss: 2752179.3485; train_gene_expr_recon_loss: 13566650.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28669.5653; train_chrom_access_recon_loss: 5541324.6894; train_global_loss: 21976736.5152; train_optim_loss: 21976736.5152; val_kl_reg_loss: 77259.1426; val_edge_recon_loss: 2851153.4688; val_gene_expr_recon_loss: 13343034.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28668.8477; val_chrom_access_recon_loss: 5469622.0625; val_global_loss: 21769737.7500; val_optim_loss: 21769737.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9215; val_auprc_score: 0.8923; val_best_acc_score: 0.8662; val_best_f1_score: 0.8755; train_kl_reg_loss: 87616.6473; train_edge_recon_loss: 2751843.0568; train_gene_expr_recon_loss: 13547169.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28668.6903; train_chrom_access_recon_loss: 5533021.1970; train_global_loss: 21948318.9697; train_optim_loss: 21948318.9697; val_kl_reg_loss: 77805.7842; val_edge_recon_loss: 2793566.5938; val_gene_expr_recon_loss: 13439239.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28668.5312; val_chrom_access_recon_loss: 5476177.8750; val_global_loss: 21815458.5000; val_optim_loss: 21815458.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9258; val_auprc_score: 0.9061; val_best_acc_score: 0.8659; val_best_f1_score: 0.8751; train_kl_reg_loss: 87813.8407; train_edge_recon_loss: 2756065.6061; train_gene_expr_recon_loss: 13561298.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28668.3878; train_chrom_access_recon_loss: 5539913.3864; train_global_loss: 21973759.3636; train_optim_loss: 21973759.3636; val_kl_reg_loss: 77544.4062; val_edge_recon_loss: 2781330.3125; val_gene_expr_recon_loss: 13358042.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28668.2383; val_chrom_access_recon_loss: 5434369.2500; val_global_loss: 21679954.5000; val_optim_loss: 21679954.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9332; val_auprc_score: 0.9134; val_best_acc_score: 0.8764; val_best_f1_score: 0.8839; train_kl_reg_loss: 87710.7827; train_edge_recon_loss: 2752472.7311; train_gene_expr_recon_loss: 13551401.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28668.1215; train_chrom_access_recon_loss: 5531532.3939; train_global_loss: 21951785.6061; train_optim_loss: 21951785.6061; val_kl_reg_loss: 77726.9775; val_edge_recon_loss: 2773196.5000; val_gene_expr_recon_loss: 13392369.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28667.9863; val_chrom_access_recon_loss: 5446153.6250; val_global_loss: 21718114.5000; val_optim_loss: 21718114.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 8 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9258
val AUPRC score: 0.9017
val best accuracy score: 0.8710
val best F1 score: 0.8770
val target rna MSE score: 1.0356
val source rna MSE score: 0.3166
val target atac MSE score: 0.4662
val source atac MSE score: 0.1054
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
