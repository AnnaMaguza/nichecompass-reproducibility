[True]
Run timestamp: 10082023_205704_48.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_48']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7142; val_auprc_score: 0.7475; val_best_acc_score: 0.5217; val_best_f1_score: 0.6748; train_kl_reg_loss: 107282.4544; train_edge_recon_loss: 3746183.5401; train_gene_expr_recon_loss: 27397603.3740; train_masked_gp_l1_reg_loss: 81174.7699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241852.8628; train_chrom_access_recon_loss: 27476086.4885; train_global_loss: 59050183.4809; train_optim_loss: 59050183.4809; val_kl_reg_loss: 105139.9667; val_edge_recon_loss: 4063969.4667; val_gene_expr_recon_loss: 23379859.8667; val_masked_gp_l1_reg_loss: 78453.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233327.2031; val_chrom_access_recon_loss: 25951663.7333; val_global_loss: 53812415.2000; val_optim_loss: 53812415.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7647; val_auprc_score: 0.7884; val_best_acc_score: 0.6328; val_best_f1_score: 0.7096; train_kl_reg_loss: 153979.1704; train_edge_recon_loss: 3679015.3531; train_gene_expr_recon_loss: 23135480.1985; train_masked_gp_l1_reg_loss: 77247.6545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 222892.2443; train_chrom_access_recon_loss: 25929682.7939; train_global_loss: 53198297.3435; train_optim_loss: 53198297.3435; val_kl_reg_loss: 152246.6073; val_edge_recon_loss: 4054623.2000; val_gene_expr_recon_loss: 22486884.6667; val_masked_gp_l1_reg_loss: 74550.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 211483.5469; val_chrom_access_recon_loss: 25552872.0000; val_global_loss: 52532660.2667; val_optim_loss: 52532660.2667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8592; val_auprc_score: 0.8612; val_best_acc_score: 0.7513; val_best_f1_score: 0.7848; train_kl_reg_loss: 162669.1381; train_edge_recon_loss: 3555785.3378; train_gene_expr_recon_loss: 22248627.3282; train_masked_gp_l1_reg_loss: 73952.6678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200317.1861; train_chrom_access_recon_loss: 25512707.2214; train_global_loss: 51754058.9313; train_optim_loss: 51754058.9313; val_kl_reg_loss: 150503.4104; val_edge_recon_loss: 3911512.7833; val_gene_expr_recon_loss: 22059974.1333; val_masked_gp_l1_reg_loss: 74096.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189252.1562; val_chrom_access_recon_loss: 25327762.0000; val_global_loss: 51713100.5333; val_optim_loss: 51713100.5333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8954; val_auprc_score: 0.8845; val_best_acc_score: 0.8104; val_best_f1_score: 0.8241; train_kl_reg_loss: 144941.0627; train_edge_recon_loss: 3319955.6450; train_gene_expr_recon_loss: 22034368.8397; train_masked_gp_l1_reg_loss: 75694.7084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 179092.1814; train_chrom_access_recon_loss: 25350904.8702; train_global_loss: 51104957.3740; train_optim_loss: 51104957.3740; val_kl_reg_loss: 174101.6094; val_edge_recon_loss: 3035628.1833; val_gene_expr_recon_loss: 22005915.2000; val_masked_gp_l1_reg_loss: 77939.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169295.1406; val_chrom_access_recon_loss: 25352714.2667; val_global_loss: 50815595.4667; val_optim_loss: 50815595.4667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9046; val_auprc_score: 0.8892; val_best_acc_score: 0.8235; val_best_f1_score: 0.8390; train_kl_reg_loss: 182477.0762; train_edge_recon_loss: 2988140.2099; train_gene_expr_recon_loss: 21873572.2595; train_masked_gp_l1_reg_loss: 78816.7969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160729.3027; train_chrom_access_recon_loss: 25217568.3817; train_global_loss: 50501304.0000; train_optim_loss: 50501304.0000; val_kl_reg_loss: 181996.3802; val_edge_recon_loss: 2978611.5167; val_gene_expr_recon_loss: 21772900.4000; val_masked_gp_l1_reg_loss: 80120.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152563.2500; val_chrom_access_recon_loss: 25092316.5333; val_global_loss: 50258509.3333; val_optim_loss: 50258509.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9191; val_auprc_score: 0.9047; val_best_acc_score: 0.8471; val_best_f1_score: 0.8558; train_kl_reg_loss: 180769.6824; train_edge_recon_loss: 2931974.3989; train_gene_expr_recon_loss: 21721280.5649; train_masked_gp_l1_reg_loss: 81302.8028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145743.2053; train_chrom_access_recon_loss: 25109397.5115; train_global_loss: 50170468.2443; train_optim_loss: 50170468.2443; val_kl_reg_loss: 182513.2833; val_edge_recon_loss: 2931392.8167; val_gene_expr_recon_loss: 21661029.0667; val_masked_gp_l1_reg_loss: 82544.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139286.5312; val_chrom_access_recon_loss: 25005745.2000; val_global_loss: 50002509.8667; val_optim_loss: 50002509.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9301; val_auprc_score: 0.9151; val_best_acc_score: 0.8642; val_best_f1_score: 0.8715; train_kl_reg_loss: 172607.4145; train_edge_recon_loss: 2907912.1794; train_gene_expr_recon_loss: 21591381.6947; train_masked_gp_l1_reg_loss: 83847.3638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133339.3927; train_chrom_access_recon_loss: 24983966.2290; train_global_loss: 49873054.3511; train_optim_loss: 49873054.3511; val_kl_reg_loss: 164754.5302; val_edge_recon_loss: 2876580.4667; val_gene_expr_recon_loss: 21547135.2000; val_masked_gp_l1_reg_loss: 84877.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127557.9062; val_chrom_access_recon_loss: 24855197.6000; val_global_loss: 49656102.9333; val_optim_loss: 49656102.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9345; val_auprc_score: 0.9204; val_best_acc_score: 0.8689; val_best_f1_score: 0.8769; train_kl_reg_loss: 166120.1796; train_edge_recon_loss: 2880315.2729; train_gene_expr_recon_loss: 21495344.3053; train_masked_gp_l1_reg_loss: 86275.9612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122436.3986; train_chrom_access_recon_loss: 24889084.3969; train_global_loss: 49639576.3664; train_optim_loss: 49639576.3664; val_kl_reg_loss: 163805.7135; val_edge_recon_loss: 2873810.1833; val_gene_expr_recon_loss: 21416405.0667; val_masked_gp_l1_reg_loss: 87536.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117492.0781; val_chrom_access_recon_loss: 24829754.1333; val_global_loss: 49488803.4667; val_optim_loss: 49488803.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9396; val_auprc_score: 0.9256; val_best_acc_score: 0.8774; val_best_f1_score: 0.8840; train_kl_reg_loss: 158920.2244; train_edge_recon_loss: 2859036.9599; train_gene_expr_recon_loss: 21375993.0229; train_masked_gp_l1_reg_loss: 88564.7372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112855.1067; train_chrom_access_recon_loss: 24792059.0382; train_global_loss: 49387429.3435; train_optim_loss: 49387429.3435; val_kl_reg_loss: 156466.0427; val_edge_recon_loss: 2881453.2667; val_gene_expr_recon_loss: 21331696.0000; val_masked_gp_l1_reg_loss: 89605.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108414.6641; val_chrom_access_recon_loss: 24752644.1333; val_global_loss: 49320279.4667; val_optim_loss: 49320279.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9472; val_auprc_score: 0.9365; val_best_acc_score: 0.8852; val_best_f1_score: 0.8895; train_kl_reg_loss: 153747.5064; train_edge_recon_loss: 2850589.4275; train_gene_expr_recon_loss: 21255550.1985; train_masked_gp_l1_reg_loss: 90649.3372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104388.7374; train_chrom_access_recon_loss: 24665833.7557; train_global_loss: 49120758.8092; train_optim_loss: 49120758.8092; val_kl_reg_loss: 149530.0677; val_edge_recon_loss: 2846956.5000; val_gene_expr_recon_loss: 21305579.8667; val_masked_gp_l1_reg_loss: 91948.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100640.3984; val_chrom_access_recon_loss: 24736080.9333; val_global_loss: 49230735.2000; val_optim_loss: 49230735.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9477; val_auprc_score: 0.9329; val_best_acc_score: 0.8879; val_best_f1_score: 0.8945; train_kl_reg_loss: 148586.4469; train_edge_recon_loss: 2825441.6107; train_gene_expr_recon_loss: 21211499.1908; train_masked_gp_l1_reg_loss: 92853.8376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97155.3049; train_chrom_access_recon_loss: 24647306.4122; train_global_loss: 49022842.9618; train_optim_loss: 49022842.9618; val_kl_reg_loss: 148251.7906; val_edge_recon_loss: 2817977.8833; val_gene_expr_recon_loss: 21127491.2000; val_masked_gp_l1_reg_loss: 93973.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93915.4609; val_chrom_access_recon_loss: 24553537.3333; val_global_loss: 48835148.2667; val_optim_loss: 48835148.2667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9506; val_auprc_score: 0.9384; val_best_acc_score: 0.8894; val_best_f1_score: 0.8953; train_kl_reg_loss: 145055.1927; train_edge_recon_loss: 2821834.6832; train_gene_expr_recon_loss: 21153754.3664; train_masked_gp_l1_reg_loss: 94783.8339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91078.7715; train_chrom_access_recon_loss: 24601613.3282; train_global_loss: 48908120.2443; train_optim_loss: 48908120.2443; val_kl_reg_loss: 141558.4448; val_edge_recon_loss: 2819430.5333; val_gene_expr_recon_loss: 21173609.2000; val_masked_gp_l1_reg_loss: 95570.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88299.8984; val_chrom_access_recon_loss: 24489273.4667; val_global_loss: 48807742.4000; val_optim_loss: 48807742.4000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9493; val_auprc_score: 0.9369; val_best_acc_score: 0.8852; val_best_f1_score: 0.8926; train_kl_reg_loss: 141260.4677; train_edge_recon_loss: 2804690.0382; train_gene_expr_recon_loss: 21070702.7023; train_masked_gp_l1_reg_loss: 96571.2528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85943.8551; train_chrom_access_recon_loss: 24520200.0458; train_global_loss: 48719368.2748; train_optim_loss: 48719368.2748; val_kl_reg_loss: 141872.6281; val_edge_recon_loss: 2833099.4500; val_gene_expr_recon_loss: 20977589.2000; val_masked_gp_l1_reg_loss: 97720.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83681.1250; val_chrom_access_recon_loss: 24386152.9333; val_global_loss: 48520116.5333; val_optim_loss: 48520116.5333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9553; val_auprc_score: 0.9439; val_best_acc_score: 0.8963; val_best_f1_score: 0.9016; train_kl_reg_loss: 138637.0453; train_edge_recon_loss: 2788708.9198; train_gene_expr_recon_loss: 21020553.2519; train_masked_gp_l1_reg_loss: 98506.2728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81700.8843; train_chrom_access_recon_loss: 24476667.1145; train_global_loss: 48604773.1908; train_optim_loss: 48604773.1908; val_kl_reg_loss: 137549.7990; val_edge_recon_loss: 2790345.4167; val_gene_expr_recon_loss: 21050760.6667; val_masked_gp_l1_reg_loss: 99367.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79799.9141; val_chrom_access_recon_loss: 24471779.2000; val_global_loss: 48629602.9333; val_optim_loss: 48629602.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9552; val_auprc_score: 0.9436; val_best_acc_score: 0.8946; val_best_f1_score: 0.9000; train_kl_reg_loss: 134787.9382; train_edge_recon_loss: 2783411.4523; train_gene_expr_recon_loss: 20979465.4198; train_masked_gp_l1_reg_loss: 100251.8130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77808.7037; train_chrom_access_recon_loss: 24441866.8702; train_global_loss: 48517591.9695; train_optim_loss: 48517591.9695; val_kl_reg_loss: 130398.1099; val_edge_recon_loss: 2790582.2333; val_gene_expr_recon_loss: 20994444.6667; val_masked_gp_l1_reg_loss: 101216.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75943.0312; val_chrom_access_recon_loss: 24455324.8000; val_global_loss: 48547908.8000; val_optim_loss: 48547908.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9579; val_auprc_score: 0.9469; val_best_acc_score: 0.8984; val_best_f1_score: 0.9042; train_kl_reg_loss: 133286.6966; train_edge_recon_loss: 2774388.7672; train_gene_expr_recon_loss: 20940022.5954; train_masked_gp_l1_reg_loss: 102407.6512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74178.3498; train_chrom_access_recon_loss: 24410310.9466; train_global_loss: 48434594.9924; train_optim_loss: 48434594.9924; val_kl_reg_loss: 130319.2240; val_edge_recon_loss: 2795234.4500; val_gene_expr_recon_loss: 20960628.1333; val_masked_gp_l1_reg_loss: 104013.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72404.5156; val_chrom_access_recon_loss: 24385280.5333; val_global_loss: 48447881.0667; val_optim_loss: 48447881.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9614; val_auprc_score: 0.9528; val_best_acc_score: 0.9022; val_best_f1_score: 0.9056; train_kl_reg_loss: 129358.9190; train_edge_recon_loss: 2776090.6240; train_gene_expr_recon_loss: 20890424.9771; train_masked_gp_l1_reg_loss: 104600.1850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70728.3124; train_chrom_access_recon_loss: 24362765.8168; train_global_loss: 48333968.8550; train_optim_loss: 48333968.8550; val_kl_reg_loss: 128847.4484; val_edge_recon_loss: 2795269.0833; val_gene_expr_recon_loss: 20881344.9333; val_masked_gp_l1_reg_loss: 105179.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69098.6641; val_chrom_access_recon_loss: 24368212.6667; val_global_loss: 48347952.0000; val_optim_loss: 48347952.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9623; val_auprc_score: 0.9508; val_best_acc_score: 0.9034; val_best_f1_score: 0.9088; train_kl_reg_loss: 127327.6734; train_edge_recon_loss: 2765160.3531; train_gene_expr_recon_loss: 20856685.7405; train_masked_gp_l1_reg_loss: 105946.6450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67675.0488; train_chrom_access_recon_loss: 24337683.4504; train_global_loss: 48260478.9618; train_optim_loss: 48260478.9618; val_kl_reg_loss: 128513.5880; val_edge_recon_loss: 2785729.3833; val_gene_expr_recon_loss: 20815075.4667; val_masked_gp_l1_reg_loss: 106629.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66230.8359; val_chrom_access_recon_loss: 24270367.8667; val_global_loss: 48172546.6667; val_optim_loss: 48172546.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9640; val_auprc_score: 0.9548; val_best_acc_score: 0.9078; val_best_f1_score: 0.9115; train_kl_reg_loss: 125911.9804; train_edge_recon_loss: 2766737.8683; train_gene_expr_recon_loss: 20796963.4351; train_masked_gp_l1_reg_loss: 107315.1824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64982.5381; train_chrom_access_recon_loss: 24279734.2443; train_global_loss: 48141645.0687; train_optim_loss: 48141645.0687; val_kl_reg_loss: 124229.5354; val_edge_recon_loss: 2768807.4000; val_gene_expr_recon_loss: 20805169.2000; val_masked_gp_l1_reg_loss: 107947.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63659.3438; val_chrom_access_recon_loss: 24279321.3333; val_global_loss: 48149135.4667; val_optim_loss: 48149135.4667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9690; val_auprc_score: 0.9625; val_best_acc_score: 0.9130; val_best_f1_score: 0.9171; train_kl_reg_loss: 123779.1950; train_edge_recon_loss: 2754717.5248; train_gene_expr_recon_loss: 20795108.6412; train_masked_gp_l1_reg_loss: 108652.1963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62486.4533; train_chrom_access_recon_loss: 24274192.9466; train_global_loss: 48118937.0382; train_optim_loss: 48118937.0382; val_kl_reg_loss: 120349.9729; val_edge_recon_loss: 2765734.1500; val_gene_expr_recon_loss: 20739053.6000; val_masked_gp_l1_reg_loss: 109284.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61260.9297; val_chrom_access_recon_loss: 24140618.9333; val_global_loss: 47936300.5333; val_optim_loss: 47936300.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9737; val_auprc_score: 0.9682; val_best_acc_score: 0.9225; val_best_f1_score: 0.9244; train_kl_reg_loss: 121961.2388; train_edge_recon_loss: 2754544.8302; train_gene_expr_recon_loss: 20768535.7863; train_masked_gp_l1_reg_loss: 110052.8870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60175.8635; train_chrom_access_recon_loss: 24270918.9771; train_global_loss: 48086189.5573; train_optim_loss: 48086189.5573; val_kl_reg_loss: 120873.0583; val_edge_recon_loss: 2740946.8833; val_gene_expr_recon_loss: 20815763.2000; val_masked_gp_l1_reg_loss: 110776.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59111.8398; val_chrom_access_recon_loss: 24252666.6667; val_global_loss: 48100138.1333; val_optim_loss: 48100138.1333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9716; val_auprc_score: 0.9644; val_best_acc_score: 0.9232; val_best_f1_score: 0.9249; train_kl_reg_loss: 121049.3969; train_edge_recon_loss: 2743046.6031; train_gene_expr_recon_loss: 20745666.5649; train_masked_gp_l1_reg_loss: 111526.8887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58162.4902; train_chrom_access_recon_loss: 24246426.5038; train_global_loss: 48025878.5344; train_optim_loss: 48025878.5344; val_kl_reg_loss: 121522.2750; val_edge_recon_loss: 2754519.4500; val_gene_expr_recon_loss: 20734767.0667; val_masked_gp_l1_reg_loss: 112177.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57162.4375; val_chrom_access_recon_loss: 24206269.0667; val_global_loss: 47986417.0667; val_optim_loss: 47986417.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9737; val_auprc_score: 0.9644; val_best_acc_score: 0.9252; val_best_f1_score: 0.9284; train_kl_reg_loss: 118181.7977; train_edge_recon_loss: 2751115.5172; train_gene_expr_recon_loss: 20692911.3282; train_masked_gp_l1_reg_loss: 112969.7703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56213.9012; train_chrom_access_recon_loss: 24214010.0305; train_global_loss: 47945402.1374; train_optim_loss: 47945402.1374; val_kl_reg_loss: 116327.0865; val_edge_recon_loss: 2743626.6667; val_gene_expr_recon_loss: 20781920.4000; val_masked_gp_l1_reg_loss: 113833.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55330.1758; val_chrom_access_recon_loss: 24283365.6000; val_global_loss: 48094403.7333; val_optim_loss: 48094403.7333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9749; val_auprc_score: 0.9675; val_best_acc_score: 0.9264; val_best_f1_score: 0.9290; train_kl_reg_loss: 117167.8076; train_edge_recon_loss: 2743514.6393; train_gene_expr_recon_loss: 20664034.2443; train_masked_gp_l1_reg_loss: 114513.1771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54462.8627; train_chrom_access_recon_loss: 24163169.5573; train_global_loss: 47856862.1374; train_optim_loss: 47856862.1374; val_kl_reg_loss: 116885.2724; val_edge_recon_loss: 2739533.8667; val_gene_expr_recon_loss: 20751573.6000; val_masked_gp_l1_reg_loss: 115343.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53655.3398; val_chrom_access_recon_loss: 24295860.9333; val_global_loss: 48072854.1333; val_optim_loss: 48072854.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9739; val_auprc_score: 0.9672; val_best_acc_score: 0.9256; val_best_f1_score: 0.9285; train_kl_reg_loss: 117583.1596; train_edge_recon_loss: 2732261.9618; train_gene_expr_recon_loss: 20635154.8244; train_masked_gp_l1_reg_loss: 113310.0728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52933.7406; train_chrom_access_recon_loss: 24167217.6336; train_global_loss: 47818461.3435; train_optim_loss: 47818461.3435; val_kl_reg_loss: 119439.6328; val_edge_recon_loss: 2754621.7833; val_gene_expr_recon_loss: 20712120.8000; val_masked_gp_l1_reg_loss: 112458.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52450.0430; val_chrom_access_recon_loss: 24160540.2667; val_global_loss: 47911629.6000; val_optim_loss: 47911629.6000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9715; val_auprc_score: 0.9650; val_best_acc_score: 0.9213; val_best_f1_score: 0.9241; train_kl_reg_loss: 115884.6775; train_edge_recon_loss: 2957491.1851; train_gene_expr_recon_loss: 22203397.0992; train_masked_gp_l1_reg_loss: 112289.2906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52576.6093; train_chrom_access_recon_loss: 24722831.5420; train_global_loss: 50164470.3206; train_optim_loss: 50164470.3206; val_kl_reg_loss: 35568.0490; val_edge_recon_loss: 2895955.1833; val_gene_expr_recon_loss: 22024993.2000; val_masked_gp_l1_reg_loss: 112442.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52801.8750; val_chrom_access_recon_loss: 24651281.7333; val_global_loss: 49773041.6000; val_optim_loss: 49773041.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9714; val_auprc_score: 0.9641; val_best_acc_score: 0.9170; val_best_f1_score: 0.9197; train_kl_reg_loss: 129688.4552; train_edge_recon_loss: 2876764.6469; train_gene_expr_recon_loss: 22007376.7481; train_masked_gp_l1_reg_loss: 112648.2261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52977.7467; train_chrom_access_recon_loss: 24711709.2519; train_global_loss: 49891165.2214; train_optim_loss: 49891165.2214; val_kl_reg_loss: 38555.9286; val_edge_recon_loss: 2882374.7667; val_gene_expr_recon_loss: 21951158.5333; val_masked_gp_l1_reg_loss: 112826.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53120.5430; val_chrom_access_recon_loss: 24664442.0000; val_global_loss: 49702476.8000; val_optim_loss: 49702476.8000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9735; val_auprc_score: 0.9680; val_best_acc_score: 0.9250; val_best_f1_score: 0.9276; train_kl_reg_loss: 134079.2442; train_edge_recon_loss: 2857788.3302; train_gene_expr_recon_loss: 21899017.2824; train_masked_gp_l1_reg_loss: 112970.4041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53203.6269; train_chrom_access_recon_loss: 24593692.3817; train_global_loss: 49650751.3282; train_optim_loss: 49650751.3282; val_kl_reg_loss: 40387.5477; val_edge_recon_loss: 2840083.3167; val_gene_expr_recon_loss: 21948366.8000; val_masked_gp_l1_reg_loss: 113109.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53259.8516; val_chrom_access_recon_loss: 24620964.8000; val_global_loss: 49616172.0000; val_optim_loss: 49616172.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9736; val_auprc_score: 0.9685; val_best_acc_score: 0.9248; val_best_f1_score: 0.9275; train_kl_reg_loss: 134803.1434; train_edge_recon_loss: 2827182.1565; train_gene_expr_recon_loss: 21916104.7786; train_masked_gp_l1_reg_loss: 113214.4652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53329.4165; train_chrom_access_recon_loss: 24609967.8015; train_global_loss: 49654601.9542; train_optim_loss: 49654601.9542; val_kl_reg_loss: 42832.2883; val_edge_recon_loss: 2844923.8500; val_gene_expr_recon_loss: 21965840.5333; val_masked_gp_l1_reg_loss: 113328.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53395.1484; val_chrom_access_recon_loss: 24501091.6000; val_global_loss: 49521412.2667; val_optim_loss: 49521412.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9721; val_auprc_score: 0.9653; val_best_acc_score: 0.9235; val_best_f1_score: 0.9262; train_kl_reg_loss: 134599.9128; train_edge_recon_loss: 2829309.3969; train_gene_expr_recon_loss: 21929623.6641; train_masked_gp_l1_reg_loss: 113299.8924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53393.0609; train_chrom_access_recon_loss: 24629042.5191; train_global_loss: 49689268.6718; train_optim_loss: 49689268.6718; val_kl_reg_loss: 42996.7031; val_edge_recon_loss: 2833999.2500; val_gene_expr_recon_loss: 22055374.6667; val_masked_gp_l1_reg_loss: 113298.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53392.5352; val_chrom_access_recon_loss: 24616461.7333; val_global_loss: 49715522.9333; val_optim_loss: 49715522.9333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9729; val_auprc_score: 0.9635; val_best_acc_score: 0.9213; val_best_f1_score: 0.9252; train_kl_reg_loss: 134290.1965; train_edge_recon_loss: 2825803.4790; train_gene_expr_recon_loss: 21915710.9313; train_masked_gp_l1_reg_loss: 113300.9574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53391.8746; train_chrom_access_recon_loss: 24589429.3130; train_global_loss: 49631926.8092; train_optim_loss: 49631926.8092; val_kl_reg_loss: 43444.4773; val_edge_recon_loss: 2822867.0833; val_gene_expr_recon_loss: 21990238.8000; val_masked_gp_l1_reg_loss: 113303.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53392.6250; val_chrom_access_recon_loss: 24641277.3333; val_global_loss: 49664524.0000; val_optim_loss: 49664524.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9715; val_auprc_score: 0.9636; val_best_acc_score: 0.9200; val_best_f1_score: 0.9229; train_kl_reg_loss: 134381.1639; train_edge_recon_loss: 2823471.8893; train_gene_expr_recon_loss: 21932400.7023; train_masked_gp_l1_reg_loss: 113304.9457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53393.8784; train_chrom_access_recon_loss: 24601562.8702; train_global_loss: 49658515.2061; train_optim_loss: 49658515.2061; val_kl_reg_loss: 43331.4341; val_edge_recon_loss: 2827385.9833; val_gene_expr_recon_loss: 22002790.8000; val_masked_gp_l1_reg_loss: 113302.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53394.1523; val_chrom_access_recon_loss: 24633874.4000; val_global_loss: 49674079.2000; val_optim_loss: 49674079.2000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9682; val_auprc_score: 0.9608; val_best_acc_score: 0.9153; val_best_f1_score: 0.9186; train_kl_reg_loss: 134352.6475; train_edge_recon_loss: 2825328.9599; train_gene_expr_recon_loss: 21943747.6031; train_masked_gp_l1_reg_loss: 113297.2044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53393.1874; train_chrom_access_recon_loss: 24627288.6412; train_global_loss: 49697408.1832; train_optim_loss: 49697408.1832; val_kl_reg_loss: 43468.4310; val_edge_recon_loss: 2849521.9667; val_gene_expr_recon_loss: 21961512.5333; val_masked_gp_l1_reg_loss: 113293.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53391.8438; val_chrom_access_recon_loss: 24546479.3333; val_global_loss: 49567668.0000; val_optim_loss: 49567668.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 5 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9757
val AUPRC score: 0.9706
val best accuracy score: 0.9267
val best F1 score: 0.9289
val target rna MSE score: 2.9013
val source rna MSE score: 2477.1771
val target atac MSE score: 0.3474
val source atac MSE score: 3.9440
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
