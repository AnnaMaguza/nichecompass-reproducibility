[True, False, True]
Run timestamp: 12102023_161937_31.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000000.0', '--lambda_gene_expr_recon', '300000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_31']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 631979
Number of validation nodes: 70220
Number of training edges: 1492281
Number of validation edges: 165809
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8858; val_auprc_score: 0.9804; val_best_acc_score: 0.9161; val_best_f1_score: 0.9540; train_kl_reg_loss: 50518.6769; train_edge_recon_loss: 64123962.4878; train_gene_expr_recon_loss: 260429909.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 324604390.7787; train_optim_loss: 324604390.7787; val_kl_reg_loss: 48288.2456; val_edge_recon_loss: 64891019.1975; val_gene_expr_recon_loss: 229079932.8395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 294019240.4444; val_optim_loss: 294019240.4444
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8924; val_auprc_score: 0.9817; val_best_acc_score: 0.9153; val_best_f1_score: 0.9533; train_kl_reg_loss: 57919.4050; train_edge_recon_loss: 62049936.2813; train_gene_expr_recon_loss: 218883017.4463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 280990873.2268; train_optim_loss: 280990873.2268; val_kl_reg_loss: 66170.5608; val_edge_recon_loss: 65361228.7654; val_gene_expr_recon_loss: 213036885.0370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 278464284.7901; val_optim_loss: 278464284.7901
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8996; val_auprc_score: 0.9828; val_best_acc_score: 0.9194; val_best_f1_score: 0.9556; train_kl_reg_loss: 77924.3899; train_edge_recon_loss: 61946127.2686; train_gene_expr_recon_loss: 210263568.6257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 272287620.4075; train_optim_loss: 272287620.4075; val_kl_reg_loss: 84873.1350; val_edge_recon_loss: 64506683.7160; val_gene_expr_recon_loss: 208649968.0988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 273241524.8889; val_optim_loss: 273241524.8889
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9048; val_auprc_score: 0.9837; val_best_acc_score: 0.9221; val_best_f1_score: 0.9569; train_kl_reg_loss: 95185.2594; train_edge_recon_loss: 61455039.4552; train_gene_expr_recon_loss: 207188018.7170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 268738243.2549; train_optim_loss: 268738243.2549; val_kl_reg_loss: 104140.8914; val_edge_recon_loss: 64285047.9630; val_gene_expr_recon_loss: 206852938.6173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 271242126.6173; val_optim_loss: 271242126.6173
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9052; val_auprc_score: 0.9839; val_best_acc_score: 0.9232; val_best_f1_score: 0.9576; train_kl_reg_loss: 113624.9743; train_edge_recon_loss: 61270545.8662; train_gene_expr_recon_loss: 205822855.5527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 267207026.5358; train_optim_loss: 267207026.5358; val_kl_reg_loss: 123945.1756; val_edge_recon_loss: 63924747.7654; val_gene_expr_recon_loss: 205015176.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269063868.8889; val_optim_loss: 269063868.8889
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9060; val_auprc_score: 0.9838; val_best_acc_score: 0.9230; val_best_f1_score: 0.9574; train_kl_reg_loss: 131177.0129; train_edge_recon_loss: 61478176.9832; train_gene_expr_recon_loss: 204968402.0583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 266577755.9986; train_optim_loss: 266577755.9986; val_kl_reg_loss: 146308.1183; val_edge_recon_loss: 64229277.5802; val_gene_expr_recon_loss: 204178538.8642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268554124.3951; val_optim_loss: 268554124.3951
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9023; val_auprc_score: 0.9831; val_best_acc_score: 0.9220; val_best_f1_score: 0.9570; train_kl_reg_loss: 400918.3551; train_edge_recon_loss: 61934928.9235; train_gene_expr_recon_loss: 221643450.4508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 283979298.0254; train_optim_loss: 283979298.0254; val_kl_reg_loss: 85033.3301; val_edge_recon_loss: 64413848.4568; val_gene_expr_recon_loss: 218647947.1605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 283146829.1852; val_optim_loss: 283146829.1852
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9093; val_auprc_score: 0.9849; val_best_acc_score: 0.9253; val_best_f1_score: 0.9588; train_kl_reg_loss: 476089875648236340110373683200.0000; train_edge_recon_loss: 61583645.8182; train_gene_expr_recon_loss: 212946312.3870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 476089875648236340110373683200.0000; train_optim_loss: 476089875648236340110373683200.0000; val_kl_reg_loss: 330862813084371506845188096.0000; val_edge_recon_loss: 63046801.9753; val_gene_expr_recon_loss: 206662252.6914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 330862813084371506845188096.0000; val_optim_loss: 330862813084371506845188096.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9116; val_auprc_score: 0.9853; val_best_acc_score: 0.9252; val_best_f1_score: 0.9586; train_kl_reg_loss: 800865894496593675437473792.0000; train_edge_recon_loss: 61238600.4734; train_gene_expr_recon_loss: 204622442.7691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 800865894496593675437473792.0000; train_optim_loss: 800865894496593675437473792.0000; val_kl_reg_loss: 184776.8967; val_edge_recon_loss: 63838870.4074; val_gene_expr_recon_loss: 204508383.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268532030.7654; val_optim_loss: 268532030.7654
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9136; val_auprc_score: 0.9856; val_best_acc_score: 0.9247; val_best_f1_score: 0.9583; train_kl_reg_loss: 245146.4489; train_edge_recon_loss: 61185615.9616; train_gene_expr_recon_loss: 203497722.8899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264928485.2967; train_optim_loss: 264928485.2967; val_kl_reg_loss: 195815.2721; val_edge_recon_loss: 64233366.9136; val_gene_expr_recon_loss: 204278781.2840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268707963.6543; val_optim_loss: 268707963.6543
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9157; val_auprc_score: 0.9859; val_best_acc_score: 0.9252; val_best_f1_score: 0.9586; train_kl_reg_loss: 197630.0601; train_edge_recon_loss: 61247166.3300; train_gene_expr_recon_loss: 202866407.9533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 264311204.4405; train_optim_loss: 264311204.4405; val_kl_reg_loss: 200185.5679; val_edge_recon_loss: 64182747.8519; val_gene_expr_recon_loss: 203085899.7531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267468832.4444; val_optim_loss: 267468832.4444
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9135; val_auprc_score: 0.9855; val_best_acc_score: 0.9251; val_best_f1_score: 0.9586; train_kl_reg_loss: 204398.2156; train_edge_recon_loss: 61176155.7585; train_gene_expr_recon_loss: 202310688.8123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263691242.9009; train_optim_loss: 263691242.9009; val_kl_reg_loss: 208012.2479; val_edge_recon_loss: 64258626.6543; val_gene_expr_recon_loss: 203035136.8395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 267501776.0988; val_optim_loss: 267501776.0988
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9153; val_auprc_score: 0.9860; val_best_acc_score: 0.9266; val_best_f1_score: 0.9594; train_kl_reg_loss: 231683.1497; train_edge_recon_loss: 61093075.8518; train_gene_expr_recon_loss: 202007341.5026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263332100.4405; train_optim_loss: 263332100.4405; val_kl_reg_loss: 218449.8981; val_edge_recon_loss: 63814268.0123; val_gene_expr_recon_loss: 202560158.9630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 266592876.5926; val_optim_loss: 266592876.5926
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9191; val_auprc_score: 0.9864; val_best_acc_score: 0.9287; val_best_f1_score: 0.9605; train_kl_reg_loss: 221927.2724; train_edge_recon_loss: 61433373.1252; train_gene_expr_recon_loss: 201752867.6062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263408168.0412; train_optim_loss: 263408168.0412; val_kl_reg_loss: 254724.6811; val_edge_recon_loss: 63364488.3951; val_gene_expr_recon_loss: 202110726.0247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265729938.6173; val_optim_loss: 265729938.6173
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9178; val_auprc_score: 0.9863; val_best_acc_score: 0.9281; val_best_f1_score: 0.9602; train_kl_reg_loss: 228988.5421; train_edge_recon_loss: 61097023.3770; train_gene_expr_recon_loss: 201444631.2069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262770643.2823; train_optim_loss: 262770643.2823; val_kl_reg_loss: 226861.8220; val_edge_recon_loss: 63773883.4568; val_gene_expr_recon_loss: 201992062.3704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265992807.5062; val_optim_loss: 265992807.5062
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9172; val_auprc_score: 0.9862; val_best_acc_score: 0.9265; val_best_f1_score: 0.9594; train_kl_reg_loss: 239914.8529; train_edge_recon_loss: 61193215.4511; train_gene_expr_recon_loss: 201367102.5894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262800232.9852; train_optim_loss: 262800232.9852; val_kl_reg_loss: 241866.6053; val_edge_recon_loss: 64080790.3210; val_gene_expr_recon_loss: 201761158.7654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 266083816.3951; val_optim_loss: 266083816.3951
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9191; val_auprc_score: 0.9863; val_best_acc_score: 0.9279; val_best_f1_score: 0.9600; train_kl_reg_loss: 248495.9520; train_edge_recon_loss: 61200771.0504; train_gene_expr_recon_loss: 200952036.8357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262401303.6021; train_optim_loss: 262401303.6021; val_kl_reg_loss: 256514.4916; val_edge_recon_loss: 64365252.9136; val_gene_expr_recon_loss: 201481540.2469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 266103307.3086; val_optim_loss: 266103307.3086
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9108; val_auprc_score: 0.9850; val_best_acc_score: 0.9260; val_best_f1_score: 0.9590; train_kl_reg_loss: 758229064.5143; train_edge_recon_loss: 62689721.1774; train_gene_expr_recon_loss: 253646147.4909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1074564931.2055; train_optim_loss: 1074564931.2055; val_kl_reg_loss: 202042.2068; val_edge_recon_loss: 64420977.3704; val_gene_expr_recon_loss: 215872458.2222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 280495477.5802; val_optim_loss: 280495477.5802

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9154; val_auprc_score: 0.9859; val_best_acc_score: 0.9276; val_best_f1_score: 0.9600; train_kl_reg_loss: 215510.9399; train_edge_recon_loss: 61562700.2758; train_gene_expr_recon_loss: 207942281.7592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 269720493.1732; train_optim_loss: 269720493.1732; val_kl_reg_loss: 229958.7128; val_edge_recon_loss: 63720865.3210; val_gene_expr_recon_loss: 205167683.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 269118507.5062; val_optim_loss: 269118507.5062
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9176; val_auprc_score: 0.9863; val_best_acc_score: 0.9287; val_best_f1_score: 0.9606; train_kl_reg_loss: 240773.6933; train_edge_recon_loss: 61080420.6902; train_gene_expr_recon_loss: 202649010.7115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 263970204.9262; train_optim_loss: 263970204.9262; val_kl_reg_loss: 251387.8539; val_edge_recon_loss: 63428908.0000; val_gene_expr_recon_loss: 202346388.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 266026684.1975; val_optim_loss: 266026684.1975
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9209; val_auprc_score: 0.9869; val_best_acc_score: 0.9288; val_best_f1_score: 0.9607; train_kl_reg_loss: 257342.2988; train_edge_recon_loss: 61314800.0892; train_gene_expr_recon_loss: 200548073.7208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 262120216.1400; train_optim_loss: 262120216.1400; val_kl_reg_loss: 263941.4239; val_edge_recon_loss: 63582528.6173; val_gene_expr_recon_loss: 200957344.5432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264803815.0617; val_optim_loss: 264803815.0617
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9181; val_auprc_score: 0.9864; val_best_acc_score: 0.9287; val_best_f1_score: 0.9605; train_kl_reg_loss: 269618.9419; train_edge_recon_loss: 61166493.9458; train_gene_expr_recon_loss: 199476373.6700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 260912486.6580; train_optim_loss: 260912486.6580; val_kl_reg_loss: 275211.0660; val_edge_recon_loss: 63913226.5802; val_gene_expr_recon_loss: 200166236.6914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 264354674.7654; val_optim_loss: 264354674.7654
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9211; val_auprc_score: 0.9869; val_best_acc_score: 0.9298; val_best_f1_score: 0.9611; train_kl_reg_loss: 279160.7969; train_edge_recon_loss: 60913581.0744; train_gene_expr_recon_loss: 198860807.2123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 260053549.1952; train_optim_loss: 260053549.1952; val_kl_reg_loss: 282602.2828; val_edge_recon_loss: 63426566.8148; val_gene_expr_recon_loss: 199728184.4938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263437353.8765; val_optim_loss: 263437353.8765
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9214; val_auprc_score: 0.9870; val_best_acc_score: 0.9289; val_best_f1_score: 0.9606; train_kl_reg_loss: 283718.7374; train_edge_recon_loss: 61183550.8350; train_gene_expr_recon_loss: 198438907.9492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 259906177.5259; train_optim_loss: 259906177.5259; val_kl_reg_loss: 288143.8375; val_edge_recon_loss: 63942044.1728; val_gene_expr_recon_loss: 199325628.2469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263555816.2963; val_optim_loss: 263555816.2963
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9226; val_auprc_score: 0.9871; val_best_acc_score: 0.9301; val_best_f1_score: 0.9613; train_kl_reg_loss: 287311.7446; train_edge_recon_loss: 61021285.1142; train_gene_expr_recon_loss: 198195493.7523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 259504090.4947; train_optim_loss: 259504090.4947; val_kl_reg_loss: 288047.6582; val_edge_recon_loss: 63149747.9259; val_gene_expr_recon_loss: 199208280.1975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 262646075.7037; val_optim_loss: 262646075.7037
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9189; val_auprc_score: 0.9863; val_best_acc_score: 0.9290; val_best_f1_score: 0.9606; train_kl_reg_loss: 293723.9066; train_edge_recon_loss: 61480967.0765; train_gene_expr_recon_loss: 195876967.8381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 257651658.7911; train_optim_loss: 257651658.7911; val_kl_reg_loss: 137748.7746; val_edge_recon_loss: 64419721.1852; val_gene_expr_recon_loss: 196801386.6173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 261358856.5926; val_optim_loss: 261358856.5926
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9193; val_auprc_score: 0.9866; val_best_acc_score: 0.9302; val_best_f1_score: 0.9614; train_kl_reg_loss: 296192.3531; train_edge_recon_loss: 61509354.3355; train_gene_expr_recon_loss: 195464678.7403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 257270225.3557; train_optim_loss: 257270225.3557; val_kl_reg_loss: 135255.1109; val_edge_recon_loss: 63606349.8025; val_gene_expr_recon_loss: 196299308.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 260040912.8889; val_optim_loss: 260040912.8889
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9199; val_auprc_score: 0.9866; val_best_acc_score: 0.9292; val_best_f1_score: 0.9607; train_kl_reg_loss: 291276.1194; train_edge_recon_loss: 61375312.4583; train_gene_expr_recon_loss: 195169659.2961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 256836247.9533; train_optim_loss: 256836247.9533; val_kl_reg_loss: 136974.8879; val_edge_recon_loss: 64320591.5309; val_gene_expr_recon_loss: 196191336.3457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 260648902.5185; val_optim_loss: 260648902.5185
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9203; val_auprc_score: 0.9866; val_best_acc_score: 0.9299; val_best_f1_score: 0.9613; train_kl_reg_loss: 282043.1087; train_edge_recon_loss: 61534275.5499; train_gene_expr_recon_loss: 194965334.6141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 256781653.0333; train_optim_loss: 256781653.0333; val_kl_reg_loss: 135045.7221; val_edge_recon_loss: 64400251.0864; val_gene_expr_recon_loss: 195936664.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 260471961.3827; val_optim_loss: 260471961.3827
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9200; val_auprc_score: 0.9866; val_best_acc_score: 0.9300; val_best_f1_score: 0.9612; train_kl_reg_loss: 271497.2942; train_edge_recon_loss: 61374090.4357; train_gene_expr_recon_loss: 194828866.3383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 256474454.0432; train_optim_loss: 256474454.0432; val_kl_reg_loss: 136597.4163; val_edge_recon_loss: 63873038.7531; val_gene_expr_recon_loss: 195791019.5556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259800655.4568; val_optim_loss: 259800655.4568
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9200; val_auprc_score: 0.9867; val_best_acc_score: 0.9302; val_best_f1_score: 0.9615; train_kl_reg_loss: 263388.2353; train_edge_recon_loss: 61365876.1880; train_gene_expr_recon_loss: 194735378.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 256364643.3372; train_optim_loss: 256364643.3372; val_kl_reg_loss: 138853.6683; val_edge_recon_loss: 63762411.8519; val_gene_expr_recon_loss: 195918689.8272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259819955.8025; val_optim_loss: 259819955.8025
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9216; val_auprc_score: 0.9870; val_best_acc_score: 0.9305; val_best_f1_score: 0.9616; train_kl_reg_loss: 256047.8860; train_edge_recon_loss: 61679982.2532; train_gene_expr_recon_loss: 194616474.5825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 256552504.6669; train_optim_loss: 256552504.6669; val_kl_reg_loss: 139714.9180; val_edge_recon_loss: 63904722.9506; val_gene_expr_recon_loss: 195638047.0617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259682484.5432; val_optim_loss: 259682484.5432
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9219; val_auprc_score: 0.9871; val_best_acc_score: 0.9304; val_best_f1_score: 0.9615; train_kl_reg_loss: 250439.1525; train_edge_recon_loss: 61399189.1636; train_gene_expr_recon_loss: 194434603.5431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 256084231.9918; train_optim_loss: 256084231.9918; val_kl_reg_loss: 142025.3989; val_edge_recon_loss: 63600822.4815; val_gene_expr_recon_loss: 195365362.5185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259108210.2716; val_optim_loss: 259108210.2716
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9209; val_auprc_score: 0.9867; val_best_acc_score: 0.9309; val_best_f1_score: 0.9618; train_kl_reg_loss: 249665.5634; train_edge_recon_loss: 61493610.8871; train_gene_expr_recon_loss: 194358994.8542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 256102271.2974; train_optim_loss: 256102271.2974; val_kl_reg_loss: 142650.9996; val_edge_recon_loss: 63797838.0864; val_gene_expr_recon_loss: 195509904.3951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259450393.6296; val_optim_loss: 259450393.6296
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9217; val_auprc_score: 0.9868; val_best_acc_score: 0.9309; val_best_f1_score: 0.9617; train_kl_reg_loss: 245366.7049; train_edge_recon_loss: 61115889.9211; train_gene_expr_recon_loss: 194120488.4967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 255481745.2789; train_optim_loss: 255481745.2789; val_kl_reg_loss: 142034.3818; val_edge_recon_loss: 63917365.0123; val_gene_expr_recon_loss: 195201491.9506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259260891.0123; val_optim_loss: 259260891.0123
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9203; val_auprc_score: 0.9866; val_best_acc_score: 0.9304; val_best_f1_score: 0.9615; train_kl_reg_loss: 241437.1374; train_edge_recon_loss: 61130437.5973; train_gene_expr_recon_loss: 194032370.4151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 255404245.0937; train_optim_loss: 255404245.0937; val_kl_reg_loss: 142877.0638; val_edge_recon_loss: 63934461.4568; val_gene_expr_recon_loss: 195193658.4198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259270996.5432; val_optim_loss: 259270996.5432
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9238; val_auprc_score: 0.9871; val_best_acc_score: 0.9319; val_best_f1_score: 0.9623; train_kl_reg_loss: 238802.0070; train_edge_recon_loss: 61169770.0652; train_gene_expr_recon_loss: 193960915.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 255369487.8683; train_optim_loss: 255369487.8683; val_kl_reg_loss: 144302.1304; val_edge_recon_loss: 63887811.4691; val_gene_expr_recon_loss: 194999053.3827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259031167.0617; val_optim_loss: 259031167.0617
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9223; val_auprc_score: 0.9870; val_best_acc_score: 0.9313; val_best_f1_score: 0.9620; train_kl_reg_loss: 238251.0541; train_edge_recon_loss: 61202846.0679; train_gene_expr_recon_loss: 193893071.7256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 255334168.7986; train_optim_loss: 255334168.7986; val_kl_reg_loss: 146021.8615; val_edge_recon_loss: 63986901.4321; val_gene_expr_recon_loss: 195023337.6790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259156261.2346; val_optim_loss: 259156261.2346
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9236; val_auprc_score: 0.9873; val_best_acc_score: 0.9314; val_best_f1_score: 0.9620; train_kl_reg_loss: 236774.1771; train_edge_recon_loss: 61348344.6010; train_gene_expr_recon_loss: 193874750.5674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 255459869.1348; train_optim_loss: 255459869.1348; val_kl_reg_loss: 149390.4547; val_edge_recon_loss: 63558177.8642; val_gene_expr_recon_loss: 194944675.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258652244.2469; val_optim_loss: 258652244.2469
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9216; val_auprc_score: 0.9869; val_best_acc_score: 0.9315; val_best_f1_score: 0.9621; train_kl_reg_loss: 235335.0490; train_edge_recon_loss: 61349823.8834; train_gene_expr_recon_loss: 193742652.6134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 255327811.4580; train_optim_loss: 255327811.4580; val_kl_reg_loss: 146883.2033; val_edge_recon_loss: 63984532.0370; val_gene_expr_recon_loss: 194975058.8148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259106474.4198; val_optim_loss: 259106474.4198
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9212; val_auprc_score: 0.9870; val_best_acc_score: 0.9305; val_best_f1_score: 0.9615; train_kl_reg_loss: 233657.6649; train_edge_recon_loss: 61136769.1362; train_gene_expr_recon_loss: 193736528.9496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 255106955.8065; train_optim_loss: 255106955.8065; val_kl_reg_loss: 149639.7644; val_edge_recon_loss: 63757670.6790; val_gene_expr_recon_loss: 194905956.9383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258813267.2593; val_optim_loss: 258813267.2593
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9220; val_auprc_score: 0.9870; val_best_acc_score: 0.9316; val_best_f1_score: 0.9621; train_kl_reg_loss: 232892.2524; train_edge_recon_loss: 61132769.2885; train_gene_expr_recon_loss: 193679638.9654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 255045300.5283; train_optim_loss: 255045300.5283; val_kl_reg_loss: 151165.8123; val_edge_recon_loss: 63700055.8642; val_gene_expr_recon_loss: 194620798.8642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258472020.3457; val_optim_loss: 258472020.3457
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9235; val_auprc_score: 0.9873; val_best_acc_score: 0.9323; val_best_f1_score: 0.9624; train_kl_reg_loss: 231601.8812; train_edge_recon_loss: 61203356.2086; train_gene_expr_recon_loss: 193621991.6021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 255056949.6974; train_optim_loss: 255056949.6974; val_kl_reg_loss: 150191.0792; val_edge_recon_loss: 63608116.4691; val_gene_expr_recon_loss: 194795313.6790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258553621.2346; val_optim_loss: 258553621.2346
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9237; val_auprc_score: 0.9871; val_best_acc_score: 0.9315; val_best_f1_score: 0.9620; train_kl_reg_loss: 230497.8927; train_edge_recon_loss: 61313149.9911; train_gene_expr_recon_loss: 193568063.2535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 255111711.1163; train_optim_loss: 255111711.1163; val_kl_reg_loss: 151635.9901; val_edge_recon_loss: 64196137.5802; val_gene_expr_recon_loss: 194900318.0741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 259248091.1111; val_optim_loss: 259248091.1111
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9241; val_auprc_score: 0.9875; val_best_acc_score: 0.9324; val_best_f1_score: 0.9626; train_kl_reg_loss: 227550.4017; train_edge_recon_loss: 61231865.7688; train_gene_expr_recon_loss: 193528382.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254987798.4933; train_optim_loss: 254987798.4933; val_kl_reg_loss: 153343.0796; val_edge_recon_loss: 63165647.5185; val_gene_expr_recon_loss: 194670529.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 257989519.1605; val_optim_loss: 257989519.1605
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9211; val_auprc_score: 0.9868; val_best_acc_score: 0.9309; val_best_f1_score: 0.9617; train_kl_reg_loss: 228772.0493; train_edge_recon_loss: 61191126.5427; train_gene_expr_recon_loss: 193469570.9640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254889469.5575; train_optim_loss: 254889469.5575; val_kl_reg_loss: 157370.4444; val_edge_recon_loss: 63845203.3580; val_gene_expr_recon_loss: 194682063.6543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258684637.7778; val_optim_loss: 258684637.7778
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9229; val_auprc_score: 0.9871; val_best_acc_score: 0.9317; val_best_f1_score: 0.9622; train_kl_reg_loss: 229035.6309; train_edge_recon_loss: 61238933.3420; train_gene_expr_recon_loss: 193427913.2213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254895882.1983; train_optim_loss: 254895882.1983; val_kl_reg_loss: 156433.4927; val_edge_recon_loss: 63843926.4568; val_gene_expr_recon_loss: 194743643.1605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258744003.6543; val_optim_loss: 258744003.6543
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9240; val_auprc_score: 0.9874; val_best_acc_score: 0.9320; val_best_f1_score: 0.9623; train_kl_reg_loss: 227238.2391; train_edge_recon_loss: 61125439.4374; train_gene_expr_recon_loss: 193407250.4535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254759928.1674; train_optim_loss: 254759928.1674; val_kl_reg_loss: 159344.4894; val_edge_recon_loss: 63735921.5556; val_gene_expr_recon_loss: 194417114.0741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258312380.6420; val_optim_loss: 258312380.6420
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9241; val_auprc_score: 0.9874; val_best_acc_score: 0.9321; val_best_f1_score: 0.9624; train_kl_reg_loss: 228155.1603; train_edge_recon_loss: 61164398.7211; train_gene_expr_recon_loss: 193397756.0041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254790309.9389; train_optim_loss: 254790309.9389; val_kl_reg_loss: 160350.6227; val_edge_recon_loss: 63459879.0370; val_gene_expr_recon_loss: 194543553.5802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258163783.0617; val_optim_loss: 258163783.0617

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9246; val_auprc_score: 0.9874; val_best_acc_score: 0.9318; val_best_f1_score: 0.9622; train_kl_reg_loss: 227747.3626; train_edge_recon_loss: 61058493.1087; train_gene_expr_recon_loss: 193043521.1307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254329761.6796; train_optim_loss: 254329761.6796; val_kl_reg_loss: 159928.9136; val_edge_recon_loss: 64106214.5556; val_gene_expr_recon_loss: 194177775.3086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258443918.7654; val_optim_loss: 258443918.7654
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9257; val_auprc_score: 0.9878; val_best_acc_score: 0.9328; val_best_f1_score: 0.9628; train_kl_reg_loss: 227151.2930; train_edge_recon_loss: 61293658.4521; train_gene_expr_recon_loss: 193021482.8954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254542292.5503; train_optim_loss: 254542292.5503; val_kl_reg_loss: 160036.2074; val_edge_recon_loss: 63061825.2840; val_gene_expr_recon_loss: 194361577.4815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 257583439.2099; val_optim_loss: 257583439.2099
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9263; val_auprc_score: 0.9879; val_best_acc_score: 0.9328; val_best_f1_score: 0.9629; train_kl_reg_loss: 227080.1708; train_edge_recon_loss: 61022030.7142; train_gene_expr_recon_loss: 193013591.4319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254262702.4192; train_optim_loss: 254262702.4192; val_kl_reg_loss: 160215.7727; val_edge_recon_loss: 63036566.7407; val_gene_expr_recon_loss: 194392208.3457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 257588990.4198; val_optim_loss: 257588990.4198
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9240; val_auprc_score: 0.9873; val_best_acc_score: 0.9322; val_best_f1_score: 0.9624; train_kl_reg_loss: 226494.4565; train_edge_recon_loss: 61017907.5952; train_gene_expr_recon_loss: 193034434.6182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254278836.7753; train_optim_loss: 254278836.7753; val_kl_reg_loss: 160410.1844; val_edge_recon_loss: 63960580.5802; val_gene_expr_recon_loss: 194240513.9753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258361505.0370; val_optim_loss: 258361505.0370
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9255; val_auprc_score: 0.9876; val_best_acc_score: 0.9324; val_best_f1_score: 0.9626; train_kl_reg_loss: 226083.3600; train_edge_recon_loss: 61140956.3527; train_gene_expr_recon_loss: 192980818.2065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254347857.8443; train_optim_loss: 254347857.8443; val_kl_reg_loss: 160418.1834; val_edge_recon_loss: 63697903.3704; val_gene_expr_recon_loss: 194340843.0123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258199164.5926; val_optim_loss: 258199164.5926
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9253; val_auprc_score: 0.9878; val_best_acc_score: 0.9322; val_best_f1_score: 0.9625; train_kl_reg_loss: 225787.1484; train_edge_recon_loss: 61017944.7904; train_gene_expr_recon_loss: 192944656.4172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254188388.5118; train_optim_loss: 254188388.5118; val_kl_reg_loss: 160377.4978; val_edge_recon_loss: 63425182.1605; val_gene_expr_recon_loss: 194185529.6790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 257771089.4815; val_optim_loss: 257771089.4815

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9245; val_auprc_score: 0.9874; val_best_acc_score: 0.9324; val_best_f1_score: 0.9626; train_kl_reg_loss: 225547.0523; train_edge_recon_loss: 60803033.8635; train_gene_expr_recon_loss: 192947178.5880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 253975759.5115; train_optim_loss: 253975759.5115; val_kl_reg_loss: 160431.6692; val_edge_recon_loss: 63202084.7654; val_gene_expr_recon_loss: 194142093.6790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 257504610.2222; val_optim_loss: 257504610.2222
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9259; val_auprc_score: 0.9875; val_best_acc_score: 0.9317; val_best_f1_score: 0.9621; train_kl_reg_loss: 225596.1216; train_edge_recon_loss: 61149822.3101; train_gene_expr_recon_loss: 192898190.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254273608.7218; train_optim_loss: 254273608.7218; val_kl_reg_loss: 160474.0300; val_edge_recon_loss: 64088784.2346; val_gene_expr_recon_loss: 194277594.9630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258526852.7901; val_optim_loss: 258526852.7901
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9248; val_auprc_score: 0.9874; val_best_acc_score: 0.9318; val_best_f1_score: 0.9621; train_kl_reg_loss: 225594.9241; train_edge_recon_loss: 61220756.5750; train_gene_expr_recon_loss: 192914201.1060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254360552.6614; train_optim_loss: 254360552.6614; val_kl_reg_loss: 160546.1831; val_edge_recon_loss: 64108941.0741; val_gene_expr_recon_loss: 194303831.0617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258573318.4198; val_optim_loss: 258573318.4198
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9251; val_auprc_score: 0.9875; val_best_acc_score: 0.9318; val_best_f1_score: 0.9622; train_kl_reg_loss: 225573.6314; train_edge_recon_loss: 61118621.0690; train_gene_expr_recon_loss: 192933077.6480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254277272.5352; train_optim_loss: 254277272.5352; val_kl_reg_loss: 160454.9486; val_edge_recon_loss: 63561523.5062; val_gene_expr_recon_loss: 193968848.3457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 257690827.0617; val_optim_loss: 257690827.0617
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9268; val_auprc_score: 0.9877; val_best_acc_score: 0.9322; val_best_f1_score: 0.9623; train_kl_reg_loss: 225563.4874; train_edge_recon_loss: 61189996.4460; train_gene_expr_recon_loss: 192925950.8364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254341510.6799; train_optim_loss: 254341510.6799; val_kl_reg_loss: 160572.5659; val_edge_recon_loss: 64127934.3580; val_gene_expr_recon_loss: 194321191.2593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258609698.6173; val_optim_loss: 258609698.6173

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9255; val_auprc_score: 0.9876; val_best_acc_score: 0.9318; val_best_f1_score: 0.9622; train_kl_reg_loss: 225440.3154; train_edge_recon_loss: 60957577.0374; train_gene_expr_recon_loss: 192954511.0395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254137528.2168; train_optim_loss: 254137528.2168; val_kl_reg_loss: 160425.1461; val_edge_recon_loss: 63792446.6049; val_gene_expr_recon_loss: 194081789.2346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258034661.4815; val_optim_loss: 258034661.4815
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9237; val_auprc_score: 0.9871; val_best_acc_score: 0.9315; val_best_f1_score: 0.9620; train_kl_reg_loss: 225443.5020; train_edge_recon_loss: 61123323.1465; train_gene_expr_recon_loss: 192924988.1029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254273754.7527; train_optim_loss: 254273754.7527; val_kl_reg_loss: 160606.4796; val_edge_recon_loss: 64350120.6049; val_gene_expr_recon_loss: 194366192.0988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 258876918.5185; val_optim_loss: 258876918.5185
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9256; val_auprc_score: 0.9877; val_best_acc_score: 0.9324; val_best_f1_score: 0.9626; train_kl_reg_loss: 225464.6347; train_edge_recon_loss: 60800163.0861; train_gene_expr_recon_loss: 192943264.5873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 253968892.1029; train_optim_loss: 253968892.1029; val_kl_reg_loss: 160467.1655; val_edge_recon_loss: 63574274.8889; val_gene_expr_recon_loss: 194158447.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 257893189.6296; val_optim_loss: 257893189.6296
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9249; val_auprc_score: 0.9875; val_best_acc_score: 0.9322; val_best_f1_score: 0.9625; train_kl_reg_loss: 225394.6685; train_edge_recon_loss: 61064122.6003; train_gene_expr_recon_loss: 192937408.4226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 254226925.7057; train_optim_loss: 254226925.7057; val_kl_reg_loss: 160449.7429; val_edge_recon_loss: 63252271.7654; val_gene_expr_recon_loss: 194096300.7407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 257509022.1728; val_optim_loss: 257509022.1728

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 818 min 59 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9242
val AUPRC score: 0.9875
val best accuracy score: 0.9319
val best F1 score: 0.9623
val target rna MSE score: 0.5767
val source rna MSE score: 0.1700
Val cat covariate0 mean sim diff: -0.0010
Val cat covariate1 mean sim diff: -0.0539
Val cat covariate2 mean sim diff: -0.0010

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
