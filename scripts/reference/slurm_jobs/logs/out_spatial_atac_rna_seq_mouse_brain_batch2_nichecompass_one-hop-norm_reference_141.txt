[True]
Run timestamp: 07082023_214613_141.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_141']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8877; val_auprc_score: 0.8938; val_best_acc_score: 0.5565; val_best_f1_score: 0.6919; train_kl_reg_loss: 122979.6725; train_edge_recon_loss: 3478541.3611; train_gene_expr_recon_loss: 1158530.0069; train_masked_gp_l1_reg_loss: 8704.7093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166918.1024; train_chrom_access_recon_loss: 695835.7500; train_global_loss: 5631509.6667; train_optim_loss: 5631509.6667; val_kl_reg_loss: 23493.4863; val_edge_recon_loss: 4061718.5000; val_gene_expr_recon_loss: 954339.1875; val_masked_gp_l1_reg_loss: 7436.3662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162223.1562; val_chrom_access_recon_loss: 513601.5625; val_global_loss: 5722812.0000; val_optim_loss: 5722812.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8704; val_auprc_score: 0.8776; val_best_acc_score: 0.6284; val_best_f1_score: 0.7267; train_kl_reg_loss: 23643.5749; train_edge_recon_loss: 3481773.0556; train_gene_expr_recon_loss: 912373.5208; train_masked_gp_l1_reg_loss: 7102.5071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159151.0052; train_chrom_access_recon_loss: 491915.6667; train_global_loss: 5075959.2778; train_optim_loss: 5075959.2778; val_kl_reg_loss: 21289.8203; val_edge_recon_loss: 4056986.5000; val_gene_expr_recon_loss: 860037.3750; val_masked_gp_l1_reg_loss: 6865.9331; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155237.1250; val_chrom_access_recon_loss: 469760.5938; val_global_loss: 5570177.0000; val_optim_loss: 5570177.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8445; val_auprc_score: 0.8486; val_best_acc_score: 0.6906; val_best_f1_score: 0.7569; train_kl_reg_loss: 22044.6641; train_edge_recon_loss: 3480391.5556; train_gene_expr_recon_loss: 864391.1319; train_masked_gp_l1_reg_loss: 6859.7546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151837.3368; train_chrom_access_recon_loss: 467086.4757; train_global_loss: 4992611.0000; train_optim_loss: 4992611.0000; val_kl_reg_loss: 15331.8467; val_edge_recon_loss: 4049627.7500; val_gene_expr_recon_loss: 827386.7500; val_masked_gp_l1_reg_loss: 6858.2471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147388.9375; val_chrom_access_recon_loss: 460417.7812; val_global_loss: 5507011.0000; val_optim_loss: 5507011.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8312; val_auprc_score: 0.8237; val_best_acc_score: 0.7371; val_best_f1_score: 0.7743; train_kl_reg_loss: 18733.7863; train_edge_recon_loss: 3479723.3889; train_gene_expr_recon_loss: 823017.5139; train_masked_gp_l1_reg_loss: 6810.5889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143523.5972; train_chrom_access_recon_loss: 459038.8090; train_global_loss: 4930847.5556; train_optim_loss: 4930847.5556; val_kl_reg_loss: 21013.2715; val_edge_recon_loss: 4031230.0000; val_gene_expr_recon_loss: 802950.1875; val_masked_gp_l1_reg_loss: 6736.1377; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138521.5469; val_chrom_access_recon_loss: 456090.6875; val_global_loss: 5456541.5000; val_optim_loss: 5456541.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8358; val_auprc_score: 0.8192; val_best_acc_score: 0.7347; val_best_f1_score: 0.7767; train_kl_reg_loss: 17978.8519; train_edge_recon_loss: 3474737.6111; train_gene_expr_recon_loss: 803363.0417; train_masked_gp_l1_reg_loss: 6683.8541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134321.1962; train_chrom_access_recon_loss: 457804.7049; train_global_loss: 4894889.2222; train_optim_loss: 4894889.2222; val_kl_reg_loss: 14105.6113; val_edge_recon_loss: 3955430.5000; val_gene_expr_recon_loss: 787479.0625; val_masked_gp_l1_reg_loss: 6625.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128983.7188; val_chrom_access_recon_loss: 453253.9062; val_global_loss: 5345878.0000; val_optim_loss: 5345878.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8404; val_auprc_score: 0.8120; val_best_acc_score: 0.7719; val_best_f1_score: 0.7981; train_kl_reg_loss: 12275.6593; train_edge_recon_loss: 3444641.9722; train_gene_expr_recon_loss: 788648.8542; train_masked_gp_l1_reg_loss: 6594.7260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124662.1181; train_chrom_access_recon_loss: 452838.8854; train_global_loss: 4829662.2222; train_optim_loss: 4829662.2222; val_kl_reg_loss: 8103.4990; val_edge_recon_loss: 3599846.0000; val_gene_expr_recon_loss: 786494.4375; val_masked_gp_l1_reg_loss: 6558.2637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119273.1719; val_chrom_access_recon_loss: 452736.5625; val_global_loss: 4973012.0000; val_optim_loss: 4973012.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8531; val_auprc_score: 0.8400; val_best_acc_score: 0.7650; val_best_f1_score: 0.7974; train_kl_reg_loss: 8848.0020; train_edge_recon_loss: 3177653.6944; train_gene_expr_recon_loss: 817858.1389; train_masked_gp_l1_reg_loss: 6512.1124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115085.6580; train_chrom_access_recon_loss: 458687.2674; train_global_loss: 4584644.7222; train_optim_loss: 4584644.7222; val_kl_reg_loss: 15028.3262; val_edge_recon_loss: 2934558.7500; val_gene_expr_recon_loss: 826488.7500; val_masked_gp_l1_reg_loss: 6456.4702; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110015.8750; val_chrom_access_recon_loss: 456895.4688; val_global_loss: 4349443.5000; val_optim_loss: 4349443.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8647; val_auprc_score: 0.8507; val_best_acc_score: 0.7710; val_best_f1_score: 0.7899; train_kl_reg_loss: 26535.8415; train_edge_recon_loss: 2882738.7500; train_gene_expr_recon_loss: 809862.3403; train_masked_gp_l1_reg_loss: 6477.0200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106231.9227; train_chrom_access_recon_loss: 456447.3611; train_global_loss: 4288293.1111; train_optim_loss: 4288293.1111; val_kl_reg_loss: 37391.5156; val_edge_recon_loss: 2905096.0000; val_gene_expr_recon_loss: 784012.7500; val_masked_gp_l1_reg_loss: 6503.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101591.3281; val_chrom_access_recon_loss: 451836.7812; val_global_loss: 4286432.0000; val_optim_loss: 4286432.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8856; val_auprc_score: 0.8747; val_best_acc_score: 0.7905; val_best_f1_score: 0.8036; train_kl_reg_loss: 45666.7174; train_edge_recon_loss: 2876194.0833; train_gene_expr_recon_loss: 780940.4306; train_masked_gp_l1_reg_loss: 6507.6393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97965.7049; train_chrom_access_recon_loss: 452326.5833; train_global_loss: 4259601.0556; train_optim_loss: 4259601.0556; val_kl_reg_loss: 49639.6289; val_edge_recon_loss: 2901379.2500; val_gene_expr_recon_loss: 759903.6250; val_masked_gp_l1_reg_loss: 6500.2764; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93483.0000; val_chrom_access_recon_loss: 448320.8438; val_global_loss: 4259226.5000; val_optim_loss: 4259226.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8947; val_auprc_score: 0.8829; val_best_acc_score: 0.8085; val_best_f1_score: 0.8099; train_kl_reg_loss: 50236.6128; train_edge_recon_loss: 2851060.1667; train_gene_expr_recon_loss: 758608.6389; train_masked_gp_l1_reg_loss: 6473.0719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90049.4227; train_chrom_access_recon_loss: 448547.6042; train_global_loss: 4204975.5556; train_optim_loss: 4204975.5556; val_kl_reg_loss: 46110.3281; val_edge_recon_loss: 2865924.5000; val_gene_expr_recon_loss: 748509.5000; val_masked_gp_l1_reg_loss: 6439.9092; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85847.3906; val_chrom_access_recon_loss: 447024.3125; val_global_loss: 4199856.0000; val_optim_loss: 4199856.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8962; val_auprc_score: 0.8759; val_best_acc_score: 0.8135; val_best_f1_score: 0.8289; train_kl_reg_loss: 43683.4510; train_edge_recon_loss: 2841591.2500; train_gene_expr_recon_loss: 751530.0486; train_masked_gp_l1_reg_loss: 6433.1886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82682.3229; train_chrom_access_recon_loss: 449078.4340; train_global_loss: 4174998.8056; train_optim_loss: 4174998.8056; val_kl_reg_loss: 37898.6562; val_edge_recon_loss: 2824698.7500; val_gene_expr_recon_loss: 745819.0000; val_masked_gp_l1_reg_loss: 6420.3936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78875.6172; val_chrom_access_recon_loss: 445844.4688; val_global_loss: 4139557.0000; val_optim_loss: 4139557.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9096; val_auprc_score: 0.8876; val_best_acc_score: 0.8366; val_best_f1_score: 0.8504; train_kl_reg_loss: 36851.5933; train_edge_recon_loss: 2803311.9167; train_gene_expr_recon_loss: 742856.4236; train_masked_gp_l1_reg_loss: 6426.2470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76102.6458; train_chrom_access_recon_loss: 445965.2743; train_global_loss: 4111514.0556; train_optim_loss: 4111514.0556; val_kl_reg_loss: 36727.8594; val_edge_recon_loss: 2784561.5000; val_gene_expr_recon_loss: 740111.1250; val_masked_gp_l1_reg_loss: 6431.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72770.4766; val_chrom_access_recon_loss: 444677.9375; val_global_loss: 4085280.7500; val_optim_loss: 4085280.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9128; val_auprc_score: 0.8878; val_best_acc_score: 0.8484; val_best_f1_score: 0.8579; train_kl_reg_loss: 37972.8359; train_edge_recon_loss: 2780178.0833; train_gene_expr_recon_loss: 739352.8750; train_masked_gp_l1_reg_loss: 6452.1973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70309.6259; train_chrom_access_recon_loss: 445443.0799; train_global_loss: 4079708.6389; train_optim_loss: 4079708.6389; val_kl_reg_loss: 37077.6172; val_edge_recon_loss: 2796651.5000; val_gene_expr_recon_loss: 737734.0000; val_masked_gp_l1_reg_loss: 6474.6123; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67370.9844; val_chrom_access_recon_loss: 443900.1562; val_global_loss: 4089208.7500; val_optim_loss: 4089208.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9226; val_auprc_score: 0.8993; val_best_acc_score: 0.8626; val_best_f1_score: 0.8716; train_kl_reg_loss: 40292.3138; train_edge_recon_loss: 2749702.6389; train_gene_expr_recon_loss: 739231.0069; train_masked_gp_l1_reg_loss: 6484.9599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65221.4023; train_chrom_access_recon_loss: 444730.2396; train_global_loss: 4045662.5556; train_optim_loss: 4045662.5556; val_kl_reg_loss: 39678.7422; val_edge_recon_loss: 2727446.7500; val_gene_expr_recon_loss: 734805.1875; val_masked_gp_l1_reg_loss: 6502.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62639.9531; val_chrom_access_recon_loss: 443005.2812; val_global_loss: 4014078.5000; val_optim_loss: 4014078.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9279; val_auprc_score: 0.9084; val_best_acc_score: 0.8614; val_best_f1_score: 0.8700; train_kl_reg_loss: 41241.8138; train_edge_recon_loss: 2745458.7222; train_gene_expr_recon_loss: 734060.4514; train_masked_gp_l1_reg_loss: 6533.6258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60752.2630; train_chrom_access_recon_loss: 442543.3264; train_global_loss: 4030590.1667; train_optim_loss: 4030590.1667; val_kl_reg_loss: 40959.0234; val_edge_recon_loss: 2759637.0000; val_gene_expr_recon_loss: 732271.2500; val_masked_gp_l1_reg_loss: 6556.0684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58473.8984; val_chrom_access_recon_loss: 441951.4688; val_global_loss: 4039848.7500; val_optim_loss: 4039848.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9280; val_auprc_score: 0.9040; val_best_acc_score: 0.8698; val_best_f1_score: 0.8788; train_kl_reg_loss: 41587.7561; train_edge_recon_loss: 2735829.1667; train_gene_expr_recon_loss: 729212.9375; train_masked_gp_l1_reg_loss: 6570.0603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56779.8516; train_chrom_access_recon_loss: 442136.8125; train_global_loss: 4012116.5000; train_optim_loss: 4012116.5000; val_kl_reg_loss: 39647.3477; val_edge_recon_loss: 2752328.5000; val_gene_expr_recon_loss: 724447.3125; val_masked_gp_l1_reg_loss: 6595.8159; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54719.7578; val_chrom_access_recon_loss: 440922.2188; val_global_loss: 4018660.7500; val_optim_loss: 4018660.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9367; val_auprc_score: 0.9178; val_best_acc_score: 0.8742; val_best_f1_score: 0.8807; train_kl_reg_loss: 41149.4184; train_edge_recon_loss: 2731212.5833; train_gene_expr_recon_loss: 726898.1389; train_masked_gp_l1_reg_loss: 6627.1546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53181.4349; train_chrom_access_recon_loss: 443098.4340; train_global_loss: 4002167.1667; train_optim_loss: 4002167.1667; val_kl_reg_loss: 39683.2969; val_edge_recon_loss: 2724931.7500; val_gene_expr_recon_loss: 720103.6250; val_masked_gp_l1_reg_loss: 6644.9658; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51304.7188; val_chrom_access_recon_loss: 439937.5000; val_global_loss: 3982605.7500; val_optim_loss: 3982605.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9370; val_auprc_score: 0.9154; val_best_acc_score: 0.8751; val_best_f1_score: 0.8830; train_kl_reg_loss: 40108.1484; train_edge_recon_loss: 2725585.0556; train_gene_expr_recon_loss: 720595.1111; train_masked_gp_l1_reg_loss: 6661.7377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49893.9071; train_chrom_access_recon_loss: 441957.4722; train_global_loss: 3984801.4167; train_optim_loss: 3984801.4167; val_kl_reg_loss: 38423.5625; val_edge_recon_loss: 2735720.0000; val_gene_expr_recon_loss: 716230.2500; val_masked_gp_l1_reg_loss: 6668.8843; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48182.2812; val_chrom_access_recon_loss: 439166.5938; val_global_loss: 3984391.5000; val_optim_loss: 3984391.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9437; val_auprc_score: 0.9275; val_best_acc_score: 0.8831; val_best_f1_score: 0.8901; train_kl_reg_loss: 38217.3876; train_edge_recon_loss: 2717109.9722; train_gene_expr_recon_loss: 719222.3125; train_masked_gp_l1_reg_loss: 6687.1143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46899.6992; train_chrom_access_recon_loss: 440797.8090; train_global_loss: 3968934.2500; train_optim_loss: 3968934.2500; val_kl_reg_loss: 37025.0938; val_edge_recon_loss: 2729051.0000; val_gene_expr_recon_loss: 713144.0000; val_masked_gp_l1_reg_loss: 6707.7441; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45349.9922; val_chrom_access_recon_loss: 438454.1875; val_global_loss: 3969732.0000; val_optim_loss: 3969732.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9470; val_auprc_score: 0.9330; val_best_acc_score: 0.8828; val_best_f1_score: 0.8881; train_kl_reg_loss: 37583.7799; train_edge_recon_loss: 2720867.2222; train_gene_expr_recon_loss: 716940.3264; train_masked_gp_l1_reg_loss: 6730.7568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44186.8194; train_chrom_access_recon_loss: 441807.3542; train_global_loss: 3968116.2500; train_optim_loss: 3968116.2500; val_kl_reg_loss: 36582.5859; val_edge_recon_loss: 2739347.7500; val_gene_expr_recon_loss: 710727.6250; val_masked_gp_l1_reg_loss: 6748.2246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42763.6367; val_chrom_access_recon_loss: 437940.5625; val_global_loss: 3974110.5000; val_optim_loss: 3974110.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9504; val_auprc_score: 0.9332; val_best_acc_score: 0.8880; val_best_f1_score: 0.8936; train_kl_reg_loss: 37154.6402; train_edge_recon_loss: 2720781.5278; train_gene_expr_recon_loss: 710027.5694; train_masked_gp_l1_reg_loss: 6771.9622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41701.2478; train_chrom_access_recon_loss: 438889.1493; train_global_loss: 3955325.9722; train_optim_loss: 3955325.9722; val_kl_reg_loss: 36616.6211; val_edge_recon_loss: 2727296.0000; val_gene_expr_recon_loss: 706788.5000; val_masked_gp_l1_reg_loss: 6798.7573; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40407.4414; val_chrom_access_recon_loss: 436966.7500; val_global_loss: 3954874.0000; val_optim_loss: 3954874.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9550; val_auprc_score: 0.9384; val_best_acc_score: 0.8998; val_best_f1_score: 0.9044; train_kl_reg_loss: 36976.0981; train_edge_recon_loss: 2719369.0556; train_gene_expr_recon_loss: 712159.2500; train_masked_gp_l1_reg_loss: 6820.5806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39426.5074; train_chrom_access_recon_loss: 438604.0035; train_global_loss: 3953355.5833; train_optim_loss: 3953355.5833; val_kl_reg_loss: 35932.8438; val_edge_recon_loss: 2700061.2500; val_gene_expr_recon_loss: 704532.6875; val_masked_gp_l1_reg_loss: 6843.9639; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38235.5469; val_chrom_access_recon_loss: 436299.1562; val_global_loss: 3921905.5000; val_optim_loss: 3921905.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9565; val_auprc_score: 0.9444; val_best_acc_score: 0.8964; val_best_f1_score: 0.9019; train_kl_reg_loss: 36186.7626; train_edge_recon_loss: 2713505.6389; train_gene_expr_recon_loss: 707868.9514; train_masked_gp_l1_reg_loss: 6874.9561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37332.1328; train_chrom_access_recon_loss: 440128.4757; train_global_loss: 3941896.8889; train_optim_loss: 3941896.8889; val_kl_reg_loss: 34180.1641; val_edge_recon_loss: 2721351.5000; val_gene_expr_recon_loss: 701735.3125; val_masked_gp_l1_reg_loss: 6897.8130; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36229.5625; val_chrom_access_recon_loss: 435724.2188; val_global_loss: 3936118.5000; val_optim_loss: 3936118.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9580; val_auprc_score: 0.9448; val_best_acc_score: 0.9029; val_best_f1_score: 0.9078; train_kl_reg_loss: 33927.1137; train_edge_recon_loss: 2710316.1389; train_gene_expr_recon_loss: 703826.9097; train_masked_gp_l1_reg_loss: 6927.3030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35410.6884; train_chrom_access_recon_loss: 437777.0903; train_global_loss: 3928185.3333; train_optim_loss: 3928185.3333; val_kl_reg_loss: 33718.8828; val_edge_recon_loss: 2713315.5000; val_gene_expr_recon_loss: 699985.1250; val_masked_gp_l1_reg_loss: 6951.0840; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34411.2578; val_chrom_access_recon_loss: 434903.0625; val_global_loss: 3923284.7500; val_optim_loss: 3923284.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9606; val_auprc_score: 0.9478; val_best_acc_score: 0.9073; val_best_f1_score: 0.9115; train_kl_reg_loss: 34997.5113; train_edge_recon_loss: 2712976.0000; train_gene_expr_recon_loss: 702276.0903; train_masked_gp_l1_reg_loss: 6974.0994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33662.7865; train_chrom_access_recon_loss: 437595.9340; train_global_loss: 3928482.4167; train_optim_loss: 3928482.4167; val_kl_reg_loss: 34026.3086; val_edge_recon_loss: 2703981.5000; val_gene_expr_recon_loss: 697410.0000; val_masked_gp_l1_reg_loss: 6997.8506; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32754.9180; val_chrom_access_recon_loss: 434342.6250; val_global_loss: 3909513.0000; val_optim_loss: 3909513.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9644; val_auprc_score: 0.9548; val_best_acc_score: 0.9105; val_best_f1_score: 0.9145; train_kl_reg_loss: 32328.4846; train_edge_recon_loss: 2697339.1667; train_gene_expr_recon_loss: 954597.7639; train_masked_gp_l1_reg_loss: 7048.9113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31858.7489; train_chrom_access_recon_loss: 459665.9028; train_global_loss: 4182839.0278; train_optim_loss: 4182839.0278; val_kl_reg_loss: 20303.2441; val_edge_recon_loss: 2689835.2500; val_gene_expr_recon_loss: 957007.6875; val_masked_gp_l1_reg_loss: 7114.6050; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30621.1992; val_chrom_access_recon_loss: 458550.2500; val_global_loss: 4163432.2500; val_optim_loss: 4163432.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9641; val_auprc_score: 0.9521; val_best_acc_score: 0.9103; val_best_f1_score: 0.9134; train_kl_reg_loss: 27954.7391; train_edge_recon_loss: 2681937.1389; train_gene_expr_recon_loss: 960143.6458; train_masked_gp_l1_reg_loss: 7185.2619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29549.4989; train_chrom_access_recon_loss: 459985.8333; train_global_loss: 4166756.1111; train_optim_loss: 4166756.1111; val_kl_reg_loss: 19867.1172; val_edge_recon_loss: 2695885.5000; val_gene_expr_recon_loss: 951769.6250; val_masked_gp_l1_reg_loss: 7275.7861; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28209.3867; val_chrom_access_recon_loss: 457795.0312; val_global_loss: 4160802.2500; val_optim_loss: 4160802.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9647; val_auprc_score: 0.9501; val_best_acc_score: 0.9128; val_best_f1_score: 0.9170; train_kl_reg_loss: 27054.4390; train_edge_recon_loss: 2672195.2222; train_gene_expr_recon_loss: 954193.9792; train_masked_gp_l1_reg_loss: 7358.3377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27171.7823; train_chrom_access_recon_loss: 458240.3681; train_global_loss: 4146214.1389; train_optim_loss: 4146214.1389; val_kl_reg_loss: 19855.4922; val_edge_recon_loss: 2693613.5000; val_gene_expr_recon_loss: 947636.1250; val_masked_gp_l1_reg_loss: 7453.5396; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25905.1660; val_chrom_access_recon_loss: 457037.4062; val_global_loss: 4151501.2500; val_optim_loss: 4151501.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9697; val_auprc_score: 0.9580; val_best_acc_score: 0.9232; val_best_f1_score: 0.9261; train_kl_reg_loss: 26375.9110; train_edge_recon_loss: 2665723.5000; train_gene_expr_recon_loss: 948803.2222; train_masked_gp_l1_reg_loss: 7529.6017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24955.9703; train_chrom_access_recon_loss: 459493.1424; train_global_loss: 4132881.4167; train_optim_loss: 4132881.4167; val_kl_reg_loss: 20215.0996; val_edge_recon_loss: 2677572.2500; val_gene_expr_recon_loss: 946070.5625; val_masked_gp_l1_reg_loss: 7612.2646; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23813.1172; val_chrom_access_recon_loss: 456619.0938; val_global_loss: 4131902.0000; val_optim_loss: 4131902.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9689; val_auprc_score: 0.9589; val_best_acc_score: 0.9193; val_best_f1_score: 0.9225; train_kl_reg_loss: 26216.4021; train_edge_recon_loss: 2657529.7778; train_gene_expr_recon_loss: 945798.6111; train_masked_gp_l1_reg_loss: 7594.8868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23631.3620; train_chrom_access_recon_loss: 458110.3993; train_global_loss: 4118881.3889; train_optim_loss: 4118881.3889; val_kl_reg_loss: 20166.8398; val_edge_recon_loss: 2675680.2500; val_gene_expr_recon_loss: 945467.2500; val_masked_gp_l1_reg_loss: 7576.8916; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23434.2227; val_chrom_access_recon_loss: 456558.8750; val_global_loss: 4128884.5000; val_optim_loss: 4128884.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9678; val_auprc_score: 0.9575; val_best_acc_score: 0.9153; val_best_f1_score: 0.9189; train_kl_reg_loss: 26278.9325; train_edge_recon_loss: 2659951.4722; train_gene_expr_recon_loss: 949042.2639; train_masked_gp_l1_reg_loss: 7573.3247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23316.2300; train_chrom_access_recon_loss: 459425.3854; train_global_loss: 4125587.6667; train_optim_loss: 4125587.6667; val_kl_reg_loss: 20065.0898; val_edge_recon_loss: 2685109.7500; val_gene_expr_recon_loss: 945113.6875; val_masked_gp_l1_reg_loss: 7568.2593; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23162.9141; val_chrom_access_recon_loss: 456518.9375; val_global_loss: 4137538.7500; val_optim_loss: 4137538.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9698; val_auprc_score: 0.9607; val_best_acc_score: 0.9198; val_best_f1_score: 0.9230; train_kl_reg_loss: 26085.9523; train_edge_recon_loss: 2660964.6944; train_gene_expr_recon_loss: 948263.7569; train_masked_gp_l1_reg_loss: 7567.7007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23052.4698; train_chrom_access_recon_loss: 458582.8021; train_global_loss: 4124517.4444; train_optim_loss: 4124517.4444; val_kl_reg_loss: 19964.2969; val_edge_recon_loss: 2673721.2500; val_gene_expr_recon_loss: 945311.2500; val_masked_gp_l1_reg_loss: 7567.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22917.5820; val_chrom_access_recon_loss: 456612.5625; val_global_loss: 4126094.0000; val_optim_loss: 4126094.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9664; val_auprc_score: 0.9523; val_best_acc_score: 0.9174; val_best_f1_score: 0.9207; train_kl_reg_loss: 25798.0770; train_edge_recon_loss: 2656691.2500; train_gene_expr_recon_loss: 946911.1875; train_masked_gp_l1_reg_loss: 7568.0614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22815.3700; train_chrom_access_recon_loss: 457693.8715; train_global_loss: 4117477.8611; train_optim_loss: 4117477.8611; val_kl_reg_loss: 19685.6055; val_edge_recon_loss: 2675154.0000; val_gene_expr_recon_loss: 945110.2500; val_masked_gp_l1_reg_loss: 7569.7803; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22693.3398; val_chrom_access_recon_loss: 456557.8750; val_global_loss: 4126770.5000; val_optim_loss: 4126770.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9616
val AUPRC score: 0.9488
val best accuracy score: 0.9053
val best F1 score: 0.9105
val target rna MSE score: 4.0109
val source rna MSE score: 3.1677
val target atac MSE score: 0.1343
val source atac MSE score: 0.0211
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
