[True]
Run timestamp: 01082023_061046_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9028; val_auprc_score: 0.9813; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 16966.8913; train_edge_recon_loss: 11585.8133; train_gene_expr_recon_loss: 507204.6649; train_masked_gp_l1_reg_loss: 5134.5052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58349.3366; train_global_loss: 599241.2130; train_optim_loss: 599241.2130; val_kl_reg_loss: 14205.7419; val_edge_recon_loss: 12039.4209; val_gene_expr_recon_loss: 419192.9583; val_masked_gp_l1_reg_loss: 4469.5972; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53259.3008; val_global_loss: 503167.0312; val_optim_loss: 503167.0312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8914; val_auprc_score: 0.9796; val_best_acc_score: 0.8588; val_best_f1_score: 0.9235; train_kl_reg_loss: 13884.7802; train_edge_recon_loss: 11572.6267; train_gene_expr_recon_loss: 369566.6366; train_masked_gp_l1_reg_loss: 4247.7860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49111.4243; train_global_loss: 448383.2535; train_optim_loss: 448383.2535; val_kl_reg_loss: 12852.3893; val_edge_recon_loss: 11998.6737; val_gene_expr_recon_loss: 312307.5365; val_masked_gp_l1_reg_loss: 4131.5405; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45070.6836; val_global_loss: 386360.8281; val_optim_loss: 386360.8281
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8688; val_auprc_score: 0.9746; val_best_acc_score: 0.8604; val_best_f1_score: 0.9238; train_kl_reg_loss: 13116.3741; train_edge_recon_loss: 11572.0170; train_gene_expr_recon_loss: 274520.0877; train_masked_gp_l1_reg_loss: 4107.8064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41436.2704; train_global_loss: 344752.5567; train_optim_loss: 344752.5567; val_kl_reg_loss: 12494.9966; val_edge_recon_loss: 11942.0057; val_gene_expr_recon_loss: 249173.6016; val_masked_gp_l1_reg_loss: 4102.7798; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37767.9648; val_global_loss: 315481.3438; val_optim_loss: 315481.3438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8456; val_auprc_score: 0.9696; val_best_acc_score: 0.8698; val_best_f1_score: 0.9269; train_kl_reg_loss: 12497.1193; train_edge_recon_loss: 11677.6854; train_gene_expr_recon_loss: 241393.4337; train_masked_gp_l1_reg_loss: 4130.3334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34535.0738; train_global_loss: 304233.6487; train_optim_loss: 304233.6487; val_kl_reg_loss: 11622.9183; val_edge_recon_loss: 11884.4305; val_gene_expr_recon_loss: 235600.8750; val_masked_gp_l1_reg_loss: 4171.3872; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31396.6699; val_global_loss: 294676.2604; val_optim_loss: 294676.2604
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8436; val_auprc_score: 0.9681; val_best_acc_score: 0.8617; val_best_f1_score: 0.9243; train_kl_reg_loss: 11543.0928; train_edge_recon_loss: 11536.7250; train_gene_expr_recon_loss: 233020.6927; train_masked_gp_l1_reg_loss: 4221.5362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28850.5835; train_global_loss: 289172.6308; train_optim_loss: 289172.6308; val_kl_reg_loss: 10668.6035; val_edge_recon_loss: 12121.5345; val_gene_expr_recon_loss: 230189.5182; val_masked_gp_l1_reg_loss: 4276.2759; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26471.8926; val_global_loss: 283727.8385; val_optim_loss: 283727.8385
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8396; val_auprc_score: 0.9672; val_best_acc_score: 0.8740; val_best_f1_score: 0.9303; train_kl_reg_loss: 10729.6057; train_edge_recon_loss: 11341.4549; train_gene_expr_recon_loss: 228504.4980; train_masked_gp_l1_reg_loss: 4329.8509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24716.5936; train_global_loss: 279622.0041; train_optim_loss: 279622.0041; val_kl_reg_loss: 10112.8584; val_edge_recon_loss: 11861.5798; val_gene_expr_recon_loss: 225909.7995; val_masked_gp_l1_reg_loss: 4386.6436; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23168.9824; val_global_loss: 275439.8542; val_optim_loss: 275439.8542
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8403; val_auprc_score: 0.9672; val_best_acc_score: 0.8671; val_best_f1_score: 0.9269; train_kl_reg_loss: 10098.0863; train_edge_recon_loss: 11401.4708; train_gene_expr_recon_loss: 225176.9080; train_masked_gp_l1_reg_loss: 4440.2928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21898.4091; train_global_loss: 273015.1672; train_optim_loss: 273015.1672; val_kl_reg_loss: 9591.5853; val_edge_recon_loss: 11987.4753; val_gene_expr_recon_loss: 223172.8724; val_masked_gp_l1_reg_loss: 4497.3740; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20626.6445; val_global_loss: 269875.9635; val_optim_loss: 269875.9635
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8494; val_auprc_score: 0.9701; val_best_acc_score: 0.8722; val_best_f1_score: 0.9295; train_kl_reg_loss: 9617.5909; train_edge_recon_loss: 11390.7752; train_gene_expr_recon_loss: 222289.4688; train_masked_gp_l1_reg_loss: 4549.1219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19486.1995; train_global_loss: 267333.1539; train_optim_loss: 267333.1539; val_kl_reg_loss: 9200.1125; val_edge_recon_loss: 11663.0251; val_gene_expr_recon_loss: 220788.9245; val_masked_gp_l1_reg_loss: 4601.1694; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18350.4570; val_global_loss: 264603.6927; val_optim_loss: 264603.6927
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8547; val_auprc_score: 0.9707; val_best_acc_score: 0.8709; val_best_f1_score: 0.9287; train_kl_reg_loss: 9218.7743; train_edge_recon_loss: 11326.6828; train_gene_expr_recon_loss: 219826.5382; train_masked_gp_l1_reg_loss: 4645.3561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17347.1170; train_global_loss: 262364.4690; train_optim_loss: 262364.4690; val_kl_reg_loss: 8714.2144; val_edge_recon_loss: 11612.5511; val_gene_expr_recon_loss: 218035.2109; val_masked_gp_l1_reg_loss: 4690.6748; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16354.8643; val_global_loss: 259407.5104; val_optim_loss: 259407.5104
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8615; val_auprc_score: 0.9718; val_best_acc_score: 0.8713; val_best_f1_score: 0.9287; train_kl_reg_loss: 8872.0322; train_edge_recon_loss: 11198.3843; train_gene_expr_recon_loss: 217575.2222; train_masked_gp_l1_reg_loss: 4728.1042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15488.9797; train_global_loss: 257862.7219; train_optim_loss: 257862.7219; val_kl_reg_loss: 8471.6432; val_edge_recon_loss: 11763.3201; val_gene_expr_recon_loss: 215987.6172; val_masked_gp_l1_reg_loss: 4766.5718; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14634.5547; val_global_loss: 255623.7135; val_optim_loss: 255623.7135
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8691; val_auprc_score: 0.9729; val_best_acc_score: 0.8746; val_best_f1_score: 0.9298; train_kl_reg_loss: 8579.0563; train_edge_recon_loss: 11176.0752; train_gene_expr_recon_loss: 215600.1617; train_masked_gp_l1_reg_loss: 4799.7474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13894.0135; train_global_loss: 254049.0535; train_optim_loss: 254049.0535; val_kl_reg_loss: 8224.0111; val_edge_recon_loss: 11732.1978; val_gene_expr_recon_loss: 214376.6068; val_masked_gp_l1_reg_loss: 4832.6475; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13163.2344; val_global_loss: 252328.6901; val_optim_loss: 252328.6901
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8701; val_auprc_score: 0.9721; val_best_acc_score: 0.8759; val_best_f1_score: 0.9309; train_kl_reg_loss: 8316.4201; train_edge_recon_loss: 11200.8024; train_gene_expr_recon_loss: 213749.4016; train_masked_gp_l1_reg_loss: 4861.3225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12529.1319; train_global_loss: 250657.0778; train_optim_loss: 250657.0778; val_kl_reg_loss: 7903.8597; val_edge_recon_loss: 11653.3268; val_gene_expr_recon_loss: 212519.5755; val_masked_gp_l1_reg_loss: 4888.8101; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11904.5322; val_global_loss: 248870.1068; val_optim_loss: 248870.1068
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8800; val_auprc_score: 0.9750; val_best_acc_score: 0.8773; val_best_f1_score: 0.9308; train_kl_reg_loss: 8082.4342; train_edge_recon_loss: 11173.5634; train_gene_expr_recon_loss: 211933.1354; train_masked_gp_l1_reg_loss: 4912.6431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11369.5482; train_global_loss: 247471.3244; train_optim_loss: 247471.3244; val_kl_reg_loss: 7703.6107; val_edge_recon_loss: 11772.0841; val_gene_expr_recon_loss: 210361.0339; val_masked_gp_l1_reg_loss: 4936.1929; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10843.3184; val_global_loss: 245616.2318; val_optim_loss: 245616.2318
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8883; val_auprc_score: 0.9777; val_best_acc_score: 0.8805; val_best_f1_score: 0.9325; train_kl_reg_loss: 7862.8240; train_edge_recon_loss: 11075.3481; train_gene_expr_recon_loss: 210201.4025; train_masked_gp_l1_reg_loss: 4954.8550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10390.9501; train_global_loss: 244485.3791; train_optim_loss: 244485.3791; val_kl_reg_loss: 7463.4077; val_edge_recon_loss: 11443.4510; val_gene_expr_recon_loss: 208637.9792; val_masked_gp_l1_reg_loss: 4973.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9946.3613; val_global_loss: 242464.6953; val_optim_loss: 242464.6953
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8812; val_auprc_score: 0.9747; val_best_acc_score: 0.8799; val_best_f1_score: 0.9319; train_kl_reg_loss: 7653.7668; train_edge_recon_loss: 11027.1727; train_gene_expr_recon_loss: 208414.4552; train_masked_gp_l1_reg_loss: 4986.2757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9569.0951; train_global_loss: 241650.7662; train_optim_loss: 241650.7662; val_kl_reg_loss: 7269.6979; val_edge_recon_loss: 11652.1683; val_gene_expr_recon_loss: 207438.8411; val_masked_gp_l1_reg_loss: 4997.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9199.5508; val_global_loss: 240557.9089; val_optim_loss: 240557.9089
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8959; val_auprc_score: 0.9780; val_best_acc_score: 0.8858; val_best_f1_score: 0.9346; train_kl_reg_loss: 7438.1803; train_edge_recon_loss: 11066.2168; train_gene_expr_recon_loss: 206752.2049; train_masked_gp_l1_reg_loss: 5003.1141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8883.1532; train_global_loss: 239142.8666; train_optim_loss: 239142.8666; val_kl_reg_loss: 7138.5537; val_edge_recon_loss: 11643.0677; val_gene_expr_recon_loss: 205874.6302; val_masked_gp_l1_reg_loss: 5006.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8576.9004; val_global_loss: 238240.0339; val_optim_loss: 238240.0339
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9061; val_auprc_score: 0.9800; val_best_acc_score: 0.8910; val_best_f1_score: 0.9370; train_kl_reg_loss: 7221.8551; train_edge_recon_loss: 11146.8065; train_gene_expr_recon_loss: 205130.7271; train_masked_gp_l1_reg_loss: 5006.0327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8314.8004; train_global_loss: 236820.2214; train_optim_loss: 236820.2214; val_kl_reg_loss: 6877.0860; val_edge_recon_loss: 11626.1877; val_gene_expr_recon_loss: 203759.7734; val_masked_gp_l1_reg_loss: 5003.2139; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8059.4131; val_global_loss: 235325.6719; val_optim_loss: 235325.6719
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9049; val_auprc_score: 0.9804; val_best_acc_score: 0.8900; val_best_f1_score: 0.9360; train_kl_reg_loss: 7004.0108; train_edge_recon_loss: 10932.3271; train_gene_expr_recon_loss: 203467.5645; train_masked_gp_l1_reg_loss: 4996.4016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7833.9215; train_global_loss: 234234.2263; train_optim_loss: 234234.2263; val_kl_reg_loss: 6602.5282; val_edge_recon_loss: 11552.7832; val_gene_expr_recon_loss: 202030.8646; val_masked_gp_l1_reg_loss: 4987.3921; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7607.9937; val_global_loss: 232781.5677; val_optim_loss: 232781.5677
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9008; val_auprc_score: 0.9788; val_best_acc_score: 0.8859; val_best_f1_score: 0.9348; train_kl_reg_loss: 6776.6517; train_edge_recon_loss: 11009.1440; train_gene_expr_recon_loss: 201893.2934; train_masked_gp_l1_reg_loss: 4973.9405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7404.5747; train_global_loss: 232057.6030; train_optim_loss: 232057.6030; val_kl_reg_loss: 6462.1279; val_edge_recon_loss: 11941.2194; val_gene_expr_recon_loss: 200662.8672; val_masked_gp_l1_reg_loss: 4958.2808; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7200.1279; val_global_loss: 231224.6250; val_optim_loss: 231224.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9067; val_auprc_score: 0.9806; val_best_acc_score: 0.8923; val_best_f1_score: 0.9382; train_kl_reg_loss: 6541.7385; train_edge_recon_loss: 10851.8059; train_gene_expr_recon_loss: 200396.6204; train_masked_gp_l1_reg_loss: 4938.4784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7013.0918; train_global_loss: 229741.7344; train_optim_loss: 229741.7344; val_kl_reg_loss: 6218.2315; val_edge_recon_loss: 11633.7456; val_gene_expr_recon_loss: 199084.4922; val_masked_gp_l1_reg_loss: 4915.5747; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6822.6016; val_global_loss: 228674.6510; val_optim_loss: 228674.6510
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9019; val_auprc_score: 0.9800; val_best_acc_score: 0.8949; val_best_f1_score: 0.9395; train_kl_reg_loss: 6306.4215; train_edge_recon_loss: 10840.2184; train_gene_expr_recon_loss: 198979.5749; train_masked_gp_l1_reg_loss: 4887.5003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6650.2984; train_global_loss: 227664.0148; train_optim_loss: 227664.0148; val_kl_reg_loss: 5955.9991; val_edge_recon_loss: 11171.1349; val_gene_expr_recon_loss: 198006.8464; val_masked_gp_l1_reg_loss: 4856.7417; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6476.3926; val_global_loss: 226467.1042; val_optim_loss: 226467.1042
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9064; val_auprc_score: 0.9811; val_best_acc_score: 0.8977; val_best_f1_score: 0.9417; train_kl_reg_loss: 6062.0885; train_edge_recon_loss: 10759.5930; train_gene_expr_recon_loss: 197603.1091; train_masked_gp_l1_reg_loss: 4821.1885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6315.1938; train_global_loss: 225561.1742; train_optim_loss: 225561.1742; val_kl_reg_loss: 5758.4111; val_edge_recon_loss: 11081.3405; val_gene_expr_recon_loss: 196638.2578; val_masked_gp_l1_reg_loss: 4782.5854; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6153.7344; val_global_loss: 224414.3229; val_optim_loss: 224414.3229
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9073; val_auprc_score: 0.9800; val_best_acc_score: 0.8978; val_best_f1_score: 0.9417; train_kl_reg_loss: 5807.9338; train_edge_recon_loss: 10669.2686; train_gene_expr_recon_loss: 196429.4265; train_masked_gp_l1_reg_loss: 4738.4907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6005.5432; train_global_loss: 223650.6629; train_optim_loss: 223650.6629; val_kl_reg_loss: 5523.2741; val_edge_recon_loss: 10987.8831; val_gene_expr_recon_loss: 195620.3802; val_masked_gp_l1_reg_loss: 4689.2764; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5857.0908; val_global_loss: 222677.9141; val_optim_loss: 222677.9141
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9088; val_auprc_score: 0.9800; val_best_acc_score: 0.8991; val_best_f1_score: 0.9416; train_kl_reg_loss: 5550.7530; train_edge_recon_loss: 10655.1714; train_gene_expr_recon_loss: 195280.0680; train_masked_gp_l1_reg_loss: 4636.9135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5722.1572; train_global_loss: 221845.0634; train_optim_loss: 221845.0634; val_kl_reg_loss: 5312.6715; val_edge_recon_loss: 11426.5296; val_gene_expr_recon_loss: 194121.0677; val_masked_gp_l1_reg_loss: 4579.7451; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5585.0166; val_global_loss: 221025.0339; val_optim_loss: 221025.0339
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9179; val_auprc_score: 0.9833; val_best_acc_score: 0.9019; val_best_f1_score: 0.9436; train_kl_reg_loss: 5296.5726; train_edge_recon_loss: 10670.9673; train_gene_expr_recon_loss: 194085.1936; train_masked_gp_l1_reg_loss: 4520.6269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5463.8906; train_global_loss: 220037.2532; train_optim_loss: 220037.2532; val_kl_reg_loss: 4994.4340; val_edge_recon_loss: 11258.2681; val_gene_expr_recon_loss: 193077.8724; val_masked_gp_l1_reg_loss: 4458.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5343.0146; val_global_loss: 219132.3880; val_optim_loss: 219132.3880
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8769; val_auprc_score: 0.9754; val_best_acc_score: 0.8755; val_best_f1_score: 0.9314; train_kl_reg_loss: 126958.4001; train_edge_recon_loss: 11667.2416; train_gene_expr_recon_loss: 951500.9416; train_masked_gp_l1_reg_loss: 5151.6420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4669.3542; train_global_loss: 1099947.5723; train_optim_loss: 1099947.5723; val_kl_reg_loss: 49121.3997; val_edge_recon_loss: 11856.6644; val_gene_expr_recon_loss: 315820.7552; val_masked_gp_l1_reg_loss: 5521.8662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3926.5237; val_global_loss: 386247.2240; val_optim_loss: 386247.2240
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8629; val_auprc_score: 0.9728; val_best_acc_score: 0.8662; val_best_f1_score: 0.9264; train_kl_reg_loss: 29956.1369; train_edge_recon_loss: 11796.0352; train_gene_expr_recon_loss: 285499.7066; train_masked_gp_l1_reg_loss: 5260.4769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3406.3444; train_global_loss: 335918.7020; train_optim_loss: 335918.7020; val_kl_reg_loss: 18434.1491; val_edge_recon_loss: 11866.3260; val_gene_expr_recon_loss: 262275.4219; val_masked_gp_l1_reg_loss: 5020.9331; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2966.2480; val_global_loss: 300563.0833; val_optim_loss: 300563.0833
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8546; val_auprc_score: 0.9721; val_best_acc_score: 0.8678; val_best_f1_score: 0.9276; train_kl_reg_loss: 15326.5297; train_edge_recon_loss: 11739.0483; train_gene_expr_recon_loss: 249762.1470; train_masked_gp_l1_reg_loss: 4845.0850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2678.4378; train_global_loss: 284351.2500; train_optim_loss: 284351.2500; val_kl_reg_loss: 12398.5895; val_edge_recon_loss: 11515.2025; val_gene_expr_recon_loss: 239379.5729; val_masked_gp_l1_reg_loss: 4676.7051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2425.3677; val_global_loss: 270395.4531; val_optim_loss: 270395.4531
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8433; val_auprc_score: 0.9682; val_best_acc_score: 0.8685; val_best_f1_score: 0.9275; train_kl_reg_loss: 11272.7271; train_edge_recon_loss: 11241.5392; train_gene_expr_recon_loss: 232349.2650; train_masked_gp_l1_reg_loss: 4528.4172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2246.4098; train_global_loss: 261638.3600; train_optim_loss: 261638.3600; val_kl_reg_loss: 9905.9854; val_edge_recon_loss: 11586.1800; val_gene_expr_recon_loss: 225225.1745; val_masked_gp_l1_reg_loss: 4378.9673; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2084.3062; val_global_loss: 253180.6198; val_optim_loss: 253180.6198

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8579; val_auprc_score: 0.9718; val_best_acc_score: 0.8719; val_best_f1_score: 0.9290; train_kl_reg_loss: 10016.2510; train_edge_recon_loss: 11035.2701; train_gene_expr_recon_loss: 225516.7341; train_masked_gp_l1_reg_loss: 4332.9478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2040.8411; train_global_loss: 252942.0443; train_optim_loss: 252942.0443; val_kl_reg_loss: 9660.1095; val_edge_recon_loss: 11521.6211; val_gene_expr_recon_loss: 224858.7474; val_masked_gp_l1_reg_loss: 4310.9761; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2020.2957; val_global_loss: 252371.7422; val_optim_loss: 252371.7422
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8454; val_auprc_score: 0.9678; val_best_acc_score: 0.8698; val_best_f1_score: 0.9277; train_kl_reg_loss: 9835.2337; train_edge_recon_loss: 11020.2936; train_gene_expr_recon_loss: 224442.3976; train_masked_gp_l1_reg_loss: 4295.7172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2006.6177; train_global_loss: 251600.2607; train_optim_loss: 251600.2607; val_kl_reg_loss: 9556.4914; val_edge_recon_loss: 11671.5938; val_gene_expr_recon_loss: 223663.6615; val_masked_gp_l1_reg_loss: 4280.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1992.7185; val_global_loss: 251164.6198; val_optim_loss: 251164.6198
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8396; val_auprc_score: 0.9682; val_best_acc_score: 0.8731; val_best_f1_score: 0.9305; train_kl_reg_loss: 9683.8706; train_edge_recon_loss: 10886.3825; train_gene_expr_recon_loss: 223560.3695; train_masked_gp_l1_reg_loss: 4265.0209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1979.4522; train_global_loss: 250375.0975; train_optim_loss: 250375.0975; val_kl_reg_loss: 9375.8838; val_edge_recon_loss: 11164.0449; val_gene_expr_recon_loss: 222757.4844; val_masked_gp_l1_reg_loss: 4249.3579; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1965.7892; val_global_loss: 249512.5677; val_optim_loss: 249512.5677
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8458; val_auprc_score: 0.9683; val_best_acc_score: 0.8737; val_best_f1_score: 0.9300; train_kl_reg_loss: 9535.4288; train_edge_recon_loss: 10966.9578; train_gene_expr_recon_loss: 222752.9450; train_masked_gp_l1_reg_loss: 4233.9820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1952.5461; train_global_loss: 249441.8614; train_optim_loss: 249441.8614; val_kl_reg_loss: 9222.2839; val_edge_recon_loss: 11360.4881; val_gene_expr_recon_loss: 221995.4036; val_masked_gp_l1_reg_loss: 4217.9746; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1938.8420; val_global_loss: 248734.9922; val_optim_loss: 248734.9922

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 54 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9149
val AUPRC score: 0.9828
val best accuracy score: 0.9054
val best F1 score: 0.9454
val target rna MSE score: 24.3095
val source rna MSE score: 100.2060
Val cat covariate0 mean sim diff: -0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
