[True]
Run timestamp: 01082023_093831_83.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_83']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9028; val_auprc_score: 0.9816; val_best_acc_score: 0.8588; val_best_f1_score: 0.9236; train_kl_reg_loss: 39187.9419; train_edge_recon_loss: 1034680.5394; train_gene_expr_recon_loss: 486603.2471; train_masked_gp_l1_reg_loss: 10811.0618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58196.8288; train_global_loss: 1629479.6065; train_optim_loss: 1629479.6065; val_kl_reg_loss: 20545.5339; val_edge_recon_loss: 1188766.1042; val_gene_expr_recon_loss: 416842.6198; val_masked_gp_l1_reg_loss: 9882.7256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52792.2969; val_global_loss: 1688829.2500; val_optim_loss: 1688829.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8916; val_auprc_score: 0.9796; val_best_acc_score: 0.8664; val_best_f1_score: 0.9273; train_kl_reg_loss: 18136.9041; train_edge_recon_loss: 1040551.6377; train_gene_expr_recon_loss: 359216.4774; train_masked_gp_l1_reg_loss: 9251.3139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48355.3138; train_global_loss: 1475511.6412; train_optim_loss: 1475511.6412; val_kl_reg_loss: 11576.0715; val_edge_recon_loss: 1183022.4583; val_gene_expr_recon_loss: 302351.2135; val_masked_gp_l1_reg_loss: 8750.2676; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43980.3516; val_global_loss: 1549680.3958; val_optim_loss: 1549680.3958
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8795; val_auprc_score: 0.9763; val_best_acc_score: 0.8712; val_best_f1_score: 0.9294; train_kl_reg_loss: 12869.6206; train_edge_recon_loss: 1032204.0486; train_gene_expr_recon_loss: 279146.3316; train_masked_gp_l1_reg_loss: 8422.2070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39935.8126; train_global_loss: 1372578.0417; train_optim_loss: 1372578.0417; val_kl_reg_loss: 11573.3958; val_edge_recon_loss: 1193007.6458; val_gene_expr_recon_loss: 263270.4948; val_masked_gp_l1_reg_loss: 8135.8423; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35867.2344; val_global_loss: 1511854.6667; val_optim_loss: 1511854.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8642; val_auprc_score: 0.9724; val_best_acc_score: 0.8678; val_best_f1_score: 0.9279; train_kl_reg_loss: 11772.8006; train_edge_recon_loss: 1031258.2465; train_gene_expr_recon_loss: 257462.7321; train_masked_gp_l1_reg_loss: 7944.2878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32360.7839; train_global_loss: 1340798.8333; train_optim_loss: 1340798.8333; val_kl_reg_loss: 11141.6382; val_edge_recon_loss: 1202291.3750; val_gene_expr_recon_loss: 251103.1875; val_masked_gp_l1_reg_loss: 7773.0132; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28966.0742; val_global_loss: 1501275.2917; val_optim_loss: 1501275.2917
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8418; val_auprc_score: 0.9655; val_best_acc_score: 0.8817; val_best_f1_score: 0.9347; train_kl_reg_loss: 9836.4827; train_edge_recon_loss: 1018374.8681; train_gene_expr_recon_loss: 249815.6152; train_masked_gp_l1_reg_loss: 7661.7603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26230.8405; train_global_loss: 1311919.5602; train_optim_loss: 1311919.5602; val_kl_reg_loss: 5602.2086; val_edge_recon_loss: 1022719.0208; val_gene_expr_recon_loss: 253338.6641; val_masked_gp_l1_reg_loss: 7596.5830; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23737.6465; val_global_loss: 1312994.1458; val_optim_loss: 1312994.1458
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8441; val_auprc_score: 0.9632; val_best_acc_score: 0.8900; val_best_f1_score: 0.9384; train_kl_reg_loss: 13719.9171; train_edge_recon_loss: 910766.7616; train_gene_expr_recon_loss: 256975.6620; train_masked_gp_l1_reg_loss: 7661.9953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22080.2283; train_global_loss: 1211204.5463; train_optim_loss: 1211204.5463; val_kl_reg_loss: 16957.7477; val_edge_recon_loss: 903108.9688; val_gene_expr_recon_loss: 249493.1510; val_masked_gp_l1_reg_loss: 7682.6025; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20607.1523; val_global_loss: 1197849.6250; val_optim_loss: 1197849.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8447; val_auprc_score: 0.9630; val_best_acc_score: 0.9077; val_best_f1_score: 0.9483; train_kl_reg_loss: 16423.1854; train_edge_recon_loss: 872719.3553; train_gene_expr_recon_loss: 247837.7477; train_masked_gp_l1_reg_loss: 7619.8563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19422.7595; train_global_loss: 1164022.9051; train_optim_loss: 1164022.9051; val_kl_reg_loss: 17052.7503; val_edge_recon_loss: 859671.0104; val_gene_expr_recon_loss: 245443.6745; val_masked_gp_l1_reg_loss: 7530.6104; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18262.5469; val_global_loss: 1147960.5625; val_optim_loss: 1147960.5625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8650; val_auprc_score: 0.9688; val_best_acc_score: 0.9127; val_best_f1_score: 0.9508; train_kl_reg_loss: 15869.8219; train_edge_recon_loss: 855643.9375; train_gene_expr_recon_loss: 243419.1105; train_masked_gp_l1_reg_loss: 7416.9620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17265.5262; train_global_loss: 1139615.3727; train_optim_loss: 1139615.3727; val_kl_reg_loss: 13526.8630; val_edge_recon_loss: 821618.9792; val_gene_expr_recon_loss: 242194.1146; val_masked_gp_l1_reg_loss: 7280.5947; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16311.7285; val_global_loss: 1100932.3125; val_optim_loss: 1100932.3125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8753; val_auprc_score: 0.9694; val_best_acc_score: 0.9046; val_best_f1_score: 0.9456; train_kl_reg_loss: 14613.3406; train_edge_recon_loss: 831778.2812; train_gene_expr_recon_loss: 239765.2098; train_masked_gp_l1_reg_loss: 7126.0242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15539.5980; train_global_loss: 1108822.4595; train_optim_loss: 1108822.4595; val_kl_reg_loss: 14474.9774; val_edge_recon_loss: 863330.2292; val_gene_expr_recon_loss: 237187.8438; val_masked_gp_l1_reg_loss: 6965.1807; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14796.4824; val_global_loss: 1136754.6667; val_optim_loss: 1136754.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8966; val_auprc_score: 0.9750; val_best_acc_score: 0.9217; val_best_f1_score: 0.9552; train_kl_reg_loss: 14067.0030; train_edge_recon_loss: 817205.7940; train_gene_expr_recon_loss: 235289.8950; train_masked_gp_l1_reg_loss: 6808.1883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14213.4505; train_global_loss: 1087584.3264; train_optim_loss: 1087584.3264; val_kl_reg_loss: 14565.4668; val_edge_recon_loss: 818559.0625; val_gene_expr_recon_loss: 232741.7943; val_masked_gp_l1_reg_loss: 6636.3159; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13666.4238; val_global_loss: 1086169.0833; val_optim_loss: 1086169.0833
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9175; val_auprc_score: 0.9807; val_best_acc_score: 0.9254; val_best_f1_score: 0.9574; train_kl_reg_loss: 14798.4214; train_edge_recon_loss: 807787.2407; train_gene_expr_recon_loss: 229751.5258; train_masked_gp_l1_reg_loss: 6449.0397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13169.6759; train_global_loss: 1071955.8970; train_optim_loss: 1071955.8970; val_kl_reg_loss: 14382.8815; val_edge_recon_loss: 824739.8021; val_gene_expr_recon_loss: 226521.2292; val_masked_gp_l1_reg_loss: 6244.2134; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12678.8945; val_global_loss: 1084567.0000; val_optim_loss: 1084567.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9078; val_auprc_score: 0.9773; val_best_acc_score: 0.9241; val_best_f1_score: 0.9564; train_kl_reg_loss: 14816.3571; train_edge_recon_loss: 802235.1493; train_gene_expr_recon_loss: 225083.4633; train_masked_gp_l1_reg_loss: 6039.4158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12250.3855; train_global_loss: 1060424.7720; train_optim_loss: 1060424.7720; val_kl_reg_loss: 13262.0757; val_edge_recon_loss: 836780.1667; val_gene_expr_recon_loss: 223443.2708; val_masked_gp_l1_reg_loss: 5823.7715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11824.0332; val_global_loss: 1091133.2917; val_optim_loss: 1091133.2917
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9197; val_auprc_score: 0.9810; val_best_acc_score: 0.9264; val_best_f1_score: 0.9577; train_kl_reg_loss: 13786.7446; train_edge_recon_loss: 801092.2373; train_gene_expr_recon_loss: 221428.4363; train_masked_gp_l1_reg_loss: 5616.1380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11476.4551; train_global_loss: 1053400.0127; train_optim_loss: 1053400.0127; val_kl_reg_loss: 13241.0270; val_edge_recon_loss: 821081.9896; val_gene_expr_recon_loss: 219196.0938; val_masked_gp_l1_reg_loss: 5403.0542; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11147.4102; val_global_loss: 1070069.5521; val_optim_loss: 1070069.5521
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9169; val_auprc_score: 0.9803; val_best_acc_score: 0.9249; val_best_f1_score: 0.9572; train_kl_reg_loss: 13278.9514; train_edge_recon_loss: 796628.1493; train_gene_expr_recon_loss: 218017.0645; train_masked_gp_l1_reg_loss: 5203.1863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10858.2427; train_global_loss: 1043985.6007; train_optim_loss: 1043985.6007; val_kl_reg_loss: 12036.0340; val_edge_recon_loss: 820557.0938; val_gene_expr_recon_loss: 216214.2448; val_masked_gp_l1_reg_loss: 4996.7168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10577.7842; val_global_loss: 1064381.8438; val_optim_loss: 1064381.8438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9221; val_auprc_score: 0.9828; val_best_acc_score: 0.9267; val_best_f1_score: 0.9580; train_kl_reg_loss: 12346.2235; train_edge_recon_loss: 801260.4387; train_gene_expr_recon_loss: 215165.7138; train_masked_gp_l1_reg_loss: 4801.7852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10336.8883; train_global_loss: 1043911.0567; train_optim_loss: 1043911.0567; val_kl_reg_loss: 11309.5334; val_edge_recon_loss: 810103.6979; val_gene_expr_recon_loss: 213634.6953; val_masked_gp_l1_reg_loss: 4603.9839; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10111.0762; val_global_loss: 1049763.0312; val_optim_loss: 1049763.0312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9337; val_auprc_score: 0.9862; val_best_acc_score: 0.9287; val_best_f1_score: 0.9590; train_kl_reg_loss: 11826.9526; train_edge_recon_loss: 787715.2824; train_gene_expr_recon_loss: 212356.6632; train_masked_gp_l1_reg_loss: 4416.2030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9886.6309; train_global_loss: 1026201.7454; train_optim_loss: 1026201.7454; val_kl_reg_loss: 11014.0951; val_edge_recon_loss: 787107.9583; val_gene_expr_recon_loss: 211072.6667; val_masked_gp_l1_reg_loss: 4227.1235; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9662.5107; val_global_loss: 1023084.3333; val_optim_loss: 1023084.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9391; val_auprc_score: 0.9864; val_best_acc_score: 0.9303; val_best_f1_score: 0.9598; train_kl_reg_loss: 11397.8955; train_edge_recon_loss: 786196.3588; train_gene_expr_recon_loss: 209951.6386; train_masked_gp_l1_reg_loss: 4056.1353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9462.4905; train_global_loss: 1021064.5266; train_optim_loss: 1021064.5266; val_kl_reg_loss: 10674.6794; val_edge_recon_loss: 800539.3750; val_gene_expr_recon_loss: 208340.0286; val_masked_gp_l1_reg_loss: 3888.8726; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9270.8584; val_global_loss: 1032713.8125; val_optim_loss: 1032713.8125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9454; val_auprc_score: 0.9882; val_best_acc_score: 0.9324; val_best_f1_score: 0.9610; train_kl_reg_loss: 10681.1340; train_edge_recon_loss: 785484.5301; train_gene_expr_recon_loss: 207722.7512; train_masked_gp_l1_reg_loss: 3732.5814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9069.9831; train_global_loss: 1016690.9884; train_optim_loss: 1016690.9884; val_kl_reg_loss: 10563.6193; val_edge_recon_loss: 788181.4688; val_gene_expr_recon_loss: 205839.8906; val_masked_gp_l1_reg_loss: 3575.3657; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8871.8682; val_global_loss: 1017032.2083; val_optim_loss: 1017032.2083
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9442; val_auprc_score: 0.9874; val_best_acc_score: 0.9388; val_best_f1_score: 0.9648; train_kl_reg_loss: 10589.0578; train_edge_recon_loss: 784786.1528; train_gene_expr_recon_loss: 205628.2112; train_masked_gp_l1_reg_loss: 3435.1560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8675.1699; train_global_loss: 1013113.7396; train_optim_loss: 1013113.7396; val_kl_reg_loss: 10805.0160; val_edge_recon_loss: 767686.4375; val_gene_expr_recon_loss: 203974.4661; val_masked_gp_l1_reg_loss: 3299.1279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8456.2100; val_global_loss: 994221.2292; val_optim_loss: 994221.2292
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9495; val_auprc_score: 0.9888; val_best_acc_score: 0.9396; val_best_f1_score: 0.9651; train_kl_reg_loss: 10794.3233; train_edge_recon_loss: 776775.1169; train_gene_expr_recon_loss: 203380.4083; train_masked_gp_l1_reg_loss: 3175.4292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8221.8253; train_global_loss: 1002347.0984; train_optim_loss: 1002347.0984; val_kl_reg_loss: 10186.5041; val_edge_recon_loss: 796253.4479; val_gene_expr_recon_loss: 202376.4297; val_masked_gp_l1_reg_loss: 3061.7988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7984.9341; val_global_loss: 1019863.1146; val_optim_loss: 1019863.1146
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9502; val_auprc_score: 0.9886; val_best_acc_score: 0.9404; val_best_f1_score: 0.9657; train_kl_reg_loss: 10403.4046; train_edge_recon_loss: 780367.0799; train_gene_expr_recon_loss: 201516.6942; train_masked_gp_l1_reg_loss: 2957.9128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7749.7684; train_global_loss: 1002994.8623; train_optim_loss: 1002994.8623; val_kl_reg_loss: 9983.0825; val_edge_recon_loss: 777661.8021; val_gene_expr_recon_loss: 201071.8854; val_masked_gp_l1_reg_loss: 2858.5308; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7521.7744; val_global_loss: 999097.0104; val_optim_loss: 999097.0104
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9567; val_auprc_score: 0.9909; val_best_acc_score: 0.9403; val_best_f1_score: 0.9654; train_kl_reg_loss: 10189.7813; train_edge_recon_loss: 778040.2083; train_gene_expr_recon_loss: 199913.4635; train_masked_gp_l1_reg_loss: 2768.2413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7294.4382; train_global_loss: 998206.1319; train_optim_loss: 998206.1319; val_kl_reg_loss: 9953.4499; val_edge_recon_loss: 784945.8438; val_gene_expr_recon_loss: 199083.9297; val_masked_gp_l1_reg_loss: 2677.7371; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7060.8584; val_global_loss: 1003721.8333; val_optim_loss: 1003721.8333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9479; val_auprc_score: 0.9871; val_best_acc_score: 0.9402; val_best_f1_score: 0.9655; train_kl_reg_loss: 10239.0342; train_edge_recon_loss: 785369.3611; train_gene_expr_recon_loss: 198303.4656; train_masked_gp_l1_reg_loss: 2603.3704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6833.9252; train_global_loss: 1003349.1632; train_optim_loss: 1003349.1632; val_kl_reg_loss: 10118.1517; val_edge_recon_loss: 798892.4479; val_gene_expr_recon_loss: 197682.4818; val_masked_gp_l1_reg_loss: 2524.4529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6605.0986; val_global_loss: 1015822.6354; val_optim_loss: 1015822.6354

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9578; val_auprc_score: 0.9903; val_best_acc_score: 0.9438; val_best_f1_score: 0.9674; train_kl_reg_loss: 10282.3269; train_edge_recon_loss: 770293.0139; train_gene_expr_recon_loss: 197437.7115; train_masked_gp_l1_reg_loss: 2459.2907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6547.7963; train_global_loss: 987020.1250; train_optim_loss: 987020.1250; val_kl_reg_loss: 9894.2861; val_edge_recon_loss: 766975.6667; val_gene_expr_recon_loss: 197380.4766; val_masked_gp_l1_reg_loss: 2438.7012; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6515.5293; val_global_loss: 983204.6250; val_optim_loss: 983204.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9540; val_auprc_score: 0.9899; val_best_acc_score: 0.9437; val_best_f1_score: 0.9677; train_kl_reg_loss: 10096.3979; train_edge_recon_loss: 777970.7245; train_gene_expr_recon_loss: 197244.3466; train_masked_gp_l1_reg_loss: 2430.9060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6492.2681; train_global_loss: 994234.6447; train_optim_loss: 994234.6447; val_kl_reg_loss: 9576.6009; val_edge_recon_loss: 767856.5417; val_gene_expr_recon_loss: 197093.5000; val_masked_gp_l1_reg_loss: 2423.0732; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6468.4575; val_global_loss: 983418.1354; val_optim_loss: 983418.1354
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9526; val_auprc_score: 0.9886; val_best_acc_score: 0.9427; val_best_f1_score: 0.9667; train_kl_reg_loss: 8790.6185; train_edge_recon_loss: 772838.0012; train_gene_expr_recon_loss: 277305.0625; train_masked_gp_l1_reg_loss: 2401.7474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6390.3023; train_global_loss: 1067725.7465; train_optim_loss: 1067725.7465; val_kl_reg_loss: 4734.1121; val_edge_recon_loss: 789961.1146; val_gene_expr_recon_loss: 271796.5990; val_masked_gp_l1_reg_loss: 2379.1978; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6293.8291; val_global_loss: 1075164.9375; val_optim_loss: 1075164.9375
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9540; val_auprc_score: 0.9894; val_best_acc_score: 0.9422; val_best_f1_score: 0.9666; train_kl_reg_loss: 7149.9158; train_edge_recon_loss: 770692.5023; train_gene_expr_recon_loss: 268871.5654; train_masked_gp_l1_reg_loss: 2361.0316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6199.9382; train_global_loss: 1055274.9502; train_optim_loss: 1055274.9502; val_kl_reg_loss: 4183.0549; val_edge_recon_loss: 785128.3542; val_gene_expr_recon_loss: 265719.5625; val_masked_gp_l1_reg_loss: 2343.1709; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6104.0063; val_global_loss: 1063478.1562; val_optim_loss: 1063478.1562
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9580; val_auprc_score: 0.9906; val_best_acc_score: 0.9458; val_best_f1_score: 0.9685; train_kl_reg_loss: 6491.5813; train_edge_recon_loss: 773584.6204; train_gene_expr_recon_loss: 263256.7584; train_masked_gp_l1_reg_loss: 2327.6553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6014.4754; train_global_loss: 1051675.0775; train_optim_loss: 1051675.0775; val_kl_reg_loss: 3962.6370; val_edge_recon_loss: 788870.2500; val_gene_expr_recon_loss: 260677.7031; val_masked_gp_l1_reg_loss: 2312.0120; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5922.9126; val_global_loss: 1061745.4688; val_optim_loss: 1061745.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9547; val_auprc_score: 0.9896; val_best_acc_score: 0.9444; val_best_f1_score: 0.9678; train_kl_reg_loss: 6266.4474; train_edge_recon_loss: 778288.0081; train_gene_expr_recon_loss: 260605.3999; train_masked_gp_l1_reg_loss: 2305.2852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5911.3499; train_global_loss: 1053376.4850; train_optim_loss: 1053376.4850; val_kl_reg_loss: 3930.2895; val_edge_recon_loss: 787115.0208; val_gene_expr_recon_loss: 260099.1875; val_masked_gp_l1_reg_loss: 2302.6882; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5901.7388; val_global_loss: 1059348.9479; val_optim_loss: 1059348.9479
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9526; val_auprc_score: 0.9881; val_best_acc_score: 0.9432; val_best_f1_score: 0.9672; train_kl_reg_loss: 6199.0672; train_edge_recon_loss: 775848.1169; train_gene_expr_recon_loss: 260179.4659; train_masked_gp_l1_reg_loss: 2301.2310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5893.0494; train_global_loss: 1050420.9236; train_optim_loss: 1050420.9236; val_kl_reg_loss: 3903.6198; val_edge_recon_loss: 778273.1979; val_gene_expr_recon_loss: 260023.7552; val_masked_gp_l1_reg_loss: 2299.7554; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5884.0576; val_global_loss: 1050384.3646; val_optim_loss: 1050384.3646
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9564; val_auprc_score: 0.9901; val_best_acc_score: 0.9462; val_best_f1_score: 0.9688; train_kl_reg_loss: 6123.6033; train_edge_recon_loss: 763022.3900; train_gene_expr_recon_loss: 259770.0880; train_masked_gp_l1_reg_loss: 2298.3457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5875.4043; train_global_loss: 1037089.8322; train_optim_loss: 1037089.8322; val_kl_reg_loss: 3854.2416; val_edge_recon_loss: 788901.9583; val_gene_expr_recon_loss: 259713.5599; val_masked_gp_l1_reg_loss: 2296.8638; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5866.4355; val_global_loss: 1060633.0208; val_optim_loss: 1060633.0208
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9548; val_auprc_score: 0.9897; val_best_acc_score: 0.9470; val_best_f1_score: 0.9693; train_kl_reg_loss: 6042.4065; train_edge_recon_loss: 767855.2928; train_gene_expr_recon_loss: 259488.0813; train_masked_gp_l1_reg_loss: 2295.3834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5857.7711; train_global_loss: 1041538.9468; train_optim_loss: 1041538.9468; val_kl_reg_loss: 3823.7184; val_edge_recon_loss: 759662.0833; val_gene_expr_recon_loss: 259305.5026; val_masked_gp_l1_reg_loss: 2293.9084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5848.7769; val_global_loss: 1030933.9896; val_optim_loss: 1030933.9896

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 46 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9569
val AUPRC score: 0.9909
val best accuracy score: 0.9414
val best F1 score: 0.9663
val target rna MSE score: 25.6759
val source rna MSE score: 57.0164
Val cat covariate0 mean sim diff: -0.0005

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
