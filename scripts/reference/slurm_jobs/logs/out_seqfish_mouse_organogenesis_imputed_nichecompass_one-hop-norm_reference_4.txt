Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9532; val_auprc_score: 0.9890; val_best_acc_score: 0.9439; val_best_f1_score: 0.9677; train_kl_reg_loss: 8723.1417; train_edge_recon_loss: 80287.4287; train_gene_expr_recon_loss: 1411512.4735; train_masked_gp_l1_reg_loss: 7068.5696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4135.6216; train_global_loss: 1511727.2340; train_optim_loss: 1511727.2340; val_kl_reg_loss: 8782.2303; val_edge_recon_loss: 78483.7913; val_gene_expr_recon_loss: 1412384.7448; val_masked_gp_l1_reg_loss: 7068.2676; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4120.5103; val_global_loss: 1510839.5182; val_optim_loss: 1510839.5182
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9572; val_auprc_score: 0.9909; val_best_acc_score: 0.9429; val_best_f1_score: 0.9672; train_kl_reg_loss: 8750.8033; train_edge_recon_loss: 79997.0656; train_gene_expr_recon_loss: 1411472.0343; train_masked_gp_l1_reg_loss: 7065.4352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4098.0294; train_global_loss: 1511383.3631; train_optim_loss: 1511383.3631; val_kl_reg_loss: 8710.8207; val_edge_recon_loss: 79829.8941; val_gene_expr_recon_loss: 1412366.6432; val_masked_gp_l1_reg_loss: 7066.0439; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4081.3672; val_global_loss: 1512054.7292; val_optim_loss: 1512054.7292
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9512; val_auprc_score: 0.9884; val_best_acc_score: 0.9419; val_best_f1_score: 0.9662; train_kl_reg_loss: 8775.4574; train_edge_recon_loss: 79395.8536; train_gene_expr_recon_loss: 1411471.8212; train_masked_gp_l1_reg_loss: 7063.8081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4063.7939; train_global_loss: 1510770.7358; train_optim_loss: 1510770.7358; val_kl_reg_loss: 8777.7546; val_edge_recon_loss: 81871.3072; val_gene_expr_recon_loss: 1411938.2083; val_masked_gp_l1_reg_loss: 7060.8057; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4046.0200; val_global_loss: 1513694.0078; val_optim_loss: 1513694.0078
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9541; val_auprc_score: 0.9904; val_best_acc_score: 0.9420; val_best_f1_score: 0.9667; train_kl_reg_loss: 8807.7469; train_edge_recon_loss: 78966.5144; train_gene_expr_recon_loss: 1411284.2709; train_masked_gp_l1_reg_loss: 7061.3403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4028.5240; train_global_loss: 1510148.3985; train_optim_loss: 1510148.3985; val_kl_reg_loss: 8797.7343; val_edge_recon_loss: 78039.4661; val_gene_expr_recon_loss: 1413861.0625; val_masked_gp_l1_reg_loss: 7058.1929; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4009.0745; val_global_loss: 1511765.6406; val_optim_loss: 1511765.6406
[True]
Run timestamp: 02082023_014632_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8780; val_auprc_score: 0.9762; val_best_acc_score: 0.8721; val_best_f1_score: 0.9291; train_kl_reg_loss: 40898.7917; train_edge_recon_loss: 112227.3613; train_gene_expr_recon_loss: 2414063.1735; train_masked_gp_l1_reg_loss: 9882.3582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68891.7780; train_global_loss: 2645963.4552; train_optim_loss: 2645963.4552; val_kl_reg_loss: 28212.2176; val_edge_recon_loss: 107745.8653; val_gene_expr_recon_loss: 2014352.7567; val_masked_gp_l1_reg_loss: 11517.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47582.0664; val_global_loss: 2209410.3387; val_optim_loss: 2209410.3387

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9515; val_auprc_score: 0.9891; val_best_acc_score: 0.9422; val_best_f1_score: 0.9666; train_kl_reg_loss: 8811.6986; train_edge_recon_loss: 79359.2599; train_gene_expr_recon_loss: 1410889.7320; train_masked_gp_l1_reg_loss: 7024.4652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3995.9565; train_global_loss: 1510081.1119; train_optim_loss: 1510081.1119; val_kl_reg_loss: 8839.3427; val_edge_recon_loss: 79606.4274; val_gene_expr_recon_loss: 1412468.3359; val_masked_gp_l1_reg_loss: 7019.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3991.4897; val_global_loss: 1511925.1016; val_optim_loss: 1511925.1016
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9553; val_auprc_score: 0.9901; val_best_acc_score: 0.9436; val_best_f1_score: 0.9674; train_kl_reg_loss: 8816.4376; train_edge_recon_loss: 78974.3518; train_gene_expr_recon_loss: 1410982.0515; train_masked_gp_l1_reg_loss: 7019.2098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3989.6402; train_global_loss: 1509781.6971; train_optim_loss: 1509781.6971; val_kl_reg_loss: 8795.6542; val_edge_recon_loss: 78611.7716; val_gene_expr_recon_loss: 1412110.5026; val_masked_gp_l1_reg_loss: 7018.6934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3987.6152; val_global_loss: 1510524.2995; val_optim_loss: 1510524.2995
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9244; val_auprc_score: 0.9839; val_best_acc_score: 0.9180; val_best_f1_score: 0.9528; train_kl_reg_loss: 24939.0457; train_edge_recon_loss: 102401.9667; train_gene_expr_recon_loss: 1915772.6650; train_masked_gp_l1_reg_loss: 12974.1543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36489.0178; train_global_loss: 2092576.8535; train_optim_loss: 2092576.8535; val_kl_reg_loss: 22767.5792; val_edge_recon_loss: 101706.9455; val_gene_expr_recon_loss: 1832640.0820; val_masked_gp_l1_reg_loss: 14124.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27884.7148; val_global_loss: 1999123.9086; val_optim_loss: 1999123.9086
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9515; val_auprc_score: 0.9886; val_best_acc_score: 0.9430; val_best_f1_score: 0.9671; train_kl_reg_loss: 8818.9487; train_edge_recon_loss: 79022.1921; train_gene_expr_recon_loss: 1410826.9712; train_masked_gp_l1_reg_loss: 7018.8648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3985.7003; train_global_loss: 1509672.6828; train_optim_loss: 1509672.6828; val_kl_reg_loss: 8831.0392; val_edge_recon_loss: 79821.4822; val_gene_expr_recon_loss: 1411996.1068; val_masked_gp_l1_reg_loss: 7018.7651; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3983.4370; val_global_loss: 1511650.7604; val_optim_loss: 1511650.7604
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9551; val_auprc_score: 0.9896; val_best_acc_score: 0.9454; val_best_f1_score: 0.9685; train_kl_reg_loss: 8837.6534; train_edge_recon_loss: 79519.3096; train_gene_expr_recon_loss: 1411134.2093; train_masked_gp_l1_reg_loss: 7018.4818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3981.5960; train_global_loss: 1510491.2517; train_optim_loss: 1510491.2517; val_kl_reg_loss: 8843.9708; val_edge_recon_loss: 78753.8975; val_gene_expr_recon_loss: 1412069.8125; val_masked_gp_l1_reg_loss: 7018.4189; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3979.1824; val_global_loss: 1510665.1719; val_optim_loss: 1510665.1719
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9323; val_auprc_score: 0.9845; val_best_acc_score: 0.9331; val_best_f1_score: 0.9616; train_kl_reg_loss: 20959.0858; train_edge_recon_loss: 95953.1498; train_gene_expr_recon_loss: 1768760.0460; train_masked_gp_l1_reg_loss: 14773.2308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23449.8134; train_global_loss: 1923895.3295; train_optim_loss: 1923895.3295; val_kl_reg_loss: 18995.5746; val_edge_recon_loss: 96030.6223; val_gene_expr_recon_loss: 1709955.6384; val_masked_gp_l1_reg_loss: 15096.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20044.6895; val_global_loss: 1860122.7030; val_optim_loss: 1860122.7030

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 160 min 18 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9574
val AUPRC score: 0.9906
val best accuracy score: 0.9463
val best F1 score: 0.9689
val target rna MSE score: 0.8773
val source rna MSE score: 0.4545
Val cat covariate0 mean sim diff: -0.0011

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9451; val_auprc_score: 0.9880; val_best_acc_score: 0.9398; val_best_f1_score: 0.9654; train_kl_reg_loss: 17375.8688; train_edge_recon_loss: 91328.4808; train_gene_expr_recon_loss: 1666426.6982; train_masked_gp_l1_reg_loss: 14765.5140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17883.2214; train_global_loss: 1807779.7803; train_optim_loss: 1807779.7803; val_kl_reg_loss: 16132.4444; val_edge_recon_loss: 89814.0194; val_gene_expr_recon_loss: 1624347.6841; val_masked_gp_l1_reg_loss: 14069.3643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16072.5049; val_global_loss: 1760436.0282; val_optim_loss: 1760436.0282
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9548; val_auprc_score: 0.9901; val_best_acc_score: 0.9467; val_best_f1_score: 0.9692; train_kl_reg_loss: 14139.8577; train_edge_recon_loss: 87614.2963; train_gene_expr_recon_loss: 1593452.4110; train_masked_gp_l1_reg_loss: 12896.0257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14661.4748; train_global_loss: 1722764.0630; train_optim_loss: 1722764.0630; val_kl_reg_loss: 12799.4730; val_edge_recon_loss: 86178.3242; val_gene_expr_recon_loss: 1563689.5820; val_masked_gp_l1_reg_loss: 11608.8066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13359.2578; val_global_loss: 1687635.3777; val_optim_loss: 1687635.3777
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9531; val_auprc_score: 0.9894; val_best_acc_score: 0.9468; val_best_f1_score: 0.9693; train_kl_reg_loss: 11956.6239; train_edge_recon_loss: 84324.0839; train_gene_expr_recon_loss: 1542640.5869; train_masked_gp_l1_reg_loss: 10542.4980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12332.1043; train_global_loss: 1661795.8964; train_optim_loss: 1661795.8964; val_kl_reg_loss: 11068.3318; val_edge_recon_loss: 85081.2652; val_gene_expr_recon_loss: 1522199.4839; val_masked_gp_l1_reg_loss: 9694.1885; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11300.7705; val_global_loss: 1639344.0820; val_optim_loss: 1639344.0820
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9528; val_auprc_score: 0.9898; val_best_acc_score: 0.9415; val_best_f1_score: 0.9663; train_kl_reg_loss: 10832.5582; train_edge_recon_loss: 83024.5571; train_gene_expr_recon_loss: 1507769.8498; train_masked_gp_l1_reg_loss: 9180.2471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10321.5826; train_global_loss: 1621128.7954; train_optim_loss: 1621128.7954; val_kl_reg_loss: 10584.3875; val_edge_recon_loss: 83394.3428; val_gene_expr_recon_loss: 1494414.8723; val_masked_gp_l1_reg_loss: 8805.7051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9437.2744; val_global_loss: 1606636.6089; val_optim_loss: 1606636.6089
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9561; val_auprc_score: 0.9903; val_best_acc_score: 0.9491; val_best_f1_score: 0.9706; train_kl_reg_loss: 10220.9648; train_edge_recon_loss: 81964.0695; train_gene_expr_recon_loss: 1481588.0688; train_masked_gp_l1_reg_loss: 8611.8311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8789.2882; train_global_loss: 1591174.2263; train_optim_loss: 1591174.2263; val_kl_reg_loss: 10131.4086; val_edge_recon_loss: 82607.0090; val_gene_expr_recon_loss: 1472472.3306; val_masked_gp_l1_reg_loss: 8450.6162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8176.2139; val_global_loss: 1581837.6237; val_optim_loss: 1581837.6237
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9573; val_auprc_score: 0.9902; val_best_acc_score: 0.9519; val_best_f1_score: 0.9722; train_kl_reg_loss: 9793.7341; train_edge_recon_loss: 81280.3043; train_gene_expr_recon_loss: 1463536.9972; train_masked_gp_l1_reg_loss: 8306.1897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7657.8488; train_global_loss: 1570575.0738; train_optim_loss: 1570575.0738; val_kl_reg_loss: 9459.5828; val_edge_recon_loss: 80367.2897; val_gene_expr_recon_loss: 1455975.8132; val_masked_gp_l1_reg_loss: 8182.0063; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7254.2651; val_global_loss: 1561238.9328; val_optim_loss: 1561238.9328
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9577; val_auprc_score: 0.9906; val_best_acc_score: 0.9487; val_best_f1_score: 0.9702; train_kl_reg_loss: 9527.1800; train_edge_recon_loss: 81054.0515; train_gene_expr_recon_loss: 1450974.8790; train_masked_gp_l1_reg_loss: 8089.1844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6995.6150; train_global_loss: 1556640.9110; train_optim_loss: 1556640.9110; val_kl_reg_loss: 9897.1363; val_edge_recon_loss: 82275.1408; val_gene_expr_recon_loss: 1449620.9543; val_masked_gp_l1_reg_loss: 8031.5825; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6822.1216; val_global_loss: 1556646.9812; val_optim_loss: 1556646.9812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9573; val_auprc_score: 0.9900; val_best_acc_score: 0.9516; val_best_f1_score: 0.9721; train_kl_reg_loss: 9366.6069; train_edge_recon_loss: 80781.5249; train_gene_expr_recon_loss: 1442135.9903; train_masked_gp_l1_reg_loss: 7932.7545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6649.4901; train_global_loss: 1546866.3671; train_optim_loss: 1546866.3671; val_kl_reg_loss: 9191.3593; val_edge_recon_loss: 79994.9859; val_gene_expr_recon_loss: 1437859.8804; val_masked_gp_l1_reg_loss: 7850.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6481.4756; val_global_loss: 1541378.5968; val_optim_loss: 1541378.5968
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9572; val_auprc_score: 0.9901; val_best_acc_score: 0.9507; val_best_f1_score: 0.9715; train_kl_reg_loss: 9222.7101; train_edge_recon_loss: 80502.5263; train_gene_expr_recon_loss: 1435352.0332; train_masked_gp_l1_reg_loss: 7817.1646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6375.6255; train_global_loss: 1539270.0565; train_optim_loss: 1539270.0565; val_kl_reg_loss: 9634.6212; val_edge_recon_loss: 81309.4338; val_gene_expr_recon_loss: 1435648.6626; val_masked_gp_l1_reg_loss: 7764.1084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6245.9082; val_global_loss: 1540602.7164; val_optim_loss: 1540602.7164
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9206; val_auprc_score: 0.9832; val_best_acc_score: 0.9168; val_best_f1_score: 0.9521; train_kl_reg_loss: 9373.6505; train_edge_recon_loss: 83379.5625; train_gene_expr_recon_loss: 1492591.1289; train_masked_gp_l1_reg_loss: 9449.7288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6587.0069; train_global_loss: 1601381.0744; train_optim_loss: 1601381.0744; val_kl_reg_loss: 8076.3686; val_edge_recon_loss: 83387.4600; val_gene_expr_recon_loss: 1491976.4866; val_masked_gp_l1_reg_loss: 14073.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7937.5513; val_global_loss: 1605451.1949; val_optim_loss: 1605451.1949
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9397; val_auprc_score: 0.9872; val_best_acc_score: 0.9362; val_best_f1_score: 0.9634; train_kl_reg_loss: 8245.4069; train_edge_recon_loss: 82048.2378; train_gene_expr_recon_loss: 1463172.4074; train_masked_gp_l1_reg_loss: 11415.0143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7572.8117; train_global_loss: 1572453.8826; train_optim_loss: 1572453.8826; val_kl_reg_loss: 8179.9460; val_edge_recon_loss: 80176.8101; val_gene_expr_recon_loss: 1450237.0269; val_masked_gp_l1_reg_loss: 9914.8545; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7213.6611; val_global_loss: 1555722.2796; val_optim_loss: 1555722.2796
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9426; val_auprc_score: 0.9877; val_best_acc_score: 0.9391; val_best_f1_score: 0.9650; train_kl_reg_loss: 8222.4780; train_edge_recon_loss: 81263.1009; train_gene_expr_recon_loss: 1448241.8959; train_masked_gp_l1_reg_loss: 9200.1385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6859.2282; train_global_loss: 1553786.8411; train_optim_loss: 1553786.8411; val_kl_reg_loss: 8262.9710; val_edge_recon_loss: 79331.6642; val_gene_expr_recon_loss: 1444539.7406; val_masked_gp_l1_reg_loss: 8631.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6533.4448; val_global_loss: 1547299.1223; val_optim_loss: 1547299.1223
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9494; val_auprc_score: 0.9889; val_best_acc_score: 0.9397; val_best_f1_score: 0.9653; train_kl_reg_loss: 8254.8214; train_edge_recon_loss: 81286.0786; train_gene_expr_recon_loss: 1443625.4119; train_masked_gp_l1_reg_loss: 8288.9857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6278.0948; train_global_loss: 1547733.3973; train_optim_loss: 1547733.3973; val_kl_reg_loss: 8390.6388; val_edge_recon_loss: 80686.4904; val_gene_expr_recon_loss: 1440673.3696; val_masked_gp_l1_reg_loss: 8023.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6068.6860; val_global_loss: 1543843.1277; val_optim_loss: 1543843.1277

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9484; val_auprc_score: 0.9891; val_best_acc_score: 0.9416; val_best_f1_score: 0.9664; train_kl_reg_loss: 8324.7991; train_edge_recon_loss: 80001.7950; train_gene_expr_recon_loss: 1439391.1686; train_masked_gp_l1_reg_loss: 7763.4378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5877.2297; train_global_loss: 1541358.4307; train_optim_loss: 1541358.4307; val_kl_reg_loss: 8331.1948; val_edge_recon_loss: 79457.9208; val_gene_expr_recon_loss: 1437724.3938; val_masked_gp_l1_reg_loss: 7716.6802; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5810.8496; val_global_loss: 1539041.0134; val_optim_loss: 1539041.0134
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9487; val_auprc_score: 0.9888; val_best_acc_score: 0.9412; val_best_f1_score: 0.9663; train_kl_reg_loss: 8383.6963; train_edge_recon_loss: 80445.7659; train_gene_expr_recon_loss: 1438962.3121; train_masked_gp_l1_reg_loss: 7676.9379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5752.9103; train_global_loss: 1541221.6211; train_optim_loss: 1541221.6211; val_kl_reg_loss: 8399.8932; val_edge_recon_loss: 79667.8418; val_gene_expr_recon_loss: 1437069.0054; val_masked_gp_l1_reg_loss: 7640.6533; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5696.6055; val_global_loss: 1538473.9946; val_optim_loss: 1538473.9946
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9468; val_auprc_score: 0.9887; val_best_acc_score: 0.9434; val_best_f1_score: 0.9676; train_kl_reg_loss: 8466.2155; train_edge_recon_loss: 80263.9788; train_gene_expr_recon_loss: 1438565.2092; train_masked_gp_l1_reg_loss: 7596.1873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5638.5006; train_global_loss: 1540530.0936; train_optim_loss: 1540530.0936; val_kl_reg_loss: 8456.1888; val_edge_recon_loss: 77159.8359; val_gene_expr_recon_loss: 1436994.4973; val_masked_gp_l1_reg_loss: 7549.9170; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5577.6143; val_global_loss: 1535738.0309; val_optim_loss: 1535738.0309
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9481; val_auprc_score: 0.9879; val_best_acc_score: 0.9418; val_best_f1_score: 0.9663; train_kl_reg_loss: 8475.5745; train_edge_recon_loss: 80759.5394; train_gene_expr_recon_loss: 1437858.1375; train_masked_gp_l1_reg_loss: 7505.5212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5528.2357; train_global_loss: 1540127.0093; train_optim_loss: 1540127.0093; val_kl_reg_loss: 8492.8613; val_edge_recon_loss: 81734.5786; val_gene_expr_recon_loss: 1436250.1532; val_masked_gp_l1_reg_loss: 7457.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5474.2539; val_global_loss: 1539409.7151; val_optim_loss: 1539409.7151
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9484; val_auprc_score: 0.9884; val_best_acc_score: 0.9414; val_best_f1_score: 0.9663; train_kl_reg_loss: 8520.8650; train_edge_recon_loss: 80774.2787; train_gene_expr_recon_loss: 1437598.0415; train_masked_gp_l1_reg_loss: 7418.3533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5426.4377; train_global_loss: 1539737.9783; train_optim_loss: 1539737.9783; val_kl_reg_loss: 8517.8951; val_edge_recon_loss: 80669.0304; val_gene_expr_recon_loss: 1436423.2661; val_masked_gp_l1_reg_loss: 7378.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5378.5112; val_global_loss: 1538366.9382; val_optim_loss: 1538366.9382
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9494; val_auprc_score: 0.9885; val_best_acc_score: 0.9439; val_best_f1_score: 0.9677; train_kl_reg_loss: 8555.4112; train_edge_recon_loss: 79950.4280; train_gene_expr_recon_loss: 1437127.6372; train_masked_gp_l1_reg_loss: 7333.7157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5327.4293; train_global_loss: 1538294.6202; train_optim_loss: 1538294.6202; val_kl_reg_loss: 8568.0473; val_edge_recon_loss: 78677.2649; val_gene_expr_recon_loss: 1435280.2782; val_masked_gp_l1_reg_loss: 7293.5479; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5278.7300; val_global_loss: 1535097.8401; val_optim_loss: 1535097.8401
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9498; val_auprc_score: 0.9887; val_best_acc_score: 0.9433; val_best_f1_score: 0.9675; train_kl_reg_loss: 8583.8404; train_edge_recon_loss: 80901.5358; train_gene_expr_recon_loss: 1436528.6835; train_masked_gp_l1_reg_loss: 7255.0991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5231.5029; train_global_loss: 1538500.6634; train_optim_loss: 1538500.6634; val_kl_reg_loss: 8552.3620; val_edge_recon_loss: 79447.7565; val_gene_expr_recon_loss: 1435115.5833; val_masked_gp_l1_reg_loss: 7217.1479; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5179.2729; val_global_loss: 1535512.0806; val_optim_loss: 1535512.0806
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9481; val_auprc_score: 0.9879; val_best_acc_score: 0.9432; val_best_f1_score: 0.9672; train_kl_reg_loss: 8612.9797; train_edge_recon_loss: 79687.2221; train_gene_expr_recon_loss: 1436036.7125; train_masked_gp_l1_reg_loss: 7187.1445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5139.7464; train_global_loss: 1536663.8073; train_optim_loss: 1536663.8073; val_kl_reg_loss: 8621.6175; val_edge_recon_loss: 79996.1639; val_gene_expr_recon_loss: 1435022.4919; val_masked_gp_l1_reg_loss: 7161.6182; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5094.9678; val_global_loss: 1535896.9005; val_optim_loss: 1535896.9005
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9485; val_auprc_score: 0.9886; val_best_acc_score: 0.9435; val_best_f1_score: 0.9677; train_kl_reg_loss: 8667.2662; train_edge_recon_loss: 80505.4629; train_gene_expr_recon_loss: 1435725.0856; train_masked_gp_l1_reg_loss: 7135.5642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5055.6625; train_global_loss: 1537089.0396; train_optim_loss: 1537089.0396; val_kl_reg_loss: 8681.1843; val_edge_recon_loss: 77975.7975; val_gene_expr_recon_loss: 1435147.4207; val_masked_gp_l1_reg_loss: 7110.2598; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5011.0723; val_global_loss: 1533925.7823; val_optim_loss: 1533925.7823
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9496; val_auprc_score: 0.9880; val_best_acc_score: 0.9433; val_best_f1_score: 0.9672; train_kl_reg_loss: 8688.3813; train_edge_recon_loss: 80645.9698; train_gene_expr_recon_loss: 1435539.9637; train_masked_gp_l1_reg_loss: 7098.5901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4976.4069; train_global_loss: 1536949.3120; train_optim_loss: 1536949.3120; val_kl_reg_loss: 8661.0126; val_edge_recon_loss: 81296.0701; val_gene_expr_recon_loss: 1432951.1250; val_masked_gp_l1_reg_loss: 7080.6206; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4940.1870; val_global_loss: 1534928.9624; val_optim_loss: 1534928.9624
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9513; val_auprc_score: 0.9887; val_best_acc_score: 0.9448; val_best_f1_score: 0.9682; train_kl_reg_loss: 8734.4999; train_edge_recon_loss: 80419.6372; train_gene_expr_recon_loss: 1434957.2407; train_masked_gp_l1_reg_loss: 7070.5634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4903.1444; train_global_loss: 1536085.0871; train_optim_loss: 1536085.0871; val_kl_reg_loss: 8698.6787; val_edge_recon_loss: 80556.0144; val_gene_expr_recon_loss: 1433399.5551; val_masked_gp_l1_reg_loss: 7061.1348; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4864.7954; val_global_loss: 1534580.1277; val_optim_loss: 1534580.1277
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9538; val_auprc_score: 0.9901; val_best_acc_score: 0.9440; val_best_f1_score: 0.9677; train_kl_reg_loss: 8742.5606; train_edge_recon_loss: 79791.5352; train_gene_expr_recon_loss: 1434665.8262; train_masked_gp_l1_reg_loss: 7053.0062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4833.2661; train_global_loss: 1535086.1956; train_optim_loss: 1535086.1956; val_kl_reg_loss: 8740.3243; val_edge_recon_loss: 79384.2882; val_gene_expr_recon_loss: 1432921.0565; val_masked_gp_l1_reg_loss: 7045.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4800.8623; val_global_loss: 1532892.4194; val_optim_loss: 1532892.4194
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9541; val_auprc_score: 0.9898; val_best_acc_score: 0.9449; val_best_f1_score: 0.9681; train_kl_reg_loss: 8760.3981; train_edge_recon_loss: 80799.3139; train_gene_expr_recon_loss: 1434287.9189; train_masked_gp_l1_reg_loss: 7040.0101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4771.1312; train_global_loss: 1535658.7705; train_optim_loss: 1535658.7705; val_kl_reg_loss: 8749.7087; val_edge_recon_loss: 80714.6767; val_gene_expr_recon_loss: 1433200.6949; val_masked_gp_l1_reg_loss: 7032.3818; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4736.4863; val_global_loss: 1534433.9637; val_optim_loss: 1534433.9637
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9513; val_auprc_score: 0.9888; val_best_acc_score: 0.9440; val_best_f1_score: 0.9678; train_kl_reg_loss: 8785.7338; train_edge_recon_loss: 80215.9158; train_gene_expr_recon_loss: 1434181.9852; train_masked_gp_l1_reg_loss: 7030.9338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4710.9194; train_global_loss: 1534925.4903; train_optim_loss: 1534925.4903; val_kl_reg_loss: 8812.3914; val_edge_recon_loss: 80759.3599; val_gene_expr_recon_loss: 1433235.5040; val_masked_gp_l1_reg_loss: 7019.9370; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4678.9106; val_global_loss: 1534506.0027; val_optim_loss: 1534506.0027
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9505; val_auprc_score: 0.9883; val_best_acc_score: 0.9442; val_best_f1_score: 0.9679; train_kl_reg_loss: 8840.2150; train_edge_recon_loss: 80050.4079; train_gene_expr_recon_loss: 1434163.8608; train_masked_gp_l1_reg_loss: 7017.9306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4655.9165; train_global_loss: 1534728.3324; train_optim_loss: 1534728.3324; val_kl_reg_loss: 8845.4206; val_edge_recon_loss: 81281.0924; val_gene_expr_recon_loss: 1432523.3320; val_masked_gp_l1_reg_loss: 7018.6240; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4635.9453; val_global_loss: 1534304.4651; val_optim_loss: 1534304.4651
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9521; val_auprc_score: 0.9888; val_best_acc_score: 0.9434; val_best_f1_score: 0.9674; train_kl_reg_loss: 8831.5355; train_edge_recon_loss: 79349.5624; train_gene_expr_recon_loss: 1433556.6228; train_masked_gp_l1_reg_loss: 7030.5175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4609.7226; train_global_loss: 1533377.9594; train_optim_loss: 1533377.9594; val_kl_reg_loss: 8848.4019; val_edge_recon_loss: 81354.0132; val_gene_expr_recon_loss: 1433536.8347; val_masked_gp_l1_reg_loss: 7022.6655; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4584.1758; val_global_loss: 1535346.0027; val_optim_loss: 1535346.0027

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9522; val_auprc_score: 0.9892; val_best_acc_score: 0.9454; val_best_f1_score: 0.9685; train_kl_reg_loss: 8851.6706; train_edge_recon_loss: 80472.6729; train_gene_expr_recon_loss: 1433455.5844; train_masked_gp_l1_reg_loss: 6974.3390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4566.7783; train_global_loss: 1534321.0439; train_optim_loss: 1534321.0439; val_kl_reg_loss: 8825.4484; val_edge_recon_loss: 80808.0088; val_gene_expr_recon_loss: 1432518.2702; val_masked_gp_l1_reg_loss: 6967.8911; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4561.5908; val_global_loss: 1533681.2218; val_optim_loss: 1533681.2218
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9527; val_auprc_score: 0.9894; val_best_acc_score: 0.9440; val_best_f1_score: 0.9677; train_kl_reg_loss: 8844.6220; train_edge_recon_loss: 80593.0475; train_gene_expr_recon_loss: 1433418.7709; train_masked_gp_l1_reg_loss: 6965.4471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4558.2363; train_global_loss: 1534380.1205; train_optim_loss: 1534380.1205; val_kl_reg_loss: 8824.3927; val_edge_recon_loss: 81571.7377; val_gene_expr_recon_loss: 1432137.0470; val_masked_gp_l1_reg_loss: 6963.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4554.9834; val_global_loss: 1534051.3038; val_optim_loss: 1534051.3038
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9517; val_auprc_score: 0.9892; val_best_acc_score: 0.9446; val_best_f1_score: 0.9680; train_kl_reg_loss: 8836.8491; train_edge_recon_loss: 79783.7246; train_gene_expr_recon_loss: 1433213.0624; train_masked_gp_l1_reg_loss: 6961.7049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4551.7725; train_global_loss: 1533347.1168; train_optim_loss: 1533347.1168; val_kl_reg_loss: 8812.4139; val_edge_recon_loss: 80713.9678; val_gene_expr_recon_loss: 1431898.5242; val_masked_gp_l1_reg_loss: 6960.2041; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4547.8140; val_global_loss: 1532933.0390; val_optim_loss: 1532933.0390
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9506; val_auprc_score: 0.9891; val_best_acc_score: 0.9437; val_best_f1_score: 0.9677; train_kl_reg_loss: 8838.9114; train_edge_recon_loss: 79884.5011; train_gene_expr_recon_loss: 1433287.4280; train_masked_gp_l1_reg_loss: 6958.1751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4544.3287; train_global_loss: 1533513.3418; train_optim_loss: 1533513.3418; val_kl_reg_loss: 8862.8642; val_edge_recon_loss: 79890.9357; val_gene_expr_recon_loss: 1432115.9220; val_masked_gp_l1_reg_loss: 6955.7427; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4541.1729; val_global_loss: 1532366.5995; val_optim_loss: 1532366.5995
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9550; val_auprc_score: 0.9900; val_best_acc_score: 0.9474; val_best_f1_score: 0.9697; train_kl_reg_loss: 8858.9005; train_edge_recon_loss: 79644.0867; train_gene_expr_recon_loss: 1433211.0146; train_masked_gp_l1_reg_loss: 6954.5745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4538.2797; train_global_loss: 1533206.8547; train_optim_loss: 1533206.8547; val_kl_reg_loss: 8832.2080; val_edge_recon_loss: 79099.5043; val_gene_expr_recon_loss: 1431829.6478; val_masked_gp_l1_reg_loss: 6953.1924; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4535.4385; val_global_loss: 1531250.1075; val_optim_loss: 1531250.1075
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9529; val_auprc_score: 0.9894; val_best_acc_score: 0.9462; val_best_f1_score: 0.9690; train_kl_reg_loss: 8842.4309; train_edge_recon_loss: 80227.4046; train_gene_expr_recon_loss: 1433105.3281; train_masked_gp_l1_reg_loss: 6951.5651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4531.8929; train_global_loss: 1533658.6217; train_optim_loss: 1533658.6217; val_kl_reg_loss: 8831.5851; val_edge_recon_loss: 79711.8586; val_gene_expr_recon_loss: 1431773.9113; val_masked_gp_l1_reg_loss: 6949.6431; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4528.1733; val_global_loss: 1531795.0981; val_optim_loss: 1531795.0981
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9500; val_auprc_score: 0.9880; val_best_acc_score: 0.9444; val_best_f1_score: 0.9678; train_kl_reg_loss: 8851.0701; train_edge_recon_loss: 79723.6995; train_gene_expr_recon_loss: 1432940.5566; train_masked_gp_l1_reg_loss: 6948.2074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4525.0969; train_global_loss: 1532988.6322; train_optim_loss: 1532988.6322; val_kl_reg_loss: 8825.1308; val_edge_recon_loss: 81414.6905; val_gene_expr_recon_loss: 1431860.6089; val_masked_gp_l1_reg_loss: 6946.3018; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4520.8892; val_global_loss: 1533567.5470; val_optim_loss: 1533567.5470
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9534; val_auprc_score: 0.9895; val_best_acc_score: 0.9465; val_best_f1_score: 0.9691; train_kl_reg_loss: 8859.4619; train_edge_recon_loss: 80380.0675; train_gene_expr_recon_loss: 1433202.4807; train_masked_gp_l1_reg_loss: 6946.0586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4517.9861; train_global_loss: 1533906.0523; train_optim_loss: 1533906.0523; val_kl_reg_loss: 8861.7825; val_edge_recon_loss: 79547.0921; val_gene_expr_recon_loss: 1432417.2755; val_masked_gp_l1_reg_loss: 6945.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4514.5708; val_global_loss: 1532286.2728; val_optim_loss: 1532286.2728
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9504; val_auprc_score: 0.9887; val_best_acc_score: 0.9437; val_best_f1_score: 0.9676; train_kl_reg_loss: 8857.2631; train_edge_recon_loss: 79874.9667; train_gene_expr_recon_loss: 1433216.4019; train_masked_gp_l1_reg_loss: 6944.7132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4511.5957; train_global_loss: 1533404.9376; train_optim_loss: 1533404.9376; val_kl_reg_loss: 8834.4393; val_edge_recon_loss: 79008.6813; val_gene_expr_recon_loss: 1432085.5941; val_masked_gp_l1_reg_loss: 6944.1646; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4508.4180; val_global_loss: 1531381.2204; val_optim_loss: 1531381.2204

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9507; val_auprc_score: 0.9889; val_best_acc_score: 0.9442; val_best_f1_score: 0.9679; train_kl_reg_loss: 8864.4199; train_edge_recon_loss: 80658.1158; train_gene_expr_recon_loss: 1433032.3623; train_masked_gp_l1_reg_loss: 6938.2234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4506.6411; train_global_loss: 1533999.7696; train_optim_loss: 1533999.7696; val_kl_reg_loss: 8836.3700; val_edge_recon_loss: 79946.6946; val_gene_expr_recon_loss: 1431958.8925; val_masked_gp_l1_reg_loss: 6937.0063; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4505.9517; val_global_loss: 1532184.9503; val_optim_loss: 1532184.9503
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9516; val_auprc_score: 0.9888; val_best_acc_score: 0.9436; val_best_f1_score: 0.9674; train_kl_reg_loss: 8871.5400; train_edge_recon_loss: 80053.0841; train_gene_expr_recon_loss: 1433066.1429; train_masked_gp_l1_reg_loss: 6936.6493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4505.5880; train_global_loss: 1533433.0036; train_optim_loss: 1533433.0036; val_kl_reg_loss: 8854.7534; val_edge_recon_loss: 81942.9300; val_gene_expr_recon_loss: 1431600.9731; val_masked_gp_l1_reg_loss: 6936.4248; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4505.1509; val_global_loss: 1533840.1546; val_optim_loss: 1533840.1546
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9524; val_auprc_score: 0.9896; val_best_acc_score: 0.9446; val_best_f1_score: 0.9682; train_kl_reg_loss: 8856.2418; train_edge_recon_loss: 79790.2465; train_gene_expr_recon_loss: 1432983.8157; train_masked_gp_l1_reg_loss: 6936.2499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4504.7965; train_global_loss: 1533071.3396; train_optim_loss: 1533071.3396; val_kl_reg_loss: 8861.0407; val_edge_recon_loss: 79142.6717; val_gene_expr_recon_loss: 1432290.7863; val_masked_gp_l1_reg_loss: 6936.1470; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4504.4868; val_global_loss: 1531735.1344; val_optim_loss: 1531735.1344
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9541; val_auprc_score: 0.9892; val_best_acc_score: 0.9451; val_best_f1_score: 0.9684; train_kl_reg_loss: 8861.0846; train_edge_recon_loss: 80091.2050; train_gene_expr_recon_loss: 1433169.3442; train_masked_gp_l1_reg_loss: 6936.0470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4504.1332; train_global_loss: 1533561.8283; train_optim_loss: 1533561.8283; val_kl_reg_loss: 8837.3287; val_edge_recon_loss: 80165.2597; val_gene_expr_recon_loss: 1431932.1075; val_masked_gp_l1_reg_loss: 6935.9561; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4503.7544; val_global_loss: 1532374.4462; val_optim_loss: 1532374.4462

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 338 min 12 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9548
val AUPRC score: 0.9901
val best accuracy score: 0.9450
val best F1 score: 0.9682
val target rna MSE score: 1.0710
val source rna MSE score: 0.4967
Val cat covariate0 mean sim diff: -0.0049

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
