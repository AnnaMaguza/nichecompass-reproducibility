Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9330; val_auprc_score: 0.9853; val_best_acc_score: 0.9334; val_best_f1_score: 0.9619; train_kl_reg_loss: 128540.3157; train_edge_recon_loss: 8119030.0978; train_gene_expr_recon_loss: 76436816.5256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84684386.9744; train_optim_loss: 84684386.9744; val_kl_reg_loss: 120097.3213; val_edge_recon_loss: 8009892.2143; val_gene_expr_recon_loss: 75975073.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84105063.6571; val_optim_loss: 84105063.6571
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9420; val_auprc_score: 0.9871; val_best_acc_score: 0.9358; val_best_f1_score: 0.9630; train_kl_reg_loss: 117276.7147; train_edge_recon_loss: 8118021.0401; train_gene_expr_recon_loss: 75672279.9487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83907577.7051; train_optim_loss: 83907577.7051; val_kl_reg_loss: 109892.9272; val_edge_recon_loss: 8151211.3714; val_gene_expr_recon_loss: 75024664.4571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83285768.1143; val_optim_loss: 83285768.1143
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9527; val_auprc_score: 0.9899; val_best_acc_score: 0.9423; val_best_f1_score: 0.9668; train_kl_reg_loss: 106647.7914; train_edge_recon_loss: 7965141.7732; train_gene_expr_recon_loss: 75023176.0897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83094965.5000; train_optim_loss: 83094965.5000; val_kl_reg_loss: 98061.9396; val_edge_recon_loss: 7821599.5214; val_gene_expr_recon_loss: 74685969.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82605631.0857; val_optim_loss: 82605631.0857
[True]
Run timestamp: 21072023_030447_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '12', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '30.0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9134; val_auprc_score: 0.9828; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 72821.6689; train_edge_recon_loss: 116036.0893; train_gene_expr_recon_loss: 2654755.7740; train_masked_gp_l1_reg_loss: 31748.5273; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2875362.0721; train_optim_loss: 2875362.0721; val_kl_reg_loss: 102155.2109; val_edge_recon_loss: 119249.3681; val_gene_expr_recon_loss: 1242588.0556; val_masked_gp_l1_reg_loss: 25516.9941; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1489509.6389; val_optim_loss: 1489509.6389
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9531; val_auprc_score: 0.9897; val_best_acc_score: 0.9437; val_best_f1_score: 0.9675; train_kl_reg_loss: 97253.8701; train_edge_recon_loss: 7967061.8846; train_gene_expr_recon_loss: 74461898.2436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82526213.9615; train_optim_loss: 82526213.9615; val_kl_reg_loss: 90974.2461; val_edge_recon_loss: 7987927.0643; val_gene_expr_recon_loss: 74102867.6571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82181769.0286; val_optim_loss: 82181769.0286
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8777; val_auprc_score: 0.9746; val_best_acc_score: 0.8580; val_best_f1_score: 0.9230; train_kl_reg_loss: 95752.4791; train_edge_recon_loss: 119146.4121; train_gene_expr_recon_loss: 1152575.4503; train_masked_gp_l1_reg_loss: 22042.4038; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1389516.7516; train_optim_loss: 1389516.7516; val_kl_reg_loss: 85263.1944; val_edge_recon_loss: 120729.7613; val_gene_expr_recon_loss: 1098939.7500; val_masked_gp_l1_reg_loss: 19893.0312; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1324825.6944; val_optim_loss: 1324825.6944
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9610; val_auprc_score: 0.9911; val_best_acc_score: 0.9499; val_best_f1_score: 0.9710; train_kl_reg_loss: 90810.9488; train_edge_recon_loss: 7950466.2516; train_gene_expr_recon_loss: 74053437.3590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82094714.5641; train_optim_loss: 82094714.5641; val_kl_reg_loss: 85870.5286; val_edge_recon_loss: 7930646.8071; val_gene_expr_recon_loss: 73767932.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81784450.2857; val_optim_loss: 81784450.2857
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8704; val_auprc_score: 0.9722; val_best_acc_score: 0.8804; val_best_f1_score: 0.9336; train_kl_reg_loss: 79306.2653; train_edge_recon_loss: 118653.2154; train_gene_expr_recon_loss: 1073569.4407; train_masked_gp_l1_reg_loss: 19260.5464; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1290789.4712; train_optim_loss: 1290789.4712; val_kl_reg_loss: 71591.8247; val_edge_recon_loss: 119983.3967; val_gene_expr_recon_loss: 1050244.3264; val_masked_gp_l1_reg_loss: 18968.0977; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1260787.6806; val_optim_loss: 1260787.6806
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8710; val_auprc_score: 0.9716; val_best_acc_score: 0.8789; val_best_f1_score: 0.9330; train_kl_reg_loss: 67875.8120; train_edge_recon_loss: 117755.6774; train_gene_expr_recon_loss: 1033742.3886; train_masked_gp_l1_reg_loss: 19115.6963; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1238489.5689; train_optim_loss: 1238489.5689; val_kl_reg_loss: 62457.3624; val_edge_recon_loss: 120004.9661; val_gene_expr_recon_loss: 1016698.1181; val_masked_gp_l1_reg_loss: 19382.5488; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1218542.9306; val_optim_loss: 1218542.9306
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9628; val_auprc_score: 0.9918; val_best_acc_score: 0.9508; val_best_f1_score: 0.9715; train_kl_reg_loss: 84598.3642; train_edge_recon_loss: 7864946.2748; train_gene_expr_recon_loss: 73721817.3846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 81671362.0897; train_optim_loss: 81671362.0897; val_kl_reg_loss: 83359.3122; val_edge_recon_loss: 7866494.9214; val_gene_expr_recon_loss: 73421766.5143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81371620.8000; val_optim_loss: 81371620.8000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8740; val_auprc_score: 0.9716; val_best_acc_score: 0.8891; val_best_f1_score: 0.9384; train_kl_reg_loss: 60247.2105; train_edge_recon_loss: 117317.1702; train_gene_expr_recon_loss: 1004608.1819; train_masked_gp_l1_reg_loss: 19724.8152; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1201897.3766; train_optim_loss: 1201897.3766; val_kl_reg_loss: 56435.0625; val_edge_recon_loss: 118334.3568; val_gene_expr_recon_loss: 991426.3472; val_masked_gp_l1_reg_loss: 20081.8145; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1186277.6389; val_optim_loss: 1186277.6389
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8845; val_auprc_score: 0.9735; val_best_acc_score: 0.8961; val_best_f1_score: 0.9418; train_kl_reg_loss: 54433.7904; train_edge_recon_loss: 116251.7273; train_gene_expr_recon_loss: 983883.1474; train_masked_gp_l1_reg_loss: 20428.6695; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1174997.3269; train_optim_loss: 1174997.3269; val_kl_reg_loss: 51300.5929; val_edge_recon_loss: 116952.0677; val_gene_expr_recon_loss: 973166.9444; val_masked_gp_l1_reg_loss: 20790.4824; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1162210.0972; val_optim_loss: 1162210.0972
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9641; val_auprc_score: 0.9913; val_best_acc_score: 0.9540; val_best_f1_score: 0.9732; train_kl_reg_loss: 80550.5790; train_edge_recon_loss: 7849325.5449; train_gene_expr_recon_loss: 73424051.9103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 81353928.1154; train_optim_loss: 81353928.1154; val_kl_reg_loss: 74327.9926; val_edge_recon_loss: 8054360.1357; val_gene_expr_recon_loss: 73253109.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81381796.9143; val_optim_loss: 81381796.9143
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8962; val_auprc_score: 0.9763; val_best_acc_score: 0.9047; val_best_f1_score: 0.9464; train_kl_reg_loss: 49749.6039; train_edge_recon_loss: 115798.9123; train_gene_expr_recon_loss: 968631.3702; train_masked_gp_l1_reg_loss: 21141.3943; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1155321.2885; train_optim_loss: 1155321.2885; val_kl_reg_loss: 47207.1853; val_edge_recon_loss: 116117.2873; val_gene_expr_recon_loss: 960437.9722; val_masked_gp_l1_reg_loss: 21543.3477; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1145305.8056; val_optim_loss: 1145305.8056
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8985; val_auprc_score: 0.9769; val_best_acc_score: 0.9091; val_best_f1_score: 0.9482; train_kl_reg_loss: 46472.3951; train_edge_recon_loss: 115381.0780; train_gene_expr_recon_loss: 954963.5104; train_masked_gp_l1_reg_loss: 21830.7023; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1138647.6859; train_optim_loss: 1138647.6859; val_kl_reg_loss: 44107.8008; val_edge_recon_loss: 115267.4340; val_gene_expr_recon_loss: 947680.7569; val_masked_gp_l1_reg_loss: 22143.3398; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1129199.3889; val_optim_loss: 1129199.3889
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9656; val_auprc_score: 0.9921; val_best_acc_score: 0.9563; val_best_f1_score: 0.9747; train_kl_reg_loss: 77137.9252; train_edge_recon_loss: 7842768.1066; train_gene_expr_recon_loss: 73258739.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 81178645.7436; train_optim_loss: 81178645.7436; val_kl_reg_loss: 74603.9223; val_edge_recon_loss: 7804515.2143; val_gene_expr_recon_loss: 73033948.2286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 80913067.3143; val_optim_loss: 80913067.3143
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9096; val_auprc_score: 0.9792; val_best_acc_score: 0.9128; val_best_f1_score: 0.9498; train_kl_reg_loss: 43479.3816; train_edge_recon_loss: 114081.7050; train_gene_expr_recon_loss: 943567.9992; train_masked_gp_l1_reg_loss: 22420.3885; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1123549.4631; train_optim_loss: 1123549.4631; val_kl_reg_loss: 41665.1736; val_edge_recon_loss: 116018.7135; val_gene_expr_recon_loss: 937518.9931; val_masked_gp_l1_reg_loss: 22715.7930; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1117918.6111; val_optim_loss: 1117918.6111
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9120; val_auprc_score: 0.9801; val_best_acc_score: 0.9145; val_best_f1_score: 0.9515; train_kl_reg_loss: 41236.1151; train_edge_recon_loss: 114268.5916; train_gene_expr_recon_loss: 933577.9207; train_masked_gp_l1_reg_loss: 22974.7170; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1112057.3333; train_optim_loss: 1112057.3333; val_kl_reg_loss: 39530.8589; val_edge_recon_loss: 115608.1658; val_gene_expr_recon_loss: 927818.2014; val_masked_gp_l1_reg_loss: 23244.4707; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1106201.7222; val_optim_loss: 1106201.7222
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8785; val_auprc_score: 0.9738; val_best_acc_score: 0.8853; val_best_f1_score: 0.9354; train_kl_reg_loss: 111339.1531; train_edge_recon_loss: 8463560.6867; train_gene_expr_recon_loss: 80538913.4359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89113813.3205; train_optim_loss: 89113813.3205; val_kl_reg_loss: 22344.5920; val_edge_recon_loss: 10668719.7429; val_gene_expr_recon_loss: 83771946.7429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94463010.9714; val_optim_loss: 94463010.9714
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9158; val_auprc_score: 0.9810; val_best_acc_score: 0.9184; val_best_f1_score: 0.9535; train_kl_reg_loss: 39255.8677; train_edge_recon_loss: 113527.0849; train_gene_expr_recon_loss: 924447.3357; train_masked_gp_l1_reg_loss: 23487.6098; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1100717.9006; train_optim_loss: 1100717.9006; val_kl_reg_loss: 37654.0456; val_edge_recon_loss: 114221.6276; val_gene_expr_recon_loss: 919704.1111; val_masked_gp_l1_reg_loss: 23762.1895; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1095342.0417; val_optim_loss: 1095342.0417
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9222; val_auprc_score: 0.9823; val_best_acc_score: 0.9229; val_best_f1_score: 0.9556; train_kl_reg_loss: 37647.0386; train_edge_recon_loss: 112315.2869; train_gene_expr_recon_loss: 916010.2636; train_masked_gp_l1_reg_loss: 23987.1324; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1089959.7212; train_optim_loss: 1089959.7212; val_kl_reg_loss: 36482.7821; val_edge_recon_loss: 114182.7717; val_gene_expr_recon_loss: 911132.6875; val_masked_gp_l1_reg_loss: 24241.7402; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1086039.9861; val_optim_loss: 1086039.9861
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.7925; val_auprc_score: 0.9395; val_best_acc_score: 0.8824; val_best_f1_score: 0.9345; train_kl_reg_loss: 7189.9726; train_edge_recon_loss: 9784121.2059; train_gene_expr_recon_loss: 84961626.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94752937.2821; train_optim_loss: 94752937.2821; val_kl_reg_loss: 11538.4583; val_edge_recon_loss: 9558313.2571; val_gene_expr_recon_loss: 81520502.9714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91090354.6286; val_optim_loss: 91090354.6286
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9246; val_auprc_score: 0.9825; val_best_acc_score: 0.9257; val_best_f1_score: 0.9576; train_kl_reg_loss: 36330.1287; train_edge_recon_loss: 111597.1644; train_gene_expr_recon_loss: 908339.0176; train_masked_gp_l1_reg_loss: 24454.2561; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1080720.5657; train_optim_loss: 1080720.5657; val_kl_reg_loss: 35452.2856; val_edge_recon_loss: 114325.6753; val_gene_expr_recon_loss: 903367.8333; val_masked_gp_l1_reg_loss: 24681.1152; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1077826.9167; val_optim_loss: 1077826.9167
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9268; val_auprc_score: 0.9832; val_best_acc_score: 0.9299; val_best_f1_score: 0.9598; train_kl_reg_loss: 35292.3086; train_edge_recon_loss: 110699.8954; train_gene_expr_recon_loss: 901293.9463; train_masked_gp_l1_reg_loss: 24885.4232; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1072171.5721; train_optim_loss: 1072171.5721; val_kl_reg_loss: 34271.0773; val_edge_recon_loss: 110886.9696; val_gene_expr_recon_loss: 896391.8611; val_masked_gp_l1_reg_loss: 25103.9668; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1066653.9028; val_optim_loss: 1066653.9028
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.7883; val_auprc_score: 0.9393; val_best_acc_score: 0.8880; val_best_f1_score: 0.9376; train_kl_reg_loss: 14471.5052; train_edge_recon_loss: 9348979.0649; train_gene_expr_recon_loss: 81248877.9872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90612328.4103; train_optim_loss: 90612328.4103; val_kl_reg_loss: 16670.7368; val_edge_recon_loss: 9173945.3071; val_gene_expr_recon_loss: 80660417.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89851033.3714; val_optim_loss: 89851033.3714
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9315; val_auprc_score: 0.9847; val_best_acc_score: 0.9308; val_best_f1_score: 0.9603; train_kl_reg_loss: 34460.7893; train_edge_recon_loss: 109918.2303; train_gene_expr_recon_loss: 894638.9535; train_masked_gp_l1_reg_loss: 25310.0726; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1064328.0417; train_optim_loss: 1064328.0417; val_kl_reg_loss: 33319.4136; val_edge_recon_loss: 111975.6233; val_gene_expr_recon_loss: 889812.6111; val_masked_gp_l1_reg_loss: 25514.5410; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1060622.1667; val_optim_loss: 1060622.1667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9356; val_auprc_score: 0.9855; val_best_acc_score: 0.9355; val_best_f1_score: 0.9628; train_kl_reg_loss: 33753.2040; train_edge_recon_loss: 109435.8346; train_gene_expr_recon_loss: 888233.5192; train_masked_gp_l1_reg_loss: 25712.8647; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1057135.4247; train_optim_loss: 1057135.4247; val_kl_reg_loss: 33182.6128; val_edge_recon_loss: 109958.7969; val_gene_expr_recon_loss: 884584.3125; val_masked_gp_l1_reg_loss: 25911.3652; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1053637.0972; val_optim_loss: 1053637.0972
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.7827; val_auprc_score: 0.9383; val_best_acc_score: 0.8916; val_best_f1_score: 0.9396; train_kl_reg_loss: 16701.5719; train_edge_recon_loss: 9051694.0849; train_gene_expr_recon_loss: 80623418.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89691813.8333; train_optim_loss: 89691813.8333; val_kl_reg_loss: 15995.0530; val_edge_recon_loss: 8857395.6286; val_gene_expr_recon_loss: 80152472.5714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89025863.0857; val_optim_loss: 89025863.0857
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9388; val_auprc_score: 0.9863; val_best_acc_score: 0.9368; val_best_f1_score: 0.9637; train_kl_reg_loss: 33025.7552; train_edge_recon_loss: 107757.5482; train_gene_expr_recon_loss: 882158.8894; train_masked_gp_l1_reg_loss: 26099.9824; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1049042.1723; train_optim_loss: 1049042.1723; val_kl_reg_loss: 32133.5935; val_edge_recon_loss: 108865.6241; val_gene_expr_recon_loss: 878237.4583; val_masked_gp_l1_reg_loss: 26284.4219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1045521.0972; val_optim_loss: 1045521.0972
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9405; val_auprc_score: 0.9863; val_best_acc_score: 0.9382; val_best_f1_score: 0.9644; train_kl_reg_loss: 32373.2265; train_edge_recon_loss: 107324.7951; train_gene_expr_recon_loss: 876562.6522; train_masked_gp_l1_reg_loss: 26464.7802; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1042725.4551; train_optim_loss: 1042725.4551; val_kl_reg_loss: 31378.9766; val_edge_recon_loss: 107715.9036; val_gene_expr_recon_loss: 873468.5417; val_masked_gp_l1_reg_loss: 26652.0039; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1039215.4236; val_optim_loss: 1039215.4236

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8025; val_auprc_score: 0.9436; val_best_acc_score: 0.8896; val_best_f1_score: 0.9383; train_kl_reg_loss: 17661.0474; train_edge_recon_loss: 9149484.9135; train_gene_expr_recon_loss: 80342825.4359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89509971.3590; train_optim_loss: 89509971.3590; val_kl_reg_loss: 10471.5339; val_edge_recon_loss: 9216610.9143; val_gene_expr_recon_loss: 80023592.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89250674.9714; val_optim_loss: 89250674.9714
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9384; val_auprc_score: 0.9864; val_best_acc_score: 0.9391; val_best_f1_score: 0.9650; train_kl_reg_loss: 31716.3036; train_edge_recon_loss: 106754.1068; train_gene_expr_recon_loss: 871223.3013; train_masked_gp_l1_reg_loss: 26812.4767; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1036506.1915; train_optim_loss: 1036506.1915; val_kl_reg_loss: 30713.6573; val_edge_recon_loss: 107066.4531; val_gene_expr_recon_loss: 867703.9583; val_masked_gp_l1_reg_loss: 26978.3340; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1032462.3819; val_optim_loss: 1032462.3819
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9457; val_auprc_score: 0.9880; val_best_acc_score: 0.9408; val_best_f1_score: 0.9659; train_kl_reg_loss: 31147.0847; train_edge_recon_loss: 106226.0266; train_gene_expr_recon_loss: 866281.3478; train_masked_gp_l1_reg_loss: 27149.6858; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1030804.1458; train_optim_loss: 1030804.1458; val_kl_reg_loss: 30493.8192; val_edge_recon_loss: 107187.7005; val_gene_expr_recon_loss: 862472.4792; val_masked_gp_l1_reg_loss: 27324.6797; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1027478.6944; val_optim_loss: 1027478.6944
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9475; val_auprc_score: 0.9884; val_best_acc_score: 0.9421; val_best_f1_score: 0.9667; train_kl_reg_loss: 30603.7958; train_edge_recon_loss: 105094.2061; train_gene_expr_recon_loss: 861530.9535; train_masked_gp_l1_reg_loss: 27460.1185; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1024689.0737; train_optim_loss: 1024689.0737; val_kl_reg_loss: 29688.2151; val_edge_recon_loss: 106970.0825; val_gene_expr_recon_loss: 858855.2778; val_masked_gp_l1_reg_loss: 27612.0918; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1023125.6319; val_optim_loss: 1023125.6319
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8054; val_auprc_score: 0.9451; val_best_acc_score: 0.8929; val_best_f1_score: 0.9403; train_kl_reg_loss: 18429.6482; train_edge_recon_loss: 9182527.5817; train_gene_expr_recon_loss: 80244845.3205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89445802.5128; train_optim_loss: 89445802.5128; val_kl_reg_loss: 10470.8549; val_edge_recon_loss: 9012347.5929; val_gene_expr_recon_loss: 80151353.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89174171.4286; val_optim_loss: 89174171.4286
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9475; val_auprc_score: 0.9883; val_best_acc_score: 0.9446; val_best_f1_score: 0.9682; train_kl_reg_loss: 30047.8282; train_edge_recon_loss: 104507.9212; train_gene_expr_recon_loss: 856810.5208; train_masked_gp_l1_reg_loss: 27752.2642; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1019118.5312; train_optim_loss: 1019118.5312; val_kl_reg_loss: 29559.3513; val_edge_recon_loss: 104664.7344; val_gene_expr_recon_loss: 853657.7847; val_masked_gp_l1_reg_loss: 27890.8984; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1015772.7500; val_optim_loss: 1015772.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9467; val_auprc_score: 0.9884; val_best_acc_score: 0.9445; val_best_f1_score: 0.9680; train_kl_reg_loss: 29593.5961; train_edge_recon_loss: 104612.5365; train_gene_expr_recon_loss: 852700.2796; train_masked_gp_l1_reg_loss: 28016.2863; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1014922.6995; train_optim_loss: 1014922.6995; val_kl_reg_loss: 29454.9703; val_edge_recon_loss: 104647.5764; val_gene_expr_recon_loss: 850439.8472; val_masked_gp_l1_reg_loss: 28149.2793; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1012691.6458; val_optim_loss: 1012691.6458
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9519; val_auprc_score: 0.9893; val_best_acc_score: 0.9466; val_best_f1_score: 0.9693; train_kl_reg_loss: 29138.9635; train_edge_recon_loss: 103297.0693; train_gene_expr_recon_loss: 848339.6002; train_masked_gp_l1_reg_loss: 28268.2524; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1009043.8862; train_optim_loss: 1009043.8862; val_kl_reg_loss: 28224.1235; val_edge_recon_loss: 104101.4071; val_gene_expr_recon_loss: 846140.5972; val_masked_gp_l1_reg_loss: 28386.9688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1006853.0972; val_optim_loss: 1006853.0972
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8028; val_auprc_score: 0.9426; val_best_acc_score: 0.8910; val_best_f1_score: 0.9391; train_kl_reg_loss: 18529.8704; train_edge_recon_loss: 9115687.6346; train_gene_expr_recon_loss: 80141479.7179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89275697.1667; train_optim_loss: 89275697.1667; val_kl_reg_loss: 10185.4187; val_edge_recon_loss: 9164511.6286; val_gene_expr_recon_loss: 80055534.5143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89230231.4286; val_optim_loss: 89230231.4286
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8873; val_auprc_score: 0.9787; val_best_acc_score: 0.8595; val_best_f1_score: 0.9238; train_kl_reg_loss: 41263.8998; train_edge_recon_loss: 110215.6759; train_gene_expr_recon_loss: 1791976.5304; train_masked_gp_l1_reg_loss: 33396.8178; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1976852.9247; train_optim_loss: 1976852.9247; val_kl_reg_loss: 16980.0304; val_edge_recon_loss: 119226.7144; val_gene_expr_recon_loss: 1785161.9167; val_masked_gp_l1_reg_loss: 45495.8594; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1966864.5556; val_optim_loss: 1966864.5556
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8698; val_auprc_score: 0.9746; val_best_acc_score: 0.8637; val_best_f1_score: 0.9259; train_kl_reg_loss: 16923.4848; train_edge_recon_loss: 109304.5358; train_gene_expr_recon_loss: 1288892.8221; train_masked_gp_l1_reg_loss: 53670.2842; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1468791.1282; train_optim_loss: 1468791.1282; val_kl_reg_loss: 18240.0213; val_edge_recon_loss: 117460.6884; val_gene_expr_recon_loss: 1057204.9028; val_masked_gp_l1_reg_loss: 51405.8438; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1244311.5000; val_optim_loss: 1244311.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.7944; val_auprc_score: 0.9387; val_best_acc_score: 0.8901; val_best_f1_score: 0.9384; train_kl_reg_loss: 18738.3235; train_edge_recon_loss: 9035381.9247; train_gene_expr_recon_loss: 80092329.7308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89146449.9103; train_optim_loss: 89146449.9103; val_kl_reg_loss: 9941.5321; val_edge_recon_loss: 9261382.3857; val_gene_expr_recon_loss: 80023955.6571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89295279.4286; val_optim_loss: 89295279.4286
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8715; val_auprc_score: 0.9737; val_best_acc_score: 0.8633; val_best_f1_score: 0.9253; train_kl_reg_loss: 19358.4176; train_edge_recon_loss: 110390.5777; train_gene_expr_recon_loss: 979058.3005; train_masked_gp_l1_reg_loss: 48522.3063; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1157329.5994; train_optim_loss: 1157329.5994; val_kl_reg_loss: 19200.7932; val_edge_recon_loss: 119359.9106; val_gene_expr_recon_loss: 915934.2153; val_masked_gp_l1_reg_loss: 46086.4883; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1100581.4167; val_optim_loss: 1100581.4167
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8739; val_auprc_score: 0.9741; val_best_acc_score: 0.8712; val_best_f1_score: 0.9262; train_kl_reg_loss: 19512.0746; train_edge_recon_loss: 111532.6999; train_gene_expr_recon_loss: 905948.5569; train_masked_gp_l1_reg_loss: 44367.7919; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1081361.1218; train_optim_loss: 1081361.1218; val_kl_reg_loss: 18781.6586; val_edge_recon_loss: 119335.4444; val_gene_expr_recon_loss: 897280.2361; val_masked_gp_l1_reg_loss: 42887.0273; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1078284.3750; val_optim_loss: 1078284.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8756; val_auprc_score: 0.9748; val_best_acc_score: 0.8741; val_best_f1_score: 0.9278; train_kl_reg_loss: 19037.1815; train_edge_recon_loss: 111112.7078; train_gene_expr_recon_loss: 898343.8213; train_masked_gp_l1_reg_loss: 42603.4146; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1071097.1218; train_optim_loss: 1071097.1218; val_kl_reg_loss: 18567.6549; val_edge_recon_loss: 118075.4123; val_gene_expr_recon_loss: 896059.6806; val_masked_gp_l1_reg_loss: 42451.0664; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1075153.8333; val_optim_loss: 1075153.8333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 95 min 46 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9683
Val AUPRC score: 0.9930
Val best accuracy score: 0.9558
Val best F1 score: 0.9744
Val gene expr MSE score: 10022.0612
Val cat covariate0 mean sim diff: -0.0047

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8747; val_auprc_score: 0.9750; val_best_acc_score: 0.8724; val_best_f1_score: 0.9270; train_kl_reg_loss: 18966.5541; train_edge_recon_loss: 110962.7190; train_gene_expr_recon_loss: 897614.2596; train_masked_gp_l1_reg_loss: 42332.6070; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1069876.1330; train_optim_loss: 1069876.1330; val_kl_reg_loss: 18590.4117; val_edge_recon_loss: 117228.9974; val_gene_expr_recon_loss: 894845.1181; val_masked_gp_l1_reg_loss: 42210.5039; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1072875.0417; val_optim_loss: 1072875.0417
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8755; val_auprc_score: 0.9747; val_best_acc_score: 0.8737; val_best_f1_score: 0.9274; train_kl_reg_loss: 18893.3882; train_edge_recon_loss: 109860.9624; train_gene_expr_recon_loss: 896702.0473; train_masked_gp_l1_reg_loss: 42092.6763; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1067549.0737; train_optim_loss: 1067549.0737; val_kl_reg_loss: 18531.9290; val_edge_recon_loss: 118029.6319; val_gene_expr_recon_loss: 895318.9722; val_masked_gp_l1_reg_loss: 41971.3203; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1073851.9028; val_optim_loss: 1073851.9028
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8755; val_auprc_score: 0.9740; val_best_acc_score: 0.8736; val_best_f1_score: 0.9270; train_kl_reg_loss: 18881.4321; train_edge_recon_loss: 111157.5209; train_gene_expr_recon_loss: 895471.6675; train_masked_gp_l1_reg_loss: 41854.4321; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1067365.0641; train_optim_loss: 1067365.0641; val_kl_reg_loss: 18420.3700; val_edge_recon_loss: 119916.2274; val_gene_expr_recon_loss: 893362.3542; val_masked_gp_l1_reg_loss: 41735.0781; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1073434.0833; val_optim_loss: 1073434.0833

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 17 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9500
Val AUPRC score: 0.9888
Val best accuracy score: 0.9451
Val best F1 score: 0.9684
Val gene expr MSE score: 3758.2518
Val cat covariate0 mean sim diff: -0.0033

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
