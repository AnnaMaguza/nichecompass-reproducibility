[True]
Run timestamp: 10082023_230538_90.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_90']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7562; val_auprc_score: 0.7843; val_best_acc_score: 0.5031; val_best_f1_score: 0.6673; train_kl_reg_loss: 122263.4201; train_edge_recon_loss: 3808647.5363; train_gene_expr_recon_loss: 47194678.4427; train_masked_gp_l1_reg_loss: 87522.3420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 247316.7561; train_chrom_access_recon_loss: 17286991.9847; train_global_loss: 68747420.4275; train_optim_loss: 68747420.4275; val_kl_reg_loss: 128030.1531; val_edge_recon_loss: 4064705.0833; val_gene_expr_recon_loss: 39337463.4667; val_masked_gp_l1_reg_loss: 83892.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 243658.0625; val_chrom_access_recon_loss: 15691628.2667; val_global_loss: 59549379.2000; val_optim_loss: 59549379.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7844; val_auprc_score: 0.8029; val_best_acc_score: 0.6288; val_best_f1_score: 0.7160; train_kl_reg_loss: 170884.4304; train_edge_recon_loss: 3718499.5611; train_gene_expr_recon_loss: 38467715.3588; train_masked_gp_l1_reg_loss: 83900.7939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 239313.6047; train_chrom_access_recon_loss: 15560940.8855; train_global_loss: 58241254.8397; train_optim_loss: 58241254.8397; val_kl_reg_loss: 193381.1906; val_edge_recon_loss: 4057469.9000; val_gene_expr_recon_loss: 37488716.5333; val_masked_gp_l1_reg_loss: 81315.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 234306.6719; val_chrom_access_recon_loss: 15448414.2000; val_global_loss: 57503605.6000; val_optim_loss: 57503605.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8438; val_auprc_score: 0.8494; val_best_acc_score: 0.7386; val_best_f1_score: 0.7519; train_kl_reg_loss: 196373.2752; train_edge_recon_loss: 3581648.2519; train_gene_expr_recon_loss: 37058422.4122; train_masked_gp_l1_reg_loss: 79549.6364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 228896.5322; train_chrom_access_recon_loss: 15357666.7481; train_global_loss: 56502556.7939; train_optim_loss: 56502556.7939; val_kl_reg_loss: 176366.4927; val_edge_recon_loss: 4001057.8500; val_gene_expr_recon_loss: 37109852.8000; val_masked_gp_l1_reg_loss: 78948.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 223402.6875; val_chrom_access_recon_loss: 15389304.3333; val_global_loss: 56978933.3333; val_optim_loss: 56978933.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8693; val_auprc_score: 0.8689; val_best_acc_score: 0.7802; val_best_f1_score: 0.7878; train_kl_reg_loss: 167763.7827; train_edge_recon_loss: 3476338.8569; train_gene_expr_recon_loss: 36656109.1603; train_masked_gp_l1_reg_loss: 80223.1178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217948.5762; train_chrom_access_recon_loss: 15252231.0229; train_global_loss: 55850614.4733; train_optim_loss: 55850614.4733; val_kl_reg_loss: 162556.6458; val_edge_recon_loss: 3389089.0167; val_gene_expr_recon_loss: 36708281.8667; val_masked_gp_l1_reg_loss: 81915.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 212403.2188; val_chrom_access_recon_loss: 15239659.7333; val_global_loss: 55793907.2000; val_optim_loss: 55793907.2000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8721; val_auprc_score: 0.8692; val_best_acc_score: 0.7846; val_best_f1_score: 0.7922; train_kl_reg_loss: 190766.2304; train_edge_recon_loss: 3168182.4847; train_gene_expr_recon_loss: 36344596.4275; train_masked_gp_l1_reg_loss: 83501.7660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207027.5237; train_chrom_access_recon_loss: 15145966.6412; train_global_loss: 55140041.3435; train_optim_loss: 55140041.3435; val_kl_reg_loss: 200211.0021; val_edge_recon_loss: 3118233.0667; val_gene_expr_recon_loss: 36429538.4000; val_masked_gp_l1_reg_loss: 84771.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 201681.1719; val_chrom_access_recon_loss: 15115335.9333; val_global_loss: 55149770.4000; val_optim_loss: 55149770.4000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8854; val_auprc_score: 0.8767; val_best_acc_score: 0.8010; val_best_f1_score: 0.8136; train_kl_reg_loss: 189614.4402; train_edge_recon_loss: 3070306.2309; train_gene_expr_recon_loss: 36174159.6031; train_masked_gp_l1_reg_loss: 86415.1980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 196583.5205; train_chrom_access_recon_loss: 15111714.8321; train_global_loss: 54828793.5267; train_optim_loss: 54828793.5267; val_kl_reg_loss: 191131.6719; val_edge_recon_loss: 3049781.9333; val_gene_expr_recon_loss: 36244764.8000; val_masked_gp_l1_reg_loss: 87481.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 191592.6094; val_chrom_access_recon_loss: 15084797.2000; val_global_loss: 54849547.2000; val_optim_loss: 54849547.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8948; val_auprc_score: 0.8857; val_best_acc_score: 0.8083; val_best_f1_score: 0.8247; train_kl_reg_loss: 181018.7982; train_edge_recon_loss: 3012160.8435; train_gene_expr_recon_loss: 35965499.0382; train_masked_gp_l1_reg_loss: 88548.7108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186970.5058; train_chrom_access_recon_loss: 15039407.0611; train_global_loss: 54473605.1298; train_optim_loss: 54473605.1298; val_kl_reg_loss: 175123.7490; val_edge_recon_loss: 3014344.7833; val_gene_expr_recon_loss: 36186022.6667; val_masked_gp_l1_reg_loss: 89782.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182438.5781; val_chrom_access_recon_loss: 15091178.0000; val_global_loss: 54738893.3333; val_optim_loss: 54738893.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9175; val_auprc_score: 0.9070; val_best_acc_score: 0.8335; val_best_f1_score: 0.8461; train_kl_reg_loss: 171335.2409; train_edge_recon_loss: 2970860.2481; train_gene_expr_recon_loss: 35747646.9466; train_masked_gp_l1_reg_loss: 90813.9686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178200.0719; train_chrom_access_recon_loss: 14958042.6336; train_global_loss: 54116898.9924; train_optim_loss: 54116898.9924; val_kl_reg_loss: 174040.3802; val_edge_recon_loss: 2934421.2167; val_gene_expr_recon_loss: 35878083.2000; val_masked_gp_l1_reg_loss: 91803.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173983.0000; val_chrom_access_recon_loss: 14945731.1333; val_global_loss: 54198063.7333; val_optim_loss: 54198063.7333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9226; val_auprc_score: 0.9097; val_best_acc_score: 0.8477; val_best_f1_score: 0.8553; train_kl_reg_loss: 168812.3393; train_edge_recon_loss: 2921739.4523; train_gene_expr_recon_loss: 35565212.2748; train_masked_gp_l1_reg_loss: 92843.0905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169853.5335; train_chrom_access_recon_loss: 14889902.8473; train_global_loss: 53808363.4504; train_optim_loss: 53808363.4504; val_kl_reg_loss: 168512.5333; val_edge_recon_loss: 2920534.8833; val_gene_expr_recon_loss: 35763394.9333; val_masked_gp_l1_reg_loss: 93983.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165781.9531; val_chrom_access_recon_loss: 14933742.8667; val_global_loss: 54045949.0667; val_optim_loss: 54045949.0667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9298; val_auprc_score: 0.9179; val_best_acc_score: 0.8565; val_best_f1_score: 0.8642; train_kl_reg_loss: 166975.1115; train_edge_recon_loss: 2886509.2882; train_gene_expr_recon_loss: 35430880.2901; train_masked_gp_l1_reg_loss: 94981.0529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 161787.1320; train_chrom_access_recon_loss: 14852064.1603; train_global_loss: 53593197.0076; train_optim_loss: 53593197.0076; val_kl_reg_loss: 167151.7302; val_edge_recon_loss: 2908729.2000; val_gene_expr_recon_loss: 35599913.3333; val_masked_gp_l1_reg_loss: 96029.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157865.7188; val_chrom_access_recon_loss: 14853961.8667; val_global_loss: 53783648.2667; val_optim_loss: 53783648.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9388; val_auprc_score: 0.9276; val_best_acc_score: 0.8692; val_best_f1_score: 0.8750; train_kl_reg_loss: 162393.4637; train_edge_recon_loss: 2877271.6775; train_gene_expr_recon_loss: 35281713.1298; train_masked_gp_l1_reg_loss: 97035.4871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154142.1669; train_chrom_access_recon_loss: 14802735.4275; train_global_loss: 53375291.0534; train_optim_loss: 53375291.0534; val_kl_reg_loss: 158713.7083; val_edge_recon_loss: 2875885.4500; val_gene_expr_recon_loss: 35397910.4000; val_masked_gp_l1_reg_loss: 98413.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150443.6094; val_chrom_access_recon_loss: 14786003.7333; val_global_loss: 53467369.6000; val_optim_loss: 53467369.6000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9491; val_auprc_score: 0.9398; val_best_acc_score: 0.8817; val_best_f1_score: 0.8861; train_kl_reg_loss: 160059.1986; train_edge_recon_loss: 2854281.3855; train_gene_expr_recon_loss: 35179648.6718; train_masked_gp_l1_reg_loss: 99002.4583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146980.2267; train_chrom_access_recon_loss: 14778848.1908; train_global_loss: 53218819.8779; train_optim_loss: 53218819.8779; val_kl_reg_loss: 160116.2771; val_edge_recon_loss: 2848782.3000; val_gene_expr_recon_loss: 35345791.4667; val_masked_gp_l1_reg_loss: 99987.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143623.2656; val_chrom_access_recon_loss: 14801218.0000; val_global_loss: 53399521.0667; val_optim_loss: 53399521.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9491; val_auprc_score: 0.9399; val_best_acc_score: 0.8863; val_best_f1_score: 0.8920; train_kl_reg_loss: 155785.1428; train_edge_recon_loss: 2842333.6431; train_gene_expr_recon_loss: 35087261.6794; train_masked_gp_l1_reg_loss: 100800.4863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140413.7018; train_chrom_access_recon_loss: 14751181.3969; train_global_loss: 53077775.9084; train_optim_loss: 53077775.9084; val_kl_reg_loss: 153382.4396; val_edge_recon_loss: 2855118.0000; val_gene_expr_recon_loss: 35222256.2667; val_masked_gp_l1_reg_loss: 101840.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137245.6406; val_chrom_access_recon_loss: 14744138.8667; val_global_loss: 53213978.9333; val_optim_loss: 53213978.9333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9535; val_auprc_score: 0.9421; val_best_acc_score: 0.8899; val_best_f1_score: 0.8943; train_kl_reg_loss: 153256.4336; train_edge_recon_loss: 2829183.0458; train_gene_expr_recon_loss: 35007774.1527; train_masked_gp_l1_reg_loss: 102770.8851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134279.9575; train_chrom_access_recon_loss: 14724773.5954; train_global_loss: 52952038.5649; train_optim_loss: 52952038.5649; val_kl_reg_loss: 149175.2812; val_edge_recon_loss: 2841591.7833; val_gene_expr_recon_loss: 35089441.3333; val_masked_gp_l1_reg_loss: 103863.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131366.2188; val_chrom_access_recon_loss: 14703839.4667; val_global_loss: 53019279.4667; val_optim_loss: 53019279.4667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9554; val_auprc_score: 0.9453; val_best_acc_score: 0.8954; val_best_f1_score: 0.8990; train_kl_reg_loss: 149327.5241; train_edge_recon_loss: 2816811.1183; train_gene_expr_recon_loss: 34898943.0840; train_masked_gp_l1_reg_loss: 104579.5424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128580.1289; train_chrom_access_recon_loss: 14689276.3817; train_global_loss: 52787517.5878; train_optim_loss: 52787517.5878; val_kl_reg_loss: 146546.0646; val_edge_recon_loss: 2807341.7167; val_gene_expr_recon_loss: 35175196.8000; val_masked_gp_l1_reg_loss: 105411.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125795.6328; val_chrom_access_recon_loss: 14755117.3333; val_global_loss: 53115409.8667; val_optim_loss: 53115409.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9585; val_auprc_score: 0.9487; val_best_acc_score: 0.8972; val_best_f1_score: 0.9012; train_kl_reg_loss: 146954.6545; train_edge_recon_loss: 2813026.9332; train_gene_expr_recon_loss: 34827831.3740; train_masked_gp_l1_reg_loss: 106293.2198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123125.9167; train_chrom_access_recon_loss: 14670877.5573; train_global_loss: 52688109.6489; train_optim_loss: 52688109.6489; val_kl_reg_loss: 143306.2583; val_edge_recon_loss: 2805428.7333; val_gene_expr_recon_loss: 35006582.1333; val_masked_gp_l1_reg_loss: 107159.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120500.3906; val_chrom_access_recon_loss: 14693532.7333; val_global_loss: 52876509.3333; val_optim_loss: 52876509.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9616; val_auprc_score: 0.9548; val_best_acc_score: 0.9006; val_best_f1_score: 0.9044; train_kl_reg_loss: 144314.5085; train_edge_recon_loss: 2801079.7290; train_gene_expr_recon_loss: 34746182.2290; train_masked_gp_l1_reg_loss: 108152.0177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117990.8786; train_chrom_access_recon_loss: 14632489.1679; train_global_loss: 52550208.3664; train_optim_loss: 52550208.3664; val_kl_reg_loss: 144685.6365; val_edge_recon_loss: 2801895.7000; val_gene_expr_recon_loss: 35012692.5333; val_masked_gp_l1_reg_loss: 108990.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115486.3047; val_chrom_access_recon_loss: 14733015.2667; val_global_loss: 52916768.8000; val_optim_loss: 52916768.8000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9662; val_auprc_score: 0.9573; val_best_acc_score: 0.9089; val_best_f1_score: 0.9121; train_kl_reg_loss: 143142.1485; train_edge_recon_loss: 2787499.4924; train_gene_expr_recon_loss: 34699987.5878; train_masked_gp_l1_reg_loss: 109819.0609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113112.3963; train_chrom_access_recon_loss: 14627474.5344; train_global_loss: 52481035.2672; train_optim_loss: 52481035.2672; val_kl_reg_loss: 139310.4937; val_edge_recon_loss: 2781414.9333; val_gene_expr_recon_loss: 34854126.9333; val_masked_gp_l1_reg_loss: 110620.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110795.9688; val_chrom_access_recon_loss: 14684573.8000; val_global_loss: 52680842.1333; val_optim_loss: 52680842.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9670; val_auprc_score: 0.9607; val_best_acc_score: 0.9088; val_best_f1_score: 0.9123; train_kl_reg_loss: 140595.7382; train_edge_recon_loss: 2773362.6718; train_gene_expr_recon_loss: 34657744.9008; train_masked_gp_l1_reg_loss: 111528.8798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108530.7742; train_chrom_access_recon_loss: 14615151.2214; train_global_loss: 52406914.1374; train_optim_loss: 52406914.1374; val_kl_reg_loss: 140423.9542; val_edge_recon_loss: 2784215.1833; val_gene_expr_recon_loss: 34894369.3333; val_masked_gp_l1_reg_loss: 112337.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106315.9531; val_chrom_access_recon_loss: 14716951.8667; val_global_loss: 52754612.0000; val_optim_loss: 52754612.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9682; val_auprc_score: 0.9635; val_best_acc_score: 0.9100; val_best_f1_score: 0.9126; train_kl_reg_loss: 137567.2169; train_edge_recon_loss: 2780670.8950; train_gene_expr_recon_loss: 34593039.6794; train_masked_gp_l1_reg_loss: 113131.7929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104240.4470; train_chrom_access_recon_loss: 14599515.1221; train_global_loss: 52328165.1908; train_optim_loss: 52328165.1908; val_kl_reg_loss: 138065.2323; val_edge_recon_loss: 2789790.5333; val_gene_expr_recon_loss: 34785746.0000; val_masked_gp_l1_reg_loss: 113970.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102182.1953; val_chrom_access_recon_loss: 14586677.9333; val_global_loss: 52516435.7333; val_optim_loss: 52516435.7333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9682; val_auprc_score: 0.9594; val_best_acc_score: 0.9146; val_best_f1_score: 0.9176; train_kl_reg_loss: 136456.6885; train_edge_recon_loss: 2769745.4637; train_gene_expr_recon_loss: 34559976.3511; train_masked_gp_l1_reg_loss: 114844.4834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100257.5531; train_chrom_access_recon_loss: 14600313.9618; train_global_loss: 52281594.4427; train_optim_loss: 52281594.4427; val_kl_reg_loss: 135751.6021; val_edge_recon_loss: 2790694.8500; val_gene_expr_recon_loss: 34671069.6000; val_masked_gp_l1_reg_loss: 115654.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98405.8906; val_chrom_access_recon_loss: 14583872.6000; val_global_loss: 52395448.2667; val_optim_loss: 52395448.2667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9705; val_auprc_score: 0.9635; val_best_acc_score: 0.9148; val_best_f1_score: 0.9177; train_kl_reg_loss: 133939.7216; train_edge_recon_loss: 2764292.5573; train_gene_expr_recon_loss: 34476753.2061; train_masked_gp_l1_reg_loss: 116504.2964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96607.4249; train_chrom_access_recon_loss: 14565940.2519; train_global_loss: 52154037.4656; train_optim_loss: 52154037.4656; val_kl_reg_loss: 129934.3036; val_edge_recon_loss: 2758046.8667; val_gene_expr_recon_loss: 34696260.4000; val_masked_gp_l1_reg_loss: 117273.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94875.6953; val_chrom_access_recon_loss: 14603394.2000; val_global_loss: 52399783.7333; val_optim_loss: 52399783.7333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9704; val_auprc_score: 0.9650; val_best_acc_score: 0.9150; val_best_f1_score: 0.9187; train_kl_reg_loss: 131938.7033; train_edge_recon_loss: 2765295.3950; train_gene_expr_recon_loss: 34436147.0229; train_masked_gp_l1_reg_loss: 118059.8634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93243.8243; train_chrom_access_recon_loss: 14572475.4046; train_global_loss: 52117159.9084; train_optim_loss: 52117159.9084; val_kl_reg_loss: 128475.6760; val_edge_recon_loss: 2769463.6833; val_gene_expr_recon_loss: 34553831.0667; val_masked_gp_l1_reg_loss: 118837.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91653.5547; val_chrom_access_recon_loss: 14550709.4000; val_global_loss: 52212967.7333; val_optim_loss: 52212967.7333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9722; val_auprc_score: 0.9668; val_best_acc_score: 0.9227; val_best_f1_score: 0.9250; train_kl_reg_loss: 130740.0140; train_edge_recon_loss: 2760732.7004; train_gene_expr_recon_loss: 34405547.2977; train_masked_gp_l1_reg_loss: 119679.2532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90170.6572; train_chrom_access_recon_loss: 14558025.4656; train_global_loss: 52064895.0229; train_optim_loss: 52064895.0229; val_kl_reg_loss: 130452.8495; val_edge_recon_loss: 2762006.6000; val_gene_expr_recon_loss: 34668215.0667; val_masked_gp_l1_reg_loss: 120426.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88730.2500; val_chrom_access_recon_loss: 14601453.6667; val_global_loss: 52371287.7333; val_optim_loss: 52371287.7333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9704; val_auprc_score: 0.9653; val_best_acc_score: 0.9182; val_best_f1_score: 0.9218; train_kl_reg_loss: 127652.0535; train_edge_recon_loss: 2756701.8531; train_gene_expr_recon_loss: 34355724.9008; train_masked_gp_l1_reg_loss: 121289.6159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87388.6621; train_chrom_access_recon_loss: 14553857.0153; train_global_loss: 52002613.9847; train_optim_loss: 52002613.9847; val_kl_reg_loss: 126822.1109; val_edge_recon_loss: 2767752.5167; val_gene_expr_recon_loss: 34503807.6000; val_masked_gp_l1_reg_loss: 121940.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86094.7969; val_chrom_access_recon_loss: 14538046.2667; val_global_loss: 52144464.8000; val_optim_loss: 52144464.8000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9633; val_auprc_score: 0.9565; val_best_acc_score: 0.9042; val_best_f1_score: 0.9084; train_kl_reg_loss: 163904.1650; train_edge_recon_loss: 2971112.1374; train_gene_expr_recon_loss: 37758433.6794; train_masked_gp_l1_reg_loss: 123620.5200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89412.1794; train_chrom_access_recon_loss: 15008629.5496; train_global_loss: 56115112.5496; train_optim_loss: 56115112.5496; val_kl_reg_loss: 28092.2703; val_edge_recon_loss: 2929253.5667; val_gene_expr_recon_loss: 37981082.4000; val_masked_gp_l1_reg_loss: 124389.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89643.3438; val_chrom_access_recon_loss: 15055503.2000; val_global_loss: 56207963.2000; val_optim_loss: 56207963.2000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9442; val_auprc_score: 0.9298; val_best_acc_score: 0.8847; val_best_f1_score: 0.8909; train_kl_reg_loss: 141503.5943; train_edge_recon_loss: 2882681.5458; train_gene_expr_recon_loss: 39875736.4275; train_masked_gp_l1_reg_loss: 124958.2151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90329.3959; train_chrom_access_recon_loss: 15138588.3130; train_global_loss: 58253797.7405; train_optim_loss: 58253797.7405; val_kl_reg_loss: 19342.2456; val_edge_recon_loss: 2797489.4167; val_gene_expr_recon_loss: 40904122.6667; val_masked_gp_l1_reg_loss: 123872.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89618.6016; val_chrom_access_recon_loss: 15206250.6667; val_global_loss: 59140696.5333; val_optim_loss: 59140696.5333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9491; val_auprc_score: 0.9356; val_best_acc_score: 0.8875; val_best_f1_score: 0.8945; train_kl_reg_loss: 90953.6261; train_edge_recon_loss: 2771928.9561; train_gene_expr_recon_loss: 40345355.2366; train_masked_gp_l1_reg_loss: 121246.1846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87596.4869; train_chrom_access_recon_loss: 15148291.8473; train_global_loss: 58565372.1527; train_optim_loss: 58565372.1527; val_kl_reg_loss: 24134.3900; val_edge_recon_loss: 2766868.8667; val_gene_expr_recon_loss: 40158122.4000; val_masked_gp_l1_reg_loss: 118495.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85469.3750; val_chrom_access_recon_loss: 15132831.8667; val_global_loss: 58285921.3333; val_optim_loss: 58285921.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9555; val_auprc_score: 0.9430; val_best_acc_score: 0.8957; val_best_f1_score: 0.8997; train_kl_reg_loss: 68247.1337; train_edge_recon_loss: 2734483.8263; train_gene_expr_recon_loss: 39720927.9389; train_masked_gp_l1_reg_loss: 115807.5665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83417.6232; train_chrom_access_recon_loss: 15106854.2901; train_global_loss: 57829738.2901; train_optim_loss: 57829738.2901; val_kl_reg_loss: 26579.1793; val_edge_recon_loss: 2747592.8500; val_gene_expr_recon_loss: 39625190.4000; val_masked_gp_l1_reg_loss: 113172.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81341.3516; val_chrom_access_recon_loss: 15115553.5333; val_global_loss: 57709427.4667; val_optim_loss: 57709427.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9528; val_auprc_score: 0.9390; val_best_acc_score: 0.8964; val_best_f1_score: 0.9018; train_kl_reg_loss: 58421.8311; train_edge_recon_loss: 2720768.6603; train_gene_expr_recon_loss: 39429489.6183; train_masked_gp_l1_reg_loss: 112666.8749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81064.8095; train_chrom_access_recon_loss: 15072050.8855; train_global_loss: 57474462.9008; train_optim_loss: 57474462.9008; val_kl_reg_loss: 28418.8812; val_edge_recon_loss: 2740911.4333; val_gene_expr_recon_loss: 39651472.0000; val_masked_gp_l1_reg_loss: 112357.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80807.1016; val_chrom_access_recon_loss: 15110221.3333; val_global_loss: 57724188.0000; val_optim_loss: 57724188.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9564; val_auprc_score: 0.9440; val_best_acc_score: 0.8980; val_best_f1_score: 0.9012; train_kl_reg_loss: 59372.2510; train_edge_recon_loss: 2716162.8263; train_gene_expr_recon_loss: 39366782.6870; train_masked_gp_l1_reg_loss: 112070.1827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80556.5067; train_chrom_access_recon_loss: 15073540.8855; train_global_loss: 57408485.5573; train_optim_loss: 57408485.5573; val_kl_reg_loss: 29094.3328; val_edge_recon_loss: 2743534.9833; val_gene_expr_recon_loss: 39572324.8000; val_masked_gp_l1_reg_loss: 111768.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80299.0781; val_chrom_access_recon_loss: 15094672.0667; val_global_loss: 57631694.6667; val_optim_loss: 57631694.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9510; val_auprc_score: 0.9352; val_best_acc_score: 0.8949; val_best_f1_score: 0.9006; train_kl_reg_loss: 58730.0197; train_edge_recon_loss: 2716565.4714; train_gene_expr_recon_loss: 39312348.5191; train_masked_gp_l1_reg_loss: 111463.9689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80043.1471; train_chrom_access_recon_loss: 15066088.0229; train_global_loss: 57345238.7176; train_optim_loss: 57345238.7176; val_kl_reg_loss: 30048.2954; val_edge_recon_loss: 2731752.7167; val_gene_expr_recon_loss: 39677415.7333; val_masked_gp_l1_reg_loss: 111148.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79781.1562; val_chrom_access_recon_loss: 15198497.0667; val_global_loss: 57828641.8667; val_optim_loss: 57828641.8667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9544; val_auprc_score: 0.9422; val_best_acc_score: 0.8954; val_best_f1_score: 0.8998; train_kl_reg_loss: 59112.9161; train_edge_recon_loss: 2705788.1145; train_gene_expr_recon_loss: 39294093.1908; train_masked_gp_l1_reg_loss: 110830.5586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79517.6984; train_chrom_access_recon_loss: 15066536.6870; train_global_loss: 57315878.9618; train_optim_loss: 57315878.9618; val_kl_reg_loss: 30679.8505; val_edge_recon_loss: 2736419.7500; val_gene_expr_recon_loss: 39443762.6667; val_masked_gp_l1_reg_loss: 110498.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79246.7656; val_chrom_access_recon_loss: 15092904.0667; val_global_loss: 57493513.6000; val_optim_loss: 57493513.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 5 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9687
val AUPRC score: 0.9625
val best accuracy score: 0.9115
val best F1 score: 0.9154
val target rna MSE score: 1.8906
val source rna MSE score: 157.4524
val target atac MSE score: 0.3552
val source atac MSE score: 4.0108
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
