[True]
Run timestamp: 06092023_234613_212.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_212']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 26065 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 30568, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 26065
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 26065

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6923; val_auprc_score: 0.6723; val_best_acc_score: 0.5202; val_best_f1_score: 0.6717; train_kl_reg_loss: 86638.9755; train_edge_recon_loss: 3657407.3977; train_gene_expr_recon_loss: 17424058.3182; train_masked_gp_l1_reg_loss: 51152.8589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10444422.7803; train_chrom_access_recon_loss: 35504449.7576; train_global_loss: 67168129.5152; train_optim_loss: 67168129.5152; val_kl_reg_loss: 158888.8652; val_edge_recon_loss: 4063520.6562; val_gene_expr_recon_loss: 15561769.6250; val_masked_gp_l1_reg_loss: 49899.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4196415.5000; val_chrom_access_recon_loss: 34732080.0000; val_global_loss: 58762575.0000; val_optim_loss: 58762575.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6987; val_auprc_score: 0.6835; val_best_acc_score: 0.5785; val_best_f1_score: 0.6906; train_kl_reg_loss: 146028.2492; train_edge_recon_loss: 3573440.9242; train_gene_expr_recon_loss: 15097703.8182; train_masked_gp_l1_reg_loss: 45243.9496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1761310.5076; train_chrom_access_recon_loss: 33528298.7273; train_global_loss: 54152026.4848; train_optim_loss: 54152026.4848; val_kl_reg_loss: 155484.5840; val_edge_recon_loss: 4060239.5312; val_gene_expr_recon_loss: 15214266.7500; val_masked_gp_l1_reg_loss: 41648.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 706064.3125; val_chrom_access_recon_loss: 34624199.0000; val_global_loss: 54801901.5000; val_optim_loss: 54801901.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7424; val_auprc_score: 0.7233; val_best_acc_score: 0.6835; val_best_f1_score: 0.6926; train_kl_reg_loss: 145411.3770; train_edge_recon_loss: 3550750.6061; train_gene_expr_recon_loss: 14687960.1515; train_masked_gp_l1_reg_loss: 40203.0909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 500710.9394; train_chrom_access_recon_loss: 33204254.7576; train_global_loss: 52129291.0303; train_optim_loss: 52129291.0303; val_kl_reg_loss: 144898.6152; val_edge_recon_loss: 4040154.6562; val_gene_expr_recon_loss: 14628896.7500; val_masked_gp_l1_reg_loss: 39584.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 356681.4375; val_chrom_access_recon_loss: 33951265.2500; val_global_loss: 53161482.0000; val_optim_loss: 53161482.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8019; val_auprc_score: 0.7782; val_best_acc_score: 0.7182; val_best_f1_score: 0.7531; train_kl_reg_loss: 127638.7811; train_edge_recon_loss: 3529822.9508; train_gene_expr_recon_loss: 14505248.4242; train_masked_gp_l1_reg_loss: 40010.8289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 296114.7183; train_chrom_access_recon_loss: 32952934.0303; train_global_loss: 51451769.8788; train_optim_loss: 51451769.8788; val_kl_reg_loss: 114997.5908; val_edge_recon_loss: 3873743.8125; val_gene_expr_recon_loss: 14518825.7500; val_masked_gp_l1_reg_loss: 40791.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 252745.5000; val_chrom_access_recon_loss: 33687294.5000; val_global_loss: 52488399.5000; val_optim_loss: 52488399.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8197; val_auprc_score: 0.7942; val_best_acc_score: 0.7278; val_best_f1_score: 0.7808; train_kl_reg_loss: 113729.6894; train_edge_recon_loss: 3318432.6288; train_gene_expr_recon_loss: 14417216.7727; train_masked_gp_l1_reg_loss: 41882.1716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 228903.9216; train_chrom_access_recon_loss: 32778646.3636; train_global_loss: 50898811.3333; train_optim_loss: 50898811.3333; val_kl_reg_loss: 140718.6895; val_edge_recon_loss: 3110565.8125; val_gene_expr_recon_loss: 14477750.2500; val_masked_gp_l1_reg_loss: 43140.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 210637.3750; val_chrom_access_recon_loss: 33237006.2500; val_global_loss: 51219818.5000; val_optim_loss: 51219818.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8370; val_auprc_score: 0.7961; val_best_acc_score: 0.7601; val_best_f1_score: 0.7875; train_kl_reg_loss: 148874.6007; train_edge_recon_loss: 3020427.2273; train_gene_expr_recon_loss: 14334324.8788; train_masked_gp_l1_reg_loss: 44080.9109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197072.0627; train_chrom_access_recon_loss: 32589385.4545; train_global_loss: 50334164.7273; train_optim_loss: 50334164.7273; val_kl_reg_loss: 156131.9707; val_edge_recon_loss: 3003069.0625; val_gene_expr_recon_loss: 14375990.6250; val_masked_gp_l1_reg_loss: 45085.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185376.5938; val_chrom_access_recon_loss: 33095029.2500; val_global_loss: 50860683.0000; val_optim_loss: 50860683.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8415; val_auprc_score: 0.8127; val_best_acc_score: 0.7697; val_best_f1_score: 0.7934; train_kl_reg_loss: 148652.2363; train_edge_recon_loss: 2983853.4697; train_gene_expr_recon_loss: 14254934.6667; train_masked_gp_l1_reg_loss: 45817.6521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178408.5298; train_chrom_access_recon_loss: 32434501.9091; train_global_loss: 50046168.3636; train_optim_loss: 50046168.3636; val_kl_reg_loss: 143644.2051; val_edge_recon_loss: 2981912.5312; val_gene_expr_recon_loss: 14358321.2500; val_masked_gp_l1_reg_loss: 46613.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172495.4375; val_chrom_access_recon_loss: 33160070.7500; val_global_loss: 50863058.5000; val_optim_loss: 50863058.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8421; val_auprc_score: 0.8018; val_best_acc_score: 0.7749; val_best_f1_score: 0.8012; train_kl_reg_loss: 143754.2914; train_edge_recon_loss: 2958340.2273; train_gene_expr_recon_loss: 14181713.8485; train_masked_gp_l1_reg_loss: 47359.8923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167571.7498; train_chrom_access_recon_loss: 32305227.7273; train_global_loss: 49803968.1818; train_optim_loss: 49803968.1818; val_kl_reg_loss: 135174.6328; val_edge_recon_loss: 2971505.5000; val_gene_expr_recon_loss: 14308325.7500; val_masked_gp_l1_reg_loss: 47958.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163422.0000; val_chrom_access_recon_loss: 32965278.7500; val_global_loss: 50591664.5000; val_optim_loss: 50591664.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8380; val_auprc_score: 0.7926; val_best_acc_score: 0.7832; val_best_f1_score: 0.8103; train_kl_reg_loss: 134949.3095; train_edge_recon_loss: 2944733.4167; train_gene_expr_recon_loss: 14128572.2121; train_masked_gp_l1_reg_loss: 48583.3556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159907.6591; train_chrom_access_recon_loss: 32173420.3939; train_global_loss: 49590166.4848; train_optim_loss: 49590166.4848; val_kl_reg_loss: 130043.2148; val_edge_recon_loss: 2966312.4688; val_gene_expr_recon_loss: 14366684.0000; val_masked_gp_l1_reg_loss: 49257.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157438.0781; val_chrom_access_recon_loss: 33042833.7500; val_global_loss: 50712568.5000; val_optim_loss: 50712568.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8469; val_auprc_score: 0.7992; val_best_acc_score: 0.7902; val_best_f1_score: 0.8177; train_kl_reg_loss: 132073.6316; train_edge_recon_loss: 2898549.2083; train_gene_expr_recon_loss: 14069863.1667; train_masked_gp_l1_reg_loss: 49862.4473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155111.0919; train_chrom_access_recon_loss: 32036882.6667; train_global_loss: 49342342.2424; train_optim_loss: 49342342.2424; val_kl_reg_loss: 129805.9912; val_edge_recon_loss: 2946393.6562; val_gene_expr_recon_loss: 14263299.2500; val_masked_gp_l1_reg_loss: 50567.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153120.8750; val_chrom_access_recon_loss: 33193356.5000; val_global_loss: 50736543.5000; val_optim_loss: 50736543.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8563; val_auprc_score: 0.8104; val_best_acc_score: 0.7963; val_best_f1_score: 0.8219; train_kl_reg_loss: 129958.6945; train_edge_recon_loss: 2889581.6818; train_gene_expr_recon_loss: 14011545.3182; train_masked_gp_l1_reg_loss: 51071.6596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151360.2905; train_chrom_access_recon_loss: 31902309.0303; train_global_loss: 49135826.7273; train_optim_loss: 49135826.7273; val_kl_reg_loss: 129469.1221; val_edge_recon_loss: 2906231.4688; val_gene_expr_recon_loss: 14041516.6250; val_masked_gp_l1_reg_loss: 51685.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149312.5312; val_chrom_access_recon_loss: 32435515.5000; val_global_loss: 49713729.5000; val_optim_loss: 49713729.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8692; val_auprc_score: 0.8379; val_best_acc_score: 0.7945; val_best_f1_score: 0.8212; train_kl_reg_loss: 129487.8692; train_edge_recon_loss: 2862915.9886; train_gene_expr_recon_loss: 13968041.3485; train_masked_gp_l1_reg_loss: 52211.7127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148302.9081; train_chrom_access_recon_loss: 31786395.3333; train_global_loss: 48947355.3939; train_optim_loss: 48947355.3939; val_kl_reg_loss: 128191.2490; val_edge_recon_loss: 2904158.0000; val_gene_expr_recon_loss: 14095631.3750; val_masked_gp_l1_reg_loss: 52932.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147730.2812; val_chrom_access_recon_loss: 32784341.7500; val_global_loss: 50112985.5000; val_optim_loss: 50112985.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8802; val_auprc_score: 0.8494; val_best_acc_score: 0.8071; val_best_f1_score: 0.8306; train_kl_reg_loss: 127736.9616; train_edge_recon_loss: 2864799.7765; train_gene_expr_recon_loss: 13923818.5758; train_masked_gp_l1_reg_loss: 53346.9030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146274.5893; train_chrom_access_recon_loss: 31713645.8485; train_global_loss: 48829622.7273; train_optim_loss: 48829622.7273; val_kl_reg_loss: 129684.0508; val_edge_recon_loss: 2881138.7188; val_gene_expr_recon_loss: 14009496.0000; val_masked_gp_l1_reg_loss: 53848.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145387.9375; val_chrom_access_recon_loss: 32703394.0000; val_global_loss: 49922949.5000; val_optim_loss: 49922949.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8768; val_auprc_score: 0.8485; val_best_acc_score: 0.8001; val_best_f1_score: 0.8202; train_kl_reg_loss: 126951.0223; train_edge_recon_loss: 2853780.2311; train_gene_expr_recon_loss: 13887020.9242; train_masked_gp_l1_reg_loss: 54318.6431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144302.9896; train_chrom_access_recon_loss: 31617070.2727; train_global_loss: 48683444.1212; train_optim_loss: 48683444.1212; val_kl_reg_loss: 128690.3936; val_edge_recon_loss: 2908004.2812; val_gene_expr_recon_loss: 13985927.2500; val_masked_gp_l1_reg_loss: 54919.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143383.0625; val_chrom_access_recon_loss: 32413763.5000; val_global_loss: 49634689.5000; val_optim_loss: 49634689.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8963; val_auprc_score: 0.8660; val_best_acc_score: 0.8246; val_best_f1_score: 0.8428; train_kl_reg_loss: 124106.9125; train_edge_recon_loss: 2843936.1818; train_gene_expr_recon_loss: 13831401.5758; train_masked_gp_l1_reg_loss: 55419.8555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142398.6321; train_chrom_access_recon_loss: 31502782.6364; train_global_loss: 48500045.8182; train_optim_loss: 48500045.8182; val_kl_reg_loss: 124711.7344; val_edge_recon_loss: 2862627.1562; val_gene_expr_recon_loss: 13925761.1250; val_masked_gp_l1_reg_loss: 55950.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141288.4219; val_chrom_access_recon_loss: 32154836.0000; val_global_loss: 49265175.0000; val_optim_loss: 49265175.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9160; val_auprc_score: 0.8910; val_best_acc_score: 0.8501; val_best_f1_score: 0.8589; train_kl_reg_loss: 124340.4126; train_edge_recon_loss: 2810720.8826; train_gene_expr_recon_loss: 13807597.1061; train_masked_gp_l1_reg_loss: 56342.6419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141284.0478; train_chrom_access_recon_loss: 31429636.2727; train_global_loss: 48369921.3939; train_optim_loss: 48369921.3939; val_kl_reg_loss: 122250.8652; val_edge_recon_loss: 2840562.9062; val_gene_expr_recon_loss: 13915893.1250; val_masked_gp_l1_reg_loss: 56923.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140732.5156; val_chrom_access_recon_loss: 32386930.5000; val_global_loss: 49463293.5000; val_optim_loss: 49463293.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9152; val_auprc_score: 0.8873; val_best_acc_score: 0.8479; val_best_f1_score: 0.8594; train_kl_reg_loss: 124681.5575; train_edge_recon_loss: 2783621.7538; train_gene_expr_recon_loss: 13757046.0455; train_masked_gp_l1_reg_loss: 57364.6275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139939.2640; train_chrom_access_recon_loss: 31291558.4242; train_global_loss: 48154211.8182; train_optim_loss: 48154211.8182; val_kl_reg_loss: 123176.6328; val_edge_recon_loss: 2796568.3750; val_gene_expr_recon_loss: 13852182.5000; val_masked_gp_l1_reg_loss: 57871.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139187.3594; val_chrom_access_recon_loss: 32063613.2500; val_global_loss: 49032600.0000; val_optim_loss: 49032600.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9124; val_auprc_score: 0.8840; val_best_acc_score: 0.8474; val_best_f1_score: 0.8583; train_kl_reg_loss: 124702.3981; train_edge_recon_loss: 2788471.5038; train_gene_expr_recon_loss: 13725126.6364; train_masked_gp_l1_reg_loss: 58329.1304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138845.0069; train_chrom_access_recon_loss: 31184870.9394; train_global_loss: 48020345.5152; train_optim_loss: 48020345.5152; val_kl_reg_loss: 123698.9150; val_edge_recon_loss: 2854528.6250; val_gene_expr_recon_loss: 13820485.6250; val_masked_gp_l1_reg_loss: 58756.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138161.3906; val_chrom_access_recon_loss: 32066480.5000; val_global_loss: 49062112.0000; val_optim_loss: 49062112.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9196; val_auprc_score: 0.8909; val_best_acc_score: 0.8552; val_best_f1_score: 0.8674; train_kl_reg_loss: 122690.3627; train_edge_recon_loss: 2788474.7576; train_gene_expr_recon_loss: 13695508.7727; train_masked_gp_l1_reg_loss: 59199.0984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137813.7372; train_chrom_access_recon_loss: 31097383.3939; train_global_loss: 47901069.9394; train_optim_loss: 47901069.9394; val_kl_reg_loss: 122541.9355; val_edge_recon_loss: 2813335.1875; val_gene_expr_recon_loss: 13867683.3750; val_masked_gp_l1_reg_loss: 59606.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137352.9375; val_chrom_access_recon_loss: 31915885.0000; val_global_loss: 48916404.5000; val_optim_loss: 48916404.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9186; val_auprc_score: 0.8780; val_best_acc_score: 0.8611; val_best_f1_score: 0.8707; train_kl_reg_loss: 122900.6244; train_edge_recon_loss: 2776436.1061; train_gene_expr_recon_loss: 13656928.6364; train_masked_gp_l1_reg_loss: 60009.6377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137250.2256; train_chrom_access_recon_loss: 30999870.3333; train_global_loss: 47753395.6970; train_optim_loss: 47753395.6970; val_kl_reg_loss: 120266.2227; val_edge_recon_loss: 2811311.4062; val_gene_expr_recon_loss: 13764508.2500; val_masked_gp_l1_reg_loss: 60472.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136874.7500; val_chrom_access_recon_loss: 31981452.7500; val_global_loss: 48874886.0000; val_optim_loss: 48874886.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9184; val_auprc_score: 0.8830; val_best_acc_score: 0.8568; val_best_f1_score: 0.8688; train_kl_reg_loss: 121258.9499; train_edge_recon_loss: 2766464.1439; train_gene_expr_recon_loss: 13636417.1212; train_masked_gp_l1_reg_loss: 60783.4508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136248.1054; train_chrom_access_recon_loss: 30926796.4848; train_global_loss: 47647968.1818; train_optim_loss: 47647968.1818; val_kl_reg_loss: 118000.9424; val_edge_recon_loss: 2818095.1562; val_gene_expr_recon_loss: 13802480.7500; val_masked_gp_l1_reg_loss: 61224.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136275.7031; val_chrom_access_recon_loss: 31941140.0000; val_global_loss: 48877217.0000; val_optim_loss: 48877217.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9203; val_auprc_score: 0.8924; val_best_acc_score: 0.8579; val_best_f1_score: 0.8682; train_kl_reg_loss: 120926.8237; train_edge_recon_loss: 2765347.0720; train_gene_expr_recon_loss: 13614221.9394; train_masked_gp_l1_reg_loss: 61573.5562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135875.4896; train_chrom_access_recon_loss: 30862080.8485; train_global_loss: 47560025.7576; train_optim_loss: 47560025.7576; val_kl_reg_loss: 121902.2949; val_edge_recon_loss: 2810327.6562; val_gene_expr_recon_loss: 13713063.3750; val_masked_gp_l1_reg_loss: 61985.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135633.4844; val_chrom_access_recon_loss: 31674162.2500; val_global_loss: 48517075.0000; val_optim_loss: 48517075.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9261; val_auprc_score: 0.8952; val_best_acc_score: 0.8678; val_best_f1_score: 0.8748; train_kl_reg_loss: 119447.5342; train_edge_recon_loss: 2753074.8144; train_gene_expr_recon_loss: 13585201.8333; train_masked_gp_l1_reg_loss: 62323.3335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135177.2919; train_chrom_access_recon_loss: 30757634.3333; train_global_loss: 47412859.4545; train_optim_loss: 47412859.4545; val_kl_reg_loss: 118887.1523; val_edge_recon_loss: 2795746.3750; val_gene_expr_recon_loss: 13708469.6250; val_masked_gp_l1_reg_loss: 62680.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134891.8125; val_chrom_access_recon_loss: 31423087.0000; val_global_loss: 48243762.5000; val_optim_loss: 48243762.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9244; val_auprc_score: 0.9024; val_best_acc_score: 0.8606; val_best_f1_score: 0.8705; train_kl_reg_loss: 117699.8583; train_edge_recon_loss: 2761313.0189; train_gene_expr_recon_loss: 13557751.0606; train_masked_gp_l1_reg_loss: 62998.0402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134361.6096; train_chrom_access_recon_loss: 30681052.6970; train_global_loss: 47315176.4848; train_optim_loss: 47315176.4848; val_kl_reg_loss: 115402.6816; val_edge_recon_loss: 2793055.3438; val_gene_expr_recon_loss: 13652029.1250; val_masked_gp_l1_reg_loss: 63260.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133910.6719; val_chrom_access_recon_loss: 31549661.2500; val_global_loss: 48307319.0000; val_optim_loss: 48307319.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9307; val_auprc_score: 0.9039; val_best_acc_score: 0.8657; val_best_f1_score: 0.8746; train_kl_reg_loss: 117169.7296; train_edge_recon_loss: 2753954.2576; train_gene_expr_recon_loss: 13533089.1818; train_masked_gp_l1_reg_loss: 63744.2720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133905.4927; train_chrom_access_recon_loss: 30594317.9394; train_global_loss: 47196181.1515; train_optim_loss: 47196181.1515; val_kl_reg_loss: 114930.3438; val_edge_recon_loss: 2793568.8750; val_gene_expr_recon_loss: 13745625.3750; val_masked_gp_l1_reg_loss: 64022.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134011.1875; val_chrom_access_recon_loss: 31612354.2500; val_global_loss: 48464513.5000; val_optim_loss: 48464513.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9337; val_auprc_score: 0.9075; val_best_acc_score: 0.8775; val_best_f1_score: 0.8844; train_kl_reg_loss: 124791.9866; train_edge_recon_loss: 2805612.6364; train_gene_expr_recon_loss: 13142899.8788; train_masked_gp_l1_reg_loss: 62723.6417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144758.9160; train_chrom_access_recon_loss: 30212622.1818; train_global_loss: 46493409.2121; train_optim_loss: 46493409.2121; val_kl_reg_loss: 72122.3623; val_edge_recon_loss: 2808585.3750; val_gene_expr_recon_loss: 13242444.2500; val_masked_gp_l1_reg_loss: 61758.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146758.9531; val_chrom_access_recon_loss: 30747021.5000; val_global_loss: 47078691.5000; val_optim_loss: 47078691.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9361; val_auprc_score: 0.9089; val_best_acc_score: 0.8818; val_best_f1_score: 0.8878; train_kl_reg_loss: 125354.9257; train_edge_recon_loss: 2780080.8598; train_gene_expr_recon_loss: 13057594.8939; train_masked_gp_l1_reg_loss: 61442.0072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144044.7204; train_chrom_access_recon_loss: 29879980.5758; train_global_loss: 46048498.1212; train_optim_loss: 46048498.1212; val_kl_reg_loss: 78559.5107; val_edge_recon_loss: 2794120.1562; val_gene_expr_recon_loss: 13120494.6250; val_masked_gp_l1_reg_loss: 61242.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141906.1250; val_chrom_access_recon_loss: 30599067.2500; val_global_loss: 46795390.5000; val_optim_loss: 46795390.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9348; val_auprc_score: 0.9065; val_best_acc_score: 0.8769; val_best_f1_score: 0.8838; train_kl_reg_loss: 118662.6465; train_edge_recon_loss: 2762479.8409; train_gene_expr_recon_loss: 13036102.9848; train_masked_gp_l1_reg_loss: 61031.8581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139214.6816; train_chrom_access_recon_loss: 29815024.6970; train_global_loss: 45932516.7273; train_optim_loss: 45932516.7273; val_kl_reg_loss: 84583.0879; val_edge_recon_loss: 2788195.4375; val_gene_expr_recon_loss: 13108914.6250; val_masked_gp_l1_reg_loss: 60895.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137119.2656; val_chrom_access_recon_loss: 30557622.5000; val_global_loss: 46737329.0000; val_optim_loss: 46737329.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9388; val_auprc_score: 0.9146; val_best_acc_score: 0.8799; val_best_f1_score: 0.8870; train_kl_reg_loss: 112858.1112; train_edge_recon_loss: 2757142.8030; train_gene_expr_recon_loss: 12994205.2273; train_masked_gp_l1_reg_loss: 60762.3692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135531.1281; train_chrom_access_recon_loss: 29682529.9091; train_global_loss: 45743029.0909; train_optim_loss: 45743029.0909; val_kl_reg_loss: 88215.2715; val_edge_recon_loss: 2792212.7812; val_gene_expr_recon_loss: 13146702.6250; val_masked_gp_l1_reg_loss: 60673.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134074.1250; val_chrom_access_recon_loss: 30534420.2500; val_global_loss: 46756298.0000; val_optim_loss: 46756298.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9401; val_auprc_score: 0.9238; val_best_acc_score: 0.8804; val_best_f1_score: 0.8870; train_kl_reg_loss: 109072.0104; train_edge_recon_loss: 2744065.2955; train_gene_expr_recon_loss: 12979923.9848; train_masked_gp_l1_reg_loss: 60605.6750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132529.4299; train_chrom_access_recon_loss: 29654044.5152; train_global_loss: 45680240.8485; train_optim_loss: 45680240.8485; val_kl_reg_loss: 89918.1582; val_edge_recon_loss: 2779577.5625; val_gene_expr_recon_loss: 13135691.0000; val_masked_gp_l1_reg_loss: 60585.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131014.9219; val_chrom_access_recon_loss: 30412141.7500; val_global_loss: 46608930.0000; val_optim_loss: 46608930.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9393; val_auprc_score: 0.9148; val_best_acc_score: 0.8831; val_best_f1_score: 0.8907; train_kl_reg_loss: 108316.5314; train_edge_recon_loss: 2727877.4583; train_gene_expr_recon_loss: 12962096.0303; train_masked_gp_l1_reg_loss: 60561.7325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130195.4734; train_chrom_access_recon_loss: 29594409.4242; train_global_loss: 45583456.4848; train_optim_loss: 45583456.4848; val_kl_reg_loss: 91728.0635; val_edge_recon_loss: 2769369.6562; val_gene_expr_recon_loss: 13164674.5000; val_masked_gp_l1_reg_loss: 60588.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129219.1953; val_chrom_access_recon_loss: 30495603.2500; val_global_loss: 46711183.5000; val_optim_loss: 46711183.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9498; val_auprc_score: 0.9324; val_best_acc_score: 0.8912; val_best_f1_score: 0.8954; train_kl_reg_loss: 104577.9781; train_edge_recon_loss: 2732791.4167; train_gene_expr_recon_loss: 12932543.6212; train_masked_gp_l1_reg_loss: 60603.0906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128282.0308; train_chrom_access_recon_loss: 29503546.7879; train_global_loss: 45462344.7879; train_optim_loss: 45462344.7879; val_kl_reg_loss: 92505.4365; val_edge_recon_loss: 2748541.4375; val_gene_expr_recon_loss: 12966962.2500; val_masked_gp_l1_reg_loss: 60633.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128209.4844; val_chrom_access_recon_loss: 29888249.7500; val_global_loss: 45885101.0000; val_optim_loss: 45885101.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9446; val_auprc_score: 0.9279; val_best_acc_score: 0.8845; val_best_f1_score: 0.8891; train_kl_reg_loss: 103769.8711; train_edge_recon_loss: 2738761.3939; train_gene_expr_recon_loss: 12882740.1818; train_masked_gp_l1_reg_loss: 60690.8746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126651.1487; train_chrom_access_recon_loss: 29384503.1212; train_global_loss: 45297116.7879; train_optim_loss: 45297116.7879; val_kl_reg_loss: 92616.5137; val_edge_recon_loss: 2775190.0312; val_gene_expr_recon_loss: 12981172.6250; val_masked_gp_l1_reg_loss: 60722.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125618.2891; val_chrom_access_recon_loss: 30072876.0000; val_global_loss: 46108194.5000; val_optim_loss: 46108194.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9400; val_auprc_score: 0.9163; val_best_acc_score: 0.8829; val_best_f1_score: 0.8907; train_kl_reg_loss: 101731.6265; train_edge_recon_loss: 2732371.3068; train_gene_expr_recon_loss: 12867722.2424; train_masked_gp_l1_reg_loss: 60788.6379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125345.1759; train_chrom_access_recon_loss: 29330951.5758; train_global_loss: 45218910.9091; train_optim_loss: 45218910.9091; val_kl_reg_loss: 92133.0996; val_edge_recon_loss: 2773169.0000; val_gene_expr_recon_loss: 12988771.3750; val_masked_gp_l1_reg_loss: 60847.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124339.7969; val_chrom_access_recon_loss: 29905202.7500; val_global_loss: 45944464.5000; val_optim_loss: 45944464.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9405; val_auprc_score: 0.9121; val_best_acc_score: 0.8866; val_best_f1_score: 0.8942; train_kl_reg_loss: 101283.8688; train_edge_recon_loss: 2714726.6098; train_gene_expr_recon_loss: 12831881.0758; train_masked_gp_l1_reg_loss: 60888.9196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124645.2450; train_chrom_access_recon_loss: 29213553.0303; train_global_loss: 45046978.9091; train_optim_loss: 45046978.9091; val_kl_reg_loss: 91824.5615; val_edge_recon_loss: 2753837.3125; val_gene_expr_recon_loss: 13058388.2500; val_masked_gp_l1_reg_loss: 61033.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124429.9453; val_chrom_access_recon_loss: 30224202.2500; val_global_loss: 46313716.0000; val_optim_loss: 46313716.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9492; val_auprc_score: 0.9259; val_best_acc_score: 0.8984; val_best_f1_score: 0.9037; train_kl_reg_loss: 101526.1796; train_edge_recon_loss: 2719165.4394; train_gene_expr_recon_loss: 12806749.4697; train_masked_gp_l1_reg_loss: 61049.5649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123897.4073; train_chrom_access_recon_loss: 29150761.8182; train_global_loss: 44963149.7576; train_optim_loss: 44963149.7576; val_kl_reg_loss: 93389.8018; val_edge_recon_loss: 2747554.9688; val_gene_expr_recon_loss: 12993102.0000; val_masked_gp_l1_reg_loss: 61122.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123363.3672; val_chrom_access_recon_loss: 30275599.5000; val_global_loss: 46294132.5000; val_optim_loss: 46294132.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9475; val_auprc_score: 0.9247; val_best_acc_score: 0.8955; val_best_f1_score: 0.9005; train_kl_reg_loss: 99691.7926; train_edge_recon_loss: 2730293.4205; train_gene_expr_recon_loss: 12790025.8485; train_masked_gp_l1_reg_loss: 60852.8816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93739.6586; train_chrom_access_recon_loss: 29092774.7273; train_global_loss: 44867378.1212; train_optim_loss: 44867378.1212; val_kl_reg_loss: 94435.3359; val_edge_recon_loss: 2751178.5625; val_gene_expr_recon_loss: 13028093.2500; val_masked_gp_l1_reg_loss: 60738.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88791.3672; val_chrom_access_recon_loss: 30040193.2500; val_global_loss: 46063430.0000; val_optim_loss: 46063430.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9466; val_auprc_score: 0.9273; val_best_acc_score: 0.8917; val_best_f1_score: 0.8971; train_kl_reg_loss: 100633.3181; train_edge_recon_loss: 2715094.7841; train_gene_expr_recon_loss: 12802272.1515; train_masked_gp_l1_reg_loss: 60702.1499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88559.1683; train_chrom_access_recon_loss: 29115823.6364; train_global_loss: 44883085.1515; train_optim_loss: 44883085.1515; val_kl_reg_loss: 94315.0674; val_edge_recon_loss: 2769334.4062; val_gene_expr_recon_loss: 13012483.5000; val_masked_gp_l1_reg_loss: 60671.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88408.7578; val_chrom_access_recon_loss: 30089832.2500; val_global_loss: 46115045.5000; val_optim_loss: 46115045.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9470; val_auprc_score: 0.9264; val_best_acc_score: 0.8952; val_best_f1_score: 0.9006; train_kl_reg_loss: 101538.8602; train_edge_recon_loss: 2712920.0758; train_gene_expr_recon_loss: 12801151.9394; train_masked_gp_l1_reg_loss: 60655.0397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88199.4717; train_chrom_access_recon_loss: 29085221.9394; train_global_loss: 44849687.0909; train_optim_loss: 44849687.0909; val_kl_reg_loss: 95483.3975; val_edge_recon_loss: 2755484.5312; val_gene_expr_recon_loss: 12921265.1250; val_masked_gp_l1_reg_loss: 60641.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87980.6172; val_chrom_access_recon_loss: 29820407.5000; val_global_loss: 45741262.5000; val_optim_loss: 45741262.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9416; val_auprc_score: 0.9123; val_best_acc_score: 0.8966; val_best_f1_score: 0.9024; train_kl_reg_loss: 101543.9232; train_edge_recon_loss: 2717344.0871; train_gene_expr_recon_loss: 12790627.1364; train_masked_gp_l1_reg_loss: 60639.7319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87813.6581; train_chrom_access_recon_loss: 29066106.1818; train_global_loss: 44824074.7273; train_optim_loss: 44824074.7273; val_kl_reg_loss: 95477.1777; val_edge_recon_loss: 2764447.2188; val_gene_expr_recon_loss: 12921954.8750; val_masked_gp_l1_reg_loss: 60633.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87618.0391; val_chrom_access_recon_loss: 29889686.7500; val_global_loss: 45819817.5000; val_optim_loss: 45819817.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9561; val_auprc_score: 0.9420; val_best_acc_score: 0.8990; val_best_f1_score: 0.9047; train_kl_reg_loss: 101459.7615; train_edge_recon_loss: 2708089.4583; train_gene_expr_recon_loss: 12791773.7727; train_masked_gp_l1_reg_loss: 60628.2778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87448.1308; train_chrom_access_recon_loss: 29077595.5455; train_global_loss: 44826994.9091; train_optim_loss: 44826994.9091; val_kl_reg_loss: 95601.1641; val_edge_recon_loss: 2737211.6250; val_gene_expr_recon_loss: 13005024.0000; val_masked_gp_l1_reg_loss: 60626.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87406.8438; val_chrom_access_recon_loss: 30242966.0000; val_global_loss: 46228835.5000; val_optim_loss: 46228835.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9428; val_auprc_score: 0.9186; val_best_acc_score: 0.8885; val_best_f1_score: 0.8946; train_kl_reg_loss: 101681.6151; train_edge_recon_loss: 2710523.5038; train_gene_expr_recon_loss: 12799186.3485; train_masked_gp_l1_reg_loss: 60625.9130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87134.8590; train_chrom_access_recon_loss: 29079808.0303; train_global_loss: 44838960.2424; train_optim_loss: 44838960.2424; val_kl_reg_loss: 96238.9580; val_edge_recon_loss: 2774787.4062; val_gene_expr_recon_loss: 13075586.8750; val_masked_gp_l1_reg_loss: 60621.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87001.0703; val_chrom_access_recon_loss: 30317499.5000; val_global_loss: 46411735.5000; val_optim_loss: 46411735.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9426; val_auprc_score: 0.9213; val_best_acc_score: 0.8874; val_best_f1_score: 0.8949; train_kl_reg_loss: 101274.1044; train_edge_recon_loss: 2715684.7348; train_gene_expr_recon_loss: 12783896.6061; train_masked_gp_l1_reg_loss: 60624.8656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86844.8714; train_chrom_access_recon_loss: 29057633.9091; train_global_loss: 44805959.0909; train_optim_loss: 44805959.0909; val_kl_reg_loss: 95854.4707; val_edge_recon_loss: 2782422.3438; val_gene_expr_recon_loss: 12897007.6250; val_masked_gp_l1_reg_loss: 60624.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86724.2969; val_chrom_access_recon_loss: 29637705.7500; val_global_loss: 45560339.5000; val_optim_loss: 45560339.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9477; val_auprc_score: 0.9228; val_best_acc_score: 0.8963; val_best_f1_score: 0.9023; train_kl_reg_loss: 101453.7165; train_edge_recon_loss: 2710478.3333; train_gene_expr_recon_loss: 12771311.5606; train_masked_gp_l1_reg_loss: 60627.0116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86559.2501; train_chrom_access_recon_loss: 29035273.0606; train_global_loss: 44765702.7879; train_optim_loss: 44765702.7879; val_kl_reg_loss: 95908.1367; val_edge_recon_loss: 2737081.0938; val_gene_expr_recon_loss: 12928416.8750; val_masked_gp_l1_reg_loss: 60622.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86408.5547; val_chrom_access_recon_loss: 29769143.5000; val_global_loss: 45677582.0000; val_optim_loss: 45677582.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9431; val_auprc_score: 0.9160; val_best_acc_score: 0.8987; val_best_f1_score: 0.9039; train_kl_reg_loss: 101050.4566; train_edge_recon_loss: 2714635.5303; train_gene_expr_recon_loss: 12781890.5606; train_masked_gp_l1_reg_loss: 60629.2944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86272.6882; train_chrom_access_recon_loss: 29069043.7576; train_global_loss: 44813522.2424; train_optim_loss: 44813522.2424; val_kl_reg_loss: 95314.0840; val_edge_recon_loss: 2739333.7500; val_gene_expr_recon_loss: 12846069.3750; val_masked_gp_l1_reg_loss: 60627.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86198.2656; val_chrom_access_recon_loss: 29777766.0000; val_global_loss: 45605308.5000; val_optim_loss: 45605308.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9532; val_auprc_score: 0.9324; val_best_acc_score: 0.9025; val_best_f1_score: 0.9073; train_kl_reg_loss: 100882.9512; train_edge_recon_loss: 2711455.1742; train_gene_expr_recon_loss: 12789212.6667; train_masked_gp_l1_reg_loss: 60632.3159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85919.5902; train_chrom_access_recon_loss: 29077080.6061; train_global_loss: 44825183.4545; train_optim_loss: 44825183.4545; val_kl_reg_loss: 96269.9287; val_edge_recon_loss: 2742886.4375; val_gene_expr_recon_loss: 12906616.5000; val_masked_gp_l1_reg_loss: 60633.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85784.4844; val_chrom_access_recon_loss: 29643899.2500; val_global_loss: 45536090.5000; val_optim_loss: 45536090.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9469; val_auprc_score: 0.9227; val_best_acc_score: 0.8966; val_best_f1_score: 0.9013; train_kl_reg_loss: 100441.8254; train_edge_recon_loss: 2708798.9924; train_gene_expr_recon_loss: 12774195.9242; train_masked_gp_l1_reg_loss: 60638.3243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85609.1024; train_chrom_access_recon_loss: 29030749.1818; train_global_loss: 44760433.2727; train_optim_loss: 44760433.2727; val_kl_reg_loss: 96056.8311; val_edge_recon_loss: 2753669.2812; val_gene_expr_recon_loss: 13011425.5000; val_masked_gp_l1_reg_loss: 60641.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85441.0859; val_chrom_access_recon_loss: 30103580.0000; val_global_loss: 46110815.0000; val_optim_loss: 46110815.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9463; val_auprc_score: 0.9275; val_best_acc_score: 0.8936; val_best_f1_score: 0.8997; train_kl_reg_loss: 100383.6374; train_edge_recon_loss: 2709678.3106; train_gene_expr_recon_loss: 12771859.9545; train_masked_gp_l1_reg_loss: 60649.1445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85450.8783; train_chrom_access_recon_loss: 29038578.0000; train_global_loss: 44766600.0000; train_optim_loss: 44766600.0000; val_kl_reg_loss: 95792.6768; val_edge_recon_loss: 2773288.1562; val_gene_expr_recon_loss: 12902874.8750; val_masked_gp_l1_reg_loss: 60649.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85317.3359; val_chrom_access_recon_loss: 29676114.7500; val_global_loss: 45594037.5000; val_optim_loss: 45594037.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9489; val_auprc_score: 0.9281; val_best_acc_score: 0.8984; val_best_f1_score: 0.9038; train_kl_reg_loss: 100933.4683; train_edge_recon_loss: 2716992.6894; train_gene_expr_recon_loss: 12780333.7727; train_masked_gp_l1_reg_loss: 60651.6027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85119.4349; train_chrom_access_recon_loss: 29023212.6061; train_global_loss: 44767243.5758; train_optim_loss: 44767243.5758; val_kl_reg_loss: 96324.6816; val_edge_recon_loss: 2758473.5938; val_gene_expr_recon_loss: 12838668.5000; val_masked_gp_l1_reg_loss: 60648.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84984.5391; val_chrom_access_recon_loss: 29761026.0000; val_global_loss: 45600126.0000; val_optim_loss: 45600126.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9545; val_auprc_score: 0.9350; val_best_acc_score: 0.9038; val_best_f1_score: 0.9081; train_kl_reg_loss: 100256.5477; train_edge_recon_loss: 2716023.8485; train_gene_expr_recon_loss: 12765126.6818; train_masked_gp_l1_reg_loss: 60663.4356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84945.7912; train_chrom_access_recon_loss: 29042809.1818; train_global_loss: 44769825.4545; train_optim_loss: 44769825.4545; val_kl_reg_loss: 96152.0479; val_edge_recon_loss: 2725494.5938; val_gene_expr_recon_loss: 12893388.8750; val_masked_gp_l1_reg_loss: 60663.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84913.6172; val_chrom_access_recon_loss: 29783467.5000; val_global_loss: 45644080.0000; val_optim_loss: 45644080.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9516; val_auprc_score: 0.9254; val_best_acc_score: 0.8979; val_best_f1_score: 0.9035; train_kl_reg_loss: 100186.4859; train_edge_recon_loss: 2717226.2841; train_gene_expr_recon_loss: 12769938.4091; train_masked_gp_l1_reg_loss: 60633.1837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81506.0125; train_chrom_access_recon_loss: 29042668.9091; train_global_loss: 44772159.2727; train_optim_loss: 44772159.2727; val_kl_reg_loss: 96675.1084; val_edge_recon_loss: 2754847.5000; val_gene_expr_recon_loss: 13027572.3750; val_masked_gp_l1_reg_loss: 60619.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80913.4297; val_chrom_access_recon_loss: 29856071.0000; val_global_loss: 45876698.0000; val_optim_loss: 45876698.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9479; val_auprc_score: 0.9259; val_best_acc_score: 0.8952; val_best_f1_score: 0.9009; train_kl_reg_loss: 100174.7784; train_edge_recon_loss: 2706411.1856; train_gene_expr_recon_loss: 12766156.0152; train_masked_gp_l1_reg_loss: 60614.3348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80891.1742; train_chrom_access_recon_loss: 29025367.2727; train_global_loss: 44739614.8485; train_optim_loss: 44739614.8485; val_kl_reg_loss: 95967.0537; val_edge_recon_loss: 2770468.3125; val_gene_expr_recon_loss: 12931142.5000; val_masked_gp_l1_reg_loss: 60609.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80874.1016; val_chrom_access_recon_loss: 29635122.7500; val_global_loss: 45574183.5000; val_optim_loss: 45574183.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9457; val_auprc_score: 0.9212; val_best_acc_score: 0.8928; val_best_f1_score: 0.8983; train_kl_reg_loss: 100198.4386; train_edge_recon_loss: 2713652.6705; train_gene_expr_recon_loss: 12769893.0455; train_masked_gp_l1_reg_loss: 60605.0872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80848.5206; train_chrom_access_recon_loss: 29029669.4242; train_global_loss: 44754867.0909; train_optim_loss: 44754867.0909; val_kl_reg_loss: 96882.1953; val_edge_recon_loss: 2775362.1562; val_gene_expr_recon_loss: 12896439.8750; val_masked_gp_l1_reg_loss: 60601.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80826.5078; val_chrom_access_recon_loss: 29687705.0000; val_global_loss: 45597817.5000; val_optim_loss: 45597817.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9466; val_auprc_score: 0.9180; val_best_acc_score: 0.9003; val_best_f1_score: 0.9048; train_kl_reg_loss: 100307.6576; train_edge_recon_loss: 2703593.8636; train_gene_expr_recon_loss: 12770246.4394; train_masked_gp_l1_reg_loss: 60600.9931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80824.1851; train_chrom_access_recon_loss: 29035626.9091; train_global_loss: 44751200.0606; train_optim_loss: 44751200.0606; val_kl_reg_loss: 96610.5479; val_edge_recon_loss: 2740965.6875; val_gene_expr_recon_loss: 12923703.1250; val_masked_gp_l1_reg_loss: 60598.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80805.4609; val_chrom_access_recon_loss: 29662216.2500; val_global_loss: 45564898.5000; val_optim_loss: 45564898.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 76 min 27 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9473
val AUPRC score: 0.9235
val best accuracy score: 0.8979
val best F1 score: 0.9040
val target rna MSE score: 1.0680
val source rna MSE score: 0.4457
val target atac MSE score: 0.1303
val source atac MSE score: 0.0289
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
