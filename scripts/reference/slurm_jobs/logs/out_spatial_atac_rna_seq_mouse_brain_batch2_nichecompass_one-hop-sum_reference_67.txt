[True]
Run timestamp: 10082023_215800_67.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_67']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7762; val_auprc_score: 0.7984; val_best_acc_score: 0.5434; val_best_f1_score: 0.6815; train_kl_reg_loss: 278354.8064; train_edge_recon_loss: 3907826.9447; train_gene_expr_recon_loss: 47540634.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25769034.4427; train_global_loss: 77495850.4122; train_optim_loss: 77495850.4122; val_kl_reg_loss: 191590.6635; val_edge_recon_loss: 4062225.9500; val_gene_expr_recon_loss: 38810050.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23311279.8667; val_global_loss: 66375146.9333; val_optim_loss: 66375146.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8225; val_auprc_score: 0.8351; val_best_acc_score: 0.7374; val_best_f1_score: 0.7379; train_kl_reg_loss: 256359.1891; train_edge_recon_loss: 3728104.1927; train_gene_expr_recon_loss: 38167519.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 23219086.1679; train_global_loss: 65371069.7099; train_optim_loss: 65371069.7099; val_kl_reg_loss: 247616.8740; val_edge_recon_loss: 4034986.5000; val_gene_expr_recon_loss: 37360094.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23001802.2667; val_global_loss: 64644499.7333; val_optim_loss: 64644499.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8963; val_auprc_score: 0.8918; val_best_acc_score: 0.8054; val_best_f1_score: 0.8190; train_kl_reg_loss: 229481.6749; train_edge_recon_loss: 3579545.3702; train_gene_expr_recon_loss: 37093082.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22962260.6870; train_global_loss: 63864370.1679; train_optim_loss: 63864370.1679; val_kl_reg_loss: 201846.4802; val_edge_recon_loss: 3767407.3667; val_gene_expr_recon_loss: 36779567.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22808390.5333; val_global_loss: 63557211.4667; val_optim_loss: 63557211.4667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8979; val_auprc_score: 0.8894; val_best_acc_score: 0.8068; val_best_f1_score: 0.8213; train_kl_reg_loss: 223372.3354; train_edge_recon_loss: 3212595.6489; train_gene_expr_recon_loss: 36734384.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22819171.1908; train_global_loss: 62989523.3282; train_optim_loss: 62989523.3282; val_kl_reg_loss: 243208.7302; val_edge_recon_loss: 3068764.0333; val_gene_expr_recon_loss: 36497533.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22618643.4667; val_global_loss: 62428149.6000; val_optim_loss: 62428149.6000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9162; val_auprc_score: 0.9066; val_best_acc_score: 0.8358; val_best_f1_score: 0.8444; train_kl_reg_loss: 233570.1972; train_edge_recon_loss: 3021442.0668; train_gene_expr_recon_loss: 36474384.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22710302.4733; train_global_loss: 62439699.3282; train_optim_loss: 62439699.3282; val_kl_reg_loss: 230771.9719; val_edge_recon_loss: 2969973.4167; val_gene_expr_recon_loss: 36321147.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22611910.4000; val_global_loss: 62133803.2000; val_optim_loss: 62133803.2000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9253; val_auprc_score: 0.9138; val_best_acc_score: 0.8542; val_best_f1_score: 0.8603; train_kl_reg_loss: 219840.5081; train_edge_recon_loss: 2969270.1679; train_gene_expr_recon_loss: 36203631.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22572219.7099; train_global_loss: 61964962.1679; train_optim_loss: 61964962.1679; val_kl_reg_loss: 223233.4312; val_edge_recon_loss: 2964271.1833; val_gene_expr_recon_loss: 36195166.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22544291.2000; val_global_loss: 61926963.2000; val_optim_loss: 61926963.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9385; val_auprc_score: 0.9289; val_best_acc_score: 0.8666; val_best_f1_score: 0.8734; train_kl_reg_loss: 210813.6380; train_edge_recon_loss: 2919405.6870; train_gene_expr_recon_loss: 36056437.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22486571.6489; train_global_loss: 61673228.8855; train_optim_loss: 61673228.8855; val_kl_reg_loss: 201938.0198; val_edge_recon_loss: 2923418.9833; val_gene_expr_recon_loss: 35906996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22346434.9333; val_global_loss: 61378788.2667; val_optim_loss: 61378788.2667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9472; val_auprc_score: 0.9373; val_best_acc_score: 0.8809; val_best_f1_score: 0.8869; train_kl_reg_loss: 200313.6745; train_edge_recon_loss: 2900426.8683; train_gene_expr_recon_loss: 35854108.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22386370.5802; train_global_loss: 61341219.6947; train_optim_loss: 61341219.6947; val_kl_reg_loss: 196639.8094; val_edge_recon_loss: 2891648.5667; val_gene_expr_recon_loss: 35686000.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22178188.6667; val_global_loss: 60952476.8000; val_optim_loss: 60952476.8000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9484; val_auprc_score: 0.9359; val_best_acc_score: 0.8859; val_best_f1_score: 0.8911; train_kl_reg_loss: 190747.1893; train_edge_recon_loss: 2872734.3855; train_gene_expr_recon_loss: 35746503.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22276103.3130; train_global_loss: 61086088.3969; train_optim_loss: 61086088.3969; val_kl_reg_loss: 194966.2698; val_edge_recon_loss: 2862084.7000; val_gene_expr_recon_loss: 35574101.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22173798.5333; val_global_loss: 60804950.9333; val_optim_loss: 60804950.9333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9536; val_auprc_score: 0.9460; val_best_acc_score: 0.8891; val_best_f1_score: 0.8946; train_kl_reg_loss: 185793.8891; train_edge_recon_loss: 2855627.5286; train_gene_expr_recon_loss: 35593272.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22220466.6260; train_global_loss: 60855160.3969; train_optim_loss: 60855160.3969; val_kl_reg_loss: 190162.9344; val_edge_recon_loss: 2849168.2667; val_gene_expr_recon_loss: 35434766.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22153331.2000; val_global_loss: 60627428.2667; val_optim_loss: 60627428.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9546; val_auprc_score: 0.9458; val_best_acc_score: 0.8884; val_best_f1_score: 0.8938; train_kl_reg_loss: 362618.4641; train_edge_recon_loss: 2839454.7328; train_gene_expr_recon_loss: 35510059.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22101646.6107; train_global_loss: 60813779.6641; train_optim_loss: 60813779.6641; val_kl_reg_loss: 181045.5854; val_edge_recon_loss: 2851601.2667; val_gene_expr_recon_loss: 35359037.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22104546.6667; val_global_loss: 60496230.1333; val_optim_loss: 60496230.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9527; val_auprc_score: 0.9404; val_best_acc_score: 0.8945; val_best_f1_score: 0.9005; train_kl_reg_loss: 176684.8031; train_edge_recon_loss: 2818434.5954; train_gene_expr_recon_loss: 35258394.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22010442.7634; train_global_loss: 60263957.4656; train_optim_loss: 60263957.4656; val_kl_reg_loss: 172008.8375; val_edge_recon_loss: 2832445.7667; val_gene_expr_recon_loss: 35240049.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22003015.3333; val_global_loss: 60247519.7333; val_optim_loss: 60247519.7333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9568; val_auprc_score: 0.9475; val_best_acc_score: 0.9011; val_best_f1_score: 0.9051; train_kl_reg_loss: 174470.7582; train_edge_recon_loss: 2816662.7977; train_gene_expr_recon_loss: 35121541.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21939776.4122; train_global_loss: 60052451.1756; train_optim_loss: 60052451.1756; val_kl_reg_loss: 170197.6365; val_edge_recon_loss: 2839537.2167; val_gene_expr_recon_loss: 35245832.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21997844.4000; val_global_loss: 60253412.2667; val_optim_loss: 60253412.2667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9602; val_auprc_score: 0.9503; val_best_acc_score: 0.9030; val_best_f1_score: 0.9068; train_kl_reg_loss: 182393.9485; train_edge_recon_loss: 2800533.1298; train_gene_expr_recon_loss: 35174168.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21896882.7328; train_global_loss: 60053978.2290; train_optim_loss: 60053978.2290; val_kl_reg_loss: 162835.7646; val_edge_recon_loss: 2810007.0333; val_gene_expr_recon_loss: 35073195.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21806630.4000; val_global_loss: 59852668.8000; val_optim_loss: 59852668.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9560; val_auprc_score: 0.9454; val_best_acc_score: 0.8940; val_best_f1_score: 0.9007; train_kl_reg_loss: 159212.7544; train_edge_recon_loss: 2793377.6069; train_gene_expr_recon_loss: 34941149.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21810190.7786; train_global_loss: 59703930.8092; train_optim_loss: 59703930.8092; val_kl_reg_loss: 161442.4906; val_edge_recon_loss: 2808759.1667; val_gene_expr_recon_loss: 34874949.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21734007.2000; val_global_loss: 59579158.4000; val_optim_loss: 59579158.4000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9614; val_auprc_score: 0.9529; val_best_acc_score: 0.9061; val_best_f1_score: 0.9103; train_kl_reg_loss: 157070.2012; train_edge_recon_loss: 2783607.8225; train_gene_expr_recon_loss: 34809684.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21732977.3740; train_global_loss: 59483340.1527; train_optim_loss: 59483340.1527; val_kl_reg_loss: 156494.6927; val_edge_recon_loss: 2788420.3333; val_gene_expr_recon_loss: 34904511.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21796728.5333; val_global_loss: 59646155.2000; val_optim_loss: 59646155.2000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9620; val_auprc_score: 0.9524; val_best_acc_score: 0.9062; val_best_f1_score: 0.9107; train_kl_reg_loss: 150995.4792; train_edge_recon_loss: 2780053.1164; train_gene_expr_recon_loss: 34781991.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21713932.7481; train_global_loss: 59426972.5802; train_optim_loss: 59426972.5802; val_kl_reg_loss: 148327.2938; val_edge_recon_loss: 2788179.7500; val_gene_expr_recon_loss: 34647911.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21624026.5333; val_global_loss: 59208445.0667; val_optim_loss: 59208445.0667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9635; val_auprc_score: 0.9560; val_best_acc_score: 0.9070; val_best_f1_score: 0.9115; train_kl_reg_loss: 150000.6932; train_edge_recon_loss: 2774446.3931; train_gene_expr_recon_loss: 34693529.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21672617.8168; train_global_loss: 59290594.4733; train_optim_loss: 59290594.4733; val_kl_reg_loss: 148666.8813; val_edge_recon_loss: 2791161.7833; val_gene_expr_recon_loss: 34657573.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21573399.2000; val_global_loss: 59170801.0667; val_optim_loss: 59170801.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9667; val_auprc_score: 0.9562; val_best_acc_score: 0.9143; val_best_f1_score: 0.9173; train_kl_reg_loss: 146948.8516; train_edge_recon_loss: 2767074.4790; train_gene_expr_recon_loss: 34608516.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21630726.3664; train_global_loss: 59153266.4122; train_optim_loss: 59153266.4122; val_kl_reg_loss: 150082.1260; val_edge_recon_loss: 2775945.0500; val_gene_expr_recon_loss: 34823070.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21627245.4667; val_global_loss: 59376343.4667; val_optim_loss: 59376343.4667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9657; val_auprc_score: 0.9573; val_best_acc_score: 0.9111; val_best_f1_score: 0.9144; train_kl_reg_loss: 142936.3656; train_edge_recon_loss: 2762507.5324; train_gene_expr_recon_loss: 34571886.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21600483.0382; train_global_loss: 59077813.7099; train_optim_loss: 59077813.7099; val_kl_reg_loss: 140951.6885; val_edge_recon_loss: 2774385.0333; val_gene_expr_recon_loss: 34520430.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21495261.0667; val_global_loss: 58931028.0000; val_optim_loss: 58931028.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9655; val_auprc_score: 0.9580; val_best_acc_score: 0.9097; val_best_f1_score: 0.9137; train_kl_reg_loss: 139292.8131; train_edge_recon_loss: 2761994.8950; train_gene_expr_recon_loss: 34444517.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21527069.5725; train_global_loss: 58872874.4733; train_optim_loss: 58872874.4733; val_kl_reg_loss: 140039.4344; val_edge_recon_loss: 2764256.1667; val_gene_expr_recon_loss: 34521584.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21557946.8000; val_global_loss: 58983828.0000; val_optim_loss: 58983828.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9712; val_auprc_score: 0.9634; val_best_acc_score: 0.9204; val_best_f1_score: 0.9232; train_kl_reg_loss: 136166.6616; train_edge_recon_loss: 2753683.2443; train_gene_expr_recon_loss: 34358355.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21493522.2290; train_global_loss: 58741727.3282; train_optim_loss: 58741727.3282; val_kl_reg_loss: 135593.2807; val_edge_recon_loss: 2749023.8833; val_gene_expr_recon_loss: 34497424.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21451363.2000; val_global_loss: 58833405.3333; val_optim_loss: 58833405.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9660; val_auprc_score: 0.9585; val_best_acc_score: 0.9113; val_best_f1_score: 0.9163; train_kl_reg_loss: 134436.5216; train_edge_recon_loss: 2757392.3798; train_gene_expr_recon_loss: 34447937.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21506661.9237; train_global_loss: 58846427.8779; train_optim_loss: 58846427.8779; val_kl_reg_loss: 135692.4406; val_edge_recon_loss: 2782585.5833; val_gene_expr_recon_loss: 34484511.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21527684.0000; val_global_loss: 58930473.0667; val_optim_loss: 58930473.0667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9742; val_auprc_score: 0.9698; val_best_acc_score: 0.9220; val_best_f1_score: 0.9247; train_kl_reg_loss: 134216.2760; train_edge_recon_loss: 2745526.9141; train_gene_expr_recon_loss: 34336750.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21501586.0763; train_global_loss: 58718079.6336; train_optim_loss: 58718079.6336; val_kl_reg_loss: 131624.3943; val_edge_recon_loss: 2732678.1333; val_gene_expr_recon_loss: 34452591.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21551312.6667; val_global_loss: 58868207.4667; val_optim_loss: 58868207.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9663; val_auprc_score: 0.9611; val_best_acc_score: 0.9099; val_best_f1_score: 0.9143; train_kl_reg_loss: 156241.9625; train_edge_recon_loss: 2767812.7137; train_gene_expr_recon_loss: 35078623.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 21512026.1832; train_global_loss: 59514704.4580; train_optim_loss: 59514704.4580; val_kl_reg_loss: 163486.8292; val_edge_recon_loss: 2856069.4167; val_gene_expr_recon_loss: 35695854.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 21645412.9333; val_global_loss: 60360823.2000; val_optim_loss: 60360823.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9518; val_auprc_score: 0.9433; val_best_acc_score: 0.8905; val_best_f1_score: 0.8954; train_kl_reg_loss: 210657.3749; train_edge_recon_loss: 2965376.9924; train_gene_expr_recon_loss: 39080604.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22196931.0229; train_global_loss: 64453570.0458; train_optim_loss: 64453570.0458; val_kl_reg_loss: 49885.2714; val_edge_recon_loss: 2960718.5333; val_gene_expr_recon_loss: 38415822.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22016950.8000; val_global_loss: 63443376.8000; val_optim_loss: 63443376.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9536; val_auprc_score: 0.9455; val_best_acc_score: 0.8965; val_best_f1_score: 0.9020; train_kl_reg_loss: 433077119378.8620; train_edge_recon_loss: 2934241.2710; train_gene_expr_recon_loss: 39058327.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22158479.4198; train_global_loss: 433141262563.5725; train_optim_loss: 433141262563.5725; val_kl_reg_loss: 46126.5482; val_edge_recon_loss: 2917158.4500; val_gene_expr_recon_loss: 39626820.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22298030.6667; val_global_loss: 64888136.0000; val_optim_loss: 64888136.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9563; val_auprc_score: 0.9474; val_best_acc_score: 0.8984; val_best_f1_score: 0.9024; train_kl_reg_loss: 174589.6492; train_edge_recon_loss: 2912426.9771; train_gene_expr_recon_loss: 39422359.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22179295.6641; train_global_loss: 64688671.8473; train_optim_loss: 64688671.8473; val_kl_reg_loss: 46998.8352; val_edge_recon_loss: 2906769.0667; val_gene_expr_recon_loss: 39240275.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22069130.5333; val_global_loss: 64263174.4000; val_optim_loss: 64263174.4000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9548; val_auprc_score: 0.9466; val_best_acc_score: 0.8936; val_best_f1_score: 0.8975; train_kl_reg_loss: 171528.0229; train_edge_recon_loss: 2889369.9790; train_gene_expr_recon_loss: 39370952.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22182744.3359; train_global_loss: 64614595.1756; train_optim_loss: 64614595.1756; val_kl_reg_loss: 48265.2320; val_edge_recon_loss: 2884869.1000; val_gene_expr_recon_loss: 39453348.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22099419.7333; val_global_loss: 64485903.7333; val_optim_loss: 64485903.7333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9542; val_auprc_score: 0.9447; val_best_acc_score: 0.8979; val_best_f1_score: 0.9026; train_kl_reg_loss: 167734.0463; train_edge_recon_loss: 2867363.7118; train_gene_expr_recon_loss: 39412362.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 22175291.0076; train_global_loss: 64622751.7252; train_optim_loss: 64622751.7252; val_kl_reg_loss: 49807.2422; val_edge_recon_loss: 2858276.8167; val_gene_expr_recon_loss: 39356133.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 22071872.2667; val_global_loss: 64336090.1333; val_optim_loss: 64336090.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 45 min 35 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9737
val AUPRC score: 0.9682
val best accuracy score: 0.9219
val best F1 score: 0.9250
val target rna MSE score: 1.3306
val source rna MSE score: 32.1074
val target atac MSE score: 0.1302
val source atac MSE score: 1.0262
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
