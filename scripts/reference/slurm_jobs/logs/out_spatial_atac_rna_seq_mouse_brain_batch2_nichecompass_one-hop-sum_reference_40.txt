[True]
Run timestamp: 10082023_183243_40.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_40']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7628; val_auprc_score: 0.7854; val_best_acc_score: 0.5601; val_best_f1_score: 0.6900; train_kl_reg_loss: 163470.7895; train_edge_recon_loss: 3919855.5534; train_gene_expr_recon_loss: 27965790.6107; train_masked_gp_l1_reg_loss: 78306.2483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 242757.3990; train_chrom_access_recon_loss: 124257420.8244; train_global_loss: 156627601.9542; train_optim_loss: 156627601.9542; val_kl_reg_loss: 179905.4833; val_edge_recon_loss: 4061752.2333; val_gene_expr_recon_loss: 23487297.3333; val_masked_gp_l1_reg_loss: 77484.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 237372.3594; val_chrom_access_recon_loss: 116561588.8000; val_global_loss: 144605401.6000; val_optim_loss: 144605401.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8246; val_auprc_score: 0.8322; val_best_acc_score: 0.7230; val_best_f1_score: 0.7426; train_kl_reg_loss: 235303.6032; train_edge_recon_loss: 3638588.5725; train_gene_expr_recon_loss: 22813770.0000; train_masked_gp_l1_reg_loss: 73035.1323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 229034.8155; train_chrom_access_recon_loss: 115706367.3282; train_global_loss: 142696099.1145; train_optim_loss: 142696099.1145; val_kl_reg_loss: 244562.8729; val_edge_recon_loss: 4000617.4500; val_gene_expr_recon_loss: 22170557.6000; val_masked_gp_l1_reg_loss: 70531.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 219417.3125; val_chrom_access_recon_loss: 114384923.7333; val_global_loss: 141090611.2000; val_optim_loss: 141090611.2000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8648; val_auprc_score: 0.8635; val_best_acc_score: 0.7660; val_best_f1_score: 0.7839; train_kl_reg_loss: 208623.6007; train_edge_recon_loss: 3443004.7004; train_gene_expr_recon_loss: 22277414.9924; train_masked_gp_l1_reg_loss: 71194.6937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209267.8447; train_chrom_access_recon_loss: 114614332.8855; train_global_loss: 140823838.7786; train_optim_loss: 140823838.7786; val_kl_reg_loss: 231871.2906; val_edge_recon_loss: 3221843.8500; val_gene_expr_recon_loss: 21966848.6667; val_masked_gp_l1_reg_loss: 72149.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199010.8125; val_chrom_access_recon_loss: 113580193.0667; val_global_loss: 139271916.2667; val_optim_loss: 139271916.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8852; val_auprc_score: 0.8730; val_best_acc_score: 0.8030; val_best_f1_score: 0.8214; train_kl_reg_loss: 239727.6528; train_edge_recon_loss: 3105675.3511; train_gene_expr_recon_loss: 22053037.6794; train_masked_gp_l1_reg_loss: 73077.6248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 189405.2691; train_chrom_access_recon_loss: 113752845.7405; train_global_loss: 139413768.5496; train_optim_loss: 139413768.5496; val_kl_reg_loss: 227487.7958; val_edge_recon_loss: 3078063.7333; val_gene_expr_recon_loss: 21771332.0000; val_masked_gp_l1_reg_loss: 74074.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 180166.7188; val_chrom_access_recon_loss: 113479499.7333; val_global_loss: 138810622.4000; val_optim_loss: 138810622.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8958; val_auprc_score: 0.8824; val_best_acc_score: 0.8146; val_best_f1_score: 0.8288; train_kl_reg_loss: 229741.4065; train_edge_recon_loss: 3040130.4809; train_gene_expr_recon_loss: 21925194.6260; train_masked_gp_l1_reg_loss: 74948.6719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171957.3504; train_chrom_access_recon_loss: 113082165.8626; train_global_loss: 138524138.7481; train_optim_loss: 138524138.7481; val_kl_reg_loss: 220467.6240; val_edge_recon_loss: 3037995.2667; val_gene_expr_recon_loss: 21600439.2000; val_masked_gp_l1_reg_loss: 75862.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164084.5469; val_chrom_access_recon_loss: 112120930.6667; val_global_loss: 137219778.1333; val_optim_loss: 137219778.1333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9153; val_auprc_score: 0.9018; val_best_acc_score: 0.8358; val_best_f1_score: 0.8472; train_kl_reg_loss: 209515.7375; train_edge_recon_loss: 3004890.3435; train_gene_expr_recon_loss: 21873396.2901; train_masked_gp_l1_reg_loss: 77285.6150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157020.4661; train_chrom_access_recon_loss: 112511400.3664; train_global_loss: 137833508.6412; train_optim_loss: 137833508.6412; val_kl_reg_loss: 210671.4365; val_edge_recon_loss: 2953075.2333; val_gene_expr_recon_loss: 21576781.2000; val_masked_gp_l1_reg_loss: 78124.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150116.8750; val_chrom_access_recon_loss: 111378577.0667; val_global_loss: 136347342.9333; val_optim_loss: 136347342.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9203; val_auprc_score: 0.9049; val_best_acc_score: 0.8477; val_best_f1_score: 0.8587; train_kl_reg_loss: 211178.3769; train_edge_recon_loss: 2963135.0725; train_gene_expr_recon_loss: 21733864.8855; train_masked_gp_l1_reg_loss: 78669.9221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143911.9651; train_chrom_access_recon_loss: 111952744.0611; train_global_loss: 137083504.1832; train_optim_loss: 137083504.1832; val_kl_reg_loss: 202372.3750; val_edge_recon_loss: 2941986.3333; val_gene_expr_recon_loss: 21435859.2000; val_masked_gp_l1_reg_loss: 79465.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137940.9375; val_chrom_access_recon_loss: 111534398.4000; val_global_loss: 136332021.8667; val_optim_loss: 136332021.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9313; val_auprc_score: 0.9190; val_best_acc_score: 0.8565; val_best_f1_score: 0.8687; train_kl_reg_loss: 204564.8359; train_edge_recon_loss: 2912618.7786; train_gene_expr_recon_loss: 21524381.4809; train_masked_gp_l1_reg_loss: 80394.5623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132757.2409; train_chrom_access_recon_loss: 111451319.9389; train_global_loss: 136306036.4580; train_optim_loss: 136306036.4580; val_kl_reg_loss: 202866.5708; val_edge_recon_loss: 2919576.8000; val_gene_expr_recon_loss: 21271689.2000; val_masked_gp_l1_reg_loss: 81302.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127618.0781; val_chrom_access_recon_loss: 110491145.0667; val_global_loss: 135094198.9333; val_optim_loss: 135094198.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9359; val_auprc_score: 0.9237; val_best_acc_score: 0.8646; val_best_f1_score: 0.8740; train_kl_reg_loss: 202087.8446; train_edge_recon_loss: 2890889.9981; train_gene_expr_recon_loss: 21406514.8092; train_masked_gp_l1_reg_loss: 82079.9130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123061.1229; train_chrom_access_recon_loss: 110802715.0534; train_global_loss: 135507348.7634; train_optim_loss: 135507348.7634; val_kl_reg_loss: 202737.6260; val_edge_recon_loss: 2900795.2167; val_gene_expr_recon_loss: 21139904.9333; val_masked_gp_l1_reg_loss: 82903.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118749.5391; val_chrom_access_recon_loss: 109914637.8667; val_global_loss: 134359730.1333; val_optim_loss: 134359730.1333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9441; val_auprc_score: 0.9344; val_best_acc_score: 0.8762; val_best_f1_score: 0.8843; train_kl_reg_loss: 197311.7103; train_edge_recon_loss: 2867544.0630; train_gene_expr_recon_loss: 21344952.8244; train_masked_gp_l1_reg_loss: 83795.9370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114779.9422; train_chrom_access_recon_loss: 110474689.7710; train_global_loss: 135083073.5267; train_optim_loss: 135083073.5267; val_kl_reg_loss: 195570.2917; val_edge_recon_loss: 2864235.2500; val_gene_expr_recon_loss: 21171305.3333; val_masked_gp_l1_reg_loss: 84679.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110890.9062; val_chrom_access_recon_loss: 110576421.3333; val_global_loss: 135003101.8667; val_optim_loss: 135003101.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9478; val_auprc_score: 0.9382; val_best_acc_score: 0.8782; val_best_f1_score: 0.8858; train_kl_reg_loss: 191980.9331; train_edge_recon_loss: 2859348.4084; train_gene_expr_recon_loss: 21252439.6947; train_masked_gp_l1_reg_loss: 85385.1372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107300.1400; train_chrom_access_recon_loss: 109921134.4122; train_global_loss: 134417587.9695; train_optim_loss: 134417587.9695; val_kl_reg_loss: 190990.2062; val_edge_recon_loss: 2875577.9500; val_gene_expr_recon_loss: 20937013.3333; val_masked_gp_l1_reg_loss: 86322.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104071.3047; val_chrom_access_recon_loss: 108922057.6000; val_global_loss: 133116032.5333; val_optim_loss: 133116032.5333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9480; val_auprc_score: 0.9377; val_best_acc_score: 0.8820; val_best_f1_score: 0.8890; train_kl_reg_loss: 186603.7327; train_edge_recon_loss: 2842065.5134; train_gene_expr_recon_loss: 21216600.0611; train_masked_gp_l1_reg_loss: 87001.0407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100945.8505; train_chrom_access_recon_loss: 109792985.2824; train_global_loss: 134226201.5878; train_optim_loss: 134226201.5878; val_kl_reg_loss: 189458.4042; val_edge_recon_loss: 2839814.2167; val_gene_expr_recon_loss: 21061544.8000; val_masked_gp_l1_reg_loss: 87760.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97939.8906; val_chrom_access_recon_loss: 110006982.9333; val_global_loss: 134283498.6667; val_optim_loss: 134283498.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9520; val_auprc_score: 0.9386; val_best_acc_score: 0.8857; val_best_f1_score: 0.8923; train_kl_reg_loss: 183486.7049; train_edge_recon_loss: 2828319.7786; train_gene_expr_recon_loss: 21168068.9924; train_masked_gp_l1_reg_loss: 88465.3507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95398.5915; train_chrom_access_recon_loss: 109553419.2977; train_global_loss: 133917158.4122; train_optim_loss: 133917158.4122; val_kl_reg_loss: 181324.9656; val_edge_recon_loss: 2832191.5000; val_gene_expr_recon_loss: 20928206.9333; val_masked_gp_l1_reg_loss: 89340.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92974.9609; val_chrom_access_recon_loss: 108876755.2000; val_global_loss: 133000792.5333; val_optim_loss: 133000792.5333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9543; val_auprc_score: 0.9426; val_best_acc_score: 0.8918; val_best_f1_score: 0.8971; train_kl_reg_loss: 179326.3303; train_edge_recon_loss: 2827962.5630; train_gene_expr_recon_loss: 21068613.1450; train_masked_gp_l1_reg_loss: 90080.6610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90696.4166; train_chrom_access_recon_loss: 108861829.8015; train_global_loss: 133118508.9466; train_optim_loss: 133118508.9466; val_kl_reg_loss: 177446.3302; val_edge_recon_loss: 2841748.3833; val_gene_expr_recon_loss: 20904873.0667; val_masked_gp_l1_reg_loss: 90819.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88816.6406; val_chrom_access_recon_loss: 108797919.4667; val_global_loss: 132901621.8667; val_optim_loss: 132901621.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9572; val_auprc_score: 0.9462; val_best_acc_score: 0.8956; val_best_f1_score: 0.9003; train_kl_reg_loss: 175637.9027; train_edge_recon_loss: 2809823.3340; train_gene_expr_recon_loss: 21036181.8321; train_masked_gp_l1_reg_loss: 91552.7827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86863.6622; train_chrom_access_recon_loss: 108705637.0687; train_global_loss: 132905696.3664; train_optim_loss: 132905696.3664; val_kl_reg_loss: 170930.4677; val_edge_recon_loss: 2818615.8333; val_gene_expr_recon_loss: 20868204.5333; val_masked_gp_l1_reg_loss: 92339.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85132.3203; val_chrom_access_recon_loss: 108176869.8667; val_global_loss: 132212092.2667; val_optim_loss: 132212092.2667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9574; val_auprc_score: 0.9488; val_best_acc_score: 0.8944; val_best_f1_score: 0.9002; train_kl_reg_loss: 171415.7457; train_edge_recon_loss: 2811770.6985; train_gene_expr_recon_loss: 20990266.4275; train_masked_gp_l1_reg_loss: 92931.2890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83294.1647; train_chrom_access_recon_loss: 108349178.8702; train_global_loss: 132498856.9771; train_optim_loss: 132498856.9771; val_kl_reg_loss: 167421.7292; val_edge_recon_loss: 2821474.0167; val_gene_expr_recon_loss: 20831716.6667; val_masked_gp_l1_reg_loss: 93586.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81579.8359; val_chrom_access_recon_loss: 108339185.0667; val_global_loss: 132334963.7333; val_optim_loss: 132334963.7333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9611; val_auprc_score: 0.9538; val_best_acc_score: 0.9023; val_best_f1_score: 0.9062; train_kl_reg_loss: 168177.5974; train_edge_recon_loss: 2807416.6985; train_gene_expr_recon_loss: 20945091.4962; train_masked_gp_l1_reg_loss: 94218.7400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79882.6905; train_chrom_access_recon_loss: 108103739.3588; train_global_loss: 132198526.7786; train_optim_loss: 132198526.7786; val_kl_reg_loss: 167171.3573; val_edge_recon_loss: 2827754.7333; val_gene_expr_recon_loss: 20713061.4667; val_masked_gp_l1_reg_loss: 95046.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78330.6484; val_chrom_access_recon_loss: 107851002.1333; val_global_loss: 131732365.8667; val_optim_loss: 131732365.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9630; val_auprc_score: 0.9549; val_best_acc_score: 0.9037; val_best_f1_score: 0.9064; train_kl_reg_loss: 166182.0314; train_edge_recon_loss: 2797985.6431; train_gene_expr_recon_loss: 20928897.8321; train_masked_gp_l1_reg_loss: 95759.7053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76927.4808; train_chrom_access_recon_loss: 108054632.9160; train_global_loss: 132120386.0153; train_optim_loss: 132120386.0153; val_kl_reg_loss: 164898.1708; val_edge_recon_loss: 2813768.2500; val_gene_expr_recon_loss: 20759783.6000; val_masked_gp_l1_reg_loss: 96484.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75510.8125; val_chrom_access_recon_loss: 107629979.7333; val_global_loss: 131540424.0000; val_optim_loss: 131540424.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9621; val_auprc_score: 0.9537; val_best_acc_score: 0.9037; val_best_f1_score: 0.9083; train_kl_reg_loss: 162968.2569; train_edge_recon_loss: 2793162.1813; train_gene_expr_recon_loss: 20888558.1679; train_masked_gp_l1_reg_loss: 97009.8940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74325.5468; train_chrom_access_recon_loss: 107684722.6870; train_global_loss: 131700746.4427; train_optim_loss: 131700746.4427; val_kl_reg_loss: 163109.4479; val_edge_recon_loss: 2803695.2667; val_gene_expr_recon_loss: 20860038.4000; val_masked_gp_l1_reg_loss: 97505.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73113.3516; val_chrom_access_recon_loss: 108320706.6667; val_global_loss: 132318168.5333; val_optim_loss: 132318168.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9538; val_auprc_score: 0.9419; val_best_acc_score: 0.8872; val_best_f1_score: 0.8936; train_kl_reg_loss: 159227.9998; train_edge_recon_loss: 2803356.8950; train_gene_expr_recon_loss: 20954135.4504; train_masked_gp_l1_reg_loss: 97980.6432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72304.6206; train_chrom_access_recon_loss: 107751606.1069; train_global_loss: 131838612.0916; train_optim_loss: 131838612.0916; val_kl_reg_loss: 151198.1750; val_edge_recon_loss: 2849165.1000; val_gene_expr_recon_loss: 20713653.4667; val_masked_gp_l1_reg_loss: 98420.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71867.5391; val_chrom_access_recon_loss: 107098832.5333; val_global_loss: 130983138.1333; val_optim_loss: 130983138.1333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9610; val_auprc_score: 0.9538; val_best_acc_score: 0.9000; val_best_f1_score: 0.9048; train_kl_reg_loss: 166931.8020; train_edge_recon_loss: 2799218.8626; train_gene_expr_recon_loss: 20868127.2672; train_masked_gp_l1_reg_loss: 98429.3958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69688.6368; train_chrom_access_recon_loss: 107327903.6947; train_global_loss: 131330299.5420; train_optim_loss: 131330299.5420; val_kl_reg_loss: 161115.0823; val_edge_recon_loss: 2816123.4500; val_gene_expr_recon_loss: 20701219.7333; val_masked_gp_l1_reg_loss: 99139.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68177.0234; val_chrom_access_recon_loss: 107270556.8000; val_global_loss: 131116332.8000; val_optim_loss: 131116332.8000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9606; val_auprc_score: 0.9525; val_best_acc_score: 0.8995; val_best_f1_score: 0.9039; train_kl_reg_loss: 163249.5382; train_edge_recon_loss: 2790740.1870; train_gene_expr_recon_loss: 20816052.9618; train_masked_gp_l1_reg_loss: 100310.5863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67127.6268; train_chrom_access_recon_loss: 107100551.7557; train_global_loss: 131038032.6107; train_optim_loss: 131038032.6107; val_kl_reg_loss: 159388.3458; val_edge_recon_loss: 2806812.6000; val_gene_expr_recon_loss: 20694926.4000; val_masked_gp_l1_reg_loss: 102180.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66165.8594; val_chrom_access_recon_loss: 106979659.7333; val_global_loss: 130809131.7333; val_optim_loss: 130809131.7333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9634; val_auprc_score: 0.9550; val_best_acc_score: 0.9058; val_best_f1_score: 0.9095; train_kl_reg_loss: 161063.8310; train_edge_recon_loss: 2789909.0305; train_gene_expr_recon_loss: 20826005.4962; train_masked_gp_l1_reg_loss: 103500.7310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65430.1107; train_chrom_access_recon_loss: 107252286.2290; train_global_loss: 131198195.5420; train_optim_loss: 131198195.5420; val_kl_reg_loss: 160228.3708; val_edge_recon_loss: 2781372.5667; val_gene_expr_recon_loss: 20581149.4667; val_masked_gp_l1_reg_loss: 104678.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64731.9336; val_chrom_access_recon_loss: 106666213.8667; val_global_loss: 130358373.8667; val_optim_loss: 130358373.8667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9652; val_auprc_score: 0.9574; val_best_acc_score: 0.9070; val_best_f1_score: 0.9105; train_kl_reg_loss: 159448.5899; train_edge_recon_loss: 2774796.8683; train_gene_expr_recon_loss: 20775294.3511; train_masked_gp_l1_reg_loss: 104994.5816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63973.7942; train_chrom_access_recon_loss: 107005510.4733; train_global_loss: 130884018.6870; train_optim_loss: 130884018.6870; val_kl_reg_loss: 156609.2250; val_edge_recon_loss: 2801604.8833; val_gene_expr_recon_loss: 20609693.8667; val_masked_gp_l1_reg_loss: 105300.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63273.7109; val_chrom_access_recon_loss: 106859900.2667; val_global_loss: 130596381.8667; val_optim_loss: 130596381.8667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9659; val_auprc_score: 0.9601; val_best_acc_score: 0.9085; val_best_f1_score: 0.9118; train_kl_reg_loss: 155936.1093; train_edge_recon_loss: 2777527.1317; train_gene_expr_recon_loss: 20771395.6947; train_masked_gp_l1_reg_loss: 106089.5237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62793.9126; train_chrom_access_recon_loss: 106985950.5344; train_global_loss: 130859692.5802; train_optim_loss: 130859692.5802; val_kl_reg_loss: 153382.2437; val_edge_recon_loss: 2801262.4833; val_gene_expr_recon_loss: 20601287.4667; val_masked_gp_l1_reg_loss: 106539.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62264.1250; val_chrom_access_recon_loss: 106728073.0667; val_global_loss: 130452809.6000; val_optim_loss: 130452809.6000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9673; val_auprc_score: 0.9607; val_best_acc_score: 0.9126; val_best_f1_score: 0.9162; train_kl_reg_loss: 167237.4646; train_edge_recon_loss: 2848898.3378; train_gene_expr_recon_loss: 21541520.5191; train_masked_gp_l1_reg_loss: 104172.0209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61508.8346; train_chrom_access_recon_loss: 108227853.3130; train_global_loss: 132951190.5344; train_optim_loss: 132951190.5344; val_kl_reg_loss: 87281.4620; val_edge_recon_loss: 2820833.4667; val_gene_expr_recon_loss: 21432611.8667; val_masked_gp_l1_reg_loss: 103450.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61093.0312; val_chrom_access_recon_loss: 108301888.0000; val_global_loss: 132807158.4000; val_optim_loss: 132807158.4000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9689; val_auprc_score: 0.9615; val_best_acc_score: 0.9116; val_best_f1_score: 0.9143; train_kl_reg_loss: 160890.3746; train_edge_recon_loss: 2800661.6431; train_gene_expr_recon_loss: 21598099.0534; train_masked_gp_l1_reg_loss: 103515.4859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61625.5366; train_chrom_access_recon_loss: 108267062.7176; train_global_loss: 132991854.7176; train_optim_loss: 132991854.7176; val_kl_reg_loss: 76027.9818; val_edge_recon_loss: 2800092.4667; val_gene_expr_recon_loss: 21484619.6000; val_masked_gp_l1_reg_loss: 103864.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62168.9570; val_chrom_access_recon_loss: 107969686.4000; val_global_loss: 132496460.2667; val_optim_loss: 132496460.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9661; val_auprc_score: 0.9591; val_best_acc_score: 0.9082; val_best_f1_score: 0.9115; train_kl_reg_loss: 158340.3962; train_edge_recon_loss: 2814703.2519; train_gene_expr_recon_loss: 21649034.6260; train_masked_gp_l1_reg_loss: 103543.2442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61966.3921; train_chrom_access_recon_loss: 108134187.1756; train_global_loss: 132921775.3893; train_optim_loss: 132921775.3893; val_kl_reg_loss: 75202.2323; val_edge_recon_loss: 2829665.2167; val_gene_expr_recon_loss: 21537485.7333; val_masked_gp_l1_reg_loss: 103502.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61819.8555; val_chrom_access_recon_loss: 108723387.2000; val_global_loss: 133331061.8667; val_optim_loss: 133331061.8667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9691; val_auprc_score: 0.9605; val_best_acc_score: 0.9138; val_best_f1_score: 0.9163; train_kl_reg_loss: 159857.8709; train_edge_recon_loss: 2808391.6069; train_gene_expr_recon_loss: 21737270.1679; train_masked_gp_l1_reg_loss: 103518.3538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61752.3174; train_chrom_access_recon_loss: 108478868.9466; train_global_loss: 133349659.5420; train_optim_loss: 133349659.5420; val_kl_reg_loss: 76526.4651; val_edge_recon_loss: 2802880.6500; val_gene_expr_recon_loss: 21529958.9333; val_masked_gp_l1_reg_loss: 103560.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61724.5742; val_chrom_access_recon_loss: 107782208.5333; val_global_loss: 132356856.5333; val_optim_loss: 132356856.5333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9665; val_auprc_score: 0.9600; val_best_acc_score: 0.9101; val_best_f1_score: 0.9132; train_kl_reg_loss: 159321.0180; train_edge_recon_loss: 2807611.2385; train_gene_expr_recon_loss: 21797604.8702; train_masked_gp_l1_reg_loss: 103566.4687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61716.4424; train_chrom_access_recon_loss: 108517038.8397; train_global_loss: 133446859.1145; train_optim_loss: 133446859.1145; val_kl_reg_loss: 76728.6927; val_edge_recon_loss: 2823547.8833; val_gene_expr_recon_loss: 21599565.4667; val_masked_gp_l1_reg_loss: 103551.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61694.1836; val_chrom_access_recon_loss: 108088896.0000; val_global_loss: 132753984.5333; val_optim_loss: 132753984.5333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9675; val_auprc_score: 0.9629; val_best_acc_score: 0.9065; val_best_f1_score: 0.9096; train_kl_reg_loss: 157788.2199; train_edge_recon_loss: 2803737.7615; train_gene_expr_recon_loss: 21823233.4504; train_masked_gp_l1_reg_loss: 103524.8513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61627.4192; train_chrom_access_recon_loss: 108603882.1374; train_global_loss: 133553794.0763; train_optim_loss: 133553794.0763; val_kl_reg_loss: 77210.2495; val_edge_recon_loss: 2828056.6833; val_gene_expr_recon_loss: 21630169.4667; val_masked_gp_l1_reg_loss: 103470.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61552.4062; val_chrom_access_recon_loss: 108284070.4000; val_global_loss: 132984528.5333; val_optim_loss: 132984528.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 37 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9628
val AUPRC score: 0.9571
val best accuracy score: 0.8994
val best F1 score: 0.9047
val target rna MSE score: 1.4799
val source rna MSE score: 73.5263
val target atac MSE score: 0.1243
val source atac MSE score: 0.8889
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
