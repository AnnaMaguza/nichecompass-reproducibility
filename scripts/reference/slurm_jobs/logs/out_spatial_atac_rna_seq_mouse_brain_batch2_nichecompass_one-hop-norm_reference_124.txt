[True]
Run timestamp: 07082023_211914_124.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_124']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9543; val_auprc_score: 0.9558; val_best_acc_score: 0.7417; val_best_f1_score: 0.7921; train_kl_reg_loss: 6520.4121; train_edge_recon_loss: 3468736.7778; train_gene_expr_recon_loss: 634535.5000; train_masked_gp_l1_reg_loss: 16217.4532; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 802754.1319; train_global_loss: 4928764.1111; train_optim_loss: 4928764.1111; val_kl_reg_loss: 3345.0178; val_edge_recon_loss: 4054679.5000; val_gene_expr_recon_loss: 610452.2500; val_masked_gp_l1_reg_loss: 11155.2812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 792476.6875; val_global_loss: 5472109.0000; val_optim_loss: 5472109.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9472; val_auprc_score: 0.9453; val_best_acc_score: 0.8790; val_best_f1_score: 0.8803; train_kl_reg_loss: 3165.7237; train_edge_recon_loss: 3468195.3611; train_gene_expr_recon_loss: 608559.1528; train_masked_gp_l1_reg_loss: 8866.7429; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 793528.5486; train_global_loss: 4882315.6667; train_optim_loss: 4882315.6667; val_kl_reg_loss: 2828.6868; val_edge_recon_loss: 4020024.7500; val_gene_expr_recon_loss: 586221.7500; val_masked_gp_l1_reg_loss: 7041.1816; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 785923.0000; val_global_loss: 5402039.0000; val_optim_loss: 5402039.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9367; val_auprc_score: 0.9230; val_best_acc_score: 0.8651; val_best_f1_score: 0.8715; train_kl_reg_loss: 5252.6031; train_edge_recon_loss: 3463732.0556; train_gene_expr_recon_loss: 577720.9583; train_masked_gp_l1_reg_loss: 6958.8676; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 785941.1250; train_global_loss: 4839605.5000; train_optim_loss: 4839605.5000; val_kl_reg_loss: 4712.6670; val_edge_recon_loss: 3727876.5000; val_gene_expr_recon_loss: 555297.5000; val_masked_gp_l1_reg_loss: 6920.6294; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 777753.8125; val_global_loss: 5072561.5000; val_optim_loss: 5072561.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8890; val_auprc_score: 0.8705; val_best_acc_score: 0.8026; val_best_f1_score: 0.8198; train_kl_reg_loss: 4635.7438; train_edge_recon_loss: 3228670.1944; train_gene_expr_recon_loss: 562291.0417; train_masked_gp_l1_reg_loss: 6757.5058; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 776276.1597; train_global_loss: 4578630.6667; train_optim_loss: 4578630.6667; val_kl_reg_loss: 11288.6328; val_edge_recon_loss: 2892688.0000; val_gene_expr_recon_loss: 559461.5625; val_masked_gp_l1_reg_loss: 6635.9204; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 776176.1250; val_global_loss: 4246250.5000; val_optim_loss: 4246250.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9059; val_auprc_score: 0.8860; val_best_acc_score: 0.8277; val_best_f1_score: 0.8416; train_kl_reg_loss: 28628.7907; train_edge_recon_loss: 2822435.1944; train_gene_expr_recon_loss: 565085.9653; train_masked_gp_l1_reg_loss: 6543.9570; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 780358.1111; train_global_loss: 4203051.9444; train_optim_loss: 4203051.9444; val_kl_reg_loss: 43169.2148; val_edge_recon_loss: 2778191.7500; val_gene_expr_recon_loss: 547481.5625; val_masked_gp_l1_reg_loss: 6462.8662; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 770576.8750; val_global_loss: 4145882.0000; val_optim_loss: 4145882.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9307; val_auprc_score: 0.9102; val_best_acc_score: 0.8662; val_best_f1_score: 0.8741; train_kl_reg_loss: 42212.3841; train_edge_recon_loss: 2762114.6667; train_gene_expr_recon_loss: 544683.3611; train_masked_gp_l1_reg_loss: 6440.7007; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 772231.7222; train_global_loss: 4127682.7778; train_optim_loss: 4127682.7778; val_kl_reg_loss: 33588.1133; val_edge_recon_loss: 2708713.0000; val_gene_expr_recon_loss: 536754.8750; val_masked_gp_l1_reg_loss: 6407.6504; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 766463.2500; val_global_loss: 4051927.0000; val_optim_loss: 4051927.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9278; val_auprc_score: 0.9061; val_best_acc_score: 0.8635; val_best_f1_score: 0.8719; train_kl_reg_loss: 34181.4497; train_edge_recon_loss: 2727602.9722; train_gene_expr_recon_loss: 542252.9444; train_masked_gp_l1_reg_loss: 6385.2649; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 768765.8681; train_global_loss: 4079188.4444; train_optim_loss: 4079188.4444; val_kl_reg_loss: 35258.3438; val_edge_recon_loss: 2764672.2500; val_gene_expr_recon_loss: 528993.1250; val_masked_gp_l1_reg_loss: 6361.7212; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 763196.0000; val_global_loss: 4098481.2500; val_optim_loss: 4098481.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9325; val_auprc_score: 0.9087; val_best_acc_score: 0.8724; val_best_f1_score: 0.8794; train_kl_reg_loss: 39852.6506; train_edge_recon_loss: 2722979.0278; train_gene_expr_recon_loss: 529254.3125; train_masked_gp_l1_reg_loss: 6380.1099; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 763424.0278; train_global_loss: 4061890.1389; train_optim_loss: 4061890.1389; val_kl_reg_loss: 38034.2148; val_edge_recon_loss: 2730451.2500; val_gene_expr_recon_loss: 517349.7500; val_masked_gp_l1_reg_loss: 6395.3247; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 758049.3125; val_global_loss: 4050279.7500; val_optim_loss: 4050279.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9351; val_auprc_score: 0.9166; val_best_acc_score: 0.8711; val_best_f1_score: 0.8790; train_kl_reg_loss: 37079.5720; train_edge_recon_loss: 2720233.4444; train_gene_expr_recon_loss: 520686.2431; train_masked_gp_l1_reg_loss: 6431.3963; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 761828.9931; train_global_loss: 4046259.5833; train_optim_loss: 4046259.5833; val_kl_reg_loss: 33009.5625; val_edge_recon_loss: 2722452.0000; val_gene_expr_recon_loss: 511687.3750; val_masked_gp_l1_reg_loss: 6483.3975; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 755660.8125; val_global_loss: 4029293.2500; val_optim_loss: 4029293.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9388; val_auprc_score: 0.9207; val_best_acc_score: 0.8791; val_best_f1_score: 0.8859; train_kl_reg_loss: 35000.0273; train_edge_recon_loss: 2712841.2778; train_gene_expr_recon_loss: 511516.0764; train_masked_gp_l1_reg_loss: 6547.2425; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 754438.3611; train_global_loss: 4020342.9722; train_optim_loss: 4020342.9722; val_kl_reg_loss: 34699.9609; val_edge_recon_loss: 2722356.5000; val_gene_expr_recon_loss: 504095.0938; val_masked_gp_l1_reg_loss: 6614.1016; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 752544.5000; val_global_loss: 4020310.0000; val_optim_loss: 4020310.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9419; val_auprc_score: 0.9227; val_best_acc_score: 0.8816; val_best_f1_score: 0.8890; train_kl_reg_loss: 36111.2548; train_edge_recon_loss: 2730348.5556; train_gene_expr_recon_loss: 504152.5243; train_masked_gp_l1_reg_loss: 6665.5240; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 753631.9444; train_global_loss: 4030909.7778; train_optim_loss: 4030909.7778; val_kl_reg_loss: 33964.4961; val_edge_recon_loss: 2715546.2500; val_gene_expr_recon_loss: 498374.6562; val_masked_gp_l1_reg_loss: 6735.1245; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 749758.6250; val_global_loss: 4004379.0000; val_optim_loss: 4004379.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9430; val_auprc_score: 0.9269; val_best_acc_score: 0.8848; val_best_f1_score: 0.8919; train_kl_reg_loss: 34143.9789; train_edge_recon_loss: 2714185.3333; train_gene_expr_recon_loss: 501216.9549; train_masked_gp_l1_reg_loss: 6792.4915; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 750407.6806; train_global_loss: 4006746.4167; train_optim_loss: 4006746.4167; val_kl_reg_loss: 32744.8711; val_edge_recon_loss: 2713308.0000; val_gene_expr_recon_loss: 494530.9062; val_masked_gp_l1_reg_loss: 6871.2690; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 747443.1875; val_global_loss: 3994898.2500; val_optim_loss: 3994898.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9500; val_auprc_score: 0.9349; val_best_acc_score: 0.8968; val_best_f1_score: 0.9019; train_kl_reg_loss: 33645.1680; train_edge_recon_loss: 2709265.3333; train_gene_expr_recon_loss: 495376.1042; train_masked_gp_l1_reg_loss: 6947.2050; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 747208.2292; train_global_loss: 3992441.9722; train_optim_loss: 3992441.9722; val_kl_reg_loss: 31699.6152; val_edge_recon_loss: 2714648.7500; val_gene_expr_recon_loss: 489916.0312; val_masked_gp_l1_reg_loss: 7023.8306; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 745268.4375; val_global_loss: 3988556.5000; val_optim_loss: 3988556.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9546; val_auprc_score: 0.9403; val_best_acc_score: 0.8969; val_best_f1_score: 0.9016; train_kl_reg_loss: 32660.0119; train_edge_recon_loss: 2689628.2222; train_gene_expr_recon_loss: 491704.2674; train_masked_gp_l1_reg_loss: 7072.7835; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 746997.9792; train_global_loss: 3968063.1944; train_optim_loss: 3968063.1944; val_kl_reg_loss: 31113.5977; val_edge_recon_loss: 2703358.2500; val_gene_expr_recon_loss: 487354.5938; val_masked_gp_l1_reg_loss: 7138.6992; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 743034.9375; val_global_loss: 3972000.0000; val_optim_loss: 3972000.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9597; val_auprc_score: 0.9401; val_best_acc_score: 0.9099; val_best_f1_score: 0.9139; train_kl_reg_loss: 32714.4117; train_edge_recon_loss: 2692823.3056; train_gene_expr_recon_loss: 490517.7465; train_masked_gp_l1_reg_loss: 7202.5903; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 744735.9167; train_global_loss: 3967993.9444; train_optim_loss: 3967993.9444; val_kl_reg_loss: 32131.8574; val_edge_recon_loss: 2702713.2500; val_gene_expr_recon_loss: 484926.9062; val_masked_gp_l1_reg_loss: 7272.6309; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740240.7500; val_global_loss: 3967285.5000; val_optim_loss: 3967285.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9675; val_auprc_score: 0.9574; val_best_acc_score: 0.9144; val_best_f1_score: 0.9178; train_kl_reg_loss: 33912.0464; train_edge_recon_loss: 2677162.4444; train_gene_expr_recon_loss: 484835.1076; train_masked_gp_l1_reg_loss: 7333.1021; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 741347.6597; train_global_loss: 3944590.3333; train_optim_loss: 3944590.3333; val_kl_reg_loss: 32888.5586; val_edge_recon_loss: 2669641.5000; val_gene_expr_recon_loss: 482159.9375; val_masked_gp_l1_reg_loss: 7400.2202; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 739147.1250; val_global_loss: 3931237.5000; val_optim_loss: 3931237.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9634; val_auprc_score: 0.9506; val_best_acc_score: 0.9104; val_best_f1_score: 0.9141; train_kl_reg_loss: 34545.6645; train_edge_recon_loss: 2662148.6389; train_gene_expr_recon_loss: 485786.9583; train_masked_gp_l1_reg_loss: 7453.5885; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 740277.5069; train_global_loss: 3930212.4167; train_optim_loss: 3930212.4167; val_kl_reg_loss: 33743.2031; val_edge_recon_loss: 2679571.7500; val_gene_expr_recon_loss: 480857.9688; val_masked_gp_l1_reg_loss: 7520.8457; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 737327.8125; val_global_loss: 3939021.5000; val_optim_loss: 3939021.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9662; val_auprc_score: 0.9514; val_best_acc_score: 0.9169; val_best_f1_score: 0.9201; train_kl_reg_loss: 35011.6927; train_edge_recon_loss: 2676137.3889; train_gene_expr_recon_loss: 478036.5799; train_masked_gp_l1_reg_loss: 7568.7988; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 734829.4722; train_global_loss: 3931583.9722; train_optim_loss: 3931583.9722; val_kl_reg_loss: 33232.8594; val_edge_recon_loss: 2668879.0000; val_gene_expr_recon_loss: 477054.0625; val_masked_gp_l1_reg_loss: 7628.7739; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735344.4375; val_global_loss: 3922139.0000; val_optim_loss: 3922139.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9687; val_auprc_score: 0.9571; val_best_acc_score: 0.9200; val_best_f1_score: 0.9221; train_kl_reg_loss: 34230.1146; train_edge_recon_loss: 2653971.1111; train_gene_expr_recon_loss: 478369.5938; train_masked_gp_l1_reg_loss: 7665.4290; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 735335.8125; train_global_loss: 3909571.9722; train_optim_loss: 3909571.9722; val_kl_reg_loss: 32225.7207; val_edge_recon_loss: 2666228.7500; val_gene_expr_recon_loss: 475902.7500; val_masked_gp_l1_reg_loss: 7709.7305; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735256.3750; val_global_loss: 3917323.5000; val_optim_loss: 3917323.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9710; val_auprc_score: 0.9598; val_best_acc_score: 0.9235; val_best_f1_score: 0.9247; train_kl_reg_loss: 32746.1482; train_edge_recon_loss: 2660198.4722; train_gene_expr_recon_loss: 476837.8646; train_masked_gp_l1_reg_loss: 7759.7636; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 735595.5208; train_global_loss: 3913137.8611; train_optim_loss: 3913137.8611; val_kl_reg_loss: 32322.3281; val_edge_recon_loss: 2667088.5000; val_gene_expr_recon_loss: 470789.1250; val_masked_gp_l1_reg_loss: 7810.8975; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 731998.6875; val_global_loss: 3910009.7500; val_optim_loss: 3910009.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9740; val_auprc_score: 0.9669; val_best_acc_score: 0.9271; val_best_f1_score: 0.9298; train_kl_reg_loss: 33604.7671; train_edge_recon_loss: 2654244.2222; train_gene_expr_recon_loss: 474731.4236; train_masked_gp_l1_reg_loss: 7860.4363; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 733680.5764; train_global_loss: 3904121.4444; train_optim_loss: 3904121.4444; val_kl_reg_loss: 31570.8633; val_edge_recon_loss: 2673974.0000; val_gene_expr_recon_loss: 471225.9375; val_masked_gp_l1_reg_loss: 7910.6084; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 730631.6875; val_global_loss: 3915313.0000; val_optim_loss: 3915313.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9765; val_auprc_score: 0.9687; val_best_acc_score: 0.9258; val_best_f1_score: 0.9278; train_kl_reg_loss: 32402.5026; train_edge_recon_loss: 2642804.8889; train_gene_expr_recon_loss: 472107.9618; train_masked_gp_l1_reg_loss: 7956.6049; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 735888.5278; train_global_loss: 3891160.4722; train_optim_loss: 3891160.4722; val_kl_reg_loss: 31711.5410; val_edge_recon_loss: 2669892.2500; val_gene_expr_recon_loss: 473965.9375; val_masked_gp_l1_reg_loss: 8006.2686; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 731858.8125; val_global_loss: 3915434.7500; val_optim_loss: 3915434.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9741; val_auprc_score: 0.9652; val_best_acc_score: 0.9270; val_best_f1_score: 0.9288; train_kl_reg_loss: 32680.2081; train_edge_recon_loss: 2653044.0000; train_gene_expr_recon_loss: 469782.0486; train_masked_gp_l1_reg_loss: 8038.9550; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731278.5833; train_global_loss: 3894823.8333; train_optim_loss: 3894823.8333; val_kl_reg_loss: 30581.6641; val_edge_recon_loss: 2659844.2500; val_gene_expr_recon_loss: 464773.3125; val_masked_gp_l1_reg_loss: 8067.4702; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 727290.4375; val_global_loss: 3890557.2500; val_optim_loss: 3890557.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9758; val_auprc_score: 0.9651; val_best_acc_score: 0.9302; val_best_f1_score: 0.9326; train_kl_reg_loss: 32299.1165; train_edge_recon_loss: 2631289.4444; train_gene_expr_recon_loss: 466083.7569; train_masked_gp_l1_reg_loss: 8096.6801; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728190.4583; train_global_loss: 3865959.5000; train_optim_loss: 3865959.5000; val_kl_reg_loss: 32525.9082; val_edge_recon_loss: 2644961.2500; val_gene_expr_recon_loss: 466974.9375; val_masked_gp_l1_reg_loss: 8118.6963; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 728420.1875; val_global_loss: 3881001.2500; val_optim_loss: 3881001.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9797; val_auprc_score: 0.9730; val_best_acc_score: 0.9349; val_best_f1_score: 0.9374; train_kl_reg_loss: 33525.5312; train_edge_recon_loss: 2640404.7500; train_gene_expr_recon_loss: 464402.7014; train_masked_gp_l1_reg_loss: 8144.9035; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 726294.4514; train_global_loss: 3872772.3333; train_optim_loss: 3872772.3333; val_kl_reg_loss: 31913.9062; val_edge_recon_loss: 2643103.2500; val_gene_expr_recon_loss: 464727.9375; val_masked_gp_l1_reg_loss: 8174.3135; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 726623.3750; val_global_loss: 3874543.0000; val_optim_loss: 3874543.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9796; val_auprc_score: 0.9722; val_best_acc_score: 0.9340; val_best_f1_score: 0.9361; train_kl_reg_loss: 32351.3468; train_edge_recon_loss: 2652112.6111; train_gene_expr_recon_loss: 484237.0347; train_masked_gp_l1_reg_loss: 8178.4988; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731132.2292; train_global_loss: 3908011.6667; train_optim_loss: 3908011.6667; val_kl_reg_loss: 16192.0557; val_edge_recon_loss: 2647528.2500; val_gene_expr_recon_loss: 491096.8750; val_masked_gp_l1_reg_loss: 8156.5571; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 736333.0625; val_global_loss: 3899306.5000; val_optim_loss: 3899306.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9770; val_auprc_score: 0.9685; val_best_acc_score: 0.9349; val_best_f1_score: 0.9373; train_kl_reg_loss: 32836.2105; train_edge_recon_loss: 2637969.0278; train_gene_expr_recon_loss: 480709.1319; train_masked_gp_l1_reg_loss: 8144.7572; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732018.4167; train_global_loss: 3891677.5833; train_optim_loss: 3891677.5833; val_kl_reg_loss: 17255.8047; val_edge_recon_loss: 2657717.7500; val_gene_expr_recon_loss: 483668.8438; val_masked_gp_l1_reg_loss: 8131.6143; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 733218.3750; val_global_loss: 3899992.0000; val_optim_loss: 3899992.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9796; val_auprc_score: 0.9723; val_best_acc_score: 0.9352; val_best_f1_score: 0.9368; train_kl_reg_loss: 30910.3674; train_edge_recon_loss: 2628132.6667; train_gene_expr_recon_loss: 477617.6944; train_masked_gp_l1_reg_loss: 8128.5673; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 730143.1528; train_global_loss: 3874932.4722; train_optim_loss: 3874932.4722; val_kl_reg_loss: 17649.7969; val_edge_recon_loss: 2643503.0000; val_gene_expr_recon_loss: 477487.4375; val_masked_gp_l1_reg_loss: 8126.6641; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 730251.9375; val_global_loss: 3877019.0000; val_optim_loss: 3877019.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9789; val_auprc_score: 0.9697; val_best_acc_score: 0.9387; val_best_f1_score: 0.9405; train_kl_reg_loss: 30459.5130; train_edge_recon_loss: 2632024.4167; train_gene_expr_recon_loss: 474999.1597; train_masked_gp_l1_reg_loss: 8130.6400; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 730296.1111; train_global_loss: 3875909.8333; train_optim_loss: 3875909.8333; val_kl_reg_loss: 18761.0742; val_edge_recon_loss: 2642260.0000; val_gene_expr_recon_loss: 473343.3750; val_masked_gp_l1_reg_loss: 8135.0732; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 728188.6875; val_global_loss: 3870688.2500; val_optim_loss: 3870688.2500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9800; val_auprc_score: 0.9699; val_best_acc_score: 0.9426; val_best_f1_score: 0.9441; train_kl_reg_loss: 28586.8396; train_edge_recon_loss: 2632123.5278; train_gene_expr_recon_loss: 473317.4549; train_masked_gp_l1_reg_loss: 8145.8199; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727878.1875; train_global_loss: 3870051.8889; train_optim_loss: 3870051.8889; val_kl_reg_loss: 18333.5332; val_edge_recon_loss: 2638962.0000; val_gene_expr_recon_loss: 471255.5312; val_masked_gp_l1_reg_loss: 8158.3779; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 726426.9375; val_global_loss: 3863136.5000; val_optim_loss: 3863136.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9808; val_auprc_score: 0.9724; val_best_acc_score: 0.9437; val_best_f1_score: 0.9450; train_kl_reg_loss: 27500.4030; train_edge_recon_loss: 2623328.6667; train_gene_expr_recon_loss: 470703.8264; train_masked_gp_l1_reg_loss: 8176.2634; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728845.2361; train_global_loss: 3858554.3889; train_optim_loss: 3858554.3889; val_kl_reg_loss: 19470.7266; val_edge_recon_loss: 2635426.7500; val_gene_expr_recon_loss: 471009.2500; val_masked_gp_l1_reg_loss: 8190.1768; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 725837.9375; val_global_loss: 3859935.0000; val_optim_loss: 3859935.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9830; val_auprc_score: 0.9777; val_best_acc_score: 0.9442; val_best_f1_score: 0.9451; train_kl_reg_loss: 27773.1519; train_edge_recon_loss: 2634251.0000; train_gene_expr_recon_loss: 468983.8993; train_masked_gp_l1_reg_loss: 8202.6281; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724578.4444; train_global_loss: 3863789.1667; train_optim_loss: 3863789.1667; val_kl_reg_loss: 20562.6953; val_edge_recon_loss: 2644919.7500; val_gene_expr_recon_loss: 470339.5000; val_masked_gp_l1_reg_loss: 8213.2275; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 725323.2500; val_global_loss: 3869358.5000; val_optim_loss: 3869358.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9820; val_auprc_score: 0.9737; val_best_acc_score: 0.9438; val_best_f1_score: 0.9457; train_kl_reg_loss: 27740.2196; train_edge_recon_loss: 2619737.9444; train_gene_expr_recon_loss: 464788.6944; train_masked_gp_l1_reg_loss: 8225.2376; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724021.6667; train_global_loss: 3844513.7778; train_optim_loss: 3844513.7778; val_kl_reg_loss: 20404.5352; val_edge_recon_loss: 2643222.5000; val_gene_expr_recon_loss: 468708.4375; val_masked_gp_l1_reg_loss: 8231.5146; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 724269.5625; val_global_loss: 3864836.5000; val_optim_loss: 3864836.5000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9841; val_auprc_score: 0.9767; val_best_acc_score: 0.9515; val_best_f1_score: 0.9528; train_kl_reg_loss: 26611.8487; train_edge_recon_loss: 2625407.8889; train_gene_expr_recon_loss: 465880.7778; train_masked_gp_l1_reg_loss: 8235.0221; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 723510.3056; train_global_loss: 3849645.8611; train_optim_loss: 3849645.8611; val_kl_reg_loss: 20384.0273; val_edge_recon_loss: 2619296.5000; val_gene_expr_recon_loss: 467588.4375; val_masked_gp_l1_reg_loss: 8237.1523; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722608.8750; val_global_loss: 3838115.0000; val_optim_loss: 3838115.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9818; val_auprc_score: 0.9749; val_best_acc_score: 0.9457; val_best_f1_score: 0.9473; train_kl_reg_loss: 26484.0167; train_edge_recon_loss: 2623525.3333; train_gene_expr_recon_loss: 464433.7882; train_masked_gp_l1_reg_loss: 8244.9149; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 719396.9931; train_global_loss: 3842084.9722; train_optim_loss: 3842084.9722; val_kl_reg_loss: 21061.2109; val_edge_recon_loss: 2646428.0000; val_gene_expr_recon_loss: 464846.0625; val_masked_gp_l1_reg_loss: 8250.3408; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 721140.0625; val_global_loss: 3861725.5000; val_optim_loss: 3861725.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9840; val_auprc_score: 0.9774; val_best_acc_score: 0.9483; val_best_f1_score: 0.9495; train_kl_reg_loss: 26321.1465; train_edge_recon_loss: 2624721.4444; train_gene_expr_recon_loss: 463283.4861; train_masked_gp_l1_reg_loss: 8264.9869; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 721985.7708; train_global_loss: 3844576.8056; train_optim_loss: 3844576.8056; val_kl_reg_loss: 21532.9258; val_edge_recon_loss: 2640883.5000; val_gene_expr_recon_loss: 465115.1562; val_masked_gp_l1_reg_loss: 8280.2031; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 720727.3750; val_global_loss: 3856539.5000; val_optim_loss: 3856539.5000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9831; val_auprc_score: 0.9745; val_best_acc_score: 0.9492; val_best_f1_score: 0.9504; train_kl_reg_loss: 26536.3544; train_edge_recon_loss: 2621509.0000; train_gene_expr_recon_loss: 461525.8542; train_masked_gp_l1_reg_loss: 8293.8126; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 719969.9444; train_global_loss: 3837834.9444; train_optim_loss: 3837834.9444; val_kl_reg_loss: 22033.0605; val_edge_recon_loss: 2619857.0000; val_gene_expr_recon_loss: 465184.7188; val_masked_gp_l1_reg_loss: 8303.1611; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 720463.1875; val_global_loss: 3835841.2500; val_optim_loss: 3835841.2500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9841; val_auprc_score: 0.9772; val_best_acc_score: 0.9503; val_best_f1_score: 0.9513; train_kl_reg_loss: 26441.8702; train_edge_recon_loss: 2621184.3611; train_gene_expr_recon_loss: 461392.3958; train_masked_gp_l1_reg_loss: 8310.9391; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 718114.6736; train_global_loss: 3835444.2222; train_optim_loss: 3835444.2222; val_kl_reg_loss: 22156.5781; val_edge_recon_loss: 2617276.5000; val_gene_expr_recon_loss: 461282.3125; val_masked_gp_l1_reg_loss: 8319.4131; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718352.1250; val_global_loss: 3827387.0000; val_optim_loss: 3827387.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9853; val_auprc_score: 0.9796; val_best_acc_score: 0.9504; val_best_f1_score: 0.9518; train_kl_reg_loss: 26453.0849; train_edge_recon_loss: 2614430.4722; train_gene_expr_recon_loss: 458466.4826; train_masked_gp_l1_reg_loss: 8335.6749; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 719066.1944; train_global_loss: 3826751.8889; train_optim_loss: 3826751.8889; val_kl_reg_loss: 22116.0664; val_edge_recon_loss: 2622596.5000; val_gene_expr_recon_loss: 461819.3750; val_masked_gp_l1_reg_loss: 8352.9600; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718177.8750; val_global_loss: 3833063.0000; val_optim_loss: 3833063.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9855; val_auprc_score: 0.9794; val_best_acc_score: 0.9489; val_best_f1_score: 0.9503; train_kl_reg_loss: 25673.2057; train_edge_recon_loss: 2615003.7500; train_gene_expr_recon_loss: 456626.2535; train_masked_gp_l1_reg_loss: 8368.0191; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714407.7639; train_global_loss: 3820078.9722; train_optim_loss: 3820078.9722; val_kl_reg_loss: 21482.1641; val_edge_recon_loss: 2635659.5000; val_gene_expr_recon_loss: 461831.3125; val_masked_gp_l1_reg_loss: 8379.2559; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 717038.7500; val_global_loss: 3844391.0000; val_optim_loss: 3844391.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9823; val_auprc_score: 0.9764; val_best_acc_score: 0.9485; val_best_f1_score: 0.9499; train_kl_reg_loss: 25558.1797; train_edge_recon_loss: 2615456.5556; train_gene_expr_recon_loss: 457815.5069; train_masked_gp_l1_reg_loss: 8390.7442; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 715393.7639; train_global_loss: 3822614.7222; train_optim_loss: 3822614.7222; val_kl_reg_loss: 22512.7422; val_edge_recon_loss: 2640954.5000; val_gene_expr_recon_loss: 462650.5938; val_masked_gp_l1_reg_loss: 8401.7910; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 717302.1250; val_global_loss: 3851821.5000; val_optim_loss: 3851821.5000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9845; val_auprc_score: 0.9789; val_best_acc_score: 0.9488; val_best_f1_score: 0.9504; train_kl_reg_loss: 25921.6439; train_edge_recon_loss: 2616477.3333; train_gene_expr_recon_loss: 456213.4688; train_masked_gp_l1_reg_loss: 8414.6095; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714088.0764; train_global_loss: 3821115.1389; train_optim_loss: 3821115.1389; val_kl_reg_loss: 22625.0391; val_edge_recon_loss: 2629850.0000; val_gene_expr_recon_loss: 458651.8438; val_masked_gp_l1_reg_loss: 8426.3037; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 715015.8750; val_global_loss: 3834569.0000; val_optim_loss: 3834569.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9837; val_auprc_score: 0.9768; val_best_acc_score: 0.9500; val_best_f1_score: 0.9515; train_kl_reg_loss: 25907.0174; train_edge_recon_loss: 2618970.4722; train_gene_expr_recon_loss: 454712.3854; train_masked_gp_l1_reg_loss: 8351.3457; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 710721.8056; train_global_loss: 3818663.1389; train_optim_loss: 3818663.1389; val_kl_reg_loss: 22500.3789; val_edge_recon_loss: 2622173.2500; val_gene_expr_recon_loss: 458794.7500; val_masked_gp_l1_reg_loss: 8290.4150; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714876.9375; val_global_loss: 3826636.0000; val_optim_loss: 3826636.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9865; val_auprc_score: 0.9809; val_best_acc_score: 0.9547; val_best_f1_score: 0.9559; train_kl_reg_loss: 25711.4976; train_edge_recon_loss: 2611732.4444; train_gene_expr_recon_loss: 455956.2986; train_masked_gp_l1_reg_loss: 8277.1191; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712835.9722; train_global_loss: 3814513.3056; train_optim_loss: 3814513.3056; val_kl_reg_loss: 22382.6523; val_edge_recon_loss: 2617245.5000; val_gene_expr_recon_loss: 459192.5000; val_masked_gp_l1_reg_loss: 8254.6289; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 715076.4375; val_global_loss: 3822152.0000; val_optim_loss: 3822152.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9850; val_auprc_score: 0.9776; val_best_acc_score: 0.9515; val_best_f1_score: 0.9529; train_kl_reg_loss: 25708.7014; train_edge_recon_loss: 2617275.9722; train_gene_expr_recon_loss: 455494.3854; train_masked_gp_l1_reg_loss: 8244.8446; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 713790.3958; train_global_loss: 3820514.2778; train_optim_loss: 3820514.2778; val_kl_reg_loss: 22328.9766; val_edge_recon_loss: 2619471.0000; val_gene_expr_recon_loss: 458569.1250; val_masked_gp_l1_reg_loss: 8234.2539; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714737.5625; val_global_loss: 3823340.7500; val_optim_loss: 3823340.7500
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9837; val_auprc_score: 0.9758; val_best_acc_score: 0.9527; val_best_f1_score: 0.9541; train_kl_reg_loss: 25630.7971; train_edge_recon_loss: 2623640.7500; train_gene_expr_recon_loss: 455754.0451; train_masked_gp_l1_reg_loss: 8229.4666; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712870.7708; train_global_loss: 3826125.8611; train_optim_loss: 3826125.8611; val_kl_reg_loss: 22244.7715; val_edge_recon_loss: 2619811.2500; val_gene_expr_recon_loss: 459235.8750; val_masked_gp_l1_reg_loss: 8224.6523; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 715031.6250; val_global_loss: 3824548.5000; val_optim_loss: 3824548.5000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9846; val_auprc_score: 0.9797; val_best_acc_score: 0.9508; val_best_f1_score: 0.9524; train_kl_reg_loss: 25315.8730; train_edge_recon_loss: 2610816.3611; train_gene_expr_recon_loss: 453188.8333; train_masked_gp_l1_reg_loss: 8223.3925; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714976.6528; train_global_loss: 3812521.2222; train_optim_loss: 3812521.2222; val_kl_reg_loss: 22160.5156; val_edge_recon_loss: 2626252.5000; val_gene_expr_recon_loss: 458248.0625; val_masked_gp_l1_reg_loss: 8220.6758; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714412.5625; val_global_loss: 3829294.2500; val_optim_loss: 3829294.2500
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9832; val_auprc_score: 0.9739; val_best_acc_score: 0.9511; val_best_f1_score: 0.9523; train_kl_reg_loss: 25435.2068; train_edge_recon_loss: 2617502.4722; train_gene_expr_recon_loss: 454095.7951; train_masked_gp_l1_reg_loss: 8220.6783; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712283.1806; train_global_loss: 3817537.3611; train_optim_loss: 3817537.3611; val_kl_reg_loss: 22313.5391; val_edge_recon_loss: 2616866.7500; val_gene_expr_recon_loss: 458412.2500; val_masked_gp_l1_reg_loss: 8220.0684; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714529.1875; val_global_loss: 3820341.7500; val_optim_loss: 3820341.7500
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9843; val_auprc_score: 0.9789; val_best_acc_score: 0.9520; val_best_f1_score: 0.9531; train_kl_reg_loss: 25485.8683; train_edge_recon_loss: 2611920.1667; train_gene_expr_recon_loss: 454585.2847; train_masked_gp_l1_reg_loss: 8219.7533; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712242.7431; train_global_loss: 3812453.8889; train_optim_loss: 3812453.8889; val_kl_reg_loss: 22422.4922; val_edge_recon_loss: 2609486.5000; val_gene_expr_recon_loss: 458412.8125; val_masked_gp_l1_reg_loss: 8219.2656; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714396.1875; val_global_loss: 3812937.2500; val_optim_loss: 3812937.2500
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9843; val_auprc_score: 0.9750; val_best_acc_score: 0.9518; val_best_f1_score: 0.9529; train_kl_reg_loss: 25697.1745; train_edge_recon_loss: 2616166.6111; train_gene_expr_recon_loss: 454854.2361; train_masked_gp_l1_reg_loss: 8219.6993; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711952.7986; train_global_loss: 3816890.5556; train_optim_loss: 3816890.5556; val_kl_reg_loss: 22523.9941; val_edge_recon_loss: 2627279.5000; val_gene_expr_recon_loss: 457729.1875; val_masked_gp_l1_reg_loss: 8220.3047; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714006.0000; val_global_loss: 3829759.0000; val_optim_loss: 3829759.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9866; val_auprc_score: 0.9826; val_best_acc_score: 0.9524; val_best_f1_score: 0.9536; train_kl_reg_loss: 25866.0818; train_edge_recon_loss: 2613099.5000; train_gene_expr_recon_loss: 453461.3056; train_masked_gp_l1_reg_loss: 8220.8129; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711832.6111; train_global_loss: 3812480.3333; train_optim_loss: 3812480.3333; val_kl_reg_loss: 22584.7344; val_edge_recon_loss: 2632115.5000; val_gene_expr_recon_loss: 458255.7500; val_masked_gp_l1_reg_loss: 8220.9355; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714332.0000; val_global_loss: 3835509.0000; val_optim_loss: 3835509.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9851; val_auprc_score: 0.9780; val_best_acc_score: 0.9532; val_best_f1_score: 0.9543; train_kl_reg_loss: 25712.9935; train_edge_recon_loss: 2611391.4722; train_gene_expr_recon_loss: 454658.6667; train_masked_gp_l1_reg_loss: 8222.4760; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 713838.7986; train_global_loss: 3813824.5278; train_optim_loss: 3813824.5278; val_kl_reg_loss: 22378.5039; val_edge_recon_loss: 2622772.2500; val_gene_expr_recon_loss: 458301.0000; val_masked_gp_l1_reg_loss: 8223.7578; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714111.5625; val_global_loss: 3825787.0000; val_optim_loss: 3825787.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9866; val_auprc_score: 0.9824; val_best_acc_score: 0.9574; val_best_f1_score: 0.9585; train_kl_reg_loss: 25599.9360; train_edge_recon_loss: 2612920.0556; train_gene_expr_recon_loss: 455085.9375; train_masked_gp_l1_reg_loss: 8224.7161; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712568.0347; train_global_loss: 3814398.6111; train_optim_loss: 3814398.6111; val_kl_reg_loss: 22275.4316; val_edge_recon_loss: 2603758.7500; val_gene_expr_recon_loss: 457952.8750; val_masked_gp_l1_reg_loss: 8225.5166; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713843.3125; val_global_loss: 3806055.7500; val_optim_loss: 3806055.7500
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9840; val_auprc_score: 0.9781; val_best_acc_score: 0.9501; val_best_f1_score: 0.9514; train_kl_reg_loss: 25503.9931; train_edge_recon_loss: 2618004.1389; train_gene_expr_recon_loss: 452541.2639; train_masked_gp_l1_reg_loss: 8226.8103; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 708706.4097; train_global_loss: 3812982.6944; train_optim_loss: 3812982.6944; val_kl_reg_loss: 22276.2070; val_edge_recon_loss: 2622512.5000; val_gene_expr_recon_loss: 457645.0312; val_masked_gp_l1_reg_loss: 8228.1162; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713793.2500; val_global_loss: 3824455.0000; val_optim_loss: 3824455.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9826; val_auprc_score: 0.9717; val_best_acc_score: 0.9515; val_best_f1_score: 0.9527; train_kl_reg_loss: 25512.2561; train_edge_recon_loss: 2618699.7500; train_gene_expr_recon_loss: 455210.8368; train_masked_gp_l1_reg_loss: 8229.4080; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714487.7222; train_global_loss: 3822139.9167; train_optim_loss: 3822139.9167; val_kl_reg_loss: 22076.7227; val_edge_recon_loss: 2634590.2500; val_gene_expr_recon_loss: 458342.9062; val_masked_gp_l1_reg_loss: 8229.8330; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714183.8125; val_global_loss: 3837423.5000; val_optim_loss: 3837423.5000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9870; val_auprc_score: 0.9800; val_best_acc_score: 0.9542; val_best_f1_score: 0.9555; train_kl_reg_loss: 25100.4327; train_edge_recon_loss: 2614582.1111; train_gene_expr_recon_loss: 451577.4653; train_masked_gp_l1_reg_loss: 8232.7180; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 709628.5069; train_global_loss: 3809121.2222; train_optim_loss: 3809121.2222; val_kl_reg_loss: 22159.4238; val_edge_recon_loss: 2626467.7500; val_gene_expr_recon_loss: 457707.0625; val_masked_gp_l1_reg_loss: 8233.8711; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713888.1875; val_global_loss: 3828456.2500; val_optim_loss: 3828456.2500
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9836; val_auprc_score: 0.9765; val_best_acc_score: 0.9508; val_best_f1_score: 0.9524; train_kl_reg_loss: 25270.2010; train_edge_recon_loss: 2610434.9722; train_gene_expr_recon_loss: 455189.1632; train_masked_gp_l1_reg_loss: 8235.0864; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714202.0694; train_global_loss: 3813331.5278; train_optim_loss: 3813331.5278; val_kl_reg_loss: 22156.0508; val_edge_recon_loss: 2638155.7500; val_gene_expr_recon_loss: 458169.9375; val_masked_gp_l1_reg_loss: 8236.4150; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713819.6250; val_global_loss: 3840538.0000; val_optim_loss: 3840538.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9858; val_auprc_score: 0.9811; val_best_acc_score: 0.9531; val_best_f1_score: 0.9539; train_kl_reg_loss: 25364.5247; train_edge_recon_loss: 2608661.5833; train_gene_expr_recon_loss: 455105.1736; train_masked_gp_l1_reg_loss: 8228.5534; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714155.4444; train_global_loss: 3811515.2222; train_optim_loss: 3811515.2222; val_kl_reg_loss: 22136.3594; val_edge_recon_loss: 2645465.5000; val_gene_expr_recon_loss: 458174.0625; val_masked_gp_l1_reg_loss: 8222.0029; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713733.7500; val_global_loss: 3847731.5000; val_optim_loss: 3847731.5000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9854; val_auprc_score: 0.9782; val_best_acc_score: 0.9523; val_best_f1_score: 0.9534; train_kl_reg_loss: 25307.1847; train_edge_recon_loss: 2609348.3333; train_gene_expr_recon_loss: 454132.4583; train_masked_gp_l1_reg_loss: 8220.4855; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712467.8194; train_global_loss: 3809476.2500; train_optim_loss: 3809476.2500; val_kl_reg_loss: 22122.0723; val_edge_recon_loss: 2629985.0000; val_gene_expr_recon_loss: 458163.6250; val_masked_gp_l1_reg_loss: 8218.2686; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713827.3750; val_global_loss: 3832316.0000; val_optim_loss: 3832316.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9848; val_auprc_score: 0.9785; val_best_acc_score: 0.9501; val_best_f1_score: 0.9518; train_kl_reg_loss: 25205.3012; train_edge_recon_loss: 2609736.8889; train_gene_expr_recon_loss: 453324.9306; train_masked_gp_l1_reg_loss: 8217.2331; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 708918.8681; train_global_loss: 3805403.1667; train_optim_loss: 3805403.1667; val_kl_reg_loss: 22143.9160; val_edge_recon_loss: 2630753.5000; val_gene_expr_recon_loss: 457980.6875; val_masked_gp_l1_reg_loss: 8216.2129; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713770.0625; val_global_loss: 3832864.5000; val_optim_loss: 3832864.5000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9878; val_auprc_score: 0.9826; val_best_acc_score: 0.9605; val_best_f1_score: 0.9612; train_kl_reg_loss: 25440.9898; train_edge_recon_loss: 2614042.0556; train_gene_expr_recon_loss: 455963.6910; train_masked_gp_l1_reg_loss: 8215.5928; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712788.6806; train_global_loss: 3816451.0556; train_optim_loss: 3816451.0556; val_kl_reg_loss: 22217.0664; val_edge_recon_loss: 2591017.0000; val_gene_expr_recon_loss: 457783.3125; val_masked_gp_l1_reg_loss: 8215.0596; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713706.7500; val_global_loss: 3792939.0000; val_optim_loss: 3792939.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9847; val_auprc_score: 0.9783; val_best_acc_score: 0.9514; val_best_f1_score: 0.9526; train_kl_reg_loss: 25340.2511; train_edge_recon_loss: 2612670.8611; train_gene_expr_recon_loss: 453642.9722; train_masked_gp_l1_reg_loss: 8214.9947; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712551.3264; train_global_loss: 3812420.3889; train_optim_loss: 3812420.3889; val_kl_reg_loss: 22155.8984; val_edge_recon_loss: 2644329.0000; val_gene_expr_recon_loss: 457785.7812; val_masked_gp_l1_reg_loss: 8214.7969; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713685.4375; val_global_loss: 3846171.0000; val_optim_loss: 3846171.0000
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9868; val_auprc_score: 0.9819; val_best_acc_score: 0.9539; val_best_f1_score: 0.9546; train_kl_reg_loss: 25335.4685; train_edge_recon_loss: 2613160.8333; train_gene_expr_recon_loss: 453504.9826; train_masked_gp_l1_reg_loss: 8214.7862; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711380.2222; train_global_loss: 3811596.2500; train_optim_loss: 3811596.2500; val_kl_reg_loss: 22235.4766; val_edge_recon_loss: 2625035.0000; val_gene_expr_recon_loss: 457711.7188; val_masked_gp_l1_reg_loss: 8214.7373; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713671.9375; val_global_loss: 3826869.0000; val_optim_loss: 3826869.0000
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9842; val_auprc_score: 0.9764; val_best_acc_score: 0.9510; val_best_f1_score: 0.9522; train_kl_reg_loss: 25323.8876; train_edge_recon_loss: 2605007.4722; train_gene_expr_recon_loss: 451433.3507; train_masked_gp_l1_reg_loss: 8214.7696; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711633.7153; train_global_loss: 3801613.1111; train_optim_loss: 3801613.1111; val_kl_reg_loss: 22200.8516; val_edge_recon_loss: 2624133.0000; val_gene_expr_recon_loss: 457706.5625; val_masked_gp_l1_reg_loss: 8214.7666; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713742.1250; val_global_loss: 3825997.0000; val_optim_loss: 3825997.0000
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9835; val_auprc_score: 0.9760; val_best_acc_score: 0.9499; val_best_f1_score: 0.9515; train_kl_reg_loss: 25341.6625; train_edge_recon_loss: 2607980.1111; train_gene_expr_recon_loss: 453084.6597; train_masked_gp_l1_reg_loss: 8214.8366; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 710473.6736; train_global_loss: 3805094.8611; train_optim_loss: 3805094.8611; val_kl_reg_loss: 22321.3633; val_edge_recon_loss: 2633638.7500; val_gene_expr_recon_loss: 457736.2500; val_masked_gp_l1_reg_loss: 8214.9150; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713739.3125; val_global_loss: 3835650.5000; val_optim_loss: 3835650.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9841; val_auprc_score: 0.9772; val_best_acc_score: 0.9542; val_best_f1_score: 0.9555; train_kl_reg_loss: 25319.4208; train_edge_recon_loss: 2618217.5000; train_gene_expr_recon_loss: 452483.6771; train_masked_gp_l1_reg_loss: 8214.1111; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711421.7014; train_global_loss: 3815656.3333; train_optim_loss: 3815656.3333; val_kl_reg_loss: 22286.1875; val_edge_recon_loss: 2621379.2500; val_gene_expr_recon_loss: 457736.4688; val_masked_gp_l1_reg_loss: 8213.3945; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713731.6875; val_global_loss: 3823347.2500; val_optim_loss: 3823347.2500
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9842; val_auprc_score: 0.9754; val_best_acc_score: 0.9528; val_best_f1_score: 0.9539; train_kl_reg_loss: 25426.4913; train_edge_recon_loss: 2607624.5556; train_gene_expr_recon_loss: 452941.6111; train_masked_gp_l1_reg_loss: 8213.2598; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711817.5486; train_global_loss: 3806023.4722; train_optim_loss: 3806023.4722; val_kl_reg_loss: 22207.9297; val_edge_recon_loss: 2627929.5000; val_gene_expr_recon_loss: 457732.9375; val_masked_gp_l1_reg_loss: 8213.0312; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713605.6875; val_global_loss: 3829689.2500; val_optim_loss: 3829689.2500
Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9829; val_auprc_score: 0.9732; val_best_acc_score: 0.9522; val_best_f1_score: 0.9536; train_kl_reg_loss: 25341.2211; train_edge_recon_loss: 2622513.9444; train_gene_expr_recon_loss: 453970.6701; train_masked_gp_l1_reg_loss: 8212.9196; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714218.5000; train_global_loss: 3824257.3056; train_optim_loss: 3824257.3056; val_kl_reg_loss: 22282.3691; val_edge_recon_loss: 2622297.0000; val_gene_expr_recon_loss: 457742.7500; val_masked_gp_l1_reg_loss: 8212.8096; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713755.1250; val_global_loss: 3824290.0000; val_optim_loss: 3824290.0000
Epoch 69/100 |█████████████-------| 69.0% val_auroc_score: 0.9841; val_auprc_score: 0.9753; val_best_acc_score: 0.9515; val_best_f1_score: 0.9527; train_kl_reg_loss: 25291.1057; train_edge_recon_loss: 2610917.3889; train_gene_expr_recon_loss: 451250.7083; train_masked_gp_l1_reg_loss: 8212.7530; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711853.8889; train_global_loss: 3807525.9167; train_optim_loss: 3807525.9167; val_kl_reg_loss: 22338.2773; val_edge_recon_loss: 2626824.7500; val_gene_expr_recon_loss: 457730.6250; val_masked_gp_l1_reg_loss: 8212.6934; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 713652.8125; val_global_loss: 3828759.0000; val_optim_loss: 3828759.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 30 sec.
Using best model state, which was in epoch 61.

--- MODEL EVALUATION ---
val AUROC score: 0.9847
val AUPRC score: 0.9766
val best accuracy score: 0.9524
val best F1 score: 0.9539
val target rna MSE score: 0.3714
val source rna MSE score: 0.2421
val target atac MSE score: 0.1344
val source atac MSE score: 0.0200
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
