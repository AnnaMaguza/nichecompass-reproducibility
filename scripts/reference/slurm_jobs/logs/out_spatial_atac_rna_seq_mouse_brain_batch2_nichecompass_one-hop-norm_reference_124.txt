[True]
Run timestamp: 26072023_033114_124.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_124']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9581; val_auprc_score: 0.9642; val_best_acc_score: 0.5022; val_best_f1_score: 0.6676; train_kl_reg_loss: 7840.2177; train_edge_recon_loss: 34713815.1111; train_gene_expr_recon_loss: 313376.4062; train_masked_gp_l1_reg_loss: 1595.1448; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108088464.0000; train_global_loss: 143125091.5556; train_optim_loss: 143125091.5556; val_kl_reg_loss: 50475.1875; val_edge_recon_loss: 40637532.0000; val_gene_expr_recon_loss: 312907.0938; val_masked_gp_l1_reg_loss: 1384.8914; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106898672.0000; val_global_loss: 147900976.0000; val_optim_loss: 147900976.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9271; val_auprc_score: 0.9344; val_best_acc_score: 0.5224; val_best_f1_score: 0.6765; train_kl_reg_loss: 32637.4000; train_edge_recon_loss: 34818593.7778; train_gene_expr_recon_loss: 301683.1806; train_masked_gp_l1_reg_loss: 1361.3126; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106846529.7778; train_global_loss: 142000805.3333; train_optim_loss: 142000805.3333; val_kl_reg_loss: 95685.9688; val_edge_recon_loss: 40633460.0000; val_gene_expr_recon_loss: 296350.2188; val_masked_gp_l1_reg_loss: 1384.4456; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 105267400.0000; val_global_loss: 146294272.0000; val_optim_loss: 146294272.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9132; val_auprc_score: 0.9190; val_best_acc_score: 0.5154; val_best_f1_score: 0.6734; train_kl_reg_loss: 76687.9601; train_edge_recon_loss: 34790300.8889; train_gene_expr_recon_loss: 284033.3611; train_masked_gp_l1_reg_loss: 1470.2961; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 105195530.6667; train_global_loss: 140348023.1111; train_optim_loss: 140348023.1111; val_kl_reg_loss: 84022.4844; val_edge_recon_loss: 40639116.0000; val_gene_expr_recon_loss: 279109.4062; val_masked_gp_l1_reg_loss: 1592.7002; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103215072.0000; val_global_loss: 144218912.0000; val_optim_loss: 144218912.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9222; val_auprc_score: 0.9285; val_best_acc_score: 0.5057; val_best_f1_score: 0.6691; train_kl_reg_loss: 176308.1753; train_edge_recon_loss: 34775275.1111; train_gene_expr_recon_loss: 267302.2465; train_masked_gp_l1_reg_loss: 1673.0336; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 103138200.0000; train_global_loss: 138358759.1111; train_optim_loss: 138358759.1111; val_kl_reg_loss: 165560.2969; val_edge_recon_loss: 40647680.0000; val_gene_expr_recon_loss: 261940.0156; val_masked_gp_l1_reg_loss: 1749.9889; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101578144.0000; val_global_loss: 142655072.0000; val_optim_loss: 142655072.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9187; val_auprc_score: 0.9212; val_best_acc_score: 0.5057; val_best_f1_score: 0.6692; train_kl_reg_loss: 237829.7847; train_edge_recon_loss: 34857501.7778; train_gene_expr_recon_loss: 251136.4358; train_masked_gp_l1_reg_loss: 1783.2944; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101302491.5556; train_global_loss: 136650744.8889; train_optim_loss: 136650744.8889; val_kl_reg_loss: 314762.9062; val_edge_recon_loss: 40649720.0000; val_gene_expr_recon_loss: 249838.7812; val_masked_gp_l1_reg_loss: 1811.9751; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100344272.0000; val_global_loss: 141560416.0000; val_optim_loss: 141560416.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9237; val_auprc_score: 0.9238; val_best_acc_score: 0.5070; val_best_f1_score: 0.6698; train_kl_reg_loss: 308924.5608; train_edge_recon_loss: 34812320.8889; train_gene_expr_recon_loss: 240541.1719; train_masked_gp_l1_reg_loss: 1815.9934; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99684548.4444; train_global_loss: 135048152.8889; train_optim_loss: 135048152.8889; val_kl_reg_loss: 207849.7188; val_edge_recon_loss: 40647616.0000; val_gene_expr_recon_loss: 241614.6719; val_masked_gp_l1_reg_loss: 1808.5344; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99139704.0000; val_global_loss: 140238592.0000; val_optim_loss: 140238592.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9187; val_auprc_score: 0.9182; val_best_acc_score: 0.5102; val_best_f1_score: 0.6712; train_kl_reg_loss: 339550.2639; train_edge_recon_loss: 34831326.6667; train_gene_expr_recon_loss: 233885.7899; train_masked_gp_l1_reg_loss: 1796.6265; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99146838.2222; train_global_loss: 134553398.2222; train_optim_loss: 134553398.2222; val_kl_reg_loss: 205737.6875; val_edge_recon_loss: 40645420.0000; val_gene_expr_recon_loss: 236285.2188; val_masked_gp_l1_reg_loss: 1773.7524; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98513400.0000; val_global_loss: 139602608.0000; val_optim_loss: 139602608.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9189; val_auprc_score: 0.9202; val_best_acc_score: 0.5127; val_best_f1_score: 0.6723; train_kl_reg_loss: 338545.8472; train_edge_recon_loss: 34876535.5556; train_gene_expr_recon_loss: 229474.7986; train_masked_gp_l1_reg_loss: 1753.2321; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98328688.8889; train_global_loss: 133774997.3333; train_optim_loss: 133774997.3333; val_kl_reg_loss: 268133.9062; val_edge_recon_loss: 40642796.0000; val_gene_expr_recon_loss: 231814.4688; val_masked_gp_l1_reg_loss: 1724.5781; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98082096.0000; val_global_loss: 139226560.0000; val_optim_loss: 139226560.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9176; val_auprc_score: 0.9174; val_best_acc_score: 0.5252; val_best_f1_score: 0.6781; train_kl_reg_loss: 327455.5069; train_edge_recon_loss: 34862038.2222; train_gene_expr_recon_loss: 225887.8976; train_masked_gp_l1_reg_loss: 1705.1730; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97950198.2222; train_global_loss: 133367286.2222; train_optim_loss: 133367286.2222; val_kl_reg_loss: 260509.5156; val_edge_recon_loss: 40634488.0000; val_gene_expr_recon_loss: 229217.1250; val_masked_gp_l1_reg_loss: 1678.0027; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97819912.0000; val_global_loss: 138945808.0000; val_optim_loss: 138945808.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9182; val_auprc_score: 0.9190; val_best_acc_score: 0.5315; val_best_f1_score: 0.6810; train_kl_reg_loss: 337844.2604; train_edge_recon_loss: 34862386.2222; train_gene_expr_recon_loss: 222883.4236; train_masked_gp_l1_reg_loss: 1659.2267; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97170070.2222; train_global_loss: 132594843.5556; train_optim_loss: 132594843.5556; val_kl_reg_loss: 249180.7500; val_edge_recon_loss: 40627268.0000; val_gene_expr_recon_loss: 227289.5625; val_masked_gp_l1_reg_loss: 1633.9148; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97460088.0000; val_global_loss: 138565456.0000; val_optim_loss: 138565456.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9147; val_auprc_score: 0.9119; val_best_acc_score: 0.5746; val_best_f1_score: 0.7011; train_kl_reg_loss: 329690.6424; train_edge_recon_loss: 34851116.4444; train_gene_expr_recon_loss: 222091.0260; train_masked_gp_l1_reg_loss: 1622.3100; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97433214.2222; train_global_loss: 132837734.2222; train_optim_loss: 132837734.2222; val_kl_reg_loss: 206901.4375; val_edge_recon_loss: 40609888.0000; val_gene_expr_recon_loss: 225820.2500; val_masked_gp_l1_reg_loss: 1605.5947; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97425784.0000; val_global_loss: 138470000.0000; val_optim_loss: 138470000.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9154; val_auprc_score: 0.9113; val_best_acc_score: 0.6165; val_best_f1_score: 0.7217; train_kl_reg_loss: 326628.1163; train_edge_recon_loss: 34890728.0000; train_gene_expr_recon_loss: 219965.7674; train_masked_gp_l1_reg_loss: 1598.9959; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97559827.5556; train_global_loss: 132998747.5556; train_optim_loss: 132998747.5556; val_kl_reg_loss: 236203.5938; val_edge_recon_loss: 40591868.0000; val_gene_expr_recon_loss: 223806.2812; val_masked_gp_l1_reg_loss: 1588.4900; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97137920.0000; val_global_loss: 138191392.0000; val_optim_loss: 138191392.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9222; val_auprc_score: 0.9174; val_best_acc_score: 0.6828; val_best_f1_score: 0.7569; train_kl_reg_loss: 311489.0590; train_edge_recon_loss: 34844329.7778; train_gene_expr_recon_loss: 218476.7257; train_masked_gp_l1_reg_loss: 1586.4049; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96917401.7778; train_global_loss: 132293283.5556; train_optim_loss: 132293283.5556; val_kl_reg_loss: 266554.5000; val_edge_recon_loss: 40564644.0000; val_gene_expr_recon_loss: 222393.1094; val_masked_gp_l1_reg_loss: 1578.2388; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96878592.0000; val_global_loss: 137933760.0000; val_optim_loss: 137933760.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9299; val_auprc_score: 0.9234; val_best_acc_score: 0.7697; val_best_f1_score: 0.8088; train_kl_reg_loss: 308986.6667; train_edge_recon_loss: 34848450.6667; train_gene_expr_recon_loss: 217518.4115; train_masked_gp_l1_reg_loss: 1574.3829; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96908432.8889; train_global_loss: 132284964.4444; train_optim_loss: 132284964.4444; val_kl_reg_loss: 227757.6875; val_edge_recon_loss: 40507204.0000; val_gene_expr_recon_loss: 221950.7188; val_masked_gp_l1_reg_loss: 1568.3220; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96762136.0000; val_global_loss: 137720608.0000; val_optim_loss: 137720608.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9294; val_auprc_score: 0.9208; val_best_acc_score: 0.8380; val_best_f1_score: 0.8533; train_kl_reg_loss: 304066.8872; train_edge_recon_loss: 34837608.8889; train_gene_expr_recon_loss: 217416.9688; train_masked_gp_l1_reg_loss: 1567.0582; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96782210.6667; train_global_loss: 132142870.2222; train_optim_loss: 132142870.2222; val_kl_reg_loss: 183865.6562; val_edge_recon_loss: 40391020.0000; val_gene_expr_recon_loss: 222034.3125; val_masked_gp_l1_reg_loss: 1562.1587; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96898800.0000; val_global_loss: 137697280.0000; val_optim_loss: 137697280.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9354; val_auprc_score: 0.9266; val_best_acc_score: 0.8624; val_best_f1_score: 0.8679; train_kl_reg_loss: 294807.8924; train_edge_recon_loss: 34823980.8889; train_gene_expr_recon_loss: 215482.5000; train_masked_gp_l1_reg_loss: 1564.5491; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96339423.1111; train_global_loss: 131675258.6667; train_optim_loss: 131675258.6667; val_kl_reg_loss: 286206.8125; val_edge_recon_loss: 40220660.0000; val_gene_expr_recon_loss: 220127.4062; val_masked_gp_l1_reg_loss: 1565.1086; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96644560.0000; val_global_loss: 137373120.0000; val_optim_loss: 137373120.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9313; val_auprc_score: 0.9233; val_best_acc_score: 0.8453; val_best_f1_score: 0.8385; train_kl_reg_loss: 279680.7448; train_edge_recon_loss: 34753211.1111; train_gene_expr_recon_loss: 215998.9601; train_masked_gp_l1_reg_loss: 1568.2308; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96555808.0000; train_global_loss: 131806265.7778; train_optim_loss: 131806265.7778; val_kl_reg_loss: 242945.5312; val_edge_recon_loss: 39718264.0000; val_gene_expr_recon_loss: 219890.3438; val_masked_gp_l1_reg_loss: 1568.8687; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96657280.0000; val_global_loss: 136839952.0000; val_optim_loss: 136839952.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9188; val_auprc_score: 0.9082; val_best_acc_score: 0.8263; val_best_f1_score: 0.8431; train_kl_reg_loss: 279164.5347; train_edge_recon_loss: 34577744.4444; train_gene_expr_recon_loss: 215079.8038; train_masked_gp_l1_reg_loss: 1571.1095; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96950133.3333; train_global_loss: 132023694.2222; train_optim_loss: 132023694.2222; val_kl_reg_loss: 218671.9375; val_edge_recon_loss: 38051316.0000; val_gene_expr_recon_loss: 221482.6719; val_masked_gp_l1_reg_loss: 1572.3269; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96662272.0000; val_global_loss: 135155312.0000; val_optim_loss: 135155312.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8970; val_auprc_score: 0.8897; val_best_acc_score: 0.7986; val_best_f1_score: 0.8187; train_kl_reg_loss: 221911.9583; train_edge_recon_loss: 34014044.8889; train_gene_expr_recon_loss: 216497.8681; train_masked_gp_l1_reg_loss: 1583.6607; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96805314.6667; train_global_loss: 131259353.7778; train_optim_loss: 131259353.7778; val_kl_reg_loss: 140712.7812; val_edge_recon_loss: 34371072.0000; val_gene_expr_recon_loss: 222861.8906; val_masked_gp_l1_reg_loss: 1598.5952; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96683368.0000; val_global_loss: 131419616.0000; val_optim_loss: 131419616.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8740; val_auprc_score: 0.8607; val_best_acc_score: 0.7758; val_best_f1_score: 0.7982; train_kl_reg_loss: 96659.9167; train_edge_recon_loss: 31651449.7778; train_gene_expr_recon_loss: 222858.5017; train_masked_gp_l1_reg_loss: 1625.9202; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96629577.7778; train_global_loss: 128602171.5556; train_optim_loss: 128602171.5556; val_kl_reg_loss: 113840.4219; val_edge_recon_loss: 29991824.0000; val_gene_expr_recon_loss: 231395.4531; val_masked_gp_l1_reg_loss: 1670.7881; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97333856.0000; val_global_loss: 127672584.0000; val_optim_loss: 127672584.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8753; val_auprc_score: 0.8647; val_best_acc_score: 0.7736; val_best_f1_score: 0.7981; train_kl_reg_loss: 186479.1441; train_edge_recon_loss: 29434749.7778; train_gene_expr_recon_loss: 227937.8073; train_masked_gp_l1_reg_loss: 1715.4551; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98031778.6667; train_global_loss: 127882660.4444; train_optim_loss: 127882660.4444; val_kl_reg_loss: 214678.8125; val_edge_recon_loss: 29500956.0000; val_gene_expr_recon_loss: 269971.3125; val_masked_gp_l1_reg_loss: 1774.8285; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96914464.0000; val_global_loss: 126901840.0000; val_optim_loss: 126901840.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8884; val_auprc_score: 0.8638; val_best_acc_score: 0.8056; val_best_f1_score: 0.8211; train_kl_reg_loss: 159595.7969; train_edge_recon_loss: 30475238.6667; train_gene_expr_recon_loss: 248687.5122; train_masked_gp_l1_reg_loss: 1835.8653; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97609899.5556; train_global_loss: 128495256.8889; train_optim_loss: 128495256.8889; val_kl_reg_loss: 110011.2031; val_edge_recon_loss: 31386108.0000; val_gene_expr_recon_loss: 230930.0469; val_masked_gp_l1_reg_loss: 1901.2131; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96957040.0000; val_global_loss: 128685992.0000; val_optim_loss: 128685992.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8779; val_auprc_score: 0.8640; val_best_acc_score: 0.7808; val_best_f1_score: 0.7996; train_kl_reg_loss: 129627.6267; train_edge_recon_loss: 30755954.2222; train_gene_expr_recon_loss: 227286.9132; train_masked_gp_l1_reg_loss: 1954.4288; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96572264.8889; train_global_loss: 127687088.0000; train_optim_loss: 127687088.0000; val_kl_reg_loss: 154862.0156; val_edge_recon_loss: 29693472.0000; val_gene_expr_recon_loss: 231156.7500; val_masked_gp_l1_reg_loss: 1997.2063; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96973104.0000; val_global_loss: 127054592.0000; val_optim_loss: 127054592.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8697; val_auprc_score: 0.8550; val_best_acc_score: 0.7763; val_best_f1_score: 0.7970; train_kl_reg_loss: 205067.6580; train_edge_recon_loss: 29316378.0000; train_gene_expr_recon_loss: 226183.4323; train_masked_gp_l1_reg_loss: 2012.1432; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96446482.6667; train_global_loss: 126196124.4444; train_optim_loss: 126196124.4444; val_kl_reg_loss: 223496.9375; val_edge_recon_loss: 29193574.0000; val_gene_expr_recon_loss: 227299.1875; val_masked_gp_l1_reg_loss: 2020.1060; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96685656.0000; val_global_loss: 126332048.0000; val_optim_loss: 126332048.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8720; val_auprc_score: 0.8563; val_best_acc_score: 0.7800; val_best_f1_score: 0.7961; train_kl_reg_loss: 250867.1007; train_edge_recon_loss: 28847524.0000; train_gene_expr_recon_loss: 220759.3003; train_masked_gp_l1_reg_loss: 2020.8502; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96117222.2222; train_global_loss: 125438393.7778; train_optim_loss: 125438393.7778; val_kl_reg_loss: 273453.1250; val_edge_recon_loss: 29153002.0000; val_gene_expr_recon_loss: 226207.9531; val_masked_gp_l1_reg_loss: 2021.5386; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96380080.0000; val_global_loss: 126034768.0000; val_optim_loss: 126034768.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8780; val_auprc_score: 0.8609; val_best_acc_score: 0.7809; val_best_f1_score: 0.8040; train_kl_reg_loss: 313804.2292; train_edge_recon_loss: 29873297.7778; train_gene_expr_recon_loss: 225290.2743; train_masked_gp_l1_reg_loss: 2040.2314; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96912448.8889; train_global_loss: 127326880.8889; train_optim_loss: 127326880.8889; val_kl_reg_loss: 88764.2656; val_edge_recon_loss: 29444612.0000; val_gene_expr_recon_loss: 230204.0938; val_masked_gp_l1_reg_loss: 2057.4717; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96858736.0000; val_global_loss: 126624376.0000; val_optim_loss: 126624376.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8794; val_auprc_score: 0.8591; val_best_acc_score: 0.7905; val_best_f1_score: 0.8096; train_kl_reg_loss: 358089.5174; train_edge_recon_loss: 29360917.7778; train_gene_expr_recon_loss: 224508.1233; train_masked_gp_l1_reg_loss: 2067.7946; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97144235.5556; train_global_loss: 127089819.5556; train_optim_loss: 127089819.5556; val_kl_reg_loss: 108451.9531; val_edge_recon_loss: 29084578.0000; val_gene_expr_recon_loss: 229569.2500; val_masked_gp_l1_reg_loss: 2077.3857; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96328728.0000; val_global_loss: 125753408.0000; val_optim_loss: 125753408.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8786; val_auprc_score: 0.8572; val_best_acc_score: 0.7914; val_best_f1_score: 0.8109; train_kl_reg_loss: 437145.3125; train_edge_recon_loss: 29113870.4444; train_gene_expr_recon_loss: 222036.7326; train_masked_gp_l1_reg_loss: 2084.6804; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96060526.2222; train_global_loss: 125835664.0000; train_optim_loss: 125835664.0000; val_kl_reg_loss: 133599.8281; val_edge_recon_loss: 28849428.0000; val_gene_expr_recon_loss: 228255.5312; val_masked_gp_l1_reg_loss: 2090.2959; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96404480.0000; val_global_loss: 125617856.0000; val_optim_loss: 125617856.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8810; val_auprc_score: 0.8576; val_best_acc_score: 0.8017; val_best_f1_score: 0.8161; train_kl_reg_loss: 468048.5104; train_edge_recon_loss: 28853803.1111; train_gene_expr_recon_loss: 222815.7569; train_masked_gp_l1_reg_loss: 2093.1718; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96259184.8889; train_global_loss: 125805946.6667; train_optim_loss: 125805946.6667; val_kl_reg_loss: 152893.8281; val_edge_recon_loss: 28953820.0000; val_gene_expr_recon_loss: 227825.4531; val_masked_gp_l1_reg_loss: 2095.1118; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96224416.0000; val_global_loss: 125561056.0000; val_optim_loss: 125561056.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8797; val_auprc_score: 0.8485; val_best_acc_score: 0.8027; val_best_f1_score: 0.8169; train_kl_reg_loss: 454411.1910; train_edge_recon_loss: 28564019.1111; train_gene_expr_recon_loss: 221823.6684; train_masked_gp_l1_reg_loss: 2097.8445; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95958315.5556; train_global_loss: 125200667.5556; train_optim_loss: 125200667.5556; val_kl_reg_loss: 157036.4062; val_edge_recon_loss: 28903986.0000; val_gene_expr_recon_loss: 226959.7969; val_masked_gp_l1_reg_loss: 2098.8589; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96006288.0000; val_global_loss: 125296368.0000; val_optim_loss: 125296368.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8890; val_auprc_score: 0.8539; val_best_acc_score: 0.8192; val_best_f1_score: 0.8327; train_kl_reg_loss: 426465.1979; train_edge_recon_loss: 28491106.8889; train_gene_expr_recon_loss: 222680.9618; train_masked_gp_l1_reg_loss: 2099.6733; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95823155.5556; train_global_loss: 124965508.4444; train_optim_loss: 124965508.4444; val_kl_reg_loss: 163368.2812; val_edge_recon_loss: 28137208.0000; val_gene_expr_recon_loss: 226637.7188; val_masked_gp_l1_reg_loss: 2099.1067; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96066248.0000; val_global_loss: 124595560.0000; val_optim_loss: 124595560.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8954; val_auprc_score: 0.8626; val_best_acc_score: 0.8262; val_best_f1_score: 0.8402; train_kl_reg_loss: 403489.8403; train_edge_recon_loss: 28381636.2222; train_gene_expr_recon_loss: 221968.6528; train_masked_gp_l1_reg_loss: 2100.5669; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96220827.5556; train_global_loss: 125230022.2222; train_optim_loss: 125230022.2222; val_kl_reg_loss: 157225.8281; val_edge_recon_loss: 27971324.0000; val_gene_expr_recon_loss: 225973.5781; val_masked_gp_l1_reg_loss: 2100.5432; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95886552.0000; val_global_loss: 124243176.0000; val_optim_loss: 124243176.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8980; val_auprc_score: 0.8680; val_best_acc_score: 0.8319; val_best_f1_score: 0.8447; train_kl_reg_loss: 374241.1771; train_edge_recon_loss: 28047426.0000; train_gene_expr_recon_loss: 219903.0833; train_masked_gp_l1_reg_loss: 2101.8252; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95624129.7778; train_global_loss: 124267801.7778; train_optim_loss: 124267801.7778; val_kl_reg_loss: 164344.9375; val_edge_recon_loss: 28267106.0000; val_gene_expr_recon_loss: 225640.8125; val_masked_gp_l1_reg_loss: 2102.8640; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95873608.0000; val_global_loss: 124532800.0000; val_optim_loss: 124532800.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9055; val_auprc_score: 0.8770; val_best_acc_score: 0.8399; val_best_f1_score: 0.8535; train_kl_reg_loss: 352841.5799; train_edge_recon_loss: 28067194.8889; train_gene_expr_recon_loss: 219905.5660; train_masked_gp_l1_reg_loss: 2105.4248; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95617758.2222; train_global_loss: 124259806.2222; train_optim_loss: 124259806.2222; val_kl_reg_loss: 167875.8750; val_edge_recon_loss: 28006450.0000; val_gene_expr_recon_loss: 225165.7812; val_masked_gp_l1_reg_loss: 2106.4187; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95817208.0000; val_global_loss: 124218808.0000; val_optim_loss: 124218808.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9050; val_auprc_score: 0.8679; val_best_acc_score: 0.8460; val_best_f1_score: 0.8567; train_kl_reg_loss: 340344.7674; train_edge_recon_loss: 27805184.0000; train_gene_expr_recon_loss: 220496.4149; train_masked_gp_l1_reg_loss: 2107.9665; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95744953.7778; train_global_loss: 124113085.3333; train_optim_loss: 124113085.3333; val_kl_reg_loss: 161475.6562; val_edge_recon_loss: 28059304.0000; val_gene_expr_recon_loss: 225357.5938; val_masked_gp_l1_reg_loss: 2109.8069; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95690696.0000; val_global_loss: 124138944.0000; val_optim_loss: 124138944.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9116; val_auprc_score: 0.8788; val_best_acc_score: 0.8514; val_best_f1_score: 0.8622; train_kl_reg_loss: 340755.4618; train_edge_recon_loss: 27804579.5556; train_gene_expr_recon_loss: 221028.4601; train_masked_gp_l1_reg_loss: 2113.9064; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96109513.7778; train_global_loss: 124477991.1111; train_optim_loss: 124477991.1111; val_kl_reg_loss: 160447.9062; val_edge_recon_loss: 27703390.0000; val_gene_expr_recon_loss: 225831.9375; val_masked_gp_l1_reg_loss: 2118.0059; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95805768.0000; val_global_loss: 123897552.0000; val_optim_loss: 123897552.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9170; val_auprc_score: 0.8847; val_best_acc_score: 0.8615; val_best_f1_score: 0.8705; train_kl_reg_loss: 336627.0451; train_edge_recon_loss: 27784023.1111; train_gene_expr_recon_loss: 219065.1302; train_masked_gp_l1_reg_loss: 2123.4018; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95829021.3333; train_global_loss: 124170861.3333; train_optim_loss: 124170861.3333; val_kl_reg_loss: 155906.9375; val_edge_recon_loss: 27563864.0000; val_gene_expr_recon_loss: 225035.4688; val_masked_gp_l1_reg_loss: 2128.1614; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95421048.0000; val_global_loss: 123367984.0000; val_optim_loss: 123367984.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9145; val_auprc_score: 0.8861; val_best_acc_score: 0.8580; val_best_f1_score: 0.8677; train_kl_reg_loss: 333990.5556; train_edge_recon_loss: 27714377.5556; train_gene_expr_recon_loss: 219688.3976; train_masked_gp_l1_reg_loss: 2133.1710; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95551239.1111; train_global_loss: 123821429.3333; train_optim_loss: 123821429.3333; val_kl_reg_loss: 151358.6875; val_edge_recon_loss: 27723524.0000; val_gene_expr_recon_loss: 224496.4062; val_masked_gp_l1_reg_loss: 2137.6846; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95639088.0000; val_global_loss: 123740608.0000; val_optim_loss: 123740608.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9188; val_auprc_score: 0.8940; val_best_acc_score: 0.8560; val_best_f1_score: 0.8673; train_kl_reg_loss: 342266.1076; train_edge_recon_loss: 27738429.3333; train_gene_expr_recon_loss: 219346.1007; train_masked_gp_l1_reg_loss: 2142.9173; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95765604.4444; train_global_loss: 124067788.4444; train_optim_loss: 124067788.4444; val_kl_reg_loss: 143896.2188; val_edge_recon_loss: 27893686.0000; val_gene_expr_recon_loss: 224127.9844; val_masked_gp_l1_reg_loss: 2148.4719; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95615776.0000; val_global_loss: 123879632.0000; val_optim_loss: 123879632.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9161; val_auprc_score: 0.8836; val_best_acc_score: 0.8591; val_best_f1_score: 0.8697; train_kl_reg_loss: 354894.2674; train_edge_recon_loss: 27680233.3333; train_gene_expr_recon_loss: 218297.1806; train_masked_gp_l1_reg_loss: 2153.0362; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95321628.4444; train_global_loss: 123577206.2222; train_optim_loss: 123577206.2222; val_kl_reg_loss: 141340.4062; val_edge_recon_loss: 27844188.0000; val_gene_expr_recon_loss: 224637.8125; val_masked_gp_l1_reg_loss: 2158.4297; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95526888.0000; val_global_loss: 123739216.0000; val_optim_loss: 123739216.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9237; val_auprc_score: 0.8970; val_best_acc_score: 0.8624; val_best_f1_score: 0.8722; train_kl_reg_loss: 359056.2326; train_edge_recon_loss: 27574026.2222; train_gene_expr_recon_loss: 218335.5764; train_masked_gp_l1_reg_loss: 2163.6876; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94997347.5556; train_global_loss: 123150929.7778; train_optim_loss: 123150929.7778; val_kl_reg_loss: 148941.0000; val_edge_recon_loss: 27563354.0000; val_gene_expr_recon_loss: 223798.0156; val_masked_gp_l1_reg_loss: 2168.4600; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95423736.0000; val_global_loss: 123362000.0000; val_optim_loss: 123362000.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9253; val_auprc_score: 0.8982; val_best_acc_score: 0.8632; val_best_f1_score: 0.8735; train_kl_reg_loss: 369962.0903; train_edge_recon_loss: 27617482.0000; train_gene_expr_recon_loss: 218459.9913; train_masked_gp_l1_reg_loss: 2172.7123; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95147704.8889; train_global_loss: 123355781.3333; train_optim_loss: 123355781.3333; val_kl_reg_loss: 159041.2500; val_edge_recon_loss: 27746702.0000; val_gene_expr_recon_loss: 223497.9688; val_masked_gp_l1_reg_loss: 2176.6572; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95423008.0000; val_global_loss: 123554424.0000; val_optim_loss: 123554424.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9193; val_auprc_score: 0.8986; val_best_acc_score: 0.8529; val_best_f1_score: 0.8628; train_kl_reg_loss: 382402.9132; train_edge_recon_loss: 27710853.7778; train_gene_expr_recon_loss: 288677.0122; train_masked_gp_l1_reg_loss: 2180.9961; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96179263.1111; train_global_loss: 124563377.7778; train_optim_loss: 124563377.7778; val_kl_reg_loss: 180488.2812; val_edge_recon_loss: 28999406.0000; val_gene_expr_recon_loss: 595460.0625; val_masked_gp_l1_reg_loss: 2187.1780; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95274864.0000; val_global_loss: 125052408.0000; val_optim_loss: 125052408.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9222; val_auprc_score: 0.8923; val_best_acc_score: 0.8678; val_best_f1_score: 0.8759; train_kl_reg_loss: 400516.9618; train_edge_recon_loss: 28291405.7778; train_gene_expr_recon_loss: 618951.8403; train_masked_gp_l1_reg_loss: 2215.3303; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95075203.5556; train_global_loss: 124388294.2222; train_optim_loss: 124388294.2222; val_kl_reg_loss: 136981.0625; val_edge_recon_loss: 28104032.0000; val_gene_expr_recon_loss: 546381.6875; val_masked_gp_l1_reg_loss: 2267.0225; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95483712.0000; val_global_loss: 124273376.0000; val_optim_loss: 124273376.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9242; val_auprc_score: 0.8965; val_best_acc_score: 0.8669; val_best_f1_score: 0.8747; train_kl_reg_loss: 348606.2882; train_edge_recon_loss: 27962744.4444; train_gene_expr_recon_loss: 442498.7326; train_masked_gp_l1_reg_loss: 2312.5449; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95824885.3333; train_global_loss: 124581047.1111; train_optim_loss: 124581047.1111; val_kl_reg_loss: 135451.2344; val_edge_recon_loss: 27709896.0000; val_gene_expr_recon_loss: 377470.0625; val_masked_gp_l1_reg_loss: 2361.2881; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95147984.0000; val_global_loss: 123373168.0000; val_optim_loss: 123373168.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9211; val_auprc_score: 0.8905; val_best_acc_score: 0.8654; val_best_f1_score: 0.8736; train_kl_reg_loss: 340065.8576; train_edge_recon_loss: 27788140.0000; train_gene_expr_recon_loss: 344772.5694; train_masked_gp_l1_reg_loss: 2360.9596; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94965662.2222; train_global_loss: 123441001.7778; train_optim_loss: 123441001.7778; val_kl_reg_loss: 136167.6094; val_edge_recon_loss: 27843928.0000; val_gene_expr_recon_loss: 359377.7812; val_masked_gp_l1_reg_loss: 2359.9326; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95094472.0000; val_global_loss: 123436304.0000; val_optim_loss: 123436304.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9225; val_auprc_score: 0.8916; val_best_acc_score: 0.8658; val_best_f1_score: 0.8742; train_kl_reg_loss: 337553.4132; train_edge_recon_loss: 27858541.7778; train_gene_expr_recon_loss: 331657.1944; train_masked_gp_l1_reg_loss: 2358.7025; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94877629.3333; train_global_loss: 123407739.5556; train_optim_loss: 123407739.5556; val_kl_reg_loss: 136634.7812; val_edge_recon_loss: 27826902.0000; val_gene_expr_recon_loss: 338704.5625; val_masked_gp_l1_reg_loss: 2356.6414; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95177040.0000; val_global_loss: 123481632.0000; val_optim_loss: 123481632.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9239; val_auprc_score: 0.8959; val_best_acc_score: 0.8677; val_best_f1_score: 0.8755; train_kl_reg_loss: 331535.8056; train_edge_recon_loss: 27660676.2222; train_gene_expr_recon_loss: 314694.8924; train_masked_gp_l1_reg_loss: 2354.8072; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95249944.8889; train_global_loss: 123559204.4444; train_optim_loss: 123559204.4444; val_kl_reg_loss: 137071.2188; val_edge_recon_loss: 27667708.0000; val_gene_expr_recon_loss: 327543.9375; val_masked_gp_l1_reg_loss: 2352.4663; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95190560.0000; val_global_loss: 123325232.0000; val_optim_loss: 123325232.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9272; val_auprc_score: 0.8998; val_best_acc_score: 0.8704; val_best_f1_score: 0.8804; train_kl_reg_loss: 328815.3785; train_edge_recon_loss: 27683210.8889; train_gene_expr_recon_loss: 306525.5799; train_masked_gp_l1_reg_loss: 2350.5946; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95127530.6667; train_global_loss: 123448432.0000; train_optim_loss: 123448432.0000; val_kl_reg_loss: 136543.8906; val_edge_recon_loss: 27597926.0000; val_gene_expr_recon_loss: 314863.6250; val_masked_gp_l1_reg_loss: 2348.2905; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94973768.0000; val_global_loss: 123025448.0000; val_optim_loss: 123025448.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9197; val_auprc_score: 0.8914; val_best_acc_score: 0.8610; val_best_f1_score: 0.8723; train_kl_reg_loss: 326472.8264; train_edge_recon_loss: 27645789.5556; train_gene_expr_recon_loss: 297700.6319; train_masked_gp_l1_reg_loss: 2346.6164; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94923372.4444; train_global_loss: 123195681.7778; train_optim_loss: 123195681.7778; val_kl_reg_loss: 137518.3750; val_edge_recon_loss: 27927968.0000; val_gene_expr_recon_loss: 309486.0312; val_masked_gp_l1_reg_loss: 2344.4697; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95080096.0000; val_global_loss: 123457408.0000; val_optim_loss: 123457408.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9184; val_auprc_score: 0.8860; val_best_acc_score: 0.8630; val_best_f1_score: 0.8739; train_kl_reg_loss: 323880.9549; train_edge_recon_loss: 27626786.2222; train_gene_expr_recon_loss: 292750.1042; train_masked_gp_l1_reg_loss: 2342.8555; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94923240.0000; train_global_loss: 123169000.8889; train_optim_loss: 123169000.8889; val_kl_reg_loss: 139122.6875; val_edge_recon_loss: 27624320.0000; val_gene_expr_recon_loss: 302856.0625; val_masked_gp_l1_reg_loss: 2340.7498; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95167192.0000; val_global_loss: 123235832.0000; val_optim_loss: 123235832.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9230; val_auprc_score: 0.8970; val_best_acc_score: 0.8646; val_best_f1_score: 0.8739; train_kl_reg_loss: 322784.5104; train_edge_recon_loss: 27558847.7778; train_gene_expr_recon_loss: 281086.0729; train_masked_gp_l1_reg_loss: 2339.0265; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95101528.8889; train_global_loss: 123266585.7778; train_optim_loss: 123266585.7778; val_kl_reg_loss: 139521.7812; val_edge_recon_loss: 27923732.0000; val_gene_expr_recon_loss: 293222.2188; val_masked_gp_l1_reg_loss: 2336.8550; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95089008.0000; val_global_loss: 123447824.0000; val_optim_loss: 123447824.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9260; val_auprc_score: 0.8948; val_best_acc_score: 0.8721; val_best_f1_score: 0.8804; train_kl_reg_loss: 322496.0903; train_edge_recon_loss: 27664408.6667; train_gene_expr_recon_loss: 278643.3194; train_masked_gp_l1_reg_loss: 2335.1660; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95194955.5556; train_global_loss: 123462839.1111; train_optim_loss: 123462839.1111; val_kl_reg_loss: 140849.8281; val_edge_recon_loss: 27504846.0000; val_gene_expr_recon_loss: 287460.8438; val_masked_gp_l1_reg_loss: 2333.0234; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95153840.0000; val_global_loss: 123089328.0000; val_optim_loss: 123089328.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9229; val_auprc_score: 0.8910; val_best_acc_score: 0.8705; val_best_f1_score: 0.8791; train_kl_reg_loss: 320693.1285; train_edge_recon_loss: 27677069.1111; train_gene_expr_recon_loss: 272252.8628; train_masked_gp_l1_reg_loss: 2332.6197; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95198406.2222; train_global_loss: 123470753.7778; train_optim_loss: 123470753.7778; val_kl_reg_loss: 141245.0312; val_edge_recon_loss: 27442598.0000; val_gene_expr_recon_loss: 285665.0625; val_masked_gp_l1_reg_loss: 2332.1812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95073760.0000; val_global_loss: 122945600.0000; val_optim_loss: 122945600.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9192; val_auprc_score: 0.8871; val_best_acc_score: 0.8634; val_best_f1_score: 0.8735; train_kl_reg_loss: 321949.8542; train_edge_recon_loss: 27606905.5556; train_gene_expr_recon_loss: 274431.5035; train_masked_gp_l1_reg_loss: 2331.9497; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95064879.1111; train_global_loss: 123270497.7778; train_optim_loss: 123270497.7778; val_kl_reg_loss: 140802.3438; val_edge_recon_loss: 27887410.0000; val_gene_expr_recon_loss: 287538.6562; val_masked_gp_l1_reg_loss: 2331.6396; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95101744.0000; val_global_loss: 123419824.0000; val_optim_loss: 123419824.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9192; val_auprc_score: 0.8862; val_best_acc_score: 0.8658; val_best_f1_score: 0.8737; train_kl_reg_loss: 320292.0382; train_edge_recon_loss: 27602452.8889; train_gene_expr_recon_loss: 270890.4809; train_masked_gp_l1_reg_loss: 2331.4094; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94639040.8889; train_global_loss: 122835009.7778; train_optim_loss: 122835009.7778; val_kl_reg_loss: 141049.8125; val_edge_recon_loss: 27812434.0000; val_gene_expr_recon_loss: 285876.7500; val_masked_gp_l1_reg_loss: 2331.1279; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95102432.0000; val_global_loss: 123344128.0000; val_optim_loss: 123344128.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9210; val_auprc_score: 0.8919; val_best_acc_score: 0.8639; val_best_f1_score: 0.8735; train_kl_reg_loss: 321843.1458; train_edge_recon_loss: 27655827.7778; train_gene_expr_recon_loss: 267261.3333; train_masked_gp_l1_reg_loss: 2330.9140; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94685393.7778; train_global_loss: 122932656.8889; train_optim_loss: 122932656.8889; val_kl_reg_loss: 141141.4844; val_edge_recon_loss: 27744544.0000; val_gene_expr_recon_loss: 284782.6875; val_masked_gp_l1_reg_loss: 2330.6526; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95121784.0000; val_global_loss: 123294584.0000; val_optim_loss: 123294584.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9236; val_auprc_score: 0.8933; val_best_acc_score: 0.8711; val_best_f1_score: 0.8807; train_kl_reg_loss: 320749.0069; train_edge_recon_loss: 27578760.0000; train_gene_expr_recon_loss: 271281.2517; train_masked_gp_l1_reg_loss: 2330.4513; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94891669.3333; train_global_loss: 123064789.3333; train_optim_loss: 123064789.3333; val_kl_reg_loss: 141396.7812; val_edge_recon_loss: 27497828.0000; val_gene_expr_recon_loss: 282835.3750; val_masked_gp_l1_reg_loss: 2330.1953; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95042184.0000; val_global_loss: 122966576.0000; val_optim_loss: 122966576.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9225; val_auprc_score: 0.8934; val_best_acc_score: 0.8669; val_best_f1_score: 0.8766; train_kl_reg_loss: 321169.9757; train_edge_recon_loss: 27644338.6667; train_gene_expr_recon_loss: 269979.6944; train_masked_gp_l1_reg_loss: 2330.1500; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94726443.5556; train_global_loss: 122964260.4444; train_optim_loss: 122964260.4444; val_kl_reg_loss: 142031.9062; val_edge_recon_loss: 27459196.0000; val_gene_expr_recon_loss: 285591.0312; val_masked_gp_l1_reg_loss: 2330.1013; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95197632.0000; val_global_loss: 123086784.0000; val_optim_loss: 123086784.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9237; val_auprc_score: 0.8971; val_best_acc_score: 0.8651; val_best_f1_score: 0.8747; train_kl_reg_loss: 320127.8160; train_edge_recon_loss: 27710873.1111; train_gene_expr_recon_loss: 274593.0156; train_masked_gp_l1_reg_loss: 2330.0757; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94914854.2222; train_global_loss: 123222777.7778; train_optim_loss: 123222777.7778; val_kl_reg_loss: 142556.5000; val_edge_recon_loss: 27676302.0000; val_gene_expr_recon_loss: 285665.5938; val_masked_gp_l1_reg_loss: 2330.0417; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95265304.0000; val_global_loss: 123372160.0000; val_optim_loss: 123372160.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9208; val_auprc_score: 0.8882; val_best_acc_score: 0.8642; val_best_f1_score: 0.8739; train_kl_reg_loss: 322374.1771; train_edge_recon_loss: 27440836.0000; train_gene_expr_recon_loss: 270824.3559; train_masked_gp_l1_reg_loss: 2330.0179; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94900872.8889; train_global_loss: 122937237.3333; train_optim_loss: 122937237.3333; val_kl_reg_loss: 140680.8438; val_edge_recon_loss: 27860696.0000; val_gene_expr_recon_loss: 282984.8438; val_masked_gp_l1_reg_loss: 2329.9883; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94946776.0000; val_global_loss: 123233464.0000; val_optim_loss: 123233464.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9246; val_auprc_score: 0.8947; val_best_acc_score: 0.8689; val_best_f1_score: 0.8784; train_kl_reg_loss: 322308.5000; train_edge_recon_loss: 27646861.3333; train_gene_expr_recon_loss: 274312.5920; train_masked_gp_l1_reg_loss: 2329.9655; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95192550.2222; train_global_loss: 123438360.8889; train_optim_loss: 123438360.8889; val_kl_reg_loss: 141258.7812; val_edge_recon_loss: 27563020.0000; val_gene_expr_recon_loss: 284985.4375; val_masked_gp_l1_reg_loss: 2329.9375; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95199896.0000; val_global_loss: 123191488.0000; val_optim_loss: 123191488.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 21 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
Val AUROC score: 0.9146
Val AUPRC score: 0.8817
Val best accuracy score: 0.8569
Val best F1 score: 0.8688
Val gene expr MSE score: 17.2270
Val chrom access MSE score: 0.0860
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
