[True]
Run timestamp: 07092023_040252_257.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_257']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2363 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5088, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2363
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2363

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7896; val_auprc_score: 0.8031; val_best_acc_score: 0.5515; val_best_f1_score: 0.6873; train_kl_reg_loss: 63311.6778; train_edge_recon_loss: 3534994.3607; train_gene_expr_recon_loss: 12652999.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 656468.7190; train_chrom_access_recon_loss: 10609927.4580; train_global_loss: 27517702.2290; train_optim_loss: 27517702.2290; val_kl_reg_loss: 92683.9823; val_edge_recon_loss: 4062340.9000; val_gene_expr_recon_loss: 12064852.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 358766.0000; val_chrom_access_recon_loss: 10351125.4000; val_global_loss: 26929769.0667; val_optim_loss: 26929769.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8145; val_auprc_score: 0.8257; val_best_acc_score: 0.7200; val_best_f1_score: 0.7393; train_kl_reg_loss: 80936.8773; train_edge_recon_loss: 3509219.7939; train_gene_expr_recon_loss: 11780818.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221295.2889; train_chrom_access_recon_loss: 10152338.2748; train_global_loss: 25744608.4733; train_optim_loss: 25744608.4733; val_kl_reg_loss: 64590.6565; val_edge_recon_loss: 4034052.0500; val_gene_expr_recon_loss: 11861314.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134419.2344; val_chrom_access_recon_loss: 10272317.0000; val_global_loss: 26366693.7333; val_optim_loss: 26366693.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8921; val_auprc_score: 0.8863; val_best_acc_score: 0.8161; val_best_f1_score: 0.8245; train_kl_reg_loss: 60471.6401; train_edge_recon_loss: 3443176.4447; train_gene_expr_recon_loss: 11589272.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100899.4649; train_chrom_access_recon_loss: 10014017.3206; train_global_loss: 25207837.0992; train_optim_loss: 25207837.0992; val_kl_reg_loss: 44949.7724; val_edge_recon_loss: 3214045.2500; val_gene_expr_recon_loss: 11701172.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79741.3594; val_chrom_access_recon_loss: 10128500.3333; val_global_loss: 25168408.5333; val_optim_loss: 25168408.5333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9158; val_auprc_score: 0.9007; val_best_acc_score: 0.8433; val_best_f1_score: 0.8530; train_kl_reg_loss: 75489.4250; train_edge_recon_loss: 2928412.9924; train_gene_expr_recon_loss: 11454654.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68069.0810; train_chrom_access_recon_loss: 9899586.3664; train_global_loss: 24426212.5191; train_optim_loss: 24426212.5191; val_kl_reg_loss: 88237.0583; val_edge_recon_loss: 2871202.2500; val_gene_expr_recon_loss: 11530797.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58168.7734; val_chrom_access_recon_loss: 9982745.2667; val_global_loss: 24531151.6000; val_optim_loss: 24531151.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9258; val_auprc_score: 0.9080; val_best_acc_score: 0.8627; val_best_f1_score: 0.8707; train_kl_reg_loss: 85200.7357; train_edge_recon_loss: 2828977.8702; train_gene_expr_recon_loss: 11321770.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51904.6646; train_chrom_access_recon_loss: 9807322.4046; train_global_loss: 24095176.0458; train_optim_loss: 24095176.0458; val_kl_reg_loss: 79512.5594; val_edge_recon_loss: 2802704.7667; val_gene_expr_recon_loss: 11394501.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46921.1836; val_chrom_access_recon_loss: 9872537.4000; val_global_loss: 24196177.8667; val_optim_loss: 24196177.8667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9341; val_auprc_score: 0.9208; val_best_acc_score: 0.8658; val_best_f1_score: 0.8733; train_kl_reg_loss: 82151.4574; train_edge_recon_loss: 2801167.7939; train_gene_expr_recon_loss: 11211424.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43205.5650; train_chrom_access_recon_loss: 9716976.2443; train_global_loss: 23854925.3740; train_optim_loss: 23854925.3740; val_kl_reg_loss: 78551.6651; val_edge_recon_loss: 2800697.5167; val_gene_expr_recon_loss: 11298213.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40311.9922; val_chrom_access_recon_loss: 9808908.8000; val_global_loss: 24026683.3333; val_optim_loss: 24026683.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9401; val_auprc_score: 0.9240; val_best_acc_score: 0.8778; val_best_f1_score: 0.8855; train_kl_reg_loss: 80058.2087; train_edge_recon_loss: 2786136.3950; train_gene_expr_recon_loss: 11129467.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38268.5307; train_chrom_access_recon_loss: 9648232.6794; train_global_loss: 23682163.0687; train_optim_loss: 23682163.0687; val_kl_reg_loss: 78353.2891; val_edge_recon_loss: 2785709.6833; val_gene_expr_recon_loss: 11232652.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36867.4883; val_chrom_access_recon_loss: 9741556.1333; val_global_loss: 23875138.9333; val_optim_loss: 23875138.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9441; val_auprc_score: 0.9325; val_best_acc_score: 0.8771; val_best_f1_score: 0.8837; train_kl_reg_loss: 76614.6401; train_edge_recon_loss: 2767062.9332; train_gene_expr_recon_loss: 11045077.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35575.9354; train_chrom_access_recon_loss: 9572339.2977; train_global_loss: 23496670.6412; train_optim_loss: 23496670.6412; val_kl_reg_loss: 74621.6536; val_edge_recon_loss: 2773481.7667; val_gene_expr_recon_loss: 11152665.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34559.7930; val_chrom_access_recon_loss: 9647193.9333; val_global_loss: 23682522.8000; val_optim_loss: 23682522.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9489; val_auprc_score: 0.9372; val_best_acc_score: 0.8871; val_best_f1_score: 0.8939; train_kl_reg_loss: 73525.8987; train_edge_recon_loss: 2750324.8950; train_gene_expr_recon_loss: 10965593.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33777.7527; train_chrom_access_recon_loss: 9504545.5725; train_global_loss: 23327767.3893; train_optim_loss: 23327767.3893; val_kl_reg_loss: 73334.2557; val_edge_recon_loss: 2726163.3333; val_gene_expr_recon_loss: 11071326.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32957.3984; val_chrom_access_recon_loss: 9596083.2000; val_global_loss: 23499863.8667; val_optim_loss: 23499863.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9530; val_auprc_score: 0.9405; val_best_acc_score: 0.8933; val_best_f1_score: 0.8971; train_kl_reg_loss: 71597.7603; train_edge_recon_loss: 2729459.7939; train_gene_expr_recon_loss: 10898785.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32533.5299; train_chrom_access_recon_loss: 9446455.3893; train_global_loss: 23178831.6031; train_optim_loss: 23178831.6031; val_kl_reg_loss: 70643.4315; val_edge_recon_loss: 2740753.1500; val_gene_expr_recon_loss: 11000622.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32125.6738; val_chrom_access_recon_loss: 9491867.0667; val_global_loss: 23336011.8667; val_optim_loss: 23336011.8667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9544; val_auprc_score: 0.9392; val_best_acc_score: 0.8989; val_best_f1_score: 0.9025; train_kl_reg_loss: 68573.9374; train_edge_recon_loss: 2724079.1221; train_gene_expr_recon_loss: 10844477.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31683.1799; train_chrom_access_recon_loss: 9397441.5649; train_global_loss: 23066255.7099; train_optim_loss: 23066255.7099; val_kl_reg_loss: 68871.5818; val_edge_recon_loss: 2724802.4000; val_gene_expr_recon_loss: 10951292.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31415.7969; val_chrom_access_recon_loss: 9460539.1333; val_global_loss: 23236921.3333; val_optim_loss: 23236921.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9569; val_auprc_score: 0.9445; val_best_acc_score: 0.8992; val_best_f1_score: 0.9030; train_kl_reg_loss: 67856.7524; train_edge_recon_loss: 2721376.2443; train_gene_expr_recon_loss: 10790459.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31020.1240; train_chrom_access_recon_loss: 9347616.5038; train_global_loss: 22958329.2672; train_optim_loss: 22958329.2672; val_kl_reg_loss: 67430.5234; val_edge_recon_loss: 2726740.9833; val_gene_expr_recon_loss: 10879086.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30788.7793; val_chrom_access_recon_loss: 9425718.1333; val_global_loss: 23129764.8000; val_optim_loss: 23129764.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9575; val_auprc_score: 0.9458; val_best_acc_score: 0.8976; val_best_f1_score: 0.9033; train_kl_reg_loss: 66965.9462; train_edge_recon_loss: 2718209.1393; train_gene_expr_recon_loss: 10741253.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30633.9373; train_chrom_access_recon_loss: 9304087.5038; train_global_loss: 22861150.1069; train_optim_loss: 22861150.1069; val_kl_reg_loss: 64980.4242; val_edge_recon_loss: 2741475.5000; val_gene_expr_recon_loss: 10847279.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30386.2188; val_chrom_access_recon_loss: 9378284.0000; val_global_loss: 23062405.7333; val_optim_loss: 23062405.7333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9615; val_auprc_score: 0.9506; val_best_acc_score: 0.9037; val_best_f1_score: 0.9084; train_kl_reg_loss: 64983.7514; train_edge_recon_loss: 2709051.6450; train_gene_expr_recon_loss: 10699646.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30242.1202; train_chrom_access_recon_loss: 9265043.8282; train_global_loss: 22768967.8321; train_optim_loss: 22768967.8321; val_kl_reg_loss: 64932.4466; val_edge_recon_loss: 2714082.8167; val_gene_expr_recon_loss: 10809595.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30227.8691; val_chrom_access_recon_loss: 9354705.2000; val_global_loss: 22973544.6667; val_optim_loss: 22973544.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9641; val_auprc_score: 0.9544; val_best_acc_score: 0.9092; val_best_f1_score: 0.9130; train_kl_reg_loss: 64231.6281; train_edge_recon_loss: 2697736.7863; train_gene_expr_recon_loss: 10654033.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30060.9052; train_chrom_access_recon_loss: 9222769.4580; train_global_loss: 22668831.7710; train_optim_loss: 22668831.7710; val_kl_reg_loss: 61530.4844; val_edge_recon_loss: 2694952.8167; val_gene_expr_recon_loss: 10751822.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29901.3066; val_chrom_access_recon_loss: 9283887.6667; val_global_loss: 22822094.2667; val_optim_loss: 22822094.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9678; val_auprc_score: 0.9568; val_best_acc_score: 0.9165; val_best_f1_score: 0.9195; train_kl_reg_loss: 62295.2427; train_edge_recon_loss: 2699459.4198; train_gene_expr_recon_loss: 10632828.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29738.4383; train_chrom_access_recon_loss: 9209045.8168; train_global_loss: 22633367.6641; train_optim_loss: 22633367.6641; val_kl_reg_loss: 60375.8451; val_edge_recon_loss: 2698277.5500; val_gene_expr_recon_loss: 10767477.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29901.7734; val_chrom_access_recon_loss: 9330157.2667; val_global_loss: 22886189.7333; val_optim_loss: 22886189.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9658; val_auprc_score: 0.9532; val_best_acc_score: 0.9126; val_best_f1_score: 0.9148; train_kl_reg_loss: 61191.8592; train_edge_recon_loss: 2688028.9733; train_gene_expr_recon_loss: 10591075.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29654.3111; train_chrom_access_recon_loss: 9162043.0763; train_global_loss: 22531993.2824; train_optim_loss: 22531993.2824; val_kl_reg_loss: 59978.8328; val_edge_recon_loss: 2714084.3000; val_gene_expr_recon_loss: 10719784.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29595.9141; val_chrom_access_recon_loss: 9250296.3000; val_global_loss: 22773740.0000; val_optim_loss: 22773740.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9672; val_auprc_score: 0.9591; val_best_acc_score: 0.9188; val_best_f1_score: 0.9220; train_kl_reg_loss: 60015.2441; train_edge_recon_loss: 2684166.4084; train_gene_expr_recon_loss: 10552466.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29490.1778; train_chrom_access_recon_loss: 9129074.2099; train_global_loss: 22455212.3053; train_optim_loss: 22455212.3053; val_kl_reg_loss: 58576.7896; val_edge_recon_loss: 2704024.1500; val_gene_expr_recon_loss: 10650010.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29644.3418; val_chrom_access_recon_loss: 9256372.6000; val_global_loss: 22698627.8667; val_optim_loss: 22698627.8667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9713; val_auprc_score: 0.9620; val_best_acc_score: 0.9259; val_best_f1_score: 0.9284; train_kl_reg_loss: 58823.6515; train_edge_recon_loss: 2679849.3569; train_gene_expr_recon_loss: 10529892.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29472.8689; train_chrom_access_recon_loss: 9106614.4313; train_global_loss: 22404652.7176; train_optim_loss: 22404652.7176; val_kl_reg_loss: 58445.3492; val_edge_recon_loss: 2675240.9333; val_gene_expr_recon_loss: 10661673.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29498.0039; val_chrom_access_recon_loss: 9226654.0667; val_global_loss: 22651512.1333; val_optim_loss: 22651512.1333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9700; val_auprc_score: 0.9606; val_best_acc_score: 0.9213; val_best_f1_score: 0.9240; train_kl_reg_loss: 57686.3075; train_edge_recon_loss: 2680421.4599; train_gene_expr_recon_loss: 10502479.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29380.0178; train_chrom_access_recon_loss: 9075820.9313; train_global_loss: 22345788.2595; train_optim_loss: 22345788.2595; val_kl_reg_loss: 56949.1115; val_edge_recon_loss: 2698298.6667; val_gene_expr_recon_loss: 10602453.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29401.8125; val_chrom_access_recon_loss: 9120953.4000; val_global_loss: 22508056.9333; val_optim_loss: 22508056.9333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9729; val_auprc_score: 0.9614; val_best_acc_score: 0.9255; val_best_f1_score: 0.9280; train_kl_reg_loss: 56564.6785; train_edge_recon_loss: 2678445.6947; train_gene_expr_recon_loss: 10481084.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29294.8841; train_chrom_access_recon_loss: 9052806.1107; train_global_loss: 22298195.8015; train_optim_loss: 22298195.8015; val_kl_reg_loss: 54970.8539; val_edge_recon_loss: 2652192.9000; val_gene_expr_recon_loss: 10612143.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29520.3730; val_chrom_access_recon_loss: 9190100.4667; val_global_loss: 22538927.4667; val_optim_loss: 22538927.4667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9758; val_auprc_score: 0.9697; val_best_acc_score: 0.9272; val_best_f1_score: 0.9292; train_kl_reg_loss: 56706.0543; train_edge_recon_loss: 2666566.9637; train_gene_expr_recon_loss: 10459299.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29333.7821; train_chrom_access_recon_loss: 9031178.7748; train_global_loss: 22243085.1603; train_optim_loss: 22243085.1603; val_kl_reg_loss: 56173.4688; val_edge_recon_loss: 2672144.5500; val_gene_expr_recon_loss: 10546715.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29409.6504; val_chrom_access_recon_loss: 9109254.0667; val_global_loss: 22413696.9333; val_optim_loss: 22413696.9333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9729; val_auprc_score: 0.9657; val_best_acc_score: 0.9259; val_best_f1_score: 0.9283; train_kl_reg_loss: 54782.4924; train_edge_recon_loss: 2682125.7137; train_gene_expr_recon_loss: 10438063.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29360.9143; train_chrom_access_recon_loss: 9007000.8244; train_global_loss: 22211333.3893; train_optim_loss: 22211333.3893; val_kl_reg_loss: 53513.8148; val_edge_recon_loss: 2691623.7500; val_gene_expr_recon_loss: 10575117.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29564.4043; val_chrom_access_recon_loss: 9148651.7333; val_global_loss: 22498471.3333; val_optim_loss: 22498471.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9730; val_auprc_score: 0.9649; val_best_acc_score: 0.9255; val_best_f1_score: 0.9276; train_kl_reg_loss: 55122.9434; train_edge_recon_loss: 2664852.0782; train_gene_expr_recon_loss: 10417327.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29387.9062; train_chrom_access_recon_loss: 8991467.4389; train_global_loss: 22158157.9847; train_optim_loss: 22158157.9847; val_kl_reg_loss: 53449.3917; val_edge_recon_loss: 2689009.7000; val_gene_expr_recon_loss: 10546168.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29475.2754; val_chrom_access_recon_loss: 9109447.2000; val_global_loss: 22427549.0667; val_optim_loss: 22427549.0667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9779; val_auprc_score: 0.9722; val_best_acc_score: 0.9313; val_best_f1_score: 0.9333; train_kl_reg_loss: 54382.0186; train_edge_recon_loss: 2663206.4733; train_gene_expr_recon_loss: 10396305.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29453.7300; train_chrom_access_recon_loss: 8969170.3206; train_global_loss: 22112517.5115; train_optim_loss: 22112517.5115; val_kl_reg_loss: 53716.3612; val_edge_recon_loss: 2664106.8667; val_gene_expr_recon_loss: 10543714.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29498.8809; val_chrom_access_recon_loss: 9075973.1667; val_global_loss: 22367010.0000; val_optim_loss: 22367010.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9777; val_auprc_score: 0.9732; val_best_acc_score: 0.9268; val_best_f1_score: 0.9287; train_kl_reg_loss: 54139.3548; train_edge_recon_loss: 2675405.3034; train_gene_expr_recon_loss: 10299473.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25890.7051; train_chrom_access_recon_loss: 8943213.8779; train_global_loss: 21998123.0534; train_optim_loss: 21998123.0534; val_kl_reg_loss: 43332.5344; val_edge_recon_loss: 2693154.9500; val_gene_expr_recon_loss: 10407107.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25052.0762; val_chrom_access_recon_loss: 9023889.9333; val_global_loss: 22192536.8000; val_optim_loss: 22192536.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9755; val_auprc_score: 0.9690; val_best_acc_score: 0.9295; val_best_f1_score: 0.9326; train_kl_reg_loss: 53296.4292; train_edge_recon_loss: 2668424.9351; train_gene_expr_recon_loss: 10272799.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24963.2729; train_chrom_access_recon_loss: 8918428.1794; train_global_loss: 21937912.1527; train_optim_loss: 21937912.1527; val_kl_reg_loss: 44278.0646; val_edge_recon_loss: 2680269.3500; val_gene_expr_recon_loss: 10398869.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25024.9688; val_chrom_access_recon_loss: 9021624.8000; val_global_loss: 22170066.6667; val_optim_loss: 22170066.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9782; val_auprc_score: 0.9703; val_best_acc_score: 0.9351; val_best_f1_score: 0.9364; train_kl_reg_loss: 52033.3137; train_edge_recon_loss: 2659291.1145; train_gene_expr_recon_loss: 10248025.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24967.8206; train_chrom_access_recon_loss: 8893215.9160; train_global_loss: 21877533.6794; train_optim_loss: 21877533.6794; val_kl_reg_loss: 42700.6693; val_edge_recon_loss: 2653867.2000; val_gene_expr_recon_loss: 10377582.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24919.3828; val_chrom_access_recon_loss: 8980972.8333; val_global_loss: 22080042.1333; val_optim_loss: 22080042.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9788; val_auprc_score: 0.9733; val_best_acc_score: 0.9338; val_best_f1_score: 0.9354; train_kl_reg_loss: 51281.5239; train_edge_recon_loss: 2654454.7500; train_gene_expr_recon_loss: 10237156.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24988.6737; train_chrom_access_recon_loss: 8885452.7137; train_global_loss: 21853333.7863; train_optim_loss: 21853333.7863; val_kl_reg_loss: 40792.2453; val_edge_recon_loss: 2671181.8000; val_gene_expr_recon_loss: 10363514.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25039.4238; val_chrom_access_recon_loss: 9003707.0000; val_global_loss: 22104234.9333; val_optim_loss: 22104234.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9797; val_auprc_score: 0.9746; val_best_acc_score: 0.9326; val_best_f1_score: 0.9335; train_kl_reg_loss: 49768.1504; train_edge_recon_loss: 2657102.8359; train_gene_expr_recon_loss: 10221197.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25026.3182; train_chrom_access_recon_loss: 8874701.4008; train_global_loss: 21827796.2443; train_optim_loss: 21827796.2443; val_kl_reg_loss: 43674.2602; val_edge_recon_loss: 2665557.4167; val_gene_expr_recon_loss: 10349768.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24990.3594; val_chrom_access_recon_loss: 8976301.9333; val_global_loss: 22060292.4000; val_optim_loss: 22060292.4000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9785; val_auprc_score: 0.9723; val_best_acc_score: 0.9361; val_best_f1_score: 0.9382; train_kl_reg_loss: 48656.7733; train_edge_recon_loss: 2659169.1756; train_gene_expr_recon_loss: 10202012.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24995.0614; train_chrom_access_recon_loss: 8860503.0573; train_global_loss: 21795336.7481; train_optim_loss: 21795336.7481; val_kl_reg_loss: 39899.3820; val_edge_recon_loss: 2657808.1167; val_gene_expr_recon_loss: 10346004.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25069.7637; val_chrom_access_recon_loss: 8957111.2667; val_global_loss: 22025893.2000; val_optim_loss: 22025893.2000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9786; val_auprc_score: 0.9726; val_best_acc_score: 0.9320; val_best_f1_score: 0.9341; train_kl_reg_loss: 47459.5536; train_edge_recon_loss: 2654867.9198; train_gene_expr_recon_loss: 10195086.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25007.2522; train_chrom_access_recon_loss: 8856496.6450; train_global_loss: 21778917.4656; train_optim_loss: 21778917.4656; val_kl_reg_loss: 42441.3747; val_edge_recon_loss: 2658751.7167; val_gene_expr_recon_loss: 10358727.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25033.6172; val_chrom_access_recon_loss: 8986911.7333; val_global_loss: 22071865.8667; val_optim_loss: 22071865.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9786; val_auprc_score: 0.9728; val_best_acc_score: 0.9357; val_best_f1_score: 0.9373; train_kl_reg_loss: 47474.2760; train_edge_recon_loss: 2648236.5324; train_gene_expr_recon_loss: 10167001.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24970.9018; train_chrom_access_recon_loss: 8832740.7634; train_global_loss: 21720423.9084; train_optim_loss: 21720423.9084; val_kl_reg_loss: 40712.0654; val_edge_recon_loss: 2672272.7333; val_gene_expr_recon_loss: 10324949.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24924.8047; val_chrom_access_recon_loss: 8979070.4000; val_global_loss: 22041929.7333; val_optim_loss: 22041929.7333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9812; val_auprc_score: 0.9762; val_best_acc_score: 0.9402; val_best_f1_score: 0.9415; train_kl_reg_loss: 45936.7365; train_edge_recon_loss: 2653357.2939; train_gene_expr_recon_loss: 10147836.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24977.4055; train_chrom_access_recon_loss: 8828943.5267; train_global_loss: 21701051.4504; train_optim_loss: 21701051.4504; val_kl_reg_loss: 39487.1995; val_edge_recon_loss: 2651492.3500; val_gene_expr_recon_loss: 10300437.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24939.1465; val_chrom_access_recon_loss: 8939844.8000; val_global_loss: 21956200.8000; val_optim_loss: 21956200.8000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9817; val_auprc_score: 0.9739; val_best_acc_score: 0.9400; val_best_f1_score: 0.9417; train_kl_reg_loss: 45171.7292; train_edge_recon_loss: 2657865.4905; train_gene_expr_recon_loss: 10145401.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24968.2511; train_chrom_access_recon_loss: 8826671.4046; train_global_loss: 21700078.9313; train_optim_loss: 21700078.9313; val_kl_reg_loss: 39343.6305; val_edge_recon_loss: 2645281.2667; val_gene_expr_recon_loss: 10265941.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24940.1094; val_chrom_access_recon_loss: 8943940.1333; val_global_loss: 21919446.1333; val_optim_loss: 21919446.1333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9837; val_auprc_score: 0.9797; val_best_acc_score: 0.9435; val_best_f1_score: 0.9447; train_kl_reg_loss: 44787.5715; train_edge_recon_loss: 2647720.9332; train_gene_expr_recon_loss: 10134651.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24918.6784; train_chrom_access_recon_loss: 8816298.7863; train_global_loss: 21668377.9084; train_optim_loss: 21668377.9084; val_kl_reg_loss: 39272.3156; val_edge_recon_loss: 2660142.8500; val_gene_expr_recon_loss: 10265254.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24981.2266; val_chrom_access_recon_loss: 8924026.6000; val_global_loss: 21913676.9333; val_optim_loss: 21913676.9333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9842; val_auprc_score: 0.9786; val_best_acc_score: 0.9450; val_best_f1_score: 0.9462; train_kl_reg_loss: 44428.7196; train_edge_recon_loss: 2645262.6107; train_gene_expr_recon_loss: 10113035.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24961.2235; train_chrom_access_recon_loss: 8815331.4618; train_global_loss: 21643019.6183; train_optim_loss: 21643019.6183; val_kl_reg_loss: 39923.0620; val_edge_recon_loss: 2654181.8500; val_gene_expr_recon_loss: 10273192.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24905.5215; val_chrom_access_recon_loss: 8997017.6000; val_global_loss: 21989220.9333; val_optim_loss: 21989220.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9853; val_auprc_score: 0.9823; val_best_acc_score: 0.9445; val_best_f1_score: 0.9457; train_kl_reg_loss: 43663.0653; train_edge_recon_loss: 2641568.9160; train_gene_expr_recon_loss: 10099353.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24865.9012; train_chrom_access_recon_loss: 8807492.3931; train_global_loss: 21616944.1527; train_optim_loss: 21616944.1527; val_kl_reg_loss: 38891.2464; val_edge_recon_loss: 2650591.5667; val_gene_expr_recon_loss: 10224553.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24874.1426; val_chrom_access_recon_loss: 8906284.2667; val_global_loss: 21845194.5333; val_optim_loss: 21845194.5333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9815; val_auprc_score: 0.9748; val_best_acc_score: 0.9402; val_best_f1_score: 0.9418; train_kl_reg_loss: 42967.1527; train_edge_recon_loss: 2646337.3206; train_gene_expr_recon_loss: 10088908.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24849.6059; train_chrom_access_recon_loss: 8797307.1298; train_global_loss: 21600369.1756; train_optim_loss: 21600369.1756; val_kl_reg_loss: 39255.2911; val_edge_recon_loss: 2669528.6833; val_gene_expr_recon_loss: 10210975.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24874.1562; val_chrom_access_recon_loss: 8897201.2667; val_global_loss: 21841835.3333; val_optim_loss: 21841835.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9851; val_auprc_score: 0.9813; val_best_acc_score: 0.9483; val_best_f1_score: 0.9492; train_kl_reg_loss: 42002.3301; train_edge_recon_loss: 2651193.0782; train_gene_expr_recon_loss: 10085349.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24824.3238; train_chrom_access_recon_loss: 8795716.5420; train_global_loss: 21599086.1527; train_optim_loss: 21599086.1527; val_kl_reg_loss: 39078.7086; val_edge_recon_loss: 2649125.6500; val_gene_expr_recon_loss: 10223731.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24832.3594; val_chrom_access_recon_loss: 8895757.1333; val_global_loss: 21832525.0667; val_optim_loss: 21832525.0667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9832; val_auprc_score: 0.9789; val_best_acc_score: 0.9430; val_best_f1_score: 0.9446; train_kl_reg_loss: 41733.5475; train_edge_recon_loss: 2641783.6088; train_gene_expr_recon_loss: 10074143.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24803.7621; train_chrom_access_recon_loss: 8783551.7328; train_global_loss: 21566016.0611; train_optim_loss: 21566016.0611; val_kl_reg_loss: 38847.7659; val_edge_recon_loss: 2677658.0333; val_gene_expr_recon_loss: 10256013.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24869.1816; val_chrom_access_recon_loss: 8911585.2000; val_global_loss: 21908973.6000; val_optim_loss: 21908973.6000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9846; val_auprc_score: 0.9795; val_best_acc_score: 0.9489; val_best_f1_score: 0.9503; train_kl_reg_loss: 41553.6573; train_edge_recon_loss: 2645871.2214; train_gene_expr_recon_loss: 10063105.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24810.9458; train_chrom_access_recon_loss: 8764094.2481; train_global_loss: 21539435.6031; train_optim_loss: 21539435.6031; val_kl_reg_loss: 38000.3458; val_edge_recon_loss: 2654770.3833; val_gene_expr_recon_loss: 10213014.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24886.9434; val_chrom_access_recon_loss: 8881516.5333; val_global_loss: 21812189.2000; val_optim_loss: 21812189.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9845; val_auprc_score: 0.9792; val_best_acc_score: 0.9470; val_best_f1_score: 0.9489; train_kl_reg_loss: 40894.2274; train_edge_recon_loss: 2637162.0324; train_gene_expr_recon_loss: 10050535.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24789.4269; train_chrom_access_recon_loss: 8757810.8969; train_global_loss: 21511191.7099; train_optim_loss: 21511191.7099; val_kl_reg_loss: 38288.8591; val_edge_recon_loss: 2650910.7833; val_gene_expr_recon_loss: 10201878.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24877.8359; val_chrom_access_recon_loss: 8862999.5333; val_global_loss: 21778955.3333; val_optim_loss: 21778955.3333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9848; val_auprc_score: 0.9797; val_best_acc_score: 0.9479; val_best_f1_score: 0.9488; train_kl_reg_loss: 40729.8111; train_edge_recon_loss: 2642494.7233; train_gene_expr_recon_loss: 10025803.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24796.7147; train_chrom_access_recon_loss: 8739425.1107; train_global_loss: 21473249.4198; train_optim_loss: 21473249.4198; val_kl_reg_loss: 37557.7820; val_edge_recon_loss: 2634305.1000; val_gene_expr_recon_loss: 10177511.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24818.9160; val_chrom_access_recon_loss: 8882146.2000; val_global_loss: 21756339.3333; val_optim_loss: 21756339.3333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9862; val_auprc_score: 0.9812; val_best_acc_score: 0.9510; val_best_f1_score: 0.9520; train_kl_reg_loss: 40453.9838; train_edge_recon_loss: 2633379.3435; train_gene_expr_recon_loss: 10011033.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24811.5568; train_chrom_access_recon_loss: 8735771.0840; train_global_loss: 21445449.0840; train_optim_loss: 21445449.0840; val_kl_reg_loss: 36516.6167; val_edge_recon_loss: 2637227.0333; val_gene_expr_recon_loss: 10117473.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24848.5391; val_chrom_access_recon_loss: 8820497.5667; val_global_loss: 21636563.2000; val_optim_loss: 21636563.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9844; val_auprc_score: 0.9806; val_best_acc_score: 0.9450; val_best_f1_score: 0.9467; train_kl_reg_loss: 40029.8625; train_edge_recon_loss: 2640311.8569; train_gene_expr_recon_loss: 10001187.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24793.1663; train_chrom_access_recon_loss: 8727109.8282; train_global_loss: 21433431.8321; train_optim_loss: 21433431.8321; val_kl_reg_loss: 38212.9763; val_edge_recon_loss: 2650027.6167; val_gene_expr_recon_loss: 10142861.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24806.3438; val_chrom_access_recon_loss: 8853401.0667; val_global_loss: 21709308.8000; val_optim_loss: 21709308.8000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9841; val_auprc_score: 0.9804; val_best_acc_score: 0.9464; val_best_f1_score: 0.9478; train_kl_reg_loss: 39426.3176; train_edge_recon_loss: 2636093.2500; train_gene_expr_recon_loss: 9988615.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24813.3421; train_chrom_access_recon_loss: 8716690.0038; train_global_loss: 21405638.5038; train_optim_loss: 21405638.5038; val_kl_reg_loss: 38033.1010; val_edge_recon_loss: 2654064.9167; val_gene_expr_recon_loss: 10146888.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24930.5781; val_chrom_access_recon_loss: 8856978.6000; val_global_loss: 21720896.1333; val_optim_loss: 21720896.1333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9856; val_auprc_score: 0.9789; val_best_acc_score: 0.9530; val_best_f1_score: 0.9543; train_kl_reg_loss: 39274.9163; train_edge_recon_loss: 2631057.1355; train_gene_expr_recon_loss: 9980762.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24905.6813; train_chrom_access_recon_loss: 8709322.6031; train_global_loss: 21385323.0076; train_optim_loss: 21385323.0076; val_kl_reg_loss: 36591.3880; val_edge_recon_loss: 2647335.1667; val_gene_expr_recon_loss: 10133563.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24887.6992; val_chrom_access_recon_loss: 8827779.1667; val_global_loss: 21670157.3333; val_optim_loss: 21670157.3333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9885; val_auprc_score: 0.9851; val_best_acc_score: 0.9565; val_best_f1_score: 0.9574; train_kl_reg_loss: 38531.4655; train_edge_recon_loss: 2635688.3244; train_gene_expr_recon_loss: 9976836.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24949.7723; train_chrom_access_recon_loss: 8707212.4198; train_global_loss: 21383218.4427; train_optim_loss: 21383218.4427; val_kl_reg_loss: 36121.1091; val_edge_recon_loss: 2622258.2500; val_gene_expr_recon_loss: 10075398.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25022.1445; val_chrom_access_recon_loss: 8781910.2000; val_global_loss: 21540709.8667; val_optim_loss: 21540709.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9868; val_auprc_score: 0.9834; val_best_acc_score: 0.9492; val_best_f1_score: 0.9506; train_kl_reg_loss: 38291.2705; train_edge_recon_loss: 2631698.4256; train_gene_expr_recon_loss: 9965859.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25014.0525; train_chrom_access_recon_loss: 8688012.1641; train_global_loss: 21348875.6947; train_optim_loss: 21348875.6947; val_kl_reg_loss: 36991.7211; val_edge_recon_loss: 2655166.3167; val_gene_expr_recon_loss: 10106031.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24966.8008; val_chrom_access_recon_loss: 8822412.7333; val_global_loss: 21645569.6000; val_optim_loss: 21645569.6000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9867; val_auprc_score: 0.9829; val_best_acc_score: 0.9541; val_best_f1_score: 0.9548; train_kl_reg_loss: 38471.0696; train_edge_recon_loss: 2634133.2882; train_gene_expr_recon_loss: 9948553.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24995.5711; train_chrom_access_recon_loss: 8679648.8244; train_global_loss: 21325802.5191; train_optim_loss: 21325802.5191; val_kl_reg_loss: 36317.8198; val_edge_recon_loss: 2629796.4667; val_gene_expr_recon_loss: 10104953.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25015.8887; val_chrom_access_recon_loss: 8793637.4000; val_global_loss: 21589720.8000; val_optim_loss: 21589720.8000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9868; val_auprc_score: 0.9833; val_best_acc_score: 0.9563; val_best_f1_score: 0.9570; train_kl_reg_loss: 38134.0310; train_edge_recon_loss: 2626610.4065; train_gene_expr_recon_loss: 9939044.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25050.1457; train_chrom_access_recon_loss: 8663101.0802; train_global_loss: 21291939.7252; train_optim_loss: 21291939.7252; val_kl_reg_loss: 36643.6555; val_edge_recon_loss: 2636369.0000; val_gene_expr_recon_loss: 10112350.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25024.1738; val_chrom_access_recon_loss: 8796562.6333; val_global_loss: 21606950.0000; val_optim_loss: 21606950.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9887; val_auprc_score: 0.9862; val_best_acc_score: 0.9542; val_best_f1_score: 0.9552; train_kl_reg_loss: 37911.2329; train_edge_recon_loss: 2629885.6469; train_gene_expr_recon_loss: 9928358.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25106.3365; train_chrom_access_recon_loss: 8651906.4466; train_global_loss: 21273167.9084; train_optim_loss: 21273167.9084; val_kl_reg_loss: 35311.2102; val_edge_recon_loss: 2622774.9667; val_gene_expr_recon_loss: 10119413.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25089.4941; val_chrom_access_recon_loss: 8820976.9000; val_global_loss: 21623565.0667; val_optim_loss: 21623565.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9868; val_auprc_score: 0.9809; val_best_acc_score: 0.9526; val_best_f1_score: 0.9535; train_kl_reg_loss: 38316.1737; train_edge_recon_loss: 2626991.3225; train_gene_expr_recon_loss: 9909887.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23110.9611; train_chrom_access_recon_loss: 8643827.9466; train_global_loss: 21242134.0611; train_optim_loss: 21242134.0611; val_kl_reg_loss: 36634.9294; val_edge_recon_loss: 2646711.1333; val_gene_expr_recon_loss: 10058917.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22829.7383; val_chrom_access_recon_loss: 8768097.1333; val_global_loss: 21533191.0667; val_optim_loss: 21533191.0667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9854; val_auprc_score: 0.9772; val_best_acc_score: 0.9526; val_best_f1_score: 0.9538; train_kl_reg_loss: 38963.4586; train_edge_recon_loss: 2620538.1851; train_gene_expr_recon_loss: 9899974.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22741.2425; train_chrom_access_recon_loss: 8640964.1832; train_global_loss: 21223181.1450; train_optim_loss: 21223181.1450; val_kl_reg_loss: 36893.5693; val_edge_recon_loss: 2630958.1833; val_gene_expr_recon_loss: 10011463.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22682.5312; val_chrom_access_recon_loss: 8749893.4333; val_global_loss: 21451892.2667; val_optim_loss: 21451892.2667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9883; val_auprc_score: 0.9837; val_best_acc_score: 0.9561; val_best_f1_score: 0.9571; train_kl_reg_loss: 38825.5737; train_edge_recon_loss: 2627059.2844; train_gene_expr_recon_loss: 9905711.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22638.5701; train_chrom_access_recon_loss: 8647024.0038; train_global_loss: 21241258.8397; train_optim_loss: 21241258.8397; val_kl_reg_loss: 36494.9451; val_edge_recon_loss: 2622685.5333; val_gene_expr_recon_loss: 10085713.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22591.2910; val_chrom_access_recon_loss: 8789486.3000; val_global_loss: 21556970.9333; val_optim_loss: 21556970.9333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9889; val_auprc_score: 0.9868; val_best_acc_score: 0.9538; val_best_f1_score: 0.9551; train_kl_reg_loss: 38927.2564; train_edge_recon_loss: 2622207.3817; train_gene_expr_recon_loss: 9905866.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22564.8789; train_chrom_access_recon_loss: 8650320.3053; train_global_loss: 21239886.2137; train_optim_loss: 21239886.2137; val_kl_reg_loss: 36352.4656; val_edge_recon_loss: 2635461.1500; val_gene_expr_recon_loss: 10093023.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22527.4805; val_chrom_access_recon_loss: 8833855.8667; val_global_loss: 21621219.8667; val_optim_loss: 21621219.8667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9881; val_auprc_score: 0.9838; val_best_acc_score: 0.9526; val_best_f1_score: 0.9534; train_kl_reg_loss: 38883.5711; train_edge_recon_loss: 2622952.3053; train_gene_expr_recon_loss: 9909922.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22500.6128; train_chrom_access_recon_loss: 8649197.9924; train_global_loss: 21243457.0229; train_optim_loss: 21243457.0229; val_kl_reg_loss: 36477.4430; val_edge_recon_loss: 2651302.5333; val_gene_expr_recon_loss: 10081779.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22470.1543; val_chrom_access_recon_loss: 8800178.9333; val_global_loss: 21592208.1333; val_optim_loss: 21592208.1333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9864; val_auprc_score: 0.9830; val_best_acc_score: 0.9507; val_best_f1_score: 0.9521; train_kl_reg_loss: 38918.3573; train_edge_recon_loss: 2628629.0916; train_gene_expr_recon_loss: 9902824.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22444.5221; train_chrom_access_recon_loss: 8640275.1603; train_global_loss: 21233091.7099; train_optim_loss: 21233091.7099; val_kl_reg_loss: 36613.9982; val_edge_recon_loss: 2644374.9167; val_gene_expr_recon_loss: 10067181.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22419.5254; val_chrom_access_recon_loss: 8761957.8667; val_global_loss: 21532547.7333; val_optim_loss: 21532547.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9870; val_auprc_score: 0.9834; val_best_acc_score: 0.9550; val_best_f1_score: 0.9557; train_kl_reg_loss: 38974.8842; train_edge_recon_loss: 2625058.1622; train_gene_expr_recon_loss: 9901869.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22217.9787; train_chrom_access_recon_loss: 8642487.2481; train_global_loss: 21230607.3588; train_optim_loss: 21230607.3588; val_kl_reg_loss: 36747.7904; val_edge_recon_loss: 2633755.4667; val_gene_expr_recon_loss: 10104404.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22189.2363; val_chrom_access_recon_loss: 8795267.8667; val_global_loss: 21592364.5333; val_optim_loss: 21592364.5333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9876; val_auprc_score: 0.9828; val_best_acc_score: 0.9551; val_best_f1_score: 0.9561; train_kl_reg_loss: 39037.0635; train_edge_recon_loss: 2626402.0401; train_gene_expr_recon_loss: 9906509.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22179.8267; train_chrom_access_recon_loss: 8644472.0420; train_global_loss: 21238600.8702; train_optim_loss: 21238600.8702; val_kl_reg_loss: 36763.7646; val_edge_recon_loss: 2639370.2833; val_gene_expr_recon_loss: 10104550.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22172.0039; val_chrom_access_recon_loss: 8793846.9000; val_global_loss: 21596703.4667; val_optim_loss: 21596703.4667
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9883; val_auprc_score: 0.9833; val_best_acc_score: 0.9545; val_best_f1_score: 0.9556; train_kl_reg_loss: 38971.4147; train_edge_recon_loss: 2618466.1336; train_gene_expr_recon_loss: 9902443.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22166.8937; train_chrom_access_recon_loss: 8638618.1069; train_global_loss: 21220666.1069; train_optim_loss: 21220666.1069; val_kl_reg_loss: 36682.0013; val_edge_recon_loss: 2635184.4667; val_gene_expr_recon_loss: 10064317.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22161.8438; val_chrom_access_recon_loss: 8747860.9667; val_global_loss: 21506206.8000; val_optim_loss: 21506206.8000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9899; val_auprc_score: 0.9872; val_best_acc_score: 0.9570; val_best_f1_score: 0.9580; train_kl_reg_loss: 38952.8194; train_edge_recon_loss: 2623923.1641; train_gene_expr_recon_loss: 9900491.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22156.9008; train_chrom_access_recon_loss: 8644513.7901; train_global_loss: 21230038.3664; train_optim_loss: 21230038.3664; val_kl_reg_loss: 36663.3982; val_edge_recon_loss: 2623408.2333; val_gene_expr_recon_loss: 10082559.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22151.9648; val_chrom_access_recon_loss: 8753012.7667; val_global_loss: 21517795.8667; val_optim_loss: 21517795.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 75 min 21 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9860
val AUPRC score: 0.9819
val best accuracy score: 0.9530
val best F1 score: 0.9545
val target rna MSE score: 1.2107
val source rna MSE score: 0.2528
val target atac MSE score: 0.3417
val source atac MSE score: 0.0557
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
