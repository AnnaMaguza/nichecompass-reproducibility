[True]
Run timestamp: 10102023_120119_257.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_257']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7658; val_auprc_score: 0.7868; val_best_acc_score: 0.5768; val_best_f1_score: 0.6982; train_kl_reg_loss: 67786.6796; train_edge_recon_loss: 749211.3449; train_gene_expr_recon_loss: 22137152.2748; train_masked_gp_l1_reg_loss: 44301.3196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2897537.2538; train_chrom_access_recon_loss: 4757194.8473; train_global_loss: 30653183.7099; train_optim_loss: 30653183.7099; val_kl_reg_loss: 75343.1812; val_edge_recon_loss: 812250.9208; val_gene_expr_recon_loss: 21019224.2667; val_masked_gp_l1_reg_loss: 49293.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1073286.3750; val_chrom_access_recon_loss: 4532384.3000; val_global_loss: 27561782.8000; val_optim_loss: 27561782.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7969; val_auprc_score: 0.8070; val_best_acc_score: 0.7052; val_best_f1_score: 0.7233; train_kl_reg_loss: 69968.9981; train_edge_recon_loss: 732634.6651; train_gene_expr_recon_loss: 20910745.4046; train_masked_gp_l1_reg_loss: 50366.7834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 573068.9485; train_chrom_access_recon_loss: 4595719.7882; train_global_loss: 26932504.5954; train_optim_loss: 26932504.5954; val_kl_reg_loss: 71006.8583; val_edge_recon_loss: 807813.3833; val_gene_expr_recon_loss: 20674116.4000; val_masked_gp_l1_reg_loss: 51706.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 312714.9688; val_chrom_access_recon_loss: 4462062.8667; val_global_loss: 26379419.8667; val_optim_loss: 26379419.8667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8621; val_auprc_score: 0.8663; val_best_acc_score: 0.7433; val_best_f1_score: 0.7663; train_kl_reg_loss: 60320.2414; train_edge_recon_loss: 722827.1050; train_gene_expr_recon_loss: 20639412.2901; train_masked_gp_l1_reg_loss: 52948.8774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233695.6119; train_chrom_access_recon_loss: 4548923.3397; train_global_loss: 26258127.4809; train_optim_loss: 26258127.4809; val_kl_reg_loss: 57925.4164; val_edge_recon_loss: 786686.0208; val_gene_expr_recon_loss: 20361747.3333; val_masked_gp_l1_reg_loss: 54230.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185607.7812; val_chrom_access_recon_loss: 4417081.4000; val_global_loss: 25863278.1333; val_optim_loss: 25863278.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9191; val_auprc_score: 0.9085; val_best_acc_score: 0.8417; val_best_f1_score: 0.8493; train_kl_reg_loss: 54665.7335; train_edge_recon_loss: 702293.9981; train_gene_expr_recon_loss: 20361658.2137; train_masked_gp_l1_reg_loss: 55530.8810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163893.1467; train_chrom_access_recon_loss: 4497739.7691; train_global_loss: 25835781.6947; train_optim_loss: 25835781.6947; val_kl_reg_loss: 56046.9745; val_edge_recon_loss: 702330.9500; val_gene_expr_recon_loss: 20228144.8000; val_masked_gp_l1_reg_loss: 56825.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148912.9688; val_chrom_access_recon_loss: 4381392.7000; val_global_loss: 25573653.0667; val_optim_loss: 25573653.0667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9131; val_auprc_score: 0.8991; val_best_acc_score: 0.8362; val_best_f1_score: 0.8465; train_kl_reg_loss: 61327.4792; train_edge_recon_loss: 641509.4346; train_gene_expr_recon_loss: 20145839.2672; train_masked_gp_l1_reg_loss: 58135.4760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137695.3010; train_chrom_access_recon_loss: 4458640.2252; train_global_loss: 25503147.1450; train_optim_loss: 25503147.1450; val_kl_reg_loss: 66387.5023; val_edge_recon_loss: 626510.0125; val_gene_expr_recon_loss: 20075868.5333; val_masked_gp_l1_reg_loss: 59419.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128904.8438; val_chrom_access_recon_loss: 4353699.2333; val_global_loss: 25310789.2000; val_optim_loss: 25310789.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9274; val_auprc_score: 0.9155; val_best_acc_score: 0.8552; val_best_f1_score: 0.8655; train_kl_reg_loss: 66096.6548; train_edge_recon_loss: 611176.0577; train_gene_expr_recon_loss: 19972327.1908; train_masked_gp_l1_reg_loss: 60646.2616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119932.9048; train_chrom_access_recon_loss: 4423784.7767; train_global_loss: 25253963.8015; train_optim_loss: 25253963.8015; val_kl_reg_loss: 63360.5578; val_edge_recon_loss: 604481.9792; val_gene_expr_recon_loss: 19904124.0000; val_masked_gp_l1_reg_loss: 61579.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111576.7344; val_chrom_access_recon_loss: 4313208.9500; val_global_loss: 25058331.6000; val_optim_loss: 25058331.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9297; val_auprc_score: 0.9173; val_best_acc_score: 0.8531; val_best_f1_score: 0.8622; train_kl_reg_loss: 63335.8230; train_edge_recon_loss: 604295.8077; train_gene_expr_recon_loss: 19828925.8321; train_masked_gp_l1_reg_loss: 62546.8335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106384.3822; train_chrom_access_recon_loss: 4396323.9733; train_global_loss: 25061812.5191; train_optim_loss: 25061812.5191; val_kl_reg_loss: 59816.3003; val_edge_recon_loss: 606933.4250; val_gene_expr_recon_loss: 19710724.2667; val_masked_gp_l1_reg_loss: 63456.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102536.8984; val_chrom_access_recon_loss: 4297215.4000; val_global_loss: 24840681.0667; val_optim_loss: 24840681.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9332; val_auprc_score: 0.9218; val_best_acc_score: 0.8583; val_best_f1_score: 0.8677; train_kl_reg_loss: 61519.4448; train_edge_recon_loss: 598731.1536; train_gene_expr_recon_loss: 19718003.4351; train_masked_gp_l1_reg_loss: 64067.3420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99345.7038; train_chrom_access_recon_loss: 4368792.0802; train_global_loss: 24910459.2061; train_optim_loss: 24910459.2061; val_kl_reg_loss: 59783.8365; val_edge_recon_loss: 601697.2917; val_gene_expr_recon_loss: 19696336.5333; val_masked_gp_l1_reg_loss: 64758.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97204.8906; val_chrom_access_recon_loss: 4293521.2500; val_global_loss: 24813301.0667; val_optim_loss: 24813301.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9399; val_auprc_score: 0.9301; val_best_acc_score: 0.8657; val_best_f1_score: 0.8734; train_kl_reg_loss: 60089.7069; train_edge_recon_loss: 594543.9361; train_gene_expr_recon_loss: 19590654.5802; train_masked_gp_l1_reg_loss: 65235.2520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96355.5827; train_chrom_access_recon_loss: 4340637.9771; train_global_loss: 24747517.0687; train_optim_loss: 24747517.0687; val_kl_reg_loss: 57819.3091; val_edge_recon_loss: 598306.4042; val_gene_expr_recon_loss: 19592394.4000; val_masked_gp_l1_reg_loss: 65714.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94579.1406; val_chrom_access_recon_loss: 4244856.5000; val_global_loss: 24653670.6667; val_optim_loss: 24653670.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9434; val_auprc_score: 0.9319; val_best_acc_score: 0.8764; val_best_f1_score: 0.8826; train_kl_reg_loss: 58437.8532; train_edge_recon_loss: 590909.8535; train_gene_expr_recon_loss: 19506624.1832; train_masked_gp_l1_reg_loss: 66115.1290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93522.5132; train_chrom_access_recon_loss: 4322000.9733; train_global_loss: 24637610.5038; train_optim_loss: 24637610.5038; val_kl_reg_loss: 58666.1451; val_edge_recon_loss: 592421.3958; val_gene_expr_recon_loss: 19418036.0000; val_masked_gp_l1_reg_loss: 66622.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93990.6562; val_chrom_access_recon_loss: 4211199.9333; val_global_loss: 24440935.3333; val_optim_loss: 24440935.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9495; val_auprc_score: 0.9384; val_best_acc_score: 0.8849; val_best_f1_score: 0.8909; train_kl_reg_loss: 57432.2399; train_edge_recon_loss: 587344.9757; train_gene_expr_recon_loss: 19408704.7634; train_masked_gp_l1_reg_loss: 67085.4839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91793.7588; train_chrom_access_recon_loss: 4296519.3492; train_global_loss: 24508880.4122; train_optim_loss: 24508880.4122; val_kl_reg_loss: 56474.3076; val_edge_recon_loss: 588043.8292; val_gene_expr_recon_loss: 19278653.0667; val_masked_gp_l1_reg_loss: 67382.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91267.2344; val_chrom_access_recon_loss: 4191216.4333; val_global_loss: 24273037.8667; val_optim_loss: 24273037.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9535; val_auprc_score: 0.9436; val_best_acc_score: 0.8915; val_best_f1_score: 0.8945; train_kl_reg_loss: 56518.7392; train_edge_recon_loss: 585033.8158; train_gene_expr_recon_loss: 19319310.3817; train_masked_gp_l1_reg_loss: 67841.5738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89725.3588; train_chrom_access_recon_loss: 4275552.7195; train_global_loss: 24393982.6107; train_optim_loss: 24393982.6107; val_kl_reg_loss: 55208.5857; val_edge_recon_loss: 587177.3083; val_gene_expr_recon_loss: 19341239.0667; val_masked_gp_l1_reg_loss: 68275.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88980.1875; val_chrom_access_recon_loss: 4212184.8500; val_global_loss: 24353064.8000; val_optim_loss: 24353064.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9546; val_auprc_score: 0.9450; val_best_acc_score: 0.8913; val_best_f1_score: 0.8951; train_kl_reg_loss: 55617.3755; train_edge_recon_loss: 583345.8540; train_gene_expr_recon_loss: 19249695.1908; train_masked_gp_l1_reg_loss: 68620.3783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88439.8043; train_chrom_access_recon_loss: 4255435.9179; train_global_loss: 24301154.5496; train_optim_loss: 24301154.5496; val_kl_reg_loss: 54948.2091; val_edge_recon_loss: 584306.5917; val_gene_expr_recon_loss: 19196993.2000; val_masked_gp_l1_reg_loss: 69153.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87987.5234; val_chrom_access_recon_loss: 4164398.6167; val_global_loss: 24157788.6667; val_optim_loss: 24157788.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9605; val_auprc_score: 0.9493; val_best_acc_score: 0.9030; val_best_f1_score: 0.9065; train_kl_reg_loss: 54933.0196; train_edge_recon_loss: 580319.6350; train_gene_expr_recon_loss: 19167321.8473; train_masked_gp_l1_reg_loss: 69366.8792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87253.7587; train_chrom_access_recon_loss: 4235491.1584; train_global_loss: 24194686.3359; train_optim_loss: 24194686.3359; val_kl_reg_loss: 53760.7159; val_edge_recon_loss: 582833.4583; val_gene_expr_recon_loss: 19169779.7333; val_masked_gp_l1_reg_loss: 69681.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86827.7734; val_chrom_access_recon_loss: 4160993.6333; val_global_loss: 24123877.3333; val_optim_loss: 24123877.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9590; val_auprc_score: 0.9486; val_best_acc_score: 0.8998; val_best_f1_score: 0.9031; train_kl_reg_loss: 54334.2909; train_edge_recon_loss: 579160.5687; train_gene_expr_recon_loss: 19139590.5344; train_masked_gp_l1_reg_loss: 70071.4507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86246.0468; train_chrom_access_recon_loss: 4219798.8836; train_global_loss: 24149201.6794; train_optim_loss: 24149201.6794; val_kl_reg_loss: 53518.8456; val_edge_recon_loss: 582552.8042; val_gene_expr_recon_loss: 19163938.5333; val_masked_gp_l1_reg_loss: 70428.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86166.2812; val_chrom_access_recon_loss: 4135112.1833; val_global_loss: 24091716.4000; val_optim_loss: 24091716.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9607; val_auprc_score: 0.9488; val_best_acc_score: 0.9073; val_best_f1_score: 0.9099; train_kl_reg_loss: 53577.3098; train_edge_recon_loss: 577291.3554; train_gene_expr_recon_loss: 19059247.2977; train_masked_gp_l1_reg_loss: 70845.4945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85536.5426; train_chrom_access_recon_loss: 4201173.8740; train_global_loss: 24047671.9542; train_optim_loss: 24047671.9542; val_kl_reg_loss: 54237.6630; val_edge_recon_loss: 578935.1375; val_gene_expr_recon_loss: 19062633.3333; val_masked_gp_l1_reg_loss: 71325.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85360.0156; val_chrom_access_recon_loss: 4117349.9333; val_global_loss: 23969841.8667; val_optim_loss: 23969841.8667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9607; val_auprc_score: 0.9530; val_best_acc_score: 0.9018; val_best_f1_score: 0.9046; train_kl_reg_loss: 53168.1285; train_edge_recon_loss: 577074.6603; train_gene_expr_recon_loss: 19000338.8702; train_masked_gp_l1_reg_loss: 71662.5151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84706.2474; train_chrom_access_recon_loss: 4182059.0115; train_global_loss: 23969009.2977; train_optim_loss: 23969009.2977; val_kl_reg_loss: 52597.9146; val_edge_recon_loss: 581860.9833; val_gene_expr_recon_loss: 19065183.2000; val_masked_gp_l1_reg_loss: 72035.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84695.8203; val_chrom_access_recon_loss: 4129029.5167; val_global_loss: 23985403.6000; val_optim_loss: 23985403.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9638; val_auprc_score: 0.9552; val_best_acc_score: 0.9065; val_best_f1_score: 0.9099; train_kl_reg_loss: 52899.8672; train_edge_recon_loss: 573613.3597; train_gene_expr_recon_loss: 18943585.8168; train_masked_gp_l1_reg_loss: 72494.8279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84465.2077; train_chrom_access_recon_loss: 4159966.9447; train_global_loss: 23887025.8473; train_optim_loss: 23887025.8473; val_kl_reg_loss: 52865.1240; val_edge_recon_loss: 578524.4167; val_gene_expr_recon_loss: 18956237.8667; val_masked_gp_l1_reg_loss: 72922.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84338.9688; val_chrom_access_recon_loss: 4091833.7833; val_global_loss: 23836721.3333; val_optim_loss: 23836721.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9673; val_auprc_score: 0.9590; val_best_acc_score: 0.9116; val_best_f1_score: 0.9151; train_kl_reg_loss: 51823.0376; train_edge_recon_loss: 574503.4031; train_gene_expr_recon_loss: 18903777.5267; train_masked_gp_l1_reg_loss: 73404.5586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84313.2719; train_chrom_access_recon_loss: 4144176.9466; train_global_loss: 23831998.7328; train_optim_loss: 23831998.7328; val_kl_reg_loss: 51803.1628; val_edge_recon_loss: 572965.6375; val_gene_expr_recon_loss: 18881503.8667; val_masked_gp_l1_reg_loss: 73912.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84405.2422; val_chrom_access_recon_loss: 4062872.3833; val_global_loss: 23727463.0667; val_optim_loss: 23727463.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9673; val_auprc_score: 0.9611; val_best_acc_score: 0.9109; val_best_f1_score: 0.9137; train_kl_reg_loss: 51765.2572; train_edge_recon_loss: 572582.1107; train_gene_expr_recon_loss: 18838186.5649; train_masked_gp_l1_reg_loss: 74386.7779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84373.6456; train_chrom_access_recon_loss: 4120702.2710; train_global_loss: 23741996.5649; train_optim_loss: 23741996.5649; val_kl_reg_loss: 51568.2961; val_edge_recon_loss: 575303.5042; val_gene_expr_recon_loss: 18855125.3333; val_masked_gp_l1_reg_loss: 74940.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84727.9609; val_chrom_access_recon_loss: 4042598.0167; val_global_loss: 23684263.0667; val_optim_loss: 23684263.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9660; val_auprc_score: 0.9580; val_best_acc_score: 0.9103; val_best_f1_score: 0.9127; train_kl_reg_loss: 51346.2102; train_edge_recon_loss: 574285.9275; train_gene_expr_recon_loss: 18803158.9618; train_masked_gp_l1_reg_loss: 75276.5795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84497.8318; train_chrom_access_recon_loss: 4100919.4427; train_global_loss: 23689485.1603; train_optim_loss: 23689485.1603; val_kl_reg_loss: 51014.2154; val_edge_recon_loss: 575537.4250; val_gene_expr_recon_loss: 18792275.8667; val_masked_gp_l1_reg_loss: 75622.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85316.9609; val_chrom_access_recon_loss: 4037233.8500; val_global_loss: 23616999.3333; val_optim_loss: 23616999.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9643; val_auprc_score: 0.9540; val_best_acc_score: 0.9107; val_best_f1_score: 0.9137; train_kl_reg_loss: 50992.5428; train_edge_recon_loss: 573902.4346; train_gene_expr_recon_loss: 18750613.2214; train_masked_gp_l1_reg_loss: 76112.4411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84887.9624; train_chrom_access_recon_loss: 4084253.1183; train_global_loss: 23620761.6183; train_optim_loss: 23620761.6183; val_kl_reg_loss: 49691.7076; val_edge_recon_loss: 575098.7208; val_gene_expr_recon_loss: 18777006.9333; val_masked_gp_l1_reg_loss: 76609.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84777.9766; val_chrom_access_recon_loss: 4014368.8167; val_global_loss: 23577553.7333; val_optim_loss: 23577553.7333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9654; val_auprc_score: 0.9554; val_best_acc_score: 0.9108; val_best_f1_score: 0.9137; train_kl_reg_loss: 51069.2773; train_edge_recon_loss: 574117.5229; train_gene_expr_recon_loss: 18708320.2137; train_masked_gp_l1_reg_loss: 76862.0085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85072.6858; train_chrom_access_recon_loss: 4065915.2519; train_global_loss: 23561357.0687; train_optim_loss: 23561357.0687; val_kl_reg_loss: 50278.6701; val_edge_recon_loss: 578062.6083; val_gene_expr_recon_loss: 18733017.7333; val_masked_gp_l1_reg_loss: 77406.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86550.7500; val_chrom_access_recon_loss: 4005958.7000; val_global_loss: 23531273.7333; val_optim_loss: 23531273.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9635; val_auprc_score: 0.9536; val_best_acc_score: 0.9142; val_best_f1_score: 0.9172; train_kl_reg_loss: 50867.3200; train_edge_recon_loss: 574295.1350; train_gene_expr_recon_loss: 18652033.0840; train_masked_gp_l1_reg_loss: 77788.4013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85902.7843; train_chrom_access_recon_loss: 4047515.1489; train_global_loss: 23488401.7405; train_optim_loss: 23488401.7405; val_kl_reg_loss: 51329.0266; val_edge_recon_loss: 572174.1042; val_gene_expr_recon_loss: 18718883.6000; val_masked_gp_l1_reg_loss: 78172.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85324.5859; val_chrom_access_recon_loss: 3987017.1500; val_global_loss: 23492899.8667; val_optim_loss: 23492899.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9643; val_auprc_score: 0.9557; val_best_acc_score: 0.9131; val_best_f1_score: 0.9174; train_kl_reg_loss: 50850.8728; train_edge_recon_loss: 573187.7500; train_gene_expr_recon_loss: 18583708.4885; train_masked_gp_l1_reg_loss: 78610.3653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85851.3823; train_chrom_access_recon_loss: 4023598.0172; train_global_loss: 23395806.9466; train_optim_loss: 23395806.9466; val_kl_reg_loss: 50839.1888; val_edge_recon_loss: 574565.2625; val_gene_expr_recon_loss: 18704018.1333; val_masked_gp_l1_reg_loss: 78946.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87085.8047; val_chrom_access_recon_loss: 3962871.4667; val_global_loss: 23458326.0000; val_optim_loss: 23458326.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9562; val_auprc_score: 0.9450; val_best_acc_score: 0.8949; val_best_f1_score: 0.8997; train_kl_reg_loss: 49292.3993; train_edge_recon_loss: 620152.4337; train_gene_expr_recon_loss: 17640140.2061; train_masked_gp_l1_reg_loss: 78966.3884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71679.1129; train_chrom_access_recon_loss: 3907246.4790; train_global_loss: 22367476.9466; train_optim_loss: 22367476.9466; val_kl_reg_loss: 26373.9462; val_edge_recon_loss: 598647.7042; val_gene_expr_recon_loss: 17533717.5333; val_masked_gp_l1_reg_loss: 78262.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69895.6328; val_chrom_access_recon_loss: 3808792.3500; val_global_loss: 22115689.7333; val_optim_loss: 22115689.7333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9515; val_auprc_score: 0.9347; val_best_acc_score: 0.8930; val_best_f1_score: 0.8967; train_kl_reg_loss: 47283.7011; train_edge_recon_loss: 584360.2486; train_gene_expr_recon_loss: 17495504.4885; train_masked_gp_l1_reg_loss: 77525.7202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69628.4887; train_chrom_access_recon_loss: 3868389.8053; train_global_loss: 22142692.3053; train_optim_loss: 22142692.3053; val_kl_reg_loss: 33968.9891; val_edge_recon_loss: 582927.0708; val_gene_expr_recon_loss: 17602053.4667; val_masked_gp_l1_reg_loss: 76773.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69299.8516; val_chrom_access_recon_loss: 3807356.7500; val_global_loss: 22172380.1333; val_optim_loss: 22172380.1333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9488; val_auprc_score: 0.9336; val_best_acc_score: 0.8925; val_best_f1_score: 0.8969; train_kl_reg_loss: 45640.3412; train_edge_recon_loss: 578667.7452; train_gene_expr_recon_loss: 17472840.1221; train_masked_gp_l1_reg_loss: 76136.8738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69425.3302; train_chrom_access_recon_loss: 3866764.2958; train_global_loss: 22109474.7786; train_optim_loss: 22109474.7786; val_kl_reg_loss: 36300.3411; val_edge_recon_loss: 580044.8375; val_gene_expr_recon_loss: 17446953.0667; val_masked_gp_l1_reg_loss: 75614.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69285.4766; val_chrom_access_recon_loss: 3793627.9500; val_global_loss: 22001826.8000; val_optim_loss: 22001826.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9529; val_auprc_score: 0.9385; val_best_acc_score: 0.8979; val_best_f1_score: 0.9022; train_kl_reg_loss: 45008.1562; train_edge_recon_loss: 572646.1159; train_gene_expr_recon_loss: 17413470.4351; train_masked_gp_l1_reg_loss: 75123.8498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69143.3352; train_chrom_access_recon_loss: 3851745.0553; train_global_loss: 22027136.9008; train_optim_loss: 22027136.9008; val_kl_reg_loss: 38339.9602; val_edge_recon_loss: 577664.0833; val_gene_expr_recon_loss: 17541415.7333; val_masked_gp_l1_reg_loss: 74562.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69255.2656; val_chrom_access_recon_loss: 3805495.2667; val_global_loss: 22106732.9333; val_optim_loss: 22106732.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9518; val_auprc_score: 0.9350; val_best_acc_score: 0.8987; val_best_f1_score: 0.9029; train_kl_reg_loss: 44427.0670; train_edge_recon_loss: 571945.4738; train_gene_expr_recon_loss: 17388614.8244; train_masked_gp_l1_reg_loss: 74303.8141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69181.0344; train_chrom_access_recon_loss: 3845473.8779; train_global_loss: 21993946.1832; train_optim_loss: 21993946.1832; val_kl_reg_loss: 39038.9424; val_edge_recon_loss: 574704.3667; val_gene_expr_recon_loss: 17414104.2667; val_masked_gp_l1_reg_loss: 73980.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69059.6016; val_chrom_access_recon_loss: 3769990.1333; val_global_loss: 21940878.1333; val_optim_loss: 21940878.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9549; val_auprc_score: 0.9412; val_best_acc_score: 0.9003; val_best_f1_score: 0.9038; train_kl_reg_loss: 44403.4080; train_edge_recon_loss: 570005.6493; train_gene_expr_recon_loss: 17363047.9313; train_masked_gp_l1_reg_loss: 73715.7731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68802.6997; train_chrom_access_recon_loss: 3846060.3702; train_global_loss: 21966035.9084; train_optim_loss: 21966035.9084; val_kl_reg_loss: 40008.5615; val_edge_recon_loss: 575363.2500; val_gene_expr_recon_loss: 17379873.4667; val_masked_gp_l1_reg_loss: 73353.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68768.2656; val_chrom_access_recon_loss: 3776441.7167; val_global_loss: 21913808.9333; val_optim_loss: 21913808.9333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9594; val_auprc_score: 0.9459; val_best_acc_score: 0.9066; val_best_f1_score: 0.9105; train_kl_reg_loss: 44087.9671; train_edge_recon_loss: 569783.0778; train_gene_expr_recon_loss: 17312727.7710; train_masked_gp_l1_reg_loss: 73157.6719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68735.0875; train_chrom_access_recon_loss: 3833906.2920; train_global_loss: 21902398.0916; train_optim_loss: 21902398.0916; val_kl_reg_loss: 40002.2419; val_edge_recon_loss: 571902.0417; val_gene_expr_recon_loss: 17415640.1333; val_masked_gp_l1_reg_loss: 72939.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68492.6875; val_chrom_access_recon_loss: 3800355.7000; val_global_loss: 21969332.2667; val_optim_loss: 21969332.2667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9583; val_auprc_score: 0.9464; val_best_acc_score: 0.9022; val_best_f1_score: 0.9067; train_kl_reg_loss: 43716.2841; train_edge_recon_loss: 569590.4146; train_gene_expr_recon_loss: 17302225.8626; train_masked_gp_l1_reg_loss: 72764.3423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68496.5784; train_chrom_access_recon_loss: 3827848.1183; train_global_loss: 21884641.6031; train_optim_loss: 21884641.6031; val_kl_reg_loss: 40663.0719; val_edge_recon_loss: 577143.7542; val_gene_expr_recon_loss: 17321449.5333; val_masked_gp_l1_reg_loss: 72507.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68621.9609; val_chrom_access_recon_loss: 3761317.4833; val_global_loss: 21841703.3333; val_optim_loss: 21841703.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9566; val_auprc_score: 0.9389; val_best_acc_score: 0.9046; val_best_f1_score: 0.9082; train_kl_reg_loss: 43573.8934; train_edge_recon_loss: 568832.1450; train_gene_expr_recon_loss: 17274609.7176; train_masked_gp_l1_reg_loss: 72411.6685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68540.9924; train_chrom_access_recon_loss: 3824885.8378; train_global_loss: 21852854.2748; train_optim_loss: 21852854.2748; val_kl_reg_loss: 39804.7721; val_edge_recon_loss: 576613.1375; val_gene_expr_recon_loss: 17406448.5333; val_masked_gp_l1_reg_loss: 72374.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68545.9375; val_chrom_access_recon_loss: 3765774.3000; val_global_loss: 21929560.4000; val_optim_loss: 21929560.4000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9611; val_auprc_score: 0.9481; val_best_acc_score: 0.9099; val_best_f1_score: 0.9138; train_kl_reg_loss: 43133.2453; train_edge_recon_loss: 569390.9103; train_gene_expr_recon_loss: 17235145.0382; train_masked_gp_l1_reg_loss: 72206.0346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68612.0059; train_chrom_access_recon_loss: 3816625.1698; train_global_loss: 21805112.4733; train_optim_loss: 21805112.4733; val_kl_reg_loss: 40513.8742; val_edge_recon_loss: 564889.4000; val_gene_expr_recon_loss: 17332711.2667; val_masked_gp_l1_reg_loss: 71918.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68395.5547; val_chrom_access_recon_loss: 3754539.1333; val_global_loss: 21832967.6000; val_optim_loss: 21832967.6000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9513; val_auprc_score: 0.9440; val_best_acc_score: 0.8818; val_best_f1_score: 0.8880; train_kl_reg_loss: 65439.1749; train_edge_recon_loss: 592328.9866; train_gene_expr_recon_loss: 17593332.2214; train_masked_gp_l1_reg_loss: 70812.5401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68199.4355; train_chrom_access_recon_loss: 3861527.2099; train_global_loss: 22251639.6489; train_optim_loss: 22251639.6489; val_kl_reg_loss: 41819.7958; val_edge_recon_loss: 617823.3333; val_gene_expr_recon_loss: 17757136.2667; val_masked_gp_l1_reg_loss: 65755.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67247.8906; val_chrom_access_recon_loss: 3840058.0000; val_global_loss: 22389841.4667; val_optim_loss: 22389841.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9475; val_auprc_score: 0.9359; val_best_acc_score: 0.8855; val_best_f1_score: 0.8915; train_kl_reg_loss: 56536.6380; train_edge_recon_loss: 601323.0611; train_gene_expr_recon_loss: 17627676.0763; train_masked_gp_l1_reg_loss: 61465.5597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65142.9601; train_chrom_access_recon_loss: 3867024.9580; train_global_loss: 22279169.2672; train_optim_loss: 22279169.2672; val_kl_reg_loss: 48426.2102; val_edge_recon_loss: 600506.5458; val_gene_expr_recon_loss: 17524186.6000; val_masked_gp_l1_reg_loss: 59110.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64374.7461; val_chrom_access_recon_loss: 3800479.9833; val_global_loss: 22097083.0667; val_optim_loss: 22097083.0667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9551; val_auprc_score: 0.9464; val_best_acc_score: 0.8942; val_best_f1_score: 0.8982; train_kl_reg_loss: 59418.4810; train_edge_recon_loss: 591377.8693; train_gene_expr_recon_loss: 17540055.4427; train_masked_gp_l1_reg_loss: 58341.1567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64848.5236; train_chrom_access_recon_loss: 3864112.5134; train_global_loss: 22178154.0763; train_optim_loss: 22178154.0763; val_kl_reg_loss: 49147.0576; val_edge_recon_loss: 604212.2750; val_gene_expr_recon_loss: 17439065.7333; val_masked_gp_l1_reg_loss: 57393.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65638.2266; val_chrom_access_recon_loss: 3773258.9667; val_global_loss: 21988716.0000; val_optim_loss: 21988716.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9546; val_auprc_score: 0.9441; val_best_acc_score: 0.8945; val_best_f1_score: 0.8984; train_kl_reg_loss: 52955.2782; train_edge_recon_loss: 590534.6608; train_gene_expr_recon_loss: 17390016.7557; train_masked_gp_l1_reg_loss: 56689.2879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67390.7151; train_chrom_access_recon_loss: 3840150.1011; train_global_loss: 21997736.8397; train_optim_loss: 21997736.8397; val_kl_reg_loss: 45435.5367; val_edge_recon_loss: 591244.0875; val_gene_expr_recon_loss: 17345984.2000; val_masked_gp_l1_reg_loss: 56397.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67229.0469; val_chrom_access_recon_loss: 3767133.6500; val_global_loss: 21873425.0667; val_optim_loss: 21873425.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9588; val_auprc_score: 0.9497; val_best_acc_score: 0.9000; val_best_f1_score: 0.9055; train_kl_reg_loss: 50051.0387; train_edge_recon_loss: 586392.7457; train_gene_expr_recon_loss: 17317356.2061; train_masked_gp_l1_reg_loss: 56019.8740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55852.7218; train_chrom_access_recon_loss: 3858900.7118; train_global_loss: 21924573.2977; train_optim_loss: 21924573.2977; val_kl_reg_loss: 44868.2966; val_edge_recon_loss: 583483.3167; val_gene_expr_recon_loss: 17308447.4667; val_masked_gp_l1_reg_loss: 55875.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53943.8320; val_chrom_access_recon_loss: 3775499.4500; val_global_loss: 21822118.4000; val_optim_loss: 21822118.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9547; val_auprc_score: 0.9418; val_best_acc_score: 0.8968; val_best_f1_score: 0.9015; train_kl_reg_loss: 49507.7983; train_edge_recon_loss: 584068.5515; train_gene_expr_recon_loss: 17278520.3664; train_masked_gp_l1_reg_loss: 55844.2360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53510.5267; train_chrom_access_recon_loss: 3835142.6660; train_global_loss: 21856593.9389; train_optim_loss: 21856593.9389; val_kl_reg_loss: 44315.8193; val_edge_recon_loss: 586929.1250; val_gene_expr_recon_loss: 17281604.2667; val_masked_gp_l1_reg_loss: 55833.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53223.8633; val_chrom_access_recon_loss: 3752641.4833; val_global_loss: 21774548.5333; val_optim_loss: 21774548.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9569; val_auprc_score: 0.9485; val_best_acc_score: 0.8953; val_best_f1_score: 0.9002; train_kl_reg_loss: 49213.5931; train_edge_recon_loss: 583116.7925; train_gene_expr_recon_loss: 17292453.5496; train_masked_gp_l1_reg_loss: 55833.6076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53021.2374; train_chrom_access_recon_loss: 3833106.7901; train_global_loss: 21866745.5725; train_optim_loss: 21866745.5725; val_kl_reg_loss: 44599.4742; val_edge_recon_loss: 584837.3958; val_gene_expr_recon_loss: 17332744.0000; val_masked_gp_l1_reg_loss: 55833.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52807.5156; val_chrom_access_recon_loss: 3751729.3333; val_global_loss: 21822552.5333; val_optim_loss: 21822552.5333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9568; val_auprc_score: 0.9451; val_best_acc_score: 0.9016; val_best_f1_score: 0.9064; train_kl_reg_loss: 49388.0429; train_edge_recon_loss: 581619.4113; train_gene_expr_recon_loss: 17286915.3969; train_masked_gp_l1_reg_loss: 55821.7153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52676.1028; train_chrom_access_recon_loss: 3823721.3683; train_global_loss: 21850142.1527; train_optim_loss: 21850142.1527; val_kl_reg_loss: 44749.9719; val_edge_recon_loss: 580651.7708; val_gene_expr_recon_loss: 17297891.8000; val_masked_gp_l1_reg_loss: 55818.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52547.1523; val_chrom_access_recon_loss: 3757438.6000; val_global_loss: 21789098.2667; val_optim_loss: 21789098.2667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9566; val_auprc_score: 0.9473; val_best_acc_score: 0.8933; val_best_f1_score: 0.8986; train_kl_reg_loss: 49210.4252; train_edge_recon_loss: 580232.1155; train_gene_expr_recon_loss: 17278755.1527; train_masked_gp_l1_reg_loss: 55810.9006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52430.6540; train_chrom_access_recon_loss: 3824335.0210; train_global_loss: 21840774.2137; train_optim_loss: 21840774.2137; val_kl_reg_loss: 44578.2518; val_edge_recon_loss: 581823.1917; val_gene_expr_recon_loss: 17329044.0000; val_masked_gp_l1_reg_loss: 55811.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52207.0898; val_chrom_access_recon_loss: 3756362.0333; val_global_loss: 21819827.3333; val_optim_loss: 21819827.3333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9557; val_auprc_score: 0.9446; val_best_acc_score: 0.8996; val_best_f1_score: 0.9044; train_kl_reg_loss: 49147.7028; train_edge_recon_loss: 578679.5477; train_gene_expr_recon_loss: 17284914.2366; train_masked_gp_l1_reg_loss: 55811.4309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52153.7336; train_chrom_access_recon_loss: 3827534.9866; train_global_loss: 21848241.5878; train_optim_loss: 21848241.5878; val_kl_reg_loss: 44596.1286; val_edge_recon_loss: 580323.2500; val_gene_expr_recon_loss: 17272192.8667; val_masked_gp_l1_reg_loss: 55801.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52014.5938; val_chrom_access_recon_loss: 3747234.1167; val_global_loss: 21752162.2667; val_optim_loss: 21752162.2667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9530; val_auprc_score: 0.9411; val_best_acc_score: 0.8973; val_best_f1_score: 0.9018; train_kl_reg_loss: 49008.2806; train_edge_recon_loss: 578736.5324; train_gene_expr_recon_loss: 17284037.5267; train_masked_gp_l1_reg_loss: 55789.7618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51948.1492; train_chrom_access_recon_loss: 3826051.9046; train_global_loss: 21845572.0763; train_optim_loss: 21845572.0763; val_kl_reg_loss: 44323.0510; val_edge_recon_loss: 584339.8875; val_gene_expr_recon_loss: 17311357.0000; val_masked_gp_l1_reg_loss: 55787.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51738.9219; val_chrom_access_recon_loss: 3777602.0667; val_global_loss: 21825148.0000; val_optim_loss: 21825148.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9567; val_auprc_score: 0.9482; val_best_acc_score: 0.8980; val_best_f1_score: 0.9023; train_kl_reg_loss: 48784.6977; train_edge_recon_loss: 577167.3745; train_gene_expr_recon_loss: 17258376.7863; train_masked_gp_l1_reg_loss: 55786.7880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51652.5460; train_chrom_access_recon_loss: 3819840.0401; train_global_loss: 21811608.3511; train_optim_loss: 21811608.3511; val_kl_reg_loss: 44472.2820; val_edge_recon_loss: 580014.5042; val_gene_expr_recon_loss: 17324348.9333; val_masked_gp_l1_reg_loss: 55784.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51511.2930; val_chrom_access_recon_loss: 3762127.2167; val_global_loss: 21818259.2000; val_optim_loss: 21818259.2000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9552; val_auprc_score: 0.9449; val_best_acc_score: 0.9003; val_best_f1_score: 0.9045; train_kl_reg_loss: 48798.4765; train_edge_recon_loss: 576019.8015; train_gene_expr_recon_loss: 17272542.4733; train_masked_gp_l1_reg_loss: 55780.1829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51436.1254; train_chrom_access_recon_loss: 3822490.5134; train_global_loss: 21827067.5267; train_optim_loss: 21827067.5267; val_kl_reg_loss: 44444.9880; val_edge_recon_loss: 581228.7708; val_gene_expr_recon_loss: 17280169.1333; val_masked_gp_l1_reg_loss: 55768.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51299.7070; val_chrom_access_recon_loss: 3761439.6667; val_global_loss: 21774350.4000; val_optim_loss: 21774350.4000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9583; val_auprc_score: 0.9475; val_best_acc_score: 0.9030; val_best_f1_score: 0.9067; train_kl_reg_loss: 48795.2905; train_edge_recon_loss: 576386.7133; train_gene_expr_recon_loss: 17265054.5649; train_masked_gp_l1_reg_loss: 55760.6420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51201.4434; train_chrom_access_recon_loss: 3825527.0859; train_global_loss: 21822725.7099; train_optim_loss: 21822725.7099; val_kl_reg_loss: 44312.5836; val_edge_recon_loss: 576734.2708; val_gene_expr_recon_loss: 17239695.0000; val_masked_gp_l1_reg_loss: 55757.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51142.9688; val_chrom_access_recon_loss: 3764770.8167; val_global_loss: 21732412.6667; val_optim_loss: 21732412.6667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9554; val_auprc_score: 0.9429; val_best_acc_score: 0.8984; val_best_f1_score: 0.9027; train_kl_reg_loss: 48614.1480; train_edge_recon_loss: 575379.9156; train_gene_expr_recon_loss: 17257128.2214; train_masked_gp_l1_reg_loss: 55755.6229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51036.0446; train_chrom_access_recon_loss: 3823093.1393; train_global_loss: 21811007.2214; train_optim_loss: 21811007.2214; val_kl_reg_loss: 44659.0055; val_edge_recon_loss: 579332.3083; val_gene_expr_recon_loss: 17290148.4000; val_masked_gp_l1_reg_loss: 55739.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50896.2930; val_chrom_access_recon_loss: 3744462.4833; val_global_loss: 21765238.1333; val_optim_loss: 21765238.1333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9577; val_auprc_score: 0.9485; val_best_acc_score: 0.9011; val_best_f1_score: 0.9052; train_kl_reg_loss: 48672.2326; train_edge_recon_loss: 574008.9184; train_gene_expr_recon_loss: 17280065.2977; train_masked_gp_l1_reg_loss: 55737.4709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50813.2644; train_chrom_access_recon_loss: 3827491.5172; train_global_loss: 21836788.6260; train_optim_loss: 21836788.6260; val_kl_reg_loss: 44311.7552; val_edge_recon_loss: 577056.0958; val_gene_expr_recon_loss: 17241936.0667; val_masked_gp_l1_reg_loss: 55727.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50735.2539; val_chrom_access_recon_loss: 3743590.7333; val_global_loss: 21713358.9333; val_optim_loss: 21713358.9333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9576; val_auprc_score: 0.9475; val_best_acc_score: 0.9049; val_best_f1_score: 0.9084; train_kl_reg_loss: 48596.6286; train_edge_recon_loss: 574585.3793; train_gene_expr_recon_loss: 17251881.2443; train_masked_gp_l1_reg_loss: 55721.4778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50677.1255; train_chrom_access_recon_loss: 3825637.9198; train_global_loss: 21807099.6947; train_optim_loss: 21807099.6947; val_kl_reg_loss: 44362.0240; val_edge_recon_loss: 576978.4208; val_gene_expr_recon_loss: 17335607.2667; val_masked_gp_l1_reg_loss: 55715.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50523.8125; val_chrom_access_recon_loss: 3759733.4333; val_global_loss: 21822921.0667; val_optim_loss: 21822921.0667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9581; val_auprc_score: 0.9473; val_best_acc_score: 0.9003; val_best_f1_score: 0.9053; train_kl_reg_loss: 48542.3301; train_edge_recon_loss: 575014.8712; train_gene_expr_recon_loss: 17253833.7481; train_masked_gp_l1_reg_loss: 55691.1661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50384.2642; train_chrom_access_recon_loss: 3823948.0382; train_global_loss: 21807414.4427; train_optim_loss: 21807414.4427; val_kl_reg_loss: 44278.2857; val_edge_recon_loss: 577355.2125; val_gene_expr_recon_loss: 17169027.7333; val_masked_gp_l1_reg_loss: 55695.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50279.0664; val_chrom_access_recon_loss: 3729992.6333; val_global_loss: 21626630.1333; val_optim_loss: 21626630.1333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9554; val_auprc_score: 0.9379; val_best_acc_score: 0.8989; val_best_f1_score: 0.9035; train_kl_reg_loss: 48416.7536; train_edge_recon_loss: 574445.8397; train_gene_expr_recon_loss: 17240701.9771; train_masked_gp_l1_reg_loss: 55680.1714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50177.5323; train_chrom_access_recon_loss: 3818882.8740; train_global_loss: 21788305.0840; train_optim_loss: 21788305.0840; val_kl_reg_loss: 44322.2201; val_edge_recon_loss: 576916.6292; val_gene_expr_recon_loss: 17344173.2000; val_masked_gp_l1_reg_loss: 55673.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50023.1016; val_chrom_access_recon_loss: 3766963.7333; val_global_loss: 21838073.6000; val_optim_loss: 21838073.6000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9566; val_auprc_score: 0.9442; val_best_acc_score: 0.8972; val_best_f1_score: 0.9029; train_kl_reg_loss: 48739.7668; train_edge_recon_loss: 573405.2099; train_gene_expr_recon_loss: 17244063.3740; train_masked_gp_l1_reg_loss: 55666.9827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49949.1731; train_chrom_access_recon_loss: 3824687.5134; train_global_loss: 21796511.8779; train_optim_loss: 21796511.8779; val_kl_reg_loss: 44972.4443; val_edge_recon_loss: 578003.0708; val_gene_expr_recon_loss: 17277390.0667; val_masked_gp_l1_reg_loss: 55655.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49802.4922; val_chrom_access_recon_loss: 3760102.8833; val_global_loss: 21765926.6667; val_optim_loss: 21765926.6667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9592; val_auprc_score: 0.9483; val_best_acc_score: 0.9049; val_best_f1_score: 0.9085; train_kl_reg_loss: 48759.9420; train_edge_recon_loss: 572579.2281; train_gene_expr_recon_loss: 17244186.9771; train_masked_gp_l1_reg_loss: 55656.9361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49788.7191; train_chrom_access_recon_loss: 3820854.7042; train_global_loss: 21791826.3817; train_optim_loss: 21791826.3817; val_kl_reg_loss: 44568.3406; val_edge_recon_loss: 574151.3500; val_gene_expr_recon_loss: 17286842.8667; val_masked_gp_l1_reg_loss: 55646.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49678.8867; val_chrom_access_recon_loss: 3763403.4667; val_global_loss: 21774289.7333; val_optim_loss: 21774289.7333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9562; val_auprc_score: 0.9429; val_best_acc_score: 0.9003; val_best_f1_score: 0.9046; train_kl_reg_loss: 48427.3835; train_edge_recon_loss: 572662.8321; train_gene_expr_recon_loss: 17251582.0305; train_masked_gp_l1_reg_loss: 55639.7372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49569.5506; train_chrom_access_recon_loss: 3822305.8378; train_global_loss: 21800187.4351; train_optim_loss: 21800187.4351; val_kl_reg_loss: 44646.7945; val_edge_recon_loss: 577437.6500; val_gene_expr_recon_loss: 17254302.7333; val_masked_gp_l1_reg_loss: 55626.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49375.4531; val_chrom_access_recon_loss: 3737017.1000; val_global_loss: 21718406.0000; val_optim_loss: 21718406.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9583; val_auprc_score: 0.9445; val_best_acc_score: 0.9066; val_best_f1_score: 0.9096; train_kl_reg_loss: 48205.9004; train_edge_recon_loss: 572906.8535; train_gene_expr_recon_loss: 17230304.2901; train_masked_gp_l1_reg_loss: 55579.0547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48320.5796; train_chrom_access_recon_loss: 3816130.9637; train_global_loss: 21771447.4656; train_optim_loss: 21771447.4656; val_kl_reg_loss: 44319.8187; val_edge_recon_loss: 574254.7667; val_gene_expr_recon_loss: 17217954.2667; val_masked_gp_l1_reg_loss: 55555.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48183.9570; val_chrom_access_recon_loss: 3759256.9667; val_global_loss: 21699526.0000; val_optim_loss: 21699526.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9609; val_auprc_score: 0.9515; val_best_acc_score: 0.9072; val_best_f1_score: 0.9106; train_kl_reg_loss: 48201.5121; train_edge_recon_loss: 571282.1722; train_gene_expr_recon_loss: 17230005.8397; train_masked_gp_l1_reg_loss: 55549.6148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48142.3532; train_chrom_access_recon_loss: 3817526.1851; train_global_loss: 21770707.7099; train_optim_loss: 21770707.7099; val_kl_reg_loss: 44656.4000; val_edge_recon_loss: 572415.9292; val_gene_expr_recon_loss: 17267568.2667; val_masked_gp_l1_reg_loss: 55540.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48106.2109; val_chrom_access_recon_loss: 3753046.8500; val_global_loss: 21741333.6000; val_optim_loss: 21741333.6000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9556; val_auprc_score: 0.9416; val_best_acc_score: 0.9004; val_best_f1_score: 0.9054; train_kl_reg_loss: 48248.8778; train_edge_recon_loss: 573140.6489; train_gene_expr_recon_loss: 17202291.0076; train_masked_gp_l1_reg_loss: 55537.7231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48072.4888; train_chrom_access_recon_loss: 3813336.5305; train_global_loss: 21740627.3435; train_optim_loss: 21740627.3435; val_kl_reg_loss: 44439.3862; val_edge_recon_loss: 577889.2000; val_gene_expr_recon_loss: 17202627.8667; val_masked_gp_l1_reg_loss: 55532.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48042.9492; val_chrom_access_recon_loss: 3723434.9833; val_global_loss: 21651965.4667; val_optim_loss: 21651965.4667
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9594; val_auprc_score: 0.9483; val_best_acc_score: 0.9034; val_best_f1_score: 0.9078; train_kl_reg_loss: 48377.4744; train_edge_recon_loss: 572637.6035; train_gene_expr_recon_loss: 17226867.0992; train_masked_gp_l1_reg_loss: 55528.6340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48018.4892; train_chrom_access_recon_loss: 3817357.7004; train_global_loss: 21768787.0534; train_optim_loss: 21768787.0534; val_kl_reg_loss: 44257.9333; val_edge_recon_loss: 575926.9875; val_gene_expr_recon_loss: 17253224.0000; val_masked_gp_l1_reg_loss: 55525.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47993.2969; val_chrom_access_recon_loss: 3757982.1500; val_global_loss: 21734910.9333; val_optim_loss: 21734910.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 50 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9567
val AUPRC score: 0.9472
val best accuracy score: 0.8977
val best F1 score: 0.9027
val target rna MSE score: 1.3673
val source rna MSE score: 0.5618
val target atac MSE score: 0.4792
val source atac MSE score: 0.1467
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
