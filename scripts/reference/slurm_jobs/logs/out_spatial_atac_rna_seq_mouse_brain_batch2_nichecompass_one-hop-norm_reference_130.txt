[True]
Run timestamp: 07082023_212637_130.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_130']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9345; val_auprc_score: 0.9391; val_best_acc_score: 0.5290; val_best_f1_score: 0.6794; train_kl_reg_loss: 12129.8809; train_edge_recon_loss: 3470976.1111; train_gene_expr_recon_loss: 628569.7153; train_masked_gp_l1_reg_loss: 8773.8653; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 799738.9028; train_global_loss: 4920188.5556; train_optim_loss: 4920188.5556; val_kl_reg_loss: 12636.9766; val_edge_recon_loss: 4062432.0000; val_gene_expr_recon_loss: 598032.8125; val_masked_gp_l1_reg_loss: 7238.3857; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 801406.6875; val_global_loss: 5481747.0000; val_optim_loss: 5481747.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9417; val_auprc_score: 0.9465; val_best_acc_score: 0.6279; val_best_f1_score: 0.7276; train_kl_reg_loss: 8313.7070; train_edge_recon_loss: 3473042.7778; train_gene_expr_recon_loss: 600226.3194; train_masked_gp_l1_reg_loss: 6580.2660; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 790770.7083; train_global_loss: 4878933.7778; train_optim_loss: 4878933.7778; val_kl_reg_loss: 7425.9424; val_edge_recon_loss: 4058745.0000; val_gene_expr_recon_loss: 573895.0625; val_masked_gp_l1_reg_loss: 5980.9917; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 793680.5000; val_global_loss: 5439727.5000; val_optim_loss: 5439727.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9326; val_auprc_score: 0.9290; val_best_acc_score: 0.8103; val_best_f1_score: 0.8367; train_kl_reg_loss: 8016.2341; train_edge_recon_loss: 3474443.1944; train_gene_expr_recon_loss: 573379.9444; train_masked_gp_l1_reg_loss: 5826.1929; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 782541.4306; train_global_loss: 4844207.0000; train_optim_loss: 4844207.0000; val_kl_reg_loss: 9726.1729; val_edge_recon_loss: 4044700.0000; val_gene_expr_recon_loss: 546598.7500; val_masked_gp_l1_reg_loss: 5716.4233; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 785460.8125; val_global_loss: 5392202.5000; val_optim_loss: 5392202.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9306; val_auprc_score: 0.9197; val_best_acc_score: 0.8310; val_best_f1_score: 0.8270; train_kl_reg_loss: 10947.8222; train_edge_recon_loss: 3472207.0556; train_gene_expr_recon_loss: 549444.0556; train_masked_gp_l1_reg_loss: 5644.0542; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 774833.1250; train_global_loss: 4813076.1111; train_optim_loss: 4813076.1111; val_kl_reg_loss: 9982.8672; val_edge_recon_loss: 3945163.0000; val_gene_expr_recon_loss: 525627.6250; val_masked_gp_l1_reg_loss: 5566.1846; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 777618.3750; val_global_loss: 5263958.0000; val_optim_loss: 5263958.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8800; val_auprc_score: 0.8689; val_best_acc_score: 0.7851; val_best_f1_score: 0.8066; train_kl_reg_loss: 7731.0021; train_edge_recon_loss: 3398061.6944; train_gene_expr_recon_loss: 535120.8611; train_masked_gp_l1_reg_loss: 5565.4513; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 769215.5139; train_global_loss: 4715694.5000; train_optim_loss: 4715694.5000; val_kl_reg_loss: 4499.7705; val_edge_recon_loss: 3046092.0000; val_gene_expr_recon_loss: 544504.1875; val_masked_gp_l1_reg_loss: 5580.0366; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 781569.0000; val_global_loss: 4382245.0000; val_optim_loss: 4382245.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8856; val_auprc_score: 0.8780; val_best_acc_score: 0.7850; val_best_f1_score: 0.7979; train_kl_reg_loss: 16253.7469; train_edge_recon_loss: 2953576.6944; train_gene_expr_recon_loss: 551822.4514; train_masked_gp_l1_reg_loss: 5622.9934; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 772898.8611; train_global_loss: 4300174.7222; train_optim_loss: 4300174.7222; val_kl_reg_loss: 38192.7969; val_edge_recon_loss: 2855524.7500; val_gene_expr_recon_loss: 530241.6250; val_masked_gp_l1_reg_loss: 5687.6177; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 774248.3750; val_global_loss: 4203895.0000; val_optim_loss: 4203895.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8852; val_auprc_score: 0.8650; val_best_acc_score: 0.7924; val_best_f1_score: 0.8098; train_kl_reg_loss: 50075.0365; train_edge_recon_loss: 2839459.8889; train_gene_expr_recon_loss: 527885.6250; train_masked_gp_l1_reg_loss: 5699.5977; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 763068.8056; train_global_loss: 4186188.9167; train_optim_loss: 4186188.9167; val_kl_reg_loss: 49447.2734; val_edge_recon_loss: 2842140.0000; val_gene_expr_recon_loss: 510864.1562; val_masked_gp_l1_reg_loss: 5695.3135; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 767312.1875; val_global_loss: 4175459.0000; val_optim_loss: 4175459.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9067; val_auprc_score: 0.8783; val_best_acc_score: 0.8375; val_best_f1_score: 0.8510; train_kl_reg_loss: 39310.8841; train_edge_recon_loss: 2809618.9444; train_gene_expr_recon_loss: 517057.0486; train_masked_gp_l1_reg_loss: 5684.8389; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 759124.8958; train_global_loss: 4130796.6111; train_optim_loss: 4130796.6111; val_kl_reg_loss: 27601.2363; val_edge_recon_loss: 2787862.0000; val_gene_expr_recon_loss: 517768.2500; val_masked_gp_l1_reg_loss: 5665.4448; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 768732.5625; val_global_loss: 4107629.5000; val_optim_loss: 4107629.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9260; val_auprc_score: 0.9000; val_best_acc_score: 0.8698; val_best_f1_score: 0.8762; train_kl_reg_loss: 28352.0341; train_edge_recon_loss: 2755664.0000; train_gene_expr_recon_loss: 526140.2396; train_masked_gp_l1_reg_loss: 5669.8457; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 762635.4167; train_global_loss: 4078461.5278; train_optim_loss: 4078461.5278; val_kl_reg_loss: 31825.3750; val_edge_recon_loss: 2759683.7500; val_gene_expr_recon_loss: 516347.9375; val_masked_gp_l1_reg_loss: 5666.9365; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 766537.0000; val_global_loss: 4080061.0000; val_optim_loss: 4080061.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9299; val_auprc_score: 0.9100; val_best_acc_score: 0.8678; val_best_f1_score: 0.8762; train_kl_reg_loss: 37085.3283; train_edge_recon_loss: 2731813.5000; train_gene_expr_recon_loss: 515161.9688; train_masked_gp_l1_reg_loss: 5662.6341; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 754897.2083; train_global_loss: 4044620.6667; train_optim_loss: 4044620.6667; val_kl_reg_loss: 38879.8086; val_edge_recon_loss: 2752533.5000; val_gene_expr_recon_loss: 500905.5938; val_masked_gp_l1_reg_loss: 5655.5083; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 761190.0625; val_global_loss: 4059164.2500; val_optim_loss: 4059164.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9344; val_auprc_score: 0.9105; val_best_acc_score: 0.8752; val_best_f1_score: 0.8828; train_kl_reg_loss: 38794.2135; train_edge_recon_loss: 2725445.6944; train_gene_expr_recon_loss: 505404.9965; train_masked_gp_l1_reg_loss: 5656.4070; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 751723.0139; train_global_loss: 4027024.3056; train_optim_loss: 4027024.3056; val_kl_reg_loss: 35963.2734; val_edge_recon_loss: 2730646.2500; val_gene_expr_recon_loss: 497198.2500; val_masked_gp_l1_reg_loss: 5657.7217; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 758313.0000; val_global_loss: 4027778.5000; val_optim_loss: 4027778.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9351; val_auprc_score: 0.9123; val_best_acc_score: 0.8771; val_best_f1_score: 0.8840; train_kl_reg_loss: 36872.2687; train_edge_recon_loss: 2717659.9444; train_gene_expr_recon_loss: 497294.2986; train_masked_gp_l1_reg_loss: 5673.4249; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 747722.4861; train_global_loss: 4005222.3889; train_optim_loss: 4005222.3889; val_kl_reg_loss: 34697.3203; val_edge_recon_loss: 2747961.5000; val_gene_expr_recon_loss: 494654.6250; val_masked_gp_l1_reg_loss: 5695.6846; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 756182.5000; val_global_loss: 4039191.7500; val_optim_loss: 4039191.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9446; val_auprc_score: 0.9214; val_best_acc_score: 0.8875; val_best_f1_score: 0.8941; train_kl_reg_loss: 35939.4388; train_edge_recon_loss: 2715074.7778; train_gene_expr_recon_loss: 496013.0382; train_masked_gp_l1_reg_loss: 5721.0108; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 747152.1042; train_global_loss: 3999900.4444; train_optim_loss: 3999900.4444; val_kl_reg_loss: 35225.5273; val_edge_recon_loss: 2742812.2500; val_gene_expr_recon_loss: 490763.0000; val_masked_gp_l1_reg_loss: 5740.0977; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 754427.4375; val_global_loss: 4028968.2500; val_optim_loss: 4028968.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9521; val_auprc_score: 0.9347; val_best_acc_score: 0.8988; val_best_f1_score: 0.9041; train_kl_reg_loss: 35290.3155; train_edge_recon_loss: 2708623.0556; train_gene_expr_recon_loss: 490447.9826; train_masked_gp_l1_reg_loss: 5773.3773; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 743763.6458; train_global_loss: 3983898.3889; train_optim_loss: 3983898.3889; val_kl_reg_loss: 31549.2734; val_edge_recon_loss: 2710624.7500; val_gene_expr_recon_loss: 488126.5938; val_masked_gp_l1_reg_loss: 5812.4580; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 752783.0625; val_global_loss: 3988896.0000; val_optim_loss: 3988896.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9534; val_auprc_score: 0.9325; val_best_acc_score: 0.8996; val_best_f1_score: 0.9050; train_kl_reg_loss: 32347.9618; train_edge_recon_loss: 2685612.5000; train_gene_expr_recon_loss: 489886.2257; train_masked_gp_l1_reg_loss: 5846.5201; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 747497.2847; train_global_loss: 3961190.5556; train_optim_loss: 3961190.5556; val_kl_reg_loss: 32150.3672; val_edge_recon_loss: 2698601.7500; val_gene_expr_recon_loss: 482618.2188; val_masked_gp_l1_reg_loss: 5883.0708; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 750899.7500; val_global_loss: 3970153.0000; val_optim_loss: 3970153.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9624; val_auprc_score: 0.9488; val_best_acc_score: 0.9101; val_best_f1_score: 0.9129; train_kl_reg_loss: 34784.2834; train_edge_recon_loss: 2674957.0556; train_gene_expr_recon_loss: 485450.9792; train_masked_gp_l1_reg_loss: 5922.8296; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 742625.0625; train_global_loss: 3943740.1667; train_optim_loss: 3943740.1667; val_kl_reg_loss: 34430.8750; val_edge_recon_loss: 2700302.2500; val_gene_expr_recon_loss: 478923.8438; val_masked_gp_l1_reg_loss: 5966.9902; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 748650.9375; val_global_loss: 3968274.7500; val_optim_loss: 3968274.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9643; val_auprc_score: 0.9533; val_best_acc_score: 0.9096; val_best_f1_score: 0.9131; train_kl_reg_loss: 37044.0490; train_edge_recon_loss: 2675841.3611; train_gene_expr_recon_loss: 483378.6979; train_masked_gp_l1_reg_loss: 5999.8191; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 742874.0833; train_global_loss: 3945138.0000; train_optim_loss: 3945138.0000; val_kl_reg_loss: 37021.9609; val_edge_recon_loss: 2692276.7500; val_gene_expr_recon_loss: 476565.7500; val_masked_gp_l1_reg_loss: 6038.7295; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 745769.0625; val_global_loss: 3957672.2500; val_optim_loss: 3957672.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9644; val_auprc_score: 0.9475; val_best_acc_score: 0.9161; val_best_f1_score: 0.9203; train_kl_reg_loss: 38300.3177; train_edge_recon_loss: 2669506.5000; train_gene_expr_recon_loss: 475478.6354; train_masked_gp_l1_reg_loss: 6073.3477; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732577.6250; train_global_loss: 3921936.4722; train_optim_loss: 3921936.4722; val_kl_reg_loss: 36344.3438; val_edge_recon_loss: 2675556.0000; val_gene_expr_recon_loss: 472992.5625; val_masked_gp_l1_reg_loss: 6103.0913; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 744706.2500; val_global_loss: 3935702.0000; val_optim_loss: 3935702.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9674; val_auprc_score: 0.9564; val_best_acc_score: 0.9196; val_best_f1_score: 0.9235; train_kl_reg_loss: 37666.4288; train_edge_recon_loss: 2669386.8056; train_gene_expr_recon_loss: 475275.0972; train_masked_gp_l1_reg_loss: 6136.7283; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 735303.8194; train_global_loss: 3923768.8611; train_optim_loss: 3923768.8611; val_kl_reg_loss: 35117.4961; val_edge_recon_loss: 2663497.2500; val_gene_expr_recon_loss: 469291.4375; val_masked_gp_l1_reg_loss: 6165.4829; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 742300.0625; val_global_loss: 3916371.7500; val_optim_loss: 3916371.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9657; val_auprc_score: 0.9520; val_best_acc_score: 0.9192; val_best_f1_score: 0.9233; train_kl_reg_loss: 36228.5838; train_edge_recon_loss: 2665299.6667; train_gene_expr_recon_loss: 470839.7986; train_masked_gp_l1_reg_loss: 6195.4558; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731261.3264; train_global_loss: 3909824.7778; train_optim_loss: 3909824.7778; val_kl_reg_loss: 33858.3008; val_edge_recon_loss: 2686350.0000; val_gene_expr_recon_loss: 472466.7188; val_masked_gp_l1_reg_loss: 6219.2812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 741798.8750; val_global_loss: 3940693.0000; val_optim_loss: 3940693.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9689; val_auprc_score: 0.9555; val_best_acc_score: 0.9259; val_best_f1_score: 0.9288; train_kl_reg_loss: 35290.0273; train_edge_recon_loss: 2666355.7500; train_gene_expr_recon_loss: 471000.6979; train_masked_gp_l1_reg_loss: 6242.8326; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732962.4236; train_global_loss: 3911851.7222; train_optim_loss: 3911851.7222; val_kl_reg_loss: 35022.9688; val_edge_recon_loss: 2669837.7500; val_gene_expr_recon_loss: 467992.7500; val_masked_gp_l1_reg_loss: 6267.4731; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 739685.6875; val_global_loss: 3918806.7500; val_optim_loss: 3918806.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9726; val_auprc_score: 0.9584; val_best_acc_score: 0.9287; val_best_f1_score: 0.9306; train_kl_reg_loss: 36300.4106; train_edge_recon_loss: 2656431.0278; train_gene_expr_recon_loss: 468833.0417; train_masked_gp_l1_reg_loss: 6289.0534; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 730277.7014; train_global_loss: 3898131.3056; train_optim_loss: 3898131.3056; val_kl_reg_loss: 34261.0781; val_edge_recon_loss: 2680630.7500; val_gene_expr_recon_loss: 461955.3750; val_masked_gp_l1_reg_loss: 6302.9062; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 737322.8750; val_global_loss: 3920473.0000; val_optim_loss: 3920473.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9745; val_auprc_score: 0.9650; val_best_acc_score: 0.9320; val_best_f1_score: 0.9342; train_kl_reg_loss: 34841.1072; train_edge_recon_loss: 2665511.3611; train_gene_expr_recon_loss: 465461.3021; train_masked_gp_l1_reg_loss: 6326.8381; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727927.2639; train_global_loss: 3900067.8611; train_optim_loss: 3900067.8611; val_kl_reg_loss: 33109.1055; val_edge_recon_loss: 2663586.7500; val_gene_expr_recon_loss: 469157.1875; val_masked_gp_l1_reg_loss: 6344.8701; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 738028.6875; val_global_loss: 3910226.5000; val_optim_loss: 3910226.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9738; val_auprc_score: 0.9630; val_best_acc_score: 0.9307; val_best_f1_score: 0.9332; train_kl_reg_loss: 35378.2882; train_edge_recon_loss: 2648673.0556; train_gene_expr_recon_loss: 464328.2708; train_masked_gp_l1_reg_loss: 6362.1809; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727298.5278; train_global_loss: 3882040.3889; train_optim_loss: 3882040.3889; val_kl_reg_loss: 33154.3516; val_edge_recon_loss: 2660890.2500; val_gene_expr_recon_loss: 459849.2188; val_masked_gp_l1_reg_loss: 6376.4116; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 734221.8750; val_global_loss: 3894492.0000; val_optim_loss: 3894492.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9750; val_auprc_score: 0.9674; val_best_acc_score: 0.9332; val_best_f1_score: 0.9349; train_kl_reg_loss: 33586.8021; train_edge_recon_loss: 2651262.7778; train_gene_expr_recon_loss: 462637.1979; train_masked_gp_l1_reg_loss: 6398.0948; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 726238.7361; train_global_loss: 3880123.6667; train_optim_loss: 3880123.6667; val_kl_reg_loss: 32363.5957; val_edge_recon_loss: 2651000.0000; val_gene_expr_recon_loss: 461175.8750; val_masked_gp_l1_reg_loss: 6411.5957; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 733985.8125; val_global_loss: 3884936.7500; val_optim_loss: 3884936.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9755; val_auprc_score: 0.9642; val_best_acc_score: 0.9328; val_best_f1_score: 0.9348; train_kl_reg_loss: 34972.1918; train_edge_recon_loss: 2674812.5556; train_gene_expr_recon_loss: 492450.2986; train_masked_gp_l1_reg_loss: 6413.5260; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 738947.7569; train_global_loss: 3947596.1944; train_optim_loss: 3947596.1944; val_kl_reg_loss: 14064.2344; val_edge_recon_loss: 2682395.0000; val_gene_expr_recon_loss: 480464.2500; val_masked_gp_l1_reg_loss: 6382.3950; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 744123.8750; val_global_loss: 3927430.0000; val_optim_loss: 3927430.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9747; val_auprc_score: 0.9660; val_best_acc_score: 0.9302; val_best_f1_score: 0.9325; train_kl_reg_loss: 35413.1984; train_edge_recon_loss: 2653062.1389; train_gene_expr_recon_loss: 486222.8681; train_masked_gp_l1_reg_loss: 6348.0462; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 735579.3056; train_global_loss: 3916625.6389; train_optim_loss: 3916625.6389; val_kl_reg_loss: 13200.4668; val_edge_recon_loss: 2661301.7500; val_gene_expr_recon_loss: 485125.9375; val_masked_gp_l1_reg_loss: 6305.2695; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 744194.2500; val_global_loss: 3910127.7500; val_optim_loss: 3910127.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9718; val_auprc_score: 0.9611; val_best_acc_score: 0.9307; val_best_f1_score: 0.9332; train_kl_reg_loss: 31223.8961; train_edge_recon_loss: 2648481.2778; train_gene_expr_recon_loss: 484234.0868; train_masked_gp_l1_reg_loss: 6272.6714; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 734453.3889; train_global_loss: 3904665.3611; train_optim_loss: 3904665.3611; val_kl_reg_loss: 13298.0762; val_edge_recon_loss: 2662982.7500; val_gene_expr_recon_loss: 483336.1250; val_masked_gp_l1_reg_loss: 6232.7520; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 742811.8750; val_global_loss: 3908661.5000; val_optim_loss: 3908661.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9739; val_auprc_score: 0.9657; val_best_acc_score: 0.9303; val_best_f1_score: 0.9326; train_kl_reg_loss: 28510.9160; train_edge_recon_loss: 2640290.7778; train_gene_expr_recon_loss: 481263.4097; train_masked_gp_l1_reg_loss: 6200.3032; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731289.0556; train_global_loss: 3887554.4444; train_optim_loss: 3887554.4444; val_kl_reg_loss: 13468.8418; val_edge_recon_loss: 2649638.2500; val_gene_expr_recon_loss: 480348.7188; val_masked_gp_l1_reg_loss: 6161.6206; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 741076.4375; val_global_loss: 3890693.7500; val_optim_loss: 3890693.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9766; val_auprc_score: 0.9684; val_best_acc_score: 0.9325; val_best_f1_score: 0.9342; train_kl_reg_loss: 27477.2728; train_edge_recon_loss: 2648657.2778; train_gene_expr_recon_loss: 481622.5069; train_masked_gp_l1_reg_loss: 6127.7712; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 733955.0069; train_global_loss: 3897839.8611; train_optim_loss: 3897839.8611; val_kl_reg_loss: 13646.9199; val_edge_recon_loss: 2651628.2500; val_gene_expr_recon_loss: 479977.3125; val_masked_gp_l1_reg_loss: 6095.0283; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 741079.9375; val_global_loss: 3892427.5000; val_optim_loss: 3892427.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9761; val_auprc_score: 0.9665; val_best_acc_score: 0.9383; val_best_f1_score: 0.9399; train_kl_reg_loss: 27131.2044; train_edge_recon_loss: 2639327.5556; train_gene_expr_recon_loss: 480479.0764; train_masked_gp_l1_reg_loss: 6085.6965; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 730086.6042; train_global_loss: 3883110.1111; train_optim_loss: 3883110.1111; val_kl_reg_loss: 13738.5195; val_edge_recon_loss: 2640837.2500; val_gene_expr_recon_loss: 482185.9375; val_masked_gp_l1_reg_loss: 6071.6445; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 741909.7500; val_global_loss: 3884743.2500; val_optim_loss: 3884743.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9730; val_auprc_score: 0.9601; val_best_acc_score: 0.9297; val_best_f1_score: 0.9321; train_kl_reg_loss: 27364.3019; train_edge_recon_loss: 2637166.0833; train_gene_expr_recon_loss: 481704.3507; train_masked_gp_l1_reg_loss: 6063.1532; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731473.1597; train_global_loss: 3883771.1111; train_optim_loss: 3883771.1111; val_kl_reg_loss: 14052.8184; val_edge_recon_loss: 2667404.0000; val_gene_expr_recon_loss: 478883.0938; val_masked_gp_l1_reg_loss: 6053.6318; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740436.0625; val_global_loss: 3906829.5000; val_optim_loss: 3906829.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9749; val_auprc_score: 0.9656; val_best_acc_score: 0.9321; val_best_f1_score: 0.9343; train_kl_reg_loss: 27352.3689; train_edge_recon_loss: 2643969.8889; train_gene_expr_recon_loss: 478293.5278; train_masked_gp_l1_reg_loss: 6048.1852; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 729864.2708; train_global_loss: 3885528.2500; train_optim_loss: 3885528.2500; val_kl_reg_loss: 14140.6016; val_edge_recon_loss: 2657182.0000; val_gene_expr_recon_loss: 479992.0625; val_masked_gp_l1_reg_loss: 6042.1294; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 741108.3125; val_global_loss: 3898465.0000; val_optim_loss: 3898465.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9761; val_auprc_score: 0.9687; val_best_acc_score: 0.9316; val_best_f1_score: 0.9338; train_kl_reg_loss: 27270.7678; train_edge_recon_loss: 2641715.3889; train_gene_expr_recon_loss: 478645.7500; train_masked_gp_l1_reg_loss: 6038.3895; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731998.2292; train_global_loss: 3885668.5556; train_optim_loss: 3885668.5556; val_kl_reg_loss: 14153.9492; val_edge_recon_loss: 2658112.0000; val_gene_expr_recon_loss: 479235.4375; val_masked_gp_l1_reg_loss: 6033.5801; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740515.6250; val_global_loss: 3898050.5000; val_optim_loss: 3898050.5000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9742; val_auprc_score: 0.9642; val_best_acc_score: 0.9321; val_best_f1_score: 0.9343; train_kl_reg_loss: 27164.4418; train_edge_recon_loss: 2634181.1389; train_gene_expr_recon_loss: 476647.9340; train_masked_gp_l1_reg_loss: 6030.7375; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727287.4028; train_global_loss: 3871311.7222; train_optim_loss: 3871311.7222; val_kl_reg_loss: 14339.4229; val_edge_recon_loss: 2657215.2500; val_gene_expr_recon_loss: 479258.2812; val_masked_gp_l1_reg_loss: 6027.2100; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740587.5625; val_global_loss: 3897427.7500; val_optim_loss: 3897427.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9713; val_auprc_score: 0.9618; val_best_acc_score: 0.9306; val_best_f1_score: 0.9330; train_kl_reg_loss: 27245.4484; train_edge_recon_loss: 2642711.4167; train_gene_expr_recon_loss: 477839.0868; train_masked_gp_l1_reg_loss: 6023.6846; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732849.7639; train_global_loss: 3886669.4167; train_optim_loss: 3886669.4167; val_kl_reg_loss: 14337.4141; val_edge_recon_loss: 2647467.5000; val_gene_expr_recon_loss: 479177.5625; val_masked_gp_l1_reg_loss: 6020.3931; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740497.1875; val_global_loss: 3887500.2500; val_optim_loss: 3887500.2500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9765; val_auprc_score: 0.9690; val_best_acc_score: 0.9347; val_best_f1_score: 0.9366; train_kl_reg_loss: 27245.2233; train_edge_recon_loss: 2637392.4444; train_gene_expr_recon_loss: 475745.1285; train_masked_gp_l1_reg_loss: 6019.6128; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732049.0486; train_global_loss: 3878451.5000; train_optim_loss: 3878451.5000; val_kl_reg_loss: 14359.9629; val_edge_recon_loss: 2631325.7500; val_gene_expr_recon_loss: 479044.2500; val_masked_gp_l1_reg_loss: 6018.2686; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740466.8750; val_global_loss: 3871215.0000; val_optim_loss: 3871215.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9754; val_auprc_score: 0.9660; val_best_acc_score: 0.9321; val_best_f1_score: 0.9343; train_kl_reg_loss: 27299.6645; train_edge_recon_loss: 2636009.8333; train_gene_expr_recon_loss: 476778.8056; train_masked_gp_l1_reg_loss: 6017.5222; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 733382.7778; train_global_loss: 3879488.6667; train_optim_loss: 3879488.6667; val_kl_reg_loss: 14426.9414; val_edge_recon_loss: 2645591.5000; val_gene_expr_recon_loss: 478786.3750; val_masked_gp_l1_reg_loss: 6016.7012; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740460.0625; val_global_loss: 3885281.7500; val_optim_loss: 3885281.7500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9736; val_auprc_score: 0.9642; val_best_acc_score: 0.9305; val_best_f1_score: 0.9328; train_kl_reg_loss: 27374.1009; train_edge_recon_loss: 2641491.2500; train_gene_expr_recon_loss: 477769.8958; train_masked_gp_l1_reg_loss: 6016.1457; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 729612.7222; train_global_loss: 3882264.0833; train_optim_loss: 3882264.0833; val_kl_reg_loss: 14435.9766; val_edge_recon_loss: 2653133.2500; val_gene_expr_recon_loss: 478747.3750; val_masked_gp_l1_reg_loss: 6015.5493; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740473.2500; val_global_loss: 3892805.2500; val_optim_loss: 3892805.2500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9768; val_auprc_score: 0.9689; val_best_acc_score: 0.9314; val_best_f1_score: 0.9339; train_kl_reg_loss: 27367.5022; train_edge_recon_loss: 2646985.1667; train_gene_expr_recon_loss: 477574.6493; train_masked_gp_l1_reg_loss: 6015.1951; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 729842.8125; train_global_loss: 3887785.3889; train_optim_loss: 3887785.3889; val_kl_reg_loss: 14423.3418; val_edge_recon_loss: 2646151.7500; val_gene_expr_recon_loss: 478952.9688; val_masked_gp_l1_reg_loss: 6014.7461; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740546.1250; val_global_loss: 3886089.0000; val_optim_loss: 3886089.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9733; val_auprc_score: 0.9624; val_best_acc_score: 0.9305; val_best_f1_score: 0.9328; train_kl_reg_loss: 27376.3147; train_edge_recon_loss: 2638761.0556; train_gene_expr_recon_loss: 480156.4306; train_masked_gp_l1_reg_loss: 6014.4659; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731915.7083; train_global_loss: 3884223.9444; train_optim_loss: 3884223.9444; val_kl_reg_loss: 14411.8525; val_edge_recon_loss: 2680518.2500; val_gene_expr_recon_loss: 479077.9375; val_masked_gp_l1_reg_loss: 6014.1143; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740533.6875; val_global_loss: 3920555.7500; val_optim_loss: 3920555.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9768; val_auprc_score: 0.9693; val_best_acc_score: 0.9365; val_best_f1_score: 0.9383; train_kl_reg_loss: 27336.7133; train_edge_recon_loss: 2640401.4444; train_gene_expr_recon_loss: 478303.3611; train_masked_gp_l1_reg_loss: 6013.7601; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731265.4097; train_global_loss: 3883320.6389; train_optim_loss: 3883320.6389; val_kl_reg_loss: 14476.3369; val_edge_recon_loss: 2650846.7500; val_gene_expr_recon_loss: 479073.5000; val_masked_gp_l1_reg_loss: 6013.4321; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740567.0625; val_global_loss: 3890977.0000; val_optim_loss: 3890977.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9757; val_auprc_score: 0.9655; val_best_acc_score: 0.9332; val_best_f1_score: 0.9353; train_kl_reg_loss: 27382.0762; train_edge_recon_loss: 2643389.5000; train_gene_expr_recon_loss: 479687.7882; train_masked_gp_l1_reg_loss: 6013.3612; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732474.5972; train_global_loss: 3888947.3611; train_optim_loss: 3888947.3611; val_kl_reg_loss: 14480.3711; val_edge_recon_loss: 2644440.5000; val_gene_expr_recon_loss: 479042.2500; val_masked_gp_l1_reg_loss: 6013.2329; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740504.0625; val_global_loss: 3884480.2500; val_optim_loss: 3884480.2500
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9737; val_auprc_score: 0.9612; val_best_acc_score: 0.9322; val_best_f1_score: 0.9344; train_kl_reg_loss: 27256.1298; train_edge_recon_loss: 2635693.5556; train_gene_expr_recon_loss: 479468.7222; train_masked_gp_l1_reg_loss: 6013.1635; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731037.0833; train_global_loss: 3879468.6667; train_optim_loss: 3879468.6667; val_kl_reg_loss: 14549.2070; val_edge_recon_loss: 2653723.2500; val_gene_expr_recon_loss: 479009.2500; val_masked_gp_l1_reg_loss: 6013.0854; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740543.9375; val_global_loss: 3893838.7500; val_optim_loss: 3893838.7500
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9753; val_auprc_score: 0.9676; val_best_acc_score: 0.9305; val_best_f1_score: 0.9328; train_kl_reg_loss: 27218.7750; train_edge_recon_loss: 2644450.8333; train_gene_expr_recon_loss: 472939.6181; train_masked_gp_l1_reg_loss: 6013.0320; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 722004.3194; train_global_loss: 3872626.5278; train_optim_loss: 3872626.5278; val_kl_reg_loss: 14470.6230; val_edge_recon_loss: 2665214.7500; val_gene_expr_recon_loss: 478970.4062; val_masked_gp_l1_reg_loss: 6012.9697; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740500.9375; val_global_loss: 3905169.7500; val_optim_loss: 3905169.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9743
val AUPRC score: 0.9620
val best accuracy score: 0.9322
val best F1 score: 0.9340
val target rna MSE score: 0.4146
val source rna MSE score: 0.2543
val target atac MSE score: 0.1333
val source atac MSE score: 0.0214
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
