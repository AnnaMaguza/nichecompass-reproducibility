[True]
Run timestamp: 26072023_033726_130.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_130']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9675; val_auprc_score: 0.9707; val_best_acc_score: 0.8950; val_best_f1_score: 0.8867; train_kl_reg_loss: 2568.4541; train_edge_recon_loss: 34672717.3333; train_gene_expr_recon_loss: 3195448.0278; train_masked_gp_l1_reg_loss: 1852.0471; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1077734.1944; train_global_loss: 38950320.0000; train_optim_loss: 38950320.0000; val_kl_reg_loss: 1360.4895; val_edge_recon_loss: 40382544.0000; val_gene_expr_recon_loss: 3105509.0000; val_masked_gp_l1_reg_loss: 1840.6891; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1071708.8750; val_global_loss: 44562960.0000; val_optim_loss: 44562960.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9201; val_auprc_score: 0.9159; val_best_acc_score: 0.8188; val_best_f1_score: 0.8352; train_kl_reg_loss: 1096.3737; train_edge_recon_loss: 34622169.7778; train_gene_expr_recon_loss: 3105918.0556; train_masked_gp_l1_reg_loss: 1886.8476; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1075904.0417; train_global_loss: 38806975.1111; train_optim_loss: 38806975.1111; val_kl_reg_loss: 1049.6506; val_edge_recon_loss: 38484968.0000; val_gene_expr_recon_loss: 3002910.7500; val_masked_gp_l1_reg_loss: 1973.8613; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1066997.2500; val_global_loss: 42557896.0000; val_optim_loss: 42557896.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8478; val_auprc_score: 0.8395; val_best_acc_score: 0.7503; val_best_f1_score: 0.7777; train_kl_reg_loss: 1815.4794; train_edge_recon_loss: 33502879.3333; train_gene_expr_recon_loss: 3010898.5278; train_masked_gp_l1_reg_loss: 2083.6430; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1071606.9722; train_global_loss: 37589284.4444; train_optim_loss: 37589284.4444; val_kl_reg_loss: 5102.3169; val_edge_recon_loss: 30862402.0000; val_gene_expr_recon_loss: 2897084.7500; val_masked_gp_l1_reg_loss: 2233.5234; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061972.6250; val_global_loss: 34828792.0000; val_optim_loss: 34828792.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8674; val_auprc_score: 0.8639; val_best_acc_score: 0.7673; val_best_f1_score: 0.7825; train_kl_reg_loss: 12257.9694; train_edge_recon_loss: 29765829.3333; train_gene_expr_recon_loss: 2986727.5833; train_masked_gp_l1_reg_loss: 2335.0930; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1075375.2778; train_global_loss: 33842525.1111; train_optim_loss: 33842525.1111; val_kl_reg_loss: 22423.7031; val_edge_recon_loss: 28841280.0000; val_gene_expr_recon_loss: 2940487.0000; val_masked_gp_l1_reg_loss: 2430.5840; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1063708.7500; val_global_loss: 32870330.0000; val_optim_loss: 32870330.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8907; val_auprc_score: 0.8765; val_best_acc_score: 0.8003; val_best_f1_score: 0.8137; train_kl_reg_loss: 31309.9364; train_edge_recon_loss: 28284558.0000; train_gene_expr_recon_loss: 2942815.3889; train_masked_gp_l1_reg_loss: 2501.3304; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1062907.1528; train_global_loss: 32324091.7778; train_optim_loss: 32324091.7778; val_kl_reg_loss: 36600.7617; val_edge_recon_loss: 28103430.0000; val_gene_expr_recon_loss: 2865917.0000; val_masked_gp_l1_reg_loss: 2588.6855; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059152.0000; val_global_loss: 32067688.0000; val_optim_loss: 32067688.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9091; val_auprc_score: 0.8780; val_best_acc_score: 0.8448; val_best_f1_score: 0.8579; train_kl_reg_loss: 42031.9210; train_edge_recon_loss: 27511732.2222; train_gene_expr_recon_loss: 2874301.5278; train_masked_gp_l1_reg_loss: 2649.1592; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1061489.4306; train_global_loss: 31492204.0000; train_optim_loss: 31492204.0000; val_kl_reg_loss: 42910.3750; val_edge_recon_loss: 27616638.0000; val_gene_expr_recon_loss: 2830387.0000; val_masked_gp_l1_reg_loss: 2713.4463; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051184.8750; val_global_loss: 31543834.0000; val_optim_loss: 31543834.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9288; val_auprc_score: 0.9065; val_best_acc_score: 0.8719; val_best_f1_score: 0.8791; train_kl_reg_loss: 47125.7496; train_edge_recon_loss: 27175002.6667; train_gene_expr_recon_loss: 2789151.5833; train_masked_gp_l1_reg_loss: 2757.1484; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047217.4028; train_global_loss: 31061254.6667; train_optim_loss: 31061254.6667; val_kl_reg_loss: 47135.0938; val_edge_recon_loss: 27088770.0000; val_gene_expr_recon_loss: 2751771.5000; val_masked_gp_l1_reg_loss: 2813.8027; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1045402.0000; val_global_loss: 30935894.0000; val_optim_loss: 30935894.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9233; val_auprc_score: 0.8982; val_best_acc_score: 0.8655; val_best_f1_score: 0.8725; train_kl_reg_loss: 52110.7448; train_edge_recon_loss: 27032177.5556; train_gene_expr_recon_loss: 2741404.5278; train_masked_gp_l1_reg_loss: 2857.0167; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047028.8889; train_global_loss: 30875578.6667; train_optim_loss: 30875578.6667; val_kl_reg_loss: 51815.5117; val_edge_recon_loss: 27566692.0000; val_gene_expr_recon_loss: 2690890.7500; val_masked_gp_l1_reg_loss: 2913.9263; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1043127.8750; val_global_loss: 31355440.0000; val_optim_loss: 31355440.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9279; val_auprc_score: 0.9031; val_best_acc_score: 0.8724; val_best_f1_score: 0.8803; train_kl_reg_loss: 55193.6259; train_edge_recon_loss: 27048523.7778; train_gene_expr_recon_loss: 2696367.5556; train_masked_gp_l1_reg_loss: 2961.7245; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1038860.1181; train_global_loss: 30841906.8889; train_optim_loss: 30841906.8889; val_kl_reg_loss: 53050.7969; val_edge_recon_loss: 27096784.0000; val_gene_expr_recon_loss: 2661865.5000; val_masked_gp_l1_reg_loss: 3021.4067; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1040516.2500; val_global_loss: 30855238.0000; val_optim_loss: 30855238.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9324; val_auprc_score: 0.9085; val_best_acc_score: 0.8746; val_best_f1_score: 0.8833; train_kl_reg_loss: 57258.2956; train_edge_recon_loss: 27063120.8889; train_gene_expr_recon_loss: 2653402.5556; train_masked_gp_l1_reg_loss: 3069.8376; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046120.2153; train_global_loss: 30822972.0000; train_optim_loss: 30822972.0000; val_kl_reg_loss: 54655.4297; val_edge_recon_loss: 27312392.0000; val_gene_expr_recon_loss: 2626015.5000; val_masked_gp_l1_reg_loss: 3126.8701; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1036160.8750; val_global_loss: 31032350.0000; val_optim_loss: 31032350.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9414; val_auprc_score: 0.9200; val_best_acc_score: 0.8861; val_best_f1_score: 0.8923; train_kl_reg_loss: 58261.0443; train_edge_recon_loss: 26990085.1111; train_gene_expr_recon_loss: 2622046.3333; train_masked_gp_l1_reg_loss: 3167.6659; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1037479.1319; train_global_loss: 30711038.6667; train_optim_loss: 30711038.6667; val_kl_reg_loss: 56432.2305; val_edge_recon_loss: 26794756.0000; val_gene_expr_recon_loss: 2576053.2500; val_masked_gp_l1_reg_loss: 3218.6104; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1033623.6250; val_global_loss: 30464084.0000; val_optim_loss: 30464084.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9417; val_auprc_score: 0.9218; val_best_acc_score: 0.8825; val_best_f1_score: 0.8892; train_kl_reg_loss: 59148.7921; train_edge_recon_loss: 27032095.1111; train_gene_expr_recon_loss: 2574406.3056; train_masked_gp_l1_reg_loss: 3259.1595; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1032064.4514; train_global_loss: 30700973.5556; train_optim_loss: 30700973.5556; val_kl_reg_loss: 56478.5430; val_edge_recon_loss: 27062324.0000; val_gene_expr_recon_loss: 2551604.5000; val_masked_gp_l1_reg_loss: 3308.2109; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1029854.8750; val_global_loss: 30703568.0000; val_optim_loss: 30703568.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9484; val_auprc_score: 0.9347; val_best_acc_score: 0.8859; val_best_f1_score: 0.8927; train_kl_reg_loss: 60007.8971; train_edge_recon_loss: 26873190.2222; train_gene_expr_recon_loss: 2554286.1944; train_masked_gp_l1_reg_loss: 3347.7697; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1032735.0625; train_global_loss: 30523566.8889; train_optim_loss: 30523566.8889; val_kl_reg_loss: 56506.0703; val_edge_recon_loss: 26869794.0000; val_gene_expr_recon_loss: 2557152.2500; val_masked_gp_l1_reg_loss: 3395.1953; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027858.4375; val_global_loss: 30514706.0000; val_optim_loss: 30514706.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9445; val_auprc_score: 0.9270; val_best_acc_score: 0.8871; val_best_f1_score: 0.8933; train_kl_reg_loss: 59720.5929; train_edge_recon_loss: 26933157.7778; train_gene_expr_recon_loss: 2518252.3333; train_masked_gp_l1_reg_loss: 3430.6946; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1027903.7778; train_global_loss: 30542465.7778; train_optim_loss: 30542465.7778; val_kl_reg_loss: 56516.5195; val_edge_recon_loss: 26998022.0000; val_gene_expr_recon_loss: 2488275.0000; val_masked_gp_l1_reg_loss: 3474.5352; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1024281.5625; val_global_loss: 30570568.0000; val_optim_loss: 30570568.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9535; val_auprc_score: 0.9361; val_best_acc_score: 0.9011; val_best_f1_score: 0.9055; train_kl_reg_loss: 59298.8746; train_edge_recon_loss: 26893769.3333; train_gene_expr_recon_loss: 2516453.5000; train_masked_gp_l1_reg_loss: 3506.8583; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1031279.0278; train_global_loss: 30504307.3333; train_optim_loss: 30504307.3333; val_kl_reg_loss: 56458.6094; val_edge_recon_loss: 26862422.0000; val_gene_expr_recon_loss: 2510881.0000; val_masked_gp_l1_reg_loss: 3544.4365; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1025150.5625; val_global_loss: 30458454.0000; val_optim_loss: 30458454.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9570; val_auprc_score: 0.9441; val_best_acc_score: 0.9004; val_best_f1_score: 0.9049; train_kl_reg_loss: 59332.1011; train_edge_recon_loss: 26772930.2222; train_gene_expr_recon_loss: 2489141.8889; train_masked_gp_l1_reg_loss: 3573.3964; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1027324.1597; train_global_loss: 30352302.6667; train_optim_loss: 30352302.6667; val_kl_reg_loss: 56221.4531; val_edge_recon_loss: 26969964.0000; val_gene_expr_recon_loss: 2468995.5000; val_masked_gp_l1_reg_loss: 3606.0444; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1019376.2500; val_global_loss: 30518164.0000; val_optim_loss: 30518164.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9557; val_auprc_score: 0.9352; val_best_acc_score: 0.9022; val_best_f1_score: 0.9060; train_kl_reg_loss: 59739.4983; train_edge_recon_loss: 26648812.6667; train_gene_expr_recon_loss: 2470278.8333; train_masked_gp_l1_reg_loss: 3628.9876; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1021988.8958; train_global_loss: 30204448.8889; train_optim_loss: 30204448.8889; val_kl_reg_loss: 57526.8672; val_edge_recon_loss: 26764652.0000; val_gene_expr_recon_loss: 2491178.0000; val_masked_gp_l1_reg_loss: 3655.7192; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1021150.0625; val_global_loss: 30338162.0000; val_optim_loss: 30338162.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9590; val_auprc_score: 0.9454; val_best_acc_score: 0.9069; val_best_f1_score: 0.9108; train_kl_reg_loss: 61246.2248; train_edge_recon_loss: 26545873.3333; train_gene_expr_recon_loss: 2454151.6111; train_masked_gp_l1_reg_loss: 3677.6169; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1023446.2153; train_global_loss: 30088395.1111; train_optim_loss: 30088395.1111; val_kl_reg_loss: 58708.1484; val_edge_recon_loss: 26675552.0000; val_gene_expr_recon_loss: 2439624.7500; val_masked_gp_l1_reg_loss: 3702.9285; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016169.5000; val_global_loss: 30193756.0000; val_optim_loss: 30193756.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9608; val_auprc_score: 0.9468; val_best_acc_score: 0.9080; val_best_f1_score: 0.9113; train_kl_reg_loss: 63772.5655; train_edge_recon_loss: 26513392.8889; train_gene_expr_recon_loss: 2441435.9722; train_masked_gp_l1_reg_loss: 3724.3482; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1018810.3194; train_global_loss: 30041136.2222; train_optim_loss: 30041136.2222; val_kl_reg_loss: 61509.2227; val_edge_recon_loss: 26639884.0000; val_gene_expr_recon_loss: 2413968.2500; val_masked_gp_l1_reg_loss: 3748.7559; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013085.5000; val_global_loss: 30132196.0000; val_optim_loss: 30132196.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9652; val_auprc_score: 0.9525; val_best_acc_score: 0.9139; val_best_f1_score: 0.9171; train_kl_reg_loss: 66729.8051; train_edge_recon_loss: 26539043.5556; train_gene_expr_recon_loss: 2422262.9722; train_masked_gp_l1_reg_loss: 3768.3171; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1023158.2153; train_global_loss: 30054962.8889; train_optim_loss: 30054962.8889; val_kl_reg_loss: 63381.5938; val_edge_recon_loss: 26772606.0000; val_gene_expr_recon_loss: 2428761.0000; val_masked_gp_l1_reg_loss: 3791.3357; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013769.8750; val_global_loss: 30282310.0000; val_optim_loss: 30282310.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9665; val_auprc_score: 0.9505; val_best_acc_score: 0.9216; val_best_f1_score: 0.9239; train_kl_reg_loss: 67035.1493; train_edge_recon_loss: 26404637.1111; train_gene_expr_recon_loss: 2405040.7778; train_masked_gp_l1_reg_loss: 3810.0748; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1016278.2431; train_global_loss: 29896801.7778; train_optim_loss: 29896801.7778; val_kl_reg_loss: 63172.7930; val_edge_recon_loss: 26464502.0000; val_gene_expr_recon_loss: 2418216.5000; val_masked_gp_l1_reg_loss: 3830.3037; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1011981.3125; val_global_loss: 29961702.0000; val_optim_loss: 29961702.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9645; val_auprc_score: 0.9510; val_best_acc_score: 0.9194; val_best_f1_score: 0.9227; train_kl_reg_loss: 66638.3394; train_edge_recon_loss: 26402275.7778; train_gene_expr_recon_loss: 2384166.6389; train_masked_gp_l1_reg_loss: 3845.3352; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1006666.4583; train_global_loss: 29863592.6667; train_optim_loss: 29863592.6667; val_kl_reg_loss: 63359.4453; val_edge_recon_loss: 26616588.0000; val_gene_expr_recon_loss: 2377643.2500; val_masked_gp_l1_reg_loss: 3860.9988; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1007990.5625; val_global_loss: 30069442.0000; val_optim_loss: 30069442.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9696; val_auprc_score: 0.9564; val_best_acc_score: 0.9239; val_best_f1_score: 0.9267; train_kl_reg_loss: 67687.7543; train_edge_recon_loss: 26381274.8889; train_gene_expr_recon_loss: 2379486.1667; train_masked_gp_l1_reg_loss: 3874.6486; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011334.8958; train_global_loss: 29843658.6667; train_optim_loss: 29843658.6667; val_kl_reg_loss: 66014.7656; val_edge_recon_loss: 26581460.0000; val_gene_expr_recon_loss: 2380810.5000; val_masked_gp_l1_reg_loss: 3891.1768; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1009187.2500; val_global_loss: 30041364.0000; val_optim_loss: 30041364.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9721; val_auprc_score: 0.9604; val_best_acc_score: 0.9281; val_best_f1_score: 0.9303; train_kl_reg_loss: 69758.9809; train_edge_recon_loss: 26466281.1111; train_gene_expr_recon_loss: 2358570.5000; train_masked_gp_l1_reg_loss: 3903.5152; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1009528.4097; train_global_loss: 29908042.0000; train_optim_loss: 29908042.0000; val_kl_reg_loss: 66855.7656; val_edge_recon_loss: 26361462.0000; val_gene_expr_recon_loss: 2386029.7500; val_masked_gp_l1_reg_loss: 3916.4609; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1009365.7500; val_global_loss: 29827630.0000; val_optim_loss: 29827630.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9723; val_auprc_score: 0.9614; val_best_acc_score: 0.9316; val_best_f1_score: 0.9331; train_kl_reg_loss: 70842.7257; train_edge_recon_loss: 26401640.4444; train_gene_expr_recon_loss: 2367925.7222; train_masked_gp_l1_reg_loss: 3927.4747; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1013866.7986; train_global_loss: 29858203.1111; train_optim_loss: 29858203.1111; val_kl_reg_loss: 66427.7500; val_edge_recon_loss: 26414308.0000; val_gene_expr_recon_loss: 2361030.5000; val_masked_gp_l1_reg_loss: 3938.2773; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005492.0625; val_global_loss: 29851196.0000; val_optim_loss: 29851196.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9718; val_auprc_score: 0.9609; val_best_acc_score: 0.9274; val_best_f1_score: 0.9293; train_kl_reg_loss: 67946.3455; train_edge_recon_loss: 26372189.3333; train_gene_expr_recon_loss: 2370218.1944; train_masked_gp_l1_reg_loss: 3958.7950; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1012809.1944; train_global_loss: 29827122.2222; train_optim_loss: 29827122.2222; val_kl_reg_loss: 45651.0391; val_edge_recon_loss: 26601056.0000; val_gene_expr_recon_loss: 2378098.7500; val_masked_gp_l1_reg_loss: 3979.7539; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1007611.6875; val_global_loss: 30036398.0000; val_optim_loss: 30036398.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9729; val_auprc_score: 0.9569; val_best_acc_score: 0.9310; val_best_f1_score: 0.9328; train_kl_reg_loss: 68074.4661; train_edge_recon_loss: 26377115.3333; train_gene_expr_recon_loss: 2375941.3889; train_masked_gp_l1_reg_loss: 3991.4443; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1009827.1667; train_global_loss: 29834949.3333; train_optim_loss: 29834949.3333; val_kl_reg_loss: 44807.1016; val_edge_recon_loss: 26367882.0000; val_gene_expr_recon_loss: 2380662.2500; val_masked_gp_l1_reg_loss: 4001.1401; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1006555.8125; val_global_loss: 29803910.0000; val_optim_loss: 29803910.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9753; val_auprc_score: 0.9619; val_best_acc_score: 0.9324; val_best_f1_score: 0.9344; train_kl_reg_loss: 67360.9271; train_edge_recon_loss: 26325248.8889; train_gene_expr_recon_loss: 2363882.4444; train_masked_gp_l1_reg_loss: 4007.2952; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1009997.1597; train_global_loss: 29770496.0000; train_optim_loss: 29770496.0000; val_kl_reg_loss: 43746.5312; val_edge_recon_loss: 26422852.0000; val_gene_expr_recon_loss: 2384649.2500; val_masked_gp_l1_reg_loss: 4012.4243; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1007255.1250; val_global_loss: 29862516.0000; val_optim_loss: 29862516.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9758; val_auprc_score: 0.9669; val_best_acc_score: 0.9322; val_best_f1_score: 0.9337; train_kl_reg_loss: 66139.5946; train_edge_recon_loss: 26393913.5556; train_gene_expr_recon_loss: 2359725.3889; train_masked_gp_l1_reg_loss: 4016.3343; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005327.0208; train_global_loss: 29829122.2222; train_optim_loss: 29829122.2222; val_kl_reg_loss: 41810.0234; val_edge_recon_loss: 26444968.0000; val_gene_expr_recon_loss: 2359859.2500; val_masked_gp_l1_reg_loss: 4018.0396; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005049.6875; val_global_loss: 29855706.0000; val_optim_loss: 29855706.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9774; val_auprc_score: 0.9679; val_best_acc_score: 0.9341; val_best_f1_score: 0.9362; train_kl_reg_loss: 64387.2153; train_edge_recon_loss: 26309151.1111; train_gene_expr_recon_loss: 2354778.5556; train_masked_gp_l1_reg_loss: 4019.4427; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005428.6667; train_global_loss: 29737765.1111; train_optim_loss: 29737765.1111; val_kl_reg_loss: 40937.1953; val_edge_recon_loss: 26452208.0000; val_gene_expr_recon_loss: 2379816.7500; val_masked_gp_l1_reg_loss: 4020.5090; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1006469.4375; val_global_loss: 29883452.0000; val_optim_loss: 29883452.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9755; val_auprc_score: 0.9660; val_best_acc_score: 0.9309; val_best_f1_score: 0.9325; train_kl_reg_loss: 63488.6094; train_edge_recon_loss: 26205688.0000; train_gene_expr_recon_loss: 2360783.1944; train_masked_gp_l1_reg_loss: 4023.2007; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007711.2778; train_global_loss: 29641694.4444; train_optim_loss: 29641694.4444; val_kl_reg_loss: 40040.0703; val_edge_recon_loss: 26495766.0000; val_gene_expr_recon_loss: 2367132.7500; val_masked_gp_l1_reg_loss: 4024.6431; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003573.6875; val_global_loss: 29910536.0000; val_optim_loss: 29910536.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9769; val_auprc_score: 0.9655; val_best_acc_score: 0.9352; val_best_f1_score: 0.9371; train_kl_reg_loss: 62437.9128; train_edge_recon_loss: 26277520.0000; train_gene_expr_recon_loss: 2343159.3889; train_masked_gp_l1_reg_loss: 4024.6584; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002009.2153; train_global_loss: 29689150.8889; train_optim_loss: 29689150.8889; val_kl_reg_loss: 39589.4375; val_edge_recon_loss: 26350558.0000; val_gene_expr_recon_loss: 2382230.5000; val_masked_gp_l1_reg_loss: 4024.3433; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005606.5000; val_global_loss: 29782008.0000; val_optim_loss: 29782008.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9774; val_auprc_score: 0.9682; val_best_acc_score: 0.9347; val_best_f1_score: 0.9366; train_kl_reg_loss: 62625.4740; train_edge_recon_loss: 26319335.3333; train_gene_expr_recon_loss: 2345436.8611; train_masked_gp_l1_reg_loss: 4023.9723; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1001978.5833; train_global_loss: 29733400.0000; train_optim_loss: 29733400.0000; val_kl_reg_loss: 39744.5312; val_edge_recon_loss: 26285738.0000; val_gene_expr_recon_loss: 2377778.2500; val_masked_gp_l1_reg_loss: 4023.5217; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004385.9375; val_global_loss: 29711670.0000; val_optim_loss: 29711670.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9763; val_auprc_score: 0.9683; val_best_acc_score: 0.9345; val_best_f1_score: 0.9365; train_kl_reg_loss: 62491.1905; train_edge_recon_loss: 26258433.3333; train_gene_expr_recon_loss: 2341814.1111; train_masked_gp_l1_reg_loss: 4023.0617; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003687.8819; train_global_loss: 29670449.1111; train_optim_loss: 29670449.1111; val_kl_reg_loss: 39704.8125; val_edge_recon_loss: 26356410.0000; val_gene_expr_recon_loss: 2370172.5000; val_masked_gp_l1_reg_loss: 4022.4653; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003444.4375; val_global_loss: 29773752.0000; val_optim_loss: 29773752.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9813; val_auprc_score: 0.9760; val_best_acc_score: 0.9363; val_best_f1_score: 0.9381; train_kl_reg_loss: 62791.6701; train_edge_recon_loss: 26272558.2222; train_gene_expr_recon_loss: 2343184.7778; train_masked_gp_l1_reg_loss: 4022.0645; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1004310.1042; train_global_loss: 29686867.1111; train_optim_loss: 29686867.1111; val_kl_reg_loss: 39384.7031; val_edge_recon_loss: 26278594.0000; val_gene_expr_recon_loss: 2380254.0000; val_masked_gp_l1_reg_loss: 4021.6533; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005439.5000; val_global_loss: 29707694.0000; val_optim_loss: 29707694.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9767; val_auprc_score: 0.9670; val_best_acc_score: 0.9369; val_best_f1_score: 0.9387; train_kl_reg_loss: 62149.4253; train_edge_recon_loss: 26229206.8889; train_gene_expr_recon_loss: 2347909.7778; train_masked_gp_l1_reg_loss: 4021.2741; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1006865.7639; train_global_loss: 29650153.5556; train_optim_loss: 29650153.5556; val_kl_reg_loss: 39442.3633; val_edge_recon_loss: 26398522.0000; val_gene_expr_recon_loss: 2374233.7500; val_masked_gp_l1_reg_loss: 4020.9961; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005168.3750; val_global_loss: 29821386.0000; val_optim_loss: 29821386.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9749; val_auprc_score: 0.9609; val_best_acc_score: 0.9352; val_best_f1_score: 0.9371; train_kl_reg_loss: 61928.9922; train_edge_recon_loss: 26206888.4444; train_gene_expr_recon_loss: 2339399.8611; train_masked_gp_l1_reg_loss: 4021.0248; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 999915.1042; train_global_loss: 29612153.5556; train_optim_loss: 29612153.5556; val_kl_reg_loss: 39457.6289; val_edge_recon_loss: 26277170.0000; val_gene_expr_recon_loss: 2376116.0000; val_masked_gp_l1_reg_loss: 4021.1038; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003919.6875; val_global_loss: 29700686.0000; val_optim_loss: 29700686.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9782; val_auprc_score: 0.9691; val_best_acc_score: 0.9360; val_best_f1_score: 0.9379; train_kl_reg_loss: 62045.9670; train_edge_recon_loss: 26210790.2222; train_gene_expr_recon_loss: 2338454.6111; train_masked_gp_l1_reg_loss: 4021.1838; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003754.6111; train_global_loss: 29619067.3333; train_optim_loss: 29619067.3333; val_kl_reg_loss: 39450.4375; val_edge_recon_loss: 26462752.0000; val_gene_expr_recon_loss: 2370398.2500; val_masked_gp_l1_reg_loss: 4021.2378; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003449.8750; val_global_loss: 29880072.0000; val_optim_loss: 29880072.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9808; val_auprc_score: 0.9732; val_best_acc_score: 0.9409; val_best_f1_score: 0.9423; train_kl_reg_loss: 61672.9210; train_edge_recon_loss: 26210406.8889; train_gene_expr_recon_loss: 2330712.1111; train_masked_gp_l1_reg_loss: 4021.3183; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 995113.9653; train_global_loss: 29601927.5556; train_optim_loss: 29601927.5556; val_kl_reg_loss: 39813.2266; val_edge_recon_loss: 26195416.0000; val_gene_expr_recon_loss: 2372133.2500; val_masked_gp_l1_reg_loss: 4021.5010; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004766.7500; val_global_loss: 29616152.0000; val_optim_loss: 29616152.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9800; val_auprc_score: 0.9694; val_best_acc_score: 0.9396; val_best_f1_score: 0.9407; train_kl_reg_loss: 62022.7222; train_edge_recon_loss: 26236954.2222; train_gene_expr_recon_loss: 2344565.7778; train_masked_gp_l1_reg_loss: 4021.7537; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1004273.0278; train_global_loss: 29651838.2222; train_optim_loss: 29651838.2222; val_kl_reg_loss: 39270.4375; val_edge_recon_loss: 26182520.0000; val_gene_expr_recon_loss: 2368123.2500; val_masked_gp_l1_reg_loss: 4022.0527; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003847.1875; val_global_loss: 29597784.0000; val_optim_loss: 29597784.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9754; val_auprc_score: 0.9637; val_best_acc_score: 0.9340; val_best_f1_score: 0.9355; train_kl_reg_loss: 61975.5069; train_edge_recon_loss: 26235299.7778; train_gene_expr_recon_loss: 2340577.7778; train_masked_gp_l1_reg_loss: 4022.4253; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 999892.2292; train_global_loss: 29641767.1111; train_optim_loss: 29641767.1111; val_kl_reg_loss: 39105.7422; val_edge_recon_loss: 26569098.0000; val_gene_expr_recon_loss: 2373094.7500; val_masked_gp_l1_reg_loss: 4022.8979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004361.1250; val_global_loss: 29989682.0000; val_optim_loss: 29989682.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9789; val_auprc_score: 0.9691; val_best_acc_score: 0.9392; val_best_f1_score: 0.9403; train_kl_reg_loss: 62523.5699; train_edge_recon_loss: 26161151.7778; train_gene_expr_recon_loss: 2351031.0278; train_masked_gp_l1_reg_loss: 4023.2384; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003529.4167; train_global_loss: 29582259.1111; train_optim_loss: 29582259.1111; val_kl_reg_loss: 38896.5078; val_edge_recon_loss: 26154382.0000; val_gene_expr_recon_loss: 2367616.2500; val_masked_gp_l1_reg_loss: 4023.7085; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003089.3750; val_global_loss: 29568008.0000; val_optim_loss: 29568008.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9791; val_auprc_score: 0.9712; val_best_acc_score: 0.9386; val_best_f1_score: 0.9402; train_kl_reg_loss: 61720.2843; train_edge_recon_loss: 26187448.4444; train_gene_expr_recon_loss: 2335665.8889; train_masked_gp_l1_reg_loss: 4024.2760; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002986.9236; train_global_loss: 29591845.1111; train_optim_loss: 29591845.1111; val_kl_reg_loss: 39216.8711; val_edge_recon_loss: 26271900.0000; val_gene_expr_recon_loss: 2372832.0000; val_masked_gp_l1_reg_loss: 4024.8413; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004457.4375; val_global_loss: 29692430.0000; val_optim_loss: 29692430.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9782; val_auprc_score: 0.9699; val_best_acc_score: 0.9365; val_best_f1_score: 0.9380; train_kl_reg_loss: 61933.9236; train_edge_recon_loss: 26205286.6667; train_gene_expr_recon_loss: 2339744.6944; train_masked_gp_l1_reg_loss: 4025.1198; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1004050.5139; train_global_loss: 29615040.8889; train_optim_loss: 29615040.8889; val_kl_reg_loss: 39000.3906; val_edge_recon_loss: 26400738.0000; val_gene_expr_recon_loss: 2367762.2500; val_masked_gp_l1_reg_loss: 4025.5090; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004420.1875; val_global_loss: 29815946.0000; val_optim_loss: 29815946.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9803; val_auprc_score: 0.9744; val_best_acc_score: 0.9379; val_best_f1_score: 0.9392; train_kl_reg_loss: 62392.0026; train_edge_recon_loss: 26187773.7778; train_gene_expr_recon_loss: 2351433.1111; train_masked_gp_l1_reg_loss: 4025.9039; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007535.6458; train_global_loss: 29613160.2222; train_optim_loss: 29613160.2222; val_kl_reg_loss: 39246.0938; val_edge_recon_loss: 26359862.0000; val_gene_expr_recon_loss: 2369808.0000; val_masked_gp_l1_reg_loss: 4026.4526; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003510.6875; val_global_loss: 29776452.0000; val_optim_loss: 29776452.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9753; val_auprc_score: 0.9650; val_best_acc_score: 0.9298; val_best_f1_score: 0.9321; train_kl_reg_loss: 61131.7205; train_edge_recon_loss: 26217094.2222; train_gene_expr_recon_loss: 2335725.4444; train_masked_gp_l1_reg_loss: 4027.1124; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003527.9722; train_global_loss: 29621506.8889; train_optim_loss: 29621506.8889; val_kl_reg_loss: 38956.6328; val_edge_recon_loss: 26507514.0000; val_gene_expr_recon_loss: 2366013.2500; val_masked_gp_l1_reg_loss: 4027.8250; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1003888.3125; val_global_loss: 29920400.0000; val_optim_loss: 29920400.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9782; val_auprc_score: 0.9682; val_best_acc_score: 0.9373; val_best_f1_score: 0.9387; train_kl_reg_loss: 61512.6979; train_edge_recon_loss: 26278072.6667; train_gene_expr_recon_loss: 2337791.6667; train_masked_gp_l1_reg_loss: 4027.8469; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003721.4653; train_global_loss: 29685126.2222; train_optim_loss: 29685126.2222; val_kl_reg_loss: 39245.7461; val_edge_recon_loss: 26208692.0000; val_gene_expr_recon_loss: 2365699.5000; val_masked_gp_l1_reg_loss: 4027.8706; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005027.3125; val_global_loss: 29622694.0000; val_optim_loss: 29622694.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9796; val_auprc_score: 0.9721; val_best_acc_score: 0.9356; val_best_f1_score: 0.9372; train_kl_reg_loss: 61468.0347; train_edge_recon_loss: 26280557.5556; train_gene_expr_recon_loss: 2338163.6944; train_masked_gp_l1_reg_loss: 4027.8959; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1008152.8264; train_global_loss: 29692370.6667; train_optim_loss: 29692370.6667; val_kl_reg_loss: 39132.8906; val_edge_recon_loss: 26159254.0000; val_gene_expr_recon_loss: 2365424.0000; val_masked_gp_l1_reg_loss: 4027.9226; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004361.6250; val_global_loss: 29572200.0000; val_optim_loss: 29572200.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9755; val_auprc_score: 0.9647; val_best_acc_score: 0.9314; val_best_f1_score: 0.9333; train_kl_reg_loss: 61771.9714; train_edge_recon_loss: 26153157.7778; train_gene_expr_recon_loss: 2335620.7778; train_masked_gp_l1_reg_loss: 4027.9379; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003197.3542; train_global_loss: 29557776.0000; train_optim_loss: 29557776.0000; val_kl_reg_loss: 38951.9141; val_edge_recon_loss: 26709366.0000; val_gene_expr_recon_loss: 2363793.7500; val_masked_gp_l1_reg_loss: 4027.9651; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1002169.0625; val_global_loss: 30118310.0000; val_optim_loss: 30118310.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9773; val_auprc_score: 0.9691; val_best_acc_score: 0.9345; val_best_f1_score: 0.9366; train_kl_reg_loss: 62145.6476; train_edge_recon_loss: 26216958.4444; train_gene_expr_recon_loss: 2343237.6389; train_masked_gp_l1_reg_loss: 4027.9896; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005235.1944; train_global_loss: 29631605.3333; train_optim_loss: 29631605.3333; val_kl_reg_loss: 39582.1562; val_edge_recon_loss: 26336030.0000; val_gene_expr_recon_loss: 2368546.2500; val_masked_gp_l1_reg_loss: 4028.0181; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005371.2500; val_global_loss: 29753558.0000; val_optim_loss: 29753558.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 28 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9768
Val AUPRC score: 0.9665
Val best accuracy score: 0.9342
Val best F1 score: 0.9361
Val gene expr MSE score: 0.5099
Val chrom access MSE score: 0.0893
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
