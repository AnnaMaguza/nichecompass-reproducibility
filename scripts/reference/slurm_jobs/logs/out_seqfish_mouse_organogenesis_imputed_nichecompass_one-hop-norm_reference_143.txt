[True]
Run timestamp: 27072023_034056_143.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_143']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8786; val_auprc_score: 0.9758; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 376357.9380; train_edge_recon_loss: 10781295.1116; train_gene_expr_recon_loss: 27034353.2884; train_masked_gp_l1_reg_loss: 16306.5307; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38208312.7907; train_optim_loss: 38208312.7907; val_kl_reg_loss: 321411.6719; val_edge_recon_loss: 11931504.1250; val_gene_expr_recon_loss: 21772111.7500; val_masked_gp_l1_reg_loss: 17433.3418; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34042459.8333; val_optim_loss: 34042459.8333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8647; val_auprc_score: 0.9740; val_best_acc_score: 0.8579; val_best_f1_score: 0.9235; train_kl_reg_loss: 306998.5113; train_edge_recon_loss: 10614932.2837; train_gene_expr_recon_loss: 21207057.8512; train_masked_gp_l1_reg_loss: 17658.1985; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32146646.8279; train_optim_loss: 32146646.8279; val_kl_reg_loss: 233248.2741; val_edge_recon_loss: 11557980.7917; val_gene_expr_recon_loss: 20831154.0833; val_masked_gp_l1_reg_loss: 17936.0449; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32640319.2500; val_optim_loss: 32640319.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8682; val_auprc_score: 0.9743; val_best_acc_score: 0.8633; val_best_f1_score: 0.9257; train_kl_reg_loss: 253113.1712; train_edge_recon_loss: 10697850.5605; train_gene_expr_recon_loss: 20693334.5395; train_masked_gp_l1_reg_loss: 18417.6001; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31662715.9814; train_optim_loss: 31662715.9814; val_kl_reg_loss: 210535.7786; val_edge_recon_loss: 11747436.6667; val_gene_expr_recon_loss: 20368872.5000; val_masked_gp_l1_reg_loss: 18762.2246; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32345606.9167; val_optim_loss: 32345606.9167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8612; val_auprc_score: 0.9708; val_best_acc_score: 0.8650; val_best_f1_score: 0.9237; train_kl_reg_loss: 226569.3453; train_edge_recon_loss: 10572528.3907; train_gene_expr_recon_loss: 20171207.6186; train_masked_gp_l1_reg_loss: 19185.5514; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30989490.9302; train_optim_loss: 30989490.9302; val_kl_reg_loss: 188596.5970; val_edge_recon_loss: 12153729.3333; val_gene_expr_recon_loss: 19948203.4167; val_masked_gp_l1_reg_loss: 19721.0645; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32310251.3333; val_optim_loss: 32310251.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8607; val_auprc_score: 0.9715; val_best_acc_score: 0.8759; val_best_f1_score: 0.9304; train_kl_reg_loss: 180257.7699; train_edge_recon_loss: 10570818.6558; train_gene_expr_recon_loss: 11441781.6930; train_masked_gp_l1_reg_loss: 20823.1002; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22213681.2186; train_optim_loss: 22213681.2186; val_kl_reg_loss: 162075.6276; val_edge_recon_loss: 11516777.4583; val_gene_expr_recon_loss: 9410067.1667; val_masked_gp_l1_reg_loss: 21378.9355; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21110298.2500; val_optim_loss: 21110298.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8771; val_auprc_score: 0.9723; val_best_acc_score: 0.8946; val_best_f1_score: 0.9406; train_kl_reg_loss: 141053.5752; train_edge_recon_loss: 10370146.4186; train_gene_expr_recon_loss: 9289540.7674; train_masked_gp_l1_reg_loss: 21820.0820; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19822560.7721; train_optim_loss: 19822560.7721; val_kl_reg_loss: 86104.2490; val_edge_recon_loss: 10050798.5833; val_gene_expr_recon_loss: 9229762.2917; val_masked_gp_l1_reg_loss: 22350.2148; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19389015.3333; val_optim_loss: 19389015.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8610; val_auprc_score: 0.9691; val_best_acc_score: 0.8932; val_best_f1_score: 0.9403; train_kl_reg_loss: 123305.5117; train_edge_recon_loss: 9254765.0814; train_gene_expr_recon_loss: 9105167.3535; train_masked_gp_l1_reg_loss: 23008.4699; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18506246.5581; train_optim_loss: 18506246.5581; val_kl_reg_loss: 158917.8151; val_edge_recon_loss: 8873128.4375; val_gene_expr_recon_loss: 9004325.5833; val_masked_gp_l1_reg_loss: 23630.8398; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18060002.0417; val_optim_loss: 18060002.0417
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8533; val_auprc_score: 0.9652; val_best_acc_score: 0.8928; val_best_f1_score: 0.9399; train_kl_reg_loss: 187033.0228; train_edge_recon_loss: 8873064.2953; train_gene_expr_recon_loss: 8888325.4744; train_masked_gp_l1_reg_loss: 24215.8651; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17972638.6093; train_optim_loss: 17972638.6093; val_kl_reg_loss: 193041.2051; val_edge_recon_loss: 8970445.1875; val_gene_expr_recon_loss: 8808566.2917; val_masked_gp_l1_reg_loss: 24803.6797; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17996856.5833; val_optim_loss: 17996856.5833
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8698; val_auprc_score: 0.9701; val_best_acc_score: 0.8996; val_best_f1_score: 0.9437; train_kl_reg_loss: 194001.4757; train_edge_recon_loss: 8593093.7744; train_gene_expr_recon_loss: 8703883.2093; train_masked_gp_l1_reg_loss: 25404.9399; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17516383.3953; train_optim_loss: 17516383.3953; val_kl_reg_loss: 184806.6829; val_edge_recon_loss: 8492191.6250; val_gene_expr_recon_loss: 8648433.7917; val_masked_gp_l1_reg_loss: 26002.9004; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17351434.3333; val_optim_loss: 17351434.3333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8754; val_auprc_score: 0.9716; val_best_acc_score: 0.8970; val_best_f1_score: 0.9423; train_kl_reg_loss: 187124.0902; train_edge_recon_loss: 8533227.6628; train_gene_expr_recon_loss: 8544561.8093; train_masked_gp_l1_reg_loss: 26561.4203; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17291474.9581; train_optim_loss: 17291474.9581; val_kl_reg_loss: 183587.0410; val_edge_recon_loss: 8468776.5208; val_gene_expr_recon_loss: 8485779.0833; val_masked_gp_l1_reg_loss: 27108.1602; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17165250.6667; val_optim_loss: 17165250.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8809; val_auprc_score: 0.9737; val_best_acc_score: 0.8949; val_best_f1_score: 0.9409; train_kl_reg_loss: 179711.0410; train_edge_recon_loss: 8282941.9465; train_gene_expr_recon_loss: 8382685.6605; train_masked_gp_l1_reg_loss: 27628.5403; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16872967.2000; train_optim_loss: 16872967.2000; val_kl_reg_loss: 170635.6719; val_edge_recon_loss: 8413347.9583; val_gene_expr_recon_loss: 8323577.0417; val_masked_gp_l1_reg_loss: 28131.8262; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16935692.7500; val_optim_loss: 16935692.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8837; val_auprc_score: 0.9746; val_best_acc_score: 0.8936; val_best_f1_score: 0.9400; train_kl_reg_loss: 166398.6788; train_edge_recon_loss: 8374995.9512; train_gene_expr_recon_loss: 8222347.1163; train_masked_gp_l1_reg_loss: 28641.9197; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16792383.6372; train_optim_loss: 16792383.6372; val_kl_reg_loss: 151528.3229; val_edge_recon_loss: 8351599.9375; val_gene_expr_recon_loss: 8177312.5833; val_masked_gp_l1_reg_loss: 29139.5215; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16709580.7917; val_optim_loss: 16709580.7917
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8944; val_auprc_score: 0.9751; val_best_acc_score: 0.9004; val_best_f1_score: 0.9426; train_kl_reg_loss: 150083.2183; train_edge_recon_loss: 8273616.2070; train_gene_expr_recon_loss: 8096896.2209; train_masked_gp_l1_reg_loss: 29595.0001; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16550190.7674; train_optim_loss: 16550190.7674; val_kl_reg_loss: 135842.6862; val_edge_recon_loss: 8519250.8750; val_gene_expr_recon_loss: 8056289.5208; val_masked_gp_l1_reg_loss: 30037.1719; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16741420.5417; val_optim_loss: 16741420.5417
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9049; val_auprc_score: 0.9780; val_best_acc_score: 0.9081; val_best_f1_score: 0.9472; train_kl_reg_loss: 135554.7363; train_edge_recon_loss: 8057018.8395; train_gene_expr_recon_loss: 7981153.9977; train_masked_gp_l1_reg_loss: 30455.9705; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16204183.6744; train_optim_loss: 16204183.6744; val_kl_reg_loss: 126044.3154; val_edge_recon_loss: 8539649.2292; val_gene_expr_recon_loss: 7940350.2083; val_masked_gp_l1_reg_loss: 30869.4570; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16636913.1667; val_optim_loss: 16636913.1667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9130; val_auprc_score: 0.9808; val_best_acc_score: 0.9180; val_best_f1_score: 0.9532; train_kl_reg_loss: 123503.2949; train_edge_recon_loss: 8008974.3116; train_gene_expr_recon_loss: 7880303.8279; train_masked_gp_l1_reg_loss: 31294.1239; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16044075.5907; train_optim_loss: 16044075.5907; val_kl_reg_loss: 119821.3955; val_edge_recon_loss: 8184968.4167; val_gene_expr_recon_loss: 7849770.6667; val_masked_gp_l1_reg_loss: 31686.6016; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16186247.1667; val_optim_loss: 16186247.1667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9188; val_auprc_score: 0.9827; val_best_acc_score: 0.9188; val_best_f1_score: 0.9534; train_kl_reg_loss: 113385.1187; train_edge_recon_loss: 8102626.5767; train_gene_expr_recon_loss: 7787832.6000; train_masked_gp_l1_reg_loss: 32078.7074; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16035923.0465; train_optim_loss: 16035923.0465; val_kl_reg_loss: 105908.2308; val_edge_recon_loss: 8232780.0417; val_gene_expr_recon_loss: 7760865.5625; val_masked_gp_l1_reg_loss: 32457.9512; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16132011.9167; val_optim_loss: 16132011.9167
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9246; val_auprc_score: 0.9847; val_best_acc_score: 0.9226; val_best_f1_score: 0.9560; train_kl_reg_loss: 105591.4065; train_edge_recon_loss: 7988086.1977; train_gene_expr_recon_loss: 7703990.2698; train_masked_gp_l1_reg_loss: 32764.9192; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15830432.7907; train_optim_loss: 15830432.7907; val_kl_reg_loss: 98689.8678; val_edge_recon_loss: 7886672.5208; val_gene_expr_recon_loss: 7680131.2708; val_masked_gp_l1_reg_loss: 33096.6133; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15698590.6250; val_optim_loss: 15698590.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9226; val_auprc_score: 0.9827; val_best_acc_score: 0.9219; val_best_f1_score: 0.9551; train_kl_reg_loss: 92655.9557; train_edge_recon_loss: 7939853.2302; train_gene_expr_recon_loss: 7629988.9907; train_masked_gp_l1_reg_loss: 33395.8645; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15695894.1023; train_optim_loss: 15695894.1023; val_kl_reg_loss: 83748.6064; val_edge_recon_loss: 8041576.2917; val_gene_expr_recon_loss: 7613781.2708; val_masked_gp_l1_reg_loss: 33648.7266; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15772755.1250; val_optim_loss: 15772755.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9315; val_auprc_score: 0.9844; val_best_acc_score: 0.9244; val_best_f1_score: 0.9564; train_kl_reg_loss: 83725.4276; train_edge_recon_loss: 7967523.0140; train_gene_expr_recon_loss: 7562109.3209; train_masked_gp_l1_reg_loss: 33852.1177; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15647209.8047; train_optim_loss: 15647209.8047; val_kl_reg_loss: 74964.5550; val_edge_recon_loss: 8091887.9167; val_gene_expr_recon_loss: 7549864.3333; val_masked_gp_l1_reg_loss: 34015.0039; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15750731.8333; val_optim_loss: 15750731.8333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9354; val_auprc_score: 0.9864; val_best_acc_score: 0.9255; val_best_f1_score: 0.9572; train_kl_reg_loss: 75515.8508; train_edge_recon_loss: 7982516.7442; train_gene_expr_recon_loss: 7505431.5023; train_masked_gp_l1_reg_loss: 34118.3084; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15597582.3721; train_optim_loss: 15597582.3721; val_kl_reg_loss: 65476.2249; val_edge_recon_loss: 7807060.2500; val_gene_expr_recon_loss: 7495543.2708; val_masked_gp_l1_reg_loss: 34202.9336; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15402282.7917; val_optim_loss: 15402282.7917
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9377; val_auprc_score: 0.9861; val_best_acc_score: 0.9294; val_best_f1_score: 0.9595; train_kl_reg_loss: 65972.5800; train_edge_recon_loss: 7908505.0488; train_gene_expr_recon_loss: 7449944.9256; train_masked_gp_l1_reg_loss: 34222.7796; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15458645.3860; train_optim_loss: 15458645.3860; val_kl_reg_loss: 62534.2108; val_edge_recon_loss: 7842391.3333; val_gene_expr_recon_loss: 7436338.8542; val_masked_gp_l1_reg_loss: 34200.8398; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15375465.5000; val_optim_loss: 15375465.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9408; val_auprc_score: 0.9875; val_best_acc_score: 0.9277; val_best_f1_score: 0.9583; train_kl_reg_loss: 60176.8683; train_edge_recon_loss: 7955899.8907; train_gene_expr_recon_loss: 7392611.2698; train_masked_gp_l1_reg_loss: 34090.3393; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15442778.4233; train_optim_loss: 15442778.4233; val_kl_reg_loss: 54512.2780; val_edge_recon_loss: 8029418.8958; val_gene_expr_recon_loss: 7385067.3333; val_masked_gp_l1_reg_loss: 33982.3125; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15502980.4167; val_optim_loss: 15502980.4167
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9484; val_auprc_score: 0.9882; val_best_acc_score: 0.9341; val_best_f1_score: 0.9620; train_kl_reg_loss: 51250.7597; train_edge_recon_loss: 7793620.1395; train_gene_expr_recon_loss: 7352192.4442; train_masked_gp_l1_reg_loss: 33811.3870; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15230874.7023; train_optim_loss: 15230874.7023; val_kl_reg_loss: 47035.9556; val_edge_recon_loss: 7754461.1458; val_gene_expr_recon_loss: 7343018.2083; val_masked_gp_l1_reg_loss: 33625.8945; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15178141.2917; val_optim_loss: 15178141.2917
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9488; val_auprc_score: 0.9887; val_best_acc_score: 0.9321; val_best_f1_score: 0.9606; train_kl_reg_loss: 47673.0257; train_edge_recon_loss: 7787122.5256; train_gene_expr_recon_loss: 7309562.4814; train_masked_gp_l1_reg_loss: 33304.2272; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15177662.2419; train_optim_loss: 15177662.2419; val_kl_reg_loss: 42530.7253; val_edge_recon_loss: 8138185.2083; val_gene_expr_recon_loss: 7331778.1667; val_masked_gp_l1_reg_loss: 32984.6016; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15545479.0833; val_optim_loss: 15545479.0833
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9529; val_auprc_score: 0.9899; val_best_acc_score: 0.9401; val_best_f1_score: 0.9654; train_kl_reg_loss: 44426.4858; train_edge_recon_loss: 7789009.5233; train_gene_expr_recon_loss: 7279447.6860; train_masked_gp_l1_reg_loss: 32609.5237; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15145493.2512; train_optim_loss: 15145493.2512; val_kl_reg_loss: 39563.4002; val_edge_recon_loss: 7824729.9375; val_gene_expr_recon_loss: 7289511.6875; val_masked_gp_l1_reg_loss: 32159.9707; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15185965.0833; val_optim_loss: 15185965.0833
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9565; val_auprc_score: 0.9899; val_best_acc_score: 0.9460; val_best_f1_score: 0.9685; train_kl_reg_loss: 48736.7679; train_edge_recon_loss: 7774798.3186; train_gene_expr_recon_loss: 7446384.8349; train_masked_gp_l1_reg_loss: 32134.2185; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15302054.0512; train_optim_loss: 15302054.0512; val_kl_reg_loss: 10476.0621; val_edge_recon_loss: 8107206.3333; val_gene_expr_recon_loss: 7409748.0208; val_masked_gp_l1_reg_loss: 31819.9043; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15559250.4167; val_optim_loss: 15559250.4167
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9536; val_auprc_score: 0.9892; val_best_acc_score: 0.9443; val_best_f1_score: 0.9678; train_kl_reg_loss: 42378.3304; train_edge_recon_loss: 7705487.2349; train_gene_expr_recon_loss: 7365676.4512; train_masked_gp_l1_reg_loss: 31279.8838; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15144821.8698; train_optim_loss: 15144821.8698; val_kl_reg_loss: 9623.5647; val_edge_recon_loss: 7903404.0417; val_gene_expr_recon_loss: 7369212.5208; val_masked_gp_l1_reg_loss: 30697.4414; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15312937.2083; val_optim_loss: 15312937.2083

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9570; val_auprc_score: 0.9901; val_best_acc_score: 0.9494; val_best_f1_score: 0.9708; train_kl_reg_loss: 39385.7626; train_edge_recon_loss: 7734700.4279; train_gene_expr_recon_loss: 7327411.5163; train_masked_gp_l1_reg_loss: 30614.3366; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15132112.0140; train_optim_loss: 15132112.0140; val_kl_reg_loss: 9633.9690; val_edge_recon_loss: 7791182.6250; val_gene_expr_recon_loss: 7345736.0417; val_masked_gp_l1_reg_loss: 30543.2109; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15177095.5417; val_optim_loss: 15177095.5417
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9603; val_auprc_score: 0.9908; val_best_acc_score: 0.9494; val_best_f1_score: 0.9706; train_kl_reg_loss: 38649.9735; train_edge_recon_loss: 7662833.5953; train_gene_expr_recon_loss: 7324136.0953; train_masked_gp_l1_reg_loss: 30481.1446; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15056100.8140; train_optim_loss: 15056100.8140; val_kl_reg_loss: 9654.9294; val_edge_recon_loss: 7875763.7292; val_gene_expr_recon_loss: 7340742.6667; val_masked_gp_l1_reg_loss: 30418.8574; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15256580.4167; val_optim_loss: 15256580.4167
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9594; val_auprc_score: 0.9912; val_best_acc_score: 0.9480; val_best_f1_score: 0.9699; train_kl_reg_loss: 37951.6556; train_edge_recon_loss: 7748116.4512; train_gene_expr_recon_loss: 7318325.5093; train_masked_gp_l1_reg_loss: 30345.6796; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15134739.3116; train_optim_loss: 15134739.3116; val_kl_reg_loss: 9538.0292; val_edge_recon_loss: 7843403.4167; val_gene_expr_recon_loss: 7341329.5833; val_masked_gp_l1_reg_loss: 30271.6172; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15224543.1250; val_optim_loss: 15224543.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9583; val_auprc_score: 0.9895; val_best_acc_score: 0.9483; val_best_f1_score: 0.9700; train_kl_reg_loss: 37169.8521; train_edge_recon_loss: 7734153.8186; train_gene_expr_recon_loss: 7312324.6233; train_masked_gp_l1_reg_loss: 30195.3999; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15113843.7349; train_optim_loss: 15113843.7349; val_kl_reg_loss: 9452.3036; val_edge_recon_loss: 8031536.3750; val_gene_expr_recon_loss: 7329288.7083; val_masked_gp_l1_reg_loss: 30113.9238; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15400391.4583; val_optim_loss: 15400391.4583
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9568; val_auprc_score: 0.9901; val_best_acc_score: 0.9489; val_best_f1_score: 0.9705; train_kl_reg_loss: 36072.3236; train_edge_recon_loss: 7752696.9860; train_gene_expr_recon_loss: 7307096.8721; train_masked_gp_l1_reg_loss: 30036.1806; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15125902.3535; train_optim_loss: 15125902.3535; val_kl_reg_loss: 9441.3955; val_edge_recon_loss: 7758734.9792; val_gene_expr_recon_loss: 7321796.0417; val_masked_gp_l1_reg_loss: 29959.2578; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15119931.4167; val_optim_loss: 15119931.4167
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9571; val_auprc_score: 0.9896; val_best_acc_score: 0.9501; val_best_f1_score: 0.9710; train_kl_reg_loss: 35432.0335; train_edge_recon_loss: 7642718.8953; train_gene_expr_recon_loss: 7304848.0860; train_masked_gp_l1_reg_loss: 29870.6287; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15012869.6419; train_optim_loss: 15012869.6419; val_kl_reg_loss: 9326.5668; val_edge_recon_loss: 7980773.9792; val_gene_expr_recon_loss: 7328628.0417; val_masked_gp_l1_reg_loss: 29778.4590; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15348506.6250; val_optim_loss: 15348506.6250
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9598; val_auprc_score: 0.9901; val_best_acc_score: 0.9513; val_best_f1_score: 0.9718; train_kl_reg_loss: 34688.5638; train_edge_recon_loss: 7708359.4233; train_gene_expr_recon_loss: 7301180.4395; train_masked_gp_l1_reg_loss: 29684.4376; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15073912.7907; train_optim_loss: 15073912.7907; val_kl_reg_loss: 9164.6920; val_edge_recon_loss: 7824528.6875; val_gene_expr_recon_loss: 7325982.9792; val_masked_gp_l1_reg_loss: 29584.6777; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15189261.3333; val_optim_loss: 15189261.3333
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9617; val_auprc_score: 0.9912; val_best_acc_score: 0.9522; val_best_f1_score: 0.9723; train_kl_reg_loss: 34324.8461; train_edge_recon_loss: 7689504.7209; train_gene_expr_recon_loss: 7299666.4302; train_masked_gp_l1_reg_loss: 29484.2363; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15052980.1860; train_optim_loss: 15052980.1860; val_kl_reg_loss: 9174.5412; val_edge_recon_loss: 7720313.7083; val_gene_expr_recon_loss: 7323431.0625; val_masked_gp_l1_reg_loss: 29380.6816; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15082300.3750; val_optim_loss: 15082300.3750
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9550; val_auprc_score: 0.9888; val_best_acc_score: 0.9512; val_best_f1_score: 0.9717; train_kl_reg_loss: 33301.5297; train_edge_recon_loss: 7686090.4977; train_gene_expr_recon_loss: 7292742.5744; train_masked_gp_l1_reg_loss: 29264.2421; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15041398.8047; train_optim_loss: 15041398.8047; val_kl_reg_loss: 8980.4661; val_edge_recon_loss: 7809392.5417; val_gene_expr_recon_loss: 7318176.1667; val_masked_gp_l1_reg_loss: 29148.9062; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15165698.2083; val_optim_loss: 15165698.2083
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9624; val_auprc_score: 0.9912; val_best_acc_score: 0.9504; val_best_f1_score: 0.9712; train_kl_reg_loss: 32247.6786; train_edge_recon_loss: 7731590.7977; train_gene_expr_recon_loss: 7284425.8791; train_masked_gp_l1_reg_loss: 29033.3153; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15077297.6419; train_optim_loss: 15077297.6419; val_kl_reg_loss: 8745.6282; val_edge_recon_loss: 7845616.3542; val_gene_expr_recon_loss: 7298480.4167; val_masked_gp_l1_reg_loss: 28909.8242; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15181752.4167; val_optim_loss: 15181752.4167
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9565; val_auprc_score: 0.9891; val_best_acc_score: 0.9503; val_best_f1_score: 0.9713; train_kl_reg_loss: 31947.2375; train_edge_recon_loss: 7747995.8721; train_gene_expr_recon_loss: 7282861.2209; train_masked_gp_l1_reg_loss: 28780.2390; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15091584.6093; train_optim_loss: 15091584.6093; val_kl_reg_loss: 8725.2891; val_edge_recon_loss: 7736704.6875; val_gene_expr_recon_loss: 7305925.8542; val_masked_gp_l1_reg_loss: 28642.8359; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15079998.8750; val_optim_loss: 15079998.8750
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9612; val_auprc_score: 0.9913; val_best_acc_score: 0.9520; val_best_f1_score: 0.9723; train_kl_reg_loss: 30936.5686; train_edge_recon_loss: 7628447.8721; train_gene_expr_recon_loss: 7278713.9512; train_masked_gp_l1_reg_loss: 28524.8320; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14966623.2326; train_optim_loss: 14966623.2326; val_kl_reg_loss: 8743.0553; val_edge_recon_loss: 7648755.0417; val_gene_expr_recon_loss: 7302869.0000; val_masked_gp_l1_reg_loss: 28391.5938; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14988759.1667; val_optim_loss: 14988759.1667
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9611; val_auprc_score: 0.9910; val_best_acc_score: 0.9520; val_best_f1_score: 0.9721; train_kl_reg_loss: 30206.9531; train_edge_recon_loss: 7596420.6372; train_gene_expr_recon_loss: 7272863.3186; train_masked_gp_l1_reg_loss: 28264.5124; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14927755.4651; train_optim_loss: 14927755.4651; val_kl_reg_loss: 8588.4609; val_edge_recon_loss: 7915746.1042; val_gene_expr_recon_loss: 7289323.7500; val_masked_gp_l1_reg_loss: 28125.0801; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15241783.2917; val_optim_loss: 15241783.2917
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9617; val_auprc_score: 0.9912; val_best_acc_score: 0.9522; val_best_f1_score: 0.9723; train_kl_reg_loss: 29985.9534; train_edge_recon_loss: 7683661.2744; train_gene_expr_recon_loss: 7269358.7116; train_masked_gp_l1_reg_loss: 27974.3884; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15010980.2698; train_optim_loss: 15010980.2698; val_kl_reg_loss: 8686.7879; val_edge_recon_loss: 7763292.6458; val_gene_expr_recon_loss: 7290751.1667; val_masked_gp_l1_reg_loss: 27817.8086; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15090548.7500; val_optim_loss: 15090548.7500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9626; val_auprc_score: 0.9917; val_best_acc_score: 0.9518; val_best_f1_score: 0.9721; train_kl_reg_loss: 29216.1598; train_edge_recon_loss: 7616388.4209; train_gene_expr_recon_loss: 7265872.3349; train_masked_gp_l1_reg_loss: 27671.4491; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14939148.3860; train_optim_loss: 14939148.3860; val_kl_reg_loss: 8577.5349; val_edge_recon_loss: 7709468.5833; val_gene_expr_recon_loss: 7285084.9167; val_masked_gp_l1_reg_loss: 27527.2266; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15030658.0833; val_optim_loss: 15030658.0833
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9592; val_auprc_score: 0.9911; val_best_acc_score: 0.9511; val_best_f1_score: 0.9719; train_kl_reg_loss: 28993.1860; train_edge_recon_loss: 7656733.7744; train_gene_expr_recon_loss: 7262531.2302; train_masked_gp_l1_reg_loss: 27369.6902; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14975627.9023; train_optim_loss: 14975627.9023; val_kl_reg_loss: 8572.2605; val_edge_recon_loss: 7608192.5625; val_gene_expr_recon_loss: 7290816.6458; val_masked_gp_l1_reg_loss: 27210.3516; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14934791.4583; val_optim_loss: 14934791.4583
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9636; val_auprc_score: 0.9916; val_best_acc_score: 0.9539; val_best_f1_score: 0.9733; train_kl_reg_loss: 28555.0787; train_edge_recon_loss: 7690199.3721; train_gene_expr_recon_loss: 7257806.6163; train_masked_gp_l1_reg_loss: 27044.9172; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15003606.0000; train_optim_loss: 15003606.0000; val_kl_reg_loss: 8522.4717; val_edge_recon_loss: 7757071.3750; val_gene_expr_recon_loss: 7282829.6458; val_masked_gp_l1_reg_loss: 26876.5332; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15075300.5417; val_optim_loss: 15075300.5417
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9644; val_auprc_score: 0.9911; val_best_acc_score: 0.9554; val_best_f1_score: 0.9741; train_kl_reg_loss: 27664.5221; train_edge_recon_loss: 7643252.4698; train_gene_expr_recon_loss: 7253626.2767; train_masked_gp_l1_reg_loss: 26716.1344; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14951259.4047; train_optim_loss: 14951259.4047; val_kl_reg_loss: 8371.9064; val_edge_recon_loss: 7733262.1667; val_gene_expr_recon_loss: 7275561.9375; val_masked_gp_l1_reg_loss: 26544.3457; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15043740.0417; val_optim_loss: 15043740.0417
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9626; val_auprc_score: 0.9905; val_best_acc_score: 0.9511; val_best_f1_score: 0.9716; train_kl_reg_loss: 26675.6502; train_edge_recon_loss: 7624905.0884; train_gene_expr_recon_loss: 7247913.2419; train_masked_gp_l1_reg_loss: 26382.9106; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14925876.8651; train_optim_loss: 14925876.8651; val_kl_reg_loss: 8175.4358; val_edge_recon_loss: 7917340.7500; val_gene_expr_recon_loss: 7269744.5833; val_masked_gp_l1_reg_loss: 26220.2246; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15221480.7083; val_optim_loss: 15221480.7083
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9628; val_auprc_score: 0.9915; val_best_acc_score: 0.9548; val_best_f1_score: 0.9738; train_kl_reg_loss: 26033.1749; train_edge_recon_loss: 7661986.7581; train_gene_expr_recon_loss: 7246794.8581; train_masked_gp_l1_reg_loss: 26060.4672; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14960875.2558; train_optim_loss: 14960875.2558; val_kl_reg_loss: 8308.9336; val_edge_recon_loss: 7757956.4583; val_gene_expr_recon_loss: 7272114.0000; val_masked_gp_l1_reg_loss: 25882.1309; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15064261.3750; val_optim_loss: 15064261.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9606; val_auprc_score: 0.9910; val_best_acc_score: 0.9517; val_best_f1_score: 0.9721; train_kl_reg_loss: 25833.3627; train_edge_recon_loss: 7664371.1465; train_gene_expr_recon_loss: 7241021.2372; train_masked_gp_l1_reg_loss: 25858.5848; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14957084.3488; train_optim_loss: 14957084.3488; val_kl_reg_loss: 8275.1465; val_edge_recon_loss: 7741006.6250; val_gene_expr_recon_loss: 7267648.6458; val_masked_gp_l1_reg_loss: 25839.1992; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15042769.4167; val_optim_loss: 15042769.4167
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9607; val_auprc_score: 0.9909; val_best_acc_score: 0.9501; val_best_f1_score: 0.9711; train_kl_reg_loss: 25723.6021; train_edge_recon_loss: 7611195.1930; train_gene_expr_recon_loss: 7237075.7093; train_masked_gp_l1_reg_loss: 25821.0507; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14899815.6000; train_optim_loss: 14899815.6000; val_kl_reg_loss: 8293.2967; val_edge_recon_loss: 7951869.2292; val_gene_expr_recon_loss: 7271326.6250; val_masked_gp_l1_reg_loss: 25802.0410; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15257291.1250; val_optim_loss: 15257291.1250
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9618; val_auprc_score: 0.9913; val_best_acc_score: 0.9532; val_best_f1_score: 0.9727; train_kl_reg_loss: 25642.8607; train_edge_recon_loss: 7672604.0256; train_gene_expr_recon_loss: 7239415.4860; train_masked_gp_l1_reg_loss: 25781.5514; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14963443.9581; train_optim_loss: 14963443.9581; val_kl_reg_loss: 8188.4708; val_edge_recon_loss: 7795009.2083; val_gene_expr_recon_loss: 7264964.0833; val_masked_gp_l1_reg_loss: 25760.7637; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15093922.7917; val_optim_loss: 15093922.7917
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9680; val_auprc_score: 0.9930; val_best_acc_score: 0.9567; val_best_f1_score: 0.9748; train_kl_reg_loss: 25377.7552; train_edge_recon_loss: 7714166.8419; train_gene_expr_recon_loss: 7239726.1535; train_masked_gp_l1_reg_loss: 25741.6615; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15005012.4047; train_optim_loss: 15005012.4047; val_kl_reg_loss: 8204.1877; val_edge_recon_loss: 7810337.3542; val_gene_expr_recon_loss: 7267363.4167; val_masked_gp_l1_reg_loss: 25721.0898; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15111625.8750; val_optim_loss: 15111625.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 65 min 24 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9622
Val AUPRC score: 0.9920
Val best accuracy score: 0.9521
Val best F1 score: 0.9725
Val gene expr MSE score: 27005.1691
Val cat covariate0 mean sim diff: -0.0050

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
