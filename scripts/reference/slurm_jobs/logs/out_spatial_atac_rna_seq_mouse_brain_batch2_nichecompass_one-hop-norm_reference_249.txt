[True]
Run timestamp: 10102023_112418_249.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_249']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7691; val_auprc_score: 0.7912; val_best_acc_score: 0.5492; val_best_f1_score: 0.6871; train_kl_reg_loss: 83021.6462; train_edge_recon_loss: 752285.9843; train_gene_expr_recon_loss: 22030084.1679; train_masked_gp_l1_reg_loss: 55324.4622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4101693.6966; train_chrom_access_recon_loss: 4699221.7443; train_global_loss: 31721631.6641; train_optim_loss: 31721631.6641; val_kl_reg_loss: 92802.2479; val_edge_recon_loss: 812551.8333; val_gene_expr_recon_loss: 21202770.0000; val_masked_gp_l1_reg_loss: 58676.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1046566.3750; val_chrom_access_recon_loss: 4695300.8000; val_global_loss: 27908667.2000; val_optim_loss: 27908667.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8658; val_auprc_score: 0.8669; val_best_acc_score: 0.7657; val_best_f1_score: 0.7703; train_kl_reg_loss: 79949.0016; train_edge_recon_loss: 734090.0563; train_gene_expr_recon_loss: 20876420.1832; train_masked_gp_l1_reg_loss: 60228.5542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 535066.0630; train_chrom_access_recon_loss: 4561434.0687; train_global_loss: 26847187.8321; train_optim_loss: 26847187.8321; val_kl_reg_loss: 67512.9060; val_edge_recon_loss: 787694.9208; val_gene_expr_recon_loss: 20914554.0000; val_masked_gp_l1_reg_loss: 62601.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 297571.1250; val_chrom_access_recon_loss: 4633766.2000; val_global_loss: 26763701.7333; val_optim_loss: 26763701.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9146; val_auprc_score: 0.9075; val_best_acc_score: 0.8290; val_best_f1_score: 0.8401; train_kl_reg_loss: 70173.7736; train_edge_recon_loss: 696062.6698; train_gene_expr_recon_loss: 20615086.4733; train_masked_gp_l1_reg_loss: 64827.1790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231102.0312; train_chrom_access_recon_loss: 4509578.2233; train_global_loss: 26186830.2290; train_optim_loss: 26186830.2290; val_kl_reg_loss: 78778.7229; val_edge_recon_loss: 656826.2125; val_gene_expr_recon_loss: 20647189.8667; val_masked_gp_l1_reg_loss: 67364.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190339.8438; val_chrom_access_recon_loss: 4611562.9333; val_global_loss: 26252061.8667; val_optim_loss: 26252061.8667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9183; val_auprc_score: 0.9041; val_best_acc_score: 0.8426; val_best_f1_score: 0.8537; train_kl_reg_loss: 80482.2224; train_edge_recon_loss: 628286.0115; train_gene_expr_recon_loss: 20354642.5954; train_masked_gp_l1_reg_loss: 69987.5233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177146.4246; train_chrom_access_recon_loss: 4463137.5172; train_global_loss: 25773682.2595; train_optim_loss: 25773682.2595; val_kl_reg_loss: 80619.8010; val_edge_recon_loss: 620043.6958; val_gene_expr_recon_loss: 20411622.1333; val_masked_gp_l1_reg_loss: 72266.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167806.1094; val_chrom_access_recon_loss: 4553655.4333; val_global_loss: 25906012.8000; val_optim_loss: 25906012.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9288; val_auprc_score: 0.9175; val_best_acc_score: 0.8546; val_best_f1_score: 0.8623; train_kl_reg_loss: 77616.7254; train_edge_recon_loss: 614504.5229; train_gene_expr_recon_loss: 20151245.7557; train_masked_gp_l1_reg_loss: 74084.4252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159501.9697; train_chrom_access_recon_loss: 4429732.2443; train_global_loss: 25506685.7099; train_optim_loss: 25506685.7099; val_kl_reg_loss: 75716.4708; val_edge_recon_loss: 616162.1208; val_gene_expr_recon_loss: 20196797.2000; val_masked_gp_l1_reg_loss: 75753.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152083.7500; val_chrom_access_recon_loss: 4508105.6667; val_global_loss: 25624619.2000; val_optim_loss: 25624619.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9381; val_auprc_score: 0.9241; val_best_acc_score: 0.8674; val_best_f1_score: 0.8737; train_kl_reg_loss: 74084.0175; train_edge_recon_loss: 605874.3344; train_gene_expr_recon_loss: 19989799.2214; train_masked_gp_l1_reg_loss: 77048.1215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144266.5898; train_chrom_access_recon_loss: 4396911.9084; train_global_loss: 25287984.1527; train_optim_loss: 25287984.1527; val_kl_reg_loss: 70851.6505; val_edge_recon_loss: 607564.9708; val_gene_expr_recon_loss: 20027319.2000; val_masked_gp_l1_reg_loss: 78272.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139768.5000; val_chrom_access_recon_loss: 4475097.5000; val_global_loss: 25398873.7333; val_optim_loss: 25398873.7333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9493; val_auprc_score: 0.9375; val_best_acc_score: 0.8795; val_best_f1_score: 0.8843; train_kl_reg_loss: 71040.4370; train_edge_recon_loss: 602319.3278; train_gene_expr_recon_loss: 19854496.4275; train_masked_gp_l1_reg_loss: 79188.4259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134575.6412; train_chrom_access_recon_loss: 4369220.7615; train_global_loss: 25110841.0687; train_optim_loss: 25110841.0687; val_kl_reg_loss: 72006.2484; val_edge_recon_loss: 598687.2125; val_gene_expr_recon_loss: 19931455.8667; val_masked_gp_l1_reg_loss: 80188.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130677.8438; val_chrom_access_recon_loss: 4475271.9333; val_global_loss: 25288287.4667; val_optim_loss: 25288287.4667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9517; val_auprc_score: 0.9442; val_best_acc_score: 0.8836; val_best_f1_score: 0.8891; train_kl_reg_loss: 69708.2935; train_edge_recon_loss: 597875.9723; train_gene_expr_recon_loss: 19725208.1069; train_masked_gp_l1_reg_loss: 80876.3594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127530.6372; train_chrom_access_recon_loss: 4338478.6698; train_global_loss: 24939678.0000; train_optim_loss: 24939678.0000; val_kl_reg_loss: 70065.8516; val_edge_recon_loss: 598407.3333; val_gene_expr_recon_loss: 19657008.4000; val_masked_gp_l1_reg_loss: 81904.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126281.4219; val_chrom_access_recon_loss: 4410767.6667; val_global_loss: 24944435.2000; val_optim_loss: 24944435.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9531; val_auprc_score: 0.9467; val_best_acc_score: 0.8864; val_best_f1_score: 0.8924; train_kl_reg_loss: 68295.5993; train_edge_recon_loss: 593974.2715; train_gene_expr_recon_loss: 19614713.6183; train_masked_gp_l1_reg_loss: 82405.3450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122334.1892; train_chrom_access_recon_loss: 4314494.4504; train_global_loss: 24796217.4351; train_optim_loss: 24796217.4351; val_kl_reg_loss: 68587.8370; val_edge_recon_loss: 595170.8083; val_gene_expr_recon_loss: 19775632.6667; val_masked_gp_l1_reg_loss: 83124.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120791.6875; val_chrom_access_recon_loss: 4420897.2333; val_global_loss: 25064204.8000; val_optim_loss: 25064204.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9596; val_auprc_score: 0.9534; val_best_acc_score: 0.8979; val_best_f1_score: 0.9014; train_kl_reg_loss: 66967.0982; train_edge_recon_loss: 590759.3550; train_gene_expr_recon_loss: 19534184.8397; train_masked_gp_l1_reg_loss: 83646.7806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117871.3504; train_chrom_access_recon_loss: 4294575.8683; train_global_loss: 24688005.1756; train_optim_loss: 24688005.1756; val_kl_reg_loss: 67989.7927; val_edge_recon_loss: 593285.8500; val_gene_expr_recon_loss: 19569256.9333; val_masked_gp_l1_reg_loss: 84251.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116730.4375; val_chrom_access_recon_loss: 4358262.4500; val_global_loss: 24789776.6667; val_optim_loss: 24789776.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9592; val_auprc_score: 0.9538; val_best_acc_score: 0.8968; val_best_f1_score: 0.9003; train_kl_reg_loss: 66047.7796; train_edge_recon_loss: 587657.0444; train_gene_expr_recon_loss: 19437812.3969; train_masked_gp_l1_reg_loss: 84879.0518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114699.3989; train_chrom_access_recon_loss: 4272436.6336; train_global_loss: 24563532.5038; train_optim_loss: 24563532.5038; val_kl_reg_loss: 65160.6714; val_edge_recon_loss: 592448.6833; val_gene_expr_recon_loss: 19551424.5333; val_masked_gp_l1_reg_loss: 85391.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112324.7422; val_chrom_access_recon_loss: 4374532.6667; val_global_loss: 24781281.6000; val_optim_loss: 24781281.6000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9628; val_auprc_score: 0.9536; val_best_acc_score: 0.9039; val_best_f1_score: 0.9083; train_kl_reg_loss: 64991.9661; train_edge_recon_loss: 586801.5520; train_gene_expr_recon_loss: 19344742.7176; train_masked_gp_l1_reg_loss: 85988.8692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111654.0707; train_chrom_access_recon_loss: 4245880.5267; train_global_loss: 24440059.7863; train_optim_loss: 24440059.7863; val_kl_reg_loss: 66045.9594; val_edge_recon_loss: 587175.5875; val_gene_expr_recon_loss: 19450128.1333; val_masked_gp_l1_reg_loss: 86354.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110704.0391; val_chrom_access_recon_loss: 4337892.6667; val_global_loss: 24638300.1333; val_optim_loss: 24638300.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9657; val_auprc_score: 0.9602; val_best_acc_score: 0.9064; val_best_f1_score: 0.9101; train_kl_reg_loss: 64442.7051; train_edge_recon_loss: 585533.8130; train_gene_expr_recon_loss: 19272258.1527; train_masked_gp_l1_reg_loss: 86868.3385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109329.3706; train_chrom_access_recon_loss: 4224882.6374; train_global_loss: 24343314.7786; train_optim_loss: 24343314.7786; val_kl_reg_loss: 63431.9992; val_edge_recon_loss: 589365.3625; val_gene_expr_recon_loss: 19356521.8667; val_masked_gp_l1_reg_loss: 87227.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109948.4219; val_chrom_access_recon_loss: 4309803.4000; val_global_loss: 24516298.6667; val_optim_loss: 24516298.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9702; val_auprc_score: 0.9650; val_best_acc_score: 0.9206; val_best_f1_score: 0.9223; train_kl_reg_loss: 63281.4542; train_edge_recon_loss: 584554.7877; train_gene_expr_recon_loss: 19211700.9618; train_masked_gp_l1_reg_loss: 87614.7600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108197.7778; train_chrom_access_recon_loss: 4201623.1393; train_global_loss: 24256972.8702; train_optim_loss: 24256972.8702; val_kl_reg_loss: 64994.9021; val_edge_recon_loss: 584566.2708; val_gene_expr_recon_loss: 19221643.0667; val_masked_gp_l1_reg_loss: 88050.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108008.3516; val_chrom_access_recon_loss: 4281200.1333; val_global_loss: 24348462.2667; val_optim_loss: 24348462.2667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9631; val_auprc_score: 0.9535; val_best_acc_score: 0.9111; val_best_f1_score: 0.9144; train_kl_reg_loss: 62961.3618; train_edge_recon_loss: 583081.1174; train_gene_expr_recon_loss: 19139242.2748; train_masked_gp_l1_reg_loss: 88349.8518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106691.3802; train_chrom_access_recon_loss: 4179244.8378; train_global_loss: 24159570.6718; train_optim_loss: 24159570.6718; val_kl_reg_loss: 63039.0518; val_edge_recon_loss: 585132.3333; val_gene_expr_recon_loss: 19260847.4667; val_masked_gp_l1_reg_loss: 88901.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106947.7812; val_chrom_access_recon_loss: 4286954.0000; val_global_loss: 24391822.6667; val_optim_loss: 24391822.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9672; val_auprc_score: 0.9601; val_best_acc_score: 0.9153; val_best_f1_score: 0.9165; train_kl_reg_loss: 62402.2097; train_edge_recon_loss: 583318.7510; train_gene_expr_recon_loss: 19082335.0992; train_masked_gp_l1_reg_loss: 89250.6144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106032.9313; train_chrom_access_recon_loss: 4158030.5191; train_global_loss: 24081370.2595; train_optim_loss: 24081370.2595; val_kl_reg_loss: 62538.9820; val_edge_recon_loss: 584255.2417; val_gene_expr_recon_loss: 19187923.3333; val_masked_gp_l1_reg_loss: 89535.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105177.7969; val_chrom_access_recon_loss: 4260640.5500; val_global_loss: 24290072.2667; val_optim_loss: 24290072.2667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9654; val_auprc_score: 0.9576; val_best_acc_score: 0.9130; val_best_f1_score: 0.9151; train_kl_reg_loss: 61620.6901; train_edge_recon_loss: 582310.5005; train_gene_expr_recon_loss: 19031254.3511; train_masked_gp_l1_reg_loss: 89946.9031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105247.2722; train_chrom_access_recon_loss: 4137548.9103; train_global_loss: 24007928.6412; train_optim_loss: 24007928.6412; val_kl_reg_loss: 61260.8003; val_edge_recon_loss: 587760.3750; val_gene_expr_recon_loss: 19093678.4000; val_masked_gp_l1_reg_loss: 90426.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105509.7188; val_chrom_access_recon_loss: 4224323.2667; val_global_loss: 24162958.4000; val_optim_loss: 24162958.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9626; val_auprc_score: 0.9535; val_best_acc_score: 0.9084; val_best_f1_score: 0.9126; train_kl_reg_loss: 60991.0554; train_edge_recon_loss: 582558.0010; train_gene_expr_recon_loss: 18959442.5954; train_masked_gp_l1_reg_loss: 90933.1192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104887.2316; train_chrom_access_recon_loss: 4113848.5802; train_global_loss: 23912660.5344; train_optim_loss: 23912660.5344; val_kl_reg_loss: 59261.9099; val_edge_recon_loss: 584913.6750; val_gene_expr_recon_loss: 19196740.2667; val_masked_gp_l1_reg_loss: 91332.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104474.6875; val_chrom_access_recon_loss: 4230743.8333; val_global_loss: 24267465.6000; val_optim_loss: 24267465.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9674; val_auprc_score: 0.9603; val_best_acc_score: 0.9134; val_best_f1_score: 0.9169; train_kl_reg_loss: 60989.4643; train_edge_recon_loss: 582379.1875; train_gene_expr_recon_loss: 18919498.2901; train_masked_gp_l1_reg_loss: 91818.5181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104378.2114; train_chrom_access_recon_loss: 4096731.7004; train_global_loss: 23855795.4504; train_optim_loss: 23855795.4504; val_kl_reg_loss: 61750.3260; val_edge_recon_loss: 583379.5167; val_gene_expr_recon_loss: 19098847.0667; val_masked_gp_l1_reg_loss: 92195.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105207.5078; val_chrom_access_recon_loss: 4215067.9167; val_global_loss: 24156448.9333; val_optim_loss: 24156448.9333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9670; val_auprc_score: 0.9587; val_best_acc_score: 0.9165; val_best_f1_score: 0.9199; train_kl_reg_loss: 60682.6809; train_edge_recon_loss: 582130.8058; train_gene_expr_recon_loss: 18849315.7405; train_masked_gp_l1_reg_loss: 92832.3433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104501.9027; train_chrom_access_recon_loss: 4067754.6279; train_global_loss: 23757218.2137; train_optim_loss: 23757218.2137; val_kl_reg_loss: 62186.8216; val_edge_recon_loss: 583616.7042; val_gene_expr_recon_loss: 19022872.5333; val_masked_gp_l1_reg_loss: 93482.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105277.7500; val_chrom_access_recon_loss: 4178324.2333; val_global_loss: 24045760.1333; val_optim_loss: 24045760.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9647; val_auprc_score: 0.9551; val_best_acc_score: 0.9153; val_best_f1_score: 0.9186; train_kl_reg_loss: 60866.2089; train_edge_recon_loss: 581893.0673; train_gene_expr_recon_loss: 18810270.2137; train_masked_gp_l1_reg_loss: 94009.2921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104623.3677; train_chrom_access_recon_loss: 4045684.8187; train_global_loss: 23697346.7634; train_optim_loss: 23697346.7634; val_kl_reg_loss: 60435.2201; val_edge_recon_loss: 584715.3708; val_gene_expr_recon_loss: 18931363.2000; val_masked_gp_l1_reg_loss: 94571.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106007.3984; val_chrom_access_recon_loss: 4158752.8667; val_global_loss: 23935846.9333; val_optim_loss: 23935846.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9627; val_auprc_score: 0.9530; val_best_acc_score: 0.9080; val_best_f1_score: 0.9126; train_kl_reg_loss: 59732.1881; train_edge_recon_loss: 585772.7323; train_gene_expr_recon_loss: 18775960.2290; train_masked_gp_l1_reg_loss: 94951.9293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105467.7665; train_chrom_access_recon_loss: 4050031.6527; train_global_loss: 23671916.5496; train_optim_loss: 23671916.5496; val_kl_reg_loss: 60507.2818; val_edge_recon_loss: 582350.5208; val_gene_expr_recon_loss: 19053157.4667; val_masked_gp_l1_reg_loss: 94238.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106997.4375; val_chrom_access_recon_loss: 4225766.4000; val_global_loss: 24123017.4667; val_optim_loss: 24123017.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9427; val_auprc_score: 0.9352; val_best_acc_score: 0.8711; val_best_f1_score: 0.8788; train_kl_reg_loss: 2363938.4280; train_edge_recon_loss: 630205.5491; train_gene_expr_recon_loss: 19151439.9542; train_masked_gp_l1_reg_loss: 93783.2312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117482.3060; train_chrom_access_recon_loss: 4169903.2061; train_global_loss: 26526752.9618; train_optim_loss: 26526752.9618; val_kl_reg_loss: 57129.3815; val_edge_recon_loss: 675606.4208; val_gene_expr_recon_loss: 19271008.4000; val_masked_gp_l1_reg_loss: 90561.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142835.0469; val_chrom_access_recon_loss: 4375834.8500; val_global_loss: 24612977.0667; val_optim_loss: 24612977.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9500; val_auprc_score: 0.9378; val_best_acc_score: 0.8859; val_best_f1_score: 0.8909; train_kl_reg_loss: 62553.7278; train_edge_recon_loss: 616103.1818; train_gene_expr_recon_loss: 19016652.7328; train_masked_gp_l1_reg_loss: 87255.1382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119770.3773; train_chrom_access_recon_loss: 4172553.1584; train_global_loss: 24074888.3969; train_optim_loss: 24074888.3969; val_kl_reg_loss: 65326.4841; val_edge_recon_loss: 597916.3167; val_gene_expr_recon_loss: 19168180.4000; val_masked_gp_l1_reg_loss: 86143.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110692.3125; val_chrom_access_recon_loss: 4247486.4500; val_global_loss: 24275745.3333; val_optim_loss: 24275745.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9514; val_auprc_score: 0.9389; val_best_acc_score: 0.8923; val_best_f1_score: 0.8963; train_kl_reg_loss: 65762.9577; train_edge_recon_loss: 596435.4437; train_gene_expr_recon_loss: 18871691.9237; train_masked_gp_l1_reg_loss: 86196.0368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109593.1591; train_chrom_access_recon_loss: 4131860.5344; train_global_loss: 23861539.9542; train_optim_loss: 23861539.9542; val_kl_reg_loss: 65240.6034; val_edge_recon_loss: 593490.8458; val_gene_expr_recon_loss: 18991657.0667; val_masked_gp_l1_reg_loss: 85894.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109299.2891; val_chrom_access_recon_loss: 4235225.2833; val_global_loss: 24080807.8667; val_optim_loss: 24080807.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9456; val_auprc_score: 0.9345; val_best_acc_score: 0.8769; val_best_f1_score: 0.8832; train_kl_reg_loss: 67877.6617; train_edge_recon_loss: 711748.0425; train_gene_expr_recon_loss: 17157842.0840; train_masked_gp_l1_reg_loss: 84225.6198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73988.2468; train_chrom_access_recon_loss: 3833504.5763; train_global_loss: 21929186.1832; train_optim_loss: 21929186.1832; val_kl_reg_loss: 30276.9164; val_edge_recon_loss: 737477.9667; val_gene_expr_recon_loss: 17209521.4667; val_masked_gp_l1_reg_loss: 83458.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68293.3438; val_chrom_access_recon_loss: 3908661.1500; val_global_loss: 22037689.7333; val_optim_loss: 22037689.7333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9459; val_auprc_score: 0.9370; val_best_acc_score: 0.8688; val_best_f1_score: 0.8778; train_kl_reg_loss: 66961.3496; train_edge_recon_loss: 706902.9599; train_gene_expr_recon_loss: 17066097.4733; train_masked_gp_l1_reg_loss: 82959.8448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67449.3533; train_chrom_access_recon_loss: 3787648.6221; train_global_loss: 21778019.7099; train_optim_loss: 21778019.7099; val_kl_reg_loss: 28254.7462; val_edge_recon_loss: 740716.4250; val_gene_expr_recon_loss: 17173263.3333; val_masked_gp_l1_reg_loss: 82466.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66686.7656; val_chrom_access_recon_loss: 3869306.3167; val_global_loss: 21960692.9333; val_optim_loss: 21960692.9333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9426; val_auprc_score: 0.9335; val_best_acc_score: 0.8694; val_best_f1_score: 0.8778; train_kl_reg_loss: 63518.6800; train_edge_recon_loss: 707212.0076; train_gene_expr_recon_loss: 17070639.0229; train_masked_gp_l1_reg_loss: 82060.3498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66294.3573; train_chrom_access_recon_loss: 3778054.0573; train_global_loss: 21767778.4275; train_optim_loss: 21767778.4275; val_kl_reg_loss: 27428.9504; val_edge_recon_loss: 741610.5750; val_gene_expr_recon_loss: 17178803.8667; val_masked_gp_l1_reg_loss: 81621.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65882.0000; val_chrom_access_recon_loss: 3846203.0500; val_global_loss: 21941550.2667; val_optim_loss: 21941550.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9473; val_auprc_score: 0.9392; val_best_acc_score: 0.8735; val_best_f1_score: 0.8811; train_kl_reg_loss: 61483.4010; train_edge_recon_loss: 704864.2156; train_gene_expr_recon_loss: 17026301.6260; train_masked_gp_l1_reg_loss: 81104.8474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65525.1808; train_chrom_access_recon_loss: 3770149.5076; train_global_loss: 21709428.6870; train_optim_loss: 21709428.6870; val_kl_reg_loss: 27894.3846; val_edge_recon_loss: 744039.7292; val_gene_expr_recon_loss: 17123772.8667; val_masked_gp_l1_reg_loss: 80592.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65240.3555; val_chrom_access_recon_loss: 3853927.0167; val_global_loss: 21895466.1333; val_optim_loss: 21895466.1333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9445; val_auprc_score: 0.9337; val_best_acc_score: 0.8713; val_best_f1_score: 0.8796; train_kl_reg_loss: 60240.0461; train_edge_recon_loss: 704681.6255; train_gene_expr_recon_loss: 17047357.4733; train_masked_gp_l1_reg_loss: 80037.6573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65017.1523; train_chrom_access_recon_loss: 3770094.5954; train_global_loss: 21727428.5038; train_optim_loss: 21727428.5038; val_kl_reg_loss: 27068.1734; val_edge_recon_loss: 742727.9708; val_gene_expr_recon_loss: 17123926.8667; val_masked_gp_l1_reg_loss: 79530.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64720.8398; val_chrom_access_recon_loss: 3852082.1167; val_global_loss: 21890055.4667; val_optim_loss: 21890055.4667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9478; val_auprc_score: 0.9391; val_best_acc_score: 0.8779; val_best_f1_score: 0.8840; train_kl_reg_loss: 57664.1631; train_edge_recon_loss: 703035.8297; train_gene_expr_recon_loss: 17048766.4427; train_masked_gp_l1_reg_loss: 79012.7065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64574.2615; train_chrom_access_recon_loss: 3764978.3645; train_global_loss: 21718031.9389; train_optim_loss: 21718031.9389; val_kl_reg_loss: 24051.0130; val_edge_recon_loss: 736051.1542; val_gene_expr_recon_loss: 17178428.6000; val_masked_gp_l1_reg_loss: 78517.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64358.9648; val_chrom_access_recon_loss: 3853811.1833; val_global_loss: 21935217.8667; val_optim_loss: 21935217.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9474; val_auprc_score: 0.9387; val_best_acc_score: 0.8774; val_best_f1_score: 0.8827; train_kl_reg_loss: 55822.3905; train_edge_recon_loss: 702051.8335; train_gene_expr_recon_loss: 17016181.4580; train_masked_gp_l1_reg_loss: 78054.6509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64266.9456; train_chrom_access_recon_loss: 3762512.1813; train_global_loss: 21678889.3435; train_optim_loss: 21678889.3435; val_kl_reg_loss: 28752.5283; val_edge_recon_loss: 734056.4792; val_gene_expr_recon_loss: 17159391.0000; val_masked_gp_l1_reg_loss: 77534.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63938.0195; val_chrom_access_recon_loss: 3866129.0167; val_global_loss: 21929801.2000; val_optim_loss: 21929801.2000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9450; val_auprc_score: 0.9364; val_best_acc_score: 0.8733; val_best_f1_score: 0.8786; train_kl_reg_loss: 53757.1954; train_edge_recon_loss: 700772.2844; train_gene_expr_recon_loss: 17019367.8473; train_masked_gp_l1_reg_loss: 77026.5695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63756.2914; train_chrom_access_recon_loss: 3758685.5363; train_global_loss: 21673365.7710; train_optim_loss: 21673365.7710; val_kl_reg_loss: 24017.6168; val_edge_recon_loss: 731719.8958; val_gene_expr_recon_loss: 17191473.9333; val_masked_gp_l1_reg_loss: 76574.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63566.1719; val_chrom_access_recon_loss: 3847462.8667; val_global_loss: 21934814.2667; val_optim_loss: 21934814.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9440; val_auprc_score: 0.9308; val_best_acc_score: 0.8711; val_best_f1_score: 0.8762; train_kl_reg_loss: 51685.4922; train_edge_recon_loss: 700683.2896; train_gene_expr_recon_loss: 17038278.3206; train_masked_gp_l1_reg_loss: 76114.9971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63413.6927; train_chrom_access_recon_loss: 3761856.0630; train_global_loss: 21692031.8626; train_optim_loss: 21692031.8626; val_kl_reg_loss: 25434.3969; val_edge_recon_loss: 729436.2417; val_gene_expr_recon_loss: 17243086.6000; val_masked_gp_l1_reg_loss: 75670.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63301.4062; val_chrom_access_recon_loss: 3860677.7500; val_global_loss: 21997606.8000; val_optim_loss: 21997606.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9450; val_auprc_score: 0.9334; val_best_acc_score: 0.8736; val_best_f1_score: 0.8789; train_kl_reg_loss: 51067.9819; train_edge_recon_loss: 698632.6093; train_gene_expr_recon_loss: 17006482.8244; train_masked_gp_l1_reg_loss: 75564.7468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61478.1362; train_chrom_access_recon_loss: 3760311.0305; train_global_loss: 21653537.3740; train_optim_loss: 21653537.3740; val_kl_reg_loss: 26039.7492; val_edge_recon_loss: 729998.6792; val_gene_expr_recon_loss: 17162502.0000; val_masked_gp_l1_reg_loss: 75492.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61202.0039; val_chrom_access_recon_loss: 3832168.8667; val_global_loss: 21887403.2000; val_optim_loss: 21887403.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9424; val_auprc_score: 0.9307; val_best_acc_score: 0.8723; val_best_f1_score: 0.8775; train_kl_reg_loss: 51265.0347; train_edge_recon_loss: 698121.6613; train_gene_expr_recon_loss: 17011763.9618; train_masked_gp_l1_reg_loss: 75435.0377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61124.4608; train_chrom_access_recon_loss: 3764398.2347; train_global_loss: 21662108.2290; train_optim_loss: 21662108.2290; val_kl_reg_loss: 26070.3180; val_edge_recon_loss: 729285.0083; val_gene_expr_recon_loss: 17115199.0000; val_masked_gp_l1_reg_loss: 75375.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61046.3438; val_chrom_access_recon_loss: 3844501.2500; val_global_loss: 21851477.8667; val_optim_loss: 21851477.8667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9456; val_auprc_score: 0.9370; val_best_acc_score: 0.8735; val_best_f1_score: 0.8792; train_kl_reg_loss: 51285.4870; train_edge_recon_loss: 697654.1698; train_gene_expr_recon_loss: 16984319.0229; train_masked_gp_l1_reg_loss: 75320.4357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60982.4410; train_chrom_access_recon_loss: 3757846.6603; train_global_loss: 21627408.3359; train_optim_loss: 21627408.3359; val_kl_reg_loss: 26192.6986; val_edge_recon_loss: 728235.8375; val_gene_expr_recon_loss: 17099663.2000; val_masked_gp_l1_reg_loss: 75263.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60922.6836; val_chrom_access_recon_loss: 3838164.3500; val_global_loss: 21828441.4667; val_optim_loss: 21828441.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9418; val_auprc_score: 0.9330; val_best_acc_score: 0.8678; val_best_f1_score: 0.8728; train_kl_reg_loss: 51527.3502; train_edge_recon_loss: 696548.7519; train_gene_expr_recon_loss: 16996991.2519; train_masked_gp_l1_reg_loss: 75205.3435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60881.8311; train_chrom_access_recon_loss: 3756805.6698; train_global_loss: 21637960.1221; train_optim_loss: 21637960.1221; val_kl_reg_loss: 27035.8063; val_edge_recon_loss: 729175.2000; val_gene_expr_recon_loss: 17218977.2667; val_masked_gp_l1_reg_loss: 75149.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60844.6562; val_chrom_access_recon_loss: 3874248.5833; val_global_loss: 21985430.9333; val_optim_loss: 21985430.9333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9459; val_auprc_score: 0.9353; val_best_acc_score: 0.8773; val_best_f1_score: 0.8810; train_kl_reg_loss: 51487.9834; train_edge_recon_loss: 696661.4313; train_gene_expr_recon_loss: 17002589.3206; train_masked_gp_l1_reg_loss: 75093.4108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60804.1519; train_chrom_access_recon_loss: 3761628.1011; train_global_loss: 21648264.4427; train_optim_loss: 21648264.4427; val_kl_reg_loss: 26496.9646; val_edge_recon_loss: 727315.3000; val_gene_expr_recon_loss: 17087841.4000; val_masked_gp_l1_reg_loss: 75034.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60764.1953; val_chrom_access_recon_loss: 3835362.9167; val_global_loss: 21812814.4000; val_optim_loss: 21812814.4000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9503; val_auprc_score: 0.9430; val_best_acc_score: 0.8814; val_best_f1_score: 0.8849; train_kl_reg_loss: 51282.5641; train_edge_recon_loss: 696169.9704; train_gene_expr_recon_loss: 17011520.0916; train_masked_gp_l1_reg_loss: 74974.4425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60732.8567; train_chrom_access_recon_loss: 3762748.6336; train_global_loss: 21657428.6107; train_optim_loss: 21657428.6107; val_kl_reg_loss: 26545.2962; val_edge_recon_loss: 725903.9958; val_gene_expr_recon_loss: 17129708.5333; val_masked_gp_l1_reg_loss: 74912.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60684.5820; val_chrom_access_recon_loss: 3860698.6333; val_global_loss: 21878452.5333; val_optim_loss: 21878452.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9446; val_auprc_score: 0.9364; val_best_acc_score: 0.8754; val_best_f1_score: 0.8791; train_kl_reg_loss: 51441.0103; train_edge_recon_loss: 695784.8173; train_gene_expr_recon_loss: 17008036.8550; train_masked_gp_l1_reg_loss: 74850.1468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60650.2596; train_chrom_access_recon_loss: 3759747.4218; train_global_loss: 21650510.5344; train_optim_loss: 21650510.5344; val_kl_reg_loss: 26597.1309; val_edge_recon_loss: 726942.7667; val_gene_expr_recon_loss: 17146023.8667; val_masked_gp_l1_reg_loss: 74788.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60612.1680; val_chrom_access_recon_loss: 3834067.4500; val_global_loss: 21869031.0667; val_optim_loss: 21869031.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9416; val_auprc_score: 0.9286; val_best_acc_score: 0.8720; val_best_f1_score: 0.8769; train_kl_reg_loss: 51868.9911; train_edge_recon_loss: 695447.3311; train_gene_expr_recon_loss: 16986903.2977; train_masked_gp_l1_reg_loss: 74726.7676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60584.9020; train_chrom_access_recon_loss: 3757365.0687; train_global_loss: 21626896.3969; train_optim_loss: 21626896.3969; val_kl_reg_loss: 27167.2109; val_edge_recon_loss: 726849.5917; val_gene_expr_recon_loss: 17100879.6667; val_masked_gp_l1_reg_loss: 74663.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60544.9297; val_chrom_access_recon_loss: 3830101.7000; val_global_loss: 21820206.2667; val_optim_loss: 21820206.2667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9438; val_auprc_score: 0.9348; val_best_acc_score: 0.8744; val_best_f1_score: 0.8782; train_kl_reg_loss: 51370.2505; train_edge_recon_loss: 694969.0415; train_gene_expr_recon_loss: 16991813.4580; train_masked_gp_l1_reg_loss: 74599.5635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60518.1113; train_chrom_access_recon_loss: 3760630.8855; train_global_loss: 21633901.3282; train_optim_loss: 21633901.3282; val_kl_reg_loss: 27005.9039; val_edge_recon_loss: 727068.8333; val_gene_expr_recon_loss: 17165437.3333; val_masked_gp_l1_reg_loss: 74534.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60484.8789; val_chrom_access_recon_loss: 3884968.2167; val_global_loss: 21939498.5333; val_optim_loss: 21939498.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9437; val_auprc_score: 0.9327; val_best_acc_score: 0.8703; val_best_f1_score: 0.8753; train_kl_reg_loss: 51251.3225; train_edge_recon_loss: 693732.2419; train_gene_expr_recon_loss: 17007835.8779; train_masked_gp_l1_reg_loss: 74520.6514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60304.8976; train_chrom_access_recon_loss: 3763077.8340; train_global_loss: 21650722.8855; train_optim_loss: 21650722.8855; val_kl_reg_loss: 26653.4734; val_edge_recon_loss: 727031.4875; val_gene_expr_recon_loss: 17062233.9333; val_masked_gp_l1_reg_loss: 74511.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60278.4727; val_chrom_access_recon_loss: 3820438.2833; val_global_loss: 21771146.9333; val_optim_loss: 21771146.9333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9414; val_auprc_score: 0.9286; val_best_acc_score: 0.8744; val_best_f1_score: 0.8784; train_kl_reg_loss: 51533.8208; train_edge_recon_loss: 694193.8750; train_gene_expr_recon_loss: 16990956.9084; train_masked_gp_l1_reg_loss: 74503.2770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60268.5586; train_chrom_access_recon_loss: 3758897.6260; train_global_loss: 21630354.0153; train_optim_loss: 21630354.0153; val_kl_reg_loss: 27049.3677; val_edge_recon_loss: 725805.1917; val_gene_expr_recon_loss: 17088630.1333; val_masked_gp_l1_reg_loss: 74495.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60261.1211; val_chrom_access_recon_loss: 3818937.4000; val_global_loss: 21795179.7333; val_optim_loss: 21795179.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9412; val_auprc_score: 0.9314; val_best_acc_score: 0.8688; val_best_f1_score: 0.8738; train_kl_reg_loss: 51276.0002; train_edge_recon_loss: 695014.9656; train_gene_expr_recon_loss: 16974733.2366; train_masked_gp_l1_reg_loss: 74487.9505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60253.2497; train_chrom_access_recon_loss: 3753665.7920; train_global_loss: 21609431.1298; train_optim_loss: 21609431.1298; val_kl_reg_loss: 26654.6638; val_edge_recon_loss: 727781.6583; val_gene_expr_recon_loss: 17073609.8667; val_masked_gp_l1_reg_loss: 74480.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60246.1406; val_chrom_access_recon_loss: 3854943.4333; val_global_loss: 21817715.6000; val_optim_loss: 21817715.6000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9447; val_auprc_score: 0.9330; val_best_acc_score: 0.8770; val_best_f1_score: 0.8810; train_kl_reg_loss: 51259.7550; train_edge_recon_loss: 694860.3402; train_gene_expr_recon_loss: 16993895.1603; train_masked_gp_l1_reg_loss: 74472.8990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60239.9677; train_chrom_access_recon_loss: 3758530.4218; train_global_loss: 21633258.4122; train_optim_loss: 21633258.4122; val_kl_reg_loss: 27053.8685; val_edge_recon_loss: 725853.2625; val_gene_expr_recon_loss: 17124863.4000; val_masked_gp_l1_reg_loss: 74465.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60234.0625; val_chrom_access_recon_loss: 3863326.6000; val_global_loss: 21875796.6667; val_optim_loss: 21875796.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9421; val_auprc_score: 0.9282; val_best_acc_score: 0.8717; val_best_f1_score: 0.8769; train_kl_reg_loss: 51199.4158; train_edge_recon_loss: 693770.0067; train_gene_expr_recon_loss: 16984099.7634; train_masked_gp_l1_reg_loss: 74457.4179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60228.5556; train_chrom_access_recon_loss: 3757270.3779; train_global_loss: 21621025.4046; train_optim_loss: 21621025.4046; val_kl_reg_loss: 27141.2723; val_edge_recon_loss: 725751.3042; val_gene_expr_recon_loss: 17109291.5333; val_masked_gp_l1_reg_loss: 74449.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60222.7695; val_chrom_access_recon_loss: 3844203.9000; val_global_loss: 21841060.0000; val_optim_loss: 21841060.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9443; val_auprc_score: 0.9315; val_best_acc_score: 0.8733; val_best_f1_score: 0.8778; train_kl_reg_loss: 51361.4786; train_edge_recon_loss: 694140.6369; train_gene_expr_recon_loss: 17001213.9466; train_masked_gp_l1_reg_loss: 74448.1087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60204.3723; train_chrom_access_recon_loss: 3766155.3569; train_global_loss: 21647523.9695; train_optim_loss: 21647523.9695; val_kl_reg_loss: 26729.3529; val_edge_recon_loss: 725479.0333; val_gene_expr_recon_loss: 17069912.6000; val_masked_gp_l1_reg_loss: 74447.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60201.7148; val_chrom_access_recon_loss: 3837779.0000; val_global_loss: 21794549.8667; val_optim_loss: 21794549.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9452; val_auprc_score: 0.9323; val_best_acc_score: 0.8769; val_best_f1_score: 0.8808; train_kl_reg_loss: 51302.6336; train_edge_recon_loss: 694534.6927; train_gene_expr_recon_loss: 16985977.8092; train_masked_gp_l1_reg_loss: 74446.1667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60200.8128; train_chrom_access_recon_loss: 3757149.4103; train_global_loss: 21623611.3130; train_optim_loss: 21623611.3130; val_kl_reg_loss: 26878.4902; val_edge_recon_loss: 726001.6542; val_gene_expr_recon_loss: 17039761.5333; val_masked_gp_l1_reg_loss: 74445.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60199.8398; val_chrom_access_recon_loss: 3847383.5000; val_global_loss: 21774671.0667; val_optim_loss: 21774671.0667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9416; val_auprc_score: 0.9285; val_best_acc_score: 0.8682; val_best_f1_score: 0.8736; train_kl_reg_loss: 51297.6546; train_edge_recon_loss: 694324.5453; train_gene_expr_recon_loss: 16987944.8702; train_masked_gp_l1_reg_loss: 74444.4608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60199.0465; train_chrom_access_recon_loss: 3757120.2290; train_global_loss: 21625330.7176; train_optim_loss: 21625330.7176; val_kl_reg_loss: 27111.1470; val_edge_recon_loss: 725688.0542; val_gene_expr_recon_loss: 17128633.8667; val_masked_gp_l1_reg_loss: 74443.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60198.3242; val_chrom_access_recon_loss: 3828167.7833; val_global_loss: 21844242.4000; val_optim_loss: 21844242.4000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9440; val_auprc_score: 0.9352; val_best_acc_score: 0.8751; val_best_f1_score: 0.8794; train_kl_reg_loss: 56502.4609; train_edge_recon_loss: 694101.4165; train_gene_expr_recon_loss: 17005169.1069; train_masked_gp_l1_reg_loss: 74442.7635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60197.6486; train_chrom_access_recon_loss: 3756562.0038; train_global_loss: 21646975.5725; train_optim_loss: 21646975.5725; val_kl_reg_loss: 26987.7750; val_edge_recon_loss: 726421.6625; val_gene_expr_recon_loss: 17115851.9333; val_masked_gp_l1_reg_loss: 74441.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60196.9141; val_chrom_access_recon_loss: 3844046.3333; val_global_loss: 21847945.8667; val_optim_loss: 21847945.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 32 min 10 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9442
val AUPRC score: 0.9336
val best accuracy score: 0.8746
val best F1 score: 0.8789
val target rna MSE score: 1.8208
val source rna MSE score: 0.8394
val target atac MSE score: 0.5276
val source atac MSE score: 0.1650
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
