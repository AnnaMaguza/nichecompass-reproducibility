[True]
Run timestamp: 07092023_030820_249.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_249']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1131 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5649, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1131
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1131

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7426; val_auprc_score: 0.7599; val_best_acc_score: 0.5478; val_best_f1_score: 0.6859; train_kl_reg_loss: 100879.6462; train_edge_recon_loss: 3542606.2920; train_gene_expr_recon_loss: 16741493.9695; train_masked_gp_l1_reg_loss: 47282.5743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5531918.9967; train_chrom_access_recon_loss: 6549053.9466; train_global_loss: 32513235.3282; train_optim_loss: 32513235.3282; val_kl_reg_loss: 125775.5516; val_edge_recon_loss: 4062787.3500; val_gene_expr_recon_loss: 15837849.2667; val_masked_gp_l1_reg_loss: 42300.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 389447.9688; val_chrom_access_recon_loss: 6398057.7000; val_global_loss: 26856218.2667; val_optim_loss: 26856218.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8186; val_auprc_score: 0.8207; val_best_acc_score: 0.7340; val_best_f1_score: 0.7499; train_kl_reg_loss: 115910.2282; train_edge_recon_loss: 3529985.9618; train_gene_expr_recon_loss: 15534841.9924; train_masked_gp_l1_reg_loss: 41722.7150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 250383.5266; train_chrom_access_recon_loss: 6303771.5153; train_global_loss: 25776616.0000; train_optim_loss: 25776616.0000; val_kl_reg_loss: 92835.0177; val_edge_recon_loss: 4026632.2000; val_gene_expr_recon_loss: 15596863.4667; val_masked_gp_l1_reg_loss: 42349.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190263.4219; val_chrom_access_recon_loss: 6350587.3667; val_global_loss: 26299532.0000; val_optim_loss: 26299532.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8450; val_auprc_score: 0.8502; val_best_acc_score: 0.7513; val_best_f1_score: 0.7635; train_kl_reg_loss: 90648.3817; train_edge_recon_loss: 3386159.3302; train_gene_expr_recon_loss: 15327809.0611; train_masked_gp_l1_reg_loss: 44515.7700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168715.8340; train_chrom_access_recon_loss: 6226768.7939; train_global_loss: 25244617.1908; train_optim_loss: 25244617.1908; val_kl_reg_loss: 105140.1260; val_edge_recon_loss: 3140525.5667; val_gene_expr_recon_loss: 15358339.8000; val_masked_gp_l1_reg_loss: 46928.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154541.1719; val_chrom_access_recon_loss: 6244530.0333; val_global_loss: 25050005.4667; val_optim_loss: 25050005.4667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8790; val_auprc_score: 0.8786; val_best_acc_score: 0.7904; val_best_f1_score: 0.8002; train_kl_reg_loss: 112052.2399; train_edge_recon_loss: 3052732.7481; train_gene_expr_recon_loss: 15187229.4046; train_masked_gp_l1_reg_loss: 48701.0437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145418.3657; train_chrom_access_recon_loss: 6167956.9008; train_global_loss: 24714090.6565; train_optim_loss: 24714090.6565; val_kl_reg_loss: 112339.4677; val_edge_recon_loss: 3015991.7167; val_gene_expr_recon_loss: 15275375.8667; val_masked_gp_l1_reg_loss: 50351.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139050.3438; val_chrom_access_recon_loss: 6197872.0333; val_global_loss: 24790980.9333; val_optim_loss: 24790980.9333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9169; val_auprc_score: 0.9065; val_best_acc_score: 0.8456; val_best_f1_score: 0.8515; train_kl_reg_loss: 113744.4640; train_edge_recon_loss: 2898922.2634; train_gene_expr_recon_loss: 15014270.7481; train_masked_gp_l1_reg_loss: 52120.6344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135619.1784; train_chrom_access_recon_loss: 6098434.7443; train_global_loss: 24313112.0458; train_optim_loss: 24313112.0458; val_kl_reg_loss: 123573.8750; val_edge_recon_loss: 2862117.7000; val_gene_expr_recon_loss: 15087691.6000; val_masked_gp_l1_reg_loss: 53703.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132005.1562; val_chrom_access_recon_loss: 6125367.8333; val_global_loss: 24384461.0667; val_optim_loss: 24384461.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9220; val_auprc_score: 0.9078; val_best_acc_score: 0.8546; val_best_f1_score: 0.8631; train_kl_reg_loss: 118031.7424; train_edge_recon_loss: 2834795.6469; train_gene_expr_recon_loss: 14883369.7634; train_masked_gp_l1_reg_loss: 55104.5992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130165.7767; train_chrom_access_recon_loss: 6050522.8168; train_global_loss: 24071990.2595; train_optim_loss: 24071990.2595; val_kl_reg_loss: 118848.6297; val_edge_recon_loss: 2838591.2000; val_gene_expr_recon_loss: 14967262.2667; val_masked_gp_l1_reg_loss: 56496.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129224.2578; val_chrom_access_recon_loss: 6062060.3667; val_global_loss: 24172482.2667; val_optim_loss: 24172482.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9313; val_auprc_score: 0.9176; val_best_acc_score: 0.8608; val_best_f1_score: 0.8680; train_kl_reg_loss: 112175.9300; train_edge_recon_loss: 2826671.0611; train_gene_expr_recon_loss: 14755075.3130; train_masked_gp_l1_reg_loss: 57744.9133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127823.4992; train_chrom_access_recon_loss: 5989988.2672; train_global_loss: 23869479.0840; train_optim_loss: 23869479.0840; val_kl_reg_loss: 110972.3865; val_edge_recon_loss: 2815237.1833; val_gene_expr_recon_loss: 14856760.9333; val_masked_gp_l1_reg_loss: 58937.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127226.8984; val_chrom_access_recon_loss: 6021452.8667; val_global_loss: 23990587.7333; val_optim_loss: 23990587.7333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9356; val_auprc_score: 0.9203; val_best_acc_score: 0.8713; val_best_f1_score: 0.8765; train_kl_reg_loss: 109975.1421; train_edge_recon_loss: 2803476.5382; train_gene_expr_recon_loss: 14659300.7023; train_masked_gp_l1_reg_loss: 60017.6622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126674.2417; train_chrom_access_recon_loss: 5950337.6374; train_global_loss: 23709781.8473; train_optim_loss: 23709781.8473; val_kl_reg_loss: 107037.7073; val_edge_recon_loss: 2804232.8333; val_gene_expr_recon_loss: 14676325.6000; val_masked_gp_l1_reg_loss: 61188.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127145.9531; val_chrom_access_recon_loss: 5947741.5667; val_global_loss: 23723671.4667; val_optim_loss: 23723671.4667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9351; val_auprc_score: 0.9190; val_best_acc_score: 0.8728; val_best_f1_score: 0.8793; train_kl_reg_loss: 104721.2770; train_edge_recon_loss: 2807918.0973; train_gene_expr_recon_loss: 14569379.4427; train_masked_gp_l1_reg_loss: 62017.1247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126876.1625; train_chrom_access_recon_loss: 5914972.3435; train_global_loss: 23585884.5344; train_optim_loss: 23585884.5344; val_kl_reg_loss: 103387.3776; val_edge_recon_loss: 2804969.0333; val_gene_expr_recon_loss: 14690752.9333; val_masked_gp_l1_reg_loss: 62942.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126871.0312; val_chrom_access_recon_loss: 5965284.6333; val_global_loss: 23754208.2667; val_optim_loss: 23754208.2667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9375; val_auprc_score: 0.9250; val_best_acc_score: 0.8713; val_best_f1_score: 0.8785; train_kl_reg_loss: 104224.6466; train_edge_recon_loss: 2791431.1279; train_gene_expr_recon_loss: 14483190.3664; train_masked_gp_l1_reg_loss: 63663.9071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126585.1961; train_chrom_access_recon_loss: 5878041.4695; train_global_loss: 23447136.5954; train_optim_loss: 23447136.5954; val_kl_reg_loss: 100839.6594; val_edge_recon_loss: 2809507.7167; val_gene_expr_recon_loss: 14513416.1333; val_masked_gp_l1_reg_loss: 64500.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126442.0938; val_chrom_access_recon_loss: 5890487.1667; val_global_loss: 23505192.6667; val_optim_loss: 23505192.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9391; val_auprc_score: 0.9275; val_best_acc_score: 0.8751; val_best_f1_score: 0.8799; train_kl_reg_loss: 101250.0610; train_edge_recon_loss: 2783864.0878; train_gene_expr_recon_loss: 14394497.0458; train_masked_gp_l1_reg_loss: 65136.1302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126077.1493; train_chrom_access_recon_loss: 5841788.1870; train_global_loss: 23312612.5954; train_optim_loss: 23312612.5954; val_kl_reg_loss: 101549.6375; val_edge_recon_loss: 2806682.8333; val_gene_expr_recon_loss: 14445432.9333; val_masked_gp_l1_reg_loss: 65873.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126217.3750; val_chrom_access_recon_loss: 5878591.0333; val_global_loss: 23424348.4000; val_optim_loss: 23424348.4000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9402; val_auprc_score: 0.9271; val_best_acc_score: 0.8786; val_best_f1_score: 0.8832; train_kl_reg_loss: 99718.1576; train_edge_recon_loss: 2789301.2691; train_gene_expr_recon_loss: 14346710.1298; train_masked_gp_l1_reg_loss: 66471.2288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126415.5802; train_chrom_access_recon_loss: 5816561.1718; train_global_loss: 23245177.5420; train_optim_loss: 23245177.5420; val_kl_reg_loss: 96717.8531; val_edge_recon_loss: 2802955.3500; val_gene_expr_recon_loss: 14485596.8000; val_masked_gp_l1_reg_loss: 67037.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126820.4141; val_chrom_access_recon_loss: 5871432.5333; val_global_loss: 23450560.2667; val_optim_loss: 23450560.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9479; val_auprc_score: 0.9365; val_best_acc_score: 0.8894; val_best_f1_score: 0.8927; train_kl_reg_loss: 96270.6461; train_edge_recon_loss: 2770261.9065; train_gene_expr_recon_loss: 14281804.6183; train_masked_gp_l1_reg_loss: 67605.8160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126764.9516; train_chrom_access_recon_loss: 5788395.4542; train_global_loss: 23131103.3588; train_optim_loss: 23131103.3588; val_kl_reg_loss: 93479.1500; val_edge_recon_loss: 2760508.3167; val_gene_expr_recon_loss: 14368741.4000; val_masked_gp_l1_reg_loss: 68102.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126559.0781; val_chrom_access_recon_loss: 5821245.9000; val_global_loss: 23238636.8000; val_optim_loss: 23238636.8000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9455; val_auprc_score: 0.9323; val_best_acc_score: 0.8794; val_best_f1_score: 0.8860; train_kl_reg_loss: 95484.4126; train_edge_recon_loss: 2758908.6546; train_gene_expr_recon_loss: 14219495.4122; train_masked_gp_l1_reg_loss: 68691.5018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126799.8220; train_chrom_access_recon_loss: 5764250.3855; train_global_loss: 23033630.1069; train_optim_loss: 23033630.1069; val_kl_reg_loss: 94243.4771; val_edge_recon_loss: 2790408.3167; val_gene_expr_recon_loss: 14354342.8000; val_masked_gp_l1_reg_loss: 69320.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127364.4766; val_chrom_access_recon_loss: 5814540.5333; val_global_loss: 23250219.2000; val_optim_loss: 23250219.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9484; val_auprc_score: 0.9365; val_best_acc_score: 0.8863; val_best_f1_score: 0.8917; train_kl_reg_loss: 94389.3349; train_edge_recon_loss: 2751925.1966; train_gene_expr_recon_loss: 14174789.0305; train_masked_gp_l1_reg_loss: 69787.8074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128055.5487; train_chrom_access_recon_loss: 5742273.7214; train_global_loss: 22961220.6412; train_optim_loss: 22961220.6412; val_kl_reg_loss: 96860.2682; val_edge_recon_loss: 2772596.0000; val_gene_expr_recon_loss: 14285649.4000; val_masked_gp_l1_reg_loss: 70409.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129508.8047; val_chrom_access_recon_loss: 5778553.9000; val_global_loss: 23133577.7333; val_optim_loss: 23133577.7333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9471; val_auprc_score: 0.9336; val_best_acc_score: 0.8843; val_best_f1_score: 0.8899; train_kl_reg_loss: 94347.4303; train_edge_recon_loss: 2746237.5859; train_gene_expr_recon_loss: 14129741.5496; train_masked_gp_l1_reg_loss: 70771.0745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129633.5156; train_chrom_access_recon_loss: 5727644.1107; train_global_loss: 22898375.4809; train_optim_loss: 22898375.4809; val_kl_reg_loss: 92675.7245; val_edge_recon_loss: 2771352.4000; val_gene_expr_recon_loss: 14217689.0667; val_masked_gp_l1_reg_loss: 71238.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129606.5703; val_chrom_access_recon_loss: 5755397.2667; val_global_loss: 23037958.6667; val_optim_loss: 23037958.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9560; val_auprc_score: 0.9431; val_best_acc_score: 0.8980; val_best_f1_score: 0.9012; train_kl_reg_loss: 92894.5158; train_edge_recon_loss: 2738207.6317; train_gene_expr_recon_loss: 14089863.5115; train_masked_gp_l1_reg_loss: 71660.8259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130310.2819; train_chrom_access_recon_loss: 5707105.9237; train_global_loss: 22830042.8550; train_optim_loss: 22830042.8550; val_kl_reg_loss: 95954.4958; val_edge_recon_loss: 2728743.5667; val_gene_expr_recon_loss: 14240321.8667; val_masked_gp_l1_reg_loss: 72155.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130663.3906; val_chrom_access_recon_loss: 5770611.0333; val_global_loss: 23038450.1333; val_optim_loss: 23038450.1333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9553; val_auprc_score: 0.9426; val_best_acc_score: 0.8944; val_best_f1_score: 0.8998; train_kl_reg_loss: 92374.0837; train_edge_recon_loss: 2727355.8435; train_gene_expr_recon_loss: 14056461.2290; train_masked_gp_l1_reg_loss: 72580.3788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131007.8142; train_chrom_access_recon_loss: 5688303.7710; train_global_loss: 22768083.2061; train_optim_loss: 22768083.2061; val_kl_reg_loss: 89775.4521; val_edge_recon_loss: 2743481.5833; val_gene_expr_recon_loss: 14133436.8000; val_masked_gp_l1_reg_loss: 73022.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132563.4375; val_chrom_access_recon_loss: 5739031.8667; val_global_loss: 22911311.7333; val_optim_loss: 22911311.7333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9596; val_auprc_score: 0.9511; val_best_acc_score: 0.8992; val_best_f1_score: 0.9039; train_kl_reg_loss: 91012.7217; train_edge_recon_loss: 2728275.6240; train_gene_expr_recon_loss: 14010651.0229; train_masked_gp_l1_reg_loss: 73403.1583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131753.7843; train_chrom_access_recon_loss: 5671145.3092; train_global_loss: 22706241.6183; train_optim_loss: 22706241.6183; val_kl_reg_loss: 91149.1521; val_edge_recon_loss: 2739029.4167; val_gene_expr_recon_loss: 14187611.7333; val_masked_gp_l1_reg_loss: 73838.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131557.7031; val_chrom_access_recon_loss: 5776102.3000; val_global_loss: 22999289.0667; val_optim_loss: 22999289.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9645; val_auprc_score: 0.9546; val_best_acc_score: 0.9096; val_best_f1_score: 0.9131; train_kl_reg_loss: 91594.2709; train_edge_recon_loss: 2723560.8607; train_gene_expr_recon_loss: 13979417.1450; train_masked_gp_l1_reg_loss: 74210.6939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131623.6684; train_chrom_access_recon_loss: 5654186.7786; train_global_loss: 22654593.4809; train_optim_loss: 22654593.4809; val_kl_reg_loss: 91990.6010; val_edge_recon_loss: 2708474.4500; val_gene_expr_recon_loss: 14086388.4667; val_masked_gp_l1_reg_loss: 74493.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132332.2812; val_chrom_access_recon_loss: 5706326.3667; val_global_loss: 22800005.7333; val_optim_loss: 22800005.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9679; val_auprc_score: 0.9605; val_best_acc_score: 0.9116; val_best_f1_score: 0.9148; train_kl_reg_loss: 90899.2940; train_edge_recon_loss: 2715979.8073; train_gene_expr_recon_loss: 13943741.4198; train_masked_gp_l1_reg_loss: 74911.1830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131796.6622; train_chrom_access_recon_loss: 5639761.5802; train_global_loss: 22597089.8015; train_optim_loss: 22597089.8015; val_kl_reg_loss: 89535.5641; val_edge_recon_loss: 2711934.1667; val_gene_expr_recon_loss: 14087894.7333; val_masked_gp_l1_reg_loss: 75316.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131735.0156; val_chrom_access_recon_loss: 5680813.0333; val_global_loss: 22777229.3333; val_optim_loss: 22777229.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9633; val_auprc_score: 0.9550; val_best_acc_score: 0.9088; val_best_f1_score: 0.9128; train_kl_reg_loss: 90499.4196; train_edge_recon_loss: 2708740.9198; train_gene_expr_recon_loss: 13919012.7252; train_masked_gp_l1_reg_loss: 75670.2700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131765.5563; train_chrom_access_recon_loss: 5626622.3397; train_global_loss: 22552311.0992; train_optim_loss: 22552311.0992; val_kl_reg_loss: 90671.6339; val_edge_recon_loss: 2729758.4500; val_gene_expr_recon_loss: 14008601.8667; val_masked_gp_l1_reg_loss: 75994.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131816.3750; val_chrom_access_recon_loss: 5657322.1000; val_global_loss: 22694164.6667; val_optim_loss: 22694164.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9666; val_auprc_score: 0.9569; val_best_acc_score: 0.9171; val_best_f1_score: 0.9197; train_kl_reg_loss: 89686.8268; train_edge_recon_loss: 2714648.5534; train_gene_expr_recon_loss: 13894983.3053; train_masked_gp_l1_reg_loss: 76337.5839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131914.2435; train_chrom_access_recon_loss: 5613542.0802; train_global_loss: 22521112.6107; train_optim_loss: 22521112.6107; val_kl_reg_loss: 89524.5312; val_edge_recon_loss: 2698480.0333; val_gene_expr_recon_loss: 14046994.5333; val_masked_gp_l1_reg_loss: 76669.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131693.4219; val_chrom_access_recon_loss: 5676110.6333; val_global_loss: 22719472.9333; val_optim_loss: 22719472.9333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9702; val_auprc_score: 0.9622; val_best_acc_score: 0.9175; val_best_f1_score: 0.9209; train_kl_reg_loss: 89491.2296; train_edge_recon_loss: 2702932.2939; train_gene_expr_recon_loss: 13881429.5496; train_masked_gp_l1_reg_loss: 76967.5470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132053.7408; train_chrom_access_recon_loss: 5606540.7977; train_global_loss: 22489415.0992; train_optim_loss: 22489415.0992; val_kl_reg_loss: 89792.7630; val_edge_recon_loss: 2704726.1833; val_gene_expr_recon_loss: 13992518.3333; val_masked_gp_l1_reg_loss: 77374.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133025.4844; val_chrom_access_recon_loss: 5692678.2333; val_global_loss: 22690115.6000; val_optim_loss: 22690115.6000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9672; val_auprc_score: 0.9530; val_best_acc_score: 0.9153; val_best_f1_score: 0.9188; train_kl_reg_loss: 89273.1602; train_edge_recon_loss: 2701348.9332; train_gene_expr_recon_loss: 13852287.6031; train_masked_gp_l1_reg_loss: 77582.4902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132282.7563; train_chrom_access_recon_loss: 5595604.2748; train_global_loss: 22448379.3435; train_optim_loss: 22448379.3435; val_kl_reg_loss: 88325.5229; val_edge_recon_loss: 2709447.2500; val_gene_expr_recon_loss: 13922539.6000; val_masked_gp_l1_reg_loss: 77904.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132726.9844; val_chrom_access_recon_loss: 5629063.2333; val_global_loss: 22560006.0000; val_optim_loss: 22560006.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9695; val_auprc_score: 0.9615; val_best_acc_score: 0.9198; val_best_f1_score: 0.9223; train_kl_reg_loss: 88138.7714; train_edge_recon_loss: 2700499.5706; train_gene_expr_recon_loss: 13826746.1527; train_masked_gp_l1_reg_loss: 78181.9454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132518.8138; train_chrom_access_recon_loss: 5579010.9275; train_global_loss: 22405096.0458; train_optim_loss: 22405096.0458; val_kl_reg_loss: 89149.1526; val_edge_recon_loss: 2717784.4000; val_gene_expr_recon_loss: 13937687.4000; val_masked_gp_l1_reg_loss: 78465.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132063.8281; val_chrom_access_recon_loss: 5676730.3000; val_global_loss: 22631881.2000; val_optim_loss: 22631881.2000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9711; val_auprc_score: 0.9645; val_best_acc_score: 0.9181; val_best_f1_score: 0.9212; train_kl_reg_loss: 88223.0474; train_edge_recon_loss: 2699387.1393; train_gene_expr_recon_loss: 13816561.4733; train_masked_gp_l1_reg_loss: 78725.4112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132551.1396; train_chrom_access_recon_loss: 5575243.8473; train_global_loss: 22390692.2137; train_optim_loss: 22390692.2137; val_kl_reg_loss: 91131.9729; val_edge_recon_loss: 2707565.8667; val_gene_expr_recon_loss: 13917710.7333; val_masked_gp_l1_reg_loss: 79084.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132460.0469; val_chrom_access_recon_loss: 5662475.2667; val_global_loss: 22590428.9333; val_optim_loss: 22590428.9333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9729; val_auprc_score: 0.9656; val_best_acc_score: 0.9206; val_best_f1_score: 0.9234; train_kl_reg_loss: 87683.6084; train_edge_recon_loss: 2696737.0725; train_gene_expr_recon_loss: 13782607.5267; train_masked_gp_l1_reg_loss: 79194.2563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132760.5245; train_chrom_access_recon_loss: 5556254.2481; train_global_loss: 22335237.1756; train_optim_loss: 22335237.1756; val_kl_reg_loss: 87090.2182; val_edge_recon_loss: 2722399.2500; val_gene_expr_recon_loss: 13879529.7333; val_masked_gp_l1_reg_loss: 79465.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133075.4062; val_chrom_access_recon_loss: 5612484.8000; val_global_loss: 22514044.9333; val_optim_loss: 22514044.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9742; val_auprc_score: 0.9633; val_best_acc_score: 0.9278; val_best_f1_score: 0.9307; train_kl_reg_loss: 86735.8397; train_edge_recon_loss: 2698856.3531; train_gene_expr_recon_loss: 13769760.7099; train_masked_gp_l1_reg_loss: 79710.6778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133089.8829; train_chrom_access_recon_loss: 5553120.5420; train_global_loss: 22321273.9237; train_optim_loss: 22321273.9237; val_kl_reg_loss: 87176.1010; val_edge_recon_loss: 2681866.8167; val_gene_expr_recon_loss: 13962558.2000; val_masked_gp_l1_reg_loss: 79952.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133096.6875; val_chrom_access_recon_loss: 5622070.8667; val_global_loss: 22566720.9333; val_optim_loss: 22566720.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9720; val_auprc_score: 0.9635; val_best_acc_score: 0.9239; val_best_f1_score: 0.9266; train_kl_reg_loss: 86633.1512; train_edge_recon_loss: 2697382.2672; train_gene_expr_recon_loss: 13760788.8397; train_masked_gp_l1_reg_loss: 80158.0445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133282.9752; train_chrom_access_recon_loss: 5543275.0611; train_global_loss: 22301520.3053; train_optim_loss: 22301520.3053; val_kl_reg_loss: 90233.0312; val_edge_recon_loss: 2703748.1000; val_gene_expr_recon_loss: 13924631.4667; val_masked_gp_l1_reg_loss: 80529.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134346.8906; val_chrom_access_recon_loss: 5633301.4667; val_global_loss: 22566789.8667; val_optim_loss: 22566789.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9756; val_auprc_score: 0.9683; val_best_acc_score: 0.9305; val_best_f1_score: 0.9320; train_kl_reg_loss: 86007.7722; train_edge_recon_loss: 2688464.4905; train_gene_expr_recon_loss: 13740064.9695; train_masked_gp_l1_reg_loss: 80672.4175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133579.8359; train_chrom_access_recon_loss: 5530290.5191; train_global_loss: 22259080.0458; train_optim_loss: 22259080.0458; val_kl_reg_loss: 86171.7130; val_edge_recon_loss: 2705177.9000; val_gene_expr_recon_loss: 13837681.9333; val_masked_gp_l1_reg_loss: 80852.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133734.7656; val_chrom_access_recon_loss: 5588001.9000; val_global_loss: 22431620.2667; val_optim_loss: 22431620.2667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9738; val_auprc_score: 0.9676; val_best_acc_score: 0.9283; val_best_f1_score: 0.9308; train_kl_reg_loss: 86803.5959; train_edge_recon_loss: 2691390.5420; train_gene_expr_recon_loss: 13719355.3588; train_masked_gp_l1_reg_loss: 81068.0414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133803.7812; train_chrom_access_recon_loss: 5521859.0382; train_global_loss: 22234280.3359; train_optim_loss: 22234280.3359; val_kl_reg_loss: 86452.3448; val_edge_recon_loss: 2702874.2000; val_gene_expr_recon_loss: 13843392.6667; val_masked_gp_l1_reg_loss: 81209.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133744.0156; val_chrom_access_recon_loss: 5604122.4333; val_global_loss: 22451794.9333; val_optim_loss: 22451794.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9779; val_auprc_score: 0.9707; val_best_acc_score: 0.9297; val_best_f1_score: 0.9312; train_kl_reg_loss: 86137.4690; train_edge_recon_loss: 2691027.3378; train_gene_expr_recon_loss: 13710783.9771; train_masked_gp_l1_reg_loss: 81429.0298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133908.3750; train_chrom_access_recon_loss: 5511998.2901; train_global_loss: 22215284.4580; train_optim_loss: 22215284.4580; val_kl_reg_loss: 84172.9865; val_edge_recon_loss: 2704859.0333; val_gene_expr_recon_loss: 13807645.8000; val_masked_gp_l1_reg_loss: 81633.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134497.2969; val_chrom_access_recon_loss: 5591698.3667; val_global_loss: 22404506.6667; val_optim_loss: 22404506.6667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9779; val_auprc_score: 0.9694; val_best_acc_score: 0.9295; val_best_f1_score: 0.9329; train_kl_reg_loss: 85046.7898; train_edge_recon_loss: 2691319.5420; train_gene_expr_recon_loss: 13691116.9924; train_masked_gp_l1_reg_loss: 81829.3630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134287.8350; train_chrom_access_recon_loss: 5504868.3664; train_global_loss: 22188468.9313; train_optim_loss: 22188468.9313; val_kl_reg_loss: 84751.8208; val_edge_recon_loss: 2696528.7000; val_gene_expr_recon_loss: 13848986.9333; val_masked_gp_l1_reg_loss: 82040.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134093.4219; val_chrom_access_recon_loss: 5580798.6333; val_global_loss: 22427200.0000; val_optim_loss: 22427200.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9799; val_auprc_score: 0.9729; val_best_acc_score: 0.9360; val_best_f1_score: 0.9373; train_kl_reg_loss: 86002.8474; train_edge_recon_loss: 2683836.4637; train_gene_expr_recon_loss: 13689165.9084; train_masked_gp_l1_reg_loss: 82210.2313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134240.9003; train_chrom_access_recon_loss: 5495170.1718; train_global_loss: 22170626.4122; train_optim_loss: 22170626.4122; val_kl_reg_loss: 85968.7370; val_edge_recon_loss: 2700812.6333; val_gene_expr_recon_loss: 13811012.7333; val_masked_gp_l1_reg_loss: 82354.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134716.4844; val_chrom_access_recon_loss: 5574394.8667; val_global_loss: 22389259.7333; val_optim_loss: 22389259.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9809; val_auprc_score: 0.9754; val_best_acc_score: 0.9399; val_best_f1_score: 0.9420; train_kl_reg_loss: 85108.0352; train_edge_recon_loss: 2691624.2557; train_gene_expr_recon_loss: 13687758.4962; train_masked_gp_l1_reg_loss: 82601.6041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134564.1700; train_chrom_access_recon_loss: 5496273.0534; train_global_loss: 22177929.5725; train_optim_loss: 22177929.5725; val_kl_reg_loss: 85263.8354; val_edge_recon_loss: 2687529.3167; val_gene_expr_recon_loss: 13803370.7333; val_masked_gp_l1_reg_loss: 82788.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135372.9375; val_chrom_access_recon_loss: 5557151.7000; val_global_loss: 22351476.8000; val_optim_loss: 22351476.8000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9823; val_auprc_score: 0.9767; val_best_acc_score: 0.9418; val_best_f1_score: 0.9434; train_kl_reg_loss: 84858.3869; train_edge_recon_loss: 2688158.3798; train_gene_expr_recon_loss: 13667206.1298; train_masked_gp_l1_reg_loss: 82915.7159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134802.0402; train_chrom_access_recon_loss: 5485261.8053; train_global_loss: 22143202.3053; train_optim_loss: 22143202.3053; val_kl_reg_loss: 84740.4750; val_edge_recon_loss: 2699209.7333; val_gene_expr_recon_loss: 13840930.6667; val_masked_gp_l1_reg_loss: 83162.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135441.2500; val_chrom_access_recon_loss: 5589451.7667; val_global_loss: 22432936.5333; val_optim_loss: 22432936.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9833; val_auprc_score: 0.9794; val_best_acc_score: 0.9448; val_best_f1_score: 0.9457; train_kl_reg_loss: 85428.3377; train_edge_recon_loss: 2682151.9122; train_gene_expr_recon_loss: 13661273.1069; train_masked_gp_l1_reg_loss: 83238.0441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134934.3262; train_chrom_access_recon_loss: 5474304.4885; train_global_loss: 22121330.2290; train_optim_loss: 22121330.2290; val_kl_reg_loss: 85077.5823; val_edge_recon_loss: 2684624.4667; val_gene_expr_recon_loss: 13840736.3333; val_masked_gp_l1_reg_loss: 83351.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135512.5156; val_chrom_access_recon_loss: 5570742.7000; val_global_loss: 22400045.8667; val_optim_loss: 22400045.8667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9808; val_auprc_score: 0.9732; val_best_acc_score: 0.9407; val_best_f1_score: 0.9424; train_kl_reg_loss: 85316.7938; train_edge_recon_loss: 2678831.8321; train_gene_expr_recon_loss: 13638535.1298; train_masked_gp_l1_reg_loss: 83475.3100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134879.9939; train_chrom_access_recon_loss: 5466471.5573; train_global_loss: 22087510.5954; train_optim_loss: 22087510.5954; val_kl_reg_loss: 85735.2792; val_edge_recon_loss: 2691219.4333; val_gene_expr_recon_loss: 13836984.7333; val_masked_gp_l1_reg_loss: 83712.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135337.9219; val_chrom_access_recon_loss: 5594813.4000; val_global_loss: 22427802.9333; val_optim_loss: 22427802.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9839; val_auprc_score: 0.9806; val_best_acc_score: 0.9448; val_best_f1_score: 0.9462; train_kl_reg_loss: 84457.5590; train_edge_recon_loss: 2681494.5630; train_gene_expr_recon_loss: 13636215.5191; train_masked_gp_l1_reg_loss: 83791.9187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134969.3417; train_chrom_access_recon_loss: 5453194.2061; train_global_loss: 22074123.0840; train_optim_loss: 22074123.0840; val_kl_reg_loss: 86049.6984; val_edge_recon_loss: 2661811.3833; val_gene_expr_recon_loss: 13799995.1333; val_masked_gp_l1_reg_loss: 83960.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135635.1406; val_chrom_access_recon_loss: 5560478.4667; val_global_loss: 22327930.6667; val_optim_loss: 22327930.6667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9838; val_auprc_score: 0.9803; val_best_acc_score: 0.9413; val_best_f1_score: 0.9422; train_kl_reg_loss: 85229.9680; train_edge_recon_loss: 2679417.6145; train_gene_expr_recon_loss: 13634536.2595; train_masked_gp_l1_reg_loss: 83993.1263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135123.7551; train_chrom_access_recon_loss: 5452004.4122; train_global_loss: 22070305.1908; train_optim_loss: 22070305.1908; val_kl_reg_loss: 85223.2760; val_edge_recon_loss: 2695425.4667; val_gene_expr_recon_loss: 13789743.8667; val_masked_gp_l1_reg_loss: 84165.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136007.0469; val_chrom_access_recon_loss: 5562982.7667; val_global_loss: 22353549.2000; val_optim_loss: 22353549.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9824; val_auprc_score: 0.9776; val_best_acc_score: 0.9437; val_best_f1_score: 0.9448; train_kl_reg_loss: 84348.3669; train_edge_recon_loss: 2684949.9809; train_gene_expr_recon_loss: 13624098.5267; train_masked_gp_l1_reg_loss: 84236.0058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135559.7927; train_chrom_access_recon_loss: 5448530.2176; train_global_loss: 22061722.7634; train_optim_loss: 22061722.7634; val_kl_reg_loss: 84929.5490; val_edge_recon_loss: 2702824.1000; val_gene_expr_recon_loss: 13765883.4000; val_masked_gp_l1_reg_loss: 84319.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135342.0000; val_chrom_access_recon_loss: 5556578.5000; val_global_loss: 22329877.7333; val_optim_loss: 22329877.7333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9823; val_auprc_score: 0.9777; val_best_acc_score: 0.9450; val_best_f1_score: 0.9464; train_kl_reg_loss: 84703.6377; train_edge_recon_loss: 2677790.9084; train_gene_expr_recon_loss: 13612023.4580; train_masked_gp_l1_reg_loss: 84445.3104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135389.3628; train_chrom_access_recon_loss: 5438303.5344; train_global_loss: 22032656.0916; train_optim_loss: 22032656.0916; val_kl_reg_loss: 84616.2010; val_edge_recon_loss: 2689691.2833; val_gene_expr_recon_loss: 13733806.3333; val_masked_gp_l1_reg_loss: 84602.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135915.0156; val_chrom_access_recon_loss: 5535448.2667; val_global_loss: 22264080.1333; val_optim_loss: 22264080.1333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9861; val_auprc_score: 0.9811; val_best_acc_score: 0.9523; val_best_f1_score: 0.9533; train_kl_reg_loss: 84922.6164; train_edge_recon_loss: 2678830.0573; train_gene_expr_recon_loss: 13610013.8779; train_masked_gp_l1_reg_loss: 84676.2332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135508.8675; train_chrom_access_recon_loss: 5434739.9542; train_global_loss: 22028691.5420; train_optim_loss: 22028691.5420; val_kl_reg_loss: 85106.3531; val_edge_recon_loss: 2669902.4333; val_gene_expr_recon_loss: 13786499.1333; val_masked_gp_l1_reg_loss: 84713.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136110.4531; val_chrom_access_recon_loss: 5584855.9333; val_global_loss: 22347187.6000; val_optim_loss: 22347187.6000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9862; val_auprc_score: 0.9821; val_best_acc_score: 0.9495; val_best_f1_score: 0.9510; train_kl_reg_loss: 84395.6022; train_edge_recon_loss: 2685886.1145; train_gene_expr_recon_loss: 13607988.4580; train_masked_gp_l1_reg_loss: 84873.0225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135738.2140; train_chrom_access_recon_loss: 5431014.9351; train_global_loss: 22029896.1985; train_optim_loss: 22029896.1985; val_kl_reg_loss: 85718.7672; val_edge_recon_loss: 2694966.0167; val_gene_expr_recon_loss: 13753874.4667; val_masked_gp_l1_reg_loss: 85068.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136403.3750; val_chrom_access_recon_loss: 5532086.7000; val_global_loss: 22288117.3333; val_optim_loss: 22288117.3333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9854; val_auprc_score: 0.9818; val_best_acc_score: 0.9489; val_best_f1_score: 0.9501; train_kl_reg_loss: 85006.2507; train_edge_recon_loss: 2674575.8798; train_gene_expr_recon_loss: 13588896.4733; train_masked_gp_l1_reg_loss: 85131.2086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136020.2092; train_chrom_access_recon_loss: 5420077.5000; train_global_loss: 21989707.5115; train_optim_loss: 21989707.5115; val_kl_reg_loss: 83510.6286; val_edge_recon_loss: 2674787.4667; val_gene_expr_recon_loss: 13734482.0667; val_masked_gp_l1_reg_loss: 85268.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136136.5469; val_chrom_access_recon_loss: 5561380.8667; val_global_loss: 22275566.5333; val_optim_loss: 22275566.5333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9862; val_auprc_score: 0.9826; val_best_acc_score: 0.9497; val_best_f1_score: 0.9504; train_kl_reg_loss: 84637.1526; train_edge_recon_loss: 2672373.2424; train_gene_expr_recon_loss: 13592773.5496; train_masked_gp_l1_reg_loss: 85320.5482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135908.8036; train_chrom_access_recon_loss: 5417758.0611; train_global_loss: 21988771.4198; train_optim_loss: 21988771.4198; val_kl_reg_loss: 86503.8833; val_edge_recon_loss: 2701786.5333; val_gene_expr_recon_loss: 13734043.2667; val_masked_gp_l1_reg_loss: 85366.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135969.2656; val_chrom_access_recon_loss: 5535974.1667; val_global_loss: 22279644.2667; val_optim_loss: 22279644.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9850; val_auprc_score: 0.9812; val_best_acc_score: 0.9444; val_best_f1_score: 0.9452; train_kl_reg_loss: 86855.7009; train_edge_recon_loss: 2675399.2595; train_gene_expr_recon_loss: 13564487.7328; train_masked_gp_l1_reg_loss: 83392.1854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96052.5404; train_chrom_access_recon_loss: 5393697.9237; train_global_loss: 21899885.3282; train_optim_loss: 21899885.3282; val_kl_reg_loss: 89374.0599; val_edge_recon_loss: 2702368.7667; val_gene_expr_recon_loss: 13792514.7333; val_masked_gp_l1_reg_loss: 82465.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91311.7656; val_chrom_access_recon_loss: 5574323.4333; val_global_loss: 22332358.1333; val_optim_loss: 22332358.1333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9834; val_auprc_score: 0.9763; val_best_acc_score: 0.9468; val_best_f1_score: 0.9481; train_kl_reg_loss: 88488.0727; train_edge_recon_loss: 2671805.9866; train_gene_expr_recon_loss: 13562254.3740; train_masked_gp_l1_reg_loss: 82250.0692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90858.7201; train_chrom_access_recon_loss: 5396081.4313; train_global_loss: 21891738.7481; train_optim_loss: 21891738.7481; val_kl_reg_loss: 89427.6068; val_edge_recon_loss: 2693164.1000; val_gene_expr_recon_loss: 13742148.8667; val_masked_gp_l1_reg_loss: 82066.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90266.9688; val_chrom_access_recon_loss: 5546223.6000; val_global_loss: 22243297.7333; val_optim_loss: 22243297.7333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9847; val_auprc_score: 0.9778; val_best_acc_score: 0.9489; val_best_f1_score: 0.9496; train_kl_reg_loss: 88949.6093; train_edge_recon_loss: 2667309.4275; train_gene_expr_recon_loss: 13559841.8244; train_masked_gp_l1_reg_loss: 81987.9042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90110.7213; train_chrom_access_recon_loss: 5391679.6527; train_global_loss: 21879879.0992; train_optim_loss: 21879879.0992; val_kl_reg_loss: 90467.2797; val_edge_recon_loss: 2668253.5000; val_gene_expr_recon_loss: 13688370.4667; val_masked_gp_l1_reg_loss: 81908.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89898.3047; val_chrom_access_recon_loss: 5522111.1333; val_global_loss: 22141008.2667; val_optim_loss: 22141008.2667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9866; val_auprc_score: 0.9825; val_best_acc_score: 0.9524; val_best_f1_score: 0.9533; train_kl_reg_loss: 89103.6999; train_edge_recon_loss: 2673209.2061; train_gene_expr_recon_loss: 13569347.8855; train_masked_gp_l1_reg_loss: 81871.5462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89722.4753; train_chrom_access_recon_loss: 5396828.5611; train_global_loss: 21900083.2977; train_optim_loss: 21900083.2977; val_kl_reg_loss: 90927.8536; val_edge_recon_loss: 2677833.8000; val_gene_expr_recon_loss: 13725434.2667; val_masked_gp_l1_reg_loss: 81838.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89570.1953; val_chrom_access_recon_loss: 5545857.8667; val_global_loss: 22211462.0000; val_optim_loss: 22211462.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9866; val_auprc_score: 0.9805; val_best_acc_score: 0.9510; val_best_f1_score: 0.9516; train_kl_reg_loss: 89592.9956; train_edge_recon_loss: 2672138.3645; train_gene_expr_recon_loss: 13564073.8473; train_masked_gp_l1_reg_loss: 81814.6630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89356.8476; train_chrom_access_recon_loss: 5392323.9847; train_global_loss: 21889300.6870; train_optim_loss: 21889300.6870; val_kl_reg_loss: 90317.5922; val_edge_recon_loss: 2670813.9833; val_gene_expr_recon_loss: 13710200.2000; val_masked_gp_l1_reg_loss: 81769.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88977.3984; val_chrom_access_recon_loss: 5532250.9667; val_global_loss: 22174329.7333; val_optim_loss: 22174329.7333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9865; val_auprc_score: 0.9816; val_best_acc_score: 0.9492; val_best_f1_score: 0.9498; train_kl_reg_loss: 89470.1614; train_edge_recon_loss: 2674627.2653; train_gene_expr_recon_loss: 13560875.0992; train_masked_gp_l1_reg_loss: 81759.9996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88854.6036; train_chrom_access_recon_loss: 5391254.9847; train_global_loss: 21886842.0611; train_optim_loss: 21886842.0611; val_kl_reg_loss: 90427.4849; val_edge_recon_loss: 2683624.2000; val_gene_expr_recon_loss: 13747286.9333; val_masked_gp_l1_reg_loss: 81734.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88756.9922; val_chrom_access_recon_loss: 5526310.1333; val_global_loss: 22218139.4667; val_optim_loss: 22218139.4667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9860; val_auprc_score: 0.9828; val_best_acc_score: 0.9524; val_best_f1_score: 0.9531; train_kl_reg_loss: 90099.6088; train_edge_recon_loss: 2668926.6202; train_gene_expr_recon_loss: 13567818.7023; train_masked_gp_l1_reg_loss: 81728.3805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88569.2544; train_chrom_access_recon_loss: 5394354.1870; train_global_loss: 21891496.7481; train_optim_loss: 21891496.7481; val_kl_reg_loss: 90521.5333; val_edge_recon_loss: 2675993.8500; val_gene_expr_recon_loss: 13764630.4000; val_masked_gp_l1_reg_loss: 81714.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88452.4688; val_chrom_access_recon_loss: 5567074.2000; val_global_loss: 22268386.0000; val_optim_loss: 22268386.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9867; val_auprc_score: 0.9836; val_best_acc_score: 0.9512; val_best_f1_score: 0.9518; train_kl_reg_loss: 89347.5975; train_edge_recon_loss: 2670909.8130; train_gene_expr_recon_loss: 13563723.2214; train_masked_gp_l1_reg_loss: 81525.4999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84521.6201; train_chrom_access_recon_loss: 5387459.3168; train_global_loss: 21877487.0229; train_optim_loss: 21877487.0229; val_kl_reg_loss: 90388.1057; val_edge_recon_loss: 2681496.1000; val_gene_expr_recon_loss: 13757574.8000; val_masked_gp_l1_reg_loss: 81421.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84037.1719; val_chrom_access_recon_loss: 5567023.7667; val_global_loss: 22261941.4667; val_optim_loss: 22261941.4667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9866; val_auprc_score: 0.9837; val_best_acc_score: 0.9508; val_best_f1_score: 0.9515; train_kl_reg_loss: 89481.8238; train_edge_recon_loss: 2670820.6737; train_gene_expr_recon_loss: 13559687.9618; train_masked_gp_l1_reg_loss: 81385.3247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83954.4726; train_chrom_access_recon_loss: 5388656.9733; train_global_loss: 21873987.2214; train_optim_loss: 21873987.2214; val_kl_reg_loss: 90525.9542; val_edge_recon_loss: 2693804.5833; val_gene_expr_recon_loss: 13783195.0667; val_masked_gp_l1_reg_loss: 81356.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83888.2891; val_chrom_access_recon_loss: 5562865.4667; val_global_loss: 22295636.1333; val_optim_loss: 22295636.1333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9868; val_auprc_score: 0.9834; val_best_acc_score: 0.9464; val_best_f1_score: 0.9474; train_kl_reg_loss: 89612.6628; train_edge_recon_loss: 2674398.6374; train_gene_expr_recon_loss: 13550968.5038; train_masked_gp_l1_reg_loss: 81341.7679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83844.3414; train_chrom_access_recon_loss: 5381762.3702; train_global_loss: 21861928.3206; train_optim_loss: 21861928.3206; val_kl_reg_loss: 90810.0802; val_edge_recon_loss: 2674724.6833; val_gene_expr_recon_loss: 13740792.6667; val_masked_gp_l1_reg_loss: 81326.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83799.7969; val_chrom_access_recon_loss: 5562347.5667; val_global_loss: 22233800.6667; val_optim_loss: 22233800.6667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9857; val_auprc_score: 0.9831; val_best_acc_score: 0.9461; val_best_f1_score: 0.9472; train_kl_reg_loss: 89656.5474; train_edge_recon_loss: 2669621.8473; train_gene_expr_recon_loss: 13562906.8626; train_masked_gp_l1_reg_loss: 81317.7460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83752.4588; train_chrom_access_recon_loss: 5383678.2863; train_global_loss: 21870933.8779; train_optim_loss: 21870933.8779; val_kl_reg_loss: 90899.5354; val_edge_recon_loss: 2680048.1000; val_gene_expr_recon_loss: 13762432.9333; val_masked_gp_l1_reg_loss: 81307.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83739.7031; val_chrom_access_recon_loss: 5546538.7333; val_global_loss: 22244966.6667; val_optim_loss: 22244966.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 99 min 45 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9860
val AUPRC score: 0.9805
val best accuracy score: 0.9501
val best F1 score: 0.9508
val target rna MSE score: 0.8316
val source rna MSE score: 0.1847
val target atac MSE score: 0.5200
val source atac MSE score: 0.0766
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
