[True]
Run timestamp: 27072023_043156_159.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_159']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8806; val_auprc_score: 0.9755; val_best_acc_score: 0.8473; val_best_f1_score: 0.9174; train_kl_reg_loss: 558711.3189; train_edge_recon_loss: 10873795.8651; train_gene_expr_recon_loss: 180140648.3349; train_masked_gp_l1_reg_loss: 8281.4016; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191581436.7256; train_optim_loss: 191581436.7256; val_kl_reg_loss: 482472.1276; val_edge_recon_loss: 12412275.3750; val_gene_expr_recon_loss: 105030612.3333; val_masked_gp_l1_reg_loss: 8663.3613; val_group_lasso_reg_loss: 0.0000; val_global_loss: 117934023.3333; val_optim_loss: 117934023.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8658; val_auprc_score: 0.9725; val_best_acc_score: 0.8544; val_best_f1_score: 0.9211; train_kl_reg_loss: 569328.4640; train_edge_recon_loss: 10826892.8047; train_gene_expr_recon_loss: 102688853.1349; train_masked_gp_l1_reg_loss: 8841.6648; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114093915.9070; train_optim_loss: 114093915.9070; val_kl_reg_loss: 330994.9896; val_edge_recon_loss: 12119905.2500; val_gene_expr_recon_loss: 100497032.0000; val_masked_gp_l1_reg_loss: 9089.8877; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112957020.0000; val_optim_loss: 112957020.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8527; val_auprc_score: 0.9695; val_best_acc_score: 0.8631; val_best_f1_score: 0.9250; train_kl_reg_loss: 510903.1526; train_edge_recon_loss: 11022384.0605; train_gene_expr_recon_loss: 99381952.1860; train_masked_gp_l1_reg_loss: 9369.7278; train_group_lasso_reg_loss: 0.0000; train_global_loss: 110924609.2651; train_optim_loss: 110924609.2651; val_kl_reg_loss: 360264.1510; val_edge_recon_loss: 11982761.6667; val_gene_expr_recon_loss: 96756828.3333; val_masked_gp_l1_reg_loss: 9701.1992; val_group_lasso_reg_loss: 0.0000; val_global_loss: 109109558.3333; val_optim_loss: 109109558.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8536; val_auprc_score: 0.9687; val_best_acc_score: 0.8641; val_best_f1_score: 0.9249; train_kl_reg_loss: 467536.2037; train_edge_recon_loss: 10975682.9744; train_gene_expr_recon_loss: 96659075.9442; train_masked_gp_l1_reg_loss: 10076.9338; train_group_lasso_reg_loss: 0.0000; train_global_loss: 108112371.9442; train_optim_loss: 108112371.9442; val_kl_reg_loss: 316042.8633; val_edge_recon_loss: 12101426.7917; val_gene_expr_recon_loss: 94216113.0000; val_masked_gp_l1_reg_loss: 10472.5684; val_group_lasso_reg_loss: 0.0000; val_global_loss: 106644054.6667; val_optim_loss: 106644054.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8533; val_auprc_score: 0.9681; val_best_acc_score: 0.8614; val_best_f1_score: 0.9242; train_kl_reg_loss: 403674.8128; train_edge_recon_loss: 10814219.4093; train_gene_expr_recon_loss: 93413780.5767; train_masked_gp_l1_reg_loss: 10846.8884; train_group_lasso_reg_loss: 0.0000; train_global_loss: 104642521.6372; train_optim_loss: 104642521.6372; val_kl_reg_loss: 358986.7318; val_edge_recon_loss: 12079871.1250; val_gene_expr_recon_loss: 91416643.3333; val_masked_gp_l1_reg_loss: 11206.6846; val_group_lasso_reg_loss: 0.0000; val_global_loss: 103866708.6667; val_optim_loss: 103866708.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8578; val_auprc_score: 0.9715; val_best_acc_score: 0.8733; val_best_f1_score: 0.9301; train_kl_reg_loss: 390461.7318; train_edge_recon_loss: 10669058.6233; train_gene_expr_recon_loss: 90349721.6000; train_masked_gp_l1_reg_loss: 11486.3725; train_group_lasso_reg_loss: 0.0000; train_global_loss: 101420728.5953; train_optim_loss: 101420728.5953; val_kl_reg_loss: 350035.8021; val_edge_recon_loss: 11407843.8750; val_gene_expr_recon_loss: 89325807.6667; val_masked_gp_l1_reg_loss: 11773.9502; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101095463.6667; val_optim_loss: 101095463.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8590; val_auprc_score: 0.9698; val_best_acc_score: 0.8655; val_best_f1_score: 0.9254; train_kl_reg_loss: 375641.6972; train_edge_recon_loss: 10761689.6326; train_gene_expr_recon_loss: 88265596.6884; train_masked_gp_l1_reg_loss: 12040.5720; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99414968.2233; train_optim_loss: 99414968.2233; val_kl_reg_loss: 327532.1667; val_edge_recon_loss: 12103056.1250; val_gene_expr_recon_loss: 87248307.3333; val_masked_gp_l1_reg_loss: 12308.7451; val_group_lasso_reg_loss: 0.0000; val_global_loss: 99691207.3333; val_optim_loss: 99691207.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8606; val_auprc_score: 0.9719; val_best_acc_score: 0.8725; val_best_f1_score: 0.9297; train_kl_reg_loss: 355876.7238; train_edge_recon_loss: 10679642.2581; train_gene_expr_recon_loss: 86326736.2605; train_masked_gp_l1_reg_loss: 12554.5988; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97374809.8233; train_optim_loss: 97374809.8233; val_kl_reg_loss: 302363.1784; val_edge_recon_loss: 11521237.0417; val_gene_expr_recon_loss: 85459981.6667; val_masked_gp_l1_reg_loss: 12798.1875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97296381.3333; val_optim_loss: 97296381.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8562; val_auprc_score: 0.9691; val_best_acc_score: 0.8732; val_best_f1_score: 0.9297; train_kl_reg_loss: 329768.2024; train_edge_recon_loss: 10586241.2000; train_gene_expr_recon_loss: 84550540.2419; train_masked_gp_l1_reg_loss: 13043.7963; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95479593.5628; train_optim_loss: 95479593.5628; val_kl_reg_loss: 268994.2064; val_edge_recon_loss: 11576115.5000; val_gene_expr_recon_loss: 83711444.0000; val_masked_gp_l1_reg_loss: 13251.4590; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95569801.6667; val_optim_loss: 95569801.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8515; val_auprc_score: 0.9688; val_best_acc_score: 0.8759; val_best_f1_score: 0.9313; train_kl_reg_loss: 294681.9927; train_edge_recon_loss: 10447086.7884; train_gene_expr_recon_loss: 83122860.7256; train_masked_gp_l1_reg_loss: 13442.7107; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93878072.3349; train_optim_loss: 93878072.3349; val_kl_reg_loss: 237941.2402; val_edge_recon_loss: 10929715.8750; val_gene_expr_recon_loss: 82407819.3333; val_masked_gp_l1_reg_loss: 13630.3809; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93589109.6667; val_optim_loss: 93589109.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8615; val_auprc_score: 0.9707; val_best_acc_score: 0.8767; val_best_f1_score: 0.9316; train_kl_reg_loss: 256881.8424; train_edge_recon_loss: 10115115.5326; train_gene_expr_recon_loss: 82127640.8930; train_masked_gp_l1_reg_loss: 13849.3792; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92513487.5535; train_optim_loss: 92513487.5535; val_kl_reg_loss: 216492.5208; val_edge_recon_loss: 10993762.3750; val_gene_expr_recon_loss: 82051764.0000; val_masked_gp_l1_reg_loss: 14129.6699; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93276146.6667; val_optim_loss: 93276146.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8498; val_auprc_score: 0.9670; val_best_acc_score: 0.8770; val_best_f1_score: 0.9318; train_kl_reg_loss: 238631.3824; train_edge_recon_loss: 9960678.5930; train_gene_expr_recon_loss: 80998192.2605; train_masked_gp_l1_reg_loss: 14398.9306; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91211901.3953; train_optim_loss: 91211901.3953; val_kl_reg_loss: 230712.8984; val_edge_recon_loss: 10383069.5833; val_gene_expr_recon_loss: 80293263.0000; val_masked_gp_l1_reg_loss: 14600.5801; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90921645.6667; val_optim_loss: 90921645.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8441; val_auprc_score: 0.9661; val_best_acc_score: 0.8816; val_best_f1_score: 0.9345; train_kl_reg_loss: 253590.2170; train_edge_recon_loss: 9693840.5744; train_gene_expr_recon_loss: 79859778.4558; train_masked_gp_l1_reg_loss: 14803.0938; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89822012.3907; train_optim_loss: 89822012.3907; val_kl_reg_loss: 261607.1725; val_edge_recon_loss: 9696571.3750; val_gene_expr_recon_loss: 79333184.3333; val_masked_gp_l1_reg_loss: 15008.9512; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89306370.6667; val_optim_loss: 89306370.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8645; val_auprc_score: 0.9702; val_best_acc_score: 0.8826; val_best_f1_score: 0.9344; train_kl_reg_loss: 290073.2126; train_edge_recon_loss: 9442690.1186; train_gene_expr_recon_loss: 78925872.3721; train_masked_gp_l1_reg_loss: 15211.8995; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88673847.7395; train_optim_loss: 88673847.7395; val_kl_reg_loss: 296540.1680; val_edge_recon_loss: 9629277.3333; val_gene_expr_recon_loss: 78474220.3333; val_masked_gp_l1_reg_loss: 15409.9609; val_group_lasso_reg_loss: 0.0000; val_global_loss: 88415446.0000; val_optim_loss: 88415446.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8684; val_auprc_score: 0.9706; val_best_acc_score: 0.8870; val_best_f1_score: 0.9366; train_kl_reg_loss: 324306.4440; train_edge_recon_loss: 9204990.5767; train_gene_expr_recon_loss: 78094502.1767; train_masked_gp_l1_reg_loss: 15609.5181; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87639408.7442; train_optim_loss: 87639408.7442; val_kl_reg_loss: 325309.2656; val_edge_recon_loss: 9252252.3958; val_gene_expr_recon_loss: 77638804.3333; val_masked_gp_l1_reg_loss: 15810.1514; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87232174.0000; val_optim_loss: 87232174.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8721; val_auprc_score: 0.9723; val_best_acc_score: 0.8871; val_best_f1_score: 0.9368; train_kl_reg_loss: 340403.3350; train_edge_recon_loss: 9027272.5465; train_gene_expr_recon_loss: 77348438.1395; train_masked_gp_l1_reg_loss: 15997.0185; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86732110.9953; train_optim_loss: 86732110.9953; val_kl_reg_loss: 330446.0299; val_edge_recon_loss: 9119805.2083; val_gene_expr_recon_loss: 76979054.3333; val_masked_gp_l1_reg_loss: 16191.1602; val_group_lasso_reg_loss: 0.0000; val_global_loss: 86445497.3333; val_optim_loss: 86445497.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8896; val_auprc_score: 0.9749; val_best_acc_score: 0.8982; val_best_f1_score: 0.9425; train_kl_reg_loss: 339892.7205; train_edge_recon_loss: 8830568.6093; train_gene_expr_recon_loss: 76646733.0977; train_masked_gp_l1_reg_loss: 16384.1908; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85833578.3814; train_optim_loss: 85833578.3814; val_kl_reg_loss: 320593.9961; val_edge_recon_loss: 8900687.1250; val_gene_expr_recon_loss: 76335420.3333; val_masked_gp_l1_reg_loss: 16577.4492; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85573277.3333; val_optim_loss: 85573277.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8887; val_auprc_score: 0.9756; val_best_acc_score: 0.8999; val_best_f1_score: 0.9435; train_kl_reg_loss: 327464.9445; train_edge_recon_loss: 8782687.1326; train_gene_expr_recon_loss: 76036229.0233; train_masked_gp_l1_reg_loss: 16761.5559; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85163142.4372; train_optim_loss: 85163142.4372; val_kl_reg_loss: 308209.7865; val_edge_recon_loss: 8663134.4792; val_gene_expr_recon_loss: 75718174.3333; val_masked_gp_l1_reg_loss: 16938.6582; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84706453.6667; val_optim_loss: 84706453.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9078; val_auprc_score: 0.9800; val_best_acc_score: 0.9074; val_best_f1_score: 0.9470; train_kl_reg_loss: 316876.2773; train_edge_recon_loss: 8634433.5302; train_gene_expr_recon_loss: 75468086.6977; train_masked_gp_l1_reg_loss: 17120.0326; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84436516.5395; train_optim_loss: 84436516.5395; val_kl_reg_loss: 295660.0521; val_edge_recon_loss: 8619401.7708; val_gene_expr_recon_loss: 75243845.6667; val_masked_gp_l1_reg_loss: 17297.2617; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84176204.3333; val_optim_loss: 84176204.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9120; val_auprc_score: 0.9802; val_best_acc_score: 0.9084; val_best_f1_score: 0.9469; train_kl_reg_loss: 303580.5227; train_edge_recon_loss: 8531868.8233; train_gene_expr_recon_loss: 74912310.8837; train_masked_gp_l1_reg_loss: 17466.8812; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83765227.0884; train_optim_loss: 83765227.0884; val_kl_reg_loss: 286471.5872; val_edge_recon_loss: 8733461.3958; val_gene_expr_recon_loss: 74792608.6667; val_masked_gp_l1_reg_loss: 17637.5762; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83830181.6667; val_optim_loss: 83830181.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9162; val_auprc_score: 0.9820; val_best_acc_score: 0.9104; val_best_f1_score: 0.9483; train_kl_reg_loss: 292530.3590; train_edge_recon_loss: 8402007.1744; train_gene_expr_recon_loss: 74396201.7860; train_masked_gp_l1_reg_loss: 17803.8276; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83108543.1442; train_optim_loss: 83108543.1442; val_kl_reg_loss: 272529.3620; val_edge_recon_loss: 8563785.8958; val_gene_expr_recon_loss: 74173928.0000; val_masked_gp_l1_reg_loss: 17976.5234; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83028220.6667; val_optim_loss: 83028220.6667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9149; val_auprc_score: 0.9794; val_best_acc_score: 0.9120; val_best_f1_score: 0.9491; train_kl_reg_loss: 277401.0799; train_edge_recon_loss: 8362742.7651; train_gene_expr_recon_loss: 73933004.9860; train_masked_gp_l1_reg_loss: 18137.6512; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82591286.6605; train_optim_loss: 82591286.6605; val_kl_reg_loss: 259777.0241; val_edge_recon_loss: 8682901.6042; val_gene_expr_recon_loss: 73718359.0000; val_masked_gp_l1_reg_loss: 18303.5898; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82679342.6667; val_optim_loss: 82679342.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9159; val_auprc_score: 0.9816; val_best_acc_score: 0.9144; val_best_f1_score: 0.9505; train_kl_reg_loss: 261605.9860; train_edge_recon_loss: 8272388.1698; train_gene_expr_recon_loss: 73497287.6651; train_masked_gp_l1_reg_loss: 18472.2944; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82049754.0093; train_optim_loss: 82049754.0093; val_kl_reg_loss: 244707.5072; val_edge_recon_loss: 8549649.0833; val_gene_expr_recon_loss: 73339336.3333; val_masked_gp_l1_reg_loss: 18643.8223; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82152333.0000; val_optim_loss: 82152333.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9234; val_auprc_score: 0.9832; val_best_acc_score: 0.9210; val_best_f1_score: 0.9545; train_kl_reg_loss: 245998.5187; train_edge_recon_loss: 8184477.7860; train_gene_expr_recon_loss: 73072961.1535; train_masked_gp_l1_reg_loss: 18810.6532; train_group_lasso_reg_loss: 0.0000; train_global_loss: 81522247.8884; train_optim_loss: 81522247.8884; val_kl_reg_loss: 230822.3047; val_edge_recon_loss: 8121456.9167; val_gene_expr_recon_loss: 72937175.0000; val_masked_gp_l1_reg_loss: 18970.3164; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81308422.0000; val_optim_loss: 81308422.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9253; val_auprc_score: 0.9837; val_best_acc_score: 0.9206; val_best_f1_score: 0.9546; train_kl_reg_loss: 231637.7622; train_edge_recon_loss: 8281607.1395; train_gene_expr_recon_loss: 72705893.3953; train_masked_gp_l1_reg_loss: 19135.0779; train_group_lasso_reg_loss: 0.0000; train_global_loss: 81238273.3395; train_optim_loss: 81238273.3395; val_kl_reg_loss: 215418.1823; val_edge_recon_loss: 8178964.3125; val_gene_expr_recon_loss: 72606299.0000; val_masked_gp_l1_reg_loss: 19303.6836; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81019985.3333; val_optim_loss: 81019985.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8880; val_auprc_score: 0.9730; val_best_acc_score: 0.8972; val_best_f1_score: 0.9417; train_kl_reg_loss: 53230.2932; train_edge_recon_loss: 10437100.3349; train_gene_expr_recon_loss: 86531017.3767; train_masked_gp_l1_reg_loss: 21844.0175; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97043192.1488; train_optim_loss: 97043192.1488; val_kl_reg_loss: 14792.7868; val_edge_recon_loss: 10051970.3333; val_gene_expr_recon_loss: 79789915.3333; val_masked_gp_l1_reg_loss: 23184.8535; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89879862.0000; val_optim_loss: 89879862.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8897; val_auprc_score: 0.9744; val_best_acc_score: 0.8981; val_best_f1_score: 0.9422; train_kl_reg_loss: 49686.1241; train_edge_recon_loss: 9691323.1721; train_gene_expr_recon_loss: 78685476.9116; train_masked_gp_l1_reg_loss: 23286.9447; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88449772.8744; train_optim_loss: 88449772.8744; val_kl_reg_loss: 17052.9338; val_edge_recon_loss: 9736817.2292; val_gene_expr_recon_loss: 77895383.0000; val_masked_gp_l1_reg_loss: 23429.8984; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87672685.0000; val_optim_loss: 87672685.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8866; val_auprc_score: 0.9738; val_best_acc_score: 0.9004; val_best_f1_score: 0.9437; train_kl_reg_loss: 53234.4532; train_edge_recon_loss: 9339702.1419; train_gene_expr_recon_loss: 77330725.9535; train_masked_gp_l1_reg_loss: 23559.8127; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86747222.4000; train_optim_loss: 86747222.4000; val_kl_reg_loss: 20046.6636; val_edge_recon_loss: 8898270.1042; val_gene_expr_recon_loss: 76573832.6667; val_masked_gp_l1_reg_loss: 23708.7422; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85515861.6667; val_optim_loss: 85515861.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8917; val_auprc_score: 0.9744; val_best_acc_score: 0.8998; val_best_f1_score: 0.9432; train_kl_reg_loss: 59618.7534; train_edge_recon_loss: 9104243.1349; train_gene_expr_recon_loss: 76141096.7442; train_masked_gp_l1_reg_loss: 23815.0475; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85328773.5814; train_optim_loss: 85328773.5814; val_kl_reg_loss: 22468.3967; val_edge_recon_loss: 9007885.5833; val_gene_expr_recon_loss: 75780466.6667; val_masked_gp_l1_reg_loss: 23917.8809; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84834741.3333; val_optim_loss: 84834741.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8870; val_auprc_score: 0.9740; val_best_acc_score: 0.8978; val_best_f1_score: 0.9421; train_kl_reg_loss: 63750.4802; train_edge_recon_loss: 8727709.2163; train_gene_expr_recon_loss: 75704299.6465; train_masked_gp_l1_reg_loss: 23925.5654; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84519684.7628; train_optim_loss: 84519684.7628; val_kl_reg_loss: 22843.7092; val_edge_recon_loss: 9031593.9792; val_gene_expr_recon_loss: 75552264.0000; val_masked_gp_l1_reg_loss: 23935.8242; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84630637.6667; val_optim_loss: 84630637.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8913; val_auprc_score: 0.9761; val_best_acc_score: 0.9005; val_best_f1_score: 0.9441; train_kl_reg_loss: 64675.5009; train_edge_recon_loss: 8799869.0233; train_gene_expr_recon_loss: 75617027.6465; train_masked_gp_l1_reg_loss: 23947.5616; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84505520.0744; train_optim_loss: 84505520.0744; val_kl_reg_loss: 23238.6113; val_edge_recon_loss: 8619904.4792; val_gene_expr_recon_loss: 75637388.0000; val_masked_gp_l1_reg_loss: 23959.8418; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84304491.0000; val_optim_loss: 84304491.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8874; val_auprc_score: 0.9727; val_best_acc_score: 0.8981; val_best_f1_score: 0.9421; train_kl_reg_loss: 65309.0907; train_edge_recon_loss: 8838858.7884; train_gene_expr_recon_loss: 75571449.7860; train_masked_gp_l1_reg_loss: 23972.0213; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84499589.6558; train_optim_loss: 84499589.6558; val_kl_reg_loss: 23451.9797; val_edge_recon_loss: 9119913.9375; val_gene_expr_recon_loss: 75623523.6667; val_masked_gp_l1_reg_loss: 23985.4258; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84790873.6667; val_optim_loss: 84790873.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8946; val_auprc_score: 0.9752; val_best_acc_score: 0.9016; val_best_f1_score: 0.9440; train_kl_reg_loss: 66144.6129; train_edge_recon_loss: 8809489.3488; train_gene_expr_recon_loss: 75468143.4047; train_masked_gp_l1_reg_loss: 23999.9699; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84367776.9302; train_optim_loss: 84367776.9302; val_kl_reg_loss: 22353.8816; val_edge_recon_loss: 9052831.5833; val_gene_expr_recon_loss: 75540841.6667; val_masked_gp_l1_reg_loss: 24015.5547; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84640043.6667; val_optim_loss: 84640043.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 42 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9324
Val AUPRC score: 0.9861
Val best accuracy score: 0.9189
Val best F1 score: 0.9532
Val gene expr MSE score: 22755.9662
Val cat covariate0 mean sim diff: -0.0037

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
