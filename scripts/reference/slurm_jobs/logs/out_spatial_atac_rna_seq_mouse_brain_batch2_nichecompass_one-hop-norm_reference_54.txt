[True]
Run timestamp: 24072023_165504_54.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_54']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8696; val_auprc_score: 0.8810; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 15835.5699; train_edge_recon_loss: 3495964.8056; train_gene_expr_recon_loss: 31167352.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108130040.0000; train_global_loss: 142809192.8889; train_optim_loss: 142809192.8889; val_kl_reg_loss: 35484.8125; val_edge_recon_loss: 4065629.5000; val_gene_expr_recon_loss: 28459780.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106067200.0000; val_global_loss: 138628096.0000; val_optim_loss: 138628096.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8595; val_auprc_score: 0.8672; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 80988.8915; train_edge_recon_loss: 3622910.3333; train_gene_expr_recon_loss: 27707838.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 105881107.5556; train_global_loss: 137292841.7778; train_optim_loss: 137292841.7778; val_kl_reg_loss: 97921.7031; val_edge_recon_loss: 4065910.0000; val_gene_expr_recon_loss: 25505950.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103142064.0000; val_global_loss: 132811848.0000; val_optim_loss: 132811848.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8501; val_auprc_score: 0.8540; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 155031.5634; train_edge_recon_loss: 3691543.7222; train_gene_expr_recon_loss: 25082765.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102562295.1111; train_global_loss: 131491635.5556; train_optim_loss: 131491635.5556; val_kl_reg_loss: 219604.1562; val_edge_recon_loss: 4065953.2500; val_gene_expr_recon_loss: 23601510.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101179544.0000; val_global_loss: 129066608.0000; val_optim_loss: 129066608.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8565; val_auprc_score: 0.8595; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 191755.0417; train_edge_recon_loss: 3726611.3611; train_gene_expr_recon_loss: 23775998.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100687667.5556; train_global_loss: 128382033.7778; train_optim_loss: 128382033.7778; val_kl_reg_loss: 230827.2812; val_edge_recon_loss: 4066017.5000; val_gene_expr_recon_loss: 22747500.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99833944.0000; val_global_loss: 126878288.0000; val_optim_loss: 126878288.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8649; val_auprc_score: 0.8629; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 222388.2014; train_edge_recon_loss: 3740488.4722; train_gene_expr_recon_loss: 22957408.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99195928.8889; train_global_loss: 126116215.1111; train_optim_loss: 126116215.1111; val_kl_reg_loss: 258245.3125; val_edge_recon_loss: 4065874.2500; val_gene_expr_recon_loss: 22080878.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99019088.0000; val_global_loss: 125424088.0000; val_optim_loss: 125424088.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8714; val_auprc_score: 0.8704; val_best_acc_score: 0.5023; val_best_f1_score: 0.6677; train_kl_reg_loss: 262016.5868; train_edge_recon_loss: 3721576.0000; train_gene_expr_recon_loss: 22353572.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98699466.6667; train_global_loss: 125036632.8889; train_optim_loss: 125036632.8889; val_kl_reg_loss: 226625.1562; val_edge_recon_loss: 4065622.0000; val_gene_expr_recon_loss: 21580206.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98264832.0000; val_global_loss: 124137280.0000; val_optim_loss: 124137280.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8641; val_auprc_score: 0.8604; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 271698.5399; train_edge_recon_loss: 3719956.6944; train_gene_expr_recon_loss: 21925084.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98441900.4444; train_global_loss: 124358640.0000; train_optim_loss: 124358640.0000; val_kl_reg_loss: 226480.7188; val_edge_recon_loss: 4065368.5000; val_gene_expr_recon_loss: 21282998.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98089432.0000; val_global_loss: 123664280.0000; val_optim_loss: 123664280.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8588; val_auprc_score: 0.8528; val_best_acc_score: 0.5119; val_best_f1_score: 0.6720; train_kl_reg_loss: 270801.1562; train_edge_recon_loss: 3728768.1944; train_gene_expr_recon_loss: 21687151.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98202512.0000; train_global_loss: 123889232.0000; train_optim_loss: 123889232.0000; val_kl_reg_loss: 243881.7969; val_edge_recon_loss: 4064848.0000; val_gene_expr_recon_loss: 21082518.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97714944.0000; val_global_loss: 123106192.0000; val_optim_loss: 123106192.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8543; val_auprc_score: 0.8482; val_best_acc_score: 0.5213; val_best_f1_score: 0.6763; train_kl_reg_loss: 273485.7031; train_edge_recon_loss: 3704900.6111; train_gene_expr_recon_loss: 21528490.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98247416.0000; train_global_loss: 123754292.4444; train_optim_loss: 123754292.4444; val_kl_reg_loss: 215858.7344; val_edge_recon_loss: 4064304.5000; val_gene_expr_recon_loss: 20961114.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97562488.0000; val_global_loss: 122803760.0000; val_optim_loss: 122803760.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8532; val_auprc_score: 0.8534; val_best_acc_score: 0.5358; val_best_f1_score: 0.6825; train_kl_reg_loss: 280152.6597; train_edge_recon_loss: 3693745.1389; train_gene_expr_recon_loss: 21550404.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98046100.4444; train_global_loss: 123570403.5556; train_optim_loss: 123570403.5556; val_kl_reg_loss: 204140.0000; val_edge_recon_loss: 4063116.2500; val_gene_expr_recon_loss: 20844458.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97244544.0000; val_global_loss: 122356256.0000; val_optim_loss: 122356256.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8475; val_auprc_score: 0.8475; val_best_acc_score: 0.5536; val_best_f1_score: 0.6901; train_kl_reg_loss: 264429.4149; train_edge_recon_loss: 3695077.1111; train_gene_expr_recon_loss: 21226754.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97256450.6667; train_global_loss: 122442709.3333; train_optim_loss: 122442709.3333; val_kl_reg_loss: 237130.5312; val_edge_recon_loss: 4061924.7500; val_gene_expr_recon_loss: 20771576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97106536.0000; val_global_loss: 122177168.0000; val_optim_loss: 122177168.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8481; val_auprc_score: 0.8490; val_best_acc_score: 0.5713; val_best_f1_score: 0.6970; train_kl_reg_loss: 273536.3438; train_edge_recon_loss: 3663990.3056; train_gene_expr_recon_loss: 21165325.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96883076.4444; train_global_loss: 121985929.7778; train_optim_loss: 121985929.7778; val_kl_reg_loss: 238422.3438; val_edge_recon_loss: 4060523.0000; val_gene_expr_recon_loss: 20714834.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97100408.0000; val_global_loss: 122114192.0000; val_optim_loss: 122114192.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8500; val_auprc_score: 0.8507; val_best_acc_score: 0.6074; val_best_f1_score: 0.7140; train_kl_reg_loss: 272467.4392; train_edge_recon_loss: 3663897.7778; train_gene_expr_recon_loss: 21089507.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97219903.1111; train_global_loss: 122245776.0000; train_optim_loss: 122245776.0000; val_kl_reg_loss: 214015.5312; val_edge_recon_loss: 4058132.2500; val_gene_expr_recon_loss: 20671412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96992040.0000; val_global_loss: 121935600.0000; val_optim_loss: 121935600.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8525; val_auprc_score: 0.8437; val_best_acc_score: 0.6368; val_best_f1_score: 0.7279; train_kl_reg_loss: 262857.0885; train_edge_recon_loss: 3660618.9444; train_gene_expr_recon_loss: 21162108.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97559445.3333; train_global_loss: 122645028.4444; train_optim_loss: 122645028.4444; val_kl_reg_loss: 227069.3125; val_edge_recon_loss: 4056048.5000; val_gene_expr_recon_loss: 20622362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96853144.0000; val_global_loss: 121758624.0000; val_optim_loss: 121758624.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8646; val_auprc_score: 0.8536; val_best_acc_score: 0.6788; val_best_f1_score: 0.7493; train_kl_reg_loss: 267779.7604; train_edge_recon_loss: 3646728.5556; train_gene_expr_recon_loss: 21159647.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96998717.3333; train_global_loss: 122072872.8889; train_optim_loss: 122072872.8889; val_kl_reg_loss: 210409.0000; val_edge_recon_loss: 4053140.2500; val_gene_expr_recon_loss: 20572534.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96712224.0000; val_global_loss: 121548304.0000; val_optim_loss: 121548304.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8714; val_auprc_score: 0.8665; val_best_acc_score: 0.7191; val_best_f1_score: 0.7711; train_kl_reg_loss: 258820.1875; train_edge_recon_loss: 3649787.2500; train_gene_expr_recon_loss: 20987888.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97126248.0000; train_global_loss: 122022744.8889; train_optim_loss: 122022744.8889; val_kl_reg_loss: 203030.5312; val_edge_recon_loss: 4049096.0000; val_gene_expr_recon_loss: 20509026.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96522384.0000; val_global_loss: 121283536.0000; val_optim_loss: 121283536.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8783; val_auprc_score: 0.8697; val_best_acc_score: 0.7583; val_best_f1_score: 0.7925; train_kl_reg_loss: 254684.1910; train_edge_recon_loss: 3640601.0556; train_gene_expr_recon_loss: 21012049.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96844128.8889; train_global_loss: 121751463.1111; train_optim_loss: 121751463.1111; val_kl_reg_loss: 230044.3125; val_edge_recon_loss: 4044239.5000; val_gene_expr_recon_loss: 20491896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96618128.0000; val_global_loss: 121384304.0000; val_optim_loss: 121384304.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8805; val_auprc_score: 0.8721; val_best_acc_score: 0.7860; val_best_f1_score: 0.8070; train_kl_reg_loss: 258756.7292; train_edge_recon_loss: 3625446.9167; train_gene_expr_recon_loss: 20983840.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96515939.5556; train_global_loss: 121383984.0000; train_optim_loss: 121383984.0000; val_kl_reg_loss: 207057.0312; val_edge_recon_loss: 4036576.7500; val_gene_expr_recon_loss: 20454914.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96368432.0000; val_global_loss: 121066976.0000; val_optim_loss: 121066976.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8787; val_auprc_score: 0.8678; val_best_acc_score: 0.7990; val_best_f1_score: 0.8094; train_kl_reg_loss: 248969.7326; train_edge_recon_loss: 3633193.2222; train_gene_expr_recon_loss: 21049302.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96226183.1111; train_global_loss: 121157648.8889; train_optim_loss: 121157648.8889; val_kl_reg_loss: 214995.8125; val_edge_recon_loss: 4028530.7500; val_gene_expr_recon_loss: 20396706.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96130080.0000; val_global_loss: 120770312.0000; val_optim_loss: 120770312.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8817; val_auprc_score: 0.8668; val_best_acc_score: 0.8063; val_best_f1_score: 0.8062; train_kl_reg_loss: 248518.9878; train_edge_recon_loss: 3619520.6111; train_gene_expr_recon_loss: 20946830.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96529360.8889; train_global_loss: 121344231.1111; train_optim_loss: 121344231.1111; val_kl_reg_loss: 202500.7812; val_edge_recon_loss: 4016856.7500; val_gene_expr_recon_loss: 20390930.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96232872.0000; val_global_loss: 120843160.0000; val_optim_loss: 120843160.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8837; val_auprc_score: 0.8708; val_best_acc_score: 0.8041; val_best_f1_score: 0.7949; train_kl_reg_loss: 245120.3594; train_edge_recon_loss: 3616012.3333; train_gene_expr_recon_loss: 20819729.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96373958.2222; train_global_loss: 121054820.4444; train_optim_loss: 121054820.4444; val_kl_reg_loss: 192719.2344; val_edge_recon_loss: 4003023.7500; val_gene_expr_recon_loss: 20379916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96256120.0000; val_global_loss: 120831776.0000; val_optim_loss: 120831776.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8879; val_auprc_score: 0.8743; val_best_acc_score: 0.7897; val_best_f1_score: 0.7803; train_kl_reg_loss: 235755.5851; train_edge_recon_loss: 3615697.8333; train_gene_expr_recon_loss: 20887619.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96590085.3333; train_global_loss: 121329158.2222; train_optim_loss: 121329158.2222; val_kl_reg_loss: 190464.9688; val_edge_recon_loss: 3983595.2500; val_gene_expr_recon_loss: 20325038.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95928984.0000; val_global_loss: 120428080.0000; val_optim_loss: 120428080.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8899; val_auprc_score: 0.8762; val_best_acc_score: 0.7739; val_best_f1_score: 0.8026; train_kl_reg_loss: 236642.7517; train_edge_recon_loss: 3601086.7500; train_gene_expr_recon_loss: 20784139.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96424289.7778; train_global_loss: 121046159.1111; train_optim_loss: 121046159.1111; val_kl_reg_loss: 209516.7500; val_edge_recon_loss: 3966016.0000; val_gene_expr_recon_loss: 20305818.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95959752.0000; val_global_loss: 120441104.0000; val_optim_loss: 120441104.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8932; val_auprc_score: 0.8735; val_best_acc_score: 0.7998; val_best_f1_score: 0.8231; train_kl_reg_loss: 232753.3524; train_edge_recon_loss: 3589717.4444; train_gene_expr_recon_loss: 20522685.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95382954.6667; train_global_loss: 119728111.1111; train_optim_loss: 119728111.1111; val_kl_reg_loss: 197388.6250; val_edge_recon_loss: 3936657.2500; val_gene_expr_recon_loss: 20283088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95831064.0000; val_global_loss: 120248200.0000; val_optim_loss: 120248200.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8912; val_auprc_score: 0.8747; val_best_acc_score: 0.8083; val_best_f1_score: 0.8251; train_kl_reg_loss: 225444.1632; train_edge_recon_loss: 3581231.8889; train_gene_expr_recon_loss: 20691995.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95601040.0000; train_global_loss: 120099711.1111; train_optim_loss: 120099711.1111; val_kl_reg_loss: 195642.6250; val_edge_recon_loss: 3903335.2500; val_gene_expr_recon_loss: 20243762.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95547072.0000; val_global_loss: 119889808.0000; val_optim_loss: 119889808.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9015; val_auprc_score: 0.8737; val_best_acc_score: 0.8350; val_best_f1_score: 0.8382; train_kl_reg_loss: 167297.7413; train_edge_recon_loss: 3883093.3611; train_gene_expr_recon_loss: 21322716.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96375776.0000; train_global_loss: 121748882.6667; train_optim_loss: 121748882.6667; val_kl_reg_loss: 87080.4844; val_edge_recon_loss: 4021476.7500; val_gene_expr_recon_loss: 20843052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96262704.0000; val_global_loss: 121214312.0000; val_optim_loss: 121214312.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8710; val_auprc_score: 0.8557; val_best_acc_score: 0.7572; val_best_f1_score: 0.7926; train_kl_reg_loss: 108814.4323; train_edge_recon_loss: 3981525.7778; train_gene_expr_recon_loss: 21722451.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96356669.3333; train_global_loss: 122169462.2222; train_optim_loss: 122169462.2222; val_kl_reg_loss: 81166.5938; val_edge_recon_loss: 4045194.0000; val_gene_expr_recon_loss: 20980936.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96331280.0000; val_global_loss: 121438576.0000; val_optim_loss: 121438576.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8714; val_auprc_score: 0.8543; val_best_acc_score: 0.7541; val_best_f1_score: 0.7921; train_kl_reg_loss: 82493.1597; train_edge_recon_loss: 3992024.6389; train_gene_expr_recon_loss: 21827330.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96184591.1111; train_global_loss: 122086440.0000; train_optim_loss: 122086440.0000; val_kl_reg_loss: 77848.5703; val_edge_recon_loss: 4046678.5000; val_gene_expr_recon_loss: 20844054.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96083752.0000; val_global_loss: 121052336.0000; val_optim_loss: 121052336.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8827; val_auprc_score: 0.8640; val_best_acc_score: 0.8002; val_best_f1_score: 0.8186; train_kl_reg_loss: 82969.2465; train_edge_recon_loss: 3971984.5278; train_gene_expr_recon_loss: 21364647.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97204520.0000; train_global_loss: 122624121.7778; train_optim_loss: 122624121.7778; val_kl_reg_loss: 63722.5234; val_edge_recon_loss: 4040277.2500; val_gene_expr_recon_loss: 20810798.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95983960.0000; val_global_loss: 120898760.0000; val_optim_loss: 120898760.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8782; val_auprc_score: 0.8598; val_best_acc_score: 0.7935; val_best_f1_score: 0.8137; train_kl_reg_loss: 70791.9557; train_edge_recon_loss: 3986879.0833; train_gene_expr_recon_loss: 21296120.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96001860.4444; train_global_loss: 121355650.6667; train_optim_loss: 121355650.6667; val_kl_reg_loss: 66392.9297; val_edge_recon_loss: 4040620.7500; val_gene_expr_recon_loss: 20784362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96074528.0000; val_global_loss: 120965904.0000; val_optim_loss: 120965904.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8838; val_auprc_score: 0.8642; val_best_acc_score: 0.7999; val_best_f1_score: 0.8202; train_kl_reg_loss: 80371.1753; train_edge_recon_loss: 3968772.9444; train_gene_expr_recon_loss: 21293109.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96277912.0000; train_global_loss: 121620165.3333; train_optim_loss: 121620165.3333; val_kl_reg_loss: 80246.8281; val_edge_recon_loss: 4041115.2500; val_gene_expr_recon_loss: 20729278.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95871528.0000; val_global_loss: 120722168.0000; val_optim_loss: 120722168.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8899; val_auprc_score: 0.8748; val_best_acc_score: 0.8071; val_best_f1_score: 0.8245; train_kl_reg_loss: 91016.4696; train_edge_recon_loss: 3932199.3889; train_gene_expr_recon_loss: 21163888.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95476527.1111; train_global_loss: 120663631.1111; train_optim_loss: 120663631.1111; val_kl_reg_loss: 80190.3438; val_edge_recon_loss: 4039925.0000; val_gene_expr_recon_loss: 20728844.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95898432.0000; val_global_loss: 120747392.0000; val_optim_loss: 120747392.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8886; val_auprc_score: 0.8719; val_best_acc_score: 0.8118; val_best_f1_score: 0.8264; train_kl_reg_loss: 85652.1042; train_edge_recon_loss: 3943472.4444; train_gene_expr_recon_loss: 21145518.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95978774.2222; train_global_loss: 121153416.0000; train_optim_loss: 121153416.0000; val_kl_reg_loss: 76188.9297; val_edge_recon_loss: 4038335.7500; val_gene_expr_recon_loss: 20717744.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95872632.0000; val_global_loss: 120704896.0000; val_optim_loss: 120704896.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 56 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9163
Val AUPRC score: 0.9031
Val best accuracy score: 0.8203
Val best F1 score: 0.8059
Val gene expr MSE score: 0.4088
Val chrom access MSE score: 0.0864
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
