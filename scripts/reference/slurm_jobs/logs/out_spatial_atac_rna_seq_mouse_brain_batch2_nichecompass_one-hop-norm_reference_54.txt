[True]
Run timestamp: 07082023_185421_54.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_54']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8845; val_auprc_score: 0.9037; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7805.2376; train_edge_recon_loss: 36061.5807; train_gene_expr_recon_loss: 1212879.5069; train_masked_gp_l1_reg_loss: 15696.7754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166978.5052; train_chrom_access_recon_loss: 793655.7951; train_global_loss: 2233077.4028; train_optim_loss: 2233077.4028; val_kl_reg_loss: 7292.0010; val_edge_recon_loss: 40660.3438; val_gene_expr_recon_loss: 1005936.8125; val_masked_gp_l1_reg_loss: 10592.6660; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162523.9688; val_chrom_access_recon_loss: 525310.6250; val_global_loss: 1752316.3750; val_optim_loss: 1752316.3750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9086; val_auprc_score: 0.9235; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8569.9867; train_edge_recon_loss: 37041.4358; train_gene_expr_recon_loss: 925454.0972; train_masked_gp_l1_reg_loss: 9089.1286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159817.4253; train_chrom_access_recon_loss: 489829.6944; train_global_loss: 1629801.7917; train_optim_loss: 1629801.7917; val_kl_reg_loss: 12402.5254; val_edge_recon_loss: 40661.3398; val_gene_expr_recon_loss: 833822.8750; val_masked_gp_l1_reg_loss: 8366.9004; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156461.9375; val_chrom_access_recon_loss: 477512.1562; val_global_loss: 1529227.6250; val_optim_loss: 1529227.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9022; val_auprc_score: 0.9183; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16448.9778; train_edge_recon_loss: 38295.7426; train_gene_expr_recon_loss: 803554.7986; train_masked_gp_l1_reg_loss: 8919.1383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153514.0486; train_chrom_access_recon_loss: 468217.4896; train_global_loss: 1488950.2083; train_optim_loss: 1488950.2083; val_kl_reg_loss: 16610.7930; val_edge_recon_loss: 40660.9062; val_gene_expr_recon_loss: 766314.6250; val_masked_gp_l1_reg_loss: 9292.0107; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149524.5469; val_chrom_access_recon_loss: 462254.0000; val_global_loss: 1444656.8750; val_optim_loss: 1444656.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9056; val_auprc_score: 0.9166; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17571.9134; train_edge_recon_loss: 38461.1966; train_gene_expr_recon_loss: 753567.8194; train_masked_gp_l1_reg_loss: 9332.3597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145942.1632; train_chrom_access_recon_loss: 454985.3681; train_global_loss: 1419860.8056; train_optim_loss: 1419860.8056; val_kl_reg_loss: 20752.4824; val_edge_recon_loss: 40659.4453; val_gene_expr_recon_loss: 732552.1250; val_masked_gp_l1_reg_loss: 9456.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141299.2344; val_chrom_access_recon_loss: 455949.0312; val_global_loss: 1400668.7500; val_optim_loss: 1400668.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8921; val_auprc_score: 0.9000; val_best_acc_score: 0.5043; val_best_f1_score: 0.6686; train_kl_reg_loss: 20684.7695; train_edge_recon_loss: 38827.1580; train_gene_expr_recon_loss: 725398.4097; train_masked_gp_l1_reg_loss: 9436.2492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137376.5851; train_chrom_access_recon_loss: 448579.0069; train_global_loss: 1380302.1806; train_optim_loss: 1380302.1806; val_kl_reg_loss: 20377.1172; val_edge_recon_loss: 40655.5312; val_gene_expr_recon_loss: 712095.1250; val_masked_gp_l1_reg_loss: 9405.4434; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132406.7969; val_chrom_access_recon_loss: 451842.4375; val_global_loss: 1366782.5000; val_optim_loss: 1366782.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8894; val_auprc_score: 0.8938; val_best_acc_score: 0.5086; val_best_f1_score: 0.6705; train_kl_reg_loss: 20851.9822; train_edge_recon_loss: 38817.7600; train_gene_expr_recon_loss: 704689.1389; train_masked_gp_l1_reg_loss: 9387.9304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128390.8611; train_chrom_access_recon_loss: 447504.8021; train_global_loss: 1349642.4722; train_optim_loss: 1349642.4722; val_kl_reg_loss: 20943.8887; val_edge_recon_loss: 40650.7148; val_gene_expr_recon_loss: 697114.4375; val_masked_gp_l1_reg_loss: 9338.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123378.3203; val_chrom_access_recon_loss: 448866.7500; val_global_loss: 1340292.7500; val_optim_loss: 1340292.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8796; val_auprc_score: 0.8786; val_best_acc_score: 0.5178; val_best_f1_score: 0.6746; train_kl_reg_loss: 21388.1474; train_edge_recon_loss: 38878.9792; train_gene_expr_recon_loss: 694361.0833; train_masked_gp_l1_reg_loss: 9304.0558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119413.8898; train_chrom_access_recon_loss: 444195.8924; train_global_loss: 1327542.0556; train_optim_loss: 1327542.0556; val_kl_reg_loss: 20851.4004; val_edge_recon_loss: 40643.7969; val_gene_expr_recon_loss: 686315.9375; val_masked_gp_l1_reg_loss: 9259.3223; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114507.4297; val_chrom_access_recon_loss: 446819.7188; val_global_loss: 1318397.6250; val_optim_loss: 1318397.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8955; val_auprc_score: 0.8967; val_best_acc_score: 0.5265; val_best_f1_score: 0.6784; train_kl_reg_loss: 21540.5082; train_edge_recon_loss: 38912.4835; train_gene_expr_recon_loss: 683879.7014; train_masked_gp_l1_reg_loss: 9234.6196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110694.5842; train_chrom_access_recon_loss: 442173.1840; train_global_loss: 1306435.0972; train_optim_loss: 1306435.0972; val_kl_reg_loss: 21502.0703; val_edge_recon_loss: 40636.5352; val_gene_expr_recon_loss: 677167.7500; val_masked_gp_l1_reg_loss: 9200.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106008.1641; val_chrom_access_recon_loss: 445085.4062; val_global_loss: 1299600.3750; val_optim_loss: 1299600.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8970; val_auprc_score: 0.8964; val_best_acc_score: 0.5605; val_best_f1_score: 0.6938; train_kl_reg_loss: 21929.1947; train_edge_recon_loss: 38965.7170; train_gene_expr_recon_loss: 675166.3056; train_masked_gp_l1_reg_loss: 9172.6879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102407.8290; train_chrom_access_recon_loss: 441698.1389; train_global_loss: 1289339.8750; train_optim_loss: 1289339.8750; val_kl_reg_loss: 21017.5547; val_edge_recon_loss: 40617.5391; val_gene_expr_recon_loss: 670918.5000; val_masked_gp_l1_reg_loss: 9136.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98004.3828; val_chrom_access_recon_loss: 443561.4375; val_global_loss: 1283256.1250; val_optim_loss: 1283256.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8975; val_auprc_score: 0.8925; val_best_acc_score: 0.6118; val_best_f1_score: 0.7191; train_kl_reg_loss: 22056.9204; train_edge_recon_loss: 38972.0851; train_gene_expr_recon_loss: 671503.8958; train_masked_gp_l1_reg_loss: 9113.5738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94665.3472; train_chrom_access_recon_loss: 439114.6910; train_global_loss: 1275426.5139; train_optim_loss: 1275426.5139; val_kl_reg_loss: 20983.4355; val_edge_recon_loss: 40597.3984; val_gene_expr_recon_loss: 666061.8125; val_masked_gp_l1_reg_loss: 9082.3740; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90593.9062; val_chrom_access_recon_loss: 442178.3125; val_global_loss: 1269497.2500; val_optim_loss: 1269497.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9047; val_auprc_score: 0.8986; val_best_acc_score: 0.6668; val_best_f1_score: 0.7477; train_kl_reg_loss: 22228.3657; train_edge_recon_loss: 38996.2756; train_gene_expr_recon_loss: 662981.4306; train_masked_gp_l1_reg_loss: 9057.5796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87536.8142; train_chrom_access_recon_loss: 438244.7847; train_global_loss: 1259045.2639; train_optim_loss: 1259045.2639; val_kl_reg_loss: 21128.0957; val_edge_recon_loss: 40573.8086; val_gene_expr_recon_loss: 661691.8750; val_masked_gp_l1_reg_loss: 9024.4619; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83828.5156; val_chrom_access_recon_loss: 441161.2812; val_global_loss: 1257408.0000; val_optim_loss: 1257408.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9143; val_auprc_score: 0.9063; val_best_acc_score: 0.7379; val_best_f1_score: 0.7893; train_kl_reg_loss: 22003.5098; train_edge_recon_loss: 38978.2378; train_gene_expr_recon_loss: 662233.5833; train_masked_gp_l1_reg_loss: 9002.4952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81063.6224; train_chrom_access_recon_loss: 436796.2222; train_global_loss: 1250077.6667; train_optim_loss: 1250077.6667; val_kl_reg_loss: 20846.6660; val_edge_recon_loss: 40534.6719; val_gene_expr_recon_loss: 658580.1250; val_masked_gp_l1_reg_loss: 8972.7686; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77718.1172; val_chrom_access_recon_loss: 440107.3750; val_global_loss: 1246759.7500; val_optim_loss: 1246759.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9188; val_auprc_score: 0.9107; val_best_acc_score: 0.7786; val_best_f1_score: 0.8134; train_kl_reg_loss: 21726.2296; train_edge_recon_loss: 38944.1207; train_gene_expr_recon_loss: 657296.5833; train_masked_gp_l1_reg_loss: 8958.1362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75228.7005; train_chrom_access_recon_loss: 435503.5312; train_global_loss: 1237657.3056; train_optim_loss: 1237657.3056; val_kl_reg_loss: 20341.1680; val_edge_recon_loss: 40495.4219; val_gene_expr_recon_loss: 656528.1250; val_masked_gp_l1_reg_loss: 8935.2959; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72204.7656; val_chrom_access_recon_loss: 439312.5625; val_global_loss: 1237817.2500; val_optim_loss: 1237817.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9255; val_auprc_score: 0.9184; val_best_acc_score: 0.8073; val_best_f1_score: 0.8313; train_kl_reg_loss: 21506.8956; train_edge_recon_loss: 38911.1506; train_gene_expr_recon_loss: 656684.9583; train_masked_gp_l1_reg_loss: 8929.6669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69952.9531; train_chrom_access_recon_loss: 436541.4792; train_global_loss: 1232527.1111; train_optim_loss: 1232527.1111; val_kl_reg_loss: 20240.5449; val_edge_recon_loss: 40456.1797; val_gene_expr_recon_loss: 653867.0000; val_masked_gp_l1_reg_loss: 8913.6436; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67219.8438; val_chrom_access_recon_loss: 438271.6875; val_global_loss: 1228969.0000; val_optim_loss: 1228969.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9280; val_auprc_score: 0.9137; val_best_acc_score: 0.8383; val_best_f1_score: 0.8526; train_kl_reg_loss: 21127.6964; train_edge_recon_loss: 38874.1111; train_gene_expr_recon_loss: 650697.5972; train_masked_gp_l1_reg_loss: 8906.3478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65188.3542; train_chrom_access_recon_loss: 434018.9688; train_global_loss: 1218813.0833; train_optim_loss: 1218813.0833; val_kl_reg_loss: 20296.1699; val_edge_recon_loss: 40394.7812; val_gene_expr_recon_loss: 651394.7500; val_masked_gp_l1_reg_loss: 8891.0010; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62713.7539; val_chrom_access_recon_loss: 437433.7812; val_global_loss: 1221124.2500; val_optim_loss: 1221124.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9345; val_auprc_score: 0.9245; val_best_acc_score: 0.8623; val_best_f1_score: 0.8701; train_kl_reg_loss: 20898.9644; train_edge_recon_loss: 38815.1289; train_gene_expr_recon_loss: 649396.4514; train_masked_gp_l1_reg_loss: 8885.7096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60867.4965; train_chrom_access_recon_loss: 432885.6771; train_global_loss: 1211749.4167; train_optim_loss: 1211749.4167; val_kl_reg_loss: 20255.1172; val_edge_recon_loss: 40338.4180; val_gene_expr_recon_loss: 649392.5000; val_masked_gp_l1_reg_loss: 8875.4541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58624.8477; val_chrom_access_recon_loss: 436704.7812; val_global_loss: 1214191.1250; val_optim_loss: 1214191.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9324; val_auprc_score: 0.9191; val_best_acc_score: 0.8657; val_best_f1_score: 0.8706; train_kl_reg_loss: 20646.7378; train_edge_recon_loss: 38775.2951; train_gene_expr_recon_loss: 647204.2083; train_masked_gp_l1_reg_loss: 8866.9309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56952.4245; train_chrom_access_recon_loss: 433977.2986; train_global_loss: 1206422.8889; train_optim_loss: 1206422.8889; val_kl_reg_loss: 19372.9844; val_edge_recon_loss: 40279.2852; val_gene_expr_recon_loss: 648584.8750; val_masked_gp_l1_reg_loss: 8855.6348; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54912.2188; val_chrom_access_recon_loss: 435900.7188; val_global_loss: 1207905.7500; val_optim_loss: 1207905.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9363; val_auprc_score: 0.9305; val_best_acc_score: 0.8628; val_best_f1_score: 0.8667; train_kl_reg_loss: 20320.9256; train_edge_recon_loss: 38722.8733; train_gene_expr_recon_loss: 647248.0347; train_masked_gp_l1_reg_loss: 8853.5862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53387.7118; train_chrom_access_recon_loss: 430616.8125; train_global_loss: 1199149.9444; train_optim_loss: 1199149.9444; val_kl_reg_loss: 19973.1484; val_edge_recon_loss: 40235.1562; val_gene_expr_recon_loss: 646110.3750; val_masked_gp_l1_reg_loss: 8847.0010; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51536.3203; val_chrom_access_recon_loss: 435083.6562; val_global_loss: 1201785.6250; val_optim_loss: 1201785.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9371; val_auprc_score: 0.9270; val_best_acc_score: 0.8663; val_best_f1_score: 0.8668; train_kl_reg_loss: 20187.4227; train_edge_recon_loss: 38668.3811; train_gene_expr_recon_loss: 647128.7083; train_masked_gp_l1_reg_loss: 8842.2129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50153.4605; train_chrom_access_recon_loss: 432543.4757; train_global_loss: 1197523.6528; train_optim_loss: 1197523.6528; val_kl_reg_loss: 18817.8906; val_edge_recon_loss: 40148.7500; val_gene_expr_recon_loss: 645813.0000; val_masked_gp_l1_reg_loss: 8838.2900; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48462.6719; val_chrom_access_recon_loss: 434426.4688; val_global_loss: 1196507.1250; val_optim_loss: 1196507.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9416; val_auprc_score: 0.9328; val_best_acc_score: 0.8719; val_best_f1_score: 0.8699; train_kl_reg_loss: 19876.5102; train_edge_recon_loss: 38584.6450; train_gene_expr_recon_loss: 646359.4514; train_masked_gp_l1_reg_loss: 8839.8740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47199.9553; train_chrom_access_recon_loss: 431272.1250; train_global_loss: 1192132.5556; train_optim_loss: 1192132.5556; val_kl_reg_loss: 19191.9316; val_edge_recon_loss: 40082.9570; val_gene_expr_recon_loss: 643597.3750; val_masked_gp_l1_reg_loss: 8834.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45649.3320; val_chrom_access_recon_loss: 433723.7188; val_global_loss: 1191079.7500; val_optim_loss: 1191079.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9400; val_auprc_score: 0.9317; val_best_acc_score: 0.8607; val_best_f1_score: 0.8570; train_kl_reg_loss: 19635.8158; train_edge_recon_loss: 38525.9900; train_gene_expr_recon_loss: 640465.6806; train_masked_gp_l1_reg_loss: 8830.7780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44491.3047; train_chrom_access_recon_loss: 428816.5764; train_global_loss: 1180766.1389; train_optim_loss: 1180766.1389; val_kl_reg_loss: 18323.0117; val_edge_recon_loss: 40002.0938; val_gene_expr_recon_loss: 643251.8125; val_masked_gp_l1_reg_loss: 8823.2080; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43067.1133; val_chrom_access_recon_loss: 433128.5625; val_global_loss: 1186595.7500; val_optim_loss: 1186595.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9405; val_auprc_score: 0.9263; val_best_acc_score: 0.8627; val_best_f1_score: 0.8565; train_kl_reg_loss: 19372.2862; train_edge_recon_loss: 38454.0833; train_gene_expr_recon_loss: 644289.0278; train_masked_gp_l1_reg_loss: 8818.5221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41996.8958; train_chrom_access_recon_loss: 430953.8333; train_global_loss: 1183884.6389; train_optim_loss: 1183884.6389; val_kl_reg_loss: 18368.4453; val_edge_recon_loss: 39923.3125; val_gene_expr_recon_loss: 641758.0625; val_masked_gp_l1_reg_loss: 8815.9004; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40689.4688; val_chrom_access_recon_loss: 432370.2188; val_global_loss: 1181925.3750; val_optim_loss: 1181925.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9440; val_auprc_score: 0.9357; val_best_acc_score: 0.8596; val_best_f1_score: 0.8513; train_kl_reg_loss: 19163.8950; train_edge_recon_loss: 38388.1697; train_gene_expr_recon_loss: 640806.3125; train_masked_gp_l1_reg_loss: 8822.9759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39707.3299; train_chrom_access_recon_loss: 429717.3368; train_global_loss: 1176606.0556; train_optim_loss: 1176606.0556; val_kl_reg_loss: 18346.5742; val_edge_recon_loss: 39846.7695; val_gene_expr_recon_loss: 640309.1250; val_masked_gp_l1_reg_loss: 8826.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38497.1797; val_chrom_access_recon_loss: 431662.3438; val_global_loss: 1177488.1250; val_optim_loss: 1177488.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9482; val_auprc_score: 0.9406; val_best_acc_score: 0.8525; val_best_f1_score: 0.8406; train_kl_reg_loss: 18973.7431; train_edge_recon_loss: 38315.0968; train_gene_expr_recon_loss: 641078.3194; train_masked_gp_l1_reg_loss: 8831.5111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37592.8003; train_chrom_access_recon_loss: 428396.3958; train_global_loss: 1173187.8750; train_optim_loss: 1173187.8750; val_kl_reg_loss: 17734.0273; val_edge_recon_loss: 39746.4258; val_gene_expr_recon_loss: 640047.6875; val_masked_gp_l1_reg_loss: 8830.9082; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36475.5703; val_chrom_access_recon_loss: 431113.9062; val_global_loss: 1173948.5000; val_optim_loss: 1173948.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9487; val_auprc_score: 0.9431; val_best_acc_score: 0.8477; val_best_f1_score: 0.8469; train_kl_reg_loss: 18769.3424; train_edge_recon_loss: 38258.8694; train_gene_expr_recon_loss: 639040.7292; train_masked_gp_l1_reg_loss: 8827.9378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35644.0773; train_chrom_access_recon_loss: 425843.4236; train_global_loss: 1166384.3750; train_optim_loss: 1166384.3750; val_kl_reg_loss: 18267.5605; val_edge_recon_loss: 39710.6719; val_gene_expr_recon_loss: 638051.0000; val_masked_gp_l1_reg_loss: 8821.7451; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34621.7344; val_chrom_access_recon_loss: 430094.7812; val_global_loss: 1169567.5000; val_optim_loss: 1169567.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9488; val_auprc_score: 0.9394; val_best_acc_score: 0.8789; val_best_f1_score: 0.8862; train_kl_reg_loss: 15436.5762; train_edge_recon_loss: 39974.1784; train_gene_expr_recon_loss: 934285.9861; train_masked_gp_l1_reg_loss: 8988.1268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33719.8934; train_chrom_access_recon_loss: 455365.1944; train_global_loss: 1487769.9861; train_optim_loss: 1487769.9861; val_kl_reg_loss: 11748.8242; val_edge_recon_loss: 40313.1562; val_gene_expr_recon_loss: 924088.9375; val_masked_gp_l1_reg_loss: 9318.8652; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32503.6094; val_chrom_access_recon_loss: 457445.5625; val_global_loss: 1475419.0000; val_optim_loss: 1475419.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9491; val_auprc_score: 0.9407; val_best_acc_score: 0.8809; val_best_f1_score: 0.8878; train_kl_reg_loss: 13412.8762; train_edge_recon_loss: 40082.5981; train_gene_expr_recon_loss: 920780.9722; train_masked_gp_l1_reg_loss: 9607.8605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31507.2075; train_chrom_access_recon_loss: 452543.3368; train_global_loss: 1467934.8611; train_optim_loss: 1467934.8611; val_kl_reg_loss: 11001.4717; val_edge_recon_loss: 40317.3789; val_gene_expr_recon_loss: 917082.2500; val_masked_gp_l1_reg_loss: 9937.1904; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30285.1055; val_chrom_access_recon_loss: 456698.0625; val_global_loss: 1465321.5000; val_optim_loss: 1465321.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9470; val_auprc_score: 0.9368; val_best_acc_score: 0.8794; val_best_f1_score: 0.8858; train_kl_reg_loss: 12479.7174; train_edge_recon_loss: 40061.6910; train_gene_expr_recon_loss: 911325.2778; train_masked_gp_l1_reg_loss: 10136.4309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29360.1853; train_chrom_access_recon_loss: 452580.7326; train_global_loss: 1455944.0139; train_optim_loss: 1455944.0139; val_kl_reg_loss: 10760.2402; val_edge_recon_loss: 40285.4805; val_gene_expr_recon_loss: 911465.3750; val_masked_gp_l1_reg_loss: 10338.2529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28238.4277; val_chrom_access_recon_loss: 456012.8438; val_global_loss: 1457100.6250; val_optim_loss: 1457100.6250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9451; val_auprc_score: 0.9360; val_best_acc_score: 0.8770; val_best_f1_score: 0.8817; train_kl_reg_loss: 12143.2666; train_edge_recon_loss: 40025.3207; train_gene_expr_recon_loss: 907636.9028; train_masked_gp_l1_reg_loss: 10446.4775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27406.8889; train_chrom_access_recon_loss: 451242.9965; train_global_loss: 1448901.8750; train_optim_loss: 1448901.8750; val_kl_reg_loss: 10740.2090; val_edge_recon_loss: 40237.6953; val_gene_expr_recon_loss: 907136.7500; val_masked_gp_l1_reg_loss: 10557.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26406.0977; val_chrom_access_recon_loss: 455484.6250; val_global_loss: 1450562.5000; val_optim_loss: 1450562.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9483; val_auprc_score: 0.9388; val_best_acc_score: 0.8816; val_best_f1_score: 0.8856; train_kl_reg_loss: 11999.8396; train_edge_recon_loss: 40002.1163; train_gene_expr_recon_loss: 908248.2500; train_masked_gp_l1_reg_loss: 10482.9559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26242.9368; train_chrom_access_recon_loss: 453664.9931; train_global_loss: 1450641.0833; train_optim_loss: 1450641.0833; val_kl_reg_loss: 10887.0391; val_edge_recon_loss: 40225.7578; val_gene_expr_recon_loss: 906425.5000; val_masked_gp_l1_reg_loss: 10424.8877; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26063.4180; val_chrom_access_recon_loss: 455298.6875; val_global_loss: 1449325.2500; val_optim_loss: 1449325.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9460; val_auprc_score: 0.9369; val_best_acc_score: 0.8816; val_best_f1_score: 0.8854; train_kl_reg_loss: 12108.9418; train_edge_recon_loss: 39999.4145; train_gene_expr_recon_loss: 908340.7153; train_masked_gp_l1_reg_loss: 10411.5900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25958.4527; train_chrom_access_recon_loss: 453786.1493; train_global_loss: 1450605.2500; train_optim_loss: 1450605.2500; val_kl_reg_loss: 10922.0938; val_edge_recon_loss: 40218.8438; val_gene_expr_recon_loss: 906045.0000; val_masked_gp_l1_reg_loss: 10387.3262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25822.3984; val_chrom_access_recon_loss: 455279.7500; val_global_loss: 1448675.3750; val_optim_loss: 1448675.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9495; val_auprc_score: 0.9423; val_best_acc_score: 0.8828; val_best_f1_score: 0.8862; train_kl_reg_loss: 12040.2502; train_edge_recon_loss: 39991.4058; train_gene_expr_recon_loss: 903643.4167; train_masked_gp_l1_reg_loss: 10375.2139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25723.8954; train_chrom_access_recon_loss: 450801.2188; train_global_loss: 1442575.4167; train_optim_loss: 1442575.4167; val_kl_reg_loss: 10880.7207; val_edge_recon_loss: 40205.9180; val_gene_expr_recon_loss: 905731.5000; val_masked_gp_l1_reg_loss: 10361.7139; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25603.9082; val_chrom_access_recon_loss: 455203.2812; val_global_loss: 1447987.0000; val_optim_loss: 1447987.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9499; val_auprc_score: 0.9433; val_best_acc_score: 0.8863; val_best_f1_score: 0.8892; train_kl_reg_loss: 12013.8661; train_edge_recon_loss: 39983.7730; train_gene_expr_recon_loss: 903974.1458; train_masked_gp_l1_reg_loss: 10354.1296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25513.2461; train_chrom_access_recon_loss: 452498.8056; train_global_loss: 1444337.9861; train_optim_loss: 1444337.9861; val_kl_reg_loss: 10889.2344; val_edge_recon_loss: 40207.4766; val_gene_expr_recon_loss: 905434.2500; val_masked_gp_l1_reg_loss: 10346.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25404.6719; val_chrom_access_recon_loss: 455212.5625; val_global_loss: 1447494.7500; val_optim_loss: 1447494.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9492
val AUPRC score: 0.9417
val best accuracy score: 0.8841
val best F1 score: 0.8896
val target rna MSE score: 4.0158
val source rna MSE score: 3.1902
val target atac MSE score: 0.1378
val source atac MSE score: 0.0210
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
