[True]
Run timestamp: 07092023_165111_54.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_54']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6311; val_auprc_score: 0.6192; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 53422.6028; train_edge_recon_loss: 3577376.3712; train_gene_expr_recon_loss: 27807054.1818; train_masked_gp_l1_reg_loss: 93363.8545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1561542.7860; train_chrom_access_recon_loss: 1268171.6837; train_global_loss: 34360931.4848; train_optim_loss: 34360931.4848; val_kl_reg_loss: 117874.0830; val_edge_recon_loss: 4065757.9062; val_gene_expr_recon_loss: 25634372.0000; val_masked_gp_l1_reg_loss: 91430.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1304798.1250; val_chrom_access_recon_loss: 1209736.4531; val_global_loss: 32423968.5000; val_optim_loss: 32423968.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7028; val_auprc_score: 0.6914; val_best_acc_score: 0.6099; val_best_f1_score: 0.7005; train_kl_reg_loss: 115317.0507; train_edge_recon_loss: 3548304.3636; train_gene_expr_recon_loss: 24901605.2727; train_masked_gp_l1_reg_loss: 86677.3125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1051471.7112; train_chrom_access_recon_loss: 1202083.0133; train_global_loss: 30905458.7576; train_optim_loss: 30905458.7576; val_kl_reg_loss: 115108.6338; val_edge_recon_loss: 4056862.0312; val_gene_expr_recon_loss: 24661985.7500; val_masked_gp_l1_reg_loss: 83213.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 817022.6250; val_chrom_access_recon_loss: 1183054.3125; val_global_loss: 30917246.2500; val_optim_loss: 30917246.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7607; val_auprc_score: 0.7429; val_best_acc_score: 0.6961; val_best_f1_score: 0.7027; train_kl_reg_loss: 116998.9822; train_edge_recon_loss: 3531435.1364; train_gene_expr_recon_loss: 24426178.4848; train_masked_gp_l1_reg_loss: 81665.1030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 650307.1340; train_chrom_access_recon_loss: 1187069.3542; train_global_loss: 29993654.0000; train_optim_loss: 29993654.0000; val_kl_reg_loss: 126240.5781; val_edge_recon_loss: 4027866.9688; val_gene_expr_recon_loss: 24263625.5000; val_masked_gp_l1_reg_loss: 81343.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 508238.6250; val_chrom_access_recon_loss: 1172541.5000; val_global_loss: 30179856.7500; val_optim_loss: 30179856.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8388; val_auprc_score: 0.8032; val_best_acc_score: 0.7697; val_best_f1_score: 0.7825; train_kl_reg_loss: 103382.0281; train_edge_recon_loss: 3508606.5303; train_gene_expr_recon_loss: 24200937.5455; train_masked_gp_l1_reg_loss: 82721.0814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 415949.7841; train_chrom_access_recon_loss: 1179700.3182; train_global_loss: 29491297.2727; train_optim_loss: 29491297.2727; val_kl_reg_loss: 90116.7510; val_edge_recon_loss: 3846990.3125; val_gene_expr_recon_loss: 24078540.7500; val_masked_gp_l1_reg_loss: 84105.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 338850.1562; val_chrom_access_recon_loss: 1169905.6094; val_global_loss: 29608509.7500; val_optim_loss: 29608509.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8437; val_auprc_score: 0.7942; val_best_acc_score: 0.7695; val_best_f1_score: 0.7994; train_kl_reg_loss: 83271.2964; train_edge_recon_loss: 3321100.4735; train_gene_expr_recon_loss: 24048771.6061; train_masked_gp_l1_reg_loss: 86869.6541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 287544.2500; train_chrom_access_recon_loss: 1174079.8068; train_global_loss: 29001637.0606; train_optim_loss: 29001637.0606; val_kl_reg_loss: 93473.3057; val_edge_recon_loss: 3079856.5625; val_gene_expr_recon_loss: 23859954.7500; val_masked_gp_l1_reg_loss: 90895.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 243155.1250; val_chrom_access_recon_loss: 1166018.7031; val_global_loss: 28533355.0000; val_optim_loss: 28533355.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8446; val_auprc_score: 0.8091; val_best_acc_score: 0.7641; val_best_f1_score: 0.7884; train_kl_reg_loss: 114402.4782; train_edge_recon_loss: 3014075.3674; train_gene_expr_recon_loss: 23939228.1515; train_masked_gp_l1_reg_loss: 91784.0458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211546.2995; train_chrom_access_recon_loss: 1167491.1742; train_global_loss: 28538527.6364; train_optim_loss: 28538527.6364; val_kl_reg_loss: 118123.0459; val_edge_recon_loss: 3019842.2500; val_gene_expr_recon_loss: 23603505.0000; val_masked_gp_l1_reg_loss: 92577.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183593.5625; val_chrom_access_recon_loss: 1149465.1406; val_global_loss: 28167107.0000; val_optim_loss: 28167107.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8621; val_auprc_score: 0.8236; val_best_acc_score: 0.7856; val_best_f1_score: 0.8033; train_kl_reg_loss: 118664.0947; train_edge_recon_loss: 2979889.6818; train_gene_expr_recon_loss: 23770449.3939; train_masked_gp_l1_reg_loss: 93474.3017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163326.3312; train_chrom_access_recon_loss: 1160900.7348; train_global_loss: 28286704.6061; train_optim_loss: 28286704.6061; val_kl_reg_loss: 115878.8818; val_edge_recon_loss: 2973326.4375; val_gene_expr_recon_loss: 23669675.7500; val_masked_gp_l1_reg_loss: 94761.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145215.7969; val_chrom_access_recon_loss: 1144763.0312; val_global_loss: 28143622.2500; val_optim_loss: 28143622.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8770; val_auprc_score: 0.8394; val_best_acc_score: 0.8092; val_best_f1_score: 0.8244; train_kl_reg_loss: 118583.1465; train_edge_recon_loss: 2941343.2197; train_gene_expr_recon_loss: 23686420.7576; train_masked_gp_l1_reg_loss: 95761.0155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131939.8451; train_chrom_access_recon_loss: 1158307.1989; train_global_loss: 28132355.1818; train_optim_loss: 28132355.1818; val_kl_reg_loss: 115605.6582; val_edge_recon_loss: 2906998.3438; val_gene_expr_recon_loss: 23610991.0000; val_masked_gp_l1_reg_loss: 96721.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120339.3906; val_chrom_access_recon_loss: 1143935.4219; val_global_loss: 27994593.0000; val_optim_loss: 27994593.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8799; val_auprc_score: 0.8479; val_best_acc_score: 0.8071; val_best_f1_score: 0.8252; train_kl_reg_loss: 116388.0275; train_edge_recon_loss: 2921777.7500; train_gene_expr_recon_loss: 23589433.9697; train_masked_gp_l1_reg_loss: 97580.8686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111266.3923; train_chrom_access_recon_loss: 1154178.9943; train_global_loss: 27990626.0303; train_optim_loss: 27990626.0303; val_kl_reg_loss: 111260.3184; val_edge_recon_loss: 2936445.1875; val_gene_expr_recon_loss: 23468614.0000; val_masked_gp_l1_reg_loss: 98438.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103286.7422; val_chrom_access_recon_loss: 1131463.0312; val_global_loss: 27849507.0000; val_optim_loss: 27849507.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8876; val_auprc_score: 0.8520; val_best_acc_score: 0.8256; val_best_f1_score: 0.8387; train_kl_reg_loss: 110523.6670; train_edge_recon_loss: 2899066.9242; train_gene_expr_recon_loss: 23468681.5455; train_masked_gp_l1_reg_loss: 99594.2889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96698.4688; train_chrom_access_recon_loss: 1148070.3258; train_global_loss: 27822635.0606; train_optim_loss: 27822635.0606; val_kl_reg_loss: 107441.8232; val_edge_recon_loss: 2913597.6562; val_gene_expr_recon_loss: 23402240.2500; val_masked_gp_l1_reg_loss: 100792.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90883.7578; val_chrom_access_recon_loss: 1140462.6406; val_global_loss: 27755418.2500; val_optim_loss: 27755418.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9032; val_auprc_score: 0.8772; val_best_acc_score: 0.8334; val_best_f1_score: 0.8485; train_kl_reg_loss: 111828.1645; train_edge_recon_loss: 2861887.7197; train_gene_expr_recon_loss: 23368303.1212; train_masked_gp_l1_reg_loss: 101768.5064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85989.1972; train_chrom_access_recon_loss: 1142758.4886; train_global_loss: 27672534.9697; train_optim_loss: 27672534.9697; val_kl_reg_loss: 112852.6562; val_edge_recon_loss: 2855549.6875; val_gene_expr_recon_loss: 23438552.0000; val_masked_gp_l1_reg_loss: 102619.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81835.4141; val_chrom_access_recon_loss: 1139107.6562; val_global_loss: 27730518.2500; val_optim_loss: 27730518.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8927; val_auprc_score: 0.8469; val_best_acc_score: 0.8321; val_best_f1_score: 0.8454; train_kl_reg_loss: 110005.7431; train_edge_recon_loss: 2852425.0379; train_gene_expr_recon_loss: 23267169.0303; train_masked_gp_l1_reg_loss: 103874.1201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78122.8145; train_chrom_access_recon_loss: 1138490.0436; train_global_loss: 27550086.8182; train_optim_loss: 27550086.8182; val_kl_reg_loss: 108775.4150; val_edge_recon_loss: 2879496.8750; val_gene_expr_recon_loss: 23101733.0000; val_masked_gp_l1_reg_loss: 104733.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75018.3203; val_chrom_access_recon_loss: 1130162.5000; val_global_loss: 27399919.7500; val_optim_loss: 27399919.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9086; val_auprc_score: 0.8792; val_best_acc_score: 0.8469; val_best_f1_score: 0.8575; train_kl_reg_loss: 109782.2875; train_edge_recon_loss: 2831339.6061; train_gene_expr_recon_loss: 23202520.5758; train_masked_gp_l1_reg_loss: 105475.0326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71702.2513; train_chrom_access_recon_loss: 1136218.6951; train_global_loss: 27457038.2424; train_optim_loss: 27457038.2424; val_kl_reg_loss: 108374.5283; val_edge_recon_loss: 2827587.5938; val_gene_expr_recon_loss: 23055748.2500; val_masked_gp_l1_reg_loss: 106362.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69382.9062; val_chrom_access_recon_loss: 1121113.6250; val_global_loss: 27288567.7500; val_optim_loss: 27288567.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9086; val_auprc_score: 0.8794; val_best_acc_score: 0.8431; val_best_f1_score: 0.8567; train_kl_reg_loss: 108740.2580; train_edge_recon_loss: 2807752.5114; train_gene_expr_recon_loss: 23116593.6364; train_masked_gp_l1_reg_loss: 107104.6750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66673.2119; train_chrom_access_recon_loss: 1131853.5625; train_global_loss: 27338717.8485; train_optim_loss: 27338717.8485; val_kl_reg_loss: 112205.8457; val_edge_recon_loss: 2831258.4062; val_gene_expr_recon_loss: 22868368.0000; val_masked_gp_l1_reg_loss: 108092.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64821.8125; val_chrom_access_recon_loss: 1111352.3125; val_global_loss: 27096098.5000; val_optim_loss: 27096098.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9172; val_auprc_score: 0.8881; val_best_acc_score: 0.8622; val_best_f1_score: 0.8711; train_kl_reg_loss: 109305.0726; train_edge_recon_loss: 2815730.6591; train_gene_expr_recon_loss: 23046920.8485; train_masked_gp_l1_reg_loss: 108666.5443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62959.7049; train_chrom_access_recon_loss: 1128218.9299; train_global_loss: 27271801.6667; train_optim_loss: 27271801.6667; val_kl_reg_loss: 106687.8789; val_edge_recon_loss: 2801027.1250; val_gene_expr_recon_loss: 22990547.5000; val_masked_gp_l1_reg_loss: 109521.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61280.0547; val_chrom_access_recon_loss: 1122313.0625; val_global_loss: 27191378.0000; val_optim_loss: 27191378.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9140; val_auprc_score: 0.8867; val_best_acc_score: 0.8490; val_best_f1_score: 0.8596; train_kl_reg_loss: 107524.5494; train_edge_recon_loss: 2799259.3409; train_gene_expr_recon_loss: 22978841.9091; train_masked_gp_l1_reg_loss: 110124.1624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59807.0211; train_chrom_access_recon_loss: 1124211.4905; train_global_loss: 27179768.3636; train_optim_loss: 27179768.3636; val_kl_reg_loss: 105626.9521; val_edge_recon_loss: 2860911.7812; val_gene_expr_recon_loss: 23161267.7500; val_masked_gp_l1_reg_loss: 111015.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58469.3359; val_chrom_access_recon_loss: 1128546.6250; val_global_loss: 27425839.2500; val_optim_loss: 27425839.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9204; val_auprc_score: 0.8940; val_best_acc_score: 0.8654; val_best_f1_score: 0.8735; train_kl_reg_loss: 104266.4116; train_edge_recon_loss: 2794742.1288; train_gene_expr_recon_loss: 22944227.6364; train_masked_gp_l1_reg_loss: 111573.5392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57180.1561; train_chrom_access_recon_loss: 1122646.8030; train_global_loss: 27134636.5455; train_optim_loss: 27134636.5455; val_kl_reg_loss: 105209.0029; val_edge_recon_loss: 2815874.9688; val_gene_expr_recon_loss: 22713948.5000; val_masked_gp_l1_reg_loss: 112356.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55966.8398; val_chrom_access_recon_loss: 1106171.5703; val_global_loss: 26909526.7500; val_optim_loss: 26909526.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9188; val_auprc_score: 0.8903; val_best_acc_score: 0.8632; val_best_f1_score: 0.8724; train_kl_reg_loss: 104536.6584; train_edge_recon_loss: 2779945.1515; train_gene_expr_recon_loss: 22850517.6667; train_masked_gp_l1_reg_loss: 112989.5603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54981.7509; train_chrom_access_recon_loss: 1118486.2443; train_global_loss: 27021456.9697; train_optim_loss: 27021456.9697; val_kl_reg_loss: 104184.7568; val_edge_recon_loss: 2802697.2188; val_gene_expr_recon_loss: 22780918.2500; val_masked_gp_l1_reg_loss: 113732.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54136.6016; val_chrom_access_recon_loss: 1113687.1875; val_global_loss: 26969355.0000; val_optim_loss: 26969355.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9283; val_auprc_score: 0.9062; val_best_acc_score: 0.8721; val_best_f1_score: 0.8801; train_kl_reg_loss: 104219.8531; train_edge_recon_loss: 2773189.2197; train_gene_expr_recon_loss: 22814455.5152; train_masked_gp_l1_reg_loss: 114323.3531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53230.3306; train_chrom_access_recon_loss: 1117453.2822; train_global_loss: 26976871.4545; train_optim_loss: 26976871.4545; val_kl_reg_loss: 104721.9854; val_edge_recon_loss: 2773536.2812; val_gene_expr_recon_loss: 22971517.5000; val_masked_gp_l1_reg_loss: 115077.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52498.8281; val_chrom_access_recon_loss: 1111792.3750; val_global_loss: 27129144.0000; val_optim_loss: 27129144.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9129; val_auprc_score: 0.8827; val_best_acc_score: 0.8528; val_best_f1_score: 0.8646; train_kl_reg_loss: 102079.5185; train_edge_recon_loss: 2769697.2879; train_gene_expr_recon_loss: 22752440.1212; train_masked_gp_l1_reg_loss: 115567.1325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51588.9859; train_chrom_access_recon_loss: 1113518.6610; train_global_loss: 26904891.5758; train_optim_loss: 26904891.5758; val_kl_reg_loss: 104658.2207; val_edge_recon_loss: 2857011.5312; val_gene_expr_recon_loss: 22861124.5000; val_masked_gp_l1_reg_loss: 116262.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51231.9102; val_chrom_access_recon_loss: 1106109.7188; val_global_loss: 27096398.0000; val_optim_loss: 27096398.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9326; val_auprc_score: 0.9089; val_best_acc_score: 0.8732; val_best_f1_score: 0.8821; train_kl_reg_loss: 100911.8597; train_edge_recon_loss: 2772414.3409; train_gene_expr_recon_loss: 22692660.6667; train_masked_gp_l1_reg_loss: 116844.6586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50482.8503; train_chrom_access_recon_loss: 1111048.5294; train_global_loss: 26844363.0606; train_optim_loss: 26844363.0606; val_kl_reg_loss: 100820.7441; val_edge_recon_loss: 2768274.7188; val_gene_expr_recon_loss: 22740972.2500; val_masked_gp_l1_reg_loss: 117459.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50214.6367; val_chrom_access_recon_loss: 1109450.3516; val_global_loss: 26887192.0000; val_optim_loss: 26887192.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9324; val_auprc_score: 0.9121; val_best_acc_score: 0.8726; val_best_f1_score: 0.8797; train_kl_reg_loss: 101864.8404; train_edge_recon_loss: 2754777.6742; train_gene_expr_recon_loss: 22655824.7879; train_masked_gp_l1_reg_loss: 117887.5071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49647.4371; train_chrom_access_recon_loss: 1108557.3201; train_global_loss: 26788559.5455; train_optim_loss: 26788559.5455; val_kl_reg_loss: 101408.5977; val_edge_recon_loss: 2791401.2812; val_gene_expr_recon_loss: 22508552.5000; val_masked_gp_l1_reg_loss: 118395.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48929.4023; val_chrom_access_recon_loss: 1107772.7500; val_global_loss: 26676461.2500; val_optim_loss: 26676461.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9423; val_auprc_score: 0.9252; val_best_acc_score: 0.8802; val_best_f1_score: 0.8870; train_kl_reg_loss: 99250.2080; train_edge_recon_loss: 2758860.1553; train_gene_expr_recon_loss: 22594700.8788; train_masked_gp_l1_reg_loss: 118993.8697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48536.4592; train_chrom_access_recon_loss: 1105912.1667; train_global_loss: 26726253.7576; train_optim_loss: 26726253.7576; val_kl_reg_loss: 98900.3555; val_edge_recon_loss: 2765203.9375; val_gene_expr_recon_loss: 22494643.2500; val_masked_gp_l1_reg_loss: 119504.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48272.2305; val_chrom_access_recon_loss: 1096471.1797; val_global_loss: 26622995.2500; val_optim_loss: 26622995.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9447; val_auprc_score: 0.9270; val_best_acc_score: 0.8823; val_best_f1_score: 0.8862; train_kl_reg_loss: 98516.3739; train_edge_recon_loss: 2742470.0871; train_gene_expr_recon_loss: 22550691.2727; train_masked_gp_l1_reg_loss: 120116.1658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47852.2549; train_chrom_access_recon_loss: 1102890.4972; train_global_loss: 26662536.4848; train_optim_loss: 26662536.4848; val_kl_reg_loss: 97987.9355; val_edge_recon_loss: 2742976.8750; val_gene_expr_recon_loss: 22592231.7500; val_masked_gp_l1_reg_loss: 120767.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47516.1523; val_chrom_access_recon_loss: 1098600.9375; val_global_loss: 26700082.0000; val_optim_loss: 26700082.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9405; val_auprc_score: 0.9214; val_best_acc_score: 0.8783; val_best_f1_score: 0.8851; train_kl_reg_loss: 97911.5104; train_edge_recon_loss: 2751170.8674; train_gene_expr_recon_loss: 22523105.7273; train_masked_gp_l1_reg_loss: 121110.8434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46957.6576; train_chrom_access_recon_loss: 1102829.5739; train_global_loss: 26643086.3939; train_optim_loss: 26643086.3939; val_kl_reg_loss: 96963.4453; val_edge_recon_loss: 2776664.3125; val_gene_expr_recon_loss: 22241696.5000; val_masked_gp_l1_reg_loss: 121720.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46864.9766; val_chrom_access_recon_loss: 1087701.1406; val_global_loss: 26371609.7500; val_optim_loss: 26371609.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9451; val_auprc_score: 0.9312; val_best_acc_score: 0.8829; val_best_f1_score: 0.8879; train_kl_reg_loss: 107316.3101; train_edge_recon_loss: 2792561.2614; train_gene_expr_recon_loss: 22203042.0303; train_masked_gp_l1_reg_loss: 120854.0288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39790.2999; train_chrom_access_recon_loss: 1089508.6572; train_global_loss: 26353072.4848; train_optim_loss: 26353072.4848; val_kl_reg_loss: 72836.4922; val_edge_recon_loss: 2796778.5000; val_gene_expr_recon_loss: 22019697.5000; val_masked_gp_l1_reg_loss: 120405.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37785.8516; val_chrom_access_recon_loss: 1066570.4375; val_global_loss: 26114075.7500; val_optim_loss: 26114075.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9398; val_auprc_score: 0.9229; val_best_acc_score: 0.8761; val_best_f1_score: 0.8823; train_kl_reg_loss: 110191.4476; train_edge_recon_loss: 2760296.9962; train_gene_expr_recon_loss: 22103567.0303; train_masked_gp_l1_reg_loss: 120603.9021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37652.1270; train_chrom_access_recon_loss: 1076572.4413; train_global_loss: 26208884.2121; train_optim_loss: 26208884.2121; val_kl_reg_loss: 73557.4658; val_edge_recon_loss: 2829409.1250; val_gene_expr_recon_loss: 22060762.2500; val_masked_gp_l1_reg_loss: 120882.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37483.8633; val_chrom_access_recon_loss: 1058794.5469; val_global_loss: 26180889.7500; val_optim_loss: 26180889.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9441; val_auprc_score: 0.9249; val_best_acc_score: 0.8850; val_best_f1_score: 0.8886; train_kl_reg_loss: 104774.9696; train_edge_recon_loss: 2748924.4356; train_gene_expr_recon_loss: 22068917.9091; train_masked_gp_l1_reg_loss: 121139.1911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37407.6901; train_chrom_access_recon_loss: 1074872.3049; train_global_loss: 26156036.5758; train_optim_loss: 26156036.5758; val_kl_reg_loss: 76295.6211; val_edge_recon_loss: 2783048.1250; val_gene_expr_recon_loss: 22151473.7500; val_masked_gp_l1_reg_loss: 121500.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37331.5820; val_chrom_access_recon_loss: 1073728.4688; val_global_loss: 26243377.7500; val_optim_loss: 26243377.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9410; val_auprc_score: 0.9204; val_best_acc_score: 0.8837; val_best_f1_score: 0.8883; train_kl_reg_loss: 102266.9121; train_edge_recon_loss: 2746732.8674; train_gene_expr_recon_loss: 22033042.0606; train_masked_gp_l1_reg_loss: 121757.8279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37315.0949; train_chrom_access_recon_loss: 1073024.9034; train_global_loss: 26114139.7576; train_optim_loss: 26114139.7576; val_kl_reg_loss: 76533.7139; val_edge_recon_loss: 2790695.8438; val_gene_expr_recon_loss: 22038219.0000; val_masked_gp_l1_reg_loss: 122096.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37246.4844; val_chrom_access_recon_loss: 1063131.0156; val_global_loss: 26127921.7500; val_optim_loss: 26127921.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9454; val_auprc_score: 0.9282; val_best_acc_score: 0.8845; val_best_f1_score: 0.8916; train_kl_reg_loss: 101397.0509; train_edge_recon_loss: 2752057.7955; train_gene_expr_recon_loss: 21959840.0909; train_masked_gp_l1_reg_loss: 122242.4026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37211.8633; train_chrom_access_recon_loss: 1070310.7756; train_global_loss: 26043059.9697; train_optim_loss: 26043059.9697; val_kl_reg_loss: 77175.1846; val_edge_recon_loss: 2776597.4375; val_gene_expr_recon_loss: 21812537.2500; val_masked_gp_l1_reg_loss: 122480.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37090.1836; val_chrom_access_recon_loss: 1054040.5625; val_global_loss: 25879920.2500; val_optim_loss: 25879920.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9439; val_auprc_score: 0.9216; val_best_acc_score: 0.8893; val_best_f1_score: 0.8937; train_kl_reg_loss: 97900.0449; train_edge_recon_loss: 2738833.8447; train_gene_expr_recon_loss: 21917232.9394; train_masked_gp_l1_reg_loss: 122676.6306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37046.9864; train_chrom_access_recon_loss: 1068686.7093; train_global_loss: 25982377.0303; train_optim_loss: 25982377.0303; val_kl_reg_loss: 77640.4219; val_edge_recon_loss: 2770860.8125; val_gene_expr_recon_loss: 22054817.0000; val_masked_gp_l1_reg_loss: 123122.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37002.2500; val_chrom_access_recon_loss: 1053611.2656; val_global_loss: 26117053.5000; val_optim_loss: 26117053.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9444; val_auprc_score: 0.9200; val_best_acc_score: 0.8893; val_best_f1_score: 0.8945; train_kl_reg_loss: 96477.4698; train_edge_recon_loss: 2730096.0189; train_gene_expr_recon_loss: 21875353.1515; train_masked_gp_l1_reg_loss: 123358.9317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36989.2744; train_chrom_access_recon_loss: 1067733.4309; train_global_loss: 25930008.3939; train_optim_loss: 25930008.3939; val_kl_reg_loss: 78677.2090; val_edge_recon_loss: 2757784.8125; val_gene_expr_recon_loss: 21865017.2500; val_masked_gp_l1_reg_loss: 123634.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37007.1406; val_chrom_access_recon_loss: 1059748.5859; val_global_loss: 25921869.7500; val_optim_loss: 25921869.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9454; val_auprc_score: 0.9261; val_best_acc_score: 0.8909; val_best_f1_score: 0.8958; train_kl_reg_loss: 94892.3250; train_edge_recon_loss: 2720060.0568; train_gene_expr_recon_loss: 21844866.0606; train_masked_gp_l1_reg_loss: 123847.6140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36962.7163; train_chrom_access_recon_loss: 1066354.4867; train_global_loss: 25886983.1818; train_optim_loss: 25886983.1818; val_kl_reg_loss: 79600.3682; val_edge_recon_loss: 2750322.3750; val_gene_expr_recon_loss: 21708911.5000; val_masked_gp_l1_reg_loss: 124081.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36811.6211; val_chrom_access_recon_loss: 1055288.5547; val_global_loss: 25755017.0000; val_optim_loss: 25755017.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9475; val_auprc_score: 0.9271; val_best_acc_score: 0.8912; val_best_f1_score: 0.8970; train_kl_reg_loss: 94521.8900; train_edge_recon_loss: 2721673.4015; train_gene_expr_recon_loss: 21814515.0909; train_masked_gp_l1_reg_loss: 124222.1946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36762.3088; train_chrom_access_recon_loss: 1063930.1960; train_global_loss: 25855624.9091; train_optim_loss: 25855624.9091; val_kl_reg_loss: 82315.2305; val_edge_recon_loss: 2770679.1250; val_gene_expr_recon_loss: 21947861.2500; val_masked_gp_l1_reg_loss: 124456.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36708.5820; val_chrom_access_recon_loss: 1058041.3750; val_global_loss: 26020061.0000; val_optim_loss: 26020061.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9426; val_auprc_score: 0.9252; val_best_acc_score: 0.8837; val_best_f1_score: 0.8912; train_kl_reg_loss: 91441.1095; train_edge_recon_loss: 2732908.6174; train_gene_expr_recon_loss: 21769555.8485; train_masked_gp_l1_reg_loss: 124639.1851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36771.7388; train_chrom_access_recon_loss: 1061736.3134; train_global_loss: 25817052.8485; train_optim_loss: 25817052.8485; val_kl_reg_loss: 80191.2939; val_edge_recon_loss: 2787079.0000; val_gene_expr_recon_loss: 21880798.0000; val_masked_gp_l1_reg_loss: 124833.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36582.2031; val_chrom_access_recon_loss: 1068009.8203; val_global_loss: 25977494.7500; val_optim_loss: 25977494.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9520; val_auprc_score: 0.9330; val_best_acc_score: 0.8963; val_best_f1_score: 0.9002; train_kl_reg_loss: 90803.6873; train_edge_recon_loss: 2730440.6629; train_gene_expr_recon_loss: 21754890.3636; train_masked_gp_l1_reg_loss: 125022.4660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36562.7692; train_chrom_access_recon_loss: 1060643.2576; train_global_loss: 25798363.3333; train_optim_loss: 25798363.3333; val_kl_reg_loss: 81076.5156; val_edge_recon_loss: 2742869.3750; val_gene_expr_recon_loss: 21754140.0000; val_masked_gp_l1_reg_loss: 125250.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36409.3555; val_chrom_access_recon_loss: 1048975.2578; val_global_loss: 25788721.2500; val_optim_loss: 25788721.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9556; val_auprc_score: 0.9393; val_best_acc_score: 0.9073; val_best_f1_score: 0.9086; train_kl_reg_loss: 90073.4035; train_edge_recon_loss: 2720988.7803; train_gene_expr_recon_loss: 21719600.2727; train_masked_gp_l1_reg_loss: 125365.4583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36383.2287; train_chrom_access_recon_loss: 1059384.6638; train_global_loss: 25751795.7576; train_optim_loss: 25751795.7576; val_kl_reg_loss: 81330.6465; val_edge_recon_loss: 2710065.9688; val_gene_expr_recon_loss: 21793965.2500; val_masked_gp_l1_reg_loss: 125520.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36326.8281; val_chrom_access_recon_loss: 1056874.1797; val_global_loss: 25804082.7500; val_optim_loss: 25804082.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9507; val_auprc_score: 0.9316; val_best_acc_score: 0.8952; val_best_f1_score: 0.8999; train_kl_reg_loss: 89367.3306; train_edge_recon_loss: 2719343.1212; train_gene_expr_recon_loss: 21691628.6061; train_masked_gp_l1_reg_loss: 124819.4297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33872.3619; train_chrom_access_recon_loss: 1058644.7320; train_global_loss: 25717675.5758; train_optim_loss: 25717675.5758; val_kl_reg_loss: 81874.7363; val_edge_recon_loss: 2740775.8750; val_gene_expr_recon_loss: 21612634.5000; val_masked_gp_l1_reg_loss: 124424.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33188.5625; val_chrom_access_recon_loss: 1054908.0312; val_global_loss: 25647805.2500; val_optim_loss: 25647805.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9475; val_auprc_score: 0.9269; val_best_acc_score: 0.8952; val_best_f1_score: 0.8998; train_kl_reg_loss: 89864.0034; train_edge_recon_loss: 2712866.6364; train_gene_expr_recon_loss: 21688592.6970; train_masked_gp_l1_reg_loss: 124290.3965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33001.6383; train_chrom_access_recon_loss: 1058371.4195; train_global_loss: 25706986.7273; train_optim_loss: 25706986.7273; val_kl_reg_loss: 82845.2383; val_edge_recon_loss: 2762733.3438; val_gene_expr_recon_loss: 21785840.0000; val_masked_gp_l1_reg_loss: 124201.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32841.1328; val_chrom_access_recon_loss: 1058319.4531; val_global_loss: 25846782.7500; val_optim_loss: 25846782.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9543; val_auprc_score: 0.9376; val_best_acc_score: 0.9038; val_best_f1_score: 0.9074; train_kl_reg_loss: 90576.4144; train_edge_recon_loss: 2717699.6023; train_gene_expr_recon_loss: 21681673.7576; train_masked_gp_l1_reg_loss: 124159.2749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32729.1008; train_chrom_access_recon_loss: 1057810.6903; train_global_loss: 25704648.9091; train_optim_loss: 25704648.9091; val_kl_reg_loss: 83127.3682; val_edge_recon_loss: 2713605.2812; val_gene_expr_recon_loss: 21854526.5000; val_masked_gp_l1_reg_loss: 124124.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32603.2891; val_chrom_access_recon_loss: 1055445.0000; val_global_loss: 25863432.0000; val_optim_loss: 25863432.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9555; val_auprc_score: 0.9378; val_best_acc_score: 0.9014; val_best_f1_score: 0.9043; train_kl_reg_loss: 90461.7406; train_edge_recon_loss: 2718823.0644; train_gene_expr_recon_loss: 21682084.0909; train_masked_gp_l1_reg_loss: 124112.8189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32539.3470; train_chrom_access_recon_loss: 1057953.1080; train_global_loss: 25705973.9697; train_optim_loss: 25705973.9697; val_kl_reg_loss: 83073.4102; val_edge_recon_loss: 2746325.3125; val_gene_expr_recon_loss: 21573040.5000; val_masked_gp_l1_reg_loss: 124101.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32454.4375; val_chrom_access_recon_loss: 1045415.4453; val_global_loss: 25604410.2500; val_optim_loss: 25604410.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9516; val_auprc_score: 0.9288; val_best_acc_score: 0.9041; val_best_f1_score: 0.9069; train_kl_reg_loss: 90347.2089; train_edge_recon_loss: 2709886.4470; train_gene_expr_recon_loss: 21672564.8788; train_masked_gp_l1_reg_loss: 124103.0130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32402.0875; train_chrom_access_recon_loss: 1057933.4044; train_global_loss: 25687237.2121; train_optim_loss: 25687237.2121; val_kl_reg_loss: 82468.0469; val_edge_recon_loss: 2734941.5000; val_gene_expr_recon_loss: 21764713.2500; val_masked_gp_l1_reg_loss: 124103.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32329.4473; val_chrom_access_recon_loss: 1054011.4297; val_global_loss: 25792568.2500; val_optim_loss: 25792568.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9506; val_auprc_score: 0.9339; val_best_acc_score: 0.8990; val_best_f1_score: 0.9022; train_kl_reg_loss: 89998.1779; train_edge_recon_loss: 2708421.6705; train_gene_expr_recon_loss: 21676923.2727; train_masked_gp_l1_reg_loss: 124108.0438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32276.4786; train_chrom_access_recon_loss: 1057589.1259; train_global_loss: 25689316.9697; train_optim_loss: 25689316.9697; val_kl_reg_loss: 83064.6660; val_edge_recon_loss: 2738820.3750; val_gene_expr_recon_loss: 21854651.7500; val_masked_gp_l1_reg_loss: 124113.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32219.0156; val_chrom_access_recon_loss: 1045858.3594; val_global_loss: 25878729.0000; val_optim_loss: 25878729.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9510; val_auprc_score: 0.9295; val_best_acc_score: 0.8984; val_best_f1_score: 0.9029; train_kl_reg_loss: 90671.8616; train_edge_recon_loss: 2706785.4432; train_gene_expr_recon_loss: 21657920.0303; train_masked_gp_l1_reg_loss: 124124.2744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32180.4097; train_chrom_access_recon_loss: 1057096.8002; train_global_loss: 25668778.5455; train_optim_loss: 25668778.5455; val_kl_reg_loss: 84023.0967; val_edge_recon_loss: 2734049.4688; val_gene_expr_recon_loss: 21897144.7500; val_masked_gp_l1_reg_loss: 124126.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32121.7539; val_chrom_access_recon_loss: 1061937.0859; val_global_loss: 25933402.7500; val_optim_loss: 25933402.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9519; val_auprc_score: 0.9344; val_best_acc_score: 0.9044; val_best_f1_score: 0.9073; train_kl_reg_loss: 90684.0217; train_edge_recon_loss: 2703818.0492; train_gene_expr_recon_loss: 21671098.7576; train_masked_gp_l1_reg_loss: 124143.5163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32090.7019; train_chrom_access_recon_loss: 1057657.6089; train_global_loss: 25679492.6364; train_optim_loss: 25679492.6364; val_kl_reg_loss: 84153.0879; val_edge_recon_loss: 2724364.4062; val_gene_expr_recon_loss: 21750325.0000; val_masked_gp_l1_reg_loss: 124152.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32036.9375; val_chrom_access_recon_loss: 1049831.8750; val_global_loss: 25764862.0000; val_optim_loss: 25764862.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9535; val_auprc_score: 0.9357; val_best_acc_score: 0.8992; val_best_f1_score: 0.9023; train_kl_reg_loss: 91185.1278; train_edge_recon_loss: 2718302.9091; train_gene_expr_recon_loss: 21669383.6061; train_masked_gp_l1_reg_loss: 124085.1957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31777.1275; train_chrom_access_recon_loss: 1058546.7301; train_global_loss: 25693280.6061; train_optim_loss: 25693280.6061; val_kl_reg_loss: 84032.9004; val_edge_recon_loss: 2758780.0312; val_gene_expr_recon_loss: 21720902.0000; val_masked_gp_l1_reg_loss: 124041.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31713.1992; val_chrom_access_recon_loss: 1049047.6562; val_global_loss: 25768518.5000; val_optim_loss: 25768518.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9509; val_auprc_score: 0.9342; val_best_acc_score: 0.9001; val_best_f1_score: 0.9041; train_kl_reg_loss: 90916.2494; train_edge_recon_loss: 2712668.5871; train_gene_expr_recon_loss: 21662124.7576; train_masked_gp_l1_reg_loss: 124023.5838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31696.1870; train_chrom_access_recon_loss: 1056797.2225; train_global_loss: 25678226.6667; train_optim_loss: 25678226.6667; val_kl_reg_loss: 83523.7383; val_edge_recon_loss: 2750238.9375; val_gene_expr_recon_loss: 21577478.2500; val_masked_gp_l1_reg_loss: 124004.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31680.6953; val_chrom_access_recon_loss: 1048445.1016; val_global_loss: 25615369.7500; val_optim_loss: 25615369.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9542; val_auprc_score: 0.9387; val_best_acc_score: 0.8998; val_best_f1_score: 0.9031; train_kl_reg_loss: 90922.0297; train_edge_recon_loss: 2707218.0076; train_gene_expr_recon_loss: 21661359.4848; train_masked_gp_l1_reg_loss: 123998.3621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31669.6425; train_chrom_access_recon_loss: 1057577.1089; train_global_loss: 25672744.3939; train_optim_loss: 25672744.3939; val_kl_reg_loss: 83766.8164; val_edge_recon_loss: 2721254.2812; val_gene_expr_recon_loss: 21679233.0000; val_masked_gp_l1_reg_loss: 123989.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31656.5742; val_chrom_access_recon_loss: 1049555.8594; val_global_loss: 25689456.2500; val_optim_loss: 25689456.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9551; val_auprc_score: 0.9403; val_best_acc_score: 0.9044; val_best_f1_score: 0.9070; train_kl_reg_loss: 90810.5065; train_edge_recon_loss: 2706775.9356; train_gene_expr_recon_loss: 21657736.3030; train_masked_gp_l1_reg_loss: 123985.4989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31647.9816; train_chrom_access_recon_loss: 1057804.7235; train_global_loss: 25668760.7879; train_optim_loss: 25668760.7879; val_kl_reg_loss: 83677.1523; val_edge_recon_loss: 2754980.7500; val_gene_expr_recon_loss: 21653929.2500; val_masked_gp_l1_reg_loss: 123980.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31638.1836; val_chrom_access_recon_loss: 1047645.1328; val_global_loss: 25695850.7500; val_optim_loss: 25695850.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 6 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9499
val AUPRC score: 0.9342
val best accuracy score: 0.8963
val best F1 score: 0.8994
val target rna MSE score: 0.8770
val source rna MSE score: 0.2624
val target atac MSE score: 0.4812
val source atac MSE score: 0.1057
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
