[True]
Run timestamp: 09102023_220633_54.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_54']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7568; val_auprc_score: 0.7849; val_best_acc_score: 0.5632; val_best_f1_score: 0.6895; train_kl_reg_loss: 43206.3859; train_edge_recon_loss: 3514151.4695; train_gene_expr_recon_loss: 13578992.6489; train_masked_gp_l1_reg_loss: 90638.4271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2010465.2090; train_chrom_access_recon_loss: 6762708.8626; train_global_loss: 26000163.1450; train_optim_loss: 26000163.1450; val_kl_reg_loss: 56107.1372; val_edge_recon_loss: 4061603.9833; val_gene_expr_recon_loss: 12937444.7333; val_masked_gp_l1_reg_loss: 88069.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 523575.5938; val_chrom_access_recon_loss: 6554668.4667; val_global_loss: 24221470.1333; val_optim_loss: 24221470.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8037; val_auprc_score: 0.8285; val_best_acc_score: 0.6333; val_best_f1_score: 0.7172; train_kl_reg_loss: 70344.3750; train_edge_recon_loss: 3495223.1737; train_gene_expr_recon_loss: 12618819.5496; train_masked_gp_l1_reg_loss: 84463.7601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 277724.1716; train_chrom_access_recon_loss: 6482088.9008; train_global_loss: 23028663.8168; train_optim_loss: 23028663.8168; val_kl_reg_loss: 73336.6484; val_edge_recon_loss: 4056714.2333; val_gene_expr_recon_loss: 12519163.5333; val_masked_gp_l1_reg_loss: 82684.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158489.9062; val_chrom_access_recon_loss: 6432107.5333; val_global_loss: 23322496.2667; val_optim_loss: 23322496.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8671; val_auprc_score: 0.8651; val_best_acc_score: 0.7751; val_best_f1_score: 0.7961; train_kl_reg_loss: 60612.1330; train_edge_recon_loss: 3383386.3626; train_gene_expr_recon_loss: 12429356.3206; train_masked_gp_l1_reg_loss: 86150.3197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125243.3074; train_chrom_access_recon_loss: 6391369.5954; train_global_loss: 22476118.0000; train_optim_loss: 22476118.0000; val_kl_reg_loss: 64286.0599; val_edge_recon_loss: 3070216.2000; val_gene_expr_recon_loss: 12454065.4000; val_masked_gp_l1_reg_loss: 100100.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108206.0391; val_chrom_access_recon_loss: 6385676.3000; val_global_loss: 22182551.3333; val_optim_loss: 22182551.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8741; val_auprc_score: 0.8707; val_best_acc_score: 0.7681; val_best_f1_score: 0.7889; train_kl_reg_loss: 80712.6543; train_edge_recon_loss: 2972507.9752; train_gene_expr_recon_loss: 12295262.3435; train_masked_gp_l1_reg_loss: 101701.8864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97023.9652; train_chrom_access_recon_loss: 6328080.7443; train_global_loss: 21875289.5420; train_optim_loss: 21875289.5420; val_kl_reg_loss: 84718.2688; val_edge_recon_loss: 2992062.0000; val_gene_expr_recon_loss: 12279359.3333; val_masked_gp_l1_reg_loss: 102289.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88493.4844; val_chrom_access_recon_loss: 6306093.5667; val_global_loss: 21853015.4667; val_optim_loss: 21853015.4667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9065; val_auprc_score: 0.8953; val_best_acc_score: 0.8309; val_best_f1_score: 0.8386; train_kl_reg_loss: 84508.1215; train_edge_recon_loss: 2917767.2977; train_gene_expr_recon_loss: 12158959.4656; train_masked_gp_l1_reg_loss: 103018.1918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83928.9866; train_chrom_access_recon_loss: 6274026.0916; train_global_loss: 21622208.1679; train_optim_loss: 21622208.1679; val_kl_reg_loss: 79120.0802; val_edge_recon_loss: 2912886.1167; val_gene_expr_recon_loss: 12101888.0000; val_masked_gp_l1_reg_loss: 103580.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80139.3125; val_chrom_access_recon_loss: 6226643.0667; val_global_loss: 21504257.2000; val_optim_loss: 21504257.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9241; val_auprc_score: 0.9078; val_best_acc_score: 0.8588; val_best_f1_score: 0.8676; train_kl_reg_loss: 85327.1960; train_edge_recon_loss: 2842231.6069; train_gene_expr_recon_loss: 12046693.5649; train_masked_gp_l1_reg_loss: 104453.5216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77958.4600; train_chrom_access_recon_loss: 6218710.8244; train_global_loss: 21375375.1908; train_optim_loss: 21375375.1908; val_kl_reg_loss: 91175.2198; val_edge_recon_loss: 2813071.4500; val_gene_expr_recon_loss: 12040517.3333; val_masked_gp_l1_reg_loss: 105141.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75836.0859; val_chrom_access_recon_loss: 6197589.2667; val_global_loss: 21323330.2667; val_optim_loss: 21323330.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9297; val_auprc_score: 0.9166; val_best_acc_score: 0.8619; val_best_f1_score: 0.8699; train_kl_reg_loss: 90061.7021; train_edge_recon_loss: 2804992.4179; train_gene_expr_recon_loss: 11947581.8550; train_masked_gp_l1_reg_loss: 105278.1958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74175.4309; train_chrom_access_recon_loss: 6172525.7595; train_global_loss: 21194615.2214; train_optim_loss: 21194615.2214; val_kl_reg_loss: 90112.2427; val_edge_recon_loss: 2812089.9667; val_gene_expr_recon_loss: 11927218.2667; val_masked_gp_l1_reg_loss: 105530.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72318.9766; val_chrom_access_recon_loss: 6167829.6000; val_global_loss: 21175100.1333; val_optim_loss: 21175100.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9342; val_auprc_score: 0.9193; val_best_acc_score: 0.8708; val_best_f1_score: 0.8749; train_kl_reg_loss: 87023.7856; train_edge_recon_loss: 2785555.1508; train_gene_expr_recon_loss: 11880816.7328; train_masked_gp_l1_reg_loss: 105743.5252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70638.3872; train_chrom_access_recon_loss: 6142291.0229; train_global_loss: 21072068.6870; train_optim_loss: 21072068.6870; val_kl_reg_loss: 82013.8391; val_edge_recon_loss: 2775712.8167; val_gene_expr_recon_loss: 11866328.1333; val_masked_gp_l1_reg_loss: 106126.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69379.8359; val_chrom_access_recon_loss: 6107856.5667; val_global_loss: 21007418.5333; val_optim_loss: 21007418.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9321; val_auprc_score: 0.9183; val_best_acc_score: 0.8650; val_best_f1_score: 0.8727; train_kl_reg_loss: 85306.4746; train_edge_recon_loss: 2779163.6393; train_gene_expr_recon_loss: 11811267.2137; train_masked_gp_l1_reg_loss: 106288.1812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68011.4149; train_chrom_access_recon_loss: 6105534.5992; train_global_loss: 20955571.7557; train_optim_loss: 20955571.7557; val_kl_reg_loss: 84847.9990; val_edge_recon_loss: 2793949.4833; val_gene_expr_recon_loss: 11868549.8000; val_masked_gp_l1_reg_loss: 106689.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67012.0000; val_chrom_access_recon_loss: 6126387.3333; val_global_loss: 21047437.0667; val_optim_loss: 21047437.0667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9390; val_auprc_score: 0.9271; val_best_acc_score: 0.8770; val_best_f1_score: 0.8821; train_kl_reg_loss: 82402.4065; train_edge_recon_loss: 2768010.1031; train_gene_expr_recon_loss: 11766252.1908; train_masked_gp_l1_reg_loss: 106669.5084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66107.2952; train_chrom_access_recon_loss: 6085803.1603; train_global_loss: 20875244.7481; train_optim_loss: 20875244.7481; val_kl_reg_loss: 81277.6094; val_edge_recon_loss: 2766869.4333; val_gene_expr_recon_loss: 11817769.8000; val_masked_gp_l1_reg_loss: 107173.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65529.5508; val_chrom_access_recon_loss: 6103338.2667; val_global_loss: 20941958.0000; val_optim_loss: 20941958.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9372; val_auprc_score: 0.9222; val_best_acc_score: 0.8725; val_best_f1_score: 0.8805; train_kl_reg_loss: 81866.2574; train_edge_recon_loss: 2765264.5649; train_gene_expr_recon_loss: 11709896.6565; train_masked_gp_l1_reg_loss: 107066.8859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64863.5327; train_chrom_access_recon_loss: 6046866.0420; train_global_loss: 20775823.9237; train_optim_loss: 20775823.9237; val_kl_reg_loss: 81239.3927; val_edge_recon_loss: 2759857.7167; val_gene_expr_recon_loss: 11749722.2667; val_masked_gp_l1_reg_loss: 107554.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64055.0430; val_chrom_access_recon_loss: 6044899.9333; val_global_loss: 20807329.6000; val_optim_loss: 20807329.6000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9413; val_auprc_score: 0.9298; val_best_acc_score: 0.8742; val_best_f1_score: 0.8781; train_kl_reg_loss: 81398.6274; train_edge_recon_loss: 2748922.2615; train_gene_expr_recon_loss: 11667776.7939; train_masked_gp_l1_reg_loss: 107482.9428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63809.2436; train_chrom_access_recon_loss: 6031953.4809; train_global_loss: 20701343.2824; train_optim_loss: 20701343.2824; val_kl_reg_loss: 80900.5469; val_edge_recon_loss: 2753479.3667; val_gene_expr_recon_loss: 11716558.1333; val_masked_gp_l1_reg_loss: 107477.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63084.1719; val_chrom_access_recon_loss: 6058004.6667; val_global_loss: 20779504.5333; val_optim_loss: 20779504.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9392; val_auprc_score: 0.9236; val_best_acc_score: 0.8763; val_best_f1_score: 0.8826; train_kl_reg_loss: 79896.1193; train_edge_recon_loss: 2746470.3855; train_gene_expr_recon_loss: 11627970.8779; train_masked_gp_l1_reg_loss: 107600.5081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63219.2460; train_chrom_access_recon_loss: 6006605.4313; train_global_loss: 20631762.6412; train_optim_loss: 20631762.6412; val_kl_reg_loss: 80834.4359; val_edge_recon_loss: 2752126.0333; val_gene_expr_recon_loss: 11624822.8667; val_masked_gp_l1_reg_loss: 107808.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62949.3359; val_chrom_access_recon_loss: 5985729.1000; val_global_loss: 20614270.1333; val_optim_loss: 20614270.1333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9425; val_auprc_score: 0.9296; val_best_acc_score: 0.8748; val_best_f1_score: 0.8811; train_kl_reg_loss: 79820.4296; train_edge_recon_loss: 2738537.1164; train_gene_expr_recon_loss: 11586371.5191; train_masked_gp_l1_reg_loss: 107902.6675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62827.0443; train_chrom_access_recon_loss: 5980928.9924; train_global_loss: 20556387.7099; train_optim_loss: 20556387.7099; val_kl_reg_loss: 80619.7214; val_edge_recon_loss: 2751064.3167; val_gene_expr_recon_loss: 11621942.5333; val_masked_gp_l1_reg_loss: 108060.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62874.0156; val_chrom_access_recon_loss: 5987064.2667; val_global_loss: 20611625.8667; val_optim_loss: 20611625.8667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9465; val_auprc_score: 0.9328; val_best_acc_score: 0.8855; val_best_f1_score: 0.8896; train_kl_reg_loss: 78974.6740; train_edge_recon_loss: 2737163.4218; train_gene_expr_recon_loss: 11544186.6870; train_masked_gp_l1_reg_loss: 107895.7211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63006.2129; train_chrom_access_recon_loss: 5958109.3588; train_global_loss: 20489336.1069; train_optim_loss: 20489336.1069; val_kl_reg_loss: 76869.9693; val_edge_recon_loss: 2750089.8833; val_gene_expr_recon_loss: 11602804.6667; val_masked_gp_l1_reg_loss: 107940.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62969.0977; val_chrom_access_recon_loss: 5977451.4333; val_global_loss: 20578125.0667; val_optim_loss: 20578125.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9493; val_auprc_score: 0.9361; val_best_acc_score: 0.8891; val_best_f1_score: 0.8932; train_kl_reg_loss: 78145.0857; train_edge_recon_loss: 2730085.7939; train_gene_expr_recon_loss: 11514081.9237; train_masked_gp_l1_reg_loss: 108050.5078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62917.7365; train_chrom_access_recon_loss: 5943634.9924; train_global_loss: 20436916.0458; train_optim_loss: 20436916.0458; val_kl_reg_loss: 76684.2802; val_edge_recon_loss: 2729959.9333; val_gene_expr_recon_loss: 11543139.7333; val_masked_gp_l1_reg_loss: 108246.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63452.2812; val_chrom_access_recon_loss: 5956510.6333; val_global_loss: 20477992.4000; val_optim_loss: 20477992.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9504; val_auprc_score: 0.9379; val_best_acc_score: 0.8888; val_best_f1_score: 0.8934; train_kl_reg_loss: 76596.3973; train_edge_recon_loss: 2731796.2271; train_gene_expr_recon_loss: 11479260.4122; train_masked_gp_l1_reg_loss: 108473.6307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63380.6509; train_chrom_access_recon_loss: 5919797.3206; train_global_loss: 20379304.6718; train_optim_loss: 20379304.6718; val_kl_reg_loss: 74616.4458; val_edge_recon_loss: 2746151.6000; val_gene_expr_recon_loss: 11539639.2000; val_masked_gp_l1_reg_loss: 108426.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63128.3008; val_chrom_access_recon_loss: 5945002.1667; val_global_loss: 20476964.0000; val_optim_loss: 20476964.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9504; val_auprc_score: 0.9367; val_best_acc_score: 0.8929; val_best_f1_score: 0.8962; train_kl_reg_loss: 76992.1781; train_edge_recon_loss: 2727223.3740; train_gene_expr_recon_loss: 11449648.1679; train_masked_gp_l1_reg_loss: 108368.1731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63322.6854; train_chrom_access_recon_loss: 5907319.5916; train_global_loss: 20332874.1527; train_optim_loss: 20332874.1527; val_kl_reg_loss: 76726.2870; val_edge_recon_loss: 2750630.6500; val_gene_expr_recon_loss: 11496277.8667; val_masked_gp_l1_reg_loss: 108669.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63601.7227; val_chrom_access_recon_loss: 5898089.4333; val_global_loss: 20393995.3333; val_optim_loss: 20393995.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9531; val_auprc_score: 0.9413; val_best_acc_score: 0.8957; val_best_f1_score: 0.8997; train_kl_reg_loss: 76231.1409; train_edge_recon_loss: 2715028.7252; train_gene_expr_recon_loss: 11440338.8168; train_masked_gp_l1_reg_loss: 108471.4167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63549.9694; train_chrom_access_recon_loss: 5897635.4466; train_global_loss: 20301255.4962; train_optim_loss: 20301255.4962; val_kl_reg_loss: 76946.8448; val_edge_recon_loss: 2726893.1667; val_gene_expr_recon_loss: 11509765.7333; val_masked_gp_l1_reg_loss: 108544.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63046.8203; val_chrom_access_recon_loss: 5903498.1333; val_global_loss: 20388694.6667; val_optim_loss: 20388694.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9568; val_auprc_score: 0.9460; val_best_acc_score: 0.8983; val_best_f1_score: 0.9027; train_kl_reg_loss: 75122.6363; train_edge_recon_loss: 2713187.5382; train_gene_expr_recon_loss: 11408576.3588; train_masked_gp_l1_reg_loss: 108448.7200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63155.2309; train_chrom_access_recon_loss: 5876793.2214; train_global_loss: 20245283.6947; train_optim_loss: 20245283.6947; val_kl_reg_loss: 77179.1115; val_edge_recon_loss: 2735569.4167; val_gene_expr_recon_loss: 11533826.0000; val_masked_gp_l1_reg_loss: 108818.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63644.4531; val_chrom_access_recon_loss: 5913331.7667; val_global_loss: 20432369.0667; val_optim_loss: 20432369.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9572; val_auprc_score: 0.9411; val_best_acc_score: 0.9046; val_best_f1_score: 0.9086; train_kl_reg_loss: 74992.2709; train_edge_recon_loss: 2715085.8073; train_gene_expr_recon_loss: 11387430.6183; train_masked_gp_l1_reg_loss: 108520.7282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63034.5369; train_chrom_access_recon_loss: 5860571.6565; train_global_loss: 20209635.6031; train_optim_loss: 20209635.6031; val_kl_reg_loss: 75069.2104; val_edge_recon_loss: 2701122.2833; val_gene_expr_recon_loss: 11386403.0667; val_masked_gp_l1_reg_loss: 108579.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63124.9219; val_chrom_access_recon_loss: 5876894.1667; val_global_loss: 20211193.8667; val_optim_loss: 20211193.8667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9588; val_auprc_score: 0.9473; val_best_acc_score: 0.9034; val_best_f1_score: 0.9085; train_kl_reg_loss: 75797.1538; train_edge_recon_loss: 2712123.3931; train_gene_expr_recon_loss: 11374374.1221; train_masked_gp_l1_reg_loss: 108422.6048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62701.3239; train_chrom_access_recon_loss: 5853642.2748; train_global_loss: 20187060.7939; train_optim_loss: 20187060.7939; val_kl_reg_loss: 72886.6443; val_edge_recon_loss: 2717832.5833; val_gene_expr_recon_loss: 11435602.4667; val_masked_gp_l1_reg_loss: 108492.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62857.2969; val_chrom_access_recon_loss: 5878565.1667; val_global_loss: 20276236.0000; val_optim_loss: 20276236.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9623; val_auprc_score: 0.9525; val_best_acc_score: 0.9020; val_best_f1_score: 0.9050; train_kl_reg_loss: 74643.8157; train_edge_recon_loss: 2703856.7366; train_gene_expr_recon_loss: 11350925.4351; train_masked_gp_l1_reg_loss: 108355.6112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62398.4673; train_chrom_access_recon_loss: 5838670.9008; train_global_loss: 20138850.9466; train_optim_loss: 20138850.9466; val_kl_reg_loss: 76001.4193; val_edge_recon_loss: 2707706.1333; val_gene_expr_recon_loss: 11389477.6000; val_masked_gp_l1_reg_loss: 108434.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62167.8320; val_chrom_access_recon_loss: 5879943.9000; val_global_loss: 20223730.9333; val_optim_loss: 20223730.9333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9639; val_auprc_score: 0.9537; val_best_acc_score: 0.9089; val_best_f1_score: 0.9129; train_kl_reg_loss: 73581.1850; train_edge_recon_loss: 2700751.1279; train_gene_expr_recon_loss: 11337531.3740; train_masked_gp_l1_reg_loss: 108470.5656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62104.1233; train_chrom_access_recon_loss: 5829259.6527; train_global_loss: 20111698.0305; train_optim_loss: 20111698.0305; val_kl_reg_loss: 74558.0891; val_edge_recon_loss: 2708137.4667; val_gene_expr_recon_loss: 11405560.4000; val_masked_gp_l1_reg_loss: 108741.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62069.6055; val_chrom_access_recon_loss: 5852667.9667; val_global_loss: 20211735.8667; val_optim_loss: 20211735.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9646; val_auprc_score: 0.9532; val_best_acc_score: 0.9127; val_best_f1_score: 0.9159; train_kl_reg_loss: 75134.1989; train_edge_recon_loss: 2702908.4008; train_gene_expr_recon_loss: 11328621.7786; train_masked_gp_l1_reg_loss: 108328.2969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61868.8016; train_chrom_access_recon_loss: 5829542.8359; train_global_loss: 20106404.2748; train_optim_loss: 20106404.2748; val_kl_reg_loss: 72738.8120; val_edge_recon_loss: 2704414.2167; val_gene_expr_recon_loss: 11417189.4667; val_masked_gp_l1_reg_loss: 108287.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62449.9922; val_chrom_access_recon_loss: 5864114.8667; val_global_loss: 20229194.5333; val_optim_loss: 20229194.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9552; val_auprc_score: 0.9458; val_best_acc_score: 0.8898; val_best_f1_score: 0.8965; train_kl_reg_loss: 87585.5802; train_edge_recon_loss: 2892507.1298; train_gene_expr_recon_loss: 10462569.1221; train_masked_gp_l1_reg_loss: 104612.4956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50008.5815; train_chrom_access_recon_loss: 5527230.3397; train_global_loss: 19124513.1145; train_optim_loss: 19124513.1145; val_kl_reg_loss: 20636.1915; val_edge_recon_loss: 2845881.5833; val_gene_expr_recon_loss: 10457645.0000; val_masked_gp_l1_reg_loss: 103874.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48053.1914; val_chrom_access_recon_loss: 5482951.1667; val_global_loss: 18959042.2667; val_optim_loss: 18959042.2667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9526; val_auprc_score: 0.9421; val_best_acc_score: 0.8902; val_best_f1_score: 0.8953; train_kl_reg_loss: 102739.7713; train_edge_recon_loss: 2824440.9866; train_gene_expr_recon_loss: 10429570.8855; train_masked_gp_l1_reg_loss: 103879.7595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47618.1305; train_chrom_access_recon_loss: 5478620.3015; train_global_loss: 18986869.9389; train_optim_loss: 18986869.9389; val_kl_reg_loss: 23707.9409; val_edge_recon_loss: 2832562.8833; val_gene_expr_recon_loss: 10462979.0000; val_masked_gp_l1_reg_loss: 103882.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47265.7109; val_chrom_access_recon_loss: 5479080.4333; val_global_loss: 18949479.0667; val_optim_loss: 18949479.0667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9515; val_auprc_score: 0.9404; val_best_acc_score: 0.8888; val_best_f1_score: 0.8937; train_kl_reg_loss: 103423.1583; train_edge_recon_loss: 2794980.3206; train_gene_expr_recon_loss: 10419339.3130; train_masked_gp_l1_reg_loss: 103852.1605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47071.6403; train_chrom_access_recon_loss: 5459338.4542; train_global_loss: 18928005.1450; train_optim_loss: 18928005.1450; val_kl_reg_loss: 25223.3870; val_edge_recon_loss: 2811741.8833; val_gene_expr_recon_loss: 10470547.6667; val_masked_gp_l1_reg_loss: 103772.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46911.4336; val_chrom_access_recon_loss: 5471477.9667; val_global_loss: 18929674.8000; val_optim_loss: 18929674.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9514; val_auprc_score: 0.9416; val_best_acc_score: 0.8890; val_best_f1_score: 0.8936; train_kl_reg_loss: 101412.9036; train_edge_recon_loss: 2786125.3836; train_gene_expr_recon_loss: 10408771.7252; train_masked_gp_l1_reg_loss: 103692.1663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46795.2613; train_chrom_access_recon_loss: 5457020.0611; train_global_loss: 18903817.4809; train_optim_loss: 18903817.4809; val_kl_reg_loss: 27150.5392; val_edge_recon_loss: 2799503.2333; val_gene_expr_recon_loss: 10456392.2000; val_masked_gp_l1_reg_loss: 103597.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46613.9219; val_chrom_access_recon_loss: 5448783.9333; val_global_loss: 18882042.0000; val_optim_loss: 18882042.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9503; val_auprc_score: 0.9362; val_best_acc_score: 0.8895; val_best_f1_score: 0.8947; train_kl_reg_loss: 98821.1722; train_edge_recon_loss: 2776463.9218; train_gene_expr_recon_loss: 10402470.4656; train_masked_gp_l1_reg_loss: 103482.6140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46534.5992; train_chrom_access_recon_loss: 5453706.4008; train_global_loss: 18881479.2061; train_optim_loss: 18881479.2061; val_kl_reg_loss: 27538.3641; val_edge_recon_loss: 2784846.1500; val_gene_expr_recon_loss: 10428538.2000; val_masked_gp_l1_reg_loss: 103397.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46420.6328; val_chrom_access_recon_loss: 5457386.0000; val_global_loss: 18848126.9333; val_optim_loss: 18848126.9333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9462; val_auprc_score: 0.9357; val_best_acc_score: 0.8825; val_best_f1_score: 0.8885; train_kl_reg_loss: 94871.0397; train_edge_recon_loss: 2770172.6851; train_gene_expr_recon_loss: 10401821.2137; train_masked_gp_l1_reg_loss: 103255.3208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46359.3786; train_chrom_access_recon_loss: 5446749.6718; train_global_loss: 18863229.4198; train_optim_loss: 18863229.4198; val_kl_reg_loss: 28990.9092; val_edge_recon_loss: 2806589.1167; val_gene_expr_recon_loss: 10427926.9333; val_masked_gp_l1_reg_loss: 103143.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46313.8750; val_chrom_access_recon_loss: 5453106.4333; val_global_loss: 18866070.8000; val_optim_loss: 18866070.8000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9532; val_auprc_score: 0.9404; val_best_acc_score: 0.8907; val_best_f1_score: 0.8942; train_kl_reg_loss: 91517.6106; train_edge_recon_loss: 2757439.9924; train_gene_expr_recon_loss: 10397615.3588; train_masked_gp_l1_reg_loss: 103001.9320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46259.0778; train_chrom_access_recon_loss: 5437789.5115; train_global_loss: 18833623.5573; train_optim_loss: 18833623.5573; val_kl_reg_loss: 30456.1402; val_edge_recon_loss: 2765395.6500; val_gene_expr_recon_loss: 10425125.5333; val_masked_gp_l1_reg_loss: 102865.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46184.6953; val_chrom_access_recon_loss: 5423240.7333; val_global_loss: 18793268.9333; val_optim_loss: 18793268.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9539; val_auprc_score: 0.9445; val_best_acc_score: 0.8929; val_best_f1_score: 0.8979; train_kl_reg_loss: 88370.9661; train_edge_recon_loss: 2750379.4046; train_gene_expr_recon_loss: 10392439.5344; train_masked_gp_l1_reg_loss: 102734.0391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46136.2537; train_chrom_access_recon_loss: 5438972.9924; train_global_loss: 18819033.2366; train_optim_loss: 18819033.2366; val_kl_reg_loss: 31607.2432; val_edge_recon_loss: 2756952.9167; val_gene_expr_recon_loss: 10433166.5333; val_masked_gp_l1_reg_loss: 102592.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46106.5664; val_chrom_access_recon_loss: 5457757.5333; val_global_loss: 18828184.0000; val_optim_loss: 18828184.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9520; val_auprc_score: 0.9406; val_best_acc_score: 0.8929; val_best_f1_score: 0.8962; train_kl_reg_loss: 85545.1604; train_edge_recon_loss: 2739212.7576; train_gene_expr_recon_loss: 10389910.1527; train_masked_gp_l1_reg_loss: 102454.2922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46017.6559; train_chrom_access_recon_loss: 5436161.1527; train_global_loss: 18799301.1298; train_optim_loss: 18799301.1298; val_kl_reg_loss: 32241.6270; val_edge_recon_loss: 2765166.8000; val_gene_expr_recon_loss: 10457086.6000; val_masked_gp_l1_reg_loss: 102300.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45964.3711; val_chrom_access_recon_loss: 5454295.3667; val_global_loss: 18857055.2000; val_optim_loss: 18857055.2000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9537; val_auprc_score: 0.9420; val_best_acc_score: 0.8968; val_best_f1_score: 0.9008; train_kl_reg_loss: 82665.3995; train_edge_recon_loss: 2747661.4160; train_gene_expr_recon_loss: 10399740.9237; train_masked_gp_l1_reg_loss: 102140.5568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45888.8815; train_chrom_access_recon_loss: 5445107.9313; train_global_loss: 18823205.2214; train_optim_loss: 18823205.2214; val_kl_reg_loss: 33475.2585; val_edge_recon_loss: 2752207.0833; val_gene_expr_recon_loss: 10478729.6000; val_masked_gp_l1_reg_loss: 101976.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45806.5938; val_chrom_access_recon_loss: 5467426.3667; val_global_loss: 18879621.2000; val_optim_loss: 18879621.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9519; val_auprc_score: 0.9415; val_best_acc_score: 0.8875; val_best_f1_score: 0.8925; train_kl_reg_loss: 80319.0559; train_edge_recon_loss: 2729485.5229; train_gene_expr_recon_loss: 10384918.4809; train_masked_gp_l1_reg_loss: 101831.8138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45761.3512; train_chrom_access_recon_loss: 5430482.4771; train_global_loss: 18772798.6718; train_optim_loss: 18772798.6718; val_kl_reg_loss: 34382.9630; val_edge_recon_loss: 2777675.9667; val_gene_expr_recon_loss: 10442891.8667; val_masked_gp_l1_reg_loss: 101618.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45634.5508; val_chrom_access_recon_loss: 5452489.6667; val_global_loss: 18854694.8000; val_optim_loss: 18854694.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9531; val_auprc_score: 0.9422; val_best_acc_score: 0.8926; val_best_f1_score: 0.8967; train_kl_reg_loss: 78518.9988; train_edge_recon_loss: 2739693.1756; train_gene_expr_recon_loss: 10384242.0229; train_masked_gp_l1_reg_loss: 101430.8021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44747.1828; train_chrom_access_recon_loss: 5439571.1832; train_global_loss: 18788203.3588; train_optim_loss: 18788203.3588; val_kl_reg_loss: 34410.1724; val_edge_recon_loss: 2760667.1667; val_gene_expr_recon_loss: 10441631.3333; val_masked_gp_l1_reg_loss: 101368.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44629.5859; val_chrom_access_recon_loss: 5440523.9333; val_global_loss: 18823231.4667; val_optim_loss: 18823231.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9574; val_auprc_score: 0.9497; val_best_acc_score: 0.8957; val_best_f1_score: 0.8980; train_kl_reg_loss: 78290.4801; train_edge_recon_loss: 2739577.4046; train_gene_expr_recon_loss: 10380378.0687; train_masked_gp_l1_reg_loss: 101337.2202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44603.0040; train_chrom_access_recon_loss: 5430540.2405; train_global_loss: 18774726.4733; train_optim_loss: 18774726.4733; val_kl_reg_loss: 34888.9810; val_edge_recon_loss: 2750392.0333; val_gene_expr_recon_loss: 10428697.4667; val_masked_gp_l1_reg_loss: 101311.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44579.4102; val_chrom_access_recon_loss: 5458304.3333; val_global_loss: 18818172.4000; val_optim_loss: 18818172.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9571; val_auprc_score: 0.9449; val_best_acc_score: 0.8998; val_best_f1_score: 0.9034; train_kl_reg_loss: 78149.9234; train_edge_recon_loss: 2737699.2118; train_gene_expr_recon_loss: 10384091.7634; train_masked_gp_l1_reg_loss: 101285.7182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44561.2219; train_chrom_access_recon_loss: 5433598.9275; train_global_loss: 18779386.7176; train_optim_loss: 18779386.7176; val_kl_reg_loss: 34786.4500; val_edge_recon_loss: 2740047.8333; val_gene_expr_recon_loss: 10467929.0667; val_masked_gp_l1_reg_loss: 101259.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44541.5234; val_chrom_access_recon_loss: 5479029.1333; val_global_loss: 18867594.5333; val_optim_loss: 18867594.5333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9554; val_auprc_score: 0.9452; val_best_acc_score: 0.8925; val_best_f1_score: 0.8961; train_kl_reg_loss: 78114.7253; train_edge_recon_loss: 2736566.7500; train_gene_expr_recon_loss: 10387739.6641; train_masked_gp_l1_reg_loss: 101239.7681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44530.7459; train_chrom_access_recon_loss: 5438792.7710; train_global_loss: 18786984.5802; train_optim_loss: 18786984.5802; val_kl_reg_loss: 34770.5900; val_edge_recon_loss: 2752567.3500; val_gene_expr_recon_loss: 10435027.6000; val_masked_gp_l1_reg_loss: 101218.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44512.4648; val_chrom_access_recon_loss: 5450231.0333; val_global_loss: 18818326.5333; val_optim_loss: 18818326.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 53 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9516
val AUPRC score: 0.9425
val best accuracy score: 0.8879
val best F1 score: 0.8928
val target rna MSE score: 1.7836
val source rna MSE score: 0.9828
val target atac MSE score: 0.3432
val source atac MSE score: 0.1058
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
