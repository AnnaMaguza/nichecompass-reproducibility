[True]
Run timestamp: 26072023_020418_54.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_54']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8928; val_auprc_score: 0.9031; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7635.3158; train_edge_recon_loss: 355642.2882; train_gene_expr_recon_loss: 31513694.2222; train_masked_gp_l1_reg_loss: 1922.2149; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107718755.5556; train_global_loss: 139597653.3333; train_optim_loss: 139597653.3333; val_kl_reg_loss: 18504.3242; val_edge_recon_loss: 406594.5000; val_gene_expr_recon_loss: 29545894.0000; val_masked_gp_l1_reg_loss: 1995.2915; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 107004296.0000; val_global_loss: 136977280.0000; val_optim_loss: 136977280.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8756; val_auprc_score: 0.8802; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 30482.6890; train_edge_recon_loss: 376699.9340; train_gene_expr_recon_loss: 28431768.2222; train_masked_gp_l1_reg_loss: 2108.3650; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 105548200.0000; train_global_loss: 134389256.8889; train_optim_loss: 134389256.8889; val_kl_reg_loss: 47066.7812; val_edge_recon_loss: 406605.5625; val_gene_expr_recon_loss: 26884308.0000; val_masked_gp_l1_reg_loss: 2265.7979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104384088.0000; val_global_loss: 131724336.0000; val_optim_loss: 131724336.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8700; val_auprc_score: 0.8709; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 61974.6489; train_edge_recon_loss: 394970.5278; train_gene_expr_recon_loss: 25877035.5556; train_masked_gp_l1_reg_loss: 2390.4632; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102321085.3333; train_global_loss: 128657456.8889; train_optim_loss: 128657456.8889; val_kl_reg_loss: 77105.3594; val_edge_recon_loss: 406606.8125; val_gene_expr_recon_loss: 24479838.0000; val_masked_gp_l1_reg_loss: 2529.0530; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102022152.0000; val_global_loss: 126988232.0000; val_optim_loss: 126988232.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8781; val_auprc_score: 0.8737; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 102754.2700; train_edge_recon_loss: 403072.4618; train_gene_expr_recon_loss: 23854730.6667; train_masked_gp_l1_reg_loss: 2600.1502; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100478139.5556; train_global_loss: 124841298.6667; train_optim_loss: 124841298.6667; val_kl_reg_loss: 120798.2344; val_edge_recon_loss: 406605.2500; val_gene_expr_recon_loss: 23215694.0000; val_masked_gp_l1_reg_loss: 2664.7729; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100475232.0000; val_global_loss: 124220992.0000; val_optim_loss: 124220992.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8878; val_auprc_score: 0.8785; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 138269.7587; train_edge_recon_loss: 405227.6042; train_gene_expr_recon_loss: 22878814.4444; train_masked_gp_l1_reg_loss: 2687.4884; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99425539.5556; train_global_loss: 122850538.6667; train_optim_loss: 122850538.6667; val_kl_reg_loss: 141937.7500; val_edge_recon_loss: 406591.6875; val_gene_expr_recon_loss: 22376434.0000; val_masked_gp_l1_reg_loss: 2703.8159; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99481944.0000; val_global_loss: 122409616.0000; val_optim_loss: 122409616.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8879; val_auprc_score: 0.8754; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 157258.6875; train_edge_recon_loss: 405718.9549; train_gene_expr_recon_loss: 22164135.5556; train_masked_gp_l1_reg_loss: 2705.1970; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98186550.2222; train_global_loss: 120916368.8889; train_optim_loss: 120916368.8889; val_kl_reg_loss: 159571.7969; val_edge_recon_loss: 406571.9688; val_gene_expr_recon_loss: 21771314.0000; val_masked_gp_l1_reg_loss: 2701.7085; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98822280.0000; val_global_loss: 121162440.0000; val_optim_loss: 121162440.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8828; val_auprc_score: 0.8679; val_best_acc_score: 0.5020; val_best_f1_score: 0.6676; train_kl_reg_loss: 169675.0521; train_edge_recon_loss: 405814.1319; train_gene_expr_recon_loss: 21811211.1111; train_masked_gp_l1_reg_loss: 2694.6187; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98385032.0000; train_global_loss: 120774427.5556; train_optim_loss: 120774427.5556; val_kl_reg_loss: 162988.9688; val_edge_recon_loss: 406535.7188; val_gene_expr_recon_loss: 21442688.0000; val_masked_gp_l1_reg_loss: 2683.3145; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98319552.0000; val_global_loss: 120334448.0000; val_optim_loss: 120334448.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8765; val_auprc_score: 0.8640; val_best_acc_score: 0.5054; val_best_f1_score: 0.6691; train_kl_reg_loss: 172960.3090; train_edge_recon_loss: 405796.0764; train_gene_expr_recon_loss: 21376468.0000; train_masked_gp_l1_reg_loss: 2675.5372; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97487788.4444; train_global_loss: 119445689.7778; train_optim_loss: 119445689.7778; val_kl_reg_loss: 172005.8594; val_edge_recon_loss: 406499.5625; val_gene_expr_recon_loss: 21220588.0000; val_masked_gp_l1_reg_loss: 2665.2900; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98180072.0000; val_global_loss: 119981832.0000; val_optim_loss: 119981832.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8673; val_auprc_score: 0.8499; val_best_acc_score: 0.5110; val_best_f1_score: 0.6716; train_kl_reg_loss: 176098.4653; train_edge_recon_loss: 405818.2188; train_gene_expr_recon_loss: 21195696.6667; train_masked_gp_l1_reg_loss: 2657.3610; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97796252.4444; train_global_loss: 119576524.4444; train_optim_loss: 119576524.4444; val_kl_reg_loss: 168692.3281; val_edge_recon_loss: 406453.0625; val_gene_expr_recon_loss: 21107082.0000; val_masked_gp_l1_reg_loss: 2648.3008; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97917848.0000; val_global_loss: 119602720.0000; val_optim_loss: 119602720.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8708; val_auprc_score: 0.8630; val_best_acc_score: 0.5207; val_best_f1_score: 0.6760; train_kl_reg_loss: 176544.1233; train_edge_recon_loss: 405760.0764; train_gene_expr_recon_loss: 21086234.0000; train_masked_gp_l1_reg_loss: 2644.4435; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97506357.3333; train_global_loss: 119177539.5556; train_optim_loss: 119177539.5556; val_kl_reg_loss: 166214.7656; val_edge_recon_loss: 406392.1250; val_gene_expr_recon_loss: 20997132.0000; val_masked_gp_l1_reg_loss: 2639.0845; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97818792.0000; val_global_loss: 119391168.0000; val_optim_loss: 119391168.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8713; val_auprc_score: 0.8584; val_best_acc_score: 0.5389; val_best_f1_score: 0.6843; train_kl_reg_loss: 174782.5955; train_edge_recon_loss: 405724.0035; train_gene_expr_recon_loss: 21096784.6667; train_masked_gp_l1_reg_loss: 2636.2292; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97178443.5556; train_global_loss: 118858370.6667; train_optim_loss: 118858370.6667; val_kl_reg_loss: 164103.8438; val_edge_recon_loss: 406310.4375; val_gene_expr_recon_loss: 20923204.0000; val_masked_gp_l1_reg_loss: 2632.3464; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97638544.0000; val_global_loss: 119134792.0000; val_optim_loss: 119134792.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8749; val_auprc_score: 0.8639; val_best_acc_score: 0.5598; val_best_f1_score: 0.6936; train_kl_reg_loss: 173413.5434; train_edge_recon_loss: 405607.2257; train_gene_expr_recon_loss: 20977464.2222; train_masked_gp_l1_reg_loss: 2632.0709; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96640401.7778; train_global_loss: 118199518.2222; train_optim_loss: 118199518.2222; val_kl_reg_loss: 162500.5625; val_edge_recon_loss: 406217.0938; val_gene_expr_recon_loss: 20861646.0000; val_masked_gp_l1_reg_loss: 2631.6980; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97469696.0000; val_global_loss: 118902688.0000; val_optim_loss: 118902688.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8778; val_auprc_score: 0.8714; val_best_acc_score: 0.5853; val_best_f1_score: 0.7058; train_kl_reg_loss: 170843.5729; train_edge_recon_loss: 405534.1215; train_gene_expr_recon_loss: 20810413.1111; train_masked_gp_l1_reg_loss: 2632.0049; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96677664.0000; train_global_loss: 118067085.3333; train_optim_loss: 118067085.3333; val_kl_reg_loss: 160240.2500; val_edge_recon_loss: 406095.3750; val_gene_expr_recon_loss: 20843964.0000; val_masked_gp_l1_reg_loss: 2633.1809; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97514136.0000; val_global_loss: 118927072.0000; val_optim_loss: 118927072.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8838; val_auprc_score: 0.8761; val_best_acc_score: 0.6299; val_best_f1_score: 0.7284; train_kl_reg_loss: 168159.9931; train_edge_recon_loss: 405418.2396; train_gene_expr_recon_loss: 20776812.4444; train_masked_gp_l1_reg_loss: 2635.6533; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96857366.2222; train_global_loss: 118210393.7778; train_optim_loss: 118210393.7778; val_kl_reg_loss: 159875.3594; val_edge_recon_loss: 405910.6562; val_gene_expr_recon_loss: 20783502.0000; val_masked_gp_l1_reg_loss: 2637.7710; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97441560.0000; val_global_loss: 118793488.0000; val_optim_loss: 118793488.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8938; val_auprc_score: 0.8847; val_best_acc_score: 0.6669; val_best_f1_score: 0.7478; train_kl_reg_loss: 166597.7917; train_edge_recon_loss: 405160.2361; train_gene_expr_recon_loss: 20747680.6667; train_masked_gp_l1_reg_loss: 2639.2833; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96351243.5556; train_global_loss: 117673320.8889; train_optim_loss: 117673320.8889; val_kl_reg_loss: 154675.3594; val_edge_recon_loss: 405652.3438; val_gene_expr_recon_loss: 20747608.0000; val_masked_gp_l1_reg_loss: 2640.3960; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97208576.0000; val_global_loss: 118519152.0000; val_optim_loss: 118519152.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8972; val_auprc_score: 0.8893; val_best_acc_score: 0.7127; val_best_f1_score: 0.7733; train_kl_reg_loss: 163650.5608; train_edge_recon_loss: 404945.2083; train_gene_expr_recon_loss: 20788926.0000; train_masked_gp_l1_reg_loss: 2642.5058; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96756800.0000; train_global_loss: 118116964.4444; train_optim_loss: 118116964.4444; val_kl_reg_loss: 147434.4062; val_edge_recon_loss: 405302.7500; val_gene_expr_recon_loss: 20725534.0000; val_masked_gp_l1_reg_loss: 2644.4348; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97168784.0000; val_global_loss: 118449696.0000; val_optim_loss: 118449696.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8987; val_auprc_score: 0.8882; val_best_acc_score: 0.7390; val_best_f1_score: 0.7880; train_kl_reg_loss: 159929.8403; train_edge_recon_loss: 404604.6979; train_gene_expr_recon_loss: 20755189.5556; train_masked_gp_l1_reg_loss: 2647.3439; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96312744.0000; train_global_loss: 117635115.5556; train_optim_loss: 117635115.5556; val_kl_reg_loss: 145616.5625; val_edge_recon_loss: 405034.7500; val_gene_expr_recon_loss: 20672960.0000; val_masked_gp_l1_reg_loss: 2649.3225; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97007144.0000; val_global_loss: 118233408.0000; val_optim_loss: 118233408.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9064; val_auprc_score: 0.8978; val_best_acc_score: 0.7652; val_best_f1_score: 0.8033; train_kl_reg_loss: 159327.7170; train_edge_recon_loss: 404263.0208; train_gene_expr_recon_loss: 20759428.2222; train_masked_gp_l1_reg_loss: 2651.5835; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96749726.2222; train_global_loss: 118075398.2222; train_optim_loss: 118075398.2222; val_kl_reg_loss: 143466.4688; val_edge_recon_loss: 404645.8438; val_gene_expr_recon_loss: 20651932.0000; val_masked_gp_l1_reg_loss: 2652.8894; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96926488.0000; val_global_loss: 118129184.0000; val_optim_loss: 118129184.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9113; val_auprc_score: 0.8989; val_best_acc_score: 0.7937; val_best_f1_score: 0.8219; train_kl_reg_loss: 155681.1840; train_edge_recon_loss: 403895.3056; train_gene_expr_recon_loss: 20699066.0000; train_masked_gp_l1_reg_loss: 2655.7386; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96492691.5556; train_global_loss: 117753991.1111; train_optim_loss: 117753991.1111; val_kl_reg_loss: 143788.4062; val_edge_recon_loss: 404306.5625; val_gene_expr_recon_loss: 20626830.0000; val_masked_gp_l1_reg_loss: 2657.9504; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96952784.0000; val_global_loss: 118130368.0000; val_optim_loss: 118130368.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9123; val_auprc_score: 0.9038; val_best_acc_score: 0.8064; val_best_f1_score: 0.8292; train_kl_reg_loss: 153316.8802; train_edge_recon_loss: 403494.5035; train_gene_expr_recon_loss: 20604929.1111; train_masked_gp_l1_reg_loss: 2660.8048; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95942391.1111; train_global_loss: 117106792.8889; train_optim_loss: 117106792.8889; val_kl_reg_loss: 144469.2969; val_edge_recon_loss: 403868.9688; val_gene_expr_recon_loss: 20567940.0000; val_masked_gp_l1_reg_loss: 2663.9246; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96624472.0000; val_global_loss: 117743416.0000; val_optim_loss: 117743416.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9145; val_auprc_score: 0.9021; val_best_acc_score: 0.8191; val_best_f1_score: 0.8367; train_kl_reg_loss: 151189.8351; train_edge_recon_loss: 403069.7431; train_gene_expr_recon_loss: 20740421.1111; train_masked_gp_l1_reg_loss: 2666.8518; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96406850.6667; train_global_loss: 117704198.2222; train_optim_loss: 117704198.2222; val_kl_reg_loss: 143379.8438; val_edge_recon_loss: 403378.3125; val_gene_expr_recon_loss: 20569406.0000; val_masked_gp_l1_reg_loss: 2669.4619; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96708424.0000; val_global_loss: 117827256.0000; val_optim_loss: 117827256.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9207; val_auprc_score: 0.9105; val_best_acc_score: 0.8323; val_best_f1_score: 0.8451; train_kl_reg_loss: 149253.9878; train_edge_recon_loss: 402480.3160; train_gene_expr_recon_loss: 20664880.4444; train_masked_gp_l1_reg_loss: 2672.8363; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96179188.4444; train_global_loss: 117398476.4444; train_optim_loss: 117398476.4444; val_kl_reg_loss: 143842.8906; val_edge_recon_loss: 402747.0625; val_gene_expr_recon_loss: 20540142.0000; val_masked_gp_l1_reg_loss: 2677.3394; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96684576.0000; val_global_loss: 117773984.0000; val_optim_loss: 117773984.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9223; val_auprc_score: 0.9021; val_best_acc_score: 0.8461; val_best_f1_score: 0.8548; train_kl_reg_loss: 147553.2691; train_edge_recon_loss: 401983.7604; train_gene_expr_recon_loss: 20641918.8889; train_masked_gp_l1_reg_loss: 2681.0603; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95861176.0000; train_global_loss: 117055314.6667; train_optim_loss: 117055314.6667; val_kl_reg_loss: 144064.2812; val_edge_recon_loss: 402266.8438; val_gene_expr_recon_loss: 20517754.0000; val_masked_gp_l1_reg_loss: 2684.0796; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96543728.0000; val_global_loss: 117610496.0000; val_optim_loss: 117610496.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9215; val_auprc_score: 0.9072; val_best_acc_score: 0.8461; val_best_f1_score: 0.8532; train_kl_reg_loss: 146960.3767; train_edge_recon_loss: 401528.0625; train_gene_expr_recon_loss: 20546368.6667; train_masked_gp_l1_reg_loss: 2686.6738; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96153756.4444; train_global_loss: 117251300.4444; train_optim_loss: 117251300.4444; val_kl_reg_loss: 140615.9375; val_edge_recon_loss: 401666.1875; val_gene_expr_recon_loss: 20476708.0000; val_masked_gp_l1_reg_loss: 2689.2266; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96405480.0000; val_global_loss: 117427160.0000; val_optim_loss: 117427160.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9259; val_auprc_score: 0.9107; val_best_acc_score: 0.8511; val_best_f1_score: 0.8551; train_kl_reg_loss: 144872.3993; train_edge_recon_loss: 400803.7222; train_gene_expr_recon_loss: 20496669.1111; train_masked_gp_l1_reg_loss: 2691.0176; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95757763.5556; train_global_loss: 116802800.8889; train_optim_loss: 116802800.8889; val_kl_reg_loss: 134321.4219; val_edge_recon_loss: 400964.0625; val_gene_expr_recon_loss: 20459476.0000; val_masked_gp_l1_reg_loss: 2692.6453; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96298200.0000; val_global_loss: 117295656.0000; val_optim_loss: 117295656.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9198; val_auprc_score: 0.9041; val_best_acc_score: 0.8445; val_best_f1_score: 0.8494; train_kl_reg_loss: 146705.3420; train_edge_recon_loss: 401071.5938; train_gene_expr_recon_loss: 20973579.1111; train_masked_gp_l1_reg_loss: 2697.3175; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96747379.5556; train_global_loss: 118271432.8889; train_optim_loss: 118271432.8889; val_kl_reg_loss: 114541.0469; val_edge_recon_loss: 400786.5938; val_gene_expr_recon_loss: 20949202.0000; val_masked_gp_l1_reg_loss: 2702.7314; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96765896.0000; val_global_loss: 118233128.0000; val_optim_loss: 118233128.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9231; val_auprc_score: 0.9093; val_best_acc_score: 0.8459; val_best_f1_score: 0.8496; train_kl_reg_loss: 143314.2240; train_edge_recon_loss: 400442.0208; train_gene_expr_recon_loss: 20944844.6667; train_masked_gp_l1_reg_loss: 2707.6157; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96328280.0000; train_global_loss: 117819589.3333; train_optim_loss: 117819589.3333; val_kl_reg_loss: 113512.6094; val_edge_recon_loss: 400453.5000; val_gene_expr_recon_loss: 20925338.0000; val_masked_gp_l1_reg_loss: 2713.2988; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96881680.0000; val_global_loss: 118323696.0000; val_optim_loss: 118323696.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9265; val_auprc_score: 0.9132; val_best_acc_score: 0.8521; val_best_f1_score: 0.8533; train_kl_reg_loss: 141017.5052; train_edge_recon_loss: 399889.2951; train_gene_expr_recon_loss: 21044406.4444; train_masked_gp_l1_reg_loss: 2718.9441; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96987447.1111; train_global_loss: 118575479.1111; train_optim_loss: 118575479.1111; val_kl_reg_loss: 111922.7812; val_edge_recon_loss: 399715.0312; val_gene_expr_recon_loss: 20869652.0000; val_masked_gp_l1_reg_loss: 2724.5950; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96665240.0000; val_global_loss: 118049256.0000; val_optim_loss: 118049256.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9263; val_auprc_score: 0.9138; val_best_acc_score: 0.8479; val_best_f1_score: 0.8488; train_kl_reg_loss: 138117.3507; train_edge_recon_loss: 399363.1215; train_gene_expr_recon_loss: 20931798.4444; train_masked_gp_l1_reg_loss: 2729.4270; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95950496.0000; train_global_loss: 117422504.8889; train_optim_loss: 117422504.8889; val_kl_reg_loss: 112940.1250; val_edge_recon_loss: 399348.8438; val_gene_expr_recon_loss: 20832592.0000; val_masked_gp_l1_reg_loss: 2734.1670; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96542752.0000; val_global_loss: 117890368.0000; val_optim_loss: 117890368.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9285; val_auprc_score: 0.9147; val_best_acc_score: 0.8491; val_best_f1_score: 0.8497; train_kl_reg_loss: 133641.4479; train_edge_recon_loss: 398985.1875; train_gene_expr_recon_loss: 20921874.6667; train_masked_gp_l1_reg_loss: 2734.3809; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95640963.5556; train_global_loss: 117098199.1111; train_optim_loss: 117098199.1111; val_kl_reg_loss: 113607.9062; val_edge_recon_loss: 399360.5625; val_gene_expr_recon_loss: 20830920.0000; val_masked_gp_l1_reg_loss: 2734.6765; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96515424.0000; val_global_loss: 117862048.0000; val_optim_loss: 117862048.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9253; val_auprc_score: 0.9136; val_best_acc_score: 0.8459; val_best_f1_score: 0.8472; train_kl_reg_loss: 137080.3073; train_edge_recon_loss: 399097.6076; train_gene_expr_recon_loss: 20778432.8889; train_masked_gp_l1_reg_loss: 2734.8553; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95530516.4444; train_global_loss: 116847860.4444; train_optim_loss: 116847860.4444; val_kl_reg_loss: 117132.4844; val_edge_recon_loss: 399537.1250; val_gene_expr_recon_loss: 20824912.0000; val_masked_gp_l1_reg_loss: 2735.0168; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96504384.0000; val_global_loss: 117848704.0000; val_optim_loss: 117848704.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9216; val_auprc_score: 0.9073; val_best_acc_score: 0.8428; val_best_f1_score: 0.8443; train_kl_reg_loss: 138291.8229; train_edge_recon_loss: 398976.5729; train_gene_expr_recon_loss: 20891116.4444; train_masked_gp_l1_reg_loss: 2735.0675; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95813079.1111; train_global_loss: 117244199.1111; train_optim_loss: 117244199.1111; val_kl_reg_loss: 116484.8203; val_edge_recon_loss: 399510.9375; val_gene_expr_recon_loss: 20851522.0000; val_masked_gp_l1_reg_loss: 2735.0464; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96720584.0000; val_global_loss: 118090840.0000; val_optim_loss: 118090840.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9212; val_auprc_score: 0.9044; val_best_acc_score: 0.8448; val_best_f1_score: 0.8458; train_kl_reg_loss: 137239.0139; train_edge_recon_loss: 398850.8750; train_gene_expr_recon_loss: 20878236.6667; train_masked_gp_l1_reg_loss: 2734.9642; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96158761.7778; train_global_loss: 117575824.0000; train_optim_loss: 117575824.0000; val_kl_reg_loss: 115565.5000; val_edge_recon_loss: 399439.5625; val_gene_expr_recon_loss: 20814468.0000; val_masked_gp_l1_reg_loss: 2734.8962; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96472488.0000; val_global_loss: 117804696.0000; val_optim_loss: 117804696.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 52 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9193
Val AUPRC score: 0.9078
Val best accuracy score: 0.8376
Val best F1 score: 0.8462
Val gene expr MSE score: 0.4215
Val chrom access MSE score: 0.0882
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
