[True]
Run timestamp: 10102023_095756_225.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_225']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7955; val_auprc_score: 0.8041; val_best_acc_score: 0.6882; val_best_f1_score: 0.7404; train_kl_reg_loss: 99124.4104; train_edge_recon_loss: 758085.9146; train_gene_expr_recon_loss: 21753697.6947; train_masked_gp_l1_reg_loss: 35748.6694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2913667.3750; train_chrom_access_recon_loss: 2824909.6050; train_global_loss: 28385233.6489; train_optim_loss: 28385233.6489; val_kl_reg_loss: 103477.0281; val_edge_recon_loss: 810118.5667; val_gene_expr_recon_loss: 20696792.6667; val_masked_gp_l1_reg_loss: 38184.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1084329.8750; val_chrom_access_recon_loss: 2725499.5833; val_global_loss: 25458402.1333; val_optim_loss: 25458402.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9004; val_auprc_score: 0.8963; val_best_acc_score: 0.8199; val_best_f1_score: 0.8304; train_kl_reg_loss: 80785.3665; train_edge_recon_loss: 728780.2572; train_gene_expr_recon_loss: 20820870.7939; train_masked_gp_l1_reg_loss: 40280.8895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 573476.1219; train_chrom_access_recon_loss: 2742941.6985; train_global_loss: 24987134.9771; train_optim_loss: 24987134.9771; val_kl_reg_loss: 73554.9234; val_edge_recon_loss: 749590.1083; val_gene_expr_recon_loss: 20431510.8000; val_masked_gp_l1_reg_loss: 42829.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 313385.1562; val_chrom_access_recon_loss: 2715302.0667; val_global_loss: 24326174.1333; val_optim_loss: 24326174.1333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9288; val_auprc_score: 0.9174; val_best_acc_score: 0.8568; val_best_f1_score: 0.8646; train_kl_reg_loss: 78094.5254; train_edge_recon_loss: 658043.5396; train_gene_expr_recon_loss: 20530482.5344; train_masked_gp_l1_reg_loss: 45182.4549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235193.7357; train_chrom_access_recon_loss: 2711059.9924; train_global_loss: 24258056.7786; train_optim_loss: 24258056.7786; val_kl_reg_loss: 88283.0063; val_edge_recon_loss: 626273.8292; val_gene_expr_recon_loss: 20166286.1333; val_masked_gp_l1_reg_loss: 47611.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185689.8906; val_chrom_access_recon_loss: 2665221.0500; val_global_loss: 23779366.0000; val_optim_loss: 23779366.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9365; val_auprc_score: 0.9255; val_best_acc_score: 0.8665; val_best_f1_score: 0.8728; train_kl_reg_loss: 78875.0983; train_edge_recon_loss: 616821.3087; train_gene_expr_recon_loss: 20318374.9771; train_masked_gp_l1_reg_loss: 49565.9884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 161187.5844; train_chrom_access_recon_loss: 2687808.2748; train_global_loss: 23912633.1756; train_optim_loss: 23912633.1756; val_kl_reg_loss: 76299.9167; val_edge_recon_loss: 615248.8208; val_gene_expr_recon_loss: 19974304.6667; val_masked_gp_l1_reg_loss: 51406.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142789.5312; val_chrom_access_recon_loss: 2650671.3833; val_global_loss: 23510720.8000; val_optim_loss: 23510720.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9442; val_auprc_score: 0.9314; val_best_acc_score: 0.8758; val_best_f1_score: 0.8824; train_kl_reg_loss: 73620.6727; train_edge_recon_loss: 608161.1565; train_gene_expr_recon_loss: 20135819.3130; train_masked_gp_l1_reg_loss: 52866.5175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133417.4782; train_chrom_access_recon_loss: 2666988.4389; train_global_loss: 23670873.5420; train_optim_loss: 23670873.5420; val_kl_reg_loss: 72600.7281; val_edge_recon_loss: 604847.8458; val_gene_expr_recon_loss: 19805616.0000; val_masked_gp_l1_reg_loss: 54189.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126474.3359; val_chrom_access_recon_loss: 2625545.4667; val_global_loss: 23289274.5333; val_optim_loss: 23289274.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9483; val_auprc_score: 0.9360; val_best_acc_score: 0.8852; val_best_f1_score: 0.8898; train_kl_reg_loss: 69818.3964; train_edge_recon_loss: 601125.8154; train_gene_expr_recon_loss: 19967969.5115; train_masked_gp_l1_reg_loss: 55335.0117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119932.2004; train_chrom_access_recon_loss: 2645382.1889; train_global_loss: 23459563.0382; train_optim_loss: 23459563.0382; val_kl_reg_loss: 66829.5521; val_edge_recon_loss: 599393.8542; val_gene_expr_recon_loss: 19751508.8000; val_masked_gp_l1_reg_loss: 56534.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115017.0625; val_chrom_access_recon_loss: 2622454.1500; val_global_loss: 23211738.2667; val_optim_loss: 23211738.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9539; val_auprc_score: 0.9448; val_best_acc_score: 0.8913; val_best_f1_score: 0.8952; train_kl_reg_loss: 67719.7579; train_edge_recon_loss: 593508.8373; train_gene_expr_recon_loss: 19840950.2901; train_masked_gp_l1_reg_loss: 57442.1320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110242.4422; train_chrom_access_recon_loss: 2624975.6489; train_global_loss: 23294839.1756; train_optim_loss: 23294839.1756; val_kl_reg_loss: 64395.8448; val_edge_recon_loss: 594216.8167; val_gene_expr_recon_loss: 19650685.0667; val_masked_gp_l1_reg_loss: 58403.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106573.6641; val_chrom_access_recon_loss: 2616162.9000; val_global_loss: 23090438.6667; val_optim_loss: 23090438.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9563; val_auprc_score: 0.9490; val_best_acc_score: 0.8918; val_best_f1_score: 0.8958; train_kl_reg_loss: 64711.5740; train_edge_recon_loss: 590667.7963; train_gene_expr_recon_loss: 19721182.3053; train_masked_gp_l1_reg_loss: 59317.2656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103257.0491; train_chrom_access_recon_loss: 2609663.7500; train_global_loss: 23148799.5878; train_optim_loss: 23148799.5878; val_kl_reg_loss: 65075.8854; val_edge_recon_loss: 592306.1750; val_gene_expr_recon_loss: 19485991.2000; val_masked_gp_l1_reg_loss: 60179.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100709.9141; val_chrom_access_recon_loss: 2589454.5667; val_global_loss: 22893717.6000; val_optim_loss: 22893717.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9632; val_auprc_score: 0.9540; val_best_acc_score: 0.9062; val_best_f1_score: 0.9094; train_kl_reg_loss: 63186.9053; train_edge_recon_loss: 586473.2476; train_gene_expr_recon_loss: 19605155.9695; train_masked_gp_l1_reg_loss: 60935.1490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98235.1051; train_chrom_access_recon_loss: 2596699.7595; train_global_loss: 23010686.0305; train_optim_loss: 23010686.0305; val_kl_reg_loss: 62871.2573; val_edge_recon_loss: 585291.9375; val_gene_expr_recon_loss: 19395224.2667; val_masked_gp_l1_reg_loss: 61689.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97470.0781; val_chrom_access_recon_loss: 2571965.9167; val_global_loss: 22774513.4667; val_optim_loss: 22774513.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9615; val_auprc_score: 0.9500; val_best_acc_score: 0.9057; val_best_f1_score: 0.9088; train_kl_reg_loss: 61529.5176; train_edge_recon_loss: 584133.0988; train_gene_expr_recon_loss: 19519814.0916; train_masked_gp_l1_reg_loss: 62496.6293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95000.1658; train_chrom_access_recon_loss: 2581549.6641; train_global_loss: 22904523.0534; train_optim_loss: 22904523.0534; val_kl_reg_loss: 59754.1510; val_edge_recon_loss: 586232.9833; val_gene_expr_recon_loss: 19238788.8000; val_masked_gp_l1_reg_loss: 63391.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95222.3984; val_chrom_access_recon_loss: 2560691.4667; val_global_loss: 22604081.2000; val_optim_loss: 22604081.2000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9644; val_auprc_score: 0.9564; val_best_acc_score: 0.9097; val_best_f1_score: 0.9136; train_kl_reg_loss: 60171.2461; train_edge_recon_loss: 581900.9284; train_gene_expr_recon_loss: 19410986.1832; train_masked_gp_l1_reg_loss: 64087.5292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93634.9620; train_chrom_access_recon_loss: 2566207.7385; train_global_loss: 22776988.6412; train_optim_loss: 22776988.6412; val_kl_reg_loss: 60047.1695; val_edge_recon_loss: 587631.9708; val_gene_expr_recon_loss: 19135716.0000; val_masked_gp_l1_reg_loss: 64837.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92456.8438; val_chrom_access_recon_loss: 2536876.6667; val_global_loss: 22477565.7333; val_optim_loss: 22477565.7333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9636; val_auprc_score: 0.9528; val_best_acc_score: 0.9140; val_best_f1_score: 0.9170; train_kl_reg_loss: 58587.0363; train_edge_recon_loss: 581000.4928; train_gene_expr_recon_loss: 19322391.0534; train_masked_gp_l1_reg_loss: 65734.2909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92616.8016; train_chrom_access_recon_loss: 2550635.4981; train_global_loss: 22670965.0840; train_optim_loss: 22670965.0840; val_kl_reg_loss: 58042.2513; val_edge_recon_loss: 584186.1250; val_gene_expr_recon_loss: 19052096.0000; val_masked_gp_l1_reg_loss: 66590.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92145.2266; val_chrom_access_recon_loss: 2518188.0000; val_global_loss: 22371248.2667; val_optim_loss: 22371248.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9662; val_auprc_score: 0.9603; val_best_acc_score: 0.9093; val_best_f1_score: 0.9129; train_kl_reg_loss: 57530.2284; train_edge_recon_loss: 579104.6126; train_gene_expr_recon_loss: 19223593.0382; train_masked_gp_l1_reg_loss: 67510.1529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91737.6831; train_chrom_access_recon_loss: 2532716.2672; train_global_loss: 22552191.8779; train_optim_loss: 22552191.8779; val_kl_reg_loss: 56082.4398; val_edge_recon_loss: 583171.6833; val_gene_expr_recon_loss: 18990131.0667; val_masked_gp_l1_reg_loss: 68531.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93429.5312; val_chrom_access_recon_loss: 2515912.9500; val_global_loss: 22307260.0000; val_optim_loss: 22307260.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9707; val_auprc_score: 0.9644; val_best_acc_score: 0.9190; val_best_f1_score: 0.9221; train_kl_reg_loss: 56921.8221; train_edge_recon_loss: 577810.4332; train_gene_expr_recon_loss: 19150708.8092; train_masked_gp_l1_reg_loss: 69564.3692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91386.0394; train_chrom_access_recon_loss: 2520594.3034; train_global_loss: 22466985.7099; train_optim_loss: 22466985.7099; val_kl_reg_loss: 57876.9453; val_edge_recon_loss: 578890.8708; val_gene_expr_recon_loss: 18917597.3333; val_masked_gp_l1_reg_loss: 70594.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91235.7031; val_chrom_access_recon_loss: 2490775.2833; val_global_loss: 22206970.2667; val_optim_loss: 22206970.2667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9693; val_auprc_score: 0.9612; val_best_acc_score: 0.9200; val_best_f1_score: 0.9219; train_kl_reg_loss: 55908.2418; train_edge_recon_loss: 578200.8583; train_gene_expr_recon_loss: 19054822.5496; train_masked_gp_l1_reg_loss: 71593.9304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91147.3359; train_chrom_access_recon_loss: 2503535.1374; train_global_loss: 22355207.9847; train_optim_loss: 22355207.9847; val_kl_reg_loss: 55321.6646; val_edge_recon_loss: 578574.3958; val_gene_expr_recon_loss: 18961467.2000; val_masked_gp_l1_reg_loss: 72640.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90256.4062; val_chrom_access_recon_loss: 2495293.4667; val_global_loss: 22253552.5333; val_optim_loss: 22253552.5333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9681; val_auprc_score: 0.9583; val_best_acc_score: 0.9165; val_best_f1_score: 0.9194; train_kl_reg_loss: 55183.9537; train_edge_recon_loss: 576119.3535; train_gene_expr_recon_loss: 18960635.7710; train_masked_gp_l1_reg_loss: 73807.6972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91131.4931; train_chrom_access_recon_loss: 2491952.8168; train_global_loss: 22248830.8397; train_optim_loss: 22248830.8397; val_kl_reg_loss: 53288.0828; val_edge_recon_loss: 588074.4333; val_gene_expr_recon_loss: 18893114.0000; val_masked_gp_l1_reg_loss: 74767.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90110.3672; val_chrom_access_recon_loss: 2488058.8333; val_global_loss: 22187413.3333; val_optim_loss: 22187413.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9702; val_auprc_score: 0.9632; val_best_acc_score: 0.9182; val_best_f1_score: 0.9200; train_kl_reg_loss: 55441.3632; train_edge_recon_loss: 575630.5186; train_gene_expr_recon_loss: 18908817.9084; train_masked_gp_l1_reg_loss: 75754.6294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91082.4362; train_chrom_access_recon_loss: 2484283.2137; train_global_loss: 22191009.9237; train_optim_loss: 22191009.9237; val_kl_reg_loss: 56240.2490; val_edge_recon_loss: 577784.1708; val_gene_expr_recon_loss: 18731294.5333; val_masked_gp_l1_reg_loss: 76772.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91375.3125; val_chrom_access_recon_loss: 2465026.3333; val_global_loss: 21998493.6000; val_optim_loss: 21998493.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9669; val_auprc_score: 0.9568; val_best_acc_score: 0.9130; val_best_f1_score: 0.9172; train_kl_reg_loss: 55759.3865; train_edge_recon_loss: 574601.2075; train_gene_expr_recon_loss: 18808485.6489; train_masked_gp_l1_reg_loss: 77782.5515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91338.9598; train_chrom_access_recon_loss: 2461774.6393; train_global_loss: 22069742.5802; train_optim_loss: 22069742.5802; val_kl_reg_loss: 55620.6029; val_edge_recon_loss: 578286.5833; val_gene_expr_recon_loss: 18665304.9333; val_masked_gp_l1_reg_loss: 78778.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91703.5312; val_chrom_access_recon_loss: 2472309.6500; val_global_loss: 21942003.4667; val_optim_loss: 21942003.4667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9664; val_auprc_score: 0.9571; val_best_acc_score: 0.9130; val_best_f1_score: 0.9178; train_kl_reg_loss: 55681.5259; train_edge_recon_loss: 574400.3702; train_gene_expr_recon_loss: 18725183.0992; train_masked_gp_l1_reg_loss: 79727.3231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91461.4716; train_chrom_access_recon_loss: 2451504.9427; train_global_loss: 21977958.7939; train_optim_loss: 21977958.7939; val_kl_reg_loss: 55347.1477; val_edge_recon_loss: 578253.6792; val_gene_expr_recon_loss: 18660626.6667; val_masked_gp_l1_reg_loss: 80608.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91254.3359; val_chrom_access_recon_loss: 2454423.4500; val_global_loss: 21920512.9333; val_optim_loss: 21920512.9333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9689; val_auprc_score: 0.9601; val_best_acc_score: 0.9179; val_best_f1_score: 0.9218; train_kl_reg_loss: 55847.7081; train_edge_recon_loss: 574126.2662; train_gene_expr_recon_loss: 18660352.9771; train_masked_gp_l1_reg_loss: 81513.2028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91524.9872; train_chrom_access_recon_loss: 2439663.3378; train_global_loss: 21903028.3969; train_optim_loss: 21903028.3969; val_kl_reg_loss: 56818.7370; val_edge_recon_loss: 579384.3958; val_gene_expr_recon_loss: 18428885.2000; val_masked_gp_l1_reg_loss: 82268.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92338.3125; val_chrom_access_recon_loss: 2427240.1833; val_global_loss: 21666934.5333; val_optim_loss: 21666934.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9632; val_auprc_score: 0.9543; val_best_acc_score: 0.9082; val_best_f1_score: 0.9125; train_kl_reg_loss: 56149.4866; train_edge_recon_loss: 574865.5654; train_gene_expr_recon_loss: 18586631.2519; train_masked_gp_l1_reg_loss: 83207.3032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91821.4560; train_chrom_access_recon_loss: 2427965.5821; train_global_loss: 21820640.5954; train_optim_loss: 21820640.5954; val_kl_reg_loss: 56551.1172; val_edge_recon_loss: 579677.1875; val_gene_expr_recon_loss: 18501101.8667; val_masked_gp_l1_reg_loss: 83970.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92749.3203; val_chrom_access_recon_loss: 2437371.1167; val_global_loss: 21751421.2000; val_optim_loss: 21751421.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9673; val_auprc_score: 0.9598; val_best_acc_score: 0.9154; val_best_f1_score: 0.9186; train_kl_reg_loss: 56408.4583; train_edge_recon_loss: 574375.9695; train_gene_expr_recon_loss: 18515921.7863; train_masked_gp_l1_reg_loss: 84649.3851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92267.4254; train_chrom_access_recon_loss: 2418544.7137; train_global_loss: 21742167.6031; train_optim_loss: 21742167.6031; val_kl_reg_loss: 55734.4659; val_edge_recon_loss: 581100.9042; val_gene_expr_recon_loss: 18508474.9333; val_masked_gp_l1_reg_loss: 85312.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92089.1406; val_chrom_access_recon_loss: 2429987.5667; val_global_loss: 21752700.1333; val_optim_loss: 21752700.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9648; val_auprc_score: 0.9575; val_best_acc_score: 0.9088; val_best_f1_score: 0.9125; train_kl_reg_loss: 56920.8653; train_edge_recon_loss: 576474.0878; train_gene_expr_recon_loss: 18488642.6718; train_masked_gp_l1_reg_loss: 86147.5326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92281.5748; train_chrom_access_recon_loss: 2416480.4924; train_global_loss: 21716946.9160; train_optim_loss: 21716946.9160; val_kl_reg_loss: 52374.9659; val_edge_recon_loss: 589542.6667; val_gene_expr_recon_loss: 18569962.4000; val_masked_gp_l1_reg_loss: 86769.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95930.2578; val_chrom_access_recon_loss: 2480384.3000; val_global_loss: 21874964.6667; val_optim_loss: 21874964.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8494; val_auprc_score: 0.8521; val_best_acc_score: 0.7666; val_best_f1_score: 0.7760; train_kl_reg_loss: 6767381602.9724; train_edge_recon_loss: 687837.7242; train_gene_expr_recon_loss: 19970253.5878; train_masked_gp_l1_reg_loss: 86259.5224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125012.5649; train_chrom_access_recon_loss: 2606104.9256; train_global_loss: 6790856718.8397; train_optim_loss: 6790856718.8397; val_kl_reg_loss: 256018189.1844; val_edge_recon_loss: 739343.0625; val_gene_expr_recon_loss: 19124799.7333; val_masked_gp_l1_reg_loss: 89652.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141205.7500; val_chrom_access_recon_loss: 2550409.7500; val_global_loss: 278663595.4667; val_optim_loss: 278663595.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8715; val_auprc_score: 0.8721; val_best_acc_score: 0.7840; val_best_f1_score: 0.7942; train_kl_reg_loss: 103636.8896; train_edge_recon_loss: 707393.1679; train_gene_expr_recon_loss: 19162346.7481; train_masked_gp_l1_reg_loss: 87934.6287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98449.3195; train_chrom_access_recon_loss: 2530266.2634; train_global_loss: 22690026.9618; train_optim_loss: 22690026.9618; val_kl_reg_loss: 66579.4643; val_edge_recon_loss: 704804.5542; val_gene_expr_recon_loss: 18888324.4000; val_masked_gp_l1_reg_loss: 86863.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85501.2656; val_chrom_access_recon_loss: 2506899.7833; val_global_loss: 22338974.0000; val_optim_loss: 22338974.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8886; val_auprc_score: 0.8886; val_best_acc_score: 0.8053; val_best_f1_score: 0.8104; train_kl_reg_loss: 62838.3576; train_edge_recon_loss: 681047.9313; train_gene_expr_recon_loss: 19019066.2290; train_masked_gp_l1_reg_loss: 86207.7114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82366.6911; train_chrom_access_recon_loss: 2502760.1813; train_global_loss: 22434287.1450; train_optim_loss: 22434287.1450; val_kl_reg_loss: 55716.6503; val_edge_recon_loss: 675010.2167; val_gene_expr_recon_loss: 18748803.2000; val_masked_gp_l1_reg_loss: 85674.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79753.0391; val_chrom_access_recon_loss: 2476062.3667; val_global_loss: 22121020.1333; val_optim_loss: 22121020.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9030; val_auprc_score: 0.9014; val_best_acc_score: 0.8239; val_best_f1_score: 0.8318; train_kl_reg_loss: 54003.6450; train_edge_recon_loss: 659231.4943; train_gene_expr_recon_loss: 18986083.1603; train_masked_gp_l1_reg_loss: 85289.9602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77734.3302; train_chrom_access_recon_loss: 2500045.3950; train_global_loss: 22362387.9847; train_optim_loss: 22362387.9847; val_kl_reg_loss: 50959.9802; val_edge_recon_loss: 656790.4542; val_gene_expr_recon_loss: 18791619.3333; val_masked_gp_l1_reg_loss: 84960.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76026.6016; val_chrom_access_recon_loss: 2481735.1833; val_global_loss: 22142090.6667; val_optim_loss: 22142090.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9071; val_auprc_score: 0.8994; val_best_acc_score: 0.8321; val_best_f1_score: 0.8406; train_kl_reg_loss: 50822.3187; train_edge_recon_loss: 645925.6150; train_gene_expr_recon_loss: 18950197.7099; train_masked_gp_l1_reg_loss: 84742.4837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74342.4615; train_chrom_access_recon_loss: 2492795.2443; train_global_loss: 22298825.8473; train_optim_loss: 22298825.8473; val_kl_reg_loss: 47941.3547; val_edge_recon_loss: 647720.8667; val_gene_expr_recon_loss: 18695774.2667; val_masked_gp_l1_reg_loss: 84563.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72951.6562; val_chrom_access_recon_loss: 2481543.8333; val_global_loss: 22030496.0000; val_optim_loss: 22030496.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 27 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
val AUROC score: 0.9702
val AUPRC score: 0.9629
val best accuracy score: 0.9224
val best F1 score: 0.9247
val target rna MSE score: 1.2467
val source rna MSE score: 0.5488
val target atac MSE score: 0.4966
val source atac MSE score: 0.1371
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
