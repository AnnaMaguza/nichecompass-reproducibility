[True]
Run timestamp: 07092023_010339_225.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_225']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 984 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 4613, n_cat_covariates_embed_input: 0, n_hidden: 2386, n_latent: 2286, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 984
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 984

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7661; val_auprc_score: 0.7838; val_best_acc_score: 0.5660; val_best_f1_score: 0.6909; train_kl_reg_loss: 69374.6028; train_edge_recon_loss: 3535736.0344; train_gene_expr_recon_loss: 14955528.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 919737.4974; train_chrom_access_recon_loss: 5769640.4656; train_global_loss: 25250016.7176; train_optim_loss: 25250016.7176; val_kl_reg_loss: 91824.8865; val_edge_recon_loss: 4061465.5167; val_gene_expr_recon_loss: 13873139.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 493365.3438; val_chrom_access_recon_loss: 5528779.7667; val_global_loss: 24048576.1333; val_optim_loss: 24048576.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8427; val_auprc_score: 0.8474; val_best_acc_score: 0.7567; val_best_f1_score: 0.7399; train_kl_reg_loss: 86606.5175; train_edge_recon_loss: 3513976.0935; train_gene_expr_recon_loss: 13837939.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 300656.2340; train_chrom_access_recon_loss: 5504779.0076; train_global_loss: 23243957.4504; train_optim_loss: 23243957.4504; val_kl_reg_loss: 72075.7969; val_edge_recon_loss: 3997536.1833; val_gene_expr_recon_loss: 13562311.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179519.7344; val_chrom_access_recon_loss: 5422105.7667; val_global_loss: 23233549.0667; val_optim_loss: 23233549.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8925; val_auprc_score: 0.8839; val_best_acc_score: 0.8023; val_best_f1_score: 0.8147; train_kl_reg_loss: 67433.1465; train_edge_recon_loss: 3313371.3225; train_gene_expr_recon_loss: 13637523.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132011.5954; train_chrom_access_recon_loss: 5443109.0038; train_global_loss: 22593448.7939; train_optim_loss: 22593448.7939; val_kl_reg_loss: 84310.3719; val_edge_recon_loss: 2977053.6333; val_gene_expr_recon_loss: 13407778.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100653.4453; val_chrom_access_recon_loss: 5373613.9667; val_global_loss: 21943410.1333; val_optim_loss: 21943410.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9144; val_auprc_score: 0.8991; val_best_acc_score: 0.8401; val_best_f1_score: 0.8491; train_kl_reg_loss: 88962.4414; train_edge_recon_loss: 2888893.9447; train_gene_expr_recon_loss: 13463690.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84206.5612; train_chrom_access_recon_loss: 5373246.2557; train_global_loss: 21899000.1069; train_optim_loss: 21899000.1069; val_kl_reg_loss: 86532.7182; val_edge_recon_loss: 2863193.1833; val_gene_expr_recon_loss: 13195095.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71766.0625; val_chrom_access_recon_loss: 5305862.4667; val_global_loss: 21522449.7333; val_optim_loss: 21522449.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9234; val_auprc_score: 0.9099; val_best_acc_score: 0.8529; val_best_f1_score: 0.8644; train_kl_reg_loss: 89364.6028; train_edge_recon_loss: 2826958.1527; train_gene_expr_recon_loss: 13320998.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63221.8396; train_chrom_access_recon_loss: 5321450.3664; train_global_loss: 21621993.5725; train_optim_loss: 21621993.5725; val_kl_reg_loss: 84612.0656; val_edge_recon_loss: 2817022.0833; val_gene_expr_recon_loss: 13084384.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56841.3398; val_chrom_access_recon_loss: 5247612.8000; val_global_loss: 21290472.1333; val_optim_loss: 21290472.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9357; val_auprc_score: 0.9214; val_best_acc_score: 0.8697; val_best_f1_score: 0.8793; train_kl_reg_loss: 85706.6943; train_edge_recon_loss: 2802685.5878; train_gene_expr_recon_loss: 13208332.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52325.3543; train_chrom_access_recon_loss: 5273431.2137; train_global_loss: 21422480.9618; train_optim_loss: 21422480.9618; val_kl_reg_loss: 82971.5031; val_edge_recon_loss: 2790152.2833; val_gene_expr_recon_loss: 12974628.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48980.2656; val_chrom_access_recon_loss: 5188278.4333; val_global_loss: 21085010.5333; val_optim_loss: 21085010.5333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9368; val_auprc_score: 0.9226; val_best_acc_score: 0.8707; val_best_f1_score: 0.8794; train_kl_reg_loss: 80767.7569; train_edge_recon_loss: 2776230.1069; train_gene_expr_recon_loss: 13110090.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46397.7675; train_chrom_access_recon_loss: 5230250.1374; train_global_loss: 21243735.9084; train_optim_loss: 21243735.9084; val_kl_reg_loss: 76784.0385; val_edge_recon_loss: 2801619.4667; val_gene_expr_recon_loss: 12932658.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44907.3789; val_chrom_access_recon_loss: 5172103.4000; val_global_loss: 21028071.8667; val_optim_loss: 21028071.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9404; val_auprc_score: 0.9244; val_best_acc_score: 0.8813; val_best_f1_score: 0.8865; train_kl_reg_loss: 79442.3937; train_edge_recon_loss: 2757200.4714; train_gene_expr_recon_loss: 13008475.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43003.2194; train_chrom_access_recon_loss: 5187786.2977; train_global_loss: 21075908.3206; train_optim_loss: 21075908.3206; val_kl_reg_loss: 74865.2589; val_edge_recon_loss: 2769387.8500; val_gene_expr_recon_loss: 12818105.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42073.0977; val_chrom_access_recon_loss: 5136063.5000; val_global_loss: 20840494.8000; val_optim_loss: 20840494.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9497; val_auprc_score: 0.9382; val_best_acc_score: 0.8919; val_best_f1_score: 0.8979; train_kl_reg_loss: 77351.0725; train_edge_recon_loss: 2743401.1737; train_gene_expr_recon_loss: 12931910.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40846.5383; train_chrom_access_recon_loss: 5156571.2252; train_global_loss: 20950080.0611; train_optim_loss: 20950080.0611; val_kl_reg_loss: 75188.0870; val_edge_recon_loss: 2741395.3333; val_gene_expr_recon_loss: 12744219.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40004.7695; val_chrom_access_recon_loss: 5116257.4333; val_global_loss: 20717064.8000; val_optim_loss: 20717064.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9495; val_auprc_score: 0.9358; val_best_acc_score: 0.8909; val_best_f1_score: 0.8960; train_kl_reg_loss: 74916.0780; train_edge_recon_loss: 2737569.4790; train_gene_expr_recon_loss: 12870538.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39246.3892; train_chrom_access_recon_loss: 5128364.0763; train_global_loss: 20850634.0305; train_optim_loss: 20850634.0305; val_kl_reg_loss: 75327.9385; val_edge_recon_loss: 2735529.0667; val_gene_expr_recon_loss: 12685576.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39021.8633; val_chrom_access_recon_loss: 5078395.0000; val_global_loss: 20613850.1333; val_optim_loss: 20613850.1333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9509; val_auprc_score: 0.9388; val_best_acc_score: 0.8929; val_best_f1_score: 0.8977; train_kl_reg_loss: 74304.1936; train_edge_recon_loss: 2722790.6202; train_gene_expr_recon_loss: 12788925.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38201.5592; train_chrom_access_recon_loss: 5093023.5649; train_global_loss: 20717245.6794; train_optim_loss: 20717245.6794; val_kl_reg_loss: 73883.6755; val_edge_recon_loss: 2738987.7667; val_gene_expr_recon_loss: 12623926.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37673.4453; val_chrom_access_recon_loss: 5041375.5333; val_global_loss: 20515846.2667; val_optim_loss: 20515846.2667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9510; val_auprc_score: 0.9378; val_best_acc_score: 0.8942; val_best_f1_score: 0.8999; train_kl_reg_loss: 70626.2570; train_edge_recon_loss: 2728898.5420; train_gene_expr_recon_loss: 12723546.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37199.4869; train_chrom_access_recon_loss: 5069169.6031; train_global_loss: 20629440.3664; train_optim_loss: 20629440.3664; val_kl_reg_loss: 68844.4948; val_edge_recon_loss: 2735147.4333; val_gene_expr_recon_loss: 12583488.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37160.6602; val_chrom_access_recon_loss: 5040986.2333; val_global_loss: 20465627.8667; val_optim_loss: 20465627.8667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9540; val_auprc_score: 0.9379; val_best_acc_score: 0.8992; val_best_f1_score: 0.9046; train_kl_reg_loss: 69369.5762; train_edge_recon_loss: 2703148.2118; train_gene_expr_recon_loss: 12682457.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36505.9978; train_chrom_access_recon_loss: 5046082.6794; train_global_loss: 20537563.4962; train_optim_loss: 20537563.4962; val_kl_reg_loss: 68527.1641; val_edge_recon_loss: 2706627.8333; val_gene_expr_recon_loss: 12523033.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36597.6875; val_chrom_access_recon_loss: 5009782.7000; val_global_loss: 20344569.6000; val_optim_loss: 20344569.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9591; val_auprc_score: 0.9479; val_best_acc_score: 0.9015; val_best_f1_score: 0.9064; train_kl_reg_loss: 67242.5425; train_edge_recon_loss: 2713876.5324; train_gene_expr_recon_loss: 12621834.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36060.1504; train_chrom_access_recon_loss: 5022698.0954; train_global_loss: 20461712.1374; train_optim_loss: 20461712.1374; val_kl_reg_loss: 67531.1995; val_edge_recon_loss: 2723633.0333; val_gene_expr_recon_loss: 12463317.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35711.5547; val_chrom_access_recon_loss: 5004752.1000; val_global_loss: 20294945.8667; val_optim_loss: 20294945.8667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9609; val_auprc_score: 0.9469; val_best_acc_score: 0.9068; val_best_f1_score: 0.9110; train_kl_reg_loss: 66050.6469; train_edge_recon_loss: 2704973.8626; train_gene_expr_recon_loss: 12575185.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35474.3580; train_chrom_access_recon_loss: 5001803.1145; train_global_loss: 20383487.9084; train_optim_loss: 20383487.9084; val_kl_reg_loss: 64136.0211; val_edge_recon_loss: 2688892.0500; val_gene_expr_recon_loss: 12403117.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35387.7344; val_chrom_access_recon_loss: 4962724.6333; val_global_loss: 20154257.6000; val_optim_loss: 20154257.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9605; val_auprc_score: 0.9491; val_best_acc_score: 0.9025; val_best_f1_score: 0.9070; train_kl_reg_loss: 64766.1094; train_edge_recon_loss: 2700964.3855; train_gene_expr_recon_loss: 12547667.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35119.3459; train_chrom_access_recon_loss: 4988298.8053; train_global_loss: 20336816.3969; train_optim_loss: 20336816.3969; val_kl_reg_loss: 65069.3245; val_edge_recon_loss: 2706654.5500; val_gene_expr_recon_loss: 12363149.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34960.5781; val_chrom_access_recon_loss: 4940025.1333; val_global_loss: 20109859.6000; val_optim_loss: 20109859.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9624; val_auprc_score: 0.9488; val_best_acc_score: 0.9066; val_best_f1_score: 0.9109; train_kl_reg_loss: 62764.5091; train_edge_recon_loss: 2700539.3626; train_gene_expr_recon_loss: 12496814.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34754.1845; train_chrom_access_recon_loss: 4965656.7481; train_global_loss: 20260529.1756; train_optim_loss: 20260529.1756; val_kl_reg_loss: 62551.7388; val_edge_recon_loss: 2700736.2833; val_gene_expr_recon_loss: 12346082.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34853.6172; val_chrom_access_recon_loss: 4946373.8667; val_global_loss: 20090598.5333; val_optim_loss: 20090598.5333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9631; val_auprc_score: 0.9532; val_best_acc_score: 0.9096; val_best_f1_score: 0.9120; train_kl_reg_loss: 61370.3823; train_edge_recon_loss: 2687508.5382; train_gene_expr_recon_loss: 12473096.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34452.8082; train_chrom_access_recon_loss: 4957901.0763; train_global_loss: 20214329.0992; train_optim_loss: 20214329.0992; val_kl_reg_loss: 59516.3862; val_edge_recon_loss: 2688449.5667; val_gene_expr_recon_loss: 12293513.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34650.4961; val_chrom_access_recon_loss: 4921592.7333; val_global_loss: 19997722.4000; val_optim_loss: 19997722.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9644; val_auprc_score: 0.9519; val_best_acc_score: 0.9119; val_best_f1_score: 0.9159; train_kl_reg_loss: 60788.8552; train_edge_recon_loss: 2690091.8321; train_gene_expr_recon_loss: 12438509.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34290.0136; train_chrom_access_recon_loss: 4939110.8053; train_global_loss: 20162790.8702; train_optim_loss: 20162790.8702; val_kl_reg_loss: 58747.8776; val_edge_recon_loss: 2690400.7000; val_gene_expr_recon_loss: 12318213.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34170.4844; val_chrom_access_recon_loss: 4932956.3000; val_global_loss: 20034488.5333; val_optim_loss: 20034488.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9682; val_auprc_score: 0.9598; val_best_acc_score: 0.9157; val_best_f1_score: 0.9185; train_kl_reg_loss: 59013.3724; train_edge_recon_loss: 2694774.2576; train_gene_expr_recon_loss: 12406515.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33988.6347; train_chrom_access_recon_loss: 4925336.7672; train_global_loss: 20119628.6565; train_optim_loss: 20119628.6565; val_kl_reg_loss: 58657.2594; val_edge_recon_loss: 2685912.7167; val_gene_expr_recon_loss: 12246167.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34001.1523; val_chrom_access_recon_loss: 4887791.3667; val_global_loss: 19912529.2000; val_optim_loss: 19912529.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9668; val_auprc_score: 0.9573; val_best_acc_score: 0.9117; val_best_f1_score: 0.9161; train_kl_reg_loss: 57742.9625; train_edge_recon_loss: 2686880.7615; train_gene_expr_recon_loss: 12375559.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33797.6539; train_chrom_access_recon_loss: 4914630.4160; train_global_loss: 20068611.0534; train_optim_loss: 20068611.0534; val_kl_reg_loss: 58192.4891; val_edge_recon_loss: 2683540.6500; val_gene_expr_recon_loss: 12217765.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33855.9766; val_chrom_access_recon_loss: 4883088.5000; val_global_loss: 19876442.8000; val_optim_loss: 19876442.8000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9671; val_auprc_score: 0.9543; val_best_acc_score: 0.9163; val_best_f1_score: 0.9200; train_kl_reg_loss: 56728.7521; train_edge_recon_loss: 2678324.7214; train_gene_expr_recon_loss: 12368292.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33669.0698; train_chrom_access_recon_loss: 4910071.2901; train_global_loss: 20047086.4580; train_optim_loss: 20047086.4580; val_kl_reg_loss: 55732.1482; val_edge_recon_loss: 2698422.9333; val_gene_expr_recon_loss: 12211568.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33678.7031; val_chrom_access_recon_loss: 4866936.9333; val_global_loss: 19866339.4667; val_optim_loss: 19866339.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9712; val_auprc_score: 0.9626; val_best_acc_score: 0.9214; val_best_f1_score: 0.9235; train_kl_reg_loss: 56624.0376; train_edge_recon_loss: 2674440.1622; train_gene_expr_recon_loss: 12329103.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33559.5980; train_chrom_access_recon_loss: 4892187.3206; train_global_loss: 19985914.4427; train_optim_loss: 19985914.4427; val_kl_reg_loss: 54955.2497; val_edge_recon_loss: 2689372.4500; val_gene_expr_recon_loss: 12158260.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33544.9414; val_chrom_access_recon_loss: 4864305.2000; val_global_loss: 19800438.1333; val_optim_loss: 19800438.1333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9726; val_auprc_score: 0.9629; val_best_acc_score: 0.9258; val_best_f1_score: 0.9285; train_kl_reg_loss: 56249.7566; train_edge_recon_loss: 2673992.5134; train_gene_expr_recon_loss: 12314906.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33389.9668; train_chrom_access_recon_loss: 4885053.5687; train_global_loss: 19963592.7023; train_optim_loss: 19963592.7023; val_kl_reg_loss: 54573.7482; val_edge_recon_loss: 2675318.1667; val_gene_expr_recon_loss: 12168631.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33477.1562; val_chrom_access_recon_loss: 4851920.6667; val_global_loss: 19783920.9333; val_optim_loss: 19783920.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9717; val_auprc_score: 0.9608; val_best_acc_score: 0.9206; val_best_f1_score: 0.9236; train_kl_reg_loss: 55321.4388; train_edge_recon_loss: 2674958.8912; train_gene_expr_recon_loss: 12285646.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33430.9776; train_chrom_access_recon_loss: 4873570.2748; train_global_loss: 19922928.5344; train_optim_loss: 19922928.5344; val_kl_reg_loss: 54158.0146; val_edge_recon_loss: 2680230.4167; val_gene_expr_recon_loss: 12175726.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33499.6680; val_chrom_access_recon_loss: 4836502.5000; val_global_loss: 19780117.2000; val_optim_loss: 19780117.2000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9723; val_auprc_score: 0.9645; val_best_acc_score: 0.9217; val_best_f1_score: 0.9246; train_kl_reg_loss: 54982.1711; train_edge_recon_loss: 2671167.7137; train_gene_expr_recon_loss: 12268066.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33397.8705; train_chrom_access_recon_loss: 4864007.7405; train_global_loss: 19891621.8473; train_optim_loss: 19891621.8473; val_kl_reg_loss: 53242.8141; val_edge_recon_loss: 2683666.6000; val_gene_expr_recon_loss: 12126382.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33413.0156; val_chrom_access_recon_loss: 4839933.2000; val_global_loss: 19736637.8667; val_optim_loss: 19736637.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9740; val_auprc_score: 0.9648; val_best_acc_score: 0.9254; val_best_f1_score: 0.9267; train_kl_reg_loss: 53501.9238; train_edge_recon_loss: 2664342.4427; train_gene_expr_recon_loss: 12253047.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33427.5041; train_chrom_access_recon_loss: 4857786.6718; train_global_loss: 19862106.4122; train_optim_loss: 19862106.4122; val_kl_reg_loss: 53351.1776; val_edge_recon_loss: 2685043.9667; val_gene_expr_recon_loss: 12090840.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33484.1406; val_chrom_access_recon_loss: 4824956.3333; val_global_loss: 19687675.6000; val_optim_loss: 19687675.6000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9755; val_auprc_score: 0.9673; val_best_acc_score: 0.9294; val_best_f1_score: 0.9308; train_kl_reg_loss: 53255.3847; train_edge_recon_loss: 2651927.1126; train_gene_expr_recon_loss: 12226322.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33488.3708; train_chrom_access_recon_loss: 4844455.8130; train_global_loss: 19809449.5878; train_optim_loss: 19809449.5878; val_kl_reg_loss: 52485.5878; val_edge_recon_loss: 2661599.0667; val_gene_expr_recon_loss: 12110876.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33516.8867; val_chrom_access_recon_loss: 4834236.7333; val_global_loss: 19692714.9333; val_optim_loss: 19692714.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9733; val_auprc_score: 0.9615; val_best_acc_score: 0.9251; val_best_f1_score: 0.9277; train_kl_reg_loss: 52474.6251; train_edge_recon_loss: 2660456.3721; train_gene_expr_recon_loss: 12231272.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33595.5183; train_chrom_access_recon_loss: 4849790.5267; train_global_loss: 19827589.6489; train_optim_loss: 19827589.6489; val_kl_reg_loss: 52262.9237; val_edge_recon_loss: 2684658.8833; val_gene_expr_recon_loss: 12102924.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33729.1953; val_chrom_access_recon_loss: 4826759.4667; val_global_loss: 19700334.8000; val_optim_loss: 19700334.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9766; val_auprc_score: 0.9700; val_best_acc_score: 0.9312; val_best_f1_score: 0.9323; train_kl_reg_loss: 51754.6155; train_edge_recon_loss: 2653695.1737; train_gene_expr_recon_loss: 12206874.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33830.0833; train_chrom_access_recon_loss: 4834884.5229; train_global_loss: 19781039.2672; train_optim_loss: 19781039.2672; val_kl_reg_loss: 51463.4977; val_edge_recon_loss: 2665393.8333; val_gene_expr_recon_loss: 12091228.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33764.9023; val_chrom_access_recon_loss: 4814845.1333; val_global_loss: 19656695.8667; val_optim_loss: 19656695.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9765; val_auprc_score: 0.9672; val_best_acc_score: 0.9330; val_best_f1_score: 0.9348; train_kl_reg_loss: 51356.1823; train_edge_recon_loss: 2660001.9561; train_gene_expr_recon_loss: 12192580.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33903.2990; train_chrom_access_recon_loss: 4827321.4313; train_global_loss: 19765163.7099; train_optim_loss: 19765163.7099; val_kl_reg_loss: 52404.2510; val_edge_recon_loss: 2650653.4667; val_gene_expr_recon_loss: 12077060.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34230.6445; val_chrom_access_recon_loss: 4817434.8000; val_global_loss: 19631784.2667; val_optim_loss: 19631784.2667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9781; val_auprc_score: 0.9732; val_best_acc_score: 0.9329; val_best_f1_score: 0.9349; train_kl_reg_loss: 51268.3950; train_edge_recon_loss: 2659838.6050; train_gene_expr_recon_loss: 12188543.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34136.6985; train_chrom_access_recon_loss: 4826939.0992; train_global_loss: 19760726.0153; train_optim_loss: 19760726.0153; val_kl_reg_loss: 51282.6690; val_edge_recon_loss: 2681127.9833; val_gene_expr_recon_loss: 12085274.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34277.2227; val_chrom_access_recon_loss: 4806054.8667; val_global_loss: 19658016.8000; val_optim_loss: 19658016.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9773; val_auprc_score: 0.9686; val_best_acc_score: 0.9361; val_best_f1_score: 0.9379; train_kl_reg_loss: 50541.8292; train_edge_recon_loss: 2658682.6011; train_gene_expr_recon_loss: 12162522.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34376.0520; train_chrom_access_recon_loss: 4816891.4771; train_global_loss: 19723014.2443; train_optim_loss: 19723014.2443; val_kl_reg_loss: 50848.4729; val_edge_recon_loss: 2665554.9833; val_gene_expr_recon_loss: 12048060.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34513.6523; val_chrom_access_recon_loss: 4792496.6333; val_global_loss: 19591475.0667; val_optim_loss: 19591475.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9793; val_auprc_score: 0.9718; val_best_acc_score: 0.9379; val_best_f1_score: 0.9395; train_kl_reg_loss: 49715.7342; train_edge_recon_loss: 2661417.7557; train_gene_expr_recon_loss: 12153059.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34533.4159; train_chrom_access_recon_loss: 4808224.8435; train_global_loss: 19706951.1145; train_optim_loss: 19706951.1145; val_kl_reg_loss: 49545.2664; val_edge_recon_loss: 2648746.7833; val_gene_expr_recon_loss: 12067384.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34755.4688; val_chrom_access_recon_loss: 4803600.9333; val_global_loss: 19604032.4000; val_optim_loss: 19604032.4000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9826; val_auprc_score: 0.9791; val_best_acc_score: 0.9395; val_best_f1_score: 0.9406; train_kl_reg_loss: 49211.1925; train_edge_recon_loss: 2654570.6737; train_gene_expr_recon_loss: 12143884.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34773.2187; train_chrom_access_recon_loss: 4802922.1832; train_global_loss: 19685361.8015; train_optim_loss: 19685361.8015; val_kl_reg_loss: 50195.6141; val_edge_recon_loss: 2657952.8667; val_gene_expr_recon_loss: 11998128.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34921.3672; val_chrom_access_recon_loss: 4774538.6333; val_global_loss: 19515736.5333; val_optim_loss: 19515736.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9820; val_auprc_score: 0.9747; val_best_acc_score: 0.9429; val_best_f1_score: 0.9442; train_kl_reg_loss: 49159.7897; train_edge_recon_loss: 2661415.3817; train_gene_expr_recon_loss: 12138515.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35002.3201; train_chrom_access_recon_loss: 4797877.8588; train_global_loss: 19681970.6718; train_optim_loss: 19681970.6718; val_kl_reg_loss: 48524.8812; val_edge_recon_loss: 2647519.4000; val_gene_expr_recon_loss: 12023449.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35239.1797; val_chrom_access_recon_loss: 4792439.5667; val_global_loss: 19547172.2667; val_optim_loss: 19547172.2667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9793; val_auprc_score: 0.9737; val_best_acc_score: 0.9344; val_best_f1_score: 0.9364; train_kl_reg_loss: 48924.6426; train_edge_recon_loss: 2651866.5153; train_gene_expr_recon_loss: 12126839.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35226.6803; train_chrom_access_recon_loss: 4792088.1679; train_global_loss: 19654945.4351; train_optim_loss: 19654945.4351; val_kl_reg_loss: 48644.0716; val_edge_recon_loss: 2679602.4000; val_gene_expr_recon_loss: 12013927.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35279.2266; val_chrom_access_recon_loss: 4803756.9333; val_global_loss: 19581209.6000; val_optim_loss: 19581209.6000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9841; val_auprc_score: 0.9810; val_best_acc_score: 0.9438; val_best_f1_score: 0.9448; train_kl_reg_loss: 48595.8585; train_edge_recon_loss: 2649954.6031; train_gene_expr_recon_loss: 12111496.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35408.3352; train_chrom_access_recon_loss: 4782445.1756; train_global_loss: 19627900.9466; train_optim_loss: 19627900.9466; val_kl_reg_loss: 48197.8805; val_edge_recon_loss: 2644064.0833; val_gene_expr_recon_loss: 11977110.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35684.0781; val_chrom_access_recon_loss: 4771585.5667; val_global_loss: 19476642.5333; val_optim_loss: 19476642.5333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9825; val_auprc_score: 0.9786; val_best_acc_score: 0.9394; val_best_f1_score: 0.9409; train_kl_reg_loss: 48035.7006; train_edge_recon_loss: 2651783.9962; train_gene_expr_recon_loss: 12096329.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35678.2133; train_chrom_access_recon_loss: 4776960.9160; train_global_loss: 19608787.9084; train_optim_loss: 19608787.9084; val_kl_reg_loss: 48111.0484; val_edge_recon_loss: 2671683.6500; val_gene_expr_recon_loss: 12077126.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35676.6250; val_chrom_access_recon_loss: 4799547.1667; val_global_loss: 19632145.3333; val_optim_loss: 19632145.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9848; val_auprc_score: 0.9800; val_best_acc_score: 0.9465; val_best_f1_score: 0.9475; train_kl_reg_loss: 47691.5718; train_edge_recon_loss: 2651685.3435; train_gene_expr_recon_loss: 12086159.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35800.9480; train_chrom_access_recon_loss: 4770059.8740; train_global_loss: 19591397.5420; train_optim_loss: 19591397.5420; val_kl_reg_loss: 48424.4018; val_edge_recon_loss: 2651124.3167; val_gene_expr_recon_loss: 11990905.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36106.0000; val_chrom_access_recon_loss: 4763114.4333; val_global_loss: 19489674.4000; val_optim_loss: 19489674.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9838; val_auprc_score: 0.9783; val_best_acc_score: 0.9485; val_best_f1_score: 0.9498; train_kl_reg_loss: 47824.8031; train_edge_recon_loss: 2641850.1870; train_gene_expr_recon_loss: 12087459.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35925.5017; train_chrom_access_recon_loss: 4772688.3206; train_global_loss: 19585748.7786; train_optim_loss: 19585748.7786; val_kl_reg_loss: 47262.7534; val_edge_recon_loss: 2656299.9000; val_gene_expr_recon_loss: 12012700.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36426.3789; val_chrom_access_recon_loss: 4780987.0667; val_global_loss: 19533676.2667; val_optim_loss: 19533676.2667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9853; val_auprc_score: 0.9810; val_best_acc_score: 0.9484; val_best_f1_score: 0.9497; train_kl_reg_loss: 47909.9543; train_edge_recon_loss: 2641473.8531; train_gene_expr_recon_loss: 12077297.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36286.0265; train_chrom_access_recon_loss: 4764671.2824; train_global_loss: 19567638.6565; train_optim_loss: 19567638.6565; val_kl_reg_loss: 48002.7604; val_edge_recon_loss: 2653413.1667; val_gene_expr_recon_loss: 11997557.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36596.3789; val_chrom_access_recon_loss: 4787391.5333; val_global_loss: 19522960.6667; val_optim_loss: 19522960.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9838; val_auprc_score: 0.9800; val_best_acc_score: 0.9446; val_best_f1_score: 0.9460; train_kl_reg_loss: 48268.5870; train_edge_recon_loss: 2639242.5973; train_gene_expr_recon_loss: 12058427.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30620.5866; train_chrom_access_recon_loss: 4752701.0878; train_global_loss: 19529260.3053; train_optim_loss: 19529260.3053; val_kl_reg_loss: 48811.4089; val_edge_recon_loss: 2664791.6833; val_gene_expr_recon_loss: 11977225.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29368.8379; val_chrom_access_recon_loss: 4762897.6667; val_global_loss: 19483095.0667; val_optim_loss: 19483095.0667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9841; val_auprc_score: 0.9798; val_best_acc_score: 0.9458; val_best_f1_score: 0.9466; train_kl_reg_loss: 48852.5268; train_edge_recon_loss: 2639844.7080; train_gene_expr_recon_loss: 12056584.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29120.2750; train_chrom_access_recon_loss: 4750875.6794; train_global_loss: 19525277.2824; train_optim_loss: 19525277.2824; val_kl_reg_loss: 48814.9221; val_edge_recon_loss: 2651601.7333; val_gene_expr_recon_loss: 11923384.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28966.2812; val_chrom_access_recon_loss: 4744935.4000; val_global_loss: 19397702.4000; val_optim_loss: 19397702.4000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9854; val_auprc_score: 0.9787; val_best_acc_score: 0.9481; val_best_f1_score: 0.9493; train_kl_reg_loss: 48935.4256; train_edge_recon_loss: 2646609.1298; train_gene_expr_recon_loss: 12044713.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28849.8937; train_chrom_access_recon_loss: 4746521.9885; train_global_loss: 19515630.1985; train_optim_loss: 19515630.1985; val_kl_reg_loss: 48890.2268; val_edge_recon_loss: 2640044.4500; val_gene_expr_recon_loss: 11975502.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28739.6641; val_chrom_access_recon_loss: 4760466.2667; val_global_loss: 19453643.4667; val_optim_loss: 19453643.4667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9847; val_auprc_score: 0.9813; val_best_acc_score: 0.9481; val_best_f1_score: 0.9493; train_kl_reg_loss: 48904.6545; train_edge_recon_loss: 2644042.2748; train_gene_expr_recon_loss: 12042500.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28677.2637; train_chrom_access_recon_loss: 4748562.2023; train_global_loss: 19512687.3893; train_optim_loss: 19512687.3893; val_kl_reg_loss: 48720.8708; val_edge_recon_loss: 2647090.9000; val_gene_expr_recon_loss: 11971932.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28606.3145; val_chrom_access_recon_loss: 4762578.0333; val_global_loss: 19458927.8667; val_optim_loss: 19458927.8667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9861; val_auprc_score: 0.9820; val_best_acc_score: 0.9475; val_best_f1_score: 0.9482; train_kl_reg_loss: 48825.2464; train_edge_recon_loss: 2641217.9580; train_gene_expr_recon_loss: 12048354.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28572.9396; train_chrom_access_recon_loss: 4747897.2786; train_global_loss: 19514868.1985; train_optim_loss: 19514868.1985; val_kl_reg_loss: 48489.6352; val_edge_recon_loss: 2659646.8167; val_gene_expr_recon_loss: 12009955.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28520.9102; val_chrom_access_recon_loss: 4746372.7667; val_global_loss: 19492986.4000; val_optim_loss: 19492986.4000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9855; val_auprc_score: 0.9812; val_best_acc_score: 0.9496; val_best_f1_score: 0.9507; train_kl_reg_loss: 48773.7116; train_edge_recon_loss: 2638408.2500; train_gene_expr_recon_loss: 12035450.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28491.4778; train_chrom_access_recon_loss: 4742334.1679; train_global_loss: 19493458.7023; train_optim_loss: 19493458.7023; val_kl_reg_loss: 48618.4255; val_edge_recon_loss: 2646556.4333; val_gene_expr_recon_loss: 11985083.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28424.8477; val_chrom_access_recon_loss: 4765886.9333; val_global_loss: 19474570.1333; val_optim_loss: 19474570.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9867; val_auprc_score: 0.9835; val_best_acc_score: 0.9483; val_best_f1_score: 0.9489; train_kl_reg_loss: 48576.8447; train_edge_recon_loss: 2640584.2996; train_gene_expr_recon_loss: 12033070.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27853.1329; train_chrom_access_recon_loss: 4739785.9084; train_global_loss: 19489870.1985; train_optim_loss: 19489870.1985; val_kl_reg_loss: 48657.6292; val_edge_recon_loss: 2646938.0667; val_gene_expr_recon_loss: 11975312.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27735.2051; val_chrom_access_recon_loss: 4753865.6333; val_global_loss: 19452508.2667; val_optim_loss: 19452508.2667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9839; val_auprc_score: 0.9788; val_best_acc_score: 0.9476; val_best_f1_score: 0.9488; train_kl_reg_loss: 48844.3599; train_edge_recon_loss: 2638736.9771; train_gene_expr_recon_loss: 12033941.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27707.7952; train_chrom_access_recon_loss: 4741191.1374; train_global_loss: 19490421.9542; train_optim_loss: 19490421.9542; val_kl_reg_loss: 48784.0083; val_edge_recon_loss: 2660563.1833; val_gene_expr_recon_loss: 12019267.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27684.7969; val_chrom_access_recon_loss: 4776601.3667; val_global_loss: 19532901.4667; val_optim_loss: 19532901.4667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9860; val_auprc_score: 0.9825; val_best_acc_score: 0.9469; val_best_f1_score: 0.9484; train_kl_reg_loss: 48911.5074; train_edge_recon_loss: 2641111.4599; train_gene_expr_recon_loss: 12040387.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27666.6696; train_chrom_access_recon_loss: 4743135.3626; train_global_loss: 19501212.9771; train_optim_loss: 19501212.9771; val_kl_reg_loss: 48868.5956; val_edge_recon_loss: 2651667.8500; val_gene_expr_recon_loss: 11964798.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27654.6562; val_chrom_access_recon_loss: 4755364.6000; val_global_loss: 19448354.4000; val_optim_loss: 19448354.4000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9854; val_auprc_score: 0.9797; val_best_acc_score: 0.9475; val_best_f1_score: 0.9487; train_kl_reg_loss: 48928.9952; train_edge_recon_loss: 2638341.2481; train_gene_expr_recon_loss: 12034353.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27641.0412; train_chrom_access_recon_loss: 4742240.4695; train_global_loss: 19491505.1450; train_optim_loss: 19491505.1450; val_kl_reg_loss: 48864.5521; val_edge_recon_loss: 2646608.6167; val_gene_expr_recon_loss: 11964919.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27631.3047; val_chrom_access_recon_loss: 4753641.2333; val_global_loss: 19441664.8000; val_optim_loss: 19441664.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 64 min 23 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9858
val AUPRC score: 0.9810
val best accuracy score: 0.9468
val best F1 score: 0.9476
val target rna MSE score: 0.8895
val source rna MSE score: 0.1780
val target atac MSE score: 0.4997
val source atac MSE score: 0.0772
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
