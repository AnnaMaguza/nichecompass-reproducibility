[True]
Run timestamp: 26072023_233244_69.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_69']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8783; val_auprc_score: 0.9755; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 198178.6708; train_edge_recon_loss: 1144506.0799; train_gene_expr_recon_loss: 3390022.5959; train_masked_gp_l1_reg_loss: 7920.8884; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4740628.2302; train_optim_loss: 4740628.2302; val_kl_reg_loss: 204932.5488; val_edge_recon_loss: 1199974.4479; val_gene_expr_recon_loss: 2870758.7812; val_masked_gp_l1_reg_loss: 8249.4395; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4283915.2917; val_optim_loss: 4283915.2917
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8673; val_auprc_score: 0.9743; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 116072.5736; train_edge_recon_loss: 1136422.8026; train_gene_expr_recon_loss: 2764327.1047; train_masked_gp_l1_reg_loss: 8588.2316; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4025410.7151; train_optim_loss: 4025410.7151; val_kl_reg_loss: 74256.7819; val_edge_recon_loss: 1196555.5234; val_gene_expr_recon_loss: 2420624.4479; val_masked_gp_l1_reg_loss: 8882.5498; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3700319.2292; val_optim_loss: 3700319.2292
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8502; val_auprc_score: 0.9708; val_best_acc_score: 0.8618; val_best_f1_score: 0.9246; train_kl_reg_loss: 71939.2488; train_edge_recon_loss: 1090303.5619; train_gene_expr_recon_loss: 2323157.0686; train_masked_gp_l1_reg_loss: 9008.4633; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3494408.3419; train_optim_loss: 3494408.3419; val_kl_reg_loss: 58297.9723; val_edge_recon_loss: 1199328.3411; val_gene_expr_recon_loss: 2278615.1562; val_masked_gp_l1_reg_loss: 9090.2588; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3545331.7604; val_optim_loss: 3545331.7604
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8165; val_auprc_score: 0.9630; val_best_acc_score: 0.8659; val_best_f1_score: 0.9266; train_kl_reg_loss: 52153.6190; train_edge_recon_loss: 1062287.6523; train_gene_expr_recon_loss: 1557781.0395; train_masked_gp_l1_reg_loss: 9493.4340; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2681715.7419; train_optim_loss: 2681715.7419; val_kl_reg_loss: 48737.1982; val_edge_recon_loss: 1191507.8307; val_gene_expr_recon_loss: 1009587.7917; val_masked_gp_l1_reg_loss: 9743.8682; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2259576.5781; val_optim_loss: 2259576.5781
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8264; val_auprc_score: 0.9619; val_best_acc_score: 0.8833; val_best_f1_score: 0.9357; train_kl_reg_loss: 45791.0344; train_edge_recon_loss: 1030725.7532; train_gene_expr_recon_loss: 992331.3953; train_masked_gp_l1_reg_loss: 9811.3132; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2078659.4884; train_optim_loss: 2078659.4884; val_kl_reg_loss: 40653.7557; val_edge_recon_loss: 1032086.3047; val_gene_expr_recon_loss: 973696.9010; val_masked_gp_l1_reg_loss: 9947.1689; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2056384.1250; val_optim_loss: 2056384.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8401; val_auprc_score: 0.9631; val_best_acc_score: 0.8845; val_best_f1_score: 0.9357; train_kl_reg_loss: 49636.4701; train_edge_recon_loss: 966265.4195; train_gene_expr_recon_loss: 963238.9517; train_masked_gp_l1_reg_loss: 10171.5514; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1989312.3959; train_optim_loss: 1989312.3959; val_kl_reg_loss: 52785.4826; val_edge_recon_loss: 951000.0260; val_gene_expr_recon_loss: 949248.5156; val_masked_gp_l1_reg_loss: 10402.8018; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1963436.7760; val_optim_loss: 1963436.7760
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8467; val_auprc_score: 0.9653; val_best_acc_score: 0.8888; val_best_f1_score: 0.9382; train_kl_reg_loss: 53087.5116; train_edge_recon_loss: 922249.0253; train_gene_expr_recon_loss: 938935.5395; train_masked_gp_l1_reg_loss: 10596.1743; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1924868.2500; train_optim_loss: 1924868.2500; val_kl_reg_loss: 49893.8949; val_edge_recon_loss: 927190.9141; val_gene_expr_recon_loss: 926959.8542; val_masked_gp_l1_reg_loss: 10788.2871; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1914832.9010; val_optim_loss: 1914832.9010
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8498; val_auprc_score: 0.9664; val_best_acc_score: 0.9007; val_best_f1_score: 0.9447; train_kl_reg_loss: 48679.2364; train_edge_recon_loss: 901366.9756; train_gene_expr_recon_loss: 917783.7892; train_masked_gp_l1_reg_loss: 10954.9160; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1878784.9174; train_optim_loss: 1878784.9174; val_kl_reg_loss: 44704.1034; val_edge_recon_loss: 883069.4505; val_gene_expr_recon_loss: 907198.1927; val_masked_gp_l1_reg_loss: 11130.4248; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1846102.1042; val_optim_loss: 1846102.1042
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8557; val_auprc_score: 0.9667; val_best_acc_score: 0.9002; val_best_f1_score: 0.9443; train_kl_reg_loss: 43645.2431; train_edge_recon_loss: 890527.6424; train_gene_expr_recon_loss: 899414.9683; train_masked_gp_l1_reg_loss: 11301.3216; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1844889.1733; train_optim_loss: 1844889.1733; val_kl_reg_loss: 39843.2915; val_edge_recon_loss: 904156.5339; val_gene_expr_recon_loss: 889253.6693; val_masked_gp_l1_reg_loss: 11474.3926; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1844727.8594; val_optim_loss: 1844727.8594
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8589; val_auprc_score: 0.9683; val_best_acc_score: 0.9031; val_best_f1_score: 0.9453; train_kl_reg_loss: 40008.2080; train_edge_recon_loss: 877334.1616; train_gene_expr_recon_loss: 881989.5576; train_masked_gp_l1_reg_loss: 11651.9765; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1810983.9023; train_optim_loss: 1810983.9023; val_kl_reg_loss: 36054.6808; val_edge_recon_loss: 889966.1979; val_gene_expr_recon_loss: 873484.9661; val_masked_gp_l1_reg_loss: 11821.1016; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1811326.9792; val_optim_loss: 1811326.9792
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8773; val_auprc_score: 0.9715; val_best_acc_score: 0.9094; val_best_f1_score: 0.9487; train_kl_reg_loss: 37192.3429; train_edge_recon_loss: 859454.2221; train_gene_expr_recon_loss: 865938.0953; train_masked_gp_l1_reg_loss: 11990.3383; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1774575.0000; train_optim_loss: 1774575.0000; val_kl_reg_loss: 36166.6553; val_edge_recon_loss: 863809.5000; val_gene_expr_recon_loss: 857303.3802; val_masked_gp_l1_reg_loss: 12144.8721; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1769424.4062; val_optim_loss: 1769424.4062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8824; val_auprc_score: 0.9720; val_best_acc_score: 0.9068; val_best_f1_score: 0.9470; train_kl_reg_loss: 33984.2254; train_edge_recon_loss: 844517.4093; train_gene_expr_recon_loss: 850451.4453; train_masked_gp_l1_reg_loss: 12290.5593; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1741243.6314; train_optim_loss: 1741243.6314; val_kl_reg_loss: 30841.6873; val_edge_recon_loss: 885145.6484; val_gene_expr_recon_loss: 843341.2839; val_masked_gp_l1_reg_loss: 12425.0674; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1771753.7500; val_optim_loss: 1771753.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8987; val_auprc_score: 0.9788; val_best_acc_score: 0.9121; val_best_f1_score: 0.9503; train_kl_reg_loss: 30703.2360; train_edge_recon_loss: 838359.8765; train_gene_expr_recon_loss: 837101.0779; train_masked_gp_l1_reg_loss: 12533.4236; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1718697.6203; train_optim_loss: 1718697.6203; val_kl_reg_loss: 27873.3020; val_edge_recon_loss: 817400.1302; val_gene_expr_recon_loss: 833528.8021; val_masked_gp_l1_reg_loss: 12622.1797; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1691424.3750; val_optim_loss: 1691424.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9112; val_auprc_score: 0.9804; val_best_acc_score: 0.9132; val_best_f1_score: 0.9502; train_kl_reg_loss: 27499.5779; train_edge_recon_loss: 819021.7422; train_gene_expr_recon_loss: 825730.4297; train_masked_gp_l1_reg_loss: 12661.1348; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1684912.8814; train_optim_loss: 1684912.8814; val_kl_reg_loss: 24098.2587; val_edge_recon_loss: 848140.8281; val_gene_expr_recon_loss: 821200.8880; val_masked_gp_l1_reg_loss: 12678.3682; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1706118.3594; val_optim_loss: 1706118.3594
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9204; val_auprc_score: 0.9825; val_best_acc_score: 0.9186; val_best_f1_score: 0.9531; train_kl_reg_loss: 24222.4570; train_edge_recon_loss: 813621.3349; train_gene_expr_recon_loss: 814914.3459; train_masked_gp_l1_reg_loss: 12661.3559; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1665419.4948; train_optim_loss: 1665419.4948; val_kl_reg_loss: 22575.9806; val_edge_recon_loss: 820772.2500; val_gene_expr_recon_loss: 810173.2786; val_masked_gp_l1_reg_loss: 12616.5078; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1666138.0104; val_optim_loss: 1666138.0104
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9232; val_auprc_score: 0.9822; val_best_acc_score: 0.9237; val_best_f1_score: 0.9559; train_kl_reg_loss: 20838.0258; train_edge_recon_loss: 800568.1241; train_gene_expr_recon_loss: 804716.8398; train_masked_gp_l1_reg_loss: 12526.2032; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1638649.1942; train_optim_loss: 1638649.1942; val_kl_reg_loss: 18621.6698; val_edge_recon_loss: 805578.2526; val_gene_expr_recon_loss: 799546.7943; val_masked_gp_l1_reg_loss: 12415.4150; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1636162.0885; val_optim_loss: 1636162.0885
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9258; val_auprc_score: 0.9833; val_best_acc_score: 0.9249; val_best_f1_score: 0.9570; train_kl_reg_loss: 18412.6292; train_edge_recon_loss: 791251.5523; train_gene_expr_recon_loss: 795137.7962; train_masked_gp_l1_reg_loss: 12260.5695; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1617062.5477; train_optim_loss: 1617062.5477; val_kl_reg_loss: 17509.1398; val_edge_recon_loss: 790721.1354; val_gene_expr_recon_loss: 789851.9688; val_masked_gp_l1_reg_loss: 12080.4609; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1610162.7500; val_optim_loss: 1610162.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9348; val_auprc_score: 0.9864; val_best_acc_score: 0.9237; val_best_f1_score: 0.9557; train_kl_reg_loss: 16172.8944; train_edge_recon_loss: 795346.1625; train_gene_expr_recon_loss: 786529.2948; train_masked_gp_l1_reg_loss: 11878.7184; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1609927.0669; train_optim_loss: 1609927.0669; val_kl_reg_loss: 15592.0934; val_edge_recon_loss: 801885.7214; val_gene_expr_recon_loss: 783147.8047; val_masked_gp_l1_reg_loss: 11670.8965; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1612296.5052; val_optim_loss: 1612296.5052
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9333; val_auprc_score: 0.9859; val_best_acc_score: 0.9254; val_best_f1_score: 0.9570; train_kl_reg_loss: 15070.2065; train_edge_recon_loss: 786796.7541; train_gene_expr_recon_loss: 778277.0233; train_masked_gp_l1_reg_loss: 11422.0149; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1591565.9971; train_optim_loss: 1591565.9971; val_kl_reg_loss: 14306.3135; val_edge_recon_loss: 788203.5156; val_gene_expr_recon_loss: 774531.5443; val_masked_gp_l1_reg_loss: 11159.0723; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1588200.4948; val_optim_loss: 1588200.4948
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9387; val_auprc_score: 0.9861; val_best_acc_score: 0.9320; val_best_f1_score: 0.9607; train_kl_reg_loss: 14016.1588; train_edge_recon_loss: 789161.4009; train_gene_expr_recon_loss: 770390.9907; train_masked_gp_l1_reg_loss: 10917.3588; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1584485.9105; train_optim_loss: 1584485.9105; val_kl_reg_loss: 13166.4232; val_edge_recon_loss: 792523.0000; val_gene_expr_recon_loss: 767314.9948; val_masked_gp_l1_reg_loss: 10660.9131; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1583665.3021; val_optim_loss: 1583665.3021
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9447; val_auprc_score: 0.9880; val_best_acc_score: 0.9330; val_best_f1_score: 0.9610; train_kl_reg_loss: 13518.9200; train_edge_recon_loss: 777990.6791; train_gene_expr_recon_loss: 763526.6709; train_masked_gp_l1_reg_loss: 10419.3372; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1565455.6035; train_optim_loss: 1565455.6035; val_kl_reg_loss: 13569.1339; val_edge_recon_loss: 774353.3229; val_gene_expr_recon_loss: 761675.9427; val_masked_gp_l1_reg_loss: 10174.6172; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1559773.0312; val_optim_loss: 1559773.0312
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9416; val_auprc_score: 0.9873; val_best_acc_score: 0.9301; val_best_f1_score: 0.9595; train_kl_reg_loss: 13300.8214; train_edge_recon_loss: 788676.4872; train_gene_expr_recon_loss: 757070.8026; train_masked_gp_l1_reg_loss: 9937.7940; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1568985.9058; train_optim_loss: 1568985.9058; val_kl_reg_loss: 13274.2369; val_edge_recon_loss: 800522.7109; val_gene_expr_recon_loss: 753680.2240; val_masked_gp_l1_reg_loss: 9696.1494; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1577173.3021; val_optim_loss: 1577173.3021
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9470; val_auprc_score: 0.9882; val_best_acc_score: 0.9361; val_best_f1_score: 0.9630; train_kl_reg_loss: 12941.8366; train_edge_recon_loss: 779514.5279; train_gene_expr_recon_loss: 751525.2733; train_masked_gp_l1_reg_loss: 9480.9216; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1553462.5686; train_optim_loss: 1553462.5686; val_kl_reg_loss: 12025.8756; val_edge_recon_loss: 790543.2005; val_gene_expr_recon_loss: 749445.4557; val_masked_gp_l1_reg_loss: 9277.4014; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1561291.9167; val_optim_loss: 1561291.9167
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9433; val_auprc_score: 0.9867; val_best_acc_score: 0.9328; val_best_f1_score: 0.9611; train_kl_reg_loss: 13023.6368; train_edge_recon_loss: 786831.1419; train_gene_expr_recon_loss: 745929.6456; train_masked_gp_l1_reg_loss: 9079.1173; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1554863.5343; train_optim_loss: 1554863.5343; val_kl_reg_loss: 13024.4526; val_edge_recon_loss: 813332.8672; val_gene_expr_recon_loss: 743714.6510; val_masked_gp_l1_reg_loss: 8886.1836; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1578958.0781; val_optim_loss: 1578958.0781
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9472; val_auprc_score: 0.9882; val_best_acc_score: 0.9376; val_best_f1_score: 0.9639; train_kl_reg_loss: 12913.5006; train_edge_recon_loss: 771311.2093; train_gene_expr_recon_loss: 741196.4012; train_masked_gp_l1_reg_loss: 8701.5993; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1534122.7151; train_optim_loss: 1534122.7151; val_kl_reg_loss: 11850.4264; val_edge_recon_loss: 785437.1484; val_gene_expr_recon_loss: 738540.6302; val_masked_gp_l1_reg_loss: 8530.2939; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1544358.4583; val_optim_loss: 1544358.4583
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9555; val_auprc_score: 0.9892; val_best_acc_score: 0.9409; val_best_f1_score: 0.9657; train_kl_reg_loss: 11008.9024; train_edge_recon_loss: 773222.1172; train_gene_expr_recon_loss: 748315.3029; train_masked_gp_l1_reg_loss: 8429.3014; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1540975.6238; train_optim_loss: 1540975.6238; val_kl_reg_loss: 5237.2988; val_edge_recon_loss: 806066.7708; val_gene_expr_recon_loss: 746512.3385; val_masked_gp_l1_reg_loss: 8279.1055; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1566095.5260; val_optim_loss: 1566095.5260
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9551; val_auprc_score: 0.9899; val_best_acc_score: 0.9468; val_best_f1_score: 0.9693; train_kl_reg_loss: 9654.4730; train_edge_recon_loss: 768172.4581; train_gene_expr_recon_loss: 742335.4837; train_masked_gp_l1_reg_loss: 8073.6706; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1528236.0773; train_optim_loss: 1528236.0773; val_kl_reg_loss: 5146.2926; val_edge_recon_loss: 776157.6172; val_gene_expr_recon_loss: 741671.1276; val_masked_gp_l1_reg_loss: 7888.6792; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1530863.6771; val_optim_loss: 1530863.6771
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9546; val_auprc_score: 0.9889; val_best_acc_score: 0.9431; val_best_f1_score: 0.9669; train_kl_reg_loss: 8931.6693; train_edge_recon_loss: 773992.6049; train_gene_expr_recon_loss: 738673.5026; train_masked_gp_l1_reg_loss: 7734.2388; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1529332.0134; train_optim_loss: 1529332.0134; val_kl_reg_loss: 5022.1834; val_edge_recon_loss: 805908.6354; val_gene_expr_recon_loss: 738974.0677; val_masked_gp_l1_reg_loss: 7602.6133; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1557507.5000; val_optim_loss: 1557507.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9537; val_auprc_score: 0.9894; val_best_acc_score: 0.9460; val_best_f1_score: 0.9688; train_kl_reg_loss: 8207.4497; train_edge_recon_loss: 777327.6884; train_gene_expr_recon_loss: 735356.2860; train_masked_gp_l1_reg_loss: 7450.9221; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1528342.3547; train_optim_loss: 1528342.3547; val_kl_reg_loss: 4842.5160; val_edge_recon_loss: 790261.0391; val_gene_expr_recon_loss: 735082.7786; val_masked_gp_l1_reg_loss: 7290.7153; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1537477.0729; val_optim_loss: 1537477.0729
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9617; val_auprc_score: 0.9917; val_best_acc_score: 0.9505; val_best_f1_score: 0.9713; train_kl_reg_loss: 7776.9555; train_edge_recon_loss: 769989.4032; train_gene_expr_recon_loss: 732318.6378; train_masked_gp_l1_reg_loss: 7150.9094; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1517235.9029; train_optim_loss: 1517235.9029; val_kl_reg_loss: 5035.3827; val_edge_recon_loss: 785297.0833; val_gene_expr_recon_loss: 731578.8125; val_masked_gp_l1_reg_loss: 6992.6699; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1528903.9062; val_optim_loss: 1528903.9062
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9575; val_auprc_score: 0.9906; val_best_acc_score: 0.9486; val_best_f1_score: 0.9702; train_kl_reg_loss: 7488.2060; train_edge_recon_loss: 767773.0483; train_gene_expr_recon_loss: 728994.1770; train_masked_gp_l1_reg_loss: 6866.1572; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1511121.5884; train_optim_loss: 1511121.5884; val_kl_reg_loss: 4901.4468; val_edge_recon_loss: 780210.7422; val_gene_expr_recon_loss: 729122.1016; val_masked_gp_l1_reg_loss: 6729.1089; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1520963.4062; val_optim_loss: 1520963.4062
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9565; val_auprc_score: 0.9900; val_best_acc_score: 0.9496; val_best_f1_score: 0.9709; train_kl_reg_loss: 7094.5247; train_edge_recon_loss: 771544.9811; train_gene_expr_recon_loss: 726386.0823; train_masked_gp_l1_reg_loss: 6627.7612; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1511653.3442; train_optim_loss: 1511653.3442; val_kl_reg_loss: 5102.2882; val_edge_recon_loss: 784755.9010; val_gene_expr_recon_loss: 725704.4974; val_masked_gp_l1_reg_loss: 6506.9229; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1522069.5729; val_optim_loss: 1522069.5729
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9623; val_auprc_score: 0.9914; val_best_acc_score: 0.9495; val_best_f1_score: 0.9707; train_kl_reg_loss: 6850.5097; train_edge_recon_loss: 764383.7137; train_gene_expr_recon_loss: 724109.3488; train_masked_gp_l1_reg_loss: 6411.9436; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1501755.5157; train_optim_loss: 1501755.5157; val_kl_reg_loss: 4914.0095; val_edge_recon_loss: 781142.1328; val_gene_expr_recon_loss: 723785.1302; val_masked_gp_l1_reg_loss: 6319.7046; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1516161.0156; val_optim_loss: 1516161.0156
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9630; val_auprc_score: 0.9922; val_best_acc_score: 0.9525; val_best_f1_score: 0.9727; train_kl_reg_loss: 6743.9894; train_edge_recon_loss: 768888.9887; train_gene_expr_recon_loss: 721961.3939; train_masked_gp_l1_reg_loss: 6229.5871; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1503823.9605; train_optim_loss: 1503823.9605; val_kl_reg_loss: 5193.4275; val_edge_recon_loss: 761030.3984; val_gene_expr_recon_loss: 721967.2708; val_masked_gp_l1_reg_loss: 6128.9805; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1494320.1146; val_optim_loss: 1494320.1146
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9583; val_auprc_score: 0.9904; val_best_acc_score: 0.9504; val_best_f1_score: 0.9712; train_kl_reg_loss: 6607.4258; train_edge_recon_loss: 774199.1378; train_gene_expr_recon_loss: 719947.8654; train_masked_gp_l1_reg_loss: 6051.1910; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1506805.6151; train_optim_loss: 1506805.6151; val_kl_reg_loss: 5341.1586; val_edge_recon_loss: 789795.6484; val_gene_expr_recon_loss: 720183.8984; val_masked_gp_l1_reg_loss: 5976.8706; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1521297.5833; val_optim_loss: 1521297.5833
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9676; val_auprc_score: 0.9933; val_best_acc_score: 0.9543; val_best_f1_score: 0.9735; train_kl_reg_loss: 6583.8382; train_edge_recon_loss: 760431.0875; train_gene_expr_recon_loss: 718133.2331; train_masked_gp_l1_reg_loss: 5907.5426; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1491055.6953; train_optim_loss: 1491055.6953; val_kl_reg_loss: 5057.5433; val_edge_recon_loss: 779734.2448; val_gene_expr_recon_loss: 718248.5885; val_masked_gp_l1_reg_loss: 5847.2417; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1508887.6510; val_optim_loss: 1508887.6510
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9680; val_auprc_score: 0.9928; val_best_acc_score: 0.9542; val_best_f1_score: 0.9735; train_kl_reg_loss: 6446.7885; train_edge_recon_loss: 763683.4558; train_gene_expr_recon_loss: 716472.3759; train_masked_gp_l1_reg_loss: 5783.7771; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1492386.3913; train_optim_loss: 1492386.3913; val_kl_reg_loss: 5123.2545; val_edge_recon_loss: 785163.9557; val_gene_expr_recon_loss: 717122.3958; val_masked_gp_l1_reg_loss: 5724.5811; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1513134.2396; val_optim_loss: 1513134.2396
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9641; val_auprc_score: 0.9918; val_best_acc_score: 0.9533; val_best_f1_score: 0.9729; train_kl_reg_loss: 6441.7168; train_edge_recon_loss: 769607.7494; train_gene_expr_recon_loss: 714944.1314; train_masked_gp_l1_reg_loss: 5659.5980; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1496653.1988; train_optim_loss: 1496653.1988; val_kl_reg_loss: 4820.4358; val_edge_recon_loss: 782914.5755; val_gene_expr_recon_loss: 715689.5573; val_masked_gp_l1_reg_loss: 5599.2246; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1509023.8021; val_optim_loss: 1509023.8021

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9605; val_auprc_score: 0.9903; val_best_acc_score: 0.9516; val_best_f1_score: 0.9718; train_kl_reg_loss: 6146.8998; train_edge_recon_loss: 762523.3767; train_gene_expr_recon_loss: 712880.6122; train_masked_gp_l1_reg_loss: 5553.2936; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1487104.1802; train_optim_loss: 1487104.1802; val_kl_reg_loss: 5220.0038; val_edge_recon_loss: 801325.9010; val_gene_expr_recon_loss: 713297.7865; val_masked_gp_l1_reg_loss: 5539.5342; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1525383.1979; val_optim_loss: 1525383.1979
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9624; val_auprc_score: 0.9904; val_best_acc_score: 0.9551; val_best_f1_score: 0.9741; train_kl_reg_loss: 6191.1114; train_edge_recon_loss: 760633.3471; train_gene_expr_recon_loss: 712149.0724; train_masked_gp_l1_reg_loss: 5539.1300; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1484512.6570; train_optim_loss: 1484512.6570; val_kl_reg_loss: 5274.8956; val_edge_recon_loss: 777076.6289; val_gene_expr_recon_loss: 713171.5260; val_masked_gp_l1_reg_loss: 5536.1729; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1501059.1771; val_optim_loss: 1501059.1771
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9669; val_auprc_score: 0.9925; val_best_acc_score: 0.9554; val_best_f1_score: 0.9742; train_kl_reg_loss: 6157.0514; train_edge_recon_loss: 771481.1497; train_gene_expr_recon_loss: 712090.1291; train_masked_gp_l1_reg_loss: 5534.7428; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1495263.0703; train_optim_loss: 1495263.0703; val_kl_reg_loss: 5219.9870; val_edge_recon_loss: 773767.0781; val_gene_expr_recon_loss: 713141.7266; val_masked_gp_l1_reg_loss: 5534.9438; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1497663.7812; val_optim_loss: 1497663.7812
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9652; val_auprc_score: 0.9910; val_best_acc_score: 0.9551; val_best_f1_score: 0.9740; train_kl_reg_loss: 6151.1430; train_edge_recon_loss: 765766.3413; train_gene_expr_recon_loss: 711903.2625; train_masked_gp_l1_reg_loss: 5533.0482; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1489353.7919; train_optim_loss: 1489353.7919; val_kl_reg_loss: 5295.8774; val_edge_recon_loss: 783792.4401; val_gene_expr_recon_loss: 713002.6328; val_masked_gp_l1_reg_loss: 5532.1719; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1507623.0781; val_optim_loss: 1507623.0781

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 16 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9594
Val AUPRC score: 0.9899
Val best accuracy score: 0.9528
Val best F1 score: 0.9728
Val gene expr MSE score: 162861.4136
Val cat covariate0 mean sim diff: -0.0022

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
