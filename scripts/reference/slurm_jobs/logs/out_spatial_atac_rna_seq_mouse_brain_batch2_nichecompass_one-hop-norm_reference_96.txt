[True]
Run timestamp: 26072023_025841_96.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_96']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9008; val_auprc_score: 0.9093; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 10644.6962; train_edge_recon_loss: 3484917.1389; train_gene_expr_recon_loss: 31826572.0000; train_masked_gp_l1_reg_loss: 1937.0246; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1082917.7639; train_global_loss: 36406990.2222; train_optim_loss: 36406990.2222; val_kl_reg_loss: 68507.7344; val_edge_recon_loss: 4065849.7500; val_gene_expr_recon_loss: 29850546.0000; val_masked_gp_l1_reg_loss: 2009.9537; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1083632.7500; val_global_loss: 35070544.0000; val_optim_loss: 35070544.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8880; val_auprc_score: 0.8930; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 64531.5030; train_edge_recon_loss: 3566787.0556; train_gene_expr_recon_loss: 28519501.7778; train_masked_gp_l1_reg_loss: 2116.7233; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1074343.3542; train_global_loss: 33227279.5556; train_optim_loss: 33227279.5556; val_kl_reg_loss: 98370.7188; val_edge_recon_loss: 4065944.5000; val_gene_expr_recon_loss: 27167734.0000; val_masked_gp_l1_reg_loss: 2266.4180; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061858.0000; val_global_loss: 32396174.0000; val_optim_loss: 32396174.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8719; val_auprc_score: 0.8746; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 111097.6024; train_edge_recon_loss: 3599131.3611; train_gene_expr_recon_loss: 26197975.3333; train_masked_gp_l1_reg_loss: 2392.5907; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043351.3125; train_global_loss: 30953947.7778; train_optim_loss: 30953947.7778; val_kl_reg_loss: 111458.1094; val_edge_recon_loss: 4065825.2500; val_gene_expr_recon_loss: 25192056.0000; val_masked_gp_l1_reg_loss: 2538.6370; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1043132.3750; val_global_loss: 30415010.0000; val_optim_loss: 30415010.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8826; val_auprc_score: 0.8819; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 143423.7778; train_edge_recon_loss: 3643592.0556; train_gene_expr_recon_loss: 24528619.3333; train_masked_gp_l1_reg_loss: 2618.3532; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1021487.4861; train_global_loss: 29339740.4444; train_optim_loss: 29339740.4444; val_kl_reg_loss: 140121.1250; val_edge_recon_loss: 4065739.7500; val_gene_expr_recon_loss: 23834560.0000; val_masked_gp_l1_reg_loss: 2693.4087; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1025765.8750; val_global_loss: 29068880.0000; val_optim_loss: 29068880.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8957; val_auprc_score: 0.8949; val_best_acc_score: 0.5035; val_best_f1_score: 0.6682; train_kl_reg_loss: 170510.0503; train_edge_recon_loss: 3635191.8333; train_gene_expr_recon_loss: 23358079.1111; train_masked_gp_l1_reg_loss: 2725.4767; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007130.4514; train_global_loss: 28173636.8889; train_optim_loss: 28173636.8889; val_kl_reg_loss: 168826.9688; val_edge_recon_loss: 4065488.5000; val_gene_expr_recon_loss: 22918644.0000; val_masked_gp_l1_reg_loss: 2754.6851; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016044.6875; val_global_loss: 28171758.0000; val_optim_loss: 28171758.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8933; val_auprc_score: 0.8849; val_best_acc_score: 0.5062; val_best_f1_score: 0.6694; train_kl_reg_loss: 195636.7969; train_edge_recon_loss: 3636099.0556; train_gene_expr_recon_loss: 22451048.0000; train_masked_gp_l1_reg_loss: 2766.2323; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 998452.3264; train_global_loss: 27284002.6667; train_optim_loss: 27284002.6667; val_kl_reg_loss: 163899.2031; val_edge_recon_loss: 4065131.2500; val_gene_expr_recon_loss: 22315850.0000; val_masked_gp_l1_reg_loss: 2775.5786; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1008269.0625; val_global_loss: 27555926.0000; val_optim_loss: 27555926.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8921; val_auprc_score: 0.8800; val_best_acc_score: 0.5139; val_best_f1_score: 0.6728; train_kl_reg_loss: 200439.7517; train_edge_recon_loss: 3640405.1944; train_gene_expr_recon_loss: 21969110.6667; train_masked_gp_l1_reg_loss: 2780.2778; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 989902.5139; train_global_loss: 26802638.6667; train_optim_loss: 26802638.6667; val_kl_reg_loss: 168802.6562; val_edge_recon_loss: 4064361.5000; val_gene_expr_recon_loss: 21816318.0000; val_masked_gp_l1_reg_loss: 2783.4985; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1001549.6875; val_global_loss: 27053816.0000; val_optim_loss: 27053816.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8918; val_auprc_score: 0.8807; val_best_acc_score: 0.5371; val_best_f1_score: 0.6834; train_kl_reg_loss: 208920.4826; train_edge_recon_loss: 3637923.5833; train_gene_expr_recon_loss: 21686410.0000; train_masked_gp_l1_reg_loss: 2782.7754; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988249.4375; train_global_loss: 26524286.4444; train_optim_loss: 26524286.4444; val_kl_reg_loss: 185954.5625; val_edge_recon_loss: 4063075.5000; val_gene_expr_recon_loss: 21527330.0000; val_masked_gp_l1_reg_loss: 2781.2383; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998609.6250; val_global_loss: 26777752.0000; val_optim_loss: 26777752.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8899; val_auprc_score: 0.8785; val_best_acc_score: 0.5880; val_best_f1_score: 0.7071; train_kl_reg_loss: 214321.4462; train_edge_recon_loss: 3627917.8056; train_gene_expr_recon_loss: 21340481.5556; train_masked_gp_l1_reg_loss: 2781.5269; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979815.8819; train_global_loss: 26165319.1111; train_optim_loss: 26165319.1111; val_kl_reg_loss: 166758.0312; val_edge_recon_loss: 4060555.7500; val_gene_expr_recon_loss: 21374368.0000; val_masked_gp_l1_reg_loss: 2782.7722; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 996312.4375; val_global_loss: 26600776.0000; val_optim_loss: 26600776.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8939; val_auprc_score: 0.8835; val_best_acc_score: 0.6691; val_best_f1_score: 0.7491; train_kl_reg_loss: 209826.9722; train_edge_recon_loss: 3628480.9722; train_gene_expr_recon_loss: 21231732.0000; train_masked_gp_l1_reg_loss: 2785.0744; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985333.2708; train_global_loss: 26058158.0000; train_optim_loss: 26058158.0000; val_kl_reg_loss: 163282.4531; val_edge_recon_loss: 4056022.5000; val_gene_expr_recon_loss: 21257308.0000; val_masked_gp_l1_reg_loss: 2788.7561; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 994627.0000; val_global_loss: 26474028.0000; val_optim_loss: 26474028.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8884; val_auprc_score: 0.8702; val_best_acc_score: 0.7048; val_best_f1_score: 0.7683; train_kl_reg_loss: 200539.8073; train_edge_recon_loss: 3617692.0833; train_gene_expr_recon_loss: 21258220.8889; train_masked_gp_l1_reg_loss: 2795.3218; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982714.3056; train_global_loss: 26061962.6667; train_optim_loss: 26061962.6667; val_kl_reg_loss: 164516.7188; val_edge_recon_loss: 4052282.7500; val_gene_expr_recon_loss: 21186518.0000; val_masked_gp_l1_reg_loss: 2804.0591; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 992702.0000; val_global_loss: 26398824.0000; val_optim_loss: 26398824.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8912; val_auprc_score: 0.8775; val_best_acc_score: 0.7505; val_best_f1_score: 0.7940; train_kl_reg_loss: 197154.4288; train_edge_recon_loss: 3606001.8333; train_gene_expr_recon_loss: 21053674.2222; train_masked_gp_l1_reg_loss: 2811.1809; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976591.5694; train_global_loss: 25836232.8889; train_optim_loss: 25836232.8889; val_kl_reg_loss: 170783.9062; val_edge_recon_loss: 4045587.7500; val_gene_expr_recon_loss: 21116584.0000; val_masked_gp_l1_reg_loss: 2819.7620; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 991031.7500; val_global_loss: 26326808.0000; val_optim_loss: 26326808.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8860; val_auprc_score: 0.8716; val_best_acc_score: 0.7816; val_best_f1_score: 0.8106; train_kl_reg_loss: 195697.2691; train_edge_recon_loss: 3594758.0278; train_gene_expr_recon_loss: 20979976.0000; train_masked_gp_l1_reg_loss: 2826.4053; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979751.5903; train_global_loss: 25753009.1111; train_optim_loss: 25753009.1111; val_kl_reg_loss: 156511.8125; val_edge_recon_loss: 4035199.2500; val_gene_expr_recon_loss: 21060012.0000; val_masked_gp_l1_reg_loss: 2835.1006; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 988961.8125; val_global_loss: 26243522.0000; val_optim_loss: 26243522.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8944; val_auprc_score: 0.8831; val_best_acc_score: 0.8115; val_best_f1_score: 0.8245; train_kl_reg_loss: 189284.0226; train_edge_recon_loss: 3592237.7778; train_gene_expr_recon_loss: 20912276.0000; train_masked_gp_l1_reg_loss: 2843.1390; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975896.0278; train_global_loss: 25672537.1111; train_optim_loss: 25672537.1111; val_kl_reg_loss: 156003.9375; val_edge_recon_loss: 4018607.5000; val_gene_expr_recon_loss: 21030980.0000; val_masked_gp_l1_reg_loss: 2852.3564; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 988635.5000; val_global_loss: 26197080.0000; val_optim_loss: 26197080.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8914; val_auprc_score: 0.8750; val_best_acc_score: 0.8073; val_best_f1_score: 0.8113; train_kl_reg_loss: 183074.7240; train_edge_recon_loss: 3582244.9167; train_gene_expr_recon_loss: 20796383.1111; train_masked_gp_l1_reg_loss: 2860.0044; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969064.2083; train_global_loss: 25533626.8889; train_optim_loss: 25533626.8889; val_kl_reg_loss: 167958.8750; val_edge_recon_loss: 4000761.5000; val_gene_expr_recon_loss: 20995274.0000; val_masked_gp_l1_reg_loss: 2868.9351; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 988647.7500; val_global_loss: 26155510.0000; val_optim_loss: 26155510.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8952; val_auprc_score: 0.8792; val_best_acc_score: 0.8048; val_best_f1_score: 0.7935; train_kl_reg_loss: 179758.6163; train_edge_recon_loss: 3568347.1389; train_gene_expr_recon_loss: 20895890.2222; train_masked_gp_l1_reg_loss: 2875.9809; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971431.8403; train_global_loss: 25618303.7778; train_optim_loss: 25618303.7778; val_kl_reg_loss: 144864.6250; val_edge_recon_loss: 3974566.5000; val_gene_expr_recon_loss: 20934594.0000; val_masked_gp_l1_reg_loss: 2884.7046; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 986334.2500; val_global_loss: 26043242.0000; val_optim_loss: 26043242.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9018; val_auprc_score: 0.8909; val_best_acc_score: 0.7881; val_best_f1_score: 0.8170; train_kl_reg_loss: 173251.4253; train_edge_recon_loss: 3561600.5278; train_gene_expr_recon_loss: 20852521.5556; train_masked_gp_l1_reg_loss: 2892.3459; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974163.7986; train_global_loss: 25564429.5556; train_optim_loss: 25564429.5556; val_kl_reg_loss: 150844.9375; val_edge_recon_loss: 3927508.5000; val_gene_expr_recon_loss: 20893504.0000; val_masked_gp_l1_reg_loss: 2901.7598; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 986035.9375; val_global_loss: 25960796.0000; val_optim_loss: 25960796.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8931; val_auprc_score: 0.8712; val_best_acc_score: 0.8072; val_best_f1_score: 0.8279; train_kl_reg_loss: 167446.9167; train_edge_recon_loss: 3542487.8333; train_gene_expr_recon_loss: 20841242.4444; train_masked_gp_l1_reg_loss: 2908.8501; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970533.3056; train_global_loss: 25524619.1111; train_optim_loss: 25524619.1111; val_kl_reg_loss: 129341.7031; val_edge_recon_loss: 3866824.7500; val_gene_expr_recon_loss: 20871192.0000; val_masked_gp_l1_reg_loss: 2918.6294; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985030.7500; val_global_loss: 25855306.0000; val_optim_loss: 25855306.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8972; val_auprc_score: 0.8814; val_best_acc_score: 0.8204; val_best_f1_score: 0.8318; train_kl_reg_loss: 156994.4740; train_edge_recon_loss: 3522918.9167; train_gene_expr_recon_loss: 20806247.3333; train_masked_gp_l1_reg_loss: 2928.1396; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969366.3264; train_global_loss: 25458455.1111; train_optim_loss: 25458455.1111; val_kl_reg_loss: 144251.6406; val_edge_recon_loss: 3797624.5000; val_gene_expr_recon_loss: 20843530.0000; val_masked_gp_l1_reg_loss: 2939.6216; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984612.6875; val_global_loss: 25772958.0000; val_optim_loss: 25772958.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8980; val_auprc_score: 0.8804; val_best_acc_score: 0.8174; val_best_f1_score: 0.8296; train_kl_reg_loss: 153564.8385; train_edge_recon_loss: 3488324.3056; train_gene_expr_recon_loss: 20641517.7778; train_masked_gp_l1_reg_loss: 2947.4169; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972041.9514; train_global_loss: 25258396.0000; train_optim_loss: 25258396.0000; val_kl_reg_loss: 122249.1719; val_edge_recon_loss: 3686063.2500; val_gene_expr_recon_loss: 20822022.0000; val_masked_gp_l1_reg_loss: 2955.4849; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 983288.8750; val_global_loss: 25616578.0000; val_optim_loss: 25616578.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8992; val_auprc_score: 0.8814; val_best_acc_score: 0.8201; val_best_f1_score: 0.8329; train_kl_reg_loss: 142282.9384; train_edge_recon_loss: 3447681.3889; train_gene_expr_recon_loss: 20670684.0000; train_masked_gp_l1_reg_loss: 2962.9363; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963279.4722; train_global_loss: 25226890.2222; train_optim_loss: 25226890.2222; val_kl_reg_loss: 123910.0469; val_edge_recon_loss: 3573078.0000; val_gene_expr_recon_loss: 20809040.0000; val_masked_gp_l1_reg_loss: 2972.5537; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 983061.6250; val_global_loss: 25492062.0000; val_optim_loss: 25492062.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8944; val_auprc_score: 0.8752; val_best_acc_score: 0.8104; val_best_f1_score: 0.8256; train_kl_reg_loss: 142115.6528; train_edge_recon_loss: 3372311.9167; train_gene_expr_recon_loss: 20616510.0000; train_masked_gp_l1_reg_loss: 2980.6910; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967866.9792; train_global_loss: 25101785.1111; train_optim_loss: 25101785.1111; val_kl_reg_loss: 122245.4219; val_edge_recon_loss: 3427037.0000; val_gene_expr_recon_loss: 20803410.0000; val_masked_gp_l1_reg_loss: 2991.1064; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982266.0000; val_global_loss: 25337950.0000; val_optim_loss: 25337950.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8969; val_auprc_score: 0.8786; val_best_acc_score: 0.8146; val_best_f1_score: 0.8250; train_kl_reg_loss: 144037.8845; train_edge_recon_loss: 3294174.1111; train_gene_expr_recon_loss: 20759982.2222; train_masked_gp_l1_reg_loss: 3000.4060; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965746.7014; train_global_loss: 25166942.0000; train_optim_loss: 25166942.0000; val_kl_reg_loss: 143370.4062; val_edge_recon_loss: 3273337.0000; val_gene_expr_recon_loss: 20797500.0000; val_masked_gp_l1_reg_loss: 3011.6135; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982904.7500; val_global_loss: 25200124.0000; val_optim_loss: 25200124.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8941; val_auprc_score: 0.8771; val_best_acc_score: 0.8058; val_best_f1_score: 0.8177; train_kl_reg_loss: 161538.4653; train_edge_recon_loss: 3206279.2222; train_gene_expr_recon_loss: 20457649.7778; train_masked_gp_l1_reg_loss: 3022.8314; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960827.1875; train_global_loss: 24789316.6667; train_optim_loss: 24789316.6667; val_kl_reg_loss: 163842.1250; val_edge_recon_loss: 3175200.2500; val_gene_expr_recon_loss: 20758688.0000; val_masked_gp_l1_reg_loss: 3034.7827; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 980916.1875; val_global_loss: 25081680.0000; val_optim_loss: 25081680.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8888; val_auprc_score: 0.8715; val_best_acc_score: 0.8006; val_best_f1_score: 0.8145; train_kl_reg_loss: 184791.4913; train_edge_recon_loss: 3121968.0556; train_gene_expr_recon_loss: 20619283.3333; train_masked_gp_l1_reg_loss: 3044.7215; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967696.6806; train_global_loss: 24896784.4444; train_optim_loss: 24896784.4444; val_kl_reg_loss: 190420.8438; val_edge_recon_loss: 3076381.7500; val_gene_expr_recon_loss: 20753130.0000; val_masked_gp_l1_reg_loss: 3056.7849; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 980283.3750; val_global_loss: 25003272.0000; val_optim_loss: 25003272.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9085; val_auprc_score: 0.8893; val_best_acc_score: 0.8301; val_best_f1_score: 0.8373; train_kl_reg_loss: 208704.9323; train_edge_recon_loss: 3457279.0278; train_gene_expr_recon_loss: 20798767.5556; train_masked_gp_l1_reg_loss: 3068.5051; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961751.6528; train_global_loss: 25429571.3333; train_optim_loss: 25429571.3333; val_kl_reg_loss: 87976.1406; val_edge_recon_loss: 3400265.7500; val_gene_expr_recon_loss: 21031884.0000; val_masked_gp_l1_reg_loss: 3082.9912; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982988.8750; val_global_loss: 25506196.0000; val_optim_loss: 25506196.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9087; val_auprc_score: 0.8928; val_best_acc_score: 0.8289; val_best_f1_score: 0.8361; train_kl_reg_loss: 213074.8351; train_edge_recon_loss: 3357223.4167; train_gene_expr_recon_loss: 20819658.8889; train_masked_gp_l1_reg_loss: 3099.6239; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967793.2917; train_global_loss: 25360850.0000; train_optim_loss: 25360850.0000; val_kl_reg_loss: 88490.7031; val_edge_recon_loss: 3430504.0000; val_gene_expr_recon_loss: 20965600.0000; val_masked_gp_l1_reg_loss: 3120.9883; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979812.6250; val_global_loss: 25467526.0000; val_optim_loss: 25467526.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9091; val_auprc_score: 0.8917; val_best_acc_score: 0.8302; val_best_f1_score: 0.8392; train_kl_reg_loss: 183184.7153; train_edge_recon_loss: 3401582.4722; train_gene_expr_recon_loss: 20872072.6667; train_masked_gp_l1_reg_loss: 3137.9846; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959671.1528; train_global_loss: 25419649.5556; train_optim_loss: 25419649.5556; val_kl_reg_loss: 74779.4219; val_edge_recon_loss: 3475570.5000; val_gene_expr_recon_loss: 21100712.0000; val_masked_gp_l1_reg_loss: 3159.4773; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 980127.3125; val_global_loss: 25634350.0000; val_optim_loss: 25634350.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9011; val_auprc_score: 0.8825; val_best_acc_score: 0.8182; val_best_f1_score: 0.8300; train_kl_reg_loss: 140647.0095; train_edge_recon_loss: 3449665.1111; train_gene_expr_recon_loss: 21134069.5556; train_masked_gp_l1_reg_loss: 3178.0429; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968472.3819; train_global_loss: 25696032.2222; train_optim_loss: 25696032.2222; val_kl_reg_loss: 59006.2148; val_edge_recon_loss: 3493059.5000; val_gene_expr_recon_loss: 21093630.0000; val_masked_gp_l1_reg_loss: 3202.3687; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978385.2500; val_global_loss: 25627284.0000; val_optim_loss: 25627284.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9078; val_auprc_score: 0.8928; val_best_acc_score: 0.8230; val_best_f1_score: 0.8332; train_kl_reg_loss: 123541.4123; train_edge_recon_loss: 3457464.3333; train_gene_expr_recon_loss: 21031766.2222; train_masked_gp_l1_reg_loss: 3204.1577; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964106.7708; train_global_loss: 25580082.6667; train_optim_loss: 25580082.6667; val_kl_reg_loss: 59220.0078; val_edge_recon_loss: 3451997.2500; val_gene_expr_recon_loss: 21095644.0000; val_masked_gp_l1_reg_loss: 3206.2178; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979190.2500; val_global_loss: 25589258.0000; val_optim_loss: 25589258.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9028; val_auprc_score: 0.8849; val_best_acc_score: 0.8155; val_best_f1_score: 0.8269; train_kl_reg_loss: 126769.4809; train_edge_recon_loss: 3435368.5000; train_gene_expr_recon_loss: 20917333.7778; train_masked_gp_l1_reg_loss: 3207.6956; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962421.1111; train_global_loss: 25445100.4444; train_optim_loss: 25445100.4444; val_kl_reg_loss: 62789.4453; val_edge_recon_loss: 3471969.2500; val_gene_expr_recon_loss: 21056436.0000; val_masked_gp_l1_reg_loss: 3209.5408; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978821.7500; val_global_loss: 25573226.0000; val_optim_loss: 25573226.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9047; val_auprc_score: 0.8882; val_best_acc_score: 0.8203; val_best_f1_score: 0.8303; train_kl_reg_loss: 132952.7431; train_edge_recon_loss: 3418146.5833; train_gene_expr_recon_loss: 20959503.3333; train_masked_gp_l1_reg_loss: 3210.9599; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964253.0486; train_global_loss: 25478066.4444; train_optim_loss: 25478066.4444; val_kl_reg_loss: 64478.6328; val_edge_recon_loss: 3454341.0000; val_gene_expr_recon_loss: 21049618.0000; val_masked_gp_l1_reg_loss: 3212.6770; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978744.6250; val_global_loss: 25550394.0000; val_optim_loss: 25550394.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9069; val_auprc_score: 0.8920; val_best_acc_score: 0.8231; val_best_f1_score: 0.8321; train_kl_reg_loss: 138671.2604; train_edge_recon_loss: 3400954.4167; train_gene_expr_recon_loss: 21152696.6667; train_masked_gp_l1_reg_loss: 3213.9709; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963977.7292; train_global_loss: 25659513.3333; train_optim_loss: 25659513.3333; val_kl_reg_loss: 67581.8828; val_edge_recon_loss: 3428837.7500; val_gene_expr_recon_loss: 21056520.0000; val_masked_gp_l1_reg_loss: 3215.5701; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 980375.3125; val_global_loss: 25536532.0000; val_optim_loss: 25536532.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 41 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9092
Val AUPRC score: 0.8910
Val best accuracy score: 0.8321
Val best F1 score: 0.8389
Val gene expr MSE score: 0.5405
Val chrom access MSE score: 0.0897
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
