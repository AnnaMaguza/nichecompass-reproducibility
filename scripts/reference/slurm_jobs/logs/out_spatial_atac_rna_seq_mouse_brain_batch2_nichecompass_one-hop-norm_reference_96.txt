[True]
Run timestamp: 07082023_202522_96.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_96']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8895; val_auprc_score: 0.8992; val_best_acc_score: 0.5106; val_best_f1_score: 0.6714; train_kl_reg_loss: 23675.7944; train_edge_recon_loss: 350942.0104; train_gene_expr_recon_loss: 1200896.5208; train_masked_gp_l1_reg_loss: 8682.0131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166956.5868; train_chrom_access_recon_loss: 789456.5486; train_global_loss: 2540609.5000; train_optim_loss: 2540609.5000; val_kl_reg_loss: 9618.7637; val_edge_recon_loss: 406492.4688; val_gene_expr_recon_loss: 999112.1250; val_masked_gp_l1_reg_loss: 7152.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162423.3125; val_chrom_access_recon_loss: 505889.5000; val_global_loss: 2090688.2500; val_optim_loss: 2090688.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8895; val_auprc_score: 0.9023; val_best_acc_score: 0.5055; val_best_f1_score: 0.6691; train_kl_reg_loss: 11071.3647; train_edge_recon_loss: 353957.1944; train_gene_expr_recon_loss: 925740.2917; train_masked_gp_l1_reg_loss: 6672.7766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159510.5156; train_chrom_access_recon_loss: 492568.6389; train_global_loss: 1949520.7639; train_optim_loss: 1949520.7639; val_kl_reg_loss: 13825.3496; val_edge_recon_loss: 406537.3125; val_gene_expr_recon_loss: 826623.0000; val_masked_gp_l1_reg_loss: 6385.5347; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155857.7500; val_chrom_access_recon_loss: 465062.2500; val_global_loss: 1874291.1250; val_optim_loss: 1874291.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8812; val_auprc_score: 0.8944; val_best_acc_score: 0.5150; val_best_f1_score: 0.6734; train_kl_reg_loss: 15700.8249; train_edge_recon_loss: 357619.9653; train_gene_expr_recon_loss: 812010.6875; train_masked_gp_l1_reg_loss: 6521.2044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152653.1128; train_chrom_access_recon_loss: 467711.9028; train_global_loss: 1812217.7083; train_optim_loss: 1812217.7083; val_kl_reg_loss: 14486.2295; val_edge_recon_loss: 406490.1562; val_gene_expr_recon_loss: 773205.2500; val_masked_gp_l1_reg_loss: 6683.0366; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148369.0469; val_chrom_access_recon_loss: 450073.0000; val_global_loss: 1799306.6250; val_optim_loss: 1799306.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8641; val_auprc_score: 0.8741; val_best_acc_score: 0.5241; val_best_f1_score: 0.6763; train_kl_reg_loss: 16590.8862; train_edge_recon_loss: 357241.7882; train_gene_expr_recon_loss: 773097.5139; train_masked_gp_l1_reg_loss: 6719.2683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144586.5156; train_chrom_access_recon_loss: 458456.0451; train_global_loss: 1756692.0139; train_optim_loss: 1756692.0139; val_kl_reg_loss: 16572.5254; val_edge_recon_loss: 406373.1875; val_gene_expr_recon_loss: 739207.4375; val_masked_gp_l1_reg_loss: 6745.6279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139704.1250; val_chrom_access_recon_loss: 444670.5938; val_global_loss: 1753273.5000; val_optim_loss: 1753273.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8552; val_auprc_score: 0.8596; val_best_acc_score: 0.5418; val_best_f1_score: 0.6820; train_kl_reg_loss: 17929.6131; train_edge_recon_loss: 358188.8194; train_gene_expr_recon_loss: 740276.4167; train_masked_gp_l1_reg_loss: 6762.6165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135609.5556; train_chrom_access_recon_loss: 452151.1875; train_global_loss: 1710918.2361; train_optim_loss: 1710918.2361; val_kl_reg_loss: 17192.0742; val_edge_recon_loss: 406011.5000; val_gene_expr_recon_loss: 717534.3125; val_masked_gp_l1_reg_loss: 6770.6177; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130430.2656; val_chrom_access_recon_loss: 441095.6562; val_global_loss: 1719034.3750; val_optim_loss: 1719034.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8577; val_auprc_score: 0.8567; val_best_acc_score: 0.5892; val_best_f1_score: 0.7029; train_kl_reg_loss: 18815.7732; train_edge_recon_loss: 358009.8889; train_gene_expr_recon_loss: 729271.3264; train_masked_gp_l1_reg_loss: 6782.7492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126261.7717; train_chrom_access_recon_loss: 451031.0521; train_global_loss: 1690172.5694; train_optim_loss: 1690172.5694; val_kl_reg_loss: 17445.8203; val_edge_recon_loss: 405355.4688; val_gene_expr_recon_loss: 701572.1250; val_masked_gp_l1_reg_loss: 6790.6978; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121067.5000; val_chrom_access_recon_loss: 438411.1250; val_global_loss: 1690642.7500; val_optim_loss: 1690642.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8454; val_auprc_score: 0.8445; val_best_acc_score: 0.6584; val_best_f1_score: 0.7356; train_kl_reg_loss: 19078.1658; train_edge_recon_loss: 358079.0035; train_gene_expr_recon_loss: 712739.8958; train_masked_gp_l1_reg_loss: 6805.9498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116979.4115; train_chrom_access_recon_loss: 450315.3611; train_global_loss: 1663997.8333; train_optim_loss: 1663997.8333; val_kl_reg_loss: 16067.2295; val_edge_recon_loss: 404407.9688; val_gene_expr_recon_loss: 692234.5625; val_masked_gp_l1_reg_loss: 6804.4775; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111914.6875; val_chrom_access_recon_loss: 436498.6250; val_global_loss: 1667927.6250; val_optim_loss: 1667927.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8331; val_auprc_score: 0.8406; val_best_acc_score: 0.6746; val_best_f1_score: 0.7406; train_kl_reg_loss: 19060.9379; train_edge_recon_loss: 357973.9931; train_gene_expr_recon_loss: 698916.3958; train_masked_gp_l1_reg_loss: 6819.6596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107999.7274; train_chrom_access_recon_loss: 445492.4896; train_global_loss: 1636263.2500; train_optim_loss: 1636263.2500; val_kl_reg_loss: 19989.8203; val_edge_recon_loss: 403482.4375; val_gene_expr_recon_loss: 681443.6875; val_masked_gp_l1_reg_loss: 6821.4561; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103198.3516; val_chrom_access_recon_loss: 434866.5000; val_global_loss: 1649802.3750; val_optim_loss: 1649802.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8081; val_auprc_score: 0.8080; val_best_acc_score: 0.7049; val_best_f1_score: 0.7454; train_kl_reg_loss: 20087.1693; train_edge_recon_loss: 357151.5208; train_gene_expr_recon_loss: 689157.6389; train_masked_gp_l1_reg_loss: 6829.1476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99520.8550; train_chrom_access_recon_loss: 444455.4931; train_global_loss: 1617201.8056; train_optim_loss: 1617201.8056; val_kl_reg_loss: 17960.5469; val_edge_recon_loss: 401598.1562; val_gene_expr_recon_loss: 675800.7500; val_masked_gp_l1_reg_loss: 6824.1387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95031.8906; val_chrom_access_recon_loss: 433605.9062; val_global_loss: 1630821.3750; val_optim_loss: 1630821.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8145; val_auprc_score: 0.8136; val_best_acc_score: 0.7296; val_best_f1_score: 0.7466; train_kl_reg_loss: 19348.6137; train_edge_recon_loss: 356654.2188; train_gene_expr_recon_loss: 681298.5278; train_masked_gp_l1_reg_loss: 6839.4233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91643.2812; train_chrom_access_recon_loss: 441212.1389; train_global_loss: 1596996.1806; train_optim_loss: 1596996.1806; val_kl_reg_loss: 20262.7227; val_edge_recon_loss: 398622.0625; val_gene_expr_recon_loss: 669369.8750; val_masked_gp_l1_reg_loss: 6842.1006; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87524.1094; val_chrom_access_recon_loss: 432482.6562; val_global_loss: 1615103.5000; val_optim_loss: 1615103.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8220; val_auprc_score: 0.8242; val_best_acc_score: 0.7311; val_best_f1_score: 0.7481; train_kl_reg_loss: 19974.1128; train_edge_recon_loss: 355317.4861; train_gene_expr_recon_loss: 680696.5486; train_masked_gp_l1_reg_loss: 6852.3051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84436.6155; train_chrom_access_recon_loss: 440350.4132; train_global_loss: 1587627.4861; train_optim_loss: 1587627.4861; val_kl_reg_loss: 17613.7617; val_edge_recon_loss: 394235.4688; val_gene_expr_recon_loss: 666826.8125; val_masked_gp_l1_reg_loss: 6856.1694; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80699.9922; val_chrom_access_recon_loss: 431336.7188; val_global_loss: 1597568.8750; val_optim_loss: 1597568.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8322; val_auprc_score: 0.8285; val_best_acc_score: 0.7319; val_best_f1_score: 0.7654; train_kl_reg_loss: 19770.0681; train_edge_recon_loss: 353625.5208; train_gene_expr_recon_loss: 678173.7500; train_masked_gp_l1_reg_loss: 6872.3234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77931.1858; train_chrom_access_recon_loss: 441042.2708; train_global_loss: 1577415.1111; train_optim_loss: 1577415.1111; val_kl_reg_loss: 18391.7578; val_edge_recon_loss: 388406.6875; val_gene_expr_recon_loss: 662091.0000; val_masked_gp_l1_reg_loss: 6876.9971; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74579.5547; val_chrom_access_recon_loss: 430298.6875; val_global_loss: 1580644.7500; val_optim_loss: 1580644.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8335; val_auprc_score: 0.8255; val_best_acc_score: 0.7491; val_best_f1_score: 0.7662; train_kl_reg_loss: 19495.2606; train_edge_recon_loss: 351031.9965; train_gene_expr_recon_loss: 673630.3750; train_masked_gp_l1_reg_loss: 6900.3448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72087.9141; train_chrom_access_recon_loss: 438942.3125; train_global_loss: 1562088.2361; train_optim_loss: 1562088.2361; val_kl_reg_loss: 17785.5820; val_edge_recon_loss: 378682.9375; val_gene_expr_recon_loss: 660468.0000; val_masked_gp_l1_reg_loss: 6916.0850; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69068.1953; val_chrom_access_recon_loss: 429547.7500; val_global_loss: 1562468.6250; val_optim_loss: 1562468.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8527; val_auprc_score: 0.8404; val_best_acc_score: 0.7677; val_best_f1_score: 0.7833; train_kl_reg_loss: 19253.7300; train_edge_recon_loss: 346393.5451; train_gene_expr_recon_loss: 670712.6667; train_masked_gp_l1_reg_loss: 6941.0363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66840.4588; train_chrom_access_recon_loss: 439280.7500; train_global_loss: 1549422.1806; train_optim_loss: 1549422.1806; val_kl_reg_loss: 18227.0566; val_edge_recon_loss: 360837.6562; val_gene_expr_recon_loss: 659607.9375; val_masked_gp_l1_reg_loss: 6956.9863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64128.0664; val_chrom_access_recon_loss: 428884.9062; val_global_loss: 1538642.6250; val_optim_loss: 1538642.6250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8561; val_auprc_score: 0.8453; val_best_acc_score: 0.7687; val_best_f1_score: 0.7847; train_kl_reg_loss: 20158.4141; train_edge_recon_loss: 337985.3507; train_gene_expr_recon_loss: 673641.0903; train_masked_gp_l1_reg_loss: 6987.6485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62120.2548; train_chrom_access_recon_loss: 438769.5104; train_global_loss: 1539662.2639; train_optim_loss: 1539662.2639; val_kl_reg_loss: 20232.1953; val_edge_recon_loss: 342377.3125; val_gene_expr_recon_loss: 658464.0625; val_masked_gp_l1_reg_loss: 7016.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59685.7617; val_chrom_access_recon_loss: 428282.7188; val_global_loss: 1516058.5000; val_optim_loss: 1516058.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8657; val_auprc_score: 0.8584; val_best_acc_score: 0.7741; val_best_f1_score: 0.7914; train_kl_reg_loss: 23382.2355; train_edge_recon_loss: 325870.4167; train_gene_expr_recon_loss: 667680.8264; train_masked_gp_l1_reg_loss: 7056.1567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57886.9705; train_chrom_access_recon_loss: 437441.0764; train_global_loss: 1519317.6528; train_optim_loss: 1519317.6528; val_kl_reg_loss: 24674.0273; val_edge_recon_loss: 323987.5312; val_gene_expr_recon_loss: 657087.5000; val_masked_gp_l1_reg_loss: 7090.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55692.8359; val_chrom_access_recon_loss: 427852.7500; val_global_loss: 1496384.7500; val_optim_loss: 1496384.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8807; val_auprc_score: 0.8689; val_best_acc_score: 0.7899; val_best_f1_score: 0.8062; train_kl_reg_loss: 27813.7765; train_edge_recon_loss: 317097.1389; train_gene_expr_recon_loss: 669268.7500; train_masked_gp_l1_reg_loss: 7119.9237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54065.6220; train_chrom_access_recon_loss: 437411.7222; train_global_loss: 1512776.9722; train_optim_loss: 1512776.9722; val_kl_reg_loss: 27558.8574; val_edge_recon_loss: 316147.8438; val_gene_expr_recon_loss: 653896.5625; val_masked_gp_l1_reg_loss: 7158.5986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52087.1680; val_chrom_access_recon_loss: 426981.9375; val_global_loss: 1483831.0000; val_optim_loss: 1483831.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8893; val_auprc_score: 0.8747; val_best_acc_score: 0.8005; val_best_f1_score: 0.8143; train_kl_reg_loss: 28279.7459; train_edge_recon_loss: 312562.5764; train_gene_expr_recon_loss: 666182.8403; train_masked_gp_l1_reg_loss: 7194.8806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50614.6181; train_chrom_access_recon_loss: 436678.7396; train_global_loss: 1501513.4167; train_optim_loss: 1501513.4167; val_kl_reg_loss: 25867.3359; val_edge_recon_loss: 312465.9688; val_gene_expr_recon_loss: 652893.7500; val_masked_gp_l1_reg_loss: 7223.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48820.8672; val_chrom_access_recon_loss: 426296.3750; val_global_loss: 1473568.2500; val_optim_loss: 1473568.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9024; val_auprc_score: 0.8869; val_best_acc_score: 0.8165; val_best_f1_score: 0.8274; train_kl_reg_loss: 26831.0731; train_edge_recon_loss: 308617.1910; train_gene_expr_recon_loss: 658927.3403; train_masked_gp_l1_reg_loss: 7257.4056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47482.8429; train_chrom_access_recon_loss: 433362.8472; train_global_loss: 1482478.6806; train_optim_loss: 1482478.6806; val_kl_reg_loss: 25946.4023; val_edge_recon_loss: 307608.0000; val_gene_expr_recon_loss: 651913.2500; val_masked_gp_l1_reg_loss: 7287.2417; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45841.8789; val_chrom_access_recon_loss: 425510.4062; val_global_loss: 1464107.1250; val_optim_loss: 1464107.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9156; val_auprc_score: 0.9044; val_best_acc_score: 0.8327; val_best_f1_score: 0.8420; train_kl_reg_loss: 26878.7817; train_edge_recon_loss: 304872.8264; train_gene_expr_recon_loss: 660577.2083; train_masked_gp_l1_reg_loss: 7315.6424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44619.0911; train_chrom_access_recon_loss: 434669.2882; train_global_loss: 1478932.8472; train_optim_loss: 1478932.8472; val_kl_reg_loss: 26325.5176; val_edge_recon_loss: 305214.3750; val_gene_expr_recon_loss: 649265.8125; val_masked_gp_l1_reg_loss: 7350.3120; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43126.5703; val_chrom_access_recon_loss: 424783.7812; val_global_loss: 1456066.3750; val_optim_loss: 1456066.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9217; val_auprc_score: 0.9029; val_best_acc_score: 0.8490; val_best_f1_score: 0.8551; train_kl_reg_loss: 27158.6120; train_edge_recon_loss: 302367.3507; train_gene_expr_recon_loss: 659356.0417; train_masked_gp_l1_reg_loss: 7379.3127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42002.4792; train_chrom_access_recon_loss: 433832.7778; train_global_loss: 1472096.5833; train_optim_loss: 1472096.5833; val_kl_reg_loss: 25548.8242; val_edge_recon_loss: 302347.7812; val_gene_expr_recon_loss: 648145.6250; val_masked_gp_l1_reg_loss: 7406.2754; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40634.1016; val_chrom_access_recon_loss: 424278.4062; val_global_loss: 1448361.0000; val_optim_loss: 1448361.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9287; val_auprc_score: 0.9123; val_best_acc_score: 0.8572; val_best_f1_score: 0.8636; train_kl_reg_loss: 26768.9316; train_edge_recon_loss: 300823.1250; train_gene_expr_recon_loss: 660002.2153; train_masked_gp_l1_reg_loss: 7433.0765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39606.7908; train_chrom_access_recon_loss: 434334.9271; train_global_loss: 1468969.0417; train_optim_loss: 1468969.0417; val_kl_reg_loss: 26460.6543; val_edge_recon_loss: 299187.1250; val_gene_expr_recon_loss: 646345.5000; val_masked_gp_l1_reg_loss: 7458.6299; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38349.4922; val_chrom_access_recon_loss: 423341.2500; val_global_loss: 1441142.6250; val_optim_loss: 1441142.6250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9307; val_auprc_score: 0.9128; val_best_acc_score: 0.8630; val_best_f1_score: 0.8703; train_kl_reg_loss: 27225.0239; train_edge_recon_loss: 298561.2917; train_gene_expr_recon_loss: 657131.1181; train_masked_gp_l1_reg_loss: 7485.4158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37412.9384; train_chrom_access_recon_loss: 433189.3507; train_global_loss: 1461005.1389; train_optim_loss: 1461005.1389; val_kl_reg_loss: 26156.7871; val_edge_recon_loss: 299368.6250; val_gene_expr_recon_loss: 645345.7500; val_masked_gp_l1_reg_loss: 7502.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36255.8906; val_chrom_access_recon_loss: 422792.1250; val_global_loss: 1437421.7500; val_optim_loss: 1437421.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9330; val_auprc_score: 0.9145; val_best_acc_score: 0.8655; val_best_f1_score: 0.8735; train_kl_reg_loss: 26956.8062; train_edge_recon_loss: 297009.7847; train_gene_expr_recon_loss: 657036.8889; train_masked_gp_l1_reg_loss: 7524.2659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35393.6523; train_chrom_access_recon_loss: 431742.6528; train_global_loss: 1455664.0278; train_optim_loss: 1455664.0278; val_kl_reg_loss: 25990.7246; val_edge_recon_loss: 297034.9062; val_gene_expr_recon_loss: 644285.1250; val_masked_gp_l1_reg_loss: 7546.4131; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34332.0273; val_chrom_access_recon_loss: 422339.5000; val_global_loss: 1431528.7500; val_optim_loss: 1431528.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9339; val_auprc_score: 0.9186; val_best_acc_score: 0.8676; val_best_f1_score: 0.8731; train_kl_reg_loss: 26972.4121; train_edge_recon_loss: 295985.5312; train_gene_expr_recon_loss: 657769.2639; train_masked_gp_l1_reg_loss: 7565.7484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33548.9692; train_chrom_access_recon_loss: 433181.2500; train_global_loss: 1455023.1667; train_optim_loss: 1455023.1667; val_kl_reg_loss: 26345.5781; val_edge_recon_loss: 298272.7812; val_gene_expr_recon_loss: 642990.1250; val_masked_gp_l1_reg_loss: 7578.2329; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32575.1074; val_chrom_access_recon_loss: 421567.0938; val_global_loss: 1429329.0000; val_optim_loss: 1429329.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9296; val_auprc_score: 0.9185; val_best_acc_score: 0.8588; val_best_f1_score: 0.8644; train_kl_reg_loss: 24666.4692; train_edge_recon_loss: 303016.7778; train_gene_expr_recon_loss: 982026.5069; train_masked_gp_l1_reg_loss: 7695.6710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31679.5857; train_chrom_access_recon_loss: 456560.4965; train_global_loss: 1805645.5556; train_optim_loss: 1805645.5556; val_kl_reg_loss: 15003.2559; val_edge_recon_loss: 299823.5938; val_gene_expr_recon_loss: 957980.5000; val_masked_gp_l1_reg_loss: 7898.7397; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30463.5195; val_chrom_access_recon_loss: 445182.6250; val_global_loss: 1756352.2500; val_optim_loss: 1756352.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9315; val_auprc_score: 0.9168; val_best_acc_score: 0.8614; val_best_f1_score: 0.8678; train_kl_reg_loss: 23433.9234; train_edge_recon_loss: 296838.7465; train_gene_expr_recon_loss: 974747.0833; train_masked_gp_l1_reg_loss: 8103.5487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29454.5822; train_chrom_access_recon_loss: 455694.8403; train_global_loss: 1788272.7083; train_optim_loss: 1788272.7083; val_kl_reg_loss: 15565.5186; val_edge_recon_loss: 298770.4688; val_gene_expr_recon_loss: 951814.0625; val_masked_gp_l1_reg_loss: 8349.0645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28214.1836; val_chrom_access_recon_loss: 444283.9375; val_global_loss: 1746997.2500; val_optim_loss: 1746997.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9361; val_auprc_score: 0.9211; val_best_acc_score: 0.8693; val_best_f1_score: 0.8754; train_kl_reg_loss: 21677.6029; train_edge_recon_loss: 293862.1111; train_gene_expr_recon_loss: 970759.1944; train_masked_gp_l1_reg_loss: 8510.3052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27270.5877; train_chrom_access_recon_loss: 454195.9792; train_global_loss: 1776275.7639; train_optim_loss: 1776275.7639; val_kl_reg_loss: 16363.2520; val_edge_recon_loss: 293439.6562; val_gene_expr_recon_loss: 948128.6250; val_masked_gp_l1_reg_loss: 8696.4561; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26126.2891; val_chrom_access_recon_loss: 443976.3750; val_global_loss: 1736730.6250; val_optim_loss: 1736730.6250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9390; val_auprc_score: 0.9234; val_best_acc_score: 0.8739; val_best_f1_score: 0.8788; train_kl_reg_loss: 21277.8051; train_edge_recon_loss: 291167.9688; train_gene_expr_recon_loss: 964527.7569; train_masked_gp_l1_reg_loss: 8826.1030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25274.8077; train_chrom_access_recon_loss: 454398.8090; train_global_loss: 1765473.2222; train_optim_loss: 1765473.2222; val_kl_reg_loss: 17669.4570; val_edge_recon_loss: 291499.9375; val_gene_expr_recon_loss: 943708.0000; val_masked_gp_l1_reg_loss: 8973.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24249.2227; val_chrom_access_recon_loss: 443223.6250; val_global_loss: 1729324.0000; val_optim_loss: 1729324.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9361; val_auprc_score: 0.9186; val_best_acc_score: 0.8694; val_best_f1_score: 0.8755; train_kl_reg_loss: 21117.0764; train_edge_recon_loss: 290778.8194; train_gene_expr_recon_loss: 959142.9306; train_masked_gp_l1_reg_loss: 8951.5742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24080.1760; train_chrom_access_recon_loss: 450876.3993; train_global_loss: 1754947.0139; train_optim_loss: 1754947.0139; val_kl_reg_loss: 17473.1973; val_edge_recon_loss: 293480.3125; val_gene_expr_recon_loss: 943764.8750; val_masked_gp_l1_reg_loss: 8932.9834; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23894.9492; val_chrom_access_recon_loss: 443319.6250; val_global_loss: 1730866.0000; val_optim_loss: 1730866.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9387; val_auprc_score: 0.9214; val_best_acc_score: 0.8775; val_best_f1_score: 0.8823; train_kl_reg_loss: 20883.7012; train_edge_recon_loss: 289709.7257; train_gene_expr_recon_loss: 957841.1319; train_masked_gp_l1_reg_loss: 8933.5798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23787.5388; train_chrom_access_recon_loss: 451470.3438; train_global_loss: 1752626.0139; train_optim_loss: 1752626.0139; val_kl_reg_loss: 17575.1055; val_edge_recon_loss: 291023.5312; val_gene_expr_recon_loss: 943155.1250; val_masked_gp_l1_reg_loss: 8931.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23647.9883; val_chrom_access_recon_loss: 443183.4375; val_global_loss: 1727516.7500; val_optim_loss: 1727516.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9375; val_auprc_score: 0.9203; val_best_acc_score: 0.8724; val_best_f1_score: 0.8784; train_kl_reg_loss: 20945.5156; train_edge_recon_loss: 289863.4514; train_gene_expr_recon_loss: 960145.9583; train_masked_gp_l1_reg_loss: 8932.0890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23547.3811; train_chrom_access_recon_loss: 451850.7083; train_global_loss: 1755285.0833; train_optim_loss: 1755285.0833; val_kl_reg_loss: 17507.9180; val_edge_recon_loss: 291861.4062; val_gene_expr_recon_loss: 942819.8750; val_masked_gp_l1_reg_loss: 8933.6201; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23424.6777; val_chrom_access_recon_loss: 443131.9688; val_global_loss: 1727679.5000; val_optim_loss: 1727679.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9375; val_auprc_score: 0.9191; val_best_acc_score: 0.8732; val_best_f1_score: 0.8794; train_kl_reg_loss: 20891.6994; train_edge_recon_loss: 289746.1493; train_gene_expr_recon_loss: 960251.4653; train_masked_gp_l1_reg_loss: 8936.4721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23331.8861; train_chrom_access_recon_loss: 451022.0938; train_global_loss: 1754179.7500; train_optim_loss: 1754179.7500; val_kl_reg_loss: 17439.0000; val_edge_recon_loss: 291153.6250; val_gene_expr_recon_loss: 942525.4375; val_masked_gp_l1_reg_loss: 8940.9092; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23220.7812; val_chrom_access_recon_loss: 443085.4062; val_global_loss: 1726365.0000; val_optim_loss: 1726365.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 28 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9305
val AUPRC score: 0.9171
val best accuracy score: 0.8562
val best F1 score: 0.8642
val target rna MSE score: 3.7237
val source rna MSE score: 3.1151
val target atac MSE score: 0.1295
val source atac MSE score: 0.0198
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
