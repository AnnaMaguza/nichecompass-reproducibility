[True]
Run timestamp: 07092023_194500_96.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_96']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6612; val_auprc_score: 0.6544; val_best_acc_score: 0.5091; val_best_f1_score: 0.6699; train_kl_reg_loss: 94203.2632; train_edge_recon_loss: 3578289.1477; train_gene_expr_recon_loss: 27680689.5455; train_masked_gp_l1_reg_loss: 202350.7069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10733541.7045; train_chrom_access_recon_loss: 14896774.7727; train_global_loss: 57185849.3939; train_optim_loss: 57185849.3939; val_kl_reg_loss: 141268.4824; val_edge_recon_loss: 4065216.5625; val_gene_expr_recon_loss: 25169499.0000; val_masked_gp_l1_reg_loss: 175981.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4608886.0000; val_chrom_access_recon_loss: 14540608.6250; val_global_loss: 48701460.5000; val_optim_loss: 48701460.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6854; val_auprc_score: 0.6743; val_best_acc_score: 0.5610; val_best_f1_score: 0.6871; train_kl_reg_loss: 166435.3840; train_edge_recon_loss: 3568479.9773; train_gene_expr_recon_loss: 24725772.4545; train_masked_gp_l1_reg_loss: 161795.8894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1995428.9006; train_chrom_access_recon_loss: 14139436.2576; train_global_loss: 44757348.9697; train_optim_loss: 44757348.9697; val_kl_reg_loss: 148496.5195; val_edge_recon_loss: 4061736.2500; val_gene_expr_recon_loss: 24528868.0000; val_masked_gp_l1_reg_loss: 154646.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 746660.0000; val_chrom_access_recon_loss: 14248141.8750; val_global_loss: 43888549.5000; val_optim_loss: 43888549.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7464; val_auprc_score: 0.7270; val_best_acc_score: 0.6529; val_best_f1_score: 0.7160; train_kl_reg_loss: 158134.9917; train_edge_recon_loss: 3556389.3371; train_gene_expr_recon_loss: 24394998.6364; train_masked_gp_l1_reg_loss: 153303.6113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 498925.5180; train_chrom_access_recon_loss: 14046211.8485; train_global_loss: 42807963.9394; train_optim_loss: 42807963.9394; val_kl_reg_loss: 155288.6680; val_edge_recon_loss: 4053227.8438; val_gene_expr_recon_loss: 24090592.0000; val_masked_gp_l1_reg_loss: 153915.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 351973.5000; val_chrom_access_recon_loss: 14081596.3750; val_global_loss: 42886594.5000; val_optim_loss: 42886594.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8177; val_auprc_score: 0.7934; val_best_acc_score: 0.7200; val_best_f1_score: 0.7314; train_kl_reg_loss: 143338.5784; train_edge_recon_loss: 3545306.8447; train_gene_expr_recon_loss: 24198659.4545; train_masked_gp_l1_reg_loss: 155721.4283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 293187.6641; train_chrom_access_recon_loss: 13932849.3636; train_global_loss: 42269063.3939; train_optim_loss: 42269063.3939; val_kl_reg_loss: 145473.5801; val_edge_recon_loss: 3999947.0000; val_gene_expr_recon_loss: 23959925.5000; val_masked_gp_l1_reg_loss: 158269.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 249921.2656; val_chrom_access_recon_loss: 13924193.2500; val_global_loss: 42437732.0000; val_optim_loss: 42437732.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8743; val_auprc_score: 0.8464; val_best_acc_score: 0.8004; val_best_f1_score: 0.8106; train_kl_reg_loss: 126371.0876; train_edge_recon_loss: 3505227.2765; train_gene_expr_recon_loss: 24047417.6364; train_masked_gp_l1_reg_loss: 161928.3688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225997.8198; train_chrom_access_recon_loss: 13836586.9242; train_global_loss: 41903529.0909; train_optim_loss: 41903529.0909; val_kl_reg_loss: 109691.3916; val_edge_recon_loss: 3690558.5625; val_gene_expr_recon_loss: 23867090.5000; val_masked_gp_l1_reg_loss: 166080.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 205924.0000; val_chrom_access_recon_loss: 13924714.8750; val_global_loss: 41964059.0000; val_optim_loss: 41964059.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8602; val_auprc_score: 0.8212; val_best_acc_score: 0.7859; val_best_f1_score: 0.8077; train_kl_reg_loss: 123127.6822; train_edge_recon_loss: 3233556.9924; train_gene_expr_recon_loss: 23969985.5152; train_masked_gp_l1_reg_loss: 173087.1828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 193532.2528; train_chrom_access_recon_loss: 13783946.1212; train_global_loss: 41477235.5758; train_optim_loss: 41477235.5758; val_kl_reg_loss: 152947.9375; val_edge_recon_loss: 3061410.6562; val_gene_expr_recon_loss: 23901957.5000; val_masked_gp_l1_reg_loss: 179101.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 184371.1406; val_chrom_access_recon_loss: 14043050.3750; val_global_loss: 41522840.0000; val_optim_loss: 41522840.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8796; val_auprc_score: 0.8445; val_best_acc_score: 0.8146; val_best_f1_score: 0.8299; train_kl_reg_loss: 158126.8071; train_edge_recon_loss: 2968024.6591; train_gene_expr_recon_loss: 23804307.4242; train_masked_gp_l1_reg_loss: 181022.0500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178050.3168; train_chrom_access_recon_loss: 13694000.8939; train_global_loss: 40983532.3030; train_optim_loss: 40983532.3030; val_kl_reg_loss: 152797.6719; val_edge_recon_loss: 2981065.2812; val_gene_expr_recon_loss: 23465696.0000; val_masked_gp_l1_reg_loss: 183734.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172229.5938; val_chrom_access_recon_loss: 13677124.8750; val_global_loss: 40632648.5000; val_optim_loss: 40632648.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8881; val_auprc_score: 0.8557; val_best_acc_score: 0.8229; val_best_f1_score: 0.8347; train_kl_reg_loss: 162155.3097; train_edge_recon_loss: 2922117.7576; train_gene_expr_recon_loss: 23678101.8788; train_masked_gp_l1_reg_loss: 185565.4103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168779.7872; train_chrom_access_recon_loss: 13613625.6212; train_global_loss: 40730345.8182; train_optim_loss: 40730345.8182; val_kl_reg_loss: 160390.7305; val_edge_recon_loss: 2898072.3125; val_gene_expr_recon_loss: 23213429.5000; val_masked_gp_l1_reg_loss: 187584.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165746.9531; val_chrom_access_recon_loss: 13572956.7500; val_global_loss: 40198180.0000; val_optim_loss: 40198180.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8951; val_auprc_score: 0.8598; val_best_acc_score: 0.8323; val_best_f1_score: 0.8465; train_kl_reg_loss: 161619.7299; train_edge_recon_loss: 2905689.8144; train_gene_expr_recon_loss: 23589184.8788; train_masked_gp_l1_reg_loss: 188861.9768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162796.9858; train_chrom_access_recon_loss: 13563249.1364; train_global_loss: 40571402.3030; train_optim_loss: 40571402.3030; val_kl_reg_loss: 162691.2559; val_edge_recon_loss: 2912417.9375; val_gene_expr_recon_loss: 23262568.2500; val_masked_gp_l1_reg_loss: 190601.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160395.3125; val_chrom_access_recon_loss: 13646461.3750; val_global_loss: 40335136.0000; val_optim_loss: 40335136.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8898; val_auprc_score: 0.8520; val_best_acc_score: 0.8227; val_best_f1_score: 0.8396; train_kl_reg_loss: 161178.7453; train_edge_recon_loss: 2893520.1742; train_gene_expr_recon_loss: 23500541.7576; train_masked_gp_l1_reg_loss: 191961.6977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158684.3977; train_chrom_access_recon_loss: 13519498.5909; train_global_loss: 40425385.5152; train_optim_loss: 40425385.5152; val_kl_reg_loss: 162772.6934; val_edge_recon_loss: 2919661.5625; val_gene_expr_recon_loss: 23216422.5000; val_masked_gp_l1_reg_loss: 193564.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157566.5938; val_chrom_access_recon_loss: 13592037.7500; val_global_loss: 40242025.0000; val_optim_loss: 40242025.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8954; val_auprc_score: 0.8638; val_best_acc_score: 0.8332; val_best_f1_score: 0.8481; train_kl_reg_loss: 156192.5196; train_edge_recon_loss: 2881014.3333; train_gene_expr_recon_loss: 23412743.3939; train_masked_gp_l1_reg_loss: 194647.0310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155527.5301; train_chrom_access_recon_loss: 13465827.9697; train_global_loss: 40265952.7879; train_optim_loss: 40265952.7879; val_kl_reg_loss: 150821.3359; val_edge_recon_loss: 2879623.5625; val_gene_expr_recon_loss: 23202905.2500; val_masked_gp_l1_reg_loss: 196105.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154147.3594; val_chrom_access_recon_loss: 13677226.7500; val_global_loss: 40260831.0000; val_optim_loss: 40260831.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8946; val_auprc_score: 0.8580; val_best_acc_score: 0.8313; val_best_f1_score: 0.8464; train_kl_reg_loss: 155641.1252; train_edge_recon_loss: 2868318.7538; train_gene_expr_recon_loss: 23305490.9091; train_masked_gp_l1_reg_loss: 197332.2621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152888.9981; train_chrom_access_recon_loss: 13407266.8333; train_global_loss: 40086938.9091; train_optim_loss: 40086938.9091; val_kl_reg_loss: 151293.0957; val_edge_recon_loss: 2914589.0312; val_gene_expr_recon_loss: 22957629.0000; val_masked_gp_l1_reg_loss: 198909.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152027.2031; val_chrom_access_recon_loss: 13365083.1250; val_global_loss: 39739532.0000; val_optim_loss: 39739532.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9001; val_auprc_score: 0.8667; val_best_acc_score: 0.8334; val_best_f1_score: 0.8484; train_kl_reg_loss: 154869.5902; train_edge_recon_loss: 2844977.5189; train_gene_expr_recon_loss: 23249742.9394; train_masked_gp_l1_reg_loss: 199928.1574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151083.6342; train_chrom_access_recon_loss: 13366107.5909; train_global_loss: 39966709.0909; train_optim_loss: 39966709.0909; val_kl_reg_loss: 156580.5293; val_edge_recon_loss: 2892638.2500; val_gene_expr_recon_loss: 23233959.7500; val_masked_gp_l1_reg_loss: 200961.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150123.2969; val_chrom_access_recon_loss: 13636275.0000; val_global_loss: 40270539.5000; val_optim_loss: 40270539.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9155; val_auprc_score: 0.8883; val_best_acc_score: 0.8487; val_best_f1_score: 0.8596; train_kl_reg_loss: 152637.6522; train_edge_recon_loss: 2859863.1212; train_gene_expr_recon_loss: 23188091.5455; train_masked_gp_l1_reg_loss: 201926.4678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149402.3501; train_chrom_access_recon_loss: 13324434.9091; train_global_loss: 39876355.9394; train_optim_loss: 39876355.9394; val_kl_reg_loss: 151311.8105; val_edge_recon_loss: 2870678.0938; val_gene_expr_recon_loss: 23175194.2500; val_masked_gp_l1_reg_loss: 202800.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148440.3125; val_chrom_access_recon_loss: 13518518.3750; val_global_loss: 40066943.0000; val_optim_loss: 40066943.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9226; val_auprc_score: 0.8962; val_best_acc_score: 0.8589; val_best_f1_score: 0.8675; train_kl_reg_loss: 153699.0488; train_edge_recon_loss: 2838536.9848; train_gene_expr_recon_loss: 23093422.6667; train_masked_gp_l1_reg_loss: 203735.0869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148448.9209; train_chrom_access_recon_loss: 13259870.0606; train_global_loss: 39697713.0303; train_optim_loss: 39697713.0303; val_kl_reg_loss: 145424.1543; val_edge_recon_loss: 2844062.7500; val_gene_expr_recon_loss: 22706089.7500; val_masked_gp_l1_reg_loss: 204845.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148652.9844; val_chrom_access_recon_loss: 13376900.1250; val_global_loss: 39425975.0000; val_optim_loss: 39425975.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9267; val_auprc_score: 0.9039; val_best_acc_score: 0.8587; val_best_f1_score: 0.8694; train_kl_reg_loss: 149547.1984; train_edge_recon_loss: 2838994.5871; train_gene_expr_recon_loss: 23028508.8182; train_masked_gp_l1_reg_loss: 205880.9853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148376.2301; train_chrom_access_recon_loss: 13243453.8636; train_global_loss: 39614761.9394; train_optim_loss: 39614761.9394; val_kl_reg_loss: 149433.1953; val_edge_recon_loss: 2837900.1250; val_gene_expr_recon_loss: 22772179.5000; val_masked_gp_l1_reg_loss: 207088.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148401.5469; val_chrom_access_recon_loss: 13346960.8750; val_global_loss: 39461963.0000; val_optim_loss: 39461963.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9306; val_auprc_score: 0.9086; val_best_acc_score: 0.8630; val_best_f1_score: 0.8709; train_kl_reg_loss: 151602.0478; train_edge_recon_loss: 2823668.1023; train_gene_expr_recon_loss: 22954847.4242; train_masked_gp_l1_reg_loss: 207535.6304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148389.5090; train_chrom_access_recon_loss: 13194178.1970; train_global_loss: 39480220.9091; train_optim_loss: 39480220.9091; val_kl_reg_loss: 151155.4277; val_edge_recon_loss: 2855900.3438; val_gene_expr_recon_loss: 22785680.2500; val_masked_gp_l1_reg_loss: 208626.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149426.8438; val_chrom_access_recon_loss: 13361728.2500; val_global_loss: 39512517.0000; val_optim_loss: 39512517.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9316; val_auprc_score: 0.9112; val_best_acc_score: 0.8662; val_best_f1_score: 0.8728; train_kl_reg_loss: 151068.2985; train_edge_recon_loss: 2817551.0530; train_gene_expr_recon_loss: 22903893.9091; train_masked_gp_l1_reg_loss: 209063.4377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149083.3414; train_chrom_access_recon_loss: 13143769.2879; train_global_loss: 39374429.2727; train_optim_loss: 39374429.2727; val_kl_reg_loss: 150319.6426; val_edge_recon_loss: 2821277.0938; val_gene_expr_recon_loss: 22799565.2500; val_masked_gp_l1_reg_loss: 209881.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149557.0000; val_chrom_access_recon_loss: 13272806.6250; val_global_loss: 39403407.5000; val_optim_loss: 39403407.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9306; val_auprc_score: 0.9066; val_best_acc_score: 0.8622; val_best_f1_score: 0.8710; train_kl_reg_loss: 151049.9924; train_edge_recon_loss: 2805879.4621; train_gene_expr_recon_loss: 22863075.8182; train_masked_gp_l1_reg_loss: 210431.2292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149265.2618; train_chrom_access_recon_loss: 13130423.2576; train_global_loss: 39310125.3939; train_optim_loss: 39310125.3939; val_kl_reg_loss: 152248.5254; val_edge_recon_loss: 2836812.5938; val_gene_expr_recon_loss: 22674620.2500; val_masked_gp_l1_reg_loss: 211235.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149405.2812; val_chrom_access_recon_loss: 13233915.8750; val_global_loss: 39258238.5000; val_optim_loss: 39258238.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9329; val_auprc_score: 0.9150; val_best_acc_score: 0.8657; val_best_f1_score: 0.8732; train_kl_reg_loss: 150675.3693; train_edge_recon_loss: 2795008.5909; train_gene_expr_recon_loss: 22789575.8485; train_masked_gp_l1_reg_loss: 211508.5400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148385.1468; train_chrom_access_recon_loss: 13086118.1818; train_global_loss: 39181271.5758; train_optim_loss: 39181271.5758; val_kl_reg_loss: 151358.6973; val_edge_recon_loss: 2847962.7812; val_gene_expr_recon_loss: 22511014.5000; val_masked_gp_l1_reg_loss: 212477.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148644.3125; val_chrom_access_recon_loss: 13170730.8750; val_global_loss: 39042188.5000; val_optim_loss: 39042188.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9361; val_auprc_score: 0.9148; val_best_acc_score: 0.8716; val_best_f1_score: 0.8757; train_kl_reg_loss: 150344.1241; train_edge_recon_loss: 2792819.9091; train_gene_expr_recon_loss: 22753285.2727; train_masked_gp_l1_reg_loss: 212765.8516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147720.2344; train_chrom_access_recon_loss: 13058314.0000; train_global_loss: 39115249.2121; train_optim_loss: 39115249.2121; val_kl_reg_loss: 150055.7891; val_edge_recon_loss: 2810866.7500; val_gene_expr_recon_loss: 22545245.7500; val_masked_gp_l1_reg_loss: 213524.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146744.3594; val_chrom_access_recon_loss: 13055838.1250; val_global_loss: 38922275.0000; val_optim_loss: 38922275.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9385; val_auprc_score: 0.9174; val_best_acc_score: 0.8783; val_best_f1_score: 0.8854; train_kl_reg_loss: 149270.3168; train_edge_recon_loss: 2783950.1515; train_gene_expr_recon_loss: 22703737.1212; train_masked_gp_l1_reg_loss: 213952.0142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146855.2088; train_chrom_access_recon_loss: 13015001.7576; train_global_loss: 39012766.7879; train_optim_loss: 39012766.7879; val_kl_reg_loss: 145353.4824; val_edge_recon_loss: 2821013.5938; val_gene_expr_recon_loss: 22425831.7500; val_masked_gp_l1_reg_loss: 214392.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146993.8594; val_chrom_access_recon_loss: 13126395.6250; val_global_loss: 38879981.0000; val_optim_loss: 38879981.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9427; val_auprc_score: 0.9219; val_best_acc_score: 0.8788; val_best_f1_score: 0.8835; train_kl_reg_loss: 149248.5516; train_edge_recon_loss: 2788854.8826; train_gene_expr_recon_loss: 22644434.7879; train_masked_gp_l1_reg_loss: 214991.8227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146408.8603; train_chrom_access_recon_loss: 12986672.6667; train_global_loss: 38930611.5152; train_optim_loss: 38930611.5152; val_kl_reg_loss: 151682.9668; val_edge_recon_loss: 2812235.7188; val_gene_expr_recon_loss: 22679618.2500; val_masked_gp_l1_reg_loss: 215190.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145865.0469; val_chrom_access_recon_loss: 13216141.5000; val_global_loss: 39220733.5000; val_optim_loss: 39220733.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9453; val_auprc_score: 0.9246; val_best_acc_score: 0.8818; val_best_f1_score: 0.8870; train_kl_reg_loss: 147216.2143; train_edge_recon_loss: 2783792.7235; train_gene_expr_recon_loss: 22610542.8485; train_masked_gp_l1_reg_loss: 215821.5019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145470.7235; train_chrom_access_recon_loss: 12953089.7424; train_global_loss: 38855933.5758; train_optim_loss: 38855933.5758; val_kl_reg_loss: 144652.1973; val_edge_recon_loss: 2816121.4688; val_gene_expr_recon_loss: 22539771.0000; val_masked_gp_l1_reg_loss: 216354.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145421.2969; val_chrom_access_recon_loss: 13216060.0000; val_global_loss: 39078380.0000; val_optim_loss: 39078380.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9425; val_auprc_score: 0.9215; val_best_acc_score: 0.8775; val_best_f1_score: 0.8849; train_kl_reg_loss: 147506.6868; train_edge_recon_loss: 2780811.3485; train_gene_expr_recon_loss: 22572198.0000; train_masked_gp_l1_reg_loss: 216687.5386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144576.7088; train_chrom_access_recon_loss: 12932126.5758; train_global_loss: 38793906.8485; train_optim_loss: 38793906.8485; val_kl_reg_loss: 153228.5156; val_edge_recon_loss: 2806521.1250; val_gene_expr_recon_loss: 22530957.2500; val_masked_gp_l1_reg_loss: 217403.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144830.6250; val_chrom_access_recon_loss: 13190426.0000; val_global_loss: 39043366.5000; val_optim_loss: 39043366.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9488; val_auprc_score: 0.9367; val_best_acc_score: 0.8829; val_best_f1_score: 0.8887; train_kl_reg_loss: 146362.6837; train_edge_recon_loss: 2833373.9924; train_gene_expr_recon_loss: 22162302.1212; train_masked_gp_l1_reg_loss: 215950.8400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150227.7614; train_chrom_access_recon_loss: 12817544.1667; train_global_loss: 38325761.6364; train_optim_loss: 38325761.6364; val_kl_reg_loss: 106265.7383; val_edge_recon_loss: 2822690.7812; val_gene_expr_recon_loss: 21890466.7500; val_masked_gp_l1_reg_loss: 214904.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149539.5469; val_chrom_access_recon_loss: 12807324.1250; val_global_loss: 37991192.0000; val_optim_loss: 37991192.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9426; val_auprc_score: 0.9213; val_best_acc_score: 0.8815; val_best_f1_score: 0.8893; train_kl_reg_loss: 154143.4001; train_edge_recon_loss: 2797558.8371; train_gene_expr_recon_loss: 22042292.7879; train_masked_gp_l1_reg_loss: 214393.8239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146954.9437; train_chrom_access_recon_loss: 12654669.5152; train_global_loss: 38010013.0909; train_optim_loss: 38010013.0909; val_kl_reg_loss: 112727.1191; val_edge_recon_loss: 2845628.4688; val_gene_expr_recon_loss: 21878969.5000; val_masked_gp_l1_reg_loss: 214472.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145511.7188; val_chrom_access_recon_loss: 12758425.3750; val_global_loss: 37955735.0000; val_optim_loss: 37955735.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9396; val_auprc_score: 0.9192; val_best_acc_score: 0.8802; val_best_f1_score: 0.8866; train_kl_reg_loss: 149422.5386; train_edge_recon_loss: 2788464.1515; train_gene_expr_recon_loss: 22012634.7273; train_masked_gp_l1_reg_loss: 214247.7202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143690.9796; train_chrom_access_recon_loss: 12621362.6364; train_global_loss: 37929822.6061; train_optim_loss: 37929822.6061; val_kl_reg_loss: 121045.6680; val_edge_recon_loss: 2826537.8438; val_gene_expr_recon_loss: 21760538.0000; val_masked_gp_l1_reg_loss: 214287.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142313.1094; val_chrom_access_recon_loss: 12662971.6250; val_global_loss: 37727695.0000; val_optim_loss: 37727695.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9370; val_auprc_score: 0.9103; val_best_acc_score: 0.8818; val_best_f1_score: 0.8881; train_kl_reg_loss: 145182.6179; train_edge_recon_loss: 2783194.9811; train_gene_expr_recon_loss: 21964195.4242; train_masked_gp_l1_reg_loss: 213929.3329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141595.0277; train_chrom_access_recon_loss: 12601986.0909; train_global_loss: 37850083.3939; train_optim_loss: 37850083.3939; val_kl_reg_loss: 119800.2520; val_edge_recon_loss: 2822800.3438; val_gene_expr_recon_loss: 21964242.7500; val_masked_gp_l1_reg_loss: 213809.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140249.5156; val_chrom_access_recon_loss: 12682999.7500; val_global_loss: 37943903.5000; val_optim_loss: 37943903.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9376; val_auprc_score: 0.9103; val_best_acc_score: 0.8847; val_best_f1_score: 0.8903; train_kl_reg_loss: 142741.7850; train_edge_recon_loss: 2766287.7235; train_gene_expr_recon_loss: 21926725.6061; train_masked_gp_l1_reg_loss: 213754.5182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139747.8234; train_chrom_access_recon_loss: 12575360.9545; train_global_loss: 37764618.3636; train_optim_loss: 37764618.3636; val_kl_reg_loss: 127754.7275; val_edge_recon_loss: 2783474.9375; val_gene_expr_recon_loss: 21748284.2500; val_masked_gp_l1_reg_loss: 213761.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138589.6875; val_chrom_access_recon_loss: 12621961.8750; val_global_loss: 37633827.5000; val_optim_loss: 37633827.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9438; val_auprc_score: 0.9244; val_best_acc_score: 0.8915; val_best_f1_score: 0.8983; train_kl_reg_loss: 141627.8490; train_edge_recon_loss: 2766905.5871; train_gene_expr_recon_loss: 21897226.0606; train_masked_gp_l1_reg_loss: 213437.9048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138443.7386; train_chrom_access_recon_loss: 12567374.2727; train_global_loss: 37725015.2121; train_optim_loss: 37725015.2121; val_kl_reg_loss: 128732.3682; val_edge_recon_loss: 2791462.8750; val_gene_expr_recon_loss: 21637808.5000; val_masked_gp_l1_reg_loss: 213401.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138528.1250; val_chrom_access_recon_loss: 12719550.8750; val_global_loss: 37629485.0000; val_optim_loss: 37629485.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9434; val_auprc_score: 0.9234; val_best_acc_score: 0.8861; val_best_f1_score: 0.8914; train_kl_reg_loss: 137269.9354; train_edge_recon_loss: 2779178.1250; train_gene_expr_recon_loss: 21867126.5758; train_masked_gp_l1_reg_loss: 213264.2353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137800.6754; train_chrom_access_recon_loss: 12533467.6515; train_global_loss: 37668107.2121; train_optim_loss: 37668107.2121; val_kl_reg_loss: 130285.4863; val_edge_recon_loss: 2821118.2188; val_gene_expr_recon_loss: 21881456.2500; val_masked_gp_l1_reg_loss: 213276.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137993.3438; val_chrom_access_recon_loss: 12812506.6250; val_global_loss: 37996637.0000; val_optim_loss: 37996637.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9503; val_auprc_score: 0.9332; val_best_acc_score: 0.8976; val_best_f1_score: 0.9025; train_kl_reg_loss: 138032.9100; train_edge_recon_loss: 2765333.5038; train_gene_expr_recon_loss: 21846411.5455; train_masked_gp_l1_reg_loss: 213170.3880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136721.7244; train_chrom_access_recon_loss: 12520688.8182; train_global_loss: 37620358.9091; train_optim_loss: 37620358.9091; val_kl_reg_loss: 128924.3008; val_edge_recon_loss: 2789973.4062; val_gene_expr_recon_loss: 21470478.5000; val_masked_gp_l1_reg_loss: 213341.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136243.3438; val_chrom_access_recon_loss: 12476153.0000; val_global_loss: 37215115.5000; val_optim_loss: 37215115.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9491; val_auprc_score: 0.9307; val_best_acc_score: 0.8990; val_best_f1_score: 0.9040; train_kl_reg_loss: 136930.8092; train_edge_recon_loss: 2757989.7955; train_gene_expr_recon_loss: 21810071.6970; train_masked_gp_l1_reg_loss: 213206.7479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135858.4983; train_chrom_access_recon_loss: 12500526.1212; train_global_loss: 37554584.0606; train_optim_loss: 37554584.0606; val_kl_reg_loss: 132713.5547; val_edge_recon_loss: 2767752.0312; val_gene_expr_recon_loss: 21974630.0000; val_masked_gp_l1_reg_loss: 213325.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134533.9062; val_chrom_access_recon_loss: 12779712.2500; val_global_loss: 38002668.0000; val_optim_loss: 38002668.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9479; val_auprc_score: 0.9302; val_best_acc_score: 0.8858; val_best_f1_score: 0.8922; train_kl_reg_loss: 137567.7957; train_edge_recon_loss: 2762507.5000; train_gene_expr_recon_loss: 21768632.9394; train_masked_gp_l1_reg_loss: 213208.7460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134956.1402; train_chrom_access_recon_loss: 12465615.5303; train_global_loss: 37482488.6061; train_optim_loss: 37482488.6061; val_kl_reg_loss: 133414.3496; val_edge_recon_loss: 2791664.4375; val_gene_expr_recon_loss: 21719800.5000; val_masked_gp_l1_reg_loss: 213363.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135418.3281; val_chrom_access_recon_loss: 12577085.7500; val_global_loss: 37570748.0000; val_optim_loss: 37570748.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9471; val_auprc_score: 0.9255; val_best_acc_score: 0.8939; val_best_f1_score: 0.9004; train_kl_reg_loss: 135203.5304; train_edge_recon_loss: 2760525.6515; train_gene_expr_recon_loss: 21750686.9394; train_masked_gp_l1_reg_loss: 213360.9979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134557.2609; train_chrom_access_recon_loss: 12433369.1970; train_global_loss: 37427703.5152; train_optim_loss: 37427703.5152; val_kl_reg_loss: 130038.8096; val_edge_recon_loss: 2787127.5938; val_gene_expr_recon_loss: 21744097.5000; val_masked_gp_l1_reg_loss: 213546.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134108.9219; val_chrom_access_recon_loss: 12590208.6250; val_global_loss: 37599126.5000; val_optim_loss: 37599126.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9547; val_auprc_score: 0.9381; val_best_acc_score: 0.9044; val_best_f1_score: 0.9086; train_kl_reg_loss: 137646.8147; train_edge_recon_loss: 2750838.5606; train_gene_expr_recon_loss: 21724401.2121; train_masked_gp_l1_reg_loss: 213433.1984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133694.0743; train_chrom_access_recon_loss: 12423062.1212; train_global_loss: 37383075.9394; train_optim_loss: 37383075.9394; val_kl_reg_loss: 131652.0312; val_edge_recon_loss: 2766785.5000; val_gene_expr_recon_loss: 21918518.2500; val_masked_gp_l1_reg_loss: 213444.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133929.2969; val_chrom_access_recon_loss: 12579735.2500; val_global_loss: 37744064.0000; val_optim_loss: 37744064.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9506; val_auprc_score: 0.9333; val_best_acc_score: 0.8949; val_best_f1_score: 0.8999; train_kl_reg_loss: 136083.6683; train_edge_recon_loss: 2758662.5227; train_gene_expr_recon_loss: 21691288.1818; train_masked_gp_l1_reg_loss: 210270.5911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102769.3797; train_chrom_access_recon_loss: 12400639.3939; train_global_loss: 37299714.1212; train_optim_loss: 37299714.1212; val_kl_reg_loss: 132114.0156; val_edge_recon_loss: 2796131.2812; val_gene_expr_recon_loss: 21605676.5000; val_masked_gp_l1_reg_loss: 208946.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96584.9609; val_chrom_access_recon_loss: 12562144.6250; val_global_loss: 37401596.0000; val_optim_loss: 37401596.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9527; val_auprc_score: 0.9340; val_best_acc_score: 0.8979; val_best_f1_score: 0.9025; train_kl_reg_loss: 136971.1634; train_edge_recon_loss: 2758173.0606; train_gene_expr_recon_loss: 21666958.4545; train_masked_gp_l1_reg_loss: 208607.9751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96082.4613; train_chrom_access_recon_loss: 12382980.7121; train_global_loss: 37249773.7576; train_optim_loss: 37249773.7576; val_kl_reg_loss: 132825.7061; val_edge_recon_loss: 2792042.8438; val_gene_expr_recon_loss: 21737836.7500; val_masked_gp_l1_reg_loss: 208364.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95695.7969; val_chrom_access_recon_loss: 12693752.7500; val_global_loss: 37660518.0000; val_optim_loss: 37660518.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9521; val_auprc_score: 0.9366; val_best_acc_score: 0.8995; val_best_f1_score: 0.9036; train_kl_reg_loss: 138772.2725; train_edge_recon_loss: 2750175.7765; train_gene_expr_recon_loss: 21684738.4242; train_masked_gp_l1_reg_loss: 208232.5009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95224.5908; train_chrom_access_recon_loss: 12394794.7121; train_global_loss: 37271938.1818; train_optim_loss: 37271938.1818; val_kl_reg_loss: 133202.3896; val_edge_recon_loss: 2765555.7188; val_gene_expr_recon_loss: 21676861.2500; val_masked_gp_l1_reg_loss: 208117.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94972.3047; val_chrom_access_recon_loss: 12639295.5000; val_global_loss: 37518005.5000; val_optim_loss: 37518005.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9501; val_auprc_score: 0.9326; val_best_acc_score: 0.8958; val_best_f1_score: 0.9004; train_kl_reg_loss: 138974.8014; train_edge_recon_loss: 2754947.6591; train_gene_expr_recon_loss: 21665070.0606; train_masked_gp_l1_reg_loss: 208069.3298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94933.1867; train_chrom_access_recon_loss: 12377800.6970; train_global_loss: 37239796.0606; train_optim_loss: 37239796.0606; val_kl_reg_loss: 134096.1113; val_edge_recon_loss: 2783722.5000; val_gene_expr_recon_loss: 21378498.0000; val_masked_gp_l1_reg_loss: 207997.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94609.1172; val_chrom_access_recon_loss: 12462529.5000; val_global_loss: 37061454.0000; val_optim_loss: 37061454.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9540; val_auprc_score: 0.9341; val_best_acc_score: 0.9033; val_best_f1_score: 0.9069; train_kl_reg_loss: 139492.0107; train_edge_recon_loss: 2753203.9394; train_gene_expr_recon_loss: 21669901.1515; train_masked_gp_l1_reg_loss: 207964.6162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94390.6939; train_chrom_access_recon_loss: 12386958.0152; train_global_loss: 37251910.6667; train_optim_loss: 37251910.6667; val_kl_reg_loss: 134719.1445; val_edge_recon_loss: 2786568.6250; val_gene_expr_recon_loss: 21639492.5000; val_masked_gp_l1_reg_loss: 207943.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94272.5547; val_chrom_access_recon_loss: 12528612.7500; val_global_loss: 37391609.5000; val_optim_loss: 37391609.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9512; val_auprc_score: 0.9308; val_best_acc_score: 0.8992; val_best_f1_score: 0.9038; train_kl_reg_loss: 139850.2559; train_edge_recon_loss: 2746514.6250; train_gene_expr_recon_loss: 21670676.2424; train_masked_gp_l1_reg_loss: 207912.2377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94016.6687; train_chrom_access_recon_loss: 12383063.3333; train_global_loss: 37242033.4545; train_optim_loss: 37242033.4545; val_kl_reg_loss: 136179.7227; val_edge_recon_loss: 2774122.8125; val_gene_expr_recon_loss: 21612614.7500; val_masked_gp_l1_reg_loss: 207863.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93886.5703; val_chrom_access_recon_loss: 12485230.3750; val_global_loss: 37309897.5000; val_optim_loss: 37309897.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9467; val_auprc_score: 0.9252; val_best_acc_score: 0.8931; val_best_f1_score: 0.8982; train_kl_reg_loss: 140626.7879; train_edge_recon_loss: 2744095.9205; train_gene_expr_recon_loss: 21660888.0000; train_masked_gp_l1_reg_loss: 207840.6444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93755.7320; train_chrom_access_recon_loss: 12377993.5455; train_global_loss: 37225200.5455; train_optim_loss: 37225200.5455; val_kl_reg_loss: 135604.4043; val_edge_recon_loss: 2787654.4375; val_gene_expr_recon_loss: 21392003.7500; val_masked_gp_l1_reg_loss: 207808.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93590.8203; val_chrom_access_recon_loss: 12428854.7500; val_global_loss: 37045515.5000; val_optim_loss: 37045515.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9505; val_auprc_score: 0.9330; val_best_acc_score: 0.8976; val_best_f1_score: 0.9035; train_kl_reg_loss: 140413.9832; train_edge_recon_loss: 2754425.0417; train_gene_expr_recon_loss: 21660068.7273; train_masked_gp_l1_reg_loss: 207782.5133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93389.3849; train_chrom_access_recon_loss: 12371309.5758; train_global_loss: 37227389.0303; train_optim_loss: 37227389.0303; val_kl_reg_loss: 136558.3398; val_edge_recon_loss: 2774994.4688; val_gene_expr_recon_loss: 21450452.5000; val_masked_gp_l1_reg_loss: 207820.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93226.6719; val_chrom_access_recon_loss: 12561424.5000; val_global_loss: 37224476.5000; val_optim_loss: 37224476.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9516; val_auprc_score: 0.9275; val_best_acc_score: 0.8952; val_best_f1_score: 0.9002; train_kl_reg_loss: 140612.7083; train_edge_recon_loss: 2754154.4053; train_gene_expr_recon_loss: 21658168.0303; train_masked_gp_l1_reg_loss: 207765.1908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93133.4714; train_chrom_access_recon_loss: 12381286.0455; train_global_loss: 37235119.8788; train_optim_loss: 37235119.8788; val_kl_reg_loss: 135414.0586; val_edge_recon_loss: 2786096.7188; val_gene_expr_recon_loss: 21509863.7500; val_masked_gp_l1_reg_loss: 207745.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93096.0234; val_chrom_access_recon_loss: 12432860.5000; val_global_loss: 37165078.0000; val_optim_loss: 37165078.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9494; val_auprc_score: 0.9257; val_best_acc_score: 0.9030; val_best_f1_score: 0.9069; train_kl_reg_loss: 139565.1766; train_edge_recon_loss: 2754638.2462; train_gene_expr_recon_loss: 21662260.1515; train_masked_gp_l1_reg_loss: 207713.6584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92835.7653; train_chrom_access_recon_loss: 12374017.7273; train_global_loss: 37231031.1515; train_optim_loss: 37231031.1515; val_kl_reg_loss: 135640.1641; val_edge_recon_loss: 2781039.7812; val_gene_expr_recon_loss: 21740326.5000; val_masked_gp_l1_reg_loss: 207702.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92720.7500; val_chrom_access_recon_loss: 12659382.5000; val_global_loss: 37616811.0000; val_optim_loss: 37616811.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9491; val_auprc_score: 0.9282; val_best_acc_score: 0.8952; val_best_f1_score: 0.8989; train_kl_reg_loss: 140379.4508; train_edge_recon_loss: 2743760.6061; train_gene_expr_recon_loss: 21652758.5455; train_masked_gp_l1_reg_loss: 207697.8092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92553.3177; train_chrom_access_recon_loss: 12374773.2121; train_global_loss: 37211923.0909; train_optim_loss: 37211923.0909; val_kl_reg_loss: 137342.1328; val_edge_recon_loss: 2784197.0938; val_gene_expr_recon_loss: 21364978.7500; val_masked_gp_l1_reg_loss: 207690.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92394.9766; val_chrom_access_recon_loss: 12367759.6250; val_global_loss: 36954362.5000; val_optim_loss: 36954362.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9540; val_auprc_score: 0.9401; val_best_acc_score: 0.8998; val_best_f1_score: 0.9039; train_kl_reg_loss: 140766.9207; train_edge_recon_loss: 2755186.6553; train_gene_expr_recon_loss: 21634178.5152; train_masked_gp_l1_reg_loss: 207678.8781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92343.9147; train_chrom_access_recon_loss: 12363981.8333; train_global_loss: 37194136.4848; train_optim_loss: 37194136.4848; val_kl_reg_loss: 136010.6641; val_edge_recon_loss: 2781740.9062; val_gene_expr_recon_loss: 21603530.5000; val_masked_gp_l1_reg_loss: 207658.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92128.2344; val_chrom_access_recon_loss: 12541021.8750; val_global_loss: 37362090.0000; val_optim_loss: 37362090.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9523; val_auprc_score: 0.9326; val_best_acc_score: 0.9019; val_best_f1_score: 0.9055; train_kl_reg_loss: 139980.1532; train_edge_recon_loss: 2748211.3030; train_gene_expr_recon_loss: 21640278.5758; train_masked_gp_l1_reg_loss: 207635.7971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91925.1637; train_chrom_access_recon_loss: 12367170.6515; train_global_loss: 37195201.6364; train_optim_loss: 37195201.6364; val_kl_reg_loss: 136943.8008; val_edge_recon_loss: 2786809.7500; val_gene_expr_recon_loss: 21494673.7500; val_masked_gp_l1_reg_loss: 207598.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91856.6406; val_chrom_access_recon_loss: 12519730.6250; val_global_loss: 37237611.5000; val_optim_loss: 37237611.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9462; val_auprc_score: 0.9242; val_best_acc_score: 0.8966; val_best_f1_score: 0.9013; train_kl_reg_loss: 139757.4735; train_edge_recon_loss: 2751639.4697; train_gene_expr_recon_loss: 21640652.4242; train_masked_gp_l1_reg_loss: 207625.1177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91816.8938; train_chrom_access_recon_loss: 12373952.7879; train_global_loss: 37205444.0000; train_optim_loss: 37205444.0000; val_kl_reg_loss: 136403.0566; val_edge_recon_loss: 2788128.3438; val_gene_expr_recon_loss: 21536523.5000; val_masked_gp_l1_reg_loss: 207619.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91762.5312; val_chrom_access_recon_loss: 12403210.6250; val_global_loss: 37163647.5000; val_optim_loss: 37163647.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9487; val_auprc_score: 0.9319; val_best_acc_score: 0.8958; val_best_f1_score: 0.9005; train_kl_reg_loss: 139694.2995; train_edge_recon_loss: 2752611.9659; train_gene_expr_recon_loss: 21639477.3333; train_masked_gp_l1_reg_loss: 207635.4865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91542.2683; train_chrom_access_recon_loss: 12364557.8636; train_global_loss: 37195519.2727; train_optim_loss: 37195519.2727; val_kl_reg_loss: 137720.1582; val_edge_recon_loss: 2791186.2188; val_gene_expr_recon_loss: 21597866.7500; val_masked_gp_l1_reg_loss: 207644.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91386.1250; val_chrom_access_recon_loss: 12535506.3750; val_global_loss: 37361309.5000; val_optim_loss: 37361309.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9494; val_auprc_score: 0.9264; val_best_acc_score: 0.8984; val_best_f1_score: 0.9035; train_kl_reg_loss: 139904.4645; train_edge_recon_loss: 2751350.3636; train_gene_expr_recon_loss: 21643478.2121; train_masked_gp_l1_reg_loss: 207283.3688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88059.6826; train_chrom_access_recon_loss: 12360836.1061; train_global_loss: 37190912.5455; train_optim_loss: 37190912.5455; val_kl_reg_loss: 136264.0439; val_edge_recon_loss: 2775594.0625; val_gene_expr_recon_loss: 21279066.2500; val_masked_gp_l1_reg_loss: 207106.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87403.5156; val_chrom_access_recon_loss: 12337829.7500; val_global_loss: 36823264.0000; val_optim_loss: 36823264.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9537; val_auprc_score: 0.9332; val_best_acc_score: 0.9052; val_best_f1_score: 0.9086; train_kl_reg_loss: 139789.4602; train_edge_recon_loss: 2748036.4773; train_gene_expr_recon_loss: 21640660.8788; train_masked_gp_l1_reg_loss: 207051.4479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87344.3259; train_chrom_access_recon_loss: 12367787.8788; train_global_loss: 37190670.4242; train_optim_loss: 37190670.4242; val_kl_reg_loss: 136666.7402; val_edge_recon_loss: 2772116.3750; val_gene_expr_recon_loss: 21539865.7500; val_masked_gp_l1_reg_loss: 207004.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87294.9297; val_chrom_access_recon_loss: 12545675.8750; val_global_loss: 37288622.5000; val_optim_loss: 37288622.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9471; val_auprc_score: 0.9208; val_best_acc_score: 0.8963; val_best_f1_score: 0.9009; train_kl_reg_loss: 139818.1529; train_edge_recon_loss: 2749740.3826; train_gene_expr_recon_loss: 21635872.9091; train_masked_gp_l1_reg_loss: 206982.8693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87247.3527; train_chrom_access_recon_loss: 12361759.3333; train_global_loss: 37181420.6667; train_optim_loss: 37181420.6667; val_kl_reg_loss: 136919.0391; val_edge_recon_loss: 2766882.6875; val_gene_expr_recon_loss: 21656540.7500; val_masked_gp_l1_reg_loss: 206957.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87209.5469; val_chrom_access_recon_loss: 12544018.5000; val_global_loss: 37398529.5000; val_optim_loss: 37398529.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9543; val_auprc_score: 0.9364; val_best_acc_score: 0.9022; val_best_f1_score: 0.9062; train_kl_reg_loss: 140019.9877; train_edge_recon_loss: 2756885.9583; train_gene_expr_recon_loss: 21639204.5455; train_masked_gp_l1_reg_loss: 206945.9751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87194.0610; train_chrom_access_recon_loss: 12372942.9242; train_global_loss: 37203193.4545; train_optim_loss: 37203193.4545; val_kl_reg_loss: 136387.3164; val_edge_recon_loss: 2772379.8750; val_gene_expr_recon_loss: 21462061.2500; val_masked_gp_l1_reg_loss: 206933.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87160.0938; val_chrom_access_recon_loss: 12489363.3750; val_global_loss: 37154285.0000; val_optim_loss: 37154285.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9559; val_auprc_score: 0.9395; val_best_acc_score: 0.8987; val_best_f1_score: 0.9026; train_kl_reg_loss: 139872.5116; train_edge_recon_loss: 2749040.8712; train_gene_expr_recon_loss: 21627326.1818; train_masked_gp_l1_reg_loss: 206925.8544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87143.1368; train_chrom_access_recon_loss: 12365368.2273; train_global_loss: 37175676.3636; train_optim_loss: 37175676.3636; val_kl_reg_loss: 135799.3008; val_edge_recon_loss: 2793199.7812; val_gene_expr_recon_loss: 21479461.7500; val_masked_gp_l1_reg_loss: 206918.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87130.3594; val_chrom_access_recon_loss: 12450432.3750; val_global_loss: 37152941.0000; val_optim_loss: 37152941.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9467; val_auprc_score: 0.9212; val_best_acc_score: 0.8939; val_best_f1_score: 0.8982; train_kl_reg_loss: 139912.0407; train_edge_recon_loss: 2751924.8144; train_gene_expr_recon_loss: 21641778.1212; train_masked_gp_l1_reg_loss: 206883.3487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86782.7363; train_chrom_access_recon_loss: 12372245.9697; train_global_loss: 37199527.2727; train_optim_loss: 37199527.2727; val_kl_reg_loss: 136710.2539; val_edge_recon_loss: 2791834.2500; val_gene_expr_recon_loss: 21500728.5000; val_masked_gp_l1_reg_loss: 206866.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86714.4766; val_chrom_access_recon_loss: 12512115.1250; val_global_loss: 37234968.5000; val_optim_loss: 37234968.5000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9521; val_auprc_score: 0.9343; val_best_acc_score: 0.8982; val_best_f1_score: 0.9040; train_kl_reg_loss: 139985.5009; train_edge_recon_loss: 2743390.4432; train_gene_expr_recon_loss: 21649112.1515; train_masked_gp_l1_reg_loss: 206860.4920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86708.8400; train_chrom_access_recon_loss: 12367763.2727; train_global_loss: 37193820.5455; train_optim_loss: 37193820.5455; val_kl_reg_loss: 136774.4219; val_edge_recon_loss: 2783166.0312; val_gene_expr_recon_loss: 21442014.7500; val_masked_gp_l1_reg_loss: 206855.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86703.4062; val_chrom_access_recon_loss: 12332462.2500; val_global_loss: 36987977.5000; val_optim_loss: 36987977.5000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9562; val_auprc_score: 0.9391; val_best_acc_score: 0.9041; val_best_f1_score: 0.9079; train_kl_reg_loss: 140005.7180; train_edge_recon_loss: 2749674.3788; train_gene_expr_recon_loss: 21629809.4545; train_masked_gp_l1_reg_loss: 206852.2756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86699.8209; train_chrom_access_recon_loss: 12369240.2273; train_global_loss: 37182282.1212; train_optim_loss: 37182282.1212; val_kl_reg_loss: 136595.7031; val_edge_recon_loss: 2778727.6562; val_gene_expr_recon_loss: 21483767.7500; val_masked_gp_l1_reg_loss: 206849.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86695.4062; val_chrom_access_recon_loss: 12527799.5000; val_global_loss: 37220436.0000; val_optim_loss: 37220436.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9540; val_auprc_score: 0.9325; val_best_acc_score: 0.9011; val_best_f1_score: 0.9058; train_kl_reg_loss: 139941.9441; train_edge_recon_loss: 2756094.0758; train_gene_expr_recon_loss: 21626916.4242; train_masked_gp_l1_reg_loss: 206847.6027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86691.7815; train_chrom_access_recon_loss: 12355735.6970; train_global_loss: 37172227.5758; train_optim_loss: 37172227.5758; val_kl_reg_loss: 136352.8613; val_edge_recon_loss: 2777774.8438; val_gene_expr_recon_loss: 21334546.2500; val_masked_gp_l1_reg_loss: 206845.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86688.8594; val_chrom_access_recon_loss: 12372215.8750; val_global_loss: 36914424.0000; val_optim_loss: 36914424.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 38 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9491
val AUPRC score: 0.9204
val best accuracy score: 0.9017
val best F1 score: 0.9056
val target rna MSE score: 0.9171
val source rna MSE score: 0.3094
val target atac MSE score: 0.3381
val source atac MSE score: 0.0745
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
