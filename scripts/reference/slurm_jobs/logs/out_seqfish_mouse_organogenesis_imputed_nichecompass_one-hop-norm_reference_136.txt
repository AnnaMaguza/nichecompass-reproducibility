[True]
Run timestamp: 27072023_030519_136.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_136']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8776; val_auprc_score: 0.9769; val_best_acc_score: 0.8574; val_best_f1_score: 0.9233; train_kl_reg_loss: 428894.8494; train_edge_recon_loss: 10894205.4326; train_gene_expr_recon_loss: 29892473.3023; train_masked_gp_l1_reg_loss: 7472.5797; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41223046.2791; train_optim_loss: 41223046.2791; val_kl_reg_loss: 420047.9453; val_edge_recon_loss: 11574587.6250; val_gene_expr_recon_loss: 23084951.4167; val_masked_gp_l1_reg_loss: 8058.2251; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35087646.8333; val_optim_loss: 35087646.8333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8672; val_auprc_score: 0.9742; val_best_acc_score: 0.8594; val_best_f1_score: 0.9239; train_kl_reg_loss: 288736.0194; train_edge_recon_loss: 10844482.3395; train_gene_expr_recon_loss: 14751570.4372; train_masked_gp_l1_reg_loss: 8427.5610; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25893216.3256; train_optim_loss: 25893216.3256; val_kl_reg_loss: 204874.2194; val_edge_recon_loss: 11871811.9167; val_gene_expr_recon_loss: 11517580.1250; val_masked_gp_l1_reg_loss: 8895.2588; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23603162.0833; val_optim_loss: 23603162.0833
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8425; val_auprc_score: 0.9693; val_best_acc_score: 0.8666; val_best_f1_score: 0.9271; train_kl_reg_loss: 218516.1252; train_edge_recon_loss: 10657166.8744; train_gene_expr_recon_loss: 11424164.5349; train_masked_gp_l1_reg_loss: 9208.9677; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22309056.5674; train_optim_loss: 22309056.5674; val_kl_reg_loss: 91469.9173; val_edge_recon_loss: 11595135.2083; val_gene_expr_recon_loss: 11268827.8750; val_masked_gp_l1_reg_loss: 9629.0410; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22965063.1667; val_optim_loss: 22965063.1667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8380; val_auprc_score: 0.9667; val_best_acc_score: 0.8603; val_best_f1_score: 0.9238; train_kl_reg_loss: 114587.5997; train_edge_recon_loss: 10736379.4535; train_gene_expr_recon_loss: 11529516.2884; train_masked_gp_l1_reg_loss: 10490.9280; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22390974.1209; train_optim_loss: 22390974.1209; val_kl_reg_loss: 120408.0501; val_edge_recon_loss: 11962024.5417; val_gene_expr_recon_loss: 10940707.8333; val_masked_gp_l1_reg_loss: 11204.9590; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23034344.3333; val_optim_loss: 23034344.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8297; val_auprc_score: 0.9617; val_best_acc_score: 0.8722; val_best_f1_score: 0.9293; train_kl_reg_loss: 88750.6931; train_edge_recon_loss: 10412099.8953; train_gene_expr_recon_loss: 11221350.1023; train_masked_gp_l1_reg_loss: 11798.0716; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21733998.7535; train_optim_loss: 21733998.7535; val_kl_reg_loss: 72153.3317; val_edge_recon_loss: 11519618.6667; val_gene_expr_recon_loss: 9821626.7500; val_masked_gp_l1_reg_loss: 12635.3232; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21426034.7500; val_optim_loss: 21426034.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8304; val_auprc_score: 0.9591; val_best_acc_score: 0.8778; val_best_f1_score: 0.9321; train_kl_reg_loss: 61674.9650; train_edge_recon_loss: 10109836.2907; train_gene_expr_recon_loss: 9736422.6372; train_masked_gp_l1_reg_loss: 12814.0218; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19920747.8047; train_optim_loss: 19920747.8047; val_kl_reg_loss: 48617.2238; val_edge_recon_loss: 10387774.2917; val_gene_expr_recon_loss: 9500282.4583; val_masked_gp_l1_reg_loss: 13185.1738; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19949860.1667; val_optim_loss: 19949860.1667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8332; val_auprc_score: 0.9616; val_best_acc_score: 0.8836; val_best_f1_score: 0.9351; train_kl_reg_loss: 70638.5427; train_edge_recon_loss: 9355596.1488; train_gene_expr_recon_loss: 9347430.8791; train_masked_gp_l1_reg_loss: 13439.8877; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18787105.5581; train_optim_loss: 18787105.5581; val_kl_reg_loss: 92817.0547; val_edge_recon_loss: 9186847.6250; val_gene_expr_recon_loss: 9188169.1250; val_masked_gp_l1_reg_loss: 13715.7910; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18481549.6667; val_optim_loss: 18481549.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8280; val_auprc_score: 0.9594; val_best_acc_score: 0.8878; val_best_f1_score: 0.9376; train_kl_reg_loss: 113546.4191; train_edge_recon_loss: 8805184.2558; train_gene_expr_recon_loss: 9079801.0372; train_masked_gp_l1_reg_loss: 13962.8457; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18012494.5628; train_optim_loss: 18012494.5628; val_kl_reg_loss: 119878.6927; val_edge_recon_loss: 8849188.2708; val_gene_expr_recon_loss: 8968677.1667; val_masked_gp_l1_reg_loss: 14181.7363; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17951926.1667; val_optim_loss: 17951926.1667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8378; val_auprc_score: 0.9603; val_best_acc_score: 0.8949; val_best_f1_score: 0.9412; train_kl_reg_loss: 127224.9935; train_edge_recon_loss: 8746196.2488; train_gene_expr_recon_loss: 8890534.6651; train_masked_gp_l1_reg_loss: 14402.2065; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17778358.0233; train_optim_loss: 17778358.0233; val_kl_reg_loss: 120633.2083; val_edge_recon_loss: 8675323.8542; val_gene_expr_recon_loss: 8805137.0833; val_masked_gp_l1_reg_loss: 14626.9727; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17615720.5417; val_optim_loss: 17615720.5417
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8420; val_auprc_score: 0.9619; val_best_acc_score: 0.9001; val_best_f1_score: 0.9441; train_kl_reg_loss: 120557.4971; train_edge_recon_loss: 8687823.4767; train_gene_expr_recon_loss: 8648134.8326; train_masked_gp_l1_reg_loss: 14898.1567; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17471413.9907; train_optim_loss: 17471413.9907; val_kl_reg_loss: 110391.3936; val_edge_recon_loss: 8674188.9583; val_gene_expr_recon_loss: 8503082.5000; val_masked_gp_l1_reg_loss: 15166.8672; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17302828.7083; val_optim_loss: 17302828.7083
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8517; val_auprc_score: 0.9655; val_best_acc_score: 0.9043; val_best_f1_score: 0.9463; train_kl_reg_loss: 111631.4514; train_edge_recon_loss: 8636411.2791; train_gene_expr_recon_loss: 8437660.0953; train_masked_gp_l1_reg_loss: 15415.3979; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17201118.1814; train_optim_loss: 17201118.1814; val_kl_reg_loss: 101139.2314; val_edge_recon_loss: 8769910.1458; val_gene_expr_recon_loss: 8378600.7292; val_masked_gp_l1_reg_loss: 15656.5088; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17265306.3750; val_optim_loss: 17265306.3750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8618; val_auprc_score: 0.9681; val_best_acc_score: 0.9089; val_best_f1_score: 0.9487; train_kl_reg_loss: 100677.4965; train_edge_recon_loss: 8586855.5372; train_gene_expr_recon_loss: 8311425.2023; train_masked_gp_l1_reg_loss: 15887.0104; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17014845.3163; train_optim_loss: 17014845.3163; val_kl_reg_loss: 92414.3473; val_edge_recon_loss: 8628196.3333; val_gene_expr_recon_loss: 8252918.9375; val_masked_gp_l1_reg_loss: 16120.4336; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16989649.7083; val_optim_loss: 16989649.7083
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8721; val_auprc_score: 0.9709; val_best_acc_score: 0.9119; val_best_f1_score: 0.9508; train_kl_reg_loss: 90248.8376; train_edge_recon_loss: 8420116.1326; train_gene_expr_recon_loss: 8205842.4814; train_masked_gp_l1_reg_loss: 16342.2106; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16732549.6419; train_optim_loss: 16732549.6419; val_kl_reg_loss: 79519.2725; val_edge_recon_loss: 8218018.9792; val_gene_expr_recon_loss: 8159581.1458; val_masked_gp_l1_reg_loss: 16548.4414; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16473667.3750; val_optim_loss: 16473667.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8851; val_auprc_score: 0.9735; val_best_acc_score: 0.9077; val_best_f1_score: 0.9480; train_kl_reg_loss: 79130.4818; train_edge_recon_loss: 8285528.2186; train_gene_expr_recon_loss: 8102111.5209; train_masked_gp_l1_reg_loss: 16743.7029; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16483513.9209; train_optim_loss: 16483513.9209; val_kl_reg_loss: 74777.4466; val_edge_recon_loss: 8481050.6042; val_gene_expr_recon_loss: 8062284.9792; val_masked_gp_l1_reg_loss: 16929.8027; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16635042.9583; val_optim_loss: 16635042.9583
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8896; val_auprc_score: 0.9756; val_best_acc_score: 0.9077; val_best_f1_score: 0.9477; train_kl_reg_loss: 73233.2924; train_edge_recon_loss: 8154152.4233; train_gene_expr_recon_loss: 8013763.6837; train_masked_gp_l1_reg_loss: 17090.9193; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16258240.3860; train_optim_loss: 16258240.3860; val_kl_reg_loss: 68490.1097; val_edge_recon_loss: 8259870.8125; val_gene_expr_recon_loss: 7963795.4375; val_masked_gp_l1_reg_loss: 17238.5176; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16309395.3750; val_optim_loss: 16309395.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8901; val_auprc_score: 0.9747; val_best_acc_score: 0.9073; val_best_f1_score: 0.9475; train_kl_reg_loss: 69021.9267; train_edge_recon_loss: 8160184.8349; train_gene_expr_recon_loss: 7926268.2628; train_masked_gp_l1_reg_loss: 17356.2922; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16172831.3163; train_optim_loss: 16172831.3163; val_kl_reg_loss: 65296.1058; val_edge_recon_loss: 8264058.7708; val_gene_expr_recon_loss: 7885440.1875; val_masked_gp_l1_reg_loss: 17464.6680; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16232259.9167; val_optim_loss: 16232259.9167
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9037; val_auprc_score: 0.9798; val_best_acc_score: 0.9097; val_best_f1_score: 0.9488; train_kl_reg_loss: 64701.3788; train_edge_recon_loss: 8195056.6767; train_gene_expr_recon_loss: 7845146.0581; train_masked_gp_l1_reg_loss: 17559.5141; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16122463.5953; train_optim_loss: 16122463.5953; val_kl_reg_loss: 60586.5885; val_edge_recon_loss: 7946567.5625; val_gene_expr_recon_loss: 7812274.5000; val_masked_gp_l1_reg_loss: 17644.2402; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15837072.5833; val_optim_loss: 15837072.5833
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9088; val_auprc_score: 0.9811; val_best_acc_score: 0.9106; val_best_f1_score: 0.9487; train_kl_reg_loss: 58177.4390; train_edge_recon_loss: 8047594.8512; train_gene_expr_recon_loss: 7779134.5163; train_masked_gp_l1_reg_loss: 17720.5488; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15902627.3023; train_optim_loss: 15902627.3023; val_kl_reg_loss: 57415.4001; val_edge_recon_loss: 8085253.7708; val_gene_expr_recon_loss: 7780746.9167; val_masked_gp_l1_reg_loss: 17795.2910; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15941211.2083; val_optim_loss: 15941211.2083
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9062; val_auprc_score: 0.9786; val_best_acc_score: 0.9101; val_best_f1_score: 0.9483; train_kl_reg_loss: 52976.3110; train_edge_recon_loss: 8090947.4163; train_gene_expr_recon_loss: 7720010.7907; train_masked_gp_l1_reg_loss: 17829.3394; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15881763.8512; train_optim_loss: 15881763.8512; val_kl_reg_loss: 48365.6147; val_edge_recon_loss: 8312399.0208; val_gene_expr_recon_loss: 7699109.8750; val_masked_gp_l1_reg_loss: 17900.2168; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16077774.4167; val_optim_loss: 16077774.4167
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9111; val_auprc_score: 0.9807; val_best_acc_score: 0.9093; val_best_f1_score: 0.9480; train_kl_reg_loss: 46622.0482; train_edge_recon_loss: 8049156.6535; train_gene_expr_recon_loss: 7666831.7349; train_masked_gp_l1_reg_loss: 17929.2019; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15780539.6465; train_optim_loss: 15780539.6465; val_kl_reg_loss: 44427.9357; val_edge_recon_loss: 8206175.4792; val_gene_expr_recon_loss: 7635453.7083; val_masked_gp_l1_reg_loss: 17927.7129; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15903985.0833; val_optim_loss: 15903985.0833
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9181; val_auprc_score: 0.9824; val_best_acc_score: 0.9116; val_best_f1_score: 0.9495; train_kl_reg_loss: 43443.3660; train_edge_recon_loss: 7948785.1163; train_gene_expr_recon_loss: 7613891.6884; train_masked_gp_l1_reg_loss: 17905.0086; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15624025.1953; train_optim_loss: 15624025.1953; val_kl_reg_loss: 39666.1445; val_edge_recon_loss: 8024443.7708; val_gene_expr_recon_loss: 7592833.1458; val_masked_gp_l1_reg_loss: 17866.5273; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15674809.8750; val_optim_loss: 15674809.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9230; val_auprc_score: 0.9830; val_best_acc_score: 0.9156; val_best_f1_score: 0.9518; train_kl_reg_loss: 38612.5682; train_edge_recon_loss: 8053535.2465; train_gene_expr_recon_loss: 7572543.6093; train_masked_gp_l1_reg_loss: 17840.1457; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15682531.5767; train_optim_loss: 15682531.5767; val_kl_reg_loss: 34563.4076; val_edge_recon_loss: 7986192.7917; val_gene_expr_recon_loss: 7550796.1667; val_masked_gp_l1_reg_loss: 17779.9219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15589332.2500; val_optim_loss: 15589332.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9219; val_auprc_score: 0.9829; val_best_acc_score: 0.9133; val_best_f1_score: 0.9504; train_kl_reg_loss: 37360.7074; train_edge_recon_loss: 7980871.8419; train_gene_expr_recon_loss: 7529728.3279; train_masked_gp_l1_reg_loss: 17718.6555; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15565679.5395; train_optim_loss: 15565679.5395; val_kl_reg_loss: 35498.9022; val_edge_recon_loss: 8081744.8542; val_gene_expr_recon_loss: 7502229.0417; val_masked_gp_l1_reg_loss: 17643.1914; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15637115.8750; val_optim_loss: 15637115.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9258; val_auprc_score: 0.9836; val_best_acc_score: 0.9193; val_best_f1_score: 0.9534; train_kl_reg_loss: 36090.2864; train_edge_recon_loss: 7970091.4907; train_gene_expr_recon_loss: 7495157.6977; train_masked_gp_l1_reg_loss: 17539.1691; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15518878.6372; train_optim_loss: 15518878.6372; val_kl_reg_loss: 36180.0316; val_edge_recon_loss: 8031451.9167; val_gene_expr_recon_loss: 7499705.0208; val_masked_gp_l1_reg_loss: 17388.0957; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15584724.8333; val_optim_loss: 15584724.8333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9287; val_auprc_score: 0.9841; val_best_acc_score: 0.9227; val_best_f1_score: 0.9557; train_kl_reg_loss: 35679.6459; train_edge_recon_loss: 7877861.0535; train_gene_expr_recon_loss: 7458509.5512; train_masked_gp_l1_reg_loss: 17249.4626; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15389299.6930; train_optim_loss: 15389299.6930; val_kl_reg_loss: 34531.5256; val_edge_recon_loss: 7878056.9792; val_gene_expr_recon_loss: 7436839.6875; val_masked_gp_l1_reg_loss: 17088.7422; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15366517.1250; val_optim_loss: 15366517.1250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9291; val_auprc_score: 0.9842; val_best_acc_score: 0.9194; val_best_f1_score: 0.9534; train_kl_reg_loss: 35974.6750; train_edge_recon_loss: 7959496.1837; train_gene_expr_recon_loss: 7432572.1860; train_masked_gp_l1_reg_loss: 16991.7999; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15445034.7628; train_optim_loss: 15445034.7628; val_kl_reg_loss: 18222.0600; val_edge_recon_loss: 8077437.2083; val_gene_expr_recon_loss: 7421635.8750; val_masked_gp_l1_reg_loss: 16868.7324; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15534164.2500; val_optim_loss: 15534164.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9382; val_auprc_score: 0.9866; val_best_acc_score: 0.9252; val_best_f1_score: 0.9567; train_kl_reg_loss: 33970.7689; train_edge_recon_loss: 7840640.4302; train_gene_expr_recon_loss: 7398024.9047; train_masked_gp_l1_reg_loss: 16711.8978; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15289348.0233; train_optim_loss: 15289348.0233; val_kl_reg_loss: 16738.1020; val_edge_recon_loss: 8032218.3958; val_gene_expr_recon_loss: 7385607.0833; val_masked_gp_l1_reg_loss: 16525.3672; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15451088.5833; val_optim_loss: 15451088.5833
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9361; val_auprc_score: 0.9856; val_best_acc_score: 0.9271; val_best_f1_score: 0.9580; train_kl_reg_loss: 33000.0476; train_edge_recon_loss: 7789478.4395; train_gene_expr_recon_loss: 7363288.5372; train_masked_gp_l1_reg_loss: 16370.1071; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15202137.1581; train_optim_loss: 15202137.1581; val_kl_reg_loss: 17159.3482; val_edge_recon_loss: 7947017.6875; val_gene_expr_recon_loss: 7356937.1250; val_masked_gp_l1_reg_loss: 16186.9746; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15337301.1667; val_optim_loss: 15337301.1667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9390; val_auprc_score: 0.9864; val_best_acc_score: 0.9323; val_best_f1_score: 0.9609; train_kl_reg_loss: 30216.1508; train_edge_recon_loss: 7830517.7628; train_gene_expr_recon_loss: 7328282.1605; train_masked_gp_l1_reg_loss: 16045.7289; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15205061.8186; train_optim_loss: 15205061.8186; val_kl_reg_loss: 15877.0789; val_edge_recon_loss: 7674306.4792; val_gene_expr_recon_loss: 7313946.4375; val_masked_gp_l1_reg_loss: 15884.6670; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15020015.0417; val_optim_loss: 15020015.0417
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9395; val_auprc_score: 0.9862; val_best_acc_score: 0.9348; val_best_f1_score: 0.9622; train_kl_reg_loss: 28271.7834; train_edge_recon_loss: 7793208.5558; train_gene_expr_recon_loss: 7293966.0977; train_masked_gp_l1_reg_loss: 15731.8190; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15131178.2140; train_optim_loss: 15131178.2140; val_kl_reg_loss: 16190.8798; val_edge_recon_loss: 7913941.7917; val_gene_expr_recon_loss: 7276364.6875; val_masked_gp_l1_reg_loss: 15532.3340; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15222029.5000; val_optim_loss: 15222029.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9493; val_auprc_score: 0.9886; val_best_acc_score: 0.9374; val_best_f1_score: 0.9638; train_kl_reg_loss: 27736.9088; train_edge_recon_loss: 7828522.8023; train_gene_expr_recon_loss: 7266653.9186; train_masked_gp_l1_reg_loss: 15341.8259; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15138255.4605; train_optim_loss: 15138255.4605; val_kl_reg_loss: 15841.6243; val_edge_recon_loss: 7869815.8333; val_gene_expr_recon_loss: 7250791.0000; val_masked_gp_l1_reg_loss: 15156.3789; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15151604.5417; val_optim_loss: 15151604.5417
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9458; val_auprc_score: 0.9876; val_best_acc_score: 0.9384; val_best_f1_score: 0.9645; train_kl_reg_loss: 27156.4572; train_edge_recon_loss: 7769994.1163; train_gene_expr_recon_loss: 7240592.4279; train_masked_gp_l1_reg_loss: 14963.3296; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15052706.2977; train_optim_loss: 15052706.2977; val_kl_reg_loss: 16061.0795; val_edge_recon_loss: 7731158.5000; val_gene_expr_recon_loss: 7229368.3958; val_masked_gp_l1_reg_loss: 14745.7471; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14991333.9583; val_optim_loss: 14991333.9583
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9499; val_auprc_score: 0.9883; val_best_acc_score: 0.9384; val_best_f1_score: 0.9640; train_kl_reg_loss: 26797.3575; train_edge_recon_loss: 7755051.1442; train_gene_expr_recon_loss: 7220655.3628; train_masked_gp_l1_reg_loss: 14527.2820; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15017031.1953; train_optim_loss: 15017031.1953; val_kl_reg_loss: 15232.1357; val_edge_recon_loss: 8048222.5000; val_gene_expr_recon_loss: 7209864.0417; val_masked_gp_l1_reg_loss: 14314.8545; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15287633.6250; val_optim_loss: 15287633.6250
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9510; val_auprc_score: 0.9901; val_best_acc_score: 0.9419; val_best_f1_score: 0.9666; train_kl_reg_loss: 25798.7288; train_edge_recon_loss: 7741893.5279; train_gene_expr_recon_loss: 7196332.4605; train_masked_gp_l1_reg_loss: 14165.2825; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14978190.0047; train_optim_loss: 14978190.0047; val_kl_reg_loss: 14305.6199; val_edge_recon_loss: 7610009.0833; val_gene_expr_recon_loss: 7193523.1667; val_masked_gp_l1_reg_loss: 13996.1865; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14831833.8333; val_optim_loss: 14831833.8333
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9513; val_auprc_score: 0.9895; val_best_acc_score: 0.9401; val_best_f1_score: 0.9654; train_kl_reg_loss: 25046.4014; train_edge_recon_loss: 7695596.5256; train_gene_expr_recon_loss: 7183825.7837; train_masked_gp_l1_reg_loss: 13827.8857; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14918296.6047; train_optim_loss: 14918296.6047; val_kl_reg_loss: 15419.8325; val_edge_recon_loss: 7818130.5417; val_gene_expr_recon_loss: 7171081.9583; val_masked_gp_l1_reg_loss: 13615.6133; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15018248.4167; val_optim_loss: 15018248.4167
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9492; val_auprc_score: 0.9884; val_best_acc_score: 0.9395; val_best_f1_score: 0.9651; train_kl_reg_loss: 25390.2302; train_edge_recon_loss: 7748916.8209; train_gene_expr_recon_loss: 7164426.8233; train_masked_gp_l1_reg_loss: 13438.3865; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14952172.2465; train_optim_loss: 14952172.2465; val_kl_reg_loss: 14793.7084; val_edge_recon_loss: 7809302.7708; val_gene_expr_recon_loss: 7153775.8125; val_masked_gp_l1_reg_loss: 13256.1963; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14991128.3333; val_optim_loss: 14991128.3333
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9461; val_auprc_score: 0.9875; val_best_acc_score: 0.9362; val_best_f1_score: 0.9632; train_kl_reg_loss: 25279.6915; train_edge_recon_loss: 7693814.4674; train_gene_expr_recon_loss: 7148862.1349; train_masked_gp_l1_reg_loss: 13095.1706; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14881051.4977; train_optim_loss: 14881051.4977; val_kl_reg_loss: 15269.4672; val_edge_recon_loss: 7965245.7292; val_gene_expr_recon_loss: 7198639.1458; val_masked_gp_l1_reg_loss: 12902.7070; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15192057.3333; val_optim_loss: 15192057.3333
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9535; val_auprc_score: 0.9893; val_best_acc_score: 0.9437; val_best_f1_score: 0.9675; train_kl_reg_loss: 25025.8774; train_edge_recon_loss: 7654246.4326; train_gene_expr_recon_loss: 7139460.6395; train_masked_gp_l1_reg_loss: 12723.2007; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14831456.1721; train_optim_loss: 14831456.1721; val_kl_reg_loss: 15904.4702; val_edge_recon_loss: 7797264.5417; val_gene_expr_recon_loss: 7138477.1667; val_masked_gp_l1_reg_loss: 12542.0723; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14964188.1667; val_optim_loss: 14964188.1667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9552; val_auprc_score: 0.9899; val_best_acc_score: 0.9454; val_best_f1_score: 0.9686; train_kl_reg_loss: 25516.6304; train_edge_recon_loss: 7668704.1558; train_gene_expr_recon_loss: 7108879.4395; train_masked_gp_l1_reg_loss: 12504.3786; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14815604.5953; train_optim_loss: 14815604.5953; val_kl_reg_loss: 15238.8534; val_edge_recon_loss: 7703499.8750; val_gene_expr_recon_loss: 7112281.9375; val_masked_gp_l1_reg_loss: 12482.7363; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14843503.6667; val_optim_loss: 14843503.6667
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9548; val_auprc_score: 0.9888; val_best_acc_score: 0.9438; val_best_f1_score: 0.9675; train_kl_reg_loss: 24842.8290; train_edge_recon_loss: 7728384.7512; train_gene_expr_recon_loss: 7107631.4977; train_masked_gp_l1_reg_loss: 12471.4146; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14873330.4698; train_optim_loss: 14873330.4698; val_kl_reg_loss: 15152.5182; val_edge_recon_loss: 7702176.5208; val_gene_expr_recon_loss: 7108850.1250; val_masked_gp_l1_reg_loss: 12458.4453; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14838637.2083; val_optim_loss: 14838637.2083
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9543; val_auprc_score: 0.9875; val_best_acc_score: 0.9416; val_best_f1_score: 0.9660; train_kl_reg_loss: 24783.7459; train_edge_recon_loss: 7628604.7372; train_gene_expr_recon_loss: 7102230.0256; train_masked_gp_l1_reg_loss: 12442.9182; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14768061.4047; train_optim_loss: 14768061.4047; val_kl_reg_loss: 15070.8807; val_edge_recon_loss: 8167983.1667; val_gene_expr_recon_loss: 7107244.8750; val_masked_gp_l1_reg_loss: 12429.4434; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15302727.9583; val_optim_loss: 15302727.9583
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9550; val_auprc_score: 0.9897; val_best_acc_score: 0.9437; val_best_f1_score: 0.9675; train_kl_reg_loss: 24601.8310; train_edge_recon_loss: 7696288.7930; train_gene_expr_recon_loss: 7101997.7279; train_masked_gp_l1_reg_loss: 12411.6328; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14835299.9953; train_optim_loss: 14835299.9953; val_kl_reg_loss: 15177.6307; val_edge_recon_loss: 7721579.1875; val_gene_expr_recon_loss: 7106143.2708; val_masked_gp_l1_reg_loss: 12393.9160; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14855294.2083; val_optim_loss: 14855294.2083

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 51 min 19 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9476
Val AUPRC score: 0.9881
Val best accuracy score: 0.9403
Val best F1 score: 0.9655
Val gene expr MSE score: 119975.5808
Val cat covariate0 mean sim diff: 0.0007

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
