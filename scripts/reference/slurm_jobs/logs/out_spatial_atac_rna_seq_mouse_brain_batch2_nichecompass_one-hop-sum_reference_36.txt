[True]
Run timestamp: 10082023_202110_36.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_36']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7574; val_auprc_score: 0.7838; val_best_acc_score: 0.5003; val_best_f1_score: 0.6667; train_kl_reg_loss: 148077.6894; train_edge_recon_loss: 3766790.4256; train_gene_expr_recon_loss: 28043794.8550; train_masked_gp_l1_reg_loss: 78170.9331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241951.4208; train_chrom_access_recon_loss: 16614484.8321; train_global_loss: 48893270.0153; train_optim_loss: 48893270.0153; val_kl_reg_loss: 45610.8865; val_edge_recon_loss: 4065545.6000; val_gene_expr_recon_loss: 23800503.8667; val_masked_gp_l1_reg_loss: 79444.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 235046.6875; val_chrom_access_recon_loss: 15661981.7333; val_global_loss: 43888132.5333; val_optim_loss: 43888132.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7429; val_auprc_score: 0.7739; val_best_acc_score: 0.5385; val_best_f1_score: 0.6765; train_kl_reg_loss: 127610.9040; train_edge_recon_loss: 3633653.6183; train_gene_expr_recon_loss: 23168112.7939; train_masked_gp_l1_reg_loss: 80253.3470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 226616.8532; train_chrom_access_recon_loss: 15549698.9618; train_global_loss: 42785946.3206; train_optim_loss: 42785946.3206; val_kl_reg_loss: 167981.2469; val_edge_recon_loss: 4061622.9333; val_gene_expr_recon_loss: 22552590.5333; val_masked_gp_l1_reg_loss: 78904.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 217322.5156; val_chrom_access_recon_loss: 15355279.7333; val_global_loss: 42433701.3333; val_optim_loss: 42433701.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7699; val_auprc_score: 0.7892; val_best_acc_score: 0.6871; val_best_f1_score: 0.7105; train_kl_reg_loss: 147080.5017; train_edge_recon_loss: 3553500.1183; train_gene_expr_recon_loss: 22331615.8168; train_masked_gp_l1_reg_loss: 77915.9249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207571.2270; train_chrom_access_recon_loss: 15344517.7176; train_global_loss: 41662201.2519; train_optim_loss: 41662201.2519; val_kl_reg_loss: 133641.9047; val_edge_recon_loss: 4036800.2000; val_gene_expr_recon_loss: 22059848.5333; val_masked_gp_l1_reg_loss: 77867.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 197765.6250; val_chrom_access_recon_loss: 15196803.8667; val_global_loss: 41702728.2667; val_optim_loss: 41702728.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8484; val_auprc_score: 0.8490; val_best_acc_score: 0.7645; val_best_f1_score: 0.7769; train_kl_reg_loss: 132169.4866; train_edge_recon_loss: 3522726.5897; train_gene_expr_recon_loss: 22011836.7023; train_masked_gp_l1_reg_loss: 78502.4521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188568.7504; train_chrom_access_recon_loss: 15236053.5954; train_global_loss: 41169857.4656; train_optim_loss: 41169857.4656; val_kl_reg_loss: 127847.5922; val_edge_recon_loss: 3824662.6833; val_gene_expr_recon_loss: 21882284.5333; val_masked_gp_l1_reg_loss: 79863.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179580.2812; val_chrom_access_recon_loss: 15133632.1333; val_global_loss: 41227870.1333; val_optim_loss: 41227870.1333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8740; val_auprc_score: 0.8637; val_best_acc_score: 0.7863; val_best_f1_score: 0.8036; train_kl_reg_loss: 130581.1427; train_edge_recon_loss: 3241946.9237; train_gene_expr_recon_loss: 21845720.5344; train_masked_gp_l1_reg_loss: 81692.6297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171478.1085; train_chrom_access_recon_loss: 15146664.4809; train_global_loss: 40618083.8473; train_optim_loss: 40618083.8473; val_kl_reg_loss: 152211.0417; val_edge_recon_loss: 3045628.9000; val_gene_expr_recon_loss: 21736555.3333; val_masked_gp_l1_reg_loss: 83558.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163760.0312; val_chrom_access_recon_loss: 15040463.8000; val_global_loss: 40222177.6000; val_optim_loss: 40222177.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8828; val_auprc_score: 0.8687; val_best_acc_score: 0.7952; val_best_f1_score: 0.8105; train_kl_reg_loss: 155896.2068; train_edge_recon_loss: 3021292.6832; train_gene_expr_recon_loss: 21702578.4885; train_masked_gp_l1_reg_loss: 85428.8269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157225.6266; train_chrom_access_recon_loss: 15079256.0687; train_global_loss: 40201677.9847; train_optim_loss: 40201677.9847; val_kl_reg_loss: 150152.2375; val_edge_recon_loss: 3013050.1500; val_gene_expr_recon_loss: 21601829.3333; val_masked_gp_l1_reg_loss: 86939.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150789.1406; val_chrom_access_recon_loss: 14988026.9333; val_global_loss: 39990788.8000; val_optim_loss: 39990788.8000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8931; val_auprc_score: 0.8758; val_best_acc_score: 0.8091; val_best_f1_score: 0.8212; train_kl_reg_loss: 151011.0491; train_edge_recon_loss: 2973206.3378; train_gene_expr_recon_loss: 21576930.3817; train_masked_gp_l1_reg_loss: 88031.3329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144452.7663; train_chrom_access_recon_loss: 15003235.5573; train_global_loss: 39936867.6336; train_optim_loss: 39936867.6336; val_kl_reg_loss: 146715.9635; val_edge_recon_loss: 2949116.2333; val_gene_expr_recon_loss: 21467469.4667; val_masked_gp_l1_reg_loss: 89727.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138250.8906; val_chrom_access_recon_loss: 14912205.8000; val_global_loss: 39703485.8667; val_optim_loss: 39703485.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9138; val_auprc_score: 0.8986; val_best_acc_score: 0.8345; val_best_f1_score: 0.8458; train_kl_reg_loss: 144646.9088; train_edge_recon_loss: 2936258.2557; train_gene_expr_recon_loss: 21467596.8092; train_masked_gp_l1_reg_loss: 91215.4128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132793.5953; train_chrom_access_recon_loss: 14937808.0229; train_global_loss: 39710319.0229; train_optim_loss: 39710319.0229; val_kl_reg_loss: 147290.9167; val_edge_recon_loss: 2920390.4500; val_gene_expr_recon_loss: 21486441.6000; val_masked_gp_l1_reg_loss: 92408.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127689.4375; val_chrom_access_recon_loss: 14909893.5333; val_global_loss: 39684114.4000; val_optim_loss: 39684114.4000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9245; val_auprc_score: 0.9083; val_best_acc_score: 0.8508; val_best_f1_score: 0.8597; train_kl_reg_loss: 143801.4636; train_edge_recon_loss: 2895092.8397; train_gene_expr_recon_loss: 21355286.1527; train_masked_gp_l1_reg_loss: 93596.2705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123222.4028; train_chrom_access_recon_loss: 14872197.4351; train_global_loss: 39483196.4885; train_optim_loss: 39483196.4885; val_kl_reg_loss: 137155.2370; val_edge_recon_loss: 2883578.8167; val_gene_expr_recon_loss: 21349953.2000; val_masked_gp_l1_reg_loss: 95075.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118791.7266; val_chrom_access_recon_loss: 14839503.1333; val_global_loss: 39424057.8667; val_optim_loss: 39424057.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9319; val_auprc_score: 0.9167; val_best_acc_score: 0.8595; val_best_f1_score: 0.8676; train_kl_reg_loss: 141962.2963; train_edge_recon_loss: 2871985.0687; train_gene_expr_recon_loss: 21295576.3053; train_masked_gp_l1_reg_loss: 95854.9884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114548.6419; train_chrom_access_recon_loss: 14845386.7405; train_global_loss: 39365314.1374; train_optim_loss: 39365314.1374; val_kl_reg_loss: 137095.7531; val_edge_recon_loss: 2857330.9667; val_gene_expr_recon_loss: 21296781.7333; val_masked_gp_l1_reg_loss: 96741.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110377.4141; val_chrom_access_recon_loss: 14787754.4667; val_global_loss: 39286083.2000; val_optim_loss: 39286083.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9322; val_auprc_score: 0.9180; val_best_acc_score: 0.8603; val_best_f1_score: 0.8692; train_kl_reg_loss: 139045.4302; train_edge_recon_loss: 2847462.1660; train_gene_expr_recon_loss: 21224621.9084; train_masked_gp_l1_reg_loss: 97446.5569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106457.9183; train_chrom_access_recon_loss: 14822978.7939; train_global_loss: 39238012.9466; train_optim_loss: 39238012.9466; val_kl_reg_loss: 137692.7490; val_edge_recon_loss: 2860613.8500; val_gene_expr_recon_loss: 21084833.4667; val_masked_gp_l1_reg_loss: 98426.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102670.2734; val_chrom_access_recon_loss: 14690242.0000; val_global_loss: 38974478.1333; val_optim_loss: 38974478.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9391; val_auprc_score: 0.9264; val_best_acc_score: 0.8705; val_best_f1_score: 0.8791; train_kl_reg_loss: 134951.8027; train_edge_recon_loss: 2836590.1546; train_gene_expr_recon_loss: 21137880.3664; train_masked_gp_l1_reg_loss: 99166.6853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99182.4529; train_chrom_access_recon_loss: 14763634.0382; train_global_loss: 39071405.3740; train_optim_loss: 39071405.3740; val_kl_reg_loss: 132847.6214; val_edge_recon_loss: 2848784.1500; val_gene_expr_recon_loss: 21091666.2667; val_masked_gp_l1_reg_loss: 99738.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95807.4844; val_chrom_access_recon_loss: 14702454.2667; val_global_loss: 38971298.1333; val_optim_loss: 38971298.1333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9383; val_auprc_score: 0.9225; val_best_acc_score: 0.8721; val_best_f1_score: 0.8789; train_kl_reg_loss: 131848.7395; train_edge_recon_loss: 2826045.4523; train_gene_expr_recon_loss: 21084704.4733; train_masked_gp_l1_reg_loss: 100580.6056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92684.7423; train_chrom_access_recon_loss: 14736942.1450; train_global_loss: 38972805.7405; train_optim_loss: 38972805.7405; val_kl_reg_loss: 126437.6708; val_edge_recon_loss: 2868348.4333; val_gene_expr_recon_loss: 21058608.4000; val_masked_gp_l1_reg_loss: 101471.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89685.5859; val_chrom_access_recon_loss: 14662265.2667; val_global_loss: 38906817.8667; val_optim_loss: 38906817.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9464; val_auprc_score: 0.9328; val_best_acc_score: 0.8852; val_best_f1_score: 0.8905; train_kl_reg_loss: 128424.0108; train_edge_recon_loss: 2810344.9370; train_gene_expr_recon_loss: 21057651.6794; train_masked_gp_l1_reg_loss: 102157.9221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86925.7807; train_chrom_access_recon_loss: 14729103.6718; train_global_loss: 38914607.9084; train_optim_loss: 38914607.9084; val_kl_reg_loss: 128204.5276; val_edge_recon_loss: 2809916.4167; val_gene_expr_recon_loss: 21055462.4000; val_masked_gp_l1_reg_loss: 102782.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84279.1719; val_chrom_access_recon_loss: 14724060.8000; val_global_loss: 38904705.6000; val_optim_loss: 38904705.6000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9506; val_auprc_score: 0.9381; val_best_acc_score: 0.8882; val_best_f1_score: 0.8938; train_kl_reg_loss: 125762.6977; train_edge_recon_loss: 2800286.1947; train_gene_expr_recon_loss: 21003209.8779; train_masked_gp_l1_reg_loss: 103594.0700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81884.8362; train_chrom_access_recon_loss: 14691499.5649; train_global_loss: 38806237.4962; train_optim_loss: 38806237.4962; val_kl_reg_loss: 122866.6906; val_edge_recon_loss: 2804701.6500; val_gene_expr_recon_loss: 20960204.6667; val_masked_gp_l1_reg_loss: 104554.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79520.2812; val_chrom_access_recon_loss: 14640914.1333; val_global_loss: 38712760.5333; val_optim_loss: 38712760.5333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9518; val_auprc_score: 0.9381; val_best_acc_score: 0.8945; val_best_f1_score: 0.8995; train_kl_reg_loss: 123004.2056; train_edge_recon_loss: 2788674.5821; train_gene_expr_recon_loss: 20956420.2443; train_masked_gp_l1_reg_loss: 105201.8622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77426.5745; train_chrom_access_recon_loss: 14673801.1832; train_global_loss: 38724528.7634; train_optim_loss: 38724528.7634; val_kl_reg_loss: 123517.5521; val_edge_recon_loss: 2783436.1667; val_gene_expr_recon_loss: 20845778.8000; val_masked_gp_l1_reg_loss: 105813.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75450.2969; val_chrom_access_recon_loss: 14525554.8667; val_global_loss: 38459550.9333; val_optim_loss: 38459550.9333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9575; val_auprc_score: 0.9463; val_best_acc_score: 0.9010; val_best_f1_score: 0.9062; train_kl_reg_loss: 122232.0295; train_edge_recon_loss: 2778343.9485; train_gene_expr_recon_loss: 20880545.3588; train_masked_gp_l1_reg_loss: 106625.6851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73632.5595; train_chrom_access_recon_loss: 14621095.9924; train_global_loss: 38582475.5725; train_optim_loss: 38582475.5725; val_kl_reg_loss: 121364.0740; val_edge_recon_loss: 2774217.6667; val_gene_expr_recon_loss: 20852430.2667; val_masked_gp_l1_reg_loss: 107483.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71963.9297; val_chrom_access_recon_loss: 14591077.2000; val_global_loss: 38518536.8000; val_optim_loss: 38518536.8000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9541; val_auprc_score: 0.9383; val_best_acc_score: 0.8975; val_best_f1_score: 0.9032; train_kl_reg_loss: 120880.8999; train_edge_recon_loss: 2768039.8321; train_gene_expr_recon_loss: 20874030.3969; train_masked_gp_l1_reg_loss: 108083.0254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70308.9986; train_chrom_access_recon_loss: 14623912.7405; train_global_loss: 38565255.8168; train_optim_loss: 38565255.8168; val_kl_reg_loss: 114738.6667; val_edge_recon_loss: 2779834.0333; val_gene_expr_recon_loss: 20827695.6000; val_masked_gp_l1_reg_loss: 108795.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68831.0781; val_chrom_access_recon_loss: 14582978.3333; val_global_loss: 38482874.6667; val_optim_loss: 38482874.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9572; val_auprc_score: 0.9444; val_best_acc_score: 0.8984; val_best_f1_score: 0.9031; train_kl_reg_loss: 119136.6045; train_edge_recon_loss: 2768129.4504; train_gene_expr_recon_loss: 20817587.9389; train_masked_gp_l1_reg_loss: 109514.1591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67391.8277; train_chrom_access_recon_loss: 14591464.4809; train_global_loss: 38473224.5191; train_optim_loss: 38473224.5191; val_kl_reg_loss: 118620.2130; val_edge_recon_loss: 2775053.4167; val_gene_expr_recon_loss: 20851244.8000; val_masked_gp_l1_reg_loss: 110183.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66105.1406; val_chrom_access_recon_loss: 14545397.9333; val_global_loss: 38466606.1333; val_optim_loss: 38466606.1333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9596; val_auprc_score: 0.9504; val_best_acc_score: 0.9008; val_best_f1_score: 0.9061; train_kl_reg_loss: 117766.8829; train_edge_recon_loss: 2760067.2118; train_gene_expr_recon_loss: 20815197.9847; train_masked_gp_l1_reg_loss: 110858.9844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64780.3679; train_chrom_access_recon_loss: 14613951.5878; train_global_loss: 38482623.1145; train_optim_loss: 38482623.1145; val_kl_reg_loss: 114091.4776; val_edge_recon_loss: 2770339.5000; val_gene_expr_recon_loss: 20895542.9333; val_masked_gp_l1_reg_loss: 111776.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63516.7617; val_chrom_access_recon_loss: 14605343.6667; val_global_loss: 38560609.8667; val_optim_loss: 38560609.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9625; val_auprc_score: 0.9540; val_best_acc_score: 0.9051; val_best_f1_score: 0.9088; train_kl_reg_loss: 117050.1422; train_edge_recon_loss: 2750411.7691; train_gene_expr_recon_loss: 20773284.9313; train_masked_gp_l1_reg_loss: 109791.5362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62876.1143; train_chrom_access_recon_loss: 14581193.7252; train_global_loss: 38394608.1527; train_optim_loss: 38394608.1527; val_kl_reg_loss: 117739.9745; val_edge_recon_loss: 2765346.2500; val_gene_expr_recon_loss: 20774564.5333; val_masked_gp_l1_reg_loss: 109061.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62462.7422; val_chrom_access_recon_loss: 14542864.5333; val_global_loss: 38372039.2000; val_optim_loss: 38372039.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9617; val_auprc_score: 0.9520; val_best_acc_score: 0.9051; val_best_f1_score: 0.9100; train_kl_reg_loss: 118459.0635; train_edge_recon_loss: 2752735.9656; train_gene_expr_recon_loss: 20761360.6412; train_masked_gp_l1_reg_loss: 108928.5755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62208.2176; train_chrom_access_recon_loss: 14575077.3817; train_global_loss: 38378769.8931; train_optim_loss: 38378769.8931; val_kl_reg_loss: 118737.6146; val_edge_recon_loss: 2750045.1167; val_gene_expr_recon_loss: 20826308.8000; val_masked_gp_l1_reg_loss: 108856.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61973.0586; val_chrom_access_recon_loss: 14552960.7333; val_global_loss: 38418882.6667; val_optim_loss: 38418882.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9615; val_auprc_score: 0.9520; val_best_acc_score: 0.9066; val_best_f1_score: 0.9103; train_kl_reg_loss: 118200.1870; train_edge_recon_loss: 2754557.1088; train_gene_expr_recon_loss: 20735061.8473; train_masked_gp_l1_reg_loss: 108837.7723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61768.0190; train_chrom_access_recon_loss: 14557770.7252; train_global_loss: 38336195.5725; train_optim_loss: 38336195.5725; val_kl_reg_loss: 118055.7375; val_edge_recon_loss: 2763878.7000; val_gene_expr_recon_loss: 20750698.6667; val_masked_gp_l1_reg_loss: 108850.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61570.6719; val_chrom_access_recon_loss: 14577476.6667; val_global_loss: 38380530.1333; val_optim_loss: 38380530.1333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9644; val_auprc_score: 0.9572; val_best_acc_score: 0.9077; val_best_f1_score: 0.9121; train_kl_reg_loss: 118364.1779; train_edge_recon_loss: 2755198.7748; train_gene_expr_recon_loss: 20775781.9542; train_masked_gp_l1_reg_loss: 108882.4059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61366.7141; train_chrom_access_recon_loss: 14590512.4122; train_global_loss: 38410106.2901; train_optim_loss: 38410106.2901; val_kl_reg_loss: 118124.0016; val_edge_recon_loss: 2751045.2667; val_gene_expr_recon_loss: 20753340.6667; val_masked_gp_l1_reg_loss: 108886.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61165.8281; val_chrom_access_recon_loss: 14524247.9333; val_global_loss: 38316809.6000; val_optim_loss: 38316809.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9624; val_auprc_score: 0.9548; val_best_acc_score: 0.9029; val_best_f1_score: 0.9069; train_kl_reg_loss: 118020.2930; train_edge_recon_loss: 2752230.4752; train_gene_expr_recon_loss: 20746775.5878; train_masked_gp_l1_reg_loss: 108934.5468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60979.3943; train_chrom_access_recon_loss: 14572074.4733; train_global_loss: 38359014.8397; train_optim_loss: 38359014.8397; val_kl_reg_loss: 118610.5203; val_edge_recon_loss: 2763311.5667; val_gene_expr_recon_loss: 20809329.2000; val_masked_gp_l1_reg_loss: 108978.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60781.4102; val_chrom_access_recon_loss: 14574132.5333; val_global_loss: 38435143.2000; val_optim_loss: 38435143.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9589; val_auprc_score: 0.9530; val_best_acc_score: 0.8964; val_best_f1_score: 0.9004; train_kl_reg_loss: 150902.6763; train_edge_recon_loss: 3103257.6164; train_gene_expr_recon_loss: 23498997.1145; train_masked_gp_l1_reg_loss: 109263.5549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62056.0097; train_chrom_access_recon_loss: 15113537.7786; train_global_loss: 42038014.7786; train_optim_loss: 42038014.7786; val_kl_reg_loss: 19999.4215; val_edge_recon_loss: 3024376.5833; val_gene_expr_recon_loss: 23227443.6000; val_masked_gp_l1_reg_loss: 109646.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63222.9805; val_chrom_access_recon_loss: 15067400.8667; val_global_loss: 41512088.5333; val_optim_loss: 41512088.5333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9588; val_auprc_score: 0.9522; val_best_acc_score: 0.8945; val_best_f1_score: 0.8977; train_kl_reg_loss: 170114.5660; train_edge_recon_loss: 3026849.2691; train_gene_expr_recon_loss: 23169987.0992; train_masked_gp_l1_reg_loss: 109971.3692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63876.3376; train_chrom_access_recon_loss: 15070030.3053; train_global_loss: 41610828.8855; train_optim_loss: 41610828.8855; val_kl_reg_loss: 20408.7057; val_edge_recon_loss: 3023962.6000; val_gene_expr_recon_loss: 22989948.4000; val_masked_gp_l1_reg_loss: 110221.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64365.6797; val_chrom_access_recon_loss: 14969510.2667; val_global_loss: 41178417.8667; val_optim_loss: 41178417.8667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9597; val_auprc_score: 0.9538; val_best_acc_score: 0.9000; val_best_f1_score: 0.9041; train_kl_reg_loss: 165915.3935; train_edge_recon_loss: 3008691.9351; train_gene_expr_recon_loss: 22995114.0305; train_masked_gp_l1_reg_loss: 110354.1320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64612.6711; train_chrom_access_recon_loss: 15019636.8550; train_global_loss: 41364325.0992; train_optim_loss: 41364325.0992; val_kl_reg_loss: 19332.7313; val_edge_recon_loss: 2990390.1500; val_gene_expr_recon_loss: 22997123.2000; val_masked_gp_l1_reg_loss: 110444.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64788.9727; val_chrom_access_recon_loss: 15017912.0000; val_global_loss: 41199989.8667; val_optim_loss: 41199989.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9574; val_auprc_score: 0.9516; val_best_acc_score: 0.8932; val_best_f1_score: 0.8946; train_kl_reg_loss: 162812.4410; train_edge_recon_loss: 2989112.6279; train_gene_expr_recon_loss: 22943644.4580; train_masked_gp_l1_reg_loss: 110417.1607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64794.8230; train_chrom_access_recon_loss: 15011088.7481; train_global_loss: 41281870.7176; train_optim_loss: 41281870.7176; val_kl_reg_loss: 19498.8630; val_edge_recon_loss: 3023643.6500; val_gene_expr_recon_loss: 22893577.7333; val_masked_gp_l1_reg_loss: 110415.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64801.7891; val_chrom_access_recon_loss: 14966490.8000; val_global_loss: 41078429.0667; val_optim_loss: 41078429.0667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9530; val_auprc_score: 0.9426; val_best_acc_score: 0.8886; val_best_f1_score: 0.8942; train_kl_reg_loss: 162293.9671; train_edge_recon_loss: 2993605.1603; train_gene_expr_recon_loss: 22955701.9695; train_masked_gp_l1_reg_loss: 110414.7121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64809.2089; train_chrom_access_recon_loss: 15029949.2214; train_global_loss: 41316774.3511; train_optim_loss: 41316774.3511; val_kl_reg_loss: 19695.2500; val_edge_recon_loss: 3003877.9167; val_gene_expr_recon_loss: 22941444.2667; val_masked_gp_l1_reg_loss: 110411.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64815.2578; val_chrom_access_recon_loss: 14983326.2667; val_global_loss: 41123571.2000; val_optim_loss: 41123571.2000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9565; val_auprc_score: 0.9503; val_best_acc_score: 0.8954; val_best_f1_score: 0.8974; train_kl_reg_loss: 161178.7223; train_edge_recon_loss: 2990060.4924; train_gene_expr_recon_loss: 22967020.6412; train_masked_gp_l1_reg_loss: 110405.0160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64819.6191; train_chrom_access_recon_loss: 15046304.5496; train_global_loss: 41339789.4046; train_optim_loss: 41339789.4046; val_kl_reg_loss: 19758.9962; val_edge_recon_loss: 2995790.6333; val_gene_expr_recon_loss: 22797732.4000; val_masked_gp_l1_reg_loss: 110397.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64823.5547; val_chrom_access_recon_loss: 14892353.4000; val_global_loss: 40880857.0667; val_optim_loss: 40880857.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9516; val_auprc_score: 0.9408; val_best_acc_score: 0.8884; val_best_f1_score: 0.8940; train_kl_reg_loss: 160711.4468; train_edge_recon_loss: 2989557.0897; train_gene_expr_recon_loss: 22958821.9847; train_masked_gp_l1_reg_loss: 110386.1016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64825.2734; train_chrom_access_recon_loss: 15048958.1145; train_global_loss: 41333260.0916; train_optim_loss: 41333260.0916; val_kl_reg_loss: 19988.5223; val_edge_recon_loss: 3007957.1833; val_gene_expr_recon_loss: 22953390.4000; val_masked_gp_l1_reg_loss: 110373.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64825.6602; val_chrom_access_recon_loss: 14991828.3333; val_global_loss: 41148364.0000; val_optim_loss: 41148364.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 55 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9628
val AUPRC score: 0.9554
val best accuracy score: 0.9027
val best F1 score: 0.9072
val target rna MSE score: 1.8770
val source rna MSE score: 86.1287
val target atac MSE score: 0.3509
val source atac MSE score: 2.9996
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
