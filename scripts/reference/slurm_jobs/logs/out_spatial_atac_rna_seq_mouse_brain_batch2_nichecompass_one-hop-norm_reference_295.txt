[True]
Run timestamp: 07092023_072327_295.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_295']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23411 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 27040, n_cat_covariates_embed_input: 0, n_hidden: 2386, n_latent: 2286, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 23411
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 23411

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7941; val_auprc_score: 0.8166; val_best_acc_score: 0.6218; val_best_f1_score: 0.7134; train_kl_reg_loss: 83369.0096; train_edge_recon_loss: 3604518.7958; train_gene_expr_recon_loss: 15025617.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 944318.1379; train_chrom_access_recon_loss: 53071349.9237; train_global_loss: 72729173.1603; train_optim_loss: 72729173.1603; val_kl_reg_loss: 137716.6260; val_edge_recon_loss: 4059020.1833; val_gene_expr_recon_loss: 14146623.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 531759.0625; val_chrom_access_recon_loss: 52376631.7333; val_global_loss: 71251753.0667; val_optim_loss: 71251753.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8584; val_auprc_score: 0.8548; val_best_acc_score: 0.7648; val_best_f1_score: 0.7837; train_kl_reg_loss: 121557.1227; train_edge_recon_loss: 3531150.1603; train_gene_expr_recon_loss: 13863914.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 339207.1813; train_chrom_access_recon_loss: 50944312.6718; train_global_loss: 68800141.4351; train_optim_loss: 68800141.4351; val_kl_reg_loss: 94601.3833; val_edge_recon_loss: 3830605.4833; val_gene_expr_recon_loss: 13886771.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 218861.3281; val_chrom_access_recon_loss: 51298155.4667; val_global_loss: 69328996.2667; val_optim_loss: 69328996.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8665; val_auprc_score: 0.8536; val_best_acc_score: 0.7843; val_best_f1_score: 0.8031; train_kl_reg_loss: 104212.0464; train_edge_recon_loss: 3173470.9351; train_gene_expr_recon_loss: 13641101.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168850.1157; train_chrom_access_recon_loss: 50194356.1221; train_global_loss: 67281990.8397; train_optim_loss: 67281990.8397; val_kl_reg_loss: 126106.7224; val_edge_recon_loss: 3012392.1833; val_gene_expr_recon_loss: 13686551.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132158.6406; val_chrom_access_recon_loss: 50926683.7333; val_global_loss: 67883891.7333; val_optim_loss: 67883891.7333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8775; val_auprc_score: 0.8591; val_best_acc_score: 0.7964; val_best_f1_score: 0.8188; train_kl_reg_loss: 122875.7368; train_edge_recon_loss: 2949682.9408; train_gene_expr_recon_loss: 13481393.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110549.9271; train_chrom_access_recon_loss: 49761234.5649; train_global_loss: 66425736.3969; train_optim_loss: 66425736.3969; val_kl_reg_loss: 115675.2302; val_edge_recon_loss: 2961487.3500; val_gene_expr_recon_loss: 13544918.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93526.6250; val_chrom_access_recon_loss: 50366836.0000; val_global_loss: 67082443.2000; val_optim_loss: 67082443.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8871; val_auprc_score: 0.8686; val_best_acc_score: 0.8058; val_best_f1_score: 0.8315; train_kl_reg_loss: 116078.0638; train_edge_recon_loss: 2898956.6985; train_gene_expr_recon_loss: 13334066.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81953.8268; train_chrom_access_recon_loss: 49265332.9771; train_global_loss: 65696387.7863; train_optim_loss: 65696387.7863; val_kl_reg_loss: 113200.9839; val_edge_recon_loss: 2879796.7000; val_gene_expr_recon_loss: 13429952.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72082.6328; val_chrom_access_recon_loss: 49937051.4667; val_global_loss: 66432084.5333; val_optim_loss: 66432084.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8972; val_auprc_score: 0.8784; val_best_acc_score: 0.8142; val_best_f1_score: 0.8332; train_kl_reg_loss: 115221.0263; train_edge_recon_loss: 2858618.7882; train_gene_expr_recon_loss: 13223665.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65656.0041; train_chrom_access_recon_loss: 48912827.4809; train_global_loss: 65175988.6718; train_optim_loss: 65175988.6718; val_kl_reg_loss: 114198.0974; val_edge_recon_loss: 2886548.5500; val_gene_expr_recon_loss: 13290286.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59944.3711; val_chrom_access_recon_loss: 49374470.4000; val_global_loss: 65725447.7333; val_optim_loss: 65725447.7333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9160; val_auprc_score: 0.8955; val_best_acc_score: 0.8411; val_best_f1_score: 0.8513; train_kl_reg_loss: 110456.1808; train_edge_recon_loss: 2836757.7195; train_gene_expr_recon_loss: 13121810.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56058.2100; train_chrom_access_recon_loss: 48566811.4809; train_global_loss: 64691894.4733; train_optim_loss: 64691894.4733; val_kl_reg_loss: 106637.1464; val_edge_recon_loss: 2835003.9833; val_gene_expr_recon_loss: 13173902.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52878.1992; val_chrom_access_recon_loss: 49195119.2000; val_global_loss: 65363540.5333; val_optim_loss: 65363540.5333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9289; val_auprc_score: 0.9127; val_best_acc_score: 0.8651; val_best_f1_score: 0.8725; train_kl_reg_loss: 108456.0852; train_edge_recon_loss: 2800033.0382; train_gene_expr_recon_loss: 13015781.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50770.8031; train_chrom_access_recon_loss: 48174686.3817; train_global_loss: 64149728.0000; train_optim_loss: 64149728.0000; val_kl_reg_loss: 105131.0406; val_edge_recon_loss: 2789831.8167; val_gene_expr_recon_loss: 13138067.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49334.0977; val_chrom_access_recon_loss: 48918620.5333; val_global_loss: 65000985.3333; val_optim_loss: 65000985.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9310; val_auprc_score: 0.9092; val_best_acc_score: 0.8712; val_best_f1_score: 0.8803; train_kl_reg_loss: 106047.5352; train_edge_recon_loss: 2774667.1832; train_gene_expr_recon_loss: 12943099.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47840.0498; train_chrom_access_recon_loss: 47866535.3893; train_global_loss: 63738189.8931; train_optim_loss: 63738189.8931; val_kl_reg_loss: 107276.4453; val_edge_recon_loss: 2780017.5333; val_gene_expr_recon_loss: 13042459.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46691.4688; val_chrom_access_recon_loss: 48662845.3333; val_global_loss: 64639289.3333; val_optim_loss: 64639289.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9417; val_auprc_score: 0.9273; val_best_acc_score: 0.8766; val_best_f1_score: 0.8831; train_kl_reg_loss: 104643.9846; train_edge_recon_loss: 2763399.5401; train_gene_expr_recon_loss: 12865461.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45980.4002; train_chrom_access_recon_loss: 47590878.2290; train_global_loss: 63370363.9389; train_optim_loss: 63370363.9389; val_kl_reg_loss: 104258.5094; val_edge_recon_loss: 2772712.3167; val_gene_expr_recon_loss: 12954065.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45403.7305; val_chrom_access_recon_loss: 48246269.0667; val_global_loss: 64122709.8667; val_optim_loss: 64122709.8667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9413; val_auprc_score: 0.9303; val_best_acc_score: 0.8733; val_best_f1_score: 0.8795; train_kl_reg_loss: 102190.5926; train_edge_recon_loss: 2749966.7462; train_gene_expr_recon_loss: 12786174.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44899.4275; train_chrom_access_recon_loss: 47228612.4580; train_global_loss: 62911843.9389; train_optim_loss: 62911843.9389; val_kl_reg_loss: 100225.4734; val_edge_recon_loss: 2782915.8333; val_gene_expr_recon_loss: 12885466.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44271.3320; val_chrom_access_recon_loss: 48032066.4000; val_global_loss: 63844944.8000; val_optim_loss: 63844944.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9441; val_auprc_score: 0.9317; val_best_acc_score: 0.8790; val_best_f1_score: 0.8868; train_kl_reg_loss: 99882.2714; train_edge_recon_loss: 2739959.2023; train_gene_expr_recon_loss: 12746434.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44029.3172; train_chrom_access_recon_loss: 47011990.7176; train_global_loss: 62642296.1832; train_optim_loss: 62642296.1832; val_kl_reg_loss: 98575.9161; val_edge_recon_loss: 2756968.7667; val_gene_expr_recon_loss: 12857602.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43921.3516; val_chrom_access_recon_loss: 47787019.2000; val_global_loss: 63544087.2000; val_optim_loss: 63544087.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9486; val_auprc_score: 0.9373; val_best_acc_score: 0.8844; val_best_f1_score: 0.8903; train_kl_reg_loss: 97271.3897; train_edge_recon_loss: 2737125.5305; train_gene_expr_recon_loss: 12687706.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43670.0807; train_chrom_access_recon_loss: 46755934.5344; train_global_loss: 62321707.9695; train_optim_loss: 62321707.9695; val_kl_reg_loss: 95808.4182; val_edge_recon_loss: 2760477.2333; val_gene_expr_recon_loss: 12798351.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44067.5312; val_chrom_access_recon_loss: 47584189.3333; val_global_loss: 63282894.6667; val_optim_loss: 63282894.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9532; val_auprc_score: 0.9385; val_best_acc_score: 0.8960; val_best_f1_score: 0.9016; train_kl_reg_loss: 93969.3181; train_edge_recon_loss: 2739930.6679; train_gene_expr_recon_loss: 12637935.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43526.4247; train_chrom_access_recon_loss: 46510623.3282; train_global_loss: 62025985.3740; train_optim_loss: 62025985.3740; val_kl_reg_loss: 92355.0625; val_edge_recon_loss: 2740276.6500; val_gene_expr_recon_loss: 12743271.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43339.9102; val_chrom_access_recon_loss: 47419474.4000; val_global_loss: 63038717.6000; val_optim_loss: 63038717.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9546; val_auprc_score: 0.9378; val_best_acc_score: 0.8957; val_best_f1_score: 0.9015; train_kl_reg_loss: 91433.7845; train_edge_recon_loss: 2734613.7939; train_gene_expr_recon_loss: 12588866.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43327.4034; train_chrom_access_recon_loss: 46243960.7939; train_global_loss: 61702202.7176; train_optim_loss: 61702202.7176; val_kl_reg_loss: 91042.0188; val_edge_recon_loss: 2729534.3500; val_gene_expr_recon_loss: 12731325.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43327.1602; val_chrom_access_recon_loss: 47217433.3333; val_global_loss: 62812661.8667; val_optim_loss: 62812661.8667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9573; val_auprc_score: 0.9456; val_best_acc_score: 0.8994; val_best_f1_score: 0.9043; train_kl_reg_loss: 89735.4772; train_edge_recon_loss: 2721109.2595; train_gene_expr_recon_loss: 12542963.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43505.2656; train_chrom_access_recon_loss: 45998310.8092; train_global_loss: 61395624.7023; train_optim_loss: 61395624.7023; val_kl_reg_loss: 88060.0818; val_edge_recon_loss: 2742185.4667; val_gene_expr_recon_loss: 12704440.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43325.1680; val_chrom_access_recon_loss: 47158093.6000; val_global_loss: 62736105.3333; val_optim_loss: 62736105.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9626; val_auprc_score: 0.9542; val_best_acc_score: 0.9080; val_best_f1_score: 0.9122; train_kl_reg_loss: 88214.9325; train_edge_recon_loss: 2718090.7977; train_gene_expr_recon_loss: 12511461.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43553.9003; train_chrom_access_recon_loss: 45799727.4809; train_global_loss: 61161048.4885; train_optim_loss: 61161048.4885; val_kl_reg_loss: 87402.5786; val_edge_recon_loss: 2722850.2000; val_gene_expr_recon_loss: 12618425.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43689.1680; val_chrom_access_recon_loss: 46648465.8667; val_global_loss: 62120833.6000; val_optim_loss: 62120833.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9634; val_auprc_score: 0.9545; val_best_acc_score: 0.9058; val_best_f1_score: 0.9111; train_kl_reg_loss: 86845.9498; train_edge_recon_loss: 2710996.3206; train_gene_expr_recon_loss: 12470968.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43922.4218; train_chrom_access_recon_loss: 45562609.1298; train_global_loss: 60875342.4427; train_optim_loss: 60875342.4427; val_kl_reg_loss: 86363.3677; val_edge_recon_loss: 2740070.2333; val_gene_expr_recon_loss: 12609731.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44170.8203; val_chrom_access_recon_loss: 46516082.6667; val_global_loss: 61996418.6667; val_optim_loss: 61996418.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9682; val_auprc_score: 0.9619; val_best_acc_score: 0.9162; val_best_f1_score: 0.9199; train_kl_reg_loss: 85567.9456; train_edge_recon_loss: 2706577.7996; train_gene_expr_recon_loss: 12428659.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44092.1418; train_chrom_access_recon_loss: 45339691.2061; train_global_loss: 60604588.6412; train_optim_loss: 60604588.6412; val_kl_reg_loss: 85058.0797; val_edge_recon_loss: 2704429.3500; val_gene_expr_recon_loss: 12567536.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44387.8828; val_chrom_access_recon_loss: 46277495.4667; val_global_loss: 61678908.0000; val_optim_loss: 61678908.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9713; val_auprc_score: 0.9651; val_best_acc_score: 0.9169; val_best_f1_score: 0.9205; train_kl_reg_loss: 84385.9824; train_edge_recon_loss: 2707086.1469; train_gene_expr_recon_loss: 12408854.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44379.2680; train_chrom_access_recon_loss: 45179744.7328; train_global_loss: 60424450.0458; train_optim_loss: 60424450.0458; val_kl_reg_loss: 82339.6130; val_edge_recon_loss: 2702220.0333; val_gene_expr_recon_loss: 12531771.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44430.8516; val_chrom_access_recon_loss: 46313103.2000; val_global_loss: 61673864.2667; val_optim_loss: 61673864.2667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9712; val_auprc_score: 0.9632; val_best_acc_score: 0.9163; val_best_f1_score: 0.9195; train_kl_reg_loss: 82928.3840; train_edge_recon_loss: 2700870.3798; train_gene_expr_recon_loss: 12379254.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44584.2269; train_chrom_access_recon_loss: 45013390.3511; train_global_loss: 60221028.0611; train_optim_loss: 60221028.0611; val_kl_reg_loss: 83098.0250; val_edge_recon_loss: 2715359.0833; val_gene_expr_recon_loss: 12533522.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44542.7109; val_chrom_access_recon_loss: 46179369.0667; val_global_loss: 61555892.2667; val_optim_loss: 61555892.2667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9737; val_auprc_score: 0.9677; val_best_acc_score: 0.9260; val_best_f1_score: 0.9291; train_kl_reg_loss: 82127.4662; train_edge_recon_loss: 2694959.6546; train_gene_expr_recon_loss: 12362027.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44801.8960; train_chrom_access_recon_loss: 44858540.1527; train_global_loss: 60042456.3359; train_optim_loss: 60042456.3359; val_kl_reg_loss: 80937.3505; val_edge_recon_loss: 2716125.5667; val_gene_expr_recon_loss: 12469687.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44766.0234; val_chrom_access_recon_loss: 46024800.0000; val_global_loss: 61336316.2667; val_optim_loss: 61336316.2667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9740; val_auprc_score: 0.9655; val_best_acc_score: 0.9228; val_best_f1_score: 0.9254; train_kl_reg_loss: 81764.8241; train_edge_recon_loss: 2691500.9580; train_gene_expr_recon_loss: 12330207.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45040.7231; train_chrom_access_recon_loss: 44684697.0992; train_global_loss: 59833210.7176; train_optim_loss: 59833210.7176; val_kl_reg_loss: 79753.5401; val_edge_recon_loss: 2708384.4833; val_gene_expr_recon_loss: 12488347.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44737.3945; val_chrom_access_recon_loss: 45731244.2667; val_global_loss: 61052466.4000; val_optim_loss: 61052466.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9770; val_auprc_score: 0.9720; val_best_acc_score: 0.9307; val_best_f1_score: 0.9335; train_kl_reg_loss: 81031.4706; train_edge_recon_loss: 2691667.1221; train_gene_expr_recon_loss: 12309100.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45168.1550; train_chrom_access_recon_loss: 44514136.8244; train_global_loss: 59641103.7252; train_optim_loss: 59641103.7252; val_kl_reg_loss: 81325.1875; val_edge_recon_loss: 2694135.7167; val_gene_expr_recon_loss: 12520017.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45482.3555; val_chrom_access_recon_loss: 45901780.5333; val_global_loss: 61242740.8000; val_optim_loss: 61242740.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9766; val_auprc_score: 0.9692; val_best_acc_score: 0.9314; val_best_f1_score: 0.9334; train_kl_reg_loss: 80584.3138; train_edge_recon_loss: 2687997.5496; train_gene_expr_recon_loss: 12293677.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45332.3144; train_chrom_access_recon_loss: 44412475.9389; train_global_loss: 59520067.6947; train_optim_loss: 59520067.6947; val_kl_reg_loss: 79219.2469; val_edge_recon_loss: 2707495.5000; val_gene_expr_recon_loss: 12412610.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45299.4922; val_chrom_access_recon_loss: 45584582.9333; val_global_loss: 60829207.4667; val_optim_loss: 60829207.4667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9777; val_auprc_score: 0.9730; val_best_acc_score: 0.9326; val_best_f1_score: 0.9349; train_kl_reg_loss: 85829.0567; train_edge_recon_loss: 2703776.2290; train_gene_expr_recon_loss: 12087793.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32712.8968; train_chrom_access_recon_loss: 44440149.5573; train_global_loss: 59350261.0076; train_optim_loss: 59350261.0076; val_kl_reg_loss: 57972.2266; val_edge_recon_loss: 2712817.2833; val_gene_expr_recon_loss: 12214841.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30074.2852; val_chrom_access_recon_loss: 45145978.9333; val_global_loss: 60161684.2667; val_optim_loss: 60161684.2667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9817; val_auprc_score: 0.9778; val_best_acc_score: 0.9364; val_best_f1_score: 0.9390; train_kl_reg_loss: 83420.9600; train_edge_recon_loss: 2692531.8340; train_gene_expr_recon_loss: 12047534.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29679.1137; train_chrom_access_recon_loss: 44219992.9771; train_global_loss: 59073158.9618; train_optim_loss: 59073158.9618; val_kl_reg_loss: 60213.8818; val_edge_recon_loss: 2676410.8667; val_gene_expr_recon_loss: 12173189.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29442.9590; val_chrom_access_recon_loss: 44943421.3333; val_global_loss: 59882678.9333; val_optim_loss: 59882678.9333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9800; val_auprc_score: 0.9719; val_best_acc_score: 0.9363; val_best_f1_score: 0.9384; train_kl_reg_loss: 79669.2541; train_edge_recon_loss: 2681316.4523; train_gene_expr_recon_loss: 12021309.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29438.4687; train_chrom_access_recon_loss: 44090057.4656; train_global_loss: 58901791.2061; train_optim_loss: 58901791.2061; val_kl_reg_loss: 59042.4651; val_edge_recon_loss: 2702632.1000; val_gene_expr_recon_loss: 12133569.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29381.4570; val_chrom_access_recon_loss: 44801385.8667; val_global_loss: 59726010.6667; val_optim_loss: 59726010.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9827; val_auprc_score: 0.9790; val_best_acc_score: 0.9407; val_best_f1_score: 0.9424; train_kl_reg_loss: 77350.2040; train_edge_recon_loss: 2684184.3015; train_gene_expr_recon_loss: 11994606.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29413.6803; train_chrom_access_recon_loss: 43970348.7328; train_global_loss: 58755903.0229; train_optim_loss: 58755903.0229; val_kl_reg_loss: 60433.9156; val_edge_recon_loss: 2695871.6333; val_gene_expr_recon_loss: 12124921.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29522.8125; val_chrom_access_recon_loss: 44850301.8667; val_global_loss: 59761051.7333; val_optim_loss: 59761051.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9830; val_auprc_score: 0.9779; val_best_acc_score: 0.9418; val_best_f1_score: 0.9431; train_kl_reg_loss: 75195.9972; train_edge_recon_loss: 2673356.4714; train_gene_expr_recon_loss: 11982295.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29523.8709; train_chrom_access_recon_loss: 43920903.6336; train_global_loss: 58681275.8779; train_optim_loss: 58681275.8779; val_kl_reg_loss: 61459.2026; val_edge_recon_loss: 2697625.7167; val_gene_expr_recon_loss: 12125119.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29568.9121; val_chrom_access_recon_loss: 44698218.4000; val_global_loss: 59611992.2667; val_optim_loss: 59611992.2667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9812; val_auprc_score: 0.9762; val_best_acc_score: 0.9363; val_best_f1_score: 0.9381; train_kl_reg_loss: 73643.5862; train_edge_recon_loss: 2667270.1622; train_gene_expr_recon_loss: 11961052.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29639.3975; train_chrom_access_recon_loss: 43820342.8702; train_global_loss: 58551948.5191; train_optim_loss: 58551948.5191; val_kl_reg_loss: 61415.6547; val_edge_recon_loss: 2686054.4500; val_gene_expr_recon_loss: 12112455.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29716.6113; val_chrom_access_recon_loss: 44464962.9333; val_global_loss: 59354605.3333; val_optim_loss: 59354605.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9783; val_auprc_score: 0.9718; val_best_acc_score: 0.9347; val_best_f1_score: 0.9371; train_kl_reg_loss: 71920.4561; train_edge_recon_loss: 2675116.1603; train_gene_expr_recon_loss: 11945219.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29750.0642; train_chrom_access_recon_loss: 43700489.6794; train_global_loss: 58422496.0305; train_optim_loss: 58422496.0305; val_kl_reg_loss: 59395.3096; val_edge_recon_loss: 2696799.2000; val_gene_expr_recon_loss: 12095365.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29782.3730; val_chrom_access_recon_loss: 44495228.5333; val_global_loss: 59376570.6667; val_optim_loss: 59376570.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9840; val_auprc_score: 0.9792; val_best_acc_score: 0.9445; val_best_f1_score: 0.9463; train_kl_reg_loss: 70727.0741; train_edge_recon_loss: 2659245.3683; train_gene_expr_recon_loss: 11939716.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29827.5492; train_chrom_access_recon_loss: 43640514.7786; train_global_loss: 58340031.6336; train_optim_loss: 58340031.6336; val_kl_reg_loss: 60849.4555; val_edge_recon_loss: 2650095.4333; val_gene_expr_recon_loss: 12089030.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29773.7480; val_chrom_access_recon_loss: 44418340.0000; val_global_loss: 59248088.8000; val_optim_loss: 59248088.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9819; val_auprc_score: 0.9763; val_best_acc_score: 0.9399; val_best_f1_score: 0.9413; train_kl_reg_loss: 69328.0887; train_edge_recon_loss: 2659038.6584; train_gene_expr_recon_loss: 11918661.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29851.5820; train_chrom_access_recon_loss: 43582974.8092; train_global_loss: 58259854.9618; train_optim_loss: 58259854.9618; val_kl_reg_loss: 59689.4120; val_edge_recon_loss: 2691140.0500; val_gene_expr_recon_loss: 12093737.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29931.0234; val_chrom_access_recon_loss: 44492252.0000; val_global_loss: 59366749.8667; val_optim_loss: 59366749.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9864; val_auprc_score: 0.9837; val_best_acc_score: 0.9485; val_best_f1_score: 0.9501; train_kl_reg_loss: 68231.4593; train_edge_recon_loss: 2664701.9981; train_gene_expr_recon_loss: 11913660.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29953.6780; train_chrom_access_recon_loss: 43521601.0076; train_global_loss: 58198149.0076; train_optim_loss: 58198149.0076; val_kl_reg_loss: 62701.8320; val_edge_recon_loss: 2670992.1167; val_gene_expr_recon_loss: 12060585.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30094.9863; val_chrom_access_recon_loss: 44366801.0667; val_global_loss: 59191175.7333; val_optim_loss: 59191175.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9849; val_auprc_score: 0.9811; val_best_acc_score: 0.9493; val_best_f1_score: 0.9507; train_kl_reg_loss: 67258.3213; train_edge_recon_loss: 2660199.8263; train_gene_expr_recon_loss: 11895228.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30049.6194; train_chrom_access_recon_loss: 43421358.0458; train_global_loss: 58074094.1374; train_optim_loss: 58074094.1374; val_kl_reg_loss: 61201.0555; val_edge_recon_loss: 2677543.9500; val_gene_expr_recon_loss: 12061698.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30039.1211; val_chrom_access_recon_loss: 44265175.7333; val_global_loss: 59095658.1333; val_optim_loss: 59095658.1333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9806; val_auprc_score: 0.9727; val_best_acc_score: 0.9450; val_best_f1_score: 0.9467; train_kl_reg_loss: 66122.1872; train_edge_recon_loss: 2657484.3073; train_gene_expr_recon_loss: 11873754.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30049.5576; train_chrom_access_recon_loss: 43366798.1374; train_global_loss: 57994208.6412; train_optim_loss: 57994208.6412; val_kl_reg_loss: 59742.6156; val_edge_recon_loss: 2687558.7500; val_gene_expr_recon_loss: 12071767.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30187.5742; val_chrom_access_recon_loss: 44404131.2000; val_global_loss: 59253388.2667; val_optim_loss: 59253388.2667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9868; val_auprc_score: 0.9821; val_best_acc_score: 0.9534; val_best_f1_score: 0.9548; train_kl_reg_loss: 65188.3155; train_edge_recon_loss: 2658344.5515; train_gene_expr_recon_loss: 11860382.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30131.1942; train_chrom_access_recon_loss: 43341459.2366; train_global_loss: 57955506.1374; train_optim_loss: 57955506.1374; val_kl_reg_loss: 59753.8815; val_edge_recon_loss: 2663612.1500; val_gene_expr_recon_loss: 12024726.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30112.9434; val_chrom_access_recon_loss: 44151390.6667; val_global_loss: 58929596.5333; val_optim_loss: 58929596.5333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9853; val_auprc_score: 0.9808; val_best_acc_score: 0.9528; val_best_f1_score: 0.9540; train_kl_reg_loss: 64638.4294; train_edge_recon_loss: 2661602.9218; train_gene_expr_recon_loss: 11855968.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30169.0169; train_chrom_access_recon_loss: 43247953.8015; train_global_loss: 57860332.2443; train_optim_loss: 57860332.2443; val_kl_reg_loss: 60994.6432; val_edge_recon_loss: 2657857.6333; val_gene_expr_recon_loss: 12001278.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30229.5312; val_chrom_access_recon_loss: 44004272.5333; val_global_loss: 58754633.3333; val_optim_loss: 58754633.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9872; val_auprc_score: 0.9818; val_best_acc_score: 0.9531; val_best_f1_score: 0.9538; train_kl_reg_loss: 64389.4028; train_edge_recon_loss: 2651165.7195; train_gene_expr_recon_loss: 11831116.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30175.5444; train_chrom_access_recon_loss: 43110026.0458; train_global_loss: 57686873.6489; train_optim_loss: 57686873.6489; val_kl_reg_loss: 59898.3495; val_edge_recon_loss: 2664647.7000; val_gene_expr_recon_loss: 12036056.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30297.2754; val_chrom_access_recon_loss: 44228537.0667; val_global_loss: 59019437.3333; val_optim_loss: 59019437.3333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9842; val_auprc_score: 0.9781; val_best_acc_score: 0.9501; val_best_f1_score: 0.9516; train_kl_reg_loss: 63741.8754; train_edge_recon_loss: 2651362.5076; train_gene_expr_recon_loss: 11829023.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30231.0339; train_chrom_access_recon_loss: 43075753.2824; train_global_loss: 57650111.9084; train_optim_loss: 57650111.9084; val_kl_reg_loss: 57272.6214; val_edge_recon_loss: 2665763.3167; val_gene_expr_recon_loss: 11958693.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30323.0156; val_chrom_access_recon_loss: 43807627.4667; val_global_loss: 58519679.4667; val_optim_loss: 58519679.4667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9886; val_auprc_score: 0.9864; val_best_acc_score: 0.9559; val_best_f1_score: 0.9570; train_kl_reg_loss: 62600.0153; train_edge_recon_loss: 2651418.3302; train_gene_expr_recon_loss: 11819403.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30273.9155; train_chrom_access_recon_loss: 43047115.1145; train_global_loss: 57610810.5344; train_optim_loss: 57610810.5344; val_kl_reg_loss: 58439.8086; val_edge_recon_loss: 2658350.5167; val_gene_expr_recon_loss: 11939748.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30302.1172; val_chrom_access_recon_loss: 43904609.8667; val_global_loss: 58591450.4000; val_optim_loss: 58591450.4000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9865; val_auprc_score: 0.9817; val_best_acc_score: 0.9531; val_best_f1_score: 0.9541; train_kl_reg_loss: 62223.2657; train_edge_recon_loss: 2656659.7385; train_gene_expr_recon_loss: 11810843.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30330.5037; train_chrom_access_recon_loss: 42988621.4962; train_global_loss: 57548678.3511; train_optim_loss: 57548678.3511; val_kl_reg_loss: 58108.4286; val_edge_recon_loss: 2674605.5167; val_gene_expr_recon_loss: 11975458.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30230.7988; val_chrom_access_recon_loss: 43885501.3333; val_global_loss: 58623904.5333; val_optim_loss: 58623904.5333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9872; val_auprc_score: 0.9825; val_best_acc_score: 0.9538; val_best_f1_score: 0.9549; train_kl_reg_loss: 62309.1448; train_edge_recon_loss: 2656495.4924; train_gene_expr_recon_loss: 11807782.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30255.8164; train_chrom_access_recon_loss: 42986466.3511; train_global_loss: 57543309.0382; train_optim_loss: 57543309.0382; val_kl_reg_loss: 55764.8812; val_edge_recon_loss: 2667026.8500; val_gene_expr_recon_loss: 11915830.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30421.1797; val_chrom_access_recon_loss: 43603912.8000; val_global_loss: 58272956.5333; val_optim_loss: 58272956.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9870; val_auprc_score: 0.9833; val_best_acc_score: 0.9546; val_best_f1_score: 0.9556; train_kl_reg_loss: 61958.9559; train_edge_recon_loss: 2651431.8397; train_gene_expr_recon_loss: 11810383.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30373.6208; train_chrom_access_recon_loss: 42999530.5649; train_global_loss: 57553678.7481; train_optim_loss: 57553678.7481; val_kl_reg_loss: 55501.5589; val_edge_recon_loss: 2661460.8667; val_gene_expr_recon_loss: 11944829.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30434.8359; val_chrom_access_recon_loss: 43733048.5333; val_global_loss: 58425275.7333; val_optim_loss: 58425275.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9857; val_auprc_score: 0.9808; val_best_acc_score: 0.9539; val_best_f1_score: 0.9549; train_kl_reg_loss: 61564.9439; train_edge_recon_loss: 2649321.5420; train_gene_expr_recon_loss: 11804921.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30442.1897; train_chrom_access_recon_loss: 42961000.7939; train_global_loss: 57507251.1450; train_optim_loss: 57507251.1450; val_kl_reg_loss: 56308.1828; val_edge_recon_loss: 2665088.3833; val_gene_expr_recon_loss: 11941624.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30398.8496; val_chrom_access_recon_loss: 43786022.4000; val_global_loss: 58479442.6667; val_optim_loss: 58479442.6667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9886; val_auprc_score: 0.9840; val_best_acc_score: 0.9577; val_best_f1_score: 0.9585; train_kl_reg_loss: 61613.1161; train_edge_recon_loss: 2647539.1298; train_gene_expr_recon_loss: 11787155.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30403.5351; train_chrom_access_recon_loss: 42904182.0458; train_global_loss: 57430893.3130; train_optim_loss: 57430893.3130; val_kl_reg_loss: 57383.6354; val_edge_recon_loss: 2669959.5000; val_gene_expr_recon_loss: 11968347.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30357.5527; val_chrom_access_recon_loss: 43983904.2667; val_global_loss: 58709952.8000; val_optim_loss: 58709952.8000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9889; val_auprc_score: 0.9853; val_best_acc_score: 0.9593; val_best_f1_score: 0.9603; train_kl_reg_loss: 60359.6791; train_edge_recon_loss: 2649378.1947; train_gene_expr_recon_loss: 11777848.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30404.9501; train_chrom_access_recon_loss: 42886882.2595; train_global_loss: 57404874.1069; train_optim_loss: 57404874.1069; val_kl_reg_loss: 56083.1250; val_edge_recon_loss: 2645967.1667; val_gene_expr_recon_loss: 11948112.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30511.5625; val_chrom_access_recon_loss: 43705273.3333; val_global_loss: 58385947.4667; val_optim_loss: 58385947.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9892; val_auprc_score: 0.9837; val_best_acc_score: 0.9584; val_best_f1_score: 0.9593; train_kl_reg_loss: 60377.8333; train_edge_recon_loss: 2643929.3378; train_gene_expr_recon_loss: 11764777.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27737.5278; train_chrom_access_recon_loss: 42841365.9237; train_global_loss: 57338188.6107; train_optim_loss: 57338188.6107; val_kl_reg_loss: 57830.6867; val_edge_recon_loss: 2641566.0667; val_gene_expr_recon_loss: 11930489.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27418.1328; val_chrom_access_recon_loss: 43798505.6000; val_global_loss: 58455810.1333; val_optim_loss: 58455810.1333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9872; val_auprc_score: 0.9839; val_best_acc_score: 0.9555; val_best_f1_score: 0.9566; train_kl_reg_loss: 61183.1374; train_edge_recon_loss: 2639420.9866; train_gene_expr_recon_loss: 11761377.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27347.8122; train_chrom_access_recon_loss: 42828361.1603; train_global_loss: 57317690.6565; train_optim_loss: 57317690.6565; val_kl_reg_loss: 57731.1823; val_edge_recon_loss: 2667238.4500; val_gene_expr_recon_loss: 11895643.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27287.4629; val_chrom_access_recon_loss: 43782746.4000; val_global_loss: 58430647.2000; val_optim_loss: 58430647.2000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9896; val_auprc_score: 0.9871; val_best_acc_score: 0.9634; val_best_f1_score: 0.9640; train_kl_reg_loss: 61160.0918; train_edge_recon_loss: 2648929.9046; train_gene_expr_recon_loss: 11748236.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27246.2112; train_chrom_access_recon_loss: 42746875.0534; train_global_loss: 57232447.8473; train_optim_loss: 57232447.8473; val_kl_reg_loss: 58382.6198; val_edge_recon_loss: 2630343.7500; val_gene_expr_recon_loss: 11917400.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27202.2578; val_chrom_access_recon_loss: 43754711.4667; val_global_loss: 58388041.3333; val_optim_loss: 58388041.3333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9877; val_auprc_score: 0.9815; val_best_acc_score: 0.9577; val_best_f1_score: 0.9588; train_kl_reg_loss: 61374.1748; train_edge_recon_loss: 2642300.0458; train_gene_expr_recon_loss: 11757723.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27180.5245; train_chrom_access_recon_loss: 42858736.0305; train_global_loss: 57347314.5649; train_optim_loss: 57347314.5649; val_kl_reg_loss: 58141.5232; val_edge_recon_loss: 2673496.8500; val_gene_expr_recon_loss: 11906035.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27145.5625; val_chrom_access_recon_loss: 43521445.6000; val_global_loss: 58186265.6000; val_optim_loss: 58186265.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9885; val_auprc_score: 0.9839; val_best_acc_score: 0.9577; val_best_f1_score: 0.9587; train_kl_reg_loss: 61149.9697; train_edge_recon_loss: 2635883.8798; train_gene_expr_recon_loss: 11754317.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27115.6954; train_chrom_access_recon_loss: 42806807.6641; train_global_loss: 57285274.7176; train_optim_loss: 57285274.7176; val_kl_reg_loss: 58610.8310; val_edge_recon_loss: 2656011.1333; val_gene_expr_recon_loss: 11942482.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27080.2305; val_chrom_access_recon_loss: 43778708.2667; val_global_loss: 58462892.2667; val_optim_loss: 58462892.2667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9895; val_auprc_score: 0.9868; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 61082.4344; train_edge_recon_loss: 2645859.0821; train_gene_expr_recon_loss: 11751198.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27071.6908; train_chrom_access_recon_loss: 42776875.6336; train_global_loss: 57262087.5115; train_optim_loss: 57262087.5115; val_kl_reg_loss: 58498.3865; val_edge_recon_loss: 2673857.7667; val_gene_expr_recon_loss: 11942480.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27039.4219; val_chrom_access_recon_loss: 43771451.2000; val_global_loss: 58473326.4000; val_optim_loss: 58473326.4000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9880; val_auprc_score: 0.9798; val_best_acc_score: 0.9576; val_best_f1_score: 0.9586; train_kl_reg_loss: 60985.9835; train_edge_recon_loss: 2634375.2462; train_gene_expr_recon_loss: 11752075.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27013.7531; train_chrom_access_recon_loss: 42806358.9008; train_global_loss: 57280809.3130; train_optim_loss: 57280809.3130; val_kl_reg_loss: 57698.9628; val_edge_recon_loss: 2664497.7667; val_gene_expr_recon_loss: 11930668.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26987.3906; val_chrom_access_recon_loss: 43759070.6667; val_global_loss: 58438922.9333; val_optim_loss: 58438922.9333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9887; val_auprc_score: 0.9854; val_best_acc_score: 0.9613; val_best_f1_score: 0.9622; train_kl_reg_loss: 60713.2751; train_edge_recon_loss: 2637710.2844; train_gene_expr_recon_loss: 11753544.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26972.9379; train_chrom_access_recon_loss: 42812298.0763; train_global_loss: 57291238.9618; train_optim_loss: 57291238.9618; val_kl_reg_loss: 58407.0685; val_edge_recon_loss: 2660116.9667; val_gene_expr_recon_loss: 11946926.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26948.9570; val_chrom_access_recon_loss: 43688678.1333; val_global_loss: 58381077.6000; val_optim_loss: 58381077.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9914; val_auprc_score: 0.9898; val_best_acc_score: 0.9589; val_best_f1_score: 0.9599; train_kl_reg_loss: 60807.7038; train_edge_recon_loss: 2637532.3263; train_gene_expr_recon_loss: 11751899.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26671.8567; train_chrom_access_recon_loss: 42794327.7252; train_global_loss: 57271239.2977; train_optim_loss: 57271239.2977; val_kl_reg_loss: 58196.3758; val_edge_recon_loss: 2656689.6667; val_gene_expr_recon_loss: 11938927.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26641.4023; val_chrom_access_recon_loss: 43649401.0667; val_global_loss: 58329855.4667; val_optim_loss: 58329855.4667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9901; val_auprc_score: 0.9873; val_best_acc_score: 0.9603; val_best_f1_score: 0.9608; train_kl_reg_loss: 60787.9218; train_edge_recon_loss: 2645109.8721; train_gene_expr_recon_loss: 11755787.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26634.3533; train_chrom_access_recon_loss: 42812292.6412; train_global_loss: 57300612.4580; train_optim_loss: 57300612.4580; val_kl_reg_loss: 58064.1932; val_edge_recon_loss: 2642681.2000; val_gene_expr_recon_loss: 11943419.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26629.3770; val_chrom_access_recon_loss: 43667104.2667; val_global_loss: 58337898.6667; val_optim_loss: 58337898.6667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9899; val_auprc_score: 0.9861; val_best_acc_score: 0.9624; val_best_f1_score: 0.9632; train_kl_reg_loss: 60711.2192; train_edge_recon_loss: 2643546.0821; train_gene_expr_recon_loss: 11754043.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26624.1150; train_chrom_access_recon_loss: 42829794.6260; train_global_loss: 57314719.5420; train_optim_loss: 57314719.5420; val_kl_reg_loss: 58031.7922; val_edge_recon_loss: 2640155.6667; val_gene_expr_recon_loss: 11931113.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26620.2031; val_chrom_access_recon_loss: 43767545.6000; val_global_loss: 58423466.1333; val_optim_loss: 58423466.1333
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9893; val_auprc_score: 0.9859; val_best_acc_score: 0.9605; val_best_f1_score: 0.9614; train_kl_reg_loss: 60714.6744; train_edge_recon_loss: 2642783.3721; train_gene_expr_recon_loss: 11757269.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26615.1133; train_chrom_access_recon_loss: 42818283.3282; train_global_loss: 57305666.0458; train_optim_loss: 57305666.0458; val_kl_reg_loss: 57984.5083; val_edge_recon_loss: 2652202.9833; val_gene_expr_recon_loss: 11933295.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26612.1328; val_chrom_access_recon_loss: 43772940.8000; val_global_loss: 58443036.2667; val_optim_loss: 58443036.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 166 min 54 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9899
val AUPRC score: 0.9862
val best accuracy score: 0.9615
val best F1 score: 0.9622
val target rna MSE score: 1.1387
val source rna MSE score: 0.3529
val target atac MSE score: 0.1266
val source atac MSE score: 0.0207
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
