[True]
Run timestamp: 10082023_222347_76.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_76']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7904; val_auprc_score: 0.8073; val_best_acc_score: 0.6066; val_best_f1_score: 0.7092; train_kl_reg_loss: 340281.6541; train_edge_recon_loss: 3974132.9198; train_gene_expr_recon_loss: 48930161.4046; train_masked_gp_l1_reg_loss: 77563.6641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 248465.2773; train_chrom_access_recon_loss: 76833293.5573; train_global_loss: 130403898.4427; train_optim_loss: 130403898.4427; val_kl_reg_loss: 243446.5708; val_edge_recon_loss: 4059176.3500; val_gene_expr_recon_loss: 39007631.4667; val_masked_gp_l1_reg_loss: 74621.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 245986.7656; val_chrom_access_recon_loss: 70206946.6667; val_global_loss: 113837809.6000; val_optim_loss: 113837809.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8120; val_auprc_score: 0.8246; val_best_acc_score: 0.7253; val_best_f1_score: 0.7097; train_kl_reg_loss: 214672.5067; train_edge_recon_loss: 3923558.4561; train_gene_expr_recon_loss: 38866101.0382; train_masked_gp_l1_reg_loss: 73871.4657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 242112.1258; train_chrom_access_recon_loss: 69723470.8702; train_global_loss: 113043786.0153; train_optim_loss: 113043786.0153; val_kl_reg_loss: 206641.8844; val_edge_recon_loss: 4031615.9167; val_gene_expr_recon_loss: 37782683.2000; val_masked_gp_l1_reg_loss: 73930.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 237534.6719; val_chrom_access_recon_loss: 69719310.4000; val_global_loss: 112051720.5333; val_optim_loss: 112051720.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8111; val_auprc_score: 0.8189; val_best_acc_score: 0.7179; val_best_f1_score: 0.7421; train_kl_reg_loss: 198752.7799; train_edge_recon_loss: 3752948.5897; train_gene_expr_recon_loss: 38090536.7634; train_masked_gp_l1_reg_loss: 77064.6006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232345.9556; train_chrom_access_recon_loss: 69106088.8244; train_global_loss: 111457737.5878; train_optim_loss: 111457737.5878; val_kl_reg_loss: 226517.0344; val_edge_recon_loss: 3932881.0167; val_gene_expr_recon_loss: 37632597.8667; val_masked_gp_l1_reg_loss: 79834.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 226922.3594; val_chrom_access_recon_loss: 69716436.8000; val_global_loss: 111815193.6000; val_optim_loss: 111815193.6000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8691; val_auprc_score: 0.8688; val_best_acc_score: 0.7801; val_best_f1_score: 0.7936; train_kl_reg_loss: 210109.7844; train_edge_recon_loss: 3570424.3740; train_gene_expr_recon_loss: 37345817.7099; train_masked_gp_l1_reg_loss: 79689.4923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221365.0807; train_chrom_access_recon_loss: 68705727.4198; train_global_loss: 110133133.8015; train_optim_loss: 110133133.8015; val_kl_reg_loss: 214711.9469; val_edge_recon_loss: 3676066.4000; val_gene_expr_recon_loss: 36871719.7333; val_masked_gp_l1_reg_loss: 80067.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 215705.3906; val_chrom_access_recon_loss: 68463303.4667; val_global_loss: 109521573.3333; val_optim_loss: 109521573.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8984; val_auprc_score: 0.8913; val_best_acc_score: 0.8158; val_best_f1_score: 0.8214; train_kl_reg_loss: 194662.0880; train_edge_recon_loss: 3307105.3321; train_gene_expr_recon_loss: 36784542.8092; train_masked_gp_l1_reg_loss: 80735.0924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 210092.2278; train_chrom_access_recon_loss: 68091424.5496; train_global_loss: 108668562.5649; train_optim_loss: 108668562.5649; val_kl_reg_loss: 219710.0344; val_edge_recon_loss: 3149898.1333; val_gene_expr_recon_loss: 36538254.4000; val_masked_gp_l1_reg_loss: 81684.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 204489.9375; val_chrom_access_recon_loss: 67948849.0667; val_global_loss: 108142884.8000; val_optim_loss: 108142884.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9105; val_auprc_score: 0.8990; val_best_acc_score: 0.8336; val_best_f1_score: 0.8408; train_kl_reg_loss: 232503.0105; train_edge_recon_loss: 3060564.2615; train_gene_expr_recon_loss: 36463869.4962; train_masked_gp_l1_reg_loss: 82669.3462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199193.7320; train_chrom_access_recon_loss: 67614366.2901; train_global_loss: 107653166.5344; train_optim_loss: 107653166.5344; val_kl_reg_loss: 233171.4302; val_edge_recon_loss: 3030599.3667; val_gene_expr_recon_loss: 36460652.2667; val_masked_gp_l1_reg_loss: 83473.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193969.7812; val_chrom_access_recon_loss: 68054013.6000; val_global_loss: 108055876.8000; val_optim_loss: 108055876.8000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9169; val_auprc_score: 0.9069; val_best_acc_score: 0.8371; val_best_f1_score: 0.8506; train_kl_reg_loss: 236750.3037; train_edge_recon_loss: 2978282.3836; train_gene_expr_recon_loss: 36275902.9618; train_masked_gp_l1_reg_loss: 84394.5429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 189211.0889; train_chrom_access_recon_loss: 67424201.0382; train_global_loss: 107188742.1679; train_optim_loss: 107188742.1679; val_kl_reg_loss: 240134.3219; val_edge_recon_loss: 2979448.8667; val_gene_expr_recon_loss: 36109238.1333; val_masked_gp_l1_reg_loss: 85136.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 184553.3906; val_chrom_access_recon_loss: 67310956.0000; val_global_loss: 106909466.1333; val_optim_loss: 106909466.1333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9258; val_auprc_score: 0.9147; val_best_acc_score: 0.8499; val_best_f1_score: 0.8594; train_kl_reg_loss: 229429.0834; train_edge_recon_loss: 2945868.1450; train_gene_expr_recon_loss: 36068558.2595; train_masked_gp_l1_reg_loss: 86207.2288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180235.7402; train_chrom_access_recon_loss: 67081828.1832; train_global_loss: 106592126.8397; train_optim_loss: 106592126.8397; val_kl_reg_loss: 223487.1167; val_edge_recon_loss: 2935995.2500; val_gene_expr_recon_loss: 35970796.0000; val_masked_gp_l1_reg_loss: 86987.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175947.4062; val_chrom_access_recon_loss: 67291034.9333; val_global_loss: 106684249.6000; val_optim_loss: 106684249.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9253; val_auprc_score: 0.9141; val_best_acc_score: 0.8488; val_best_f1_score: 0.8569; train_kl_reg_loss: 220309.1289; train_edge_recon_loss: 2915359.7691; train_gene_expr_recon_loss: 35842080.5191; train_masked_gp_l1_reg_loss: 88061.3879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171900.7849; train_chrom_access_recon_loss: 66659916.2443; train_global_loss: 105897628.3969; train_optim_loss: 105897628.3969; val_kl_reg_loss: 218840.3823; val_edge_recon_loss: 2937320.7667; val_gene_expr_recon_loss: 35788207.7333; val_masked_gp_l1_reg_loss: 88901.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167820.0000; val_chrom_access_recon_loss: 67089697.8667; val_global_loss: 106290786.6667; val_optim_loss: 106290786.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9312; val_auprc_score: 0.9192; val_best_acc_score: 0.8610; val_best_f1_score: 0.8710; train_kl_reg_loss: 210580.2698; train_edge_recon_loss: 2904189.3473; train_gene_expr_recon_loss: 35671064.1221; train_masked_gp_l1_reg_loss: 89831.3080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163915.1920; train_chrom_access_recon_loss: 66383320.6718; train_global_loss: 105422900.7634; train_optim_loss: 105422900.7634; val_kl_reg_loss: 210638.1208; val_edge_recon_loss: 2926939.0500; val_gene_expr_recon_loss: 35610735.7333; val_masked_gp_l1_reg_loss: 90997.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159984.3594; val_chrom_access_recon_loss: 66523240.0000; val_global_loss: 105522533.8667; val_optim_loss: 105522533.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9418; val_auprc_score: 0.9327; val_best_acc_score: 0.8721; val_best_f1_score: 0.8807; train_kl_reg_loss: 203008.7493; train_edge_recon_loss: 2888814.5229; train_gene_expr_recon_loss: 35608123.4809; train_masked_gp_l1_reg_loss: 91987.1183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156352.5198; train_chrom_access_recon_loss: 66315980.3359; train_global_loss: 105264267.1145; train_optim_loss: 105264267.1145; val_kl_reg_loss: 202167.1552; val_edge_recon_loss: 2873530.9667; val_gene_expr_recon_loss: 35658540.8000; val_masked_gp_l1_reg_loss: 92705.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152709.2969; val_chrom_access_recon_loss: 66636898.1333; val_global_loss: 105616548.8000; val_optim_loss: 105616548.8000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9417; val_auprc_score: 0.9321; val_best_acc_score: 0.8762; val_best_f1_score: 0.8817; train_kl_reg_loss: 197555.0477; train_edge_recon_loss: 2873984.6603; train_gene_expr_recon_loss: 35381486.3206; train_masked_gp_l1_reg_loss: 93476.5330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149286.1214; train_chrom_access_recon_loss: 65835509.4046; train_global_loss: 104531297.6489; train_optim_loss: 104531297.6489; val_kl_reg_loss: 194353.2073; val_edge_recon_loss: 2890023.0167; val_gene_expr_recon_loss: 35522613.6000; val_masked_gp_l1_reg_loss: 94366.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145953.6406; val_chrom_access_recon_loss: 66218893.8667; val_global_loss: 105066203.7333; val_optim_loss: 105066203.7333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9438; val_auprc_score: 0.9339; val_best_acc_score: 0.8786; val_best_f1_score: 0.8844; train_kl_reg_loss: 190596.3820; train_edge_recon_loss: 2863940.7653; train_gene_expr_recon_loss: 35299542.9618; train_masked_gp_l1_reg_loss: 95160.0992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142816.4723; train_chrom_access_recon_loss: 65698008.7939; train_global_loss: 104290065.1603; train_optim_loss: 104290065.1603; val_kl_reg_loss: 186983.7646; val_edge_recon_loss: 2877216.5500; val_gene_expr_recon_loss: 35361841.6000; val_masked_gp_l1_reg_loss: 96230.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139816.7969; val_chrom_access_recon_loss: 65846663.7333; val_global_loss: 104508754.1333; val_optim_loss: 104508754.1333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9470; val_auprc_score: 0.9383; val_best_acc_score: 0.8810; val_best_f1_score: 0.8880; train_kl_reg_loss: 186978.8879; train_edge_recon_loss: 2845592.6164; train_gene_expr_recon_loss: 35149233.0534; train_masked_gp_l1_reg_loss: 96916.1693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137058.5662; train_chrom_access_recon_loss: 65369582.2595; train_global_loss: 103785361.3435; train_optim_loss: 103785361.3435; val_kl_reg_loss: 184280.1219; val_edge_recon_loss: 2853590.8500; val_gene_expr_recon_loss: 35022349.0667; val_masked_gp_l1_reg_loss: 97657.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134396.5156; val_chrom_access_recon_loss: 65045451.2000; val_global_loss: 103337722.6667; val_optim_loss: 103337722.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9518; val_auprc_score: 0.9437; val_best_acc_score: 0.8853; val_best_f1_score: 0.8903; train_kl_reg_loss: 180723.4604; train_edge_recon_loss: 2847467.8779; train_gene_expr_recon_loss: 35076260.0916; train_masked_gp_l1_reg_loss: 98566.4804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131906.1122; train_chrom_access_recon_loss: 65231101.9847; train_global_loss: 103566026.1985; train_optim_loss: 103566026.1985; val_kl_reg_loss: 179035.6906; val_edge_recon_loss: 2853639.6167; val_gene_expr_recon_loss: 35092236.5333; val_masked_gp_l1_reg_loss: 99639.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129598.1406; val_chrom_access_recon_loss: 65156762.4000; val_global_loss: 103510914.6667; val_optim_loss: 103510914.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9522; val_auprc_score: 0.9445; val_best_acc_score: 0.8879; val_best_f1_score: 0.8937; train_kl_reg_loss: 176241.1806; train_edge_recon_loss: 2839553.3454; train_gene_expr_recon_loss: 35005976.9618; train_masked_gp_l1_reg_loss: 100201.3922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127315.6116; train_chrom_access_recon_loss: 65104456.6107; train_global_loss: 103353745.5878; train_optim_loss: 103353745.5878; val_kl_reg_loss: 174770.4542; val_edge_recon_loss: 2855931.6333; val_gene_expr_recon_loss: 35103124.8000; val_masked_gp_l1_reg_loss: 100847.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125149.2891; val_chrom_access_recon_loss: 65306036.2667; val_global_loss: 103665857.6000; val_optim_loss: 103665857.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9544; val_auprc_score: 0.9465; val_best_acc_score: 0.8905; val_best_f1_score: 0.8963; train_kl_reg_loss: 172175.4389; train_edge_recon_loss: 2832861.8989; train_gene_expr_recon_loss: 34933989.1908; train_masked_gp_l1_reg_loss: 101738.0926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123034.7063; train_chrom_access_recon_loss: 64924825.9542; train_global_loss: 103088624.9771; train_optim_loss: 103088624.9771; val_kl_reg_loss: 170284.8875; val_edge_recon_loss: 2835958.6500; val_gene_expr_recon_loss: 35055336.0000; val_masked_gp_l1_reg_loss: 102355.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120839.6328; val_chrom_access_recon_loss: 65715694.4000; val_global_loss: 104000472.0000; val_optim_loss: 104000472.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9580; val_auprc_score: 0.9505; val_best_acc_score: 0.8954; val_best_f1_score: 0.9003; train_kl_reg_loss: 168298.3993; train_edge_recon_loss: 2820214.3836; train_gene_expr_recon_loss: 34848297.7405; train_masked_gp_l1_reg_loss: 103319.1226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118721.0963; train_chrom_access_recon_loss: 64845414.9008; train_global_loss: 102904265.9542; train_optim_loss: 102904265.9542; val_kl_reg_loss: 167130.2094; val_edge_recon_loss: 2810968.6500; val_gene_expr_recon_loss: 34865018.6667; val_masked_gp_l1_reg_loss: 104187.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116683.8984; val_chrom_access_recon_loss: 65233589.3333; val_global_loss: 103297578.1333; val_optim_loss: 103297578.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9582; val_auprc_score: 0.9504; val_best_acc_score: 0.8979; val_best_f1_score: 0.9017; train_kl_reg_loss: 165143.7343; train_edge_recon_loss: 2812095.2462; train_gene_expr_recon_loss: 34773423.3893; train_masked_gp_l1_reg_loss: 105063.2543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114613.4200; train_chrom_access_recon_loss: 64685076.5496; train_global_loss: 102655415.6336; train_optim_loss: 102655415.6336; val_kl_reg_loss: 164183.2115; val_edge_recon_loss: 2816848.1833; val_gene_expr_recon_loss: 34828167.2000; val_masked_gp_l1_reg_loss: 105734.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112554.0859; val_chrom_access_recon_loss: 65067127.2000; val_global_loss: 103094616.5333; val_optim_loss: 103094616.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9591; val_auprc_score: 0.9512; val_best_acc_score: 0.8983; val_best_f1_score: 0.9032; train_kl_reg_loss: 162345.5866; train_edge_recon_loss: 2803998.8588; train_gene_expr_recon_loss: 34726569.5420; train_masked_gp_l1_reg_loss: 106605.5399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110699.1709; train_chrom_access_recon_loss: 64705124.4885; train_global_loss: 102615343.0840; train_optim_loss: 102615343.0840; val_kl_reg_loss: 161886.6771; val_edge_recon_loss: 2816508.8167; val_gene_expr_recon_loss: 34932413.7333; val_masked_gp_l1_reg_loss: 107268.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108923.5312; val_chrom_access_recon_loss: 65049116.0000; val_global_loss: 103176117.8667; val_optim_loss: 103176117.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9616; val_auprc_score: 0.9524; val_best_acc_score: 0.9014; val_best_f1_score: 0.9048; train_kl_reg_loss: 159124.2395; train_edge_recon_loss: 2802972.1985; train_gene_expr_recon_loss: 34650359.4504; train_masked_gp_l1_reg_loss: 108238.8234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107152.1085; train_chrom_access_recon_loss: 64520248.8855; train_global_loss: 102348096.3053; train_optim_loss: 102348096.3053; val_kl_reg_loss: 158827.6948; val_edge_recon_loss: 2808436.3000; val_gene_expr_recon_loss: 34554208.8000; val_masked_gp_l1_reg_loss: 109151.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105416.8906; val_chrom_access_recon_loss: 64594912.5333; val_global_loss: 102330952.5333; val_optim_loss: 102330952.5333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9669; val_auprc_score: 0.9618; val_best_acc_score: 0.9111; val_best_f1_score: 0.9132; train_kl_reg_loss: 157538.1477; train_edge_recon_loss: 2790121.5076; train_gene_expr_recon_loss: 34517406.4885; train_masked_gp_l1_reg_loss: 110001.8012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103853.0661; train_chrom_access_recon_loss: 64288274.6870; train_global_loss: 101967195.7252; train_optim_loss: 101967195.7252; val_kl_reg_loss: 156692.8698; val_edge_recon_loss: 2793690.6333; val_gene_expr_recon_loss: 34481953.7333; val_masked_gp_l1_reg_loss: 110671.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102222.4844; val_chrom_access_recon_loss: 64446892.5333; val_global_loss: 102092125.3333; val_optim_loss: 102092125.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9670; val_auprc_score: 0.9608; val_best_acc_score: 0.9086; val_best_f1_score: 0.9114; train_kl_reg_loss: 153628.3089; train_edge_recon_loss: 2790616.5649; train_gene_expr_recon_loss: 34520176.8702; train_masked_gp_l1_reg_loss: 111563.3107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100724.9497; train_chrom_access_recon_loss: 64433923.8779; train_global_loss: 102110633.7099; train_optim_loss: 102110633.7099; val_kl_reg_loss: 154815.1448; val_edge_recon_loss: 2802642.9667; val_gene_expr_recon_loss: 34511281.4667; val_masked_gp_l1_reg_loss: 112288.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99260.1953; val_chrom_access_recon_loss: 64552168.8000; val_global_loss: 102232457.0667; val_optim_loss: 102232457.0667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9668; val_auprc_score: 0.9589; val_best_acc_score: 0.9101; val_best_f1_score: 0.9132; train_kl_reg_loss: 152651.0705; train_edge_recon_loss: 2779847.7443; train_gene_expr_recon_loss: 34416232.5649; train_masked_gp_l1_reg_loss: 113014.2720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97823.1039; train_chrom_access_recon_loss: 64101159.8168; train_global_loss: 101660728.4885; train_optim_loss: 101660728.4885; val_kl_reg_loss: 154751.5833; val_edge_recon_loss: 2804712.1667; val_gene_expr_recon_loss: 34429250.6667; val_masked_gp_l1_reg_loss: 113923.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96460.7578; val_chrom_access_recon_loss: 64409129.3333; val_global_loss: 102008227.7333; val_optim_loss: 102008227.7333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9664; val_auprc_score: 0.9595; val_best_acc_score: 0.9146; val_best_f1_score: 0.9164; train_kl_reg_loss: 151119.0947; train_edge_recon_loss: 2784690.5439; train_gene_expr_recon_loss: 34405310.1221; train_masked_gp_l1_reg_loss: 114555.5232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95125.2016; train_chrom_access_recon_loss: 64213257.1298; train_global_loss: 101764058.1374; train_optim_loss: 101764058.1374; val_kl_reg_loss: 150644.5469; val_edge_recon_loss: 2794346.5667; val_gene_expr_recon_loss: 34497859.8667; val_masked_gp_l1_reg_loss: 115421.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93833.5312; val_chrom_access_recon_loss: 64694243.7333; val_global_loss: 102346346.6667; val_optim_loss: 102346346.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9693; val_auprc_score: 0.9626; val_best_acc_score: 0.9119; val_best_f1_score: 0.9156; train_kl_reg_loss: 160385.2110; train_edge_recon_loss: 2846014.5172; train_gene_expr_recon_loss: 35554220.7176; train_masked_gp_l1_reg_loss: 113804.7842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93473.9794; train_chrom_access_recon_loss: 64724074.6565; train_global_loss: 103491973.8015; train_optim_loss: 103491973.8015; val_kl_reg_loss: 92120.8469; val_edge_recon_loss: 2827210.1167; val_gene_expr_recon_loss: 35468035.4667; val_masked_gp_l1_reg_loss: 113196.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92936.1875; val_chrom_access_recon_loss: 64926426.1333; val_global_loss: 103519923.7333; val_optim_loss: 103519923.7333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9712; val_auprc_score: 0.9670; val_best_acc_score: 0.9175; val_best_f1_score: 0.9196; train_kl_reg_loss: 156384.6713; train_edge_recon_loss: 2785861.5782; train_gene_expr_recon_loss: 35347497.8321; train_masked_gp_l1_reg_loss: 113064.0478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92040.9657; train_chrom_access_recon_loss: 64598757.6794; train_global_loss: 103093606.2290; train_optim_loss: 103093606.2290; val_kl_reg_loss: 98243.3958; val_edge_recon_loss: 2804993.6833; val_gene_expr_recon_loss: 35219442.6667; val_masked_gp_l1_reg_loss: 112912.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91122.9297; val_chrom_access_recon_loss: 64710413.0667; val_global_loss: 103037128.5333; val_optim_loss: 103037128.5333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9691; val_auprc_score: 0.9599; val_best_acc_score: 0.9212; val_best_f1_score: 0.9238; train_kl_reg_loss: 145608.0524; train_edge_recon_loss: 2775127.8664; train_gene_expr_recon_loss: 35295416.5802; train_masked_gp_l1_reg_loss: 112731.1992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90344.8591; train_chrom_access_recon_loss: 64508133.8321; train_global_loss: 102927362.1374; train_optim_loss: 102927362.1374; val_kl_reg_loss: 104470.4370; val_edge_recon_loss: 2779627.5333; val_gene_expr_recon_loss: 35284515.4667; val_masked_gp_l1_reg_loss: 112610.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89747.1719; val_chrom_access_recon_loss: 64614979.7333; val_global_loss: 102985954.1333; val_optim_loss: 102985954.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9696; val_auprc_score: 0.9639; val_best_acc_score: 0.9173; val_best_f1_score: 0.9204; train_kl_reg_loss: 142205.2945; train_edge_recon_loss: 2764044.7118; train_gene_expr_recon_loss: 35255797.9695; train_masked_gp_l1_reg_loss: 112229.9387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89384.2367; train_chrom_access_recon_loss: 64542502.3817; train_global_loss: 102906164.0916; train_optim_loss: 102906164.0916; val_kl_reg_loss: 106443.2307; val_edge_recon_loss: 2776870.9333; val_gene_expr_recon_loss: 35310314.9333; val_masked_gp_l1_reg_loss: 112082.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89079.1328; val_chrom_access_recon_loss: 64686116.0000; val_global_loss: 103080909.3333; val_optim_loss: 103080909.3333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9706; val_auprc_score: 0.9637; val_best_acc_score: 0.9200; val_best_f1_score: 0.9229; train_kl_reg_loss: 142204.2816; train_edge_recon_loss: 2771572.8760; train_gene_expr_recon_loss: 35215529.4046; train_masked_gp_l1_reg_loss: 112006.1740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88851.3237; train_chrom_access_recon_loss: 64425719.4198; train_global_loss: 102755883.4198; train_optim_loss: 102755883.4198; val_kl_reg_loss: 106708.5906; val_edge_recon_loss: 2771817.6667; val_gene_expr_recon_loss: 35239195.7333; val_masked_gp_l1_reg_loss: 111931.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88645.4688; val_chrom_access_recon_loss: 64621709.3333; val_global_loss: 102940006.9333; val_optim_loss: 102940006.9333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9696; val_auprc_score: 0.9618; val_best_acc_score: 0.9178; val_best_f1_score: 0.9211; train_kl_reg_loss: 141273.8370; train_edge_recon_loss: 2769754.7824; train_gene_expr_recon_loss: 35206051.6489; train_masked_gp_l1_reg_loss: 111875.7254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88477.4665; train_chrom_access_recon_loss: 64406048.1832; train_global_loss: 102723481.2824; train_optim_loss: 102723481.2824; val_kl_reg_loss: 107322.1245; val_edge_recon_loss: 2755212.9333; val_gene_expr_recon_loss: 35347805.0667; val_masked_gp_l1_reg_loss: 111814.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88305.0312; val_chrom_access_recon_loss: 64932801.3333; val_global_loss: 103343262.4000; val_optim_loss: 103343262.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9693; val_auprc_score: 0.9625; val_best_acc_score: 0.9154; val_best_f1_score: 0.9189; train_kl_reg_loss: 140545.4577; train_edge_recon_loss: 2762944.2118; train_gene_expr_recon_loss: 35229580.2137; train_masked_gp_l1_reg_loss: 111766.2691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88149.0650; train_chrom_access_recon_loss: 64538807.3282; train_global_loss: 102871792.3664; train_optim_loss: 102871792.3664; val_kl_reg_loss: 108168.0552; val_edge_recon_loss: 2785077.3333; val_gene_expr_recon_loss: 35324418.1333; val_masked_gp_l1_reg_loss: 111722.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88001.2969; val_chrom_access_recon_loss: 64935218.6667; val_global_loss: 103352605.8667; val_optim_loss: 103352605.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 57 min 36 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9668
val AUPRC score: 0.9618
val best accuracy score: 0.9100
val best F1 score: 0.9122
val target rna MSE score: 1.4165
val source rna MSE score: 307.6631
val target atac MSE score: 0.1281
val source atac MSE score: 0.9236
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
