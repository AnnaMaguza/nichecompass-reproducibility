[True]
Run timestamp: 10102023_065908_177.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_177']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7899; val_auprc_score: 0.8078; val_best_acc_score: 0.6144; val_best_f1_score: 0.7136; train_kl_reg_loss: 67997.0823; train_edge_recon_loss: 741563.0515; train_gene_expr_recon_loss: 22010206.9771; train_masked_gp_l1_reg_loss: 42977.7395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2860015.6555; train_chrom_access_recon_loss: 952780.3693; train_global_loss: 26675540.9466; train_optim_loss: 26675540.9466; val_kl_reg_loss: 80466.8724; val_edge_recon_loss: 811777.6167; val_gene_expr_recon_loss: 20851323.2000; val_masked_gp_l1_reg_loss: 47386.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1040634.0000; val_chrom_access_recon_loss: 904286.3458; val_global_loss: 23735874.0000; val_optim_loss: 23735874.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8727; val_auprc_score: 0.8792; val_best_acc_score: 0.7688; val_best_f1_score: 0.7722; train_kl_reg_loss: 67827.9969; train_edge_recon_loss: 728733.2395; train_gene_expr_recon_loss: 20882207.4198; train_masked_gp_l1_reg_loss: 48633.5887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 556288.5441; train_chrom_access_recon_loss: 918574.9175; train_global_loss: 23202265.7710; train_optim_loss: 23202265.7710; val_kl_reg_loss: 78144.2172; val_edge_recon_loss: 788179.4833; val_gene_expr_recon_loss: 20611737.6000; val_masked_gp_l1_reg_loss: 50133.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 307222.7188; val_chrom_access_recon_loss: 890660.0250; val_global_loss: 22726077.2000; val_optim_loss: 22726077.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9124; val_auprc_score: 0.9005; val_best_acc_score: 0.8386; val_best_f1_score: 0.8460; train_kl_reg_loss: 60652.4988; train_edge_recon_loss: 689258.9766; train_gene_expr_recon_loss: 20577652.3817; train_masked_gp_l1_reg_loss: 51793.5259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241291.2314; train_chrom_access_recon_loss: 909704.8559; train_global_loss: 22530353.2824; train_optim_loss: 22530353.2824; val_kl_reg_loss: 68512.5526; val_edge_recon_loss: 647124.6333; val_gene_expr_recon_loss: 20274783.6000; val_masked_gp_l1_reg_loss: 53425.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 195521.7812; val_chrom_access_recon_loss: 880686.7500; val_global_loss: 22120055.3333; val_optim_loss: 22120055.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9263; val_auprc_score: 0.9145; val_best_acc_score: 0.8553; val_best_f1_score: 0.8629; train_kl_reg_loss: 70526.1022; train_edge_recon_loss: 619640.5539; train_gene_expr_recon_loss: 20339025.5115; train_masked_gp_l1_reg_loss: 55257.7546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167066.6139; train_chrom_access_recon_loss: 899749.0434; train_global_loss: 22151265.5878; train_optim_loss: 22151265.5878; val_kl_reg_loss: 69550.8547; val_edge_recon_loss: 618090.7292; val_gene_expr_recon_loss: 19995372.2667; val_masked_gp_l1_reg_loss: 56945.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144421.0781; val_chrom_access_recon_loss: 873277.6958; val_global_loss: 21757659.6000; val_optim_loss: 21757659.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9402; val_auprc_score: 0.9307; val_best_acc_score: 0.8685; val_best_f1_score: 0.8723; train_kl_reg_loss: 68358.4857; train_edge_recon_loss: 606835.8531; train_gene_expr_recon_loss: 20152201.8779; train_masked_gp_l1_reg_loss: 58079.9178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133754.4242; train_chrom_access_recon_loss: 892770.0997; train_global_loss: 21912000.6718; train_optim_loss: 21912000.6718; val_kl_reg_loss: 66799.8714; val_edge_recon_loss: 605840.7125; val_gene_expr_recon_loss: 19884074.8000; val_masked_gp_l1_reg_loss: 59291.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126950.3516; val_chrom_access_recon_loss: 867415.3208; val_global_loss: 21610373.0667; val_optim_loss: 21610373.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9402; val_auprc_score: 0.9272; val_best_acc_score: 0.8773; val_best_f1_score: 0.8835; train_kl_reg_loss: 64665.9051; train_edge_recon_loss: 599394.1183; train_gene_expr_recon_loss: 19985127.7557; train_masked_gp_l1_reg_loss: 60264.8981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119036.2732; train_chrom_access_recon_loss: 885699.6021; train_global_loss: 21714188.6107; train_optim_loss: 21714188.6107; val_kl_reg_loss: 64843.7714; val_edge_recon_loss: 596705.0833; val_gene_expr_recon_loss: 19725993.2000; val_masked_gp_l1_reg_loss: 61219.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113283.2500; val_chrom_access_recon_loss: 867403.5750; val_global_loss: 21429449.4667; val_optim_loss: 21429449.4667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9369; val_auprc_score: 0.9270; val_best_acc_score: 0.8638; val_best_f1_score: 0.8706; train_kl_reg_loss: 61853.3929; train_edge_recon_loss: 598840.8216; train_gene_expr_recon_loss: 19889924.7176; train_masked_gp_l1_reg_loss: 61669.6221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107787.4626; train_chrom_access_recon_loss: 881699.3607; train_global_loss: 21601775.2977; train_optim_loss: 21601775.2977; val_kl_reg_loss: 68826.7104; val_edge_recon_loss: 599983.9917; val_gene_expr_recon_loss: 19691230.6667; val_masked_gp_l1_reg_loss: 61933.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104664.9688; val_chrom_access_recon_loss: 868164.2000; val_global_loss: 21394803.0667; val_optim_loss: 21394803.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9483; val_auprc_score: 0.9394; val_best_acc_score: 0.8816; val_best_f1_score: 0.8866; train_kl_reg_loss: 61537.1534; train_edge_recon_loss: 595334.5806; train_gene_expr_recon_loss: 19759414.5344; train_masked_gp_l1_reg_loss: 62340.9611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102645.7461; train_chrom_access_recon_loss: 877210.9556; train_global_loss: 21458484.0153; train_optim_loss: 21458484.0153; val_kl_reg_loss: 60570.4018; val_edge_recon_loss: 593812.8208; val_gene_expr_recon_loss: 19582040.1333; val_masked_gp_l1_reg_loss: 63034.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99500.7109; val_chrom_access_recon_loss: 856349.2208; val_global_loss: 21255306.5333; val_optim_loss: 21255306.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9510; val_auprc_score: 0.9412; val_best_acc_score: 0.8876; val_best_f1_score: 0.8929; train_kl_reg_loss: 60566.4991; train_edge_recon_loss: 588194.7037; train_gene_expr_recon_loss: 19645871.6031; train_masked_gp_l1_reg_loss: 63551.4931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97611.4040; train_chrom_access_recon_loss: 871548.2428; train_global_loss: 21327343.8015; train_optim_loss: 21327343.8015; val_kl_reg_loss: 58166.3758; val_edge_recon_loss: 591102.9875; val_gene_expr_recon_loss: 19401685.6000; val_masked_gp_l1_reg_loss: 63963.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97543.9453; val_chrom_access_recon_loss: 850550.1208; val_global_loss: 21063012.8000; val_optim_loss: 21063012.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9566; val_auprc_score: 0.9437; val_best_acc_score: 0.8972; val_best_f1_score: 0.9015; train_kl_reg_loss: 58693.8190; train_edge_recon_loss: 585932.2886; train_gene_expr_recon_loss: 19540143.3435; train_masked_gp_l1_reg_loss: 64558.7639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94545.6127; train_chrom_access_recon_loss: 866326.9499; train_global_loss: 21210200.6260; train_optim_loss: 21210200.6260; val_kl_reg_loss: 57379.0570; val_edge_recon_loss: 586569.9500; val_gene_expr_recon_loss: 19260058.2667; val_masked_gp_l1_reg_loss: 65013.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93086.6875; val_chrom_access_recon_loss: 844621.8958; val_global_loss: 20906729.3333; val_optim_loss: 20906729.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9574; val_auprc_score: 0.9472; val_best_acc_score: 0.8956; val_best_f1_score: 0.8999; train_kl_reg_loss: 57411.4188; train_edge_recon_loss: 583921.3225; train_gene_expr_recon_loss: 19447985.8015; train_masked_gp_l1_reg_loss: 65462.9801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92424.8939; train_chrom_access_recon_loss: 862815.2677; train_global_loss: 21110021.6489; train_optim_loss: 21110021.6489; val_kl_reg_loss: 57632.6000; val_edge_recon_loss: 584289.7000; val_gene_expr_recon_loss: 19226376.2667; val_masked_gp_l1_reg_loss: 65954.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91850.9922; val_chrom_access_recon_loss: 837837.1708; val_global_loss: 20863939.6000; val_optim_loss: 20863939.6000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9620; val_auprc_score: 0.9542; val_best_acc_score: 0.9018; val_best_f1_score: 0.9051; train_kl_reg_loss: 56369.7724; train_edge_recon_loss: 582153.9804; train_gene_expr_recon_loss: 19381091.5420; train_masked_gp_l1_reg_loss: 66336.0168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90665.1980; train_chrom_access_recon_loss: 859775.9833; train_global_loss: 21036392.5649; train_optim_loss: 21036392.5649; val_kl_reg_loss: 54587.7146; val_edge_recon_loss: 581223.6292; val_gene_expr_recon_loss: 19165301.6000; val_masked_gp_l1_reg_loss: 66792.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90730.3594; val_chrom_access_recon_loss: 836010.1000; val_global_loss: 20794645.2000; val_optim_loss: 20794645.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9611; val_auprc_score: 0.9492; val_best_acc_score: 0.9072; val_best_f1_score: 0.9101; train_kl_reg_loss: 55556.2645; train_edge_recon_loss: 579512.3087; train_gene_expr_recon_loss: 19267486.3053; train_masked_gp_l1_reg_loss: 67140.6266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89375.5310; train_chrom_access_recon_loss: 855394.6345; train_global_loss: 20914465.8626; train_optim_loss: 20914465.8626; val_kl_reg_loss: 53267.9690; val_edge_recon_loss: 582400.1625; val_gene_expr_recon_loss: 19135005.8667; val_masked_gp_l1_reg_loss: 67479.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90005.7656; val_chrom_access_recon_loss: 834982.8708; val_global_loss: 20763142.6667; val_optim_loss: 20763142.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9649; val_auprc_score: 0.9550; val_best_acc_score: 0.9153; val_best_f1_score: 0.9169; train_kl_reg_loss: 54672.7825; train_edge_recon_loss: 578718.6345; train_gene_expr_recon_loss: 19217503.2214; train_masked_gp_l1_reg_loss: 67967.2096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88516.9787; train_chrom_access_recon_loss: 852241.7781; train_global_loss: 20859620.5496; train_optim_loss: 20859620.5496; val_kl_reg_loss: 53172.3424; val_edge_recon_loss: 579308.7125; val_gene_expr_recon_loss: 19028712.4000; val_masked_gp_l1_reg_loss: 68327.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87500.8672; val_chrom_access_recon_loss: 832316.8542; val_global_loss: 20649338.5333; val_optim_loss: 20649338.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9643; val_auprc_score: 0.9560; val_best_acc_score: 0.9076; val_best_f1_score: 0.9094; train_kl_reg_loss: 53704.0268; train_edge_recon_loss: 577260.1722; train_gene_expr_recon_loss: 19159378.3511; train_masked_gp_l1_reg_loss: 68827.3895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87261.8095; train_chrom_access_recon_loss: 850225.0668; train_global_loss: 20796656.7786; train_optim_loss: 20796656.7786; val_kl_reg_loss: 53016.4797; val_edge_recon_loss: 576867.1333; val_gene_expr_recon_loss: 18880318.8000; val_masked_gp_l1_reg_loss: 69183.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86597.4219; val_chrom_access_recon_loss: 825809.8333; val_global_loss: 20491794.2667; val_optim_loss: 20491794.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9655; val_auprc_score: 0.9572; val_best_acc_score: 0.9138; val_best_f1_score: 0.9162; train_kl_reg_loss: 53297.7086; train_edge_recon_loss: 574586.5539; train_gene_expr_recon_loss: 19060907.8931; train_masked_gp_l1_reg_loss: 69767.0302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86062.7106; train_chrom_access_recon_loss: 846520.7643; train_global_loss: 20691142.9313; train_optim_loss: 20691142.9313; val_kl_reg_loss: 52944.8107; val_edge_recon_loss: 578390.7750; val_gene_expr_recon_loss: 18904794.2667; val_masked_gp_l1_reg_loss: 70144.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85983.6172; val_chrom_access_recon_loss: 829541.6125; val_global_loss: 20521799.3333; val_optim_loss: 20521799.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9669; val_auprc_score: 0.9588; val_best_acc_score: 0.9139; val_best_f1_score: 0.9167; train_kl_reg_loss: 52449.6016; train_edge_recon_loss: 574223.2672; train_gene_expr_recon_loss: 19023724.8092; train_masked_gp_l1_reg_loss: 70811.3254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85128.7059; train_chrom_access_recon_loss: 844748.3306; train_global_loss: 20651085.9389; train_optim_loss: 20651085.9389; val_kl_reg_loss: 51034.7086; val_edge_recon_loss: 574999.4042; val_gene_expr_recon_loss: 18839142.6667; val_masked_gp_l1_reg_loss: 71418.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84915.2734; val_chrom_access_recon_loss: 825178.2833; val_global_loss: 20446689.2000; val_optim_loss: 20446689.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9718; val_auprc_score: 0.9637; val_best_acc_score: 0.9267; val_best_f1_score: 0.9288; train_kl_reg_loss: 51806.5065; train_edge_recon_loss: 572476.0453; train_gene_expr_recon_loss: 18970415.7710; train_masked_gp_l1_reg_loss: 72001.0001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84658.4710; train_chrom_access_recon_loss: 843455.5778; train_global_loss: 20594813.4504; train_optim_loss: 20594813.4504; val_kl_reg_loss: 49846.4909; val_edge_recon_loss: 572094.0583; val_gene_expr_recon_loss: 18783822.4000; val_masked_gp_l1_reg_loss: 72620.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83883.2812; val_chrom_access_recon_loss: 818339.0333; val_global_loss: 20380605.6000; val_optim_loss: 20380605.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9669; val_auprc_score: 0.9557; val_best_acc_score: 0.9162; val_best_f1_score: 0.9190; train_kl_reg_loss: 51654.7480; train_edge_recon_loss: 571348.9599; train_gene_expr_recon_loss: 18903808.7481; train_masked_gp_l1_reg_loss: 73296.9538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84144.8651; train_chrom_access_recon_loss: 840379.2968; train_global_loss: 20524633.4198; train_optim_loss: 20524633.4198; val_kl_reg_loss: 50877.5604; val_edge_recon_loss: 576127.5542; val_gene_expr_recon_loss: 18737110.9333; val_masked_gp_l1_reg_loss: 73895.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84451.0625; val_chrom_access_recon_loss: 820555.2458; val_global_loss: 20343019.2000; val_optim_loss: 20343019.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9718; val_auprc_score: 0.9656; val_best_acc_score: 0.9225; val_best_f1_score: 0.9250; train_kl_reg_loss: 50766.7083; train_edge_recon_loss: 571190.8001; train_gene_expr_recon_loss: 18842321.1145; train_masked_gp_l1_reg_loss: 74673.8086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83758.9558; train_chrom_access_recon_loss: 839349.4337; train_global_loss: 20462060.9160; train_optim_loss: 20462060.9160; val_kl_reg_loss: 49585.6047; val_edge_recon_loss: 572811.6208; val_gene_expr_recon_loss: 18719993.8667; val_masked_gp_l1_reg_loss: 75386.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84047.2266; val_chrom_access_recon_loss: 820803.4417; val_global_loss: 20322628.4000; val_optim_loss: 20322628.4000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9712; val_auprc_score: 0.9627; val_best_acc_score: 0.9241; val_best_f1_score: 0.9264; train_kl_reg_loss: 50423.0311; train_edge_recon_loss: 570752.2753; train_gene_expr_recon_loss: 18786606.9008; train_masked_gp_l1_reg_loss: 76079.8559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84022.5091; train_chrom_access_recon_loss: 837589.4394; train_global_loss: 20405474.0458; train_optim_loss: 20405474.0458; val_kl_reg_loss: 49407.1328; val_edge_recon_loss: 573679.7500; val_gene_expr_recon_loss: 18586743.0667; val_masked_gp_l1_reg_loss: 76792.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84189.7344; val_chrom_access_recon_loss: 814796.1667; val_global_loss: 20185608.0000; val_optim_loss: 20185608.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9712; val_auprc_score: 0.9647; val_best_acc_score: 0.9229; val_best_f1_score: 0.9256; train_kl_reg_loss: 50055.1387; train_edge_recon_loss: 570005.7610; train_gene_expr_recon_loss: 18722858.8550; train_masked_gp_l1_reg_loss: 77520.6323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84362.3768; train_chrom_access_recon_loss: 835982.8111; train_global_loss: 20340785.5267; train_optim_loss: 20340785.5267; val_kl_reg_loss: 50121.0596; val_edge_recon_loss: 572897.8792; val_gene_expr_recon_loss: 18637880.1333; val_masked_gp_l1_reg_loss: 78123.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84341.4453; val_chrom_access_recon_loss: 818595.7833; val_global_loss: 20241960.4000; val_optim_loss: 20241960.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9717; val_auprc_score: 0.9646; val_best_acc_score: 0.9217; val_best_f1_score: 0.9230; train_kl_reg_loss: 50029.4958; train_edge_recon_loss: 570648.0339; train_gene_expr_recon_loss: 18667885.1298; train_masked_gp_l1_reg_loss: 78735.7038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84699.9829; train_chrom_access_recon_loss: 834425.5997; train_global_loss: 20286424.1069; train_optim_loss: 20286424.1069; val_kl_reg_loss: 49526.7513; val_edge_recon_loss: 572512.1917; val_gene_expr_recon_loss: 18502637.0667; val_masked_gp_l1_reg_loss: 79285.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85267.1172; val_chrom_access_recon_loss: 812615.3875; val_global_loss: 20101845.3333; val_optim_loss: 20101845.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9705; val_auprc_score: 0.9612; val_best_acc_score: 0.9232; val_best_f1_score: 0.9257; train_kl_reg_loss: 49544.7691; train_edge_recon_loss: 571454.1384; train_gene_expr_recon_loss: 18603738.3511; train_masked_gp_l1_reg_loss: 79891.4253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85153.7683; train_chrom_access_recon_loss: 832343.1684; train_global_loss: 20222125.7557; train_optim_loss: 20222125.7557; val_kl_reg_loss: 48509.0896; val_edge_recon_loss: 571085.4833; val_gene_expr_recon_loss: 18546596.9333; val_masked_gp_l1_reg_loss: 80430.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85350.2969; val_chrom_access_recon_loss: 817449.7792; val_global_loss: 20149420.8000; val_optim_loss: 20149420.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9677; val_auprc_score: 0.9572; val_best_acc_score: 0.9210; val_best_f1_score: 0.9234; train_kl_reg_loss: 50141.4552; train_edge_recon_loss: 568475.8058; train_gene_expr_recon_loss: 18567080.5191; train_masked_gp_l1_reg_loss: 80973.1390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85612.3324; train_chrom_access_recon_loss: 831475.5477; train_global_loss: 20183758.7481; train_optim_loss: 20183758.7481; val_kl_reg_loss: 49873.6880; val_edge_recon_loss: 572058.6583; val_gene_expr_recon_loss: 18501078.8000; val_masked_gp_l1_reg_loss: 81423.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86846.3906; val_chrom_access_recon_loss: 814772.8500; val_global_loss: 20106054.2667; val_optim_loss: 20106054.2667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9699; val_auprc_score: 0.9614; val_best_acc_score: 0.9196; val_best_f1_score: 0.9225; train_kl_reg_loss: 50041.9486; train_edge_recon_loss: 568502.4132; train_gene_expr_recon_loss: 18482919.7099; train_masked_gp_l1_reg_loss: 81979.5865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86882.7421; train_chrom_access_recon_loss: 829608.9919; train_global_loss: 20099935.4809; train_optim_loss: 20099935.4809; val_kl_reg_loss: 49392.9161; val_edge_recon_loss: 574560.2375; val_gene_expr_recon_loss: 18445589.7333; val_masked_gp_l1_reg_loss: 82554.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86837.6875; val_chrom_access_recon_loss: 811905.7833; val_global_loss: 20050840.8000; val_optim_loss: 20050840.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9668; val_auprc_score: 0.9569; val_best_acc_score: 0.9174; val_best_f1_score: 0.9202; train_kl_reg_loss: 49924.0216; train_edge_recon_loss: 570009.7500; train_gene_expr_recon_loss: 18440744.3969; train_masked_gp_l1_reg_loss: 83030.6864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87421.8547; train_chrom_access_recon_loss: 828870.0110; train_global_loss: 20060000.6260; train_optim_loss: 20060000.6260; val_kl_reg_loss: 49610.3549; val_edge_recon_loss: 575233.2583; val_gene_expr_recon_loss: 18429664.6667; val_masked_gp_l1_reg_loss: 83438.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88212.4531; val_chrom_access_recon_loss: 812115.3958; val_global_loss: 20038273.4667; val_optim_loss: 20038273.4667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9668; val_auprc_score: 0.9572; val_best_acc_score: 0.9182; val_best_f1_score: 0.9221; train_kl_reg_loss: 49900.9936; train_edge_recon_loss: 571245.3287; train_gene_expr_recon_loss: 18414574.4809; train_masked_gp_l1_reg_loss: 83739.4402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88278.0738; train_chrom_access_recon_loss: 829065.5429; train_global_loss: 20036803.9389; train_optim_loss: 20036803.9389; val_kl_reg_loss: 49042.4997; val_edge_recon_loss: 575373.7875; val_gene_expr_recon_loss: 18351545.7333; val_masked_gp_l1_reg_loss: 84105.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88265.7500; val_chrom_access_recon_loss: 813194.8750; val_global_loss: 19961529.0667; val_optim_loss: 19961529.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9639; val_auprc_score: 0.9522; val_best_acc_score: 0.9138; val_best_f1_score: 0.9158; train_kl_reg_loss: 50585.1334; train_edge_recon_loss: 571329.8564; train_gene_expr_recon_loss: 18371716.3359; train_masked_gp_l1_reg_loss: 84369.1059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88888.8146; train_chrom_access_recon_loss: 828462.4871; train_global_loss: 19995351.7099; train_optim_loss: 19995351.7099; val_kl_reg_loss: 49892.9339; val_edge_recon_loss: 577328.3292; val_gene_expr_recon_loss: 18291565.8667; val_masked_gp_l1_reg_loss: 84674.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90445.5469; val_chrom_access_recon_loss: 807513.5583; val_global_loss: 19901420.5333; val_optim_loss: 19901420.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9687; val_auprc_score: 0.9575; val_best_acc_score: 0.9182; val_best_f1_score: 0.9212; train_kl_reg_loss: 50806.9022; train_edge_recon_loss: 571344.1226; train_gene_expr_recon_loss: 18326533.0534; train_masked_gp_l1_reg_loss: 85009.0243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89596.0912; train_chrom_access_recon_loss: 827436.1636; train_global_loss: 19950725.1603; train_optim_loss: 19950725.1603; val_kl_reg_loss: 50515.2979; val_edge_recon_loss: 574055.2750; val_gene_expr_recon_loss: 18261307.4667; val_masked_gp_l1_reg_loss: 85259.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90859.4453; val_chrom_access_recon_loss: 807214.5917; val_global_loss: 19869212.5333; val_optim_loss: 19869212.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9662; val_auprc_score: 0.9567; val_best_acc_score: 0.9153; val_best_f1_score: 0.9184; train_kl_reg_loss: 51020.1919; train_edge_recon_loss: 571967.7223; train_gene_expr_recon_loss: 18272368.1069; train_masked_gp_l1_reg_loss: 85658.8228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90275.1448; train_chrom_access_recon_loss: 825783.0716; train_global_loss: 19897072.7786; train_optim_loss: 19897072.7786; val_kl_reg_loss: 51051.0755; val_edge_recon_loss: 578428.1417; val_gene_expr_recon_loss: 18234595.4667; val_masked_gp_l1_reg_loss: 86029.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90384.8672; val_chrom_access_recon_loss: 806302.3417; val_global_loss: 19846791.3333; val_optim_loss: 19846791.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9635; val_auprc_score: 0.9525; val_best_acc_score: 0.9126; val_best_f1_score: 0.9170; train_kl_reg_loss: 51744.4612; train_edge_recon_loss: 571286.9523; train_gene_expr_recon_loss: 18224274.5954; train_masked_gp_l1_reg_loss: 86336.8863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90251.2532; train_chrom_access_recon_loss: 824199.3779; train_global_loss: 19848093.6489; train_optim_loss: 19848093.6489; val_kl_reg_loss: 51928.4156; val_edge_recon_loss: 576109.0250; val_gene_expr_recon_loss: 18304803.6000; val_masked_gp_l1_reg_loss: 86283.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90575.2266; val_chrom_access_recon_loss: 810893.8250; val_global_loss: 19920594.9333; val_optim_loss: 19920594.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9365; val_auprc_score: 0.9277; val_best_acc_score: 0.8611; val_best_f1_score: 0.8717; train_kl_reg_loss: 97625.1853; train_edge_recon_loss: 679565.2452; train_gene_expr_recon_loss: 19522629.1450; train_masked_gp_l1_reg_loss: 88319.9272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137975.4778; train_chrom_access_recon_loss: 860436.7958; train_global_loss: 21386551.7252; train_optim_loss: 21386551.7252; val_kl_reg_loss: 58706.4500; val_edge_recon_loss: 693663.3417; val_gene_expr_recon_loss: 18682840.1333; val_masked_gp_l1_reg_loss: 84043.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120622.4297; val_chrom_access_recon_loss: 812554.2792; val_global_loss: 20452430.0000; val_optim_loss: 20452430.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9431; val_auprc_score: 0.9304; val_best_acc_score: 0.8789; val_best_f1_score: 0.8847; train_kl_reg_loss: 45562.8443; train_edge_recon_loss: 630480.7028; train_gene_expr_recon_loss: 18827738.5038; train_masked_gp_l1_reg_loss: 81394.3399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108285.5871; train_chrom_access_recon_loss: 831664.3635; train_global_loss: 20525126.1985; train_optim_loss: 20525126.1985; val_kl_reg_loss: 71989.0536; val_edge_recon_loss: 695503.5792; val_gene_expr_recon_loss: 18706603.7333; val_masked_gp_l1_reg_loss: 79566.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104373.3203; val_chrom_access_recon_loss: 812963.5500; val_global_loss: 20470999.8667; val_optim_loss: 20470999.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9435; val_auprc_score: 0.9293; val_best_acc_score: 0.8781; val_best_f1_score: 0.8830; train_kl_reg_loss: 55012.6811; train_edge_recon_loss: 620640.1913; train_gene_expr_recon_loss: 18779540.5344; train_masked_gp_l1_reg_loss: 77349.2987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99178.5203; train_chrom_access_recon_loss: 829923.3779; train_global_loss: 20461644.5496; train_optim_loss: 20461644.5496; val_kl_reg_loss: 52107.6193; val_edge_recon_loss: 594847.2375; val_gene_expr_recon_loss: 18520680.4000; val_masked_gp_l1_reg_loss: 75773.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96072.2656; val_chrom_access_recon_loss: 804726.4292; val_global_loss: 20144207.2000; val_optim_loss: 20144207.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9460; val_auprc_score: 0.9340; val_best_acc_score: 0.8798; val_best_f1_score: 0.8858; train_kl_reg_loss: 52502.3414; train_edge_recon_loss: 592496.2696; train_gene_expr_recon_loss: 18721121.7252; train_masked_gp_l1_reg_loss: 74936.0686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70482.8757; train_chrom_access_recon_loss: 827859.1531; train_global_loss: 20339398.4733; train_optim_loss: 20339398.4733; val_kl_reg_loss: 51805.3229; val_edge_recon_loss: 593202.3708; val_gene_expr_recon_loss: 18495218.0000; val_masked_gp_l1_reg_loss: 74549.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65818.4453; val_chrom_access_recon_loss: 804172.4292; val_global_loss: 20084766.4000; val_optim_loss: 20084766.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9423; val_auprc_score: 0.9291; val_best_acc_score: 0.8747; val_best_f1_score: 0.8817; train_kl_reg_loss: 52625.2510; train_edge_recon_loss: 588052.1751; train_gene_expr_recon_loss: 18676915.6183; train_masked_gp_l1_reg_loss: 74483.5756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65224.0230; train_chrom_access_recon_loss: 826579.2514; train_global_loss: 20283879.8473; train_optim_loss: 20283879.8473; val_kl_reg_loss: 52082.0466; val_edge_recon_loss: 591559.5167; val_gene_expr_recon_loss: 18593318.6667; val_masked_gp_l1_reg_loss: 74469.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64823.3320; val_chrom_access_recon_loss: 811945.6917; val_global_loss: 20188200.1333; val_optim_loss: 20188200.1333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9455; val_auprc_score: 0.9322; val_best_acc_score: 0.8800; val_best_f1_score: 0.8862; train_kl_reg_loss: 52662.2560; train_edge_recon_loss: 587366.3511; train_gene_expr_recon_loss: 18684444.5496; train_masked_gp_l1_reg_loss: 74472.6429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64512.5869; train_chrom_access_recon_loss: 827425.5658; train_global_loss: 20290884.0305; train_optim_loss: 20290884.0305; val_kl_reg_loss: 52605.4794; val_edge_recon_loss: 587702.9667; val_gene_expr_recon_loss: 18581090.6667; val_masked_gp_l1_reg_loss: 74499.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64261.0742; val_chrom_access_recon_loss: 809711.5667; val_global_loss: 20169872.6667; val_optim_loss: 20169872.6667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9454; val_auprc_score: 0.9332; val_best_acc_score: 0.8777; val_best_f1_score: 0.8820; train_kl_reg_loss: 53510.8422; train_edge_recon_loss: 587860.1503; train_gene_expr_recon_loss: 18665507.0076; train_masked_gp_l1_reg_loss: 74453.1517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63910.5827; train_chrom_access_recon_loss: 826478.1174; train_global_loss: 20271719.7099; train_optim_loss: 20271719.7099; val_kl_reg_loss: 53498.8122; val_edge_recon_loss: 590131.0875; val_gene_expr_recon_loss: 18494344.2667; val_masked_gp_l1_reg_loss: 74384.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63776.5586; val_chrom_access_recon_loss: 811279.1125; val_global_loss: 20087413.6000; val_optim_loss: 20087413.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 28 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9660
val AUPRC score: 0.9541
val best accuracy score: 0.9184
val best F1 score: 0.9215
val target rna MSE score: 1.1103
val source rna MSE score: 0.3878
val target atac MSE score: 0.4858
val source atac MSE score: 0.1457
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
