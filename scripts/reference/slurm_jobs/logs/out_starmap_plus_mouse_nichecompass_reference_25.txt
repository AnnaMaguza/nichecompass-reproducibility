[True]
Run timestamp: 31012024_223007_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse', '--reference_batches', 'batch10', 'batch15', 'batch21', 'batch22', 'batch23', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'dataset', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '50', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '3000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch21...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch22...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch23...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 931, n_cat_covariates_embed_input: 0, n_hidden: 931, n_latent: 1412, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1412, n_addon_gp_input: 10, n_cat_covariates_embed_input: 50, n_output: 931
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1412, n_addon_gp_input: 10, n_cat_covariates_embed_input: 50, n_output: 931

--- INITIALIZING TRAINER ---
Number of training nodes: 115396
Number of validation nodes: 12822
Number of training edges: 529798
Number of validation edges: 58866
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9768; val_auprc_score: 0.9810; val_best_acc_score: 0.9370; val_best_f1_score: 0.9484; train_kl_reg_loss: 5312.3897; train_edge_recon_loss: 215725.4917; train_cat_covariates_contrastive_loss: 1152.2521; train_gene_expr_recon_loss: 214936.1798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 437126.3126; train_optim_loss: 437126.3126; val_kl_reg_loss: 5551.0654; val_edge_recon_loss: 210554.5769; val_cat_covariates_contrastive_loss: 1152.2405; val_gene_expr_recon_loss: 201729.7641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 418987.6473; val_optim_loss: 418987.6473
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9852; val_auprc_score: 0.9881; val_best_acc_score: 0.9516; val_best_f1_score: 0.9601; train_kl_reg_loss: 5487.0674; train_edge_recon_loss: 209349.0025; train_cat_covariates_contrastive_loss: 1220.6513; train_gene_expr_recon_loss: 197052.8118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 413109.5329; train_optim_loss: 413109.5329; val_kl_reg_loss: 5568.7098; val_edge_recon_loss: 210834.8572; val_cat_covariates_contrastive_loss: 1216.8765; val_gene_expr_recon_loss: 191116.3575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 408736.8011; val_optim_loss: 408736.8011
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9863; val_auprc_score: 0.9885; val_best_acc_score: 0.9545; val_best_f1_score: 0.9625; train_kl_reg_loss: 5874.2126; train_edge_recon_loss: 209509.9514; train_cat_covariates_contrastive_loss: 1238.1569; train_gene_expr_recon_loss: 184742.8403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 401365.1608; train_optim_loss: 401365.1608; val_kl_reg_loss: 6099.2491; val_edge_recon_loss: 212037.0690; val_cat_covariates_contrastive_loss: 1203.7898; val_gene_expr_recon_loss: 178403.0394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 397743.1470; val_optim_loss: 397743.1470
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9872; val_auprc_score: 0.9897; val_best_acc_score: 0.9558; val_best_f1_score: 0.9639; train_kl_reg_loss: 6326.0015; train_edge_recon_loss: 209307.0480; train_cat_covariates_contrastive_loss: 1232.6026; train_gene_expr_recon_loss: 174389.8240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391255.4762; train_optim_loss: 391255.4762; val_kl_reg_loss: 6475.0392; val_edge_recon_loss: 210321.4967; val_cat_covariates_contrastive_loss: 1220.4888; val_gene_expr_recon_loss: 170292.6482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 388309.6723; val_optim_loss: 388309.6723
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9871; val_auprc_score: 0.9892; val_best_acc_score: 0.9563; val_best_f1_score: 0.9641; train_kl_reg_loss: 6586.8968; train_edge_recon_loss: 209668.3547; train_cat_covariates_contrastive_loss: 1229.5278; train_gene_expr_recon_loss: 168319.5644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 385804.3432; train_optim_loss: 385804.3432; val_kl_reg_loss: 6694.1475; val_edge_recon_loss: 211055.4405; val_cat_covariates_contrastive_loss: 1207.0516; val_gene_expr_recon_loss: 165704.1067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 384660.7454; val_optim_loss: 384660.7454
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9877; val_auprc_score: 0.9897; val_best_acc_score: 0.9589; val_best_f1_score: 0.9662; train_kl_reg_loss: 6715.2069; train_edge_recon_loss: 209538.8934; train_cat_covariates_contrastive_loss: 1224.3687; train_gene_expr_recon_loss: 164240.8564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 381719.3258; train_optim_loss: 381719.3258; val_kl_reg_loss: 6753.2614; val_edge_recon_loss: 210910.1095; val_cat_covariates_contrastive_loss: 1208.8928; val_gene_expr_recon_loss: 162321.4920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 381193.7552; val_optim_loss: 381193.7552
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9888; val_auprc_score: 0.9907; val_best_acc_score: 0.9607; val_best_f1_score: 0.9677; train_kl_reg_loss: 6815.8812; train_edge_recon_loss: 209383.7731; train_cat_covariates_contrastive_loss: 1223.9809; train_gene_expr_recon_loss: 161716.2466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 379139.8816; train_optim_loss: 379139.8816; val_kl_reg_loss: 6805.9543; val_edge_recon_loss: 210521.6264; val_cat_covariates_contrastive_loss: 1225.9043; val_gene_expr_recon_loss: 160081.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 378634.8101; val_optim_loss: 378634.8101
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9880; val_auprc_score: 0.9900; val_best_acc_score: 0.9598; val_best_f1_score: 0.9670; train_kl_reg_loss: 6876.3762; train_edge_recon_loss: 209035.0689; train_cat_covariates_contrastive_loss: 1223.1891; train_gene_expr_recon_loss: 159585.1627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 376719.7965; train_optim_loss: 376719.7965; val_kl_reg_loss: 6931.3325; val_edge_recon_loss: 210854.8135; val_cat_covariates_contrastive_loss: 1220.3614; val_gene_expr_recon_loss: 158967.9617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 377974.4682; val_optim_loss: 377974.4682
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9888; val_auprc_score: 0.9905; val_best_acc_score: 0.9609; val_best_f1_score: 0.9678; train_kl_reg_loss: 6932.4543; train_edge_recon_loss: 209204.3044; train_cat_covariates_contrastive_loss: 1227.7835; train_gene_expr_recon_loss: 157899.7019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 375264.2442; train_optim_loss: 375264.2442; val_kl_reg_loss: 6961.6465; val_edge_recon_loss: 211366.3781; val_cat_covariates_contrastive_loss: 1209.9640; val_gene_expr_recon_loss: 157164.4918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 376702.4802; val_optim_loss: 376702.4802
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9896; val_auprc_score: 0.9915; val_best_acc_score: 0.9611; val_best_f1_score: 0.9680; train_kl_reg_loss: 6954.2874; train_edge_recon_loss: 208992.5015; train_cat_covariates_contrastive_loss: 1223.9762; train_gene_expr_recon_loss: 156959.8160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 374130.5804; train_optim_loss: 374130.5804; val_kl_reg_loss: 6938.7239; val_edge_recon_loss: 211103.8844; val_cat_covariates_contrastive_loss: 1213.9802; val_gene_expr_recon_loss: 156160.4649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375417.0533; val_optim_loss: 375417.0533
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9899; val_auprc_score: 0.9915; val_best_acc_score: 0.9627; val_best_f1_score: 0.9693; train_kl_reg_loss: 6983.8596; train_edge_recon_loss: 208906.2187; train_cat_covariates_contrastive_loss: 1225.8710; train_gene_expr_recon_loss: 155901.2085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373017.1578; train_optim_loss: 373017.1578; val_kl_reg_loss: 6953.1266; val_edge_recon_loss: 210467.6590; val_cat_covariates_contrastive_loss: 1196.0106; val_gene_expr_recon_loss: 156262.7376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374879.5329; val_optim_loss: 374879.5329
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9902; val_auprc_score: 0.9918; val_best_acc_score: 0.9633; val_best_f1_score: 0.9698; train_kl_reg_loss: 7015.3197; train_edge_recon_loss: 208871.7156; train_cat_covariates_contrastive_loss: 1219.2810; train_gene_expr_recon_loss: 155239.7600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372346.0765; train_optim_loss: 372346.0765; val_kl_reg_loss: 7090.8149; val_edge_recon_loss: 210116.0904; val_cat_covariates_contrastive_loss: 1203.0039; val_gene_expr_recon_loss: 155144.9077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373554.8168; val_optim_loss: 373554.8168
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9900; val_auprc_score: 0.9918; val_best_acc_score: 0.9636; val_best_f1_score: 0.9701; train_kl_reg_loss: 7031.2405; train_edge_recon_loss: 208755.8001; train_cat_covariates_contrastive_loss: 1222.0933; train_gene_expr_recon_loss: 154553.4550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371562.5897; train_optim_loss: 371562.5897; val_kl_reg_loss: 6997.9156; val_edge_recon_loss: 210350.3538; val_cat_covariates_contrastive_loss: 1202.3092; val_gene_expr_recon_loss: 154369.0113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372919.5921; val_optim_loss: 372919.5921
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9891; val_auprc_score: 0.9908; val_best_acc_score: 0.9625; val_best_f1_score: 0.9692; train_kl_reg_loss: 7033.3199; train_edge_recon_loss: 208835.1686; train_cat_covariates_contrastive_loss: 1220.3193; train_gene_expr_recon_loss: 153831.5006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370920.3079; train_optim_loss: 370920.3079; val_kl_reg_loss: 7071.8885; val_edge_recon_loss: 209725.5200; val_cat_covariates_contrastive_loss: 1205.2713; val_gene_expr_recon_loss: 153874.7535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371877.4323; val_optim_loss: 371877.4323
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9902; val_auprc_score: 0.9918; val_best_acc_score: 0.9639; val_best_f1_score: 0.9704; train_kl_reg_loss: 7046.5017; train_edge_recon_loss: 208918.2478; train_cat_covariates_contrastive_loss: 1221.5953; train_gene_expr_recon_loss: 153849.7204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371036.0646; train_optim_loss: 371036.0646; val_kl_reg_loss: 7194.7779; val_edge_recon_loss: 209284.8625; val_cat_covariates_contrastive_loss: 1212.5757; val_gene_expr_recon_loss: 153974.8913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371667.1076; val_optim_loss: 371667.1076
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9901; val_auprc_score: 0.9915; val_best_acc_score: 0.9651; val_best_f1_score: 0.9712; train_kl_reg_loss: 7059.7225; train_edge_recon_loss: 208673.5081; train_cat_covariates_contrastive_loss: 1218.5415; train_gene_expr_recon_loss: 153391.0228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370342.7954; train_optim_loss: 370342.7954; val_kl_reg_loss: 7046.4019; val_edge_recon_loss: 209882.1735; val_cat_covariates_contrastive_loss: 1208.4005; val_gene_expr_recon_loss: 153502.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371639.8187; val_optim_loss: 371639.8187
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9902; val_auprc_score: 0.9916; val_best_acc_score: 0.9641; val_best_f1_score: 0.9705; train_kl_reg_loss: 7074.6200; train_edge_recon_loss: 208563.2090; train_cat_covariates_contrastive_loss: 1220.0701; train_gene_expr_recon_loss: 153082.4339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369940.3325; train_optim_loss: 369940.3325; val_kl_reg_loss: 7055.0704; val_edge_recon_loss: 210141.9019; val_cat_covariates_contrastive_loss: 1202.7916; val_gene_expr_recon_loss: 152971.0754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371370.8383; val_optim_loss: 371370.8383
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9901; val_auprc_score: 0.9918; val_best_acc_score: 0.9655; val_best_f1_score: 0.9716; train_kl_reg_loss: 7078.5540; train_edge_recon_loss: 208594.1348; train_cat_covariates_contrastive_loss: 1225.9558; train_gene_expr_recon_loss: 152373.9365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369272.5807; train_optim_loss: 369272.5807; val_kl_reg_loss: 7058.2297; val_edge_recon_loss: 209737.2837; val_cat_covariates_contrastive_loss: 1211.3211; val_gene_expr_recon_loss: 152401.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370408.0598; val_optim_loss: 370408.0598
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9906; val_auprc_score: 0.9921; val_best_acc_score: 0.9656; val_best_f1_score: 0.9716; train_kl_reg_loss: 7084.7971; train_edge_recon_loss: 208660.2927; train_cat_covariates_contrastive_loss: 1220.8743; train_gene_expr_recon_loss: 152545.5084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369511.4728; train_optim_loss: 369511.4728; val_kl_reg_loss: 7077.8936; val_edge_recon_loss: 210172.1492; val_cat_covariates_contrastive_loss: 1208.4274; val_gene_expr_recon_loss: 152588.5814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371047.0489; val_optim_loss: 371047.0489
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9907; val_auprc_score: 0.9921; val_best_acc_score: 0.9660; val_best_f1_score: 0.9720; train_kl_reg_loss: 7094.9258; train_edge_recon_loss: 208415.7221; train_cat_covariates_contrastive_loss: 1222.8086; train_gene_expr_recon_loss: 151738.4965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368471.9532; train_optim_loss: 368471.9532; val_kl_reg_loss: 7087.5871; val_edge_recon_loss: 210091.6283; val_cat_covariates_contrastive_loss: 1213.0086; val_gene_expr_recon_loss: 152286.9057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370679.1307; val_optim_loss: 370679.1307
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9907; val_auprc_score: 0.9921; val_best_acc_score: 0.9658; val_best_f1_score: 0.9719; train_kl_reg_loss: 7092.6200; train_edge_recon_loss: 208688.9520; train_cat_covariates_contrastive_loss: 1219.9304; train_gene_expr_recon_loss: 151928.3158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368929.8189; train_optim_loss: 368929.8189; val_kl_reg_loss: 7086.2063; val_edge_recon_loss: 209452.9257; val_cat_covariates_contrastive_loss: 1206.2395; val_gene_expr_recon_loss: 153127.0420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370872.4125; val_optim_loss: 370872.4125
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9905; val_auprc_score: 0.9919; val_best_acc_score: 0.9659; val_best_f1_score: 0.9719; train_kl_reg_loss: 7104.4759; train_edge_recon_loss: 208415.2610; train_cat_covariates_contrastive_loss: 1217.3846; train_gene_expr_recon_loss: 151731.7524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368468.8732; train_optim_loss: 368468.8732; val_kl_reg_loss: 7155.9612; val_edge_recon_loss: 209677.6986; val_cat_covariates_contrastive_loss: 1214.2824; val_gene_expr_recon_loss: 153848.6012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371896.5429; val_optim_loss: 371896.5429

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9915; val_auprc_score: 0.9929; val_best_acc_score: 0.9673; val_best_f1_score: 0.9731; train_kl_reg_loss: 7026.8117; train_edge_recon_loss: 208064.3173; train_cat_covariates_contrastive_loss: 1222.3798; train_gene_expr_recon_loss: 150207.4038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 366520.9129; train_optim_loss: 366520.9129; val_kl_reg_loss: 7024.0700; val_edge_recon_loss: 209452.2156; val_cat_covariates_contrastive_loss: 1212.0477; val_gene_expr_recon_loss: 150792.6488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368480.9821; val_optim_loss: 368480.9821
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9922; val_auprc_score: 0.9935; val_best_acc_score: 0.9682; val_best_f1_score: 0.9738; train_kl_reg_loss: 7012.1623; train_edge_recon_loss: 208231.2606; train_cat_covariates_contrastive_loss: 1221.3500; train_gene_expr_recon_loss: 149396.7015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365861.4745; train_optim_loss: 365861.4745; val_kl_reg_loss: 7018.5835; val_edge_recon_loss: 208801.6603; val_cat_covariates_contrastive_loss: 1213.3730; val_gene_expr_recon_loss: 150685.8738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367719.4902; val_optim_loss: 367719.4902
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9917; val_auprc_score: 0.9931; val_best_acc_score: 0.9672; val_best_f1_score: 0.9730; train_kl_reg_loss: 7002.7394; train_edge_recon_loss: 208314.0079; train_cat_covariates_contrastive_loss: 1225.3198; train_gene_expr_recon_loss: 149160.4307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365702.4979; train_optim_loss: 365702.4979; val_kl_reg_loss: 6980.9956; val_edge_recon_loss: 209489.4201; val_cat_covariates_contrastive_loss: 1209.8635; val_gene_expr_recon_loss: 150380.0399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368060.3207; val_optim_loss: 368060.3207
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9916; val_auprc_score: 0.9928; val_best_acc_score: 0.9671; val_best_f1_score: 0.9729; train_kl_reg_loss: 6995.6343; train_edge_recon_loss: 208105.9068; train_cat_covariates_contrastive_loss: 1219.3867; train_gene_expr_recon_loss: 148882.5580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365203.4853; train_optim_loss: 365203.4853; val_kl_reg_loss: 7006.4020; val_edge_recon_loss: 209242.4390; val_cat_covariates_contrastive_loss: 1201.5762; val_gene_expr_recon_loss: 150252.8798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367703.2962; val_optim_loss: 367703.2962
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9919; val_auprc_score: 0.9931; val_best_acc_score: 0.9679; val_best_f1_score: 0.9735; train_kl_reg_loss: 6991.6353; train_edge_recon_loss: 208028.1709; train_cat_covariates_contrastive_loss: 1223.5816; train_gene_expr_recon_loss: 148736.9359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364980.3242; train_optim_loss: 364980.3242; val_kl_reg_loss: 6962.3884; val_edge_recon_loss: 209234.9387; val_cat_covariates_contrastive_loss: 1204.8710; val_gene_expr_recon_loss: 149738.4376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367140.6334; val_optim_loss: 367140.6334
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9920; val_auprc_score: 0.9929; val_best_acc_score: 0.9682; val_best_f1_score: 0.9738; train_kl_reg_loss: 6974.6854; train_edge_recon_loss: 208239.9742; train_cat_covariates_contrastive_loss: 1225.4349; train_gene_expr_recon_loss: 148636.0157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365076.1095; train_optim_loss: 365076.1095; val_kl_reg_loss: 6950.7445; val_edge_recon_loss: 209309.7648; val_cat_covariates_contrastive_loss: 1216.5474; val_gene_expr_recon_loss: 150039.8656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367516.9234; val_optim_loss: 367516.9234
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9920; val_auprc_score: 0.9934; val_best_acc_score: 0.9675; val_best_f1_score: 0.9732; train_kl_reg_loss: 6957.8277; train_edge_recon_loss: 208026.8150; train_cat_covariates_contrastive_loss: 1225.9689; train_gene_expr_recon_loss: 148576.0355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364786.6475; train_optim_loss: 364786.6475; val_kl_reg_loss: 6954.0663; val_edge_recon_loss: 209184.1834; val_cat_covariates_contrastive_loss: 1214.3891; val_gene_expr_recon_loss: 149658.8772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367011.5160; val_optim_loss: 367011.5160
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9921; val_auprc_score: 0.9931; val_best_acc_score: 0.9684; val_best_f1_score: 0.9740; train_kl_reg_loss: 6955.6159; train_edge_recon_loss: 208105.9694; train_cat_covariates_contrastive_loss: 1221.0991; train_gene_expr_recon_loss: 148412.5132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364695.1975; train_optim_loss: 364695.1975; val_kl_reg_loss: 6917.7748; val_edge_recon_loss: 209318.2556; val_cat_covariates_contrastive_loss: 1209.5315; val_gene_expr_recon_loss: 149988.4840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367434.0457; val_optim_loss: 367434.0457
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9919; val_auprc_score: 0.9933; val_best_acc_score: 0.9680; val_best_f1_score: 0.9737; train_kl_reg_loss: 6959.3066; train_edge_recon_loss: 207890.4566; train_cat_covariates_contrastive_loss: 1223.4809; train_gene_expr_recon_loss: 148398.5378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364471.7823; train_optim_loss: 364471.7823; val_kl_reg_loss: 6935.7453; val_edge_recon_loss: 209240.2931; val_cat_covariates_contrastive_loss: 1210.2831; val_gene_expr_recon_loss: 149692.3530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367078.6747; val_optim_loss: 367078.6747
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9918; val_auprc_score: 0.9930; val_best_acc_score: 0.9682; val_best_f1_score: 0.9737; train_kl_reg_loss: 6942.5024; train_edge_recon_loss: 208128.3493; train_cat_covariates_contrastive_loss: 1226.4182; train_gene_expr_recon_loss: 148298.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364595.3248; train_optim_loss: 364595.3248; val_kl_reg_loss: 6942.8640; val_edge_recon_loss: 209275.8784; val_cat_covariates_contrastive_loss: 1207.2612; val_gene_expr_recon_loss: 149627.2211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367053.2269; val_optim_loss: 367053.2269
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9914; val_auprc_score: 0.9927; val_best_acc_score: 0.9677; val_best_f1_score: 0.9734; train_kl_reg_loss: 6941.9285; train_edge_recon_loss: 208159.4868; train_cat_covariates_contrastive_loss: 1222.7813; train_gene_expr_recon_loss: 148348.8199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364673.0167; train_optim_loss: 364673.0167; val_kl_reg_loss: 6931.2763; val_edge_recon_loss: 209458.3238; val_cat_covariates_contrastive_loss: 1214.6381; val_gene_expr_recon_loss: 149657.7686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367262.0071; val_optim_loss: 367262.0071

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9917; val_auprc_score: 0.9931; val_best_acc_score: 0.9678; val_best_f1_score: 0.9735; train_kl_reg_loss: 6917.6158; train_edge_recon_loss: 208156.8184; train_cat_covariates_contrastive_loss: 1225.2921; train_gene_expr_recon_loss: 147995.4879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364295.2142; train_optim_loss: 364295.2142; val_kl_reg_loss: 6918.2967; val_edge_recon_loss: 209093.6080; val_cat_covariates_contrastive_loss: 1211.1663; val_gene_expr_recon_loss: 149446.3113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366669.3837; val_optim_loss: 366669.3837
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9922; val_auprc_score: 0.9934; val_best_acc_score: 0.9682; val_best_f1_score: 0.9738; train_kl_reg_loss: 6918.4521; train_edge_recon_loss: 207920.5581; train_cat_covariates_contrastive_loss: 1222.8385; train_gene_expr_recon_loss: 147962.3430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364024.1921; train_optim_loss: 364024.1921; val_kl_reg_loss: 6922.0118; val_edge_recon_loss: 209436.4813; val_cat_covariates_contrastive_loss: 1222.9330; val_gene_expr_recon_loss: 149261.8227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366843.2503; val_optim_loss: 366843.2503
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9918; val_auprc_score: 0.9929; val_best_acc_score: 0.9692; val_best_f1_score: 0.9746; train_kl_reg_loss: 6920.8945; train_edge_recon_loss: 208108.7467; train_cat_covariates_contrastive_loss: 1223.6188; train_gene_expr_recon_loss: 147832.4676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364085.7271; train_optim_loss: 364085.7271; val_kl_reg_loss: 6922.1321; val_edge_recon_loss: 208899.3420; val_cat_covariates_contrastive_loss: 1204.8998; val_gene_expr_recon_loss: 149351.4780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366377.8492; val_optim_loss: 366377.8492
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9922; val_auprc_score: 0.9936; val_best_acc_score: 0.9684; val_best_f1_score: 0.9740; train_kl_reg_loss: 6921.6231; train_edge_recon_loss: 207874.1059; train_cat_covariates_contrastive_loss: 1225.4545; train_gene_expr_recon_loss: 147914.8743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363936.0577; train_optim_loss: 363936.0577; val_kl_reg_loss: 6920.5361; val_edge_recon_loss: 209268.2114; val_cat_covariates_contrastive_loss: 1215.1590; val_gene_expr_recon_loss: 149100.1319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366504.0394; val_optim_loss: 366504.0394
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9915; val_auprc_score: 0.9928; val_best_acc_score: 0.9684; val_best_f1_score: 0.9740; train_kl_reg_loss: 6918.4503; train_edge_recon_loss: 207943.2415; train_cat_covariates_contrastive_loss: 1222.1697; train_gene_expr_recon_loss: 148051.3815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364135.2425; train_optim_loss: 364135.2425; val_kl_reg_loss: 6917.1809; val_edge_recon_loss: 209809.7800; val_cat_covariates_contrastive_loss: 1215.4497; val_gene_expr_recon_loss: 149806.7468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367749.1579; val_optim_loss: 367749.1579
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9927; val_auprc_score: 0.9940; val_best_acc_score: 0.9694; val_best_f1_score: 0.9748; train_kl_reg_loss: 6913.2923; train_edge_recon_loss: 208087.8747; train_cat_covariates_contrastive_loss: 1220.4018; train_gene_expr_recon_loss: 147966.0388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364187.6072; train_optim_loss: 364187.6072; val_kl_reg_loss: 6915.0158; val_edge_recon_loss: 208998.0724; val_cat_covariates_contrastive_loss: 1216.1723; val_gene_expr_recon_loss: 149304.8518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366434.1103; val_optim_loss: 366434.1103
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9922; val_auprc_score: 0.9935; val_best_acc_score: 0.9687; val_best_f1_score: 0.9741; train_kl_reg_loss: 6910.3919; train_edge_recon_loss: 207690.4753; train_cat_covariates_contrastive_loss: 1223.8383; train_gene_expr_recon_loss: 147843.3874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363668.0934; train_optim_loss: 363668.0934; val_kl_reg_loss: 6908.7351; val_edge_recon_loss: 208664.3533; val_cat_covariates_contrastive_loss: 1199.6616; val_gene_expr_recon_loss: 148994.4276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365767.1796; val_optim_loss: 365767.1796
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9921; val_auprc_score: 0.9933; val_best_acc_score: 0.9687; val_best_f1_score: 0.9742; train_kl_reg_loss: 6909.0975; train_edge_recon_loss: 207903.8724; train_cat_covariates_contrastive_loss: 1220.5072; train_gene_expr_recon_loss: 147872.0607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363905.5369; train_optim_loss: 363905.5369; val_kl_reg_loss: 6909.4992; val_edge_recon_loss: 209040.1841; val_cat_covariates_contrastive_loss: 1213.6170; val_gene_expr_recon_loss: 149320.3198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366483.6217; val_optim_loss: 366483.6217
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9923; val_auprc_score: 0.9935; val_best_acc_score: 0.9681; val_best_f1_score: 0.9738; train_kl_reg_loss: 6910.8981; train_edge_recon_loss: 208294.8863; train_cat_covariates_contrastive_loss: 1223.6216; train_gene_expr_recon_loss: 147957.3793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364386.7855; train_optim_loss: 364386.7855; val_kl_reg_loss: 6906.9330; val_edge_recon_loss: 208683.6079; val_cat_covariates_contrastive_loss: 1207.1489; val_gene_expr_recon_loss: 149315.5235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366113.2149; val_optim_loss: 366113.2149
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9920; val_auprc_score: 0.9933; val_best_acc_score: 0.9685; val_best_f1_score: 0.9741; train_kl_reg_loss: 6906.7688; train_edge_recon_loss: 208000.5961; train_cat_covariates_contrastive_loss: 1224.5891; train_gene_expr_recon_loss: 147877.8929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364009.8466; train_optim_loss: 364009.8466; val_kl_reg_loss: 6919.9408; val_edge_recon_loss: 208404.7526; val_cat_covariates_contrastive_loss: 1215.2908; val_gene_expr_recon_loss: 149120.8933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365660.8766; val_optim_loss: 365660.8766
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9924; val_auprc_score: 0.9938; val_best_acc_score: 0.9683; val_best_f1_score: 0.9739; train_kl_reg_loss: 6911.2855; train_edge_recon_loss: 207844.5404; train_cat_covariates_contrastive_loss: 1221.4447; train_gene_expr_recon_loss: 147782.8922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363760.1632; train_optim_loss: 363760.1632; val_kl_reg_loss: 6910.4535; val_edge_recon_loss: 208713.2542; val_cat_covariates_contrastive_loss: 1200.0280; val_gene_expr_recon_loss: 149511.0421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366334.7799; val_optim_loss: 366334.7799
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9918; val_auprc_score: 0.9932; val_best_acc_score: 0.9681; val_best_f1_score: 0.9739; train_kl_reg_loss: 6912.6260; train_edge_recon_loss: 207926.6873; train_cat_covariates_contrastive_loss: 1225.9197; train_gene_expr_recon_loss: 147891.1519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363956.3852; train_optim_loss: 363956.3852; val_kl_reg_loss: 6921.0123; val_edge_recon_loss: 208414.1341; val_cat_covariates_contrastive_loss: 1204.4366; val_gene_expr_recon_loss: 149810.2543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366349.8380; val_optim_loss: 366349.8380
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9920; val_auprc_score: 0.9932; val_best_acc_score: 0.9678; val_best_f1_score: 0.9735; train_kl_reg_loss: 6907.4000; train_edge_recon_loss: 207724.7552; train_cat_covariates_contrastive_loss: 1223.9496; train_gene_expr_recon_loss: 147839.4973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363695.6018; train_optim_loss: 363695.6018; val_kl_reg_loss: 6925.0362; val_edge_recon_loss: 209701.7168; val_cat_covariates_contrastive_loss: 1203.2712; val_gene_expr_recon_loss: 149625.6262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367455.6519; val_optim_loss: 367455.6519
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9922; val_auprc_score: 0.9936; val_best_acc_score: 0.9692; val_best_f1_score: 0.9746; train_kl_reg_loss: 6911.9297; train_edge_recon_loss: 207732.7732; train_cat_covariates_contrastive_loss: 1223.0762; train_gene_expr_recon_loss: 147985.5176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363853.2967; train_optim_loss: 363853.2967; val_kl_reg_loss: 6912.0601; val_edge_recon_loss: 209270.5330; val_cat_covariates_contrastive_loss: 1211.5041; val_gene_expr_recon_loss: 149138.6238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366532.7215; val_optim_loss: 366532.7215

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9921; val_auprc_score: 0.9937; val_best_acc_score: 0.9675; val_best_f1_score: 0.9732; train_kl_reg_loss: 6907.6638; train_edge_recon_loss: 207844.9912; train_cat_covariates_contrastive_loss: 1224.1537; train_gene_expr_recon_loss: 147783.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363759.8829; train_optim_loss: 363759.8829; val_kl_reg_loss: 6917.7463; val_edge_recon_loss: 209033.1364; val_cat_covariates_contrastive_loss: 1213.2371; val_gene_expr_recon_loss: 149119.8791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366283.9981; val_optim_loss: 366283.9981
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9921; val_auprc_score: 0.9934; val_best_acc_score: 0.9684; val_best_f1_score: 0.9740; train_kl_reg_loss: 6911.5496; train_edge_recon_loss: 207993.6772; train_cat_covariates_contrastive_loss: 1220.8179; train_gene_expr_recon_loss: 147841.8433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363967.8885; train_optim_loss: 363967.8885; val_kl_reg_loss: 6917.0569; val_edge_recon_loss: 208725.7148; val_cat_covariates_contrastive_loss: 1216.0727; val_gene_expr_recon_loss: 149422.0659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366280.9109; val_optim_loss: 366280.9109
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9921; val_auprc_score: 0.9933; val_best_acc_score: 0.9686; val_best_f1_score: 0.9741; train_kl_reg_loss: 6908.4822; train_edge_recon_loss: 207890.9216; train_cat_covariates_contrastive_loss: 1221.1568; train_gene_expr_recon_loss: 147815.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363836.4178; train_optim_loss: 363836.4178; val_kl_reg_loss: 6914.6073; val_edge_recon_loss: 209329.3693; val_cat_covariates_contrastive_loss: 1225.6322; val_gene_expr_recon_loss: 149559.8270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367029.4345; val_optim_loss: 367029.4345
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9922; val_auprc_score: 0.9933; val_best_acc_score: 0.9687; val_best_f1_score: 0.9742; train_kl_reg_loss: 6908.5548; train_edge_recon_loss: 207950.8330; train_cat_covariates_contrastive_loss: 1219.7982; train_gene_expr_recon_loss: 147895.2629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363974.4487; train_optim_loss: 363974.4487; val_kl_reg_loss: 6920.4900; val_edge_recon_loss: 209138.7240; val_cat_covariates_contrastive_loss: 1215.6273; val_gene_expr_recon_loss: 149373.6226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366648.4628; val_optim_loss: 366648.4628

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 186 min 52 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9923
val AUPRC score: 0.9936
val best accuracy score: 0.9686
val best F1 score: 0.9741
val target rna MSE score: 0.5483
val source rna MSE score: 0.1453
Val cat covariate0 mean sim diff: 0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
