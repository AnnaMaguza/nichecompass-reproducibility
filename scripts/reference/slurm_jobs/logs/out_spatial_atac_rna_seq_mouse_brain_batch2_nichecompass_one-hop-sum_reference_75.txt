[True]
Run timestamp: 10082023_222011_75.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_75']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7419; val_auprc_score: 0.7663; val_best_acc_score: 0.5082; val_best_f1_score: 0.6703; train_kl_reg_loss: 99119.1068; train_edge_recon_loss: 3708568.5859; train_gene_expr_recon_loss: 46403482.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16692058.2214; train_global_loss: 66903228.7328; train_optim_loss: 66903228.7328; val_kl_reg_loss: 97066.6219; val_edge_recon_loss: 4064804.5833; val_gene_expr_recon_loss: 39329977.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15772307.8667; val_global_loss: 59264156.0000; val_optim_loss: 59264156.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7670; val_auprc_score: 0.7878; val_best_acc_score: 0.6420; val_best_f1_score: 0.7162; train_kl_reg_loss: 146167.4720; train_edge_recon_loss: 3690975.4809; train_gene_expr_recon_loss: 38479112.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15558857.5115; train_global_loss: 57875112.6107; train_optim_loss: 57875112.6107; val_kl_reg_loss: 168166.2729; val_edge_recon_loss: 4055995.8333; val_gene_expr_recon_loss: 37431296.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15543491.1333; val_global_loss: 57198949.6000; val_optim_loss: 57198949.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8313; val_auprc_score: 0.8431; val_best_acc_score: 0.7506; val_best_f1_score: 0.7312; train_kl_reg_loss: 175769.8498; train_edge_recon_loss: 3567896.0344; train_gene_expr_recon_loss: 37044580.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15328731.8626; train_global_loss: 56116978.3206; train_optim_loss: 56116978.3206; val_kl_reg_loss: 156803.6594; val_edge_recon_loss: 4028105.2500; val_gene_expr_recon_loss: 36799063.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15383778.7333; val_global_loss: 56367751.2000; val_optim_loss: 56367751.2000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8801; val_auprc_score: 0.8749; val_best_acc_score: 0.7889; val_best_f1_score: 0.8094; train_kl_reg_loss: 154004.4082; train_edge_recon_loss: 3539998.2481; train_gene_expr_recon_loss: 36755901.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15258933.9847; train_global_loss: 55708838.1985; train_optim_loss: 55708838.1985; val_kl_reg_loss: 134110.0932; val_edge_recon_loss: 3924544.2333; val_gene_expr_recon_loss: 36565054.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15329950.6000; val_global_loss: 55953658.9333; val_optim_loss: 55953658.9333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8918; val_auprc_score: 0.8884; val_best_acc_score: 0.7984; val_best_f1_score: 0.8134; train_kl_reg_loss: 127275.0529; train_edge_recon_loss: 3437669.7252; train_gene_expr_recon_loss: 36448509.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15172846.6870; train_global_loss: 55186300.6718; train_optim_loss: 55186300.6718; val_kl_reg_loss: 117425.9714; val_edge_recon_loss: 3308134.3333; val_gene_expr_recon_loss: 36287149.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15214877.9333; val_global_loss: 54927587.7333; val_optim_loss: 54927587.7333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8839; val_auprc_score: 0.8752; val_best_acc_score: 0.7894; val_best_f1_score: 0.8050; train_kl_reg_loss: 155009.5152; train_edge_recon_loss: 3079825.2137; train_gene_expr_recon_loss: 36230679.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15102069.0000; train_global_loss: 54567583.7557; train_optim_loss: 54567583.7557; val_kl_reg_loss: 165132.5417; val_edge_recon_loss: 3046163.2333; val_gene_expr_recon_loss: 36203950.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15193241.8000; val_global_loss: 54608489.0667; val_optim_loss: 54608489.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8938; val_auprc_score: 0.8808; val_best_acc_score: 0.8065; val_best_f1_score: 0.8200; train_kl_reg_loss: 165435.7294; train_edge_recon_loss: 2999654.4046; train_gene_expr_recon_loss: 35966411.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15003904.5267; train_global_loss: 54135406.3511; train_optim_loss: 54135406.3511; val_kl_reg_loss: 162247.1333; val_edge_recon_loss: 2979937.3000; val_gene_expr_recon_loss: 35895564.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15093060.3333; val_global_loss: 54130809.8667; val_optim_loss: 54130809.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9058; val_auprc_score: 0.8939; val_best_acc_score: 0.8246; val_best_f1_score: 0.8360; train_kl_reg_loss: 159056.5643; train_edge_recon_loss: 2956066.3225; train_gene_expr_recon_loss: 35792161.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14957091.1679; train_global_loss: 53864375.0840; train_optim_loss: 53864375.0840; val_kl_reg_loss: 156567.7292; val_edge_recon_loss: 2947706.8500; val_gene_expr_recon_loss: 35691193.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15038176.7333; val_global_loss: 53833644.2667; val_optim_loss: 53833644.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9194; val_auprc_score: 0.9034; val_best_acc_score: 0.8459; val_best_f1_score: 0.8541; train_kl_reg_loss: 154774.0395; train_edge_recon_loss: 2917459.2519; train_gene_expr_recon_loss: 35638085.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14902237.8626; train_global_loss: 53612556.1527; train_optim_loss: 53612556.1527; val_kl_reg_loss: 149893.6229; val_edge_recon_loss: 2918621.5000; val_gene_expr_recon_loss: 35616870.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15005250.6000; val_global_loss: 53690636.0000; val_optim_loss: 53690636.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9302; val_auprc_score: 0.9156; val_best_acc_score: 0.8647; val_best_f1_score: 0.8708; train_kl_reg_loss: 152995.1189; train_edge_recon_loss: 2884820.0229; train_gene_expr_recon_loss: 35487910.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14854203.4809; train_global_loss: 53379929.4962; train_optim_loss: 53379929.4962; val_kl_reg_loss: 145320.0760; val_edge_recon_loss: 2892721.7167; val_gene_expr_recon_loss: 35370931.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14940236.4000; val_global_loss: 53349209.3333; val_optim_loss: 53349209.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9272; val_auprc_score: 0.9167; val_best_acc_score: 0.8530; val_best_f1_score: 0.8634; train_kl_reg_loss: 148797.7995; train_edge_recon_loss: 2864202.7176; train_gene_expr_recon_loss: 35403202.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14832261.9313; train_global_loss: 53248465.2519; train_optim_loss: 53248465.2519; val_kl_reg_loss: 147554.9875; val_edge_recon_loss: 2924461.9000; val_gene_expr_recon_loss: 35284116.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14890586.0667; val_global_loss: 53246718.1333; val_optim_loss: 53246718.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9449; val_auprc_score: 0.9357; val_best_acc_score: 0.8783; val_best_f1_score: 0.8851; train_kl_reg_loss: 144753.8825; train_edge_recon_loss: 2847347.6221; train_gene_expr_recon_loss: 35211246.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14759697.8473; train_global_loss: 52963046.6260; train_optim_loss: 52963046.6260; val_kl_reg_loss: 139648.8427; val_edge_recon_loss: 2830717.2333; val_gene_expr_recon_loss: 35197944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14865177.5333; val_global_loss: 53033487.4667; val_optim_loss: 53033487.4667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9384; val_auprc_score: 0.9271; val_best_acc_score: 0.8725; val_best_f1_score: 0.8787; train_kl_reg_loss: 139436.9819; train_edge_recon_loss: 2845251.0649; train_gene_expr_recon_loss: 35123460.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14730014.1756; train_global_loss: 52838162.8702; train_optim_loss: 52838162.8702; val_kl_reg_loss: 136260.7500; val_edge_recon_loss: 2862844.1167; val_gene_expr_recon_loss: 35291505.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14950770.8000; val_global_loss: 53241381.8667; val_optim_loss: 53241381.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9488; val_auprc_score: 0.9378; val_best_acc_score: 0.8897; val_best_f1_score: 0.8933; train_kl_reg_loss: 134950.3093; train_edge_recon_loss: 2839615.2882; train_gene_expr_recon_loss: 35055934.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14720611.3969; train_global_loss: 52751111.5725; train_optim_loss: 52751111.5725; val_kl_reg_loss: 134678.0417; val_edge_recon_loss: 2809879.0500; val_gene_expr_recon_loss: 35044098.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14821898.8000; val_global_loss: 52810554.9333; val_optim_loss: 52810554.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9514; val_auprc_score: 0.9417; val_best_acc_score: 0.8897; val_best_f1_score: 0.8940; train_kl_reg_loss: 131925.7090; train_edge_recon_loss: 2814697.2023; train_gene_expr_recon_loss: 34952319.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14686226.2290; train_global_loss: 52585169.1603; train_optim_loss: 52585169.1603; val_kl_reg_loss: 128922.4333; val_edge_recon_loss: 2810327.4000; val_gene_expr_recon_loss: 35077132.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14872542.2667; val_global_loss: 52888924.5333; val_optim_loss: 52888924.5333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9534; val_auprc_score: 0.9460; val_best_acc_score: 0.8901; val_best_f1_score: 0.8948; train_kl_reg_loss: 128518.0636; train_edge_recon_loss: 2811861.3569; train_gene_expr_recon_loss: 34842150.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14652741.0229; train_global_loss: 52435270.7786; train_optim_loss: 52435270.7786; val_kl_reg_loss: 126325.0813; val_edge_recon_loss: 2815127.3667; val_gene_expr_recon_loss: 34823376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14694116.0000; val_global_loss: 52458944.8000; val_optim_loss: 52458944.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9547; val_auprc_score: 0.9459; val_best_acc_score: 0.8944; val_best_f1_score: 0.8993; train_kl_reg_loss: 124783.8175; train_edge_recon_loss: 2804291.3912; train_gene_expr_recon_loss: 34783549.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14637220.3282; train_global_loss: 52349844.6718; train_optim_loss: 52349844.6718; val_kl_reg_loss: 120922.7828; val_edge_recon_loss: 2812701.5167; val_gene_expr_recon_loss: 34862978.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14738098.3333; val_global_loss: 52534701.8667; val_optim_loss: 52534701.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9570; val_auprc_score: 0.9498; val_best_acc_score: 0.8919; val_best_f1_score: 0.8970; train_kl_reg_loss: 122328.8030; train_edge_recon_loss: 2799330.6298; train_gene_expr_recon_loss: 34683530.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14600804.4809; train_global_loss: 52205994.2290; train_optim_loss: 52205994.2290; val_kl_reg_loss: 121480.2323; val_edge_recon_loss: 2809549.3833; val_gene_expr_recon_loss: 34726520.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14739751.2667; val_global_loss: 52397301.8667; val_optim_loss: 52397301.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9568; val_auprc_score: 0.9471; val_best_acc_score: 0.8944; val_best_f1_score: 0.8991; train_kl_reg_loss: 119566.7556; train_edge_recon_loss: 2790198.4179; train_gene_expr_recon_loss: 34652467.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14605432.9160; train_global_loss: 52167665.4046; train_optim_loss: 52167665.4046; val_kl_reg_loss: 118414.1646; val_edge_recon_loss: 2802171.6333; val_gene_expr_recon_loss: 34525877.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14693729.8667; val_global_loss: 52140194.1333; val_optim_loss: 52140194.1333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9629; val_auprc_score: 0.9574; val_best_acc_score: 0.9018; val_best_f1_score: 0.9058; train_kl_reg_loss: 116383.4673; train_edge_recon_loss: 2775246.1603; train_gene_expr_recon_loss: 34602468.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14593083.6870; train_global_loss: 52087182.3206; train_optim_loss: 52087182.3206; val_kl_reg_loss: 116241.7323; val_edge_recon_loss: 2786504.9333; val_gene_expr_recon_loss: 34460894.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14629615.0000; val_global_loss: 51993256.0000; val_optim_loss: 51993256.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9610; val_auprc_score: 0.9516; val_best_acc_score: 0.8998; val_best_f1_score: 0.9050; train_kl_reg_loss: 115099.8993; train_edge_recon_loss: 2770539.6966; train_gene_expr_recon_loss: 34549166.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14582701.6947; train_global_loss: 52017507.3588; train_optim_loss: 52017507.3588; val_kl_reg_loss: 113072.0135; val_edge_recon_loss: 2798762.5667; val_gene_expr_recon_loss: 34515517.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14658677.5333; val_global_loss: 52086029.6000; val_optim_loss: 52086029.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9647; val_auprc_score: 0.9593; val_best_acc_score: 0.9034; val_best_f1_score: 0.9078; train_kl_reg_loss: 112945.7668; train_edge_recon_loss: 2767009.9637; train_gene_expr_recon_loss: 34475627.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14559551.5573; train_global_loss: 51915134.3511; train_optim_loss: 51915134.3511; val_kl_reg_loss: 112827.5552; val_edge_recon_loss: 2770186.2500; val_gene_expr_recon_loss: 34642621.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14761016.0000; val_global_loss: 52286651.2000; val_optim_loss: 52286651.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9662; val_auprc_score: 0.9598; val_best_acc_score: 0.9099; val_best_f1_score: 0.9138; train_kl_reg_loss: 111130.1827; train_edge_recon_loss: 2764952.6565; train_gene_expr_recon_loss: 34454418.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14563270.6794; train_global_loss: 51893771.8473; train_optim_loss: 51893771.8473; val_kl_reg_loss: 109201.8161; val_edge_recon_loss: 2764231.8167; val_gene_expr_recon_loss: 34401595.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14606940.0000; val_global_loss: 51881968.5333; val_optim_loss: 51881968.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9694; val_auprc_score: 0.9651; val_best_acc_score: 0.9115; val_best_f1_score: 0.9140; train_kl_reg_loss: 109671.5166; train_edge_recon_loss: 2748207.6527; train_gene_expr_recon_loss: 34367028.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14536066.5267; train_global_loss: 51760973.8321; train_optim_loss: 51760973.8321; val_kl_reg_loss: 110386.2609; val_edge_recon_loss: 2766320.8333; val_gene_expr_recon_loss: 34504729.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14681593.0000; val_global_loss: 52063029.3333; val_optim_loss: 52063029.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9671; val_auprc_score: 0.9616; val_best_acc_score: 0.9093; val_best_f1_score: 0.9117; train_kl_reg_loss: 108268.8856; train_edge_recon_loss: 2748782.8893; train_gene_expr_recon_loss: 34323621.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14525681.9084; train_global_loss: 51706355.1450; train_optim_loss: 51706355.1450; val_kl_reg_loss: 106989.1568; val_edge_recon_loss: 2792449.1500; val_gene_expr_recon_loss: 34398933.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14650315.2667; val_global_loss: 51948686.4000; val_optim_loss: 51948686.4000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9705; val_auprc_score: 0.9650; val_best_acc_score: 0.9132; val_best_f1_score: 0.9152; train_kl_reg_loss: 108594.4239; train_edge_recon_loss: 2771092.8664; train_gene_expr_recon_loss: 34994467.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14681567.7176; train_global_loss: 52555722.3206; train_optim_loss: 52555722.3206; val_kl_reg_loss: 75429.2443; val_edge_recon_loss: 2760806.3667; val_gene_expr_recon_loss: 34872500.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14765753.2000; val_global_loss: 52474488.8000; val_optim_loss: 52474488.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9726; val_auprc_score: 0.9658; val_best_acc_score: 0.9213; val_best_f1_score: 0.9231; train_kl_reg_loss: 108738.0562; train_edge_recon_loss: 2754888.3397; train_gene_expr_recon_loss: 34870134.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14654784.9847; train_global_loss: 52388545.7710; train_optim_loss: 52388545.7710; val_kl_reg_loss: 76623.1417; val_edge_recon_loss: 2748569.5000; val_gene_expr_recon_loss: 34947599.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14797724.8667; val_global_loss: 52570516.8000; val_optim_loss: 52570516.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9718; val_auprc_score: 0.9673; val_best_acc_score: 0.9178; val_best_f1_score: 0.9203; train_kl_reg_loss: 106965.9451; train_edge_recon_loss: 2752216.6240; train_gene_expr_recon_loss: 34757274.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14623954.3511; train_global_loss: 52240411.3588; train_optim_loss: 52240411.3588; val_kl_reg_loss: 79086.0505; val_edge_recon_loss: 2745611.9000; val_gene_expr_recon_loss: 34903834.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14741380.3333; val_global_loss: 52469912.8000; val_optim_loss: 52469912.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9716; val_auprc_score: 0.9641; val_best_acc_score: 0.9194; val_best_f1_score: 0.9210; train_kl_reg_loss: 107436.7867; train_edge_recon_loss: 2750940.0057; train_gene_expr_recon_loss: 34747332.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14605926.4962; train_global_loss: 52211636.1527; train_optim_loss: 52211636.1527; val_kl_reg_loss: 79046.5729; val_edge_recon_loss: 2762687.3000; val_gene_expr_recon_loss: 34786280.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14715070.1333; val_global_loss: 52343084.5333; val_optim_loss: 52343084.5333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9677; val_auprc_score: 0.9612; val_best_acc_score: 0.9113; val_best_f1_score: 0.9131; train_kl_reg_loss: 107059.5382; train_edge_recon_loss: 2742148.6966; train_gene_expr_recon_loss: 34741451.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14620947.0534; train_global_loss: 52211606.3206; train_optim_loss: 52211606.3206; val_kl_reg_loss: 79953.2937; val_edge_recon_loss: 2773792.3167; val_gene_expr_recon_loss: 34872734.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14755403.2000; val_global_loss: 52481882.9333; val_optim_loss: 52481882.9333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9726; val_auprc_score: 0.9678; val_best_acc_score: 0.9206; val_best_f1_score: 0.9216; train_kl_reg_loss: 106746.8478; train_edge_recon_loss: 2748434.7214; train_gene_expr_recon_loss: 34784437.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14645867.9618; train_global_loss: 52285486.8702; train_optim_loss: 52285486.8702; val_kl_reg_loss: 79909.9776; val_edge_recon_loss: 2739665.3167; val_gene_expr_recon_loss: 34801876.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14735931.8667; val_global_loss: 52357383.2000; val_optim_loss: 52357383.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 30 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9667
val AUPRC score: 0.9609
val best accuracy score: 0.9089
val best F1 score: 0.9102
val target rna MSE score: 1.0041
val source rna MSE score: 39.9344
val target atac MSE score: 0.3487
val source atac MSE score: 3.0225
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
