[True]
Run timestamp: 02082023_022119_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '5', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8754; val_auprc_score: 0.9740; val_best_acc_score: 0.8734; val_best_f1_score: 0.9300; train_kl_reg_loss: 42818.9636; train_edge_recon_loss: 112787.0142; train_gene_expr_recon_loss: 2354334.3006; train_masked_gp_l1_reg_loss: 9989.2108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35901.6634; train_global_loss: 2555831.1484; train_optim_loss: 2555831.1484; val_kl_reg_loss: 29091.4491; val_edge_recon_loss: 108976.1766; val_gene_expr_recon_loss: 2004799.9987; val_masked_gp_l1_reg_loss: 11728.0479; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26694.7754; val_global_loss: 2181290.3871; val_optim_loss: 2181290.3871
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9136; val_auprc_score: 0.9821; val_best_acc_score: 0.9046; val_best_f1_score: 0.9461; train_kl_reg_loss: 25010.6414; train_edge_recon_loss: 101813.3699; train_gene_expr_recon_loss: 1903404.8796; train_masked_gp_l1_reg_loss: 13120.2212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22164.6035; train_global_loss: 2065513.7170; train_optim_loss: 2065513.7170; val_kl_reg_loss: 21998.8790; val_edge_recon_loss: 97927.9525; val_gene_expr_recon_loss: 1817114.3065; val_masked_gp_l1_reg_loss: 14191.5137; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18584.9785; val_global_loss: 1969817.6398; val_optim_loss: 1969817.6398
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9308; val_auprc_score: 0.9848; val_best_acc_score: 0.9236; val_best_f1_score: 0.9561; train_kl_reg_loss: 19332.5214; train_edge_recon_loss: 95195.4173; train_gene_expr_recon_loss: 1754646.1042; train_masked_gp_l1_reg_loss: 14651.9028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16407.6018; train_global_loss: 1900233.5484; train_optim_loss: 1900233.5484; val_kl_reg_loss: 17307.8554; val_edge_recon_loss: 93266.2310; val_gene_expr_recon_loss: 1700050.7876; val_masked_gp_l1_reg_loss: 14742.8311; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14643.0762; val_global_loss: 1840010.8817; val_optim_loss: 1840010.8817
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9400; val_auprc_score: 0.9871; val_best_acc_score: 0.9286; val_best_f1_score: 0.9590; train_kl_reg_loss: 14993.4803; train_edge_recon_loss: 90191.7287; train_gene_expr_recon_loss: 1657807.1788; train_masked_gp_l1_reg_loss: 14062.9829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13391.6586; train_global_loss: 1790447.0287; train_optim_loss: 1790447.0287; val_kl_reg_loss: 13092.8364; val_edge_recon_loss: 88177.0419; val_gene_expr_recon_loss: 1619627.2876; val_masked_gp_l1_reg_loss: 13009.1162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12260.1680; val_global_loss: 1746166.4194; val_optim_loss: 1746166.4194
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9438; val_auprc_score: 0.9876; val_best_acc_score: 0.9326; val_best_f1_score: 0.9612; train_kl_reg_loss: 12036.5587; train_edge_recon_loss: 85971.6938; train_gene_expr_recon_loss: 1591066.2142; train_masked_gp_l1_reg_loss: 11766.0382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11287.4697; train_global_loss: 1712127.9760; train_optim_loss: 1712127.9760; val_kl_reg_loss: 11227.6350; val_edge_recon_loss: 85827.2768; val_gene_expr_recon_loss: 1563752.6290; val_masked_gp_l1_reg_loss: 10646.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10364.4033; val_global_loss: 1681818.1626; val_optim_loss: 1681818.1626
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9501; val_auprc_score: 0.9888; val_best_acc_score: 0.9388; val_best_f1_score: 0.9647; train_kl_reg_loss: 10666.1033; train_edge_recon_loss: 84401.3033; train_gene_expr_recon_loss: 1543414.3006; train_masked_gp_l1_reg_loss: 9898.0489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9534.5709; train_global_loss: 1657914.3238; train_optim_loss: 1657914.3238; val_kl_reg_loss: 10465.8288; val_edge_recon_loss: 83546.4260; val_gene_expr_recon_loss: 1524362.0565; val_masked_gp_l1_reg_loss: 9315.4893; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8782.1299; val_global_loss: 1636471.9368; val_optim_loss: 1636471.9368
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9534; val_auprc_score: 0.9900; val_best_acc_score: 0.9411; val_best_f1_score: 0.9661; train_kl_reg_loss: 9944.0394; train_edge_recon_loss: 82421.1000; train_gene_expr_recon_loss: 1508387.3740; train_masked_gp_l1_reg_loss: 9010.0849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8135.8586; train_global_loss: 1617898.4597; train_optim_loss: 1617898.4597; val_kl_reg_loss: 9662.3907; val_edge_recon_loss: 81466.6822; val_gene_expr_recon_loss: 1493497.7984; val_masked_gp_l1_reg_loss: 8768.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7562.2729; val_global_loss: 1600958.1196; val_optim_loss: 1600958.1196
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9513; val_auprc_score: 0.9890; val_best_acc_score: 0.9423; val_best_f1_score: 0.9667; train_kl_reg_loss: 9502.5662; train_edge_recon_loss: 82116.5664; train_gene_expr_recon_loss: 1483880.9241; train_masked_gp_l1_reg_loss: 8627.2567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7138.6683; train_global_loss: 1591265.9834; train_optim_loss: 1591265.9834; val_kl_reg_loss: 9300.7656; val_edge_recon_loss: 82253.6062; val_gene_expr_recon_loss: 1473637.5780; val_masked_gp_l1_reg_loss: 8489.5361; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6807.6406; val_global_loss: 1580489.0712; val_optim_loss: 1580489.0712
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9534; val_auprc_score: 0.9892; val_best_acc_score: 0.9442; val_best_f1_score: 0.9679; train_kl_reg_loss: 9229.8993; train_edge_recon_loss: 81228.0316; train_gene_expr_recon_loss: 1466165.1487; train_masked_gp_l1_reg_loss: 8392.3602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6622.2278; train_global_loss: 1571637.6668; train_optim_loss: 1571637.6668; val_kl_reg_loss: 8991.7506; val_edge_recon_loss: 79597.6387; val_gene_expr_recon_loss: 1459340.8401; val_masked_gp_l1_reg_loss: 8311.5645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6495.0674; val_global_loss: 1562736.9798; val_optim_loss: 1562736.9798
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9583; val_auprc_score: 0.9906; val_best_acc_score: 0.9460; val_best_f1_score: 0.9688; train_kl_reg_loss: 9064.2900; train_edge_recon_loss: 81260.5434; train_gene_expr_recon_loss: 1453495.5578; train_masked_gp_l1_reg_loss: 8198.6743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6351.3324; train_global_loss: 1558370.3958; train_optim_loss: 1558370.3958; val_kl_reg_loss: 8917.9121; val_edge_recon_loss: 80960.2080; val_gene_expr_recon_loss: 1447537.7903; val_masked_gp_l1_reg_loss: 8086.7393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6202.6992; val_global_loss: 1551705.4126; val_optim_loss: 1551705.4126
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9582; val_auprc_score: 0.9904; val_best_acc_score: 0.9464; val_best_f1_score: 0.9690; train_kl_reg_loss: 8964.4239; train_edge_recon_loss: 81711.8424; train_gene_expr_recon_loss: 1444985.2848; train_masked_gp_l1_reg_loss: 8030.9000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6072.1256; train_global_loss: 1549764.5751; train_optim_loss: 1549764.5751; val_kl_reg_loss: 8961.0745; val_edge_recon_loss: 80854.8032; val_gene_expr_recon_loss: 1441796.2608; val_masked_gp_l1_reg_loss: 7970.7510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5944.1943; val_global_loss: 1545527.1371; val_optim_loss: 1545527.1371
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9569; val_auprc_score: 0.9901; val_best_acc_score: 0.9462; val_best_f1_score: 0.9688; train_kl_reg_loss: 8879.3489; train_edge_recon_loss: 80109.4704; train_gene_expr_recon_loss: 1439598.8849; train_masked_gp_l1_reg_loss: 7912.1184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5821.4173; train_global_loss: 1542321.2363; train_optim_loss: 1542321.2363; val_kl_reg_loss: 8866.8989; val_edge_recon_loss: 80186.6714; val_gene_expr_recon_loss: 1438517.7204; val_masked_gp_l1_reg_loss: 7872.6782; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5694.2383; val_global_loss: 1541138.1640; val_optim_loss: 1541138.1640
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9606; val_auprc_score: 0.9911; val_best_acc_score: 0.9486; val_best_f1_score: 0.9702; train_kl_reg_loss: 8816.5104; train_edge_recon_loss: 80944.1338; train_gene_expr_recon_loss: 1435448.2106; train_masked_gp_l1_reg_loss: 7811.2707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5593.9758; train_global_loss: 1538614.0992; train_optim_loss: 1538614.0992; val_kl_reg_loss: 8817.9074; val_edge_recon_loss: 81649.5954; val_gene_expr_recon_loss: 1433026.0323; val_masked_gp_l1_reg_loss: 7767.7441; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5494.5889; val_global_loss: 1536755.9099; val_optim_loss: 1536755.9099
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9557; val_auprc_score: 0.9899; val_best_acc_score: 0.9464; val_best_f1_score: 0.9690; train_kl_reg_loss: 8753.5600; train_edge_recon_loss: 80457.7581; train_gene_expr_recon_loss: 1432360.5508; train_masked_gp_l1_reg_loss: 7724.3872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5402.5926; train_global_loss: 1534698.8441; train_optim_loss: 1534698.8441; val_kl_reg_loss: 8729.1890; val_edge_recon_loss: 80655.6078; val_gene_expr_recon_loss: 1430855.9247; val_masked_gp_l1_reg_loss: 7653.5620; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5324.7246; val_global_loss: 1533218.9704; val_optim_loss: 1533218.9704
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9607; val_auprc_score: 0.9911; val_best_acc_score: 0.9493; val_best_f1_score: 0.9706; train_kl_reg_loss: 8714.5141; train_edge_recon_loss: 80389.2874; train_gene_expr_recon_loss: 1429991.5031; train_masked_gp_l1_reg_loss: 7646.8179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5264.9124; train_global_loss: 1532007.0382; train_optim_loss: 1532007.0382; val_kl_reg_loss: 8736.3211; val_edge_recon_loss: 80649.5551; val_gene_expr_recon_loss: 1429436.9812; val_masked_gp_l1_reg_loss: 7614.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5204.2900; val_global_loss: 1531641.2352; val_optim_loss: 1531641.2352
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9559; val_auprc_score: 0.9902; val_best_acc_score: 0.9474; val_best_f1_score: 0.9697; train_kl_reg_loss: 8671.1115; train_edge_recon_loss: 80462.6259; train_gene_expr_recon_loss: 1427892.0548; train_masked_gp_l1_reg_loss: 7582.5252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5135.2688; train_global_loss: 1529743.5838; train_optim_loss: 1529743.5838; val_kl_reg_loss: 8769.1390; val_edge_recon_loss: 80944.0836; val_gene_expr_recon_loss: 1429159.3320; val_masked_gp_l1_reg_loss: 7546.8994; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5063.4160; val_global_loss: 1531482.8051; val_optim_loss: 1531482.8051
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9563; val_auprc_score: 0.9898; val_best_acc_score: 0.9482; val_best_f1_score: 0.9700; train_kl_reg_loss: 8634.1258; train_edge_recon_loss: 80053.2099; train_gene_expr_recon_loss: 1426517.6829; train_masked_gp_l1_reg_loss: 7521.3911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4991.3366; train_global_loss: 1527717.7497; train_optim_loss: 1527717.7497; val_kl_reg_loss: 8511.6822; val_edge_recon_loss: 80908.7404; val_gene_expr_recon_loss: 1424637.9341; val_masked_gp_l1_reg_loss: 7499.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4902.8154; val_global_loss: 1526460.8629; val_optim_loss: 1526460.8629
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9566; val_auprc_score: 0.9902; val_best_acc_score: 0.9457; val_best_f1_score: 0.9687; train_kl_reg_loss: 8590.0293; train_edge_recon_loss: 80142.6281; train_gene_expr_recon_loss: 1426015.6399; train_masked_gp_l1_reg_loss: 7482.1186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4828.6007; train_global_loss: 1527059.0167; train_optim_loss: 1527059.0167; val_kl_reg_loss: 8541.5712; val_edge_recon_loss: 79709.4134; val_gene_expr_recon_loss: 1428519.1425; val_masked_gp_l1_reg_loss: 7476.4580; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4748.9077; val_global_loss: 1528995.5094; val_optim_loss: 1528995.5094
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9599; val_auprc_score: 0.9905; val_best_acc_score: 0.9504; val_best_f1_score: 0.9712; train_kl_reg_loss: 8570.3992; train_edge_recon_loss: 79569.9044; train_gene_expr_recon_loss: 1425364.4101; train_masked_gp_l1_reg_loss: 7455.5367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4682.6628; train_global_loss: 1525642.9138; train_optim_loss: 1525642.9138; val_kl_reg_loss: 8560.3599; val_edge_recon_loss: 79654.2587; val_gene_expr_recon_loss: 1425642.0323; val_masked_gp_l1_reg_loss: 7449.4854; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4610.6572; val_global_loss: 1525916.7755; val_optim_loss: 1525916.7755
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9624; val_auprc_score: 0.9911; val_best_acc_score: 0.9509; val_best_f1_score: 0.9715; train_kl_reg_loss: 8555.9635; train_edge_recon_loss: 79601.2665; train_gene_expr_recon_loss: 1424665.4277; train_masked_gp_l1_reg_loss: 7429.1454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4549.3042; train_global_loss: 1524801.1063; train_optim_loss: 1524801.1063; val_kl_reg_loss: 8673.0255; val_edge_recon_loss: 81442.7727; val_gene_expr_recon_loss: 1426464.7003; val_masked_gp_l1_reg_loss: 7446.5825; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4493.6357; val_global_loss: 1528520.7473; val_optim_loss: 1528520.7473
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9588; val_auprc_score: 0.9904; val_best_acc_score: 0.9504; val_best_f1_score: 0.9713; train_kl_reg_loss: 8538.0381; train_edge_recon_loss: 79641.0847; train_gene_expr_recon_loss: 1424452.6831; train_masked_gp_l1_reg_loss: 7416.2155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4433.7392; train_global_loss: 1524481.7587; train_optim_loss: 1524481.7587; val_kl_reg_loss: 8382.4068; val_edge_recon_loss: 79621.3939; val_gene_expr_recon_loss: 1423346.4556; val_masked_gp_l1_reg_loss: 7410.3564; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4378.4141; val_global_loss: 1523139.0121; val_optim_loss: 1523139.0121
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9584; val_auprc_score: 0.9897; val_best_acc_score: 0.9504; val_best_f1_score: 0.9714; train_kl_reg_loss: 8508.8277; train_edge_recon_loss: 80069.4044; train_gene_expr_recon_loss: 1423903.4912; train_masked_gp_l1_reg_loss: 7405.8923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4324.5420; train_global_loss: 1524212.1520; train_optim_loss: 1524212.1520; val_kl_reg_loss: 8573.1739; val_edge_recon_loss: 78901.5798; val_gene_expr_recon_loss: 1424946.9288; val_masked_gp_l1_reg_loss: 7406.1318; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4282.0581; val_global_loss: 1524109.8051; val_optim_loss: 1524109.8051
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9609; val_auprc_score: 0.9912; val_best_acc_score: 0.9500; val_best_f1_score: 0.9711; train_kl_reg_loss: 8488.1659; train_edge_recon_loss: 79128.2763; train_gene_expr_recon_loss: 1423801.9501; train_masked_gp_l1_reg_loss: 7401.9333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4229.9088; train_global_loss: 1523050.2348; train_optim_loss: 1523050.2348; val_kl_reg_loss: 8452.7096; val_edge_recon_loss: 78743.4102; val_gene_expr_recon_loss: 1423238.8239; val_masked_gp_l1_reg_loss: 7381.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4170.3794; val_global_loss: 1521986.5712; val_optim_loss: 1521986.5712
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9610; val_auprc_score: 0.9911; val_best_acc_score: 0.9489; val_best_f1_score: 0.9704; train_kl_reg_loss: 8480.3854; train_edge_recon_loss: 79690.0195; train_gene_expr_recon_loss: 1423451.7979; train_masked_gp_l1_reg_loss: 7401.3616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4141.9658; train_global_loss: 1523165.5308; train_optim_loss: 1523165.5308; val_kl_reg_loss: 8305.5159; val_edge_recon_loss: 80095.2326; val_gene_expr_recon_loss: 1424584.1156; val_masked_gp_l1_reg_loss: 7409.6924; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4107.4048; val_global_loss: 1524501.9960; val_optim_loss: 1524501.9960
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9613; val_auprc_score: 0.9907; val_best_acc_score: 0.9513; val_best_f1_score: 0.9717; train_kl_reg_loss: 8474.3044; train_edge_recon_loss: 79436.0224; train_gene_expr_recon_loss: 1423753.0860; train_masked_gp_l1_reg_loss: 7404.7834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4072.8864; train_global_loss: 1523141.0856; train_optim_loss: 1523141.0856; val_kl_reg_loss: 8421.9010; val_edge_recon_loss: 80787.7384; val_gene_expr_recon_loss: 1423290.8212; val_masked_gp_l1_reg_loss: 7417.2144; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4038.2080; val_global_loss: 1523955.9516; val_optim_loss: 1523955.9516
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9578; val_auprc_score: 0.9906; val_best_acc_score: 0.9445; val_best_f1_score: 0.9679; train_kl_reg_loss: 7745.4988; train_edge_recon_loss: 79476.1579; train_gene_expr_recon_loss: 1425720.7894; train_masked_gp_l1_reg_loss: 7301.7049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4004.1954; train_global_loss: 1524248.3468; train_optim_loss: 1524248.3468; val_kl_reg_loss: 7589.3032; val_edge_recon_loss: 80511.9050; val_gene_expr_recon_loss: 1428286.3185; val_masked_gp_l1_reg_loss: 7288.6089; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3967.1912; val_global_loss: 1527643.4005; val_optim_loss: 1527643.4005
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9538; val_auprc_score: 0.9890; val_best_acc_score: 0.9461; val_best_f1_score: 0.9688; train_kl_reg_loss: 7656.2344; train_edge_recon_loss: 79421.4698; train_gene_expr_recon_loss: 1425571.5986; train_masked_gp_l1_reg_loss: 7293.6890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3940.5423; train_global_loss: 1523883.5341; train_optim_loss: 1523883.5341; val_kl_reg_loss: 7742.5310; val_edge_recon_loss: 81294.2817; val_gene_expr_recon_loss: 1426847.6882; val_masked_gp_l1_reg_loss: 7316.8467; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3920.1147; val_global_loss: 1527121.5027; val_optim_loss: 1527121.5027

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9583; val_auprc_score: 0.9909; val_best_acc_score: 0.9457; val_best_f1_score: 0.9687; train_kl_reg_loss: 9358.2370; train_edge_recon_loss: 89303.0817; train_gene_expr_recon_loss: 1940694.2154; train_masked_gp_l1_reg_loss: 7558.9895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3525.4883; train_global_loss: 2050440.0136; train_optim_loss: 2050440.0136; val_kl_reg_loss: 8793.5090; val_edge_recon_loss: 87824.4492; val_gene_expr_recon_loss: 1702626.9355; val_masked_gp_l1_reg_loss: 7689.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3197.8586; val_global_loss: 1810132.3965; val_optim_loss: 1810132.3965
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9604; val_auprc_score: 0.9914; val_best_acc_score: 0.9475; val_best_f1_score: 0.9697; train_kl_reg_loss: 9372.7213; train_edge_recon_loss: 85423.0563; train_gene_expr_recon_loss: 1662781.3675; train_masked_gp_l1_reg_loss: 7704.3121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2896.1563; train_global_loss: 1768177.6136; train_optim_loss: 1768177.6136; val_kl_reg_loss: 8529.0993; val_edge_recon_loss: 84216.8405; val_gene_expr_recon_loss: 1630399.9906; val_masked_gp_l1_reg_loss: 7702.4653; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2604.9963; val_global_loss: 1733453.4247; val_optim_loss: 1733453.4247
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9578; val_auprc_score: 0.9903; val_best_acc_score: 0.9479; val_best_f1_score: 0.9698; train_kl_reg_loss: 8904.2969; train_edge_recon_loss: 82755.7717; train_gene_expr_recon_loss: 1624337.9600; train_masked_gp_l1_reg_loss: 7679.3944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2338.2477; train_global_loss: 1726015.6698; train_optim_loss: 1726015.6698; val_kl_reg_loss: 8135.9621; val_edge_recon_loss: 83804.6298; val_gene_expr_recon_loss: 1618344.7567; val_masked_gp_l1_reg_loss: 7650.2690; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2083.1001; val_global_loss: 1720018.7272; val_optim_loss: 1720018.7272
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9598; val_auprc_score: 0.9899; val_best_acc_score: 0.9502; val_best_f1_score: 0.9712; train_kl_reg_loss: 8387.7053; train_edge_recon_loss: 81535.9488; train_gene_expr_recon_loss: 1614741.6196; train_masked_gp_l1_reg_loss: 7621.9895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1852.0458; train_global_loss: 1714139.3109; train_optim_loss: 1714139.3109; val_kl_reg_loss: 7713.6309; val_edge_recon_loss: 81869.2744; val_gene_expr_recon_loss: 1611865.5887; val_masked_gp_l1_reg_loss: 7589.4585; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1631.5626; val_global_loss: 1710669.6223; val_optim_loss: 1710669.6223

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 217 min 30 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9586
val AUPRC score: 0.9902
val best accuracy score: 0.9466
val best F1 score: 0.9692
val target rna MSE score: 1.0982
val source rna MSE score: 0.5275
Val cat covariate0 mean sim diff: -0.0016

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
