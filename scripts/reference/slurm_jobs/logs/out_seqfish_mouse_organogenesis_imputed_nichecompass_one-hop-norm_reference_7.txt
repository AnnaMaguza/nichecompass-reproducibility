[True]
Run timestamp: 01082023_060914_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9044; val_auprc_score: 0.9814; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 13974.8642; train_edge_recon_loss: 11411.0650; train_gene_expr_recon_loss: 500222.7378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58226.8916; train_global_loss: 583835.5584; train_optim_loss: 583835.5584; val_kl_reg_loss: 13476.8265; val_edge_recon_loss: 11950.2280; val_gene_expr_recon_loss: 421902.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52956.8125; val_global_loss: 500285.9740; val_optim_loss: 500285.9740
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8804; val_auprc_score: 0.9757; val_best_acc_score: 0.8511; val_best_f1_score: 0.9192; train_kl_reg_loss: 13559.3779; train_edge_recon_loss: 11681.1278; train_gene_expr_recon_loss: 384352.6887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48494.8830; train_global_loss: 458088.0770; train_optim_loss: 458088.0770; val_kl_reg_loss: 12547.8530; val_edge_recon_loss: 12415.5911; val_gene_expr_recon_loss: 332203.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44316.2422; val_global_loss: 401483.1510; val_optim_loss: 401483.1510
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8595; val_auprc_score: 0.9726; val_best_acc_score: 0.8638; val_best_f1_score: 0.9255; train_kl_reg_loss: 12651.2272; train_edge_recon_loss: 11486.3066; train_gene_expr_recon_loss: 283738.1097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40832.9042; train_global_loss: 348708.5486; train_optim_loss: 348708.5486; val_kl_reg_loss: 11875.0677; val_edge_recon_loss: 11869.2274; val_gene_expr_recon_loss: 250620.6849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37295.8398; val_global_loss: 311660.8229; val_optim_loss: 311660.8229
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8516; val_auprc_score: 0.9704; val_best_acc_score: 0.8695; val_best_f1_score: 0.9268; train_kl_reg_loss: 11867.1499; train_edge_recon_loss: 11479.8552; train_gene_expr_recon_loss: 241281.2387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34074.8159; train_global_loss: 298703.0579; train_optim_loss: 298703.0579; val_kl_reg_loss: 11005.2336; val_edge_recon_loss: 11697.3547; val_gene_expr_recon_loss: 234716.9245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30913.1348; val_global_loss: 288332.6458; val_optim_loss: 288332.6458
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8483; val_auprc_score: 0.9691; val_best_acc_score: 0.8785; val_best_f1_score: 0.9328; train_kl_reg_loss: 10857.8514; train_edge_recon_loss: 11480.9503; train_gene_expr_recon_loss: 232282.7297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28325.4951; train_global_loss: 282947.0266; train_optim_loss: 282947.0266; val_kl_reg_loss: 10064.6040; val_edge_recon_loss: 11750.6551; val_gene_expr_recon_loss: 228953.5286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25911.6406; val_global_loss: 276680.4271; val_optim_loss: 276680.4271
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8464; val_auprc_score: 0.9680; val_best_acc_score: 0.8729; val_best_f1_score: 0.9301; train_kl_reg_loss: 10084.3589; train_edge_recon_loss: 11381.5356; train_gene_expr_recon_loss: 227442.5367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24129.3415; train_global_loss: 273037.7743; train_optim_loss: 273037.7743; val_kl_reg_loss: 9416.3800; val_edge_recon_loss: 11689.0018; val_gene_expr_recon_loss: 225369.6510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22542.0605; val_global_loss: 269017.0833; val_optim_loss: 269017.0833
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8591; val_auprc_score: 0.9706; val_best_acc_score: 0.8734; val_best_f1_score: 0.9299; train_kl_reg_loss: 9472.4898; train_edge_recon_loss: 11286.9993; train_gene_expr_recon_loss: 223885.5483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21237.4083; train_global_loss: 265882.4456; train_optim_loss: 265882.4456; val_kl_reg_loss: 8878.4308; val_edge_recon_loss: 11669.0225; val_gene_expr_recon_loss: 221884.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19932.8320; val_global_loss: 262365.1094; val_optim_loss: 262365.1094
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8728; val_auprc_score: 0.9737; val_best_acc_score: 0.8766; val_best_f1_score: 0.9320; train_kl_reg_loss: 8970.7269; train_edge_recon_loss: 11230.4489; train_gene_expr_recon_loss: 220950.1253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18769.1999; train_global_loss: 259920.5017; train_optim_loss: 259920.5017; val_kl_reg_loss: 8468.3472; val_edge_recon_loss: 11601.5298; val_gene_expr_recon_loss: 219356.1380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17612.8125; val_global_loss: 257038.8307; val_optim_loss: 257038.8307
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8792; val_auprc_score: 0.9750; val_best_acc_score: 0.8813; val_best_f1_score: 0.9334; train_kl_reg_loss: 8568.9604; train_edge_recon_loss: 11288.5697; train_gene_expr_recon_loss: 218456.9225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16597.5439; train_global_loss: 254911.9968; train_optim_loss: 254911.9968; val_kl_reg_loss: 8109.6813; val_edge_recon_loss: 11427.3773; val_gene_expr_recon_loss: 216698.3307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15596.0449; val_global_loss: 251831.4349; val_optim_loss: 251831.4349
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8834; val_auprc_score: 0.9748; val_best_acc_score: 0.8821; val_best_f1_score: 0.9337; train_kl_reg_loss: 8243.2199; train_edge_recon_loss: 11149.0885; train_gene_expr_recon_loss: 216100.8799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14728.2891; train_global_loss: 250221.4766; train_optim_loss: 250221.4766; val_kl_reg_loss: 7847.6326; val_edge_recon_loss: 11437.1413; val_gene_expr_recon_loss: 214477.7786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13875.0400; val_global_loss: 247637.5990; val_optim_loss: 247637.5990
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8877; val_auprc_score: 0.9765; val_best_acc_score: 0.8843; val_best_f1_score: 0.9342; train_kl_reg_loss: 7971.5837; train_edge_recon_loss: 11133.8523; train_gene_expr_recon_loss: 214045.1753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13139.6729; train_global_loss: 246290.2833; train_optim_loss: 246290.2833; val_kl_reg_loss: 7609.9200; val_edge_recon_loss: 11435.4198; val_gene_expr_recon_loss: 212566.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12419.1455; val_global_loss: 244030.8724; val_optim_loss: 244030.8724
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8940; val_auprc_score: 0.9771; val_best_acc_score: 0.8882; val_best_f1_score: 0.9358; train_kl_reg_loss: 7747.8134; train_edge_recon_loss: 11083.0665; train_gene_expr_recon_loss: 212053.2063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11798.5701; train_global_loss: 242682.6557; train_optim_loss: 242682.6557; val_kl_reg_loss: 7362.8914; val_edge_recon_loss: 11680.4648; val_gene_expr_recon_loss: 210496.4870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11192.5928; val_global_loss: 240732.4375; val_optim_loss: 240732.4375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8943; val_auprc_score: 0.9784; val_best_acc_score: 0.8899; val_best_f1_score: 0.9366; train_kl_reg_loss: 7546.1556; train_edge_recon_loss: 11008.8612; train_gene_expr_recon_loss: 210230.2972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10667.8354; train_global_loss: 239453.1513; train_optim_loss: 239453.1513; val_kl_reg_loss: 7205.5429; val_edge_recon_loss: 11391.9717; val_gene_expr_recon_loss: 209041.6510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10157.2500; val_global_loss: 237796.4167; val_optim_loss: 237796.4167
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8941; val_auprc_score: 0.9766; val_best_acc_score: 0.8919; val_best_f1_score: 0.9374; train_kl_reg_loss: 7370.7204; train_edge_recon_loss: 11050.8830; train_gene_expr_recon_loss: 208376.5200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9726.2155; train_global_loss: 236524.3388; train_optim_loss: 236524.3388; val_kl_reg_loss: 6997.1095; val_edge_recon_loss: 11569.5798; val_gene_expr_recon_loss: 207114.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9305.3340; val_global_loss: 234986.5885; val_optim_loss: 234986.5885
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9067; val_auprc_score: 0.9804; val_best_acc_score: 0.8922; val_best_f1_score: 0.9370; train_kl_reg_loss: 7202.7785; train_edge_recon_loss: 10930.1908; train_gene_expr_recon_loss: 206600.7954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8946.5126; train_global_loss: 233680.2775; train_optim_loss: 233680.2775; val_kl_reg_loss: 6850.4526; val_edge_recon_loss: 11736.1410; val_gene_expr_recon_loss: 205458.6589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8596.5322; val_global_loss: 232641.7865; val_optim_loss: 232641.7865
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9032; val_auprc_score: 0.9794; val_best_acc_score: 0.8924; val_best_f1_score: 0.9376; train_kl_reg_loss: 7043.2644; train_edge_recon_loss: 10982.1371; train_gene_expr_recon_loss: 204931.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8298.0860; train_global_loss: 231254.7532; train_optim_loss: 231254.7532; val_kl_reg_loss: 6650.2190; val_edge_recon_loss: 11755.4204; val_gene_expr_recon_loss: 203653.7786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8010.9277; val_global_loss: 230070.3359; val_optim_loss: 230070.3359
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9140; val_auprc_score: 0.9826; val_best_acc_score: 0.8995; val_best_f1_score: 0.9412; train_kl_reg_loss: 6873.3400; train_edge_recon_loss: 11005.9662; train_gene_expr_recon_loss: 203269.5990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7759.0523; train_global_loss: 228907.9566; train_optim_loss: 228907.9566; val_kl_reg_loss: 6556.6953; val_edge_recon_loss: 11319.0366; val_gene_expr_recon_loss: 202024.8021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7515.6543; val_global_loss: 227416.1927; val_optim_loss: 227416.1927
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9069; val_auprc_score: 0.9807; val_best_acc_score: 0.8955; val_best_f1_score: 0.9400; train_kl_reg_loss: 6710.2271; train_edge_recon_loss: 10941.8812; train_gene_expr_recon_loss: 201603.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7303.9853; train_global_loss: 226559.9965; train_optim_loss: 226559.9965; val_kl_reg_loss: 6399.5994; val_edge_recon_loss: 11347.5680; val_gene_expr_recon_loss: 200027.8464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7096.6987; val_global_loss: 224871.7188; val_optim_loss: 224871.7188
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9131; val_auprc_score: 0.9824; val_best_acc_score: 0.8980; val_best_f1_score: 0.9413; train_kl_reg_loss: 6544.6476; train_edge_recon_loss: 10925.1973; train_gene_expr_recon_loss: 200089.7471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6912.4842; train_global_loss: 224472.0758; train_optim_loss: 224472.0758; val_kl_reg_loss: 6225.5278; val_edge_recon_loss: 11352.0314; val_gene_expr_recon_loss: 198938.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6729.9619; val_global_loss: 223246.3542; val_optim_loss: 223246.3542
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9124; val_auprc_score: 0.9824; val_best_acc_score: 0.8995; val_best_f1_score: 0.9419; train_kl_reg_loss: 6367.8939; train_edge_recon_loss: 10895.8573; train_gene_expr_recon_loss: 198684.8675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6566.8820; train_global_loss: 222515.5006; train_optim_loss: 222515.5006; val_kl_reg_loss: 6096.3158; val_edge_recon_loss: 11221.4780; val_gene_expr_recon_loss: 197317.8411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6404.1865; val_global_loss: 221039.8229; val_optim_loss: 221039.8229
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9145; val_auprc_score: 0.9822; val_best_acc_score: 0.9003; val_best_f1_score: 0.9422; train_kl_reg_loss: 6191.9622; train_edge_recon_loss: 10928.6766; train_gene_expr_recon_loss: 197238.9233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6254.9918; train_global_loss: 220614.5544; train_optim_loss: 220614.5544; val_kl_reg_loss: 5953.7811; val_edge_recon_loss: 11174.6410; val_gene_expr_recon_loss: 196197.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6104.8838; val_global_loss: 219431.0052; val_optim_loss: 219431.0052
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9183; val_auprc_score: 0.9823; val_best_acc_score: 0.9018; val_best_f1_score: 0.9424; train_kl_reg_loss: 6015.5164; train_edge_recon_loss: 10727.7975; train_gene_expr_recon_loss: 195891.6542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5967.0695; train_global_loss: 218602.0388; train_optim_loss: 218602.0388; val_kl_reg_loss: 5670.1172; val_edge_recon_loss: 11646.2479; val_gene_expr_recon_loss: 194901.7604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5826.0596; val_global_loss: 218044.1849; val_optim_loss: 218044.1849
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9202; val_auprc_score: 0.9832; val_best_acc_score: 0.9017; val_best_f1_score: 0.9429; train_kl_reg_loss: 5833.4420; train_edge_recon_loss: 10812.1745; train_gene_expr_recon_loss: 194598.4300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5698.0300; train_global_loss: 216942.0773; train_optim_loss: 216942.0773; val_kl_reg_loss: 5559.7858; val_edge_recon_loss: 11330.8509; val_gene_expr_recon_loss: 193254.7448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5569.4277; val_global_loss: 215714.8047; val_optim_loss: 215714.8047
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9182; val_auprc_score: 0.9839; val_best_acc_score: 0.9021; val_best_f1_score: 0.9437; train_kl_reg_loss: 5651.4413; train_edge_recon_loss: 10886.8064; train_gene_expr_recon_loss: 193319.3461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5450.4567; train_global_loss: 215308.0495; train_optim_loss: 215308.0495; val_kl_reg_loss: 5367.4248; val_edge_recon_loss: 10944.2765; val_gene_expr_recon_loss: 192004.3620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5330.5010; val_global_loss: 213646.5651; val_optim_loss: 213646.5651
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9233; val_auprc_score: 0.9845; val_best_acc_score: 0.9031; val_best_f1_score: 0.9437; train_kl_reg_loss: 5463.1064; train_edge_recon_loss: 10733.9584; train_gene_expr_recon_loss: 192147.8142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5223.5116; train_global_loss: 213568.3906; train_optim_loss: 213568.3906; val_kl_reg_loss: 5169.5173; val_edge_recon_loss: 11284.1125; val_gene_expr_recon_loss: 191063.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5114.9429; val_global_loss: 212632.2057; val_optim_loss: 212632.2057
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9132; val_auprc_score: 0.9820; val_best_acc_score: 0.9012; val_best_f1_score: 0.9423; train_kl_reg_loss: 4012.4789; train_edge_recon_loss: 10856.8948; train_gene_expr_recon_loss: 333664.1059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4449.7856; train_global_loss: 352983.2662; train_optim_loss: 352983.2662; val_kl_reg_loss: 3370.1291; val_edge_recon_loss: 11281.6006; val_gene_expr_recon_loss: 290528.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3681.1558; val_global_loss: 308861.6042; val_optim_loss: 308861.6042
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9192; val_auprc_score: 0.9836; val_best_acc_score: 0.9028; val_best_f1_score: 0.9439; train_kl_reg_loss: 3356.9111; train_edge_recon_loss: 10550.6909; train_gene_expr_recon_loss: 266570.8238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3116.0936; train_global_loss: 283594.5208; train_optim_loss: 283594.5208; val_kl_reg_loss: 2947.8179; val_edge_recon_loss: 10971.6216; val_gene_expr_recon_loss: 246805.0052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2635.7288; val_global_loss: 263360.1693; val_optim_loss: 263360.1693
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9183; val_auprc_score: 0.9822; val_best_acc_score: 0.9080; val_best_f1_score: 0.9466; train_kl_reg_loss: 2963.9803; train_edge_recon_loss: 10396.8127; train_gene_expr_recon_loss: 234366.7141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2333.1648; train_global_loss: 250060.6719; train_optim_loss: 250060.6719; val_kl_reg_loss: 2629.5942; val_edge_recon_loss: 10678.3512; val_gene_expr_recon_loss: 224028.3880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2078.4524; val_global_loss: 239414.7865; val_optim_loss: 239414.7865
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9241; val_auprc_score: 0.9833; val_best_acc_score: 0.9136; val_best_f1_score: 0.9502; train_kl_reg_loss: 2682.4198; train_edge_recon_loss: 10142.3825; train_gene_expr_recon_loss: 217613.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1906.3461; train_global_loss: 232344.6299; train_optim_loss: 232344.6299; val_kl_reg_loss: 2421.3839; val_edge_recon_loss: 10403.1284; val_gene_expr_recon_loss: 211349.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1751.9583; val_global_loss: 225925.7057; val_optim_loss: 225925.7057

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9304; val_auprc_score: 0.9857; val_best_acc_score: 0.9185; val_best_f1_score: 0.9531; train_kl_reg_loss: 2555.5974; train_edge_recon_loss: 9939.2061; train_gene_expr_recon_loss: 211535.7862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1708.7240; train_global_loss: 225739.3139; train_optim_loss: 225739.3139; val_kl_reg_loss: 2411.5029; val_edge_recon_loss: 10043.8242; val_gene_expr_recon_loss: 210476.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1688.8092; val_global_loss: 224620.3984; val_optim_loss: 224620.3984
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9251; val_auprc_score: 0.9847; val_best_acc_score: 0.9164; val_best_f1_score: 0.9522; train_kl_reg_loss: 2536.3990; train_edge_recon_loss: 9985.4439; train_gene_expr_recon_loss: 210685.0463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1675.8309; train_global_loss: 224882.7199; train_optim_loss: 224882.7199; val_kl_reg_loss: 2389.4928; val_edge_recon_loss: 10000.4609; val_gene_expr_recon_loss: 209919.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1662.6106; val_global_loss: 223971.8776; val_optim_loss: 223971.8776
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9305; val_auprc_score: 0.9852; val_best_acc_score: 0.9171; val_best_f1_score: 0.9520; train_kl_reg_loss: 2518.7751; train_edge_recon_loss: 9936.8830; train_gene_expr_recon_loss: 209929.9135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1650.0051; train_global_loss: 224035.5752; train_optim_loss: 224035.5752; val_kl_reg_loss: 2377.6614; val_edge_recon_loss: 10297.4624; val_gene_expr_recon_loss: 208926.9635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1637.0105; val_global_loss: 223239.1042; val_optim_loss: 223239.1042
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9302; val_auprc_score: 0.9847; val_best_acc_score: 0.9154; val_best_f1_score: 0.9509; train_kl_reg_loss: 2499.0006; train_edge_recon_loss: 9951.3657; train_gene_expr_recon_loss: 209162.7503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1624.4891; train_global_loss: 223237.6039; train_optim_loss: 223237.6039; val_kl_reg_loss: 2361.1783; val_edge_recon_loss: 10535.0199; val_gene_expr_recon_loss: 208069.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1611.4846; val_global_loss: 222577.3802; val_optim_loss: 222577.3802

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 56 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9235
val AUPRC score: 0.9835
val best accuracy score: 0.9045
val best F1 score: 0.9447
val target rna MSE score: 20.4265
val source rna MSE score: 108.1191
Val cat covariate0 mean sim diff: -0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
