[True]
Run timestamp: 10082023_200806_29.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_29']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6701; val_auprc_score: 0.7204; val_best_acc_score: 0.5088; val_best_f1_score: 0.6673; train_kl_reg_loss: 95545.9735; train_edge_recon_loss: 3697959.1985; train_gene_expr_recon_loss: 27299363.5420; train_masked_gp_l1_reg_loss: 78958.9782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 242930.9689; train_chrom_access_recon_loss: 4147225.0706; train_global_loss: 35561983.9084; train_optim_loss: 35561983.9084; val_kl_reg_loss: 93448.3443; val_edge_recon_loss: 4064278.7833; val_gene_expr_recon_loss: 24125292.6667; val_masked_gp_l1_reg_loss: 82215.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 234603.3750; val_chrom_access_recon_loss: 3964373.5667; val_global_loss: 32564213.4667; val_optim_loss: 32564213.4667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7598; val_auprc_score: 0.7767; val_best_acc_score: 0.6524; val_best_f1_score: 0.7191; train_kl_reg_loss: 150478.9529; train_edge_recon_loss: 3605436.5668; train_gene_expr_recon_loss: 23264646.1527; train_masked_gp_l1_reg_loss: 81531.1700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224450.9380; train_chrom_access_recon_loss: 3888712.7290; train_global_loss: 31215256.4580; train_optim_loss: 31215256.4580; val_kl_reg_loss: 157340.7354; val_edge_recon_loss: 4054382.4500; val_gene_expr_recon_loss: 22579683.7333; val_masked_gp_l1_reg_loss: 77922.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213591.6562; val_chrom_access_recon_loss: 3863909.5167; val_global_loss: 30946830.1333; val_optim_loss: 30946830.1333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7798; val_auprc_score: 0.7843; val_best_acc_score: 0.6905; val_best_f1_score: 0.7268; train_kl_reg_loss: 146867.5164; train_edge_recon_loss: 3545898.5878; train_gene_expr_recon_loss: 22261948.5954; train_masked_gp_l1_reg_loss: 75941.6087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 203020.4714; train_chrom_access_recon_loss: 3795063.6698; train_global_loss: 30028740.4580; train_optim_loss: 30028740.4580; val_kl_reg_loss: 133170.6833; val_edge_recon_loss: 4010473.4500; val_gene_expr_recon_loss: 22344646.0000; val_masked_gp_l1_reg_loss: 75403.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192662.1719; val_chrom_access_recon_loss: 3846115.3000; val_global_loss: 30602471.7333; val_optim_loss: 30602471.7333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8238; val_auprc_score: 0.8328; val_best_acc_score: 0.7354; val_best_f1_score: 0.7554; train_kl_reg_loss: 125762.7951; train_edge_recon_loss: 3506109.1145; train_gene_expr_recon_loss: 22044165.5878; train_masked_gp_l1_reg_loss: 76237.1053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183352.9306; train_chrom_access_recon_loss: 3774858.8721; train_global_loss: 29710486.2901; train_optim_loss: 29710486.2901; val_kl_reg_loss: 105163.5839; val_edge_recon_loss: 3695991.5500; val_gene_expr_recon_loss: 22205991.8667; val_masked_gp_l1_reg_loss: 77695.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174373.1875; val_chrom_access_recon_loss: 3827601.2500; val_global_loss: 30086818.5333; val_optim_loss: 30086818.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8482; val_auprc_score: 0.8493; val_best_acc_score: 0.7617; val_best_f1_score: 0.7688; train_kl_reg_loss: 108897.4569; train_edge_recon_loss: 3287398.4408; train_gene_expr_recon_loss: 21889420.1832; train_masked_gp_l1_reg_loss: 79906.3550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166690.8397; train_chrom_access_recon_loss: 3755837.0172; train_global_loss: 29288150.3511; train_optim_loss: 29288150.3511; val_kl_reg_loss: 124939.6521; val_edge_recon_loss: 3208086.4833; val_gene_expr_recon_loss: 21991629.7333; val_masked_gp_l1_reg_loss: 81836.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159578.9844; val_chrom_access_recon_loss: 3812175.1167; val_global_loss: 29378244.8000; val_optim_loss: 29378244.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8870; val_auprc_score: 0.8774; val_best_acc_score: 0.7928; val_best_f1_score: 0.8134; train_kl_reg_loss: 130873.2907; train_edge_recon_loss: 3054762.3302; train_gene_expr_recon_loss: 21722545.1450; train_masked_gp_l1_reg_loss: 83843.9982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153400.1849; train_chrom_access_recon_loss: 3736817.0076; train_global_loss: 28882241.7710; train_optim_loss: 28882241.7710; val_kl_reg_loss: 144619.3010; val_edge_recon_loss: 2979822.1667; val_gene_expr_recon_loss: 21810481.6000; val_masked_gp_l1_reg_loss: 85361.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147230.7344; val_chrom_access_recon_loss: 3767256.2167; val_global_loss: 28934771.2000; val_optim_loss: 28934771.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8872; val_auprc_score: 0.8749; val_best_acc_score: 0.7978; val_best_f1_score: 0.8193; train_kl_reg_loss: 143140.9228; train_edge_recon_loss: 2939072.9179; train_gene_expr_recon_loss: 21624577.3893; train_masked_gp_l1_reg_loss: 86928.2696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141291.1138; train_chrom_access_recon_loss: 3726554.5973; train_global_loss: 28661565.4351; train_optim_loss: 28661565.4351; val_kl_reg_loss: 143326.0073; val_edge_recon_loss: 2979124.7000; val_gene_expr_recon_loss: 21734505.4667; val_masked_gp_l1_reg_loss: 88068.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135518.8125; val_chrom_access_recon_loss: 3766747.1667; val_global_loss: 28847288.9333; val_optim_loss: 28847288.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9019; val_auprc_score: 0.8890; val_best_acc_score: 0.8196; val_best_f1_score: 0.8302; train_kl_reg_loss: 140154.2951; train_edge_recon_loss: 2919190.9408; train_gene_expr_recon_loss: 21494110.4427; train_masked_gp_l1_reg_loss: 89364.6125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130488.5728; train_chrom_access_recon_loss: 3713674.4389; train_global_loss: 28486983.2672; train_optim_loss: 28486983.2672; val_kl_reg_loss: 142390.0823; val_edge_recon_loss: 2912473.7500; val_gene_expr_recon_loss: 21659328.9333; val_masked_gp_l1_reg_loss: 90507.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125574.9531; val_chrom_access_recon_loss: 3760239.3500; val_global_loss: 28690514.2667; val_optim_loss: 28690514.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9089; val_auprc_score: 0.8913; val_best_acc_score: 0.8362; val_best_f1_score: 0.8431; train_kl_reg_loss: 135496.6944; train_edge_recon_loss: 2896033.5172; train_gene_expr_recon_loss: 21396121.1450; train_masked_gp_l1_reg_loss: 91731.9906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121030.5253; train_chrom_access_recon_loss: 3697405.9408; train_global_loss: 28337819.8473; train_optim_loss: 28337819.8473; val_kl_reg_loss: 135421.4380; val_edge_recon_loss: 2897794.1500; val_gene_expr_recon_loss: 21479144.1333; val_masked_gp_l1_reg_loss: 92954.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116611.9766; val_chrom_access_recon_loss: 3732876.9500; val_global_loss: 28454802.9333; val_optim_loss: 28454802.9333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9127; val_auprc_score: 0.9003; val_best_acc_score: 0.8345; val_best_f1_score: 0.8462; train_kl_reg_loss: 135171.8311; train_edge_recon_loss: 2867976.2557; train_gene_expr_recon_loss: 21309555.0992; train_masked_gp_l1_reg_loss: 94042.9361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112310.4077; train_chrom_access_recon_loss: 3690079.7519; train_global_loss: 28209136.2290; train_optim_loss: 28209136.2290; val_kl_reg_loss: 132783.9380; val_edge_recon_loss: 2877111.6167; val_gene_expr_recon_loss: 21408967.7333; val_masked_gp_l1_reg_loss: 95158.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108167.6719; val_chrom_access_recon_loss: 3723479.8167; val_global_loss: 28345668.8000; val_optim_loss: 28345668.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9167; val_auprc_score: 0.9024; val_best_acc_score: 0.8455; val_best_f1_score: 0.8563; train_kl_reg_loss: 129290.2520; train_edge_recon_loss: 2849686.5305; train_gene_expr_recon_loss: 21228857.4962; train_masked_gp_l1_reg_loss: 96141.2962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104396.5935; train_chrom_access_recon_loss: 3679405.8721; train_global_loss: 28087778.1069; train_optim_loss: 28087778.1069; val_kl_reg_loss: 124838.9443; val_edge_recon_loss: 2877087.7667; val_gene_expr_recon_loss: 21357805.3333; val_masked_gp_l1_reg_loss: 97384.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100646.1641; val_chrom_access_recon_loss: 3716517.2167; val_global_loss: 28274279.3333; val_optim_loss: 28274279.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9249; val_auprc_score: 0.9103; val_best_acc_score: 0.8538; val_best_f1_score: 0.8622; train_kl_reg_loss: 125574.6819; train_edge_recon_loss: 2849829.9160; train_gene_expr_recon_loss: 21174397.0229; train_masked_gp_l1_reg_loss: 98305.8614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97279.4612; train_chrom_access_recon_loss: 3672489.9466; train_global_loss: 28017876.9160; train_optim_loss: 28017876.9160; val_kl_reg_loss: 127097.8125; val_edge_recon_loss: 2856793.4667; val_gene_expr_recon_loss: 21351992.4000; val_masked_gp_l1_reg_loss: 99270.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94021.3125; val_chrom_access_recon_loss: 3722437.3667; val_global_loss: 28251613.0667; val_optim_loss: 28251613.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9289; val_auprc_score: 0.9163; val_best_acc_score: 0.8570; val_best_f1_score: 0.8668; train_kl_reg_loss: 125245.8670; train_edge_recon_loss: 2823236.8569; train_gene_expr_recon_loss: 21121327.8931; train_masked_gp_l1_reg_loss: 100158.4764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91085.6663; train_chrom_access_recon_loss: 3664847.3855; train_global_loss: 27925902.1679; train_optim_loss: 27925902.1679; val_kl_reg_loss: 121315.6026; val_edge_recon_loss: 2833937.0500; val_gene_expr_recon_loss: 21218815.3333; val_masked_gp_l1_reg_loss: 100972.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88285.2266; val_chrom_access_recon_loss: 3692921.6000; val_global_loss: 28056247.6000; val_optim_loss: 28056247.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9302; val_auprc_score: 0.9106; val_best_acc_score: 0.8608; val_best_f1_score: 0.8698; train_kl_reg_loss: 121421.9871; train_edge_recon_loss: 2816461.1279; train_gene_expr_recon_loss: 21038902.4733; train_masked_gp_l1_reg_loss: 101941.2208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85840.6817; train_chrom_access_recon_loss: 3650218.5401; train_global_loss: 27814786.1527; train_optim_loss: 27814786.1527; val_kl_reg_loss: 120050.7089; val_edge_recon_loss: 2818045.9500; val_gene_expr_recon_loss: 21253979.6000; val_masked_gp_l1_reg_loss: 103478.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83531.6172; val_chrom_access_recon_loss: 3703642.1000; val_global_loss: 28082728.2667; val_optim_loss: 28082728.2667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9398; val_auprc_score: 0.9289; val_best_acc_score: 0.8708; val_best_f1_score: 0.8780; train_kl_reg_loss: 119164.4923; train_edge_recon_loss: 2811524.7156; train_gene_expr_recon_loss: 20963776.0305; train_masked_gp_l1_reg_loss: 104114.5084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81267.4538; train_chrom_access_recon_loss: 3645156.2576; train_global_loss: 27725003.5725; train_optim_loss: 27725003.5725; val_kl_reg_loss: 122954.3146; val_edge_recon_loss: 2791618.9167; val_gene_expr_recon_loss: 21198550.4000; val_masked_gp_l1_reg_loss: 104950.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79116.7109; val_chrom_access_recon_loss: 3699223.0667; val_global_loss: 27996412.8000; val_optim_loss: 27996412.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9407; val_auprc_score: 0.9279; val_best_acc_score: 0.8727; val_best_f1_score: 0.8821; train_kl_reg_loss: 115592.4613; train_edge_recon_loss: 2799828.9962; train_gene_expr_recon_loss: 20939074.4427; train_masked_gp_l1_reg_loss: 105409.6688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77041.7256; train_chrom_access_recon_loss: 3641953.5763; train_global_loss: 27678900.8855; train_optim_loss: 27678900.8855; val_kl_reg_loss: 115624.5422; val_edge_recon_loss: 2807649.3833; val_gene_expr_recon_loss: 21089731.4667; val_masked_gp_l1_reg_loss: 106398.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75057.2344; val_chrom_access_recon_loss: 3684448.6500; val_global_loss: 27878910.0000; val_optim_loss: 27878910.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9425; val_auprc_score: 0.9270; val_best_acc_score: 0.8782; val_best_f1_score: 0.8841; train_kl_reg_loss: 116083.7142; train_edge_recon_loss: 2793990.5286; train_gene_expr_recon_loss: 20909130.5802; train_masked_gp_l1_reg_loss: 106965.3601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73192.3766; train_chrom_access_recon_loss: 3639687.1221; train_global_loss: 27639049.8931; train_optim_loss: 27639049.8931; val_kl_reg_loss: 116846.0266; val_edge_recon_loss: 2804593.8667; val_gene_expr_recon_loss: 21014915.4667; val_masked_gp_l1_reg_loss: 107742.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71308.4219; val_chrom_access_recon_loss: 3673294.9333; val_global_loss: 27788700.2667; val_optim_loss: 27788700.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9468; val_auprc_score: 0.9352; val_best_acc_score: 0.8783; val_best_f1_score: 0.8812; train_kl_reg_loss: 113221.6855; train_edge_recon_loss: 2786445.8473; train_gene_expr_recon_loss: 20854974.3206; train_masked_gp_l1_reg_loss: 108448.0909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69709.3835; train_chrom_access_recon_loss: 3631372.9656; train_global_loss: 27564172.1985; train_optim_loss: 27564172.1985; val_kl_reg_loss: 112640.7760; val_edge_recon_loss: 2812385.4833; val_gene_expr_recon_loss: 20949344.1333; val_masked_gp_l1_reg_loss: 108981.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67970.4297; val_chrom_access_recon_loss: 3663704.5000; val_global_loss: 27715027.0667; val_optim_loss: 27715027.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9520; val_auprc_score: 0.9420; val_best_acc_score: 0.8864; val_best_f1_score: 0.8914; train_kl_reg_loss: 111374.5912; train_edge_recon_loss: 2780834.1889; train_gene_expr_recon_loss: 20830255.0382; train_masked_gp_l1_reg_loss: 109845.9516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66409.1541; train_chrom_access_recon_loss: 3629242.1832; train_global_loss: 27527961.2061; train_optim_loss: 27527961.2061; val_kl_reg_loss: 112383.0365; val_edge_recon_loss: 2789098.6167; val_gene_expr_recon_loss: 20961981.4667; val_masked_gp_l1_reg_loss: 110530.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64812.1328; val_chrom_access_recon_loss: 3679619.6833; val_global_loss: 27718424.8000; val_optim_loss: 27718424.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9537; val_auprc_score: 0.9429; val_best_acc_score: 0.8917; val_best_f1_score: 0.8956; train_kl_reg_loss: 111387.9768; train_edge_recon_loss: 2771341.7805; train_gene_expr_recon_loss: 20820527.2366; train_masked_gp_l1_reg_loss: 111350.7423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63357.2589; train_chrom_access_recon_loss: 3627882.2996; train_global_loss: 27505847.2214; train_optim_loss: 27505847.2214; val_kl_reg_loss: 111690.5672; val_edge_recon_loss: 2762262.3667; val_gene_expr_recon_loss: 20949833.7333; val_masked_gp_l1_reg_loss: 112035.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61890.6719; val_chrom_access_recon_loss: 3665675.1333; val_global_loss: 27663387.8667; val_optim_loss: 27663387.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9564; val_auprc_score: 0.9447; val_best_acc_score: 0.8957; val_best_f1_score: 0.8997; train_kl_reg_loss: 109073.9804; train_edge_recon_loss: 2772581.9160; train_gene_expr_recon_loss: 20776358.5038; train_masked_gp_l1_reg_loss: 112751.5482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60528.2179; train_chrom_access_recon_loss: 3621903.7233; train_global_loss: 27453197.8626; train_optim_loss: 27453197.8626; val_kl_reg_loss: 111229.0766; val_edge_recon_loss: 2766838.7167; val_gene_expr_recon_loss: 20999501.6000; val_masked_gp_l1_reg_loss: 113616.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59251.8203; val_chrom_access_recon_loss: 3682983.1333; val_global_loss: 27733420.4000; val_optim_loss: 27733420.4000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9617; val_auprc_score: 0.9541; val_best_acc_score: 0.9031; val_best_f1_score: 0.9062; train_kl_reg_loss: 108658.4478; train_edge_recon_loss: 2762169.7805; train_gene_expr_recon_loss: 20736505.3130; train_masked_gp_l1_reg_loss: 114239.5318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58065.5273; train_chrom_access_recon_loss: 3615480.0496; train_global_loss: 27395118.6718; train_optim_loss: 27395118.6718; val_kl_reg_loss: 110312.2927; val_edge_recon_loss: 2756421.7333; val_gene_expr_recon_loss: 20995557.7333; val_masked_gp_l1_reg_loss: 114981.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56745.1797; val_chrom_access_recon_loss: 3676037.1000; val_global_loss: 27710056.9333; val_optim_loss: 27710056.9333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9581; val_auprc_score: 0.9457; val_best_acc_score: 0.8971; val_best_f1_score: 0.8993; train_kl_reg_loss: 107037.7781; train_edge_recon_loss: 2753421.6508; train_gene_expr_recon_loss: 20719352.9924; train_masked_gp_l1_reg_loss: 115489.8531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55684.9652; train_chrom_access_recon_loss: 3614459.9676; train_global_loss: 27365447.0382; train_optim_loss: 27365447.0382; val_kl_reg_loss: 109931.3406; val_edge_recon_loss: 2777603.5333; val_gene_expr_recon_loss: 20929371.2000; val_masked_gp_l1_reg_loss: 116230.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54595.7656; val_chrom_access_recon_loss: 3674085.9500; val_global_loss: 27661818.0000; val_optim_loss: 27661818.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9672; val_auprc_score: 0.9598; val_best_acc_score: 0.9096; val_best_f1_score: 0.9117; train_kl_reg_loss: 105821.0956; train_edge_recon_loss: 2745293.9103; train_gene_expr_recon_loss: 20684955.5115; train_masked_gp_l1_reg_loss: 116821.6051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53672.3822; train_chrom_access_recon_loss: 3612497.3359; train_global_loss: 27319061.6183; train_optim_loss: 27319061.6183; val_kl_reg_loss: 106477.3307; val_edge_recon_loss: 2748033.3667; val_gene_expr_recon_loss: 20897065.0667; val_masked_gp_l1_reg_loss: 117525.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52738.5664; val_chrom_access_recon_loss: 3658306.8833; val_global_loss: 27580146.4000; val_optim_loss: 27580146.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9639; val_auprc_score: 0.9538; val_best_acc_score: 0.9082; val_best_f1_score: 0.9106; train_kl_reg_loss: 103869.1299; train_edge_recon_loss: 2754053.9179; train_gene_expr_recon_loss: 20683930.1527; train_masked_gp_l1_reg_loss: 118102.9987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51920.3382; train_chrom_access_recon_loss: 3613889.8340; train_global_loss: 27325766.3206; train_optim_loss: 27325766.3206; val_kl_reg_loss: 104214.9078; val_edge_recon_loss: 2763191.3833; val_gene_expr_recon_loss: 20964082.0000; val_masked_gp_l1_reg_loss: 118838.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51123.0195; val_chrom_access_recon_loss: 3663808.8333; val_global_loss: 27665258.9333; val_optim_loss: 27665258.9333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9564; val_auprc_score: 0.9513; val_best_acc_score: 0.8942; val_best_f1_score: 0.8963; train_kl_reg_loss: 124548.6672; train_edge_recon_loss: 2882519.8855; train_gene_expr_recon_loss: 22039304.1985; train_masked_gp_l1_reg_loss: 120674.7770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52607.3273; train_chrom_access_recon_loss: 3715608.5973; train_global_loss: 28935263.3130; train_optim_loss: 28935263.3130; val_kl_reg_loss: 22914.2905; val_edge_recon_loss: 2896003.4833; val_gene_expr_recon_loss: 22410241.0667; val_masked_gp_l1_reg_loss: 122810.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52721.2656; val_chrom_access_recon_loss: 3803262.6500; val_global_loss: 29307953.6000; val_optim_loss: 29307953.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9257; val_auprc_score: 0.9080; val_best_acc_score: 0.8545; val_best_f1_score: 0.8611; train_kl_reg_loss: 121883.3188; train_edge_recon_loss: 2892065.6260; train_gene_expr_recon_loss: 22993194.9618; train_masked_gp_l1_reg_loss: 124720.3455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53986.6401; train_chrom_access_recon_loss: 3785584.4523; train_global_loss: 29971435.2824; train_optim_loss: 29971435.2824; val_kl_reg_loss: 22293.9400; val_edge_recon_loss: 2898424.4500; val_gene_expr_recon_loss: 23679625.3333; val_masked_gp_l1_reg_loss: 125484.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55549.1094; val_chrom_access_recon_loss: 3822426.7167; val_global_loss: 30603804.5333; val_optim_loss: 30603804.5333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9220; val_auprc_score: 0.9055; val_best_acc_score: 0.8486; val_best_f1_score: 0.8609; train_kl_reg_loss: 90469.6822; train_edge_recon_loss: 2881211.9676; train_gene_expr_recon_loss: 23659222.3969; train_masked_gp_l1_reg_loss: 123352.5411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53860.4170; train_chrom_access_recon_loss: 3792484.6584; train_global_loss: 30600601.4962; train_optim_loss: 30600601.4962; val_kl_reg_loss: 19936.0693; val_edge_recon_loss: 2830892.1000; val_gene_expr_recon_loss: 23771618.8000; val_masked_gp_l1_reg_loss: 120993.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52497.5469; val_chrom_access_recon_loss: 3838996.4333; val_global_loss: 30634935.2000; val_optim_loss: 30634935.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9279; val_auprc_score: 0.9132; val_best_acc_score: 0.8556; val_best_f1_score: 0.8640; train_kl_reg_loss: 68761.4949; train_edge_recon_loss: 2812469.6641; train_gene_expr_recon_loss: 23578182.5344; train_masked_gp_l1_reg_loss: 120452.6814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52184.1458; train_chrom_access_recon_loss: 3783173.8798; train_global_loss: 30415224.3817; train_optim_loss: 30415224.3817; val_kl_reg_loss: 21953.2763; val_edge_recon_loss: 2820556.6167; val_gene_expr_recon_loss: 23766812.4000; val_masked_gp_l1_reg_loss: 120154.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51925.4453; val_chrom_access_recon_loss: 3838285.1333; val_global_loss: 30619686.8000; val_optim_loss: 30619686.8000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9233; val_auprc_score: 0.9083; val_best_acc_score: 0.8492; val_best_f1_score: 0.8587; train_kl_reg_loss: 69391.0845; train_edge_recon_loss: 2798336.2309; train_gene_expr_recon_loss: 23516838.9160; train_masked_gp_l1_reg_loss: 119868.9704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51697.3669; train_chrom_access_recon_loss: 3775771.4905; train_global_loss: 30331904.1069; train_optim_loss: 30331904.1069; val_kl_reg_loss: 23552.7410; val_edge_recon_loss: 2805864.1167; val_gene_expr_recon_loss: 23686527.8667; val_masked_gp_l1_reg_loss: 119577.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51467.9258; val_chrom_access_recon_loss: 3824875.2667; val_global_loss: 30511866.1333; val_optim_loss: 30511866.1333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9286; val_auprc_score: 0.9152; val_best_acc_score: 0.8533; val_best_f1_score: 0.8634; train_kl_reg_loss: 69155.8287; train_edge_recon_loss: 2800300.0267; train_gene_expr_recon_loss: 23479567.1298; train_masked_gp_l1_reg_loss: 119270.5952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51245.1110; train_chrom_access_recon_loss: 3772771.6469; train_global_loss: 30292310.3511; train_optim_loss: 30292310.3511; val_kl_reg_loss: 24576.3992; val_edge_recon_loss: 2796574.5500; val_gene_expr_recon_loss: 23714768.6667; val_masked_gp_l1_reg_loss: 118955.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51005.7695; val_chrom_access_recon_loss: 3833782.1667; val_global_loss: 30539663.8667; val_optim_loss: 30539663.8667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9273; val_auprc_score: 0.9103; val_best_acc_score: 0.8562; val_best_f1_score: 0.8668; train_kl_reg_loss: 68442.7365; train_edge_recon_loss: 2795901.9924; train_gene_expr_recon_loss: 23477127.1908; train_masked_gp_l1_reg_loss: 118625.8630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50783.2357; train_chrom_access_recon_loss: 3776368.6775; train_global_loss: 30287249.5267; train_optim_loss: 30287249.5267; val_kl_reg_loss: 26031.6937; val_edge_recon_loss: 2763662.1000; val_gene_expr_recon_loss: 23667846.4000; val_masked_gp_l1_reg_loss: 118286.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50562.6914; val_chrom_access_recon_loss: 3814757.0333; val_global_loss: 30441145.2000; val_optim_loss: 30441145.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 19 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9651
val AUPRC score: 0.9562
val best accuracy score: 0.9093
val best F1 score: 0.9112
val target rna MSE score: 2.0190
val source rna MSE score: 1682.8957
val target atac MSE score: 0.5981
val source atac MSE score: 6.6441
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
