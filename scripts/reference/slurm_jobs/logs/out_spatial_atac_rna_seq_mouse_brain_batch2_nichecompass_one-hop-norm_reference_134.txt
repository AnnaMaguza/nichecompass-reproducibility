[True]
Run timestamp: 07082023_213719_134.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_134']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8892; val_auprc_score: 0.9011; val_best_acc_score: 0.5387; val_best_f1_score: 0.6838; train_kl_reg_loss: 40353.3417; train_edge_recon_loss: 3474532.6944; train_gene_expr_recon_loss: 1272187.9722; train_masked_gp_l1_reg_loss: 16223.4697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119359.9566; train_chrom_access_recon_loss: 2729168.8889; train_global_loss: 7651826.5000; train_optim_loss: 7651826.5000; val_kl_reg_loss: 6945.5068; val_edge_recon_loss: 4062559.0000; val_gene_expr_recon_loss: 1113196.5000; val_masked_gp_l1_reg_loss: 11654.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117163.3438; val_chrom_access_recon_loss: 1551164.6250; val_global_loss: 6862683.5000; val_optim_loss: 6862683.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8947; val_auprc_score: 0.9053; val_best_acc_score: 0.5371; val_best_f1_score: 0.6831; train_kl_reg_loss: 7194.4009; train_edge_recon_loss: 3471282.3611; train_gene_expr_recon_loss: 1052724.0556; train_masked_gp_l1_reg_loss: 9714.8343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115834.7135; train_chrom_access_recon_loss: 1512934.8194; train_global_loss: 6169685.1111; train_optim_loss: 6169685.1111; val_kl_reg_loss: 5091.4844; val_edge_recon_loss: 4062834.7500; val_gene_expr_recon_loss: 973518.8750; val_masked_gp_l1_reg_loss: 8134.4722; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114224.7812; val_chrom_access_recon_loss: 1439150.1250; val_global_loss: 6602954.5000; val_optim_loss: 6602954.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8935; val_auprc_score: 0.9038; val_best_acc_score: 0.5349; val_best_f1_score: 0.6823; train_kl_reg_loss: 6338.2645; train_edge_recon_loss: 3474049.6667; train_gene_expr_recon_loss: 950034.3194; train_masked_gp_l1_reg_loss: 7970.6522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112966.9271; train_chrom_access_recon_loss: 1442064.3333; train_global_loss: 5993424.2778; train_optim_loss: 5993424.2778; val_kl_reg_loss: 7204.8750; val_edge_recon_loss: 4063059.0000; val_gene_expr_recon_loss: 905669.1250; val_masked_gp_l1_reg_loss: 7779.2012; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111389.2266; val_chrom_access_recon_loss: 1411120.0000; val_global_loss: 6506221.0000; val_optim_loss: 6506221.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8842; val_auprc_score: 0.8941; val_best_acc_score: 0.5358; val_best_f1_score: 0.6822; train_kl_reg_loss: 10505.4846; train_edge_recon_loss: 3476826.0278; train_gene_expr_recon_loss: 888148.5556; train_masked_gp_l1_reg_loss: 7534.7936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110098.4922; train_chrom_access_recon_loss: 1410369.9444; train_global_loss: 5903483.3889; train_optim_loss: 5903483.3889; val_kl_reg_loss: 11257.9512; val_edge_recon_loss: 4062886.2500; val_gene_expr_recon_loss: 849738.6250; val_masked_gp_l1_reg_loss: 7330.5542; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108452.6562; val_chrom_access_recon_loss: 1382801.2500; val_global_loss: 6422467.0000; val_optim_loss: 6422467.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8719; val_auprc_score: 0.8827; val_best_acc_score: 0.5465; val_best_f1_score: 0.6864; train_kl_reg_loss: 15801.4502; train_edge_recon_loss: 3478442.6389; train_gene_expr_recon_loss: 839724.4097; train_masked_gp_l1_reg_loss: 7282.9949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107059.2795; train_chrom_access_recon_loss: 1394632.5972; train_global_loss: 5842943.5000; train_optim_loss: 5842943.5000; val_kl_reg_loss: 14817.8789; val_edge_recon_loss: 4062009.2500; val_gene_expr_recon_loss: 801541.8750; val_masked_gp_l1_reg_loss: 7241.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105250.5625; val_chrom_access_recon_loss: 1357014.0000; val_global_loss: 6347874.5000; val_optim_loss: 6347874.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8663; val_auprc_score: 0.8756; val_best_acc_score: 0.5710; val_best_f1_score: 0.6966; train_kl_reg_loss: 17067.1272; train_edge_recon_loss: 3479334.6389; train_gene_expr_recon_loss: 801177.1250; train_masked_gp_l1_reg_loss: 7262.1568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103685.3828; train_chrom_access_recon_loss: 1364138.5139; train_global_loss: 5772664.9444; train_optim_loss: 5772664.9444; val_kl_reg_loss: 16930.0234; val_edge_recon_loss: 4058264.5000; val_gene_expr_recon_loss: 773976.3125; val_masked_gp_l1_reg_loss: 7280.7720; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101658.6641; val_chrom_access_recon_loss: 1342127.6250; val_global_loss: 6300238.0000; val_optim_loss: 6300238.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8538; val_auprc_score: 0.8536; val_best_acc_score: 0.6252; val_best_f1_score: 0.7214; train_kl_reg_loss: 17786.3677; train_edge_recon_loss: 3480786.1389; train_gene_expr_recon_loss: 774220.4097; train_masked_gp_l1_reg_loss: 7332.2483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99943.0972; train_chrom_access_recon_loss: 1346566.7361; train_global_loss: 5726634.8333; train_optim_loss: 5726634.8333; val_kl_reg_loss: 17527.4121; val_edge_recon_loss: 4051369.2500; val_gene_expr_recon_loss: 754210.8125; val_masked_gp_l1_reg_loss: 7385.6611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97754.3359; val_chrom_access_recon_loss: 1332319.7500; val_global_loss: 6260567.0000; val_optim_loss: 6260567.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8468; val_auprc_score: 0.8406; val_best_acc_score: 0.7028; val_best_f1_score: 0.7603; train_kl_reg_loss: 19321.6712; train_edge_recon_loss: 3478900.0833; train_gene_expr_recon_loss: 757929.8264; train_masked_gp_l1_reg_loss: 7439.6998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95953.2995; train_chrom_access_recon_loss: 1343498.0556; train_global_loss: 5703042.5556; train_optim_loss: 5703042.5556; val_kl_reg_loss: 17611.7148; val_edge_recon_loss: 4036900.7500; val_gene_expr_recon_loss: 738242.5625; val_masked_gp_l1_reg_loss: 7504.1353; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93684.7578; val_chrom_access_recon_loss: 1326233.2500; val_global_loss: 6220177.0000; val_optim_loss: 6220177.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8511; val_auprc_score: 0.8378; val_best_acc_score: 0.7749; val_best_f1_score: 0.7908; train_kl_reg_loss: 18941.9418; train_edge_recon_loss: 3475633.8333; train_gene_expr_recon_loss: 744250.2083; train_masked_gp_l1_reg_loss: 7570.9044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91853.4401; train_chrom_access_recon_loss: 1344443.4306; train_global_loss: 5682693.7778; train_optim_loss: 5682693.7778; val_kl_reg_loss: 16355.5781; val_edge_recon_loss: 3996035.2500; val_gene_expr_recon_loss: 727018.2500; val_masked_gp_l1_reg_loss: 7648.7700; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89558.2109; val_chrom_access_recon_loss: 1321816.8750; val_global_loss: 6158433.0000; val_optim_loss: 6158433.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8438; val_auprc_score: 0.8261; val_best_acc_score: 0.7514; val_best_f1_score: 0.7857; train_kl_reg_loss: 16061.5730; train_edge_recon_loss: 3462484.1944; train_gene_expr_recon_loss: 733517.3472; train_masked_gp_l1_reg_loss: 7722.4555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87722.7821; train_chrom_access_recon_loss: 1332041.3750; train_global_loss: 5639549.5000; train_optim_loss: 5639549.5000; val_kl_reg_loss: 14038.6543; val_edge_recon_loss: 3860752.2500; val_gene_expr_recon_loss: 723094.3750; val_masked_gp_l1_reg_loss: 7798.6514; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85441.2812; val_chrom_access_recon_loss: 1319668.3750; val_global_loss: 6010794.0000; val_optim_loss: 6010794.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8468; val_auprc_score: 0.8299; val_best_acc_score: 0.7623; val_best_f1_score: 0.7885; train_kl_reg_loss: 11208.2130; train_edge_recon_loss: 3399246.2500; train_gene_expr_recon_loss: 738508.9028; train_masked_gp_l1_reg_loss: 7868.3885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83645.0278; train_chrom_access_recon_loss: 1335721.5694; train_global_loss: 5576198.3889; train_optim_loss: 5576198.3889; val_kl_reg_loss: 6515.3252; val_edge_recon_loss: 3388370.5000; val_gene_expr_recon_loss: 741681.6250; val_masked_gp_l1_reg_loss: 7959.2144; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81428.8438; val_chrom_access_recon_loss: 1324896.5000; val_global_loss: 5550852.0000; val_optim_loss: 5550852.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8380; val_auprc_score: 0.8277; val_best_acc_score: 0.7409; val_best_f1_score: 0.7732; train_kl_reg_loss: 9911.4177; train_edge_recon_loss: 3120539.1111; train_gene_expr_recon_loss: 781492.9722; train_masked_gp_l1_reg_loss: 8043.4632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79721.6875; train_chrom_access_recon_loss: 1347464.0972; train_global_loss: 5347172.7222; train_optim_loss: 5347172.7222; val_kl_reg_loss: 15060.0020; val_edge_recon_loss: 3015580.0000; val_gene_expr_recon_loss: 777565.7500; val_masked_gp_l1_reg_loss: 8109.9067; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77634.1719; val_chrom_access_recon_loss: 1335603.2500; val_global_loss: 5229553.0000; val_optim_loss: 5229553.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8561; val_auprc_score: 0.8454; val_best_acc_score: 0.7567; val_best_f1_score: 0.7815; train_kl_reg_loss: 24437.1623; train_edge_recon_loss: 2924797.3333; train_gene_expr_recon_loss: 779157.0278; train_masked_gp_l1_reg_loss: 8111.1813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76034.4878; train_chrom_access_recon_loss: 1340049.1944; train_global_loss: 5152586.5000; train_optim_loss: 5152586.5000; val_kl_reg_loss: 30012.7832; val_edge_recon_loss: 2949024.5000; val_gene_expr_recon_loss: 760290.3750; val_masked_gp_l1_reg_loss: 8116.8760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74066.5469; val_chrom_access_recon_loss: 1325745.5000; val_global_loss: 5147256.5000; val_optim_loss: 5147256.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8796; val_auprc_score: 0.8596; val_best_acc_score: 0.7976; val_best_f1_score: 0.8038; train_kl_reg_loss: 35593.2843; train_edge_recon_loss: 2885548.0556; train_gene_expr_recon_loss: 760636.9236; train_masked_gp_l1_reg_loss: 8127.6406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72551.5252; train_chrom_access_recon_loss: 1331449.5556; train_global_loss: 5093906.7778; train_optim_loss: 5093906.7778; val_kl_reg_loss: 35319.7266; val_edge_recon_loss: 2869034.7500; val_gene_expr_recon_loss: 744506.8750; val_masked_gp_l1_reg_loss: 8137.5518; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70672.8672; val_chrom_access_recon_loss: 1321018.7500; val_global_loss: 5048690.5000; val_optim_loss: 5048690.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8978; val_auprc_score: 0.8704; val_best_acc_score: 0.8331; val_best_f1_score: 0.8452; train_kl_reg_loss: 38078.6610; train_edge_recon_loss: 2831021.3611; train_gene_expr_recon_loss: 747893.8542; train_masked_gp_l1_reg_loss: 8147.6387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69207.7587; train_chrom_access_recon_loss: 1331952.4583; train_global_loss: 5026301.7778; train_optim_loss: 5026301.7778; val_kl_reg_loss: 34211.1797; val_edge_recon_loss: 2798535.5000; val_gene_expr_recon_loss: 738135.3750; val_masked_gp_l1_reg_loss: 8167.3584; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67392.3516; val_chrom_access_recon_loss: 1318100.1250; val_global_loss: 4964541.5000; val_optim_loss: 4964541.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9191; val_auprc_score: 0.8917; val_best_acc_score: 0.8556; val_best_f1_score: 0.8688; train_kl_reg_loss: 36663.2131; train_edge_recon_loss: 2761935.0000; train_gene_expr_recon_loss: 750940.2778; train_masked_gp_l1_reg_loss: 8200.0247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65985.1984; train_chrom_access_recon_loss: 1334804.7778; train_global_loss: 4958528.3889; train_optim_loss: 4958528.3889; val_kl_reg_loss: 34003.4844; val_edge_recon_loss: 2765479.7500; val_gene_expr_recon_loss: 733496.8750; val_masked_gp_l1_reg_loss: 8243.5088; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64253.5195; val_chrom_access_recon_loss: 1314063.3750; val_global_loss: 4919540.5000; val_optim_loss: 4919540.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9267; val_auprc_score: 0.9023; val_best_acc_score: 0.8680; val_best_f1_score: 0.8784; train_kl_reg_loss: 38300.1927; train_edge_recon_loss: 2740394.8889; train_gene_expr_recon_loss: 738877.0694; train_masked_gp_l1_reg_loss: 8284.9541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62926.6606; train_chrom_access_recon_loss: 1321977.4722; train_global_loss: 4910761.2222; train_optim_loss: 4910761.2222; val_kl_reg_loss: 37417.3750; val_edge_recon_loss: 2727221.0000; val_gene_expr_recon_loss: 725151.5625; val_masked_gp_l1_reg_loss: 8339.6963; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61292.9336; val_chrom_access_recon_loss: 1311377.2500; val_global_loss: 4870800.0000; val_optim_loss: 4870800.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9315; val_auprc_score: 0.9043; val_best_acc_score: 0.8756; val_best_f1_score: 0.8845; train_kl_reg_loss: 41746.1120; train_edge_recon_loss: 2733667.6389; train_gene_expr_recon_loss: 734792.3542; train_masked_gp_l1_reg_loss: 8358.8940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60024.2865; train_chrom_access_recon_loss: 1326734.7222; train_global_loss: 4905324.1111; train_optim_loss: 4905324.1111; val_kl_reg_loss: 39162.3125; val_edge_recon_loss: 2713405.0000; val_gene_expr_recon_loss: 720213.4375; val_masked_gp_l1_reg_loss: 8383.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58461.4062; val_chrom_access_recon_loss: 1307083.7500; val_global_loss: 4846709.0000; val_optim_loss: 4846709.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9346; val_auprc_score: 0.9106; val_best_acc_score: 0.8802; val_best_f1_score: 0.8877; train_kl_reg_loss: 41674.1250; train_edge_recon_loss: 2719752.4722; train_gene_expr_recon_loss: 727794.2500; train_masked_gp_l1_reg_loss: 8404.6342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57260.0668; train_chrom_access_recon_loss: 1317189.7222; train_global_loss: 4872075.3889; train_optim_loss: 4872075.3889; val_kl_reg_loss: 39012.7969; val_edge_recon_loss: 2712138.2500; val_gene_expr_recon_loss: 717440.2500; val_masked_gp_l1_reg_loss: 8415.4512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55785.5234; val_chrom_access_recon_loss: 1304711.1250; val_global_loss: 4837503.5000; val_optim_loss: 4837503.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9352; val_auprc_score: 0.9122; val_best_acc_score: 0.8797; val_best_f1_score: 0.8874; train_kl_reg_loss: 41351.7248; train_edge_recon_loss: 2722513.7778; train_gene_expr_recon_loss: 718591.9375; train_masked_gp_l1_reg_loss: 8438.1542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54661.8121; train_chrom_access_recon_loss: 1315232.5417; train_global_loss: 4860789.9444; train_optim_loss: 4860789.9444; val_kl_reg_loss: 38338.5469; val_edge_recon_loss: 2732529.7500; val_gene_expr_recon_loss: 714661.8750; val_masked_gp_l1_reg_loss: 8464.8223; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53283.0859; val_chrom_access_recon_loss: 1302746.3750; val_global_loss: 4850024.0000; val_optim_loss: 4850024.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9385; val_auprc_score: 0.9156; val_best_acc_score: 0.8855; val_best_f1_score: 0.8930; train_kl_reg_loss: 40463.3945; train_edge_recon_loss: 2721720.7222; train_gene_expr_recon_loss: 718831.1667; train_masked_gp_l1_reg_loss: 8479.9154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52234.4731; train_chrom_access_recon_loss: 1306661.0833; train_global_loss: 4848390.7222; train_optim_loss: 4848390.7222; val_kl_reg_loss: 38459.8281; val_edge_recon_loss: 2719179.7500; val_gene_expr_recon_loss: 709197.7500; val_masked_gp_l1_reg_loss: 8510.8154; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50948.4453; val_chrom_access_recon_loss: 1300449.1250; val_global_loss: 4826745.5000; val_optim_loss: 4826745.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9400; val_auprc_score: 0.9154; val_best_acc_score: 0.8872; val_best_f1_score: 0.8944; train_kl_reg_loss: 40428.4223; train_edge_recon_loss: 2716195.3611; train_gene_expr_recon_loss: 711731.0694; train_masked_gp_l1_reg_loss: 8530.3725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49966.1723; train_chrom_access_recon_loss: 1308796.0417; train_global_loss: 4835647.4444; train_optim_loss: 4835647.4444; val_kl_reg_loss: 38925.9023; val_edge_recon_loss: 2720202.0000; val_gene_expr_recon_loss: 705125.2500; val_masked_gp_l1_reg_loss: 8546.0654; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48756.3359; val_chrom_access_recon_loss: 1297665.8750; val_global_loss: 4819221.5000; val_optim_loss: 4819221.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9462; val_auprc_score: 0.9204; val_best_acc_score: 0.8945; val_best_f1_score: 0.9015; train_kl_reg_loss: 40112.9440; train_edge_recon_loss: 2722321.0278; train_gene_expr_recon_loss: 712545.3333; train_masked_gp_l1_reg_loss: 8557.9080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47827.0404; train_chrom_access_recon_loss: 1306465.2917; train_global_loss: 4837829.6111; train_optim_loss: 4837829.6111; val_kl_reg_loss: 37851.4492; val_edge_recon_loss: 2724467.7500; val_gene_expr_recon_loss: 702581.4375; val_masked_gp_l1_reg_loss: 8578.0811; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46686.5547; val_chrom_access_recon_loss: 1294626.7500; val_global_loss: 4814792.0000; val_optim_loss: 4814792.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9474; val_auprc_score: 0.9254; val_best_acc_score: 0.8965; val_best_f1_score: 0.9035; train_kl_reg_loss: 39682.6094; train_edge_recon_loss: 2719862.4722; train_gene_expr_recon_loss: 711462.9444; train_masked_gp_l1_reg_loss: 8601.4048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45816.6315; train_chrom_access_recon_loss: 1306153.1111; train_global_loss: 4831579.1111; train_optim_loss: 4831579.1111; val_kl_reg_loss: 37291.1250; val_edge_recon_loss: 2706506.0000; val_gene_expr_recon_loss: 701160.5625; val_masked_gp_l1_reg_loss: 8649.3994; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44747.5039; val_chrom_access_recon_loss: 1292997.2500; val_global_loss: 4791352.0000; val_optim_loss: 4791352.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9474; val_auprc_score: 0.9269; val_best_acc_score: 0.8932; val_best_f1_score: 0.8996; train_kl_reg_loss: 38935.2378; train_edge_recon_loss: 2727103.1944; train_gene_expr_recon_loss: 706233.4514; train_masked_gp_l1_reg_loss: 8672.2242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43938.2044; train_chrom_access_recon_loss: 1302597.7500; train_global_loss: 4827480.1111; train_optim_loss: 4827480.1111; val_kl_reg_loss: 37241.9609; val_edge_recon_loss: 2750496.7500; val_gene_expr_recon_loss: 696855.2500; val_masked_gp_l1_reg_loss: 8696.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42938.8867; val_chrom_access_recon_loss: 1290350.0000; val_global_loss: 4826580.0000; val_optim_loss: 4826580.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9510; val_auprc_score: 0.9358; val_best_acc_score: 0.8946; val_best_f1_score: 0.9007; train_kl_reg_loss: 37358.9084; train_edge_recon_loss: 2721753.0000; train_gene_expr_recon_loss: 959227.8403; train_masked_gp_l1_reg_loss: 8716.6676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42030.8685; train_chrom_access_recon_loss: 1390162.5694; train_global_loss: 5159249.8333; train_optim_loss: 5159249.8333; val_kl_reg_loss: 11947.4502; val_edge_recon_loss: 2722343.7500; val_gene_expr_recon_loss: 938794.0625; val_masked_gp_l1_reg_loss: 8690.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40825.2695; val_chrom_access_recon_loss: 1368400.8750; val_global_loss: 5091001.5000; val_optim_loss: 5091001.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9518; val_auprc_score: 0.9301; val_best_acc_score: 0.9000; val_best_f1_score: 0.9056; train_kl_reg_loss: 35190.9983; train_edge_recon_loss: 2718456.5278; train_gene_expr_recon_loss: 940439.3681; train_masked_gp_l1_reg_loss: 8690.1490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39820.2917; train_chrom_access_recon_loss: 1375823.5972; train_global_loss: 5118420.9444; train_optim_loss: 5118420.9444; val_kl_reg_loss: 10709.2256; val_edge_recon_loss: 2720435.2500; val_gene_expr_recon_loss: 935894.5000; val_masked_gp_l1_reg_loss: 8705.7178; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38569.5898; val_chrom_access_recon_loss: 1366750.2500; val_global_loss: 5081064.5000; val_optim_loss: 5081064.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9577; val_auprc_score: 0.9410; val_best_acc_score: 0.9074; val_best_f1_score: 0.9118; train_kl_reg_loss: 32164.4238; train_edge_recon_loss: 2687998.8333; train_gene_expr_recon_loss: 943995.6528; train_masked_gp_l1_reg_loss: 8728.8822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37592.2296; train_chrom_access_recon_loss: 1382545.1528; train_global_loss: 5093025.1667; train_optim_loss: 5093025.1667; val_kl_reg_loss: 10748.6328; val_edge_recon_loss: 2702010.0000; val_gene_expr_recon_loss: 930148.6875; val_masked_gp_l1_reg_loss: 8758.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36396.5742; val_chrom_access_recon_loss: 1363754.1250; val_global_loss: 5051817.0000; val_optim_loss: 5051817.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9553; val_auprc_score: 0.9389; val_best_acc_score: 0.9026; val_best_f1_score: 0.9083; train_kl_reg_loss: 30201.2316; train_edge_recon_loss: 2705376.3056; train_gene_expr_recon_loss: 938436.6389; train_masked_gp_l1_reg_loss: 8686.8733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36269.4974; train_chrom_access_recon_loss: 1381758.2917; train_global_loss: 5100728.8333; train_optim_loss: 5100728.8333; val_kl_reg_loss: 10761.5029; val_edge_recon_loss: 2720545.7500; val_gene_expr_recon_loss: 929401.1250; val_masked_gp_l1_reg_loss: 8623.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36113.8203; val_chrom_access_recon_loss: 1363606.7500; val_global_loss: 5069052.5000; val_optim_loss: 5069052.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9606; val_auprc_score: 0.9491; val_best_acc_score: 0.9050; val_best_f1_score: 0.9098; train_kl_reg_loss: 29733.9670; train_edge_recon_loss: 2694361.6667; train_gene_expr_recon_loss: 936316.0694; train_masked_gp_l1_reg_loss: 8610.5050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36000.1589; train_chrom_access_recon_loss: 1378497.3333; train_global_loss: 5083519.6111; train_optim_loss: 5083519.6111; val_kl_reg_loss: 10694.1289; val_edge_recon_loss: 2704384.0000; val_gene_expr_recon_loss: 931109.7500; val_masked_gp_l1_reg_loss: 8588.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35857.5352; val_chrom_access_recon_loss: 1364264.5000; val_global_loss: 5054898.5000; val_optim_loss: 5054898.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9574; val_auprc_score: 0.9420; val_best_acc_score: 0.9057; val_best_f1_score: 0.9108; train_kl_reg_loss: 29296.0037; train_edge_recon_loss: 2698385.4722; train_gene_expr_recon_loss: 939202.8542; train_masked_gp_l1_reg_loss: 8578.3247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35748.7010; train_chrom_access_recon_loss: 1382361.3333; train_global_loss: 5093572.5556; train_optim_loss: 5093572.5556; val_kl_reg_loss: 10624.1836; val_edge_recon_loss: 2698033.7500; val_gene_expr_recon_loss: 931026.3750; val_masked_gp_l1_reg_loss: 8567.6191; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35614.0625; val_chrom_access_recon_loss: 1363949.8750; val_global_loss: 5047816.0000; val_optim_loss: 5047816.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9553; val_auprc_score: 0.9399; val_best_acc_score: 0.8985; val_best_f1_score: 0.9050; train_kl_reg_loss: 28929.6128; train_edge_recon_loss: 2698070.4167; train_gene_expr_recon_loss: 943454.9653; train_masked_gp_l1_reg_loss: 8562.9346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35509.9232; train_chrom_access_recon_loss: 1383623.4861; train_global_loss: 5098151.3889; train_optim_loss: 5098151.3889; val_kl_reg_loss: 10544.9121; val_edge_recon_loss: 2727086.7500; val_gene_expr_recon_loss: 929910.2500; val_masked_gp_l1_reg_loss: 8559.0908; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35383.4414; val_chrom_access_recon_loss: 1363573.1250; val_global_loss: 5075057.5000; val_optim_loss: 5075057.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 20 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9493
val AUPRC score: 0.9339
val best accuracy score: 0.8936
val best F1 score: 0.9000
val target rna MSE score: 3.7552
val source rna MSE score: 3.1943
val target atac MSE score: 0.1285
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
