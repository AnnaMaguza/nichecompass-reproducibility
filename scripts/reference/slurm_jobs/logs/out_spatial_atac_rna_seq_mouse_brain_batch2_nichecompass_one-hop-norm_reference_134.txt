[True]
Run timestamp: 26072023_034258_134.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_134']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9593; val_auprc_score: 0.9615; val_best_acc_score: 0.7506; val_best_f1_score: 0.7984; train_kl_reg_loss: 2533.0882; train_edge_recon_loss: 34665397.3333; train_gene_expr_recon_loss: 3210576.5000; train_masked_gp_l1_reg_loss: 1855.1952; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10860122.4444; train_global_loss: 48740484.8889; train_optim_loss: 48740484.8889; val_kl_reg_loss: 1655.2533; val_edge_recon_loss: 40556492.0000; val_gene_expr_recon_loss: 3168884.0000; val_masked_gp_l1_reg_loss: 1849.6552; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10642168.0000; val_global_loss: 54371048.0000; val_optim_loss: 54371048.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9528; val_auprc_score: 0.9538; val_best_acc_score: 0.7361; val_best_f1_score: 0.7894; train_kl_reg_loss: 2531.6301; train_edge_recon_loss: 34686934.2222; train_gene_expr_recon_loss: 3123643.6944; train_masked_gp_l1_reg_loss: 1911.5520; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10769238.8889; train_global_loss: 48584260.0000; train_optim_loss: 48584260.0000; val_kl_reg_loss: 5285.0161; val_edge_recon_loss: 40527016.0000; val_gene_expr_recon_loss: 3026080.0000; val_masked_gp_l1_reg_loss: 2025.1683; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10544379.0000; val_global_loss: 54104784.0000; val_optim_loss: 54104784.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9324; val_auprc_score: 0.9301; val_best_acc_score: 0.8193; val_best_f1_score: 0.8409; train_kl_reg_loss: 8605.1736; train_edge_recon_loss: 34711184.0000; train_gene_expr_recon_loss: 2963257.0278; train_masked_gp_l1_reg_loss: 2162.5240; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10748353.0000; train_global_loss: 48433562.2222; train_optim_loss: 48433562.2222; val_kl_reg_loss: 10991.8643; val_edge_recon_loss: 40324728.0000; val_gene_expr_recon_loss: 2863514.2500; val_masked_gp_l1_reg_loss: 2347.9331; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10444437.0000; val_global_loss: 53646020.0000; val_optim_loss: 53646020.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9091; val_auprc_score: 0.8962; val_best_acc_score: 0.8162; val_best_f1_score: 0.8121; train_kl_reg_loss: 19358.6886; train_edge_recon_loss: 34691862.2222; train_gene_expr_recon_loss: 2799980.1389; train_masked_gp_l1_reg_loss: 2496.9130; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10533284.6667; train_global_loss: 48046982.6667; train_optim_loss: 48046982.6667; val_kl_reg_loss: 28838.1836; val_edge_recon_loss: 39472952.0000; val_gene_expr_recon_loss: 2692405.7500; val_masked_gp_l1_reg_loss: 2674.3428; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10284695.0000; val_global_loss: 52481568.0000; val_optim_loss: 52481568.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8819; val_auprc_score: 0.8662; val_best_acc_score: 0.7930; val_best_f1_score: 0.8142; train_kl_reg_loss: 26327.2144; train_edge_recon_loss: 34405423.5556; train_gene_expr_recon_loss: 2635595.6944; train_masked_gp_l1_reg_loss: 2795.0123; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10380916.8889; train_global_loss: 47451059.1111; train_optim_loss: 47451059.1111; val_kl_reg_loss: 7370.4404; val_edge_recon_loss: 33849324.0000; val_gene_expr_recon_loss: 2675287.0000; val_masked_gp_l1_reg_loss: 2934.6807; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10259093.0000; val_global_loss: 46794012.0000; val_optim_loss: 46794012.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8603; val_auprc_score: 0.8508; val_best_acc_score: 0.7626; val_best_f1_score: 0.7900; train_kl_reg_loss: 8465.1641; train_edge_recon_loss: 30818074.4444; train_gene_expr_recon_loss: 2767080.6667; train_masked_gp_l1_reg_loss: 3042.8708; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10459231.3333; train_global_loss: 44055895.1111; train_optim_loss: 44055895.1111; val_kl_reg_loss: 18556.2305; val_edge_recon_loss: 28890040.0000; val_gene_expr_recon_loss: 2768937.0000; val_masked_gp_l1_reg_loss: 3171.5295; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10345028.0000; val_global_loss: 42025732.0000; val_optim_loss: 42025732.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8689; val_auprc_score: 0.8538; val_best_acc_score: 0.7777; val_best_f1_score: 0.7910; train_kl_reg_loss: 37720.1999; train_edge_recon_loss: 28629454.2222; train_gene_expr_recon_loss: 2704619.1111; train_masked_gp_l1_reg_loss: 3250.6326; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10386902.2222; train_global_loss: 41761945.7778; train_optim_loss: 41761945.7778; val_kl_reg_loss: 57435.5859; val_edge_recon_loss: 28913802.0000; val_gene_expr_recon_loss: 2606793.7500; val_masked_gp_l1_reg_loss: 3336.4380; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10154689.0000; val_global_loss: 41736056.0000; val_optim_loss: 41736056.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8784; val_auprc_score: 0.8633; val_best_acc_score: 0.7847; val_best_f1_score: 0.7995; train_kl_reg_loss: 75817.7357; train_edge_recon_loss: 28601206.2222; train_gene_expr_recon_loss: 2558374.9444; train_masked_gp_l1_reg_loss: 3388.6243; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10255597.1111; train_global_loss: 41494384.8889; train_optim_loss: 41494384.8889; val_kl_reg_loss: 89970.0703; val_edge_recon_loss: 28986456.0000; val_gene_expr_recon_loss: 2499029.2500; val_masked_gp_l1_reg_loss: 3445.3931; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10073551.0000; val_global_loss: 41652452.0000; val_optim_loss: 41652452.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8833; val_auprc_score: 0.8601; val_best_acc_score: 0.7964; val_best_f1_score: 0.8053; train_kl_reg_loss: 102736.6155; train_edge_recon_loss: 28420839.3333; train_gene_expr_recon_loss: 2490682.5000; train_masked_gp_l1_reg_loss: 3484.7968; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10168046.3333; train_global_loss: 41185789.3333; train_optim_loss: 41185789.3333; val_kl_reg_loss: 109456.5391; val_edge_recon_loss: 28486416.0000; val_gene_expr_recon_loss: 2454820.2500; val_masked_gp_l1_reg_loss: 3531.5000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10021559.0000; val_global_loss: 41075784.0000; val_optim_loss: 41075784.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8917; val_auprc_score: 0.8716; val_best_acc_score: 0.8046; val_best_f1_score: 0.8145; train_kl_reg_loss: 118746.7743; train_edge_recon_loss: 28384869.7778; train_gene_expr_recon_loss: 2444766.2778; train_masked_gp_l1_reg_loss: 3564.7609; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10197774.3333; train_global_loss: 41149722.2222; train_optim_loss: 41149722.2222; val_kl_reg_loss: 115475.4062; val_edge_recon_loss: 28416122.0000; val_gene_expr_recon_loss: 2422618.7500; val_masked_gp_l1_reg_loss: 3601.2729; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9982438.0000; val_global_loss: 40940256.0000; val_optim_loss: 40940256.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8836; val_auprc_score: 0.8537; val_best_acc_score: 0.8032; val_best_f1_score: 0.8224; train_kl_reg_loss: 115246.8993; train_edge_recon_loss: 28266676.2222; train_gene_expr_recon_loss: 2413419.1667; train_masked_gp_l1_reg_loss: 3626.0115; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10145921.3333; train_global_loss: 40944889.3333; train_optim_loss: 40944889.3333; val_kl_reg_loss: 102070.9766; val_edge_recon_loss: 28296936.0000; val_gene_expr_recon_loss: 2405981.0000; val_masked_gp_l1_reg_loss: 3655.4033; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9950986.0000; val_global_loss: 40759632.0000; val_optim_loss: 40759632.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8999; val_auprc_score: 0.8700; val_best_acc_score: 0.8343; val_best_f1_score: 0.8471; train_kl_reg_loss: 98874.9123; train_edge_recon_loss: 27875544.4444; train_gene_expr_recon_loss: 2401441.3333; train_masked_gp_l1_reg_loss: 3683.6285; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10017798.6667; train_global_loss: 40397342.2222; train_optim_loss: 40397342.2222; val_kl_reg_loss: 90603.8281; val_edge_recon_loss: 28148246.0000; val_gene_expr_recon_loss: 2382853.5000; val_masked_gp_l1_reg_loss: 3718.4321; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9919946.0000; val_global_loss: 40545368.0000; val_optim_loss: 40545368.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9232; val_auprc_score: 0.8932; val_best_acc_score: 0.8641; val_best_f1_score: 0.8725; train_kl_reg_loss: 93375.2708; train_edge_recon_loss: 27520035.5556; train_gene_expr_recon_loss: 2406173.6944; train_masked_gp_l1_reg_loss: 3748.5540; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10071485.2222; train_global_loss: 40094818.6667; train_optim_loss: 40094818.6667; val_kl_reg_loss: 96815.7188; val_edge_recon_loss: 27207258.0000; val_gene_expr_recon_loss: 2387484.7500; val_masked_gp_l1_reg_loss: 3783.0098; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9908058.0000; val_global_loss: 39603400.0000; val_optim_loss: 39603400.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9224; val_auprc_score: 0.8989; val_best_acc_score: 0.8581; val_best_f1_score: 0.8690; train_kl_reg_loss: 105152.9957; train_edge_recon_loss: 27376012.0000; train_gene_expr_recon_loss: 2369470.2222; train_masked_gp_l1_reg_loss: 3807.0668; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10051676.6667; train_global_loss: 39906119.5556; train_optim_loss: 39906119.5556; val_kl_reg_loss: 108810.6406; val_edge_recon_loss: 27261028.0000; val_gene_expr_recon_loss: 2378887.7500; val_masked_gp_l1_reg_loss: 3835.5298; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9904800.0000; val_global_loss: 39657360.0000; val_optim_loss: 39657360.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9269; val_auprc_score: 0.8987; val_best_acc_score: 0.8685; val_best_f1_score: 0.8763; train_kl_reg_loss: 119052.2083; train_edge_recon_loss: 27120034.6667; train_gene_expr_recon_loss: 2342638.0833; train_masked_gp_l1_reg_loss: 3859.8961; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9997056.0000; train_global_loss: 39582641.3333; train_optim_loss: 39582641.3333; val_kl_reg_loss: 127039.6953; val_edge_recon_loss: 27223014.0000; val_gene_expr_recon_loss: 2344141.7500; val_masked_gp_l1_reg_loss: 3889.5073; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9858857.0000; val_global_loss: 39556944.0000; val_optim_loss: 39556944.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9321; val_auprc_score: 0.9093; val_best_acc_score: 0.8740; val_best_f1_score: 0.8816; train_kl_reg_loss: 135378.4688; train_edge_recon_loss: 27200296.4444; train_gene_expr_recon_loss: 2330058.0000; train_masked_gp_l1_reg_loss: 3912.1186; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9992317.3333; train_global_loss: 39661961.7778; train_optim_loss: 39661961.7778; val_kl_reg_loss: 137299.4531; val_edge_recon_loss: 27249572.0000; val_gene_expr_recon_loss: 2315382.5000; val_masked_gp_l1_reg_loss: 3937.5752; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9810776.0000; val_global_loss: 39516968.0000; val_optim_loss: 39516968.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9309; val_auprc_score: 0.9032; val_best_acc_score: 0.8764; val_best_f1_score: 0.8831; train_kl_reg_loss: 142397.5920; train_edge_recon_loss: 27108896.8889; train_gene_expr_recon_loss: 2309446.1111; train_masked_gp_l1_reg_loss: 3957.1971; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9967685.0000; train_global_loss: 39532383.1111; train_optim_loss: 39532383.1111; val_kl_reg_loss: 140217.4062; val_edge_recon_loss: 27149496.0000; val_gene_expr_recon_loss: 2299263.0000; val_masked_gp_l1_reg_loss: 3978.3740; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9802890.0000; val_global_loss: 39395844.0000; val_optim_loss: 39395844.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9365; val_auprc_score: 0.9102; val_best_acc_score: 0.8814; val_best_f1_score: 0.8897; train_kl_reg_loss: 143762.7986; train_edge_recon_loss: 27176502.4444; train_gene_expr_recon_loss: 2288656.0000; train_masked_gp_l1_reg_loss: 3996.1467; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9933394.1111; train_global_loss: 39546311.1111; train_optim_loss: 39546311.1111; val_kl_reg_loss: 140545.9531; val_edge_recon_loss: 26995120.0000; val_gene_expr_recon_loss: 2282509.7500; val_masked_gp_l1_reg_loss: 4013.6602; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9775961.0000; val_global_loss: 39198152.0000; val_optim_loss: 39198152.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9355; val_auprc_score: 0.9097; val_best_acc_score: 0.8789; val_best_f1_score: 0.8867; train_kl_reg_loss: 144211.8333; train_edge_recon_loss: 27060178.6667; train_gene_expr_recon_loss: 2274456.3333; train_masked_gp_l1_reg_loss: 4027.8696; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9890403.4444; train_global_loss: 39373278.2222; train_optim_loss: 39373278.2222; val_kl_reg_loss: 140967.3594; val_edge_recon_loss: 27164248.0000; val_gene_expr_recon_loss: 2264323.2500; val_masked_gp_l1_reg_loss: 4045.7988; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9756853.0000; val_global_loss: 39330440.0000; val_optim_loss: 39330440.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9381; val_auprc_score: 0.9162; val_best_acc_score: 0.8808; val_best_f1_score: 0.8870; train_kl_reg_loss: 149607.3420; train_edge_recon_loss: 26983956.8889; train_gene_expr_recon_loss: 2261829.2778; train_masked_gp_l1_reg_loss: 4061.3575; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9889691.2222; train_global_loss: 39289145.7778; train_optim_loss: 39289145.7778; val_kl_reg_loss: 146215.8125; val_edge_recon_loss: 27229490.0000; val_gene_expr_recon_loss: 2252613.0000; val_masked_gp_l1_reg_loss: 4079.9922; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9736349.0000; val_global_loss: 39368748.0000; val_optim_loss: 39368748.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9373; val_auprc_score: 0.9121; val_best_acc_score: 0.8872; val_best_f1_score: 0.8935; train_kl_reg_loss: 150177.2292; train_edge_recon_loss: 27008000.4444; train_gene_expr_recon_loss: 2234803.5000; train_masked_gp_l1_reg_loss: 4095.0699; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9809213.3333; train_global_loss: 39206289.7778; train_optim_loss: 39206289.7778; val_kl_reg_loss: 148319.4531; val_edge_recon_loss: 27042604.0000; val_gene_expr_recon_loss: 2238658.0000; val_masked_gp_l1_reg_loss: 4115.1270; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9700237.0000; val_global_loss: 39133936.0000; val_optim_loss: 39133936.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9422; val_auprc_score: 0.9209; val_best_acc_score: 0.8898; val_best_f1_score: 0.8947; train_kl_reg_loss: 152385.5573; train_edge_recon_loss: 27057027.1111; train_gene_expr_recon_loss: 2244734.6667; train_masked_gp_l1_reg_loss: 4128.4810; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9851958.2222; train_global_loss: 39310235.1111; train_optim_loss: 39310235.1111; val_kl_reg_loss: 147912.5312; val_edge_recon_loss: 27048346.0000; val_gene_expr_recon_loss: 2234576.7500; val_masked_gp_l1_reg_loss: 4146.5273; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9703399.0000; val_global_loss: 39138380.0000; val_optim_loss: 39138380.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9396; val_auprc_score: 0.9131; val_best_acc_score: 0.8872; val_best_f1_score: 0.8937; train_kl_reg_loss: 149196.8681; train_edge_recon_loss: 27023123.1111; train_gene_expr_recon_loss: 2225756.5556; train_masked_gp_l1_reg_loss: 4159.7671; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9770433.0000; train_global_loss: 39172670.2222; train_optim_loss: 39172670.2222; val_kl_reg_loss: 142701.7969; val_edge_recon_loss: 27187734.0000; val_gene_expr_recon_loss: 2224211.2500; val_masked_gp_l1_reg_loss: 4174.3281; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9690420.0000; val_global_loss: 39249240.0000; val_optim_loss: 39249240.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9445; val_auprc_score: 0.9204; val_best_acc_score: 0.8839; val_best_f1_score: 0.8907; train_kl_reg_loss: 148363.8264; train_edge_recon_loss: 26984169.3333; train_gene_expr_recon_loss: 2219502.1667; train_masked_gp_l1_reg_loss: 4188.6476; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9803716.6667; train_global_loss: 39159941.3333; train_optim_loss: 39159941.3333; val_kl_reg_loss: 143073.1250; val_edge_recon_loss: 27232506.0000; val_gene_expr_recon_loss: 2232541.0000; val_masked_gp_l1_reg_loss: 4205.8516; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9683046.0000; val_global_loss: 39295372.0000; val_optim_loss: 39295372.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9513; val_auprc_score: 0.9337; val_best_acc_score: 0.8952; val_best_f1_score: 0.9007; train_kl_reg_loss: 150345.7135; train_edge_recon_loss: 27119986.4444; train_gene_expr_recon_loss: 2221799.2778; train_masked_gp_l1_reg_loss: 4219.5197; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9819163.3333; train_global_loss: 39315515.1111; train_optim_loss: 39315515.1111; val_kl_reg_loss: 146389.2656; val_edge_recon_loss: 27015776.0000; val_gene_expr_recon_loss: 2216060.5000; val_masked_gp_l1_reg_loss: 4234.6963; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9673085.0000; val_global_loss: 39055544.0000; val_optim_loss: 39055544.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9489; val_auprc_score: 0.9270; val_best_acc_score: 0.8944; val_best_f1_score: 0.8986; train_kl_reg_loss: 150179.1441; train_edge_recon_loss: 26945201.5556; train_gene_expr_recon_loss: 2208003.0833; train_masked_gp_l1_reg_loss: 4247.9354; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9807763.5556; train_global_loss: 39115394.2222; train_optim_loss: 39115394.2222; val_kl_reg_loss: 143215.0312; val_edge_recon_loss: 27107724.0000; val_gene_expr_recon_loss: 2215771.2500; val_masked_gp_l1_reg_loss: 4260.6729; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9663134.0000; val_global_loss: 39134104.0000; val_optim_loss: 39134104.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9545; val_auprc_score: 0.9348; val_best_acc_score: 0.9006; val_best_f1_score: 0.9040; train_kl_reg_loss: 148056.3958; train_edge_recon_loss: 26792459.3333; train_gene_expr_recon_loss: 2215108.7778; train_masked_gp_l1_reg_loss: 4271.1031; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9831520.4444; train_global_loss: 38991416.0000; train_optim_loss: 38991416.0000; val_kl_reg_loss: 140360.8750; val_edge_recon_loss: 26931354.0000; val_gene_expr_recon_loss: 2204306.5000; val_masked_gp_l1_reg_loss: 4282.6509; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9651264.0000; val_global_loss: 38931568.0000; val_optim_loss: 38931568.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9537; val_auprc_score: 0.9363; val_best_acc_score: 0.9015; val_best_f1_score: 0.9064; train_kl_reg_loss: 142774.1198; train_edge_recon_loss: 26889678.2222; train_gene_expr_recon_loss: 2204101.9722; train_masked_gp_l1_reg_loss: 4293.4295; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9765061.2222; train_global_loss: 39005910.6667; train_optim_loss: 39005910.6667; val_kl_reg_loss: 137555.8125; val_edge_recon_loss: 26962196.0000; val_gene_expr_recon_loss: 2193558.5000; val_masked_gp_l1_reg_loss: 4305.5010; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9623427.0000; val_global_loss: 38921044.0000; val_optim_loss: 38921044.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9567; val_auprc_score: 0.9390; val_best_acc_score: 0.9089; val_best_f1_score: 0.9132; train_kl_reg_loss: 139149.2170; train_edge_recon_loss: 26754033.7778; train_gene_expr_recon_loss: 2199229.6667; train_masked_gp_l1_reg_loss: 4315.8710; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9724707.7778; train_global_loss: 38821435.5556; train_optim_loss: 38821435.5556; val_kl_reg_loss: 131237.1562; val_edge_recon_loss: 26768460.0000; val_gene_expr_recon_loss: 2194531.5000; val_masked_gp_l1_reg_loss: 4327.5576; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9621968.0000; val_global_loss: 38720528.0000; val_optim_loss: 38720528.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9604; val_auprc_score: 0.9433; val_best_acc_score: 0.9062; val_best_f1_score: 0.9099; train_kl_reg_loss: 132895.5408; train_edge_recon_loss: 26693681.3333; train_gene_expr_recon_loss: 2194545.8611; train_masked_gp_l1_reg_loss: 4338.6037; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9780596.3333; train_global_loss: 38806058.6667; train_optim_loss: 38806058.6667; val_kl_reg_loss: 132602.1094; val_edge_recon_loss: 26696018.0000; val_gene_expr_recon_loss: 2201778.5000; val_masked_gp_l1_reg_loss: 4351.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9626715.0000; val_global_loss: 38661464.0000; val_optim_loss: 38661464.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9593; val_auprc_score: 0.9403; val_best_acc_score: 0.9127; val_best_f1_score: 0.9169; train_kl_reg_loss: 139378.7899; train_edge_recon_loss: 26685633.5556; train_gene_expr_recon_loss: 2188226.9722; train_masked_gp_l1_reg_loss: 4361.3653; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9707766.3333; train_global_loss: 38725367.1111; train_optim_loss: 38725367.1111; val_kl_reg_loss: 142803.3750; val_edge_recon_loss: 26618060.0000; val_gene_expr_recon_loss: 2182221.7500; val_masked_gp_l1_reg_loss: 4374.1768; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9600545.0000; val_global_loss: 38548004.0000; val_optim_loss: 38548004.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9622; val_auprc_score: 0.9456; val_best_acc_score: 0.9146; val_best_f1_score: 0.9179; train_kl_reg_loss: 148155.2118; train_edge_recon_loss: 26479642.0000; train_gene_expr_recon_loss: 2179630.6944; train_masked_gp_l1_reg_loss: 4386.7861; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9744383.4444; train_global_loss: 38556197.3333; train_optim_loss: 38556197.3333; val_kl_reg_loss: 148971.0156; val_edge_recon_loss: 26595808.0000; val_gene_expr_recon_loss: 2200863.7500; val_masked_gp_l1_reg_loss: 4400.3032; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9595627.0000; val_global_loss: 38545672.0000; val_optim_loss: 38545672.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9564; val_auprc_score: 0.9350; val_best_acc_score: 0.9112; val_best_f1_score: 0.9157; train_kl_reg_loss: 152855.0035; train_edge_recon_loss: 26685213.3333; train_gene_expr_recon_loss: 2197273.4722; train_masked_gp_l1_reg_loss: 4416.5892; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9731561.8889; train_global_loss: 38771320.4444; train_optim_loss: 38771320.4444; val_kl_reg_loss: 147450.5312; val_edge_recon_loss: 26620444.0000; val_gene_expr_recon_loss: 2170496.2500; val_masked_gp_l1_reg_loss: 4432.7939; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9575760.0000; val_global_loss: 38518584.0000; val_optim_loss: 38518584.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9580; val_auprc_score: 0.9367; val_best_acc_score: 0.9082; val_best_f1_score: 0.9125; train_kl_reg_loss: 148289.6302; train_edge_recon_loss: 26567946.4444; train_gene_expr_recon_loss: 2185271.1389; train_masked_gp_l1_reg_loss: 4449.1816; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9650639.0000; train_global_loss: 38556595.1111; train_optim_loss: 38556595.1111; val_kl_reg_loss: 140198.0312; val_edge_recon_loss: 26887006.0000; val_gene_expr_recon_loss: 2172676.5000; val_masked_gp_l1_reg_loss: 4467.6309; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9567653.0000; val_global_loss: 38772000.0000; val_optim_loss: 38772000.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9612; val_auprc_score: 0.9437; val_best_acc_score: 0.9184; val_best_f1_score: 0.9221; train_kl_reg_loss: 141986.5087; train_edge_recon_loss: 26582312.8889; train_gene_expr_recon_loss: 2179777.9167; train_masked_gp_l1_reg_loss: 4480.7061; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9647885.3333; train_global_loss: 38556443.1111; train_optim_loss: 38556443.1111; val_kl_reg_loss: 138746.4375; val_edge_recon_loss: 26483422.0000; val_gene_expr_recon_loss: 2167210.0000; val_masked_gp_l1_reg_loss: 4493.0488; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9559159.0000; val_global_loss: 38353032.0000; val_optim_loss: 38353032.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9651; val_auprc_score: 0.9501; val_best_acc_score: 0.9197; val_best_f1_score: 0.9223; train_kl_reg_loss: 144130.0799; train_edge_recon_loss: 26634261.3333; train_gene_expr_recon_loss: 2158785.3333; train_masked_gp_l1_reg_loss: 4504.8015; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9682818.5556; train_global_loss: 38624500.0000; train_optim_loss: 38624500.0000; val_kl_reg_loss: 142176.3125; val_edge_recon_loss: 26577916.0000; val_gene_expr_recon_loss: 2168713.0000; val_masked_gp_l1_reg_loss: 4518.0508; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9566725.0000; val_global_loss: 38460048.0000; val_optim_loss: 38460048.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9607; val_auprc_score: 0.9413; val_best_acc_score: 0.9173; val_best_f1_score: 0.9207; train_kl_reg_loss: 147826.4705; train_edge_recon_loss: 26514391.7778; train_gene_expr_recon_loss: 2161902.1667; train_masked_gp_l1_reg_loss: 4530.8339; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9653287.8889; train_global_loss: 38481937.7778; train_optim_loss: 38481937.7778; val_kl_reg_loss: 142578.7500; val_edge_recon_loss: 26570290.0000; val_gene_expr_recon_loss: 2165628.2500; val_masked_gp_l1_reg_loss: 4544.9634; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9555669.0000; val_global_loss: 38438708.0000; val_optim_loss: 38438708.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9620; val_auprc_score: 0.9426; val_best_acc_score: 0.9188; val_best_f1_score: 0.9211; train_kl_reg_loss: 149016.4115; train_edge_recon_loss: 26469751.5556; train_gene_expr_recon_loss: 2148715.8056; train_masked_gp_l1_reg_loss: 4559.3448; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9668770.6667; train_global_loss: 38440813.3333; train_optim_loss: 38440813.3333; val_kl_reg_loss: 145392.7656; val_edge_recon_loss: 26624302.0000; val_gene_expr_recon_loss: 2161302.0000; val_masked_gp_l1_reg_loss: 4573.1104; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9548689.0000; val_global_loss: 38484260.0000; val_optim_loss: 38484260.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9661; val_auprc_score: 0.9488; val_best_acc_score: 0.9204; val_best_f1_score: 0.9243; train_kl_reg_loss: 151735.9115; train_edge_recon_loss: 26476255.5556; train_gene_expr_recon_loss: 2149771.6389; train_masked_gp_l1_reg_loss: 4586.6447; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9627006.4444; train_global_loss: 38409356.0000; train_optim_loss: 38409356.0000; val_kl_reg_loss: 147990.8125; val_edge_recon_loss: 26476262.0000; val_gene_expr_recon_loss: 2153508.7500; val_masked_gp_l1_reg_loss: 4598.6934; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9530833.0000; val_global_loss: 38313192.0000; val_optim_loss: 38313192.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9648; val_auprc_score: 0.9463; val_best_acc_score: 0.9219; val_best_f1_score: 0.9259; train_kl_reg_loss: 152556.7292; train_edge_recon_loss: 26513816.0000; train_gene_expr_recon_loss: 2148006.8333; train_masked_gp_l1_reg_loss: 4610.0933; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9640039.4444; train_global_loss: 38459028.8889; train_optim_loss: 38459028.8889; val_kl_reg_loss: 146506.3750; val_edge_recon_loss: 26548520.0000; val_gene_expr_recon_loss: 2152116.5000; val_masked_gp_l1_reg_loss: 4621.0635; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9526456.0000; val_global_loss: 38378220.0000; val_optim_loss: 38378220.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9697; val_auprc_score: 0.9559; val_best_acc_score: 0.9239; val_best_f1_score: 0.9264; train_kl_reg_loss: 149274.2326; train_edge_recon_loss: 26564740.2222; train_gene_expr_recon_loss: 2139494.0417; train_masked_gp_l1_reg_loss: 4633.1616; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9589565.5556; train_global_loss: 38447707.1111; train_optim_loss: 38447707.1111; val_kl_reg_loss: 144111.9844; val_edge_recon_loss: 26500394.0000; val_gene_expr_recon_loss: 2147247.5000; val_masked_gp_l1_reg_loss: 4645.9038; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9513262.0000; val_global_loss: 38309664.0000; val_optim_loss: 38309664.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9618; val_auprc_score: 0.9434; val_best_acc_score: 0.9169; val_best_f1_score: 0.9208; train_kl_reg_loss: 148385.2587; train_edge_recon_loss: 26533740.2222; train_gene_expr_recon_loss: 2140435.8889; train_masked_gp_l1_reg_loss: 4658.1541; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9676121.5556; train_global_loss: 38503340.8889; train_optim_loss: 38503340.8889; val_kl_reg_loss: 145945.0781; val_edge_recon_loss: 26740512.0000; val_gene_expr_recon_loss: 2142873.2500; val_masked_gp_l1_reg_loss: 4671.2705; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9513540.0000; val_global_loss: 38547544.0000; val_optim_loss: 38547544.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9700; val_auprc_score: 0.9587; val_best_acc_score: 0.9236; val_best_f1_score: 0.9250; train_kl_reg_loss: 149790.5399; train_edge_recon_loss: 26405666.0000; train_gene_expr_recon_loss: 2136344.2778; train_masked_gp_l1_reg_loss: 4685.2918; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9620751.0000; train_global_loss: 38317237.7778; train_optim_loss: 38317237.7778; val_kl_reg_loss: 145093.8906; val_edge_recon_loss: 26533038.0000; val_gene_expr_recon_loss: 2144565.2500; val_masked_gp_l1_reg_loss: 4699.0034; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9495256.0000; val_global_loss: 38322656.0000; val_optim_loss: 38322656.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9688; val_auprc_score: 0.9556; val_best_acc_score: 0.9217; val_best_f1_score: 0.9253; train_kl_reg_loss: 149721.7708; train_edge_recon_loss: 26394389.1111; train_gene_expr_recon_loss: 2129320.6667; train_masked_gp_l1_reg_loss: 4712.8806; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9604477.2222; train_global_loss: 38282621.7778; train_optim_loss: 38282621.7778; val_kl_reg_loss: 144623.1719; val_edge_recon_loss: 26662048.0000; val_gene_expr_recon_loss: 2141412.2500; val_masked_gp_l1_reg_loss: 4725.2588; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9490730.0000; val_global_loss: 38443540.0000; val_optim_loss: 38443540.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9703; val_auprc_score: 0.9570; val_best_acc_score: 0.9241; val_best_f1_score: 0.9266; train_kl_reg_loss: 147147.7726; train_edge_recon_loss: 26485072.4444; train_gene_expr_recon_loss: 2125222.3750; train_masked_gp_l1_reg_loss: 4736.3057; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9550877.3333; train_global_loss: 38313057.3333; train_optim_loss: 38313057.3333; val_kl_reg_loss: 143323.2656; val_edge_recon_loss: 26652610.0000; val_gene_expr_recon_loss: 2133245.7500; val_masked_gp_l1_reg_loss: 4749.1885; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9480215.0000; val_global_loss: 38414144.0000; val_optim_loss: 38414144.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9690; val_auprc_score: 0.9531; val_best_acc_score: 0.9240; val_best_f1_score: 0.9279; train_kl_reg_loss: 146803.1389; train_edge_recon_loss: 26446328.0000; train_gene_expr_recon_loss: 2131679.2083; train_masked_gp_l1_reg_loss: 4749.4977; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9625155.6667; train_global_loss: 38354715.5556; train_optim_loss: 38354715.5556; val_kl_reg_loss: 142014.0938; val_edge_recon_loss: 26422740.0000; val_gene_expr_recon_loss: 2137119.2500; val_masked_gp_l1_reg_loss: 4748.8584; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9480940.0000; val_global_loss: 38187560.0000; val_optim_loss: 38187560.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9684; val_auprc_score: 0.9553; val_best_acc_score: 0.9170; val_best_f1_score: 0.9212; train_kl_reg_loss: 145215.0139; train_edge_recon_loss: 26417357.1111; train_gene_expr_recon_loss: 2120077.4167; train_masked_gp_l1_reg_loss: 4748.1095; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9591323.1111; train_global_loss: 38278721.3333; train_optim_loss: 38278721.3333; val_kl_reg_loss: 142725.2812; val_edge_recon_loss: 26719242.0000; val_gene_expr_recon_loss: 2134416.7500; val_masked_gp_l1_reg_loss: 4747.6045; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9472406.0000; val_global_loss: 38473536.0000; val_optim_loss: 38473536.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9678; val_auprc_score: 0.9535; val_best_acc_score: 0.9214; val_best_f1_score: 0.9257; train_kl_reg_loss: 146843.3819; train_edge_recon_loss: 26413486.2222; train_gene_expr_recon_loss: 2123461.0694; train_masked_gp_l1_reg_loss: 4747.8572; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9558074.3333; train_global_loss: 38246612.8889; train_optim_loss: 38246612.8889; val_kl_reg_loss: 142627.5312; val_edge_recon_loss: 26486904.0000; val_gene_expr_recon_loss: 2132357.0000; val_masked_gp_l1_reg_loss: 4748.1211; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9472304.0000; val_global_loss: 38238940.0000; val_optim_loss: 38238940.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9734; val_auprc_score: 0.9634; val_best_acc_score: 0.9266; val_best_f1_score: 0.9297; train_kl_reg_loss: 145794.8524; train_edge_recon_loss: 26459584.4444; train_gene_expr_recon_loss: 2119960.7083; train_masked_gp_l1_reg_loss: 4748.4756; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9587341.0000; train_global_loss: 38317429.3333; train_optim_loss: 38317429.3333; val_kl_reg_loss: 142018.3906; val_edge_recon_loss: 26367706.0000; val_gene_expr_recon_loss: 2131961.7500; val_masked_gp_l1_reg_loss: 4748.9404; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9457565.0000; val_global_loss: 38104000.0000; val_optim_loss: 38104000.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9703; val_auprc_score: 0.9559; val_best_acc_score: 0.9233; val_best_f1_score: 0.9268; train_kl_reg_loss: 146896.2205; train_edge_recon_loss: 26446231.3333; train_gene_expr_recon_loss: 2121224.7917; train_masked_gp_l1_reg_loss: 4749.2841; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9582319.6667; train_global_loss: 38301421.3333; train_optim_loss: 38301421.3333; val_kl_reg_loss: 143875.8438; val_edge_recon_loss: 26398176.0000; val_gene_expr_recon_loss: 2135299.5000; val_masked_gp_l1_reg_loss: 4749.6675; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9493440.0000; val_global_loss: 38175544.0000; val_optim_loss: 38175544.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9696; val_auprc_score: 0.9591; val_best_acc_score: 0.9208; val_best_f1_score: 0.9246; train_kl_reg_loss: 147070.4549; train_edge_recon_loss: 26366992.2222; train_gene_expr_recon_loss: 2131623.0417; train_masked_gp_l1_reg_loss: 4750.1645; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9622333.0000; train_global_loss: 38272768.8889; train_optim_loss: 38272768.8889; val_kl_reg_loss: 143472.9688; val_edge_recon_loss: 26536056.0000; val_gene_expr_recon_loss: 2136501.5000; val_masked_gp_l1_reg_loss: 4750.9390; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9487142.0000; val_global_loss: 38307920.0000; val_optim_loss: 38307920.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9704; val_auprc_score: 0.9572; val_best_acc_score: 0.9263; val_best_f1_score: 0.9295; train_kl_reg_loss: 147284.3212; train_edge_recon_loss: 26535576.4444; train_gene_expr_recon_loss: 2128502.6111; train_masked_gp_l1_reg_loss: 4751.7622; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9622260.0000; train_global_loss: 38438375.5556; train_optim_loss: 38438375.5556; val_kl_reg_loss: 142450.5469; val_edge_recon_loss: 26499494.0000; val_gene_expr_recon_loss: 2131347.7500; val_masked_gp_l1_reg_loss: 4752.5928; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9468902.0000; val_global_loss: 38246944.0000; val_optim_loss: 38246944.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9697; val_auprc_score: 0.9564; val_best_acc_score: 0.9231; val_best_f1_score: 0.9267; train_kl_reg_loss: 146481.2014; train_edge_recon_loss: 26476396.0000; train_gene_expr_recon_loss: 2126245.5833; train_masked_gp_l1_reg_loss: 4753.2896; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9565184.8889; train_global_loss: 38319061.3333; train_optim_loss: 38319061.3333; val_kl_reg_loss: 142334.9062; val_edge_recon_loss: 26574450.0000; val_gene_expr_recon_loss: 2132044.0000; val_masked_gp_l1_reg_loss: 4754.1094; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9470276.0000; val_global_loss: 38323856.0000; val_optim_loss: 38323856.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9742; val_auprc_score: 0.9656; val_best_acc_score: 0.9264; val_best_f1_score: 0.9295; train_kl_reg_loss: 146520.6597; train_edge_recon_loss: 26447101.7778; train_gene_expr_recon_loss: 2123622.2500; train_masked_gp_l1_reg_loss: 4754.1498; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9584903.5556; train_global_loss: 38306901.7778; train_optim_loss: 38306901.7778; val_kl_reg_loss: 142691.0312; val_edge_recon_loss: 26371950.0000; val_gene_expr_recon_loss: 2133623.0000; val_masked_gp_l1_reg_loss: 4754.1919; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9479759.0000; val_global_loss: 38132776.0000; val_optim_loss: 38132776.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9725; val_auprc_score: 0.9593; val_best_acc_score: 0.9318; val_best_f1_score: 0.9345; train_kl_reg_loss: 146597.9740; train_edge_recon_loss: 26427186.2222; train_gene_expr_recon_loss: 2129804.1944; train_masked_gp_l1_reg_loss: 4754.2395; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9584421.7778; train_global_loss: 38292764.4444; train_optim_loss: 38292764.4444; val_kl_reg_loss: 143102.9062; val_edge_recon_loss: 26202026.0000; val_gene_expr_recon_loss: 2134077.2500; val_masked_gp_l1_reg_loss: 4754.3022; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9481908.0000; val_global_loss: 37965868.0000; val_optim_loss: 37965868.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9671; val_auprc_score: 0.9498; val_best_acc_score: 0.9202; val_best_f1_score: 0.9240; train_kl_reg_loss: 146930.8021; train_edge_recon_loss: 26476887.7778; train_gene_expr_recon_loss: 2116658.5417; train_masked_gp_l1_reg_loss: 4754.3614; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9564207.4444; train_global_loss: 38309439.1111; train_optim_loss: 38309439.1111; val_kl_reg_loss: 142787.2500; val_edge_recon_loss: 26587352.0000; val_gene_expr_recon_loss: 2132766.7500; val_masked_gp_l1_reg_loss: 4754.4312; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9475094.0000; val_global_loss: 38342752.0000; val_optim_loss: 38342752.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9693; val_auprc_score: 0.9541; val_best_acc_score: 0.9244; val_best_f1_score: 0.9273; train_kl_reg_loss: 146069.0538; train_edge_recon_loss: 26467189.3333; train_gene_expr_recon_loss: 2113748.7222; train_masked_gp_l1_reg_loss: 4754.4915; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9587596.0000; train_global_loss: 38319356.8889; train_optim_loss: 38319356.8889; val_kl_reg_loss: 142462.4375; val_edge_recon_loss: 26501328.0000; val_gene_expr_recon_loss: 2132577.0000; val_masked_gp_l1_reg_loss: 4754.5610; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9474477.0000; val_global_loss: 38255600.0000; val_optim_loss: 38255600.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9720; val_auprc_score: 0.9599; val_best_acc_score: 0.9255; val_best_f1_score: 0.9288; train_kl_reg_loss: 146352.9740; train_edge_recon_loss: 26442231.3333; train_gene_expr_recon_loss: 2125129.2222; train_masked_gp_l1_reg_loss: 4754.6177; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9564302.2222; train_global_loss: 38282768.4444; train_optim_loss: 38282768.4444; val_kl_reg_loss: 142100.0156; val_edge_recon_loss: 26470330.0000; val_gene_expr_recon_loss: 2130559.7500; val_masked_gp_l1_reg_loss: 4754.6992; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9454578.0000; val_global_loss: 38202320.0000; val_optim_loss: 38202320.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9657; val_auprc_score: 0.9531; val_best_acc_score: 0.9166; val_best_f1_score: 0.9212; train_kl_reg_loss: 147531.8038; train_edge_recon_loss: 26482478.6667; train_gene_expr_recon_loss: 2126407.3472; train_masked_gp_l1_reg_loss: 4754.7855; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9621123.2222; train_global_loss: 38382295.5556; train_optim_loss: 38382295.5556; val_kl_reg_loss: 143054.5312; val_edge_recon_loss: 26773244.0000; val_gene_expr_recon_loss: 2133198.2500; val_masked_gp_l1_reg_loss: 4754.8794; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9482269.0000; val_global_loss: 38536520.0000; val_optim_loss: 38536520.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9668; val_auprc_score: 0.9477; val_best_acc_score: 0.9201; val_best_f1_score: 0.9229; train_kl_reg_loss: 147239.7222; train_edge_recon_loss: 26375952.6667; train_gene_expr_recon_loss: 2129034.5278; train_masked_gp_l1_reg_loss: 4754.8865; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9624945.1111; train_global_loss: 38281925.7778; train_optim_loss: 38281925.7778; val_kl_reg_loss: 142963.9688; val_edge_recon_loss: 26702482.0000; val_gene_expr_recon_loss: 2134210.0000; val_masked_gp_l1_reg_loss: 4754.8945; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9473427.0000; val_global_loss: 38457836.0000; val_optim_loss: 38457836.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9692; val_auprc_score: 0.9550; val_best_acc_score: 0.9247; val_best_f1_score: 0.9281; train_kl_reg_loss: 146208.1441; train_edge_recon_loss: 26416304.4444; train_gene_expr_recon_loss: 2121646.7361; train_masked_gp_l1_reg_loss: 4754.9007; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9600740.2222; train_global_loss: 38289652.8889; train_optim_loss: 38289652.8889; val_kl_reg_loss: 142169.5781; val_edge_recon_loss: 26427526.0000; val_gene_expr_recon_loss: 2132273.0000; val_masked_gp_l1_reg_loss: 4754.9072; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9466143.0000; val_global_loss: 38172864.0000; val_optim_loss: 38172864.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9681; val_auprc_score: 0.9542; val_best_acc_score: 0.9224; val_best_f1_score: 0.9261; train_kl_reg_loss: 146683.1771; train_edge_recon_loss: 26403900.0000; train_gene_expr_recon_loss: 2131551.3333; train_masked_gp_l1_reg_loss: 4754.9115; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9641220.6667; train_global_loss: 38328108.8889; train_optim_loss: 38328108.8889; val_kl_reg_loss: 142872.2344; val_edge_recon_loss: 26607474.0000; val_gene_expr_recon_loss: 2133014.0000; val_masked_gp_l1_reg_loss: 4754.9160; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9475707.0000; val_global_loss: 38363820.0000; val_optim_loss: 38363820.0000
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9690; val_auprc_score: 0.9563; val_best_acc_score: 0.9233; val_best_f1_score: 0.9268; train_kl_reg_loss: 146394.7830; train_edge_recon_loss: 26444116.6667; train_gene_expr_recon_loss: 2113168.0833; train_masked_gp_l1_reg_loss: 4754.9210; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9556571.0000; train_global_loss: 38265004.8889; train_optim_loss: 38265004.8889; val_kl_reg_loss: 142574.2188; val_edge_recon_loss: 26835046.0000; val_gene_expr_recon_loss: 2132874.5000; val_masked_gp_l1_reg_loss: 4754.9263; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9475156.0000; val_global_loss: 38590404.0000; val_optim_loss: 38590404.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 28 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
Val AUROC score: 0.9682
Val AUPRC score: 0.9541
Val best accuracy score: 0.9254
Val best F1 score: 0.9287
Val gene expr MSE score: 0.4390
Val chrom access MSE score: 0.0854
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
