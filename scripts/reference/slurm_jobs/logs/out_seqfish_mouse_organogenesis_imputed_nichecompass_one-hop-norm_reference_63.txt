[True]
Run timestamp: 26072023_223454_63.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_63']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8787; val_auprc_score: 0.9761; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 260392.3397; train_edge_recon_loss: 1150632.3494; train_gene_expr_recon_loss: 3574907.3430; train_masked_gp_l1_reg_loss: 7977.3074; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4993909.3151; train_optim_loss: 4993909.3151; val_kl_reg_loss: 213801.6719; val_edge_recon_loss: 1208938.9010; val_gene_expr_recon_loss: 2994450.2604; val_masked_gp_l1_reg_loss: 8423.4951; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4425614.3333; val_optim_loss: 4425614.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8647; val_auprc_score: 0.9730; val_best_acc_score: 0.8547; val_best_f1_score: 0.9214; train_kl_reg_loss: 128527.5162; train_edge_recon_loss: 1130669.4090; train_gene_expr_recon_loss: 2345629.4669; train_masked_gp_l1_reg_loss: 8710.5091; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3613536.9151; train_optim_loss: 3613536.9151; val_kl_reg_loss: 60435.7168; val_edge_recon_loss: 1207035.6979; val_gene_expr_recon_loss: 1491410.6667; val_masked_gp_l1_reg_loss: 9089.3965; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2767971.5729; val_optim_loss: 2767971.5729
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8488; val_auprc_score: 0.9706; val_best_acc_score: 0.8587; val_best_f1_score: 0.9225; train_kl_reg_loss: 65360.0434; train_edge_recon_loss: 1088041.7517; train_gene_expr_recon_loss: 1372374.7872; train_masked_gp_l1_reg_loss: 9340.1659; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2535116.7512; train_optim_loss: 2535116.7512; val_kl_reg_loss: 48231.5518; val_edge_recon_loss: 1203068.2839; val_gene_expr_recon_loss: 1064729.8177; val_masked_gp_l1_reg_loss: 9641.2949; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2325670.8958; val_optim_loss: 2325670.8958
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8178; val_auprc_score: 0.9636; val_best_acc_score: 0.8608; val_best_f1_score: 0.9240; train_kl_reg_loss: 55476.4765; train_edge_recon_loss: 1067332.3000; train_gene_expr_recon_loss: 1029662.2387; train_masked_gp_l1_reg_loss: 9728.5683; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2162199.5773; train_optim_loss: 2162199.5773; val_kl_reg_loss: 47117.8133; val_edge_recon_loss: 1190844.2318; val_gene_expr_recon_loss: 1003172.6354; val_masked_gp_l1_reg_loss: 9770.6338; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2250905.4167; val_optim_loss: 2250905.4167
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8187; val_auprc_score: 0.9616; val_best_acc_score: 0.8656; val_best_f1_score: 0.9265; train_kl_reg_loss: 49033.9421; train_edge_recon_loss: 1062746.2291; train_gene_expr_recon_loss: 992073.1587; train_masked_gp_l1_reg_loss: 9813.1047; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2113666.4407; train_optim_loss: 2113666.4407; val_kl_reg_loss: 43095.5768; val_edge_recon_loss: 1140782.3411; val_gene_expr_recon_loss: 975310.2474; val_masked_gp_l1_reg_loss: 9891.5586; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2169079.6823; val_optim_loss: 2169079.6823
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8537; val_auprc_score: 0.9657; val_best_acc_score: 0.8772; val_best_f1_score: 0.9308; train_kl_reg_loss: 40965.0357; train_edge_recon_loss: 1017620.7192; train_gene_expr_recon_loss: 964743.6006; train_masked_gp_l1_reg_loss: 10046.8139; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2033376.1645; train_optim_loss: 2033376.1645; val_kl_reg_loss: 36403.6089; val_edge_recon_loss: 1036140.3516; val_gene_expr_recon_loss: 950324.7057; val_masked_gp_l1_reg_loss: 10260.8730; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2033129.5052; val_optim_loss: 2033129.5052
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8540; val_auprc_score: 0.9671; val_best_acc_score: 0.8890; val_best_f1_score: 0.9382; train_kl_reg_loss: 44095.7573; train_edge_recon_loss: 941199.4727; train_gene_expr_recon_loss: 940012.9049; train_masked_gp_l1_reg_loss: 10582.3530; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1935890.4878; train_optim_loss: 1935890.4878; val_kl_reg_loss: 44155.1613; val_edge_recon_loss: 917422.8802; val_gene_expr_recon_loss: 924894.0911; val_masked_gp_l1_reg_loss: 10882.8652; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1897355.0000; val_optim_loss: 1897355.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8644; val_auprc_score: 0.9691; val_best_acc_score: 0.8941; val_best_f1_score: 0.9411; train_kl_reg_loss: 44862.0600; train_edge_recon_loss: 890448.3727; train_gene_expr_recon_loss: 915747.9965; train_masked_gp_l1_reg_loss: 11108.7971; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1862167.2215; train_optim_loss: 1862167.2215; val_kl_reg_loss: 40859.8343; val_edge_recon_loss: 894628.8646; val_gene_expr_recon_loss: 903628.3906; val_masked_gp_l1_reg_loss: 11310.7178; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1850427.8490; val_optim_loss: 1850427.8490
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8854; val_auprc_score: 0.9750; val_best_acc_score: 0.9023; val_best_f1_score: 0.9449; train_kl_reg_loss: 38800.9910; train_edge_recon_loss: 864192.0410; train_gene_expr_recon_loss: 896052.8709; train_masked_gp_l1_reg_loss: 11459.9906; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1810505.8860; train_optim_loss: 1810505.8860; val_kl_reg_loss: 36571.4632; val_edge_recon_loss: 860871.7656; val_gene_expr_recon_loss: 883931.8464; val_masked_gp_l1_reg_loss: 11585.0566; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1792960.0781; val_optim_loss: 1792960.0781
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8970; val_auprc_score: 0.9783; val_best_acc_score: 0.9067; val_best_f1_score: 0.9472; train_kl_reg_loss: 33186.5059; train_edge_recon_loss: 846928.1506; train_gene_expr_recon_loss: 879035.0346; train_masked_gp_l1_reg_loss: 11665.2475; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1770814.9360; train_optim_loss: 1770814.9360; val_kl_reg_loss: 29045.3649; val_edge_recon_loss: 834359.7083; val_gene_expr_recon_loss: 869204.5729; val_masked_gp_l1_reg_loss: 11723.9053; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1744333.5052; val_optim_loss: 1744333.5052
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9022; val_auprc_score: 0.9779; val_best_acc_score: 0.9091; val_best_f1_score: 0.9479; train_kl_reg_loss: 27486.6126; train_edge_recon_loss: 827998.3206; train_gene_expr_recon_loss: 863799.1866; train_masked_gp_l1_reg_loss: 11745.4216; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1731029.5424; train_optim_loss: 1731029.5424; val_kl_reg_loss: 24913.6097; val_edge_recon_loss: 854354.4740; val_gene_expr_recon_loss: 853852.7552; val_masked_gp_l1_reg_loss: 11748.1885; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1744869.0781; val_optim_loss: 1744869.0781
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9080; val_auprc_score: 0.9798; val_best_acc_score: 0.9169; val_best_f1_score: 0.9524; train_kl_reg_loss: 23622.7182; train_edge_recon_loss: 818212.9956; train_gene_expr_recon_loss: 849520.4006; train_masked_gp_l1_reg_loss: 11704.7632; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1703060.8715; train_optim_loss: 1703060.8715; val_kl_reg_loss: 20928.0095; val_edge_recon_loss: 827047.5417; val_gene_expr_recon_loss: 841097.1510; val_masked_gp_l1_reg_loss: 11641.4258; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1700714.0729; val_optim_loss: 1700714.0729
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9167; val_auprc_score: 0.9809; val_best_acc_score: 0.9194; val_best_f1_score: 0.9537; train_kl_reg_loss: 20124.1149; train_edge_recon_loss: 814234.1640; train_gene_expr_recon_loss: 835829.7956; train_masked_gp_l1_reg_loss: 11533.8412; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1681721.9157; train_optim_loss: 1681721.9157; val_kl_reg_loss: 17813.1059; val_edge_recon_loss: 815977.5547; val_gene_expr_recon_loss: 828443.4583; val_masked_gp_l1_reg_loss: 11409.5908; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1673643.7396; val_optim_loss: 1673643.7396
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9214; val_auprc_score: 0.9827; val_best_acc_score: 0.9140; val_best_f1_score: 0.9507; train_kl_reg_loss: 17335.9287; train_edge_recon_loss: 807075.2616; train_gene_expr_recon_loss: 824309.3375; train_masked_gp_l1_reg_loss: 11271.2825; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1659991.8081; train_optim_loss: 1659991.8081; val_kl_reg_loss: 16574.9556; val_edge_recon_loss: 837456.9349; val_gene_expr_recon_loss: 816651.3177; val_masked_gp_l1_reg_loss: 11120.5967; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1681803.8385; val_optim_loss: 1681803.8385
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9183; val_auprc_score: 0.9812; val_best_acc_score: 0.9165; val_best_f1_score: 0.9521; train_kl_reg_loss: 15551.9798; train_edge_recon_loss: 794127.5250; train_gene_expr_recon_loss: 813565.9529; train_masked_gp_l1_reg_loss: 10955.9226; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1634201.3709; train_optim_loss: 1634201.3709; val_kl_reg_loss: 14374.3365; val_edge_recon_loss: 837429.7266; val_gene_expr_recon_loss: 806875.9531; val_masked_gp_l1_reg_loss: 10792.1992; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1669472.2708; val_optim_loss: 1669472.2708
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9288; val_auprc_score: 0.9843; val_best_acc_score: 0.9197; val_best_f1_score: 0.9538; train_kl_reg_loss: 13800.5558; train_edge_recon_loss: 796887.5512; train_gene_expr_recon_loss: 803869.3331; train_masked_gp_l1_reg_loss: 10630.2987; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1625187.7372; train_optim_loss: 1625187.7372; val_kl_reg_loss: 11914.2384; val_edge_recon_loss: 810709.1068; val_gene_expr_recon_loss: 798835.7161; val_masked_gp_l1_reg_loss: 10456.8223; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1631915.9635; val_optim_loss: 1631915.9635
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9248; val_auprc_score: 0.9827; val_best_acc_score: 0.9236; val_best_f1_score: 0.9560; train_kl_reg_loss: 12766.9317; train_edge_recon_loss: 796998.6012; train_gene_expr_recon_loss: 795561.1140; train_masked_gp_l1_reg_loss: 10286.7619; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1615613.4017; train_optim_loss: 1615613.4017; val_kl_reg_loss: 11414.8442; val_edge_recon_loss: 807271.3880; val_gene_expr_recon_loss: 789599.2057; val_masked_gp_l1_reg_loss: 10116.8730; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1618402.3125; val_optim_loss: 1618402.3125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9425; val_auprc_score: 0.9871; val_best_acc_score: 0.9293; val_best_f1_score: 0.9590; train_kl_reg_loss: 11986.3585; train_edge_recon_loss: 792612.8983; train_gene_expr_recon_loss: 787198.7381; train_masked_gp_l1_reg_loss: 9955.1275; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1601753.1169; train_optim_loss: 1601753.1169; val_kl_reg_loss: 11656.5671; val_edge_recon_loss: 799997.6849; val_gene_expr_recon_loss: 781922.2083; val_masked_gp_l1_reg_loss: 9786.4756; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1603362.9531; val_optim_loss: 1603362.9531
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9389; val_auprc_score: 0.9863; val_best_acc_score: 0.9287; val_best_f1_score: 0.9586; train_kl_reg_loss: 11521.8634; train_edge_recon_loss: 791724.0154; train_gene_expr_recon_loss: 779162.0331; train_masked_gp_l1_reg_loss: 9608.8113; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1592016.7198; train_optim_loss: 1592016.7198; val_kl_reg_loss: 10959.5441; val_edge_recon_loss: 790869.7135; val_gene_expr_recon_loss: 773914.2708; val_masked_gp_l1_reg_loss: 9434.1562; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1585177.6615; val_optim_loss: 1585177.6615
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9488; val_auprc_score: 0.9886; val_best_acc_score: 0.9359; val_best_f1_score: 0.9627; train_kl_reg_loss: 11393.5456; train_edge_recon_loss: 779581.9686; train_gene_expr_recon_loss: 772407.3991; train_masked_gp_l1_reg_loss: 9260.9388; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1572643.8576; train_optim_loss: 1572643.8576; val_kl_reg_loss: 10412.0945; val_edge_recon_loss: 795508.0156; val_gene_expr_recon_loss: 767243.7474; val_masked_gp_l1_reg_loss: 9072.1885; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1582236.0938; val_optim_loss: 1582236.0938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9460; val_auprc_score: 0.9869; val_best_acc_score: 0.9346; val_best_f1_score: 0.9621; train_kl_reg_loss: 10875.9195; train_edge_recon_loss: 780535.7593; train_gene_expr_recon_loss: 765489.0381; train_masked_gp_l1_reg_loss: 8902.4356; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1565803.1523; train_optim_loss: 1565803.1523; val_kl_reg_loss: 10527.3282; val_edge_recon_loss: 798109.7240; val_gene_expr_recon_loss: 760805.1979; val_masked_gp_l1_reg_loss: 8714.8896; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1578157.1146; val_optim_loss: 1578157.1146
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9461; val_auprc_score: 0.9873; val_best_acc_score: 0.9371; val_best_f1_score: 0.9636; train_kl_reg_loss: 10999.4591; train_edge_recon_loss: 776978.2113; train_gene_expr_recon_loss: 759471.2049; train_masked_gp_l1_reg_loss: 8526.2450; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1555975.1174; train_optim_loss: 1555975.1174; val_kl_reg_loss: 10803.6477; val_edge_recon_loss: 774223.2917; val_gene_expr_recon_loss: 754358.3203; val_masked_gp_l1_reg_loss: 8346.7715; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1547732.0000; val_optim_loss: 1547732.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9509; val_auprc_score: 0.9890; val_best_acc_score: 0.9391; val_best_f1_score: 0.9648; train_kl_reg_loss: 10985.6207; train_edge_recon_loss: 774727.2526; train_gene_expr_recon_loss: 753847.4093; train_masked_gp_l1_reg_loss: 8188.0171; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1547748.3035; train_optim_loss: 1547748.3035; val_kl_reg_loss: 10223.1387; val_edge_recon_loss: 776105.4818; val_gene_expr_recon_loss: 749827.8490; val_masked_gp_l1_reg_loss: 8027.3818; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1544183.8385; val_optim_loss: 1544183.8385
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9492; val_auprc_score: 0.9880; val_best_acc_score: 0.9392; val_best_f1_score: 0.9648; train_kl_reg_loss: 11159.4685; train_edge_recon_loss: 775543.4828; train_gene_expr_recon_loss: 748684.2933; train_masked_gp_l1_reg_loss: 7874.1499; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1543261.3965; train_optim_loss: 1543261.3965; val_kl_reg_loss: 10557.0398; val_edge_recon_loss: 809425.7969; val_gene_expr_recon_loss: 745068.6250; val_masked_gp_l1_reg_loss: 7720.8213; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1572772.3385; val_optim_loss: 1572772.3385
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9497; val_auprc_score: 0.9888; val_best_acc_score: 0.9410; val_best_f1_score: 0.9660; train_kl_reg_loss: 11003.4005; train_edge_recon_loss: 773489.7808; train_gene_expr_recon_loss: 743513.2407; train_masked_gp_l1_reg_loss: 7563.7875; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1535570.2093; train_optim_loss: 1535570.2093; val_kl_reg_loss: 10683.0772; val_edge_recon_loss: 775887.1250; val_gene_expr_recon_loss: 739901.8880; val_masked_gp_l1_reg_loss: 7422.7529; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1533894.8438; val_optim_loss: 1533894.8438
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9515; val_auprc_score: 0.9887; val_best_acc_score: 0.9382; val_best_f1_score: 0.9642; train_kl_reg_loss: 10268.6362; train_edge_recon_loss: 770699.4811; train_gene_expr_recon_loss: 740379.4413; train_masked_gp_l1_reg_loss: 7331.1097; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1528678.6692; train_optim_loss: 1528678.6692; val_kl_reg_loss: 7946.7620; val_edge_recon_loss: 805720.6667; val_gene_expr_recon_loss: 736535.3073; val_masked_gp_l1_reg_loss: 7238.1055; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1557440.8750; val_optim_loss: 1557440.8750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9545; val_auprc_score: 0.9888; val_best_acc_score: 0.9405; val_best_f1_score: 0.9655; train_kl_reg_loss: 9467.2577; train_edge_recon_loss: 769831.3270; train_gene_expr_recon_loss: 736122.1311; train_masked_gp_l1_reg_loss: 7123.4093; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1522544.1157; train_optim_loss: 1522544.1157; val_kl_reg_loss: 7382.5692; val_edge_recon_loss: 802250.4323; val_gene_expr_recon_loss: 732848.1094; val_masked_gp_l1_reg_loss: 7009.2476; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1549490.3594; val_optim_loss: 1549490.3594
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9546; val_auprc_score: 0.9892; val_best_acc_score: 0.9435; val_best_f1_score: 0.9673; train_kl_reg_loss: 9231.7055; train_edge_recon_loss: 771827.7436; train_gene_expr_recon_loss: 732731.0189; train_masked_gp_l1_reg_loss: 6894.5874; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1520685.0500; train_optim_loss: 1520685.0500; val_kl_reg_loss: 7238.7004; val_edge_recon_loss: 791050.9948; val_gene_expr_recon_loss: 729688.0052; val_masked_gp_l1_reg_loss: 6791.9312; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1534769.5677; val_optim_loss: 1534769.5677
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9530; val_auprc_score: 0.9887; val_best_acc_score: 0.9426; val_best_f1_score: 0.9667; train_kl_reg_loss: 8882.0990; train_edge_recon_loss: 764845.2753; train_gene_expr_recon_loss: 729398.2599; train_masked_gp_l1_reg_loss: 6702.0541; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1509827.6820; train_optim_loss: 1509827.6820; val_kl_reg_loss: 7085.9236; val_edge_recon_loss: 801487.0755; val_gene_expr_recon_loss: 726241.4401; val_masked_gp_l1_reg_loss: 6604.5317; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1541418.9323; val_optim_loss: 1541418.9323

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9552; val_auprc_score: 0.9894; val_best_acc_score: 0.9445; val_best_f1_score: 0.9677; train_kl_reg_loss: 8608.5381; train_edge_recon_loss: 769773.3404; train_gene_expr_recon_loss: 726438.6956; train_masked_gp_l1_reg_loss: 6574.6971; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1511395.2709; train_optim_loss: 1511395.2709; val_kl_reg_loss: 6933.2501; val_edge_recon_loss: 797434.3307; val_gene_expr_recon_loss: 724442.9766; val_masked_gp_l1_reg_loss: 6563.6338; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1535374.1771; val_optim_loss: 1535374.1771
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9537; val_auprc_score: 0.9891; val_best_acc_score: 0.9449; val_best_f1_score: 0.9680; train_kl_reg_loss: 8706.4636; train_edge_recon_loss: 772299.6206; train_gene_expr_recon_loss: 726020.2820; train_masked_gp_l1_reg_loss: 6555.6361; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1513581.9994; train_optim_loss: 1513581.9994; val_kl_reg_loss: 7041.3047; val_edge_recon_loss: 799762.9635; val_gene_expr_recon_loss: 724326.3359; val_masked_gp_l1_reg_loss: 6548.4717; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1537679.0990; val_optim_loss: 1537679.0990
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9596; val_auprc_score: 0.9909; val_best_acc_score: 0.9474; val_best_f1_score: 0.9696; train_kl_reg_loss: 8612.5023; train_edge_recon_loss: 761335.3826; train_gene_expr_recon_loss: 725357.1244; train_masked_gp_l1_reg_loss: 6540.0385; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1501845.0500; train_optim_loss: 1501845.0500; val_kl_reg_loss: 6974.2662; val_edge_recon_loss: 768728.3542; val_gene_expr_recon_loss: 725054.8281; val_masked_gp_l1_reg_loss: 6533.4448; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1507290.9531; val_optim_loss: 1507290.9531
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9565; val_auprc_score: 0.9901; val_best_acc_score: 0.9471; val_best_f1_score: 0.9693; train_kl_reg_loss: 8525.2605; train_edge_recon_loss: 766574.3730; train_gene_expr_recon_loss: 725435.4863; train_masked_gp_l1_reg_loss: 6527.8385; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1507062.9610; train_optim_loss: 1507062.9610; val_kl_reg_loss: 6937.9665; val_edge_recon_loss: 779459.5078; val_gene_expr_recon_loss: 723866.7734; val_masked_gp_l1_reg_loss: 6520.2861; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1516784.4896; val_optim_loss: 1516784.4896
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9595; val_auprc_score: 0.9906; val_best_acc_score: 0.9483; val_best_f1_score: 0.9702; train_kl_reg_loss: 8487.7165; train_edge_recon_loss: 764875.1323; train_gene_expr_recon_loss: 724775.6363; train_masked_gp_l1_reg_loss: 6513.6242; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1504652.1070; train_optim_loss: 1504652.1070; val_kl_reg_loss: 6969.7726; val_edge_recon_loss: 770784.0339; val_gene_expr_recon_loss: 723449.1406; val_masked_gp_l1_reg_loss: 6504.0059; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1507706.9531; val_optim_loss: 1507706.9531
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9577; val_auprc_score: 0.9903; val_best_acc_score: 0.9503; val_best_f1_score: 0.9712; train_kl_reg_loss: 8513.2141; train_edge_recon_loss: 773422.1901; train_gene_expr_recon_loss: 724141.3517; train_masked_gp_l1_reg_loss: 6490.9815; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1512567.7401; train_optim_loss: 1512567.7401; val_kl_reg_loss: 6890.5145; val_edge_recon_loss: 776854.8021; val_gene_expr_recon_loss: 722792.7682; val_masked_gp_l1_reg_loss: 6478.7524; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1513016.8385; val_optim_loss: 1513016.8385
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9612; val_auprc_score: 0.9915; val_best_acc_score: 0.9471; val_best_f1_score: 0.9692; train_kl_reg_loss: 8432.8227; train_edge_recon_loss: 768120.5593; train_gene_expr_recon_loss: 723974.6471; train_masked_gp_l1_reg_loss: 6467.4725; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1506995.4994; train_optim_loss: 1506995.4994; val_kl_reg_loss: 6896.2111; val_edge_recon_loss: 785012.1042; val_gene_expr_recon_loss: 722551.6536; val_masked_gp_l1_reg_loss: 6457.0811; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1520917.1042; val_optim_loss: 1520917.1042

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9592; val_auprc_score: 0.9910; val_best_acc_score: 0.9484; val_best_f1_score: 0.9702; train_kl_reg_loss: 8382.6009; train_edge_recon_loss: 763987.0253; train_gene_expr_recon_loss: 723335.4192; train_masked_gp_l1_reg_loss: 6452.5852; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1502157.6314; train_optim_loss: 1502157.6314; val_kl_reg_loss: 6865.0716; val_edge_recon_loss: 778208.4609; val_gene_expr_recon_loss: 721960.4870; val_masked_gp_l1_reg_loss: 6450.5000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1513484.5365; val_optim_loss: 1513484.5365
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9585; val_auprc_score: 0.9905; val_best_acc_score: 0.9482; val_best_f1_score: 0.9700; train_kl_reg_loss: 8351.3797; train_edge_recon_loss: 769761.4398; train_gene_expr_recon_loss: 723453.8017; train_masked_gp_l1_reg_loss: 6449.1517; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1508015.7727; train_optim_loss: 1508015.7727; val_kl_reg_loss: 6837.0343; val_edge_recon_loss: 775194.3125; val_gene_expr_recon_loss: 723092.7005; val_masked_gp_l1_reg_loss: 6447.8457; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1511571.9271; val_optim_loss: 1511571.9271
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9587; val_auprc_score: 0.9908; val_best_acc_score: 0.9466; val_best_f1_score: 0.9691; train_kl_reg_loss: 8352.8103; train_edge_recon_loss: 758773.8776; train_gene_expr_recon_loss: 723349.1029; train_masked_gp_l1_reg_loss: 6446.1383; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1496921.9314; train_optim_loss: 1496921.9314; val_kl_reg_loss: 6874.6194; val_edge_recon_loss: 796784.2344; val_gene_expr_recon_loss: 722211.9167; val_masked_gp_l1_reg_loss: 6444.6426; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1532315.3906; val_optim_loss: 1532315.3906
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9606; val_auprc_score: 0.9907; val_best_acc_score: 0.9513; val_best_f1_score: 0.9718; train_kl_reg_loss: 8355.9302; train_edge_recon_loss: 767220.7297; train_gene_expr_recon_loss: 723342.8215; train_masked_gp_l1_reg_loss: 6443.1175; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505362.6023; train_optim_loss: 1505362.6023; val_kl_reg_loss: 6860.6774; val_edge_recon_loss: 774397.0312; val_gene_expr_recon_loss: 722162.7786; val_masked_gp_l1_reg_loss: 6442.0303; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1509862.4948; val_optim_loss: 1509862.4948

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 52 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9560
Val AUPRC score: 0.9902
Val best accuracy score: 0.9473
Val best F1 score: 0.9695
Val gene expr MSE score: 150375.3774
Val cat covariate0 mean sim diff: -0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
