[True]
Run timestamp: 08082023_035802_63.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_63']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1797, n_latent: 1797, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9217; val_auprc_score: 0.9844; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 153306.5128; train_edge_recon_loss: 1116496.9844; train_gene_expr_recon_loss: 1807706.3017; train_masked_gp_l1_reg_loss: 19998.5592; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3097508.3750; train_optim_loss: 3097508.3750; val_kl_reg_loss: 130743.1100; val_edge_recon_loss: 1210460.6771; val_gene_expr_recon_loss: 1151513.1562; val_masked_gp_l1_reg_loss: 18787.9258; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2511504.9167; val_optim_loss: 2511504.9167
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8985; val_auprc_score: 0.9797; val_best_acc_score: 0.8554; val_best_f1_score: 0.9218; train_kl_reg_loss: 132320.0901; train_edge_recon_loss: 1115676.9832; train_gene_expr_recon_loss: 1128820.9844; train_masked_gp_l1_reg_loss: 17523.8281; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2394341.8942; train_optim_loss: 2394341.8942; val_kl_reg_loss: 109894.8158; val_edge_recon_loss: 1195235.3021; val_gene_expr_recon_loss: 1096340.0833; val_masked_gp_l1_reg_loss: 16617.5469; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2418087.7083; val_optim_loss: 2418087.7083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8504; val_auprc_score: 0.9683; val_best_acc_score: 0.8811; val_best_f1_score: 0.9343; train_kl_reg_loss: 96828.1846; train_edge_recon_loss: 1090204.4429; train_gene_expr_recon_loss: 1077913.7752; train_masked_gp_l1_reg_loss: 16193.1044; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2281139.5361; train_optim_loss: 2281139.5361; val_kl_reg_loss: 78792.5254; val_edge_recon_loss: 1149929.7917; val_gene_expr_recon_loss: 1037536.9375; val_masked_gp_l1_reg_loss: 15998.8037; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2282258.0208; val_optim_loss: 2282258.0208
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8723; val_auprc_score: 0.9696; val_best_acc_score: 0.9065; val_best_f1_score: 0.9473; train_kl_reg_loss: 84023.8466; train_edge_recon_loss: 1029549.3642; train_gene_expr_recon_loss: 1010044.2254; train_masked_gp_l1_reg_loss: 16073.3627; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2139690.7933; train_optim_loss: 2139690.7933; val_kl_reg_loss: 87070.5065; val_edge_recon_loss: 988427.1823; val_gene_expr_recon_loss: 993662.8542; val_masked_gp_l1_reg_loss: 16203.6699; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2085364.2188; val_optim_loss: 2085364.2188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8763; val_auprc_score: 0.9712; val_best_acc_score: 0.9114; val_best_f1_score: 0.9502; train_kl_reg_loss: 85204.2145; train_edge_recon_loss: 953414.5204; train_gene_expr_recon_loss: 982371.3005; train_masked_gp_l1_reg_loss: 16418.3616; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2037408.3978; train_optim_loss: 2037408.3978; val_kl_reg_loss: 78947.6953; val_edge_recon_loss: 941321.5104; val_gene_expr_recon_loss: 969387.7760; val_masked_gp_l1_reg_loss: 16638.2832; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2006295.2188; val_optim_loss: 2006295.2188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8806; val_auprc_score: 0.9729; val_best_acc_score: 0.9140; val_best_f1_score: 0.9517; train_kl_reg_loss: 77084.2840; train_edge_recon_loss: 927660.1352; train_gene_expr_recon_loss: 959286.2242; train_masked_gp_l1_reg_loss: 16878.0349; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1980908.6815; train_optim_loss: 1980908.6815; val_kl_reg_loss: 73920.2891; val_edge_recon_loss: 912023.1458; val_gene_expr_recon_loss: 947425.4427; val_masked_gp_l1_reg_loss: 17138.4258; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1950507.2500; val_optim_loss: 1950507.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8920; val_auprc_score: 0.9764; val_best_acc_score: 0.9144; val_best_f1_score: 0.9521; train_kl_reg_loss: 70127.6168; train_edge_recon_loss: 908836.5072; train_gene_expr_recon_loss: 937425.0583; train_masked_gp_l1_reg_loss: 17415.6372; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1933804.8149; train_optim_loss: 1933804.8149; val_kl_reg_loss: 66299.4980; val_edge_recon_loss: 897263.9167; val_gene_expr_recon_loss: 927585.2865; val_masked_gp_l1_reg_loss: 17685.9922; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1908834.7083; val_optim_loss: 1908834.7083
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9172; val_auprc_score: 0.9810; val_best_acc_score: 0.9265; val_best_f1_score: 0.9578; train_kl_reg_loss: 63254.2192; train_edge_recon_loss: 893195.2266; train_gene_expr_recon_loss: 919760.2764; train_masked_gp_l1_reg_loss: 17935.1262; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1894144.8462; train_optim_loss: 1894144.8462; val_kl_reg_loss: 61246.0326; val_edge_recon_loss: 893432.7969; val_gene_expr_recon_loss: 911629.5781; val_masked_gp_l1_reg_loss: 18194.2793; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1884502.6562; val_optim_loss: 1884502.6562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9308; val_auprc_score: 0.9847; val_best_acc_score: 0.9358; val_best_f1_score: 0.9634; train_kl_reg_loss: 61396.0759; train_edge_recon_loss: 862422.6052; train_gene_expr_recon_loss: 904469.1214; train_masked_gp_l1_reg_loss: 18439.4501; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1846727.2572; train_optim_loss: 1846727.2572; val_kl_reg_loss: 57837.1849; val_edge_recon_loss: 867835.9323; val_gene_expr_recon_loss: 897444.3646; val_masked_gp_l1_reg_loss: 18675.0078; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1841792.4792; val_optim_loss: 1841792.4792
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9393; val_auprc_score: 0.9867; val_best_acc_score: 0.9391; val_best_f1_score: 0.9652; train_kl_reg_loss: 56587.6978; train_edge_recon_loss: 848792.9681; train_gene_expr_recon_loss: 890261.2115; train_masked_gp_l1_reg_loss: 18890.9825; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1814532.8702; train_optim_loss: 1814532.8702; val_kl_reg_loss: 54204.4570; val_edge_recon_loss: 846657.6823; val_gene_expr_recon_loss: 883450.1510; val_masked_gp_l1_reg_loss: 19086.7559; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1803399.0208; val_optim_loss: 1803399.0208
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9447; val_auprc_score: 0.9877; val_best_acc_score: 0.9396; val_best_f1_score: 0.9653; train_kl_reg_loss: 50951.2021; train_edge_recon_loss: 845252.4393; train_gene_expr_recon_loss: 877004.6238; train_masked_gp_l1_reg_loss: 19246.8052; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1792455.0709; train_optim_loss: 1792455.0709; val_kl_reg_loss: 47502.9271; val_edge_recon_loss: 835872.1354; val_gene_expr_recon_loss: 871031.9688; val_masked_gp_l1_reg_loss: 19406.9961; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1773814.0312; val_optim_loss: 1773814.0312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9476; val_auprc_score: 0.9879; val_best_acc_score: 0.9404; val_best_f1_score: 0.9657; train_kl_reg_loss: 45728.7432; train_edge_recon_loss: 831900.6208; train_gene_expr_recon_loss: 865026.7969; train_masked_gp_l1_reg_loss: 19500.1255; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1762156.2825; train_optim_loss: 1762156.2825; val_kl_reg_loss: 43402.8981; val_edge_recon_loss: 835575.3125; val_gene_expr_recon_loss: 858146.5104; val_masked_gp_l1_reg_loss: 19581.2246; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1756705.9479; val_optim_loss: 1756705.9479
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9516; val_auprc_score: 0.9893; val_best_acc_score: 0.9432; val_best_f1_score: 0.9674; train_kl_reg_loss: 40247.4087; train_edge_recon_loss: 830113.8534; train_gene_expr_recon_loss: 853502.7716; train_masked_gp_l1_reg_loss: 19599.8814; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1743463.9183; train_optim_loss: 1743463.9183; val_kl_reg_loss: 36506.2653; val_edge_recon_loss: 819748.6615; val_gene_expr_recon_loss: 848111.0677; val_masked_gp_l1_reg_loss: 19601.3984; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1723967.3542; val_optim_loss: 1723967.3542
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9544; val_auprc_score: 0.9898; val_best_acc_score: 0.9445; val_best_f1_score: 0.9679; train_kl_reg_loss: 35061.3027; train_edge_recon_loss: 815410.5162; train_gene_expr_recon_loss: 843168.8059; train_masked_gp_l1_reg_loss: 19539.2277; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1713179.8582; train_optim_loss: 1713179.8582; val_kl_reg_loss: 32734.7520; val_edge_recon_loss: 822166.0260; val_gene_expr_recon_loss: 838030.3854; val_masked_gp_l1_reg_loss: 19450.0703; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1712381.2917; val_optim_loss: 1712381.2917
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9625; val_auprc_score: 0.9914; val_best_acc_score: 0.9521; val_best_f1_score: 0.9722; train_kl_reg_loss: 30415.1511; train_edge_recon_loss: 808327.6767; train_gene_expr_recon_loss: 833393.4543; train_masked_gp_l1_reg_loss: 19283.1215; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1691419.4026; train_optim_loss: 1691419.4026; val_kl_reg_loss: 27486.9391; val_edge_recon_loss: 807200.0573; val_gene_expr_recon_loss: 830133.4323; val_masked_gp_l1_reg_loss: 19081.5195; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1683901.9479; val_optim_loss: 1683901.9479
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9671; val_auprc_score: 0.9927; val_best_acc_score: 0.9567; val_best_f1_score: 0.9749; train_kl_reg_loss: 26371.5058; train_edge_recon_loss: 800119.9892; train_gene_expr_recon_loss: 824370.4387; train_masked_gp_l1_reg_loss: 18828.5441; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1669690.4639; train_optim_loss: 1669690.4639; val_kl_reg_loss: 23855.0381; val_edge_recon_loss: 785027.6875; val_gene_expr_recon_loss: 820479.9375; val_masked_gp_l1_reg_loss: 18532.3887; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1647895.0208; val_optim_loss: 1647895.0208
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9667; val_auprc_score: 0.9925; val_best_acc_score: 0.9570; val_best_f1_score: 0.9751; train_kl_reg_loss: 23204.7192; train_edge_recon_loss: 794488.8894; train_gene_expr_recon_loss: 815689.1659; train_masked_gp_l1_reg_loss: 18188.3834; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1651571.1587; train_optim_loss: 1651571.1587; val_kl_reg_loss: 21324.9256; val_edge_recon_loss: 794728.3385; val_gene_expr_recon_loss: 811722.4219; val_masked_gp_l1_reg_loss: 17800.3750; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1645576.0521; val_optim_loss: 1645576.0521
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9695; val_auprc_score: 0.9924; val_best_acc_score: 0.9609; val_best_f1_score: 0.9773; train_kl_reg_loss: 20494.5899; train_edge_recon_loss: 791035.4886; train_gene_expr_recon_loss: 806760.9916; train_masked_gp_l1_reg_loss: 17382.4672; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1635673.5337; train_optim_loss: 1635673.5337; val_kl_reg_loss: 19324.3315; val_edge_recon_loss: 781012.4010; val_gene_expr_recon_loss: 803295.3281; val_masked_gp_l1_reg_loss: 16936.0664; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1620568.1771; val_optim_loss: 1620568.1771
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9738; val_auprc_score: 0.9940; val_best_acc_score: 0.9644; val_best_f1_score: 0.9793; train_kl_reg_loss: 18384.1351; train_edge_recon_loss: 785196.8017; train_gene_expr_recon_loss: 799239.5925; train_masked_gp_l1_reg_loss: 16468.6163; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1619289.1526; train_optim_loss: 1619289.1526; val_kl_reg_loss: 17168.0288; val_edge_recon_loss: 785561.9062; val_gene_expr_recon_loss: 795546.0417; val_masked_gp_l1_reg_loss: 15980.0020; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1614255.9688; val_optim_loss: 1614255.9688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9749; val_auprc_score: 0.9939; val_best_acc_score: 0.9651; val_best_f1_score: 0.9797; train_kl_reg_loss: 16523.8941; train_edge_recon_loss: 779553.5547; train_gene_expr_recon_loss: 791584.6701; train_masked_gp_l1_reg_loss: 15537.3940; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1603199.5228; train_optim_loss: 1603199.5228; val_kl_reg_loss: 15503.5782; val_edge_recon_loss: 783299.9583; val_gene_expr_recon_loss: 788137.7344; val_masked_gp_l1_reg_loss: 15074.7666; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1602016.0104; val_optim_loss: 1602016.0104
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9769; val_auprc_score: 0.9944; val_best_acc_score: 0.9677; val_best_f1_score: 0.9812; train_kl_reg_loss: 15239.2652; train_edge_recon_loss: 775581.6496; train_gene_expr_recon_loss: 784923.2338; train_masked_gp_l1_reg_loss: 14654.3318; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1590398.4772; train_optim_loss: 1590398.4772; val_kl_reg_loss: 15053.6353; val_edge_recon_loss: 776347.7500; val_gene_expr_recon_loss: 782275.5260; val_masked_gp_l1_reg_loss: 14224.4814; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1587901.3958; val_optim_loss: 1587901.3958
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9778; val_auprc_score: 0.9946; val_best_acc_score: 0.9689; val_best_f1_score: 0.9820; train_kl_reg_loss: 14395.3483; train_edge_recon_loss: 776815.4591; train_gene_expr_recon_loss: 778217.5811; train_masked_gp_l1_reg_loss: 13809.8439; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1583238.2175; train_optim_loss: 1583238.2175; val_kl_reg_loss: 13434.5439; val_edge_recon_loss: 766954.5469; val_gene_expr_recon_loss: 775128.2344; val_masked_gp_l1_reg_loss: 13426.8447; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1568944.1979; val_optim_loss: 1568944.1979
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9803; val_auprc_score: 0.9949; val_best_acc_score: 0.9709; val_best_f1_score: 0.9831; train_kl_reg_loss: 13706.5608; train_edge_recon_loss: 771854.4880; train_gene_expr_recon_loss: 772312.1178; train_masked_gp_l1_reg_loss: 13060.4143; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1570933.5925; train_optim_loss: 1570933.5925; val_kl_reg_loss: 13265.2420; val_edge_recon_loss: 766417.0000; val_gene_expr_recon_loss: 769090.0625; val_masked_gp_l1_reg_loss: 12708.6895; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1561481.0625; val_optim_loss: 1561481.0625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9780; val_auprc_score: 0.9944; val_best_acc_score: 0.9699; val_best_f1_score: 0.9825; train_kl_reg_loss: 13183.8882; train_edge_recon_loss: 770162.2242; train_gene_expr_recon_loss: 766616.7764; train_masked_gp_l1_reg_loss: 12384.5230; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1562347.4002; train_optim_loss: 1562347.4002; val_kl_reg_loss: 12847.8703; val_edge_recon_loss: 790254.4375; val_gene_expr_recon_loss: 765243.6719; val_masked_gp_l1_reg_loss: 12087.8594; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1580433.8333; val_optim_loss: 1580433.8333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9793; val_auprc_score: 0.9948; val_best_acc_score: 0.9716; val_best_f1_score: 0.9835; train_kl_reg_loss: 12934.2266; train_edge_recon_loss: 766782.7344; train_gene_expr_recon_loss: 761560.8359; train_masked_gp_l1_reg_loss: 11795.7201; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1553073.5204; train_optim_loss: 1553073.5204; val_kl_reg_loss: 12750.7129; val_edge_recon_loss: 762351.3438; val_gene_expr_recon_loss: 759822.3958; val_masked_gp_l1_reg_loss: 11534.3633; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1546458.8438; val_optim_loss: 1546458.8438
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9811; val_auprc_score: 0.9958; val_best_acc_score: 0.9723; val_best_f1_score: 0.9839; train_kl_reg_loss: 10272.8933; train_edge_recon_loss: 770367.4087; train_gene_expr_recon_loss: 766261.6100; train_masked_gp_l1_reg_loss: 11399.7798; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1558301.6887; train_optim_loss: 1558301.6887; val_kl_reg_loss: 7995.6681; val_edge_recon_loss: 766822.7448; val_gene_expr_recon_loss: 763605.1302; val_masked_gp_l1_reg_loss: 11165.8770; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1549589.4062; val_optim_loss: 1549589.4062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9800; val_auprc_score: 0.9948; val_best_acc_score: 0.9731; val_best_f1_score: 0.9843; train_kl_reg_loss: 9245.1131; train_edge_recon_loss: 768847.2542; train_gene_expr_recon_loss: 759631.6971; train_masked_gp_l1_reg_loss: 10942.0348; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1548666.0986; train_optim_loss: 1548666.0986; val_kl_reg_loss: 7418.3871; val_edge_recon_loss: 774544.9948; val_gene_expr_recon_loss: 757174.4115; val_masked_gp_l1_reg_loss: 10714.8145; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1549852.6562; val_optim_loss: 1549852.6562
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9810; val_auprc_score: 0.9953; val_best_acc_score: 0.9736; val_best_f1_score: 0.9847; train_kl_reg_loss: 8744.9507; train_edge_recon_loss: 771068.3197; train_gene_expr_recon_loss: 754243.1514; train_masked_gp_l1_reg_loss: 10510.5151; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1544566.9351; train_optim_loss: 1544566.9351; val_kl_reg_loss: 7587.9709; val_edge_recon_loss: 766603.0417; val_gene_expr_recon_loss: 752688.3125; val_masked_gp_l1_reg_loss: 10314.1689; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1537193.4583; val_optim_loss: 1537193.4583
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9822; val_auprc_score: 0.9958; val_best_acc_score: 0.9745; val_best_f1_score: 0.9851; train_kl_reg_loss: 8622.7958; train_edge_recon_loss: 768142.6905; train_gene_expr_recon_loss: 749163.5871; train_masked_gp_l1_reg_loss: 10135.6675; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1536064.7452; train_optim_loss: 1536064.7452; val_kl_reg_loss: 7453.6009; val_edge_recon_loss: 774977.7292; val_gene_expr_recon_loss: 746893.3594; val_masked_gp_l1_reg_loss: 9962.5088; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1539287.1979; val_optim_loss: 1539287.1979
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9839; val_auprc_score: 0.9961; val_best_acc_score: 0.9752; val_best_f1_score: 0.9856; train_kl_reg_loss: 8421.7088; train_edge_recon_loss: 764679.7740; train_gene_expr_recon_loss: 744965.3209; train_masked_gp_l1_reg_loss: 9791.1186; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1527857.9195; train_optim_loss: 1527857.9195; val_kl_reg_loss: 7304.7986; val_edge_recon_loss: 764788.3802; val_gene_expr_recon_loss: 743684.2135; val_masked_gp_l1_reg_loss: 9657.2617; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1525434.6458; val_optim_loss: 1525434.6458
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9810; val_auprc_score: 0.9952; val_best_acc_score: 0.9739; val_best_f1_score: 0.9848; train_kl_reg_loss: 8238.8871; train_edge_recon_loss: 767663.1316; train_gene_expr_recon_loss: 741444.9363; train_masked_gp_l1_reg_loss: 9496.3610; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1526843.3257; train_optim_loss: 1526843.3257; val_kl_reg_loss: 7073.9342; val_edge_recon_loss: 765840.1510; val_gene_expr_recon_loss: 740715.6927; val_masked_gp_l1_reg_loss: 9365.1816; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1522994.9062; val_optim_loss: 1522994.9062
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9835; val_auprc_score: 0.9959; val_best_acc_score: 0.9753; val_best_f1_score: 0.9856; train_kl_reg_loss: 8002.6818; train_edge_recon_loss: 765273.8684; train_gene_expr_recon_loss: 737853.5397; train_masked_gp_l1_reg_loss: 9222.9719; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1520353.0577; train_optim_loss: 1520353.0577; val_kl_reg_loss: 7105.2226; val_edge_recon_loss: 767476.8750; val_gene_expr_recon_loss: 736667.5729; val_masked_gp_l1_reg_loss: 9086.9717; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1520336.6562; val_optim_loss: 1520336.6562
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9842; val_auprc_score: 0.9966; val_best_acc_score: 0.9750; val_best_f1_score: 0.9855; train_kl_reg_loss: 7742.1408; train_edge_recon_loss: 765365.6058; train_gene_expr_recon_loss: 734674.1881; train_masked_gp_l1_reg_loss: 8973.7915; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1516755.7260; train_optim_loss: 1516755.7260; val_kl_reg_loss: 7105.4534; val_edge_recon_loss: 761374.5469; val_gene_expr_recon_loss: 733855.8385; val_masked_gp_l1_reg_loss: 8874.0439; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1511209.8229; val_optim_loss: 1511209.8229
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9810; val_auprc_score: 0.9953; val_best_acc_score: 0.9753; val_best_f1_score: 0.9856; train_kl_reg_loss: 7717.9216; train_edge_recon_loss: 767929.5571; train_gene_expr_recon_loss: 731799.8053; train_masked_gp_l1_reg_loss: 8771.4312; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1516218.7200; train_optim_loss: 1516218.7200; val_kl_reg_loss: 6992.8222; val_edge_recon_loss: 771873.9688; val_gene_expr_recon_loss: 730295.0104; val_masked_gp_l1_reg_loss: 8657.4395; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1517819.3021; val_optim_loss: 1517819.3021
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9835; val_auprc_score: 0.9958; val_best_acc_score: 0.9769; val_best_f1_score: 0.9865; train_kl_reg_loss: 7511.0223; train_edge_recon_loss: 763736.4694; train_gene_expr_recon_loss: 728853.0703; train_masked_gp_l1_reg_loss: 8580.3200; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1508680.8834; train_optim_loss: 1508680.8834; val_kl_reg_loss: 6678.9815; val_edge_recon_loss: 775720.3646; val_gene_expr_recon_loss: 727720.5729; val_masked_gp_l1_reg_loss: 8490.4941; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1518610.4167; val_optim_loss: 1518610.4167
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9833; val_auprc_score: 0.9961; val_best_acc_score: 0.9774; val_best_f1_score: 0.9869; train_kl_reg_loss: 7483.2183; train_edge_recon_loss: 764691.9309; train_gene_expr_recon_loss: 725970.3936; train_masked_gp_l1_reg_loss: 8405.2112; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1506550.7668; train_optim_loss: 1506550.7668; val_kl_reg_loss: 6812.9970; val_edge_recon_loss: 763395.2135; val_gene_expr_recon_loss: 725647.9635; val_masked_gp_l1_reg_loss: 8302.6787; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1504158.8021; val_optim_loss: 1504158.8021
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9830; val_auprc_score: 0.9958; val_best_acc_score: 0.9773; val_best_f1_score: 0.9867; train_kl_reg_loss: 7433.4809; train_edge_recon_loss: 766357.1617; train_gene_expr_recon_loss: 723397.7121; train_masked_gp_l1_reg_loss: 8219.3790; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505407.7320; train_optim_loss: 1505407.7320; val_kl_reg_loss: 6844.1143; val_edge_recon_loss: 773365.9375; val_gene_expr_recon_loss: 723456.8698; val_masked_gp_l1_reg_loss: 8142.8350; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1511809.8021; val_optim_loss: 1511809.8021
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9844; val_auprc_score: 0.9964; val_best_acc_score: 0.9770; val_best_f1_score: 0.9866; train_kl_reg_loss: 7351.0417; train_edge_recon_loss: 762947.1773; train_gene_expr_recon_loss: 720967.5733; train_masked_gp_l1_reg_loss: 8076.4239; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1499342.2188; train_optim_loss: 1499342.2188; val_kl_reg_loss: 6629.2348; val_edge_recon_loss: 759139.0781; val_gene_expr_recon_loss: 720787.8281; val_masked_gp_l1_reg_loss: 8000.4727; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1494556.6562; val_optim_loss: 1494556.6562
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9832; val_auprc_score: 0.9957; val_best_acc_score: 0.9775; val_best_f1_score: 0.9869; train_kl_reg_loss: 7260.1182; train_edge_recon_loss: 766362.3906; train_gene_expr_recon_loss: 718559.6743; train_masked_gp_l1_reg_loss: 7944.8963; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1500127.0757; train_optim_loss: 1500127.0757; val_kl_reg_loss: 6685.5999; val_edge_recon_loss: 762336.6250; val_gene_expr_recon_loss: 718769.1146; val_masked_gp_l1_reg_loss: 7891.8940; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1495683.2396; val_optim_loss: 1495683.2396
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9831; val_auprc_score: 0.9958; val_best_acc_score: 0.9763; val_best_f1_score: 0.9862; train_kl_reg_loss: 7229.5053; train_edge_recon_loss: 760458.2398; train_gene_expr_recon_loss: 716102.5733; train_masked_gp_l1_reg_loss: 7831.2330; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1491621.5469; train_optim_loss: 1491621.5469; val_kl_reg_loss: 6647.6610; val_edge_recon_loss: 768203.9948; val_gene_expr_recon_loss: 715146.1875; val_masked_gp_l1_reg_loss: 7777.2236; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1497775.1042; val_optim_loss: 1497775.1042
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9817; val_auprc_score: 0.9951; val_best_acc_score: 0.9758; val_best_f1_score: 0.9859; train_kl_reg_loss: 7120.5964; train_edge_recon_loss: 766470.3600; train_gene_expr_recon_loss: 714110.3005; train_masked_gp_l1_reg_loss: 7722.0848; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1495423.3450; train_optim_loss: 1495423.3450; val_kl_reg_loss: 6587.7708; val_edge_recon_loss: 773224.9427; val_gene_expr_recon_loss: 714563.7396; val_masked_gp_l1_reg_loss: 7674.2920; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1502050.6979; val_optim_loss: 1502050.6979
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9829; val_auprc_score: 0.9958; val_best_acc_score: 0.9777; val_best_f1_score: 0.9871; train_kl_reg_loss: 7092.7850; train_edge_recon_loss: 762826.6106; train_gene_expr_recon_loss: 712137.2987; train_masked_gp_l1_reg_loss: 7619.2519; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1489675.9483; train_optim_loss: 1489675.9483; val_kl_reg_loss: 6594.7018; val_edge_recon_loss: 751392.3646; val_gene_expr_recon_loss: 712134.7917; val_masked_gp_l1_reg_loss: 7570.9072; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1477692.7292; val_optim_loss: 1477692.7292
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9825; val_auprc_score: 0.9957; val_best_acc_score: 0.9774; val_best_f1_score: 0.9869; train_kl_reg_loss: 7031.2242; train_edge_recon_loss: 764076.6022; train_gene_expr_recon_loss: 709935.7746; train_masked_gp_l1_reg_loss: 7528.9071; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1488572.5060; train_optim_loss: 1488572.5060; val_kl_reg_loss: 6661.1603; val_edge_recon_loss: 758782.8802; val_gene_expr_recon_loss: 710772.3698; val_masked_gp_l1_reg_loss: 7480.4834; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1483696.8958; val_optim_loss: 1483696.8958
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9836; val_auprc_score: 0.9960; val_best_acc_score: 0.9773; val_best_f1_score: 0.9868; train_kl_reg_loss: 7012.9855; train_edge_recon_loss: 762902.8275; train_gene_expr_recon_loss: 708183.2350; train_masked_gp_l1_reg_loss: 7435.9437; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1485534.9940; train_optim_loss: 1485534.9940; val_kl_reg_loss: 6631.9775; val_edge_recon_loss: 762864.8698; val_gene_expr_recon_loss: 708233.4531; val_masked_gp_l1_reg_loss: 7405.5522; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1485135.8125; val_optim_loss: 1485135.8125
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9839; val_auprc_score: 0.9959; val_best_acc_score: 0.9778; val_best_f1_score: 0.9871; train_kl_reg_loss: 6997.5465; train_edge_recon_loss: 764283.0325; train_gene_expr_recon_loss: 706425.8431; train_masked_gp_l1_reg_loss: 7358.5613; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1485064.9808; train_optim_loss: 1485064.9808; val_kl_reg_loss: 6659.2136; val_edge_recon_loss: 763567.8854; val_gene_expr_recon_loss: 706878.0052; val_masked_gp_l1_reg_loss: 7311.0732; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1484416.2500; val_optim_loss: 1484416.2500
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9836; val_auprc_score: 0.9961; val_best_acc_score: 0.9775; val_best_f1_score: 0.9869; train_kl_reg_loss: 7003.9834; train_edge_recon_loss: 759659.1923; train_gene_expr_recon_loss: 704662.2770; train_masked_gp_l1_reg_loss: 7277.3039; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1478602.7596; train_optim_loss: 1478602.7596; val_kl_reg_loss: 6595.5785; val_edge_recon_loss: 760199.5052; val_gene_expr_recon_loss: 704589.9792; val_masked_gp_l1_reg_loss: 7240.7549; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1478625.8125; val_optim_loss: 1478625.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9858; val_auprc_score: 0.9962; val_best_acc_score: 0.9788; val_best_f1_score: 0.9876; train_kl_reg_loss: 6952.1739; train_edge_recon_loss: 764118.3882; train_gene_expr_recon_loss: 703462.6845; train_masked_gp_l1_reg_loss: 7124.0666; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1481657.3113; train_optim_loss: 1481657.3113; val_kl_reg_loss: 6568.1897; val_edge_recon_loss: 765450.1771; val_gene_expr_recon_loss: 704075.8594; val_masked_gp_l1_reg_loss: 7107.3301; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1483201.6042; val_optim_loss: 1483201.6042
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9839; val_auprc_score: 0.9959; val_best_acc_score: 0.9770; val_best_f1_score: 0.9866; train_kl_reg_loss: 6904.4205; train_edge_recon_loss: 763020.3726; train_gene_expr_recon_loss: 703124.8323; train_masked_gp_l1_reg_loss: 7104.3648; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1480153.9928; train_optim_loss: 1480153.9928; val_kl_reg_loss: 6512.9860; val_edge_recon_loss: 771393.1875; val_gene_expr_recon_loss: 704472.9792; val_masked_gp_l1_reg_loss: 7101.3809; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1489480.5312; val_optim_loss: 1489480.5312
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9826; val_auprc_score: 0.9957; val_best_acc_score: 0.9778; val_best_f1_score: 0.9871; train_kl_reg_loss: 6900.8525; train_edge_recon_loss: 759800.3870; train_gene_expr_recon_loss: 702998.6502; train_masked_gp_l1_reg_loss: 7101.5389; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1476801.4267; train_optim_loss: 1476801.4267; val_kl_reg_loss: 6517.6089; val_edge_recon_loss: 775735.7969; val_gene_expr_recon_loss: 704560.7656; val_masked_gp_l1_reg_loss: 7100.5967; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1493914.7812; val_optim_loss: 1493914.7812
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9826; val_auprc_score: 0.9956; val_best_acc_score: 0.9774; val_best_f1_score: 0.9868; train_kl_reg_loss: 6852.6704; train_edge_recon_loss: 760528.0577; train_gene_expr_recon_loss: 702919.2981; train_masked_gp_l1_reg_loss: 7101.3769; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1477401.4062; train_optim_loss: 1477401.4062; val_kl_reg_loss: 6485.6685; val_edge_recon_loss: 775092.2031; val_gene_expr_recon_loss: 703771.7656; val_masked_gp_l1_reg_loss: 7100.6226; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1492450.2500; val_optim_loss: 1492450.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 140 min 34 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9846
val AUPRC score: 0.9965
val best accuracy score: 0.9773
val best F1 score: 0.9868
val target rna MSE score: 2.4303
val source rna MSE score: 0.6620
Val cat covariate0 mean sim diff: 0.0000

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
