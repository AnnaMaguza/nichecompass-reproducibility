Run timestamp: 14062023_181757.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', '4', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 500, n_cond_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 803, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 803, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 803, n_cond_embed_input: 4, n_addon_input: 0, n_output: 1000
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 500, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 759633
Number of validation nodes: 84404
Number of training edges: 3524470
Number of validation edges: 391607
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9856; val_auprc_score: 0.9952; val_best_acc_score: 0.9523; val_best_f1_score: 0.9690; train_kl_reg_loss: 3723.9658; train_edge_recon_loss: 126275.3141; train_gene_expr_recon_loss: 120830.9295; train_masked_gp_l1_reg_loss: 1188.2849; train_group_lasso_reg_loss: 0.0000; train_global_loss: 252018.4944; train_optim_loss: 252018.4944; val_kl_reg_loss: 3120.6518; val_edge_recon_loss: 124659.4621; val_gene_expr_recon_loss: 115317.3666; val_masked_gp_l1_reg_loss: 800.3372; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243897.8243; val_optim_loss: 243897.8243
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9886; val_auprc_score: 0.9962; val_best_acc_score: 0.9576; val_best_f1_score: 0.9725; train_kl_reg_loss: 3222.9884; train_edge_recon_loss: 123116.9478; train_gene_expr_recon_loss: 114195.2407; train_masked_gp_l1_reg_loss: 711.7607; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241246.9379; train_optim_loss: 241246.9379; val_kl_reg_loss: 3292.4164; val_edge_recon_loss: 124409.2976; val_gene_expr_recon_loss: 113409.1238; val_masked_gp_l1_reg_loss: 666.9708; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241777.8065; val_optim_loss: 241777.8065
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9898; val_auprc_score: 0.9965; val_best_acc_score: 0.9613; val_best_f1_score: 0.9749; train_kl_reg_loss: 3287.3759; train_edge_recon_loss: 123066.6958; train_gene_expr_recon_loss: 112858.5858; train_masked_gp_l1_reg_loss: 648.6843; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239861.3419; train_optim_loss: 239861.3419; val_kl_reg_loss: 3218.0796; val_edge_recon_loss: 124349.2743; val_gene_expr_recon_loss: 112475.7734; val_masked_gp_l1_reg_loss: 634.2298; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240677.3617; val_optim_loss: 240677.3617
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9904; val_auprc_score: 0.9968; val_best_acc_score: 0.9624; val_best_f1_score: 0.9756; train_kl_reg_loss: 3332.3152; train_edge_recon_loss: 122818.3464; train_gene_expr_recon_loss: 112195.8834; train_masked_gp_l1_reg_loss: 627.0889; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238973.6340; train_optim_loss: 238973.6340; val_kl_reg_loss: 3276.4639; val_edge_recon_loss: 124155.9931; val_gene_expr_recon_loss: 111984.9540; val_masked_gp_l1_reg_loss: 620.0099; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240037.4265; val_optim_loss: 240037.4265
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9908; val_auprc_score: 0.9969; val_best_acc_score: 0.9637; val_best_f1_score: 0.9764; train_kl_reg_loss: 3366.1380; train_edge_recon_loss: 122933.4126; train_gene_expr_recon_loss: 111769.9699; train_masked_gp_l1_reg_loss: 617.6642; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238687.1846; train_optim_loss: 238687.1846; val_kl_reg_loss: 3236.0670; val_edge_recon_loss: 124246.2953; val_gene_expr_recon_loss: 111564.6629; val_masked_gp_l1_reg_loss: 614.7747; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239661.8059; val_optim_loss: 239661.8059
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9915; val_auprc_score: 0.9972; val_best_acc_score: 0.9650; val_best_f1_score: 0.9772; train_kl_reg_loss: 3393.6165; train_edge_recon_loss: 122896.4362; train_gene_expr_recon_loss: 111462.6725; train_masked_gp_l1_reg_loss: 613.6928; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238366.4178; train_optim_loss: 238366.4178; val_kl_reg_loss: 3364.1365; val_edge_recon_loss: 124247.3592; val_gene_expr_recon_loss: 111356.7309; val_masked_gp_l1_reg_loss: 611.3585; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239579.5859; val_optim_loss: 239579.5859
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9913; val_auprc_score: 0.9971; val_best_acc_score: 0.9647; val_best_f1_score: 0.9771; train_kl_reg_loss: 3415.9903; train_edge_recon_loss: 122822.6496; train_gene_expr_recon_loss: 111214.3939; train_masked_gp_l1_reg_loss: 615.1541; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238068.1878; train_optim_loss: 238068.1878; val_kl_reg_loss: 3389.0528; val_edge_recon_loss: 124196.1805; val_gene_expr_recon_loss: 111118.8664; val_masked_gp_l1_reg_loss: 616.6636; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239320.7564; val_optim_loss: 239320.7564
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9916; val_auprc_score: 0.9972; val_best_acc_score: 0.9658; val_best_f1_score: 0.9778; train_kl_reg_loss: 3428.5691; train_edge_recon_loss: 122776.0576; train_gene_expr_recon_loss: 111010.9319; train_masked_gp_l1_reg_loss: 614.9455; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237830.5042; train_optim_loss: 237830.5042; val_kl_reg_loss: 3442.6363; val_edge_recon_loss: 124159.7407; val_gene_expr_recon_loss: 110985.3572; val_masked_gp_l1_reg_loss: 617.2818; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239205.0152; val_optim_loss: 239205.0152
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9919; val_auprc_score: 0.9973; val_best_acc_score: 0.9665; val_best_f1_score: 0.9783; train_kl_reg_loss: 3443.4317; train_edge_recon_loss: 122898.6152; train_gene_expr_recon_loss: 110857.1522; train_masked_gp_l1_reg_loss: 614.6999; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237813.8991; train_optim_loss: 237813.8991; val_kl_reg_loss: 3380.2045; val_edge_recon_loss: 123815.7109; val_gene_expr_recon_loss: 110824.3868; val_masked_gp_l1_reg_loss: 616.2476; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238636.5525; val_optim_loss: 238636.5525
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9917; val_auprc_score: 0.9972; val_best_acc_score: 0.9666; val_best_f1_score: 0.9783; train_kl_reg_loss: 3454.1932; train_edge_recon_loss: 122786.3633; train_gene_expr_recon_loss: 110738.8224; train_masked_gp_l1_reg_loss: 614.2793; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237593.6582; train_optim_loss: 237593.6582; val_kl_reg_loss: 3500.7668; val_edge_recon_loss: 123705.3291; val_gene_expr_recon_loss: 110816.5822; val_masked_gp_l1_reg_loss: 617.5683; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238640.2412; val_optim_loss: 238640.2412
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9918; val_auprc_score: 0.9973; val_best_acc_score: 0.9660; val_best_f1_score: 0.9779; train_kl_reg_loss: 3466.7294; train_edge_recon_loss: 122721.2694; train_gene_expr_recon_loss: 110639.1936; train_masked_gp_l1_reg_loss: 614.1041; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237441.2965; train_optim_loss: 237441.2965; val_kl_reg_loss: 3440.0323; val_edge_recon_loss: 123837.7757; val_gene_expr_recon_loss: 110660.1361; val_masked_gp_l1_reg_loss: 613.9311; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238551.8816; val_optim_loss: 238551.8816
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9924; val_auprc_score: 0.9974; val_best_acc_score: 0.9682; val_best_f1_score: 0.9794; train_kl_reg_loss: 3470.7745; train_edge_recon_loss: 122781.2805; train_gene_expr_recon_loss: 110540.7307; train_masked_gp_l1_reg_loss: 614.7629; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237407.5487; train_optim_loss: 237407.5487; val_kl_reg_loss: 3491.0056; val_edge_recon_loss: 123934.2633; val_gene_expr_recon_loss: 110599.5626; val_masked_gp_l1_reg_loss: 616.2733; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238641.0969; val_optim_loss: 238641.0969
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9917; val_auprc_score: 0.9972; val_best_acc_score: 0.9665; val_best_f1_score: 0.9782; train_kl_reg_loss: 3477.7728; train_edge_recon_loss: 122500.1000; train_gene_expr_recon_loss: 110505.1761; train_masked_gp_l1_reg_loss: 615.8348; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237098.8837; train_optim_loss: 237098.8837; val_kl_reg_loss: 3456.1011; val_edge_recon_loss: 123930.8418; val_gene_expr_recon_loss: 110650.3404; val_masked_gp_l1_reg_loss: 619.5724; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238656.8613; val_optim_loss: 238656.8613
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9920; val_auprc_score: 0.9973; val_best_acc_score: 0.9663; val_best_f1_score: 0.9781; train_kl_reg_loss: 3485.3162; train_edge_recon_loss: 122718.8692; train_gene_expr_recon_loss: 110422.5897; train_masked_gp_l1_reg_loss: 616.5798; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237243.3549; train_optim_loss: 237243.3549; val_kl_reg_loss: 3452.2850; val_edge_recon_loss: 123258.4835; val_gene_expr_recon_loss: 110537.6642; val_masked_gp_l1_reg_loss: 616.0472; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237864.4793; val_optim_loss: 237864.4793
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9920; val_auprc_score: 0.9973; val_best_acc_score: 0.9676; val_best_f1_score: 0.9789; train_kl_reg_loss: 3490.5092; train_edge_recon_loss: 122756.5656; train_gene_expr_recon_loss: 110373.9324; train_masked_gp_l1_reg_loss: 618.0202; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237239.0272; train_optim_loss: 237239.0272; val_kl_reg_loss: 3426.5726; val_edge_recon_loss: 124114.7359; val_gene_expr_recon_loss: 110493.1110; val_masked_gp_l1_reg_loss: 623.4958; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238657.9197; val_optim_loss: 238657.9197
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9925; val_auprc_score: 0.9975; val_best_acc_score: 0.9683; val_best_f1_score: 0.9795; train_kl_reg_loss: 3497.4109; train_edge_recon_loss: 122703.2879; train_gene_expr_recon_loss: 110315.9340; train_masked_gp_l1_reg_loss: 619.0043; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237135.6370; train_optim_loss: 237135.6370; val_kl_reg_loss: 3504.3338; val_edge_recon_loss: 123127.7964; val_gene_expr_recon_loss: 110417.9728; val_masked_gp_l1_reg_loss: 615.6317; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237665.7284; val_optim_loss: 237665.7284
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9918; val_auprc_score: 0.9972; val_best_acc_score: 0.9670; val_best_f1_score: 0.9786; train_kl_reg_loss: 3500.2030; train_edge_recon_loss: 122806.0817; train_gene_expr_recon_loss: 110285.4372; train_masked_gp_l1_reg_loss: 620.0113; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237211.7332; train_optim_loss: 237211.7332; val_kl_reg_loss: 3464.1074; val_edge_recon_loss: 123951.0371; val_gene_expr_recon_loss: 110385.9897; val_masked_gp_l1_reg_loss: 619.3405; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238420.4780; val_optim_loss: 238420.4780
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9921; val_auprc_score: 0.9973; val_best_acc_score: 0.9679; val_best_f1_score: 0.9792; train_kl_reg_loss: 3507.3589; train_edge_recon_loss: 122611.4484; train_gene_expr_recon_loss: 110219.7808; train_masked_gp_l1_reg_loss: 621.9417; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236960.5297; train_optim_loss: 236960.5297; val_kl_reg_loss: 3478.1932; val_edge_recon_loss: 124055.0824; val_gene_expr_recon_loss: 110390.9061; val_masked_gp_l1_reg_loss: 622.2441; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238546.4316; val_optim_loss: 238546.4316
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9922; val_auprc_score: 0.9974; val_best_acc_score: 0.9680; val_best_f1_score: 0.9792; train_kl_reg_loss: 3510.5527; train_edge_recon_loss: 122717.1251; train_gene_expr_recon_loss: 110178.7850; train_masked_gp_l1_reg_loss: 622.6941; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237029.1569; train_optim_loss: 237029.1569; val_kl_reg_loss: 3445.3948; val_edge_recon_loss: 123714.9597; val_gene_expr_recon_loss: 110273.6957; val_masked_gp_l1_reg_loss: 626.4592; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238060.5032; val_optim_loss: 238060.5032

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9929; val_auprc_score: 0.9976; val_best_acc_score: 0.9694; val_best_f1_score: 0.9801; train_kl_reg_loss: 3494.5624; train_edge_recon_loss: 122426.7008; train_gene_expr_recon_loss: 109727.2534; train_masked_gp_l1_reg_loss: 570.1159; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236218.6325; train_optim_loss: 236218.6325; val_kl_reg_loss: 3470.2781; val_edge_recon_loss: 123641.3321; val_gene_expr_recon_loss: 109924.9452; val_masked_gp_l1_reg_loss: 567.2076; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237603.7580; val_optim_loss: 237603.7580
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9928; val_auprc_score: 0.9976; val_best_acc_score: 0.9693; val_best_f1_score: 0.9801; train_kl_reg_loss: 3491.0107; train_edge_recon_loss: 122425.5592; train_gene_expr_recon_loss: 109651.8166; train_masked_gp_l1_reg_loss: 566.2244; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236134.6109; train_optim_loss: 236134.6109; val_kl_reg_loss: 3461.1900; val_edge_recon_loss: 123147.9253; val_gene_expr_recon_loss: 109843.4778; val_masked_gp_l1_reg_loss: 566.0615; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237018.6558; val_optim_loss: 237018.6558
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9929; val_auprc_score: 0.9976; val_best_acc_score: 0.9693; val_best_f1_score: 0.9801; train_kl_reg_loss: 3490.5786; train_edge_recon_loss: 122566.0247; train_gene_expr_recon_loss: 109635.1494; train_masked_gp_l1_reg_loss: 567.6090; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236259.3618; train_optim_loss: 236259.3618; val_kl_reg_loss: 3440.1439; val_edge_recon_loss: 123372.6867; val_gene_expr_recon_loss: 109852.3045; val_masked_gp_l1_reg_loss: 568.6768; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237233.8076; val_optim_loss: 237233.8076
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9931; val_auprc_score: 0.9977; val_best_acc_score: 0.9702; val_best_f1_score: 0.9806; train_kl_reg_loss: 3483.4670; train_edge_recon_loss: 122420.2119; train_gene_expr_recon_loss: 109576.7136; train_masked_gp_l1_reg_loss: 569.9360; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236050.3284; train_optim_loss: 236050.3284; val_kl_reg_loss: 3435.4403; val_edge_recon_loss: 123422.4759; val_gene_expr_recon_loss: 109772.2079; val_masked_gp_l1_reg_loss: 570.7123; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237200.8432; val_optim_loss: 237200.8432
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9933; val_auprc_score: 0.9977; val_best_acc_score: 0.9702; val_best_f1_score: 0.9807; train_kl_reg_loss: 3480.5195; train_edge_recon_loss: 122464.6980; train_gene_expr_recon_loss: 109563.3364; train_masked_gp_l1_reg_loss: 572.3588; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236080.9126; train_optim_loss: 236080.9126; val_kl_reg_loss: 3446.0947; val_edge_recon_loss: 123371.8829; val_gene_expr_recon_loss: 109855.0431; val_masked_gp_l1_reg_loss: 574.5784; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237247.5992; val_optim_loss: 237247.5992

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9934; val_auprc_score: 0.9977; val_best_acc_score: 0.9706; val_best_f1_score: 0.9809; train_kl_reg_loss: 3479.8235; train_edge_recon_loss: 122524.1247; train_gene_expr_recon_loss: 109527.4446; train_masked_gp_l1_reg_loss: 567.2165; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236098.6093; train_optim_loss: 236098.6093; val_kl_reg_loss: 3443.3461; val_edge_recon_loss: 123656.0554; val_gene_expr_recon_loss: 109902.3356; val_masked_gp_l1_reg_loss: 566.7472; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237568.4876; val_optim_loss: 237568.4876
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9887; val_auprc_score: 0.9963; val_best_acc_score: 0.9581; val_best_f1_score: 0.9728; train_kl_reg_loss: 2849.8908; train_edge_recon_loss: 123629.6299; train_gene_expr_recon_loss: 110580.4170; train_masked_gp_l1_reg_loss: 589.5641; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237649.5021; train_optim_loss: 237649.5021; val_kl_reg_loss: 1929.0700; val_edge_recon_loss: 125451.1642; val_gene_expr_recon_loss: 110719.7650; val_masked_gp_l1_reg_loss: 600.3535; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238700.3585; val_optim_loss: 238700.3585
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9895; val_auprc_score: 0.9965; val_best_acc_score: 0.9597; val_best_f1_score: 0.9738; train_kl_reg_loss: 2675.8971; train_edge_recon_loss: 123290.5648; train_gene_expr_recon_loss: 110367.0752; train_masked_gp_l1_reg_loss: 602.4541; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236935.9912; train_optim_loss: 236935.9912; val_kl_reg_loss: 1928.1535; val_edge_recon_loss: 125299.6805; val_gene_expr_recon_loss: 110659.5622; val_masked_gp_l1_reg_loss: 602.6661; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238490.0684; val_optim_loss: 238490.0684

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 417 min 14 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9856
Val AUPRC score: 0.9953
Val best accuracy score: 0.9505
Val best F1 score: 0.9679
Val gene expr MSE score: 5.5644

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
