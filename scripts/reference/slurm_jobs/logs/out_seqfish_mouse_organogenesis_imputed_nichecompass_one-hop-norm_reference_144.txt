[True]
Run timestamp: 27072023_034302_144.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_144']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8469; val_auprc_score: 0.9689; val_best_acc_score: 0.8506; val_best_f1_score: 0.9193; train_kl_reg_loss: 453047.2997; train_edge_recon_loss: 11038512.1186; train_gene_expr_recon_loss: 30112963.9535; train_masked_gp_l1_reg_loss: 14742.1197; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41619265.5070; train_optim_loss: 41619265.5070; val_kl_reg_loss: 368268.9987; val_edge_recon_loss: 12133286.7083; val_gene_expr_recon_loss: 22355371.5000; val_masked_gp_l1_reg_loss: 15828.0947; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34872754.8333; val_optim_loss: 34872754.8333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8481; val_auprc_score: 0.9695; val_best_acc_score: 0.8558; val_best_f1_score: 0.9216; train_kl_reg_loss: 309987.4471; train_edge_recon_loss: 10807827.6953; train_gene_expr_recon_loss: 12519102.8140; train_masked_gp_l1_reg_loss: 16519.0254; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23653437.0326; train_optim_loss: 23653437.0326; val_kl_reg_loss: 267641.8757; val_edge_recon_loss: 12366278.2083; val_gene_expr_recon_loss: 10720634.1667; val_masked_gp_l1_reg_loss: 16999.1523; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23371554.3333; val_optim_loss: 23371554.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8392; val_auprc_score: 0.9679; val_best_acc_score: 0.8627; val_best_f1_score: 0.9248; train_kl_reg_loss: 243003.0687; train_edge_recon_loss: 10755547.6884; train_gene_expr_recon_loss: 10493319.9953; train_masked_gp_l1_reg_loss: 17596.1729; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21509467.0326; train_optim_loss: 21509467.0326; val_kl_reg_loss: 214746.8047; val_edge_recon_loss: 12121448.2917; val_gene_expr_recon_loss: 10035921.3750; val_masked_gp_l1_reg_loss: 18157.1016; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22390274.5833; val_optim_loss: 22390274.5833
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8452; val_auprc_score: 0.9671; val_best_acc_score: 0.8634; val_best_f1_score: 0.9237; train_kl_reg_loss: 214299.5818; train_edge_recon_loss: 10623986.1721; train_gene_expr_recon_loss: 9907313.1116; train_masked_gp_l1_reg_loss: 18709.8586; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20764308.5860; train_optim_loss: 20764308.5860; val_kl_reg_loss: 167294.2090; val_edge_recon_loss: 12135529.6250; val_gene_expr_recon_loss: 9744643.5833; val_masked_gp_l1_reg_loss: 19286.7305; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22066753.5833; val_optim_loss: 22066753.5833
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8538; val_auprc_score: 0.9694; val_best_acc_score: 0.8875; val_best_f1_score: 0.9376; train_kl_reg_loss: 181005.4314; train_edge_recon_loss: 10536786.2698; train_gene_expr_recon_loss: 9642592.7907; train_masked_gp_l1_reg_loss: 20046.4270; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20380430.7628; train_optim_loss: 20380430.7628; val_kl_reg_loss: 142882.9941; val_edge_recon_loss: 11035540.2083; val_gene_expr_recon_loss: 9502561.9583; val_masked_gp_l1_reg_loss: 20699.8145; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20701685.0833; val_optim_loss: 20701685.0833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8538; val_auprc_score: 0.9648; val_best_acc_score: 0.8901; val_best_f1_score: 0.9386; train_kl_reg_loss: 120824.8243; train_edge_recon_loss: 10111353.7837; train_gene_expr_recon_loss: 9422314.7953; train_masked_gp_l1_reg_loss: 21513.2969; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19676006.5860; train_optim_loss: 19676006.5860; val_kl_reg_loss: 94369.7344; val_edge_recon_loss: 9703580.4583; val_gene_expr_recon_loss: 9289677.0000; val_masked_gp_l1_reg_loss: 22534.6328; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19110161.3333; val_optim_loss: 19110161.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8439; val_auprc_score: 0.9630; val_best_acc_score: 0.8883; val_best_f1_score: 0.9378; train_kl_reg_loss: 130887.7254; train_edge_recon_loss: 9179689.3581; train_gene_expr_recon_loss: 9055543.1209; train_masked_gp_l1_reg_loss: 23355.7848; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18389476.0326; train_optim_loss: 18389476.0326; val_kl_reg_loss: 163932.4694; val_edge_recon_loss: 8996784.1875; val_gene_expr_recon_loss: 8885031.5833; val_masked_gp_l1_reg_loss: 24137.0215; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18069886.2917; val_optim_loss: 18069886.2917
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8496; val_auprc_score: 0.9661; val_best_acc_score: 0.8964; val_best_f1_score: 0.9423; train_kl_reg_loss: 182761.9038; train_edge_recon_loss: 8795242.2279; train_gene_expr_recon_loss: 8791650.8884; train_masked_gp_l1_reg_loss: 24753.7079; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17794408.6512; train_optim_loss: 17794408.6512; val_kl_reg_loss: 181715.4167; val_edge_recon_loss: 8640073.8125; val_gene_expr_recon_loss: 8694395.9167; val_masked_gp_l1_reg_loss: 25332.2148; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17541517.6250; val_optim_loss: 17541517.6250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8606; val_auprc_score: 0.9673; val_best_acc_score: 0.8980; val_best_f1_score: 0.9426; train_kl_reg_loss: 180558.4374; train_edge_recon_loss: 8672537.3279; train_gene_expr_recon_loss: 8613415.2558; train_masked_gp_l1_reg_loss: 25867.0131; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17492377.9860; train_optim_loss: 17492377.9860; val_kl_reg_loss: 167640.7956; val_edge_recon_loss: 8825975.3333; val_gene_expr_recon_loss: 8533358.5000; val_masked_gp_l1_reg_loss: 26381.7598; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17553356.5833; val_optim_loss: 17553356.5833
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8719; val_auprc_score: 0.9707; val_best_acc_score: 0.9026; val_best_f1_score: 0.9451; train_kl_reg_loss: 158516.5991; train_edge_recon_loss: 8514513.4651; train_gene_expr_recon_loss: 8460549.1070; train_masked_gp_l1_reg_loss: 26899.5087; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17160478.6093; train_optim_loss: 17160478.6093; val_kl_reg_loss: 140172.3346; val_edge_recon_loss: 8610157.0208; val_gene_expr_recon_loss: 8381135.9167; val_masked_gp_l1_reg_loss: 27432.4609; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17158897.1250; val_optim_loss: 17158897.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8726; val_auprc_score: 0.9710; val_best_acc_score: 0.9045; val_best_f1_score: 0.9461; train_kl_reg_loss: 137823.4689; train_edge_recon_loss: 8366577.3930; train_gene_expr_recon_loss: 8317834.6651; train_masked_gp_l1_reg_loss: 27997.0957; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16850232.6558; train_optim_loss: 16850232.6558; val_kl_reg_loss: 123760.1348; val_edge_recon_loss: 8518398.4583; val_gene_expr_recon_loss: 8233557.6042; val_masked_gp_l1_reg_loss: 28558.1445; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16904274.0833; val_optim_loss: 16904274.0833
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9002; val_auprc_score: 0.9776; val_best_acc_score: 0.9140; val_best_f1_score: 0.9512; train_kl_reg_loss: 125401.3925; train_edge_recon_loss: 8291248.9651; train_gene_expr_recon_loss: 8176456.6186; train_masked_gp_l1_reg_loss: 29076.0251; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16622182.9442; train_optim_loss: 16622182.9442; val_kl_reg_loss: 121580.8294; val_edge_recon_loss: 8271722.4792; val_gene_expr_recon_loss: 8103336.3750; val_masked_gp_l1_reg_loss: 29535.4590; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16526174.8750; val_optim_loss: 16526174.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9078; val_auprc_score: 0.9798; val_best_acc_score: 0.9187; val_best_f1_score: 0.9536; train_kl_reg_loss: 122595.7640; train_edge_recon_loss: 8124741.3907; train_gene_expr_recon_loss: 8057219.6512; train_masked_gp_l1_reg_loss: 29941.4248; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16334498.2884; train_optim_loss: 16334498.2884; val_kl_reg_loss: 118674.4596; val_edge_recon_loss: 8079043.6250; val_gene_expr_recon_loss: 7990409.0208; val_masked_gp_l1_reg_loss: 30332.2227; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16218459.0417; val_optim_loss: 16218459.0417
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9018; val_auprc_score: 0.9783; val_best_acc_score: 0.9197; val_best_f1_score: 0.9545; train_kl_reg_loss: 113338.2261; train_edge_recon_loss: 8039693.0233; train_gene_expr_recon_loss: 7949201.3558; train_masked_gp_l1_reg_loss: 30696.3691; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16132929.0047; train_optim_loss: 16132929.0047; val_kl_reg_loss: 100920.0798; val_edge_recon_loss: 7979017.2917; val_gene_expr_recon_loss: 7904968.1875; val_masked_gp_l1_reg_loss: 31049.7812; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16015955.5417; val_optim_loss: 16015955.5417
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9173; val_auprc_score: 0.9823; val_best_acc_score: 0.9214; val_best_f1_score: 0.9552; train_kl_reg_loss: 103578.9189; train_edge_recon_loss: 7956971.5977; train_gene_expr_recon_loss: 7858592.1047; train_masked_gp_l1_reg_loss: 31361.5208; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15950504.0791; train_optim_loss: 15950504.0791; val_kl_reg_loss: 92195.9788; val_edge_recon_loss: 8196475.6042; val_gene_expr_recon_loss: 7812901.8750; val_masked_gp_l1_reg_loss: 31669.4609; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16133242.7083; val_optim_loss: 16133242.7083
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9176; val_auprc_score: 0.9813; val_best_acc_score: 0.9192; val_best_f1_score: 0.9540; train_kl_reg_loss: 92646.0088; train_edge_recon_loss: 7953371.8047; train_gene_expr_recon_loss: 7772528.7047; train_masked_gp_l1_reg_loss: 31970.9337; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15850517.4186; train_optim_loss: 15850517.4186; val_kl_reg_loss: 91696.3662; val_edge_recon_loss: 8283480.2708; val_gene_expr_recon_loss: 7723786.2292; val_masked_gp_l1_reg_loss: 32221.6621; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16131184.8333; val_optim_loss: 16131184.8333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9265; val_auprc_score: 0.9837; val_best_acc_score: 0.9229; val_best_f1_score: 0.9559; train_kl_reg_loss: 85946.4872; train_edge_recon_loss: 7932042.5023; train_gene_expr_recon_loss: 7695726.5256; train_masked_gp_l1_reg_loss: 32447.0453; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15746162.6233; train_optim_loss: 15746162.6233; val_kl_reg_loss: 83533.4307; val_edge_recon_loss: 8125766.7083; val_gene_expr_recon_loss: 7651519.2708; val_masked_gp_l1_reg_loss: 32631.0898; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15893450.5417; val_optim_loss: 15893450.5417
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9293; val_auprc_score: 0.9842; val_best_acc_score: 0.9234; val_best_f1_score: 0.9561; train_kl_reg_loss: 76922.4507; train_edge_recon_loss: 7876076.9558; train_gene_expr_recon_loss: 7621252.7209; train_masked_gp_l1_reg_loss: 32794.3086; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15607046.4000; train_optim_loss: 15607046.4000; val_kl_reg_loss: 71668.2201; val_edge_recon_loss: 7991166.7083; val_gene_expr_recon_loss: 7580781.5833; val_masked_gp_l1_reg_loss: 32925.7500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15676542.3750; val_optim_loss: 15676542.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9246; val_auprc_score: 0.9830; val_best_acc_score: 0.9202; val_best_f1_score: 0.9541; train_kl_reg_loss: 67693.4860; train_edge_recon_loss: 7894707.0698; train_gene_expr_recon_loss: 7551975.7674; train_masked_gp_l1_reg_loss: 32982.1803; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15547358.5395; train_optim_loss: 15547358.5395; val_kl_reg_loss: 63036.9030; val_edge_recon_loss: 8064641.7083; val_gene_expr_recon_loss: 7511113.3750; val_masked_gp_l1_reg_loss: 33012.6406; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15671804.9583; val_optim_loss: 15671804.9583
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9312; val_auprc_score: 0.9846; val_best_acc_score: 0.9255; val_best_f1_score: 0.9572; train_kl_reg_loss: 60792.9958; train_edge_recon_loss: 7885164.0186; train_gene_expr_recon_loss: 7497615.5674; train_masked_gp_l1_reg_loss: 32943.1767; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15476515.7581; train_optim_loss: 15476515.7581; val_kl_reg_loss: 56381.1585; val_edge_recon_loss: 7943574.0208; val_gene_expr_recon_loss: 7463761.3750; val_masked_gp_l1_reg_loss: 32870.9141; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15496587.5417; val_optim_loss: 15496587.5417
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9364; val_auprc_score: 0.9853; val_best_acc_score: 0.9296; val_best_f1_score: 0.9595; train_kl_reg_loss: 52939.9335; train_edge_recon_loss: 7797027.3698; train_gene_expr_recon_loss: 7443680.1000; train_masked_gp_l1_reg_loss: 32730.1180; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15326377.5256; train_optim_loss: 15326377.5256; val_kl_reg_loss: 48908.4461; val_edge_recon_loss: 8062296.0000; val_gene_expr_recon_loss: 7398013.0625; val_masked_gp_l1_reg_loss: 32538.0254; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15541755.4583; val_optim_loss: 15541755.4583
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9426; val_auprc_score: 0.9865; val_best_acc_score: 0.9345; val_best_f1_score: 0.9619; train_kl_reg_loss: 49027.5072; train_edge_recon_loss: 7778717.7163; train_gene_expr_recon_loss: 7392348.5744; train_masked_gp_l1_reg_loss: 32324.4375; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15252418.2000; train_optim_loss: 15252418.2000; val_kl_reg_loss: 44763.2313; val_edge_recon_loss: 8087916.2917; val_gene_expr_recon_loss: 7351191.7708; val_masked_gp_l1_reg_loss: 32055.4297; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15515926.2083; val_optim_loss: 15515926.2083
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9476; val_auprc_score: 0.9884; val_best_acc_score: 0.9355; val_best_f1_score: 0.9626; train_kl_reg_loss: 45010.4096; train_edge_recon_loss: 7813503.7419; train_gene_expr_recon_loss: 7346816.3814; train_masked_gp_l1_reg_loss: 31757.9425; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15237088.4977; train_optim_loss: 15237088.4977; val_kl_reg_loss: 42500.6336; val_edge_recon_loss: 7995561.0833; val_gene_expr_recon_loss: 7309556.1667; val_masked_gp_l1_reg_loss: 31448.2422; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15379065.8750; val_optim_loss: 15379065.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9544; val_auprc_score: 0.9892; val_best_acc_score: 0.9413; val_best_f1_score: 0.9661; train_kl_reg_loss: 42585.3635; train_edge_recon_loss: 7772511.0744; train_gene_expr_recon_loss: 7297835.2767; train_masked_gp_l1_reg_loss: 31104.7366; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15144036.4140; train_optim_loss: 15144036.4140; val_kl_reg_loss: 41784.3244; val_edge_recon_loss: 7862840.6042; val_gene_expr_recon_loss: 7288163.8958; val_masked_gp_l1_reg_loss: 30779.1641; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15223567.8750; val_optim_loss: 15223567.8750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9490; val_auprc_score: 0.9878; val_best_acc_score: 0.9384; val_best_f1_score: 0.9643; train_kl_reg_loss: 41949.8668; train_edge_recon_loss: 7753004.8372; train_gene_expr_recon_loss: 7261148.6000; train_masked_gp_l1_reg_loss: 30402.1039; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15086505.3860; train_optim_loss: 15086505.3860; val_kl_reg_loss: 41535.4163; val_edge_recon_loss: 8018553.7917; val_gene_expr_recon_loss: 7254363.4583; val_masked_gp_l1_reg_loss: 30005.0195; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15344457.7083; val_optim_loss: 15344457.7083
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9526; val_auprc_score: 0.9892; val_best_acc_score: 0.9412; val_best_f1_score: 0.9658; train_kl_reg_loss: 45021.7872; train_edge_recon_loss: 7797580.9535; train_gene_expr_recon_loss: 7361525.8837; train_masked_gp_l1_reg_loss: 29893.4131; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15234022.0000; train_optim_loss: 15234022.0000; val_kl_reg_loss: 13153.3580; val_edge_recon_loss: 8067278.2292; val_gene_expr_recon_loss: 7309459.0833; val_masked_gp_l1_reg_loss: 29612.7559; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15419503.5417; val_optim_loss: 15419503.5417
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9601; val_auprc_score: 0.9908; val_best_acc_score: 0.9474; val_best_f1_score: 0.9694; train_kl_reg_loss: 41328.7487; train_edge_recon_loss: 7736430.2116; train_gene_expr_recon_loss: 7297429.0628; train_masked_gp_l1_reg_loss: 29200.6665; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15104388.6698; train_optim_loss: 15104388.6698; val_kl_reg_loss: 11652.7694; val_edge_recon_loss: 7929662.5417; val_gene_expr_recon_loss: 7275461.4583; val_masked_gp_l1_reg_loss: 28786.5234; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15245563.7500; val_optim_loss: 15245563.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9533; val_auprc_score: 0.9886; val_best_acc_score: 0.9473; val_best_f1_score: 0.9693; train_kl_reg_loss: 37558.6587; train_edge_recon_loss: 7698837.0093; train_gene_expr_recon_loss: 7265038.3488; train_masked_gp_l1_reg_loss: 28368.4152; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15029802.4744; train_optim_loss: 15029802.4744; val_kl_reg_loss: 11030.4361; val_edge_recon_loss: 7917303.5833; val_gene_expr_recon_loss: 7239245.3542; val_masked_gp_l1_reg_loss: 27863.1836; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15195442.5000; val_optim_loss: 15195442.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9580; val_auprc_score: 0.9903; val_best_acc_score: 0.9482; val_best_f1_score: 0.9699; train_kl_reg_loss: 34926.1363; train_edge_recon_loss: 7649827.9651; train_gene_expr_recon_loss: 7233672.6977; train_masked_gp_l1_reg_loss: 27492.0548; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14945918.8651; train_optim_loss: 14945918.8651; val_kl_reg_loss: 10817.9917; val_edge_recon_loss: 7800322.1250; val_gene_expr_recon_loss: 7218473.8542; val_masked_gp_l1_reg_loss: 27095.2715; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15056709.0833; val_optim_loss: 15056709.0833
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9576; val_auprc_score: 0.9903; val_best_acc_score: 0.9471; val_best_f1_score: 0.9692; train_kl_reg_loss: 30544.2967; train_edge_recon_loss: 7704228.9302; train_gene_expr_recon_loss: 7211167.9860; train_masked_gp_l1_reg_loss: 26652.2010; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14972593.4140; train_optim_loss: 14972593.4140; val_kl_reg_loss: 10420.3475; val_edge_recon_loss: 8100962.6875; val_gene_expr_recon_loss: 7192519.1042; val_masked_gp_l1_reg_loss: 26179.9844; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15330082.1250; val_optim_loss: 15330082.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9634; val_auprc_score: 0.9916; val_best_acc_score: 0.9501; val_best_f1_score: 0.9710; train_kl_reg_loss: 29664.9723; train_edge_recon_loss: 7752092.1349; train_gene_expr_recon_loss: 7196589.3628; train_masked_gp_l1_reg_loss: 25735.0728; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15004081.5302; train_optim_loss: 15004081.5302; val_kl_reg_loss: 10769.2129; val_edge_recon_loss: 7743052.5625; val_gene_expr_recon_loss: 7174313.8750; val_masked_gp_l1_reg_loss: 25330.3340; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14953465.7083; val_optim_loss: 14953465.7083
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9603; val_auprc_score: 0.9909; val_best_acc_score: 0.9520; val_best_f1_score: 0.9721; train_kl_reg_loss: 28773.4771; train_edge_recon_loss: 7625665.2953; train_gene_expr_recon_loss: 7173598.8209; train_masked_gp_l1_reg_loss: 24903.6385; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14852941.2512; train_optim_loss: 14852941.2512; val_kl_reg_loss: 9710.7904; val_edge_recon_loss: 7775966.7083; val_gene_expr_recon_loss: 7163675.1667; val_masked_gp_l1_reg_loss: 24489.4375; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14973841.7500; val_optim_loss: 14973841.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9588; val_auprc_score: 0.9891; val_best_acc_score: 0.9537; val_best_f1_score: 0.9732; train_kl_reg_loss: 27215.7550; train_edge_recon_loss: 7717738.5279; train_gene_expr_recon_loss: 7158359.4884; train_masked_gp_l1_reg_loss: 24074.3330; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14927388.0884; train_optim_loss: 14927388.0884; val_kl_reg_loss: 10264.6131; val_edge_recon_loss: 7851958.2083; val_gene_expr_recon_loss: 7149207.8750; val_masked_gp_l1_reg_loss: 23662.0273; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15035092.7083; val_optim_loss: 15035092.7083
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9592; val_auprc_score: 0.9901; val_best_acc_score: 0.9512; val_best_f1_score: 0.9716; train_kl_reg_loss: 24288.5020; train_edge_recon_loss: 7644065.2326; train_gene_expr_recon_loss: 7141198.2558; train_masked_gp_l1_reg_loss: 23292.6668; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14832844.6233; train_optim_loss: 14832844.6233; val_kl_reg_loss: 10012.3635; val_edge_recon_loss: 8021853.7917; val_gene_expr_recon_loss: 7132451.4375; val_masked_gp_l1_reg_loss: 22917.7695; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15187235.6667; val_optim_loss: 15187235.6667
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9620; val_auprc_score: 0.9912; val_best_acc_score: 0.9540; val_best_f1_score: 0.9733; train_kl_reg_loss: 23188.8901; train_edge_recon_loss: 7621701.8093; train_gene_expr_recon_loss: 7129375.8791; train_masked_gp_l1_reg_loss: 22500.8074; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14796767.3628; train_optim_loss: 14796767.3628; val_kl_reg_loss: 10182.8758; val_edge_recon_loss: 7852955.1458; val_gene_expr_recon_loss: 7110959.4167; val_masked_gp_l1_reg_loss: 22124.6191; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14996222.3333; val_optim_loss: 14996222.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9621; val_auprc_score: 0.9905; val_best_acc_score: 0.9548; val_best_f1_score: 0.9736; train_kl_reg_loss: 22674.1725; train_edge_recon_loss: 7648692.8930; train_gene_expr_recon_loss: 7095926.7744; train_masked_gp_l1_reg_loss: 22063.3122; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14789357.1256; train_optim_loss: 14789357.1256; val_kl_reg_loss: 10226.5491; val_edge_recon_loss: 7906329.5417; val_gene_expr_recon_loss: 7085351.7917; val_masked_gp_l1_reg_loss: 22018.8887; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15023926.9583; val_optim_loss: 15023926.9583
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9646; val_auprc_score: 0.9918; val_best_acc_score: 0.9557; val_best_f1_score: 0.9742; train_kl_reg_loss: 22601.4268; train_edge_recon_loss: 7637040.3140; train_gene_expr_recon_loss: 7093507.7535; train_masked_gp_l1_reg_loss: 21977.7324; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14775127.2233; train_optim_loss: 14775127.2233; val_kl_reg_loss: 10472.3723; val_edge_recon_loss: 7836284.8542; val_gene_expr_recon_loss: 7086017.0625; val_masked_gp_l1_reg_loss: 21939.5859; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14954714.2083; val_optim_loss: 14954714.2083
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9627; val_auprc_score: 0.9912; val_best_acc_score: 0.9545; val_best_f1_score: 0.9734; train_kl_reg_loss: 23026.9137; train_edge_recon_loss: 7605762.1535; train_gene_expr_recon_loss: 7089273.6953; train_masked_gp_l1_reg_loss: 21896.8587; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14739959.6047; train_optim_loss: 14739959.6047; val_kl_reg_loss: 10537.4233; val_edge_recon_loss: 7908686.8750; val_gene_expr_recon_loss: 7078165.3333; val_masked_gp_l1_reg_loss: 21850.5879; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15019240.7083; val_optim_loss: 15019240.7083
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9620; val_auprc_score: 0.9906; val_best_acc_score: 0.9561; val_best_f1_score: 0.9744; train_kl_reg_loss: 22843.9196; train_edge_recon_loss: 7638678.8884; train_gene_expr_recon_loss: 7088498.1674; train_masked_gp_l1_reg_loss: 21810.7945; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14771831.7302; train_optim_loss: 14771831.7302; val_kl_reg_loss: 10285.9696; val_edge_recon_loss: 7874067.4375; val_gene_expr_recon_loss: 7080675.0208; val_masked_gp_l1_reg_loss: 21780.1094; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14986808.3750; val_optim_loss: 14986808.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 45 min 43 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9592
Val AUPRC score: 0.9912
Val best accuracy score: 0.9477
Val best F1 score: 0.9699
Val gene expr MSE score: 101971.3573
Val cat covariate0 mean sim diff: -0.0030

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
