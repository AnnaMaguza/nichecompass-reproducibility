[True]
Run timestamp: 10102023_120120_255.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_255']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6996; val_auprc_score: 0.6711; val_best_acc_score: 0.5051; val_best_f1_score: 0.6686; train_kl_reg_loss: 108403.2525; train_edge_recon_loss: 773022.3703; train_gene_expr_recon_loss: 22833965.5152; train_masked_gp_l1_reg_loss: 50193.9345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6198214.2727; train_chrom_access_recon_loss: 11482071.8636; train_global_loss: 41445871.2121; train_optim_loss: 41445871.2121; val_kl_reg_loss: 124338.3955; val_edge_recon_loss: 812978.4375; val_gene_expr_recon_loss: 21682262.5000; val_masked_gp_l1_reg_loss: 51116.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3611907.2500; val_chrom_access_recon_loss: 11474196.6250; val_global_loss: 37756800.0000; val_optim_loss: 37756800.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7425; val_auprc_score: 0.7257; val_best_acc_score: 0.6343; val_best_f1_score: 0.7173; train_kl_reg_loss: 116760.6436; train_edge_recon_loss: 759353.7907; train_gene_expr_recon_loss: 21121207.1212; train_masked_gp_l1_reg_loss: 52197.5853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2056010.0303; train_chrom_access_recon_loss: 10980984.1515; train_global_loss: 35086513.5152; train_optim_loss: 35086513.5152; val_kl_reg_loss: 105750.5010; val_edge_recon_loss: 811275.8047; val_gene_expr_recon_loss: 21575813.0000; val_masked_gp_l1_reg_loss: 53355.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1042352.6875; val_chrom_access_recon_loss: 11382554.7500; val_global_loss: 34971102.0000; val_optim_loss: 34971102.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8318; val_auprc_score: 0.8095; val_best_acc_score: 0.7335; val_best_f1_score: 0.7390; train_kl_reg_loss: 99162.1308; train_edge_recon_loss: 744321.1468; train_gene_expr_recon_loss: 20942617.0303; train_masked_gp_l1_reg_loss: 54709.6345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 695085.9025; train_chrom_access_recon_loss: 10912255.6212; train_global_loss: 33448151.3030; train_optim_loss: 33448151.3030; val_kl_reg_loss: 95845.8701; val_edge_recon_loss: 798448.8594; val_gene_expr_recon_loss: 21303940.0000; val_masked_gp_l1_reg_loss: 56562.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 467282.0938; val_chrom_access_recon_loss: 11145515.7500; val_global_loss: 33867594.0000; val_optim_loss: 33867594.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8661; val_auprc_score: 0.8349; val_best_acc_score: 0.7907; val_best_f1_score: 0.8100; train_kl_reg_loss: 88159.4685; train_edge_recon_loss: 728996.1458; train_gene_expr_recon_loss: 20759390.6061; train_masked_gp_l1_reg_loss: 58156.7846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 365995.0582; train_chrom_access_recon_loss: 10805325.5303; train_global_loss: 32806023.7879; train_optim_loss: 32806023.7879; val_kl_reg_loss: 90644.3643; val_edge_recon_loss: 752605.9922; val_gene_expr_recon_loss: 21130670.2500; val_masked_gp_l1_reg_loss: 60031.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 293326.4062; val_chrom_access_recon_loss: 11024184.8750; val_global_loss: 33351463.2500; val_optim_loss: 33351463.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8880; val_auprc_score: 0.8620; val_best_acc_score: 0.8125; val_best_f1_score: 0.8291; train_kl_reg_loss: 88122.4503; train_edge_recon_loss: 685428.4706; train_gene_expr_recon_loss: 20641037.8788; train_masked_gp_l1_reg_loss: 61658.4293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 256903.3670; train_chrom_access_recon_loss: 10747846.0000; train_global_loss: 32480996.7273; train_optim_loss: 32480996.7273; val_kl_reg_loss: 91955.6396; val_edge_recon_loss: 661596.8594; val_gene_expr_recon_loss: 21083751.2500; val_masked_gp_l1_reg_loss: 63435.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 229242.4531; val_chrom_access_recon_loss: 11161903.7500; val_global_loss: 33291885.7500; val_optim_loss: 33291885.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8970; val_auprc_score: 0.8651; val_best_acc_score: 0.8283; val_best_f1_score: 0.8416; train_kl_reg_loss: 94486.6476; train_edge_recon_loss: 644755.5814; train_gene_expr_recon_loss: 20518615.5758; train_masked_gp_l1_reg_loss: 64927.0042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209954.6941; train_chrom_access_recon_loss: 10690409.7273; train_global_loss: 32223149.2121; train_optim_loss: 32223149.2121; val_kl_reg_loss: 91902.9004; val_edge_recon_loss: 637947.9375; val_gene_expr_recon_loss: 21051533.5000; val_masked_gp_l1_reg_loss: 66598.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 194485.7031; val_chrom_access_recon_loss: 11035624.8750; val_global_loss: 33078093.2500; val_optim_loss: 33078093.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8966; val_auprc_score: 0.8642; val_best_acc_score: 0.8246; val_best_f1_score: 0.8407; train_kl_reg_loss: 92811.7460; train_edge_recon_loss: 632791.8239; train_gene_expr_recon_loss: 20415702.6970; train_masked_gp_l1_reg_loss: 67883.2609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183945.7235; train_chrom_access_recon_loss: 10649971.6061; train_global_loss: 32043107.1212; train_optim_loss: 32043107.1212; val_kl_reg_loss: 86876.7637; val_edge_recon_loss: 632429.2500; val_gene_expr_recon_loss: 20923437.7500; val_masked_gp_l1_reg_loss: 69103.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175738.4219; val_chrom_access_recon_loss: 10941026.6250; val_global_loss: 32828612.2500; val_optim_loss: 32828612.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9063; val_auprc_score: 0.8830; val_best_acc_score: 0.8388; val_best_f1_score: 0.8524; train_kl_reg_loss: 89607.6670; train_edge_recon_loss: 626004.9867; train_gene_expr_recon_loss: 20305090.9091; train_masked_gp_l1_reg_loss: 70193.0856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167670.4029; train_chrom_access_recon_loss: 10594508.9848; train_global_loss: 31853076.0909; train_optim_loss: 31853076.0909; val_kl_reg_loss: 86556.3359; val_edge_recon_loss: 622824.2031; val_gene_expr_recon_loss: 20677309.5000; val_masked_gp_l1_reg_loss: 71253.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160819.0938; val_chrom_access_recon_loss: 10783966.2500; val_global_loss: 32402730.0000; val_optim_loss: 32402730.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9082; val_auprc_score: 0.8858; val_best_acc_score: 0.8377; val_best_f1_score: 0.8485; train_kl_reg_loss: 87041.2251; train_edge_recon_loss: 620384.6354; train_gene_expr_recon_loss: 20226711.7273; train_masked_gp_l1_reg_loss: 72215.7693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155103.5911; train_chrom_access_recon_loss: 10553413.0606; train_global_loss: 31714870.0303; train_optim_loss: 31714870.0303; val_kl_reg_loss: 86646.7168; val_edge_recon_loss: 624371.3828; val_gene_expr_recon_loss: 20651975.0000; val_masked_gp_l1_reg_loss: 73201.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150261.5938; val_chrom_access_recon_loss: 10768253.3750; val_global_loss: 32354710.2500; val_optim_loss: 32354710.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9179; val_auprc_score: 0.8927; val_best_acc_score: 0.8485; val_best_f1_score: 0.8575; train_kl_reg_loss: 84639.0144; train_edge_recon_loss: 614276.5871; train_gene_expr_recon_loss: 20153182.0606; train_masked_gp_l1_reg_loss: 73945.5621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145842.9735; train_chrom_access_recon_loss: 10504121.0758; train_global_loss: 31576007.3333; train_optim_loss: 31576007.3333; val_kl_reg_loss: 82121.4775; val_edge_recon_loss: 615732.2578; val_gene_expr_recon_loss: 20371643.7500; val_masked_gp_l1_reg_loss: 74936.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143074.1250; val_chrom_access_recon_loss: 10680387.1250; val_global_loss: 31967894.2500; val_optim_loss: 31967894.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9127; val_auprc_score: 0.8886; val_best_acc_score: 0.8469; val_best_f1_score: 0.8600; train_kl_reg_loss: 82341.7564; train_edge_recon_loss: 612623.7576; train_gene_expr_recon_loss: 20078530.0909; train_masked_gp_l1_reg_loss: 75570.3549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139547.3984; train_chrom_access_recon_loss: 10465331.0758; train_global_loss: 31453944.5152; train_optim_loss: 31453944.5152; val_kl_reg_loss: 80297.2793; val_edge_recon_loss: 612966.4297; val_gene_expr_recon_loss: 20619989.0000; val_masked_gp_l1_reg_loss: 76391.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136816.1094; val_chrom_access_recon_loss: 10769246.3750; val_global_loss: 32295706.5000; val_optim_loss: 32295706.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9218; val_auprc_score: 0.9022; val_best_acc_score: 0.8538; val_best_f1_score: 0.8626; train_kl_reg_loss: 80371.2169; train_edge_recon_loss: 608785.8220; train_gene_expr_recon_loss: 20000012.0000; train_masked_gp_l1_reg_loss: 77118.9529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134002.2389; train_chrom_access_recon_loss: 10414377.6061; train_global_loss: 31314667.9697; train_optim_loss: 31314667.9697; val_kl_reg_loss: 81382.6807; val_edge_recon_loss: 610937.9688; val_gene_expr_recon_loss: 20637603.5000; val_masked_gp_l1_reg_loss: 77916.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132267.3594; val_chrom_access_recon_loss: 10785820.1250; val_global_loss: 32325928.2500; val_optim_loss: 32325928.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9276; val_auprc_score: 0.9074; val_best_acc_score: 0.8581; val_best_f1_score: 0.8642; train_kl_reg_loss: 79113.2285; train_edge_recon_loss: 606345.4242; train_gene_expr_recon_loss: 19940121.6970; train_masked_gp_l1_reg_loss: 78557.6934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130361.1613; train_chrom_access_recon_loss: 10378299.0303; train_global_loss: 31212798.2727; train_optim_loss: 31212798.2727; val_kl_reg_loss: 78941.1807; val_edge_recon_loss: 614305.5000; val_gene_expr_recon_loss: 20329725.2500; val_masked_gp_l1_reg_loss: 79172.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128856.4141; val_chrom_access_recon_loss: 10601660.2500; val_global_loss: 31832660.0000; val_optim_loss: 31832660.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9339; val_auprc_score: 0.9176; val_best_acc_score: 0.8659; val_best_f1_score: 0.8726; train_kl_reg_loss: 77038.4487; train_edge_recon_loss: 604648.7367; train_gene_expr_recon_loss: 19856042.0000; train_masked_gp_l1_reg_loss: 79939.0900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127292.1177; train_chrom_access_recon_loss: 10315496.2879; train_global_loss: 31060456.6667; train_optim_loss: 31060456.6667; val_kl_reg_loss: 75709.4688; val_edge_recon_loss: 606127.5781; val_gene_expr_recon_loss: 20306330.2500; val_masked_gp_l1_reg_loss: 80564.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125401.0312; val_chrom_access_recon_loss: 10595816.1250; val_global_loss: 31789949.5000; val_optim_loss: 31789949.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9376; val_auprc_score: 0.9194; val_best_acc_score: 0.8713; val_best_f1_score: 0.8765; train_kl_reg_loss: 76082.5653; train_edge_recon_loss: 601410.9669; train_gene_expr_recon_loss: 19815824.6667; train_masked_gp_l1_reg_loss: 81248.5150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124061.9171; train_chrom_access_recon_loss: 10283192.7121; train_global_loss: 30981821.3333; train_optim_loss: 30981821.3333; val_kl_reg_loss: 75418.3203; val_edge_recon_loss: 610354.3594; val_gene_expr_recon_loss: 20379687.5000; val_masked_gp_l1_reg_loss: 82053.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123335.2344; val_chrom_access_recon_loss: 10612987.5000; val_global_loss: 31883837.2500; val_optim_loss: 31883837.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9363; val_auprc_score: 0.9170; val_best_acc_score: 0.8748; val_best_f1_score: 0.8817; train_kl_reg_loss: 75080.1759; train_edge_recon_loss: 599970.7301; train_gene_expr_recon_loss: 19734531.4545; train_masked_gp_l1_reg_loss: 82606.3171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121630.1887; train_chrom_access_recon_loss: 10224870.9545; train_global_loss: 30838689.7879; train_optim_loss: 30838689.7879; val_kl_reg_loss: 74243.6924; val_edge_recon_loss: 605142.9531; val_gene_expr_recon_loss: 20219171.5000; val_masked_gp_l1_reg_loss: 83264.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120123.8984; val_chrom_access_recon_loss: 10595867.1250; val_global_loss: 31697812.7500; val_optim_loss: 31697812.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9451; val_auprc_score: 0.9294; val_best_acc_score: 0.8823; val_best_f1_score: 0.8869; train_kl_reg_loss: 74369.7868; train_edge_recon_loss: 596569.8911; train_gene_expr_recon_loss: 19682896.5152; train_masked_gp_l1_reg_loss: 83837.2988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118949.1036; train_chrom_access_recon_loss: 10180278.7879; train_global_loss: 30736901.3636; train_optim_loss: 30736901.3636; val_kl_reg_loss: 75570.7275; val_edge_recon_loss: 603305.3281; val_gene_expr_recon_loss: 20252098.2500; val_masked_gp_l1_reg_loss: 84522.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117738.1719; val_chrom_access_recon_loss: 10540139.2500; val_global_loss: 31673374.0000; val_optim_loss: 31673374.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9432; val_auprc_score: 0.9302; val_best_acc_score: 0.8821; val_best_f1_score: 0.8862; train_kl_reg_loss: 73002.7861; train_edge_recon_loss: 594739.5341; train_gene_expr_recon_loss: 19628837.8182; train_masked_gp_l1_reg_loss: 85106.7718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116693.8664; train_chrom_access_recon_loss: 10134560.6515; train_global_loss: 30632941.5455; train_optim_loss: 30632941.5455; val_kl_reg_loss: 73600.1387; val_edge_recon_loss: 602674.2578; val_gene_expr_recon_loss: 19970323.0000; val_masked_gp_l1_reg_loss: 85788.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115731.2812; val_chrom_access_recon_loss: 10387048.5000; val_global_loss: 31235165.7500; val_optim_loss: 31235165.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9483; val_auprc_score: 0.9325; val_best_acc_score: 0.8909; val_best_f1_score: 0.8939; train_kl_reg_loss: 72319.3736; train_edge_recon_loss: 592806.2045; train_gene_expr_recon_loss: 19569729.0909; train_masked_gp_l1_reg_loss: 86336.6290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114900.6218; train_chrom_access_recon_loss: 10078004.3030; train_global_loss: 30514096.1515; train_optim_loss: 30514096.1515; val_kl_reg_loss: 71904.4141; val_edge_recon_loss: 597925.2891; val_gene_expr_recon_loss: 20099869.7500; val_masked_gp_l1_reg_loss: 86956.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114256.9609; val_chrom_access_recon_loss: 10548736.7500; val_global_loss: 31519648.0000; val_optim_loss: 31519648.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9443; val_auprc_score: 0.9291; val_best_acc_score: 0.8872; val_best_f1_score: 0.8904; train_kl_reg_loss: 71176.8029; train_edge_recon_loss: 593496.6231; train_gene_expr_recon_loss: 19536808.0303; train_masked_gp_l1_reg_loss: 87509.9403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113276.2966; train_chrom_access_recon_loss: 10043865.3182; train_global_loss: 30446133.1515; train_optim_loss: 30446133.1515; val_kl_reg_loss: 71717.0322; val_edge_recon_loss: 602132.6172; val_gene_expr_recon_loss: 20045439.2500; val_masked_gp_l1_reg_loss: 88144.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112700.5703; val_chrom_access_recon_loss: 10376506.6250; val_global_loss: 31296639.7500; val_optim_loss: 31296639.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9409; val_auprc_score: 0.9233; val_best_acc_score: 0.8818; val_best_f1_score: 0.8867; train_kl_reg_loss: 70410.3904; train_edge_recon_loss: 591576.7339; train_gene_expr_recon_loss: 19466140.0909; train_masked_gp_l1_reg_loss: 88629.9068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111681.4354; train_chrom_access_recon_loss: 9987987.5909; train_global_loss: 30316426.2727; train_optim_loss: 30316426.2727; val_kl_reg_loss: 69455.7568; val_edge_recon_loss: 602969.0859; val_gene_expr_recon_loss: 19985179.2500; val_masked_gp_l1_reg_loss: 89206.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111271.3203; val_chrom_access_recon_loss: 10380267.7500; val_global_loss: 31238350.0000; val_optim_loss: 31238350.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9539; val_auprc_score: 0.9400; val_best_acc_score: 0.9025; val_best_f1_score: 0.9046; train_kl_reg_loss: 70107.7609; train_edge_recon_loss: 588791.9517; train_gene_expr_recon_loss: 19429003.5455; train_masked_gp_l1_reg_loss: 89766.8722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110368.2301; train_chrom_access_recon_loss: 9944507.7273; train_global_loss: 30232546.2121; train_optim_loss: 30232546.2121; val_kl_reg_loss: 69578.9688; val_edge_recon_loss: 588807.2734; val_gene_expr_recon_loss: 19934375.2500; val_masked_gp_l1_reg_loss: 90337.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110244.8516; val_chrom_access_recon_loss: 10342326.7500; val_global_loss: 31135670.2500; val_optim_loss: 31135670.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9505; val_auprc_score: 0.9356; val_best_acc_score: 0.8920; val_best_f1_score: 0.8955; train_kl_reg_loss: 69419.8716; train_edge_recon_loss: 590203.6818; train_gene_expr_recon_loss: 19371994.9091; train_masked_gp_l1_reg_loss: 90965.7467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109489.0054; train_chrom_access_recon_loss: 9897609.5000; train_global_loss: 30129682.6364; train_optim_loss: 30129682.6364; val_kl_reg_loss: 68406.2578; val_edge_recon_loss: 596218.9688; val_gene_expr_recon_loss: 19925290.5000; val_masked_gp_l1_reg_loss: 91565.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109026.2578; val_chrom_access_recon_loss: 10274552.5000; val_global_loss: 31065060.0000; val_optim_loss: 31065060.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9492; val_auprc_score: 0.9317; val_best_acc_score: 0.8920; val_best_f1_score: 0.8958; train_kl_reg_loss: 69039.4181; train_edge_recon_loss: 589176.8911; train_gene_expr_recon_loss: 19331354.7576; train_masked_gp_l1_reg_loss: 92056.7305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108308.7972; train_chrom_access_recon_loss: 9862615.4697; train_global_loss: 30052552.0303; train_optim_loss: 30052552.0303; val_kl_reg_loss: 69336.0732; val_edge_recon_loss: 600957.2578; val_gene_expr_recon_loss: 19905153.5000; val_masked_gp_l1_reg_loss: 92545.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108034.8281; val_chrom_access_recon_loss: 10259603.1250; val_global_loss: 31035630.0000; val_optim_loss: 31035630.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9516; val_auprc_score: 0.9374; val_best_acc_score: 0.8915; val_best_f1_score: 0.8940; train_kl_reg_loss: 68857.8281; train_edge_recon_loss: 588515.5492; train_gene_expr_recon_loss: 19299638.8485; train_masked_gp_l1_reg_loss: 92986.5786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107682.7959; train_chrom_access_recon_loss: 9820649.5758; train_global_loss: 29978331.2727; train_optim_loss: 29978331.2727; val_kl_reg_loss: 69239.1396; val_edge_recon_loss: 592935.8906; val_gene_expr_recon_loss: 19889870.7500; val_masked_gp_l1_reg_loss: 93546.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107362.9453; val_chrom_access_recon_loss: 10253885.6250; val_global_loss: 31006840.0000; val_optim_loss: 31006840.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8692; val_auprc_score: 0.8345; val_best_acc_score: 0.7660; val_best_f1_score: 0.8069; train_kl_reg_loss: 98436.3202; train_edge_recon_loss: 782721.4280; train_gene_expr_recon_loss: 18318182.2727; train_masked_gp_l1_reg_loss: 91931.8808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111931.2495; train_chrom_access_recon_loss: 9343466.8788; train_global_loss: 28746670.1515; train_optim_loss: 28746670.1515; val_kl_reg_loss: 12550.9917; val_edge_recon_loss: 795764.0391; val_gene_expr_recon_loss: 18023274.5000; val_masked_gp_l1_reg_loss: 89584.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112398.4844; val_chrom_access_recon_loss: 9442679.8750; val_global_loss: 28476251.2500; val_optim_loss: 28476251.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8446; val_auprc_score: 0.8018; val_best_acc_score: 0.7730; val_best_f1_score: 0.8010; train_kl_reg_loss: 17233.3223; train_edge_recon_loss: 777228.8419; train_gene_expr_recon_loss: 17674543.2576; train_masked_gp_l1_reg_loss: 87727.7410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111906.8858; train_chrom_access_recon_loss: 9212901.7273; train_global_loss: 27881541.7879; train_optim_loss: 27881541.7879; val_kl_reg_loss: 10912.7128; val_edge_recon_loss: 780206.6094; val_gene_expr_recon_loss: 18069378.5000; val_masked_gp_l1_reg_loss: 86662.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113966.0078; val_chrom_access_recon_loss: 9450004.8750; val_global_loss: 28511130.5000; val_optim_loss: 28511130.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8500; val_auprc_score: 0.8161; val_best_acc_score: 0.7800; val_best_f1_score: 0.8100; train_kl_reg_loss: 16018.2687; train_edge_recon_loss: 760800.9148; train_gene_expr_recon_loss: 17557633.6515; train_masked_gp_l1_reg_loss: 84142.8162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113233.7596; train_chrom_access_recon_loss: 9170391.1818; train_global_loss: 27702220.6061; train_optim_loss: 27702220.6061; val_kl_reg_loss: 13148.5242; val_edge_recon_loss: 750583.4219; val_gene_expr_recon_loss: 17846706.2500; val_masked_gp_l1_reg_loss: 82480.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113390.4531; val_chrom_access_recon_loss: 9298333.8750; val_global_loss: 28104642.2500; val_optim_loss: 28104642.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8481; val_auprc_score: 0.8131; val_best_acc_score: 0.7783; val_best_f1_score: 0.8074; train_kl_reg_loss: 17428.7580; train_edge_recon_loss: 725049.8267; train_gene_expr_recon_loss: 17493624.5455; train_masked_gp_l1_reg_loss: 80637.7157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112747.7298; train_chrom_access_recon_loss: 9149705.6212; train_global_loss: 27579194.3939; train_optim_loss: 27579194.3939; val_kl_reg_loss: 14090.8195; val_edge_recon_loss: 726717.2578; val_gene_expr_recon_loss: 17798627.0000; val_masked_gp_l1_reg_loss: 79018.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113248.5156; val_chrom_access_recon_loss: 9372343.6250; val_global_loss: 28104044.5000; val_optim_loss: 28104044.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8565; val_auprc_score: 0.8156; val_best_acc_score: 0.7848; val_best_f1_score: 0.8101; train_kl_reg_loss: 19478.6532; train_edge_recon_loss: 693095.2973; train_gene_expr_recon_loss: 17441613.9545; train_masked_gp_l1_reg_loss: 77741.7699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111999.9781; train_chrom_access_recon_loss: 9122397.3182; train_global_loss: 27466326.9697; train_optim_loss: 27466326.9697; val_kl_reg_loss: 17614.4294; val_edge_recon_loss: 675271.5078; val_gene_expr_recon_loss: 17984214.7500; val_masked_gp_l1_reg_loss: 76529.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110416.9297; val_chrom_access_recon_loss: 9363609.2500; val_global_loss: 28227656.0000; val_optim_loss: 28227656.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8524; val_auprc_score: 0.8203; val_best_acc_score: 0.7783; val_best_f1_score: 0.8060; train_kl_reg_loss: 22835.9429; train_edge_recon_loss: 660405.7225; train_gene_expr_recon_loss: 17419391.0606; train_masked_gp_l1_reg_loss: 75563.4809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108441.3061; train_chrom_access_recon_loss: 9114362.5909; train_global_loss: 27401000.3030; train_optim_loss: 27401000.3030; val_kl_reg_loss: 21357.1047; val_edge_recon_loss: 647652.2891; val_gene_expr_recon_loss: 17905577.0000; val_masked_gp_l1_reg_loss: 74725.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106781.7031; val_chrom_access_recon_loss: 9327253.0000; val_global_loss: 28083347.0000; val_optim_loss: 28083347.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8487; val_auprc_score: 0.8114; val_best_acc_score: 0.7808; val_best_f1_score: 0.8050; train_kl_reg_loss: 27441.6607; train_edge_recon_loss: 633959.3513; train_gene_expr_recon_loss: 17356397.6818; train_masked_gp_l1_reg_loss: 74038.0462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105172.6272; train_chrom_access_recon_loss: 9079298.0303; train_global_loss: 27276307.4848; train_optim_loss: 27276307.4848; val_kl_reg_loss: 27573.3652; val_edge_recon_loss: 617854.5078; val_gene_expr_recon_loss: 17685324.2500; val_masked_gp_l1_reg_loss: 73297.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103960.1172; val_chrom_access_recon_loss: 9337639.7500; val_global_loss: 27845650.0000; val_optim_loss: 27845650.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8520; val_auprc_score: 0.8166; val_best_acc_score: 0.7797; val_best_f1_score: 0.8031; train_kl_reg_loss: 32372.3009; train_edge_recon_loss: 621907.1032; train_gene_expr_recon_loss: 17312046.2424; train_masked_gp_l1_reg_loss: 72605.2925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101992.4344; train_chrom_access_recon_loss: 9081349.5909; train_global_loss: 27222272.8485; train_optim_loss: 27222272.8485; val_kl_reg_loss: 30172.3936; val_edge_recon_loss: 616320.0078; val_gene_expr_recon_loss: 17753343.7500; val_masked_gp_l1_reg_loss: 72025.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101333.6406; val_chrom_access_recon_loss: 9302335.1250; val_global_loss: 27875531.2500; val_optim_loss: 27875531.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8468; val_auprc_score: 0.8051; val_best_acc_score: 0.7834; val_best_f1_score: 0.8084; train_kl_reg_loss: 34952.7186; train_edge_recon_loss: 611997.9962; train_gene_expr_recon_loss: 17323857.9242; train_masked_gp_l1_reg_loss: 71417.9345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99762.2966; train_chrom_access_recon_loss: 9062421.9242; train_global_loss: 27204410.6970; train_optim_loss: 27204410.6970; val_kl_reg_loss: 33006.1433; val_edge_recon_loss: 610439.8594; val_gene_expr_recon_loss: 17735302.7500; val_masked_gp_l1_reg_loss: 70844.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98436.3203; val_chrom_access_recon_loss: 9293277.6250; val_global_loss: 27841306.2500; val_optim_loss: 27841306.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8493; val_auprc_score: 0.8141; val_best_acc_score: 0.7826; val_best_f1_score: 0.8062; train_kl_reg_loss: 36376.4157; train_edge_recon_loss: 609141.4280; train_gene_expr_recon_loss: 17286961.3333; train_masked_gp_l1_reg_loss: 70374.9693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97393.4080; train_chrom_access_recon_loss: 9040213.6667; train_global_loss: 27140461.2727; train_optim_loss: 27140461.2727; val_kl_reg_loss: 36065.7280; val_edge_recon_loss: 600289.2969; val_gene_expr_recon_loss: 17609073.7500; val_masked_gp_l1_reg_loss: 69795.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96174.8672; val_chrom_access_recon_loss: 9293995.5000; val_global_loss: 27705394.5000; val_optim_loss: 27705394.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8505; val_auprc_score: 0.8126; val_best_acc_score: 0.7773; val_best_f1_score: 0.8033; train_kl_reg_loss: 37912.7596; train_edge_recon_loss: 608835.7197; train_gene_expr_recon_loss: 17265574.3030; train_masked_gp_l1_reg_loss: 69277.5369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95379.9509; train_chrom_access_recon_loss: 9029271.5758; train_global_loss: 27106251.9091; train_optim_loss: 27106251.9091; val_kl_reg_loss: 36712.7183; val_edge_recon_loss: 609134.8359; val_gene_expr_recon_loss: 17671000.2500; val_masked_gp_l1_reg_loss: 68678.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94341.7969; val_chrom_access_recon_loss: 9251868.2500; val_global_loss: 27731736.5000; val_optim_loss: 27731736.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8524; val_auprc_score: 0.8146; val_best_acc_score: 0.7773; val_best_f1_score: 0.8074; train_kl_reg_loss: 38855.8295; train_edge_recon_loss: 601775.0938; train_gene_expr_recon_loss: 17247555.7727; train_masked_gp_l1_reg_loss: 68246.3965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93609.3643; train_chrom_access_recon_loss: 9016504.6364; train_global_loss: 27066546.7273; train_optim_loss: 27066546.7273; val_kl_reg_loss: 38147.4282; val_edge_recon_loss: 602874.9141; val_gene_expr_recon_loss: 17696541.0000; val_masked_gp_l1_reg_loss: 67864.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93072.8984; val_chrom_access_recon_loss: 9244289.3750; val_global_loss: 27742789.0000; val_optim_loss: 27742789.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8545; val_auprc_score: 0.8233; val_best_acc_score: 0.7783; val_best_f1_score: 0.8091; train_kl_reg_loss: 39079.5241; train_edge_recon_loss: 604098.6288; train_gene_expr_recon_loss: 17247111.0606; train_masked_gp_l1_reg_loss: 67449.7008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92241.2012; train_chrom_access_recon_loss: 9020328.6212; train_global_loss: 27070308.5758; train_optim_loss: 27070308.5758; val_kl_reg_loss: 35857.0786; val_edge_recon_loss: 614186.1719; val_gene_expr_recon_loss: 17695617.5000; val_masked_gp_l1_reg_loss: 67109.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91439.0312; val_chrom_access_recon_loss: 9201410.3750; val_global_loss: 27705620.7500; val_optim_loss: 27705620.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8508; val_auprc_score: 0.8109; val_best_acc_score: 0.7837; val_best_f1_score: 0.8107; train_kl_reg_loss: 39958.7785; train_edge_recon_loss: 606102.7860; train_gene_expr_recon_loss: 17221788.8333; train_masked_gp_l1_reg_loss: 66739.5098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90905.4721; train_chrom_access_recon_loss: 8995514.4394; train_global_loss: 27021009.9091; train_optim_loss: 27021009.9091; val_kl_reg_loss: 37600.3774; val_edge_recon_loss: 601849.3281; val_gene_expr_recon_loss: 17646029.5000; val_masked_gp_l1_reg_loss: 66373.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90170.1016; val_chrom_access_recon_loss: 9249094.7500; val_global_loss: 27691117.7500; val_optim_loss: 27691117.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8583; val_auprc_score: 0.8250; val_best_acc_score: 0.7837; val_best_f1_score: 0.8087; train_kl_reg_loss: 40136.7148; train_edge_recon_loss: 602942.5398; train_gene_expr_recon_loss: 17202546.8182; train_masked_gp_l1_reg_loss: 66108.0241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89708.1600; train_chrom_access_recon_loss: 9002879.3030; train_global_loss: 27004321.4848; train_optim_loss: 27004321.4848; val_kl_reg_loss: 37059.9087; val_edge_recon_loss: 602466.9453; val_gene_expr_recon_loss: 17530124.7500; val_masked_gp_l1_reg_loss: 65816.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89352.7656; val_chrom_access_recon_loss: 9125403.0000; val_global_loss: 27450222.2500; val_optim_loss: 27450222.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8606; val_auprc_score: 0.8286; val_best_acc_score: 0.7880; val_best_f1_score: 0.8143; train_kl_reg_loss: 40049.6697; train_edge_recon_loss: 602337.4394; train_gene_expr_recon_loss: 17165908.1818; train_masked_gp_l1_reg_loss: 65490.7483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88865.3369; train_chrom_access_recon_loss: 8976030.1818; train_global_loss: 26938681.3333; train_optim_loss: 26938681.3333; val_kl_reg_loss: 37815.6792; val_edge_recon_loss: 600356.4766; val_gene_expr_recon_loss: 17407877.6250; val_masked_gp_l1_reg_loss: 65225.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88323.4062; val_chrom_access_recon_loss: 9096424.8750; val_global_loss: 27296024.5000; val_optim_loss: 27296024.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8590; val_auprc_score: 0.8245; val_best_acc_score: 0.7864; val_best_f1_score: 0.8139; train_kl_reg_loss: 40140.6577; train_edge_recon_loss: 600690.3939; train_gene_expr_recon_loss: 17152297.1667; train_masked_gp_l1_reg_loss: 64965.6710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87884.1419; train_chrom_access_recon_loss: 8960154.6818; train_global_loss: 26906132.6364; train_optim_loss: 26906132.6364; val_kl_reg_loss: 38274.5435; val_edge_recon_loss: 600243.6328; val_gene_expr_recon_loss: 17624712.7500; val_masked_gp_l1_reg_loss: 64769.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87804.0469; val_chrom_access_recon_loss: 9253305.5000; val_global_loss: 27669110.2500; val_optim_loss: 27669110.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8652; val_auprc_score: 0.8301; val_best_acc_score: 0.7937; val_best_f1_score: 0.8179; train_kl_reg_loss: 39383.5620; train_edge_recon_loss: 602333.0682; train_gene_expr_recon_loss: 17147816.2576; train_masked_gp_l1_reg_loss: 64655.4315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87255.4620; train_chrom_access_recon_loss: 8988054.9394; train_global_loss: 26929498.5758; train_optim_loss: 26929498.5758; val_kl_reg_loss: 37589.0532; val_edge_recon_loss: 601157.7656; val_gene_expr_recon_loss: 17528265.7500; val_masked_gp_l1_reg_loss: 64611.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87140.3281; val_chrom_access_recon_loss: 9304922.2500; val_global_loss: 27623686.7500; val_optim_loss: 27623686.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8654; val_auprc_score: 0.8336; val_best_acc_score: 0.7939; val_best_f1_score: 0.8176; train_kl_reg_loss: 39390.9603; train_edge_recon_loss: 601118.8466; train_gene_expr_recon_loss: 17115013.7424; train_masked_gp_l1_reg_loss: 64447.2837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86388.3240; train_chrom_access_recon_loss: 8938323.9091; train_global_loss: 26844682.8485; train_optim_loss: 26844682.8485; val_kl_reg_loss: 38494.4731; val_edge_recon_loss: 602345.1953; val_gene_expr_recon_loss: 17616422.2500; val_masked_gp_l1_reg_loss: 64248.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85870.4922; val_chrom_access_recon_loss: 9187301.1250; val_global_loss: 27594681.5000; val_optim_loss: 27594681.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8590; val_auprc_score: 0.8225; val_best_acc_score: 0.7902; val_best_f1_score: 0.8187; train_kl_reg_loss: 39503.4688; train_edge_recon_loss: 597871.3324; train_gene_expr_recon_loss: 17091055.6970; train_masked_gp_l1_reg_loss: 64149.1982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85396.0064; train_chrom_access_recon_loss: 8936033.0758; train_global_loss: 26814008.8485; train_optim_loss: 26814008.8485; val_kl_reg_loss: 38408.2905; val_edge_recon_loss: 595986.4531; val_gene_expr_recon_loss: 17409371.2500; val_masked_gp_l1_reg_loss: 63959.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85174.1328; val_chrom_access_recon_loss: 9167241.6250; val_global_loss: 27360141.7500; val_optim_loss: 27360141.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8531; val_auprc_score: 0.8139; val_best_acc_score: 0.7837; val_best_f1_score: 0.8120; train_kl_reg_loss: 39896.9077; train_edge_recon_loss: 596491.2216; train_gene_expr_recon_loss: 17062313.0152; train_masked_gp_l1_reg_loss: 63441.5893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70160.4126; train_chrom_access_recon_loss: 8914458.7121; train_global_loss: 26746761.9394; train_optim_loss: 26746761.9394; val_kl_reg_loss: 39106.5688; val_edge_recon_loss: 607347.2969; val_gene_expr_recon_loss: 17460108.5000; val_masked_gp_l1_reg_loss: 63240.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67144.3750; val_chrom_access_recon_loss: 9179320.0000; val_global_loss: 27416266.5000; val_optim_loss: 27416266.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8482; val_auprc_score: 0.8137; val_best_acc_score: 0.7751; val_best_f1_score: 0.8065; train_kl_reg_loss: 40092.8759; train_edge_recon_loss: 596280.7509; train_gene_expr_recon_loss: 17073179.5303; train_masked_gp_l1_reg_loss: 63171.4398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66780.5405; train_chrom_access_recon_loss: 8920218.5076; train_global_loss: 26759723.6667; train_optim_loss: 26759723.6667; val_kl_reg_loss: 39748.7871; val_edge_recon_loss: 607157.2344; val_gene_expr_recon_loss: 17660229.5000; val_masked_gp_l1_reg_loss: 63136.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66457.7031; val_chrom_access_recon_loss: 9368943.0000; val_global_loss: 27805672.0000; val_optim_loss: 27805672.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8635; val_auprc_score: 0.8297; val_best_acc_score: 0.7931; val_best_f1_score: 0.8201; train_kl_reg_loss: 40432.7634; train_edge_recon_loss: 595893.0975; train_gene_expr_recon_loss: 17073809.5758; train_masked_gp_l1_reg_loss: 63093.2923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66239.4949; train_chrom_access_recon_loss: 8923875.8333; train_global_loss: 26763343.8788; train_optim_loss: 26763343.8788; val_kl_reg_loss: 39693.0747; val_edge_recon_loss: 596024.7031; val_gene_expr_recon_loss: 17510847.0000; val_masked_gp_l1_reg_loss: 63064.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65945.2422; val_chrom_access_recon_loss: 9159719.2500; val_global_loss: 27435293.7500; val_optim_loss: 27435293.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8601; val_auprc_score: 0.8291; val_best_acc_score: 0.7907; val_best_f1_score: 0.8153; train_kl_reg_loss: 40653.3553; train_edge_recon_loss: 595194.0142; train_gene_expr_recon_loss: 17069890.8939; train_masked_gp_l1_reg_loss: 63031.9242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65799.9040; train_chrom_access_recon_loss: 8917214.4242; train_global_loss: 26751784.5152; train_optim_loss: 26751784.5152; val_kl_reg_loss: 39926.8926; val_edge_recon_loss: 598414.3359; val_gene_expr_recon_loss: 17427551.5000; val_masked_gp_l1_reg_loss: 63001.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65617.1953; val_chrom_access_recon_loss: 9138185.1250; val_global_loss: 27332697.7500; val_optim_loss: 27332697.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 48 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.8541
val AUPRC score: 0.8248
val best accuracy score: 0.7794
val best F1 score: 0.8082
val target rna MSE score: 2.4677
val source rna MSE score: 1.3344
val target atac MSE score: 0.3518
val source atac MSE score: 0.1635
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
