[True]
Run timestamp: 07092023_035059_255.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_255']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 792 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3517, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 792
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 792

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7976; val_auprc_score: 0.8119; val_best_acc_score: 0.6211; val_best_f1_score: 0.7157; train_kl_reg_loss: 76645.2335; train_edge_recon_loss: 3528627.3282; train_gene_expr_recon_loss: 12620205.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 656603.4752; train_chrom_access_recon_loss: 4473635.6450; train_global_loss: 21355717.0076; train_optim_loss: 21355717.0076; val_kl_reg_loss: 101621.6161; val_edge_recon_loss: 4056641.8500; val_gene_expr_recon_loss: 12026996.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 360487.4375; val_chrom_access_recon_loss: 4280278.8833; val_global_loss: 20826025.8667; val_optim_loss: 20826025.8667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8775; val_auprc_score: 0.8678; val_best_acc_score: 0.7972; val_best_f1_score: 0.8128; train_kl_reg_loss: 74363.9283; train_edge_recon_loss: 3456177.1489; train_gene_expr_recon_loss: 11781260.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224606.0546; train_chrom_access_recon_loss: 4278992.8855; train_global_loss: 19815400.1679; train_optim_loss: 19815400.1679; val_kl_reg_loss: 55165.4039; val_edge_recon_loss: 3242969.2667; val_gene_expr_recon_loss: 11867662.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139246.6250; val_chrom_access_recon_loss: 4230810.4167; val_global_loss: 19535855.0667; val_optim_loss: 19535855.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9001; val_auprc_score: 0.8849; val_best_acc_score: 0.8211; val_best_f1_score: 0.8381; train_kl_reg_loss: 83122.3369; train_edge_recon_loss: 2953738.8416; train_gene_expr_recon_loss: 11650961.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102044.4175; train_chrom_access_recon_loss: 4234133.3187; train_global_loss: 19024000.7634; train_optim_loss: 19024000.7634; val_kl_reg_loss: 87855.6708; val_edge_recon_loss: 2886579.3667; val_gene_expr_recon_loss: 11654687.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75806.9844; val_chrom_access_recon_loss: 4190635.7667; val_global_loss: 18895565.6000; val_optim_loss: 18895565.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9118; val_auprc_score: 0.8958; val_best_acc_score: 0.8397; val_best_f1_score: 0.8525; train_kl_reg_loss: 86912.4060; train_edge_recon_loss: 2852067.8989; train_gene_expr_recon_loss: 11474897.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63893.2843; train_chrom_access_recon_loss: 4181478.1031; train_global_loss: 18659248.8550; train_optim_loss: 18659248.8550; val_kl_reg_loss: 84996.8396; val_edge_recon_loss: 2852646.6000; val_gene_expr_recon_loss: 11496301.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54904.1250; val_chrom_access_recon_loss: 4137594.5500; val_global_loss: 18626443.7333; val_optim_loss: 18626443.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9203; val_auprc_score: 0.9040; val_best_acc_score: 0.8511; val_best_f1_score: 0.8610; train_kl_reg_loss: 85347.6254; train_edge_recon_loss: 2815993.0611; train_gene_expr_recon_loss: 11340844.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49145.0687; train_chrom_access_recon_loss: 4145561.2653; train_global_loss: 18436891.5878; train_optim_loss: 18436891.5878; val_kl_reg_loss: 82081.4760; val_edge_recon_loss: 2819852.7833; val_gene_expr_recon_loss: 11401577.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44996.7461; val_chrom_access_recon_loss: 4095545.8500; val_global_loss: 18444055.0667; val_optim_loss: 18444055.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9295; val_auprc_score: 0.9146; val_best_acc_score: 0.8632; val_best_f1_score: 0.8687; train_kl_reg_loss: 81247.9302; train_edge_recon_loss: 2804941.5973; train_gene_expr_recon_loss: 11226394.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41742.3194; train_chrom_access_recon_loss: 4103530.4237; train_global_loss: 18257856.3817; train_optim_loss: 18257856.3817; val_kl_reg_loss: 78916.3776; val_edge_recon_loss: 2810249.3167; val_gene_expr_recon_loss: 11273479.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39508.8672; val_chrom_access_recon_loss: 4063691.6667; val_global_loss: 18265845.8667; val_optim_loss: 18265845.8667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9403; val_auprc_score: 0.9256; val_best_acc_score: 0.8770; val_best_f1_score: 0.8823; train_kl_reg_loss: 76437.8171; train_edge_recon_loss: 2768287.4618; train_gene_expr_recon_loss: 11137863.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37616.6398; train_chrom_access_recon_loss: 4075533.8702; train_global_loss: 18095739.2214; train_optim_loss: 18095739.2214; val_kl_reg_loss: 75835.2375; val_edge_recon_loss: 2785337.2667; val_gene_expr_recon_loss: 11220843.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36192.7070; val_chrom_access_recon_loss: 4048659.2167; val_global_loss: 18166867.8667; val_optim_loss: 18166867.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9498; val_auprc_score: 0.9393; val_best_acc_score: 0.8859; val_best_f1_score: 0.8912; train_kl_reg_loss: 72332.3970; train_edge_recon_loss: 2752466.4523; train_gene_expr_recon_loss: 11045795.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35222.9033; train_chrom_access_recon_loss: 4042489.3607; train_global_loss: 17948306.3435; train_optim_loss: 17948306.3435; val_kl_reg_loss: 73955.3484; val_edge_recon_loss: 2753538.3500; val_gene_expr_recon_loss: 11120653.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34416.0820; val_chrom_access_recon_loss: 4006299.9333; val_global_loss: 17988863.3333; val_optim_loss: 17988863.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9527; val_auprc_score: 0.9409; val_best_acc_score: 0.8940; val_best_f1_score: 0.8990; train_kl_reg_loss: 72512.8514; train_edge_recon_loss: 2723621.3034; train_gene_expr_recon_loss: 10975125.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33590.7439; train_chrom_access_recon_loss: 4020824.0515; train_global_loss: 17825674.8779; train_optim_loss: 17825674.8779; val_kl_reg_loss: 70930.3339; val_edge_recon_loss: 2735191.7000; val_gene_expr_recon_loss: 11069375.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33247.9766; val_chrom_access_recon_loss: 3986077.3333; val_global_loss: 17894822.6667; val_optim_loss: 17894822.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9577; val_auprc_score: 0.9475; val_best_acc_score: 0.8981; val_best_f1_score: 0.9017; train_kl_reg_loss: 70517.1565; train_edge_recon_loss: 2716152.8244; train_gene_expr_recon_loss: 10906044.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32505.9866; train_chrom_access_recon_loss: 3998111.2080; train_global_loss: 17723331.6031; train_optim_loss: 17723331.6031; val_kl_reg_loss: 68711.9453; val_edge_recon_loss: 2718714.7500; val_gene_expr_recon_loss: 10973484.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31746.0332; val_chrom_access_recon_loss: 3960931.8333; val_global_loss: 17753588.9333; val_optim_loss: 17753588.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9587; val_auprc_score: 0.9434; val_best_acc_score: 0.9030; val_best_f1_score: 0.9065; train_kl_reg_loss: 69226.2632; train_edge_recon_loss: 2703995.7672; train_gene_expr_recon_loss: 10843114.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31480.1107; train_chrom_access_recon_loss: 3974574.6546; train_global_loss: 17622391.5954; train_optim_loss: 17622391.5954; val_kl_reg_loss: 69614.3281; val_edge_recon_loss: 2705800.0167; val_gene_expr_recon_loss: 10929274.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30933.5625; val_chrom_access_recon_loss: 3948090.2000; val_global_loss: 17683712.8000; val_optim_loss: 17683712.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9627; val_auprc_score: 0.9538; val_best_acc_score: 0.9065; val_best_f1_score: 0.9099; train_kl_reg_loss: 67573.3454; train_edge_recon_loss: 2704793.0515; train_gene_expr_recon_loss: 10798313.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30623.4686; train_chrom_access_recon_loss: 3959813.2405; train_global_loss: 17561116.9084; train_optim_loss: 17561116.9084; val_kl_reg_loss: 62428.7518; val_edge_recon_loss: 2696313.5167; val_gene_expr_recon_loss: 10928522.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30392.4570; val_chrom_access_recon_loss: 3935997.7167; val_global_loss: 17653654.6667; val_optim_loss: 17653654.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9649; val_auprc_score: 0.9558; val_best_acc_score: 0.9117; val_best_f1_score: 0.9157; train_kl_reg_loss: 64643.5662; train_edge_recon_loss: 2698593.1393; train_gene_expr_recon_loss: 10743064.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30023.7914; train_chrom_access_recon_loss: 3937018.1393; train_global_loss: 17473343.3359; train_optim_loss: 17473343.3359; val_kl_reg_loss: 63049.0807; val_edge_recon_loss: 2691265.6500; val_gene_expr_recon_loss: 10888760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30003.4238; val_chrom_access_recon_loss: 3920518.7000; val_global_loss: 17593596.5333; val_optim_loss: 17593596.5333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9614; val_auprc_score: 0.9476; val_best_acc_score: 0.9065; val_best_f1_score: 0.9101; train_kl_reg_loss: 62156.1692; train_edge_recon_loss: 2698885.4141; train_gene_expr_recon_loss: 10709535.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29570.2641; train_chrom_access_recon_loss: 3923943.7672; train_global_loss: 17424090.8015; train_optim_loss: 17424090.8015; val_kl_reg_loss: 63168.0555; val_edge_recon_loss: 2709254.1667; val_gene_expr_recon_loss: 10807729.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29465.6250; val_chrom_access_recon_loss: 3906821.8500; val_global_loss: 17516440.0000; val_optim_loss: 17516440.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9689; val_auprc_score: 0.9586; val_best_acc_score: 0.9181; val_best_f1_score: 0.9201; train_kl_reg_loss: 61600.6574; train_edge_recon_loss: 2689880.5267; train_gene_expr_recon_loss: 10659685.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29178.7069; train_chrom_access_recon_loss: 3906561.3721; train_global_loss: 17346907.1832; train_optim_loss: 17346907.1832; val_kl_reg_loss: 60715.6727; val_edge_recon_loss: 2681063.8000; val_gene_expr_recon_loss: 10757228.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29221.5078; val_chrom_access_recon_loss: 3874410.3167; val_global_loss: 17402640.6000; val_optim_loss: 17402640.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9701; val_auprc_score: 0.9616; val_best_acc_score: 0.9194; val_best_f1_score: 0.9225; train_kl_reg_loss: 59907.3237; train_edge_recon_loss: 2689244.0725; train_gene_expr_recon_loss: 10612463.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28874.1380; train_chrom_access_recon_loss: 3889527.4790; train_global_loss: 17280016.2519; train_optim_loss: 17280016.2519; val_kl_reg_loss: 60186.0492; val_edge_recon_loss: 2680804.9333; val_gene_expr_recon_loss: 10715835.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28849.3203; val_chrom_access_recon_loss: 3854666.2167; val_global_loss: 17340341.5333; val_optim_loss: 17340341.5333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9742; val_auprc_score: 0.9651; val_best_acc_score: 0.9271; val_best_f1_score: 0.9281; train_kl_reg_loss: 58540.7576; train_edge_recon_loss: 2679873.8989; train_gene_expr_recon_loss: 10581688.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28665.5358; train_chrom_access_recon_loss: 3877278.3130; train_global_loss: 17226046.5344; train_optim_loss: 17226046.5344; val_kl_reg_loss: 59220.3690; val_edge_recon_loss: 2671514.1500; val_gene_expr_recon_loss: 10734059.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28725.4766; val_chrom_access_recon_loss: 3859071.1167; val_global_loss: 17352590.2000; val_optim_loss: 17352590.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9695; val_auprc_score: 0.9567; val_best_acc_score: 0.9202; val_best_f1_score: 0.9228; train_kl_reg_loss: 57731.1592; train_edge_recon_loss: 2676133.1813; train_gene_expr_recon_loss: 10554828.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28476.0173; train_chrom_access_recon_loss: 3864138.9065; train_global_loss: 17181307.4046; train_optim_loss: 17181307.4046; val_kl_reg_loss: 56491.0086; val_edge_recon_loss: 2686071.0167; val_gene_expr_recon_loss: 10649583.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28536.8477; val_chrom_access_recon_loss: 3853444.3500; val_global_loss: 17274127.0667; val_optim_loss: 17274127.0667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9729; val_auprc_score: 0.9634; val_best_acc_score: 0.9282; val_best_f1_score: 0.9300; train_kl_reg_loss: 56548.1696; train_edge_recon_loss: 2685101.0038; train_gene_expr_recon_loss: 10520034.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28488.1432; train_chrom_access_recon_loss: 3852113.8111; train_global_loss: 17142285.5649; train_optim_loss: 17142285.5649; val_kl_reg_loss: 55049.3646; val_edge_recon_loss: 2670830.8500; val_gene_expr_recon_loss: 10633694.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28431.7969; val_chrom_access_recon_loss: 3838723.4833; val_global_loss: 17226730.0000; val_optim_loss: 17226730.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9760; val_auprc_score: 0.9691; val_best_acc_score: 0.9299; val_best_f1_score: 0.9327; train_kl_reg_loss: 55994.3748; train_edge_recon_loss: 2668898.6298; train_gene_expr_recon_loss: 10493369.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28380.3946; train_chrom_access_recon_loss: 3839961.2615; train_global_loss: 17086604.5725; train_optim_loss: 17086604.5725; val_kl_reg_loss: 56433.2966; val_edge_recon_loss: 2669675.1500; val_gene_expr_recon_loss: 10618803.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28513.5801; val_chrom_access_recon_loss: 3817520.0000; val_global_loss: 17190945.6000; val_optim_loss: 17190945.6000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9736; val_auprc_score: 0.9668; val_best_acc_score: 0.9251; val_best_f1_score: 0.9279; train_kl_reg_loss: 55398.7117; train_edge_recon_loss: 2668598.5878; train_gene_expr_recon_loss: 10470535.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28364.6664; train_chrom_access_recon_loss: 3830923.8302; train_global_loss: 17053821.7252; train_optim_loss: 17053821.7252; val_kl_reg_loss: 55488.1831; val_edge_recon_loss: 2690824.9167; val_gene_expr_recon_loss: 10585801.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28658.7031; val_chrom_access_recon_loss: 3806645.2833; val_global_loss: 17167419.5333; val_optim_loss: 17167419.5333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9777; val_auprc_score: 0.9710; val_best_acc_score: 0.9312; val_best_f1_score: 0.9329; train_kl_reg_loss: 54660.0611; train_edge_recon_loss: 2668540.6966; train_gene_expr_recon_loss: 10440380.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28399.4155; train_chrom_access_recon_loss: 3817976.6069; train_global_loss: 17009957.7176; train_optim_loss: 17009957.7176; val_kl_reg_loss: 53301.9836; val_edge_recon_loss: 2676355.8333; val_gene_expr_recon_loss: 10586976.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28368.0703; val_chrom_access_recon_loss: 3826455.8333; val_global_loss: 17171457.7333; val_optim_loss: 17171457.7333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9737; val_auprc_score: 0.9637; val_best_acc_score: 0.9318; val_best_f1_score: 0.9338; train_kl_reg_loss: 53751.7706; train_edge_recon_loss: 2664713.8111; train_gene_expr_recon_loss: 10422866.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28501.8690; train_chrom_access_recon_loss: 3812729.5859; train_global_loss: 16982563.3893; train_optim_loss: 16982563.3893; val_kl_reg_loss: 54134.5878; val_edge_recon_loss: 2678689.3167; val_gene_expr_recon_loss: 10562369.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28631.5312; val_chrom_access_recon_loss: 3799398.9000; val_global_loss: 17123223.7333; val_optim_loss: 17123223.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9744; val_auprc_score: 0.9665; val_best_acc_score: 0.9272; val_best_f1_score: 0.9300; train_kl_reg_loss: 52924.2640; train_edge_recon_loss: 2661048.1469; train_gene_expr_recon_loss: 10397558.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28526.1997; train_chrom_access_recon_loss: 3799432.5115; train_global_loss: 16939489.2519; train_optim_loss: 16939489.2519; val_kl_reg_loss: 52937.8688; val_edge_recon_loss: 2671691.7333; val_gene_expr_recon_loss: 10538274.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28821.8145; val_chrom_access_recon_loss: 3816528.1500; val_global_loss: 17108254.7333; val_optim_loss: 17108254.7333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9774; val_auprc_score: 0.9692; val_best_acc_score: 0.9356; val_best_f1_score: 0.9371; train_kl_reg_loss: 52549.0700; train_edge_recon_loss: 2658245.3378; train_gene_expr_recon_loss: 10364776.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28622.5935; train_chrom_access_recon_loss: 3785686.6489; train_global_loss: 16889880.2290; train_optim_loss: 16889880.2290; val_kl_reg_loss: 51477.0648; val_edge_recon_loss: 2674514.7667; val_gene_expr_recon_loss: 10570574.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29007.8887; val_chrom_access_recon_loss: 3797427.5833; val_global_loss: 17123001.8667; val_optim_loss: 17123001.8667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9775; val_auprc_score: 0.9697; val_best_acc_score: 0.9341; val_best_f1_score: 0.9363; train_kl_reg_loss: 51472.3889; train_edge_recon_loss: 2668472.8798; train_gene_expr_recon_loss: 10318816.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25784.0641; train_chrom_access_recon_loss: 3795921.9046; train_global_loss: 16860467.7863; train_optim_loss: 16860467.7863; val_kl_reg_loss: 44494.2690; val_edge_recon_loss: 2671326.1167; val_gene_expr_recon_loss: 10474477.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25368.9023; val_chrom_access_recon_loss: 3787862.3000; val_global_loss: 17003529.0000; val_optim_loss: 17003529.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9802; val_auprc_score: 0.9719; val_best_acc_score: 0.9375; val_best_f1_score: 0.9393; train_kl_reg_loss: 50850.1376; train_edge_recon_loss: 2657005.8435; train_gene_expr_recon_loss: 10301265.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25378.1469; train_chrom_access_recon_loss: 3787716.4599; train_global_loss: 16822216.2748; train_optim_loss: 16822216.2748; val_kl_reg_loss: 43874.7844; val_edge_recon_loss: 2665983.2333; val_gene_expr_recon_loss: 10459885.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25476.8223; val_chrom_access_recon_loss: 3773871.3833; val_global_loss: 16969091.9333; val_optim_loss: 16969091.9333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9800; val_auprc_score: 0.9726; val_best_acc_score: 0.9413; val_best_f1_score: 0.9423; train_kl_reg_loss: 49339.3664; train_edge_recon_loss: 2658395.9256; train_gene_expr_recon_loss: 10272012.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25492.0701; train_chrom_access_recon_loss: 3778017.2156; train_global_loss: 16783256.5725; train_optim_loss: 16783256.5725; val_kl_reg_loss: 43760.7161; val_edge_recon_loss: 2658405.6000; val_gene_expr_recon_loss: 10419581.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25533.9980; val_chrom_access_recon_loss: 3752435.1167; val_global_loss: 16899717.2667; val_optim_loss: 16899717.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9817; val_auprc_score: 0.9758; val_best_acc_score: 0.9391; val_best_f1_score: 0.9410; train_kl_reg_loss: 48646.8465; train_edge_recon_loss: 2654768.4866; train_gene_expr_recon_loss: 10255656.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25495.9222; train_chrom_access_recon_loss: 3774348.6985; train_global_loss: 16758916.6565; train_optim_loss: 16758916.6565; val_kl_reg_loss: 45269.8740; val_edge_recon_loss: 2648686.3833; val_gene_expr_recon_loss: 10433066.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25509.5020; val_chrom_access_recon_loss: 3775258.2000; val_global_loss: 16927790.8667; val_optim_loss: 16927790.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9817; val_auprc_score: 0.9759; val_best_acc_score: 0.9386; val_best_f1_score: 0.9398; train_kl_reg_loss: 48010.2088; train_edge_recon_loss: 2653660.7634; train_gene_expr_recon_loss: 10244894.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25548.7414; train_chrom_access_recon_loss: 3769399.4504; train_global_loss: 16741514.0916; train_optim_loss: 16741514.0916; val_kl_reg_loss: 45276.0781; val_edge_recon_loss: 2638310.7333; val_gene_expr_recon_loss: 10403566.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25517.7832; val_chrom_access_recon_loss: 3761111.1333; val_global_loss: 16873782.6667; val_optim_loss: 16873782.6667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9832; val_auprc_score: 0.9770; val_best_acc_score: 0.9427; val_best_f1_score: 0.9444; train_kl_reg_loss: 47096.2340; train_edge_recon_loss: 2656596.3263; train_gene_expr_recon_loss: 10234125.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25498.8727; train_chrom_access_recon_loss: 3765389.9599; train_global_loss: 16728706.8626; train_optim_loss: 16728706.8626; val_kl_reg_loss: 44014.9240; val_edge_recon_loss: 2669565.1833; val_gene_expr_recon_loss: 10390944.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25476.8301; val_chrom_access_recon_loss: 3753104.9833; val_global_loss: 16883106.8667; val_optim_loss: 16883106.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9817; val_auprc_score: 0.9776; val_best_acc_score: 0.9383; val_best_f1_score: 0.9400; train_kl_reg_loss: 46566.7800; train_edge_recon_loss: 2652661.3702; train_gene_expr_recon_loss: 10219473.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25471.9902; train_chrom_access_recon_loss: 3758942.3989; train_global_loss: 16703115.7786; train_optim_loss: 16703115.7786; val_kl_reg_loss: 43442.8771; val_edge_recon_loss: 2668430.9833; val_gene_expr_recon_loss: 10395688.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25373.4688; val_chrom_access_recon_loss: 3757972.6500; val_global_loss: 16890908.0667; val_optim_loss: 16890908.0667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9818; val_auprc_score: 0.9756; val_best_acc_score: 0.9388; val_best_f1_score: 0.9400; train_kl_reg_loss: 45497.4066; train_edge_recon_loss: 2649288.1508; train_gene_expr_recon_loss: 10202698.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25396.9330; train_chrom_access_recon_loss: 3753773.0286; train_global_loss: 16676654.0763; train_optim_loss: 16676654.0763; val_kl_reg_loss: 44801.6706; val_edge_recon_loss: 2651887.5833; val_gene_expr_recon_loss: 10390010.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25274.1211; val_chrom_access_recon_loss: 3763960.6833; val_global_loss: 16875934.6667; val_optim_loss: 16875934.6667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9827; val_auprc_score: 0.9782; val_best_acc_score: 0.9411; val_best_f1_score: 0.9429; train_kl_reg_loss: 45120.2284; train_edge_recon_loss: 2655709.0439; train_gene_expr_recon_loss: 10195807.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25255.2180; train_chrom_access_recon_loss: 3750761.7615; train_global_loss: 16672653.5496; train_optim_loss: 16672653.5496; val_kl_reg_loss: 43333.1315; val_edge_recon_loss: 2654194.8500; val_gene_expr_recon_loss: 10384394.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25319.7500; val_chrom_access_recon_loss: 3762057.4167; val_global_loss: 16869299.6667; val_optim_loss: 16869299.6667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9809; val_auprc_score: 0.9751; val_best_acc_score: 0.9378; val_best_f1_score: 0.9389; train_kl_reg_loss: 44565.4970; train_edge_recon_loss: 2654530.7634; train_gene_expr_recon_loss: 10179091.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25269.2452; train_chrom_access_recon_loss: 3745740.2099; train_global_loss: 16649196.9618; train_optim_loss: 16649196.9618; val_kl_reg_loss: 42946.6229; val_edge_recon_loss: 2661366.6333; val_gene_expr_recon_loss: 10369028.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25204.7168; val_chrom_access_recon_loss: 3745787.6667; val_global_loss: 16844334.6667; val_optim_loss: 16844334.6667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9837; val_auprc_score: 0.9797; val_best_acc_score: 0.9431; val_best_f1_score: 0.9444; train_kl_reg_loss: 44279.8457; train_edge_recon_loss: 2644667.9408; train_gene_expr_recon_loss: 10165636.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25148.7665; train_chrom_access_recon_loss: 3742240.3531; train_global_loss: 16621973.3130; train_optim_loss: 16621973.3130; val_kl_reg_loss: 42686.0544; val_edge_recon_loss: 2637243.8500; val_gene_expr_recon_loss: 10343551.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25197.1289; val_chrom_access_recon_loss: 3754097.5833; val_global_loss: 16802775.7333; val_optim_loss: 16802775.7333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9831; val_auprc_score: 0.9790; val_best_acc_score: 0.9434; val_best_f1_score: 0.9446; train_kl_reg_loss: 43968.4003; train_edge_recon_loss: 2645966.3531; train_gene_expr_recon_loss: 10154544.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25123.3546; train_chrom_access_recon_loss: 3737917.4637; train_global_loss: 16607520.2672; train_optim_loss: 16607520.2672; val_kl_reg_loss: 43315.2680; val_edge_recon_loss: 2638710.9333; val_gene_expr_recon_loss: 10320923.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25116.9160; val_chrom_access_recon_loss: 3738262.7333; val_global_loss: 16766329.4667; val_optim_loss: 16766329.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9859; val_auprc_score: 0.9801; val_best_acc_score: 0.9477; val_best_f1_score: 0.9491; train_kl_reg_loss: 43415.6049; train_edge_recon_loss: 2647437.6412; train_gene_expr_recon_loss: 10147946.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25096.0699; train_chrom_access_recon_loss: 3735587.6202; train_global_loss: 16599483.2748; train_optim_loss: 16599483.2748; val_kl_reg_loss: 42087.6271; val_edge_recon_loss: 2640176.4167; val_gene_expr_recon_loss: 10333578.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25046.1680; val_chrom_access_recon_loss: 3744819.2500; val_global_loss: 16785707.5333; val_optim_loss: 16785707.5333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9850; val_auprc_score: 0.9818; val_best_acc_score: 0.9457; val_best_f1_score: 0.9472; train_kl_reg_loss: 43878.4833; train_edge_recon_loss: 2641253.1393; train_gene_expr_recon_loss: 10136221.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25025.2749; train_chrom_access_recon_loss: 3731773.8130; train_global_loss: 16578152.4122; train_optim_loss: 16578152.4122; val_kl_reg_loss: 41537.0255; val_edge_recon_loss: 2652777.0833; val_gene_expr_recon_loss: 10369738.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25003.2246; val_chrom_access_recon_loss: 3745328.4000; val_global_loss: 16834384.4667; val_optim_loss: 16834384.4667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9851; val_auprc_score: 0.9817; val_best_acc_score: 0.9468; val_best_f1_score: 0.9482; train_kl_reg_loss: 43215.7212; train_edge_recon_loss: 2639296.5057; train_gene_expr_recon_loss: 10126992.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25000.0625; train_chrom_access_recon_loss: 3725412.0649; train_global_loss: 16559917.1374; train_optim_loss: 16559917.1374; val_kl_reg_loss: 41058.3716; val_edge_recon_loss: 2652379.3333; val_gene_expr_recon_loss: 10372640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25053.8281; val_chrom_access_recon_loss: 3754075.1833; val_global_loss: 16845206.9333; val_optim_loss: 16845206.9333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9840; val_auprc_score: 0.9729; val_best_acc_score: 0.9476; val_best_f1_score: 0.9488; train_kl_reg_loss: 42821.6332; train_edge_recon_loss: 2642196.8435; train_gene_expr_recon_loss: 10111413.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24959.7520; train_chrom_access_recon_loss: 3724049.7252; train_global_loss: 16545441.4351; train_optim_loss: 16545441.4351; val_kl_reg_loss: 41807.0904; val_edge_recon_loss: 2651088.3667; val_gene_expr_recon_loss: 10341460.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24991.9160; val_chrom_access_recon_loss: 3739206.5167; val_global_loss: 16798554.3333; val_optim_loss: 16798554.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9857; val_auprc_score: 0.9760; val_best_acc_score: 0.9508; val_best_f1_score: 0.9521; train_kl_reg_loss: 43496.2356; train_edge_recon_loss: 2638042.4561; train_gene_expr_recon_loss: 10092577.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22994.2879; train_chrom_access_recon_loss: 3716303.2595; train_global_loss: 16513413.8626; train_optim_loss: 16513413.8626; val_kl_reg_loss: 42567.8326; val_edge_recon_loss: 2622075.5833; val_gene_expr_recon_loss: 10326833.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22634.1055; val_chrom_access_recon_loss: 3730291.5667; val_global_loss: 16744402.0000; val_optim_loss: 16744402.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9878; val_auprc_score: 0.9852; val_best_acc_score: 0.9492; val_best_f1_score: 0.9505; train_kl_reg_loss: 44126.9946; train_edge_recon_loss: 2638750.7137; train_gene_expr_recon_loss: 10088992.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22525.8320; train_chrom_access_recon_loss: 3714556.5840; train_global_loss: 16508952.9695; train_optim_loss: 16508952.9695; val_kl_reg_loss: 42830.2112; val_edge_recon_loss: 2646440.1667; val_gene_expr_recon_loss: 10307540.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22424.9043; val_chrom_access_recon_loss: 3752578.9167; val_global_loss: 16771814.8000; val_optim_loss: 16771814.8000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9881; val_auprc_score: 0.9860; val_best_acc_score: 0.9511; val_best_f1_score: 0.9517; train_kl_reg_loss: 43853.2530; train_edge_recon_loss: 2637258.9027; train_gene_expr_recon_loss: 10078293.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22363.9944; train_chrom_access_recon_loss: 3712590.5057; train_global_loss: 16494360.4733; train_optim_loss: 16494360.4733; val_kl_reg_loss: 42758.2451; val_edge_recon_loss: 2649455.1667; val_gene_expr_recon_loss: 10335623.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22286.9688; val_chrom_access_recon_loss: 3728602.0000; val_global_loss: 16778726.2667; val_optim_loss: 16778726.2667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9852; val_auprc_score: 0.9819; val_best_acc_score: 0.9477; val_best_f1_score: 0.9486; train_kl_reg_loss: 44225.5245; train_edge_recon_loss: 2630110.8912; train_gene_expr_recon_loss: 10087754.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22234.5147; train_chrom_access_recon_loss: 3715337.8550; train_global_loss: 16499663.7176; train_optim_loss: 16499663.7176; val_kl_reg_loss: 42791.1406; val_edge_recon_loss: 2638674.8167; val_gene_expr_recon_loss: 10341541.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22192.3613; val_chrom_access_recon_loss: 3752537.4500; val_global_loss: 16797736.4667; val_optim_loss: 16797736.4667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9867; val_auprc_score: 0.9821; val_best_acc_score: 0.9510; val_best_f1_score: 0.9520; train_kl_reg_loss: 44151.2539; train_edge_recon_loss: 2633457.7443; train_gene_expr_recon_loss: 10083434.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22155.2798; train_chrom_access_recon_loss: 3713225.8836; train_global_loss: 16496424.6183; train_optim_loss: 16496424.6183; val_kl_reg_loss: 43169.3065; val_edge_recon_loss: 2637397.5667; val_gene_expr_recon_loss: 10332853.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22101.3574; val_chrom_access_recon_loss: 3734874.9333; val_global_loss: 16770395.9333; val_optim_loss: 16770395.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9850; val_auprc_score: 0.9796; val_best_acc_score: 0.9470; val_best_f1_score: 0.9481; train_kl_reg_loss: 44225.2787; train_edge_recon_loss: 2636386.5553; train_gene_expr_recon_loss: 10077447.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21902.8149; train_chrom_access_recon_loss: 3710773.0706; train_global_loss: 16490735.4580; train_optim_loss: 16490735.4580; val_kl_reg_loss: 42995.5310; val_edge_recon_loss: 2666746.9167; val_gene_expr_recon_loss: 10356569.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21872.0840; val_chrom_access_recon_loss: 3741123.0167; val_global_loss: 16829306.8667; val_optim_loss: 16829306.8667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9861; val_auprc_score: 0.9828; val_best_acc_score: 0.9466; val_best_f1_score: 0.9481; train_kl_reg_loss: 44368.3104; train_edge_recon_loss: 2638252.9351; train_gene_expr_recon_loss: 10077067.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21861.2635; train_chrom_access_recon_loss: 3709383.7023; train_global_loss: 16490933.4656; train_optim_loss: 16490933.4656; val_kl_reg_loss: 43060.1065; val_edge_recon_loss: 2648941.7500; val_gene_expr_recon_loss: 10326167.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21850.6152; val_chrom_access_recon_loss: 3736228.9333; val_global_loss: 16776249.6000; val_optim_loss: 16776249.6000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9881; val_auprc_score: 0.9842; val_best_acc_score: 0.9499; val_best_f1_score: 0.9506; train_kl_reg_loss: 44314.3826; train_edge_recon_loss: 2629828.1450; train_gene_expr_recon_loss: 10077004.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21842.4677; train_chrom_access_recon_loss: 3711332.1966; train_global_loss: 16484322.1069; train_optim_loss: 16484322.1069; val_kl_reg_loss: 43137.5490; val_edge_recon_loss: 2637720.8833; val_gene_expr_recon_loss: 10307172.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21833.9570; val_chrom_access_recon_loss: 3728225.5000; val_global_loss: 16738090.0667; val_optim_loss: 16738090.0667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9854; val_auprc_score: 0.9800; val_best_acc_score: 0.9492; val_best_f1_score: 0.9498; train_kl_reg_loss: 44409.3560; train_edge_recon_loss: 2636114.0592; train_gene_expr_recon_loss: 10080678.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21827.9429; train_chrom_access_recon_loss: 3712655.1050; train_global_loss: 16495685.4046; train_optim_loss: 16495685.4046; val_kl_reg_loss: 43251.7406; val_edge_recon_loss: 2638908.2833; val_gene_expr_recon_loss: 10338079.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21819.8711; val_chrom_access_recon_loss: 3736411.3500; val_global_loss: 16778471.2000; val_optim_loss: 16778471.2000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9856; val_auprc_score: 0.9812; val_best_acc_score: 0.9484; val_best_f1_score: 0.9492; train_kl_reg_loss: 44373.3416; train_edge_recon_loss: 2635891.9885; train_gene_expr_recon_loss: 10076787.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21812.5111; train_chrom_access_recon_loss: 3707515.4294; train_global_loss: 16486380.7405; train_optim_loss: 16486380.7405; val_kl_reg_loss: 43170.7081; val_edge_recon_loss: 2645012.6000; val_gene_expr_recon_loss: 10327689.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21806.0605; val_chrom_access_recon_loss: 3734750.7833; val_global_loss: 16772428.8667; val_optim_loss: 16772428.8667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9886; val_auprc_score: 0.9866; val_best_acc_score: 0.9541; val_best_f1_score: 0.9547; train_kl_reg_loss: 44291.5885; train_edge_recon_loss: 2634874.8626; train_gene_expr_recon_loss: 10069911.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21799.9443; train_chrom_access_recon_loss: 3705440.8607; train_global_loss: 16476318.8168; train_optim_loss: 16476318.8168; val_kl_reg_loss: 43116.6388; val_edge_recon_loss: 2647630.6667; val_gene_expr_recon_loss: 10289181.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21793.9629; val_chrom_access_recon_loss: 3729648.7167; val_global_loss: 16731371.7333; val_optim_loss: 16731371.7333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9852; val_auprc_score: 0.9790; val_best_acc_score: 0.9464; val_best_f1_score: 0.9476; train_kl_reg_loss: 44346.0592; train_edge_recon_loss: 2632340.4676; train_gene_expr_recon_loss: 10077050.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21789.6735; train_chrom_access_recon_loss: 3710839.7653; train_global_loss: 16486366.9389; train_optim_loss: 16486366.9389; val_kl_reg_loss: 43228.7229; val_edge_recon_loss: 2659831.3500; val_gene_expr_recon_loss: 10331585.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21782.4941; val_chrom_access_recon_loss: 3737153.7833; val_global_loss: 16793581.4000; val_optim_loss: 16793581.4000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9870; val_auprc_score: 0.9834; val_best_acc_score: 0.9497; val_best_f1_score: 0.9507; train_kl_reg_loss: 44209.3211; train_edge_recon_loss: 2635734.0076; train_gene_expr_recon_loss: 10074464.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21777.0519; train_chrom_access_recon_loss: 3710173.9237; train_global_loss: 16486358.6794; train_optim_loss: 16486358.6794; val_kl_reg_loss: 43099.5508; val_edge_recon_loss: 2633696.7500; val_gene_expr_recon_loss: 10363429.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21771.2832; val_chrom_access_recon_loss: 3768935.5833; val_global_loss: 16830932.0000; val_optim_loss: 16830932.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9887; val_auprc_score: 0.9857; val_best_acc_score: 0.9565; val_best_f1_score: 0.9570; train_kl_reg_loss: 44239.0609; train_edge_recon_loss: 2633676.6450; train_gene_expr_recon_loss: 10075210.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21766.8963; train_chrom_access_recon_loss: 3709621.9275; train_global_loss: 16484514.8473; train_optim_loss: 16484514.8473; val_kl_reg_loss: 43144.2638; val_edge_recon_loss: 2609009.6500; val_gene_expr_recon_loss: 10319618.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21761.3262; val_chrom_access_recon_loss: 3741413.6667; val_global_loss: 16734947.2000; val_optim_loss: 16734947.2000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9873; val_auprc_score: 0.9841; val_best_acc_score: 0.9530; val_best_f1_score: 0.9537; train_kl_reg_loss: 44292.7925; train_edge_recon_loss: 2638892.8550; train_gene_expr_recon_loss: 10074936.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21757.7315; train_chrom_access_recon_loss: 3708721.8435; train_global_loss: 16488601.4427; train_optim_loss: 16488601.4427; val_kl_reg_loss: 43063.1891; val_edge_recon_loss: 2649702.2500; val_gene_expr_recon_loss: 10361825.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21751.7852; val_chrom_access_recon_loss: 3760349.5500; val_global_loss: 16836692.0000; val_optim_loss: 16836692.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9865; val_auprc_score: 0.9840; val_best_acc_score: 0.9485; val_best_f1_score: 0.9494; train_kl_reg_loss: 44261.2612; train_edge_recon_loss: 2630271.1565; train_gene_expr_recon_loss: 10077935.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21730.8991; train_chrom_access_recon_loss: 3712102.2347; train_global_loss: 16486301.3435; train_optim_loss: 16486301.3435; val_kl_reg_loss: 43161.4419; val_edge_recon_loss: 2656131.7667; val_gene_expr_recon_loss: 10326890.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21727.7617; val_chrom_access_recon_loss: 3729007.0333; val_global_loss: 16776918.4000; val_optim_loss: 16776918.4000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9875; val_auprc_score: 0.9852; val_best_acc_score: 0.9493; val_best_f1_score: 0.9502; train_kl_reg_loss: 44263.7720; train_edge_recon_loss: 2634739.7042; train_gene_expr_recon_loss: 10072374.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21726.7424; train_chrom_access_recon_loss: 3708058.8416; train_global_loss: 16481163.6794; train_optim_loss: 16481163.6794; val_kl_reg_loss: 43173.9349; val_edge_recon_loss: 2663033.2667; val_gene_expr_recon_loss: 10305815.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21725.7910; val_chrom_access_recon_loss: 3725341.7667; val_global_loss: 16759090.4667; val_optim_loss: 16759090.4667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9875; val_auprc_score: 0.9841; val_best_acc_score: 0.9501; val_best_f1_score: 0.9510; train_kl_reg_loss: 44209.1381; train_edge_recon_loss: 2642032.6718; train_gene_expr_recon_loss: 10081171.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21724.9347; train_chrom_access_recon_loss: 3713550.2939; train_global_loss: 16502688.9771; train_optim_loss: 16502688.9771; val_kl_reg_loss: 43079.6612; val_edge_recon_loss: 2634636.4167; val_gene_expr_recon_loss: 10332716.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21724.0742; val_chrom_access_recon_loss: 3739381.7500; val_global_loss: 16771538.0667; val_optim_loss: 16771538.0667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9858; val_auprc_score: 0.9827; val_best_acc_score: 0.9475; val_best_f1_score: 0.9484; train_kl_reg_loss: 44245.1888; train_edge_recon_loss: 2633623.2099; train_gene_expr_recon_loss: 10073887.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21723.3437; train_chrom_access_recon_loss: 3709649.6641; train_global_loss: 16483128.8397; train_optim_loss: 16483128.8397; val_kl_reg_loss: 42907.9266; val_edge_recon_loss: 2666591.3333; val_gene_expr_recon_loss: 10305749.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21722.6484; val_chrom_access_recon_loss: 3727929.6833; val_global_loss: 16764901.6000; val_optim_loss: 16764901.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 88 min 40 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9865
val AUPRC score: 0.9823
val best accuracy score: 0.9477
val best F1 score: 0.9482
val target rna MSE score: 1.1710
val source rna MSE score: 0.2438
val target atac MSE score: 0.4810
val source atac MSE score: 0.0754
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
