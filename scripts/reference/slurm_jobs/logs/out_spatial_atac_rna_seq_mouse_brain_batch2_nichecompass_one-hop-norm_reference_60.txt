[True]
Run timestamp: 07092023_171832_60.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_60']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2398 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5114, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6799; val_auprc_score: 0.6651; val_best_acc_score: 0.5046; val_best_f1_score: 0.6686; train_kl_reg_loss: 76427.9093; train_edge_recon_loss: 3554378.8712; train_gene_expr_recon_loss: 20598915.6970; train_masked_gp_l1_reg_loss: 144053.1148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5969733.7462; train_chrom_access_recon_loss: 2066810.6307; train_global_loss: 32410320.1212; train_optim_loss: 32410320.1212; val_kl_reg_loss: 102197.0654; val_edge_recon_loss: 4065409.5312; val_gene_expr_recon_loss: 18962288.5000; val_masked_gp_l1_reg_loss: 125071.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2521836.0000; val_chrom_access_recon_loss: 1943333.2812; val_global_loss: 27720136.0000; val_optim_loss: 27720136.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6864; val_auprc_score: 0.6691; val_best_acc_score: 0.5296; val_best_f1_score: 0.6768; train_kl_reg_loss: 131279.5359; train_edge_recon_loss: 3545193.6023; train_gene_expr_recon_loss: 18817996.2727; train_masked_gp_l1_reg_loss: 116457.1639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1077175.0658; train_chrom_access_recon_loss: 1965813.9640; train_global_loss: 25653915.6364; train_optim_loss: 25653915.6364; val_kl_reg_loss: 118287.6309; val_edge_recon_loss: 4063487.4375; val_gene_expr_recon_loss: 18417304.5000; val_masked_gp_l1_reg_loss: 112015.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 401183.4062; val_chrom_access_recon_loss: 1901780.7188; val_global_loss: 25014060.0000; val_optim_loss: 25014060.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7533; val_auprc_score: 0.7424; val_best_acc_score: 0.6483; val_best_f1_score: 0.7200; train_kl_reg_loss: 121716.3945; train_edge_recon_loss: 3535256.2576; train_gene_expr_recon_loss: 18587515.3636; train_masked_gp_l1_reg_loss: 112547.1133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 275085.0080; train_chrom_access_recon_loss: 1945109.8580; train_global_loss: 24577230.0000; train_optim_loss: 24577230.0000; val_kl_reg_loss: 121308.5420; val_edge_recon_loss: 4054702.9688; val_gene_expr_recon_loss: 18342278.7500; val_masked_gp_l1_reg_loss: 113776.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199297.9844; val_chrom_access_recon_loss: 1908509.8594; val_global_loss: 24739873.7500; val_optim_loss: 24739873.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8188; val_auprc_score: 0.8016; val_best_acc_score: 0.7268; val_best_f1_score: 0.7240; train_kl_reg_loss: 109046.5173; train_edge_recon_loss: 3522365.9773; train_gene_expr_recon_loss: 18432874.2424; train_masked_gp_l1_reg_loss: 115668.8866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169063.3255; train_chrom_access_recon_loss: 1931286.4773; train_global_loss: 24280305.2121; train_optim_loss: 24280305.2121; val_kl_reg_loss: 116082.0088; val_edge_recon_loss: 3996039.0938; val_gene_expr_recon_loss: 18250973.0000; val_masked_gp_l1_reg_loss: 117771.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145581.0781; val_chrom_access_recon_loss: 1895642.6562; val_global_loss: 24522091.0000; val_optim_loss: 24522091.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8691; val_auprc_score: 0.8547; val_best_acc_score: 0.7869; val_best_f1_score: 0.7997; train_kl_reg_loss: 93481.3229; train_edge_recon_loss: 3471474.3030; train_gene_expr_recon_loss: 18302291.9091; train_masked_gp_l1_reg_loss: 121541.3552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133279.4194; train_chrom_access_recon_loss: 1919796.5587; train_global_loss: 24041865.0303; train_optim_loss: 24041865.0303; val_kl_reg_loss: 78812.0605; val_edge_recon_loss: 3562721.1250; val_gene_expr_recon_loss: 18144200.7500; val_masked_gp_l1_reg_loss: 125973.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123713.2422; val_chrom_access_recon_loss: 1869215.4688; val_global_loss: 23904637.7500; val_optim_loss: 23904637.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8699; val_auprc_score: 0.8375; val_best_acc_score: 0.7953; val_best_f1_score: 0.8122; train_kl_reg_loss: 97614.7756; train_edge_recon_loss: 3180966.5530; train_gene_expr_recon_loss: 18242936.2727; train_masked_gp_l1_reg_loss: 130235.5624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118168.3685; train_chrom_access_recon_loss: 1912077.5341; train_global_loss: 23681999.0606; train_optim_loss: 23681999.0606; val_kl_reg_loss: 102867.3193; val_edge_recon_loss: 3097532.0312; val_gene_expr_recon_loss: 17962952.5000; val_masked_gp_l1_reg_loss: 135390.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114378.9531; val_chrom_access_recon_loss: 1863815.2500; val_global_loss: 23276935.2500; val_optim_loss: 23276935.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8762; val_auprc_score: 0.8416; val_best_acc_score: 0.8076; val_best_f1_score: 0.8195; train_kl_reg_loss: 122797.2363; train_edge_recon_loss: 2988974.5795; train_gene_expr_recon_loss: 18163611.4545; train_masked_gp_l1_reg_loss: 135133.7192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109385.7504; train_chrom_access_recon_loss: 1902955.2273; train_global_loss: 23422858.1212; train_optim_loss: 23422858.1212; val_kl_reg_loss: 134391.7959; val_edge_recon_loss: 2969564.5938; val_gene_expr_recon_loss: 17970521.7500; val_masked_gp_l1_reg_loss: 135556.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105354.8125; val_chrom_access_recon_loss: 1869065.2031; val_global_loss: 23184453.2500; val_optim_loss: 23184453.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8898; val_auprc_score: 0.8559; val_best_acc_score: 0.8186; val_best_f1_score: 0.8326; train_kl_reg_loss: 130638.8728; train_edge_recon_loss: 2906113.2992; train_gene_expr_recon_loss: 18020152.9697; train_masked_gp_l1_reg_loss: 137147.2188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104203.5189; train_chrom_access_recon_loss: 1892380.9962; train_global_loss: 23190637.0000; train_optim_loss: 23190637.0000; val_kl_reg_loss: 122261.8057; val_edge_recon_loss: 2895031.7812; val_gene_expr_recon_loss: 17921501.2500; val_masked_gp_l1_reg_loss: 139156.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104789.6328; val_chrom_access_recon_loss: 1844127.0469; val_global_loss: 23026868.0000; val_optim_loss: 23026868.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8959; val_auprc_score: 0.8677; val_best_acc_score: 0.8278; val_best_f1_score: 0.8421; train_kl_reg_loss: 129680.4471; train_edge_recon_loss: 2879674.9053; train_gene_expr_recon_loss: 17933303.8788; train_masked_gp_l1_reg_loss: 141052.6103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104942.2642; train_chrom_access_recon_loss: 1884128.9640; train_global_loss: 23072783.0303; train_optim_loss: 23072783.0303; val_kl_reg_loss: 126813.0977; val_edge_recon_loss: 2930163.7812; val_gene_expr_recon_loss: 17699895.5000; val_masked_gp_l1_reg_loss: 143308.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105892.8672; val_chrom_access_recon_loss: 1865829.6562; val_global_loss: 22871901.7500; val_optim_loss: 22871901.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9039; val_auprc_score: 0.8659; val_best_acc_score: 0.8423; val_best_f1_score: 0.8540; train_kl_reg_loss: 130490.0278; train_edge_recon_loss: 2857229.8068; train_gene_expr_recon_loss: 17853688.7879; train_masked_gp_l1_reg_loss: 144584.2512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105630.0575; train_chrom_access_recon_loss: 1875933.7822; train_global_loss: 22967556.6667; train_optim_loss: 22967556.6667; val_kl_reg_loss: 126309.8291; val_edge_recon_loss: 2856988.0000; val_gene_expr_recon_loss: 17664261.7500; val_masked_gp_l1_reg_loss: 145717.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105159.9844; val_chrom_access_recon_loss: 1838055.1719; val_global_loss: 22736493.0000; val_optim_loss: 22736493.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9084; val_auprc_score: 0.8841; val_best_acc_score: 0.8447; val_best_f1_score: 0.8573; train_kl_reg_loss: 127784.5786; train_edge_recon_loss: 2850886.5038; train_gene_expr_recon_loss: 17775775.8182; train_masked_gp_l1_reg_loss: 147016.5919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104438.6686; train_chrom_access_recon_loss: 1869413.2216; train_global_loss: 22875315.1515; train_optim_loss: 22875315.1515; val_kl_reg_loss: 128135.8037; val_edge_recon_loss: 2862570.4688; val_gene_expr_recon_loss: 17753430.7500; val_masked_gp_l1_reg_loss: 148525.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104056.7500; val_chrom_access_recon_loss: 1841190.4844; val_global_loss: 22837909.5000; val_optim_loss: 22837909.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9118; val_auprc_score: 0.8782; val_best_acc_score: 0.8528; val_best_f1_score: 0.8612; train_kl_reg_loss: 126378.8067; train_edge_recon_loss: 2825342.2235; train_gene_expr_recon_loss: 17706940.1061; train_masked_gp_l1_reg_loss: 149499.0071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102847.7888; train_chrom_access_recon_loss: 1862261.2254; train_global_loss: 22773269.3636; train_optim_loss: 22773269.3636; val_kl_reg_loss: 128537.1982; val_edge_recon_loss: 2868170.6250; val_gene_expr_recon_loss: 17535155.7500; val_masked_gp_l1_reg_loss: 150549.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101997.2969; val_chrom_access_recon_loss: 1822363.3594; val_global_loss: 22606774.5000; val_optim_loss: 22606774.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9180; val_auprc_score: 0.8902; val_best_acc_score: 0.8581; val_best_f1_score: 0.8689; train_kl_reg_loss: 124621.2025; train_edge_recon_loss: 2821899.7045; train_gene_expr_recon_loss: 17633763.8182; train_masked_gp_l1_reg_loss: 151601.3700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101086.3059; train_chrom_access_recon_loss: 1853852.8333; train_global_loss: 22686825.0606; train_optim_loss: 22686825.0606; val_kl_reg_loss: 124738.0967; val_edge_recon_loss: 2808852.7812; val_gene_expr_recon_loss: 17293267.3750; val_masked_gp_l1_reg_loss: 152567.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100707.1328; val_chrom_access_recon_loss: 1805019.8594; val_global_loss: 22285153.7500; val_optim_loss: 22285153.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9213; val_auprc_score: 0.8964; val_best_acc_score: 0.8632; val_best_f1_score: 0.8727; train_kl_reg_loss: 123583.6731; train_edge_recon_loss: 2825903.7614; train_gene_expr_recon_loss: 17570858.4091; train_masked_gp_l1_reg_loss: 153355.5833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99724.7647; train_chrom_access_recon_loss: 1849032.0341; train_global_loss: 22622458.1818; train_optim_loss: 22622458.1818; val_kl_reg_loss: 121496.7314; val_edge_recon_loss: 2826539.0938; val_gene_expr_recon_loss: 17481816.0000; val_masked_gp_l1_reg_loss: 154261.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98645.6641; val_chrom_access_recon_loss: 1818824.8438; val_global_loss: 22501584.2500; val_optim_loss: 22501584.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9237; val_auprc_score: 0.8990; val_best_acc_score: 0.8635; val_best_f1_score: 0.8713; train_kl_reg_loss: 121433.0569; train_edge_recon_loss: 2794078.4053; train_gene_expr_recon_loss: 17536040.2121; train_masked_gp_l1_reg_loss: 154933.9631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98489.2241; train_chrom_access_recon_loss: 1843591.7538; train_global_loss: 22548566.6061; train_optim_loss: 22548566.6061; val_kl_reg_loss: 118600.1758; val_edge_recon_loss: 2801551.2500; val_gene_expr_recon_loss: 17339077.7500; val_masked_gp_l1_reg_loss: 156080.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98101.3984; val_chrom_access_recon_loss: 1818768.7031; val_global_loss: 22332180.0000; val_optim_loss: 22332180.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9207; val_auprc_score: 0.8902; val_best_acc_score: 0.8595; val_best_f1_score: 0.8686; train_kl_reg_loss: 119844.7442; train_edge_recon_loss: 2804289.4432; train_gene_expr_recon_loss: 17475598.8788; train_masked_gp_l1_reg_loss: 156813.1795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97675.9595; train_chrom_access_recon_loss: 1837148.5208; train_global_loss: 22491370.5152; train_optim_loss: 22491370.5152; val_kl_reg_loss: 119638.5420; val_edge_recon_loss: 2832049.6562; val_gene_expr_recon_loss: 17295995.5000; val_masked_gp_l1_reg_loss: 157784.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97130.3750; val_chrom_access_recon_loss: 1802996.3906; val_global_loss: 22305594.5000; val_optim_loss: 22305594.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9224; val_auprc_score: 0.8960; val_best_acc_score: 0.8619; val_best_f1_score: 0.8694; train_kl_reg_loss: 120190.5694; train_edge_recon_loss: 2787175.1174; train_gene_expr_recon_loss: 17423887.0152; train_masked_gp_l1_reg_loss: 158331.6193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96723.0497; train_chrom_access_recon_loss: 1831810.3144; train_global_loss: 22418117.7576; train_optim_loss: 22418117.7576; val_kl_reg_loss: 120458.6738; val_edge_recon_loss: 2818490.9062; val_gene_expr_recon_loss: 17323757.8750; val_masked_gp_l1_reg_loss: 158864.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96050.9453; val_chrom_access_recon_loss: 1797230.5156; val_global_loss: 22314851.7500; val_optim_loss: 22314851.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9240; val_auprc_score: 0.9010; val_best_acc_score: 0.8568; val_best_f1_score: 0.8694; train_kl_reg_loss: 120649.6474; train_edge_recon_loss: 2780757.5947; train_gene_expr_recon_loss: 17380253.5758; train_masked_gp_l1_reg_loss: 155613.5743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73602.5651; train_chrom_access_recon_loss: 1827006.0360; train_global_loss: 22337882.9697; train_optim_loss: 22337882.9697; val_kl_reg_loss: 120557.9355; val_edge_recon_loss: 2821618.6562; val_gene_expr_recon_loss: 17404970.5000; val_masked_gp_l1_reg_loss: 154212.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68809.5625; val_chrom_access_recon_loss: 1804401.5781; val_global_loss: 22374570.5000; val_optim_loss: 22374570.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9285; val_auprc_score: 0.9134; val_best_acc_score: 0.8606; val_best_f1_score: 0.8705; train_kl_reg_loss: 121197.8795; train_edge_recon_loss: 2779805.4053; train_gene_expr_recon_loss: 17375932.8939; train_masked_gp_l1_reg_loss: 153943.5914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68439.0386; train_chrom_access_recon_loss: 1824452.4545; train_global_loss: 22323771.1818; train_optim_loss: 22323771.1818; val_kl_reg_loss: 120584.1074; val_edge_recon_loss: 2792339.3125; val_gene_expr_recon_loss: 17153783.6250; val_masked_gp_l1_reg_loss: 153805.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68181.7031; val_chrom_access_recon_loss: 1796916.9531; val_global_loss: 22085612.0000; val_optim_loss: 22085612.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9224; val_auprc_score: 0.8939; val_best_acc_score: 0.8584; val_best_f1_score: 0.8681; train_kl_reg_loss: 121191.6906; train_edge_recon_loss: 2782106.5530; train_gene_expr_recon_loss: 17373809.7121; train_masked_gp_l1_reg_loss: 153770.9574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68068.3575; train_chrom_access_recon_loss: 1824815.5928; train_global_loss: 22323763.0000; train_optim_loss: 22323763.0000; val_kl_reg_loss: 120189.2930; val_edge_recon_loss: 2820908.1875; val_gene_expr_recon_loss: 17199391.2500; val_masked_gp_l1_reg_loss: 153770.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67876.9844; val_chrom_access_recon_loss: 1779927.0938; val_global_loss: 22142062.2500; val_optim_loss: 22142062.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9179; val_auprc_score: 0.8868; val_best_acc_score: 0.8589; val_best_f1_score: 0.8684; train_kl_reg_loss: 120227.7076; train_edge_recon_loss: 2769239.6250; train_gene_expr_recon_loss: 17372985.8788; train_masked_gp_l1_reg_loss: 153814.6072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67780.8761; train_chrom_access_recon_loss: 1825050.7746; train_global_loss: 22309099.6061; train_optim_loss: 22309099.6061; val_kl_reg_loss: 119998.3486; val_edge_recon_loss: 2834451.4062; val_gene_expr_recon_loss: 17215445.7500; val_masked_gp_l1_reg_loss: 153907.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67724.3984; val_chrom_access_recon_loss: 1797712.0938; val_global_loss: 22189239.5000; val_optim_loss: 22189239.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9167; val_auprc_score: 0.8868; val_best_acc_score: 0.8557; val_best_f1_score: 0.8643; train_kl_reg_loss: 121065.6538; train_edge_recon_loss: 2786487.0341; train_gene_expr_recon_loss: 17363173.3485; train_masked_gp_l1_reg_loss: 153915.1233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67607.7353; train_chrom_access_recon_loss: 1824700.2500; train_global_loss: 22316949.0303; train_optim_loss: 22316949.0303; val_kl_reg_loss: 121524.9355; val_edge_recon_loss: 2854304.4688; val_gene_expr_recon_loss: 17271355.0000; val_masked_gp_l1_reg_loss: 153973.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67490.5078; val_chrom_access_recon_loss: 1788038.7812; val_global_loss: 22256687.0000; val_optim_loss: 22256687.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9317; val_auprc_score: 0.9120; val_best_acc_score: 0.8684; val_best_f1_score: 0.8762; train_kl_reg_loss: 121100.4859; train_edge_recon_loss: 2770277.1553; train_gene_expr_recon_loss: 17362867.8788; train_masked_gp_l1_reg_loss: 154035.9794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67352.0478; train_chrom_access_recon_loss: 1822679.2481; train_global_loss: 22298312.6667; train_optim_loss: 22298312.6667; val_kl_reg_loss: 122190.6904; val_edge_recon_loss: 2784273.3438; val_gene_expr_recon_loss: 17203331.0000; val_masked_gp_l1_reg_loss: 154068.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67241.4531; val_chrom_access_recon_loss: 1801059.8906; val_global_loss: 22132165.2500; val_optim_loss: 22132165.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9259; val_auprc_score: 0.9010; val_best_acc_score: 0.8632; val_best_f1_score: 0.8736; train_kl_reg_loss: 121741.7532; train_edge_recon_loss: 2764507.1629; train_gene_expr_recon_loss: 17353001.1970; train_masked_gp_l1_reg_loss: 153698.2630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65071.1842; train_chrom_access_recon_loss: 1822037.5549; train_global_loss: 22280057.2121; train_optim_loss: 22280057.2121; val_kl_reg_loss: 120944.6895; val_edge_recon_loss: 2799923.5625; val_gene_expr_recon_loss: 17196644.1250; val_masked_gp_l1_reg_loss: 153480.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64614.0508; val_chrom_access_recon_loss: 1788403.8906; val_global_loss: 22124010.7500; val_optim_loss: 22124010.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9196; val_auprc_score: 0.8828; val_best_acc_score: 0.8654; val_best_f1_score: 0.8746; train_kl_reg_loss: 121640.5560; train_edge_recon_loss: 2777590.4053; train_gene_expr_recon_loss: 17371018.8182; train_masked_gp_l1_reg_loss: 153424.3679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64570.3511; train_chrom_access_recon_loss: 1824648.4697; train_global_loss: 22312893.2121; train_optim_loss: 22312893.2121; val_kl_reg_loss: 121645.9160; val_edge_recon_loss: 2793176.0625; val_gene_expr_recon_loss: 17244747.0000; val_masked_gp_l1_reg_loss: 153393.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64530.7617; val_chrom_access_recon_loss: 1796821.3906; val_global_loss: 22174314.0000; val_optim_loss: 22174314.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9254; val_auprc_score: 0.8959; val_best_acc_score: 0.8684; val_best_f1_score: 0.8768; train_kl_reg_loss: 124004.8441; train_edge_recon_loss: 2865875.7727; train_gene_expr_recon_loss: 17253703.7121; train_masked_gp_l1_reg_loss: 153299.2121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64391.4107; train_chrom_access_recon_loss: 2014905.1269; train_global_loss: 22476180.0606; train_optim_loss: 22476180.0606; val_kl_reg_loss: 67571.1846; val_edge_recon_loss: 2892048.5625; val_gene_expr_recon_loss: 17035499.0000; val_masked_gp_l1_reg_loss: 153227.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64239.9375; val_chrom_access_recon_loss: 1960132.0938; val_global_loss: 22172719.0000; val_optim_loss: 22172719.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9368; val_auprc_score: 0.9113; val_best_acc_score: 0.8791; val_best_f1_score: 0.8842; train_kl_reg_loss: 127059.6481; train_edge_recon_loss: 2870565.7424; train_gene_expr_recon_loss: 17192638.7424; train_masked_gp_l1_reg_loss: 153194.5438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64065.6185; train_chrom_access_recon_loss: 1989501.5852; train_global_loss: 22397025.9697; train_optim_loss: 22397025.9697; val_kl_reg_loss: 69007.4619; val_edge_recon_loss: 2851518.4062; val_gene_expr_recon_loss: 17071046.2500; val_masked_gp_l1_reg_loss: 153167.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63875.9219; val_chrom_access_recon_loss: 1961042.8906; val_global_loss: 22169659.0000; val_optim_loss: 22169659.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 26 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.9293
val AUPRC score: 0.9069
val best accuracy score: 0.8673
val best F1 score: 0.8761
val target rna MSE score: 6.0540
val source rna MSE score: 4.7258
val target atac MSE score: 0.3724
val source atac MSE score: 0.1513
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
