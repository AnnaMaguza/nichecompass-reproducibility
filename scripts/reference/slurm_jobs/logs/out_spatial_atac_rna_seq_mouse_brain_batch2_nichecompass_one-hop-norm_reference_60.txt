[True]
Run timestamp: 07082023_190834_60.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_60']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8898; val_auprc_score: 0.9062; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 27796.4965; train_edge_recon_loss: 352228.2396; train_gene_expr_recon_loss: 1217263.5833; train_masked_gp_l1_reg_loss: 8504.7643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166638.4913; train_chrom_access_recon_loss: 2164694.7778; train_global_loss: 3937126.3056; train_optim_loss: 3937126.3056; val_kl_reg_loss: 14835.0518; val_edge_recon_loss: 406562.5625; val_gene_expr_recon_loss: 1036460.8750; val_masked_gp_l1_reg_loss: 6914.2939; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161952.7188; val_chrom_access_recon_loss: 1690279.7500; val_global_loss: 3317005.2500; val_optim_loss: 3317005.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8919; val_auprc_score: 0.9022; val_best_acc_score: 0.5026; val_best_f1_score: 0.6678; train_kl_reg_loss: 13624.8275; train_edge_recon_loss: 356981.4688; train_gene_expr_recon_loss: 906684.1806; train_masked_gp_l1_reg_loss: 6480.3659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159079.5486; train_chrom_access_recon_loss: 1504207.3750; train_global_loss: 2947057.7778; train_optim_loss: 2947057.7778; val_kl_reg_loss: 12741.3691; val_edge_recon_loss: 406550.5938; val_gene_expr_recon_loss: 854766.8750; val_masked_gp_l1_reg_loss: 6235.9238; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155584.9219; val_chrom_access_recon_loss: 1440635.1250; val_global_loss: 2876514.7500; val_optim_loss: 2876514.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8844; val_auprc_score: 0.8970; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 14601.6561; train_edge_recon_loss: 357555.0521; train_gene_expr_recon_loss: 813938.5764; train_masked_gp_l1_reg_loss: 6398.6776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152685.6788; train_chrom_access_recon_loss: 1407243.4861; train_global_loss: 2752423.1111; train_optim_loss: 2752423.1111; val_kl_reg_loss: 16124.3887; val_edge_recon_loss: 406559.9688; val_gene_expr_recon_loss: 804137.9375; val_masked_gp_l1_reg_loss: 6601.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148877.7188; val_chrom_access_recon_loss: 1401033.8750; val_global_loss: 2783335.5000; val_optim_loss: 2783335.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8723; val_auprc_score: 0.8867; val_best_acc_score: 0.5105; val_best_f1_score: 0.6714; train_kl_reg_loss: 18069.7357; train_edge_recon_loss: 359367.9028; train_gene_expr_recon_loss: 770051.8681; train_masked_gp_l1_reg_loss: 6649.2870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145507.0139; train_chrom_access_recon_loss: 1372650.7083; train_global_loss: 2672296.5278; train_optim_loss: 2672296.5278; val_kl_reg_loss: 19030.2754; val_edge_recon_loss: 406530.7812; val_gene_expr_recon_loss: 771817.5000; val_masked_gp_l1_reg_loss: 6674.7285; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141117.9531; val_chrom_access_recon_loss: 1379748.3750; val_global_loss: 2724919.5000; val_optim_loss: 2724919.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8661; val_auprc_score: 0.8751; val_best_acc_score: 0.5203; val_best_f1_score: 0.6756; train_kl_reg_loss: 20199.4425; train_edge_recon_loss: 360000.0486; train_gene_expr_recon_loss: 746355.7153; train_masked_gp_l1_reg_loss: 6689.6951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137395.0677; train_chrom_access_recon_loss: 1357075.2639; train_global_loss: 2627715.2500; train_optim_loss: 2627715.2500; val_kl_reg_loss: 20535.2461; val_edge_recon_loss: 406460.6562; val_gene_expr_recon_loss: 749770.1250; val_masked_gp_l1_reg_loss: 6688.2754; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132651.1719; val_chrom_access_recon_loss: 1367028.1250; val_global_loss: 2683133.5000; val_optim_loss: 2683133.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8675; val_auprc_score: 0.8734; val_best_acc_score: 0.5348; val_best_f1_score: 0.6817; train_kl_reg_loss: 21441.6367; train_edge_recon_loss: 360418.3194; train_gene_expr_recon_loss: 726853.4375; train_masked_gp_l1_reg_loss: 6687.6402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128775.0278; train_chrom_access_recon_loss: 1346699.1806; train_global_loss: 2590875.2500; train_optim_loss: 2590875.2500; val_kl_reg_loss: 20517.2812; val_edge_recon_loss: 406298.9688; val_gene_expr_recon_loss: 732791.0000; val_masked_gp_l1_reg_loss: 6672.8716; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123923.2422; val_chrom_access_recon_loss: 1357488.1250; val_global_loss: 2647691.5000; val_optim_loss: 2647691.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8674; val_auprc_score: 0.8651; val_best_acc_score: 0.5624; val_best_f1_score: 0.6917; train_kl_reg_loss: 21954.3203; train_edge_recon_loss: 360374.9167; train_gene_expr_recon_loss: 709436.7431; train_masked_gp_l1_reg_loss: 6666.6107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120078.9349; train_chrom_access_recon_loss: 1332372.5000; train_global_loss: 2550884.0556; train_optim_loss: 2550884.0556; val_kl_reg_loss: 21129.3086; val_edge_recon_loss: 405931.2188; val_gene_expr_recon_loss: 717377.9375; val_masked_gp_l1_reg_loss: 6637.9907; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115314.6875; val_chrom_access_recon_loss: 1350146.3750; val_global_loss: 2616537.5000; val_optim_loss: 2616537.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8637; val_auprc_score: 0.8617; val_best_acc_score: 0.6202; val_best_f1_score: 0.7181; train_kl_reg_loss: 22619.5957; train_edge_recon_loss: 360028.1389; train_gene_expr_recon_loss: 696991.9097; train_masked_gp_l1_reg_loss: 6620.9760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111605.2500; train_chrom_access_recon_loss: 1327077.1944; train_global_loss: 2524943.1111; train_optim_loss: 2524943.1111; val_kl_reg_loss: 22661.9922; val_edge_recon_loss: 405336.9688; val_gene_expr_recon_loss: 704826.9375; val_masked_gp_l1_reg_loss: 6588.9355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107038.3438; val_chrom_access_recon_loss: 1344292.6250; val_global_loss: 2590745.7500; val_optim_loss: 2590745.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8483; val_auprc_score: 0.8480; val_best_acc_score: 0.6774; val_best_f1_score: 0.7460; train_kl_reg_loss: 23259.3826; train_edge_recon_loss: 359690.5764; train_gene_expr_recon_loss: 687338.1181; train_masked_gp_l1_reg_loss: 6577.7858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103528.9227; train_chrom_access_recon_loss: 1327146.3194; train_global_loss: 2507541.0833; train_optim_loss: 2507541.0833; val_kl_reg_loss: 22466.0430; val_edge_recon_loss: 404407.5938; val_gene_expr_recon_loss: 695688.6250; val_masked_gp_l1_reg_loss: 6555.7378; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99238.2500; val_chrom_access_recon_loss: 1339030.1250; val_global_loss: 2567386.5000; val_optim_loss: 2567386.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8485; val_auprc_score: 0.8497; val_best_acc_score: 0.7327; val_best_f1_score: 0.7717; train_kl_reg_loss: 23573.4280; train_edge_recon_loss: 359371.6389; train_gene_expr_recon_loss: 678099.8333; train_masked_gp_l1_reg_loss: 6556.6216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95991.7040; train_chrom_access_recon_loss: 1317637.4306; train_global_loss: 2481230.6389; train_optim_loss: 2481230.6389; val_kl_reg_loss: 24007.7461; val_edge_recon_loss: 403342.9062; val_gene_expr_recon_loss: 688824.2500; val_masked_gp_l1_reg_loss: 6550.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92058.0312; val_chrom_access_recon_loss: 1334584.2500; val_global_loss: 2549367.2500; val_optim_loss: 2549367.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8392; val_auprc_score: 0.8363; val_best_acc_score: 0.7510; val_best_f1_score: 0.7639; train_kl_reg_loss: 23862.3978; train_edge_recon_loss: 358806.6701; train_gene_expr_recon_loss: 670601.7708; train_masked_gp_l1_reg_loss: 6552.8921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89120.2960; train_chrom_access_recon_loss: 1313323.0556; train_global_loss: 2462267.0278; train_optim_loss: 2462267.0278; val_kl_reg_loss: 21324.2129; val_edge_recon_loss: 401363.3125; val_gene_expr_recon_loss: 685632.5000; val_masked_gp_l1_reg_loss: 6542.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85563.2422; val_chrom_access_recon_loss: 1331345.5000; val_global_loss: 2531771.5000; val_optim_loss: 2531771.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8382; val_auprc_score: 0.8338; val_best_acc_score: 0.7551; val_best_f1_score: 0.7475; train_kl_reg_loss: 23651.1584; train_edge_recon_loss: 358347.6354; train_gene_expr_recon_loss: 672140.6458; train_masked_gp_l1_reg_loss: 6550.8265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82924.6137; train_chrom_access_recon_loss: 1312847.9722; train_global_loss: 2456462.8611; train_optim_loss: 2456462.8611; val_kl_reg_loss: 21887.5156; val_edge_recon_loss: 399290.5000; val_gene_expr_recon_loss: 681071.6250; val_masked_gp_l1_reg_loss: 6552.7202; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79728.8281; val_chrom_access_recon_loss: 1327736.0000; val_global_loss: 2516267.2500; val_optim_loss: 2516267.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8501; val_auprc_score: 0.8479; val_best_acc_score: 0.7490; val_best_f1_score: 0.7610; train_kl_reg_loss: 23665.3207; train_edge_recon_loss: 357676.3368; train_gene_expr_recon_loss: 666267.6319; train_masked_gp_l1_reg_loss: 6564.2287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77353.3281; train_chrom_access_recon_loss: 1308351.6944; train_global_loss: 2439878.5556; train_optim_loss: 2439878.5556; val_kl_reg_loss: 21742.2969; val_edge_recon_loss: 396433.2188; val_gene_expr_recon_loss: 678257.7500; val_masked_gp_l1_reg_loss: 6561.8838; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74474.5156; val_chrom_access_recon_loss: 1325350.3750; val_global_loss: 2502820.0000; val_optim_loss: 2502820.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8491; val_auprc_score: 0.8406; val_best_acc_score: 0.7466; val_best_f1_score: 0.7802; train_kl_reg_loss: 23141.2832; train_edge_recon_loss: 356243.3125; train_gene_expr_recon_loss: 665250.4722; train_masked_gp_l1_reg_loss: 6577.1128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72337.4809; train_chrom_access_recon_loss: 1306021.1667; train_global_loss: 2429570.8333; train_optim_loss: 2429570.8333; val_kl_reg_loss: 21450.1484; val_edge_recon_loss: 392516.0312; val_gene_expr_recon_loss: 675646.0000; val_masked_gp_l1_reg_loss: 6584.1025; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69736.2266; val_chrom_access_recon_loss: 1322475.2500; val_global_loss: 2488408.0000; val_optim_loss: 2488408.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8632; val_auprc_score: 0.8604; val_best_acc_score: 0.7778; val_best_f1_score: 0.7920; train_kl_reg_loss: 22876.0907; train_edge_recon_loss: 354944.4583; train_gene_expr_recon_loss: 658768.2361; train_masked_gp_l1_reg_loss: 6602.4828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67799.3047; train_chrom_access_recon_loss: 1300604.7222; train_global_loss: 2411595.3056; train_optim_loss: 2411595.3056; val_kl_reg_loss: 21329.3418; val_edge_recon_loss: 387065.0000; val_gene_expr_recon_loss: 673502.5000; val_masked_gp_l1_reg_loss: 6608.2588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65439.3047; val_chrom_access_recon_loss: 1319625.1250; val_global_loss: 2473569.5000; val_optim_loss: 2473569.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8739; val_auprc_score: 0.8674; val_best_acc_score: 0.7851; val_best_f1_score: 0.7980; train_kl_reg_loss: 22564.2535; train_edge_recon_loss: 352969.4097; train_gene_expr_recon_loss: 663464.1111; train_masked_gp_l1_reg_loss: 6625.9947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63682.5469; train_chrom_access_recon_loss: 1308020.9028; train_global_loss: 2417327.1667; train_optim_loss: 2417327.1667; val_kl_reg_loss: 21294.2891; val_edge_recon_loss: 380089.2812; val_gene_expr_recon_loss: 671528.9375; val_masked_gp_l1_reg_loss: 6639.4346; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61543.2344; val_chrom_access_recon_loss: 1317492.5000; val_global_loss: 2458587.5000; val_optim_loss: 2458587.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8885; val_auprc_score: 0.8791; val_best_acc_score: 0.8087; val_best_f1_score: 0.8157; train_kl_reg_loss: 21850.3904; train_edge_recon_loss: 350004.0521; train_gene_expr_recon_loss: 657198.2639; train_masked_gp_l1_reg_loss: 6661.5971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59942.4410; train_chrom_access_recon_loss: 1298467.1111; train_global_loss: 2394123.8333; train_optim_loss: 2394123.8333; val_kl_reg_loss: 20916.3672; val_edge_recon_loss: 370437.0312; val_gene_expr_recon_loss: 670302.7500; val_masked_gp_l1_reg_loss: 6673.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57993.1602; val_chrom_access_recon_loss: 1315493.8750; val_global_loss: 2441816.7500; val_optim_loss: 2441816.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9047; val_auprc_score: 0.8966; val_best_acc_score: 0.8269; val_best_f1_score: 0.8328; train_kl_reg_loss: 21576.4490; train_edge_recon_loss: 344142.9271; train_gene_expr_recon_loss: 657470.3542; train_masked_gp_l1_reg_loss: 6697.8481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56535.1745; train_chrom_access_recon_loss: 1302110.9583; train_global_loss: 2388533.6944; train_optim_loss: 2388533.6944; val_kl_reg_loss: 20822.2402; val_edge_recon_loss: 354359.5938; val_gene_expr_recon_loss: 669547.5000; val_masked_gp_l1_reg_loss: 6716.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54751.6797; val_chrom_access_recon_loss: 1314372.2500; val_global_loss: 2420569.7500; val_optim_loss: 2420569.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9114; val_auprc_score: 0.8995; val_best_acc_score: 0.8350; val_best_f1_score: 0.8415; train_kl_reg_loss: 22022.0174; train_edge_recon_loss: 333775.9896; train_gene_expr_recon_loss: 655340.3194; train_masked_gp_l1_reg_loss: 6750.3613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53408.3832; train_chrom_access_recon_loss: 1294674.0139; train_global_loss: 2365971.0833; train_optim_loss: 2365971.0833; val_kl_reg_loss: 23096.2461; val_edge_recon_loss: 328928.3125; val_gene_expr_recon_loss: 673255.8125; val_masked_gp_l1_reg_loss: 6776.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51776.8672; val_chrom_access_recon_loss: 1313427.6250; val_global_loss: 2397261.5000; val_optim_loss: 2397261.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9249; val_auprc_score: 0.9161; val_best_acc_score: 0.8492; val_best_f1_score: 0.8582; train_kl_reg_loss: 26807.5599; train_edge_recon_loss: 318966.5799; train_gene_expr_recon_loss: 658497.9444; train_masked_gp_l1_reg_loss: 6806.6783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50563.4405; train_chrom_access_recon_loss: 1297731.9444; train_global_loss: 2359374.1667; train_optim_loss: 2359374.1667; val_kl_reg_loss: 30001.8867; val_edge_recon_loss: 312775.8125; val_gene_expr_recon_loss: 669476.3750; val_masked_gp_l1_reg_loss: 6834.2046; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49069.1719; val_chrom_access_recon_loss: 1310451.0000; val_global_loss: 2378608.5000; val_optim_loss: 2378608.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9257; val_auprc_score: 0.9074; val_best_acc_score: 0.8526; val_best_f1_score: 0.8623; train_kl_reg_loss: 31855.9269; train_edge_recon_loss: 308959.1042; train_gene_expr_recon_loss: 657376.4514; train_masked_gp_l1_reg_loss: 6862.2709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47948.9596; train_chrom_access_recon_loss: 1291312.3056; train_global_loss: 2344315.0278; train_optim_loss: 2344315.0278; val_kl_reg_loss: 31732.1738; val_edge_recon_loss: 307273.2500; val_gene_expr_recon_loss: 668053.1250; val_masked_gp_l1_reg_loss: 6892.3218; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46576.3086; val_chrom_access_recon_loss: 1307709.8750; val_global_loss: 2368237.0000; val_optim_loss: 2368237.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9348; val_auprc_score: 0.9169; val_best_acc_score: 0.8658; val_best_f1_score: 0.8736; train_kl_reg_loss: 31552.8103; train_edge_recon_loss: 304855.4062; train_gene_expr_recon_loss: 649650.2500; train_masked_gp_l1_reg_loss: 6921.8051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45545.3207; train_chrom_access_recon_loss: 1286763.3889; train_global_loss: 2325289.0000; train_optim_loss: 2325289.0000; val_kl_reg_loss: 30919.3867; val_edge_recon_loss: 303909.2812; val_gene_expr_recon_loss: 667478.8750; val_masked_gp_l1_reg_loss: 6938.8691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44270.2266; val_chrom_access_recon_loss: 1305336.5000; val_global_loss: 2358853.0000; val_optim_loss: 2358853.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9444; val_auprc_score: 0.9274; val_best_acc_score: 0.8859; val_best_f1_score: 0.8899; train_kl_reg_loss: 30886.3537; train_edge_recon_loss: 301922.9236; train_gene_expr_recon_loss: 649445.9444; train_masked_gp_l1_reg_loss: 6955.0803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43318.2474; train_chrom_access_recon_loss: 1279577.6250; train_global_loss: 2312106.1111; train_optim_loss: 2312106.1111; val_kl_reg_loss: 31480.7207; val_edge_recon_loss: 299403.8438; val_gene_expr_recon_loss: 665067.6250; val_masked_gp_l1_reg_loss: 6976.0605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42144.3750; val_chrom_access_recon_loss: 1302757.5000; val_global_loss: 2347830.0000; val_optim_loss: 2347830.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9443; val_auprc_score: 0.9252; val_best_acc_score: 0.8857; val_best_f1_score: 0.8901; train_kl_reg_loss: 32204.1009; train_edge_recon_loss: 298661.6146; train_gene_expr_recon_loss: 652776.7222; train_masked_gp_l1_reg_loss: 6995.8174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41251.3420; train_chrom_access_recon_loss: 1292698.3750; train_global_loss: 2324587.9722; train_optim_loss: 2324587.9722; val_kl_reg_loss: 31885.9883; val_edge_recon_loss: 299124.4062; val_gene_expr_recon_loss: 663481.0000; val_masked_gp_l1_reg_loss: 7015.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40154.4023; val_chrom_access_recon_loss: 1300260.7500; val_global_loss: 2341922.0000; val_optim_loss: 2341922.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9453; val_auprc_score: 0.9243; val_best_acc_score: 0.8868; val_best_f1_score: 0.8906; train_kl_reg_loss: 31372.8409; train_edge_recon_loss: 298086.8403; train_gene_expr_recon_loss: 652668.5556; train_masked_gp_l1_reg_loss: 7037.2165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39326.8381; train_chrom_access_recon_loss: 1284783.7222; train_global_loss: 2313275.9722; train_optim_loss: 2313275.9722; val_kl_reg_loss: 30657.4766; val_edge_recon_loss: 300642.8438; val_gene_expr_recon_loss: 662919.6875; val_masked_gp_l1_reg_loss: 7055.3267; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38310.1562; val_chrom_access_recon_loss: 1298066.8750; val_global_loss: 2337652.5000; val_optim_loss: 2337652.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9508; val_auprc_score: 0.9292; val_best_acc_score: 0.8971; val_best_f1_score: 0.9011; train_kl_reg_loss: 28253.8158; train_edge_recon_loss: 300118.3090; train_gene_expr_recon_loss: 966424.7639; train_masked_gp_l1_reg_loss: 7181.1815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37335.6975; train_chrom_access_recon_loss: 1351556.7500; train_global_loss: 2690870.5278; train_optim_loss: 2690870.5278; val_kl_reg_loss: 19787.7148; val_edge_recon_loss: 296778.6250; val_gene_expr_recon_loss: 983314.6875; val_masked_gp_l1_reg_loss: 7398.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36000.1602; val_chrom_access_recon_loss: 1369625.2500; val_global_loss: 2712905.0000; val_optim_loss: 2712905.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9516; val_auprc_score: 0.9341; val_best_acc_score: 0.8941; val_best_f1_score: 0.8987; train_kl_reg_loss: 27764.8670; train_edge_recon_loss: 296568.2083; train_gene_expr_recon_loss: 961297.2708; train_masked_gp_l1_reg_loss: 7607.3049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34885.7179; train_chrom_access_recon_loss: 1352649.2639; train_global_loss: 2680772.6667; train_optim_loss: 2680772.6667; val_kl_reg_loss: 21920.4355; val_edge_recon_loss: 294900.8125; val_gene_expr_recon_loss: 975725.0625; val_masked_gp_l1_reg_loss: 7846.3408; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33511.6758; val_chrom_access_recon_loss: 1367030.6250; val_global_loss: 2700935.0000; val_optim_loss: 2700935.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9541; val_auprc_score: 0.9394; val_best_acc_score: 0.9000; val_best_f1_score: 0.9041; train_kl_reg_loss: 27060.3791; train_edge_recon_loss: 293606.2882; train_gene_expr_recon_loss: 952475.7917; train_masked_gp_l1_reg_loss: 8020.4872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32473.1207; train_chrom_access_recon_loss: 1343531.9167; train_global_loss: 2657168.0000; train_optim_loss: 2657168.0000; val_kl_reg_loss: 23398.2148; val_edge_recon_loss: 291337.0000; val_gene_expr_recon_loss: 969383.3125; val_masked_gp_l1_reg_loss: 8218.8682; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31216.3945; val_chrom_access_recon_loss: 1365231.2500; val_global_loss: 2688785.0000; val_optim_loss: 2688785.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9562; val_auprc_score: 0.9401; val_best_acc_score: 0.9029; val_best_f1_score: 0.9067; train_kl_reg_loss: 26523.4297; train_edge_recon_loss: 292627.8229; train_gene_expr_recon_loss: 945061.6042; train_masked_gp_l1_reg_loss: 8360.5736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30287.8835; train_chrom_access_recon_loss: 1342561.1111; train_global_loss: 2645422.3889; train_optim_loss: 2645422.3889; val_kl_reg_loss: 24025.4805; val_edge_recon_loss: 292098.7188; val_gene_expr_recon_loss: 966645.6875; val_masked_gp_l1_reg_loss: 8519.8379; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29174.7305; val_chrom_access_recon_loss: 1363303.1250; val_global_loss: 2683767.5000; val_optim_loss: 2683767.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9530; val_auprc_score: 0.9356; val_best_acc_score: 0.8995; val_best_f1_score: 0.9030; train_kl_reg_loss: 26210.1556; train_edge_recon_loss: 290693.3611; train_gene_expr_recon_loss: 945010.7083; train_masked_gp_l1_reg_loss: 8500.4451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29003.1871; train_chrom_access_recon_loss: 1342372.3611; train_global_loss: 2641790.1944; train_optim_loss: 2641790.1944; val_kl_reg_loss: 23983.5918; val_edge_recon_loss: 294795.4688; val_gene_expr_recon_loss: 963917.6250; val_masked_gp_l1_reg_loss: 8483.5146; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28811.0176; val_chrom_access_recon_loss: 1362556.7500; val_global_loss: 2682548.0000; val_optim_loss: 2682548.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9584; val_auprc_score: 0.9442; val_best_acc_score: 0.9050; val_best_f1_score: 0.9080; train_kl_reg_loss: 26349.2539; train_edge_recon_loss: 291762.3750; train_gene_expr_recon_loss: 944146.8403; train_masked_gp_l1_reg_loss: 8483.9012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28694.7804; train_chrom_access_recon_loss: 1346399.9167; train_global_loss: 2645837.1111; train_optim_loss: 2645837.1111; val_kl_reg_loss: 24238.0352; val_edge_recon_loss: 291330.3438; val_gene_expr_recon_loss: 964041.7500; val_masked_gp_l1_reg_loss: 8482.3389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28544.9121; val_chrom_access_recon_loss: 1362113.3750; val_global_loss: 2678750.7500; val_optim_loss: 2678750.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9570; val_auprc_score: 0.9432; val_best_acc_score: 0.9029; val_best_f1_score: 0.9068; train_kl_reg_loss: 26243.3752; train_edge_recon_loss: 291823.3542; train_gene_expr_recon_loss: 946973.4722; train_masked_gp_l1_reg_loss: 8484.3989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28436.3787; train_chrom_access_recon_loss: 1339366.3333; train_global_loss: 2641327.3333; train_optim_loss: 2641327.3333; val_kl_reg_loss: 24152.5898; val_edge_recon_loss: 292057.2812; val_gene_expr_recon_loss: 963523.0625; val_masked_gp_l1_reg_loss: 8487.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28304.0820; val_chrom_access_recon_loss: 1362176.3750; val_global_loss: 2678701.5000; val_optim_loss: 2678701.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9607; val_auprc_score: 0.9479; val_best_acc_score: 0.9081; val_best_f1_score: 0.9113; train_kl_reg_loss: 26129.8661; train_edge_recon_loss: 291113.5486; train_gene_expr_recon_loss: 940041.6667; train_masked_gp_l1_reg_loss: 8493.0906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28203.9412; train_chrom_access_recon_loss: 1342074.7917; train_global_loss: 2636056.9722; train_optim_loss: 2636056.9722; val_kl_reg_loss: 24112.4766; val_edge_recon_loss: 291039.9375; val_gene_expr_recon_loss: 963185.7500; val_masked_gp_l1_reg_loss: 8500.0303; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28084.3516; val_chrom_access_recon_loss: 1362063.0000; val_global_loss: 2676985.5000; val_optim_loss: 2676985.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 33 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9506
val AUPRC score: 0.9335
val best accuracy score: 0.8925
val best F1 score: 0.8964
val target rna MSE score: 4.0381
val source rna MSE score: 3.3154
val target atac MSE score: 0.1384
val source atac MSE score: 0.0201
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
