[True]
Run timestamp: 09102023_223428_60.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_60']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6251; val_auprc_score: 0.6029; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 48907.1653; train_edge_recon_loss: 3509035.8485; train_gene_expr_recon_loss: 13918375.9242; train_masked_gp_l1_reg_loss: 130902.9493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4537088.8447; train_chrom_access_recon_loss: 2972392.4583; train_global_loss: 25116703.3030; train_optim_loss: 25116703.3030; val_kl_reg_loss: 49178.4028; val_edge_recon_loss: 4065247.0625; val_gene_expr_recon_loss: 13219887.0000; val_masked_gp_l1_reg_loss: 107944.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2085477.2500; val_chrom_access_recon_loss: 2881772.4062; val_global_loss: 22409506.7500; val_optim_loss: 22409506.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6650; val_auprc_score: 0.6480; val_best_acc_score: 0.5758; val_best_f1_score: 0.6912; train_kl_reg_loss: 92781.5958; train_edge_recon_loss: 3516538.1932; train_gene_expr_recon_loss: 12850435.4848; train_masked_gp_l1_reg_loss: 104022.6764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 958671.5223; train_chrom_access_recon_loss: 2840619.1364; train_global_loss: 20363068.6970; train_optim_loss: 20363068.6970; val_kl_reg_loss: 89701.4229; val_edge_recon_loss: 4061176.8125; val_gene_expr_recon_loss: 12854661.2500; val_masked_gp_l1_reg_loss: 101138.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 380772.0938; val_chrom_access_recon_loss: 2853019.6875; val_global_loss: 20340469.0000; val_optim_loss: 20340469.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7304; val_auprc_score: 0.7011; val_best_acc_score: 0.6677; val_best_f1_score: 0.7058; train_kl_reg_loss: 90342.3015; train_edge_recon_loss: 3516211.6098; train_gene_expr_recon_loss: 12681699.2273; train_masked_gp_l1_reg_loss: 100929.7803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 256374.5154; train_chrom_access_recon_loss: 2817518.1894; train_global_loss: 19463075.4848; train_optim_loss: 19463075.4848; val_kl_reg_loss: 89667.9971; val_edge_recon_loss: 4046747.7188; val_gene_expr_recon_loss: 12692928.7500; val_masked_gp_l1_reg_loss: 101412.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181895.4375; val_chrom_access_recon_loss: 2792553.7812; val_global_loss: 19905206.7500; val_optim_loss: 19905206.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7830; val_auprc_score: 0.7593; val_best_acc_score: 0.7163; val_best_f1_score: 0.7413; train_kl_reg_loss: 78991.7736; train_edge_recon_loss: 3501583.3144; train_gene_expr_recon_loss: 12581037.4242; train_masked_gp_l1_reg_loss: 101940.8810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151574.7765; train_chrom_access_recon_loss: 2798176.9242; train_global_loss: 19213305.1818; train_optim_loss: 19213305.1818; val_kl_reg_loss: 69862.9648; val_edge_recon_loss: 3861451.6250; val_gene_expr_recon_loss: 12755837.6250; val_masked_gp_l1_reg_loss: 103359.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128846.6484; val_chrom_access_recon_loss: 2777983.6875; val_global_loss: 19697342.0000; val_optim_loss: 19697342.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8257; val_auprc_score: 0.8120; val_best_acc_score: 0.7399; val_best_f1_score: 0.7649; train_kl_reg_loss: 70278.0967; train_edge_recon_loss: 3276941.4886; train_gene_expr_recon_loss: 12532186.8788; train_masked_gp_l1_reg_loss: 107554.1547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115958.3778; train_chrom_access_recon_loss: 2790804.3106; train_global_loss: 18893723.4545; train_optim_loss: 18893723.4545; val_kl_reg_loss: 89414.2275; val_edge_recon_loss: 3167491.4688; val_gene_expr_recon_loss: 12629591.3750; val_masked_gp_l1_reg_loss: 113194.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105989.8047; val_chrom_access_recon_loss: 2779229.5000; val_global_loss: 18884911.2500; val_optim_loss: 18884911.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8531; val_auprc_score: 0.8218; val_best_acc_score: 0.7746; val_best_f1_score: 0.7975; train_kl_reg_loss: 91595.8486; train_edge_recon_loss: 3021313.8598; train_gene_expr_recon_loss: 12461790.5606; train_masked_gp_l1_reg_loss: 115194.0198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100558.5518; train_chrom_access_recon_loss: 2775212.9621; train_global_loss: 18565665.7576; train_optim_loss: 18565665.7576; val_kl_reg_loss: 92740.4268; val_edge_recon_loss: 2989692.2812; val_gene_expr_recon_loss: 12470834.1250; val_masked_gp_l1_reg_loss: 117238.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97646.5859; val_chrom_access_recon_loss: 2760975.1250; val_global_loss: 18529128.0000; val_optim_loss: 18529128.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8571; val_auprc_score: 0.8273; val_best_acc_score: 0.7931; val_best_f1_score: 0.8197; train_kl_reg_loss: 98244.0866; train_edge_recon_loss: 2896690.8333; train_gene_expr_recon_loss: 12381897.1970; train_masked_gp_l1_reg_loss: 118889.1355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96431.5130; train_chrom_access_recon_loss: 2756980.5985; train_global_loss: 18349133.3030; train_optim_loss: 18349133.3030; val_kl_reg_loss: 100752.9932; val_edge_recon_loss: 2916733.9688; val_gene_expr_recon_loss: 12384444.6250; val_masked_gp_l1_reg_loss: 119894.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93572.0078; val_chrom_access_recon_loss: 2731411.2812; val_global_loss: 18346810.0000; val_optim_loss: 18346810.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8667; val_auprc_score: 0.8364; val_best_acc_score: 0.7861; val_best_f1_score: 0.8126; train_kl_reg_loss: 102714.7384; train_edge_recon_loss: 2864616.5530; train_gene_expr_recon_loss: 12323092.9697; train_masked_gp_l1_reg_loss: 120946.9241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90695.5179; train_chrom_access_recon_loss: 2745508.1932; train_global_loss: 18247574.8788; train_optim_loss: 18247574.8788; val_kl_reg_loss: 113162.4229; val_edge_recon_loss: 2867498.0312; val_gene_expr_recon_loss: 12419770.8750; val_masked_gp_l1_reg_loss: 121654.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88490.7500; val_chrom_access_recon_loss: 2730695.7812; val_global_loss: 18341272.2500; val_optim_loss: 18341272.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8840; val_auprc_score: 0.8513; val_best_acc_score: 0.8111; val_best_f1_score: 0.8301; train_kl_reg_loss: 105335.5243; train_edge_recon_loss: 2850806.2008; train_gene_expr_recon_loss: 12259021.2727; train_masked_gp_l1_reg_loss: 122112.4712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87316.1858; train_chrom_access_recon_loss: 2734145.0000; train_global_loss: 18158736.5758; train_optim_loss: 18158736.5758; val_kl_reg_loss: 104377.6699; val_edge_recon_loss: 2913036.3125; val_gene_expr_recon_loss: 12300802.1250; val_masked_gp_l1_reg_loss: 122627.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86940.4375; val_chrom_access_recon_loss: 2744396.4688; val_global_loss: 18272179.5000; val_optim_loss: 18272179.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8990; val_auprc_score: 0.8681; val_best_acc_score: 0.8337; val_best_f1_score: 0.8440; train_kl_reg_loss: 102140.5878; train_edge_recon_loss: 2821470.2348; train_gene_expr_recon_loss: 12192971.4091; train_masked_gp_l1_reg_loss: 123366.8506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86392.4785; train_chrom_access_recon_loss: 2721766.0985; train_global_loss: 18048107.6061; train_optim_loss: 18048107.6061; val_kl_reg_loss: 103206.0576; val_edge_recon_loss: 2875435.8750; val_gene_expr_recon_loss: 12168466.0000; val_masked_gp_l1_reg_loss: 124207.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85059.7656; val_chrom_access_recon_loss: 2700191.0938; val_global_loss: 18056566.2500; val_optim_loss: 18056566.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9037; val_auprc_score: 0.8720; val_best_acc_score: 0.8399; val_best_f1_score: 0.8501; train_kl_reg_loss: 101368.1355; train_edge_recon_loss: 2827326.5568; train_gene_expr_recon_loss: 12159352.4091; train_masked_gp_l1_reg_loss: 124480.3131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83961.8999; train_chrom_access_recon_loss: 2713809.6591; train_global_loss: 18010298.9091; train_optim_loss: 18010298.9091; val_kl_reg_loss: 98970.8848; val_edge_recon_loss: 2878923.7812; val_gene_expr_recon_loss: 12235259.7500; val_masked_gp_l1_reg_loss: 125056.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83376.3750; val_chrom_access_recon_loss: 2727038.7812; val_global_loss: 18148625.2500; val_optim_loss: 18148625.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9070; val_auprc_score: 0.8711; val_best_acc_score: 0.8471; val_best_f1_score: 0.8556; train_kl_reg_loss: 101629.3949; train_edge_recon_loss: 2797470.1439; train_gene_expr_recon_loss: 12117168.7879; train_masked_gp_l1_reg_loss: 125704.8035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81857.6130; train_chrom_access_recon_loss: 2704919.5909; train_global_loss: 17928750.2424; train_optim_loss: 17928750.2424; val_kl_reg_loss: 102607.8311; val_edge_recon_loss: 2842870.6562; val_gene_expr_recon_loss: 12169873.3750; val_masked_gp_l1_reg_loss: 126185.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81420.3281; val_chrom_access_recon_loss: 2690558.3750; val_global_loss: 18013515.5000; val_optim_loss: 18013515.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9052; val_auprc_score: 0.8734; val_best_acc_score: 0.8426; val_best_f1_score: 0.8564; train_kl_reg_loss: 101273.0863; train_edge_recon_loss: 2808655.7955; train_gene_expr_recon_loss: 12068891.1212; train_masked_gp_l1_reg_loss: 126680.6679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80546.9548; train_chrom_access_recon_loss: 2692172.5644; train_global_loss: 17878220.1212; train_optim_loss: 17878220.1212; val_kl_reg_loss: 102526.0781; val_edge_recon_loss: 2841674.9375; val_gene_expr_recon_loss: 12080889.1250; val_masked_gp_l1_reg_loss: 127209.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79660.5859; val_chrom_access_recon_loss: 2689103.1562; val_global_loss: 17921063.5000; val_optim_loss: 17921063.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9092; val_auprc_score: 0.8790; val_best_acc_score: 0.8477; val_best_f1_score: 0.8586; train_kl_reg_loss: 101345.5897; train_edge_recon_loss: 2778633.4886; train_gene_expr_recon_loss: 12031888.4545; train_masked_gp_l1_reg_loss: 127476.6674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78626.9873; train_chrom_access_recon_loss: 2687266.4924; train_global_loss: 17805237.6667; train_optim_loss: 17805237.6667; val_kl_reg_loss: 98083.1523; val_edge_recon_loss: 2834035.9375; val_gene_expr_recon_loss: 12157454.6250; val_masked_gp_l1_reg_loss: 127791.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77684.6484; val_chrom_access_recon_loss: 2709172.1250; val_global_loss: 18004222.0000; val_optim_loss: 18004222.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9060; val_auprc_score: 0.8657; val_best_acc_score: 0.8455; val_best_f1_score: 0.8564; train_kl_reg_loss: 98904.4006; train_edge_recon_loss: 2780149.7538; train_gene_expr_recon_loss: 11990569.0909; train_masked_gp_l1_reg_loss: 128225.3737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77323.6759; train_chrom_access_recon_loss: 2677044.3485; train_global_loss: 17752216.5758; train_optim_loss: 17752216.5758; val_kl_reg_loss: 95718.5039; val_edge_recon_loss: 2852761.8750; val_gene_expr_recon_loss: 12065368.8750; val_masked_gp_l1_reg_loss: 128540.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76948.1484; val_chrom_access_recon_loss: 2670667.2812; val_global_loss: 17890004.7500; val_optim_loss: 17890004.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9210; val_auprc_score: 0.8923; val_best_acc_score: 0.8616; val_best_f1_score: 0.8716; train_kl_reg_loss: 97545.8021; train_edge_recon_loss: 2781293.1364; train_gene_expr_recon_loss: 11962406.6818; train_masked_gp_l1_reg_loss: 128885.8411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76713.8443; train_chrom_access_recon_loss: 2671279.1023; train_global_loss: 17718124.2727; train_optim_loss: 17718124.2727; val_kl_reg_loss: 95353.8418; val_edge_recon_loss: 2787316.3125; val_gene_expr_recon_loss: 12001490.7500; val_masked_gp_l1_reg_loss: 129098.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76403.8125; val_chrom_access_recon_loss: 2686820.1562; val_global_loss: 17776483.2500; val_optim_loss: 17776483.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9091; val_auprc_score: 0.8702; val_best_acc_score: 0.8546; val_best_f1_score: 0.8646; train_kl_reg_loss: 97393.9754; train_edge_recon_loss: 2767752.9583; train_gene_expr_recon_loss: 11939158.2727; train_masked_gp_l1_reg_loss: 129633.4355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75996.9466; train_chrom_access_recon_loss: 2665929.5682; train_global_loss: 17675865.2424; train_optim_loss: 17675865.2424; val_kl_reg_loss: 99568.9668; val_edge_recon_loss: 2821862.8750; val_gene_expr_recon_loss: 11962343.7500; val_masked_gp_l1_reg_loss: 129686.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75507.8281; val_chrom_access_recon_loss: 2658369.5625; val_global_loss: 17747339.0000; val_optim_loss: 17747339.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9140; val_auprc_score: 0.8796; val_best_acc_score: 0.8560; val_best_f1_score: 0.8657; train_kl_reg_loss: 97921.0558; train_edge_recon_loss: 2759910.7348; train_gene_expr_recon_loss: 11908699.6667; train_masked_gp_l1_reg_loss: 129900.9206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75154.8770; train_chrom_access_recon_loss: 2656595.7992; train_global_loss: 17628182.9697; train_optim_loss: 17628182.9697; val_kl_reg_loss: 100948.6230; val_edge_recon_loss: 2807001.8125; val_gene_expr_recon_loss: 11865158.2500; val_masked_gp_l1_reg_loss: 130305.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74900.3750; val_chrom_access_recon_loss: 2627580.9688; val_global_loss: 17605894.6250; val_optim_loss: 17605894.6250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9187; val_auprc_score: 0.8888; val_best_acc_score: 0.8584; val_best_f1_score: 0.8670; train_kl_reg_loss: 96127.6822; train_edge_recon_loss: 2761056.1288; train_gene_expr_recon_loss: 11879722.4091; train_masked_gp_l1_reg_loss: 130492.3884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74789.2599; train_chrom_access_recon_loss: 2652099.9015; train_global_loss: 17594287.7273; train_optim_loss: 17594287.7273; val_kl_reg_loss: 94069.2842; val_edge_recon_loss: 2807895.5312; val_gene_expr_recon_loss: 11838221.2500; val_masked_gp_l1_reg_loss: 130917.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74741.3984; val_chrom_access_recon_loss: 2629311.9375; val_global_loss: 17575157.2500; val_optim_loss: 17575157.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9246; val_auprc_score: 0.8996; val_best_acc_score: 0.8675; val_best_f1_score: 0.8746; train_kl_reg_loss: 95440.4215; train_edge_recon_loss: 2750038.3977; train_gene_expr_recon_loss: 11847411.8485; train_masked_gp_l1_reg_loss: 130881.7647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74705.8400; train_chrom_access_recon_loss: 2642873.7841; train_global_loss: 17541352.0606; train_optim_loss: 17541352.0606; val_kl_reg_loss: 97006.0264; val_edge_recon_loss: 2793892.5938; val_gene_expr_recon_loss: 12012558.6250; val_masked_gp_l1_reg_loss: 131020.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74823.8125; val_chrom_access_recon_loss: 2674893.4062; val_global_loss: 17784194.7500; val_optim_loss: 17784194.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9255; val_auprc_score: 0.8978; val_best_acc_score: 0.8643; val_best_f1_score: 0.8721; train_kl_reg_loss: 95909.8763; train_edge_recon_loss: 2749147.9053; train_gene_expr_recon_loss: 11819166.6515; train_masked_gp_l1_reg_loss: 131124.9970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74743.4190; train_chrom_access_recon_loss: 2639934.3561; train_global_loss: 17510027.1212; train_optim_loss: 17510027.1212; val_kl_reg_loss: 94578.4639; val_edge_recon_loss: 2784559.0938; val_gene_expr_recon_loss: 11927070.3750; val_masked_gp_l1_reg_loss: 131066.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74853.5156; val_chrom_access_recon_loss: 2651122.0000; val_global_loss: 17663251.0000; val_optim_loss: 17663251.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9227; val_auprc_score: 0.8971; val_best_acc_score: 0.8638; val_best_f1_score: 0.8708; train_kl_reg_loss: 92569.2657; train_edge_recon_loss: 2762800.3485; train_gene_expr_recon_loss: 11807507.5303; train_masked_gp_l1_reg_loss: 131233.7176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75260.5761; train_chrom_access_recon_loss: 2635776.5076; train_global_loss: 17505147.8788; train_optim_loss: 17505147.8788; val_kl_reg_loss: 94889.8311; val_edge_recon_loss: 2787170.1562; val_gene_expr_recon_loss: 11838164.0000; val_masked_gp_l1_reg_loss: 131681.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76149.8906; val_chrom_access_recon_loss: 2610585.4688; val_global_loss: 17538641.5000; val_optim_loss: 17538641.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9299; val_auprc_score: 0.9060; val_best_acc_score: 0.8743; val_best_f1_score: 0.8836; train_kl_reg_loss: 93184.4921; train_edge_recon_loss: 2757603.0379; train_gene_expr_recon_loss: 11772653.8636; train_masked_gp_l1_reg_loss: 131637.5393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75925.8178; train_chrom_access_recon_loss: 2627635.3674; train_global_loss: 17458640.0909; train_optim_loss: 17458640.0909; val_kl_reg_loss: 96817.2578; val_edge_recon_loss: 2762290.3750; val_gene_expr_recon_loss: 11845176.2500; val_masked_gp_l1_reg_loss: 131605.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75858.6641; val_chrom_access_recon_loss: 2627255.5625; val_global_loss: 17539003.2500; val_optim_loss: 17539003.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9325; val_auprc_score: 0.9095; val_best_acc_score: 0.8767; val_best_f1_score: 0.8835; train_kl_reg_loss: 94796.9543; train_edge_recon_loss: 2742103.1477; train_gene_expr_recon_loss: 11757385.7576; train_masked_gp_l1_reg_loss: 131627.5840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75919.6683; train_chrom_access_recon_loss: 2624163.7538; train_global_loss: 17425996.8182; train_optim_loss: 17425996.8182; val_kl_reg_loss: 94901.8428; val_edge_recon_loss: 2739062.8750; val_gene_expr_recon_loss: 11797231.8750; val_masked_gp_l1_reg_loss: 131500.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76323.8125; val_chrom_access_recon_loss: 2634061.8438; val_global_loss: 17473083.7500; val_optim_loss: 17473083.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9309; val_auprc_score: 0.9071; val_best_acc_score: 0.8737; val_best_f1_score: 0.8815; train_kl_reg_loss: 94304.8239; train_edge_recon_loss: 2732137.3864; train_gene_expr_recon_loss: 11725606.7727; train_masked_gp_l1_reg_loss: 131600.5270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76230.6187; train_chrom_access_recon_loss: 2615847.3258; train_global_loss: 17375727.4697; train_optim_loss: 17375727.4697; val_kl_reg_loss: 94813.0830; val_edge_recon_loss: 2766386.9375; val_gene_expr_recon_loss: 11820175.5000; val_masked_gp_l1_reg_loss: 131875.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75987.2422; val_chrom_access_recon_loss: 2622834.3125; val_global_loss: 17512071.7500; val_optim_loss: 17512071.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9252; val_auprc_score: 0.9014; val_best_acc_score: 0.8622; val_best_f1_score: 0.8689; train_kl_reg_loss: 122871.1618; train_edge_recon_loss: 2884592.5795; train_gene_expr_recon_loss: 10690964.5606; train_masked_gp_l1_reg_loss: 133190.2900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74287.7914; train_chrom_access_recon_loss: 2450776.9470; train_global_loss: 16356683.3636; train_optim_loss: 16356683.3636; val_kl_reg_loss: 32367.0596; val_edge_recon_loss: 2880915.1875; val_gene_expr_recon_loss: 10697721.5000; val_masked_gp_l1_reg_loss: 133743.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75392.7266; val_chrom_access_recon_loss: 2441992.4688; val_global_loss: 16262133.5000; val_optim_loss: 16262133.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9207; val_auprc_score: 0.8871; val_best_acc_score: 0.8571; val_best_f1_score: 0.8659; train_kl_reg_loss: 100714.8031; train_edge_recon_loss: 2801420.5568; train_gene_expr_recon_loss: 10603804.6515; train_masked_gp_l1_reg_loss: 132963.9931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75788.5157; train_chrom_access_recon_loss: 2409098.5492; train_global_loss: 16123791.0909; train_optim_loss: 16123791.0909; val_kl_reg_loss: 39740.3403; val_edge_recon_loss: 2807938.6875; val_gene_expr_recon_loss: 10603059.3750; val_masked_gp_l1_reg_loss: 131901.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76411.1875; val_chrom_access_recon_loss: 2404298.4688; val_global_loss: 16063349.0000; val_optim_loss: 16063349.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9188; val_auprc_score: 0.8829; val_best_acc_score: 0.8581; val_best_f1_score: 0.8652; train_kl_reg_loss: 87130.0163; train_edge_recon_loss: 2768530.8674; train_gene_expr_recon_loss: 10578692.3030; train_masked_gp_l1_reg_loss: 130447.6561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76373.8964; train_chrom_access_recon_loss: 2409053.1477; train_global_loss: 16050227.9394; train_optim_loss: 16050227.9394; val_kl_reg_loss: 48090.7944; val_edge_recon_loss: 2802864.0625; val_gene_expr_recon_loss: 10617729.7500; val_masked_gp_l1_reg_loss: 128914.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76443.2188; val_chrom_access_recon_loss: 2388455.2188; val_global_loss: 16062497.8750; val_optim_loss: 16062497.8750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9228; val_auprc_score: 0.8924; val_best_acc_score: 0.8622; val_best_f1_score: 0.8706; train_kl_reg_loss: 75572.4490; train_edge_recon_loss: 2745762.2689; train_gene_expr_recon_loss: 10547632.7273; train_masked_gp_l1_reg_loss: 127369.1319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76529.2902; train_chrom_access_recon_loss: 2403365.1591; train_global_loss: 15976230.9848; train_optim_loss: 15976230.9848; val_kl_reg_loss: 50974.1997; val_edge_recon_loss: 2800451.7812; val_gene_expr_recon_loss: 10564049.3750; val_masked_gp_l1_reg_loss: 125799.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76463.4531; val_chrom_access_recon_loss: 2386026.8438; val_global_loss: 16003764.8750; val_optim_loss: 16003764.8750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9287; val_auprc_score: 0.9010; val_best_acc_score: 0.8614; val_best_f1_score: 0.8701; train_kl_reg_loss: 72898.0336; train_edge_recon_loss: 2745543.7879; train_gene_expr_recon_loss: 10518494.0000; train_masked_gp_l1_reg_loss: 124336.4975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76054.6494; train_chrom_access_recon_loss: 2396354.7955; train_global_loss: 15933681.8030; train_optim_loss: 15933681.8030; val_kl_reg_loss: 56643.3818; val_edge_recon_loss: 2742398.6875; val_gene_expr_recon_loss: 10634694.6250; val_masked_gp_l1_reg_loss: 122919.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76181.3672; val_chrom_access_recon_loss: 2399935.1875; val_global_loss: 16032772.0000; val_optim_loss: 16032772.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9291; val_auprc_score: 0.9077; val_best_acc_score: 0.8651; val_best_f1_score: 0.8728; train_kl_reg_loss: 72045.6211; train_edge_recon_loss: 2730226.9242; train_gene_expr_recon_loss: 10508082.0909; train_masked_gp_l1_reg_loss: 121554.9412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75782.3465; train_chrom_access_recon_loss: 2394578.7727; train_global_loss: 15902270.6818; train_optim_loss: 15902270.6818; val_kl_reg_loss: 57088.9058; val_edge_recon_loss: 2763439.2188; val_gene_expr_recon_loss: 10572040.8750; val_masked_gp_l1_reg_loss: 120284.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75581.1484; val_chrom_access_recon_loss: 2372831.8438; val_global_loss: 15961265.6250; val_optim_loss: 15961265.6250
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9254; val_auprc_score: 0.8953; val_best_acc_score: 0.8646; val_best_f1_score: 0.8730; train_kl_reg_loss: 70252.4553; train_edge_recon_loss: 2723324.2273; train_gene_expr_recon_loss: 10485427.3788; train_masked_gp_l1_reg_loss: 119255.1907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75295.9822; train_chrom_access_recon_loss: 2393131.7652; train_global_loss: 15866686.9545; train_optim_loss: 15866686.9545; val_kl_reg_loss: 60181.9536; val_edge_recon_loss: 2767432.6875; val_gene_expr_recon_loss: 10553246.5000; val_masked_gp_l1_reg_loss: 118150.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75300.1641; val_chrom_access_recon_loss: 2392550.0938; val_global_loss: 15966861.3750; val_optim_loss: 15966861.3750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9237; val_auprc_score: 0.8966; val_best_acc_score: 0.8667; val_best_f1_score: 0.8764; train_kl_reg_loss: 68702.1004; train_edge_recon_loss: 2730093.0985; train_gene_expr_recon_loss: 10466998.6061; train_masked_gp_l1_reg_loss: 117347.6546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74945.0076; train_chrom_access_recon_loss: 2386460.2045; train_global_loss: 15844546.7424; train_optim_loss: 15844546.7424; val_kl_reg_loss: 63467.7139; val_edge_recon_loss: 2787861.9688; val_gene_expr_recon_loss: 10493331.1250; val_masked_gp_l1_reg_loss: 116527.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74617.7656; val_chrom_access_recon_loss: 2371566.9688; val_global_loss: 15907372.7500; val_optim_loss: 15907372.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9373; val_auprc_score: 0.9120; val_best_acc_score: 0.8778; val_best_f1_score: 0.8847; train_kl_reg_loss: 70717.5352; train_edge_recon_loss: 2716785.9735; train_gene_expr_recon_loss: 10456868.9697; train_masked_gp_l1_reg_loss: 115681.1239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74404.0239; train_chrom_access_recon_loss: 2386437.4470; train_global_loss: 15820895.0303; train_optim_loss: 15820895.0303; val_kl_reg_loss: 63170.9707; val_edge_recon_loss: 2748513.5000; val_gene_expr_recon_loss: 10511703.3750; val_masked_gp_l1_reg_loss: 114982.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74090.0078; val_chrom_access_recon_loss: 2383570.5000; val_global_loss: 15896031.6250; val_optim_loss: 15896031.6250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9391; val_auprc_score: 0.9156; val_best_acc_score: 0.8807; val_best_f1_score: 0.8864; train_kl_reg_loss: 69867.7298; train_edge_recon_loss: 2718333.5379; train_gene_expr_recon_loss: 10458002.6212; train_masked_gp_l1_reg_loss: 114466.2379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74157.6557; train_chrom_access_recon_loss: 2387090.1667; train_global_loss: 15821918.0455; train_optim_loss: 15821918.0455; val_kl_reg_loss: 64915.2222; val_edge_recon_loss: 2738770.8125; val_gene_expr_recon_loss: 10519858.0000; val_masked_gp_l1_reg_loss: 113900.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73713.3281; val_chrom_access_recon_loss: 2401604.0938; val_global_loss: 15912761.8750; val_optim_loss: 15912761.8750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9369; val_auprc_score: 0.9143; val_best_acc_score: 0.8807; val_best_f1_score: 0.8878; train_kl_reg_loss: 69733.5562; train_edge_recon_loss: 2717712.9470; train_gene_expr_recon_loss: 10436171.5303; train_masked_gp_l1_reg_loss: 113238.1213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73614.7910; train_chrom_access_recon_loss: 2385118.3068; train_global_loss: 15795589.3182; train_optim_loss: 15795589.3182; val_kl_reg_loss: 64123.6343; val_edge_recon_loss: 2758639.2500; val_gene_expr_recon_loss: 10560342.1250; val_masked_gp_l1_reg_loss: 112619.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73309.6406; val_chrom_access_recon_loss: 2415643.6875; val_global_loss: 15984678.7500; val_optim_loss: 15984678.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9381; val_auprc_score: 0.9122; val_best_acc_score: 0.8802; val_best_f1_score: 0.8878; train_kl_reg_loss: 67474.9761; train_edge_recon_loss: 2717085.3902; train_gene_expr_recon_loss: 10416141.0303; train_masked_gp_l1_reg_loss: 112208.3836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73434.6667; train_chrom_access_recon_loss: 2378360.2235; train_global_loss: 15764704.6061; train_optim_loss: 15764704.6061; val_kl_reg_loss: 64602.0063; val_edge_recon_loss: 2774098.5625; val_gene_expr_recon_loss: 10546860.2500; val_masked_gp_l1_reg_loss: 111757.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73780.7500; val_chrom_access_recon_loss: 2371425.5625; val_global_loss: 15942525.3750; val_optim_loss: 15942525.3750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9340; val_auprc_score: 0.9060; val_best_acc_score: 0.8791; val_best_f1_score: 0.8867; train_kl_reg_loss: 69303.4540; train_edge_recon_loss: 2707498.4015; train_gene_expr_recon_loss: 10397631.8485; train_masked_gp_l1_reg_loss: 111329.4998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73321.4772; train_chrom_access_recon_loss: 2374363.5455; train_global_loss: 15733448.2273; train_optim_loss: 15733448.2273; val_kl_reg_loss: 66745.1460; val_edge_recon_loss: 2761627.3438; val_gene_expr_recon_loss: 10500301.1250; val_masked_gp_l1_reg_loss: 110928.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73092.9844; val_chrom_access_recon_loss: 2391027.8125; val_global_loss: 15903723.3750; val_optim_loss: 15903723.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9401; val_auprc_score: 0.9167; val_best_acc_score: 0.8780; val_best_f1_score: 0.8862; train_kl_reg_loss: 69055.3370; train_edge_recon_loss: 2698158.5000; train_gene_expr_recon_loss: 10354318.8636; train_masked_gp_l1_reg_loss: 108261.1004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60440.6560; train_chrom_access_recon_loss: 2361457.3523; train_global_loss: 15651691.8030; train_optim_loss: 15651691.8030; val_kl_reg_loss: 66755.1279; val_edge_recon_loss: 2741688.7812; val_gene_expr_recon_loss: 10448770.8750; val_masked_gp_l1_reg_loss: 107518.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57756.9648; val_chrom_access_recon_loss: 2366769.9062; val_global_loss: 15789259.8750; val_optim_loss: 15789259.8750
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9439; val_auprc_score: 0.9208; val_best_acc_score: 0.8837; val_best_f1_score: 0.8908; train_kl_reg_loss: 69393.7826; train_edge_recon_loss: 2713947.5644; train_gene_expr_recon_loss: 10360378.3636; train_masked_gp_l1_reg_loss: 107390.7842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57387.3791; train_chrom_access_recon_loss: 2362582.0417; train_global_loss: 15671079.8636; train_optim_loss: 15671079.8636; val_kl_reg_loss: 66814.6523; val_edge_recon_loss: 2717707.2188; val_gene_expr_recon_loss: 10473328.8750; val_masked_gp_l1_reg_loss: 107307.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57173.5195; val_chrom_access_recon_loss: 2351360.1562; val_global_loss: 15773692.8750; val_optim_loss: 15773692.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9408; val_auprc_score: 0.9166; val_best_acc_score: 0.8804; val_best_f1_score: 0.8884; train_kl_reg_loss: 70031.0952; train_edge_recon_loss: 2706326.0606; train_gene_expr_recon_loss: 10361391.6667; train_masked_gp_l1_reg_loss: 107236.3739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57038.4973; train_chrom_access_recon_loss: 2362210.7727; train_global_loss: 15664234.4091; train_optim_loss: 15664234.4091; val_kl_reg_loss: 67815.3164; val_edge_recon_loss: 2741937.7812; val_gene_expr_recon_loss: 10467928.0000; val_masked_gp_l1_reg_loss: 107165.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56818.9883; val_chrom_access_recon_loss: 2393909.1562; val_global_loss: 15835575.2500; val_optim_loss: 15835575.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9376; val_auprc_score: 0.9175; val_best_acc_score: 0.8864; val_best_f1_score: 0.8934; train_kl_reg_loss: 70881.8632; train_edge_recon_loss: 2707872.4356; train_gene_expr_recon_loss: 10355989.9848; train_masked_gp_l1_reg_loss: 107113.4031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56691.0861; train_chrom_access_recon_loss: 2360875.4811; train_global_loss: 15659424.2273; train_optim_loss: 15659424.2273; val_kl_reg_loss: 66713.7207; val_edge_recon_loss: 2749550.5625; val_gene_expr_recon_loss: 10401236.0000; val_masked_gp_l1_reg_loss: 107057.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56563.1367; val_chrom_access_recon_loss: 2346351.0625; val_global_loss: 15727471.3750; val_optim_loss: 15727471.3750
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9418; val_auprc_score: 0.9152; val_best_acc_score: 0.8829; val_best_f1_score: 0.8908; train_kl_reg_loss: 70994.9329; train_edge_recon_loss: 2710175.8182; train_gene_expr_recon_loss: 10351603.1818; train_masked_gp_l1_reg_loss: 107003.7900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56451.6478; train_chrom_access_recon_loss: 2361124.6894; train_global_loss: 15657353.9545; train_optim_loss: 15657353.9545; val_kl_reg_loss: 67034.7686; val_edge_recon_loss: 2738732.4375; val_gene_expr_recon_loss: 10418812.6250; val_masked_gp_l1_reg_loss: 106959.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56360.3516; val_chrom_access_recon_loss: 2383458.0000; val_global_loss: 15771357.6250; val_optim_loss: 15771357.6250
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9440; val_auprc_score: 0.9243; val_best_acc_score: 0.8783; val_best_f1_score: 0.8865; train_kl_reg_loss: 71652.3335; train_edge_recon_loss: 2705230.0644; train_gene_expr_recon_loss: 10347516.8182; train_masked_gp_l1_reg_loss: 106900.2485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56160.7482; train_chrom_access_recon_loss: 2354989.5455; train_global_loss: 15642449.7121; train_optim_loss: 15642449.7121; val_kl_reg_loss: 67891.0137; val_edge_recon_loss: 2760804.5938; val_gene_expr_recon_loss: 10504224.8750; val_masked_gp_l1_reg_loss: 106844.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56096.5508; val_chrom_access_recon_loss: 2396767.0625; val_global_loss: 15892628.3750; val_optim_loss: 15892628.3750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9447; val_auprc_score: 0.9239; val_best_acc_score: 0.8877; val_best_f1_score: 0.8935; train_kl_reg_loss: 71589.8933; train_edge_recon_loss: 2706560.7008; train_gene_expr_recon_loss: 10350129.4394; train_masked_gp_l1_reg_loss: 106801.7938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56048.8082; train_chrom_access_recon_loss: 2355217.9242; train_global_loss: 15646348.7121; train_optim_loss: 15646348.7121; val_kl_reg_loss: 68129.1953; val_edge_recon_loss: 2709403.8438; val_gene_expr_recon_loss: 10487266.8750; val_masked_gp_l1_reg_loss: 106747.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55937.2969; val_chrom_access_recon_loss: 2353011.4688; val_global_loss: 15780496.2500; val_optim_loss: 15780496.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9421; val_auprc_score: 0.9147; val_best_acc_score: 0.8909; val_best_f1_score: 0.8978; train_kl_reg_loss: 71734.9711; train_edge_recon_loss: 2705802.9205; train_gene_expr_recon_loss: 10340921.5303; train_masked_gp_l1_reg_loss: 106682.8415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55834.2826; train_chrom_access_recon_loss: 2354973.5417; train_global_loss: 15635949.9848; train_optim_loss: 15635949.9848; val_kl_reg_loss: 67587.5791; val_edge_recon_loss: 2722543.5938; val_gene_expr_recon_loss: 10424732.3750; val_masked_gp_l1_reg_loss: 106632.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55731.7070; val_chrom_access_recon_loss: 2361582.9375; val_global_loss: 15738811.5000; val_optim_loss: 15738811.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9421; val_auprc_score: 0.9190; val_best_acc_score: 0.8874; val_best_f1_score: 0.8926; train_kl_reg_loss: 71621.0353; train_edge_recon_loss: 2706679.3561; train_gene_expr_recon_loss: 10359910.4697; train_masked_gp_l1_reg_loss: 106356.5049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54403.3045; train_chrom_access_recon_loss: 2359283.8220; train_global_loss: 15658254.5455; train_optim_loss: 15658254.5455; val_kl_reg_loss: 68366.8604; val_edge_recon_loss: 2747880.5000; val_gene_expr_recon_loss: 10454125.0000; val_masked_gp_l1_reg_loss: 106272.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54136.7148; val_chrom_access_recon_loss: 2393698.6562; val_global_loss: 15824480.0000; val_optim_loss: 15824480.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9418; val_auprc_score: 0.9204; val_best_acc_score: 0.8890; val_best_f1_score: 0.8953; train_kl_reg_loss: 71701.6068; train_edge_recon_loss: 2698780.4545; train_gene_expr_recon_loss: 10352274.6061; train_masked_gp_l1_reg_loss: 106252.0827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54103.8923; train_chrom_access_recon_loss: 2356108.2462; train_global_loss: 15639221.0152; train_optim_loss: 15639221.0152; val_kl_reg_loss: 67885.7793; val_edge_recon_loss: 2760298.5938; val_gene_expr_recon_loss: 10331313.7500; val_masked_gp_l1_reg_loss: 106237.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54071.7461; val_chrom_access_recon_loss: 2335650.4688; val_global_loss: 15655457.5000; val_optim_loss: 15655457.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9401; val_auprc_score: 0.9167; val_best_acc_score: 0.8796; val_best_f1_score: 0.8872; train_kl_reg_loss: 71750.3146; train_edge_recon_loss: 2698359.7576; train_gene_expr_recon_loss: 10339424.2121; train_masked_gp_l1_reg_loss: 106227.2283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54048.3755; train_chrom_access_recon_loss: 2354685.8371; train_global_loss: 15624495.6970; train_optim_loss: 15624495.6970; val_kl_reg_loss: 67834.1396; val_edge_recon_loss: 2737274.9062; val_gene_expr_recon_loss: 10330624.1250; val_masked_gp_l1_reg_loss: 106215.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54024.2383; val_chrom_access_recon_loss: 2336909.8125; val_global_loss: 15632883.1250; val_optim_loss: 15632883.1250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9442; val_auprc_score: 0.9241; val_best_acc_score: 0.8845; val_best_f1_score: 0.8919; train_kl_reg_loss: 71883.7177; train_edge_recon_loss: 2696945.0644; train_gene_expr_recon_loss: 10346771.5758; train_masked_gp_l1_reg_loss: 106209.5153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54007.2193; train_chrom_access_recon_loss: 2354257.7955; train_global_loss: 15630074.9242; train_optim_loss: 15630074.9242; val_kl_reg_loss: 68208.8389; val_edge_recon_loss: 2741049.6250; val_gene_expr_recon_loss: 10268417.2500; val_masked_gp_l1_reg_loss: 106199.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53985.7852; val_chrom_access_recon_loss: 2322309.2188; val_global_loss: 15560170.8750; val_optim_loss: 15560170.8750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9447; val_auprc_score: 0.9193; val_best_acc_score: 0.8907; val_best_f1_score: 0.8963; train_kl_reg_loss: 71981.9841; train_edge_recon_loss: 2703221.6402; train_gene_expr_recon_loss: 10348427.1364; train_masked_gp_l1_reg_loss: 106193.0703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53977.3200; train_chrom_access_recon_loss: 2354906.7159; train_global_loss: 15638707.8939; train_optim_loss: 15638707.8939; val_kl_reg_loss: 67838.7686; val_edge_recon_loss: 2723809.7812; val_gene_expr_recon_loss: 10494369.3750; val_masked_gp_l1_reg_loss: 106186.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53963.1445; val_chrom_access_recon_loss: 2379369.5938; val_global_loss: 15825536.3750; val_optim_loss: 15825536.3750
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9456; val_auprc_score: 0.9294; val_best_acc_score: 0.8904; val_best_f1_score: 0.8968; train_kl_reg_loss: 71894.6778; train_edge_recon_loss: 2699582.6629; train_gene_expr_recon_loss: 10342210.2273; train_masked_gp_l1_reg_loss: 106178.9535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53946.2399; train_chrom_access_recon_loss: 2352112.7652; train_global_loss: 15625925.5455; train_optim_loss: 15625925.5455; val_kl_reg_loss: 68638.6650; val_edge_recon_loss: 2717641.0625; val_gene_expr_recon_loss: 10398854.0000; val_masked_gp_l1_reg_loss: 106173.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53930.4883; val_chrom_access_recon_loss: 2361849.4688; val_global_loss: 15707086.1250; val_optim_loss: 15707086.1250
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9390; val_auprc_score: 0.9132; val_best_acc_score: 0.8866; val_best_f1_score: 0.8918; train_kl_reg_loss: 72102.7960; train_edge_recon_loss: 2705893.1667; train_gene_expr_recon_loss: 10341174.8485; train_masked_gp_l1_reg_loss: 106167.0411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53914.1513; train_chrom_access_recon_loss: 2355453.7462; train_global_loss: 15634705.6061; train_optim_loss: 15634705.6061; val_kl_reg_loss: 67889.9688; val_edge_recon_loss: 2725198.5625; val_gene_expr_recon_loss: 10450402.6250; val_masked_gp_l1_reg_loss: 106161.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53902.1094; val_chrom_access_recon_loss: 2357304.2812; val_global_loss: 15760859.5000; val_optim_loss: 15760859.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9464; val_auprc_score: 0.9246; val_best_acc_score: 0.8855; val_best_f1_score: 0.8940; train_kl_reg_loss: 71861.9042; train_edge_recon_loss: 2709653.3788; train_gene_expr_recon_loss: 10346810.3788; train_masked_gp_l1_reg_loss: 106155.7919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53891.9628; train_chrom_access_recon_loss: 2354748.8939; train_global_loss: 15643122.2879; train_optim_loss: 15643122.2879; val_kl_reg_loss: 68213.4912; val_edge_recon_loss: 2720010.5000; val_gene_expr_recon_loss: 10352334.2500; val_masked_gp_l1_reg_loss: 106150.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53878.7734; val_chrom_access_recon_loss: 2342292.1562; val_global_loss: 15642880.5000; val_optim_loss: 15642880.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9447; val_auprc_score: 0.9301; val_best_acc_score: 0.8855; val_best_f1_score: 0.8929; train_kl_reg_loss: 71744.3712; train_edge_recon_loss: 2706980.8636; train_gene_expr_recon_loss: 10343707.0909; train_masked_gp_l1_reg_loss: 106122.5496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53746.3218; train_chrom_access_recon_loss: 2352504.6250; train_global_loss: 15634805.7727; train_optim_loss: 15634805.7727; val_kl_reg_loss: 68219.7568; val_edge_recon_loss: 2728249.2500; val_gene_expr_recon_loss: 10369361.8750; val_masked_gp_l1_reg_loss: 106113.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53720.4297; val_chrom_access_recon_loss: 2356754.2500; val_global_loss: 15682419.3750; val_optim_loss: 15682419.3750
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9395; val_auprc_score: 0.9183; val_best_acc_score: 0.8850; val_best_f1_score: 0.8916; train_kl_reg_loss: 71950.8417; train_edge_recon_loss: 2698261.4432; train_gene_expr_recon_loss: 10341646.4091; train_masked_gp_l1_reg_loss: 106111.4962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53717.6750; train_chrom_access_recon_loss: 2354708.4470; train_global_loss: 15626396.2727; train_optim_loss: 15626396.2727; val_kl_reg_loss: 67702.7954; val_edge_recon_loss: 2739501.6562; val_gene_expr_recon_loss: 10456838.6250; val_masked_gp_l1_reg_loss: 106109.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53715.3867; val_chrom_access_recon_loss: 2346462.0625; val_global_loss: 15770329.1250; val_optim_loss: 15770329.1250
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9445; val_auprc_score: 0.9261; val_best_acc_score: 0.8864; val_best_f1_score: 0.8927; train_kl_reg_loss: 71978.7778; train_edge_recon_loss: 2692551.3258; train_gene_expr_recon_loss: 10353681.5000; train_masked_gp_l1_reg_loss: 106107.9130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53713.6764; train_chrom_access_recon_loss: 2355229.9848; train_global_loss: 15633263.2273; train_optim_loss: 15633263.2273; val_kl_reg_loss: 67710.5063; val_edge_recon_loss: 2732911.2500; val_gene_expr_recon_loss: 10324507.1250; val_masked_gp_l1_reg_loss: 106106.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53711.1133; val_chrom_access_recon_loss: 2342251.8750; val_global_loss: 15627199.0000; val_optim_loss: 15627199.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9415; val_auprc_score: 0.9206; val_best_acc_score: 0.8880; val_best_f1_score: 0.8948; train_kl_reg_loss: 71948.1128; train_edge_recon_loss: 2689937.6477; train_gene_expr_recon_loss: 10348807.0606; train_masked_gp_l1_reg_loss: 106105.7821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53709.8239; train_chrom_access_recon_loss: 2356101.0417; train_global_loss: 15626609.2576; train_optim_loss: 15626609.2576; val_kl_reg_loss: 68024.2354; val_edge_recon_loss: 2724726.4688; val_gene_expr_recon_loss: 10338697.7500; val_masked_gp_l1_reg_loss: 106104.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53707.8008; val_chrom_access_recon_loss: 2336892.1875; val_global_loss: 15628153.7500; val_optim_loss: 15628153.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 20 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9410
val AUPRC score: 0.9146
val best accuracy score: 0.8898
val best F1 score: 0.8963
val target rna MSE score: 2.4718
val source rna MSE score: 1.0208
val target atac MSE score: 0.4707
val source atac MSE score: 0.1964
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
