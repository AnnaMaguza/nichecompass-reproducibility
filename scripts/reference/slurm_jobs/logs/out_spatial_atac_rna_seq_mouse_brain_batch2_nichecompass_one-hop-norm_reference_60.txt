[True]
Run timestamp: 26072023_021339_60.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_60']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9656; val_auprc_score: 0.9669; val_best_acc_score: 0.7935; val_best_f1_score: 0.7558; train_kl_reg_loss: 708.0795; train_edge_recon_loss: 3464553.7778; train_gene_expr_recon_loss: 319446.3854; train_masked_gp_l1_reg_loss: 1543.8314; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1082650.6528; train_global_loss: 4868902.7778; train_optim_loss: 4868902.7778; val_kl_reg_loss: 573.3081; val_edge_recon_loss: 4012132.0000; val_gene_expr_recon_loss: 317435.0000; val_masked_gp_l1_reg_loss: 1210.0659; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1088891.6250; val_global_loss: 5420241.5000; val_optim_loss: 5420241.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9043; val_auprc_score: 0.8959; val_best_acc_score: 0.8131; val_best_f1_score: 0.8296; train_kl_reg_loss: 742.7446; train_edge_recon_loss: 3427054.2778; train_gene_expr_recon_loss: 311718.1042; train_masked_gp_l1_reg_loss: 1079.2546; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1074558.9167; train_global_loss: 4815153.2778; train_optim_loss: 4815153.2778; val_kl_reg_loss: 1579.7654; val_edge_recon_loss: 3278194.2500; val_gene_expr_recon_loss: 307103.5312; val_masked_gp_l1_reg_loss: 981.0997; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1082759.8750; val_global_loss: 4670618.5000; val_optim_loss: 4670618.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8846; val_auprc_score: 0.8723; val_best_acc_score: 0.7893; val_best_f1_score: 0.8051; train_kl_reg_loss: 7966.9332; train_edge_recon_loss: 3023612.1944; train_gene_expr_recon_loss: 301795.2986; train_masked_gp_l1_reg_loss: 1002.2451; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1067817.1389; train_global_loss: 4402193.7778; train_optim_loss: 4402193.7778; val_kl_reg_loss: 22139.7656; val_edge_recon_loss: 2831874.5000; val_gene_expr_recon_loss: 304185.2812; val_masked_gp_l1_reg_loss: 1042.2650; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1079038.1250; val_global_loss: 4238280.0000; val_optim_loss: 4238280.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9117; val_auprc_score: 0.8946; val_best_acc_score: 0.8323; val_best_f1_score: 0.8411; train_kl_reg_loss: 32203.6122; train_edge_recon_loss: 2798469.0833; train_gene_expr_recon_loss: 299368.5382; train_masked_gp_l1_reg_loss: 1051.3180; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1057960.5625; train_global_loss: 4189053.1389; train_optim_loss: 4189053.1389; val_kl_reg_loss: 36230.8984; val_edge_recon_loss: 2757213.5000; val_gene_expr_recon_loss: 295338.1562; val_masked_gp_l1_reg_loss: 1082.0186; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1070724.3750; val_global_loss: 4160589.0000; val_optim_loss: 4160589.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9283; val_auprc_score: 0.9096; val_best_acc_score: 0.8596; val_best_f1_score: 0.8692; train_kl_reg_loss: 32208.1849; train_edge_recon_loss: 2750625.2222; train_gene_expr_recon_loss: 291456.4479; train_masked_gp_l1_reg_loss: 1112.7978; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1057457.6181; train_global_loss: 4132860.3611; train_optim_loss: 4132860.3611; val_kl_reg_loss: 25071.4922; val_edge_recon_loss: 2712104.5000; val_gene_expr_recon_loss: 294009.9375; val_masked_gp_l1_reg_loss: 1149.1755; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1070041.1250; val_global_loss: 4102376.5000; val_optim_loss: 4102376.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9326; val_auprc_score: 0.9191; val_best_acc_score: 0.8662; val_best_f1_score: 0.8725; train_kl_reg_loss: 23684.3583; train_edge_recon_loss: 2707816.6111; train_gene_expr_recon_loss: 291423.4653; train_masked_gp_l1_reg_loss: 1181.7690; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1061537.6389; train_global_loss: 4085643.8889; train_optim_loss: 4085643.8889; val_kl_reg_loss: 23632.2637; val_edge_recon_loss: 2735540.5000; val_gene_expr_recon_loss: 289227.0000; val_masked_gp_l1_reg_loss: 1217.4893; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1064783.8750; val_global_loss: 4114401.0000; val_optim_loss: 4114401.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9428; val_auprc_score: 0.9260; val_best_acc_score: 0.8825; val_best_f1_score: 0.8890; train_kl_reg_loss: 24519.3435; train_edge_recon_loss: 2701115.5000; train_gene_expr_recon_loss: 283959.0312; train_masked_gp_l1_reg_loss: 1245.4127; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047599.4583; train_global_loss: 4058438.7222; train_optim_loss: 4058438.7222; val_kl_reg_loss: 24444.5078; val_edge_recon_loss: 2713405.5000; val_gene_expr_recon_loss: 284380.4688; val_masked_gp_l1_reg_loss: 1284.0175; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1060393.7500; val_global_loss: 4083908.2500; val_optim_loss: 4083908.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9482; val_auprc_score: 0.9326; val_best_acc_score: 0.8918; val_best_f1_score: 0.8975; train_kl_reg_loss: 23285.1191; train_edge_recon_loss: 2678051.0556; train_gene_expr_recon_loss: 280926.9688; train_masked_gp_l1_reg_loss: 1315.7681; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1045085.9931; train_global_loss: 4028664.9444; train_optim_loss: 4028664.9444; val_kl_reg_loss: 22001.0781; val_edge_recon_loss: 2680129.5000; val_gene_expr_recon_loss: 280100.5625; val_masked_gp_l1_reg_loss: 1349.8346; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1056289.0000; val_global_loss: 4039869.7500; val_optim_loss: 4039869.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9570; val_auprc_score: 0.9430; val_best_acc_score: 0.9023; val_best_f1_score: 0.9065; train_kl_reg_loss: 22007.0304; train_edge_recon_loss: 2672426.3611; train_gene_expr_recon_loss: 278956.8611; train_masked_gp_l1_reg_loss: 1374.6223; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1045297.4028; train_global_loss: 4020062.2778; train_optim_loss: 4020062.2778; val_kl_reg_loss: 21792.7852; val_edge_recon_loss: 2681965.5000; val_gene_expr_recon_loss: 275752.1875; val_masked_gp_l1_reg_loss: 1398.9850; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1052010.8750; val_global_loss: 4032920.5000; val_optim_loss: 4032920.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9576; val_auprc_score: 0.9416; val_best_acc_score: 0.9103; val_best_f1_score: 0.9133; train_kl_reg_loss: 22470.8331; train_edge_recon_loss: 2660484.4444; train_gene_expr_recon_loss: 274261.0972; train_masked_gp_l1_reg_loss: 1421.8682; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1040451.2222; train_global_loss: 3999089.5000; train_optim_loss: 3999089.5000; val_kl_reg_loss: 22733.5586; val_edge_recon_loss: 2657591.0000; val_gene_expr_recon_loss: 275544.5938; val_masked_gp_l1_reg_loss: 1451.3374; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1052608.0000; val_global_loss: 4009928.2500; val_optim_loss: 4009928.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9636; val_auprc_score: 0.9522; val_best_acc_score: 0.9120; val_best_f1_score: 0.9161; train_kl_reg_loss: 23210.1797; train_edge_recon_loss: 2654894.6111; train_gene_expr_recon_loss: 270580.8681; train_masked_gp_l1_reg_loss: 1479.4429; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1037572.7500; train_global_loss: 3987737.8056; train_optim_loss: 3987737.8056; val_kl_reg_loss: 22715.9922; val_edge_recon_loss: 2666024.7500; val_gene_expr_recon_loss: 269990.0312; val_masked_gp_l1_reg_loss: 1515.8324; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1045887.0625; val_global_loss: 4006133.5000; val_optim_loss: 4006133.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9594; val_auprc_score: 0.9435; val_best_acc_score: 0.9126; val_best_f1_score: 0.9161; train_kl_reg_loss: 22912.1311; train_edge_recon_loss: 2656005.6944; train_gene_expr_recon_loss: 267397.5469; train_masked_gp_l1_reg_loss: 1543.0841; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1029087.0347; train_global_loss: 3976945.4722; train_optim_loss: 3976945.4722; val_kl_reg_loss: 23349.8477; val_edge_recon_loss: 2679413.7500; val_gene_expr_recon_loss: 267103.5625; val_masked_gp_l1_reg_loss: 1575.4169; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1041480.2500; val_global_loss: 4012922.7500; val_optim_loss: 4012922.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9644; val_auprc_score: 0.9532; val_best_acc_score: 0.9158; val_best_f1_score: 0.9195; train_kl_reg_loss: 23601.1738; train_edge_recon_loss: 2649055.3889; train_gene_expr_recon_loss: 263352.9861; train_masked_gp_l1_reg_loss: 1599.8021; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1028055.1875; train_global_loss: 3965664.5833; train_optim_loss: 3965664.5833; val_kl_reg_loss: 22868.7930; val_edge_recon_loss: 2663048.7500; val_gene_expr_recon_loss: 264192.5625; val_masked_gp_l1_reg_loss: 1628.1903; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1038773.5625; val_global_loss: 3990511.7500; val_optim_loss: 3990511.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9619; val_auprc_score: 0.9468; val_best_acc_score: 0.9157; val_best_f1_score: 0.9186; train_kl_reg_loss: 23154.8199; train_edge_recon_loss: 2652627.8056; train_gene_expr_recon_loss: 261100.1128; train_masked_gp_l1_reg_loss: 1650.0529; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1024934.5208; train_global_loss: 3963467.3056; train_optim_loss: 3963467.3056; val_kl_reg_loss: 23105.6738; val_edge_recon_loss: 2642555.7500; val_gene_expr_recon_loss: 262068.0156; val_masked_gp_l1_reg_loss: 1683.2224; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1038414.5625; val_global_loss: 3967827.2500; val_optim_loss: 3967827.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9674; val_auprc_score: 0.9538; val_best_acc_score: 0.9223; val_best_f1_score: 0.9254; train_kl_reg_loss: 23747.9809; train_edge_recon_loss: 2655344.9722; train_gene_expr_recon_loss: 259162.1580; train_masked_gp_l1_reg_loss: 1710.1553; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1025518.4236; train_global_loss: 3965483.7778; train_optim_loss: 3965483.7778; val_kl_reg_loss: 23609.5742; val_edge_recon_loss: 2653984.5000; val_gene_expr_recon_loss: 260468.2500; val_masked_gp_l1_reg_loss: 1739.1786; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1033964.6250; val_global_loss: 3973766.0000; val_optim_loss: 3973766.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9689; val_auprc_score: 0.9574; val_best_acc_score: 0.9223; val_best_f1_score: 0.9258; train_kl_reg_loss: 23575.7674; train_edge_recon_loss: 2646285.5556; train_gene_expr_recon_loss: 257357.6042; train_masked_gp_l1_reg_loss: 1760.5684; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1023498.9583; train_global_loss: 3952478.4722; train_optim_loss: 3952478.4722; val_kl_reg_loss: 22826.9492; val_edge_recon_loss: 2643398.2500; val_gene_expr_recon_loss: 256340.7656; val_masked_gp_l1_reg_loss: 1786.3608; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1030955.6875; val_global_loss: 3955308.0000; val_optim_loss: 3955308.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9657; val_auprc_score: 0.9499; val_best_acc_score: 0.9188; val_best_f1_score: 0.9228; train_kl_reg_loss: 23410.1092; train_edge_recon_loss: 2649256.4167; train_gene_expr_recon_loss: 255619.8715; train_masked_gp_l1_reg_loss: 1808.4073; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1021699.8819; train_global_loss: 3951794.6944; train_optim_loss: 3951794.6944; val_kl_reg_loss: 23127.9219; val_edge_recon_loss: 2672569.2500; val_gene_expr_recon_loss: 254910.3750; val_masked_gp_l1_reg_loss: 1831.4055; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027354.2500; val_global_loss: 3979793.2500; val_optim_loss: 3979793.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9710; val_auprc_score: 0.9599; val_best_acc_score: 0.9237; val_best_f1_score: 0.9272; train_kl_reg_loss: 23523.8045; train_edge_recon_loss: 2653379.1667; train_gene_expr_recon_loss: 252523.7812; train_masked_gp_l1_reg_loss: 1858.3969; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1013012.3958; train_global_loss: 3944297.6111; train_optim_loss: 3944297.6111; val_kl_reg_loss: 23047.2559; val_edge_recon_loss: 2671215.2500; val_gene_expr_recon_loss: 258223.7500; val_masked_gp_l1_reg_loss: 1885.6575; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1028845.7500; val_global_loss: 3983217.7500; val_optim_loss: 3983217.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9704; val_auprc_score: 0.9595; val_best_acc_score: 0.9266; val_best_f1_score: 0.9298; train_kl_reg_loss: 23173.8763; train_edge_recon_loss: 2648648.7500; train_gene_expr_recon_loss: 251300.7413; train_masked_gp_l1_reg_loss: 1904.6981; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1010774.0417; train_global_loss: 3935802.1111; train_optim_loss: 3935802.1111; val_kl_reg_loss: 23423.8906; val_edge_recon_loss: 2652918.7500; val_gene_expr_recon_loss: 251372.2812; val_masked_gp_l1_reg_loss: 1922.1875; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1023069.5000; val_global_loss: 3952706.7500; val_optim_loss: 3952706.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9710; val_auprc_score: 0.9602; val_best_acc_score: 0.9290; val_best_f1_score: 0.9310; train_kl_reg_loss: 23487.9779; train_edge_recon_loss: 2652132.0833; train_gene_expr_recon_loss: 249257.1458; train_masked_gp_l1_reg_loss: 1941.3369; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1006408.9306; train_global_loss: 3933227.5000; train_optim_loss: 3933227.5000; val_kl_reg_loss: 22863.9766; val_edge_recon_loss: 2660319.2500; val_gene_expr_recon_loss: 252575.7344; val_masked_gp_l1_reg_loss: 1961.5967; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1024416.0625; val_global_loss: 3962136.5000; val_optim_loss: 3962136.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9701; val_auprc_score: 0.9576; val_best_acc_score: 0.9240; val_best_f1_score: 0.9274; train_kl_reg_loss: 23186.3802; train_edge_recon_loss: 2638625.0833; train_gene_expr_recon_loss: 248907.9045; train_masked_gp_l1_reg_loss: 1980.0586; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1012707.9375; train_global_loss: 3925407.3889; train_optim_loss: 3925407.3889; val_kl_reg_loss: 23279.5352; val_edge_recon_loss: 2661343.5000; val_gene_expr_recon_loss: 252269.7812; val_masked_gp_l1_reg_loss: 1997.8306; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1023283.8750; val_global_loss: 3962174.5000; val_optim_loss: 3962174.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9697; val_auprc_score: 0.9588; val_best_acc_score: 0.9248; val_best_f1_score: 0.9284; train_kl_reg_loss: 23753.2272; train_edge_recon_loss: 2630994.4722; train_gene_expr_recon_loss: 246984.4497; train_masked_gp_l1_reg_loss: 2013.4156; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007071.1458; train_global_loss: 3910816.6944; train_optim_loss: 3910816.6944; val_kl_reg_loss: 23543.0742; val_edge_recon_loss: 2670451.0000; val_gene_expr_recon_loss: 247240.5938; val_masked_gp_l1_reg_loss: 2032.4231; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1019790.3125; val_global_loss: 3963057.2500; val_optim_loss: 3963057.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9732; val_auprc_score: 0.9642; val_best_acc_score: 0.9321; val_best_f1_score: 0.9349; train_kl_reg_loss: 23503.6905; train_edge_recon_loss: 2634027.1111; train_gene_expr_recon_loss: 245826.2552; train_masked_gp_l1_reg_loss: 2050.5183; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003760.9514; train_global_loss: 3909168.4722; train_optim_loss: 3909168.4722; val_kl_reg_loss: 23196.4141; val_edge_recon_loss: 2643585.2500; val_gene_expr_recon_loss: 248391.7031; val_masked_gp_l1_reg_loss: 2069.8240; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1019030.5625; val_global_loss: 3936273.7500; val_optim_loss: 3936273.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9718; val_auprc_score: 0.9607; val_best_acc_score: 0.9313; val_best_f1_score: 0.9336; train_kl_reg_loss: 23791.9605; train_edge_recon_loss: 2633587.0833; train_gene_expr_recon_loss: 244152.3976; train_masked_gp_l1_reg_loss: 2086.5843; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005484.7361; train_global_loss: 3909102.7222; train_optim_loss: 3909102.7222; val_kl_reg_loss: 23769.0430; val_edge_recon_loss: 2634040.0000; val_gene_expr_recon_loss: 246846.5469; val_masked_gp_l1_reg_loss: 2102.9956; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1017552.8125; val_global_loss: 3924311.2500; val_optim_loss: 3924311.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9732; val_auprc_score: 0.9581; val_best_acc_score: 0.9332; val_best_f1_score: 0.9357; train_kl_reg_loss: 23869.1317; train_edge_recon_loss: 2643339.5000; train_gene_expr_recon_loss: 243082.1233; train_masked_gp_l1_reg_loss: 2120.3627; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1004692.0972; train_global_loss: 3917103.1944; train_optim_loss: 3917103.1944; val_kl_reg_loss: 23702.0000; val_edge_recon_loss: 2633782.7500; val_gene_expr_recon_loss: 246161.9375; val_masked_gp_l1_reg_loss: 2138.2495; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1017783.6875; val_global_loss: 3923568.7500; val_optim_loss: 3923568.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9688; val_auprc_score: 0.9553; val_best_acc_score: 0.9270; val_best_f1_score: 0.9302; train_kl_reg_loss: 23529.8609; train_edge_recon_loss: 2645860.8889; train_gene_expr_recon_loss: 258342.9444; train_masked_gp_l1_reg_loss: 2154.1358; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1013256.9583; train_global_loss: 3943144.7778; train_optim_loss: 3943144.7778; val_kl_reg_loss: 9588.7627; val_edge_recon_loss: 2659143.5000; val_gene_expr_recon_loss: 258629.1719; val_masked_gp_l1_reg_loss: 2165.3828; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027783.4375; val_global_loss: 3957310.5000; val_optim_loss: 3957310.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9744; val_auprc_score: 0.9635; val_best_acc_score: 0.9322; val_best_f1_score: 0.9349; train_kl_reg_loss: 22571.5480; train_edge_recon_loss: 2624425.4722; train_gene_expr_recon_loss: 257709.4705; train_masked_gp_l1_reg_loss: 2165.8079; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1021648.4028; train_global_loss: 3928520.7500; train_optim_loss: 3928520.7500; val_kl_reg_loss: 8614.1006; val_edge_recon_loss: 2643710.7500; val_gene_expr_recon_loss: 257928.0938; val_masked_gp_l1_reg_loss: 2164.2136; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1029962.8125; val_global_loss: 3942379.7500; val_optim_loss: 3942379.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9743; val_auprc_score: 0.9668; val_best_acc_score: 0.9338; val_best_f1_score: 0.9362; train_kl_reg_loss: 19853.1024; train_edge_recon_loss: 2627819.1389; train_gene_expr_recon_loss: 255796.5087; train_masked_gp_l1_reg_loss: 2165.0399; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1016327.6736; train_global_loss: 3921961.4444; train_optim_loss: 3921961.4444; val_kl_reg_loss: 8598.6914; val_edge_recon_loss: 2638580.5000; val_gene_expr_recon_loss: 258626.3125; val_masked_gp_l1_reg_loss: 2164.8794; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1028688.2500; val_global_loss: 3936658.7500; val_optim_loss: 3936658.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9731; val_auprc_score: 0.9629; val_best_acc_score: 0.9329; val_best_f1_score: 0.9353; train_kl_reg_loss: 19030.6936; train_edge_recon_loss: 2622431.5833; train_gene_expr_recon_loss: 254851.2465; train_masked_gp_l1_reg_loss: 2164.0281; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1016365.3542; train_global_loss: 3914842.9167; train_optim_loss: 3914842.9167; val_kl_reg_loss: 8247.2715; val_edge_recon_loss: 2628235.2500; val_gene_expr_recon_loss: 258700.5469; val_masked_gp_l1_reg_loss: 2162.7979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1030308.9375; val_global_loss: 3927654.7500; val_optim_loss: 3927654.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9743; val_auprc_score: 0.9635; val_best_acc_score: 0.9351; val_best_f1_score: 0.9373; train_kl_reg_loss: 18014.0866; train_edge_recon_loss: 2622626.6389; train_gene_expr_recon_loss: 252539.3854; train_masked_gp_l1_reg_loss: 2158.6140; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1011201.2500; train_global_loss: 3906540.0278; train_optim_loss: 3906540.0278; val_kl_reg_loss: 8341.7549; val_edge_recon_loss: 2626726.7500; val_gene_expr_recon_loss: 256206.7812; val_masked_gp_l1_reg_loss: 2153.5251; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1025974.6875; val_global_loss: 3919403.5000; val_optim_loss: 3919403.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9760; val_auprc_score: 0.9674; val_best_acc_score: 0.9357; val_best_f1_score: 0.9380; train_kl_reg_loss: 18208.0597; train_edge_recon_loss: 2630038.5833; train_gene_expr_recon_loss: 252165.8542; train_masked_gp_l1_reg_loss: 2151.4057; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1010011.8681; train_global_loss: 3912575.8056; train_optim_loss: 3912575.8056; val_kl_reg_loss: 8268.1602; val_edge_recon_loss: 2633646.5000; val_gene_expr_recon_loss: 257500.8594; val_masked_gp_l1_reg_loss: 2148.7671; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027461.9375; val_global_loss: 3929026.2500; val_optim_loss: 3929026.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9759; val_auprc_score: 0.9627; val_best_acc_score: 0.9375; val_best_f1_score: 0.9396; train_kl_reg_loss: 17815.3789; train_edge_recon_loss: 2616443.5000; train_gene_expr_recon_loss: 253597.4566; train_masked_gp_l1_reg_loss: 2147.0471; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1017786.2361; train_global_loss: 3907789.5833; train_optim_loss: 3907789.5833; val_kl_reg_loss: 8196.8945; val_edge_recon_loss: 2644354.0000; val_gene_expr_recon_loss: 255854.4219; val_masked_gp_l1_reg_loss: 2145.0801; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026136.7500; val_global_loss: 3936687.2500; val_optim_loss: 3936687.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9753; val_auprc_score: 0.9678; val_best_acc_score: 0.9345; val_best_f1_score: 0.9362; train_kl_reg_loss: 17674.4842; train_edge_recon_loss: 2618591.2778; train_gene_expr_recon_loss: 251605.2847; train_masked_gp_l1_reg_loss: 2144.0427; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1015168.3958; train_global_loss: 3905183.5556; train_optim_loss: 3905183.5556; val_kl_reg_loss: 8156.0215; val_edge_recon_loss: 2642700.0000; val_gene_expr_recon_loss: 257452.2812; val_masked_gp_l1_reg_loss: 2142.9783; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1028943.4375; val_global_loss: 3939394.7500; val_optim_loss: 3939394.7500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9757; val_auprc_score: 0.9671; val_best_acc_score: 0.9329; val_best_f1_score: 0.9352; train_kl_reg_loss: 17457.5143; train_edge_recon_loss: 2619753.3056; train_gene_expr_recon_loss: 252871.4497; train_masked_gp_l1_reg_loss: 2142.2718; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014664.9861; train_global_loss: 3906889.5000; train_optim_loss: 3906889.5000; val_kl_reg_loss: 8126.1416; val_edge_recon_loss: 2649366.7500; val_gene_expr_recon_loss: 256354.0781; val_masked_gp_l1_reg_loss: 2141.4346; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026342.6250; val_global_loss: 3942331.0000; val_optim_loss: 3942331.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9765; val_auprc_score: 0.9664; val_best_acc_score: 0.9356; val_best_f1_score: 0.9376; train_kl_reg_loss: 17631.3572; train_edge_recon_loss: 2620183.7778; train_gene_expr_recon_loss: 252872.8403; train_masked_gp_l1_reg_loss: 2140.9924; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1020973.2431; train_global_loss: 3913802.2222; train_optim_loss: 3913802.2222; val_kl_reg_loss: 8085.7646; val_edge_recon_loss: 2632705.0000; val_gene_expr_recon_loss: 256481.5469; val_masked_gp_l1_reg_loss: 2140.5239; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026730.2500; val_global_loss: 3926143.0000; val_optim_loss: 3926143.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9745; val_auprc_score: 0.9632; val_best_acc_score: 0.9334; val_best_f1_score: 0.9366; train_kl_reg_loss: 17459.5289; train_edge_recon_loss: 2614206.2500; train_gene_expr_recon_loss: 251085.7587; train_masked_gp_l1_reg_loss: 2140.3998; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1012870.0764; train_global_loss: 3897762.0833; train_optim_loss: 3897762.0833; val_kl_reg_loss: 8151.8457; val_edge_recon_loss: 2625954.5000; val_gene_expr_recon_loss: 256792.3125; val_masked_gp_l1_reg_loss: 2140.1951; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027935.2500; val_global_loss: 3920974.0000; val_optim_loss: 3920974.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9742; val_auprc_score: 0.9649; val_best_acc_score: 0.9318; val_best_f1_score: 0.9349; train_kl_reg_loss: 17463.3364; train_edge_recon_loss: 2618660.4444; train_gene_expr_recon_loss: 251982.7170; train_masked_gp_l1_reg_loss: 2140.0518; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1012231.0903; train_global_loss: 3902477.5833; train_optim_loss: 3902477.5833; val_kl_reg_loss: 8161.4683; val_edge_recon_loss: 2642943.7500; val_gene_expr_recon_loss: 256964.8750; val_masked_gp_l1_reg_loss: 2139.8904; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1028030.8750; val_global_loss: 3938241.0000; val_optim_loss: 3938241.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9764; val_auprc_score: 0.9651; val_best_acc_score: 0.9388; val_best_f1_score: 0.9412; train_kl_reg_loss: 17503.8372; train_edge_recon_loss: 2618656.9444; train_gene_expr_recon_loss: 254323.4514; train_masked_gp_l1_reg_loss: 2139.7839; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1019743.5903; train_global_loss: 3912367.5833; train_optim_loss: 3912367.5833; val_kl_reg_loss: 8135.7290; val_edge_recon_loss: 2609388.7500; val_gene_expr_recon_loss: 256585.4844; val_masked_gp_l1_reg_loss: 2139.6677; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026019.8750; val_global_loss: 3902269.5000; val_optim_loss: 3902269.5000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9759; val_auprc_score: 0.9661; val_best_acc_score: 0.9394; val_best_f1_score: 0.9413; train_kl_reg_loss: 17544.0241; train_edge_recon_loss: 2615681.2222; train_gene_expr_recon_loss: 252435.4236; train_masked_gp_l1_reg_loss: 2139.6013; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014718.2083; train_global_loss: 3902518.4444; train_optim_loss: 3902518.4444; val_kl_reg_loss: 8148.0029; val_edge_recon_loss: 2630714.5000; val_gene_expr_recon_loss: 256669.9375; val_masked_gp_l1_reg_loss: 2139.5142; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026868.3125; val_global_loss: 3924540.2500; val_optim_loss: 3924540.2500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9751; val_auprc_score: 0.9635; val_best_acc_score: 0.9363; val_best_f1_score: 0.9389; train_kl_reg_loss: 17410.9612; train_edge_recon_loss: 2617436.0833; train_gene_expr_recon_loss: 253530.2118; train_masked_gp_l1_reg_loss: 2139.4519; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1015585.4653; train_global_loss: 3906102.2500; train_optim_loss: 3906102.2500; val_kl_reg_loss: 8105.7393; val_edge_recon_loss: 2627084.2500; val_gene_expr_recon_loss: 256516.2656; val_masked_gp_l1_reg_loss: 2139.3701; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027128.7500; val_global_loss: 3920974.2500; val_optim_loss: 3920974.2500
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9783; val_auprc_score: 0.9696; val_best_acc_score: 0.9388; val_best_f1_score: 0.9413; train_kl_reg_loss: 17324.4223; train_edge_recon_loss: 2622642.4722; train_gene_expr_recon_loss: 252632.7899; train_masked_gp_l1_reg_loss: 2139.3054; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1017422.8750; train_global_loss: 3912161.8611; train_optim_loss: 3912161.8611; val_kl_reg_loss: 8164.6865; val_edge_recon_loss: 2620742.0000; val_gene_expr_recon_loss: 256679.5781; val_masked_gp_l1_reg_loss: 2139.2283; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027452.3125; val_global_loss: 3915177.7500; val_optim_loss: 3915177.7500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9777; val_auprc_score: 0.9707; val_best_acc_score: 0.9375; val_best_f1_score: 0.9396; train_kl_reg_loss: 17357.3277; train_edge_recon_loss: 2626997.8333; train_gene_expr_recon_loss: 252921.4358; train_masked_gp_l1_reg_loss: 2139.1713; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1012003.0972; train_global_loss: 3911418.9167; train_optim_loss: 3911418.9167; val_kl_reg_loss: 8033.4697; val_edge_recon_loss: 2643384.7500; val_gene_expr_recon_loss: 256435.5781; val_masked_gp_l1_reg_loss: 2139.1001; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1025791.5000; val_global_loss: 3935784.2500; val_optim_loss: 3935784.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9755; val_auprc_score: 0.9663; val_best_acc_score: 0.9344; val_best_f1_score: 0.9367; train_kl_reg_loss: 17387.7921; train_edge_recon_loss: 2627764.7778; train_gene_expr_recon_loss: 252553.8889; train_masked_gp_l1_reg_loss: 2139.0575; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1015039.2986; train_global_loss: 3914884.7500; train_optim_loss: 3914884.7500; val_kl_reg_loss: 8055.5508; val_edge_recon_loss: 2640448.2500; val_gene_expr_recon_loss: 256580.7969; val_masked_gp_l1_reg_loss: 2139.0176; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026675.0625; val_global_loss: 3933898.5000; val_optim_loss: 3933898.5000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9780; val_auprc_score: 0.9705; val_best_acc_score: 0.9371; val_best_f1_score: 0.9399; train_kl_reg_loss: 17511.3989; train_edge_recon_loss: 2622282.7500; train_gene_expr_recon_loss: 253576.5486; train_masked_gp_l1_reg_loss: 2139.0060; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1022098.8194; train_global_loss: 3917608.5278; train_optim_loss: 3917608.5278; val_kl_reg_loss: 8064.3521; val_edge_recon_loss: 2636013.2500; val_gene_expr_recon_loss: 256705.1562; val_masked_gp_l1_reg_loss: 2138.9871; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1027554.9375; val_global_loss: 3930476.7500; val_optim_loss: 3930476.7500
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9763; val_auprc_score: 0.9685; val_best_acc_score: 0.9347; val_best_f1_score: 0.9370; train_kl_reg_loss: 17406.6343; train_edge_recon_loss: 2622960.5000; train_gene_expr_recon_loss: 252992.4931; train_masked_gp_l1_reg_loss: 2138.9764; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014292.6736; train_global_loss: 3909791.3056; train_optim_loss: 3909791.3056; val_kl_reg_loss: 8029.1011; val_edge_recon_loss: 2625086.5000; val_gene_expr_recon_loss: 256456.7344; val_masked_gp_l1_reg_loss: 2138.9644; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026219.8125; val_global_loss: 3917931.0000; val_optim_loss: 3917931.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9785; val_auprc_score: 0.9701; val_best_acc_score: 0.9340; val_best_f1_score: 0.9368; train_kl_reg_loss: 17414.4920; train_edge_recon_loss: 2624645.8056; train_gene_expr_recon_loss: 252545.0260; train_masked_gp_l1_reg_loss: 2138.9570; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014074.4514; train_global_loss: 3910818.7222; train_optim_loss: 3910818.7222; val_kl_reg_loss: 8050.5586; val_edge_recon_loss: 2627299.2500; val_gene_expr_recon_loss: 256458.8750; val_masked_gp_l1_reg_loss: 2138.9480; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1025200.0000; val_global_loss: 3919147.5000; val_optim_loss: 3919147.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 42 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9754
Val AUPRC score: 0.9632
Val best accuracy score: 0.9360
Val best F1 score: 0.9383
Val gene expr MSE score: 0.6050
Val chrom access MSE score: 0.0906
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
