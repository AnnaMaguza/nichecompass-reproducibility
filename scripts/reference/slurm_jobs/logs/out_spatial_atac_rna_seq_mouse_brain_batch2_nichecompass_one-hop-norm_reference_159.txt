[True]
Run timestamp: 29072023_133949_159.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_159']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8823; val_auprc_score: 0.8999; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 6969.2594; train_edge_recon_loss: 34754123.5556; train_gene_expr_recon_loss: 76765516.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 182689482.6667; train_global_loss: 294216096.0000; train_optim_loss: 294216096.0000; val_kl_reg_loss: 9047.9443; val_edge_recon_loss: 40650852.0000; val_gene_expr_recon_loss: 64904024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 175652096.0000; val_global_loss: 281216000.0000; val_optim_loss: 281216000.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8820; val_auprc_score: 0.9016; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 20738.8472; train_edge_recon_loss: 34859057.7778; train_gene_expr_recon_loss: 63390702.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 176716469.3333; train_global_loss: 274986965.3333; train_optim_loss: 274986965.3333; val_kl_reg_loss: 22035.0391; val_edge_recon_loss: 40657520.0000; val_gene_expr_recon_loss: 63473036.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 171650944.0000; val_global_loss: 275803520.0000; val_optim_loss: 275803520.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8748; val_auprc_score: 0.8928; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 76408.9214; train_edge_recon_loss: 34872988.4444; train_gene_expr_recon_loss: 62909646.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 170747991.1111; train_global_loss: 268607040.0000; train_optim_loss: 268607040.0000; val_kl_reg_loss: 48177.3633; val_edge_recon_loss: 40658340.0000; val_gene_expr_recon_loss: 62305068.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 168575376.0000; val_global_loss: 271586944.0000; val_optim_loss: 271586944.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8745; val_auprc_score: 0.8919; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 233687.2535; train_edge_recon_loss: 34826767.1111; train_gene_expr_recon_loss: 59615470.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 168584867.5556; train_global_loss: 263260789.3333; train_optim_loss: 263260789.3333; val_kl_reg_loss: 172758.1875; val_edge_recon_loss: 40660344.0000; val_gene_expr_recon_loss: 57189736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 167542112.0000; val_global_loss: 265564960.0000; val_optim_loss: 265564960.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8766; val_auprc_score: 0.8862; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 273119.3194; train_edge_recon_loss: 34831768.0000; train_gene_expr_recon_loss: 55714765.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 168236554.6667; train_global_loss: 259056204.4444; train_optim_loss: 259056204.4444; val_kl_reg_loss: 304508.2500; val_edge_recon_loss: 40659976.0000; val_gene_expr_recon_loss: 54519676.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 165537088.0000; val_global_loss: 261021248.0000; val_optim_loss: 261021248.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8717; val_auprc_score: 0.8825; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 318799.0677; train_edge_recon_loss: 34853888.4444; train_gene_expr_recon_loss: 53947843.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 165067852.4444; train_global_loss: 254188384.0000; train_optim_loss: 254188384.0000; val_kl_reg_loss: 325623.5000; val_edge_recon_loss: 40659952.0000; val_gene_expr_recon_loss: 52738540.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 163321760.0000; val_global_loss: 257045872.0000; val_optim_loss: 257045872.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8620; val_auprc_score: 0.8643; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 390421.7188; train_edge_recon_loss: 34845474.6667; train_gene_expr_recon_loss: 51244669.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 163598679.1111; train_global_loss: 250079242.6667; train_optim_loss: 250079242.6667; val_kl_reg_loss: 265992.6250; val_edge_recon_loss: 40659216.0000; val_gene_expr_recon_loss: 49971392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162233120.0000; val_global_loss: 253129728.0000; val_optim_loss: 253129728.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8529; val_auprc_score: 0.8616; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 409331.5590; train_edge_recon_loss: 34863384.4444; train_gene_expr_recon_loss: 48587357.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 162412433.7778; train_global_loss: 246272508.4444; train_optim_loss: 246272508.4444; val_kl_reg_loss: 342273.8125; val_edge_recon_loss: 40658048.0000; val_gene_expr_recon_loss: 47959548.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 160588224.0000; val_global_loss: 249548096.0000; val_optim_loss: 249548096.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8396; val_auprc_score: 0.8439; val_best_acc_score: 0.5019; val_best_f1_score: 0.6675; train_kl_reg_loss: 421671.0174; train_edge_recon_loss: 34887150.2222; train_gene_expr_recon_loss: 46614806.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160815146.6667; train_global_loss: 242738773.3333; train_optim_loss: 242738773.3333; val_kl_reg_loss: 333019.3750; val_edge_recon_loss: 40656260.0000; val_gene_expr_recon_loss: 46112192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159232000.0000; val_global_loss: 246333472.0000; val_optim_loss: 246333472.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8301; val_auprc_score: 0.8348; val_best_acc_score: 0.5031; val_best_f1_score: 0.6680; train_kl_reg_loss: 442041.9236; train_edge_recon_loss: 34910516.0000; train_gene_expr_recon_loss: 45187796.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 159222851.5556; train_global_loss: 239763207.1111; train_optim_loss: 239763207.1111; val_kl_reg_loss: 346123.4688; val_edge_recon_loss: 40655072.0000; val_gene_expr_recon_loss: 44377640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 157703008.0000; val_global_loss: 243081840.0000; val_optim_loss: 243081840.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8225; val_auprc_score: 0.8337; val_best_acc_score: 0.5079; val_best_f1_score: 0.6702; train_kl_reg_loss: 441842.0764; train_edge_recon_loss: 34898966.6667; train_gene_expr_recon_loss: 43649982.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 158588304.0000; train_global_loss: 237579095.1111; train_optim_loss: 237579095.1111; val_kl_reg_loss: 283689.1250; val_edge_recon_loss: 40652404.0000; val_gene_expr_recon_loss: 43272940.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156798816.0000; val_global_loss: 241007840.0000; val_optim_loss: 241007840.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8193; val_auprc_score: 0.8237; val_best_acc_score: 0.5106; val_best_f1_score: 0.6714; train_kl_reg_loss: 405754.4444; train_edge_recon_loss: 34937894.6667; train_gene_expr_recon_loss: 42356818.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156340643.5556; train_global_loss: 234041111.1111; train_optim_loss: 234041111.1111; val_kl_reg_loss: 322836.3750; val_edge_recon_loss: 40650164.0000; val_gene_expr_recon_loss: 42113932.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156039456.0000; val_global_loss: 239126384.0000; val_optim_loss: 239126384.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8081; val_auprc_score: 0.8139; val_best_acc_score: 0.5146; val_best_f1_score: 0.6731; train_kl_reg_loss: 415862.9549; train_edge_recon_loss: 34913803.1111; train_gene_expr_recon_loss: 41378746.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155752572.4444; train_global_loss: 232460988.4444; train_optim_loss: 232460988.4444; val_kl_reg_loss: 326098.7500; val_edge_recon_loss: 40648000.0000; val_gene_expr_recon_loss: 41299216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155182656.0000; val_global_loss: 237455968.0000; val_optim_loss: 237455968.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7963; val_auprc_score: 0.8002; val_best_acc_score: 0.5218; val_best_f1_score: 0.6764; train_kl_reg_loss: 408601.3819; train_edge_recon_loss: 34912676.0000; train_gene_expr_recon_loss: 40869088.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156000416.0000; train_global_loss: 232190782.2222; train_optim_loss: 232190782.2222; val_kl_reg_loss: 270348.1562; val_edge_recon_loss: 40644380.0000; val_gene_expr_recon_loss: 40720640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154186352.0000; val_global_loss: 235821728.0000; val_optim_loss: 235821728.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7983; val_auprc_score: 0.8022; val_best_acc_score: 0.5243; val_best_f1_score: 0.6774; train_kl_reg_loss: 389385.2882; train_edge_recon_loss: 34921383.1111; train_gene_expr_recon_loss: 40437052.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155499228.4444; train_global_loss: 231247048.8889; train_optim_loss: 231247048.8889; val_kl_reg_loss: 295479.3750; val_edge_recon_loss: 40642148.0000; val_gene_expr_recon_loss: 40342648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154094144.0000; val_global_loss: 235374416.0000; val_optim_loss: 235374416.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7949; val_auprc_score: 0.7979; val_best_acc_score: 0.5279; val_best_f1_score: 0.6790; train_kl_reg_loss: 386845.1215; train_edge_recon_loss: 34930584.8889; train_gene_expr_recon_loss: 39783748.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153981073.7778; train_global_loss: 229082252.4444; train_optim_loss: 229082252.4444; val_kl_reg_loss: 281611.5625; val_edge_recon_loss: 40639404.0000; val_gene_expr_recon_loss: 39915928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153570320.0000; val_global_loss: 234407264.0000; val_optim_loss: 234407264.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7978; val_auprc_score: 0.8004; val_best_acc_score: 0.5299; val_best_f1_score: 0.6798; train_kl_reg_loss: 372706.9271; train_edge_recon_loss: 34907353.7778; train_gene_expr_recon_loss: 39370948.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154835155.5556; train_global_loss: 229486167.1111; train_optim_loss: 229486167.1111; val_kl_reg_loss: 319693.1250; val_edge_recon_loss: 40637188.0000; val_gene_expr_recon_loss: 39553400.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153218016.0000; val_global_loss: 233728288.0000; val_optim_loss: 233728288.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8001; val_auprc_score: 0.8020; val_best_acc_score: 0.5403; val_best_f1_score: 0.6843; train_kl_reg_loss: 370462.0382; train_edge_recon_loss: 34901806.2222; train_gene_expr_recon_loss: 39264588.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153791712.0000; train_global_loss: 228328568.8889; train_optim_loss: 228328568.8889; val_kl_reg_loss: 278768.3750; val_edge_recon_loss: 40630280.0000; val_gene_expr_recon_loss: 39373904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152926976.0000; val_global_loss: 233209920.0000; val_optim_loss: 233209920.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8105; val_auprc_score: 0.8123; val_best_acc_score: 0.5499; val_best_f1_score: 0.6884; train_kl_reg_loss: 365384.5104; train_edge_recon_loss: 34900119.1111; train_gene_expr_recon_loss: 39041656.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153316026.6667; train_global_loss: 227623187.5556; train_optim_loss: 227623187.5556; val_kl_reg_loss: 267872.1250; val_edge_recon_loss: 40624056.0000; val_gene_expr_recon_loss: 39240664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152801856.0000; val_global_loss: 232934448.0000; val_optim_loss: 232934448.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8110; val_auprc_score: 0.8135; val_best_acc_score: 0.5530; val_best_f1_score: 0.6896; train_kl_reg_loss: 356346.4132; train_edge_recon_loss: 34901574.2222; train_gene_expr_recon_loss: 38832755.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153356865.7778; train_global_loss: 227447539.5556; train_optim_loss: 227447539.5556; val_kl_reg_loss: 295698.5625; val_edge_recon_loss: 40622108.0000; val_gene_expr_recon_loss: 39040568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152481952.0000; val_global_loss: 232440320.0000; val_optim_loss: 232440320.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8156; val_auprc_score: 0.8161; val_best_acc_score: 0.5744; val_best_f1_score: 0.6992; train_kl_reg_loss: 356696.9896; train_edge_recon_loss: 34887012.8889; train_gene_expr_recon_loss: 38842080.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153206040.8889; train_global_loss: 227291831.1111; train_optim_loss: 227291831.1111; val_kl_reg_loss: 230259.3125; val_edge_recon_loss: 40609264.0000; val_gene_expr_recon_loss: 39028984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152469888.0000; val_global_loss: 232338400.0000; val_optim_loss: 232338400.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8308; val_auprc_score: 0.8283; val_best_acc_score: 0.5763; val_best_f1_score: 0.6996; train_kl_reg_loss: 341927.5851; train_edge_recon_loss: 34911207.1111; train_gene_expr_recon_loss: 38859709.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152865944.8889; train_global_loss: 226978789.3333; train_optim_loss: 226978789.3333; val_kl_reg_loss: 275445.3125; val_edge_recon_loss: 40605880.0000; val_gene_expr_recon_loss: 38791624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152317664.0000; val_global_loss: 231990608.0000; val_optim_loss: 231990608.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8411; val_auprc_score: 0.8389; val_best_acc_score: 0.5954; val_best_f1_score: 0.7087; train_kl_reg_loss: 342286.3125; train_edge_recon_loss: 34871555.5556; train_gene_expr_recon_loss: 38441300.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152823448.8889; train_global_loss: 226478592.0000; train_optim_loss: 226478592.0000; val_kl_reg_loss: 275050.2812; val_edge_recon_loss: 40593280.0000; val_gene_expr_recon_loss: 38678624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152175584.0000; val_global_loss: 231722544.0000; val_optim_loss: 231722544.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8394; val_auprc_score: 0.8360; val_best_acc_score: 0.6339; val_best_f1_score: 0.7269; train_kl_reg_loss: 329779.6424; train_edge_recon_loss: 34879546.2222; train_gene_expr_recon_loss: 38563152.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152111623.1111; train_global_loss: 225884103.1111; train_optim_loss: 225884103.1111; val_kl_reg_loss: 224150.6562; val_edge_recon_loss: 40569692.0000; val_gene_expr_recon_loss: 38695664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152104928.0000; val_global_loss: 231594432.0000; val_optim_loss: 231594432.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8550; val_auprc_score: 0.8502; val_best_acc_score: 0.6645; val_best_f1_score: 0.7425; train_kl_reg_loss: 328543.3125; train_edge_recon_loss: 34876664.8889; train_gene_expr_recon_loss: 38481766.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152693886.2222; train_global_loss: 226380862.2222; train_optim_loss: 226380862.2222; val_kl_reg_loss: 235972.2500; val_edge_recon_loss: 40549712.0000; val_gene_expr_recon_loss: 38581552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151866528.0000; val_global_loss: 231233760.0000; val_optim_loss: 231233760.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8582; val_auprc_score: 0.8576; val_best_acc_score: 0.5333; val_best_f1_score: 0.6813; train_kl_reg_loss: 405743.4366; train_edge_recon_loss: 37934912.0000; train_gene_expr_recon_loss: 40449426.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153112773.3333; train_global_loss: 231902855.1111; train_optim_loss: 231902855.1111; val_kl_reg_loss: 54639.3867; val_edge_recon_loss: 40630592.0000; val_gene_expr_recon_loss: 39990452.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152517280.0000; val_global_loss: 233192960.0000; val_optim_loss: 233192960.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8442; val_auprc_score: 0.8420; val_best_acc_score: 0.5478; val_best_f1_score: 0.6881; train_kl_reg_loss: 101741.7713; train_edge_recon_loss: 37121412.4444; train_gene_expr_recon_loss: 41986601.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154221281.7778; train_global_loss: 233431036.4444; train_optim_loss: 233431036.4444; val_kl_reg_loss: 14438.7676; val_edge_recon_loss: 40625356.0000; val_gene_expr_recon_loss: 42404768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154903392.0000; val_global_loss: 237947952.0000; val_optim_loss: 237947952.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8625; val_auprc_score: 0.8618; val_best_acc_score: 0.5295; val_best_f1_score: 0.6796; train_kl_reg_loss: 86438.5552; train_edge_recon_loss: 35692347.1111; train_gene_expr_recon_loss: 40380315.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153711198.2222; train_global_loss: 229870300.4444; train_optim_loss: 229870300.4444; val_kl_reg_loss: 93222.6641; val_edge_recon_loss: 40633960.0000; val_gene_expr_recon_loss: 39612552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152620080.0000; val_global_loss: 232959808.0000; val_optim_loss: 232959808.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8562; val_auprc_score: 0.8554; val_best_acc_score: 0.5232; val_best_f1_score: 0.6767; train_kl_reg_loss: 214033.7517; train_edge_recon_loss: 35300555.1111; train_gene_expr_recon_loss: 39487926.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152809507.5556; train_global_loss: 227812023.1111; train_optim_loss: 227812023.1111; val_kl_reg_loss: 303796.6562; val_edge_recon_loss: 40639544.0000; val_gene_expr_recon_loss: 39185608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152045616.0000; val_global_loss: 232174560.0000; val_optim_loss: 232174560.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8622; val_auprc_score: 0.8638; val_best_acc_score: 0.5264; val_best_f1_score: 0.6782; train_kl_reg_loss: 326026.2049; train_edge_recon_loss: 35171772.4444; train_gene_expr_recon_loss: 38883163.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152253877.3333; train_global_loss: 226634837.3333; train_optim_loss: 226634837.3333; val_kl_reg_loss: 275859.6562; val_edge_recon_loss: 40638540.0000; val_gene_expr_recon_loss: 39102712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151895328.0000; val_global_loss: 231912448.0000; val_optim_loss: 231912448.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8587; val_auprc_score: 0.8602; val_best_acc_score: 0.5248; val_best_f1_score: 0.6775; train_kl_reg_loss: 264174.6476; train_edge_recon_loss: 35271986.6667; train_gene_expr_recon_loss: 38960412.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152471169.7778; train_global_loss: 226967744.0000; train_optim_loss: 226967744.0000; val_kl_reg_loss: 237550.3906; val_edge_recon_loss: 40639612.0000; val_gene_expr_recon_loss: 39097232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151969280.0000; val_global_loss: 231943680.0000; val_optim_loss: 231943680.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8559; val_auprc_score: 0.8573; val_best_acc_score: 0.5263; val_best_f1_score: 0.6781; train_kl_reg_loss: 262826.7778; train_edge_recon_loss: 35316710.2222; train_gene_expr_recon_loss: 39133895.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153558074.6667; train_global_loss: 228271507.5556; train_optim_loss: 228271507.5556; val_kl_reg_loss: 253517.8438; val_edge_recon_loss: 40638368.0000; val_gene_expr_recon_loss: 39004452.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151712736.0000; val_global_loss: 231609072.0000; val_optim_loss: 231609072.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8567; val_auprc_score: 0.8607; val_best_acc_score: 0.5248; val_best_f1_score: 0.6775; train_kl_reg_loss: 270997.3056; train_edge_recon_loss: 35279157.3333; train_gene_expr_recon_loss: 38580042.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151490499.5556; train_global_loss: 225620700.4444; train_optim_loss: 225620700.4444; val_kl_reg_loss: 249282.6562; val_edge_recon_loss: 40638928.0000; val_gene_expr_recon_loss: 38973216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151922112.0000; val_global_loss: 231783536.0000; val_optim_loss: 231783536.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 42 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8451
val AUPRC score: 0.8382
val best accuracy score: 0.6424
val best F1 score: 0.7313
val target rna MSE score: 8.2440
val source rna MSE score: 1.5071
val target atac MSE score: 0.1199
val source atac MSE score: 0.0162
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
