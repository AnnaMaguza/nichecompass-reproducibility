[True]
Run timestamp: 10102023_053502_159.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_159']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6931; val_auprc_score: 0.6661; val_best_acc_score: 0.5003; val_best_f1_score: 0.6667; train_kl_reg_loss: 79939.5772; train_edge_recon_loss: 751229.1723; train_gene_expr_recon_loss: 23224721.0909; train_masked_gp_l1_reg_loss: 57545.7334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6199769.7879; train_chrom_access_recon_loss: 2319014.4659; train_global_loss: 32632220.1212; train_optim_loss: 32632220.1212; val_kl_reg_loss: 103992.4160; val_edge_recon_loss: 813073.1484; val_gene_expr_recon_loss: 21955198.2500; val_masked_gp_l1_reg_loss: 64822.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3591169.7500; val_chrom_access_recon_loss: 2216745.7344; val_global_loss: 28745001.7500; val_optim_loss: 28745001.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7175; val_auprc_score: 0.6918; val_best_acc_score: 0.5382; val_best_f1_score: 0.6795; train_kl_reg_loss: 83216.3075; train_edge_recon_loss: 746840.9981; train_gene_expr_recon_loss: 21326607.7879; train_masked_gp_l1_reg_loss: 64063.7922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2041661.9223; train_chrom_access_recon_loss: 2211028.6307; train_global_loss: 26473419.3333; train_optim_loss: 26473419.3333; val_kl_reg_loss: 75650.3242; val_edge_recon_loss: 812579.8750; val_gene_expr_recon_loss: 21354181.0000; val_masked_gp_l1_reg_loss: 63936.8477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1034769.5000; val_chrom_access_recon_loss: 2204347.1562; val_global_loss: 25545463.7500; val_optim_loss: 25545463.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7483; val_auprc_score: 0.7235; val_best_acc_score: 0.6521; val_best_f1_score: 0.7199; train_kl_reg_loss: 77410.7437; train_edge_recon_loss: 738674.0047; train_gene_expr_recon_loss: 21122735.6970; train_masked_gp_l1_reg_loss: 64343.1873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 681758.4550; train_chrom_access_recon_loss: 2195526.7083; train_global_loss: 24880448.7273; train_optim_loss: 24880448.7273; val_kl_reg_loss: 70732.7109; val_edge_recon_loss: 809728.0781; val_gene_expr_recon_loss: 21255492.5000; val_masked_gp_l1_reg_loss: 65084.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 447600.5625; val_chrom_access_recon_loss: 2186534.5000; val_global_loss: 24835172.0000; val_optim_loss: 24835172.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8132; val_auprc_score: 0.7919; val_best_acc_score: 0.7012; val_best_f1_score: 0.7455; train_kl_reg_loss: 70491.9820; train_edge_recon_loss: 730694.0473; train_gene_expr_recon_loss: 20937692.3636; train_masked_gp_l1_reg_loss: 66000.2206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 344924.2003; train_chrom_access_recon_loss: 2179708.5265; train_global_loss: 24329511.4848; train_optim_loss: 24329511.4848; val_kl_reg_loss: 68588.2334; val_edge_recon_loss: 791731.1797; val_gene_expr_recon_loss: 21144145.2500; val_masked_gp_l1_reg_loss: 67240.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 270638.6875; val_chrom_access_recon_loss: 2185937.1562; val_global_loss: 24528280.0000; val_optim_loss: 24528280.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8671; val_auprc_score: 0.8350; val_best_acc_score: 0.7886; val_best_f1_score: 0.8134; train_kl_reg_loss: 66181.3105; train_edge_recon_loss: 715388.7973; train_gene_expr_recon_loss: 20778315.3333; train_masked_gp_l1_reg_loss: 68596.8832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235079.2436; train_chrom_access_recon_loss: 2164802.8939; train_global_loss: 24028364.6061; train_optim_loss: 24028364.6061; val_kl_reg_loss: 62909.2969; val_edge_recon_loss: 733566.7578; val_gene_expr_recon_loss: 20823224.5000; val_masked_gp_l1_reg_loss: 70176.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209351.9062; val_chrom_access_recon_loss: 2139991.2344; val_global_loss: 24039220.0000; val_optim_loss: 24039220.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8687; val_auprc_score: 0.8416; val_best_acc_score: 0.7899; val_best_f1_score: 0.8071; train_kl_reg_loss: 70349.5057; train_edge_recon_loss: 671478.9223; train_gene_expr_recon_loss: 20648809.8485; train_masked_gp_l1_reg_loss: 71515.9590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 192161.1274; train_chrom_access_recon_loss: 2155073.2254; train_global_loss: 23809388.5758; train_optim_loss: 23809388.5758; val_kl_reg_loss: 74863.9795; val_edge_recon_loss: 647440.2188; val_gene_expr_recon_loss: 20883834.7500; val_masked_gp_l1_reg_loss: 72943.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 177768.6406; val_chrom_access_recon_loss: 2155145.6875; val_global_loss: 24011996.5000; val_optim_loss: 24011996.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8884; val_auprc_score: 0.8613; val_best_acc_score: 0.8092; val_best_f1_score: 0.8265; train_kl_reg_loss: 78113.8312; train_edge_recon_loss: 636152.6733; train_gene_expr_recon_loss: 20504159.7576; train_masked_gp_l1_reg_loss: 74230.7552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167406.3094; train_chrom_access_recon_loss: 2142438.8712; train_global_loss: 23602502.0606; train_optim_loss: 23602502.0606; val_kl_reg_loss: 76485.1406; val_edge_recon_loss: 630778.1719; val_gene_expr_recon_loss: 20941430.5000; val_masked_gp_l1_reg_loss: 75608.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157783.8594; val_chrom_access_recon_loss: 2147654.6250; val_global_loss: 24029740.2500; val_optim_loss: 24029740.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8930; val_auprc_score: 0.8584; val_best_acc_score: 0.8162; val_best_f1_score: 0.8311; train_kl_reg_loss: 77214.7126; train_edge_recon_loss: 625665.6979; train_gene_expr_recon_loss: 20422163.3030; train_masked_gp_l1_reg_loss: 76352.0089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149093.7505; train_chrom_access_recon_loss: 2136267.2481; train_global_loss: 23486756.5758; train_optim_loss: 23486756.5758; val_kl_reg_loss: 78014.5068; val_edge_recon_loss: 620125.6406; val_gene_expr_recon_loss: 20846137.5000; val_masked_gp_l1_reg_loss: 77459.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141101.0312; val_chrom_access_recon_loss: 2135625.4219; val_global_loss: 23898464.7500; val_optim_loss: 23898464.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8938; val_auprc_score: 0.8612; val_best_acc_score: 0.8213; val_best_f1_score: 0.8368; train_kl_reg_loss: 76554.2237; train_edge_recon_loss: 616267.0473; train_gene_expr_recon_loss: 20322764.5455; train_masked_gp_l1_reg_loss: 78149.1757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135617.3634; train_chrom_access_recon_loss: 2125514.4848; train_global_loss: 23354867.1515; train_optim_loss: 23354867.1515; val_kl_reg_loss: 74186.7275; val_edge_recon_loss: 621475.5391; val_gene_expr_recon_loss: 20424251.5000; val_masked_gp_l1_reg_loss: 78946.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131927.5625; val_chrom_access_recon_loss: 2125587.3438; val_global_loss: 23456374.7500; val_optim_loss: 23456374.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9063; val_auprc_score: 0.8800; val_best_acc_score: 0.8334; val_best_f1_score: 0.8462; train_kl_reg_loss: 75455.7004; train_edge_recon_loss: 614389.9924; train_gene_expr_recon_loss: 20239219.1818; train_masked_gp_l1_reg_loss: 79584.5063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127058.1673; train_chrom_access_recon_loss: 2117135.9659; train_global_loss: 23252843.5758; train_optim_loss: 23252843.5758; val_kl_reg_loss: 75125.8359; val_edge_recon_loss: 614134.2422; val_gene_expr_recon_loss: 20499492.0000; val_masked_gp_l1_reg_loss: 80285.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124640.0000; val_chrom_access_recon_loss: 2098877.5781; val_global_loss: 23492555.5000; val_optim_loss: 23492555.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9034; val_auprc_score: 0.8704; val_best_acc_score: 0.8326; val_best_f1_score: 0.8448; train_kl_reg_loss: 74395.1443; train_edge_recon_loss: 611004.7841; train_gene_expr_recon_loss: 20168722.5152; train_masked_gp_l1_reg_loss: 80919.4345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121311.4903; train_chrom_access_recon_loss: 2109722.6496; train_global_loss: 23166075.6667; train_optim_loss: 23166075.6667; val_kl_reg_loss: 71770.0996; val_edge_recon_loss: 608007.4766; val_gene_expr_recon_loss: 20396824.5000; val_masked_gp_l1_reg_loss: 81347.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120195.4453; val_chrom_access_recon_loss: 2122559.3906; val_global_loss: 23400705.2500; val_optim_loss: 23400705.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9102; val_auprc_score: 0.8859; val_best_acc_score: 0.8380; val_best_f1_score: 0.8506; train_kl_reg_loss: 73196.6953; train_edge_recon_loss: 607959.8144; train_gene_expr_recon_loss: 20085846.9697; train_masked_gp_l1_reg_loss: 81931.3484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118506.6751; train_chrom_access_recon_loss: 2105371.2405; train_global_loss: 23072813.0000; train_optim_loss: 23072813.0000; val_kl_reg_loss: 73115.4609; val_edge_recon_loss: 611424.2109; val_gene_expr_recon_loss: 20302146.5000; val_masked_gp_l1_reg_loss: 82309.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117225.1406; val_chrom_access_recon_loss: 2123153.2344; val_global_loss: 23309375.2500; val_optim_loss: 23309375.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9132; val_auprc_score: 0.8899; val_best_acc_score: 0.8436; val_best_f1_score: 0.8582; train_kl_reg_loss: 72522.6288; train_edge_recon_loss: 604985.8333; train_gene_expr_recon_loss: 20005271.2424; train_masked_gp_l1_reg_loss: 82731.1464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116502.8543; train_chrom_access_recon_loss: 2095655.7481; train_global_loss: 22977669.6667; train_optim_loss: 22977669.6667; val_kl_reg_loss: 72249.3125; val_edge_recon_loss: 608001.9609; val_gene_expr_recon_loss: 20283643.0000; val_masked_gp_l1_reg_loss: 83145.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115985.5234; val_chrom_access_recon_loss: 2098073.2188; val_global_loss: 23261099.5000; val_optim_loss: 23261099.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9166; val_auprc_score: 0.8955; val_best_acc_score: 0.8485; val_best_f1_score: 0.8596; train_kl_reg_loss: 71307.5871; train_edge_recon_loss: 601877.0691; train_gene_expr_recon_loss: 19946608.7273; train_masked_gp_l1_reg_loss: 83602.6080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114360.3023; train_chrom_access_recon_loss: 2090238.1875; train_global_loss: 22907994.5152; train_optim_loss: 22907994.5152; val_kl_reg_loss: 71914.4707; val_edge_recon_loss: 605832.0156; val_gene_expr_recon_loss: 20254965.7500; val_masked_gp_l1_reg_loss: 84047.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113316.6172; val_chrom_access_recon_loss: 2103170.2500; val_global_loss: 23233246.7500; val_optim_loss: 23233246.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9207; val_auprc_score: 0.8926; val_best_acc_score: 0.8538; val_best_f1_score: 0.8640; train_kl_reg_loss: 70899.5523; train_edge_recon_loss: 600190.2803; train_gene_expr_recon_loss: 19892571.7879; train_masked_gp_l1_reg_loss: 84380.0019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111999.4723; train_chrom_access_recon_loss: 2084944.7064; train_global_loss: 22844985.6061; train_optim_loss: 22844985.6061; val_kl_reg_loss: 69915.0605; val_edge_recon_loss: 604088.2969; val_gene_expr_recon_loss: 20169137.0000; val_masked_gp_l1_reg_loss: 84935.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112272.9922; val_chrom_access_recon_loss: 2079459.7812; val_global_loss: 23119808.0000; val_optim_loss: 23119808.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9277; val_auprc_score: 0.9052; val_best_acc_score: 0.8603; val_best_f1_score: 0.8722; train_kl_reg_loss: 69966.9528; train_edge_recon_loss: 599368.7718; train_gene_expr_recon_loss: 19834256.6970; train_masked_gp_l1_reg_loss: 85187.7049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110442.8441; train_chrom_access_recon_loss: 2080671.1155; train_global_loss: 22779894.0909; train_optim_loss: 22779894.0909; val_kl_reg_loss: 68696.8584; val_edge_recon_loss: 600923.8672; val_gene_expr_recon_loss: 20003233.7500; val_masked_gp_l1_reg_loss: 85350.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109210.3750; val_chrom_access_recon_loss: 2070998.3438; val_global_loss: 22938412.7500; val_optim_loss: 22938412.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9285; val_auprc_score: 0.9086; val_best_acc_score: 0.8603; val_best_f1_score: 0.8710; train_kl_reg_loss: 69618.0033; train_edge_recon_loss: 596614.4176; train_gene_expr_recon_loss: 19779799.5152; train_masked_gp_l1_reg_loss: 85731.8255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108439.6378; train_chrom_access_recon_loss: 2077145.6174; train_global_loss: 22717348.9394; train_optim_loss: 22717348.9394; val_kl_reg_loss: 68385.9873; val_edge_recon_loss: 602589.1562; val_gene_expr_recon_loss: 19966602.2500; val_masked_gp_l1_reg_loss: 85887.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107733.9844; val_chrom_access_recon_loss: 2073164.9688; val_global_loss: 22904364.5000; val_optim_loss: 22904364.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9299; val_auprc_score: 0.9080; val_best_acc_score: 0.8673; val_best_f1_score: 0.8747; train_kl_reg_loss: 68900.7610; train_edge_recon_loss: 594574.7756; train_gene_expr_recon_loss: 19725812.3636; train_masked_gp_l1_reg_loss: 86189.8209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106849.3105; train_chrom_access_recon_loss: 2068955.5473; train_global_loss: 22651282.6364; train_optim_loss: 22651282.6364; val_kl_reg_loss: 70237.3477; val_edge_recon_loss: 601728.3828; val_gene_expr_recon_loss: 19857723.5000; val_masked_gp_l1_reg_loss: 86569.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106868.3828; val_chrom_access_recon_loss: 2071352.9844; val_global_loss: 22794480.0000; val_optim_loss: 22794480.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9422; val_auprc_score: 0.9232; val_best_acc_score: 0.8810; val_best_f1_score: 0.8871; train_kl_reg_loss: 68367.5295; train_edge_recon_loss: 593716.8684; train_gene_expr_recon_loss: 19665756.6061; train_masked_gp_l1_reg_loss: 86793.4731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105795.1600; train_chrom_access_recon_loss: 2061310.3845; train_global_loss: 22581740.3030; train_optim_loss: 22581740.3030; val_kl_reg_loss: 67511.3740; val_edge_recon_loss: 598828.6953; val_gene_expr_recon_loss: 19904339.5000; val_masked_gp_l1_reg_loss: 86920.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104935.1484; val_chrom_access_recon_loss: 2075502.5625; val_global_loss: 22838038.2500; val_optim_loss: 22838038.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9358; val_auprc_score: 0.9141; val_best_acc_score: 0.8724; val_best_f1_score: 0.8814; train_kl_reg_loss: 67990.1734; train_edge_recon_loss: 591779.8873; train_gene_expr_recon_loss: 19637072.1515; train_masked_gp_l1_reg_loss: 87238.0671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104400.0402; train_chrom_access_recon_loss: 2058320.9867; train_global_loss: 22546801.3030; train_optim_loss: 22546801.3030; val_kl_reg_loss: 68400.6748; val_edge_recon_loss: 597268.4531; val_gene_expr_recon_loss: 19649876.7500; val_masked_gp_l1_reg_loss: 87623.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104593.6016; val_chrom_access_recon_loss: 2052154.6719; val_global_loss: 22559918.2500; val_optim_loss: 22559918.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9389; val_auprc_score: 0.9203; val_best_acc_score: 0.8807; val_best_f1_score: 0.8876; train_kl_reg_loss: 67510.7873; train_edge_recon_loss: 590587.3949; train_gene_expr_recon_loss: 19560651.2727; train_masked_gp_l1_reg_loss: 87845.9096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103854.1863; train_chrom_access_recon_loss: 2050579.5473; train_global_loss: 22461029.3636; train_optim_loss: 22461029.3636; val_kl_reg_loss: 67305.3047; val_edge_recon_loss: 593443.2812; val_gene_expr_recon_loss: 19867958.0000; val_masked_gp_l1_reg_loss: 88136.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103938.7266; val_chrom_access_recon_loss: 2078208.8906; val_global_loss: 22798989.2500; val_optim_loss: 22798989.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9477; val_auprc_score: 0.9320; val_best_acc_score: 0.8882; val_best_f1_score: 0.8926; train_kl_reg_loss: 67052.3344; train_edge_recon_loss: 589966.8400; train_gene_expr_recon_loss: 19531400.0606; train_masked_gp_l1_reg_loss: 88310.6839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103262.3723; train_chrom_access_recon_loss: 2048629.6515; train_global_loss: 22428621.5758; train_optim_loss: 22428621.5758; val_kl_reg_loss: 65927.3608; val_edge_recon_loss: 593795.8672; val_gene_expr_recon_loss: 19801268.5000; val_masked_gp_l1_reg_loss: 88481.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103460.5312; val_chrom_access_recon_loss: 2058926.8750; val_global_loss: 22711861.2500; val_optim_loss: 22711861.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9461; val_auprc_score: 0.9268; val_best_acc_score: 0.8915; val_best_f1_score: 0.8953; train_kl_reg_loss: 66262.6918; train_edge_recon_loss: 589981.4716; train_gene_expr_recon_loss: 19493225.4545; train_masked_gp_l1_reg_loss: 88773.4353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102692.8438; train_chrom_access_recon_loss: 2043838.4394; train_global_loss: 22384774.2121; train_optim_loss: 22384774.2121; val_kl_reg_loss: 65135.6558; val_edge_recon_loss: 591311.1797; val_gene_expr_recon_loss: 19758044.5000; val_masked_gp_l1_reg_loss: 88915.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102151.5156; val_chrom_access_recon_loss: 2036012.4375; val_global_loss: 22641571.7500; val_optim_loss: 22641571.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9444; val_auprc_score: 0.9268; val_best_acc_score: 0.8861; val_best_f1_score: 0.8916; train_kl_reg_loss: 65888.8052; train_edge_recon_loss: 587329.2150; train_gene_expr_recon_loss: 19445868.5455; train_masked_gp_l1_reg_loss: 89220.9948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101858.3595; train_chrom_access_recon_loss: 2038379.6155; train_global_loss: 22328545.7576; train_optim_loss: 22328545.7576; val_kl_reg_loss: 65735.9883; val_edge_recon_loss: 591986.7266; val_gene_expr_recon_loss: 19720215.0000; val_masked_gp_l1_reg_loss: 89614.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101549.1875; val_chrom_access_recon_loss: 2032245.4688; val_global_loss: 22601347.2500; val_optim_loss: 22601347.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9468; val_auprc_score: 0.9282; val_best_acc_score: 0.8872; val_best_f1_score: 0.8931; train_kl_reg_loss: 65785.7343; train_edge_recon_loss: 587816.6572; train_gene_expr_recon_loss: 19420568.8788; train_masked_gp_l1_reg_loss: 88587.4607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76155.9972; train_chrom_access_recon_loss: 2034009.8163; train_global_loss: 22272924.4848; train_optim_loss: 22272924.4848; val_kl_reg_loss: 66600.1050; val_edge_recon_loss: 593587.6484; val_gene_expr_recon_loss: 19514468.0000; val_masked_gp_l1_reg_loss: 88104.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69254.5312; val_chrom_access_recon_loss: 2031894.1875; val_global_loss: 22363907.7500; val_optim_loss: 22363907.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9299; val_auprc_score: 0.9078; val_best_acc_score: 0.8632; val_best_f1_score: 0.8729; train_kl_reg_loss: 63526.5427; train_edge_recon_loss: 731874.4602; train_gene_expr_recon_loss: 17522512.3636; train_masked_gp_l1_reg_loss: 87735.2630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67683.8022; train_chrom_access_recon_loss: 2001711.3314; train_global_loss: 20475043.8485; train_optim_loss: 20475043.8485; val_kl_reg_loss: 26907.9229; val_edge_recon_loss: 752264.6797; val_gene_expr_recon_loss: 17680130.0000; val_masked_gp_l1_reg_loss: 87479.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67574.4453; val_chrom_access_recon_loss: 1890001.0000; val_global_loss: 20504357.0000; val_optim_loss: 20504357.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9282; val_auprc_score: 0.9083; val_best_acc_score: 0.8552; val_best_f1_score: 0.8654; train_kl_reg_loss: 61867.7558; train_edge_recon_loss: 715659.8627; train_gene_expr_recon_loss: 17444148.9545; train_masked_gp_l1_reg_loss: 87089.3529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67702.7552; train_chrom_access_recon_loss: 1870541.8068; train_global_loss: 20247010.6364; train_optim_loss: 20247010.6364; val_kl_reg_loss: 26296.9758; val_edge_recon_loss: 756194.5859; val_gene_expr_recon_loss: 17693613.0000; val_masked_gp_l1_reg_loss: 86645.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67848.7031; val_chrom_access_recon_loss: 1868292.1094; val_global_loss: 20498890.2500; val_optim_loss: 20498890.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9258; val_auprc_score: 0.9042; val_best_acc_score: 0.8544; val_best_f1_score: 0.8662; train_kl_reg_loss: 59235.4979; train_edge_recon_loss: 708305.9678; train_gene_expr_recon_loss: 17408975.8636; train_masked_gp_l1_reg_loss: 86211.3074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67782.4513; train_chrom_access_recon_loss: 1848557.5701; train_global_loss: 20179068.6970; train_optim_loss: 20179068.6970; val_kl_reg_loss: 27152.0117; val_edge_recon_loss: 756448.4844; val_gene_expr_recon_loss: 17813491.0000; val_masked_gp_l1_reg_loss: 85767.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67651.4609; val_chrom_access_recon_loss: 1862086.5000; val_global_loss: 20612597.7500; val_optim_loss: 20612597.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9282; val_auprc_score: 0.9012; val_best_acc_score: 0.8611; val_best_f1_score: 0.8712; train_kl_reg_loss: 55806.9341; train_edge_recon_loss: 708814.7339; train_gene_expr_recon_loss: 17397150.2121; train_masked_gp_l1_reg_loss: 85343.7971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67574.2661; train_chrom_access_recon_loss: 1842149.4205; train_global_loss: 20156839.4848; train_optim_loss: 20156839.4848; val_kl_reg_loss: 25634.4900; val_edge_recon_loss: 754252.3516; val_gene_expr_recon_loss: 17826048.2500; val_masked_gp_l1_reg_loss: 84960.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67494.9766; val_chrom_access_recon_loss: 1871186.4844; val_global_loss: 20629575.5000; val_optim_loss: 20629575.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9331; val_auprc_score: 0.9124; val_best_acc_score: 0.8670; val_best_f1_score: 0.8753; train_kl_reg_loss: 53306.5433; train_edge_recon_loss: 709018.1941; train_gene_expr_recon_loss: 17413044.7576; train_masked_gp_l1_reg_loss: 84556.9790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67403.9366; train_chrom_access_recon_loss: 1839057.6496; train_global_loss: 20166388.1212; train_optim_loss: 20166388.1212; val_kl_reg_loss: 26421.7288; val_edge_recon_loss: 751942.3750; val_gene_expr_recon_loss: 17717918.8750; val_masked_gp_l1_reg_loss: 84128.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67286.5234; val_chrom_access_recon_loss: 1840557.9531; val_global_loss: 20488255.0000; val_optim_loss: 20488255.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9331; val_auprc_score: 0.9123; val_best_acc_score: 0.8657; val_best_f1_score: 0.8737; train_kl_reg_loss: 51993.5397; train_edge_recon_loss: 706979.7415; train_gene_expr_recon_loss: 17379113.2576; train_masked_gp_l1_reg_loss: 83730.1045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67108.2644; train_chrom_access_recon_loss: 1833476.7973; train_global_loss: 20122401.7273; train_optim_loss: 20122401.7273; val_kl_reg_loss: 26673.3892; val_edge_recon_loss: 747927.9688; val_gene_expr_recon_loss: 17744199.7500; val_masked_gp_l1_reg_loss: 83297.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66987.8359; val_chrom_access_recon_loss: 1864582.4531; val_global_loss: 20533669.5000; val_optim_loss: 20533669.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9306; val_auprc_score: 0.9125; val_best_acc_score: 0.8595; val_best_f1_score: 0.8681; train_kl_reg_loss: 50491.4854; train_edge_recon_loss: 704409.2595; train_gene_expr_recon_loss: 17377928.5000; train_masked_gp_l1_reg_loss: 82911.7354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66821.6785; train_chrom_access_recon_loss: 1833507.8201; train_global_loss: 20116070.6061; train_optim_loss: 20116070.6061; val_kl_reg_loss: 25895.1641; val_edge_recon_loss: 745635.9609; val_gene_expr_recon_loss: 17677063.0000; val_masked_gp_l1_reg_loss: 82502.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66743.6406; val_chrom_access_recon_loss: 1830941.5469; val_global_loss: 20428781.7500; val_optim_loss: 20428781.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9324; val_auprc_score: 0.9146; val_best_acc_score: 0.8673; val_best_f1_score: 0.8738; train_kl_reg_loss: 48844.8772; train_edge_recon_loss: 701783.0597; train_gene_expr_recon_loss: 17380496.6970; train_masked_gp_l1_reg_loss: 82116.4864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66552.2758; train_chrom_access_recon_loss: 1831733.3731; train_global_loss: 20111526.9394; train_optim_loss: 20111526.9394; val_kl_reg_loss: 25489.4614; val_edge_recon_loss: 742296.0781; val_gene_expr_recon_loss: 17732776.7500; val_masked_gp_l1_reg_loss: 81722.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66346.1641; val_chrom_access_recon_loss: 1841350.4531; val_global_loss: 20489980.2500; val_optim_loss: 20489980.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9336; val_auprc_score: 0.9112; val_best_acc_score: 0.8713; val_best_f1_score: 0.8777; train_kl_reg_loss: 47724.8612; train_edge_recon_loss: 702859.2803; train_gene_expr_recon_loss: 17375646.7121; train_masked_gp_l1_reg_loss: 81346.2675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66171.6294; train_chrom_access_recon_loss: 1830560.4830; train_global_loss: 20104309.2727; train_optim_loss: 20104309.2727; val_kl_reg_loss: 26528.9851; val_edge_recon_loss: 738314.6641; val_gene_expr_recon_loss: 17439060.2500; val_masked_gp_l1_reg_loss: 80963.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66017.3516; val_chrom_access_recon_loss: 1824685.2812; val_global_loss: 20175571.0000; val_optim_loss: 20175571.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9347; val_auprc_score: 0.9111; val_best_acc_score: 0.8710; val_best_f1_score: 0.8769; train_kl_reg_loss: 46044.6703; train_edge_recon_loss: 701944.2879; train_gene_expr_recon_loss: 17363522.5758; train_masked_gp_l1_reg_loss: 80586.4347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65852.1866; train_chrom_access_recon_loss: 1827607.2235; train_global_loss: 20085557.1212; train_optim_loss: 20085557.1212; val_kl_reg_loss: 25996.8860; val_edge_recon_loss: 734166.9375; val_gene_expr_recon_loss: 17692240.2500; val_masked_gp_l1_reg_loss: 80219.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65686.1094; val_chrom_access_recon_loss: 1849348.2344; val_global_loss: 20447658.5000; val_optim_loss: 20447658.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9354; val_auprc_score: 0.9222; val_best_acc_score: 0.8646; val_best_f1_score: 0.8711; train_kl_reg_loss: 45049.0321; train_edge_recon_loss: 699365.0417; train_gene_expr_recon_loss: 17365819.1667; train_masked_gp_l1_reg_loss: 79873.9483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65510.8294; train_chrom_access_recon_loss: 1828266.4716; train_global_loss: 20083884.5758; train_optim_loss: 20083884.5758; val_kl_reg_loss: 25375.3201; val_edge_recon_loss: 730964.6406; val_gene_expr_recon_loss: 17665453.7500; val_masked_gp_l1_reg_loss: 79518.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65368.3945; val_chrom_access_recon_loss: 1835260.2812; val_global_loss: 20401940.0000; val_optim_loss: 20401940.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9365; val_auprc_score: 0.9210; val_best_acc_score: 0.8710; val_best_f1_score: 0.8753; train_kl_reg_loss: 44345.4426; train_edge_recon_loss: 696521.1771; train_gene_expr_recon_loss: 17367424.1364; train_masked_gp_l1_reg_loss: 79169.8153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65182.3449; train_chrom_access_recon_loss: 1827728.4167; train_global_loss: 20080371.5152; train_optim_loss: 20080371.5152; val_kl_reg_loss: 25621.9790; val_edge_recon_loss: 726292.7031; val_gene_expr_recon_loss: 17526481.7500; val_masked_gp_l1_reg_loss: 78804.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64929.7266; val_chrom_access_recon_loss: 1831970.6094; val_global_loss: 20254100.7500; val_optim_loss: 20254100.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9354; val_auprc_score: 0.9175; val_best_acc_score: 0.8705; val_best_f1_score: 0.8755; train_kl_reg_loss: 42524.5369; train_edge_recon_loss: 695374.6250; train_gene_expr_recon_loss: 17355556.9545; train_masked_gp_l1_reg_loss: 78473.0359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64796.1790; train_chrom_access_recon_loss: 1825737.7765; train_global_loss: 20062463.2424; train_optim_loss: 20062463.2424; val_kl_reg_loss: 23074.2761; val_edge_recon_loss: 723224.2344; val_gene_expr_recon_loss: 17705704.2500; val_masked_gp_l1_reg_loss: 78140.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64642.2656; val_chrom_access_recon_loss: 1851242.2656; val_global_loss: 20446027.5000; val_optim_loss: 20446027.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9378; val_auprc_score: 0.9251; val_best_acc_score: 0.8702; val_best_f1_score: 0.8743; train_kl_reg_loss: 41071.7364; train_edge_recon_loss: 695659.8608; train_gene_expr_recon_loss: 17372412.2879; train_masked_gp_l1_reg_loss: 78072.1084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63165.3410; train_chrom_access_recon_loss: 1827024.6345; train_global_loss: 20077405.9091; train_optim_loss: 20077405.9091; val_kl_reg_loss: 24085.3010; val_edge_recon_loss: 723734.4375; val_gene_expr_recon_loss: 17430777.3750; val_masked_gp_l1_reg_loss: 78017.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62835.8516; val_chrom_access_recon_loss: 1820666.8906; val_global_loss: 20140118.2500; val_optim_loss: 20140118.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9308; val_auprc_score: 0.9089; val_best_acc_score: 0.8684; val_best_f1_score: 0.8726; train_kl_reg_loss: 41826.6639; train_edge_recon_loss: 694011.8892; train_gene_expr_recon_loss: 17375407.9848; train_masked_gp_l1_reg_loss: 77977.0134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62782.1042; train_chrom_access_recon_loss: 1828855.9716; train_global_loss: 20080861.6970; train_optim_loss: 20080861.6970; val_kl_reg_loss: 24514.3193; val_edge_recon_loss: 722691.0859; val_gene_expr_recon_loss: 17426855.8750; val_masked_gp_l1_reg_loss: 77936.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62736.1523; val_chrom_access_recon_loss: 1822412.5312; val_global_loss: 20137145.7500; val_optim_loss: 20137145.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9337; val_auprc_score: 0.9133; val_best_acc_score: 0.8718; val_best_f1_score: 0.8765; train_kl_reg_loss: 42055.3743; train_edge_recon_loss: 693187.2566; train_gene_expr_recon_loss: 17353288.2727; train_masked_gp_l1_reg_loss: 77898.7765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62703.7256; train_chrom_access_recon_loss: 1825212.2330; train_global_loss: 20054345.7576; train_optim_loss: 20054345.7576; val_kl_reg_loss: 24925.2253; val_edge_recon_loss: 719715.8516; val_gene_expr_recon_loss: 17665866.5000; val_masked_gp_l1_reg_loss: 77860.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62666.8398; val_chrom_access_recon_loss: 1842497.7500; val_global_loss: 20393531.0000; val_optim_loss: 20393531.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9394; val_auprc_score: 0.9261; val_best_acc_score: 0.8673; val_best_f1_score: 0.8745; train_kl_reg_loss: 42265.0353; train_edge_recon_loss: 691469.6648; train_gene_expr_recon_loss: 17372631.3788; train_masked_gp_l1_reg_loss: 77825.4937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62642.8738; train_chrom_access_recon_loss: 1827854.9867; train_global_loss: 20074689.4545; train_optim_loss: 20074689.4545; val_kl_reg_loss: 25045.1172; val_edge_recon_loss: 721356.2109; val_gene_expr_recon_loss: 17869140.5000; val_masked_gp_l1_reg_loss: 77788.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62615.2344; val_chrom_access_recon_loss: 1850437.2656; val_global_loss: 20606383.5000; val_optim_loss: 20606383.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9321; val_auprc_score: 0.9092; val_best_acc_score: 0.8692; val_best_f1_score: 0.8741; train_kl_reg_loss: 42232.0975; train_edge_recon_loss: 692535.1686; train_gene_expr_recon_loss: 17351495.4242; train_masked_gp_l1_reg_loss: 77752.8888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62590.0827; train_chrom_access_recon_loss: 1825672.9564; train_global_loss: 20052278.9394; train_optim_loss: 20052278.9394; val_kl_reg_loss: 24942.8274; val_edge_recon_loss: 722613.6484; val_gene_expr_recon_loss: 17657886.2500; val_masked_gp_l1_reg_loss: 77715.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62563.1562; val_chrom_access_recon_loss: 1837163.4375; val_global_loss: 20382886.0000; val_optim_loss: 20382886.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9279; val_auprc_score: 0.9063; val_best_acc_score: 0.8638; val_best_f1_score: 0.8686; train_kl_reg_loss: 42053.7588; train_edge_recon_loss: 691444.2396; train_gene_expr_recon_loss: 17349295.8182; train_masked_gp_l1_reg_loss: 77679.9476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62532.4806; train_chrom_access_recon_loss: 1824856.2008; train_global_loss: 20047862.4545; train_optim_loss: 20047862.4545; val_kl_reg_loss: 24682.3279; val_edge_recon_loss: 719905.6016; val_gene_expr_recon_loss: 17784434.2500; val_masked_gp_l1_reg_loss: 77644.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62505.7617; val_chrom_access_recon_loss: 1853791.5000; val_global_loss: 20522963.7500; val_optim_loss: 20522963.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9319; val_auprc_score: 0.9134; val_best_acc_score: 0.8654; val_best_f1_score: 0.8711; train_kl_reg_loss: 41658.5780; train_edge_recon_loss: 690624.5909; train_gene_expr_recon_loss: 17357022.5909; train_masked_gp_l1_reg_loss: 77637.3833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62348.2918; train_chrom_access_recon_loss: 1824844.9716; train_global_loss: 20054136.4545; train_optim_loss: 20054136.4545; val_kl_reg_loss: 24825.2317; val_edge_recon_loss: 720059.7188; val_gene_expr_recon_loss: 17598926.5000; val_masked_gp_l1_reg_loss: 77632.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62313.0977; val_chrom_access_recon_loss: 1833054.8125; val_global_loss: 20316812.5000; val_optim_loss: 20316812.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9330; val_auprc_score: 0.9173; val_best_acc_score: 0.8673; val_best_f1_score: 0.8744; train_kl_reg_loss: 41747.8053; train_edge_recon_loss: 691128.2680; train_gene_expr_recon_loss: 17353640.6515; train_masked_gp_l1_reg_loss: 77627.9048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62307.1449; train_chrom_access_recon_loss: 1826008.8996; train_global_loss: 20052460.7273; train_optim_loss: 20052460.7273; val_kl_reg_loss: 24904.7993; val_edge_recon_loss: 719599.3672; val_gene_expr_recon_loss: 17673084.5000; val_masked_gp_l1_reg_loss: 77623.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62301.6211; val_chrom_access_recon_loss: 1839011.6094; val_global_loss: 20396526.5000; val_optim_loss: 20396526.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9339; val_auprc_score: 0.9184; val_best_acc_score: 0.8665; val_best_f1_score: 0.8707; train_kl_reg_loss: 41799.5243; train_edge_recon_loss: 690823.0805; train_gene_expr_recon_loss: 17354383.8485; train_masked_gp_l1_reg_loss: 77619.6373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62297.0342; train_chrom_access_recon_loss: 1824569.1667; train_global_loss: 20051492.0000; train_optim_loss: 20051492.0000; val_kl_reg_loss: 24863.6836; val_edge_recon_loss: 720581.8594; val_gene_expr_recon_loss: 17546077.0000; val_masked_gp_l1_reg_loss: 77615.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62292.9141; val_chrom_access_recon_loss: 1829517.8438; val_global_loss: 20260948.5000; val_optim_loss: 20260948.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9292; val_auprc_score: 0.9089; val_best_acc_score: 0.8638; val_best_f1_score: 0.8695; train_kl_reg_loss: 41842.9793; train_edge_recon_loss: 691324.4915; train_gene_expr_recon_loss: 17355479.2121; train_masked_gp_l1_reg_loss: 77611.3671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62289.0511; train_chrom_access_recon_loss: 1825916.6610; train_global_loss: 20054463.7273; train_optim_loss: 20054463.7273; val_kl_reg_loss: 24916.2908; val_edge_recon_loss: 720847.4844; val_gene_expr_recon_loss: 17586494.0000; val_masked_gp_l1_reg_loss: 77607.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62285.7422; val_chrom_access_recon_loss: 1825179.8125; val_global_loss: 20297331.5000; val_optim_loss: 20297331.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 43 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9314
val AUPRC score: 0.9078
val best accuracy score: 0.8659
val best F1 score: 0.8705
val target rna MSE score: 2.4253
val source rna MSE score: 1.1111
val target atac MSE score: 0.3324
val source atac MSE score: 0.1372
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
