[True]
Run timestamp: 07082023_221738_159.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_159']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8831; val_auprc_score: 0.8960; val_best_acc_score: 0.5454; val_best_f1_score: 0.6867; train_kl_reg_loss: 40291.4683; train_edge_recon_loss: 3474611.8333; train_gene_expr_recon_loss: 1149662.2361; train_masked_gp_l1_reg_loss: 8638.0209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166897.4948; train_chrom_access_recon_loss: 769964.1285; train_global_loss: 5610065.2778; train_optim_loss: 5610065.2778; val_kl_reg_loss: 18835.9062; val_edge_recon_loss: 4062190.2500; val_gene_expr_recon_loss: 1023529.6250; val_masked_gp_l1_reg_loss: 6963.8726; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162113.5938; val_chrom_access_recon_loss: 529908.5625; val_global_loss: 5803542.0000; val_optim_loss: 5803542.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8744; val_auprc_score: 0.8854; val_best_acc_score: 0.5648; val_best_f1_score: 0.6953; train_kl_reg_loss: 14635.9577; train_edge_recon_loss: 3477543.8056; train_gene_expr_recon_loss: 946043.9583; train_masked_gp_l1_reg_loss: 6306.2431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159030.9861; train_chrom_access_recon_loss: 495083.3472; train_global_loss: 5098644.3333; train_optim_loss: 5098644.3333; val_kl_reg_loss: 9803.3350; val_edge_recon_loss: 4060595.2500; val_gene_expr_recon_loss: 876518.2500; val_masked_gp_l1_reg_loss: 5760.5293; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155190.2188; val_chrom_access_recon_loss: 478206.6875; val_global_loss: 5586074.0000; val_optim_loss: 5586074.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8608; val_auprc_score: 0.8704; val_best_acc_score: 0.5858; val_best_f1_score: 0.7038; train_kl_reg_loss: 12344.8160; train_edge_recon_loss: 3478073.1944; train_gene_expr_recon_loss: 850570.5417; train_masked_gp_l1_reg_loss: 5690.2727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151873.7847; train_chrom_access_recon_loss: 466862.3993; train_global_loss: 4965415.1111; train_optim_loss: 4965415.1111; val_kl_reg_loss: 15094.6094; val_edge_recon_loss: 4058716.5000; val_gene_expr_recon_loss: 822003.0000; val_masked_gp_l1_reg_loss: 5654.6494; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147493.5781; val_chrom_access_recon_loss: 468469.1250; val_global_loss: 5517431.0000; val_optim_loss: 5517431.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8520; val_auprc_score: 0.8602; val_best_acc_score: 0.6188; val_best_f1_score: 0.7180; train_kl_reg_loss: 16027.9654; train_edge_recon_loss: 3478724.0556; train_gene_expr_recon_loss: 803967.6597; train_masked_gp_l1_reg_loss: 5608.6140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143601.3333; train_chrom_access_recon_loss: 457696.0382; train_global_loss: 4905625.6111; train_optim_loss: 4905625.6111; val_kl_reg_loss: 16375.4238; val_edge_recon_loss: 4053003.0000; val_gene_expr_recon_loss: 788549.7500; val_masked_gp_l1_reg_loss: 5557.1104; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138541.2969; val_chrom_access_recon_loss: 463061.7812; val_global_loss: 5465088.5000; val_optim_loss: 5465088.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8421; val_auprc_score: 0.8461; val_best_acc_score: 0.6660; val_best_f1_score: 0.7389; train_kl_reg_loss: 17450.9612; train_edge_recon_loss: 3476745.8889; train_gene_expr_recon_loss: 772531.4444; train_masked_gp_l1_reg_loss: 5556.5396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134298.8776; train_chrom_access_recon_loss: 453028.0278; train_global_loss: 4859611.5556; train_optim_loss: 4859611.5556; val_kl_reg_loss: 17630.7227; val_edge_recon_loss: 4043792.0000; val_gene_expr_recon_loss: 763055.3750; val_masked_gp_l1_reg_loss: 5563.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128934.8750; val_chrom_access_recon_loss: 459388.8750; val_global_loss: 5418365.0000; val_optim_loss: 5418365.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8497; val_auprc_score: 0.8481; val_best_acc_score: 0.7619; val_best_f1_score: 0.7847; train_kl_reg_loss: 17263.2682; train_edge_recon_loss: 3476853.8611; train_gene_expr_recon_loss: 753921.7569; train_masked_gp_l1_reg_loss: 5587.2001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124604.4566; train_chrom_access_recon_loss: 449684.2292; train_global_loss: 4827914.6667; train_optim_loss: 4827914.6667; val_kl_reg_loss: 15459.9277; val_edge_recon_loss: 4007392.7500; val_gene_expr_recon_loss: 747942.0000; val_masked_gp_l1_reg_loss: 5617.7485; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119212.0469; val_chrom_access_recon_loss: 457186.7812; val_global_loss: 5352811.5000; val_optim_loss: 5352811.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8374; val_auprc_score: 0.8306; val_best_acc_score: 0.7472; val_best_f1_score: 0.7583; train_kl_reg_loss: 15724.7656; train_edge_recon_loss: 3466875.7500; train_gene_expr_recon_loss: 742257.1250; train_masked_gp_l1_reg_loss: 5660.1606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114984.3012; train_chrom_access_recon_loss: 449022.7743; train_global_loss: 4794524.8889; train_optim_loss: 4794524.8889; val_kl_reg_loss: 13500.5254; val_edge_recon_loss: 3904340.5000; val_gene_expr_recon_loss: 737999.5000; val_masked_gp_l1_reg_loss: 5711.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109767.8750; val_chrom_access_recon_loss: 455634.0000; val_global_loss: 5226954.0000; val_optim_loss: 5226954.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8274; val_auprc_score: 0.8158; val_best_acc_score: 0.7375; val_best_f1_score: 0.7676; train_kl_reg_loss: 11071.0762; train_edge_recon_loss: 3420117.7778; train_gene_expr_recon_loss: 740668.6944; train_masked_gp_l1_reg_loss: 5764.8900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105752.0469; train_chrom_access_recon_loss: 448503.4132; train_global_loss: 4731877.8889; train_optim_loss: 4731877.8889; val_kl_reg_loss: 7001.6094; val_edge_recon_loss: 3524053.0000; val_gene_expr_recon_loss: 752717.3750; val_masked_gp_l1_reg_loss: 5831.7217; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100867.5078; val_chrom_access_recon_loss: 456500.0938; val_global_loss: 4846971.0000; val_optim_loss: 4846971.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8365; val_auprc_score: 0.8306; val_best_acc_score: 0.7439; val_best_f1_score: 0.7695; train_kl_reg_loss: 9757.3139; train_edge_recon_loss: 3177875.1389; train_gene_expr_recon_loss: 770897.5347; train_masked_gp_l1_reg_loss: 5925.2177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97236.3490; train_chrom_access_recon_loss: 451105.3021; train_global_loss: 4512796.8889; train_optim_loss: 4512796.8889; val_kl_reg_loss: 19263.1074; val_edge_recon_loss: 3023816.0000; val_gene_expr_recon_loss: 795225.3750; val_masked_gp_l1_reg_loss: 6058.0908; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92886.1016; val_chrom_access_recon_loss: 459716.9375; val_global_loss: 4396965.5000; val_optim_loss: 4396965.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8646; val_auprc_score: 0.8570; val_best_acc_score: 0.7730; val_best_f1_score: 0.7944; train_kl_reg_loss: 31124.2936; train_edge_recon_loss: 2953736.0000; train_gene_expr_recon_loss: 779611.3194; train_masked_gp_l1_reg_loss: 6179.5526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89667.2049; train_chrom_access_recon_loss: 450363.4618; train_global_loss: 4310681.8889; train_optim_loss: 4310681.8889; val_kl_reg_loss: 41301.7695; val_edge_recon_loss: 2920621.7500; val_gene_expr_recon_loss: 767553.3750; val_masked_gp_l1_reg_loss: 6309.2393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85755.3828; val_chrom_access_recon_loss: 456511.4375; val_global_loss: 4278053.0000; val_optim_loss: 4278053.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9028; val_auprc_score: 0.8843; val_best_acc_score: 0.8215; val_best_f1_score: 0.8346; train_kl_reg_loss: 43605.4510; train_edge_recon_loss: 2832673.3056; train_gene_expr_recon_loss: 764925.6944; train_masked_gp_l1_reg_loss: 6367.9576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82803.7153; train_chrom_access_recon_loss: 447815.3368; train_global_loss: 4178191.4167; train_optim_loss: 4178191.4167; val_kl_reg_loss: 40685.3984; val_edge_recon_loss: 2803158.5000; val_gene_expr_recon_loss: 768105.8750; val_masked_gp_l1_reg_loss: 6418.1104; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79214.7031; val_chrom_access_recon_loss: 455024.1250; val_global_loss: 4152607.0000; val_optim_loss: 4152607.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9282; val_auprc_score: 0.9076; val_best_acc_score: 0.8665; val_best_f1_score: 0.8718; train_kl_reg_loss: 38732.9844; train_edge_recon_loss: 2761461.8611; train_gene_expr_recon_loss: 757987.9653; train_masked_gp_l1_reg_loss: 6443.9114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76544.8524; train_chrom_access_recon_loss: 449155.7778; train_global_loss: 4090327.3333; train_optim_loss: 4090327.3333; val_kl_reg_loss: 34452.1484; val_edge_recon_loss: 2761984.7500; val_gene_expr_recon_loss: 748252.2500; val_masked_gp_l1_reg_loss: 6460.9580; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73308.9141; val_chrom_access_recon_loss: 453396.3438; val_global_loss: 4077855.5000; val_optim_loss: 4077855.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9243; val_auprc_score: 0.8986; val_best_acc_score: 0.8645; val_best_f1_score: 0.8720; train_kl_reg_loss: 36101.7882; train_edge_recon_loss: 2745432.4167; train_gene_expr_recon_loss: 748083.2153; train_masked_gp_l1_reg_loss: 6452.6665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70885.0521; train_chrom_access_recon_loss: 443824.4826; train_global_loss: 4050779.6111; train_optim_loss: 4050779.6111; val_kl_reg_loss: 38358.1953; val_edge_recon_loss: 2772678.2500; val_gene_expr_recon_loss: 740929.0000; val_masked_gp_l1_reg_loss: 6439.5483; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67957.4609; val_chrom_access_recon_loss: 451795.3750; val_global_loss: 4078158.0000; val_optim_loss: 4078158.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9309; val_auprc_score: 0.9030; val_best_acc_score: 0.8760; val_best_f1_score: 0.8818; train_kl_reg_loss: 40462.1445; train_edge_recon_loss: 2730053.1944; train_gene_expr_recon_loss: 737395.4028; train_masked_gp_l1_reg_loss: 6436.0411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65758.6988; train_chrom_access_recon_loss: 443371.1389; train_global_loss: 4023476.6389; train_optim_loss: 4023476.6389; val_kl_reg_loss: 41994.1797; val_edge_recon_loss: 2754453.5000; val_gene_expr_recon_loss: 733572.0000; val_masked_gp_l1_reg_loss: 6433.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63117.2969; val_chrom_access_recon_loss: 450750.1875; val_global_loss: 4050321.2500; val_optim_loss: 4050321.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9361; val_auprc_score: 0.9119; val_best_acc_score: 0.8790; val_best_f1_score: 0.8856; train_kl_reg_loss: 42543.4635; train_edge_recon_loss: 2732292.6944; train_gene_expr_recon_loss: 728385.4028; train_masked_gp_l1_reg_loss: 6422.6260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61133.5417; train_chrom_access_recon_loss: 441904.4306; train_global_loss: 4012682.0833; train_optim_loss: 4012682.0833; val_kl_reg_loss: 40826.0508; val_edge_recon_loss: 2712673.7500; val_gene_expr_recon_loss: 730440.1250; val_masked_gp_l1_reg_loss: 6419.7114; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58750.1758; val_chrom_access_recon_loss: 449750.0000; val_global_loss: 3998860.0000; val_optim_loss: 3998860.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9404; val_auprc_score: 0.9198; val_best_acc_score: 0.8849; val_best_f1_score: 0.8906; train_kl_reg_loss: 41355.9787; train_edge_recon_loss: 2724127.5556; train_gene_expr_recon_loss: 723537.1806; train_masked_gp_l1_reg_loss: 6417.4782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56988.5595; train_chrom_access_recon_loss: 441410.7778; train_global_loss: 3993837.4722; train_optim_loss: 3993837.4722; val_kl_reg_loss: 39499.2109; val_edge_recon_loss: 2718685.7500; val_gene_expr_recon_loss: 723693.0000; val_masked_gp_l1_reg_loss: 6412.9639; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54865.1250; val_chrom_access_recon_loss: 448832.3125; val_global_loss: 3991988.2500; val_optim_loss: 3991988.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9434; val_auprc_score: 0.9243; val_best_acc_score: 0.8883; val_best_f1_score: 0.8944; train_kl_reg_loss: 40503.3902; train_edge_recon_loss: 2720176.6944; train_gene_expr_recon_loss: 721565.0139; train_masked_gp_l1_reg_loss: 6413.2497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53285.9453; train_chrom_access_recon_loss: 439977.8264; train_global_loss: 3981922.1389; train_optim_loss: 3981922.1389; val_kl_reg_loss: 39939.7891; val_edge_recon_loss: 2717017.0000; val_gene_expr_recon_loss: 720572.5000; val_masked_gp_l1_reg_loss: 6417.1582; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51382.2266; val_chrom_access_recon_loss: 447929.1875; val_global_loss: 3983258.0000; val_optim_loss: 3983258.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9444; val_auprc_score: 0.9261; val_best_acc_score: 0.8937; val_best_f1_score: 0.8980; train_kl_reg_loss: 40702.7131; train_edge_recon_loss: 2725400.6944; train_gene_expr_recon_loss: 719848.6181; train_masked_gp_l1_reg_loss: 6428.3755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49967.4839; train_chrom_access_recon_loss: 442297.0104; train_global_loss: 3984644.8889; train_optim_loss: 3984644.8889; val_kl_reg_loss: 39501.5039; val_edge_recon_loss: 2727172.0000; val_gene_expr_recon_loss: 717268.2500; val_masked_gp_l1_reg_loss: 6442.5791; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48264.8047; val_chrom_access_recon_loss: 447356.0625; val_global_loss: 3986005.0000; val_optim_loss: 3986005.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9456; val_auprc_score: 0.9257; val_best_acc_score: 0.8941; val_best_f1_score: 0.8987; train_kl_reg_loss: 39972.9627; train_edge_recon_loss: 2722265.8333; train_gene_expr_recon_loss: 715280.0000; train_masked_gp_l1_reg_loss: 6465.2609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46991.0026; train_chrom_access_recon_loss: 441470.8542; train_global_loss: 3972445.7778; train_optim_loss: 3972445.7778; val_kl_reg_loss: 38634.0312; val_edge_recon_loss: 2731337.2500; val_gene_expr_recon_loss: 712871.3125; val_masked_gp_l1_reg_loss: 6484.1455; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45438.8594; val_chrom_access_recon_loss: 446646.9375; val_global_loss: 3981412.5000; val_optim_loss: 3981412.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9462; val_auprc_score: 0.9293; val_best_acc_score: 0.8922; val_best_f1_score: 0.8961; train_kl_reg_loss: 39154.3594; train_edge_recon_loss: 2721499.4722; train_gene_expr_recon_loss: 708803.9236; train_masked_gp_l1_reg_loss: 6507.3102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44268.5560; train_chrom_access_recon_loss: 438339.8854; train_global_loss: 3958573.5000; train_optim_loss: 3958573.5000; val_kl_reg_loss: 38680.1172; val_edge_recon_loss: 2747410.2500; val_gene_expr_recon_loss: 712318.5000; val_masked_gp_l1_reg_loss: 6522.0615; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42835.5547; val_chrom_access_recon_loss: 445523.8750; val_global_loss: 3993290.0000; val_optim_loss: 3993290.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9514; val_auprc_score: 0.9374; val_best_acc_score: 0.8963; val_best_f1_score: 0.9007; train_kl_reg_loss: 38805.6528; train_edge_recon_loss: 2729279.1667; train_gene_expr_recon_loss: 709646.0278; train_masked_gp_l1_reg_loss: 6542.7542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41764.5699; train_chrom_access_recon_loss: 438543.1215; train_global_loss: 3964581.2500; train_optim_loss: 3964581.2500; val_kl_reg_loss: 38057.5703; val_edge_recon_loss: 2703778.2500; val_gene_expr_recon_loss: 707223.1250; val_masked_gp_l1_reg_loss: 6565.1826; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40461.9102; val_chrom_access_recon_loss: 444984.3750; val_global_loss: 3941070.5000; val_optim_loss: 3941070.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9548; val_auprc_score: 0.9406; val_best_acc_score: 0.9011; val_best_f1_score: 0.9051; train_kl_reg_loss: 38886.3090; train_edge_recon_loss: 2723646.6944; train_gene_expr_recon_loss: 701847.9167; train_masked_gp_l1_reg_loss: 6589.8810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39483.9484; train_chrom_access_recon_loss: 437277.2708; train_global_loss: 3947732.0278; train_optim_loss: 3947732.0278; val_kl_reg_loss: 37532.1328; val_edge_recon_loss: 2703981.0000; val_gene_expr_recon_loss: 704376.3750; val_masked_gp_l1_reg_loss: 6609.4038; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38289.4883; val_chrom_access_recon_loss: 444206.3125; val_global_loss: 3934994.7500; val_optim_loss: 3934994.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9541; val_auprc_score: 0.9395; val_best_acc_score: 0.8992; val_best_f1_score: 0.9038; train_kl_reg_loss: 37397.2131; train_edge_recon_loss: 2705407.2222; train_gene_expr_recon_loss: 703154.1042; train_masked_gp_l1_reg_loss: 6633.1427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37398.0699; train_chrom_access_recon_loss: 437790.1736; train_global_loss: 3927779.9722; train_optim_loss: 3927779.9722; val_kl_reg_loss: 36389.5625; val_edge_recon_loss: 2716162.5000; val_gene_expr_recon_loss: 702199.3750; val_masked_gp_l1_reg_loss: 6652.3535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36307.2344; val_chrom_access_recon_loss: 443612.5000; val_global_loss: 3941323.5000; val_optim_loss: 3941323.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9612; val_auprc_score: 0.9497; val_best_acc_score: 0.9081; val_best_f1_score: 0.9118; train_kl_reg_loss: 37162.6163; train_edge_recon_loss: 2705119.8889; train_gene_expr_recon_loss: 698524.5208; train_masked_gp_l1_reg_loss: 6684.1462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35496.1050; train_chrom_access_recon_loss: 436159.5521; train_global_loss: 3919146.8056; train_optim_loss: 3919146.8056; val_kl_reg_loss: 36936.4688; val_edge_recon_loss: 2720543.7500; val_gene_expr_recon_loss: 700684.0000; val_masked_gp_l1_reg_loss: 6710.3379; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34498.9648; val_chrom_access_recon_loss: 443356.4375; val_global_loss: 3942730.0000; val_optim_loss: 3942730.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9635; val_auprc_score: 0.9494; val_best_acc_score: 0.9117; val_best_f1_score: 0.9148; train_kl_reg_loss: 37084.6406; train_edge_recon_loss: 2709894.2500; train_gene_expr_recon_loss: 696575.9306; train_masked_gp_l1_reg_loss: 6738.5594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33750.8802; train_chrom_access_recon_loss: 434188.5799; train_global_loss: 3918232.8056; train_optim_loss: 3918232.8056; val_kl_reg_loss: 35027.0703; val_edge_recon_loss: 2714186.0000; val_gene_expr_recon_loss: 700914.9375; val_masked_gp_l1_reg_loss: 6762.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32830.4531; val_chrom_access_recon_loss: 442543.4688; val_global_loss: 3932264.2500; val_optim_loss: 3932264.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9696; val_auprc_score: 0.9563; val_best_acc_score: 0.9243; val_best_f1_score: 0.9272; train_kl_reg_loss: 30546.5395; train_edge_recon_loss: 2695180.1389; train_gene_expr_recon_loss: 1034597.7986; train_masked_gp_l1_reg_loss: 6783.9611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31869.6172; train_chrom_access_recon_loss: 463563.5174; train_global_loss: 4262541.5556; train_optim_loss: 4262541.5556; val_kl_reg_loss: 9639.2959; val_edge_recon_loss: 2713038.2500; val_gene_expr_recon_loss: 1025626.2500; val_masked_gp_l1_reg_loss: 6787.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30536.8164; val_chrom_access_recon_loss: 468782.3750; val_global_loss: 4254410.0000; val_optim_loss: 4254410.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9717; val_auprc_score: 0.9571; val_best_acc_score: 0.9289; val_best_f1_score: 0.9316; train_kl_reg_loss: 24969.9926; train_edge_recon_loss: 2679394.1389; train_gene_expr_recon_loss: 1030806.8889; train_masked_gp_l1_reg_loss: 6800.0559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29395.1083; train_chrom_access_recon_loss: 461119.5208; train_global_loss: 4232485.6944; train_optim_loss: 4232485.6944; val_kl_reg_loss: 9292.1055; val_edge_recon_loss: 2669742.7500; val_gene_expr_recon_loss: 1036372.1250; val_masked_gp_l1_reg_loss: 6806.8379; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27978.8379; val_chrom_access_recon_loss: 469541.1250; val_global_loss: 4219733.5000; val_optim_loss: 4219733.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9738; val_auprc_score: 0.9615; val_best_acc_score: 0.9282; val_best_f1_score: 0.9308; train_kl_reg_loss: 22179.2391; train_edge_recon_loss: 2654529.1111; train_gene_expr_recon_loss: 1027219.1319; train_masked_gp_l1_reg_loss: 6804.6936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26900.2470; train_chrom_access_recon_loss: 460606.6944; train_global_loss: 4198239.0556; train_optim_loss: 4198239.0556; val_kl_reg_loss: 9133.5898; val_edge_recon_loss: 2664586.0000; val_gene_expr_recon_loss: 1029584.4375; val_masked_gp_l1_reg_loss: 6798.6494; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25592.4062; val_chrom_access_recon_loss: 468831.2500; val_global_loss: 4204526.5000; val_optim_loss: 4204526.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9712; val_auprc_score: 0.9583; val_best_acc_score: 0.9263; val_best_f1_score: 0.9291; train_kl_reg_loss: 21538.4525; train_edge_recon_loss: 2655045.9167; train_gene_expr_recon_loss: 1020463.4514; train_masked_gp_l1_reg_loss: 6799.2546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24631.8878; train_chrom_access_recon_loss: 459885.9201; train_global_loss: 4188364.8611; train_optim_loss: 4188364.8611; val_kl_reg_loss: 9652.6895; val_edge_recon_loss: 2663869.0000; val_gene_expr_recon_loss: 1023324.8750; val_masked_gp_l1_reg_loss: 6800.4790; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23479.3828; val_chrom_access_recon_loss: 467804.2500; val_global_loss: 4194931.0000; val_optim_loss: 4194931.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9721; val_auprc_score: 0.9608; val_best_acc_score: 0.9271; val_best_f1_score: 0.9297; train_kl_reg_loss: 21581.7524; train_edge_recon_loss: 2656715.3333; train_gene_expr_recon_loss: 1018022.6875; train_masked_gp_l1_reg_loss: 6771.4954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23294.8947; train_chrom_access_recon_loss: 459609.5278; train_global_loss: 4185995.6944; train_optim_loss: 4185995.6944; val_kl_reg_loss: 9500.9688; val_edge_recon_loss: 2669462.2500; val_gene_expr_recon_loss: 1025738.8750; val_masked_gp_l1_reg_loss: 6744.3330; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23091.5391; val_chrom_access_recon_loss: 467947.0312; val_global_loss: 4202485.0000; val_optim_loss: 4202485.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9713; val_auprc_score: 0.9611; val_best_acc_score: 0.9266; val_best_f1_score: 0.9299; train_kl_reg_loss: 21377.6847; train_edge_recon_loss: 2656190.1111; train_gene_expr_recon_loss: 1019476.4931; train_masked_gp_l1_reg_loss: 6737.5403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22968.8481; train_chrom_access_recon_loss: 460507.6181; train_global_loss: 4187258.3611; train_optim_loss: 4187258.3611; val_kl_reg_loss: 9558.4980; val_edge_recon_loss: 2661401.0000; val_gene_expr_recon_loss: 1022320.6250; val_masked_gp_l1_reg_loss: 6726.3193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22810.1797; val_chrom_access_recon_loss: 467619.0938; val_global_loss: 4190435.5000; val_optim_loss: 4190435.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9710; val_auprc_score: 0.9592; val_best_acc_score: 0.9263; val_best_f1_score: 0.9290; train_kl_reg_loss: 21312.6710; train_edge_recon_loss: 2656306.4444; train_gene_expr_recon_loss: 1017669.3819; train_masked_gp_l1_reg_loss: 6720.4345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22696.5814; train_chrom_access_recon_loss: 460498.4167; train_global_loss: 4185203.9722; train_optim_loss: 4185203.9722; val_kl_reg_loss: 9476.8584; val_edge_recon_loss: 2660215.2500; val_gene_expr_recon_loss: 1024195.8750; val_masked_gp_l1_reg_loss: 6714.2295; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22558.3379; val_chrom_access_recon_loss: 467785.7500; val_global_loss: 4190946.2500; val_optim_loss: 4190946.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9731; val_auprc_score: 0.9591; val_best_acc_score: 0.9266; val_best_f1_score: 0.9290; train_kl_reg_loss: 21000.2873; train_edge_recon_loss: 2657529.5833; train_gene_expr_recon_loss: 1020690.0417; train_masked_gp_l1_reg_loss: 6710.6915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22454.0951; train_chrom_access_recon_loss: 460386.2153; train_global_loss: 4188770.8611; train_optim_loss: 4188770.8611; val_kl_reg_loss: 9579.5811; val_edge_recon_loss: 2659900.7500; val_gene_expr_recon_loss: 1023197.0000; val_masked_gp_l1_reg_loss: 6706.9707; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22329.8984; val_chrom_access_recon_loss: 467708.6875; val_global_loss: 4189423.0000; val_optim_loss: 4189423.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9655
val AUPRC score: 0.9529
val best accuracy score: 0.9120
val best F1 score: 0.9154
val target rna MSE score: 3.8010
val source rna MSE score: 3.2888
val target atac MSE score: 0.1350
val source atac MSE score: 0.0220
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
