[True]
Run timestamp: 10082023_235752_106.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_106']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7467; val_auprc_score: 0.7785; val_best_acc_score: 0.5856; val_best_f1_score: 0.6967; train_kl_reg_loss: 289328.4414; train_edge_recon_loss: 3967432.1641; train_gene_expr_recon_loss: 48999770.9618; train_masked_gp_l1_reg_loss: 83903.1982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245747.6560; train_chrom_access_recon_loss: 128925663.0229; train_global_loss: 182511845.3740; train_optim_loss: 182511845.3740; val_kl_reg_loss: 218582.7406; val_edge_recon_loss: 4059891.1667; val_gene_expr_recon_loss: 39494468.0000; val_masked_gp_l1_reg_loss: 81297.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 244008.2344; val_chrom_access_recon_loss: 116862946.1333; val_global_loss: 160961191.4667; val_optim_loss: 160961191.4667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7817; val_auprc_score: 0.8048; val_best_acc_score: 0.7018; val_best_f1_score: 0.7058; train_kl_reg_loss: 204219.1286; train_edge_recon_loss: 3914552.0840; train_gene_expr_recon_loss: 38529730.1985; train_masked_gp_l1_reg_loss: 79178.0850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240671.7329; train_chrom_access_recon_loss: 115943988.4580; train_global_loss: 158912339.5420; train_optim_loss: 158912339.5420; val_kl_reg_loss: 148203.3833; val_edge_recon_loss: 4041393.2333; val_gene_expr_recon_loss: 37955993.6000; val_masked_gp_l1_reg_loss: 79455.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 236593.7500; val_chrom_access_recon_loss: 116556300.2667; val_global_loss: 159017936.0000; val_optim_loss: 159017936.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7968; val_auprc_score: 0.8138; val_best_acc_score: 0.7088; val_best_f1_score: 0.7145; train_kl_reg_loss: 396145.5973; train_edge_recon_loss: 3760208.2156; train_gene_expr_recon_loss: 38011047.7557; train_masked_gp_l1_reg_loss: 81456.4856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231833.2573; train_chrom_access_recon_loss: 115139023.3893; train_global_loss: 157619714.9313; train_optim_loss: 157619714.9313; val_kl_reg_loss: 238106.8896; val_edge_recon_loss: 4016948.0000; val_gene_expr_recon_loss: 37478135.7333; val_masked_gp_l1_reg_loss: 81383.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 226439.1406; val_chrom_access_recon_loss: 114807147.2000; val_global_loss: 156848163.2000; val_optim_loss: 156848163.2000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8674; val_auprc_score: 0.8685; val_best_acc_score: 0.7838; val_best_f1_score: 0.7986; train_kl_reg_loss: 210798.8331; train_edge_recon_loss: 3579297.6889; train_gene_expr_recon_loss: 37090361.5878; train_masked_gp_l1_reg_loss: 81037.6572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 220573.1029; train_chrom_access_recon_loss: 114212210.3817; train_global_loss: 155394279.6947; train_optim_loss: 155394279.6947; val_kl_reg_loss: 207789.5167; val_edge_recon_loss: 3825883.0667; val_gene_expr_recon_loss: 37072986.9333; val_masked_gp_l1_reg_loss: 81173.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 214581.1562; val_chrom_access_recon_loss: 114446824.0000; val_global_loss: 155849236.2667; val_optim_loss: 155849236.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8803; val_auprc_score: 0.8706; val_best_acc_score: 0.7976; val_best_f1_score: 0.8143; train_kl_reg_loss: 191282.9973; train_edge_recon_loss: 3354014.6164; train_gene_expr_recon_loss: 36708058.6565; train_masked_gp_l1_reg_loss: 82028.9769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 208789.6398; train_chrom_access_recon_loss: 113295942.8397; train_global_loss: 153840118.4733; train_optim_loss: 153840118.4733; val_kl_reg_loss: 212206.5427; val_edge_recon_loss: 3158596.0333; val_gene_expr_recon_loss: 36668937.6000; val_masked_gp_l1_reg_loss: 82901.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202994.0625; val_chrom_access_recon_loss: 112879372.2667; val_global_loss: 153205008.0000; val_optim_loss: 153205008.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8960; val_auprc_score: 0.8842; val_best_acc_score: 0.8147; val_best_f1_score: 0.8280; train_kl_reg_loss: 231060.4245; train_edge_recon_loss: 3096069.4370; train_gene_expr_recon_loss: 36485149.1298; train_masked_gp_l1_reg_loss: 83390.0313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197618.8427; train_chrom_access_recon_loss: 112644082.4427; train_global_loss: 152737370.9924; train_optim_loss: 152737370.9924; val_kl_reg_loss: 230029.3396; val_edge_recon_loss: 3061019.0000; val_gene_expr_recon_loss: 36482581.3333; val_masked_gp_l1_reg_loss: 84407.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192418.3594; val_chrom_access_recon_loss: 112206438.9333; val_global_loss: 152256898.1333; val_optim_loss: 152256898.1333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9070; val_auprc_score: 0.8958; val_best_acc_score: 0.8262; val_best_f1_score: 0.8372; train_kl_reg_loss: 236184.2069; train_edge_recon_loss: 3018497.9275; train_gene_expr_recon_loss: 36297730.5038; train_masked_gp_l1_reg_loss: 85303.1848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187452.3978; train_chrom_access_recon_loss: 112056977.1603; train_global_loss: 151882145.4656; train_optim_loss: 151882145.4656; val_kl_reg_loss: 231602.8208; val_edge_recon_loss: 3012325.4167; val_gene_expr_recon_loss: 36280693.3333; val_masked_gp_l1_reg_loss: 86004.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182502.5312; val_chrom_access_recon_loss: 112191956.2667; val_global_loss: 151985085.8667; val_optim_loss: 151985085.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9103; val_auprc_score: 0.8962; val_best_acc_score: 0.8325; val_best_f1_score: 0.8431; train_kl_reg_loss: 230803.7724; train_edge_recon_loss: 2973903.3664; train_gene_expr_recon_loss: 36037527.0840; train_masked_gp_l1_reg_loss: 86988.8496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178017.9062; train_chrom_access_recon_loss: 111308619.2366; train_global_loss: 150815860.8855; train_optim_loss: 150815860.8855; val_kl_reg_loss: 221285.1698; val_edge_recon_loss: 2984401.1500; val_gene_expr_recon_loss: 36050599.4667; val_masked_gp_l1_reg_loss: 87563.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173557.6719; val_chrom_access_recon_loss: 111258176.5333; val_global_loss: 150775581.8667; val_optim_loss: 150775581.8667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9133; val_auprc_score: 0.8977; val_best_acc_score: 0.8406; val_best_f1_score: 0.8516; train_kl_reg_loss: 223398.2021; train_edge_recon_loss: 2947382.0191; train_gene_expr_recon_loss: 35880056.3511; train_masked_gp_l1_reg_loss: 88375.7811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169349.1413; train_chrom_access_recon_loss: 110892904.8550; train_global_loss: 150201465.7710; train_optim_loss: 150201465.7710; val_kl_reg_loss: 220502.4052; val_edge_recon_loss: 2950364.8333; val_gene_expr_recon_loss: 35916666.4000; val_masked_gp_l1_reg_loss: 88886.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165153.6562; val_chrom_access_recon_loss: 110630904.0000; val_global_loss: 149972475.7333; val_optim_loss: 149972475.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9299; val_auprc_score: 0.9167; val_best_acc_score: 0.8614; val_best_f1_score: 0.8694; train_kl_reg_loss: 215668.3067; train_edge_recon_loss: 2925964.7156; train_gene_expr_recon_loss: 35711127.7099; train_masked_gp_l1_reg_loss: 89766.7590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 161119.8453; train_chrom_access_recon_loss: 110405104.9771; train_global_loss: 149508751.7557; train_optim_loss: 149508751.7557; val_kl_reg_loss: 210057.3750; val_edge_recon_loss: 2906940.6000; val_gene_expr_recon_loss: 35877113.0667; val_masked_gp_l1_reg_loss: 90699.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157158.3750; val_chrom_access_recon_loss: 110786333.8667; val_global_loss: 150028304.0000; val_optim_loss: 150028304.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9313; val_auprc_score: 0.9182; val_best_acc_score: 0.8603; val_best_f1_score: 0.8706; train_kl_reg_loss: 211676.3458; train_edge_recon_loss: 2901216.9027; train_gene_expr_recon_loss: 35599857.1908; train_masked_gp_l1_reg_loss: 91482.1250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153400.9156; train_chrom_access_recon_loss: 110143102.2901; train_global_loss: 149100735.0229; train_optim_loss: 149100735.0229; val_kl_reg_loss: 210498.9062; val_edge_recon_loss: 2916044.3333; val_gene_expr_recon_loss: 35750270.9333; val_masked_gp_l1_reg_loss: 92131.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149723.0625; val_chrom_access_recon_loss: 110404673.6000; val_global_loss: 149523345.0667; val_optim_loss: 149523345.0667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9361; val_auprc_score: 0.9217; val_best_acc_score: 0.8688; val_best_f1_score: 0.8775; train_kl_reg_loss: 204221.1771; train_edge_recon_loss: 2890249.7366; train_gene_expr_recon_loss: 35496436.5802; train_masked_gp_l1_reg_loss: 93061.4473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146247.5812; train_chrom_access_recon_loss: 109783244.7023; train_global_loss: 148613460.8855; train_optim_loss: 148613460.8855; val_kl_reg_loss: 199036.6177; val_edge_recon_loss: 2899253.5167; val_gene_expr_recon_loss: 35796107.2000; val_masked_gp_l1_reg_loss: 93904.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142845.6094; val_chrom_access_recon_loss: 110277266.1333; val_global_loss: 149408409.6000; val_optim_loss: 149408409.6000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9398; val_auprc_score: 0.9276; val_best_acc_score: 0.8736; val_best_f1_score: 0.8801; train_kl_reg_loss: 198957.2358; train_edge_recon_loss: 2877111.0802; train_gene_expr_recon_loss: 35292833.0992; train_masked_gp_l1_reg_loss: 94904.6661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139672.0354; train_chrom_access_recon_loss: 109374194.8702; train_global_loss: 147977672.4275; train_optim_loss: 147977672.4275; val_kl_reg_loss: 195555.8219; val_edge_recon_loss: 2874469.6167; val_gene_expr_recon_loss: 35315119.4667; val_masked_gp_l1_reg_loss: 95887.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136666.1562; val_chrom_access_recon_loss: 109393963.2000; val_global_loss: 148011664.0000; val_optim_loss: 148011664.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9431; val_auprc_score: 0.9335; val_best_acc_score: 0.8716; val_best_f1_score: 0.8791; train_kl_reg_loss: 193591.0615; train_edge_recon_loss: 2870954.6336; train_gene_expr_recon_loss: 35141862.4580; train_masked_gp_l1_reg_loss: 96521.1013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133780.0122; train_chrom_access_recon_loss: 109129361.4046; train_global_loss: 147566070.8397; train_optim_loss: 147566070.8397; val_kl_reg_loss: 188671.5823; val_edge_recon_loss: 2870173.9333; val_gene_expr_recon_loss: 35152654.6667; val_masked_gp_l1_reg_loss: 97432.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131039.1562; val_chrom_access_recon_loss: 108384631.4667; val_global_loss: 146824604.8000; val_optim_loss: 146824604.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9453; val_auprc_score: 0.9360; val_best_acc_score: 0.8779; val_best_f1_score: 0.8859; train_kl_reg_loss: 190612.1684; train_edge_recon_loss: 2859952.4752; train_gene_expr_recon_loss: 35034015.5573; train_masked_gp_l1_reg_loss: 98127.8896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128518.0121; train_chrom_access_recon_loss: 108746988.2748; train_global_loss: 147058214.4733; train_optim_loss: 147058214.4733; val_kl_reg_loss: 188062.8458; val_edge_recon_loss: 2857623.0000; val_gene_expr_recon_loss: 35108905.8667; val_masked_gp_l1_reg_loss: 98835.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126058.7734; val_chrom_access_recon_loss: 108648106.1333; val_global_loss: 147027593.6000; val_optim_loss: 147027593.6000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9466; val_auprc_score: 0.9355; val_best_acc_score: 0.8787; val_best_f1_score: 0.8859; train_kl_reg_loss: 187259.4107; train_edge_recon_loss: 2844581.3569; train_gene_expr_recon_loss: 34966689.8779; train_masked_gp_l1_reg_loss: 99697.9595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123852.2555; train_chrom_access_recon_loss: 108596725.3740; train_global_loss: 146818805.7405; train_optim_loss: 146818805.7405; val_kl_reg_loss: 181514.4229; val_edge_recon_loss: 2861236.0167; val_gene_expr_recon_loss: 35131361.8667; val_masked_gp_l1_reg_loss: 100610.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121701.0781; val_chrom_access_recon_loss: 109119784.5333; val_global_loss: 147516208.0000; val_optim_loss: 147516208.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9505; val_auprc_score: 0.9417; val_best_acc_score: 0.8867; val_best_f1_score: 0.8934; train_kl_reg_loss: 182140.9072; train_edge_recon_loss: 2844972.9275; train_gene_expr_recon_loss: 34863426.8397; train_masked_gp_l1_reg_loss: 101298.4075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119612.9266; train_chrom_access_recon_loss: 108091139.4809; train_global_loss: 146202591.0229; train_optim_loss: 146202591.0229; val_kl_reg_loss: 176349.5865; val_edge_recon_loss: 2838834.7167; val_gene_expr_recon_loss: 35105087.7333; val_masked_gp_l1_reg_loss: 102019.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117633.9141; val_chrom_access_recon_loss: 108867993.0667; val_global_loss: 147207916.8000; val_optim_loss: 147207916.8000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9516; val_auprc_score: 0.9400; val_best_acc_score: 0.8895; val_best_f1_score: 0.8953; train_kl_reg_loss: 179102.2625; train_edge_recon_loss: 2840346.8473; train_gene_expr_recon_loss: 34798214.2290; train_masked_gp_l1_reg_loss: 102776.8396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115709.2364; train_chrom_access_recon_loss: 107977845.0076; train_global_loss: 146013994.5038; train_optim_loss: 146013994.5038; val_kl_reg_loss: 174101.0573; val_edge_recon_loss: 2840474.4000; val_gene_expr_recon_loss: 34915551.7333; val_masked_gp_l1_reg_loss: 103435.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113736.1484; val_chrom_access_recon_loss: 107780814.4000; val_global_loss: 145928113.0667; val_optim_loss: 145928113.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9526; val_auprc_score: 0.9433; val_best_acc_score: 0.8915; val_best_f1_score: 0.8967; train_kl_reg_loss: 176318.5959; train_edge_recon_loss: 2825920.1126; train_gene_expr_recon_loss: 34728715.8015; train_masked_gp_l1_reg_loss: 104249.9878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111905.2362; train_chrom_access_recon_loss: 107685242.5038; train_global_loss: 145632352.0000; train_optim_loss: 145632352.0000; val_kl_reg_loss: 169247.9010; val_edge_recon_loss: 2837600.2500; val_gene_expr_recon_loss: 34871020.0000; val_masked_gp_l1_reg_loss: 104814.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110147.4766; val_chrom_access_recon_loss: 107595867.2000; val_global_loss: 145688700.8000; val_optim_loss: 145688700.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9551; val_auprc_score: 0.9465; val_best_acc_score: 0.8942; val_best_f1_score: 0.8999; train_kl_reg_loss: 173310.5892; train_edge_recon_loss: 2816389.8511; train_gene_expr_recon_loss: 34724893.2061; train_masked_gp_l1_reg_loss: 105607.7210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108363.7097; train_chrom_access_recon_loss: 107836085.2519; train_global_loss: 145764649.8931; train_optim_loss: 145764649.8931; val_kl_reg_loss: 170277.9500; val_edge_recon_loss: 2831621.2667; val_gene_expr_recon_loss: 34623056.9333; val_masked_gp_l1_reg_loss: 106427.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106610.4219; val_chrom_access_recon_loss: 106809477.3333; val_global_loss: 144647475.7333; val_optim_loss: 144647475.7333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9588; val_auprc_score: 0.9522; val_best_acc_score: 0.8956; val_best_f1_score: 0.9012; train_kl_reg_loss: 171003.6342; train_edge_recon_loss: 2819771.5973; train_gene_expr_recon_loss: 34634108.0916; train_masked_gp_l1_reg_loss: 107024.1240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104985.5536; train_chrom_access_recon_loss: 107461261.9847; train_global_loss: 145298154.8702; train_optim_loss: 145298154.8702; val_kl_reg_loss: 171640.5719; val_edge_recon_loss: 2825238.9833; val_gene_expr_recon_loss: 34781681.3333; val_masked_gp_l1_reg_loss: 107590.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103540.6641; val_chrom_access_recon_loss: 107827147.7333; val_global_loss: 145816841.6000; val_optim_loss: 145816841.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9590; val_auprc_score: 0.9516; val_best_acc_score: 0.8991; val_best_f1_score: 0.9026; train_kl_reg_loss: 169349.3102; train_edge_recon_loss: 2807791.4618; train_gene_expr_recon_loss: 34589968.3664; train_masked_gp_l1_reg_loss: 108256.7928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102010.4139; train_chrom_access_recon_loss: 107304335.3893; train_global_loss: 145081712.1221; train_optim_loss: 145081712.1221; val_kl_reg_loss: 166609.8521; val_edge_recon_loss: 2818926.4333; val_gene_expr_recon_loss: 34709244.0000; val_masked_gp_l1_reg_loss: 108740.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100407.8828; val_chrom_access_recon_loss: 106948737.0667; val_global_loss: 144852665.6000; val_optim_loss: 144852665.6000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9595; val_auprc_score: 0.9511; val_best_acc_score: 0.8979; val_best_f1_score: 0.9025; train_kl_reg_loss: 167480.0859; train_edge_recon_loss: 2812323.3607; train_gene_expr_recon_loss: 34556407.4351; train_masked_gp_l1_reg_loss: 109446.2672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98950.4465; train_chrom_access_recon_loss: 107330158.5344; train_global_loss: 145074765.8015; train_optim_loss: 145074765.8015; val_kl_reg_loss: 166101.0969; val_edge_recon_loss: 2801253.3833; val_gene_expr_recon_loss: 34691802.1333; val_masked_gp_l1_reg_loss: 110065.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97751.2969; val_chrom_access_recon_loss: 107230006.9333; val_global_loss: 145096980.2667; val_optim_loss: 145096980.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9596; val_auprc_score: 0.9544; val_best_acc_score: 0.8942; val_best_f1_score: 0.8987; train_kl_reg_loss: 165275.4742; train_edge_recon_loss: 2806033.0649; train_gene_expr_recon_loss: 34425231.7252; train_masked_gp_l1_reg_loss: 110862.7687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96381.6065; train_chrom_access_recon_loss: 106840658.3817; train_global_loss: 144444442.0153; train_optim_loss: 144444442.0153; val_kl_reg_loss: 162907.8833; val_edge_recon_loss: 2827571.8500; val_gene_expr_recon_loss: 34609517.0667; val_masked_gp_l1_reg_loss: 111638.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95053.6484; val_chrom_access_recon_loss: 107172692.8000; val_global_loss: 144979383.4667; val_optim_loss: 144979383.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9643; val_auprc_score: 0.9590; val_best_acc_score: 0.9015; val_best_f1_score: 0.9043; train_kl_reg_loss: 164358.3964; train_edge_recon_loss: 2803093.6527; train_gene_expr_recon_loss: 34409699.3893; train_masked_gp_l1_reg_loss: 109749.1607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94442.3577; train_chrom_access_recon_loss: 106816888.1832; train_global_loss: 144398231.3282; train_optim_loss: 144398231.3282; val_kl_reg_loss: 164411.5448; val_edge_recon_loss: 2810894.0833; val_gene_expr_recon_loss: 34552487.7333; val_masked_gp_l1_reg_loss: 108748.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93976.2891; val_chrom_access_recon_loss: 106858173.8667; val_global_loss: 144588691.2000; val_optim_loss: 144588691.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9579; val_auprc_score: 0.9515; val_best_acc_score: 0.8950; val_best_f1_score: 0.8987; train_kl_reg_loss: 175877.4660; train_edge_recon_loss: 3237029.1851; train_gene_expr_recon_loss: 40012508.0611; train_masked_gp_l1_reg_loss: 108774.3819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94582.2499; train_chrom_access_recon_loss: 111271161.1603; train_global_loss: 154899932.0916; train_optim_loss: 154899932.0916; val_kl_reg_loss: 27831.9270; val_edge_recon_loss: 3232546.9500; val_gene_expr_recon_loss: 39556521.0667; val_masked_gp_l1_reg_loss: 108736.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95385.4844; val_chrom_access_recon_loss: 111014349.3333; val_global_loss: 154035370.6667; val_optim_loss: 154035370.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9562; val_auprc_score: 0.9498; val_best_acc_score: 0.8918; val_best_f1_score: 0.8962; train_kl_reg_loss: 191544.8469; train_edge_recon_loss: 3178875.3626; train_gene_expr_recon_loss: 39265516.8855; train_masked_gp_l1_reg_loss: 108548.6470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95894.2089; train_chrom_access_recon_loss: 110969613.1298; train_global_loss: 153809993.4046; train_optim_loss: 153809993.4046; val_kl_reg_loss: 30642.1602; val_edge_recon_loss: 3166975.1500; val_gene_expr_recon_loss: 39456292.2667; val_masked_gp_l1_reg_loss: 108339.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96323.2266; val_chrom_access_recon_loss: 111194450.1333; val_global_loss: 154053022.9333; val_optim_loss: 154053022.9333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9573; val_auprc_score: 0.9496; val_best_acc_score: 0.8950; val_best_f1_score: 0.8979; train_kl_reg_loss: 198326.0321; train_edge_recon_loss: 3139426.5973; train_gene_expr_recon_loss: 39361631.8473; train_masked_gp_l1_reg_loss: 108150.3794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96633.3755; train_chrom_access_recon_loss: 110998749.6183; train_global_loss: 153902918.4733; train_optim_loss: 153902918.4733; val_kl_reg_loss: 27078.4165; val_edge_recon_loss: 3168701.6500; val_gene_expr_recon_loss: 39945273.0667; val_masked_gp_l1_reg_loss: 107966.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96906.5703; val_chrom_access_recon_loss: 111619497.6000; val_global_loss: 154965430.4000; val_optim_loss: 154965430.4000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9577; val_auprc_score: 0.9515; val_best_acc_score: 0.8926; val_best_f1_score: 0.8966; train_kl_reg_loss: 199388.7558; train_edge_recon_loss: 3094603.5324; train_gene_expr_recon_loss: 40380857.6489; train_masked_gp_l1_reg_loss: 107850.3523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97342.2718; train_chrom_access_recon_loss: 111697472.9771; train_global_loss: 155577515.7252; train_optim_loss: 155577515.7252; val_kl_reg_loss: 25147.3857; val_edge_recon_loss: 3062384.5000; val_gene_expr_recon_loss: 41064575.2000; val_masked_gp_l1_reg_loss: 107737.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97814.4062; val_chrom_access_recon_loss: 111656337.6000; val_global_loss: 156013996.8000; val_optim_loss: 156013996.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9553; val_auprc_score: 0.9454; val_best_acc_score: 0.8969; val_best_f1_score: 0.9013; train_kl_reg_loss: 197559.8158; train_edge_recon_loss: 3051390.8282; train_gene_expr_recon_loss: 41058294.5344; train_masked_gp_l1_reg_loss: 107699.5251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97861.2533; train_chrom_access_recon_loss: 112241153.3435; train_global_loss: 156753959.4504; train_optim_loss: 156753959.4504; val_kl_reg_loss: 25030.3240; val_edge_recon_loss: 3036268.7667; val_gene_expr_recon_loss: 41209066.9333; val_masked_gp_l1_reg_loss: 107677.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97907.0391; val_chrom_access_recon_loss: 112248275.2000; val_global_loss: 156724225.0667; val_optim_loss: 156724225.0667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9598; val_auprc_score: 0.9542; val_best_acc_score: 0.8971; val_best_f1_score: 0.9001; train_kl_reg_loss: 196869.3088; train_edge_recon_loss: 3038952.2462; train_gene_expr_recon_loss: 41120407.2977; train_masked_gp_l1_reg_loss: 107651.0781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97944.2649; train_chrom_access_recon_loss: 112254702.4122; train_global_loss: 156816526.4122; train_optim_loss: 156816526.4122; val_kl_reg_loss: 24930.1529; val_edge_recon_loss: 3044179.0667; val_gene_expr_recon_loss: 41202767.7333; val_masked_gp_l1_reg_loss: 107621.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97981.3438; val_chrom_access_recon_loss: 112512864.0000; val_global_loss: 156990342.4000; val_optim_loss: 156990342.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9528; val_auprc_score: 0.9403; val_best_acc_score: 0.8957; val_best_f1_score: 0.9005; train_kl_reg_loss: 196299.5924; train_edge_recon_loss: 3030236.2271; train_gene_expr_recon_loss: 41190488.4275; train_masked_gp_l1_reg_loss: 107584.8660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98010.0982; train_chrom_access_recon_loss: 112313943.1450; train_global_loss: 156936562.4427; train_optim_loss: 156936562.4427; val_kl_reg_loss: 25134.4355; val_edge_recon_loss: 3057241.4333; val_gene_expr_recon_loss: 41326121.3333; val_masked_gp_l1_reg_loss: 107546.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98039.9297; val_chrom_access_recon_loss: 112717466.1333; val_global_loss: 157331552.0000; val_optim_loss: 157331552.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9556; val_auprc_score: 0.9470; val_best_acc_score: 0.8961; val_best_f1_score: 0.9009; train_kl_reg_loss: 195595.6401; train_edge_recon_loss: 3033514.7805; train_gene_expr_recon_loss: 41153751.2672; train_masked_gp_l1_reg_loss: 107504.3258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98061.7810; train_chrom_access_recon_loss: 112046084.8244; train_global_loss: 156634512.8550; train_optim_loss: 156634512.8550; val_kl_reg_loss: 23720.5051; val_edge_recon_loss: 3013729.0500; val_gene_expr_recon_loss: 41837851.4667; val_masked_gp_l1_reg_loss: 107460.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98084.3359; val_chrom_access_recon_loss: 112834186.1333; val_global_loss: 157915029.3333; val_optim_loss: 157915029.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 16 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9579
val AUPRC score: 0.9475
val best accuracy score: 0.8957
val best F1 score: 0.9005
val target rna MSE score: 1.6359
val source rna MSE score: 33.7955
val target atac MSE score: 0.1274
val source atac MSE score: 1.4197
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
