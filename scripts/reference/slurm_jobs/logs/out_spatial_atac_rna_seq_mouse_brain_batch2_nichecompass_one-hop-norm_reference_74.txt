[True]
Run timestamp: 24072023_171043_74.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_74']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9127; val_auprc_score: 0.9240; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 30451.8037; train_edge_recon_loss: 34755593.7778; train_gene_expr_recon_loss: 32233308.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1102061.6389; train_global_loss: 68121415.5556; train_optim_loss: 68121415.5556; val_kl_reg_loss: 186529.3281; val_edge_recon_loss: 40654472.0000; val_gene_expr_recon_loss: 30493982.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1074425.5000; val_global_loss: 72409408.0000; val_optim_loss: 72409408.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9055; val_auprc_score: 0.9191; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 105269.6780; train_edge_recon_loss: 34864593.3333; train_gene_expr_recon_loss: 29929817.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1090782.7292; train_global_loss: 65990462.2222; train_optim_loss: 65990462.2222; val_kl_reg_loss: 54616.6875; val_edge_recon_loss: 40654292.0000; val_gene_expr_recon_loss: 28558492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059088.3750; val_global_loss: 70326488.0000; val_optim_loss: 70326488.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9016; val_auprc_score: 0.9141; val_best_acc_score: 0.5046; val_best_f1_score: 0.6687; train_kl_reg_loss: 160303.1775; train_edge_recon_loss: 34827471.1111; train_gene_expr_recon_loss: 27642909.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1054670.0903; train_global_loss: 63685354.2222; train_optim_loss: 63685354.2222; val_kl_reg_loss: 59440.0625; val_edge_recon_loss: 40652036.0000; val_gene_expr_recon_loss: 26844650.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1043308.7500; val_global_loss: 68599440.0000; val_optim_loss: 68599440.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8959; val_auprc_score: 0.9079; val_best_acc_score: 0.5042; val_best_f1_score: 0.6685; train_kl_reg_loss: 195919.6480; train_edge_recon_loss: 34861824.8889; train_gene_expr_recon_loss: 25810632.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1033152.1597; train_global_loss: 61901528.8889; train_optim_loss: 61901528.8889; val_kl_reg_loss: 146907.4062; val_edge_recon_loss: 40652792.0000; val_gene_expr_recon_loss: 25029596.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1028176.4375; val_global_loss: 66857472.0000; val_optim_loss: 66857472.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8960; val_auprc_score: 0.9040; val_best_acc_score: 0.5031; val_best_f1_score: 0.6680; train_kl_reg_loss: 231952.0399; train_edge_recon_loss: 34835007.1111; train_gene_expr_recon_loss: 24157975.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1017084.4792; train_global_loss: 60242019.5556; train_optim_loss: 60242019.5556; val_kl_reg_loss: 255480.9062; val_edge_recon_loss: 40653544.0000; val_gene_expr_recon_loss: 23937456.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016761.5000; val_global_loss: 65863240.0000; val_optim_loss: 65863240.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8950; val_auprc_score: 0.8996; val_best_acc_score: 0.5065; val_best_f1_score: 0.6696; train_kl_reg_loss: 297777.4201; train_edge_recon_loss: 34832757.3333; train_gene_expr_recon_loss: 23411976.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1009355.5069; train_global_loss: 59551868.0000; train_optim_loss: 59551868.0000; val_kl_reg_loss: 218796.6719; val_edge_recon_loss: 40650952.0000; val_gene_expr_recon_loss: 23119136.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1006330.7500; val_global_loss: 64995216.0000; val_optim_loss: 64995216.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8902; val_auprc_score: 0.8954; val_best_acc_score: 0.5104; val_best_f1_score: 0.6713; train_kl_reg_loss: 323823.5747; train_edge_recon_loss: 34843269.3333; train_gene_expr_recon_loss: 22606709.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 995119.6042; train_global_loss: 58768921.7778; train_optim_loss: 58768921.7778; val_kl_reg_loss: 261859.2500; val_edge_recon_loss: 40647116.0000; val_gene_expr_recon_loss: 22514924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998697.0625; val_global_loss: 64422596.0000; val_optim_loss: 64422596.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8938; val_auprc_score: 0.8934; val_best_acc_score: 0.5206; val_best_f1_score: 0.6759; train_kl_reg_loss: 331732.7847; train_edge_recon_loss: 34823690.6667; train_gene_expr_recon_loss: 22071047.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986122.0208; train_global_loss: 58212592.8889; train_optim_loss: 58212592.8889; val_kl_reg_loss: 404779.2500; val_edge_recon_loss: 40640696.0000; val_gene_expr_recon_loss: 22065916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 994759.5000; val_global_loss: 64106152.0000; val_optim_loss: 64106152.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8949; val_auprc_score: 0.8926; val_best_acc_score: 0.5397; val_best_f1_score: 0.6845; train_kl_reg_loss: 369111.2188; train_edge_recon_loss: 34813388.4444; train_gene_expr_recon_loss: 21655356.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988855.3403; train_global_loss: 57826711.5556; train_optim_loss: 57826711.5556; val_kl_reg_loss: 310421.0312; val_edge_recon_loss: 40628688.0000; val_gene_expr_recon_loss: 21773092.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 989640.0000; val_global_loss: 63701840.0000; val_optim_loss: 63701840.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9015; val_auprc_score: 0.9006; val_best_acc_score: 0.5560; val_best_f1_score: 0.6921; train_kl_reg_loss: 345078.2153; train_edge_recon_loss: 34850195.1111; train_gene_expr_recon_loss: 21395896.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979952.5694; train_global_loss: 57571121.3333; train_optim_loss: 57571121.3333; val_kl_reg_loss: 288993.6250; val_edge_recon_loss: 40620820.0000; val_gene_expr_recon_loss: 21547934.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 987646.1875; val_global_loss: 63445392.0000; val_optim_loss: 63445392.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9062; val_auprc_score: 0.8986; val_best_acc_score: 0.6024; val_best_f1_score: 0.7148; train_kl_reg_loss: 339136.2049; train_edge_recon_loss: 34835030.6667; train_gene_expr_recon_loss: 21203383.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983220.7500; train_global_loss: 57360770.6667; train_optim_loss: 57360770.6667; val_kl_reg_loss: 222123.2500; val_edge_recon_loss: 40600360.0000; val_gene_expr_recon_loss: 21445476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 986172.4375; val_global_loss: 63254132.0000; val_optim_loss: 63254132.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9147; val_auprc_score: 0.9100; val_best_acc_score: 0.6448; val_best_f1_score: 0.7368; train_kl_reg_loss: 334848.8420; train_edge_recon_loss: 34823860.0000; train_gene_expr_recon_loss: 21148947.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980498.5556; train_global_loss: 57288154.2222; train_optim_loss: 57288154.2222; val_kl_reg_loss: 284428.7500; val_edge_recon_loss: 40577988.0000; val_gene_expr_recon_loss: 21341132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984188.7500; val_global_loss: 63187736.0000; val_optim_loss: 63187736.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9148; val_auprc_score: 0.9065; val_best_acc_score: 0.7101; val_best_f1_score: 0.7727; train_kl_reg_loss: 307315.9514; train_edge_recon_loss: 34834964.4444; train_gene_expr_recon_loss: 21070502.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981096.7431; train_global_loss: 57193879.1111; train_optim_loss: 57193879.1111; val_kl_reg_loss: 242307.4375; val_edge_recon_loss: 40535448.0000; val_gene_expr_recon_loss: 21284588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982971.4375; val_global_loss: 63045316.0000; val_optim_loss: 63045316.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9162; val_auprc_score: 0.9092; val_best_acc_score: 0.7650; val_best_f1_score: 0.8051; train_kl_reg_loss: 319068.4410; train_edge_recon_loss: 34818167.1111; train_gene_expr_recon_loss: 21103244.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983483.8264; train_global_loss: 57223964.4444; train_optim_loss: 57223964.4444; val_kl_reg_loss: 219708.2812; val_edge_recon_loss: 40475164.0000; val_gene_expr_recon_loss: 21218696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 981945.0000; val_global_loss: 62895512.0000; val_optim_loss: 62895512.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9184; val_auprc_score: 0.9070; val_best_acc_score: 0.8111; val_best_f1_score: 0.8334; train_kl_reg_loss: 294683.6007; train_edge_recon_loss: 34825628.0000; train_gene_expr_recon_loss: 20927776.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976867.3611; train_global_loss: 57024954.6667; train_optim_loss: 57024954.6667; val_kl_reg_loss: 230378.5156; val_edge_recon_loss: 40367496.0000; val_gene_expr_recon_loss: 21165696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 981064.6250; val_global_loss: 62744636.0000; val_optim_loss: 62744636.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9159; val_auprc_score: 0.9042; val_best_acc_score: 0.8362; val_best_f1_score: 0.8462; train_kl_reg_loss: 283725.0868; train_edge_recon_loss: 34804857.3333; train_gene_expr_recon_loss: 20886309.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980273.0972; train_global_loss: 56955165.3333; train_optim_loss: 56955165.3333; val_kl_reg_loss: 209038.5000; val_edge_recon_loss: 40218624.0000; val_gene_expr_recon_loss: 21107694.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979139.8750; val_global_loss: 62514500.0000; val_optim_loss: 62514500.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9174; val_auprc_score: 0.9062; val_best_acc_score: 0.8356; val_best_f1_score: 0.8325; train_kl_reg_loss: 275995.4948; train_edge_recon_loss: 34763506.6667; train_gene_expr_recon_loss: 20910884.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973760.2639; train_global_loss: 56924146.6667; train_optim_loss: 56924146.6667; val_kl_reg_loss: 224727.3125; val_edge_recon_loss: 39906360.0000; val_gene_expr_recon_loss: 21058170.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978232.3125; val_global_loss: 62167488.0000; val_optim_loss: 62167488.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9082; val_auprc_score: 0.8914; val_best_acc_score: 0.7976; val_best_f1_score: 0.8226; train_kl_reg_loss: 249843.0642; train_edge_recon_loss: 34724229.7778; train_gene_expr_recon_loss: 20729746.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970925.8681; train_global_loss: 56674744.8889; train_optim_loss: 56674744.8889; val_kl_reg_loss: 192138.8125; val_edge_recon_loss: 39259292.0000; val_gene_expr_recon_loss: 21017416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975954.3750; val_global_loss: 61444804.0000; val_optim_loss: 61444804.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9167; val_auprc_score: 0.9026; val_best_acc_score: 0.8374; val_best_f1_score: 0.8482; train_kl_reg_loss: 212327.0781; train_edge_recon_loss: 34569462.2222; train_gene_expr_recon_loss: 20713829.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967861.2500; train_global_loss: 56463480.0000; train_optim_loss: 56463480.0000; val_kl_reg_loss: 179930.5938; val_edge_recon_loss: 37697456.0000; val_gene_expr_recon_loss: 21063044.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978589.3750; val_global_loss: 59919020.0000; val_optim_loss: 59919020.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9030; val_auprc_score: 0.8881; val_best_acc_score: 0.8239; val_best_f1_score: 0.8352; train_kl_reg_loss: 138565.6606; train_edge_recon_loss: 33863622.4444; train_gene_expr_recon_loss: 20879307.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973746.5556; train_global_loss: 55855242.2222; train_optim_loss: 55855242.2222; val_kl_reg_loss: 82482.7344; val_edge_recon_loss: 33562476.0000; val_gene_expr_recon_loss: 21428948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984204.8750; val_global_loss: 56058112.0000; val_optim_loss: 56058112.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8941; val_auprc_score: 0.8782; val_best_acc_score: 0.8041; val_best_f1_score: 0.8166; train_kl_reg_loss: 72977.7626; train_edge_recon_loss: 31134532.0000; train_gene_expr_recon_loss: 21499764.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984826.1111; train_global_loss: 53692098.6667; train_optim_loss: 53692098.6667; val_kl_reg_loss: 94390.8125; val_edge_recon_loss: 29554376.0000; val_gene_expr_recon_loss: 21975896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 995798.4375; val_global_loss: 52620464.0000; val_optim_loss: 52620464.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8826; val_auprc_score: 0.8599; val_best_acc_score: 0.7963; val_best_f1_score: 0.8116; train_kl_reg_loss: 144316.3490; train_edge_recon_loss: 29481223.7778; train_gene_expr_recon_loss: 21312118.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 992571.8819; train_global_loss: 51930228.8889; train_optim_loss: 51930228.8889; val_kl_reg_loss: 194638.8750; val_edge_recon_loss: 29466570.0000; val_gene_expr_recon_loss: 21565416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1083151.0000; val_global_loss: 52309776.0000; val_optim_loss: 52309776.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8904; val_auprc_score: 0.8689; val_best_acc_score: 0.8084; val_best_f1_score: 0.8275; train_kl_reg_loss: 218460.4635; train_edge_recon_loss: 29011838.4444; train_gene_expr_recon_loss: 21166913.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 990200.4792; train_global_loss: 51387413.3333; train_optim_loss: 51387413.3333; val_kl_reg_loss: 228351.9375; val_edge_recon_loss: 28890810.0000; val_gene_expr_recon_loss: 21267798.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 981368.6875; val_global_loss: 51368328.0000; val_optim_loss: 51368328.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9001; val_auprc_score: 0.8845; val_best_acc_score: 0.8106; val_best_f1_score: 0.8277; train_kl_reg_loss: 237380.1545; train_edge_recon_loss: 29117808.0000; train_gene_expr_recon_loss: 21096331.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972515.8542; train_global_loss: 51424034.6667; train_optim_loss: 51424034.6667; val_kl_reg_loss: 204132.8906; val_edge_recon_loss: 28953364.0000; val_gene_expr_recon_loss: 21289596.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979375.3125; val_global_loss: 51426468.0000; val_optim_loss: 51426468.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8842; val_auprc_score: 0.8604; val_best_acc_score: 0.8108; val_best_f1_score: 0.8291; train_kl_reg_loss: 203730.1493; train_edge_recon_loss: 29305025.5556; train_gene_expr_recon_loss: 20994851.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975941.2639; train_global_loss: 51479548.4444; train_optim_loss: 51479548.4444; val_kl_reg_loss: 203850.5000; val_edge_recon_loss: 29288142.0000; val_gene_expr_recon_loss: 21252752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978511.5000; val_global_loss: 51723256.0000; val_optim_loss: 51723256.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8903; val_auprc_score: 0.8646; val_best_acc_score: 0.8142; val_best_f1_score: 0.8318; train_kl_reg_loss: 252032.1337; train_edge_recon_loss: 29128725.3333; train_gene_expr_recon_loss: 21070928.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977841.6181; train_global_loss: 51429527.5556; train_optim_loss: 51429527.5556; val_kl_reg_loss: 216463.8594; val_edge_recon_loss: 28807572.0000; val_gene_expr_recon_loss: 21256574.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978921.2500; val_global_loss: 51259528.0000; val_optim_loss: 51259528.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8746; val_auprc_score: 0.8413; val_best_acc_score: 0.8114; val_best_f1_score: 0.8309; train_kl_reg_loss: 324283.1736; train_edge_recon_loss: 28939653.1111; train_gene_expr_recon_loss: 20815851.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972083.1111; train_global_loss: 51051870.6667; train_optim_loss: 51051870.6667; val_kl_reg_loss: 230679.9219; val_edge_recon_loss: 28826290.0000; val_gene_expr_recon_loss: 21584268.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976332.8125; val_global_loss: 51617572.0000; val_optim_loss: 51617572.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8966; val_auprc_score: 0.8775; val_best_acc_score: 0.8138; val_best_f1_score: 0.8334; train_kl_reg_loss: 281625.8906; train_edge_recon_loss: 28707071.1111; train_gene_expr_recon_loss: 20934407.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982122.9931; train_global_loss: 50905226.6667; train_optim_loss: 50905226.6667; val_kl_reg_loss: 182386.9375; val_edge_recon_loss: 28966418.0000; val_gene_expr_recon_loss: 21122058.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975910.3750; val_global_loss: 51246776.0000; val_optim_loss: 51246776.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8837; val_auprc_score: 0.8537; val_best_acc_score: 0.8191; val_best_f1_score: 0.8376; train_kl_reg_loss: 256499.9410; train_edge_recon_loss: 28662375.7778; train_gene_expr_recon_loss: 20862120.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972657.2917; train_global_loss: 50753654.2222; train_optim_loss: 50753654.2222; val_kl_reg_loss: 192725.6094; val_edge_recon_loss: 28470266.0000; val_gene_expr_recon_loss: 21124042.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975762.5000; val_global_loss: 50762796.0000; val_optim_loss: 50762796.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8717; val_auprc_score: 0.8371; val_best_acc_score: 0.8107; val_best_f1_score: 0.8331; train_kl_reg_loss: 277241.7760; train_edge_recon_loss: 28598276.8889; train_gene_expr_recon_loss: 20816156.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972669.4236; train_global_loss: 50664343.5556; train_optim_loss: 50664343.5556; val_kl_reg_loss: 211551.7812; val_edge_recon_loss: 28698698.0000; val_gene_expr_recon_loss: 21056948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974065.8750; val_global_loss: 50941264.0000; val_optim_loss: 50941264.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8797; val_auprc_score: 0.8502; val_best_acc_score: 0.8119; val_best_f1_score: 0.8338; train_kl_reg_loss: 290585.0938; train_edge_recon_loss: 28401857.1111; train_gene_expr_recon_loss: 20742427.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968793.8056; train_global_loss: 50403663.5556; train_optim_loss: 50403663.5556; val_kl_reg_loss: 213329.8125; val_edge_recon_loss: 28501100.0000; val_gene_expr_recon_loss: 21016744.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974082.5625; val_global_loss: 50705260.0000; val_optim_loss: 50705260.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8914; val_auprc_score: 0.8621; val_best_acc_score: 0.8212; val_best_f1_score: 0.8417; train_kl_reg_loss: 280665.6597; train_edge_recon_loss: 28169073.7778; train_gene_expr_recon_loss: 20807318.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966799.0069; train_global_loss: 50223856.8889; train_optim_loss: 50223856.8889; val_kl_reg_loss: 202735.5156; val_edge_recon_loss: 27885106.0000; val_gene_expr_recon_loss: 21013226.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972446.7500; val_global_loss: 50073516.0000; val_optim_loss: 50073516.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8847; val_auprc_score: 0.8580; val_best_acc_score: 0.8131; val_best_f1_score: 0.8352; train_kl_reg_loss: 266050.0729; train_edge_recon_loss: 28111812.6667; train_gene_expr_recon_loss: 20670794.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969184.1319; train_global_loss: 50017840.4444; train_optim_loss: 50017840.4444; val_kl_reg_loss: 200539.3125; val_edge_recon_loss: 28218352.0000; val_gene_expr_recon_loss: 21007276.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973552.1250; val_global_loss: 50399720.0000; val_optim_loss: 50399720.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8902; val_auprc_score: 0.8602; val_best_acc_score: 0.8182; val_best_f1_score: 0.8387; train_kl_reg_loss: 267523.5260; train_edge_recon_loss: 27922669.3333; train_gene_expr_recon_loss: 20618866.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961445.0556; train_global_loss: 49770505.3333; train_optim_loss: 49770505.3333; val_kl_reg_loss: 206862.3750; val_edge_recon_loss: 28093318.0000; val_gene_expr_recon_loss: 20965120.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971374.0625; val_global_loss: 50236676.0000; val_optim_loss: 50236676.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8940; val_auprc_score: 0.8666; val_best_acc_score: 0.8170; val_best_f1_score: 0.8365; train_kl_reg_loss: 279532.1354; train_edge_recon_loss: 27800176.8889; train_gene_expr_recon_loss: 20619192.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963831.0486; train_global_loss: 49662732.4444; train_optim_loss: 49662732.4444; val_kl_reg_loss: 221956.6875; val_edge_recon_loss: 28250558.0000; val_gene_expr_recon_loss: 20890088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968558.1875; val_global_loss: 50331160.0000; val_optim_loss: 50331160.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8992; val_auprc_score: 0.8733; val_best_acc_score: 0.8248; val_best_f1_score: 0.8412; train_kl_reg_loss: 292027.9896; train_edge_recon_loss: 27701601.3333; train_gene_expr_recon_loss: 20495967.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961790.1458; train_global_loss: 49451385.7778; train_optim_loss: 49451385.7778; val_kl_reg_loss: 228775.5625; val_edge_recon_loss: 27806246.0000; val_gene_expr_recon_loss: 20895910.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969999.1250; val_global_loss: 49900932.0000; val_optim_loss: 49900932.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9118; val_auprc_score: 0.8953; val_best_acc_score: 0.8297; val_best_f1_score: 0.8468; train_kl_reg_loss: 294152.9722; train_edge_recon_loss: 27552992.6667; train_gene_expr_recon_loss: 20645864.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961779.5208; train_global_loss: 49454790.2222; train_optim_loss: 49454790.2222; val_kl_reg_loss: 233665.3438; val_edge_recon_loss: 27748082.0000; val_gene_expr_recon_loss: 20862810.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968707.8125; val_global_loss: 49813268.0000; val_optim_loss: 49813268.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9079; val_auprc_score: 0.8849; val_best_acc_score: 0.8305; val_best_f1_score: 0.8455; train_kl_reg_loss: 303466.2674; train_edge_recon_loss: 27559621.5556; train_gene_expr_recon_loss: 20421001.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963461.1181; train_global_loss: 49247551.1111; train_optim_loss: 49247551.1111; val_kl_reg_loss: 249036.4688; val_edge_recon_loss: 27878534.0000; val_gene_expr_recon_loss: 20828820.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968327.6250; val_global_loss: 49924720.0000; val_optim_loss: 49924720.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9156; val_auprc_score: 0.8927; val_best_acc_score: 0.8386; val_best_f1_score: 0.8521; train_kl_reg_loss: 315587.6597; train_edge_recon_loss: 27603810.0000; train_gene_expr_recon_loss: 20466381.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964485.1806; train_global_loss: 49350264.4444; train_optim_loss: 49350264.4444; val_kl_reg_loss: 252324.7500; val_edge_recon_loss: 27613094.0000; val_gene_expr_recon_loss: 20789068.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966783.6250; val_global_loss: 49621272.0000; val_optim_loss: 49621272.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9116; val_auprc_score: 0.8958; val_best_acc_score: 0.8321; val_best_f1_score: 0.8463; train_kl_reg_loss: 315185.3889; train_edge_recon_loss: 27384276.6667; train_gene_expr_recon_loss: 20413378.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957101.6250; train_global_loss: 49069941.7778; train_optim_loss: 49069941.7778; val_kl_reg_loss: 251159.4531; val_edge_recon_loss: 28054390.0000; val_gene_expr_recon_loss: 20766380.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966594.0000; val_global_loss: 50038520.0000; val_optim_loss: 50038520.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9189; val_auprc_score: 0.8975; val_best_acc_score: 0.8456; val_best_f1_score: 0.8573; train_kl_reg_loss: 311588.6354; train_edge_recon_loss: 27481250.4444; train_gene_expr_recon_loss: 20429200.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961871.7847; train_global_loss: 49183912.0000; train_optim_loss: 49183912.0000; val_kl_reg_loss: 251093.3281; val_edge_recon_loss: 27457172.0000; val_gene_expr_recon_loss: 20724598.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965361.1875; val_global_loss: 49398224.0000; val_optim_loss: 49398224.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9209; val_auprc_score: 0.8982; val_best_acc_score: 0.8492; val_best_f1_score: 0.8619; train_kl_reg_loss: 321670.6111; train_edge_recon_loss: 27326576.0000; train_gene_expr_recon_loss: 20369172.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961484.3472; train_global_loss: 48978903.1111; train_optim_loss: 48978903.1111; val_kl_reg_loss: 262900.5625; val_edge_recon_loss: 27386740.0000; val_gene_expr_recon_loss: 20730292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964617.3125; val_global_loss: 49344548.0000; val_optim_loss: 49344548.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9213; val_auprc_score: 0.9019; val_best_acc_score: 0.8521; val_best_f1_score: 0.8614; train_kl_reg_loss: 330865.5694; train_edge_recon_loss: 27403291.7778; train_gene_expr_recon_loss: 20248583.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958573.3333; train_global_loss: 48941313.7778; train_optim_loss: 48941313.7778; val_kl_reg_loss: 270167.8125; val_edge_recon_loss: 27557698.0000; val_gene_expr_recon_loss: 20703654.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965676.3125; val_global_loss: 49497196.0000; val_optim_loss: 49497196.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9213; val_auprc_score: 0.9030; val_best_acc_score: 0.8500; val_best_f1_score: 0.8603; train_kl_reg_loss: 324612.7778; train_edge_recon_loss: 27270532.6667; train_gene_expr_recon_loss: 20248922.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 951119.1042; train_global_loss: 48795187.5556; train_optim_loss: 48795187.5556; val_kl_reg_loss: 262291.0938; val_edge_recon_loss: 27772590.0000; val_gene_expr_recon_loss: 20657738.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964376.5625; val_global_loss: 49656996.0000; val_optim_loss: 49656996.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9303; val_auprc_score: 0.9160; val_best_acc_score: 0.8583; val_best_f1_score: 0.8687; train_kl_reg_loss: 322909.4722; train_edge_recon_loss: 27370075.5556; train_gene_expr_recon_loss: 20278846.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 953251.5694; train_global_loss: 48925082.6667; train_optim_loss: 48925082.6667; val_kl_reg_loss: 263624.7812; val_edge_recon_loss: 27508906.0000; val_gene_expr_recon_loss: 20664002.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963083.2500; val_global_loss: 49399616.0000; val_optim_loss: 49399616.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9262; val_auprc_score: 0.9054; val_best_acc_score: 0.8553; val_best_f1_score: 0.8652; train_kl_reg_loss: 322976.1667; train_edge_recon_loss: 27235737.3333; train_gene_expr_recon_loss: 20554320.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960188.5069; train_global_loss: 49073223.5556; train_optim_loss: 49073223.5556; val_kl_reg_loss: 250807.9062; val_edge_recon_loss: 27853892.0000; val_gene_expr_recon_loss: 20693512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962881.9375; val_global_loss: 49761092.0000; val_optim_loss: 49761092.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9352; val_auprc_score: 0.9168; val_best_acc_score: 0.8654; val_best_f1_score: 0.8751; train_kl_reg_loss: 308439.0590; train_edge_recon_loss: 27446739.3333; train_gene_expr_recon_loss: 20404905.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958589.0694; train_global_loss: 49118672.4444; train_optim_loss: 49118672.4444; val_kl_reg_loss: 246828.0312; val_edge_recon_loss: 27468664.0000; val_gene_expr_recon_loss: 20650506.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963086.7500; val_global_loss: 49329088.0000; val_optim_loss: 49329088.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9304; val_auprc_score: 0.9080; val_best_acc_score: 0.8624; val_best_f1_score: 0.8701; train_kl_reg_loss: 305971.2847; train_edge_recon_loss: 27447323.5556; train_gene_expr_recon_loss: 20329948.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959466.9444; train_global_loss: 49042709.7778; train_optim_loss: 49042709.7778; val_kl_reg_loss: 245815.5469; val_edge_recon_loss: 27683878.0000; val_gene_expr_recon_loss: 20634384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962948.3750; val_global_loss: 49527028.0000; val_optim_loss: 49527028.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9356; val_auprc_score: 0.9181; val_best_acc_score: 0.8673; val_best_f1_score: 0.8755; train_kl_reg_loss: 304344.9688; train_edge_recon_loss: 27496249.1111; train_gene_expr_recon_loss: 20350520.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957525.7778; train_global_loss: 49108640.4444; train_optim_loss: 49108640.4444; val_kl_reg_loss: 247854.2500; val_edge_recon_loss: 27500746.0000; val_gene_expr_recon_loss: 20619062.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963044.8750; val_global_loss: 49330708.0000; val_optim_loss: 49330708.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9318; val_auprc_score: 0.9153; val_best_acc_score: 0.8615; val_best_f1_score: 0.8708; train_kl_reg_loss: 306352.4062; train_edge_recon_loss: 27512686.2222; train_gene_expr_recon_loss: 20237743.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 956298.1389; train_global_loss: 49013080.8889; train_optim_loss: 49013080.8889; val_kl_reg_loss: 248613.9375; val_edge_recon_loss: 27681738.0000; val_gene_expr_recon_loss: 20616712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961136.8125; val_global_loss: 49508200.0000; val_optim_loss: 49508200.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9354; val_auprc_score: 0.9181; val_best_acc_score: 0.8680; val_best_f1_score: 0.8761; train_kl_reg_loss: 307405.2292; train_edge_recon_loss: 27345962.8889; train_gene_expr_recon_loss: 20224274.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957188.5069; train_global_loss: 48834831.5556; train_optim_loss: 48834831.5556; val_kl_reg_loss: 249304.2344; val_edge_recon_loss: 27448300.0000; val_gene_expr_recon_loss: 20590900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961499.5625; val_global_loss: 49250004.0000; val_optim_loss: 49250004.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9315; val_auprc_score: 0.9138; val_best_acc_score: 0.8577; val_best_f1_score: 0.8683; train_kl_reg_loss: 309149.8576; train_edge_recon_loss: 27295962.8889; train_gene_expr_recon_loss: 20287898.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961131.5208; train_global_loss: 48854142.6667; train_optim_loss: 48854142.6667; val_kl_reg_loss: 249483.7656; val_edge_recon_loss: 27620948.0000; val_gene_expr_recon_loss: 20594032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 960926.4375; val_global_loss: 49425392.0000; val_optim_loss: 49425392.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9300; val_auprc_score: 0.9139; val_best_acc_score: 0.8605; val_best_f1_score: 0.8713; train_kl_reg_loss: 309441.6875; train_edge_recon_loss: 27353236.2222; train_gene_expr_recon_loss: 20193725.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957096.6389; train_global_loss: 48813500.8889; train_optim_loss: 48813500.8889; val_kl_reg_loss: 251274.2656; val_edge_recon_loss: 27503402.0000; val_gene_expr_recon_loss: 20595206.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 960822.0625; val_global_loss: 49310704.0000; val_optim_loss: 49310704.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9341; val_auprc_score: 0.9169; val_best_acc_score: 0.8634; val_best_f1_score: 0.8729; train_kl_reg_loss: 310111.5938; train_edge_recon_loss: 27367785.5556; train_gene_expr_recon_loss: 20296169.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960480.3403; train_global_loss: 48934547.5556; train_optim_loss: 48934547.5556; val_kl_reg_loss: 250396.3594; val_edge_recon_loss: 27543620.0000; val_gene_expr_recon_loss: 20590746.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961146.0000; val_global_loss: 49345904.0000; val_optim_loss: 49345904.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9376; val_auprc_score: 0.9202; val_best_acc_score: 0.8724; val_best_f1_score: 0.8797; train_kl_reg_loss: 308344.3646; train_edge_recon_loss: 27378706.0000; train_gene_expr_recon_loss: 20217730.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 955576.6597; train_global_loss: 48860358.2222; train_optim_loss: 48860358.2222; val_kl_reg_loss: 250724.5625; val_edge_recon_loss: 27242812.0000; val_gene_expr_recon_loss: 20581560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961070.3125; val_global_loss: 49036168.0000; val_optim_loss: 49036168.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9342; val_auprc_score: 0.9183; val_best_acc_score: 0.8674; val_best_f1_score: 0.8755; train_kl_reg_loss: 309841.5104; train_edge_recon_loss: 27247312.8889; train_gene_expr_recon_loss: 20271473.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957727.0486; train_global_loss: 48786355.1111; train_optim_loss: 48786355.1111; val_kl_reg_loss: 251132.4375; val_edge_recon_loss: 27625016.0000; val_gene_expr_recon_loss: 20605814.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961406.7500; val_global_loss: 49443368.0000; val_optim_loss: 49443368.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9404; val_auprc_score: 0.9255; val_best_acc_score: 0.8708; val_best_f1_score: 0.8783; train_kl_reg_loss: 309013.5799; train_edge_recon_loss: 27251514.8889; train_gene_expr_recon_loss: 20133030.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 953107.4236; train_global_loss: 48646666.2222; train_optim_loss: 48646666.2222; val_kl_reg_loss: 252060.7656; val_edge_recon_loss: 27179870.0000; val_gene_expr_recon_loss: 20599024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962146.0625; val_global_loss: 48993100.0000; val_optim_loss: 48993100.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9306; val_auprc_score: 0.9141; val_best_acc_score: 0.8583; val_best_f1_score: 0.8701; train_kl_reg_loss: 310208.3090; train_edge_recon_loss: 27367014.6667; train_gene_expr_recon_loss: 20375716.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958473.5208; train_global_loss: 49011412.8889; train_optim_loss: 49011412.8889; val_kl_reg_loss: 251333.7812; val_edge_recon_loss: 27548180.0000; val_gene_expr_recon_loss: 20589830.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961622.3750; val_global_loss: 49350968.0000; val_optim_loss: 49350968.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9353; val_auprc_score: 0.9181; val_best_acc_score: 0.8665; val_best_f1_score: 0.8768; train_kl_reg_loss: 308845.2812; train_edge_recon_loss: 27322150.4444; train_gene_expr_recon_loss: 20319397.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958211.8542; train_global_loss: 48908604.8889; train_optim_loss: 48908604.8889; val_kl_reg_loss: 252290.0312; val_edge_recon_loss: 27324170.0000; val_gene_expr_recon_loss: 20592556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961613.6875; val_global_loss: 49130628.0000; val_optim_loss: 49130628.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9351; val_auprc_score: 0.9181; val_best_acc_score: 0.8676; val_best_f1_score: 0.8766; train_kl_reg_loss: 309712.8715; train_edge_recon_loss: 27279734.8889; train_gene_expr_recon_loss: 20165673.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 950284.3889; train_global_loss: 48705405.3333; train_optim_loss: 48705405.3333; val_kl_reg_loss: 251964.1875; val_edge_recon_loss: 27301538.0000; val_gene_expr_recon_loss: 20574486.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 960708.1250; val_global_loss: 49088696.0000; val_optim_loss: 49088696.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9391; val_auprc_score: 0.9244; val_best_acc_score: 0.8694; val_best_f1_score: 0.8766; train_kl_reg_loss: 310171.2118; train_edge_recon_loss: 27159197.3333; train_gene_expr_recon_loss: 20295304.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957851.7917; train_global_loss: 48722525.3333; train_optim_loss: 48722525.3333; val_kl_reg_loss: 250112.3125; val_edge_recon_loss: 27284530.0000; val_gene_expr_recon_loss: 20579186.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 960698.7500; val_global_loss: 49074528.0000; val_optim_loss: 49074528.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9275; val_auprc_score: 0.9074; val_best_acc_score: 0.8579; val_best_f1_score: 0.8691; train_kl_reg_loss: 310934.3542; train_edge_recon_loss: 27256094.6667; train_gene_expr_recon_loss: 20185799.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 953189.2569; train_global_loss: 48706017.7778; train_optim_loss: 48706017.7778; val_kl_reg_loss: 251220.2812; val_edge_recon_loss: 27764090.0000; val_gene_expr_recon_loss: 20579906.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961399.8125; val_global_loss: 49556616.0000; val_optim_loss: 49556616.0000
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9354; val_auprc_score: 0.9173; val_best_acc_score: 0.8686; val_best_f1_score: 0.8768; train_kl_reg_loss: 310559.4236; train_edge_recon_loss: 27178050.8889; train_gene_expr_recon_loss: 20230253.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 952838.1875; train_global_loss: 48671701.3333; train_optim_loss: 48671701.3333; val_kl_reg_loss: 250461.6406; val_edge_recon_loss: 27320182.0000; val_gene_expr_recon_loss: 20572476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 960349.0000; val_global_loss: 49103468.0000; val_optim_loss: 49103468.0000
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9348; val_auprc_score: 0.9178; val_best_acc_score: 0.8659; val_best_f1_score: 0.8741; train_kl_reg_loss: 309416.7326; train_edge_recon_loss: 27255868.2222; train_gene_expr_recon_loss: 20234286.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 954693.2847; train_global_loss: 48754264.4444; train_optim_loss: 48754264.4444; val_kl_reg_loss: 249926.6562; val_edge_recon_loss: 27323180.0000; val_gene_expr_recon_loss: 20580816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961070.3750; val_global_loss: 49114992.0000; val_optim_loss: 49114992.0000
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9344; val_auprc_score: 0.9184; val_best_acc_score: 0.8620; val_best_f1_score: 0.8736; train_kl_reg_loss: 308561.1562; train_edge_recon_loss: 27192971.3333; train_gene_expr_recon_loss: 20270098.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 951712.7986; train_global_loss: 48723344.0000; train_optim_loss: 48723344.0000; val_kl_reg_loss: 251143.7969; val_edge_recon_loss: 27382978.0000; val_gene_expr_recon_loss: 20576084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961633.4375; val_global_loss: 49171840.0000; val_optim_loss: 49171840.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 20 sec.
Using best model state, which was in epoch 57.

--- MODEL EVALUATION ---
Val AUROC score: 0.9335
Val AUPRC score: 0.9180
Val best accuracy score: 0.8614
Val best F1 score: 0.8709
Val gene expr MSE score: 0.3794
Val chrom access MSE score: 0.0883
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
