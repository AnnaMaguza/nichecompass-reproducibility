[True]
Run timestamp: 07082023_194305_74.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_74']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8874; val_auprc_score: 0.8998; val_best_acc_score: 0.5055; val_best_f1_score: 0.6691; train_kl_reg_loss: 36547.9054; train_edge_recon_loss: 350927.5694; train_gene_expr_recon_loss: 1389354.9722; train_masked_gp_l1_reg_loss: 4586.8838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119450.7491; train_chrom_access_recon_loss: 3114645.6250; train_global_loss: 5015513.6944; train_optim_loss: 5015513.6944; val_kl_reg_loss: 8673.6104; val_edge_recon_loss: 406523.8750; val_gene_expr_recon_loss: 1143268.6250; val_masked_gp_l1_reg_loss: 4094.7190; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117097.5391; val_chrom_access_recon_loss: 1864375.8750; val_global_loss: 3544034.2500; val_optim_loss: 3544034.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8931; val_auprc_score: 0.9059; val_best_acc_score: 0.5032; val_best_f1_score: 0.6680; train_kl_reg_loss: 7898.8294; train_edge_recon_loss: 353142.6424; train_gene_expr_recon_loss: 1052007.6389; train_masked_gp_l1_reg_loss: 4006.8402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115725.8151; train_chrom_access_recon_loss: 1585272.6667; train_global_loss: 3118054.4722; train_optim_loss: 3118054.4722; val_kl_reg_loss: 7766.3105; val_edge_recon_loss: 406542.6875; val_gene_expr_recon_loss: 974254.1250; val_masked_gp_l1_reg_loss: 4016.6216; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114131.9531; val_chrom_access_recon_loss: 1463932.3750; val_global_loss: 2970644.0000; val_optim_loss: 2970644.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8905; val_auprc_score: 0.9014; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 8961.7470; train_edge_recon_loss: 354386.6181; train_gene_expr_recon_loss: 927503.4583; train_masked_gp_l1_reg_loss: 4178.8165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112981.5434; train_chrom_access_recon_loss: 1439755.5000; train_global_loss: 2847767.7222; train_optim_loss: 2847767.7222; val_kl_reg_loss: 10463.1777; val_edge_recon_loss: 406563.2812; val_gene_expr_recon_loss: 886794.8750; val_masked_gp_l1_reg_loss: 4386.5576; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111568.9688; val_chrom_access_recon_loss: 1415002.1250; val_global_loss: 2834779.0000; val_optim_loss: 2834779.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8826; val_auprc_score: 0.8943; val_best_acc_score: 0.5011; val_best_f1_score: 0.6671; train_kl_reg_loss: 13076.4614; train_edge_recon_loss: 356790.2188; train_gene_expr_recon_loss: 852425.7153; train_masked_gp_l1_reg_loss: 4495.2853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110425.6476; train_chrom_access_recon_loss: 1403053.5556; train_global_loss: 2740266.8889; train_optim_loss: 2740266.8889; val_kl_reg_loss: 16163.6016; val_edge_recon_loss: 406574.7188; val_gene_expr_recon_loss: 815281.2500; val_masked_gp_l1_reg_loss: 4591.3530; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108961.6328; val_chrom_access_recon_loss: 1383363.7500; val_global_loss: 2734936.2500; val_optim_loss: 2734936.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8761; val_auprc_score: 0.8865; val_best_acc_score: 0.5055; val_best_f1_score: 0.6691; train_kl_reg_loss: 18481.6912; train_edge_recon_loss: 359617.0938; train_gene_expr_recon_loss: 792889.3056; train_masked_gp_l1_reg_loss: 4621.7914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107683.7691; train_chrom_access_recon_loss: 1378353.4861; train_global_loss: 2661647.0833; train_optim_loss: 2661647.0833; val_kl_reg_loss: 18388.2930; val_edge_recon_loss: 406544.9375; val_gene_expr_recon_loss: 770326.5000; val_masked_gp_l1_reg_loss: 4632.9761; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105986.5625; val_chrom_access_recon_loss: 1359321.6250; val_global_loss: 2665201.0000; val_optim_loss: 2665201.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8619; val_auprc_score: 0.8686; val_best_acc_score: 0.5143; val_best_f1_score: 0.6730; train_kl_reg_loss: 19387.4108; train_edge_recon_loss: 360156.4722; train_gene_expr_recon_loss: 755802.5278; train_masked_gp_l1_reg_loss: 4629.8669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104473.2188; train_chrom_access_recon_loss: 1350033.3611; train_global_loss: 2594482.8611; train_optim_loss: 2594482.8611; val_kl_reg_loss: 18954.2734; val_edge_recon_loss: 406497.9688; val_gene_expr_recon_loss: 745272.0000; val_masked_gp_l1_reg_loss: 4614.6504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102498.4219; val_chrom_access_recon_loss: 1343408.3750; val_global_loss: 2621245.5000; val_optim_loss: 2621245.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8548; val_auprc_score: 0.8583; val_best_acc_score: 0.5263; val_best_f1_score: 0.6780; train_kl_reg_loss: 20483.4603; train_edge_recon_loss: 360136.6042; train_gene_expr_recon_loss: 736235.7569; train_masked_gp_l1_reg_loss: 4602.0815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100815.6128; train_chrom_access_recon_loss: 1347951.7361; train_global_loss: 2570225.1944; train_optim_loss: 2570225.1944; val_kl_reg_loss: 19937.9336; val_edge_recon_loss: 406387.5312; val_gene_expr_recon_loss: 727249.8125; val_masked_gp_l1_reg_loss: 4575.5557; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98666.8594; val_chrom_access_recon_loss: 1334047.8750; val_global_loss: 2590865.5000; val_optim_loss: 2590865.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8418; val_auprc_score: 0.8432; val_best_acc_score: 0.5305; val_best_f1_score: 0.6781; train_kl_reg_loss: 21130.2593; train_edge_recon_loss: 360007.2361; train_gene_expr_recon_loss: 717746.5903; train_masked_gp_l1_reg_loss: 4564.9688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96902.8438; train_chrom_access_recon_loss: 1340277.8333; train_global_loss: 2540629.7500; train_optim_loss: 2540629.7500; val_kl_reg_loss: 20351.8438; val_edge_recon_loss: 406261.1875; val_gene_expr_recon_loss: 712978.5000; val_masked_gp_l1_reg_loss: 4545.3799; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94681.8438; val_chrom_access_recon_loss: 1326849.7500; val_global_loss: 2565668.5000; val_optim_loss: 2565668.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8429; val_auprc_score: 0.8392; val_best_acc_score: 0.5527; val_best_f1_score: 0.6863; train_kl_reg_loss: 21464.9816; train_edge_recon_loss: 360039.5000; train_gene_expr_recon_loss: 703684.8750; train_masked_gp_l1_reg_loss: 4538.3068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92893.5035; train_chrom_access_recon_loss: 1328321.5556; train_global_loss: 2510942.7222; train_optim_loss: 2510942.7222; val_kl_reg_loss: 21067.0664; val_edge_recon_loss: 405928.0312; val_gene_expr_recon_loss: 702109.8750; val_masked_gp_l1_reg_loss: 4522.1978; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90656.7188; val_chrom_access_recon_loss: 1321604.5000; val_global_loss: 2545888.5000; val_optim_loss: 2545888.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8411; val_auprc_score: 0.8387; val_best_acc_score: 0.5958; val_best_f1_score: 0.7059; train_kl_reg_loss: 21899.8394; train_edge_recon_loss: 360035.6181; train_gene_expr_recon_loss: 695707.3542; train_masked_gp_l1_reg_loss: 4512.8133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88876.0226; train_chrom_access_recon_loss: 1327968.2917; train_global_loss: 2498999.9444; train_optim_loss: 2498999.9444; val_kl_reg_loss: 21311.2383; val_edge_recon_loss: 405489.4062; val_gene_expr_recon_loss: 693516.3125; val_masked_gp_l1_reg_loss: 4496.5073; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86661.5469; val_chrom_access_recon_loss: 1317233.7500; val_global_loss: 2528708.7500; val_optim_loss: 2528708.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8338; val_auprc_score: 0.8244; val_best_acc_score: 0.6467; val_best_f1_score: 0.7297; train_kl_reg_loss: 22276.0790; train_edge_recon_loss: 359911.4201; train_gene_expr_recon_loss: 682693.2153; train_masked_gp_l1_reg_loss: 4499.8126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84924.3264; train_chrom_access_recon_loss: 1312127.3056; train_global_loss: 2466432.1389; train_optim_loss: 2466432.1389; val_kl_reg_loss: 22614.8555; val_edge_recon_loss: 404850.2188; val_gene_expr_recon_loss: 685003.5000; val_masked_gp_l1_reg_loss: 4493.0869; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82771.5625; val_chrom_access_recon_loss: 1313362.2500; val_global_loss: 2513095.5000; val_optim_loss: 2513095.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8106; val_auprc_score: 0.8074; val_best_acc_score: 0.6937; val_best_f1_score: 0.7495; train_kl_reg_loss: 22858.0074; train_edge_recon_loss: 359348.1076; train_gene_expr_recon_loss: 679514.8819; train_masked_gp_l1_reg_loss: 4494.0206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81089.1224; train_chrom_access_recon_loss: 1315551.9861; train_global_loss: 2462856.1111; train_optim_loss: 2462856.1111; val_kl_reg_loss: 20670.0742; val_edge_recon_loss: 403397.6875; val_gene_expr_recon_loss: 679980.4375; val_masked_gp_l1_reg_loss: 4486.7974; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79009.8281; val_chrom_access_recon_loss: 1309405.6250; val_global_loss: 2496950.5000; val_optim_loss: 2496950.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7972; val_auprc_score: 0.7876; val_best_acc_score: 0.7090; val_best_f1_score: 0.7514; train_kl_reg_loss: 22829.2834; train_edge_recon_loss: 359097.8229; train_gene_expr_recon_loss: 672184.6597; train_masked_gp_l1_reg_loss: 4490.1583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77399.3524; train_chrom_access_recon_loss: 1309996.3611; train_global_loss: 2445997.6667; train_optim_loss: 2445997.6667; val_kl_reg_loss: 22579.4844; val_edge_recon_loss: 402395.0312; val_gene_expr_recon_loss: 673513.0000; val_masked_gp_l1_reg_loss: 4485.2002; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75412.1562; val_chrom_access_recon_loss: 1305956.1250; val_global_loss: 2484341.0000; val_optim_loss: 2484341.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7913; val_auprc_score: 0.7840; val_best_acc_score: 0.7150; val_best_f1_score: 0.7339; train_kl_reg_loss: 22783.0011; train_edge_recon_loss: 358232.0174; train_gene_expr_recon_loss: 667199.0764; train_masked_gp_l1_reg_loss: 4494.5873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73872.5069; train_chrom_access_recon_loss: 1308331.0972; train_global_loss: 2434912.2500; train_optim_loss: 2434912.2500; val_kl_reg_loss: 21585.5332; val_edge_recon_loss: 399820.0938; val_gene_expr_recon_loss: 669992.0000; val_masked_gp_l1_reg_loss: 4493.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71974.6484; val_chrom_access_recon_loss: 1302879.6250; val_global_loss: 2470745.7500; val_optim_loss: 2470745.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7927; val_auprc_score: 0.7877; val_best_acc_score: 0.7041; val_best_f1_score: 0.7415; train_kl_reg_loss: 22432.4353; train_edge_recon_loss: 357345.0347; train_gene_expr_recon_loss: 667601.1319; train_masked_gp_l1_reg_loss: 4496.0745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70512.6215; train_chrom_access_recon_loss: 1305096.1944; train_global_loss: 2427483.5278; train_optim_loss: 2427483.5278; val_kl_reg_loss: 21702.1895; val_edge_recon_loss: 396804.6250; val_gene_expr_recon_loss: 666873.6250; val_masked_gp_l1_reg_loss: 4492.0923; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68713.1641; val_chrom_access_recon_loss: 1300529.8750; val_global_loss: 2459115.5000; val_optim_loss: 2459115.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8037; val_auprc_score: 0.7916; val_best_acc_score: 0.7185; val_best_f1_score: 0.7605; train_kl_reg_loss: 22040.0770; train_edge_recon_loss: 356070.4236; train_gene_expr_recon_loss: 661487.7083; train_masked_gp_l1_reg_loss: 4502.3665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67329.9149; train_chrom_access_recon_loss: 1300746.0694; train_global_loss: 2412176.5556; train_optim_loss: 2412176.5556; val_kl_reg_loss: 21809.0664; val_edge_recon_loss: 391810.5938; val_gene_expr_recon_loss: 664000.1250; val_masked_gp_l1_reg_loss: 4505.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65628.3828; val_chrom_access_recon_loss: 1298127.6250; val_global_loss: 2445881.2500; val_optim_loss: 2445881.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8106; val_auprc_score: 0.7974; val_best_acc_score: 0.7282; val_best_f1_score: 0.7605; train_kl_reg_loss: 21586.9842; train_edge_recon_loss: 353879.1528; train_gene_expr_recon_loss: 658878.8264; train_masked_gp_l1_reg_loss: 4517.5028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64325.8832; train_chrom_access_recon_loss: 1302834.4583; train_global_loss: 2406022.8056; train_optim_loss: 2406022.8056; val_kl_reg_loss: 20140.4844; val_edge_recon_loss: 384555.3438; val_gene_expr_recon_loss: 663110.3750; val_masked_gp_l1_reg_loss: 4520.8267; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62723.7305; val_chrom_access_recon_loss: 1296001.1250; val_global_loss: 2431052.0000; val_optim_loss: 2431052.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8205; val_auprc_score: 0.8138; val_best_acc_score: 0.7336; val_best_f1_score: 0.7612; train_kl_reg_loss: 21030.5970; train_edge_recon_loss: 350693.4132; train_gene_expr_recon_loss: 656868.6528; train_masked_gp_l1_reg_loss: 4529.1057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61500.2374; train_chrom_access_recon_loss: 1302002.5000; train_global_loss: 2396624.4722; train_optim_loss: 2396624.4722; val_kl_reg_loss: 20667.8281; val_edge_recon_loss: 374359.2812; val_gene_expr_recon_loss: 660855.5000; val_masked_gp_l1_reg_loss: 4535.7646; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59996.9844; val_chrom_access_recon_loss: 1294201.8750; val_global_loss: 2414617.2500; val_optim_loss: 2414617.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8349; val_auprc_score: 0.8217; val_best_acc_score: 0.7471; val_best_f1_score: 0.7704; train_kl_reg_loss: 21149.7730; train_edge_recon_loss: 345618.4062; train_gene_expr_recon_loss: 655564.3125; train_masked_gp_l1_reg_loss: 4550.7644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58845.9293; train_chrom_access_recon_loss: 1294376.8333; train_global_loss: 2380106.0278; train_optim_loss: 2380106.0278; val_kl_reg_loss: 20733.7637; val_edge_recon_loss: 357007.0625; val_gene_expr_recon_loss: 660876.5625; val_masked_gp_l1_reg_loss: 4562.3887; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57429.1484; val_chrom_access_recon_loss: 1292378.0000; val_global_loss: 2392987.0000; val_optim_loss: 2392987.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8466; val_auprc_score: 0.8338; val_best_acc_score: 0.7567; val_best_f1_score: 0.7829; train_kl_reg_loss: 22546.9280; train_edge_recon_loss: 337366.9028; train_gene_expr_recon_loss: 657781.3681; train_masked_gp_l1_reg_loss: 4579.7733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56344.7504; train_chrom_access_recon_loss: 1295100.1528; train_global_loss: 2373719.8611; train_optim_loss: 2373719.8611; val_kl_reg_loss: 23246.0508; val_edge_recon_loss: 339886.5625; val_gene_expr_recon_loss: 658650.1250; val_masked_gp_l1_reg_loss: 4597.0923; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55012.1016; val_chrom_access_recon_loss: 1290679.2500; val_global_loss: 2372071.0000; val_optim_loss: 2372071.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8582; val_auprc_score: 0.8492; val_best_acc_score: 0.7661; val_best_f1_score: 0.7915; train_kl_reg_loss: 26216.2622; train_edge_recon_loss: 327010.5347; train_gene_expr_recon_loss: 656716.0208; train_masked_gp_l1_reg_loss: 4617.8899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53997.2609; train_chrom_access_recon_loss: 1295390.1944; train_global_loss: 2363948.1667; train_optim_loss: 2363948.1667; val_kl_reg_loss: 27422.3809; val_edge_recon_loss: 325439.4688; val_gene_expr_recon_loss: 658172.3125; val_masked_gp_l1_reg_loss: 4637.6162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52745.2695; val_chrom_access_recon_loss: 1288862.2500; val_global_loss: 2357279.2500; val_optim_loss: 2357279.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8729; val_auprc_score: 0.8607; val_best_acc_score: 0.7816; val_best_f1_score: 0.8034; train_kl_reg_loss: 30768.4434; train_edge_recon_loss: 317468.8576; train_gene_expr_recon_loss: 653213.7361; train_masked_gp_l1_reg_loss: 4656.4812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51796.9822; train_chrom_access_recon_loss: 1293476.3472; train_global_loss: 2351380.8056; train_optim_loss: 2351380.8056; val_kl_reg_loss: 29924.3633; val_edge_recon_loss: 315600.0938; val_gene_expr_recon_loss: 656654.1250; val_masked_gp_l1_reg_loss: 4678.2090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50627.3828; val_chrom_access_recon_loss: 1286595.1250; val_global_loss: 2344079.5000; val_optim_loss: 2344079.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8890; val_auprc_score: 0.8743; val_best_acc_score: 0.7970; val_best_f1_score: 0.8143; train_kl_reg_loss: 30728.5304; train_edge_recon_loss: 313401.3854; train_gene_expr_recon_loss: 652716.4931; train_masked_gp_l1_reg_loss: 4701.3791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49736.8086; train_chrom_access_recon_loss: 1290036.8750; train_global_loss: 2341321.4722; train_optim_loss: 2341321.4722; val_kl_reg_loss: 29336.5039; val_edge_recon_loss: 311501.2500; val_gene_expr_recon_loss: 657188.0000; val_masked_gp_l1_reg_loss: 4718.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48639.7031; val_chrom_access_recon_loss: 1284798.6250; val_global_loss: 2336182.5000; val_optim_loss: 2336182.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8975; val_auprc_score: 0.8793; val_best_acc_score: 0.8131; val_best_f1_score: 0.8251; train_kl_reg_loss: 29412.6107; train_edge_recon_loss: 310553.1146; train_gene_expr_recon_loss: 650622.0556; train_masked_gp_l1_reg_loss: 4739.5463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47812.1727; train_chrom_access_recon_loss: 1288376.2639; train_global_loss: 2331515.7778; train_optim_loss: 2331515.7778; val_kl_reg_loss: 28420.4004; val_edge_recon_loss: 309009.9688; val_gene_expr_recon_loss: 654735.3750; val_masked_gp_l1_reg_loss: 4759.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46783.5703; val_chrom_access_recon_loss: 1282938.8750; val_global_loss: 2326647.7500; val_optim_loss: 2326647.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9066; val_auprc_score: 0.8922; val_best_acc_score: 0.8220; val_best_f1_score: 0.8315; train_kl_reg_loss: 28871.5590; train_edge_recon_loss: 307498.7778; train_gene_expr_recon_loss: 647017.7431; train_masked_gp_l1_reg_loss: 4782.2473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45995.4813; train_chrom_access_recon_loss: 1280935.8194; train_global_loss: 2315101.6111; train_optim_loss: 2315101.6111; val_kl_reg_loss: 28434.4648; val_edge_recon_loss: 307297.8125; val_gene_expr_recon_loss: 653800.4375; val_masked_gp_l1_reg_loss: 4799.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45024.0391; val_chrom_access_recon_loss: 1280827.0000; val_global_loss: 2320183.0000; val_optim_loss: 2320183.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9248; val_auprc_score: 0.9142; val_best_acc_score: 0.8448; val_best_f1_score: 0.8490; train_kl_reg_loss: 27656.1970; train_edge_recon_loss: 333027.5243; train_gene_expr_recon_loss: 916435.4444; train_masked_gp_l1_reg_loss: 4865.0809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44139.4002; train_chrom_access_recon_loss: 1354442.3056; train_global_loss: 2680565.9444; train_optim_loss: 2680565.9444; val_kl_reg_loss: 12456.3271; val_edge_recon_loss: 323708.7500; val_gene_expr_recon_loss: 922551.1250; val_masked_gp_l1_reg_loss: 4973.0508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42965.2031; val_chrom_access_recon_loss: 1355283.2500; val_global_loss: 2661937.7500; val_optim_loss: 2661937.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9203; val_auprc_score: 0.9061; val_best_acc_score: 0.8433; val_best_f1_score: 0.8489; train_kl_reg_loss: 26688.7517; train_edge_recon_loss: 315501.4167; train_gene_expr_recon_loss: 913118.3403; train_masked_gp_l1_reg_loss: 5073.5322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41993.8411; train_chrom_access_recon_loss: 1356313.4444; train_global_loss: 2658689.3889; train_optim_loss: 2658689.3889; val_kl_reg_loss: 14289.6631; val_edge_recon_loss: 311954.1250; val_gene_expr_recon_loss: 917414.1250; val_masked_gp_l1_reg_loss: 5192.8818; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40791.6250; val_chrom_access_recon_loss: 1352566.7500; val_global_loss: 2642209.0000; val_optim_loss: 2642209.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9181; val_auprc_score: 0.9006; val_best_acc_score: 0.8407; val_best_f1_score: 0.8452; train_kl_reg_loss: 25371.6131; train_edge_recon_loss: 308799.9688; train_gene_expr_recon_loss: 909330.8889; train_masked_gp_l1_reg_loss: 5274.4125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39860.5825; train_chrom_access_recon_loss: 1355516.8056; train_global_loss: 2644154.2778; train_optim_loss: 2644154.2778; val_kl_reg_loss: 16219.7881; val_edge_recon_loss: 308281.3750; val_gene_expr_recon_loss: 913022.6250; val_masked_gp_l1_reg_loss: 5368.9551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38720.3633; val_chrom_access_recon_loss: 1350359.8750; val_global_loss: 2631973.0000; val_optim_loss: 2631973.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9153; val_auprc_score: 0.8995; val_best_acc_score: 0.8378; val_best_f1_score: 0.8451; train_kl_reg_loss: 24053.9944; train_edge_recon_loss: 303834.8576; train_gene_expr_recon_loss: 904783.9653; train_masked_gp_l1_reg_loss: 5432.0461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37855.9466; train_chrom_access_recon_loss: 1356589.9167; train_global_loss: 2632550.7222; train_optim_loss: 2632550.7222; val_kl_reg_loss: 18012.3184; val_edge_recon_loss: 303277.0312; val_gene_expr_recon_loss: 908983.2500; val_masked_gp_l1_reg_loss: 5503.8018; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36804.3164; val_chrom_access_recon_loss: 1348616.8750; val_global_loss: 2621197.5000; val_optim_loss: 2621197.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9148; val_auprc_score: 0.8967; val_best_acc_score: 0.8371; val_best_f1_score: 0.8429; train_kl_reg_loss: 23591.5226; train_edge_recon_loss: 301571.3229; train_gene_expr_recon_loss: 902507.1181; train_masked_gp_l1_reg_loss: 5495.9773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36687.9501; train_chrom_access_recon_loss: 1354009.2917; train_global_loss: 2623863.1944; train_optim_loss: 2623863.1944; val_kl_reg_loss: 18261.5762; val_edge_recon_loss: 301046.6875; val_gene_expr_recon_loss: 908595.1250; val_masked_gp_l1_reg_loss: 5488.5845; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36545.9258; val_chrom_access_recon_loss: 1348377.0000; val_global_loss: 2618315.0000; val_optim_loss: 2618315.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9121; val_auprc_score: 0.8923; val_best_acc_score: 0.8347; val_best_f1_score: 0.8413; train_kl_reg_loss: 23478.6599; train_edge_recon_loss: 301955.2153; train_gene_expr_recon_loss: 896145.8333; train_masked_gp_l1_reg_loss: 5488.5442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36444.9349; train_chrom_access_recon_loss: 1343469.7222; train_global_loss: 2606982.9444; train_optim_loss: 2606982.9444; val_kl_reg_loss: 18321.2031; val_edge_recon_loss: 304804.2188; val_gene_expr_recon_loss: 908250.1250; val_masked_gp_l1_reg_loss: 5487.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36318.1406; val_chrom_access_recon_loss: 1348057.3750; val_global_loss: 2621238.5000; val_optim_loss: 2621238.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9156; val_auprc_score: 0.8997; val_best_acc_score: 0.8376; val_best_f1_score: 0.8433; train_kl_reg_loss: 23484.1602; train_edge_recon_loss: 302699.0833; train_gene_expr_recon_loss: 902637.4236; train_masked_gp_l1_reg_loss: 5488.1012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36222.1562; train_chrom_access_recon_loss: 1350501.2500; train_global_loss: 2621032.1944; train_optim_loss: 2621032.1944; val_kl_reg_loss: 18332.5391; val_edge_recon_loss: 302778.8438; val_gene_expr_recon_loss: 907758.7500; val_masked_gp_l1_reg_loss: 5488.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36103.7656; val_chrom_access_recon_loss: 1347846.2500; val_global_loss: 2618309.0000; val_optim_loss: 2618309.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9107; val_auprc_score: 0.8899; val_best_acc_score: 0.8309; val_best_f1_score: 0.8391; train_kl_reg_loss: 23402.2990; train_edge_recon_loss: 301865.0174; train_gene_expr_recon_loss: 900198.6250; train_masked_gp_l1_reg_loss: 5490.2871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36011.7609; train_chrom_access_recon_loss: 1349831.0278; train_global_loss: 2616798.9722; train_optim_loss: 2616798.9722; val_kl_reg_loss: 18412.8164; val_edge_recon_loss: 303410.3750; val_gene_expr_recon_loss: 907467.1250; val_masked_gp_l1_reg_loss: 5492.3804; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35899.9180; val_chrom_access_recon_loss: 1347854.7500; val_global_loss: 2618537.2500; val_optim_loss: 2618537.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9135
val AUPRC score: 0.8977
val best accuracy score: 0.8324
val best F1 score: 0.8406
val target rna MSE score: 3.9978
val source rna MSE score: 3.1981
val target atac MSE score: 0.1371
val source atac MSE score: 0.0199
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
