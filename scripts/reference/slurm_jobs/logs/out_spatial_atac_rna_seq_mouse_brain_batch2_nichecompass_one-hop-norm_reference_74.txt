[True]
Run timestamp: 09102023_232827_74.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_74']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7469; val_auprc_score: 0.7703; val_best_acc_score: 0.5345; val_best_f1_score: 0.6791; train_kl_reg_loss: 50932.6715; train_edge_recon_loss: 3510660.1050; train_gene_expr_recon_loss: 13611741.7786; train_masked_gp_l1_reg_loss: 118960.1756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2863066.3480; train_chrom_access_recon_loss: 2880920.2710; train_global_loss: 23036281.2672; train_optim_loss: 23036281.2672; val_kl_reg_loss: 80611.5729; val_edge_recon_loss: 4063104.5000; val_gene_expr_recon_loss: 12632357.0000; val_masked_gp_l1_reg_loss: 109687.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 486890.9375; val_chrom_access_recon_loss: 2739103.4500; val_global_loss: 20111754.4000; val_optim_loss: 20111754.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8069; val_auprc_score: 0.8214; val_best_acc_score: 0.7173; val_best_f1_score: 0.7308; train_kl_reg_loss: 78253.3079; train_edge_recon_loss: 3497602.3645; train_gene_expr_recon_loss: 12667591.9466; train_masked_gp_l1_reg_loss: 105029.6534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 254339.5344; train_chrom_access_recon_loss: 2762615.0668; train_global_loss: 19365431.7710; train_optim_loss: 19365431.7710; val_kl_reg_loss: 74197.6401; val_edge_recon_loss: 4032178.9167; val_gene_expr_recon_loss: 12414351.0667; val_masked_gp_l1_reg_loss: 104525.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149984.3438; val_chrom_access_recon_loss: 2690921.8833; val_global_loss: 19466159.7333; val_optim_loss: 19466159.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8813; val_auprc_score: 0.8762; val_best_acc_score: 0.7893; val_best_f1_score: 0.7977; train_kl_reg_loss: 69717.5834; train_edge_recon_loss: 3320586.1202; train_gene_expr_recon_loss: 12492321.1298; train_masked_gp_l1_reg_loss: 108784.7899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120561.4478; train_chrom_access_recon_loss: 2736249.4943; train_global_loss: 18848220.7176; train_optim_loss: 18848220.7176; val_kl_reg_loss: 88023.7432; val_edge_recon_loss: 2990349.8167; val_gene_expr_recon_loss: 12252901.4667; val_masked_gp_l1_reg_loss: 119704.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102415.6953; val_chrom_access_recon_loss: 2664650.4500; val_global_loss: 18218046.2667; val_optim_loss: 18218046.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8791; val_auprc_score: 0.8643; val_best_acc_score: 0.7917; val_best_f1_score: 0.8149; train_kl_reg_loss: 93069.4736; train_edge_recon_loss: 2934223.4676; train_gene_expr_recon_loss: 12353942.3588; train_masked_gp_l1_reg_loss: 121635.5698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92861.5843; train_chrom_access_recon_loss: 2703192.5706; train_global_loss: 18298925.0687; train_optim_loss: 18298925.0687; val_kl_reg_loss: 93188.8010; val_edge_recon_loss: 2921660.7167; val_gene_expr_recon_loss: 12111253.3333; val_masked_gp_l1_reg_loss: 121368.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88349.0938; val_chrom_access_recon_loss: 2644851.1000; val_global_loss: 17980671.8667; val_optim_loss: 17980671.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9043; val_auprc_score: 0.8900; val_best_acc_score: 0.8255; val_best_f1_score: 0.8386; train_kl_reg_loss: 92137.4445; train_edge_recon_loss: 2882598.0324; train_gene_expr_recon_loss: 12234937.8626; train_masked_gp_l1_reg_loss: 121600.7393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87060.5103; train_chrom_access_recon_loss: 2680825.4695; train_global_loss: 18099160.1221; train_optim_loss: 18099160.1221; val_kl_reg_loss: 94596.1896; val_edge_recon_loss: 2875604.6667; val_gene_expr_recon_loss: 11994994.6667; val_masked_gp_l1_reg_loss: 122835.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85220.3281; val_chrom_access_recon_loss: 2618191.2333; val_global_loss: 17791441.7333; val_optim_loss: 17791441.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9138; val_auprc_score: 0.8938; val_best_acc_score: 0.8459; val_best_f1_score: 0.8560; train_kl_reg_loss: 94837.2022; train_edge_recon_loss: 2835157.5973; train_gene_expr_recon_loss: 12122717.0305; train_masked_gp_l1_reg_loss: 122885.7570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82648.8358; train_chrom_access_recon_loss: 2659553.0859; train_global_loss: 17917799.5267; train_optim_loss: 17917799.5267; val_kl_reg_loss: 85717.7995; val_edge_recon_loss: 2865389.8000; val_gene_expr_recon_loss: 11891094.0667; val_masked_gp_l1_reg_loss: 123399.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80818.5703; val_chrom_access_recon_loss: 2597581.5500; val_global_loss: 17644002.5333; val_optim_loss: 17644002.5333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9244; val_auprc_score: 0.9109; val_best_acc_score: 0.8514; val_best_f1_score: 0.8625; train_kl_reg_loss: 91906.6612; train_edge_recon_loss: 2814360.8416; train_gene_expr_recon_loss: 12049548.4580; train_masked_gp_l1_reg_loss: 123885.2627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79924.8848; train_chrom_access_recon_loss: 2646210.9618; train_global_loss: 17805837.0534; train_optim_loss: 17805837.0534; val_kl_reg_loss: 88353.0594; val_edge_recon_loss: 2824379.7333; val_gene_expr_recon_loss: 11820553.0667; val_masked_gp_l1_reg_loss: 124196.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79870.7578; val_chrom_access_recon_loss: 2593017.9833; val_global_loss: 17530371.8667; val_optim_loss: 17530371.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9269; val_auprc_score: 0.9137; val_best_acc_score: 0.8557; val_best_f1_score: 0.8652; train_kl_reg_loss: 92713.7990; train_edge_recon_loss: 2793307.4809; train_gene_expr_recon_loss: 11972941.2290; train_masked_gp_l1_reg_loss: 125039.9852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80757.4449; train_chrom_access_recon_loss: 2628883.6088; train_global_loss: 17693643.5420; train_optim_loss: 17693643.5420; val_kl_reg_loss: 92191.7797; val_edge_recon_loss: 2799675.1833; val_gene_expr_recon_loss: 11759147.9333; val_masked_gp_l1_reg_loss: 125049.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81082.9922; val_chrom_access_recon_loss: 2579277.6833; val_global_loss: 17436425.2000; val_optim_loss: 17436425.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9355; val_auprc_score: 0.9244; val_best_acc_score: 0.8682; val_best_f1_score: 0.8762; train_kl_reg_loss: 90214.4335; train_edge_recon_loss: 2795043.8779; train_gene_expr_recon_loss: 11882324.9008; train_masked_gp_l1_reg_loss: 125645.8569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80686.8763; train_chrom_access_recon_loss: 2611984.5706; train_global_loss: 17585900.4885; train_optim_loss: 17585900.4885; val_kl_reg_loss: 90916.2016; val_edge_recon_loss: 2808443.7167; val_gene_expr_recon_loss: 11709873.2667; val_masked_gp_l1_reg_loss: 126246.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79872.6016; val_chrom_access_recon_loss: 2574116.3333; val_global_loss: 17389468.4000; val_optim_loss: 17389468.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9372; val_auprc_score: 0.9257; val_best_acc_score: 0.8716; val_best_f1_score: 0.8771; train_kl_reg_loss: 88944.5517; train_edge_recon_loss: 2784447.5649; train_gene_expr_recon_loss: 11825958.1603; train_masked_gp_l1_reg_loss: 127287.9634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78939.9716; train_chrom_access_recon_loss: 2599600.9046; train_global_loss: 17505179.0992; train_optim_loss: 17505179.0992; val_kl_reg_loss: 85418.9427; val_edge_recon_loss: 2803294.6500; val_gene_expr_recon_loss: 11658155.3333; val_masked_gp_l1_reg_loss: 128211.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78462.9375; val_chrom_access_recon_loss: 2556093.0333; val_global_loss: 17309636.9333; val_optim_loss: 17309636.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9386; val_auprc_score: 0.9242; val_best_acc_score: 0.8704; val_best_f1_score: 0.8766; train_kl_reg_loss: 87516.9102; train_edge_recon_loss: 2768585.6737; train_gene_expr_recon_loss: 11779161.0916; train_masked_gp_l1_reg_loss: 128409.2751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77530.8517; train_chrom_access_recon_loss: 2588845.1260; train_global_loss: 17430048.9237; train_optim_loss: 17430048.9237; val_kl_reg_loss: 88435.5234; val_edge_recon_loss: 2790070.9500; val_gene_expr_recon_loss: 11582754.6000; val_masked_gp_l1_reg_loss: 128668.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76859.1172; val_chrom_access_recon_loss: 2522898.4000; val_global_loss: 17189686.3333; val_optim_loss: 17189686.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9474; val_auprc_score: 0.9367; val_best_acc_score: 0.8847; val_best_f1_score: 0.8909; train_kl_reg_loss: 86556.1159; train_edge_recon_loss: 2763886.3378; train_gene_expr_recon_loss: 11728870.2595; train_masked_gp_l1_reg_loss: 129297.5782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76417.4439; train_chrom_access_recon_loss: 2577765.5573; train_global_loss: 17362793.3588; train_optim_loss: 17362793.3588; val_kl_reg_loss: 82960.7260; val_edge_recon_loss: 2768594.6333; val_gene_expr_recon_loss: 11506907.8667; val_masked_gp_l1_reg_loss: 129219.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75964.4922; val_chrom_access_recon_loss: 2526517.9000; val_global_loss: 17090164.1333; val_optim_loss: 17090164.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9445; val_auprc_score: 0.9286; val_best_acc_score: 0.8851; val_best_f1_score: 0.8902; train_kl_reg_loss: 86814.0496; train_edge_recon_loss: 2763256.4447; train_gene_expr_recon_loss: 11692197.7634; train_masked_gp_l1_reg_loss: 129377.2351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75693.4487; train_chrom_access_recon_loss: 2568185.9504; train_global_loss: 17315524.7176; train_optim_loss: 17315524.7176; val_kl_reg_loss: 88672.7990; val_edge_recon_loss: 2751616.6500; val_gene_expr_recon_loss: 11481248.6667; val_masked_gp_l1_reg_loss: 129472.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75534.0859; val_chrom_access_recon_loss: 2516666.4833; val_global_loss: 17043210.4000; val_optim_loss: 17043210.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9462; val_auprc_score: 0.9333; val_best_acc_score: 0.8844; val_best_f1_score: 0.8899; train_kl_reg_loss: 86104.2518; train_edge_recon_loss: 2751971.9275; train_gene_expr_recon_loss: 11622657.3969; train_masked_gp_l1_reg_loss: 129309.3954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75558.5661; train_chrom_access_recon_loss: 2550658.4523; train_global_loss: 17216259.8931; train_optim_loss: 17216259.8931; val_kl_reg_loss: 84466.0536; val_edge_recon_loss: 2768871.8000; val_gene_expr_recon_loss: 11415756.0000; val_masked_gp_l1_reg_loss: 129413.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75535.8594; val_chrom_access_recon_loss: 2512167.2333; val_global_loss: 16986210.1333; val_optim_loss: 16986210.1333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9486; val_auprc_score: 0.9373; val_best_acc_score: 0.8836; val_best_f1_score: 0.8894; train_kl_reg_loss: 86892.8693; train_edge_recon_loss: 2732878.1355; train_gene_expr_recon_loss: 11612067.3053; train_masked_gp_l1_reg_loss: 129610.5416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76045.2442; train_chrom_access_recon_loss: 2551234.9637; train_global_loss: 17188729.1374; train_optim_loss: 17188729.1374; val_kl_reg_loss: 86353.8573; val_edge_recon_loss: 2756987.0167; val_gene_expr_recon_loss: 11382796.7333; val_masked_gp_l1_reg_loss: 129782.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76260.8906; val_chrom_access_recon_loss: 2498422.7000; val_global_loss: 16930603.2000; val_optim_loss: 16930603.2000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9515; val_auprc_score: 0.9394; val_best_acc_score: 0.8876; val_best_f1_score: 0.8946; train_kl_reg_loss: 87571.5507; train_edge_recon_loss: 2735877.1603; train_gene_expr_recon_loss: 11568765.2901; train_masked_gp_l1_reg_loss: 129405.4195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76898.0872; train_chrom_access_recon_loss: 2540981.0305; train_global_loss: 17139498.5725; train_optim_loss: 17139498.5725; val_kl_reg_loss: 84978.5474; val_edge_recon_loss: 2734372.4333; val_gene_expr_recon_loss: 11362626.7333; val_masked_gp_l1_reg_loss: 129354.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77626.6641; val_chrom_access_recon_loss: 2484661.5167; val_global_loss: 16873620.5333; val_optim_loss: 16873620.5333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9555; val_auprc_score: 0.9448; val_best_acc_score: 0.8953; val_best_f1_score: 0.8998; train_kl_reg_loss: 84823.2282; train_edge_recon_loss: 2730321.0592; train_gene_expr_recon_loss: 11539575.8092; train_masked_gp_l1_reg_loss: 129030.8186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77714.3272; train_chrom_access_recon_loss: 2534160.8588; train_global_loss: 17095626.1145; train_optim_loss: 17095626.1145; val_kl_reg_loss: 84527.9865; val_edge_recon_loss: 2745875.5167; val_gene_expr_recon_loss: 11374005.4000; val_masked_gp_l1_reg_loss: 129243.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78507.0938; val_chrom_access_recon_loss: 2489270.0000; val_global_loss: 16901428.8000; val_optim_loss: 16901428.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9570; val_auprc_score: 0.9451; val_best_acc_score: 0.8969; val_best_f1_score: 0.9008; train_kl_reg_loss: 85300.7188; train_edge_recon_loss: 2722308.0019; train_gene_expr_recon_loss: 11513830.6183; train_masked_gp_l1_reg_loss: 129023.6755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78479.7498; train_chrom_access_recon_loss: 2528238.2118; train_global_loss: 17057180.9313; train_optim_loss: 17057180.9313; val_kl_reg_loss: 85611.3396; val_edge_recon_loss: 2722259.6167; val_gene_expr_recon_loss: 11297922.0000; val_masked_gp_l1_reg_loss: 129166.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78776.6875; val_chrom_access_recon_loss: 2460462.1333; val_global_loss: 16774198.0000; val_optim_loss: 16774198.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9607; val_auprc_score: 0.9484; val_best_acc_score: 0.9035; val_best_f1_score: 0.9061; train_kl_reg_loss: 84658.2029; train_edge_recon_loss: 2715916.3034; train_gene_expr_recon_loss: 11500570.1450; train_masked_gp_l1_reg_loss: 128954.4650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78269.0411; train_chrom_access_recon_loss: 2526211.2977; train_global_loss: 17034579.4809; train_optim_loss: 17034579.4809; val_kl_reg_loss: 82774.4917; val_edge_recon_loss: 2729188.4500; val_gene_expr_recon_loss: 11345818.0000; val_masked_gp_l1_reg_loss: 128742.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78401.0391; val_chrom_access_recon_loss: 2476862.7833; val_global_loss: 16841786.8000; val_optim_loss: 16841786.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9584; val_auprc_score: 0.9480; val_best_acc_score: 0.9007; val_best_f1_score: 0.9049; train_kl_reg_loss: 84482.2718; train_edge_recon_loss: 2714631.5630; train_gene_expr_recon_loss: 11464976.8015; train_masked_gp_l1_reg_loss: 128673.7801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78340.6489; train_chrom_access_recon_loss: 2515762.6031; train_global_loss: 16986867.6641; train_optim_loss: 16986867.6641; val_kl_reg_loss: 84339.9021; val_edge_recon_loss: 2746624.3500; val_gene_expr_recon_loss: 11296588.1333; val_masked_gp_l1_reg_loss: 128711.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78405.5469; val_chrom_access_recon_loss: 2469980.2167; val_global_loss: 16804649.6000; val_optim_loss: 16804649.6000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9590; val_auprc_score: 0.9452; val_best_acc_score: 0.9035; val_best_f1_score: 0.9079; train_kl_reg_loss: 84637.6543; train_edge_recon_loss: 2713531.8015; train_gene_expr_recon_loss: 11451825.6412; train_masked_gp_l1_reg_loss: 128147.3293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78019.8612; train_chrom_access_recon_loss: 2512327.2863; train_global_loss: 16968489.5496; train_optim_loss: 16968489.5496; val_kl_reg_loss: 82779.2802; val_edge_recon_loss: 2724038.2333; val_gene_expr_recon_loss: 11260036.1333; val_masked_gp_l1_reg_loss: 128068.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78278.0547; val_chrom_access_recon_loss: 2462985.6167; val_global_loss: 16736186.4000; val_optim_loss: 16736186.4000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9634; val_auprc_score: 0.9548; val_best_acc_score: 0.9033; val_best_f1_score: 0.9063; train_kl_reg_loss: 84409.0673; train_edge_recon_loss: 2707985.8015; train_gene_expr_recon_loss: 11436415.7099; train_masked_gp_l1_reg_loss: 127414.0053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77983.5485; train_chrom_access_recon_loss: 2507632.5534; train_global_loss: 16941840.6107; train_optim_loss: 16941840.6107; val_kl_reg_loss: 81614.7667; val_edge_recon_loss: 2740856.3500; val_gene_expr_recon_loss: 11211674.4000; val_masked_gp_l1_reg_loss: 126956.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78399.9922; val_chrom_access_recon_loss: 2458333.5000; val_global_loss: 16697834.9333; val_optim_loss: 16697834.9333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9639; val_auprc_score: 0.9552; val_best_acc_score: 0.9085; val_best_f1_score: 0.9120; train_kl_reg_loss: 83301.0173; train_edge_recon_loss: 2705754.5553; train_gene_expr_recon_loss: 11413856.4122; train_masked_gp_l1_reg_loss: 126693.1020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77831.4453; train_chrom_access_recon_loss: 2504799.9351; train_global_loss: 16912236.5573; train_optim_loss: 16912236.5573; val_kl_reg_loss: 82813.9984; val_edge_recon_loss: 2734597.9000; val_gene_expr_recon_loss: 11221166.8667; val_masked_gp_l1_reg_loss: 126778.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77952.8359; val_chrom_access_recon_loss: 2449792.8000; val_global_loss: 16693103.5333; val_optim_loss: 16693103.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9669; val_auprc_score: 0.9548; val_best_acc_score: 0.9177; val_best_f1_score: 0.9195; train_kl_reg_loss: 82527.8297; train_edge_recon_loss: 2707760.2595; train_gene_expr_recon_loss: 11390611.1756; train_masked_gp_l1_reg_loss: 126453.9715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77807.2442; train_chrom_access_recon_loss: 2495671.7385; train_global_loss: 16880832.2595; train_optim_loss: 16880832.2595; val_kl_reg_loss: 81136.6990; val_edge_recon_loss: 2722010.8000; val_gene_expr_recon_loss: 11253465.4000; val_masked_gp_l1_reg_loss: 125681.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77709.2422; val_chrom_access_recon_loss: 2450316.9000; val_global_loss: 16710320.8667; val_optim_loss: 16710320.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9687; val_auprc_score: 0.9597; val_best_acc_score: 0.9178; val_best_f1_score: 0.9191; train_kl_reg_loss: 82154.9965; train_edge_recon_loss: 2698236.4790; train_gene_expr_recon_loss: 11375624.8168; train_masked_gp_l1_reg_loss: 125683.6546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77699.6088; train_chrom_access_recon_loss: 2491551.2366; train_global_loss: 16850950.7710; train_optim_loss: 16850950.7710; val_kl_reg_loss: 82129.7510; val_edge_recon_loss: 2724780.3667; val_gene_expr_recon_loss: 11228008.8000; val_masked_gp_l1_reg_loss: 125820.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77822.1562; val_chrom_access_recon_loss: 2455191.5000; val_global_loss: 16693752.4667; val_optim_loss: 16693752.4667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9688; val_auprc_score: 0.9601; val_best_acc_score: 0.9163; val_best_f1_score: 0.9184; train_kl_reg_loss: 98687.8901; train_edge_recon_loss: 2758428.0344; train_gene_expr_recon_loss: 10639563.0611; train_masked_gp_l1_reg_loss: 124512.2654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74383.3093; train_chrom_access_recon_loss: 2367631.6832; train_global_loss: 16063206.2519; train_optim_loss: 16063206.2519; val_kl_reg_loss: 44371.9255; val_edge_recon_loss: 2720008.3000; val_gene_expr_recon_loss: 10455068.8667; val_masked_gp_l1_reg_loss: 124344.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76193.3438; val_chrom_access_recon_loss: 2316753.1333; val_global_loss: 15736739.0000; val_optim_loss: 15736739.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9648; val_auprc_score: 0.9515; val_best_acc_score: 0.9140; val_best_f1_score: 0.9167; train_kl_reg_loss: 81054.1632; train_edge_recon_loss: 2721710.8912; train_gene_expr_recon_loss: 10590747.0611; train_masked_gp_l1_reg_loss: 123076.6437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75792.5763; train_chrom_access_recon_loss: 2352674.9885; train_global_loss: 15945056.4351; train_optim_loss: 15945056.4351; val_kl_reg_loss: 49906.0182; val_edge_recon_loss: 2708212.4167; val_gene_expr_recon_loss: 10439036.6000; val_masked_gp_l1_reg_loss: 121482.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75694.4453; val_chrom_access_recon_loss: 2317935.5833; val_global_loss: 15712266.6000; val_optim_loss: 15712266.6000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9682; val_auprc_score: 0.9600; val_best_acc_score: 0.9155; val_best_f1_score: 0.9194; train_kl_reg_loss: 73922.3875; train_edge_recon_loss: 2709995.9714; train_gene_expr_recon_loss: 10569948.0305; train_masked_gp_l1_reg_loss: 119846.1893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76030.8770; train_chrom_access_recon_loss: 2350081.6260; train_global_loss: 15899825.0611; train_optim_loss: 15899825.0611; val_kl_reg_loss: 50997.3112; val_edge_recon_loss: 2715154.5500; val_gene_expr_recon_loss: 10377570.7333; val_masked_gp_l1_reg_loss: 118238.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75526.2734; val_chrom_access_recon_loss: 2299872.2833; val_global_loss: 15637359.9333; val_optim_loss: 15637359.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9670; val_auprc_score: 0.9560; val_best_acc_score: 0.9126; val_best_f1_score: 0.9159; train_kl_reg_loss: 69518.5321; train_edge_recon_loss: 2697306.1107; train_gene_expr_recon_loss: 10564009.2519; train_masked_gp_l1_reg_loss: 116869.7295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75954.3225; train_chrom_access_recon_loss: 2347336.0916; train_global_loss: 15870994.0534; train_optim_loss: 15870994.0534; val_kl_reg_loss: 56954.0398; val_edge_recon_loss: 2702043.9667; val_gene_expr_recon_loss: 10387519.6000; val_masked_gp_l1_reg_loss: 115585.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76110.1406; val_chrom_access_recon_loss: 2307990.5500; val_global_loss: 15646204.0000; val_optim_loss: 15646204.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9682; val_auprc_score: 0.9595; val_best_acc_score: 0.9184; val_best_f1_score: 0.9215; train_kl_reg_loss: 69895.5983; train_edge_recon_loss: 2692501.7767; train_gene_expr_recon_loss: 10553173.7939; train_masked_gp_l1_reg_loss: 114267.6830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75554.9516; train_chrom_access_recon_loss: 2345513.3931; train_global_loss: 15850907.3053; train_optim_loss: 15850907.3053; val_kl_reg_loss: 58224.8409; val_edge_recon_loss: 2707053.9667; val_gene_expr_recon_loss: 10428586.4000; val_masked_gp_l1_reg_loss: 113237.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75385.8359; val_chrom_access_recon_loss: 2318736.4667; val_global_loss: 15701224.7333; val_optim_loss: 15701224.7333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9689; val_auprc_score: 0.9615; val_best_acc_score: 0.9163; val_best_f1_score: 0.9186; train_kl_reg_loss: 68756.9764; train_edge_recon_loss: 2690958.9141; train_gene_expr_recon_loss: 10538932.0000; train_masked_gp_l1_reg_loss: 112109.3825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75423.6608; train_chrom_access_recon_loss: 2345828.0534; train_global_loss: 15832009.0305; train_optim_loss: 15832009.0305; val_kl_reg_loss: 60906.7826; val_edge_recon_loss: 2703631.7500; val_gene_expr_recon_loss: 10328716.6667; val_masked_gp_l1_reg_loss: 111411.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75695.3594; val_chrom_access_recon_loss: 2288680.6333; val_global_loss: 15569041.7333; val_optim_loss: 15569041.7333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9677; val_auprc_score: 0.9585; val_best_acc_score: 0.9170; val_best_f1_score: 0.9199; train_kl_reg_loss: 66640.3667; train_edge_recon_loss: 2687516.4561; train_gene_expr_recon_loss: 10518100.1603; train_masked_gp_l1_reg_loss: 110368.9393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75276.7148; train_chrom_access_recon_loss: 2336819.9561; train_global_loss: 15794722.6260; train_optim_loss: 15794722.6260; val_kl_reg_loss: 62230.9448; val_edge_recon_loss: 2701525.0500; val_gene_expr_recon_loss: 10391217.0000; val_masked_gp_l1_reg_loss: 109469.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75081.8672; val_chrom_access_recon_loss: 2299567.1667; val_global_loss: 15639092.1333; val_optim_loss: 15639092.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9746; val_auprc_score: 0.9664; val_best_acc_score: 0.9275; val_best_f1_score: 0.9299; train_kl_reg_loss: 68162.6295; train_edge_recon_loss: 2688388.1011; train_gene_expr_recon_loss: 10519233.6260; train_masked_gp_l1_reg_loss: 108655.4614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74961.9080; train_chrom_access_recon_loss: 2338772.8187; train_global_loss: 15798174.5954; train_optim_loss: 15798174.5954; val_kl_reg_loss: 60385.9995; val_edge_recon_loss: 2698360.6833; val_gene_expr_recon_loss: 10382817.3333; val_masked_gp_l1_reg_loss: 108131.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74810.5000; val_chrom_access_recon_loss: 2294221.5667; val_global_loss: 15618727.1333; val_optim_loss: 15618727.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9719; val_auprc_score: 0.9635; val_best_acc_score: 0.9198; val_best_f1_score: 0.9230; train_kl_reg_loss: 67793.2008; train_edge_recon_loss: 2689060.8053; train_gene_expr_recon_loss: 10499232.5802; train_masked_gp_l1_reg_loss: 107382.0027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74766.7011; train_chrom_access_recon_loss: 2332903.8034; train_global_loss: 15771139.0611; train_optim_loss: 15771139.0611; val_kl_reg_loss: 59694.7802; val_edge_recon_loss: 2703737.9167; val_gene_expr_recon_loss: 10290903.4000; val_masked_gp_l1_reg_loss: 106943.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74654.1172; val_chrom_access_recon_loss: 2279407.6000; val_global_loss: 15515340.6667; val_optim_loss: 15515340.6667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9693; val_auprc_score: 0.9581; val_best_acc_score: 0.9213; val_best_f1_score: 0.9239; train_kl_reg_loss: 67700.6950; train_edge_recon_loss: 2687476.7615; train_gene_expr_recon_loss: 10468418.3893; train_masked_gp_l1_reg_loss: 106343.7536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74774.7834; train_chrom_access_recon_loss: 2323521.9447; train_global_loss: 15728236.2824; train_optim_loss: 15728236.2824; val_kl_reg_loss: 63752.9836; val_edge_recon_loss: 2715548.3000; val_gene_expr_recon_loss: 10313967.5333; val_masked_gp_l1_reg_loss: 105803.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74295.6641; val_chrom_access_recon_loss: 2277049.1333; val_global_loss: 15550416.9333; val_optim_loss: 15550416.9333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9709; val_auprc_score: 0.9623; val_best_acc_score: 0.9206; val_best_f1_score: 0.9245; train_kl_reg_loss: 67199.6569; train_edge_recon_loss: 2692461.9695; train_gene_expr_recon_loss: 10464006.8015; train_masked_gp_l1_reg_loss: 105230.2983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74350.1313; train_chrom_access_recon_loss: 2326523.8989; train_global_loss: 15729772.7099; train_optim_loss: 15729772.7099; val_kl_reg_loss: 59896.5971; val_edge_recon_loss: 2716207.8333; val_gene_expr_recon_loss: 10316593.0667; val_masked_gp_l1_reg_loss: 105230.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74864.8672; val_chrom_access_recon_loss: 2274572.3167; val_global_loss: 15547365.8000; val_optim_loss: 15547365.8000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9679; val_auprc_score: 0.9570; val_best_acc_score: 0.9196; val_best_f1_score: 0.9218; train_kl_reg_loss: 67400.5068; train_edge_recon_loss: 2679777.7538; train_gene_expr_recon_loss: 10451715.6718; train_masked_gp_l1_reg_loss: 104729.9076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74538.5423; train_chrom_access_recon_loss: 2323448.0840; train_global_loss: 15701610.4885; train_optim_loss: 15701610.4885; val_kl_reg_loss: 64419.8109; val_edge_recon_loss: 2708452.0667; val_gene_expr_recon_loss: 10308955.0000; val_masked_gp_l1_reg_loss: 104443.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74159.5000; val_chrom_access_recon_loss: 2283180.9000; val_global_loss: 15543611.2667; val_optim_loss: 15543611.2667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9684; val_auprc_score: 0.9556; val_best_acc_score: 0.9227; val_best_f1_score: 0.9250; train_kl_reg_loss: 67312.2875; train_edge_recon_loss: 2683568.7500; train_gene_expr_recon_loss: 10445097.1527; train_masked_gp_l1_reg_loss: 103854.2637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74162.9962; train_chrom_access_recon_loss: 2320382.5821; train_global_loss: 15694378.0382; train_optim_loss: 15694378.0382; val_kl_reg_loss: 63730.2906; val_edge_recon_loss: 2686514.2833; val_gene_expr_recon_loss: 10335068.7333; val_masked_gp_l1_reg_loss: 103485.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74317.3828; val_chrom_access_recon_loss: 2288396.2333; val_global_loss: 15551512.5333; val_optim_loss: 15551512.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9723; val_auprc_score: 0.9634; val_best_acc_score: 0.9254; val_best_f1_score: 0.9273; train_kl_reg_loss: 68148.2560; train_edge_recon_loss: 2683388.8225; train_gene_expr_recon_loss: 10437867.5878; train_masked_gp_l1_reg_loss: 99816.8332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60190.8695; train_chrom_access_recon_loss: 2316192.4828; train_global_loss: 15665604.7939; train_optim_loss: 15665604.7939; val_kl_reg_loss: 64927.1456; val_edge_recon_loss: 2690764.2333; val_gene_expr_recon_loss: 10283277.2667; val_masked_gp_l1_reg_loss: 99015.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58221.6953; val_chrom_access_recon_loss: 2268624.8500; val_global_loss: 15464831.5333; val_optim_loss: 15464831.5333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9704; val_auprc_score: 0.9613; val_best_acc_score: 0.9220; val_best_f1_score: 0.9242; train_kl_reg_loss: 69350.7474; train_edge_recon_loss: 2675755.6431; train_gene_expr_recon_loss: 10411670.7634; train_masked_gp_l1_reg_loss: 98894.1931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57824.5988; train_chrom_access_recon_loss: 2307776.9828; train_global_loss: 15621272.9008; train_optim_loss: 15621272.9008; val_kl_reg_loss: 64212.7839; val_edge_recon_loss: 2713081.6833; val_gene_expr_recon_loss: 10281127.4000; val_masked_gp_l1_reg_loss: 98732.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57500.9844; val_chrom_access_recon_loss: 2278169.7500; val_global_loss: 15492824.5333; val_optim_loss: 15492824.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9709; val_auprc_score: 0.9636; val_best_acc_score: 0.9208; val_best_f1_score: 0.9236; train_kl_reg_loss: 70248.6002; train_edge_recon_loss: 2683463.7996; train_gene_expr_recon_loss: 10402460.5649; train_masked_gp_l1_reg_loss: 98650.0328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57237.8913; train_chrom_access_recon_loss: 2305580.5840; train_global_loss: 15617641.4962; train_optim_loss: 15617641.4962; val_kl_reg_loss: 65263.4995; val_edge_recon_loss: 2689692.9000; val_gene_expr_recon_loss: 10293388.4667; val_masked_gp_l1_reg_loss: 98587.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57019.7969; val_chrom_access_recon_loss: 2267805.4167; val_global_loss: 15471757.2000; val_optim_loss: 15471757.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9734; val_auprc_score: 0.9638; val_best_acc_score: 0.9254; val_best_f1_score: 0.9284; train_kl_reg_loss: 71035.1345; train_edge_recon_loss: 2677335.6088; train_gene_expr_recon_loss: 10410811.6336; train_masked_gp_l1_reg_loss: 98532.5609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56809.5199; train_chrom_access_recon_loss: 2306518.9466; train_global_loss: 15621043.4351; train_optim_loss: 15621043.4351; val_kl_reg_loss: 65889.7398; val_edge_recon_loss: 2690823.7167; val_gene_expr_recon_loss: 10261007.4000; val_masked_gp_l1_reg_loss: 98475.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56578.3242; val_chrom_access_recon_loss: 2261466.1333; val_global_loss: 15434240.0000; val_optim_loss: 15434240.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9758; val_auprc_score: 0.9696; val_best_acc_score: 0.9282; val_best_f1_score: 0.9303; train_kl_reg_loss: 71013.1395; train_edge_recon_loss: 2681239.4198; train_gene_expr_recon_loss: 10401316.7863; train_masked_gp_l1_reg_loss: 98390.6299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56384.4253; train_chrom_access_recon_loss: 2305442.9046; train_global_loss: 15613787.2443; train_optim_loss: 15613787.2443; val_kl_reg_loss: 66171.2643; val_edge_recon_loss: 2689734.3333; val_gene_expr_recon_loss: 10257238.2000; val_masked_gp_l1_reg_loss: 98334.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56238.5820; val_chrom_access_recon_loss: 2264076.1500; val_global_loss: 15431793.0000; val_optim_loss: 15431793.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9739; val_auprc_score: 0.9664; val_best_acc_score: 0.9270; val_best_f1_score: 0.9282; train_kl_reg_loss: 71457.8517; train_edge_recon_loss: 2681326.9504; train_gene_expr_recon_loss: 10401806.7481; train_masked_gp_l1_reg_loss: 98310.0078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56082.2952; train_chrom_access_recon_loss: 2305699.4637; train_global_loss: 15614683.2977; train_optim_loss: 15614683.2977; val_kl_reg_loss: 66048.8753; val_edge_recon_loss: 2695303.7500; val_gene_expr_recon_loss: 10246260.4000; val_masked_gp_l1_reg_loss: 98239.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55933.8711; val_chrom_access_recon_loss: 2270827.3500; val_global_loss: 15432614.3333; val_optim_loss: 15432614.3333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9700; val_auprc_score: 0.9576; val_best_acc_score: 0.9214; val_best_f1_score: 0.9245; train_kl_reg_loss: 71247.2576; train_edge_recon_loss: 2681089.8473; train_gene_expr_recon_loss: 10413362.5725; train_masked_gp_l1_reg_loss: 98176.4788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55824.7425; train_chrom_access_recon_loss: 2309085.3206; train_global_loss: 15628786.1908; train_optim_loss: 15628786.1908; val_kl_reg_loss: 65862.6310; val_edge_recon_loss: 2703863.5167; val_gene_expr_recon_loss: 10286514.6667; val_masked_gp_l1_reg_loss: 98148.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55676.4062; val_chrom_access_recon_loss: 2265039.1000; val_global_loss: 15475103.8667; val_optim_loss: 15475103.8667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9731; val_auprc_score: 0.9645; val_best_acc_score: 0.9244; val_best_f1_score: 0.9252; train_kl_reg_loss: 70828.7153; train_edge_recon_loss: 2682878.5592; train_gene_expr_recon_loss: 10415960.7863; train_masked_gp_l1_reg_loss: 98095.2715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55568.8020; train_chrom_access_recon_loss: 2307340.5401; train_global_loss: 15630672.5878; train_optim_loss: 15630672.5878; val_kl_reg_loss: 66884.1625; val_edge_recon_loss: 2695964.3500; val_gene_expr_recon_loss: 10231518.9333; val_masked_gp_l1_reg_loss: 98049.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55330.8555; val_chrom_access_recon_loss: 2266718.7667; val_global_loss: 15414467.2667; val_optim_loss: 15414467.2667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9751; val_auprc_score: 0.9695; val_best_acc_score: 0.9283; val_best_f1_score: 0.9309; train_kl_reg_loss: 71041.6053; train_edge_recon_loss: 2677103.6011; train_gene_expr_recon_loss: 10394700.4122; train_masked_gp_l1_reg_loss: 98029.1618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55260.7744; train_chrom_access_recon_loss: 2303913.4485; train_global_loss: 15600048.9466; train_optim_loss: 15600048.9466; val_kl_reg_loss: 66279.0953; val_edge_recon_loss: 2678206.2000; val_gene_expr_recon_loss: 10209697.3333; val_masked_gp_l1_reg_loss: 97951.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55068.9727; val_chrom_access_recon_loss: 2250615.6000; val_global_loss: 15357818.9333; val_optim_loss: 15357818.9333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9722; val_auprc_score: 0.9652; val_best_acc_score: 0.9241; val_best_f1_score: 0.9269; train_kl_reg_loss: 71016.5172; train_edge_recon_loss: 2681498.8989; train_gene_expr_recon_loss: 10400496.7786; train_masked_gp_l1_reg_loss: 97912.3607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55058.9167; train_chrom_access_recon_loss: 2304926.1889; train_global_loss: 15610909.6794; train_optim_loss: 15610909.6794; val_kl_reg_loss: 66719.2992; val_edge_recon_loss: 2698273.1333; val_gene_expr_recon_loss: 10236006.6000; val_masked_gp_l1_reg_loss: 97880.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54986.0586; val_chrom_access_recon_loss: 2256961.0583; val_global_loss: 15410827.2667; val_optim_loss: 15410827.2667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9746; val_auprc_score: 0.9663; val_best_acc_score: 0.9262; val_best_f1_score: 0.9284; train_kl_reg_loss: 70441.4172; train_edge_recon_loss: 2685613.0592; train_gene_expr_recon_loss: 10401268.8550; train_masked_gp_l1_reg_loss: 97848.7053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54856.9340; train_chrom_access_recon_loss: 2305566.5391; train_global_loss: 15615595.4809; train_optim_loss: 15615595.4809; val_kl_reg_loss: 64974.7661; val_edge_recon_loss: 2701313.1167; val_gene_expr_recon_loss: 10260735.8667; val_masked_gp_l1_reg_loss: 97782.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54764.7070; val_chrom_access_recon_loss: 2270880.7833; val_global_loss: 15450451.5333; val_optim_loss: 15450451.5333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9732; val_auprc_score: 0.9653; val_best_acc_score: 0.9294; val_best_f1_score: 0.9307; train_kl_reg_loss: 70434.8640; train_edge_recon_loss: 2675831.4179; train_gene_expr_recon_loss: 10397298.2214; train_masked_gp_l1_reg_loss: 97718.7296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54589.7803; train_chrom_access_recon_loss: 2305918.2576; train_global_loss: 15601791.3511; train_optim_loss: 15601791.3511; val_kl_reg_loss: 65875.1599; val_edge_recon_loss: 2690233.1167; val_gene_expr_recon_loss: 10294900.0667; val_masked_gp_l1_reg_loss: 97707.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54555.6289; val_chrom_access_recon_loss: 2278371.2500; val_global_loss: 15481642.6000; val_optim_loss: 15481642.6000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9706; val_auprc_score: 0.9626; val_best_acc_score: 0.9184; val_best_f1_score: 0.9219; train_kl_reg_loss: 71357.4092; train_edge_recon_loss: 2675514.8340; train_gene_expr_recon_loss: 10390672.5267; train_masked_gp_l1_reg_loss: 97628.8376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54377.8003; train_chrom_access_recon_loss: 2301334.1298; train_global_loss: 15590885.5344; train_optim_loss: 15590885.5344; val_kl_reg_loss: 66205.2664; val_edge_recon_loss: 2714006.2333; val_gene_expr_recon_loss: 10216984.5333; val_masked_gp_l1_reg_loss: 97596.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54326.3359; val_chrom_access_recon_loss: 2248533.2500; val_global_loss: 15397651.2000; val_optim_loss: 15397651.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9728; val_auprc_score: 0.9621; val_best_acc_score: 0.9275; val_best_f1_score: 0.9300; train_kl_reg_loss: 70715.1438; train_edge_recon_loss: 2676067.4447; train_gene_expr_recon_loss: 10398604.0305; train_masked_gp_l1_reg_loss: 97207.5667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52798.0099; train_chrom_access_recon_loss: 2304422.5115; train_global_loss: 15599814.6412; train_optim_loss: 15599814.6412; val_kl_reg_loss: 66853.5995; val_edge_recon_loss: 2692461.6500; val_gene_expr_recon_loss: 10272225.7333; val_masked_gp_l1_reg_loss: 97102.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52605.2461; val_chrom_access_recon_loss: 2265010.9333; val_global_loss: 15446259.0000; val_optim_loss: 15446259.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9709; val_auprc_score: 0.9618; val_best_acc_score: 0.9220; val_best_f1_score: 0.9246; train_kl_reg_loss: 70959.9881; train_edge_recon_loss: 2683236.9370; train_gene_expr_recon_loss: 10397450.9008; train_masked_gp_l1_reg_loss: 97072.6616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52572.4113; train_chrom_access_recon_loss: 2302975.8340; train_global_loss: 15604268.7710; train_optim_loss: 15604268.7710; val_kl_reg_loss: 65328.0018; val_edge_recon_loss: 2711568.2833; val_gene_expr_recon_loss: 10264572.6667; val_masked_gp_l1_reg_loss: 97044.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52531.0742; val_chrom_access_recon_loss: 2260181.3333; val_global_loss: 15451226.3333; val_optim_loss: 15451226.3333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9754; val_auprc_score: 0.9674; val_best_acc_score: 0.9302; val_best_f1_score: 0.9315; train_kl_reg_loss: 70809.5340; train_edge_recon_loss: 2683674.1355; train_gene_expr_recon_loss: 10392196.9084; train_masked_gp_l1_reg_loss: 97032.3284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52502.5139; train_chrom_access_recon_loss: 2305274.6594; train_global_loss: 15601490.0763; train_optim_loss: 15601490.0763; val_kl_reg_loss: 65434.4029; val_edge_recon_loss: 2697194.4167; val_gene_expr_recon_loss: 10231917.8000; val_masked_gp_l1_reg_loss: 97018.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52473.8086; val_chrom_access_recon_loss: 2261519.3250; val_global_loss: 15405558.3333; val_optim_loss: 15405558.3333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9701; val_auprc_score: 0.9572; val_best_acc_score: 0.9221; val_best_f1_score: 0.9255; train_kl_reg_loss: 70790.4723; train_edge_recon_loss: 2681825.3531; train_gene_expr_recon_loss: 10389841.1679; train_masked_gp_l1_reg_loss: 97008.1291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52456.3324; train_chrom_access_recon_loss: 2305598.2567; train_global_loss: 15597519.6336; train_optim_loss: 15597519.6336; val_kl_reg_loss: 65579.4273; val_edge_recon_loss: 2690767.7333; val_gene_expr_recon_loss: 10214695.8667; val_masked_gp_l1_reg_loss: 96997.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52431.9609; val_chrom_access_recon_loss: 2260793.7750; val_global_loss: 15381265.6000; val_optim_loss: 15381265.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 1 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9691
val AUPRC score: 0.9594
val best accuracy score: 0.9194
val best F1 score: 0.9226
val target rna MSE score: 1.3846
val source rna MSE score: 0.4987
val target atac MSE score: 0.4777
val source atac MSE score: 0.1464
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
