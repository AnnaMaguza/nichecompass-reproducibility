[True]
Run timestamp: 07092023_182311_74.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_74']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 799 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3515, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6380; val_auprc_score: 0.6295; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 59150.4898; train_edge_recon_loss: 3553726.2008; train_gene_expr_recon_loss: 20904732.4848; train_masked_gp_l1_reg_loss: 147152.5002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5885701.3750; train_chrom_access_recon_loss: 2670820.4242; train_global_loss: 33221283.2727; train_optim_loss: 33221283.2727; val_kl_reg_loss: 134168.3477; val_edge_recon_loss: 4065328.8125; val_gene_expr_recon_loss: 19195024.7500; val_masked_gp_l1_reg_loss: 141668.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2440473.0000; val_chrom_access_recon_loss: 2537350.8125; val_global_loss: 28514014.0000; val_optim_loss: 28514014.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6451; val_auprc_score: 0.6237; val_best_acc_score: 0.5266; val_best_f1_score: 0.6766; train_kl_reg_loss: 94021.0671; train_edge_recon_loss: 3545116.1705; train_gene_expr_recon_loss: 19174831.6364; train_masked_gp_l1_reg_loss: 138622.0862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1045798.5066; train_chrom_access_recon_loss: 2535212.5833; train_global_loss: 26533601.8788; train_optim_loss: 26533601.8788; val_kl_reg_loss: 96121.8398; val_edge_recon_loss: 4063762.0312; val_gene_expr_recon_loss: 18747554.7500; val_masked_gp_l1_reg_loss: 134664.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 412789.1875; val_chrom_access_recon_loss: 2458201.9375; val_global_loss: 25913094.5000; val_optim_loss: 25913094.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6671; val_auprc_score: 0.6509; val_best_acc_score: 0.5793; val_best_f1_score: 0.6915; train_kl_reg_loss: 105286.7594; train_edge_recon_loss: 3530088.7689; train_gene_expr_recon_loss: 18738719.4848; train_masked_gp_l1_reg_loss: 130379.8377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 281625.5473; train_chrom_access_recon_loss: 2503653.4129; train_global_loss: 25289754.0000; train_optim_loss: 25289754.0000; val_kl_reg_loss: 100772.3945; val_edge_recon_loss: 4060024.9062; val_gene_expr_recon_loss: 18287802.2500; val_masked_gp_l1_reg_loss: 127635.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 203718.8281; val_chrom_access_recon_loss: 2423073.2188; val_global_loss: 25203027.5000; val_optim_loss: 25203027.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7485; val_auprc_score: 0.7276; val_best_acc_score: 0.6854; val_best_f1_score: 0.7116; train_kl_reg_loss: 101258.4691; train_edge_recon_loss: 3520377.7538; train_gene_expr_recon_loss: 18533057.1515; train_masked_gp_l1_reg_loss: 127021.0794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172057.1020; train_chrom_access_recon_loss: 2484796.3523; train_global_loss: 24938567.9394; train_optim_loss: 24938567.9394; val_kl_reg_loss: 105184.8730; val_edge_recon_loss: 4019931.5938; val_gene_expr_recon_loss: 18241736.5000; val_masked_gp_l1_reg_loss: 127832.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147846.1250; val_chrom_access_recon_loss: 2404553.0312; val_global_loss: 25047084.0000; val_optim_loss: 25047084.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7937; val_auprc_score: 0.7639; val_best_acc_score: 0.7093; val_best_f1_score: 0.7446; train_kl_reg_loss: 91804.1475; train_edge_recon_loss: 3495213.9091; train_gene_expr_recon_loss: 18390581.8485; train_masked_gp_l1_reg_loss: 129427.0563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135002.3539; train_chrom_access_recon_loss: 2466199.0379; train_global_loss: 24708228.5152; train_optim_loss: 24708228.5152; val_kl_reg_loss: 91463.4365; val_edge_recon_loss: 3838795.7500; val_gene_expr_recon_loss: 18093333.2500; val_masked_gp_l1_reg_loss: 131385.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124818.7344; val_chrom_access_recon_loss: 2399169.8125; val_global_loss: 24678966.5000; val_optim_loss: 24678966.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8453; val_auprc_score: 0.8133; val_best_acc_score: 0.7663; val_best_f1_score: 0.7973; train_kl_reg_loss: 79387.8054; train_edge_recon_loss: 3333983.2765; train_gene_expr_recon_loss: 18296270.6061; train_masked_gp_l1_reg_loss: 134632.2595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118216.8888; train_chrom_access_recon_loss: 2461206.5227; train_global_loss: 24423697.5758; train_optim_loss: 24423697.5758; val_kl_reg_loss: 82218.5020; val_edge_recon_loss: 3118982.8750; val_gene_expr_recon_loss: 18099737.0000; val_masked_gp_l1_reg_loss: 139416.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114163.7734; val_chrom_access_recon_loss: 2417706.7500; val_global_loss: 23972224.7500; val_optim_loss: 23972224.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8502; val_auprc_score: 0.8165; val_best_acc_score: 0.7692; val_best_f1_score: 0.7947; train_kl_reg_loss: 85069.0157; train_edge_recon_loss: 3117391.2197; train_gene_expr_recon_loss: 18297124.6061; train_masked_gp_l1_reg_loss: 144104.3795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113232.0503; train_chrom_access_recon_loss: 2458212.9735; train_global_loss: 24215134.3636; train_optim_loss: 24215134.3636; val_kl_reg_loss: 84594.6709; val_edge_recon_loss: 3071468.0625; val_gene_expr_recon_loss: 18033782.2500; val_masked_gp_l1_reg_loss: 145678.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110658.1641; val_chrom_access_recon_loss: 2389115.2500; val_global_loss: 23835296.5000; val_optim_loss: 23835296.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8534; val_auprc_score: 0.8118; val_best_acc_score: 0.7708; val_best_f1_score: 0.7969; train_kl_reg_loss: 111126.6140; train_edge_recon_loss: 2995193.4621; train_gene_expr_recon_loss: 18131534.4242; train_masked_gp_l1_reg_loss: 146587.5710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109606.0384; train_chrom_access_recon_loss: 2434941.7235; train_global_loss: 23928989.8485; train_optim_loss: 23928989.8485; val_kl_reg_loss: 116613.8936; val_edge_recon_loss: 2943146.0000; val_gene_expr_recon_loss: 17697185.3750; val_masked_gp_l1_reg_loss: 147338.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109413.8359; val_chrom_access_recon_loss: 2371657.7500; val_global_loss: 23385354.2500; val_optim_loss: 23385354.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8651; val_auprc_score: 0.8313; val_best_acc_score: 0.7818; val_best_f1_score: 0.7995; train_kl_reg_loss: 115920.9966; train_edge_recon_loss: 2943161.7689; train_gene_expr_recon_loss: 18014393.3636; train_masked_gp_l1_reg_loss: 147926.2964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107417.7218; train_chrom_access_recon_loss: 2422528.6591; train_global_loss: 23751348.7879; train_optim_loss: 23751348.7879; val_kl_reg_loss: 113899.6641; val_edge_recon_loss: 2960558.5312; val_gene_expr_recon_loss: 17694439.7500; val_masked_gp_l1_reg_loss: 148686.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105339.6953; val_chrom_access_recon_loss: 2363415.6562; val_global_loss: 23386339.5000; val_optim_loss: 23386339.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8803; val_auprc_score: 0.8485; val_best_acc_score: 0.8044; val_best_f1_score: 0.8186; train_kl_reg_loss: 114107.8794; train_edge_recon_loss: 2930518.9053; train_gene_expr_recon_loss: 17907168.1818; train_masked_gp_l1_reg_loss: 149641.8487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104414.3849; train_chrom_access_recon_loss: 2408599.3598; train_global_loss: 23614450.6970; train_optim_loss: 23614450.6970; val_kl_reg_loss: 113138.0762; val_edge_recon_loss: 2939449.5625; val_gene_expr_recon_loss: 17673679.2500; val_masked_gp_l1_reg_loss: 150731.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103567.9609; val_chrom_access_recon_loss: 2365163.8438; val_global_loss: 23345731.0000; val_optim_loss: 23345731.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8866; val_auprc_score: 0.8496; val_best_acc_score: 0.8127; val_best_f1_score: 0.8284; train_kl_reg_loss: 111736.3741; train_edge_recon_loss: 2917992.1932; train_gene_expr_recon_loss: 17858111.0909; train_masked_gp_l1_reg_loss: 151603.8655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103341.5112; train_chrom_access_recon_loss: 2403290.4508; train_global_loss: 23546075.5152; train_optim_loss: 23546075.5152; val_kl_reg_loss: 112329.1865; val_edge_recon_loss: 2940432.3125; val_gene_expr_recon_loss: 17570088.5000; val_masked_gp_l1_reg_loss: 152380.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103055.5000; val_chrom_access_recon_loss: 2348470.7500; val_global_loss: 23226756.7500; val_optim_loss: 23226756.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8975; val_auprc_score: 0.8699; val_best_acc_score: 0.8229; val_best_f1_score: 0.8371; train_kl_reg_loss: 110249.7196; train_edge_recon_loss: 2892713.3182; train_gene_expr_recon_loss: 17777115.3939; train_masked_gp_l1_reg_loss: 153254.8400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102649.7391; train_chrom_access_recon_loss: 2392033.6856; train_global_loss: 23428016.5152; train_optim_loss: 23428016.5152; val_kl_reg_loss: 108150.5859; val_edge_recon_loss: 2917736.2812; val_gene_expr_recon_loss: 17522793.2500; val_masked_gp_l1_reg_loss: 154457.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101622.8750; val_chrom_access_recon_loss: 2317057.0625; val_global_loss: 23121817.0000; val_optim_loss: 23121817.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9103; val_auprc_score: 0.8864; val_best_acc_score: 0.8350; val_best_f1_score: 0.8504; train_kl_reg_loss: 109772.8388; train_edge_recon_loss: 2859546.0795; train_gene_expr_recon_loss: 17714403.5909; train_masked_gp_l1_reg_loss: 155419.7957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101161.7599; train_chrom_access_recon_loss: 2386945.8333; train_global_loss: 23327249.8788; train_optim_loss: 23327249.8788; val_kl_reg_loss: 110026.0654; val_edge_recon_loss: 2844338.8125; val_gene_expr_recon_loss: 17446152.5000; val_masked_gp_l1_reg_loss: 156648.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100983.6250; val_chrom_access_recon_loss: 2327571.2500; val_global_loss: 22985720.2500; val_optim_loss: 22985720.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9111; val_auprc_score: 0.8820; val_best_acc_score: 0.8407; val_best_f1_score: 0.8531; train_kl_reg_loss: 111655.6781; train_edge_recon_loss: 2838679.5606; train_gene_expr_recon_loss: 17642279.0909; train_masked_gp_l1_reg_loss: 157566.1432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100045.0183; train_chrom_access_recon_loss: 2375293.5833; train_global_loss: 23225519.1212; train_optim_loss: 23225519.1212; val_kl_reg_loss: 116269.1543; val_edge_recon_loss: 2854679.7500; val_gene_expr_recon_loss: 17275697.2500; val_masked_gp_l1_reg_loss: 158444.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99444.7188; val_chrom_access_recon_loss: 2303618.0625; val_global_loss: 22808151.5000; val_optim_loss: 22808151.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9111; val_auprc_score: 0.8800; val_best_acc_score: 0.8477; val_best_f1_score: 0.8597; train_kl_reg_loss: 116800.5639; train_edge_recon_loss: 2828816.9356; train_gene_expr_recon_loss: 17572505.6667; train_masked_gp_l1_reg_loss: 159084.2670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98741.2166; train_chrom_access_recon_loss: 2368580.3182; train_global_loss: 23144528.9697; train_optim_loss: 23144528.9697; val_kl_reg_loss: 114007.8848; val_edge_recon_loss: 2859710.7812; val_gene_expr_recon_loss: 17364674.5000; val_masked_gp_l1_reg_loss: 159526.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99103.7266; val_chrom_access_recon_loss: 2303411.3750; val_global_loss: 22900434.5000; val_optim_loss: 22900434.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9137; val_auprc_score: 0.8846; val_best_acc_score: 0.8501; val_best_f1_score: 0.8599; train_kl_reg_loss: 114814.0058; train_edge_recon_loss: 2808420.7121; train_gene_expr_recon_loss: 17535719.8182; train_masked_gp_l1_reg_loss: 160435.9524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97780.7366; train_chrom_access_recon_loss: 2360208.7652; train_global_loss: 23077380.2424; train_optim_loss: 23077380.2424; val_kl_reg_loss: 114682.3291; val_edge_recon_loss: 2860117.0000; val_gene_expr_recon_loss: 17107853.5000; val_masked_gp_l1_reg_loss: 161090.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97227.9531; val_chrom_access_recon_loss: 2275871.8594; val_global_loss: 22616842.5000; val_optim_loss: 22616842.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9181; val_auprc_score: 0.8871; val_best_acc_score: 0.8530; val_best_f1_score: 0.8601; train_kl_reg_loss: 115224.4009; train_edge_recon_loss: 2810341.0682; train_gene_expr_recon_loss: 17468373.8030; train_masked_gp_l1_reg_loss: 161703.8963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96786.3383; train_chrom_access_recon_loss: 2352247.4015; train_global_loss: 23004676.8182; train_optim_loss: 23004676.8182; val_kl_reg_loss: 116599.5312; val_edge_recon_loss: 2865783.3750; val_gene_expr_recon_loss: 17127780.3750; val_masked_gp_l1_reg_loss: 162392.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96055.3672; val_chrom_access_recon_loss: 2285960.8750; val_global_loss: 22654571.7500; val_optim_loss: 22654571.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9156; val_auprc_score: 0.8804; val_best_acc_score: 0.8560; val_best_f1_score: 0.8647; train_kl_reg_loss: 116666.9627; train_edge_recon_loss: 2803216.8712; train_gene_expr_recon_loss: 17416827.1364; train_masked_gp_l1_reg_loss: 162872.2173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95746.4748; train_chrom_access_recon_loss: 2346445.3258; train_global_loss: 22941775.0909; train_optim_loss: 22941775.0909; val_kl_reg_loss: 117379.9385; val_edge_recon_loss: 2812839.2500; val_gene_expr_recon_loss: 17217981.7500; val_masked_gp_l1_reg_loss: 163323.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95364.4375; val_chrom_access_recon_loss: 2299165.9375; val_global_loss: 22706054.5000; val_optim_loss: 22706054.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9240; val_auprc_score: 0.9017; val_best_acc_score: 0.8541; val_best_f1_score: 0.8650; train_kl_reg_loss: 115192.6043; train_edge_recon_loss: 2803508.3712; train_gene_expr_recon_loss: 17387222.1515; train_masked_gp_l1_reg_loss: 163928.0362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94879.2017; train_chrom_access_recon_loss: 2339411.4886; train_global_loss: 22904142.1515; train_optim_loss: 22904142.1515; val_kl_reg_loss: 115834.7861; val_edge_recon_loss: 2832828.8750; val_gene_expr_recon_loss: 17000176.0000; val_masked_gp_l1_reg_loss: 164717.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94933.6484; val_chrom_access_recon_loss: 2273717.8750; val_global_loss: 22482209.5000; val_optim_loss: 22482209.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9181; val_auprc_score: 0.8912; val_best_acc_score: 0.8565; val_best_f1_score: 0.8643; train_kl_reg_loss: 115631.3124; train_edge_recon_loss: 2782087.6856; train_gene_expr_recon_loss: 17332139.0000; train_masked_gp_l1_reg_loss: 164908.9429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94411.3819; train_chrom_access_recon_loss: 2335555.1818; train_global_loss: 22824733.1515; train_optim_loss: 22824733.1515; val_kl_reg_loss: 117791.6084; val_edge_recon_loss: 2828828.0312; val_gene_expr_recon_loss: 17132328.2500; val_masked_gp_l1_reg_loss: 165111.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93833.4922; val_chrom_access_recon_loss: 2280304.8125; val_global_loss: 22618198.7500; val_optim_loss: 22618198.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9234; val_auprc_score: 0.8962; val_best_acc_score: 0.8665; val_best_f1_score: 0.8748; train_kl_reg_loss: 114961.6695; train_edge_recon_loss: 2789128.5341; train_gene_expr_recon_loss: 17276689.6212; train_masked_gp_l1_reg_loss: 165459.7211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93559.3588; train_chrom_access_recon_loss: 2325858.7121; train_global_loss: 22765657.9697; train_optim_loss: 22765657.9697; val_kl_reg_loss: 115479.5410; val_edge_recon_loss: 2806897.3438; val_gene_expr_recon_loss: 17042301.5000; val_masked_gp_l1_reg_loss: 165755.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92928.4219; val_chrom_access_recon_loss: 2271621.1562; val_global_loss: 22494983.5000; val_optim_loss: 22494983.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9199; val_auprc_score: 0.8867; val_best_acc_score: 0.8667; val_best_f1_score: 0.8734; train_kl_reg_loss: 112198.9209; train_edge_recon_loss: 2788401.4962; train_gene_expr_recon_loss: 17245094.1667; train_masked_gp_l1_reg_loss: 166244.0450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92843.2232; train_chrom_access_recon_loss: 2321554.1061; train_global_loss: 22726335.9091; train_optim_loss: 22726335.9091; val_kl_reg_loss: 112063.7021; val_edge_recon_loss: 2837461.7188; val_gene_expr_recon_loss: 16960157.5000; val_masked_gp_l1_reg_loss: 166772.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92610.9141; val_chrom_access_recon_loss: 2257290.5625; val_global_loss: 22426355.2500; val_optim_loss: 22426355.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9297; val_auprc_score: 0.9074; val_best_acc_score: 0.8673; val_best_f1_score: 0.8747; train_kl_reg_loss: 115116.5801; train_edge_recon_loss: 2780431.0379; train_gene_expr_recon_loss: 17224504.3333; train_masked_gp_l1_reg_loss: 166834.8082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92118.3543; train_chrom_access_recon_loss: 2317383.5076; train_global_loss: 22696388.5758; train_optim_loss: 22696388.5758; val_kl_reg_loss: 116316.4463; val_edge_recon_loss: 2789658.0000; val_gene_expr_recon_loss: 16967930.2500; val_masked_gp_l1_reg_loss: 167251.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92065.7812; val_chrom_access_recon_loss: 2248207.6875; val_global_loss: 22381430.0000; val_optim_loss: 22381430.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9232; val_auprc_score: 0.8978; val_best_acc_score: 0.8632; val_best_f1_score: 0.8710; train_kl_reg_loss: 113025.8783; train_edge_recon_loss: 2785719.8674; train_gene_expr_recon_loss: 17196041.0455; train_masked_gp_l1_reg_loss: 167430.3364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91617.5710; train_chrom_access_recon_loss: 2315676.2917; train_global_loss: 22669511.1212; train_optim_loss: 22669511.1212; val_kl_reg_loss: 119888.4561; val_edge_recon_loss: 2829123.9375; val_gene_expr_recon_loss: 16946489.7500; val_masked_gp_l1_reg_loss: 167865.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91671.2344; val_chrom_access_recon_loss: 2263387.0000; val_global_loss: 22418426.7500; val_optim_loss: 22418426.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9298; val_auprc_score: 0.9060; val_best_acc_score: 0.8635; val_best_f1_score: 0.8719; train_kl_reg_loss: 112982.3603; train_edge_recon_loss: 2765042.7045; train_gene_expr_recon_loss: 17160786.4394; train_masked_gp_l1_reg_loss: 167989.4003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91126.3039; train_chrom_access_recon_loss: 2307879.5758; train_global_loss: 22605806.7879; train_optim_loss: 22605806.7879; val_kl_reg_loss: 108388.4326; val_edge_recon_loss: 2801396.7812; val_gene_expr_recon_loss: 16897425.5000; val_masked_gp_l1_reg_loss: 168190.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91013.5312; val_chrom_access_recon_loss: 2266973.4688; val_global_loss: 22333388.0000; val_optim_loss: 22333388.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9314; val_auprc_score: 0.9096; val_best_acc_score: 0.8705; val_best_f1_score: 0.8775; train_kl_reg_loss: 124916.1236; train_edge_recon_loss: 2809012.1098; train_gene_expr_recon_loss: 16770262.4848; train_masked_gp_l1_reg_loss: 167074.6248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88047.8293; train_chrom_access_recon_loss: 2270770.2462; train_global_loss: 22230083.5455; train_optim_loss: 22230083.5455; val_kl_reg_loss: 75646.4189; val_edge_recon_loss: 2808467.5000; val_gene_expr_recon_loss: 16578706.6250; val_masked_gp_l1_reg_loss: 166857.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88237.7031; val_chrom_access_recon_loss: 2199186.9375; val_global_loss: 21917103.2500; val_optim_loss: 21917103.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9327; val_auprc_score: 0.9052; val_best_acc_score: 0.8697; val_best_f1_score: 0.8765; train_kl_reg_loss: 120449.5559; train_edge_recon_loss: 2796293.1212; train_gene_expr_recon_loss: 16718510.9697; train_masked_gp_l1_reg_loss: 166982.8968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88115.4974; train_chrom_access_recon_loss: 2247866.7670; train_global_loss: 22138218.5758; train_optim_loss: 22138218.5758; val_kl_reg_loss: 78024.3037; val_edge_recon_loss: 2801902.4062; val_gene_expr_recon_loss: 16615607.7500; val_masked_gp_l1_reg_loss: 167453.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88442.5781; val_chrom_access_recon_loss: 2213832.1250; val_global_loss: 21965262.7500; val_optim_loss: 21965262.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9318; val_auprc_score: 0.9076; val_best_acc_score: 0.8718; val_best_f1_score: 0.8761; train_kl_reg_loss: 114940.3951; train_edge_recon_loss: 2774561.7008; train_gene_expr_recon_loss: 16683810.2727; train_masked_gp_l1_reg_loss: 167577.4550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88043.8091; train_chrom_access_recon_loss: 2246307.4678; train_global_loss: 22075241.0909; train_optim_loss: 22075241.0909; val_kl_reg_loss: 83198.1406; val_edge_recon_loss: 2805058.3750; val_gene_expr_recon_loss: 16662473.7500; val_masked_gp_l1_reg_loss: 167627.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87878.9531; val_chrom_access_recon_loss: 2229603.8438; val_global_loss: 22035840.5000; val_optim_loss: 22035840.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9280; val_auprc_score: 0.9032; val_best_acc_score: 0.8662; val_best_f1_score: 0.8741; train_kl_reg_loss: 114113.3847; train_edge_recon_loss: 2768978.1402; train_gene_expr_recon_loss: 16626384.0455; train_masked_gp_l1_reg_loss: 167712.9141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87723.8920; train_chrom_access_recon_loss: 2238323.0720; train_global_loss: 22003235.1212; train_optim_loss: 22003235.1212; val_kl_reg_loss: 84551.0117; val_edge_recon_loss: 2823618.3750; val_gene_expr_recon_loss: 16466417.2500; val_masked_gp_l1_reg_loss: 167771.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87439.4297; val_chrom_access_recon_loss: 2202270.7969; val_global_loss: 21832069.0000; val_optim_loss: 21832069.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9287; val_auprc_score: 0.9016; val_best_acc_score: 0.8732; val_best_f1_score: 0.8795; train_kl_reg_loss: 108312.0904; train_edge_recon_loss: 2766678.8106; train_gene_expr_recon_loss: 16626255.9394; train_masked_gp_l1_reg_loss: 167827.4548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87446.4091; train_chrom_access_recon_loss: 2239492.8864; train_global_loss: 21996013.4242; train_optim_loss: 21996013.4242; val_kl_reg_loss: 86173.8926; val_edge_recon_loss: 2831863.0938; val_gene_expr_recon_loss: 16428648.1250; val_masked_gp_l1_reg_loss: 167995.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87009.8594; val_chrom_access_recon_loss: 2178283.3438; val_global_loss: 21779973.5000; val_optim_loss: 21779973.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9351; val_auprc_score: 0.9143; val_best_acc_score: 0.8780; val_best_f1_score: 0.8848; train_kl_reg_loss: 107377.9609; train_edge_recon_loss: 2765824.3750; train_gene_expr_recon_loss: 16567820.8788; train_masked_gp_l1_reg_loss: 167867.4193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86854.6119; train_chrom_access_recon_loss: 2230512.8258; train_global_loss: 21926257.9091; train_optim_loss: 21926257.9091; val_kl_reg_loss: 88271.5879; val_edge_recon_loss: 2802783.4688; val_gene_expr_recon_loss: 16469471.1250; val_masked_gp_l1_reg_loss: 167804.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86125.7500; val_chrom_access_recon_loss: 2210087.5156; val_global_loss: 21824543.7500; val_optim_loss: 21824543.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9334; val_auprc_score: 0.9067; val_best_acc_score: 0.8743; val_best_f1_score: 0.8810; train_kl_reg_loss: 104737.6484; train_edge_recon_loss: 2755289.4432; train_gene_expr_recon_loss: 16548968.5909; train_masked_gp_l1_reg_loss: 167705.9749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86257.1270; train_chrom_access_recon_loss: 2226843.8864; train_global_loss: 21889802.6061; train_optim_loss: 21889802.6061; val_kl_reg_loss: 90585.2539; val_edge_recon_loss: 2799628.5938; val_gene_expr_recon_loss: 16296008.2500; val_masked_gp_l1_reg_loss: 167591.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86530.8047; val_chrom_access_recon_loss: 2159112.1406; val_global_loss: 21599455.5000; val_optim_loss: 21599455.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9350; val_auprc_score: 0.9163; val_best_acc_score: 0.8743; val_best_f1_score: 0.8810; train_kl_reg_loss: 103993.0120; train_edge_recon_loss: 2749993.4621; train_gene_expr_recon_loss: 16525154.6061; train_masked_gp_l1_reg_loss: 167580.7372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85852.7064; train_chrom_access_recon_loss: 2224995.3561; train_global_loss: 21857569.9697; train_optim_loss: 21857569.9697; val_kl_reg_loss: 92993.5156; val_edge_recon_loss: 2783400.7188; val_gene_expr_recon_loss: 16305594.5000; val_masked_gp_l1_reg_loss: 167479.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85801.5781; val_chrom_access_recon_loss: 2178238.9062; val_global_loss: 21613509.2500; val_optim_loss: 21613509.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9423; val_auprc_score: 0.9223; val_best_acc_score: 0.8788; val_best_f1_score: 0.8845; train_kl_reg_loss: 105029.3243; train_edge_recon_loss: 2755006.4280; train_gene_expr_recon_loss: 16505950.1970; train_masked_gp_l1_reg_loss: 167255.4967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85466.6609; train_chrom_access_recon_loss: 2220932.8996; train_global_loss: 21839641.0303; train_optim_loss: 21839641.0303; val_kl_reg_loss: 90220.3545; val_edge_recon_loss: 2776007.0938; val_gene_expr_recon_loss: 16168545.5000; val_masked_gp_l1_reg_loss: 167286.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85197.6172; val_chrom_access_recon_loss: 2167099.5938; val_global_loss: 21454356.7500; val_optim_loss: 21454356.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9421; val_auprc_score: 0.9269; val_best_acc_score: 0.8804; val_best_f1_score: 0.8854; train_kl_reg_loss: 103103.6249; train_edge_recon_loss: 2750007.4924; train_gene_expr_recon_loss: 16464489.2273; train_masked_gp_l1_reg_loss: 167176.8944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85426.5672; train_chrom_access_recon_loss: 2209422.2538; train_global_loss: 21779626.1818; train_optim_loss: 21779626.1818; val_kl_reg_loss: 92518.0107; val_edge_recon_loss: 2797814.2188; val_gene_expr_recon_loss: 16204334.7500; val_masked_gp_l1_reg_loss: 167018.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85391.4844; val_chrom_access_recon_loss: 2149187.8438; val_global_loss: 21496264.7500; val_optim_loss: 21496264.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9422; val_auprc_score: 0.9230; val_best_acc_score: 0.8839; val_best_f1_score: 0.8893; train_kl_reg_loss: 102829.5888; train_edge_recon_loss: 2746898.4432; train_gene_expr_recon_loss: 16439919.6515; train_masked_gp_l1_reg_loss: 166943.8572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85060.6713; train_chrom_access_recon_loss: 2206650.3352; train_global_loss: 21748302.4848; train_optim_loss: 21748302.4848; val_kl_reg_loss: 92520.2324; val_edge_recon_loss: 2773503.1875; val_gene_expr_recon_loss: 16255429.7500; val_masked_gp_l1_reg_loss: 167012.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85245.8672; val_chrom_access_recon_loss: 2133430.9375; val_global_loss: 21507141.5000; val_optim_loss: 21507141.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9468; val_auprc_score: 0.9277; val_best_acc_score: 0.8864; val_best_f1_score: 0.8906; train_kl_reg_loss: 102381.6083; train_edge_recon_loss: 2738727.1932; train_gene_expr_recon_loss: 16413240.7121; train_masked_gp_l1_reg_loss: 166999.5902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85203.1306; train_chrom_access_recon_loss: 2205175.2386; train_global_loss: 21711727.6970; train_optim_loss: 21711727.6970; val_kl_reg_loss: 93477.1855; val_edge_recon_loss: 2792333.9375; val_gene_expr_recon_loss: 16133067.5000; val_masked_gp_l1_reg_loss: 167008.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85597.1406; val_chrom_access_recon_loss: 2151452.9688; val_global_loss: 21422937.5000; val_optim_loss: 21422937.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9453; val_auprc_score: 0.9287; val_best_acc_score: 0.8874; val_best_f1_score: 0.8931; train_kl_reg_loss: 103354.0951; train_edge_recon_loss: 2736936.4167; train_gene_expr_recon_loss: 16404495.8939; train_masked_gp_l1_reg_loss: 166699.1309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84936.7732; train_chrom_access_recon_loss: 2204992.9773; train_global_loss: 21701415.3030; train_optim_loss: 21701415.3030; val_kl_reg_loss: 94503.5176; val_edge_recon_loss: 2771425.2500; val_gene_expr_recon_loss: 16228744.0000; val_masked_gp_l1_reg_loss: 166977.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85084.8125; val_chrom_access_recon_loss: 2146746.5781; val_global_loss: 21493481.7500; val_optim_loss: 21493481.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9410; val_auprc_score: 0.9176; val_best_acc_score: 0.8861; val_best_f1_score: 0.8930; train_kl_reg_loss: 101389.0929; train_edge_recon_loss: 2736428.7424; train_gene_expr_recon_loss: 16371607.2424; train_masked_gp_l1_reg_loss: 166830.3205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84845.0988; train_chrom_access_recon_loss: 2196842.9375; train_global_loss: 21657943.4242; train_optim_loss: 21657943.4242; val_kl_reg_loss: 95600.9531; val_edge_recon_loss: 2779310.9375; val_gene_expr_recon_loss: 16303613.8750; val_masked_gp_l1_reg_loss: 166562.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84545.7031; val_chrom_access_recon_loss: 2154607.8750; val_global_loss: 21584241.7500; val_optim_loss: 21584241.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9445; val_auprc_score: 0.9209; val_best_acc_score: 0.8898; val_best_f1_score: 0.8927; train_kl_reg_loss: 101503.5775; train_edge_recon_loss: 2740469.8485; train_gene_expr_recon_loss: 16345969.4848; train_masked_gp_l1_reg_loss: 166487.3987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84399.3317; train_chrom_access_recon_loss: 2191946.7746; train_global_loss: 21630776.4848; train_optim_loss: 21630776.4848; val_kl_reg_loss: 94429.4229; val_edge_recon_loss: 2768447.6562; val_gene_expr_recon_loss: 16174236.6250; val_masked_gp_l1_reg_loss: 166323.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84346.9453; val_chrom_access_recon_loss: 2134207.7656; val_global_loss: 21421991.5000; val_optim_loss: 21421991.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9368; val_auprc_score: 0.9073; val_best_acc_score: 0.8880; val_best_f1_score: 0.8933; train_kl_reg_loss: 101460.4091; train_edge_recon_loss: 2734464.8144; train_gene_expr_recon_loss: 16329274.5000; train_masked_gp_l1_reg_loss: 166330.0819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84372.6080; train_chrom_access_recon_loss: 2190694.5739; train_global_loss: 21606596.7879; train_optim_loss: 21606596.7879; val_kl_reg_loss: 97468.4355; val_edge_recon_loss: 2791840.6250; val_gene_expr_recon_loss: 16277784.5000; val_masked_gp_l1_reg_loss: 166439.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84110.9297; val_chrom_access_recon_loss: 2169128.4062; val_global_loss: 21586772.0000; val_optim_loss: 21586772.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9531; val_auprc_score: 0.9375; val_best_acc_score: 0.8960; val_best_f1_score: 0.9003; train_kl_reg_loss: 101590.5404; train_edge_recon_loss: 2725136.7500; train_gene_expr_recon_loss: 16305657.0152; train_masked_gp_l1_reg_loss: 166356.2947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84172.1934; train_chrom_access_recon_loss: 2188071.5606; train_global_loss: 21570984.3333; train_optim_loss: 21570984.3333; val_kl_reg_loss: 97187.1611; val_edge_recon_loss: 2743729.0625; val_gene_expr_recon_loss: 16047919.8750; val_masked_gp_l1_reg_loss: 166478.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83781.8672; val_chrom_access_recon_loss: 2130941.7188; val_global_loss: 21270037.7500; val_optim_loss: 21270037.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9528; val_auprc_score: 0.9362; val_best_acc_score: 0.8987; val_best_f1_score: 0.9026; train_kl_reg_loss: 100724.9730; train_edge_recon_loss: 2733092.1856; train_gene_expr_recon_loss: 16289661.8182; train_masked_gp_l1_reg_loss: 166520.4406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84199.1663; train_chrom_access_recon_loss: 2185358.6004; train_global_loss: 21559557.2424; train_optim_loss: 21559557.2424; val_kl_reg_loss: 95926.7842; val_edge_recon_loss: 2744804.5312; val_gene_expr_recon_loss: 16039028.0000; val_masked_gp_l1_reg_loss: 166500.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84271.9688; val_chrom_access_recon_loss: 2126258.5469; val_global_loss: 21256789.7500; val_optim_loss: 21256789.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9512; val_auprc_score: 0.9326; val_best_acc_score: 0.9009; val_best_f1_score: 0.9053; train_kl_reg_loss: 100774.4798; train_edge_recon_loss: 2722770.2500; train_gene_expr_recon_loss: 16264917.6970; train_masked_gp_l1_reg_loss: 166509.5057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84085.0047; train_chrom_access_recon_loss: 2180467.4375; train_global_loss: 21519524.3939; train_optim_loss: 21519524.3939; val_kl_reg_loss: 96366.1445; val_edge_recon_loss: 2748473.9375; val_gene_expr_recon_loss: 16034083.7500; val_masked_gp_l1_reg_loss: 166530.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83741.7734; val_chrom_access_recon_loss: 2123124.4531; val_global_loss: 21252319.7500; val_optim_loss: 21252319.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9523; val_auprc_score: 0.9384; val_best_acc_score: 0.8971; val_best_f1_score: 0.8988; train_kl_reg_loss: 99879.1296; train_edge_recon_loss: 2735143.3939; train_gene_expr_recon_loss: 16252001.0455; train_masked_gp_l1_reg_loss: 166643.0265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84019.3625; train_chrom_access_recon_loss: 2180483.5246; train_global_loss: 21518169.3333; train_optim_loss: 21518169.3333; val_kl_reg_loss: 94599.1602; val_edge_recon_loss: 2740468.3125; val_gene_expr_recon_loss: 16238758.7500; val_masked_gp_l1_reg_loss: 166682.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83640.1484; val_chrom_access_recon_loss: 2140531.5312; val_global_loss: 21464679.5000; val_optim_loss: 21464679.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9516; val_auprc_score: 0.9371; val_best_acc_score: 0.8982; val_best_f1_score: 0.9024; train_kl_reg_loss: 100073.0614; train_edge_recon_loss: 2729745.0341; train_gene_expr_recon_loss: 16229594.8030; train_masked_gp_l1_reg_loss: 166774.2483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84005.3379; train_chrom_access_recon_loss: 2176403.7860; train_global_loss: 21486596.2121; train_optim_loss: 21486596.2121; val_kl_reg_loss: 97020.7178; val_edge_recon_loss: 2756335.2812; val_gene_expr_recon_loss: 16036933.8750; val_masked_gp_l1_reg_loss: 166682.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84066.1484; val_chrom_access_recon_loss: 2135081.3750; val_global_loss: 21276119.2500; val_optim_loss: 21276119.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9529; val_auprc_score: 0.9389; val_best_acc_score: 0.8963; val_best_f1_score: 0.9007; train_kl_reg_loss: 100391.2472; train_edge_recon_loss: 2728738.4811; train_gene_expr_recon_loss: 16222297.0606; train_masked_gp_l1_reg_loss: 166725.0329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83882.3610; train_chrom_access_recon_loss: 2179130.5795; train_global_loss: 21481164.7879; train_optim_loss: 21481164.7879; val_kl_reg_loss: 100821.4805; val_edge_recon_loss: 2758641.9375; val_gene_expr_recon_loss: 16029968.8750; val_masked_gp_l1_reg_loss: 166963.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83802.9375; val_chrom_access_recon_loss: 2121676.9688; val_global_loss: 21261875.2500; val_optim_loss: 21261875.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9562; val_auprc_score: 0.9436; val_best_acc_score: 0.9068; val_best_f1_score: 0.9106; train_kl_reg_loss: 99865.3391; train_edge_recon_loss: 2729323.9811; train_gene_expr_recon_loss: 16200742.7727; train_masked_gp_l1_reg_loss: 166915.9751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83895.8200; train_chrom_access_recon_loss: 2174756.1364; train_global_loss: 21455499.9697; train_optim_loss: 21455499.9697; val_kl_reg_loss: 92347.0576; val_edge_recon_loss: 2735533.2188; val_gene_expr_recon_loss: 16061007.3750; val_masked_gp_l1_reg_loss: 167078.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83959.0625; val_chrom_access_recon_loss: 2128181.7969; val_global_loss: 21268107.5000; val_optim_loss: 21268107.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9519; val_auprc_score: 0.9308; val_best_acc_score: 0.9003; val_best_f1_score: 0.9052; train_kl_reg_loss: 98984.3403; train_edge_recon_loss: 2720748.7386; train_gene_expr_recon_loss: 16182696.6364; train_masked_gp_l1_reg_loss: 165253.6894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66969.8078; train_chrom_access_recon_loss: 2172421.4583; train_global_loss: 21407074.7273; train_optim_loss: 21407074.7273; val_kl_reg_loss: 95856.9453; val_edge_recon_loss: 2747821.0938; val_gene_expr_recon_loss: 16017855.7500; val_masked_gp_l1_reg_loss: 164517.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63699.9375; val_chrom_access_recon_loss: 2118460.7812; val_global_loss: 21208212.7500; val_optim_loss: 21208212.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9465; val_auprc_score: 0.9240; val_best_acc_score: 0.8995; val_best_f1_score: 0.9042; train_kl_reg_loss: 100742.8383; train_edge_recon_loss: 2725687.5795; train_gene_expr_recon_loss: 16167431.7879; train_masked_gp_l1_reg_loss: 164343.3752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63376.4449; train_chrom_access_recon_loss: 2170894.2746; train_global_loss: 21392476.2121; train_optim_loss: 21392476.2121; val_kl_reg_loss: 97208.6084; val_edge_recon_loss: 2764810.5312; val_gene_expr_recon_loss: 15976612.0000; val_masked_gp_l1_reg_loss: 164203.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63137.0469; val_chrom_access_recon_loss: 2128771.6406; val_global_loss: 21194745.2500; val_optim_loss: 21194745.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9558; val_auprc_score: 0.9386; val_best_acc_score: 0.9089; val_best_f1_score: 0.9122; train_kl_reg_loss: 102098.4588; train_edge_recon_loss: 2722514.2121; train_gene_expr_recon_loss: 16177389.4697; train_masked_gp_l1_reg_loss: 164133.3838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62964.7471; train_chrom_access_recon_loss: 2171460.8049; train_global_loss: 21400560.9697; train_optim_loss: 21400560.9697; val_kl_reg_loss: 99353.5459; val_edge_recon_loss: 2701815.5938; val_gene_expr_recon_loss: 15995193.7500; val_masked_gp_l1_reg_loss: 164049.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62710.5312; val_chrom_access_recon_loss: 2123515.7656; val_global_loss: 21146638.5000; val_optim_loss: 21146638.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9525; val_auprc_score: 0.9300; val_best_acc_score: 0.9054; val_best_f1_score: 0.9097; train_kl_reg_loss: 102285.2915; train_edge_recon_loss: 2719602.7803; train_gene_expr_recon_loss: 16181145.1970; train_masked_gp_l1_reg_loss: 164031.4943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62663.4513; train_chrom_access_recon_loss: 2172949.8580; train_global_loss: 21402678.0909; train_optim_loss: 21402678.0909; val_kl_reg_loss: 99883.6289; val_edge_recon_loss: 2730039.3438; val_gene_expr_recon_loss: 15961560.0000; val_masked_gp_l1_reg_loss: 164008.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62551.9648; val_chrom_access_recon_loss: 2119757.5625; val_global_loss: 21137800.5000; val_optim_loss: 21137800.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9568; val_auprc_score: 0.9403; val_best_acc_score: 0.9095; val_best_f1_score: 0.9127; train_kl_reg_loss: 103501.3830; train_edge_recon_loss: 2715345.2235; train_gene_expr_recon_loss: 16158222.6818; train_masked_gp_l1_reg_loss: 163981.1944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62441.7820; train_chrom_access_recon_loss: 2171754.3864; train_global_loss: 21375246.8788; train_optim_loss: 21375246.8788; val_kl_reg_loss: 99822.0332; val_edge_recon_loss: 2725608.9375; val_gene_expr_recon_loss: 15978114.6250; val_masked_gp_l1_reg_loss: 163972.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62375.1836; val_chrom_access_recon_loss: 2109363.3125; val_global_loss: 21139256.5000; val_optim_loss: 21139256.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9516; val_auprc_score: 0.9358; val_best_acc_score: 0.8984; val_best_f1_score: 0.9028; train_kl_reg_loss: 103674.8857; train_edge_recon_loss: 2722513.4356; train_gene_expr_recon_loss: 16170922.0152; train_masked_gp_l1_reg_loss: 163954.8163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62198.2576; train_chrom_access_recon_loss: 2172513.8030; train_global_loss: 21395777.2727; train_optim_loss: 21395777.2727; val_kl_reg_loss: 99762.8428; val_edge_recon_loss: 2784186.2500; val_gene_expr_recon_loss: 16009815.0000; val_masked_gp_l1_reg_loss: 163960.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62098.7109; val_chrom_access_recon_loss: 2115425.8281; val_global_loss: 21235247.5000; val_optim_loss: 21235247.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9529; val_auprc_score: 0.9354; val_best_acc_score: 0.9049; val_best_f1_score: 0.9086; train_kl_reg_loss: 103379.3052; train_edge_recon_loss: 2727902.0076; train_gene_expr_recon_loss: 16159768.3485; train_masked_gp_l1_reg_loss: 163954.0601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62093.0292; train_chrom_access_recon_loss: 2172529.0947; train_global_loss: 21389625.6061; train_optim_loss: 21389625.6061; val_kl_reg_loss: 100568.0332; val_edge_recon_loss: 2739424.9062; val_gene_expr_recon_loss: 15920636.6250; val_masked_gp_l1_reg_loss: 163938.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61952.9609; val_chrom_access_recon_loss: 2110170.5625; val_global_loss: 21096690.5000; val_optim_loss: 21096690.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9534; val_auprc_score: 0.9358; val_best_acc_score: 0.9052; val_best_f1_score: 0.9096; train_kl_reg_loss: 102691.1113; train_edge_recon_loss: 2721563.1629; train_gene_expr_recon_loss: 16162953.9697; train_masked_gp_l1_reg_loss: 163926.7519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61877.2758; train_chrom_access_recon_loss: 2171677.2898; train_global_loss: 21384689.6061; train_optim_loss: 21384689.6061; val_kl_reg_loss: 99372.1787; val_edge_recon_loss: 2744627.9062; val_gene_expr_recon_loss: 15924027.5000; val_masked_gp_l1_reg_loss: 163940.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61783.0078; val_chrom_access_recon_loss: 2112345.7812; val_global_loss: 21106097.0000; val_optim_loss: 21106097.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9510; val_auprc_score: 0.9303; val_best_acc_score: 0.9027; val_best_f1_score: 0.9067; train_kl_reg_loss: 103637.9860; train_edge_recon_loss: 2722740.3826; train_gene_expr_recon_loss: 16166447.1515; train_masked_gp_l1_reg_loss: 163941.8575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61727.3755; train_chrom_access_recon_loss: 2172600.3352; train_global_loss: 21391095.1515; train_optim_loss: 21391095.1515; val_kl_reg_loss: 100329.5947; val_edge_recon_loss: 2756946.0938; val_gene_expr_recon_loss: 16008970.0000; val_masked_gp_l1_reg_loss: 163937.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61729.0312; val_chrom_access_recon_loss: 2131315.1562; val_global_loss: 21223229.0000; val_optim_loss: 21223229.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9535; val_auprc_score: 0.9388; val_best_acc_score: 0.9001; val_best_f1_score: 0.9045; train_kl_reg_loss: 103320.7299; train_edge_recon_loss: 2715227.5189; train_gene_expr_recon_loss: 16155481.6515; train_masked_gp_l1_reg_loss: 163951.3963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61633.9878; train_chrom_access_recon_loss: 2170915.5492; train_global_loss: 21370530.8788; train_optim_loss: 21370530.8788; val_kl_reg_loss: 100773.0781; val_edge_recon_loss: 2791511.4062; val_gene_expr_recon_loss: 15961534.7500; val_masked_gp_l1_reg_loss: 163959.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61551.5977; val_chrom_access_recon_loss: 2133008.0312; val_global_loss: 21212339.2500; val_optim_loss: 21212339.2500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9589; val_auprc_score: 0.9469; val_best_acc_score: 0.9062; val_best_f1_score: 0.9107; train_kl_reg_loss: 103169.7734; train_edge_recon_loss: 2716958.8826; train_gene_expr_recon_loss: 16159009.6061; train_masked_gp_l1_reg_loss: 163985.8506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61474.4222; train_chrom_access_recon_loss: 2172330.4205; train_global_loss: 21376929.0606; train_optim_loss: 21376929.0606; val_kl_reg_loss: 101206.8428; val_edge_recon_loss: 2734000.2500; val_gene_expr_recon_loss: 15970917.8750; val_masked_gp_l1_reg_loss: 163987.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61411.1680; val_chrom_access_recon_loss: 2098929.3281; val_global_loss: 21130454.2500; val_optim_loss: 21130454.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9549; val_auprc_score: 0.9413; val_best_acc_score: 0.9041; val_best_f1_score: 0.9080; train_kl_reg_loss: 103407.2604; train_edge_recon_loss: 2717619.5341; train_gene_expr_recon_loss: 16158457.2273; train_masked_gp_l1_reg_loss: 163799.7256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59608.5756; train_chrom_access_recon_loss: 2170544.0114; train_global_loss: 21373436.4242; train_optim_loss: 21373436.4242; val_kl_reg_loss: 100655.6045; val_edge_recon_loss: 2732027.4688; val_gene_expr_recon_loss: 16072270.3750; val_masked_gp_l1_reg_loss: 163711.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59266.2734; val_chrom_access_recon_loss: 2151698.1094; val_global_loss: 21279629.2500; val_optim_loss: 21279629.2500
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9530; val_auprc_score: 0.9408; val_best_acc_score: 0.8984; val_best_f1_score: 0.9035; train_kl_reg_loss: 103339.8558; train_edge_recon_loss: 2720499.3068; train_gene_expr_recon_loss: 16150934.2424; train_masked_gp_l1_reg_loss: 163681.0990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59240.7334; train_chrom_access_recon_loss: 2170448.0587; train_global_loss: 21368143.4848; train_optim_loss: 21368143.4848; val_kl_reg_loss: 100368.3887; val_edge_recon_loss: 2780190.1562; val_gene_expr_recon_loss: 15975176.1250; val_masked_gp_l1_reg_loss: 163655.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59215.2266; val_chrom_access_recon_loss: 2137622.1094; val_global_loss: 21216228.7500; val_optim_loss: 21216228.7500
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9530; val_auprc_score: 0.9364; val_best_acc_score: 0.9014; val_best_f1_score: 0.9058; train_kl_reg_loss: 103400.9018; train_edge_recon_loss: 2723661.2500; train_gene_expr_recon_loss: 16154683.6061; train_masked_gp_l1_reg_loss: 163642.0696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59191.5254; train_chrom_access_recon_loss: 2170411.6439; train_global_loss: 21374991.0000; train_optim_loss: 21374991.0000; val_kl_reg_loss: 100563.5264; val_edge_recon_loss: 2767320.0625; val_gene_expr_recon_loss: 15957052.3750; val_masked_gp_l1_reg_loss: 163629.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59177.8047; val_chrom_access_recon_loss: 2100897.0781; val_global_loss: 21148641.0000; val_optim_loss: 21148641.0000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9608; val_auprc_score: 0.9504; val_best_acc_score: 0.9068; val_best_f1_score: 0.9103; train_kl_reg_loss: 103311.1850; train_edge_recon_loss: 2715289.8068; train_gene_expr_recon_loss: 16152784.1364; train_masked_gp_l1_reg_loss: 163622.5329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59165.4732; train_chrom_access_recon_loss: 2172225.9148; train_global_loss: 21366399.2121; train_optim_loss: 21366399.2121; val_kl_reg_loss: 101056.3906; val_edge_recon_loss: 2732664.1250; val_gene_expr_recon_loss: 16026955.1250; val_masked_gp_l1_reg_loss: 163614.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59155.9531; val_chrom_access_recon_loss: 2123621.7188; val_global_loss: 21207067.2500; val_optim_loss: 21207067.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 55 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9510
val AUPRC score: 0.9340
val best accuracy score: 0.8976
val best F1 score: 0.9024
val target rna MSE score: 1.3117
val source rna MSE score: 0.4355
val target atac MSE score: 0.4469
val source atac MSE score: 0.0986
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
