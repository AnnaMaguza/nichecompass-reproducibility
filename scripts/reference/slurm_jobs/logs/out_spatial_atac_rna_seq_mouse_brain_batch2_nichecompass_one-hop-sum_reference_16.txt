[True]
Run timestamp: 10082023_171724_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7848; val_auprc_score: 0.7978; val_best_acc_score: 0.5371; val_best_f1_score: 0.6820; train_kl_reg_loss: 152290.7550; train_edge_recon_loss: 3710396.6584; train_gene_expr_recon_loss: 28290626.1832; train_masked_gp_l1_reg_loss: 82303.5154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245059.9280; train_chrom_access_recon_loss: 25464872.7634; train_global_loss: 57945549.4962; train_optim_loss: 57945549.4962; val_kl_reg_loss: 155865.0271; val_edge_recon_loss: 4062985.6000; val_gene_expr_recon_loss: 23467860.2667; val_masked_gp_l1_reg_loss: 77413.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240403.3125; val_chrom_access_recon_loss: 23559874.6667; val_global_loss: 51564403.7333; val_optim_loss: 51564403.7333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7980; val_auprc_score: 0.8170; val_best_acc_score: 0.6730; val_best_f1_score: 0.7280; train_kl_reg_loss: 189314.7817; train_edge_recon_loss: 3625530.4695; train_gene_expr_recon_loss: 23083185.3893; train_masked_gp_l1_reg_loss: 75390.3238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233637.0879; train_chrom_access_recon_loss: 23130513.7099; train_global_loss: 50337571.8473; train_optim_loss: 50337571.8473; val_kl_reg_loss: 172872.8594; val_edge_recon_loss: 4053892.9500; val_gene_expr_recon_loss: 22513062.2667; val_masked_gp_l1_reg_loss: 73102.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225978.3438; val_chrom_access_recon_loss: 23116130.6667; val_global_loss: 50155038.6667; val_optim_loss: 50155038.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8565; val_auprc_score: 0.8586; val_best_acc_score: 0.7693; val_best_f1_score: 0.7820; train_kl_reg_loss: 173688.2940; train_edge_recon_loss: 3556738.7443; train_gene_expr_recon_loss: 22298832.5649; train_masked_gp_l1_reg_loss: 72747.7041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217861.4531; train_chrom_access_recon_loss: 22884628.4733; train_global_loss: 49204497.2214; train_optim_loss: 49204497.2214; val_kl_reg_loss: 156382.8490; val_edge_recon_loss: 3879851.0333; val_gene_expr_recon_loss: 22275824.2667; val_masked_gp_l1_reg_loss: 73677.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209550.7812; val_chrom_access_recon_loss: 23142643.0667; val_global_loss: 49737929.0667; val_optim_loss: 49737929.0667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8758; val_auprc_score: 0.8643; val_best_acc_score: 0.7945; val_best_f1_score: 0.8043; train_kl_reg_loss: 157170.7616; train_edge_recon_loss: 3265677.8053; train_gene_expr_recon_loss: 22232469.8473; train_masked_gp_l1_reg_loss: 76082.6122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 201523.2201; train_chrom_access_recon_loss: 22785477.5573; train_global_loss: 48718401.7710; train_optim_loss: 48718401.7710; val_kl_reg_loss: 125873.1604; val_edge_recon_loss: 3080396.6500; val_gene_expr_recon_loss: 22456803.7333; val_masked_gp_l1_reg_loss: 78430.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193519.8438; val_chrom_access_recon_loss: 23138970.4000; val_global_loss: 49073993.8667; val_optim_loss: 49073993.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8887; val_auprc_score: 0.8794; val_best_acc_score: 0.8033; val_best_f1_score: 0.8149; train_kl_reg_loss: 166841.4335; train_edge_recon_loss: 3059256.1832; train_gene_expr_recon_loss: 22082783.4198; train_masked_gp_l1_reg_loss: 80606.7739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186227.3799; train_chrom_access_recon_loss: 22636560.0153; train_global_loss: 48212275.2977; train_optim_loss: 48212275.2977; val_kl_reg_loss: 170981.1417; val_edge_recon_loss: 3034106.1333; val_gene_expr_recon_loss: 22015080.1333; val_masked_gp_l1_reg_loss: 81305.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178803.9844; val_chrom_access_recon_loss: 22931452.9333; val_global_loss: 48411730.6667; val_optim_loss: 48411730.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9023; val_auprc_score: 0.8927; val_best_acc_score: 0.8188; val_best_f1_score: 0.8305; train_kl_reg_loss: 165964.0076; train_edge_recon_loss: 2997570.2748; train_gene_expr_recon_loss: 21873354.7328; train_masked_gp_l1_reg_loss: 82724.7861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172183.6697; train_chrom_access_recon_loss: 22496038.9771; train_global_loss: 47787836.0305; train_optim_loss: 47787836.0305; val_kl_reg_loss: 162871.0094; val_edge_recon_loss: 3013765.7500; val_gene_expr_recon_loss: 21882458.2667; val_masked_gp_l1_reg_loss: 83955.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165719.6562; val_chrom_access_recon_loss: 22727833.2000; val_global_loss: 48036604.5333; val_optim_loss: 48036604.5333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9122; val_auprc_score: 0.9000; val_best_acc_score: 0.8340; val_best_f1_score: 0.8460; train_kl_reg_loss: 161982.6131; train_edge_recon_loss: 2957930.0229; train_gene_expr_recon_loss: 21687243.8931; train_masked_gp_l1_reg_loss: 84815.4142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159712.9436; train_chrom_access_recon_loss: 22441947.4198; train_global_loss: 47493632.3969; train_optim_loss: 47493632.3969; val_kl_reg_loss: 159204.3677; val_edge_recon_loss: 2940142.3000; val_gene_expr_recon_loss: 21712966.8000; val_masked_gp_l1_reg_loss: 85548.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153802.0781; val_chrom_access_recon_loss: 22560000.9333; val_global_loss: 47611664.0000; val_optim_loss: 47611664.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9240; val_auprc_score: 0.9099; val_best_acc_score: 0.8513; val_best_f1_score: 0.8613; train_kl_reg_loss: 157839.8819; train_edge_recon_loss: 2914666.5076; train_gene_expr_recon_loss: 21549541.0382; train_masked_gp_l1_reg_loss: 86734.1849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148429.1760; train_chrom_access_recon_loss: 22327774.8397; train_global_loss: 47184985.6489; train_optim_loss: 47184985.6489; val_kl_reg_loss: 158259.9188; val_edge_recon_loss: 2894382.6667; val_gene_expr_recon_loss: 21632545.3333; val_masked_gp_l1_reg_loss: 87981.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143221.6250; val_chrom_access_recon_loss: 22483634.0000; val_global_loss: 47400026.4000; val_optim_loss: 47400026.4000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9282; val_auprc_score: 0.9135; val_best_acc_score: 0.8580; val_best_f1_score: 0.8672; train_kl_reg_loss: 156975.9994; train_edge_recon_loss: 2872820.4313; train_gene_expr_recon_loss: 21434969.6489; train_masked_gp_l1_reg_loss: 88976.4816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138493.2250; train_chrom_access_recon_loss: 22217694.7023; train_global_loss: 46909930.4427; train_optim_loss: 46909930.4427; val_kl_reg_loss: 154909.0385; val_edge_recon_loss: 2879424.7500; val_gene_expr_recon_loss: 21587418.1333; val_masked_gp_l1_reg_loss: 90313.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133884.4219; val_chrom_access_recon_loss: 22608773.4667; val_global_loss: 47454722.9333; val_optim_loss: 47454722.9333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9317; val_auprc_score: 0.9152; val_best_acc_score: 0.8638; val_best_f1_score: 0.8746; train_kl_reg_loss: 152289.1809; train_edge_recon_loss: 2860706.0534; train_gene_expr_recon_loss: 21366218.7176; train_masked_gp_l1_reg_loss: 91026.4482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129725.3709; train_chrom_access_recon_loss: 22147847.4809; train_global_loss: 46747812.9466; train_optim_loss: 46747812.9466; val_kl_reg_loss: 152090.8479; val_edge_recon_loss: 2862771.2833; val_gene_expr_recon_loss: 21375293.7333; val_masked_gp_l1_reg_loss: 91726.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125530.3750; val_chrom_access_recon_loss: 22349295.7333; val_global_loss: 46956707.4667; val_optim_loss: 46956707.4667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9389; val_auprc_score: 0.9259; val_best_acc_score: 0.8732; val_best_f1_score: 0.8817; train_kl_reg_loss: 149542.6392; train_edge_recon_loss: 2837347.5248; train_gene_expr_recon_loss: 21268829.4656; train_masked_gp_l1_reg_loss: 92924.3910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121736.2746; train_chrom_access_recon_loss: 22051796.7481; train_global_loss: 46522176.7634; train_optim_loss: 46522176.7634; val_kl_reg_loss: 150630.4167; val_edge_recon_loss: 2838245.2333; val_gene_expr_recon_loss: 21357407.8667; val_masked_gp_l1_reg_loss: 94110.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118028.9766; val_chrom_access_recon_loss: 22262066.6667; val_global_loss: 46820488.2667; val_optim_loss: 46820488.2667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9361; val_auprc_score: 0.9201; val_best_acc_score: 0.8711; val_best_f1_score: 0.8807; train_kl_reg_loss: 146986.6904; train_edge_recon_loss: 2817562.9866; train_gene_expr_recon_loss: 21176181.3740; train_masked_gp_l1_reg_loss: 94881.8668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114525.2365; train_chrom_access_recon_loss: 21934023.0229; train_global_loss: 46284160.9466; train_optim_loss: 46284160.9466; val_kl_reg_loss: 144867.3115; val_edge_recon_loss: 2835466.5000; val_gene_expr_recon_loss: 21275467.0667; val_masked_gp_l1_reg_loss: 95723.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111157.5938; val_chrom_access_recon_loss: 22234076.5333; val_global_loss: 46696759.2000; val_optim_loss: 46696759.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9477; val_auprc_score: 0.9352; val_best_acc_score: 0.8845; val_best_f1_score: 0.8913; train_kl_reg_loss: 142135.0012; train_edge_recon_loss: 2800589.8798; train_gene_expr_recon_loss: 21106747.4198; train_masked_gp_l1_reg_loss: 96544.0878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108098.1235; train_chrom_access_recon_loss: 21894381.4351; train_global_loss: 46148495.8473; train_optim_loss: 46148495.8473; val_kl_reg_loss: 141451.1635; val_edge_recon_loss: 2824575.2333; val_gene_expr_recon_loss: 21295404.1333; val_masked_gp_l1_reg_loss: 97546.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105083.9453; val_chrom_access_recon_loss: 22332267.8667; val_global_loss: 46796327.4667; val_optim_loss: 46796327.4667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9527; val_auprc_score: 0.9430; val_best_acc_score: 0.8886; val_best_f1_score: 0.8942; train_kl_reg_loss: 138085.2044; train_edge_recon_loss: 2793459.4122; train_gene_expr_recon_loss: 21041603.3130; train_masked_gp_l1_reg_loss: 98290.5787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102336.0815; train_chrom_access_recon_loss: 21832970.7939; train_global_loss: 46006745.5267; train_optim_loss: 46006745.5267; val_kl_reg_loss: 136955.5396; val_edge_recon_loss: 2789995.1000; val_gene_expr_recon_loss: 21094067.7333; val_masked_gp_l1_reg_loss: 99270.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99657.0703; val_chrom_access_recon_loss: 22065384.8000; val_global_loss: 46285330.9333; val_optim_loss: 46285330.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9562; val_auprc_score: 0.9472; val_best_acc_score: 0.8956; val_best_f1_score: 0.8992; train_kl_reg_loss: 135271.5506; train_edge_recon_loss: 2790184.4408; train_gene_expr_recon_loss: 20995199.6031; train_masked_gp_l1_reg_loss: 100049.1041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97130.7411; train_chrom_access_recon_loss: 21764071.8931; train_global_loss: 45881907.4198; train_optim_loss: 45881907.4198; val_kl_reg_loss: 134120.1490; val_edge_recon_loss: 2788523.4500; val_gene_expr_recon_loss: 21105691.0667; val_masked_gp_l1_reg_loss: 100811.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94555.1719; val_chrom_access_recon_loss: 21986479.3333; val_global_loss: 46210182.1333; val_optim_loss: 46210182.1333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9577; val_auprc_score: 0.9463; val_best_acc_score: 0.8961; val_best_f1_score: 0.9010; train_kl_reg_loss: 133027.9139; train_edge_recon_loss: 2781842.9981; train_gene_expr_recon_loss: 20943533.7710; train_masked_gp_l1_reg_loss: 101668.5205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92203.2207; train_chrom_access_recon_loss: 21731467.6183; train_global_loss: 45783744.0611; train_optim_loss: 45783744.0611; val_kl_reg_loss: 132507.8318; val_edge_recon_loss: 2773746.4833; val_gene_expr_recon_loss: 21042846.5333; val_masked_gp_l1_reg_loss: 102424.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89961.5391; val_chrom_access_recon_loss: 22003748.0000; val_global_loss: 46145234.6667; val_optim_loss: 46145234.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9603; val_auprc_score: 0.9506; val_best_acc_score: 0.9054; val_best_f1_score: 0.9103; train_kl_reg_loss: 130526.2483; train_edge_recon_loss: 2763647.3721; train_gene_expr_recon_loss: 20875756.4122; train_masked_gp_l1_reg_loss: 103252.4771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87767.4327; train_chrom_access_recon_loss: 21629386.8397; train_global_loss: 45590336.6412; train_optim_loss: 45590336.6412; val_kl_reg_loss: 131042.8698; val_edge_recon_loss: 2759522.4667; val_gene_expr_recon_loss: 21007131.6000; val_masked_gp_l1_reg_loss: 104103.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85666.0312; val_chrom_access_recon_loss: 21922146.1333; val_global_loss: 46009613.0667; val_optim_loss: 46009613.0667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9640; val_auprc_score: 0.9576; val_best_acc_score: 0.9033; val_best_f1_score: 0.9085; train_kl_reg_loss: 128467.7268; train_edge_recon_loss: 2769413.0019; train_gene_expr_recon_loss: 20841186.8855; train_masked_gp_l1_reg_loss: 104867.9807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83667.2911; train_chrom_access_recon_loss: 21619260.3053; train_global_loss: 45546863.3588; train_optim_loss: 45546863.3588; val_kl_reg_loss: 131205.8687; val_edge_recon_loss: 2768066.3500; val_gene_expr_recon_loss: 20972260.9333; val_masked_gp_l1_reg_loss: 105711.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81763.5781; val_chrom_access_recon_loss: 21889332.0000; val_global_loss: 45948340.5333; val_optim_loss: 45948340.5333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9678; val_auprc_score: 0.9612; val_best_acc_score: 0.9150; val_best_f1_score: 0.9184; train_kl_reg_loss: 125709.8167; train_edge_recon_loss: 2763880.8912; train_gene_expr_recon_loss: 20818065.3588; train_masked_gp_l1_reg_loss: 106465.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79958.7209; train_chrom_access_recon_loss: 21594569.4351; train_global_loss: 45488649.6183; train_optim_loss: 45488649.6183; val_kl_reg_loss: 125645.6620; val_edge_recon_loss: 2750044.2500; val_gene_expr_recon_loss: 20916539.3333; val_masked_gp_l1_reg_loss: 107242.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78221.3594; val_chrom_access_recon_loss: 21876235.2000; val_global_loss: 45853928.5333; val_optim_loss: 45853928.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9688; val_auprc_score: 0.9611; val_best_acc_score: 0.9163; val_best_f1_score: 0.9189; train_kl_reg_loss: 124626.0502; train_edge_recon_loss: 2752630.8187; train_gene_expr_recon_loss: 20754122.2290; train_masked_gp_l1_reg_loss: 108026.8421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76612.3160; train_chrom_access_recon_loss: 21515771.8168; train_global_loss: 45331790.1069; train_optim_loss: 45331790.1069; val_kl_reg_loss: 123933.7458; val_edge_recon_loss: 2753099.5333; val_gene_expr_recon_loss: 20865833.2000; val_masked_gp_l1_reg_loss: 108663.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74970.5469; val_chrom_access_recon_loss: 21803904.8000; val_global_loss: 45730404.5333; val_optim_loss: 45730404.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9680; val_auprc_score: 0.9612; val_best_acc_score: 0.9136; val_best_f1_score: 0.9173; train_kl_reg_loss: 123127.2477; train_edge_recon_loss: 2749172.4198; train_gene_expr_recon_loss: 20716137.3588; train_masked_gp_l1_reg_loss: 109451.8088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73510.9104; train_chrom_access_recon_loss: 21453283.7252; train_global_loss: 45224683.4198; train_optim_loss: 45224683.4198; val_kl_reg_loss: 125069.9432; val_edge_recon_loss: 2762287.9167; val_gene_expr_recon_loss: 20840853.3333; val_masked_gp_l1_reg_loss: 110235.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72149.0234; val_chrom_access_recon_loss: 21769227.0667; val_global_loss: 45679823.4667; val_optim_loss: 45679823.4667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9691; val_auprc_score: 0.9620; val_best_acc_score: 0.9147; val_best_f1_score: 0.9168; train_kl_reg_loss: 120717.1660; train_edge_recon_loss: 2743439.9771; train_gene_expr_recon_loss: 20709546.3511; train_masked_gp_l1_reg_loss: 110921.3591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70648.8952; train_chrom_access_recon_loss: 21479224.2443; train_global_loss: 45234497.9847; train_optim_loss: 45234497.9847; val_kl_reg_loss: 120833.5849; val_edge_recon_loss: 2766480.0667; val_gene_expr_recon_loss: 20786147.8667; val_masked_gp_l1_reg_loss: 111761.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69317.3359; val_chrom_access_recon_loss: 21669507.0667; val_global_loss: 45524048.8000; val_optim_loss: 45524048.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9737; val_auprc_score: 0.9689; val_best_acc_score: 0.9208; val_best_f1_score: 0.9228; train_kl_reg_loss: 120336.5770; train_edge_recon_loss: 2744146.5153; train_gene_expr_recon_loss: 20663756.8092; train_masked_gp_l1_reg_loss: 112361.6867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68026.8412; train_chrom_access_recon_loss: 21421746.0305; train_global_loss: 45130374.6870; train_optim_loss: 45130374.6870; val_kl_reg_loss: 119422.8786; val_edge_recon_loss: 2758347.1333; val_gene_expr_recon_loss: 20781089.6000; val_masked_gp_l1_reg_loss: 112886.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66757.6719; val_chrom_access_recon_loss: 21634399.8667; val_global_loss: 45472903.4667; val_optim_loss: 45472903.4667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9740; val_auprc_score: 0.9678; val_best_acc_score: 0.9263; val_best_f1_score: 0.9288; train_kl_reg_loss: 119654.0063; train_edge_recon_loss: 2728116.2099; train_gene_expr_recon_loss: 20630843.6489; train_masked_gp_l1_reg_loss: 113591.8550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65546.1919; train_chrom_access_recon_loss: 21409420.3664; train_global_loss: 45067172.2748; train_optim_loss: 45067172.2748; val_kl_reg_loss: 120334.4141; val_edge_recon_loss: 2739991.8667; val_gene_expr_recon_loss: 20770587.7333; val_masked_gp_l1_reg_loss: 114335.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64365.8867; val_chrom_access_recon_loss: 21671187.8667; val_global_loss: 45480803.4667; val_optim_loss: 45480803.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9723; val_auprc_score: 0.9644; val_best_acc_score: 0.9201; val_best_f1_score: 0.9244; train_kl_reg_loss: 117960.7207; train_edge_recon_loss: 2727726.3893; train_gene_expr_recon_loss: 20620764.2901; train_masked_gp_l1_reg_loss: 114997.5723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63258.7457; train_chrom_access_recon_loss: 21392867.9389; train_global_loss: 45037575.7557; train_optim_loss: 45037575.7557; val_kl_reg_loss: 119546.7125; val_edge_recon_loss: 2755092.7000; val_gene_expr_recon_loss: 20700706.2667; val_masked_gp_l1_reg_loss: 115714.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62092.5312; val_chrom_access_recon_loss: 21733203.6000; val_global_loss: 45486354.9333; val_optim_loss: 45486354.9333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9300; val_auprc_score: 0.9085; val_best_acc_score: 0.8705; val_best_f1_score: 0.8789; train_kl_reg_loss: 139173.8597; train_edge_recon_loss: 2941837.7786; train_gene_expr_recon_loss: 24743174.4733; train_masked_gp_l1_reg_loss: 116936.6832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66849.7831; train_chrom_access_recon_loss: 22351529.6489; train_global_loss: 50359502.2290; train_optim_loss: 50359502.2290; val_kl_reg_loss: 15360.7749; val_edge_recon_loss: 2784589.6000; val_gene_expr_recon_loss: 25143962.9333; val_masked_gp_l1_reg_loss: 116143.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68161.0391; val_chrom_access_recon_loss: 22722648.0000; val_global_loss: 50850867.7333; val_optim_loss: 50850867.7333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9274; val_auprc_score: 0.9064; val_best_acc_score: 0.8642; val_best_f1_score: 0.8749; train_kl_reg_loss: 64671.0771; train_edge_recon_loss: 2769751.6393; train_gene_expr_recon_loss: 24723233.3435; train_masked_gp_l1_reg_loss: 112494.5830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66011.2923; train_chrom_access_recon_loss: 22336106.9924; train_global_loss: 50072268.9160; train_optim_loss: 50072268.9160; val_kl_reg_loss: 24587.1608; val_edge_recon_loss: 2768902.0000; val_gene_expr_recon_loss: 24594707.8667; val_masked_gp_l1_reg_loss: 108666.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63761.5352; val_chrom_access_recon_loss: 22660220.0000; val_global_loss: 50220844.8000; val_optim_loss: 50220844.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9325; val_auprc_score: 0.9120; val_best_acc_score: 0.8685; val_best_f1_score: 0.8772; train_kl_reg_loss: 52232.1876; train_edge_recon_loss: 2744656.3702; train_gene_expr_recon_loss: 24450710.0611; train_masked_gp_l1_reg_loss: 108019.3345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63486.5375; train_chrom_access_recon_loss: 22311601.2824; train_global_loss: 49730705.6183; train_optim_loss: 49730705.6183; val_kl_reg_loss: 25746.5763; val_edge_recon_loss: 2731770.9500; val_gene_expr_recon_loss: 24572831.4667; val_masked_gp_l1_reg_loss: 107604.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63230.1875; val_chrom_access_recon_loss: 22523030.0000; val_global_loss: 50024213.0667; val_optim_loss: 50024213.0667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9290; val_auprc_score: 0.9049; val_best_acc_score: 0.8689; val_best_f1_score: 0.8779; train_kl_reg_loss: 51260.7499; train_edge_recon_loss: 2736663.7233; train_gene_expr_recon_loss: 24423496.0305; train_masked_gp_l1_reg_loss: 107204.7149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62984.7296; train_chrom_access_recon_loss: 22316005.4656; train_global_loss: 49697615.4504; train_optim_loss: 49697615.4504; val_kl_reg_loss: 26690.3382; val_edge_recon_loss: 2751282.6500; val_gene_expr_recon_loss: 24512553.3333; val_masked_gp_l1_reg_loss: 106796.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62721.6172; val_chrom_access_recon_loss: 22515035.4667; val_global_loss: 49975080.0000; val_optim_loss: 49975080.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9296; val_auprc_score: 0.9049; val_best_acc_score: 0.8680; val_best_f1_score: 0.8773; train_kl_reg_loss: 50655.5890; train_edge_recon_loss: 2740165.7519; train_gene_expr_recon_loss: 24409231.8473; train_masked_gp_l1_reg_loss: 106381.0970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62459.4615; train_chrom_access_recon_loss: 22340849.2214; train_global_loss: 49709742.9008; train_optim_loss: 49709742.9008; val_kl_reg_loss: 27114.0173; val_edge_recon_loss: 2746151.6833; val_gene_expr_recon_loss: 24493005.6000; val_masked_gp_l1_reg_loss: 105950.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62188.0000; val_chrom_access_recon_loss: 22603750.6667; val_global_loss: 50038160.0000; val_optim_loss: 50038160.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9346; val_auprc_score: 0.9121; val_best_acc_score: 0.8791; val_best_f1_score: 0.8855; train_kl_reg_loss: 49332.9930; train_edge_recon_loss: 2732939.9084; train_gene_expr_recon_loss: 24345827.5267; train_masked_gp_l1_reg_loss: 105519.7715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61919.7130; train_chrom_access_recon_loss: 22281088.0305; train_global_loss: 49576627.9389; train_optim_loss: 49576627.9389; val_kl_reg_loss: 27427.1549; val_edge_recon_loss: 2732685.6833; val_gene_expr_recon_loss: 24357824.2667; val_masked_gp_l1_reg_loss: 105075.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61642.9492; val_chrom_access_recon_loss: 22441877.2000; val_global_loss: 49726532.5333; val_optim_loss: 49726532.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 53 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9733
val AUPRC score: 0.9668
val best accuracy score: 0.9237
val best F1 score: 0.9268
val target rna MSE score: 2.0294
val source rna MSE score: 132.1793
val target atac MSE score: 0.1317
val source atac MSE score: 1.1453
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
