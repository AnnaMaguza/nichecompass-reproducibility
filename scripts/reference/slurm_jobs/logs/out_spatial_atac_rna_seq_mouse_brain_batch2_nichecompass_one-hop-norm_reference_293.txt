[True]
Run timestamp: 07092023_071901_293.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_293']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2363 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5088, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2363
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2363

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7734; val_auprc_score: 0.7950; val_best_acc_score: 0.5158; val_best_f1_score: 0.6732; train_kl_reg_loss: 52430.3526; train_edge_recon_loss: 3558724.3588; train_gene_expr_recon_loss: 12795833.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 669019.4742; train_chrom_access_recon_loss: 10715596.1756; train_global_loss: 27791603.7405; train_optim_loss: 27791603.7405; val_kl_reg_loss: 70152.4062; val_edge_recon_loss: 4063906.9667; val_gene_expr_recon_loss: 11947354.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 373364.1250; val_chrom_access_recon_loss: 10164130.0667; val_global_loss: 26618908.4000; val_optim_loss: 26618908.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8229; val_auprc_score: 0.8339; val_best_acc_score: 0.6814; val_best_f1_score: 0.7440; train_kl_reg_loss: 79805.4177; train_edge_recon_loss: 3509504.2595; train_gene_expr_recon_loss: 11793652.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 230082.5574; train_chrom_access_recon_loss: 10234647.0534; train_global_loss: 25847691.4809; train_optim_loss: 25847691.4809; val_kl_reg_loss: 74558.0688; val_edge_recon_loss: 4052085.8000; val_gene_expr_recon_loss: 11665839.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139314.5156; val_chrom_access_recon_loss: 10022161.2667; val_global_loss: 25953959.7333; val_optim_loss: 25953959.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8799; val_auprc_score: 0.8723; val_best_acc_score: 0.7968; val_best_f1_score: 0.8118; train_kl_reg_loss: 64664.8065; train_edge_recon_loss: 3478631.6107; train_gene_expr_recon_loss: 11583214.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103566.1616; train_chrom_access_recon_loss: 10079767.4427; train_global_loss: 25309844.1069; train_optim_loss: 25309844.1069; val_kl_reg_loss: 46547.3458; val_edge_recon_loss: 3559474.9833; val_gene_expr_recon_loss: 11570533.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80896.8906; val_chrom_access_recon_loss: 9915402.4000; val_global_loss: 25172854.8000; val_optim_loss: 25172854.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8797; val_auprc_score: 0.8697; val_best_acc_score: 0.7906; val_best_f1_score: 0.8108; train_kl_reg_loss: 68848.2345; train_edge_recon_loss: 3057242.1107; train_gene_expr_recon_loss: 11441474.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68679.5190; train_chrom_access_recon_loss: 9968517.4885; train_global_loss: 24604761.9237; train_optim_loss: 24604761.9237; val_kl_reg_loss: 80293.1943; val_edge_recon_loss: 2941574.6000; val_gene_expr_recon_loss: 11414552.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58138.7578; val_chrom_access_recon_loss: 9806683.0667; val_global_loss: 24301242.6667; val_optim_loss: 24301242.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8906; val_auprc_score: 0.8796; val_best_acc_score: 0.7987; val_best_f1_score: 0.8166; train_kl_reg_loss: 81271.7524; train_edge_recon_loss: 2915941.2328; train_gene_expr_recon_loss: 11312682.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51264.8847; train_chrom_access_recon_loss: 9868299.4580; train_global_loss: 24229459.7099; train_optim_loss: 24229459.7099; val_kl_reg_loss: 76411.4323; val_edge_recon_loss: 2942255.2833; val_gene_expr_recon_loss: 11301885.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45887.0664; val_chrom_access_recon_loss: 9674425.8000; val_global_loss: 24040865.2000; val_optim_loss: 24040865.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9035; val_auprc_score: 0.8937; val_best_acc_score: 0.8108; val_best_f1_score: 0.8311; train_kl_reg_loss: 75532.5479; train_edge_recon_loss: 2888749.8874; train_gene_expr_recon_loss: 11204234.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42014.6529; train_chrom_access_recon_loss: 9773610.9160; train_global_loss: 23984142.7328; train_optim_loss: 23984142.7328; val_kl_reg_loss: 71038.9583; val_edge_recon_loss: 2874901.3333; val_gene_expr_recon_loss: 11188780.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39078.1562; val_chrom_access_recon_loss: 9585286.0000; val_global_loss: 23759085.0667; val_optim_loss: 23759085.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9175; val_auprc_score: 0.9039; val_best_acc_score: 0.8374; val_best_f1_score: 0.8480; train_kl_reg_loss: 74207.8414; train_edge_recon_loss: 2824536.2405; train_gene_expr_recon_loss: 11108097.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37027.5012; train_chrom_access_recon_loss: 9688676.4427; train_global_loss: 23732545.5573; train_optim_loss: 23732545.5573; val_kl_reg_loss: 70176.3286; val_edge_recon_loss: 2821859.2000; val_gene_expr_recon_loss: 11087625.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35196.5977; val_chrom_access_recon_loss: 9542122.0667; val_global_loss: 23556980.6667; val_optim_loss: 23556980.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9346; val_auprc_score: 0.9190; val_best_acc_score: 0.8678; val_best_f1_score: 0.8744; train_kl_reg_loss: 72484.9748; train_edge_recon_loss: 2788947.3282; train_gene_expr_recon_loss: 11029647.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34223.7271; train_chrom_access_recon_loss: 9614991.0153; train_global_loss: 23540294.7786; train_optim_loss: 23540294.7786; val_kl_reg_loss: 70735.8505; val_edge_recon_loss: 2801914.1000; val_gene_expr_recon_loss: 11065257.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33389.5078; val_chrom_access_recon_loss: 9491496.2667; val_global_loss: 23462793.7333; val_optim_loss: 23462793.7333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9412; val_auprc_score: 0.9257; val_best_acc_score: 0.8797; val_best_f1_score: 0.8853; train_kl_reg_loss: 73528.5938; train_edge_recon_loss: 2753082.0496; train_gene_expr_recon_loss: 10963062.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32609.9474; train_chrom_access_recon_loss: 9554518.0534; train_global_loss: 23376801.1450; train_optim_loss: 23376801.1450; val_kl_reg_loss: 72457.3891; val_edge_recon_loss: 2756159.9667; val_gene_expr_recon_loss: 10995295.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31941.5371; val_chrom_access_recon_loss: 9414382.4667; val_global_loss: 23270238.0000; val_optim_loss: 23270238.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9456; val_auprc_score: 0.9323; val_best_acc_score: 0.8806; val_best_f1_score: 0.8884; train_kl_reg_loss: 73097.7817; train_edge_recon_loss: 2740673.4676; train_gene_expr_recon_loss: 10897900.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31460.7117; train_chrom_access_recon_loss: 9496011.8702; train_global_loss: 23239144.2137; train_optim_loss: 23239144.2137; val_kl_reg_loss: 69427.7094; val_edge_recon_loss: 2747973.6667; val_gene_expr_recon_loss: 10861017.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31117.1934; val_chrom_access_recon_loss: 9319413.2667; val_global_loss: 23028948.9333; val_optim_loss: 23028948.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9527; val_auprc_score: 0.9418; val_best_acc_score: 0.8890; val_best_f1_score: 0.8952; train_kl_reg_loss: 71459.7263; train_edge_recon_loss: 2738293.3034; train_gene_expr_recon_loss: 10843697.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30609.2944; train_chrom_access_recon_loss: 9443519.8702; train_global_loss: 23127580.0458; train_optim_loss: 23127580.0458; val_kl_reg_loss: 68251.9135; val_edge_recon_loss: 2742830.5833; val_gene_expr_recon_loss: 10839870.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30211.7520; val_chrom_access_recon_loss: 9285016.6000; val_global_loss: 22966181.4667; val_optim_loss: 22966181.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9514; val_auprc_score: 0.9406; val_best_acc_score: 0.8897; val_best_f1_score: 0.8955; train_kl_reg_loss: 69440.4803; train_edge_recon_loss: 2725973.2977; train_gene_expr_recon_loss: 10792352.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29907.7605; train_chrom_access_recon_loss: 9403237.3893; train_global_loss: 23020911.7710; train_optim_loss: 23020911.7710; val_kl_reg_loss: 69215.0979; val_edge_recon_loss: 2729873.6500; val_gene_expr_recon_loss: 10812374.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29495.0645; val_chrom_access_recon_loss: 9269005.9333; val_global_loss: 22909964.2667; val_optim_loss: 22909964.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9501; val_auprc_score: 0.9362; val_best_acc_score: 0.8851; val_best_f1_score: 0.8914; train_kl_reg_loss: 67679.4889; train_edge_recon_loss: 2711339.3053; train_gene_expr_recon_loss: 10748583.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29269.7014; train_chrom_access_recon_loss: 9356568.4427; train_global_loss: 22913439.8626; train_optim_loss: 22913439.8626; val_kl_reg_loss: 64952.0388; val_edge_recon_loss: 2736307.3833; val_gene_expr_recon_loss: 10734666.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29091.5898; val_chrom_access_recon_loss: 9185064.1667; val_global_loss: 22750082.1333; val_optim_loss: 22750082.1333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9538; val_auprc_score: 0.9405; val_best_acc_score: 0.8971; val_best_f1_score: 0.9028; train_kl_reg_loss: 65995.9353; train_edge_recon_loss: 2713156.5496; train_gene_expr_recon_loss: 10704167.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28903.1879; train_chrom_access_recon_loss: 9311623.2366; train_global_loss: 22823846.7023; train_optim_loss: 22823846.7023; val_kl_reg_loss: 67461.6615; val_edge_recon_loss: 2700345.8000; val_gene_expr_recon_loss: 10674933.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28607.3789; val_chrom_access_recon_loss: 9184276.2667; val_global_loss: 22655624.8000; val_optim_loss: 22655624.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9524; val_auprc_score: 0.9377; val_best_acc_score: 0.8954; val_best_f1_score: 0.9009; train_kl_reg_loss: 65324.7852; train_edge_recon_loss: 2702210.3435; train_gene_expr_recon_loss: 10660511.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28386.4519; train_chrom_access_recon_loss: 9270035.2137; train_global_loss: 22726468.0305; train_optim_loss: 22726468.0305; val_kl_reg_loss: 62267.8378; val_edge_recon_loss: 2713174.0000; val_gene_expr_recon_loss: 10684126.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28505.8926; val_chrom_access_recon_loss: 9156236.9000; val_global_loss: 22644311.4667; val_optim_loss: 22644311.4667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9573; val_auprc_score: 0.9447; val_best_acc_score: 0.8988; val_best_f1_score: 0.9034; train_kl_reg_loss: 62998.5370; train_edge_recon_loss: 2697304.9637; train_gene_expr_recon_loss: 10627276.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28199.2981; train_chrom_access_recon_loss: 9235826.1450; train_global_loss: 22651605.8321; train_optim_loss: 22651605.8321; val_kl_reg_loss: 61872.0437; val_edge_recon_loss: 2706665.3333; val_gene_expr_recon_loss: 10656151.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28100.8184; val_chrom_access_recon_loss: 9127241.8667; val_global_loss: 22580031.7333; val_optim_loss: 22580031.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9584; val_auprc_score: 0.9458; val_best_acc_score: 0.9058; val_best_f1_score: 0.9106; train_kl_reg_loss: 61048.7882; train_edge_recon_loss: 2699265.2615; train_gene_expr_recon_loss: 10591783.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28010.9296; train_chrom_access_recon_loss: 9202913.5725; train_global_loss: 22583022.1221; train_optim_loss: 22583022.1221; val_kl_reg_loss: 59767.9685; val_edge_recon_loss: 2692769.8500; val_gene_expr_recon_loss: 10595212.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28072.6992; val_chrom_access_recon_loss: 9075824.0000; val_global_loss: 22451647.3333; val_optim_loss: 22451647.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9632; val_auprc_score: 0.9532; val_best_acc_score: 0.9066; val_best_f1_score: 0.9119; train_kl_reg_loss: 60394.0345; train_edge_recon_loss: 2680197.3130; train_gene_expr_recon_loss: 10562037.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27847.6298; train_chrom_access_recon_loss: 9172285.4275; train_global_loss: 22502761.9542; train_optim_loss: 22502761.9542; val_kl_reg_loss: 59270.9719; val_edge_recon_loss: 2683077.4500; val_gene_expr_recon_loss: 10608313.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27668.0020; val_chrom_access_recon_loss: 9020428.8667; val_global_loss: 22398758.5333; val_optim_loss: 22398758.5333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9585; val_auprc_score: 0.9451; val_best_acc_score: 0.9046; val_best_f1_score: 0.9088; train_kl_reg_loss: 58585.1160; train_edge_recon_loss: 2682825.6546; train_gene_expr_recon_loss: 10534252.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27651.7441; train_chrom_access_recon_loss: 9143087.8206; train_global_loss: 22446403.2214; train_optim_loss: 22446403.2214; val_kl_reg_loss: 58654.7505; val_edge_recon_loss: 2690063.8500; val_gene_expr_recon_loss: 10577933.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27649.5215; val_chrom_access_recon_loss: 9043124.3333; val_global_loss: 22397426.8000; val_optim_loss: 22397426.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9664; val_auprc_score: 0.9578; val_best_acc_score: 0.9126; val_best_f1_score: 0.9160; train_kl_reg_loss: 57948.2822; train_edge_recon_loss: 2685840.5363; train_gene_expr_recon_loss: 10511718.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27595.6384; train_chrom_access_recon_loss: 9112812.0611; train_global_loss: 22395915.3435; train_optim_loss: 22395915.3435; val_kl_reg_loss: 56407.1448; val_edge_recon_loss: 2680833.3333; val_gene_expr_recon_loss: 10536629.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27578.7656; val_chrom_access_recon_loss: 9022442.5333; val_global_loss: 22323891.4667; val_optim_loss: 22323891.4667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9686; val_auprc_score: 0.9556; val_best_acc_score: 0.9147; val_best_f1_score: 0.9192; train_kl_reg_loss: 56703.1604; train_edge_recon_loss: 2678548.6889; train_gene_expr_recon_loss: 10491154.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27495.3950; train_chrom_access_recon_loss: 9099453.8931; train_global_loss: 22353355.4504; train_optim_loss: 22353355.4504; val_kl_reg_loss: 55563.4544; val_edge_recon_loss: 2670242.4667; val_gene_expr_recon_loss: 10518917.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27474.0176; val_chrom_access_recon_loss: 8962440.6000; val_global_loss: 22234638.2667; val_optim_loss: 22234638.2667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9684; val_auprc_score: 0.9571; val_best_acc_score: 0.9190; val_best_f1_score: 0.9215; train_kl_reg_loss: 55358.2432; train_edge_recon_loss: 2675215.2863; train_gene_expr_recon_loss: 10470038.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27548.7142; train_chrom_access_recon_loss: 9073114.2176; train_global_loss: 22301274.6260; train_optim_loss: 22301274.6260; val_kl_reg_loss: 53787.2409; val_edge_recon_loss: 2665777.5667; val_gene_expr_recon_loss: 10503302.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27511.6484; val_chrom_access_recon_loss: 8985800.2000; val_global_loss: 22236179.2000; val_optim_loss: 22236179.2000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9687; val_auprc_score: 0.9602; val_best_acc_score: 0.9138; val_best_f1_score: 0.9175; train_kl_reg_loss: 55081.3833; train_edge_recon_loss: 2669316.1698; train_gene_expr_recon_loss: 10451251.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27509.9532; train_chrom_access_recon_loss: 9055374.5878; train_global_loss: 22258533.4046; train_optim_loss: 22258533.4046; val_kl_reg_loss: 54708.2182; val_edge_recon_loss: 2672720.3333; val_gene_expr_recon_loss: 10514521.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27828.5312; val_chrom_access_recon_loss: 8944512.0667; val_global_loss: 22214291.0667; val_optim_loss: 22214291.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9683; val_auprc_score: 0.9580; val_best_acc_score: 0.9144; val_best_f1_score: 0.9188; train_kl_reg_loss: 54766.3966; train_edge_recon_loss: 2669483.8702; train_gene_expr_recon_loss: 10434276.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27670.1914; train_chrom_access_recon_loss: 9031332.4962; train_global_loss: 22217529.0992; train_optim_loss: 22217529.0992; val_kl_reg_loss: 53909.2508; val_edge_recon_loss: 2693425.4167; val_gene_expr_recon_loss: 10498893.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27475.0449; val_chrom_access_recon_loss: 8942954.4667; val_global_loss: 22216657.8667; val_optim_loss: 22216657.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9646; val_auprc_score: 0.9533; val_best_acc_score: 0.9112; val_best_f1_score: 0.9150; train_kl_reg_loss: 54150.0349; train_edge_recon_loss: 2668414.0821; train_gene_expr_recon_loss: 10416179.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27582.8917; train_chrom_access_recon_loss: 9011637.4809; train_global_loss: 22177964.2901; train_optim_loss: 22177964.2901; val_kl_reg_loss: 54168.9430; val_edge_recon_loss: 2691574.6667; val_gene_expr_recon_loss: 10446301.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27701.4883; val_chrom_access_recon_loss: 8911536.9333; val_global_loss: 22131283.7333; val_optim_loss: 22131283.7333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9671; val_auprc_score: 0.9556; val_best_acc_score: 0.9134; val_best_f1_score: 0.9157; train_kl_reg_loss: 68548.7451; train_edge_recon_loss: 2737600.2462; train_gene_expr_recon_loss: 9573226.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23929.2172; train_chrom_access_recon_loss: 8348181.1489; train_global_loss: 20751485.7099; train_optim_loss: 20751485.7099; val_kl_reg_loss: 21030.2966; val_edge_recon_loss: 2728755.2000; val_gene_expr_recon_loss: 9172892.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23279.4395; val_chrom_access_recon_loss: 7872562.9333; val_global_loss: 19818519.7333; val_optim_loss: 19818519.7333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9689; val_auprc_score: 0.9611; val_best_acc_score: 0.9138; val_best_f1_score: 0.9164; train_kl_reg_loss: 71012.4479; train_edge_recon_loss: 2717328.5248; train_gene_expr_recon_loss: 8874456.8206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23243.4728; train_chrom_access_recon_loss: 7717355.9008; train_global_loss: 19403397.1908; train_optim_loss: 19403397.1908; val_kl_reg_loss: 17923.1427; val_edge_recon_loss: 2715086.0833; val_gene_expr_recon_loss: 8585630.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23315.2305; val_chrom_access_recon_loss: 7314479.4667; val_global_loss: 18656433.8667; val_optim_loss: 18656433.8667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9550; val_auprc_score: 0.9428; val_best_acc_score: 0.8995; val_best_f1_score: 0.9046; train_kl_reg_loss: 68210.9262; train_edge_recon_loss: 2724776.1317; train_gene_expr_recon_loss: 7747351.7290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23458.3617; train_chrom_access_recon_loss: 6649848.9733; train_global_loss: 17213646.0611; train_optim_loss: 17213646.0611; val_kl_reg_loss: 17382.4647; val_edge_recon_loss: 2719356.3500; val_gene_expr_recon_loss: 7387012.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23760.3574; val_chrom_access_recon_loss: 6199705.2667; val_global_loss: 16347216.2000; val_optim_loss: 16347216.2000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9583; val_auprc_score: 0.9461; val_best_acc_score: 0.9010; val_best_f1_score: 0.9054; train_kl_reg_loss: 52378.8692; train_edge_recon_loss: 2704589.9351; train_gene_expr_recon_loss: 7152253.6832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23768.1827; train_chrom_access_recon_loss: 6052190.9389; train_global_loss: 15985181.5649; train_optim_loss: 15985181.5649; val_kl_reg_loss: 19915.8516; val_edge_recon_loss: 2708447.5833; val_gene_expr_recon_loss: 6975861.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23590.4434; val_chrom_access_recon_loss: 5799706.2000; val_global_loss: 15527520.7333; val_optim_loss: 15527520.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9592; val_auprc_score: 0.9456; val_best_acc_score: 0.9065; val_best_f1_score: 0.9099; train_kl_reg_loss: 48906.9430; train_edge_recon_loss: 2689354.7176; train_gene_expr_recon_loss: 6639978.8130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23316.0315; train_chrom_access_recon_loss: 5534756.7023; train_global_loss: 14936313.2595; train_optim_loss: 14936313.2595; val_kl_reg_loss: 22498.5988; val_edge_recon_loss: 2679578.2500; val_gene_expr_recon_loss: 6497148.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23145.2383; val_chrom_access_recon_loss: 5336189.7000; val_global_loss: 14558559.8667; val_optim_loss: 14558559.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9549; val_auprc_score: 0.9425; val_best_acc_score: 0.8973; val_best_f1_score: 0.9030; train_kl_reg_loss: 44390.2937; train_edge_recon_loss: 2685100.4408; train_gene_expr_recon_loss: 6478577.3550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22948.9517; train_chrom_access_recon_loss: 5388679.2672; train_global_loss: 14619696.2214; train_optim_loss: 14619696.2214; val_kl_reg_loss: 24146.5503; val_edge_recon_loss: 2705704.8167; val_gene_expr_recon_loss: 6474387.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22842.3164; val_chrom_access_recon_loss: 5319235.1333; val_global_loss: 14546315.7333; val_optim_loss: 14546315.7333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9582; val_auprc_score: 0.9429; val_best_acc_score: 0.9054; val_best_f1_score: 0.9095; train_kl_reg_loss: 41459.8752; train_edge_recon_loss: 2678037.8721; train_gene_expr_recon_loss: 6458018.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22819.1127; train_chrom_access_recon_loss: 5362707.1679; train_global_loss: 14563042.8473; train_optim_loss: 14563042.8473; val_kl_reg_loss: 27130.0570; val_edge_recon_loss: 2701965.7167; val_gene_expr_recon_loss: 6453773.3667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22783.1270; val_chrom_access_recon_loss: 5306115.7667; val_global_loss: 14511767.7333; val_optim_loss: 14511767.7333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9569; val_auprc_score: 0.9416; val_best_acc_score: 0.9014; val_best_f1_score: 0.9060; train_kl_reg_loss: 38464.9759; train_edge_recon_loss: 2686934.6870; train_gene_expr_recon_loss: 6430453.2939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22842.8886; train_chrom_access_recon_loss: 5341782.9389; train_global_loss: 14520478.7710; train_optim_loss: 14520478.7710; val_kl_reg_loss: 26748.6056; val_edge_recon_loss: 2696319.6500; val_gene_expr_recon_loss: 6430997.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22999.7441; val_chrom_access_recon_loss: 5274454.7000; val_global_loss: 14451520.6000; val_optim_loss: 14451520.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9624; val_auprc_score: 0.9483; val_best_acc_score: 0.9086; val_best_f1_score: 0.9139; train_kl_reg_loss: 37914.0044; train_edge_recon_loss: 2669962.6546; train_gene_expr_recon_loss: 6412642.5229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22958.4706; train_chrom_access_recon_loss: 5324840.3321; train_global_loss: 14468317.9160; train_optim_loss: 14468317.9160; val_kl_reg_loss: 27524.1503; val_edge_recon_loss: 2672459.6833; val_gene_expr_recon_loss: 6417155.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22941.2715; val_chrom_access_recon_loss: 5262900.0333; val_global_loss: 14402980.6000; val_optim_loss: 14402980.6000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9556; val_auprc_score: 0.9386; val_best_acc_score: 0.9057; val_best_f1_score: 0.9115; train_kl_reg_loss: 36385.0083; train_edge_recon_loss: 2671823.0210; train_gene_expr_recon_loss: 6367673.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22944.8133; train_chrom_access_recon_loss: 5259028.4504; train_global_loss: 14357855.0611; train_optim_loss: 14357855.0611; val_kl_reg_loss: 29019.9922; val_edge_recon_loss: 2680834.8167; val_gene_expr_recon_loss: 6355837.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22957.2422; val_chrom_access_recon_loss: 5156821.1333; val_global_loss: 14245470.0667; val_optim_loss: 14245470.0667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9541; val_auprc_score: 0.9364; val_best_acc_score: 0.9038; val_best_f1_score: 0.9082; train_kl_reg_loss: 35850.6637; train_edge_recon_loss: 2669454.1069; train_gene_expr_recon_loss: 6322929.5076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22952.0705; train_chrom_access_recon_loss: 5200954.4885; train_global_loss: 14252140.7939; train_optim_loss: 14252140.7939; val_kl_reg_loss: 25644.7565; val_edge_recon_loss: 2707530.4000; val_gene_expr_recon_loss: 6329054.5667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22977.5430; val_chrom_access_recon_loss: 5127635.8000; val_global_loss: 14212843.7333; val_optim_loss: 14212843.7333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9594; val_auprc_score: 0.9452; val_best_acc_score: 0.9053; val_best_f1_score: 0.9107; train_kl_reg_loss: 35937.3388; train_edge_recon_loss: 2669652.8492; train_gene_expr_recon_loss: 6280582.6832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22941.2673; train_chrom_access_recon_loss: 5167791.8282; train_global_loss: 14176905.9618; train_optim_loss: 14176905.9618; val_kl_reg_loss: 25323.0931; val_edge_recon_loss: 2677765.3167; val_gene_expr_recon_loss: 6266726.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22954.6172; val_chrom_access_recon_loss: 5098666.7667; val_global_loss: 14091436.6000; val_optim_loss: 14091436.6000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9592; val_auprc_score: 0.9449; val_best_acc_score: 0.9076; val_best_f1_score: 0.9127; train_kl_reg_loss: 35193.7204; train_edge_recon_loss: 2668254.2824; train_gene_expr_recon_loss: 6268337.2405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23013.7142; train_chrom_access_recon_loss: 5158252.8969; train_global_loss: 14153051.9160; train_optim_loss: 14153051.9160; val_kl_reg_loss: 27509.0117; val_edge_recon_loss: 2669342.7333; val_gene_expr_recon_loss: 6284399.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23052.4727; val_chrom_access_recon_loss: 5091056.6667; val_global_loss: 14095359.8667; val_optim_loss: 14095359.8667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9600; val_auprc_score: 0.9451; val_best_acc_score: 0.9030; val_best_f1_score: 0.9080; train_kl_reg_loss: 35403.5247; train_edge_recon_loss: 2668581.2462; train_gene_expr_recon_loss: 6266803.8053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23149.5080; train_chrom_access_recon_loss: 5155880.7290; train_global_loss: 14149818.8397; train_optim_loss: 14149818.8397; val_kl_reg_loss: 27101.6529; val_edge_recon_loss: 2690698.4333; val_gene_expr_recon_loss: 6280859.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23275.7051; val_chrom_access_recon_loss: 5118418.2333; val_global_loss: 14140353.8667; val_optim_loss: 14140353.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9573; val_auprc_score: 0.9415; val_best_acc_score: 0.9074; val_best_f1_score: 0.9119; train_kl_reg_loss: 35165.7781; train_edge_recon_loss: 2670639.2729; train_gene_expr_recon_loss: 6260471.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23239.7712; train_chrom_access_recon_loss: 5153255.3817; train_global_loss: 14142772.0458; train_optim_loss: 14142772.0458; val_kl_reg_loss: 28496.3621; val_edge_recon_loss: 2681662.7500; val_gene_expr_recon_loss: 6279408.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23312.5020; val_chrom_access_recon_loss: 5098037.7333; val_global_loss: 14110918.7333; val_optim_loss: 14110918.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9622; val_auprc_score: 0.9468; val_best_acc_score: 0.9108; val_best_f1_score: 0.9157; train_kl_reg_loss: 34435.6525; train_edge_recon_loss: 2669766.7691; train_gene_expr_recon_loss: 6252951.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23262.1953; train_chrom_access_recon_loss: 5146063.9275; train_global_loss: 14126480.2061; train_optim_loss: 14126480.2061; val_kl_reg_loss: 27970.0454; val_edge_recon_loss: 2658960.7667; val_gene_expr_recon_loss: 6208701.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23288.4902; val_chrom_access_recon_loss: 5027541.1667; val_global_loss: 13946461.4000; val_optim_loss: 13946461.4000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9607; val_auprc_score: 0.9474; val_best_acc_score: 0.9068; val_best_f1_score: 0.9111; train_kl_reg_loss: 33011.3436; train_edge_recon_loss: 2665160.9351; train_gene_expr_recon_loss: 6205863.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23343.9877; train_chrom_access_recon_loss: 5099217.5076; train_global_loss: 14026596.9695; train_optim_loss: 14026596.9695; val_kl_reg_loss: 27637.0376; val_edge_recon_loss: 2696416.3833; val_gene_expr_recon_loss: 6229755.0333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23367.4570; val_chrom_access_recon_loss: 5055719.6000; val_global_loss: 14032895.1333; val_optim_loss: 14032895.1333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9610; val_auprc_score: 0.9475; val_best_acc_score: 0.9091; val_best_f1_score: 0.9138; train_kl_reg_loss: 32601.2680; train_edge_recon_loss: 2660412.2748; train_gene_expr_recon_loss: 6198365.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23452.2493; train_chrom_access_recon_loss: 5091691.3397; train_global_loss: 14006522.5649; train_optim_loss: 14006522.5649; val_kl_reg_loss: 28621.7758; val_edge_recon_loss: 2668535.3833; val_gene_expr_recon_loss: 6198866.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23451.7129; val_chrom_access_recon_loss: 5042246.4000; val_global_loss: 13961722.0667; val_optim_loss: 13961722.0667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9638; val_auprc_score: 0.9526; val_best_acc_score: 0.9113; val_best_f1_score: 0.9163; train_kl_reg_loss: 32574.1818; train_edge_recon_loss: 2660589.8378; train_gene_expr_recon_loss: 6197528.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23505.5731; train_chrom_access_recon_loss: 5089583.3092; train_global_loss: 14003781.6260; train_optim_loss: 14003781.6260; val_kl_reg_loss: 28186.5737; val_edge_recon_loss: 2665285.9000; val_gene_expr_recon_loss: 6208605.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23621.4023; val_chrom_access_recon_loss: 5031158.2667; val_global_loss: 13956857.5333; val_optim_loss: 13956857.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9623; val_auprc_score: 0.9495; val_best_acc_score: 0.9109; val_best_f1_score: 0.9150; train_kl_reg_loss: 31802.7951; train_edge_recon_loss: 2669184.7004; train_gene_expr_recon_loss: 6192056.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23611.7508; train_chrom_access_recon_loss: 5085255.7557; train_global_loss: 14001911.4809; train_optim_loss: 14001911.4809; val_kl_reg_loss: 26833.1777; val_edge_recon_loss: 2666069.3000; val_gene_expr_recon_loss: 6198697.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23647.0430; val_chrom_access_recon_loss: 5034214.9333; val_global_loss: 13949462.1333; val_optim_loss: 13949462.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9579; val_auprc_score: 0.9403; val_best_acc_score: 0.9074; val_best_f1_score: 0.9120; train_kl_reg_loss: 31180.0023; train_edge_recon_loss: 2651982.4065; train_gene_expr_recon_loss: 6187865.1183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21751.3040; train_chrom_access_recon_loss: 5084668.2557; train_global_loss: 13977447.0382; train_optim_loss: 13977447.0382; val_kl_reg_loss: 27689.2747; val_edge_recon_loss: 2688969.3500; val_gene_expr_recon_loss: 6206063.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21524.9785; val_chrom_access_recon_loss: 5031782.3667; val_global_loss: 13976029.2000; val_optim_loss: 13976029.2000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9629; val_auprc_score: 0.9491; val_best_acc_score: 0.9128; val_best_f1_score: 0.9166; train_kl_reg_loss: 31718.0126; train_edge_recon_loss: 2665680.6355; train_gene_expr_recon_loss: 6186031.6374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21472.5125; train_chrom_access_recon_loss: 5085845.6641; train_global_loss: 13990748.4885; train_optim_loss: 13990748.4885; val_kl_reg_loss: 28521.2007; val_edge_recon_loss: 2661241.4833; val_gene_expr_recon_loss: 6182115.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21425.2168; val_chrom_access_recon_loss: 5005599.0667; val_global_loss: 13898902.4000; val_optim_loss: 13898902.4000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9623; val_auprc_score: 0.9490; val_best_acc_score: 0.9100; val_best_f1_score: 0.9144; train_kl_reg_loss: 31700.1560; train_edge_recon_loss: 2655462.3378; train_gene_expr_recon_loss: 6181704.5076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21394.0079; train_chrom_access_recon_loss: 5078863.1450; train_global_loss: 13969124.1221; train_optim_loss: 13969124.1221; val_kl_reg_loss: 27985.4411; val_edge_recon_loss: 2683237.9667; val_gene_expr_recon_loss: 6181496.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21354.7949; val_chrom_access_recon_loss: 5012788.0333; val_global_loss: 13926862.9333; val_optim_loss: 13926862.9333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9641; val_auprc_score: 0.9510; val_best_acc_score: 0.9155; val_best_f1_score: 0.9193; train_kl_reg_loss: 31705.5574; train_edge_recon_loss: 2658909.4733; train_gene_expr_recon_loss: 6183141.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21333.3602; train_chrom_access_recon_loss: 5082627.8855; train_global_loss: 13977718.1908; train_optim_loss: 13977718.1908; val_kl_reg_loss: 28021.6068; val_edge_recon_loss: 2642781.7500; val_gene_expr_recon_loss: 6192249.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21297.5195; val_chrom_access_recon_loss: 5029026.3000; val_global_loss: 13913376.6000; val_optim_loss: 13913376.6000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9625; val_auprc_score: 0.9505; val_best_acc_score: 0.9162; val_best_f1_score: 0.9198; train_kl_reg_loss: 31853.0417; train_edge_recon_loss: 2659317.2901; train_gene_expr_recon_loss: 6183662.3092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21278.4778; train_chrom_access_recon_loss: 5084076.3626; train_global_loss: 13980187.3969; train_optim_loss: 13980187.3969; val_kl_reg_loss: 28182.3332; val_edge_recon_loss: 2654635.0000; val_gene_expr_recon_loss: 6194288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21250.8047; val_chrom_access_recon_loss: 5022996.9333; val_global_loss: 13921353.2667; val_optim_loss: 13921353.2667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9651; val_auprc_score: 0.9539; val_best_acc_score: 0.9170; val_best_f1_score: 0.9207; train_kl_reg_loss: 31874.6111; train_edge_recon_loss: 2662340.8435; train_gene_expr_recon_loss: 6190650.1794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21233.2180; train_chrom_access_recon_loss: 5085765.4542; train_global_loss: 13991864.3282; train_optim_loss: 13991864.3282; val_kl_reg_loss: 28280.4527; val_edge_recon_loss: 2657131.6333; val_gene_expr_recon_loss: 6187639.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21208.7988; val_chrom_access_recon_loss: 5025877.9667; val_global_loss: 13920138.4000; val_optim_loss: 13920138.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9658; val_auprc_score: 0.9554; val_best_acc_score: 0.9157; val_best_f1_score: 0.9192; train_kl_reg_loss: 31874.3241; train_edge_recon_loss: 2660261.6603; train_gene_expr_recon_loss: 6182758.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21012.0238; train_chrom_access_recon_loss: 5080758.1336; train_global_loss: 13976664.6565; train_optim_loss: 13976664.6565; val_kl_reg_loss: 28451.9387; val_edge_recon_loss: 2665671.7833; val_gene_expr_recon_loss: 6183357.4333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20990.9570; val_chrom_access_recon_loss: 5023681.0000; val_global_loss: 13922153.2000; val_optim_loss: 13922153.2000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9631; val_auprc_score: 0.9498; val_best_acc_score: 0.9155; val_best_f1_score: 0.9183; train_kl_reg_loss: 31879.1988; train_edge_recon_loss: 2660024.3282; train_gene_expr_recon_loss: 6180932.1412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20986.1248; train_chrom_access_recon_loss: 5080050.3473; train_global_loss: 13973872.1756; train_optim_loss: 13973872.1756; val_kl_reg_loss: 28397.8091; val_edge_recon_loss: 2653454.5167; val_gene_expr_recon_loss: 6164225.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20981.3262; val_chrom_access_recon_loss: 5010000.0333; val_global_loss: 13877059.1333; val_optim_loss: 13877059.1333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9631; val_auprc_score: 0.9518; val_best_acc_score: 0.9132; val_best_f1_score: 0.9173; train_kl_reg_loss: 31780.5121; train_edge_recon_loss: 2659234.2977; train_gene_expr_recon_loss: 6184683.5611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20977.1160; train_chrom_access_recon_loss: 5084997.6527; train_global_loss: 13981673.1756; train_optim_loss: 13981673.1756; val_kl_reg_loss: 28392.2220; val_edge_recon_loss: 2673544.8667; val_gene_expr_recon_loss: 6192046.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20972.8867; val_chrom_access_recon_loss: 5025805.0667; val_global_loss: 13940761.2667; val_optim_loss: 13940761.2667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9641; val_auprc_score: 0.9516; val_best_acc_score: 0.9150; val_best_f1_score: 0.9187; train_kl_reg_loss: 31800.7945; train_edge_recon_loss: 2652247.1775; train_gene_expr_recon_loss: 6182622.8206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20969.4667; train_chrom_access_recon_loss: 5078328.4351; train_global_loss: 13965968.7176; train_optim_loss: 13965968.7176; val_kl_reg_loss: 28295.3668; val_edge_recon_loss: 2670558.5500; val_gene_expr_recon_loss: 6196510.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20965.9648; val_chrom_access_recon_loss: 5026056.0333; val_global_loss: 13942386.5333; val_optim_loss: 13942386.5333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9647; val_auprc_score: 0.9526; val_best_acc_score: 0.9153; val_best_f1_score: 0.9191; train_kl_reg_loss: 31743.0300; train_edge_recon_loss: 2655496.6966; train_gene_expr_recon_loss: 6181065.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20962.2564; train_chrom_access_recon_loss: 5083171.1260; train_global_loss: 13972438.2290; train_optim_loss: 13972438.2290; val_kl_reg_loss: 28221.5022; val_edge_recon_loss: 2664906.7500; val_gene_expr_recon_loss: 6200377.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20959.3809; val_chrom_access_recon_loss: 5017754.0000; val_global_loss: 13932219.0667; val_optim_loss: 13932219.0667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9622; val_auprc_score: 0.9426; val_best_acc_score: 0.9169; val_best_f1_score: 0.9203; train_kl_reg_loss: 31754.1566; train_edge_recon_loss: 2655191.4695; train_gene_expr_recon_loss: 6184645.6527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20956.3160; train_chrom_access_recon_loss: 5079009.6336; train_global_loss: 13971557.2061; train_optim_loss: 13971557.2061; val_kl_reg_loss: 28531.7895; val_edge_recon_loss: 2644828.0333; val_gene_expr_recon_loss: 6186620.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20953.2656; val_chrom_access_recon_loss: 5018033.1333; val_global_loss: 13898966.4667; val_optim_loss: 13898966.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9582; val_auprc_score: 0.9414; val_best_acc_score: 0.9062; val_best_f1_score: 0.9121; train_kl_reg_loss: 31769.2787; train_edge_recon_loss: 2655751.3034; train_gene_expr_recon_loss: 6178583.3244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20933.2486; train_chrom_access_recon_loss: 5077517.4084; train_global_loss: 13964554.5115; train_optim_loss: 13964554.5115; val_kl_reg_loss: 28332.7707; val_edge_recon_loss: 2701202.6167; val_gene_expr_recon_loss: 6199826.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20931.0645; val_chrom_access_recon_loss: 5011647.7333; val_global_loss: 13961940.4000; val_optim_loss: 13961940.4000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9613; val_auprc_score: 0.9417; val_best_acc_score: 0.9163; val_best_f1_score: 0.9200; train_kl_reg_loss: 31753.8251; train_edge_recon_loss: 2660055.2233; train_gene_expr_recon_loss: 6181583.9122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20930.5233; train_chrom_access_recon_loss: 5084913.1145; train_global_loss: 13979236.5802; train_optim_loss: 13979236.5802; val_kl_reg_loss: 28344.0380; val_edge_recon_loss: 2656977.8500; val_gene_expr_recon_loss: 6206933.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20930.0820; val_chrom_access_recon_loss: 5020050.6000; val_global_loss: 13933235.6000; val_optim_loss: 13933235.6000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9613; val_auprc_score: 0.9451; val_best_acc_score: 0.9140; val_best_f1_score: 0.9179; train_kl_reg_loss: 31756.7112; train_edge_recon_loss: 2658089.2863; train_gene_expr_recon_loss: 6184484.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20929.5884; train_chrom_access_recon_loss: 5084229.5802; train_global_loss: 13979489.4351; train_optim_loss: 13979489.4351; val_kl_reg_loss: 28233.6488; val_edge_recon_loss: 2657599.2000; val_gene_expr_recon_loss: 6203260.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20929.1797; val_chrom_access_recon_loss: 5037321.8000; val_global_loss: 13947344.5333; val_optim_loss: 13947344.5333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9621; val_auprc_score: 0.9486; val_best_acc_score: 0.9120; val_best_f1_score: 0.9155; train_kl_reg_loss: 31782.1278; train_edge_recon_loss: 2658523.0057; train_gene_expr_recon_loss: 6182507.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20928.8606; train_chrom_access_recon_loss: 5084749.7595; train_global_loss: 13978491.2977; train_optim_loss: 13978491.2977; val_kl_reg_loss: 28348.7182; val_edge_recon_loss: 2679527.4167; val_gene_expr_recon_loss: 6199376.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20928.4258; val_chrom_access_recon_loss: 5034176.2333; val_global_loss: 13962356.7333; val_optim_loss: 13962356.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 68 min 24 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9639
val AUPRC score: 0.9517
val best accuracy score: 0.9158
val best F1 score: 0.9202
val target rna MSE score: 3.9787
val source rna MSE score: 1.8848
val target atac MSE score: 0.3400
val source atac MSE score: 0.0552
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
