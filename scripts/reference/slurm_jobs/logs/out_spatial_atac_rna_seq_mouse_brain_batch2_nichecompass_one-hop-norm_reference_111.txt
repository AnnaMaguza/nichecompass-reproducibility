[True]
Run timestamp: 29072023_124010_111.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_111']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9454; val_auprc_score: 0.9525; val_best_acc_score: 0.6925; val_best_f1_score: 0.7621; train_kl_reg_loss: 10825.4571; train_edge_recon_loss: 34684239.5556; train_gene_expr_recon_loss: 773192.4514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1801058.6389; train_global_loss: 37269315.5556; train_optim_loss: 37269315.5556; val_kl_reg_loss: 6738.6670; val_edge_recon_loss: 40573872.0000; val_gene_expr_recon_loss: 728975.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1812913.1250; val_global_loss: 43122500.0000; val_optim_loss: 43122500.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9516; val_auprc_score: 0.9493; val_best_acc_score: 0.8538; val_best_f1_score: 0.8359; train_kl_reg_loss: 2461.5366; train_edge_recon_loss: 34662272.0000; train_gene_expr_recon_loss: 724088.5764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1743074.3333; train_global_loss: 37131898.2222; train_optim_loss: 37131898.2222; val_kl_reg_loss: 748.7451; val_edge_recon_loss: 40397928.0000; val_gene_expr_recon_loss: 745705.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1772870.0000; val_global_loss: 42917248.0000; val_optim_loss: 42917248.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9442; val_auprc_score: 0.9458; val_best_acc_score: 0.8511; val_best_f1_score: 0.8393; train_kl_reg_loss: 594.1825; train_edge_recon_loss: 34630444.4444; train_gene_expr_recon_loss: 725101.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1733181.0139; train_global_loss: 37089320.8889; train_optim_loss: 37089320.8889; val_kl_reg_loss: 641.4943; val_edge_recon_loss: 40012960.0000; val_gene_expr_recon_loss: 722280.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1773698.3750; val_global_loss: 42509580.0000; val_optim_loss: 42509580.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9048; val_auprc_score: 0.9001; val_best_acc_score: 0.8141; val_best_f1_score: 0.8229; train_kl_reg_loss: 599.4829; train_edge_recon_loss: 34457736.8889; train_gene_expr_recon_loss: 705916.7847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1721090.5278; train_global_loss: 36885344.0000; train_optim_loss: 36885344.0000; val_kl_reg_loss: 868.5096; val_edge_recon_loss: 33493152.0000; val_gene_expr_recon_loss: 713160.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1765565.0000; val_global_loss: 35972744.0000; val_optim_loss: 35972744.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8906; val_auprc_score: 0.8832; val_best_acc_score: 0.7952; val_best_f1_score: 0.8069; train_kl_reg_loss: 3482.2620; train_edge_recon_loss: 31508704.2222; train_gene_expr_recon_loss: 680963.8403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1737535.0694; train_global_loss: 33930685.1111; train_optim_loss: 33930685.1111; val_kl_reg_loss: 10824.7354; val_edge_recon_loss: 28441012.0000; val_gene_expr_recon_loss: 674771.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1788307.5000; val_global_loss: 30914916.0000; val_optim_loss: 30914916.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8732; val_auprc_score: 0.8600; val_best_acc_score: 0.7863; val_best_f1_score: 0.8045; train_kl_reg_loss: 20691.4518; train_edge_recon_loss: 28573105.1111; train_gene_expr_recon_loss: 676752.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1729649.4306; train_global_loss: 31000198.4444; train_optim_loss: 31000198.4444; val_kl_reg_loss: 33180.8086; val_edge_recon_loss: 29032180.0000; val_gene_expr_recon_loss: 692629.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1760479.7500; val_global_loss: 31518470.0000; val_optim_loss: 31518470.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8831; val_auprc_score: 0.8641; val_best_acc_score: 0.8021; val_best_f1_score: 0.8096; train_kl_reg_loss: 40813.2891; train_edge_recon_loss: 28332136.8889; train_gene_expr_recon_loss: 651279.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1726458.5417; train_global_loss: 30750688.2222; train_optim_loss: 30750688.2222; val_kl_reg_loss: 45578.1875; val_edge_recon_loss: 28157696.0000; val_gene_expr_recon_loss: 634175.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1757353.5000; val_global_loss: 30594804.0000; val_optim_loss: 30594804.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8915; val_auprc_score: 0.8631; val_best_acc_score: 0.8138; val_best_f1_score: 0.8282; train_kl_reg_loss: 48288.5004; train_edge_recon_loss: 28113394.6667; train_gene_expr_recon_loss: 614275.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1697969.6250; train_global_loss: 30473928.0000; train_optim_loss: 30473928.0000; val_kl_reg_loss: 46995.6367; val_edge_recon_loss: 28110754.0000; val_gene_expr_recon_loss: 619467.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1733590.7500; val_global_loss: 30510808.0000; val_optim_loss: 30510808.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9074; val_auprc_score: 0.8782; val_best_acc_score: 0.8418; val_best_f1_score: 0.8494; train_kl_reg_loss: 45924.5538; train_edge_recon_loss: 27649516.2222; train_gene_expr_recon_loss: 587324.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1699518.7917; train_global_loss: 29982283.7778; train_optim_loss: 29982283.7778; val_kl_reg_loss: 44566.5000; val_edge_recon_loss: 27676014.0000; val_gene_expr_recon_loss: 583516.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1719950.0000; val_global_loss: 30024046.0000; val_optim_loss: 30024046.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9249; val_auprc_score: 0.8963; val_best_acc_score: 0.8673; val_best_f1_score: 0.8738; train_kl_reg_loss: 43305.3207; train_edge_recon_loss: 27275192.6667; train_gene_expr_recon_loss: 568944.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1678611.0972; train_global_loss: 29566053.5556; train_optim_loss: 29566053.5556; val_kl_reg_loss: 42121.5078; val_edge_recon_loss: 27178370.0000; val_gene_expr_recon_loss: 563049.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1713449.2500; val_global_loss: 29496990.0000; val_optim_loss: 29496990.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9292; val_auprc_score: 0.9046; val_best_acc_score: 0.8654; val_best_f1_score: 0.8736; train_kl_reg_loss: 41301.5026; train_edge_recon_loss: 26939280.6667; train_gene_expr_recon_loss: 547138.5903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1677082.3056; train_global_loss: 29204803.3333; train_optim_loss: 29204803.3333; val_kl_reg_loss: 41974.7930; val_edge_recon_loss: 27235154.0000; val_gene_expr_recon_loss: 551925.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1692484.8750; val_global_loss: 29521538.0000; val_optim_loss: 29521538.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9337; val_auprc_score: 0.9138; val_best_acc_score: 0.8724; val_best_f1_score: 0.8797; train_kl_reg_loss: 40580.4622; train_edge_recon_loss: 26924645.5556; train_gene_expr_recon_loss: 533824.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1664767.1250; train_global_loss: 29163818.0000; train_optim_loss: 29163818.0000; val_kl_reg_loss: 39517.7656; val_edge_recon_loss: 27202704.0000; val_gene_expr_recon_loss: 531450.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1687755.0000; val_global_loss: 29461428.0000; val_optim_loss: 29461428.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9434; val_auprc_score: 0.9212; val_best_acc_score: 0.8828; val_best_f1_score: 0.8898; train_kl_reg_loss: 39563.5859; train_edge_recon_loss: 26837548.6667; train_gene_expr_recon_loss: 521909.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1653149.1667; train_global_loss: 29052170.6667; train_optim_loss: 29052170.6667; val_kl_reg_loss: 39472.1172; val_edge_recon_loss: 26727834.0000; val_gene_expr_recon_loss: 521478.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1677489.0000; val_global_loss: 28966272.0000; val_optim_loss: 28966272.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9458; val_auprc_score: 0.9262; val_best_acc_score: 0.8884; val_best_f1_score: 0.8938; train_kl_reg_loss: 38683.9709; train_edge_recon_loss: 26727400.6667; train_gene_expr_recon_loss: 507776.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1640776.0694; train_global_loss: 28914636.4444; train_optim_loss: 28914636.4444; val_kl_reg_loss: 38834.0742; val_edge_recon_loss: 26926250.0000; val_gene_expr_recon_loss: 513039.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1674598.5000; val_global_loss: 29152722.0000; val_optim_loss: 29152722.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9530; val_auprc_score: 0.9380; val_best_acc_score: 0.8945; val_best_f1_score: 0.9001; train_kl_reg_loss: 37465.4262; train_edge_recon_loss: 26581425.1111; train_gene_expr_recon_loss: 499851.0486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1629128.2222; train_global_loss: 28747869.7778; train_optim_loss: 28747869.7778; val_kl_reg_loss: 38687.2031; val_edge_recon_loss: 26800584.0000; val_gene_expr_recon_loss: 509219.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1666474.7500; val_global_loss: 29014966.0000; val_optim_loss: 29014966.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9497; val_auprc_score: 0.9308; val_best_acc_score: 0.8915; val_best_f1_score: 0.8973; train_kl_reg_loss: 37416.3034; train_edge_recon_loss: 26654526.4444; train_gene_expr_recon_loss: 496806.5174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1636709.1389; train_global_loss: 28825458.4444; train_optim_loss: 28825458.4444; val_kl_reg_loss: 37667.9453; val_edge_recon_loss: 26779122.0000; val_gene_expr_recon_loss: 500132.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1665994.7500; val_global_loss: 28982916.0000; val_optim_loss: 28982916.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9433; val_auprc_score: 0.9202; val_best_acc_score: 0.8826; val_best_f1_score: 0.8903; train_kl_reg_loss: 37665.5043; train_edge_recon_loss: 26543798.2222; train_gene_expr_recon_loss: 489041.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1628345.0000; train_global_loss: 28698850.0000; train_optim_loss: 28698850.0000; val_kl_reg_loss: 38614.1094; val_edge_recon_loss: 27026132.0000; val_gene_expr_recon_loss: 492739.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1658635.6250; val_global_loss: 29216122.0000; val_optim_loss: 29216122.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9474; val_auprc_score: 0.9255; val_best_acc_score: 0.8945; val_best_f1_score: 0.8993; train_kl_reg_loss: 38094.6337; train_edge_recon_loss: 26416093.7778; train_gene_expr_recon_loss: 484574.8681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1623471.5694; train_global_loss: 28562234.8889; train_optim_loss: 28562234.8889; val_kl_reg_loss: 38850.2891; val_edge_recon_loss: 26597866.0000; val_gene_expr_recon_loss: 494480.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1660814.7500; val_global_loss: 28792010.0000; val_optim_loss: 28792010.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9525; val_auprc_score: 0.9344; val_best_acc_score: 0.8968; val_best_f1_score: 0.9016; train_kl_reg_loss: 38418.3060; train_edge_recon_loss: 26487337.1111; train_gene_expr_recon_loss: 484637.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1626503.1389; train_global_loss: 28636895.7778; train_optim_loss: 28636895.7778; val_kl_reg_loss: 38878.9258; val_edge_recon_loss: 26640844.0000; val_gene_expr_recon_loss: 493535.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1660408.2500; val_global_loss: 28833666.0000; val_optim_loss: 28833666.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9542; val_auprc_score: 0.9346; val_best_acc_score: 0.9014; val_best_f1_score: 0.9070; train_kl_reg_loss: 38035.9310; train_edge_recon_loss: 26486015.1111; train_gene_expr_recon_loss: 484018.9236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1624885.4722; train_global_loss: 28632955.7778; train_optim_loss: 28632955.7778; val_kl_reg_loss: 38757.4766; val_edge_recon_loss: 26509732.0000; val_gene_expr_recon_loss: 491703.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1657932.5000; val_global_loss: 28698126.0000; val_optim_loss: 28698126.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9496; val_auprc_score: 0.9282; val_best_acc_score: 0.8984; val_best_f1_score: 0.9043; train_kl_reg_loss: 37953.6905; train_edge_recon_loss: 26455183.3333; train_gene_expr_recon_loss: 483156.1424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1621104.0000; train_global_loss: 28597397.1111; train_optim_loss: 28597397.1111; val_kl_reg_loss: 38617.2031; val_edge_recon_loss: 26525416.0000; val_gene_expr_recon_loss: 491889.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1659109.3750; val_global_loss: 28715034.0000; val_optim_loss: 28715034.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9506; val_auprc_score: 0.9295; val_best_acc_score: 0.8985; val_best_f1_score: 0.9041; train_kl_reg_loss: 38062.0738; train_edge_recon_loss: 26518170.0000; train_gene_expr_recon_loss: 483098.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1625503.5833; train_global_loss: 28664833.1111; train_optim_loss: 28664833.1111; val_kl_reg_loss: 38264.9844; val_edge_recon_loss: 26551920.0000; val_gene_expr_recon_loss: 491378.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1656517.7500; val_global_loss: 28738080.0000; val_optim_loss: 28738080.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9541; val_auprc_score: 0.9376; val_best_acc_score: 0.9019; val_best_f1_score: 0.9070; train_kl_reg_loss: 38217.9232; train_edge_recon_loss: 26452322.4444; train_gene_expr_recon_loss: 483134.2257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1629897.2222; train_global_loss: 28603572.0000; train_optim_loss: 28603572.0000; val_kl_reg_loss: 38479.1094; val_edge_recon_loss: 26449782.0000; val_gene_expr_recon_loss: 490187.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1658482.0000; val_global_loss: 28636932.0000; val_optim_loss: 28636932.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9577; val_auprc_score: 0.9424; val_best_acc_score: 0.9060; val_best_f1_score: 0.9105; train_kl_reg_loss: 37720.7908; train_edge_recon_loss: 26442679.3333; train_gene_expr_recon_loss: 481934.4097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1625589.7222; train_global_loss: 28587923.7778; train_optim_loss: 28587923.7778; val_kl_reg_loss: 38606.9375; val_edge_recon_loss: 26454574.0000; val_gene_expr_recon_loss: 489932.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1655986.7500; val_global_loss: 28639098.0000; val_optim_loss: 28639098.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9540; val_auprc_score: 0.9326; val_best_acc_score: 0.8994; val_best_f1_score: 0.9038; train_kl_reg_loss: 38203.1745; train_edge_recon_loss: 26376294.6667; train_gene_expr_recon_loss: 483622.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1623817.9583; train_global_loss: 28521938.6667; train_optim_loss: 28521938.6667; val_kl_reg_loss: 38293.4453; val_edge_recon_loss: 26687216.0000; val_gene_expr_recon_loss: 490406.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1653713.2500; val_global_loss: 28869630.0000; val_optim_loss: 28869630.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9522; val_auprc_score: 0.9343; val_best_acc_score: 0.8968; val_best_f1_score: 0.9023; train_kl_reg_loss: 37792.8420; train_edge_recon_loss: 26420152.0000; train_gene_expr_recon_loss: 482778.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1627073.6389; train_global_loss: 28567796.8889; train_optim_loss: 28567796.8889; val_kl_reg_loss: 36715.7891; val_edge_recon_loss: 26792828.0000; val_gene_expr_recon_loss: 490023.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1656862.6250; val_global_loss: 28976430.0000; val_optim_loss: 28976430.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9531; val_auprc_score: 0.9345; val_best_acc_score: 0.9003; val_best_f1_score: 0.9059; train_kl_reg_loss: 38026.4193; train_edge_recon_loss: 26448554.6667; train_gene_expr_recon_loss: 482369.1424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1620115.0833; train_global_loss: 28589065.5556; train_optim_loss: 28589065.5556; val_kl_reg_loss: 36313.7109; val_edge_recon_loss: 26586500.0000; val_gene_expr_recon_loss: 489419.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1654983.2500; val_global_loss: 28767218.0000; val_optim_loss: 28767218.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9527; val_auprc_score: 0.9313; val_best_acc_score: 0.9022; val_best_f1_score: 0.9075; train_kl_reg_loss: 37897.7535; train_edge_recon_loss: 26443043.3333; train_gene_expr_recon_loss: 481827.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1631007.7361; train_global_loss: 28593775.5556; train_optim_loss: 28593775.5556; val_kl_reg_loss: 36523.2344; val_edge_recon_loss: 26506678.0000; val_gene_expr_recon_loss: 490235.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1658831.2500; val_global_loss: 28692270.0000; val_optim_loss: 28692270.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9531; val_auprc_score: 0.9319; val_best_acc_score: 0.9022; val_best_f1_score: 0.9066; train_kl_reg_loss: 37635.2196; train_edge_recon_loss: 26468209.1111; train_gene_expr_recon_loss: 481848.7465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1611988.7639; train_global_loss: 28599681.3333; train_optim_loss: 28599681.3333; val_kl_reg_loss: 36677.4844; val_edge_recon_loss: 26735606.0000; val_gene_expr_recon_loss: 490004.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1656064.5000; val_global_loss: 28918352.0000; val_optim_loss: 28918352.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9607; val_auprc_score: 0.9457; val_best_acc_score: 0.9051; val_best_f1_score: 0.9093; train_kl_reg_loss: 37948.1766; train_edge_recon_loss: 26476908.4444; train_gene_expr_recon_loss: 481773.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1626772.8333; train_global_loss: 28623402.0000; train_optim_loss: 28623402.0000; val_kl_reg_loss: 36698.6758; val_edge_recon_loss: 26391826.0000; val_gene_expr_recon_loss: 490470.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1658479.0000; val_global_loss: 28577472.0000; val_optim_loss: 28577472.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9533; val_auprc_score: 0.9324; val_best_acc_score: 0.9007; val_best_f1_score: 0.9062; train_kl_reg_loss: 37872.1814; train_edge_recon_loss: 26447363.5556; train_gene_expr_recon_loss: 481965.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1613997.7639; train_global_loss: 28581199.1111; train_optim_loss: 28581199.1111; val_kl_reg_loss: 36502.1797; val_edge_recon_loss: 26573142.0000; val_gene_expr_recon_loss: 490265.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1657822.6250; val_global_loss: 28757732.0000; val_optim_loss: 28757732.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9520; val_auprc_score: 0.9325; val_best_acc_score: 0.8976; val_best_f1_score: 0.9026; train_kl_reg_loss: 37853.3863; train_edge_recon_loss: 26533341.5556; train_gene_expr_recon_loss: 481599.9896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1625232.2361; train_global_loss: 28678026.6667; train_optim_loss: 28678026.6667; val_kl_reg_loss: 36731.5664; val_edge_recon_loss: 26806778.0000; val_gene_expr_recon_loss: 490231.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1659153.7500; val_global_loss: 28992896.0000; val_optim_loss: 28992896.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9554; val_auprc_score: 0.9395; val_best_acc_score: 0.9042; val_best_f1_score: 0.9093; train_kl_reg_loss: 37717.7348; train_edge_recon_loss: 26459635.7778; train_gene_expr_recon_loss: 480405.1285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1621308.9444; train_global_loss: 28599067.7778; train_optim_loss: 28599067.7778; val_kl_reg_loss: 36507.1484; val_edge_recon_loss: 26493206.0000; val_gene_expr_recon_loss: 489887.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1656235.2500; val_global_loss: 28675838.0000; val_optim_loss: 28675838.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9519; val_auprc_score: 0.9288; val_best_acc_score: 0.9011; val_best_f1_score: 0.9066; train_kl_reg_loss: 37928.6584; train_edge_recon_loss: 26458163.1111; train_gene_expr_recon_loss: 483794.6285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1625660.5000; train_global_loss: 28605546.8889; train_optim_loss: 28605546.8889; val_kl_reg_loss: 36669.3750; val_edge_recon_loss: 26578310.0000; val_gene_expr_recon_loss: 490017.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1658782.0000; val_global_loss: 28763780.0000; val_optim_loss: 28763780.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9569; val_auprc_score: 0.9407; val_best_acc_score: 0.9042; val_best_f1_score: 0.9093; train_kl_reg_loss: 37607.2096; train_edge_recon_loss: 26474978.2222; train_gene_expr_recon_loss: 482918.6597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1625870.3056; train_global_loss: 28621374.2222; train_optim_loss: 28621374.2222; val_kl_reg_loss: 36416.6797; val_edge_recon_loss: 26512116.0000; val_gene_expr_recon_loss: 489365.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1658725.7500; val_global_loss: 28696624.0000; val_optim_loss: 28696624.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9521; val_auprc_score: 0.9315; val_best_acc_score: 0.8969; val_best_f1_score: 0.9025; train_kl_reg_loss: 37558.7201; train_edge_recon_loss: 26458656.6667; train_gene_expr_recon_loss: 482829.2431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1616750.8056; train_global_loss: 28595795.3333; train_optim_loss: 28595795.3333; val_kl_reg_loss: 36356.5547; val_edge_recon_loss: 26622048.0000; val_gene_expr_recon_loss: 489631.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1655444.0000; val_global_loss: 28803480.0000; val_optim_loss: 28803480.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9515; val_auprc_score: 0.9311; val_best_acc_score: 0.8998; val_best_f1_score: 0.9045; train_kl_reg_loss: 37662.4787; train_edge_recon_loss: 26519978.8889; train_gene_expr_recon_loss: 482271.3924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1620903.4444; train_global_loss: 28660815.7778; train_optim_loss: 28660815.7778; val_kl_reg_loss: 36378.6484; val_edge_recon_loss: 26804314.0000; val_gene_expr_recon_loss: 489433.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1657402.1250; val_global_loss: 28987528.0000; val_optim_loss: 28987528.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9570; val_auprc_score: 0.9411; val_best_acc_score: 0.9066; val_best_f1_score: 0.9114; train_kl_reg_loss: 37688.5017; train_edge_recon_loss: 26445686.4444; train_gene_expr_recon_loss: 480243.6424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1618789.0278; train_global_loss: 28582407.1111; train_optim_loss: 28582407.1111; val_kl_reg_loss: 36565.8125; val_edge_recon_loss: 26521834.0000; val_gene_expr_recon_loss: 489335.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1656295.0000; val_global_loss: 28704032.0000; val_optim_loss: 28704032.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 30 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9543
val AUPRC score: 0.9359
val best accuracy score: 0.9007
val best F1 score: 0.9056
val target rna MSE score: 6.8830
val source rna MSE score: 4.2612
val target atac MSE score: 0.1299
val source atac MSE score: 0.0214
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
