[True]
Run timestamp: 10102023_021507_111.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_111']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6616; val_auprc_score: 0.6444; val_best_acc_score: 0.5027; val_best_f1_score: 0.6676; train_kl_reg_loss: 48316.6147; train_edge_recon_loss: 3516853.3258; train_gene_expr_recon_loss: 14127575.1212; train_masked_gp_l1_reg_loss: 47556.9864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5503704.2386; train_chrom_access_recon_loss: 11606166.6364; train_global_loss: 34850172.7879; train_optim_loss: 34850172.7879; val_kl_reg_loss: 60711.1636; val_edge_recon_loss: 4064864.0625; val_gene_expr_recon_loss: 12836080.7500; val_masked_gp_l1_reg_loss: 56737.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2502488.2500; val_chrom_access_recon_loss: 10700055.6250; val_global_loss: 30220938.0000; val_optim_loss: 30220938.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6962; val_auprc_score: 0.6700; val_best_acc_score: 0.5559; val_best_f1_score: 0.6868; train_kl_reg_loss: 90860.3978; train_edge_recon_loss: 3523209.4848; train_gene_expr_recon_loss: 12915859.5909; train_masked_gp_l1_reg_loss: 59474.6320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1155273.4621; train_chrom_access_recon_loss: 11052545.1970; train_global_loss: 28797222.9091; train_optim_loss: 28797222.9091; val_kl_reg_loss: 120904.0977; val_edge_recon_loss: 4062179.7500; val_gene_expr_recon_loss: 12646991.6250; val_masked_gp_l1_reg_loss: 61410.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 491215.0938; val_chrom_access_recon_loss: 10747516.8750; val_global_loss: 28130218.5000; val_optim_loss: 28130218.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7285; val_auprc_score: 0.7008; val_best_acc_score: 0.6725; val_best_f1_score: 0.7108; train_kl_reg_loss: 90584.6470; train_edge_recon_loss: 3514693.7576; train_gene_expr_recon_loss: 12732891.1970; train_masked_gp_l1_reg_loss: 62409.0288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 342930.1929; train_chrom_access_recon_loss: 10982162.2879; train_global_loss: 27725670.9697; train_optim_loss: 27725670.9697; val_kl_reg_loss: 88363.1357; val_edge_recon_loss: 4049306.2188; val_gene_expr_recon_loss: 12452405.7500; val_masked_gp_l1_reg_loss: 63334.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 249750.9219; val_chrom_access_recon_loss: 10545458.8750; val_global_loss: 27448618.5000; val_optim_loss: 27448618.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8403; val_auprc_score: 0.8132; val_best_acc_score: 0.7622; val_best_f1_score: 0.7912; train_kl_reg_loss: 78962.7396; train_edge_recon_loss: 3491602.9583; train_gene_expr_recon_loss: 12607270.7273; train_masked_gp_l1_reg_loss: 64375.4787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209361.2571; train_chrom_access_recon_loss: 10888453.7273; train_global_loss: 27340027.0606; train_optim_loss: 27340027.0606; val_kl_reg_loss: 62984.6416; val_edge_recon_loss: 3694343.9062; val_gene_expr_recon_loss: 12344896.5000; val_masked_gp_l1_reg_loss: 65814.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179588.2500; val_chrom_access_recon_loss: 10494296.5000; val_global_loss: 26841925.0000; val_optim_loss: 26841925.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8306; val_auprc_score: 0.7994; val_best_acc_score: 0.7453; val_best_f1_score: 0.7870; train_kl_reg_loss: 86564.7817; train_edge_recon_loss: 3107216.8106; train_gene_expr_recon_loss: 12532564.8939; train_masked_gp_l1_reg_loss: 69517.6205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160831.5542; train_chrom_access_recon_loss: 10810442.4545; train_global_loss: 26767138.0303; train_optim_loss: 26767138.0303; val_kl_reg_loss: 112770.7744; val_edge_recon_loss: 3000362.7812; val_gene_expr_recon_loss: 12215949.6250; val_masked_gp_l1_reg_loss: 72622.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144852.5938; val_chrom_access_recon_loss: 10405393.6250; val_global_loss: 25951952.0000; val_optim_loss: 25951952.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8669; val_auprc_score: 0.8303; val_best_acc_score: 0.7926; val_best_f1_score: 0.8180; train_kl_reg_loss: 108367.5084; train_edge_recon_loss: 2931591.5265; train_gene_expr_recon_loss: 12456057.7121; train_masked_gp_l1_reg_loss: 73951.0232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135365.1391; train_chrom_access_recon_loss: 10748637.0758; train_global_loss: 26453969.9697; train_optim_loss: 26453969.9697; val_kl_reg_loss: 97923.2197; val_edge_recon_loss: 2915809.8125; val_gene_expr_recon_loss: 12232433.0000; val_masked_gp_l1_reg_loss: 75254.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127339.9844; val_chrom_access_recon_loss: 10363971.2500; val_global_loss: 25812731.0000; val_optim_loss: 25812731.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8728; val_auprc_score: 0.8344; val_best_acc_score: 0.8084; val_best_f1_score: 0.8236; train_kl_reg_loss: 104716.8491; train_edge_recon_loss: 2882768.1477; train_gene_expr_recon_loss: 12394260.2879; train_masked_gp_l1_reg_loss: 76406.3290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121115.6680; train_chrom_access_recon_loss: 10709376.6364; train_global_loss: 26288643.9697; train_optim_loss: 26288643.9697; val_kl_reg_loss: 97509.3145; val_edge_recon_loss: 2884757.6562; val_gene_expr_recon_loss: 12223457.1250; val_masked_gp_l1_reg_loss: 77419.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116349.6172; val_chrom_access_recon_loss: 10416075.0000; val_global_loss: 25815568.5000; val_optim_loss: 25815568.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8901; val_auprc_score: 0.8565; val_best_acc_score: 0.8235; val_best_f1_score: 0.8390; train_kl_reg_loss: 104410.8645; train_edge_recon_loss: 2860419.9091; train_gene_expr_recon_loss: 12325834.4242; train_masked_gp_l1_reg_loss: 78595.9837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112972.6271; train_chrom_access_recon_loss: 10650093.2273; train_global_loss: 26132327.0000; train_optim_loss: 26132327.0000; val_kl_reg_loss: 107190.5244; val_edge_recon_loss: 2869405.6875; val_gene_expr_recon_loss: 12152014.3750; val_masked_gp_l1_reg_loss: 79668.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110046.5391; val_chrom_access_recon_loss: 10372638.3750; val_global_loss: 25690964.0000; val_optim_loss: 25690964.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8886; val_auprc_score: 0.8595; val_best_acc_score: 0.8181; val_best_f1_score: 0.8366; train_kl_reg_loss: 109097.2167; train_edge_recon_loss: 2820562.9205; train_gene_expr_recon_loss: 12277188.5606; train_masked_gp_l1_reg_loss: 80413.0833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108679.1362; train_chrom_access_recon_loss: 10612820.2424; train_global_loss: 26008761.2727; train_optim_loss: 26008761.2727; val_kl_reg_loss: 101559.4102; val_edge_recon_loss: 2893225.5000; val_gene_expr_recon_loss: 12100849.0000; val_masked_gp_l1_reg_loss: 81053.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107221.7969; val_chrom_access_recon_loss: 10305001.1250; val_global_loss: 25588911.2500; val_optim_loss: 25588911.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9060; val_auprc_score: 0.8731; val_best_acc_score: 0.8404; val_best_f1_score: 0.8549; train_kl_reg_loss: 102326.5906; train_edge_recon_loss: 2822580.3561; train_gene_expr_recon_loss: 12224216.6667; train_masked_gp_l1_reg_loss: 81788.7199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105742.1880; train_chrom_access_recon_loss: 10579292.9697; train_global_loss: 25915947.5152; train_optim_loss: 25915947.5152; val_kl_reg_loss: 98688.2266; val_edge_recon_loss: 2815674.0312; val_gene_expr_recon_loss: 12041207.6250; val_masked_gp_l1_reg_loss: 82504.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105355.0703; val_chrom_access_recon_loss: 10329813.7500; val_global_loss: 25473243.5000; val_optim_loss: 25473243.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9048; val_auprc_score: 0.8747; val_best_acc_score: 0.8487; val_best_f1_score: 0.8619; train_kl_reg_loss: 100947.3607; train_edge_recon_loss: 2815641.7765; train_gene_expr_recon_loss: 12176415.7576; train_masked_gp_l1_reg_loss: 83088.8977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105163.1932; train_chrom_access_recon_loss: 10548148.9242; train_global_loss: 25829405.9091; train_optim_loss: 25829405.9091; val_kl_reg_loss: 94668.8184; val_edge_recon_loss: 2809563.6875; val_gene_expr_recon_loss: 11901011.6250; val_masked_gp_l1_reg_loss: 83715.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104980.6094; val_chrom_access_recon_loss: 10137976.7500; val_global_loss: 25131916.5000; val_optim_loss: 25131916.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8978; val_auprc_score: 0.8646; val_best_acc_score: 0.8385; val_best_f1_score: 0.8522; train_kl_reg_loss: 95766.4712; train_edge_recon_loss: 2800886.7386; train_gene_expr_recon_loss: 12130068.0152; train_masked_gp_l1_reg_loss: 84239.2022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104714.9974; train_chrom_access_recon_loss: 10506051.2727; train_global_loss: 25721726.6364; train_optim_loss: 25721726.6364; val_kl_reg_loss: 95663.5283; val_edge_recon_loss: 2819948.3125; val_gene_expr_recon_loss: 12037325.2500; val_masked_gp_l1_reg_loss: 84969.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104683.9609; val_chrom_access_recon_loss: 10308087.6250; val_global_loss: 25450677.5000; val_optim_loss: 25450677.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9034; val_auprc_score: 0.8646; val_best_acc_score: 0.8452; val_best_f1_score: 0.8569; train_kl_reg_loss: 97960.6847; train_edge_recon_loss: 2768659.7576; train_gene_expr_recon_loss: 12085596.9545; train_masked_gp_l1_reg_loss: 85393.1257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103872.1125; train_chrom_access_recon_loss: 10470858.5909; train_global_loss: 25612341.0606; train_optim_loss: 25612341.0606; val_kl_reg_loss: 96682.2520; val_edge_recon_loss: 2830973.4062; val_gene_expr_recon_loss: 11758887.6250; val_masked_gp_l1_reg_loss: 85989.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104304.2266; val_chrom_access_recon_loss: 10160352.5000; val_global_loss: 25037190.0000; val_optim_loss: 25037190.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9069; val_auprc_score: 0.8786; val_best_acc_score: 0.8412; val_best_f1_score: 0.8550; train_kl_reg_loss: 96977.7306; train_edge_recon_loss: 2780272.1856; train_gene_expr_recon_loss: 12045155.6212; train_masked_gp_l1_reg_loss: 86408.8763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103117.1134; train_chrom_access_recon_loss: 10437324.5758; train_global_loss: 25549255.9394; train_optim_loss: 25549255.9394; val_kl_reg_loss: 95786.7490; val_edge_recon_loss: 2834135.1562; val_gene_expr_recon_loss: 11846626.0000; val_masked_gp_l1_reg_loss: 86803.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101749.2500; val_chrom_access_recon_loss: 10078745.3750; val_global_loss: 25043845.2500; val_optim_loss: 25043845.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9121; val_auprc_score: 0.8802; val_best_acc_score: 0.8485; val_best_f1_score: 0.8617; train_kl_reg_loss: 97825.5707; train_edge_recon_loss: 2771278.5265; train_gene_expr_recon_loss: 12016830.4697; train_masked_gp_l1_reg_loss: 87035.5376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101302.1861; train_chrom_access_recon_loss: 10409983.8333; train_global_loss: 25484256.0303; train_optim_loss: 25484256.0303; val_kl_reg_loss: 95296.2090; val_edge_recon_loss: 2822247.9062; val_gene_expr_recon_loss: 11851977.0000; val_masked_gp_l1_reg_loss: 87315.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100077.0078; val_chrom_access_recon_loss: 10120585.3750; val_global_loss: 25077499.2500; val_optim_loss: 25077499.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9158; val_auprc_score: 0.8856; val_best_acc_score: 0.8589; val_best_f1_score: 0.8697; train_kl_reg_loss: 94816.2386; train_edge_recon_loss: 2754545.3902; train_gene_expr_recon_loss: 11969006.0000; train_masked_gp_l1_reg_loss: 87713.8699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99780.3936; train_chrom_access_recon_loss: 10373764.4848; train_global_loss: 25379626.3333; train_optim_loss: 25379626.3333; val_kl_reg_loss: 93950.0693; val_edge_recon_loss: 2790966.5938; val_gene_expr_recon_loss: 11756407.8750; val_masked_gp_l1_reg_loss: 88173.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98932.6406; val_chrom_access_recon_loss: 9999967.0000; val_global_loss: 24828398.7500; val_optim_loss: 24828398.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9255; val_auprc_score: 0.8996; val_best_acc_score: 0.8662; val_best_f1_score: 0.8746; train_kl_reg_loss: 95959.1121; train_edge_recon_loss: 2757063.5909; train_gene_expr_recon_loss: 11940467.1061; train_masked_gp_l1_reg_loss: 88328.8442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98304.6866; train_chrom_access_recon_loss: 10344672.3636; train_global_loss: 25324795.6970; train_optim_loss: 25324795.6970; val_kl_reg_loss: 96858.7490; val_edge_recon_loss: 2761984.9688; val_gene_expr_recon_loss: 11934577.0000; val_masked_gp_l1_reg_loss: 88401.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97314.4062; val_chrom_access_recon_loss: 10149575.2500; val_global_loss: 25128711.2500; val_optim_loss: 25128711.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9309; val_auprc_score: 0.9144; val_best_acc_score: 0.8649; val_best_f1_score: 0.8747; train_kl_reg_loss: 92576.5997; train_edge_recon_loss: 2757925.8864; train_gene_expr_recon_loss: 11917574.6667; train_masked_gp_l1_reg_loss: 88873.7905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97244.4348; train_chrom_access_recon_loss: 10314726.9242; train_global_loss: 25268922.3939; train_optim_loss: 25268922.3939; val_kl_reg_loss: 88042.0391; val_edge_recon_loss: 2793972.1875; val_gene_expr_recon_loss: 11716660.7500; val_masked_gp_l1_reg_loss: 89295.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96792.8281; val_chrom_access_recon_loss: 9954085.3750; val_global_loss: 24738848.2500; val_optim_loss: 24738848.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9255; val_auprc_score: 0.8945; val_best_acc_score: 0.8694; val_best_f1_score: 0.8773; train_kl_reg_loss: 93266.9188; train_edge_recon_loss: 2754066.5455; train_gene_expr_recon_loss: 11882754.1970; train_masked_gp_l1_reg_loss: 89429.4852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96352.5419; train_chrom_access_recon_loss: 10292360.3939; train_global_loss: 25208230.1212; train_optim_loss: 25208230.1212; val_kl_reg_loss: 93935.6748; val_edge_recon_loss: 2753573.0000; val_gene_expr_recon_loss: 11662206.7500; val_masked_gp_l1_reg_loss: 89652.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95840.7344; val_chrom_access_recon_loss: 9955334.3750; val_global_loss: 24650543.0000; val_optim_loss: 24650543.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9297; val_auprc_score: 0.8945; val_best_acc_score: 0.8745; val_best_f1_score: 0.8826; train_kl_reg_loss: 94123.5665; train_edge_recon_loss: 2741978.0152; train_gene_expr_recon_loss: 11857234.6515; train_masked_gp_l1_reg_loss: 89697.7572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95306.7334; train_chrom_access_recon_loss: 10258428.1061; train_global_loss: 25136768.6667; train_optim_loss: 25136768.6667; val_kl_reg_loss: 91742.6240; val_edge_recon_loss: 2756121.4062; val_gene_expr_recon_loss: 11711383.1250; val_masked_gp_l1_reg_loss: 89963.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94947.6016; val_chrom_access_recon_loss: 9892286.3750; val_global_loss: 24636444.5000; val_optim_loss: 24636444.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9306; val_auprc_score: 0.9023; val_best_acc_score: 0.8775; val_best_f1_score: 0.8843; train_kl_reg_loss: 90459.0846; train_edge_recon_loss: 2732420.3485; train_gene_expr_recon_loss: 11830073.6061; train_masked_gp_l1_reg_loss: 90177.6860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94516.6486; train_chrom_access_recon_loss: 10225556.5909; train_global_loss: 25063203.9091; train_optim_loss: 25063203.9091; val_kl_reg_loss: 88628.8105; val_edge_recon_loss: 2759669.0938; val_gene_expr_recon_loss: 11639816.6250; val_masked_gp_l1_reg_loss: 90445.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94446.0469; val_chrom_access_recon_loss: 9884973.2500; val_global_loss: 24557978.5000; val_optim_loss: 24557978.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9286; val_auprc_score: 0.8996; val_best_acc_score: 0.8670; val_best_f1_score: 0.8760; train_kl_reg_loss: 92248.9667; train_edge_recon_loss: 2734046.8333; train_gene_expr_recon_loss: 11804107.8182; train_masked_gp_l1_reg_loss: 90446.7675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93918.1058; train_chrom_access_recon_loss: 10200773.6212; train_global_loss: 25015541.9394; train_optim_loss: 25015541.9394; val_kl_reg_loss: 88150.6768; val_edge_recon_loss: 2777674.7188; val_gene_expr_recon_loss: 11501757.3750; val_masked_gp_l1_reg_loss: 90535.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93624.0391; val_chrom_access_recon_loss: 9888024.0000; val_global_loss: 24439765.7500; val_optim_loss: 24439765.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9334; val_auprc_score: 0.9116; val_best_acc_score: 0.8756; val_best_f1_score: 0.8816; train_kl_reg_loss: 90094.0830; train_edge_recon_loss: 2726791.1023; train_gene_expr_recon_loss: 11793817.1667; train_masked_gp_l1_reg_loss: 90601.7332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93282.1001; train_chrom_access_recon_loss: 10185766.2727; train_global_loss: 24980352.1515; train_optim_loss: 24980352.1515; val_kl_reg_loss: 89838.0234; val_edge_recon_loss: 2763454.7812; val_gene_expr_recon_loss: 11641688.0000; val_masked_gp_l1_reg_loss: 90736.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93242.5000; val_chrom_access_recon_loss: 9942618.6250; val_global_loss: 24621577.5000; val_optim_loss: 24621577.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9380; val_auprc_score: 0.9159; val_best_acc_score: 0.8759; val_best_f1_score: 0.8836; train_kl_reg_loss: 90519.4219; train_edge_recon_loss: 2723191.2462; train_gene_expr_recon_loss: 11758873.6970; train_masked_gp_l1_reg_loss: 90749.5690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92853.7778; train_chrom_access_recon_loss: 10138519.3485; train_global_loss: 24894707.1515; train_optim_loss: 24894707.1515; val_kl_reg_loss: 88700.6328; val_edge_recon_loss: 2761858.2812; val_gene_expr_recon_loss: 11562144.5000; val_masked_gp_l1_reg_loss: 90832.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92708.4062; val_chrom_access_recon_loss: 9770306.1250; val_global_loss: 24366549.5000; val_optim_loss: 24366549.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9405; val_auprc_score: 0.9204; val_best_acc_score: 0.8812; val_best_f1_score: 0.8882; train_kl_reg_loss: 88529.5002; train_edge_recon_loss: 2728992.7348; train_gene_expr_recon_loss: 11749412.6970; train_masked_gp_l1_reg_loss: 90937.0634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92473.6242; train_chrom_access_recon_loss: 10131210.5000; train_global_loss: 24881555.9697; train_optim_loss: 24881555.9697; val_kl_reg_loss: 88567.4238; val_edge_recon_loss: 2741000.0312; val_gene_expr_recon_loss: 11543767.3750; val_masked_gp_l1_reg_loss: 91094.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92408.0078; val_chrom_access_recon_loss: 9838828.2500; val_global_loss: 24395665.7500; val_optim_loss: 24395665.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9301; val_auprc_score: 0.9052; val_best_acc_score: 0.8697; val_best_f1_score: 0.8750; train_kl_reg_loss: 109359.0981; train_edge_recon_loss: 2892140.1364; train_gene_expr_recon_loss: 10504771.1364; train_masked_gp_l1_reg_loss: 91095.1301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95103.5514; train_chrom_access_recon_loss: 9300788.3788; train_global_loss: 22993257.1515; train_optim_loss: 22993257.1515; val_kl_reg_loss: 26254.1741; val_edge_recon_loss: 2812311.9688; val_gene_expr_recon_loss: 10373410.5000; val_masked_gp_l1_reg_loss: 90147.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96915.5234; val_chrom_access_recon_loss: 8881030.7500; val_global_loss: 22280071.5000; val_optim_loss: 22280071.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9319; val_auprc_score: 0.9038; val_best_acc_score: 0.8708; val_best_f1_score: 0.8778; train_kl_reg_loss: 87109.7334; train_edge_recon_loss: 2775310.4318; train_gene_expr_recon_loss: 10430293.3788; train_masked_gp_l1_reg_loss: 88555.7923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95841.1089; train_chrom_access_recon_loss: 9129013.0909; train_global_loss: 22606123.5758; train_optim_loss: 22606123.5758; val_kl_reg_loss: 32949.5327; val_edge_recon_loss: 2757739.6562; val_gene_expr_recon_loss: 10263455.8750; val_masked_gp_l1_reg_loss: 86812.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95286.6328; val_chrom_access_recon_loss: 8742862.2500; val_global_loss: 21979106.2500; val_optim_loss: 21979106.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9283; val_auprc_score: 0.8990; val_best_acc_score: 0.8705; val_best_f1_score: 0.8788; train_kl_reg_loss: 71448.4505; train_edge_recon_loss: 2750585.2045; train_gene_expr_recon_loss: 10402031.3182; train_masked_gp_l1_reg_loss: 85351.3456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94346.2889; train_chrom_access_recon_loss: 9110930.9242; train_global_loss: 22514693.6061; train_optim_loss: 22514693.6061; val_kl_reg_loss: 38919.2739; val_edge_recon_loss: 2749754.3438; val_gene_expr_recon_loss: 10177719.8750; val_masked_gp_l1_reg_loss: 83888.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93802.8750; val_chrom_access_recon_loss: 8800744.0000; val_global_loss: 21944829.2500; val_optim_loss: 21944829.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9310; val_auprc_score: 0.9065; val_best_acc_score: 0.8673; val_best_f1_score: 0.8766; train_kl_reg_loss: 65821.8126; train_edge_recon_loss: 2739459.3068; train_gene_expr_recon_loss: 10390291.3333; train_masked_gp_l1_reg_loss: 82728.0913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93164.5825; train_chrom_access_recon_loss: 9096922.1212; train_global_loss: 22468387.3333; train_optim_loss: 22468387.3333; val_kl_reg_loss: 41774.5566; val_edge_recon_loss: 2781083.3125; val_gene_expr_recon_loss: 10181049.5000; val_masked_gp_l1_reg_loss: 81520.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92798.6328; val_chrom_access_recon_loss: 8780680.5000; val_global_loss: 21958907.5000; val_optim_loss: 21958907.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9354; val_auprc_score: 0.9119; val_best_acc_score: 0.8740; val_best_f1_score: 0.8796; train_kl_reg_loss: 64619.1490; train_edge_recon_loss: 2724469.1705; train_gene_expr_recon_loss: 10369285.5455; train_masked_gp_l1_reg_loss: 80414.4746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92388.9838; train_chrom_access_recon_loss: 9087121.1818; train_global_loss: 22418298.6061; train_optim_loss: 22418298.6061; val_kl_reg_loss: 45201.7217; val_edge_recon_loss: 2749159.2812; val_gene_expr_recon_loss: 10233224.6250; val_masked_gp_l1_reg_loss: 79340.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92065.3828; val_chrom_access_recon_loss: 8821770.8750; val_global_loss: 22020761.0000; val_optim_loss: 22020761.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9358; val_auprc_score: 0.9098; val_best_acc_score: 0.8788; val_best_f1_score: 0.8841; train_kl_reg_loss: 61231.5063; train_edge_recon_loss: 2725730.5492; train_gene_expr_recon_loss: 10359227.5758; train_masked_gp_l1_reg_loss: 78414.5511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91809.7260; train_chrom_access_recon_loss: 9067460.7727; train_global_loss: 22383874.6970; train_optim_loss: 22383874.6970; val_kl_reg_loss: 47476.4243; val_edge_recon_loss: 2741813.0000; val_gene_expr_recon_loss: 10246459.0000; val_masked_gp_l1_reg_loss: 77514.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91422.3359; val_chrom_access_recon_loss: 8781879.2500; val_global_loss: 21986564.0000; val_optim_loss: 21986564.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9421; val_auprc_score: 0.9236; val_best_acc_score: 0.8815; val_best_f1_score: 0.8875; train_kl_reg_loss: 61443.2514; train_edge_recon_loss: 2708498.8144; train_gene_expr_recon_loss: 10325377.8333; train_masked_gp_l1_reg_loss: 76670.6029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91101.1581; train_chrom_access_recon_loss: 9036567.8788; train_global_loss: 22299659.4848; train_optim_loss: 22299659.4848; val_kl_reg_loss: 47114.1240; val_edge_recon_loss: 2757607.7188; val_gene_expr_recon_loss: 10179657.5000; val_masked_gp_l1_reg_loss: 75847.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91103.5000; val_chrom_access_recon_loss: 8820950.7500; val_global_loss: 21972280.5000; val_optim_loss: 21972280.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9361; val_auprc_score: 0.9134; val_best_acc_score: 0.8783; val_best_f1_score: 0.8848; train_kl_reg_loss: 60079.2048; train_edge_recon_loss: 2710360.7045; train_gene_expr_recon_loss: 10315255.9242; train_masked_gp_l1_reg_loss: 75357.2425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75707.1214; train_chrom_access_recon_loss: 9028146.1818; train_global_loss: 22264906.5455; train_optim_loss: 22264906.5455; val_kl_reg_loss: 48338.3716; val_edge_recon_loss: 2751135.6875; val_gene_expr_recon_loss: 10143801.1250; val_masked_gp_l1_reg_loss: 75144.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72633.2188; val_chrom_access_recon_loss: 8693032.7500; val_global_loss: 21784086.0000; val_optim_loss: 21784086.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9413; val_auprc_score: 0.9173; val_best_acc_score: 0.8866; val_best_f1_score: 0.8925; train_kl_reg_loss: 61274.9777; train_edge_recon_loss: 2707054.1061; train_gene_expr_recon_loss: 10319547.0000; train_masked_gp_l1_reg_loss: 75052.3545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72263.0569; train_chrom_access_recon_loss: 9030792.8485; train_global_loss: 22265984.1818; train_optim_loss: 22265984.1818; val_kl_reg_loss: 49496.9795; val_edge_recon_loss: 2711089.5625; val_gene_expr_recon_loss: 10151640.0000; val_masked_gp_l1_reg_loss: 74960.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72067.7344; val_chrom_access_recon_loss: 8797076.6250; val_global_loss: 21856331.5000; val_optim_loss: 21856331.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9379; val_auprc_score: 0.9122; val_best_acc_score: 0.8823; val_best_f1_score: 0.8883; train_kl_reg_loss: 61834.5935; train_edge_recon_loss: 2700283.5000; train_gene_expr_recon_loss: 10310503.2424; train_masked_gp_l1_reg_loss: 74881.8363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71890.3575; train_chrom_access_recon_loss: 9026318.7424; train_global_loss: 22245712.2727; train_optim_loss: 22245712.2727; val_kl_reg_loss: 50302.6870; val_edge_recon_loss: 2698382.4688; val_gene_expr_recon_loss: 10200463.0000; val_masked_gp_l1_reg_loss: 74792.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71643.7344; val_chrom_access_recon_loss: 8862423.1250; val_global_loss: 21958007.2500; val_optim_loss: 21958007.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9377; val_auprc_score: 0.9134; val_best_acc_score: 0.8775; val_best_f1_score: 0.8843; train_kl_reg_loss: 62011.7691; train_edge_recon_loss: 2707960.6856; train_gene_expr_recon_loss: 10312519.4545; train_masked_gp_l1_reg_loss: 74720.4213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71534.0410; train_chrom_access_recon_loss: 9024483.9545; train_global_loss: 22253230.2727; train_optim_loss: 22253230.2727; val_kl_reg_loss: 49807.9839; val_edge_recon_loss: 2727549.9062; val_gene_expr_recon_loss: 10201699.2500; val_masked_gp_l1_reg_loss: 74649.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71380.0234; val_chrom_access_recon_loss: 8720676.5000; val_global_loss: 21845762.7500; val_optim_loss: 21845762.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9370; val_auprc_score: 0.9082; val_best_acc_score: 0.8807; val_best_f1_score: 0.8856; train_kl_reg_loss: 61735.4977; train_edge_recon_loss: 2708520.5114; train_gene_expr_recon_loss: 10306101.0303; train_masked_gp_l1_reg_loss: 74570.0555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71246.5457; train_chrom_access_recon_loss: 9021648.3485; train_global_loss: 22243821.9394; train_optim_loss: 22243821.9394; val_kl_reg_loss: 50008.7520; val_edge_recon_loss: 2721600.1875; val_gene_expr_recon_loss: 10144686.5000; val_masked_gp_l1_reg_loss: 74492.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71130.2812; val_chrom_access_recon_loss: 8769827.8750; val_global_loss: 21831745.5000; val_optim_loss: 21831745.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9425; val_auprc_score: 0.9184; val_best_acc_score: 0.8810; val_best_f1_score: 0.8870; train_kl_reg_loss: 61661.4040; train_edge_recon_loss: 2701785.6477; train_gene_expr_recon_loss: 10310914.9848; train_masked_gp_l1_reg_loss: 74442.9033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69468.7451; train_chrom_access_recon_loss: 9019793.8788; train_global_loss: 22238067.5152; train_optim_loss: 22238067.5152; val_kl_reg_loss: 50294.1411; val_edge_recon_loss: 2732997.7188; val_gene_expr_recon_loss: 10115600.1250; val_masked_gp_l1_reg_loss: 74420.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69141.0312; val_chrom_access_recon_loss: 8738228.6250; val_global_loss: 21780681.5000; val_optim_loss: 21780681.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9328; val_auprc_score: 0.9017; val_best_acc_score: 0.8775; val_best_f1_score: 0.8834; train_kl_reg_loss: 61721.5410; train_edge_recon_loss: 2700563.9242; train_gene_expr_recon_loss: 10301257.3939; train_masked_gp_l1_reg_loss: 74408.6267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69106.3738; train_chrom_access_recon_loss: 9011033.2879; train_global_loss: 22218091.0606; train_optim_loss: 22218091.0606; val_kl_reg_loss: 50110.1636; val_edge_recon_loss: 2771116.8125; val_gene_expr_recon_loss: 10184584.1250; val_masked_gp_l1_reg_loss: 74398.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69077.3047; val_chrom_access_recon_loss: 8806564.8750; val_global_loss: 21955850.5000; val_optim_loss: 21955850.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9370; val_auprc_score: 0.9150; val_best_acc_score: 0.8767; val_best_f1_score: 0.8805; train_kl_reg_loss: 61845.3406; train_edge_recon_loss: 2712065.1250; train_gene_expr_recon_loss: 10297807.4848; train_masked_gp_l1_reg_loss: 74389.4576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69053.9633; train_chrom_access_recon_loss: 9009497.6364; train_global_loss: 22224659.0606; train_optim_loss: 22224659.0606; val_kl_reg_loss: 50399.9658; val_edge_recon_loss: 2742861.5312; val_gene_expr_recon_loss: 10122480.1250; val_masked_gp_l1_reg_loss: 74379.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69030.7656; val_chrom_access_recon_loss: 8761123.2500; val_global_loss: 21820276.0000; val_optim_loss: 21820276.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9356; val_auprc_score: 0.9099; val_best_acc_score: 0.8751; val_best_f1_score: 0.8821; train_kl_reg_loss: 61866.8725; train_edge_recon_loss: 2716191.1326; train_gene_expr_recon_loss: 10305932.9697; train_masked_gp_l1_reg_loss: 74371.0866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69018.2057; train_chrom_access_recon_loss: 9022979.6061; train_global_loss: 22250360.0909; train_optim_loss: 22250360.0909; val_kl_reg_loss: 50419.3818; val_edge_recon_loss: 2775528.3750; val_gene_expr_recon_loss: 10178383.1250; val_masked_gp_l1_reg_loss: 74361.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69001.8281; val_chrom_access_recon_loss: 8737100.0000; val_global_loss: 21884795.0000; val_optim_loss: 21884795.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9413; val_auprc_score: 0.9160; val_best_acc_score: 0.8901; val_best_f1_score: 0.8948; train_kl_reg_loss: 61924.7298; train_edge_recon_loss: 2708466.7500; train_gene_expr_recon_loss: 10318584.0000; train_masked_gp_l1_reg_loss: 74352.8717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68981.6426; train_chrom_access_recon_loss: 9030649.5152; train_global_loss: 22262959.3333; train_optim_loss: 22262959.3333; val_kl_reg_loss: 50776.1489; val_edge_recon_loss: 2703296.6875; val_gene_expr_recon_loss: 10204919.1250; val_masked_gp_l1_reg_loss: 74344.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68968.2344; val_chrom_access_recon_loss: 8828074.2500; val_global_loss: 21930378.5000; val_optim_loss: 21930378.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9443; val_auprc_score: 0.9254; val_best_acc_score: 0.8885; val_best_f1_score: 0.8934; train_kl_reg_loss: 62074.3066; train_edge_recon_loss: 2708564.0038; train_gene_expr_recon_loss: 10303393.3485; train_masked_gp_l1_reg_loss: 74338.7457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68800.9486; train_chrom_access_recon_loss: 9019177.9848; train_global_loss: 22236349.1515; train_optim_loss: 22236349.1515; val_kl_reg_loss: 50790.6948; val_edge_recon_loss: 2714821.9375; val_gene_expr_recon_loss: 10212194.8750; val_masked_gp_l1_reg_loss: 74336.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68768.5625; val_chrom_access_recon_loss: 8838695.1250; val_global_loss: 21959608.0000; val_optim_loss: 21959608.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9356; val_auprc_score: 0.9096; val_best_acc_score: 0.8807; val_best_f1_score: 0.8868; train_kl_reg_loss: 61938.1406; train_edge_recon_loss: 2709145.3333; train_gene_expr_recon_loss: 10302067.2121; train_masked_gp_l1_reg_loss: 74334.8878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68765.1432; train_chrom_access_recon_loss: 9017752.4394; train_global_loss: 22234003.1818; train_optim_loss: 22234003.1818; val_kl_reg_loss: 50617.9873; val_edge_recon_loss: 2745321.1875; val_gene_expr_recon_loss: 10156196.0000; val_masked_gp_l1_reg_loss: 74333.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68762.2031; val_chrom_access_recon_loss: 8740201.1250; val_global_loss: 21835432.2500; val_optim_loss: 21835432.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9398; val_auprc_score: 0.9192; val_best_acc_score: 0.8799; val_best_f1_score: 0.8859; train_kl_reg_loss: 62026.9380; train_edge_recon_loss: 2702149.4091; train_gene_expr_recon_loss: 10310792.8030; train_masked_gp_l1_reg_loss: 74332.6410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68759.7150; train_chrom_access_recon_loss: 9018448.2273; train_global_loss: 22236509.7576; train_optim_loss: 22236509.7576; val_kl_reg_loss: 51049.4277; val_edge_recon_loss: 2744570.7812; val_gene_expr_recon_loss: 10229819.0000; val_masked_gp_l1_reg_loss: 74331.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68756.7344; val_chrom_access_recon_loss: 8874968.7500; val_global_loss: 22043496.7500; val_optim_loss: 22043496.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9440; val_auprc_score: 0.9266; val_best_acc_score: 0.8839; val_best_f1_score: 0.8887; train_kl_reg_loss: 61938.0380; train_edge_recon_loss: 2711248.4470; train_gene_expr_recon_loss: 10305422.9242; train_masked_gp_l1_reg_loss: 74330.5649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68754.8081; train_chrom_access_recon_loss: 9014267.2879; train_global_loss: 22235961.9091; train_optim_loss: 22235961.9091; val_kl_reg_loss: 50941.8091; val_edge_recon_loss: 2724895.7500; val_gene_expr_recon_loss: 10096907.7500; val_masked_gp_l1_reg_loss: 74329.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68752.8203; val_chrom_access_recon_loss: 8713569.8750; val_global_loss: 21729398.2500; val_optim_loss: 21729398.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9346; val_auprc_score: 0.9114; val_best_acc_score: 0.8745; val_best_f1_score: 0.8814; train_kl_reg_loss: 62031.3568; train_edge_recon_loss: 2706257.9470; train_gene_expr_recon_loss: 10307143.5606; train_masked_gp_l1_reg_loss: 74328.6664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68751.0453; train_chrom_access_recon_loss: 9024052.0758; train_global_loss: 22242564.5758; train_optim_loss: 22242564.5758; val_kl_reg_loss: 50352.8438; val_edge_recon_loss: 2760613.6562; val_gene_expr_recon_loss: 10141026.2500; val_masked_gp_l1_reg_loss: 74327.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68749.5547; val_chrom_access_recon_loss: 8766313.0000; val_global_loss: 21861383.5000; val_optim_loss: 21861383.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9359; val_auprc_score: 0.9089; val_best_acc_score: 0.8804; val_best_f1_score: 0.8866; train_kl_reg_loss: 61986.3388; train_edge_recon_loss: 2712969.1288; train_gene_expr_recon_loss: 10312822.5909; train_masked_gp_l1_reg_loss: 74326.4245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68747.0451; train_chrom_access_recon_loss: 9033298.6061; train_global_loss: 22264150.2727; train_optim_loss: 22264150.2727; val_kl_reg_loss: 51115.9487; val_edge_recon_loss: 2715485.0312; val_gene_expr_recon_loss: 10204000.0000; val_masked_gp_l1_reg_loss: 74325.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68745.2266; val_chrom_access_recon_loss: 8833366.0000; val_global_loss: 21947037.2500; val_optim_loss: 21947037.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9415; val_auprc_score: 0.9143; val_best_acc_score: 0.8839; val_best_f1_score: 0.8895; train_kl_reg_loss: 61990.9986; train_edge_recon_loss: 2717926.0455; train_gene_expr_recon_loss: 10308139.7121; train_masked_gp_l1_reg_loss: 74324.4366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68744.0542; train_chrom_access_recon_loss: 9018876.5455; train_global_loss: 22250001.6970; train_optim_loss: 22250001.6970; val_kl_reg_loss: 50563.9604; val_edge_recon_loss: 2698829.2500; val_gene_expr_recon_loss: 10224461.2500; val_masked_gp_l1_reg_loss: 74323.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68742.2188; val_chrom_access_recon_loss: 8816338.6250; val_global_loss: 21933258.0000; val_optim_loss: 21933258.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9333; val_auprc_score: 0.9028; val_best_acc_score: 0.8751; val_best_f1_score: 0.8813; train_kl_reg_loss: 61997.5461; train_edge_recon_loss: 2715698.9621; train_gene_expr_recon_loss: 10307287.7879; train_masked_gp_l1_reg_loss: 74322.3479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68740.7636; train_chrom_access_recon_loss: 9020181.5606; train_global_loss: 22248228.9697; train_optim_loss: 22248228.9697; val_kl_reg_loss: 51096.1221; val_edge_recon_loss: 2752900.4688; val_gene_expr_recon_loss: 10193165.7500; val_masked_gp_l1_reg_loss: 74321.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68738.7031; val_chrom_access_recon_loss: 8747876.3750; val_global_loss: 21888098.7500; val_optim_loss: 21888098.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9424; val_auprc_score: 0.9203; val_best_acc_score: 0.8837; val_best_f1_score: 0.8880; train_kl_reg_loss: 61939.1354; train_edge_recon_loss: 2715172.5758; train_gene_expr_recon_loss: 10311084.2121; train_masked_gp_l1_reg_loss: 74320.8048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68722.1677; train_chrom_access_recon_loss: 9018544.6061; train_global_loss: 22249783.5758; train_optim_loss: 22249783.5758; val_kl_reg_loss: 50964.2505; val_edge_recon_loss: 2720101.6562; val_gene_expr_recon_loss: 10175233.7500; val_masked_gp_l1_reg_loss: 74320.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68719.0000; val_chrom_access_recon_loss: 8744285.1250; val_global_loss: 21833625.0000; val_optim_loss: 21833625.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9380; val_auprc_score: 0.9131; val_best_acc_score: 0.8831; val_best_f1_score: 0.8888; train_kl_reg_loss: 62030.0949; train_edge_recon_loss: 2708399.8447; train_gene_expr_recon_loss: 10310736.8333; train_masked_gp_l1_reg_loss: 74320.3919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68718.6651; train_chrom_access_recon_loss: 9017937.3333; train_global_loss: 22242143.0909; train_optim_loss: 22242143.0909; val_kl_reg_loss: 49968.0903; val_edge_recon_loss: 2741837.6250; val_gene_expr_recon_loss: 10135531.6250; val_masked_gp_l1_reg_loss: 74320.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68718.3828; val_chrom_access_recon_loss: 8728360.4375; val_global_loss: 21798735.5000; val_optim_loss: 21798735.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9371; val_auprc_score: 0.9128; val_best_acc_score: 0.8791; val_best_f1_score: 0.8839; train_kl_reg_loss: 62069.4341; train_edge_recon_loss: 2702876.0417; train_gene_expr_recon_loss: 10312283.9394; train_masked_gp_l1_reg_loss: 74320.1306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68718.2099; train_chrom_access_recon_loss: 9018828.9242; train_global_loss: 22239096.3636; train_optim_loss: 22239096.3636; val_kl_reg_loss: 50562.6123; val_edge_recon_loss: 2741526.8438; val_gene_expr_recon_loss: 10142073.3750; val_masked_gp_l1_reg_loss: 74320.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68717.9688; val_chrom_access_recon_loss: 8771799.8750; val_global_loss: 21849000.2500; val_optim_loss: 21849000.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9359; val_auprc_score: 0.9050; val_best_acc_score: 0.8788; val_best_f1_score: 0.8852; train_kl_reg_loss: 62051.9173; train_edge_recon_loss: 2713075.3864; train_gene_expr_recon_loss: 10297118.3788; train_masked_gp_l1_reg_loss: 74319.8925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68717.7462; train_chrom_access_recon_loss: 9012866.5606; train_global_loss: 22228150.3030; train_optim_loss: 22228150.3030; val_kl_reg_loss: 50384.0591; val_edge_recon_loss: 2756906.6562; val_gene_expr_recon_loss: 10090831.2500; val_masked_gp_l1_reg_loss: 74319.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68717.5156; val_chrom_access_recon_loss: 8664070.3750; val_global_loss: 21705230.2500; val_optim_loss: 21705230.2500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9459; val_auprc_score: 0.9231; val_best_acc_score: 0.8917; val_best_f1_score: 0.8962; train_kl_reg_loss: 61976.6330; train_edge_recon_loss: 2696490.9545; train_gene_expr_recon_loss: 10306944.8788; train_masked_gp_l1_reg_loss: 74319.6490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68717.3718; train_chrom_access_recon_loss: 9019589.9773; train_global_loss: 22228039.5455; train_optim_loss: 22228039.5455; val_kl_reg_loss: 50826.9707; val_edge_recon_loss: 2703663.5625; val_gene_expr_recon_loss: 10251070.2500; val_masked_gp_l1_reg_loss: 74319.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68717.2188; val_chrom_access_recon_loss: 8830409.1250; val_global_loss: 21979007.0000; val_optim_loss: 21979007.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9447; val_auprc_score: 0.9266; val_best_acc_score: 0.8842; val_best_f1_score: 0.8898; train_kl_reg_loss: 62054.7707; train_edge_recon_loss: 2703965.2538; train_gene_expr_recon_loss: 10314876.2576; train_masked_gp_l1_reg_loss: 74319.4092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68716.9212; train_chrom_access_recon_loss: 9022171.1818; train_global_loss: 22246103.6364; train_optim_loss: 22246103.6364; val_kl_reg_loss: 50468.7534; val_edge_recon_loss: 2718008.0000; val_gene_expr_recon_loss: 10144851.1250; val_masked_gp_l1_reg_loss: 74319.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68716.7500; val_chrom_access_recon_loss: 8688883.6875; val_global_loss: 21745247.5000; val_optim_loss: 21745247.5000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9389; val_auprc_score: 0.9205; val_best_acc_score: 0.8756; val_best_f1_score: 0.8826; train_kl_reg_loss: 62013.2933; train_edge_recon_loss: 2705169.6742; train_gene_expr_recon_loss: 10299831.0455; train_masked_gp_l1_reg_loss: 74319.1763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68716.6115; train_chrom_access_recon_loss: 9015569.3788; train_global_loss: 22225619.1818; train_optim_loss: 22225619.1818; val_kl_reg_loss: 50462.4038; val_edge_recon_loss: 2751129.6562; val_gene_expr_recon_loss: 10163495.5000; val_masked_gp_l1_reg_loss: 74319.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68716.4141; val_chrom_access_recon_loss: 8691055.2500; val_global_loss: 21799178.2500; val_optim_loss: 21799178.2500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9289; val_auprc_score: 0.9041; val_best_acc_score: 0.8710; val_best_f1_score: 0.8787; train_kl_reg_loss: 62103.7341; train_edge_recon_loss: 2710955.2348; train_gene_expr_recon_loss: 10303376.2121; train_masked_gp_l1_reg_loss: 74318.9309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68716.2472; train_chrom_access_recon_loss: 9015373.2424; train_global_loss: 22234843.3636; train_optim_loss: 22234843.3636; val_kl_reg_loss: 51101.0732; val_edge_recon_loss: 2768495.1875; val_gene_expr_recon_loss: 10158937.5000; val_masked_gp_l1_reg_loss: 74318.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68716.0156; val_chrom_access_recon_loss: 8834158.0000; val_global_loss: 21955726.5000; val_optim_loss: 21955726.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9325; val_auprc_score: 0.9010; val_best_acc_score: 0.8772; val_best_f1_score: 0.8844; train_kl_reg_loss: 62048.9550; train_edge_recon_loss: 2698210.8712; train_gene_expr_recon_loss: 10305424.4091; train_masked_gp_l1_reg_loss: 74318.7491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68714.3736; train_chrom_access_recon_loss: 9023077.0758; train_global_loss: 22231794.4848; train_optim_loss: 22231794.4848; val_kl_reg_loss: 50819.4072; val_edge_recon_loss: 2753142.4688; val_gene_expr_recon_loss: 10205399.7500; val_masked_gp_l1_reg_loss: 74318.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68714.0547; val_chrom_access_recon_loss: 8844623.8750; val_global_loss: 21997018.2500; val_optim_loss: 21997018.2500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9415; val_auprc_score: 0.9210; val_best_acc_score: 0.8818; val_best_f1_score: 0.8877; train_kl_reg_loss: 62082.2504; train_edge_recon_loss: 2706850.0492; train_gene_expr_recon_loss: 10290294.6212; train_masked_gp_l1_reg_loss: 74318.7124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68714.0276; train_chrom_access_recon_loss: 9006140.1364; train_global_loss: 22208400.0303; train_optim_loss: 22208400.0303; val_kl_reg_loss: 51289.3335; val_edge_recon_loss: 2731784.9375; val_gene_expr_recon_loss: 10219920.2500; val_masked_gp_l1_reg_loss: 74318.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68714.0000; val_chrom_access_recon_loss: 8826720.2500; val_global_loss: 21972747.2500; val_optim_loss: 21972747.2500
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9375; val_auprc_score: 0.9111; val_best_acc_score: 0.8826; val_best_f1_score: 0.8884; train_kl_reg_loss: 61974.2747; train_edge_recon_loss: 2714406.8182; train_gene_expr_recon_loss: 10296845.3333; train_masked_gp_l1_reg_loss: 74318.6874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68713.9747; train_chrom_access_recon_loss: 9008976.2727; train_global_loss: 22225235.7273; train_optim_loss: 22225235.7273; val_kl_reg_loss: 50635.0405; val_edge_recon_loss: 2740189.7812; val_gene_expr_recon_loss: 10200794.7500; val_masked_gp_l1_reg_loss: 74318.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68713.9531; val_chrom_access_recon_loss: 8832206.0000; val_global_loss: 21966858.7500; val_optim_loss: 21966858.7500
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9384; val_auprc_score: 0.9130; val_best_acc_score: 0.8818; val_best_f1_score: 0.8877; train_kl_reg_loss: 61962.3895; train_edge_recon_loss: 2702808.5530; train_gene_expr_recon_loss: 10300525.5303; train_masked_gp_l1_reg_loss: 74318.6674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68713.9374; train_chrom_access_recon_loss: 9015630.7273; train_global_loss: 22223960.2424; train_optim_loss: 22223960.2424; val_kl_reg_loss: 50782.8525; val_edge_recon_loss: 2757080.3125; val_gene_expr_recon_loss: 10111365.1250; val_masked_gp_l1_reg_loss: 74318.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68713.9141; val_chrom_access_recon_loss: 8698184.5625; val_global_loss: 21760445.7500; val_optim_loss: 21760445.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 10 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9347
val AUPRC score: 0.9051
val best accuracy score: 0.8812
val best F1 score: 0.8872
val target rna MSE score: 2.4669
val source rna MSE score: 1.1221
val target atac MSE score: 0.3077
val source atac MSE score: 0.1305
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
