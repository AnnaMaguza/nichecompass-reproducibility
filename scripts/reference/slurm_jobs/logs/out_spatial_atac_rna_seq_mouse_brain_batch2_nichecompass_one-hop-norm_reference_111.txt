[True]
Run timestamp: 07082023_205654_111.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_111']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8942; val_auprc_score: 0.9057; val_best_acc_score: 0.5132; val_best_f1_score: 0.6725; train_kl_reg_loss: 46527.8524; train_edge_recon_loss: 3477925.5278; train_gene_expr_recon_loss: 1274294.4167; train_masked_gp_l1_reg_loss: 4705.5655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167309.9010; train_chrom_access_recon_loss: 2816972.5556; train_global_loss: 7787735.7222; train_optim_loss: 7787735.7222; val_kl_reg_loss: 14217.8750; val_edge_recon_loss: 4064618.2500; val_gene_expr_recon_loss: 1052262.7500; val_masked_gp_l1_reg_loss: 4378.2349; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163175.1406; val_chrom_access_recon_loss: 1613924.5000; val_global_loss: 6912576.5000; val_optim_loss: 6912576.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8908; val_auprc_score: 0.9009; val_best_acc_score: 0.5124; val_best_f1_score: 0.6721; train_kl_reg_loss: 13933.2763; train_edge_recon_loss: 3477170.4444; train_gene_expr_recon_loss: 988317.7500; train_masked_gp_l1_reg_loss: 4345.4230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160645.9948; train_chrom_access_recon_loss: 1525695.8333; train_global_loss: 6170108.5556; train_optim_loss: 6170108.5556; val_kl_reg_loss: 13699.0527; val_edge_recon_loss: 4064764.5000; val_gene_expr_recon_loss: 880585.7500; val_masked_gp_l1_reg_loss: 4368.9971; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157554.3438; val_chrom_access_recon_loss: 1393871.6250; val_global_loss: 6514844.0000; val_optim_loss: 6514844.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8903; val_auprc_score: 0.9059; val_best_acc_score: 0.5117; val_best_f1_score: 0.6718; train_kl_reg_loss: 16464.7993; train_edge_recon_loss: 3479226.9167; train_gene_expr_recon_loss: 859963.7569; train_masked_gp_l1_reg_loss: 4462.0794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154951.9375; train_chrom_access_recon_loss: 1411972.3889; train_global_loss: 5927042.0000; train_optim_loss: 5927042.0000; val_kl_reg_loss: 16640.3828; val_edge_recon_loss: 4064950.0000; val_gene_expr_recon_loss: 807232.7500; val_masked_gp_l1_reg_loss: 4578.2964; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151488.5781; val_chrom_access_recon_loss: 1356909.6250; val_global_loss: 6401799.5000; val_optim_loss: 6401799.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8843; val_auprc_score: 0.8987; val_best_acc_score: 0.5155; val_best_f1_score: 0.6734; train_kl_reg_loss: 17900.9201; train_edge_recon_loss: 3481073.8333; train_gene_expr_recon_loss: 806156.6389; train_masked_gp_l1_reg_loss: 4634.1275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148328.2708; train_chrom_access_recon_loss: 1379411.5000; train_global_loss: 5837505.2222; train_optim_loss: 5837505.2222; val_kl_reg_loss: 17204.1445; val_edge_recon_loss: 4064714.0000; val_gene_expr_recon_loss: 775692.5000; val_masked_gp_l1_reg_loss: 4673.1865; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144163.4531; val_chrom_access_recon_loss: 1338275.3750; val_global_loss: 6344723.0000; val_optim_loss: 6344723.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8708; val_auprc_score: 0.8878; val_best_acc_score: 0.5256; val_best_f1_score: 0.6775; train_kl_reg_loss: 19576.9601; train_edge_recon_loss: 3481340.6389; train_gene_expr_recon_loss: 784620.2917; train_masked_gp_l1_reg_loss: 4674.4696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140590.0278; train_chrom_access_recon_loss: 1364824.2083; train_global_loss: 5795626.5000; train_optim_loss: 5795626.5000; val_kl_reg_loss: 16388.3516; val_edge_recon_loss: 4063766.2500; val_gene_expr_recon_loss: 755096.7500; val_masked_gp_l1_reg_loss: 4665.0552; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136036.0000; val_chrom_access_recon_loss: 1327391.6250; val_global_loss: 6303343.5000; val_optim_loss: 6303343.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8535; val_auprc_score: 0.8673; val_best_acc_score: 0.5384; val_best_f1_score: 0.6817; train_kl_reg_loss: 20875.3342; train_edge_recon_loss: 3481856.1111; train_gene_expr_recon_loss: 762863.0486; train_masked_gp_l1_reg_loss: 4655.9405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132333.3585; train_chrom_access_recon_loss: 1356329.6528; train_global_loss: 5758913.2778; train_optim_loss: 5758913.2778; val_kl_reg_loss: 19183.0000; val_edge_recon_loss: 4061844.0000; val_gene_expr_recon_loss: 736705.2500; val_masked_gp_l1_reg_loss: 4642.0298; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127689.6094; val_chrom_access_recon_loss: 1319547.7500; val_global_loss: 6269611.0000; val_optim_loss: 6269611.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8493; val_auprc_score: 0.8596; val_best_acc_score: 0.5488; val_best_f1_score: 0.6836; train_kl_reg_loss: 22206.7643; train_edge_recon_loss: 3482835.5278; train_gene_expr_recon_loss: 751583.0486; train_masked_gp_l1_reg_loss: 4636.3749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123990.6441; train_chrom_access_recon_loss: 1352549.9861; train_global_loss: 5737802.3889; train_optim_loss: 5737802.3889; val_kl_reg_loss: 20032.2402; val_edge_recon_loss: 4058223.0000; val_gene_expr_recon_loss: 724308.8750; val_masked_gp_l1_reg_loss: 4628.7349; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119393.2656; val_chrom_access_recon_loss: 1313489.7500; val_global_loss: 6240076.0000; val_optim_loss: 6240076.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8413; val_auprc_score: 0.8500; val_best_acc_score: 0.6229; val_best_f1_score: 0.7183; train_kl_reg_loss: 23001.1445; train_edge_recon_loss: 3481405.5833; train_gene_expr_recon_loss: 734785.2361; train_masked_gp_l1_reg_loss: 4634.6465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115791.6363; train_chrom_access_recon_loss: 1347554.4722; train_global_loss: 5707172.6111; train_optim_loss: 5707172.6111; val_kl_reg_loss: 21261.6836; val_edge_recon_loss: 4048326.2500; val_gene_expr_recon_loss: 711804.0000; val_masked_gp_l1_reg_loss: 4640.1934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111349.7500; val_chrom_access_recon_loss: 1308098.7500; val_global_loss: 6205481.0000; val_optim_loss: 6205481.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8374; val_auprc_score: 0.8286; val_best_acc_score: 0.7340; val_best_f1_score: 0.7753; train_kl_reg_loss: 23110.1122; train_edge_recon_loss: 3480893.2778; train_gene_expr_recon_loss: 729719.1736; train_masked_gp_l1_reg_loss: 4652.4514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107916.1293; train_chrom_access_recon_loss: 1338332.2083; train_global_loss: 5684623.2778; train_optim_loss: 5684623.2778; val_kl_reg_loss: 19340.5859; val_edge_recon_loss: 4021799.7500; val_gene_expr_recon_loss: 703939.8750; val_masked_gp_l1_reg_loss: 4665.3960; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103705.6406; val_chrom_access_recon_loss: 1303800.2500; val_global_loss: 6157251.0000; val_optim_loss: 6157251.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8374; val_auprc_score: 0.8177; val_best_acc_score: 0.7573; val_best_f1_score: 0.7680; train_kl_reg_loss: 21187.0668; train_edge_recon_loss: 3474751.0278; train_gene_expr_recon_loss: 718907.3681; train_masked_gp_l1_reg_loss: 4686.2899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100493.7934; train_chrom_access_recon_loss: 1337932.8056; train_global_loss: 5657958.3333; train_optim_loss: 5657958.3333; val_kl_reg_loss: 16683.4648; val_edge_recon_loss: 3944259.0000; val_gene_expr_recon_loss: 699613.3125; val_masked_gp_l1_reg_loss: 4707.5190; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96570.3906; val_chrom_access_recon_loss: 1300668.2500; val_global_loss: 6062502.0000; val_optim_loss: 6062502.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8491; val_auprc_score: 0.8185; val_best_acc_score: 0.7794; val_best_f1_score: 0.8031; train_kl_reg_loss: 15416.5651; train_edge_recon_loss: 3447388.9722; train_gene_expr_recon_loss: 718140.9514; train_masked_gp_l1_reg_loss: 4739.3076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93594.8646; train_chrom_access_recon_loss: 1333300.9722; train_global_loss: 5612581.5556; train_optim_loss: 5612581.5556; val_kl_reg_loss: 10403.2100; val_edge_recon_loss: 3645503.5000; val_gene_expr_recon_loss: 708898.6250; val_masked_gp_l1_reg_loss: 4782.1553; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89984.3359; val_chrom_access_recon_loss: 1301765.6250; val_global_loss: 5761337.5000; val_optim_loss: 5761337.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8381; val_auprc_score: 0.8188; val_best_acc_score: 0.7518; val_best_f1_score: 0.7845; train_kl_reg_loss: 8661.3895; train_edge_recon_loss: 3258454.5278; train_gene_expr_recon_loss: 747060.1597; train_masked_gp_l1_reg_loss: 4851.8667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87317.7326; train_chrom_access_recon_loss: 1336649.1389; train_global_loss: 5442994.7778; train_optim_loss: 5442994.7778; val_kl_reg_loss: 11039.5879; val_edge_recon_loss: 3021050.5000; val_gene_expr_recon_loss: 770143.4375; val_masked_gp_l1_reg_loss: 4979.7056; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84139.8906; val_chrom_access_recon_loss: 1318672.2500; val_global_loss: 5210025.5000; val_optim_loss: 5210025.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8422; val_auprc_score: 0.8278; val_best_acc_score: 0.7458; val_best_f1_score: 0.7825; train_kl_reg_loss: 19279.5322; train_edge_recon_loss: 2975579.9444; train_gene_expr_recon_loss: 781868.1944; train_masked_gp_l1_reg_loss: 5120.9607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81810.5790; train_chrom_access_recon_loss: 1349464.2361; train_global_loss: 5213123.4444; train_optim_loss: 5213123.4444; val_kl_reg_loss: 29698.0469; val_edge_recon_loss: 2932988.0000; val_gene_expr_recon_loss: 749883.2500; val_masked_gp_l1_reg_loss: 5272.7090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78962.4531; val_chrom_access_recon_loss: 1309098.2500; val_global_loss: 5105903.0000; val_optim_loss: 5105903.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8475; val_auprc_score: 0.8331; val_best_acc_score: 0.7530; val_best_f1_score: 0.7810; train_kl_reg_loss: 34985.3001; train_edge_recon_loss: 2920136.0833; train_gene_expr_recon_loss: 750525.6944; train_masked_gp_l1_reg_loss: 5327.4527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76787.2483; train_chrom_access_recon_loss: 1340850.5417; train_global_loss: 5128612.4444; train_optim_loss: 5128612.4444; val_kl_reg_loss: 39560.9062; val_edge_recon_loss: 2939603.0000; val_gene_expr_recon_loss: 725547.2500; val_masked_gp_l1_reg_loss: 5358.4404; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74112.5469; val_chrom_access_recon_loss: 1302441.5000; val_global_loss: 5086624.0000; val_optim_loss: 5086624.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8486; val_auprc_score: 0.8339; val_best_acc_score: 0.7559; val_best_f1_score: 0.7798; train_kl_reg_loss: 43098.8446; train_edge_recon_loss: 2894155.0278; train_gene_expr_recon_loss: 736392.9375; train_masked_gp_l1_reg_loss: 5346.2691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72074.1997; train_chrom_access_recon_loss: 1335035.2500; train_global_loss: 5086102.4444; train_optim_loss: 5086102.4444; val_kl_reg_loss: 44372.6875; val_edge_recon_loss: 2964993.7500; val_gene_expr_recon_loss: 708748.9375; val_masked_gp_l1_reg_loss: 5323.2744; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69576.8047; val_chrom_access_recon_loss: 1296488.2500; val_global_loss: 5089504.0000; val_optim_loss: 5089504.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8668; val_auprc_score: 0.8500; val_best_acc_score: 0.7722; val_best_f1_score: 0.7914; train_kl_reg_loss: 46375.4549; train_edge_recon_loss: 2877644.1667; train_gene_expr_recon_loss: 722317.5833; train_masked_gp_l1_reg_loss: 5309.9982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67674.7274; train_chrom_access_recon_loss: 1327211.6667; train_global_loss: 5046533.5556; train_optim_loss: 5046533.5556; val_kl_reg_loss: 44892.2578; val_edge_recon_loss: 2881238.5000; val_gene_expr_recon_loss: 702398.5000; val_masked_gp_l1_reg_loss: 5292.2354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65351.6836; val_chrom_access_recon_loss: 1293179.0000; val_global_loss: 4992352.0000; val_optim_loss: 4992352.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8754; val_auprc_score: 0.8553; val_best_acc_score: 0.7844; val_best_f1_score: 0.8044; train_kl_reg_loss: 45107.7010; train_edge_recon_loss: 2867775.1111; train_gene_expr_recon_loss: 719128.4722; train_masked_gp_l1_reg_loss: 5283.9172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63604.8190; train_chrom_access_recon_loss: 1321475.6667; train_global_loss: 5022375.6667; train_optim_loss: 5022375.6667; val_kl_reg_loss: 42272.7891; val_edge_recon_loss: 2857840.0000; val_gene_expr_recon_loss: 701741.1250; val_masked_gp_l1_reg_loss: 5277.6050; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61463.9102; val_chrom_access_recon_loss: 1291973.7500; val_global_loss: 4960569.0000; val_optim_loss: 4960569.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8933; val_auprc_score: 0.8704; val_best_acc_score: 0.8116; val_best_f1_score: 0.8301; train_kl_reg_loss: 41517.7448; train_edge_recon_loss: 2827364.5833; train_gene_expr_recon_loss: 718181.3125; train_masked_gp_l1_reg_loss: 5283.9074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59868.5603; train_chrom_access_recon_loss: 1323031.0694; train_global_loss: 4975247.1667; train_optim_loss: 4975247.1667; val_kl_reg_loss: 38544.3984; val_edge_recon_loss: 2834787.0000; val_gene_expr_recon_loss: 699766.3125; val_masked_gp_l1_reg_loss: 5291.7041; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57929.7227; val_chrom_access_recon_loss: 1288863.7500; val_global_loss: 4925183.0000; val_optim_loss: 4925183.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9064; val_auprc_score: 0.8723; val_best_acc_score: 0.8464; val_best_f1_score: 0.8592; train_kl_reg_loss: 40354.6966; train_edge_recon_loss: 2787468.1944; train_gene_expr_recon_loss: 714939.1944; train_masked_gp_l1_reg_loss: 5305.5120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56481.0208; train_chrom_access_recon_loss: 1316701.3194; train_global_loss: 4921249.8333; train_optim_loss: 4921249.8333; val_kl_reg_loss: 39972.9844; val_edge_recon_loss: 2793882.7500; val_gene_expr_recon_loss: 694727.5000; val_masked_gp_l1_reg_loss: 5318.3799; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54719.4727; val_chrom_access_recon_loss: 1285629.0000; val_global_loss: 4874250.0000; val_optim_loss: 4874250.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9254; val_auprc_score: 0.8961; val_best_acc_score: 0.8713; val_best_f1_score: 0.8804; train_kl_reg_loss: 42134.1775; train_edge_recon_loss: 2772965.2500; train_gene_expr_recon_loss: 707727.4028; train_masked_gp_l1_reg_loss: 5326.5333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53386.9297; train_chrom_access_recon_loss: 1320228.0556; train_global_loss: 4901768.4444; train_optim_loss: 4901768.4444; val_kl_reg_loss: 42010.6797; val_edge_recon_loss: 2757815.5000; val_gene_expr_recon_loss: 691347.5000; val_masked_gp_l1_reg_loss: 5338.6577; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51772.5195; val_chrom_access_recon_loss: 1282713.3750; val_global_loss: 4830998.5000; val_optim_loss: 4830998.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9315; val_auprc_score: 0.9083; val_best_acc_score: 0.8790; val_best_f1_score: 0.8863; train_kl_reg_loss: 43197.4648; train_edge_recon_loss: 2749627.8056; train_gene_expr_recon_loss: 704026.6667; train_masked_gp_l1_reg_loss: 5345.6750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50552.7157; train_chrom_access_recon_loss: 1315921.6944; train_global_loss: 4868672.1111; train_optim_loss: 4868672.1111; val_kl_reg_loss: 42295.1055; val_edge_recon_loss: 2747697.2500; val_gene_expr_recon_loss: 690052.7500; val_masked_gp_l1_reg_loss: 5355.1611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49069.8086; val_chrom_access_recon_loss: 1280838.3750; val_global_loss: 4815308.5000; val_optim_loss: 4815308.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9420; val_auprc_score: 0.9180; val_best_acc_score: 0.8883; val_best_f1_score: 0.8946; train_kl_reg_loss: 44832.6280; train_edge_recon_loss: 2727656.2500; train_gene_expr_recon_loss: 704182.1181; train_masked_gp_l1_reg_loss: 5366.2886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47956.1076; train_chrom_access_recon_loss: 1312979.4306; train_global_loss: 4842972.8333; train_optim_loss: 4842972.8333; val_kl_reg_loss: 43188.2461; val_edge_recon_loss: 2723475.7500; val_gene_expr_recon_loss: 687761.8750; val_masked_gp_l1_reg_loss: 5376.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46592.3828; val_chrom_access_recon_loss: 1278727.6250; val_global_loss: 4785122.5000; val_optim_loss: 4785122.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9417; val_auprc_score: 0.9194; val_best_acc_score: 0.8907; val_best_f1_score: 0.8973; train_kl_reg_loss: 44812.8307; train_edge_recon_loss: 2732525.2222; train_gene_expr_recon_loss: 700423.1458; train_masked_gp_l1_reg_loss: 5385.9434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45570.8989; train_chrom_access_recon_loss: 1314153.0278; train_global_loss: 4842871.2778; train_optim_loss: 4842871.2778; val_kl_reg_loss: 43019.1875; val_edge_recon_loss: 2715503.2500; val_gene_expr_recon_loss: 684148.3125; val_masked_gp_l1_reg_loss: 5391.4287; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44316.9375; val_chrom_access_recon_loss: 1275576.1250; val_global_loss: 4767955.5000; val_optim_loss: 4767955.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9446; val_auprc_score: 0.9227; val_best_acc_score: 0.8911; val_best_f1_score: 0.8979; train_kl_reg_loss: 44196.0069; train_edge_recon_loss: 2722887.9167; train_gene_expr_recon_loss: 698867.9097; train_masked_gp_l1_reg_loss: 5400.9010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43383.5634; train_chrom_access_recon_loss: 1307576.4583; train_global_loss: 4822312.6667; train_optim_loss: 4822312.6667; val_kl_reg_loss: 41912.2422; val_edge_recon_loss: 2723283.2500; val_gene_expr_recon_loss: 677901.1875; val_masked_gp_l1_reg_loss: 5409.4556; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42232.5977; val_chrom_access_recon_loss: 1273046.0000; val_global_loss: 4763785.0000; val_optim_loss: 4763785.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9427; val_auprc_score: 0.9199; val_best_acc_score: 0.8905; val_best_f1_score: 0.8976; train_kl_reg_loss: 43181.1020; train_edge_recon_loss: 2724054.4167; train_gene_expr_recon_loss: 695884.0208; train_masked_gp_l1_reg_loss: 5419.9571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41353.2470; train_chrom_access_recon_loss: 1306183.3611; train_global_loss: 4816076.2222; train_optim_loss: 4816076.2222; val_kl_reg_loss: 41198.8750; val_edge_recon_loss: 2734812.7500; val_gene_expr_recon_loss: 676404.2500; val_masked_gp_l1_reg_loss: 5427.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40290.8906; val_chrom_access_recon_loss: 1271403.2500; val_global_loss: 4769537.5000; val_optim_loss: 4769537.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9463; val_auprc_score: 0.9257; val_best_acc_score: 0.8922; val_best_f1_score: 0.8981; train_kl_reg_loss: 40967.3841; train_edge_recon_loss: 2713100.8333; train_gene_expr_recon_loss: 993706.2847; train_masked_gp_l1_reg_loss: 5467.5095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39234.0781; train_chrom_access_recon_loss: 1368910.3333; train_global_loss: 5161386.2778; train_optim_loss: 5161386.2778; val_kl_reg_loss: 26976.7539; val_edge_recon_loss: 2737644.2500; val_gene_expr_recon_loss: 969770.8750; val_masked_gp_l1_reg_loss: 5525.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37800.6875; val_chrom_access_recon_loss: 1340355.5000; val_global_loss: 5118074.0000; val_optim_loss: 5118074.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9483; val_auprc_score: 0.9254; val_best_acc_score: 0.8989; val_best_f1_score: 0.9039; train_kl_reg_loss: 36424.7530; train_edge_recon_loss: 2708146.8056; train_gene_expr_recon_loss: 998574.7500; train_masked_gp_l1_reg_loss: 5583.1254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36589.2539; train_chrom_access_recon_loss: 1374129.7778; train_global_loss: 5159448.5556; train_optim_loss: 5159448.5556; val_kl_reg_loss: 25387.1211; val_edge_recon_loss: 2708905.7500; val_gene_expr_recon_loss: 968591.1250; val_masked_gp_l1_reg_loss: 5654.1982; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35085.5898; val_chrom_access_recon_loss: 1338989.6250; val_global_loss: 5082613.5000; val_optim_loss: 5082613.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9538; val_auprc_score: 0.9361; val_best_acc_score: 0.9047; val_best_f1_score: 0.9090; train_kl_reg_loss: 36056.8442; train_edge_recon_loss: 2718181.1111; train_gene_expr_recon_loss: 994784.4722; train_masked_gp_l1_reg_loss: 5718.4146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33932.8932; train_chrom_access_recon_loss: 1379008.6250; train_global_loss: 5167682.2778; train_optim_loss: 5167682.2778; val_kl_reg_loss: 26317.5938; val_edge_recon_loss: 2701076.7500; val_gene_expr_recon_loss: 962263.6250; val_masked_gp_l1_reg_loss: 5792.9434; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32531.1992; val_chrom_access_recon_loss: 1336708.5000; val_global_loss: 5064691.0000; val_optim_loss: 5064691.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9520; val_auprc_score: 0.9343; val_best_acc_score: 0.9000; val_best_f1_score: 0.9057; train_kl_reg_loss: 35623.9735; train_edge_recon_loss: 2704926.6389; train_gene_expr_recon_loss: 981539.6944; train_masked_gp_l1_reg_loss: 5790.3917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32339.7984; train_chrom_access_recon_loss: 1367868.8750; train_global_loss: 5128089.3889; train_optim_loss: 5128089.3889; val_kl_reg_loss: 26426.8926; val_edge_recon_loss: 2722234.7500; val_gene_expr_recon_loss: 965349.4375; val_masked_gp_l1_reg_loss: 5785.8403; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32121.1543; val_chrom_access_recon_loss: 1337137.6250; val_global_loss: 5089056.0000; val_optim_loss: 5089056.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9537; val_auprc_score: 0.9334; val_best_acc_score: 0.9078; val_best_f1_score: 0.9121; train_kl_reg_loss: 35705.9948; train_edge_recon_loss: 2705683.6389; train_gene_expr_recon_loss: 987429.9861; train_masked_gp_l1_reg_loss: 5784.9463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31977.8455; train_chrom_access_recon_loss: 1372674.6111; train_global_loss: 5139257.0556; train_optim_loss: 5139257.0556; val_kl_reg_loss: 26213.5488; val_edge_recon_loss: 2706676.5000; val_gene_expr_recon_loss: 963344.3750; val_masked_gp_l1_reg_loss: 5783.7744; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31795.0879; val_chrom_access_recon_loss: 1336769.8750; val_global_loss: 5070583.0000; val_optim_loss: 5070583.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9548; val_auprc_score: 0.9353; val_best_acc_score: 0.9061; val_best_f1_score: 0.9105; train_kl_reg_loss: 35317.7313; train_edge_recon_loss: 2717809.0000; train_gene_expr_recon_loss: 986874.3542; train_masked_gp_l1_reg_loss: 5784.2741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31660.2589; train_chrom_access_recon_loss: 1367508.6667; train_global_loss: 5144954.1667; train_optim_loss: 5144954.1667; val_kl_reg_loss: 25972.7734; val_edge_recon_loss: 2716357.5000; val_gene_expr_recon_loss: 964285.6250; val_masked_gp_l1_reg_loss: 5785.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31494.8438; val_chrom_access_recon_loss: 1337206.0000; val_global_loss: 5081103.0000; val_optim_loss: 5081103.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9529; val_auprc_score: 0.9280; val_best_acc_score: 0.9019; val_best_f1_score: 0.9076; train_kl_reg_loss: 35077.7786; train_edge_recon_loss: 2706174.6111; train_gene_expr_recon_loss: 987431.6319; train_masked_gp_l1_reg_loss: 5788.5553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31369.9490; train_chrom_access_recon_loss: 1371848.6111; train_global_loss: 5137691.1667; train_optim_loss: 5137691.1667; val_kl_reg_loss: 25686.7656; val_edge_recon_loss: 2722959.2500; val_gene_expr_recon_loss: 963391.2500; val_masked_gp_l1_reg_loss: 5791.7847; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31220.5000; val_chrom_access_recon_loss: 1336859.0000; val_global_loss: 5085908.5000; val_optim_loss: 5085908.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 56 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9401
val AUPRC score: 0.9152
val best accuracy score: 0.8890
val best F1 score: 0.8950
val target rna MSE score: 3.6853
val source rna MSE score: 3.0335
val target atac MSE score: 0.1337
val source atac MSE score: 0.0207
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
