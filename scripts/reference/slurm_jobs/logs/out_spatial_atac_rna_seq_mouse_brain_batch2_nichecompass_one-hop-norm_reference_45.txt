[True]
Run timestamp: 07082023_184228_45.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_45']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9094; val_auprc_score: 0.9244; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 9382.6061; train_edge_recon_loss: 35997.5994; train_gene_expr_recon_loss: 1160566.1597; train_masked_gp_l1_reg_loss: 15925.3645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167090.2917; train_chrom_access_recon_loss: 768430.7535; train_global_loss: 2157392.7778; train_optim_loss: 2157392.7778; val_kl_reg_loss: 7115.2461; val_edge_recon_loss: 40657.8945; val_gene_expr_recon_loss: 974016.8750; val_masked_gp_l1_reg_loss: 11071.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162703.5000; val_chrom_access_recon_loss: 506930.9062; val_global_loss: 1702495.6250; val_optim_loss: 1702495.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9062; val_auprc_score: 0.9197; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 9541.7865; train_edge_recon_loss: 37220.4102; train_gene_expr_recon_loss: 885617.5694; train_masked_gp_l1_reg_loss: 9471.2751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159869.5122; train_chrom_access_recon_loss: 489066.6528; train_global_loss: 1590787.1944; train_optim_loss: 1590787.1944; val_kl_reg_loss: 13844.9170; val_edge_recon_loss: 40659.8203; val_gene_expr_recon_loss: 827905.6250; val_masked_gp_l1_reg_loss: 8573.8760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156287.9688; val_chrom_access_recon_loss: 471321.3438; val_global_loss: 1518593.6250; val_optim_loss: 1518593.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8944; val_auprc_score: 0.9068; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 16199.9255; train_edge_recon_loss: 38306.6350; train_gene_expr_recon_loss: 791162.4375; train_masked_gp_l1_reg_loss: 9025.7038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153166.0990; train_chrom_access_recon_loss: 465163.7708; train_global_loss: 1473024.5694; train_optim_loss: 1473024.5694; val_kl_reg_loss: 16901.4902; val_edge_recon_loss: 40658.6172; val_gene_expr_recon_loss: 771311.3750; val_masked_gp_l1_reg_loss: 9363.2822; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149022.8594; val_chrom_access_recon_loss: 456578.9688; val_global_loss: 1443836.6250; val_optim_loss: 1443836.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8884; val_auprc_score: 0.9008; val_best_acc_score: 0.5096; val_best_f1_score: 0.6709; train_kl_reg_loss: 19095.9818; train_edge_recon_loss: 38623.0204; train_gene_expr_recon_loss: 745851.1806; train_masked_gp_l1_reg_loss: 9328.5446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145360.8472; train_chrom_access_recon_loss: 455135.9271; train_global_loss: 1413395.4722; train_optim_loss: 1413395.4722; val_kl_reg_loss: 18774.7188; val_edge_recon_loss: 40655.0586; val_gene_expr_recon_loss: 739753.3750; val_masked_gp_l1_reg_loss: 9324.4199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140592.0312; val_chrom_access_recon_loss: 450738.3750; val_global_loss: 1399838.0000; val_optim_loss: 1399838.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8795; val_auprc_score: 0.8897; val_best_acc_score: 0.5148; val_best_f1_score: 0.6730; train_kl_reg_loss: 20095.9677; train_edge_recon_loss: 38729.9015; train_gene_expr_recon_loss: 717389.7569; train_masked_gp_l1_reg_loss: 9347.0392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136585.3333; train_chrom_access_recon_loss: 448714.0104; train_global_loss: 1370862.0139; train_optim_loss: 1370862.0139; val_kl_reg_loss: 19752.1719; val_edge_recon_loss: 40648.9922; val_gene_expr_recon_loss: 719535.2500; val_masked_gp_l1_reg_loss: 9338.5605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131502.0156; val_chrom_access_recon_loss: 446999.6562; val_global_loss: 1367776.6250; val_optim_loss: 1367776.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8839; val_auprc_score: 0.8888; val_best_acc_score: 0.5203; val_best_f1_score: 0.6747; train_kl_reg_loss: 20204.3674; train_edge_recon_loss: 38777.6454; train_gene_expr_recon_loss: 702031.1458; train_masked_gp_l1_reg_loss: 9321.2638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127403.2396; train_chrom_access_recon_loss: 446135.1250; train_global_loss: 1343872.7778; train_optim_loss: 1343872.7778; val_kl_reg_loss: 19612.9922; val_edge_recon_loss: 40638.9258; val_gene_expr_recon_loss: 705786.6250; val_masked_gp_l1_reg_loss: 9287.9873; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122293.9375; val_chrom_access_recon_loss: 444288.5312; val_global_loss: 1341909.0000; val_optim_loss: 1341909.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8826; val_auprc_score: 0.8896; val_best_acc_score: 0.5340; val_best_f1_score: 0.6803; train_kl_reg_loss: 20517.5755; train_edge_recon_loss: 38794.5681; train_gene_expr_recon_loss: 693345.5556; train_masked_gp_l1_reg_loss: 9262.7969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118265.7665; train_chrom_access_recon_loss: 444498.2500; train_global_loss: 1324684.5000; train_optim_loss: 1324684.5000; val_kl_reg_loss: 20493.1914; val_edge_recon_loss: 40628.1016; val_gene_expr_recon_loss: 694401.0000; val_masked_gp_l1_reg_loss: 9220.2178; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113288.0078; val_chrom_access_recon_loss: 442174.0625; val_global_loss: 1320204.5000; val_optim_loss: 1320204.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8782; val_auprc_score: 0.8853; val_best_acc_score: 0.5551; val_best_f1_score: 0.6883; train_kl_reg_loss: 21122.6567; train_edge_recon_loss: 38855.5495; train_gene_expr_recon_loss: 683588.8750; train_masked_gp_l1_reg_loss: 9186.0053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109422.2361; train_chrom_access_recon_loss: 442340.3056; train_global_loss: 1304515.6111; train_optim_loss: 1304515.6111; val_kl_reg_loss: 20344.0059; val_edge_recon_loss: 40605.0117; val_gene_expr_recon_loss: 686605.1250; val_masked_gp_l1_reg_loss: 9139.3379; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104676.1719; val_chrom_access_recon_loss: 440679.5000; val_global_loss: 1302049.1250; val_optim_loss: 1302049.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8762; val_auprc_score: 0.8766; val_best_acc_score: 0.5698; val_best_f1_score: 0.6944; train_kl_reg_loss: 21577.4319; train_edge_recon_loss: 38895.2804; train_gene_expr_recon_loss: 676736.3542; train_masked_gp_l1_reg_loss: 9106.0800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101044.6111; train_chrom_access_recon_loss: 441453.1215; train_global_loss: 1288812.8472; train_optim_loss: 1288812.8472; val_kl_reg_loss: 20899.5000; val_edge_recon_loss: 40594.9062; val_gene_expr_recon_loss: 679310.7500; val_masked_gp_l1_reg_loss: 9064.0215; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96600.5625; val_chrom_access_recon_loss: 439334.3750; val_global_loss: 1285804.0000; val_optim_loss: 1285804.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8840; val_auprc_score: 0.8854; val_best_acc_score: 0.6128; val_best_f1_score: 0.7154; train_kl_reg_loss: 21600.6348; train_edge_recon_loss: 38909.7396; train_gene_expr_recon_loss: 669252.9236; train_masked_gp_l1_reg_loss: 9037.3380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93225.6146; train_chrom_access_recon_loss: 439449.4653; train_global_loss: 1271475.7083; train_optim_loss: 1271475.7083; val_kl_reg_loss: 21037.6016; val_edge_recon_loss: 40565.1523; val_gene_expr_recon_loss: 674021.1250; val_masked_gp_l1_reg_loss: 8998.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89121.5312; val_chrom_access_recon_loss: 437962.6875; val_global_loss: 1271707.0000; val_optim_loss: 1271707.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8918; val_auprc_score: 0.8932; val_best_acc_score: 0.6586; val_best_f1_score: 0.7394; train_kl_reg_loss: 21628.3585; train_edge_recon_loss: 38899.9167; train_gene_expr_recon_loss: 660416.2431; train_masked_gp_l1_reg_loss: 8975.1474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86035.1580; train_chrom_access_recon_loss: 439064.1667; train_global_loss: 1255018.9583; train_optim_loss: 1255018.9583; val_kl_reg_loss: 21073.7793; val_edge_recon_loss: 40543.0156; val_gene_expr_recon_loss: 669725.6250; val_masked_gp_l1_reg_loss: 8945.2432; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82297.1250; val_chrom_access_recon_loss: 436861.8750; val_global_loss: 1259446.7500; val_optim_loss: 1259446.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8995; val_auprc_score: 0.9025; val_best_acc_score: 0.7014; val_best_f1_score: 0.7631; train_kl_reg_loss: 21632.1415; train_edge_recon_loss: 38891.8186; train_gene_expr_recon_loss: 663169.0694; train_masked_gp_l1_reg_loss: 8926.8384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79514.0790; train_chrom_access_recon_loss: 438476.6875; train_global_loss: 1250610.6250; train_optim_loss: 1250610.6250; val_kl_reg_loss: 20589.1562; val_edge_recon_loss: 40512.7969; val_gene_expr_recon_loss: 666795.1250; val_masked_gp_l1_reg_loss: 8903.3252; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76145.8125; val_chrom_access_recon_loss: 435977.4375; val_global_loss: 1248923.6250; val_optim_loss: 1248923.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9055; val_auprc_score: 0.9036; val_best_acc_score: 0.7435; val_best_f1_score: 0.7877; train_kl_reg_loss: 21333.5454; train_edge_recon_loss: 38869.7682; train_gene_expr_recon_loss: 658132.3403; train_masked_gp_l1_reg_loss: 8894.1234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73635.3741; train_chrom_access_recon_loss: 437034.0312; train_global_loss: 1237899.1806; train_optim_loss: 1237899.1806; val_kl_reg_loss: 20471.2578; val_edge_recon_loss: 40469.8984; val_gene_expr_recon_loss: 663877.1875; val_masked_gp_l1_reg_loss: 8880.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70601.5703; val_chrom_access_recon_loss: 434938.3438; val_global_loss: 1239238.5000; val_optim_loss: 1239238.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9156; val_auprc_score: 0.9160; val_best_acc_score: 0.7883; val_best_f1_score: 0.8160; train_kl_reg_loss: 21033.4701; train_edge_recon_loss: 38835.4757; train_gene_expr_recon_loss: 653434.0069; train_masked_gp_l1_reg_loss: 8872.0796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68346.5642; train_chrom_access_recon_loss: 434757.9931; train_global_loss: 1225279.5833; train_optim_loss: 1225279.5833; val_kl_reg_loss: 20419.8613; val_edge_recon_loss: 40424.9531; val_gene_expr_recon_loss: 661218.0000; val_masked_gp_l1_reg_loss: 8865.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65600.1484; val_chrom_access_recon_loss: 434194.0938; val_global_loss: 1230722.2500; val_optim_loss: 1230722.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9156; val_auprc_score: 0.9107; val_best_acc_score: 0.8216; val_best_f1_score: 0.8366; train_kl_reg_loss: 20824.3932; train_edge_recon_loss: 38781.7274; train_gene_expr_recon_loss: 653350.9375; train_masked_gp_l1_reg_loss: 8859.2054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63559.4115; train_chrom_access_recon_loss: 433344.4861; train_global_loss: 1218720.1528; train_optim_loss: 1218720.1528; val_kl_reg_loss: 19339.8516; val_edge_recon_loss: 40336.3711; val_gene_expr_recon_loss: 660268.8125; val_masked_gp_l1_reg_loss: 8851.1582; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61086.1367; val_chrom_access_recon_loss: 433238.7188; val_global_loss: 1223121.1250; val_optim_loss: 1223121.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9223; val_auprc_score: 0.9200; val_best_acc_score: 0.8424; val_best_f1_score: 0.8511; train_kl_reg_loss: 20415.9724; train_edge_recon_loss: 38722.3390; train_gene_expr_recon_loss: 647803.4097; train_masked_gp_l1_reg_loss: 8847.0955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59240.8928; train_chrom_access_recon_loss: 433027.8854; train_global_loss: 1208057.6111; train_optim_loss: 1208057.6111; val_kl_reg_loss: 19687.0469; val_edge_recon_loss: 40299.7617; val_gene_expr_recon_loss: 657194.5000; val_masked_gp_l1_reg_loss: 8839.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56996.6445; val_chrom_access_recon_loss: 432390.7188; val_global_loss: 1215408.1250; val_optim_loss: 1215408.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9322; val_auprc_score: 0.9271; val_best_acc_score: 0.8676; val_best_f1_score: 0.8682; train_kl_reg_loss: 20302.0462; train_edge_recon_loss: 38673.6094; train_gene_expr_recon_loss: 650533.5069; train_masked_gp_l1_reg_loss: 8833.4425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55318.8885; train_chrom_access_recon_loss: 433123.3854; train_global_loss: 1206784.8889; train_optim_loss: 1206784.8889; val_kl_reg_loss: 19144.6211; val_edge_recon_loss: 40197.5703; val_gene_expr_recon_loss: 655840.5625; val_masked_gp_l1_reg_loss: 8823.4834; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53280.7461; val_chrom_access_recon_loss: 431630.8750; val_global_loss: 1208917.8750; val_optim_loss: 1208917.8750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9339; val_auprc_score: 0.9269; val_best_acc_score: 0.8670; val_best_f1_score: 0.8654; train_kl_reg_loss: 19930.5653; train_edge_recon_loss: 38594.6615; train_gene_expr_recon_loss: 647014.7431; train_masked_gp_l1_reg_loss: 8826.6567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51762.9193; train_chrom_access_recon_loss: 434130.8958; train_global_loss: 1200260.4306; train_optim_loss: 1200260.4306; val_kl_reg_loss: 19196.4766; val_edge_recon_loss: 40116.3359; val_gene_expr_recon_loss: 653704.1875; val_masked_gp_l1_reg_loss: 8830.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49907.0664; val_chrom_access_recon_loss: 431881.0938; val_global_loss: 1203635.6250; val_optim_loss: 1203635.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9311; val_auprc_score: 0.9198; val_best_acc_score: 0.8541; val_best_f1_score: 0.8487; train_kl_reg_loss: 19698.9080; train_edge_recon_loss: 38515.0417; train_gene_expr_recon_loss: 643586.4722; train_masked_gp_l1_reg_loss: 8832.6654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48521.2734; train_chrom_access_recon_loss: 431060.1701; train_global_loss: 1190214.5139; train_optim_loss: 1190214.5139; val_kl_reg_loss: 18054.1836; val_edge_recon_loss: 39994.4648; val_gene_expr_recon_loss: 654155.0000; val_masked_gp_l1_reg_loss: 8830.8193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46837.0000; val_chrom_access_recon_loss: 431238.5312; val_global_loss: 1199110.0000; val_optim_loss: 1199110.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9355; val_auprc_score: 0.9240; val_best_acc_score: 0.8568; val_best_f1_score: 0.8519; train_kl_reg_loss: 19339.1955; train_edge_recon_loss: 38436.8963; train_gene_expr_recon_loss: 643110.7292; train_masked_gp_l1_reg_loss: 8835.5217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45583.7218; train_chrom_access_recon_loss: 430995.6528; train_global_loss: 1186301.7083; train_optim_loss: 1186301.7083; val_kl_reg_loss: 18900.5508; val_edge_recon_loss: 39950.7109; val_gene_expr_recon_loss: 650624.1250; val_masked_gp_l1_reg_loss: 8839.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44046.4492; val_chrom_access_recon_loss: 430257.8750; val_global_loss: 1192618.7500; val_optim_loss: 1192618.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9421; val_auprc_score: 0.9306; val_best_acc_score: 0.8545; val_best_f1_score: 0.8451; train_kl_reg_loss: 19227.7726; train_edge_recon_loss: 38358.7878; train_gene_expr_recon_loss: 645690.8542; train_masked_gp_l1_reg_loss: 8843.9822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42889.9284; train_chrom_access_recon_loss: 432484.1493; train_global_loss: 1187495.4722; train_optim_loss: 1187495.4722; val_kl_reg_loss: 18074.1094; val_edge_recon_loss: 39843.0078; val_gene_expr_recon_loss: 650353.5625; val_masked_gp_l1_reg_loss: 8845.7666; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41476.4883; val_chrom_access_recon_loss: 429601.1250; val_global_loss: 1188194.0000; val_optim_loss: 1188194.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9396; val_auprc_score: 0.9257; val_best_acc_score: 0.8486; val_best_f1_score: 0.8373; train_kl_reg_loss: 19004.2776; train_edge_recon_loss: 38302.6523; train_gene_expr_recon_loss: 641346.0208; train_masked_gp_l1_reg_loss: 8848.0567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40422.4036; train_chrom_access_recon_loss: 430427.3160; train_global_loss: 1178350.7083; train_optim_loss: 1178350.7083; val_kl_reg_loss: 17838.5430; val_edge_recon_loss: 39749.7852; val_gene_expr_recon_loss: 649057.8125; val_masked_gp_l1_reg_loss: 8843.9854; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39119.6953; val_chrom_access_recon_loss: 428981.1562; val_global_loss: 1183591.0000; val_optim_loss: 1183591.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9502; val_auprc_score: 0.9437; val_best_acc_score: 0.8504; val_best_f1_score: 0.8459; train_kl_reg_loss: 18740.7279; train_edge_recon_loss: 38223.2908; train_gene_expr_recon_loss: 640139.4444; train_masked_gp_l1_reg_loss: 8845.1839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38145.9418; train_chrom_access_recon_loss: 431468.5938; train_global_loss: 1175563.1944; train_optim_loss: 1175563.1944; val_kl_reg_loss: 18130.6406; val_edge_recon_loss: 39680.1367; val_gene_expr_recon_loss: 647230.5000; val_masked_gp_l1_reg_loss: 8846.1729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36947.1445; val_chrom_access_recon_loss: 428532.3750; val_global_loss: 1179367.0000; val_optim_loss: 1179367.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9411; val_auprc_score: 0.9289; val_best_acc_score: 0.8374; val_best_f1_score: 0.8480; train_kl_reg_loss: 18585.3448; train_edge_recon_loss: 38175.3641; train_gene_expr_recon_loss: 636200.9444; train_masked_gp_l1_reg_loss: 8846.5005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36052.3008; train_chrom_access_recon_loss: 429159.8889; train_global_loss: 1167020.3611; train_optim_loss: 1167020.3611; val_kl_reg_loss: 17366.8398; val_edge_recon_loss: 39653.1562; val_gene_expr_recon_loss: 647119.4375; val_masked_gp_l1_reg_loss: 8846.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34958.5039; val_chrom_access_recon_loss: 427743.0625; val_global_loss: 1175687.5000; val_optim_loss: 1175687.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9496; val_auprc_score: 0.9416; val_best_acc_score: 0.8428; val_best_f1_score: 0.8552; train_kl_reg_loss: 18320.3177; train_edge_recon_loss: 38123.0373; train_gene_expr_recon_loss: 636816.7708; train_masked_gp_l1_reg_loss: 8846.3285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34143.6115; train_chrom_access_recon_loss: 426568.5868; train_global_loss: 1162818.6806; train_optim_loss: 1162818.6806; val_kl_reg_loss: 17527.3828; val_edge_recon_loss: 39564.0742; val_gene_expr_recon_loss: 645439.1250; val_masked_gp_l1_reg_loss: 8843.2529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33135.6641; val_chrom_access_recon_loss: 426856.9688; val_global_loss: 1171366.5000; val_optim_loss: 1171366.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9452; val_auprc_score: 0.9355; val_best_acc_score: 0.8766; val_best_f1_score: 0.8769; train_kl_reg_loss: 15249.3452; train_edge_recon_loss: 39730.0790; train_gene_expr_recon_loss: 911461.3125; train_masked_gp_l1_reg_loss: 9023.0066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32247.5193; train_chrom_access_recon_loss: 452523.5903; train_global_loss: 1460234.8333; train_optim_loss: 1460234.8333; val_kl_reg_loss: 11383.1748; val_edge_recon_loss: 40094.1406; val_gene_expr_recon_loss: 918027.5000; val_masked_gp_l1_reg_loss: 9366.4912; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31056.3789; val_chrom_access_recon_loss: 452236.0312; val_global_loss: 1462163.7500; val_optim_loss: 1462163.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9353; val_auprc_score: 0.9165; val_best_acc_score: 0.8688; val_best_f1_score: 0.8713; train_kl_reg_loss: 13472.2033; train_edge_recon_loss: 39834.2678; train_gene_expr_recon_loss: 904511.4097; train_masked_gp_l1_reg_loss: 9664.6701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30084.7140; train_chrom_access_recon_loss: 451907.2674; train_global_loss: 1449474.5139; train_optim_loss: 1449474.5139; val_kl_reg_loss: 11086.3516; val_edge_recon_loss: 40178.7773; val_gene_expr_recon_loss: 911508.8750; val_masked_gp_l1_reg_loss: 9991.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28895.4922; val_chrom_access_recon_loss: 451183.4062; val_global_loss: 1452844.5000; val_optim_loss: 1452844.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9438; val_auprc_score: 0.9356; val_best_acc_score: 0.8731; val_best_f1_score: 0.8749; train_kl_reg_loss: 13080.0459; train_edge_recon_loss: 39853.0699; train_gene_expr_recon_loss: 898235.0278; train_masked_gp_l1_reg_loss: 10206.5378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27998.9429; train_chrom_access_recon_loss: 452193.9896; train_global_loss: 1441567.6389; train_optim_loss: 1441567.6389; val_kl_reg_loss: 11433.4512; val_edge_recon_loss: 40142.1133; val_gene_expr_recon_loss: 905511.8750; val_masked_gp_l1_reg_loss: 10429.2480; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26907.8281; val_chrom_access_recon_loss: 450503.0312; val_global_loss: 1444927.5000; val_optim_loss: 1444927.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9431; val_auprc_score: 0.9316; val_best_acc_score: 0.8727; val_best_f1_score: 0.8733; train_kl_reg_loss: 13140.4559; train_edge_recon_loss: 39804.2183; train_gene_expr_recon_loss: 893997.6250; train_masked_gp_l1_reg_loss: 10565.4021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26097.3101; train_chrom_access_recon_loss: 453883.5521; train_global_loss: 1437488.5694; train_optim_loss: 1437488.5694; val_kl_reg_loss: 12022.0273; val_edge_recon_loss: 40071.9961; val_gene_expr_recon_loss: 900917.0000; val_masked_gp_l1_reg_loss: 10707.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25119.4609; val_chrom_access_recon_loss: 449764.3125; val_global_loss: 1438602.0000; val_optim_loss: 1438602.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9468; val_auprc_score: 0.9373; val_best_acc_score: 0.8787; val_best_f1_score: 0.8787; train_kl_reg_loss: 13277.3398; train_edge_recon_loss: 39751.7287; train_gene_expr_recon_loss: 893581.7500; train_masked_gp_l1_reg_loss: 10637.0501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24956.0929; train_chrom_access_recon_loss: 452728.4236; train_global_loss: 1434932.3611; train_optim_loss: 1434932.3611; val_kl_reg_loss: 12003.6562; val_edge_recon_loss: 40064.4375; val_gene_expr_recon_loss: 900619.1250; val_masked_gp_l1_reg_loss: 10580.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24777.2617; val_chrom_access_recon_loss: 449745.5938; val_global_loss: 1437790.7500; val_optim_loss: 1437790.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9480; val_auprc_score: 0.9408; val_best_acc_score: 0.8764; val_best_f1_score: 0.8760; train_kl_reg_loss: 13133.6803; train_edge_recon_loss: 39753.0365; train_gene_expr_recon_loss: 887531.6319; train_masked_gp_l1_reg_loss: 10569.2899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24674.4727; train_chrom_access_recon_loss: 451162.0903; train_global_loss: 1426824.2083; train_optim_loss: 1426824.2083; val_kl_reg_loss: 11945.2539; val_edge_recon_loss: 40048.3086; val_gene_expr_recon_loss: 900348.1250; val_masked_gp_l1_reg_loss: 10547.9395; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24540.4609; val_chrom_access_recon_loss: 449729.0625; val_global_loss: 1437159.1250; val_optim_loss: 1437159.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9460; val_auprc_score: 0.9365; val_best_acc_score: 0.8735; val_best_f1_score: 0.8733; train_kl_reg_loss: 13141.4219; train_edge_recon_loss: 39744.2713; train_gene_expr_recon_loss: 888212.6319; train_masked_gp_l1_reg_loss: 10538.4860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24444.3546; train_chrom_access_recon_loss: 450878.5347; train_global_loss: 1426959.6944; train_optim_loss: 1426959.6944; val_kl_reg_loss: 11991.5635; val_edge_recon_loss: 40035.8867; val_gene_expr_recon_loss: 899925.6875; val_masked_gp_l1_reg_loss: 10528.0059; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24327.1660; val_chrom_access_recon_loss: 449613.8125; val_global_loss: 1436422.1250; val_optim_loss: 1436422.1250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9491; val_auprc_score: 0.9416; val_best_acc_score: 0.8779; val_best_f1_score: 0.8769; train_kl_reg_loss: 13127.8249; train_edge_recon_loss: 39730.8503; train_gene_expr_recon_loss: 889061.2153; train_masked_gp_l1_reg_loss: 10522.9970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24238.3574; train_chrom_access_recon_loss: 451103.0382; train_global_loss: 1427784.3056; train_optim_loss: 1427784.3056; val_kl_reg_loss: 11993.8838; val_edge_recon_loss: 40031.1719; val_gene_expr_recon_loss: 899663.1250; val_masked_gp_l1_reg_loss: 10518.5332; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24132.0586; val_chrom_access_recon_loss: 449588.9688; val_global_loss: 1435927.7500; val_optim_loss: 1435927.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 14 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9497
val AUPRC score: 0.9430
val best accuracy score: 0.8818
val best F1 score: 0.8844
val target rna MSE score: 4.0954
val source rna MSE score: 3.3019
val target atac MSE score: 0.1341
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
