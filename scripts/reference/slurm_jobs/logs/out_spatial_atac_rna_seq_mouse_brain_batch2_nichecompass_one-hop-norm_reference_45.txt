[True]
Run timestamp: 24072023_164532_45.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_45']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9052; val_auprc_score: 0.9156; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20441.0469; train_edge_recon_loss: 3491570.9444; train_gene_expr_recon_loss: 3133545.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108689491.5556; train_global_loss: 115335048.8889; train_optim_loss: 115335048.8889; val_kl_reg_loss: 33518.9531; val_edge_recon_loss: 4065878.0000; val_gene_expr_recon_loss: 2988983.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 108276848.0000; val_global_loss: 115365232.0000; val_optim_loss: 115365232.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8974; val_auprc_score: 0.9035; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 49447.1155; train_edge_recon_loss: 3560801.8333; train_gene_expr_recon_loss: 2919877.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106632861.3333; train_global_loss: 113162988.4444; train_optim_loss: 113162988.4444; val_kl_reg_loss: 44635.9727; val_edge_recon_loss: 4065772.5000; val_gene_expr_recon_loss: 2776653.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106286552.0000; val_global_loss: 113173616.0000; val_optim_loss: 113173616.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8883; val_auprc_score: 0.8954; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 79380.9397; train_edge_recon_loss: 3598064.8333; train_gene_expr_recon_loss: 2708438.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 103987138.6667; train_global_loss: 110373024.0000; train_optim_loss: 110373024.0000; val_kl_reg_loss: 118520.8438; val_edge_recon_loss: 4065877.5000; val_gene_expr_recon_loss: 2587484.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103952024.0000; val_global_loss: 110723904.0000; val_optim_loss: 110723904.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8905; val_auprc_score: 0.8968; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 122240.6745; train_edge_recon_loss: 3634177.6389; train_gene_expr_recon_loss: 2502811.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101122547.5556; train_global_loss: 107381777.7778; train_optim_loss: 107381777.7778; val_kl_reg_loss: 128640.7812; val_edge_recon_loss: 4065867.2500; val_gene_expr_recon_loss: 2431512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102334064.0000; val_global_loss: 108960080.0000; val_optim_loss: 108960080.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8794; val_auprc_score: 0.8782; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 158264.0747; train_edge_recon_loss: 3635988.0278; train_gene_expr_recon_loss: 2387358.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100197594.6667; train_global_loss: 106379206.2222; train_optim_loss: 106379206.2222; val_kl_reg_loss: 164343.5938; val_edge_recon_loss: 4065753.7500; val_gene_expr_recon_loss: 2340538.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100995240.0000; val_global_loss: 107565872.0000; val_optim_loss: 107565872.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8788; val_auprc_score: 0.8768; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 186387.7517; train_edge_recon_loss: 3637577.8333; train_gene_expr_recon_loss: 2296092.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98794789.3333; train_global_loss: 104914847.1111; train_optim_loss: 104914847.1111; val_kl_reg_loss: 177607.0156; val_edge_recon_loss: 4065382.7500; val_gene_expr_recon_loss: 2269582.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99954832.0000; val_global_loss: 106467408.0000; val_optim_loss: 106467408.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8598; val_auprc_score: 0.8615; val_best_acc_score: 0.5073; val_best_f1_score: 0.6699; train_kl_reg_loss: 205140.4531; train_edge_recon_loss: 3628992.1667; train_gene_expr_recon_loss: 2242265.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97986609.7778; train_global_loss: 104063007.1111; train_optim_loss: 104063007.1111; val_kl_reg_loss: 155509.2812; val_edge_recon_loss: 4064904.5000; val_gene_expr_recon_loss: 2221292.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99430896.0000; val_global_loss: 105872600.0000; val_optim_loss: 105872600.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8640; val_auprc_score: 0.8684; val_best_acc_score: 0.5136; val_best_f1_score: 0.6727; train_kl_reg_loss: 213698.5469; train_edge_recon_loss: 3625644.8056; train_gene_expr_recon_loss: 2184977.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97117020.4444; train_global_loss: 103141341.3333; train_optim_loss: 103141341.3333; val_kl_reg_loss: 187326.5000; val_edge_recon_loss: 4064403.5000; val_gene_expr_recon_loss: 2185266.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99090344.0000; val_global_loss: 105527344.0000; val_optim_loss: 105527344.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8572; val_auprc_score: 0.8570; val_best_acc_score: 0.5319; val_best_f1_score: 0.6803; train_kl_reg_loss: 217379.9549; train_edge_recon_loss: 3624924.7778; train_gene_expr_recon_loss: 2169755.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97708944.8889; train_global_loss: 103721005.3333; train_optim_loss: 103721005.3333; val_kl_reg_loss: 148650.4688; val_edge_recon_loss: 4063288.2500; val_gene_expr_recon_loss: 2165898.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98889032.0000; val_global_loss: 105266872.0000; val_optim_loss: 105266872.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8576; val_auprc_score: 0.8582; val_best_acc_score: 0.5490; val_best_f1_score: 0.6878; train_kl_reg_loss: 217888.8229; train_edge_recon_loss: 3624384.6389; train_gene_expr_recon_loss: 2157533.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97349448.0000; train_global_loss: 103349253.3333; train_optim_loss: 103349253.3333; val_kl_reg_loss: 164326.3438; val_edge_recon_loss: 4062426.5000; val_gene_expr_recon_loss: 2151681.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98739080.0000; val_global_loss: 105117512.0000; val_optim_loss: 105117512.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8622; val_auprc_score: 0.8625; val_best_acc_score: 0.5571; val_best_f1_score: 0.6912; train_kl_reg_loss: 209246.2639; train_edge_recon_loss: 3629364.1389; train_gene_expr_recon_loss: 2138070.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97049094.2222; train_global_loss: 103025775.1111; train_optim_loss: 103025775.1111; val_kl_reg_loss: 178650.5938; val_edge_recon_loss: 4061855.7500; val_gene_expr_recon_loss: 2138458.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98678560.0000; val_global_loss: 105057528.0000; val_optim_loss: 105057528.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8712; val_auprc_score: 0.8630; val_best_acc_score: 0.5936; val_best_f1_score: 0.7083; train_kl_reg_loss: 222575.7135; train_edge_recon_loss: 3601315.0556; train_gene_expr_recon_loss: 2131550.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96842704.8889; train_global_loss: 102798145.7778; train_optim_loss: 102798145.7778; val_kl_reg_loss: 164787.1094; val_edge_recon_loss: 4060204.7500; val_gene_expr_recon_loss: 2130265.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98615256.0000; val_global_loss: 104970512.0000; val_optim_loss: 104970512.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8731; val_auprc_score: 0.8658; val_best_acc_score: 0.6217; val_best_f1_score: 0.7220; train_kl_reg_loss: 206320.0139; train_edge_recon_loss: 3613525.1944; train_gene_expr_recon_loss: 2128059.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96970577.7778; train_global_loss: 102918480.8889; train_optim_loss: 102918480.8889; val_kl_reg_loss: 187007.0938; val_edge_recon_loss: 4058871.5000; val_gene_expr_recon_loss: 2123197.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98312720.0000; val_global_loss: 104681792.0000; val_optim_loss: 104681792.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8812; val_auprc_score: 0.8728; val_best_acc_score: 0.6814; val_best_f1_score: 0.7532; train_kl_reg_loss: 213009.5556; train_edge_recon_loss: 3597531.1389; train_gene_expr_recon_loss: 2111235.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96625313.7778; train_global_loss: 102547089.7778; train_optim_loss: 102547089.7778; val_kl_reg_loss: 175105.2031; val_edge_recon_loss: 4055984.0000; val_gene_expr_recon_loss: 2119893.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98343920.0000; val_global_loss: 104694904.0000; val_optim_loss: 104694904.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8770; val_auprc_score: 0.8652; val_best_acc_score: 0.7323; val_best_f1_score: 0.7816; train_kl_reg_loss: 206851.8576; train_edge_recon_loss: 3602153.8889; train_gene_expr_recon_loss: 2108331.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96742798.2222; train_global_loss: 102660135.1111; train_optim_loss: 102660135.1111; val_kl_reg_loss: 163912.8281; val_edge_recon_loss: 4052543.7500; val_gene_expr_recon_loss: 2114577.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98283504.0000; val_global_loss: 104614536.0000; val_optim_loss: 104614536.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8854; val_auprc_score: 0.8756; val_best_acc_score: 0.7754; val_best_f1_score: 0.8058; train_kl_reg_loss: 200413.2517; train_edge_recon_loss: 3599380.5833; train_gene_expr_recon_loss: 2095807.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96699661.3333; train_global_loss: 102595262.2222; train_optim_loss: 102595262.2222; val_kl_reg_loss: 174377.9688; val_edge_recon_loss: 4046372.7500; val_gene_expr_recon_loss: 2110385.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98139968.0000; val_global_loss: 104471104.0000; val_optim_loss: 104471104.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8849; val_auprc_score: 0.8715; val_best_acc_score: 0.8007; val_best_f1_score: 0.8168; train_kl_reg_loss: 201932.9045; train_edge_recon_loss: 3590208.3333; train_gene_expr_recon_loss: 2093592.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96233920.0000; train_global_loss: 102119654.2222; train_optim_loss: 102119654.2222; val_kl_reg_loss: 154261.5156; val_edge_recon_loss: 4036783.2500; val_gene_expr_recon_loss: 2107364.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98116368.0000; val_global_loss: 104414776.0000; val_optim_loss: 104414776.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8868; val_auprc_score: 0.8772; val_best_acc_score: 0.8049; val_best_f1_score: 0.8109; train_kl_reg_loss: 196957.9757; train_edge_recon_loss: 3590470.1944; train_gene_expr_recon_loss: 2094822.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96133388.4444; train_global_loss: 102015638.2222; train_optim_loss: 102015638.2222; val_kl_reg_loss: 161600.0625; val_edge_recon_loss: 4022889.5000; val_gene_expr_recon_loss: 2101286.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97780888.0000; val_global_loss: 104066664.0000; val_optim_loss: 104066664.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8875; val_auprc_score: 0.8713; val_best_acc_score: 0.8017; val_best_f1_score: 0.7975; train_kl_reg_loss: 190165.9861; train_edge_recon_loss: 3582103.7500; train_gene_expr_recon_loss: 2091399.0139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96099351.1111; train_global_loss: 101963020.4444; train_optim_loss: 101963020.4444; val_kl_reg_loss: 174845.5625; val_edge_recon_loss: 4004639.0000; val_gene_expr_recon_loss: 2097218.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97708472.0000; val_global_loss: 103985176.0000; val_optim_loss: 103985176.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8822; val_auprc_score: 0.8648; val_best_acc_score: 0.7828; val_best_f1_score: 0.7970; train_kl_reg_loss: 196295.3733; train_edge_recon_loss: 3566895.3889; train_gene_expr_recon_loss: 2091870.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96371457.7778; train_global_loss: 102226519.1111; train_optim_loss: 102226519.1111; val_kl_reg_loss: 138512.2812; val_edge_recon_loss: 3971198.0000; val_gene_expr_recon_loss: 2100272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97855504.0000; val_global_loss: 104065488.0000; val_optim_loss: 104065488.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8837; val_auprc_score: 0.8675; val_best_acc_score: 0.7726; val_best_f1_score: 0.8035; train_kl_reg_loss: 175707.8264; train_edge_recon_loss: 3576157.6667; train_gene_expr_recon_loss: 2095498.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96541578.6667; train_global_loss: 102388941.3333; train_optim_loss: 102388941.3333; val_kl_reg_loss: 164458.4688; val_edge_recon_loss: 3935473.2500; val_gene_expr_recon_loss: 2096484.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97905608.0000; val_global_loss: 104102024.0000; val_optim_loss: 104102024.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8775; val_auprc_score: 0.8606; val_best_acc_score: 0.7820; val_best_f1_score: 0.8063; train_kl_reg_loss: 184364.8194; train_edge_recon_loss: 3546550.5556; train_gene_expr_recon_loss: 2083589.0139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96073525.3333; train_global_loss: 101888030.2222; train_optim_loss: 101888030.2222; val_kl_reg_loss: 151423.9375; val_edge_recon_loss: 3881398.7500; val_gene_expr_recon_loss: 2091684.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97611080.0000; val_global_loss: 103735584.0000; val_optim_loss: 103735584.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8762; val_auprc_score: 0.8585; val_best_acc_score: 0.7848; val_best_f1_score: 0.8020; train_kl_reg_loss: 168612.3750; train_edge_recon_loss: 3531561.9444; train_gene_expr_recon_loss: 2077145.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95610707.5556; train_global_loss: 101388026.6667; train_optim_loss: 101388026.6667; val_kl_reg_loss: 140720.7969; val_edge_recon_loss: 3798297.7500; val_gene_expr_recon_loss: 2091329.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97568576.0000; val_global_loss: 103598920.0000; val_optim_loss: 103598920.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8812; val_auprc_score: 0.8673; val_best_acc_score: 0.7917; val_best_f1_score: 0.8041; train_kl_reg_loss: 163992.2448; train_edge_recon_loss: 3493818.1389; train_gene_expr_recon_loss: 2088298.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95400775.1111; train_global_loss: 101146883.5556; train_optim_loss: 101146883.5556; val_kl_reg_loss: 137173.1719; val_edge_recon_loss: 3673476.7500; val_gene_expr_recon_loss: 2087836.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97329152.0000; val_global_loss: 103227640.0000; val_optim_loss: 103227640.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8823; val_auprc_score: 0.8726; val_best_acc_score: 0.7925; val_best_f1_score: 0.8010; train_kl_reg_loss: 151800.1372; train_edge_recon_loss: 3446602.3333; train_gene_expr_recon_loss: 2085123.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96038792.8889; train_global_loss: 101722318.2222; train_optim_loss: 101722318.2222; val_kl_reg_loss: 129955.0469; val_edge_recon_loss: 3545369.2500; val_gene_expr_recon_loss: 2089123.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97378504.0000; val_global_loss: 103142952.0000; val_optim_loss: 103142952.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8945; val_auprc_score: 0.8759; val_best_acc_score: 0.7899; val_best_f1_score: 0.8162; train_kl_reg_loss: 133695.4818; train_edge_recon_loss: 3804601.7778; train_gene_expr_recon_loss: 2096055.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96058297.7778; train_global_loss: 102092650.6667; train_optim_loss: 102092650.6667; val_kl_reg_loss: 78520.9219; val_edge_recon_loss: 3845901.0000; val_gene_expr_recon_loss: 2101680.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97637216.0000; val_global_loss: 103663320.0000; val_optim_loss: 103663320.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8990; val_auprc_score: 0.8829; val_best_acc_score: 0.8134; val_best_f1_score: 0.8082; train_kl_reg_loss: 110446.8819; train_edge_recon_loss: 3794590.8056; train_gene_expr_recon_loss: 2133224.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96531003.5556; train_global_loss: 102569265.7778; train_optim_loss: 102569265.7778; val_kl_reg_loss: 75429.0938; val_edge_recon_loss: 3919270.0000; val_gene_expr_recon_loss: 2114301.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97822040.0000; val_global_loss: 103931040.0000; val_optim_loss: 103931040.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8886; val_auprc_score: 0.8712; val_best_acc_score: 0.8022; val_best_f1_score: 0.8041; train_kl_reg_loss: 89312.7031; train_edge_recon_loss: 3869599.2778; train_gene_expr_recon_loss: 2167796.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98323012.4444; train_global_loss: 104449720.8889; train_optim_loss: 104449720.8889; val_kl_reg_loss: 89104.3125; val_edge_recon_loss: 3979563.5000; val_gene_expr_recon_loss: 2104488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97682168.0000; val_global_loss: 103855328.0000; val_optim_loss: 103855328.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8971; val_auprc_score: 0.8809; val_best_acc_score: 0.8069; val_best_f1_score: 0.8051; train_kl_reg_loss: 70729.7287; train_edge_recon_loss: 3850456.0278; train_gene_expr_recon_loss: 2155670.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96268623.1111; train_global_loss: 102345479.1111; train_optim_loss: 102345479.1111; val_kl_reg_loss: 56150.0938; val_edge_recon_loss: 3958301.2500; val_gene_expr_recon_loss: 2104276.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97694792.0000; val_global_loss: 103813520.0000; val_optim_loss: 103813520.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8925; val_auprc_score: 0.8776; val_best_acc_score: 0.8036; val_best_f1_score: 0.8021; train_kl_reg_loss: 71388.9653; train_edge_recon_loss: 3782201.3889; train_gene_expr_recon_loss: 2107877.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95930804.4444; train_global_loss: 101892271.1111; train_optim_loss: 101892271.1111; val_kl_reg_loss: 70264.2422; val_edge_recon_loss: 3959867.7500; val_gene_expr_recon_loss: 2097707.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97560480.0000; val_global_loss: 103688320.0000; val_optim_loss: 103688320.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8915; val_auprc_score: 0.8700; val_best_acc_score: 0.8038; val_best_f1_score: 0.8045; train_kl_reg_loss: 82160.2552; train_edge_recon_loss: 3748650.4444; train_gene_expr_recon_loss: 2116238.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96773920.8889; train_global_loss: 102720970.6667; train_optim_loss: 102720970.6667; val_kl_reg_loss: 64380.4102; val_edge_recon_loss: 3959306.7500; val_gene_expr_recon_loss: 2093781.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97361136.0000; val_global_loss: 103478608.0000; val_optim_loss: 103478608.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8934; val_auprc_score: 0.8769; val_best_acc_score: 0.7992; val_best_f1_score: 0.8056; train_kl_reg_loss: 71832.0677; train_edge_recon_loss: 3801952.6389; train_gene_expr_recon_loss: 2094410.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95957968.0000; train_global_loss: 101926163.5556; train_optim_loss: 101926163.5556; val_kl_reg_loss: 60025.4375; val_edge_recon_loss: 3953131.7500; val_gene_expr_recon_loss: 2095505.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97501664.0000; val_global_loss: 103610328.0000; val_optim_loss: 103610328.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8884; val_auprc_score: 0.8690; val_best_acc_score: 0.8017; val_best_f1_score: 0.8020; train_kl_reg_loss: 76560.1120; train_edge_recon_loss: 3773519.8056; train_gene_expr_recon_loss: 2082183.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95656203.5556; train_global_loss: 101588467.5556; train_optim_loss: 101588467.5556; val_kl_reg_loss: 69805.6406; val_edge_recon_loss: 3957267.0000; val_gene_expr_recon_loss: 2090801.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97402152.0000; val_global_loss: 103520024.0000; val_optim_loss: 103520024.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 49 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.8981
Val AUPRC score: 0.8829
Val best accuracy score: 0.7943
Val best F1 score: 0.8124
Val gene expr MSE score: 0.4752
Val chrom access MSE score: 0.0880
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
