[True]
Run timestamp: 10082023_132446_1000.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1000']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6994; val_auprc_score: 0.7460; val_best_acc_score: 0.5013; val_best_f1_score: 0.6667; train_kl_reg_loss: 72895.7333; train_edge_recon_loss: 3577563.0725; train_gene_expr_recon_loss: 14682843.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 746643.6818; train_global_loss: 19079946.3740; train_optim_loss: 19079946.3740; val_kl_reg_loss: 112295.7161; val_edge_recon_loss: 4065232.9000; val_gene_expr_recon_loss: 13005429.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 695936.7250; val_global_loss: 17878894.9333; val_optim_loss: 17878894.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8218; val_auprc_score: 0.8336; val_best_acc_score: 0.7231; val_best_f1_score: 0.7505; train_kl_reg_loss: 109317.8049; train_edge_recon_loss: 3528500.8702; train_gene_expr_recon_loss: 12675829.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 695926.6584; train_global_loss: 17009575.2672; train_optim_loss: 17009575.2672; val_kl_reg_loss: 107900.5870; val_edge_recon_loss: 4040896.8000; val_gene_expr_recon_loss: 12632499.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 685022.9042; val_global_loss: 17466319.7333; val_optim_loss: 17466319.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8895; val_auprc_score: 0.8831; val_best_acc_score: 0.8071; val_best_f1_score: 0.8206; train_kl_reg_loss: 87860.6794; train_edge_recon_loss: 3471178.0782; train_gene_expr_recon_loss: 12403778.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 686399.4661; train_global_loss: 16649217.1374; train_optim_loss: 16649217.1374; val_kl_reg_loss: 67665.0638; val_edge_recon_loss: 3303468.2167; val_gene_expr_recon_loss: 12535896.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 680278.8917; val_global_loss: 16587308.9333; val_optim_loss: 16587308.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8956; val_auprc_score: 0.8828; val_best_acc_score: 0.8038; val_best_f1_score: 0.8197; train_kl_reg_loss: 103140.2504; train_edge_recon_loss: 2999626.0191; train_gene_expr_recon_loss: 12285227.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 679172.2190; train_global_loss: 16067165.9618; train_optim_loss: 16067165.9618; val_kl_reg_loss: 116081.9333; val_edge_recon_loss: 2895530.8333; val_gene_expr_recon_loss: 12292459.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 666179.4500; val_global_loss: 15970251.7333; val_optim_loss: 15970251.7333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8991; val_auprc_score: 0.8858; val_best_acc_score: 0.8168; val_best_f1_score: 0.8306; train_kl_reg_loss: 108010.6647; train_edge_recon_loss: 2905219.7958; train_gene_expr_recon_loss: 12131826.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 671451.8302; train_global_loss: 15816509.1069; train_optim_loss: 15816509.1069; val_kl_reg_loss: 104549.0625; val_edge_recon_loss: 2885666.3000; val_gene_expr_recon_loss: 12156361.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 664368.2250; val_global_loss: 15810945.3333; val_optim_loss: 15810945.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9122; val_auprc_score: 0.8927; val_best_acc_score: 0.8371; val_best_f1_score: 0.8487; train_kl_reg_loss: 102193.3295; train_edge_recon_loss: 2867167.8492; train_gene_expr_recon_loss: 12015913.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 665431.6450; train_global_loss: 15650706.6641; train_optim_loss: 15650706.6641; val_kl_reg_loss: 100711.6125; val_edge_recon_loss: 2877193.5333; val_gene_expr_recon_loss: 12115910.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 659232.6000; val_global_loss: 15753048.0000; val_optim_loss: 15753048.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9232; val_auprc_score: 0.9070; val_best_acc_score: 0.8541; val_best_f1_score: 0.8618; train_kl_reg_loss: 98512.5670; train_edge_recon_loss: 2831551.5191; train_gene_expr_recon_loss: 11904591.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 659395.5992; train_global_loss: 15494051.5878; train_optim_loss: 15494051.5878; val_kl_reg_loss: 97080.2203; val_edge_recon_loss: 2843118.5500; val_gene_expr_recon_loss: 11997090.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 651686.1750; val_global_loss: 15588975.1333; val_optim_loss: 15588975.1333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9297; val_auprc_score: 0.9157; val_best_acc_score: 0.8634; val_best_f1_score: 0.8711; train_kl_reg_loss: 97393.2001; train_edge_recon_loss: 2812877.1450; train_gene_expr_recon_loss: 11822304.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 654805.3344; train_global_loss: 15387380.1908; train_optim_loss: 15387380.1908; val_kl_reg_loss: 93926.9333; val_edge_recon_loss: 2805193.7833; val_gene_expr_recon_loss: 11914742.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 646499.3958; val_global_loss: 15460362.5333; val_optim_loss: 15460362.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9367; val_auprc_score: 0.9196; val_best_acc_score: 0.8743; val_best_f1_score: 0.8820; train_kl_reg_loss: 91772.9328; train_edge_recon_loss: 2801249.2691; train_gene_expr_recon_loss: 11730876.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 649697.5258; train_global_loss: 15273596.2214; train_optim_loss: 15273596.2214; val_kl_reg_loss: 94207.8661; val_edge_recon_loss: 2772420.9833; val_gene_expr_recon_loss: 11829944.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 644262.7250; val_global_loss: 15340835.7333; val_optim_loss: 15340835.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9420; val_auprc_score: 0.9292; val_best_acc_score: 0.8770; val_best_f1_score: 0.8823; train_kl_reg_loss: 87750.4299; train_edge_recon_loss: 2778274.2691; train_gene_expr_recon_loss: 11672257.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 646025.3082; train_global_loss: 15184307.9084; train_optim_loss: 15184307.9084; val_kl_reg_loss: 89322.6198; val_edge_recon_loss: 2785152.1000; val_gene_expr_recon_loss: 11697156.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 635265.4208; val_global_loss: 15206896.4000; val_optim_loss: 15206896.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9467; val_auprc_score: 0.9347; val_best_acc_score: 0.8845; val_best_f1_score: 0.8911; train_kl_reg_loss: 84714.0660; train_edge_recon_loss: 2763804.0420; train_gene_expr_recon_loss: 11599089.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 641936.0291; train_global_loss: 15089544.0916; train_optim_loss: 15089544.0916; val_kl_reg_loss: 83645.3193; val_edge_recon_loss: 2779763.9833; val_gene_expr_recon_loss: 11707996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 635387.8667; val_global_loss: 15206793.2000; val_optim_loss: 15206793.2000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9511; val_auprc_score: 0.9382; val_best_acc_score: 0.8905; val_best_f1_score: 0.8946; train_kl_reg_loss: 84317.7702; train_edge_recon_loss: 2751105.0477; train_gene_expr_recon_loss: 11550562.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 639305.4628; train_global_loss: 15025290.2977; train_optim_loss: 15025290.2977; val_kl_reg_loss: 83879.9729; val_edge_recon_loss: 2739217.0833; val_gene_expr_recon_loss: 11639908.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 630693.6208; val_global_loss: 15093698.8667; val_optim_loss: 15093698.8667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9574; val_auprc_score: 0.9480; val_best_acc_score: 0.8998; val_best_f1_score: 0.9038; train_kl_reg_loss: 82099.6775; train_edge_recon_loss: 2740006.9084; train_gene_expr_recon_loss: 11493254.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 635311.8440; train_global_loss: 14950673.1069; train_optim_loss: 14950673.1069; val_kl_reg_loss: 80447.0562; val_edge_recon_loss: 2736719.0000; val_gene_expr_recon_loss: 11633525.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 630779.4625; val_global_loss: 15081471.0667; val_optim_loss: 15081471.0667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9574; val_auprc_score: 0.9447; val_best_acc_score: 0.8983; val_best_f1_score: 0.9020; train_kl_reg_loss: 79329.9097; train_edge_recon_loss: 2727955.7004; train_gene_expr_recon_loss: 11443581.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 632728.3807; train_global_loss: 14883595.6336; train_optim_loss: 14883595.6336; val_kl_reg_loss: 78853.9943; val_edge_recon_loss: 2755894.0667; val_gene_expr_recon_loss: 11592769.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 626677.3000; val_global_loss: 15054195.3333; val_optim_loss: 15054195.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9585; val_auprc_score: 0.9451; val_best_acc_score: 0.9031; val_best_f1_score: 0.9070; train_kl_reg_loss: 76780.4201; train_edge_recon_loss: 2725356.3702; train_gene_expr_recon_loss: 11401879.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 630541.9156; train_global_loss: 14834558.1069; train_optim_loss: 14834558.1069; val_kl_reg_loss: 76233.8906; val_edge_recon_loss: 2730354.3167; val_gene_expr_recon_loss: 11469280.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 623841.6208; val_global_loss: 14899710.6000; val_optim_loss: 14899710.6000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9600; val_auprc_score: 0.9483; val_best_acc_score: 0.9058; val_best_f1_score: 0.9105; train_kl_reg_loss: 76996.7406; train_edge_recon_loss: 2712181.2061; train_gene_expr_recon_loss: 11356957.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 627432.3406; train_global_loss: 14773568.2290; train_optim_loss: 14773568.2290; val_kl_reg_loss: 77372.7625; val_edge_recon_loss: 2711086.2000; val_gene_expr_recon_loss: 11493501.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 623418.7708; val_global_loss: 14905379.1333; val_optim_loss: 14905379.1333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9642; val_auprc_score: 0.9548; val_best_acc_score: 0.9076; val_best_f1_score: 0.9114; train_kl_reg_loss: 74402.2934; train_edge_recon_loss: 2706333.2271; train_gene_expr_recon_loss: 11328687.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 626063.1975; train_global_loss: 14735486.0305; train_optim_loss: 14735486.0305; val_kl_reg_loss: 71274.2318; val_edge_recon_loss: 2716627.0500; val_gene_expr_recon_loss: 11437926.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 620570.4333; val_global_loss: 14846398.2667; val_optim_loss: 14846398.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9608; val_auprc_score: 0.9480; val_best_acc_score: 0.9093; val_best_f1_score: 0.9132; train_kl_reg_loss: 73690.8531; train_edge_recon_loss: 2706008.1641; train_gene_expr_recon_loss: 11295655.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 624076.0840; train_global_loss: 14699430.6794; train_optim_loss: 14699430.6794; val_kl_reg_loss: 69756.1135; val_edge_recon_loss: 2700903.9833; val_gene_expr_recon_loss: 11432394.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 615554.2833; val_global_loss: 14818609.0667; val_optim_loss: 14818609.0667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9673; val_auprc_score: 0.9574; val_best_acc_score: 0.9209; val_best_f1_score: 0.9237; train_kl_reg_loss: 71894.2342; train_edge_recon_loss: 2696053.5744; train_gene_expr_recon_loss: 11268915.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 622162.4948; train_global_loss: 14659025.8779; train_optim_loss: 14659025.8779; val_kl_reg_loss: 69355.5370; val_edge_recon_loss: 2675885.0667; val_gene_expr_recon_loss: 11399560.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 616480.5000; val_global_loss: 14761281.8000; val_optim_loss: 14761281.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9637; val_auprc_score: 0.9536; val_best_acc_score: 0.9131; val_best_f1_score: 0.9167; train_kl_reg_loss: 69512.1651; train_edge_recon_loss: 2703697.1908; train_gene_expr_recon_loss: 11233449.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 620532.3760; train_global_loss: 14627190.9084; train_optim_loss: 14627190.9084; val_kl_reg_loss: 71239.2734; val_edge_recon_loss: 2726358.7000; val_gene_expr_recon_loss: 11357570.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 616871.2125; val_global_loss: 14772039.8000; val_optim_loss: 14772039.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9726; val_auprc_score: 0.9651; val_best_acc_score: 0.9262; val_best_f1_score: 0.9283; train_kl_reg_loss: 67904.1028; train_edge_recon_loss: 2698538.5782; train_gene_expr_recon_loss: 11207711.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 618665.3698; train_global_loss: 14592819.6107; train_optim_loss: 14592819.6107; val_kl_reg_loss: 66338.9849; val_edge_recon_loss: 2669304.3667; val_gene_expr_recon_loss: 11304899.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 611230.6375; val_global_loss: 14651773.0667; val_optim_loss: 14651773.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9688; val_auprc_score: 0.9602; val_best_acc_score: 0.9204; val_best_f1_score: 0.9233; train_kl_reg_loss: 66958.5556; train_edge_recon_loss: 2703076.4370; train_gene_expr_recon_loss: 11185443.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 617560.1011; train_global_loss: 14573038.0611; train_optim_loss: 14573038.0611; val_kl_reg_loss: 66948.4516; val_edge_recon_loss: 2725820.1833; val_gene_expr_recon_loss: 11269207.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 611282.7750; val_global_loss: 14673258.6667; val_optim_loss: 14673258.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9656; val_auprc_score: 0.9519; val_best_acc_score: 0.9179; val_best_f1_score: 0.9211; train_kl_reg_loss: 65883.4601; train_edge_recon_loss: 2690700.8893; train_gene_expr_recon_loss: 11162419.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 616395.5577; train_global_loss: 14535399.0992; train_optim_loss: 14535399.0992; val_kl_reg_loss: 64979.1107; val_edge_recon_loss: 2707594.5333; val_gene_expr_recon_loss: 11241976.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 607016.4958; val_global_loss: 14621566.2667; val_optim_loss: 14621566.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9682; val_auprc_score: 0.9568; val_best_acc_score: 0.9227; val_best_f1_score: 0.9262; train_kl_reg_loss: 64626.8442; train_edge_recon_loss: 2682708.7557; train_gene_expr_recon_loss: 11138413.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 615489.8612; train_global_loss: 14501238.5573; train_optim_loss: 14501238.5573; val_kl_reg_loss: 65233.0813; val_edge_recon_loss: 2691767.7667; val_gene_expr_recon_loss: 11257396.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 607401.3708; val_global_loss: 14621799.1333; val_optim_loss: 14621799.1333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9703; val_auprc_score: 0.9605; val_best_acc_score: 0.9213; val_best_f1_score: 0.9252; train_kl_reg_loss: 64068.3587; train_edge_recon_loss: 2687741.5057; train_gene_expr_recon_loss: 11130236.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 614390.4284; train_global_loss: 14496436.9466; train_optim_loss: 14496436.9466; val_kl_reg_loss: 65049.0094; val_edge_recon_loss: 2700723.7500; val_gene_expr_recon_loss: 11275156.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 610201.7333; val_global_loss: 14651130.8667; val_optim_loss: 14651130.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9707; val_auprc_score: 0.9613; val_best_acc_score: 0.9243; val_best_f1_score: 0.9262; train_kl_reg_loss: 68441.7127; train_edge_recon_loss: 2699638.6164; train_gene_expr_recon_loss: 11325940.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 628904.4637; train_global_loss: 14722925.1374; train_optim_loss: 14722925.1374; val_kl_reg_loss: 37081.4167; val_edge_recon_loss: 2706138.0167; val_gene_expr_recon_loss: 11447214.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 623401.5125; val_global_loss: 14813835.3333; val_optim_loss: 14813835.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9745; val_auprc_score: 0.9666; val_best_acc_score: 0.9251; val_best_f1_score: 0.9282; train_kl_reg_loss: 65666.8722; train_edge_recon_loss: 2692851.1088; train_gene_expr_recon_loss: 11301832.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 627415.7906; train_global_loss: 14687766.2672; train_optim_loss: 14687766.2672; val_kl_reg_loss: 38138.6984; val_edge_recon_loss: 2688401.7500; val_gene_expr_recon_loss: 11394155.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 622369.6667; val_global_loss: 14743065.3333; val_optim_loss: 14743065.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9711; val_auprc_score: 0.9603; val_best_acc_score: 0.9212; val_best_f1_score: 0.9252; train_kl_reg_loss: 63901.3919; train_edge_recon_loss: 2695868.0267; train_gene_expr_recon_loss: 11290968.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 626147.4284; train_global_loss: 14676885.4885; train_optim_loss: 14676885.4885; val_kl_reg_loss: 39041.3620; val_edge_recon_loss: 2697643.5833; val_gene_expr_recon_loss: 11426620.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 621810.9458; val_global_loss: 14785115.8000; val_optim_loss: 14785115.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9732; val_auprc_score: 0.9643; val_best_acc_score: 0.9263; val_best_f1_score: 0.9276; train_kl_reg_loss: 64830.7937; train_edge_recon_loss: 2689468.7500; train_gene_expr_recon_loss: 11282612.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 625535.9370; train_global_loss: 14662447.7099; train_optim_loss: 14662447.7099; val_kl_reg_loss: 39296.8414; val_edge_recon_loss: 2692709.9667; val_gene_expr_recon_loss: 11365406.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 618581.5958; val_global_loss: 14715994.8667; val_optim_loss: 14715994.8667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9733; val_auprc_score: 0.9650; val_best_acc_score: 0.9268; val_best_f1_score: 0.9293; train_kl_reg_loss: 64530.4515; train_edge_recon_loss: 2685312.7729; train_gene_expr_recon_loss: 11280610.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 625423.1073; train_global_loss: 14655876.3740; train_optim_loss: 14655876.3740; val_kl_reg_loss: 39469.6810; val_edge_recon_loss: 2695190.1500; val_gene_expr_recon_loss: 11389846.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 618078.2250; val_global_loss: 14742585.0000; val_optim_loss: 14742585.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9748; val_auprc_score: 0.9669; val_best_acc_score: 0.9266; val_best_f1_score: 0.9287; train_kl_reg_loss: 63906.8675; train_edge_recon_loss: 2682441.5401; train_gene_expr_recon_loss: 11278022.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 626052.5262; train_global_loss: 14650423.6718; train_optim_loss: 14650423.6718; val_kl_reg_loss: 39533.3833; val_edge_recon_loss: 2672606.8667; val_gene_expr_recon_loss: 11389287.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 618253.7500; val_global_loss: 14719681.4000; val_optim_loss: 14719681.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 45 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9673
val AUPRC score: 0.9553
val best accuracy score: 0.9185
val best F1 score: 0.9216
val target rna MSE score: 0.9622
val source rna MSE score: 0.3770
val target atac MSE score: 0.5354
val source atac MSE score: 0.1556
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
