[True]
Run timestamp: 10102023_070807_180.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_180']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6797; val_auprc_score: 0.6624; val_best_acc_score: 0.5005; val_best_f1_score: 0.6668; train_kl_reg_loss: 38635.6602; train_edge_recon_loss: 727236.3741; train_gene_expr_recon_loss: 23233195.5758; train_masked_gp_l1_reg_loss: 105690.4071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3309328.9848; train_chrom_access_recon_loss: 991220.3153; train_global_loss: 28405307.1818; train_optim_loss: 28405307.1818; val_kl_reg_loss: 76242.8232; val_edge_recon_loss: 813027.0781; val_gene_expr_recon_loss: 21433439.5000; val_masked_gp_l1_reg_loss: 84884.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2241126.5000; val_chrom_access_recon_loss: 947087.7109; val_global_loss: 25595807.2500; val_optim_loss: 25595807.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7527; val_auprc_score: 0.7314; val_best_acc_score: 0.5693; val_best_f1_score: 0.6961; train_kl_reg_loss: 77577.8409; train_edge_recon_loss: 740525.3684; train_gene_expr_recon_loss: 21289294.3636; train_masked_gp_l1_reg_loss: 78636.7655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1467287.3873; train_chrom_access_recon_loss: 944934.4830; train_global_loss: 24598256.2424; train_optim_loss: 24598256.2424; val_kl_reg_loss: 73825.9180; val_edge_recon_loss: 812070.4141; val_gene_expr_recon_loss: 21065815.5000; val_masked_gp_l1_reg_loss: 75892.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 881746.1250; val_chrom_access_recon_loss: 936274.8281; val_global_loss: 23845625.2500; val_optim_loss: 23845625.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8042; val_auprc_score: 0.7951; val_best_acc_score: 0.7101; val_best_f1_score: 0.7474; train_kl_reg_loss: 72184.9170; train_edge_recon_loss: 733215.4508; train_gene_expr_recon_loss: 21074504.5455; train_masked_gp_l1_reg_loss: 76028.2951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 615246.8063; train_chrom_access_recon_loss: 937915.2348; train_global_loss: 23509095.2121; train_optim_loss: 23509095.2121; val_kl_reg_loss: 68316.9033; val_edge_recon_loss: 805053.1719; val_gene_expr_recon_loss: 21042074.7500; val_masked_gp_l1_reg_loss: 76469.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 425927.6250; val_chrom_access_recon_loss: 941306.5469; val_global_loss: 23359149.5000; val_optim_loss: 23359149.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8461; val_auprc_score: 0.8236; val_best_acc_score: 0.7528; val_best_f1_score: 0.7746; train_kl_reg_loss: 65676.6676; train_edge_recon_loss: 725293.1345; train_gene_expr_recon_loss: 20903531.1818; train_masked_gp_l1_reg_loss: 77422.0071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 334652.1733; train_chrom_access_recon_loss: 932447.6458; train_global_loss: 23039022.7273; train_optim_loss: 23039022.7273; val_kl_reg_loss: 70498.1592; val_edge_recon_loss: 784351.8203; val_gene_expr_recon_loss: 20697011.7500; val_masked_gp_l1_reg_loss: 78437.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 262237.6875; val_chrom_access_recon_loss: 927002.7109; val_global_loss: 22819540.5000; val_optim_loss: 22819540.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8520; val_auprc_score: 0.8180; val_best_acc_score: 0.7802; val_best_f1_score: 0.8048; train_kl_reg_loss: 60968.7530; train_edge_recon_loss: 710518.2557; train_gene_expr_recon_loss: 20748684.8485; train_masked_gp_l1_reg_loss: 79611.2404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221357.2344; train_chrom_access_recon_loss: 927383.1458; train_global_loss: 22748523.3939; train_optim_loss: 22748523.3939; val_kl_reg_loss: 57411.7163; val_edge_recon_loss: 735955.6250; val_gene_expr_recon_loss: 20593155.2500; val_masked_gp_l1_reg_loss: 80304.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 188334.2656; val_chrom_access_recon_loss: 920227.6484; val_global_loss: 22575388.7500; val_optim_loss: 22575388.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8644; val_auprc_score: 0.8315; val_best_acc_score: 0.7840; val_best_f1_score: 0.8043; train_kl_reg_loss: 61302.5134; train_edge_recon_loss: 677067.1884; train_gene_expr_recon_loss: 20644708.3939; train_masked_gp_l1_reg_loss: 81110.9989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167289.5036; train_chrom_access_recon_loss: 923664.9924; train_global_loss: 22555143.5152; train_optim_loss: 22555143.5152; val_kl_reg_loss: 65136.2153; val_edge_recon_loss: 657043.7109; val_gene_expr_recon_loss: 20691110.7500; val_masked_gp_l1_reg_loss: 81783.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148062.4844; val_chrom_access_recon_loss: 928104.2188; val_global_loss: 22571241.0000; val_optim_loss: 22571241.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8772; val_auprc_score: 0.8443; val_best_acc_score: 0.8049; val_best_f1_score: 0.8180; train_kl_reg_loss: 67899.8300; train_edge_recon_loss: 640817.0824; train_gene_expr_recon_loss: 20504378.0000; train_masked_gp_l1_reg_loss: 82436.4538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134412.4360; train_chrom_access_recon_loss: 918388.3693; train_global_loss: 22348332.0909; train_optim_loss: 22348332.0909; val_kl_reg_loss: 70071.4473; val_edge_recon_loss: 634913.9219; val_gene_expr_recon_loss: 20544493.5000; val_masked_gp_l1_reg_loss: 83454.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122424.8281; val_chrom_access_recon_loss: 925758.9844; val_global_loss: 22381115.5000; val_optim_loss: 22381115.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8937; val_auprc_score: 0.8606; val_best_acc_score: 0.8184; val_best_f1_score: 0.8304; train_kl_reg_loss: 69912.3814; train_edge_recon_loss: 626871.5653; train_gene_expr_recon_loss: 20404161.5758; train_masked_gp_l1_reg_loss: 84412.0142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114356.3870; train_chrom_access_recon_loss: 915297.7945; train_global_loss: 22215011.8788; train_optim_loss: 22215011.8788; val_kl_reg_loss: 69860.0791; val_edge_recon_loss: 625550.2031; val_gene_expr_recon_loss: 20392577.0000; val_masked_gp_l1_reg_loss: 85621.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107936.8281; val_chrom_access_recon_loss: 908218.1484; val_global_loss: 22189763.5000; val_optim_loss: 22189763.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8999; val_auprc_score: 0.8661; val_best_acc_score: 0.8259; val_best_f1_score: 0.8354; train_kl_reg_loss: 68368.3639; train_edge_recon_loss: 623318.9290; train_gene_expr_recon_loss: 20323731.6061; train_masked_gp_l1_reg_loss: 86248.4845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101744.0612; train_chrom_access_recon_loss: 911982.6705; train_global_loss: 22115394.1818; train_optim_loss: 22115394.1818; val_kl_reg_loss: 70583.4033; val_edge_recon_loss: 618788.6797; val_gene_expr_recon_loss: 20375623.5000; val_masked_gp_l1_reg_loss: 87178.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96813.7812; val_chrom_access_recon_loss: 912992.4922; val_global_loss: 22161980.0000; val_optim_loss: 22161980.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9030; val_auprc_score: 0.8748; val_best_acc_score: 0.8358; val_best_f1_score: 0.8473; train_kl_reg_loss: 67849.7158; train_edge_recon_loss: 615209.7926; train_gene_expr_recon_loss: 20242153.7576; train_masked_gp_l1_reg_loss: 87828.6255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92959.4519; train_chrom_access_recon_loss: 908282.2623; train_global_loss: 22014283.4545; train_optim_loss: 22014283.4545; val_kl_reg_loss: 66380.0620; val_edge_recon_loss: 619150.9531; val_gene_expr_recon_loss: 20299631.5000; val_masked_gp_l1_reg_loss: 88261.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89237.8438; val_chrom_access_recon_loss: 902823.8281; val_global_loss: 22065486.2500; val_optim_loss: 22065486.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9249; val_auprc_score: 0.9007; val_best_acc_score: 0.8557; val_best_f1_score: 0.8615; train_kl_reg_loss: 67557.5022; train_edge_recon_loss: 608140.9574; train_gene_expr_recon_loss: 20167783.0909; train_masked_gp_l1_reg_loss: 89094.8945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86870.6870; train_chrom_access_recon_loss: 905891.8807; train_global_loss: 21925339.2121; train_optim_loss: 21925339.2121; val_kl_reg_loss: 67509.1895; val_edge_recon_loss: 602081.4688; val_gene_expr_recon_loss: 20168787.5000; val_masked_gp_l1_reg_loss: 89880.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84968.3203; val_chrom_access_recon_loss: 904837.8281; val_global_loss: 21918063.7500; val_optim_loss: 21918063.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9230; val_auprc_score: 0.8965; val_best_acc_score: 0.8592; val_best_f1_score: 0.8681; train_kl_reg_loss: 67007.1930; train_edge_recon_loss: 605905.9934; train_gene_expr_recon_loss: 20071982.8788; train_masked_gp_l1_reg_loss: 90359.8416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83203.1693; train_chrom_access_recon_loss: 901595.5256; train_global_loss: 21820054.4242; train_optim_loss: 21820054.4242; val_kl_reg_loss: 65522.4067; val_edge_recon_loss: 598389.0156; val_gene_expr_recon_loss: 20233582.0000; val_masked_gp_l1_reg_loss: 90897.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81626.1562; val_chrom_access_recon_loss: 902884.6875; val_global_loss: 21972902.2500; val_optim_loss: 21972902.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9245; val_auprc_score: 0.8991; val_best_acc_score: 0.8584; val_best_f1_score: 0.8676; train_kl_reg_loss: 66433.4424; train_edge_recon_loss: 601518.3182; train_gene_expr_recon_loss: 20017489.0303; train_masked_gp_l1_reg_loss: 91312.9968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80003.6349; train_chrom_access_recon_loss: 899267.5189; train_global_loss: 21756025.0606; train_optim_loss: 21756025.0606; val_kl_reg_loss: 66673.6519; val_edge_recon_loss: 599740.7734; val_gene_expr_recon_loss: 19874014.0000; val_masked_gp_l1_reg_loss: 91598.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78947.1406; val_chrom_access_recon_loss: 900772.5703; val_global_loss: 21611746.7500; val_optim_loss: 21611746.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9165; val_auprc_score: 0.8838; val_best_acc_score: 0.8514; val_best_f1_score: 0.8616; train_kl_reg_loss: 66112.1603; train_edge_recon_loss: 598949.9015; train_gene_expr_recon_loss: 19958774.1212; train_masked_gp_l1_reg_loss: 92097.8400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77507.9709; train_chrom_access_recon_loss: 896881.6562; train_global_loss: 21690323.4848; train_optim_loss: 21690323.4848; val_kl_reg_loss: 66466.7275; val_edge_recon_loss: 613350.1016; val_gene_expr_recon_loss: 20047193.5000; val_masked_gp_l1_reg_loss: 92680.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76666.8984; val_chrom_access_recon_loss: 896185.4141; val_global_loss: 21792541.5000; val_optim_loss: 21792541.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9329; val_auprc_score: 0.9181; val_best_acc_score: 0.8681; val_best_f1_score: 0.8732; train_kl_reg_loss: 65357.0794; train_edge_recon_loss: 595895.6884; train_gene_expr_recon_loss: 19902499.1818; train_masked_gp_l1_reg_loss: 93068.6914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75377.1458; train_chrom_access_recon_loss: 894482.4025; train_global_loss: 21626680.2121; train_optim_loss: 21626680.2121; val_kl_reg_loss: 64075.1167; val_edge_recon_loss: 601822.3828; val_gene_expr_recon_loss: 19873417.0000; val_masked_gp_l1_reg_loss: 93654.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74848.4609; val_chrom_access_recon_loss: 887472.5156; val_global_loss: 21595289.0000; val_optim_loss: 21595289.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9326; val_auprc_score: 0.9111; val_best_acc_score: 0.8692; val_best_f1_score: 0.8773; train_kl_reg_loss: 64553.0302; train_edge_recon_loss: 594396.3731; train_gene_expr_recon_loss: 19837055.2727; train_masked_gp_l1_reg_loss: 93882.8029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73620.0949; train_chrom_access_recon_loss: 891666.1884; train_global_loss: 21555173.4242; train_optim_loss: 21555173.4242; val_kl_reg_loss: 63475.6138; val_edge_recon_loss: 593622.0859; val_gene_expr_recon_loss: 19823019.2500; val_masked_gp_l1_reg_loss: 94376.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72853.5000; val_chrom_access_recon_loss: 893762.6016; val_global_loss: 21541109.2500; val_optim_loss: 21541109.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9372; val_auprc_score: 0.9209; val_best_acc_score: 0.8713; val_best_f1_score: 0.8804; train_kl_reg_loss: 64194.2039; train_edge_recon_loss: 592689.8826; train_gene_expr_recon_loss: 19761154.1515; train_masked_gp_l1_reg_loss: 94685.5417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72019.7459; train_chrom_access_recon_loss: 888169.9801; train_global_loss: 21472913.4545; train_optim_loss: 21472913.4545; val_kl_reg_loss: 64121.1582; val_edge_recon_loss: 596340.0234; val_gene_expr_recon_loss: 19798658.5000; val_masked_gp_l1_reg_loss: 95095.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71443.5078; val_chrom_access_recon_loss: 890032.9844; val_global_loss: 21515692.7500; val_optim_loss: 21515692.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9339; val_auprc_score: 0.9096; val_best_acc_score: 0.8745; val_best_f1_score: 0.8820; train_kl_reg_loss: 63408.0750; train_edge_recon_loss: 590379.4271; train_gene_expr_recon_loss: 19706609.9697; train_masked_gp_l1_reg_loss: 95459.5907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70778.4549; train_chrom_access_recon_loss: 886274.0786; train_global_loss: 21412909.7879; train_optim_loss: 21412909.7879; val_kl_reg_loss: 65239.9292; val_edge_recon_loss: 599146.1094; val_gene_expr_recon_loss: 19778013.0000; val_masked_gp_l1_reg_loss: 95967.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71189.5547; val_chrom_access_recon_loss: 885392.8516; val_global_loss: 21494949.7500; val_optim_loss: 21494949.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9368; val_auprc_score: 0.9101; val_best_acc_score: 0.8794; val_best_f1_score: 0.8884; train_kl_reg_loss: 62632.9101; train_edge_recon_loss: 591248.9782; train_gene_expr_recon_loss: 19661442.7576; train_masked_gp_l1_reg_loss: 96346.3423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70173.9957; train_chrom_access_recon_loss: 884238.2491; train_global_loss: 21366083.3333; train_optim_loss: 21366083.3333; val_kl_reg_loss: 62365.4780; val_edge_recon_loss: 591542.3203; val_gene_expr_recon_loss: 19583670.7500; val_masked_gp_l1_reg_loss: 97108.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70113.8828; val_chrom_access_recon_loss: 877358.5156; val_global_loss: 21282158.7500; val_optim_loss: 21282158.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9477; val_auprc_score: 0.9326; val_best_acc_score: 0.8931; val_best_f1_score: 0.8997; train_kl_reg_loss: 62159.3963; train_edge_recon_loss: 590474.1241; train_gene_expr_recon_loss: 19625937.3030; train_masked_gp_l1_reg_loss: 97283.5148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69620.1631; train_chrom_access_recon_loss: 882753.1619; train_global_loss: 21328227.6364; train_optim_loss: 21328227.6364; val_kl_reg_loss: 62417.7974; val_edge_recon_loss: 585859.0938; val_gene_expr_recon_loss: 19698852.0000; val_masked_gp_l1_reg_loss: 97991.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69287.6094; val_chrom_access_recon_loss: 891741.9688; val_global_loss: 21406150.5000; val_optim_loss: 21406150.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9401; val_auprc_score: 0.9218; val_best_acc_score: 0.8842; val_best_f1_score: 0.8899; train_kl_reg_loss: 61395.3342; train_edge_recon_loss: 587775.1449; train_gene_expr_recon_loss: 19561051.0303; train_masked_gp_l1_reg_loss: 98505.0085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68803.7242; train_chrom_access_recon_loss: 880083.4811; train_global_loss: 21257613.9091; train_optim_loss: 21257613.9091; val_kl_reg_loss: 62684.2280; val_edge_recon_loss: 589589.2344; val_gene_expr_recon_loss: 19595609.5000; val_masked_gp_l1_reg_loss: 99183.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69100.6797; val_chrom_access_recon_loss: 882064.3438; val_global_loss: 21298231.0000; val_optim_loss: 21298231.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9439; val_auprc_score: 0.9240; val_best_acc_score: 0.8901; val_best_f1_score: 0.8956; train_kl_reg_loss: 61325.5671; train_edge_recon_loss: 585434.7348; train_gene_expr_recon_loss: 19492916.7879; train_masked_gp_l1_reg_loss: 99664.8661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68625.6856; train_chrom_access_recon_loss: 877929.6979; train_global_loss: 21185897.3636; train_optim_loss: 21185897.3636; val_kl_reg_loss: 60221.7529; val_edge_recon_loss: 587410.0000; val_gene_expr_recon_loss: 19532264.2500; val_masked_gp_l1_reg_loss: 100381.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69291.5625; val_chrom_access_recon_loss: 873773.7500; val_global_loss: 21223343.5000; val_optim_loss: 21223343.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9418; val_auprc_score: 0.9214; val_best_acc_score: 0.8834; val_best_f1_score: 0.8892; train_kl_reg_loss: 60493.8297; train_edge_recon_loss: 585299.6222; train_gene_expr_recon_loss: 19450975.6061; train_masked_gp_l1_reg_loss: 101002.7874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68529.5240; train_chrom_access_recon_loss: 876090.1089; train_global_loss: 21142391.0909; train_optim_loss: 21142391.0909; val_kl_reg_loss: 59938.8389; val_edge_recon_loss: 590373.9844; val_gene_expr_recon_loss: 19359907.5000; val_masked_gp_l1_reg_loss: 101799.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68067.3516; val_chrom_access_recon_loss: 873328.9062; val_global_loss: 21053417.2500; val_optim_loss: 21053417.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9424; val_auprc_score: 0.9205; val_best_acc_score: 0.8901; val_best_f1_score: 0.8948; train_kl_reg_loss: 59771.0829; train_edge_recon_loss: 585416.1212; train_gene_expr_recon_loss: 19391666.2727; train_masked_gp_l1_reg_loss: 102482.3641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67865.8370; train_chrom_access_recon_loss: 874922.8390; train_global_loss: 21082124.7273; train_optim_loss: 21082124.7273; val_kl_reg_loss: 60530.8584; val_edge_recon_loss: 590421.1719; val_gene_expr_recon_loss: 19512850.5000; val_masked_gp_l1_reg_loss: 103352.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67860.7344; val_chrom_access_recon_loss: 875439.9375; val_global_loss: 21210454.0000; val_optim_loss: 21210454.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9420; val_auprc_score: 0.9197; val_best_acc_score: 0.8855; val_best_f1_score: 0.8923; train_kl_reg_loss: 59044.0551; train_edge_recon_loss: 585794.5919; train_gene_expr_recon_loss: 19329738.3030; train_masked_gp_l1_reg_loss: 104113.2075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67527.4190; train_chrom_access_recon_loss: 872994.3002; train_global_loss: 21019211.7273; train_optim_loss: 21019211.7273; val_kl_reg_loss: 61470.1387; val_edge_recon_loss: 595948.1016; val_gene_expr_recon_loss: 19350441.0000; val_masked_gp_l1_reg_loss: 105132.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67504.7812; val_chrom_access_recon_loss: 873319.2812; val_global_loss: 21053814.2500; val_optim_loss: 21053814.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9413; val_auprc_score: 0.9194; val_best_acc_score: 0.8796; val_best_f1_score: 0.8861; train_kl_reg_loss: 58712.8961; train_edge_recon_loss: 584637.7936; train_gene_expr_recon_loss: 19281877.0606; train_masked_gp_l1_reg_loss: 105887.7539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67049.4049; train_chrom_access_recon_loss: 871489.7017; train_global_loss: 20969654.8182; train_optim_loss: 20969654.8182; val_kl_reg_loss: 58949.6924; val_edge_recon_loss: 594142.9922; val_gene_expr_recon_loss: 19151363.2500; val_masked_gp_l1_reg_loss: 106780.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66952.3047; val_chrom_access_recon_loss: 867813.6797; val_global_loss: 20846001.2500; val_optim_loss: 20846001.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9488; val_auprc_score: 0.9351; val_best_acc_score: 0.8923; val_best_f1_score: 0.8972; train_kl_reg_loss: 57811.7490; train_edge_recon_loss: 586243.3106; train_gene_expr_recon_loss: 19212188.8182; train_masked_gp_l1_reg_loss: 107654.4908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66712.0408; train_chrom_access_recon_loss: 869777.9792; train_global_loss: 20900388.3939; train_optim_loss: 20900388.3939; val_kl_reg_loss: 57136.0518; val_edge_recon_loss: 589248.7656; val_gene_expr_recon_loss: 19290573.2500; val_masked_gp_l1_reg_loss: 108663.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66220.1094; val_chrom_access_recon_loss: 867219.6406; val_global_loss: 20979062.0000; val_optim_loss: 20979062.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9393; val_auprc_score: 0.9151; val_best_acc_score: 0.8855; val_best_f1_score: 0.8920; train_kl_reg_loss: 57552.5753; train_edge_recon_loss: 583869.0985; train_gene_expr_recon_loss: 19159344.3939; train_masked_gp_l1_reg_loss: 109521.1222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66135.3593; train_chrom_access_recon_loss: 868667.3598; train_global_loss: 20845089.9091; train_optim_loss: 20845089.9091; val_kl_reg_loss: 57559.6128; val_edge_recon_loss: 595620.5391; val_gene_expr_recon_loss: 19261344.7500; val_masked_gp_l1_reg_loss: 110371.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66389.5078; val_chrom_access_recon_loss: 873975.3359; val_global_loss: 20965262.2500; val_optim_loss: 20965262.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9351; val_auprc_score: 0.9042; val_best_acc_score: 0.8847; val_best_f1_score: 0.8921; train_kl_reg_loss: 57083.2791; train_edge_recon_loss: 584427.1553; train_gene_expr_recon_loss: 19089604.2424; train_masked_gp_l1_reg_loss: 111404.1854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66142.7551; train_chrom_access_recon_loss: 867013.0862; train_global_loss: 20775674.8182; train_optim_loss: 20775674.8182; val_kl_reg_loss: 57158.9590; val_edge_recon_loss: 588338.3047; val_gene_expr_recon_loss: 19112697.2500; val_masked_gp_l1_reg_loss: 112393.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66329.0938; val_chrom_access_recon_loss: 867963.2812; val_global_loss: 20804882.0000; val_optim_loss: 20804882.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9492; val_auprc_score: 0.9245; val_best_acc_score: 0.8960; val_best_f1_score: 0.9019; train_kl_reg_loss: 56759.8781; train_edge_recon_loss: 583576.7566; train_gene_expr_recon_loss: 19018733.6061; train_masked_gp_l1_reg_loss: 113346.8701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66098.0517; train_chrom_access_recon_loss: 865244.4735; train_global_loss: 20703759.2424; train_optim_loss: 20703759.2424; val_kl_reg_loss: 55414.8423; val_edge_recon_loss: 582498.5625; val_gene_expr_recon_loss: 19181068.2500; val_masked_gp_l1_reg_loss: 114215.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66267.3047; val_chrom_access_recon_loss: 872089.6797; val_global_loss: 20871555.7500; val_optim_loss: 20871555.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9419; val_auprc_score: 0.9238; val_best_acc_score: 0.8885; val_best_f1_score: 0.8945; train_kl_reg_loss: 56510.4132; train_edge_recon_loss: 583469.9697; train_gene_expr_recon_loss: 18961498.9394; train_masked_gp_l1_reg_loss: 115092.1939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65892.8970; train_chrom_access_recon_loss: 863560.3116; train_global_loss: 20646025.0303; train_optim_loss: 20646025.0303; val_kl_reg_loss: 57267.8354; val_edge_recon_loss: 591821.5312; val_gene_expr_recon_loss: 19071865.7500; val_masked_gp_l1_reg_loss: 115900.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65591.3281; val_chrom_access_recon_loss: 863235.0000; val_global_loss: 20765682.0000; val_optim_loss: 20765682.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9440; val_auprc_score: 0.9242; val_best_acc_score: 0.8931; val_best_f1_score: 0.8966; train_kl_reg_loss: 56523.7575; train_edge_recon_loss: 583827.6619; train_gene_expr_recon_loss: 18915138.0909; train_masked_gp_l1_reg_loss: 116725.7346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65959.8071; train_chrom_access_recon_loss: 863112.3125; train_global_loss: 20601287.5455; train_optim_loss: 20601287.5455; val_kl_reg_loss: 56389.5767; val_edge_recon_loss: 583176.8438; val_gene_expr_recon_loss: 18979298.2500; val_masked_gp_l1_reg_loss: 117660.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65659.3281; val_chrom_access_recon_loss: 865581.3984; val_global_loss: 20667765.7500; val_optim_loss: 20667765.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9479; val_auprc_score: 0.9276; val_best_acc_score: 0.8928; val_best_f1_score: 0.8989; train_kl_reg_loss: 56344.7454; train_edge_recon_loss: 583659.8258; train_gene_expr_recon_loss: 18851140.2121; train_masked_gp_l1_reg_loss: 118353.5450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66032.3116; train_chrom_access_recon_loss: 861820.0426; train_global_loss: 20537350.7273; train_optim_loss: 20537350.7273; val_kl_reg_loss: 56658.4380; val_edge_recon_loss: 586521.7969; val_gene_expr_recon_loss: 19177633.5000; val_masked_gp_l1_reg_loss: 119153.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66563.1172; val_chrom_access_recon_loss: 871691.8438; val_global_loss: 20878223.0000; val_optim_loss: 20878223.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9444; val_auprc_score: 0.9260; val_best_acc_score: 0.8864; val_best_f1_score: 0.8928; train_kl_reg_loss: 56337.8577; train_edge_recon_loss: 582437.7576; train_gene_expr_recon_loss: 18787788.2121; train_masked_gp_l1_reg_loss: 119744.9020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66259.1900; train_chrom_access_recon_loss: 861052.0123; train_global_loss: 20473619.8182; train_optim_loss: 20473619.8182; val_kl_reg_loss: 56432.7271; val_edge_recon_loss: 591403.2969; val_gene_expr_recon_loss: 18905713.2500; val_masked_gp_l1_reg_loss: 120503.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66268.9922; val_chrom_access_recon_loss: 864128.1328; val_global_loss: 20604449.2500; val_optim_loss: 20604449.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9482; val_auprc_score: 0.9291; val_best_acc_score: 0.8941; val_best_f1_score: 0.8991; train_kl_reg_loss: 56371.9090; train_edge_recon_loss: 582030.2907; train_gene_expr_recon_loss: 18710855.0000; train_masked_gp_l1_reg_loss: 121064.5965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65998.6440; train_chrom_access_recon_loss: 858393.2926; train_global_loss: 20394713.7273; train_optim_loss: 20394713.7273; val_kl_reg_loss: 56390.6880; val_edge_recon_loss: 588291.1016; val_gene_expr_recon_loss: 18931544.0000; val_masked_gp_l1_reg_loss: 121650.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66856.7031; val_chrom_access_recon_loss: 863117.8203; val_global_loss: 20627849.2500; val_optim_loss: 20627849.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9458; val_auprc_score: 0.9254; val_best_acc_score: 0.8933; val_best_f1_score: 0.8999; train_kl_reg_loss: 56377.8094; train_edge_recon_loss: 582611.0587; train_gene_expr_recon_loss: 18663477.4848; train_masked_gp_l1_reg_loss: 122286.2865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66386.7264; train_chrom_access_recon_loss: 857261.8807; train_global_loss: 20348401.4545; train_optim_loss: 20348401.4545; val_kl_reg_loss: 57668.4917; val_edge_recon_loss: 588360.8828; val_gene_expr_recon_loss: 18844677.7500; val_masked_gp_l1_reg_loss: 122972.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66193.6562; val_chrom_access_recon_loss: 860897.0234; val_global_loss: 20540770.0000; val_optim_loss: 20540770.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9451; val_auprc_score: 0.9168; val_best_acc_score: 0.8928; val_best_f1_score: 0.8970; train_kl_reg_loss: 56409.3815; train_edge_recon_loss: 584591.0739; train_gene_expr_recon_loss: 18614557.8788; train_masked_gp_l1_reg_loss: 123566.5094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66286.1257; train_chrom_access_recon_loss: 857060.2027; train_global_loss: 20302471.3636; train_optim_loss: 20302471.3636; val_kl_reg_loss: 55916.1304; val_edge_recon_loss: 586972.0234; val_gene_expr_recon_loss: 18648628.0000; val_masked_gp_l1_reg_loss: 124160.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66220.3125; val_chrom_access_recon_loss: 856399.6172; val_global_loss: 20338295.5000; val_optim_loss: 20338295.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9451; val_auprc_score: 0.9186; val_best_acc_score: 0.8944; val_best_f1_score: 0.8991; train_kl_reg_loss: 56352.6404; train_edge_recon_loss: 582996.7348; train_gene_expr_recon_loss: 18566720.4242; train_masked_gp_l1_reg_loss: 124662.1119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66357.6854; train_chrom_access_recon_loss: 856477.1307; train_global_loss: 20253566.7879; train_optim_loss: 20253566.7879; val_kl_reg_loss: 56650.4404; val_edge_recon_loss: 584453.6562; val_gene_expr_recon_loss: 18926442.5000; val_masked_gp_l1_reg_loss: 125170.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66179.8750; val_chrom_access_recon_loss: 865968.6406; val_global_loss: 20624865.2500; val_optim_loss: 20624865.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9408; val_auprc_score: 0.9129; val_best_acc_score: 0.8933; val_best_f1_score: 0.8992; train_kl_reg_loss: 56781.6904; train_edge_recon_loss: 583309.7860; train_gene_expr_recon_loss: 18505165.7273; train_masked_gp_l1_reg_loss: 125623.3957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66318.5398; train_chrom_access_recon_loss: 854834.1771; train_global_loss: 20192033.2727; train_optim_loss: 20192033.2727; val_kl_reg_loss: 57621.6235; val_edge_recon_loss: 588157.9219; val_gene_expr_recon_loss: 18886419.5000; val_masked_gp_l1_reg_loss: 126024.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66362.8906; val_chrom_access_recon_loss: 864202.4141; val_global_loss: 20588787.2500; val_optim_loss: 20588787.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9498; val_auprc_score: 0.9291; val_best_acc_score: 0.9003; val_best_f1_score: 0.9051; train_kl_reg_loss: 56892.1154; train_edge_recon_loss: 581937.8684; train_gene_expr_recon_loss: 18474265.2424; train_masked_gp_l1_reg_loss: 126443.4486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66367.2872; train_chrom_access_recon_loss: 855249.7491; train_global_loss: 20161155.6667; train_optim_loss: 20161155.6667; val_kl_reg_loss: 56989.2847; val_edge_recon_loss: 583467.9297; val_gene_expr_recon_loss: 18612766.5000; val_masked_gp_l1_reg_loss: 126809.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66754.7500; val_chrom_access_recon_loss: 857459.4531; val_global_loss: 20304247.5000; val_optim_loss: 20304247.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9427; val_auprc_score: 0.9171; val_best_acc_score: 0.8872; val_best_f1_score: 0.8929; train_kl_reg_loss: 57357.1515; train_edge_recon_loss: 583659.4830; train_gene_expr_recon_loss: 18419826.6061; train_masked_gp_l1_reg_loss: 127173.8201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66477.2797; train_chrom_access_recon_loss: 854120.0502; train_global_loss: 20108614.2727; train_optim_loss: 20108614.2727; val_kl_reg_loss: 57581.8364; val_edge_recon_loss: 589963.3906; val_gene_expr_recon_loss: 18758766.0000; val_masked_gp_l1_reg_loss: 127686.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67150.0547; val_chrom_access_recon_loss: 856582.1953; val_global_loss: 20457728.7500; val_optim_loss: 20457728.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9448; val_auprc_score: 0.9182; val_best_acc_score: 0.8925; val_best_f1_score: 0.8965; train_kl_reg_loss: 57822.7820; train_edge_recon_loss: 583351.6117; train_gene_expr_recon_loss: 18376320.6061; train_masked_gp_l1_reg_loss: 127896.8362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66862.9225; train_chrom_access_recon_loss: 851908.4688; train_global_loss: 20064163.3333; train_optim_loss: 20064163.3333; val_kl_reg_loss: 58738.0352; val_edge_recon_loss: 590455.6172; val_gene_expr_recon_loss: 18583537.0000; val_masked_gp_l1_reg_loss: 128155.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66466.2109; val_chrom_access_recon_loss: 853244.7734; val_global_loss: 20280596.7500; val_optim_loss: 20280596.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9475; val_auprc_score: 0.9286; val_best_acc_score: 0.8885; val_best_f1_score: 0.8944; train_kl_reg_loss: 57982.2038; train_edge_recon_loss: 583222.1496; train_gene_expr_recon_loss: 18317389.4848; train_masked_gp_l1_reg_loss: 128511.8807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66276.2575; train_chrom_access_recon_loss: 851454.2595; train_global_loss: 20004836.1212; train_optim_loss: 20004836.1212; val_kl_reg_loss: 57192.7168; val_edge_recon_loss: 591388.1328; val_gene_expr_recon_loss: 18635110.7500; val_masked_gp_l1_reg_loss: 129124.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67441.9062; val_chrom_access_recon_loss: 856255.4141; val_global_loss: 20336512.5000; val_optim_loss: 20336512.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9419; val_auprc_score: 0.9111; val_best_acc_score: 0.8966; val_best_f1_score: 0.9017; train_kl_reg_loss: 57967.3899; train_edge_recon_loss: 584032.5814; train_gene_expr_recon_loss: 18267845.9091; train_masked_gp_l1_reg_loss: 129342.8333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66564.3658; train_chrom_access_recon_loss: 849458.5331; train_global_loss: 19955211.4545; train_optim_loss: 19955211.4545; val_kl_reg_loss: 58574.5259; val_edge_recon_loss: 590877.8203; val_gene_expr_recon_loss: 18518564.5000; val_masked_gp_l1_reg_loss: 129952.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67246.2812; val_chrom_access_recon_loss: 853726.5703; val_global_loss: 20218941.7500; val_optim_loss: 20218941.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9440; val_auprc_score: 0.9213; val_best_acc_score: 0.8944; val_best_f1_score: 0.8979; train_kl_reg_loss: 58309.2991; train_edge_recon_loss: 583050.0265; train_gene_expr_recon_loss: 18232643.7273; train_masked_gp_l1_reg_loss: 130177.3258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66922.0314; train_chrom_access_recon_loss: 849110.7917; train_global_loss: 19920213.0303; train_optim_loss: 19920213.0303; val_kl_reg_loss: 59381.0830; val_edge_recon_loss: 592905.4766; val_gene_expr_recon_loss: 18481472.2500; val_masked_gp_l1_reg_loss: 130625.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67054.4062; val_chrom_access_recon_loss: 855791.0391; val_global_loss: 20187230.0000; val_optim_loss: 20187230.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9421; val_auprc_score: 0.9225; val_best_acc_score: 0.8850; val_best_f1_score: 0.8929; train_kl_reg_loss: 50844.1359; train_edge_recon_loss: 601510.3797; train_gene_expr_recon_loss: 18788692.1212; train_masked_gp_l1_reg_loss: 135394.7859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72825.0548; train_chrom_access_recon_loss: 858166.1288; train_global_loss: 20507432.5758; train_optim_loss: 20507432.5758; val_kl_reg_loss: 53290.3154; val_edge_recon_loss: 596983.3594; val_gene_expr_recon_loss: 18922080.0000; val_masked_gp_l1_reg_loss: 132950.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71735.6250; val_chrom_access_recon_loss: 859740.9766; val_global_loss: 20636781.0000; val_optim_loss: 20636781.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9468; val_auprc_score: 0.9316; val_best_acc_score: 0.8842; val_best_f1_score: 0.8915; train_kl_reg_loss: 55961.7982; train_edge_recon_loss: 585889.2689; train_gene_expr_recon_loss: 18663021.4848; train_masked_gp_l1_reg_loss: 129197.1946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68526.8066; train_chrom_access_recon_loss: 851970.4631; train_global_loss: 20354566.8788; train_optim_loss: 20354566.8788; val_kl_reg_loss: 55852.1421; val_edge_recon_loss: 588075.7031; val_gene_expr_recon_loss: 18781482.0000; val_masked_gp_l1_reg_loss: 127089.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66929.7188; val_chrom_access_recon_loss: 855640.6641; val_global_loss: 20475070.5000; val_optim_loss: 20475070.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9390; val_auprc_score: 0.9139; val_best_acc_score: 0.8888; val_best_f1_score: 0.8933; train_kl_reg_loss: 56110.4992; train_edge_recon_loss: 583116.9394; train_gene_expr_recon_loss: 18608681.0909; train_masked_gp_l1_reg_loss: 126757.8327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66716.7537; train_chrom_access_recon_loss: 850853.7074; train_global_loss: 20292236.6667; train_optim_loss: 20292236.6667; val_kl_reg_loss: 54099.7734; val_edge_recon_loss: 590176.5547; val_gene_expr_recon_loss: 18730289.0000; val_masked_gp_l1_reg_loss: 127033.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66683.3203; val_chrom_access_recon_loss: 854732.5312; val_global_loss: 20423015.5000; val_optim_loss: 20423015.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9462; val_auprc_score: 0.9258; val_best_acc_score: 0.8896; val_best_f1_score: 0.8964; train_kl_reg_loss: 57504.7905; train_edge_recon_loss: 586719.7633; train_gene_expr_recon_loss: 18718453.4848; train_masked_gp_l1_reg_loss: 128271.9521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68203.7879; train_chrom_access_recon_loss: 854258.7566; train_global_loss: 20413412.1212; train_optim_loss: 20413412.1212; val_kl_reg_loss: 61224.8647; val_edge_recon_loss: 584369.7344; val_gene_expr_recon_loss: 18765520.0000; val_masked_gp_l1_reg_loss: 127055.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67258.6641; val_chrom_access_recon_loss: 853920.3359; val_global_loss: 20459349.0000; val_optim_loss: 20459349.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9493; val_auprc_score: 0.9281; val_best_acc_score: 0.8963; val_best_f1_score: 0.9006; train_kl_reg_loss: 61113.2024; train_edge_recon_loss: 583427.6080; train_gene_expr_recon_loss: 18618042.9697; train_masked_gp_l1_reg_loss: 123020.0485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53521.8754; train_chrom_access_recon_loss: 850603.8343; train_global_loss: 20289729.2727; train_optim_loss: 20289729.2727; val_kl_reg_loss: 61738.7339; val_edge_recon_loss: 587986.9609; val_gene_expr_recon_loss: 18784819.2500; val_masked_gp_l1_reg_loss: 120946.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49244.5312; val_chrom_access_recon_loss: 849159.1172; val_global_loss: 20453894.0000; val_optim_loss: 20453894.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9439; val_auprc_score: 0.9194; val_best_acc_score: 0.8941; val_best_f1_score: 0.8994; train_kl_reg_loss: 61397.2972; train_edge_recon_loss: 582621.6591; train_gene_expr_recon_loss: 18556340.7879; train_masked_gp_l1_reg_loss: 120272.2392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48602.6222; train_chrom_access_recon_loss: 848319.6345; train_global_loss: 20217554.3030; train_optim_loss: 20217554.3030; val_kl_reg_loss: 61756.7803; val_edge_recon_loss: 587385.5078; val_gene_expr_recon_loss: 18794721.2500; val_masked_gp_l1_reg_loss: 119781.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48137.2422; val_chrom_access_recon_loss: 851386.7656; val_global_loss: 20463170.7500; val_optim_loss: 20463170.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9469; val_auprc_score: 0.9261; val_best_acc_score: 0.8960; val_best_f1_score: 0.9000; train_kl_reg_loss: 61366.8089; train_edge_recon_loss: 581881.0284; train_gene_expr_recon_loss: 18542861.3333; train_masked_gp_l1_reg_loss: 119464.7932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47836.4426; train_chrom_access_recon_loss: 848184.1780; train_global_loss: 20201594.5455; train_optim_loss: 20201594.5455; val_kl_reg_loss: 61596.9072; val_edge_recon_loss: 586046.8984; val_gene_expr_recon_loss: 18763393.5000; val_masked_gp_l1_reg_loss: 119193.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47541.4805; val_chrom_access_recon_loss: 856307.3984; val_global_loss: 20434080.5000; val_optim_loss: 20434080.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9414; val_auprc_score: 0.9168; val_best_acc_score: 0.8872; val_best_f1_score: 0.8941; train_kl_reg_loss: 61314.7879; train_edge_recon_loss: 580085.8134; train_gene_expr_recon_loss: 18526034.3636; train_masked_gp_l1_reg_loss: 119043.6377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47353.3293; train_chrom_access_recon_loss: 847762.0909; train_global_loss: 20181594.1515; train_optim_loss: 20181594.1515; val_kl_reg_loss: 61762.8877; val_edge_recon_loss: 588722.5234; val_gene_expr_recon_loss: 18660703.5000; val_masked_gp_l1_reg_loss: 118894.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47126.6523; val_chrom_access_recon_loss: 849998.7578; val_global_loss: 20327207.7500; val_optim_loss: 20327207.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 8 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9441
val AUPRC score: 0.9173
val best accuracy score: 0.8928
val best F1 score: 0.8977
val target rna MSE score: 1.2123
val source rna MSE score: 0.6414
val target atac MSE score: 0.4781
val source atac MSE score: 0.2060
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
