[True]
Run timestamp: 07092023_063552_284.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_284']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 26065 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 30568, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 26065
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 26065

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7042; val_auprc_score: 0.6866; val_best_acc_score: 0.5105; val_best_f1_score: 0.6693; train_kl_reg_loss: 60309.4698; train_edge_recon_loss: 3596567.0947; train_gene_expr_recon_loss: 17230885.3485; train_masked_gp_l1_reg_loss: 49207.0189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10054547.6932; train_chrom_access_recon_loss: 59210136.1212; train_global_loss: 90201653.0909; train_optim_loss: 90201653.0909; val_kl_reg_loss: 64867.6323; val_edge_recon_loss: 4063988.0312; val_gene_expr_recon_loss: 15711758.3750; val_masked_gp_l1_reg_loss: 46211.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3699534.2500; val_chrom_access_recon_loss: 57222894.0000; val_global_loss: 80809253.0000; val_optim_loss: 80809253.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6822; val_auprc_score: 0.6704; val_best_acc_score: 0.5129; val_best_f1_score: 0.6695; train_kl_reg_loss: 118505.0080; train_edge_recon_loss: 3606323.9811; train_gene_expr_recon_loss: 15190091.5455; train_masked_gp_l1_reg_loss: 42516.6072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1427862.6610; train_chrom_access_recon_loss: 56073918.4848; train_global_loss: 76459218.3030; train_optim_loss: 76459218.3030; val_kl_reg_loss: 134476.4785; val_edge_recon_loss: 4063700.5938; val_gene_expr_recon_loss: 15025250.6250; val_masked_gp_l1_reg_loss: 39143.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 536472.6250; val_chrom_access_recon_loss: 56066557.5000; val_global_loss: 75865600.0000; val_optim_loss: 75865600.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7470; val_auprc_score: 0.7338; val_best_acc_score: 0.6247; val_best_f1_score: 0.7101; train_kl_reg_loss: 135551.7114; train_edge_recon_loss: 3548968.7538; train_gene_expr_recon_loss: 14703639.0455; train_masked_gp_l1_reg_loss: 37775.9171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 400743.2249; train_chrom_access_recon_loss: 55383254.6667; train_global_loss: 74209933.5758; train_optim_loss: 74209933.5758; val_kl_reg_loss: 138279.3555; val_edge_recon_loss: 4058067.9375; val_gene_expr_recon_loss: 14778802.6250; val_masked_gp_l1_reg_loss: 37318.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 309117.0938; val_chrom_access_recon_loss: 55840886.5000; val_global_loss: 75162473.0000; val_optim_loss: 75162473.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8068; val_auprc_score: 0.7822; val_best_acc_score: 0.7187; val_best_f1_score: 0.7348; train_kl_reg_loss: 124657.0839; train_edge_recon_loss: 3537361.3598; train_gene_expr_recon_loss: 14548925.5152; train_masked_gp_l1_reg_loss: 37888.7936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 266920.4015; train_chrom_access_recon_loss: 55036601.9394; train_global_loss: 73552355.3939; train_optim_loss: 73552355.3939; val_kl_reg_loss: 118879.8154; val_edge_recon_loss: 4019514.9375; val_gene_expr_recon_loss: 14739071.2500; val_masked_gp_l1_reg_loss: 38798.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 235092.4688; val_chrom_access_recon_loss: 55626266.5000; val_global_loss: 74777622.0000; val_optim_loss: 74777622.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8470; val_auprc_score: 0.8165; val_best_acc_score: 0.7684; val_best_f1_score: 0.7895; train_kl_reg_loss: 110885.6746; train_edge_recon_loss: 3512209.7386; train_gene_expr_recon_loss: 14446783.2879; train_masked_gp_l1_reg_loss: 39935.1787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 216775.4250; train_chrom_access_recon_loss: 54664944.1212; train_global_loss: 72991533.4545; train_optim_loss: 72991533.4545; val_kl_reg_loss: 93960.9717; val_edge_recon_loss: 3798631.2500; val_gene_expr_recon_loss: 14606022.5000; val_masked_gp_l1_reg_loss: 41210.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202477.6875; val_chrom_access_recon_loss: 55340320.5000; val_global_loss: 74082624.0000; val_optim_loss: 74082624.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8272; val_auprc_score: 0.7833; val_best_acc_score: 0.7461; val_best_f1_score: 0.7896; train_kl_reg_loss: 98028.6430; train_edge_recon_loss: 3273496.9129; train_gene_expr_recon_loss: 14379932.7879; train_masked_gp_l1_reg_loss: 42459.3993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 193241.9496; train_chrom_access_recon_loss: 54430707.2727; train_global_loss: 72417867.0303; train_optim_loss: 72417867.0303; val_kl_reg_loss: 117182.9238; val_edge_recon_loss: 3046671.9062; val_gene_expr_recon_loss: 14528141.5000; val_masked_gp_l1_reg_loss: 43913.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185678.7188; val_chrom_access_recon_loss: 55068884.5000; val_global_loss: 72990473.0000; val_optim_loss: 72990473.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8300; val_auprc_score: 0.7807; val_best_acc_score: 0.7633; val_best_f1_score: 0.7863; train_kl_reg_loss: 132809.0929; train_edge_recon_loss: 3019738.5947; train_gene_expr_recon_loss: 14297680.3182; train_masked_gp_l1_reg_loss: 44870.3161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180143.1558; train_chrom_access_recon_loss: 54165448.5455; train_global_loss: 71840690.1212; train_optim_loss: 71840690.1212; val_kl_reg_loss: 134358.9980; val_edge_recon_loss: 3017188.4375; val_gene_expr_recon_loss: 14479289.0000; val_masked_gp_l1_reg_loss: 45787.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175243.7344; val_chrom_access_recon_loss: 54722160.0000; val_global_loss: 72574029.0000; val_optim_loss: 72574029.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8299; val_auprc_score: 0.7817; val_best_acc_score: 0.7684; val_best_f1_score: 0.7930; train_kl_reg_loss: 136931.3400; train_edge_recon_loss: 2985373.1932; train_gene_expr_recon_loss: 14220761.8182; train_masked_gp_l1_reg_loss: 46530.5853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170930.1544; train_chrom_access_recon_loss: 53938137.2727; train_global_loss: 71498664.6061; train_optim_loss: 71498664.6061; val_kl_reg_loss: 130233.1992; val_edge_recon_loss: 3023785.9375; val_gene_expr_recon_loss: 14337655.3750; val_masked_gp_l1_reg_loss: 47291.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167862.3125; val_chrom_access_recon_loss: 53699650.0000; val_global_loss: 71406479.0000; val_optim_loss: 71406479.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8254; val_auprc_score: 0.7810; val_best_acc_score: 0.7681; val_best_f1_score: 0.7978; train_kl_reg_loss: 131255.8265; train_edge_recon_loss: 2972320.5492; train_gene_expr_recon_loss: 14167417.8939; train_masked_gp_l1_reg_loss: 48037.4788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164882.2192; train_chrom_access_recon_loss: 53706184.8485; train_global_loss: 71190098.6061; train_optim_loss: 71190098.6061; val_kl_reg_loss: 131756.9980; val_edge_recon_loss: 3003033.5312; val_gene_expr_recon_loss: 14247547.6250; val_masked_gp_l1_reg_loss: 48836.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162632.1406; val_chrom_access_recon_loss: 54367203.0000; val_global_loss: 71961010.0000; val_optim_loss: 71961010.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8473; val_auprc_score: 0.8058; val_best_acc_score: 0.7888; val_best_f1_score: 0.8149; train_kl_reg_loss: 128561.3571; train_edge_recon_loss: 2941011.8523; train_gene_expr_recon_loss: 14103761.5606; train_masked_gp_l1_reg_loss: 49463.0516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160428.3984; train_chrom_access_recon_loss: 53500835.2121; train_global_loss: 70884061.9394; train_optim_loss: 70884061.9394; val_kl_reg_loss: 124226.3457; val_edge_recon_loss: 2923955.0312; val_gene_expr_recon_loss: 14192513.8750; val_masked_gp_l1_reg_loss: 50266.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158637.6406; val_chrom_access_recon_loss: 54263747.5000; val_global_loss: 71713346.0000; val_optim_loss: 71713346.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8530; val_auprc_score: 0.8113; val_best_acc_score: 0.7904; val_best_f1_score: 0.8193; train_kl_reg_loss: 126189.4418; train_edge_recon_loss: 2917406.1439; train_gene_expr_recon_loss: 14063541.0758; train_masked_gp_l1_reg_loss: 50757.9094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157016.7978; train_chrom_access_recon_loss: 53291354.7273; train_global_loss: 70606265.7576; train_optim_loss: 70606265.7576; val_kl_reg_loss: 122564.1143; val_edge_recon_loss: 2899228.1875; val_gene_expr_recon_loss: 14142900.0000; val_masked_gp_l1_reg_loss: 51462.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156385.3750; val_chrom_access_recon_loss: 53677932.5000; val_global_loss: 71050475.0000; val_optim_loss: 71050475.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8654; val_auprc_score: 0.8306; val_best_acc_score: 0.8074; val_best_f1_score: 0.8304; train_kl_reg_loss: 127235.2829; train_edge_recon_loss: 2878264.1856; train_gene_expr_recon_loss: 14006215.0606; train_masked_gp_l1_reg_loss: 51912.0318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154521.3234; train_chrom_access_recon_loss: 53116016.4242; train_global_loss: 70334164.2424; train_optim_loss: 70334164.2424; val_kl_reg_loss: 123368.9727; val_edge_recon_loss: 2872257.1250; val_gene_expr_recon_loss: 14105697.3750; val_masked_gp_l1_reg_loss: 52513.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153596.1875; val_chrom_access_recon_loss: 53488290.5000; val_global_loss: 70795723.0000; val_optim_loss: 70795723.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8698; val_auprc_score: 0.8390; val_best_acc_score: 0.8028; val_best_f1_score: 0.8277; train_kl_reg_loss: 126867.8701; train_edge_recon_loss: 2858665.2803; train_gene_expr_recon_loss: 13957881.9091; train_masked_gp_l1_reg_loss: 53136.6196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152175.0902; train_chrom_access_recon_loss: 52901484.1212; train_global_loss: 70050211.0303; train_optim_loss: 70050211.0303; val_kl_reg_loss: 125462.0439; val_edge_recon_loss: 2889870.5000; val_gene_expr_recon_loss: 14228648.7500; val_masked_gp_l1_reg_loss: 53747.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151331.2656; val_chrom_access_recon_loss: 53276866.5000; val_global_loss: 70725927.0000; val_optim_loss: 70725927.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8575; val_auprc_score: 0.8079; val_best_acc_score: 0.8004; val_best_f1_score: 0.8261; train_kl_reg_loss: 126129.7455; train_edge_recon_loss: 2865372.7462; train_gene_expr_recon_loss: 13918001.6364; train_masked_gp_l1_reg_loss: 54219.0094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149882.0114; train_chrom_access_recon_loss: 52720394.7273; train_global_loss: 69834000.2424; train_optim_loss: 69834000.2424; val_kl_reg_loss: 126597.8125; val_edge_recon_loss: 2925782.6875; val_gene_expr_recon_loss: 14048929.5000; val_masked_gp_l1_reg_loss: 54823.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148700.5156; val_chrom_access_recon_loss: 53204982.5000; val_global_loss: 70509817.0000; val_optim_loss: 70509817.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8632; val_auprc_score: 0.8214; val_best_acc_score: 0.7963; val_best_f1_score: 0.8223; train_kl_reg_loss: 123589.3967; train_edge_recon_loss: 2863219.1288; train_gene_expr_recon_loss: 13874696.9394; train_masked_gp_l1_reg_loss: 55289.3100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148292.9858; train_chrom_access_recon_loss: 52544349.6970; train_global_loss: 69609437.3333; train_optim_loss: 69609437.3333; val_kl_reg_loss: 122399.3584; val_edge_recon_loss: 2913783.9375; val_gene_expr_recon_loss: 13937698.6250; val_masked_gp_l1_reg_loss: 56111.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148434.2500; val_chrom_access_recon_loss: 53108157.0000; val_global_loss: 70286585.5000; val_optim_loss: 70286585.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8701; val_auprc_score: 0.8337; val_best_acc_score: 0.8057; val_best_f1_score: 0.8304; train_kl_reg_loss: 123791.4833; train_edge_recon_loss: 2842448.3750; train_gene_expr_recon_loss: 13874434.1212; train_masked_gp_l1_reg_loss: 56319.4872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147045.8705; train_chrom_access_recon_loss: 52406541.9394; train_global_loss: 69450581.4545; train_optim_loss: 69450581.4545; val_kl_reg_loss: 123257.6191; val_edge_recon_loss: 2895633.4062; val_gene_expr_recon_loss: 14045659.6250; val_masked_gp_l1_reg_loss: 56772.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146466.5469; val_chrom_access_recon_loss: 53105344.5000; val_global_loss: 70373134.0000; val_optim_loss: 70373134.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8746; val_auprc_score: 0.8326; val_best_acc_score: 0.8074; val_best_f1_score: 0.8315; train_kl_reg_loss: 121039.0803; train_edge_recon_loss: 2850380.1174; train_gene_expr_recon_loss: 13799131.4394; train_masked_gp_l1_reg_loss: 57119.5633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145041.0881; train_chrom_access_recon_loss: 52178140.5455; train_global_loss: 69150851.8788; train_optim_loss: 69150851.8788; val_kl_reg_loss: 118682.2607; val_edge_recon_loss: 2891565.7188; val_gene_expr_recon_loss: 13937807.7500; val_masked_gp_l1_reg_loss: 57576.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144087.2344; val_chrom_access_recon_loss: 52398015.0000; val_global_loss: 69547736.0000; val_optim_loss: 69547736.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8920; val_auprc_score: 0.8612; val_best_acc_score: 0.8219; val_best_f1_score: 0.8405; train_kl_reg_loss: 120573.2879; train_edge_recon_loss: 2833149.7538; train_gene_expr_recon_loss: 13763631.6970; train_masked_gp_l1_reg_loss: 58017.4521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143611.5464; train_chrom_access_recon_loss: 52019335.5758; train_global_loss: 68938319.8788; train_optim_loss: 68938319.8788; val_kl_reg_loss: 119560.9453; val_edge_recon_loss: 2847199.4062; val_gene_expr_recon_loss: 13778096.6250; val_masked_gp_l1_reg_loss: 58417.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143261.0781; val_chrom_access_recon_loss: 52263219.0000; val_global_loss: 69209755.5000; val_optim_loss: 69209755.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8868; val_auprc_score: 0.8518; val_best_acc_score: 0.8200; val_best_f1_score: 0.8386; train_kl_reg_loss: 121163.7259; train_edge_recon_loss: 2807042.0947; train_gene_expr_recon_loss: 13721686.5758; train_masked_gp_l1_reg_loss: 58812.6139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142627.3575; train_chrom_access_recon_loss: 51858864.7879; train_global_loss: 68710197.0909; train_optim_loss: 68710197.0909; val_kl_reg_loss: 118860.3887; val_edge_recon_loss: 2865873.0312; val_gene_expr_recon_loss: 13803935.1250; val_masked_gp_l1_reg_loss: 59311.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142263.1875; val_chrom_access_recon_loss: 52144800.0000; val_global_loss: 69135045.0000; val_optim_loss: 69135045.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9036; val_auprc_score: 0.8688; val_best_acc_score: 0.8383; val_best_f1_score: 0.8525; train_kl_reg_loss: 118449.5240; train_edge_recon_loss: 2808309.2879; train_gene_expr_recon_loss: 13710268.4091; train_masked_gp_l1_reg_loss: 59703.1143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141778.6196; train_chrom_access_recon_loss: 51750381.2727; train_global_loss: 68588890.2424; train_optim_loss: 68588890.2424; val_kl_reg_loss: 118553.1855; val_edge_recon_loss: 2824842.6562; val_gene_expr_recon_loss: 13766909.3750; val_masked_gp_l1_reg_loss: 60045.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141423.0938; val_chrom_access_recon_loss: 52289068.0000; val_global_loss: 69200843.0000; val_optim_loss: 69200843.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9106; val_auprc_score: 0.8758; val_best_acc_score: 0.8514; val_best_f1_score: 0.8633; train_kl_reg_loss: 118306.9884; train_edge_recon_loss: 2799532.0265; train_gene_expr_recon_loss: 13664196.1515; train_masked_gp_l1_reg_loss: 60413.8480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140958.8949; train_chrom_access_recon_loss: 51499005.0909; train_global_loss: 68282413.3333; train_optim_loss: 68282413.3333; val_kl_reg_loss: 119345.0840; val_edge_recon_loss: 2809409.0625; val_gene_expr_recon_loss: 13833564.3750; val_masked_gp_l1_reg_loss: 60882.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140768.1875; val_chrom_access_recon_loss: 52618840.5000; val_global_loss: 69582809.0000; val_optim_loss: 69582809.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9085; val_auprc_score: 0.8742; val_best_acc_score: 0.8514; val_best_f1_score: 0.8625; train_kl_reg_loss: 117085.8569; train_edge_recon_loss: 2797757.6515; train_gene_expr_recon_loss: 13627830.0758; train_masked_gp_l1_reg_loss: 61201.9837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140147.4460; train_chrom_access_recon_loss: 51332858.0606; train_global_loss: 68076880.7879; train_optim_loss: 68076880.7879; val_kl_reg_loss: 116255.4033; val_edge_recon_loss: 2839304.7500; val_gene_expr_recon_loss: 13805993.8750; val_masked_gp_l1_reg_loss: 61644.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140405.9219; val_chrom_access_recon_loss: 52446414.5000; val_global_loss: 69410019.0000; val_optim_loss: 69410019.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9186; val_auprc_score: 0.8899; val_best_acc_score: 0.8579; val_best_f1_score: 0.8691; train_kl_reg_loss: 116188.4251; train_edge_recon_loss: 2799679.1667; train_gene_expr_recon_loss: 13610389.5455; train_masked_gp_l1_reg_loss: 61887.1873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139271.8975; train_chrom_access_recon_loss: 51222464.3030; train_global_loss: 67949880.4848; train_optim_loss: 67949880.4848; val_kl_reg_loss: 114554.7646; val_edge_recon_loss: 2788626.2500; val_gene_expr_recon_loss: 13716846.3750; val_masked_gp_l1_reg_loss: 62222.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139642.2188; val_chrom_access_recon_loss: 52131468.5000; val_global_loss: 68953360.0000; val_optim_loss: 68953360.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9187; val_auprc_score: 0.8874; val_best_acc_score: 0.8622; val_best_f1_score: 0.8726; train_kl_reg_loss: 115688.0277; train_edge_recon_loss: 2789115.6439; train_gene_expr_recon_loss: 13577878.0152; train_masked_gp_l1_reg_loss: 62602.1598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138726.2652; train_chrom_access_recon_loss: 51003498.8485; train_global_loss: 67687509.0303; train_optim_loss: 67687509.0303; val_kl_reg_loss: 115996.5635; val_edge_recon_loss: 2816871.4375; val_gene_expr_recon_loss: 13757318.0000; val_masked_gp_l1_reg_loss: 62974.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138488.2031; val_chrom_access_recon_loss: 52326680.5000; val_global_loss: 69218328.5000; val_optim_loss: 69218328.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9300; val_auprc_score: 0.9069; val_best_acc_score: 0.8775; val_best_f1_score: 0.8843; train_kl_reg_loss: 116815.0246; train_edge_recon_loss: 2777018.7121; train_gene_expr_recon_loss: 13569953.6515; train_masked_gp_l1_reg_loss: 63203.8634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138028.9453; train_chrom_access_recon_loss: 50872430.2424; train_global_loss: 67537450.3636; train_optim_loss: 67537450.3636; val_kl_reg_loss: 114830.6982; val_edge_recon_loss: 2783573.0312; val_gene_expr_recon_loss: 13547132.0000; val_masked_gp_l1_reg_loss: 63484.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138127.8125; val_chrom_access_recon_loss: 51466547.0000; val_global_loss: 68113695.5000; val_optim_loss: 68113695.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9253; val_auprc_score: 0.9059; val_best_acc_score: 0.8622; val_best_f1_score: 0.8722; train_kl_reg_loss: 112346.6539; train_edge_recon_loss: 2810231.5947; train_gene_expr_recon_loss: 13445276.7727; train_masked_gp_l1_reg_loss: 62460.0127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151737.1605; train_chrom_access_recon_loss: 51165166.7273; train_global_loss: 67747218.9091; train_optim_loss: 67747218.9091; val_kl_reg_loss: 85406.8848; val_edge_recon_loss: 2827937.2812; val_gene_expr_recon_loss: 13569891.8750; val_masked_gp_l1_reg_loss: 61865.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153215.3281; val_chrom_access_recon_loss: 51420129.5000; val_global_loss: 68118446.5000; val_optim_loss: 68118446.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9308; val_auprc_score: 0.9064; val_best_acc_score: 0.8729; val_best_f1_score: 0.8815; train_kl_reg_loss: 119712.0239; train_edge_recon_loss: 2778327.6136; train_gene_expr_recon_loss: 13372329.8939; train_masked_gp_l1_reg_loss: 61847.4440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149670.2100; train_chrom_access_recon_loss: 50710805.2727; train_global_loss: 67192692.3030; train_optim_loss: 67192692.3030; val_kl_reg_loss: 89853.7891; val_edge_recon_loss: 2791604.7188; val_gene_expr_recon_loss: 13514485.1250; val_masked_gp_l1_reg_loss: 61865.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146977.1562; val_chrom_access_recon_loss: 51436831.0000; val_global_loss: 68041617.5000; val_optim_loss: 68041617.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9285; val_auprc_score: 0.9025; val_best_acc_score: 0.8697; val_best_f1_score: 0.8792; train_kl_reg_loss: 116357.9087; train_edge_recon_loss: 2772086.9886; train_gene_expr_recon_loss: 13347789.0000; train_masked_gp_l1_reg_loss: 61953.9360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144279.4967; train_chrom_access_recon_loss: 50600204.9697; train_global_loss: 67042672.1212; train_optim_loss: 67042672.1212; val_kl_reg_loss: 92928.7168; val_edge_recon_loss: 2802232.3750; val_gene_expr_recon_loss: 13471140.5000; val_masked_gp_l1_reg_loss: 62061.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141900.6094; val_chrom_access_recon_loss: 51020203.5000; val_global_loss: 67590467.5000; val_optim_loss: 67590467.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9251; val_auprc_score: 0.8935; val_best_acc_score: 0.8718; val_best_f1_score: 0.8816; train_kl_reg_loss: 113539.7536; train_edge_recon_loss: 2778424.5530; train_gene_expr_recon_loss: 13315597.8182; train_masked_gp_l1_reg_loss: 62164.1091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140326.1693; train_chrom_access_recon_loss: 50457265.6364; train_global_loss: 66867317.4545; train_optim_loss: 66867317.4545; val_kl_reg_loss: 94555.4658; val_edge_recon_loss: 2822027.8438; val_gene_expr_recon_loss: 13368825.3750; val_masked_gp_l1_reg_loss: 62330.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138818.3281; val_chrom_access_recon_loss: 51122701.5000; val_global_loss: 67609259.5000; val_optim_loss: 67609259.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9414; val_auprc_score: 0.9224; val_best_acc_score: 0.8912; val_best_f1_score: 0.8974; train_kl_reg_loss: 110725.1508; train_edge_recon_loss: 2764533.5265; train_gene_expr_recon_loss: 13299853.2273; train_masked_gp_l1_reg_loss: 62435.8329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137289.0668; train_chrom_access_recon_loss: 50355005.8788; train_global_loss: 66729842.9091; train_optim_loss: 66729842.9091; val_kl_reg_loss: 92855.8936; val_edge_recon_loss: 2782609.4688; val_gene_expr_recon_loss: 13491400.3750; val_masked_gp_l1_reg_loss: 62623.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135336.0938; val_chrom_access_recon_loss: 51768341.0000; val_global_loss: 68333165.0000; val_optim_loss: 68333165.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9306; val_auprc_score: 0.9057; val_best_acc_score: 0.8743; val_best_f1_score: 0.8827; train_kl_reg_loss: 109882.3802; train_edge_recon_loss: 2754134.6098; train_gene_expr_recon_loss: 13276320.4697; train_masked_gp_l1_reg_loss: 62747.4165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134798.6170; train_chrom_access_recon_loss: 50264127.6970; train_global_loss: 66602011.7576; train_optim_loss: 66602011.7576; val_kl_reg_loss: 95458.5000; val_edge_recon_loss: 2801609.9062; val_gene_expr_recon_loss: 13364396.3750; val_masked_gp_l1_reg_loss: 62920.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133699.3125; val_chrom_access_recon_loss: 50632203.5000; val_global_loss: 67090289.0000; val_optim_loss: 67090289.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9323; val_auprc_score: 0.9027; val_best_acc_score: 0.8726; val_best_f1_score: 0.8805; train_kl_reg_loss: 108085.3826; train_edge_recon_loss: 2748578.8485; train_gene_expr_recon_loss: 13260323.1667; train_masked_gp_l1_reg_loss: 63075.5367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132776.4541; train_chrom_access_recon_loss: 50152023.2727; train_global_loss: 66464862.4848; train_optim_loss: 66464862.4848; val_kl_reg_loss: 98013.7314; val_edge_recon_loss: 2806817.9062; val_gene_expr_recon_loss: 13521825.6250; val_masked_gp_l1_reg_loss: 63201.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132272.5156; val_chrom_access_recon_loss: 51555150.5000; val_global_loss: 68177281.0000; val_optim_loss: 68177281.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9350; val_auprc_score: 0.9051; val_best_acc_score: 0.8799; val_best_f1_score: 0.8865; train_kl_reg_loss: 107878.7675; train_edge_recon_loss: 2745296.4242; train_gene_expr_recon_loss: 13250587.1667; train_masked_gp_l1_reg_loss: 63365.9140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131010.9048; train_chrom_access_recon_loss: 50091746.4242; train_global_loss: 66389886.0000; train_optim_loss: 66389886.0000; val_kl_reg_loss: 98126.4121; val_edge_recon_loss: 2776423.0625; val_gene_expr_recon_loss: 13321599.3750; val_masked_gp_l1_reg_loss: 63556.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129891.4375; val_chrom_access_recon_loss: 50655098.0000; val_global_loss: 67044693.5000; val_optim_loss: 67044693.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9325; val_auprc_score: 0.9011; val_best_acc_score: 0.8834; val_best_f1_score: 0.8908; train_kl_reg_loss: 106541.2275; train_edge_recon_loss: 2740252.9924; train_gene_expr_recon_loss: 13235210.8030; train_masked_gp_l1_reg_loss: 63692.8558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129574.3646; train_chrom_access_recon_loss: 50005012.6667; train_global_loss: 66280285.2727; train_optim_loss: 66280285.2727; val_kl_reg_loss: 97862.4268; val_edge_recon_loss: 2798691.6875; val_gene_expr_recon_loss: 13371734.0000; val_masked_gp_l1_reg_loss: 63867.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128654.1172; val_chrom_access_recon_loss: 50746854.0000; val_global_loss: 67207663.0000; val_optim_loss: 67207663.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9362; val_auprc_score: 0.9046; val_best_acc_score: 0.8845; val_best_f1_score: 0.8889; train_kl_reg_loss: 105075.1605; train_edge_recon_loss: 2741474.4848; train_gene_expr_recon_loss: 13209487.8939; train_masked_gp_l1_reg_loss: 64036.0475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128589.2577; train_chrom_access_recon_loss: 49853746.0606; train_global_loss: 66102408.9091; train_optim_loss: 66102408.9091; val_kl_reg_loss: 98119.3789; val_edge_recon_loss: 2768117.5938; val_gene_expr_recon_loss: 13539420.3750; val_masked_gp_l1_reg_loss: 64192.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128339.6484; val_chrom_access_recon_loss: 50884302.0000; val_global_loss: 67482491.0000; val_optim_loss: 67482491.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9296; val_auprc_score: 0.8982; val_best_acc_score: 0.8788; val_best_f1_score: 0.8874; train_kl_reg_loss: 105482.2872; train_edge_recon_loss: 2732706.0455; train_gene_expr_recon_loss: 13192942.8030; train_masked_gp_l1_reg_loss: 64347.5682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127769.5846; train_chrom_access_recon_loss: 49728861.1515; train_global_loss: 65952109.5152; train_optim_loss: 65952109.5152; val_kl_reg_loss: 99839.6104; val_edge_recon_loss: 2808272.6250; val_gene_expr_recon_loss: 13286876.0000; val_masked_gp_l1_reg_loss: 64505.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127278.8203; val_chrom_access_recon_loss: 50043850.0000; val_global_loss: 66430623.5000; val_optim_loss: 66430623.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9350; val_auprc_score: 0.9077; val_best_acc_score: 0.8804; val_best_f1_score: 0.8871; train_kl_reg_loss: 103672.5231; train_edge_recon_loss: 2741053.5227; train_gene_expr_recon_loss: 13173378.0152; train_masked_gp_l1_reg_loss: 64633.7169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127000.4044; train_chrom_access_recon_loss: 49605438.3636; train_global_loss: 65815176.7273; train_optim_loss: 65815176.7273; val_kl_reg_loss: 98282.3008; val_edge_recon_loss: 2807233.5312; val_gene_expr_recon_loss: 13330452.6250; val_masked_gp_l1_reg_loss: 64770.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127010.8906; val_chrom_access_recon_loss: 50298810.0000; val_global_loss: 66726562.0000; val_optim_loss: 66726562.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9337; val_auprc_score: 0.9074; val_best_acc_score: 0.8866; val_best_f1_score: 0.8925; train_kl_reg_loss: 102852.9762; train_edge_recon_loss: 2740820.3939; train_gene_expr_recon_loss: 13163151.8333; train_masked_gp_l1_reg_loss: 64903.7837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126415.6787; train_chrom_access_recon_loss: 49567738.0000; train_global_loss: 65765882.7273; train_optim_loss: 65765882.7273; val_kl_reg_loss: 96592.8779; val_edge_recon_loss: 2793035.3125; val_gene_expr_recon_loss: 13453501.1250; val_masked_gp_l1_reg_loss: 65072.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125918.1562; val_chrom_access_recon_loss: 50893603.0000; val_global_loss: 67427721.5000; val_optim_loss: 67427721.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9442; val_auprc_score: 0.9201; val_best_acc_score: 0.8909; val_best_f1_score: 0.8967; train_kl_reg_loss: 102395.1194; train_edge_recon_loss: 2739371.9432; train_gene_expr_recon_loss: 13150629.6061; train_masked_gp_l1_reg_loss: 65147.5071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125451.4785; train_chrom_access_recon_loss: 49517674.1212; train_global_loss: 65700669.6364; train_optim_loss: 65700669.6364; val_kl_reg_loss: 99767.5977; val_edge_recon_loss: 2779704.3438; val_gene_expr_recon_loss: 13249928.6250; val_masked_gp_l1_reg_loss: 65264.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125326.7969; val_chrom_access_recon_loss: 50168729.0000; val_global_loss: 66488720.5000; val_optim_loss: 66488720.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9407; val_auprc_score: 0.9131; val_best_acc_score: 0.8874; val_best_f1_score: 0.8929; train_kl_reg_loss: 101698.2372; train_edge_recon_loss: 2727220.6856; train_gene_expr_recon_loss: 13124043.5152; train_masked_gp_l1_reg_loss: 65378.8404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125187.0524; train_chrom_access_recon_loss: 49361557.5758; train_global_loss: 65505086.0000; train_optim_loss: 65505086.0000; val_kl_reg_loss: 98022.7861; val_edge_recon_loss: 2784555.7812; val_gene_expr_recon_loss: 13365653.0000; val_masked_gp_l1_reg_loss: 65530.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125385.5312; val_chrom_access_recon_loss: 50729130.5000; val_global_loss: 67168278.0000; val_optim_loss: 67168278.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9379; val_auprc_score: 0.9130; val_best_acc_score: 0.8842; val_best_f1_score: 0.8916; train_kl_reg_loss: 102255.0201; train_edge_recon_loss: 2718093.8144; train_gene_expr_recon_loss: 13114333.5152; train_masked_gp_l1_reg_loss: 65110.1826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95323.5069; train_chrom_access_recon_loss: 49356948.3030; train_global_loss: 65452064.6667; train_optim_loss: 65452064.6667; val_kl_reg_loss: 100109.0947; val_edge_recon_loss: 2800876.0000; val_gene_expr_recon_loss: 13347759.0000; val_masked_gp_l1_reg_loss: 64886.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90162.3125; val_chrom_access_recon_loss: 50652513.0000; val_global_loss: 67056305.0000; val_optim_loss: 67056305.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9479; val_auprc_score: 0.9315; val_best_acc_score: 0.8912; val_best_f1_score: 0.8962; train_kl_reg_loss: 103312.5402; train_edge_recon_loss: 2730178.2197; train_gene_expr_recon_loss: 13100150.9848; train_masked_gp_l1_reg_loss: 64803.0298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89862.0625; train_chrom_access_recon_loss: 49282346.3030; train_global_loss: 65370653.4545; train_optim_loss: 65370653.4545; val_kl_reg_loss: 100685.7676; val_edge_recon_loss: 2760362.0312; val_gene_expr_recon_loss: 13172542.3750; val_masked_gp_l1_reg_loss: 64735.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89696.2266; val_chrom_access_recon_loss: 49611420.0000; val_global_loss: 65799441.5000; val_optim_loss: 65799441.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9453; val_auprc_score: 0.9214; val_best_acc_score: 0.8958; val_best_f1_score: 0.9003; train_kl_reg_loss: 103828.1243; train_edge_recon_loss: 2734966.7841; train_gene_expr_recon_loss: 13101625.9848; train_masked_gp_l1_reg_loss: 64701.4163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89406.8473; train_chrom_access_recon_loss: 49287414.7273; train_global_loss: 65381943.8788; train_optim_loss: 65381943.8788; val_kl_reg_loss: 101018.7764; val_edge_recon_loss: 2752184.9688; val_gene_expr_recon_loss: 13269975.8750; val_masked_gp_l1_reg_loss: 64670.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89151.0625; val_chrom_access_recon_loss: 49924632.5000; val_global_loss: 66201634.5000; val_optim_loss: 66201634.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9466; val_auprc_score: 0.9277; val_best_acc_score: 0.8931; val_best_f1_score: 0.8986; train_kl_reg_loss: 103319.0687; train_edge_recon_loss: 2730278.1212; train_gene_expr_recon_loss: 13104062.8182; train_masked_gp_l1_reg_loss: 64665.9041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89035.1372; train_chrom_access_recon_loss: 49305687.1515; train_global_loss: 65397048.3030; train_optim_loss: 65397048.3030; val_kl_reg_loss: 100879.3740; val_edge_recon_loss: 2775119.9375; val_gene_expr_recon_loss: 13314113.1250; val_masked_gp_l1_reg_loss: 64648.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88855.0547; val_chrom_access_recon_loss: 50189451.0000; val_global_loss: 66533067.0000; val_optim_loss: 66533067.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9414; val_auprc_score: 0.9201; val_best_acc_score: 0.8866; val_best_f1_score: 0.8918; train_kl_reg_loss: 103731.4202; train_edge_recon_loss: 2724270.4053; train_gene_expr_recon_loss: 13098768.1818; train_masked_gp_l1_reg_loss: 64643.7618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88634.1032; train_chrom_access_recon_loss: 49295190.9697; train_global_loss: 65375239.0303; train_optim_loss: 65375239.0303; val_kl_reg_loss: 101141.7842; val_edge_recon_loss: 2778858.5938; val_gene_expr_recon_loss: 13345478.5000; val_masked_gp_l1_reg_loss: 64623.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88548.4922; val_chrom_access_recon_loss: 50089604.5000; val_global_loss: 66468255.5000; val_optim_loss: 66468255.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9469; val_auprc_score: 0.9273; val_best_acc_score: 0.8928; val_best_f1_score: 0.8986; train_kl_reg_loss: 103667.4652; train_edge_recon_loss: 2728807.9962; train_gene_expr_recon_loss: 13107015.2424; train_masked_gp_l1_reg_loss: 64628.0364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88303.0063; train_chrom_access_recon_loss: 49270912.0606; train_global_loss: 65363334.1818; train_optim_loss: 65363334.1818; val_kl_reg_loss: 102085.7041; val_edge_recon_loss: 2763802.9688; val_gene_expr_recon_loss: 13280594.7500; val_masked_gp_l1_reg_loss: 64628.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88103.4531; val_chrom_access_recon_loss: 50331006.0000; val_global_loss: 66630222.0000; val_optim_loss: 66630222.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9450; val_auprc_score: 0.9251; val_best_acc_score: 0.8966; val_best_f1_score: 0.9011; train_kl_reg_loss: 103462.9040; train_edge_recon_loss: 2724183.4394; train_gene_expr_recon_loss: 13099010.0455; train_masked_gp_l1_reg_loss: 64589.1484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84759.1005; train_chrom_access_recon_loss: 49210776.8485; train_global_loss: 65286781.4545; train_optim_loss: 65286781.4545; val_kl_reg_loss: 100973.7256; val_edge_recon_loss: 2774714.0312; val_gene_expr_recon_loss: 13150935.3750; val_masked_gp_l1_reg_loss: 64566.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84170.7812; val_chrom_access_recon_loss: 49734031.0000; val_global_loss: 65909391.5000; val_optim_loss: 65909391.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9503; val_auprc_score: 0.9341; val_best_acc_score: 0.8923; val_best_f1_score: 0.8972; train_kl_reg_loss: 103779.9503; train_edge_recon_loss: 2726624.6553; train_gene_expr_recon_loss: 13096484.8788; train_masked_gp_l1_reg_loss: 64555.5701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84146.5702; train_chrom_access_recon_loss: 49257706.8485; train_global_loss: 65333298.3636; train_optim_loss: 65333298.3636; val_kl_reg_loss: 101157.7139; val_edge_recon_loss: 2747793.4062; val_gene_expr_recon_loss: 13051558.3750; val_masked_gp_l1_reg_loss: 64546.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84130.4609; val_chrom_access_recon_loss: 49336713.0000; val_global_loss: 65385899.0000; val_optim_loss: 65385899.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9412; val_auprc_score: 0.9166; val_best_acc_score: 0.8880; val_best_f1_score: 0.8927; train_kl_reg_loss: 103633.6706; train_edge_recon_loss: 2726425.0871; train_gene_expr_recon_loss: 13086879.7879; train_masked_gp_l1_reg_loss: 64540.3649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84100.9944; train_chrom_access_recon_loss: 49188781.5758; train_global_loss: 65254361.3939; train_optim_loss: 65254361.3939; val_kl_reg_loss: 101406.6709; val_edge_recon_loss: 2801041.9688; val_gene_expr_recon_loss: 13283266.0000; val_masked_gp_l1_reg_loss: 64533.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84075.2891; val_chrom_access_recon_loss: 50035747.5000; val_global_loss: 66370070.5000; val_optim_loss: 66370070.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9483; val_auprc_score: 0.9297; val_best_acc_score: 0.8958; val_best_f1_score: 0.9009; train_kl_reg_loss: 103872.4438; train_edge_recon_loss: 2722399.7348; train_gene_expr_recon_loss: 13085511.9545; train_masked_gp_l1_reg_loss: 64531.6999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84066.3304; train_chrom_access_recon_loss: 49207321.9394; train_global_loss: 65267704.2424; train_optim_loss: 65267704.2424; val_kl_reg_loss: 100301.8555; val_edge_recon_loss: 2781071.4062; val_gene_expr_recon_loss: 13231164.0000; val_masked_gp_l1_reg_loss: 64527.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84048.3125; val_chrom_access_recon_loss: 50040145.0000; val_global_loss: 66301257.5000; val_optim_loss: 66301257.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9505; val_auprc_score: 0.9324; val_best_acc_score: 0.8968; val_best_f1_score: 0.9004; train_kl_reg_loss: 104077.7682; train_edge_recon_loss: 2717021.5644; train_gene_expr_recon_loss: 13096246.5000; train_masked_gp_l1_reg_loss: 64525.8526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84027.4338; train_chrom_access_recon_loss: 49250988.1212; train_global_loss: 65316886.9697; train_optim_loss: 65316886.9697; val_kl_reg_loss: 101280.8447; val_edge_recon_loss: 2767804.2500; val_gene_expr_recon_loss: 13114888.5000; val_masked_gp_l1_reg_loss: 64523.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84020.4922; val_chrom_access_recon_loss: 49329150.5000; val_global_loss: 65461668.0000; val_optim_loss: 65461668.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9481; val_auprc_score: 0.9301; val_best_acc_score: 0.8979; val_best_f1_score: 0.9030; train_kl_reg_loss: 104124.5298; train_edge_recon_loss: 2727683.7235; train_gene_expr_recon_loss: 13098508.6212; train_masked_gp_l1_reg_loss: 64522.5684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83986.7331; train_chrom_access_recon_loss: 49242967.0909; train_global_loss: 65321793.1515; train_optim_loss: 65321793.1515; val_kl_reg_loss: 102090.7578; val_edge_recon_loss: 2752435.5625; val_gene_expr_recon_loss: 13417576.8750; val_masked_gp_l1_reg_loss: 64520.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83968.3828; val_chrom_access_recon_loss: 50159013.0000; val_global_loss: 66579604.5000; val_optim_loss: 66579604.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9417; val_auprc_score: 0.9170; val_best_acc_score: 0.8936; val_best_f1_score: 0.8987; train_kl_reg_loss: 104184.6946; train_edge_recon_loss: 2720612.7992; train_gene_expr_recon_loss: 13092569.2879; train_masked_gp_l1_reg_loss: 64516.8152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83634.5484; train_chrom_access_recon_loss: 49226546.0606; train_global_loss: 65292064.1818; train_optim_loss: 65292064.1818; val_kl_reg_loss: 101992.1865; val_edge_recon_loss: 2767936.5312; val_gene_expr_recon_loss: 13242530.5000; val_masked_gp_l1_reg_loss: 64514.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83575.8203; val_chrom_access_recon_loss: 50076317.5000; val_global_loss: 66336868.0000; val_optim_loss: 66336868.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9528; val_auprc_score: 0.9387; val_best_acc_score: 0.9006; val_best_f1_score: 0.9042; train_kl_reg_loss: 104354.8042; train_edge_recon_loss: 2719973.5985; train_gene_expr_recon_loss: 13092105.6061; train_masked_gp_l1_reg_loss: 64513.7491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83573.7827; train_chrom_access_recon_loss: 49232602.0606; train_global_loss: 65297123.6970; train_optim_loss: 65297123.6970; val_kl_reg_loss: 102089.1660; val_edge_recon_loss: 2762820.9062; val_gene_expr_recon_loss: 13253746.6250; val_masked_gp_l1_reg_loss: 64512.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83572.2656; val_chrom_access_recon_loss: 50133607.0000; val_global_loss: 66400349.0000; val_optim_loss: 66400349.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9479; val_auprc_score: 0.9307; val_best_acc_score: 0.8976; val_best_f1_score: 0.9012; train_kl_reg_loss: 104209.5447; train_edge_recon_loss: 2729690.9356; train_gene_expr_recon_loss: 13089045.2424; train_masked_gp_l1_reg_loss: 64512.1333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83569.4846; train_chrom_access_recon_loss: 49206870.5455; train_global_loss: 65277897.8182; train_optim_loss: 65277897.8182; val_kl_reg_loss: 101596.2695; val_edge_recon_loss: 2766702.8750; val_gene_expr_recon_loss: 13221751.0000; val_masked_gp_l1_reg_loss: 64511.5898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83567.1719; val_chrom_access_recon_loss: 50254939.0000; val_global_loss: 66493068.0000; val_optim_loss: 66493068.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9403; val_auprc_score: 0.9134; val_best_acc_score: 0.8907; val_best_f1_score: 0.8963; train_kl_reg_loss: 104248.3016; train_edge_recon_loss: 2724400.7083; train_gene_expr_recon_loss: 13087287.3485; train_masked_gp_l1_reg_loss: 64511.2952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83565.7740; train_chrom_access_recon_loss: 49206804.6061; train_global_loss: 65270818.3636; train_optim_loss: 65270818.3636; val_kl_reg_loss: 101812.9043; val_edge_recon_loss: 2806818.1562; val_gene_expr_recon_loss: 13289618.0000; val_masked_gp_l1_reg_loss: 64510.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83563.9062; val_chrom_access_recon_loss: 49976657.5000; val_global_loss: 66322981.5000; val_optim_loss: 66322981.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 80 min 15 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9435
val AUPRC score: 0.9207
val best accuracy score: 0.8923
val best F1 score: 0.8975
val target rna MSE score: 1.0910
val source rna MSE score: 0.4505
val target atac MSE score: 0.1271
val source atac MSE score: 0.0284
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
