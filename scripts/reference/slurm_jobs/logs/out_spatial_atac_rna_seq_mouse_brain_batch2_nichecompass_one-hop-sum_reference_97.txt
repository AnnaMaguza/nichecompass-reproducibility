[True]
Run timestamp: 10082023_232908_97.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_97']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7750; val_auprc_score: 0.7945; val_best_acc_score: 0.5571; val_best_f1_score: 0.6901; train_kl_reg_loss: 201258.4362; train_edge_recon_loss: 3949367.2901; train_gene_expr_recon_loss: 50074860.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 132358510.8397; train_global_loss: 186583997.8015; train_optim_loss: 186583997.8015; val_kl_reg_loss: 279968.0583; val_edge_recon_loss: 4061592.9167; val_gene_expr_recon_loss: 39507774.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 117208074.1333; val_global_loss: 161057408.0000; val_optim_loss: 161057408.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7996; val_auprc_score: 0.8211; val_best_acc_score: 0.6721; val_best_f1_score: 0.7277; train_kl_reg_loss: 241668.7793; train_edge_recon_loss: 3795238.7615; train_gene_expr_recon_loss: 38434297.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 115511678.7786; train_global_loss: 157982884.7634; train_optim_loss: 157982884.7634; val_kl_reg_loss: 279029.4708; val_edge_recon_loss: 4052749.5333; val_gene_expr_recon_loss: 37726076.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 116419421.8667; val_global_loss: 158477274.6667; val_optim_loss: 158477274.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8734; val_auprc_score: 0.8697; val_best_acc_score: 0.7776; val_best_f1_score: 0.7962; train_kl_reg_loss: 242602.6870; train_edge_recon_loss: 3605682.8492; train_gene_expr_recon_loss: 37204020.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 114699230.5954; train_global_loss: 155751536.6107; train_optim_loss: 155751536.6107; val_kl_reg_loss: 226893.5990; val_edge_recon_loss: 3803718.2667; val_gene_expr_recon_loss: 37091310.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 115203817.6000; val_global_loss: 156325739.7333; val_optim_loss: 156325739.7333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8771; val_auprc_score: 0.8699; val_best_acc_score: 0.7910; val_best_f1_score: 0.8036; train_kl_reg_loss: 220117.1772; train_edge_recon_loss: 3311247.2424; train_gene_expr_recon_loss: 36837562.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113899983.6336; train_global_loss: 154268911.1450; train_optim_loss: 154268911.1450; val_kl_reg_loss: 254568.1448; val_edge_recon_loss: 3132801.9167; val_gene_expr_recon_loss: 36880725.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 114429888.0000; val_global_loss: 154697985.0667; val_optim_loss: 154697985.0667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8858; val_auprc_score: 0.8783; val_best_acc_score: 0.7932; val_best_f1_score: 0.8137; train_kl_reg_loss: 250943.0718; train_edge_recon_loss: 3083810.0611; train_gene_expr_recon_loss: 36529845.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113192713.7710; train_global_loss: 153057312.2443; train_optim_loss: 153057312.2443; val_kl_reg_loss: 235595.6125; val_edge_recon_loss: 3097024.6000; val_gene_expr_recon_loss: 36562293.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 113964827.2000; val_global_loss: 153859739.7333; val_optim_loss: 153859739.7333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8973; val_auprc_score: 0.8881; val_best_acc_score: 0.8092; val_best_f1_score: 0.8237; train_kl_reg_loss: 235823.9247; train_edge_recon_loss: 3045200.4523; train_gene_expr_recon_loss: 36292742.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 112593030.2901; train_global_loss: 152166798.1679; train_optim_loss: 152166798.1679; val_kl_reg_loss: 226523.9750; val_edge_recon_loss: 3034469.3833; val_gene_expr_recon_loss: 36206352.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112745006.9333; val_global_loss: 152212350.9333; val_optim_loss: 152212350.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9004; val_auprc_score: 0.8913; val_best_acc_score: 0.8118; val_best_f1_score: 0.8240; train_kl_reg_loss: 219927.4682; train_edge_recon_loss: 3018967.6260; train_gene_expr_recon_loss: 36012489.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111647768.0611; train_global_loss: 150899151.8779; train_optim_loss: 150899151.8779; val_kl_reg_loss: 214042.7062; val_edge_recon_loss: 3023167.8167; val_gene_expr_recon_loss: 36033053.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112304283.2000; val_global_loss: 151574544.0000; val_optim_loss: 151574544.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9134; val_auprc_score: 0.9056; val_best_acc_score: 0.8263; val_best_f1_score: 0.8415; train_kl_reg_loss: 210383.6640; train_edge_recon_loss: 2973693.8378; train_gene_expr_recon_loss: 35886909.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111480152.7939; train_global_loss: 150551139.1756; train_optim_loss: 150551139.1756; val_kl_reg_loss: 210172.0000; val_edge_recon_loss: 2968913.0333; val_gene_expr_recon_loss: 35992786.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112812990.9333; val_global_loss: 151984861.8667; val_optim_loss: 151984861.8667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9207; val_auprc_score: 0.9144; val_best_acc_score: 0.8360; val_best_f1_score: 0.8437; train_kl_reg_loss: 201624.5243; train_edge_recon_loss: 2956078.3053; train_gene_expr_recon_loss: 35745223.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111031723.2366; train_global_loss: 149934649.6489; train_optim_loss: 149934649.6489; val_kl_reg_loss: 202974.3354; val_edge_recon_loss: 2957074.9333; val_gene_expr_recon_loss: 35637546.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110967243.2000; val_global_loss: 149764841.6000; val_optim_loss: 149764841.6000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9060; val_auprc_score: 0.8956; val_best_acc_score: 0.8243; val_best_f1_score: 0.8331; train_kl_reg_loss: 193065.8498; train_edge_recon_loss: 2947384.1775; train_gene_expr_recon_loss: 35773377.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111145003.6031; train_global_loss: 150058830.9008; train_optim_loss: 150058830.9008; val_kl_reg_loss: 122459.8687; val_edge_recon_loss: 3117793.1333; val_gene_expr_recon_loss: 35863977.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110768193.6000; val_global_loss: 149872424.5333; val_optim_loss: 149872424.5333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9133; val_auprc_score: 0.9048; val_best_acc_score: 0.8308; val_best_f1_score: 0.8439; train_kl_reg_loss: 175068.6112; train_edge_recon_loss: 2982657.7004; train_gene_expr_recon_loss: 36214883.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111306929.7099; train_global_loss: 150679539.5420; train_optim_loss: 150679539.5420; val_kl_reg_loss: 214051.2687; val_edge_recon_loss: 2983520.5833; val_gene_expr_recon_loss: 35718559.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110990769.0667; val_global_loss: 149906900.2667; val_optim_loss: 149906900.2667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9135; val_auprc_score: 0.9000; val_best_acc_score: 0.8405; val_best_f1_score: 0.8501; train_kl_reg_loss: 229081.3707; train_edge_recon_loss: 3038673.0725; train_gene_expr_recon_loss: 36579804.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111292813.0687; train_global_loss: 151140371.5420; train_optim_loss: 151140371.5420; val_kl_reg_loss: 262652625.9104; val_edge_recon_loss: 3007704.3000; val_gene_expr_recon_loss: 35997337.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111168484.2667; val_global_loss: 412826145.0667; val_optim_loss: 412826145.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9172; val_auprc_score: 0.9082; val_best_acc_score: 0.8378; val_best_f1_score: 0.8512; train_kl_reg_loss: 2866769604249.1016; train_edge_recon_loss: 3142676.7481; train_gene_expr_recon_loss: 38386608.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113608117.9847; train_global_loss: 2866924590927.1450; train_optim_loss: 2866924590927.1450; val_kl_reg_loss: 271069.1844; val_edge_recon_loss: 3076674.0833; val_gene_expr_recon_loss: 36374564.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111292106.6667; val_global_loss: 151014414.9333; val_optim_loss: 151014414.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9164; val_auprc_score: 0.9049; val_best_acc_score: 0.8398; val_best_f1_score: 0.8525; train_kl_reg_loss: 281009.8808; train_edge_recon_loss: 3048967.6317; train_gene_expr_recon_loss: 37254737.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111067948.8855; train_global_loss: 151652663.9389; train_optim_loss: 151652663.9389; val_kl_reg_loss: 261370.8073; val_edge_recon_loss: 3060045.7833; val_gene_expr_recon_loss: 36190160.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110719550.4000; val_global_loss: 150231126.4000; val_optim_loss: 150231126.4000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9172; val_auprc_score: 0.9040; val_best_acc_score: 0.8401; val_best_f1_score: 0.8538; train_kl_reg_loss: 260160.3515; train_edge_recon_loss: 3026667.8015; train_gene_expr_recon_loss: 36231539.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110766340.4580; train_global_loss: 150284707.7863; train_optim_loss: 150284707.7863; val_kl_reg_loss: 261474.9375; val_edge_recon_loss: 3020382.5500; val_gene_expr_recon_loss: 36090194.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110794994.1333; val_global_loss: 150167048.5333; val_optim_loss: 150167048.5333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9192; val_auprc_score: 0.9075; val_best_acc_score: 0.8414; val_best_f1_score: 0.8536; train_kl_reg_loss: 274615.6509; train_edge_recon_loss: 2997038.5573; train_gene_expr_recon_loss: 36358806.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110834149.4962; train_global_loss: 150464610.3206; train_optim_loss: 150464610.3206; val_kl_reg_loss: 255409.1187; val_edge_recon_loss: 3002842.4667; val_gene_expr_recon_loss: 35890026.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110317437.3333; val_global_loss: 149465714.1333; val_optim_loss: 149465714.1333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9180; val_auprc_score: 0.9078; val_best_acc_score: 0.8451; val_best_f1_score: 0.8551; train_kl_reg_loss: 258717.0694; train_edge_recon_loss: 2975163.0248; train_gene_expr_recon_loss: 35857288.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109860211.1145; train_global_loss: 148951379.6641; train_optim_loss: 148951379.6641; val_kl_reg_loss: 256247.8594; val_edge_recon_loss: 2991386.2333; val_gene_expr_recon_loss: 36088915.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110865217.6000; val_global_loss: 150201767.4667; val_optim_loss: 150201767.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9228; val_auprc_score: 0.9105; val_best_acc_score: 0.8480; val_best_f1_score: 0.8564; train_kl_reg_loss: 257182.8523; train_edge_recon_loss: 2957043.9027; train_gene_expr_recon_loss: 36005923.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110144997.3740; train_global_loss: 149365147.8473; train_optim_loss: 149365147.8473; val_kl_reg_loss: 256205.2740; val_edge_recon_loss: 2963556.7167; val_gene_expr_recon_loss: 35881499.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110262961.6000; val_global_loss: 149364222.9333; val_optim_loss: 149364222.9333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9205; val_auprc_score: 0.9099; val_best_acc_score: 0.8430; val_best_f1_score: 0.8517; train_kl_reg_loss: 257682.1442; train_edge_recon_loss: 2943477.3244; train_gene_expr_recon_loss: 36159909.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110216107.4809; train_global_loss: 149577176.0611; train_optim_loss: 149577176.0611; val_kl_reg_loss: 253258.7656; val_edge_recon_loss: 2946568.7500; val_gene_expr_recon_loss: 35956509.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110506942.4000; val_global_loss: 149663278.9333; val_optim_loss: 149663278.9333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9236; val_auprc_score: 0.9110; val_best_acc_score: 0.8457; val_best_f1_score: 0.8564; train_kl_reg_loss: 251781.8626; train_edge_recon_loss: 2936461.3187; train_gene_expr_recon_loss: 35987910.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110042544.1832; train_global_loss: 149218696.9160; train_optim_loss: 149218696.9160; val_kl_reg_loss: 249952.7375; val_edge_recon_loss: 2921491.9167; val_gene_expr_recon_loss: 35789709.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110610665.0667; val_global_loss: 149571820.8000; val_optim_loss: 149571820.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9233; val_auprc_score: 0.9119; val_best_acc_score: 0.8490; val_best_f1_score: 0.8595; train_kl_reg_loss: 248997.6095; train_edge_recon_loss: 2923377.8607; train_gene_expr_recon_loss: 35852683.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109492854.7786; train_global_loss: 148517913.5267; train_optim_loss: 148517913.5267; val_kl_reg_loss: 245733.7073; val_edge_recon_loss: 2913632.1833; val_gene_expr_recon_loss: 35678096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109851051.2000; val_global_loss: 148688513.0667; val_optim_loss: 148688513.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9217; val_auprc_score: 0.9107; val_best_acc_score: 0.8445; val_best_f1_score: 0.8534; train_kl_reg_loss: 249547.2768; train_edge_recon_loss: 2918247.7748; train_gene_expr_recon_loss: 36278328.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109723944.9771; train_global_loss: 149170067.2977; train_optim_loss: 149170067.2977; val_kl_reg_loss: 246324.7708; val_edge_recon_loss: 2941477.8667; val_gene_expr_recon_loss: 35760315.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109950822.4000; val_global_loss: 148898940.8000; val_optim_loss: 148898940.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9216; val_auprc_score: 0.9113; val_best_acc_score: 0.8444; val_best_f1_score: 0.8552; train_kl_reg_loss: 247788.5918; train_edge_recon_loss: 2918684.0057; train_gene_expr_recon_loss: 36190899.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110208618.0763; train_global_loss: 149565989.2519; train_optim_loss: 149565989.2519; val_kl_reg_loss: 647804.8500; val_edge_recon_loss: 2951623.1833; val_gene_expr_recon_loss: 35982179.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110959947.7333; val_global_loss: 150541556.2667; val_optim_loss: 150541556.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9216; val_auprc_score: 0.9114; val_best_acc_score: 0.8452; val_best_f1_score: 0.8549; train_kl_reg_loss: 246899.9942; train_edge_recon_loss: 2909793.7443; train_gene_expr_recon_loss: 35703805.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109481758.7786; train_global_loss: 148342257.8321; train_optim_loss: 148342257.8321; val_kl_reg_loss: 242900.0802; val_edge_recon_loss: 2939240.3500; val_gene_expr_recon_loss: 35759968.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110537950.4000; val_global_loss: 149480059.7333; val_optim_loss: 149480059.7333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9244; val_auprc_score: 0.9158; val_best_acc_score: 0.8447; val_best_f1_score: 0.8583; train_kl_reg_loss: 242947.9462; train_edge_recon_loss: 2893000.2672; train_gene_expr_recon_loss: 35819261.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109699963.2977; train_global_loss: 148655172.7634; train_optim_loss: 148655172.7634; val_kl_reg_loss: 240827.8240; val_edge_recon_loss: 2916392.7333; val_gene_expr_recon_loss: 35625934.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110333318.4000; val_global_loss: 149116473.6000; val_optim_loss: 149116473.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9198; val_auprc_score: 0.9084; val_best_acc_score: 0.8434; val_best_f1_score: 0.8525; train_kl_reg_loss: 241802.4896; train_edge_recon_loss: 3001670.3950; train_gene_expr_recon_loss: 37300535.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110917894.5344; train_global_loss: 151461903.6336; train_optim_loss: 151461903.6336; val_kl_reg_loss: 108327.7896; val_edge_recon_loss: 3034228.4500; val_gene_expr_recon_loss: 37283642.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111750261.8667; val_global_loss: 152176458.6667; val_optim_loss: 152176458.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9201; val_auprc_score: 0.9088; val_best_acc_score: 0.8422; val_best_f1_score: 0.8524; train_kl_reg_loss: 244391.8087; train_edge_recon_loss: 3010824.1832; train_gene_expr_recon_loss: 37080673.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110958383.1450; train_global_loss: 151294272.6107; train_optim_loss: 151294272.6107; val_kl_reg_loss: 103262.8062; val_edge_recon_loss: 3050133.1833; val_gene_expr_recon_loss: 37146341.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111607154.1333; val_global_loss: 151906891.7333; val_optim_loss: 151906891.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9213; val_auprc_score: 0.9080; val_best_acc_score: 0.8491; val_best_f1_score: 0.8598; train_kl_reg_loss: 246880.0465; train_edge_recon_loss: 3019453.2691; train_gene_expr_recon_loss: 36981175.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110639598.5344; train_global_loss: 150887107.2977; train_optim_loss: 150887107.2977; val_kl_reg_loss: 110451.5609; val_edge_recon_loss: 3026130.7000; val_gene_expr_recon_loss: 36799240.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110784905.6000; val_global_loss: 150720729.6000; val_optim_loss: 150720729.6000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9168; val_auprc_score: 0.9036; val_best_acc_score: 0.8455; val_best_f1_score: 0.8547; train_kl_reg_loss: 246034.6877; train_edge_recon_loss: 3033278.0973; train_gene_expr_recon_loss: 36966909.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110811613.8015; train_global_loss: 151057836.9466; train_optim_loss: 151057836.9466; val_kl_reg_loss: 104871.5031; val_edge_recon_loss: 3051609.5167; val_gene_expr_recon_loss: 36971960.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111352027.2000; val_global_loss: 151480468.2667; val_optim_loss: 151480468.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 45 min 39 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.9180
val AUPRC score: 0.9066
val best accuracy score: 0.8420
val best F1 score: 0.8525
val target rna MSE score: 1.7971
val source rna MSE score: 69.9444
val target atac MSE score: 0.1394
val source atac MSE score: 29.6220
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
