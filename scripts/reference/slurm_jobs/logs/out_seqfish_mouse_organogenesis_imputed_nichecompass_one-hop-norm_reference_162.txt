[True]
Run timestamp: 27072023_043641_162.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_162']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8598; val_auprc_score: 0.9723; val_best_acc_score: 0.8580; val_best_f1_score: 0.9236; train_kl_reg_loss: 545801.4071; train_edge_recon_loss: 11029866.7628; train_gene_expr_recon_loss: 180775774.6233; train_masked_gp_l1_reg_loss: 15369.1281; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192366813.6558; train_optim_loss: 192366813.6558; val_kl_reg_loss: 475828.6953; val_edge_recon_loss: 11536097.1250; val_gene_expr_recon_loss: 104269830.0000; val_masked_gp_l1_reg_loss: 16080.4971; val_group_lasso_reg_loss: 0.0000; val_global_loss: 116297835.6667; val_optim_loss: 116297835.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8613; val_auprc_score: 0.9727; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 583822.1480; train_edge_recon_loss: 11063825.7674; train_gene_expr_recon_loss: 102793633.8977; train_masked_gp_l1_reg_loss: 16458.9402; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114457740.6884; train_optim_loss: 114457740.6884; val_kl_reg_loss: 449859.8411; val_edge_recon_loss: 11718067.5833; val_gene_expr_recon_loss: 99677229.0000; val_masked_gp_l1_reg_loss: 16978.4492; val_group_lasso_reg_loss: 0.0000; val_global_loss: 111862132.0000; val_optim_loss: 111862132.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8401; val_auprc_score: 0.9668; val_best_acc_score: 0.8702; val_best_f1_score: 0.9289; train_kl_reg_loss: 499779.8933; train_edge_recon_loss: 10949433.9256; train_gene_expr_recon_loss: 100420238.6977; train_masked_gp_l1_reg_loss: 17721.8346; train_group_lasso_reg_loss: 0.0000; train_global_loss: 111887173.9535; train_optim_loss: 111887173.9535; val_kl_reg_loss: 457427.8776; val_edge_recon_loss: 11842788.6250; val_gene_expr_recon_loss: 96196235.0000; val_masked_gp_l1_reg_loss: 18399.6953; val_group_lasso_reg_loss: 0.0000; val_global_loss: 108514851.6667; val_optim_loss: 108514851.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8417; val_auprc_score: 0.9658; val_best_acc_score: 0.8719; val_best_f1_score: 0.9277; train_kl_reg_loss: 480335.4815; train_edge_recon_loss: 10856524.8930; train_gene_expr_recon_loss: 94771923.0512; train_masked_gp_l1_reg_loss: 18999.3025; train_group_lasso_reg_loss: 0.0000; train_global_loss: 106127782.8093; train_optim_loss: 106127782.8093; val_kl_reg_loss: 414480.3776; val_edge_recon_loss: 11855659.7083; val_gene_expr_recon_loss: 93114797.0000; val_masked_gp_l1_reg_loss: 19576.1406; val_group_lasso_reg_loss: 0.0000; val_global_loss: 105404514.0000; val_optim_loss: 105404514.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8552; val_auprc_score: 0.9698; val_best_acc_score: 0.8772; val_best_f1_score: 0.9331; train_kl_reg_loss: 458576.8658; train_edge_recon_loss: 10755011.0698; train_gene_expr_recon_loss: 92038732.7256; train_masked_gp_l1_reg_loss: 20167.8443; train_group_lasso_reg_loss: 0.0000; train_global_loss: 103272488.3721; train_optim_loss: 103272488.3721; val_kl_reg_loss: 406855.0482; val_edge_recon_loss: 11373206.1667; val_gene_expr_recon_loss: 90766720.0000; val_masked_gp_l1_reg_loss: 20764.6719; val_group_lasso_reg_loss: 0.0000; val_global_loss: 102567549.3333; val_optim_loss: 102567549.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8605; val_auprc_score: 0.9693; val_best_acc_score: 0.8810; val_best_f1_score: 0.9340; train_kl_reg_loss: 428152.1199; train_edge_recon_loss: 10703890.3953; train_gene_expr_recon_loss: 89635048.5209; train_masked_gp_l1_reg_loss: 21300.6852; train_group_lasso_reg_loss: 0.0000; train_global_loss: 100788392.1116; train_optim_loss: 100788392.1116; val_kl_reg_loss: 358562.1276; val_edge_recon_loss: 11838655.0000; val_gene_expr_recon_loss: 88442921.0000; val_masked_gp_l1_reg_loss: 21861.3711; val_group_lasso_reg_loss: 0.0000; val_global_loss: 100662002.0000; val_optim_loss: 100662002.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8417; val_auprc_score: 0.9662; val_best_acc_score: 0.8721; val_best_f1_score: 0.9291; train_kl_reg_loss: 417612.5991; train_edge_recon_loss: 10733317.3558; train_gene_expr_recon_loss: 87966943.7767; train_masked_gp_l1_reg_loss: 22470.0765; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99140343.8512; train_optim_loss: 99140343.8512; val_kl_reg_loss: 351252.2526; val_edge_recon_loss: 11840897.5417; val_gene_expr_recon_loss: 86896635.0000; val_masked_gp_l1_reg_loss: 23203.0664; val_group_lasso_reg_loss: 0.0000; val_global_loss: 99111984.3333; val_optim_loss: 99111984.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8587; val_auprc_score: 0.9690; val_best_acc_score: 0.8821; val_best_f1_score: 0.9344; train_kl_reg_loss: 391641.1124; train_edge_recon_loss: 10686788.5442; train_gene_expr_recon_loss: 85921392.8186; train_masked_gp_l1_reg_loss: 23697.9358; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97023520.8186; train_optim_loss: 97023520.8186; val_kl_reg_loss: 353637.2448; val_edge_recon_loss: 11551800.0000; val_gene_expr_recon_loss: 85038420.6667; val_masked_gp_l1_reg_loss: 24148.0176; val_group_lasso_reg_loss: 0.0000; val_global_loss: 96968009.6667; val_optim_loss: 96968009.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8688; val_auprc_score: 0.9713; val_best_acc_score: 0.8867; val_best_f1_score: 0.9360; train_kl_reg_loss: 359468.4680; train_edge_recon_loss: 10582675.0837; train_gene_expr_recon_loss: 84292712.9674; train_masked_gp_l1_reg_loss: 24535.8034; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95259392.1860; train_optim_loss: 95259392.1860; val_kl_reg_loss: 306832.7773; val_edge_recon_loss: 11432941.5000; val_gene_expr_recon_loss: 83656954.3333; val_masked_gp_l1_reg_loss: 24927.4980; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95421656.0000; val_optim_loss: 95421656.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8695; val_auprc_score: 0.9724; val_best_acc_score: 0.8906; val_best_f1_score: 0.9386; train_kl_reg_loss: 316841.1253; train_edge_recon_loss: 10410600.0372; train_gene_expr_recon_loss: 82936834.6419; train_masked_gp_l1_reg_loss: 25307.4796; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93689583.4419; train_optim_loss: 93689583.4419; val_kl_reg_loss: 257625.0775; val_edge_recon_loss: 10653072.1667; val_gene_expr_recon_loss: 82331309.0000; val_masked_gp_l1_reg_loss: 25693.2793; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93267702.3333; val_optim_loss: 93267702.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8622; val_auprc_score: 0.9672; val_best_acc_score: 0.8835; val_best_f1_score: 0.9339; train_kl_reg_loss: 271425.4682; train_edge_recon_loss: 10162647.5512; train_gene_expr_recon_loss: 81739246.8465; train_masked_gp_l1_reg_loss: 26090.9992; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92199410.7163; train_optim_loss: 92199410.7163; val_kl_reg_loss: 252009.9056; val_edge_recon_loss: 10745287.0000; val_gene_expr_recon_loss: 81208281.6667; val_masked_gp_l1_reg_loss: 26516.0508; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92232098.3333; val_optim_loss: 92232098.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8680; val_auprc_score: 0.9709; val_best_acc_score: 0.8910; val_best_f1_score: 0.9385; train_kl_reg_loss: 252194.4605; train_edge_recon_loss: 9794835.6814; train_gene_expr_recon_loss: 80629922.4186; train_masked_gp_l1_reg_loss: 26951.3168; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90703903.9256; train_optim_loss: 90703903.9256; val_kl_reg_loss: 257521.7943; val_edge_recon_loss: 9598387.4375; val_gene_expr_recon_loss: 80099120.6667; val_masked_gp_l1_reg_loss: 27400.4473; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89982429.3333; val_optim_loss: 89982429.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8653; val_auprc_score: 0.9707; val_best_acc_score: 0.8887; val_best_f1_score: 0.9377; train_kl_reg_loss: 278438.4227; train_edge_recon_loss: 9373689.5535; train_gene_expr_recon_loss: 79582273.3395; train_masked_gp_l1_reg_loss: 27831.0442; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89262232.5209; train_optim_loss: 89262232.5209; val_kl_reg_loss: 289452.5833; val_edge_recon_loss: 9115539.3333; val_gene_expr_recon_loss: 79157149.3333; val_masked_gp_l1_reg_loss: 28244.4688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 88590390.0000; val_optim_loss: 88590390.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8492; val_auprc_score: 0.9668; val_best_acc_score: 0.8863; val_best_f1_score: 0.9363; train_kl_reg_loss: 312938.6584; train_edge_recon_loss: 9229372.8535; train_gene_expr_recon_loss: 78632966.2140; train_masked_gp_l1_reg_loss: 28657.3404; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88203934.8465; train_optim_loss: 88203934.8465; val_kl_reg_loss: 318334.1914; val_edge_recon_loss: 9195051.9583; val_gene_expr_recon_loss: 78160799.0000; val_masked_gp_l1_reg_loss: 29057.5293; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87703241.0000; val_optim_loss: 87703241.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8624; val_auprc_score: 0.9703; val_best_acc_score: 0.8900; val_best_f1_score: 0.9393; train_kl_reg_loss: 343941.2356; train_edge_recon_loss: 8994628.0767; train_gene_expr_recon_loss: 77758076.3535; train_masked_gp_l1_reg_loss: 29446.9174; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87126092.4651; train_optim_loss: 87126092.4651; val_kl_reg_loss: 337812.6029; val_edge_recon_loss: 8833639.2500; val_gene_expr_recon_loss: 77333157.6667; val_masked_gp_l1_reg_loss: 29825.1602; val_group_lasso_reg_loss: 0.0000; val_global_loss: 86534434.0000; val_optim_loss: 86534434.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8684; val_auprc_score: 0.9715; val_best_acc_score: 0.8911; val_best_f1_score: 0.9394; train_kl_reg_loss: 354601.4775; train_edge_recon_loss: 8785860.2000; train_gene_expr_recon_loss: 76949461.0605; train_masked_gp_l1_reg_loss: 30210.0940; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86120133.0977; train_optim_loss: 86120133.0977; val_kl_reg_loss: 342709.8724; val_edge_recon_loss: 8793062.0417; val_gene_expr_recon_loss: 76632676.6667; val_masked_gp_l1_reg_loss: 30598.2793; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85799047.6667; val_optim_loss: 85799047.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8746; val_auprc_score: 0.9713; val_best_acc_score: 0.8958; val_best_f1_score: 0.9414; train_kl_reg_loss: 354423.2251; train_edge_recon_loss: 8743395.1698; train_gene_expr_recon_loss: 76224242.2698; train_masked_gp_l1_reg_loss: 30969.2367; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85353029.8791; train_optim_loss: 85353029.8791; val_kl_reg_loss: 337354.8958; val_edge_recon_loss: 8938459.3333; val_gene_expr_recon_loss: 75928470.0000; val_masked_gp_l1_reg_loss: 31312.6836; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85235596.0000; val_optim_loss: 85235596.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8871; val_auprc_score: 0.9749; val_best_acc_score: 0.9035; val_best_f1_score: 0.9457; train_kl_reg_loss: 347269.9875; train_edge_recon_loss: 8711513.4837; train_gene_expr_recon_loss: 75579786.6047; train_masked_gp_l1_reg_loss: 31664.9750; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84670234.9023; train_optim_loss: 84670234.9023; val_kl_reg_loss: 329608.0013; val_edge_recon_loss: 8768798.3958; val_gene_expr_recon_loss: 75372810.6667; val_masked_gp_l1_reg_loss: 32011.1758; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84503224.6667; val_optim_loss: 84503224.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8894; val_auprc_score: 0.9754; val_best_acc_score: 0.9058; val_best_f1_score: 0.9468; train_kl_reg_loss: 339791.1391; train_edge_recon_loss: 8551614.8581; train_gene_expr_recon_loss: 74977992.4093; train_masked_gp_l1_reg_loss: 32326.2180; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83901724.5023; train_optim_loss: 83901724.5023; val_kl_reg_loss: 321069.2122; val_edge_recon_loss: 8697303.5208; val_gene_expr_recon_loss: 74865340.6667; val_masked_gp_l1_reg_loss: 32650.2383; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83916361.6667; val_optim_loss: 83916361.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8993; val_auprc_score: 0.9788; val_best_acc_score: 0.9079; val_best_f1_score: 0.9480; train_kl_reg_loss: 326381.0281; train_edge_recon_loss: 8458347.0674; train_gene_expr_recon_loss: 74445944.6326; train_masked_gp_l1_reg_loss: 32964.4039; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83263637.0233; train_optim_loss: 83263637.0233; val_kl_reg_loss: 307147.6432; val_edge_recon_loss: 8497714.7083; val_gene_expr_recon_loss: 74281583.3333; val_masked_gp_l1_reg_loss: 33282.4258; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83119726.6667; val_optim_loss: 83119726.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9049; val_auprc_score: 0.9798; val_best_acc_score: 0.9101; val_best_f1_score: 0.9493; train_kl_reg_loss: 310408.4344; train_edge_recon_loss: 8456478.2767; train_gene_expr_recon_loss: 73936818.9023; train_masked_gp_l1_reg_loss: 33602.2149; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82737307.6093; train_optim_loss: 82737307.6093; val_kl_reg_loss: 291617.2487; val_edge_recon_loss: 8428995.4167; val_gene_expr_recon_loss: 73815292.0000; val_masked_gp_l1_reg_loss: 33927.1016; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82569832.6667; val_optim_loss: 82569832.6667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9041; val_auprc_score: 0.9802; val_best_acc_score: 0.9078; val_best_f1_score: 0.9479; train_kl_reg_loss: 295421.9365; train_edge_recon_loss: 8398399.3767; train_gene_expr_recon_loss: 73468957.3581; train_masked_gp_l1_reg_loss: 34240.8575; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82197019.4233; train_optim_loss: 82197019.4233; val_kl_reg_loss: 277758.9635; val_edge_recon_loss: 8441802.5000; val_gene_expr_recon_loss: 73310418.3333; val_masked_gp_l1_reg_loss: 34560.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82064539.3333; val_optim_loss: 82064539.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9083; val_auprc_score: 0.9806; val_best_acc_score: 0.9093; val_best_f1_score: 0.9485; train_kl_reg_loss: 283311.1328; train_edge_recon_loss: 8333471.2977; train_gene_expr_recon_loss: 73059014.4372; train_masked_gp_l1_reg_loss: 34866.9413; train_group_lasso_reg_loss: 0.0000; train_global_loss: 81710664.0744; train_optim_loss: 81710664.0744; val_kl_reg_loss: 267868.8125; val_edge_recon_loss: 8419567.4583; val_gene_expr_recon_loss: 72891052.6667; val_masked_gp_l1_reg_loss: 35166.5977; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81613657.0000; val_optim_loss: 81613657.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9109; val_auprc_score: 0.9809; val_best_acc_score: 0.9127; val_best_f1_score: 0.9500; train_kl_reg_loss: 272916.2661; train_edge_recon_loss: 8364223.6698; train_gene_expr_recon_loss: 72702311.1070; train_masked_gp_l1_reg_loss: 35491.7605; train_group_lasso_reg_loss: 0.0000; train_global_loss: 81374942.8093; train_optim_loss: 81374942.8093; val_kl_reg_loss: 256613.5150; val_edge_recon_loss: 8380565.3958; val_gene_expr_recon_loss: 72659139.0000; val_masked_gp_l1_reg_loss: 35811.9609; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81332126.0000; val_optim_loss: 81332126.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9163; val_auprc_score: 0.9823; val_best_acc_score: 0.9146; val_best_f1_score: 0.9511; train_kl_reg_loss: 255987.9937; train_edge_recon_loss: 8228276.5419; train_gene_expr_recon_loss: 72333166.5488; train_masked_gp_l1_reg_loss: 36125.2082; train_group_lasso_reg_loss: 0.0000; train_global_loss: 80853556.5395; train_optim_loss: 80853556.5395; val_kl_reg_loss: 241608.6836; val_edge_recon_loss: 8262918.6250; val_gene_expr_recon_loss: 72263267.6667; val_masked_gp_l1_reg_loss: 36416.2891; val_group_lasso_reg_loss: 0.0000; val_global_loss: 80804211.0000; val_optim_loss: 80804211.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8622; val_auprc_score: 0.9682; val_best_acc_score: 0.8925; val_best_f1_score: 0.9394; train_kl_reg_loss: 123618.6054; train_edge_recon_loss: 11083804.2140; train_gene_expr_recon_loss: 86473484.9860; train_masked_gp_l1_reg_loss: 39451.0090; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97720358.6977; train_optim_loss: 97720358.6977; val_kl_reg_loss: 13209.9269; val_edge_recon_loss: 10737989.1667; val_gene_expr_recon_loss: 80704463.6667; val_masked_gp_l1_reg_loss: 41499.9688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91497158.0000; val_optim_loss: 91497158.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8599; val_auprc_score: 0.9650; val_best_acc_score: 0.8901; val_best_f1_score: 0.9378; train_kl_reg_loss: 71803.2990; train_edge_recon_loss: 10403171.0047; train_gene_expr_recon_loss: 78822384.5953; train_masked_gp_l1_reg_loss: 42675.6074; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89340034.4186; train_optim_loss: 89340034.4186; val_kl_reg_loss: 15807.4637; val_edge_recon_loss: 10312541.3750; val_gene_expr_recon_loss: 77455529.0000; val_masked_gp_l1_reg_loss: 42930.7812; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87826805.6667; val_optim_loss: 87826805.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8678; val_auprc_score: 0.9657; val_best_acc_score: 0.8970; val_best_f1_score: 0.9416; train_kl_reg_loss: 82249.2176; train_edge_recon_loss: 9939827.7326; train_gene_expr_recon_loss: 76864782.5116; train_masked_gp_l1_reg_loss: 43046.7834; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86929906.3070; train_optim_loss: 86929906.3070; val_kl_reg_loss: 19187.4148; val_edge_recon_loss: 9710996.5208; val_gene_expr_recon_loss: 76643752.0000; val_masked_gp_l1_reg_loss: 43175.6328; val_group_lasso_reg_loss: 0.0000; val_global_loss: 86417112.0000; val_optim_loss: 86417112.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8725; val_auprc_score: 0.9675; val_best_acc_score: 0.8974; val_best_f1_score: 0.9420; train_kl_reg_loss: 86921.8975; train_edge_recon_loss: 9666893.8628; train_gene_expr_recon_loss: 76459382.6233; train_masked_gp_l1_reg_loss: 43486.1114; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86256684.4279; train_optim_loss: 86256684.4279; val_kl_reg_loss: 19114.8291; val_edge_recon_loss: 9565240.8750; val_gene_expr_recon_loss: 76321944.6667; val_masked_gp_l1_reg_loss: 43738.6406; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85950036.3333; val_optim_loss: 85950036.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8733; val_auprc_score: 0.9687; val_best_acc_score: 0.9009; val_best_f1_score: 0.9444; train_kl_reg_loss: 85864.2604; train_edge_recon_loss: 9528872.3953; train_gene_expr_recon_loss: 76106529.4884; train_masked_gp_l1_reg_loss: 43750.7396; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85765016.5209; train_optim_loss: 85765016.5209; val_kl_reg_loss: 19486.0046; val_edge_recon_loss: 9101617.2917; val_gene_expr_recon_loss: 76099713.6667; val_masked_gp_l1_reg_loss: 43763.2422; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85264577.0000; val_optim_loss: 85264577.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8720; val_auprc_score: 0.9679; val_best_acc_score: 0.8958; val_best_f1_score: 0.9413; train_kl_reg_loss: 85914.9427; train_edge_recon_loss: 9436551.9814; train_gene_expr_recon_loss: 76051532.0558; train_masked_gp_l1_reg_loss: 43781.8519; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85617780.6884; train_optim_loss: 85617780.6884; val_kl_reg_loss: 19775.8582; val_edge_recon_loss: 9482163.8958; val_gene_expr_recon_loss: 76074745.0000; val_masked_gp_l1_reg_loss: 43801.3438; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85620484.6667; val_optim_loss: 85620484.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8710; val_auprc_score: 0.9662; val_best_acc_score: 0.8972; val_best_f1_score: 0.9420; train_kl_reg_loss: 86059.0153; train_edge_recon_loss: 9529683.4651; train_gene_expr_recon_loss: 75971857.3767; train_masked_gp_l1_reg_loss: 43820.8887; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85631420.6884; train_optim_loss: 85631420.6884; val_kl_reg_loss: 20145.9187; val_edge_recon_loss: 9473311.6667; val_gene_expr_recon_loss: 76165679.0000; val_masked_gp_l1_reg_loss: 43844.1328; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85702983.6667; val_optim_loss: 85702983.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8693; val_auprc_score: 0.9663; val_best_acc_score: 0.8972; val_best_f1_score: 0.9416; train_kl_reg_loss: 86388.4428; train_edge_recon_loss: 9476571.7628; train_gene_expr_recon_loss: 75918104.8558; train_masked_gp_l1_reg_loss: 43866.2377; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85524931.3860; train_optim_loss: 85524931.3860; val_kl_reg_loss: 20425.6041; val_edge_recon_loss: 9328985.8958; val_gene_expr_recon_loss: 75894749.6667; val_masked_gp_l1_reg_loss: 43889.4609; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85288049.3333; val_optim_loss: 85288049.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 17 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9344
Val AUPRC score: 0.9865
Val best accuracy score: 0.9279
Val best F1 score: 0.9586
Val gene expr MSE score: 31851.5801
Val cat covariate0 mean sim diff: -0.0020

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
