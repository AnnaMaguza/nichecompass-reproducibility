[True]
Run timestamp: 07092023_002703_219.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_219']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 792 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3517, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 792
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 792

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7846; val_auprc_score: 0.8018; val_best_acc_score: 0.6028; val_best_f1_score: 0.7081; train_kl_reg_loss: 76198.5913; train_edge_recon_loss: 3526811.9523; train_gene_expr_recon_loss: 12614909.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 633641.0570; train_chrom_access_recon_loss: 4462432.0802; train_global_loss: 21313993.3282; train_optim_loss: 21313993.3282; val_kl_reg_loss: 83121.2115; val_edge_recon_loss: 4059804.6667; val_gene_expr_recon_loss: 12019321.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 322461.0000; val_chrom_access_recon_loss: 4339529.3000; val_global_loss: 20824237.2000; val_optim_loss: 20824237.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8501; val_auprc_score: 0.8429; val_best_acc_score: 0.7642; val_best_f1_score: 0.7867; train_kl_reg_loss: 74323.2553; train_edge_recon_loss: 3443950.7061; train_gene_expr_recon_loss: 11790859.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 193806.3857; train_chrom_access_recon_loss: 4282779.2615; train_global_loss: 19785718.9466; train_optim_loss: 19785718.9466; val_kl_reg_loss: 68536.6622; val_edge_recon_loss: 3128477.0500; val_gene_expr_recon_loss: 11874053.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117660.3672; val_chrom_access_recon_loss: 4287358.9667; val_global_loss: 19476086.4000; val_optim_loss: 19476086.4000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8923; val_auprc_score: 0.8742; val_best_acc_score: 0.8126; val_best_f1_score: 0.8234; train_kl_reg_loss: 81575.3606; train_edge_recon_loss: 2983480.4828; train_gene_expr_recon_loss: 11645186.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89001.8782; train_chrom_access_recon_loss: 4232424.4637; train_global_loss: 19031668.8092; train_optim_loss: 19031668.8092; val_kl_reg_loss: 87065.7427; val_edge_recon_loss: 2886544.5833; val_gene_expr_recon_loss: 11619574.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67815.7734; val_chrom_access_recon_loss: 4235405.5500; val_global_loss: 18896407.0667; val_optim_loss: 18896407.0667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9132; val_auprc_score: 0.8966; val_best_acc_score: 0.8390; val_best_f1_score: 0.8503; train_kl_reg_loss: 83327.9022; train_edge_recon_loss: 2861902.7328; train_gene_expr_recon_loss: 11470194.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56933.0608; train_chrom_access_recon_loss: 4181473.7481; train_global_loss: 18653831.7710; train_optim_loss: 18653831.7710; val_kl_reg_loss: 82525.3354; val_edge_recon_loss: 2849548.9167; val_gene_expr_recon_loss: 11477531.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48119.9844; val_chrom_access_recon_loss: 4173068.0667; val_global_loss: 18630794.0000; val_optim_loss: 18630794.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9273; val_auprc_score: 0.9125; val_best_acc_score: 0.8539; val_best_f1_score: 0.8632; train_kl_reg_loss: 81743.7208; train_edge_recon_loss: 2810539.8760; train_gene_expr_recon_loss: 11340780.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43079.9024; train_chrom_access_recon_loss: 4140696.0954; train_global_loss: 18416840.1832; train_optim_loss: 18416840.1832; val_kl_reg_loss: 82832.0620; val_edge_recon_loss: 2812064.1333; val_gene_expr_recon_loss: 11397768.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39276.4414; val_chrom_access_recon_loss: 4145636.3833; val_global_loss: 18477577.3333; val_optim_loss: 18477577.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9290; val_auprc_score: 0.9144; val_best_acc_score: 0.8588; val_best_f1_score: 0.8665; train_kl_reg_loss: 79387.1141; train_edge_recon_loss: 2789383.5534; train_gene_expr_recon_loss: 11234324.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36636.6005; train_chrom_access_recon_loss: 4110009.4714; train_global_loss: 18249741.3282; train_optim_loss: 18249741.3282; val_kl_reg_loss: 77436.8203; val_edge_recon_loss: 2787485.3500; val_gene_expr_recon_loss: 11289785.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34478.0781; val_chrom_access_recon_loss: 4118020.8833; val_global_loss: 18307206.8000; val_optim_loss: 18307206.8000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9385; val_auprc_score: 0.9238; val_best_acc_score: 0.8754; val_best_f1_score: 0.8819; train_kl_reg_loss: 73392.2626; train_edge_recon_loss: 2781153.1794; train_gene_expr_recon_loss: 11145814.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33242.2094; train_chrom_access_recon_loss: 4078197.2595; train_global_loss: 18111799.1756; train_optim_loss: 18111799.1756; val_kl_reg_loss: 73688.8323; val_edge_recon_loss: 2802682.9500; val_gene_expr_recon_loss: 11190646.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32088.3203; val_chrom_access_recon_loss: 4084295.3000; val_global_loss: 18183401.0667; val_optim_loss: 18183401.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9485; val_auprc_score: 0.9364; val_best_acc_score: 0.8870; val_best_f1_score: 0.8921; train_kl_reg_loss: 71710.0909; train_edge_recon_loss: 2756743.8721; train_gene_expr_recon_loss: 11063781.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31394.8347; train_chrom_access_recon_loss: 4049761.8645; train_global_loss: 17973392.3588; train_optim_loss: 17973392.3588; val_kl_reg_loss: 71412.7167; val_edge_recon_loss: 2761441.8167; val_gene_expr_recon_loss: 11122994.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30963.7090; val_chrom_access_recon_loss: 4080892.9167; val_global_loss: 18067705.7333; val_optim_loss: 18067705.7333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9569; val_auprc_score: 0.9463; val_best_acc_score: 0.8989; val_best_f1_score: 0.9023; train_kl_reg_loss: 68525.7336; train_edge_recon_loss: 2742473.5630; train_gene_expr_recon_loss: 10987002.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30133.3068; train_chrom_access_recon_loss: 4023224.9790; train_global_loss: 17851360.3969; train_optim_loss: 17851360.3969; val_kl_reg_loss: 66107.5073; val_edge_recon_loss: 2730427.8000; val_gene_expr_recon_loss: 11075616.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29700.5820; val_chrom_access_recon_loss: 4050642.3667; val_global_loss: 17952494.6667; val_optim_loss: 17952494.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9567; val_auprc_score: 0.9465; val_best_acc_score: 0.8911; val_best_f1_score: 0.8957; train_kl_reg_loss: 67868.8217; train_edge_recon_loss: 2725650.6221; train_gene_expr_recon_loss: 10906057.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29079.7022; train_chrom_access_recon_loss: 3992999.1336; train_global_loss: 17721655.2977; train_optim_loss: 17721655.2977; val_kl_reg_loss: 63790.7443; val_edge_recon_loss: 2745148.4333; val_gene_expr_recon_loss: 10993175.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28681.4492; val_chrom_access_recon_loss: 4025514.8833; val_global_loss: 17856310.5333; val_optim_loss: 17856310.5333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9600; val_auprc_score: 0.9494; val_best_acc_score: 0.9019; val_best_f1_score: 0.9055; train_kl_reg_loss: 65190.2384; train_edge_recon_loss: 2716268.5153; train_gene_expr_recon_loss: 10861762.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28313.6686; train_chrom_access_recon_loss: 3977182.9485; train_global_loss: 17648718.1756; train_optim_loss: 17648718.1756; val_kl_reg_loss: 64652.8281; val_edge_recon_loss: 2733838.9000; val_gene_expr_recon_loss: 10937960.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28144.0332; val_chrom_access_recon_loss: 3984623.8667; val_global_loss: 17749220.3333; val_optim_loss: 17749220.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9617; val_auprc_score: 0.9498; val_best_acc_score: 0.9057; val_best_f1_score: 0.9093; train_kl_reg_loss: 65198.6694; train_edge_recon_loss: 2706137.9962; train_gene_expr_recon_loss: 10799347.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27830.6665; train_chrom_access_recon_loss: 3953656.9580; train_global_loss: 17552171.5725; train_optim_loss: 17552171.5725; val_kl_reg_loss: 66794.9292; val_edge_recon_loss: 2714068.4667; val_gene_expr_recon_loss: 10905538.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27791.5645; val_chrom_access_recon_loss: 4004597.0667; val_global_loss: 17718790.8000; val_optim_loss: 17718790.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9629; val_auprc_score: 0.9541; val_best_acc_score: 0.9053; val_best_f1_score: 0.9088; train_kl_reg_loss: 63185.0646; train_edge_recon_loss: 2701081.5573; train_gene_expr_recon_loss: 10755096.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27424.9756; train_chrom_access_recon_loss: 3940355.8435; train_global_loss: 17487143.7710; train_optim_loss: 17487143.7710; val_kl_reg_loss: 61453.1674; val_edge_recon_loss: 2701855.6000; val_gene_expr_recon_loss: 10783409.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27294.6562; val_chrom_access_recon_loss: 3947168.9833; val_global_loss: 17521182.2667; val_optim_loss: 17521182.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9660; val_auprc_score: 0.9584; val_best_acc_score: 0.9097; val_best_f1_score: 0.9141; train_kl_reg_loss: 62087.5204; train_edge_recon_loss: 2690261.5267; train_gene_expr_recon_loss: 10703786.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27086.4471; train_chrom_access_recon_loss: 3921754.7519; train_global_loss: 17404977.2290; train_optim_loss: 17404977.2290; val_kl_reg_loss: 60701.6878; val_edge_recon_loss: 2711381.8833; val_gene_expr_recon_loss: 10779588.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27243.0820; val_chrom_access_recon_loss: 3941699.3833; val_global_loss: 17520614.0000; val_optim_loss: 17520614.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9645; val_auprc_score: 0.9535; val_best_acc_score: 0.9101; val_best_f1_score: 0.9133; train_kl_reg_loss: 60632.3197; train_edge_recon_loss: 2683482.5763; train_gene_expr_recon_loss: 10663533.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26948.1021; train_chrom_access_recon_loss: 3905394.6107; train_global_loss: 17339990.9771; train_optim_loss: 17339990.9771; val_kl_reg_loss: 59780.2091; val_edge_recon_loss: 2683306.8000; val_gene_expr_recon_loss: 10701892.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26894.6406; val_chrom_access_recon_loss: 3914127.7500; val_global_loss: 17386001.8667; val_optim_loss: 17386001.8667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9673; val_auprc_score: 0.9573; val_best_acc_score: 0.9136; val_best_f1_score: 0.9158; train_kl_reg_loss: 59147.8035; train_edge_recon_loss: 2683907.5115; train_gene_expr_recon_loss: 10627920.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26700.6275; train_chrom_access_recon_loss: 3891305.9771; train_global_loss: 17288982.0382; train_optim_loss: 17288982.0382; val_kl_reg_loss: 61206.7326; val_edge_recon_loss: 2700243.2000; val_gene_expr_recon_loss: 10720718.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26593.1973; val_chrom_access_recon_loss: 3922331.2500; val_global_loss: 17431092.2667; val_optim_loss: 17431092.2667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9678; val_auprc_score: 0.9597; val_best_acc_score: 0.9147; val_best_f1_score: 0.9183; train_kl_reg_loss: 57864.6538; train_edge_recon_loss: 2682728.2863; train_gene_expr_recon_loss: 10588381.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26642.0868; train_chrom_access_recon_loss: 3875497.0344; train_global_loss: 17231113.2214; train_optim_loss: 17231113.2214; val_kl_reg_loss: 56317.8359; val_edge_recon_loss: 2690254.5000; val_gene_expr_recon_loss: 10666786.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26665.3809; val_chrom_access_recon_loss: 3905239.5167; val_global_loss: 17345263.8667; val_optim_loss: 17345263.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9677; val_auprc_score: 0.9581; val_best_acc_score: 0.9188; val_best_f1_score: 0.9209; train_kl_reg_loss: 57206.9395; train_edge_recon_loss: 2676523.7405; train_gene_expr_recon_loss: 10562292.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26594.9644; train_chrom_access_recon_loss: 3862722.7176; train_global_loss: 17185341.2366; train_optim_loss: 17185341.2366; val_kl_reg_loss: 59345.7789; val_edge_recon_loss: 2690469.7000; val_gene_expr_recon_loss: 10649421.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26454.6504; val_chrom_access_recon_loss: 3892862.6667; val_global_loss: 17318554.4000; val_optim_loss: 17318554.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9724; val_auprc_score: 0.9641; val_best_acc_score: 0.9225; val_best_f1_score: 0.9249; train_kl_reg_loss: 56899.5547; train_edge_recon_loss: 2676063.8511; train_gene_expr_recon_loss: 10529577.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26409.3109; train_chrom_access_recon_loss: 3851250.3989; train_global_loss: 17140201.1450; train_optim_loss: 17140201.1450; val_kl_reg_loss: 57703.4578; val_edge_recon_loss: 2678628.4667; val_gene_expr_recon_loss: 10598092.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26516.7227; val_chrom_access_recon_loss: 3869407.3333; val_global_loss: 17230348.8000; val_optim_loss: 17230348.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9704; val_auprc_score: 0.9618; val_best_acc_score: 0.9201; val_best_f1_score: 0.9228; train_kl_reg_loss: 55793.6891; train_edge_recon_loss: 2673579.4485; train_gene_expr_recon_loss: 10500198.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26452.8599; train_chrom_access_recon_loss: 3842299.5324; train_global_loss: 17098324.0916; train_optim_loss: 17098324.0916; val_kl_reg_loss: 53232.8372; val_edge_recon_loss: 2692627.6333; val_gene_expr_recon_loss: 10605093.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26628.1992; val_chrom_access_recon_loss: 3873563.6667; val_global_loss: 17251145.8667; val_optim_loss: 17251145.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9719; val_auprc_score: 0.9615; val_best_acc_score: 0.9252; val_best_f1_score: 0.9272; train_kl_reg_loss: 54265.8076; train_edge_recon_loss: 2669750.3740; train_gene_expr_recon_loss: 10475805.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26426.0347; train_chrom_access_recon_loss: 3830117.0763; train_global_loss: 17056364.3664; train_optim_loss: 17056364.3664; val_kl_reg_loss: 52777.9914; val_edge_recon_loss: 2689525.0500; val_gene_expr_recon_loss: 10555179.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26683.3164; val_chrom_access_recon_loss: 3860779.2500; val_global_loss: 17184944.4667; val_optim_loss: 17184944.4667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9730; val_auprc_score: 0.9648; val_best_acc_score: 0.9237; val_best_f1_score: 0.9269; train_kl_reg_loss: 53845.9240; train_edge_recon_loss: 2667145.4447; train_gene_expr_recon_loss: 10441429.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26615.1879; train_chrom_access_recon_loss: 3817918.7233; train_global_loss: 17006954.9084; train_optim_loss: 17006954.9084; val_kl_reg_loss: 53387.6854; val_edge_recon_loss: 2671530.3500; val_gene_expr_recon_loss: 10519857.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26623.9805; val_chrom_access_recon_loss: 3855195.8333; val_global_loss: 17126595.2667; val_optim_loss: 17126595.2667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9752; val_auprc_score: 0.9682; val_best_acc_score: 0.9295; val_best_f1_score: 0.9320; train_kl_reg_loss: 53866.2345; train_edge_recon_loss: 2661048.2653; train_gene_expr_recon_loss: 10423764.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26633.7574; train_chrom_access_recon_loss: 3808018.3626; train_global_loss: 16973331.2137; train_optim_loss: 16973331.2137; val_kl_reg_loss: 53438.6740; val_edge_recon_loss: 2665078.7667; val_gene_expr_recon_loss: 10513296.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26761.4531; val_chrom_access_recon_loss: 3838554.3667; val_global_loss: 17097129.5333; val_optim_loss: 17097129.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9739; val_auprc_score: 0.9652; val_best_acc_score: 0.9297; val_best_f1_score: 0.9322; train_kl_reg_loss: 52306.5102; train_edge_recon_loss: 2664108.6908; train_gene_expr_recon_loss: 10401417.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26601.3889; train_chrom_access_recon_loss: 3796693.9809; train_global_loss: 16941128.0687; train_optim_loss: 16941128.0687; val_kl_reg_loss: 53875.3932; val_edge_recon_loss: 2667195.3500; val_gene_expr_recon_loss: 10489992.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26971.2012; val_chrom_access_recon_loss: 3849354.8000; val_global_loss: 17087388.7333; val_optim_loss: 17087388.7333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9765; val_auprc_score: 0.9708; val_best_acc_score: 0.9309; val_best_f1_score: 0.9329; train_kl_reg_loss: 51562.3235; train_edge_recon_loss: 2658812.2443; train_gene_expr_recon_loss: 10373118.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26838.9133; train_chrom_access_recon_loss: 3784636.2385; train_global_loss: 16894968.0611; train_optim_loss: 16894968.0611; val_kl_reg_loss: 49435.8201; val_edge_recon_loss: 2677500.4500; val_gene_expr_recon_loss: 10501311.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26776.0957; val_chrom_access_recon_loss: 3840668.9333; val_global_loss: 17095692.7333; val_optim_loss: 17095692.7333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9740; val_auprc_score: 0.9656; val_best_acc_score: 0.9295; val_best_f1_score: 0.9321; train_kl_reg_loss: 51167.9771; train_edge_recon_loss: 2659276.7920; train_gene_expr_recon_loss: 10355242.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26932.3351; train_chrom_access_recon_loss: 3775726.3912; train_global_loss: 16868346.5191; train_optim_loss: 16868346.5191; val_kl_reg_loss: 51674.9508; val_edge_recon_loss: 2681029.6000; val_gene_expr_recon_loss: 10502337.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27199.9453; val_chrom_access_recon_loss: 3829206.5167; val_global_loss: 17091448.5333; val_optim_loss: 17091448.5333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9794; val_auprc_score: 0.9727; val_best_acc_score: 0.9378; val_best_f1_score: 0.9400; train_kl_reg_loss: 50222.9173; train_edge_recon_loss: 2663635.8263; train_gene_expr_recon_loss: 10329597.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27066.4530; train_chrom_access_recon_loss: 3764948.5153; train_global_loss: 16835471.0992; train_optim_loss: 16835471.0992; val_kl_reg_loss: 48526.7344; val_edge_recon_loss: 2650990.1167; val_gene_expr_recon_loss: 10422913.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27590.9238; val_chrom_access_recon_loss: 3797718.3833; val_global_loss: 16947739.8667; val_optim_loss: 16947739.8667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9799; val_auprc_score: 0.9751; val_best_acc_score: 0.9390; val_best_f1_score: 0.9411; train_kl_reg_loss: 50526.8813; train_edge_recon_loss: 2657376.5363; train_gene_expr_recon_loss: 10317694.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27366.6422; train_chrom_access_recon_loss: 3756894.9656; train_global_loss: 16809859.0305; train_optim_loss: 16809859.0305; val_kl_reg_loss: 50858.0414; val_edge_recon_loss: 2667695.1000; val_gene_expr_recon_loss: 10432411.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27259.8184; val_chrom_access_recon_loss: 3806498.1667; val_global_loss: 16984722.6667; val_optim_loss: 16984722.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9790; val_auprc_score: 0.9732; val_best_acc_score: 0.9398; val_best_f1_score: 0.9413; train_kl_reg_loss: 50207.2943; train_edge_recon_loss: 2654593.8779; train_gene_expr_recon_loss: 10300233.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27415.4465; train_chrom_access_recon_loss: 3743714.4542; train_global_loss: 16776164.4733; train_optim_loss: 16776164.4733; val_kl_reg_loss: 50236.9003; val_edge_recon_loss: 2650595.2000; val_gene_expr_recon_loss: 10463403.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27481.5215; val_chrom_access_recon_loss: 3815295.0833; val_global_loss: 17007012.5333; val_optim_loss: 17007012.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9813; val_auprc_score: 0.9754; val_best_acc_score: 0.9372; val_best_f1_score: 0.9388; train_kl_reg_loss: 49623.8551; train_edge_recon_loss: 2652117.5420; train_gene_expr_recon_loss: 10284029.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27564.2531; train_chrom_access_recon_loss: 3740808.2576; train_global_loss: 16754143.4504; train_optim_loss: 16754143.4504; val_kl_reg_loss: 47951.5070; val_edge_recon_loss: 2676519.9167; val_gene_expr_recon_loss: 10432939.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27804.4805; val_chrom_access_recon_loss: 3800311.4833; val_global_loss: 16985526.1333; val_optim_loss: 16985526.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9773; val_auprc_score: 0.9685; val_best_acc_score: 0.9376; val_best_f1_score: 0.9399; train_kl_reg_loss: 49209.1266; train_edge_recon_loss: 2654435.5019; train_gene_expr_recon_loss: 10262351.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27866.7820; train_chrom_access_recon_loss: 3725555.2309; train_global_loss: 16719418.5573; train_optim_loss: 16719418.5573; val_kl_reg_loss: 47644.5935; val_edge_recon_loss: 2665253.4667; val_gene_expr_recon_loss: 10436701.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27750.6895; val_chrom_access_recon_loss: 3798410.9000; val_global_loss: 16975761.3333; val_optim_loss: 16975761.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9793; val_auprc_score: 0.9730; val_best_acc_score: 0.9414; val_best_f1_score: 0.9434; train_kl_reg_loss: 49479.0600; train_edge_recon_loss: 2650022.5744; train_gene_expr_recon_loss: 10235964.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23282.7451; train_chrom_access_recon_loss: 3712477.0420; train_global_loss: 16671225.5267; train_optim_loss: 16671225.5267; val_kl_reg_loss: 50654.6172; val_edge_recon_loss: 2645312.8500; val_gene_expr_recon_loss: 10402231.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22390.0332; val_chrom_access_recon_loss: 3794023.7500; val_global_loss: 16914612.6667; val_optim_loss: 16914612.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9818; val_auprc_score: 0.9755; val_best_acc_score: 0.9427; val_best_f1_score: 0.9442; train_kl_reg_loss: 50600.7818; train_edge_recon_loss: 2650470.6985; train_gene_expr_recon_loss: 10237582.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22252.7581; train_chrom_access_recon_loss: 3711531.1832; train_global_loss: 16672438.4504; train_optim_loss: 16672438.4504; val_kl_reg_loss: 51290.8435; val_edge_recon_loss: 2644506.1167; val_gene_expr_recon_loss: 10434802.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22193.4902; val_chrom_access_recon_loss: 3779896.7333; val_global_loss: 16932689.4667; val_optim_loss: 16932689.4667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9818; val_auprc_score: 0.9782; val_best_acc_score: 0.9403; val_best_f1_score: 0.9419; train_kl_reg_loss: 51038.3234; train_edge_recon_loss: 2646702.9485; train_gene_expr_recon_loss: 10225111.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22116.2897; train_chrom_access_recon_loss: 3707396.6889; train_global_loss: 16652365.3817; train_optim_loss: 16652365.3817; val_kl_reg_loss: 51086.5268; val_edge_recon_loss: 2669860.4000; val_gene_expr_recon_loss: 10378993.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22030.7090; val_chrom_access_recon_loss: 3772934.5667; val_global_loss: 16894905.8000; val_optim_loss: 16894905.8000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9804; val_auprc_score: 0.9732; val_best_acc_score: 0.9399; val_best_f1_score: 0.9416; train_kl_reg_loss: 50994.2498; train_edge_recon_loss: 2652089.4275; train_gene_expr_recon_loss: 10221433.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21986.2355; train_chrom_access_recon_loss: 3706608.9046; train_global_loss: 16653112.8092; train_optim_loss: 16653112.8092; val_kl_reg_loss: 51612.2042; val_edge_recon_loss: 2678771.2833; val_gene_expr_recon_loss: 10387424.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21940.2715; val_chrom_access_recon_loss: 3769778.9667; val_global_loss: 16909527.3333; val_optim_loss: 16909527.3333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9853; val_auprc_score: 0.9813; val_best_acc_score: 0.9469; val_best_f1_score: 0.9480; train_kl_reg_loss: 50986.6167; train_edge_recon_loss: 2648224.2290; train_gene_expr_recon_loss: 10215855.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21912.5225; train_chrom_access_recon_loss: 3705160.5859; train_global_loss: 16642139.7099; train_optim_loss: 16642139.7099; val_kl_reg_loss: 51369.7458; val_edge_recon_loss: 2633270.7333; val_gene_expr_recon_loss: 10429025.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21880.2344; val_chrom_access_recon_loss: 3789214.7500; val_global_loss: 16924760.8667; val_optim_loss: 16924760.8667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9827; val_auprc_score: 0.9773; val_best_acc_score: 0.9410; val_best_f1_score: 0.9431; train_kl_reg_loss: 50903.0276; train_edge_recon_loss: 2649234.6336; train_gene_expr_recon_loss: 10217632.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21844.9240; train_chrom_access_recon_loss: 3705905.6508; train_global_loss: 16645520.8397; train_optim_loss: 16645520.8397; val_kl_reg_loss: 51152.9159; val_edge_recon_loss: 2663086.2333; val_gene_expr_recon_loss: 10417173.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21836.8555; val_chrom_access_recon_loss: 3795101.8333; val_global_loss: 16948351.4667; val_optim_loss: 16948351.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9819; val_auprc_score: 0.9741; val_best_acc_score: 0.9415; val_best_f1_score: 0.9431; train_kl_reg_loss: 51026.9186; train_edge_recon_loss: 2639747.5859; train_gene_expr_recon_loss: 10212008.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21791.7128; train_chrom_access_recon_loss: 3701206.7233; train_global_loss: 16625781.0916; train_optim_loss: 16625781.0916; val_kl_reg_loss: 51178.8870; val_edge_recon_loss: 2664284.4500; val_gene_expr_recon_loss: 10397077.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21754.5312; val_chrom_access_recon_loss: 3782382.0833; val_global_loss: 16916677.6667; val_optim_loss: 16916677.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9845; val_auprc_score: 0.9785; val_best_acc_score: 0.9475; val_best_f1_score: 0.9482; train_kl_reg_loss: 51117.9520; train_edge_recon_loss: 2646892.1393; train_gene_expr_recon_loss: 10210413.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21283.7081; train_chrom_access_recon_loss: 3698812.7634; train_global_loss: 16628520.4809; train_optim_loss: 16628520.4809; val_kl_reg_loss: 51243.5576; val_edge_recon_loss: 2641781.2500; val_gene_expr_recon_loss: 10413383.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21189.3672; val_chrom_access_recon_loss: 3775189.9167; val_global_loss: 16902787.6667; val_optim_loss: 16902787.6667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9819; val_auprc_score: 0.9779; val_best_acc_score: 0.9413; val_best_f1_score: 0.9428; train_kl_reg_loss: 50998.5475; train_edge_recon_loss: 2643288.1050; train_gene_expr_recon_loss: 10201294.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21168.6693; train_chrom_access_recon_loss: 3695444.2901; train_global_loss: 16612193.7863; train_optim_loss: 16612193.7863; val_kl_reg_loss: 51144.2740; val_edge_recon_loss: 2662533.9167; val_gene_expr_recon_loss: 10444863.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21156.3867; val_chrom_access_recon_loss: 3801856.3500; val_global_loss: 16981554.0000; val_optim_loss: 16981554.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9811; val_auprc_score: 0.9735; val_best_acc_score: 0.9390; val_best_f1_score: 0.9408; train_kl_reg_loss: 51180.6418; train_edge_recon_loss: 2647655.9141; train_gene_expr_recon_loss: 10214110.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21144.6050; train_chrom_access_recon_loss: 3699232.4656; train_global_loss: 16633324.2137; train_optim_loss: 16633324.2137; val_kl_reg_loss: 51099.5807; val_edge_recon_loss: 2678343.8500; val_gene_expr_recon_loss: 10414963.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21137.6367; val_chrom_access_recon_loss: 3791831.8667; val_global_loss: 16957376.6667; val_optim_loss: 16957376.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9810; val_auprc_score: 0.9757; val_best_acc_score: 0.9402; val_best_f1_score: 0.9420; train_kl_reg_loss: 51086.9783; train_edge_recon_loss: 2647412.1240; train_gene_expr_recon_loss: 10211587.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21129.8742; train_chrom_access_recon_loss: 3699883.1756; train_global_loss: 16631099.4733; train_optim_loss: 16631099.4733; val_kl_reg_loss: 51011.3758; val_edge_recon_loss: 2657868.2333; val_gene_expr_recon_loss: 10387249.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21123.2344; val_chrom_access_recon_loss: 3761970.7333; val_global_loss: 16879223.3333; val_optim_loss: 16879223.3333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9827; val_auprc_score: 0.9773; val_best_acc_score: 0.9440; val_best_f1_score: 0.9448; train_kl_reg_loss: 51062.5557; train_edge_recon_loss: 2648197.8874; train_gene_expr_recon_loss: 10207044.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21116.4267; train_chrom_access_recon_loss: 3697113.0401; train_global_loss: 16624534.0229; train_optim_loss: 16624534.0229; val_kl_reg_loss: 51291.3398; val_edge_recon_loss: 2670789.5167; val_gene_expr_recon_loss: 10429103.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21112.8887; val_chrom_access_recon_loss: 3783082.4000; val_global_loss: 16955380.1333; val_optim_loss: 16955380.1333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9806; val_auprc_score: 0.9736; val_best_acc_score: 0.9386; val_best_f1_score: 0.9404; train_kl_reg_loss: 51206.8839; train_edge_recon_loss: 2648711.4141; train_gene_expr_recon_loss: 10207905.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21104.7506; train_chrom_access_recon_loss: 3697682.3893; train_global_loss: 16626611.2977; train_optim_loss: 16626611.2977; val_kl_reg_loss: 51038.4456; val_edge_recon_loss: 2665452.7667; val_gene_expr_recon_loss: 10365184.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21099.3848; val_chrom_access_recon_loss: 3758998.7500; val_global_loss: 16861773.8000; val_optim_loss: 16861773.8000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9827; val_auprc_score: 0.9781; val_best_acc_score: 0.9415; val_best_f1_score: 0.9431; train_kl_reg_loss: 51174.9351; train_edge_recon_loss: 2642318.6107; train_gene_expr_recon_loss: 10209356.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21093.7804; train_chrom_access_recon_loss: 3698556.1279; train_global_loss: 16622500.4351; train_optim_loss: 16622500.4351; val_kl_reg_loss: 51315.2880; val_edge_recon_loss: 2649830.6667; val_gene_expr_recon_loss: 10418386.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21089.9062; val_chrom_access_recon_loss: 3802937.4000; val_global_loss: 16943559.7333; val_optim_loss: 16943559.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9817; val_auprc_score: 0.9756; val_best_acc_score: 0.9398; val_best_f1_score: 0.9419; train_kl_reg_loss: 51188.4740; train_edge_recon_loss: 2648126.5000; train_gene_expr_recon_loss: 10211692.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21084.1907; train_chrom_access_recon_loss: 3699587.3492; train_global_loss: 16631679.4275; train_optim_loss: 16631679.4275; val_kl_reg_loss: 51186.6159; val_edge_recon_loss: 2658718.6500; val_gene_expr_recon_loss: 10401876.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21079.5664; val_chrom_access_recon_loss: 3790059.4333; val_global_loss: 16922921.6667; val_optim_loss: 16922921.6667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9829; val_auprc_score: 0.9763; val_best_acc_score: 0.9458; val_best_f1_score: 0.9472; train_kl_reg_loss: 51157.5327; train_edge_recon_loss: 2647240.6966; train_gene_expr_recon_loss: 10205877.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21074.6140; train_chrom_access_recon_loss: 3699616.4008; train_global_loss: 16624966.8550; train_optim_loss: 16624966.8550; val_kl_reg_loss: 51311.8812; val_edge_recon_loss: 2656811.6167; val_gene_expr_recon_loss: 10394779.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21070.5762; val_chrom_access_recon_loss: 3775137.7000; val_global_loss: 16899111.6000; val_optim_loss: 16899111.6000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9838; val_auprc_score: 0.9802; val_best_acc_score: 0.9417; val_best_f1_score: 0.9432; train_kl_reg_loss: 51084.7561; train_edge_recon_loss: 2646696.4943; train_gene_expr_recon_loss: 10205977.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21064.1608; train_chrom_access_recon_loss: 3697322.6851; train_global_loss: 16622145.4046; train_optim_loss: 16622145.4046; val_kl_reg_loss: 51091.5406; val_edge_recon_loss: 2658773.5667; val_gene_expr_recon_loss: 10420504.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21062.5430; val_chrom_access_recon_loss: 3784361.0000; val_global_loss: 16935793.2000; val_optim_loss: 16935793.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9816; val_auprc_score: 0.9741; val_best_acc_score: 0.9446; val_best_f1_score: 0.9461; train_kl_reg_loss: 51095.5226; train_edge_recon_loss: 2641372.4103; train_gene_expr_recon_loss: 10211787.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21013.7899; train_chrom_access_recon_loss: 3698727.6031; train_global_loss: 16623996.9695; train_optim_loss: 16623996.9695; val_kl_reg_loss: 51192.7398; val_edge_recon_loss: 2633675.5333; val_gene_expr_recon_loss: 10410199.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21003.6406; val_chrom_access_recon_loss: 3795375.6000; val_global_loss: 16911447.0000; val_optim_loss: 16911447.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9810; val_auprc_score: 0.9769; val_best_acc_score: 0.9388; val_best_f1_score: 0.9410; train_kl_reg_loss: 51121.9671; train_edge_recon_loss: 2645974.0973; train_gene_expr_recon_loss: 10210310.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21001.7750; train_chrom_access_recon_loss: 3697241.5954; train_global_loss: 16625649.5115; train_optim_loss: 16625649.5115; val_kl_reg_loss: 50973.7458; val_edge_recon_loss: 2666673.8833; val_gene_expr_recon_loss: 10429096.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21000.6406; val_chrom_access_recon_loss: 3784791.8000; val_global_loss: 16952537.2000; val_optim_loss: 16952537.2000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9825; val_auprc_score: 0.9780; val_best_acc_score: 0.9429; val_best_f1_score: 0.9445; train_kl_reg_loss: 51053.4984; train_edge_recon_loss: 2644519.0267; train_gene_expr_recon_loss: 10206996.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20999.7269; train_chrom_access_recon_loss: 3697383.1260; train_global_loss: 16620952.3282; train_optim_loss: 16620952.3282; val_kl_reg_loss: 50908.1904; val_edge_recon_loss: 2652209.9667; val_gene_expr_recon_loss: 10420482.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20998.7969; val_chrom_access_recon_loss: 3788352.9500; val_global_loss: 16932952.6000; val_optim_loss: 16932952.6000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9811; val_auprc_score: 0.9767; val_best_acc_score: 0.9383; val_best_f1_score: 0.9401; train_kl_reg_loss: 51110.2530; train_edge_recon_loss: 2653114.0134; train_gene_expr_recon_loss: 10208319.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20997.9106; train_chrom_access_recon_loss: 3696951.4695; train_global_loss: 16630492.8015; train_optim_loss: 16630492.8015; val_kl_reg_loss: 51079.2945; val_edge_recon_loss: 2661953.9000; val_gene_expr_recon_loss: 10391977.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20997.3203; val_chrom_access_recon_loss: 3784979.7667; val_global_loss: 16910987.2667; val_optim_loss: 16910987.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 63 min 4 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9827
val AUPRC score: 0.9794
val best accuracy score: 0.9411
val best F1 score: 0.9426
val target rna MSE score: 1.1879
val source rna MSE score: 0.2130
val target atac MSE score: 0.4994
val source atac MSE score: 0.0733
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
