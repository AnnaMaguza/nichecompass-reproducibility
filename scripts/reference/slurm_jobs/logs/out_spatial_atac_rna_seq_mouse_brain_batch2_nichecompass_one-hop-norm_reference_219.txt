[True]
Run timestamp: 10102023_094213_219.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_219']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6835; val_auprc_score: 0.6555; val_best_acc_score: 0.5021; val_best_f1_score: 0.6676; train_kl_reg_loss: 62847.7578; train_edge_recon_loss: 743983.0095; train_gene_expr_recon_loss: 23119307.7576; train_masked_gp_l1_reg_loss: 61601.2992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6061272.6364; train_chrom_access_recon_loss: 2950363.0076; train_global_loss: 32999375.2424; train_optim_loss: 32999375.2424; val_kl_reg_loss: 94787.8965; val_edge_recon_loss: 813042.4141; val_gene_expr_recon_loss: 21281031.7500; val_masked_gp_l1_reg_loss: 66886.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3340544.0000; val_chrom_access_recon_loss: 2825687.5000; val_global_loss: 28421979.2500; val_optim_loss: 28421979.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6986; val_auprc_score: 0.6769; val_best_acc_score: 0.5905; val_best_f1_score: 0.6965; train_kl_reg_loss: 88970.3131; train_edge_recon_loss: 746789.6278; train_gene_expr_recon_loss: 21248723.2121; train_masked_gp_l1_reg_loss: 65949.0734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1803216.1600; train_chrom_access_recon_loss: 2824918.6477; train_global_loss: 26778567.1515; train_optim_loss: 26778567.1515; val_kl_reg_loss: 82980.4561; val_edge_recon_loss: 811948.3750; val_gene_expr_recon_loss: 21152052.0000; val_masked_gp_l1_reg_loss: 65558.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 854031.1250; val_chrom_access_recon_loss: 2794758.4375; val_global_loss: 25761329.0000; val_optim_loss: 25761329.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7750; val_auprc_score: 0.7641; val_best_acc_score: 0.7058; val_best_f1_score: 0.7127; train_kl_reg_loss: 79294.2126; train_edge_recon_loss: 736385.1250; train_gene_expr_recon_loss: 21038024.5758; train_masked_gp_l1_reg_loss: 65615.7556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 559396.2983; train_chrom_access_recon_loss: 2806109.0833; train_global_loss: 25284825.0606; train_optim_loss: 25284825.0606; val_kl_reg_loss: 76049.0264; val_edge_recon_loss: 804403.8828; val_gene_expr_recon_loss: 21114482.5000; val_masked_gp_l1_reg_loss: 65998.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 371463.9375; val_chrom_access_recon_loss: 2828815.9062; val_global_loss: 25261213.2500; val_optim_loss: 25261213.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8315; val_auprc_score: 0.8171; val_best_acc_score: 0.7536; val_best_f1_score: 0.7664; train_kl_reg_loss: 71198.2272; train_edge_recon_loss: 726103.6364; train_gene_expr_recon_loss: 20896937.7879; train_masked_gp_l1_reg_loss: 66956.8029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 292263.6245; train_chrom_access_recon_loss: 2792650.5265; train_global_loss: 24846110.2424; train_optim_loss: 24846110.2424; val_kl_reg_loss: 70815.9189; val_edge_recon_loss: 776133.1172; val_gene_expr_recon_loss: 20782862.5000; val_masked_gp_l1_reg_loss: 68258.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 234292.0156; val_chrom_access_recon_loss: 2798950.2188; val_global_loss: 24731311.2500; val_optim_loss: 24731311.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8737; val_auprc_score: 0.8539; val_best_acc_score: 0.8006; val_best_f1_score: 0.8152; train_kl_reg_loss: 67567.5094; train_edge_recon_loss: 703253.5095; train_gene_expr_recon_loss: 20752185.6061; train_masked_gp_l1_reg_loss: 69300.6703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 205494.5545; train_chrom_access_recon_loss: 2773942.3712; train_global_loss: 24571744.3939; train_optim_loss: 24571744.3939; val_kl_reg_loss: 66958.4526; val_edge_recon_loss: 701576.9297; val_gene_expr_recon_loss: 20620593.5000; val_masked_gp_l1_reg_loss: 70472.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 184683.9219; val_chrom_access_recon_loss: 2760844.9688; val_global_loss: 24405130.0000; val_optim_loss: 24405130.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8776; val_auprc_score: 0.8488; val_best_acc_score: 0.8044; val_best_f1_score: 0.8220; train_kl_reg_loss: 75688.1728; train_edge_recon_loss: 650686.7917; train_gene_expr_recon_loss: 20598031.1818; train_masked_gp_l1_reg_loss: 71820.2563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 174023.0902; train_chrom_access_recon_loss: 2757614.8447; train_global_loss: 24327864.5758; train_optim_loss: 24327864.5758; val_kl_reg_loss: 78323.7412; val_edge_recon_loss: 641361.2266; val_gene_expr_recon_loss: 20545918.5000; val_masked_gp_l1_reg_loss: 73387.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166466.0938; val_chrom_access_recon_loss: 2759487.3750; val_global_loss: 24264945.2500; val_optim_loss: 24264945.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8839; val_auprc_score: 0.8413; val_best_acc_score: 0.8176; val_best_f1_score: 0.8358; train_kl_reg_loss: 80604.6780; train_edge_recon_loss: 624874.6970; train_gene_expr_recon_loss: 20461687.3333; train_masked_gp_l1_reg_loss: 74621.1120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156417.0208; train_chrom_access_recon_loss: 2744004.1932; train_global_loss: 24142208.8485; train_optim_loss: 24142208.8485; val_kl_reg_loss: 79025.1084; val_edge_recon_loss: 633128.5859; val_gene_expr_recon_loss: 20357092.0000; val_masked_gp_l1_reg_loss: 75641.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148577.3594; val_chrom_access_recon_loss: 2765475.2188; val_global_loss: 24058941.0000; val_optim_loss: 24058941.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9032; val_auprc_score: 0.8752; val_best_acc_score: 0.8369; val_best_f1_score: 0.8508; train_kl_reg_loss: 78972.5688; train_edge_recon_loss: 618869.3201; train_gene_expr_recon_loss: 20398987.3333; train_masked_gp_l1_reg_loss: 76599.2156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141047.7763; train_chrom_access_recon_loss: 2735294.2424; train_global_loss: 24049770.3636; train_optim_loss: 24049770.3636; val_kl_reg_loss: 76639.0332; val_edge_recon_loss: 620335.4297; val_gene_expr_recon_loss: 20368592.7500; val_masked_gp_l1_reg_loss: 77393.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135531.0000; val_chrom_access_recon_loss: 2744700.8438; val_global_loss: 24023192.5000; val_optim_loss: 24023192.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9052; val_auprc_score: 0.8742; val_best_acc_score: 0.8377; val_best_f1_score: 0.8508; train_kl_reg_loss: 77804.3554; train_edge_recon_loss: 612146.6477; train_gene_expr_recon_loss: 20300323.9394; train_masked_gp_l1_reg_loss: 78060.1847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131011.0181; train_chrom_access_recon_loss: 2724054.9205; train_global_loss: 23923401.3333; train_optim_loss: 23923401.3333; val_kl_reg_loss: 77176.2051; val_edge_recon_loss: 612334.7578; val_gene_expr_recon_loss: 20300298.7500; val_masked_gp_l1_reg_loss: 78746.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126806.6641; val_chrom_access_recon_loss: 2742464.9375; val_global_loss: 23937826.5000; val_optim_loss: 23937826.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9057; val_auprc_score: 0.8767; val_best_acc_score: 0.8388; val_best_f1_score: 0.8507; train_kl_reg_loss: 75872.5212; train_edge_recon_loss: 608213.8305; train_gene_expr_recon_loss: 20207484.7879; train_masked_gp_l1_reg_loss: 79318.4920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124374.3954; train_chrom_access_recon_loss: 2713960.8485; train_global_loss: 23809224.8788; train_optim_loss: 23809224.8788; val_kl_reg_loss: 75319.2725; val_edge_recon_loss: 611835.0312; val_gene_expr_recon_loss: 20137332.0000; val_masked_gp_l1_reg_loss: 79897.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123104.2969; val_chrom_access_recon_loss: 2720369.2500; val_global_loss: 23747857.7500; val_optim_loss: 23747857.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9140; val_auprc_score: 0.8890; val_best_acc_score: 0.8420; val_best_f1_score: 0.8525; train_kl_reg_loss: 74127.1364; train_edge_recon_loss: 606420.0994; train_gene_expr_recon_loss: 20156666.2121; train_masked_gp_l1_reg_loss: 80435.9446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120637.0507; train_chrom_access_recon_loss: 2705848.4470; train_global_loss: 23744134.8788; train_optim_loss: 23744134.8788; val_kl_reg_loss: 74688.5615; val_edge_recon_loss: 614233.3359; val_gene_expr_recon_loss: 20211998.0000; val_masked_gp_l1_reg_loss: 81097.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119493.2812; val_chrom_access_recon_loss: 2727976.9062; val_global_loss: 23829488.7500; val_optim_loss: 23829488.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9011; val_auprc_score: 0.8714; val_best_acc_score: 0.8393; val_best_f1_score: 0.8513; train_kl_reg_loss: 73041.9692; train_edge_recon_loss: 605152.4176; train_gene_expr_recon_loss: 20067278.7879; train_masked_gp_l1_reg_loss: 81427.3658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117072.2448; train_chrom_access_recon_loss: 2695326.6591; train_global_loss: 23639299.3030; train_optim_loss: 23639299.3030; val_kl_reg_loss: 70977.9238; val_edge_recon_loss: 609745.5859; val_gene_expr_recon_loss: 19917705.5000; val_masked_gp_l1_reg_loss: 81814.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115478.3672; val_chrom_access_recon_loss: 2704192.5625; val_global_loss: 23499913.2500; val_optim_loss: 23499913.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9226; val_auprc_score: 0.9032; val_best_acc_score: 0.8565; val_best_f1_score: 0.8632; train_kl_reg_loss: 70896.5140; train_edge_recon_loss: 603996.0805; train_gene_expr_recon_loss: 19991432.3636; train_masked_gp_l1_reg_loss: 82298.9190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113966.6907; train_chrom_access_recon_loss: 2685646.0492; train_global_loss: 23548236.6061; train_optim_loss: 23548236.6061; val_kl_reg_loss: 71047.5508; val_edge_recon_loss: 607438.8281; val_gene_expr_recon_loss: 19928217.5000; val_masked_gp_l1_reg_loss: 82722.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112679.3047; val_chrom_access_recon_loss: 2665594.5312; val_global_loss: 23467701.0000; val_optim_loss: 23467701.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9094; val_auprc_score: 0.8779; val_best_acc_score: 0.8479; val_best_f1_score: 0.8594; train_kl_reg_loss: 70924.7592; train_edge_recon_loss: 599584.2775; train_gene_expr_recon_loss: 19931565.5152; train_masked_gp_l1_reg_loss: 83194.1845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111149.3806; train_chrom_access_recon_loss: 2678782.1250; train_global_loss: 23475200.5152; train_optim_loss: 23475200.5152; val_kl_reg_loss: 69728.4414; val_edge_recon_loss: 608610.8750; val_gene_expr_recon_loss: 19729377.5000; val_masked_gp_l1_reg_loss: 83609.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110044.4375; val_chrom_access_recon_loss: 2656772.8438; val_global_loss: 23258143.2500; val_optim_loss: 23258143.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9297; val_auprc_score: 0.9054; val_best_acc_score: 0.8675; val_best_f1_score: 0.8744; train_kl_reg_loss: 69500.1987; train_edge_recon_loss: 598547.0294; train_gene_expr_recon_loss: 19866633.0303; train_masked_gp_l1_reg_loss: 83894.3911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108314.0559; train_chrom_access_recon_loss: 2668953.9015; train_global_loss: 23395842.7273; train_optim_loss: 23395842.7273; val_kl_reg_loss: 69176.0566; val_edge_recon_loss: 596663.8672; val_gene_expr_recon_loss: 19774872.5000; val_masked_gp_l1_reg_loss: 84382.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108310.6719; val_chrom_access_recon_loss: 2690326.9062; val_global_loss: 23323731.2500; val_optim_loss: 23323731.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9328; val_auprc_score: 0.9163; val_best_acc_score: 0.8611; val_best_f1_score: 0.8694; train_kl_reg_loss: 69542.2165; train_edge_recon_loss: 594813.7169; train_gene_expr_recon_loss: 19821958.0000; train_masked_gp_l1_reg_loss: 84618.5605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106441.3013; train_chrom_access_recon_loss: 2663906.1780; train_global_loss: 23341279.7576; train_optim_loss: 23341279.7576; val_kl_reg_loss: 70447.5771; val_edge_recon_loss: 603221.7891; val_gene_expr_recon_loss: 19819169.7500; val_masked_gp_l1_reg_loss: 84954.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105673.1953; val_chrom_access_recon_loss: 2676336.7188; val_global_loss: 23359804.2500; val_optim_loss: 23359804.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9353; val_auprc_score: 0.9126; val_best_acc_score: 0.8729; val_best_f1_score: 0.8794; train_kl_reg_loss: 68228.6623; train_edge_recon_loss: 596137.4205; train_gene_expr_recon_loss: 19750946.1212; train_masked_gp_l1_reg_loss: 85313.2060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104389.9251; train_chrom_access_recon_loss: 2654171.2614; train_global_loss: 23259186.6970; train_optim_loss: 23259186.6970; val_kl_reg_loss: 68392.6299; val_edge_recon_loss: 597193.3906; val_gene_expr_recon_loss: 19852957.0000; val_masked_gp_l1_reg_loss: 85537.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103273.2734; val_chrom_access_recon_loss: 2697654.1562; val_global_loss: 23405009.5000; val_optim_loss: 23405009.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9291; val_auprc_score: 0.8963; val_best_acc_score: 0.8692; val_best_f1_score: 0.8754; train_kl_reg_loss: 67626.2065; train_edge_recon_loss: 592734.6174; train_gene_expr_recon_loss: 19716296.0909; train_masked_gp_l1_reg_loss: 85941.4964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102884.3094; train_chrom_access_recon_loss: 2648593.5417; train_global_loss: 23214076.4848; train_optim_loss: 23214076.4848; val_kl_reg_loss: 67060.0273; val_edge_recon_loss: 599295.4141; val_gene_expr_recon_loss: 19773492.7500; val_masked_gp_l1_reg_loss: 86365.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101666.8047; val_chrom_access_recon_loss: 2689123.9062; val_global_loss: 23317004.2500; val_optim_loss: 23317004.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9376; val_auprc_score: 0.9131; val_best_acc_score: 0.8759; val_best_f1_score: 0.8838; train_kl_reg_loss: 67611.6884; train_edge_recon_loss: 591138.1354; train_gene_expr_recon_loss: 19655937.1515; train_masked_gp_l1_reg_loss: 85348.3640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76683.5874; train_chrom_access_recon_loss: 2639821.1553; train_global_loss: 23116539.9394; train_optim_loss: 23116539.9394; val_kl_reg_loss: 68559.6992; val_edge_recon_loss: 593998.0234; val_gene_expr_recon_loss: 19633661.7500; val_masked_gp_l1_reg_loss: 84817.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69869.5078; val_chrom_access_recon_loss: 2660582.2188; val_global_loss: 23111489.5000; val_optim_loss: 23111489.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9350; val_auprc_score: 0.9137; val_best_acc_score: 0.8718; val_best_f1_score: 0.8807; train_kl_reg_loss: 68400.2352; train_edge_recon_loss: 590627.6970; train_gene_expr_recon_loss: 19652115.3636; train_masked_gp_l1_reg_loss: 84720.9768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68972.6057; train_chrom_access_recon_loss: 2637091.5000; train_global_loss: 23101928.3939; train_optim_loss: 23101928.3939; val_kl_reg_loss: 68940.8701; val_edge_recon_loss: 596733.3828; val_gene_expr_recon_loss: 19675392.5000; val_masked_gp_l1_reg_loss: 84673.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68301.7188; val_chrom_access_recon_loss: 2661605.0938; val_global_loss: 23155647.7500; val_optim_loss: 23155647.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9364; val_auprc_score: 0.9188; val_best_acc_score: 0.8657; val_best_f1_score: 0.8744; train_kl_reg_loss: 68815.9622; train_edge_recon_loss: 590708.4545; train_gene_expr_recon_loss: 19648380.2727; train_masked_gp_l1_reg_loss: 84630.9947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67944.8087; train_chrom_access_recon_loss: 2635245.8674; train_global_loss: 23095726.3030; train_optim_loss: 23095726.3030; val_kl_reg_loss: 69529.9424; val_edge_recon_loss: 598492.7891; val_gene_expr_recon_loss: 19678071.7500; val_masked_gp_l1_reg_loss: 84621.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67603.0781; val_chrom_access_recon_loss: 2663805.2812; val_global_loss: 23162125.2500; val_optim_loss: 23162125.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9426; val_auprc_score: 0.9243; val_best_acc_score: 0.8823; val_best_f1_score: 0.8901; train_kl_reg_loss: 68957.5871; train_edge_recon_loss: 591629.4773; train_gene_expr_recon_loss: 19653275.1818; train_masked_gp_l1_reg_loss: 84629.9205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67295.7978; train_chrom_access_recon_loss: 2637901.5303; train_global_loss: 23103689.3939; train_optim_loss: 23103689.3939; val_kl_reg_loss: 69616.9707; val_edge_recon_loss: 590748.2891; val_gene_expr_recon_loss: 19727001.0000; val_masked_gp_l1_reg_loss: 84642.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67030.2734; val_chrom_access_recon_loss: 2661803.3750; val_global_loss: 23200841.2500; val_optim_loss: 23200841.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9363; val_auprc_score: 0.9129; val_best_acc_score: 0.8751; val_best_f1_score: 0.8820; train_kl_reg_loss: 68887.3919; train_edge_recon_loss: 590848.7500; train_gene_expr_recon_loss: 19643030.4545; train_masked_gp_l1_reg_loss: 84651.8196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66792.3883; train_chrom_access_recon_loss: 2634306.5000; train_global_loss: 23088517.0909; train_optim_loss: 23088517.0909; val_kl_reg_loss: 69866.4922; val_edge_recon_loss: 590515.6406; val_gene_expr_recon_loss: 19626779.2500; val_masked_gp_l1_reg_loss: 84665.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66575.1641; val_chrom_access_recon_loss: 2642804.5625; val_global_loss: 23081207.7500; val_optim_loss: 23081207.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9414; val_auprc_score: 0.9250; val_best_acc_score: 0.8748; val_best_f1_score: 0.8823; train_kl_reg_loss: 69221.6645; train_edge_recon_loss: 590408.9678; train_gene_expr_recon_loss: 19630168.9697; train_masked_gp_l1_reg_loss: 84679.3567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66316.0508; train_chrom_access_recon_loss: 2631639.1667; train_global_loss: 23072434.1212; train_optim_loss: 23072434.1212; val_kl_reg_loss: 69864.7900; val_edge_recon_loss: 594572.2109; val_gene_expr_recon_loss: 19656663.2500; val_masked_gp_l1_reg_loss: 84694.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66083.4922; val_chrom_access_recon_loss: 2672788.0000; val_global_loss: 23144666.0000; val_optim_loss: 23144666.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9303; val_auprc_score: 0.9049; val_best_acc_score: 0.8702; val_best_f1_score: 0.8769; train_kl_reg_loss: 69040.7080; train_edge_recon_loss: 591568.4659; train_gene_expr_recon_loss: 19636285.8485; train_masked_gp_l1_reg_loss: 84712.6677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65890.9152; train_chrom_access_recon_loss: 2632989.5644; train_global_loss: 23080488.1515; train_optim_loss: 23080488.1515; val_kl_reg_loss: 69851.7773; val_edge_recon_loss: 599636.3047; val_gene_expr_recon_loss: 19694230.5000; val_masked_gp_l1_reg_loss: 84734.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65670.5469; val_chrom_access_recon_loss: 2646046.0312; val_global_loss: 23160168.7500; val_optim_loss: 23160168.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9390; val_auprc_score: 0.9260; val_best_acc_score: 0.8665; val_best_f1_score: 0.8736; train_kl_reg_loss: 62826.4024; train_edge_recon_loss: 712861.2131; train_gene_expr_recon_loss: 18365051.7273; train_masked_gp_l1_reg_loss: 84553.1752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65069.6776; train_chrom_access_recon_loss: 2635341.9015; train_global_loss: 21925704.1818; train_optim_loss: 21925704.1818; val_kl_reg_loss: 34427.2417; val_edge_recon_loss: 733968.7734; val_gene_expr_recon_loss: 18277566.7500; val_masked_gp_l1_reg_loss: 84442.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65926.6875; val_chrom_access_recon_loss: 2529874.6562; val_global_loss: 21726205.2500; val_optim_loss: 21726205.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9299; val_auprc_score: 0.9145; val_best_acc_score: 0.8598; val_best_f1_score: 0.8670; train_kl_reg_loss: 62125.9139; train_edge_recon_loss: 698546.8144; train_gene_expr_recon_loss: 18293430.8788; train_masked_gp_l1_reg_loss: 84241.7547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66605.4938; train_chrom_access_recon_loss: 2503866.7273; train_global_loss: 21708817.6364; train_optim_loss: 21708817.6364; val_kl_reg_loss: 32783.9688; val_edge_recon_loss: 728635.2734; val_gene_expr_recon_loss: 18231851.5000; val_masked_gp_l1_reg_loss: 84006.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66982.5078; val_chrom_access_recon_loss: 2503158.2500; val_global_loss: 21647417.0000; val_optim_loss: 21647417.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9329; val_auprc_score: 0.9181; val_best_acc_score: 0.8667; val_best_f1_score: 0.8722; train_kl_reg_loss: 59597.5004; train_edge_recon_loss: 693837.4280; train_gene_expr_recon_loss: 18268003.6667; train_masked_gp_l1_reg_loss: 83738.2365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67070.2272; train_chrom_access_recon_loss: 2486739.1894; train_global_loss: 21658986.0606; train_optim_loss: 21658986.0606; val_kl_reg_loss: 33435.2637; val_edge_recon_loss: 724005.4531; val_gene_expr_recon_loss: 18296010.7500; val_masked_gp_l1_reg_loss: 83487.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67089.3672; val_chrom_access_recon_loss: 2475395.0938; val_global_loss: 21679424.2500; val_optim_loss: 21679424.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9345; val_auprc_score: 0.9194; val_best_acc_score: 0.8627; val_best_f1_score: 0.8686; train_kl_reg_loss: 58590.1025; train_edge_recon_loss: 689258.9631; train_gene_expr_recon_loss: 18266772.9394; train_masked_gp_l1_reg_loss: 83255.2925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66925.3304; train_chrom_access_recon_loss: 2480740.4811; train_global_loss: 21645543.0000; train_optim_loss: 21645543.0000; val_kl_reg_loss: 32240.0068; val_edge_recon_loss: 712471.8281; val_gene_expr_recon_loss: 17965214.6250; val_masked_gp_l1_reg_loss: 82993.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66656.5547; val_chrom_access_recon_loss: 2464407.7812; val_global_loss: 21323984.7500; val_optim_loss: 21323984.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9358; val_auprc_score: 0.9132; val_best_acc_score: 0.8726; val_best_f1_score: 0.8786; train_kl_reg_loss: 58007.7504; train_edge_recon_loss: 684393.0881; train_gene_expr_recon_loss: 18266852.0606; train_masked_gp_l1_reg_loss: 82742.7869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66345.8662; train_chrom_access_recon_loss: 2476838.5720; train_global_loss: 21635179.9697; train_optim_loss: 21635179.9697; val_kl_reg_loss: 31317.5601; val_edge_recon_loss: 702151.9219; val_gene_expr_recon_loss: 18399456.5000; val_masked_gp_l1_reg_loss: 82502.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65997.8125; val_chrom_access_recon_loss: 2512218.3438; val_global_loss: 21793644.2500; val_optim_loss: 21793644.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9324; val_auprc_score: 0.9169; val_best_acc_score: 0.8624; val_best_f1_score: 0.8697; train_kl_reg_loss: 56838.2233; train_edge_recon_loss: 680405.8343; train_gene_expr_recon_loss: 18235812.0909; train_masked_gp_l1_reg_loss: 82275.2095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65613.9641; train_chrom_access_recon_loss: 2471738.4924; train_global_loss: 21592683.9091; train_optim_loss: 21592683.9091; val_kl_reg_loss: 31779.7600; val_edge_recon_loss: 699123.6875; val_gene_expr_recon_loss: 18224512.5000; val_masked_gp_l1_reg_loss: 82047.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65230.1016; val_chrom_access_recon_loss: 2466748.7188; val_global_loss: 21569443.0000; val_optim_loss: 21569443.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9380; val_auprc_score: 0.9187; val_best_acc_score: 0.8659; val_best_f1_score: 0.8745; train_kl_reg_loss: 55986.5904; train_edge_recon_loss: 676346.0653; train_gene_expr_recon_loss: 18237517.0909; train_masked_gp_l1_reg_loss: 81833.0584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64871.9209; train_chrom_access_recon_loss: 2471649.0417; train_global_loss: 21588203.9091; train_optim_loss: 21588203.9091; val_kl_reg_loss: 31333.6787; val_edge_recon_loss: 688764.3750; val_gene_expr_recon_loss: 18336895.5000; val_masked_gp_l1_reg_loss: 81638.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64541.9922; val_chrom_access_recon_loss: 2492610.5000; val_global_loss: 21695783.7500; val_optim_loss: 21695783.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9330; val_auprc_score: 0.9155; val_best_acc_score: 0.8649; val_best_f1_score: 0.8753; train_kl_reg_loss: 54823.2182; train_edge_recon_loss: 669579.3920; train_gene_expr_recon_loss: 18242907.0909; train_masked_gp_l1_reg_loss: 81437.8977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64194.6784; train_chrom_access_recon_loss: 2471031.7197; train_global_loss: 21583973.8788; train_optim_loss: 21583973.8788; val_kl_reg_loss: 30844.4905; val_edge_recon_loss: 676950.0391; val_gene_expr_recon_loss: 18393887.5000; val_masked_gp_l1_reg_loss: 81228.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63804.3711; val_chrom_access_recon_loss: 2492611.3438; val_global_loss: 21739325.7500; val_optim_loss: 21739325.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9320; val_auprc_score: 0.9152; val_best_acc_score: 0.8627; val_best_f1_score: 0.8717; train_kl_reg_loss: 54076.9396; train_edge_recon_loss: 666943.4460; train_gene_expr_recon_loss: 18228070.5152; train_masked_gp_l1_reg_loss: 81161.9306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62296.1060; train_chrom_access_recon_loss: 2468478.8144; train_global_loss: 21561027.6364; train_optim_loss: 21561027.6364; val_kl_reg_loss: 30531.1133; val_edge_recon_loss: 680751.4375; val_gene_expr_recon_loss: 18080351.7500; val_masked_gp_l1_reg_loss: 81114.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61929.5820; val_chrom_access_recon_loss: 2466974.1250; val_global_loss: 21401652.5000; val_optim_loss: 21401652.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9350; val_auprc_score: 0.9189; val_best_acc_score: 0.8632; val_best_f1_score: 0.8721; train_kl_reg_loss: 54145.9980; train_edge_recon_loss: 666916.1705; train_gene_expr_recon_loss: 18222243.0606; train_masked_gp_l1_reg_loss: 81086.3073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61836.3163; train_chrom_access_recon_loss: 2468938.3864; train_global_loss: 21555166.1818; train_optim_loss: 21555166.1818; val_kl_reg_loss: 30958.4375; val_edge_recon_loss: 678154.8047; val_gene_expr_recon_loss: 18198517.0000; val_masked_gp_l1_reg_loss: 81056.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61750.7422; val_chrom_access_recon_loss: 2473095.9375; val_global_loss: 21523532.2500; val_optim_loss: 21523532.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9275; val_auprc_score: 0.9071; val_best_acc_score: 0.8611; val_best_f1_score: 0.8694; train_kl_reg_loss: 54121.3668; train_edge_recon_loss: 666613.2188; train_gene_expr_recon_loss: 18229267.7879; train_masked_gp_l1_reg_loss: 81031.5182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61678.6838; train_chrom_access_recon_loss: 2470164.7576; train_global_loss: 21562877.3030; train_optim_loss: 21562877.3030; val_kl_reg_loss: 31004.7542; val_edge_recon_loss: 677583.2031; val_gene_expr_recon_loss: 18232810.2500; val_masked_gp_l1_reg_loss: 81005.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61605.8906; val_chrom_access_recon_loss: 2506183.7500; val_global_loss: 21590194.0000; val_optim_loss: 21590194.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9275; val_auprc_score: 0.9082; val_best_acc_score: 0.8592; val_best_f1_score: 0.8683; train_kl_reg_loss: 54100.0177; train_edge_recon_loss: 664883.4470; train_gene_expr_recon_loss: 18236739.8485; train_masked_gp_l1_reg_loss: 80982.5134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61548.6461; train_chrom_access_recon_loss: 2469801.4053; train_global_loss: 21568056.1515; train_optim_loss: 21568056.1515; val_kl_reg_loss: 30905.5986; val_edge_recon_loss: 678276.3594; val_gene_expr_recon_loss: 18128811.0000; val_masked_gp_l1_reg_loss: 80959.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61488.6953; val_chrom_access_recon_loss: 2446629.2812; val_global_loss: 21427070.0000; val_optim_loss: 21427070.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 16 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9307
val AUPRC score: 0.9074
val best accuracy score: 0.8686
val best F1 score: 0.8764
val target rna MSE score: 1.7972
val source rna MSE score: 0.9431
val target atac MSE score: 0.4813
val source atac MSE score: 0.2049
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
