[True]
Run timestamp: 10082023_182719_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7791; val_auprc_score: 0.7994; val_best_acc_score: 0.6140; val_best_f1_score: 0.7112; train_kl_reg_loss: 184411.2175; train_edge_recon_loss: 3904208.2328; train_gene_expr_recon_loss: 28772910.7939; train_masked_gp_l1_reg_loss: 74602.4934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245000.5011; train_chrom_access_recon_loss: 25936704.0763; train_global_loss: 59117837.5878; train_optim_loss: 59117837.5878; val_kl_reg_loss: 146920.7302; val_edge_recon_loss: 4059147.3167; val_gene_expr_recon_loss: 23427008.2667; val_masked_gp_l1_reg_loss: 71509.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239995.4531; val_chrom_access_recon_loss: 23224057.7333; val_global_loss: 51168640.0000; val_optim_loss: 51168640.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7830; val_auprc_score: 0.8003; val_best_acc_score: 0.6818; val_best_f1_score: 0.7225; train_kl_reg_loss: 230371.9251; train_edge_recon_loss: 3791344.7252; train_gene_expr_recon_loss: 23423792.9924; train_masked_gp_l1_reg_loss: 70483.1802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233965.2846; train_chrom_access_recon_loss: 23284517.0076; train_global_loss: 51034475.1756; train_optim_loss: 51034475.1756; val_kl_reg_loss: 197576.1896; val_edge_recon_loss: 3988421.5167; val_gene_expr_recon_loss: 22486283.8667; val_masked_gp_l1_reg_loss: 69320.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227208.8125; val_chrom_access_recon_loss: 22965861.4667; val_global_loss: 49934671.2000; val_optim_loss: 49934671.2000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8458; val_auprc_score: 0.8439; val_best_acc_score: 0.7454; val_best_f1_score: 0.7816; train_kl_reg_loss: 202811.0074; train_edge_recon_loss: 3419406.7042; train_gene_expr_recon_loss: 22388096.4275; train_masked_gp_l1_reg_loss: 69083.4128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 219666.0799; train_chrom_access_recon_loss: 22972508.7786; train_global_loss: 49271572.5191; train_optim_loss: 49271572.5191; val_kl_reg_loss: 228442.1719; val_edge_recon_loss: 3176095.9667; val_gene_expr_recon_loss: 22216449.0667; val_masked_gp_l1_reg_loss: 69983.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 212022.6094; val_chrom_access_recon_loss: 22859926.5333; val_global_loss: 48762919.4667; val_optim_loss: 48762919.4667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8738; val_auprc_score: 0.8689; val_best_acc_score: 0.7831; val_best_f1_score: 0.7947; train_kl_reg_loss: 233943.6110; train_edge_recon_loss: 3074878.9294; train_gene_expr_recon_loss: 22163465.3282; train_masked_gp_l1_reg_loss: 71083.3863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 204586.2947; train_chrom_access_recon_loss: 22873732.9466; train_global_loss: 48621690.4733; train_optim_loss: 48621690.4733; val_kl_reg_loss: 219736.7969; val_edge_recon_loss: 3057003.3500; val_gene_expr_recon_loss: 21972038.9333; val_masked_gp_l1_reg_loss: 72378.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 197098.2812; val_chrom_access_recon_loss: 22666658.5333; val_global_loss: 48184913.8667; val_optim_loss: 48184913.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8979; val_auprc_score: 0.8890; val_best_acc_score: 0.8146; val_best_f1_score: 0.8253; train_kl_reg_loss: 209135.5817; train_edge_recon_loss: 3022143.8950; train_gene_expr_recon_loss: 21945137.5267; train_masked_gp_l1_reg_loss: 73773.6026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 189970.1703; train_chrom_access_recon_loss: 22669977.9542; train_global_loss: 48110138.8092; train_optim_loss: 48110138.8092; val_kl_reg_loss: 204131.0521; val_edge_recon_loss: 3017481.8333; val_gene_expr_recon_loss: 21712174.9333; val_masked_gp_l1_reg_loss: 75253.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182893.2344; val_chrom_access_recon_loss: 22396098.4000; val_global_loss: 47588033.6000; val_optim_loss: 47588033.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9161; val_auprc_score: 0.9056; val_best_acc_score: 0.8383; val_best_f1_score: 0.8473; train_kl_reg_loss: 196549.7278; train_edge_recon_loss: 2961767.3645; train_gene_expr_recon_loss: 21795377.8321; train_masked_gp_l1_reg_loss: 76527.5392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176299.8943; train_chrom_access_recon_loss: 22607948.5954; train_global_loss: 47814470.7481; train_optim_loss: 47814470.7481; val_kl_reg_loss: 194334.9302; val_edge_recon_loss: 2960066.3500; val_gene_expr_recon_loss: 21686294.1333; val_masked_gp_l1_reg_loss: 78008.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169866.2031; val_chrom_access_recon_loss: 22571774.2667; val_global_loss: 47660344.2667; val_optim_loss: 47660344.2667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9354; val_auprc_score: 0.9274; val_best_acc_score: 0.8624; val_best_f1_score: 0.8708; train_kl_reg_loss: 191723.5484; train_edge_recon_loss: 2911443.3187; train_gene_expr_recon_loss: 21648391.6031; train_masked_gp_l1_reg_loss: 79067.7062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163999.5545; train_chrom_access_recon_loss: 22458473.0534; train_global_loss: 47453098.7176; train_optim_loss: 47453098.7176; val_kl_reg_loss: 191471.8438; val_edge_recon_loss: 2905271.4833; val_gene_expr_recon_loss: 21421370.4000; val_masked_gp_l1_reg_loss: 80271.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158262.5469; val_chrom_access_recon_loss: 22239482.8000; val_global_loss: 46996130.4000; val_optim_loss: 46996130.4000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9392; val_auprc_score: 0.9278; val_best_acc_score: 0.8715; val_best_f1_score: 0.8788; train_kl_reg_loss: 185332.9854; train_edge_recon_loss: 2873519.9466; train_gene_expr_recon_loss: 21535723.6183; train_masked_gp_l1_reg_loss: 81309.2014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153023.9401; train_chrom_access_recon_loss: 22368850.0611; train_global_loss: 47197759.7557; train_optim_loss: 47197759.7557; val_kl_reg_loss: 182218.9542; val_edge_recon_loss: 2886890.2000; val_gene_expr_recon_loss: 21407641.6000; val_masked_gp_l1_reg_loss: 82533.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147931.7344; val_chrom_access_recon_loss: 22175929.4667; val_global_loss: 46883145.6000; val_optim_loss: 46883145.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9487; val_auprc_score: 0.9409; val_best_acc_score: 0.8831; val_best_f1_score: 0.8882; train_kl_reg_loss: 178276.2371; train_edge_recon_loss: 2854037.5744; train_gene_expr_recon_loss: 21411996.9771; train_masked_gp_l1_reg_loss: 83522.0051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143117.1474; train_chrom_access_recon_loss: 22236102.9313; train_global_loss: 46907052.8244; train_optim_loss: 46907052.8244; val_kl_reg_loss: 174905.8687; val_edge_recon_loss: 2874744.3333; val_gene_expr_recon_loss: 21323021.8667; val_masked_gp_l1_reg_loss: 84636.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138377.2188; val_chrom_access_recon_loss: 22134820.9333; val_global_loss: 46730506.4000; val_optim_loss: 46730506.4000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9515; val_auprc_score: 0.9427; val_best_acc_score: 0.8871; val_best_f1_score: 0.8911; train_kl_reg_loss: 172033.7269; train_edge_recon_loss: 2844340.9122; train_gene_expr_recon_loss: 21312069.3893; train_masked_gp_l1_reg_loss: 85557.5881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134077.5083; train_chrom_access_recon_loss: 22120143.9389; train_global_loss: 46668223.0534; train_optim_loss: 46668223.0534; val_kl_reg_loss: 172021.8062; val_edge_recon_loss: 2847879.7500; val_gene_expr_recon_loss: 21247159.3333; val_masked_gp_l1_reg_loss: 86534.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129757.8125; val_chrom_access_recon_loss: 22002436.0000; val_global_loss: 46485789.0667; val_optim_loss: 46485789.0667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9546; val_auprc_score: 0.9450; val_best_acc_score: 0.8933; val_best_f1_score: 0.8986; train_kl_reg_loss: 166569.4385; train_edge_recon_loss: 2827144.2653; train_gene_expr_recon_loss: 21268775.4809; train_masked_gp_l1_reg_loss: 87458.5912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125881.0389; train_chrom_access_recon_loss: 22060550.3511; train_global_loss: 46536379.2977; train_optim_loss: 46536379.2977; val_kl_reg_loss: 167677.0073; val_edge_recon_loss: 2840411.1500; val_gene_expr_recon_loss: 21179029.0667; val_masked_gp_l1_reg_loss: 88483.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121640.7812; val_chrom_access_recon_loss: 22021672.4000; val_global_loss: 46418914.4000; val_optim_loss: 46418914.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9601; val_auprc_score: 0.9496; val_best_acc_score: 0.9020; val_best_f1_score: 0.9062; train_kl_reg_loss: 161798.8022; train_edge_recon_loss: 2813836.6279; train_gene_expr_recon_loss: 21171003.4046; train_masked_gp_l1_reg_loss: 89371.6130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117884.8764; train_chrom_access_recon_loss: 22004076.7786; train_global_loss: 46357971.9389; train_optim_loss: 46357971.9389; val_kl_reg_loss: 161420.8615; val_edge_recon_loss: 2804498.9500; val_gene_expr_recon_loss: 21124048.0000; val_masked_gp_l1_reg_loss: 90262.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114341.2500; val_chrom_access_recon_loss: 21888648.1333; val_global_loss: 46183220.2667; val_optim_loss: 46183220.2667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9620; val_auprc_score: 0.9540; val_best_acc_score: 0.9054; val_best_f1_score: 0.9090; train_kl_reg_loss: 157259.6190; train_edge_recon_loss: 2797159.2309; train_gene_expr_recon_loss: 21092082.6565; train_masked_gp_l1_reg_loss: 91174.2072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111126.4267; train_chrom_access_recon_loss: 21906407.5725; train_global_loss: 46155210.1374; train_optim_loss: 46155210.1374; val_kl_reg_loss: 157284.9719; val_edge_recon_loss: 2796536.8667; val_gene_expr_recon_loss: 20971102.4000; val_masked_gp_l1_reg_loss: 92213.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108130.2969; val_chrom_access_recon_loss: 21738145.2000; val_global_loss: 45863412.5333; val_optim_loss: 45863412.5333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9665; val_auprc_score: 0.9597; val_best_acc_score: 0.9119; val_best_f1_score: 0.9162; train_kl_reg_loss: 154008.1625; train_edge_recon_loss: 2788832.2748; train_gene_expr_recon_loss: 21057668.4427; train_masked_gp_l1_reg_loss: 93066.6995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105368.4667; train_chrom_access_recon_loss: 21882380.6565; train_global_loss: 46081324.7634; train_optim_loss: 46081324.7634; val_kl_reg_loss: 155021.6677; val_edge_recon_loss: 2804167.3333; val_gene_expr_recon_loss: 20875434.9333; val_masked_gp_l1_reg_loss: 94044.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102774.6562; val_chrom_access_recon_loss: 21670998.5333; val_global_loss: 45702441.0667; val_optim_loss: 45702441.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9684; val_auprc_score: 0.9626; val_best_acc_score: 0.9120; val_best_f1_score: 0.9162; train_kl_reg_loss: 149527.4256; train_edge_recon_loss: 2774726.1889; train_gene_expr_recon_loss: 20993735.5115; train_masked_gp_l1_reg_loss: 95588.5459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100457.6595; train_chrom_access_recon_loss: 21810224.9771; train_global_loss: 45924260.2748; train_optim_loss: 45924260.2748; val_kl_reg_loss: 148355.9865; val_edge_recon_loss: 2779816.1167; val_gene_expr_recon_loss: 20931294.2667; val_masked_gp_l1_reg_loss: 96923.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98160.0469; val_chrom_access_recon_loss: 21737671.0667; val_global_loss: 45792222.4000; val_optim_loss: 45792222.4000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9678; val_auprc_score: 0.9602; val_best_acc_score: 0.9134; val_best_f1_score: 0.9163; train_kl_reg_loss: 145503.8112; train_edge_recon_loss: 2771963.7328; train_gene_expr_recon_loss: 20931629.3282; train_masked_gp_l1_reg_loss: 97694.5227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95955.0561; train_chrom_access_recon_loss: 21745339.6183; train_global_loss: 45788086.1679; train_optim_loss: 45788086.1679; val_kl_reg_loss: 145512.4292; val_edge_recon_loss: 2797653.9333; val_gene_expr_recon_loss: 20877806.8000; val_masked_gp_l1_reg_loss: 98649.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93839.7734; val_chrom_access_recon_loss: 21678229.6000; val_global_loss: 45691692.2667; val_optim_loss: 45691692.2667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9702; val_auprc_score: 0.9619; val_best_acc_score: 0.9209; val_best_f1_score: 0.9236; train_kl_reg_loss: 143084.5141; train_edge_recon_loss: 2771641.3321; train_gene_expr_recon_loss: 20888247.6641; train_masked_gp_l1_reg_loss: 99259.5962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91808.2408; train_chrom_access_recon_loss: 21699602.7786; train_global_loss: 45693644.3969; train_optim_loss: 45693644.3969; val_kl_reg_loss: 142008.6021; val_edge_recon_loss: 2784343.6000; val_gene_expr_recon_loss: 20781995.4667; val_masked_gp_l1_reg_loss: 99749.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89695.5625; val_chrom_access_recon_loss: 21556733.6000; val_global_loss: 45454526.9333; val_optim_loss: 45454526.9333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9741; val_auprc_score: 0.9688; val_best_acc_score: 0.9240; val_best_f1_score: 0.9262; train_kl_reg_loss: 139904.9622; train_edge_recon_loss: 2763347.9046; train_gene_expr_recon_loss: 20842436.3969; train_masked_gp_l1_reg_loss: 100632.9195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87746.8990; train_chrom_access_recon_loss: 21677592.5954; train_global_loss: 45611661.5878; train_optim_loss: 45611661.5878; val_kl_reg_loss: 137305.8771; val_edge_recon_loss: 2772143.8500; val_gene_expr_recon_loss: 20699962.8000; val_masked_gp_l1_reg_loss: 101523.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85836.3594; val_chrom_access_recon_loss: 21454462.8000; val_global_loss: 45251235.2000; val_optim_loss: 45251235.2000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9743; val_auprc_score: 0.9692; val_best_acc_score: 0.9243; val_best_f1_score: 0.9268; train_kl_reg_loss: 137191.7251; train_edge_recon_loss: 2755014.8340; train_gene_expr_recon_loss: 20794513.9389; train_masked_gp_l1_reg_loss: 102335.1379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84005.5174; train_chrom_access_recon_loss: 21610750.8092; train_global_loss: 45483812.0000; train_optim_loss: 45483812.0000; val_kl_reg_loss: 136137.0281; val_edge_recon_loss: 2766677.6167; val_gene_expr_recon_loss: 20678755.3333; val_masked_gp_l1_reg_loss: 103107.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82220.2891; val_chrom_access_recon_loss: 21465709.2000; val_global_loss: 45232607.2000; val_optim_loss: 45232607.2000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9749; val_auprc_score: 0.9684; val_best_acc_score: 0.9290; val_best_f1_score: 0.9314; train_kl_reg_loss: 134888.1152; train_edge_recon_loss: 2745321.6584; train_gene_expr_recon_loss: 20753589.9237; train_masked_gp_l1_reg_loss: 103913.5586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80511.6598; train_chrom_access_recon_loss: 21570968.7176; train_global_loss: 45389193.7405; train_optim_loss: 45389193.7405; val_kl_reg_loss: 137149.0365; val_edge_recon_loss: 2757037.9833; val_gene_expr_recon_loss: 20729646.5333; val_masked_gp_l1_reg_loss: 104612.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78855.2578; val_chrom_access_recon_loss: 21467156.0000; val_global_loss: 45274457.6000; val_optim_loss: 45274457.6000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9764; val_auprc_score: 0.9715; val_best_acc_score: 0.9272; val_best_f1_score: 0.9300; train_kl_reg_loss: 134155.3770; train_edge_recon_loss: 2748852.0935; train_gene_expr_recon_loss: 20737218.3817; train_masked_gp_l1_reg_loss: 105393.2320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77328.8649; train_chrom_access_recon_loss: 21566690.5802; train_global_loss: 45369638.7481; train_optim_loss: 45369638.7481; val_kl_reg_loss: 134323.6719; val_edge_recon_loss: 2762134.1500; val_gene_expr_recon_loss: 20652316.6667; val_masked_gp_l1_reg_loss: 106223.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75696.7500; val_chrom_access_recon_loss: 21440424.8000; val_global_loss: 45171119.2000; val_optim_loss: 45171119.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9800; val_auprc_score: 0.9735; val_best_acc_score: 0.9348; val_best_f1_score: 0.9359; train_kl_reg_loss: 130843.0902; train_edge_recon_loss: 2748827.2405; train_gene_expr_recon_loss: 20665884.8397; train_masked_gp_l1_reg_loss: 106910.1810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74167.8941; train_chrom_access_recon_loss: 21484116.6107; train_global_loss: 45210749.6489; train_optim_loss: 45210749.6489; val_kl_reg_loss: 130260.1786; val_edge_recon_loss: 2723351.0167; val_gene_expr_recon_loss: 20660946.6667; val_masked_gp_l1_reg_loss: 107732.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72735.1641; val_chrom_access_recon_loss: 21539199.7333; val_global_loss: 45234225.0667; val_optim_loss: 45234225.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9789; val_auprc_score: 0.9739; val_best_acc_score: 0.9324; val_best_f1_score: 0.9346; train_kl_reg_loss: 128689.3552; train_edge_recon_loss: 2744606.2710; train_gene_expr_recon_loss: 20658126.7939; train_masked_gp_l1_reg_loss: 108532.0093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71409.1025; train_chrom_access_recon_loss: 21499778.3969; train_global_loss: 45211142.2595; train_optim_loss: 45211142.2595; val_kl_reg_loss: 129704.6432; val_edge_recon_loss: 2750400.4167; val_gene_expr_recon_loss: 20588203.6000; val_masked_gp_l1_reg_loss: 109392.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70118.3203; val_chrom_access_recon_loss: 21401648.5333; val_global_loss: 45049466.6667; val_optim_loss: 45049466.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9787; val_auprc_score: 0.9729; val_best_acc_score: 0.9351; val_best_f1_score: 0.9364; train_kl_reg_loss: 128115.0019; train_edge_recon_loss: 2738603.7042; train_gene_expr_recon_loss: 20638542.0763; train_masked_gp_l1_reg_loss: 110235.8044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68963.3313; train_chrom_access_recon_loss: 21504884.0611; train_global_loss: 45189344.0305; train_optim_loss: 45189344.0305; val_kl_reg_loss: 128603.4094; val_edge_recon_loss: 2755471.3833; val_gene_expr_recon_loss: 20650815.0667; val_masked_gp_l1_reg_loss: 110934.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67788.1719; val_chrom_access_recon_loss: 21507205.0667; val_global_loss: 45220816.5333; val_optim_loss: 45220816.5333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9775; val_auprc_score: 0.9723; val_best_acc_score: 0.9302; val_best_f1_score: 0.9318; train_kl_reg_loss: 125767.6706; train_edge_recon_loss: 2728483.8664; train_gene_expr_recon_loss: 20576600.1679; train_masked_gp_l1_reg_loss: 111915.1157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66699.2062; train_chrom_access_recon_loss: 21434021.5267; train_global_loss: 45043487.5115; train_optim_loss: 45043487.5115; val_kl_reg_loss: 126960.7120; val_edge_recon_loss: 2768992.7167; val_gene_expr_recon_loss: 20510057.0667; val_masked_gp_l1_reg_loss: 112619.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65592.1406; val_chrom_access_recon_loss: 21264608.5333; val_global_loss: 44848831.2000; val_optim_loss: 44848831.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9769; val_auprc_score: 0.9708; val_best_acc_score: 0.9301; val_best_f1_score: 0.9325; train_kl_reg_loss: 135567.6657; train_edge_recon_loss: 2784032.9695; train_gene_expr_recon_loss: 21924055.5267; train_masked_gp_l1_reg_loss: 112955.1304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68196.8052; train_chrom_access_recon_loss: 21792192.1069; train_global_loss: 46817000.0916; train_optim_loss: 46817000.0916; val_kl_reg_loss: 62242.5104; val_edge_recon_loss: 2770407.9167; val_gene_expr_recon_loss: 21698575.0667; val_masked_gp_l1_reg_loss: 113378.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68561.3438; val_chrom_access_recon_loss: 21765296.9333; val_global_loss: 46478462.4000; val_optim_loss: 46478462.4000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9780; val_auprc_score: 0.9731; val_best_acc_score: 0.9326; val_best_f1_score: 0.9348; train_kl_reg_loss: 121049.8901; train_edge_recon_loss: 2751283.0802; train_gene_expr_recon_loss: 21797691.5420; train_masked_gp_l1_reg_loss: 113630.9603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68079.9488; train_chrom_access_recon_loss: 21731777.7863; train_global_loss: 46583512.8550; train_optim_loss: 46583512.8550; val_kl_reg_loss: 69739.1687; val_edge_recon_loss: 2741593.0833; val_gene_expr_recon_loss: 21590932.4000; val_masked_gp_l1_reg_loss: 113665.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67129.3125; val_chrom_access_recon_loss: 21618400.9333; val_global_loss: 46201461.6000; val_optim_loss: 46201461.6000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9755; val_auprc_score: 0.9698; val_best_acc_score: 0.9274; val_best_f1_score: 0.9297; train_kl_reg_loss: 111809.2597; train_edge_recon_loss: 2733263.9408; train_gene_expr_recon_loss: 21677101.3130; train_masked_gp_l1_reg_loss: 113188.0948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65751.3993; train_chrom_access_recon_loss: 21726160.2901; train_global_loss: 46427274.3511; train_optim_loss: 46427274.3511; val_kl_reg_loss: 67660.2370; val_edge_recon_loss: 2746551.6000; val_gene_expr_recon_loss: 21615112.4000; val_masked_gp_l1_reg_loss: 112608.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64523.6875; val_chrom_access_recon_loss: 21560555.7333; val_global_loss: 46167012.2667; val_optim_loss: 46167012.2667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9730; val_auprc_score: 0.9649; val_best_acc_score: 0.9255; val_best_f1_score: 0.9280; train_kl_reg_loss: 114537.3311; train_edge_recon_loss: 2744558.1221; train_gene_expr_recon_loss: 21937945.2366; train_masked_gp_l1_reg_loss: 112721.9377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64232.2445; train_chrom_access_recon_loss: 21776259.3282; train_global_loss: 46750254.2595; train_optim_loss: 46750254.2595; val_kl_reg_loss: 60414.0169; val_edge_recon_loss: 2766967.2000; val_gene_expr_recon_loss: 21980949.0667; val_masked_gp_l1_reg_loss: 112754.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63904.6133; val_chrom_access_recon_loss: 21789366.8000; val_global_loss: 46774354.6667; val_optim_loss: 46774354.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9792; val_auprc_score: 0.9753; val_best_acc_score: 0.9347; val_best_f1_score: 0.9365; train_kl_reg_loss: 115375.3514; train_edge_recon_loss: 2738422.0573; train_gene_expr_recon_loss: 21987914.4122; train_masked_gp_l1_reg_loss: 112388.3185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63668.4728; train_chrom_access_recon_loss: 21801758.1527; train_global_loss: 46819526.8397; train_optim_loss: 46819526.8397; val_kl_reg_loss: 60995.3229; val_edge_recon_loss: 2728026.2333; val_gene_expr_recon_loss: 21863588.4000; val_masked_gp_l1_reg_loss: 112280.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63434.9062; val_chrom_access_recon_loss: 21530417.3333; val_global_loss: 46358741.8667; val_optim_loss: 46358741.8667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9758; val_auprc_score: 0.9672; val_best_acc_score: 0.9290; val_best_f1_score: 0.9314; train_kl_reg_loss: 115827.8795; train_edge_recon_loss: 2741215.1164; train_gene_expr_recon_loss: 22088099.3893; train_masked_gp_l1_reg_loss: 112216.8416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63261.0545; train_chrom_access_recon_loss: 21795327.5267; train_global_loss: 46915947.4809; train_optim_loss: 46915947.4809; val_kl_reg_loss: 59026.2102; val_edge_recon_loss: 2747493.7500; val_gene_expr_recon_loss: 22118188.8000; val_masked_gp_l1_reg_loss: 112170.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63116.8828; val_chrom_access_recon_loss: 21810462.1333; val_global_loss: 46910456.5333; val_optim_loss: 46910456.5333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9757; val_auprc_score: 0.9705; val_best_acc_score: 0.9289; val_best_f1_score: 0.9306; train_kl_reg_loss: 116772.9756; train_edge_recon_loss: 2740061.6546; train_gene_expr_recon_loss: 22102300.2748; train_masked_gp_l1_reg_loss: 112115.7272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62944.7179; train_chrom_access_recon_loss: 21779079.1908; train_global_loss: 46913274.5649; train_optim_loss: 46913274.5649; val_kl_reg_loss: 59104.6539; val_edge_recon_loss: 2786869.0500; val_gene_expr_recon_loss: 22004628.8000; val_masked_gp_l1_reg_loss: 112045.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62763.4531; val_chrom_access_recon_loss: 21660440.8000; val_global_loss: 46685854.1333; val_optim_loss: 46685854.1333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9774; val_auprc_score: 0.9723; val_best_acc_score: 0.9337; val_best_f1_score: 0.9355; train_kl_reg_loss: 115511.0441; train_edge_recon_loss: 2738900.7290; train_gene_expr_recon_loss: 22076633.8626; train_masked_gp_l1_reg_loss: 111953.2453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62570.7108; train_chrom_access_recon_loss: 21757082.1679; train_global_loss: 46862652.0000; train_optim_loss: 46862652.0000; val_kl_reg_loss: 61723.3349; val_edge_recon_loss: 2741514.0167; val_gene_expr_recon_loss: 21987110.1333; val_masked_gp_l1_reg_loss: 111850.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62371.1016; val_chrom_access_recon_loss: 21703667.0667; val_global_loss: 46668236.0000; val_optim_loss: 46668236.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 25 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9786
val AUPRC score: 0.9729
val best accuracy score: 0.9336
val best F1 score: 0.9360
val target rna MSE score: 2.1793
val source rna MSE score: 90.4787
val target atac MSE score: 0.1258
val source atac MSE score: 2.9243
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
