[True]
Run timestamp: 10102023_073204_186.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_186']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7658; val_auprc_score: 0.7857; val_best_acc_score: 0.5224; val_best_f1_score: 0.6761; train_kl_reg_loss: 55707.6068; train_edge_recon_loss: 737843.6121; train_gene_expr_recon_loss: 22214513.2366; train_masked_gp_l1_reg_loss: 143472.3074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3338734.1961; train_chrom_access_recon_loss: 954729.3454; train_global_loss: 27445000.3511; train_optim_loss: 27445000.3511; val_kl_reg_loss: 74415.7812; val_edge_recon_loss: 812761.5375; val_gene_expr_recon_loss: 21096969.7333; val_masked_gp_l1_reg_loss: 118935.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 810566.1875; val_chrom_access_recon_loss: 921666.3333; val_global_loss: 23835315.4667; val_optim_loss: 23835315.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8224; val_auprc_score: 0.8279; val_best_acc_score: 0.7425; val_best_f1_score: 0.7437; train_kl_reg_loss: 68318.7269; train_edge_recon_loss: 732152.3483; train_gene_expr_recon_loss: 20916609.4656; train_masked_gp_l1_reg_loss: 114121.8534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 403587.9122; train_chrom_access_recon_loss: 919589.6546; train_global_loss: 23154379.9084; train_optim_loss: 23154379.9084; val_kl_reg_loss: 66884.7203; val_edge_recon_loss: 799955.4167; val_gene_expr_recon_loss: 20798802.1333; val_masked_gp_l1_reg_loss: 113198.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 219123.7031; val_chrom_access_recon_loss: 910305.7125; val_global_loss: 22908269.8667; val_optim_loss: 22908269.8667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7976; val_auprc_score: 0.8089; val_best_acc_score: 0.7026; val_best_f1_score: 0.7396; train_kl_reg_loss: 62622.0158; train_edge_recon_loss: 721990.6007; train_gene_expr_recon_loss: 20658977.9237; train_masked_gp_l1_reg_loss: 118662.7204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172609.9212; train_chrom_access_recon_loss: 909193.6159; train_global_loss: 22644056.7786; train_optim_loss: 22644056.7786; val_kl_reg_loss: 56397.9346; val_edge_recon_loss: 790273.5625; val_gene_expr_recon_loss: 20567546.5333; val_masked_gp_l1_reg_loss: 124882.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142354.4062; val_chrom_access_recon_loss: 906188.7625; val_global_loss: 22587642.5333; val_optim_loss: 22587642.5333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8650; val_auprc_score: 0.8662; val_best_acc_score: 0.7784; val_best_f1_score: 0.7841; train_kl_reg_loss: 58249.4727; train_edge_recon_loss: 700900.2061; train_gene_expr_recon_loss: 20438696.2748; train_masked_gp_l1_reg_loss: 123514.9520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128548.2156; train_chrom_access_recon_loss: 900907.4241; train_global_loss: 22350816.6260; train_optim_loss: 22350816.6260; val_kl_reg_loss: 62526.7177; val_edge_recon_loss: 694882.0667; val_gene_expr_recon_loss: 20311686.9333; val_masked_gp_l1_reg_loss: 123901.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122718.9062; val_chrom_access_recon_loss: 895231.4333; val_global_loss: 22210947.6000; val_optim_loss: 22210947.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9086; val_auprc_score: 0.8990; val_best_acc_score: 0.8239; val_best_f1_score: 0.8326; train_kl_reg_loss: 66122.3823; train_edge_recon_loss: 649533.0224; train_gene_expr_recon_loss: 20222784.9160; train_masked_gp_l1_reg_loss: 123991.4331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116665.0388; train_chrom_access_recon_loss: 892963.4394; train_global_loss: 22072060.2290; train_optim_loss: 22072060.2290; val_kl_reg_loss: 71364.0625; val_edge_recon_loss: 632391.2375; val_gene_expr_recon_loss: 20115547.6000; val_masked_gp_l1_reg_loss: 124790.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114468.5078; val_chrom_access_recon_loss: 886139.9042; val_global_loss: 21944701.0667; val_optim_loss: 21944701.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9253; val_auprc_score: 0.9122; val_best_acc_score: 0.8527; val_best_f1_score: 0.8613; train_kl_reg_loss: 73058.9206; train_edge_recon_loss: 619636.4070; train_gene_expr_recon_loss: 20059396.1527; train_masked_gp_l1_reg_loss: 124171.3348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114636.8711; train_chrom_access_recon_loss: 887512.3860; train_global_loss: 21878412.2137; train_optim_loss: 21878412.2137; val_kl_reg_loss: 74622.2182; val_edge_recon_loss: 616870.5500; val_gene_expr_recon_loss: 19955216.5333; val_masked_gp_l1_reg_loss: 123618.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112802.6250; val_chrom_access_recon_loss: 879094.8667; val_global_loss: 21762224.4000; val_optim_loss: 21762224.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9330; val_auprc_score: 0.9212; val_best_acc_score: 0.8685; val_best_f1_score: 0.8745; train_kl_reg_loss: 72325.2247; train_edge_recon_loss: 610762.8235; train_gene_expr_recon_loss: 19902594.0916; train_masked_gp_l1_reg_loss: 123543.7039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110172.5809; train_chrom_access_recon_loss: 880795.5573; train_global_loss: 21700193.9237; train_optim_loss: 21700193.9237; val_kl_reg_loss: 70549.9865; val_edge_recon_loss: 613234.2667; val_gene_expr_recon_loss: 19838273.2000; val_masked_gp_l1_reg_loss: 123611.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107797.8984; val_chrom_access_recon_loss: 876123.3333; val_global_loss: 21629591.0667; val_optim_loss: 21629591.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9304; val_auprc_score: 0.9145; val_best_acc_score: 0.8631; val_best_f1_score: 0.8700; train_kl_reg_loss: 71271.6465; train_edge_recon_loss: 618874.5658; train_gene_expr_recon_loss: 19788907.9237; train_masked_gp_l1_reg_loss: 124614.1025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106701.0033; train_chrom_access_recon_loss: 875837.8526; train_global_loss: 21586206.9313; train_optim_loss: 21586206.9313; val_kl_reg_loss: 59924.6831; val_edge_recon_loss: 655263.6375; val_gene_expr_recon_loss: 19796156.9333; val_masked_gp_l1_reg_loss: 130311.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107591.4766; val_chrom_access_recon_loss: 872268.0417; val_global_loss: 21621517.3333; val_optim_loss: 21621517.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9343; val_auprc_score: 0.9214; val_best_acc_score: 0.8667; val_best_f1_score: 0.8724; train_kl_reg_loss: 69620.0779; train_edge_recon_loss: 614219.1083; train_gene_expr_recon_loss: 19687736.7939; train_masked_gp_l1_reg_loss: 125847.0006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100972.5052; train_chrom_access_recon_loss: 871152.2891; train_global_loss: 21469547.9695; train_optim_loss: 21469547.9695; val_kl_reg_loss: 71240.6615; val_edge_recon_loss: 611639.2958; val_gene_expr_recon_loss: 19644282.9333; val_masked_gp_l1_reg_loss: 125370.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100975.7422; val_chrom_access_recon_loss: 864082.0542; val_global_loss: 21417590.8000; val_optim_loss: 21417590.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9355; val_auprc_score: 0.9237; val_best_acc_score: 0.8653; val_best_f1_score: 0.8713; train_kl_reg_loss: 70018.3018; train_edge_recon_loss: 609061.4184; train_gene_expr_recon_loss: 19575396.5496; train_masked_gp_l1_reg_loss: 124924.2256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98872.1071; train_chrom_access_recon_loss: 867016.4747; train_global_loss: 21345289.1756; train_optim_loss: 21345289.1756; val_kl_reg_loss: 70603.9792; val_edge_recon_loss: 606922.4500; val_gene_expr_recon_loss: 19570105.6000; val_masked_gp_l1_reg_loss: 125142.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99185.3828; val_chrom_access_recon_loss: 866986.6917; val_global_loss: 21338946.8000; val_optim_loss: 21338946.8000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9330; val_auprc_score: 0.9185; val_best_acc_score: 0.8667; val_best_f1_score: 0.8735; train_kl_reg_loss: 69807.4093; train_edge_recon_loss: 603530.1231; train_gene_expr_recon_loss: 19479366.7176; train_masked_gp_l1_reg_loss: 124981.4140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97512.0561; train_chrom_access_recon_loss: 861861.9819; train_global_loss: 21237059.6641; train_optim_loss: 21237059.6641; val_kl_reg_loss: 69345.9823; val_edge_recon_loss: 605083.8375; val_gene_expr_recon_loss: 19383112.0000; val_masked_gp_l1_reg_loss: 124840.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96491.8047; val_chrom_access_recon_loss: 857088.5042; val_global_loss: 21135962.1333; val_optim_loss: 21135962.1333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9321; val_auprc_score: 0.9183; val_best_acc_score: 0.8626; val_best_f1_score: 0.8698; train_kl_reg_loss: 67453.9982; train_edge_recon_loss: 610255.1913; train_gene_expr_recon_loss: 19415278.3206; train_masked_gp_l1_reg_loss: 124918.2241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96520.5989; train_chrom_access_recon_loss: 858893.0334; train_global_loss: 21173319.3893; train_optim_loss: 21173319.3893; val_kl_reg_loss: 66679.9393; val_edge_recon_loss: 613086.9417; val_gene_expr_recon_loss: 19335721.2000; val_masked_gp_l1_reg_loss: 123875.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97345.3984; val_chrom_access_recon_loss: 855064.9333; val_global_loss: 21091775.2000; val_optim_loss: 21091775.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9368; val_auprc_score: 0.9252; val_best_acc_score: 0.8688; val_best_f1_score: 0.8756; train_kl_reg_loss: 70629.1647; train_edge_recon_loss: 604375.9089; train_gene_expr_recon_loss: 19342869.5115; train_masked_gp_l1_reg_loss: 122501.2853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95238.5940; train_chrom_access_recon_loss: 855254.5019; train_global_loss: 21090869.0382; train_optim_loss: 21090869.0382; val_kl_reg_loss: 70669.2286; val_edge_recon_loss: 607264.6833; val_gene_expr_recon_loss: 19330476.8000; val_masked_gp_l1_reg_loss: 122403.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94688.9375; val_chrom_access_recon_loss: 854803.6375; val_global_loss: 21080306.4000; val_optim_loss: 21080306.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9417; val_auprc_score: 0.9315; val_best_acc_score: 0.8783; val_best_f1_score: 0.8827; train_kl_reg_loss: 69915.3693; train_edge_recon_loss: 602959.0062; train_gene_expr_recon_loss: 19271573.0534; train_masked_gp_l1_reg_loss: 122426.1720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93921.6902; train_chrom_access_recon_loss: 852712.0143; train_global_loss: 21013507.2977; train_optim_loss: 21013507.2977; val_kl_reg_loss: 70481.7484; val_edge_recon_loss: 601283.0708; val_gene_expr_recon_loss: 19332180.0000; val_masked_gp_l1_reg_loss: 122531.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93419.8516; val_chrom_access_recon_loss: 851989.6250; val_global_loss: 21071886.5333; val_optim_loss: 21071886.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9395; val_auprc_score: 0.9244; val_best_acc_score: 0.8711; val_best_f1_score: 0.8784; train_kl_reg_loss: 69890.3539; train_edge_recon_loss: 598386.3368; train_gene_expr_recon_loss: 19195179.7099; train_masked_gp_l1_reg_loss: 122555.1276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92780.1259; train_chrom_access_recon_loss: 849495.5444; train_global_loss: 20928287.3130; train_optim_loss: 20928287.3130; val_kl_reg_loss: 69163.6807; val_edge_recon_loss: 602933.1875; val_gene_expr_recon_loss: 19204078.1333; val_masked_gp_l1_reg_loss: 123073.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93204.0000; val_chrom_access_recon_loss: 847112.3875; val_global_loss: 20939565.3333; val_optim_loss: 20939565.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9419; val_auprc_score: 0.9319; val_best_acc_score: 0.8731; val_best_f1_score: 0.8792; train_kl_reg_loss: 69343.4770; train_edge_recon_loss: 597738.4890; train_gene_expr_recon_loss: 19162042.7481; train_masked_gp_l1_reg_loss: 122691.6946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92546.3643; train_chrom_access_recon_loss: 848941.6240; train_global_loss: 20893304.4885; train_optim_loss: 20893304.4885; val_kl_reg_loss: 70191.8651; val_edge_recon_loss: 602041.0792; val_gene_expr_recon_loss: 19176504.2667; val_masked_gp_l1_reg_loss: 122595.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91427.4844; val_chrom_access_recon_loss: 849607.9208; val_global_loss: 20912369.0667; val_optim_loss: 20912369.0667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9450; val_auprc_score: 0.9318; val_best_acc_score: 0.8813; val_best_f1_score: 0.8876; train_kl_reg_loss: 68670.1589; train_edge_recon_loss: 595411.0167; train_gene_expr_recon_loss: 19122462.9924; train_masked_gp_l1_reg_loss: 122240.6668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91179.2189; train_chrom_access_recon_loss: 845164.4451; train_global_loss: 20845128.4427; train_optim_loss: 20845128.4427; val_kl_reg_loss: 68390.4906; val_edge_recon_loss: 596171.1417; val_gene_expr_recon_loss: 19049584.1333; val_masked_gp_l1_reg_loss: 122410.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92660.9453; val_chrom_access_recon_loss: 841157.4250; val_global_loss: 20770373.2000; val_optim_loss: 20770373.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9469; val_auprc_score: 0.9376; val_best_acc_score: 0.8821; val_best_f1_score: 0.8868; train_kl_reg_loss: 67932.0270; train_edge_recon_loss: 594343.9919; train_gene_expr_recon_loss: 19057902.9924; train_masked_gp_l1_reg_loss: 122099.5667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91415.9636; train_chrom_access_recon_loss: 842227.1966; train_global_loss: 20775921.6794; train_optim_loss: 20775921.6794; val_kl_reg_loss: 67009.7547; val_edge_recon_loss: 597536.4417; val_gene_expr_recon_loss: 19041636.0000; val_masked_gp_l1_reg_loss: 121940.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92211.7031; val_chrom_access_recon_loss: 843998.4708; val_global_loss: 20764332.8000; val_optim_loss: 20764332.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9457; val_auprc_score: 0.9352; val_best_acc_score: 0.8798; val_best_f1_score: 0.8858; train_kl_reg_loss: 67328.8194; train_edge_recon_loss: 593475.3473; train_gene_expr_recon_loss: 19019398.1832; train_masked_gp_l1_reg_loss: 122074.0999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91908.8778; train_chrom_access_recon_loss: 841631.2500; train_global_loss: 20735816.5802; train_optim_loss: 20735816.5802; val_kl_reg_loss: 66635.8089; val_edge_recon_loss: 596807.5292; val_gene_expr_recon_loss: 19051503.3333; val_masked_gp_l1_reg_loss: 122200.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91903.7656; val_chrom_access_recon_loss: 839889.4750; val_global_loss: 20768940.1333; val_optim_loss: 20768940.1333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9461; val_auprc_score: 0.9357; val_best_acc_score: 0.8783; val_best_f1_score: 0.8864; train_kl_reg_loss: 66664.3374; train_edge_recon_loss: 603062.2185; train_gene_expr_recon_loss: 19007660.8244; train_masked_gp_l1_reg_loss: 125810.7895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93870.8236; train_chrom_access_recon_loss: 840475.7705; train_global_loss: 20737544.9160; train_optim_loss: 20737544.9160; val_kl_reg_loss: 66317.5797; val_edge_recon_loss: 602965.2792; val_gene_expr_recon_loss: 19038955.2000; val_masked_gp_l1_reg_loss: 128487.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98775.4922; val_chrom_access_recon_loss: 840917.5083; val_global_loss: 20776418.6667; val_optim_loss: 20776418.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9434; val_auprc_score: 0.9320; val_best_acc_score: 0.8744; val_best_f1_score: 0.8818; train_kl_reg_loss: 73609.4253; train_edge_recon_loss: 614179.3330; train_gene_expr_recon_loss: 19064004.0458; train_masked_gp_l1_reg_loss: 129282.5013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98186.7943; train_chrom_access_recon_loss: 843971.7271; train_global_loss: 20823233.8015; train_optim_loss: 20823233.8015; val_kl_reg_loss: 73804.0172; val_edge_recon_loss: 637650.5833; val_gene_expr_recon_loss: 19092289.2000; val_masked_gp_l1_reg_loss: 134837.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112582.1094; val_chrom_access_recon_loss: 843088.6083; val_global_loss: 20894252.5333; val_optim_loss: 20894252.5333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9491; val_auprc_score: 0.9361; val_best_acc_score: 0.8841; val_best_f1_score: 0.8893; train_kl_reg_loss: 75701.7008; train_edge_recon_loss: 611217.1484; train_gene_expr_recon_loss: 19007006.9618; train_masked_gp_l1_reg_loss: 119923.0755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92571.7383; train_chrom_access_recon_loss: 841467.4933; train_global_loss: 20747888.0916; train_optim_loss: 20747888.0916; val_kl_reg_loss: 73713.7156; val_edge_recon_loss: 612194.4375; val_gene_expr_recon_loss: 18926374.6667; val_masked_gp_l1_reg_loss: 117763.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96232.4375; val_chrom_access_recon_loss: 832467.4833; val_global_loss: 20658746.8000; val_optim_loss: 20658746.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9520; val_auprc_score: 0.9434; val_best_acc_score: 0.8892; val_best_f1_score: 0.8953; train_kl_reg_loss: 74344.0676; train_edge_recon_loss: 602050.0253; train_gene_expr_recon_loss: 18927219.7252; train_masked_gp_l1_reg_loss: 118105.2266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91045.2005; train_chrom_access_recon_loss: 836394.2762; train_global_loss: 20649158.6412; train_optim_loss: 20649158.6412; val_kl_reg_loss: 73947.6771; val_edge_recon_loss: 598513.8750; val_gene_expr_recon_loss: 18872651.7333; val_masked_gp_l1_reg_loss: 118808.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89196.9375; val_chrom_access_recon_loss: 831455.1542; val_global_loss: 20584572.4000; val_optim_loss: 20584572.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9549; val_auprc_score: 0.9472; val_best_acc_score: 0.8879; val_best_f1_score: 0.8933; train_kl_reg_loss: 73263.0904; train_edge_recon_loss: 596916.5639; train_gene_expr_recon_loss: 18881975.4809; train_masked_gp_l1_reg_loss: 119165.6517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88433.8476; train_chrom_access_recon_loss: 834377.9532; train_global_loss: 20594132.4885; train_optim_loss: 20594132.4885; val_kl_reg_loss: 72415.1370; val_edge_recon_loss: 598451.2000; val_gene_expr_recon_loss: 18918107.7333; val_masked_gp_l1_reg_loss: 119665.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88963.5781; val_chrom_access_recon_loss: 834275.9750; val_global_loss: 20631879.8667; val_optim_loss: 20631879.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9568; val_auprc_score: 0.9482; val_best_acc_score: 0.8932; val_best_f1_score: 0.8973; train_kl_reg_loss: 71726.5625; train_edge_recon_loss: 595954.3659; train_gene_expr_recon_loss: 18867484.4427; train_masked_gp_l1_reg_loss: 119680.2406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88867.8682; train_chrom_access_recon_loss: 833649.1541; train_global_loss: 20577362.6412; train_optim_loss: 20577362.6412; val_kl_reg_loss: 76269.3896; val_edge_recon_loss: 599540.9333; val_gene_expr_recon_loss: 18932902.9333; val_masked_gp_l1_reg_loss: 120265.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88233.2734; val_chrom_access_recon_loss: 831732.2625; val_global_loss: 20648944.8000; val_optim_loss: 20648944.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9545; val_auprc_score: 0.9472; val_best_acc_score: 0.8894; val_best_f1_score: 0.8944; train_kl_reg_loss: 75095.4752; train_edge_recon_loss: 591716.6345; train_gene_expr_recon_loss: 18838756.4275; train_masked_gp_l1_reg_loss: 119280.6862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87556.6802; train_chrom_access_recon_loss: 834571.6732; train_global_loss: 20546977.6336; train_optim_loss: 20546977.6336; val_kl_reg_loss: 72680.3203; val_edge_recon_loss: 597531.2250; val_gene_expr_recon_loss: 18862388.8000; val_masked_gp_l1_reg_loss: 119527.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89536.5312; val_chrom_access_recon_loss: 833377.4083; val_global_loss: 20575042.1333; val_optim_loss: 20575042.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9561; val_auprc_score: 0.9462; val_best_acc_score: 0.8941; val_best_f1_score: 0.8980; train_kl_reg_loss: 72369.4245; train_edge_recon_loss: 592455.6169; train_gene_expr_recon_loss: 18814278.9008; train_masked_gp_l1_reg_loss: 119456.1458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88135.8129; train_chrom_access_recon_loss: 831972.7052; train_global_loss: 20518668.6260; train_optim_loss: 20518668.6260; val_kl_reg_loss: 69891.1422; val_edge_recon_loss: 601349.5375; val_gene_expr_recon_loss: 18797611.0667; val_masked_gp_l1_reg_loss: 120339.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88622.4375; val_chrom_access_recon_loss: 830102.5458; val_global_loss: 20507916.1333; val_optim_loss: 20507916.1333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9573; val_auprc_score: 0.9512; val_best_acc_score: 0.8926; val_best_f1_score: 0.8970; train_kl_reg_loss: 71895.5783; train_edge_recon_loss: 598599.0759; train_gene_expr_recon_loss: 18812712.8855; train_masked_gp_l1_reg_loss: 119086.1426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86663.3996; train_chrom_access_recon_loss: 832212.3626; train_global_loss: 20521169.4351; train_optim_loss: 20521169.4351; val_kl_reg_loss: 72537.2734; val_edge_recon_loss: 592238.8958; val_gene_expr_recon_loss: 18824100.2667; val_masked_gp_l1_reg_loss: 118520.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85983.8203; val_chrom_access_recon_loss: 830803.5083; val_global_loss: 20524183.7333; val_optim_loss: 20524183.7333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9580; val_auprc_score: 0.9477; val_best_acc_score: 0.9006; val_best_f1_score: 0.9041; train_kl_reg_loss: 71009.4654; train_edge_recon_loss: 593009.4408; train_gene_expr_recon_loss: 18779163.0840; train_masked_gp_l1_reg_loss: 118168.6521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85222.8245; train_chrom_access_recon_loss: 830169.6045; train_global_loss: 20476743.0840; train_optim_loss: 20476743.0840; val_kl_reg_loss: 70633.3859; val_edge_recon_loss: 593209.4542; val_gene_expr_recon_loss: 18817000.8000; val_masked_gp_l1_reg_loss: 118687.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86318.9375; val_chrom_access_recon_loss: 828039.1083; val_global_loss: 20513888.5333; val_optim_loss: 20513888.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9600; val_auprc_score: 0.9508; val_best_acc_score: 0.8987; val_best_f1_score: 0.9016; train_kl_reg_loss: 70505.1199; train_edge_recon_loss: 592586.2991; train_gene_expr_recon_loss: 18789274.0611; train_masked_gp_l1_reg_loss: 118431.9197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85465.9104; train_chrom_access_recon_loss: 830199.5821; train_global_loss: 20486462.7939; train_optim_loss: 20486462.7939; val_kl_reg_loss: 67194.9076; val_edge_recon_loss: 611272.1375; val_gene_expr_recon_loss: 18863223.0667; val_masked_gp_l1_reg_loss: 119650.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86575.1172; val_chrom_access_recon_loss: 835634.2792; val_global_loss: 20583550.5333; val_optim_loss: 20583550.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9561; val_auprc_score: 0.9459; val_best_acc_score: 0.8980; val_best_f1_score: 0.9018; train_kl_reg_loss: 68132.2142; train_edge_recon_loss: 594685.2543; train_gene_expr_recon_loss: 18759214.7023; train_masked_gp_l1_reg_loss: 118802.1289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85373.5556; train_chrom_access_recon_loss: 829288.8612; train_global_loss: 20455496.7328; train_optim_loss: 20455496.7328; val_kl_reg_loss: 68775.0281; val_edge_recon_loss: 591384.0083; val_gene_expr_recon_loss: 18815234.6667; val_masked_gp_l1_reg_loss: 118831.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84683.2266; val_chrom_access_recon_loss: 829742.3625; val_global_loss: 20508651.6000; val_optim_loss: 20508651.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9576; val_auprc_score: 0.9504; val_best_acc_score: 0.8946; val_best_f1_score: 0.8984; train_kl_reg_loss: 68834.6013; train_edge_recon_loss: 591028.2758; train_gene_expr_recon_loss: 18723989.9695; train_masked_gp_l1_reg_loss: 111950.8260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61078.9834; train_chrom_access_recon_loss: 827440.4356; train_global_loss: 20384323.0687; train_optim_loss: 20384323.0687; val_kl_reg_loss: 69620.2578; val_edge_recon_loss: 597784.3542; val_gene_expr_recon_loss: 18710352.9333; val_masked_gp_l1_reg_loss: 110211.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57372.7344; val_chrom_access_recon_loss: 826079.4917; val_global_loss: 20371420.9333; val_optim_loss: 20371420.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9581; val_auprc_score: 0.9478; val_best_acc_score: 0.8956; val_best_f1_score: 0.8995; train_kl_reg_loss: 69624.6291; train_edge_recon_loss: 589988.6360; train_gene_expr_recon_loss: 18743982.3206; train_masked_gp_l1_reg_loss: 109880.8596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56690.3342; train_chrom_access_recon_loss: 827909.6198; train_global_loss: 20398076.2137; train_optim_loss: 20398076.2137; val_kl_reg_loss: 69820.2354; val_edge_recon_loss: 593111.5292; val_gene_expr_recon_loss: 18769300.1333; val_masked_gp_l1_reg_loss: 109778.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56363.6562; val_chrom_access_recon_loss: 824353.1708; val_global_loss: 20422727.3333; val_optim_loss: 20422727.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9599; val_auprc_score: 0.9533; val_best_acc_score: 0.8995; val_best_f1_score: 0.9030; train_kl_reg_loss: 69636.7811; train_edge_recon_loss: 590588.8626; train_gene_expr_recon_loss: 18710948.6641; train_masked_gp_l1_reg_loss: 109659.4141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56093.1722; train_chrom_access_recon_loss: 825127.5310; train_global_loss: 20362054.3053; train_optim_loss: 20362054.3053; val_kl_reg_loss: 69709.9089; val_edge_recon_loss: 591475.6667; val_gene_expr_recon_loss: 18764157.7333; val_masked_gp_l1_reg_loss: 109630.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55986.0078; val_chrom_access_recon_loss: 823113.5875; val_global_loss: 20414073.2000; val_optim_loss: 20414073.2000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9567; val_auprc_score: 0.9472; val_best_acc_score: 0.8956; val_best_f1_score: 0.8992; train_kl_reg_loss: 70217.5292; train_edge_recon_loss: 590228.3736; train_gene_expr_recon_loss: 18713900.7786; train_masked_gp_l1_reg_loss: 109532.9938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55723.5939; train_chrom_access_recon_loss: 825968.1298; train_global_loss: 20365571.5420; train_optim_loss: 20365571.5420; val_kl_reg_loss: 70815.1276; val_edge_recon_loss: 594840.9125; val_gene_expr_recon_loss: 18709655.8667; val_masked_gp_l1_reg_loss: 109506.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55474.5312; val_chrom_access_recon_loss: 823198.7583; val_global_loss: 20363490.6667; val_optim_loss: 20363490.6667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9600; val_auprc_score: 0.9510; val_best_acc_score: 0.8976; val_best_f1_score: 0.9024; train_kl_reg_loss: 70440.5978; train_edge_recon_loss: 589071.8173; train_gene_expr_recon_loss: 18704534.4122; train_masked_gp_l1_reg_loss: 109447.2949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55337.3049; train_chrom_access_recon_loss: 825490.7572; train_global_loss: 20354322.0458; train_optim_loss: 20354322.0458; val_kl_reg_loss: 70661.4021; val_edge_recon_loss: 591426.9500; val_gene_expr_recon_loss: 18754241.6000; val_masked_gp_l1_reg_loss: 109407.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55198.2852; val_chrom_access_recon_loss: 825885.3667; val_global_loss: 20406821.2000; val_optim_loss: 20406821.2000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9556; val_auprc_score: 0.9447; val_best_acc_score: 0.8954; val_best_f1_score: 0.8989; train_kl_reg_loss: 70503.4050; train_edge_recon_loss: 589477.4957; train_gene_expr_recon_loss: 18706291.6336; train_masked_gp_l1_reg_loss: 109356.1571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55048.1789; train_chrom_access_recon_loss: 826056.8278; train_global_loss: 20356733.4962; train_optim_loss: 20356733.4962; val_kl_reg_loss: 71322.1083; val_edge_recon_loss: 593984.6958; val_gene_expr_recon_loss: 18745534.1333; val_masked_gp_l1_reg_loss: 109360.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55058.5781; val_chrom_access_recon_loss: 823205.3542; val_global_loss: 20398464.4000; val_optim_loss: 20398464.4000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9578; val_auprc_score: 0.9492; val_best_acc_score: 0.8965; val_best_f1_score: 0.9012; train_kl_reg_loss: 70694.2484; train_edge_recon_loss: 590120.6651; train_gene_expr_recon_loss: 18698253.4504; train_masked_gp_l1_reg_loss: 109312.3491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54865.8804; train_chrom_access_recon_loss: 825371.2123; train_global_loss: 20348617.8626; train_optim_loss: 20348617.8626; val_kl_reg_loss: 70540.9161; val_edge_recon_loss: 592702.0583; val_gene_expr_recon_loss: 18673606.0000; val_masked_gp_l1_reg_loss: 109295.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54791.2305; val_chrom_access_recon_loss: 824551.7375; val_global_loss: 20325488.6667; val_optim_loss: 20325488.6667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9579; val_auprc_score: 0.9488; val_best_acc_score: 0.8952; val_best_f1_score: 0.9003; train_kl_reg_loss: 70830.9716; train_edge_recon_loss: 589615.3135; train_gene_expr_recon_loss: 18686596.5496; train_masked_gp_l1_reg_loss: 109225.5642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54635.9527; train_chrom_access_recon_loss: 825386.7772; train_global_loss: 20336290.9924; train_optim_loss: 20336290.9924; val_kl_reg_loss: 71420.4500; val_edge_recon_loss: 590813.4167; val_gene_expr_recon_loss: 18752936.1333; val_masked_gp_l1_reg_loss: 109138.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54297.0820; val_chrom_access_recon_loss: 830005.7708; val_global_loss: 20408611.8667; val_optim_loss: 20408611.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9573; val_auprc_score: 0.9497; val_best_acc_score: 0.8945; val_best_f1_score: 0.8979; train_kl_reg_loss: 71103.1130; train_edge_recon_loss: 588419.3321; train_gene_expr_recon_loss: 18710148.9618; train_masked_gp_l1_reg_loss: 109137.1141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54287.6172; train_chrom_access_recon_loss: 825746.5200; train_global_loss: 20358842.5954; train_optim_loss: 20358842.5954; val_kl_reg_loss: 71703.8448; val_edge_recon_loss: 596354.6667; val_gene_expr_recon_loss: 18693973.7333; val_masked_gp_l1_reg_loss: 109111.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54395.6680; val_chrom_access_recon_loss: 820978.7583; val_global_loss: 20346519.0667; val_optim_loss: 20346519.0667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9539; val_auprc_score: 0.9380; val_best_acc_score: 0.8923; val_best_f1_score: 0.8962; train_kl_reg_loss: 70958.2811; train_edge_recon_loss: 589494.8149; train_gene_expr_recon_loss: 18693994.9466; train_masked_gp_l1_reg_loss: 109042.9925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54115.4829; train_chrom_access_recon_loss: 825744.0697; train_global_loss: 20343350.6260; train_optim_loss: 20343350.6260; val_kl_reg_loss: 70726.7417; val_edge_recon_loss: 593330.5458; val_gene_expr_recon_loss: 18683024.4000; val_masked_gp_l1_reg_loss: 109078.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54155.4453; val_chrom_access_recon_loss: 826223.0500; val_global_loss: 20336539.0667; val_optim_loss: 20336539.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9570; val_auprc_score: 0.9491; val_best_acc_score: 0.8941; val_best_f1_score: 0.8974; train_kl_reg_loss: 70882.7298; train_edge_recon_loss: 589503.5344; train_gene_expr_recon_loss: 18684771.2977; train_masked_gp_l1_reg_loss: 109024.1050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53962.8982; train_chrom_access_recon_loss: 825258.6541; train_global_loss: 20333403.3893; train_optim_loss: 20333403.3893; val_kl_reg_loss: 71102.8083; val_edge_recon_loss: 592874.6792; val_gene_expr_recon_loss: 18722088.4000; val_masked_gp_l1_reg_loss: 109048.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53735.1328; val_chrom_access_recon_loss: 825099.8208; val_global_loss: 20373949.4667; val_optim_loss: 20373949.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9560; val_auprc_score: 0.9475; val_best_acc_score: 0.8954; val_best_f1_score: 0.8984; train_kl_reg_loss: 70773.1527; train_edge_recon_loss: 588275.3922; train_gene_expr_recon_loss: 18697455.8626; train_masked_gp_l1_reg_loss: 108235.8824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51360.2540; train_chrom_access_recon_loss: 825601.0157; train_global_loss: 20341701.5115; train_optim_loss: 20341701.5115; val_kl_reg_loss: 71378.3792; val_edge_recon_loss: 591671.1667; val_gene_expr_recon_loss: 18787706.5333; val_masked_gp_l1_reg_loss: 107960.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50922.5547; val_chrom_access_recon_loss: 829608.2208; val_global_loss: 20439246.2667; val_optim_loss: 20439246.2667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9586; val_auprc_score: 0.9504; val_best_acc_score: 0.8967; val_best_f1_score: 0.9008; train_kl_reg_loss: 70876.5882; train_edge_recon_loss: 588963.0706; train_gene_expr_recon_loss: 18692018.1679; train_masked_gp_l1_reg_loss: 107895.2528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50804.6711; train_chrom_access_recon_loss: 825233.5491; train_global_loss: 20335791.2824; train_optim_loss: 20335791.2824; val_kl_reg_loss: 71231.9495; val_edge_recon_loss: 591891.0167; val_gene_expr_recon_loss: 18739235.2000; val_masked_gp_l1_reg_loss: 107839.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50703.8945; val_chrom_access_recon_loss: 827376.9083; val_global_loss: 20388279.0667; val_optim_loss: 20388279.0667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9578; val_auprc_score: 0.9472; val_best_acc_score: 0.8985; val_best_f1_score: 0.9022; train_kl_reg_loss: 70908.8135; train_edge_recon_loss: 588718.4432; train_gene_expr_recon_loss: 18685642.4885; train_masked_gp_l1_reg_loss: 107814.8788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50632.7930; train_chrom_access_recon_loss: 825177.1407; train_global_loss: 20328894.5496; train_optim_loss: 20328894.5496; val_kl_reg_loss: 71235.8089; val_edge_recon_loss: 590897.5333; val_gene_expr_recon_loss: 18713443.4667; val_masked_gp_l1_reg_loss: 107791.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50597.1758; val_chrom_access_recon_loss: 826296.5083; val_global_loss: 20360263.2000; val_optim_loss: 20360263.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9595; val_auprc_score: 0.9511; val_best_acc_score: 0.8989; val_best_f1_score: 0.9027; train_kl_reg_loss: 70893.8897; train_edge_recon_loss: 589050.4113; train_gene_expr_recon_loss: 18684371.2672; train_masked_gp_l1_reg_loss: 107775.2019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50536.0376; train_chrom_access_recon_loss: 824406.0787; train_global_loss: 20327032.9313; train_optim_loss: 20327032.9313; val_kl_reg_loss: 71296.2417; val_edge_recon_loss: 591957.9083; val_gene_expr_recon_loss: 18728162.9333; val_masked_gp_l1_reg_loss: 107758.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50490.8008; val_chrom_access_recon_loss: 821495.6208; val_global_loss: 20371160.4000; val_optim_loss: 20371160.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 11 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9572
val AUPRC score: 0.9495
val best accuracy score: 0.8940
val best F1 score: 0.8974
val target rna MSE score: 1.1848
val source rna MSE score: 0.4334
val target atac MSE score: 0.4928
val source atac MSE score: 0.1522
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
