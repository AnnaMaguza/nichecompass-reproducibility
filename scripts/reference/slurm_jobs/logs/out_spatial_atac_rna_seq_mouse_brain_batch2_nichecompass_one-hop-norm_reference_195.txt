[True]
Run timestamp: 10102023_080209_195.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_195']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6903; val_auprc_score: 0.6651; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 51977.3718; train_edge_recon_loss: 744059.4820; train_gene_expr_recon_loss: 23190774.3030; train_masked_gp_l1_reg_loss: 39008.9408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4027891.0303; train_chrom_access_recon_loss: 2978144.3939; train_global_loss: 31031855.6667; train_optim_loss: 31031855.6667; val_kl_reg_loss: 56890.8374; val_edge_recon_loss: 813094.7109; val_gene_expr_recon_loss: 21657559.5000; val_masked_gp_l1_reg_loss: 46272.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2697885.7500; val_chrom_access_recon_loss: 2829235.7188; val_global_loss: 28100938.7500; val_optim_loss: 28100938.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6472; val_auprc_score: 0.6200; val_best_acc_score: 0.6072; val_best_f1_score: 0.6795; train_kl_reg_loss: 67000.3111; train_edge_recon_loss: 745930.8674; train_gene_expr_recon_loss: 21391728.2121; train_masked_gp_l1_reg_loss: 49395.7856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1755239.5284; train_chrom_access_recon_loss: 2831020.0985; train_global_loss: 26840314.8485; train_optim_loss: 26840314.8485; val_kl_reg_loss: 75370.3340; val_edge_recon_loss: 811010.0078; val_gene_expr_recon_loss: 21382031.5000; val_masked_gp_l1_reg_loss: 50153.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1037047.0000; val_chrom_access_recon_loss: 2801167.3750; val_global_loss: 26156779.5000; val_optim_loss: 26156779.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7010; val_auprc_score: 0.6786; val_best_acc_score: 0.6464; val_best_f1_score: 0.6869; train_kl_reg_loss: 72626.4031; train_edge_recon_loss: 736383.9318; train_gene_expr_recon_loss: 21129987.5152; train_masked_gp_l1_reg_loss: 49529.4719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 712246.2216; train_chrom_access_recon_loss: 2808060.3333; train_global_loss: 25508833.7879; train_optim_loss: 25508833.7879; val_kl_reg_loss: 64710.2275; val_edge_recon_loss: 809146.1719; val_gene_expr_recon_loss: 21181158.2500; val_masked_gp_l1_reg_loss: 49714.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 477678.4375; val_chrom_access_recon_loss: 2784811.0625; val_global_loss: 25367217.2500; val_optim_loss: 25367217.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7369; val_auprc_score: 0.7183; val_best_acc_score: 0.6668; val_best_f1_score: 0.7058; train_kl_reg_loss: 67774.7428; train_edge_recon_loss: 730427.1619; train_gene_expr_recon_loss: 21011610.9091; train_masked_gp_l1_reg_loss: 50117.6197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 364285.3935; train_chrom_access_recon_loss: 2799265.7614; train_global_loss: 25023481.5152; train_optim_loss: 25023481.5152; val_kl_reg_loss: 62217.5635; val_edge_recon_loss: 803902.1406; val_gene_expr_recon_loss: 21187581.5000; val_masked_gp_l1_reg_loss: 50531.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 277577.3438; val_chrom_access_recon_loss: 2767514.7188; val_global_loss: 25149326.0000; val_optim_loss: 25149326.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7856; val_auprc_score: 0.7575; val_best_acc_score: 0.6937; val_best_f1_score: 0.7417; train_kl_reg_loss: 63685.9984; train_edge_recon_loss: 726035.0956; train_gene_expr_recon_loss: 20849838.9697; train_masked_gp_l1_reg_loss: 51170.8912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 228817.9728; train_chrom_access_recon_loss: 2778921.3068; train_global_loss: 24698470.2424; train_optim_loss: 24698470.2424; val_kl_reg_loss: 61401.6953; val_edge_recon_loss: 790877.7891; val_gene_expr_recon_loss: 20860980.2500; val_masked_gp_l1_reg_loss: 51801.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192035.2344; val_chrom_access_recon_loss: 2744225.3750; val_global_loss: 24701323.0000; val_optim_loss: 24701323.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8184; val_auprc_score: 0.8039; val_best_acc_score: 0.7413; val_best_f1_score: 0.7562; train_kl_reg_loss: 57171.3298; train_edge_recon_loss: 715885.2348; train_gene_expr_recon_loss: 20723386.1212; train_masked_gp_l1_reg_loss: 52500.1027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172251.7195; train_chrom_access_recon_loss: 2765409.4545; train_global_loss: 24486604.0606; train_optim_loss: 24486604.0606; val_kl_reg_loss: 56461.7114; val_edge_recon_loss: 764440.9766; val_gene_expr_recon_loss: 20595136.2500; val_masked_gp_l1_reg_loss: 53312.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159435.2812; val_chrom_access_recon_loss: 2711219.6562; val_global_loss: 24340007.0000; val_optim_loss: 24340007.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8251; val_auprc_score: 0.8087; val_best_acc_score: 0.7461; val_best_f1_score: 0.7614; train_kl_reg_loss: 61562.4830; train_edge_recon_loss: 706756.2680; train_gene_expr_recon_loss: 20670362.4848; train_masked_gp_l1_reg_loss: 53357.7418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151439.5859; train_chrom_access_recon_loss: 2761569.6212; train_global_loss: 24405048.3333; train_optim_loss: 24405048.3333; val_kl_reg_loss: 58649.7158; val_edge_recon_loss: 734663.1953; val_gene_expr_recon_loss: 20595045.2500; val_masked_gp_l1_reg_loss: 53423.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145505.8438; val_chrom_access_recon_loss: 2717618.5312; val_global_loss: 24304906.2500; val_optim_loss: 24304906.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8292; val_auprc_score: 0.8111; val_best_acc_score: 0.7509; val_best_f1_score: 0.7689; train_kl_reg_loss: 56721.9241; train_edge_recon_loss: 684177.6430; train_gene_expr_recon_loss: 20466589.4545; train_masked_gp_l1_reg_loss: 54081.6793; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135717.5769; train_chrom_access_recon_loss: 2738220.7311; train_global_loss: 24135508.8485; train_optim_loss: 24135508.8485; val_kl_reg_loss: 57774.5576; val_edge_recon_loss: 692092.4844; val_gene_expr_recon_loss: 20267722.5000; val_masked_gp_l1_reg_loss: 54980.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130167.5625; val_chrom_access_recon_loss: 2674808.4688; val_global_loss: 23877545.5000; val_optim_loss: 23877545.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8409; val_auprc_score: 0.8243; val_best_acc_score: 0.7636; val_best_f1_score: 0.7753; train_kl_reg_loss: 61852.7483; train_edge_recon_loss: 668334.6402; train_gene_expr_recon_loss: 20379226.6061; train_masked_gp_l1_reg_loss: 55449.0029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124537.9267; train_chrom_access_recon_loss: 2731931.8864; train_global_loss: 24021332.9697; train_optim_loss: 24021332.9697; val_kl_reg_loss: 60479.8418; val_edge_recon_loss: 677288.1641; val_gene_expr_recon_loss: 20309676.0000; val_masked_gp_l1_reg_loss: 55694.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119739.0078; val_chrom_access_recon_loss: 2694951.0625; val_global_loss: 23917829.0000; val_optim_loss: 23917829.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8649; val_auprc_score: 0.8392; val_best_acc_score: 0.7926; val_best_f1_score: 0.8065; train_kl_reg_loss: 60658.3500; train_edge_recon_loss: 648619.2311; train_gene_expr_recon_loss: 20275242.0000; train_masked_gp_l1_reg_loss: 56303.0232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115485.9574; train_chrom_access_recon_loss: 2717450.0530; train_global_loss: 23873758.5455; train_optim_loss: 23873758.5455; val_kl_reg_loss: 61554.3018; val_edge_recon_loss: 650831.5938; val_gene_expr_recon_loss: 20217509.5000; val_masked_gp_l1_reg_loss: 57115.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111724.6797; val_chrom_access_recon_loss: 2664973.5312; val_global_loss: 23763708.5000; val_optim_loss: 23763708.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8959; val_auprc_score: 0.8714; val_best_acc_score: 0.8272; val_best_f1_score: 0.8354; train_kl_reg_loss: 67603.7201; train_edge_recon_loss: 629412.1932; train_gene_expr_recon_loss: 20194178.4545; train_masked_gp_l1_reg_loss: 57768.7385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108414.8995; train_chrom_access_recon_loss: 2712189.9280; train_global_loss: 23769567.9091; train_optim_loss: 23769567.9091; val_kl_reg_loss: 66576.6782; val_edge_recon_loss: 622939.0469; val_gene_expr_recon_loss: 20369809.5000; val_masked_gp_l1_reg_loss: 57965.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106247.6797; val_chrom_access_recon_loss: 2675566.5625; val_global_loss: 23899105.7500; val_optim_loss: 23899105.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8963; val_auprc_score: 0.8630; val_best_acc_score: 0.8289; val_best_f1_score: 0.8407; train_kl_reg_loss: 65557.5123; train_edge_recon_loss: 614449.9650; train_gene_expr_recon_loss: 20119626.7576; train_masked_gp_l1_reg_loss: 58606.9682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103338.7839; train_chrom_access_recon_loss: 2700325.0189; train_global_loss: 23661904.8788; train_optim_loss: 23661904.8788; val_kl_reg_loss: 67831.6387; val_edge_recon_loss: 614226.6797; val_gene_expr_recon_loss: 20086346.0000; val_masked_gp_l1_reg_loss: 59450.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100923.8125; val_chrom_access_recon_loss: 2650498.6875; val_global_loss: 23579276.5000; val_optim_loss: 23579276.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9138; val_auprc_score: 0.8892; val_best_acc_score: 0.8512; val_best_f1_score: 0.8585; train_kl_reg_loss: 66655.1041; train_edge_recon_loss: 609937.2983; train_gene_expr_recon_loss: 20050451.4242; train_masked_gp_l1_reg_loss: 60239.4104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99080.9910; train_chrom_access_recon_loss: 2695107.9129; train_global_loss: 23581472.4545; train_optim_loss: 23581472.4545; val_kl_reg_loss: 66055.9277; val_edge_recon_loss: 608161.0625; val_gene_expr_recon_loss: 19964846.0000; val_masked_gp_l1_reg_loss: 61180.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97576.3672; val_chrom_access_recon_loss: 2632332.7812; val_global_loss: 23430151.7500; val_optim_loss: 23430151.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8984; val_auprc_score: 0.8664; val_best_acc_score: 0.8337; val_best_f1_score: 0.8428; train_kl_reg_loss: 67745.6813; train_edge_recon_loss: 604517.7841; train_gene_expr_recon_loss: 19959312.7879; train_masked_gp_l1_reg_loss: 61837.3535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95848.8098; train_chrom_access_recon_loss: 2688259.4848; train_global_loss: 23477522.1515; train_optim_loss: 23477522.1515; val_kl_reg_loss: 66880.6758; val_edge_recon_loss: 608353.5469; val_gene_expr_recon_loss: 19887084.5000; val_masked_gp_l1_reg_loss: 62337.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94630.9141; val_chrom_access_recon_loss: 2655586.7812; val_global_loss: 23374873.5000; val_optim_loss: 23374873.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9094; val_auprc_score: 0.8808; val_best_acc_score: 0.8439; val_best_f1_score: 0.8565; train_kl_reg_loss: 65024.1344; train_edge_recon_loss: 600872.8097; train_gene_expr_recon_loss: 19879856.9091; train_masked_gp_l1_reg_loss: 62833.2762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93128.4107; train_chrom_access_recon_loss: 2675890.4848; train_global_loss: 23377606.2121; train_optim_loss: 23377606.2121; val_kl_reg_loss: 62808.3179; val_edge_recon_loss: 604533.2422; val_gene_expr_recon_loss: 19837297.7500; val_masked_gp_l1_reg_loss: 63363.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92599.2188; val_chrom_access_recon_loss: 2637838.6250; val_global_loss: 23298442.0000; val_optim_loss: 23298442.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9108; val_auprc_score: 0.8841; val_best_acc_score: 0.8401; val_best_f1_score: 0.8547; train_kl_reg_loss: 63124.1874; train_edge_recon_loss: 598201.9015; train_gene_expr_recon_loss: 19844920.8182; train_masked_gp_l1_reg_loss: 63714.9810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90965.4177; train_chrom_access_recon_loss: 2671560.6098; train_global_loss: 23332487.8788; train_optim_loss: 23332487.8788; val_kl_reg_loss: 62386.9419; val_edge_recon_loss: 599419.1641; val_gene_expr_recon_loss: 19772621.0000; val_masked_gp_l1_reg_loss: 64124.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89883.0469; val_chrom_access_recon_loss: 2624012.1562; val_global_loss: 23212447.0000; val_optim_loss: 23212447.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9179; val_auprc_score: 0.8955; val_best_acc_score: 0.8520; val_best_f1_score: 0.8628; train_kl_reg_loss: 62336.2725; train_edge_recon_loss: 594199.4801; train_gene_expr_recon_loss: 19774787.7879; train_masked_gp_l1_reg_loss: 64420.9387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88934.0414; train_chrom_access_recon_loss: 2663562.8523; train_global_loss: 23248241.3939; train_optim_loss: 23248241.3939; val_kl_reg_loss: 60874.9409; val_edge_recon_loss: 597073.2109; val_gene_expr_recon_loss: 19675623.7500; val_masked_gp_l1_reg_loss: 64781.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88466.1797; val_chrom_access_recon_loss: 2612487.0312; val_global_loss: 23099307.0000; val_optim_loss: 23099307.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9194; val_auprc_score: 0.8937; val_best_acc_score: 0.8544; val_best_f1_score: 0.8626; train_kl_reg_loss: 61441.7211; train_edge_recon_loss: 594687.7917; train_gene_expr_recon_loss: 19707910.5758; train_masked_gp_l1_reg_loss: 65011.4457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87505.3441; train_chrom_access_recon_loss: 2656076.7803; train_global_loss: 23172633.3333; train_optim_loss: 23172633.3333; val_kl_reg_loss: 59516.6196; val_edge_recon_loss: 596067.0078; val_gene_expr_recon_loss: 19765796.2500; val_masked_gp_l1_reg_loss: 65309.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87213.1172; val_chrom_access_recon_loss: 2623289.5625; val_global_loss: 23197193.2500; val_optim_loss: 23197193.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9179; val_auprc_score: 0.8885; val_best_acc_score: 0.8568; val_best_f1_score: 0.8661; train_kl_reg_loss: 60071.0775; train_edge_recon_loss: 592906.6752; train_gene_expr_recon_loss: 19676126.9091; train_masked_gp_l1_reg_loss: 65582.9497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86084.7389; train_chrom_access_recon_loss: 2649585.5530; train_global_loss: 23130357.9091; train_optim_loss: 23130357.9091; val_kl_reg_loss: 60648.9741; val_edge_recon_loss: 599402.8516; val_gene_expr_recon_loss: 19670239.2500; val_masked_gp_l1_reg_loss: 65856.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85475.7109; val_chrom_access_recon_loss: 2579458.2812; val_global_loss: 23061081.2500; val_optim_loss: 23061081.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9186; val_auprc_score: 0.8883; val_best_acc_score: 0.8579; val_best_f1_score: 0.8630; train_kl_reg_loss: 59701.3327; train_edge_recon_loss: 591590.6515; train_gene_expr_recon_loss: 19625484.0303; train_masked_gp_l1_reg_loss: 66151.8329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84664.5317; train_chrom_access_recon_loss: 2644255.6061; train_global_loss: 23071848.1515; train_optim_loss: 23071848.1515; val_kl_reg_loss: 59199.9106; val_edge_recon_loss: 592853.6172; val_gene_expr_recon_loss: 19482733.2500; val_masked_gp_l1_reg_loss: 66509.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84671.5938; val_chrom_access_recon_loss: 2574967.1250; val_global_loss: 22860936.7500; val_optim_loss: 22860936.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9237; val_auprc_score: 0.9002; val_best_acc_score: 0.8581; val_best_f1_score: 0.8649; train_kl_reg_loss: 59166.6055; train_edge_recon_loss: 590195.8049; train_gene_expr_recon_loss: 19589968.6970; train_masked_gp_l1_reg_loss: 66637.8930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83934.6119; train_chrom_access_recon_loss: 2637606.2197; train_global_loss: 23027509.7879; train_optim_loss: 23027509.7879; val_kl_reg_loss: 57264.9443; val_edge_recon_loss: 598798.3203; val_gene_expr_recon_loss: 19585023.0000; val_masked_gp_l1_reg_loss: 66878.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83866.0234; val_chrom_access_recon_loss: 2614375.9375; val_global_loss: 23006206.0000; val_optim_loss: 23006206.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9273; val_auprc_score: 0.9042; val_best_acc_score: 0.8635; val_best_f1_score: 0.8707; train_kl_reg_loss: 58004.5521; train_edge_recon_loss: 588644.7983; train_gene_expr_recon_loss: 19564593.5758; train_masked_gp_l1_reg_loss: 67162.2002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82987.7949; train_chrom_access_recon_loss: 2636444.3902; train_global_loss: 22997837.2424; train_optim_loss: 22997837.2424; val_kl_reg_loss: 58156.7656; val_edge_recon_loss: 593428.1797; val_gene_expr_recon_loss: 19525571.0000; val_masked_gp_l1_reg_loss: 67410.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82891.7031; val_chrom_access_recon_loss: 2570124.1250; val_global_loss: 22897582.0000; val_optim_loss: 22897582.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9329; val_auprc_score: 0.9106; val_best_acc_score: 0.8700; val_best_f1_score: 0.8755; train_kl_reg_loss: 57616.8831; train_edge_recon_loss: 587883.2396; train_gene_expr_recon_loss: 19506400.4848; train_masked_gp_l1_reg_loss: 67656.5644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82063.8685; train_chrom_access_recon_loss: 2626086.9886; train_global_loss: 22927707.9697; train_optim_loss: 22927707.9697; val_kl_reg_loss: 57216.5938; val_edge_recon_loss: 594007.0625; val_gene_expr_recon_loss: 19487970.0000; val_masked_gp_l1_reg_loss: 67987.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81500.2188; val_chrom_access_recon_loss: 2592245.7500; val_global_loss: 22880927.7500; val_optim_loss: 22880927.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9269; val_auprc_score: 0.9058; val_best_acc_score: 0.8592; val_best_f1_score: 0.8686; train_kl_reg_loss: 57242.3217; train_edge_recon_loss: 585835.9697; train_gene_expr_recon_loss: 19461890.9091; train_masked_gp_l1_reg_loss: 68231.3593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80915.5610; train_chrom_access_recon_loss: 2620449.2689; train_global_loss: 22874565.3939; train_optim_loss: 22874565.3939; val_kl_reg_loss: 57798.9224; val_edge_recon_loss: 591704.6562; val_gene_expr_recon_loss: 19533481.2500; val_masked_gp_l1_reg_loss: 68540.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80383.7188; val_chrom_access_recon_loss: 2590436.4062; val_global_loss: 22922345.2500; val_optim_loss: 22922345.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9248; val_auprc_score: 0.9017; val_best_acc_score: 0.8571; val_best_f1_score: 0.8643; train_kl_reg_loss: 57149.8861; train_edge_recon_loss: 585334.9479; train_gene_expr_recon_loss: 19424015.9697; train_masked_gp_l1_reg_loss: 67960.6123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63806.8254; train_chrom_access_recon_loss: 2614195.1515; train_global_loss: 22812463.3636; train_optim_loss: 22812463.3636; val_kl_reg_loss: 57099.2412; val_edge_recon_loss: 594609.9297; val_gene_expr_recon_loss: 19439197.0000; val_masked_gp_l1_reg_loss: 67602.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58749.1758; val_chrom_access_recon_loss: 2573169.8750; val_global_loss: 22790427.7500; val_optim_loss: 22790427.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9311; val_auprc_score: 0.9050; val_best_acc_score: 0.8651; val_best_f1_score: 0.8717; train_kl_reg_loss: 57696.4944; train_edge_recon_loss: 728036.4669; train_gene_expr_recon_loss: 17848574.5152; train_masked_gp_l1_reg_loss: 67425.4444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56915.6487; train_chrom_access_recon_loss: 2567845.1818; train_global_loss: 21326493.9697; train_optim_loss: 21326493.9697; val_kl_reg_loss: 19685.4070; val_edge_recon_loss: 737646.1641; val_gene_expr_recon_loss: 17574651.0000; val_masked_gp_l1_reg_loss: 67352.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56549.5430; val_chrom_access_recon_loss: 2394276.8750; val_global_loss: 20850161.2500; val_optim_loss: 20850161.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9273; val_auprc_score: 0.9022; val_best_acc_score: 0.8600; val_best_f1_score: 0.8665; train_kl_reg_loss: 59431.3073; train_edge_recon_loss: 706625.7112; train_gene_expr_recon_loss: 17642357.5455; train_masked_gp_l1_reg_loss: 67175.7337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56418.5955; train_chrom_access_recon_loss: 2424327.8144; train_global_loss: 20956336.7576; train_optim_loss: 20956336.7576; val_kl_reg_loss: 23933.5461; val_edge_recon_loss: 747318.2109; val_gene_expr_recon_loss: 17598157.2500; val_masked_gp_l1_reg_loss: 66951.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56248.2891; val_chrom_access_recon_loss: 2362152.5000; val_global_loss: 20854761.7500; val_optim_loss: 20854761.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9261; val_auprc_score: 0.9003; val_best_acc_score: 0.8579; val_best_f1_score: 0.8653; train_kl_reg_loss: 56094.3435; train_edge_recon_loss: 705539.0379; train_gene_expr_recon_loss: 17617661.6818; train_masked_gp_l1_reg_loss: 66736.9672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56059.1316; train_chrom_access_recon_loss: 2409428.9583; train_global_loss: 20911520.1212; train_optim_loss: 20911520.1212; val_kl_reg_loss: 25285.5835; val_edge_recon_loss: 747438.9844; val_gene_expr_recon_loss: 17600359.7500; val_masked_gp_l1_reg_loss: 66518.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55867.5352; val_chrom_access_recon_loss: 2377553.8438; val_global_loss: 20873024.7500; val_optim_loss: 20873024.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9266; val_auprc_score: 0.9009; val_best_acc_score: 0.8579; val_best_f1_score: 0.8650; train_kl_reg_loss: 53360.5410; train_edge_recon_loss: 705387.2992; train_gene_expr_recon_loss: 17606439.6970; train_masked_gp_l1_reg_loss: 66290.2513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55694.6096; train_chrom_access_recon_loss: 2404435.3371; train_global_loss: 20891607.7273; train_optim_loss: 20891607.7273; val_kl_reg_loss: 25999.6182; val_edge_recon_loss: 745404.0469; val_gene_expr_recon_loss: 17664836.7500; val_masked_gp_l1_reg_loss: 66058.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55487.0273; val_chrom_access_recon_loss: 2377426.3750; val_global_loss: 20935212.7500; val_optim_loss: 20935212.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9168; val_auprc_score: 0.8850; val_best_acc_score: 0.8463; val_best_f1_score: 0.8566; train_kl_reg_loss: 50559.8878; train_edge_recon_loss: 704553.8684; train_gene_expr_recon_loss: 17587095.5606; train_masked_gp_l1_reg_loss: 65862.3840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55358.2576; train_chrom_access_recon_loss: 2398004.5076; train_global_loss: 20861434.6364; train_optim_loss: 20861434.6364; val_kl_reg_loss: 25158.2878; val_edge_recon_loss: 748936.3984; val_gene_expr_recon_loss: 17511525.5000; val_masked_gp_l1_reg_loss: 65652.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55200.4961; val_chrom_access_recon_loss: 2355827.9375; val_global_loss: 20762300.0000; val_optim_loss: 20762300.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9202; val_auprc_score: 0.8990; val_best_acc_score: 0.8482; val_best_f1_score: 0.8576; train_kl_reg_loss: 48558.7480; train_edge_recon_loss: 703699.6648; train_gene_expr_recon_loss: 17576749.3333; train_masked_gp_l1_reg_loss: 65433.3024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55027.1899; train_chrom_access_recon_loss: 2395335.1742; train_global_loss: 20844803.5152; train_optim_loss: 20844803.5152; val_kl_reg_loss: 23912.5630; val_edge_recon_loss: 745137.7891; val_gene_expr_recon_loss: 17760349.2500; val_masked_gp_l1_reg_loss: 65229.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54873.5234; val_chrom_access_recon_loss: 2362744.2500; val_global_loss: 21012248.0000; val_optim_loss: 21012248.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9228; val_auprc_score: 0.9032; val_best_acc_score: 0.8571; val_best_f1_score: 0.8634; train_kl_reg_loss: 47332.2676; train_edge_recon_loss: 701496.4972; train_gene_expr_recon_loss: 17578908.8485; train_masked_gp_l1_reg_loss: 65023.5378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54713.3932; train_chrom_access_recon_loss: 2396152.9432; train_global_loss: 20843627.7576; train_optim_loss: 20843627.7576; val_kl_reg_loss: 24429.5386; val_edge_recon_loss: 740768.2266; val_gene_expr_recon_loss: 17532680.1250; val_masked_gp_l1_reg_loss: 64812.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54541.6367; val_chrom_access_recon_loss: 2351416.7812; val_global_loss: 20768648.5000; val_optim_loss: 20768648.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9240; val_auprc_score: 0.9053; val_best_acc_score: 0.8571; val_best_f1_score: 0.8650; train_kl_reg_loss: 46935.9900; train_edge_recon_loss: 698837.3343; train_gene_expr_recon_loss: 17555361.1515; train_masked_gp_l1_reg_loss: 64595.3082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54366.1673; train_chrom_access_recon_loss: 2391993.5871; train_global_loss: 20812089.6061; train_optim_loss: 20812089.6061; val_kl_reg_loss: 24101.7380; val_edge_recon_loss: 737734.6797; val_gene_expr_recon_loss: 17633864.7500; val_masked_gp_l1_reg_loss: 64384.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54194.8789; val_chrom_access_recon_loss: 2354347.0938; val_global_loss: 20868625.7500; val_optim_loss: 20868625.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9245; val_auprc_score: 0.9016; val_best_acc_score: 0.8581; val_best_f1_score: 0.8653; train_kl_reg_loss: 45510.2377; train_edge_recon_loss: 697507.1610; train_gene_expr_recon_loss: 17562802.0303; train_masked_gp_l1_reg_loss: 64177.2044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54016.9624; train_chrom_access_recon_loss: 2391822.3333; train_global_loss: 20815836.0303; train_optim_loss: 20815836.0303; val_kl_reg_loss: 24439.4902; val_edge_recon_loss: 735189.0547; val_gene_expr_recon_loss: 17559347.2500; val_masked_gp_l1_reg_loss: 63969.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53831.5586; val_chrom_access_recon_loss: 2365678.2812; val_global_loss: 20802455.2500; val_optim_loss: 20802455.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9193; val_auprc_score: 0.8935; val_best_acc_score: 0.8544; val_best_f1_score: 0.8617; train_kl_reg_loss: 44818.6831; train_edge_recon_loss: 695281.6515; train_gene_expr_recon_loss: 17549314.7576; train_masked_gp_l1_reg_loss: 63931.0339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52997.5707; train_chrom_access_recon_loss: 2388503.7197; train_global_loss: 20794847.3030; train_optim_loss: 20794847.3030; val_kl_reg_loss: 23968.5559; val_edge_recon_loss: 735995.5078; val_gene_expr_recon_loss: 17626350.0000; val_masked_gp_l1_reg_loss: 63901.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52802.0469; val_chrom_access_recon_loss: 2352520.9062; val_global_loss: 20855539.0000; val_optim_loss: 20855539.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9196; val_auprc_score: 0.8941; val_best_acc_score: 0.8568; val_best_f1_score: 0.8626; train_kl_reg_loss: 44531.6921; train_edge_recon_loss: 695696.2907; train_gene_expr_recon_loss: 17562973.4848; train_masked_gp_l1_reg_loss: 63875.3735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52754.3335; train_chrom_access_recon_loss: 2391213.9356; train_global_loss: 20811045.0606; train_optim_loss: 20811045.0606; val_kl_reg_loss: 24354.3616; val_edge_recon_loss: 734383.0078; val_gene_expr_recon_loss: 17601902.5000; val_masked_gp_l1_reg_loss: 63850.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52711.3047; val_chrom_access_recon_loss: 2386083.5000; val_global_loss: 20863285.0000; val_optim_loss: 20863285.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9288; val_auprc_score: 0.9109; val_best_acc_score: 0.8592; val_best_f1_score: 0.8697; train_kl_reg_loss: 44751.3603; train_edge_recon_loss: 694538.7396; train_gene_expr_recon_loss: 17546535.6970; train_masked_gp_l1_reg_loss: 63828.6404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52678.8752; train_chrom_access_recon_loss: 2387935.1629; train_global_loss: 20790268.5455; train_optim_loss: 20790268.5455; val_kl_reg_loss: 24311.0908; val_edge_recon_loss: 732302.6641; val_gene_expr_recon_loss: 17563584.2500; val_masked_gp_l1_reg_loss: 63803.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52640.9727; val_chrom_access_recon_loss: 2355408.5938; val_global_loss: 20792050.7500; val_optim_loss: 20792050.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9196; val_auprc_score: 0.8947; val_best_acc_score: 0.8525; val_best_f1_score: 0.8603; train_kl_reg_loss: 44688.0050; train_edge_recon_loss: 694747.1809; train_gene_expr_recon_loss: 17548471.5303; train_masked_gp_l1_reg_loss: 63779.5497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52611.9051; train_chrom_access_recon_loss: 2389931.0682; train_global_loss: 20794229.0000; train_optim_loss: 20794229.0000; val_kl_reg_loss: 24389.5044; val_edge_recon_loss: 733454.4844; val_gene_expr_recon_loss: 17485301.0000; val_masked_gp_l1_reg_loss: 63754.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52580.7773; val_chrom_access_recon_loss: 2354274.6875; val_global_loss: 20713754.2500; val_optim_loss: 20713754.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9169; val_auprc_score: 0.8880; val_best_acc_score: 0.8520; val_best_f1_score: 0.8624; train_kl_reg_loss: 44457.6509; train_edge_recon_loss: 695357.7633; train_gene_expr_recon_loss: 17549133.1515; train_masked_gp_l1_reg_loss: 63732.5576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52556.5092; train_chrom_access_recon_loss: 2386800.4280; train_global_loss: 20792037.9697; train_optim_loss: 20792037.9697; val_kl_reg_loss: 24187.3381; val_edge_recon_loss: 732140.7422; val_gene_expr_recon_loss: 17555904.0000; val_masked_gp_l1_reg_loss: 63708.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52532.9805; val_chrom_access_recon_loss: 2351123.9062; val_global_loss: 20779595.5000; val_optim_loss: 20779595.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9246; val_auprc_score: 0.9064; val_best_acc_score: 0.8536; val_best_f1_score: 0.8642; train_kl_reg_loss: 44452.8886; train_edge_recon_loss: 694309.5871; train_gene_expr_recon_loss: 17553575.3636; train_masked_gp_l1_reg_loss: 63684.7669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52505.1313; train_chrom_access_recon_loss: 2389398.7727; train_global_loss: 20797926.5152; train_optim_loss: 20797926.5152; val_kl_reg_loss: 24319.5720; val_edge_recon_loss: 730828.0078; val_gene_expr_recon_loss: 17618186.7500; val_masked_gp_l1_reg_loss: 63659.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52478.1328; val_chrom_access_recon_loss: 2358454.5312; val_global_loss: 20847927.2500; val_optim_loss: 20847927.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9270; val_auprc_score: 0.9057; val_best_acc_score: 0.8576; val_best_f1_score: 0.8667; train_kl_reg_loss: 44385.4548; train_edge_recon_loss: 694974.4205; train_gene_expr_recon_loss: 17569130.1212; train_masked_gp_l1_reg_loss: 63635.5476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52460.3746; train_chrom_access_recon_loss: 2391627.2348; train_global_loss: 20816213.0909; train_optim_loss: 20816213.0909; val_kl_reg_loss: 24095.8218; val_edge_recon_loss: 729852.7891; val_gene_expr_recon_loss: 17649287.2500; val_masked_gp_l1_reg_loss: 63610.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52436.5625; val_chrom_access_recon_loss: 2352451.1562; val_global_loss: 20871732.5000; val_optim_loss: 20871732.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9252; val_auprc_score: 0.9042; val_best_acc_score: 0.8538; val_best_f1_score: 0.8633; train_kl_reg_loss: 44155.2893; train_edge_recon_loss: 694513.0388; train_gene_expr_recon_loss: 17533336.7576; train_masked_gp_l1_reg_loss: 63587.1987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52418.7110; train_chrom_access_recon_loss: 2388843.5076; train_global_loss: 20776854.6970; train_optim_loss: 20776854.6970; val_kl_reg_loss: 24059.4502; val_edge_recon_loss: 731427.9844; val_gene_expr_recon_loss: 17393623.5000; val_masked_gp_l1_reg_loss: 63561.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52391.5000; val_chrom_access_recon_loss: 2335768.5312; val_global_loss: 20600833.0000; val_optim_loss: 20600833.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9249; val_auprc_score: 0.9024; val_best_acc_score: 0.8587; val_best_f1_score: 0.8677; train_kl_reg_loss: 43996.3627; train_edge_recon_loss: 695369.8191; train_gene_expr_recon_loss: 17553977.4242; train_masked_gp_l1_reg_loss: 63535.6866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52369.9779; train_chrom_access_recon_loss: 2389720.2197; train_global_loss: 20798969.3636; train_optim_loss: 20798969.3636; val_kl_reg_loss: 23735.8723; val_edge_recon_loss: 726414.6875; val_gene_expr_recon_loss: 17677615.0000; val_masked_gp_l1_reg_loss: 63509.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52347.7578; val_chrom_access_recon_loss: 2365058.7188; val_global_loss: 20908682.2500; val_optim_loss: 20908682.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9194; val_auprc_score: 0.8902; val_best_acc_score: 0.8528; val_best_f1_score: 0.8615; train_kl_reg_loss: 43906.6592; train_edge_recon_loss: 693798.3011; train_gene_expr_recon_loss: 17546922.1515; train_masked_gp_l1_reg_loss: 63484.1839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52327.1568; train_chrom_access_recon_loss: 2388167.0265; train_global_loss: 20788605.3333; train_optim_loss: 20788605.3333; val_kl_reg_loss: 24107.7898; val_edge_recon_loss: 732376.0234; val_gene_expr_recon_loss: 17627824.5000; val_masked_gp_l1_reg_loss: 63457.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52302.3633; val_chrom_access_recon_loss: 2367110.6875; val_global_loss: 20867178.7500; val_optim_loss: 20867178.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9208; val_auprc_score: 0.8995; val_best_acc_score: 0.8525; val_best_f1_score: 0.8610; train_kl_reg_loss: 43943.1042; train_edge_recon_loss: 692806.2102; train_gene_expr_recon_loss: 17548745.9545; train_masked_gp_l1_reg_loss: 63431.6518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52281.4819; train_chrom_access_recon_loss: 2389951.7273; train_global_loss: 20791160.1212; train_optim_loss: 20791160.1212; val_kl_reg_loss: 24215.2661; val_edge_recon_loss: 731990.9141; val_gene_expr_recon_loss: 17580736.5000; val_masked_gp_l1_reg_loss: 63403.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52254.1680; val_chrom_access_recon_loss: 2371373.5312; val_global_loss: 20823974.5000; val_optim_loss: 20823974.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9190; val_auprc_score: 0.8977; val_best_acc_score: 0.8501; val_best_f1_score: 0.8601; train_kl_reg_loss: 44044.8387; train_edge_recon_loss: 692139.2699; train_gene_expr_recon_loss: 17556917.0152; train_masked_gp_l1_reg_loss: 63377.3046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52238.7817; train_chrom_access_recon_loss: 2388656.2348; train_global_loss: 20797373.4545; train_optim_loss: 20797373.4545; val_kl_reg_loss: 24365.3240; val_edge_recon_loss: 730641.0312; val_gene_expr_recon_loss: 17704712.5000; val_masked_gp_l1_reg_loss: 63349.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52216.6289; val_chrom_access_recon_loss: 2363690.0312; val_global_loss: 20938975.0000; val_optim_loss: 20938975.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9222; val_auprc_score: 0.9049; val_best_acc_score: 0.8541; val_best_f1_score: 0.8621; train_kl_reg_loss: 43924.1275; train_edge_recon_loss: 693249.8883; train_gene_expr_recon_loss: 17549371.8788; train_masked_gp_l1_reg_loss: 63344.7982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52124.7552; train_chrom_access_recon_loss: 2389789.4470; train_global_loss: 20791804.8788; train_optim_loss: 20791804.8788; val_kl_reg_loss: 24235.0251; val_edge_recon_loss: 730714.4609; val_gene_expr_recon_loss: 17536392.5000; val_masked_gp_l1_reg_loss: 63341.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52104.7422; val_chrom_access_recon_loss: 2360934.1250; val_global_loss: 20767722.0000; val_optim_loss: 20767722.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9295; val_auprc_score: 0.9121; val_best_acc_score: 0.8616; val_best_f1_score: 0.8657; train_kl_reg_loss: 43926.9843; train_edge_recon_loss: 692477.8248; train_gene_expr_recon_loss: 17559275.4242; train_masked_gp_l1_reg_loss: 63337.8633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52100.4602; train_chrom_access_recon_loss: 2391425.2992; train_global_loss: 20802543.9394; train_optim_loss: 20802543.9394; val_kl_reg_loss: 24211.5288; val_edge_recon_loss: 728521.1875; val_gene_expr_recon_loss: 17627998.5000; val_masked_gp_l1_reg_loss: 63334.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52096.6562; val_chrom_access_recon_loss: 2372907.6562; val_global_loss: 20869068.7500; val_optim_loss: 20869068.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9251; val_auprc_score: 0.8981; val_best_acc_score: 0.8579; val_best_f1_score: 0.8659; train_kl_reg_loss: 43922.0767; train_edge_recon_loss: 693207.6222; train_gene_expr_recon_loss: 17546295.2727; train_masked_gp_l1_reg_loss: 63331.7183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52093.3631; train_chrom_access_recon_loss: 2387593.7955; train_global_loss: 20786443.8788; train_optim_loss: 20786443.8788; val_kl_reg_loss: 24193.0237; val_edge_recon_loss: 728315.2734; val_gene_expr_recon_loss: 17537542.5000; val_masked_gp_l1_reg_loss: 63328.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52089.6875; val_chrom_access_recon_loss: 2366263.4375; val_global_loss: 20771732.2500; val_optim_loss: 20771732.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9276; val_auprc_score: 0.9106; val_best_acc_score: 0.8579; val_best_f1_score: 0.8651; train_kl_reg_loss: 43862.8046; train_edge_recon_loss: 692021.8712; train_gene_expr_recon_loss: 17548074.8182; train_masked_gp_l1_reg_loss: 63325.3960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52087.0204; train_chrom_access_recon_loss: 2389349.8523; train_global_loss: 20788721.7273; train_optim_loss: 20788721.7273; val_kl_reg_loss: 24238.7544; val_edge_recon_loss: 726382.2344; val_gene_expr_recon_loss: 17605207.7500; val_masked_gp_l1_reg_loss: 63322.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52084.0117; val_chrom_access_recon_loss: 2372313.5312; val_global_loss: 20843548.2500; val_optim_loss: 20843548.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 58 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9176
val AUPRC score: 0.8944
val best accuracy score: 0.8487
val best F1 score: 0.8586
val target rna MSE score: 2.1181
val source rna MSE score: 1.1175
val target atac MSE score: 0.4680
val source atac MSE score: 0.1964
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
