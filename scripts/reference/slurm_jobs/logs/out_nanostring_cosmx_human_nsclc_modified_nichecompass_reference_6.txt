[True, False]
Run timestamp: 01092023_182943_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_modified', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 126882
Number of validation nodes: 14098
Number of training edges: 300588
Number of validation edges: 33398
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9159; val_auprc_score: 0.9571; val_best_acc_score: 0.8573; val_best_f1_score: 0.9005; train_kl_reg_loss: 27168.5817; train_edge_recon_loss: 1959262.1733; train_cat_covariates_contrastive_loss: 651103.5268; train_gene_expr_recon_loss: 2955923.0425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207818.6876; train_global_loss: 5801276.0034; train_optim_loss: 5801276.0034; val_kl_reg_loss: 20409.1723; val_edge_recon_loss: 1885227.5019; val_cat_covariates_contrastive_loss: 647637.1439; val_gene_expr_recon_loss: 2744087.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18090.9434; val_global_loss: 5315452.5985; val_optim_loss: 5315452.5985
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9347; val_auprc_score: 0.9655; val_best_acc_score: 0.8801; val_best_f1_score: 0.9153; train_kl_reg_loss: 19020.1660; train_edge_recon_loss: 1802570.1401; train_cat_covariates_contrastive_loss: 646471.7478; train_gene_expr_recon_loss: 2665882.8308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16203.2087; train_global_loss: 5150148.0978; train_optim_loss: 5150148.0978; val_kl_reg_loss: 18416.0587; val_edge_recon_loss: 1854539.7311; val_cat_covariates_contrastive_loss: 644459.4706; val_gene_expr_recon_loss: 2597027.8258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15263.8223; val_global_loss: 5129707.0909; val_optim_loss: 5129707.0909
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9461; val_auprc_score: 0.9714; val_best_acc_score: 0.8915; val_best_f1_score: 0.9228; train_kl_reg_loss: 19945.5521; train_edge_recon_loss: 1790453.7815; train_cat_covariates_contrastive_loss: 645438.0055; train_gene_expr_recon_loss: 2519549.8465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15109.9141; train_global_loss: 4990497.1003; train_optim_loss: 4990497.1003; val_kl_reg_loss: 20311.4386; val_edge_recon_loss: 1844519.0246; val_cat_covariates_contrastive_loss: 646762.8684; val_gene_expr_recon_loss: 2447042.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14829.6348; val_global_loss: 4973465.3485; val_optim_loss: 4973465.3485
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9429; val_auprc_score: 0.9690; val_best_acc_score: 0.8940; val_best_f1_score: 0.9249; train_kl_reg_loss: 21640.1214; train_edge_recon_loss: 1783390.5442; train_cat_covariates_contrastive_loss: 645892.6868; train_gene_expr_recon_loss: 2374531.9494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15088.1448; train_global_loss: 4840543.4490; train_optim_loss: 4840543.4490; val_kl_reg_loss: 22816.3421; val_edge_recon_loss: 1831261.1629; val_cat_covariates_contrastive_loss: 641305.7273; val_gene_expr_recon_loss: 2322236.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15047.8037; val_global_loss: 4832667.6818; val_optim_loss: 4832667.6818
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9518; val_auprc_score: 0.9723; val_best_acc_score: 0.9034; val_best_f1_score: 0.9311; train_kl_reg_loss: 23040.0951; train_edge_recon_loss: 1778838.9764; train_cat_covariates_contrastive_loss: 645364.2932; train_gene_expr_recon_loss: 2258259.1276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15193.2638; train_global_loss: 4720695.7526; train_optim_loss: 4720695.7526; val_kl_reg_loss: 24549.1366; val_edge_recon_loss: 1823636.8826; val_cat_covariates_contrastive_loss: 645222.9659; val_gene_expr_recon_loss: 2220742.6136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15289.5645; val_global_loss: 4729441.1061; val_optim_loss: 4729441.1061
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9509; val_auprc_score: 0.9727; val_best_acc_score: 0.9036; val_best_f1_score: 0.9318; train_kl_reg_loss: 24060.5320; train_edge_recon_loss: 1776524.1949; train_cat_covariates_contrastive_loss: 645931.8546; train_gene_expr_recon_loss: 2171863.7568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15418.6305; train_global_loss: 4633798.9668; train_optim_loss: 4633798.9668; val_kl_reg_loss: 26552.0485; val_edge_recon_loss: 1819284.8826; val_cat_covariates_contrastive_loss: 642043.5265; val_gene_expr_recon_loss: 2149426.0720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15463.5605; val_global_loss: 4652770.0455; val_optim_loss: 4652770.0455
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9514; val_auprc_score: 0.9738; val_best_acc_score: 0.9028; val_best_f1_score: 0.9309; train_kl_reg_loss: 24755.4944; train_edge_recon_loss: 1773760.3882; train_cat_covariates_contrastive_loss: 646068.2152; train_gene_expr_recon_loss: 2105349.1552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15484.6070; train_global_loss: 4565417.8733; train_optim_loss: 4565417.8733; val_kl_reg_loss: 25689.7675; val_edge_recon_loss: 1809858.2367; val_cat_covariates_contrastive_loss: 644667.4110; val_gene_expr_recon_loss: 2090978.2822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15599.2627; val_global_loss: 4586793.1667; val_optim_loss: 4586793.1667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9544; val_auprc_score: 0.9749; val_best_acc_score: 0.9103; val_best_f1_score: 0.9363; train_kl_reg_loss: 25171.9030; train_edge_recon_loss: 1772665.1180; train_cat_covariates_contrastive_loss: 646508.0587; train_gene_expr_recon_loss: 2055394.1399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15565.2653; train_global_loss: 4515304.4796; train_optim_loss: 4515304.4796; val_kl_reg_loss: 25913.7090; val_edge_recon_loss: 1828216.5795; val_cat_covariates_contrastive_loss: 644776.5303; val_gene_expr_recon_loss: 2058270.6553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15645.5410; val_global_loss: 4572822.9394; val_optim_loss: 4572822.9394
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9585; val_auprc_score: 0.9773; val_best_acc_score: 0.9121; val_best_f1_score: 0.9371; train_kl_reg_loss: 25601.3762; train_edge_recon_loss: 1770217.3068; train_cat_covariates_contrastive_loss: 646353.9638; train_gene_expr_recon_loss: 2021251.8119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15668.2059; train_global_loss: 4479092.6709; train_optim_loss: 4479092.6709; val_kl_reg_loss: 26296.4070; val_edge_recon_loss: 1814671.4697; val_cat_covariates_contrastive_loss: 645684.9157; val_gene_expr_recon_loss: 2024481.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15694.8086; val_global_loss: 4526829.2273; val_optim_loss: 4526829.2273
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9608; val_auprc_score: 0.9780; val_best_acc_score: 0.9148; val_best_f1_score: 0.9392; train_kl_reg_loss: 25856.0139; train_edge_recon_loss: 1769193.7130; train_cat_covariates_contrastive_loss: 645777.6571; train_gene_expr_recon_loss: 1995278.1046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15792.1957; train_global_loss: 4451897.6862; train_optim_loss: 4451897.6862; val_kl_reg_loss: 26796.8694; val_edge_recon_loss: 1818359.3030; val_cat_covariates_contrastive_loss: 645639.6752; val_gene_expr_recon_loss: 2005224.0473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15861.0547; val_global_loss: 4511880.9015; val_optim_loss: 4511880.9015
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9605; val_auprc_score: 0.9772; val_best_acc_score: 0.9179; val_best_f1_score: 0.9414; train_kl_reg_loss: 26284.2395; train_edge_recon_loss: 1770219.1463; train_cat_covariates_contrastive_loss: 645465.3428; train_gene_expr_recon_loss: 1973319.2175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15963.2958; train_global_loss: 4431251.2423; train_optim_loss: 4431251.2423; val_kl_reg_loss: 25663.5002; val_edge_recon_loss: 1815399.5511; val_cat_covariates_contrastive_loss: 646116.9811; val_gene_expr_recon_loss: 1993220.8504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15839.2871; val_global_loss: 4496240.4015; val_optim_loss: 4496240.4015
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9612; val_auprc_score: 0.9777; val_best_acc_score: 0.9181; val_best_f1_score: 0.9415; train_kl_reg_loss: 26423.4406; train_edge_recon_loss: 1765832.5899; train_cat_covariates_contrastive_loss: 645166.7141; train_gene_expr_recon_loss: 1954870.4056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16148.7682; train_global_loss: 4408441.9222; train_optim_loss: 4408441.9222; val_kl_reg_loss: 26308.6611; val_edge_recon_loss: 1812358.7955; val_cat_covariates_contrastive_loss: 645987.1922; val_gene_expr_recon_loss: 1972437.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16198.9824; val_global_loss: 4473290.7273; val_optim_loss: 4473290.7273
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9628; val_auprc_score: 0.9786; val_best_acc_score: 0.9221; val_best_f1_score: 0.9441; train_kl_reg_loss: 26447.5641; train_edge_recon_loss: 1764636.0117; train_cat_covariates_contrastive_loss: 644252.6993; train_gene_expr_recon_loss: 1944511.3212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16317.7789; train_global_loss: 4396165.3946; train_optim_loss: 4396165.3946; val_kl_reg_loss: 27308.8539; val_edge_recon_loss: 1798739.3864; val_cat_covariates_contrastive_loss: 643628.2803; val_gene_expr_recon_loss: 1967317.4981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16329.5840; val_global_loss: 4453323.5152; val_optim_loss: 4453323.5152
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9652; val_auprc_score: 0.9804; val_best_acc_score: 0.9231; val_best_f1_score: 0.9450; train_kl_reg_loss: 26638.1565; train_edge_recon_loss: 1763022.0563; train_cat_covariates_contrastive_loss: 644051.0325; train_gene_expr_recon_loss: 1933766.5130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16330.3360; train_global_loss: 4383808.0940; train_optim_loss: 4383808.0940; val_kl_reg_loss: 25758.5355; val_edge_recon_loss: 1798680.4432; val_cat_covariates_contrastive_loss: 647107.2992; val_gene_expr_recon_loss: 1955438.8371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16394.1797; val_global_loss: 4443379.0833; val_optim_loss: 4443379.0833
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9651; val_auprc_score: 0.9798; val_best_acc_score: 0.9234; val_best_f1_score: 0.9448; train_kl_reg_loss: 26881.0781; train_edge_recon_loss: 1763605.9643; train_cat_covariates_contrastive_loss: 644042.2426; train_gene_expr_recon_loss: 1921637.4339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16399.1089; train_global_loss: 4372565.8265; train_optim_loss: 4372565.8265; val_kl_reg_loss: 26306.9397; val_edge_recon_loss: 1804676.4451; val_cat_covariates_contrastive_loss: 647271.7102; val_gene_expr_recon_loss: 1943719.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16567.5254; val_global_loss: 4438542.4773; val_optim_loss: 4438542.4773
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9622; val_auprc_score: 0.9777; val_best_acc_score: 0.9225; val_best_f1_score: 0.9446; train_kl_reg_loss: 26804.1558; train_edge_recon_loss: 1764588.6924; train_cat_covariates_contrastive_loss: 643529.3354; train_gene_expr_recon_loss: 1910633.5004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16448.9256; train_global_loss: 4362004.6190; train_optim_loss: 4362004.6190; val_kl_reg_loss: 26898.4692; val_edge_recon_loss: 1806932.6591; val_cat_covariates_contrastive_loss: 643797.3030; val_gene_expr_recon_loss: 1942775.2784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16309.2666; val_global_loss: 4436713.2045; val_optim_loss: 4436713.2045
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9649; val_auprc_score: 0.9793; val_best_acc_score: 0.9252; val_best_f1_score: 0.9461; train_kl_reg_loss: 27009.5373; train_edge_recon_loss: 1763694.6412; train_cat_covariates_contrastive_loss: 643909.2118; train_gene_expr_recon_loss: 1908467.5614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16465.5733; train_global_loss: 4359546.5217; train_optim_loss: 4359546.5217; val_kl_reg_loss: 27791.0214; val_edge_recon_loss: 1799253.0644; val_cat_covariates_contrastive_loss: 642248.3068; val_gene_expr_recon_loss: 1930888.3826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16481.2402; val_global_loss: 4416661.7917; val_optim_loss: 4416661.7917
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9592; val_auprc_score: 0.9752; val_best_acc_score: 0.9205; val_best_f1_score: 0.9430; train_kl_reg_loss: 27118.5383; train_edge_recon_loss: 1762067.0589; train_cat_covariates_contrastive_loss: 644046.1648; train_gene_expr_recon_loss: 1901973.8314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16485.9887; train_global_loss: 4351691.5863; train_optim_loss: 4351691.5863; val_kl_reg_loss: 29307.5189; val_edge_recon_loss: 1815803.3636; val_cat_covariates_contrastive_loss: 641910.0256; val_gene_expr_recon_loss: 1940606.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16367.7803; val_global_loss: 4443995.2879; val_optim_loss: 4443995.2879
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9643; val_auprc_score: 0.9788; val_best_acc_score: 0.9283; val_best_f1_score: 0.9487; train_kl_reg_loss: 27156.9528; train_edge_recon_loss: 1761564.8988; train_cat_covariates_contrastive_loss: 643692.9041; train_gene_expr_recon_loss: 1893489.6386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16511.2853; train_global_loss: 4342415.6849; train_optim_loss: 4342415.6849; val_kl_reg_loss: 27844.1380; val_edge_recon_loss: 1810271.5739; val_cat_covariates_contrastive_loss: 641970.3854; val_gene_expr_recon_loss: 1925708.8561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16604.3125; val_global_loss: 4422399.4621; val_optim_loss: 4422399.4621
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9695; val_auprc_score: 0.9817; val_best_acc_score: 0.9293; val_best_f1_score: 0.9493; train_kl_reg_loss: 27037.4367; train_edge_recon_loss: 1765077.5487; train_cat_covariates_contrastive_loss: 642659.7538; train_gene_expr_recon_loss: 1888060.1788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16536.8918; train_global_loss: 4339371.7989; train_optim_loss: 4339371.7989; val_kl_reg_loss: 27080.9465; val_edge_recon_loss: 1791721.8314; val_cat_covariates_contrastive_loss: 647388.7907; val_gene_expr_recon_loss: 1919230.7121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16627.2617; val_global_loss: 4402049.7424; val_optim_loss: 4402049.7424
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9678; val_auprc_score: 0.9813; val_best_acc_score: 0.9262; val_best_f1_score: 0.9469; train_kl_reg_loss: 27136.6547; train_edge_recon_loss: 1762654.6037; train_cat_covariates_contrastive_loss: 642870.2802; train_gene_expr_recon_loss: 1887239.1220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16591.5292; train_global_loss: 4336492.1896; train_optim_loss: 4336492.1896; val_kl_reg_loss: 25948.4500; val_edge_recon_loss: 1806532.4848; val_cat_covariates_contrastive_loss: 646857.9129; val_gene_expr_recon_loss: 1931169.8788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16819.7656; val_global_loss: 4427328.7348; val_optim_loss: 4427328.7348
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9677; val_auprc_score: 0.9804; val_best_acc_score: 0.9302; val_best_f1_score: 0.9499; train_kl_reg_loss: 27330.4245; train_edge_recon_loss: 1763560.9239; train_cat_covariates_contrastive_loss: 642916.0652; train_gene_expr_recon_loss: 1882314.8367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16600.7440; train_global_loss: 4332722.9915; train_optim_loss: 4332722.9915; val_kl_reg_loss: 28713.7666; val_edge_recon_loss: 1798067.3125; val_cat_covariates_contrastive_loss: 641912.1477; val_gene_expr_recon_loss: 1914899.7576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16533.7324; val_global_loss: 4400126.5076; val_optim_loss: 4400126.5076
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9669; val_auprc_score: 0.9805; val_best_acc_score: 0.9304; val_best_f1_score: 0.9502; train_kl_reg_loss: 27275.0484; train_edge_recon_loss: 1762886.3106; train_cat_covariates_contrastive_loss: 643287.3508; train_gene_expr_recon_loss: 1875364.7336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16636.2692; train_global_loss: 4325449.7198; train_optim_loss: 4325449.7198; val_kl_reg_loss: 28033.4882; val_edge_recon_loss: 1783887.1326; val_cat_covariates_contrastive_loss: 642546.0237; val_gene_expr_recon_loss: 1917765.4280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16769.8438; val_global_loss: 4389002.0833; val_optim_loss: 4389002.0833
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9644; val_auprc_score: 0.9788; val_best_acc_score: 0.9275; val_best_f1_score: 0.9481; train_kl_reg_loss: 27430.1169; train_edge_recon_loss: 1761998.2687; train_cat_covariates_contrastive_loss: 642848.4208; train_gene_expr_recon_loss: 1874970.8946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16710.6284; train_global_loss: 4323958.3363; train_optim_loss: 4323958.3363; val_kl_reg_loss: 28299.7173; val_edge_recon_loss: 1778552.7992; val_cat_covariates_contrastive_loss: 641173.7831; val_gene_expr_recon_loss: 1916425.9735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16904.2812; val_global_loss: 4381356.7614; val_optim_loss: 4381356.7614
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9672; val_auprc_score: 0.9809; val_best_acc_score: 0.9282; val_best_f1_score: 0.9482; train_kl_reg_loss: 27552.6975; train_edge_recon_loss: 1759944.6745; train_cat_covariates_contrastive_loss: 642806.5927; train_gene_expr_recon_loss: 1872283.6605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16813.7210; train_global_loss: 4319401.3418; train_optim_loss: 4319401.3418; val_kl_reg_loss: 27532.4815; val_edge_recon_loss: 1802332.0833; val_cat_covariates_contrastive_loss: 642747.9025; val_gene_expr_recon_loss: 1916083.8068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16802.3223; val_global_loss: 4405498.7576; val_optim_loss: 4405498.7576
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9681; val_auprc_score: 0.9811; val_best_acc_score: 0.9313; val_best_f1_score: 0.9506; train_kl_reg_loss: 27484.3886; train_edge_recon_loss: 1761127.0946; train_cat_covariates_contrastive_loss: 642984.2369; train_gene_expr_recon_loss: 1867447.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16884.8850; train_global_loss: 4315928.3695; train_optim_loss: 4315928.3695; val_kl_reg_loss: 27733.6388; val_edge_recon_loss: 1787495.7727; val_cat_covariates_contrastive_loss: 641560.2831; val_gene_expr_recon_loss: 1906176.4186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16833.3164; val_global_loss: 4379799.6098; val_optim_loss: 4379799.6098
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9702; val_auprc_score: 0.9817; val_best_acc_score: 0.9341; val_best_f1_score: 0.9527; train_kl_reg_loss: 27469.0839; train_edge_recon_loss: 1759645.0512; train_cat_covariates_contrastive_loss: 642861.1508; train_gene_expr_recon_loss: 1861775.6490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16972.9320; train_global_loss: 4308723.8767; train_optim_loss: 4308723.8767; val_kl_reg_loss: 27489.3793; val_edge_recon_loss: 1790917.1799; val_cat_covariates_contrastive_loss: 644698.1013; val_gene_expr_recon_loss: 1917151.5341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17050.1875; val_global_loss: 4397306.2045; val_optim_loss: 4397306.2045
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9704; val_auprc_score: 0.9822; val_best_acc_score: 0.9335; val_best_f1_score: 0.9525; train_kl_reg_loss: 27745.5285; train_edge_recon_loss: 1762762.5125; train_cat_covariates_contrastive_loss: 642806.3159; train_gene_expr_recon_loss: 1862676.5529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17005.0573; train_global_loss: 4312995.9507; train_optim_loss: 4312995.9507; val_kl_reg_loss: 27491.5787; val_edge_recon_loss: 1786661.3807; val_cat_covariates_contrastive_loss: 645634.5426; val_gene_expr_recon_loss: 1903065.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16932.9824; val_global_loss: 4379785.8144; val_optim_loss: 4379785.8144
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9698; val_auprc_score: 0.9817; val_best_acc_score: 0.9334; val_best_f1_score: 0.9521; train_kl_reg_loss: 27611.1424; train_edge_recon_loss: 1760376.5672; train_cat_covariates_contrastive_loss: 642321.1417; train_gene_expr_recon_loss: 1854555.3017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17052.6501; train_global_loss: 4301916.7980; train_optim_loss: 4301916.7980; val_kl_reg_loss: 27062.4442; val_edge_recon_loss: 1796616.8750; val_cat_covariates_contrastive_loss: 644432.4508; val_gene_expr_recon_loss: 1894188.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17129.4258; val_global_loss: 4379430.0455; val_optim_loss: 4379430.0455
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9700; val_auprc_score: 0.9821; val_best_acc_score: 0.9334; val_best_f1_score: 0.9520; train_kl_reg_loss: 27624.7509; train_edge_recon_loss: 1761369.4018; train_cat_covariates_contrastive_loss: 642436.8865; train_gene_expr_recon_loss: 1858561.1988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17075.2086; train_global_loss: 4307067.4507; train_optim_loss: 4307067.4507; val_kl_reg_loss: 27095.2539; val_edge_recon_loss: 1794979.9924; val_cat_covariates_contrastive_loss: 643425.6288; val_gene_expr_recon_loss: 1902639.2121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17090.7715; val_global_loss: 4385231.1061; val_optim_loss: 4385231.1061
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9691; val_auprc_score: 0.9814; val_best_acc_score: 0.9327; val_best_f1_score: 0.9515; train_kl_reg_loss: 27768.2319; train_edge_recon_loss: 1758639.1575; train_cat_covariates_contrastive_loss: 642480.6023; train_gene_expr_recon_loss: 1851689.3191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17133.1216; train_global_loss: 4297710.4435; train_optim_loss: 4297710.4435; val_kl_reg_loss: 27610.0473; val_edge_recon_loss: 1797880.7405; val_cat_covariates_contrastive_loss: 643487.7235; val_gene_expr_recon_loss: 1897154.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17009.0059; val_global_loss: 4383141.7083; val_optim_loss: 4383141.7083
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9655; val_auprc_score: 0.9790; val_best_acc_score: 0.9307; val_best_f1_score: 0.9503; train_kl_reg_loss: 27588.0315; train_edge_recon_loss: 1753964.9955; train_cat_covariates_contrastive_loss: 641897.2650; train_gene_expr_recon_loss: 1846071.7253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17120.4356; train_global_loss: 4286642.4503; train_optim_loss: 4286642.4503; val_kl_reg_loss: 29807.3245; val_edge_recon_loss: 1795016.7367; val_cat_covariates_contrastive_loss: 639468.7396; val_gene_expr_recon_loss: 1902733.3068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17121.6230; val_global_loss: 4384147.6061; val_optim_loss: 4384147.6061
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9681; val_auprc_score: 0.9810; val_best_acc_score: 0.9314; val_best_f1_score: 0.9505; train_kl_reg_loss: 27614.6178; train_edge_recon_loss: 1757126.2130; train_cat_covariates_contrastive_loss: 642016.4642; train_gene_expr_recon_loss: 1850361.5814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17152.1451; train_global_loss: 4294271.0336; train_optim_loss: 4294271.0336; val_kl_reg_loss: 26646.8991; val_edge_recon_loss: 1793620.7633; val_cat_covariates_contrastive_loss: 647828.7519; val_gene_expr_recon_loss: 1931866.0265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17071.9727; val_global_loss: 4417034.4470; val_optim_loss: 4417034.4470

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9695; val_auprc_score: 0.9816; val_best_acc_score: 0.9345; val_best_f1_score: 0.9528; train_kl_reg_loss: 27834.8072; train_edge_recon_loss: 1760487.5674; train_cat_covariates_contrastive_loss: 642449.6576; train_gene_expr_recon_loss: 1838477.1093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9331.7040; train_global_loss: 4278580.8333; train_optim_loss: 4278580.8333; val_kl_reg_loss: 28002.8762; val_edge_recon_loss: 1793535.0720; val_cat_covariates_contrastive_loss: 641813.4650; val_gene_expr_recon_loss: 1886277.4697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9165.1309; val_global_loss: 4358793.8788; val_optim_loss: 4358793.8788
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9693; val_auprc_score: 0.9817; val_best_acc_score: 0.9343; val_best_f1_score: 0.9529; train_kl_reg_loss: 27922.6946; train_edge_recon_loss: 1755540.3926; train_cat_covariates_contrastive_loss: 641971.7541; train_gene_expr_recon_loss: 1826645.9135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9128.0708; train_global_loss: 4261208.8176; train_optim_loss: 4261208.8176; val_kl_reg_loss: 28242.4426; val_edge_recon_loss: 1782251.2557; val_cat_covariates_contrastive_loss: 641846.8665; val_gene_expr_recon_loss: 1882095.8163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9108.8389; val_global_loss: 4343545.3788; val_optim_loss: 4343545.3788
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9684; val_auprc_score: 0.9806; val_best_acc_score: 0.9344; val_best_f1_score: 0.9529; train_kl_reg_loss: 27995.7846; train_edge_recon_loss: 1761504.6516; train_cat_covariates_contrastive_loss: 641683.7237; train_gene_expr_recon_loss: 1821345.9311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9121.6187; train_global_loss: 4261651.7181; train_optim_loss: 4261651.7181; val_kl_reg_loss: 28461.1461; val_edge_recon_loss: 1786309.6098; val_cat_covariates_contrastive_loss: 641877.4233; val_gene_expr_recon_loss: 1881786.4110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9121.7861; val_global_loss: 4347556.5530; val_optim_loss: 4347556.5530
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9705; val_auprc_score: 0.9822; val_best_acc_score: 0.9356; val_best_f1_score: 0.9537; train_kl_reg_loss: 27983.2970; train_edge_recon_loss: 1752615.5763; train_cat_covariates_contrastive_loss: 642052.6472; train_gene_expr_recon_loss: 1818227.4900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9128.4863; train_global_loss: 4250007.4881; train_optim_loss: 4250007.4881; val_kl_reg_loss: 28010.9326; val_edge_recon_loss: 1786865.9129; val_cat_covariates_contrastive_loss: 642055.9356; val_gene_expr_recon_loss: 1877617.4508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9138.2061; val_global_loss: 4343688.2424; val_optim_loss: 4343688.2424
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9700; val_auprc_score: 0.9813; val_best_acc_score: 0.9353; val_best_f1_score: 0.9535; train_kl_reg_loss: 27867.9941; train_edge_recon_loss: 1756444.9177; train_cat_covariates_contrastive_loss: 641761.4785; train_gene_expr_recon_loss: 1816578.0657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9153.1019; train_global_loss: 4251805.5548; train_optim_loss: 4251805.5548; val_kl_reg_loss: 27569.1116; val_edge_recon_loss: 1790121.6723; val_cat_covariates_contrastive_loss: 643309.3854; val_gene_expr_recon_loss: 1875972.0152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9119.4854; val_global_loss: 4346091.7008; val_optim_loss: 4346091.7008
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9702; val_auprc_score: 0.9810; val_best_acc_score: 0.9360; val_best_f1_score: 0.9538; train_kl_reg_loss: 27873.3622; train_edge_recon_loss: 1753923.4951; train_cat_covariates_contrastive_loss: 641543.7655; train_gene_expr_recon_loss: 1814354.6869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9147.2935; train_global_loss: 4246842.6042; train_optim_loss: 4246842.6042; val_kl_reg_loss: 27696.8966; val_edge_recon_loss: 1787883.2860; val_cat_covariates_contrastive_loss: 641596.4441; val_gene_expr_recon_loss: 1878228.0076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9171.7480; val_global_loss: 4344576.1439; val_optim_loss: 4344576.1439

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9682; val_auprc_score: 0.9803; val_best_acc_score: 0.9347; val_best_f1_score: 0.9532; train_kl_reg_loss: 27748.4088; train_edge_recon_loss: 1756637.7496; train_cat_covariates_contrastive_loss: 641593.5208; train_gene_expr_recon_loss: 1810121.8565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8318.0381; train_global_loss: 4244419.5608; train_optim_loss: 4244419.5608; val_kl_reg_loss: 27849.0331; val_edge_recon_loss: 1781393.9867; val_cat_covariates_contrastive_loss: 641731.9299; val_gene_expr_recon_loss: 1870044.9034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8286.1289; val_global_loss: 4329305.8788; val_optim_loss: 4329305.8788
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9715; val_auprc_score: 0.9827; val_best_acc_score: 0.9368; val_best_f1_score: 0.9547; train_kl_reg_loss: 27771.7042; train_edge_recon_loss: 1755964.3170; train_cat_covariates_contrastive_loss: 641645.2731; train_gene_expr_recon_loss: 1810020.7719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8284.8958; train_global_loss: 4243686.9745; train_optim_loss: 4243686.9745; val_kl_reg_loss: 27846.2094; val_edge_recon_loss: 1779699.3239; val_cat_covariates_contrastive_loss: 642686.6373; val_gene_expr_recon_loss: 1869691.5568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8277.1318; val_global_loss: 4328200.7576; val_optim_loss: 4328200.7576
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9696; val_auprc_score: 0.9812; val_best_acc_score: 0.9349; val_best_f1_score: 0.9532; train_kl_reg_loss: 27823.2587; train_edge_recon_loss: 1749112.9045; train_cat_covariates_contrastive_loss: 641774.6067; train_gene_expr_recon_loss: 1810580.1597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8278.9148; train_global_loss: 4237569.8274; train_optim_loss: 4237569.8274; val_kl_reg_loss: 27784.5353; val_edge_recon_loss: 1791539.6458; val_cat_covariates_contrastive_loss: 641783.3684; val_gene_expr_recon_loss: 1870551.4564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8286.4180; val_global_loss: 4339945.5227; val_optim_loss: 4339945.5227
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9700; val_auprc_score: 0.9816; val_best_acc_score: 0.9371; val_best_f1_score: 0.9546; train_kl_reg_loss: 27736.6158; train_edge_recon_loss: 1752520.1201; train_cat_covariates_contrastive_loss: 641437.7357; train_gene_expr_recon_loss: 1809519.6788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8287.3369; train_global_loss: 4239501.5043; train_optim_loss: 4239501.5043; val_kl_reg_loss: 27807.5322; val_edge_recon_loss: 1780850.7027; val_cat_covariates_contrastive_loss: 641597.3930; val_gene_expr_recon_loss: 1876778.0966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8289.6230; val_global_loss: 4335323.1932; val_optim_loss: 4335323.1932
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9722; val_auprc_score: 0.9837; val_best_acc_score: 0.9374; val_best_f1_score: 0.9550; train_kl_reg_loss: 27668.7349; train_edge_recon_loss: 1752790.8469; train_cat_covariates_contrastive_loss: 641502.5642; train_gene_expr_recon_loss: 1809246.9067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8289.8124; train_global_loss: 4239498.8644; train_optim_loss: 4239498.8644; val_kl_reg_loss: 27760.0115; val_edge_recon_loss: 1778702.8371; val_cat_covariates_contrastive_loss: 642307.2045; val_gene_expr_recon_loss: 1869436.7822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8282.9395; val_global_loss: 4326489.7992; val_optim_loss: 4326489.7992
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9688; val_auprc_score: 0.9808; val_best_acc_score: 0.9353; val_best_f1_score: 0.9536; train_kl_reg_loss: 27625.1335; train_edge_recon_loss: 1755700.8374; train_cat_covariates_contrastive_loss: 641109.1380; train_gene_expr_recon_loss: 1809432.7876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8283.1930; train_global_loss: 4242151.0999; train_optim_loss: 4242151.0999; val_kl_reg_loss: 27838.5030; val_edge_recon_loss: 1793755.2348; val_cat_covariates_contrastive_loss: 641835.4659; val_gene_expr_recon_loss: 1867805.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8281.8848; val_global_loss: 4339516.2803; val_optim_loss: 4339516.2803
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9700; val_auprc_score: 0.9820; val_best_acc_score: 0.9350; val_best_f1_score: 0.9533; train_kl_reg_loss: 27688.6278; train_edge_recon_loss: 1755682.2011; train_cat_covariates_contrastive_loss: 641600.2267; train_gene_expr_recon_loss: 1807939.1930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8283.1164; train_global_loss: 4241193.3614; train_optim_loss: 4241193.3614; val_kl_reg_loss: 27780.5327; val_edge_recon_loss: 1781216.1269; val_cat_covariates_contrastive_loss: 642509.5388; val_gene_expr_recon_loss: 1868169.2860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8280.2227; val_global_loss: 4327955.4962; val_optim_loss: 4327955.4962
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9691; val_auprc_score: 0.9807; val_best_acc_score: 0.9345; val_best_f1_score: 0.9530; train_kl_reg_loss: 27624.6421; train_edge_recon_loss: 1753504.7685; train_cat_covariates_contrastive_loss: 641363.3523; train_gene_expr_recon_loss: 1809588.1943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8281.2149; train_global_loss: 4240362.1713; train_optim_loss: 4240362.1713; val_kl_reg_loss: 27688.4226; val_edge_recon_loss: 1782691.6383; val_cat_covariates_contrastive_loss: 641745.3163; val_gene_expr_recon_loss: 1876599.4527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8286.6543; val_global_loss: 4337011.3750; val_optim_loss: 4337011.3750
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9698; val_auprc_score: 0.9811; val_best_acc_score: 0.9357; val_best_f1_score: 0.9535; train_kl_reg_loss: 27687.0251; train_edge_recon_loss: 1750891.4111; train_cat_covariates_contrastive_loss: 641447.8668; train_gene_expr_recon_loss: 1809314.3520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8287.9420; train_global_loss: 4237628.6033; train_optim_loss: 4237628.6033; val_kl_reg_loss: 27641.9845; val_edge_recon_loss: 1799099.2746; val_cat_covariates_contrastive_loss: 644154.8864; val_gene_expr_recon_loss: 1871836.9053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8286.0635; val_global_loss: 4351019.0758; val_optim_loss: 4351019.0758

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9687; val_auprc_score: 0.9804; val_best_acc_score: 0.9347; val_best_f1_score: 0.9528; train_kl_reg_loss: 27534.0508; train_edge_recon_loss: 1751754.7778; train_cat_covariates_contrastive_loss: 642201.3949; train_gene_expr_recon_loss: 1809096.9262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8199.8546; train_global_loss: 4238786.9868; train_optim_loss: 4238786.9868; val_kl_reg_loss: 27725.4260; val_edge_recon_loss: 1804019.0000; val_cat_covariates_contrastive_loss: 641049.3958; val_gene_expr_recon_loss: 1871409.8788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8196.2041; val_global_loss: 4352399.7576; val_optim_loss: 4352399.7576
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9696; val_auprc_score: 0.9814; val_best_acc_score: 0.9354; val_best_f1_score: 0.9535; train_kl_reg_loss: 27619.6282; train_edge_recon_loss: 1752858.6027; train_cat_covariates_contrastive_loss: 641706.4994; train_gene_expr_recon_loss: 1807820.9296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8195.8733; train_global_loss: 4238201.5166; train_optim_loss: 4238201.5166; val_kl_reg_loss: 27710.4018; val_edge_recon_loss: 1790981.8523; val_cat_covariates_contrastive_loss: 642006.9508; val_gene_expr_recon_loss: 1867662.5189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8194.9238; val_global_loss: 4336556.7386; val_optim_loss: 4336556.7386
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9703; val_auprc_score: 0.9815; val_best_acc_score: 0.9355; val_best_f1_score: 0.9537; train_kl_reg_loss: 27637.3928; train_edge_recon_loss: 1751332.1535; train_cat_covariates_contrastive_loss: 642139.7136; train_gene_expr_recon_loss: 1808594.9471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8194.7454; train_global_loss: 4237898.9422; train_optim_loss: 4237898.9422; val_kl_reg_loss: 27790.9930; val_edge_recon_loss: 1786505.0038; val_cat_covariates_contrastive_loss: 643284.5900; val_gene_expr_recon_loss: 1871433.1686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8195.2021; val_global_loss: 4337208.7727; val_optim_loss: 4337208.7727
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9703; val_auprc_score: 0.9821; val_best_acc_score: 0.9355; val_best_f1_score: 0.9537; train_kl_reg_loss: 27653.7209; train_edge_recon_loss: 1756298.8131; train_cat_covariates_contrastive_loss: 641846.5787; train_gene_expr_recon_loss: 1808349.9464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8195.2128; train_global_loss: 4242344.2751; train_optim_loss: 4242344.2751; val_kl_reg_loss: 27726.5613; val_edge_recon_loss: 1788823.8807; val_cat_covariates_contrastive_loss: 641359.9659; val_gene_expr_recon_loss: 1872276.3561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8195.6621; val_global_loss: 4338382.2576; val_optim_loss: 4338382.2576

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 212 min 58 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9241
val AUPRC score: 0.9323
val best accuracy score: 0.9175
val best F1 score: 0.9400
val target rna MSE score: 1.1075
val source rna MSE score: 0.1033
Val cat covariate0 mean sim diff: -0.0012
Val cat covariate1 mean sim diff: -0.1125

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
