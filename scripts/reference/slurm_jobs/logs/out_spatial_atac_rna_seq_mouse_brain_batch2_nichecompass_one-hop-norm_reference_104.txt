[True]
Run timestamp: 07082023_204247_104.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_104']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9012; val_auprc_score: 0.9138; val_best_acc_score: 0.5137; val_best_f1_score: 0.6728; train_kl_reg_loss: 15448.7402; train_edge_recon_loss: 349032.4688; train_gene_expr_recon_loss: 1233301.4583; train_masked_gp_l1_reg_loss: 8328.0716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119134.9592; train_chrom_access_recon_loss: 720868.0451; train_global_loss: 2446113.7500; train_optim_loss: 2446113.7500; val_kl_reg_loss: 5786.5518; val_edge_recon_loss: 406435.6875; val_gene_expr_recon_loss: 1048467.5000; val_masked_gp_l1_reg_loss: 6470.0103; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116878.5938; val_chrom_access_recon_loss: 523817.1875; val_global_loss: 2107855.5000; val_optim_loss: 2107855.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8993; val_auprc_score: 0.9089; val_best_acc_score: 0.5024; val_best_f1_score: 0.6677; train_kl_reg_loss: 10408.8224; train_edge_recon_loss: 354236.4062; train_gene_expr_recon_loss: 977640.0972; train_masked_gp_l1_reg_loss: 5856.3954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115385.5720; train_chrom_access_recon_loss: 504435.3160; train_global_loss: 1967962.6111; train_optim_loss: 1967962.6111; val_kl_reg_loss: 12494.1094; val_edge_recon_loss: 406538.3438; val_gene_expr_recon_loss: 903143.2500; val_masked_gp_l1_reg_loss: 5436.6577; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113542.2578; val_chrom_access_recon_loss: 495568.0312; val_global_loss: 1936722.6250; val_optim_loss: 1936722.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8695; val_auprc_score: 0.8832; val_best_acc_score: 0.5125; val_best_f1_score: 0.6722; train_kl_reg_loss: 14149.9433; train_edge_recon_loss: 356947.0139; train_gene_expr_recon_loss: 863502.2778; train_masked_gp_l1_reg_loss: 5565.4520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112038.2682; train_chrom_access_recon_loss: 480180.6215; train_global_loss: 1832383.5972; train_optim_loss: 1832383.5972; val_kl_reg_loss: 14369.2578; val_edge_recon_loss: 406497.2812; val_gene_expr_recon_loss: 830934.9375; val_masked_gp_l1_reg_loss: 5771.4868; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110106.3594; val_chrom_access_recon_loss: 474138.3750; val_global_loss: 1841817.7500; val_optim_loss: 1841817.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8415; val_auprc_score: 0.8554; val_best_acc_score: 0.5214; val_best_f1_score: 0.6761; train_kl_reg_loss: 16616.9495; train_edge_recon_loss: 358159.1667; train_gene_expr_recon_loss: 793926.5069; train_masked_gp_l1_reg_loss: 5854.9264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108443.4809; train_chrom_access_recon_loss: 459652.0556; train_global_loss: 1742653.1111; train_optim_loss: 1742653.1111; val_kl_reg_loss: 19813.4570; val_edge_recon_loss: 406432.5938; val_gene_expr_recon_loss: 772725.5000; val_masked_gp_l1_reg_loss: 5940.9136; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106258.7500; val_chrom_access_recon_loss: 463169.7188; val_global_loss: 1774340.8750; val_optim_loss: 1774340.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8258; val_auprc_score: 0.8387; val_best_acc_score: 0.5406; val_best_f1_score: 0.6834; train_kl_reg_loss: 19207.4609; train_edge_recon_loss: 358778.1632; train_gene_expr_recon_loss: 752733.3542; train_masked_gp_l1_reg_loss: 5999.2483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104326.1727; train_chrom_access_recon_loss: 454928.1979; train_global_loss: 1695972.6111; train_optim_loss: 1695972.6111; val_kl_reg_loss: 18456.8008; val_edge_recon_loss: 406243.0938; val_gene_expr_recon_loss: 743403.1250; val_masked_gp_l1_reg_loss: 6050.6387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101808.7031; val_chrom_access_recon_loss: 456348.3438; val_global_loss: 1732310.7500; val_optim_loss: 1732310.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8263; val_auprc_score: 0.8340; val_best_acc_score: 0.5593; val_best_f1_score: 0.6894; train_kl_reg_loss: 19598.7413; train_edge_recon_loss: 358718.7361; train_gene_expr_recon_loss: 728917.3472; train_masked_gp_l1_reg_loss: 6101.7815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99673.8438; train_chrom_access_recon_loss: 450844.8750; train_global_loss: 1663855.3194; train_optim_loss: 1663855.3194; val_kl_reg_loss: 17661.7363; val_edge_recon_loss: 405787.8125; val_gene_expr_recon_loss: 723449.6250; val_masked_gp_l1_reg_loss: 6139.9043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96949.1250; val_chrom_access_recon_loss: 453112.8438; val_global_loss: 1703101.1250; val_optim_loss: 1703101.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8370; val_auprc_score: 0.8381; val_best_acc_score: 0.6183; val_best_f1_score: 0.7166; train_kl_reg_loss: 19422.1328; train_edge_recon_loss: 358552.9271; train_gene_expr_recon_loss: 709962.7778; train_masked_gp_l1_reg_loss: 6174.7102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94716.8898; train_chrom_access_recon_loss: 448014.1667; train_global_loss: 1636843.5833; train_optim_loss: 1636843.5833; val_kl_reg_loss: 18194.5234; val_edge_recon_loss: 405046.1875; val_gene_expr_recon_loss: 709921.1875; val_masked_gp_l1_reg_loss: 6200.6904; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91909.3359; val_chrom_access_recon_loss: 450753.1250; val_global_loss: 1682025.1250; val_optim_loss: 1682025.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8314; val_auprc_score: 0.8328; val_best_acc_score: 0.6646; val_best_f1_score: 0.7381; train_kl_reg_loss: 19466.9538; train_edge_recon_loss: 357958.9306; train_gene_expr_recon_loss: 699088.2292; train_masked_gp_l1_reg_loss: 6225.0158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89655.2439; train_chrom_access_recon_loss: 445244.1458; train_global_loss: 1617638.5417; train_optim_loss: 1617638.5417; val_kl_reg_loss: 18854.5508; val_edge_recon_loss: 404145.6562; val_gene_expr_recon_loss: 699501.0000; val_masked_gp_l1_reg_loss: 6249.3154; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86842.4375; val_chrom_access_recon_loss: 449025.6250; val_global_loss: 1664618.6250; val_optim_loss: 1664618.6250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8153; val_auprc_score: 0.8119; val_best_acc_score: 0.6900; val_best_f1_score: 0.7446; train_kl_reg_loss: 19815.2036; train_edge_recon_loss: 357812.7396; train_gene_expr_recon_loss: 692555.9097; train_masked_gp_l1_reg_loss: 6283.4612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84618.9740; train_chrom_access_recon_loss: 443696.6389; train_global_loss: 1604782.9722; train_optim_loss: 1604782.9722; val_kl_reg_loss: 19297.1914; val_edge_recon_loss: 402595.6250; val_gene_expr_recon_loss: 691562.2500; val_masked_gp_l1_reg_loss: 6309.6943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81862.0312; val_chrom_access_recon_loss: 447502.4375; val_global_loss: 1649129.2500; val_optim_loss: 1649129.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8080; val_auprc_score: 0.8050; val_best_acc_score: 0.7150; val_best_f1_score: 0.7445; train_kl_reg_loss: 19833.6651; train_edge_recon_loss: 356994.2118; train_gene_expr_recon_loss: 679897.2708; train_masked_gp_l1_reg_loss: 6340.8714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79707.1293; train_chrom_access_recon_loss: 442346.9826; train_global_loss: 1585120.1806; train_optim_loss: 1585120.1806; val_kl_reg_loss: 19599.4844; val_edge_recon_loss: 400269.9062; val_gene_expr_recon_loss: 685374.8750; val_masked_gp_l1_reg_loss: 6369.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77040.1797; val_chrom_access_recon_loss: 446215.5625; val_global_loss: 1634869.5000; val_optim_loss: 1634869.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8098; val_auprc_score: 0.8065; val_best_acc_score: 0.7309; val_best_f1_score: 0.7295; train_kl_reg_loss: 19543.9002; train_edge_recon_loss: 355925.7049; train_gene_expr_recon_loss: 676819.2986; train_masked_gp_l1_reg_loss: 6400.9044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74956.8802; train_chrom_access_recon_loss: 440450.5208; train_global_loss: 1574097.2083; train_optim_loss: 1574097.2083; val_kl_reg_loss: 18946.5156; val_edge_recon_loss: 397209.1250; val_gene_expr_recon_loss: 681184.5000; val_masked_gp_l1_reg_loss: 6426.3418; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72383.4062; val_chrom_access_recon_loss: 445063.4375; val_global_loss: 1621213.2500; val_optim_loss: 1621213.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8223; val_auprc_score: 0.8191; val_best_acc_score: 0.7198; val_best_f1_score: 0.7553; train_kl_reg_loss: 19499.4217; train_edge_recon_loss: 354665.1042; train_gene_expr_recon_loss: 672302.6042; train_masked_gp_l1_reg_loss: 6455.0601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70383.1892; train_chrom_access_recon_loss: 440248.9132; train_global_loss: 1563554.2778; train_optim_loss: 1563554.2778; val_kl_reg_loss: 18048.7539; val_edge_recon_loss: 391801.8750; val_gene_expr_recon_loss: 678754.1250; val_masked_gp_l1_reg_loss: 6472.6191; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67915.3125; val_chrom_access_recon_loss: 444098.9375; val_global_loss: 1607091.7500; val_optim_loss: 1607091.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8344; val_auprc_score: 0.8291; val_best_acc_score: 0.7482; val_best_f1_score: 0.7676; train_kl_reg_loss: 19221.4010; train_edge_recon_loss: 352627.2431; train_gene_expr_recon_loss: 669590.2222; train_masked_gp_l1_reg_loss: 6506.0994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66015.3424; train_chrom_access_recon_loss: 438311.4583; train_global_loss: 1552271.7361; train_optim_loss: 1552271.7361; val_kl_reg_loss: 18681.3887; val_edge_recon_loss: 384519.6562; val_gene_expr_recon_loss: 675277.6250; val_masked_gp_l1_reg_loss: 6531.6025; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63681.6797; val_chrom_access_recon_loss: 443113.9688; val_global_loss: 1591805.8750; val_optim_loss: 1591805.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8506; val_auprc_score: 0.8450; val_best_acc_score: 0.7623; val_best_f1_score: 0.7772; train_kl_reg_loss: 19113.7157; train_edge_recon_loss: 348901.2292; train_gene_expr_recon_loss: 666914.0000; train_masked_gp_l1_reg_loss: 6567.7481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61887.6897; train_chrom_access_recon_loss: 437227.4757; train_global_loss: 1540611.8750; train_optim_loss: 1540611.8750; val_kl_reg_loss: 17838.3418; val_edge_recon_loss: 369085.2812; val_gene_expr_recon_loss: 675493.5000; val_masked_gp_l1_reg_loss: 6595.8584; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59682.6875; val_chrom_access_recon_loss: 442538.5312; val_global_loss: 1571234.2500; val_optim_loss: 1571234.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8604; val_auprc_score: 0.8552; val_best_acc_score: 0.7679; val_best_f1_score: 0.7864; train_kl_reg_loss: 19150.9568; train_edge_recon_loss: 340693.3611; train_gene_expr_recon_loss: 664857.9167; train_masked_gp_l1_reg_loss: 6639.4731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58001.1623; train_chrom_access_recon_loss: 435585.2257; train_global_loss: 1524928.1111; train_optim_loss: 1524928.1111; val_kl_reg_loss: 19971.8770; val_edge_recon_loss: 343789.0625; val_gene_expr_recon_loss: 674455.3750; val_masked_gp_l1_reg_loss: 6679.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55939.4922; val_chrom_access_recon_loss: 442054.4062; val_global_loss: 1542889.2500; val_optim_loss: 1542889.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8731; val_auprc_score: 0.8677; val_best_acc_score: 0.7821; val_best_f1_score: 0.7965; train_kl_reg_loss: 22949.5312; train_edge_recon_loss: 325987.0625; train_gene_expr_recon_loss: 661686.9583; train_masked_gp_l1_reg_loss: 6727.1729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54376.8147; train_chrom_access_recon_loss: 435167.0000; train_global_loss: 1506894.5139; train_optim_loss: 1506894.5139; val_kl_reg_loss: 26603.8242; val_edge_recon_loss: 319242.7500; val_gene_expr_recon_loss: 672833.0000; val_masked_gp_l1_reg_loss: 6770.1826; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52468.6250; val_chrom_access_recon_loss: 441342.9688; val_global_loss: 1519261.3750; val_optim_loss: 1519261.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8828; val_auprc_score: 0.8696; val_best_acc_score: 0.7960; val_best_f1_score: 0.8066; train_kl_reg_loss: 28685.8103; train_edge_recon_loss: 314179.5625; train_gene_expr_recon_loss: 665505.3542; train_masked_gp_l1_reg_loss: 6816.7646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51025.3624; train_chrom_access_recon_loss: 436985.7917; train_global_loss: 1503198.6528; train_optim_loss: 1503198.6528; val_kl_reg_loss: 27626.0625; val_edge_recon_loss: 313872.2812; val_gene_expr_recon_loss: 671399.1250; val_masked_gp_l1_reg_loss: 6868.6528; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49263.4375; val_chrom_access_recon_loss: 440322.9375; val_global_loss: 1509352.5000; val_optim_loss: 1509352.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9035; val_auprc_score: 0.8903; val_best_acc_score: 0.8235; val_best_f1_score: 0.8309; train_kl_reg_loss: 27130.7556; train_edge_recon_loss: 311751.3750; train_gene_expr_recon_loss: 662730.5000; train_masked_gp_l1_reg_loss: 6913.8947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47936.8155; train_chrom_access_recon_loss: 435993.9757; train_global_loss: 1492457.3611; train_optim_loss: 1492457.3611; val_kl_reg_loss: 25961.5312; val_edge_recon_loss: 309094.4688; val_gene_expr_recon_loss: 669334.7500; val_masked_gp_l1_reg_loss: 6964.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46311.6445; val_chrom_access_recon_loss: 439756.7500; val_global_loss: 1497423.6250; val_optim_loss: 1497423.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9180; val_auprc_score: 0.9058; val_best_acc_score: 0.8397; val_best_f1_score: 0.8476; train_kl_reg_loss: 25687.1797; train_edge_recon_loss: 306338.4826; train_gene_expr_recon_loss: 659542.4861; train_masked_gp_l1_reg_loss: 7008.8602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45088.4401; train_chrom_access_recon_loss: 434580.7326; train_global_loss: 1478246.1944; train_optim_loss: 1478246.1944; val_kl_reg_loss: 25365.4023; val_edge_recon_loss: 304751.1562; val_gene_expr_recon_loss: 669468.8750; val_masked_gp_l1_reg_loss: 7061.8257; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43584.6172; val_chrom_access_recon_loss: 439169.4375; val_global_loss: 1489401.2500; val_optim_loss: 1489401.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9360; val_auprc_score: 0.9215; val_best_acc_score: 0.8700; val_best_f1_score: 0.8752; train_kl_reg_loss: 26422.9694; train_edge_recon_loss: 300655.0174; train_gene_expr_recon_loss: 658845.0972; train_masked_gp_l1_reg_loss: 7104.8413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42451.6745; train_chrom_access_recon_loss: 432870.9236; train_global_loss: 1468350.5417; train_optim_loss: 1468350.5417; val_kl_reg_loss: 26547.8770; val_edge_recon_loss: 298108.6562; val_gene_expr_recon_loss: 667172.3750; val_masked_gp_l1_reg_loss: 7150.6387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41063.1016; val_chrom_access_recon_loss: 438429.6875; val_global_loss: 1478472.2500; val_optim_loss: 1478472.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9412; val_auprc_score: 0.9267; val_best_acc_score: 0.8763; val_best_f1_score: 0.8813; train_kl_reg_loss: 26596.0193; train_edge_recon_loss: 298231.2743; train_gene_expr_recon_loss: 655700.0347; train_masked_gp_l1_reg_loss: 7184.2578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40016.9375; train_chrom_access_recon_loss: 430267.2778; train_global_loss: 1457995.7917; train_optim_loss: 1457995.7917; val_kl_reg_loss: 27409.5605; val_edge_recon_loss: 295301.1250; val_gene_expr_recon_loss: 665832.0000; val_masked_gp_l1_reg_loss: 7219.6685; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38738.4648; val_chrom_access_recon_loss: 438007.6562; val_global_loss: 1472508.5000; val_optim_loss: 1472508.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9483; val_auprc_score: 0.9335; val_best_acc_score: 0.8886; val_best_f1_score: 0.8920; train_kl_reg_loss: 26920.8778; train_edge_recon_loss: 295797.7778; train_gene_expr_recon_loss: 660253.6181; train_masked_gp_l1_reg_loss: 7247.1444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37772.2704; train_chrom_access_recon_loss: 432965.0764; train_global_loss: 1460956.7778; train_optim_loss: 1460956.7778; val_kl_reg_loss: 26903.6211; val_edge_recon_loss: 294442.5312; val_gene_expr_recon_loss: 664784.5000; val_masked_gp_l1_reg_loss: 7276.6396; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36588.3555; val_chrom_access_recon_loss: 437168.1250; val_global_loss: 1467163.7500; val_optim_loss: 1467163.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9403; val_auprc_score: 0.9195; val_best_acc_score: 0.8848; val_best_f1_score: 0.8888; train_kl_reg_loss: 27142.7413; train_edge_recon_loss: 294987.5903; train_gene_expr_recon_loss: 656843.8611; train_masked_gp_l1_reg_loss: 7308.8041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35700.9327; train_chrom_access_recon_loss: 432903.8993; train_global_loss: 1454887.8472; train_optim_loss: 1454887.8472; val_kl_reg_loss: 26226.4434; val_edge_recon_loss: 295828.2188; val_gene_expr_recon_loss: 664116.8750; val_masked_gp_l1_reg_loss: 7333.6206; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34604.1328; val_chrom_access_recon_loss: 436381.0000; val_global_loss: 1464490.2500; val_optim_loss: 1464490.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9490; val_auprc_score: 0.9349; val_best_acc_score: 0.8899; val_best_f1_score: 0.8953; train_kl_reg_loss: 26827.1131; train_edge_recon_loss: 293433.1528; train_gene_expr_recon_loss: 653979.5694; train_masked_gp_l1_reg_loss: 7359.5031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33786.4132; train_chrom_access_recon_loss: 429878.7431; train_global_loss: 1445264.4861; train_optim_loss: 1445264.4861; val_kl_reg_loss: 26632.7617; val_edge_recon_loss: 292339.4062; val_gene_expr_recon_loss: 663075.0000; val_masked_gp_l1_reg_loss: 7378.0479; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32775.7969; val_chrom_access_recon_loss: 435911.0938; val_global_loss: 1458112.1250; val_optim_loss: 1458112.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9445; val_auprc_score: 0.9276; val_best_acc_score: 0.8814; val_best_f1_score: 0.8861; train_kl_reg_loss: 26892.5187; train_edge_recon_loss: 292062.4792; train_gene_expr_recon_loss: 654374.9514; train_masked_gp_l1_reg_loss: 7400.1528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32021.6506; train_chrom_access_recon_loss: 430340.9306; train_global_loss: 1443092.6806; train_optim_loss: 1443092.6806; val_kl_reg_loss: 26298.6191; val_edge_recon_loss: 295919.5000; val_gene_expr_recon_loss: 660701.6250; val_masked_gp_l1_reg_loss: 7421.6230; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31093.6426; val_chrom_access_recon_loss: 435020.6562; val_global_loss: 1456455.6250; val_optim_loss: 1456455.6250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9455; val_auprc_score: 0.9288; val_best_acc_score: 0.8818; val_best_f1_score: 0.8866; train_kl_reg_loss: 25375.4104; train_edge_recon_loss: 308759.1250; train_gene_expr_recon_loss: 969232.6944; train_masked_gp_l1_reg_loss: 7523.4508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30223.2778; train_chrom_access_recon_loss: 457854.4896; train_global_loss: 1798968.5139; train_optim_loss: 1798968.5139; val_kl_reg_loss: 10905.1504; val_edge_recon_loss: 302420.6875; val_gene_expr_recon_loss: 974520.5000; val_masked_gp_l1_reg_loss: 7687.4268; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29051.8750; val_chrom_access_recon_loss: 461179.4375; val_global_loss: 1785765.0000; val_optim_loss: 1785765.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9448; val_auprc_score: 0.9299; val_best_acc_score: 0.8800; val_best_f1_score: 0.8853; train_kl_reg_loss: 24251.7786; train_edge_recon_loss: 298887.1285; train_gene_expr_recon_loss: 958128.6736; train_masked_gp_l1_reg_loss: 7854.4290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28080.4041; train_chrom_access_recon_loss: 452556.5521; train_global_loss: 1769758.9722; train_optim_loss: 1769758.9722; val_kl_reg_loss: 11709.7881; val_edge_recon_loss: 296455.2812; val_gene_expr_recon_loss: 968768.9375; val_masked_gp_l1_reg_loss: 8050.8506; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26883.1602; val_chrom_access_recon_loss: 460177.1875; val_global_loss: 1772045.2500; val_optim_loss: 1772045.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9433; val_auprc_score: 0.9263; val_best_acc_score: 0.8766; val_best_f1_score: 0.8827; train_kl_reg_loss: 20874.7188; train_edge_recon_loss: 294433.1146; train_gene_expr_recon_loss: 958952.3125; train_masked_gp_l1_reg_loss: 8186.7719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25977.1194; train_chrom_access_recon_loss: 454359.0035; train_global_loss: 1762783.0694; train_optim_loss: 1762783.0694; val_kl_reg_loss: 13285.1914; val_edge_recon_loss: 291740.9688; val_gene_expr_recon_loss: 963489.7500; val_masked_gp_l1_reg_loss: 8342.0146; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24881.6387; val_chrom_access_recon_loss: 459514.2500; val_global_loss: 1761253.7500; val_optim_loss: 1761253.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9443; val_auprc_score: 0.9298; val_best_acc_score: 0.8800; val_best_f1_score: 0.8857; train_kl_reg_loss: 19998.5924; train_edge_recon_loss: 291154.5139; train_gene_expr_recon_loss: 952831.9653; train_masked_gp_l1_reg_loss: 8449.1966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24060.0059; train_chrom_access_recon_loss: 453477.6840; train_global_loss: 1749971.9583; train_optim_loss: 1749971.9583; val_kl_reg_loss: 15026.7480; val_edge_recon_loss: 291713.0000; val_gene_expr_recon_loss: 957881.7500; val_masked_gp_l1_reg_loss: 8571.9121; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23065.9180; val_chrom_access_recon_loss: 458809.9062; val_global_loss: 1755069.1250; val_optim_loss: 1755069.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9448; val_auprc_score: 0.9290; val_best_acc_score: 0.8814; val_best_f1_score: 0.8866; train_kl_reg_loss: 19688.7613; train_edge_recon_loss: 289128.8611; train_gene_expr_recon_loss: 949970.4444; train_masked_gp_l1_reg_loss: 8544.6134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22945.0812; train_chrom_access_recon_loss: 453819.2639; train_global_loss: 1744097.0417; train_optim_loss: 1744097.0417; val_kl_reg_loss: 15170.6484; val_edge_recon_loss: 290517.1875; val_gene_expr_recon_loss: 957343.6250; val_masked_gp_l1_reg_loss: 8521.5596; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22799.3203; val_chrom_access_recon_loss: 458747.9375; val_global_loss: 1753100.2500; val_optim_loss: 1753100.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9459; val_auprc_score: 0.9291; val_best_acc_score: 0.8837; val_best_f1_score: 0.8889; train_kl_reg_loss: 19476.2257; train_edge_recon_loss: 289309.0938; train_gene_expr_recon_loss: 950739.4583; train_masked_gp_l1_reg_loss: 8520.3184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22700.4614; train_chrom_access_recon_loss: 453081.7604; train_global_loss: 1743827.2917; train_optim_loss: 1743827.2917; val_kl_reg_loss: 15186.6562; val_edge_recon_loss: 290548.5625; val_gene_expr_recon_loss: 956728.7500; val_masked_gp_l1_reg_loss: 8515.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22576.3281; val_chrom_access_recon_loss: 458550.3438; val_global_loss: 1752106.1250; val_optim_loss: 1752106.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9464; val_auprc_score: 0.9300; val_best_acc_score: 0.8795; val_best_f1_score: 0.8846; train_kl_reg_loss: 19321.0295; train_edge_recon_loss: 289477.4410; train_gene_expr_recon_loss: 945016.8333; train_masked_gp_l1_reg_loss: 8514.3679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22484.2925; train_chrom_access_recon_loss: 451045.2882; train_global_loss: 1735859.2500; train_optim_loss: 1735859.2500; val_kl_reg_loss: 15201.6953; val_edge_recon_loss: 290702.4688; val_gene_expr_recon_loss: 956430.1250; val_masked_gp_l1_reg_loss: 8513.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22371.3691; val_chrom_access_recon_loss: 458613.9688; val_global_loss: 1751833.5000; val_optim_loss: 1751833.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9453; val_auprc_score: 0.9234; val_best_acc_score: 0.8829; val_best_f1_score: 0.8885; train_kl_reg_loss: 19220.2383; train_edge_recon_loss: 289088.6319; train_gene_expr_recon_loss: 943476.1111; train_masked_gp_l1_reg_loss: 8515.0177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22284.3937; train_chrom_access_recon_loss: 451874.7951; train_global_loss: 1734459.1111; train_optim_loss: 1734459.1111; val_kl_reg_loss: 15122.6309; val_edge_recon_loss: 291297.4688; val_gene_expr_recon_loss: 956311.6250; val_masked_gp_l1_reg_loss: 8517.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22179.5820; val_chrom_access_recon_loss: 458586.0312; val_global_loss: 1752015.0000; val_optim_loss: 1752015.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 1 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9457
val AUPRC score: 0.9300
val best accuracy score: 0.8856
val best F1 score: 0.8909
val target rna MSE score: 4.0145
val source rna MSE score: 3.2450
val target atac MSE score: 0.1381
val source atac MSE score: 0.0210
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
