[True]
Run timestamp: 10082023_182716_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7814; val_auprc_score: 0.7956; val_best_acc_score: 0.5121; val_best_f1_score: 0.6719; train_kl_reg_loss: 77111.8667; train_edge_recon_loss: 3653654.5763; train_gene_expr_recon_loss: 27883296.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5549812.2443; train_global_loss: 37163874.9771; train_optim_loss: 37163874.9771; val_kl_reg_loss: 89399.9516; val_edge_recon_loss: 4064450.4000; val_gene_expr_recon_loss: 23214345.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5234376.2333; val_global_loss: 32602572.0000; val_optim_loss: 32602572.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8002; val_auprc_score: 0.8184; val_best_acc_score: 0.6254; val_best_f1_score: 0.7168; train_kl_reg_loss: 124863.4267; train_edge_recon_loss: 3603499.3015; train_gene_expr_recon_loss: 23194240.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5180991.0878; train_global_loss: 32103594.5649; train_optim_loss: 32103594.5649; val_kl_reg_loss: 137065.4089; val_edge_recon_loss: 4057465.3500; val_gene_expr_recon_loss: 22262056.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5158282.7333; val_global_loss: 31614870.0000; val_optim_loss: 31614870.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8292; val_auprc_score: 0.8428; val_best_acc_score: 0.7490; val_best_f1_score: 0.7429; train_kl_reg_loss: 134648.1681; train_edge_recon_loss: 3546267.2767; train_gene_expr_recon_loss: 22366169.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5123750.1870; train_global_loss: 31170835.4809; train_optim_loss: 31170835.4809; val_kl_reg_loss: 138588.8708; val_edge_recon_loss: 4025759.9167; val_gene_expr_recon_loss: 21836053.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5110732.1333; val_global_loss: 31111134.8000; val_optim_loss: 31111134.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8970; val_auprc_score: 0.8918; val_best_acc_score: 0.8195; val_best_f1_score: 0.8284; train_kl_reg_loss: 115541.6765; train_edge_recon_loss: 3502134.8836; train_gene_expr_recon_loss: 22084861.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5090149.3397; train_global_loss: 30792687.4351; train_optim_loss: 30792687.4351; val_kl_reg_loss: 96867.7354; val_edge_recon_loss: 3656772.2333; val_gene_expr_recon_loss: 21688593.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5081568.2000; val_global_loss: 30523801.6000; val_optim_loss: 30523801.6000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8965; val_auprc_score: 0.8851; val_best_acc_score: 0.8069; val_best_f1_score: 0.8228; train_kl_reg_loss: 119294.1150; train_edge_recon_loss: 3120059.6908; train_gene_expr_recon_loss: 21912059.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5059086.3511; train_global_loss: 30210499.0992; train_optim_loss: 30210499.0992; val_kl_reg_loss: 143088.0677; val_edge_recon_loss: 2980373.7000; val_gene_expr_recon_loss: 21610243.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5072997.7000; val_global_loss: 29806703.2000; val_optim_loss: 29806703.2000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9106; val_auprc_score: 0.8955; val_best_acc_score: 0.8319; val_best_f1_score: 0.8435; train_kl_reg_loss: 136519.8999; train_edge_recon_loss: 2949851.4981; train_gene_expr_recon_loss: 21798310.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5036933.5840; train_global_loss: 29921615.2061; train_optim_loss: 29921615.2061; val_kl_reg_loss: 138465.2365; val_edge_recon_loss: 2917484.5167; val_gene_expr_recon_loss: 21398513.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5015872.4000; val_global_loss: 29470336.0000; val_optim_loss: 29470336.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9191; val_auprc_score: 0.9061; val_best_acc_score: 0.8456; val_best_f1_score: 0.8582; train_kl_reg_loss: 138194.9277; train_edge_recon_loss: 2894245.1183; train_gene_expr_recon_loss: 21622247.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5013122.8435; train_global_loss: 29667810.2595; train_optim_loss: 29667810.2595; val_kl_reg_loss: 142091.9010; val_edge_recon_loss: 2879270.0500; val_gene_expr_recon_loss: 21258776.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4991261.0333; val_global_loss: 29271399.8667; val_optim_loss: 29271399.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9256; val_auprc_score: 0.9117; val_best_acc_score: 0.8515; val_best_f1_score: 0.8608; train_kl_reg_loss: 134956.2419; train_edge_recon_loss: 2877086.8473; train_gene_expr_recon_loss: 21493792.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4987531.4237; train_global_loss: 29493367.2824; train_optim_loss: 29493367.2824; val_kl_reg_loss: 131286.7604; val_edge_recon_loss: 2865965.5833; val_gene_expr_recon_loss: 21139878.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4993774.6667; val_global_loss: 29130905.6000; val_optim_loss: 29130905.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9237; val_auprc_score: 0.9070; val_best_acc_score: 0.8554; val_best_f1_score: 0.8663; train_kl_reg_loss: 129703.0182; train_edge_recon_loss: 2856130.3340; train_gene_expr_recon_loss: 21383157.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4972600.2481; train_global_loss: 29341590.7634; train_optim_loss: 29341590.7634; val_kl_reg_loss: 128583.6609; val_edge_recon_loss: 2840714.9167; val_gene_expr_recon_loss: 21018592.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4963246.8667; val_global_loss: 28951138.0000; val_optim_loss: 28951138.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9327; val_auprc_score: 0.9216; val_best_acc_score: 0.8619; val_best_f1_score: 0.8710; train_kl_reg_loss: 125429.2718; train_edge_recon_loss: 2837329.5687; train_gene_expr_recon_loss: 21263863.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4950048.1298; train_global_loss: 29176670.4885; train_optim_loss: 29176670.4885; val_kl_reg_loss: 122236.4432; val_edge_recon_loss: 2832248.1667; val_gene_expr_recon_loss: 20992650.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4950821.9667; val_global_loss: 28897956.2667; val_optim_loss: 28897956.2667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9351; val_auprc_score: 0.9215; val_best_acc_score: 0.8678; val_best_f1_score: 0.8761; train_kl_reg_loss: 120022.9292; train_edge_recon_loss: 2829254.8111; train_gene_expr_recon_loss: 21208114.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4943640.8969; train_global_loss: 29101032.8702; train_optim_loss: 29101032.8702; val_kl_reg_loss: 121510.2969; val_edge_recon_loss: 2825095.1333; val_gene_expr_recon_loss: 20898425.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4951603.0000; val_global_loss: 28796634.0000; val_optim_loss: 28796634.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9429; val_auprc_score: 0.9318; val_best_acc_score: 0.8797; val_best_f1_score: 0.8852; train_kl_reg_loss: 116255.7547; train_edge_recon_loss: 2808872.5630; train_gene_expr_recon_loss: 21151436.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4932992.5916; train_global_loss: 29009557.2824; train_optim_loss: 29009557.2824; val_kl_reg_loss: 111844.7620; val_edge_recon_loss: 2805165.6500; val_gene_expr_recon_loss: 20785762.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4915958.7333; val_global_loss: 28618730.9333; val_optim_loss: 28618730.9333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9482; val_auprc_score: 0.9390; val_best_acc_score: 0.8840; val_best_f1_score: 0.8893; train_kl_reg_loss: 111321.7493; train_edge_recon_loss: 2802421.5706; train_gene_expr_recon_loss: 21123638.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4934747.4275; train_global_loss: 28972129.2519; train_optim_loss: 28972129.2519; val_kl_reg_loss: 109087.7948; val_edge_recon_loss: 2815268.0667; val_gene_expr_recon_loss: 20756303.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4915295.1667; val_global_loss: 28595954.8000; val_optim_loss: 28595954.8000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9444; val_auprc_score: 0.9312; val_best_acc_score: 0.8773; val_best_f1_score: 0.8831; train_kl_reg_loss: 108475.0362; train_edge_recon_loss: 2785183.7691; train_gene_expr_recon_loss: 21047507.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4916467.8282; train_global_loss: 28857633.7099; train_optim_loss: 28857633.7099; val_kl_reg_loss: 104922.6531; val_edge_recon_loss: 2796206.8833; val_gene_expr_recon_loss: 20807775.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4939510.4000; val_global_loss: 28648414.8000; val_optim_loss: 28648414.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9531; val_auprc_score: 0.9431; val_best_acc_score: 0.8872; val_best_f1_score: 0.8907; train_kl_reg_loss: 105553.4673; train_edge_recon_loss: 2774419.7366; train_gene_expr_recon_loss: 20987852.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4906902.9962; train_global_loss: 28774728.7939; train_optim_loss: 28774728.7939; val_kl_reg_loss: 106173.5135; val_edge_recon_loss: 2784825.8833; val_gene_expr_recon_loss: 20732423.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4933327.9667; val_global_loss: 28556750.0000; val_optim_loss: 28556750.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9568; val_auprc_score: 0.9492; val_best_acc_score: 0.8921; val_best_f1_score: 0.8967; train_kl_reg_loss: 103671.7630; train_edge_recon_loss: 2768947.4943; train_gene_expr_recon_loss: 20924424.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4893803.0076; train_global_loss: 28690846.4733; train_optim_loss: 28690846.4733; val_kl_reg_loss: 100585.5339; val_edge_recon_loss: 2774925.8667; val_gene_expr_recon_loss: 20727119.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4909955.2000; val_global_loss: 28512586.1333; val_optim_loss: 28512586.1333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9564; val_auprc_score: 0.9464; val_best_acc_score: 0.8918; val_best_f1_score: 0.8966; train_kl_reg_loss: 101198.5666; train_edge_recon_loss: 2765671.5630; train_gene_expr_recon_loss: 20888773.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4887615.8015; train_global_loss: 28643259.3282; train_optim_loss: 28643259.3282; val_kl_reg_loss: 100287.9167; val_edge_recon_loss: 2756538.4833; val_gene_expr_recon_loss: 20627181.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4907881.9333; val_global_loss: 28391889.4667; val_optim_loss: 28391889.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9615; val_auprc_score: 0.9526; val_best_acc_score: 0.9034; val_best_f1_score: 0.9070; train_kl_reg_loss: 98894.9583; train_edge_recon_loss: 2752466.9122; train_gene_expr_recon_loss: 20840755.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4879070.8817; train_global_loss: 28571188.5038; train_optim_loss: 28571188.5038; val_kl_reg_loss: 97767.2964; val_edge_recon_loss: 2753785.7833; val_gene_expr_recon_loss: 20559049.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4884124.3667; val_global_loss: 28294727.2000; val_optim_loss: 28294727.2000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9632; val_auprc_score: 0.9551; val_best_acc_score: 0.9015; val_best_f1_score: 0.9045; train_kl_reg_loss: 97284.5933; train_edge_recon_loss: 2748355.2615; train_gene_expr_recon_loss: 20821200.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4876415.3702; train_global_loss: 28543255.6336; train_optim_loss: 28543255.6336; val_kl_reg_loss: 97567.5005; val_edge_recon_loss: 2746014.3833; val_gene_expr_recon_loss: 20547226.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4876052.0333; val_global_loss: 28266860.4000; val_optim_loss: 28266860.4000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9650; val_auprc_score: 0.9575; val_best_acc_score: 0.9113; val_best_f1_score: 0.9140; train_kl_reg_loss: 96158.6198; train_edge_recon_loss: 2744677.0592; train_gene_expr_recon_loss: 20790624.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4878208.5687; train_global_loss: 28509668.5496; train_optim_loss: 28509668.5496; val_kl_reg_loss: 94012.9698; val_edge_recon_loss: 2748296.5667; val_gene_expr_recon_loss: 20581498.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4884164.1667; val_global_loss: 28307972.5333; val_optim_loss: 28307972.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9691; val_auprc_score: 0.9614; val_best_acc_score: 0.9117; val_best_f1_score: 0.9151; train_kl_reg_loss: 93819.2343; train_edge_recon_loss: 2725436.2214; train_gene_expr_recon_loss: 20736951.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4863751.7481; train_global_loss: 28419958.6870; train_optim_loss: 28419958.6870; val_kl_reg_loss: 95472.9214; val_edge_recon_loss: 2741745.9167; val_gene_expr_recon_loss: 20533350.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4879175.0000; val_global_loss: 28249743.7333; val_optim_loss: 28249743.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9703; val_auprc_score: 0.9627; val_best_acc_score: 0.9193; val_best_f1_score: 0.9220; train_kl_reg_loss: 92805.7724; train_edge_recon_loss: 2726326.4962; train_gene_expr_recon_loss: 20717481.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4864643.0725; train_global_loss: 28401257.1298; train_optim_loss: 28401257.1298; val_kl_reg_loss: 91582.2833; val_edge_recon_loss: 2712896.3167; val_gene_expr_recon_loss: 20475102.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4877439.7000; val_global_loss: 28157021.0667; val_optim_loss: 28157021.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9715; val_auprc_score: 0.9650; val_best_acc_score: 0.9200; val_best_f1_score: 0.9229; train_kl_reg_loss: 91585.4736; train_edge_recon_loss: 2712256.1698; train_gene_expr_recon_loss: 20670202.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4857177.2214; train_global_loss: 28331221.8473; train_optim_loss: 28331221.8473; val_kl_reg_loss: 90989.2328; val_edge_recon_loss: 2720259.5500; val_gene_expr_recon_loss: 20394224.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4844643.7333; val_global_loss: 28050117.7333; val_optim_loss: 28050117.7333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9719; val_auprc_score: 0.9656; val_best_acc_score: 0.9202; val_best_f1_score: 0.9219; train_kl_reg_loss: 89588.3858; train_edge_recon_loss: 2714222.0095; train_gene_expr_recon_loss: 20635252.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4853623.9084; train_global_loss: 28292686.4580; train_optim_loss: 28292686.4580; val_kl_reg_loss: 87129.8656; val_edge_recon_loss: 2720218.4667; val_gene_expr_recon_loss: 20490610.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4893816.1667; val_global_loss: 28191774.6667; val_optim_loss: 28191774.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9751; val_auprc_score: 0.9704; val_best_acc_score: 0.9251; val_best_f1_score: 0.9273; train_kl_reg_loss: 88081.8687; train_edge_recon_loss: 2712223.8645; train_gene_expr_recon_loss: 20605663.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4850586.3969; train_global_loss: 28256555.8015; train_optim_loss: 28256555.8015; val_kl_reg_loss: 89706.1026; val_edge_recon_loss: 2713791.0500; val_gene_expr_recon_loss: 20429634.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4869821.9000; val_global_loss: 28102953.4667; val_optim_loss: 28102953.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9718; val_auprc_score: 0.9642; val_best_acc_score: 0.9233; val_best_f1_score: 0.9258; train_kl_reg_loss: 97552.7510; train_edge_recon_loss: 2781242.7805; train_gene_expr_recon_loss: 21691042.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4934382.9313; train_global_loss: 29504220.9313; train_optim_loss: 29504220.9313; val_kl_reg_loss: 32283.7344; val_edge_recon_loss: 2770718.6333; val_gene_expr_recon_loss: 21524108.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4960722.3667; val_global_loss: 29287833.3333; val_optim_loss: 29287833.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9687; val_auprc_score: 0.9613; val_best_acc_score: 0.9185; val_best_f1_score: 0.9208; train_kl_reg_loss: 108312.7917; train_edge_recon_loss: 2772311.6546; train_gene_expr_recon_loss: 21926573.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4931734.4542; train_global_loss: 29738932.6260; train_optim_loss: 29738932.6260; val_kl_reg_loss: 22268.9609; val_edge_recon_loss: 2810300.6000; val_gene_expr_recon_loss: 21854901.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4935081.2000; val_global_loss: 29622552.0000; val_optim_loss: 29622552.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9680; val_auprc_score: 0.9617; val_best_acc_score: 0.9140; val_best_f1_score: 0.9169; train_kl_reg_loss: 117022.9017; train_edge_recon_loss: 2796610.2901; train_gene_expr_recon_loss: 22282749.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4941718.8359; train_global_loss: 30138101.2214; train_optim_loss: 30138101.2214; val_kl_reg_loss: 22198.4112; val_edge_recon_loss: 2810577.8833; val_gene_expr_recon_loss: 22165061.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4961887.6667; val_global_loss: 29959725.7333; val_optim_loss: 29959725.7333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9666; val_auprc_score: 0.9579; val_best_acc_score: 0.9131; val_best_f1_score: 0.9161; train_kl_reg_loss: 116713.1487; train_edge_recon_loss: 2796064.8550; train_gene_expr_recon_loss: 22379827.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4939439.4542; train_global_loss: 30232045.1145; train_optim_loss: 30232045.1145; val_kl_reg_loss: 20814.2039; val_edge_recon_loss: 2813109.0333; val_gene_expr_recon_loss: 22134804.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4969217.4333; val_global_loss: 29937945.2000; val_optim_loss: 29937945.2000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9615; val_auprc_score: 0.9549; val_best_acc_score: 0.8977; val_best_f1_score: 0.9019; train_kl_reg_loss: 116947.1000; train_edge_recon_loss: 2836752.3053; train_gene_expr_recon_loss: 22384579.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4945671.7290; train_global_loss: 30283950.5649; train_optim_loss: 30283950.5649; val_kl_reg_loss: 19158.4961; val_edge_recon_loss: 2845629.2333; val_gene_expr_recon_loss: 22043675.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4942187.8667; val_global_loss: 29850650.9333; val_optim_loss: 29850650.9333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9614; val_auprc_score: 0.9520; val_best_acc_score: 0.9010; val_best_f1_score: 0.9046; train_kl_reg_loss: 117610.2657; train_edge_recon_loss: 2833058.6584; train_gene_expr_recon_loss: 22341030.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4941053.5153; train_global_loss: 30232753.1603; train_optim_loss: 30232753.1603; val_kl_reg_loss: 20922.0617; val_edge_recon_loss: 2822890.4167; val_gene_expr_recon_loss: 22132217.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4963145.5667; val_global_loss: 29939175.7333; val_optim_loss: 29939175.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 11 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9687
val AUPRC score: 0.9603
val best accuracy score: 0.9193
val best F1 score: 0.9226
val target rna MSE score: 1.0345
val source rna MSE score: 18.1795
val target atac MSE score: 0.3470
val source atac MSE score: 2.8866
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
