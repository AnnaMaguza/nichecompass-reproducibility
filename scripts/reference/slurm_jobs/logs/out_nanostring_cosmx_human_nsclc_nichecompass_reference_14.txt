[True, False, True]
Run timestamp: 06092023_134843_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '1000.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 563097
Number of validation nodes: 62566
Number of training edges: 1330101
Number of validation edges: 147789
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8847; val_auprc_score: 0.9787; val_best_acc_score: 0.9130; val_best_f1_score: 0.9515; train_kl_reg_loss: 18467.1723; train_edge_recon_loss: 738722.1332; train_cat_covariates_contrastive_loss: 947981.1247; train_gene_expr_recon_loss: 2745429.5946; train_masked_gp_l1_reg_loss: 40443.2729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58493.3837; train_global_loss: 4549536.6852; train_optim_loss: 4549536.6852; val_kl_reg_loss: 15682.0236; val_edge_recon_loss: 738348.6829; val_cat_covariates_contrastive_loss: 945660.2749; val_gene_expr_recon_loss: 2616401.7093; val_masked_gp_l1_reg_loss: 28054.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13750.9785; val_global_loss: 4357897.6825; val_optim_loss: 4357897.6825
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8815; val_auprc_score: 0.9770; val_best_acc_score: 0.9142; val_best_f1_score: 0.9521; train_kl_reg_loss: 15457.9490; train_edge_recon_loss: 714182.9507; train_cat_covariates_contrastive_loss: 945769.2904; train_gene_expr_recon_loss: 2586153.5302; train_masked_gp_l1_reg_loss: 28936.5381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14154.0197; train_global_loss: 4304654.2780; train_optim_loss: 4304654.2780; val_kl_reg_loss: 15801.6640; val_edge_recon_loss: 727036.5397; val_cat_covariates_contrastive_loss: 943400.1505; val_gene_expr_recon_loss: 2555803.4974; val_masked_gp_l1_reg_loss: 29966.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14306.5967; val_global_loss: 4286314.4369; val_optim_loss: 4286314.4369
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8888; val_auprc_score: 0.9786; val_best_acc_score: 0.9173; val_best_f1_score: 0.9536; train_kl_reg_loss: 16271.5355; train_edge_recon_loss: 707926.7519; train_cat_covariates_contrastive_loss: 946329.9132; train_gene_expr_recon_loss: 2545697.3462; train_masked_gp_l1_reg_loss: 31181.7270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14701.8394; train_global_loss: 4262109.1143; train_optim_loss: 4262109.1143; val_kl_reg_loss: 17136.2046; val_edge_recon_loss: 725315.6700; val_cat_covariates_contrastive_loss: 948356.6049; val_gene_expr_recon_loss: 2529208.2431; val_masked_gp_l1_reg_loss: 31920.6816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14805.4814; val_global_loss: 4266742.8010; val_optim_loss: 4266742.8010
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8949; val_auprc_score: 0.9793; val_best_acc_score: 0.9194; val_best_f1_score: 0.9548; train_kl_reg_loss: 17095.5678; train_edge_recon_loss: 707044.8835; train_cat_covariates_contrastive_loss: 946895.7729; train_gene_expr_recon_loss: 2524442.1405; train_masked_gp_l1_reg_loss: 32997.9423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15050.9876; train_global_loss: 4243527.2939; train_optim_loss: 4243527.2939; val_kl_reg_loss: 17338.5395; val_edge_recon_loss: 739283.4100; val_cat_covariates_contrastive_loss: 948753.8250; val_gene_expr_recon_loss: 2509671.8339; val_masked_gp_l1_reg_loss: 34028.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15145.7725; val_global_loss: 4264222.4602; val_optim_loss: 4264222.4602
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9104; val_auprc_score: 0.9821; val_best_acc_score: 0.9241; val_best_f1_score: 0.9573; train_kl_reg_loss: 18317.8956; train_edge_recon_loss: 701695.0375; train_cat_covariates_contrastive_loss: 946014.1427; train_gene_expr_recon_loss: 2508531.9099; train_masked_gp_l1_reg_loss: 35017.7184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15409.1243; train_global_loss: 4224985.8204; train_optim_loss: 4224985.8204; val_kl_reg_loss: 19396.4488; val_edge_recon_loss: 725353.0437; val_cat_covariates_contrastive_loss: 944332.9939; val_gene_expr_recon_loss: 2498015.8495; val_masked_gp_l1_reg_loss: 36138.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15824.7783; val_global_loss: 4239062.1324; val_optim_loss: 4239062.1324
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9223; val_auprc_score: 0.9845; val_best_acc_score: 0.9293; val_best_f1_score: 0.9602; train_kl_reg_loss: 19482.7439; train_edge_recon_loss: 696333.5815; train_cat_covariates_contrastive_loss: 946947.3839; train_gene_expr_recon_loss: 2492176.5007; train_masked_gp_l1_reg_loss: 37344.7860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16132.4616; train_global_loss: 4208417.4601; train_optim_loss: 4208417.4601; val_kl_reg_loss: 19977.7113; val_edge_recon_loss: 717021.4349; val_cat_covariates_contrastive_loss: 946346.5947; val_gene_expr_recon_loss: 2480623.0087; val_masked_gp_l1_reg_loss: 38700.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16308.9336; val_global_loss: 4218977.7612; val_optim_loss: 4218977.7612
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9282; val_auprc_score: 0.9858; val_best_acc_score: 0.9309; val_best_f1_score: 0.9611; train_kl_reg_loss: 20605.9510; train_edge_recon_loss: 692099.5457; train_cat_covariates_contrastive_loss: 947982.4435; train_gene_expr_recon_loss: 2479426.0797; train_masked_gp_l1_reg_loss: 39670.7070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16492.2898; train_global_loss: 4196277.0163; train_optim_loss: 4196277.0163; val_kl_reg_loss: 21430.0985; val_edge_recon_loss: 719513.3820; val_cat_covariates_contrastive_loss: 948624.8125; val_gene_expr_recon_loss: 2469880.4022; val_masked_gp_l1_reg_loss: 40745.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16630.6035; val_global_loss: 4216824.8296; val_optim_loss: 4216824.8296
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9323; val_auprc_score: 0.9866; val_best_acc_score: 0.9349; val_best_f1_score: 0.9633; train_kl_reg_loss: 21755.5061; train_edge_recon_loss: 691469.5327; train_cat_covariates_contrastive_loss: 948833.3290; train_gene_expr_recon_loss: 2468891.7475; train_masked_gp_l1_reg_loss: 41711.3979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16717.0032; train_global_loss: 4189378.5204; train_optim_loss: 4189378.5204; val_kl_reg_loss: 22256.8116; val_edge_recon_loss: 712929.7991; val_cat_covariates_contrastive_loss: 948067.4699; val_gene_expr_recon_loss: 2457844.9585; val_masked_gp_l1_reg_loss: 42703.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16819.0156; val_global_loss: 4200621.2232; val_optim_loss: 4200621.2232
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9326; val_auprc_score: 0.9869; val_best_acc_score: 0.9340; val_best_f1_score: 0.9629; train_kl_reg_loss: 22630.5716; train_edge_recon_loss: 691852.3999; train_cat_covariates_contrastive_loss: 949252.3174; train_gene_expr_recon_loss: 2457246.0636; train_masked_gp_l1_reg_loss: 43502.2917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17054.3051; train_global_loss: 4181537.9463; train_optim_loss: 4181537.9463; val_kl_reg_loss: 23382.0330; val_edge_recon_loss: 706963.6094; val_cat_covariates_contrastive_loss: 950002.6559; val_gene_expr_recon_loss: 2448924.6514; val_masked_gp_l1_reg_loss: 44423.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17378.2305; val_global_loss: 4191075.0822; val_optim_loss: 4191075.0822
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9291; val_auprc_score: 0.9856; val_best_acc_score: 0.9333; val_best_f1_score: 0.9624; train_kl_reg_loss: 23456.4381; train_edge_recon_loss: 689975.6897; train_cat_covariates_contrastive_loss: 949719.9790; train_gene_expr_recon_loss: 2449419.7023; train_masked_gp_l1_reg_loss: 45055.8222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17371.5410; train_global_loss: 4174999.1681; train_optim_loss: 4174999.1681; val_kl_reg_loss: 23401.5934; val_edge_recon_loss: 709882.9595; val_cat_covariates_contrastive_loss: 949070.2848; val_gene_expr_recon_loss: 2442586.4135; val_masked_gp_l1_reg_loss: 45552.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17463.0352; val_global_loss: 4187956.3391; val_optim_loss: 4187956.3391
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9358; val_auprc_score: 0.9872; val_best_acc_score: 0.9365; val_best_f1_score: 0.9642; train_kl_reg_loss: 24066.6231; train_edge_recon_loss: 691882.5446; train_cat_covariates_contrastive_loss: 949934.8600; train_gene_expr_recon_loss: 2442084.7003; train_masked_gp_l1_reg_loss: 46176.6855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17578.3097; train_global_loss: 4171723.7271; train_optim_loss: 4171723.7271; val_kl_reg_loss: 24058.2193; val_edge_recon_loss: 714358.4890; val_cat_covariates_contrastive_loss: 951651.9907; val_gene_expr_recon_loss: 2434626.0787; val_masked_gp_l1_reg_loss: 46696.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17706.6211; val_global_loss: 4189097.2863; val_optim_loss: 4189097.2863
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9315; val_auprc_score: 0.9857; val_best_acc_score: 0.9372; val_best_f1_score: 0.9646; train_kl_reg_loss: 24595.3006; train_edge_recon_loss: 691933.1284; train_cat_covariates_contrastive_loss: 950105.4762; train_gene_expr_recon_loss: 2436375.3141; train_masked_gp_l1_reg_loss: 47115.5531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17680.0307; train_global_loss: 4167804.8067; train_optim_loss: 4167804.8067; val_kl_reg_loss: 25582.8527; val_edge_recon_loss: 717787.6921; val_cat_covariates_contrastive_loss: 948921.8893; val_gene_expr_recon_loss: 2431039.7465; val_masked_gp_l1_reg_loss: 47570.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17577.8965; val_global_loss: 4188480.9957; val_optim_loss: 4188480.9957
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9346; val_auprc_score: 0.9867; val_best_acc_score: 0.9367; val_best_f1_score: 0.9642; train_kl_reg_loss: 25121.1940; train_edge_recon_loss: 691666.4700; train_cat_covariates_contrastive_loss: 950348.4272; train_gene_expr_recon_loss: 2431638.7330; train_masked_gp_l1_reg_loss: 47881.7487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17798.7870; train_global_loss: 4164455.3540; train_optim_loss: 4164455.3540; val_kl_reg_loss: 25766.9198; val_edge_recon_loss: 714126.8839; val_cat_covariates_contrastive_loss: 949564.5370; val_gene_expr_recon_loss: 2424281.2777; val_masked_gp_l1_reg_loss: 48067.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17650.4863; val_global_loss: 4179457.6038; val_optim_loss: 4179457.6038
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9323; val_auprc_score: 0.9862; val_best_acc_score: 0.9347; val_best_f1_score: 0.9632; train_kl_reg_loss: 25467.9956; train_edge_recon_loss: 688419.2969; train_cat_covariates_contrastive_loss: 950556.8730; train_gene_expr_recon_loss: 2428494.2495; train_masked_gp_l1_reg_loss: 48375.7448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17840.4871; train_global_loss: 4159154.6492; train_optim_loss: 4159154.6492; val_kl_reg_loss: 26305.5806; val_edge_recon_loss: 711106.9906; val_cat_covariates_contrastive_loss: 948159.0136; val_gene_expr_recon_loss: 2423202.7388; val_masked_gp_l1_reg_loss: 48559.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17946.0430; val_global_loss: 4175279.9066; val_optim_loss: 4175279.9066
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9375; val_auprc_score: 0.9873; val_best_acc_score: 0.9394; val_best_f1_score: 0.9658; train_kl_reg_loss: 25725.5365; train_edge_recon_loss: 688143.1467; train_cat_covariates_contrastive_loss: 950546.1354; train_gene_expr_recon_loss: 2425279.4393; train_masked_gp_l1_reg_loss: 49048.5104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17979.8464; train_global_loss: 4156722.6136; train_optim_loss: 4156722.6136; val_kl_reg_loss: 25662.2563; val_edge_recon_loss: 711542.2645; val_cat_covariates_contrastive_loss: 950813.0316; val_gene_expr_recon_loss: 2418721.8175; val_masked_gp_l1_reg_loss: 49494.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18136.4473; val_global_loss: 4174370.8434; val_optim_loss: 4174370.8434
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9342; val_auprc_score: 0.9865; val_best_acc_score: 0.9388; val_best_f1_score: 0.9655; train_kl_reg_loss: 26165.8246; train_edge_recon_loss: 689836.0565; train_cat_covariates_contrastive_loss: 950631.7864; train_gene_expr_recon_loss: 2421722.5435; train_masked_gp_l1_reg_loss: 49597.7178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18083.8571; train_global_loss: 4156037.7812; train_optim_loss: 4156037.7812; val_kl_reg_loss: 26207.7802; val_edge_recon_loss: 706833.6780; val_cat_covariates_contrastive_loss: 949409.5802; val_gene_expr_recon_loss: 2416043.0779; val_masked_gp_l1_reg_loss: 50078.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18275.8672; val_global_loss: 4166848.6324; val_optim_loss: 4166848.6324
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9335; val_auprc_score: 0.9860; val_best_acc_score: 0.9377; val_best_f1_score: 0.9648; train_kl_reg_loss: 26521.9424; train_edge_recon_loss: 691677.6931; train_cat_covariates_contrastive_loss: 950772.2693; train_gene_expr_recon_loss: 2418374.7549; train_masked_gp_l1_reg_loss: 50252.9462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18189.6198; train_global_loss: 4155789.2240; train_optim_loss: 4155789.2240; val_kl_reg_loss: 26804.7683; val_edge_recon_loss: 717259.0093; val_cat_covariates_contrastive_loss: 949554.3733; val_gene_expr_recon_loss: 2415103.6375; val_masked_gp_l1_reg_loss: 50510.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18170.8438; val_global_loss: 4177403.6133; val_optim_loss: 4177403.6133
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9381; val_auprc_score: 0.9874; val_best_acc_score: 0.9386; val_best_f1_score: 0.9653; train_kl_reg_loss: 26728.0618; train_edge_recon_loss: 688894.3817; train_cat_covariates_contrastive_loss: 950822.7557; train_gene_expr_recon_loss: 2415929.6140; train_masked_gp_l1_reg_loss: 50729.6586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18249.2011; train_global_loss: 4151353.6776; train_optim_loss: 4151353.6776; val_kl_reg_loss: 26592.5393; val_edge_recon_loss: 713109.3013; val_cat_covariates_contrastive_loss: 950874.5344; val_gene_expr_recon_loss: 2412024.2154; val_masked_gp_l1_reg_loss: 51055.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18342.3262; val_global_loss: 4171997.9524; val_optim_loss: 4171997.9524
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9395; val_auprc_score: 0.9878; val_best_acc_score: 0.9386; val_best_f1_score: 0.9653; train_kl_reg_loss: 27064.8452; train_edge_recon_loss: 689691.3600; train_cat_covariates_contrastive_loss: 950829.4958; train_gene_expr_recon_loss: 2413254.5044; train_masked_gp_l1_reg_loss: 51301.5354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18273.8581; train_global_loss: 4150415.5998; train_optim_loss: 4150415.5998; val_kl_reg_loss: 26908.3304; val_edge_recon_loss: 713037.2357; val_cat_covariates_contrastive_loss: 953004.8616; val_gene_expr_recon_loss: 2408248.9031; val_masked_gp_l1_reg_loss: 51705.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18399.6836; val_global_loss: 4171304.2024; val_optim_loss: 4171304.2024
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9363; val_auprc_score: 0.9871; val_best_acc_score: 0.9389; val_best_f1_score: 0.9656; train_kl_reg_loss: 27476.6790; train_edge_recon_loss: 692725.9547; train_cat_covariates_contrastive_loss: 951197.9981; train_gene_expr_recon_loss: 2409818.0428; train_masked_gp_l1_reg_loss: 52027.2743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18304.8183; train_global_loss: 4151550.7640; train_optim_loss: 4151550.7640; val_kl_reg_loss: 27272.9191; val_edge_recon_loss: 705956.5734; val_cat_covariates_contrastive_loss: 950758.2543; val_gene_expr_recon_loss: 2404491.7898; val_masked_gp_l1_reg_loss: 52183.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18236.2637; val_global_loss: 4158899.8538; val_optim_loss: 4158899.8538
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9392; val_auprc_score: 0.9875; val_best_acc_score: 0.9401; val_best_f1_score: 0.9662; train_kl_reg_loss: 27849.3687; train_edge_recon_loss: 690007.6893; train_cat_covariates_contrastive_loss: 951471.4603; train_gene_expr_recon_loss: 2405844.8400; train_masked_gp_l1_reg_loss: 52655.2598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18387.9068; train_global_loss: 4146216.5282; train_optim_loss: 4146216.5282; val_kl_reg_loss: 28099.4171; val_edge_recon_loss: 713563.2771; val_cat_covariates_contrastive_loss: 950985.4598; val_gene_expr_recon_loss: 2402152.5856; val_masked_gp_l1_reg_loss: 52954.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18537.2871; val_global_loss: 4166292.7561; val_optim_loss: 4166292.7561
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9369; val_auprc_score: 0.9871; val_best_acc_score: 0.9382; val_best_f1_score: 0.9651; train_kl_reg_loss: 28124.9118; train_edge_recon_loss: 689961.4327; train_cat_covariates_contrastive_loss: 951512.1123; train_gene_expr_recon_loss: 2402971.1283; train_masked_gp_l1_reg_loss: 53031.0959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18503.4699; train_global_loss: 4144104.1522; train_optim_loss: 4144104.1522; val_kl_reg_loss: 27695.8613; val_edge_recon_loss: 706355.2546; val_cat_covariates_contrastive_loss: 951889.5158; val_gene_expr_recon_loss: 2398455.8010; val_masked_gp_l1_reg_loss: 53322.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18360.5254; val_global_loss: 4156079.4680; val_optim_loss: 4156079.4680
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9404; val_auprc_score: 0.9878; val_best_acc_score: 0.9410; val_best_f1_score: 0.9667; train_kl_reg_loss: 28349.7026; train_edge_recon_loss: 690446.2001; train_cat_covariates_contrastive_loss: 951494.1618; train_gene_expr_recon_loss: 2400473.2163; train_masked_gp_l1_reg_loss: 53362.8377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18548.4773; train_global_loss: 4142674.5933; train_optim_loss: 4142674.5933; val_kl_reg_loss: 27936.3707; val_edge_recon_loss: 714269.7606; val_cat_covariates_contrastive_loss: 952861.3860; val_gene_expr_recon_loss: 2396531.6436; val_masked_gp_l1_reg_loss: 53449.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18514.6758; val_global_loss: 4163563.3469; val_optim_loss: 4163563.3469
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9374; val_auprc_score: 0.9871; val_best_acc_score: 0.9374; val_best_f1_score: 0.9647; train_kl_reg_loss: 28471.1938; train_edge_recon_loss: 692153.3778; train_cat_covariates_contrastive_loss: 951594.3358; train_gene_expr_recon_loss: 2399011.2186; train_masked_gp_l1_reg_loss: 53627.0931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18595.2330; train_global_loss: 4143452.4550; train_optim_loss: 4143452.4550; val_kl_reg_loss: 28179.2430; val_edge_recon_loss: 711847.4105; val_cat_covariates_contrastive_loss: 952365.4100; val_gene_expr_recon_loss: 2396935.0588; val_masked_gp_l1_reg_loss: 53776.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18630.8691; val_global_loss: 4161733.9403; val_optim_loss: 4161733.9403
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9353; val_auprc_score: 0.9865; val_best_acc_score: 0.9380; val_best_f1_score: 0.9649; train_kl_reg_loss: 28722.9806; train_edge_recon_loss: 689443.2582; train_cat_covariates_contrastive_loss: 951689.4930; train_gene_expr_recon_loss: 2397361.7527; train_masked_gp_l1_reg_loss: 53947.6139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18648.0465; train_global_loss: 4139813.1449; train_optim_loss: 4139813.1449; val_kl_reg_loss: 28744.8421; val_edge_recon_loss: 711345.0309; val_cat_covariates_contrastive_loss: 951564.5495; val_gene_expr_recon_loss: 2391418.0190; val_masked_gp_l1_reg_loss: 54272.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18768.2598; val_global_loss: 4156112.7716; val_optim_loss: 4156112.7716
