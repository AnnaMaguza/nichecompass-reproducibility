[True, False, True]
Run timestamp: 06092023_134843_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '1000.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 563097
Number of validation nodes: 62566
Number of training edges: 1330101
Number of validation edges: 147789
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8847; val_auprc_score: 0.9787; val_best_acc_score: 0.9130; val_best_f1_score: 0.9515; train_kl_reg_loss: 18467.1723; train_edge_recon_loss: 738722.1332; train_cat_covariates_contrastive_loss: 947981.1247; train_gene_expr_recon_loss: 2745429.5946; train_masked_gp_l1_reg_loss: 40443.2729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58493.3837; train_global_loss: 4549536.6852; train_optim_loss: 4549536.6852; val_kl_reg_loss: 15682.0236; val_edge_recon_loss: 738348.6829; val_cat_covariates_contrastive_loss: 945660.2749; val_gene_expr_recon_loss: 2616401.7093; val_masked_gp_l1_reg_loss: 28054.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13750.9785; val_global_loss: 4357897.6825; val_optim_loss: 4357897.6825
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8815; val_auprc_score: 0.9770; val_best_acc_score: 0.9142; val_best_f1_score: 0.9521; train_kl_reg_loss: 15457.9490; train_edge_recon_loss: 714182.9507; train_cat_covariates_contrastive_loss: 945769.2904; train_gene_expr_recon_loss: 2586153.5302; train_masked_gp_l1_reg_loss: 28936.5381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14154.0197; train_global_loss: 4304654.2780; train_optim_loss: 4304654.2780; val_kl_reg_loss: 15801.6640; val_edge_recon_loss: 727036.5397; val_cat_covariates_contrastive_loss: 943400.1505; val_gene_expr_recon_loss: 2555803.4974; val_masked_gp_l1_reg_loss: 29966.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14306.5967; val_global_loss: 4286314.4369; val_optim_loss: 4286314.4369
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8888; val_auprc_score: 0.9786; val_best_acc_score: 0.9173; val_best_f1_score: 0.9536; train_kl_reg_loss: 16271.5355; train_edge_recon_loss: 707926.7519; train_cat_covariates_contrastive_loss: 946329.9132; train_gene_expr_recon_loss: 2545697.3462; train_masked_gp_l1_reg_loss: 31181.7270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14701.8394; train_global_loss: 4262109.1143; train_optim_loss: 4262109.1143; val_kl_reg_loss: 17136.2046; val_edge_recon_loss: 725315.6700; val_cat_covariates_contrastive_loss: 948356.6049; val_gene_expr_recon_loss: 2529208.2431; val_masked_gp_l1_reg_loss: 31920.6816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14805.4814; val_global_loss: 4266742.8010; val_optim_loss: 4266742.8010
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8949; val_auprc_score: 0.9793; val_best_acc_score: 0.9194; val_best_f1_score: 0.9548; train_kl_reg_loss: 17095.5678; train_edge_recon_loss: 707044.8835; train_cat_covariates_contrastive_loss: 946895.7729; train_gene_expr_recon_loss: 2524442.1405; train_masked_gp_l1_reg_loss: 32997.9423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15050.9876; train_global_loss: 4243527.2939; train_optim_loss: 4243527.2939; val_kl_reg_loss: 17338.5395; val_edge_recon_loss: 739283.4100; val_cat_covariates_contrastive_loss: 948753.8250; val_gene_expr_recon_loss: 2509671.8339; val_masked_gp_l1_reg_loss: 34028.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15145.7725; val_global_loss: 4264222.4602; val_optim_loss: 4264222.4602
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9104; val_auprc_score: 0.9821; val_best_acc_score: 0.9241; val_best_f1_score: 0.9573; train_kl_reg_loss: 18317.8956; train_edge_recon_loss: 701695.0375; train_cat_covariates_contrastive_loss: 946014.1427; train_gene_expr_recon_loss: 2508531.9099; train_masked_gp_l1_reg_loss: 35017.7184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15409.1243; train_global_loss: 4224985.8204; train_optim_loss: 4224985.8204; val_kl_reg_loss: 19396.4488; val_edge_recon_loss: 725353.0437; val_cat_covariates_contrastive_loss: 944332.9939; val_gene_expr_recon_loss: 2498015.8495; val_masked_gp_l1_reg_loss: 36138.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15824.7783; val_global_loss: 4239062.1324; val_optim_loss: 4239062.1324
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9223; val_auprc_score: 0.9845; val_best_acc_score: 0.9293; val_best_f1_score: 0.9602; train_kl_reg_loss: 19482.7439; train_edge_recon_loss: 696333.5815; train_cat_covariates_contrastive_loss: 946947.3839; train_gene_expr_recon_loss: 2492176.5007; train_masked_gp_l1_reg_loss: 37344.7860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16132.4616; train_global_loss: 4208417.4601; train_optim_loss: 4208417.4601; val_kl_reg_loss: 19977.7113; val_edge_recon_loss: 717021.4349; val_cat_covariates_contrastive_loss: 946346.5947; val_gene_expr_recon_loss: 2480623.0087; val_masked_gp_l1_reg_loss: 38700.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16308.9336; val_global_loss: 4218977.7612; val_optim_loss: 4218977.7612
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9282; val_auprc_score: 0.9858; val_best_acc_score: 0.9309; val_best_f1_score: 0.9611; train_kl_reg_loss: 20605.9510; train_edge_recon_loss: 692099.5457; train_cat_covariates_contrastive_loss: 947982.4435; train_gene_expr_recon_loss: 2479426.0797; train_masked_gp_l1_reg_loss: 39670.7070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16492.2898; train_global_loss: 4196277.0163; train_optim_loss: 4196277.0163; val_kl_reg_loss: 21430.0985; val_edge_recon_loss: 719513.3820; val_cat_covariates_contrastive_loss: 948624.8125; val_gene_expr_recon_loss: 2469880.4022; val_masked_gp_l1_reg_loss: 40745.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16630.6035; val_global_loss: 4216824.8296; val_optim_loss: 4216824.8296
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9323; val_auprc_score: 0.9866; val_best_acc_score: 0.9349; val_best_f1_score: 0.9633; train_kl_reg_loss: 21755.5061; train_edge_recon_loss: 691469.5327; train_cat_covariates_contrastive_loss: 948833.3290; train_gene_expr_recon_loss: 2468891.7475; train_masked_gp_l1_reg_loss: 41711.3979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16717.0032; train_global_loss: 4189378.5204; train_optim_loss: 4189378.5204; val_kl_reg_loss: 22256.8116; val_edge_recon_loss: 712929.7991; val_cat_covariates_contrastive_loss: 948067.4699; val_gene_expr_recon_loss: 2457844.9585; val_masked_gp_l1_reg_loss: 42703.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16819.0156; val_global_loss: 4200621.2232; val_optim_loss: 4200621.2232
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9326; val_auprc_score: 0.9869; val_best_acc_score: 0.9340; val_best_f1_score: 0.9629; train_kl_reg_loss: 22630.5716; train_edge_recon_loss: 691852.3999; train_cat_covariates_contrastive_loss: 949252.3174; train_gene_expr_recon_loss: 2457246.0636; train_masked_gp_l1_reg_loss: 43502.2917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17054.3051; train_global_loss: 4181537.9463; train_optim_loss: 4181537.9463; val_kl_reg_loss: 23382.0330; val_edge_recon_loss: 706963.6094; val_cat_covariates_contrastive_loss: 950002.6559; val_gene_expr_recon_loss: 2448924.6514; val_masked_gp_l1_reg_loss: 44423.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17378.2305; val_global_loss: 4191075.0822; val_optim_loss: 4191075.0822
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9291; val_auprc_score: 0.9856; val_best_acc_score: 0.9333; val_best_f1_score: 0.9624; train_kl_reg_loss: 23456.4381; train_edge_recon_loss: 689975.6897; train_cat_covariates_contrastive_loss: 949719.9790; train_gene_expr_recon_loss: 2449419.7023; train_masked_gp_l1_reg_loss: 45055.8222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17371.5410; train_global_loss: 4174999.1681; train_optim_loss: 4174999.1681; val_kl_reg_loss: 23401.5934; val_edge_recon_loss: 709882.9595; val_cat_covariates_contrastive_loss: 949070.2848; val_gene_expr_recon_loss: 2442586.4135; val_masked_gp_l1_reg_loss: 45552.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17463.0352; val_global_loss: 4187956.3391; val_optim_loss: 4187956.3391
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9358; val_auprc_score: 0.9872; val_best_acc_score: 0.9365; val_best_f1_score: 0.9642; train_kl_reg_loss: 24066.6231; train_edge_recon_loss: 691882.5446; train_cat_covariates_contrastive_loss: 949934.8600; train_gene_expr_recon_loss: 2442084.7003; train_masked_gp_l1_reg_loss: 46176.6855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17578.3097; train_global_loss: 4171723.7271; train_optim_loss: 4171723.7271; val_kl_reg_loss: 24058.2193; val_edge_recon_loss: 714358.4890; val_cat_covariates_contrastive_loss: 951651.9907; val_gene_expr_recon_loss: 2434626.0787; val_masked_gp_l1_reg_loss: 46696.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17706.6211; val_global_loss: 4189097.2863; val_optim_loss: 4189097.2863
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9315; val_auprc_score: 0.9857; val_best_acc_score: 0.9372; val_best_f1_score: 0.9646; train_kl_reg_loss: 24595.3006; train_edge_recon_loss: 691933.1284; train_cat_covariates_contrastive_loss: 950105.4762; train_gene_expr_recon_loss: 2436375.3141; train_masked_gp_l1_reg_loss: 47115.5531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17680.0307; train_global_loss: 4167804.8067; train_optim_loss: 4167804.8067; val_kl_reg_loss: 25582.8527; val_edge_recon_loss: 717787.6921; val_cat_covariates_contrastive_loss: 948921.8893; val_gene_expr_recon_loss: 2431039.7465; val_masked_gp_l1_reg_loss: 47570.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17577.8965; val_global_loss: 4188480.9957; val_optim_loss: 4188480.9957
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9346; val_auprc_score: 0.9867; val_best_acc_score: 0.9367; val_best_f1_score: 0.9642; train_kl_reg_loss: 25121.1940; train_edge_recon_loss: 691666.4700; train_cat_covariates_contrastive_loss: 950348.4272; train_gene_expr_recon_loss: 2431638.7330; train_masked_gp_l1_reg_loss: 47881.7487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17798.7870; train_global_loss: 4164455.3540; train_optim_loss: 4164455.3540; val_kl_reg_loss: 25766.9198; val_edge_recon_loss: 714126.8839; val_cat_covariates_contrastive_loss: 949564.5370; val_gene_expr_recon_loss: 2424281.2777; val_masked_gp_l1_reg_loss: 48067.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17650.4863; val_global_loss: 4179457.6038; val_optim_loss: 4179457.6038
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9323; val_auprc_score: 0.9862; val_best_acc_score: 0.9347; val_best_f1_score: 0.9632; train_kl_reg_loss: 25467.9956; train_edge_recon_loss: 688419.2969; train_cat_covariates_contrastive_loss: 950556.8730; train_gene_expr_recon_loss: 2428494.2495; train_masked_gp_l1_reg_loss: 48375.7448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17840.4871; train_global_loss: 4159154.6492; train_optim_loss: 4159154.6492; val_kl_reg_loss: 26305.5806; val_edge_recon_loss: 711106.9906; val_cat_covariates_contrastive_loss: 948159.0136; val_gene_expr_recon_loss: 2423202.7388; val_masked_gp_l1_reg_loss: 48559.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17946.0430; val_global_loss: 4175279.9066; val_optim_loss: 4175279.9066
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9375; val_auprc_score: 0.9873; val_best_acc_score: 0.9394; val_best_f1_score: 0.9658; train_kl_reg_loss: 25725.5365; train_edge_recon_loss: 688143.1467; train_cat_covariates_contrastive_loss: 950546.1354; train_gene_expr_recon_loss: 2425279.4393; train_masked_gp_l1_reg_loss: 49048.5104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17979.8464; train_global_loss: 4156722.6136; train_optim_loss: 4156722.6136; val_kl_reg_loss: 25662.2563; val_edge_recon_loss: 711542.2645; val_cat_covariates_contrastive_loss: 950813.0316; val_gene_expr_recon_loss: 2418721.8175; val_masked_gp_l1_reg_loss: 49494.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18136.4473; val_global_loss: 4174370.8434; val_optim_loss: 4174370.8434
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9342; val_auprc_score: 0.9865; val_best_acc_score: 0.9388; val_best_f1_score: 0.9655; train_kl_reg_loss: 26165.8246; train_edge_recon_loss: 689836.0565; train_cat_covariates_contrastive_loss: 950631.7864; train_gene_expr_recon_loss: 2421722.5435; train_masked_gp_l1_reg_loss: 49597.7178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18083.8571; train_global_loss: 4156037.7812; train_optim_loss: 4156037.7812; val_kl_reg_loss: 26207.7802; val_edge_recon_loss: 706833.6780; val_cat_covariates_contrastive_loss: 949409.5802; val_gene_expr_recon_loss: 2416043.0779; val_masked_gp_l1_reg_loss: 50078.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18275.8672; val_global_loss: 4166848.6324; val_optim_loss: 4166848.6324
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9335; val_auprc_score: 0.9860; val_best_acc_score: 0.9377; val_best_f1_score: 0.9648; train_kl_reg_loss: 26521.9424; train_edge_recon_loss: 691677.6931; train_cat_covariates_contrastive_loss: 950772.2693; train_gene_expr_recon_loss: 2418374.7549; train_masked_gp_l1_reg_loss: 50252.9462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18189.6198; train_global_loss: 4155789.2240; train_optim_loss: 4155789.2240; val_kl_reg_loss: 26804.7683; val_edge_recon_loss: 717259.0093; val_cat_covariates_contrastive_loss: 949554.3733; val_gene_expr_recon_loss: 2415103.6375; val_masked_gp_l1_reg_loss: 50510.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18170.8438; val_global_loss: 4177403.6133; val_optim_loss: 4177403.6133
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9381; val_auprc_score: 0.9874; val_best_acc_score: 0.9386; val_best_f1_score: 0.9653; train_kl_reg_loss: 26728.0618; train_edge_recon_loss: 688894.3817; train_cat_covariates_contrastive_loss: 950822.7557; train_gene_expr_recon_loss: 2415929.6140; train_masked_gp_l1_reg_loss: 50729.6586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18249.2011; train_global_loss: 4151353.6776; train_optim_loss: 4151353.6776; val_kl_reg_loss: 26592.5393; val_edge_recon_loss: 713109.3013; val_cat_covariates_contrastive_loss: 950874.5344; val_gene_expr_recon_loss: 2412024.2154; val_masked_gp_l1_reg_loss: 51055.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18342.3262; val_global_loss: 4171997.9524; val_optim_loss: 4171997.9524
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9395; val_auprc_score: 0.9878; val_best_acc_score: 0.9386; val_best_f1_score: 0.9653; train_kl_reg_loss: 27064.8452; train_edge_recon_loss: 689691.3600; train_cat_covariates_contrastive_loss: 950829.4958; train_gene_expr_recon_loss: 2413254.5044; train_masked_gp_l1_reg_loss: 51301.5354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18273.8581; train_global_loss: 4150415.5998; train_optim_loss: 4150415.5998; val_kl_reg_loss: 26908.3304; val_edge_recon_loss: 713037.2357; val_cat_covariates_contrastive_loss: 953004.8616; val_gene_expr_recon_loss: 2408248.9031; val_masked_gp_l1_reg_loss: 51705.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18399.6836; val_global_loss: 4171304.2024; val_optim_loss: 4171304.2024
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9363; val_auprc_score: 0.9871; val_best_acc_score: 0.9389; val_best_f1_score: 0.9656; train_kl_reg_loss: 27476.6790; train_edge_recon_loss: 692725.9547; train_cat_covariates_contrastive_loss: 951197.9981; train_gene_expr_recon_loss: 2409818.0428; train_masked_gp_l1_reg_loss: 52027.2743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18304.8183; train_global_loss: 4151550.7640; train_optim_loss: 4151550.7640; val_kl_reg_loss: 27272.9191; val_edge_recon_loss: 705956.5734; val_cat_covariates_contrastive_loss: 950758.2543; val_gene_expr_recon_loss: 2404491.7898; val_masked_gp_l1_reg_loss: 52183.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18236.2637; val_global_loss: 4158899.8538; val_optim_loss: 4158899.8538
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9392; val_auprc_score: 0.9875; val_best_acc_score: 0.9401; val_best_f1_score: 0.9662; train_kl_reg_loss: 27849.3687; train_edge_recon_loss: 690007.6893; train_cat_covariates_contrastive_loss: 951471.4603; train_gene_expr_recon_loss: 2405844.8400; train_masked_gp_l1_reg_loss: 52655.2598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18387.9068; train_global_loss: 4146216.5282; train_optim_loss: 4146216.5282; val_kl_reg_loss: 28099.4171; val_edge_recon_loss: 713563.2771; val_cat_covariates_contrastive_loss: 950985.4598; val_gene_expr_recon_loss: 2402152.5856; val_masked_gp_l1_reg_loss: 52954.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18537.2871; val_global_loss: 4166292.7561; val_optim_loss: 4166292.7561
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9369; val_auprc_score: 0.9871; val_best_acc_score: 0.9382; val_best_f1_score: 0.9651; train_kl_reg_loss: 28124.9118; train_edge_recon_loss: 689961.4327; train_cat_covariates_contrastive_loss: 951512.1123; train_gene_expr_recon_loss: 2402971.1283; train_masked_gp_l1_reg_loss: 53031.0959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18503.4699; train_global_loss: 4144104.1522; train_optim_loss: 4144104.1522; val_kl_reg_loss: 27695.8613; val_edge_recon_loss: 706355.2546; val_cat_covariates_contrastive_loss: 951889.5158; val_gene_expr_recon_loss: 2398455.8010; val_masked_gp_l1_reg_loss: 53322.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18360.5254; val_global_loss: 4156079.4680; val_optim_loss: 4156079.4680
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9404; val_auprc_score: 0.9878; val_best_acc_score: 0.9410; val_best_f1_score: 0.9667; train_kl_reg_loss: 28349.7026; train_edge_recon_loss: 690446.2001; train_cat_covariates_contrastive_loss: 951494.1618; train_gene_expr_recon_loss: 2400473.2163; train_masked_gp_l1_reg_loss: 53362.8377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18548.4773; train_global_loss: 4142674.5933; train_optim_loss: 4142674.5933; val_kl_reg_loss: 27936.3707; val_edge_recon_loss: 714269.7606; val_cat_covariates_contrastive_loss: 952861.3860; val_gene_expr_recon_loss: 2396531.6436; val_masked_gp_l1_reg_loss: 53449.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18514.6758; val_global_loss: 4163563.3469; val_optim_loss: 4163563.3469
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9374; val_auprc_score: 0.9871; val_best_acc_score: 0.9374; val_best_f1_score: 0.9647; train_kl_reg_loss: 28471.1938; train_edge_recon_loss: 692153.3778; train_cat_covariates_contrastive_loss: 951594.3358; train_gene_expr_recon_loss: 2399011.2186; train_masked_gp_l1_reg_loss: 53627.0931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18595.2330; train_global_loss: 4143452.4550; train_optim_loss: 4143452.4550; val_kl_reg_loss: 28179.2430; val_edge_recon_loss: 711847.4105; val_cat_covariates_contrastive_loss: 952365.4100; val_gene_expr_recon_loss: 2396935.0588; val_masked_gp_l1_reg_loss: 53776.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18630.8691; val_global_loss: 4161733.9403; val_optim_loss: 4161733.9403
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9353; val_auprc_score: 0.9865; val_best_acc_score: 0.9380; val_best_f1_score: 0.9649; train_kl_reg_loss: 28722.9806; train_edge_recon_loss: 689443.2582; train_cat_covariates_contrastive_loss: 951689.4930; train_gene_expr_recon_loss: 2397361.7527; train_masked_gp_l1_reg_loss: 53947.6139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18648.0465; train_global_loss: 4139813.1449; train_optim_loss: 4139813.1449; val_kl_reg_loss: 28744.8421; val_edge_recon_loss: 711345.0309; val_cat_covariates_contrastive_loss: 951564.5495; val_gene_expr_recon_loss: 2391418.0190; val_masked_gp_l1_reg_loss: 54272.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18768.2598; val_global_loss: 4156112.7716; val_optim_loss: 4156112.7716
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9299; val_auprc_score: 0.9856; val_best_acc_score: 0.9355; val_best_f1_score: 0.9637; train_kl_reg_loss: 23728.1113; train_edge_recon_loss: 693948.5778; train_cat_covariates_contrastive_loss: 950942.6943; train_gene_expr_recon_loss: 1891673.2864; train_masked_gp_l1_reg_loss: 51421.3572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17123.9722; train_global_loss: 3628837.9987; train_optim_loss: 3628837.9987; val_kl_reg_loss: 22665.6866; val_edge_recon_loss: 712062.2191; val_cat_covariates_contrastive_loss: 950653.6544; val_gene_expr_recon_loss: 1886795.0186; val_masked_gp_l1_reg_loss: 51565.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16993.8301; val_global_loss: 3640735.8322; val_optim_loss: 3640735.8322
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9336; val_auprc_score: 0.9862; val_best_acc_score: 0.9376; val_best_f1_score: 0.9649; train_kl_reg_loss: 23610.7435; train_edge_recon_loss: 691488.3605; train_cat_covariates_contrastive_loss: 950882.7849; train_gene_expr_recon_loss: 1889460.3113; train_masked_gp_l1_reg_loss: 51518.4798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17136.4766; train_global_loss: 3624097.1611; train_optim_loss: 3624097.1611; val_kl_reg_loss: 23443.6077; val_edge_recon_loss: 723326.3454; val_cat_covariates_contrastive_loss: 950444.8054; val_gene_expr_recon_loss: 1885986.0203; val_masked_gp_l1_reg_loss: 51733.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17171.3750; val_global_loss: 3652105.6920; val_optim_loss: 3652105.6920
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9384; val_auprc_score: 0.9876; val_best_acc_score: 0.9389; val_best_f1_score: 0.9655; train_kl_reg_loss: 23664.1074; train_edge_recon_loss: 688964.4072; train_cat_covariates_contrastive_loss: 950775.5368; train_gene_expr_recon_loss: 1888003.8529; train_masked_gp_l1_reg_loss: 51743.1555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17173.3135; train_global_loss: 3620324.3732; train_optim_loss: 3620324.3732; val_kl_reg_loss: 22980.1538; val_edge_recon_loss: 711115.2991; val_cat_covariates_contrastive_loss: 951698.6179; val_gene_expr_recon_loss: 1885887.6241; val_masked_gp_l1_reg_loss: 51810.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17272.2578; val_global_loss: 3640764.7033; val_optim_loss: 3640764.7033
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9396; val_auprc_score: 0.9879; val_best_acc_score: 0.9405; val_best_f1_score: 0.9665; train_kl_reg_loss: 23841.9205; train_edge_recon_loss: 690518.2725; train_cat_covariates_contrastive_loss: 950871.1300; train_gene_expr_recon_loss: 1887507.4807; train_masked_gp_l1_reg_loss: 51883.7210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17176.1549; train_global_loss: 3621798.6826; train_optim_loss: 3621798.6826; val_kl_reg_loss: 23853.2109; val_edge_recon_loss: 700672.0217; val_cat_covariates_contrastive_loss: 951755.8629; val_gene_expr_recon_loss: 1883948.1825; val_masked_gp_l1_reg_loss: 52115.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17126.0762; val_global_loss: 3629471.0277; val_optim_loss: 3629471.0277
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9371; val_auprc_score: 0.9871; val_best_acc_score: 0.9366; val_best_f1_score: 0.9641; train_kl_reg_loss: 23903.8479; train_edge_recon_loss: 690730.8035; train_cat_covariates_contrastive_loss: 950636.9503; train_gene_expr_recon_loss: 1887006.1431; train_masked_gp_l1_reg_loss: 52052.1258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17187.5221; train_global_loss: 3621517.3921; train_optim_loss: 3621517.3921; val_kl_reg_loss: 23750.4201; val_edge_recon_loss: 718855.6577; val_cat_covariates_contrastive_loss: 950676.7658; val_gene_expr_recon_loss: 1882962.0705; val_masked_gp_l1_reg_loss: 51647.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17093.7344; val_global_loss: 3644985.9092; val_optim_loss: 3644985.9092
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9371; val_auprc_score: 0.9870; val_best_acc_score: 0.9397; val_best_f1_score: 0.9660; train_kl_reg_loss: 24030.4951; train_edge_recon_loss: 690001.9697; train_cat_covariates_contrastive_loss: 950780.6342; train_gene_expr_recon_loss: 1886192.9151; train_masked_gp_l1_reg_loss: 52149.9807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17192.2902; train_global_loss: 3620348.2921; train_optim_loss: 3620348.2921; val_kl_reg_loss: 24299.1620; val_edge_recon_loss: 711328.8625; val_cat_covariates_contrastive_loss: 950062.1462; val_gene_expr_recon_loss: 1882637.6838; val_masked_gp_l1_reg_loss: 52291.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17330.6426; val_global_loss: 3637950.6038; val_optim_loss: 3637950.6038
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9350; val_auprc_score: 0.9861; val_best_acc_score: 0.9383; val_best_f1_score: 0.9651; train_kl_reg_loss: 24113.0456; train_edge_recon_loss: 689488.1796; train_cat_covariates_contrastive_loss: 950861.8861; train_gene_expr_recon_loss: 1885737.7923; train_masked_gp_l1_reg_loss: 52169.4506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17191.7372; train_global_loss: 3619562.0916; train_optim_loss: 3619562.0916; val_kl_reg_loss: 24673.1385; val_edge_recon_loss: 721498.4600; val_cat_covariates_contrastive_loss: 949507.6821; val_gene_expr_recon_loss: 1883421.8940; val_masked_gp_l1_reg_loss: 52249.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17256.0859; val_global_loss: 3648606.6687; val_optim_loss: 3648606.6687
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9375; val_auprc_score: 0.9872; val_best_acc_score: 0.9393; val_best_f1_score: 0.9658; train_kl_reg_loss: 24138.4047; train_edge_recon_loss: 688611.1276; train_cat_covariates_contrastive_loss: 950623.8597; train_gene_expr_recon_loss: 1884912.7264; train_masked_gp_l1_reg_loss: 52333.6640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17211.0994; train_global_loss: 3617830.8779; train_optim_loss: 3617830.8779; val_kl_reg_loss: 24254.0468; val_edge_recon_loss: 709446.7054; val_cat_covariates_contrastive_loss: 950045.0554; val_gene_expr_recon_loss: 1881883.5567; val_masked_gp_l1_reg_loss: 52475.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17220.6348; val_global_loss: 3635325.1142; val_optim_loss: 3635325.1142

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9389; val_auprc_score: 0.9874; val_best_acc_score: 0.9402; val_best_f1_score: 0.9663; train_kl_reg_loss: 24339.6608; train_edge_recon_loss: 686750.9173; train_cat_covariates_contrastive_loss: 950279.2443; train_gene_expr_recon_loss: 1884090.5249; train_masked_gp_l1_reg_loss: 40719.4431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9348.9997; train_global_loss: 3595528.7894; train_optim_loss: 3595528.7894; val_kl_reg_loss: 24646.4826; val_edge_recon_loss: 714786.2147; val_cat_covariates_contrastive_loss: 949740.3393; val_gene_expr_recon_loss: 1880803.6713; val_masked_gp_l1_reg_loss: 40732.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9139.5459; val_global_loss: 3619848.9516; val_optim_loss: 3619848.9516
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9403; val_auprc_score: 0.9875; val_best_acc_score: 0.9414; val_best_f1_score: 0.9669; train_kl_reg_loss: 24480.0876; train_edge_recon_loss: 688758.5414; train_cat_covariates_contrastive_loss: 950299.8755; train_gene_expr_recon_loss: 1883283.0568; train_masked_gp_l1_reg_loss: 40806.6255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9141.5765; train_global_loss: 3596769.7632; train_optim_loss: 3596769.7632; val_kl_reg_loss: 24527.9455; val_edge_recon_loss: 712039.8428; val_cat_covariates_contrastive_loss: 950225.1003; val_gene_expr_recon_loss: 1881828.8421; val_masked_gp_l1_reg_loss: 40877.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9130.1699; val_global_loss: 3618629.2275; val_optim_loss: 3618629.2275
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9380; val_auprc_score: 0.9871; val_best_acc_score: 0.9399; val_best_f1_score: 0.9660; train_kl_reg_loss: 24467.9588; train_edge_recon_loss: 686098.1803; train_cat_covariates_contrastive_loss: 950196.4021; train_gene_expr_recon_loss: 1882771.4015; train_masked_gp_l1_reg_loss: 40891.1532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9155.4826; train_global_loss: 3593580.5825; train_optim_loss: 3593580.5825; val_kl_reg_loss: 24406.0753; val_edge_recon_loss: 709697.3520; val_cat_covariates_contrastive_loss: 950148.4492; val_gene_expr_recon_loss: 1880442.9866; val_masked_gp_l1_reg_loss: 40950.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9233.2588; val_global_loss: 3614878.8599; val_optim_loss: 3614878.8599
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9381; val_auprc_score: 0.9870; val_best_acc_score: 0.9409; val_best_f1_score: 0.9666; train_kl_reg_loss: 24438.1277; train_edge_recon_loss: 687467.1540; train_cat_covariates_contrastive_loss: 950320.2456; train_gene_expr_recon_loss: 1882572.0905; train_masked_gp_l1_reg_loss: 40960.0898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9166.4076; train_global_loss: 3594924.1161; train_optim_loss: 3594924.1161; val_kl_reg_loss: 24442.0156; val_edge_recon_loss: 711834.5794; val_cat_covariates_contrastive_loss: 949452.3043; val_gene_expr_recon_loss: 1880442.5420; val_masked_gp_l1_reg_loss: 41021.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9184.7588; val_global_loss: 3616377.4343; val_optim_loss: 3616377.4343
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9390; val_auprc_score: 0.9875; val_best_acc_score: 0.9408; val_best_f1_score: 0.9666; train_kl_reg_loss: 24383.2447; train_edge_recon_loss: 685959.6807; train_cat_covariates_contrastive_loss: 950239.3545; train_gene_expr_recon_loss: 1881843.0412; train_masked_gp_l1_reg_loss: 41019.6277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9173.4117; train_global_loss: 3592618.3613; train_optim_loss: 3592618.3613; val_kl_reg_loss: 24267.4167; val_edge_recon_loss: 705721.9610; val_cat_covariates_contrastive_loss: 950287.1438; val_gene_expr_recon_loss: 1879236.4572; val_masked_gp_l1_reg_loss: 41019.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9170.1309; val_global_loss: 3609703.2292; val_optim_loss: 3609703.2292
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9410; val_auprc_score: 0.9878; val_best_acc_score: 0.9408; val_best_f1_score: 0.9666; train_kl_reg_loss: 24373.3767; train_edge_recon_loss: 688020.5060; train_cat_covariates_contrastive_loss: 950187.0355; train_gene_expr_recon_loss: 1881909.3998; train_masked_gp_l1_reg_loss: 41079.4046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9167.6812; train_global_loss: 3594737.4061; train_optim_loss: 3594737.4061; val_kl_reg_loss: 24226.1042; val_edge_recon_loss: 713141.6328; val_cat_covariates_contrastive_loss: 950746.4001; val_gene_expr_recon_loss: 1879168.0493; val_masked_gp_l1_reg_loss: 41086.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9164.5400; val_global_loss: 3617532.6912; val_optim_loss: 3617532.6912
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9405; val_auprc_score: 0.9879; val_best_acc_score: 0.9405; val_best_f1_score: 0.9664; train_kl_reg_loss: 24365.4884; train_edge_recon_loss: 687417.5197; train_cat_covariates_contrastive_loss: 950319.1765; train_gene_expr_recon_loss: 1881695.5491; train_masked_gp_l1_reg_loss: 41134.0285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9178.5660; train_global_loss: 3594110.3312; train_optim_loss: 3594110.3312; val_kl_reg_loss: 24224.3211; val_edge_recon_loss: 704094.2419; val_cat_covariates_contrastive_loss: 950789.6079; val_gene_expr_recon_loss: 1879174.5813; val_masked_gp_l1_reg_loss: 41188.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9212.3604; val_global_loss: 3608683.5043; val_optim_loss: 3608683.5043
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9392; val_auprc_score: 0.9873; val_best_acc_score: 0.9412; val_best_f1_score: 0.9669; train_kl_reg_loss: 24311.9958; train_edge_recon_loss: 687423.5913; train_cat_covariates_contrastive_loss: 950180.2167; train_gene_expr_recon_loss: 1881731.9753; train_masked_gp_l1_reg_loss: 41157.3972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9190.9906; train_global_loss: 3593996.1643; train_optim_loss: 3593996.1643; val_kl_reg_loss: 24350.4783; val_edge_recon_loss: 711334.8326; val_cat_covariates_contrastive_loss: 950631.2156; val_gene_expr_recon_loss: 1877375.1929; val_masked_gp_l1_reg_loss: 41171.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9151.8467; val_global_loss: 3614014.4715; val_optim_loss: 3614014.4715
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9407; val_auprc_score: 0.9877; val_best_acc_score: 0.9420; val_best_f1_score: 0.9673; train_kl_reg_loss: 24279.1184; train_edge_recon_loss: 686550.1733; train_cat_covariates_contrastive_loss: 950133.3895; train_gene_expr_recon_loss: 1881068.1887; train_masked_gp_l1_reg_loss: 41194.4965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9177.3182; train_global_loss: 3592402.6831; train_optim_loss: 3592402.6831; val_kl_reg_loss: 24464.8734; val_edge_recon_loss: 703493.4676; val_cat_covariates_contrastive_loss: 949545.5692; val_gene_expr_recon_loss: 1878567.5709; val_masked_gp_l1_reg_loss: 41178.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9185.3662; val_global_loss: 3606435.4792; val_optim_loss: 3606435.4792
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9398; val_auprc_score: 0.9876; val_best_acc_score: 0.9415; val_best_f1_score: 0.9669; train_kl_reg_loss: 24267.4880; train_edge_recon_loss: 687282.8564; train_cat_covariates_contrastive_loss: 950089.6911; train_gene_expr_recon_loss: 1881464.8043; train_masked_gp_l1_reg_loss: 41207.6262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9191.2382; train_global_loss: 3593503.7070; train_optim_loss: 3593503.7070; val_kl_reg_loss: 24344.2401; val_edge_recon_loss: 706921.8315; val_cat_covariates_contrastive_loss: 950171.7202; val_gene_expr_recon_loss: 1879487.4554; val_masked_gp_l1_reg_loss: 41223.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9111.0996; val_global_loss: 3611259.2431; val_optim_loss: 3611259.2431
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9418; val_auprc_score: 0.9881; val_best_acc_score: 0.9424; val_best_f1_score: 0.9675; train_kl_reg_loss: 24274.5163; train_edge_recon_loss: 687420.2445; train_cat_covariates_contrastive_loss: 950185.0304; train_gene_expr_recon_loss: 1881845.0433; train_masked_gp_l1_reg_loss: 41233.4244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9188.9459; train_global_loss: 3594147.2125; train_optim_loss: 3594147.2125; val_kl_reg_loss: 24392.7505; val_edge_recon_loss: 704698.3910; val_cat_covariates_contrastive_loss: 950198.2742; val_gene_expr_recon_loss: 1876916.8028; val_masked_gp_l1_reg_loss: 41255.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9214.3350; val_global_loss: 3606676.2180; val_optim_loss: 3606676.2180
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9404; val_auprc_score: 0.9873; val_best_acc_score: 0.9416; val_best_f1_score: 0.9671; train_kl_reg_loss: 24275.7323; train_edge_recon_loss: 686975.4051; train_cat_covariates_contrastive_loss: 950234.3907; train_gene_expr_recon_loss: 1881738.4803; train_masked_gp_l1_reg_loss: 41256.4830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9198.9790; train_global_loss: 3593679.4698; train_optim_loss: 3593679.4698; val_kl_reg_loss: 24346.2455; val_edge_recon_loss: 711621.5678; val_cat_covariates_contrastive_loss: 950343.5670; val_gene_expr_recon_loss: 1878156.2920; val_masked_gp_l1_reg_loss: 41281.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9167.7178; val_global_loss: 3614916.9152; val_optim_loss: 3614916.9152
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9400; val_auprc_score: 0.9875; val_best_acc_score: 0.9427; val_best_f1_score: 0.9677; train_kl_reg_loss: 24232.7077; train_edge_recon_loss: 684726.7598; train_cat_covariates_contrastive_loss: 950101.1151; train_gene_expr_recon_loss: 1881257.5428; train_masked_gp_l1_reg_loss: 41280.0623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9205.1203; train_global_loss: 3590803.3098; train_optim_loss: 3590803.3098; val_kl_reg_loss: 24225.8810; val_edge_recon_loss: 707149.0301; val_cat_covariates_contrastive_loss: 949868.5528; val_gene_expr_recon_loss: 1877723.7785; val_masked_gp_l1_reg_loss: 41305.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9235.6162; val_global_loss: 3609508.4948; val_optim_loss: 3609508.4948

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9411; val_auprc_score: 0.9878; val_best_acc_score: 0.9416; val_best_f1_score: 0.9670; train_kl_reg_loss: 24332.6051; train_edge_recon_loss: 685884.7087; train_cat_covariates_contrastive_loss: 950594.4515; train_gene_expr_recon_loss: 1880936.4769; train_masked_gp_l1_reg_loss: 39933.5987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8312.1342; train_global_loss: 3589993.9730; train_optim_loss: 3589993.9730; val_kl_reg_loss: 23944.1028; val_edge_recon_loss: 707896.7971; val_cat_covariates_contrastive_loss: 950439.7827; val_gene_expr_recon_loss: 1878158.1237; val_masked_gp_l1_reg_loss: 39909.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8287.2891; val_global_loss: 3608635.5536; val_optim_loss: 3608635.5536
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9429; val_auprc_score: 0.9881; val_best_acc_score: 0.9421; val_best_f1_score: 0.9672; train_kl_reg_loss: 24332.8783; train_edge_recon_loss: 688434.0021; train_cat_covariates_contrastive_loss: 950317.2702; train_gene_expr_recon_loss: 1880690.1034; train_masked_gp_l1_reg_loss: 39933.7128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8294.4517; train_global_loss: 3592002.4247; train_optim_loss: 3592002.4247; val_kl_reg_loss: 23824.3157; val_edge_recon_loss: 713934.6564; val_cat_covariates_contrastive_loss: 950325.6429; val_gene_expr_recon_loss: 1877561.6328; val_masked_gp_l1_reg_loss: 39949.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8304.4414; val_global_loss: 3613900.2474; val_optim_loss: 3613900.2474
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9411; val_auprc_score: 0.9878; val_best_acc_score: 0.9408; val_best_f1_score: 0.9666; train_kl_reg_loss: 24264.8949; train_edge_recon_loss: 688545.4645; train_cat_covariates_contrastive_loss: 950445.8204; train_gene_expr_recon_loss: 1881067.0944; train_masked_gp_l1_reg_loss: 39945.5358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8290.6328; train_global_loss: 3592559.4446; train_optim_loss: 3592559.4446; val_kl_reg_loss: 23974.3133; val_edge_recon_loss: 710586.9327; val_cat_covariates_contrastive_loss: 950900.1391; val_gene_expr_recon_loss: 1876805.3313; val_masked_gp_l1_reg_loss: 39947.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8285.2598; val_global_loss: 3610499.2128; val_optim_loss: 3610499.2128
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9397; val_auprc_score: 0.9875; val_best_acc_score: 0.9409; val_best_f1_score: 0.9666; train_kl_reg_loss: 24277.8786; train_edge_recon_loss: 685668.3678; train_cat_covariates_contrastive_loss: 950380.3221; train_gene_expr_recon_loss: 1880768.9920; train_masked_gp_l1_reg_loss: 39949.1225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8284.8855; train_global_loss: 3589329.5760; train_optim_loss: 3589329.5760; val_kl_reg_loss: 24113.6460; val_edge_recon_loss: 710061.0212; val_cat_covariates_contrastive_loss: 950182.3741; val_gene_expr_recon_loss: 1878395.6795; val_masked_gp_l1_reg_loss: 39958.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8290.2959; val_global_loss: 3611001.7215; val_optim_loss: 3611001.7215

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 921 min 42 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9121
val AUPRC score: 0.9765
val best accuracy score: 0.9378
val best F1 score: 0.9648
val target rna MSE score: 0.3739
val source rna MSE score: 0.1442
Val cat covariate0 mean sim diff: -0.0010
Val cat covariate1 mean sim diff: -0.0575
Val cat covariate2 mean sim diff: 0.0002

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
