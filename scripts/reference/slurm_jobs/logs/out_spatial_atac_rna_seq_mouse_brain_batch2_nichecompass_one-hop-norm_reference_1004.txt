[True]
Run timestamp: 10082023_132837_1004.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1004']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7286; val_auprc_score: 0.7584; val_best_acc_score: 0.5046; val_best_f1_score: 0.6682; train_kl_reg_loss: 95208.8441; train_edge_recon_loss: 3608711.4924; train_gene_expr_recon_loss: 14809654.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 740177.1951; train_global_loss: 19253752.5649; train_optim_loss: 19253752.5649; val_kl_reg_loss: 91788.6865; val_edge_recon_loss: 4064652.2333; val_gene_expr_recon_loss: 13117684.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 706347.6167; val_global_loss: 17980473.2000; val_optim_loss: 17980473.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7860; val_auprc_score: 0.7977; val_best_acc_score: 0.7067; val_best_f1_score: 0.7076; train_kl_reg_loss: 100297.0521; train_edge_recon_loss: 3529015.4809; train_gene_expr_recon_loss: 12761093.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 693582.4590; train_global_loss: 17083988.6412; train_optim_loss: 17083988.6412; val_kl_reg_loss: 110092.2417; val_edge_recon_loss: 4028479.4000; val_gene_expr_recon_loss: 12488445.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 685526.3000; val_global_loss: 17312543.7333; val_optim_loss: 17312543.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8194; val_auprc_score: 0.8310; val_best_acc_score: 0.7301; val_best_f1_score: 0.7443; train_kl_reg_loss: 86148.7646; train_edge_recon_loss: 3442680.3798; train_gene_expr_recon_loss: 12440284.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 682166.9146; train_global_loss: 16651280.5038; train_optim_loss: 16651280.5038; val_kl_reg_loss: 77508.6047; val_edge_recon_loss: 3328798.1833; val_gene_expr_recon_loss: 12380843.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 685215.6708; val_global_loss: 16472365.6667; val_optim_loss: 16472365.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8504; val_auprc_score: 0.8563; val_best_acc_score: 0.7525; val_best_f1_score: 0.7713; train_kl_reg_loss: 92203.5732; train_edge_recon_loss: 3153139.4218; train_gene_expr_recon_loss: 12324566.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 675790.5143; train_global_loss: 16245700.2214; train_optim_loss: 16245700.2214; val_kl_reg_loss: 96275.2604; val_edge_recon_loss: 3127541.4333; val_gene_expr_recon_loss: 12228965.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 674756.2500; val_global_loss: 16127538.2000; val_optim_loss: 16127538.2000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8784; val_auprc_score: 0.8621; val_best_acc_score: 0.7878; val_best_f1_score: 0.8088; train_kl_reg_loss: 97364.6227; train_edge_recon_loss: 3017219.3111; train_gene_expr_recon_loss: 12162423.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 668377.5344; train_global_loss: 15945384.9466; train_optim_loss: 15945384.9466; val_kl_reg_loss: 89761.8839; val_edge_recon_loss: 2963255.5833; val_gene_expr_recon_loss: 12108966.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 668396.4083; val_global_loss: 15830380.0667; val_optim_loss: 15830380.0667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9011; val_auprc_score: 0.8846; val_best_acc_score: 0.8244; val_best_f1_score: 0.8358; train_kl_reg_loss: 96938.8387; train_edge_recon_loss: 2909681.7080; train_gene_expr_recon_loss: 12046107.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 661777.5868; train_global_loss: 15714505.4504; train_optim_loss: 15714505.4504; val_kl_reg_loss: 95376.9563; val_edge_recon_loss: 2886217.3000; val_gene_expr_recon_loss: 11986956.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 659711.0583; val_global_loss: 15628261.6000; val_optim_loss: 15628261.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9174; val_auprc_score: 0.9037; val_best_acc_score: 0.8468; val_best_f1_score: 0.8533; train_kl_reg_loss: 97126.3708; train_edge_recon_loss: 2849068.0553; train_gene_expr_recon_loss: 11940594.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 656406.7595; train_global_loss: 15543195.9313; train_optim_loss: 15543195.9313; val_kl_reg_loss: 96870.4031; val_edge_recon_loss: 2844288.1833; val_gene_expr_recon_loss: 11889345.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 655161.5583; val_global_loss: 15485665.9333; val_optim_loss: 15485665.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9252; val_auprc_score: 0.9122; val_best_acc_score: 0.8556; val_best_f1_score: 0.8607; train_kl_reg_loss: 97426.8257; train_edge_recon_loss: 2832248.4275; train_gene_expr_recon_loss: 11851752.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 651901.6818; train_global_loss: 15433329.2061; train_optim_loss: 15433329.2061; val_kl_reg_loss: 97807.4323; val_edge_recon_loss: 2839403.7000; val_gene_expr_recon_loss: 11800174.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 650901.6208; val_global_loss: 15388286.6667; val_optim_loss: 15388286.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9378; val_auprc_score: 0.9260; val_best_acc_score: 0.8720; val_best_f1_score: 0.8767; train_kl_reg_loss: 93846.2365; train_edge_recon_loss: 2813603.5324; train_gene_expr_recon_loss: 11764069.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 647483.6326; train_global_loss: 15319002.6947; train_optim_loss: 15319002.6947; val_kl_reg_loss: 91904.0286; val_edge_recon_loss: 2795519.3167; val_gene_expr_recon_loss: 11680824.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 645463.3167; val_global_loss: 15213711.4667; val_optim_loss: 15213711.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9318; val_auprc_score: 0.9147; val_best_acc_score: 0.8673; val_best_f1_score: 0.8723; train_kl_reg_loss: 93764.6277; train_edge_recon_loss: 2790910.3740; train_gene_expr_recon_loss: 11691412.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 643252.8182; train_global_loss: 15219340.0992; train_optim_loss: 15219340.0992; val_kl_reg_loss: 90931.4599; val_edge_recon_loss: 2795195.2833; val_gene_expr_recon_loss: 11659410.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 644653.3917; val_global_loss: 15190190.1333; val_optim_loss: 15190190.1333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9379; val_auprc_score: 0.9249; val_best_acc_score: 0.8743; val_best_f1_score: 0.8806; train_kl_reg_loss: 88646.4184; train_edge_recon_loss: 2786706.3435; train_gene_expr_recon_loss: 11636246.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 640037.8330; train_global_loss: 15151637.1985; train_optim_loss: 15151637.1985; val_kl_reg_loss: 89959.3276; val_edge_recon_loss: 2775511.0833; val_gene_expr_recon_loss: 11582985.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 638479.9708; val_global_loss: 15086935.4667; val_optim_loss: 15086935.4667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9411; val_auprc_score: 0.9269; val_best_acc_score: 0.8770; val_best_f1_score: 0.8831; train_kl_reg_loss: 85501.9639; train_edge_recon_loss: 2790415.8187; train_gene_expr_recon_loss: 11570370.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 636686.9928; train_global_loss: 15082975.4351; train_optim_loss: 15082975.4351; val_kl_reg_loss: 82780.8995; val_edge_recon_loss: 2790244.4167; val_gene_expr_recon_loss: 11522309.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 634757.2625; val_global_loss: 15030092.0667; val_optim_loss: 15030092.0667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9438; val_auprc_score: 0.9322; val_best_acc_score: 0.8794; val_best_f1_score: 0.8847; train_kl_reg_loss: 83359.8401; train_edge_recon_loss: 2757803.8073; train_gene_expr_recon_loss: 11512848.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 633208.5052; train_global_loss: 14987220.5725; train_optim_loss: 14987220.5725; val_kl_reg_loss: 80315.2302; val_edge_recon_loss: 2790181.2833; val_gene_expr_recon_loss: 11481725.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 633635.7625; val_global_loss: 14985857.3333; val_optim_loss: 14985857.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9442; val_auprc_score: 0.9309; val_best_acc_score: 0.8805; val_best_f1_score: 0.8874; train_kl_reg_loss: 79858.9552; train_edge_recon_loss: 2763294.5363; train_gene_expr_recon_loss: 11472126.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 631195.6880; train_global_loss: 14946476.2366; train_optim_loss: 14946476.2366; val_kl_reg_loss: 82241.0750; val_edge_recon_loss: 2775095.3833; val_gene_expr_recon_loss: 11460806.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 631702.2292; val_global_loss: 14949844.9333; val_optim_loss: 14949844.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9469; val_auprc_score: 0.9320; val_best_acc_score: 0.8863; val_best_f1_score: 0.8925; train_kl_reg_loss: 76320.7979; train_edge_recon_loss: 2761285.4447; train_gene_expr_recon_loss: 11427085.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 628172.4389; train_global_loss: 14892863.9466; train_optim_loss: 14892863.9466; val_kl_reg_loss: 79056.5781; val_edge_recon_loss: 2760730.0500; val_gene_expr_recon_loss: 11409977.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 627652.5250; val_global_loss: 14877416.9333; val_optim_loss: 14877416.9333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9510; val_auprc_score: 0.9368; val_best_acc_score: 0.8940; val_best_f1_score: 0.8980; train_kl_reg_loss: 75797.8820; train_edge_recon_loss: 2752718.3435; train_gene_expr_recon_loss: 11386983.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 625591.2925; train_global_loss: 14841091.1908; train_optim_loss: 14841091.1908; val_kl_reg_loss: 74452.1687; val_edge_recon_loss: 2761072.5000; val_gene_expr_recon_loss: 11408734.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 626133.6292; val_global_loss: 14870392.4000; val_optim_loss: 14870392.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9566; val_auprc_score: 0.9468; val_best_acc_score: 0.8964; val_best_f1_score: 0.8987; train_kl_reg_loss: 74198.2702; train_edge_recon_loss: 2733671.8855; train_gene_expr_recon_loss: 11358310.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 624644.6269; train_global_loss: 14790825.1298; train_optim_loss: 14790825.1298; val_kl_reg_loss: 70717.7396; val_edge_recon_loss: 2736545.9833; val_gene_expr_recon_loss: 11338117.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 630721.6125; val_global_loss: 14776103.2000; val_optim_loss: 14776103.2000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9500; val_auprc_score: 0.9369; val_best_acc_score: 0.8894; val_best_f1_score: 0.8952; train_kl_reg_loss: 73292.3252; train_edge_recon_loss: 2726037.8874; train_gene_expr_recon_loss: 11321076.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 622776.9909; train_global_loss: 14743183.7252; train_optim_loss: 14743183.7252; val_kl_reg_loss: 75198.1078; val_edge_recon_loss: 2739248.3667; val_gene_expr_recon_loss: 11294567.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 622976.5958; val_global_loss: 14731990.7333; val_optim_loss: 14731990.7333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9499; val_auprc_score: 0.9375; val_best_acc_score: 0.8901; val_best_f1_score: 0.8948; train_kl_reg_loss: 71385.2665; train_edge_recon_loss: 2712834.2901; train_gene_expr_recon_loss: 11291017.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 620804.1088; train_global_loss: 14696040.7099; train_optim_loss: 14696040.7099; val_kl_reg_loss: 69545.1120; val_edge_recon_loss: 2750343.1167; val_gene_expr_recon_loss: 11300264.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 623397.8708; val_global_loss: 14743550.0667; val_optim_loss: 14743550.0667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9568; val_auprc_score: 0.9472; val_best_acc_score: 0.8987; val_best_f1_score: 0.9033; train_kl_reg_loss: 70619.6004; train_edge_recon_loss: 2714806.2500; train_gene_expr_recon_loss: 11265062.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 619452.9652; train_global_loss: 14669941.5725; train_optim_loss: 14669941.5725; val_kl_reg_loss: 70649.0656; val_edge_recon_loss: 2719171.3833; val_gene_expr_recon_loss: 11198426.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 618020.5875; val_global_loss: 14606267.8000; val_optim_loss: 14606267.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9631; val_auprc_score: 0.9549; val_best_acc_score: 0.9072; val_best_f1_score: 0.9101; train_kl_reg_loss: 69586.9666; train_edge_recon_loss: 2710785.2347; train_gene_expr_recon_loss: 11231037.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 617544.5744; train_global_loss: 14628953.8168; train_optim_loss: 14628953.8168; val_kl_reg_loss: 66120.5453; val_edge_recon_loss: 2703903.1667; val_gene_expr_recon_loss: 11234013.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 620409.0667; val_global_loss: 14624446.6000; val_optim_loss: 14624446.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9602; val_auprc_score: 0.9505; val_best_acc_score: 0.9010; val_best_f1_score: 0.9050; train_kl_reg_loss: 66427.8766; train_edge_recon_loss: 2703100.2786; train_gene_expr_recon_loss: 11206409.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 616238.1751; train_global_loss: 14592175.7786; train_optim_loss: 14592175.7786; val_kl_reg_loss: 67088.1443; val_edge_recon_loss: 2725401.5333; val_gene_expr_recon_loss: 11187940.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 618193.0625; val_global_loss: 14598623.5333; val_optim_loss: 14598623.5333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9622; val_auprc_score: 0.9506; val_best_acc_score: 0.9068; val_best_f1_score: 0.9100; train_kl_reg_loss: 65303.2601; train_edge_recon_loss: 2705667.6489; train_gene_expr_recon_loss: 11184237.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 615221.8717; train_global_loss: 14570430.1527; train_optim_loss: 14570430.1527; val_kl_reg_loss: 65180.6312; val_edge_recon_loss: 2705830.5667; val_gene_expr_recon_loss: 11157443.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 614651.4958; val_global_loss: 14543105.8000; val_optim_loss: 14543105.8000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9599; val_auprc_score: 0.9495; val_best_acc_score: 0.9045; val_best_f1_score: 0.9079; train_kl_reg_loss: 64143.8566; train_edge_recon_loss: 2704046.6889; train_gene_expr_recon_loss: 11163420.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 614012.5095; train_global_loss: 14545623.3282; train_optim_loss: 14545623.3282; val_kl_reg_loss: 65136.1234; val_edge_recon_loss: 2729069.4333; val_gene_expr_recon_loss: 11168876.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 615093.1000; val_global_loss: 14578174.9333; val_optim_loss: 14578174.9333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9665; val_auprc_score: 0.9572; val_best_acc_score: 0.9124; val_best_f1_score: 0.9157; train_kl_reg_loss: 63497.6193; train_edge_recon_loss: 2700481.9599; train_gene_expr_recon_loss: 11145329.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 613399.1050; train_global_loss: 14522708.6260; train_optim_loss: 14522708.6260; val_kl_reg_loss: 61418.4482; val_edge_recon_loss: 2683192.1000; val_gene_expr_recon_loss: 11203869.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 616276.2833; val_global_loss: 14564756.3333; val_optim_loss: 14564756.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9544; val_auprc_score: 0.9416; val_best_acc_score: 0.8975; val_best_f1_score: 0.9020; train_kl_reg_loss: 101929.0098; train_edge_recon_loss: 2839926.1985; train_gene_expr_recon_loss: 12568346.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 652311.3788; train_global_loss: 16162513.4885; train_optim_loss: 16162513.4885; val_kl_reg_loss: 8793.4274; val_edge_recon_loss: 2789946.7667; val_gene_expr_recon_loss: 12874705.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 656123.0292; val_global_loss: 16329568.8000; val_optim_loss: 16329568.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9594; val_auprc_score: 0.9459; val_best_acc_score: 0.9057; val_best_f1_score: 0.9099; train_kl_reg_loss: 62605.7538; train_edge_recon_loss: 2727911.7901; train_gene_expr_recon_loss: 12845737.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 654103.9666; train_global_loss: 16290358.7786; train_optim_loss: 16290358.7786; val_kl_reg_loss: 11653.7546; val_edge_recon_loss: 2699755.9000; val_gene_expr_recon_loss: 12912017.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 656674.2625; val_global_loss: 16280101.5333; val_optim_loss: 16280101.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9601; val_auprc_score: 0.9497; val_best_acc_score: 0.9061; val_best_f1_score: 0.9088; train_kl_reg_loss: 48217.4125; train_edge_recon_loss: 2697385.5840; train_gene_expr_recon_loss: 12844331.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 653020.8678; train_global_loss: 16242955.0000; train_optim_loss: 16242955.0000; val_kl_reg_loss: 11764.9091; val_edge_recon_loss: 2706253.6333; val_gene_expr_recon_loss: 12837749.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 655486.1750; val_global_loss: 16211254.0667; val_optim_loss: 16211254.0667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9627; val_auprc_score: 0.9509; val_best_acc_score: 0.9095; val_best_f1_score: 0.9125; train_kl_reg_loss: 45195.3467; train_edge_recon_loss: 2702811.7882; train_gene_expr_recon_loss: 12837018.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 652052.7796; train_global_loss: 16237078.2443; train_optim_loss: 16237078.2443; val_kl_reg_loss: 11893.7024; val_edge_recon_loss: 2707782.4167; val_gene_expr_recon_loss: 12867662.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 653767.3500; val_global_loss: 16241105.8667; val_optim_loss: 16241105.8667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9617; val_auprc_score: 0.9474; val_best_acc_score: 0.9081; val_best_f1_score: 0.9118; train_kl_reg_loss: 43586.0444; train_edge_recon_loss: 2696717.8683; train_gene_expr_recon_loss: 12846826.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 652619.2729; train_global_loss: 16239749.7863; train_optim_loss: 16239749.7863; val_kl_reg_loss: 12251.1700; val_edge_recon_loss: 2706818.3000; val_gene_expr_recon_loss: 12873538.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 655446.9333; val_global_loss: 16248054.4667; val_optim_loss: 16248054.4667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9558; val_auprc_score: 0.9393; val_best_acc_score: 0.9034; val_best_f1_score: 0.9067; train_kl_reg_loss: 41631.0476; train_edge_recon_loss: 2697084.3683; train_gene_expr_recon_loss: 12854737.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 652693.4074; train_global_loss: 16246146.6794; train_optim_loss: 16246146.6794; val_kl_reg_loss: 12377.7045; val_edge_recon_loss: 2730408.9333; val_gene_expr_recon_loss: 12853925.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 652393.8208; val_global_loss: 16249105.6000; val_optim_loss: 16249105.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 38 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9622
val AUPRC score: 0.9535
val best accuracy score: 0.9039
val best F1 score: 0.9073
val target rna MSE score: 1.7415
val source rna MSE score: 13.3060
val target atac MSE score: 0.6049
val source atac MSE score: 0.1525
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
