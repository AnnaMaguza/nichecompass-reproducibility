[True]
Run timestamp: 10082023_193017_23.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_23']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7275; val_auprc_score: 0.7589; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 104137.3784; train_edge_recon_loss: 3752532.0725; train_gene_expr_recon_loss: 26472280.2748; train_masked_gp_l1_reg_loss: 80921.4893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241249.8111; train_chrom_access_recon_loss: 4083093.3130; train_global_loss: 34734214.5038; train_optim_loss: 34734214.5038; val_kl_reg_loss: 244262.7021; val_edge_recon_loss: 4065816.5167; val_gene_expr_recon_loss: 22886779.2000; val_masked_gp_l1_reg_loss: 78368.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 231871.0469; val_chrom_access_recon_loss: 3818271.1333; val_global_loss: 31325369.3333; val_optim_loss: 31325369.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7892; val_auprc_score: 0.8039; val_best_acc_score: 0.6129; val_best_f1_score: 0.7124; train_kl_reg_loss: 169517.8129; train_edge_recon_loss: 3599200.3359; train_gene_expr_recon_loss: 22630804.5038; train_masked_gp_l1_reg_loss: 75311.8736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 220853.0465; train_chrom_access_recon_loss: 3841596.2996; train_global_loss: 30537283.7557; train_optim_loss: 30537283.7557; val_kl_reg_loss: 181756.0812; val_edge_recon_loss: 4057206.4333; val_gene_expr_recon_loss: 22032297.8667; val_masked_gp_l1_reg_loss: 74050.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209808.7344; val_chrom_access_recon_loss: 3742730.0000; val_global_loss: 30297848.0000; val_optim_loss: 30297848.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8286; val_auprc_score: 0.8356; val_best_acc_score: 0.7466; val_best_f1_score: 0.7415; train_kl_reg_loss: 154751.4084; train_edge_recon_loss: 3548651.9466; train_gene_expr_recon_loss: 22216257.5725; train_masked_gp_l1_reg_loss: 73959.9747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199356.0222; train_chrom_access_recon_loss: 3807627.2996; train_global_loss: 30000604.3053; train_optim_loss: 30000604.3053; val_kl_reg_loss: 139990.5375; val_edge_recon_loss: 4000143.8667; val_gene_expr_recon_loss: 21858820.0000; val_masked_gp_l1_reg_loss: 74466.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189197.3594; val_chrom_access_recon_loss: 3738298.9333; val_global_loss: 30000917.3333; val_optim_loss: 30000917.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8842; val_auprc_score: 0.8797; val_best_acc_score: 0.7990; val_best_f1_score: 0.8064; train_kl_reg_loss: 131292.3709; train_edge_recon_loss: 3497173.0706; train_gene_expr_recon_loss: 21999797.0840; train_masked_gp_l1_reg_loss: 76084.9376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180023.7221; train_chrom_access_recon_loss: 3783697.5458; train_global_loss: 29668068.7786; train_optim_loss: 29668068.7786; val_kl_reg_loss: 101038.0380; val_edge_recon_loss: 3699447.2667; val_gene_expr_recon_loss: 21885680.0000; val_masked_gp_l1_reg_loss: 78415.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171246.6562; val_chrom_access_recon_loss: 3725426.7833; val_global_loss: 29661253.8667; val_optim_loss: 29661253.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8806; val_auprc_score: 0.8716; val_best_acc_score: 0.7899; val_best_f1_score: 0.8024; train_kl_reg_loss: 132822.3939; train_edge_recon_loss: 3217254.2214; train_gene_expr_recon_loss: 21859341.2214; train_masked_gp_l1_reg_loss: 80944.1645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163866.6461; train_chrom_access_recon_loss: 3764612.2844; train_global_loss: 29218840.8550; train_optim_loss: 29218840.8550; val_kl_reg_loss: 160463.5573; val_edge_recon_loss: 3055317.4167; val_gene_expr_recon_loss: 21611266.2667; val_masked_gp_l1_reg_loss: 83164.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156838.0312; val_chrom_access_recon_loss: 3714147.6667; val_global_loss: 28781196.9333; val_optim_loss: 28781196.9333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9077; val_auprc_score: 0.8971; val_best_acc_score: 0.8246; val_best_f1_score: 0.8356; train_kl_reg_loss: 160403.3255; train_edge_recon_loss: 2982871.2500; train_gene_expr_recon_loss: 21689810.1679; train_masked_gp_l1_reg_loss: 84791.0358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150585.5776; train_chrom_access_recon_loss: 3749560.5630; train_global_loss: 28818021.7405; train_optim_loss: 28818021.7405; val_kl_reg_loss: 155498.4438; val_edge_recon_loss: 2940462.9667; val_gene_expr_recon_loss: 21443207.0667; val_masked_gp_l1_reg_loss: 86302.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144231.8438; val_chrom_access_recon_loss: 3690247.1667; val_global_loss: 28459949.6000; val_optim_loss: 28459949.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9225; val_auprc_score: 0.9089; val_best_acc_score: 0.8507; val_best_f1_score: 0.8595; train_kl_reg_loss: 150757.6584; train_edge_recon_loss: 2931701.3282; train_gene_expr_recon_loss: 21583566.6260; train_masked_gp_l1_reg_loss: 88176.8736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138329.7434; train_chrom_access_recon_loss: 3735419.6050; train_global_loss: 28627952.0000; train_optim_loss: 28627952.0000; val_kl_reg_loss: 151654.1063; val_edge_recon_loss: 2897910.6833; val_gene_expr_recon_loss: 21343574.5333; val_masked_gp_l1_reg_loss: 90387.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132585.7188; val_chrom_access_recon_loss: 3677746.7500; val_global_loss: 28293859.8667; val_optim_loss: 28293859.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9251; val_auprc_score: 0.9110; val_best_acc_score: 0.8581; val_best_f1_score: 0.8665; train_kl_reg_loss: 148962.9165; train_edge_recon_loss: 2887857.7576; train_gene_expr_recon_loss: 21464527.1756; train_masked_gp_l1_reg_loss: 91537.4404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127490.6486; train_chrom_access_recon_loss: 3721507.0477; train_global_loss: 28441883.0076; train_optim_loss: 28441883.0076; val_kl_reg_loss: 143524.6146; val_edge_recon_loss: 2888858.2833; val_gene_expr_recon_loss: 21267371.0667; val_masked_gp_l1_reg_loss: 92757.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122623.8672; val_chrom_access_recon_loss: 3668107.6833; val_global_loss: 28183243.4667; val_optim_loss: 28183243.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9284; val_auprc_score: 0.9122; val_best_acc_score: 0.8650; val_best_f1_score: 0.8727; train_kl_reg_loss: 144998.4295; train_edge_recon_loss: 2862300.6775; train_gene_expr_recon_loss: 21369070.3969; train_masked_gp_l1_reg_loss: 93810.4334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118202.9368; train_chrom_access_recon_loss: 3707574.4160; train_global_loss: 28295957.1756; train_optim_loss: 28295957.1756; val_kl_reg_loss: 145752.3458; val_edge_recon_loss: 2865054.2000; val_gene_expr_recon_loss: 21139637.4667; val_masked_gp_l1_reg_loss: 94832.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113982.0078; val_chrom_access_recon_loss: 3658957.4667; val_global_loss: 28018215.3333; val_optim_loss: 28018215.3333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9368; val_auprc_score: 0.9242; val_best_acc_score: 0.8729; val_best_f1_score: 0.8780; train_kl_reg_loss: 140028.4356; train_edge_recon_loss: 2852984.3511; train_gene_expr_recon_loss: 21265670.5802; train_masked_gp_l1_reg_loss: 95800.0405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110051.1653; train_chrom_access_recon_loss: 3695463.5649; train_global_loss: 28159997.9847; train_optim_loss: 28159997.9847; val_kl_reg_loss: 140128.3104; val_edge_recon_loss: 2850397.7500; val_gene_expr_recon_loss: 20985174.4000; val_masked_gp_l1_reg_loss: 97066.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106286.9141; val_chrom_access_recon_loss: 3621166.6500; val_global_loss: 27800218.6667; val_optim_loss: 27800218.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9401; val_auprc_score: 0.9264; val_best_acc_score: 0.8751; val_best_f1_score: 0.8825; train_kl_reg_loss: 138366.9980; train_edge_recon_loss: 2831420.5172; train_gene_expr_recon_loss: 21193112.7328; train_masked_gp_l1_reg_loss: 97802.2313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103052.8134; train_chrom_access_recon_loss: 3685111.3378; train_global_loss: 28048866.7023; train_optim_loss: 28048866.7023; val_kl_reg_loss: 135655.7224; val_edge_recon_loss: 2837030.2000; val_gene_expr_recon_loss: 21019443.7333; val_masked_gp_l1_reg_loss: 98877.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99747.3906; val_chrom_access_recon_loss: 3631526.1667; val_global_loss: 27822282.1333; val_optim_loss: 27822282.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9431; val_auprc_score: 0.9324; val_best_acc_score: 0.8793; val_best_f1_score: 0.8857; train_kl_reg_loss: 133576.5726; train_edge_recon_loss: 2820667.7481; train_gene_expr_recon_loss: 21134868.2595; train_masked_gp_l1_reg_loss: 99647.9987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96849.2272; train_chrom_access_recon_loss: 3677015.0229; train_global_loss: 27962624.8550; train_optim_loss: 27962624.8550; val_kl_reg_loss: 132772.5094; val_edge_recon_loss: 2812394.1667; val_gene_expr_recon_loss: 20952340.1333; val_masked_gp_l1_reg_loss: 100625.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94114.7344; val_chrom_access_recon_loss: 3637173.8833; val_global_loss: 27729420.6667; val_optim_loss: 27729420.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9499; val_auprc_score: 0.9407; val_best_acc_score: 0.8856; val_best_f1_score: 0.8892; train_kl_reg_loss: 130696.6928; train_edge_recon_loss: 2801974.7939; train_gene_expr_recon_loss: 21073348.6718; train_masked_gp_l1_reg_loss: 101382.4367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91364.2772; train_chrom_access_recon_loss: 3669994.8626; train_global_loss: 27868761.7557; train_optim_loss: 27868761.7557; val_kl_reg_loss: 134441.5344; val_edge_recon_loss: 2804760.6833; val_gene_expr_recon_loss: 20805380.2667; val_masked_gp_l1_reg_loss: 102141.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88703.7578; val_chrom_access_recon_loss: 3611618.8333; val_global_loss: 27547046.9333; val_optim_loss: 27547046.9333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9520; val_auprc_score: 0.9411; val_best_acc_score: 0.8909; val_best_f1_score: 0.8964; train_kl_reg_loss: 127322.7738; train_edge_recon_loss: 2797950.5916; train_gene_expr_recon_loss: 20998457.5420; train_masked_gp_l1_reg_loss: 103024.4077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86180.3399; train_chrom_access_recon_loss: 3660238.1126; train_global_loss: 27773173.8473; train_optim_loss: 27773173.8473; val_kl_reg_loss: 125467.8745; val_edge_recon_loss: 2792035.1333; val_gene_expr_recon_loss: 20842521.7333; val_masked_gp_l1_reg_loss: 103998.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83768.7188; val_chrom_access_recon_loss: 3621823.5000; val_global_loss: 27569614.4000; val_optim_loss: 27569614.4000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9536; val_auprc_score: 0.9435; val_best_acc_score: 0.8964; val_best_f1_score: 0.8990; train_kl_reg_loss: 125120.8090; train_edge_recon_loss: 2781919.1927; train_gene_expr_recon_loss: 20967391.4198; train_masked_gp_l1_reg_loss: 104753.6669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81464.2622; train_chrom_access_recon_loss: 3656023.2481; train_global_loss: 27716672.3664; train_optim_loss: 27716672.3664; val_kl_reg_loss: 124291.8115; val_edge_recon_loss: 2781735.5500; val_gene_expr_recon_loss: 20872326.6667; val_masked_gp_l1_reg_loss: 105735.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79281.2500; val_chrom_access_recon_loss: 3617277.8167; val_global_loss: 27580649.8667; val_optim_loss: 27580649.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9523; val_auprc_score: 0.9434; val_best_acc_score: 0.8918; val_best_f1_score: 0.8959; train_kl_reg_loss: 122450.1302; train_edge_recon_loss: 2782426.6183; train_gene_expr_recon_loss: 20945122.1221; train_masked_gp_l1_reg_loss: 106487.6508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77250.9936; train_chrom_access_recon_loss: 3654715.5324; train_global_loss: 27688452.9771; train_optim_loss: 27688452.9771; val_kl_reg_loss: 121779.8188; val_edge_recon_loss: 2794462.3833; val_gene_expr_recon_loss: 20686650.1333; val_masked_gp_l1_reg_loss: 107229.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75173.4922; val_chrom_access_recon_loss: 3589570.0833; val_global_loss: 27374866.4000; val_optim_loss: 27374866.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9599; val_auprc_score: 0.9500; val_best_acc_score: 0.9031; val_best_f1_score: 0.9055; train_kl_reg_loss: 121210.7890; train_edge_recon_loss: 2773313.5821; train_gene_expr_recon_loss: 20854227.9695; train_masked_gp_l1_reg_loss: 108012.4316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73277.7093; train_chrom_access_recon_loss: 3640631.0897; train_global_loss: 27570673.6031; train_optim_loss: 27570673.6031; val_kl_reg_loss: 119677.3568; val_edge_recon_loss: 2755976.4333; val_gene_expr_recon_loss: 20667050.0000; val_masked_gp_l1_reg_loss: 108943.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71422.0938; val_chrom_access_recon_loss: 3595009.9667; val_global_loss: 27318079.6000; val_optim_loss: 27318079.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9585; val_auprc_score: 0.9513; val_best_acc_score: 0.8956; val_best_f1_score: 0.8992; train_kl_reg_loss: 118254.8634; train_edge_recon_loss: 2763466.1908; train_gene_expr_recon_loss: 20845892.8550; train_masked_gp_l1_reg_loss: 109569.9825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69685.0883; train_chrom_access_recon_loss: 3642884.6698; train_global_loss: 27549753.8473; train_optim_loss: 27549753.8473; val_kl_reg_loss: 118817.3339; val_edge_recon_loss: 2780144.6000; val_gene_expr_recon_loss: 20639306.2667; val_masked_gp_l1_reg_loss: 110322.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68044.7188; val_chrom_access_recon_loss: 3581001.7333; val_global_loss: 27297636.0000; val_optim_loss: 27297636.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9626; val_auprc_score: 0.9525; val_best_acc_score: 0.9053; val_best_f1_score: 0.9081; train_kl_reg_loss: 116876.7154; train_edge_recon_loss: 2756891.6069; train_gene_expr_recon_loss: 20775027.9389; train_masked_gp_l1_reg_loss: 111081.8036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66491.2328; train_chrom_access_recon_loss: 3629933.1164; train_global_loss: 27456302.2901; train_optim_loss: 27456302.2901; val_kl_reg_loss: 115009.1297; val_edge_recon_loss: 2761074.4333; val_gene_expr_recon_loss: 20592598.9333; val_masked_gp_l1_reg_loss: 111887.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64969.1484; val_chrom_access_recon_loss: 3572840.2167; val_global_loss: 27218380.5333; val_optim_loss: 27218380.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9596; val_auprc_score: 0.9496; val_best_acc_score: 0.9031; val_best_f1_score: 0.9070; train_kl_reg_loss: 114465.7753; train_edge_recon_loss: 2752180.8263; train_gene_expr_recon_loss: 20784821.2977; train_masked_gp_l1_reg_loss: 112682.8302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63536.5016; train_chrom_access_recon_loss: 3634426.7863; train_global_loss: 27462113.9237; train_optim_loss: 27462113.9237; val_kl_reg_loss: 116026.9745; val_edge_recon_loss: 2761576.9667; val_gene_expr_recon_loss: 20519805.3333; val_masked_gp_l1_reg_loss: 113556.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62227.7812; val_chrom_access_recon_loss: 3580259.5833; val_global_loss: 27153452.9333; val_optim_loss: 27153452.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9677; val_auprc_score: 0.9619; val_best_acc_score: 0.9143; val_best_f1_score: 0.9175; train_kl_reg_loss: 113797.9511; train_edge_recon_loss: 2742088.5897; train_gene_expr_recon_loss: 20744552.7176; train_masked_gp_l1_reg_loss: 114331.9206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60879.8542; train_chrom_access_recon_loss: 3627633.7767; train_global_loss: 27403284.8092; train_optim_loss: 27403284.8092; val_kl_reg_loss: 115244.8229; val_edge_recon_loss: 2751915.6833; val_gene_expr_recon_loss: 20510770.2667; val_masked_gp_l1_reg_loss: 115083.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59522.8945; val_chrom_access_recon_loss: 3574146.8500; val_global_loss: 27126683.2000; val_optim_loss: 27126683.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9643; val_auprc_score: 0.9548; val_best_acc_score: 0.9105; val_best_f1_score: 0.9131; train_kl_reg_loss: 111229.8235; train_edge_recon_loss: 2741855.1202; train_gene_expr_recon_loss: 20722720.3511; train_masked_gp_l1_reg_loss: 115797.5268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58429.3657; train_chrom_access_recon_loss: 3630321.4523; train_global_loss: 27380353.6336; train_optim_loss: 27380353.6336; val_kl_reg_loss: 111251.7729; val_edge_recon_loss: 2754540.1667; val_gene_expr_recon_loss: 20554596.4000; val_masked_gp_l1_reg_loss: 116627.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57400.2422; val_chrom_access_recon_loss: 3565653.2167; val_global_loss: 27160069.4667; val_optim_loss: 27160069.4667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9702; val_auprc_score: 0.9612; val_best_acc_score: 0.9185; val_best_f1_score: 0.9217; train_kl_reg_loss: 111430.3724; train_edge_recon_loss: 2736369.8989; train_gene_expr_recon_loss: 20686742.4733; train_masked_gp_l1_reg_loss: 117311.8147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56213.5834; train_chrom_access_recon_loss: 3625009.7634; train_global_loss: 27333077.7405; train_optim_loss: 27333077.7405; val_kl_reg_loss: 110849.5818; val_edge_recon_loss: 2729494.6333; val_gene_expr_recon_loss: 20487658.1333; val_masked_gp_l1_reg_loss: 118150.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55222.8945; val_chrom_access_recon_loss: 3573981.5333; val_global_loss: 27075356.0000; val_optim_loss: 27075356.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9696; val_auprc_score: 0.9605; val_best_acc_score: 0.9179; val_best_f1_score: 0.9202; train_kl_reg_loss: 109308.1697; train_edge_recon_loss: 2733704.7595; train_gene_expr_recon_loss: 20641384.6565; train_masked_gp_l1_reg_loss: 118791.0144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54286.9042; train_chrom_access_recon_loss: 3615869.0458; train_global_loss: 27273344.5954; train_optim_loss: 27273344.5954; val_kl_reg_loss: 110056.1172; val_edge_recon_loss: 2742766.9500; val_gene_expr_recon_loss: 20419126.2667; val_masked_gp_l1_reg_loss: 119458.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53391.3984; val_chrom_access_recon_loss: 3574010.4333; val_global_loss: 27018809.8667; val_optim_loss: 27018809.8667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9689; val_auprc_score: 0.9587; val_best_acc_score: 0.9179; val_best_f1_score: 0.9211; train_kl_reg_loss: 107367.7544; train_edge_recon_loss: 2723982.3053; train_gene_expr_recon_loss: 20629568.1679; train_masked_gp_l1_reg_loss: 120234.7674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52583.4770; train_chrom_access_recon_loss: 3620497.5267; train_global_loss: 27254234.1527; train_optim_loss: 27254234.1527; val_kl_reg_loss: 110308.1406; val_edge_recon_loss: 2736114.9833; val_gene_expr_recon_loss: 20499867.3333; val_masked_gp_l1_reg_loss: 121070.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51811.1562; val_chrom_access_recon_loss: 3572066.9167; val_global_loss: 27091239.7333; val_optim_loss: 27091239.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9718; val_auprc_score: 0.9624; val_best_acc_score: 0.9241; val_best_f1_score: 0.9257; train_kl_reg_loss: 120157.1304; train_edge_recon_loss: 2788790.1279; train_gene_expr_recon_loss: 21485551.2672; train_masked_gp_l1_reg_loss: 121716.3787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52776.7637; train_chrom_access_recon_loss: 3683283.8645; train_global_loss: 28252275.5725; train_optim_loss: 28252275.5725; val_kl_reg_loss: 53564.1503; val_edge_recon_loss: 2741260.5667; val_gene_expr_recon_loss: 21297140.8000; val_masked_gp_l1_reg_loss: 122693.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52458.4336; val_chrom_access_recon_loss: 3612721.5167; val_global_loss: 27879839.3333; val_optim_loss: 27879839.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9704; val_auprc_score: 0.9631; val_best_acc_score: 0.9196; val_best_f1_score: 0.9217; train_kl_reg_loss: 114442.5859; train_edge_recon_loss: 2757239.0115; train_gene_expr_recon_loss: 21580996.4580; train_masked_gp_l1_reg_loss: 123989.2683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52541.7792; train_chrom_access_recon_loss: 3719504.7729; train_global_loss: 28348714.0000; train_optim_loss: 28348714.0000; val_kl_reg_loss: 43013.0828; val_edge_recon_loss: 2769015.1167; val_gene_expr_recon_loss: 21512404.2667; val_masked_gp_l1_reg_loss: 125195.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52473.3945; val_chrom_access_recon_loss: 3670413.2833; val_global_loss: 28172516.0000; val_optim_loss: 28172516.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9690; val_auprc_score: 0.9621; val_best_acc_score: 0.9163; val_best_f1_score: 0.9190; train_kl_reg_loss: 116811.4218; train_edge_recon_loss: 2793616.9676; train_gene_expr_recon_loss: 21894478.6107; train_masked_gp_l1_reg_loss: 126389.3301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52401.2211; train_chrom_access_recon_loss: 3712816.2328; train_global_loss: 28696513.6794; train_optim_loss: 28696513.6794; val_kl_reg_loss: 27499.5419; val_edge_recon_loss: 2835569.6000; val_gene_expr_recon_loss: 21985376.5333; val_masked_gp_l1_reg_loss: 127691.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52394.6055; val_chrom_access_recon_loss: 3672386.1000; val_global_loss: 28700918.1333; val_optim_loss: 28700918.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9680; val_auprc_score: 0.9600; val_best_acc_score: 0.9186; val_best_f1_score: 0.9212; train_kl_reg_loss: 121165.9565; train_edge_recon_loss: 2825009.3550; train_gene_expr_recon_loss: 22208843.2672; train_masked_gp_l1_reg_loss: 127489.2638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52151.6827; train_chrom_access_recon_loss: 3732003.4084; train_global_loss: 29066662.9466; train_optim_loss: 29066662.9466; val_kl_reg_loss: 27891.2195; val_edge_recon_loss: 2817382.1833; val_gene_expr_recon_loss: 22203227.0667; val_masked_gp_l1_reg_loss: 127554.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51949.1953; val_chrom_access_recon_loss: 3675529.2667; val_global_loss: 28903533.4667; val_optim_loss: 28903533.4667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9685; val_auprc_score: 0.9603; val_best_acc_score: 0.9165; val_best_f1_score: 0.9193; train_kl_reg_loss: 122392.6193; train_edge_recon_loss: 2814346.6088; train_gene_expr_recon_loss: 22318942.2901; train_masked_gp_l1_reg_loss: 127592.9173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51830.8228; train_chrom_access_recon_loss: 3732417.9561; train_global_loss: 29167523.2519; train_optim_loss: 29167523.2519; val_kl_reg_loss: 28100.2257; val_edge_recon_loss: 2819920.6167; val_gene_expr_recon_loss: 22146694.2667; val_masked_gp_l1_reg_loss: 127591.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51696.0195; val_chrom_access_recon_loss: 3676980.4333; val_global_loss: 28850983.8667; val_optim_loss: 28850983.8667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9647; val_auprc_score: 0.9534; val_best_acc_score: 0.9123; val_best_f1_score: 0.9150; train_kl_reg_loss: 120961.8138; train_edge_recon_loss: 2816393.7824; train_gene_expr_recon_loss: 22326564.6107; train_masked_gp_l1_reg_loss: 127581.4187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51567.0016; train_chrom_access_recon_loss: 3736602.2538; train_global_loss: 29179671.0382; train_optim_loss: 29179671.0382; val_kl_reg_loss: 27898.3560; val_edge_recon_loss: 2835653.4833; val_gene_expr_recon_loss: 22181117.0667; val_masked_gp_l1_reg_loss: 127552.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51439.2148; val_chrom_access_recon_loss: 3682500.8167; val_global_loss: 28906162.0000; val_optim_loss: 28906162.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9673; val_auprc_score: 0.9591; val_best_acc_score: 0.9153; val_best_f1_score: 0.9181; train_kl_reg_loss: 118949.1426; train_edge_recon_loss: 2813288.1966; train_gene_expr_recon_loss: 22396755.3435; train_masked_gp_l1_reg_loss: 127521.0375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51353.1606; train_chrom_access_recon_loss: 3739577.5802; train_global_loss: 29247444.5191; train_optim_loss: 29247444.5191; val_kl_reg_loss: 29403.3583; val_edge_recon_loss: 2793817.3833; val_gene_expr_recon_loss: 22223884.1333; val_masked_gp_l1_reg_loss: 127485.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51269.9219; val_chrom_access_recon_loss: 3688100.4833; val_global_loss: 28913961.3333; val_optim_loss: 28913961.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 27 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9740
val AUPRC score: 0.9671
val best accuracy score: 0.9256
val best F1 score: 0.9281
val target rna MSE score: 1.6752
val source rna MSE score: 385.8743
val target atac MSE score: 0.5539
val source atac MSE score: 4.7021
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
