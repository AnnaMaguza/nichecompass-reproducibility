[True]
Run timestamp: 07092023_001703_217.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_217']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19031 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 21756, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19031
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19031

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7717; val_auprc_score: 0.8012; val_best_acc_score: 0.5914; val_best_f1_score: 0.7004; train_kl_reg_loss: 91783.7735; train_edge_recon_loss: 3630641.0038; train_gene_expr_recon_loss: 12730169.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 669149.2705; train_chrom_access_recon_loss: 42883953.7405; train_global_loss: 60005697.7099; train_optim_loss: 60005697.7099; val_kl_reg_loss: 123509.2547; val_edge_recon_loss: 4059646.5333; val_gene_expr_recon_loss: 11879794.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 375106.4062; val_chrom_access_recon_loss: 41478092.5333; val_global_loss: 57916148.8000; val_optim_loss: 57916148.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8665; val_auprc_score: 0.8623; val_best_acc_score: 0.7705; val_best_f1_score: 0.7940; train_kl_reg_loss: 112881.2294; train_edge_recon_loss: 3515879.3454; train_gene_expr_recon_loss: 11746124.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 238482.8614; train_chrom_access_recon_loss: 41024210.0458; train_global_loss: 56637578.1374; train_optim_loss: 56637578.1374; val_kl_reg_loss: 82952.5604; val_edge_recon_loss: 3500622.7500; val_gene_expr_recon_loss: 11661553.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153573.6875; val_chrom_access_recon_loss: 40890296.5333; val_global_loss: 56289000.0000; val_optim_loss: 56289000.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8669; val_auprc_score: 0.8508; val_best_acc_score: 0.7807; val_best_f1_score: 0.8040; train_kl_reg_loss: 123726.7858; train_edge_recon_loss: 3044381.9198; train_gene_expr_recon_loss: 11556885.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119286.0070; train_chrom_access_recon_loss: 40496446.3817; train_global_loss: 55340726.4122; train_optim_loss: 55340726.4122; val_kl_reg_loss: 123664.3438; val_edge_recon_loss: 2972067.8833; val_gene_expr_recon_loss: 11539676.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94237.5703; val_chrom_access_recon_loss: 40740551.4667; val_global_loss: 55470197.8667; val_optim_loss: 55470197.8667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8827; val_auprc_score: 0.8675; val_best_acc_score: 0.7998; val_best_f1_score: 0.8186; train_kl_reg_loss: 124027.9355; train_edge_recon_loss: 2950812.0000; train_gene_expr_recon_loss: 11420007.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80233.1644; train_chrom_access_recon_loss: 40058986.7481; train_global_loss: 54634067.2366; train_optim_loss: 54634067.2366; val_kl_reg_loss: 120286.7156; val_edge_recon_loss: 2928935.6833; val_gene_expr_recon_loss: 11393932.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69374.0000; val_chrom_access_recon_loss: 40126529.6000; val_global_loss: 54639058.6667; val_optim_loss: 54639058.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9000; val_auprc_score: 0.8845; val_best_acc_score: 0.8215; val_best_f1_score: 0.8390; train_kl_reg_loss: 112705.2309; train_edge_recon_loss: 2894003.1489; train_gene_expr_recon_loss: 11301305.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62340.6119; train_chrom_access_recon_loss: 39724982.0458; train_global_loss: 54095336.8244; train_optim_loss: 54095336.8244; val_kl_reg_loss: 112089.3339; val_edge_recon_loss: 2870895.7667; val_gene_expr_recon_loss: 11289233.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57053.8164; val_chrom_access_recon_loss: 39839848.5333; val_global_loss: 54169120.8000; val_optim_loss: 54169120.8000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9233; val_auprc_score: 0.9101; val_best_acc_score: 0.8479; val_best_f1_score: 0.8592; train_kl_reg_loss: 112231.0384; train_edge_recon_loss: 2835032.0859; train_gene_expr_recon_loss: 11204414.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53051.0031; train_chrom_access_recon_loss: 39391276.5496; train_global_loss: 53596004.5496; train_optim_loss: 53596004.5496; val_kl_reg_loss: 110769.0057; val_edge_recon_loss: 2816122.6000; val_gene_expr_recon_loss: 11177656.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49540.5781; val_chrom_access_recon_loss: 39549518.4000; val_global_loss: 53703606.6667; val_optim_loss: 53703606.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9305; val_auprc_score: 0.9174; val_best_acc_score: 0.8635; val_best_f1_score: 0.8737; train_kl_reg_loss: 108723.4609; train_edge_recon_loss: 2803949.3989; train_gene_expr_recon_loss: 11109756.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47277.7585; train_chrom_access_recon_loss: 39094157.3740; train_global_loss: 53163864.1832; train_optim_loss: 53163864.1832; val_kl_reg_loss: 106383.5490; val_edge_recon_loss: 2806890.3167; val_gene_expr_recon_loss: 11103568.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45075.1758; val_chrom_access_recon_loss: 39161210.1333; val_global_loss: 53223128.0000; val_optim_loss: 53223128.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9346; val_auprc_score: 0.9179; val_best_acc_score: 0.8690; val_best_f1_score: 0.8773; train_kl_reg_loss: 105590.0234; train_edge_recon_loss: 2788785.3569; train_gene_expr_recon_loss: 11038457.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43819.3796; train_chrom_access_recon_loss: 38856384.1832; train_global_loss: 52833036.8244; train_optim_loss: 52833036.8244; val_kl_reg_loss: 100470.6281; val_edge_recon_loss: 2788585.2000; val_gene_expr_recon_loss: 11012531.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42368.3164; val_chrom_access_recon_loss: 38978947.4667; val_global_loss: 52922902.9333; val_optim_loss: 52922902.9333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9396; val_auprc_score: 0.9245; val_best_acc_score: 0.8773; val_best_f1_score: 0.8862; train_kl_reg_loss: 101288.5530; train_edge_recon_loss: 2768136.6374; train_gene_expr_recon_loss: 10969255.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41499.0432; train_chrom_access_recon_loss: 38592665.3130; train_global_loss: 52472845.1603; train_optim_loss: 52472845.1603; val_kl_reg_loss: 100262.6849; val_edge_recon_loss: 2776342.4167; val_gene_expr_recon_loss: 10980519.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40533.6484; val_chrom_access_recon_loss: 38828021.6000; val_global_loss: 52725680.2667; val_optim_loss: 52725680.2667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9478; val_auprc_score: 0.9324; val_best_acc_score: 0.8822; val_best_f1_score: 0.8891; train_kl_reg_loss: 99292.4590; train_edge_recon_loss: 2750048.5210; train_gene_expr_recon_loss: 10904386.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39932.7443; train_chrom_access_recon_loss: 38347620.7939; train_global_loss: 52141281.0076; train_optim_loss: 52141281.0076; val_kl_reg_loss: 96937.1615; val_edge_recon_loss: 2757106.3667; val_gene_expr_recon_loss: 10915917.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39135.1094; val_chrom_access_recon_loss: 38521231.2000; val_global_loss: 52330327.4667; val_optim_loss: 52330327.4667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9543; val_auprc_score: 0.9443; val_best_acc_score: 0.8948; val_best_f1_score: 0.9005; train_kl_reg_loss: 95977.0831; train_edge_recon_loss: 2739586.1489; train_gene_expr_recon_loss: 10851412.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38795.7792; train_chrom_access_recon_loss: 38132921.2519; train_global_loss: 51858692.4275; train_optim_loss: 51858692.4275; val_kl_reg_loss: 93496.5031; val_edge_recon_loss: 2739830.0667; val_gene_expr_recon_loss: 10871431.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38295.9336; val_chrom_access_recon_loss: 38464569.3333; val_global_loss: 52207623.2000; val_optim_loss: 52207623.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9505; val_auprc_score: 0.9342; val_best_acc_score: 0.8914; val_best_f1_score: 0.8976; train_kl_reg_loss: 93263.8582; train_edge_recon_loss: 2732760.6870; train_gene_expr_recon_loss: 10791165.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37933.0574; train_chrom_access_recon_loss: 37866813.8321; train_global_loss: 51521936.9771; train_optim_loss: 51521936.9771; val_kl_reg_loss: 91118.1057; val_edge_recon_loss: 2751122.9500; val_gene_expr_recon_loss: 10824021.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37829.4727; val_chrom_access_recon_loss: 38194589.8667; val_global_loss: 51898681.0667; val_optim_loss: 51898681.0667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9545; val_auprc_score: 0.9401; val_best_acc_score: 0.8975; val_best_f1_score: 0.9035; train_kl_reg_loss: 90154.1781; train_edge_recon_loss: 2730639.5229; train_gene_expr_recon_loss: 10743408.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37411.9463; train_chrom_access_recon_loss: 37644590.3206; train_global_loss: 51246204.0000; train_optim_loss: 51246204.0000; val_kl_reg_loss: 88617.5135; val_edge_recon_loss: 2745876.8167; val_gene_expr_recon_loss: 10752030.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37208.8203; val_chrom_access_recon_loss: 37899540.8000; val_global_loss: 51523273.8667; val_optim_loss: 51523273.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9625; val_auprc_score: 0.9539; val_best_acc_score: 0.9064; val_best_f1_score: 0.9106; train_kl_reg_loss: 88629.1928; train_edge_recon_loss: 2715488.1374; train_gene_expr_recon_loss: 10708765.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37052.7923; train_chrom_access_recon_loss: 37477667.1756; train_global_loss: 51027602.7786; train_optim_loss: 51027602.7786; val_kl_reg_loss: 85251.5542; val_edge_recon_loss: 2718590.4333; val_gene_expr_recon_loss: 10710671.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37030.8516; val_chrom_access_recon_loss: 37715531.7333; val_global_loss: 51267076.5333; val_optim_loss: 51267076.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9646; val_auprc_score: 0.9548; val_best_acc_score: 0.9092; val_best_f1_score: 0.9136; train_kl_reg_loss: 87037.6886; train_edge_recon_loss: 2710497.8855; train_gene_expr_recon_loss: 10667019.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36953.8159; train_chrom_access_recon_loss: 37260404.6718; train_global_loss: 50761912.8855; train_optim_loss: 50761912.8855; val_kl_reg_loss: 85051.3229; val_edge_recon_loss: 2720056.5500; val_gene_expr_recon_loss: 10681533.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36793.0742; val_chrom_access_recon_loss: 37589584.2667; val_global_loss: 51113018.9333; val_optim_loss: 51113018.9333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9672; val_auprc_score: 0.9605; val_best_acc_score: 0.9128; val_best_f1_score: 0.9160; train_kl_reg_loss: 84673.8003; train_edge_recon_loss: 2706704.2405; train_gene_expr_recon_loss: 10629259.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36887.3452; train_chrom_access_recon_loss: 37082904.1832; train_global_loss: 50540428.7634; train_optim_loss: 50540428.7634; val_kl_reg_loss: 83659.0807; val_edge_recon_loss: 2710578.3500; val_gene_expr_recon_loss: 10653597.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36919.1094; val_chrom_access_recon_loss: 37508988.8000; val_global_loss: 50993743.4667; val_optim_loss: 50993743.4667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9690; val_auprc_score: 0.9595; val_best_acc_score: 0.9173; val_best_f1_score: 0.9207; train_kl_reg_loss: 83272.8423; train_edge_recon_loss: 2705896.2462; train_gene_expr_recon_loss: 10599269.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36905.9968; train_chrom_access_recon_loss: 36893465.2824; train_global_loss: 50318810.0458; train_optim_loss: 50318810.0458; val_kl_reg_loss: 80535.0724; val_edge_recon_loss: 2708438.9500; val_gene_expr_recon_loss: 10641665.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37092.3945; val_chrom_access_recon_loss: 37383529.3333; val_global_loss: 50851261.3333; val_optim_loss: 50851261.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9681; val_auprc_score: 0.9603; val_best_acc_score: 0.9169; val_best_f1_score: 0.9210; train_kl_reg_loss: 80690.9541; train_edge_recon_loss: 2706689.9809; train_gene_expr_recon_loss: 10565975.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37162.5759; train_chrom_access_recon_loss: 36694834.8550; train_global_loss: 50085353.4656; train_optim_loss: 50085353.4656; val_kl_reg_loss: 79502.1255; val_edge_recon_loss: 2713302.1500; val_gene_expr_recon_loss: 10641982.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37038.4844; val_chrom_access_recon_loss: 37403581.0667; val_global_loss: 50875406.6667; val_optim_loss: 50875406.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9696; val_auprc_score: 0.9623; val_best_acc_score: 0.9178; val_best_f1_score: 0.9214; train_kl_reg_loss: 78203.9914; train_edge_recon_loss: 2701122.2615; train_gene_expr_recon_loss: 10553560.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37161.4441; train_chrom_access_recon_loss: 36604219.4504; train_global_loss: 49974267.8473; train_optim_loss: 49974267.8473; val_kl_reg_loss: 75876.7786; val_edge_recon_loss: 2724128.4667; val_gene_expr_recon_loss: 10607490.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36957.5977; val_chrom_access_recon_loss: 37088636.8000; val_global_loss: 50533090.9333; val_optim_loss: 50533090.9333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9689; val_auprc_score: 0.9614; val_best_acc_score: 0.9147; val_best_f1_score: 0.9189; train_kl_reg_loss: 76537.2097; train_edge_recon_loss: 2712764.2252; train_gene_expr_recon_loss: 10576094.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37931.9388; train_chrom_access_recon_loss: 36625443.0229; train_global_loss: 50028770.8397; train_optim_loss: 50028770.8397; val_kl_reg_loss: 73874.9323; val_edge_recon_loss: 2734439.6667; val_gene_expr_recon_loss: 10626913.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37320.5586; val_chrom_access_recon_loss: 37077017.0667; val_global_loss: 50549565.8667; val_optim_loss: 50549565.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9607; val_auprc_score: 0.9511; val_best_acc_score: 0.9086; val_best_f1_score: 0.9127; train_kl_reg_loss: 86732.0674; train_edge_recon_loss: 2737219.9466; train_gene_expr_recon_loss: 10686693.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38386.7935; train_chrom_access_recon_loss: 36765601.8779; train_global_loss: 50314633.7099; train_optim_loss: 50314633.7099; val_kl_reg_loss: 57698.8010; val_edge_recon_loss: 2773915.9667; val_gene_expr_recon_loss: 10589264.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38209.6211; val_chrom_access_recon_loss: 37069882.9333; val_global_loss: 50528972.0000; val_optim_loss: 50528972.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9629; val_auprc_score: 0.9526; val_best_acc_score: 0.9041; val_best_f1_score: 0.9080; train_kl_reg_loss: 71412.8145; train_edge_recon_loss: 2725993.9676; train_gene_expr_recon_loss: 10594558.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37923.8719; train_chrom_access_recon_loss: 36569566.0305; train_global_loss: 49999454.7176; train_optim_loss: 49999454.7176; val_kl_reg_loss: 75544.2089; val_edge_recon_loss: 2731130.8667; val_gene_expr_recon_loss: 10614353.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36440.6992; val_chrom_access_recon_loss: 36963378.6667; val_global_loss: 50420847.4667; val_optim_loss: 50420847.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9713; val_auprc_score: 0.9644; val_best_acc_score: 0.9192; val_best_f1_score: 0.9213; train_kl_reg_loss: 77525.0010; train_edge_recon_loss: 2696433.2634; train_gene_expr_recon_loss: 10521384.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35999.9696; train_chrom_access_recon_loss: 36259637.4656; train_global_loss: 49590979.9389; train_optim_loss: 49590979.9389; val_kl_reg_loss: 77244.9073; val_edge_recon_loss: 2713987.8833; val_gene_expr_recon_loss: 10562700.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35580.7812; val_chrom_access_recon_loss: 36796063.7333; val_global_loss: 50185578.4000; val_optim_loss: 50185578.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9710; val_auprc_score: 0.9643; val_best_acc_score: 0.9200; val_best_f1_score: 0.9226; train_kl_reg_loss: 75797.6121; train_edge_recon_loss: 2697503.4198; train_gene_expr_recon_loss: 10523915.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35937.0794; train_chrom_access_recon_loss: 36171718.8855; train_global_loss: 49504872.3969; train_optim_loss: 49504872.3969; val_kl_reg_loss: 75784.4859; val_edge_recon_loss: 2708298.9000; val_gene_expr_recon_loss: 10525169.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36129.2188; val_chrom_access_recon_loss: 36596481.3333; val_global_loss: 49941863.2000; val_optim_loss: 49941863.2000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9708; val_auprc_score: 0.9644; val_best_acc_score: 0.9162; val_best_f1_score: 0.9190; train_kl_reg_loss: 75874.8892; train_edge_recon_loss: 2702400.4237; train_gene_expr_recon_loss: 10485458.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36619.5049; train_chrom_access_recon_loss: 35992490.1374; train_global_loss: 49292843.1145; train_optim_loss: 49292843.1145; val_kl_reg_loss: 74130.6818; val_edge_recon_loss: 2714470.1667; val_gene_expr_recon_loss: 10498557.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36425.5391; val_chrom_access_recon_loss: 36361769.8667; val_global_loss: 49685354.1333; val_optim_loss: 49685354.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9690; val_auprc_score: 0.9575; val_best_acc_score: 0.9165; val_best_f1_score: 0.9193; train_kl_reg_loss: 76200.9015; train_edge_recon_loss: 2695793.5076; train_gene_expr_recon_loss: 10447980.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36516.9744; train_chrom_access_recon_loss: 35905817.0076; train_global_loss: 49162309.1298; train_optim_loss: 49162309.1298; val_kl_reg_loss: 74263.2401; val_edge_recon_loss: 2709175.0167; val_gene_expr_recon_loss: 10456746.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36916.5156; val_chrom_access_recon_loss: 36334123.4667; val_global_loss: 49611225.6000; val_optim_loss: 49611225.6000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9737; val_auprc_score: 0.9678; val_best_acc_score: 0.9235; val_best_f1_score: 0.9264; train_kl_reg_loss: 75276.0296; train_edge_recon_loss: 2688762.0496; train_gene_expr_recon_loss: 10430327.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36872.9342; train_chrom_access_recon_loss: 35783639.1603; train_global_loss: 49014878.2290; train_optim_loss: 49014878.2290; val_kl_reg_loss: 74861.9557; val_edge_recon_loss: 2696620.0833; val_gene_expr_recon_loss: 10488191.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36894.8672; val_chrom_access_recon_loss: 36377336.2667; val_global_loss: 49673905.0667; val_optim_loss: 49673905.0667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9756; val_auprc_score: 0.9699; val_best_acc_score: 0.9256; val_best_f1_score: 0.9273; train_kl_reg_loss: 72539.2443; train_edge_recon_loss: 2688864.3740; train_gene_expr_recon_loss: 10416220.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37005.1534; train_chrom_access_recon_loss: 35715582.0305; train_global_loss: 48930210.8397; train_optim_loss: 48930210.8397; val_kl_reg_loss: 71900.9875; val_edge_recon_loss: 2710142.7167; val_gene_expr_recon_loss: 10430480.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37084.6406; val_chrom_access_recon_loss: 36255789.6000; val_global_loss: 49505398.9333; val_optim_loss: 49505398.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9745; val_auprc_score: 0.9672; val_best_acc_score: 0.9241; val_best_f1_score: 0.9273; train_kl_reg_loss: 75510.5436; train_edge_recon_loss: 2679210.7653; train_gene_expr_recon_loss: 10395428.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37042.7221; train_chrom_access_recon_loss: 35630926.9160; train_global_loss: 48818119.4504; train_optim_loss: 48818119.4504; val_kl_reg_loss: 74719.2130; val_edge_recon_loss: 2676967.6333; val_gene_expr_recon_loss: 10398298.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36635.2109; val_chrom_access_recon_loss: 36260797.6000; val_global_loss: 49447418.4000; val_optim_loss: 49447418.4000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9763; val_auprc_score: 0.9714; val_best_acc_score: 0.9276; val_best_f1_score: 0.9294; train_kl_reg_loss: 75517.3956; train_edge_recon_loss: 2682057.3492; train_gene_expr_recon_loss: 10386581.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36866.2470; train_chrom_access_recon_loss: 35560813.0382; train_global_loss: 48741835.1145; train_optim_loss: 48741835.1145; val_kl_reg_loss: 72636.1615; val_edge_recon_loss: 2684433.5167; val_gene_expr_recon_loss: 10388766.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36846.4609; val_chrom_access_recon_loss: 35987772.2667; val_global_loss: 49170453.8667; val_optim_loss: 49170453.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9747; val_auprc_score: 0.9676; val_best_acc_score: 0.9275; val_best_f1_score: 0.9293; train_kl_reg_loss: 71753.2063; train_edge_recon_loss: 2687735.9962; train_gene_expr_recon_loss: 10366185.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37019.4993; train_chrom_access_recon_loss: 35482772.7634; train_global_loss: 48645466.6870; train_optim_loss: 48645466.6870; val_kl_reg_loss: 71452.8182; val_edge_recon_loss: 2696133.6333; val_gene_expr_recon_loss: 10358711.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36937.5898; val_chrom_access_recon_loss: 35896876.4000; val_global_loss: 49060112.0000; val_optim_loss: 49060112.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9748; val_auprc_score: 0.9666; val_best_acc_score: 0.9248; val_best_f1_score: 0.9268; train_kl_reg_loss: 73362.4884; train_edge_recon_loss: 2675184.5992; train_gene_expr_recon_loss: 10349525.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36969.3798; train_chrom_access_recon_loss: 35385153.6183; train_global_loss: 48520195.5725; train_optim_loss: 48520195.5725; val_kl_reg_loss: 72470.2411; val_edge_recon_loss: 2691826.1833; val_gene_expr_recon_loss: 10340098.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37242.4961; val_chrom_access_recon_loss: 35913829.8667; val_global_loss: 49055466.6667; val_optim_loss: 49055466.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9773; val_auprc_score: 0.9711; val_best_acc_score: 0.9324; val_best_f1_score: 0.9339; train_kl_reg_loss: 71095.0364; train_edge_recon_loss: 2675744.6546; train_gene_expr_recon_loss: 10345072.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37215.7958; train_chrom_access_recon_loss: 35379848.2443; train_global_loss: 48508976.1832; train_optim_loss: 48508976.1832; val_kl_reg_loss: 69524.2839; val_edge_recon_loss: 2689747.4667; val_gene_expr_recon_loss: 10379498.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37183.4766; val_chrom_access_recon_loss: 35910717.6000; val_global_loss: 49086670.6667; val_optim_loss: 49086670.6667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9786; val_auprc_score: 0.9724; val_best_acc_score: 0.9347; val_best_f1_score: 0.9371; train_kl_reg_loss: 71215.9850; train_edge_recon_loss: 2674582.2252; train_gene_expr_recon_loss: 10332749.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37217.4917; train_chrom_access_recon_loss: 35312774.0305; train_global_loss: 48428539.8168; train_optim_loss: 48428539.8168; val_kl_reg_loss: 70003.6964; val_edge_recon_loss: 2683771.7000; val_gene_expr_recon_loss: 10400332.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36633.5586; val_chrom_access_recon_loss: 36059741.3333; val_global_loss: 49250483.2000; val_optim_loss: 49250483.2000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9789; val_auprc_score: 0.9733; val_best_acc_score: 0.9351; val_best_f1_score: 0.9370; train_kl_reg_loss: 71170.8491; train_edge_recon_loss: 2672785.5057; train_gene_expr_recon_loss: 10328643.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36959.8462; train_chrom_access_recon_loss: 35263748.1832; train_global_loss: 48373308.4275; train_optim_loss: 48373308.4275; val_kl_reg_loss: 70478.2208; val_edge_recon_loss: 2675845.6000; val_gene_expr_recon_loss: 10362144.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37045.1484; val_chrom_access_recon_loss: 35841597.8667; val_global_loss: 48987111.2000; val_optim_loss: 48987111.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9780; val_auprc_score: 0.9731; val_best_acc_score: 0.9318; val_best_f1_score: 0.9331; train_kl_reg_loss: 69477.5662; train_edge_recon_loss: 2677343.5324; train_gene_expr_recon_loss: 10318865.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36990.0567; train_chrom_access_recon_loss: 35236710.9466; train_global_loss: 48339387.8779; train_optim_loss: 48339387.8779; val_kl_reg_loss: 67455.1174; val_edge_recon_loss: 2690328.7500; val_gene_expr_recon_loss: 10384807.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36949.4258; val_chrom_access_recon_loss: 35926924.0000; val_global_loss: 49106464.8000; val_optim_loss: 49106464.8000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9795; val_auprc_score: 0.9729; val_best_acc_score: 0.9347; val_best_f1_score: 0.9362; train_kl_reg_loss: 69365.3905; train_edge_recon_loss: 2670518.7901; train_gene_expr_recon_loss: 10315544.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37036.3349; train_chrom_access_recon_loss: 35208164.8244; train_global_loss: 48300629.6489; train_optim_loss: 48300629.6489; val_kl_reg_loss: 69736.9620; val_edge_recon_loss: 2687560.7333; val_gene_expr_recon_loss: 10373042.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37252.5039; val_chrom_access_recon_loss: 35818509.0667; val_global_loss: 48986102.1333; val_optim_loss: 48986102.1333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9822; val_auprc_score: 0.9786; val_best_acc_score: 0.9382; val_best_f1_score: 0.9403; train_kl_reg_loss: 70768.8152; train_edge_recon_loss: 2667407.8092; train_gene_expr_recon_loss: 10301313.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37048.4463; train_chrom_access_recon_loss: 35108698.8244; train_global_loss: 48185236.7023; train_optim_loss: 48185236.7023; val_kl_reg_loss: 69306.8250; val_edge_recon_loss: 2665150.4667; val_gene_expr_recon_loss: 10385825.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37031.3398; val_chrom_access_recon_loss: 35870530.2667; val_global_loss: 49027843.7333; val_optim_loss: 49027843.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9803; val_auprc_score: 0.9759; val_best_acc_score: 0.9361; val_best_f1_score: 0.9385; train_kl_reg_loss: 69801.2069; train_edge_recon_loss: 2666826.9485; train_gene_expr_recon_loss: 10294740.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36960.0452; train_chrom_access_recon_loss: 35100428.6718; train_global_loss: 48168757.9542; train_optim_loss: 48168757.9542; val_kl_reg_loss: 68954.9776; val_edge_recon_loss: 2676976.6167; val_gene_expr_recon_loss: 10361060.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36894.9453; val_chrom_access_recon_loss: 35790507.2000; val_global_loss: 48934394.4000; val_optim_loss: 48934394.4000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9798; val_auprc_score: 0.9746; val_best_acc_score: 0.9365; val_best_f1_score: 0.9385; train_kl_reg_loss: 69421.3289; train_edge_recon_loss: 2667573.9924; train_gene_expr_recon_loss: 10290996.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37030.9215; train_chrom_access_recon_loss: 35052414.8244; train_global_loss: 48117437.2214; train_optim_loss: 48117437.2214; val_kl_reg_loss: 67777.0576; val_edge_recon_loss: 2700132.1833; val_gene_expr_recon_loss: 10344302.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36650.4883; val_chrom_access_recon_loss: 35738277.0667; val_global_loss: 48887138.6667; val_optim_loss: 48887138.6667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9823; val_auprc_score: 0.9760; val_best_acc_score: 0.9406; val_best_f1_score: 0.9415; train_kl_reg_loss: 68637.8866; train_edge_recon_loss: 2664279.7691; train_gene_expr_recon_loss: 10280157.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36909.9204; train_chrom_access_recon_loss: 35014276.0305; train_global_loss: 48064261.5573; train_optim_loss: 48064261.5573; val_kl_reg_loss: 66569.7792; val_edge_recon_loss: 2690201.3333; val_gene_expr_recon_loss: 10338516.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37319.7891; val_chrom_access_recon_loss: 35702741.0667; val_global_loss: 48835348.5333; val_optim_loss: 48835348.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9826; val_auprc_score: 0.9789; val_best_acc_score: 0.9445; val_best_f1_score: 0.9458; train_kl_reg_loss: 67684.9776; train_edge_recon_loss: 2668003.2233; train_gene_expr_recon_loss: 10274151.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37073.3523; train_chrom_access_recon_loss: 34976290.6412; train_global_loss: 48023203.5115; train_optim_loss: 48023203.5115; val_kl_reg_loss: 66209.7000; val_edge_recon_loss: 2682235.9167; val_gene_expr_recon_loss: 10300973.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37090.0742; val_chrom_access_recon_loss: 35585447.2000; val_global_loss: 48671957.0667; val_optim_loss: 48671957.0667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9828; val_auprc_score: 0.9770; val_best_acc_score: 0.9446; val_best_f1_score: 0.9459; train_kl_reg_loss: 67895.7701; train_edge_recon_loss: 2661373.7710; train_gene_expr_recon_loss: 10268965.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36967.2658; train_chrom_access_recon_loss: 34955940.5649; train_global_loss: 47991142.4427; train_optim_loss: 47991142.4427; val_kl_reg_loss: 66352.9271; val_edge_recon_loss: 2678779.5333; val_gene_expr_recon_loss: 10307268.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36775.8398; val_chrom_access_recon_loss: 35532842.1333; val_global_loss: 48622018.9333; val_optim_loss: 48622018.9333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9815; val_auprc_score: 0.9730; val_best_acc_score: 0.9440; val_best_f1_score: 0.9454; train_kl_reg_loss: 67337.4901; train_edge_recon_loss: 2657069.9427; train_gene_expr_recon_loss: 10253414.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36903.3746; train_chrom_access_recon_loss: 34871727.1756; train_global_loss: 47886452.2748; train_optim_loss: 47886452.2748; val_kl_reg_loss: 66361.1971; val_edge_recon_loss: 2673007.4333; val_gene_expr_recon_loss: 10313323.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37049.1602; val_chrom_access_recon_loss: 35483201.6000; val_global_loss: 48572942.6667; val_optim_loss: 48572942.6667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9846; val_auprc_score: 0.9816; val_best_acc_score: 0.9453; val_best_f1_score: 0.9467; train_kl_reg_loss: 66874.9779; train_edge_recon_loss: 2658303.6565; train_gene_expr_recon_loss: 10259921.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36970.7199; train_chrom_access_recon_loss: 34907885.3282; train_global_loss: 47929956.3359; train_optim_loss: 47929956.3359; val_kl_reg_loss: 65494.5862; val_edge_recon_loss: 2670349.7667; val_gene_expr_recon_loss: 10300926.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36814.4727; val_chrom_access_recon_loss: 35620175.4667; val_global_loss: 48693760.2667; val_optim_loss: 48693760.2667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9811; val_auprc_score: 0.9739; val_best_acc_score: 0.9398; val_best_f1_score: 0.9413; train_kl_reg_loss: 65878.0552; train_edge_recon_loss: 2665279.1279; train_gene_expr_recon_loss: 10253921.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36997.9756; train_chrom_access_recon_loss: 34885643.3893; train_global_loss: 47907719.5725; train_optim_loss: 47907719.5725; val_kl_reg_loss: 63664.4818; val_edge_recon_loss: 2695136.2167; val_gene_expr_recon_loss: 10294420.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36724.5234; val_chrom_access_recon_loss: 35552092.0000; val_global_loss: 48642038.4000; val_optim_loss: 48642038.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9838; val_auprc_score: 0.9780; val_best_acc_score: 0.9472; val_best_f1_score: 0.9485; train_kl_reg_loss: 65318.1988; train_edge_recon_loss: 2660170.2958; train_gene_expr_recon_loss: 10244941.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36869.3901; train_chrom_access_recon_loss: 34849858.6565; train_global_loss: 47857158.4733; train_optim_loss: 47857158.4733; val_kl_reg_loss: 64989.3958; val_edge_recon_loss: 2667256.9667; val_gene_expr_recon_loss: 10330529.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37474.3594; val_chrom_access_recon_loss: 35656363.7333; val_global_loss: 48756613.0667; val_optim_loss: 48756613.0667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9845; val_auprc_score: 0.9803; val_best_acc_score: 0.9483; val_best_f1_score: 0.9492; train_kl_reg_loss: 65984.6952; train_edge_recon_loss: 2662292.8683; train_gene_expr_recon_loss: 10249757.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37131.5646; train_chrom_access_recon_loss: 34845882.6260; train_global_loss: 47861049.1908; train_optim_loss: 47861049.1908; val_kl_reg_loss: 64774.0940; val_edge_recon_loss: 2667320.9667; val_gene_expr_recon_loss: 10300276.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37068.9453; val_chrom_access_recon_loss: 35609737.0667; val_global_loss: 48679177.0667; val_optim_loss: 48679177.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9832; val_auprc_score: 0.9782; val_best_acc_score: 0.9442; val_best_f1_score: 0.9459; train_kl_reg_loss: 66212.4346; train_edge_recon_loss: 2656737.7729; train_gene_expr_recon_loss: 10235568.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30169.3674; train_chrom_access_recon_loss: 34784589.9389; train_global_loss: 47773277.8626; train_optim_loss: 47773277.8626; val_kl_reg_loss: 65638.5883; val_edge_recon_loss: 2669232.6333; val_gene_expr_recon_loss: 10277796.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28190.2285; val_chrom_access_recon_loss: 35503176.5333; val_global_loss: 48544033.8667; val_optim_loss: 48544033.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9812; val_auprc_score: 0.9737; val_best_acc_score: 0.9423; val_best_f1_score: 0.9434; train_kl_reg_loss: 66499.3164; train_edge_recon_loss: 2656932.7462; train_gene_expr_recon_loss: 10226812.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27920.3590; train_chrom_access_recon_loss: 34739916.5954; train_global_loss: 47718081.3740; train_optim_loss: 47718081.3740; val_kl_reg_loss: 66003.9776; val_edge_recon_loss: 2673599.5333; val_gene_expr_recon_loss: 10319296.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27757.9922; val_chrom_access_recon_loss: 35591458.2667; val_global_loss: 48678116.2667; val_optim_loss: 48678116.2667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9839; val_auprc_score: 0.9805; val_best_acc_score: 0.9442; val_best_f1_score: 0.9455; train_kl_reg_loss: 66973.3601; train_edge_recon_loss: 2658305.6775; train_gene_expr_recon_loss: 10221097.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27632.8930; train_chrom_access_recon_loss: 34692476.1221; train_global_loss: 47666485.7099; train_optim_loss: 47666485.7099; val_kl_reg_loss: 66282.3424; val_edge_recon_loss: 2679345.9667; val_gene_expr_recon_loss: 10295619.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27535.2656; val_chrom_access_recon_loss: 35676587.2000; val_global_loss: 48745370.4000; val_optim_loss: 48745370.4000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9845; val_auprc_score: 0.9781; val_best_acc_score: 0.9452; val_best_f1_score: 0.9469; train_kl_reg_loss: 66925.2703; train_edge_recon_loss: 2654745.1202; train_gene_expr_recon_loss: 10219949.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27461.9490; train_chrom_access_recon_loss: 34736346.5496; train_global_loss: 47705428.6718; train_optim_loss: 47705428.6718; val_kl_reg_loss: 66367.5898; val_edge_recon_loss: 2659385.4500; val_gene_expr_recon_loss: 10309183.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27451.3711; val_chrom_access_recon_loss: 35549389.8667; val_global_loss: 48611777.3333; val_optim_loss: 48611777.3333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9828; val_auprc_score: 0.9788; val_best_acc_score: 0.9395; val_best_f1_score: 0.9416; train_kl_reg_loss: 67214.1723; train_edge_recon_loss: 2656316.8569; train_gene_expr_recon_loss: 10224344.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27387.2728; train_chrom_access_recon_loss: 34725683.6031; train_global_loss: 47700945.7710; train_optim_loss: 47700945.7710; val_kl_reg_loss: 66640.6263; val_edge_recon_loss: 2692844.2500; val_gene_expr_recon_loss: 10276331.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27353.9102; val_chrom_access_recon_loss: 35614565.6000; val_global_loss: 48677736.8000; val_optim_loss: 48677736.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9833; val_auprc_score: 0.9776; val_best_acc_score: 0.9454; val_best_f1_score: 0.9468; train_kl_reg_loss: 67363.9409; train_edge_recon_loss: 2658861.9122; train_gene_expr_recon_loss: 10224996.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26635.3931; train_chrom_access_recon_loss: 34719349.6031; train_global_loss: 47697207.1756; train_optim_loss: 47697207.1756; val_kl_reg_loss: 66483.7674; val_edge_recon_loss: 2663787.8000; val_gene_expr_recon_loss: 10308949.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26419.0957; val_chrom_access_recon_loss: 35677314.8000; val_global_loss: 48742954.6667; val_optim_loss: 48742954.6667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9836; val_auprc_score: 0.9808; val_best_acc_score: 0.9430; val_best_f1_score: 0.9445; train_kl_reg_loss: 67318.2454; train_edge_recon_loss: 2664088.6679; train_gene_expr_recon_loss: 10222576.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26380.2781; train_chrom_access_recon_loss: 34721885.2214; train_global_loss: 47702248.8550; train_optim_loss: 47702248.8550; val_kl_reg_loss: 66430.0219; val_edge_recon_loss: 2684771.9667; val_gene_expr_recon_loss: 10310511.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26355.1328; val_chrom_access_recon_loss: 35575456.0000; val_global_loss: 48663524.0000; val_optim_loss: 48663524.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9854; val_auprc_score: 0.9827; val_best_acc_score: 0.9464; val_best_f1_score: 0.9476; train_kl_reg_loss: 67298.2930; train_edge_recon_loss: 2655331.2863; train_gene_expr_recon_loss: 10216701.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26336.9321; train_chrom_access_recon_loss: 34682395.5115; train_global_loss: 47648063.3588; train_optim_loss: 47648063.3588; val_kl_reg_loss: 66384.6435; val_edge_recon_loss: 2671183.9667; val_gene_expr_recon_loss: 10291240.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26320.8164; val_chrom_access_recon_loss: 35511174.2667; val_global_loss: 48566305.0667; val_optim_loss: 48566305.0667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9842; val_auprc_score: 0.9803; val_best_acc_score: 0.9444; val_best_f1_score: 0.9457; train_kl_reg_loss: 67372.5305; train_edge_recon_loss: 2655811.8550; train_gene_expr_recon_loss: 10219295.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26310.4324; train_chrom_access_recon_loss: 34681634.3969; train_global_loss: 47650424.4275; train_optim_loss: 47650424.4275; val_kl_reg_loss: 66284.2339; val_edge_recon_loss: 2663136.6333; val_gene_expr_recon_loss: 10315469.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26300.9160; val_chrom_access_recon_loss: 35795084.5333; val_global_loss: 48866276.5333; val_optim_loss: 48866276.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 132 min 8 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9844
val AUPRC score: 0.9791
val best accuracy score: 0.9462
val best F1 score: 0.9468
val target rna MSE score: 1.1853
val source rna MSE score: 0.2508
val target atac MSE score: 0.1263
val source atac MSE score: 0.0193
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
