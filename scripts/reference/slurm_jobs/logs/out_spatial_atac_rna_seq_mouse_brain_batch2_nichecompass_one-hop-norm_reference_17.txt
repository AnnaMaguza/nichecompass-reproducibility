[True]
Run timestamp: 07092023_135041_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 795 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3522, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7881; val_auprc_score: 0.8014; val_best_acc_score: 0.6172; val_best_f1_score: 0.7164; train_kl_reg_loss: 69859.7796; train_edge_recon_loss: 3538337.0458; train_gene_expr_recon_loss: 12624594.2137; train_masked_gp_l1_reg_loss: 54785.4185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 664191.8824; train_chrom_access_recon_loss: 2694029.9809; train_global_loss: 19645798.5038; train_optim_loss: 19645798.5038; val_kl_reg_loss: 78242.5193; val_edge_recon_loss: 4059020.3333; val_gene_expr_recon_loss: 11886945.8667; val_masked_gp_l1_reg_loss: 50644.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 369295.9375; val_chrom_access_recon_loss: 2603330.4167; val_global_loss: 19047480.0000; val_optim_loss: 19047480.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8514; val_auprc_score: 0.8524; val_best_acc_score: 0.7697; val_best_f1_score: 0.7770; train_kl_reg_loss: 75040.0957; train_edge_recon_loss: 3487884.4141; train_gene_expr_recon_loss: 11778242.1069; train_masked_gp_l1_reg_loss: 52072.4072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 227827.2954; train_chrom_access_recon_loss: 2583491.5038; train_global_loss: 18204557.6947; train_optim_loss: 18204557.6947; val_kl_reg_loss: 59888.4784; val_edge_recon_loss: 3521111.7833; val_gene_expr_recon_loss: 11725477.6667; val_masked_gp_l1_reg_loss: 55493.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137630.2969; val_chrom_access_recon_loss: 2569525.8500; val_global_loss: 18069127.6000; val_optim_loss: 18069127.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8809; val_auprc_score: 0.8719; val_best_acc_score: 0.7855; val_best_f1_score: 0.8026; train_kl_reg_loss: 83723.1331; train_edge_recon_loss: 3029183.9179; train_gene_expr_recon_loss: 11658160.7634; train_masked_gp_l1_reg_loss: 59939.9618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103400.9667; train_chrom_access_recon_loss: 2555280.8569; train_global_loss: 17489689.6336; train_optim_loss: 17489689.6336; val_kl_reg_loss: 92885.3068; val_edge_recon_loss: 2959464.7667; val_gene_expr_recon_loss: 11582190.1333; val_masked_gp_l1_reg_loss: 61764.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77559.0703; val_chrom_access_recon_loss: 2542161.3167; val_global_loss: 17316024.5333; val_optim_loss: 17316024.5333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9102; val_auprc_score: 0.8938; val_best_acc_score: 0.8389; val_best_f1_score: 0.8501; train_kl_reg_loss: 88302.0534; train_edge_recon_loss: 2895487.2538; train_gene_expr_recon_loss: 11490989.4733; train_masked_gp_l1_reg_loss: 63997.3619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64814.6321; train_chrom_access_recon_loss: 2526181.4218; train_global_loss: 17129772.2061; train_optim_loss: 17129772.2061; val_kl_reg_loss: 83373.7073; val_edge_recon_loss: 2833447.3667; val_gene_expr_recon_loss: 11425298.6667; val_masked_gp_l1_reg_loss: 66186.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54865.1914; val_chrom_access_recon_loss: 2507340.6667; val_global_loss: 16970511.7333; val_optim_loss: 16970511.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9245; val_auprc_score: 0.9095; val_best_acc_score: 0.8513; val_best_f1_score: 0.8604; train_kl_reg_loss: 86297.5273; train_edge_recon_loss: 2823989.3340; train_gene_expr_recon_loss: 11365419.4580; train_masked_gp_l1_reg_loss: 68459.1985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49008.4678; train_chrom_access_recon_loss: 2501874.6641; train_global_loss: 16895048.7176; train_optim_loss: 16895048.7176; val_kl_reg_loss: 85687.8870; val_edge_recon_loss: 2818525.2000; val_gene_expr_recon_loss: 11363304.6000; val_masked_gp_l1_reg_loss: 70331.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44445.6953; val_chrom_access_recon_loss: 2495814.2167; val_global_loss: 16878110.1333; val_optim_loss: 16878110.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9266; val_auprc_score: 0.9101; val_best_acc_score: 0.8575; val_best_f1_score: 0.8667; train_kl_reg_loss: 85567.3833; train_edge_recon_loss: 2802378.7710; train_gene_expr_recon_loss: 11254013.4962; train_masked_gp_l1_reg_loss: 72014.5692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41171.6422; train_chrom_access_recon_loss: 2478965.6317; train_global_loss: 16734111.3740; train_optim_loss: 16734111.3740; val_kl_reg_loss: 86664.6276; val_edge_recon_loss: 2794371.6833; val_gene_expr_recon_loss: 11257867.8667; val_masked_gp_l1_reg_loss: 73360.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38512.5977; val_chrom_access_recon_loss: 2478848.7833; val_global_loss: 16729625.9333; val_optim_loss: 16729625.9333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9382; val_auprc_score: 0.9275; val_best_acc_score: 0.8716; val_best_f1_score: 0.8773; train_kl_reg_loss: 83984.5936; train_edge_recon_loss: 2768233.5382; train_gene_expr_recon_loss: 11153853.5191; train_masked_gp_l1_reg_loss: 74739.0526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36852.8537; train_chrom_access_recon_loss: 2460778.6508; train_global_loss: 16578442.1832; train_optim_loss: 16578442.1832; val_kl_reg_loss: 84482.9266; val_edge_recon_loss: 2767689.8167; val_gene_expr_recon_loss: 11086654.0000; val_masked_gp_l1_reg_loss: 75837.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35190.9141; val_chrom_access_recon_loss: 2461979.6333; val_global_loss: 16511834.1333; val_optim_loss: 16511834.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9467; val_auprc_score: 0.9349; val_best_acc_score: 0.8847; val_best_f1_score: 0.8908; train_kl_reg_loss: 80425.0452; train_edge_recon_loss: 2759501.3015; train_gene_expr_recon_loss: 11068771.8626; train_masked_gp_l1_reg_loss: 76962.1996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34102.6760; train_chrom_access_recon_loss: 2443752.6679; train_global_loss: 16463515.6565; train_optim_loss: 16463515.6565; val_kl_reg_loss: 77371.7833; val_edge_recon_loss: 2747780.9333; val_gene_expr_recon_loss: 11068227.8667; val_masked_gp_l1_reg_loss: 78004.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33256.9688; val_chrom_access_recon_loss: 2435484.2333; val_global_loss: 16440125.8667; val_optim_loss: 16440125.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9469; val_auprc_score: 0.9329; val_best_acc_score: 0.8828; val_best_f1_score: 0.8882; train_kl_reg_loss: 78560.4035; train_edge_recon_loss: 2750715.4962; train_gene_expr_recon_loss: 10997270.6794; train_masked_gp_l1_reg_loss: 79010.0247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32243.5645; train_chrom_access_recon_loss: 2427320.4237; train_global_loss: 16365120.6183; train_optim_loss: 16365120.6183; val_kl_reg_loss: 79863.1031; val_edge_recon_loss: 2755263.7333; val_gene_expr_recon_loss: 10995001.6000; val_masked_gp_l1_reg_loss: 80031.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31737.5664; val_chrom_access_recon_loss: 2424834.5667; val_global_loss: 16366733.1333; val_optim_loss: 16366733.1333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9498; val_auprc_score: 0.9329; val_best_acc_score: 0.8890; val_best_f1_score: 0.8934; train_kl_reg_loss: 77533.7716; train_edge_recon_loss: 2737145.5802; train_gene_expr_recon_loss: 10932182.5267; train_masked_gp_l1_reg_loss: 80743.5525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31111.3624; train_chrom_access_recon_loss: 2413612.8416; train_global_loss: 16272329.6260; train_optim_loss: 16272329.6260; val_kl_reg_loss: 77447.7776; val_edge_recon_loss: 2732330.3167; val_gene_expr_recon_loss: 10910074.4000; val_masked_gp_l1_reg_loss: 81558.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30617.2910; val_chrom_access_recon_loss: 2413960.6000; val_global_loss: 16245989.2000; val_optim_loss: 16245989.2000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9553; val_auprc_score: 0.9468; val_best_acc_score: 0.8910; val_best_f1_score: 0.8945; train_kl_reg_loss: 75369.2677; train_edge_recon_loss: 2724907.7137; train_gene_expr_recon_loss: 10876239.1298; train_masked_gp_l1_reg_loss: 82323.8604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30339.4356; train_chrom_access_recon_loss: 2401193.2653; train_global_loss: 16190372.6870; train_optim_loss: 16190372.6870; val_kl_reg_loss: 73059.2260; val_edge_recon_loss: 2748349.5500; val_gene_expr_recon_loss: 10884616.8000; val_masked_gp_l1_reg_loss: 83002.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29817.1914; val_chrom_access_recon_loss: 2403801.1667; val_global_loss: 16222646.6667; val_optim_loss: 16222646.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9572; val_auprc_score: 0.9449; val_best_acc_score: 0.8999; val_best_f1_score: 0.9026; train_kl_reg_loss: 75403.2984; train_edge_recon_loss: 2717555.6641; train_gene_expr_recon_loss: 10814700.4733; train_masked_gp_l1_reg_loss: 83598.7501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29751.8850; train_chrom_access_recon_loss: 2388990.3683; train_global_loss: 16110000.5115; train_optim_loss: 16110000.5115; val_kl_reg_loss: 73939.3333; val_edge_recon_loss: 2732155.2667; val_gene_expr_recon_loss: 10822503.8667; val_masked_gp_l1_reg_loss: 84239.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29806.6719; val_chrom_access_recon_loss: 2387821.5667; val_global_loss: 16130467.0667; val_optim_loss: 16130467.0667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9590; val_auprc_score: 0.9489; val_best_acc_score: 0.9022; val_best_f1_score: 0.9075; train_kl_reg_loss: 73063.5914; train_edge_recon_loss: 2712181.8073; train_gene_expr_recon_loss: 10772093.9618; train_masked_gp_l1_reg_loss: 84874.9901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29318.6478; train_chrom_access_recon_loss: 2379005.5477; train_global_loss: 16050538.4885; train_optim_loss: 16050538.4885; val_kl_reg_loss: 71719.2297; val_edge_recon_loss: 2728830.8833; val_gene_expr_recon_loss: 10771395.9333; val_masked_gp_l1_reg_loss: 85571.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29001.1055; val_chrom_access_recon_loss: 2375483.9833; val_global_loss: 16062003.0000; val_optim_loss: 16062003.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9568; val_auprc_score: 0.9438; val_best_acc_score: 0.9012; val_best_f1_score: 0.9036; train_kl_reg_loss: 70899.1159; train_edge_recon_loss: 2712118.9676; train_gene_expr_recon_loss: 10725676.8092; train_masked_gp_l1_reg_loss: 85981.7629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28951.4556; train_chrom_access_recon_loss: 2368038.6107; train_global_loss: 15991666.7481; train_optim_loss: 15991666.7481; val_kl_reg_loss: 72280.7917; val_edge_recon_loss: 2722712.6667; val_gene_expr_recon_loss: 10716518.6667; val_masked_gp_l1_reg_loss: 86685.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28903.2656; val_chrom_access_recon_loss: 2360883.4833; val_global_loss: 15987984.6667; val_optim_loss: 15987984.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9667; val_auprc_score: 0.9592; val_best_acc_score: 0.9107; val_best_f1_score: 0.9136; train_kl_reg_loss: 71254.7346; train_edge_recon_loss: 2704358.9733; train_gene_expr_recon_loss: 10692383.0916; train_masked_gp_l1_reg_loss: 86975.2010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28608.8673; train_chrom_access_recon_loss: 2359119.2424; train_global_loss: 15942700.1908; train_optim_loss: 15942700.1908; val_kl_reg_loss: 70600.7964; val_edge_recon_loss: 2701098.3000; val_gene_expr_recon_loss: 10726637.2000; val_masked_gp_l1_reg_loss: 87327.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28452.6914; val_chrom_access_recon_loss: 2362039.6000; val_global_loss: 15976155.9333; val_optim_loss: 15976155.9333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9659; val_auprc_score: 0.9554; val_best_acc_score: 0.9120; val_best_f1_score: 0.9157; train_kl_reg_loss: 68979.2077; train_edge_recon_loss: 2696143.2366; train_gene_expr_recon_loss: 10662387.7939; train_masked_gp_l1_reg_loss: 87945.6905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28486.2701; train_chrom_access_recon_loss: 2353038.6202; train_global_loss: 15896980.7939; train_optim_loss: 15896980.7939; val_kl_reg_loss: 70126.2370; val_edge_recon_loss: 2695355.1667; val_gene_expr_recon_loss: 10701596.4667; val_masked_gp_l1_reg_loss: 88525.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28333.0996; val_chrom_access_recon_loss: 2377080.8000; val_global_loss: 15961017.8667; val_optim_loss: 15961017.8667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9680; val_auprc_score: 0.9585; val_best_acc_score: 0.9128; val_best_f1_score: 0.9162; train_kl_reg_loss: 69106.6703; train_edge_recon_loss: 2697573.5057; train_gene_expr_recon_loss: 10629052.3053; train_masked_gp_l1_reg_loss: 88790.4476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28281.1374; train_chrom_access_recon_loss: 2344674.6956; train_global_loss: 15857478.6183; train_optim_loss: 15857478.6183; val_kl_reg_loss: 70550.3708; val_edge_recon_loss: 2702654.7333; val_gene_expr_recon_loss: 10616181.4000; val_masked_gp_l1_reg_loss: 89173.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28179.6816; val_chrom_access_recon_loss: 2340910.7833; val_global_loss: 15847650.3333; val_optim_loss: 15847650.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9712; val_auprc_score: 0.9616; val_best_acc_score: 0.9189; val_best_f1_score: 0.9206; train_kl_reg_loss: 69340.0048; train_edge_recon_loss: 2677919.8836; train_gene_expr_recon_loss: 10596562.3206; train_masked_gp_l1_reg_loss: 89416.2783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28096.1526; train_chrom_access_recon_loss: 2339114.1679; train_global_loss: 15800448.7481; train_optim_loss: 15800448.7481; val_kl_reg_loss: 69804.3089; val_edge_recon_loss: 2690686.2167; val_gene_expr_recon_loss: 10608238.6667; val_masked_gp_l1_reg_loss: 89868.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28286.7422; val_chrom_access_recon_loss: 2350651.5000; val_global_loss: 15837535.7333; val_optim_loss: 15837535.7333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9677; val_auprc_score: 0.9585; val_best_acc_score: 0.9154; val_best_f1_score: 0.9190; train_kl_reg_loss: 67885.3463; train_edge_recon_loss: 2694278.7424; train_gene_expr_recon_loss: 10569231.0687; train_masked_gp_l1_reg_loss: 90174.5373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27966.6177; train_chrom_access_recon_loss: 2331840.3674; train_global_loss: 15781376.7252; train_optim_loss: 15781376.7252; val_kl_reg_loss: 67355.7057; val_edge_recon_loss: 2693622.7167; val_gene_expr_recon_loss: 10569343.0667; val_masked_gp_l1_reg_loss: 90558.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27822.8945; val_chrom_access_recon_loss: 2337271.0333; val_global_loss: 15785973.4000; val_optim_loss: 15785973.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9715; val_auprc_score: 0.9646; val_best_acc_score: 0.9209; val_best_f1_score: 0.9229; train_kl_reg_loss: 67899.6917; train_edge_recon_loss: 2684074.5267; train_gene_expr_recon_loss: 10536524.4122; train_masked_gp_l1_reg_loss: 90760.5750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27859.2517; train_chrom_access_recon_loss: 2324582.5534; train_global_loss: 15731700.8473; train_optim_loss: 15731700.8473; val_kl_reg_loss: 68282.2083; val_edge_recon_loss: 2685021.5000; val_gene_expr_recon_loss: 10549859.4000; val_masked_gp_l1_reg_loss: 91090.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27973.0020; val_chrom_access_recon_loss: 2327265.4000; val_global_loss: 15749492.5333; val_optim_loss: 15749492.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9704; val_auprc_score: 0.9632; val_best_acc_score: 0.9200; val_best_f1_score: 0.9222; train_kl_reg_loss: 66551.4317; train_edge_recon_loss: 2684698.0592; train_gene_expr_recon_loss: 10517952.1832; train_masked_gp_l1_reg_loss: 91397.8592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27820.7148; train_chrom_access_recon_loss: 2320265.5219; train_global_loss: 15708685.7786; train_optim_loss: 15708685.7786; val_kl_reg_loss: 66802.9438; val_edge_recon_loss: 2700761.7333; val_gene_expr_recon_loss: 10495256.0667; val_masked_gp_l1_reg_loss: 91578.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27785.6895; val_chrom_access_recon_loss: 2319224.0167; val_global_loss: 15701409.7333; val_optim_loss: 15701409.7333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9733; val_auprc_score: 0.9642; val_best_acc_score: 0.9274; val_best_f1_score: 0.9296; train_kl_reg_loss: 66231.5936; train_edge_recon_loss: 2681916.4580; train_gene_expr_recon_loss: 10496107.0992; train_masked_gp_l1_reg_loss: 91890.2852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27645.6277; train_chrom_access_recon_loss: 2313798.6031; train_global_loss: 15677589.6336; train_optim_loss: 15677589.6336; val_kl_reg_loss: 64812.0237; val_edge_recon_loss: 2684685.0667; val_gene_expr_recon_loss: 10561837.6000; val_masked_gp_l1_reg_loss: 92178.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27854.9961; val_chrom_access_recon_loss: 2319045.0000; val_global_loss: 15750413.6000; val_optim_loss: 15750413.6000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9737; val_auprc_score: 0.9676; val_best_acc_score: 0.9229; val_best_f1_score: 0.9251; train_kl_reg_loss: 66379.0002; train_edge_recon_loss: 2675321.9332; train_gene_expr_recon_loss: 10470552.7252; train_masked_gp_l1_reg_loss: 92382.2638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27533.8574; train_chrom_access_recon_loss: 2308850.3950; train_global_loss: 15641020.2061; train_optim_loss: 15641020.2061; val_kl_reg_loss: 66100.7982; val_edge_recon_loss: 2699817.7667; val_gene_expr_recon_loss: 10503648.8667; val_masked_gp_l1_reg_loss: 92663.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27578.5586; val_chrom_access_recon_loss: 2314894.8000; val_global_loss: 15704705.0667; val_optim_loss: 15704705.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9743; val_auprc_score: 0.9662; val_best_acc_score: 0.9254; val_best_f1_score: 0.9271; train_kl_reg_loss: 65774.8502; train_edge_recon_loss: 2684743.9771; train_gene_expr_recon_loss: 10461139.3435; train_masked_gp_l1_reg_loss: 92909.1707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27414.0801; train_chrom_access_recon_loss: 2306096.5172; train_global_loss: 15638077.9771; train_optim_loss: 15638077.9771; val_kl_reg_loss: 65539.3052; val_edge_recon_loss: 2703534.4167; val_gene_expr_recon_loss: 10489823.6667; val_masked_gp_l1_reg_loss: 93090.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27199.6641; val_chrom_access_recon_loss: 2311321.0500; val_global_loss: 15690509.4000; val_optim_loss: 15690509.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9734; val_auprc_score: 0.9627; val_best_acc_score: 0.9287; val_best_f1_score: 0.9309; train_kl_reg_loss: 65253.9315; train_edge_recon_loss: 2674927.6985; train_gene_expr_recon_loss: 10437033.3817; train_masked_gp_l1_reg_loss: 93284.8747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27283.3325; train_chrom_access_recon_loss: 2300854.5887; train_global_loss: 15598637.7710; train_optim_loss: 15598637.7710; val_kl_reg_loss: 64643.6497; val_edge_recon_loss: 2691387.7500; val_gene_expr_recon_loss: 10439511.8667; val_masked_gp_l1_reg_loss: 93582.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27286.0234; val_chrom_access_recon_loss: 2305654.2667; val_global_loss: 15622066.5333; val_optim_loss: 15622066.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9751; val_auprc_score: 0.9687; val_best_acc_score: 0.9294; val_best_f1_score: 0.9318; train_kl_reg_loss: 69366.5490; train_edge_recon_loss: 2693595.8912; train_gene_expr_recon_loss: 10220540.9771; train_masked_gp_l1_reg_loss: 92448.5363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24606.7839; train_chrom_access_recon_loss: 2258312.7118; train_global_loss: 15358871.4427; train_optim_loss: 15358871.4427; val_kl_reg_loss: 47495.3221; val_edge_recon_loss: 2697938.9833; val_gene_expr_recon_loss: 10209141.7333; val_masked_gp_l1_reg_loss: 92283.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24445.0352; val_chrom_access_recon_loss: 2251758.9500; val_global_loss: 15323062.9333; val_optim_loss: 15323062.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9771; val_auprc_score: 0.9682; val_best_acc_score: 0.9322; val_best_f1_score: 0.9349; train_kl_reg_loss: 66130.0327; train_edge_recon_loss: 2683863.7786; train_gene_expr_recon_loss: 10190524.1908; train_masked_gp_l1_reg_loss: 92349.1543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24502.0437; train_chrom_access_recon_loss: 2247946.2385; train_global_loss: 15305315.5038; train_optim_loss: 15305315.5038; val_kl_reg_loss: 51121.5031; val_edge_recon_loss: 2670341.6500; val_gene_expr_recon_loss: 10234460.3333; val_masked_gp_l1_reg_loss: 92303.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24488.3730; val_chrom_access_recon_loss: 2255511.3000; val_global_loss: 15328226.6000; val_optim_loss: 15328226.6000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9762; val_auprc_score: 0.9695; val_best_acc_score: 0.9306; val_best_f1_score: 0.9328; train_kl_reg_loss: 62960.8056; train_edge_recon_loss: 2678591.4103; train_gene_expr_recon_loss: 10158497.4809; train_masked_gp_l1_reg_loss: 92199.8487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24563.9197; train_chrom_access_recon_loss: 2242311.1393; train_global_loss: 15259124.5649; train_optim_loss: 15259124.5649; val_kl_reg_loss: 51338.5938; val_edge_recon_loss: 2670566.8167; val_gene_expr_recon_loss: 10192130.4000; val_masked_gp_l1_reg_loss: 92197.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24535.6992; val_chrom_access_recon_loss: 2247619.7500; val_global_loss: 15278388.4667; val_optim_loss: 15278388.4667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9745; val_auprc_score: 0.9643; val_best_acc_score: 0.9289; val_best_f1_score: 0.9304; train_kl_reg_loss: 61290.1222; train_edge_recon_loss: 2671100.2634; train_gene_expr_recon_loss: 10146145.7557; train_masked_gp_l1_reg_loss: 92063.2122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24470.2317; train_chrom_access_recon_loss: 2241306.4695; train_global_loss: 15236375.9847; train_optim_loss: 15236375.9847; val_kl_reg_loss: 52643.4844; val_edge_recon_loss: 2684207.6000; val_gene_expr_recon_loss: 10190594.0000; val_masked_gp_l1_reg_loss: 92012.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24566.2852; val_chrom_access_recon_loss: 2252408.6000; val_global_loss: 15296431.4667; val_optim_loss: 15296431.4667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9778; val_auprc_score: 0.9724; val_best_acc_score: 0.9317; val_best_f1_score: 0.9338; train_kl_reg_loss: 60197.1443; train_edge_recon_loss: 2668753.1221; train_gene_expr_recon_loss: 10131272.5191; train_masked_gp_l1_reg_loss: 91941.3897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24454.1136; train_chrom_access_recon_loss: 2239128.7719; train_global_loss: 15215747.0076; train_optim_loss: 15215747.0076; val_kl_reg_loss: 52508.1503; val_edge_recon_loss: 2679985.8667; val_gene_expr_recon_loss: 10166260.9333; val_masked_gp_l1_reg_loss: 91841.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24378.1816; val_chrom_access_recon_loss: 2242764.4167; val_global_loss: 15257739.4000; val_optim_loss: 15257739.4000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9767; val_auprc_score: 0.9696; val_best_acc_score: 0.9312; val_best_f1_score: 0.9333; train_kl_reg_loss: 59524.2783; train_edge_recon_loss: 2666342.8302; train_gene_expr_recon_loss: 10126400.8015; train_masked_gp_l1_reg_loss: 91734.4746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24285.1418; train_chrom_access_recon_loss: 2237162.2347; train_global_loss: 15205449.8168; train_optim_loss: 15205449.8168; val_kl_reg_loss: 55335.2888; val_edge_recon_loss: 2684391.0333; val_gene_expr_recon_loss: 10111234.8000; val_masked_gp_l1_reg_loss: 91705.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24343.2383; val_chrom_access_recon_loss: 2235883.1667; val_global_loss: 15202892.3333; val_optim_loss: 15202892.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9748; val_auprc_score: 0.9663; val_best_acc_score: 0.9302; val_best_f1_score: 0.9331; train_kl_reg_loss: 58009.9383; train_edge_recon_loss: 2672745.9160; train_gene_expr_recon_loss: 10106143.4275; train_masked_gp_l1_reg_loss: 91612.2459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24266.7353; train_chrom_access_recon_loss: 2234300.1574; train_global_loss: 15187078.5115; train_optim_loss: 15187078.5115; val_kl_reg_loss: 54806.2815; val_edge_recon_loss: 2690932.0500; val_gene_expr_recon_loss: 10106887.5333; val_masked_gp_l1_reg_loss: 91556.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24234.0742; val_chrom_access_recon_loss: 2232988.2167; val_global_loss: 15201404.0667; val_optim_loss: 15201404.0667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9778; val_auprc_score: 0.9700; val_best_acc_score: 0.9336; val_best_f1_score: 0.9351; train_kl_reg_loss: 57989.8565; train_edge_recon_loss: 2667381.6260; train_gene_expr_recon_loss: 10089910.7328; train_masked_gp_l1_reg_loss: 91544.4658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24116.6571; train_chrom_access_recon_loss: 2229214.9332; train_global_loss: 15160158.2748; train_optim_loss: 15160158.2748; val_kl_reg_loss: 54772.1862; val_edge_recon_loss: 2676036.4500; val_gene_expr_recon_loss: 10111041.4000; val_masked_gp_l1_reg_loss: 91362.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24002.8359; val_chrom_access_recon_loss: 2222182.0167; val_global_loss: 15179397.0667; val_optim_loss: 15179397.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9767; val_auprc_score: 0.9688; val_best_acc_score: 0.9336; val_best_f1_score: 0.9357; train_kl_reg_loss: 57578.3099; train_edge_recon_loss: 2660947.4714; train_gene_expr_recon_loss: 10074348.0687; train_masked_gp_l1_reg_loss: 91381.6072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24010.0211; train_chrom_access_recon_loss: 2224607.7815; train_global_loss: 15132873.3359; train_optim_loss: 15132873.3359; val_kl_reg_loss: 52536.5263; val_edge_recon_loss: 2680888.9333; val_gene_expr_recon_loss: 10119362.9333; val_masked_gp_l1_reg_loss: 91353.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24017.6211; val_chrom_access_recon_loss: 2227384.7500; val_global_loss: 15195544.2000; val_optim_loss: 15195544.2000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9811; val_auprc_score: 0.9752; val_best_acc_score: 0.9394; val_best_f1_score: 0.9410; train_kl_reg_loss: 56714.6821; train_edge_recon_loss: 2661684.3015; train_gene_expr_recon_loss: 10064339.7023; train_masked_gp_l1_reg_loss: 91392.5366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23936.7668; train_chrom_access_recon_loss: 2221464.3244; train_global_loss: 15119532.2672; train_optim_loss: 15119532.2672; val_kl_reg_loss: 53076.2070; val_edge_recon_loss: 2675262.7167; val_gene_expr_recon_loss: 10106148.4000; val_masked_gp_l1_reg_loss: 91344.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23826.2324; val_chrom_access_recon_loss: 2223775.2667; val_global_loss: 15173433.7333; val_optim_loss: 15173433.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9802; val_auprc_score: 0.9739; val_best_acc_score: 0.9361; val_best_f1_score: 0.9385; train_kl_reg_loss: 57273.7929; train_edge_recon_loss: 2655482.1546; train_gene_expr_recon_loss: 10051338.3740; train_masked_gp_l1_reg_loss: 91353.3686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23806.3036; train_chrom_access_recon_loss: 2220534.0525; train_global_loss: 15099787.9924; train_optim_loss: 15099787.9924; val_kl_reg_loss: 54166.4096; val_edge_recon_loss: 2673910.7500; val_gene_expr_recon_loss: 10099428.8000; val_masked_gp_l1_reg_loss: 91292.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23746.3418; val_chrom_access_recon_loss: 2221885.5333; val_global_loss: 15164429.5333; val_optim_loss: 15164429.5333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9807; val_auprc_score: 0.9750; val_best_acc_score: 0.9398; val_best_f1_score: 0.9415; train_kl_reg_loss: 56088.1061; train_edge_recon_loss: 2660291.8302; train_gene_expr_recon_loss: 10035882.6718; train_masked_gp_l1_reg_loss: 91308.8746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23714.7502; train_chrom_access_recon_loss: 2217784.7214; train_global_loss: 15085070.9084; train_optim_loss: 15085070.9084; val_kl_reg_loss: 53836.9807; val_edge_recon_loss: 2643315.8833; val_gene_expr_recon_loss: 10096527.0667; val_masked_gp_l1_reg_loss: 91312.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23743.9316; val_chrom_access_recon_loss: 2232510.0500; val_global_loss: 15141246.8000; val_optim_loss: 15141246.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9809; val_auprc_score: 0.9748; val_best_acc_score: 0.9435; val_best_f1_score: 0.9445; train_kl_reg_loss: 55749.4529; train_edge_recon_loss: 2662739.4084; train_gene_expr_recon_loss: 10024473.1527; train_masked_gp_l1_reg_loss: 91383.6849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23658.3163; train_chrom_access_recon_loss: 2216585.5515; train_global_loss: 15074589.6260; train_optim_loss: 15074589.6260; val_kl_reg_loss: 52660.5677; val_edge_recon_loss: 2662913.5500; val_gene_expr_recon_loss: 10077251.7333; val_masked_gp_l1_reg_loss: 91345.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23619.0605; val_chrom_access_recon_loss: 2226318.6333; val_global_loss: 15134108.4000; val_optim_loss: 15134108.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9814; val_auprc_score: 0.9746; val_best_acc_score: 0.9415; val_best_f1_score: 0.9432; train_kl_reg_loss: 55570.3457; train_edge_recon_loss: 2656787.5420; train_gene_expr_recon_loss: 10012549.5725; train_masked_gp_l1_reg_loss: 91353.1820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23655.2719; train_chrom_access_recon_loss: 2214467.0859; train_global_loss: 15054383.0000; train_optim_loss: 15054383.0000; val_kl_reg_loss: 52561.4695; val_edge_recon_loss: 2672518.3833; val_gene_expr_recon_loss: 10054956.2667; val_masked_gp_l1_reg_loss: 91360.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23549.7891; val_chrom_access_recon_loss: 2218586.5333; val_global_loss: 15113532.8000; val_optim_loss: 15113532.8000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9805; val_auprc_score: 0.9750; val_best_acc_score: 0.9399; val_best_f1_score: 0.9414; train_kl_reg_loss: 55394.0080; train_edge_recon_loss: 2660583.5038; train_gene_expr_recon_loss: 10003378.3053; train_masked_gp_l1_reg_loss: 91429.4992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23618.5433; train_chrom_access_recon_loss: 2211835.9408; train_global_loss: 15046239.8321; train_optim_loss: 15046239.8321; val_kl_reg_loss: 53686.9349; val_edge_recon_loss: 2679613.6667; val_gene_expr_recon_loss: 9997053.7333; val_masked_gp_l1_reg_loss: 91402.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23505.1113; val_chrom_access_recon_loss: 2212939.8667; val_global_loss: 15058201.9333; val_optim_loss: 15058201.9333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9834; val_auprc_score: 0.9796; val_best_acc_score: 0.9421; val_best_f1_score: 0.9431; train_kl_reg_loss: 55734.5470; train_edge_recon_loss: 2658016.4408; train_gene_expr_recon_loss: 9993809.6947; train_masked_gp_l1_reg_loss: 91403.5521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23524.0480; train_chrom_access_recon_loss: 2211321.0010; train_global_loss: 15033809.2672; train_optim_loss: 15033809.2672; val_kl_reg_loss: 54055.8086; val_edge_recon_loss: 2662505.0000; val_gene_expr_recon_loss: 10069767.6667; val_masked_gp_l1_reg_loss: 91324.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23393.3047; val_chrom_access_recon_loss: 2215389.1500; val_global_loss: 15116434.6667; val_optim_loss: 15116434.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9834; val_auprc_score: 0.9771; val_best_acc_score: 0.9456; val_best_f1_score: 0.9466; train_kl_reg_loss: 55418.5502; train_edge_recon_loss: 2655085.2405; train_gene_expr_recon_loss: 9986326.6107; train_masked_gp_l1_reg_loss: 91359.8356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23431.8674; train_chrom_access_recon_loss: 2210308.3521; train_global_loss: 15021930.4504; train_optim_loss: 15021930.4504; val_kl_reg_loss: 53903.9750; val_edge_recon_loss: 2670853.9000; val_gene_expr_recon_loss: 10031770.9333; val_masked_gp_l1_reg_loss: 91432.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23456.2383; val_chrom_access_recon_loss: 2218407.1000; val_global_loss: 15089824.8667; val_optim_loss: 15089824.8667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9807; val_auprc_score: 0.9737; val_best_acc_score: 0.9427; val_best_f1_score: 0.9443; train_kl_reg_loss: 55191.8275; train_edge_recon_loss: 2658986.7901; train_gene_expr_recon_loss: 9982290.3664; train_masked_gp_l1_reg_loss: 91545.1106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23427.0260; train_chrom_access_recon_loss: 2209912.5496; train_global_loss: 15021353.6412; train_optim_loss: 15021353.6412; val_kl_reg_loss: 53099.8549; val_edge_recon_loss: 2663716.0333; val_gene_expr_recon_loss: 10041247.5333; val_masked_gp_l1_reg_loss: 91580.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23446.8574; val_chrom_access_recon_loss: 2221976.5917; val_global_loss: 15095067.0000; val_optim_loss: 15095067.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9845; val_auprc_score: 0.9789; val_best_acc_score: 0.9468; val_best_f1_score: 0.9477; train_kl_reg_loss: 55382.5100; train_edge_recon_loss: 2656378.6813; train_gene_expr_recon_loss: 9978435.2748; train_masked_gp_l1_reg_loss: 91509.4596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23381.3375; train_chrom_access_recon_loss: 2208693.1002; train_global_loss: 15013780.3435; train_optim_loss: 15013780.3435; val_kl_reg_loss: 52574.4328; val_edge_recon_loss: 2669669.8333; val_gene_expr_recon_loss: 10032864.8000; val_masked_gp_l1_reg_loss: 91498.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23286.3730; val_chrom_access_recon_loss: 2221177.1500; val_global_loss: 15091070.1333; val_optim_loss: 15091070.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9828; val_auprc_score: 0.9782; val_best_acc_score: 0.9456; val_best_f1_score: 0.9471; train_kl_reg_loss: 55513.4981; train_edge_recon_loss: 2648403.7366; train_gene_expr_recon_loss: 9955170.9313; train_masked_gp_l1_reg_loss: 90643.7173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21188.1940; train_chrom_access_recon_loss: 2205543.0181; train_global_loss: 14976463.0534; train_optim_loss: 14976463.0534; val_kl_reg_loss: 54880.4609; val_edge_recon_loss: 2668182.1500; val_gene_expr_recon_loss: 10001783.2000; val_masked_gp_l1_reg_loss: 90312.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20749.2461; val_chrom_access_recon_loss: 2211954.8500; val_global_loss: 15047861.6667; val_optim_loss: 15047861.6667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9851; val_auprc_score: 0.9810; val_best_acc_score: 0.9479; val_best_f1_score: 0.9493; train_kl_reg_loss: 56506.0649; train_edge_recon_loss: 2649832.8397; train_gene_expr_recon_loss: 9956321.9542; train_masked_gp_l1_reg_loss: 90219.8049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20598.2043; train_chrom_access_recon_loss: 2204379.6508; train_global_loss: 14977858.4656; train_optim_loss: 14977858.4656; val_kl_reg_loss: 54429.5805; val_edge_recon_loss: 2645478.6167; val_gene_expr_recon_loss: 10030650.6667; val_masked_gp_l1_reg_loss: 90155.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20479.2129; val_chrom_access_recon_loss: 2213203.0917; val_global_loss: 15054396.1333; val_optim_loss: 15054396.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9832; val_auprc_score: 0.9779; val_best_acc_score: 0.9450; val_best_f1_score: 0.9468; train_kl_reg_loss: 56626.9090; train_edge_recon_loss: 2650893.4294; train_gene_expr_recon_loss: 9962109.5038; train_masked_gp_l1_reg_loss: 90138.5001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20404.8552; train_chrom_access_recon_loss: 2207063.5964; train_global_loss: 14987236.8015; train_optim_loss: 14987236.8015; val_kl_reg_loss: 55474.9643; val_edge_recon_loss: 2662827.0500; val_gene_expr_recon_loss: 10033181.7333; val_masked_gp_l1_reg_loss: 90105.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20295.0859; val_chrom_access_recon_loss: 2222497.3750; val_global_loss: 15084382.2000; val_optim_loss: 15084382.2000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9861; val_auprc_score: 0.9824; val_best_acc_score: 0.9495; val_best_f1_score: 0.9508; train_kl_reg_loss: 56951.5271; train_edge_recon_loss: 2651303.5534; train_gene_expr_recon_loss: 9954155.3893; train_masked_gp_l1_reg_loss: 90090.0550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20243.3542; train_chrom_access_recon_loss: 2204160.5544; train_global_loss: 14976904.5191; train_optim_loss: 14976904.5191; val_kl_reg_loss: 55374.0133; val_edge_recon_loss: 2645952.3500; val_gene_expr_recon_loss: 10017898.7333; val_masked_gp_l1_reg_loss: 90077.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20166.4375; val_chrom_access_recon_loss: 2221518.9833; val_global_loss: 15050987.0000; val_optim_loss: 15050987.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9832; val_auprc_score: 0.9776; val_best_acc_score: 0.9444; val_best_f1_score: 0.9460; train_kl_reg_loss: 57220.5307; train_edge_recon_loss: 2650976.0744; train_gene_expr_recon_loss: 9956415.4198; train_masked_gp_l1_reg_loss: 90060.9323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20121.1488; train_chrom_access_recon_loss: 2205173.8206; train_global_loss: 14979967.9695; train_optim_loss: 14979967.9695; val_kl_reg_loss: 55380.9698; val_edge_recon_loss: 2677994.6167; val_gene_expr_recon_loss: 10036173.3333; val_masked_gp_l1_reg_loss: 90047.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20075.3027; val_chrom_access_recon_loss: 2213204.3500; val_global_loss: 15092875.4000; val_optim_loss: 15092875.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9852; val_auprc_score: 0.9817; val_best_acc_score: 0.9510; val_best_f1_score: 0.9517; train_kl_reg_loss: 57085.7498; train_edge_recon_loss: 2647124.9351; train_gene_expr_recon_loss: 9951930.1069; train_masked_gp_l1_reg_loss: 89961.5673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19866.6079; train_chrom_access_recon_loss: 2205236.0506; train_global_loss: 14971204.9084; train_optim_loss: 14971204.9084; val_kl_reg_loss: 55517.0758; val_edge_recon_loss: 2647954.6667; val_gene_expr_recon_loss: 10040284.0000; val_masked_gp_l1_reg_loss: 89927.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19824.7520; val_chrom_access_recon_loss: 2215681.7500; val_global_loss: 15069189.6000; val_optim_loss: 15069189.6000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9835; val_auprc_score: 0.9785; val_best_acc_score: 0.9456; val_best_f1_score: 0.9467; train_kl_reg_loss: 57199.6596; train_edge_recon_loss: 2647998.5134; train_gene_expr_recon_loss: 9950554.3588; train_masked_gp_l1_reg_loss: 89914.2891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19806.9713; train_chrom_access_recon_loss: 2205525.2176; train_global_loss: 14970999.0687; train_optim_loss: 14970999.0687; val_kl_reg_loss: 55355.1552; val_edge_recon_loss: 2671246.6333; val_gene_expr_recon_loss: 10027355.5333; val_masked_gp_l1_reg_loss: 89902.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19790.4961; val_chrom_access_recon_loss: 2213846.7167; val_global_loss: 15077495.9333; val_optim_loss: 15077495.9333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9818; val_auprc_score: 0.9743; val_best_acc_score: 0.9433; val_best_f1_score: 0.9451; train_kl_reg_loss: 57138.9591; train_edge_recon_loss: 2649168.8969; train_gene_expr_recon_loss: 9949422.9466; train_masked_gp_l1_reg_loss: 89895.0708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19777.8190; train_chrom_access_recon_loss: 2205434.5219; train_global_loss: 14970838.2137; train_optim_loss: 14970838.2137; val_kl_reg_loss: 55621.5435; val_edge_recon_loss: 2670052.9333; val_gene_expr_recon_loss: 10033477.4000; val_masked_gp_l1_reg_loss: 89888.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19765.9863; val_chrom_access_recon_loss: 2211774.3667; val_global_loss: 15080580.4000; val_optim_loss: 15080580.4000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9866; val_auprc_score: 0.9834; val_best_acc_score: 0.9499; val_best_f1_score: 0.9508; train_kl_reg_loss: 56999.9147; train_edge_recon_loss: 2649984.1164; train_gene_expr_recon_loss: 9953925.4733; train_masked_gp_l1_reg_loss: 89883.2822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19758.8224; train_chrom_access_recon_loss: 2206283.1555; train_global_loss: 14976834.7634; train_optim_loss: 14976834.7634; val_kl_reg_loss: 55362.9018; val_edge_recon_loss: 2643849.4833; val_gene_expr_recon_loss: 10041296.8000; val_masked_gp_l1_reg_loss: 89879.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19747.0410; val_chrom_access_recon_loss: 2213989.0500; val_global_loss: 15064124.4000; val_optim_loss: 15064124.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 76 min 41 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9817
val AUPRC score: 0.9767
val best accuracy score: 0.9431
val best F1 score: 0.9449
val target rna MSE score: 1.1618
val source rna MSE score: 0.2313
val target atac MSE score: 0.4909
val source atac MSE score: 0.0790
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
