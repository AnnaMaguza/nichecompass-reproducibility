[True]
Run timestamp: 26072023_011836_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9034; val_auprc_score: 0.9157; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6763.1440; train_edge_recon_loss: 352193.6493; train_gene_expr_recon_loss: 314782.4792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108341348.4444; train_global_loss: 109015088.0000; train_optim_loss: 109015088.0000; val_kl_reg_loss: 16888.9844; val_edge_recon_loss: 406597.8750; val_gene_expr_recon_loss: 302118.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106138376.0000; val_global_loss: 106863984.0000; val_optim_loss: 106863984.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9085; val_auprc_score: 0.9148; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19819.9707; train_edge_recon_loss: 368450.1632; train_gene_expr_recon_loss: 301949.2708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107467099.5556; train_global_loss: 108157319.1111; train_optim_loss: 108157319.1111; val_kl_reg_loss: 22734.5332; val_edge_recon_loss: 406602.0625; val_gene_expr_recon_loss: 282663.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104417816.0000; val_global_loss: 105129816.0000; val_optim_loss: 105129816.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8816; val_auprc_score: 0.8833; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 32949.9525; train_edge_recon_loss: 378252.9583; train_gene_expr_recon_loss: 275702.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 104211784.0000; train_global_loss: 104898688.0000; train_optim_loss: 104898688.0000; val_kl_reg_loss: 41655.5078; val_edge_recon_loss: 406603.1250; val_gene_expr_recon_loss: 259331.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102000768.0000; val_global_loss: 102708360.0000; val_optim_loss: 102708360.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8749; val_auprc_score: 0.8764; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 52380.4080; train_edge_recon_loss: 390925.5382; train_gene_expr_recon_loss: 256733.2951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102001855.1111; train_global_loss: 102701894.2222; train_optim_loss: 102701894.2222; val_kl_reg_loss: 59780.9219; val_edge_recon_loss: 406601.5625; val_gene_expr_recon_loss: 244130.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100196552.0000; val_global_loss: 100907064.0000; val_optim_loss: 100907064.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8817; val_auprc_score: 0.8762; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 72493.4818; train_edge_recon_loss: 397715.6562; train_gene_expr_recon_loss: 244128.3837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100615600.8889; train_global_loss: 101329937.7778; train_optim_loss: 101329937.7778; val_kl_reg_loss: 83725.6562; val_edge_recon_loss: 406598.3438; val_gene_expr_recon_loss: 234905.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99018024.0000; val_global_loss: 99743256.0000; val_optim_loss: 99743256.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8839; val_auprc_score: 0.8731; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 92316.1866; train_edge_recon_loss: 402169.9236; train_gene_expr_recon_loss: 236139.5260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99560024.0000; train_global_loss: 100290650.6667; train_optim_loss: 100290650.6667; val_kl_reg_loss: 93314.1094; val_edge_recon_loss: 406576.9062; val_gene_expr_recon_loss: 228605.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98089136.0000; val_global_loss: 98817632.0000; val_optim_loss: 98817632.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8782; val_auprc_score: 0.8634; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 100288.4149; train_edge_recon_loss: 403147.8854; train_gene_expr_recon_loss: 230237.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98996338.6667; train_global_loss: 99730012.4444; train_optim_loss: 99730012.4444; val_kl_reg_loss: 103908.0156; val_edge_recon_loss: 406540.3125; val_gene_expr_recon_loss: 223056.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97563808.0000; val_global_loss: 98297312.0000; val_optim_loss: 98297312.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8667; val_auprc_score: 0.8512; val_best_acc_score: 0.5034; val_best_f1_score: 0.6682; train_kl_reg_loss: 109221.0035; train_edge_recon_loss: 403453.0243; train_gene_expr_recon_loss: 226031.3420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98457296.8889; train_global_loss: 99196002.6667; train_optim_loss: 99196002.6667; val_kl_reg_loss: 107707.2656; val_edge_recon_loss: 406475.6875; val_gene_expr_recon_loss: 218917.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97215440.0000; val_global_loss: 97948544.0000; val_optim_loss: 97948544.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8545; val_auprc_score: 0.8424; val_best_acc_score: 0.5155; val_best_f1_score: 0.6736; train_kl_reg_loss: 113772.9774; train_edge_recon_loss: 403574.0243; train_gene_expr_recon_loss: 221571.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98267930.6667; train_global_loss: 99006848.0000; train_optim_loss: 99006848.0000; val_kl_reg_loss: 113189.7188; val_edge_recon_loss: 406406.4375; val_gene_expr_recon_loss: 216207.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96941416.0000; val_global_loss: 97677216.0000; val_optim_loss: 97677216.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8482; val_auprc_score: 0.8436; val_best_acc_score: 0.5387; val_best_f1_score: 0.6838; train_kl_reg_loss: 117384.9488; train_edge_recon_loss: 404140.2118; train_gene_expr_recon_loss: 218366.1059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97425863.1111; train_global_loss: 98165755.5556; train_optim_loss: 98165755.5556; val_kl_reg_loss: 114101.4375; val_edge_recon_loss: 406314.4062; val_gene_expr_recon_loss: 214427.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97011976.0000; val_global_loss: 97746816.0000; val_optim_loss: 97746816.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8457; val_auprc_score: 0.8424; val_best_acc_score: 0.5627; val_best_f1_score: 0.6942; train_kl_reg_loss: 118322.9019; train_edge_recon_loss: 404138.7500; train_gene_expr_recon_loss: 217596.4323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97205351.1111; train_global_loss: 97945409.7778; train_optim_loss: 97945409.7778; val_kl_reg_loss: 109239.9453; val_edge_recon_loss: 406199.8438; val_gene_expr_recon_loss: 212878.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96589184.0000; val_global_loss: 97317504.0000; val_optim_loss: 97317504.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8603; val_auprc_score: 0.8574; val_best_acc_score: 0.5864; val_best_f1_score: 0.7050; train_kl_reg_loss: 118740.1623; train_edge_recon_loss: 403584.6736; train_gene_expr_recon_loss: 215450.4740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96933376.0000; train_global_loss: 97671152.8889; train_optim_loss: 97671152.8889; val_kl_reg_loss: 106643.2266; val_edge_recon_loss: 406082.6562; val_gene_expr_recon_loss: 211935.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96651344.0000; val_global_loss: 97376008.0000; val_optim_loss: 97376008.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8648; val_auprc_score: 0.8543; val_best_acc_score: 0.6253; val_best_f1_score: 0.7239; train_kl_reg_loss: 116779.8420; train_edge_recon_loss: 403726.4653; train_gene_expr_recon_loss: 215493.8941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97019617.7778; train_global_loss: 97755618.6667; train_optim_loss: 97755618.6667; val_kl_reg_loss: 106526.6250; val_edge_recon_loss: 405896.6875; val_gene_expr_recon_loss: 210944.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96391648.0000; val_global_loss: 97115016.0000; val_optim_loss: 97115016.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8755; val_auprc_score: 0.8687; val_best_acc_score: 0.6748; val_best_f1_score: 0.7497; train_kl_reg_loss: 117074.5981; train_edge_recon_loss: 403364.9861; train_gene_expr_recon_loss: 214161.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97204957.3333; train_global_loss: 97939558.2222; train_optim_loss: 97939558.2222; val_kl_reg_loss: 110501.2656; val_edge_recon_loss: 405583.8750; val_gene_expr_recon_loss: 209924.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96393960.0000; val_global_loss: 97119968.0000; val_optim_loss: 97119968.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8824; val_auprc_score: 0.8759; val_best_acc_score: 0.7340; val_best_f1_score: 0.7824; train_kl_reg_loss: 116942.0556; train_edge_recon_loss: 402654.3403; train_gene_expr_recon_loss: 213376.1858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96612611.5556; train_global_loss: 97345584.8889; train_optim_loss: 97345584.8889; val_kl_reg_loss: 112524.2500; val_edge_recon_loss: 405121.0938; val_gene_expr_recon_loss: 209115.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96217416.0000; val_global_loss: 96944176.0000; val_optim_loss: 96944176.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8837; val_auprc_score: 0.8721; val_best_acc_score: 0.7767; val_best_f1_score: 0.8048; train_kl_reg_loss: 117287.7943; train_edge_recon_loss: 401905.0347; train_gene_expr_recon_loss: 213271.8767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97391224.0000; train_global_loss: 98123688.0000; train_optim_loss: 98123688.0000; val_kl_reg_loss: 109329.1094; val_edge_recon_loss: 404213.5625; val_gene_expr_recon_loss: 208630.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96073000.0000; val_global_loss: 96795176.0000; val_optim_loss: 96795176.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8890; val_auprc_score: 0.8812; val_best_acc_score: 0.7988; val_best_f1_score: 0.8138; train_kl_reg_loss: 115455.5642; train_edge_recon_loss: 400578.0174; train_gene_expr_recon_loss: 211909.1163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96710422.2222; train_global_loss: 97438364.4444; train_optim_loss: 97438364.4444; val_kl_reg_loss: 105775.9766; val_edge_recon_loss: 402970.9062; val_gene_expr_recon_loss: 208311.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96100752.0000; val_global_loss: 96817808.0000; val_optim_loss: 96817808.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8911; val_auprc_score: 0.8801; val_best_acc_score: 0.8076; val_best_f1_score: 0.8134; train_kl_reg_loss: 114739.0243; train_edge_recon_loss: 399686.5208; train_gene_expr_recon_loss: 211517.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96808161.7778; train_global_loss: 97534104.8889; train_optim_loss: 97534104.8889; val_kl_reg_loss: 106743.0625; val_edge_recon_loss: 401393.8750; val_gene_expr_recon_loss: 207870.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96071304.0000; val_global_loss: 96787312.0000; val_optim_loss: 96787312.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8887; val_auprc_score: 0.8747; val_best_acc_score: 0.8013; val_best_f1_score: 0.8008; train_kl_reg_loss: 113382.9844; train_edge_recon_loss: 398362.2500; train_gene_expr_recon_loss: 209538.2292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96429272.0000; train_global_loss: 97150555.5556; train_optim_loss: 97150555.5556; val_kl_reg_loss: 107253.5703; val_edge_recon_loss: 399847.5625; val_gene_expr_recon_loss: 207330.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95811160.0000; val_global_loss: 96525592.0000; val_optim_loss: 96525592.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8852; val_auprc_score: 0.8658; val_best_acc_score: 0.7982; val_best_f1_score: 0.7908; train_kl_reg_loss: 114186.4392; train_edge_recon_loss: 396333.7535; train_gene_expr_recon_loss: 210488.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96298981.3333; train_global_loss: 97019990.2222; train_optim_loss: 97019990.2222; val_kl_reg_loss: 104944.7500; val_edge_recon_loss: 397677.0312; val_gene_expr_recon_loss: 207209.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95707032.0000; val_global_loss: 96416864.0000; val_optim_loss: 96416864.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8929; val_auprc_score: 0.8809; val_best_acc_score: 0.8002; val_best_f1_score: 0.8009; train_kl_reg_loss: 112592.0252; train_edge_recon_loss: 394127.8715; train_gene_expr_recon_loss: 209545.7552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96503872.0000; train_global_loss: 97220139.5556; train_optim_loss: 97220139.5556; val_kl_reg_loss: 106056.4922; val_edge_recon_loss: 395315.5625; val_gene_expr_recon_loss: 206727.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95598448.0000; val_global_loss: 96306544.0000; val_optim_loss: 96306544.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8915; val_auprc_score: 0.8785; val_best_acc_score: 0.7889; val_best_f1_score: 0.8094; train_kl_reg_loss: 112570.2205; train_edge_recon_loss: 392109.1076; train_gene_expr_recon_loss: 210181.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96327066.6667; train_global_loss: 97041928.8889; train_optim_loss: 97041928.8889; val_kl_reg_loss: 105802.0703; val_edge_recon_loss: 392667.1875; val_gene_expr_recon_loss: 206650.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95548456.0000; val_global_loss: 96253576.0000; val_optim_loss: 96253576.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8951; val_auprc_score: 0.8819; val_best_acc_score: 0.7916; val_best_f1_score: 0.8169; train_kl_reg_loss: 112897.3915; train_edge_recon_loss: 389281.4549; train_gene_expr_recon_loss: 210166.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96141987.5556; train_global_loss: 96854330.6667; train_optim_loss: 96854330.6667; val_kl_reg_loss: 103418.7969; val_edge_recon_loss: 389456.7188; val_gene_expr_recon_loss: 206541.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95488944.0000; val_global_loss: 96188360.0000; val_optim_loss: 96188360.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8909; val_auprc_score: 0.8750; val_best_acc_score: 0.7947; val_best_f1_score: 0.8172; train_kl_reg_loss: 112124.1944; train_edge_recon_loss: 386786.2986; train_gene_expr_recon_loss: 210350.0712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96326248.0000; train_global_loss: 97035508.4444; train_optim_loss: 97035508.4444; val_kl_reg_loss: 105387.3594; val_edge_recon_loss: 386561.5625; val_gene_expr_recon_loss: 206314.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95427472.0000; val_global_loss: 96125736.0000; val_optim_loss: 96125736.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8963; val_auprc_score: 0.8823; val_best_acc_score: 0.8007; val_best_f1_score: 0.8198; train_kl_reg_loss: 111980.1658; train_edge_recon_loss: 384461.3819; train_gene_expr_recon_loss: 208205.3264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95482264.0000; train_global_loss: 96186912.0000; train_optim_loss: 96186912.0000; val_kl_reg_loss: 107638.2578; val_edge_recon_loss: 384694.2188; val_gene_expr_recon_loss: 205894.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95296264.0000; val_global_loss: 95994488.0000; val_optim_loss: 95994488.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9071; val_auprc_score: 0.8906; val_best_acc_score: 0.7995; val_best_f1_score: 0.8280; train_kl_reg_loss: 120788.7257; train_edge_recon_loss: 391079.5069; train_gene_expr_recon_loss: 214147.4601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96298844.4444; train_global_loss: 97024862.2222; train_optim_loss: 97024862.2222; val_kl_reg_loss: 85092.2812; val_edge_recon_loss: 393311.1250; val_gene_expr_recon_loss: 209855.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96148080.0000; val_global_loss: 96836336.0000; val_optim_loss: 96836336.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9093; val_auprc_score: 0.8931; val_best_acc_score: 0.8068; val_best_f1_score: 0.8292; train_kl_reg_loss: 119860.5955; train_edge_recon_loss: 391266.3507; train_gene_expr_recon_loss: 212276.9740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96364092.4444; train_global_loss: 97087496.0000; train_optim_loss: 97087496.0000; val_kl_reg_loss: 82670.9844; val_edge_recon_loss: 393645.7812; val_gene_expr_recon_loss: 209091.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95840928.0000; val_global_loss: 96526336.0000; val_optim_loss: 96526336.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9066; val_auprc_score: 0.8884; val_best_acc_score: 0.8052; val_best_f1_score: 0.8242; train_kl_reg_loss: 115867.8750; train_edge_recon_loss: 390856.9618; train_gene_expr_recon_loss: 211979.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96357263.1111; train_global_loss: 97075967.1111; train_optim_loss: 97075967.1111; val_kl_reg_loss: 79211.5625; val_edge_recon_loss: 393224.8750; val_gene_expr_recon_loss: 208703.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95893672.0000; val_global_loss: 96574808.0000; val_optim_loss: 96574808.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9168; val_auprc_score: 0.9023; val_best_acc_score: 0.8133; val_best_f1_score: 0.8318; train_kl_reg_loss: 110006.7448; train_edge_recon_loss: 390805.7882; train_gene_expr_recon_loss: 211897.4774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96482025.7778; train_global_loss: 97194736.8889; train_optim_loss: 97194736.8889; val_kl_reg_loss: 76298.0625; val_edge_recon_loss: 393214.9375; val_gene_expr_recon_loss: 208740.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95842528.0000; val_global_loss: 96520784.0000; val_optim_loss: 96520784.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9094; val_auprc_score: 0.8914; val_best_acc_score: 0.8110; val_best_f1_score: 0.8198; train_kl_reg_loss: 106210.9583; train_edge_recon_loss: 391898.0382; train_gene_expr_recon_loss: 211981.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96297144.8889; train_global_loss: 97007235.5556; train_optim_loss: 97007235.5556; val_kl_reg_loss: 83900.0938; val_edge_recon_loss: 395171.4688; val_gene_expr_recon_loss: 208254.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95751512.0000; val_global_loss: 96438840.0000; val_optim_loss: 96438840.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9126; val_auprc_score: 0.8912; val_best_acc_score: 0.8130; val_best_f1_score: 0.8289; train_kl_reg_loss: 111420.7856; train_edge_recon_loss: 392937.0139; train_gene_expr_recon_loss: 211177.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96343534.2222; train_global_loss: 97059069.3333; train_optim_loss: 97059069.3333; val_kl_reg_loss: 81170.7656; val_edge_recon_loss: 394462.6250; val_gene_expr_recon_loss: 208295.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95761304.0000; val_global_loss: 96445232.0000; val_optim_loss: 96445232.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9093; val_auprc_score: 0.8922; val_best_acc_score: 0.8071; val_best_f1_score: 0.8246; train_kl_reg_loss: 106391.1970; train_edge_recon_loss: 392808.2604; train_gene_expr_recon_loss: 211059.7587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96170658.6667; train_global_loss: 96880918.2222; train_optim_loss: 96880918.2222; val_kl_reg_loss: 80797.9688; val_edge_recon_loss: 394520.9062; val_gene_expr_recon_loss: 208350.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95803656.0000; val_global_loss: 96487328.0000; val_optim_loss: 96487328.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9113; val_auprc_score: 0.8896; val_best_acc_score: 0.8111; val_best_f1_score: 0.8287; train_kl_reg_loss: 108875.8568; train_edge_recon_loss: 392482.1632; train_gene_expr_recon_loss: 211583.0972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95991128.0000; train_global_loss: 96704070.2222; train_optim_loss: 96704070.2222; val_kl_reg_loss: 82576.4141; val_edge_recon_loss: 394454.6562; val_gene_expr_recon_loss: 208095.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95642208.0000; val_global_loss: 96327336.0000; val_optim_loss: 96327336.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 33 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9030
Val AUPRC score: 0.8873
Val best accuracy score: 0.8018
Val best F1 score: 0.8169
Val gene expr MSE score: 0.6501
Val chrom access MSE score: 0.0864
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
