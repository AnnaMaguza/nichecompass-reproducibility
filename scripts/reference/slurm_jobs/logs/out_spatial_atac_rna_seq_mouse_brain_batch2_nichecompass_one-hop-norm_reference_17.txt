[True]
Run timestamp: 07082023_173728_17.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_17']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8693; val_auprc_score: 0.8941; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8658.8837; train_edge_recon_loss: 36159.8720; train_gene_expr_recon_loss: 1376364.9861; train_masked_gp_l1_reg_loss: 15553.0340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119092.5365; train_chrom_access_recon_loss: 3341537.2361; train_global_loss: 4897366.5278; train_optim_loss: 4897366.5278; val_kl_reg_loss: 8217.7334; val_edge_recon_loss: 40660.9570; val_gene_expr_recon_loss: 1182714.3750; val_masked_gp_l1_reg_loss: 10132.2246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116671.2344; val_chrom_access_recon_loss: 1913534.8750; val_global_loss: 3271931.5000; val_optim_loss: 3271931.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8887; val_auprc_score: 0.9081; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6923.0611; train_edge_recon_loss: 36804.5378; train_gene_expr_recon_loss: 1069017.4306; train_masked_gp_l1_reg_loss: 8632.1242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115319.0990; train_chrom_access_recon_loss: 1600365.3056; train_global_loss: 2837061.5556; train_optim_loss: 2837061.5556; val_kl_reg_loss: 5633.0566; val_edge_recon_loss: 40661.0000; val_gene_expr_recon_loss: 1021027.3750; val_masked_gp_l1_reg_loss: 8072.4395; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113785.7031; val_chrom_access_recon_loss: 1487979.7500; val_global_loss: 2677159.5000; val_optim_loss: 2677159.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8907; val_auprc_score: 0.9090; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6532.1178; train_edge_recon_loss: 36703.3702; train_gene_expr_recon_loss: 966670.3889; train_masked_gp_l1_reg_loss: 8951.1239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112689.3281; train_chrom_access_recon_loss: 1434998.1250; train_global_loss: 2566544.4722; train_optim_loss: 2566544.4722; val_kl_reg_loss: 9260.8330; val_edge_recon_loss: 40661.7422; val_gene_expr_recon_loss: 923917.0625; val_masked_gp_l1_reg_loss: 9757.3877; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111335.2188; val_chrom_access_recon_loss: 1440983.7500; val_global_loss: 2535916.0000; val_optim_loss: 2535916.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8944; val_auprc_score: 0.9123; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13675.1161; train_edge_recon_loss: 37923.3273; train_gene_expr_recon_loss: 859627.3264; train_masked_gp_l1_reg_loss: 9993.2913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110216.7101; train_chrom_access_recon_loss: 1405417.4861; train_global_loss: 2436853.3056; train_optim_loss: 2436853.3056; val_kl_reg_loss: 19342.1680; val_edge_recon_loss: 40662.2812; val_gene_expr_recon_loss: 819761.6250; val_masked_gp_l1_reg_loss: 10248.9014; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108755.7969; val_chrom_access_recon_loss: 1409518.1250; val_global_loss: 2408289.0000; val_optim_loss: 2408289.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8955; val_auprc_score: 0.9115; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 21827.8086; train_edge_recon_loss: 38895.0165; train_gene_expr_recon_loss: 779881.7708; train_masked_gp_l1_reg_loss: 10322.7606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107428.1762; train_chrom_access_recon_loss: 1370646.9583; train_global_loss: 2329002.4722; train_optim_loss: 2329002.4722; val_kl_reg_loss: 23146.5039; val_edge_recon_loss: 40662.2266; val_gene_expr_recon_loss: 768701.2500; val_masked_gp_l1_reg_loss: 10357.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105654.0234; val_chrom_access_recon_loss: 1384106.2500; val_global_loss: 2332627.5000; val_optim_loss: 2332627.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8893; val_auprc_score: 0.9050; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 23182.2928; train_edge_recon_loss: 38982.4661; train_gene_expr_recon_loss: 745013.2014; train_masked_gp_l1_reg_loss: 10355.8234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104073.7005; train_chrom_access_recon_loss: 1350014.2639; train_global_loss: 2271621.7500; train_optim_loss: 2271621.7500; val_kl_reg_loss: 22664.3867; val_edge_recon_loss: 40661.8867; val_gene_expr_recon_loss: 745187.2500; val_masked_gp_l1_reg_loss: 10339.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102019.1406; val_chrom_access_recon_loss: 1363198.2500; val_global_loss: 2284070.0000; val_optim_loss: 2284070.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8817; val_auprc_score: 0.8981; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 23003.2140; train_edge_recon_loss: 38985.2457; train_gene_expr_recon_loss: 726717.1875; train_masked_gp_l1_reg_loss: 10343.2525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100297.4852; train_chrom_access_recon_loss: 1333854.0556; train_global_loss: 2233200.4722; train_optim_loss: 2233200.4722; val_kl_reg_loss: 24056.5039; val_edge_recon_loss: 40661.6680; val_gene_expr_recon_loss: 728375.5000; val_masked_gp_l1_reg_loss: 10354.7559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98121.7578; val_chrom_access_recon_loss: 1352307.6250; val_global_loss: 2253877.7500; val_optim_loss: 2253877.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8704; val_auprc_score: 0.8870; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 25042.5069; train_edge_recon_loss: 39130.7630; train_gene_expr_recon_loss: 710104.7500; train_masked_gp_l1_reg_loss: 10321.8485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96360.9557; train_chrom_access_recon_loss: 1326225.2917; train_global_loss: 2207186.1389; train_optim_loss: 2207186.1389; val_kl_reg_loss: 24704.8574; val_edge_recon_loss: 40660.7109; val_gene_expr_recon_loss: 715252.3125; val_masked_gp_l1_reg_loss: 10241.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94149.2969; val_chrom_access_recon_loss: 1345279.7500; val_global_loss: 2230288.2500; val_optim_loss: 2230288.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8607; val_auprc_score: 0.8651; val_best_acc_score: 0.5082; val_best_f1_score: 0.6702; train_kl_reg_loss: 24924.8733; train_edge_recon_loss: 39139.8355; train_gene_expr_recon_loss: 699136.5417; train_masked_gp_l1_reg_loss: 10164.2447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92371.2726; train_chrom_access_recon_loss: 1320755.8889; train_global_loss: 2186492.6667; train_optim_loss: 2186492.6667; val_kl_reg_loss: 25184.7656; val_edge_recon_loss: 40654.2461; val_gene_expr_recon_loss: 703317.7500; val_masked_gp_l1_reg_loss: 10066.3662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90150.5859; val_chrom_access_recon_loss: 1339793.1250; val_global_loss: 2209166.7500; val_optim_loss: 2209166.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8388; val_auprc_score: 0.8308; val_best_acc_score: 0.5395; val_best_f1_score: 0.6835; train_kl_reg_loss: 25485.6806; train_edge_recon_loss: 39173.2018; train_gene_expr_recon_loss: 687557.5625; train_masked_gp_l1_reg_loss: 9991.2908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88378.0651; train_chrom_access_recon_loss: 1316980.3472; train_global_loss: 2167566.1389; train_optim_loss: 2167566.1389; val_kl_reg_loss: 25287.0859; val_edge_recon_loss: 40627.2344; val_gene_expr_recon_loss: 691753.1250; val_masked_gp_l1_reg_loss: 9890.4873; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86162.0938; val_chrom_access_recon_loss: 1334432.2500; val_global_loss: 2188152.2500; val_optim_loss: 2188152.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8124; val_auprc_score: 0.8023; val_best_acc_score: 0.6017; val_best_f1_score: 0.7118; train_kl_reg_loss: 25657.2587; train_edge_recon_loss: 39171.7157; train_gene_expr_recon_loss: 677582.6319; train_masked_gp_l1_reg_loss: 9798.4804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84402.9514; train_chrom_access_recon_loss: 1314216.7222; train_global_loss: 2150829.7222; train_optim_loss: 2150829.7222; val_kl_reg_loss: 24490.6094; val_edge_recon_loss: 40592.3242; val_gene_expr_recon_loss: 684743.0000; val_masked_gp_l1_reg_loss: 9682.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82218.2188; val_chrom_access_recon_loss: 1330361.6250; val_global_loss: 2172088.0000; val_optim_loss: 2172088.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7953; val_auprc_score: 0.7911; val_best_acc_score: 0.6349; val_best_f1_score: 0.7266; train_kl_reg_loss: 25350.1704; train_edge_recon_loss: 39155.9657; train_gene_expr_recon_loss: 671411.5972; train_masked_gp_l1_reg_loss: 9606.7257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80504.1389; train_chrom_access_recon_loss: 1308403.9722; train_global_loss: 2134432.6389; train_optim_loss: 2134432.6389; val_kl_reg_loss: 24525.3984; val_edge_recon_loss: 40556.3789; val_gene_expr_recon_loss: 678586.7500; val_masked_gp_l1_reg_loss: 9512.0420; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78379.2656; val_chrom_access_recon_loss: 1327371.6250; val_global_loss: 2158931.5000; val_optim_loss: 2158931.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8047; val_auprc_score: 0.7951; val_best_acc_score: 0.6653; val_best_f1_score: 0.7416; train_kl_reg_loss: 25238.7190; train_edge_recon_loss: 39166.8772; train_gene_expr_recon_loss: 669099.7778; train_masked_gp_l1_reg_loss: 9450.4821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76725.5495; train_chrom_access_recon_loss: 1307358.2917; train_global_loss: 2127039.6944; train_optim_loss: 2127039.6944; val_kl_reg_loss: 24667.5098; val_edge_recon_loss: 40534.5352; val_gene_expr_recon_loss: 674010.6875; val_masked_gp_l1_reg_loss: 9376.6064; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74684.9922; val_chrom_access_recon_loss: 1323891.1250; val_global_loss: 2147165.5000; val_optim_loss: 2147165.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7944; val_auprc_score: 0.7943; val_best_acc_score: 0.6711; val_best_f1_score: 0.7425; train_kl_reg_loss: 24756.4733; train_edge_recon_loss: 39167.0122; train_gene_expr_recon_loss: 659289.2361; train_masked_gp_l1_reg_loss: 9331.3110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73107.9870; train_chrom_access_recon_loss: 1298475.5000; train_global_loss: 2104127.5833; train_optim_loss: 2104127.5833; val_kl_reg_loss: 23775.7070; val_edge_recon_loss: 40525.9570; val_gene_expr_recon_loss: 671164.7500; val_masked_gp_l1_reg_loss: 9271.5098; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71164.0078; val_chrom_access_recon_loss: 1320838.1250; val_global_loss: 2136740.0000; val_optim_loss: 2136740.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8127; val_auprc_score: 0.8106; val_best_acc_score: 0.6991; val_best_f1_score: 0.7560; train_kl_reg_loss: 24137.9946; train_edge_recon_loss: 39142.0169; train_gene_expr_recon_loss: 656349.3125; train_masked_gp_l1_reg_loss: 9230.1928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69664.4583; train_chrom_access_recon_loss: 1299517.2083; train_global_loss: 2098041.1806; train_optim_loss: 2098041.1806; val_kl_reg_loss: 22981.8086; val_edge_recon_loss: 40494.1250; val_gene_expr_recon_loss: 668863.0000; val_masked_gp_l1_reg_loss: 9179.3213; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67820.1875; val_chrom_access_recon_loss: 1320267.7500; val_global_loss: 2129606.2500; val_optim_loss: 2129606.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8184; val_auprc_score: 0.8171; val_best_acc_score: 0.6982; val_best_f1_score: 0.7524; train_kl_reg_loss: 23548.8346; train_edge_recon_loss: 39108.0985; train_gene_expr_recon_loss: 656496.2361; train_masked_gp_l1_reg_loss: 9151.8411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66406.9132; train_chrom_access_recon_loss: 1298300.0278; train_global_loss: 2093011.9167; train_optim_loss: 2093011.9167; val_kl_reg_loss: 22906.0586; val_edge_recon_loss: 40490.4844; val_gene_expr_recon_loss: 666110.5000; val_masked_gp_l1_reg_loss: 9121.3730; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64671.4844; val_chrom_access_recon_loss: 1317746.0000; val_global_loss: 2121046.0000; val_optim_loss: 2121046.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8482; val_auprc_score: 0.8483; val_best_acc_score: 0.7367; val_best_f1_score: 0.7720; train_kl_reg_loss: 23143.6753; train_edge_recon_loss: 39083.2908; train_gene_expr_recon_loss: 654424.2431; train_masked_gp_l1_reg_loss: 9103.5476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63340.9258; train_chrom_access_recon_loss: 1299458.8750; train_global_loss: 2088554.5417; train_optim_loss: 2088554.5417; val_kl_reg_loss: 21373.7266; val_edge_recon_loss: 40434.2695; val_gene_expr_recon_loss: 665645.3750; val_masked_gp_l1_reg_loss: 9084.2363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61708.9375; val_chrom_access_recon_loss: 1315443.5000; val_global_loss: 2113690.0000; val_optim_loss: 2113690.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8600; val_auprc_score: 0.8612; val_best_acc_score: 0.7475; val_best_f1_score: 0.7788; train_kl_reg_loss: 22525.9349; train_edge_recon_loss: 39039.7543; train_gene_expr_recon_loss: 654942.9653; train_masked_gp_l1_reg_loss: 9067.9022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60462.2088; train_chrom_access_recon_loss: 1297491.8611; train_global_loss: 2083530.5972; train_optim_loss: 2083530.5972; val_kl_reg_loss: 22121.9531; val_edge_recon_loss: 40426.1211; val_gene_expr_recon_loss: 662372.5000; val_masked_gp_l1_reg_loss: 9047.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58931.1523; val_chrom_access_recon_loss: 1313309.6250; val_global_loss: 2106208.5000; val_optim_loss: 2106208.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8735; val_auprc_score: 0.8732; val_best_acc_score: 0.7732; val_best_f1_score: 0.7937; train_kl_reg_loss: 22165.4104; train_edge_recon_loss: 39000.1241; train_gene_expr_recon_loss: 646999.9792; train_masked_gp_l1_reg_loss: 9030.8745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57760.8563; train_chrom_access_recon_loss: 1284365.8611; train_global_loss: 2059323.1111; train_optim_loss: 2059323.1111; val_kl_reg_loss: 21272.4570; val_edge_recon_loss: 40389.1680; val_gene_expr_recon_loss: 661245.6875; val_masked_gp_l1_reg_loss: 9006.8838; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56321.4023; val_chrom_access_recon_loss: 1310870.3750; val_global_loss: 2099106.0000; val_optim_loss: 2099106.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8843; val_auprc_score: 0.8778; val_best_acc_score: 0.7986; val_best_f1_score: 0.8084; train_kl_reg_loss: 21782.7797; train_edge_recon_loss: 38949.5864; train_gene_expr_recon_loss: 650790.7708; train_masked_gp_l1_reg_loss: 8991.8050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55218.3056; train_chrom_access_recon_loss: 1289878.6250; train_global_loss: 2065611.8611; train_optim_loss: 2065611.8611; val_kl_reg_loss: 20789.1055; val_edge_recon_loss: 40343.2188; val_gene_expr_recon_loss: 659907.8750; val_masked_gp_l1_reg_loss: 8972.1182; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53864.5078; val_chrom_access_recon_loss: 1309061.1250; val_global_loss: 2092938.0000; val_optim_loss: 2092938.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8990; val_auprc_score: 0.8909; val_best_acc_score: 0.8246; val_best_f1_score: 0.8270; train_kl_reg_loss: 21431.8279; train_edge_recon_loss: 38896.4327; train_gene_expr_recon_loss: 644241.8750; train_masked_gp_l1_reg_loss: 8963.5314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52831.6797; train_chrom_access_recon_loss: 1283297.9444; train_global_loss: 2049663.2917; train_optim_loss: 2049663.2917; val_kl_reg_loss: 20695.2109; val_edge_recon_loss: 40302.0234; val_gene_expr_recon_loss: 658404.1875; val_masked_gp_l1_reg_loss: 8946.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51561.5859; val_chrom_access_recon_loss: 1307318.8750; val_global_loss: 2087228.1250; val_optim_loss: 2087228.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9106; val_auprc_score: 0.9007; val_best_acc_score: 0.8292; val_best_f1_score: 0.8269; train_kl_reg_loss: 21173.0087; train_edge_recon_loss: 38846.1428; train_gene_expr_recon_loss: 648041.0000; train_masked_gp_l1_reg_loss: 8936.5495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50588.1211; train_chrom_access_recon_loss: 1287117.8194; train_global_loss: 2054702.6389; train_optim_loss: 2054702.6389; val_kl_reg_loss: 19842.9609; val_edge_recon_loss: 40211.0352; val_gene_expr_recon_loss: 658123.7500; val_masked_gp_l1_reg_loss: 8924.9629; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49389.3828; val_chrom_access_recon_loss: 1305190.7500; val_global_loss: 2081682.7500; val_optim_loss: 2081682.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9179; val_auprc_score: 0.9083; val_best_acc_score: 0.8391; val_best_f1_score: 0.8351; train_kl_reg_loss: 20834.0805; train_edge_recon_loss: 38780.8789; train_gene_expr_recon_loss: 642675.5694; train_masked_gp_l1_reg_loss: 8917.3759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48479.1350; train_chrom_access_recon_loss: 1280490.6250; train_global_loss: 2040177.6528; train_optim_loss: 2040177.6528; val_kl_reg_loss: 20494.8945; val_edge_recon_loss: 40179.7344; val_gene_expr_recon_loss: 655956.8125; val_masked_gp_l1_reg_loss: 8905.6230; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47353.3555; val_chrom_access_recon_loss: 1303443.7500; val_global_loss: 2076334.2500; val_optim_loss: 2076334.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9171; val_auprc_score: 0.9052; val_best_acc_score: 0.8327; val_best_f1_score: 0.8254; train_kl_reg_loss: 20706.1304; train_edge_recon_loss: 38730.7899; train_gene_expr_recon_loss: 642649.0903; train_masked_gp_l1_reg_loss: 8895.6069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46491.6302; train_chrom_access_recon_loss: 1280854.3889; train_global_loss: 2038327.6111; train_optim_loss: 2038327.6111; val_kl_reg_loss: 19272.1680; val_edge_recon_loss: 40071.2617; val_gene_expr_recon_loss: 656140.7500; val_masked_gp_l1_reg_loss: 8885.0283; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45431.7930; val_chrom_access_recon_loss: 1301722.5000; val_global_loss: 2071523.5000; val_optim_loss: 2071523.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9242; val_auprc_score: 0.9129; val_best_acc_score: 0.8354; val_best_f1_score: 0.8261; train_kl_reg_loss: 20342.8309; train_edge_recon_loss: 38670.3429; train_gene_expr_recon_loss: 643518.4028; train_masked_gp_l1_reg_loss: 8879.8549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44626.3546; train_chrom_access_recon_loss: 1282062.8611; train_global_loss: 2038100.6806; train_optim_loss: 2038100.6806; val_kl_reg_loss: 19697.2422; val_edge_recon_loss: 40033.1133; val_gene_expr_recon_loss: 653962.1875; val_masked_gp_l1_reg_loss: 8871.0371; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43633.3008; val_chrom_access_recon_loss: 1299956.5000; val_global_loss: 2066153.5000; val_optim_loss: 2066153.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9183; val_auprc_score: 0.9061; val_best_acc_score: 0.8359; val_best_f1_score: 0.8514; train_kl_reg_loss: 16923.4829; train_edge_recon_loss: 40173.3355; train_gene_expr_recon_loss: 954395.4653; train_masked_gp_l1_reg_loss: 9072.4320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42743.7418; train_chrom_access_recon_loss: 1349381.3750; train_global_loss: 2412689.8611; train_optim_loss: 2412689.8611; val_kl_reg_loss: 14705.8613; val_edge_recon_loss: 40423.0195; val_gene_expr_recon_loss: 966299.2500; val_masked_gp_l1_reg_loss: 9477.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41570.5547; val_chrom_access_recon_loss: 1372192.0000; val_global_loss: 2444668.5000; val_optim_loss: 2444668.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9173; val_auprc_score: 0.8999; val_best_acc_score: 0.8329; val_best_f1_score: 0.8494; train_kl_reg_loss: 15394.6029; train_edge_recon_loss: 40191.8255; train_gene_expr_recon_loss: 942510.2431; train_masked_gp_l1_reg_loss: 9834.4303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40605.8090; train_chrom_access_recon_loss: 1352541.7222; train_global_loss: 2401078.6389; train_optim_loss: 2401078.6389; val_kl_reg_loss: 14065.9004; val_edge_recon_loss: 40429.7383; val_gene_expr_recon_loss: 958248.1250; val_masked_gp_l1_reg_loss: 10255.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39412.5781; val_chrom_access_recon_loss: 1370342.1250; val_global_loss: 2432754.0000; val_optim_loss: 2432754.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9208; val_auprc_score: 0.9065; val_best_acc_score: 0.8379; val_best_f1_score: 0.8519; train_kl_reg_loss: 15184.9527; train_edge_recon_loss: 40209.0156; train_gene_expr_recon_loss: 942991.8264; train_masked_gp_l1_reg_loss: 10508.3645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38492.6688; train_chrom_access_recon_loss: 1346031.9167; train_global_loss: 2393418.7500; train_optim_loss: 2393418.7500; val_kl_reg_loss: 13913.8398; val_edge_recon_loss: 40421.4336; val_gene_expr_recon_loss: 952288.1250; val_masked_gp_l1_reg_loss: 10781.1279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37370.8750; val_chrom_access_recon_loss: 1368486.5000; val_global_loss: 2423262.0000; val_optim_loss: 2423262.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9138; val_auprc_score: 0.9016; val_best_acc_score: 0.8344; val_best_f1_score: 0.8483; train_kl_reg_loss: 15103.6739; train_edge_recon_loss: 40220.1615; train_gene_expr_recon_loss: 934539.1528; train_masked_gp_l1_reg_loss: 10943.0356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36520.6593; train_chrom_access_recon_loss: 1346147.2361; train_global_loss: 2383473.9167; train_optim_loss: 2383473.9167; val_kl_reg_loss: 13751.2734; val_edge_recon_loss: 40416.7070; val_gene_expr_recon_loss: 947732.7500; val_masked_gp_l1_reg_loss: 11112.6035; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35486.8828; val_chrom_access_recon_loss: 1367088.3750; val_global_loss: 2415588.5000; val_optim_loss: 2415588.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9223; val_auprc_score: 0.9117; val_best_acc_score: 0.8414; val_best_f1_score: 0.8538; train_kl_reg_loss: 14849.0033; train_edge_recon_loss: 40217.4570; train_gene_expr_recon_loss: 928214.4028; train_masked_gp_l1_reg_loss: 11044.0801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35372.0100; train_chrom_access_recon_loss: 1347140.4167; train_global_loss: 2376837.3611; train_optim_loss: 2376837.3611; val_kl_reg_loss: 13922.1494; val_edge_recon_loss: 40414.3750; val_gene_expr_recon_loss: 947287.2500; val_masked_gp_l1_reg_loss: 10991.1699; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35231.8594; val_chrom_access_recon_loss: 1366599.8750; val_global_loss: 2414446.7500; val_optim_loss: 2414446.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9152; val_auprc_score: 0.9030; val_best_acc_score: 0.8354; val_best_f1_score: 0.8491; train_kl_reg_loss: 15125.9497; train_edge_recon_loss: 40218.1241; train_gene_expr_recon_loss: 928263.3611; train_masked_gp_l1_reg_loss: 10980.9194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35132.9023; train_chrom_access_recon_loss: 1347836.6250; train_global_loss: 2377557.8889; train_optim_loss: 2377557.8889; val_kl_reg_loss: 14082.4961; val_edge_recon_loss: 40419.0352; val_gene_expr_recon_loss: 946783.6250; val_masked_gp_l1_reg_loss: 10960.0508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35008.5156; val_chrom_access_recon_loss: 1366571.8750; val_global_loss: 2413825.5000; val_optim_loss: 2413825.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9207; val_auprc_score: 0.9099; val_best_acc_score: 0.8405; val_best_f1_score: 0.8529; train_kl_reg_loss: 15088.9156; train_edge_recon_loss: 40219.3924; train_gene_expr_recon_loss: 926538.6875; train_masked_gp_l1_reg_loss: 10950.8496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34914.2604; train_chrom_access_recon_loss: 1336166.9444; train_global_loss: 2363879.0556; train_optim_loss: 2363879.0556; val_kl_reg_loss: 13981.7881; val_edge_recon_loss: 40405.6797; val_gene_expr_recon_loss: 946381.2500; val_masked_gp_l1_reg_loss: 10940.3730; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34798.3516; val_chrom_access_recon_loss: 1366076.1250; val_global_loss: 2412583.5000; val_optim_loss: 2412583.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9194; val_auprc_score: 0.9097; val_best_acc_score: 0.8356; val_best_f1_score: 0.8490; train_kl_reg_loss: 15030.6531; train_edge_recon_loss: 40216.9297; train_gene_expr_recon_loss: 930222.2083; train_masked_gp_l1_reg_loss: 10935.1213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34708.2261; train_chrom_access_recon_loss: 1344265.9028; train_global_loss: 2375379.0556; train_optim_loss: 2375379.0556; val_kl_reg_loss: 14009.4365; val_edge_recon_loss: 40412.0195; val_gene_expr_recon_loss: 946068.2500; val_masked_gp_l1_reg_loss: 10931.1934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34598.8438; val_chrom_access_recon_loss: 1366175.6250; val_global_loss: 2412195.5000; val_optim_loss: 2412195.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9193
val AUPRC score: 0.9064
val best accuracy score: 0.8236
val best F1 score: 0.8433
val target rna MSE score: 4.1047
val source rna MSE score: 3.3518
val target atac MSE score: 0.1387
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
