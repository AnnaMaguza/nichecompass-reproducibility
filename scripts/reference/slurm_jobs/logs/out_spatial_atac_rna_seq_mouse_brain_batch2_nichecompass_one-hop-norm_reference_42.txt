[True]
Run timestamp: 07082023_183506_42.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_42']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9114; val_auprc_score: 0.9208; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7734.3483; train_edge_recon_loss: 35719.4019; train_gene_expr_recon_loss: 1248155.6111; train_masked_gp_l1_reg_loss: 8456.7111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166807.2500; train_chrom_access_recon_loss: 805277.4062; train_global_loss: 2272150.7083; train_optim_loss: 2272150.7083; val_kl_reg_loss: 6265.5166; val_edge_recon_loss: 40658.4961; val_gene_expr_recon_loss: 1067101.5000; val_masked_gp_l1_reg_loss: 6768.6255; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162073.2344; val_chrom_access_recon_loss: 524492.8750; val_global_loss: 1807360.2500; val_optim_loss: 1807360.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9196; val_auprc_score: 0.9246; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8985.5831; train_edge_recon_loss: 37086.0707; train_gene_expr_recon_loss: 934653.0556; train_masked_gp_l1_reg_loss: 6274.3292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159116.9479; train_chrom_access_recon_loss: 496654.1493; train_global_loss: 1642770.1528; train_optim_loss: 1642770.1528; val_kl_reg_loss: 14336.7432; val_edge_recon_loss: 40660.7852; val_gene_expr_recon_loss: 841862.3750; val_masked_gp_l1_reg_loss: 6002.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155450.6094; val_chrom_access_recon_loss: 483175.5000; val_global_loss: 1541488.7500; val_optim_loss: 1541488.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9112; val_auprc_score: 0.9173; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16037.5438; train_edge_recon_loss: 38328.9414; train_gene_expr_recon_loss: 793091.5556; train_masked_gp_l1_reg_loss: 6168.3314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152261.3333; train_chrom_access_recon_loss: 465617.1458; train_global_loss: 1471504.8611; train_optim_loss: 1471504.8611; val_kl_reg_loss: 16642.4570; val_edge_recon_loss: 40659.7305; val_gene_expr_recon_loss: 774078.8750; val_masked_gp_l1_reg_loss: 6342.2168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148019.5469; val_chrom_access_recon_loss: 462434.3125; val_global_loss: 1448177.1250; val_optim_loss: 1448177.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8981; val_auprc_score: 0.9014; val_best_acc_score: 0.5035; val_best_f1_score: 0.6682; train_kl_reg_loss: 18131.0773; train_edge_recon_loss: 38522.0182; train_gene_expr_recon_loss: 748423.2153; train_masked_gp_l1_reg_loss: 6362.2775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144265.5122; train_chrom_access_recon_loss: 458177.4618; train_global_loss: 1413881.5417; train_optim_loss: 1413881.5417; val_kl_reg_loss: 18722.6367; val_edge_recon_loss: 40656.8125; val_gene_expr_recon_loss: 738193.8750; val_masked_gp_l1_reg_loss: 6363.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139384.5156; val_chrom_access_recon_loss: 456092.0938; val_global_loss: 1399413.7500; val_optim_loss: 1399413.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8920; val_auprc_score: 0.8944; val_best_acc_score: 0.5115; val_best_f1_score: 0.6717; train_kl_reg_loss: 19327.3318; train_edge_recon_loss: 38689.3819; train_gene_expr_recon_loss: 717594.8125; train_masked_gp_l1_reg_loss: 6367.1554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135280.0104; train_chrom_access_recon_loss: 450225.6806; train_global_loss: 1367484.3611; train_optim_loss: 1367484.3611; val_kl_reg_loss: 18512.9707; val_edge_recon_loss: 40650.2461; val_gene_expr_recon_loss: 716388.9375; val_masked_gp_l1_reg_loss: 6349.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130072.4375; val_chrom_access_recon_loss: 451978.0625; val_global_loss: 1363952.5000; val_optim_loss: 1363952.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8878; val_auprc_score: 0.8871; val_best_acc_score: 0.5234; val_best_f1_score: 0.6766; train_kl_reg_loss: 19423.0410; train_edge_recon_loss: 38712.8746; train_gene_expr_recon_loss: 700065.9236; train_masked_gp_l1_reg_loss: 6343.7163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125863.4783; train_chrom_access_recon_loss: 446618.5938; train_global_loss: 1337027.6528; train_optim_loss: 1337027.6528; val_kl_reg_loss: 19161.1172; val_edge_recon_loss: 40636.0430; val_gene_expr_recon_loss: 700142.4375; val_masked_gp_l1_reg_loss: 6324.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120610.6250; val_chrom_access_recon_loss: 449157.9688; val_global_loss: 1336032.7500; val_optim_loss: 1336032.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8746; val_auprc_score: 0.8716; val_best_acc_score: 0.5393; val_best_f1_score: 0.6834; train_kl_reg_loss: 19938.1539; train_edge_recon_loss: 38766.9136; train_gene_expr_recon_loss: 687894.1597; train_masked_gp_l1_reg_loss: 6312.2260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116450.2977; train_chrom_access_recon_loss: 445058.1771; train_global_loss: 1314419.9306; train_optim_loss: 1314419.9306; val_kl_reg_loss: 19906.6133; val_edge_recon_loss: 40627.9375; val_gene_expr_recon_loss: 688428.8750; val_masked_gp_l1_reg_loss: 6290.1655; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111298.4844; val_chrom_access_recon_loss: 446939.3438; val_global_loss: 1313491.5000; val_optim_loss: 1313491.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8669; val_auprc_score: 0.8637; val_best_acc_score: 0.5539; val_best_f1_score: 0.6897; train_kl_reg_loss: 20149.1986; train_edge_recon_loss: 38809.4605; train_gene_expr_recon_loss: 683133.5069; train_masked_gp_l1_reg_loss: 6282.4660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107299.6502; train_chrom_access_recon_loss: 443070.7118; train_global_loss: 1298745.0000; train_optim_loss: 1298745.0000; val_kl_reg_loss: 20462.9766; val_edge_recon_loss: 40617.2812; val_gene_expr_recon_loss: 679782.6875; val_masked_gp_l1_reg_loss: 6272.4702; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102391.9922; val_chrom_access_recon_loss: 445104.0000; val_global_loss: 1294631.5000; val_optim_loss: 1294631.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8688; val_auprc_score: 0.8673; val_best_acc_score: 0.5829; val_best_f1_score: 0.7033; train_kl_reg_loss: 20631.9891; train_edge_recon_loss: 38895.1029; train_gene_expr_recon_loss: 669413.8958; train_masked_gp_l1_reg_loss: 6266.3402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98633.3837; train_chrom_access_recon_loss: 440592.0660; train_global_loss: 1274432.7639; train_optim_loss: 1274432.7639; val_kl_reg_loss: 20846.1016; val_edge_recon_loss: 40602.6797; val_gene_expr_recon_loss: 673395.5625; val_masked_gp_l1_reg_loss: 6249.9761; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94046.0938; val_chrom_access_recon_loss: 443593.6562; val_global_loss: 1278734.1250; val_optim_loss: 1278734.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8608; val_auprc_score: 0.8604; val_best_acc_score: 0.6050; val_best_f1_score: 0.7138; train_kl_reg_loss: 20860.6753; train_edge_recon_loss: 38912.8103; train_gene_expr_recon_loss: 669166.6944; train_masked_gp_l1_reg_loss: 6242.6502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90566.5955; train_chrom_access_recon_loss: 440709.9549; train_global_loss: 1266459.3889; train_optim_loss: 1266459.3889; val_kl_reg_loss: 20546.9082; val_edge_recon_loss: 40590.4219; val_gene_expr_recon_loss: 668430.7500; val_masked_gp_l1_reg_loss: 6227.3120; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86338.0469; val_chrom_access_recon_loss: 442230.3750; val_global_loss: 1264363.7500; val_optim_loss: 1264363.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8684; val_auprc_score: 0.8610; val_best_acc_score: 0.6395; val_best_f1_score: 0.7307; train_kl_reg_loss: 20971.7793; train_edge_recon_loss: 38919.6597; train_gene_expr_recon_loss: 658770.7569; train_masked_gp_l1_reg_loss: 6224.5448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83163.9097; train_chrom_access_recon_loss: 440478.6111; train_global_loss: 1248529.2500; train_optim_loss: 1248529.2500; val_kl_reg_loss: 19953.2090; val_edge_recon_loss: 40569.5391; val_gene_expr_recon_loss: 665134.3750; val_masked_gp_l1_reg_loss: 6213.0513; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79310.6172; val_chrom_access_recon_loss: 441109.2188; val_global_loss: 1252290.0000; val_optim_loss: 1252290.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8822; val_auprc_score: 0.8790; val_best_acc_score: 0.6822; val_best_f1_score: 0.7534; train_kl_reg_loss: 20872.9978; train_edge_recon_loss: 38909.0174; train_gene_expr_recon_loss: 657349.5694; train_masked_gp_l1_reg_loss: 6210.0092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76448.6910; train_chrom_access_recon_loss: 438197.1076; train_global_loss: 1237987.3889; train_optim_loss: 1237987.3889; val_kl_reg_loss: 19759.6094; val_edge_recon_loss: 40544.1953; val_gene_expr_recon_loss: 661980.6875; val_masked_gp_l1_reg_loss: 6206.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72994.0938; val_chrom_access_recon_loss: 440077.2500; val_global_loss: 1241562.7500; val_optim_loss: 1241562.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8934; val_auprc_score: 0.8907; val_best_acc_score: 0.7233; val_best_f1_score: 0.7769; train_kl_reg_loss: 20653.4338; train_edge_recon_loss: 38903.1845; train_gene_expr_recon_loss: 651996.0069; train_masked_gp_l1_reg_loss: 6211.3015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70430.9566; train_chrom_access_recon_loss: 437697.2882; train_global_loss: 1225892.1806; train_optim_loss: 1225892.1806; val_kl_reg_loss: 19797.8145; val_edge_recon_loss: 40514.9180; val_gene_expr_recon_loss: 659016.2500; val_masked_gp_l1_reg_loss: 6206.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67325.8516; val_chrom_access_recon_loss: 438992.5625; val_global_loss: 1231854.0000; val_optim_loss: 1231854.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9077; val_auprc_score: 0.9068; val_best_acc_score: 0.7627; val_best_f1_score: 0.8007; train_kl_reg_loss: 20366.4334; train_edge_recon_loss: 38870.1385; train_gene_expr_recon_loss: 650318.0833; train_masked_gp_l1_reg_loss: 6203.4725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65015.0530; train_chrom_access_recon_loss: 434968.6736; train_global_loss: 1215741.8333; train_optim_loss: 1215741.8333; val_kl_reg_loss: 19669.4922; val_edge_recon_loss: 40485.9375; val_gene_expr_recon_loss: 656558.0000; val_masked_gp_l1_reg_loss: 6197.3760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62212.4023; val_chrom_access_recon_loss: 438172.8438; val_global_loss: 1223296.0000; val_optim_loss: 1223296.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9108; val_auprc_score: 0.9031; val_best_acc_score: 0.7968; val_best_f1_score: 0.8225; train_kl_reg_loss: 20016.3290; train_edge_recon_loss: 38824.6146; train_gene_expr_recon_loss: 645907.5625; train_masked_gp_l1_reg_loss: 6196.3473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60131.9093; train_chrom_access_recon_loss: 434536.1562; train_global_loss: 1205612.9028; train_optim_loss: 1205612.9028; val_kl_reg_loss: 19325.6680; val_edge_recon_loss: 40438.5898; val_gene_expr_recon_loss: 654615.6250; val_masked_gp_l1_reg_loss: 6192.6074; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57604.7188; val_chrom_access_recon_loss: 437284.4688; val_global_loss: 1215461.7500; val_optim_loss: 1215461.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9158; val_auprc_score: 0.9067; val_best_acc_score: 0.8197; val_best_f1_score: 0.8376; train_kl_reg_loss: 19757.8720; train_edge_recon_loss: 38786.4240; train_gene_expr_recon_loss: 647507.1944; train_masked_gp_l1_reg_loss: 6198.6366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55729.0760; train_chrom_access_recon_loss: 434397.7431; train_global_loss: 1202376.9583; train_optim_loss: 1202376.9583; val_kl_reg_loss: 19315.5312; val_edge_recon_loss: 40384.1953; val_gene_expr_recon_loss: 652654.4375; val_masked_gp_l1_reg_loss: 6197.0107; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53455.1641; val_chrom_access_recon_loss: 436382.8750; val_global_loss: 1208389.2500; val_optim_loss: 1208389.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9235; val_auprc_score: 0.9144; val_best_acc_score: 0.8395; val_best_f1_score: 0.8502; train_kl_reg_loss: 19561.2036; train_edge_recon_loss: 38728.4028; train_gene_expr_recon_loss: 647953.1458; train_masked_gp_l1_reg_loss: 6201.3176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51764.2188; train_chrom_access_recon_loss: 434551.0139; train_global_loss: 1198759.3333; train_optim_loss: 1198759.3333; val_kl_reg_loss: 18419.3887; val_edge_recon_loss: 40329.9570; val_gene_expr_recon_loss: 651753.7500; val_masked_gp_l1_reg_loss: 6203.2949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49708.7891; val_chrom_access_recon_loss: 435619.0000; val_global_loss: 1202034.2500; val_optim_loss: 1202034.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9228; val_auprc_score: 0.9142; val_best_acc_score: 0.8495; val_best_f1_score: 0.8565; train_kl_reg_loss: 19212.7259; train_edge_recon_loss: 38688.5508; train_gene_expr_recon_loss: 645319.0208; train_masked_gp_l1_reg_loss: 6207.7868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48186.4492; train_chrom_access_recon_loss: 433821.3785; train_global_loss: 1191435.8889; train_optim_loss: 1191435.8889; val_kl_reg_loss: 18324.4688; val_edge_recon_loss: 40277.8672; val_gene_expr_recon_loss: 649986.2500; val_masked_gp_l1_reg_loss: 6210.6973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46327.9766; val_chrom_access_recon_loss: 435673.3750; val_global_loss: 1196800.6250; val_optim_loss: 1196800.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9224; val_auprc_score: 0.9123; val_best_acc_score: 0.8499; val_best_f1_score: 0.8548; train_kl_reg_loss: 18927.2795; train_edge_recon_loss: 38621.3698; train_gene_expr_recon_loss: 644480.6181; train_masked_gp_l1_reg_loss: 6222.9370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44937.0764; train_chrom_access_recon_loss: 432671.7292; train_global_loss: 1185861.0139; train_optim_loss: 1185861.0139; val_kl_reg_loss: 18360.2266; val_edge_recon_loss: 40230.5195; val_gene_expr_recon_loss: 648151.0000; val_masked_gp_l1_reg_loss: 6225.9497; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43244.9219; val_chrom_access_recon_loss: 435030.9062; val_global_loss: 1191243.5000; val_optim_loss: 1191243.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9269; val_auprc_score: 0.9159; val_best_acc_score: 0.8554; val_best_f1_score: 0.8568; train_kl_reg_loss: 18602.9026; train_edge_recon_loss: 38563.7218; train_gene_expr_recon_loss: 643037.0278; train_masked_gp_l1_reg_loss: 6231.7510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41982.2270; train_chrom_access_recon_loss: 431923.3507; train_global_loss: 1180341.0000; train_optim_loss: 1180341.0000; val_kl_reg_loss: 17710.2383; val_edge_recon_loss: 40150.2305; val_gene_expr_recon_loss: 647189.1875; val_masked_gp_l1_reg_loss: 6235.0166; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40441.3047; val_chrom_access_recon_loss: 434277.8438; val_global_loss: 1186003.7500; val_optim_loss: 1186003.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9244; val_auprc_score: 0.9091; val_best_acc_score: 0.8541; val_best_f1_score: 0.8535; train_kl_reg_loss: 18365.8051; train_edge_recon_loss: 38504.7782; train_gene_expr_recon_loss: 639200.0417; train_masked_gp_l1_reg_loss: 6248.2261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39298.5673; train_chrom_access_recon_loss: 432360.4236; train_global_loss: 1173977.8194; train_optim_loss: 1173977.8194; val_kl_reg_loss: 17461.5625; val_edge_recon_loss: 40117.4805; val_gene_expr_recon_loss: 646009.5000; val_masked_gp_l1_reg_loss: 6247.9160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37901.6484; val_chrom_access_recon_loss: 433568.2188; val_global_loss: 1181306.3750; val_optim_loss: 1181306.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9383; val_auprc_score: 0.9303; val_best_acc_score: 0.8604; val_best_f1_score: 0.8557; train_kl_reg_loss: 18152.3168; train_edge_recon_loss: 38445.0139; train_gene_expr_recon_loss: 638765.0000; train_masked_gp_l1_reg_loss: 6254.6869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36862.8082; train_chrom_access_recon_loss: 430735.5764; train_global_loss: 1169215.4167; train_optim_loss: 1169215.4167; val_kl_reg_loss: 17234.6191; val_edge_recon_loss: 40008.9453; val_gene_expr_recon_loss: 644820.0000; val_masked_gp_l1_reg_loss: 6257.2856; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35579.1367; val_chrom_access_recon_loss: 432962.2188; val_global_loss: 1176862.2500; val_optim_loss: 1176862.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9340; val_auprc_score: 0.9223; val_best_acc_score: 0.8500; val_best_f1_score: 0.8430; train_kl_reg_loss: 17941.3848; train_edge_recon_loss: 38376.0143; train_gene_expr_recon_loss: 636852.7778; train_masked_gp_l1_reg_loss: 6267.5813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34624.3798; train_chrom_access_recon_loss: 431788.1910; train_global_loss: 1165850.3333; train_optim_loss: 1165850.3333; val_kl_reg_loss: 17164.3418; val_edge_recon_loss: 39948.3008; val_gene_expr_recon_loss: 643395.0000; val_masked_gp_l1_reg_loss: 6265.8833; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33458.7539; val_chrom_access_recon_loss: 432126.4062; val_global_loss: 1172358.6250; val_optim_loss: 1172358.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9362; val_auprc_score: 0.9217; val_best_acc_score: 0.8445; val_best_f1_score: 0.8333; train_kl_reg_loss: 17784.5269; train_edge_recon_loss: 38288.6476; train_gene_expr_recon_loss: 635521.1042; train_masked_gp_l1_reg_loss: 6272.2383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32585.2109; train_chrom_access_recon_loss: 431100.9306; train_global_loss: 1161552.6528; train_optim_loss: 1161552.6528; val_kl_reg_loss: 16675.8164; val_edge_recon_loss: 39817.3047; val_gene_expr_recon_loss: 643081.2500; val_masked_gp_l1_reg_loss: 6271.4512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31508.3379; val_chrom_access_recon_loss: 431445.9062; val_global_loss: 1168800.0000; val_optim_loss: 1168800.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9410; val_auprc_score: 0.9321; val_best_acc_score: 0.8461; val_best_f1_score: 0.8363; train_kl_reg_loss: 17593.6452; train_edge_recon_loss: 38211.1528; train_gene_expr_recon_loss: 633743.4722; train_masked_gp_l1_reg_loss: 6278.4772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30712.7303; train_chrom_access_recon_loss: 428101.8715; train_global_loss: 1154641.3611; train_optim_loss: 1154641.3611; val_kl_reg_loss: 17131.8164; val_edge_recon_loss: 39736.1016; val_gene_expr_recon_loss: 641014.2500; val_masked_gp_l1_reg_loss: 6283.5835; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29727.2891; val_chrom_access_recon_loss: 430678.4062; val_global_loss: 1164571.5000; val_optim_loss: 1164571.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9411; val_auprc_score: 0.9332; val_best_acc_score: 0.8751; val_best_f1_score: 0.8770; train_kl_reg_loss: 14383.6050; train_edge_recon_loss: 39729.2227; train_gene_expr_recon_loss: 974199.7708; train_masked_gp_l1_reg_loss: 6420.3707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28861.9920; train_chrom_access_recon_loss: 454871.5208; train_global_loss: 1518466.5000; train_optim_loss: 1518466.5000; val_kl_reg_loss: 11732.5869; val_edge_recon_loss: 40170.8555; val_gene_expr_recon_loss: 972226.4375; val_masked_gp_l1_reg_loss: 6684.3237; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27696.3184; val_chrom_access_recon_loss: 456009.8750; val_global_loss: 1514520.3750; val_optim_loss: 1514520.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9334; val_auprc_score: 0.9249; val_best_acc_score: 0.8666; val_best_f1_score: 0.8710; train_kl_reg_loss: 13355.1249; train_edge_recon_loss: 39861.9540; train_gene_expr_recon_loss: 962744.6250; train_masked_gp_l1_reg_loss: 6918.4463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26750.6252; train_chrom_access_recon_loss: 454687.8507; train_global_loss: 1504318.6250; train_optim_loss: 1504318.6250; val_kl_reg_loss: 11414.0098; val_edge_recon_loss: 40216.2266; val_gene_expr_recon_loss: 964614.7500; val_masked_gp_l1_reg_loss: 7183.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25590.8105; val_chrom_access_recon_loss: 455058.7500; val_global_loss: 1504077.7500; val_optim_loss: 1504077.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9362; val_auprc_score: 0.9278; val_best_acc_score: 0.8685; val_best_f1_score: 0.8714; train_kl_reg_loss: 12938.0800; train_edge_recon_loss: 39851.0564; train_gene_expr_recon_loss: 955961.9861; train_masked_gp_l1_reg_loss: 7350.4008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24720.7194; train_chrom_access_recon_loss: 451772.7118; train_global_loss: 1492594.9444; train_optim_loss: 1492594.9444; val_kl_reg_loss: 11434.7275; val_edge_recon_loss: 40183.7422; val_gene_expr_recon_loss: 958693.7500; val_masked_gp_l1_reg_loss: 7527.5825; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23669.2695; val_chrom_access_recon_loss: 454297.3750; val_global_loss: 1495806.5000; val_optim_loss: 1495806.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9391; val_auprc_score: 0.9268; val_best_acc_score: 0.8756; val_best_f1_score: 0.8755; train_kl_reg_loss: 12957.8178; train_edge_recon_loss: 39847.8793; train_gene_expr_recon_loss: 949855.8125; train_masked_gp_l1_reg_loss: 7634.4283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22889.8511; train_chrom_access_recon_loss: 451912.6875; train_global_loss: 1485098.5000; train_optim_loss: 1485098.5000; val_kl_reg_loss: 11499.3320; val_edge_recon_loss: 40122.1562; val_gene_expr_recon_loss: 953855.1250; val_masked_gp_l1_reg_loss: 7745.2837; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21950.7402; val_chrom_access_recon_loss: 453623.7188; val_global_loss: 1488796.3750; val_optim_loss: 1488796.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9414; val_auprc_score: 0.9336; val_best_acc_score: 0.8719; val_best_f1_score: 0.8725; train_kl_reg_loss: 12762.2891; train_edge_recon_loss: 39804.6181; train_gene_expr_recon_loss: 949684.4306; train_masked_gp_l1_reg_loss: 7717.5504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21787.6139; train_chrom_access_recon_loss: 451754.6840; train_global_loss: 1483511.1806; train_optim_loss: 1483511.1806; val_kl_reg_loss: 11986.1924; val_edge_recon_loss: 40103.6562; val_gene_expr_recon_loss: 952952.5625; val_masked_gp_l1_reg_loss: 7695.6143; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21610.1660; val_chrom_access_recon_loss: 453531.8438; val_global_loss: 1487880.1250; val_optim_loss: 1487880.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9389; val_auprc_score: 0.9265; val_best_acc_score: 0.8742; val_best_f1_score: 0.8742; train_kl_reg_loss: 13180.1276; train_edge_recon_loss: 39796.3325; train_gene_expr_recon_loss: 944163.1736; train_masked_gp_l1_reg_loss: 7693.0985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21510.4666; train_chrom_access_recon_loss: 449622.2188; train_global_loss: 1475965.4583; train_optim_loss: 1475965.4583; val_kl_reg_loss: 12101.4922; val_edge_recon_loss: 40108.8516; val_gene_expr_recon_loss: 952429.7500; val_masked_gp_l1_reg_loss: 7685.6221; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21379.5996; val_chrom_access_recon_loss: 453429.1875; val_global_loss: 1487134.5000; val_optim_loss: 1487134.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9386; val_auprc_score: 0.9286; val_best_acc_score: 0.8708; val_best_f1_score: 0.8704; train_kl_reg_loss: 13063.0611; train_edge_recon_loss: 39785.6606; train_gene_expr_recon_loss: 949708.5208; train_masked_gp_l1_reg_loss: 7682.0077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21286.4043; train_chrom_access_recon_loss: 452179.1424; train_global_loss: 1483704.7917; train_optim_loss: 1483704.7917; val_kl_reg_loss: 11905.3555; val_edge_recon_loss: 40081.3984; val_gene_expr_recon_loss: 952227.0000; val_masked_gp_l1_reg_loss: 7678.7520; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21172.8086; val_chrom_access_recon_loss: 453359.4688; val_global_loss: 1486424.7500; val_optim_loss: 1486424.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9371; val_auprc_score: 0.9217; val_best_acc_score: 0.8689; val_best_f1_score: 0.8682; train_kl_reg_loss: 13032.5686; train_edge_recon_loss: 39774.1141; train_gene_expr_recon_loss: 943213.4375; train_masked_gp_l1_reg_loss: 7678.4723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21086.9963; train_chrom_access_recon_loss: 451959.9757; train_global_loss: 1476745.5694; train_optim_loss: 1476745.5694; val_kl_reg_loss: 12048.5898; val_edge_recon_loss: 40063.0547; val_gene_expr_recon_loss: 951748.6250; val_masked_gp_l1_reg_loss: 7678.5947; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20984.5527; val_chrom_access_recon_loss: 453297.6562; val_global_loss: 1485821.1250; val_optim_loss: 1485821.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9417
val AUPRC score: 0.9324
val best accuracy score: 0.8777
val best F1 score: 0.8806
val target rna MSE score: 3.8618
val source rna MSE score: 3.2448
val target atac MSE score: 0.1386
val source atac MSE score: 0.0210
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
