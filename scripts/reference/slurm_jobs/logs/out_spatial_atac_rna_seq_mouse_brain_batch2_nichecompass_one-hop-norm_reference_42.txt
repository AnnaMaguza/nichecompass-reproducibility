[True]
Run timestamp: 24072023_164335_42.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_42']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9105; val_auprc_score: 0.9210; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 15516.0343; train_edge_recon_loss: 3482965.6667; train_gene_expr_recon_loss: 3099222.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10996378.7778; train_global_loss: 17594083.1111; train_optim_loss: 17594083.1111; val_kl_reg_loss: 16747.4277; val_edge_recon_loss: 4065722.7500; val_gene_expr_recon_loss: 2894932.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10733434.0000; val_global_loss: 17710836.0000; val_optim_loss: 17710836.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9107; val_auprc_score: 0.9212; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 33032.0920; train_edge_recon_loss: 3519499.4167; train_gene_expr_recon_loss: 2816778.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10661513.8889; train_global_loss: 17030824.0000; train_optim_loss: 17030824.0000; val_kl_reg_loss: 53700.1484; val_edge_recon_loss: 4065730.5000; val_gene_expr_recon_loss: 2691848.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10525594.0000; val_global_loss: 17336872.0000; val_optim_loss: 17336872.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8927; val_auprc_score: 0.9044; val_best_acc_score: 0.5042; val_best_f1_score: 0.6685; train_kl_reg_loss: 53280.2704; train_edge_recon_loss: 3526770.4444; train_gene_expr_recon_loss: 2650965.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10447971.2222; train_global_loss: 16678987.6667; train_optim_loss: 16678987.6667; val_kl_reg_loss: 61047.6875; val_edge_recon_loss: 4065371.2500; val_gene_expr_recon_loss: 2530670.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10343486.0000; val_global_loss: 17000576.0000; val_optim_loss: 17000576.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9052; val_auprc_score: 0.9087; val_best_acc_score: 0.5125; val_best_f1_score: 0.6723; train_kl_reg_loss: 76452.5004; train_edge_recon_loss: 3535557.4444; train_gene_expr_recon_loss: 2475952.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10239758.4444; train_global_loss: 16327720.5556; train_optim_loss: 16327720.5556; val_kl_reg_loss: 74487.0625; val_edge_recon_loss: 4064869.5000; val_gene_expr_recon_loss: 2393155.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10152048.0000; val_global_loss: 16684560.0000; val_optim_loss: 16684560.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9023; val_auprc_score: 0.9008; val_best_acc_score: 0.5372; val_best_f1_score: 0.6834; train_kl_reg_loss: 91099.3307; train_edge_recon_loss: 3539141.9722; train_gene_expr_recon_loss: 2377559.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10106389.4444; train_global_loss: 16114190.0000; train_optim_loss: 16114190.0000; val_kl_reg_loss: 67207.7344; val_edge_recon_loss: 4063003.2500; val_gene_expr_recon_loss: 2314404.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10041459.0000; val_global_loss: 16486074.0000; val_optim_loss: 16486074.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8954; val_auprc_score: 0.8948; val_best_acc_score: 0.5546; val_best_f1_score: 0.6913; train_kl_reg_loss: 101758.4748; train_edge_recon_loss: 3542144.7500; train_gene_expr_recon_loss: 2291565.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9943270.5556; train_global_loss: 15878738.8889; train_optim_loss: 15878738.8889; val_kl_reg_loss: 94177.7812; val_edge_recon_loss: 4062057.2500; val_gene_expr_recon_loss: 2251872.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9954042.0000; val_global_loss: 16362150.0000; val_optim_loss: 16362150.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8858; val_auprc_score: 0.8842; val_best_acc_score: 0.5834; val_best_f1_score: 0.7046; train_kl_reg_loss: 110636.8446; train_edge_recon_loss: 3543738.4444; train_gene_expr_recon_loss: 2254336.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9925901.1111; train_global_loss: 15834613.0000; train_optim_loss: 15834613.0000; val_kl_reg_loss: 88802.5625; val_edge_recon_loss: 4060673.5000; val_gene_expr_recon_loss: 2211159.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9901321.0000; val_global_loss: 16261956.0000; val_optim_loss: 16261956.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8760; val_auprc_score: 0.8765; val_best_acc_score: 0.6139; val_best_f1_score: 0.7182; train_kl_reg_loss: 112077.6510; train_edge_recon_loss: 3543850.2500; train_gene_expr_recon_loss: 2203042.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9835806.0000; train_global_loss: 15694775.8889; train_optim_loss: 15694775.8889; val_kl_reg_loss: 99072.7188; val_edge_recon_loss: 4058829.2500; val_gene_expr_recon_loss: 2176801.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9855664.0000; val_global_loss: 16190368.0000; val_optim_loss: 16190368.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8728; val_auprc_score: 0.8745; val_best_acc_score: 0.6571; val_best_f1_score: 0.7395; train_kl_reg_loss: 113115.5964; train_edge_recon_loss: 3540393.4722; train_gene_expr_recon_loss: 2175781.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9796818.0000; train_global_loss: 15626108.6667; train_optim_loss: 15626108.6667; val_kl_reg_loss: 98757.2656; val_edge_recon_loss: 4055880.5000; val_gene_expr_recon_loss: 2154243.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9832961.0000; val_global_loss: 16141842.0000; val_optim_loss: 16141842.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8763; val_auprc_score: 0.8729; val_best_acc_score: 0.7218; val_best_f1_score: 0.7739; train_kl_reg_loss: 113184.0590; train_edge_recon_loss: 3539297.0278; train_gene_expr_recon_loss: 2169080.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9806499.1111; train_global_loss: 15628060.3333; train_optim_loss: 15628060.3333; val_kl_reg_loss: 85732.8047; val_edge_recon_loss: 4050536.7500; val_gene_expr_recon_loss: 2142839.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9811253.0000; val_global_loss: 16090362.0000; val_optim_loss: 16090362.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8742; val_auprc_score: 0.8660; val_best_acc_score: 0.7635; val_best_f1_score: 0.7966; train_kl_reg_loss: 109388.5911; train_edge_recon_loss: 3535229.1667; train_gene_expr_recon_loss: 2152320.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9821014.5556; train_global_loss: 15617953.1111; train_optim_loss: 15617953.1111; val_kl_reg_loss: 97197.3594; val_edge_recon_loss: 4043244.0000; val_gene_expr_recon_loss: 2127697.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9787729.0000; val_global_loss: 16055868.0000; val_optim_loss: 16055868.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8833; val_auprc_score: 0.8758; val_best_acc_score: 0.8019; val_best_f1_score: 0.8129; train_kl_reg_loss: 108271.0087; train_edge_recon_loss: 3530311.8611; train_gene_expr_recon_loss: 2135341.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9771605.6667; train_global_loss: 15545530.3333; train_optim_loss: 15545530.3333; val_kl_reg_loss: 84768.7812; val_edge_recon_loss: 4029333.2500; val_gene_expr_recon_loss: 2123316.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9789697.0000; val_global_loss: 16027116.0000; val_optim_loss: 16027116.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8823; val_auprc_score: 0.8738; val_best_acc_score: 0.8006; val_best_f1_score: 0.7951; train_kl_reg_loss: 105865.5816; train_edge_recon_loss: 3525851.8889; train_gene_expr_recon_loss: 2130316.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9737246.4444; train_global_loss: 15499280.3333; train_optim_loss: 15499280.3333; val_kl_reg_loss: 76299.7500; val_edge_recon_loss: 4007757.2500; val_gene_expr_recon_loss: 2116784.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9766600.0000; val_global_loss: 15967442.0000; val_optim_loss: 15967442.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8857; val_auprc_score: 0.8780; val_best_acc_score: 0.7792; val_best_f1_score: 0.7948; train_kl_reg_loss: 98714.0495; train_edge_recon_loss: 3522611.5278; train_gene_expr_recon_loss: 2116088.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9675322.3333; train_global_loss: 15412736.6667; train_optim_loss: 15412736.6667; val_kl_reg_loss: 89391.3281; val_edge_recon_loss: 3966148.7500; val_gene_expr_recon_loss: 2109175.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9761668.0000; val_global_loss: 15926384.0000; val_optim_loss: 15926384.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8879; val_auprc_score: 0.8749; val_best_acc_score: 0.8005; val_best_f1_score: 0.8188; train_kl_reg_loss: 92381.6467; train_edge_recon_loss: 3504574.9444; train_gene_expr_recon_loss: 2118826.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9741486.2222; train_global_loss: 15457269.5556; train_optim_loss: 15457269.5556; val_kl_reg_loss: 78618.4922; val_edge_recon_loss: 3883980.2500; val_gene_expr_recon_loss: 2105402.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9754556.0000; val_global_loss: 15822557.0000; val_optim_loss: 15822557.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8947; val_auprc_score: 0.8837; val_best_acc_score: 0.8087; val_best_f1_score: 0.8189; train_kl_reg_loss: 84255.2031; train_edge_recon_loss: 3474382.9722; train_gene_expr_recon_loss: 2108124.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9713941.4444; train_global_loss: 15380704.4444; train_optim_loss: 15380704.4444; val_kl_reg_loss: 65913.1641; val_edge_recon_loss: 3685836.0000; val_gene_expr_recon_loss: 2106923.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9746700.0000; val_global_loss: 15605373.0000; val_optim_loss: 15605373.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8853; val_auprc_score: 0.8748; val_best_acc_score: 0.7914; val_best_f1_score: 0.8100; train_kl_reg_loss: 67133.7756; train_edge_recon_loss: 3372954.1667; train_gene_expr_recon_loss: 2122576.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9729865.1111; train_global_loss: 15292529.4444; train_optim_loss: 15292529.4444; val_kl_reg_loss: 60872.5938; val_edge_recon_loss: 3343089.2500; val_gene_expr_recon_loss: 2120291.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9762280.0000; val_global_loss: 15286533.0000; val_optim_loss: 15286533.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8758; val_auprc_score: 0.8642; val_best_acc_score: 0.7785; val_best_f1_score: 0.8065; train_kl_reg_loss: 74618.2852; train_edge_recon_loss: 3160674.0000; train_gene_expr_recon_loss: 2137617.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9692690.5556; train_global_loss: 15065600.0000; train_optim_loss: 15065600.0000; val_kl_reg_loss: 96086.3984; val_edge_recon_loss: 3054998.2500; val_gene_expr_recon_loss: 2129301.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9769990.0000; val_global_loss: 15050376.0000; val_optim_loss: 15050376.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8787; val_auprc_score: 0.8580; val_best_acc_score: 0.7871; val_best_f1_score: 0.8107; train_kl_reg_loss: 121153.1076; train_edge_recon_loss: 2990779.7222; train_gene_expr_recon_loss: 2130949.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9674469.2222; train_global_loss: 14917351.7778; train_optim_loss: 14917351.7778; val_kl_reg_loss: 138036.0312; val_edge_recon_loss: 2977813.5000; val_gene_expr_recon_loss: 2113194.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9733485.0000; val_global_loss: 14962529.0000; val_optim_loss: 14962529.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8851; val_auprc_score: 0.8610; val_best_acc_score: 0.7998; val_best_f1_score: 0.8155; train_kl_reg_loss: 135217.6467; train_edge_recon_loss: 2961286.9167; train_gene_expr_recon_loss: 2125384.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9719165.6667; train_global_loss: 14941054.4444; train_optim_loss: 14941054.4444; val_kl_reg_loss: 116163.9531; val_edge_recon_loss: 2965313.7500; val_gene_expr_recon_loss: 2106003.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9725668.0000; val_global_loss: 14913149.0000; val_optim_loss: 14913149.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8846; val_auprc_score: 0.8592; val_best_acc_score: 0.8022; val_best_f1_score: 0.8204; train_kl_reg_loss: 115552.9991; train_edge_recon_loss: 2939207.0000; train_gene_expr_recon_loss: 2114646.0972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9692552.6667; train_global_loss: 14861958.7778; train_optim_loss: 14861958.7778; val_kl_reg_loss: 116564.9375; val_edge_recon_loss: 2938118.2500; val_gene_expr_recon_loss: 2100259.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9703154.0000; val_global_loss: 14858096.0000; val_optim_loss: 14858096.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8914; val_auprc_score: 0.8631; val_best_acc_score: 0.8123; val_best_f1_score: 0.8293; train_kl_reg_loss: 121343.1615; train_edge_recon_loss: 2911066.1389; train_gene_expr_recon_loss: 2107090.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9640412.4444; train_global_loss: 14779912.0000; train_optim_loss: 14779912.0000; val_kl_reg_loss: 117206.4531; val_edge_recon_loss: 2897781.2500; val_gene_expr_recon_loss: 2094526.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9691249.0000; val_global_loss: 14800764.0000; val_optim_loss: 14800764.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8961; val_auprc_score: 0.8703; val_best_acc_score: 0.8239; val_best_f1_score: 0.8385; train_kl_reg_loss: 116521.0347; train_edge_recon_loss: 2897479.2222; train_gene_expr_recon_loss: 2102305.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9591895.2222; train_global_loss: 14708200.8889; train_optim_loss: 14708200.8889; val_kl_reg_loss: 110103.7812; val_edge_recon_loss: 2891652.0000; val_gene_expr_recon_loss: 2094380.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9700115.0000; val_global_loss: 14796252.0000; val_optim_loss: 14796252.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9009; val_auprc_score: 0.8745; val_best_acc_score: 0.8281; val_best_f1_score: 0.8428; train_kl_reg_loss: 113908.7995; train_edge_recon_loss: 2881356.1944; train_gene_expr_recon_loss: 2107759.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9678535.7778; train_global_loss: 14781560.5556; train_optim_loss: 14781560.5556; val_kl_reg_loss: 111145.0625; val_edge_recon_loss: 2867924.0000; val_gene_expr_recon_loss: 2090623.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9680029.0000; val_global_loss: 14749722.0000; val_optim_loss: 14749722.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9023; val_auprc_score: 0.8791; val_best_acc_score: 0.8269; val_best_f1_score: 0.8424; train_kl_reg_loss: 115305.5625; train_edge_recon_loss: 2863694.8333; train_gene_expr_recon_loss: 2093830.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9633578.3333; train_global_loss: 14706409.0000; train_optim_loss: 14706409.0000; val_kl_reg_loss: 113405.1172; val_edge_recon_loss: 2898645.5000; val_gene_expr_recon_loss: 2088694.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9686438.0000; val_global_loss: 14787182.0000; val_optim_loss: 14787182.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9113; val_auprc_score: 0.8924; val_best_acc_score: 0.8336; val_best_f1_score: 0.8449; train_kl_reg_loss: 145617.8689; train_edge_recon_loss: 3056975.5556; train_gene_expr_recon_loss: 2126671.7361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9703627.7778; train_global_loss: 15032893.0000; train_optim_loss: 15032893.0000; val_kl_reg_loss: 44410.0781; val_edge_recon_loss: 2990651.5000; val_gene_expr_recon_loss: 2119591.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9725416.0000; val_global_loss: 14880069.0000; val_optim_loss: 14880069.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9224; val_auprc_score: 0.9045; val_best_acc_score: 0.8480; val_best_f1_score: 0.8555; train_kl_reg_loss: 179861.3438; train_edge_recon_loss: 2972329.4722; train_gene_expr_recon_loss: 2137216.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9686762.7778; train_global_loss: 14976169.8889; train_optim_loss: 14976169.8889; val_kl_reg_loss: 47189.4141; val_edge_recon_loss: 2931860.7500; val_gene_expr_recon_loss: 2118109.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9714415.0000; val_global_loss: 14811574.0000; val_optim_loss: 14811574.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9195; val_auprc_score: 0.9035; val_best_acc_score: 0.8451; val_best_f1_score: 0.8529; train_kl_reg_loss: 158159.4201; train_edge_recon_loss: 2943427.8611; train_gene_expr_recon_loss: 2116579.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9637591.3333; train_global_loss: 14855757.8889; train_optim_loss: 14855757.8889; val_kl_reg_loss: 48182.9688; val_edge_recon_loss: 2959533.0000; val_gene_expr_recon_loss: 2109966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9703478.0000; val_global_loss: 14821160.0000; val_optim_loss: 14821160.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9191; val_auprc_score: 0.8967; val_best_acc_score: 0.8476; val_best_f1_score: 0.8563; train_kl_reg_loss: 142603.9861; train_edge_recon_loss: 2916505.5556; train_gene_expr_recon_loss: 2119662.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9730834.0000; train_global_loss: 14909605.7778; train_optim_loss: 14909605.7778; val_kl_reg_loss: 48641.0508; val_edge_recon_loss: 2927804.5000; val_gene_expr_recon_loss: 2108547.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9693547.0000; val_global_loss: 14778540.0000; val_optim_loss: 14778540.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9263; val_auprc_score: 0.9105; val_best_acc_score: 0.8486; val_best_f1_score: 0.8578; train_kl_reg_loss: 140348.7101; train_edge_recon_loss: 2923532.4444; train_gene_expr_recon_loss: 2118244.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9663723.1111; train_global_loss: 14845849.2222; train_optim_loss: 14845849.2222; val_kl_reg_loss: 49175.0742; val_edge_recon_loss: 2906112.7500; val_gene_expr_recon_loss: 2109400.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9702203.0000; val_global_loss: 14766891.0000; val_optim_loss: 14766891.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9171; val_auprc_score: 0.9016; val_best_acc_score: 0.8436; val_best_f1_score: 0.8541; train_kl_reg_loss: 138354.8594; train_edge_recon_loss: 2912211.2222; train_gene_expr_recon_loss: 2109010.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9625795.2222; train_global_loss: 14785372.3333; train_optim_loss: 14785372.3333; val_kl_reg_loss: 49449.9180; val_edge_recon_loss: 2948001.5000; val_gene_expr_recon_loss: 2107092.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9688568.0000; val_global_loss: 14793112.0000; val_optim_loss: 14793112.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9257; val_auprc_score: 0.9096; val_best_acc_score: 0.8502; val_best_f1_score: 0.8587; train_kl_reg_loss: 138077.1163; train_edge_recon_loss: 2915872.3333; train_gene_expr_recon_loss: 2110116.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9645659.6667; train_global_loss: 14809726.2222; train_optim_loss: 14809726.2222; val_kl_reg_loss: 48607.7305; val_edge_recon_loss: 2926968.2500; val_gene_expr_recon_loss: 2105945.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9688460.0000; val_global_loss: 14769981.0000; val_optim_loss: 14769981.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 41 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9173
Val AUPRC score: 0.8978
Val best accuracy score: 0.8401
Val best F1 score: 0.8523
Val gene expr MSE score: 0.5218
Val chrom access MSE score: 0.0869
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
