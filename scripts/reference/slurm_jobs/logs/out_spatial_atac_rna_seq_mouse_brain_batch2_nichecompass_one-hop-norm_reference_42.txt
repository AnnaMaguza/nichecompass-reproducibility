[True]
Run timestamp: 26072023_014913_42.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_42']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8933; val_auprc_score: 0.9002; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8550.0362; train_edge_recon_loss: 352846.9688; train_gene_expr_recon_loss: 32495729.3333; train_masked_gp_l1_reg_loss: 1929.1705; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1090571.7500; train_global_loss: 33949626.8889; train_optim_loss: 33949626.8889; val_kl_reg_loss: 16818.3594; val_edge_recon_loss: 406585.3125; val_gene_expr_recon_loss: 30064726.0000; val_masked_gp_l1_reg_loss: 2007.7648; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061129.0000; val_global_loss: 31551268.0000; val_optim_loss: 31551268.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8758; val_auprc_score: 0.8827; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 38609.2114; train_edge_recon_loss: 374991.8785; train_gene_expr_recon_loss: 29246778.0000; train_masked_gp_l1_reg_loss: 2120.8870; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1068326.9167; train_global_loss: 30730826.6667; train_optim_loss: 30730826.6667; val_kl_reg_loss: 54758.7500; val_edge_recon_loss: 406602.5000; val_gene_expr_recon_loss: 26782150.0000; val_masked_gp_l1_reg_loss: 2274.9514; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1035200.1250; val_global_loss: 28280986.0000; val_optim_loss: 28280986.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8666; val_auprc_score: 0.8685; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 69005.9931; train_edge_recon_loss: 391174.2396; train_gene_expr_recon_loss: 26208175.5556; train_masked_gp_l1_reg_loss: 2392.7023; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1032873.8264; train_global_loss: 27703621.7778; train_optim_loss: 27703621.7778; val_kl_reg_loss: 86126.9844; val_edge_recon_loss: 406601.8125; val_gene_expr_recon_loss: 24423722.0000; val_masked_gp_l1_reg_loss: 2522.7551; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015973.3750; val_global_loss: 25934946.0000; val_optim_loss: 25934946.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8712; val_auprc_score: 0.8714; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 105720.0469; train_edge_recon_loss: 399954.2639; train_gene_expr_recon_loss: 24323334.4444; train_masked_gp_l1_reg_loss: 2587.6026; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1020005.0833; train_global_loss: 25851601.5556; train_optim_loss: 25851601.5556; val_kl_reg_loss: 111599.6250; val_edge_recon_loss: 406600.9375; val_gene_expr_recon_loss: 23174598.0000; val_masked_gp_l1_reg_loss: 2647.8252; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 999946.3125; val_global_loss: 24695392.0000; val_optim_loss: 24695392.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8725; val_auprc_score: 0.8715; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 122426.5234; train_edge_recon_loss: 403265.7361; train_gene_expr_recon_loss: 23157258.0000; train_masked_gp_l1_reg_loss: 2670.8232; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007133.7569; train_global_loss: 24692754.8889; train_optim_loss: 24692754.8889; val_kl_reg_loss: 131948.4688; val_edge_recon_loss: 406589.3750; val_gene_expr_recon_loss: 22330428.0000; val_masked_gp_l1_reg_loss: 2687.7832; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 990866.3125; val_global_loss: 23862520.0000; val_optim_loss: 23862520.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8763; val_auprc_score: 0.8691; val_best_acc_score: 0.5040; val_best_f1_score: 0.6685; train_kl_reg_loss: 142732.8003; train_edge_recon_loss: 404569.6285; train_gene_expr_recon_loss: 22475945.7778; train_masked_gp_l1_reg_loss: 2691.0231; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 997267.3889; train_global_loss: 24023206.6667; train_optim_loss: 24023206.6667; val_kl_reg_loss: 136602.4375; val_edge_recon_loss: 406555.0625; val_gene_expr_recon_loss: 21730350.0000; val_masked_gp_l1_reg_loss: 2690.6294; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982663.6250; val_global_loss: 23258862.0000; val_optim_loss: 23258862.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8796; val_auprc_score: 0.8703; val_best_acc_score: 0.5082; val_best_f1_score: 0.6703; train_kl_reg_loss: 141512.1823; train_edge_recon_loss: 404816.7222; train_gene_expr_recon_loss: 21936990.2222; train_masked_gp_l1_reg_loss: 2687.8171; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987115.3542; train_global_loss: 23473122.2222; train_optim_loss: 23473122.2222; val_kl_reg_loss: 142656.4844; val_edge_recon_loss: 406511.9375; val_gene_expr_recon_loss: 21344890.0000; val_masked_gp_l1_reg_loss: 2684.6262; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976921.0625; val_global_loss: 22873664.0000; val_optim_loss: 22873664.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8868; val_auprc_score: 0.8767; val_best_acc_score: 0.5221; val_best_f1_score: 0.6763; train_kl_reg_loss: 147166.2153; train_edge_recon_loss: 404851.6111; train_gene_expr_recon_loss: 21580377.3333; train_masked_gp_l1_reg_loss: 2681.6441; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988157.1597; train_global_loss: 23123233.7778; train_optim_loss: 23123233.7778; val_kl_reg_loss: 139007.7500; val_edge_recon_loss: 406405.3750; val_gene_expr_recon_loss: 21123470.0000; val_masked_gp_l1_reg_loss: 2677.9043; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975537.6875; val_global_loss: 22647100.0000; val_optim_loss: 22647100.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8907; val_auprc_score: 0.8750; val_best_acc_score: 0.5525; val_best_f1_score: 0.6904; train_kl_reg_loss: 144120.1979; train_edge_recon_loss: 404710.4444; train_gene_expr_recon_loss: 21470053.1111; train_masked_gp_l1_reg_loss: 2675.4279; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985211.2917; train_global_loss: 23006770.8889; train_optim_loss: 23006770.8889; val_kl_reg_loss: 134705.0625; val_edge_recon_loss: 406233.8438; val_gene_expr_recon_loss: 20987232.0000; val_masked_gp_l1_reg_loss: 2672.4312; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974276.3750; val_global_loss: 22505118.0000; val_optim_loss: 22505118.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8935; val_auprc_score: 0.8797; val_best_acc_score: 0.5971; val_best_f1_score: 0.7118; train_kl_reg_loss: 136527.8698; train_edge_recon_loss: 404230.1597; train_gene_expr_recon_loss: 21254776.2222; train_masked_gp_l1_reg_loss: 2672.4988; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981485.0069; train_global_loss: 22779691.3333; train_optim_loss: 22779691.3333; val_kl_reg_loss: 133976.7969; val_edge_recon_loss: 406003.2188; val_gene_expr_recon_loss: 20881632.0000; val_masked_gp_l1_reg_loss: 2673.2615; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971410.8125; val_global_loss: 22395696.0000; val_optim_loss: 22395696.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8984; val_auprc_score: 0.8882; val_best_acc_score: 0.6562; val_best_f1_score: 0.7420; train_kl_reg_loss: 133559.1068; train_edge_recon_loss: 403909.0486; train_gene_expr_recon_loss: 21231804.6667; train_masked_gp_l1_reg_loss: 2676.1489; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982050.7292; train_global_loss: 22753999.7778; train_optim_loss: 22753999.7778; val_kl_reg_loss: 129238.9062; val_edge_recon_loss: 405610.1875; val_gene_expr_recon_loss: 20801198.0000; val_masked_gp_l1_reg_loss: 2680.8142; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970476.1250; val_global_loss: 22309204.0000; val_optim_loss: 22309204.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9033; val_auprc_score: 0.8956; val_best_acc_score: 0.6987; val_best_f1_score: 0.7647; train_kl_reg_loss: 131496.2717; train_edge_recon_loss: 403437.4722; train_gene_expr_recon_loss: 21176777.3333; train_masked_gp_l1_reg_loss: 2684.5619; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977460.2014; train_global_loss: 22691855.5556; train_optim_loss: 22691855.5556; val_kl_reg_loss: 125001.1641; val_edge_recon_loss: 405168.5000; val_gene_expr_recon_loss: 20718982.0000; val_masked_gp_l1_reg_loss: 2688.5503; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967833.5625; val_global_loss: 22219674.0000; val_optim_loss: 22219674.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9025; val_auprc_score: 0.8903; val_best_acc_score: 0.7355; val_best_f1_score: 0.7852; train_kl_reg_loss: 127768.2891; train_edge_recon_loss: 402752.5972; train_gene_expr_recon_loss: 21102421.1111; train_masked_gp_l1_reg_loss: 2693.1828; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978872.9375; train_global_loss: 22614508.2222; train_optim_loss: 22614508.2222; val_kl_reg_loss: 123259.7188; val_edge_recon_loss: 404639.4375; val_gene_expr_recon_loss: 20699574.0000; val_masked_gp_l1_reg_loss: 2698.2070; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968945.3125; val_global_loss: 22199118.0000; val_optim_loss: 22199118.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9010; val_auprc_score: 0.8881; val_best_acc_score: 0.7650; val_best_f1_score: 0.8028; train_kl_reg_loss: 124148.0738; train_edge_recon_loss: 401945.6562; train_gene_expr_recon_loss: 21006812.2222; train_masked_gp_l1_reg_loss: 2702.7883; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975943.6111; train_global_loss: 22511552.6667; train_optim_loss: 22511552.6667; val_kl_reg_loss: 119811.0781; val_edge_recon_loss: 404074.0312; val_gene_expr_recon_loss: 20629266.0000; val_masked_gp_l1_reg_loss: 2708.8938; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966076.1875; val_global_loss: 22121936.0000; val_optim_loss: 22121936.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9023; val_auprc_score: 0.8826; val_best_acc_score: 0.7844; val_best_f1_score: 0.8137; train_kl_reg_loss: 122180.6580; train_edge_recon_loss: 401612.0243; train_gene_expr_recon_loss: 20881486.2222; train_masked_gp_l1_reg_loss: 2715.1994; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967272.1181; train_global_loss: 22375265.7778; train_optim_loss: 22375265.7778; val_kl_reg_loss: 117430.4922; val_edge_recon_loss: 403726.5938; val_gene_expr_recon_loss: 20577756.0000; val_masked_gp_l1_reg_loss: 2722.0520; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964482.0625; val_global_loss: 22066118.0000; val_optim_loss: 22066118.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9095; val_auprc_score: 0.8980; val_best_acc_score: 0.8141; val_best_f1_score: 0.8331; train_kl_reg_loss: 120266.0703; train_edge_recon_loss: 400796.5486; train_gene_expr_recon_loss: 20926806.8889; train_masked_gp_l1_reg_loss: 2727.4856; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972867.3194; train_global_loss: 22423464.0000; train_optim_loss: 22423464.0000; val_kl_reg_loss: 110982.7656; val_edge_recon_loss: 403099.3750; val_gene_expr_recon_loss: 20523728.0000; val_masked_gp_l1_reg_loss: 2733.9294; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964066.6875; val_global_loss: 22004610.0000; val_optim_loss: 22004610.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9186; val_auprc_score: 0.9085; val_best_acc_score: 0.8456; val_best_f1_score: 0.8556; train_kl_reg_loss: 116164.1380; train_edge_recon_loss: 399937.6771; train_gene_expr_recon_loss: 20923429.7778; train_masked_gp_l1_reg_loss: 2739.8676; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971668.8264; train_global_loss: 22413940.0000; train_optim_loss: 22413940.0000; val_kl_reg_loss: 109890.8750; val_edge_recon_loss: 402437.9375; val_gene_expr_recon_loss: 20506854.0000; val_masked_gp_l1_reg_loss: 2746.7136; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963067.2500; val_global_loss: 21984996.0000; val_optim_loss: 21984996.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9151; val_auprc_score: 0.9060; val_best_acc_score: 0.8460; val_best_f1_score: 0.8543; train_kl_reg_loss: 115422.3047; train_edge_recon_loss: 399185.2847; train_gene_expr_recon_loss: 20858819.1111; train_masked_gp_l1_reg_loss: 2753.3097; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976031.9792; train_global_loss: 22352211.7778; train_optim_loss: 22352211.7778; val_kl_reg_loss: 107856.3828; val_edge_recon_loss: 401921.8438; val_gene_expr_recon_loss: 20469274.0000; val_masked_gp_l1_reg_loss: 2759.6343; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962032.1250; val_global_loss: 21943844.0000; val_optim_loss: 21943844.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9248; val_auprc_score: 0.9125; val_best_acc_score: 0.8583; val_best_f1_score: 0.8620; train_kl_reg_loss: 112323.1710; train_edge_recon_loss: 398717.1354; train_gene_expr_recon_loss: 20822394.4444; train_masked_gp_l1_reg_loss: 2764.7354; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978108.4583; train_global_loss: 22314308.0000; train_optim_loss: 22314308.0000; val_kl_reg_loss: 104356.0781; val_edge_recon_loss: 400996.1875; val_gene_expr_recon_loss: 20451254.0000; val_masked_gp_l1_reg_loss: 2770.6836; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963079.3125; val_global_loss: 21922456.0000; val_optim_loss: 21922456.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9254; val_auprc_score: 0.9175; val_best_acc_score: 0.8552; val_best_f1_score: 0.8571; train_kl_reg_loss: 109994.1363; train_edge_recon_loss: 397608.9132; train_gene_expr_recon_loss: 20706108.2222; train_masked_gp_l1_reg_loss: 2776.6091; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965227.0972; train_global_loss: 22181714.8889; train_optim_loss: 22181714.8889; val_kl_reg_loss: 102250.0938; val_edge_recon_loss: 400236.3750; val_gene_expr_recon_loss: 20411434.0000; val_masked_gp_l1_reg_loss: 2783.9866; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 960305.8125; val_global_loss: 21877010.0000; val_optim_loss: 21877010.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9287; val_auprc_score: 0.9205; val_best_acc_score: 0.8546; val_best_f1_score: 0.8542; train_kl_reg_loss: 108418.9635; train_edge_recon_loss: 396538.4306; train_gene_expr_recon_loss: 20588892.2222; train_masked_gp_l1_reg_loss: 2790.6766; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963902.9444; train_global_loss: 22060543.5556; train_optim_loss: 22060543.5556; val_kl_reg_loss: 101486.4609; val_edge_recon_loss: 399611.5312; val_gene_expr_recon_loss: 20374808.0000; val_masked_gp_l1_reg_loss: 2798.1377; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 958705.8125; val_global_loss: 21837410.0000; val_optim_loss: 21837410.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9279; val_auprc_score: 0.9142; val_best_acc_score: 0.8504; val_best_f1_score: 0.8473; train_kl_reg_loss: 107034.0668; train_edge_recon_loss: 395685.7014; train_gene_expr_recon_loss: 20797655.7778; train_masked_gp_l1_reg_loss: 2805.5192; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967881.2639; train_global_loss: 22271062.6667; train_optim_loss: 22271062.6667; val_kl_reg_loss: 97815.2031; val_edge_recon_loss: 398723.8750; val_gene_expr_recon_loss: 20345296.0000; val_masked_gp_l1_reg_loss: 2814.2021; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 958119.7500; val_global_loss: 21802770.0000; val_optim_loss: 21802770.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9300; val_auprc_score: 0.9185; val_best_acc_score: 0.8473; val_best_f1_score: 0.8412; train_kl_reg_loss: 105436.0790; train_edge_recon_loss: 394604.4271; train_gene_expr_recon_loss: 20796806.4444; train_masked_gp_l1_reg_loss: 2820.8520; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965830.4931; train_global_loss: 22265498.2222; train_optim_loss: 22265498.2222; val_kl_reg_loss: 93741.6719; val_edge_recon_loss: 397916.7500; val_gene_expr_recon_loss: 20351848.0000; val_masked_gp_l1_reg_loss: 2828.5034; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 957108.5625; val_global_loss: 21803442.0000; val_optim_loss: 21803442.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9303; val_auprc_score: 0.9157; val_best_acc_score: 0.8434; val_best_f1_score: 0.8354; train_kl_reg_loss: 103246.6545; train_edge_recon_loss: 394414.7882; train_gene_expr_recon_loss: 20753316.8889; train_masked_gp_l1_reg_loss: 2835.1119; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963065.9167; train_global_loss: 22216879.5556; train_optim_loss: 22216879.5556; val_kl_reg_loss: 93482.6094; val_edge_recon_loss: 396959.8750; val_gene_expr_recon_loss: 20322526.0000; val_masked_gp_l1_reg_loss: 2841.8623; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956852.4375; val_global_loss: 21772662.0000; val_optim_loss: 21772662.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9393; val_auprc_score: 0.9318; val_best_acc_score: 0.8459; val_best_f1_score: 0.8380; train_kl_reg_loss: 102169.1111; train_edge_recon_loss: 393175.7118; train_gene_expr_recon_loss: 20540982.2222; train_masked_gp_l1_reg_loss: 2848.4472; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961121.3819; train_global_loss: 22000296.4444; train_optim_loss: 22000296.4444; val_kl_reg_loss: 93711.8750; val_edge_recon_loss: 396230.7500; val_gene_expr_recon_loss: 20302756.0000; val_masked_gp_l1_reg_loss: 2856.1323; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956254.6250; val_global_loss: 21751808.0000; val_optim_loss: 21751808.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9360; val_auprc_score: 0.9273; val_best_acc_score: 0.8425; val_best_f1_score: 0.8375; train_kl_reg_loss: 102430.3872; train_edge_recon_loss: 394407.5035; train_gene_expr_recon_loss: 20840994.2222; train_masked_gp_l1_reg_loss: 2863.4799; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962899.1597; train_global_loss: 22303594.6667; train_optim_loss: 22303594.6667; val_kl_reg_loss: 87653.3984; val_edge_recon_loss: 396342.3438; val_gene_expr_recon_loss: 20487540.0000; val_masked_gp_l1_reg_loss: 2871.1121; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956711.0000; val_global_loss: 21931120.0000; val_optim_loss: 21931120.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9328; val_auprc_score: 0.9204; val_best_acc_score: 0.8356; val_best_f1_score: 0.8369; train_kl_reg_loss: 99234.0720; train_edge_recon_loss: 392567.5174; train_gene_expr_recon_loss: 20735583.3333; train_masked_gp_l1_reg_loss: 2879.0492; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959585.6736; train_global_loss: 22189849.5556; train_optim_loss: 22189849.5556; val_kl_reg_loss: 85864.3125; val_edge_recon_loss: 395625.4062; val_gene_expr_recon_loss: 20453098.0000; val_masked_gp_l1_reg_loss: 2889.8022; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 957094.1875; val_global_loss: 21894572.0000; val_optim_loss: 21894572.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9365; val_auprc_score: 0.9274; val_best_acc_score: 0.8320; val_best_f1_score: 0.8448; train_kl_reg_loss: 96459.8142; train_edge_recon_loss: 392386.8715; train_gene_expr_recon_loss: 20694077.7778; train_masked_gp_l1_reg_loss: 2898.4603; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963110.6181; train_global_loss: 22148933.3333; train_optim_loss: 22148933.3333; val_kl_reg_loss: 85912.8516; val_edge_recon_loss: 394680.1250; val_gene_expr_recon_loss: 20446692.0000; val_masked_gp_l1_reg_loss: 2907.9053; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954069.1875; val_global_loss: 21884262.0000; val_optim_loss: 21884262.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9386; val_auprc_score: 0.9286; val_best_acc_score: 0.8267; val_best_f1_score: 0.8488; train_kl_reg_loss: 98708.8724; train_edge_recon_loss: 390851.2778; train_gene_expr_recon_loss: 20802209.5556; train_masked_gp_l1_reg_loss: 2914.7807; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963054.6181; train_global_loss: 22257739.5556; train_optim_loss: 22257739.5556; val_kl_reg_loss: 84825.8438; val_edge_recon_loss: 393644.5938; val_gene_expr_recon_loss: 20450752.0000; val_masked_gp_l1_reg_loss: 2920.8240; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954969.8125; val_global_loss: 21887112.0000; val_optim_loss: 21887112.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9385; val_auprc_score: 0.9297; val_best_acc_score: 0.8265; val_best_f1_score: 0.8464; train_kl_reg_loss: 92951.1615; train_edge_recon_loss: 391372.8125; train_gene_expr_recon_loss: 20744008.8889; train_masked_gp_l1_reg_loss: 2921.2909; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963807.4722; train_global_loss: 22195061.7778; train_optim_loss: 22195061.7778; val_kl_reg_loss: 88010.2969; val_edge_recon_loss: 394081.9062; val_gene_expr_recon_loss: 20403184.0000; val_masked_gp_l1_reg_loss: 2921.9983; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953410.6875; val_global_loss: 21841608.0000; val_optim_loss: 21841608.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9392; val_auprc_score: 0.9304; val_best_acc_score: 0.8298; val_best_f1_score: 0.8450; train_kl_reg_loss: 97889.3030; train_edge_recon_loss: 391281.4028; train_gene_expr_recon_loss: 20730712.8889; train_masked_gp_l1_reg_loss: 2922.4734; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959053.0625; train_global_loss: 22181859.1111; train_optim_loss: 22181859.1111; val_kl_reg_loss: 90790.0625; val_edge_recon_loss: 394264.7188; val_gene_expr_recon_loss: 20381690.0000; val_masked_gp_l1_reg_loss: 2922.9761; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 952406.3125; val_global_loss: 21822072.0000; val_optim_loss: 21822072.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9381; val_auprc_score: 0.9260; val_best_acc_score: 0.8300; val_best_f1_score: 0.8514; train_kl_reg_loss: 98394.0651; train_edge_recon_loss: 390792.7847; train_gene_expr_recon_loss: 20729876.0000; train_masked_gp_l1_reg_loss: 2923.2228; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965345.3194; train_global_loss: 22187331.3333; train_optim_loss: 22187331.3333; val_kl_reg_loss: 89112.4688; val_edge_recon_loss: 393936.5625; val_gene_expr_recon_loss: 20411520.0000; val_masked_gp_l1_reg_loss: 2923.5403; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954410.8125; val_global_loss: 21851904.0000; val_optim_loss: 21851904.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9391; val_auprc_score: 0.9317; val_best_acc_score: 0.8286; val_best_f1_score: 0.8503; train_kl_reg_loss: 96246.8637; train_edge_recon_loss: 390296.6076; train_gene_expr_recon_loss: 20737599.5556; train_masked_gp_l1_reg_loss: 2923.8876; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961076.2153; train_global_loss: 22188143.5556; train_optim_loss: 22188143.5556; val_kl_reg_loss: 88055.1406; val_edge_recon_loss: 393556.8125; val_gene_expr_recon_loss: 20365328.0000; val_masked_gp_l1_reg_loss: 2924.3738; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 952306.5625; val_global_loss: 21802170.0000; val_optim_loss: 21802170.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 39 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9322
Val AUPRC score: 0.9235
Val best accuracy score: 0.8447
Val best F1 score: 0.8369
Val gene expr MSE score: 0.4692
Val chrom access MSE score: 0.0854
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
