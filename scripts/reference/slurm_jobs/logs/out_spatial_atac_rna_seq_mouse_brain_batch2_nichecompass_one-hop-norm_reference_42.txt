[True]
Run timestamp: 09102023_212418_42.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_42']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7759; val_auprc_score: 0.7905; val_best_acc_score: 0.5618; val_best_f1_score: 0.6925; train_kl_reg_loss: 62590.2720; train_edge_recon_loss: 3508180.4637; train_gene_expr_recon_loss: 13409462.5878; train_masked_gp_l1_reg_loss: 108613.7403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2856170.6291; train_chrom_access_recon_loss: 955957.7948; train_global_loss: 20900975.5725; train_optim_loss: 20900975.5725; val_kl_reg_loss: 72430.7229; val_edge_recon_loss: 4061764.3167; val_gene_expr_recon_loss: 12654949.2667; val_masked_gp_l1_reg_loss: 96733.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 459931.3438; val_chrom_access_recon_loss: 932104.8208; val_global_loss: 18277914.4000; val_optim_loss: 18277914.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7742; val_auprc_score: 0.7857; val_best_acc_score: 0.6835; val_best_f1_score: 0.7240; train_kl_reg_loss: 77096.5339; train_edge_recon_loss: 3490127.7538; train_gene_expr_recon_loss: 12586475.4580; train_masked_gp_l1_reg_loss: 98604.6274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240686.9359; train_chrom_access_recon_loss: 919280.6283; train_global_loss: 17412271.8855; train_optim_loss: 17412271.8855; val_kl_reg_loss: 53289.5232; val_edge_recon_loss: 3631330.8000; val_gene_expr_recon_loss: 12474987.0000; val_masked_gp_l1_reg_loss: 102591.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147545.4844; val_chrom_access_recon_loss: 922296.1792; val_global_loss: 17332041.0000; val_optim_loss: 17332041.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8193; val_auprc_score: 0.8149; val_best_acc_score: 0.7284; val_best_f1_score: 0.7637; train_kl_reg_loss: 85013.4298; train_edge_recon_loss: 3135986.4427; train_gene_expr_recon_loss: 12454723.9542; train_masked_gp_l1_reg_loss: 106314.5488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121857.1613; train_chrom_access_recon_loss: 908793.9318; train_global_loss: 16812689.4198; train_optim_loss: 16812689.4198; val_kl_reg_loss: 96675.0844; val_edge_recon_loss: 3106979.3500; val_gene_expr_recon_loss: 12379607.0667; val_masked_gp_l1_reg_loss: 109555.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104589.6328; val_chrom_access_recon_loss: 910514.8708; val_global_loss: 16707922.1333; val_optim_loss: 16707922.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8441; val_auprc_score: 0.8497; val_best_acc_score: 0.7443; val_best_f1_score: 0.7651; train_kl_reg_loss: 95325.0514; train_edge_recon_loss: 3038227.8473; train_gene_expr_recon_loss: 12343475.3511; train_masked_gp_l1_reg_loss: 110830.9782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93587.9661; train_chrom_access_recon_loss: 900178.8101; train_global_loss: 16581625.9389; train_optim_loss: 16581625.9389; val_kl_reg_loss: 96440.0474; val_edge_recon_loss: 3057789.4333; val_gene_expr_recon_loss: 12237072.0000; val_masked_gp_l1_reg_loss: 112432.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86035.2969; val_chrom_access_recon_loss: 903348.1375; val_global_loss: 16493116.8000; val_optim_loss: 16493116.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9143; val_auprc_score: 0.9003; val_best_acc_score: 0.8421; val_best_f1_score: 0.8503; train_kl_reg_loss: 86361.5215; train_edge_recon_loss: 2971209.9981; train_gene_expr_recon_loss: 12205864.2901; train_masked_gp_l1_reg_loss: 114786.5539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84802.4528; train_chrom_access_recon_loss: 891999.7467; train_global_loss: 16355024.5420; train_optim_loss: 16355024.5420; val_kl_reg_loss: 90577.6292; val_edge_recon_loss: 2868308.6833; val_gene_expr_recon_loss: 12196389.4667; val_masked_gp_l1_reg_loss: 119317.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85652.4688; val_chrom_access_recon_loss: 896601.4250; val_global_loss: 16256847.0000; val_optim_loss: 16256847.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9302; val_auprc_score: 0.9142; val_best_acc_score: 0.8654; val_best_f1_score: 0.8739; train_kl_reg_loss: 93024.1144; train_edge_recon_loss: 2825864.2710; train_gene_expr_recon_loss: 12100280.5802; train_masked_gp_l1_reg_loss: 123586.0951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87581.9060; train_chrom_access_recon_loss: 886717.0014; train_global_loss: 16117053.9160; train_optim_loss: 16117053.9160; val_kl_reg_loss: 94589.8073; val_edge_recon_loss: 2791903.8667; val_gene_expr_recon_loss: 12029240.8667; val_masked_gp_l1_reg_loss: 124635.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87744.5391; val_chrom_access_recon_loss: 887577.7958; val_global_loss: 16015692.2667; val_optim_loss: 16015692.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9284; val_auprc_score: 0.9135; val_best_acc_score: 0.8658; val_best_f1_score: 0.8728; train_kl_reg_loss: 95791.0590; train_edge_recon_loss: 2797623.0191; train_gene_expr_recon_loss: 12002309.4885; train_masked_gp_l1_reg_loss: 124555.3938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87681.5123; train_chrom_access_recon_loss: 879366.1698; train_global_loss: 15987326.6260; train_optim_loss: 15987326.6260; val_kl_reg_loss: 95005.7193; val_edge_recon_loss: 2786248.8667; val_gene_expr_recon_loss: 11943737.4667; val_masked_gp_l1_reg_loss: 124459.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86286.3516; val_chrom_access_recon_loss: 886119.8083; val_global_loss: 15921857.6667; val_optim_loss: 15921857.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9342; val_auprc_score: 0.9187; val_best_acc_score: 0.8698; val_best_f1_score: 0.8762; train_kl_reg_loss: 91605.0103; train_edge_recon_loss: 2792809.9695; train_gene_expr_recon_loss: 11922708.7557; train_masked_gp_l1_reg_loss: 124405.9931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85060.3343; train_chrom_access_recon_loss: 873924.5701; train_global_loss: 15890514.5267; train_optim_loss: 15890514.5267; val_kl_reg_loss: 89224.2995; val_edge_recon_loss: 2794840.1833; val_gene_expr_recon_loss: 11898552.6667; val_masked_gp_l1_reg_loss: 124918.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83778.3281; val_chrom_access_recon_loss: 879765.7833; val_global_loss: 15871079.0000; val_optim_loss: 15871079.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9385; val_auprc_score: 0.9264; val_best_acc_score: 0.8762; val_best_f1_score: 0.8823; train_kl_reg_loss: 90220.8677; train_edge_recon_loss: 2784930.3053; train_gene_expr_recon_loss: 11852780.4275; train_masked_gp_l1_reg_loss: 125153.0200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81880.6764; train_chrom_access_recon_loss: 869193.6789; train_global_loss: 15804158.9466; train_optim_loss: 15804158.9466; val_kl_reg_loss: 92433.3083; val_edge_recon_loss: 2778543.4667; val_gene_expr_recon_loss: 11761562.6667; val_masked_gp_l1_reg_loss: 125576.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80490.3984; val_chrom_access_recon_loss: 869957.3500; val_global_loss: 15708563.9333; val_optim_loss: 15708563.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9362; val_auprc_score: 0.9191; val_best_acc_score: 0.8746; val_best_f1_score: 0.8811; train_kl_reg_loss: 89720.5540; train_edge_recon_loss: 2766841.8569; train_gene_expr_recon_loss: 11800836.0840; train_masked_gp_l1_reg_loss: 126029.9258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79580.1425; train_chrom_access_recon_loss: 865513.2304; train_global_loss: 15728521.7634; train_optim_loss: 15728521.7634; val_kl_reg_loss: 87533.9385; val_edge_recon_loss: 2788422.8333; val_gene_expr_recon_loss: 11738047.8000; val_masked_gp_l1_reg_loss: 126888.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79663.0547; val_chrom_access_recon_loss: 868737.7625; val_global_loss: 15689293.4000; val_optim_loss: 15689293.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9380; val_auprc_score: 0.9224; val_best_acc_score: 0.8771; val_best_f1_score: 0.8823; train_kl_reg_loss: 88749.5340; train_edge_recon_loss: 2767615.8893; train_gene_expr_recon_loss: 11751443.4198; train_masked_gp_l1_reg_loss: 126658.2408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78403.4614; train_chrom_access_recon_loss: 860786.5410; train_global_loss: 15673657.0763; train_optim_loss: 15673657.0763; val_kl_reg_loss: 87922.8260; val_edge_recon_loss: 2780459.2833; val_gene_expr_recon_loss: 11663187.0000; val_masked_gp_l1_reg_loss: 126940.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77952.4766; val_chrom_access_recon_loss: 860925.2333; val_global_loss: 15597386.4667; val_optim_loss: 15597386.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9435; val_auprc_score: 0.9307; val_best_acc_score: 0.8809; val_best_f1_score: 0.8871; train_kl_reg_loss: 86805.4272; train_edge_recon_loss: 2754077.2424; train_gene_expr_recon_loss: 11699885.7023; train_masked_gp_l1_reg_loss: 127094.2978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77556.6689; train_chrom_access_recon_loss: 857294.8593; train_global_loss: 15602714.2443; train_optim_loss: 15602714.2443; val_kl_reg_loss: 90183.6359; val_edge_recon_loss: 2740791.3167; val_gene_expr_recon_loss: 11654311.8000; val_masked_gp_l1_reg_loss: 128380.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78962.4062; val_chrom_access_recon_loss: 859464.7583; val_global_loss: 15552094.6667; val_optim_loss: 15552094.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9444; val_auprc_score: 0.9287; val_best_acc_score: 0.8845; val_best_f1_score: 0.8893; train_kl_reg_loss: 87411.1963; train_edge_recon_loss: 2749877.3893; train_gene_expr_recon_loss: 11658051.3817; train_masked_gp_l1_reg_loss: 127922.3426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77788.5028; train_chrom_access_recon_loss: 854488.0038; train_global_loss: 15555538.9008; train_optim_loss: 15555538.9008; val_kl_reg_loss: 85849.0604; val_edge_recon_loss: 2763640.5167; val_gene_expr_recon_loss: 11565110.9333; val_masked_gp_l1_reg_loss: 127837.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78216.4297; val_chrom_access_recon_loss: 854657.5958; val_global_loss: 15475312.1333; val_optim_loss: 15475312.1333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9472; val_auprc_score: 0.9353; val_best_acc_score: 0.8871; val_best_f1_score: 0.8914; train_kl_reg_loss: 87323.8307; train_edge_recon_loss: 2746101.7366; train_gene_expr_recon_loss: 11609319.9847; train_masked_gp_l1_reg_loss: 127597.2617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78865.9636; train_chrom_access_recon_loss: 850839.6784; train_global_loss: 15500048.4580; train_optim_loss: 15500048.4580; val_kl_reg_loss: 84819.3255; val_edge_recon_loss: 2761858.7167; val_gene_expr_recon_loss: 11555790.0000; val_masked_gp_l1_reg_loss: 127857.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80245.7578; val_chrom_access_recon_loss: 855289.3875; val_global_loss: 15465861.4667; val_optim_loss: 15465861.4667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9476; val_auprc_score: 0.9328; val_best_acc_score: 0.8866; val_best_f1_score: 0.8929; train_kl_reg_loss: 85496.6752; train_edge_recon_loss: 2730476.5076; train_gene_expr_recon_loss: 11576863.9008; train_masked_gp_l1_reg_loss: 128033.1653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79666.1755; train_chrom_access_recon_loss: 848019.3502; train_global_loss: 15448555.7023; train_optim_loss: 15448555.7023; val_kl_reg_loss: 84753.4964; val_edge_recon_loss: 2763884.4833; val_gene_expr_recon_loss: 11455452.2667; val_masked_gp_l1_reg_loss: 128358.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80407.6953; val_chrom_access_recon_loss: 849995.7708; val_global_loss: 15362852.0000; val_optim_loss: 15362852.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9515; val_auprc_score: 0.9394; val_best_acc_score: 0.8878; val_best_f1_score: 0.8949; train_kl_reg_loss: 84891.1674; train_edge_recon_loss: 2727002.1679; train_gene_expr_recon_loss: 11544211.9466; train_masked_gp_l1_reg_loss: 128390.1738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79808.8466; train_chrom_access_recon_loss: 846840.4976; train_global_loss: 15411144.7939; train_optim_loss: 15411144.7939; val_kl_reg_loss: 84905.2776; val_edge_recon_loss: 2748243.9333; val_gene_expr_recon_loss: 11507959.6667; val_masked_gp_l1_reg_loss: 128210.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79512.1875; val_chrom_access_recon_loss: 853371.6042; val_global_loss: 15402203.6000; val_optim_loss: 15402203.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9570; val_auprc_score: 0.9471; val_best_acc_score: 0.9014; val_best_f1_score: 0.9050; train_kl_reg_loss: 84825.2297; train_edge_recon_loss: 2724347.6584; train_gene_expr_recon_loss: 11519773.1679; train_masked_gp_l1_reg_loss: 128390.0784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79730.6186; train_chrom_access_recon_loss: 844572.8278; train_global_loss: 15381639.6031; train_optim_loss: 15381639.6031; val_kl_reg_loss: 83726.4458; val_edge_recon_loss: 2732143.9667; val_gene_expr_recon_loss: 11510350.6000; val_masked_gp_l1_reg_loss: 128219.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79735.4844; val_chrom_access_recon_loss: 846671.4875; val_global_loss: 15380846.4000; val_optim_loss: 15380846.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9581; val_auprc_score: 0.9465; val_best_acc_score: 0.8991; val_best_f1_score: 0.9030; train_kl_reg_loss: 83947.7542; train_edge_recon_loss: 2717057.9599; train_gene_expr_recon_loss: 11492595.3893; train_masked_gp_l1_reg_loss: 128199.2996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79515.5394; train_chrom_access_recon_loss: 842925.5324; train_global_loss: 15344241.4885; train_optim_loss: 15344241.4885; val_kl_reg_loss: 84905.1443; val_edge_recon_loss: 2728229.8500; val_gene_expr_recon_loss: 11415319.5333; val_masked_gp_l1_reg_loss: 128363.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79227.5938; val_chrom_access_recon_loss: 841638.3792; val_global_loss: 15277684.0000; val_optim_loss: 15277684.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9618; val_auprc_score: 0.9501; val_best_acc_score: 0.9065; val_best_f1_score: 0.9101; train_kl_reg_loss: 84461.8393; train_edge_recon_loss: 2711336.6698; train_gene_expr_recon_loss: 11468715.9160; train_masked_gp_l1_reg_loss: 128051.7458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79000.7904; train_chrom_access_recon_loss: 840862.8225; train_global_loss: 15312429.7863; train_optim_loss: 15312429.7863; val_kl_reg_loss: 84839.3609; val_edge_recon_loss: 2723623.4500; val_gene_expr_recon_loss: 11433823.0000; val_masked_gp_l1_reg_loss: 128139.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78788.7578; val_chrom_access_recon_loss: 840906.1375; val_global_loss: 15290119.8000; val_optim_loss: 15290119.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9615; val_auprc_score: 0.9509; val_best_acc_score: 0.9053; val_best_f1_score: 0.9088; train_kl_reg_loss: 83390.3246; train_edge_recon_loss: 2712653.7595; train_gene_expr_recon_loss: 11451705.2519; train_masked_gp_l1_reg_loss: 127885.1542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78764.0252; train_chrom_access_recon_loss: 839126.3812; train_global_loss: 15293524.9924; train_optim_loss: 15293524.9924; val_kl_reg_loss: 84870.0734; val_edge_recon_loss: 2715675.0833; val_gene_expr_recon_loss: 11342800.3333; val_masked_gp_l1_reg_loss: 127961.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78618.8516; val_chrom_access_recon_loss: 838472.9250; val_global_loss: 15188398.4667; val_optim_loss: 15188398.4667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9656; val_auprc_score: 0.9560; val_best_acc_score: 0.9124; val_best_f1_score: 0.9155; train_kl_reg_loss: 83962.6768; train_edge_recon_loss: 2710886.7996; train_gene_expr_recon_loss: 11420660.3130; train_masked_gp_l1_reg_loss: 127581.2337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78523.5742; train_chrom_access_recon_loss: 835795.5530; train_global_loss: 15257410.2290; train_optim_loss: 15257410.2290; val_kl_reg_loss: 86323.5167; val_edge_recon_loss: 2718042.5167; val_gene_expr_recon_loss: 11362875.1333; val_masked_gp_l1_reg_loss: 127281.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79082.2031; val_chrom_access_recon_loss: 839143.2458; val_global_loss: 15212748.5333; val_optim_loss: 15212748.5333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9644; val_auprc_score: 0.9547; val_best_acc_score: 0.9093; val_best_f1_score: 0.9131; train_kl_reg_loss: 83378.4210; train_edge_recon_loss: 2709242.0420; train_gene_expr_recon_loss: 11405109.3359; train_masked_gp_l1_reg_loss: 126936.0089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78263.1917; train_chrom_access_recon_loss: 834818.9652; train_global_loss: 15237748.0000; train_optim_loss: 15237748.0000; val_kl_reg_loss: 84753.0578; val_edge_recon_loss: 2726616.7000; val_gene_expr_recon_loss: 11368699.1333; val_masked_gp_l1_reg_loss: 126888.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78908.4766; val_chrom_access_recon_loss: 840053.7583; val_global_loss: 15225918.7333; val_optim_loss: 15225918.7333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9694; val_auprc_score: 0.9600; val_best_acc_score: 0.9170; val_best_f1_score: 0.9207; train_kl_reg_loss: 80918.9479; train_edge_recon_loss: 2702458.2481; train_gene_expr_recon_loss: 11390553.8473; train_masked_gp_l1_reg_loss: 126673.5400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78323.3698; train_chrom_access_recon_loss: 833666.4270; train_global_loss: 15212594.3893; train_optim_loss: 15212594.3893; val_kl_reg_loss: 81836.6203; val_edge_recon_loss: 2694465.1000; val_gene_expr_recon_loss: 11351902.0000; val_masked_gp_l1_reg_loss: 126128.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78102.5391; val_chrom_access_recon_loss: 836734.2750; val_global_loss: 15169169.0667; val_optim_loss: 15169169.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9737; val_auprc_score: 0.9673; val_best_acc_score: 0.9252; val_best_f1_score: 0.9267; train_kl_reg_loss: 81056.0970; train_edge_recon_loss: 2707169.5973; train_gene_expr_recon_loss: 11372792.0153; train_masked_gp_l1_reg_loss: 125953.9348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77878.4059; train_chrom_access_recon_loss: 833044.7052; train_global_loss: 15197894.7328; train_optim_loss: 15197894.7328; val_kl_reg_loss: 80420.9948; val_edge_recon_loss: 2684967.2500; val_gene_expr_recon_loss: 11347913.6667; val_masked_gp_l1_reg_loss: 126078.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78453.4922; val_chrom_access_recon_loss: 838206.3042; val_global_loss: 15156039.2667; val_optim_loss: 15156039.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9708; val_auprc_score: 0.9646; val_best_acc_score: 0.9190; val_best_f1_score: 0.9222; train_kl_reg_loss: 81415.8435; train_edge_recon_loss: 2700329.9389; train_gene_expr_recon_loss: 11355610.1145; train_masked_gp_l1_reg_loss: 125558.4818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77850.2810; train_chrom_access_recon_loss: 831573.3249; train_global_loss: 15172337.9160; train_optim_loss: 15172337.9160; val_kl_reg_loss: 81517.7219; val_edge_recon_loss: 2707869.9333; val_gene_expr_recon_loss: 11348776.4667; val_masked_gp_l1_reg_loss: 125642.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78230.8984; val_chrom_access_recon_loss: 834602.0958; val_global_loss: 15176640.3333; val_optim_loss: 15176640.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9727; val_auprc_score: 0.9635; val_best_acc_score: 0.9205; val_best_f1_score: 0.9227; train_kl_reg_loss: 80958.3380; train_edge_recon_loss: 2700871.2042; train_gene_expr_recon_loss: 11343299.4504; train_masked_gp_l1_reg_loss: 125146.9897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77715.5312; train_chrom_access_recon_loss: 830845.7605; train_global_loss: 15158837.3435; train_optim_loss: 15158837.3435; val_kl_reg_loss: 82498.9260; val_edge_recon_loss: 2691750.1000; val_gene_expr_recon_loss: 11272720.2000; val_masked_gp_l1_reg_loss: 124690.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77320.8359; val_chrom_access_recon_loss: 832468.7458; val_global_loss: 15081448.8000; val_optim_loss: 15081448.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9736; val_auprc_score: 0.9673; val_best_acc_score: 0.9254; val_best_f1_score: 0.9275; train_kl_reg_loss: 80696.2309; train_edge_recon_loss: 2698376.8950; train_gene_expr_recon_loss: 11336880.4351; train_masked_gp_l1_reg_loss: 124357.5115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77351.5771; train_chrom_access_recon_loss: 830398.0530; train_global_loss: 15148060.7099; train_optim_loss: 15148060.7099; val_kl_reg_loss: 80895.4625; val_edge_recon_loss: 2707204.0167; val_gene_expr_recon_loss: 11255733.8000; val_masked_gp_l1_reg_loss: 124078.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77274.9062; val_chrom_access_recon_loss: 831644.0375; val_global_loss: 15076831.2667; val_optim_loss: 15076831.2667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9706; val_auprc_score: 0.9613; val_best_acc_score: 0.9216; val_best_f1_score: 0.9242; train_kl_reg_loss: 81228.6003; train_edge_recon_loss: 2692347.0992; train_gene_expr_recon_loss: 11306962.8015; train_masked_gp_l1_reg_loss: 123827.2009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77129.9875; train_chrom_access_recon_loss: 827920.5978; train_global_loss: 15109416.2443; train_optim_loss: 15109416.2443; val_kl_reg_loss: 81410.6651; val_edge_recon_loss: 2706920.3333; val_gene_expr_recon_loss: 11314625.3333; val_masked_gp_l1_reg_loss: 123959.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76795.1328; val_chrom_access_recon_loss: 832192.5667; val_global_loss: 15135903.0667; val_optim_loss: 15135903.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9707; val_auprc_score: 0.9609; val_best_acc_score: 0.9193; val_best_f1_score: 0.9224; train_kl_reg_loss: 79916.9008; train_edge_recon_loss: 2688702.2042; train_gene_expr_recon_loss: 11304029.3740; train_masked_gp_l1_reg_loss: 123321.6523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77216.4156; train_chrom_access_recon_loss: 827089.3760; train_global_loss: 15100276.0000; train_optim_loss: 15100276.0000; val_kl_reg_loss: 82092.4703; val_edge_recon_loss: 2717258.2000; val_gene_expr_recon_loss: 11255668.3333; val_masked_gp_l1_reg_loss: 123104.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77122.7344; val_chrom_access_recon_loss: 829707.6125; val_global_loss: 15084953.6667; val_optim_loss: 15084953.6667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9680; val_auprc_score: 0.9595; val_best_acc_score: 0.9171; val_best_f1_score: 0.9208; train_kl_reg_loss: 79446.3242; train_edge_recon_loss: 2695145.8073; train_gene_expr_recon_loss: 11301456.6107; train_masked_gp_l1_reg_loss: 122696.2895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77166.9450; train_chrom_access_recon_loss: 826994.7285; train_global_loss: 15102906.7099; train_optim_loss: 15102906.7099; val_kl_reg_loss: 81831.5724; val_edge_recon_loss: 2720479.4667; val_gene_expr_recon_loss: 11258707.6667; val_masked_gp_l1_reg_loss: 122573.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77365.8984; val_chrom_access_recon_loss: 828630.1042; val_global_loss: 15089588.0000; val_optim_loss: 15089588.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9715; val_auprc_score: 0.9636; val_best_acc_score: 0.9216; val_best_f1_score: 0.9248; train_kl_reg_loss: 79179.1445; train_edge_recon_loss: 2694329.3531; train_gene_expr_recon_loss: 11283187.0076; train_masked_gp_l1_reg_loss: 122072.7898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77296.3337; train_chrom_access_recon_loss: 826394.4275; train_global_loss: 15082459.0687; train_optim_loss: 15082459.0687; val_kl_reg_loss: 79780.0318; val_edge_recon_loss: 2714192.0167; val_gene_expr_recon_loss: 11297749.6667; val_masked_gp_l1_reg_loss: 121736.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76953.6250; val_chrom_access_recon_loss: 832224.1750; val_global_loss: 15122636.9333; val_optim_loss: 15122636.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9735; val_auprc_score: 0.9673; val_best_acc_score: 0.9228; val_best_f1_score: 0.9254; train_kl_reg_loss: 80034.1809; train_edge_recon_loss: 2681538.8302; train_gene_expr_recon_loss: 11285411.8092; train_masked_gp_l1_reg_loss: 115632.1794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59341.8111; train_chrom_access_recon_loss: 825211.7829; train_global_loss: 15047170.6183; train_optim_loss: 15047170.6183; val_kl_reg_loss: 81251.9651; val_edge_recon_loss: 2717044.0833; val_gene_expr_recon_loss: 11211408.4667; val_masked_gp_l1_reg_loss: 114348.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56901.2539; val_chrom_access_recon_loss: 828099.5542; val_global_loss: 15009053.0000; val_optim_loss: 15009053.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9702; val_auprc_score: 0.9577; val_best_acc_score: 0.9256; val_best_f1_score: 0.9291; train_kl_reg_loss: 81531.8503; train_edge_recon_loss: 2689740.4351; train_gene_expr_recon_loss: 11269604.7099; train_masked_gp_l1_reg_loss: 114139.2961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56386.8808; train_chrom_access_recon_loss: 823499.1021; train_global_loss: 15034902.2977; train_optim_loss: 15034902.2977; val_kl_reg_loss: 82242.9052; val_edge_recon_loss: 2702587.2667; val_gene_expr_recon_loss: 11210929.3333; val_masked_gp_l1_reg_loss: 114034.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56068.9297; val_chrom_access_recon_loss: 826269.6792; val_global_loss: 14992133.3333; val_optim_loss: 14992133.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9746; val_auprc_score: 0.9666; val_best_acc_score: 0.9307; val_best_f1_score: 0.9331; train_kl_reg_loss: 81915.0389; train_edge_recon_loss: 2690742.8397; train_gene_expr_recon_loss: 11272543.8168; train_masked_gp_l1_reg_loss: 113920.5641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55791.5080; train_chrom_access_recon_loss: 824418.7691; train_global_loss: 15039332.5115; train_optim_loss: 15039332.5115; val_kl_reg_loss: 83499.3698; val_edge_recon_loss: 2700616.5833; val_gene_expr_recon_loss: 11241705.2667; val_masked_gp_l1_reg_loss: 113846.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55572.2344; val_chrom_access_recon_loss: 829160.1583; val_global_loss: 15024400.3333; val_optim_loss: 15024400.3333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9748; val_auprc_score: 0.9657; val_best_acc_score: 0.9254; val_best_f1_score: 0.9289; train_kl_reg_loss: 82840.0305; train_edge_recon_loss: 2680194.9828; train_gene_expr_recon_loss: 11261380.5038; train_masked_gp_l1_reg_loss: 113782.6479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55381.8063; train_chrom_access_recon_loss: 823920.9843; train_global_loss: 15017501.0000; train_optim_loss: 15017501.0000; val_kl_reg_loss: 83850.6240; val_edge_recon_loss: 2700038.7333; val_gene_expr_recon_loss: 11262107.2667; val_masked_gp_l1_reg_loss: 113727.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55112.9219; val_chrom_access_recon_loss: 828815.2333; val_global_loss: 15043653.1333; val_optim_loss: 15043653.1333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9736; val_auprc_score: 0.9651; val_best_acc_score: 0.9287; val_best_f1_score: 0.9313; train_kl_reg_loss: 82810.7781; train_edge_recon_loss: 2685273.1069; train_gene_expr_recon_loss: 11273734.0916; train_masked_gp_l1_reg_loss: 113658.7795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55032.5445; train_chrom_access_recon_loss: 824768.3459; train_global_loss: 15035277.6031; train_optim_loss: 15035277.6031; val_kl_reg_loss: 83691.4016; val_edge_recon_loss: 2700216.4167; val_gene_expr_recon_loss: 11218750.9333; val_masked_gp_l1_reg_loss: 113640.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54936.0820; val_chrom_access_recon_loss: 824623.2250; val_global_loss: 14995858.0000; val_optim_loss: 14995858.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9732; val_auprc_score: 0.9651; val_best_acc_score: 0.9268; val_best_f1_score: 0.9300; train_kl_reg_loss: 83294.5279; train_edge_recon_loss: 2682339.6011; train_gene_expr_recon_loss: 11258945.0305; train_masked_gp_l1_reg_loss: 113579.6482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54839.2068; train_chrom_access_recon_loss: 823014.8927; train_global_loss: 15016012.9313; train_optim_loss: 15016012.9313; val_kl_reg_loss: 83321.0151; val_edge_recon_loss: 2703870.3333; val_gene_expr_recon_loss: 11213947.1333; val_masked_gp_l1_reg_loss: 113504.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54654.2344; val_chrom_access_recon_loss: 825885.9625; val_global_loss: 14995182.5333; val_optim_loss: 14995182.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9761; val_auprc_score: 0.9693; val_best_acc_score: 0.9313; val_best_f1_score: 0.9331; train_kl_reg_loss: 83262.0705; train_edge_recon_loss: 2687926.5019; train_gene_expr_recon_loss: 11262613.5344; train_masked_gp_l1_reg_loss: 112796.8746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52941.1461; train_chrom_access_recon_loss: 824278.7171; train_global_loss: 15023818.8397; train_optim_loss: 15023818.8397; val_kl_reg_loss: 83399.8240; val_edge_recon_loss: 2706030.5000; val_gene_expr_recon_loss: 11254799.5333; val_masked_gp_l1_reg_loss: 112586.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52701.4766; val_chrom_access_recon_loss: 832648.7292; val_global_loss: 15042165.6000; val_optim_loss: 15042165.6000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9757; val_auprc_score: 0.9701; val_best_acc_score: 0.9291; val_best_f1_score: 0.9317; train_kl_reg_loss: 83164.7314; train_edge_recon_loss: 2681920.3149; train_gene_expr_recon_loss: 11269493.9466; train_masked_gp_l1_reg_loss: 112540.2922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52636.6196; train_chrom_access_recon_loss: 823547.6198; train_global_loss: 15023303.5496; train_optim_loss: 15023303.5496; val_kl_reg_loss: 83650.3807; val_edge_recon_loss: 2692312.8000; val_gene_expr_recon_loss: 11238561.6667; val_masked_gp_l1_reg_loss: 112510.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52584.6562; val_chrom_access_recon_loss: 828407.4667; val_global_loss: 15008027.0667; val_optim_loss: 15008027.0667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9739; val_auprc_score: 0.9645; val_best_acc_score: 0.9250; val_best_f1_score: 0.9283; train_kl_reg_loss: 83260.9142; train_edge_recon_loss: 2680986.9637; train_gene_expr_recon_loss: 11273481.7634; train_masked_gp_l1_reg_loss: 112494.4809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52557.3460; train_chrom_access_recon_loss: 824324.1455; train_global_loss: 15027105.6183; train_optim_loss: 15027105.6183; val_kl_reg_loss: 83866.4750; val_edge_recon_loss: 2697441.8333; val_gene_expr_recon_loss: 11208179.2667; val_masked_gp_l1_reg_loss: 112471.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52511.0742; val_chrom_access_recon_loss: 823230.0500; val_global_loss: 14977699.9333; val_optim_loss: 14977699.9333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9761; val_auprc_score: 0.9700; val_best_acc_score: 0.9294; val_best_f1_score: 0.9316; train_kl_reg_loss: 83101.0590; train_edge_recon_loss: 2684919.2252; train_gene_expr_recon_loss: 11254947.3053; train_masked_gp_l1_reg_loss: 112457.1998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52477.5056; train_chrom_access_recon_loss: 823124.3554; train_global_loss: 15011026.6031; train_optim_loss: 15011026.6031; val_kl_reg_loss: 83455.0120; val_edge_recon_loss: 2705482.0833; val_gene_expr_recon_loss: 11165497.2667; val_masked_gp_l1_reg_loss: 112452.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52445.1797; val_chrom_access_recon_loss: 822675.4000; val_global_loss: 14942006.8000; val_optim_loss: 14942006.8000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9741; val_auprc_score: 0.9654; val_best_acc_score: 0.9270; val_best_f1_score: 0.9301; train_kl_reg_loss: 82850.2700; train_edge_recon_loss: 2685946.4561; train_gene_expr_recon_loss: 11260175.0534; train_masked_gp_l1_reg_loss: 112445.1903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52415.2239; train_chrom_access_recon_loss: 823112.9404; train_global_loss: 15016945.1069; train_optim_loss: 15016945.1069; val_kl_reg_loss: 82871.3734; val_edge_recon_loss: 2706232.9833; val_gene_expr_recon_loss: 11182049.1333; val_masked_gp_l1_reg_loss: 112439.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52398.8242; val_chrom_access_recon_loss: 827687.5917; val_global_loss: 14963679.2000; val_optim_loss: 14963679.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9749; val_auprc_score: 0.9667; val_best_acc_score: 0.9281; val_best_f1_score: 0.9295; train_kl_reg_loss: 82927.7547; train_edge_recon_loss: 2685006.4370; train_gene_expr_recon_loss: 11251418.1832; train_masked_gp_l1_reg_loss: 112435.3842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52377.0917; train_chrom_access_recon_loss: 821900.1951; train_global_loss: 15006065.0229; train_optim_loss: 15006065.0229; val_kl_reg_loss: 83942.1661; val_edge_recon_loss: 2704109.2333; val_gene_expr_recon_loss: 11277714.8667; val_masked_gp_l1_reg_loss: 112426.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52347.0000; val_chrom_access_recon_loss: 828829.2542; val_global_loss: 15059369.5333; val_optim_loss: 15059369.5333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9764; val_auprc_score: 0.9702; val_best_acc_score: 0.9297; val_best_f1_score: 0.9316; train_kl_reg_loss: 83182.1181; train_edge_recon_loss: 2675734.8760; train_gene_expr_recon_loss: 11263811.8092; train_masked_gp_l1_reg_loss: 112414.6565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52323.3739; train_chrom_access_recon_loss: 823501.6441; train_global_loss: 15010968.3893; train_optim_loss: 15010968.3893; val_kl_reg_loss: 83886.7771; val_edge_recon_loss: 2687726.6333; val_gene_expr_recon_loss: 11274493.9333; val_masked_gp_l1_reg_loss: 112403.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52302.4297; val_chrom_access_recon_loss: 832061.4083; val_global_loss: 15042873.5333; val_optim_loss: 15042873.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9753; val_auprc_score: 0.9660; val_best_acc_score: 0.9297; val_best_f1_score: 0.9316; train_kl_reg_loss: 83142.7542; train_edge_recon_loss: 2681873.7672; train_gene_expr_recon_loss: 11270224.3511; train_masked_gp_l1_reg_loss: 112404.8898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52278.8368; train_chrom_access_recon_loss: 823621.0577; train_global_loss: 15023545.6412; train_optim_loss: 15023545.6412; val_kl_reg_loss: 83832.6510; val_edge_recon_loss: 2694159.9167; val_gene_expr_recon_loss: 11257988.8667; val_masked_gp_l1_reg_loss: 112401.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52254.7461; val_chrom_access_recon_loss: 830621.7208; val_global_loss: 15031260.2000; val_optim_loss: 15031260.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9712; val_auprc_score: 0.9609; val_best_acc_score: 0.9250; val_best_f1_score: 0.9282; train_kl_reg_loss: 83218.9256; train_edge_recon_loss: 2684483.8473; train_gene_expr_recon_loss: 11256815.3817; train_masked_gp_l1_reg_loss: 112327.8115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52082.6274; train_chrom_access_recon_loss: 822598.6775; train_global_loss: 15011527.2748; train_optim_loss: 15011527.2748; val_kl_reg_loss: 83869.0828; val_edge_recon_loss: 2705325.7667; val_gene_expr_recon_loss: 11200791.6000; val_masked_gp_l1_reg_loss: 112302.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52059.7070; val_chrom_access_recon_loss: 824414.0667; val_global_loss: 14978763.6000; val_optim_loss: 14978763.6000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9767; val_auprc_score: 0.9688; val_best_acc_score: 0.9333; val_best_f1_score: 0.9356; train_kl_reg_loss: 83180.5265; train_edge_recon_loss: 2690025.8149; train_gene_expr_recon_loss: 11258508.8931; train_masked_gp_l1_reg_loss: 112296.8807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52053.0030; train_chrom_access_recon_loss: 823123.7929; train_global_loss: 15019188.9389; train_optim_loss: 15019188.9389; val_kl_reg_loss: 83498.2583; val_edge_recon_loss: 2687005.0833; val_gene_expr_recon_loss: 11226073.6000; val_masked_gp_l1_reg_loss: 112292.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52047.1133; val_chrom_access_recon_loss: 828749.5167; val_global_loss: 14989666.4000; val_optim_loss: 14989666.4000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9770; val_auprc_score: 0.9684; val_best_acc_score: 0.9285; val_best_f1_score: 0.9315; train_kl_reg_loss: 83222.6670; train_edge_recon_loss: 2686178.6202; train_gene_expr_recon_loss: 11264870.1756; train_masked_gp_l1_reg_loss: 112289.7991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52042.4188; train_chrom_access_recon_loss: 823696.3068; train_global_loss: 15022300.0153; train_optim_loss: 15022300.0153; val_kl_reg_loss: 83897.1266; val_edge_recon_loss: 2687540.9833; val_gene_expr_recon_loss: 11228786.0000; val_masked_gp_l1_reg_loss: 112287.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52037.8867; val_chrom_access_recon_loss: 830130.3875; val_global_loss: 14994679.6667; val_optim_loss: 14994679.6667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9739; val_auprc_score: 0.9651; val_best_acc_score: 0.9275; val_best_f1_score: 0.9304; train_kl_reg_loss: 83186.4784; train_edge_recon_loss: 2684300.3645; train_gene_expr_recon_loss: 11254734.3817; train_masked_gp_l1_reg_loss: 112285.3596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52033.5765; train_chrom_access_recon_loss: 822683.7529; train_global_loss: 15009223.9160; train_optim_loss: 15009223.9160; val_kl_reg_loss: 83534.6062; val_edge_recon_loss: 2712639.3833; val_gene_expr_recon_loss: 11209579.6667; val_masked_gp_l1_reg_loss: 112283.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52029.9375; val_chrom_access_recon_loss: 827473.7833; val_global_loss: 14997540.3333; val_optim_loss: 14997540.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 30 min 34 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9730
val AUPRC score: 0.9635
val best accuracy score: 0.9252
val best F1 score: 0.9276
val target rna MSE score: 1.2097
val source rna MSE score: 0.4605
val target atac MSE score: 0.4955
val source atac MSE score: 0.1480
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
