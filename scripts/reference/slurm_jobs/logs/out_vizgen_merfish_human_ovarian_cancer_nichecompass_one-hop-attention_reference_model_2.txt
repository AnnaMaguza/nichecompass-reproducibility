Run timestamp: 14062023_181725.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '10000.', '--contrastive_logits_ratio', '0.015625', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 500, n_cond_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 803, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 803, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 803, n_cond_embed_input: 500, n_addon_input: 0, n_output: 1000
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 500, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 759633
Number of validation nodes: 84404
Number of training edges: 5242555
Number of validation edges: 582506
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9875; val_auprc_score: 0.9958; val_best_acc_score: 0.9577; val_best_f1_score: 0.9726; train_kl_reg_loss: 3217.4807; train_edge_recon_loss: 124316.6781; train_cond_contrastive_loss: 3758.3792; train_gene_expr_recon_loss: 117194.3472; train_masked_gp_l1_reg_loss: 608.2986; train_group_lasso_reg_loss: 0.0000; train_global_loss: 249095.1839; train_optim_loss: 249095.1839; val_kl_reg_loss: 3201.3629; val_edge_recon_loss: 123204.5707; val_cond_contrastive_loss: 3779.8354; val_gene_expr_recon_loss: 114233.6676; val_masked_gp_l1_reg_loss: 589.5461; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245008.9825; val_optim_loss: 245008.9825
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9895; val_auprc_score: 0.9964; val_best_acc_score: 0.9628; val_best_f1_score: 0.9759; train_kl_reg_loss: 3273.3426; train_edge_recon_loss: 123011.7035; train_cond_contrastive_loss: 3786.7795; train_gene_expr_recon_loss: 113601.3597; train_masked_gp_l1_reg_loss: 581.3269; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244254.5123; train_optim_loss: 244254.5123; val_kl_reg_loss: 3313.7168; val_edge_recon_loss: 123398.0921; val_cond_contrastive_loss: 3760.5838; val_gene_expr_recon_loss: 112605.0372; val_masked_gp_l1_reg_loss: 577.6278; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243655.0548; val_optim_loss: 243655.0548
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9889; val_auprc_score: 0.9961; val_best_acc_score: 0.9639; val_best_f1_score: 0.9766; train_kl_reg_loss: 3337.2452; train_edge_recon_loss: 123017.3011; train_cond_contrastive_loss: 3734.8145; train_gene_expr_recon_loss: 112529.6365; train_masked_gp_l1_reg_loss: 573.6003; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243192.5976; train_optim_loss: 243192.5976; val_kl_reg_loss: 3329.5906; val_edge_recon_loss: 123436.8706; val_cond_contrastive_loss: 3651.0693; val_gene_expr_recon_loss: 111907.5880; val_masked_gp_l1_reg_loss: 572.5461; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242897.6648; val_optim_loss: 242897.6648
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9897; val_auprc_score: 0.9963; val_best_acc_score: 0.9658; val_best_f1_score: 0.9778; train_kl_reg_loss: 3375.2901; train_edge_recon_loss: 122843.1944; train_cond_contrastive_loss: 3705.3278; train_gene_expr_recon_loss: 111968.1709; train_masked_gp_l1_reg_loss: 571.3652; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242463.3484; train_optim_loss: 242463.3484; val_kl_reg_loss: 3373.2195; val_edge_recon_loss: 123062.7765; val_cond_contrastive_loss: 3647.1277; val_gene_expr_recon_loss: 111571.7224; val_masked_gp_l1_reg_loss: 571.4167; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242226.2682; val_optim_loss: 242226.2682
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9897; val_auprc_score: 0.9963; val_best_acc_score: 0.9668; val_best_f1_score: 0.9785; train_kl_reg_loss: 3400.9368; train_edge_recon_loss: 122746.9889; train_cond_contrastive_loss: 3687.5581; train_gene_expr_recon_loss: 111650.3252; train_masked_gp_l1_reg_loss: 571.4796; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242057.2886; train_optim_loss: 242057.2886; val_kl_reg_loss: 3396.5197; val_edge_recon_loss: 123092.7138; val_cond_contrastive_loss: 3606.9925; val_gene_expr_recon_loss: 111315.2172; val_masked_gp_l1_reg_loss: 574.0095; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241985.4588; val_optim_loss: 241985.4588
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9905; val_auprc_score: 0.9966; val_best_acc_score: 0.9682; val_best_f1_score: 0.9794; train_kl_reg_loss: 3420.2586; train_edge_recon_loss: 122608.4438; train_cond_contrastive_loss: 3679.0993; train_gene_expr_recon_loss: 111450.1547; train_masked_gp_l1_reg_loss: 573.6803; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241731.6367; train_optim_loss: 241731.6367; val_kl_reg_loss: 3299.4878; val_edge_recon_loss: 122774.7548; val_cond_contrastive_loss: 3650.0733; val_gene_expr_recon_loss: 111151.2116; val_masked_gp_l1_reg_loss: 572.7976; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241448.3243; val_optim_loss: 241448.3243
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9898; val_auprc_score: 0.9963; val_best_acc_score: 0.9681; val_best_f1_score: 0.9794; train_kl_reg_loss: 3436.1283; train_edge_recon_loss: 122566.4600; train_cond_contrastive_loss: 3672.7691; train_gene_expr_recon_loss: 111304.3017; train_masked_gp_l1_reg_loss: 576.0117; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241555.6709; train_optim_loss: 241555.6709; val_kl_reg_loss: 3343.5052; val_edge_recon_loss: 123212.0571; val_cond_contrastive_loss: 3607.3964; val_gene_expr_recon_loss: 111030.5443; val_masked_gp_l1_reg_loss: 577.1702; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241770.6745; val_optim_loss: 241770.6745
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9891; val_auprc_score: 0.9960; val_best_acc_score: 0.9671; val_best_f1_score: 0.9787; train_kl_reg_loss: 3446.4574; train_edge_recon_loss: 122587.2814; train_cond_contrastive_loss: 3671.4708; train_gene_expr_recon_loss: 111213.9995; train_masked_gp_l1_reg_loss: 575.4357; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241494.6445; train_optim_loss: 241494.6445; val_kl_reg_loss: 3462.0184; val_edge_recon_loss: 123307.2456; val_cond_contrastive_loss: 3554.6101; val_gene_expr_recon_loss: 111021.3945; val_masked_gp_l1_reg_loss: 574.0843; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241919.3470; val_optim_loss: 241919.3470
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9908; val_auprc_score: 0.9967; val_best_acc_score: 0.9695; val_best_f1_score: 0.9802; train_kl_reg_loss: 3457.7580; train_edge_recon_loss: 122646.8905; train_cond_contrastive_loss: 3665.9949; train_gene_expr_recon_loss: 111098.1927; train_masked_gp_l1_reg_loss: 575.8502; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241444.6863; train_optim_loss: 241444.6863; val_kl_reg_loss: 3393.1433; val_edge_recon_loss: 122999.8030; val_cond_contrastive_loss: 3669.0804; val_gene_expr_recon_loss: 110921.5853; val_masked_gp_l1_reg_loss: 575.4800; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241559.0967; val_optim_loss: 241559.0967

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9908; val_auprc_score: 0.9966; val_best_acc_score: 0.9705; val_best_f1_score: 0.9809; train_kl_reg_loss: 3459.6377; train_edge_recon_loss: 122360.0005; train_cond_contrastive_loss: 3671.6744; train_gene_expr_recon_loss: 110702.3894; train_masked_gp_l1_reg_loss: 516.2250; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240709.9271; train_optim_loss: 240709.9271; val_kl_reg_loss: 3443.2870; val_edge_recon_loss: 122771.2298; val_cond_contrastive_loss: 3604.9260; val_gene_expr_recon_loss: 110521.5126; val_masked_gp_l1_reg_loss: 513.9679; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240854.9242; val_optim_loss: 240854.9242
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9912; val_auprc_score: 0.9968; val_best_acc_score: 0.9707; val_best_f1_score: 0.9810; train_kl_reg_loss: 3455.0484; train_edge_recon_loss: 122473.0351; train_cond_contrastive_loss: 3667.8338; train_gene_expr_recon_loss: 110609.1957; train_masked_gp_l1_reg_loss: 513.1060; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240718.2189; train_optim_loss: 240718.2189; val_kl_reg_loss: 3426.0040; val_edge_recon_loss: 122790.7483; val_cond_contrastive_loss: 3650.2324; val_gene_expr_recon_loss: 110518.6683; val_masked_gp_l1_reg_loss: 513.2310; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240898.8881; val_optim_loss: 240898.8881
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9916; val_auprc_score: 0.9970; val_best_acc_score: 0.9715; val_best_f1_score: 0.9816; train_kl_reg_loss: 3453.1618; train_edge_recon_loss: 122273.0533; train_cond_contrastive_loss: 3667.2275; train_gene_expr_recon_loss: 110541.6288; train_masked_gp_l1_reg_loss: 513.7870; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240448.8583; train_optim_loss: 240448.8583; val_kl_reg_loss: 3438.5526; val_edge_recon_loss: 122500.6031; val_cond_contrastive_loss: 3647.4252; val_gene_expr_recon_loss: 110395.2769; val_masked_gp_l1_reg_loss: 514.6459; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240496.4986; val_optim_loss: 240496.4986
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9913; val_auprc_score: 0.9969; val_best_acc_score: 0.9709; val_best_f1_score: 0.9812; train_kl_reg_loss: 3450.8147; train_edge_recon_loss: 122523.3518; train_cond_contrastive_loss: 3667.4108; train_gene_expr_recon_loss: 110507.9663; train_masked_gp_l1_reg_loss: 515.7969; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240665.3404; train_optim_loss: 240665.3404; val_kl_reg_loss: 3417.9652; val_edge_recon_loss: 122872.8419; val_cond_contrastive_loss: 3617.2768; val_gene_expr_recon_loss: 110439.3356; val_masked_gp_l1_reg_loss: 515.7424; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240863.1693; val_optim_loss: 240863.1693
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9912; val_auprc_score: 0.9968; val_best_acc_score: 0.9712; val_best_f1_score: 0.9814; train_kl_reg_loss: 3450.6943; train_edge_recon_loss: 122460.1166; train_cond_contrastive_loss: 3666.3318; train_gene_expr_recon_loss: 110494.0281; train_masked_gp_l1_reg_loss: 516.5974; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240587.7681; train_optim_loss: 240587.7681; val_kl_reg_loss: 3420.6040; val_edge_recon_loss: 122778.4325; val_cond_contrastive_loss: 3623.7760; val_gene_expr_recon_loss: 110360.9951; val_masked_gp_l1_reg_loss: 516.5439; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240700.3544; val_optim_loss: 240700.3544
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9914; val_auprc_score: 0.9969; val_best_acc_score: 0.9715; val_best_f1_score: 0.9815; train_kl_reg_loss: 3447.3936; train_edge_recon_loss: 122400.9894; train_cond_contrastive_loss: 3666.2523; train_gene_expr_recon_loss: 110473.2434; train_masked_gp_l1_reg_loss: 517.6373; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240505.5161; train_optim_loss: 240505.5161; val_kl_reg_loss: 3397.4962; val_edge_recon_loss: 122730.0772; val_cond_contrastive_loss: 3653.7072; val_gene_expr_recon_loss: 110419.0330; val_masked_gp_l1_reg_loss: 518.4095; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240718.7197; val_optim_loss: 240718.7197

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9915; val_auprc_score: 0.9969; val_best_acc_score: 0.9718; val_best_f1_score: 0.9817; train_kl_reg_loss: 3448.7916; train_edge_recon_loss: 122369.0678; train_cond_contrastive_loss: 3669.5671; train_gene_expr_recon_loss: 110421.1732; train_masked_gp_l1_reg_loss: 509.9878; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240418.5876; train_optim_loss: 240418.5876; val_kl_reg_loss: 3417.5664; val_edge_recon_loss: 122779.6073; val_cond_contrastive_loss: 3623.5655; val_gene_expr_recon_loss: 110293.9366; val_masked_gp_l1_reg_loss: 509.5735; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240624.2544; val_optim_loss: 240624.2544
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9913; val_auprc_score: 0.9968; val_best_acc_score: 0.9713; val_best_f1_score: 0.9814; train_kl_reg_loss: 3449.2948; train_edge_recon_loss: 122304.1010; train_cond_contrastive_loss: 3664.6871; train_gene_expr_recon_loss: 110415.9994; train_masked_gp_l1_reg_loss: 509.7497; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240343.8322; train_optim_loss: 240343.8322; val_kl_reg_loss: 3425.1938; val_edge_recon_loss: 122721.9168; val_cond_contrastive_loss: 3624.1766; val_gene_expr_recon_loss: 110296.3331; val_masked_gp_l1_reg_loss: 509.9129; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240577.5260; val_optim_loss: 240577.5260
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9913; val_auprc_score: 0.9968; val_best_acc_score: 0.9715; val_best_f1_score: 0.9816; train_kl_reg_loss: 3450.4494; train_edge_recon_loss: 122303.8840; train_cond_contrastive_loss: 3659.8913; train_gene_expr_recon_loss: 110426.8193; train_masked_gp_l1_reg_loss: 510.1554; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240351.1993; train_optim_loss: 240351.1993; val_kl_reg_loss: 3428.8473; val_edge_recon_loss: 122573.4307; val_cond_contrastive_loss: 3613.9162; val_gene_expr_recon_loss: 110351.8425; val_masked_gp_l1_reg_loss: 510.3701; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240478.4113; val_optim_loss: 240478.4113
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9912; val_auprc_score: 0.9968; val_best_acc_score: 0.9715; val_best_f1_score: 0.9816; train_kl_reg_loss: 3450.2219; train_edge_recon_loss: 122386.7937; train_cond_contrastive_loss: 3665.1411; train_gene_expr_recon_loss: 110378.2689; train_masked_gp_l1_reg_loss: 510.4691; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240390.8948; train_optim_loss: 240390.8948; val_kl_reg_loss: 3423.8890; val_edge_recon_loss: 122681.4387; val_cond_contrastive_loss: 3616.5509; val_gene_expr_recon_loss: 110296.7354; val_masked_gp_l1_reg_loss: 510.6117; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240529.2234; val_optim_loss: 240529.2234
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9913; val_auprc_score: 0.9968; val_best_acc_score: 0.9718; val_best_f1_score: 0.9817; train_kl_reg_loss: 3451.4932; train_edge_recon_loss: 122322.3057; train_cond_contrastive_loss: 3660.4857; train_gene_expr_recon_loss: 110406.1055; train_masked_gp_l1_reg_loss: 510.7779; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240351.1680; train_optim_loss: 240351.1680; val_kl_reg_loss: 3429.4419; val_edge_recon_loss: 123126.0042; val_cond_contrastive_loss: 3626.5607; val_gene_expr_recon_loss: 110345.8180; val_masked_gp_l1_reg_loss: 510.9234; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241038.7467; val_optim_loss: 241038.7467
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9914; val_auprc_score: 0.9969; val_best_acc_score: 0.9715; val_best_f1_score: 0.9815; train_kl_reg_loss: 3447.8241; train_edge_recon_loss: 122264.9574; train_cond_contrastive_loss: 3664.4601; train_gene_expr_recon_loss: 110404.5940; train_masked_gp_l1_reg_loss: 511.0090; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240292.8444; train_optim_loss: 240292.8444; val_kl_reg_loss: 3419.9988; val_edge_recon_loss: 123007.1911; val_cond_contrastive_loss: 3620.5863; val_gene_expr_recon_loss: 110324.3703; val_masked_gp_l1_reg_loss: 511.0633; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240883.2085; val_optim_loss: 240883.2085

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9913; val_auprc_score: 0.9968; val_best_acc_score: 0.9717; val_best_f1_score: 0.9817; train_kl_reg_loss: 3449.0133; train_edge_recon_loss: 122450.5436; train_cond_contrastive_loss: 3662.0707; train_gene_expr_recon_loss: 110383.1319; train_masked_gp_l1_reg_loss: 510.1153; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240454.8744; train_optim_loss: 240454.8744; val_kl_reg_loss: 3421.0774; val_edge_recon_loss: 122678.3315; val_cond_contrastive_loss: 3626.1887; val_gene_expr_recon_loss: 110336.1835; val_masked_gp_l1_reg_loss: 510.0219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240571.7969; val_optim_loss: 240571.7969
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9913; val_auprc_score: 0.9968; val_best_acc_score: 0.9716; val_best_f1_score: 0.9816; train_kl_reg_loss: 3447.4341; train_edge_recon_loss: 122318.1394; train_cond_contrastive_loss: 3666.0192; train_gene_expr_recon_loss: 110397.2111; train_masked_gp_l1_reg_loss: 510.0133; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240338.8162; train_optim_loss: 240338.8162; val_kl_reg_loss: 3421.6565; val_edge_recon_loss: 123104.7041; val_cond_contrastive_loss: 3623.7748; val_gene_expr_recon_loss: 110298.3750; val_masked_gp_l1_reg_loss: 509.9961; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240958.5111; val_optim_loss: 240958.5111
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9914; val_auprc_score: 0.9969; val_best_acc_score: 0.9715; val_best_f1_score: 0.9815; train_kl_reg_loss: 3447.5911; train_edge_recon_loss: 122340.1088; train_cond_contrastive_loss: 3668.6217; train_gene_expr_recon_loss: 110417.0156; train_masked_gp_l1_reg_loss: 509.9932; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240383.3302; train_optim_loss: 240383.3302; val_kl_reg_loss: 3420.0901; val_edge_recon_loss: 122944.1731; val_cond_contrastive_loss: 3624.3726; val_gene_expr_recon_loss: 110375.5131; val_masked_gp_l1_reg_loss: 510.0067; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240874.1489; val_optim_loss: 240874.1489

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 896 min 3 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9889
Val AUPRC score: 0.9963
Val best accuracy score: 0.9602
Val best F1 score: 0.9742
Val gene expr MSE score: 5.3387

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
