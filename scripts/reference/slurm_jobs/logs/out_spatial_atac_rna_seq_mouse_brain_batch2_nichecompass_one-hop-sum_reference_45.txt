[True]
Run timestamp: 10082023_205546_45.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_45']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7577; val_auprc_score: 0.7833; val_best_acc_score: 0.5166; val_best_f1_score: 0.6733; train_kl_reg_loss: 82897.0707; train_edge_recon_loss: 3719625.7347; train_gene_expr_recon_loss: 28023658.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27569745.9084; train_global_loss: 59395927.7863; train_optim_loss: 59395927.7863; val_kl_reg_loss: 141561.5823; val_edge_recon_loss: 4064072.7667; val_gene_expr_recon_loss: 23271946.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25921592.8000; val_global_loss: 53399173.6000; val_optim_loss: 53399173.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7722; val_auprc_score: 0.7927; val_best_acc_score: 0.6677; val_best_f1_score: 0.7164; train_kl_reg_loss: 174135.4603; train_edge_recon_loss: 3583711.1317; train_gene_expr_recon_loss: 22768855.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25805645.7710; train_global_loss: 52332348.0916; train_optim_loss: 52332348.0916; val_kl_reg_loss: 164843.5760; val_edge_recon_loss: 4049859.2500; val_gene_expr_recon_loss: 22215611.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25480613.4667; val_global_loss: 51910928.5333; val_optim_loss: 51910928.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8821; val_auprc_score: 0.8794; val_best_acc_score: 0.8025; val_best_f1_score: 0.8120; train_kl_reg_loss: 153910.5838; train_edge_recon_loss: 3541516.0573; train_gene_expr_recon_loss: 22266008.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25574441.6336; train_global_loss: 51535876.9160; train_optim_loss: 51535876.9160; val_kl_reg_loss: 131234.1615; val_edge_recon_loss: 3907763.1500; val_gene_expr_recon_loss: 21978022.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25321154.4000; val_global_loss: 51338173.8667; val_optim_loss: 51338173.8667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9008; val_auprc_score: 0.8892; val_best_acc_score: 0.8203; val_best_f1_score: 0.8343; train_kl_reg_loss: 121518.4892; train_edge_recon_loss: 3346857.5305; train_gene_expr_recon_loss: 22042500.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25342915.3130; train_global_loss: 50853792.0611; train_optim_loss: 50853792.0611; val_kl_reg_loss: 136855.5161; val_edge_recon_loss: 3062947.5000; val_gene_expr_recon_loss: 21760728.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25134574.0000; val_global_loss: 50095105.8667; val_optim_loss: 50095105.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9124; val_auprc_score: 0.8964; val_best_acc_score: 0.8375; val_best_f1_score: 0.8482; train_kl_reg_loss: 154566.2337; train_edge_recon_loss: 2998108.0744; train_gene_expr_recon_loss: 21905616.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25240251.1756; train_global_loss: 50298542.1069; train_optim_loss: 50298542.1069; val_kl_reg_loss: 151798.8094; val_edge_recon_loss: 2949470.2167; val_gene_expr_recon_loss: 21614543.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24905272.1333; val_global_loss: 49621084.2667; val_optim_loss: 49621084.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9195; val_auprc_score: 0.9059; val_best_acc_score: 0.8461; val_best_f1_score: 0.8547; train_kl_reg_loss: 157036.7078; train_edge_recon_loss: 2919090.9370; train_gene_expr_recon_loss: 21751677.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25106411.2672; train_global_loss: 49934216.3053; train_optim_loss: 49934216.3053; val_kl_reg_loss: 146966.7906; val_edge_recon_loss: 2916955.8500; val_gene_expr_recon_loss: 21581211.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24970682.1333; val_global_loss: 49615815.7333; val_optim_loss: 49615815.7333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9282; val_auprc_score: 0.9163; val_best_acc_score: 0.8552; val_best_f1_score: 0.8636; train_kl_reg_loss: 152896.9494; train_edge_recon_loss: 2892303.7672; train_gene_expr_recon_loss: 21654208.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25050086.8855; train_global_loss: 49749495.6641; train_optim_loss: 49749495.6641; val_kl_reg_loss: 149646.6552; val_edge_recon_loss: 2885273.8667; val_gene_expr_recon_loss: 21326646.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24686123.8667; val_global_loss: 49047690.6667; val_optim_loss: 49047690.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9327; val_auprc_score: 0.9196; val_best_acc_score: 0.8677; val_best_f1_score: 0.8732; train_kl_reg_loss: 148158.6053; train_edge_recon_loss: 2862110.8855; train_gene_expr_recon_loss: 21536721.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24948269.4809; train_global_loss: 49495260.1832; train_optim_loss: 49495260.1832; val_kl_reg_loss: 146225.4573; val_edge_recon_loss: 2880283.3167; val_gene_expr_recon_loss: 21183269.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24683901.6000; val_global_loss: 48893680.8000; val_optim_loss: 48893680.8000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9365; val_auprc_score: 0.9204; val_best_acc_score: 0.8713; val_best_f1_score: 0.8806; train_kl_reg_loss: 141459.0559; train_edge_recon_loss: 2845443.5363; train_gene_expr_recon_loss: 21411507.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24823324.5344; train_global_loss: 49221734.9008; train_optim_loss: 49221734.9008; val_kl_reg_loss: 138016.1656; val_edge_recon_loss: 2844414.8500; val_gene_expr_recon_loss: 21144446.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24568891.0667; val_global_loss: 48695767.7333; val_optim_loss: 48695767.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9402; val_auprc_score: 0.9261; val_best_acc_score: 0.8721; val_best_f1_score: 0.8802; train_kl_reg_loss: 137960.5066; train_edge_recon_loss: 2827985.2328; train_gene_expr_recon_loss: 21332326.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24748872.2748; train_global_loss: 49047143.8473; train_optim_loss: 49047143.8473; val_kl_reg_loss: 133504.2052; val_edge_recon_loss: 2836980.4167; val_gene_expr_recon_loss: 21187653.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24685771.4667; val_global_loss: 48843909.6000; val_optim_loss: 48843909.6000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9446; val_auprc_score: 0.9324; val_best_acc_score: 0.8795; val_best_f1_score: 0.8875; train_kl_reg_loss: 132663.5163; train_edge_recon_loss: 2808738.2462; train_gene_expr_recon_loss: 21226043.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24642065.1603; train_global_loss: 48809510.0153; train_optim_loss: 48809510.0153; val_kl_reg_loss: 131199.5005; val_edge_recon_loss: 2836105.1167; val_gene_expr_recon_loss: 21005404.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24478359.3333; val_global_loss: 48451068.0000; val_optim_loss: 48451068.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9498; val_auprc_score: 0.9415; val_best_acc_score: 0.8875; val_best_f1_score: 0.8922; train_kl_reg_loss: 129482.2278; train_edge_recon_loss: 2802265.5897; train_gene_expr_recon_loss: 21155044.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24591711.7557; train_global_loss: 48678503.9084; train_optim_loss: 48678503.9084; val_kl_reg_loss: 130490.1422; val_edge_recon_loss: 2819305.3667; val_gene_expr_recon_loss: 20997363.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24493948.0000; val_global_loss: 48441107.2000; val_optim_loss: 48441107.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9549; val_auprc_score: 0.9458; val_best_acc_score: 0.8907; val_best_f1_score: 0.8956; train_kl_reg_loss: 125902.7278; train_edge_recon_loss: 2788704.3321; train_gene_expr_recon_loss: 21104272.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24546718.5038; train_global_loss: 48565598.3817; train_optim_loss: 48565598.3817; val_kl_reg_loss: 120792.0172; val_edge_recon_loss: 2802314.5000; val_gene_expr_recon_loss: 20972874.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24452139.2000; val_global_loss: 48348120.8000; val_optim_loss: 48348120.8000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9578; val_auprc_score: 0.9498; val_best_acc_score: 0.8988; val_best_f1_score: 0.9017; train_kl_reg_loss: 123142.8376; train_edge_recon_loss: 2772368.0954; train_gene_expr_recon_loss: 21062501.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24509001.0382; train_global_loss: 48467013.9237; train_optim_loss: 48467013.9237; val_kl_reg_loss: 122651.3125; val_edge_recon_loss: 2772173.5833; val_gene_expr_recon_loss: 20874169.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24325380.9333; val_global_loss: 48094375.4667; val_optim_loss: 48094375.4667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9593; val_auprc_score: 0.9479; val_best_acc_score: 0.9030; val_best_f1_score: 0.9056; train_kl_reg_loss: 120056.9114; train_edge_recon_loss: 2766010.3168; train_gene_expr_recon_loss: 20990175.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24440778.8244; train_global_loss: 48317020.9466; train_optim_loss: 48317020.9466; val_kl_reg_loss: 120879.1464; val_edge_recon_loss: 2773105.2167; val_gene_expr_recon_loss: 20745702.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24152489.2000; val_global_loss: 47792176.0000; val_optim_loss: 47792176.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9635; val_auprc_score: 0.9544; val_best_acc_score: 0.9065; val_best_f1_score: 0.9097; train_kl_reg_loss: 116942.0337; train_edge_recon_loss: 2759241.3282; train_gene_expr_recon_loss: 20942188.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24407399.0229; train_global_loss: 48225770.8397; train_optim_loss: 48225770.8397; val_kl_reg_loss: 115056.1844; val_edge_recon_loss: 2760878.4167; val_gene_expr_recon_loss: 20817561.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24290663.6000; val_global_loss: 47984160.2667; val_optim_loss: 47984160.2667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9618; val_auprc_score: 0.9528; val_best_acc_score: 0.9051; val_best_f1_score: 0.9079; train_kl_reg_loss: 113889.5422; train_edge_recon_loss: 2748977.8740; train_gene_expr_recon_loss: 20925552.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24391182.0916; train_global_loss: 48179602.2901; train_optim_loss: 48179602.2901; val_kl_reg_loss: 111837.0974; val_edge_recon_loss: 2779224.9667; val_gene_expr_recon_loss: 20628461.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24112748.0000; val_global_loss: 47632271.4667; val_optim_loss: 47632271.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9663; val_auprc_score: 0.9593; val_best_acc_score: 0.9126; val_best_f1_score: 0.9146; train_kl_reg_loss: 110693.1889; train_edge_recon_loss: 2747173.7099; train_gene_expr_recon_loss: 20851869.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24329438.0000; train_global_loss: 48039174.1069; train_optim_loss: 48039174.1069; val_kl_reg_loss: 110533.0807; val_edge_recon_loss: 2743419.1333; val_gene_expr_recon_loss: 20678666.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24225382.1333; val_global_loss: 47758000.0000; val_optim_loss: 47758000.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9673; val_auprc_score: 0.9597; val_best_acc_score: 0.9138; val_best_f1_score: 0.9168; train_kl_reg_loss: 107989.7449; train_edge_recon_loss: 2749448.8435; train_gene_expr_recon_loss: 20826957.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24309181.5573; train_global_loss: 47993576.9160; train_optim_loss: 47993576.9160; val_kl_reg_loss: 105030.6474; val_edge_recon_loss: 2747359.7000; val_gene_expr_recon_loss: 20620204.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24137012.8000; val_global_loss: 47609608.5333; val_optim_loss: 47609608.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9677; val_auprc_score: 0.9587; val_best_acc_score: 0.9128; val_best_f1_score: 0.9150; train_kl_reg_loss: 106392.4791; train_edge_recon_loss: 2737184.4847; train_gene_expr_recon_loss: 20790956.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24278288.7481; train_global_loss: 47912822.2595; train_optim_loss: 47912822.2595; val_kl_reg_loss: 105943.0521; val_edge_recon_loss: 2762920.4333; val_gene_expr_recon_loss: 20585897.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24053956.8000; val_global_loss: 47508717.8667; val_optim_loss: 47508717.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9710; val_auprc_score: 0.9651; val_best_acc_score: 0.9186; val_best_f1_score: 0.9206; train_kl_reg_loss: 105077.9791; train_edge_recon_loss: 2730572.5191; train_gene_expr_recon_loss: 20771968.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24276687.6947; train_global_loss: 47884306.5038; train_optim_loss: 47884306.5038; val_kl_reg_loss: 103542.3760; val_edge_recon_loss: 2741040.9500; val_gene_expr_recon_loss: 20564774.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24060736.4000; val_global_loss: 47470093.0667; val_optim_loss: 47470093.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9730; val_auprc_score: 0.9663; val_best_acc_score: 0.9201; val_best_f1_score: 0.9229; train_kl_reg_loss: 103096.8670; train_edge_recon_loss: 2726478.2519; train_gene_expr_recon_loss: 20708222.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24201637.2519; train_global_loss: 47739434.2595; train_optim_loss: 47739434.2595; val_kl_reg_loss: 101491.0250; val_edge_recon_loss: 2732770.4000; val_gene_expr_recon_loss: 20567309.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24078572.5333; val_global_loss: 47480143.2000; val_optim_loss: 47480143.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9712; val_auprc_score: 0.9641; val_best_acc_score: 0.9224; val_best_f1_score: 0.9255; train_kl_reg_loss: 101265.6017; train_edge_recon_loss: 2727183.2347; train_gene_expr_recon_loss: 20706991.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24204938.5954; train_global_loss: 47740379.2672; train_optim_loss: 47740379.2672; val_kl_reg_loss: 98494.9948; val_edge_recon_loss: 2737568.7500; val_gene_expr_recon_loss: 20501829.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23996358.2667; val_global_loss: 47334252.2667; val_optim_loss: 47334252.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9782; val_auprc_score: 0.9750; val_best_acc_score: 0.9290; val_best_f1_score: 0.9305; train_kl_reg_loss: 99034.7548; train_edge_recon_loss: 2724690.2672; train_gene_expr_recon_loss: 20658029.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24166751.9847; train_global_loss: 47648506.4427; train_optim_loss: 47648506.4427; val_kl_reg_loss: 97357.8807; val_edge_recon_loss: 2710060.8833; val_gene_expr_recon_loss: 20449771.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 23952987.7333; val_global_loss: 47210177.8667; val_optim_loss: 47210177.8667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9733; val_auprc_score: 0.9671; val_best_acc_score: 0.9239; val_best_f1_score: 0.9267; train_kl_reg_loss: 97885.9190; train_edge_recon_loss: 2724867.3874; train_gene_expr_recon_loss: 20645770.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24180521.1756; train_global_loss: 47649044.3969; train_optim_loss: 47649044.3969; val_kl_reg_loss: 97926.0625; val_edge_recon_loss: 2731388.4167; val_gene_expr_recon_loss: 20545796.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24073729.4667; val_global_loss: 47448840.2667; val_optim_loss: 47448840.2667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9684; val_auprc_score: 0.9605; val_best_acc_score: 0.9132; val_best_f1_score: 0.9154; train_kl_reg_loss: 102316.7331; train_edge_recon_loss: 2863005.4466; train_gene_expr_recon_loss: 22214320.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24879608.9466; train_global_loss: 50059251.2977; train_optim_loss: 50059251.2977; val_kl_reg_loss: 39590.2177; val_edge_recon_loss: 2774453.4000; val_gene_expr_recon_loss: 21791699.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24579554.4000; val_global_loss: 49185297.3333; val_optim_loss: 49185297.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9706; val_auprc_score: 0.9657; val_best_acc_score: 0.9131; val_best_f1_score: 0.9158; train_kl_reg_loss: 94601.6412; train_edge_recon_loss: 2739192.5267; train_gene_expr_recon_loss: 21778026.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24643615.0840; train_global_loss: 49255436.1221; train_optim_loss: 49255436.1221; val_kl_reg_loss: 48686.5880; val_edge_recon_loss: 2747003.5667; val_gene_expr_recon_loss: 21534991.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24550524.0000; val_global_loss: 48881206.1333; val_optim_loss: 48881206.1333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9683; val_auprc_score: 0.9603; val_best_acc_score: 0.9162; val_best_f1_score: 0.9185; train_kl_reg_loss: 85454.0165; train_edge_recon_loss: 2725687.2233; train_gene_expr_recon_loss: 21638066.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24593351.9237; train_global_loss: 49042559.8168; train_optim_loss: 49042559.8168; val_kl_reg_loss: 54764.2799; val_edge_recon_loss: 2721293.8333; val_gene_expr_recon_loss: 21412413.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24429242.8000; val_global_loss: 48617715.2000; val_optim_loss: 48617715.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9708; val_auprc_score: 0.9640; val_best_acc_score: 0.9193; val_best_f1_score: 0.9214; train_kl_reg_loss: 82433.7094; train_edge_recon_loss: 2712741.5782; train_gene_expr_recon_loss: 21589136.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24606077.1450; train_global_loss: 48990388.9771; train_optim_loss: 48990388.9771; val_kl_reg_loss: 55338.9234; val_edge_recon_loss: 2704888.4500; val_gene_expr_recon_loss: 21363369.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24350896.6667; val_global_loss: 48474493.8667; val_optim_loss: 48474493.8667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9733; val_auprc_score: 0.9669; val_best_acc_score: 0.9221; val_best_f1_score: 0.9237; train_kl_reg_loss: 82402.9922; train_edge_recon_loss: 2717186.8550; train_gene_expr_recon_loss: 21537574.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24521921.1603; train_global_loss: 48859085.0687; train_optim_loss: 48859085.0687; val_kl_reg_loss: 55981.2281; val_edge_recon_loss: 2717289.0500; val_gene_expr_recon_loss: 21385354.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24429094.8000; val_global_loss: 48587719.2000; val_optim_loss: 48587719.2000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9708; val_auprc_score: 0.9641; val_best_acc_score: 0.9184; val_best_f1_score: 0.9205; train_kl_reg_loss: 81692.2281; train_edge_recon_loss: 2717779.0344; train_gene_expr_recon_loss: 21538999.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24538553.1145; train_global_loss: 48877023.6641; train_optim_loss: 48877023.6641; val_kl_reg_loss: 56430.9247; val_edge_recon_loss: 2729270.1500; val_gene_expr_recon_loss: 21304603.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24277202.8000; val_global_loss: 48367506.9333; val_optim_loss: 48367506.9333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9712; val_auprc_score: 0.9655; val_best_acc_score: 0.9179; val_best_f1_score: 0.9200; train_kl_reg_loss: 81092.3024; train_edge_recon_loss: 2713903.7844; train_gene_expr_recon_loss: 21533774.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24556001.3130; train_global_loss: 48884772.0000; train_optim_loss: 48884772.0000; val_kl_reg_loss: 57267.4286; val_edge_recon_loss: 2731091.2500; val_gene_expr_recon_loss: 21389220.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24484993.0667; val_global_loss: 48662572.0000; val_optim_loss: 48662572.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 35 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9736
val AUPRC score: 0.9665
val best accuracy score: 0.9233
val best F1 score: 0.9252
val target rna MSE score: 1.1594
val source rna MSE score: 1004.2573
val target atac MSE score: 0.3483
val source atac MSE score: 2.9566
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
