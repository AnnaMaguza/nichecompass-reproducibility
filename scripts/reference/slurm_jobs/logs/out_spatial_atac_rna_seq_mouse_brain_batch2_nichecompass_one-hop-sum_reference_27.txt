[True]
Run timestamp: 10082023_200347_27.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_27']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7422; val_auprc_score: 0.7758; val_best_acc_score: 0.5229; val_best_f1_score: 0.6739; train_kl_reg_loss: 106726.6044; train_edge_recon_loss: 3737223.6622; train_gene_expr_recon_loss: 26765150.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16331016.6641; train_global_loss: 46940117.7405; train_optim_loss: 46940117.7405; val_kl_reg_loss: 148352.3542; val_edge_recon_loss: 4063825.0833; val_gene_expr_recon_loss: 23295912.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15628177.1333; val_global_loss: 43136266.6667; val_optim_loss: 43136266.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8036; val_auprc_score: 0.8185; val_best_acc_score: 0.7086; val_best_f1_score: 0.7380; train_kl_reg_loss: 180076.3318; train_edge_recon_loss: 3589760.9714; train_gene_expr_recon_loss: 22618317.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15407935.1985; train_global_loss: 41796089.7710; train_optim_loss: 41796089.7710; val_kl_reg_loss: 202610.8646; val_edge_recon_loss: 4043726.6667; val_gene_expr_recon_loss: 22376537.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15397352.2000; val_global_loss: 42020227.7333; val_optim_loss: 42020227.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8925; val_auprc_score: 0.8870; val_best_acc_score: 0.8149; val_best_f1_score: 0.8254; train_kl_reg_loss: 154153.9766; train_edge_recon_loss: 3530654.2099; train_gene_expr_recon_loss: 22195970.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15278166.1450; train_global_loss: 41158944.8244; train_optim_loss: 41158944.8244; val_kl_reg_loss: 129990.9443; val_edge_recon_loss: 3712388.6833; val_gene_expr_recon_loss: 22181416.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15339369.8000; val_global_loss: 41363165.8667; val_optim_loss: 41363165.8667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9089; val_auprc_score: 0.8953; val_best_acc_score: 0.8309; val_best_f1_score: 0.8417; train_kl_reg_loss: 152604.0274; train_edge_recon_loss: 3134588.7214; train_gene_expr_recon_loss: 22007469.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15181687.8397; train_global_loss: 40476349.8626; train_optim_loss: 40476349.8626; val_kl_reg_loss: 176372.6781; val_edge_recon_loss: 2974691.4000; val_gene_expr_recon_loss: 21938697.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15147172.2000; val_global_loss: 40236933.8667; val_optim_loss: 40236933.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9230; val_auprc_score: 0.9080; val_best_acc_score: 0.8530; val_best_f1_score: 0.8633; train_kl_reg_loss: 175745.3055; train_edge_recon_loss: 2925625.6069; train_gene_expr_recon_loss: 21823292.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15092312.2366; train_global_loss: 40016975.6947; train_optim_loss: 40016975.6947; val_kl_reg_loss: 171168.3635; val_edge_recon_loss: 2916106.7667; val_gene_expr_recon_loss: 21911560.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15195839.8667; val_global_loss: 40194676.0000; val_optim_loss: 40194676.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9293; val_auprc_score: 0.9161; val_best_acc_score: 0.8623; val_best_f1_score: 0.8711; train_kl_reg_loss: 165769.7254; train_edge_recon_loss: 2891888.6412; train_gene_expr_recon_loss: 21650158.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14999403.4351; train_global_loss: 39707220.0305; train_optim_loss: 39707220.0305; val_kl_reg_loss: 163572.8219; val_edge_recon_loss: 2883526.4833; val_gene_expr_recon_loss: 21641028.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14997388.3333; val_global_loss: 39685516.8000; val_optim_loss: 39685516.8000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9395; val_auprc_score: 0.9294; val_best_acc_score: 0.8740; val_best_f1_score: 0.8800; train_kl_reg_loss: 156421.8288; train_edge_recon_loss: 2866552.4981; train_gene_expr_recon_loss: 21558905.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14946799.5038; train_global_loss: 39528679.2672; train_optim_loss: 39528679.2672; val_kl_reg_loss: 151068.9438; val_edge_recon_loss: 2856202.6167; val_gene_expr_recon_loss: 21554008.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15021888.2000; val_global_loss: 39583168.5333; val_optim_loss: 39583168.5333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9397; val_auprc_score: 0.9277; val_best_acc_score: 0.8754; val_best_f1_score: 0.8814; train_kl_reg_loss: 148442.2693; train_edge_recon_loss: 2844244.7844; train_gene_expr_recon_loss: 21425319.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14892637.5038; train_global_loss: 39310644.2443; train_optim_loss: 39310644.2443; val_kl_reg_loss: 144029.7125; val_edge_recon_loss: 2859303.9833; val_gene_expr_recon_loss: 21489686.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14989448.7333; val_global_loss: 39482468.5333; val_optim_loss: 39482468.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9474; val_auprc_score: 0.9375; val_best_acc_score: 0.8832; val_best_f1_score: 0.8890; train_kl_reg_loss: 140825.5841; train_edge_recon_loss: 2831507.9885; train_gene_expr_recon_loss: 21345378.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14849935.6336; train_global_loss: 39167648.0916; train_optim_loss: 39167648.0916; val_kl_reg_loss: 136780.4443; val_edge_recon_loss: 2844376.6000; val_gene_expr_recon_loss: 21393177.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14893813.7333; val_global_loss: 39268148.2667; val_optim_loss: 39268148.2667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9478; val_auprc_score: 0.9366; val_best_acc_score: 0.8863; val_best_f1_score: 0.8915; train_kl_reg_loss: 136031.0431; train_edge_recon_loss: 2811803.0248; train_gene_expr_recon_loss: 21254908.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14811591.7634; train_global_loss: 39014334.9924; train_optim_loss: 39014334.9924; val_kl_reg_loss: 135946.2281; val_edge_recon_loss: 2822288.7833; val_gene_expr_recon_loss: 21392594.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14918275.2000; val_global_loss: 39269104.8000; val_optim_loss: 39269104.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9536; val_auprc_score: 0.9438; val_best_acc_score: 0.8918; val_best_f1_score: 0.8966; train_kl_reg_loss: 131012.8421; train_edge_recon_loss: 2794162.0229; train_gene_expr_recon_loss: 21188162.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14775176.4122; train_global_loss: 38888513.8626; train_optim_loss: 38888513.8626; val_kl_reg_loss: 130832.7458; val_edge_recon_loss: 2782813.7167; val_gene_expr_recon_loss: 21321323.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14899491.6667; val_global_loss: 39134461.8667; val_optim_loss: 39134461.8667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9580; val_auprc_score: 0.9488; val_best_acc_score: 0.8950; val_best_f1_score: 0.8998; train_kl_reg_loss: 126829.7423; train_edge_recon_loss: 2786892.2271; train_gene_expr_recon_loss: 21144570.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14762264.0534; train_global_loss: 38820556.4275; train_optim_loss: 38820556.4275; val_kl_reg_loss: 127726.7063; val_edge_recon_loss: 2783303.1500; val_gene_expr_recon_loss: 21188891.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14850639.2000; val_global_loss: 38950560.0000; val_optim_loss: 38950560.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9628; val_auprc_score: 0.9549; val_best_acc_score: 0.9039; val_best_f1_score: 0.9091; train_kl_reg_loss: 123689.4238; train_edge_recon_loss: 2774346.5782; train_gene_expr_recon_loss: 21068796.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14715549.1450; train_global_loss: 38682381.4046; train_optim_loss: 38682381.4046; val_kl_reg_loss: 122438.9536; val_edge_recon_loss: 2772427.7333; val_gene_expr_recon_loss: 21123358.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14804682.9333; val_global_loss: 38822907.7333; val_optim_loss: 38822907.7333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9654; val_auprc_score: 0.9565; val_best_acc_score: 0.9086; val_best_f1_score: 0.9127; train_kl_reg_loss: 120242.7726; train_edge_recon_loss: 2766050.2595; train_gene_expr_recon_loss: 20967532.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14659274.1679; train_global_loss: 38513099.5420; train_optim_loss: 38513099.5420; val_kl_reg_loss: 119706.4937; val_edge_recon_loss: 2761466.2500; val_gene_expr_recon_loss: 21120498.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14765375.8667; val_global_loss: 38767047.2000; val_optim_loss: 38767047.2000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9648; val_auprc_score: 0.9523; val_best_acc_score: 0.9111; val_best_f1_score: 0.9135; train_kl_reg_loss: 117344.6913; train_edge_recon_loss: 2753133.3645; train_gene_expr_recon_loss: 20943051.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14656680.3282; train_global_loss: 38470209.6183; train_optim_loss: 38470209.6183; val_kl_reg_loss: 118423.5307; val_edge_recon_loss: 2762220.0833; val_gene_expr_recon_loss: 21032974.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14779766.1333; val_global_loss: 38693384.2667; val_optim_loss: 38693384.2667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9683; val_auprc_score: 0.9614; val_best_acc_score: 0.9126; val_best_f1_score: 0.9162; train_kl_reg_loss: 114291.7728; train_edge_recon_loss: 2744867.7672; train_gene_expr_recon_loss: 20899534.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14626882.5344; train_global_loss: 38385576.4885; train_optim_loss: 38385576.4885; val_kl_reg_loss: 115009.1443; val_edge_recon_loss: 2748768.4500; val_gene_expr_recon_loss: 20930746.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14706819.4000; val_global_loss: 38501343.4667; val_optim_loss: 38501343.4667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9681; val_auprc_score: 0.9609; val_best_acc_score: 0.9142; val_best_f1_score: 0.9165; train_kl_reg_loss: 112597.0197; train_edge_recon_loss: 2739646.6164; train_gene_expr_recon_loss: 20844313.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14608827.0534; train_global_loss: 38305384.0305; train_optim_loss: 38305384.0305; val_kl_reg_loss: 111383.3797; val_edge_recon_loss: 2758727.5500; val_gene_expr_recon_loss: 20963779.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14711035.8000; val_global_loss: 38544926.1333; val_optim_loss: 38544926.1333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9693; val_auprc_score: 0.9621; val_best_acc_score: 0.9182; val_best_f1_score: 0.9211; train_kl_reg_loss: 109156.0621; train_edge_recon_loss: 2732992.6966; train_gene_expr_recon_loss: 20790412.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14583186.6794; train_global_loss: 38215747.7252; train_optim_loss: 38215747.7252; val_kl_reg_loss: 110571.9661; val_edge_recon_loss: 2742046.0667; val_gene_expr_recon_loss: 20832387.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14641346.5333; val_global_loss: 38326352.0000; val_optim_loss: 38326352.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9745; val_auprc_score: 0.9682; val_best_acc_score: 0.9244; val_best_f1_score: 0.9267; train_kl_reg_loss: 107227.5428; train_edge_recon_loss: 2731311.9847; train_gene_expr_recon_loss: 20743204.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14558764.3893; train_global_loss: 38140508.4580; train_optim_loss: 38140508.4580; val_kl_reg_loss: 104813.1792; val_edge_recon_loss: 2723093.6667; val_gene_expr_recon_loss: 20834912.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14659657.4000; val_global_loss: 38322476.8000; val_optim_loss: 38322476.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9756; val_auprc_score: 0.9699; val_best_acc_score: 0.9279; val_best_f1_score: 0.9298; train_kl_reg_loss: 104355.0456; train_edge_recon_loss: 2732167.9771; train_gene_expr_recon_loss: 20699167.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14547424.3053; train_global_loss: 38083114.6870; train_optim_loss: 38083114.6870; val_kl_reg_loss: 105582.4641; val_edge_recon_loss: 2727241.1000; val_gene_expr_recon_loss: 20793609.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14639764.0000; val_global_loss: 38266196.8000; val_optim_loss: 38266196.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9760; val_auprc_score: 0.9709; val_best_acc_score: 0.9283; val_best_f1_score: 0.9299; train_kl_reg_loss: 102951.3002; train_edge_recon_loss: 2724241.9828; train_gene_expr_recon_loss: 20673539.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14546878.7939; train_global_loss: 38047611.9389; train_optim_loss: 38047611.9389; val_kl_reg_loss: 104019.8016; val_edge_recon_loss: 2719651.8833; val_gene_expr_recon_loss: 20760251.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14676039.8667; val_global_loss: 38259962.9333; val_optim_loss: 38259962.9333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9758; val_auprc_score: 0.9686; val_best_acc_score: 0.9283; val_best_f1_score: 0.9299; train_kl_reg_loss: 101581.5415; train_edge_recon_loss: 2720023.0763; train_gene_expr_recon_loss: 20603445.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14498118.0000; train_global_loss: 37923167.5725; train_optim_loss: 37923167.5725; val_kl_reg_loss: 103894.5068; val_edge_recon_loss: 2712995.3000; val_gene_expr_recon_loss: 20728796.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14627465.2667; val_global_loss: 38173150.6667; val_optim_loss: 38173150.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9793; val_auprc_score: 0.9738; val_best_acc_score: 0.9322; val_best_f1_score: 0.9335; train_kl_reg_loss: 99811.6464; train_edge_recon_loss: 2710419.3664; train_gene_expr_recon_loss: 20599355.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14509551.7863; train_global_loss: 37919138.1069; train_optim_loss: 37919138.1069; val_kl_reg_loss: 101201.9833; val_edge_recon_loss: 2719333.9667; val_gene_expr_recon_loss: 20704837.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14609724.2667; val_global_loss: 38135096.5333; val_optim_loss: 38135096.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9783; val_auprc_score: 0.9734; val_best_acc_score: 0.9332; val_best_f1_score: 0.9352; train_kl_reg_loss: 97972.2214; train_edge_recon_loss: 2712424.4160; train_gene_expr_recon_loss: 20549797.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14488818.0153; train_global_loss: 37849012.0000; train_optim_loss: 37849012.0000; val_kl_reg_loss: 98986.1953; val_edge_recon_loss: 2712356.6333; val_gene_expr_recon_loss: 20713573.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14580896.6000; val_global_loss: 38105812.5333; val_optim_loss: 38105812.5333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9815; val_auprc_score: 0.9781; val_best_acc_score: 0.9371; val_best_f1_score: 0.9391; train_kl_reg_loss: 96365.5254; train_edge_recon_loss: 2710751.0076; train_gene_expr_recon_loss: 20500533.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14464423.8168; train_global_loss: 37772073.8321; train_optim_loss: 37772073.8321; val_kl_reg_loss: 97648.7479; val_edge_recon_loss: 2707275.0000; val_gene_expr_recon_loss: 20654870.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14564031.4667; val_global_loss: 38023824.5333; val_optim_loss: 38023824.5333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9769; val_auprc_score: 0.9720; val_best_acc_score: 0.9259; val_best_f1_score: 0.9283; train_kl_reg_loss: 99050.2131; train_edge_recon_loss: 2746747.2214; train_gene_expr_recon_loss: 21493023.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14787505.5573; train_global_loss: 39126326.3817; train_optim_loss: 39126326.3817; val_kl_reg_loss: 45440.6794; val_edge_recon_loss: 2752716.5667; val_gene_expr_recon_loss: 21625464.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14904234.6667; val_global_loss: 39327856.2667; val_optim_loss: 39327856.2667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9776; val_auprc_score: 0.9720; val_best_acc_score: 0.9301; val_best_f1_score: 0.9319; train_kl_reg_loss: 103579.1302; train_edge_recon_loss: 2736861.4580; train_gene_expr_recon_loss: 21696152.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14787604.6031; train_global_loss: 39324198.1069; train_optim_loss: 39324198.1069; val_kl_reg_loss: 38798.0482; val_edge_recon_loss: 2735784.7500; val_gene_expr_recon_loss: 22055731.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14886971.8000; val_global_loss: 39717286.6667; val_optim_loss: 39717286.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9756; val_auprc_score: 0.9706; val_best_acc_score: 0.9232; val_best_f1_score: 0.9254; train_kl_reg_loss: 109566.0129; train_edge_recon_loss: 2749426.6489; train_gene_expr_recon_loss: 22093897.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14856835.9695; train_global_loss: 39809726.0153; train_optim_loss: 39809726.0153; val_kl_reg_loss: 32640.2384; val_edge_recon_loss: 2753917.3500; val_gene_expr_recon_loss: 22276481.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14998121.4667; val_global_loss: 40061160.8000; val_optim_loss: 40061160.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9614; val_auprc_score: 0.9517; val_best_acc_score: 0.9031; val_best_f1_score: 0.9056; train_kl_reg_loss: 98985.5690; train_edge_recon_loss: 2750239.0286; train_gene_expr_recon_loss: 22255605.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14851506.8626; train_global_loss: 39956337.3130; train_optim_loss: 39956337.3130; val_kl_reg_loss: 21753.2717; val_edge_recon_loss: 2814799.2667; val_gene_expr_recon_loss: 22636885.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14954370.8667; val_global_loss: 40427809.0667; val_optim_loss: 40427809.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9631; val_auprc_score: 0.9533; val_best_acc_score: 0.9051; val_best_f1_score: 0.9089; train_kl_reg_loss: 103823.7740; train_edge_recon_loss: 2779155.7099; train_gene_expr_recon_loss: 22677321.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14894078.3511; train_global_loss: 40454379.3893; train_optim_loss: 40454379.3893; val_kl_reg_loss: 23620.8776; val_edge_recon_loss: 2791158.8000; val_gene_expr_recon_loss: 22801950.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14973165.1333; val_global_loss: 40589895.4667; val_optim_loss: 40589895.4667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9660; val_auprc_score: 0.9572; val_best_acc_score: 0.9073; val_best_f1_score: 0.9105; train_kl_reg_loss: 99085.5824; train_edge_recon_loss: 2775626.2252; train_gene_expr_recon_loss: 22679769.2977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14898397.4733; train_global_loss: 40452878.6565; train_optim_loss: 40452878.6565; val_kl_reg_loss: 24399.6237; val_edge_recon_loss: 2787328.4500; val_gene_expr_recon_loss: 22866245.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15042208.0000; val_global_loss: 40720181.0667; val_optim_loss: 40720181.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9634; val_auprc_score: 0.9551; val_best_acc_score: 0.9088; val_best_f1_score: 0.9130; train_kl_reg_loss: 94827.0550; train_edge_recon_loss: 2766139.0859; train_gene_expr_recon_loss: 22644048.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14895086.5649; train_global_loss: 40400101.3130; train_optim_loss: 40400101.3130; val_kl_reg_loss: 25602.9354; val_edge_recon_loss: 2775103.2333; val_gene_expr_recon_loss: 22724871.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14986901.8667; val_global_loss: 40512478.6667; val_optim_loss: 40512478.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9643; val_auprc_score: 0.9554; val_best_acc_score: 0.9084; val_best_f1_score: 0.9101; train_kl_reg_loss: 91646.4696; train_edge_recon_loss: 2754581.5763; train_gene_expr_recon_loss: 22635892.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14903933.4504; train_global_loss: 40386053.8931; train_optim_loss: 40386053.8931; val_kl_reg_loss: 26535.5883; val_edge_recon_loss: 2751175.6500; val_gene_expr_recon_loss: 22708459.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14966369.0000; val_global_loss: 40452539.4667; val_optim_loss: 40452539.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9775
val AUPRC score: 0.9730
val best accuracy score: 0.9278
val best F1 score: 0.9301
val target rna MSE score: 1.2696
val source rna MSE score: 85.9007
val target atac MSE score: 0.3571
val source atac MSE score: 3.0698
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
