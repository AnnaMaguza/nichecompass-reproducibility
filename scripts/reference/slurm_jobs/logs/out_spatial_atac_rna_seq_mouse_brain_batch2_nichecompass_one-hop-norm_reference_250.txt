[True]
Run timestamp: 10102023_112919_250.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_250']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7786; val_auprc_score: 0.7963; val_best_acc_score: 0.5256; val_best_f1_score: 0.6769; train_kl_reg_loss: 67144.6007; train_edge_recon_loss: 747423.8130; train_gene_expr_recon_loss: 22029162.4122; train_masked_gp_l1_reg_loss: 134863.5356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3297787.9218; train_chrom_access_recon_loss: 4755911.6336; train_global_loss: 31032293.8626; train_optim_loss: 31032293.8626; val_kl_reg_loss: 76981.6031; val_edge_recon_loss: 812678.7958; val_gene_expr_recon_loss: 20885397.7333; val_masked_gp_l1_reg_loss: 104491.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 783655.6250; val_chrom_access_recon_loss: 4650339.9000; val_global_loss: 27313545.4667; val_optim_loss: 27313545.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8558; val_auprc_score: 0.8621; val_best_acc_score: 0.7809; val_best_f1_score: 0.7821; train_kl_reg_loss: 77820.8069; train_edge_recon_loss: 736304.6002; train_gene_expr_recon_loss: 20837182.4885; train_masked_gp_l1_reg_loss: 101484.3802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 391113.6998; train_chrom_access_recon_loss: 4579570.4256; train_global_loss: 26723476.1679; train_optim_loss: 26723476.1679; val_kl_reg_loss: 66671.7549; val_edge_recon_loss: 799790.1042; val_gene_expr_recon_loss: 20598741.0667; val_masked_gp_l1_reg_loss: 101662.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 208222.9844; val_chrom_access_recon_loss: 4609232.2333; val_global_loss: 26384319.3333; val_optim_loss: 26384319.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9164; val_auprc_score: 0.9072; val_best_acc_score: 0.8424; val_best_f1_score: 0.8503; train_kl_reg_loss: 67702.1595; train_edge_recon_loss: 718337.4652; train_gene_expr_recon_loss: 20578459.5115; train_masked_gp_l1_reg_loss: 102985.6102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159203.8412; train_chrom_access_recon_loss: 4532968.7996; train_global_loss: 26159657.4046; train_optim_loss: 26159657.4046; val_kl_reg_loss: 65500.2672; val_edge_recon_loss: 731402.3583; val_gene_expr_recon_loss: 20416841.6000; val_masked_gp_l1_reg_loss: 104186.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130968.3516; val_chrom_access_recon_loss: 4553102.4500; val_global_loss: 26002000.6667; val_optim_loss: 26002000.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9189; val_auprc_score: 0.9060; val_best_acc_score: 0.8434; val_best_f1_score: 0.8531; train_kl_reg_loss: 73381.5819; train_edge_recon_loss: 656774.1269; train_gene_expr_recon_loss: 20355830.1221; train_masked_gp_l1_reg_loss: 106588.5502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127286.7318; train_chrom_access_recon_loss: 4488183.0458; train_global_loss: 25808044.1985; train_optim_loss: 25808044.1985; val_kl_reg_loss: 77276.9563; val_edge_recon_loss: 633879.5625; val_gene_expr_recon_loss: 20209818.6667; val_masked_gp_l1_reg_loss: 108714.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126547.2812; val_chrom_access_recon_loss: 4504068.6167; val_global_loss: 25660305.7333; val_optim_loss: 25660305.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9253; val_auprc_score: 0.9144; val_best_acc_score: 0.8515; val_best_f1_score: 0.8597; train_kl_reg_loss: 78568.3167; train_edge_recon_loss: 622374.1985; train_gene_expr_recon_loss: 20138733.2366; train_masked_gp_l1_reg_loss: 110261.2728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119760.7434; train_chrom_access_recon_loss: 4449218.9752; train_global_loss: 25518916.8550; train_optim_loss: 25518916.8550; val_kl_reg_loss: 77001.5682; val_edge_recon_loss: 619152.4000; val_gene_expr_recon_loss: 19954310.8000; val_masked_gp_l1_reg_loss: 111660.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112822.4297; val_chrom_access_recon_loss: 4451534.1333; val_global_loss: 25326480.6667; val_optim_loss: 25326480.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9346; val_auprc_score: 0.9211; val_best_acc_score: 0.8669; val_best_f1_score: 0.8737; train_kl_reg_loss: 76444.4476; train_edge_recon_loss: 614296.3669; train_gene_expr_recon_loss: 19994070.5954; train_masked_gp_l1_reg_loss: 113197.9759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109763.4585; train_chrom_access_recon_loss: 4418903.6775; train_global_loss: 25326676.5344; train_optim_loss: 25326676.5344; val_kl_reg_loss: 76409.2083; val_edge_recon_loss: 609638.4167; val_gene_expr_recon_loss: 19837546.4000; val_masked_gp_l1_reg_loss: 114657.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107935.5781; val_chrom_access_recon_loss: 4445268.5333; val_global_loss: 25191456.9333; val_optim_loss: 25191456.9333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9347; val_auprc_score: 0.9217; val_best_acc_score: 0.8647; val_best_f1_score: 0.8702; train_kl_reg_loss: 75330.8683; train_edge_recon_loss: 609881.0253; train_gene_expr_recon_loss: 19842863.4046; train_masked_gp_l1_reg_loss: 115132.6642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104506.0659; train_chrom_access_recon_loss: 4385945.2653; train_global_loss: 25133659.3588; train_optim_loss: 25133659.3588; val_kl_reg_loss: 74278.2870; val_edge_recon_loss: 609591.2500; val_gene_expr_recon_loss: 19757238.5333; val_masked_gp_l1_reg_loss: 115762.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101996.6016; val_chrom_access_recon_loss: 4414738.9167; val_global_loss: 25073605.2000; val_optim_loss: 25073605.2000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9401; val_auprc_score: 0.9284; val_best_acc_score: 0.8694; val_best_f1_score: 0.8753; train_kl_reg_loss: 73992.3587; train_edge_recon_loss: 605073.4804; train_gene_expr_recon_loss: 19709639.9695; train_masked_gp_l1_reg_loss: 116535.3573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100022.3838; train_chrom_access_recon_loss: 4356577.7538; train_global_loss: 24961841.2214; train_optim_loss: 24961841.2214; val_kl_reg_loss: 73667.4115; val_edge_recon_loss: 610012.2042; val_gene_expr_recon_loss: 19646414.0000; val_masked_gp_l1_reg_loss: 117422.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97654.1875; val_chrom_access_recon_loss: 4399278.7500; val_global_loss: 24944448.4000; val_optim_loss: 24944448.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9446; val_auprc_score: 0.9309; val_best_acc_score: 0.8798; val_best_f1_score: 0.8856; train_kl_reg_loss: 72683.0296; train_edge_recon_loss: 601899.7233; train_gene_expr_recon_loss: 19602931.2366; train_masked_gp_l1_reg_loss: 117725.0143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95703.0384; train_chrom_access_recon_loss: 4333591.6355; train_global_loss: 24824533.7557; train_optim_loss: 24824533.7557; val_kl_reg_loss: 72359.1245; val_edge_recon_loss: 599831.7333; val_gene_expr_recon_loss: 19436106.9333; val_masked_gp_l1_reg_loss: 118639.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94532.5625; val_chrom_access_recon_loss: 4347690.7333; val_global_loss: 24669160.6667; val_optim_loss: 24669160.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9480; val_auprc_score: 0.9341; val_best_acc_score: 0.8818; val_best_f1_score: 0.8871; train_kl_reg_loss: 71465.7439; train_edge_recon_loss: 600165.5358; train_gene_expr_recon_loss: 19517760.2595; train_masked_gp_l1_reg_loss: 118931.2281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92605.0246; train_chrom_access_recon_loss: 4305960.1947; train_global_loss: 24706888.0000; train_optim_loss: 24706888.0000; val_kl_reg_loss: 70680.0125; val_edge_recon_loss: 597938.0542; val_gene_expr_recon_loss: 19403503.2000; val_masked_gp_l1_reg_loss: 119525.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91555.5547; val_chrom_access_recon_loss: 4333656.7833; val_global_loss: 24616860.0000; val_optim_loss: 24616860.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9560; val_auprc_score: 0.9481; val_best_acc_score: 0.8930; val_best_f1_score: 0.8975; train_kl_reg_loss: 70727.4997; train_edge_recon_loss: 597192.1384; train_gene_expr_recon_loss: 19450512.9924; train_masked_gp_l1_reg_loss: 119980.7158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89862.7613; train_chrom_access_recon_loss: 4289472.7939; train_global_loss: 24617748.8550; train_optim_loss: 24617748.8550; val_kl_reg_loss: 71450.0698; val_edge_recon_loss: 598813.6167; val_gene_expr_recon_loss: 19352484.4000; val_masked_gp_l1_reg_loss: 120612.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88789.2031; val_chrom_access_recon_loss: 4336148.1500; val_global_loss: 24568297.8667; val_optim_loss: 24568297.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9545; val_auprc_score: 0.9432; val_best_acc_score: 0.8909; val_best_f1_score: 0.8956; train_kl_reg_loss: 69824.6097; train_edge_recon_loss: 596062.4547; train_gene_expr_recon_loss: 19362045.1450; train_masked_gp_l1_reg_loss: 120812.7789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87729.5139; train_chrom_access_recon_loss: 4261033.7214; train_global_loss: 24497508.2290; train_optim_loss: 24497508.2290; val_kl_reg_loss: 68942.6771; val_edge_recon_loss: 598042.5792; val_gene_expr_recon_loss: 19284567.4667; val_masked_gp_l1_reg_loss: 121395.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87440.8906; val_chrom_access_recon_loss: 4320033.5000; val_global_loss: 24480422.1333; val_optim_loss: 24480422.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9602; val_auprc_score: 0.9488; val_best_acc_score: 0.8994; val_best_f1_score: 0.9022; train_kl_reg_loss: 69367.5805; train_edge_recon_loss: 593509.9599; train_gene_expr_recon_loss: 19284468.6260; train_masked_gp_l1_reg_loss: 121825.6629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85862.5280; train_chrom_access_recon_loss: 4239540.6947; train_global_loss: 24394575.1450; train_optim_loss: 24394575.1450; val_kl_reg_loss: 69497.3833; val_edge_recon_loss: 594976.1000; val_gene_expr_recon_loss: 19158670.4000; val_masked_gp_l1_reg_loss: 122638.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85942.1719; val_chrom_access_recon_loss: 4285621.3667; val_global_loss: 24317345.0667; val_optim_loss: 24317345.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9612; val_auprc_score: 0.9532; val_best_acc_score: 0.9014; val_best_f1_score: 0.9061; train_kl_reg_loss: 68754.6738; train_edge_recon_loss: 593245.9504; train_gene_expr_recon_loss: 19213769.7099; train_masked_gp_l1_reg_loss: 122877.4306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84654.4731; train_chrom_access_recon_loss: 4214686.3645; train_global_loss: 24297988.6412; train_optim_loss: 24297988.6412; val_kl_reg_loss: 67070.9849; val_edge_recon_loss: 594708.8042; val_gene_expr_recon_loss: 19083630.4000; val_masked_gp_l1_reg_loss: 123576.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84312.7422; val_chrom_access_recon_loss: 4242140.7167; val_global_loss: 24195438.5333; val_optim_loss: 24195438.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9616; val_auprc_score: 0.9519; val_best_acc_score: 0.9042; val_best_f1_score: 0.9071; train_kl_reg_loss: 68100.9535; train_edge_recon_loss: 590999.8273; train_gene_expr_recon_loss: 19118080.7634; train_masked_gp_l1_reg_loss: 123834.1471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83376.2140; train_chrom_access_recon_loss: 4184773.7672; train_global_loss: 24169165.6641; train_optim_loss: 24169165.6641; val_kl_reg_loss: 66932.8240; val_edge_recon_loss: 592349.8208; val_gene_expr_recon_loss: 19026166.5333; val_masked_gp_l1_reg_loss: 124438.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83314.6797; val_chrom_access_recon_loss: 4218098.8000; val_global_loss: 24111299.6000; val_optim_loss: 24111299.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9620; val_auprc_score: 0.9538; val_best_acc_score: 0.9066; val_best_f1_score: 0.9096; train_kl_reg_loss: 67577.4073; train_edge_recon_loss: 590521.1326; train_gene_expr_recon_loss: 19070734.9618; train_masked_gp_l1_reg_loss: 124910.9745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82452.7746; train_chrom_access_recon_loss: 4162917.1737; train_global_loss: 24099114.5191; train_optim_loss: 24099114.5191; val_kl_reg_loss: 66944.6125; val_edge_recon_loss: 590813.4917; val_gene_expr_recon_loss: 19056711.6000; val_masked_gp_l1_reg_loss: 125504.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81938.7969; val_chrom_access_recon_loss: 4248220.7667; val_global_loss: 24170132.6667; val_optim_loss: 24170132.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9626; val_auprc_score: 0.9529; val_best_acc_score: 0.9103; val_best_f1_score: 0.9127; train_kl_reg_loss: 66962.8523; train_edge_recon_loss: 589224.5329; train_gene_expr_recon_loss: 19019196.7481; train_masked_gp_l1_reg_loss: 126186.2012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81660.8681; train_chrom_access_recon_loss: 4139733.7500; train_global_loss: 24022964.9008; train_optim_loss: 24022964.9008; val_kl_reg_loss: 67370.3070; val_edge_recon_loss: 590839.2792; val_gene_expr_recon_loss: 18974916.1333; val_masked_gp_l1_reg_loss: 127345.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82777.2812; val_chrom_access_recon_loss: 4192340.0333; val_global_loss: 24035589.7333; val_optim_loss: 24035589.7333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9623; val_auprc_score: 0.9541; val_best_acc_score: 0.9041; val_best_f1_score: 0.9082; train_kl_reg_loss: 66465.7770; train_edge_recon_loss: 589128.2471; train_gene_expr_recon_loss: 18946364.9160; train_masked_gp_l1_reg_loss: 127550.9108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81560.2943; train_chrom_access_recon_loss: 4114453.7328; train_global_loss: 23925523.8931; train_optim_loss: 23925523.8931; val_kl_reg_loss: 65890.1766; val_edge_recon_loss: 592325.5958; val_gene_expr_recon_loss: 18858069.7333; val_masked_gp_l1_reg_loss: 128101.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81908.7578; val_chrom_access_recon_loss: 4182581.9833; val_global_loss: 23908877.2000; val_optim_loss: 23908877.2000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9599; val_auprc_score: 0.9475; val_best_acc_score: 0.9041; val_best_f1_score: 0.9090; train_kl_reg_loss: 65912.5267; train_edge_recon_loss: 589745.6546; train_gene_expr_recon_loss: 18888715.8168; train_masked_gp_l1_reg_loss: 128885.9092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81359.8808; train_chrom_access_recon_loss: 4087221.4389; train_global_loss: 23841841.2366; train_optim_loss: 23841841.2366; val_kl_reg_loss: 66471.4768; val_edge_recon_loss: 591444.5125; val_gene_expr_recon_loss: 18828897.2000; val_masked_gp_l1_reg_loss: 129773.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81567.1875; val_chrom_access_recon_loss: 4142360.1667; val_global_loss: 23840515.4667; val_optim_loss: 23840515.4667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9619; val_auprc_score: 0.9504; val_best_acc_score: 0.9091; val_best_f1_score: 0.9122; train_kl_reg_loss: 66664.9541; train_edge_recon_loss: 587082.0706; train_gene_expr_recon_loss: 18818267.1908; train_masked_gp_l1_reg_loss: 130346.7273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81142.1271; train_chrom_access_recon_loss: 4058057.7405; train_global_loss: 23741561.0992; train_optim_loss: 23741561.0992; val_kl_reg_loss: 66282.4682; val_edge_recon_loss: 588374.7167; val_gene_expr_recon_loss: 18746070.6667; val_masked_gp_l1_reg_loss: 130847.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80926.1094; val_chrom_access_recon_loss: 4108654.0667; val_global_loss: 23721156.2667; val_optim_loss: 23721156.2667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9645; val_auprc_score: 0.9532; val_best_acc_score: 0.9131; val_best_f1_score: 0.9160; train_kl_reg_loss: 66499.6258; train_edge_recon_loss: 588627.3430; train_gene_expr_recon_loss: 18748296.0458; train_masked_gp_l1_reg_loss: 131607.3581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80971.2084; train_chrom_access_recon_loss: 4025594.2882; train_global_loss: 23641595.8779; train_optim_loss: 23641595.8779; val_kl_reg_loss: 67727.4646; val_edge_recon_loss: 588672.3083; val_gene_expr_recon_loss: 18813997.3333; val_masked_gp_l1_reg_loss: 132339.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81620.7422; val_chrom_access_recon_loss: 4126937.1833; val_global_loss: 23811294.4000; val_optim_loss: 23811294.4000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9581; val_auprc_score: 0.9457; val_best_acc_score: 0.9069; val_best_f1_score: 0.9107; train_kl_reg_loss: 66829.5610; train_edge_recon_loss: 589064.5673; train_gene_expr_recon_loss: 18679647.7557; train_masked_gp_l1_reg_loss: 132967.6297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81150.1458; train_chrom_access_recon_loss: 3994272.6355; train_global_loss: 23543932.2748; train_optim_loss: 23543932.2748; val_kl_reg_loss: 64881.5107; val_edge_recon_loss: 589656.9250; val_gene_expr_recon_loss: 18726976.2667; val_masked_gp_l1_reg_loss: 133713.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81618.4453; val_chrom_access_recon_loss: 4094154.0000; val_global_loss: 23691000.5333; val_optim_loss: 23691000.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9615; val_auprc_score: 0.9511; val_best_acc_score: 0.9099; val_best_f1_score: 0.9135; train_kl_reg_loss: 66800.0530; train_edge_recon_loss: 587919.4232; train_gene_expr_recon_loss: 18616545.2214; train_masked_gp_l1_reg_loss: 134232.3672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81216.1845; train_chrom_access_recon_loss: 3964550.6679; train_global_loss: 23451263.8168; train_optim_loss: 23451263.8168; val_kl_reg_loss: 65876.5753; val_edge_recon_loss: 590305.5583; val_gene_expr_recon_loss: 18564956.4000; val_masked_gp_l1_reg_loss: 134712.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81566.0781; val_chrom_access_recon_loss: 4039284.3667; val_global_loss: 23476700.5333; val_optim_loss: 23476700.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9582; val_auprc_score: 0.9463; val_best_acc_score: 0.9046; val_best_f1_score: 0.9084; train_kl_reg_loss: 67259.9283; train_edge_recon_loss: 586990.6947; train_gene_expr_recon_loss: 18569120.7786; train_masked_gp_l1_reg_loss: 135375.0341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81646.0765; train_chrom_access_recon_loss: 3939059.8969; train_global_loss: 23379452.6107; train_optim_loss: 23379452.6107; val_kl_reg_loss: 67186.2630; val_edge_recon_loss: 594177.2792; val_gene_expr_recon_loss: 18583370.4000; val_masked_gp_l1_reg_loss: 135898.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82320.0625; val_chrom_access_recon_loss: 4034051.8167; val_global_loss: 23497004.2667; val_optim_loss: 23497004.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9612; val_auprc_score: 0.9524; val_best_acc_score: 0.9064; val_best_f1_score: 0.9109; train_kl_reg_loss: 67185.6496; train_edge_recon_loss: 588252.6951; train_gene_expr_recon_loss: 18521120.8550; train_masked_gp_l1_reg_loss: 136389.4530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81930.7625; train_chrom_access_recon_loss: 3909047.7347; train_global_loss: 23303927.1603; train_optim_loss: 23303927.1603; val_kl_reg_loss: 66839.5391; val_edge_recon_loss: 591770.7750; val_gene_expr_recon_loss: 18527100.0000; val_masked_gp_l1_reg_loss: 136862.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82453.5078; val_chrom_access_recon_loss: 4005988.8000; val_global_loss: 23411014.8000; val_optim_loss: 23411014.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9137; val_auprc_score: 0.9013; val_best_acc_score: 0.8289; val_best_f1_score: 0.8416; train_kl_reg_loss: 96148.3717; train_edge_recon_loss: 719394.4680; train_gene_expr_recon_loss: 17654535.9847; train_masked_gp_l1_reg_loss: 134971.9004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77727.2960; train_chrom_access_recon_loss: 3928081.3817; train_global_loss: 22610859.4962; train_optim_loss: 22610859.4962; val_kl_reg_loss: 19286.1277; val_edge_recon_loss: 703591.1333; val_gene_expr_recon_loss: 17431397.5333; val_masked_gp_l1_reg_loss: 132781.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81533.6641; val_chrom_access_recon_loss: 3945017.2167; val_global_loss: 22313608.4000; val_optim_loss: 22313608.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9103; val_auprc_score: 0.9005; val_best_acc_score: 0.8207; val_best_f1_score: 0.8351; train_kl_reg_loss: 36622.9297; train_edge_recon_loss: 665130.5921; train_gene_expr_recon_loss: 17491608.2061; train_masked_gp_l1_reg_loss: 127313.8339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79674.3836; train_chrom_access_recon_loss: 3901009.4427; train_global_loss: 22301359.1756; train_optim_loss: 22301359.1756; val_kl_reg_loss: 25264.8750; val_edge_recon_loss: 647844.1917; val_gene_expr_recon_loss: 17435182.6667; val_masked_gp_l1_reg_loss: 122519.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76989.1250; val_chrom_access_recon_loss: 3938062.5500; val_global_loss: 22245864.6667; val_optim_loss: 22245864.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9095; val_auprc_score: 0.8974; val_best_acc_score: 0.8238; val_best_f1_score: 0.8367; train_kl_reg_loss: 41977.8054; train_edge_recon_loss: 627918.8736; train_gene_expr_recon_loss: 17442417.2977; train_masked_gp_l1_reg_loss: 119612.6496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75504.7535; train_chrom_access_recon_loss: 3891515.1565; train_global_loss: 22198946.6718; train_optim_loss: 22198946.6718; val_kl_reg_loss: 34000.8150; val_edge_recon_loss: 617215.5375; val_gene_expr_recon_loss: 17329173.0667; val_masked_gp_l1_reg_loss: 116832.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74354.7266; val_chrom_access_recon_loss: 3933837.2000; val_global_loss: 22105412.6667; val_optim_loss: 22105412.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9049; val_auprc_score: 0.8920; val_best_acc_score: 0.8166; val_best_f1_score: 0.8301; train_kl_reg_loss: 45380.9744; train_edge_recon_loss: 615001.7013; train_gene_expr_recon_loss: 17415293.7557; train_masked_gp_l1_reg_loss: 114471.7492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73471.3222; train_chrom_access_recon_loss: 3889728.2729; train_global_loss: 22153347.6489; train_optim_loss: 22153347.6489; val_kl_reg_loss: 37990.8125; val_edge_recon_loss: 612118.4375; val_gene_expr_recon_loss: 17330086.1333; val_masked_gp_l1_reg_loss: 112144.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72808.7812; val_chrom_access_recon_loss: 3918756.9667; val_global_loss: 22083904.4000; val_optim_loss: 22083904.4000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9129; val_auprc_score: 0.8998; val_best_acc_score: 0.8247; val_best_f1_score: 0.8379; train_kl_reg_loss: 46965.8865; train_edge_recon_loss: 609681.0969; train_gene_expr_recon_loss: 17385195.0840; train_masked_gp_l1_reg_loss: 110323.1096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72305.8534; train_chrom_access_recon_loss: 3881447.0973; train_global_loss: 22105917.9237; train_optim_loss: 22105917.9237; val_kl_reg_loss: 39772.5182; val_edge_recon_loss: 609758.8292; val_gene_expr_recon_loss: 17391029.6000; val_masked_gp_l1_reg_loss: 108610.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72247.7266; val_chrom_access_recon_loss: 3929472.3500; val_global_loss: 22150891.0667; val_optim_loss: 22150891.0667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9168; val_auprc_score: 0.9060; val_best_acc_score: 0.8316; val_best_f1_score: 0.8429; train_kl_reg_loss: 47610.0688; train_edge_recon_loss: 604814.5191; train_gene_expr_recon_loss: 17344277.5573; train_masked_gp_l1_reg_loss: 107408.8077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71614.8541; train_chrom_access_recon_loss: 3874983.3740; train_global_loss: 22050709.0229; train_optim_loss: 22050709.0229; val_kl_reg_loss: 41603.2909; val_edge_recon_loss: 603666.4750; val_gene_expr_recon_loss: 17295476.4000; val_masked_gp_l1_reg_loss: 106165.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71284.5000; val_chrom_access_recon_loss: 3925340.3167; val_global_loss: 22043536.5333; val_optim_loss: 22043536.5333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9215; val_auprc_score: 0.9080; val_best_acc_score: 0.8403; val_best_f1_score: 0.8502; train_kl_reg_loss: 47663.8726; train_edge_recon_loss: 601924.1240; train_gene_expr_recon_loss: 17319562.8473; train_masked_gp_l1_reg_loss: 105107.4438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71020.5302; train_chrom_access_recon_loss: 3864566.4752; train_global_loss: 22009845.2366; train_optim_loss: 22009845.2366; val_kl_reg_loss: 43402.8979; val_edge_recon_loss: 601607.5250; val_gene_expr_recon_loss: 17253217.4667; val_masked_gp_l1_reg_loss: 104182.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70552.8594; val_chrom_access_recon_loss: 3924498.8333; val_global_loss: 21997460.6667; val_optim_loss: 21997460.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9233; val_auprc_score: 0.9060; val_best_acc_score: 0.8461; val_best_f1_score: 0.8565; train_kl_reg_loss: 47713.5618; train_edge_recon_loss: 598729.1827; train_gene_expr_recon_loss: 17279795.6183; train_masked_gp_l1_reg_loss: 103409.6428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70636.9793; train_chrom_access_recon_loss: 3855666.2996; train_global_loss: 21955951.2824; train_optim_loss: 21955951.2824; val_kl_reg_loss: 44521.7349; val_edge_recon_loss: 599197.7083; val_gene_expr_recon_loss: 17174105.6667; val_masked_gp_l1_reg_loss: 102747.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70374.5391; val_chrom_access_recon_loss: 3896708.8333; val_global_loss: 21887656.1333; val_optim_loss: 21887656.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9255; val_auprc_score: 0.9075; val_best_acc_score: 0.8500; val_best_f1_score: 0.8597; train_kl_reg_loss: 48363.0552; train_edge_recon_loss: 594350.4031; train_gene_expr_recon_loss: 17261547.6412; train_masked_gp_l1_reg_loss: 102315.5307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70365.5353; train_chrom_access_recon_loss: 3851270.5286; train_global_loss: 21928212.5802; train_optim_loss: 21928212.5802; val_kl_reg_loss: 45021.1737; val_edge_recon_loss: 595771.3125; val_gene_expr_recon_loss: 17195316.1333; val_masked_gp_l1_reg_loss: 101913.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70639.4453; val_chrom_access_recon_loss: 3880609.3333; val_global_loss: 21889271.8667; val_optim_loss: 21889271.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9290; val_auprc_score: 0.9131; val_best_acc_score: 0.8553; val_best_f1_score: 0.8639; train_kl_reg_loss: 48912.9012; train_edge_recon_loss: 592125.7944; train_gene_expr_recon_loss: 17234394.6412; train_masked_gp_l1_reg_loss: 101734.7261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70380.8218; train_chrom_access_recon_loss: 3848138.1355; train_global_loss: 21895686.9160; train_optim_loss: 21895686.9160; val_kl_reg_loss: 46120.3719; val_edge_recon_loss: 595969.1750; val_gene_expr_recon_loss: 17184450.7333; val_masked_gp_l1_reg_loss: 101356.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70460.3594; val_chrom_access_recon_loss: 3885100.5333; val_global_loss: 21883457.2000; val_optim_loss: 21883457.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9318; val_auprc_score: 0.9119; val_best_acc_score: 0.8611; val_best_f1_score: 0.8682; train_kl_reg_loss: 49358.9966; train_edge_recon_loss: 592146.4232; train_gene_expr_recon_loss: 17206569.5115; train_masked_gp_l1_reg_loss: 101343.8343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70142.9475; train_chrom_access_recon_loss: 3842478.3588; train_global_loss: 21862039.9542; train_optim_loss: 21862039.9542; val_kl_reg_loss: 46238.5456; val_edge_recon_loss: 593927.5542; val_gene_expr_recon_loss: 17199205.4667; val_masked_gp_l1_reg_loss: 101197.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70686.8281; val_chrom_access_recon_loss: 3896419.4667; val_global_loss: 21907675.3333; val_optim_loss: 21907675.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9344; val_auprc_score: 0.9171; val_best_acc_score: 0.8670; val_best_f1_score: 0.8748; train_kl_reg_loss: 49849.1924; train_edge_recon_loss: 588951.5167; train_gene_expr_recon_loss: 17200181.7634; train_masked_gp_l1_reg_loss: 101253.8188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70261.1601; train_chrom_access_recon_loss: 3839938.3206; train_global_loss: 21850435.9237; train_optim_loss: 21850435.9237; val_kl_reg_loss: 47732.0135; val_edge_recon_loss: 593697.0000; val_gene_expr_recon_loss: 17161144.5333; val_masked_gp_l1_reg_loss: 101428.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70345.5312; val_chrom_access_recon_loss: 3876639.4000; val_global_loss: 21850987.0667; val_optim_loss: 21850987.0667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9381; val_auprc_score: 0.9192; val_best_acc_score: 0.8700; val_best_f1_score: 0.8785; train_kl_reg_loss: 49896.3104; train_edge_recon_loss: 588987.8106; train_gene_expr_recon_loss: 17159500.0153; train_masked_gp_l1_reg_loss: 101450.5537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70267.8027; train_chrom_access_recon_loss: 3831750.6813; train_global_loss: 21801853.2519; train_optim_loss: 21801853.2519; val_kl_reg_loss: 47038.3451; val_edge_recon_loss: 588910.6375; val_gene_expr_recon_loss: 17139301.8667; val_masked_gp_l1_reg_loss: 101417.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70120.0625; val_chrom_access_recon_loss: 3880242.2333; val_global_loss: 21827031.0667; val_optim_loss: 21827031.0667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9365; val_auprc_score: 0.9126; val_best_acc_score: 0.8697; val_best_f1_score: 0.8792; train_kl_reg_loss: 50463.2259; train_edge_recon_loss: 586596.4556; train_gene_expr_recon_loss: 17174515.0840; train_masked_gp_l1_reg_loss: 101482.1051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70260.4295; train_chrom_access_recon_loss: 3837769.9790; train_global_loss: 21821087.2061; train_optim_loss: 21821087.2061; val_kl_reg_loss: 47777.6026; val_edge_recon_loss: 587462.2292; val_gene_expr_recon_loss: 17055581.8667; val_masked_gp_l1_reg_loss: 101468.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69978.0547; val_chrom_access_recon_loss: 3853440.8333; val_global_loss: 21715708.0000; val_optim_loss: 21715708.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9424; val_auprc_score: 0.9242; val_best_acc_score: 0.8744; val_best_f1_score: 0.8807; train_kl_reg_loss: 51052.2344; train_edge_recon_loss: 586155.3798; train_gene_expr_recon_loss: 17125422.6031; train_masked_gp_l1_reg_loss: 101413.2214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70049.1635; train_chrom_access_recon_loss: 3819899.6718; train_global_loss: 21753992.3664; train_optim_loss: 21753992.3664; val_kl_reg_loss: 49069.0724; val_edge_recon_loss: 587026.7333; val_gene_expr_recon_loss: 17100421.3333; val_masked_gp_l1_reg_loss: 101204.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69716.5234; val_chrom_access_recon_loss: 3866404.7667; val_global_loss: 21773842.1333; val_optim_loss: 21773842.1333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9420; val_auprc_score: 0.9257; val_best_acc_score: 0.8758; val_best_f1_score: 0.8833; train_kl_reg_loss: 52425.5432; train_edge_recon_loss: 588946.1980; train_gene_expr_recon_loss: 17158033.9542; train_masked_gp_l1_reg_loss: 100454.2831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69480.7764; train_chrom_access_recon_loss: 3822743.9351; train_global_loss: 21792084.6565; train_optim_loss: 21792084.6565; val_kl_reg_loss: 49821.1578; val_edge_recon_loss: 588983.0333; val_gene_expr_recon_loss: 17266038.3333; val_masked_gp_l1_reg_loss: 99405.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69058.7891; val_chrom_access_recon_loss: 3904044.6500; val_global_loss: 21977351.3333; val_optim_loss: 21977351.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9458; val_auprc_score: 0.9344; val_best_acc_score: 0.8801; val_best_f1_score: 0.8856; train_kl_reg_loss: 49819.1929; train_edge_recon_loss: 594160.5864; train_gene_expr_recon_loss: 17177706.1145; train_masked_gp_l1_reg_loss: 98762.0329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69709.3469; train_chrom_access_recon_loss: 3816359.5344; train_global_loss: 21806516.7481; train_optim_loss: 21806516.7481; val_kl_reg_loss: 44987.2232; val_edge_recon_loss: 590522.8167; val_gene_expr_recon_loss: 17088321.0000; val_masked_gp_l1_reg_loss: 98028.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70025.7578; val_chrom_access_recon_loss: 3862886.4167; val_global_loss: 21754771.8667; val_optim_loss: 21754771.8667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9245; val_auprc_score: 0.9074; val_best_acc_score: 0.8539; val_best_f1_score: 0.8640; train_kl_reg_loss: 312130.7357; train_edge_recon_loss: 598412.1164; train_gene_expr_recon_loss: 17187078.1374; train_masked_gp_l1_reg_loss: 97848.9458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69940.9868; train_chrom_access_recon_loss: 3801406.9046; train_global_loss: 22066818.0611; train_optim_loss: 22066818.0611; val_kl_reg_loss: 43577.2961; val_edge_recon_loss: 632736.3208; val_gene_expr_recon_loss: 17188865.3333; val_masked_gp_l1_reg_loss: 97194.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70860.0469; val_chrom_access_recon_loss: 3850243.5500; val_global_loss: 21883476.6667; val_optim_loss: 21883476.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9335; val_auprc_score: 0.9154; val_best_acc_score: 0.8686; val_best_f1_score: 0.8767; train_kl_reg_loss: 22868221.7916; train_edge_recon_loss: 618161.0954; train_gene_expr_recon_loss: 17197483.1298; train_masked_gp_l1_reg_loss: 93286.9180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56573.3657; train_chrom_access_recon_loss: 3805424.3206; train_global_loss: 44639153.2672; train_optim_loss: 44639153.2672; val_kl_reg_loss: 48074.1919; val_edge_recon_loss: 611271.4167; val_gene_expr_recon_loss: 17116737.2667; val_masked_gp_l1_reg_loss: 92163.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54828.8867; val_chrom_access_recon_loss: 3826694.0500; val_global_loss: 21749769.0667; val_optim_loss: 21749769.0667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9313; val_auprc_score: 0.9146; val_best_acc_score: 0.8628; val_best_f1_score: 0.8712; train_kl_reg_loss: 53305.7341; train_edge_recon_loss: 605038.1765; train_gene_expr_recon_loss: 17147548.1832; train_masked_gp_l1_reg_loss: 91827.1383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54457.9114; train_chrom_access_recon_loss: 3798611.4408; train_global_loss: 21750788.6260; train_optim_loss: 21750788.6260; val_kl_reg_loss: 48256.4089; val_edge_recon_loss: 606813.4833; val_gene_expr_recon_loss: 17035643.4667; val_masked_gp_l1_reg_loss: 91618.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54024.9102; val_chrom_access_recon_loss: 3819515.7500; val_global_loss: 21655871.3333; val_optim_loss: 21655871.3333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9271; val_auprc_score: 0.9095; val_best_acc_score: 0.8584; val_best_f1_score: 0.8662; train_kl_reg_loss: 62113.0446; train_edge_recon_loss: 599523.7419; train_gene_expr_recon_loss: 17131762.9160; train_masked_gp_l1_reg_loss: 91480.4163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53721.6804; train_chrom_access_recon_loss: 3799451.6183; train_global_loss: 21738053.4351; train_optim_loss: 21738053.4351; val_kl_reg_loss: 48737.9638; val_edge_recon_loss: 604910.2250; val_gene_expr_recon_loss: 17029066.3333; val_masked_gp_l1_reg_loss: 91347.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53416.2891; val_chrom_access_recon_loss: 3827215.8333; val_global_loss: 21654694.4000; val_optim_loss: 21654694.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9306; val_auprc_score: 0.9130; val_best_acc_score: 0.8618; val_best_f1_score: 0.8707; train_kl_reg_loss: 53422.2478; train_edge_recon_loss: 597587.0964; train_gene_expr_recon_loss: 17127262.0305; train_masked_gp_l1_reg_loss: 91253.1922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53165.5132; train_chrom_access_recon_loss: 3792373.3244; train_global_loss: 21715063.4046; train_optim_loss: 21715063.4046; val_kl_reg_loss: 49555.3427; val_edge_recon_loss: 598527.1792; val_gene_expr_recon_loss: 17052157.0667; val_masked_gp_l1_reg_loss: 91155.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52951.5820; val_chrom_access_recon_loss: 3844680.0833; val_global_loss: 21689027.4667; val_optim_loss: 21689027.4667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9301; val_auprc_score: 0.9142; val_best_acc_score: 0.8605; val_best_f1_score: 0.8709; train_kl_reg_loss: 54426.6135; train_edge_recon_loss: 596973.0339; train_gene_expr_recon_loss: 17111975.1374; train_masked_gp_l1_reg_loss: 91081.5791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52676.2335; train_chrom_access_recon_loss: 3790832.5420; train_global_loss: 21697965.1450; train_optim_loss: 21697965.1450; val_kl_reg_loss: 50420.3659; val_edge_recon_loss: 597871.2958; val_gene_expr_recon_loss: 17120431.1333; val_masked_gp_l1_reg_loss: 90982.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52426.4922; val_chrom_access_recon_loss: 3834752.9333; val_global_loss: 21746883.7333; val_optim_loss: 21746883.7333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9273; val_auprc_score: 0.9101; val_best_acc_score: 0.8650; val_best_f1_score: 0.8746; train_kl_reg_loss: 55178.0171; train_edge_recon_loss: 595193.3330; train_gene_expr_recon_loss: 17124883.7481; train_masked_gp_l1_reg_loss: 90895.0501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52200.9190; train_chrom_access_recon_loss: 3795111.6947; train_global_loss: 21713462.9008; train_optim_loss: 21713462.9008; val_kl_reg_loss: 51292.0070; val_edge_recon_loss: 596903.2958; val_gene_expr_recon_loss: 17082544.3333; val_masked_gp_l1_reg_loss: 90806.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52009.4922; val_chrom_access_recon_loss: 3837192.1833; val_global_loss: 21710747.8667; val_optim_loss: 21710747.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9269; val_auprc_score: 0.9096; val_best_acc_score: 0.8565; val_best_f1_score: 0.8669; train_kl_reg_loss: 55471.7687; train_edge_recon_loss: 594140.9528; train_gene_expr_recon_loss: 17125047.7023; train_masked_gp_l1_reg_loss: 90722.5479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51799.3301; train_chrom_access_recon_loss: 3798716.3187; train_global_loss: 21715898.8244; train_optim_loss: 21715898.8244; val_kl_reg_loss: 51750.6086; val_edge_recon_loss: 598507.7958; val_gene_expr_recon_loss: 17162682.3333; val_masked_gp_l1_reg_loss: 90646.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51554.3125; val_chrom_access_recon_loss: 3859819.3167; val_global_loss: 21814960.1333; val_optim_loss: 21814960.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9284; val_auprc_score: 0.9101; val_best_acc_score: 0.8650; val_best_f1_score: 0.8722; train_kl_reg_loss: 55926.9385; train_edge_recon_loss: 593908.5501; train_gene_expr_recon_loss: 17112294.8397; train_masked_gp_l1_reg_loss: 90263.2990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50082.2576; train_chrom_access_recon_loss: 3794342.7805; train_global_loss: 21696818.7786; train_optim_loss: 21696818.7786; val_kl_reg_loss: 51516.5654; val_edge_recon_loss: 596318.2667; val_gene_expr_recon_loss: 17020766.2000; val_masked_gp_l1_reg_loss: 90147.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49886.1758; val_chrom_access_recon_loss: 3828860.7833; val_global_loss: 21637495.7333; val_optim_loss: 21637495.7333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9299; val_auprc_score: 0.9095; val_best_acc_score: 0.8674; val_best_f1_score: 0.8766; train_kl_reg_loss: 55881.3351; train_edge_recon_loss: 592851.1503; train_gene_expr_recon_loss: 17100250.6107; train_masked_gp_l1_reg_loss: 90114.8179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49831.0331; train_chrom_access_recon_loss: 3792040.0172; train_global_loss: 21680968.8702; train_optim_loss: 21680968.8702; val_kl_reg_loss: 51882.3479; val_edge_recon_loss: 592677.7583; val_gene_expr_recon_loss: 17014810.2667; val_masked_gp_l1_reg_loss: 90079.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49779.6328; val_chrom_access_recon_loss: 3817835.9667; val_global_loss: 21617066.5333; val_optim_loss: 21617066.5333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9267; val_auprc_score: 0.9063; val_best_acc_score: 0.8612; val_best_f1_score: 0.8713; train_kl_reg_loss: 55833.7797; train_edge_recon_loss: 593228.9809; train_gene_expr_recon_loss: 17143344.2672; train_masked_gp_l1_reg_loss: 90063.8558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49745.5105; train_chrom_access_recon_loss: 3794942.7977; train_global_loss: 21727159.3435; train_optim_loss: 21727159.3435; val_kl_reg_loss: 51714.7503; val_edge_recon_loss: 596447.1208; val_gene_expr_recon_loss: 17106221.4000; val_masked_gp_l1_reg_loss: 90044.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49704.0781; val_chrom_access_recon_loss: 3834270.3500; val_global_loss: 21728401.4667; val_optim_loss: 21728401.4667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9283; val_auprc_score: 0.9116; val_best_acc_score: 0.8585; val_best_f1_score: 0.8682; train_kl_reg_loss: 55921.0168; train_edge_recon_loss: 593226.2047; train_gene_expr_recon_loss: 17095176.4427; train_masked_gp_l1_reg_loss: 90029.8976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49667.3841; train_chrom_access_recon_loss: 3786864.6431; train_global_loss: 21670885.5878; train_optim_loss: 21670885.5878; val_kl_reg_loss: 51628.6216; val_edge_recon_loss: 595168.7500; val_gene_expr_recon_loss: 17135529.0000; val_masked_gp_l1_reg_loss: 90018.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49634.8047; val_chrom_access_recon_loss: 3858167.5333; val_global_loss: 21780146.1333; val_optim_loss: 21780146.1333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9350; val_auprc_score: 0.9221; val_best_acc_score: 0.8634; val_best_f1_score: 0.8721; train_kl_reg_loss: 56013.1117; train_edge_recon_loss: 591990.9847; train_gene_expr_recon_loss: 17093580.6031; train_masked_gp_l1_reg_loss: 90009.2891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49608.0720; train_chrom_access_recon_loss: 3785345.3511; train_global_loss: 21666547.5115; train_optim_loss: 21666547.5115; val_kl_reg_loss: 52038.3419; val_edge_recon_loss: 594276.6000; val_gene_expr_recon_loss: 17044085.8000; val_masked_gp_l1_reg_loss: 89995.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49574.0000; val_chrom_access_recon_loss: 3835504.6833; val_global_loss: 21665475.3333; val_optim_loss: 21665475.3333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9286; val_auprc_score: 0.9084; val_best_acc_score: 0.8641; val_best_f1_score: 0.8735; train_kl_reg_loss: 55983.3941; train_edge_recon_loss: 591673.5157; train_gene_expr_recon_loss: 17087352.6565; train_masked_gp_l1_reg_loss: 89983.6802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49548.2725; train_chrom_access_recon_loss: 3789478.8683; train_global_loss: 21664020.3206; train_optim_loss: 21664020.3206; val_kl_reg_loss: 52153.2060; val_edge_recon_loss: 594742.5083; val_gene_expr_recon_loss: 17068212.6667; val_masked_gp_l1_reg_loss: 89970.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49516.2070; val_chrom_access_recon_loss: 3843202.3167; val_global_loss: 21697796.4000; val_optim_loss: 21697796.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9298; val_auprc_score: 0.9125; val_best_acc_score: 0.8603; val_best_f1_score: 0.8686; train_kl_reg_loss: 56181.3062; train_edge_recon_loss: 592041.3397; train_gene_expr_recon_loss: 17080408.8473; train_masked_gp_l1_reg_loss: 89934.0140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49366.3966; train_chrom_access_recon_loss: 3787331.4046; train_global_loss: 21655263.2824; train_optim_loss: 21655263.2824; val_kl_reg_loss: 51953.3995; val_edge_recon_loss: 595996.4375; val_gene_expr_recon_loss: 17021345.4000; val_masked_gp_l1_reg_loss: 89922.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49348.3945; val_chrom_access_recon_loss: 3838668.2833; val_global_loss: 21647233.8667; val_optim_loss: 21647233.8667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9261; val_auprc_score: 0.9051; val_best_acc_score: 0.8581; val_best_f1_score: 0.8660; train_kl_reg_loss: 56162.6040; train_edge_recon_loss: 591870.2028; train_gene_expr_recon_loss: 17099545.4733; train_masked_gp_l1_reg_loss: 89918.5724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49342.8339; train_chrom_access_recon_loss: 3792476.3683; train_global_loss: 21679316.0000; train_optim_loss: 21679316.0000; val_kl_reg_loss: 51787.8372; val_edge_recon_loss: 598810.2417; val_gene_expr_recon_loss: 17071879.2000; val_masked_gp_l1_reg_loss: 89914.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49337.3398; val_chrom_access_recon_loss: 3835754.1333; val_global_loss: 21697483.3333; val_optim_loss: 21697483.3333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9264; val_auprc_score: 0.9100; val_best_acc_score: 0.8542; val_best_f1_score: 0.8644; train_kl_reg_loss: 56110.1637; train_edge_recon_loss: 594169.9170; train_gene_expr_recon_loss: 17098066.4580; train_masked_gp_l1_reg_loss: 89912.6549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49333.2962; train_chrom_access_recon_loss: 3791019.0802; train_global_loss: 21678611.4962; train_optim_loss: 21678611.4962; val_kl_reg_loss: 52084.5195; val_edge_recon_loss: 596814.4792; val_gene_expr_recon_loss: 17071528.0667; val_masked_gp_l1_reg_loss: 89910.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49329.1680; val_chrom_access_recon_loss: 3846429.3167; val_global_loss: 21706096.2667; val_optim_loss: 21706096.2667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9294; val_auprc_score: 0.9103; val_best_acc_score: 0.8604; val_best_f1_score: 0.8703; train_kl_reg_loss: 56341.6323; train_edge_recon_loss: 592044.0119; train_gene_expr_recon_loss: 17097701.4809; train_masked_gp_l1_reg_loss: 89908.4059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49325.8435; train_chrom_access_recon_loss: 3791055.9389; train_global_loss: 21676377.4198; train_optim_loss: 21676377.4198; val_kl_reg_loss: 51841.9956; val_edge_recon_loss: 596096.8792; val_gene_expr_recon_loss: 17027801.0667; val_masked_gp_l1_reg_loss: 89906.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49322.1953; val_chrom_access_recon_loss: 3817994.0000; val_global_loss: 21632961.6000; val_optim_loss: 21632961.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 34 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9358
val AUPRC score: 0.9183
val best accuracy score: 0.8694
val best F1 score: 0.8775
val target rna MSE score: 1.4726
val source rna MSE score: 0.6861
val target atac MSE score: 0.4965
val source atac MSE score: 0.1537
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
