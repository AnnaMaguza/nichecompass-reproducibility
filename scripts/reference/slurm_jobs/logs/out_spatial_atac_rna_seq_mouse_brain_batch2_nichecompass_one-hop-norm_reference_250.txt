[True]
Run timestamp: 07092023_031928_250.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_250']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1123 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5626, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1123
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1123

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6570; val_auprc_score: 0.6303; val_best_acc_score: 0.5081; val_best_f1_score: 0.6698; train_kl_reg_loss: 57124.7488; train_edge_recon_loss: 3532420.7841; train_gene_expr_recon_loss: 16904065.0758; train_masked_gp_l1_reg_loss: 49300.9586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9828008.2197; train_chrom_access_recon_loss: 6336378.8409; train_global_loss: 36707298.0909; train_optim_loss: 36707298.0909; val_kl_reg_loss: 126512.8721; val_edge_recon_loss: 4064925.0312; val_gene_expr_recon_loss: 15267972.1250; val_masked_gp_l1_reg_loss: 47152.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3358660.7500; val_chrom_access_recon_loss: 6027319.9375; val_global_loss: 28892542.2500; val_optim_loss: 28892542.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6984; val_auprc_score: 0.6718; val_best_acc_score: 0.5956; val_best_f1_score: 0.7038; train_kl_reg_loss: 126881.8809; train_edge_recon_loss: 3542967.6515; train_gene_expr_recon_loss: 14864820.8788; train_masked_gp_l1_reg_loss: 42992.1429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1184248.5312; train_chrom_access_recon_loss: 5981218.0227; train_global_loss: 25743129.0303; train_optim_loss: 25743129.0303; val_kl_reg_loss: 122112.4629; val_edge_recon_loss: 4060140.1875; val_gene_expr_recon_loss: 14642326.1250; val_masked_gp_l1_reg_loss: 40590.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 381154.6875; val_chrom_access_recon_loss: 5919190.6875; val_global_loss: 25165513.0000; val_optim_loss: 25165513.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7014; val_auprc_score: 0.6822; val_best_acc_score: 0.6333; val_best_f1_score: 0.6974; train_kl_reg_loss: 119303.2311; train_edge_recon_loss: 3534487.1705; train_gene_expr_recon_loss: 14599991.8030; train_masked_gp_l1_reg_loss: 40295.5167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 286235.4905; train_chrom_access_recon_loss: 5925372.5303; train_global_loss: 24505685.4545; train_optim_loss: 24505685.4545; val_kl_reg_loss: 110321.8564; val_edge_recon_loss: 4052571.4688; val_gene_expr_recon_loss: 14649317.0000; val_masked_gp_l1_reg_loss: 40517.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 232113.1406; val_chrom_access_recon_loss: 5886425.5625; val_global_loss: 24971268.5000; val_optim_loss: 24971268.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7460; val_auprc_score: 0.7329; val_best_acc_score: 0.6693; val_best_f1_score: 0.7114; train_kl_reg_loss: 107216.3609; train_edge_recon_loss: 3525241.4545; train_gene_expr_recon_loss: 14482372.1515; train_masked_gp_l1_reg_loss: 41116.8113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209565.7758; train_chrom_access_recon_loss: 5882825.3333; train_global_loss: 24248338.0606; train_optim_loss: 24248338.0606; val_kl_reg_loss: 105663.3242; val_edge_recon_loss: 4026593.8125; val_gene_expr_recon_loss: 14653913.6250; val_masked_gp_l1_reg_loss: 41899.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192845.2656; val_chrom_access_recon_loss: 5858614.7500; val_global_loss: 24879531.0000; val_optim_loss: 24879531.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7678; val_auprc_score: 0.7435; val_best_acc_score: 0.6929; val_best_f1_score: 0.7326; train_kl_reg_loss: 95124.3092; train_edge_recon_loss: 3510413.8750; train_gene_expr_recon_loss: 14386338.6970; train_masked_gp_l1_reg_loss: 43055.0988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183018.7185; train_chrom_access_recon_loss: 5851948.0833; train_global_loss: 24069898.9091; train_optim_loss: 24069898.9091; val_kl_reg_loss: 87494.6943; val_edge_recon_loss: 3913303.9375; val_gene_expr_recon_loss: 14569401.5000; val_masked_gp_l1_reg_loss: 44232.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172963.2812; val_chrom_access_recon_loss: 5874590.5625; val_global_loss: 24661986.5000; val_optim_loss: 24661986.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7733; val_auprc_score: 0.7659; val_best_acc_score: 0.6894; val_best_f1_score: 0.7382; train_kl_reg_loss: 79032.8765; train_edge_recon_loss: 3388040.8220; train_gene_expr_recon_loss: 14330376.0758; train_masked_gp_l1_reg_loss: 45398.1013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166465.7950; train_chrom_access_recon_loss: 5825254.0076; train_global_loss: 23834567.7273; train_optim_loss: 23834567.7273; val_kl_reg_loss: 79604.0020; val_edge_recon_loss: 3353668.4062; val_gene_expr_recon_loss: 14441595.3750; val_masked_gp_l1_reg_loss: 46831.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161368.1406; val_chrom_access_recon_loss: 5777795.4375; val_global_loss: 23860863.7500; val_optim_loss: 23860863.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7886; val_auprc_score: 0.7899; val_best_acc_score: 0.7004; val_best_f1_score: 0.7359; train_kl_reg_loss: 95331.4152; train_edge_recon_loss: 3154909.8864; train_gene_expr_recon_loss: 14276513.1667; train_masked_gp_l1_reg_loss: 48223.7783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156180.7533; train_chrom_access_recon_loss: 5806324.9318; train_global_loss: 23537483.8788; train_optim_loss: 23537483.8788; val_kl_reg_loss: 90909.3711; val_edge_recon_loss: 3259755.4375; val_gene_expr_recon_loss: 14332719.1250; val_masked_gp_l1_reg_loss: 49469.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150940.4062; val_chrom_access_recon_loss: 5759988.0000; val_global_loss: 23643782.5000; val_optim_loss: 23643782.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8149; val_auprc_score: 0.8086; val_best_acc_score: 0.7246; val_best_f1_score: 0.7516; train_kl_reg_loss: 106416.1009; train_edge_recon_loss: 3083141.1818; train_gene_expr_recon_loss: 14205168.8636; train_masked_gp_l1_reg_loss: 50383.7926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146990.9105; train_chrom_access_recon_loss: 5775060.7121; train_global_loss: 23367161.7879; train_optim_loss: 23367161.7879; val_kl_reg_loss: 98319.6279; val_edge_recon_loss: 3115782.2812; val_gene_expr_recon_loss: 14417554.7500; val_masked_gp_l1_reg_loss: 51217.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143932.2969; val_chrom_access_recon_loss: 5753883.5625; val_global_loss: 23580689.7500; val_optim_loss: 23580689.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8282; val_auprc_score: 0.8227; val_best_acc_score: 0.7442; val_best_f1_score: 0.7573; train_kl_reg_loss: 105373.1773; train_edge_recon_loss: 3040608.5303; train_gene_expr_recon_loss: 14133043.5152; train_masked_gp_l1_reg_loss: 52193.9168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141981.3591; train_chrom_access_recon_loss: 5751679.0076; train_global_loss: 23224879.5758; train_optim_loss: 23224879.5758; val_kl_reg_loss: 101302.8770; val_edge_recon_loss: 3094527.0000; val_gene_expr_recon_loss: 14200367.0000; val_masked_gp_l1_reg_loss: 53061.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139628.7344; val_chrom_access_recon_loss: 5675834.7500; val_global_loss: 23264722.0000; val_optim_loss: 23264722.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8721; val_auprc_score: 0.8541; val_best_acc_score: 0.7920; val_best_f1_score: 0.8055; train_kl_reg_loss: 101066.4564; train_edge_recon_loss: 2977263.8409; train_gene_expr_recon_loss: 14066344.9697; train_masked_gp_l1_reg_loss: 53852.2402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137564.6058; train_chrom_access_recon_loss: 5721619.7879; train_global_loss: 23057711.7879; train_optim_loss: 23057711.7879; val_kl_reg_loss: 100966.9541; val_edge_recon_loss: 2955977.3125; val_gene_expr_recon_loss: 14241965.3750; val_masked_gp_l1_reg_loss: 54833.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136242.6094; val_chrom_access_recon_loss: 5696565.8125; val_global_loss: 23186551.7500; val_optim_loss: 23186551.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8979; val_auprc_score: 0.8655; val_best_acc_score: 0.8334; val_best_f1_score: 0.8424; train_kl_reg_loss: 104068.0996; train_edge_recon_loss: 2890590.7159; train_gene_expr_recon_loss: 14008978.0000; train_masked_gp_l1_reg_loss: 55678.1774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136037.8250; train_chrom_access_recon_loss: 5694665.5909; train_global_loss: 22890018.1818; train_optim_loss: 22890018.1818; val_kl_reg_loss: 102672.0391; val_edge_recon_loss: 2918945.6250; val_gene_expr_recon_loss: 14154703.7500; val_masked_gp_l1_reg_loss: 56608.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136471.3438; val_chrom_access_recon_loss: 5686309.3125; val_global_loss: 23055710.7500; val_optim_loss: 23055710.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9102; val_auprc_score: 0.8830; val_best_acc_score: 0.8418; val_best_f1_score: 0.8521; train_kl_reg_loss: 110966.5736; train_edge_recon_loss: 2849310.7917; train_gene_expr_recon_loss: 13971809.0606; train_masked_gp_l1_reg_loss: 57281.0523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134405.8788; train_chrom_access_recon_loss: 5678618.2879; train_global_loss: 22802391.6061; train_optim_loss: 22802391.6061; val_kl_reg_loss: 109887.9541; val_edge_recon_loss: 2852403.0938; val_gene_expr_recon_loss: 14062237.0000; val_masked_gp_l1_reg_loss: 57868.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132599.2812; val_chrom_access_recon_loss: 5658167.9375; val_global_loss: 22873164.2500; val_optim_loss: 22873164.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9094; val_auprc_score: 0.8835; val_best_acc_score: 0.8404; val_best_f1_score: 0.8507; train_kl_reg_loss: 110816.4858; train_edge_recon_loss: 2819107.2576; train_gene_expr_recon_loss: 13924422.3030; train_masked_gp_l1_reg_loss: 58564.1593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132077.3150; train_chrom_access_recon_loss: 5662058.8788; train_global_loss: 22707046.4848; train_optim_loss: 22707046.4848; val_kl_reg_loss: 113312.1436; val_edge_recon_loss: 2861879.5000; val_gene_expr_recon_loss: 13837524.2500; val_masked_gp_l1_reg_loss: 59250.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131281.9375; val_chrom_access_recon_loss: 5616411.6250; val_global_loss: 22619659.5000; val_optim_loss: 22619659.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9143; val_auprc_score: 0.8856; val_best_acc_score: 0.8506; val_best_f1_score: 0.8603; train_kl_reg_loss: 108779.8216; train_edge_recon_loss: 2822238.7235; train_gene_expr_recon_loss: 13876456.0000; train_masked_gp_l1_reg_loss: 59793.6994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130449.8040; train_chrom_access_recon_loss: 5637959.6591; train_global_loss: 22635677.7879; train_optim_loss: 22635677.7879; val_kl_reg_loss: 109960.4404; val_edge_recon_loss: 2822818.5625; val_gene_expr_recon_loss: 14049344.7500; val_masked_gp_l1_reg_loss: 60312.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129903.2266; val_chrom_access_recon_loss: 5602829.1250; val_global_loss: 22775168.5000; val_optim_loss: 22775168.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9165; val_auprc_score: 0.8874; val_best_acc_score: 0.8525; val_best_f1_score: 0.8616; train_kl_reg_loss: 110097.3771; train_edge_recon_loss: 2806212.3106; train_gene_expr_recon_loss: 13835799.7121; train_masked_gp_l1_reg_loss: 60882.4380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129456.6061; train_chrom_access_recon_loss: 5625974.2500; train_global_loss: 22568422.6970; train_optim_loss: 22568422.6970; val_kl_reg_loss: 113870.8760; val_edge_recon_loss: 2834276.0938; val_gene_expr_recon_loss: 14065094.0000; val_masked_gp_l1_reg_loss: 61551.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128641.4453; val_chrom_access_recon_loss: 5620056.0625; val_global_loss: 22823490.7500; val_optim_loss: 22823490.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9159; val_auprc_score: 0.8864; val_best_acc_score: 0.8565; val_best_f1_score: 0.8654; train_kl_reg_loss: 105282.1171; train_edge_recon_loss: 2809002.1818; train_gene_expr_recon_loss: 13793574.4697; train_masked_gp_l1_reg_loss: 61916.5392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128443.8119; train_chrom_access_recon_loss: 5606004.0909; train_global_loss: 22504223.0909; train_optim_loss: 22504223.0909; val_kl_reg_loss: 106648.1621; val_edge_recon_loss: 2828475.1562; val_gene_expr_recon_loss: 13938840.6250; val_masked_gp_l1_reg_loss: 62538.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127425.3672; val_chrom_access_recon_loss: 5586313.8750; val_global_loss: 22650242.0000; val_optim_loss: 22650242.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9232; val_auprc_score: 0.8899; val_best_acc_score: 0.8665; val_best_f1_score: 0.8754; train_kl_reg_loss: 106101.2450; train_edge_recon_loss: 2793160.8258; train_gene_expr_recon_loss: 13749331.0455; train_masked_gp_l1_reg_loss: 62971.6827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127237.1679; train_chrom_access_recon_loss: 5588266.3485; train_global_loss: 22427068.3636; train_optim_loss: 22427068.3636; val_kl_reg_loss: 107210.2617; val_edge_recon_loss: 2787593.5312; val_gene_expr_recon_loss: 13823512.7500; val_masked_gp_l1_reg_loss: 63465.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127293.5625; val_chrom_access_recon_loss: 5557352.0625; val_global_loss: 22466427.7500; val_optim_loss: 22466427.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9161; val_auprc_score: 0.8787; val_best_acc_score: 0.8611; val_best_f1_score: 0.8697; train_kl_reg_loss: 103342.9383; train_edge_recon_loss: 2786516.5000; train_gene_expr_recon_loss: 13726439.3788; train_masked_gp_l1_reg_loss: 63757.5436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126994.7530; train_chrom_access_recon_loss: 5579426.1288; train_global_loss: 22386477.1818; train_optim_loss: 22386477.1818; val_kl_reg_loss: 102566.7568; val_edge_recon_loss: 2807004.4062; val_gene_expr_recon_loss: 13758531.8750; val_masked_gp_l1_reg_loss: 64272.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127112.2812; val_chrom_access_recon_loss: 5528251.0000; val_global_loss: 22387738.0000; val_optim_loss: 22387738.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9241; val_auprc_score: 0.8925; val_best_acc_score: 0.8697; val_best_f1_score: 0.8765; train_kl_reg_loss: 104444.5268; train_edge_recon_loss: 2782022.9053; train_gene_expr_recon_loss: 13685054.9545; train_masked_gp_l1_reg_loss: 64664.1926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127246.3277; train_chrom_access_recon_loss: 5556397.6515; train_global_loss: 22319830.4545; train_optim_loss: 22319830.4545; val_kl_reg_loss: 103842.7773; val_edge_recon_loss: 2795830.8438; val_gene_expr_recon_loss: 13713989.7500; val_masked_gp_l1_reg_loss: 65133.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127725.3438; val_chrom_access_recon_loss: 5471392.6250; val_global_loss: 22277915.5000; val_optim_loss: 22277915.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9199; val_auprc_score: 0.8913; val_best_acc_score: 0.8608; val_best_f1_score: 0.8687; train_kl_reg_loss: 102261.7763; train_edge_recon_loss: 2770211.4773; train_gene_expr_recon_loss: 13654313.1970; train_masked_gp_l1_reg_loss: 65508.6320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128258.4180; train_chrom_access_recon_loss: 5542288.7348; train_global_loss: 22262842.0606; train_optim_loss: 22262842.0606; val_kl_reg_loss: 103483.4580; val_edge_recon_loss: 2809753.6250; val_gene_expr_recon_loss: 13751573.1250; val_masked_gp_l1_reg_loss: 66056.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128429.7812; val_chrom_access_recon_loss: 5524899.7500; val_global_loss: 22384196.7500; val_optim_loss: 22384196.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9246; val_auprc_score: 0.8986; val_best_acc_score: 0.8667; val_best_f1_score: 0.8742; train_kl_reg_loss: 101551.9554; train_edge_recon_loss: 2772748.9621; train_gene_expr_recon_loss: 13620319.3182; train_masked_gp_l1_reg_loss: 66392.3783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128600.5395; train_chrom_access_recon_loss: 5530106.0833; train_global_loss: 22219719.3030; train_optim_loss: 22219719.3030; val_kl_reg_loss: 102744.0674; val_edge_recon_loss: 2815189.2500; val_gene_expr_recon_loss: 13607392.0000; val_masked_gp_l1_reg_loss: 66614.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128131.1641; val_chrom_access_recon_loss: 5480247.4375; val_global_loss: 22200318.2500; val_optim_loss: 22200318.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9338; val_auprc_score: 0.9093; val_best_acc_score: 0.8756; val_best_f1_score: 0.8831; train_kl_reg_loss: 100660.6193; train_edge_recon_loss: 2763585.9545; train_gene_expr_recon_loss: 13598558.9545; train_masked_gp_l1_reg_loss: 66976.6264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129139.3771; train_chrom_access_recon_loss: 5515720.2121; train_global_loss: 22174641.6970; train_optim_loss: 22174641.6970; val_kl_reg_loss: 96896.3467; val_edge_recon_loss: 2778295.1250; val_gene_expr_recon_loss: 13698733.3750; val_masked_gp_l1_reg_loss: 67487.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129774.1406; val_chrom_access_recon_loss: 5481753.6250; val_global_loss: 22252940.0000; val_optim_loss: 22252940.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9299; val_auprc_score: 0.9045; val_best_acc_score: 0.8716; val_best_f1_score: 0.8772; train_kl_reg_loss: 100183.9311; train_edge_recon_loss: 2761743.5606; train_gene_expr_recon_loss: 13562537.9394; train_masked_gp_l1_reg_loss: 67735.3738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129623.4202; train_chrom_access_recon_loss: 5504785.4697; train_global_loss: 22126609.9091; train_optim_loss: 22126609.9091; val_kl_reg_loss: 102398.5762; val_edge_recon_loss: 2780657.4375; val_gene_expr_recon_loss: 13611446.0000; val_masked_gp_l1_reg_loss: 68165.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130516.7812; val_chrom_access_recon_loss: 5496088.6875; val_global_loss: 22189273.2500; val_optim_loss: 22189273.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9300; val_auprc_score: 0.8979; val_best_acc_score: 0.8743; val_best_f1_score: 0.8809; train_kl_reg_loss: 99794.2673; train_edge_recon_loss: 2761500.7424; train_gene_expr_recon_loss: 13535193.5303; train_masked_gp_l1_reg_loss: 68480.5098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130820.8609; train_chrom_access_recon_loss: 5492159.8636; train_global_loss: 22087949.7879; train_optim_loss: 22087949.7879; val_kl_reg_loss: 102087.1348; val_edge_recon_loss: 2787529.9375; val_gene_expr_recon_loss: 13473321.3750; val_masked_gp_l1_reg_loss: 68790.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131570.8906; val_chrom_access_recon_loss: 5420386.6250; val_global_loss: 21983686.5000; val_optim_loss: 21983686.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9292; val_auprc_score: 0.9056; val_best_acc_score: 0.8643; val_best_f1_score: 0.8732; train_kl_reg_loss: 99395.5189; train_edge_recon_loss: 2743461.0606; train_gene_expr_recon_loss: 13497591.5455; train_masked_gp_l1_reg_loss: 69133.5696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131136.0189; train_chrom_access_recon_loss: 5475467.6818; train_global_loss: 22016185.5152; train_optim_loss: 22016185.5152; val_kl_reg_loss: 98993.0488; val_edge_recon_loss: 2795767.0625; val_gene_expr_recon_loss: 13582894.2500; val_masked_gp_l1_reg_loss: 69493.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131865.1094; val_chrom_access_recon_loss: 5481748.3750; val_global_loss: 22160761.0000; val_optim_loss: 22160761.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9334; val_auprc_score: 0.9152; val_best_acc_score: 0.8743; val_best_f1_score: 0.8813; train_kl_reg_loss: 99382.2895; train_edge_recon_loss: 2746985.7765; train_gene_expr_recon_loss: 13482151.5152; train_masked_gp_l1_reg_loss: 69805.5674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132020.4375; train_chrom_access_recon_loss: 5469136.5833; train_global_loss: 21999482.1515; train_optim_loss: 21999482.1515; val_kl_reg_loss: 96176.5898; val_edge_recon_loss: 2811311.9062; val_gene_expr_recon_loss: 13559418.5000; val_masked_gp_l1_reg_loss: 70081.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132345.4219; val_chrom_access_recon_loss: 5433085.6250; val_global_loss: 22102420.0000; val_optim_loss: 22102420.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9277; val_auprc_score: 0.8990; val_best_acc_score: 0.8726; val_best_f1_score: 0.8819; train_kl_reg_loss: 98955.0260; train_edge_recon_loss: 2743066.1023; train_gene_expr_recon_loss: 13457886.5000; train_masked_gp_l1_reg_loss: 70434.5401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132463.0185; train_chrom_access_recon_loss: 5457540.6591; train_global_loss: 21960345.8788; train_optim_loss: 21960345.8788; val_kl_reg_loss: 100652.8994; val_edge_recon_loss: 2766506.9062; val_gene_expr_recon_loss: 13494740.6250; val_masked_gp_l1_reg_loss: 70606.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131837.3750; val_chrom_access_recon_loss: 5421698.8125; val_global_loss: 21986043.5000; val_optim_loss: 21986043.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9301; val_auprc_score: 0.9054; val_best_acc_score: 0.8743; val_best_f1_score: 0.8830; train_kl_reg_loss: 99301.0933; train_edge_recon_loss: 2741967.0379; train_gene_expr_recon_loss: 13431075.3333; train_masked_gp_l1_reg_loss: 70993.7127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132352.1598; train_chrom_access_recon_loss: 5443815.1818; train_global_loss: 21919504.6364; train_optim_loss: 21919504.6364; val_kl_reg_loss: 101063.6348; val_edge_recon_loss: 2786751.3438; val_gene_expr_recon_loss: 13578702.3750; val_masked_gp_l1_reg_loss: 71400.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132433.2812; val_chrom_access_recon_loss: 5494138.9375; val_global_loss: 22164489.5000; val_optim_loss: 22164489.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9324; val_auprc_score: 0.9075; val_best_acc_score: 0.8786; val_best_f1_score: 0.8853; train_kl_reg_loss: 99476.8202; train_edge_recon_loss: 2743147.2538; train_gene_expr_recon_loss: 13423433.8939; train_masked_gp_l1_reg_loss: 70433.3396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97625.6660; train_chrom_access_recon_loss: 5439028.9773; train_global_loss: 21873145.8485; train_optim_loss: 21873145.8485; val_kl_reg_loss: 99821.8369; val_edge_recon_loss: 2762200.2500; val_gene_expr_recon_loss: 13641522.1250; val_masked_gp_l1_reg_loss: 69874.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91173.0469; val_chrom_access_recon_loss: 5428759.0625; val_global_loss: 22093351.5000; val_optim_loss: 22093351.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9315; val_auprc_score: 0.9031; val_best_acc_score: 0.8759; val_best_f1_score: 0.8844; train_kl_reg_loss: 98936.6758; train_edge_recon_loss: 2751324.9924; train_gene_expr_recon_loss: 13420474.0758; train_masked_gp_l1_reg_loss: 69756.2629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90805.9296; train_chrom_access_recon_loss: 5438722.0152; train_global_loss: 21870019.9394; train_optim_loss: 21870019.9394; val_kl_reg_loss: 100642.1123; val_edge_recon_loss: 2751549.9062; val_gene_expr_recon_loss: 13493841.2500; val_masked_gp_l1_reg_loss: 69672.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90428.7422; val_chrom_access_recon_loss: 5427563.5000; val_global_loss: 21933698.7500; val_optim_loss: 21933698.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9349; val_auprc_score: 0.9098; val_best_acc_score: 0.8799; val_best_f1_score: 0.8877; train_kl_reg_loss: 100490.9336; train_edge_recon_loss: 2729673.0871; train_gene_expr_recon_loss: 13408571.3182; train_masked_gp_l1_reg_loss: 69643.9885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90197.2520; train_chrom_access_recon_loss: 5434928.7955; train_global_loss: 21833505.3939; train_optim_loss: 21833505.3939; val_kl_reg_loss: 100865.9902; val_edge_recon_loss: 2754577.7188; val_gene_expr_recon_loss: 13501615.2500; val_masked_gp_l1_reg_loss: 69629.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90057.0859; val_chrom_access_recon_loss: 5399363.3125; val_global_loss: 21916108.5000; val_optim_loss: 21916108.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9286; val_auprc_score: 0.8960; val_best_acc_score: 0.8769; val_best_f1_score: 0.8850; train_kl_reg_loss: 100722.6070; train_edge_recon_loss: 2729745.1705; train_gene_expr_recon_loss: 13400455.9848; train_masked_gp_l1_reg_loss: 69634.4020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89902.5355; train_chrom_access_recon_loss: 5432229.7803; train_global_loss: 21822690.5152; train_optim_loss: 21822690.5152; val_kl_reg_loss: 102860.0889; val_edge_recon_loss: 2774144.5625; val_gene_expr_recon_loss: 13499989.6250; val_masked_gp_l1_reg_loss: 69620.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89730.0469; val_chrom_access_recon_loss: 5430965.0625; val_global_loss: 21967309.7500; val_optim_loss: 21967309.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9345; val_auprc_score: 0.9105; val_best_acc_score: 0.8794; val_best_f1_score: 0.8873; train_kl_reg_loss: 100880.7032; train_edge_recon_loss: 2735323.1439; train_gene_expr_recon_loss: 13395068.1061; train_masked_gp_l1_reg_loss: 69640.1375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89587.6332; train_chrom_access_recon_loss: 5429235.5152; train_global_loss: 21819735.0909; train_optim_loss: 21819735.0909; val_kl_reg_loss: 101733.6406; val_edge_recon_loss: 2761393.3750; val_gene_expr_recon_loss: 13550507.7500; val_masked_gp_l1_reg_loss: 69660.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89602.0078; val_chrom_access_recon_loss: 5451318.0000; val_global_loss: 22024214.5000; val_optim_loss: 22024214.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9320; val_auprc_score: 0.9096; val_best_acc_score: 0.8769; val_best_f1_score: 0.8852; train_kl_reg_loss: 100890.0131; train_edge_recon_loss: 2734630.5265; train_gene_expr_recon_loss: 13404195.0152; train_masked_gp_l1_reg_loss: 69685.2499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89464.5698; train_chrom_access_recon_loss: 5428751.9318; train_global_loss: 21827617.4545; train_optim_loss: 21827617.4545; val_kl_reg_loss: 102940.0654; val_edge_recon_loss: 2773644.3750; val_gene_expr_recon_loss: 13609494.0000; val_masked_gp_l1_reg_loss: 69709.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89434.0469; val_chrom_access_recon_loss: 5448461.1250; val_global_loss: 22093683.0000; val_optim_loss: 22093683.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9319; val_auprc_score: 0.9047; val_best_acc_score: 0.8745; val_best_f1_score: 0.8825; train_kl_reg_loss: 100671.0980; train_edge_recon_loss: 2735113.4318; train_gene_expr_recon_loss: 13394774.2879; train_masked_gp_l1_reg_loss: 69733.1864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89276.8333; train_chrom_access_recon_loss: 5426552.7197; train_global_loss: 21816121.5152; train_optim_loss: 21816121.5152; val_kl_reg_loss: 101860.0771; val_edge_recon_loss: 2792729.5938; val_gene_expr_recon_loss: 13427997.0000; val_masked_gp_l1_reg_loss: 69755.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89196.9766; val_chrom_access_recon_loss: 5441889.6875; val_global_loss: 21923428.5000; val_optim_loss: 21923428.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9382; val_auprc_score: 0.9171; val_best_acc_score: 0.8853; val_best_f1_score: 0.8917; train_kl_reg_loss: 100314.7655; train_edge_recon_loss: 2734912.7955; train_gene_expr_recon_loss: 13389920.5758; train_masked_gp_l1_reg_loss: 69659.6304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85695.9227; train_chrom_access_recon_loss: 5422895.9848; train_global_loss: 21803399.6061; train_optim_loss: 21803399.6061; val_kl_reg_loss: 101420.8848; val_edge_recon_loss: 2757753.1250; val_gene_expr_recon_loss: 13572022.8750; val_masked_gp_l1_reg_loss: 69584.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85035.0156; val_chrom_access_recon_loss: 5436883.1875; val_global_loss: 22022700.0000; val_optim_loss: 22022700.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9394; val_auprc_score: 0.9130; val_best_acc_score: 0.8842; val_best_f1_score: 0.8911; train_kl_reg_loss: 100649.8460; train_edge_recon_loss: 2743599.8485; train_gene_expr_recon_loss: 13397628.8788; train_masked_gp_l1_reg_loss: 69558.9976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84983.3345; train_chrom_access_recon_loss: 5430396.0303; train_global_loss: 21826816.9091; train_optim_loss: 21826816.9091; val_kl_reg_loss: 102048.6592; val_edge_recon_loss: 2749390.0312; val_gene_expr_recon_loss: 13665136.2500; val_masked_gp_l1_reg_loss: 69538.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84954.6094; val_chrom_access_recon_loss: 5463353.1250; val_global_loss: 22134421.5000; val_optim_loss: 22134421.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9380; val_auprc_score: 0.9194; val_best_acc_score: 0.8812; val_best_f1_score: 0.8889; train_kl_reg_loss: 100548.5051; train_edge_recon_loss: 2735450.0833; train_gene_expr_recon_loss: 13386724.7879; train_masked_gp_l1_reg_loss: 69531.7184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84932.5277; train_chrom_access_recon_loss: 5422647.2197; train_global_loss: 21799834.7879; train_optim_loss: 21799834.7879; val_kl_reg_loss: 101867.7383; val_edge_recon_loss: 2773494.0625; val_gene_expr_recon_loss: 13525243.7500; val_masked_gp_l1_reg_loss: 69521.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84915.3594; val_chrom_access_recon_loss: 5396147.0625; val_global_loss: 21951190.2500; val_optim_loss: 21951190.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9421; val_auprc_score: 0.9200; val_best_acc_score: 0.8872; val_best_f1_score: 0.8938; train_kl_reg_loss: 100608.4768; train_edge_recon_loss: 2731141.8371; train_gene_expr_recon_loss: 13388279.2424; train_masked_gp_l1_reg_loss: 69519.6413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84898.8156; train_chrom_access_recon_loss: 5426679.2727; train_global_loss: 21801127.3333; train_optim_loss: 21801127.3333; val_kl_reg_loss: 101619.4746; val_edge_recon_loss: 2737355.2500; val_gene_expr_recon_loss: 13456447.3750; val_masked_gp_l1_reg_loss: 69515.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84884.2266; val_chrom_access_recon_loss: 5437157.6875; val_global_loss: 21886980.0000; val_optim_loss: 21886980.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9308; val_auprc_score: 0.8973; val_best_acc_score: 0.8778; val_best_f1_score: 0.8852; train_kl_reg_loss: 100748.0575; train_edge_recon_loss: 2728801.5379; train_gene_expr_recon_loss: 13400682.7576; train_masked_gp_l1_reg_loss: 69515.6927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84863.4589; train_chrom_access_recon_loss: 5424450.2576; train_global_loss: 21809061.7576; train_optim_loss: 21809061.7576; val_kl_reg_loss: 101754.2441; val_edge_recon_loss: 2788597.6875; val_gene_expr_recon_loss: 13511163.5000; val_masked_gp_l1_reg_loss: 69512.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84852.0469; val_chrom_access_recon_loss: 5408723.3750; val_global_loss: 21964604.0000; val_optim_loss: 21964604.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9348; val_auprc_score: 0.9120; val_best_acc_score: 0.8764; val_best_f1_score: 0.8833; train_kl_reg_loss: 100826.1480; train_edge_recon_loss: 2734977.6288; train_gene_expr_recon_loss: 13382605.1212; train_masked_gp_l1_reg_loss: 69513.7719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84837.9538; train_chrom_access_recon_loss: 5421299.3788; train_global_loss: 21794060.0000; train_optim_loss: 21794060.0000; val_kl_reg_loss: 102175.5029; val_edge_recon_loss: 2778087.8125; val_gene_expr_recon_loss: 13476053.3750; val_masked_gp_l1_reg_loss: 69511.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84823.0469; val_chrom_access_recon_loss: 5415224.8125; val_global_loss: 21925876.5000; val_optim_loss: 21925876.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9319; val_auprc_score: 0.9114; val_best_acc_score: 0.8748; val_best_f1_score: 0.8826; train_kl_reg_loss: 100879.5683; train_edge_recon_loss: 2733459.2992; train_gene_expr_recon_loss: 13395870.6212; train_masked_gp_l1_reg_loss: 69517.5832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84808.7598; train_chrom_access_recon_loss: 5427550.6742; train_global_loss: 21812086.4848; train_optim_loss: 21812086.4848; val_kl_reg_loss: 102477.7822; val_edge_recon_loss: 2807065.3125; val_gene_expr_recon_loss: 13485425.8750; val_masked_gp_l1_reg_loss: 69514.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84789.1562; val_chrom_access_recon_loss: 5447563.6875; val_global_loss: 21996836.7500; val_optim_loss: 21996836.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9462; val_auprc_score: 0.9312; val_best_acc_score: 0.8912; val_best_f1_score: 0.8966; train_kl_reg_loss: 100866.2923; train_edge_recon_loss: 2739137.8712; train_gene_expr_recon_loss: 13394977.0000; train_masked_gp_l1_reg_loss: 69519.6868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84777.4671; train_chrom_access_recon_loss: 5426335.9545; train_global_loss: 21815614.3333; train_optim_loss: 21815614.3333; val_kl_reg_loss: 102506.0010; val_edge_recon_loss: 2727509.7188; val_gene_expr_recon_loss: 13512777.6250; val_masked_gp_l1_reg_loss: 69518.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84765.4219; val_chrom_access_recon_loss: 5384615.4375; val_global_loss: 21881693.0000; val_optim_loss: 21881693.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9355; val_auprc_score: 0.9076; val_best_acc_score: 0.8826; val_best_f1_score: 0.8902; train_kl_reg_loss: 100834.7764; train_edge_recon_loss: 2740013.2879; train_gene_expr_recon_loss: 13390821.6061; train_masked_gp_l1_reg_loss: 69523.0810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84761.2144; train_chrom_access_recon_loss: 5425245.0606; train_global_loss: 21811199.0000; train_optim_loss: 21811199.0000; val_kl_reg_loss: 102202.9707; val_edge_recon_loss: 2758675.2500; val_gene_expr_recon_loss: 13557810.0000; val_masked_gp_l1_reg_loss: 69522.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84749.9922; val_chrom_access_recon_loss: 5448979.9375; val_global_loss: 22021940.5000; val_optim_loss: 22021940.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9360; val_auprc_score: 0.9113; val_best_acc_score: 0.8818; val_best_f1_score: 0.8895; train_kl_reg_loss: 100732.4883; train_edge_recon_loss: 2743148.3485; train_gene_expr_recon_loss: 13381343.7879; train_masked_gp_l1_reg_loss: 69527.3137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84737.7895; train_chrom_access_recon_loss: 5418658.2803; train_global_loss: 21798147.9394; train_optim_loss: 21798147.9394; val_kl_reg_loss: 101843.7275; val_edge_recon_loss: 2752391.5312; val_gene_expr_recon_loss: 13480285.2500; val_masked_gp_l1_reg_loss: 69527.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84721.2812; val_chrom_access_recon_loss: 5423130.1250; val_global_loss: 21911900.2500; val_optim_loss: 21911900.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9300; val_auprc_score: 0.8975; val_best_acc_score: 0.8759; val_best_f1_score: 0.8831; train_kl_reg_loss: 100837.2886; train_edge_recon_loss: 2739954.8447; train_gene_expr_recon_loss: 13399316.2727; train_masked_gp_l1_reg_loss: 69532.7656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84705.3400; train_chrom_access_recon_loss: 5426558.6970; train_global_loss: 21820905.3636; train_optim_loss: 21820905.3636; val_kl_reg_loss: 101739.2764; val_edge_recon_loss: 2768391.9375; val_gene_expr_recon_loss: 13615875.0000; val_masked_gp_l1_reg_loss: 69533.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84693.8438; val_chrom_access_recon_loss: 5417845.0000; val_global_loss: 22058079.2500; val_optim_loss: 22058079.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9333; val_auprc_score: 0.9084; val_best_acc_score: 0.8764; val_best_f1_score: 0.8842; train_kl_reg_loss: 100750.2524; train_edge_recon_loss: 2739455.9924; train_gene_expr_recon_loss: 13390222.1364; train_masked_gp_l1_reg_loss: 69538.5704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84683.1420; train_chrom_access_recon_loss: 5423316.5682; train_global_loss: 21807966.5758; train_optim_loss: 21807966.5758; val_kl_reg_loss: 102377.7822; val_edge_recon_loss: 2779023.4688; val_gene_expr_recon_loss: 13599631.1250; val_masked_gp_l1_reg_loss: 69540.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84673.0156; val_chrom_access_recon_loss: 5487833.0000; val_global_loss: 22123078.2500; val_optim_loss: 22123078.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9342; val_auprc_score: 0.9116; val_best_acc_score: 0.8794; val_best_f1_score: 0.8866; train_kl_reg_loss: 100870.4827; train_edge_recon_loss: 2728306.8826; train_gene_expr_recon_loss: 13385590.7727; train_masked_gp_l1_reg_loss: 69530.6470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84322.4956; train_chrom_access_recon_loss: 5426157.8409; train_global_loss: 21794779.1515; train_optim_loss: 21794779.1515; val_kl_reg_loss: 101734.9160; val_edge_recon_loss: 2791143.2500; val_gene_expr_recon_loss: 13397787.1250; val_masked_gp_l1_reg_loss: 69523.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84256.7109; val_chrom_access_recon_loss: 5386197.5000; val_global_loss: 21830642.5000; val_optim_loss: 21830642.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9377; val_auprc_score: 0.9142; val_best_acc_score: 0.8826; val_best_f1_score: 0.8900; train_kl_reg_loss: 100891.2159; train_edge_recon_loss: 2730735.1629; train_gene_expr_recon_loss: 13397697.0000; train_masked_gp_l1_reg_loss: 69519.8926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84251.2221; train_chrom_access_recon_loss: 5431084.8485; train_global_loss: 21814179.2424; train_optim_loss: 21814179.2424; val_kl_reg_loss: 101859.4385; val_edge_recon_loss: 2762692.9688; val_gene_expr_recon_loss: 13528742.8750; val_masked_gp_l1_reg_loss: 69517.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84248.2422; val_chrom_access_recon_loss: 5436342.1250; val_global_loss: 21983402.5000; val_optim_loss: 21983402.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9371; val_auprc_score: 0.9097; val_best_acc_score: 0.8821; val_best_f1_score: 0.8882; train_kl_reg_loss: 100825.0245; train_edge_recon_loss: 2728296.9053; train_gene_expr_recon_loss: 13388313.9091; train_masked_gp_l1_reg_loss: 69515.9240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84246.4427; train_chrom_access_recon_loss: 5427854.9242; train_global_loss: 21799053.0606; train_optim_loss: 21799053.0606; val_kl_reg_loss: 102236.7998; val_edge_recon_loss: 2737809.5312; val_gene_expr_recon_loss: 13525841.1250; val_masked_gp_l1_reg_loss: 69514.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84244.0000; val_chrom_access_recon_loss: 5418920.1250; val_global_loss: 21938566.0000; val_optim_loss: 21938566.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9307; val_auprc_score: 0.9041; val_best_acc_score: 0.8710; val_best_f1_score: 0.8805; train_kl_reg_loss: 100815.1197; train_edge_recon_loss: 2740175.8674; train_gene_expr_recon_loss: 13398729.1061; train_masked_gp_l1_reg_loss: 69513.7929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84241.6908; train_chrom_access_recon_loss: 5428542.5985; train_global_loss: 21822017.9394; train_optim_loss: 21822017.9394; val_kl_reg_loss: 102300.8193; val_edge_recon_loss: 2797707.2188; val_gene_expr_recon_loss: 13531560.2500; val_masked_gp_l1_reg_loss: 69513.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84240.1094; val_chrom_access_recon_loss: 5386247.1250; val_global_loss: 21971568.5000; val_optim_loss: 21971568.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9360; val_auprc_score: 0.9087; val_best_acc_score: 0.8815; val_best_f1_score: 0.8887; train_kl_reg_loss: 100851.3542; train_edge_recon_loss: 2737483.1667; train_gene_expr_recon_loss: 13388655.8636; train_masked_gp_l1_reg_loss: 69512.9885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84238.4527; train_chrom_access_recon_loss: 5423723.6515; train_global_loss: 21804465.5758; train_optim_loss: 21804465.5758; val_kl_reg_loss: 102237.2451; val_edge_recon_loss: 2775596.2188; val_gene_expr_recon_loss: 13641473.8750; val_masked_gp_l1_reg_loss: 69512.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84237.0000; val_chrom_access_recon_loss: 5406695.6250; val_global_loss: 22079753.0000; val_optim_loss: 22079753.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9356; val_auprc_score: 0.9130; val_best_acc_score: 0.8761; val_best_f1_score: 0.8840; train_kl_reg_loss: 100876.6388; train_edge_recon_loss: 2743405.8485; train_gene_expr_recon_loss: 13392163.3030; train_masked_gp_l1_reg_loss: 69511.6327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84201.8909; train_chrom_access_recon_loss: 5423656.1591; train_global_loss: 21813815.3030; train_optim_loss: 21813815.3030; val_kl_reg_loss: 101887.1074; val_edge_recon_loss: 2783350.9688; val_gene_expr_recon_loss: 13493234.8750; val_masked_gp_l1_reg_loss: 69510.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84195.2656; val_chrom_access_recon_loss: 5406428.5625; val_global_loss: 21938607.2500; val_optim_loss: 21938607.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9304; val_auprc_score: 0.9031; val_best_acc_score: 0.8788; val_best_f1_score: 0.8863; train_kl_reg_loss: 100899.1675; train_edge_recon_loss: 2730972.1288; train_gene_expr_recon_loss: 13388146.0606; train_masked_gp_l1_reg_loss: 69510.5705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84194.7850; train_chrom_access_recon_loss: 5422977.8182; train_global_loss: 21796700.5758; train_optim_loss: 21796700.5758; val_kl_reg_loss: 102597.1387; val_edge_recon_loss: 2775163.3750; val_gene_expr_recon_loss: 13514502.6250; val_masked_gp_l1_reg_loss: 69510.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84194.4531; val_chrom_access_recon_loss: 5411962.6875; val_global_loss: 21957930.0000; val_optim_loss: 21957930.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9414; val_auprc_score: 0.9220; val_best_acc_score: 0.8866; val_best_f1_score: 0.8927; train_kl_reg_loss: 100869.6746; train_edge_recon_loss: 2727819.8144; train_gene_expr_recon_loss: 13399432.1667; train_masked_gp_l1_reg_loss: 69510.1604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84194.2848; train_chrom_access_recon_loss: 5426168.0076; train_global_loss: 21807993.6364; train_optim_loss: 21807993.6364; val_kl_reg_loss: 102703.9150; val_edge_recon_loss: 2729107.1875; val_gene_expr_recon_loss: 13615512.7500; val_masked_gp_l1_reg_loss: 69509.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84193.9844; val_chrom_access_recon_loss: 5454188.7500; val_global_loss: 22055216.5000; val_optim_loss: 22055216.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9356; val_auprc_score: 0.9154; val_best_acc_score: 0.8769; val_best_f1_score: 0.8842; train_kl_reg_loss: 100810.7362; train_edge_recon_loss: 2741212.1023; train_gene_expr_recon_loss: 13396968.8333; train_masked_gp_l1_reg_loss: 69509.8961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84193.8518; train_chrom_access_recon_loss: 5428024.1061; train_global_loss: 21820719.7273; train_optim_loss: 21820719.7273; val_kl_reg_loss: 102825.0391; val_edge_recon_loss: 2779372.7812; val_gene_expr_recon_loss: 13421415.8750; val_masked_gp_l1_reg_loss: 69509.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84193.6016; val_chrom_access_recon_loss: 5380722.0625; val_global_loss: 21838040.0000; val_optim_loss: 21838040.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 7 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9370
val AUPRC score: 0.9151
val best accuracy score: 0.8831
val best F1 score: 0.8898
val target rna MSE score: 0.9329
val source rna MSE score: 0.2736
val target atac MSE score: 0.4785
val source atac MSE score: 0.1056
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
