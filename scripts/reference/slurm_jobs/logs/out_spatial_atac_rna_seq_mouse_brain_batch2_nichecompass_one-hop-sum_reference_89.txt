[True]
Run timestamp: 10082023_230513_89.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_89']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7315; val_auprc_score: 0.7579; val_best_acc_score: 0.5162; val_best_f1_score: 0.6721; train_kl_reg_loss: 155312.4112; train_edge_recon_loss: 3748437.7061; train_gene_expr_recon_loss: 45080424.0611; train_masked_gp_l1_reg_loss: 83595.4506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244903.5619; train_chrom_access_recon_loss: 4099402.6393; train_global_loss: 53412076.2748; train_optim_loss: 53412076.2748; val_kl_reg_loss: 326755.1250; val_edge_recon_loss: 4064090.7000; val_gene_expr_recon_loss: 38133441.3333; val_masked_gp_l1_reg_loss: 79240.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 238485.2344; val_chrom_access_recon_loss: 3903692.4500; val_global_loss: 46745703.7333; val_optim_loss: 46745703.7333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7714; val_auprc_score: 0.7856; val_best_acc_score: 0.6578; val_best_f1_score: 0.7232; train_kl_reg_loss: 239491.2776; train_edge_recon_loss: 3611424.1050; train_gene_expr_recon_loss: 37459302.3206; train_masked_gp_l1_reg_loss: 75607.4330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231732.1267; train_chrom_access_recon_loss: 3833148.9733; train_global_loss: 45450706.1374; train_optim_loss: 45450706.1374; val_kl_reg_loss: 234874.7750; val_edge_recon_loss: 4053473.8333; val_gene_expr_recon_loss: 37140259.7333; val_masked_gp_l1_reg_loss: 73884.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224945.4844; val_chrom_access_recon_loss: 3850072.1667; val_global_loss: 45577509.0667; val_optim_loss: 45577509.0667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8784; val_auprc_score: 0.8759; val_best_acc_score: 0.7615; val_best_f1_score: 0.7915; train_kl_reg_loss: 199400.0474; train_edge_recon_loss: 3572123.4427; train_gene_expr_recon_loss: 36891141.8321; train_masked_gp_l1_reg_loss: 74377.9060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 218480.6803; train_chrom_access_recon_loss: 3800886.3053; train_global_loss: 44756410.0458; train_optim_loss: 44756410.0458; val_kl_reg_loss: 166370.8010; val_edge_recon_loss: 3972231.6500; val_gene_expr_recon_loss: 36622346.6667; val_masked_gp_l1_reg_loss: 75668.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 212089.1406; val_chrom_access_recon_loss: 3809658.1833; val_global_loss: 44858363.7333; val_optim_loss: 44858363.7333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9071; val_auprc_score: 0.8999; val_best_acc_score: 0.8290; val_best_f1_score: 0.8385; train_kl_reg_loss: 162004.4814; train_edge_recon_loss: 3502008.2214; train_gene_expr_recon_loss: 36549140.5496; train_masked_gp_l1_reg_loss: 77314.3247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 206216.7679; train_chrom_access_recon_loss: 3778233.9905; train_global_loss: 44274918.2290; train_optim_loss: 44274918.2290; val_kl_reg_loss: 139279.3896; val_edge_recon_loss: 3534159.1333; val_gene_expr_recon_loss: 36490912.0000; val_masked_gp_l1_reg_loss: 78840.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 200544.4844; val_chrom_access_recon_loss: 3814031.9000; val_global_loss: 44257766.4000; val_optim_loss: 44257766.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9096; val_auprc_score: 0.8979; val_best_acc_score: 0.8314; val_best_f1_score: 0.8413; train_kl_reg_loss: 152984.5281; train_edge_recon_loss: 3174783.4828; train_gene_expr_recon_loss: 36339378.1679; train_masked_gp_l1_reg_loss: 82815.5883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 195476.6820; train_chrom_access_recon_loss: 3761724.3969; train_global_loss: 43707163.0229; train_optim_loss: 43707163.0229; val_kl_reg_loss: 190319.6927; val_edge_recon_loss: 3015063.7333; val_gene_expr_recon_loss: 36287132.2667; val_masked_gp_l1_reg_loss: 85107.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190500.2188; val_chrom_access_recon_loss: 3801839.1167; val_global_loss: 43569963.2000; val_optim_loss: 43569963.2000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9228; val_auprc_score: 0.9117; val_best_acc_score: 0.8510; val_best_f1_score: 0.8580; train_kl_reg_loss: 187546.6855; train_edge_recon_loss: 2975208.1794; train_gene_expr_recon_loss: 36064571.3588; train_masked_gp_l1_reg_loss: 85969.4512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185815.0074; train_chrom_access_recon_loss: 3740381.3111; train_global_loss: 43239492.4580; train_optim_loss: 43239492.4580; val_kl_reg_loss: 190571.7146; val_edge_recon_loss: 2958886.0833; val_gene_expr_recon_loss: 36029689.8667; val_masked_gp_l1_reg_loss: 87059.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181157.2031; val_chrom_access_recon_loss: 3778061.5167; val_global_loss: 43225425.3333; val_optim_loss: 43225425.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9260; val_auprc_score: 0.9111; val_best_acc_score: 0.8592; val_best_f1_score: 0.8642; train_kl_reg_loss: 184953.4776; train_edge_recon_loss: 2931957.6908; train_gene_expr_recon_loss: 35852002.4427; train_masked_gp_l1_reg_loss: 88176.1682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176854.1644; train_chrom_access_recon_loss: 3724753.6412; train_global_loss: 42958697.4046; train_optim_loss: 42958697.4046; val_kl_reg_loss: 180588.1990; val_edge_recon_loss: 2940045.1833; val_gene_expr_recon_loss: 35789355.7333; val_masked_gp_l1_reg_loss: 89223.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172509.1562; val_chrom_access_recon_loss: 3759847.6167; val_global_loss: 42931568.8000; val_optim_loss: 42931568.8000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9318; val_auprc_score: 0.9213; val_best_acc_score: 0.8643; val_best_f1_score: 0.8702; train_kl_reg_loss: 181289.3055; train_edge_recon_loss: 2901893.5649; train_gene_expr_recon_loss: 35676271.8168; train_masked_gp_l1_reg_loss: 90369.0606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168558.3504; train_chrom_access_recon_loss: 3709532.6088; train_global_loss: 42727914.9008; train_optim_loss: 42727914.9008; val_kl_reg_loss: 173333.7240; val_edge_recon_loss: 2907773.1333; val_gene_expr_recon_loss: 35669622.9333; val_masked_gp_l1_reg_loss: 91579.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164635.8281; val_chrom_access_recon_loss: 3751318.0500; val_global_loss: 42758263.7333; val_optim_loss: 42758263.7333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9399; val_auprc_score: 0.9283; val_best_acc_score: 0.8748; val_best_f1_score: 0.8806; train_kl_reg_loss: 172552.1085; train_edge_recon_loss: 2882288.4962; train_gene_expr_recon_loss: 35532632.5344; train_masked_gp_l1_reg_loss: 92691.7734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160902.9122; train_chrom_access_recon_loss: 3698207.3187; train_global_loss: 42539274.9924; train_optim_loss: 42539274.9924; val_kl_reg_loss: 164523.7083; val_edge_recon_loss: 2886623.8667; val_gene_expr_recon_loss: 35613199.4667; val_masked_gp_l1_reg_loss: 93794.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157230.5000; val_chrom_access_recon_loss: 3724076.2667; val_global_loss: 42639451.4667; val_optim_loss: 42639451.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9389; val_auprc_score: 0.9286; val_best_acc_score: 0.8727; val_best_f1_score: 0.8809; train_kl_reg_loss: 166982.7666; train_edge_recon_loss: 2876125.8473; train_gene_expr_recon_loss: 35386051.9237; train_masked_gp_l1_reg_loss: 94954.7085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153799.9473; train_chrom_access_recon_loss: 3686959.1317; train_global_loss: 42364874.6565; train_optim_loss: 42364874.6565; val_kl_reg_loss: 163756.3271; val_edge_recon_loss: 2878963.2667; val_gene_expr_recon_loss: 35465303.7333; val_masked_gp_l1_reg_loss: 95997.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150482.8906; val_chrom_access_recon_loss: 3721483.4000; val_global_loss: 42475986.9333; val_optim_loss: 42475986.9333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9450; val_auprc_score: 0.9366; val_best_acc_score: 0.8797; val_best_f1_score: 0.8857; train_kl_reg_loss: 161163.6515; train_edge_recon_loss: 2860251.2844; train_gene_expr_recon_loss: 35241965.9542; train_masked_gp_l1_reg_loss: 96952.6627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147428.5001; train_chrom_access_recon_loss: 3674084.1908; train_global_loss: 42181846.2595; train_optim_loss: 42181846.2595; val_kl_reg_loss: 157433.7323; val_edge_recon_loss: 2849796.6667; val_gene_expr_recon_loss: 35377050.1333; val_masked_gp_l1_reg_loss: 97834.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144403.4375; val_chrom_access_recon_loss: 3713441.9833; val_global_loss: 42339962.6667; val_optim_loss: 42339962.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9434; val_auprc_score: 0.9322; val_best_acc_score: 0.8791; val_best_f1_score: 0.8858; train_kl_reg_loss: 156837.0750; train_edge_recon_loss: 2857183.2023; train_gene_expr_recon_loss: 35160068.3664; train_masked_gp_l1_reg_loss: 98824.1667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141498.6094; train_chrom_access_recon_loss: 3670418.7710; train_global_loss: 42084830.3511; train_optim_loss: 42084830.3511; val_kl_reg_loss: 151496.9979; val_edge_recon_loss: 2852875.7000; val_gene_expr_recon_loss: 35095750.1333; val_masked_gp_l1_reg_loss: 99871.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138623.5469; val_chrom_access_recon_loss: 3688087.5667; val_global_loss: 42026706.1333; val_optim_loss: 42026706.1333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9470; val_auprc_score: 0.9376; val_best_acc_score: 0.8835; val_best_f1_score: 0.8876; train_kl_reg_loss: 152434.7755; train_edge_recon_loss: 2842690.5191; train_gene_expr_recon_loss: 35040653.9847; train_masked_gp_l1_reg_loss: 100775.5002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135834.7248; train_chrom_access_recon_loss: 3658044.0630; train_global_loss: 41930433.4351; train_optim_loss: 41930433.4351; val_kl_reg_loss: 151190.3896; val_edge_recon_loss: 2869195.5500; val_gene_expr_recon_loss: 35097071.4667; val_masked_gp_l1_reg_loss: 101681.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133061.1562; val_chrom_access_recon_loss: 3702217.5667; val_global_loss: 42054414.9333; val_optim_loss: 42054414.9333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9485; val_auprc_score: 0.9385; val_best_acc_score: 0.8883; val_best_f1_score: 0.8912; train_kl_reg_loss: 148567.4177; train_edge_recon_loss: 2829524.0401; train_gene_expr_recon_loss: 34976991.0687; train_masked_gp_l1_reg_loss: 102572.1883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130396.2004; train_chrom_access_recon_loss: 3653194.4828; train_global_loss: 41841245.3435; train_optim_loss: 41841245.3435; val_kl_reg_loss: 145614.1198; val_edge_recon_loss: 2833192.5333; val_gene_expr_recon_loss: 35061468.8000; val_masked_gp_l1_reg_loss: 103514.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127738.9375; val_chrom_access_recon_loss: 3694191.6833; val_global_loss: 41965722.4000; val_optim_loss: 41965722.4000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9497; val_auprc_score: 0.9418; val_best_acc_score: 0.8874; val_best_f1_score: 0.8913; train_kl_reg_loss: 144599.6112; train_edge_recon_loss: 2814856.7462; train_gene_expr_recon_loss: 34888857.5878; train_masked_gp_l1_reg_loss: 104417.7761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125248.7854; train_chrom_access_recon_loss: 3648702.3874; train_global_loss: 41726682.8397; train_optim_loss: 41726682.8397; val_kl_reg_loss: 143848.0781; val_edge_recon_loss: 2818643.1833; val_gene_expr_recon_loss: 35004444.5333; val_masked_gp_l1_reg_loss: 105283.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122765.7188; val_chrom_access_recon_loss: 3698612.9000; val_global_loss: 41893596.0000; val_optim_loss: 41893596.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9535; val_auprc_score: 0.9440; val_best_acc_score: 0.8895; val_best_f1_score: 0.8948; train_kl_reg_loss: 140838.8482; train_edge_recon_loss: 2814005.1641; train_gene_expr_recon_loss: 34820543.4351; train_masked_gp_l1_reg_loss: 106115.1084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120449.5878; train_chrom_access_recon_loss: 3645358.7653; train_global_loss: 41647311.1145; train_optim_loss: 41647311.1145; val_kl_reg_loss: 139332.2729; val_edge_recon_loss: 2815703.6500; val_gene_expr_recon_loss: 34959348.2667; val_masked_gp_l1_reg_loss: 107151.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118184.5312; val_chrom_access_recon_loss: 3692297.9667; val_global_loss: 41832017.6000; val_optim_loss: 41832017.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9565; val_auprc_score: 0.9488; val_best_acc_score: 0.8936; val_best_f1_score: 0.8959; train_kl_reg_loss: 137295.1209; train_edge_recon_loss: 2805020.9447; train_gene_expr_recon_loss: 34712459.9389; train_masked_gp_l1_reg_loss: 107966.5401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115983.6290; train_chrom_access_recon_loss: 3634472.2042; train_global_loss: 41513198.4733; train_optim_loss: 41513198.4733; val_kl_reg_loss: 136143.3021; val_edge_recon_loss: 2819404.9000; val_gene_expr_recon_loss: 34873017.3333; val_masked_gp_l1_reg_loss: 108935.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113774.6797; val_chrom_access_recon_loss: 3688712.6000; val_global_loss: 41739990.4000; val_optim_loss: 41739990.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9580; val_auprc_score: 0.9520; val_best_acc_score: 0.8956; val_best_f1_score: 0.8987; train_kl_reg_loss: 135066.2295; train_edge_recon_loss: 2798195.0553; train_gene_expr_recon_loss: 34632754.5344; train_masked_gp_l1_reg_loss: 109732.9561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111666.8044; train_chrom_access_recon_loss: 3628487.8740; train_global_loss: 41415903.5725; train_optim_loss: 41415903.5725; val_kl_reg_loss: 136574.4135; val_edge_recon_loss: 2801353.1667; val_gene_expr_recon_loss: 34762971.7333; val_masked_gp_l1_reg_loss: 110636.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109583.0703; val_chrom_access_recon_loss: 3673243.5833; val_global_loss: 41594363.7333; val_optim_loss: 41594363.7333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9573; val_auprc_score: 0.9476; val_best_acc_score: 0.8989; val_best_f1_score: 0.9026; train_kl_reg_loss: 133645.8712; train_edge_recon_loss: 2782994.0382; train_gene_expr_recon_loss: 34616779.0229; train_masked_gp_l1_reg_loss: 111538.2134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107650.9314; train_chrom_access_recon_loss: 3629447.8168; train_global_loss: 41382055.9084; train_optim_loss: 41382055.9084; val_kl_reg_loss: 129429.5167; val_edge_recon_loss: 2799875.4500; val_gene_expr_recon_loss: 34793101.3333; val_masked_gp_l1_reg_loss: 112439.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105723.1094; val_chrom_access_recon_loss: 3678975.0833; val_global_loss: 41619545.6000; val_optim_loss: 41619545.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9591; val_auprc_score: 0.9524; val_best_acc_score: 0.8981; val_best_f1_score: 0.9011; train_kl_reg_loss: 131909.8553; train_edge_recon_loss: 2779143.5324; train_gene_expr_recon_loss: 34539731.5267; train_masked_gp_l1_reg_loss: 113392.1456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103870.3749; train_chrom_access_recon_loss: 3623466.1011; train_global_loss: 41291513.8015; train_optim_loss: 41291513.8015; val_kl_reg_loss: 132079.8354; val_edge_recon_loss: 2810073.6667; val_gene_expr_recon_loss: 34670788.8000; val_masked_gp_l1_reg_loss: 114510.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101961.7812; val_chrom_access_recon_loss: 3667030.3000; val_global_loss: 41496444.2667; val_optim_loss: 41496444.2667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9627; val_auprc_score: 0.9550; val_best_acc_score: 0.9045; val_best_f1_score: 0.9071; train_kl_reg_loss: 128577.6208; train_edge_recon_loss: 2774319.9065; train_gene_expr_recon_loss: 34455085.7405; train_masked_gp_l1_reg_loss: 115261.8799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100285.3983; train_chrom_access_recon_loss: 3618464.0191; train_global_loss: 41191994.4427; train_optim_loss: 41191994.4427; val_kl_reg_loss: 126658.7531; val_edge_recon_loss: 2772511.2833; val_gene_expr_recon_loss: 34596480.2667; val_masked_gp_l1_reg_loss: 116271.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98565.0469; val_chrom_access_recon_loss: 3665626.5667; val_global_loss: 41376112.8000; val_optim_loss: 41376112.8000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9644; val_auprc_score: 0.9583; val_best_acc_score: 0.9058; val_best_f1_score: 0.9076; train_kl_reg_loss: 127138.2476; train_edge_recon_loss: 2772348.9332; train_gene_expr_recon_loss: 34412019.1756; train_masked_gp_l1_reg_loss: 117190.1636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96957.4778; train_chrom_access_recon_loss: 3616693.0782; train_global_loss: 41142347.3588; train_optim_loss: 41142347.3588; val_kl_reg_loss: 127130.9677; val_edge_recon_loss: 2766085.5000; val_gene_expr_recon_loss: 34442512.2667; val_masked_gp_l1_reg_loss: 118174.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95327.4062; val_chrom_access_recon_loss: 3655892.5500; val_global_loss: 41205125.6000; val_optim_loss: 41205125.6000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9654; val_auprc_score: 0.9581; val_best_acc_score: 0.9077; val_best_f1_score: 0.9108; train_kl_reg_loss: 124456.9221; train_edge_recon_loss: 2764229.1813; train_gene_expr_recon_loss: 34367531.7405; train_masked_gp_l1_reg_loss: 119157.3393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93793.6947; train_chrom_access_recon_loss: 3614527.8817; train_global_loss: 41083696.6718; train_optim_loss: 41083696.6718; val_kl_reg_loss: 124822.0281; val_edge_recon_loss: 2773536.1333; val_gene_expr_recon_loss: 34412901.2000; val_masked_gp_l1_reg_loss: 120230.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92321.9844; val_chrom_access_recon_loss: 3647695.9667; val_global_loss: 41171507.2000; val_optim_loss: 41171507.2000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9679; val_auprc_score: 0.9617; val_best_acc_score: 0.9120; val_best_f1_score: 0.9154; train_kl_reg_loss: 123148.8842; train_edge_recon_loss: 2763385.0076; train_gene_expr_recon_loss: 34333580.1221; train_masked_gp_l1_reg_loss: 121001.4553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90882.3751; train_chrom_access_recon_loss: 3617482.6718; train_global_loss: 41049480.8244; train_optim_loss: 41049480.8244; val_kl_reg_loss: 120793.2844; val_edge_recon_loss: 2773482.6833; val_gene_expr_recon_loss: 34329956.2667; val_masked_gp_l1_reg_loss: 121954.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89435.7344; val_chrom_access_recon_loss: 3643389.9333; val_global_loss: 41079013.6000; val_optim_loss: 41079013.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9706; val_auprc_score: 0.9643; val_best_acc_score: 0.9163; val_best_f1_score: 0.9174; train_kl_reg_loss: 122798.0183; train_edge_recon_loss: 2751074.3168; train_gene_expr_recon_loss: 34251669.1603; train_masked_gp_l1_reg_loss: 122775.8711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88128.0271; train_chrom_access_recon_loss: 3611302.1393; train_global_loss: 40947747.7252; train_optim_loss: 40947747.7252; val_kl_reg_loss: 124260.9302; val_edge_recon_loss: 2754436.6333; val_gene_expr_recon_loss: 34385378.0000; val_masked_gp_l1_reg_loss: 123669.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86886.8984; val_chrom_access_recon_loss: 3644640.6333; val_global_loss: 41119272.2667; val_optim_loss: 41119272.2667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9545; val_auprc_score: 0.9465; val_best_acc_score: 0.8953; val_best_f1_score: 0.8991; train_kl_reg_loss: 151988.7723; train_edge_recon_loss: 2977248.6584; train_gene_expr_recon_loss: 38705275.5420; train_masked_gp_l1_reg_loss: 126485.6093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93495.3505; train_chrom_access_recon_loss: 3813112.2023; train_global_loss: 45867605.8015; train_optim_loss: 45867605.8015; val_kl_reg_loss: 22529.4284; val_edge_recon_loss: 2946582.7333; val_gene_expr_recon_loss: 37990093.8667; val_masked_gp_l1_reg_loss: 127484.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94263.2578; val_chrom_access_recon_loss: 3803162.9000; val_global_loss: 44984116.8000; val_optim_loss: 44984116.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9362; val_auprc_score: 0.9212; val_best_acc_score: 0.8762; val_best_f1_score: 0.8820; train_kl_reg_loss: 138381.9740; train_edge_recon_loss: 2901362.6508; train_gene_expr_recon_loss: 40056567.6336; train_masked_gp_l1_reg_loss: 127568.2711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93801.7911; train_chrom_access_recon_loss: 3811626.0095; train_global_loss: 47129308.3664; train_optim_loss: 47129308.3664; val_kl_reg_loss: 20474.5410; val_edge_recon_loss: 2804976.3500; val_gene_expr_recon_loss: 41201117.0667; val_masked_gp_l1_reg_loss: 126362.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92685.6250; val_chrom_access_recon_loss: 3871200.4167; val_global_loss: 48116815.4667; val_optim_loss: 48116815.4667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9368; val_auprc_score: 0.9182; val_best_acc_score: 0.8785; val_best_f1_score: 0.8850; train_kl_reg_loss: 76878.5493; train_edge_recon_loss: 2794036.3588; train_gene_expr_recon_loss: 40728486.2290; train_masked_gp_l1_reg_loss: 123677.1106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90529.2935; train_chrom_access_recon_loss: 3811842.2252; train_global_loss: 47625449.5878; train_optim_loss: 47625449.5878; val_kl_reg_loss: 26336.5362; val_edge_recon_loss: 2775796.7833; val_gene_expr_recon_loss: 40424843.2000; val_masked_gp_l1_reg_loss: 120869.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88268.2656; val_chrom_access_recon_loss: 3862292.0000; val_global_loss: 47298404.5333; val_optim_loss: 47298404.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9335; val_auprc_score: 0.9133; val_best_acc_score: 0.8763; val_best_f1_score: 0.8826; train_kl_reg_loss: 65239.5515; train_edge_recon_loss: 2764941.3302; train_gene_expr_recon_loss: 40283963.0840; train_masked_gp_l1_reg_loss: 120355.6522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87999.1978; train_chrom_access_recon_loss: 3799656.3760; train_global_loss: 47122155.1450; train_optim_loss: 47122155.1450; val_kl_reg_loss: 27210.3730; val_edge_recon_loss: 2779583.6333; val_gene_expr_recon_loss: 40076375.2000; val_masked_gp_l1_reg_loss: 120036.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87747.7500; val_chrom_access_recon_loss: 3826649.1000; val_global_loss: 46917602.1333; val_optim_loss: 46917602.1333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9366; val_auprc_score: 0.9169; val_best_acc_score: 0.8810; val_best_f1_score: 0.8858; train_kl_reg_loss: 63382.6790; train_edge_recon_loss: 2761699.9866; train_gene_expr_recon_loss: 40203248.1221; train_masked_gp_l1_reg_loss: 119731.0512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87493.2264; train_chrom_access_recon_loss: 3793760.2691; train_global_loss: 47029315.1450; train_optim_loss: 47029315.1450; val_kl_reg_loss: 27163.4699; val_edge_recon_loss: 2788098.9667; val_gene_expr_recon_loss: 40475059.2000; val_masked_gp_l1_reg_loss: 119415.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87223.5312; val_chrom_access_recon_loss: 3857283.0000; val_global_loss: 47354244.5333; val_optim_loss: 47354244.5333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9353; val_auprc_score: 0.9161; val_best_acc_score: 0.8785; val_best_f1_score: 0.8844; train_kl_reg_loss: 61456.4331; train_edge_recon_loss: 2761918.2672; train_gene_expr_recon_loss: 40182879.6947; train_masked_gp_l1_reg_loss: 119091.0943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86955.4959; train_chrom_access_recon_loss: 3798365.8206; train_global_loss: 47010666.6870; train_optim_loss: 47010666.6870; val_kl_reg_loss: 27802.6686; val_edge_recon_loss: 2772921.4667; val_gene_expr_recon_loss: 40213566.4000; val_masked_gp_l1_reg_loss: 118756.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86676.3516; val_chrom_access_recon_loss: 3845075.7667; val_global_loss: 47064797.8667; val_optim_loss: 47064797.8667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9363; val_auprc_score: 0.9174; val_best_acc_score: 0.8791; val_best_f1_score: 0.8845; train_kl_reg_loss: 59810.4075; train_edge_recon_loss: 2763097.4294; train_gene_expr_recon_loss: 40139186.8397; train_masked_gp_l1_reg_loss: 118417.9953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86401.5759; train_chrom_access_recon_loss: 3796858.8760; train_global_loss: 46963773.0382; train_optim_loss: 46963773.0382; val_kl_reg_loss: 27304.2719; val_edge_recon_loss: 2796526.1333; val_gene_expr_recon_loss: 40314698.4000; val_masked_gp_l1_reg_loss: 118068.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86115.0547; val_chrom_access_recon_loss: 3847009.6000; val_global_loss: 47189722.1333; val_optim_loss: 47189722.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 18 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9702
val AUPRC score: 0.9640
val best accuracy score: 0.9162
val best F1 score: 0.9186
val target rna MSE score: 1.7127
val source rna MSE score: 89.5233
val target atac MSE score: 0.6351
val source atac MSE score: 15.3462
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
