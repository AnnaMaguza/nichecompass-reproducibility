[True]
Run timestamp: 10082023_211712_54.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_54']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7747; val_auprc_score: 0.7969; val_best_acc_score: 0.5187; val_best_f1_score: 0.6734; train_kl_reg_loss: 145206.9108; train_edge_recon_loss: 3737324.3779; train_gene_expr_recon_loss: 27437838.2748; train_masked_gp_l1_reg_loss: 77771.2899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241002.8069; train_chrom_access_recon_loss: 27752898.0611; train_global_loss: 59392041.4656; train_optim_loss: 59392041.4656; val_kl_reg_loss: 230692.5615; val_edge_recon_loss: 4063774.9833; val_gene_expr_recon_loss: 22683106.4000; val_masked_gp_l1_reg_loss: 72981.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 231409.5625; val_chrom_access_recon_loss: 25505932.9333; val_global_loss: 52787898.9333; val_optim_loss: 52787898.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7931; val_auprc_score: 0.8054; val_best_acc_score: 0.7001; val_best_f1_score: 0.7270; train_kl_reg_loss: 188515.1187; train_edge_recon_loss: 3586847.1508; train_gene_expr_recon_loss: 22650487.2977; train_masked_gp_l1_reg_loss: 70448.7258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 220511.2766; train_chrom_access_recon_loss: 25824621.5267; train_global_loss: 52541431.1145; train_optim_loss: 52541431.1145; val_kl_reg_loss: 175065.7427; val_edge_recon_loss: 4043390.3333; val_gene_expr_recon_loss: 22212696.0000; val_masked_gp_l1_reg_loss: 69203.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209316.2656; val_chrom_access_recon_loss: 25367536.4000; val_global_loss: 52077208.5333; val_optim_loss: 52077208.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8903; val_auprc_score: 0.8850; val_best_acc_score: 0.8013; val_best_f1_score: 0.8186; train_kl_reg_loss: 163677.5394; train_edge_recon_loss: 3539869.3282; train_gene_expr_recon_loss: 22253996.2443; train_masked_gp_l1_reg_loss: 70231.0460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 198597.3553; train_chrom_access_recon_loss: 25612912.1221; train_global_loss: 51839283.7863; train_optim_loss: 51839283.7863; val_kl_reg_loss: 149409.3219; val_edge_recon_loss: 3819855.2000; val_gene_expr_recon_loss: 21870511.8667; val_masked_gp_l1_reg_loss: 71978.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 188034.2500; val_chrom_access_recon_loss: 25130600.4000; val_global_loss: 51230388.8000; val_optim_loss: 51230388.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8930; val_auprc_score: 0.8830; val_best_acc_score: 0.8110; val_best_f1_score: 0.8223; train_kl_reg_loss: 152687.7523; train_edge_recon_loss: 3215713.6641; train_gene_expr_recon_loss: 22052338.9160; train_masked_gp_l1_reg_loss: 74338.8278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178462.4216; train_chrom_access_recon_loss: 25402724.2595; train_global_loss: 51076266.0153; train_optim_loss: 51076266.0153; val_kl_reg_loss: 186410.1875; val_edge_recon_loss: 3029540.4000; val_gene_expr_recon_loss: 21726405.0667; val_masked_gp_l1_reg_loss: 76562.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169399.9688; val_chrom_access_recon_loss: 25046658.1333; val_global_loss: 50234976.2667; val_optim_loss: 50234976.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9182; val_auprc_score: 0.9021; val_best_acc_score: 0.8464; val_best_f1_score: 0.8563; train_kl_reg_loss: 182211.7079; train_edge_recon_loss: 2995249.1298; train_gene_expr_recon_loss: 21904244.2443; train_masked_gp_l1_reg_loss: 77901.6717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 161669.5532; train_chrom_access_recon_loss: 25263439.9847; train_global_loss: 50584716.2443; train_optim_loss: 50584716.2443; val_kl_reg_loss: 169580.5365; val_edge_recon_loss: 2943393.5167; val_gene_expr_recon_loss: 21480345.8667; val_masked_gp_l1_reg_loss: 79286.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154000.5938; val_chrom_access_recon_loss: 24774486.2667; val_global_loss: 49601092.2667; val_optim_loss: 49601092.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9246; val_auprc_score: 0.9095; val_best_acc_score: 0.8529; val_best_f1_score: 0.8621; train_kl_reg_loss: 175173.3701; train_edge_recon_loss: 2930898.2958; train_gene_expr_recon_loss: 21714970.5038; train_masked_gp_l1_reg_loss: 80924.0818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147092.0494; train_chrom_access_recon_loss: 25087011.2672; train_global_loss: 50136069.8626; train_optim_loss: 50136069.8626; val_kl_reg_loss: 170043.8010; val_edge_recon_loss: 2913442.7167; val_gene_expr_recon_loss: 21462822.6667; val_masked_gp_l1_reg_loss: 82184.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140424.7500; val_chrom_access_recon_loss: 24789464.6667; val_global_loss: 49558381.8667; val_optim_loss: 49558381.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9347; val_auprc_score: 0.9221; val_best_acc_score: 0.8694; val_best_f1_score: 0.8770; train_kl_reg_loss: 167886.6953; train_edge_recon_loss: 2902330.6508; train_gene_expr_recon_loss: 21577692.7481; train_masked_gp_l1_reg_loss: 83685.7040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134465.3305; train_chrom_access_recon_loss: 24957138.3359; train_global_loss: 49823199.5420; train_optim_loss: 49823199.5420; val_kl_reg_loss: 163432.3635; val_edge_recon_loss: 2888121.0500; val_gene_expr_recon_loss: 21376408.5333; val_masked_gp_l1_reg_loss: 85159.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128677.9297; val_chrom_access_recon_loss: 24637118.4000; val_global_loss: 49278917.0667; val_optim_loss: 49278917.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9419; val_auprc_score: 0.9308; val_best_acc_score: 0.8762; val_best_f1_score: 0.8834; train_kl_reg_loss: 160983.1720; train_edge_recon_loss: 2875892.1794; train_gene_expr_recon_loss: 21492404.2901; train_masked_gp_l1_reg_loss: 86428.8282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123262.3172; train_chrom_access_recon_loss: 24885872.6870; train_global_loss: 49624843.8779; train_optim_loss: 49624843.8779; val_kl_reg_loss: 156277.2979; val_edge_recon_loss: 2849191.3000; val_gene_expr_recon_loss: 21244563.2000; val_masked_gp_l1_reg_loss: 87974.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118069.9453; val_chrom_access_recon_loss: 24584032.1333; val_global_loss: 49040107.7333; val_optim_loss: 49040107.7333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9455; val_auprc_score: 0.9323; val_best_acc_score: 0.8790; val_best_f1_score: 0.8854; train_kl_reg_loss: 156718.9624; train_edge_recon_loss: 2848145.3607; train_gene_expr_recon_loss: 21408559.5267; train_masked_gp_l1_reg_loss: 89012.8891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113349.7228; train_chrom_access_recon_loss: 24824012.0000; train_global_loss: 49439798.5344; train_optim_loss: 49439798.5344; val_kl_reg_loss: 153986.9344; val_edge_recon_loss: 2854840.7500; val_gene_expr_recon_loss: 21050262.5333; val_masked_gp_l1_reg_loss: 90193.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108799.1484; val_chrom_access_recon_loss: 24458383.4667; val_global_loss: 48716467.7333; val_optim_loss: 48716467.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9510; val_auprc_score: 0.9421; val_best_acc_score: 0.8851; val_best_f1_score: 0.8898; train_kl_reg_loss: 152304.5281; train_edge_recon_loss: 2836678.8969; train_gene_expr_recon_loss: 21337400.3511; train_masked_gp_l1_reg_loss: 91365.4547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104735.3412; train_chrom_access_recon_loss: 24763952.1069; train_global_loss: 49286436.6718; train_optim_loss: 49286436.6718; val_kl_reg_loss: 148280.8281; val_edge_recon_loss: 2848260.5000; val_gene_expr_recon_loss: 21046174.2667; val_masked_gp_l1_reg_loss: 92663.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100820.5391; val_chrom_access_recon_loss: 24335831.0667; val_global_loss: 48572029.8667; val_optim_loss: 48572029.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9536; val_auprc_score: 0.9455; val_best_acc_score: 0.8880; val_best_f1_score: 0.8944; train_kl_reg_loss: 148353.5643; train_edge_recon_loss: 2814928.6431; train_gene_expr_recon_loss: 21284162.3359; train_masked_gp_l1_reg_loss: 93589.9572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97287.8997; train_chrom_access_recon_loss: 24722962.5802; train_global_loss: 49161284.8855; train_optim_loss: 49161284.8855; val_kl_reg_loss: 146615.6562; val_edge_recon_loss: 2835474.6000; val_gene_expr_recon_loss: 21010860.8000; val_masked_gp_l1_reg_loss: 94840.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93983.4062; val_chrom_access_recon_loss: 24385550.9333; val_global_loss: 48567326.1333; val_optim_loss: 48567326.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9601; val_auprc_score: 0.9520; val_best_acc_score: 0.8965; val_best_f1_score: 0.8990; train_kl_reg_loss: 144702.3174; train_edge_recon_loss: 2806201.0973; train_gene_expr_recon_loss: 21190615.8779; train_masked_gp_l1_reg_loss: 95727.1098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91090.2261; train_chrom_access_recon_loss: 24641328.3511; train_global_loss: 48969665.0076; train_optim_loss: 48969665.0076; val_kl_reg_loss: 144424.0427; val_edge_recon_loss: 2810208.9667; val_gene_expr_recon_loss: 20955200.0000; val_masked_gp_l1_reg_loss: 96905.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88422.5391; val_chrom_access_recon_loss: 24251499.8667; val_global_loss: 48346660.8000; val_optim_loss: 48346660.8000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9609; val_auprc_score: 0.9508; val_best_acc_score: 0.8999; val_best_f1_score: 0.9031; train_kl_reg_loss: 141509.8331; train_edge_recon_loss: 2787626.1011; train_gene_expr_recon_loss: 21125070.7176; train_masked_gp_l1_reg_loss: 97833.0695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86088.4625; train_chrom_access_recon_loss: 24563889.6336; train_global_loss: 48802018.0153; train_optim_loss: 48802018.0153; val_kl_reg_loss: 140621.0948; val_edge_recon_loss: 2796861.6833; val_gene_expr_recon_loss: 20888131.8667; val_masked_gp_l1_reg_loss: 98915.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83909.2891; val_chrom_access_recon_loss: 24197895.2000; val_global_loss: 48206335.7333; val_optim_loss: 48206335.7333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9677; val_auprc_score: 0.9628; val_best_acc_score: 0.9108; val_best_f1_score: 0.9140; train_kl_reg_loss: 136667.0792; train_edge_recon_loss: 2781511.0439; train_gene_expr_recon_loss: 21032128.1069; train_masked_gp_l1_reg_loss: 99805.9353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82095.2053; train_chrom_access_recon_loss: 24507044.4580; train_global_loss: 48639251.9695; train_optim_loss: 48639251.9695; val_kl_reg_loss: 136488.4448; val_edge_recon_loss: 2790823.3167; val_gene_expr_recon_loss: 20803911.6000; val_masked_gp_l1_reg_loss: 100567.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80178.9453; val_chrom_access_recon_loss: 24118244.0000; val_global_loss: 48030213.3333; val_optim_loss: 48030213.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9681; val_auprc_score: 0.9602; val_best_acc_score: 0.9182; val_best_f1_score: 0.9209; train_kl_reg_loss: 134673.7288; train_edge_recon_loss: 2775828.4389; train_gene_expr_recon_loss: 20967423.4046; train_masked_gp_l1_reg_loss: 101553.0673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78471.0676; train_chrom_access_recon_loss: 24464432.0916; train_global_loss: 48522381.9542; train_optim_loss: 48522381.9542; val_kl_reg_loss: 134432.8844; val_edge_recon_loss: 2760699.5667; val_gene_expr_recon_loss: 20833646.1333; val_masked_gp_l1_reg_loss: 102458.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76720.2656; val_chrom_access_recon_loss: 24274624.9333; val_global_loss: 48182581.6000; val_optim_loss: 48182581.6000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9686; val_auprc_score: 0.9620; val_best_acc_score: 0.9184; val_best_f1_score: 0.9201; train_kl_reg_loss: 132766.1707; train_edge_recon_loss: 2764555.2615; train_gene_expr_recon_loss: 20919468.7176; train_masked_gp_l1_reg_loss: 103303.0256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75031.8470; train_chrom_access_recon_loss: 24418236.5496; train_global_loss: 48413361.6794; train_optim_loss: 48413361.6794; val_kl_reg_loss: 131030.7625; val_edge_recon_loss: 2778502.5500; val_gene_expr_recon_loss: 20718298.4000; val_masked_gp_l1_reg_loss: 104123.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73407.4453; val_chrom_access_recon_loss: 24074694.1333; val_global_loss: 47880057.6000; val_optim_loss: 47880057.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9724; val_auprc_score: 0.9653; val_best_acc_score: 0.9185; val_best_f1_score: 0.9217; train_kl_reg_loss: 130374.1390; train_edge_recon_loss: 2761604.0859; train_gene_expr_recon_loss: 20885985.7863; train_masked_gp_l1_reg_loss: 104964.9571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71792.9484; train_chrom_access_recon_loss: 24382078.9618; train_global_loss: 48336800.6412; train_optim_loss: 48336800.6412; val_kl_reg_loss: 128443.6417; val_edge_recon_loss: 2765805.8833; val_gene_expr_recon_loss: 20661947.7333; val_masked_gp_l1_reg_loss: 105696.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70274.5078; val_chrom_access_recon_loss: 24120490.8000; val_global_loss: 47852657.8667; val_optim_loss: 47852657.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9718; val_auprc_score: 0.9651; val_best_acc_score: 0.9214; val_best_f1_score: 0.9239; train_kl_reg_loss: 127578.6492; train_edge_recon_loss: 2749539.1489; train_gene_expr_recon_loss: 20866134.4733; train_masked_gp_l1_reg_loss: 106560.3277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68853.5784; train_chrom_access_recon_loss: 24370896.7481; train_global_loss: 48289563.2061; train_optim_loss: 48289563.2061; val_kl_reg_loss: 126234.4568; val_edge_recon_loss: 2760830.6833; val_gene_expr_recon_loss: 20632124.8000; val_masked_gp_l1_reg_loss: 107357.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67507.0703; val_chrom_access_recon_loss: 24109602.8000; val_global_loss: 47803658.6667; val_optim_loss: 47803658.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9721; val_auprc_score: 0.9637; val_best_acc_score: 0.9243; val_best_f1_score: 0.9266; train_kl_reg_loss: 124361.7312; train_edge_recon_loss: 2747668.4618; train_gene_expr_recon_loss: 20819365.5115; train_masked_gp_l1_reg_loss: 108175.7091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66198.3192; train_chrom_access_recon_loss: 24334673.1756; train_global_loss: 48200442.6870; train_optim_loss: 48200442.6870; val_kl_reg_loss: 127403.2672; val_edge_recon_loss: 2757530.1500; val_gene_expr_recon_loss: 20652287.3333; val_masked_gp_l1_reg_loss: 109175.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64924.9766; val_chrom_access_recon_loss: 24031704.0000; val_global_loss: 47743024.5333; val_optim_loss: 47743024.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9758; val_auprc_score: 0.9693; val_best_acc_score: 0.9312; val_best_f1_score: 0.9328; train_kl_reg_loss: 124612.7470; train_edge_recon_loss: 2737679.2634; train_gene_expr_recon_loss: 20771678.9008; train_masked_gp_l1_reg_loss: 109818.5228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63648.9977; train_chrom_access_recon_loss: 24273716.3817; train_global_loss: 48081154.7481; train_optim_loss: 48081154.7481; val_kl_reg_loss: 122447.3760; val_edge_recon_loss: 2741652.8500; val_gene_expr_recon_loss: 20628301.6000; val_masked_gp_l1_reg_loss: 110424.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62484.0586; val_chrom_access_recon_loss: 24065042.5333; val_global_loss: 47730352.2667; val_optim_loss: 47730352.2667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9745; val_auprc_score: 0.9659; val_best_acc_score: 0.9272; val_best_f1_score: 0.9293; train_kl_reg_loss: 121540.1882; train_edge_recon_loss: 2737051.7977; train_gene_expr_recon_loss: 20735701.5573; train_masked_gp_l1_reg_loss: 111316.2258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61343.1987; train_chrom_access_recon_loss: 24237835.0840; train_global_loss: 48004788.0000; train_optim_loss: 48004788.0000; val_kl_reg_loss: 122202.3036; val_edge_recon_loss: 2741511.9000; val_gene_expr_recon_loss: 20577379.8667; val_masked_gp_l1_reg_loss: 112162.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60293.4375; val_chrom_access_recon_loss: 24031665.7333; val_global_loss: 47645215.7333; val_optim_loss: 47645215.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9755; val_auprc_score: 0.9686; val_best_acc_score: 0.9285; val_best_f1_score: 0.9304; train_kl_reg_loss: 119838.0887; train_edge_recon_loss: 2735987.0057; train_gene_expr_recon_loss: 20716875.5573; train_masked_gp_l1_reg_loss: 112871.6484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59285.9362; train_chrom_access_recon_loss: 24257834.4122; train_global_loss: 48002692.8855; train_optim_loss: 48002692.8855; val_kl_reg_loss: 118511.4896; val_edge_recon_loss: 2759378.4167; val_gene_expr_recon_loss: 20542697.3333; val_masked_gp_l1_reg_loss: 113614.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58441.5664; val_chrom_access_recon_loss: 23931777.8667; val_global_loss: 47524420.8000; val_optim_loss: 47524420.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9793; val_auprc_score: 0.9743; val_best_acc_score: 0.9336; val_best_f1_score: 0.9351; train_kl_reg_loss: 118469.0307; train_edge_recon_loss: 2730825.8836; train_gene_expr_recon_loss: 20658806.9313; train_masked_gp_l1_reg_loss: 114374.0356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57449.9585; train_chrom_access_recon_loss: 24183862.9008; train_global_loss: 47863788.4885; train_optim_loss: 47863788.4885; val_kl_reg_loss: 119046.5068; val_edge_recon_loss: 2730208.2000; val_gene_expr_recon_loss: 20451890.0000; val_masked_gp_l1_reg_loss: 115242.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56484.0625; val_chrom_access_recon_loss: 23859346.9333; val_global_loss: 47332217.3333; val_optim_loss: 47332217.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9766; val_auprc_score: 0.9702; val_best_acc_score: 0.9310; val_best_f1_score: 0.9332; train_kl_reg_loss: 117080.8711; train_edge_recon_loss: 2738937.9351; train_gene_expr_recon_loss: 20664540.7939; train_masked_gp_l1_reg_loss: 115892.0126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55601.8572; train_chrom_access_recon_loss: 24209907.3130; train_global_loss: 47901960.6107; train_optim_loss: 47901960.6107; val_kl_reg_loss: 117284.4943; val_edge_recon_loss: 2747431.4500; val_gene_expr_recon_loss: 20458071.4667; val_masked_gp_l1_reg_loss: 116644.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54751.9766; val_chrom_access_recon_loss: 23842188.1333; val_global_loss: 47336372.0000; val_optim_loss: 47336372.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9794; val_auprc_score: 0.9745; val_best_acc_score: 0.9359; val_best_f1_score: 0.9375; train_kl_reg_loss: 115059.3634; train_edge_recon_loss: 2733448.2252; train_gene_expr_recon_loss: 20645517.9237; train_masked_gp_l1_reg_loss: 117425.3203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53918.2591; train_chrom_access_recon_loss: 24194547.1908; train_global_loss: 47859916.2137; train_optim_loss: 47859916.2137; val_kl_reg_loss: 115197.4411; val_edge_recon_loss: 2742494.0833; val_gene_expr_recon_loss: 20573293.3333; val_masked_gp_l1_reg_loss: 118105.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53090.4922; val_chrom_access_recon_loss: 24111931.8667; val_global_loss: 47714113.0667; val_optim_loss: 47714113.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9320; val_auprc_score: 0.9157; val_best_acc_score: 0.8690; val_best_f1_score: 0.8746; train_kl_reg_loss: 147097.5366; train_edge_recon_loss: 2947692.7901; train_gene_expr_recon_loss: 24269736.9771; train_masked_gp_l1_reg_loss: 120395.0442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54898.3490; train_chrom_access_recon_loss: 25338521.7252; train_global_loss: 52878342.4733; train_optim_loss: 52878342.4733; val_kl_reg_loss: 12787.9344; val_edge_recon_loss: 2847573.1667; val_gene_expr_recon_loss: 24917536.9333; val_masked_gp_l1_reg_loss: 120745.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55842.5352; val_chrom_access_recon_loss: 25119989.3333; val_global_loss: 53074474.4000; val_optim_loss: 53074474.4000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9391; val_auprc_score: 0.9228; val_best_acc_score: 0.8829; val_best_f1_score: 0.8882; train_kl_reg_loss: 70617.0292; train_edge_recon_loss: 2794412.6679; train_gene_expr_recon_loss: 24872696.9771; train_masked_gp_l1_reg_loss: 117260.9766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53930.1354; train_chrom_access_recon_loss: 25406805.9389; train_global_loss: 53315723.8168; train_optim_loss: 53315723.8168; val_kl_reg_loss: 21073.5605; val_edge_recon_loss: 2776464.4000; val_gene_expr_recon_loss: 24426663.2000; val_masked_gp_l1_reg_loss: 113532.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51734.3945; val_chrom_access_recon_loss: 25097211.3333; val_global_loss: 52486678.9333; val_optim_loss: 52486678.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9413; val_auprc_score: 0.9236; val_best_acc_score: 0.8890; val_best_f1_score: 0.8940; train_kl_reg_loss: 51550.9227; train_edge_recon_loss: 2767336.3321; train_gene_expr_recon_loss: 24605001.9389; train_masked_gp_l1_reg_loss: 112856.1669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51476.8871; train_chrom_access_recon_loss: 25385305.5725; train_global_loss: 52973527.9695; train_optim_loss: 52973527.9695; val_kl_reg_loss: 22757.7258; val_edge_recon_loss: 2748133.2500; val_gene_expr_recon_loss: 24412458.0000; val_masked_gp_l1_reg_loss: 112441.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51237.4453; val_chrom_access_recon_loss: 25197468.1333; val_global_loss: 52544496.8000; val_optim_loss: 52544496.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9325; val_auprc_score: 0.9117; val_best_acc_score: 0.8798; val_best_f1_score: 0.8854; train_kl_reg_loss: 50636.2194; train_edge_recon_loss: 2752203.0134; train_gene_expr_recon_loss: 24552317.2061; train_masked_gp_l1_reg_loss: 112040.5905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50993.5906; train_chrom_access_recon_loss: 25357881.4198; train_global_loss: 52876072.2137; train_optim_loss: 52876072.2137; val_kl_reg_loss: 23552.9279; val_edge_recon_loss: 2782491.9167; val_gene_expr_recon_loss: 24364869.3333; val_masked_gp_l1_reg_loss: 111620.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50737.9414; val_chrom_access_recon_loss: 25180372.2667; val_global_loss: 52513644.2667; val_optim_loss: 52513644.2667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9393; val_auprc_score: 0.9211; val_best_acc_score: 0.8856; val_best_f1_score: 0.8898; train_kl_reg_loss: 49711.4246; train_edge_recon_loss: 2750572.8187; train_gene_expr_recon_loss: 24543039.0840; train_masked_gp_l1_reg_loss: 111199.3060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50485.3189; train_chrom_access_recon_loss: 25380807.0534; train_global_loss: 52885814.9313; train_optim_loss: 52885814.9313; val_kl_reg_loss: 24400.3734; val_edge_recon_loss: 2749058.6667; val_gene_expr_recon_loss: 24272652.2667; val_masked_gp_l1_reg_loss: 110761.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50226.3945; val_chrom_access_recon_loss: 24978302.0000; val_global_loss: 52185401.6000; val_optim_loss: 52185401.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9369; val_auprc_score: 0.9157; val_best_acc_score: 0.8828; val_best_f1_score: 0.8898; train_kl_reg_loss: 49566.2259; train_edge_recon_loss: 2744080.9351; train_gene_expr_recon_loss: 24518920.8397; train_masked_gp_l1_reg_loss: 110318.5848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49962.1213; train_chrom_access_recon_loss: 25388823.6183; train_global_loss: 52861672.1221; train_optim_loss: 52861672.1221; val_kl_reg_loss: 25339.6820; val_edge_recon_loss: 2768881.4333; val_gene_expr_recon_loss: 24266482.2667; val_masked_gp_l1_reg_loss: 109859.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49694.3672; val_chrom_access_recon_loss: 25012741.4667; val_global_loss: 52232998.6667; val_optim_loss: 52232998.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 25 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9758
val AUPRC score: 0.9710
val best accuracy score: 0.9252
val best F1 score: 0.9278
val target rna MSE score: 3.8580
val source rna MSE score: 104.2820
val target atac MSE score: 0.3473
val source atac MSE score: 55.9463
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
