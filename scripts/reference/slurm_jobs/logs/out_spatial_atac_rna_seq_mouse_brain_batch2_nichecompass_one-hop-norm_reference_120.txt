[True]
Run timestamp: 07082023_210951_120.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_120']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8689; val_auprc_score: 0.8825; val_best_acc_score: 0.5323; val_best_f1_score: 0.6805; train_kl_reg_loss: 74972.9317; train_edge_recon_loss: 3479804.3611; train_gene_expr_recon_loss: 1198165.0833; train_masked_gp_l1_reg_loss: 4764.2362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167353.3733; train_chrom_access_recon_loss: 2210049.5972; train_global_loss: 7135109.7778; train_optim_loss: 7135109.7778; val_kl_reg_loss: 20477.8242; val_edge_recon_loss: 4063081.7500; val_gene_expr_recon_loss: 1002200.2500; val_masked_gp_l1_reg_loss: 4468.9019; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163054.0625; val_chrom_access_recon_loss: 1608560.7500; val_global_loss: 6861844.0000; val_optim_loss: 6861844.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8548; val_auprc_score: 0.8709; val_best_acc_score: 0.5546; val_best_f1_score: 0.6906; train_kl_reg_loss: 15869.2712; train_edge_recon_loss: 3477951.7222; train_gene_expr_recon_loss: 933307.9097; train_masked_gp_l1_reg_loss: 4415.0129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160385.9861; train_chrom_access_recon_loss: 1495645.2083; train_global_loss: 6087575.0000; train_optim_loss: 6087575.0000; val_kl_reg_loss: 11365.2969; val_edge_recon_loss: 4061911.0000; val_gene_expr_recon_loss: 874976.8750; val_masked_gp_l1_reg_loss: 4402.1968; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157094.0000; val_chrom_access_recon_loss: 1420720.6250; val_global_loss: 6530469.5000; val_optim_loss: 6530469.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8418; val_auprc_score: 0.8535; val_best_acc_score: 0.5652; val_best_f1_score: 0.6951; train_kl_reg_loss: 13347.2308; train_edge_recon_loss: 3479379.4444; train_gene_expr_recon_loss: 852508.0069; train_masked_gp_l1_reg_loss: 4465.7501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154324.5833; train_chrom_access_recon_loss: 1400988.0000; train_global_loss: 5905013.0556; train_optim_loss: 5905013.0556; val_kl_reg_loss: 15817.5547; val_edge_recon_loss: 4060936.5000; val_gene_expr_recon_loss: 821768.2500; val_masked_gp_l1_reg_loss: 4554.8433; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150683.4062; val_chrom_access_recon_loss: 1394712.0000; val_global_loss: 6448472.5000; val_optim_loss: 6448472.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8304; val_auprc_score: 0.8376; val_best_acc_score: 0.5891; val_best_f1_score: 0.7049; train_kl_reg_loss: 16525.7655; train_edge_recon_loss: 3481093.1389; train_gene_expr_recon_loss: 800950.0556; train_masked_gp_l1_reg_loss: 4605.8867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147412.1788; train_chrom_access_recon_loss: 1374328.0417; train_global_loss: 5824915.0556; train_optim_loss: 5824915.0556; val_kl_reg_loss: 18027.1680; val_edge_recon_loss: 4058188.2500; val_gene_expr_recon_loss: 792025.1875; val_masked_gp_l1_reg_loss: 4648.8452; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143107.4688; val_chrom_access_recon_loss: 1376750.0000; val_global_loss: 6392747.0000; val_optim_loss: 6392747.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8140; val_auprc_score: 0.8201; val_best_acc_score: 0.6237; val_best_f1_score: 0.7198; train_kl_reg_loss: 18321.2852; train_edge_recon_loss: 3480420.1389; train_gene_expr_recon_loss: 778098.6944; train_masked_gp_l1_reg_loss: 4659.5785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139421.5017; train_chrom_access_recon_loss: 1362959.0139; train_global_loss: 5783880.2778; train_optim_loss: 5783880.2778; val_kl_reg_loss: 18415.7031; val_edge_recon_loss: 4053031.2500; val_gene_expr_recon_loss: 770441.1250; val_masked_gp_l1_reg_loss: 4665.3657; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134713.6250; val_chrom_access_recon_loss: 1365840.1250; val_global_loss: 6347107.0000; val_optim_loss: 6347107.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8110; val_auprc_score: 0.8102; val_best_acc_score: 0.6634; val_best_f1_score: 0.7374; train_kl_reg_loss: 19511.5781; train_edge_recon_loss: 3480624.5278; train_gene_expr_recon_loss: 759387.5069; train_masked_gp_l1_reg_loss: 4672.5943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130873.0043; train_chrom_access_recon_loss: 1349999.4444; train_global_loss: 5745068.6667; train_optim_loss: 5745068.6667; val_kl_reg_loss: 19870.3516; val_edge_recon_loss: 4042971.2500; val_gene_expr_recon_loss: 752121.1250; val_masked_gp_l1_reg_loss: 4680.4209; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126065.2344; val_chrom_access_recon_loss: 1357888.1250; val_global_loss: 6303596.0000; val_optim_loss: 6303596.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8118; val_auprc_score: 0.8085; val_best_acc_score: 0.7065; val_best_f1_score: 0.7524; train_kl_reg_loss: 20064.6263; train_edge_recon_loss: 3479152.5556; train_gene_expr_recon_loss: 744788.9028; train_masked_gp_l1_reg_loss: 4688.4283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122259.6875; train_chrom_access_recon_loss: 1343543.7222; train_global_loss: 5714497.7222; train_optim_loss: 5714497.7222; val_kl_reg_loss: 17978.8184; val_edge_recon_loss: 4020949.2500; val_gene_expr_recon_loss: 741350.1250; val_masked_gp_l1_reg_loss: 4698.3604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117544.9375; val_chrom_access_recon_loss: 1352772.5000; val_global_loss: 6255294.0000; val_optim_loss: 6255294.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8110; val_auprc_score: 0.8015; val_best_acc_score: 0.7299; val_best_f1_score: 0.7358; train_kl_reg_loss: 18742.0345; train_edge_recon_loss: 3472887.9167; train_gene_expr_recon_loss: 731762.9236; train_masked_gp_l1_reg_loss: 4712.3596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113870.7604; train_chrom_access_recon_loss: 1342444.3750; train_global_loss: 5684420.6111; train_optim_loss: 5684420.6111; val_kl_reg_loss: 16550.0098; val_edge_recon_loss: 3966976.5000; val_gene_expr_recon_loss: 730661.1250; val_masked_gp_l1_reg_loss: 4726.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109345.3516; val_chrom_access_recon_loss: 1348293.7500; val_global_loss: 6176553.0000; val_optim_loss: 6176553.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8182; val_auprc_score: 0.7992; val_best_acc_score: 0.7387; val_best_f1_score: 0.7675; train_kl_reg_loss: 15829.8985; train_edge_recon_loss: 3450735.1111; train_gene_expr_recon_loss: 731544.6181; train_masked_gp_l1_reg_loss: 4743.5010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105852.9410; train_chrom_access_recon_loss: 1350006.0556; train_global_loss: 5658712.1667; train_optim_loss: 5658712.1667; val_kl_reg_loss: 11571.4365; val_edge_recon_loss: 3749305.5000; val_gene_expr_recon_loss: 729107.0000; val_masked_gp_l1_reg_loss: 4766.0659; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101575.6328; val_chrom_access_recon_loss: 1346817.3750; val_global_loss: 5943143.0000; val_optim_loss: 5943143.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8340; val_auprc_score: 0.8226; val_best_acc_score: 0.7416; val_best_f1_score: 0.7703; train_kl_reg_loss: 9332.0084; train_edge_recon_loss: 3325350.4722; train_gene_expr_recon_loss: 739700.3611; train_masked_gp_l1_reg_loss: 4803.3136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98347.8715; train_chrom_access_recon_loss: 1343101.5278; train_global_loss: 5520635.6111; train_optim_loss: 5520635.6111; val_kl_reg_loss: 9124.8096; val_edge_recon_loss: 3167327.7500; val_gene_expr_recon_loss: 775315.2500; val_masked_gp_l1_reg_loss: 4863.0889; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94470.1484; val_chrom_access_recon_loss: 1359772.1250; val_global_loss: 5410873.0000; val_optim_loss: 5410873.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8454; val_auprc_score: 0.8426; val_best_acc_score: 0.7505; val_best_f1_score: 0.7729; train_kl_reg_loss: 17379.9187; train_edge_recon_loss: 3034465.8889; train_gene_expr_recon_loss: 774516.4028; train_masked_gp_l1_reg_loss: 4954.1196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91655.8507; train_chrom_access_recon_loss: 1351065.4167; train_global_loss: 5274037.6667; train_optim_loss: 5274037.6667; val_kl_reg_loss: 28881.6523; val_edge_recon_loss: 2993164.7500; val_gene_expr_recon_loss: 767425.6875; val_masked_gp_l1_reg_loss: 5060.6831; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88292.1797; val_chrom_access_recon_loss: 1355408.5000; val_global_loss: 5238234.0000; val_optim_loss: 5238234.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8626; val_auprc_score: 0.8543; val_best_acc_score: 0.7677; val_best_f1_score: 0.7934; train_kl_reg_loss: 38817.6502; train_edge_recon_loss: 2926564.6667; train_gene_expr_recon_loss: 753259.7708; train_masked_gp_l1_reg_loss: 5098.1615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85796.2786; train_chrom_access_recon_loss: 1343093.2500; train_global_loss: 5152629.8333; train_optim_loss: 5152629.8333; val_kl_reg_loss: 46945.3750; val_edge_recon_loss: 2918942.0000; val_gene_expr_recon_loss: 747081.1875; val_masked_gp_l1_reg_loss: 5136.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82748.5547; val_chrom_access_recon_loss: 1346300.0000; val_global_loss: 5147153.5000; val_optim_loss: 5147153.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8939; val_auprc_score: 0.8720; val_best_acc_score: 0.8123; val_best_f1_score: 0.8298; train_kl_reg_loss: 48402.0347; train_edge_recon_loss: 2855677.3333; train_gene_expr_recon_loss: 739392.0625; train_masked_gp_l1_reg_loss: 5169.2138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80436.5017; train_chrom_access_recon_loss: 1336542.7361; train_global_loss: 5065619.8333; train_optim_loss: 5065619.8333; val_kl_reg_loss: 45354.3203; val_edge_recon_loss: 2821358.7500; val_gene_expr_recon_loss: 739954.2500; val_masked_gp_l1_reg_loss: 5213.5791; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77602.1562; val_chrom_access_recon_loss: 1342582.6250; val_global_loss: 5032065.5000; val_optim_loss: 5032065.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9124; val_auprc_score: 0.8844; val_best_acc_score: 0.8472; val_best_f1_score: 0.8570; train_kl_reg_loss: 42862.5408; train_edge_recon_loss: 2794397.6389; train_gene_expr_recon_loss: 736301.2361; train_masked_gp_l1_reg_loss: 5236.5216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75456.3047; train_chrom_access_recon_loss: 1331088.9722; train_global_loss: 4985343.2222; train_optim_loss: 4985343.2222; val_kl_reg_loss: 38608.9453; val_edge_recon_loss: 2798121.7500; val_gene_expr_recon_loss: 732573.2500; val_masked_gp_l1_reg_loss: 5251.9717; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72856.5938; val_chrom_access_recon_loss: 1338026.6250; val_global_loss: 4985439.0000; val_optim_loss: 4985439.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9299; val_auprc_score: 0.9071; val_best_acc_score: 0.8688; val_best_f1_score: 0.8771; train_kl_reg_loss: 38147.4944; train_edge_recon_loss: 2760674.0556; train_gene_expr_recon_loss: 724425.1528; train_masked_gp_l1_reg_loss: 5255.7578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70916.8411; train_chrom_access_recon_loss: 1325589.9583; train_global_loss: 4925009.2778; train_optim_loss: 4925009.2778; val_kl_reg_loss: 38268.2617; val_edge_recon_loss: 2756414.0000; val_gene_expr_recon_loss: 727727.5000; val_masked_gp_l1_reg_loss: 5260.4048; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68540.5469; val_chrom_access_recon_loss: 1335005.1250; val_global_loss: 4931216.0000; val_optim_loss: 4931216.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9408; val_auprc_score: 0.9234; val_best_acc_score: 0.8790; val_best_f1_score: 0.8864; train_kl_reg_loss: 39422.7847; train_edge_recon_loss: 2749669.8611; train_gene_expr_recon_loss: 723288.7986; train_masked_gp_l1_reg_loss: 5262.5748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66754.6020; train_chrom_access_recon_loss: 1327453.4861; train_global_loss: 4911852.1111; train_optim_loss: 4911852.1111; val_kl_reg_loss: 41256.8906; val_edge_recon_loss: 2724248.7500; val_gene_expr_recon_loss: 723177.0000; val_masked_gp_l1_reg_loss: 5257.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64593.4609; val_chrom_access_recon_loss: 1331642.6250; val_global_loss: 4890176.5000; val_optim_loss: 4890176.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9436; val_auprc_score: 0.9232; val_best_acc_score: 0.8874; val_best_f1_score: 0.8931; train_kl_reg_loss: 42390.5490; train_edge_recon_loss: 2736783.6389; train_gene_expr_recon_loss: 716003.8611; train_masked_gp_l1_reg_loss: 5259.8544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62979.9779; train_chrom_access_recon_loss: 1323794.7222; train_global_loss: 4887212.5556; train_optim_loss: 4887212.5556; val_kl_reg_loss: 43129.9844; val_edge_recon_loss: 2726222.7500; val_gene_expr_recon_loss: 715550.0000; val_masked_gp_l1_reg_loss: 5259.3706; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61019.2969; val_chrom_access_recon_loss: 1327541.1250; val_global_loss: 4878722.5000; val_optim_loss: 4878722.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9458; val_auprc_score: 0.9263; val_best_acc_score: 0.8871; val_best_f1_score: 0.8933; train_kl_reg_loss: 42903.7852; train_edge_recon_loss: 2724422.8333; train_gene_expr_recon_loss: 711044.4722; train_masked_gp_l1_reg_loss: 5258.6442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59547.1506; train_chrom_access_recon_loss: 1315840.8611; train_global_loss: 4859017.5556; train_optim_loss: 4859017.5556; val_kl_reg_loss: 43087.0469; val_edge_recon_loss: 2719781.7500; val_gene_expr_recon_loss: 709768.3125; val_masked_gp_l1_reg_loss: 5253.4546; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57758.3164; val_chrom_access_recon_loss: 1324395.8750; val_global_loss: 4860044.5000; val_optim_loss: 4860044.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9435; val_auprc_score: 0.9223; val_best_acc_score: 0.8880; val_best_f1_score: 0.8943; train_kl_reg_loss: 43658.0777; train_edge_recon_loss: 2732380.7222; train_gene_expr_recon_loss: 706551.1806; train_masked_gp_l1_reg_loss: 5247.4221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56392.6992; train_chrom_access_recon_loss: 1321636.0000; train_global_loss: 4865866.2778; train_optim_loss: 4865866.2778; val_kl_reg_loss: 42611.5938; val_edge_recon_loss: 2723050.0000; val_gene_expr_recon_loss: 708286.6250; val_masked_gp_l1_reg_loss: 5238.8550; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54730.2148; val_chrom_access_recon_loss: 1322167.2500; val_global_loss: 4856084.0000; val_optim_loss: 4856084.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9562; val_auprc_score: 0.9438; val_best_acc_score: 0.8971; val_best_f1_score: 0.9018; train_kl_reg_loss: 41914.7756; train_edge_recon_loss: 2720845.2222; train_gene_expr_recon_loss: 704197.2292; train_masked_gp_l1_reg_loss: 5246.8197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53471.8086; train_chrom_access_recon_loss: 1316312.8472; train_global_loss: 4841988.8333; train_optim_loss: 4841988.8333; val_kl_reg_loss: 40393.7539; val_edge_recon_loss: 2723850.0000; val_gene_expr_recon_loss: 706479.3750; val_masked_gp_l1_reg_loss: 5250.4912; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51935.1406; val_chrom_access_recon_loss: 1319418.7500; val_global_loss: 4847327.5000; val_optim_loss: 4847327.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9570; val_auprc_score: 0.9440; val_best_acc_score: 0.8992; val_best_f1_score: 0.9041; train_kl_reg_loss: 40555.0126; train_edge_recon_loss: 2722470.5000; train_gene_expr_recon_loss: 703172.2500; train_masked_gp_l1_reg_loss: 5253.3971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50786.4188; train_chrom_access_recon_loss: 1316489.5972; train_global_loss: 4838727.2222; train_optim_loss: 4838727.2222; val_kl_reg_loss: 39106.4375; val_edge_recon_loss: 2725443.0000; val_gene_expr_recon_loss: 702924.0000; val_masked_gp_l1_reg_loss: 5258.8535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49376.5938; val_chrom_access_recon_loss: 1317570.8750; val_global_loss: 4839679.5000; val_optim_loss: 4839679.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9678; val_auprc_score: 0.9545; val_best_acc_score: 0.9151; val_best_f1_score: 0.9187; train_kl_reg_loss: 39278.7496; train_edge_recon_loss: 2709431.5000; train_gene_expr_recon_loss: 701686.0556; train_masked_gp_l1_reg_loss: 5274.6270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48317.0720; train_chrom_access_recon_loss: 1312216.1944; train_global_loss: 4816204.2222; train_optim_loss: 4816204.2222; val_kl_reg_loss: 37748.2539; val_edge_recon_loss: 2682342.0000; val_gene_expr_recon_loss: 702300.7500; val_masked_gp_l1_reg_loss: 5282.7744; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47024.8125; val_chrom_access_recon_loss: 1315656.2500; val_global_loss: 4790355.0000; val_optim_loss: 4790355.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9695; val_auprc_score: 0.9567; val_best_acc_score: 0.9213; val_best_f1_score: 0.9234; train_kl_reg_loss: 38167.1562; train_edge_recon_loss: 2702262.0278; train_gene_expr_recon_loss: 695844.0764; train_masked_gp_l1_reg_loss: 5299.5373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46053.1536; train_chrom_access_recon_loss: 1304324.9167; train_global_loss: 4791950.7778; train_optim_loss: 4791950.7778; val_kl_reg_loss: 37730.8047; val_edge_recon_loss: 2679723.0000; val_gene_expr_recon_loss: 699404.1875; val_masked_gp_l1_reg_loss: 5308.7349; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44861.6094; val_chrom_access_recon_loss: 1313782.6250; val_global_loss: 4780811.0000; val_optim_loss: 4780811.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9704; val_auprc_score: 0.9569; val_best_acc_score: 0.9272; val_best_f1_score: 0.9298; train_kl_reg_loss: 38242.9614; train_edge_recon_loss: 2683942.9444; train_gene_expr_recon_loss: 695849.5694; train_masked_gp_l1_reg_loss: 5318.6279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43955.1011; train_chrom_access_recon_loss: 1303728.0000; train_global_loss: 4771037.2222; train_optim_loss: 4771037.2222; val_kl_reg_loss: 37591.6445; val_edge_recon_loss: 2667573.5000; val_gene_expr_recon_loss: 698296.3125; val_masked_gp_l1_reg_loss: 5329.2588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42855.4766; val_chrom_access_recon_loss: 1311540.2500; val_global_loss: 4763186.5000; val_optim_loss: 4763186.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9743; val_auprc_score: 0.9666; val_best_acc_score: 0.9290; val_best_f1_score: 0.9312; train_kl_reg_loss: 38263.9410; train_edge_recon_loss: 2683133.7778; train_gene_expr_recon_loss: 692063.8472; train_masked_gp_l1_reg_loss: 5344.1868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42020.9575; train_chrom_access_recon_loss: 1305622.5139; train_global_loss: 4766449.2222; train_optim_loss: 4766449.2222; val_kl_reg_loss: 38247.2734; val_edge_recon_loss: 2696178.2500; val_gene_expr_recon_loss: 694706.1250; val_masked_gp_l1_reg_loss: 5357.2847; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40999.7578; val_chrom_access_recon_loss: 1309059.6250; val_global_loss: 4784548.0000; val_optim_loss: 4784548.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9751; val_auprc_score: 0.9647; val_best_acc_score: 0.9316; val_best_f1_score: 0.9335; train_kl_reg_loss: 38162.6602; train_edge_recon_loss: 2680503.7500; train_gene_expr_recon_loss: 963644.7014; train_masked_gp_l1_reg_loss: 5387.1203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39986.7331; train_chrom_access_recon_loss: 1378862.6111; train_global_loss: 5106547.5000; train_optim_loss: 5106547.5000; val_kl_reg_loss: 19221.4141; val_edge_recon_loss: 2687355.5000; val_gene_expr_recon_loss: 962396.3750; val_masked_gp_l1_reg_loss: 5418.2368; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38604.1641; val_chrom_access_recon_loss: 1381448.8750; val_global_loss: 5094445.0000; val_optim_loss: 5094445.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9724; val_auprc_score: 0.9601; val_best_acc_score: 0.9272; val_best_f1_score: 0.9297; train_kl_reg_loss: 36175.4579; train_edge_recon_loss: 2668860.4722; train_gene_expr_recon_loss: 958481.7431; train_masked_gp_l1_reg_loss: 5448.0720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37422.4566; train_chrom_access_recon_loss: 1369514.0000; train_global_loss: 5075902.1111; train_optim_loss: 5075902.1111; val_kl_reg_loss: 19234.1875; val_edge_recon_loss: 2702431.0000; val_gene_expr_recon_loss: 957875.6250; val_masked_gp_l1_reg_loss: 5486.4668; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35951.6211; val_chrom_access_recon_loss: 1380265.6250; val_global_loss: 5101244.5000; val_optim_loss: 5101244.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9733; val_auprc_score: 0.9601; val_best_acc_score: 0.9329; val_best_f1_score: 0.9349; train_kl_reg_loss: 34969.0061; train_edge_recon_loss: 2663352.6389; train_gene_expr_recon_loss: 956349.7292; train_masked_gp_l1_reg_loss: 5524.4989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34822.7530; train_chrom_access_recon_loss: 1376201.6250; train_global_loss: 5071220.1667; train_optim_loss: 5071220.1667; val_kl_reg_loss: 19094.1797; val_edge_recon_loss: 2680304.7500; val_gene_expr_recon_loss: 955767.2500; val_masked_gp_l1_reg_loss: 5571.2471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33451.4062; val_chrom_access_recon_loss: 1379137.7500; val_global_loss: 5073327.0000; val_optim_loss: 5073327.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9712; val_auprc_score: 0.9586; val_best_acc_score: 0.9263; val_best_f1_score: 0.9291; train_kl_reg_loss: 33639.0929; train_edge_recon_loss: 2664656.8056; train_gene_expr_recon_loss: 956139.2639; train_masked_gp_l1_reg_loss: 5566.1269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33259.9909; train_chrom_access_recon_loss: 1372613.4028; train_global_loss: 5065874.6667; train_optim_loss: 5065874.6667; val_kl_reg_loss: 19014.5703; val_edge_recon_loss: 2681298.2500; val_gene_expr_recon_loss: 957853.1875; val_masked_gp_l1_reg_loss: 5559.7798; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33044.2539; val_chrom_access_recon_loss: 1379125.3750; val_global_loss: 5075895.5000; val_optim_loss: 5075895.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9736; val_auprc_score: 0.9615; val_best_acc_score: 0.9303; val_best_f1_score: 0.9336; train_kl_reg_loss: 33588.3390; train_edge_recon_loss: 2664981.2500; train_gene_expr_recon_loss: 949538.8056; train_masked_gp_l1_reg_loss: 5558.4346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32904.4156; train_chrom_access_recon_loss: 1367398.2361; train_global_loss: 5053969.5000; train_optim_loss: 5053969.5000; val_kl_reg_loss: 19037.7109; val_edge_recon_loss: 2686210.0000; val_gene_expr_recon_loss: 956213.0625; val_masked_gp_l1_reg_loss: 5556.7627; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32725.3477; val_chrom_access_recon_loss: 1378945.5000; val_global_loss: 5078688.0000; val_optim_loss: 5078688.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9739; val_auprc_score: 0.9630; val_best_acc_score: 0.9303; val_best_f1_score: 0.9324; train_kl_reg_loss: 33554.4154; train_edge_recon_loss: 2658468.5833; train_gene_expr_recon_loss: 950872.7569; train_masked_gp_l1_reg_loss: 5556.3090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32593.8260; train_chrom_access_recon_loss: 1374252.1806; train_global_loss: 5055298.1111; train_optim_loss: 5055298.1111; val_kl_reg_loss: 19169.7422; val_edge_recon_loss: 2688187.7500; val_gene_expr_recon_loss: 956439.3125; val_masked_gp_l1_reg_loss: 5556.0771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32432.4727; val_chrom_access_recon_loss: 1378821.6250; val_global_loss: 5080607.0000; val_optim_loss: 5080607.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9768; val_auprc_score: 0.9694; val_best_acc_score: 0.9356; val_best_f1_score: 0.9373; train_kl_reg_loss: 33458.8659; train_edge_recon_loss: 2662040.0278; train_gene_expr_recon_loss: 947444.0000; train_masked_gp_l1_reg_loss: 5556.9054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32310.6536; train_chrom_access_recon_loss: 1372139.1111; train_global_loss: 5052949.7222; train_optim_loss: 5052949.7222; val_kl_reg_loss: 19259.5742; val_edge_recon_loss: 2654894.2500; val_gene_expr_recon_loss: 954913.3750; val_masked_gp_l1_reg_loss: 5558.3779; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32164.7363; val_chrom_access_recon_loss: 1378252.5000; val_global_loss: 5045043.0000; val_optim_loss: 5045043.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 33 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9697
val AUPRC score: 0.9577
val best accuracy score: 0.9223
val best F1 score: 0.9254
val target rna MSE score: 4.0193
val source rna MSE score: 3.1974
val target atac MSE score: 0.1372
val source atac MSE score: 0.0213
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
