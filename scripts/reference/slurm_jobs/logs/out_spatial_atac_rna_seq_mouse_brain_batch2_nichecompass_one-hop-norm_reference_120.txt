[True]
Run timestamp: 10102023_030027_120.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_120']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6244; val_auprc_score: 0.6121; val_best_acc_score: 0.5153; val_best_f1_score: 0.6701; train_kl_reg_loss: 37872.9156; train_edge_recon_loss: 3522413.1970; train_gene_expr_recon_loss: 14148773.7273; train_masked_gp_l1_reg_loss: 95326.4910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3023127.8958; train_chrom_access_recon_loss: 11573962.3182; train_global_loss: 32401476.3636; train_optim_loss: 32401476.3636; val_kl_reg_loss: 52694.9668; val_edge_recon_loss: 4064381.9375; val_gene_expr_recon_loss: 12974744.2500; val_masked_gp_l1_reg_loss: 81639.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1727925.2500; val_chrom_access_recon_loss: 11170336.6250; val_global_loss: 30071724.0000; val_optim_loss: 30071724.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6835; val_auprc_score: 0.6609; val_best_acc_score: 0.5287; val_best_f1_score: 0.6755; train_kl_reg_loss: 87898.2406; train_edge_recon_loss: 3523311.8788; train_gene_expr_recon_loss: 12887916.5606; train_masked_gp_l1_reg_loss: 77314.9646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 961592.7391; train_chrom_access_recon_loss: 10991643.9242; train_global_loss: 28529678.2727; train_optim_loss: 28529678.2727; val_kl_reg_loss: 84171.6914; val_edge_recon_loss: 4063239.1562; val_gene_expr_recon_loss: 12732932.2500; val_masked_gp_l1_reg_loss: 74718.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 477475.0625; val_chrom_access_recon_loss: 11017490.3750; val_global_loss: 28450027.5000; val_optim_loss: 28450027.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7277; val_auprc_score: 0.7031; val_best_acc_score: 0.5677; val_best_f1_score: 0.6899; train_kl_reg_loss: 88584.5443; train_edge_recon_loss: 3515206.8258; train_gene_expr_recon_loss: 12671912.6818; train_masked_gp_l1_reg_loss: 74226.2248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 325173.1702; train_chrom_access_recon_loss: 10870228.9242; train_global_loss: 27545332.3636; train_optim_loss: 27545332.3636; val_kl_reg_loss: 91847.6328; val_edge_recon_loss: 4060133.8438; val_gene_expr_recon_loss: 12619920.8750; val_masked_gp_l1_reg_loss: 74266.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225437.8438; val_chrom_access_recon_loss: 11127972.0000; val_global_loss: 28199579.0000; val_optim_loss: 28199579.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7797; val_auprc_score: 0.7564; val_best_acc_score: 0.7168; val_best_f1_score: 0.7112; train_kl_reg_loss: 81693.8403; train_edge_recon_loss: 3509882.5530; train_gene_expr_recon_loss: 12572156.7576; train_masked_gp_l1_reg_loss: 75008.9181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 179279.4875; train_chrom_access_recon_loss: 10797840.7727; train_global_loss: 27215862.3333; train_optim_loss: 27215862.3333; val_kl_reg_loss: 74845.4980; val_edge_recon_loss: 4019294.0000; val_gene_expr_recon_loss: 12654278.6250; val_masked_gp_l1_reg_loss: 76374.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145461.7500; val_chrom_access_recon_loss: 10905108.5000; val_global_loss: 27875363.2500; val_optim_loss: 27875363.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8279; val_auprc_score: 0.7872; val_best_acc_score: 0.7611; val_best_f1_score: 0.7937; train_kl_reg_loss: 66854.0954; train_edge_recon_loss: 3455134.1780; train_gene_expr_recon_loss: 12493292.0152; train_masked_gp_l1_reg_loss: 78301.3781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127230.0127; train_chrom_access_recon_loss: 10739213.1515; train_global_loss: 26960024.7879; train_optim_loss: 26960024.7879; val_kl_reg_loss: 53831.9678; val_edge_recon_loss: 3394494.7812; val_gene_expr_recon_loss: 12423319.5000; val_masked_gp_l1_reg_loss: 81898.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113816.4062; val_chrom_access_recon_loss: 10880760.3750; val_global_loss: 26948120.5000; val_optim_loss: 26948120.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8336; val_auprc_score: 0.7955; val_best_acc_score: 0.7574; val_best_f1_score: 0.7977; train_kl_reg_loss: 75503.5146; train_edge_recon_loss: 3051769.2311; train_gene_expr_recon_loss: 12440302.8636; train_masked_gp_l1_reg_loss: 86495.0760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106204.1149; train_chrom_access_recon_loss: 10700081.4697; train_global_loss: 26460356.4848; train_optim_loss: 26460356.4848; val_kl_reg_loss: 95713.0244; val_edge_recon_loss: 2923816.4375; val_gene_expr_recon_loss: 12181339.6250; val_masked_gp_l1_reg_loss: 89299.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98597.3516; val_chrom_access_recon_loss: 10664078.3750; val_global_loss: 26052843.2500; val_optim_loss: 26052843.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8396; val_auprc_score: 0.8002; val_best_acc_score: 0.7609; val_best_f1_score: 0.7968; train_kl_reg_loss: 94870.1715; train_edge_recon_loss: 2964104.0303; train_gene_expr_recon_loss: 12355866.3636; train_masked_gp_l1_reg_loss: 89839.0468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92801.9484; train_chrom_access_recon_loss: 10635425.1667; train_global_loss: 26232906.7576; train_optim_loss: 26232906.7576; val_kl_reg_loss: 97756.5576; val_edge_recon_loss: 2975149.4688; val_gene_expr_recon_loss: 12214317.7500; val_masked_gp_l1_reg_loss: 90666.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87080.1172; val_chrom_access_recon_loss: 10665468.2500; val_global_loss: 26130439.0000; val_optim_loss: 26130439.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8496; val_auprc_score: 0.8113; val_best_acc_score: 0.7649; val_best_f1_score: 0.7991; train_kl_reg_loss: 95042.2053; train_edge_recon_loss: 2951647.3788; train_gene_expr_recon_loss: 12301205.8485; train_masked_gp_l1_reg_loss: 91599.2704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82744.6357; train_chrom_access_recon_loss: 10599605.9091; train_global_loss: 26121845.3030; train_optim_loss: 26121845.3030; val_kl_reg_loss: 93802.3945; val_edge_recon_loss: 2923847.5312; val_gene_expr_recon_loss: 12153211.7500; val_masked_gp_l1_reg_loss: 92686.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79208.6172; val_chrom_access_recon_loss: 10585935.3750; val_global_loss: 25928691.7500; val_optim_loss: 25928691.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8610; val_auprc_score: 0.8350; val_best_acc_score: 0.7695; val_best_f1_score: 0.7936; train_kl_reg_loss: 91652.7353; train_edge_recon_loss: 2930934.4167; train_gene_expr_recon_loss: 12252267.7879; train_masked_gp_l1_reg_loss: 93603.1922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76620.5593; train_chrom_access_recon_loss: 10559194.1061; train_global_loss: 26004273.0303; train_optim_loss: 26004273.0303; val_kl_reg_loss: 90043.7617; val_edge_recon_loss: 2940679.8438; val_gene_expr_recon_loss: 12094631.5000; val_masked_gp_l1_reg_loss: 94430.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74422.6406; val_chrom_access_recon_loss: 10516329.2500; val_global_loss: 25810538.5000; val_optim_loss: 25810538.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8693; val_auprc_score: 0.8355; val_best_acc_score: 0.7920; val_best_f1_score: 0.8104; train_kl_reg_loss: 89820.7794; train_edge_recon_loss: 2908212.2689; train_gene_expr_recon_loss: 12200343.9545; train_masked_gp_l1_reg_loss: 95164.2121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72635.3898; train_chrom_access_recon_loss: 10513834.2727; train_global_loss: 25880010.8182; train_optim_loss: 25880010.8182; val_kl_reg_loss: 89765.6553; val_edge_recon_loss: 2852452.2188; val_gene_expr_recon_loss: 12229160.5000; val_masked_gp_l1_reg_loss: 96107.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71331.1406; val_chrom_access_recon_loss: 10702423.6250; val_global_loss: 26041241.2500; val_optim_loss: 26041241.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8816; val_auprc_score: 0.8474; val_best_acc_score: 0.8106; val_best_f1_score: 0.8277; train_kl_reg_loss: 87379.0863; train_edge_recon_loss: 2878309.8902; train_gene_expr_recon_loss: 12158442.2576; train_masked_gp_l1_reg_loss: 96897.7141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70449.2725; train_chrom_access_recon_loss: 10487392.8030; train_global_loss: 25778871.0303; train_optim_loss: 25778871.0303; val_kl_reg_loss: 86769.9189; val_edge_recon_loss: 2844914.3750; val_gene_expr_recon_loss: 12044964.6250; val_masked_gp_l1_reg_loss: 97906.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69597.8750; val_chrom_access_recon_loss: 10516778.8750; val_global_loss: 25660932.7500; val_optim_loss: 25660932.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8887; val_auprc_score: 0.8539; val_best_acc_score: 0.8256; val_best_f1_score: 0.8398; train_kl_reg_loss: 87571.7487; train_edge_recon_loss: 2841235.3864; train_gene_expr_recon_loss: 12102979.1061; train_masked_gp_l1_reg_loss: 98743.3772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69011.3377; train_chrom_access_recon_loss: 10452950.8030; train_global_loss: 25652491.8485; train_optim_loss: 25652491.8485; val_kl_reg_loss: 88097.7959; val_edge_recon_loss: 2839999.2188; val_gene_expr_recon_loss: 12033709.8750; val_masked_gp_l1_reg_loss: 99842.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68947.2031; val_chrom_access_recon_loss: 10522689.1250; val_global_loss: 25653286.0000; val_optim_loss: 25653286.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8958; val_auprc_score: 0.8683; val_best_acc_score: 0.8267; val_best_f1_score: 0.8433; train_kl_reg_loss: 87459.1758; train_edge_recon_loss: 2816025.4508; train_gene_expr_recon_loss: 12057678.5606; train_masked_gp_l1_reg_loss: 100538.6468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68351.9755; train_chrom_access_recon_loss: 10415446.0303; train_global_loss: 25545499.8182; train_optim_loss: 25545499.8182; val_kl_reg_loss: 87204.5312; val_edge_recon_loss: 2842608.8750; val_gene_expr_recon_loss: 12048729.0000; val_masked_gp_l1_reg_loss: 101573.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67573.0391; val_chrom_access_recon_loss: 10583570.6250; val_global_loss: 25731259.0000; val_optim_loss: 25731259.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8978; val_auprc_score: 0.8567; val_best_acc_score: 0.8372; val_best_f1_score: 0.8501; train_kl_reg_loss: 89655.5026; train_edge_recon_loss: 2786923.6326; train_gene_expr_recon_loss: 12027120.1818; train_masked_gp_l1_reg_loss: 101986.5268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66613.2060; train_chrom_access_recon_loss: 10398098.7727; train_global_loss: 25470397.8788; train_optim_loss: 25470397.8788; val_kl_reg_loss: 91912.9482; val_edge_recon_loss: 2812569.0938; val_gene_expr_recon_loss: 12031825.8750; val_masked_gp_l1_reg_loss: 102684.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66629.2891; val_chrom_access_recon_loss: 10663668.1250; val_global_loss: 25769288.5000; val_optim_loss: 25769288.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9075; val_auprc_score: 0.8756; val_best_acc_score: 0.8461; val_best_f1_score: 0.8568; train_kl_reg_loss: 91540.6089; train_edge_recon_loss: 2778369.9242; train_gene_expr_recon_loss: 11983462.5303; train_masked_gp_l1_reg_loss: 103075.7981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65682.0538; train_chrom_access_recon_loss: 10354108.5000; train_global_loss: 25376239.3333; train_optim_loss: 25376239.3333; val_kl_reg_loss: 89436.6143; val_edge_recon_loss: 2802296.3750; val_gene_expr_recon_loss: 11998865.6250; val_masked_gp_l1_reg_loss: 103448.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65134.1875; val_chrom_access_recon_loss: 10500322.3750; val_global_loss: 25559503.0000; val_optim_loss: 25559503.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9062; val_auprc_score: 0.8744; val_best_acc_score: 0.8415; val_best_f1_score: 0.8524; train_kl_reg_loss: 89960.5336; train_edge_recon_loss: 2781634.2955; train_gene_expr_recon_loss: 11949959.6818; train_masked_gp_l1_reg_loss: 103954.0022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64303.0102; train_chrom_access_recon_loss: 10326815.4242; train_global_loss: 25316627.0303; train_optim_loss: 25316627.0303; val_kl_reg_loss: 90479.3281; val_edge_recon_loss: 2826238.4375; val_gene_expr_recon_loss: 11921450.7500; val_masked_gp_l1_reg_loss: 104323.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63846.4062; val_chrom_access_recon_loss: 10510331.8750; val_global_loss: 25516669.5000; val_optim_loss: 25516669.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9169; val_auprc_score: 0.8902; val_best_acc_score: 0.8501; val_best_f1_score: 0.8586; train_kl_reg_loss: 90880.5225; train_edge_recon_loss: 2765221.6515; train_gene_expr_recon_loss: 11933977.9394; train_masked_gp_l1_reg_loss: 104765.0387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63216.7093; train_chrom_access_recon_loss: 10319314.9697; train_global_loss: 25277376.7879; train_optim_loss: 25277376.7879; val_kl_reg_loss: 93610.6406; val_edge_recon_loss: 2812285.5938; val_gene_expr_recon_loss: 11812989.8750; val_masked_gp_l1_reg_loss: 105095.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62616.7812; val_chrom_access_recon_loss: 10434229.8750; val_global_loss: 25320829.0000; val_optim_loss: 25320829.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9208; val_auprc_score: 0.8936; val_best_acc_score: 0.8552; val_best_f1_score: 0.8657; train_kl_reg_loss: 90810.4215; train_edge_recon_loss: 2763273.3788; train_gene_expr_recon_loss: 11894352.6818; train_masked_gp_l1_reg_loss: 105509.8983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62257.9648; train_chrom_access_recon_loss: 10272166.5303; train_global_loss: 25188370.7576; train_optim_loss: 25188370.7576; val_kl_reg_loss: 89331.8984; val_edge_recon_loss: 2812219.9062; val_gene_expr_recon_loss: 11846939.7500; val_masked_gp_l1_reg_loss: 105799.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61907.7930; val_chrom_access_recon_loss: 10348245.0000; val_global_loss: 25264444.7500; val_optim_loss: 25264444.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9181; val_auprc_score: 0.8849; val_best_acc_score: 0.8557; val_best_f1_score: 0.8675; train_kl_reg_loss: 90087.0031; train_edge_recon_loss: 2744708.4242; train_gene_expr_recon_loss: 11870335.7576; train_masked_gp_l1_reg_loss: 106009.3140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61485.4870; train_chrom_access_recon_loss: 10243312.0758; train_global_loss: 25115938.1818; train_optim_loss: 25115938.1818; val_kl_reg_loss: 89951.3975; val_edge_recon_loss: 2796798.8438; val_gene_expr_recon_loss: 11780646.6250; val_masked_gp_l1_reg_loss: 106488.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61415.6602; val_chrom_access_recon_loss: 10301606.8750; val_global_loss: 25136908.7500; val_optim_loss: 25136908.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9327; val_auprc_score: 0.9150; val_best_acc_score: 0.8649; val_best_f1_score: 0.8731; train_kl_reg_loss: 89403.9072; train_edge_recon_loss: 2751853.4735; train_gene_expr_recon_loss: 11838839.0758; train_masked_gp_l1_reg_loss: 106618.0987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60767.5210; train_chrom_access_recon_loss: 10226897.8939; train_global_loss: 25074379.9697; train_optim_loss: 25074379.9697; val_kl_reg_loss: 91513.3945; val_edge_recon_loss: 2760850.8750; val_gene_expr_recon_loss: 11819401.1250; val_masked_gp_l1_reg_loss: 107201.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60619.5391; val_chrom_access_recon_loss: 10281731.7500; val_global_loss: 25121319.2500; val_optim_loss: 25121319.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9274; val_auprc_score: 0.8985; val_best_acc_score: 0.8657; val_best_f1_score: 0.8714; train_kl_reg_loss: 87187.3266; train_edge_recon_loss: 2751513.5606; train_gene_expr_recon_loss: 11820926.3333; train_masked_gp_l1_reg_loss: 107130.3260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60157.0674; train_chrom_access_recon_loss: 10202912.1818; train_global_loss: 25029826.8485; train_optim_loss: 25029826.8485; val_kl_reg_loss: 87125.3340; val_edge_recon_loss: 2789168.5625; val_gene_expr_recon_loss: 11763477.7500; val_masked_gp_l1_reg_loss: 107494.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60172.5664; val_chrom_access_recon_loss: 10463127.2500; val_global_loss: 25270566.7500; val_optim_loss: 25270566.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9255; val_auprc_score: 0.8956; val_best_acc_score: 0.8622; val_best_f1_score: 0.8699; train_kl_reg_loss: 88172.6213; train_edge_recon_loss: 2740591.9205; train_gene_expr_recon_loss: 11787249.8788; train_masked_gp_l1_reg_loss: 107644.4588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59785.3609; train_chrom_access_recon_loss: 10163951.1061; train_global_loss: 24947395.4242; train_optim_loss: 24947395.4242; val_kl_reg_loss: 91649.5029; val_edge_recon_loss: 2777872.3750; val_gene_expr_recon_loss: 11706021.5000; val_masked_gp_l1_reg_loss: 107920.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59687.0742; val_chrom_access_recon_loss: 10222359.2500; val_global_loss: 24965511.0000; val_optim_loss: 24965511.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9330; val_auprc_score: 0.9091; val_best_acc_score: 0.8732; val_best_f1_score: 0.8802; train_kl_reg_loss: 87966.8440; train_edge_recon_loss: 2740359.8220; train_gene_expr_recon_loss: 11773429.8333; train_masked_gp_l1_reg_loss: 108008.3103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59315.1108; train_chrom_access_recon_loss: 10156208.3485; train_global_loss: 24925288.3030; train_optim_loss: 24925288.3030; val_kl_reg_loss: 88508.0088; val_edge_recon_loss: 2738033.3750; val_gene_expr_recon_loss: 11696901.0000; val_masked_gp_l1_reg_loss: 108134.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59002.4180; val_chrom_access_recon_loss: 10193645.5000; val_global_loss: 24884223.7500; val_optim_loss: 24884223.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9297; val_auprc_score: 0.8971; val_best_acc_score: 0.8700; val_best_f1_score: 0.8778; train_kl_reg_loss: 86723.8737; train_edge_recon_loss: 2733028.0379; train_gene_expr_recon_loss: 11746736.8636; train_masked_gp_l1_reg_loss: 108243.6455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59034.9013; train_chrom_access_recon_loss: 10129770.2273; train_global_loss: 24863537.6061; train_optim_loss: 24863537.6061; val_kl_reg_loss: 85576.8730; val_edge_recon_loss: 2761364.9062; val_gene_expr_recon_loss: 11645279.3750; val_masked_gp_l1_reg_loss: 108489.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59041.9219; val_chrom_access_recon_loss: 10212820.1250; val_global_loss: 24872573.2500; val_optim_loss: 24872573.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9248; val_auprc_score: 0.8954; val_best_acc_score: 0.8692; val_best_f1_score: 0.8778; train_kl_reg_loss: 85617.4053; train_edge_recon_loss: 2743913.4545; train_gene_expr_recon_loss: 11727090.0909; train_masked_gp_l1_reg_loss: 108458.7295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58883.6440; train_chrom_access_recon_loss: 10109574.6364; train_global_loss: 24833537.9091; train_optim_loss: 24833537.9091; val_kl_reg_loss: 88540.5459; val_edge_recon_loss: 2756160.2188; val_gene_expr_recon_loss: 11746540.7500; val_masked_gp_l1_reg_loss: 108654.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58787.6445; val_chrom_access_recon_loss: 10272180.7500; val_global_loss: 25030865.5000; val_optim_loss: 25030865.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9296; val_auprc_score: 0.9059; val_best_acc_score: 0.8654; val_best_f1_score: 0.8728; train_kl_reg_loss: 110901.7881; train_edge_recon_loss: 2833073.4811; train_gene_expr_recon_loss: 11133591.1818; train_masked_gp_l1_reg_loss: 109324.3415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57170.8563; train_chrom_access_recon_loss: 9774794.3939; train_global_loss: 24018855.9697; train_optim_loss: 24018855.9697; val_kl_reg_loss: 37308.8447; val_edge_recon_loss: 2811455.8438; val_gene_expr_recon_loss: 11031400.1250; val_masked_gp_l1_reg_loss: 109582.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57648.0664; val_chrom_access_recon_loss: 9822248.7500; val_global_loss: 23869644.0000; val_optim_loss: 23869644.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9255; val_auprc_score: 0.8997; val_best_acc_score: 0.8600; val_best_f1_score: 0.8691; train_kl_reg_loss: 99580.3221; train_edge_recon_loss: 2768382.5417; train_gene_expr_recon_loss: 11096196.8182; train_masked_gp_l1_reg_loss: 109534.2057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56967.1117; train_chrom_access_recon_loss: 9653606.5000; train_global_loss: 23784267.4545; train_optim_loss: 23784267.4545; val_kl_reg_loss: 45118.2441; val_edge_recon_loss: 2807131.5312; val_gene_expr_recon_loss: 11092048.1250; val_masked_gp_l1_reg_loss: 109431.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56469.9922; val_chrom_access_recon_loss: 9784804.8750; val_global_loss: 23895003.5000; val_optim_loss: 23895003.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9272; val_auprc_score: 0.9006; val_best_acc_score: 0.8651; val_best_f1_score: 0.8741; train_kl_reg_loss: 86235.7669; train_edge_recon_loss: 2759492.6515; train_gene_expr_recon_loss: 11070704.7576; train_masked_gp_l1_reg_loss: 109398.1839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56183.1544; train_chrom_access_recon_loss: 9637965.0000; train_global_loss: 23719979.6667; train_optim_loss: 23719979.6667; val_kl_reg_loss: 47003.8486; val_edge_recon_loss: 2797651.2188; val_gene_expr_recon_loss: 11074509.1250; val_masked_gp_l1_reg_loss: 109356.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56268.1562; val_chrom_access_recon_loss: 9766512.7500; val_global_loss: 23851301.7500; val_optim_loss: 23851301.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9240; val_auprc_score: 0.8918; val_best_acc_score: 0.8662; val_best_f1_score: 0.8737; train_kl_reg_loss: 81127.0163; train_edge_recon_loss: 2741017.3030; train_gene_expr_recon_loss: 11051789.2727; train_masked_gp_l1_reg_loss: 108957.7504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55603.7483; train_chrom_access_recon_loss: 9612173.3333; train_global_loss: 23650668.4242; train_optim_loss: 23650668.4242; val_kl_reg_loss: 53203.6431; val_edge_recon_loss: 2803403.6250; val_gene_expr_recon_loss: 11010676.0000; val_masked_gp_l1_reg_loss: 108631.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55496.1055; val_chrom_access_recon_loss: 9672227.3750; val_global_loss: 23703637.5000; val_optim_loss: 23703637.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9318; val_auprc_score: 0.9069; val_best_acc_score: 0.8670; val_best_f1_score: 0.8758; train_kl_reg_loss: 77556.6547; train_edge_recon_loss: 2732651.5909; train_gene_expr_recon_loss: 11028181.2879; train_masked_gp_l1_reg_loss: 108105.3510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55331.5572; train_chrom_access_recon_loss: 9570155.0455; train_global_loss: 23571981.4545; train_optim_loss: 23571981.4545; val_kl_reg_loss: 55633.8901; val_edge_recon_loss: 2798960.3125; val_gene_expr_recon_loss: 11024914.1250; val_masked_gp_l1_reg_loss: 107708.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55120.6953; val_chrom_access_recon_loss: 9700097.7500; val_global_loss: 23742435.7500; val_optim_loss: 23742435.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9324; val_auprc_score: 0.9078; val_best_acc_score: 0.8662; val_best_f1_score: 0.8745; train_kl_reg_loss: 71505.2429; train_edge_recon_loss: 2733678.8447; train_gene_expr_recon_loss: 11005745.2424; train_masked_gp_l1_reg_loss: 107211.5225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55061.7222; train_chrom_access_recon_loss: 9548784.6818; train_global_loss: 23521987.2727; train_optim_loss: 23521987.2727; val_kl_reg_loss: 57442.3276; val_edge_recon_loss: 2758538.4062; val_gene_expr_recon_loss: 11023091.7500; val_masked_gp_l1_reg_loss: 106871.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55045.8008; val_chrom_access_recon_loss: 9810289.8750; val_global_loss: 23811280.0000; val_optim_loss: 23811280.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9332; val_auprc_score: 0.9036; val_best_acc_score: 0.8743; val_best_f1_score: 0.8821; train_kl_reg_loss: 71648.7243; train_edge_recon_loss: 2723546.6742; train_gene_expr_recon_loss: 10990032.0909; train_masked_gp_l1_reg_loss: 106432.4342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54808.8221; train_chrom_access_recon_loss: 9533377.0303; train_global_loss: 23479845.8182; train_optim_loss: 23479845.8182; val_kl_reg_loss: 58555.9434; val_edge_recon_loss: 2761341.1562; val_gene_expr_recon_loss: 10900152.8750; val_masked_gp_l1_reg_loss: 105902.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54796.6914; val_chrom_access_recon_loss: 9686034.7500; val_global_loss: 23566783.7500; val_optim_loss: 23566783.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9362; val_auprc_score: 0.9116; val_best_acc_score: 0.8772; val_best_f1_score: 0.8845; train_kl_reg_loss: 69048.4017; train_edge_recon_loss: 2723618.3220; train_gene_expr_recon_loss: 10961778.7727; train_masked_gp_l1_reg_loss: 105565.4248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54459.8065; train_chrom_access_recon_loss: 9506668.8030; train_global_loss: 23421139.7273; train_optim_loss: 23421139.7273; val_kl_reg_loss: 60059.2964; val_edge_recon_loss: 2723818.2500; val_gene_expr_recon_loss: 10929749.7500; val_masked_gp_l1_reg_loss: 105241.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54587.4570; val_chrom_access_recon_loss: 9673703.1250; val_global_loss: 23547159.5000; val_optim_loss: 23547159.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9419; val_auprc_score: 0.9181; val_best_acc_score: 0.8829; val_best_f1_score: 0.8889; train_kl_reg_loss: 67159.0594; train_edge_recon_loss: 2716883.9091; train_gene_expr_recon_loss: 10935332.1667; train_masked_gp_l1_reg_loss: 104872.5904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54328.5863; train_chrom_access_recon_loss: 9495018.7879; train_global_loss: 23373594.9091; train_optim_loss: 23373594.9091; val_kl_reg_loss: 61525.9404; val_edge_recon_loss: 2770022.5000; val_gene_expr_recon_loss: 10845008.8750; val_masked_gp_l1_reg_loss: 104532.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54117.2383; val_chrom_access_recon_loss: 9570891.6250; val_global_loss: 23406098.2500; val_optim_loss: 23406098.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9425; val_auprc_score: 0.9191; val_best_acc_score: 0.8847; val_best_f1_score: 0.8905; train_kl_reg_loss: 68012.0669; train_edge_recon_loss: 2713247.9583; train_gene_expr_recon_loss: 10936206.6364; train_masked_gp_l1_reg_loss: 104152.7522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54025.3523; train_chrom_access_recon_loss: 9489005.8788; train_global_loss: 23364650.6970; train_optim_loss: 23364650.6970; val_kl_reg_loss: 59096.7437; val_edge_recon_loss: 2755137.5938; val_gene_expr_recon_loss: 10880973.3750; val_masked_gp_l1_reg_loss: 103740.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54021.7070; val_chrom_access_recon_loss: 9615221.0000; val_global_loss: 23468191.2500; val_optim_loss: 23468191.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9416; val_auprc_score: 0.9184; val_best_acc_score: 0.8810; val_best_f1_score: 0.8872; train_kl_reg_loss: 67111.4613; train_edge_recon_loss: 2716674.4811; train_gene_expr_recon_loss: 10916912.1212; train_masked_gp_l1_reg_loss: 103500.7582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53807.4294; train_chrom_access_recon_loss: 9474755.0606; train_global_loss: 23332761.3333; train_optim_loss: 23332761.3333; val_kl_reg_loss: 60385.0269; val_edge_recon_loss: 2761518.4688; val_gene_expr_recon_loss: 10942711.8750; val_masked_gp_l1_reg_loss: 103299.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53822.4570; val_chrom_access_recon_loss: 9641915.5000; val_global_loss: 23563652.0000; val_optim_loss: 23563652.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9440; val_auprc_score: 0.9247; val_best_acc_score: 0.8842; val_best_f1_score: 0.8889; train_kl_reg_loss: 66844.4023; train_edge_recon_loss: 2715545.1856; train_gene_expr_recon_loss: 10890820.4394; train_masked_gp_l1_reg_loss: 103089.5272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53684.5357; train_chrom_access_recon_loss: 9448842.9394; train_global_loss: 23278827.2424; train_optim_loss: 23278827.2424; val_kl_reg_loss: 62516.9517; val_edge_recon_loss: 2726684.7812; val_gene_expr_recon_loss: 10916799.8750; val_masked_gp_l1_reg_loss: 102818.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53693.4062; val_chrom_access_recon_loss: 9529789.8750; val_global_loss: 23392303.2500; val_optim_loss: 23392303.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9427; val_auprc_score: 0.9184; val_best_acc_score: 0.8890; val_best_f1_score: 0.8942; train_kl_reg_loss: 66368.7060; train_edge_recon_loss: 2698159.9886; train_gene_expr_recon_loss: 10886757.5909; train_masked_gp_l1_reg_loss: 102607.3595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53621.8938; train_chrom_access_recon_loss: 9436150.8636; train_global_loss: 23243666.3636; train_optim_loss: 23243666.3636; val_kl_reg_loss: 62172.6743; val_edge_recon_loss: 2734405.4062; val_gene_expr_recon_loss: 10883658.0000; val_masked_gp_l1_reg_loss: 102537.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53635.9766; val_chrom_access_recon_loss: 9529784.6250; val_global_loss: 23366194.7500; val_optim_loss: 23366194.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9482; val_auprc_score: 0.9243; val_best_acc_score: 0.8939; val_best_f1_score: 0.8978; train_kl_reg_loss: 65394.0238; train_edge_recon_loss: 2711525.7348; train_gene_expr_recon_loss: 10873916.0303; train_masked_gp_l1_reg_loss: 102231.1899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53494.1707; train_chrom_access_recon_loss: 9426843.0152; train_global_loss: 23233404.2424; train_optim_loss: 23233404.2424; val_kl_reg_loss: 61939.4155; val_edge_recon_loss: 2754174.6875; val_gene_expr_recon_loss: 10824465.3750; val_masked_gp_l1_reg_loss: 102167.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53395.7148; val_chrom_access_recon_loss: 9489963.2500; val_global_loss: 23286106.5000; val_optim_loss: 23286106.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9502; val_auprc_score: 0.9322; val_best_acc_score: 0.8960; val_best_f1_score: 0.9025; train_kl_reg_loss: 65985.5268; train_edge_recon_loss: 2704884.6818; train_gene_expr_recon_loss: 10873167.3636; train_masked_gp_l1_reg_loss: 101995.3542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53464.8407; train_chrom_access_recon_loss: 9424812.3182; train_global_loss: 23224309.9394; train_optim_loss: 23224309.9394; val_kl_reg_loss: 60963.6309; val_edge_recon_loss: 2728327.6562; val_gene_expr_recon_loss: 10924646.0000; val_masked_gp_l1_reg_loss: 101849.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53133.9648; val_chrom_access_recon_loss: 9561094.6250; val_global_loss: 23430015.7500; val_optim_loss: 23430015.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9487; val_auprc_score: 0.9230; val_best_acc_score: 0.8952; val_best_f1_score: 0.8992; train_kl_reg_loss: 65556.1418; train_edge_recon_loss: 2704221.1288; train_gene_expr_recon_loss: 10844667.9394; train_masked_gp_l1_reg_loss: 101617.5028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53225.7904; train_chrom_access_recon_loss: 9409481.0909; train_global_loss: 23178769.5758; train_optim_loss: 23178769.5758; val_kl_reg_loss: 60285.8335; val_edge_recon_loss: 2729518.2500; val_gene_expr_recon_loss: 10709173.2500; val_masked_gp_l1_reg_loss: 101473.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53156.3516; val_chrom_access_recon_loss: 9481870.5000; val_global_loss: 23135476.2500; val_optim_loss: 23135476.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9466; val_auprc_score: 0.9240; val_best_acc_score: 0.8933; val_best_f1_score: 0.8978; train_kl_reg_loss: 66907.3368; train_edge_recon_loss: 2706078.6780; train_gene_expr_recon_loss: 10839899.0000; train_masked_gp_l1_reg_loss: 101228.9259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53219.9805; train_chrom_access_recon_loss: 9396154.3182; train_global_loss: 23163488.3636; train_optim_loss: 23163488.3636; val_kl_reg_loss: 61297.2759; val_edge_recon_loss: 2723004.4062; val_gene_expr_recon_loss: 10869195.7500; val_masked_gp_l1_reg_loss: 101091.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53418.4531; val_chrom_access_recon_loss: 9504995.6250; val_global_loss: 23313003.0000; val_optim_loss: 23313003.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9488; val_auprc_score: 0.9284; val_best_acc_score: 0.8992; val_best_f1_score: 0.9046; train_kl_reg_loss: 66944.0926; train_edge_recon_loss: 2697569.9848; train_gene_expr_recon_loss: 10829268.5758; train_masked_gp_l1_reg_loss: 100855.7683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53184.3502; train_chrom_access_recon_loss: 9387701.3788; train_global_loss: 23135524.2424; train_optim_loss: 23135524.2424; val_kl_reg_loss: 59495.1206; val_edge_recon_loss: 2721170.1562; val_gene_expr_recon_loss: 10730035.5000; val_masked_gp_l1_reg_loss: 100847.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53362.9375; val_chrom_access_recon_loss: 9399667.5000; val_global_loss: 23064578.2500; val_optim_loss: 23064578.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9471; val_auprc_score: 0.9223; val_best_acc_score: 0.8968; val_best_f1_score: 0.9009; train_kl_reg_loss: 65330.6889; train_edge_recon_loss: 2694320.1780; train_gene_expr_recon_loss: 10825313.8182; train_masked_gp_l1_reg_loss: 100782.2287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53219.3777; train_chrom_access_recon_loss: 9382787.1667; train_global_loss: 23121753.3636; train_optim_loss: 23121753.3636; val_kl_reg_loss: 59914.4858; val_edge_recon_loss: 2747370.9375; val_gene_expr_recon_loss: 10926173.2500; val_masked_gp_l1_reg_loss: 100669.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53107.0312; val_chrom_access_recon_loss: 9555653.8750; val_global_loss: 23442890.0000; val_optim_loss: 23442890.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9527; val_auprc_score: 0.9298; val_best_acc_score: 0.8987; val_best_f1_score: 0.9043; train_kl_reg_loss: 65132.3391; train_edge_recon_loss: 2695464.5000; train_gene_expr_recon_loss: 10804150.2273; train_masked_gp_l1_reg_loss: 100631.0481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53078.8835; train_chrom_access_recon_loss: 9366353.0303; train_global_loss: 23084810.0000; train_optim_loss: 23084810.0000; val_kl_reg_loss: 61096.3452; val_edge_recon_loss: 2704828.9375; val_gene_expr_recon_loss: 10737215.1250; val_masked_gp_l1_reg_loss: 100544.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52885.8438; val_chrom_access_recon_loss: 9497908.6250; val_global_loss: 23154478.7500; val_optim_loss: 23154478.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9485; val_auprc_score: 0.9294; val_best_acc_score: 0.8976; val_best_f1_score: 0.9016; train_kl_reg_loss: 65545.4522; train_edge_recon_loss: 2695095.3826; train_gene_expr_recon_loss: 10798583.1061; train_masked_gp_l1_reg_loss: 100292.3828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52978.0133; train_chrom_access_recon_loss: 9364747.9545; train_global_loss: 23077242.5758; train_optim_loss: 23077242.5758; val_kl_reg_loss: 61532.2568; val_edge_recon_loss: 2743044.7500; val_gene_expr_recon_loss: 10770181.1250; val_masked_gp_l1_reg_loss: 100209.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53182.8398; val_chrom_access_recon_loss: 9428232.2500; val_global_loss: 23156383.2500; val_optim_loss: 23156383.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9558; val_auprc_score: 0.9379; val_best_acc_score: 0.9033; val_best_f1_score: 0.9095; train_kl_reg_loss: 65036.3932; train_edge_recon_loss: 2685158.5720; train_gene_expr_recon_loss: 10789753.2576; train_masked_gp_l1_reg_loss: 100059.8293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53012.4036; train_chrom_access_recon_loss: 9350633.1212; train_global_loss: 23043653.7273; train_optim_loss: 23043653.7273; val_kl_reg_loss: 59604.7671; val_edge_recon_loss: 2717400.1875; val_gene_expr_recon_loss: 10675621.1250; val_masked_gp_l1_reg_loss: 99915.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52885.1719; val_chrom_access_recon_loss: 9456910.6250; val_global_loss: 23062336.7500; val_optim_loss: 23062336.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9524; val_auprc_score: 0.9312; val_best_acc_score: 0.9030; val_best_f1_score: 0.9075; train_kl_reg_loss: 64632.4754; train_edge_recon_loss: 2696212.2083; train_gene_expr_recon_loss: 10771629.5909; train_masked_gp_l1_reg_loss: 99795.3799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52865.6513; train_chrom_access_recon_loss: 9343874.2727; train_global_loss: 23029009.4242; train_optim_loss: 23029009.4242; val_kl_reg_loss: 60809.4097; val_edge_recon_loss: 2715094.8750; val_gene_expr_recon_loss: 10811527.6250; val_masked_gp_l1_reg_loss: 99728.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52921.0938; val_chrom_access_recon_loss: 9512391.0000; val_global_loss: 23252472.7500; val_optim_loss: 23252472.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9580; val_auprc_score: 0.9396; val_best_acc_score: 0.9076; val_best_f1_score: 0.9125; train_kl_reg_loss: 64454.4965; train_edge_recon_loss: 2688610.5530; train_gene_expr_recon_loss: 10757833.9545; train_masked_gp_l1_reg_loss: 99588.9510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52882.7964; train_chrom_access_recon_loss: 9335826.7121; train_global_loss: 22999197.3939; train_optim_loss: 22999197.3939; val_kl_reg_loss: 59534.2446; val_edge_recon_loss: 2678599.4375; val_gene_expr_recon_loss: 10713853.0000; val_masked_gp_l1_reg_loss: 99490.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52907.8047; val_chrom_access_recon_loss: 9476081.1250; val_global_loss: 23080466.5000; val_optim_loss: 23080466.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9531; val_auprc_score: 0.9338; val_best_acc_score: 0.9027; val_best_f1_score: 0.9073; train_kl_reg_loss: 63568.9328; train_edge_recon_loss: 2698160.1402; train_gene_expr_recon_loss: 10747334.1667; train_masked_gp_l1_reg_loss: 99348.7796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52882.5885; train_chrom_access_recon_loss: 9321937.5606; train_global_loss: 22983232.0303; train_optim_loss: 22983232.0303; val_kl_reg_loss: 59942.5415; val_edge_recon_loss: 2713996.6250; val_gene_expr_recon_loss: 10791480.7500; val_masked_gp_l1_reg_loss: 99336.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52868.5234; val_chrom_access_recon_loss: 9500687.3750; val_global_loss: 23218313.2500; val_optim_loss: 23218313.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9491; val_auprc_score: 0.9268; val_best_acc_score: 0.8974; val_best_f1_score: 0.9041; train_kl_reg_loss: 64259.5321; train_edge_recon_loss: 2680405.5682; train_gene_expr_recon_loss: 10746470.7121; train_masked_gp_l1_reg_loss: 99160.4856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52765.5141; train_chrom_access_recon_loss: 9332836.3485; train_global_loss: 22975898.2121; train_optim_loss: 22975898.2121; val_kl_reg_loss: 58857.5620; val_edge_recon_loss: 2740573.2812; val_gene_expr_recon_loss: 10722742.8750; val_masked_gp_l1_reg_loss: 99070.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53074.0938; val_chrom_access_recon_loss: 9454985.2500; val_global_loss: 23129304.2500; val_optim_loss: 23129304.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9568; val_auprc_score: 0.9425; val_best_acc_score: 0.9014; val_best_f1_score: 0.9069; train_kl_reg_loss: 63061.4189; train_edge_recon_loss: 2693972.3750; train_gene_expr_recon_loss: 10726330.9545; train_masked_gp_l1_reg_loss: 97243.4869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45555.1803; train_chrom_access_recon_loss: 9318737.1212; train_global_loss: 22944900.6667; train_optim_loss: 22944900.6667; val_kl_reg_loss: 60078.6753; val_edge_recon_loss: 2722139.6562; val_gene_expr_recon_loss: 10684772.8750; val_masked_gp_l1_reg_loss: 96630.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44076.0195; val_chrom_access_recon_loss: 9392224.3750; val_global_loss: 22999921.7500; val_optim_loss: 22999921.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9530; val_auprc_score: 0.9318; val_best_acc_score: 0.8976; val_best_f1_score: 0.9018; train_kl_reg_loss: 64278.7494; train_edge_recon_loss: 2686286.4015; train_gene_expr_recon_loss: 10732169.5909; train_masked_gp_l1_reg_loss: 96509.8325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43862.8201; train_chrom_access_recon_loss: 9322844.6515; train_global_loss: 22945952.0000; train_optim_loss: 22945952.0000; val_kl_reg_loss: 60980.5615; val_edge_recon_loss: 2725675.2812; val_gene_expr_recon_loss: 10684240.5000; val_masked_gp_l1_reg_loss: 96455.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43714.8008; val_chrom_access_recon_loss: 9383346.0000; val_global_loss: 22994412.5000; val_optim_loss: 22994412.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9498; val_auprc_score: 0.9242; val_best_acc_score: 0.9001; val_best_f1_score: 0.9055; train_kl_reg_loss: 65221.7943; train_edge_recon_loss: 2686034.1856; train_gene_expr_recon_loss: 10729844.5909; train_masked_gp_l1_reg_loss: 96409.9437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43621.0759; train_chrom_access_recon_loss: 9324844.0606; train_global_loss: 22945975.5455; train_optim_loss: 22945975.5455; val_kl_reg_loss: 61879.4663; val_edge_recon_loss: 2726945.5312; val_gene_expr_recon_loss: 10740847.6250; val_masked_gp_l1_reg_loss: 96383.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43480.8438; val_chrom_access_recon_loss: 9414017.2500; val_global_loss: 23083554.5000; val_optim_loss: 23083554.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9530; val_auprc_score: 0.9318; val_best_acc_score: 0.9014; val_best_f1_score: 0.9070; train_kl_reg_loss: 65364.6196; train_edge_recon_loss: 2696186.4848; train_gene_expr_recon_loss: 10726988.5455; train_masked_gp_l1_reg_loss: 96343.6004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43408.7406; train_chrom_access_recon_loss: 9318477.9848; train_global_loss: 22946769.9091; train_optim_loss: 22946769.9091; val_kl_reg_loss: 62642.6919; val_edge_recon_loss: 2731272.5625; val_gene_expr_recon_loss: 10783404.8750; val_masked_gp_l1_reg_loss: 96331.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43328.4375; val_chrom_access_recon_loss: 9494107.1250; val_global_loss: 23211087.2500; val_optim_loss: 23211087.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9574; val_auprc_score: 0.9404; val_best_acc_score: 0.9070; val_best_f1_score: 0.9107; train_kl_reg_loss: 65472.3625; train_edge_recon_loss: 2690091.0000; train_gene_expr_recon_loss: 10715819.2121; train_masked_gp_l1_reg_loss: 96314.3675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43267.8218; train_chrom_access_recon_loss: 9303583.6212; train_global_loss: 22914548.4545; train_optim_loss: 22914548.4545; val_kl_reg_loss: 62205.0039; val_edge_recon_loss: 2706150.3125; val_gene_expr_recon_loss: 10690218.7500; val_masked_gp_l1_reg_loss: 96292.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43226.5742; val_chrom_access_recon_loss: 9529768.8750; val_global_loss: 23127861.7500; val_optim_loss: 23127861.7500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9609; val_auprc_score: 0.9487; val_best_acc_score: 0.9049; val_best_f1_score: 0.9099; train_kl_reg_loss: 65450.1233; train_edge_recon_loss: 2689935.8826; train_gene_expr_recon_loss: 10718696.9394; train_masked_gp_l1_reg_loss: 96264.1570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43161.6392; train_chrom_access_recon_loss: 9302907.5606; train_global_loss: 22916416.4242; train_optim_loss: 22916416.4242; val_kl_reg_loss: 61758.1377; val_edge_recon_loss: 2673136.7500; val_gene_expr_recon_loss: 10808053.7500; val_masked_gp_l1_reg_loss: 96263.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43092.6445; val_chrom_access_recon_loss: 9528794.0000; val_global_loss: 23211098.7500; val_optim_loss: 23211098.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9576; val_auprc_score: 0.9384; val_best_acc_score: 0.9049; val_best_f1_score: 0.9099; train_kl_reg_loss: 65365.4137; train_edge_recon_loss: 2686752.4432; train_gene_expr_recon_loss: 10716541.5000; train_masked_gp_l1_reg_loss: 96076.2611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42295.4040; train_chrom_access_recon_loss: 9308347.3182; train_global_loss: 22915378.5152; train_optim_loss: 22915378.5152; val_kl_reg_loss: 62236.8535; val_edge_recon_loss: 2700957.9688; val_gene_expr_recon_loss: 10730315.0000; val_masked_gp_l1_reg_loss: 96005.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42147.8594; val_chrom_access_recon_loss: 9404035.7500; val_global_loss: 23035698.7500; val_optim_loss: 23035698.7500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9486; val_auprc_score: 0.9222; val_best_acc_score: 0.8933; val_best_f1_score: 0.8983; train_kl_reg_loss: 65508.5710; train_edge_recon_loss: 2682267.2083; train_gene_expr_recon_loss: 10716590.5758; train_masked_gp_l1_reg_loss: 95986.2079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42135.6004; train_chrom_access_recon_loss: 9307444.4091; train_global_loss: 22909932.6061; train_optim_loss: 22909932.6061; val_kl_reg_loss: 62376.3804; val_edge_recon_loss: 2734773.6875; val_gene_expr_recon_loss: 10683275.1250; val_masked_gp_l1_reg_loss: 95972.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42124.5586; val_chrom_access_recon_loss: 9401102.5000; val_global_loss: 23019625.7500; val_optim_loss: 23019625.7500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9559; val_auprc_score: 0.9378; val_best_acc_score: 0.9057; val_best_f1_score: 0.9099; train_kl_reg_loss: 65607.1738; train_edge_recon_loss: 2681651.5265; train_gene_expr_recon_loss: 10709743.8636; train_masked_gp_l1_reg_loss: 95966.9912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42115.5720; train_chrom_access_recon_loss: 9303456.6364; train_global_loss: 22898541.6667; train_optim_loss: 22898541.6667; val_kl_reg_loss: 62307.6406; val_edge_recon_loss: 2687330.1875; val_gene_expr_recon_loss: 10705622.1250; val_masked_gp_l1_reg_loss: 95956.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42102.7773; val_chrom_access_recon_loss: 9476729.7500; val_global_loss: 23070049.5000; val_optim_loss: 23070049.5000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9477; val_auprc_score: 0.9225; val_best_acc_score: 0.8968; val_best_f1_score: 0.9025; train_kl_reg_loss: 65669.3807; train_edge_recon_loss: 2680453.9053; train_gene_expr_recon_loss: 10716482.9848; train_masked_gp_l1_reg_loss: 95952.8428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42095.8448; train_chrom_access_recon_loss: 9311593.6212; train_global_loss: 22912248.5455; train_optim_loss: 22912248.5455; val_kl_reg_loss: 61852.3877; val_edge_recon_loss: 2713727.5625; val_gene_expr_recon_loss: 10754226.8750; val_masked_gp_l1_reg_loss: 95946.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42085.5156; val_chrom_access_recon_loss: 9433041.7500; val_global_loss: 23100880.5000; val_optim_loss: 23100880.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 29 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9467
val AUPRC score: 0.9225
val best accuracy score: 0.8939
val best F1 score: 0.9009
val target rna MSE score: 1.7982
val source rna MSE score: 1.1287
val target atac MSE score: 0.3265
val source atac MSE score: 0.1365
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
