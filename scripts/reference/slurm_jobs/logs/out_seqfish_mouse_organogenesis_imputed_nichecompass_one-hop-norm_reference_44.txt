[True]
Run timestamp: 01082023_080110_44.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_44']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9004; val_auprc_score: 0.9811; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 28515.5097; train_edge_recon_loss: 110665.3954; train_gene_expr_recon_loss: 512729.0828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114974.8686; train_global_loss: 766884.8530; train_optim_loss: 766884.8530; val_kl_reg_loss: 20811.8607; val_edge_recon_loss: 118978.6393; val_gene_expr_recon_loss: 430252.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103282.4844; val_global_loss: 673325.1250; val_optim_loss: 673325.1250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8924; val_auprc_score: 0.9790; val_best_acc_score: 0.8605; val_best_f1_score: 0.9246; train_kl_reg_loss: 19246.7473; train_edge_recon_loss: 109196.7250; train_gene_expr_recon_loss: 375886.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93543.8355; train_global_loss: 597873.3507; train_optim_loss: 597873.3507; val_kl_reg_loss: 16182.8018; val_edge_recon_loss: 117134.6120; val_gene_expr_recon_loss: 310893.4271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84232.1484; val_global_loss: 528442.9792; val_optim_loss: 528442.9792
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8711; val_auprc_score: 0.9734; val_best_acc_score: 0.8666; val_best_f1_score: 0.9269; train_kl_reg_loss: 15628.9731; train_edge_recon_loss: 109086.3900; train_gene_expr_recon_loss: 273991.4190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75804.2691; train_global_loss: 474511.0509; train_optim_loss: 474511.0509; val_kl_reg_loss: 14167.7007; val_edge_recon_loss: 121484.7031; val_gene_expr_recon_loss: 251033.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67140.1250; val_global_loss: 453825.6510; val_optim_loss: 453825.6510
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8503; val_auprc_score: 0.9697; val_best_acc_score: 0.8749; val_best_f1_score: 0.9314; train_kl_reg_loss: 13960.9437; train_edge_recon_loss: 108417.8887; train_gene_expr_recon_loss: 245085.0113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59415.2075; train_global_loss: 426879.0532; train_optim_loss: 426879.0532; val_kl_reg_loss: 12537.0228; val_edge_recon_loss: 116827.1849; val_gene_expr_recon_loss: 239762.8307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51923.4766; val_global_loss: 421050.5104; val_optim_loss: 421050.5104
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8365; val_auprc_score: 0.9642; val_best_acc_score: 0.8830; val_best_f1_score: 0.9349; train_kl_reg_loss: 12532.3705; train_edge_recon_loss: 105512.9217; train_gene_expr_recon_loss: 237456.6655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45877.9292; train_global_loss: 401379.8906; train_optim_loss: 401379.8906; val_kl_reg_loss: 11680.8968; val_edge_recon_loss: 112210.2240; val_gene_expr_recon_loss: 234562.5651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40272.3906; val_global_loss: 398726.0729; val_optim_loss: 398726.0729
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8493; val_auprc_score: 0.9664; val_best_acc_score: 0.8880; val_best_f1_score: 0.9377; train_kl_reg_loss: 12415.8611; train_edge_recon_loss: 102953.3961; train_gene_expr_recon_loss: 233301.7827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36191.3394; train_global_loss: 384862.3796; train_optim_loss: 384862.3796; val_kl_reg_loss: 12129.3643; val_edge_recon_loss: 102171.2057; val_gene_expr_recon_loss: 230901.9349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32620.0566; val_global_loss: 377822.5625; val_optim_loss: 377822.5625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8387; val_auprc_score: 0.9636; val_best_acc_score: 0.8890; val_best_f1_score: 0.9383; train_kl_reg_loss: 12517.9962; train_edge_recon_loss: 98431.1620; train_gene_expr_recon_loss: 229762.5558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29872.5866; train_global_loss: 370584.3003; train_optim_loss: 370584.3003; val_kl_reg_loss: 11708.8052; val_edge_recon_loss: 99788.4583; val_gene_expr_recon_loss: 228004.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27242.3730; val_global_loss: 366743.8177; val_optim_loss: 366743.8177
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8472; val_auprc_score: 0.9652; val_best_acc_score: 0.8907; val_best_f1_score: 0.9391; train_kl_reg_loss: 12198.7269; train_edge_recon_loss: 97298.2012; train_gene_expr_recon_loss: 226594.9413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25089.5654; train_global_loss: 361181.4358; train_optim_loss: 361181.4358; val_kl_reg_loss: 11503.4194; val_edge_recon_loss: 99475.6432; val_gene_expr_recon_loss: 224802.8411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23040.2324; val_global_loss: 358822.1250; val_optim_loss: 358822.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8577; val_auprc_score: 0.9696; val_best_acc_score: 0.8952; val_best_f1_score: 0.9416; train_kl_reg_loss: 11873.0793; train_edge_recon_loss: 96379.0812; train_gene_expr_recon_loss: 223720.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21391.2457; train_global_loss: 353364.1800; train_optim_loss: 353364.1800; val_kl_reg_loss: 11681.5155; val_edge_recon_loss: 96312.7539; val_gene_expr_recon_loss: 221810.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19829.2422; val_global_loss: 349633.5833; val_optim_loss: 349633.5833
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8646; val_auprc_score: 0.9702; val_best_acc_score: 0.8984; val_best_f1_score: 0.9432; train_kl_reg_loss: 11556.3954; train_edge_recon_loss: 95710.7954; train_gene_expr_recon_loss: 221156.2564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18580.7108; train_global_loss: 347004.1562; train_optim_loss: 347004.1562; val_kl_reg_loss: 10819.0900; val_edge_recon_loss: 94470.8320; val_gene_expr_recon_loss: 219804.1302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17395.5547; val_global_loss: 342489.6146; val_optim_loss: 342489.6146
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8679; val_auprc_score: 0.9686; val_best_acc_score: 0.9033; val_best_f1_score: 0.9455; train_kl_reg_loss: 11311.9878; train_edge_recon_loss: 94222.7603; train_gene_expr_recon_loss: 218813.8585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16434.6315; train_global_loss: 340783.2378; train_optim_loss: 340783.2378; val_kl_reg_loss: 11135.7485; val_edge_recon_loss: 97448.0495; val_gene_expr_recon_loss: 216935.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15519.9072; val_global_loss: 341038.7344; val_optim_loss: 341038.7344
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8772; val_auprc_score: 0.9729; val_best_acc_score: 0.9092; val_best_f1_score: 0.9487; train_kl_reg_loss: 11166.7405; train_edge_recon_loss: 94425.6858; train_gene_expr_recon_loss: 216624.0353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14781.1275; train_global_loss: 336997.5880; train_optim_loss: 336997.5880; val_kl_reg_loss: 11339.4281; val_edge_recon_loss: 93430.9349; val_gene_expr_recon_loss: 215073.8854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14069.4131; val_global_loss: 333913.6510; val_optim_loss: 333913.6510
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8798; val_auprc_score: 0.9730; val_best_acc_score: 0.9113; val_best_f1_score: 0.9497; train_kl_reg_loss: 11292.8468; train_edge_recon_loss: 91951.2056; train_gene_expr_recon_loss: 214537.5159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13474.9544; train_global_loss: 331256.5231; train_optim_loss: 331256.5231; val_kl_reg_loss: 11003.3328; val_edge_recon_loss: 92738.5612; val_gene_expr_recon_loss: 213282.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12903.9629; val_global_loss: 329928.0260; val_optim_loss: 329928.0260
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8959; val_auprc_score: 0.9764; val_best_acc_score: 0.9116; val_best_f1_score: 0.9497; train_kl_reg_loss: 11051.4379; train_edge_recon_loss: 92582.1240; train_gene_expr_recon_loss: 212635.0289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12410.7337; train_global_loss: 328679.3270; train_optim_loss: 328679.3270; val_kl_reg_loss: 10562.4061; val_edge_recon_loss: 93730.6536; val_gene_expr_recon_loss: 210794.9479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11933.0488; val_global_loss: 327021.0729; val_optim_loss: 327021.0729
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9061; val_auprc_score: 0.9795; val_best_acc_score: 0.9172; val_best_f1_score: 0.9529; train_kl_reg_loss: 10855.1164; train_edge_recon_loss: 91054.3310; train_gene_expr_recon_loss: 210710.0139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11515.9305; train_global_loss: 324135.3947; train_optim_loss: 324135.3947; val_kl_reg_loss: 10070.4663; val_edge_recon_loss: 91251.2435; val_gene_expr_recon_loss: 209169.8620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11104.8154; val_global_loss: 321596.3854; val_optim_loss: 321596.3854
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9107; val_auprc_score: 0.9810; val_best_acc_score: 0.9193; val_best_f1_score: 0.9539; train_kl_reg_loss: 10504.1689; train_edge_recon_loss: 90459.4617; train_gene_expr_recon_loss: 208997.8076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10743.6944; train_global_loss: 320705.1348; train_optim_loss: 320705.1348; val_kl_reg_loss: 9959.9570; val_edge_recon_loss: 89991.8815; val_gene_expr_recon_loss: 208027.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10389.4922; val_global_loss: 318369.1615; val_optim_loss: 318369.1615
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9134; val_auprc_score: 0.9816; val_best_acc_score: 0.9207; val_best_f1_score: 0.9548; train_kl_reg_loss: 10304.4541; train_edge_recon_loss: 89472.6652; train_gene_expr_recon_loss: 207281.7538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10067.1096; train_global_loss: 317125.9844; train_optim_loss: 317125.9844; val_kl_reg_loss: 9161.3281; val_edge_recon_loss: 89261.5924; val_gene_expr_recon_loss: 206032.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9750.3398; val_global_loss: 314206.0312; val_optim_loss: 314206.0312
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9152; val_auprc_score: 0.9806; val_best_acc_score: 0.9177; val_best_f1_score: 0.9530; train_kl_reg_loss: 9924.8909; train_edge_recon_loss: 89733.6275; train_gene_expr_recon_loss: 205627.9144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9476.7974; train_global_loss: 314763.2303; train_optim_loss: 314763.2303; val_kl_reg_loss: 9970.5765; val_edge_recon_loss: 91198.1745; val_gene_expr_recon_loss: 203918.3880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9209.6006; val_global_loss: 314296.7344; val_optim_loss: 314296.7344
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9246; val_auprc_score: 0.9839; val_best_acc_score: 0.9225; val_best_f1_score: 0.9559; train_kl_reg_loss: 9648.1667; train_edge_recon_loss: 88254.1266; train_gene_expr_recon_loss: 204039.1476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8975.4047; train_global_loss: 310916.8455; train_optim_loss: 310916.8455; val_kl_reg_loss: 9224.6554; val_edge_recon_loss: 88025.0781; val_gene_expr_recon_loss: 202855.9349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8746.4355; val_global_loss: 308852.1094; val_optim_loss: 308852.1094
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9275; val_auprc_score: 0.9820; val_best_acc_score: 0.9266; val_best_f1_score: 0.9581; train_kl_reg_loss: 9284.6650; train_edge_recon_loss: 88228.3521; train_gene_expr_recon_loss: 202467.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8552.7501; train_global_loss: 308533.5052; train_optim_loss: 308533.5052; val_kl_reg_loss: 8497.4818; val_edge_recon_loss: 87936.4570; val_gene_expr_recon_loss: 201525.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8366.5195; val_global_loss: 306326.0156; val_optim_loss: 306326.0156
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9304; val_auprc_score: 0.9851; val_best_acc_score: 0.9274; val_best_f1_score: 0.9584; train_kl_reg_loss: 9048.9530; train_edge_recon_loss: 87513.6957; train_gene_expr_recon_loss: 200959.5796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8204.4892; train_global_loss: 305726.7164; train_optim_loss: 305726.7164; val_kl_reg_loss: 9066.2962; val_edge_recon_loss: 87076.3359; val_gene_expr_recon_loss: 199498.7630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8052.9844; val_global_loss: 303694.3854; val_optim_loss: 303694.3854
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9374; val_auprc_score: 0.9861; val_best_acc_score: 0.9268; val_best_f1_score: 0.9579; train_kl_reg_loss: 8752.4834; train_edge_recon_loss: 87059.2172; train_gene_expr_recon_loss: 199368.0104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7918.7602; train_global_loss: 303098.4734; train_optim_loss: 303098.4734; val_kl_reg_loss: 8327.2484; val_edge_recon_loss: 87544.5846; val_gene_expr_recon_loss: 198879.4974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7792.0566; val_global_loss: 302543.3958; val_optim_loss: 302543.3958
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9309; val_auprc_score: 0.9846; val_best_acc_score: 0.9316; val_best_f1_score: 0.9608; train_kl_reg_loss: 8504.1389; train_edge_recon_loss: 86085.8445; train_gene_expr_recon_loss: 197981.3200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7682.8571; train_global_loss: 300254.1597; train_optim_loss: 300254.1597; val_kl_reg_loss: 8413.2176; val_edge_recon_loss: 85672.9544; val_gene_expr_recon_loss: 196542.3073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7573.2759; val_global_loss: 298201.7604; val_optim_loss: 298201.7604
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9409; val_auprc_score: 0.9871; val_best_acc_score: 0.9331; val_best_f1_score: 0.9613; train_kl_reg_loss: 8181.4488; train_edge_recon_loss: 85276.2646; train_gene_expr_recon_loss: 196409.1340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7486.4724; train_global_loss: 297353.3189; train_optim_loss: 297353.3189; val_kl_reg_loss: 7985.4051; val_edge_recon_loss: 85219.5026; val_gene_expr_recon_loss: 195024.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7403.2563; val_global_loss: 295633.0573; val_optim_loss: 295633.0573
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9426; val_auprc_score: 0.9869; val_best_acc_score: 0.9327; val_best_f1_score: 0.9612; train_kl_reg_loss: 7888.3925; train_edge_recon_loss: 84884.1810; train_gene_expr_recon_loss: 194924.4725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7323.5533; train_global_loss: 295020.6013; train_optim_loss: 295020.6013; val_kl_reg_loss: 8061.8570; val_edge_recon_loss: 83487.4401; val_gene_expr_recon_loss: 193630.6120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7244.6113; val_global_loss: 292424.5417; val_optim_loss: 292424.5417
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8861; val_auprc_score: 0.9770; val_best_acc_score: 0.8861; val_best_f1_score: 0.9366; train_kl_reg_loss: 36551.3119; train_edge_recon_loss: 111733.7820; train_gene_expr_recon_loss: 451096.8634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5969.3148; train_global_loss: 605351.2708; train_optim_loss: 605351.2708; val_kl_reg_loss: 41572.8372; val_edge_recon_loss: 116271.6745; val_gene_expr_recon_loss: 301575.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4578.1553; val_global_loss: 463998.1510; val_optim_loss: 463998.1510
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8384; val_auprc_score: 0.9639; val_best_acc_score: 0.8743; val_best_f1_score: 0.9290; train_kl_reg_loss: 33574.9315; train_edge_recon_loss: 114237.2542; train_gene_expr_recon_loss: 289885.0501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3754.4369; train_global_loss: 441451.6719; train_optim_loss: 441451.6719; val_kl_reg_loss: 16854.0475; val_edge_recon_loss: 122721.7656; val_gene_expr_recon_loss: 244771.4010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3101.8640; val_global_loss: 387449.0885; val_optim_loss: 387449.0885
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8626; val_auprc_score: 0.9692; val_best_acc_score: 0.8836; val_best_f1_score: 0.9346; train_kl_reg_loss: 12776.4189; train_edge_recon_loss: 107569.5893; train_gene_expr_recon_loss: 234029.7202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2712.3689; train_global_loss: 357088.0961; train_optim_loss: 357088.0961; val_kl_reg_loss: 6988.8258; val_edge_recon_loss: 117466.2188; val_gene_expr_recon_loss: 222198.5052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2387.2231; val_global_loss: 349040.7656; val_optim_loss: 349040.7656
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8690; val_auprc_score: 0.9713; val_best_acc_score: 0.8893; val_best_f1_score: 0.9381; train_kl_reg_loss: 5761.5433; train_edge_recon_loss: 100192.2247; train_gene_expr_recon_loss: 218268.6505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2174.2195; train_global_loss: 326396.6377; train_optim_loss: 326396.6377; val_kl_reg_loss: 4448.3394; val_edge_recon_loss: 103546.7500; val_gene_expr_recon_loss: 213456.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1988.1216; val_global_loss: 323439.6042; val_optim_loss: 323439.6042

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8601; val_auprc_score: 0.9690; val_best_acc_score: 0.8884; val_best_f1_score: 0.9378; train_kl_reg_loss: 4551.5024; train_edge_recon_loss: 98050.6884; train_gene_expr_recon_loss: 213754.1241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1907.2456; train_global_loss: 318263.5619; train_optim_loss: 318263.5619; val_kl_reg_loss: 4215.6375; val_edge_recon_loss: 101213.4740; val_gene_expr_recon_loss: 213234.3724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1878.0402; val_global_loss: 320541.5156; val_optim_loss: 320541.5156
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8599; val_auprc_score: 0.9684; val_best_acc_score: 0.8881; val_best_f1_score: 0.9373; train_kl_reg_loss: 4426.9864; train_edge_recon_loss: 96829.5765; train_gene_expr_recon_loss: 213108.6603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1863.0024; train_global_loss: 316228.2274; train_optim_loss: 316228.2274; val_kl_reg_loss: 4144.8765; val_edge_recon_loss: 102583.5156; val_gene_expr_recon_loss: 212536.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1847.9653; val_global_loss: 321113.2500; val_optim_loss: 321113.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8542; val_auprc_score: 0.9680; val_best_acc_score: 0.8871; val_best_f1_score: 0.9370; train_kl_reg_loss: 4372.5697; train_edge_recon_loss: 95714.3929; train_gene_expr_recon_loss: 212554.9635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1833.6368; train_global_loss: 314475.5637; train_optim_loss: 314475.5637; val_kl_reg_loss: 4089.2754; val_edge_recon_loss: 99821.0716; val_gene_expr_recon_loss: 211876.8073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1819.0413; val_global_loss: 317606.1823; val_optim_loss: 317606.1823
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8629; val_auprc_score: 0.9701; val_best_acc_score: 0.8892; val_best_f1_score: 0.9382; train_kl_reg_loss: 4343.5514; train_edge_recon_loss: 95403.4909; train_gene_expr_recon_loss: 211962.9497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1804.8051; train_global_loss: 313514.7980; train_optim_loss: 313514.7980; val_kl_reg_loss: 4051.0746; val_edge_recon_loss: 98103.3685; val_gene_expr_recon_loss: 211033.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1790.1129; val_global_loss: 314978.4375; val_optim_loss: 314978.4375

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 55 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9428
val AUPRC score: 0.9874
val best accuracy score: 0.9311
val best F1 score: 0.9601
val target rna MSE score: 22.8961
val source rna MSE score: 63.3443
Val cat covariate0 mean sim diff: -0.0022

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
