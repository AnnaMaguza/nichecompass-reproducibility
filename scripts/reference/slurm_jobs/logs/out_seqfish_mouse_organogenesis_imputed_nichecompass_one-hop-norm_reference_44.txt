[True]
Run timestamp: 07082023_230129_44.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_44']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8897; val_auprc_score: 0.9779; val_best_acc_score: 0.8584; val_best_f1_score: 0.9235; train_kl_reg_loss: 149980.1656; train_edge_recon_loss: 11855.9630; train_gene_expr_recon_loss: 3714902.9087; train_masked_gp_l1_reg_loss: 18537.9613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177075.9204; train_global_loss: 4072352.9183; train_optim_loss: 4072352.9183; val_kl_reg_loss: 124927.6107; val_edge_recon_loss: 11798.5745; val_gene_expr_recon_loss: 2839379.6875; val_masked_gp_l1_reg_loss: 16094.7832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169237.0000; val_global_loss: 3161437.6042; val_optim_loss: 3161437.6042
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8794; val_auprc_score: 0.9746; val_best_acc_score: 0.8845; val_best_f1_score: 0.9357; train_kl_reg_loss: 104730.6825; train_edge_recon_loss: 11956.1729; train_gene_expr_recon_loss: 2765340.9351; train_masked_gp_l1_reg_loss: 14638.5157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158112.3921; train_global_loss: 3054778.7091; train_optim_loss: 3054778.7091; val_kl_reg_loss: 78639.0514; val_edge_recon_loss: 11937.8366; val_gene_expr_recon_loss: 2335971.5625; val_masked_gp_l1_reg_loss: 13741.2324; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146224.2500; val_global_loss: 2586513.9583; val_optim_loss: 2586513.9583
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8863; val_auprc_score: 0.9749; val_best_acc_score: 0.8929; val_best_f1_score: 0.9379; train_kl_reg_loss: 81101.5605; train_edge_recon_loss: 11944.7922; train_gene_expr_recon_loss: 2337358.7644; train_masked_gp_l1_reg_loss: 13541.9750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134696.4924; train_global_loss: 2578643.6130; train_optim_loss: 2578643.6130; val_kl_reg_loss: 72168.7767; val_edge_recon_loss: 11887.3751; val_gene_expr_recon_loss: 2293905.4583; val_masked_gp_l1_reg_loss: 13205.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123123.0547; val_global_loss: 2514290.6458; val_optim_loss: 2514290.6458
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9071; val_auprc_score: 0.9795; val_best_acc_score: 0.8927; val_best_f1_score: 0.9404; train_kl_reg_loss: 65976.5165; train_edge_recon_loss: 11813.8996; train_gene_expr_recon_loss: 2266851.5337; train_masked_gp_l1_reg_loss: 13040.2263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112510.7847; train_global_loss: 2470192.9567; train_optim_loss: 2470192.9567; val_kl_reg_loss: 60508.4893; val_edge_recon_loss: 11830.5260; val_gene_expr_recon_loss: 2234330.6667; val_masked_gp_l1_reg_loss: 12960.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102275.8125; val_global_loss: 2421906.4375; val_optim_loss: 2421906.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9166; val_auprc_score: 0.9817; val_best_acc_score: 0.9070; val_best_f1_score: 0.9478; train_kl_reg_loss: 57388.3133; train_edge_recon_loss: 11703.3349; train_gene_expr_recon_loss: 2214216.0673; train_masked_gp_l1_reg_loss: 12972.9925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93409.9420; train_global_loss: 2389690.6514; train_optim_loss: 2389690.6514; val_kl_reg_loss: 53894.1657; val_edge_recon_loss: 11582.7521; val_gene_expr_recon_loss: 2189362.8542; val_masked_gp_l1_reg_loss: 13013.4131; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84946.7500; val_global_loss: 2352800.0208; val_optim_loss: 2352800.0208
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9251; val_auprc_score: 0.9834; val_best_acc_score: 0.9179; val_best_f1_score: 0.9533; train_kl_reg_loss: 51770.3960; train_edge_recon_loss: 11631.8998; train_gene_expr_recon_loss: 2171636.5481; train_masked_gp_l1_reg_loss: 13082.4892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77753.3656; train_global_loss: 2325874.6851; train_optim_loss: 2325874.6851; val_kl_reg_loss: 48985.8180; val_edge_recon_loss: 11676.9467; val_gene_expr_recon_loss: 2148735.2083; val_masked_gp_l1_reg_loss: 13167.1572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70945.4297; val_global_loss: 2293510.7500; val_optim_loss: 2293510.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9326; val_auprc_score: 0.9855; val_best_acc_score: 0.9247; val_best_f1_score: 0.9568; train_kl_reg_loss: 47520.7101; train_edge_recon_loss: 11698.9869; train_gene_expr_recon_loss: 2135583.2788; train_masked_gp_l1_reg_loss: 13273.8922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65188.4828; train_global_loss: 2273265.3365; train_optim_loss: 2273265.3365; val_kl_reg_loss: 44769.2611; val_edge_recon_loss: 11549.0796; val_gene_expr_recon_loss: 2117211.1667; val_masked_gp_l1_reg_loss: 13382.6279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59771.8203; val_global_loss: 2246684.0000; val_optim_loss: 2246684.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9410; val_auprc_score: 0.9874; val_best_acc_score: 0.9272; val_best_f1_score: 0.9578; train_kl_reg_loss: 44115.6028; train_edge_recon_loss: 11496.8543; train_gene_expr_recon_loss: 2103431.3257; train_masked_gp_l1_reg_loss: 13495.5718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55240.0537; train_global_loss: 2227779.4207; train_optim_loss: 2227779.4207; val_kl_reg_loss: 41575.3138; val_edge_recon_loss: 11628.6043; val_gene_expr_recon_loss: 2088049.7500; val_masked_gp_l1_reg_loss: 13611.2295; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50990.6055; val_global_loss: 2205855.4167; val_optim_loss: 2205855.4167
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9427; val_auprc_score: 0.9874; val_best_acc_score: 0.9279; val_best_f1_score: 0.9578; train_kl_reg_loss: 41270.2169; train_edge_recon_loss: 11526.4913; train_gene_expr_recon_loss: 2074077.4531; train_masked_gp_l1_reg_loss: 13720.9827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47444.3530; train_global_loss: 2188039.4856; train_optim_loss: 2188039.4856; val_kl_reg_loss: 39587.0755; val_edge_recon_loss: 11839.8398; val_gene_expr_recon_loss: 2057071.5104; val_masked_gp_l1_reg_loss: 13831.5996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44119.0000; val_global_loss: 2166448.9167; val_optim_loss: 2166448.9167
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8515; val_auprc_score: 0.9684; val_best_acc_score: 0.8718; val_best_f1_score: 0.9286; train_kl_reg_loss: 133999.8506; train_edge_recon_loss: 11567.4387; train_gene_expr_recon_loss: 13742734.9555; train_masked_gp_l1_reg_loss: 17823.4992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52663.0346; train_global_loss: 13958788.9615; train_optim_loss: 13958788.9615; val_kl_reg_loss: 12361.0691; val_edge_recon_loss: 11981.3085; val_gene_expr_recon_loss: 2731311.7292; val_masked_gp_l1_reg_loss: 28480.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73587.6641; val_global_loss: 2857722.0625; val_optim_loss: 2857722.0625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8587; val_auprc_score: 0.9695; val_best_acc_score: 0.8812; val_best_f1_score: 0.9337; train_kl_reg_loss: 15079.3777; train_edge_recon_loss: 11802.1300; train_gene_expr_recon_loss: 2295212.3125; train_masked_gp_l1_reg_loss: 28289.0104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74171.5080; train_global_loss: 2424554.3413; train_optim_loss: 2424554.3413; val_kl_reg_loss: 16568.8078; val_edge_recon_loss: 11971.1253; val_gene_expr_recon_loss: 2146345.9167; val_masked_gp_l1_reg_loss: 26829.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67965.9219; val_global_loss: 2269680.8750; val_optim_loss: 2269680.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8583; val_auprc_score: 0.9691; val_best_acc_score: 0.8846; val_best_f1_score: 0.9350; train_kl_reg_loss: 17653.7533; train_edge_recon_loss: 11758.4600; train_gene_expr_recon_loss: 2115055.1839; train_masked_gp_l1_reg_loss: 25745.4759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63732.8540; train_global_loss: 2233945.7139; train_optim_loss: 2233945.7139; val_kl_reg_loss: 18137.6245; val_edge_recon_loss: 11917.9253; val_gene_expr_recon_loss: 2086647.2917; val_masked_gp_l1_reg_loss: 24813.2910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60307.5469; val_global_loss: 2201823.6250; val_optim_loss: 2201823.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8527; val_auprc_score: 0.9683; val_best_acc_score: 0.8822; val_best_f1_score: 0.9332; train_kl_reg_loss: 18708.3689; train_edge_recon_loss: 11687.1910; train_gene_expr_recon_loss: 2068489.4880; train_masked_gp_l1_reg_loss: 24103.2512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57981.3746; train_global_loss: 2180969.6683; train_optim_loss: 2180969.6683; val_kl_reg_loss: 18813.6787; val_edge_recon_loss: 11678.3393; val_gene_expr_recon_loss: 2048742.7917; val_masked_gp_l1_reg_loss: 23451.6504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55934.1016; val_global_loss: 2158620.5000; val_optim_loss: 2158620.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8546; val_auprc_score: 0.9681; val_best_acc_score: 0.8769; val_best_f1_score: 0.9319; train_kl_reg_loss: 19224.3518; train_edge_recon_loss: 11709.1077; train_gene_expr_recon_loss: 2037951.7620; train_masked_gp_l1_reg_loss: 22913.2431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54322.9266; train_global_loss: 2146121.3798; train_optim_loss: 2146121.3798; val_kl_reg_loss: 19107.1274; val_edge_recon_loss: 11914.9016; val_gene_expr_recon_loss: 2021035.1667; val_masked_gp_l1_reg_loss: 22397.2832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52795.6289; val_global_loss: 2127250.1458; val_optim_loss: 2127250.1458
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8556; val_auprc_score: 0.9686; val_best_acc_score: 0.8806; val_best_f1_score: 0.9344; train_kl_reg_loss: 19432.9170; train_edge_recon_loss: 11758.7972; train_gene_expr_recon_loss: 2013643.3786; train_masked_gp_l1_reg_loss: 21954.2281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51467.7601; train_global_loss: 2118257.0649; train_optim_loss: 2118257.0649; val_kl_reg_loss: 19227.0571; val_edge_recon_loss: 11714.5129; val_gene_expr_recon_loss: 2001479.9688; val_masked_gp_l1_reg_loss: 21526.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50161.5781; val_global_loss: 2104109.3438; val_optim_loss: 2104109.3438
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8633; val_auprc_score: 0.9709; val_best_acc_score: 0.8809; val_best_f1_score: 0.9344; train_kl_reg_loss: 19430.9653; train_edge_recon_loss: 11749.9877; train_gene_expr_recon_loss: 1993216.7788; train_masked_gp_l1_reg_loss: 21145.4194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48974.8223; train_global_loss: 2094517.9675; train_optim_loss: 2094517.9675; val_kl_reg_loss: 19172.7791; val_edge_recon_loss: 11789.9672; val_gene_expr_recon_loss: 1983238.3125; val_masked_gp_l1_reg_loss: 20775.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47789.7305; val_global_loss: 2082765.9271; val_optim_loss: 2082765.9271
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8760; val_auprc_score: 0.9739; val_best_acc_score: 0.8835; val_best_f1_score: 0.9356; train_kl_reg_loss: 19304.0737; train_edge_recon_loss: 11663.8545; train_gene_expr_recon_loss: 1975410.1947; train_masked_gp_l1_reg_loss: 20442.3599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46723.8973; train_global_loss: 2073544.3846; train_optim_loss: 2073544.3846; val_kl_reg_loss: 18943.7451; val_edge_recon_loss: 11764.5576; val_gene_expr_recon_loss: 1962897.5625; val_masked_gp_l1_reg_loss: 20116.0762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45671.5430; val_global_loss: 2059393.5000; val_optim_loss: 2059393.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8793; val_auprc_score: 0.9748; val_best_acc_score: 0.8862; val_best_f1_score: 0.9369; train_kl_reg_loss: 19060.7539; train_edge_recon_loss: 11685.6225; train_gene_expr_recon_loss: 1959120.9904; train_masked_gp_l1_reg_loss: 19815.3126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44713.9039; train_global_loss: 2054396.5913; train_optim_loss: 2054396.5913; val_kl_reg_loss: 18729.5667; val_edge_recon_loss: 11696.6993; val_gene_expr_recon_loss: 1948477.7708; val_masked_gp_l1_reg_loss: 19524.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43771.3672; val_global_loss: 2042200.4167; val_optim_loss: 2042200.4167
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8773; val_auprc_score: 0.9738; val_best_acc_score: 0.8856; val_best_f1_score: 0.9364; train_kl_reg_loss: 18738.9047; train_edge_recon_loss: 11674.5429; train_gene_expr_recon_loss: 1943676.5397; train_masked_gp_l1_reg_loss: 19246.4888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42914.3914; train_global_loss: 2036250.8642; train_optim_loss: 2036250.8642; val_kl_reg_loss: 18383.9425; val_edge_recon_loss: 11793.2031; val_gene_expr_recon_loss: 1935446.0417; val_masked_gp_l1_reg_loss: 18978.2441; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42067.2266; val_global_loss: 2026668.6979; val_optim_loss: 2026668.6979
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8827; val_auprc_score: 0.9746; val_best_acc_score: 0.8883; val_best_f1_score: 0.9377; train_kl_reg_loss: 18362.9245; train_edge_recon_loss: 11618.0629; train_gene_expr_recon_loss: 1929414.5373; train_masked_gp_l1_reg_loss: 18719.0467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41289.4363; train_global_loss: 2019404.0156; train_optim_loss: 2019404.0156; val_kl_reg_loss: 17959.7300; val_edge_recon_loss: 11816.0583; val_gene_expr_recon_loss: 1920018.1354; val_masked_gp_l1_reg_loss: 18460.0996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40507.7031; val_global_loss: 2008761.8021; val_optim_loss: 2008761.8021
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8816; val_auprc_score: 0.9744; val_best_acc_score: 0.8891; val_best_f1_score: 0.9380; train_kl_reg_loss: 17936.9828; train_edge_recon_loss: 11586.4146; train_gene_expr_recon_loss: 1916362.4075; train_masked_gp_l1_reg_loss: 18216.3318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39798.9970; train_global_loss: 2003901.1418; train_optim_loss: 2003901.1418; val_kl_reg_loss: 17531.9688; val_edge_recon_loss: 11728.1712; val_gene_expr_recon_loss: 1906385.3125; val_masked_gp_l1_reg_loss: 17969.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39090.1641; val_global_loss: 1992705.0833; val_optim_loss: 1992705.0833
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8820; val_auprc_score: 0.9747; val_best_acc_score: 0.8899; val_best_f1_score: 0.9383; train_kl_reg_loss: 17488.1756; train_edge_recon_loss: 11531.3396; train_gene_expr_recon_loss: 1903865.1995; train_masked_gp_l1_reg_loss: 17733.1106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38437.4536; train_global_loss: 1989055.2812; train_optim_loss: 1989055.2812; val_kl_reg_loss: 17029.9229; val_edge_recon_loss: 11670.0950; val_gene_expr_recon_loss: 1894828.2500; val_masked_gp_l1_reg_loss: 17496.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37798.2578; val_global_loss: 1978822.6562; val_optim_loss: 1978822.6562
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8826; val_auprc_score: 0.9742; val_best_acc_score: 0.8899; val_best_f1_score: 0.9380; train_kl_reg_loss: 17024.9234; train_edge_recon_loss: 11557.8927; train_gene_expr_recon_loss: 1891304.7680; train_masked_gp_l1_reg_loss: 17271.3364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37191.9564; train_global_loss: 1974350.8810; train_optim_loss: 1974350.8810; val_kl_reg_loss: 16584.0047; val_edge_recon_loss: 11756.8796; val_gene_expr_recon_loss: 1882316.9688; val_masked_gp_l1_reg_loss: 17041.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36586.8516; val_global_loss: 1964286.6042; val_optim_loss: 1964286.6042
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8893; val_auprc_score: 0.9759; val_best_acc_score: 0.8905; val_best_f1_score: 0.9381; train_kl_reg_loss: 16547.4988; train_edge_recon_loss: 11502.1295; train_gene_expr_recon_loss: 1879570.5156; train_masked_gp_l1_reg_loss: 16816.7386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36019.7120; train_global_loss: 1960456.6106; train_optim_loss: 1960456.6106; val_kl_reg_loss: 16163.2510; val_edge_recon_loss: 11916.1061; val_gene_expr_recon_loss: 1873009.4062; val_masked_gp_l1_reg_loss: 16592.0215; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35454.1992; val_global_loss: 1953135.0000; val_optim_loss: 1953135.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8895; val_auprc_score: 0.9761; val_best_acc_score: 0.8942; val_best_f1_score: 0.9400; train_kl_reg_loss: 16062.6495; train_edge_recon_loss: 11497.3499; train_gene_expr_recon_loss: 1868043.6430; train_masked_gp_l1_reg_loss: 16372.3556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34922.3975; train_global_loss: 1946898.3834; train_optim_loss: 1946898.3834; val_kl_reg_loss: 15645.5242; val_edge_recon_loss: 11652.3390; val_gene_expr_recon_loss: 1861193.2917; val_masked_gp_l1_reg_loss: 16145.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34377.1094; val_global_loss: 1939013.5417; val_optim_loss: 1939013.5417
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8576; val_auprc_score: 0.9652; val_best_acc_score: 0.8948; val_best_f1_score: 0.9409; train_kl_reg_loss: 7001.6576; train_edge_recon_loss: 11582.7779; train_gene_expr_recon_loss: 3038276.6851; train_masked_gp_l1_reg_loss: 19450.3541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32145.4639; train_global_loss: 3108456.9399; train_optim_loss: 3108456.9399; val_kl_reg_loss: 6066.3943; val_edge_recon_loss: 11702.0145; val_gene_expr_recon_loss: 2276705.8125; val_masked_gp_l1_reg_loss: 19535.5488; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30022.5234; val_global_loss: 2344032.2292; val_optim_loss: 2344032.2292
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8663; val_auprc_score: 0.9693; val_best_acc_score: 0.8927; val_best_f1_score: 0.9393; train_kl_reg_loss: 6688.2998; train_edge_recon_loss: 11562.5026; train_gene_expr_recon_loss: 2126357.5349; train_masked_gp_l1_reg_loss: 18743.8006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28465.6234; train_global_loss: 2191817.7728; train_optim_loss: 2191817.7728; val_kl_reg_loss: 5269.3713; val_edge_recon_loss: 11554.3757; val_gene_expr_recon_loss: 2031866.3542; val_masked_gp_l1_reg_loss: 17995.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27064.1602; val_global_loss: 2093750.1354; val_optim_loss: 2093750.1354
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8695; val_auprc_score: 0.9709; val_best_acc_score: 0.8919; val_best_f1_score: 0.9392; train_kl_reg_loss: 6101.0108; train_edge_recon_loss: 11501.6092; train_gene_expr_recon_loss: 1993796.0901; train_masked_gp_l1_reg_loss: 17344.6626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25974.7956; train_global_loss: 2054718.1707; train_optim_loss: 2054718.1707; val_kl_reg_loss: 4909.4956; val_edge_recon_loss: 11498.5169; val_gene_expr_recon_loss: 1961582.3229; val_masked_gp_l1_reg_loss: 16716.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24970.8398; val_global_loss: 2019677.5833; val_optim_loss: 2019677.5833
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8783; val_auprc_score: 0.9731; val_best_acc_score: 0.8921; val_best_f1_score: 0.9392; train_kl_reg_loss: 5747.5051; train_edge_recon_loss: 11458.2473; train_gene_expr_recon_loss: 1946630.8642; train_masked_gp_l1_reg_loss: 16165.7768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24143.9152; train_global_loss: 2004146.3089; train_optim_loss: 2004146.3089; val_kl_reg_loss: 4669.2970; val_edge_recon_loss: 11574.5282; val_gene_expr_recon_loss: 1933996.5000; val_masked_gp_l1_reg_loss: 15633.9160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23361.8516; val_global_loss: 1989236.0625; val_optim_loss: 1989236.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8725; val_auprc_score: 0.9721; val_best_acc_score: 0.8911; val_best_f1_score: 0.9388; train_kl_reg_loss: 5585.7495; train_edge_recon_loss: 11362.2252; train_gene_expr_recon_loss: 1931436.0433; train_masked_gp_l1_reg_loss: 15505.5402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23195.7232; train_global_loss: 1987085.2764; train_optim_loss: 1987085.2764; val_kl_reg_loss: 4648.4729; val_edge_recon_loss: 11477.0322; val_gene_expr_recon_loss: 1927553.6042; val_masked_gp_l1_reg_loss: 15444.6035; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23112.2832; val_global_loss: 1982236.0000; val_optim_loss: 1982236.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8701; val_auprc_score: 0.9714; val_best_acc_score: 0.8906; val_best_f1_score: 0.9384; train_kl_reg_loss: 5558.9303; train_edge_recon_loss: 11361.2440; train_gene_expr_recon_loss: 1928904.4315; train_masked_gp_l1_reg_loss: 15392.0102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23038.7017; train_global_loss: 1984255.3017; train_optim_loss: 1984255.3017; val_kl_reg_loss: 4626.6274; val_edge_recon_loss: 11455.0248; val_gene_expr_recon_loss: 1927174.2500; val_masked_gp_l1_reg_loss: 15338.0674; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22962.5742; val_global_loss: 1981556.6562; val_optim_loss: 1981556.6562
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8763; val_auprc_score: 0.9733; val_best_acc_score: 0.8935; val_best_f1_score: 0.9401; train_kl_reg_loss: 5531.9888; train_edge_recon_loss: 11423.8658; train_gene_expr_recon_loss: 1926706.2200; train_masked_gp_l1_reg_loss: 15284.4846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22887.3840; train_global_loss: 1981833.9423; train_optim_loss: 1981833.9423; val_kl_reg_loss: 4595.4598; val_edge_recon_loss: 11351.7160; val_gene_expr_recon_loss: 1923930.1667; val_masked_gp_l1_reg_loss: 15229.4863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22809.9434; val_global_loss: 1977916.8333; val_optim_loss: 1977916.8333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8786; val_auprc_score: 0.9732; val_best_acc_score: 0.8923; val_best_f1_score: 0.9392; train_kl_reg_loss: 5499.1095; train_edge_recon_loss: 11356.9087; train_gene_expr_recon_loss: 1924573.3450; train_masked_gp_l1_reg_loss: 15173.6830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22732.2329; train_global_loss: 1979335.2861; train_optim_loss: 1979335.2861; val_kl_reg_loss: 4578.9956; val_edge_recon_loss: 11534.6472; val_gene_expr_recon_loss: 1923162.9583; val_masked_gp_l1_reg_loss: 15116.9736; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22652.5156; val_global_loss: 1977046.1146; val_optim_loss: 1977046.1146

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 92 min 1 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8863
val AUPRC score: 0.9756
val best accuracy score: 0.8923
val best F1 score: 0.9398
val target rna MSE score: 33.5167
val source rna MSE score: 214.5722
Val cat covariate0 mean sim diff: -0.0004

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
