[True]
Run timestamp: 07082023_215337_144.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_144']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8921; val_auprc_score: 0.9028; val_best_acc_score: 0.5690; val_best_f1_score: 0.6969; train_kl_reg_loss: 56034.0029; train_edge_recon_loss: 3475154.7778; train_gene_expr_recon_loss: 1187705.0000; train_masked_gp_l1_reg_loss: 16481.7238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166624.0312; train_chrom_access_recon_loss: 674437.4097; train_global_loss: 5576436.8889; train_optim_loss: 5576436.8889; val_kl_reg_loss: 25655.1680; val_edge_recon_loss: 4060458.2500; val_gene_expr_recon_loss: 1017899.6875; val_masked_gp_l1_reg_loss: 12374.4521; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161786.4531; val_chrom_access_recon_loss: 503835.8750; val_global_loss: 5782010.0000; val_optim_loss: 5782010.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8897; val_auprc_score: 0.8983; val_best_acc_score: 0.6351; val_best_f1_score: 0.7294; train_kl_reg_loss: 16695.4721; train_edge_recon_loss: 3477451.0833; train_gene_expr_recon_loss: 943889.2153; train_masked_gp_l1_reg_loss: 10717.1580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158706.6580; train_chrom_access_recon_loss: 492586.9931; train_global_loss: 5100046.4444; train_optim_loss: 5100046.4444; val_kl_reg_loss: 11683.0957; val_edge_recon_loss: 4056509.7500; val_gene_expr_recon_loss: 889688.0625; val_masked_gp_l1_reg_loss: 9282.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154768.2500; val_chrom_access_recon_loss: 469592.8750; val_global_loss: 5591525.0000; val_optim_loss: 5591525.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8793; val_auprc_score: 0.8819; val_best_acc_score: 0.6858; val_best_f1_score: 0.7548; train_kl_reg_loss: 13075.6419; train_edge_recon_loss: 3477612.2500; train_gene_expr_recon_loss: 865323.3125; train_masked_gp_l1_reg_loss: 9000.8357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151258.1667; train_chrom_access_recon_loss: 467569.3160; train_global_loss: 4983839.5000; train_optim_loss: 4983839.5000; val_kl_reg_loss: 14918.8047; val_edge_recon_loss: 4050574.2500; val_gene_expr_recon_loss: 835803.8750; val_masked_gp_l1_reg_loss: 8734.9346; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146577.8438; val_chrom_access_recon_loss: 459856.4062; val_global_loss: 5516466.5000; val_optim_loss: 5516466.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8591; val_auprc_score: 0.8573; val_best_acc_score: 0.7491; val_best_f1_score: 0.7848; train_kl_reg_loss: 15402.9072; train_edge_recon_loss: 3477013.3333; train_gene_expr_recon_loss: 808533.3958; train_masked_gp_l1_reg_loss: 8464.4614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142363.1875; train_chrom_access_recon_loss: 457793.4236; train_global_loss: 4909570.7222; train_optim_loss: 4909570.7222; val_kl_reg_loss: 16225.8398; val_edge_recon_loss: 4028971.7500; val_gene_expr_recon_loss: 803328.0000; val_masked_gp_l1_reg_loss: 8192.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136864.3594; val_chrom_access_recon_loss: 454284.3125; val_global_loss: 5447866.5000; val_optim_loss: 5447866.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8529; val_auprc_score: 0.8430; val_best_acc_score: 0.7715; val_best_f1_score: 0.7691; train_kl_reg_loss: 15454.7421; train_edge_recon_loss: 3471972.9444; train_gene_expr_recon_loss: 784227.7153; train_masked_gp_l1_reg_loss: 8061.8956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132258.3342; train_chrom_access_recon_loss: 455500.9201; train_global_loss: 4867476.6111; train_optim_loss: 4867476.6111; val_kl_reg_loss: 13323.1777; val_edge_recon_loss: 3972365.7500; val_gene_expr_recon_loss: 777997.8750; val_masked_gp_l1_reg_loss: 7932.2793; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126443.9141; val_chrom_access_recon_loss: 451201.3750; val_global_loss: 5349265.0000; val_optim_loss: 5349265.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8524; val_auprc_score: 0.8387; val_best_acc_score: 0.7668; val_best_f1_score: 0.7836; train_kl_reg_loss: 12294.2635; train_edge_recon_loss: 3447110.9444; train_gene_expr_recon_loss: 767361.8750; train_masked_gp_l1_reg_loss: 7887.1867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121767.7396; train_chrom_access_recon_loss: 453363.1354; train_global_loss: 4809785.2222; train_optim_loss: 4809785.2222; val_kl_reg_loss: 8405.6426; val_edge_recon_loss: 3703983.2500; val_gene_expr_recon_loss: 771930.5000; val_masked_gp_l1_reg_loss: 7841.0933; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115949.7812; val_chrom_access_recon_loss: 450104.8438; val_global_loss: 5058215.5000; val_optim_loss: 5058215.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8477; val_auprc_score: 0.8331; val_best_acc_score: 0.7610; val_best_f1_score: 0.7841; train_kl_reg_loss: 7759.0480; train_edge_recon_loss: 3278374.3333; train_gene_expr_recon_loss: 779269.2639; train_masked_gp_l1_reg_loss: 7820.9126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111429.0990; train_chrom_access_recon_loss: 454521.5312; train_global_loss: 4639174.3333; train_optim_loss: 4639174.3333; val_kl_reg_loss: 11365.2285; val_edge_recon_loss: 3066831.7500; val_gene_expr_recon_loss: 814019.2500; val_masked_gp_l1_reg_loss: 7787.2451; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105921.8594; val_chrom_access_recon_loss: 453671.5000; val_global_loss: 4459597.0000; val_optim_loss: 4459597.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8680; val_auprc_score: 0.8590; val_best_acc_score: 0.7703; val_best_f1_score: 0.7999; train_kl_reg_loss: 23105.2702; train_edge_recon_loss: 2965474.3056; train_gene_expr_recon_loss: 800862.2986; train_masked_gp_l1_reg_loss: 7800.0299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101731.6606; train_chrom_access_recon_loss: 455896.2743; train_global_loss: 4354869.7778; train_optim_loss: 4354869.7778; val_kl_reg_loss: 37050.5859; val_edge_recon_loss: 2906311.7500; val_gene_expr_recon_loss: 788291.3125; val_masked_gp_l1_reg_loss: 7792.4365; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96595.3906; val_chrom_access_recon_loss: 450962.0625; val_global_loss: 4287003.5000; val_optim_loss: 4287003.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8889; val_auprc_score: 0.8737; val_best_acc_score: 0.8017; val_best_f1_score: 0.8148; train_kl_reg_loss: 46197.1419; train_edge_recon_loss: 2893154.5833; train_gene_expr_recon_loss: 772807.6111; train_masked_gp_l1_reg_loss: 7747.5237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92652.3151; train_chrom_access_recon_loss: 451047.3924; train_global_loss: 4263606.4444; train_optim_loss: 4263606.4444; val_kl_reg_loss: 49795.9609; val_edge_recon_loss: 2850270.0000; val_gene_expr_recon_loss: 765952.7500; val_masked_gp_l1_reg_loss: 7718.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87830.4531; val_chrom_access_recon_loss: 447834.1250; val_global_loss: 4209401.5000; val_optim_loss: 4209401.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9105; val_auprc_score: 0.8854; val_best_acc_score: 0.8418; val_best_f1_score: 0.8531; train_kl_reg_loss: 47333.6094; train_edge_recon_loss: 2817687.7222; train_gene_expr_recon_loss: 755724.1528; train_masked_gp_l1_reg_loss: 7736.3442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84160.4583; train_chrom_access_recon_loss: 449508.2708; train_global_loss: 4162150.6111; train_optim_loss: 4162150.6111; val_kl_reg_loss: 38671.2734; val_edge_recon_loss: 2803677.5000; val_gene_expr_recon_loss: 763251.8750; val_masked_gp_l1_reg_loss: 7754.7339; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79682.1094; val_chrom_access_recon_loss: 446840.9062; val_global_loss: 4139878.2500; val_optim_loss: 4139878.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9222; val_auprc_score: 0.8939; val_best_acc_score: 0.8615; val_best_f1_score: 0.8715; train_kl_reg_loss: 35776.8424; train_edge_recon_loss: 2779400.5000; train_gene_expr_recon_loss: 753583.2639; train_masked_gp_l1_reg_loss: 7740.7342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76356.4661; train_chrom_access_recon_loss: 450652.8819; train_global_loss: 4103510.5833; train_optim_loss: 4103510.5833; val_kl_reg_loss: 34084.9297; val_edge_recon_loss: 2792763.5000; val_gene_expr_recon_loss: 758835.3750; val_masked_gp_l1_reg_loss: 7696.9312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72373.7031; val_chrom_access_recon_loss: 445651.4062; val_global_loss: 4111406.2500; val_optim_loss: 4111406.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9317; val_auprc_score: 0.9072; val_best_acc_score: 0.8716; val_best_f1_score: 0.8789; train_kl_reg_loss: 38244.8277; train_edge_recon_loss: 2751511.3611; train_gene_expr_recon_loss: 749003.0625; train_masked_gp_l1_reg_loss: 7683.0345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69443.7248; train_chrom_access_recon_loss: 448778.6319; train_global_loss: 4064664.6111; train_optim_loss: 4064664.6111; val_kl_reg_loss: 40918.2109; val_edge_recon_loss: 2761210.5000; val_gene_expr_recon_loss: 751197.4375; val_masked_gp_l1_reg_loss: 7688.5869; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65920.5547; val_chrom_access_recon_loss: 444051.8438; val_global_loss: 4070987.0000; val_optim_loss: 4070987.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9371; val_auprc_score: 0.9153; val_best_acc_score: 0.8802; val_best_f1_score: 0.8872; train_kl_reg_loss: 43690.0234; train_edge_recon_loss: 2728530.3889; train_gene_expr_recon_loss: 735130.3681; train_masked_gp_l1_reg_loss: 7695.8688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63340.4831; train_chrom_access_recon_loss: 446089.6007; train_global_loss: 4024476.6667; train_optim_loss: 4024476.6667; val_kl_reg_loss: 42698.2344; val_edge_recon_loss: 2749450.2500; val_gene_expr_recon_loss: 744058.8125; val_masked_gp_l1_reg_loss: 7702.8105; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60239.2031; val_chrom_access_recon_loss: 442722.9062; val_global_loss: 4046872.2500; val_optim_loss: 4046872.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9373; val_auprc_score: 0.9154; val_best_acc_score: 0.8844; val_best_f1_score: 0.8915; train_kl_reg_loss: 43038.6272; train_edge_recon_loss: 2718308.4444; train_gene_expr_recon_loss: 734596.8889; train_masked_gp_l1_reg_loss: 7695.6022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57951.3116; train_chrom_access_recon_loss: 444545.8993; train_global_loss: 4006136.7500; train_optim_loss: 4006136.7500; val_kl_reg_loss: 38943.0117; val_edge_recon_loss: 2727780.0000; val_gene_expr_recon_loss: 738548.0000; val_masked_gp_l1_reg_loss: 7687.2896; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55193.1445; val_chrom_access_recon_loss: 441741.9062; val_global_loss: 4009893.5000; val_optim_loss: 4009893.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9436; val_auprc_score: 0.9231; val_best_acc_score: 0.8929; val_best_f1_score: 0.8990; train_kl_reg_loss: 38348.8455; train_edge_recon_loss: 2709485.8056; train_gene_expr_recon_loss: 735442.1111; train_masked_gp_l1_reg_loss: 7696.6559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53180.5104; train_chrom_access_recon_loss: 446680.4514; train_global_loss: 3990834.3333; train_optim_loss: 3990834.3333; val_kl_reg_loss: 35692.2539; val_edge_recon_loss: 2713067.2500; val_gene_expr_recon_loss: 736673.6250; val_masked_gp_l1_reg_loss: 7700.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50762.7188; val_chrom_access_recon_loss: 441144.5938; val_global_loss: 3985040.5000; val_optim_loss: 3985040.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9491; val_auprc_score: 0.9260; val_best_acc_score: 0.8960; val_best_f1_score: 0.9019; train_kl_reg_loss: 37382.1398; train_edge_recon_loss: 2724362.6389; train_gene_expr_recon_loss: 724411.8819; train_masked_gp_l1_reg_loss: 7718.6597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48994.8177; train_chrom_access_recon_loss: 443264.4271; train_global_loss: 3986134.6389; train_optim_loss: 3986134.6389; val_kl_reg_loss: 36256.1484; val_edge_recon_loss: 2725064.7500; val_gene_expr_recon_loss: 731256.2500; val_masked_gp_l1_reg_loss: 7730.0776; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46856.3984; val_chrom_access_recon_loss: 440394.3750; val_global_loss: 3987558.0000; val_optim_loss: 3987558.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9457; val_auprc_score: 0.9252; val_best_acc_score: 0.8905; val_best_f1_score: 0.8970; train_kl_reg_loss: 38279.9987; train_edge_recon_loss: 2711700.7222; train_gene_expr_recon_loss: 720369.2153; train_masked_gp_l1_reg_loss: 7745.1206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45278.2977; train_chrom_access_recon_loss: 439817.4028; train_global_loss: 3963190.7222; train_optim_loss: 3963190.7222; val_kl_reg_loss: 38481.3594; val_edge_recon_loss: 2750091.0000; val_gene_expr_recon_loss: 726961.3125; val_masked_gp_l1_reg_loss: 7764.0044; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43368.7695; val_chrom_access_recon_loss: 439198.2500; val_global_loss: 4005864.5000; val_optim_loss: 4005864.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9537; val_auprc_score: 0.9363; val_best_acc_score: 0.9061; val_best_f1_score: 0.9110; train_kl_reg_loss: 38602.7266; train_edge_recon_loss: 2700839.0000; train_gene_expr_recon_loss: 716436.1736; train_masked_gp_l1_reg_loss: 7772.5509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41956.7526; train_chrom_access_recon_loss: 440673.1424; train_global_loss: 3946280.3611; train_optim_loss: 3946280.3611; val_kl_reg_loss: 36766.9531; val_edge_recon_loss: 2716871.7500; val_gene_expr_recon_loss: 722425.8750; val_masked_gp_l1_reg_loss: 7789.7437; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40254.3750; val_chrom_access_recon_loss: 438410.7812; val_global_loss: 3962519.2500; val_optim_loss: 3962519.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9552; val_auprc_score: 0.9400; val_best_acc_score: 0.8985; val_best_f1_score: 0.9044; train_kl_reg_loss: 36765.0234; train_edge_recon_loss: 2713473.3611; train_gene_expr_recon_loss: 711386.2500; train_masked_gp_l1_reg_loss: 7803.8590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38996.6337; train_chrom_access_recon_loss: 440865.5312; train_global_loss: 3949290.5833; train_optim_loss: 3949290.5833; val_kl_reg_loss: 35956.1211; val_edge_recon_loss: 2731033.0000; val_gene_expr_recon_loss: 720178.0000; val_masked_gp_l1_reg_loss: 7827.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37481.1367; val_chrom_access_recon_loss: 437697.1562; val_global_loss: 3970173.0000; val_optim_loss: 3970173.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9599; val_auprc_score: 0.9438; val_best_acc_score: 0.9093; val_best_f1_score: 0.9139; train_kl_reg_loss: 36579.8320; train_edge_recon_loss: 2703050.6944; train_gene_expr_recon_loss: 716976.3889; train_masked_gp_l1_reg_loss: 7852.5310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36360.0352; train_chrom_access_recon_loss: 442112.7257; train_global_loss: 3942932.0833; train_optim_loss: 3942932.0833; val_kl_reg_loss: 35819.5078; val_edge_recon_loss: 2713990.2500; val_gene_expr_recon_loss: 717465.8750; val_masked_gp_l1_reg_loss: 7885.5659; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35012.5117; val_chrom_access_recon_loss: 437388.6875; val_global_loss: 3947562.2500; val_optim_loss: 3947562.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9655; val_auprc_score: 0.9500; val_best_acc_score: 0.9190; val_best_f1_score: 0.9224; train_kl_reg_loss: 36238.4132; train_edge_recon_loss: 2698203.1944; train_gene_expr_recon_loss: 711840.4722; train_masked_gp_l1_reg_loss: 7930.2652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34015.3503; train_chrom_access_recon_loss: 439327.5069; train_global_loss: 3927555.1667; train_optim_loss: 3927555.1667; val_kl_reg_loss: 35189.3750; val_edge_recon_loss: 2681885.2500; val_gene_expr_recon_loss: 717211.8750; val_masked_gp_l1_reg_loss: 7965.9575; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32811.2812; val_chrom_access_recon_loss: 436688.5625; val_global_loss: 3911752.2500; val_optim_loss: 3911752.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9660; val_auprc_score: 0.9506; val_best_acc_score: 0.9181; val_best_f1_score: 0.9216; train_kl_reg_loss: 34910.4609; train_edge_recon_loss: 2696499.5556; train_gene_expr_recon_loss: 712428.4097; train_masked_gp_l1_reg_loss: 8000.1468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31926.8553; train_chrom_access_recon_loss: 438436.2917; train_global_loss: 3922201.6944; train_optim_loss: 3922201.6944; val_kl_reg_loss: 33060.3359; val_edge_recon_loss: 2712479.2500; val_gene_expr_recon_loss: 715499.9375; val_masked_gp_l1_reg_loss: 8039.1592; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30860.6992; val_chrom_access_recon_loss: 436313.0000; val_global_loss: 3936252.5000; val_optim_loss: 3936252.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9702; val_auprc_score: 0.9569; val_best_acc_score: 0.9264; val_best_f1_score: 0.9293; train_kl_reg_loss: 33215.0699; train_edge_recon_loss: 2695356.6389; train_gene_expr_recon_loss: 709310.5486; train_masked_gp_l1_reg_loss: 8082.1898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30077.4058; train_chrom_access_recon_loss: 438470.2778; train_global_loss: 3914512.1667; train_optim_loss: 3914512.1667; val_kl_reg_loss: 33121.0977; val_edge_recon_loss: 2681503.0000; val_gene_expr_recon_loss: 715821.1250; val_masked_gp_l1_reg_loss: 8119.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29128.9961; val_chrom_access_recon_loss: 435677.6875; val_global_loss: 3903371.0000; val_optim_loss: 3903371.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9708; val_auprc_score: 0.9567; val_best_acc_score: 0.9276; val_best_f1_score: 0.9308; train_kl_reg_loss: 35011.3212; train_edge_recon_loss: 2684179.3056; train_gene_expr_recon_loss: 705023.7083; train_masked_gp_l1_reg_loss: 8157.7756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28427.9377; train_chrom_access_recon_loss: 436860.7188; train_global_loss: 3897660.7778; train_optim_loss: 3897660.7778; val_kl_reg_loss: 36579.5898; val_edge_recon_loss: 2661003.5000; val_gene_expr_recon_loss: 709582.3125; val_masked_gp_l1_reg_loss: 8192.9785; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27570.1797; val_chrom_access_recon_loss: 434786.0938; val_global_loss: 3877714.5000; val_optim_loss: 3877714.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9710; val_auprc_score: 0.9597; val_best_acc_score: 0.9298; val_best_f1_score: 0.9332; train_kl_reg_loss: 37916.7457; train_edge_recon_loss: 2670895.8889; train_gene_expr_recon_loss: 701581.1181; train_masked_gp_l1_reg_loss: 8221.0039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26924.9076; train_chrom_access_recon_loss: 436191.5625; train_global_loss: 3881731.2778; train_optim_loss: 3881731.2778; val_kl_reg_loss: 38118.0703; val_edge_recon_loss: 2682101.2500; val_gene_expr_recon_loss: 706130.8125; val_masked_gp_l1_reg_loss: 8255.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26141.7539; val_chrom_access_recon_loss: 434195.5938; val_global_loss: 3894943.0000; val_optim_loss: 3894943.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9714; val_auprc_score: 0.9619; val_best_acc_score: 0.9259; val_best_f1_score: 0.9289; train_kl_reg_loss: 36928.2826; train_edge_recon_loss: 2653026.8889; train_gene_expr_recon_loss: 1062725.2708; train_masked_gp_l1_reg_loss: 8313.1130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25279.6230; train_chrom_access_recon_loss: 461509.7118; train_global_loss: 4247782.8889; train_optim_loss: 4247782.8889; val_kl_reg_loss: 22034.8594; val_edge_recon_loss: 2693588.7500; val_gene_expr_recon_loss: 1069117.5000; val_masked_gp_l1_reg_loss: 8392.8496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24053.2969; val_chrom_access_recon_loss: 457599.6562; val_global_loss: 4274786.5000; val_optim_loss: 4274786.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9742; val_auprc_score: 0.9624; val_best_acc_score: 0.9352; val_best_f1_score: 0.9374; train_kl_reg_loss: 32112.7005; train_edge_recon_loss: 2665559.5000; train_gene_expr_recon_loss: 1066420.3125; train_masked_gp_l1_reg_loss: 8477.1953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22974.3043; train_chrom_access_recon_loss: 463345.1806; train_global_loss: 4258889.2222; train_optim_loss: 4258889.2222; val_kl_reg_loss: 20024.6289; val_edge_recon_loss: 2652153.0000; val_gene_expr_recon_loss: 1066626.2500; val_masked_gp_l1_reg_loss: 8583.8643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21627.5176; val_chrom_access_recon_loss: 457708.6875; val_global_loss: 4226724.0000; val_optim_loss: 4226724.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9728; val_auprc_score: 0.9613; val_best_acc_score: 0.9309; val_best_f1_score: 0.9338; train_kl_reg_loss: 29937.8561; train_edge_recon_loss: 2656381.6944; train_gene_expr_recon_loss: 1056324.1875; train_masked_gp_l1_reg_loss: 8675.5551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20595.9889; train_chrom_access_recon_loss: 458705.2153; train_global_loss: 4230620.4444; train_optim_loss: 4230620.4444; val_kl_reg_loss: 20065.5547; val_edge_recon_loss: 2668625.7500; val_gene_expr_recon_loss: 1065504.1250; val_masked_gp_l1_reg_loss: 8777.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19351.2598; val_chrom_access_recon_loss: 457111.9062; val_global_loss: 4239436.5000; val_optim_loss: 4239436.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9732; val_auprc_score: 0.9573; val_best_acc_score: 0.9332; val_best_f1_score: 0.9359; train_kl_reg_loss: 29325.4032; train_edge_recon_loss: 2649256.4167; train_gene_expr_recon_loss: 1055003.3125; train_masked_gp_l1_reg_loss: 8718.0659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19155.1165; train_chrom_access_recon_loss: 459906.8750; train_global_loss: 4221365.2500; train_optim_loss: 4221365.2500; val_kl_reg_loss: 19626.8711; val_edge_recon_loss: 2653595.0000; val_gene_expr_recon_loss: 1063891.7500; val_masked_gp_l1_reg_loss: 8664.4551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18940.1934; val_chrom_access_recon_loss: 457103.5625; val_global_loss: 4221822.0000; val_optim_loss: 4221822.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9728; val_auprc_score: 0.9606; val_best_acc_score: 0.9324; val_best_f1_score: 0.9351; train_kl_reg_loss: 28812.7476; train_edge_recon_loss: 2649134.4167; train_gene_expr_recon_loss: 1055490.8750; train_masked_gp_l1_reg_loss: 8655.9229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18808.1198; train_chrom_access_recon_loss: 459876.4236; train_global_loss: 4220778.5278; train_optim_loss: 4220778.5278; val_kl_reg_loss: 19407.1445; val_edge_recon_loss: 2670831.0000; val_gene_expr_recon_loss: 1064520.8750; val_masked_gp_l1_reg_loss: 8640.0146; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18637.6895; val_chrom_access_recon_loss: 457076.0312; val_global_loss: 4239113.0000; val_optim_loss: 4239113.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9744; val_auprc_score: 0.9634; val_best_acc_score: 0.9357; val_best_f1_score: 0.9383; train_kl_reg_loss: 28654.8472; train_edge_recon_loss: 2645535.8056; train_gene_expr_recon_loss: 1054838.1389; train_masked_gp_l1_reg_loss: 8635.0277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18514.9900; train_chrom_access_recon_loss: 459802.3924; train_global_loss: 4215981.2500; train_optim_loss: 4215981.2500; val_kl_reg_loss: 19459.1660; val_edge_recon_loss: 2666615.5000; val_gene_expr_recon_loss: 1064089.0000; val_masked_gp_l1_reg_loss: 8631.2139; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18365.3887; val_chrom_access_recon_loss: 457048.7812; val_global_loss: 4234209.5000; val_optim_loss: 4234209.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9738; val_auprc_score: 0.9638; val_best_acc_score: 0.9329; val_best_f1_score: 0.9357; train_kl_reg_loss: 28418.2554; train_edge_recon_loss: 2657707.3889; train_gene_expr_recon_loss: 1052807.2222; train_masked_gp_l1_reg_loss: 8632.2383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18254.0684; train_chrom_access_recon_loss: 459002.7847; train_global_loss: 4224821.9444; train_optim_loss: 4224821.9444; val_kl_reg_loss: 19340.6055; val_edge_recon_loss: 2664666.0000; val_gene_expr_recon_loss: 1063811.0000; val_masked_gp_l1_reg_loss: 8634.0732; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18122.3828; val_chrom_access_recon_loss: 457014.5625; val_global_loss: 4231588.5000; val_optim_loss: 4231588.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 22 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9678
val AUPRC score: 0.9553
val best accuracy score: 0.9266
val best F1 score: 0.9296
val target rna MSE score: 4.3467
val source rna MSE score: 3.4642
val target atac MSE score: 0.1325
val source atac MSE score: 0.0226
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
