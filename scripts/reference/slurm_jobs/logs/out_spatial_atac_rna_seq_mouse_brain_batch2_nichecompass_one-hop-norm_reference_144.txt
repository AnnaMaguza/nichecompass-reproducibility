[True]
Run timestamp: 26072023_035440_144.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_144']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9530; val_auprc_score: 0.9581; val_best_acc_score: 0.5070; val_best_f1_score: 0.6698; train_kl_reg_loss: 8127.8593; train_edge_recon_loss: 34725135.5556; train_gene_expr_recon_loss: 3188954.4722; train_masked_gp_l1_reg_loss: 1864.8811; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108374756.4444; train_global_loss: 146298844.4444; train_optim_loss: 146298844.4444; val_kl_reg_loss: 17626.2305; val_edge_recon_loss: 40639792.0000; val_gene_expr_recon_loss: 3110307.5000; val_masked_gp_l1_reg_loss: 1888.0016; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 107496688.0000; val_global_loss: 151266304.0000; val_optim_loss: 151266304.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9350; val_auprc_score: 0.9416; val_best_acc_score: 0.5062; val_best_f1_score: 0.6694; train_kl_reg_loss: 45272.5996; train_edge_recon_loss: 34825725.7778; train_gene_expr_recon_loss: 3017708.1944; train_masked_gp_l1_reg_loss: 1980.9047; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106723311.1111; train_global_loss: 144613996.4444; train_optim_loss: 144613996.4444; val_kl_reg_loss: 79430.2031; val_edge_recon_loss: 40645796.0000; val_gene_expr_recon_loss: 2895636.0000; val_masked_gp_l1_reg_loss: 2129.6343; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 105598912.0000; val_global_loss: 149221904.0000; val_optim_loss: 149221904.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9145; val_auprc_score: 0.9246; val_best_acc_score: 0.5079; val_best_f1_score: 0.6702; train_kl_reg_loss: 131543.2630; train_edge_recon_loss: 34831612.8889; train_gene_expr_recon_loss: 2801482.8056; train_masked_gp_l1_reg_loss: 2277.9493; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 105011947.5556; train_global_loss: 142778862.2222; train_optim_loss: 142778862.2222; val_kl_reg_loss: 117016.0312; val_edge_recon_loss: 40648676.0000; val_gene_expr_recon_loss: 2687785.2500; val_masked_gp_l1_reg_loss: 2460.4270; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103781784.0000; val_global_loss: 147237728.0000; val_optim_loss: 147237728.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9135; val_auprc_score: 0.9177; val_best_acc_score: 0.5084; val_best_f1_score: 0.6703; train_kl_reg_loss: 203055.6224; train_edge_recon_loss: 34845643.5556; train_gene_expr_recon_loss: 2618976.7222; train_masked_gp_l1_reg_loss: 2573.7428; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102220463.1111; train_global_loss: 139890712.8889; train_optim_loss: 139890712.8889; val_kl_reg_loss: 146287.4375; val_edge_recon_loss: 40648428.0000; val_gene_expr_recon_loss: 2547730.5000; val_masked_gp_l1_reg_loss: 2688.5071; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102167144.0000; val_global_loss: 145512288.0000; val_optim_loss: 145512288.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9193; val_auprc_score: 0.9252; val_best_acc_score: 0.5032; val_best_f1_score: 0.6681; train_kl_reg_loss: 244840.4462; train_edge_recon_loss: 34841340.8889; train_gene_expr_recon_loss: 2472289.4722; train_masked_gp_l1_reg_loss: 2748.0374; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100845012.4444; train_global_loss: 138406229.3333; train_optim_loss: 138406229.3333; val_kl_reg_loss: 378548.1562; val_edge_recon_loss: 40651228.0000; val_gene_expr_recon_loss: 2442633.2500; val_masked_gp_l1_reg_loss: 2804.5200; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101044480.0000; val_global_loss: 144519696.0000; val_optim_loss: 144519696.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9127; val_auprc_score: 0.9157; val_best_acc_score: 0.5074; val_best_f1_score: 0.6700; train_kl_reg_loss: 324150.9983; train_edge_recon_loss: 34831780.8889; train_gene_expr_recon_loss: 2392103.8889; train_masked_gp_l1_reg_loss: 2822.4842; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100128571.5556; train_global_loss: 137679429.3333; train_optim_loss: 137679429.3333; val_kl_reg_loss: 230714.5156; val_edge_recon_loss: 40648232.0000; val_gene_expr_recon_loss: 2370848.7500; val_masked_gp_l1_reg_loss: 2830.5227; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99912680.0000; val_global_loss: 143165312.0000; val_optim_loss: 143165312.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9118; val_auprc_score: 0.9130; val_best_acc_score: 0.5123; val_best_f1_score: 0.6720; train_kl_reg_loss: 350307.6146; train_edge_recon_loss: 34850033.3333; train_gene_expr_recon_loss: 2326940.1667; train_masked_gp_l1_reg_loss: 2822.4615; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99382694.2222; train_global_loss: 136912801.7778; train_optim_loss: 136912801.7778; val_kl_reg_loss: 220208.1250; val_edge_recon_loss: 40644096.0000; val_gene_expr_recon_loss: 2317655.0000; val_masked_gp_l1_reg_loss: 2804.6782; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99301296.0000; val_global_loss: 142486064.0000; val_optim_loss: 142486064.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9126; val_auprc_score: 0.9143; val_best_acc_score: 0.5144; val_best_f1_score: 0.6730; train_kl_reg_loss: 373827.2170; train_edge_recon_loss: 34849011.1111; train_gene_expr_recon_loss: 2275377.2778; train_masked_gp_l1_reg_loss: 2785.1108; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98315255.1111; train_global_loss: 135816256.0000; train_optim_loss: 135816256.0000; val_kl_reg_loss: 264512.5938; val_edge_recon_loss: 40640340.0000; val_gene_expr_recon_loss: 2272684.2500; val_masked_gp_l1_reg_loss: 2757.4927; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98836920.0000; val_global_loss: 142017216.0000; val_optim_loss: 142017216.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9159; val_auprc_score: 0.9150; val_best_acc_score: 0.5267; val_best_f1_score: 0.6786; train_kl_reg_loss: 355521.8403; train_edge_recon_loss: 34881817.3333; train_gene_expr_recon_loss: 2240771.6944; train_masked_gp_l1_reg_loss: 2735.5532; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97932386.6667; train_global_loss: 135413230.2222; train_optim_loss: 135413230.2222; val_kl_reg_loss: 248342.5625; val_edge_recon_loss: 40631436.0000; val_gene_expr_recon_loss: 2242714.2500; val_masked_gp_l1_reg_loss: 2705.9583; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98330144.0000; val_global_loss: 141455344.0000; val_optim_loss: 141455344.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9151; val_auprc_score: 0.9123; val_best_acc_score: 0.5318; val_best_f1_score: 0.6809; train_kl_reg_loss: 350673.9340; train_edge_recon_loss: 34873702.2222; train_gene_expr_recon_loss: 2211590.9722; train_masked_gp_l1_reg_loss: 2686.2912; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97612158.2222; train_global_loss: 135050814.2222; train_optim_loss: 135050814.2222; val_kl_reg_loss: 287158.3125; val_edge_recon_loss: 40627228.0000; val_gene_expr_recon_loss: 2220937.2500; val_masked_gp_l1_reg_loss: 2660.1738; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98261560.0000; val_global_loss: 141399552.0000; val_optim_loss: 141399552.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9176; val_auprc_score: 0.9163; val_best_acc_score: 0.5488; val_best_f1_score: 0.6885; train_kl_reg_loss: 356924.6354; train_edge_recon_loss: 34908414.6667; train_gene_expr_recon_loss: 2187163.3611; train_masked_gp_l1_reg_loss: 2641.9111; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97301896.8889; train_global_loss: 134757044.4444; train_optim_loss: 134757044.4444; val_kl_reg_loss: 287026.1875; val_edge_recon_loss: 40619044.0000; val_gene_expr_recon_loss: 2200664.0000; val_masked_gp_l1_reg_loss: 2619.7703; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98038392.0000; val_global_loss: 141147744.0000; val_optim_loss: 141147744.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9122; val_auprc_score: 0.9098; val_best_acc_score: 0.5823; val_best_f1_score: 0.7041; train_kl_reg_loss: 349956.2188; train_edge_recon_loss: 34867321.3333; train_gene_expr_recon_loss: 2188279.7222; train_masked_gp_l1_reg_loss: 2604.8287; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97765979.5556; train_global_loss: 135174139.5556; train_optim_loss: 135174139.5556; val_kl_reg_loss: 202201.5000; val_edge_recon_loss: 40604964.0000; val_gene_expr_recon_loss: 2195230.2500; val_masked_gp_l1_reg_loss: 2584.8384; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98014168.0000; val_global_loss: 141019152.0000; val_optim_loss: 141019152.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9198; val_auprc_score: 0.9142; val_best_acc_score: 0.6403; val_best_f1_score: 0.7336; train_kl_reg_loss: 341284.2257; train_edge_recon_loss: 34887577.3333; train_gene_expr_recon_loss: 2157397.2778; train_masked_gp_l1_reg_loss: 2574.4122; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97159203.5556; train_global_loss: 134548035.5556; train_optim_loss: 134548035.5556; val_kl_reg_loss: 225524.5312; val_edge_recon_loss: 40583272.0000; val_gene_expr_recon_loss: 2178624.0000; val_masked_gp_l1_reg_loss: 2560.2959; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97763608.0000; val_global_loss: 140753584.0000; val_optim_loss: 140753584.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9251; val_auprc_score: 0.9182; val_best_acc_score: 0.7088; val_best_f1_score: 0.7718; train_kl_reg_loss: 317663.5035; train_edge_recon_loss: 34886896.0000; train_gene_expr_recon_loss: 2153870.6944; train_masked_gp_l1_reg_loss: 2552.9706; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97323896.8889; train_global_loss: 134684880.8889; train_optim_loss: 134684880.8889; val_kl_reg_loss: 251190.8125; val_edge_recon_loss: 40553376.0000; val_gene_expr_recon_loss: 2165743.7500; val_masked_gp_l1_reg_loss: 2543.4788; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97626136.0000; val_global_loss: 140598992.0000; val_optim_loss: 140598992.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9243; val_auprc_score: 0.9178; val_best_acc_score: 0.7848; val_best_f1_score: 0.8175; train_kl_reg_loss: 316011.2795; train_edge_recon_loss: 34874333.3333; train_gene_expr_recon_loss: 2158920.0556; train_masked_gp_l1_reg_loss: 2537.8502; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98045581.3333; train_global_loss: 135397385.7778; train_optim_loss: 135397385.7778; val_kl_reg_loss: 232893.6719; val_edge_recon_loss: 40485612.0000; val_gene_expr_recon_loss: 2161310.0000; val_masked_gp_l1_reg_loss: 2527.3110; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97521832.0000; val_global_loss: 140404176.0000; val_optim_loss: 140404176.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9234; val_auprc_score: 0.9180; val_best_acc_score: 0.8296; val_best_f1_score: 0.8452; train_kl_reg_loss: 314333.5278; train_edge_recon_loss: 34857195.1111; train_gene_expr_recon_loss: 2135257.9167; train_masked_gp_l1_reg_loss: 2522.1942; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96715576.0000; train_global_loss: 134024885.3333; train_optim_loss: 134024885.3333; val_kl_reg_loss: 204130.0469; val_edge_recon_loss: 40369924.0000; val_gene_expr_recon_loss: 2157966.5000; val_masked_gp_l1_reg_loss: 2512.9492; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97475952.0000; val_global_loss: 140210496.0000; val_optim_loss: 140210496.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9207; val_auprc_score: 0.9114; val_best_acc_score: 0.8453; val_best_f1_score: 0.8517; train_kl_reg_loss: 301642.1476; train_edge_recon_loss: 34830725.3333; train_gene_expr_recon_loss: 2141634.1111; train_masked_gp_l1_reg_loss: 2511.5196; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96384234.6667; train_global_loss: 133660747.5556; train_optim_loss: 133660747.5556; val_kl_reg_loss: 226101.6875; val_edge_recon_loss: 40217736.0000; val_gene_expr_recon_loss: 2150706.7500; val_masked_gp_l1_reg_loss: 2507.6011; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97393864.0000; val_global_loss: 139990912.0000; val_optim_loss: 139990912.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9172; val_auprc_score: 0.9053; val_best_acc_score: 0.8383; val_best_f1_score: 0.8351; train_kl_reg_loss: 293197.1997; train_edge_recon_loss: 34799544.4444; train_gene_expr_recon_loss: 2132562.1389; train_masked_gp_l1_reg_loss: 2504.4747; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96414629.3333; train_global_loss: 133642439.1111; train_optim_loss: 133642439.1111; val_kl_reg_loss: 224175.5000; val_edge_recon_loss: 39874308.0000; val_gene_expr_recon_loss: 2146499.7500; val_masked_gp_l1_reg_loss: 2498.8174; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97298496.0000; val_global_loss: 139545984.0000; val_optim_loss: 139545984.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9243; val_auprc_score: 0.9164; val_best_acc_score: 0.8143; val_best_f1_score: 0.8333; train_kl_reg_loss: 269170.9670; train_edge_recon_loss: 34716435.1111; train_gene_expr_recon_loss: 2118039.0972; train_masked_gp_l1_reg_loss: 2496.8584; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96434616.8889; train_global_loss: 133540757.3333; train_optim_loss: 133540757.3333; val_kl_reg_loss: 238552.6250; val_edge_recon_loss: 39014992.0000; val_gene_expr_recon_loss: 2146113.2500; val_masked_gp_l1_reg_loss: 2493.5879; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97348680.0000; val_global_loss: 138750832.0000; val_optim_loss: 138750832.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9151; val_auprc_score: 0.9014; val_best_acc_score: 0.8290; val_best_f1_score: 0.8408; train_kl_reg_loss: 251420.3403; train_edge_recon_loss: 34488960.4444; train_gene_expr_recon_loss: 2131073.7500; train_masked_gp_l1_reg_loss: 2497.5039; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96353689.7778; train_global_loss: 133227643.5556; train_optim_loss: 133227643.5556; val_kl_reg_loss: 176355.3750; val_edge_recon_loss: 37073572.0000; val_gene_expr_recon_loss: 2151097.2500; val_masked_gp_l1_reg_loss: 2499.7075; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97225032.0000; val_global_loss: 136628560.0000; val_optim_loss: 136628560.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8973; val_auprc_score: 0.8838; val_best_acc_score: 0.8114; val_best_f1_score: 0.8234; train_kl_reg_loss: 152698.5078; train_edge_recon_loss: 33598374.2222; train_gene_expr_recon_loss: 2142622.6250; train_masked_gp_l1_reg_loss: 2509.2576; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96566800.0000; train_global_loss: 132463005.3333; train_optim_loss: 132463005.3333; val_kl_reg_loss: 79425.1094; val_edge_recon_loss: 32720638.0000; val_gene_expr_recon_loss: 2197074.7500; val_masked_gp_l1_reg_loss: 2526.3503; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97567888.0000; val_global_loss: 132567552.0000; val_optim_loss: 132567552.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8833; val_auprc_score: 0.8686; val_best_acc_score: 0.7937; val_best_f1_score: 0.8094; train_kl_reg_loss: 93892.4323; train_edge_recon_loss: 30748100.4444; train_gene_expr_recon_loss: 2208586.2222; train_masked_gp_l1_reg_loss: 2565.0604; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96757332.4444; train_global_loss: 129810475.5556; train_optim_loss: 129810475.5556; val_kl_reg_loss: 135581.7812; val_edge_recon_loss: 29679224.0000; val_gene_expr_recon_loss: 2230157.5000; val_masked_gp_l1_reg_loss: 2624.3315; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98802136.0000; val_global_loss: 130849728.0000; val_optim_loss: 130849728.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8886; val_auprc_score: 0.8722; val_best_acc_score: 0.8021; val_best_f1_score: 0.8155; train_kl_reg_loss: 149942.4913; train_edge_recon_loss: 29796366.4444; train_gene_expr_recon_loss: 2193501.6111; train_masked_gp_l1_reg_loss: 2685.1007; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97236961.7778; train_global_loss: 129379458.6667; train_optim_loss: 129379458.6667; val_kl_reg_loss: 129050.5469; val_edge_recon_loss: 29973850.0000; val_gene_expr_recon_loss: 2222916.0000; val_masked_gp_l1_reg_loss: 2748.4983; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97646176.0000; val_global_loss: 129974736.0000; val_optim_loss: 129974736.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8884; val_auprc_score: 0.8675; val_best_acc_score: 0.8017; val_best_f1_score: 0.8214; train_kl_reg_loss: 167153.3403; train_edge_recon_loss: 29501897.1111; train_gene_expr_recon_loss: 2179011.5000; train_masked_gp_l1_reg_loss: 2796.5308; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96334611.5556; train_global_loss: 128185469.3333; train_optim_loss: 128185469.3333; val_kl_reg_loss: 202226.0938; val_edge_recon_loss: 28840062.0000; val_gene_expr_recon_loss: 2207448.7500; val_masked_gp_l1_reg_loss: 2850.4580; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97506928.0000; val_global_loss: 128759512.0000; val_optim_loss: 128759512.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8828; val_auprc_score: 0.8571; val_best_acc_score: 0.8026; val_best_f1_score: 0.8179; train_kl_reg_loss: 241265.5122; train_edge_recon_loss: 29063679.5556; train_gene_expr_recon_loss: 2162013.5833; train_masked_gp_l1_reg_loss: 2887.1849; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96483790.2222; train_global_loss: 127953635.5556; train_optim_loss: 127953635.5556; val_kl_reg_loss: 268489.6875; val_edge_recon_loss: 28914920.0000; val_gene_expr_recon_loss: 2180643.7500; val_masked_gp_l1_reg_loss: 2931.9470; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97260648.0000; val_global_loss: 128627632.0000; val_optim_loss: 128627632.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8962; val_auprc_score: 0.8727; val_best_acc_score: 0.8184; val_best_f1_score: 0.8329; train_kl_reg_loss: 294070.4115; train_edge_recon_loss: 30417335.1111; train_gene_expr_recon_loss: 2215252.3611; train_masked_gp_l1_reg_loss: 2978.2879; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97039293.3333; train_global_loss: 129968928.8889; train_optim_loss: 129968928.8889; val_kl_reg_loss: 56964.0391; val_edge_recon_loss: 29696358.0000; val_gene_expr_recon_loss: 2275363.0000; val_masked_gp_l1_reg_loss: 3037.0286; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98091672.0000; val_global_loss: 130123392.0000; val_optim_loss: 130123392.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8992; val_auprc_score: 0.8760; val_best_acc_score: 0.8211; val_best_f1_score: 0.8363; train_kl_reg_loss: 426676.2569; train_edge_recon_loss: 29467160.0000; train_gene_expr_recon_loss: 2215527.2778; train_masked_gp_l1_reg_loss: 3073.7430; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97273096.0000; train_global_loss: 129385535.1111; train_optim_loss: 129385535.1111; val_kl_reg_loss: 76273.3281; val_edge_recon_loss: 29124502.0000; val_gene_expr_recon_loss: 2240593.2500; val_masked_gp_l1_reg_loss: 3110.4873; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97633120.0000; val_global_loss: 129077600.0000; val_optim_loss: 129077600.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8949; val_auprc_score: 0.8666; val_best_acc_score: 0.8205; val_best_f1_score: 0.8353; train_kl_reg_loss: 506366.7882; train_edge_recon_loss: 29109488.4444; train_gene_expr_recon_loss: 2203512.6389; train_masked_gp_l1_reg_loss: 3129.8560; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96432402.6667; train_global_loss: 128254900.4444; train_optim_loss: 128254900.4444; val_kl_reg_loss: 87736.5547; val_edge_recon_loss: 29075792.0000; val_gene_expr_recon_loss: 2220314.5000; val_masked_gp_l1_reg_loss: 3149.0698; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97280744.0000; val_global_loss: 128667736.0000; val_optim_loss: 128667736.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8990; val_auprc_score: 0.8707; val_best_acc_score: 0.8259; val_best_f1_score: 0.8400; train_kl_reg_loss: 526156.9583; train_edge_recon_loss: 28968322.0000; train_gene_expr_recon_loss: 2186653.4167; train_masked_gp_l1_reg_loss: 3159.4025; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95992897.7778; train_global_loss: 127677189.3333; train_optim_loss: 127677189.3333; val_kl_reg_loss: 103112.4297; val_edge_recon_loss: 28672526.0000; val_gene_expr_recon_loss: 2216411.5000; val_masked_gp_l1_reg_loss: 3167.7366; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97236456.0000; val_global_loss: 128231672.0000; val_optim_loss: 128231672.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9006; val_auprc_score: 0.8709; val_best_acc_score: 0.8309; val_best_f1_score: 0.8424; train_kl_reg_loss: 495954.2188; train_edge_recon_loss: 28656777.7778; train_gene_expr_recon_loss: 2185297.3056; train_masked_gp_l1_reg_loss: 3169.6418; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96099387.5556; train_global_loss: 127440585.7778; train_optim_loss: 127440585.7778; val_kl_reg_loss: 97641.1250; val_edge_recon_loss: 28692528.0000; val_gene_expr_recon_loss: 2220786.5000; val_masked_gp_l1_reg_loss: 3169.4087; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97396696.0000; val_global_loss: 128410824.0000; val_optim_loss: 128410824.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9133; val_auprc_score: 0.8873; val_best_acc_score: 0.8455; val_best_f1_score: 0.8575; train_kl_reg_loss: 435552.4688; train_edge_recon_loss: 28444696.4444; train_gene_expr_recon_loss: 2195745.8889; train_masked_gp_l1_reg_loss: 3169.4184; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96899864.8889; train_global_loss: 127979029.3333; train_optim_loss: 127979029.3333; val_kl_reg_loss: 94300.4766; val_edge_recon_loss: 28211128.0000; val_gene_expr_recon_loss: 2200054.7500; val_masked_gp_l1_reg_loss: 3169.2388; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97096344.0000; val_global_loss: 127604992.0000; val_optim_loss: 127604992.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9097; val_auprc_score: 0.8785; val_best_acc_score: 0.8473; val_best_f1_score: 0.8585; train_kl_reg_loss: 385389.2674; train_edge_recon_loss: 28292787.5556; train_gene_expr_recon_loss: 2186330.0000; train_masked_gp_l1_reg_loss: 3169.5789; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96217939.5556; train_global_loss: 127085616.8889; train_optim_loss: 127085616.8889; val_kl_reg_loss: 105601.0391; val_edge_recon_loss: 28272242.0000; val_gene_expr_recon_loss: 2221961.0000; val_masked_gp_l1_reg_loss: 3169.4189; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97067800.0000; val_global_loss: 127670776.0000; val_optim_loss: 127670776.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9082; val_auprc_score: 0.8776; val_best_acc_score: 0.8432; val_best_f1_score: 0.8560; train_kl_reg_loss: 349515.6597; train_edge_recon_loss: 28105252.8889; train_gene_expr_recon_loss: 2180690.4444; train_masked_gp_l1_reg_loss: 3168.7654; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96287171.5556; train_global_loss: 126925800.0000; train_optim_loss: 126925800.0000; val_kl_reg_loss: 114088.3203; val_edge_recon_loss: 28257194.0000; val_gene_expr_recon_loss: 2196244.5000; val_masked_gp_l1_reg_loss: 3167.7510; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96884464.0000; val_global_loss: 127455160.0000; val_optim_loss: 127455160.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9101; val_auprc_score: 0.8842; val_best_acc_score: 0.8429; val_best_f1_score: 0.8542; train_kl_reg_loss: 330946.8403; train_edge_recon_loss: 28052821.1111; train_gene_expr_recon_loss: 2153314.3056; train_masked_gp_l1_reg_loss: 3167.4303; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95635551.1111; train_global_loss: 126175800.8889; train_optim_loss: 126175800.8889; val_kl_reg_loss: 119613.2422; val_edge_recon_loss: 28084802.0000; val_gene_expr_recon_loss: 2211987.7500; val_masked_gp_l1_reg_loss: 3165.7483; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96968472.0000; val_global_loss: 127388040.0000; val_optim_loss: 127388040.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9161; val_auprc_score: 0.8930; val_best_acc_score: 0.8513; val_best_f1_score: 0.8620; train_kl_reg_loss: 321990.4583; train_edge_recon_loss: 28066421.3333; train_gene_expr_recon_loss: 2186602.6944; train_masked_gp_l1_reg_loss: 3164.6287; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95953832.8889; train_global_loss: 126532012.4444; train_optim_loss: 126532012.4444; val_kl_reg_loss: 119958.2812; val_edge_recon_loss: 27906084.0000; val_gene_expr_recon_loss: 2195988.0000; val_masked_gp_l1_reg_loss: 3162.8835; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96810560.0000; val_global_loss: 127035752.0000; val_optim_loss: 127035752.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9114; val_auprc_score: 0.8812; val_best_acc_score: 0.8511; val_best_f1_score: 0.8618; train_kl_reg_loss: 312278.6146; train_edge_recon_loss: 27981806.0000; train_gene_expr_recon_loss: 2161304.0278; train_masked_gp_l1_reg_loss: 3162.0849; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95772644.4444; train_global_loss: 126231195.5556; train_optim_loss: 126231195.5556; val_kl_reg_loss: 134785.8750; val_edge_recon_loss: 28269524.0000; val_gene_expr_recon_loss: 2177534.0000; val_masked_gp_l1_reg_loss: 3160.0376; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96709544.0000; val_global_loss: 127294544.0000; val_optim_loss: 127294544.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9096; val_auprc_score: 0.8782; val_best_acc_score: 0.8472; val_best_f1_score: 0.8594; train_kl_reg_loss: 315391.4306; train_edge_recon_loss: 27852209.5556; train_gene_expr_recon_loss: 2159486.8056; train_masked_gp_l1_reg_loss: 3157.4876; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95567270.2222; train_global_loss: 125897516.4444; train_optim_loss: 125897516.4444; val_kl_reg_loss: 139554.7812; val_edge_recon_loss: 28067524.0000; val_gene_expr_recon_loss: 2184159.5000; val_masked_gp_l1_reg_loss: 3154.7466; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96527344.0000; val_global_loss: 126921736.0000; val_optim_loss: 126921736.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9154; val_auprc_score: 0.8864; val_best_acc_score: 0.8539; val_best_f1_score: 0.8640; train_kl_reg_loss: 315962.7812; train_edge_recon_loss: 27797010.6667; train_gene_expr_recon_loss: 2155180.4722; train_masked_gp_l1_reg_loss: 3152.8676; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95532417.7778; train_global_loss: 125803723.5556; train_optim_loss: 125803723.5556; val_kl_reg_loss: 147544.1562; val_edge_recon_loss: 27837252.0000; val_gene_expr_recon_loss: 2193684.2500; val_masked_gp_l1_reg_loss: 3149.7681; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96485312.0000; val_global_loss: 126666944.0000; val_optim_loss: 126666944.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9046; val_auprc_score: 0.8774; val_best_acc_score: 0.8363; val_best_f1_score: 0.8505; train_kl_reg_loss: 338125.2153; train_edge_recon_loss: 28500816.6667; train_gene_expr_recon_loss: 2543321.0000; train_masked_gp_l1_reg_loss: 3149.7919; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96869605.3333; train_global_loss: 128255017.7778; train_optim_loss: 128255017.7778; val_kl_reg_loss: 137492.1250; val_edge_recon_loss: 29406554.0000; val_gene_expr_recon_loss: 2428062.5000; val_masked_gp_l1_reg_loss: 3156.7476; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96464928.0000; val_global_loss: 128440192.0000; val_optim_loss: 128440192.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9103; val_auprc_score: 0.8777; val_best_acc_score: 0.8525; val_best_f1_score: 0.8629; train_kl_reg_loss: 286413.5000; train_edge_recon_loss: 28523799.1111; train_gene_expr_recon_loss: 2232216.0556; train_masked_gp_l1_reg_loss: 3165.0441; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95675717.3333; train_global_loss: 126721310.2222; train_optim_loss: 126721310.2222; val_kl_reg_loss: 132007.3438; val_edge_recon_loss: 28593156.0000; val_gene_expr_recon_loss: 2191209.5000; val_masked_gp_l1_reg_loss: 3169.4299; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96323080.0000; val_global_loss: 127242624.0000; val_optim_loss: 127242624.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9106; val_auprc_score: 0.8821; val_best_acc_score: 0.8483; val_best_f1_score: 0.8620; train_kl_reg_loss: 248946.7031; train_edge_recon_loss: 28342478.0000; train_gene_expr_recon_loss: 2171962.5556; train_masked_gp_l1_reg_loss: 3167.1854; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95788701.3333; train_global_loss: 126555255.1111; train_optim_loss: 126555255.1111; val_kl_reg_loss: 121022.7422; val_edge_recon_loss: 28518424.0000; val_gene_expr_recon_loss: 2231278.0000; val_masked_gp_l1_reg_loss: 3161.9153; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96298072.0000; val_global_loss: 127171960.0000; val_optim_loss: 127171960.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9099; val_auprc_score: 0.8761; val_best_acc_score: 0.8514; val_best_f1_score: 0.8619; train_kl_reg_loss: 212828.6389; train_edge_recon_loss: 28221141.7778; train_gene_expr_recon_loss: 2153128.1944; train_masked_gp_l1_reg_loss: 3156.8731; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95406594.6667; train_global_loss: 125996848.8889; train_optim_loss: 125996848.8889; val_kl_reg_loss: 104253.0469; val_edge_recon_loss: 28222340.0000; val_gene_expr_recon_loss: 2179000.2500; val_masked_gp_l1_reg_loss: 3150.8125; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96455824.0000; val_global_loss: 126964568.0000; val_optim_loss: 126964568.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9111; val_auprc_score: 0.8834; val_best_acc_score: 0.8479; val_best_f1_score: 0.8593; train_kl_reg_loss: 199432.3698; train_edge_recon_loss: 28110789.3333; train_gene_expr_recon_loss: 2140890.8333; train_masked_gp_l1_reg_loss: 3150.2520; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95299715.5556; train_global_loss: 125753977.7778; train_optim_loss: 125753977.7778; val_kl_reg_loss: 107167.5938; val_edge_recon_loss: 28441668.0000; val_gene_expr_recon_loss: 2165082.5000; val_masked_gp_l1_reg_loss: 3149.8010; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96374240.0000; val_global_loss: 127091312.0000; val_optim_loss: 127091312.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9123; val_auprc_score: 0.8806; val_best_acc_score: 0.8500; val_best_f1_score: 0.8618; train_kl_reg_loss: 204576.9184; train_edge_recon_loss: 28301751.5556; train_gene_expr_recon_loss: 2129645.6250; train_masked_gp_l1_reg_loss: 3149.4249; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95004584.0000; train_global_loss: 125643708.4444; train_optim_loss: 125643708.4444; val_kl_reg_loss: 109304.5156; val_edge_recon_loss: 28198386.0000; val_gene_expr_recon_loss: 2161279.2500; val_masked_gp_l1_reg_loss: 3148.7446; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96258064.0000; val_global_loss: 126730184.0000; val_optim_loss: 126730184.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9126; val_auprc_score: 0.8829; val_best_acc_score: 0.8560; val_best_f1_score: 0.8658; train_kl_reg_loss: 206917.9427; train_edge_recon_loss: 27969991.3333; train_gene_expr_recon_loss: 2135436.5972; train_masked_gp_l1_reg_loss: 3148.2011; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95727685.3333; train_global_loss: 126043177.7778; train_optim_loss: 126043177.7778; val_kl_reg_loss: 110911.9609; val_edge_recon_loss: 28230384.0000; val_gene_expr_recon_loss: 2164844.0000; val_masked_gp_l1_reg_loss: 3147.6978; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96253872.0000; val_global_loss: 126763160.0000; val_optim_loss: 126763160.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9144; val_auprc_score: 0.8860; val_best_acc_score: 0.8530; val_best_f1_score: 0.8638; train_kl_reg_loss: 211030.8021; train_edge_recon_loss: 28111343.1111; train_gene_expr_recon_loss: 2138336.3889; train_masked_gp_l1_reg_loss: 3147.5429; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95952975.1111; train_global_loss: 126416833.7778; train_optim_loss: 126416833.7778; val_kl_reg_loss: 113947.8750; val_edge_recon_loss: 28293266.0000; val_gene_expr_recon_loss: 2158886.5000; val_masked_gp_l1_reg_loss: 3147.3965; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96154320.0000; val_global_loss: 126723568.0000; val_optim_loss: 126723568.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 52 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9140
Val AUPRC score: 0.8838
Val best accuracy score: 0.8517
Val best F1 score: 0.8634
Val gene expr MSE score: 1.8641
Val chrom access MSE score: 0.0877
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
