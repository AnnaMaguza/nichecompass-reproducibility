[True]
Run timestamp: 09102023_214548_46.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_46']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7862; val_auprc_score: 0.8021; val_best_acc_score: 0.5632; val_best_f1_score: 0.6922; train_kl_reg_loss: 64600.4460; train_edge_recon_loss: 3508442.3244; train_gene_expr_recon_loss: 13315660.4885; train_masked_gp_l1_reg_loss: 116998.9839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2701667.7801; train_chrom_access_recon_loss: 2245632.7844; train_global_loss: 21953002.8244; train_optim_loss: 21953002.8244; val_kl_reg_loss: 86728.2849; val_edge_recon_loss: 4061740.1500; val_gene_expr_recon_loss: 12660328.6000; val_masked_gp_l1_reg_loss: 101577.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 368328.4688; val_chrom_access_recon_loss: 2140731.7000; val_global_loss: 19419434.2667; val_optim_loss: 19419434.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8522; val_auprc_score: 0.8560; val_best_acc_score: 0.7670; val_best_f1_score: 0.7806; train_kl_reg_loss: 80903.5070; train_edge_recon_loss: 3497773.2443; train_gene_expr_recon_loss: 12579300.9008; train_masked_gp_l1_reg_loss: 101211.2917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199884.3704; train_chrom_access_recon_loss: 2167018.1116; train_global_loss: 18626091.4656; train_optim_loss: 18626091.4656; val_kl_reg_loss: 64496.0740; val_edge_recon_loss: 3833340.6667; val_gene_expr_recon_loss: 12437581.8000; val_masked_gp_l1_reg_loss: 103098.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128494.5703; val_chrom_access_recon_loss: 2118901.2417; val_global_loss: 18685912.2667; val_optim_loss: 18685912.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9052; val_auprc_score: 0.8888; val_best_acc_score: 0.8359; val_best_f1_score: 0.8481; train_kl_reg_loss: 82450.9150; train_edge_recon_loss: 3060553.9256; train_gene_expr_recon_loss: 12467895.8473; train_masked_gp_l1_reg_loss: 115213.6044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108788.3096; train_chrom_access_recon_loss: 2146361.8788; train_global_loss: 17981264.4427; train_optim_loss: 17981264.4427; val_kl_reg_loss: 100806.4271; val_edge_recon_loss: 2886280.1667; val_gene_expr_recon_loss: 12374490.4667; val_masked_gp_l1_reg_loss: 125583.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98928.2109; val_chrom_access_recon_loss: 2102758.4750; val_global_loss: 17688846.5333; val_optim_loss: 17688846.5333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9246; val_auprc_score: 0.9099; val_best_acc_score: 0.8575; val_best_f1_score: 0.8662; train_kl_reg_loss: 106340.0708; train_edge_recon_loss: 2830079.9160; train_gene_expr_recon_loss: 12310649.8168; train_masked_gp_l1_reg_loss: 124119.7903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95189.4823; train_chrom_access_recon_loss: 2119714.5315; train_global_loss: 17586093.5344; train_optim_loss: 17586093.5344; val_kl_reg_loss: 109177.5531; val_edge_recon_loss: 2844319.1667; val_gene_expr_recon_loss: 12231207.5333; val_masked_gp_l1_reg_loss: 124302.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93790.0625; val_chrom_access_recon_loss: 2072968.8000; val_global_loss: 17475766.1333; val_optim_loss: 17475766.1333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9321; val_auprc_score: 0.9185; val_best_acc_score: 0.8716; val_best_f1_score: 0.8782; train_kl_reg_loss: 101957.2422; train_edge_recon_loss: 2800515.2748; train_gene_expr_recon_loss: 12163546.2748; train_masked_gp_l1_reg_loss: 125382.7338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91402.8064; train_chrom_access_recon_loss: 2098520.3836; train_global_loss: 17381324.7481; train_optim_loss: 17381324.7481; val_kl_reg_loss: 99710.4089; val_edge_recon_loss: 2817192.6833; val_gene_expr_recon_loss: 12101348.2667; val_masked_gp_l1_reg_loss: 126029.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88567.3047; val_chrom_access_recon_loss: 2059059.6000; val_global_loss: 17291908.1333; val_optim_loss: 17291908.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9381; val_auprc_score: 0.9260; val_best_acc_score: 0.8758; val_best_f1_score: 0.8800; train_kl_reg_loss: 100174.1529; train_edge_recon_loss: 2791555.4351; train_gene_expr_recon_loss: 12067972.8092; train_masked_gp_l1_reg_loss: 126090.0435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85605.1880; train_chrom_access_recon_loss: 2083126.4151; train_global_loss: 17254524.0763; train_optim_loss: 17254524.0763; val_kl_reg_loss: 96185.8219; val_edge_recon_loss: 2821923.9167; val_gene_expr_recon_loss: 11949606.6000; val_masked_gp_l1_reg_loss: 127173.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84450.1953; val_chrom_access_recon_loss: 2038378.0333; val_global_loss: 17117718.5333; val_optim_loss: 17117718.5333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9408; val_auprc_score: 0.9276; val_best_acc_score: 0.8777; val_best_f1_score: 0.8832; train_kl_reg_loss: 95946.2555; train_edge_recon_loss: 2784277.5019; train_gene_expr_recon_loss: 11996502.6260; train_masked_gp_l1_reg_loss: 126848.2601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81587.3841; train_chrom_access_recon_loss: 2070836.4571; train_global_loss: 17155998.4809; train_optim_loss: 17155998.4809; val_kl_reg_loss: 94046.5776; val_edge_recon_loss: 2796658.5000; val_gene_expr_recon_loss: 11927361.6667; val_masked_gp_l1_reg_loss: 127015.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80474.0078; val_chrom_access_recon_loss: 2036821.7250; val_global_loss: 17062378.6000; val_optim_loss: 17062378.6000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9372; val_auprc_score: 0.9221; val_best_acc_score: 0.8729; val_best_f1_score: 0.8799; train_kl_reg_loss: 92095.9417; train_edge_recon_loss: 2772501.4447; train_gene_expr_recon_loss: 11914387.0153; train_masked_gp_l1_reg_loss: 127166.3833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78353.5556; train_chrom_access_recon_loss: 2058894.4408; train_global_loss: 17043398.8092; train_optim_loss: 17043398.8092; val_kl_reg_loss: 91829.7578; val_edge_recon_loss: 2807088.3333; val_gene_expr_recon_loss: 11858331.2667; val_masked_gp_l1_reg_loss: 127789.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76881.7891; val_chrom_access_recon_loss: 2016184.8667; val_global_loss: 16978106.2000; val_optim_loss: 16978106.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9420; val_auprc_score: 0.9293; val_best_acc_score: 0.8795; val_best_f1_score: 0.8869; train_kl_reg_loss: 89715.6216; train_edge_recon_loss: 2757978.1469; train_gene_expr_recon_loss: 11847027.6489; train_masked_gp_l1_reg_loss: 127994.2222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75969.9134; train_chrom_access_recon_loss: 2046690.6927; train_global_loss: 16945376.2443; train_optim_loss: 16945376.2443; val_kl_reg_loss: 88225.2266; val_edge_recon_loss: 2783671.8500; val_gene_expr_recon_loss: 11827161.4667; val_masked_gp_l1_reg_loss: 128660.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75579.1562; val_chrom_access_recon_loss: 2018650.6833; val_global_loss: 16921948.0667; val_optim_loss: 16921948.0667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9469; val_auprc_score: 0.9341; val_best_acc_score: 0.8878; val_best_f1_score: 0.8919; train_kl_reg_loss: 89888.7380; train_edge_recon_loss: 2753147.1660; train_gene_expr_recon_loss: 11788115.9084; train_masked_gp_l1_reg_loss: 128923.7202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74693.7406; train_chrom_access_recon_loss: 2035686.8368; train_global_loss: 16870456.0840; train_optim_loss: 16870456.0840; val_kl_reg_loss: 91760.4161; val_edge_recon_loss: 2761620.9333; val_gene_expr_recon_loss: 11727434.0000; val_masked_gp_l1_reg_loss: 129511.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74713.0000; val_chrom_access_recon_loss: 2001874.6500; val_global_loss: 16786915.0667; val_optim_loss: 16786915.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9514; val_auprc_score: 0.9399; val_best_acc_score: 0.8918; val_best_f1_score: 0.8963; train_kl_reg_loss: 88537.2761; train_edge_recon_loss: 2744114.1221; train_gene_expr_recon_loss: 11726474.6641; train_masked_gp_l1_reg_loss: 129674.9923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74107.5922; train_chrom_access_recon_loss: 2024919.5754; train_global_loss: 16787828.2061; train_optim_loss: 16787828.2061; val_kl_reg_loss: 89039.6745; val_edge_recon_loss: 2747299.2667; val_gene_expr_recon_loss: 11671452.1333; val_masked_gp_l1_reg_loss: 130000.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74532.3594; val_chrom_access_recon_loss: 1988314.6083; val_global_loss: 16700637.8000; val_optim_loss: 16700637.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9527; val_auprc_score: 0.9440; val_best_acc_score: 0.8883; val_best_f1_score: 0.8943; train_kl_reg_loss: 88179.0643; train_edge_recon_loss: 2732303.6947; train_gene_expr_recon_loss: 11697245.0000; train_masked_gp_l1_reg_loss: 130080.8788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74787.6762; train_chrom_access_recon_loss: 2017655.1565; train_global_loss: 16740251.4885; train_optim_loss: 16740251.4885; val_kl_reg_loss: 87010.7276; val_edge_recon_loss: 2761101.9333; val_gene_expr_recon_loss: 11678063.2000; val_masked_gp_l1_reg_loss: 129789.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75758.8906; val_chrom_access_recon_loss: 1991296.7583; val_global_loss: 16723021.6000; val_optim_loss: 16723021.6000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9563; val_auprc_score: 0.9436; val_best_acc_score: 0.8952; val_best_f1_score: 0.8997; train_kl_reg_loss: 88477.3644; train_edge_recon_loss: 2726945.9141; train_gene_expr_recon_loss: 11653092.0229; train_masked_gp_l1_reg_loss: 130227.7355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76271.5110; train_chrom_access_recon_loss: 2012107.7052; train_global_loss: 16687122.3435; train_optim_loss: 16687122.3435; val_kl_reg_loss: 90499.5021; val_edge_recon_loss: 2741750.1000; val_gene_expr_recon_loss: 11616288.4667; val_masked_gp_l1_reg_loss: 130488.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77341.6953; val_chrom_access_recon_loss: 1975073.0083; val_global_loss: 16631440.9333; val_optim_loss: 16631440.9333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9593; val_auprc_score: 0.9488; val_best_acc_score: 0.9039; val_best_f1_score: 0.9081; train_kl_reg_loss: 88362.7049; train_edge_recon_loss: 2719201.7004; train_gene_expr_recon_loss: 11600314.9237; train_masked_gp_l1_reg_loss: 130414.5951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76871.5786; train_chrom_access_recon_loss: 2001568.7214; train_global_loss: 16616734.2595; train_optim_loss: 16616734.2595; val_kl_reg_loss: 86454.5135; val_edge_recon_loss: 2731744.0167; val_gene_expr_recon_loss: 11575007.2000; val_masked_gp_l1_reg_loss: 130020.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76186.0312; val_chrom_access_recon_loss: 1967191.8667; val_global_loss: 16566603.6000; val_optim_loss: 16566603.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9613; val_auprc_score: 0.9519; val_best_acc_score: 0.9029; val_best_f1_score: 0.9060; train_kl_reg_loss: 87675.4727; train_edge_recon_loss: 2715083.0782; train_gene_expr_recon_loss: 11565633.3969; train_masked_gp_l1_reg_loss: 130213.9989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76763.2210; train_chrom_access_recon_loss: 1996258.3760; train_global_loss: 16571627.5802; train_optim_loss: 16571627.5802; val_kl_reg_loss: 86396.5698; val_edge_recon_loss: 2727571.9000; val_gene_expr_recon_loss: 11481655.9333; val_masked_gp_l1_reg_loss: 130192.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76514.6016; val_chrom_access_recon_loss: 1952955.9500; val_global_loss: 16455287.3333; val_optim_loss: 16455287.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9600; val_auprc_score: 0.9488; val_best_acc_score: 0.9019; val_best_f1_score: 0.9052; train_kl_reg_loss: 86323.4037; train_edge_recon_loss: 2713459.3225; train_gene_expr_recon_loss: 11550531.1756; train_masked_gp_l1_reg_loss: 130055.6764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76626.7483; train_chrom_access_recon_loss: 1989481.5468; train_global_loss: 16546477.7863; train_optim_loss: 16546477.7863; val_kl_reg_loss: 85681.7630; val_edge_recon_loss: 2738222.4167; val_gene_expr_recon_loss: 11482361.9333; val_masked_gp_l1_reg_loss: 130321.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76232.3047; val_chrom_access_recon_loss: 1954641.2500; val_global_loss: 16467461.2667; val_optim_loss: 16467461.2667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9670; val_auprc_score: 0.9581; val_best_acc_score: 0.9167; val_best_f1_score: 0.9198; train_kl_reg_loss: 86496.6310; train_edge_recon_loss: 2710536.8302; train_gene_expr_recon_loss: 11506287.6412; train_masked_gp_l1_reg_loss: 129983.7171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76092.8447; train_chrom_access_recon_loss: 1981457.2786; train_global_loss: 16490854.9771; train_optim_loss: 16490854.9771; val_kl_reg_loss: 86577.1208; val_edge_recon_loss: 2720777.0333; val_gene_expr_recon_loss: 11470104.2000; val_masked_gp_l1_reg_loss: 129760.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75701.4609; val_chrom_access_recon_loss: 1954945.2500; val_global_loss: 16437865.6000; val_optim_loss: 16437865.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9649; val_auprc_score: 0.9552; val_best_acc_score: 0.9131; val_best_f1_score: 0.9163; train_kl_reg_loss: 84926.8212; train_edge_recon_loss: 2711438.4828; train_gene_expr_recon_loss: 11483001.4427; train_masked_gp_l1_reg_loss: 129579.5045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76328.5915; train_chrom_access_recon_loss: 1976781.8082; train_global_loss: 16462056.7023; train_optim_loss: 16462056.7023; val_kl_reg_loss: 84370.6182; val_edge_recon_loss: 2710800.8833; val_gene_expr_recon_loss: 11471874.6000; val_masked_gp_l1_reg_loss: 129811.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76200.8672; val_chrom_access_recon_loss: 1944812.4750; val_global_loss: 16417871.6000; val_optim_loss: 16417871.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9675; val_auprc_score: 0.9590; val_best_acc_score: 0.9140; val_best_f1_score: 0.9166; train_kl_reg_loss: 84964.2927; train_edge_recon_loss: 2703117.5706; train_gene_expr_recon_loss: 11445457.6107; train_masked_gp_l1_reg_loss: 129461.6330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76305.4312; train_chrom_access_recon_loss: 1971324.2462; train_global_loss: 16410630.7176; train_optim_loss: 16410630.7176; val_kl_reg_loss: 88005.5885; val_edge_recon_loss: 2721752.9167; val_gene_expr_recon_loss: 11454192.2667; val_masked_gp_l1_reg_loss: 128798.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75848.2031; val_chrom_access_recon_loss: 1944420.7000; val_global_loss: 16413017.4000; val_optim_loss: 16413017.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9677; val_auprc_score: 0.9585; val_best_acc_score: 0.9177; val_best_f1_score: 0.9212; train_kl_reg_loss: 83993.4466; train_edge_recon_loss: 2699241.3664; train_gene_expr_recon_loss: 11434512.4351; train_masked_gp_l1_reg_loss: 128883.4860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76250.2659; train_chrom_access_recon_loss: 1968267.9723; train_global_loss: 16391149.0000; train_optim_loss: 16391149.0000; val_kl_reg_loss: 85160.3016; val_edge_recon_loss: 2726145.3667; val_gene_expr_recon_loss: 11375398.4667; val_masked_gp_l1_reg_loss: 129242.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76371.3828; val_chrom_access_recon_loss: 1937187.9833; val_global_loss: 16329506.0667; val_optim_loss: 16329506.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9697; val_auprc_score: 0.9593; val_best_acc_score: 0.9179; val_best_f1_score: 0.9210; train_kl_reg_loss: 85011.0765; train_edge_recon_loss: 2694912.4924; train_gene_expr_recon_loss: 11409683.2977; train_masked_gp_l1_reg_loss: 128892.3717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76394.8396; train_chrom_access_recon_loss: 1962912.2987; train_global_loss: 16357806.3817; train_optim_loss: 16357806.3817; val_kl_reg_loss: 86305.8260; val_edge_recon_loss: 2706929.0167; val_gene_expr_recon_loss: 11361275.6000; val_masked_gp_l1_reg_loss: 128665.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76816.9844; val_chrom_access_recon_loss: 1922666.1917; val_global_loss: 16282659.6667; val_optim_loss: 16282659.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9722; val_auprc_score: 0.9630; val_best_acc_score: 0.9209; val_best_f1_score: 0.9241; train_kl_reg_loss: 84329.8078; train_edge_recon_loss: 2693234.8244; train_gene_expr_recon_loss: 11399492.2672; train_masked_gp_l1_reg_loss: 128102.2624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76473.1210; train_chrom_access_recon_loss: 1959621.6460; train_global_loss: 16341253.9389; train_optim_loss: 16341253.9389; val_kl_reg_loss: 84903.0188; val_edge_recon_loss: 2709243.7333; val_gene_expr_recon_loss: 11419396.2000; val_masked_gp_l1_reg_loss: 128162.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77092.8594; val_chrom_access_recon_loss: 1934428.3000; val_global_loss: 16353226.4000; val_optim_loss: 16353226.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9745; val_auprc_score: 0.9658; val_best_acc_score: 0.9250; val_best_f1_score: 0.9272; train_kl_reg_loss: 84426.8401; train_edge_recon_loss: 2695319.3798; train_gene_expr_recon_loss: 11375457.9160; train_masked_gp_l1_reg_loss: 127764.6930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76542.8355; train_chrom_access_recon_loss: 1954232.4332; train_global_loss: 16313744.0840; train_optim_loss: 16313744.0840; val_kl_reg_loss: 83749.2901; val_edge_recon_loss: 2688806.1000; val_gene_expr_recon_loss: 11418540.2000; val_masked_gp_l1_reg_loss: 127486.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76826.5234; val_chrom_access_recon_loss: 1940950.8833; val_global_loss: 16336359.5333; val_optim_loss: 16336359.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9731; val_auprc_score: 0.9647; val_best_acc_score: 0.9232; val_best_f1_score: 0.9256; train_kl_reg_loss: 83230.5324; train_edge_recon_loss: 2691517.8435; train_gene_expr_recon_loss: 11362649.2824; train_masked_gp_l1_reg_loss: 127100.9859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76712.6666; train_chrom_access_recon_loss: 1951265.0038; train_global_loss: 16292476.2824; train_optim_loss: 16292476.2824; val_kl_reg_loss: 84357.8906; val_edge_recon_loss: 2694502.4667; val_gene_expr_recon_loss: 11359437.3333; val_masked_gp_l1_reg_loss: 126639.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76602.5859; val_chrom_access_recon_loss: 1929570.9750; val_global_loss: 16271111.8000; val_optim_loss: 16271111.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9740; val_auprc_score: 0.9673; val_best_acc_score: 0.9245; val_best_f1_score: 0.9270; train_kl_reg_loss: 82035.3328; train_edge_recon_loss: 2696274.2061; train_gene_expr_recon_loss: 11345969.1374; train_masked_gp_l1_reg_loss: 126520.6693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76525.1954; train_chrom_access_recon_loss: 1946392.9513; train_global_loss: 16273717.4504; train_optim_loss: 16273717.4504; val_kl_reg_loss: 82734.9667; val_edge_recon_loss: 2703110.0333; val_gene_expr_recon_loss: 11306003.4000; val_masked_gp_l1_reg_loss: 126480.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76840.6406; val_chrom_access_recon_loss: 1920188.9083; val_global_loss: 16215358.5333; val_optim_loss: 16215358.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9763; val_auprc_score: 0.9710; val_best_acc_score: 0.9254; val_best_f1_score: 0.9271; train_kl_reg_loss: 82969.8392; train_edge_recon_loss: 2690296.2882; train_gene_expr_recon_loss: 11343306.7405; train_masked_gp_l1_reg_loss: 126191.7853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76915.7359; train_chrom_access_recon_loss: 1947487.6832; train_global_loss: 16267168.0305; train_optim_loss: 16267168.0305; val_kl_reg_loss: 82837.2651; val_edge_recon_loss: 2696497.5667; val_gene_expr_recon_loss: 11301276.5333; val_masked_gp_l1_reg_loss: 125874.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76796.2656; val_chrom_access_recon_loss: 1930116.8833; val_global_loss: 16213398.1333; val_optim_loss: 16213398.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9752; val_auprc_score: 0.9659; val_best_acc_score: 0.9318; val_best_f1_score: 0.9334; train_kl_reg_loss: 82392.2112; train_edge_recon_loss: 2688922.7653; train_gene_expr_recon_loss: 11320190.6794; train_masked_gp_l1_reg_loss: 125601.3901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76988.6216; train_chrom_access_recon_loss: 1942175.5906; train_global_loss: 16236271.2748; train_optim_loss: 16236271.2748; val_kl_reg_loss: 82721.3104; val_edge_recon_loss: 2687651.7167; val_gene_expr_recon_loss: 11285471.1333; val_masked_gp_l1_reg_loss: 125504.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77195.4609; val_chrom_access_recon_loss: 1916963.2500; val_global_loss: 16175507.5333; val_optim_loss: 16175507.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9738; val_auprc_score: 0.9637; val_best_acc_score: 0.9324; val_best_f1_score: 0.9347; train_kl_reg_loss: 81756.6543; train_edge_recon_loss: 2687058.1641; train_gene_expr_recon_loss: 11315277.6489; train_masked_gp_l1_reg_loss: 125055.7882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77143.4174; train_chrom_access_recon_loss: 1941959.4513; train_global_loss: 16228251.1985; train_optim_loss: 16228251.1985; val_kl_reg_loss: 82118.0125; val_edge_recon_loss: 2702136.5833; val_gene_expr_recon_loss: 11315042.4667; val_masked_gp_l1_reg_loss: 124617.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77449.2969; val_chrom_access_recon_loss: 1912556.7833; val_global_loss: 16213919.8000; val_optim_loss: 16213919.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9743; val_auprc_score: 0.9667; val_best_acc_score: 0.9309; val_best_f1_score: 0.9328; train_kl_reg_loss: 81553.3101; train_edge_recon_loss: 2683548.3588; train_gene_expr_recon_loss: 11305994.4809; train_masked_gp_l1_reg_loss: 124380.3692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77268.8353; train_chrom_access_recon_loss: 1937458.8349; train_global_loss: 16210204.1832; train_optim_loss: 16210204.1832; val_kl_reg_loss: 81045.2469; val_edge_recon_loss: 2696575.5333; val_gene_expr_recon_loss: 11293496.2000; val_masked_gp_l1_reg_loss: 124374.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77537.4844; val_chrom_access_recon_loss: 1924798.8167; val_global_loss: 16197826.8667; val_optim_loss: 16197826.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9744; val_auprc_score: 0.9667; val_best_acc_score: 0.9305; val_best_f1_score: 0.9324; train_kl_reg_loss: 81843.9108; train_edge_recon_loss: 2684767.4656; train_gene_expr_recon_loss: 11289426.0611; train_masked_gp_l1_reg_loss: 123953.9437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77375.1455; train_chrom_access_recon_loss: 1934654.1842; train_global_loss: 16192020.7099; train_optim_loss: 16192020.7099; val_kl_reg_loss: 81559.2896; val_edge_recon_loss: 2689556.0167; val_gene_expr_recon_loss: 11268686.1333; val_masked_gp_l1_reg_loss: 123997.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78175.8984; val_chrom_access_recon_loss: 1911030.3000; val_global_loss: 16153005.8000; val_optim_loss: 16153005.8000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9759; val_auprc_score: 0.9679; val_best_acc_score: 0.9334; val_best_f1_score: 0.9353; train_kl_reg_loss: 80807.9381; train_edge_recon_loss: 2683104.9237; train_gene_expr_recon_loss: 11275827.1069; train_masked_gp_l1_reg_loss: 123508.1607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77647.7196; train_chrom_access_recon_loss: 1931769.7586; train_global_loss: 16172665.6107; train_optim_loss: 16172665.6107; val_kl_reg_loss: 83115.4318; val_edge_recon_loss: 2693115.4833; val_gene_expr_recon_loss: 11237836.2000; val_masked_gp_l1_reg_loss: 123568.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78141.3047; val_chrom_access_recon_loss: 1903789.4417; val_global_loss: 16119566.6000; val_optim_loss: 16119566.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9789; val_auprc_score: 0.9737; val_best_acc_score: 0.9376; val_best_f1_score: 0.9393; train_kl_reg_loss: 81630.1471; train_edge_recon_loss: 2681610.8721; train_gene_expr_recon_loss: 11267954.6947; train_masked_gp_l1_reg_loss: 122901.2937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77820.8993; train_chrom_access_recon_loss: 1930291.6927; train_global_loss: 16162209.5878; train_optim_loss: 16162209.5878; val_kl_reg_loss: 82958.9198; val_edge_recon_loss: 2686402.8500; val_gene_expr_recon_loss: 11215401.8667; val_masked_gp_l1_reg_loss: 122678.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77899.9062; val_chrom_access_recon_loss: 1904315.2500; val_global_loss: 16089657.9333; val_optim_loss: 16089657.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9777; val_auprc_score: 0.9700; val_best_acc_score: 0.9352; val_best_f1_score: 0.9369; train_kl_reg_loss: 80918.1924; train_edge_recon_loss: 2683807.9714; train_gene_expr_recon_loss: 11263877.1832; train_masked_gp_l1_reg_loss: 122230.5544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77666.7456; train_chrom_access_recon_loss: 1927722.1279; train_global_loss: 16156222.7786; train_optim_loss: 16156222.7786; val_kl_reg_loss: 80146.2167; val_edge_recon_loss: 2690918.8333; val_gene_expr_recon_loss: 11233084.2667; val_masked_gp_l1_reg_loss: 122500.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78228.7031; val_chrom_access_recon_loss: 1895003.8917; val_global_loss: 16099882.2000; val_optim_loss: 16099882.2000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9776; val_auprc_score: 0.9694; val_best_acc_score: 0.9352; val_best_f1_score: 0.9371; train_kl_reg_loss: 80365.2334; train_edge_recon_loss: 2674753.1145; train_gene_expr_recon_loss: 11253639.4656; train_masked_gp_l1_reg_loss: 121834.1654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78261.3939; train_chrom_access_recon_loss: 1926326.3893; train_global_loss: 16135179.7252; train_optim_loss: 16135179.7252; val_kl_reg_loss: 82955.3484; val_edge_recon_loss: 2679117.4000; val_gene_expr_recon_loss: 11290955.1333; val_masked_gp_l1_reg_loss: 121512.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78717.4531; val_chrom_access_recon_loss: 1918868.6667; val_global_loss: 16172126.4667; val_optim_loss: 16172126.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9770; val_auprc_score: 0.9707; val_best_acc_score: 0.9347; val_best_f1_score: 0.9372; train_kl_reg_loss: 79256.3265; train_edge_recon_loss: 2680711.8664; train_gene_expr_recon_loss: 11246184.5267; train_masked_gp_l1_reg_loss: 121314.6877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78549.4554; train_chrom_access_recon_loss: 1924118.1622; train_global_loss: 16130135.0611; train_optim_loss: 16130135.0611; val_kl_reg_loss: 82298.3391; val_edge_recon_loss: 2700552.1000; val_gene_expr_recon_loss: 11248307.0000; val_masked_gp_l1_reg_loss: 121075.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79365.8906; val_chrom_access_recon_loss: 1895725.6833; val_global_loss: 16127325.0667; val_optim_loss: 16127325.0667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9796; val_auprc_score: 0.9732; val_best_acc_score: 0.9403; val_best_f1_score: 0.9415; train_kl_reg_loss: 80248.3406; train_edge_recon_loss: 2676892.4370; train_gene_expr_recon_loss: 11247210.7557; train_masked_gp_l1_reg_loss: 120716.8908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79043.6676; train_chrom_access_recon_loss: 1923659.3874; train_global_loss: 16127771.5191; train_optim_loss: 16127771.5191; val_kl_reg_loss: 81073.1859; val_edge_recon_loss: 2692922.8667; val_gene_expr_recon_loss: 11228653.2667; val_masked_gp_l1_reg_loss: 120510.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78696.1953; val_chrom_access_recon_loss: 1902066.3417; val_global_loss: 16103922.6667; val_optim_loss: 16103922.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9799; val_auprc_score: 0.9737; val_best_acc_score: 0.9419; val_best_f1_score: 0.9437; train_kl_reg_loss: 81535.0944; train_edge_recon_loss: 2670852.3836; train_gene_expr_recon_loss: 11217813.4198; train_masked_gp_l1_reg_loss: 114345.9022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60569.3250; train_chrom_access_recon_loss: 1916025.4036; train_global_loss: 16061141.5038; train_optim_loss: 16061141.5038; val_kl_reg_loss: 82978.9370; val_edge_recon_loss: 2682026.1333; val_gene_expr_recon_loss: 11260402.1333; val_masked_gp_l1_reg_loss: 113035.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58059.6367; val_chrom_access_recon_loss: 1896045.2667; val_global_loss: 16092548.6000; val_optim_loss: 16092548.6000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9796; val_auprc_score: 0.9724; val_best_acc_score: 0.9406; val_best_f1_score: 0.9422; train_kl_reg_loss: 82928.5582; train_edge_recon_loss: 2675496.1527; train_gene_expr_recon_loss: 11225377.2214; train_masked_gp_l1_reg_loss: 112839.0131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57582.3001; train_chrom_access_recon_loss: 1917671.9218; train_global_loss: 16071895.1908; train_optim_loss: 16071895.1908; val_kl_reg_loss: 84576.3349; val_edge_recon_loss: 2677685.4333; val_gene_expr_recon_loss: 11243959.0667; val_masked_gp_l1_reg_loss: 112728.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57265.2266; val_chrom_access_recon_loss: 1894819.9583; val_global_loss: 16071033.8667; val_optim_loss: 16071033.8667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9822; val_auprc_score: 0.9749; val_best_acc_score: 0.9417; val_best_f1_score: 0.9427; train_kl_reg_loss: 83466.6868; train_edge_recon_loss: 2672423.2099; train_gene_expr_recon_loss: 11224212.2061; train_masked_gp_l1_reg_loss: 112617.0861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57008.5672; train_chrom_access_recon_loss: 1917447.2786; train_global_loss: 16067175.0458; train_optim_loss: 16067175.0458; val_kl_reg_loss: 84124.8990; val_edge_recon_loss: 2692374.1167; val_gene_expr_recon_loss: 11211571.5333; val_masked_gp_l1_reg_loss: 112616.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56888.2227; val_chrom_access_recon_loss: 1896643.0833; val_global_loss: 16054217.7333; val_optim_loss: 16054217.7333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9813; val_auprc_score: 0.9763; val_best_acc_score: 0.9418; val_best_f1_score: 0.9432; train_kl_reg_loss: 83651.4903; train_edge_recon_loss: 2679003.6679; train_gene_expr_recon_loss: 11228517.1069; train_masked_gp_l1_reg_loss: 112520.9059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56684.9601; train_chrom_access_recon_loss: 1917057.9122; train_global_loss: 16077436.0382; train_optim_loss: 16077436.0382; val_kl_reg_loss: 84444.7667; val_edge_recon_loss: 2704801.9333; val_gene_expr_recon_loss: 11224394.6667; val_masked_gp_l1_reg_loss: 112507.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56489.0234; val_chrom_access_recon_loss: 1898265.5083; val_global_loss: 16080903.6667; val_optim_loss: 16080903.6667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9793; val_auprc_score: 0.9733; val_best_acc_score: 0.9411; val_best_f1_score: 0.9424; train_kl_reg_loss: 82932.0117; train_edge_recon_loss: 2670812.4275; train_gene_expr_recon_loss: 11219882.8779; train_masked_gp_l1_reg_loss: 112461.4843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56342.7960; train_chrom_access_recon_loss: 1915438.1746; train_global_loss: 16057869.7176; train_optim_loss: 16057869.7176; val_kl_reg_loss: 83721.0016; val_edge_recon_loss: 2684431.6167; val_gene_expr_recon_loss: 11234399.4000; val_masked_gp_l1_reg_loss: 112386.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56159.4219; val_chrom_access_recon_loss: 1894735.1000; val_global_loss: 16065832.0667; val_optim_loss: 16065832.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9805; val_auprc_score: 0.9731; val_best_acc_score: 0.9400; val_best_f1_score: 0.9412; train_kl_reg_loss: 84302.2171; train_edge_recon_loss: 2666955.9256; train_gene_expr_recon_loss: 11220242.2214; train_masked_gp_l1_reg_loss: 112336.2631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56045.9159; train_chrom_access_recon_loss: 1914274.2328; train_global_loss: 16054156.7710; train_optim_loss: 16054156.7710; val_kl_reg_loss: 84710.7245; val_edge_recon_loss: 2684615.7500; val_gene_expr_recon_loss: 11193461.0000; val_masked_gp_l1_reg_loss: 112264.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55752.4805; val_chrom_access_recon_loss: 1886118.8417; val_global_loss: 16016923.4000; val_optim_loss: 16016923.4000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9824; val_auprc_score: 0.9756; val_best_acc_score: 0.9469; val_best_f1_score: 0.9476; train_kl_reg_loss: 83894.6379; train_edge_recon_loss: 2669607.3473; train_gene_expr_recon_loss: 11216092.7710; train_masked_gp_l1_reg_loss: 112235.6197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55691.5752; train_chrom_access_recon_loss: 1914884.2414; train_global_loss: 16052406.2519; train_optim_loss: 16052406.2519; val_kl_reg_loss: 84553.3427; val_edge_recon_loss: 2680275.7167; val_gene_expr_recon_loss: 11266487.4667; val_masked_gp_l1_reg_loss: 112216.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55580.2383; val_chrom_access_recon_loss: 1906122.0333; val_global_loss: 16105234.7333; val_optim_loss: 16105234.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9793; val_auprc_score: 0.9706; val_best_acc_score: 0.9421; val_best_f1_score: 0.9437; train_kl_reg_loss: 84152.6005; train_edge_recon_loss: 2669671.1737; train_gene_expr_recon_loss: 11226420.0382; train_masked_gp_l1_reg_loss: 112140.3602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55460.9308; train_chrom_access_recon_loss: 1914872.4475; train_global_loss: 16062717.5573; train_optim_loss: 16062717.5573; val_kl_reg_loss: 85043.1115; val_edge_recon_loss: 2678452.1000; val_gene_expr_recon_loss: 11272311.3333; val_masked_gp_l1_reg_loss: 112066.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55257.2969; val_chrom_access_recon_loss: 1903760.6333; val_global_loss: 16106891.2000; val_optim_loss: 16106891.2000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9813; val_auprc_score: 0.9750; val_best_acc_score: 0.9435; val_best_f1_score: 0.9447; train_kl_reg_loss: 83891.4631; train_edge_recon_loss: 2672052.6088; train_gene_expr_recon_loss: 11213442.6870; train_masked_gp_l1_reg_loss: 112067.7832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55202.9651; train_chrom_access_recon_loss: 1914057.9447; train_global_loss: 16050715.5191; train_optim_loss: 16050715.5191; val_kl_reg_loss: 84581.6328; val_edge_recon_loss: 2671970.1333; val_gene_expr_recon_loss: 11226777.3333; val_masked_gp_l1_reg_loss: 112014.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55042.7773; val_chrom_access_recon_loss: 1897339.7000; val_global_loss: 16047725.7333; val_optim_loss: 16047725.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9832; val_auprc_score: 0.9775; val_best_acc_score: 0.9456; val_best_f1_score: 0.9474; train_kl_reg_loss: 83504.8018; train_edge_recon_loss: 2668815.0324; train_gene_expr_recon_loss: 11209524.4122; train_masked_gp_l1_reg_loss: 111967.8090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54900.8613; train_chrom_access_recon_loss: 1913072.2061; train_global_loss: 16041785.1908; train_optim_loss: 16041785.1908; val_kl_reg_loss: 83876.5219; val_edge_recon_loss: 2678689.1500; val_gene_expr_recon_loss: 11250633.4000; val_masked_gp_l1_reg_loss: 111913.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54976.2188; val_chrom_access_recon_loss: 1897964.9000; val_global_loss: 16078052.8667; val_optim_loss: 16078052.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9784; val_auprc_score: 0.9705; val_best_acc_score: 0.9387; val_best_f1_score: 0.9397; train_kl_reg_loss: 83136.1140; train_edge_recon_loss: 2674117.3244; train_gene_expr_recon_loss: 11206356.2595; train_masked_gp_l1_reg_loss: 111252.1326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53113.9782; train_chrom_access_recon_loss: 1912954.8569; train_global_loss: 16040930.7328; train_optim_loss: 16040930.7328; val_kl_reg_loss: 84583.1172; val_edge_recon_loss: 2703073.4333; val_gene_expr_recon_loss: 11227296.8000; val_masked_gp_l1_reg_loss: 111069.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52836.0078; val_chrom_access_recon_loss: 1886016.8083; val_global_loss: 16064875.0667; val_optim_loss: 16064875.0667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9798; val_auprc_score: 0.9720; val_best_acc_score: 0.9417; val_best_f1_score: 0.9434; train_kl_reg_loss: 83409.9356; train_edge_recon_loss: 2669201.9370; train_gene_expr_recon_loss: 11213798.9160; train_masked_gp_l1_reg_loss: 111030.9785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52752.4169; train_chrom_access_recon_loss: 1914854.7586; train_global_loss: 16045048.9542; train_optim_loss: 16045048.9542; val_kl_reg_loss: 84138.0583; val_edge_recon_loss: 2691608.2833; val_gene_expr_recon_loss: 11183824.0000; val_masked_gp_l1_reg_loss: 111000.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52679.6875; val_chrom_access_recon_loss: 1885727.4667; val_global_loss: 16008977.9333; val_optim_loss: 16008977.9333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9812; val_auprc_score: 0.9733; val_best_acc_score: 0.9411; val_best_f1_score: 0.9417; train_kl_reg_loss: 83741.5995; train_edge_recon_loss: 2670134.2672; train_gene_expr_recon_loss: 11216338.4351; train_masked_gp_l1_reg_loss: 110983.1893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52625.2887; train_chrom_access_recon_loss: 1913400.1660; train_global_loss: 16047223.0229; train_optim_loss: 16047223.0229; val_kl_reg_loss: 84769.0479; val_edge_recon_loss: 2687836.6167; val_gene_expr_recon_loss: 11205252.2667; val_masked_gp_l1_reg_loss: 110966.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52572.6172; val_chrom_access_recon_loss: 1891787.4333; val_global_loss: 16033184.3333; val_optim_loss: 16033184.3333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9801; val_auprc_score: 0.9740; val_best_acc_score: 0.9418; val_best_f1_score: 0.9430; train_kl_reg_loss: 83800.2867; train_edge_recon_loss: 2669643.0038; train_gene_expr_recon_loss: 11213136.5038; train_masked_gp_l1_reg_loss: 110957.4104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52533.2603; train_chrom_access_recon_loss: 1913331.2643; train_global_loss: 16043401.6336; train_optim_loss: 16043401.6336; val_kl_reg_loss: 85053.3391; val_edge_recon_loss: 2689642.2167; val_gene_expr_recon_loss: 11200437.4000; val_masked_gp_l1_reg_loss: 110948.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52490.0586; val_chrom_access_recon_loss: 1892101.9167; val_global_loss: 16030672.9333; val_optim_loss: 16030672.9333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9833; val_auprc_score: 0.9772; val_best_acc_score: 0.9464; val_best_f1_score: 0.9479; train_kl_reg_loss: 83816.0267; train_edge_recon_loss: 2671591.4351; train_gene_expr_recon_loss: 11205771.6947; train_masked_gp_l1_reg_loss: 110941.0593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52461.0850; train_chrom_access_recon_loss: 1912053.5448; train_global_loss: 16036634.8015; train_optim_loss: 16036634.8015; val_kl_reg_loss: 85309.2599; val_edge_recon_loss: 2673742.4667; val_gene_expr_recon_loss: 11271797.3333; val_masked_gp_l1_reg_loss: 110931.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52424.2188; val_chrom_access_recon_loss: 1906784.0667; val_global_loss: 16100989.2000; val_optim_loss: 16100989.2000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9821; val_auprc_score: 0.9775; val_best_acc_score: 0.9409; val_best_f1_score: 0.9426; train_kl_reg_loss: 83802.1424; train_edge_recon_loss: 2667976.2309; train_gene_expr_recon_loss: 11211441.6718; train_masked_gp_l1_reg_loss: 110924.1769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52399.0232; train_chrom_access_recon_loss: 1913419.2204; train_global_loss: 16039962.4504; train_optim_loss: 16039962.4504; val_kl_reg_loss: 84592.5813; val_edge_recon_loss: 2698872.4500; val_gene_expr_recon_loss: 11193727.2000; val_masked_gp_l1_reg_loss: 110921.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52372.5117; val_chrom_access_recon_loss: 1888513.1250; val_global_loss: 16029000.4000; val_optim_loss: 16029000.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9818; val_auprc_score: 0.9756; val_best_acc_score: 0.9426; val_best_f1_score: 0.9443; train_kl_reg_loss: 83849.0513; train_edge_recon_loss: 2677933.2233; train_gene_expr_recon_loss: 11200721.9160; train_masked_gp_l1_reg_loss: 110853.1234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52192.7747; train_chrom_access_recon_loss: 1911668.2366; train_global_loss: 16037218.2672; train_optim_loss: 16037218.2672; val_kl_reg_loss: 84664.6411; val_edge_recon_loss: 2684599.6667; val_gene_expr_recon_loss: 11244089.4667; val_masked_gp_l1_reg_loss: 110832.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52167.4648; val_chrom_access_recon_loss: 1902663.2583; val_global_loss: 16079016.2667; val_optim_loss: 16079016.2667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9825; val_auprc_score: 0.9750; val_best_acc_score: 0.9446; val_best_f1_score: 0.9462; train_kl_reg_loss: 83874.5799; train_edge_recon_loss: 2670886.1183; train_gene_expr_recon_loss: 11200050.6183; train_masked_gp_l1_reg_loss: 110826.6996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52161.1487; train_chrom_access_recon_loss: 1911577.8740; train_global_loss: 16029377.1069; train_optim_loss: 16029377.1069; val_kl_reg_loss: 84761.8557; val_edge_recon_loss: 2688309.8000; val_gene_expr_recon_loss: 11206215.4000; val_masked_gp_l1_reg_loss: 110822.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52155.8359; val_chrom_access_recon_loss: 1891374.4000; val_global_loss: 16033640.6000; val_optim_loss: 16033640.6000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9828; val_auprc_score: 0.9771; val_best_acc_score: 0.9429; val_best_f1_score: 0.9445; train_kl_reg_loss: 83960.6174; train_edge_recon_loss: 2667852.1107; train_gene_expr_recon_loss: 11206955.1069; train_masked_gp_l1_reg_loss: 110820.2550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52150.9443; train_chrom_access_recon_loss: 1913780.3712; train_global_loss: 16035519.5038; train_optim_loss: 16035519.5038; val_kl_reg_loss: 85290.6922; val_edge_recon_loss: 2680610.5000; val_gene_expr_recon_loss: 11191085.2000; val_masked_gp_l1_reg_loss: 110817.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52146.5273; val_chrom_access_recon_loss: 1889611.1250; val_global_loss: 16009562.6000; val_optim_loss: 16009562.6000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9832; val_auprc_score: 0.9776; val_best_acc_score: 0.9430; val_best_f1_score: 0.9443; train_kl_reg_loss: 83911.5864; train_edge_recon_loss: 2667354.3798; train_gene_expr_recon_loss: 11209574.9466; train_masked_gp_l1_reg_loss: 110815.9747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52143.1059; train_chrom_access_recon_loss: 1914243.8874; train_global_loss: 16038043.8321; train_optim_loss: 16038043.8321; val_kl_reg_loss: 84844.1854; val_edge_recon_loss: 2676254.2000; val_gene_expr_recon_loss: 11228910.0000; val_masked_gp_l1_reg_loss: 110814.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52139.7852; val_chrom_access_recon_loss: 1905608.9833; val_global_loss: 16058572.5333; val_optim_loss: 16058572.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 58 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9822
val AUPRC score: 0.9738
val best accuracy score: 0.9446
val best F1 score: 0.9461
val target rna MSE score: 1.2079
val source rna MSE score: 0.3993
val target atac MSE score: 0.3318
val source atac MSE score: 0.0976
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
