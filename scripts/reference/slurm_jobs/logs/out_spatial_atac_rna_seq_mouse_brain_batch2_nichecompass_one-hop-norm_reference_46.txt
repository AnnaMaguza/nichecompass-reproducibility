[True]
Run timestamp: 07092023_161330_46.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_46']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6397; val_auprc_score: 0.6259; val_best_acc_score: 0.5013; val_best_f1_score: 0.6671; train_kl_reg_loss: 59366.3868; train_edge_recon_loss: 3560029.1591; train_gene_expr_recon_loss: 16833553.2879; train_masked_gp_l1_reg_loss: 173454.8946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9781523.3636; train_chrom_access_recon_loss: 6316674.6894; train_global_loss: 36724601.3030; train_optim_loss: 36724601.3030; val_kl_reg_loss: 63770.5562; val_edge_recon_loss: 4065327.5938; val_gene_expr_recon_loss: 15480987.2500; val_masked_gp_l1_reg_loss: 157709.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3318745.0000; val_chrom_access_recon_loss: 6067782.0000; val_global_loss: 29154322.0000; val_optim_loss: 29154322.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6600; val_auprc_score: 0.6373; val_best_acc_score: 0.5371; val_best_f1_score: 0.6781; train_kl_reg_loss: 117037.5292; train_edge_recon_loss: 3554357.8523; train_gene_expr_recon_loss: 14994254.4394; train_masked_gp_l1_reg_loss: 153561.0360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1152504.9399; train_chrom_access_recon_loss: 6006583.0000; train_global_loss: 25978298.9394; train_optim_loss: 25978298.9394; val_kl_reg_loss: 141545.5840; val_edge_recon_loss: 4062887.7812; val_gene_expr_recon_loss: 14742766.6250; val_masked_gp_l1_reg_loss: 147564.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 339163.8125; val_chrom_access_recon_loss: 5897194.6875; val_global_loss: 25331122.5000; val_optim_loss: 25331122.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7209; val_auprc_score: 0.6928; val_best_acc_score: 0.5997; val_best_f1_score: 0.7059; train_kl_reg_loss: 125273.7389; train_edge_recon_loss: 3540580.0871; train_gene_expr_recon_loss: 14638536.3182; train_masked_gp_l1_reg_loss: 146726.5062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 249075.9749; train_chrom_access_recon_loss: 5929052.3864; train_global_loss: 24629245.1515; train_optim_loss: 24629245.1515; val_kl_reg_loss: 134887.2061; val_edge_recon_loss: 4059758.6250; val_gene_expr_recon_loss: 14782141.3750; val_masked_gp_l1_reg_loss: 146953.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 201861.5156; val_chrom_access_recon_loss: 5945834.7500; val_global_loss: 25271438.2500; val_optim_loss: 25271438.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7541; val_auprc_score: 0.7350; val_best_acc_score: 0.6881; val_best_f1_score: 0.6992; train_kl_reg_loss: 116393.9889; train_edge_recon_loss: 3532492.7159; train_gene_expr_recon_loss: 14528666.3030; train_masked_gp_l1_reg_loss: 147429.5194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181843.8269; train_chrom_access_recon_loss: 5897027.7955; train_global_loss: 24403854.3333; train_optim_loss: 24403854.3333; val_kl_reg_loss: 119566.6895; val_edge_recon_loss: 4029365.5938; val_gene_expr_recon_loss: 14504151.3750; val_masked_gp_l1_reg_loss: 148458.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167602.5469; val_chrom_access_recon_loss: 5887187.1250; val_global_loss: 24856331.0000; val_optim_loss: 24856331.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7966; val_auprc_score: 0.7771; val_best_acc_score: 0.7190; val_best_f1_score: 0.7483; train_kl_reg_loss: 106111.1895; train_edge_recon_loss: 3505168.9015; train_gene_expr_recon_loss: 14440045.9545; train_masked_gp_l1_reg_loss: 149433.2940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159582.4134; train_chrom_access_recon_loss: 5862140.3485; train_global_loss: 24222482.0000; train_optim_loss: 24222482.0000; val_kl_reg_loss: 101518.3945; val_edge_recon_loss: 3800287.1875; val_gene_expr_recon_loss: 14662482.0000; val_masked_gp_l1_reg_loss: 150950.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153001.6406; val_chrom_access_recon_loss: 5955042.8750; val_global_loss: 24823281.7500; val_optim_loss: 24823281.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7907; val_auprc_score: 0.7792; val_best_acc_score: 0.7077; val_best_f1_score: 0.7400; train_kl_reg_loss: 102897.3453; train_edge_recon_loss: 3329643.8144; train_gene_expr_recon_loss: 14370326.5909; train_masked_gp_l1_reg_loss: 154496.9519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148095.6338; train_chrom_access_recon_loss: 5830793.8182; train_global_loss: 23936254.1515; train_optim_loss: 23936254.1515; val_kl_reg_loss: 114105.5723; val_edge_recon_loss: 3294851.8125; val_gene_expr_recon_loss: 14463588.3750; val_masked_gp_l1_reg_loss: 158692.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145101.4844; val_chrom_access_recon_loss: 5886473.8125; val_global_loss: 24062814.0000; val_optim_loss: 24062814.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8356; val_auprc_score: 0.8098; val_best_acc_score: 0.7442; val_best_f1_score: 0.7747; train_kl_reg_loss: 121516.6043; train_edge_recon_loss: 3122355.6591; train_gene_expr_recon_loss: 14307520.8939; train_masked_gp_l1_reg_loss: 162077.2045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141852.7867; train_chrom_access_recon_loss: 5801969.1439; train_global_loss: 23657292.5758; train_optim_loss: 23657292.5758; val_kl_reg_loss: 125910.7549; val_edge_recon_loss: 3048050.7500; val_gene_expr_recon_loss: 14437551.7500; val_masked_gp_l1_reg_loss: 164892.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138727.8281; val_chrom_access_recon_loss: 5833741.2500; val_global_loss: 23748874.2500; val_optim_loss: 23748874.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8553; val_auprc_score: 0.8200; val_best_acc_score: 0.7751; val_best_f1_score: 0.8014; train_kl_reg_loss: 133798.1958; train_edge_recon_loss: 3016077.2917; train_gene_expr_recon_loss: 14238062.0606; train_masked_gp_l1_reg_loss: 166981.9380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136194.7377; train_chrom_access_recon_loss: 5773047.5682; train_global_loss: 23464161.8788; train_optim_loss: 23464161.8788; val_kl_reg_loss: 134375.6113; val_edge_recon_loss: 2950430.9688; val_gene_expr_recon_loss: 14263097.0000; val_masked_gp_l1_reg_loss: 169240.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134526.5312; val_chrom_access_recon_loss: 5754343.7500; val_global_loss: 23406012.7500; val_optim_loss: 23406012.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8671; val_auprc_score: 0.8344; val_best_acc_score: 0.7902; val_best_f1_score: 0.8118; train_kl_reg_loss: 134907.7902; train_edge_recon_loss: 2949594.6402; train_gene_expr_recon_loss: 14176265.7424; train_masked_gp_l1_reg_loss: 170322.3930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132553.7929; train_chrom_access_recon_loss: 5748640.4242; train_global_loss: 23312284.7879; train_optim_loss: 23312284.7879; val_kl_reg_loss: 131492.7402; val_edge_recon_loss: 2909160.8750; val_gene_expr_recon_loss: 14251763.5000; val_masked_gp_l1_reg_loss: 171275.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130299.2891; val_chrom_access_recon_loss: 5776114.7500; val_global_loss: 23370107.5000; val_optim_loss: 23370107.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8642; val_auprc_score: 0.8228; val_best_acc_score: 0.7939; val_best_f1_score: 0.8148; train_kl_reg_loss: 132701.3844; train_edge_recon_loss: 2921162.2348; train_gene_expr_recon_loss: 14134392.7121; train_masked_gp_l1_reg_loss: 172441.5687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128863.9111; train_chrom_access_recon_loss: 5728505.9697; train_global_loss: 23218067.8182; train_optim_loss: 23218067.8182; val_kl_reg_loss: 124903.0732; val_edge_recon_loss: 2925841.6875; val_gene_expr_recon_loss: 14136233.6250; val_masked_gp_l1_reg_loss: 173925.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127507.5312; val_chrom_access_recon_loss: 5733429.0625; val_global_loss: 23221841.2500; val_optim_loss: 23221841.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8692; val_auprc_score: 0.8291; val_best_acc_score: 0.7966; val_best_f1_score: 0.8167; train_kl_reg_loss: 134166.0567; train_edge_recon_loss: 2894805.7311; train_gene_expr_recon_loss: 14073446.5000; train_masked_gp_l1_reg_loss: 175055.5388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126249.7242; train_chrom_access_recon_loss: 5706987.4167; train_global_loss: 23110711.2424; train_optim_loss: 23110711.2424; val_kl_reg_loss: 130455.9404; val_edge_recon_loss: 2912272.9062; val_gene_expr_recon_loss: 14127898.3750; val_masked_gp_l1_reg_loss: 176047.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125731.8438; val_chrom_access_recon_loss: 5753777.9375; val_global_loss: 23226185.5000; val_optim_loss: 23226185.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8825; val_auprc_score: 0.8459; val_best_acc_score: 0.8152; val_best_f1_score: 0.8285; train_kl_reg_loss: 131718.5160; train_edge_recon_loss: 2891096.6629; train_gene_expr_recon_loss: 14021529.6667; train_masked_gp_l1_reg_loss: 176830.8719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124786.4019; train_chrom_access_recon_loss: 5681976.5379; train_global_loss: 23027938.9091; train_optim_loss: 23027938.9091; val_kl_reg_loss: 135224.9814; val_edge_recon_loss: 2912713.7812; val_gene_expr_recon_loss: 14147822.7500; val_masked_gp_l1_reg_loss: 177964.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123804.2188; val_chrom_access_recon_loss: 5718195.8125; val_global_loss: 23215725.5000; val_optim_loss: 23215725.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8838; val_auprc_score: 0.8478; val_best_acc_score: 0.8227; val_best_f1_score: 0.8363; train_kl_reg_loss: 131522.0599; train_edge_recon_loss: 2871150.9356; train_gene_expr_recon_loss: 13967821.6364; train_masked_gp_l1_reg_loss: 179008.5601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123706.6494; train_chrom_access_recon_loss: 5660831.8182; train_global_loss: 22934041.7576; train_optim_loss: 22934041.7576; val_kl_reg_loss: 130506.9062; val_edge_recon_loss: 2891796.6250; val_gene_expr_recon_loss: 14056283.8750; val_masked_gp_l1_reg_loss: 180110.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123575.3516; val_chrom_access_recon_loss: 5661961.0625; val_global_loss: 23044234.0000; val_optim_loss: 23044234.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8976; val_auprc_score: 0.8555; val_best_acc_score: 0.8388; val_best_f1_score: 0.8491; train_kl_reg_loss: 133721.5050; train_edge_recon_loss: 2852976.9280; train_gene_expr_recon_loss: 13932879.4242; train_masked_gp_l1_reg_loss: 180735.0500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122707.4569; train_chrom_access_recon_loss: 5647631.5152; train_global_loss: 22870651.9091; train_optim_loss: 22870651.9091; val_kl_reg_loss: 129065.9727; val_edge_recon_loss: 2857735.6250; val_gene_expr_recon_loss: 13964976.7500; val_masked_gp_l1_reg_loss: 181706.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122076.4297; val_chrom_access_recon_loss: 5615827.3750; val_global_loss: 22871388.0000; val_optim_loss: 22871388.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9033; val_auprc_score: 0.8696; val_best_acc_score: 0.8436; val_best_f1_score: 0.8544; train_kl_reg_loss: 131312.2911; train_edge_recon_loss: 2843122.0114; train_gene_expr_recon_loss: 13896850.2273; train_masked_gp_l1_reg_loss: 182177.8113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122360.1014; train_chrom_access_recon_loss: 5625066.5379; train_global_loss: 22800888.9697; train_optim_loss: 22800888.9697; val_kl_reg_loss: 130440.9922; val_edge_recon_loss: 2859724.8438; val_gene_expr_recon_loss: 14058252.5000; val_masked_gp_l1_reg_loss: 182770.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122110.9375; val_chrom_access_recon_loss: 5658526.4375; val_global_loss: 23011825.0000; val_optim_loss: 23011825.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9031; val_auprc_score: 0.8715; val_best_acc_score: 0.8434; val_best_f1_score: 0.8568; train_kl_reg_loss: 134339.4804; train_edge_recon_loss: 2830233.0909; train_gene_expr_recon_loss: 13849257.9091; train_masked_gp_l1_reg_loss: 183343.9638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121992.9362; train_chrom_access_recon_loss: 5606063.3712; train_global_loss: 22725230.6364; train_optim_loss: 22725230.6364; val_kl_reg_loss: 131140.2246; val_edge_recon_loss: 2887941.5000; val_gene_expr_recon_loss: 13905949.1250; val_masked_gp_l1_reg_loss: 183919.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122353.0781; val_chrom_access_recon_loss: 5589038.8750; val_global_loss: 22820343.7500; val_optim_loss: 22820343.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9150; val_auprc_score: 0.8824; val_best_acc_score: 0.8541; val_best_f1_score: 0.8646; train_kl_reg_loss: 133820.2157; train_edge_recon_loss: 2825363.8674; train_gene_expr_recon_loss: 13805545.3030; train_masked_gp_l1_reg_loss: 184145.9628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121803.9046; train_chrom_access_recon_loss: 5588762.6061; train_global_loss: 22659441.6970; train_optim_loss: 22659441.6970; val_kl_reg_loss: 131794.1494; val_edge_recon_loss: 2817263.8125; val_gene_expr_recon_loss: 13976860.1250; val_masked_gp_l1_reg_loss: 185001.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122387.9141; val_chrom_access_recon_loss: 5638589.0000; val_global_loss: 22871897.2500; val_optim_loss: 22871897.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9125; val_auprc_score: 0.8826; val_best_acc_score: 0.8538; val_best_f1_score: 0.8629; train_kl_reg_loss: 135145.6596; train_edge_recon_loss: 2807483.9735; train_gene_expr_recon_loss: 13787206.6212; train_masked_gp_l1_reg_loss: 185297.0322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122323.3860; train_chrom_access_recon_loss: 5579693.4318; train_global_loss: 22617149.9697; train_optim_loss: 22617149.9697; val_kl_reg_loss: 134037.2314; val_edge_recon_loss: 2832009.4062; val_gene_expr_recon_loss: 13857953.3750; val_masked_gp_l1_reg_loss: 185636.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122295.5938; val_chrom_access_recon_loss: 5621041.0000; val_global_loss: 22752972.7500; val_optim_loss: 22752972.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9162; val_auprc_score: 0.8767; val_best_acc_score: 0.8573; val_best_f1_score: 0.8679; train_kl_reg_loss: 131985.0902; train_edge_recon_loss: 2821907.1780; train_gene_expr_recon_loss: 13752189.5606; train_masked_gp_l1_reg_loss: 186015.0485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122162.4183; train_chrom_access_recon_loss: 5562942.6591; train_global_loss: 22577202.0303; train_optim_loss: 22577202.0303; val_kl_reg_loss: 132002.2549; val_edge_recon_loss: 2821463.4375; val_gene_expr_recon_loss: 13848476.8750; val_masked_gp_l1_reg_loss: 186691.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122536.3750; val_chrom_access_recon_loss: 5605859.5000; val_global_loss: 22717030.2500; val_optim_loss: 22717030.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9169; val_auprc_score: 0.8837; val_best_acc_score: 0.8576; val_best_f1_score: 0.8668; train_kl_reg_loss: 134533.0552; train_edge_recon_loss: 2799902.2197; train_gene_expr_recon_loss: 13715757.9394; train_masked_gp_l1_reg_loss: 186574.6707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121500.7956; train_chrom_access_recon_loss: 5548942.5000; train_global_loss: 22507211.1212; train_optim_loss: 22507211.1212; val_kl_reg_loss: 132042.4316; val_edge_recon_loss: 2814822.4688; val_gene_expr_recon_loss: 13744208.1250; val_masked_gp_l1_reg_loss: 187164.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121756.7422; val_chrom_access_recon_loss: 5557951.6875; val_global_loss: 22557944.5000; val_optim_loss: 22557944.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9203; val_auprc_score: 0.8907; val_best_acc_score: 0.8646; val_best_f1_score: 0.8715; train_kl_reg_loss: 130777.2224; train_edge_recon_loss: 2803012.3674; train_gene_expr_recon_loss: 13688539.3030; train_masked_gp_l1_reg_loss: 187459.7259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121455.4834; train_chrom_access_recon_loss: 5532131.9015; train_global_loss: 22463376.2121; train_optim_loss: 22463376.2121; val_kl_reg_loss: 127863.0840; val_edge_recon_loss: 2828513.3125; val_gene_expr_recon_loss: 13787834.0000; val_masked_gp_l1_reg_loss: 187997.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121203.7266; val_chrom_access_recon_loss: 5540930.8750; val_global_loss: 22594343.0000; val_optim_loss: 22594343.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9150; val_auprc_score: 0.8866; val_best_acc_score: 0.8549; val_best_f1_score: 0.8643; train_kl_reg_loss: 131898.7736; train_edge_recon_loss: 2811695.8864; train_gene_expr_recon_loss: 13651872.2424; train_masked_gp_l1_reg_loss: 188153.7879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120858.4505; train_chrom_access_recon_loss: 5516594.3939; train_global_loss: 22421073.3939; train_optim_loss: 22421073.3939; val_kl_reg_loss: 131014.8359; val_edge_recon_loss: 2854038.6250; val_gene_expr_recon_loss: 13767188.5000; val_masked_gp_l1_reg_loss: 188443.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120781.1172; val_chrom_access_recon_loss: 5584162.2500; val_global_loss: 22645630.2500; val_optim_loss: 22645630.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9219; val_auprc_score: 0.8831; val_best_acc_score: 0.8684; val_best_f1_score: 0.8769; train_kl_reg_loss: 131653.9594; train_edge_recon_loss: 2794801.2197; train_gene_expr_recon_loss: 13630028.4394; train_masked_gp_l1_reg_loss: 188540.1470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120372.4957; train_chrom_access_recon_loss: 5507462.3182; train_global_loss: 22372858.6364; train_optim_loss: 22372858.6364; val_kl_reg_loss: 134769.7930; val_edge_recon_loss: 2794653.5000; val_gene_expr_recon_loss: 13674974.2500; val_masked_gp_l1_reg_loss: 188733.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120332.7500; val_chrom_access_recon_loss: 5505277.0625; val_global_loss: 22418740.2500; val_optim_loss: 22418740.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9173; val_auprc_score: 0.8819; val_best_acc_score: 0.8624; val_best_f1_score: 0.8684; train_kl_reg_loss: 132171.8768; train_edge_recon_loss: 2795084.4962; train_gene_expr_recon_loss: 13608230.2424; train_masked_gp_l1_reg_loss: 188867.2408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120197.1919; train_chrom_access_recon_loss: 5496872.1136; train_global_loss: 22341423.3030; train_optim_loss: 22341423.3030; val_kl_reg_loss: 127487.0869; val_edge_recon_loss: 2836893.4375; val_gene_expr_recon_loss: 13699730.5000; val_masked_gp_l1_reg_loss: 189144.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120484.4219; val_chrom_access_recon_loss: 5506732.3125; val_global_loss: 22480471.7500; val_optim_loss: 22480471.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9265; val_auprc_score: 0.9006; val_best_acc_score: 0.8692; val_best_f1_score: 0.8758; train_kl_reg_loss: 129273.8680; train_edge_recon_loss: 2795996.3523; train_gene_expr_recon_loss: 13584560.3182; train_masked_gp_l1_reg_loss: 189396.5275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120150.8659; train_chrom_access_recon_loss: 5483376.4848; train_global_loss: 22302754.3939; train_optim_loss: 22302754.3939; val_kl_reg_loss: 123700.1865; val_edge_recon_loss: 2804481.3125; val_gene_expr_recon_loss: 13572198.1250; val_masked_gp_l1_reg_loss: 190348.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120163.2500; val_chrom_access_recon_loss: 5501238.7500; val_global_loss: 22312130.0000; val_optim_loss: 22312130.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9248; val_auprc_score: 0.8993; val_best_acc_score: 0.8659; val_best_f1_score: 0.8736; train_kl_reg_loss: 140298.5238; train_edge_recon_loss: 2837365.5000; train_gene_expr_recon_loss: 13152435.5758; train_masked_gp_l1_reg_loss: 188997.3132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123875.8054; train_chrom_access_recon_loss: 5393999.5909; train_global_loss: 21836972.0606; train_optim_loss: 21836972.0606; val_kl_reg_loss: 85928.9316; val_edge_recon_loss: 2862393.9375; val_gene_expr_recon_loss: 13120097.1250; val_masked_gp_l1_reg_loss: 188957.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124547.5078; val_chrom_access_recon_loss: 5336075.3125; val_global_loss: 21718000.7500; val_optim_loss: 21718000.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9272; val_auprc_score: 0.8990; val_best_acc_score: 0.8710; val_best_f1_score: 0.8767; train_kl_reg_loss: 141255.7685; train_edge_recon_loss: 2805383.9015; train_gene_expr_recon_loss: 13091121.3182; train_masked_gp_l1_reg_loss: 189024.9044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123147.9322; train_chrom_access_recon_loss: 5320467.6288; train_global_loss: 21670401.3333; train_optim_loss: 21670401.3333; val_kl_reg_loss: 92322.6309; val_edge_recon_loss: 2841181.0000; val_gene_expr_recon_loss: 13317802.2500; val_masked_gp_l1_reg_loss: 189138.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122358.6016; val_chrom_access_recon_loss: 5349569.8125; val_global_loss: 21912372.7500; val_optim_loss: 21912372.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9303; val_auprc_score: 0.9002; val_best_acc_score: 0.8721; val_best_f1_score: 0.8792; train_kl_reg_loss: 135027.1194; train_edge_recon_loss: 2797180.2727; train_gene_expr_recon_loss: 13048234.7121; train_masked_gp_l1_reg_loss: 188592.9548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120848.2505; train_chrom_access_recon_loss: 5308708.4621; train_global_loss: 21598591.7576; train_optim_loss: 21598591.7576; val_kl_reg_loss: 96867.5342; val_edge_recon_loss: 2829264.8125; val_gene_expr_recon_loss: 13093464.7500; val_masked_gp_l1_reg_loss: 188187.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119739.1641; val_chrom_access_recon_loss: 5300294.3750; val_global_loss: 21627817.5000; val_optim_loss: 21627817.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9337; val_auprc_score: 0.9109; val_best_acc_score: 0.8761; val_best_f1_score: 0.8821; train_kl_reg_loss: 128867.0903; train_edge_recon_loss: 2778903.1061; train_gene_expr_recon_loss: 13036213.8636; train_masked_gp_l1_reg_loss: 187833.2874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119341.9330; train_chrom_access_recon_loss: 5297538.0530; train_global_loss: 21548697.3939; train_optim_loss: 21548697.3939; val_kl_reg_loss: 102926.3896; val_edge_recon_loss: 2828170.1562; val_gene_expr_recon_loss: 13047801.0000; val_masked_gp_l1_reg_loss: 187556.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118643.0781; val_chrom_access_recon_loss: 5304739.8125; val_global_loss: 21589838.0000; val_optim_loss: 21589838.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9345; val_auprc_score: 0.9125; val_best_acc_score: 0.8786; val_best_f1_score: 0.8853; train_kl_reg_loss: 125198.2338; train_edge_recon_loss: 2775990.5644; train_gene_expr_recon_loss: 13009886.2424; train_masked_gp_l1_reg_loss: 187066.6624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118325.4173; train_chrom_access_recon_loss: 5277889.5909; train_global_loss: 21494356.7273; train_optim_loss: 21494356.7273; val_kl_reg_loss: 107531.2969; val_edge_recon_loss: 2825065.6875; val_gene_expr_recon_loss: 13063782.1250; val_masked_gp_l1_reg_loss: 186691.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117327.3125; val_chrom_access_recon_loss: 5304628.5000; val_global_loss: 21605026.2500; val_optim_loss: 21605026.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9390; val_auprc_score: 0.9177; val_best_acc_score: 0.8861; val_best_f1_score: 0.8910; train_kl_reg_loss: 124347.7837; train_edge_recon_loss: 2768292.5265; train_gene_expr_recon_loss: 12978251.0758; train_masked_gp_l1_reg_loss: 186266.1776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117622.2013; train_chrom_access_recon_loss: 5261006.9470; train_global_loss: 21435786.8182; train_optim_loss: 21435786.8182; val_kl_reg_loss: 110975.4629; val_edge_recon_loss: 2798176.7188; val_gene_expr_recon_loss: 12965697.0000; val_masked_gp_l1_reg_loss: 185775.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117358.8047; val_chrom_access_recon_loss: 5236253.7500; val_global_loss: 21414237.7500; val_optim_loss: 21414237.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9359; val_auprc_score: 0.9139; val_best_acc_score: 0.8831; val_best_f1_score: 0.8891; train_kl_reg_loss: 121856.0988; train_edge_recon_loss: 2778690.8409; train_gene_expr_recon_loss: 12963112.6515; train_masked_gp_l1_reg_loss: 185360.9531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117362.3371; train_chrom_access_recon_loss: 5248676.5758; train_global_loss: 21415059.6970; train_optim_loss: 21415059.6970; val_kl_reg_loss: 106654.3613; val_edge_recon_loss: 2820469.9688; val_gene_expr_recon_loss: 12962701.6250; val_masked_gp_l1_reg_loss: 185225.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117931.6562; val_chrom_access_recon_loss: 5280750.6250; val_global_loss: 21473734.2500; val_optim_loss: 21473734.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9351; val_auprc_score: 0.9112; val_best_acc_score: 0.8823; val_best_f1_score: 0.8862; train_kl_reg_loss: 123014.0022; train_edge_recon_loss: 2762127.3674; train_gene_expr_recon_loss: 12933231.5000; train_masked_gp_l1_reg_loss: 184799.4238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116666.9115; train_chrom_access_recon_loss: 5235089.7727; train_global_loss: 21354928.9394; train_optim_loss: 21354928.9394; val_kl_reg_loss: 111792.2314; val_edge_recon_loss: 2823259.1875; val_gene_expr_recon_loss: 13037718.0000; val_masked_gp_l1_reg_loss: 184648.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117100.4766; val_chrom_access_recon_loss: 5326087.6875; val_global_loss: 21600605.7500; val_optim_loss: 21600605.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9406; val_auprc_score: 0.9175; val_best_acc_score: 0.8842; val_best_f1_score: 0.8890; train_kl_reg_loss: 120480.9080; train_edge_recon_loss: 2772614.7235; train_gene_expr_recon_loss: 12913488.7273; train_masked_gp_l1_reg_loss: 184318.4929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116676.9985; train_chrom_access_recon_loss: 5229355.1591; train_global_loss: 21336935.0303; train_optim_loss: 21336935.0303; val_kl_reg_loss: 112924.0059; val_edge_recon_loss: 2790148.1875; val_gene_expr_recon_loss: 13039941.1250; val_masked_gp_l1_reg_loss: 183943.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116032.7578; val_chrom_access_recon_loss: 5238527.6875; val_global_loss: 21481516.7500; val_optim_loss: 21481516.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9357; val_auprc_score: 0.9071; val_best_acc_score: 0.8842; val_best_f1_score: 0.8883; train_kl_reg_loss: 118469.9902; train_edge_recon_loss: 2769654.3939; train_gene_expr_recon_loss: 12898959.4697; train_masked_gp_l1_reg_loss: 183650.9103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116187.6503; train_chrom_access_recon_loss: 5226206.9242; train_global_loss: 21313129.2121; train_optim_loss: 21313129.2121; val_kl_reg_loss: 113814.8740; val_edge_recon_loss: 2788962.6875; val_gene_expr_recon_loss: 13041479.6250; val_masked_gp_l1_reg_loss: 183545.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116223.3359; val_chrom_access_recon_loss: 5272132.4375; val_global_loss: 21516158.2500; val_optim_loss: 21516158.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9360; val_auprc_score: 0.9156; val_best_acc_score: 0.8767; val_best_f1_score: 0.8830; train_kl_reg_loss: 122008.0407; train_edge_recon_loss: 2751514.5076; train_gene_expr_recon_loss: 12880494.5303; train_masked_gp_l1_reg_loss: 180389.6901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85689.7573; train_chrom_access_recon_loss: 5217225.1667; train_global_loss: 21237321.7273; train_optim_loss: 21237321.7273; val_kl_reg_loss: 114138.4395; val_edge_recon_loss: 2812267.0938; val_gene_expr_recon_loss: 12913874.0000; val_masked_gp_l1_reg_loss: 179234.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80299.6484; val_chrom_access_recon_loss: 5205678.3750; val_global_loss: 21305492.7500; val_optim_loss: 21305492.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9322; val_auprc_score: 0.9080; val_best_acc_score: 0.8783; val_best_f1_score: 0.8854; train_kl_reg_loss: 121690.8763; train_edge_recon_loss: 2754242.8902; train_gene_expr_recon_loss: 12865816.1364; train_masked_gp_l1_reg_loss: 178954.7081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79966.1753; train_chrom_access_recon_loss: 5210265.7273; train_global_loss: 21210936.3939; train_optim_loss: 21210936.3939; val_kl_reg_loss: 114577.0713; val_edge_recon_loss: 2829804.4375; val_gene_expr_recon_loss: 12890017.5000; val_masked_gp_l1_reg_loss: 178750.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79756.0391; val_chrom_access_recon_loss: 5203506.8125; val_global_loss: 21296411.7500; val_optim_loss: 21296411.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9401; val_auprc_score: 0.9175; val_best_acc_score: 0.8815; val_best_f1_score: 0.8871; train_kl_reg_loss: 122582.0097; train_edge_recon_loss: 2746496.1818; train_gene_expr_recon_loss: 12868258.3030; train_masked_gp_l1_reg_loss: 178626.9998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79560.4922; train_chrom_access_recon_loss: 5212791.1136; train_global_loss: 21208315.0303; train_optim_loss: 21208315.0303; val_kl_reg_loss: 116035.7236; val_edge_recon_loss: 2799886.2500; val_gene_expr_recon_loss: 13061971.0000; val_masked_gp_l1_reg_loss: 178534.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79296.4297; val_chrom_access_recon_loss: 5211818.0625; val_global_loss: 21447542.0000; val_optim_loss: 21447542.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9468; val_auprc_score: 0.9341; val_best_acc_score: 0.8861; val_best_f1_score: 0.8913; train_kl_reg_loss: 123268.7261; train_edge_recon_loss: 2757063.6742; train_gene_expr_recon_loss: 12856715.7727; train_masked_gp_l1_reg_loss: 178432.0938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79198.3281; train_chrom_access_recon_loss: 5210645.5985; train_global_loss: 21205324.1515; train_optim_loss: 21205324.1515; val_kl_reg_loss: 117019.9160; val_edge_recon_loss: 2793683.3438; val_gene_expr_recon_loss: 13017192.5000; val_masked_gp_l1_reg_loss: 178359.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79076.1484; val_chrom_access_recon_loss: 5245296.1875; val_global_loss: 21430627.7500; val_optim_loss: 21430627.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9435; val_auprc_score: 0.9222; val_best_acc_score: 0.8890; val_best_f1_score: 0.8940; train_kl_reg_loss: 124445.6591; train_edge_recon_loss: 2744204.8561; train_gene_expr_recon_loss: 12872544.3182; train_masked_gp_l1_reg_loss: 178278.5405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78970.1997; train_chrom_access_recon_loss: 5208881.3030; train_global_loss: 21207324.7879; train_optim_loss: 21207324.7879; val_kl_reg_loss: 115532.9434; val_edge_recon_loss: 2778479.6250; val_gene_expr_recon_loss: 12913302.0000; val_masked_gp_l1_reg_loss: 178196.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78926.7812; val_chrom_access_recon_loss: 5216586.6875; val_global_loss: 21281024.5000; val_optim_loss: 21281024.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9449; val_auprc_score: 0.9258; val_best_acc_score: 0.8917; val_best_f1_score: 0.8945; train_kl_reg_loss: 123788.1615; train_edge_recon_loss: 2767188.8561; train_gene_expr_recon_loss: 12867402.5000; train_masked_gp_l1_reg_loss: 178138.1894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78722.6829; train_chrom_access_recon_loss: 5215440.7879; train_global_loss: 21230681.2121; train_optim_loss: 21230681.2121; val_kl_reg_loss: 115861.9033; val_edge_recon_loss: 2769123.8438; val_gene_expr_recon_loss: 12833958.8750; val_masked_gp_l1_reg_loss: 178086.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78640.1875; val_chrom_access_recon_loss: 5219880.5625; val_global_loss: 21195551.7500; val_optim_loss: 21195551.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9461; val_auprc_score: 0.9250; val_best_acc_score: 0.8933; val_best_f1_score: 0.8961; train_kl_reg_loss: 123241.8446; train_edge_recon_loss: 2755570.4848; train_gene_expr_recon_loss: 12857919.2121; train_masked_gp_l1_reg_loss: 178051.0424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78561.7330; train_chrom_access_recon_loss: 5212422.8636; train_global_loss: 21205767.2121; train_optim_loss: 21205767.2121; val_kl_reg_loss: 116328.8916; val_edge_recon_loss: 2741440.0625; val_gene_expr_recon_loss: 13012843.0000; val_masked_gp_l1_reg_loss: 177982.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78515.2891; val_chrom_access_recon_loss: 5266635.8125; val_global_loss: 21393745.5000; val_optim_loss: 21393745.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9433; val_auprc_score: 0.9203; val_best_acc_score: 0.8898; val_best_f1_score: 0.8932; train_kl_reg_loss: 122710.8197; train_edge_recon_loss: 2753615.0265; train_gene_expr_recon_loss: 12847628.8636; train_masked_gp_l1_reg_loss: 177937.8326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78400.8960; train_chrom_access_recon_loss: 5205799.5606; train_global_loss: 21186093.0909; train_optim_loss: 21186093.0909; val_kl_reg_loss: 117014.1689; val_edge_recon_loss: 2788041.2812; val_gene_expr_recon_loss: 12971892.1250; val_masked_gp_l1_reg_loss: 177892.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78275.3516; val_chrom_access_recon_loss: 5235724.6250; val_global_loss: 21368838.7500; val_optim_loss: 21368838.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9483; val_auprc_score: 0.9290; val_best_acc_score: 0.8931; val_best_f1_score: 0.8977; train_kl_reg_loss: 123516.5650; train_edge_recon_loss: 2742063.5947; train_gene_expr_recon_loss: 12860055.8485; train_masked_gp_l1_reg_loss: 177854.9621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78206.3010; train_chrom_access_recon_loss: 5205747.5833; train_global_loss: 21187444.9697; train_optim_loss: 21187444.9697; val_kl_reg_loss: 116640.5732; val_edge_recon_loss: 2779843.8438; val_gene_expr_recon_loss: 12948821.8750; val_masked_gp_l1_reg_loss: 177832.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78231.8125; val_chrom_access_recon_loss: 5182070.6250; val_global_loss: 21283441.2500; val_optim_loss: 21283441.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9456; val_auprc_score: 0.9216; val_best_acc_score: 0.8912; val_best_f1_score: 0.8945; train_kl_reg_loss: 123380.2166; train_edge_recon_loss: 2754946.2765; train_gene_expr_recon_loss: 12852256.0000; train_masked_gp_l1_reg_loss: 177795.9953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78054.4482; train_chrom_access_recon_loss: 5210324.0758; train_global_loss: 21196756.9697; train_optim_loss: 21196756.9697; val_kl_reg_loss: 116156.2568; val_edge_recon_loss: 2769628.9062; val_gene_expr_recon_loss: 12854190.1250; val_masked_gp_l1_reg_loss: 177767.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78086.4688; val_chrom_access_recon_loss: 5246030.2500; val_global_loss: 21241859.0000; val_optim_loss: 21241859.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9416; val_auprc_score: 0.9225; val_best_acc_score: 0.8858; val_best_f1_score: 0.8907; train_kl_reg_loss: 122794.2418; train_edge_recon_loss: 2747387.7159; train_gene_expr_recon_loss: 12844060.3788; train_masked_gp_l1_reg_loss: 177437.3423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74724.9260; train_chrom_access_recon_loss: 5203166.0682; train_global_loss: 21169570.6061; train_optim_loss: 21169570.6061; val_kl_reg_loss: 116311.1289; val_edge_recon_loss: 2803337.3125; val_gene_expr_recon_loss: 12942314.8750; val_masked_gp_l1_reg_loss: 177310.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74100.8047; val_chrom_access_recon_loss: 5234395.3750; val_global_loss: 21347770.5000; val_optim_loss: 21347770.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9402; val_auprc_score: 0.9194; val_best_acc_score: 0.8880; val_best_f1_score: 0.8917; train_kl_reg_loss: 122619.8179; train_edge_recon_loss: 2746539.5985; train_gene_expr_recon_loss: 12851446.7121; train_masked_gp_l1_reg_loss: 177271.7699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74055.4009; train_chrom_access_recon_loss: 5207617.0606; train_global_loss: 21179550.3939; train_optim_loss: 21179550.3939; val_kl_reg_loss: 115822.1650; val_edge_recon_loss: 2784817.0312; val_gene_expr_recon_loss: 13039139.7500; val_masked_gp_l1_reg_loss: 177242.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74026.8203; val_chrom_access_recon_loss: 5291660.2500; val_global_loss: 21482707.7500; val_optim_loss: 21482707.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9416; val_auprc_score: 0.9209; val_best_acc_score: 0.8866; val_best_f1_score: 0.8906; train_kl_reg_loss: 122763.6999; train_edge_recon_loss: 2752558.1250; train_gene_expr_recon_loss: 12855952.1667; train_masked_gp_l1_reg_loss: 177223.2524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74004.5327; train_chrom_access_recon_loss: 5206070.4470; train_global_loss: 21188572.3333; train_optim_loss: 21188572.3333; val_kl_reg_loss: 115735.8740; val_edge_recon_loss: 2811766.3125; val_gene_expr_recon_loss: 12865238.7500; val_masked_gp_l1_reg_loss: 177210.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73978.8047; val_chrom_access_recon_loss: 5193716.1875; val_global_loss: 21237645.7500; val_optim_loss: 21237645.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9294; val_auprc_score: 0.8922; val_best_acc_score: 0.8812; val_best_f1_score: 0.8881; train_kl_reg_loss: 122568.7269; train_edge_recon_loss: 2752063.3220; train_gene_expr_recon_loss: 12852028.3485; train_masked_gp_l1_reg_loss: 177200.8232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73967.1441; train_chrom_access_recon_loss: 5203690.1894; train_global_loss: 21181518.5455; train_optim_loss: 21181518.5455; val_kl_reg_loss: 115160.8506; val_edge_recon_loss: 2812575.1875; val_gene_expr_recon_loss: 12958150.2500; val_masked_gp_l1_reg_loss: 177188.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73946.1328; val_chrom_access_recon_loss: 5224651.0000; val_global_loss: 21361671.2500; val_optim_loss: 21361671.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 6 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9400
val AUPRC score: 0.9185
val best accuracy score: 0.8866
val best F1 score: 0.8903
val target rna MSE score: 1.0173
val source rna MSE score: 0.3946
val target atac MSE score: 0.4791
val source atac MSE score: 0.1075
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
