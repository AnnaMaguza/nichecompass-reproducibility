[True]
Run timestamp: 07082023_184321_46.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_46']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8961; val_auprc_score: 0.9044; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20951.0172; train_edge_recon_loss: 36213.1445; train_gene_expr_recon_loss: 647562.0486; train_masked_gp_l1_reg_loss: 4660.8142; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 265736.1806; train_global_loss: 975123.2222; train_optim_loss: 975123.2222; val_kl_reg_loss: 19432.3301; val_edge_recon_loss: 40659.2070; val_gene_expr_recon_loss: 581867.0000; val_masked_gp_l1_reg_loss: 4345.6733; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 263577.6250; val_global_loss: 909881.8750; val_optim_loss: 909881.8750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8849; val_auprc_score: 0.8919; val_best_acc_score: 0.5011; val_best_f1_score: 0.6671; train_kl_reg_loss: 24241.4505; train_edge_recon_loss: 39095.3238; train_gene_expr_recon_loss: 553368.1597; train_masked_gp_l1_reg_loss: 4275.0595; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 259868.7552; train_global_loss: 880848.7500; train_optim_loss: 880848.7500; val_kl_reg_loss: 24392.2969; val_edge_recon_loss: 40656.7109; val_gene_expr_recon_loss: 533470.0625; val_masked_gp_l1_reg_loss: 4218.5454; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 258417.4531; val_global_loss: 861155.0625; val_optim_loss: 861155.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8678; val_auprc_score: 0.8683; val_best_acc_score: 0.5185; val_best_f1_score: 0.6750; train_kl_reg_loss: 24688.0386; train_edge_recon_loss: 39046.1076; train_gene_expr_recon_loss: 516167.0833; train_masked_gp_l1_reg_loss: 4223.8556; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256250.4549; train_global_loss: 840375.5486; train_optim_loss: 840375.5486; val_kl_reg_loss: 25938.9199; val_edge_recon_loss: 40643.9492; val_gene_expr_recon_loss: 500570.6875; val_masked_gp_l1_reg_loss: 4242.9248; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 254808.5938; val_global_loss: 826205.1250; val_optim_loss: 826205.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8703; val_auprc_score: 0.8675; val_best_acc_score: 0.5225; val_best_f1_score: 0.6766; train_kl_reg_loss: 25865.6988; train_edge_recon_loss: 39112.7066; train_gene_expr_recon_loss: 487540.7500; train_masked_gp_l1_reg_loss: 4237.4706; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252282.2344; train_global_loss: 809038.8472; train_optim_loss: 809038.8472; val_kl_reg_loss: 25402.8105; val_edge_recon_loss: 40639.4141; val_gene_expr_recon_loss: 481741.3750; val_masked_gp_l1_reg_loss: 4199.8604; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252177.7031; val_global_loss: 804161.1875; val_optim_loss: 804161.1875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8569; val_auprc_score: 0.8508; val_best_acc_score: 0.5631; val_best_f1_score: 0.6944; train_kl_reg_loss: 25455.5994; train_edge_recon_loss: 39053.3147; train_gene_expr_recon_loss: 470225.1562; train_masked_gp_l1_reg_loss: 4140.8000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248879.0625; train_global_loss: 787753.9375; train_optim_loss: 787753.9375; val_kl_reg_loss: 24412.3594; val_edge_recon_loss: 40610.4727; val_gene_expr_recon_loss: 467807.5000; val_masked_gp_l1_reg_loss: 4060.3457; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250205.1719; val_global_loss: 787095.8750; val_optim_loss: 787095.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8435; val_auprc_score: 0.8346; val_best_acc_score: 0.6318; val_best_f1_score: 0.7252; train_kl_reg_loss: 24791.4826; train_edge_recon_loss: 38967.5182; train_gene_expr_recon_loss: 458727.5729; train_masked_gp_l1_reg_loss: 4001.7751; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247511.1597; train_global_loss: 773999.5278; train_optim_loss: 773999.5278; val_kl_reg_loss: 23755.5000; val_edge_recon_loss: 40538.3555; val_gene_expr_recon_loss: 456680.5000; val_masked_gp_l1_reg_loss: 3930.1787; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248541.4375; val_global_loss: 773445.9375; val_optim_loss: 773445.9375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8628; val_auprc_score: 0.8540; val_best_acc_score: 0.6865; val_best_f1_score: 0.7543; train_kl_reg_loss: 24660.6745; train_edge_recon_loss: 38948.3355; train_gene_expr_recon_loss: 449140.4549; train_masked_gp_l1_reg_loss: 3886.9888; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246123.8524; train_global_loss: 762760.3125; train_optim_loss: 762760.3125; val_kl_reg_loss: 24659.1602; val_edge_recon_loss: 40450.5469; val_gene_expr_recon_loss: 447020.7500; val_masked_gp_l1_reg_loss: 3834.2520; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246856.0312; val_global_loss: 762820.7500; val_optim_loss: 762820.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8786; val_auprc_score: 0.8757; val_best_acc_score: 0.7238; val_best_f1_score: 0.7749; train_kl_reg_loss: 24746.9275; train_edge_recon_loss: 38947.7491; train_gene_expr_recon_loss: 441867.9340; train_masked_gp_l1_reg_loss: 3798.8544; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245372.3194; train_global_loss: 754733.7917; train_optim_loss: 754733.7917; val_kl_reg_loss: 23965.1934; val_edge_recon_loss: 40423.8750; val_gene_expr_recon_loss: 440564.1250; val_masked_gp_l1_reg_loss: 3753.8586; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245414.7500; val_global_loss: 754121.7500; val_optim_loss: 754121.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8888; val_auprc_score: 0.8828; val_best_acc_score: 0.7654; val_best_f1_score: 0.7992; train_kl_reg_loss: 24511.5931; train_edge_recon_loss: 38928.2448; train_gene_expr_recon_loss: 435104.6319; train_masked_gp_l1_reg_loss: 3733.1233; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243525.8611; train_global_loss: 745803.4514; train_optim_loss: 745803.4514; val_kl_reg_loss: 23801.8672; val_edge_recon_loss: 40368.8359; val_gene_expr_recon_loss: 435184.5312; val_masked_gp_l1_reg_loss: 3705.5342; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244039.5000; val_global_loss: 747100.2500; val_optim_loss: 747100.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8994; val_auprc_score: 0.8966; val_best_acc_score: 0.7979; val_best_f1_score: 0.8186; train_kl_reg_loss: 24278.2148; train_edge_recon_loss: 38882.2899; train_gene_expr_recon_loss: 430917.1111; train_masked_gp_l1_reg_loss: 3692.6525; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242218.2587; train_global_loss: 739988.5208; train_optim_loss: 739988.5208; val_kl_reg_loss: 24431.5762; val_edge_recon_loss: 40283.2695; val_gene_expr_recon_loss: 430258.3125; val_masked_gp_l1_reg_loss: 3677.2605; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242618.5625; val_global_loss: 741269.0000; val_optim_loss: 741269.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8978; val_auprc_score: 0.8941; val_best_acc_score: 0.8115; val_best_f1_score: 0.8240; train_kl_reg_loss: 24290.3496; train_edge_recon_loss: 38824.3134; train_gene_expr_recon_loss: 427033.3542; train_masked_gp_l1_reg_loss: 3671.0071; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240493.8837; train_global_loss: 734312.9097; train_optim_loss: 734312.9097; val_kl_reg_loss: 23504.4824; val_edge_recon_loss: 40218.8750; val_gene_expr_recon_loss: 427210.2812; val_masked_gp_l1_reg_loss: 3660.2129; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241501.7812; val_global_loss: 736095.6250; val_optim_loss: 736095.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9078; val_auprc_score: 0.9016; val_best_acc_score: 0.8328; val_best_f1_score: 0.8380; train_kl_reg_loss: 23946.5875; train_edge_recon_loss: 38798.4674; train_gene_expr_recon_loss: 422080.2500; train_masked_gp_l1_reg_loss: 3660.6692; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239465.0156; train_global_loss: 727950.9792; train_optim_loss: 727950.9792; val_kl_reg_loss: 22872.7070; val_edge_recon_loss: 40135.9219; val_gene_expr_recon_loss: 424567.6250; val_masked_gp_l1_reg_loss: 3655.4438; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240581.1719; val_global_loss: 731812.8750; val_optim_loss: 731812.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9168; val_auprc_score: 0.9076; val_best_acc_score: 0.8480; val_best_f1_score: 0.8482; train_kl_reg_loss: 23679.5527; train_edge_recon_loss: 38756.6315; train_gene_expr_recon_loss: 422071.5312; train_masked_gp_l1_reg_loss: 3654.7665; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240249.6528; train_global_loss: 728412.1319; train_optim_loss: 728412.1319; val_kl_reg_loss: 22320.2070; val_edge_recon_loss: 40075.0938; val_gene_expr_recon_loss: 422408.5312; val_masked_gp_l1_reg_loss: 3651.7656; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239672.1875; val_global_loss: 728127.8125; val_optim_loss: 728127.8125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9212; val_auprc_score: 0.9113; val_best_acc_score: 0.8508; val_best_f1_score: 0.8492; train_kl_reg_loss: 23310.3874; train_edge_recon_loss: 38700.6463; train_gene_expr_recon_loss: 417001.5660; train_masked_gp_l1_reg_loss: 3657.7290; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238292.3819; train_global_loss: 720962.7083; train_optim_loss: 720962.7083; val_kl_reg_loss: 22210.9883; val_edge_recon_loss: 40020.3086; val_gene_expr_recon_loss: 419932.5938; val_masked_gp_l1_reg_loss: 3658.1042; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238800.8750; val_global_loss: 724622.8750; val_optim_loss: 724622.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9330; val_auprc_score: 0.9255; val_best_acc_score: 0.8576; val_best_f1_score: 0.8529; train_kl_reg_loss: 23174.6569; train_edge_recon_loss: 38665.9891; train_gene_expr_recon_loss: 419041.0417; train_masked_gp_l1_reg_loss: 3660.9675; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239250.9236; train_global_loss: 723793.5764; train_optim_loss: 723793.5764; val_kl_reg_loss: 21694.4922; val_edge_recon_loss: 39951.4492; val_gene_expr_recon_loss: 418241.3125; val_masked_gp_l1_reg_loss: 3661.4668; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238024.2188; val_global_loss: 721572.9375; val_optim_loss: 721572.9375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9327; val_auprc_score: 0.9224; val_best_acc_score: 0.8562; val_best_f1_score: 0.8496; train_kl_reg_loss: 22746.0996; train_edge_recon_loss: 38620.4210; train_gene_expr_recon_loss: 414911.2639; train_masked_gp_l1_reg_loss: 3670.0608; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236448.6580; train_global_loss: 716396.5069; train_optim_loss: 716396.5069; val_kl_reg_loss: 20823.1016; val_edge_recon_loss: 39913.5547; val_gene_expr_recon_loss: 417289.5000; val_masked_gp_l1_reg_loss: 3672.4214; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237397.5156; val_global_loss: 719096.0625; val_optim_loss: 719096.0625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9350; val_auprc_score: 0.9253; val_best_acc_score: 0.8584; val_best_f1_score: 0.8532; train_kl_reg_loss: 22267.2266; train_edge_recon_loss: 38564.6701; train_gene_expr_recon_loss: 412585.1319; train_masked_gp_l1_reg_loss: 3679.8770; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236016.3212; train_global_loss: 713113.2292; train_optim_loss: 713113.2292; val_kl_reg_loss: 22107.5664; val_edge_recon_loss: 39898.6875; val_gene_expr_recon_loss: 414172.6562; val_masked_gp_l1_reg_loss: 3681.1509; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236348.6875; val_global_loss: 716208.7500; val_optim_loss: 716208.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9339; val_auprc_score: 0.9206; val_best_acc_score: 0.8477; val_best_f1_score: 0.8392; train_kl_reg_loss: 22137.4004; train_edge_recon_loss: 38534.0234; train_gene_expr_recon_loss: 409304.5278; train_masked_gp_l1_reg_loss: 3689.4755; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234523.5347; train_global_loss: 708188.9514; train_optim_loss: 708188.9514; val_kl_reg_loss: 20442.7773; val_edge_recon_loss: 39811.4453; val_gene_expr_recon_loss: 414264.8438; val_masked_gp_l1_reg_loss: 3691.6941; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235927.4375; val_global_loss: 714138.1875; val_optim_loss: 714138.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9423; val_auprc_score: 0.9311; val_best_acc_score: 0.8591; val_best_f1_score: 0.8495; train_kl_reg_loss: 21713.1645; train_edge_recon_loss: 38480.1029; train_gene_expr_recon_loss: 408860.4306; train_masked_gp_l1_reg_loss: 3699.4254; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234407.5851; train_global_loss: 707160.7014; train_optim_loss: 707160.7014; val_kl_reg_loss: 20780.9883; val_edge_recon_loss: 39785.6328; val_gene_expr_recon_loss: 412246.5312; val_masked_gp_l1_reg_loss: 3702.2007; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235188.2031; val_global_loss: 711703.5625; val_optim_loss: 711703.5625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9432; val_auprc_score: 0.9366; val_best_acc_score: 0.8518; val_best_f1_score: 0.8405; train_kl_reg_loss: 21507.1395; train_edge_recon_loss: 38446.1845; train_gene_expr_recon_loss: 409343.5799; train_masked_gp_l1_reg_loss: 3710.1987; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233451.1441; train_global_loss: 706458.2708; train_optim_loss: 706458.2708; val_kl_reg_loss: 20119.9902; val_edge_recon_loss: 39758.3047; val_gene_expr_recon_loss: 411530.4062; val_masked_gp_l1_reg_loss: 3712.7461; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234690.9688; val_global_loss: 709812.3750; val_optim_loss: 709812.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9432; val_auprc_score: 0.9313; val_best_acc_score: 0.8523; val_best_f1_score: 0.8401; train_kl_reg_loss: 21100.5862; train_edge_recon_loss: 38408.2031; train_gene_expr_recon_loss: 407994.7743; train_masked_gp_l1_reg_loss: 3722.2169; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233635.9531; train_global_loss: 704861.7292; train_optim_loss: 704861.7292; val_kl_reg_loss: 20427.7305; val_edge_recon_loss: 39733.5898; val_gene_expr_recon_loss: 409889.8750; val_masked_gp_l1_reg_loss: 3727.3042; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233965.7969; val_global_loss: 707744.3125; val_optim_loss: 707744.3125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9485; val_auprc_score: 0.9426; val_best_acc_score: 0.8479; val_best_f1_score: 0.8474; train_kl_reg_loss: 20976.5924; train_edge_recon_loss: 38383.5781; train_gene_expr_recon_loss: 407060.0069; train_masked_gp_l1_reg_loss: 3735.5343; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233000.5955; train_global_loss: 703156.3056; train_optim_loss: 703156.3056; val_kl_reg_loss: 19584.4551; val_edge_recon_loss: 39666.4219; val_gene_expr_recon_loss: 409579.5000; val_masked_gp_l1_reg_loss: 3740.4614; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233456.4219; val_global_loss: 706027.2500; val_optim_loss: 706027.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9472; val_auprc_score: 0.9394; val_best_acc_score: 0.8406; val_best_f1_score: 0.8461; train_kl_reg_loss: 20661.0132; train_edge_recon_loss: 38348.9805; train_gene_expr_recon_loss: 405365.9444; train_masked_gp_l1_reg_loss: 3749.4194; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232247.8003; train_global_loss: 700373.1528; train_optim_loss: 700373.1528; val_kl_reg_loss: 19026.2637; val_edge_recon_loss: 39626.1406; val_gene_expr_recon_loss: 409016.8125; val_masked_gp_l1_reg_loss: 3753.4534; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233004.9844; val_global_loss: 704427.6875; val_optim_loss: 704427.6875
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9490; val_auprc_score: 0.9413; val_best_acc_score: 0.8368; val_best_f1_score: 0.8489; train_kl_reg_loss: 20311.7704; train_edge_recon_loss: 38302.7205; train_gene_expr_recon_loss: 403970.0174; train_masked_gp_l1_reg_loss: 3764.3136; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 230201.8872; train_global_loss: 696550.7222; train_optim_loss: 696550.7222; val_kl_reg_loss: 18663.6094; val_edge_recon_loss: 39611.3477; val_gene_expr_recon_loss: 408266.6250; val_masked_gp_l1_reg_loss: 3770.4636; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232653.2500; val_global_loss: 702965.3125; val_optim_loss: 702965.3125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9564; val_auprc_score: 0.9515; val_best_acc_score: 0.8507; val_best_f1_score: 0.8671; train_kl_reg_loss: 20084.0406; train_edge_recon_loss: 38258.6832; train_gene_expr_recon_loss: 404108.3125; train_masked_gp_l1_reg_loss: 3780.8081; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231146.4531; train_global_loss: 697378.3056; train_optim_loss: 697378.3056; val_kl_reg_loss: 18212.4629; val_edge_recon_loss: 39519.3320; val_gene_expr_recon_loss: 407859.1875; val_masked_gp_l1_reg_loss: 3785.4692; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232197.0000; val_global_loss: 701573.5000; val_optim_loss: 701573.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9453; val_auprc_score: 0.9402; val_best_acc_score: 0.8801; val_best_f1_score: 0.8855; train_kl_reg_loss: 20077.9293; train_edge_recon_loss: 40101.8056; train_gene_expr_recon_loss: 414372.3472; train_masked_gp_l1_reg_loss: 3798.0427; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233642.7656; train_global_loss: 711992.9028; train_optim_loss: 711992.9028; val_kl_reg_loss: 15410.9561; val_edge_recon_loss: 40287.3594; val_gene_expr_recon_loss: 419454.0000; val_masked_gp_l1_reg_loss: 3795.0972; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235575.0781; val_global_loss: 714522.5000; val_optim_loss: 714522.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9428; val_auprc_score: 0.9351; val_best_acc_score: 0.8682; val_best_f1_score: 0.8758; train_kl_reg_loss: 18346.6150; train_edge_recon_loss: 40147.1207; train_gene_expr_recon_loss: 411984.5972; train_masked_gp_l1_reg_loss: 3785.2626; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233648.0521; train_global_loss: 707911.6319; train_optim_loss: 707911.6319; val_kl_reg_loss: 16262.3379; val_edge_recon_loss: 40302.0430; val_gene_expr_recon_loss: 415891.1250; val_masked_gp_l1_reg_loss: 3768.1602; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234764.7500; val_global_loss: 710988.3750; val_optim_loss: 710988.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9479; val_auprc_score: 0.9429; val_best_acc_score: 0.8817; val_best_f1_score: 0.8861; train_kl_reg_loss: 17460.0853; train_edge_recon_loss: 40103.9375; train_gene_expr_recon_loss: 414093.0035; train_masked_gp_l1_reg_loss: 3756.4883; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234116.8559; train_global_loss: 709530.3750; train_optim_loss: 709530.3750; val_kl_reg_loss: 16393.1055; val_edge_recon_loss: 40231.5312; val_gene_expr_recon_loss: 414183.4375; val_masked_gp_l1_reg_loss: 3741.8315; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234293.6562; val_global_loss: 708843.5625; val_optim_loss: 708843.5625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9517; val_auprc_score: 0.9467; val_best_acc_score: 0.8853; val_best_f1_score: 0.8871; train_kl_reg_loss: 17015.6714; train_edge_recon_loss: 40035.8845; train_gene_expr_recon_loss: 410827.7431; train_masked_gp_l1_reg_loss: 3732.9933; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232159.9462; train_global_loss: 703772.2569; train_optim_loss: 703772.2569; val_kl_reg_loss: 15506.7061; val_edge_recon_loss: 40164.7266; val_gene_expr_recon_loss: 413979.2500; val_masked_gp_l1_reg_loss: 3720.8108; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234041.9375; val_global_loss: 707413.4375; val_optim_loss: 707413.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9513; val_auprc_score: 0.9482; val_best_acc_score: 0.8847; val_best_f1_score: 0.8866; train_kl_reg_loss: 16774.2077; train_edge_recon_loss: 40003.6914; train_gene_expr_recon_loss: 408827.1354; train_masked_gp_l1_reg_loss: 3707.1692; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232368.1493; train_global_loss: 701680.3472; train_optim_loss: 701680.3472; val_kl_reg_loss: 15690.0400; val_edge_recon_loss: 40168.1602; val_gene_expr_recon_loss: 413552.2812; val_masked_gp_l1_reg_loss: 3693.8857; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233997.2969; val_global_loss: 707101.6250; val_optim_loss: 707101.6250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9487; val_auprc_score: 0.9419; val_best_acc_score: 0.8837; val_best_f1_score: 0.8856; train_kl_reg_loss: 16687.4306; train_edge_recon_loss: 40007.1480; train_gene_expr_recon_loss: 410577.6354; train_masked_gp_l1_reg_loss: 3689.7778; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233136.3941; train_global_loss: 704098.3889; train_optim_loss: 704098.3889; val_kl_reg_loss: 15575.8096; val_edge_recon_loss: 40158.8125; val_gene_expr_recon_loss: 413591.6562; val_masked_gp_l1_reg_loss: 3683.7979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234032.7812; val_global_loss: 707042.8750; val_optim_loss: 707042.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9502; val_auprc_score: 0.9441; val_best_acc_score: 0.8841; val_best_f1_score: 0.8858; train_kl_reg_loss: 16689.0907; train_edge_recon_loss: 39996.1697; train_gene_expr_recon_loss: 408685.7847; train_masked_gp_l1_reg_loss: 3680.2648; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232856.9201; train_global_loss: 701908.2153; train_optim_loss: 701908.2153; val_kl_reg_loss: 15525.8730; val_edge_recon_loss: 40162.1992; val_gene_expr_recon_loss: 413494.3750; val_masked_gp_l1_reg_loss: 3676.2317; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233947.7969; val_global_loss: 706806.4375; val_optim_loss: 706806.4375
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9497; val_auprc_score: 0.9447; val_best_acc_score: 0.8812; val_best_f1_score: 0.8830; train_kl_reg_loss: 16592.7235; train_edge_recon_loss: 39989.4974; train_gene_expr_recon_loss: 409193.5903; train_masked_gp_l1_reg_loss: 3673.7006; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232088.2170; train_global_loss: 701537.7292; train_optim_loss: 701537.7292; val_kl_reg_loss: 15457.1934; val_edge_recon_loss: 40150.6523; val_gene_expr_recon_loss: 413461.7812; val_masked_gp_l1_reg_loss: 3670.8379; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233935.5469; val_global_loss: 706676.0000; val_optim_loss: 706676.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 25 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9543
val AUPRC score: 0.9497
val best accuracy score: 0.8861
val best F1 score: 0.8884
val target rna MSE score: 0.5251
val source rna MSE score: 0.3229
val target atac MSE score: 0.1383
val source atac MSE score: 0.0195
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
