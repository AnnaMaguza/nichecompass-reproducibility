[True]
Run timestamp: 08082023_054958_163.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_163']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6938; val_auprc_score: 0.7060; val_best_acc_score: 0.6067; val_best_f1_score: 0.6833; train_kl_reg_loss: 16502.1835; train_edge_recon_loss: 37654.3252; train_gene_expr_recon_loss: 537169.8035; train_masked_gp_l1_reg_loss: 3693.9044; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 785266.7992; train_global_loss: 1380287.0170; train_optim_loss: 1380287.0170; val_kl_reg_loss: 28853.4197; val_edge_recon_loss: 40560.5151; val_gene_expr_recon_loss: 456038.7969; val_masked_gp_l1_reg_loss: 3670.5361; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 757448.1172; val_global_loss: 1286571.3906; val_optim_loss: 1286571.3906
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7970; val_auprc_score: 0.8091; val_best_acc_score: 0.7020; val_best_f1_score: 0.7350; train_kl_reg_loss: 30061.7069; train_edge_recon_loss: 39459.4667; train_gene_expr_recon_loss: 431856.9891; train_masked_gp_l1_reg_loss: 3593.8585; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732395.1080; train_global_loss: 1237367.1307; train_optim_loss: 1237367.1307; val_kl_reg_loss: 29142.4866; val_edge_recon_loss: 40528.2729; val_gene_expr_recon_loss: 415546.9336; val_masked_gp_l1_reg_loss: 3586.4893; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 724371.9375; val_global_loss: 1213176.1406; val_optim_loss: 1213176.1406
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8810; val_auprc_score: 0.8742; val_best_acc_score: 0.7924; val_best_f1_score: 0.7782; train_kl_reg_loss: 27803.3253; train_edge_recon_loss: 39351.0620; train_gene_expr_recon_loss: 414536.3651; train_masked_gp_l1_reg_loss: 3635.1434; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 714943.8466; train_global_loss: 1200269.7386; train_optim_loss: 1200269.7386; val_kl_reg_loss: 25564.2283; val_edge_recon_loss: 40275.6870; val_gene_expr_recon_loss: 406977.2852; val_masked_gp_l1_reg_loss: 3701.2307; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709375.2578; val_global_loss: 1185893.6875; val_optim_loss: 1185893.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9051; val_auprc_score: 0.8952; val_best_acc_score: 0.7868; val_best_f1_score: 0.7791; train_kl_reg_loss: 25140.9732; train_edge_recon_loss: 39064.0362; train_gene_expr_recon_loss: 407632.2917; train_masked_gp_l1_reg_loss: 3753.3901; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704208.6061; train_global_loss: 1179799.2973; train_optim_loss: 1179799.2973; val_kl_reg_loss: 24128.2834; val_edge_recon_loss: 40029.8291; val_gene_expr_recon_loss: 401771.4570; val_masked_gp_l1_reg_loss: 3813.4761; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 706982.8359; val_global_loss: 1176725.8594; val_optim_loss: 1176725.8594
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9218; val_auprc_score: 0.9109; val_best_acc_score: 0.8073; val_best_f1_score: 0.8340; train_kl_reg_loss: 23194.2551; train_edge_recon_loss: 38738.3160; train_gene_expr_recon_loss: 403194.7865; train_masked_gp_l1_reg_loss: 3867.5018; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 697521.1117; train_global_loss: 1166515.9716; train_optim_loss: 1166515.9716; val_kl_reg_loss: 22343.7166; val_edge_recon_loss: 39675.6484; val_gene_expr_recon_loss: 400547.8594; val_masked_gp_l1_reg_loss: 3919.8867; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 711295.8828; val_global_loss: 1177783.0000; val_optim_loss: 1177783.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9247; val_auprc_score: 0.9158; val_best_acc_score: 0.8294; val_best_f1_score: 0.8462; train_kl_reg_loss: 21572.6680; train_edge_recon_loss: 38422.5885; train_gene_expr_recon_loss: 399424.9635; train_masked_gp_l1_reg_loss: 3967.8191; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 691517.7150; train_global_loss: 1154905.7614; train_optim_loss: 1154905.7614; val_kl_reg_loss: 20670.5283; val_edge_recon_loss: 39454.7720; val_gene_expr_recon_loss: 399232.9961; val_masked_gp_l1_reg_loss: 4017.5884; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 701290.2422; val_global_loss: 1164666.1406; val_optim_loss: 1164666.1406
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9322; val_auprc_score: 0.9277; val_best_acc_score: 0.8507; val_best_f1_score: 0.8585; train_kl_reg_loss: 20309.7836; train_edge_recon_loss: 38167.2507; train_gene_expr_recon_loss: 396217.6193; train_masked_gp_l1_reg_loss: 4062.0788; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 684753.1051; train_global_loss: 1143509.8390; train_optim_loss: 1143509.8390; val_kl_reg_loss: 19625.2314; val_edge_recon_loss: 39148.0537; val_gene_expr_recon_loss: 393647.4141; val_masked_gp_l1_reg_loss: 4104.3672; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 686711.3125; val_global_loss: 1143236.3750; val_optim_loss: 1143236.3750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9327; val_auprc_score: 0.9260; val_best_acc_score: 0.8570; val_best_f1_score: 0.8567; train_kl_reg_loss: 19289.7469; train_edge_recon_loss: 37908.9714; train_gene_expr_recon_loss: 393824.9531; train_masked_gp_l1_reg_loss: 4147.7121; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 681071.9905; train_global_loss: 1136243.3712; train_optim_loss: 1136243.3712; val_kl_reg_loss: 18479.5928; val_edge_recon_loss: 38907.4766; val_gene_expr_recon_loss: 391736.2344; val_masked_gp_l1_reg_loss: 4196.2563; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 687782.1172; val_global_loss: 1141101.6562; val_optim_loss: 1141101.6562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9368; val_auprc_score: 0.9328; val_best_acc_score: 0.8468; val_best_f1_score: 0.8568; train_kl_reg_loss: 18539.2246; train_edge_recon_loss: 37688.7930; train_gene_expr_recon_loss: 391727.2689; train_masked_gp_l1_reg_loss: 4228.9648; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 676196.2188; train_global_loss: 1128380.4773; train_optim_loss: 1128380.4773; val_kl_reg_loss: 17889.9097; val_edge_recon_loss: 38733.8252; val_gene_expr_recon_loss: 393171.7227; val_masked_gp_l1_reg_loss: 4272.3574; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 680852.4922; val_global_loss: 1134920.2969; val_optim_loss: 1134920.2969
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9399; val_auprc_score: 0.9388; val_best_acc_score: 0.8568; val_best_f1_score: 0.8613; train_kl_reg_loss: 17921.2059; train_edge_recon_loss: 37481.6567; train_gene_expr_recon_loss: 388501.0810; train_masked_gp_l1_reg_loss: 4300.4248; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 671157.7973; train_global_loss: 1119362.1667; train_optim_loss: 1119362.1667; val_kl_reg_loss: 16754.9980; val_edge_recon_loss: 38445.8394; val_gene_expr_recon_loss: 390734.2109; val_masked_gp_l1_reg_loss: 4332.0503; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 683180.9531; val_global_loss: 1133448.0156; val_optim_loss: 1133448.0156
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9483; val_auprc_score: 0.9479; val_best_acc_score: 0.8701; val_best_f1_score: 0.8696; train_kl_reg_loss: 17199.1417; train_edge_recon_loss: 37290.3120; train_gene_expr_recon_loss: 386616.1302; train_masked_gp_l1_reg_loss: 4361.9751; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 667737.3030; train_global_loss: 1113204.8617; train_optim_loss: 1113204.8617; val_kl_reg_loss: 16615.9545; val_edge_recon_loss: 38264.2363; val_gene_expr_recon_loss: 388080.6641; val_masked_gp_l1_reg_loss: 4401.1064; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 676782.3281; val_global_loss: 1124144.2812; val_optim_loss: 1124144.2812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9455; val_auprc_score: 0.9416; val_best_acc_score: 0.8677; val_best_f1_score: 0.8742; train_kl_reg_loss: 16755.7027; train_edge_recon_loss: 37113.7524; train_gene_expr_recon_loss: 384504.4276; train_masked_gp_l1_reg_loss: 4428.9049; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 663050.8475; train_global_loss: 1105853.6364; train_optim_loss: 1105853.6364; val_kl_reg_loss: 15920.9869; val_edge_recon_loss: 38068.3442; val_gene_expr_recon_loss: 384448.8281; val_masked_gp_l1_reg_loss: 4461.0513; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 668250.1328; val_global_loss: 1111149.3750; val_optim_loss: 1111149.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9505; val_auprc_score: 0.9509; val_best_acc_score: 0.8752; val_best_f1_score: 0.8761; train_kl_reg_loss: 16351.0315; train_edge_recon_loss: 36935.2426; train_gene_expr_recon_loss: 382773.8438; train_masked_gp_l1_reg_loss: 4484.4294; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 660367.4044; train_global_loss: 1100911.9470; train_optim_loss: 1100911.9470; val_kl_reg_loss: 15546.5262; val_edge_recon_loss: 37861.8184; val_gene_expr_recon_loss: 386786.1250; val_masked_gp_l1_reg_loss: 4517.2563; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 679001.8438; val_global_loss: 1123713.5938; val_optim_loss: 1123713.5938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9541; val_auprc_score: 0.9551; val_best_acc_score: 0.8789; val_best_f1_score: 0.8782; train_kl_reg_loss: 15954.8219; train_edge_recon_loss: 36756.4434; train_gene_expr_recon_loss: 380968.8892; train_masked_gp_l1_reg_loss: 4538.7238; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 657726.0871; train_global_loss: 1095944.9669; train_optim_loss: 1095944.9669; val_kl_reg_loss: 15356.7083; val_edge_recon_loss: 37729.6621; val_gene_expr_recon_loss: 379625.5547; val_masked_gp_l1_reg_loss: 4561.0654; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 663667.4531; val_global_loss: 1100940.4375; val_optim_loss: 1100940.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9591; val_auprc_score: 0.9592; val_best_acc_score: 0.8898; val_best_f1_score: 0.8909; train_kl_reg_loss: 15643.8614; train_edge_recon_loss: 36594.8246; train_gene_expr_recon_loss: 378789.0095; train_masked_gp_l1_reg_loss: 4591.9057; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 655109.2453; train_global_loss: 1090728.8409; train_optim_loss: 1090728.8409; val_kl_reg_loss: 14961.5372; val_edge_recon_loss: 37414.1729; val_gene_expr_recon_loss: 382897.6875; val_masked_gp_l1_reg_loss: 4624.2246; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 662770.6641; val_global_loss: 1102668.2656; val_optim_loss: 1102668.2656
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9583; val_auprc_score: 0.9577; val_best_acc_score: 0.8861; val_best_f1_score: 0.8884; train_kl_reg_loss: 15387.0424; train_edge_recon_loss: 36461.1123; train_gene_expr_recon_loss: 376893.2926; train_masked_gp_l1_reg_loss: 4644.2448; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 651081.2045; train_global_loss: 1084466.9034; train_optim_loss: 1084466.9034; val_kl_reg_loss: 14702.1407; val_edge_recon_loss: 37321.3716; val_gene_expr_recon_loss: 382758.5625; val_masked_gp_l1_reg_loss: 4683.0850; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 659446.0234; val_global_loss: 1098911.2031; val_optim_loss: 1098911.2031
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9625; val_auprc_score: 0.9634; val_best_acc_score: 0.8923; val_best_f1_score: 0.8943; train_kl_reg_loss: 15169.8935; train_edge_recon_loss: 36287.2173; train_gene_expr_recon_loss: 374866.0824; train_masked_gp_l1_reg_loss: 4698.4672; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 648101.1705; train_global_loss: 1079122.8314; train_optim_loss: 1079122.8314; val_kl_reg_loss: 14466.6257; val_edge_recon_loss: 37122.8350; val_gene_expr_recon_loss: 377441.2578; val_masked_gp_l1_reg_loss: 4720.8701; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 654431.0859; val_global_loss: 1088182.6797; val_optim_loss: 1088182.6797
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9644; val_auprc_score: 0.9630; val_best_acc_score: 0.8988; val_best_f1_score: 0.8977; train_kl_reg_loss: 14931.7589; train_edge_recon_loss: 36134.2527; train_gene_expr_recon_loss: 373536.0062; train_masked_gp_l1_reg_loss: 4746.0225; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 645899.9583; train_global_loss: 1075247.9991; train_optim_loss: 1075247.9991; val_kl_reg_loss: 14501.0714; val_edge_recon_loss: 36956.6855; val_gene_expr_recon_loss: 377396.1680; val_masked_gp_l1_reg_loss: 4777.0107; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 652024.6562; val_global_loss: 1085655.5781; val_optim_loss: 1085655.5781
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9641; val_auprc_score: 0.9644; val_best_acc_score: 0.8964; val_best_f1_score: 0.8981; train_kl_reg_loss: 14713.9237; train_edge_recon_loss: 36001.9904; train_gene_expr_recon_loss: 371747.0369; train_masked_gp_l1_reg_loss: 4799.6212; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 643414.7633; train_global_loss: 1070677.3258; train_optim_loss: 1070677.3258; val_kl_reg_loss: 14276.2400; val_edge_recon_loss: 36877.9116; val_gene_expr_recon_loss: 375581.8359; val_masked_gp_l1_reg_loss: 4827.7329; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 649483.9688; val_global_loss: 1081047.6875; val_optim_loss: 1081047.6875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9706; val_auprc_score: 0.9717; val_best_acc_score: 0.9049; val_best_f1_score: 0.9055; train_kl_reg_loss: 14580.8005; train_edge_recon_loss: 35841.6386; train_gene_expr_recon_loss: 370149.4839; train_masked_gp_l1_reg_loss: 4850.1490; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 642625.0597; train_global_loss: 1068047.1326; train_optim_loss: 1068047.1326; val_kl_reg_loss: 14168.3760; val_edge_recon_loss: 36643.1411; val_gene_expr_recon_loss: 378175.7891; val_masked_gp_l1_reg_loss: 4866.4961; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 654205.2266; val_global_loss: 1088059.0312; val_optim_loss: 1088059.0312
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9724; val_auprc_score: 0.9739; val_best_acc_score: 0.9103; val_best_f1_score: 0.9120; train_kl_reg_loss: 14484.0342; train_edge_recon_loss: 35708.5475; train_gene_expr_recon_loss: 368007.4967; train_masked_gp_l1_reg_loss: 4892.2671; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 638272.7775; train_global_loss: 1061365.1184; train_optim_loss: 1061365.1184; val_kl_reg_loss: 13929.9463; val_edge_recon_loss: 36461.2280; val_gene_expr_recon_loss: 374727.8555; val_masked_gp_l1_reg_loss: 4921.2642; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 645688.4766; val_global_loss: 1075728.7344; val_optim_loss: 1075728.7344
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9729; val_auprc_score: 0.9730; val_best_acc_score: 0.9144; val_best_f1_score: 0.9132; train_kl_reg_loss: 14343.3975; train_edge_recon_loss: 35562.0743; train_gene_expr_recon_loss: 366609.1056; train_masked_gp_l1_reg_loss: 4944.9933; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 637327.8864; train_global_loss: 1058787.4517; train_optim_loss: 1058787.4517; val_kl_reg_loss: 13545.6818; val_edge_recon_loss: 36241.7544; val_gene_expr_recon_loss: 373278.5078; val_masked_gp_l1_reg_loss: 4969.0825; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 639085.2891; val_global_loss: 1067120.3125; val_optim_loss: 1067120.3125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9759; val_auprc_score: 0.9775; val_best_acc_score: 0.9150; val_best_f1_score: 0.9162; train_kl_reg_loss: 14234.0431; train_edge_recon_loss: 35398.8673; train_gene_expr_recon_loss: 365071.8513; train_masked_gp_l1_reg_loss: 4984.7394; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 633912.3248; train_global_loss: 1053601.8286; train_optim_loss: 1053601.8286; val_kl_reg_loss: 13804.6198; val_edge_recon_loss: 36108.8613; val_gene_expr_recon_loss: 374006.0195; val_masked_gp_l1_reg_loss: 5012.4824; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 643633.1719; val_global_loss: 1072565.1250; val_optim_loss: 1072565.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9756; val_auprc_score: 0.9762; val_best_acc_score: 0.9181; val_best_f1_score: 0.9175; train_kl_reg_loss: 14240.8832; train_edge_recon_loss: 35301.0676; train_gene_expr_recon_loss: 363285.9309; train_masked_gp_l1_reg_loss: 5029.5560; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 631390.6345; train_global_loss: 1049248.0710; train_optim_loss: 1049248.0710; val_kl_reg_loss: 13487.4388; val_edge_recon_loss: 35943.6211; val_gene_expr_recon_loss: 374441.6289; val_masked_gp_l1_reg_loss: 5048.7734; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 643243.4688; val_global_loss: 1072164.9219; val_optim_loss: 1072164.9219
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9783; val_auprc_score: 0.9798; val_best_acc_score: 0.9213; val_best_f1_score: 0.9215; train_kl_reg_loss: 14167.9405; train_edge_recon_loss: 35183.0436; train_gene_expr_recon_loss: 362138.3310; train_masked_gp_l1_reg_loss: 5067.4422; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 630490.6449; train_global_loss: 1047047.4072; train_optim_loss: 1047047.4072; val_kl_reg_loss: 13485.7853; val_edge_recon_loss: 35871.4502; val_gene_expr_recon_loss: 369333.5977; val_masked_gp_l1_reg_loss: 5083.4917; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 631079.5938; val_global_loss: 1054853.9609; val_optim_loss: 1054853.9609
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9810; val_auprc_score: 0.9819; val_best_acc_score: 0.9301; val_best_f1_score: 0.9302; train_kl_reg_loss: 13023.3289; train_edge_recon_loss: 36312.8002; train_gene_expr_recon_loss: 364920.7656; train_masked_gp_l1_reg_loss: 5032.2482; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 635755.9848; train_global_loss: 1055045.1269; train_optim_loss: 1055045.1269; val_kl_reg_loss: 11329.7542; val_edge_recon_loss: 36567.4204; val_gene_expr_recon_loss: 371355.9922; val_masked_gp_l1_reg_loss: 5032.6816; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 644176.6641; val_global_loss: 1068462.5000; val_optim_loss: 1068462.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9832; val_auprc_score: 0.9812; val_best_acc_score: 0.9310; val_best_f1_score: 0.9322; train_kl_reg_loss: 12494.1199; train_edge_recon_loss: 35973.6715; train_gene_expr_recon_loss: 362964.6908; train_masked_gp_l1_reg_loss: 5059.3256; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 634834.7680; train_global_loss: 1051326.5691; train_optim_loss: 1051326.5691; val_kl_reg_loss: 10870.3534; val_edge_recon_loss: 36174.6665; val_gene_expr_recon_loss: 374261.1758; val_masked_gp_l1_reg_loss: 5084.2974; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 643170.7734; val_global_loss: 1069561.3047; val_optim_loss: 1069561.3047
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9852; val_auprc_score: 0.9862; val_best_acc_score: 0.9365; val_best_f1_score: 0.9366; train_kl_reg_loss: 12266.5574; train_edge_recon_loss: 35680.9058; train_gene_expr_recon_loss: 361765.0071; train_masked_gp_l1_reg_loss: 5102.8747; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 633200.6506; train_global_loss: 1048015.9972; train_optim_loss: 1048015.9972; val_kl_reg_loss: 10860.5253; val_edge_recon_loss: 35992.4604; val_gene_expr_recon_loss: 374764.6055; val_masked_gp_l1_reg_loss: 5123.7236; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 648078.8125; val_global_loss: 1074820.1172; val_optim_loss: 1074820.1172
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9866; val_auprc_score: 0.9862; val_best_acc_score: 0.9403; val_best_f1_score: 0.9413; train_kl_reg_loss: 12093.1083; train_edge_recon_loss: 35458.8855; train_gene_expr_recon_loss: 360283.3475; train_masked_gp_l1_reg_loss: 5139.8086; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 631597.6572; train_global_loss: 1044572.8087; train_optim_loss: 1044572.8087; val_kl_reg_loss: 10826.1630; val_edge_recon_loss: 35709.1968; val_gene_expr_recon_loss: 369005.4805; val_masked_gp_l1_reg_loss: 5157.7446; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 640980.1172; val_global_loss: 1061678.7109; val_optim_loss: 1061678.7109

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9858; val_auprc_score: 0.9819; val_best_acc_score: 0.9400; val_best_f1_score: 0.9407; train_kl_reg_loss: 11938.5074; train_edge_recon_loss: 35286.9258; train_gene_expr_recon_loss: 358300.8617; train_masked_gp_l1_reg_loss: 5102.7861; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 631074.5095; train_global_loss: 1041703.5909; train_optim_loss: 1041703.5909; val_kl_reg_loss: 10833.8164; val_edge_recon_loss: 35641.7495; val_gene_expr_recon_loss: 369496.5781; val_masked_gp_l1_reg_loss: 5080.7246; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 644180.5938; val_global_loss: 1065233.4531; val_optim_loss: 1065233.4531
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9866; val_auprc_score: 0.9860; val_best_acc_score: 0.9435; val_best_f1_score: 0.9439; train_kl_reg_loss: 11885.1792; train_edge_recon_loss: 35199.2221; train_gene_expr_recon_loss: 358324.2803; train_masked_gp_l1_reg_loss: 5077.1758; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 630712.4612; train_global_loss: 1041198.3248; train_optim_loss: 1041198.3248; val_kl_reg_loss: 10885.7393; val_edge_recon_loss: 35635.5889; val_gene_expr_recon_loss: 372206.9141; val_masked_gp_l1_reg_loss: 5075.2739; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 647716.2969; val_global_loss: 1071519.8281; val_optim_loss: 1071519.8281
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9868; val_auprc_score: 0.9862; val_best_acc_score: 0.9426; val_best_f1_score: 0.9430; train_kl_reg_loss: 11862.1548; train_edge_recon_loss: 35172.2650; train_gene_expr_recon_loss: 357765.4162; train_masked_gp_l1_reg_loss: 5075.8428; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 630815.2794; train_global_loss: 1040690.9574; train_optim_loss: 1040690.9574; val_kl_reg_loss: 10911.1023; val_edge_recon_loss: 35600.3662; val_gene_expr_recon_loss: 371032.1680; val_masked_gp_l1_reg_loss: 5076.5464; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 643838.7031; val_global_loss: 1066458.8672; val_optim_loss: 1066458.8672
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9873; val_auprc_score: 0.9858; val_best_acc_score: 0.9419; val_best_f1_score: 0.9423; train_kl_reg_loss: 11839.1856; train_edge_recon_loss: 35135.7383; train_gene_expr_recon_loss: 357670.8400; train_masked_gp_l1_reg_loss: 5077.7769; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 629586.4432; train_global_loss: 1039309.9830; train_optim_loss: 1039309.9830; val_kl_reg_loss: 10887.0941; val_edge_recon_loss: 35613.4995; val_gene_expr_recon_loss: 373572.1914; val_masked_gp_l1_reg_loss: 5078.6611; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 639741.6328; val_global_loss: 1064893.0703; val_optim_loss: 1064893.0703

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 59 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9776
val AUPRC score: 0.9770
val best accuracy score: 0.9184
val best F1 score: 0.9178
val target rna MSE score: 0.3628
val source rna MSE score: 0.1153
val target atac MSE score: 0.1371
val source atac MSE score: 0.0208
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
