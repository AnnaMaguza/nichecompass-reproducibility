[True]
Run timestamp: 10082023_200809_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7611; val_auprc_score: 0.7813; val_best_acc_score: 0.5019; val_best_f1_score: 0.6673; train_kl_reg_loss: 276489.2310; train_edge_recon_loss: 3764419.7653; train_gene_expr_recon_loss: 28704687.2977; train_masked_gp_l1_reg_loss: 78333.2449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245249.9597; train_chrom_access_recon_loss: 16636453.1603; train_global_loss: 49705632.5496; train_optim_loss: 49705632.5496; val_kl_reg_loss: 104028.7490; val_edge_recon_loss: 4065052.8667; val_gene_expr_recon_loss: 24016010.4000; val_masked_gp_l1_reg_loss: 81404.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239334.5625; val_chrom_access_recon_loss: 15752129.5333; val_global_loss: 44257958.9333; val_optim_loss: 44257958.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7918; val_auprc_score: 0.8105; val_best_acc_score: 0.6081; val_best_f1_score: 0.7077; train_kl_reg_loss: 143933.9054; train_edge_recon_loss: 3604343.6450; train_gene_expr_recon_loss: 23315429.6947; train_masked_gp_l1_reg_loss: 81081.9654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231576.2183; train_chrom_access_recon_loss: 15564455.0534; train_global_loss: 42940820.5802; train_optim_loss: 42940820.5802; val_kl_reg_loss: 158808.7938; val_edge_recon_loss: 4055929.6167; val_gene_expr_recon_loss: 22596942.4000; val_masked_gp_l1_reg_loss: 78455.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 222843.8906; val_chrom_access_recon_loss: 15408998.5333; val_global_loss: 42521979.4667; val_optim_loss: 42521979.4667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8472; val_auprc_score: 0.8555; val_best_acc_score: 0.7515; val_best_f1_score: 0.7354; train_kl_reg_loss: 152865.5359; train_edge_recon_loss: 3548563.6126; train_gene_expr_recon_loss: 22436781.1908; train_masked_gp_l1_reg_loss: 77051.2196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 214019.7425; train_chrom_access_recon_loss: 15360722.8626; train_global_loss: 41790004.0611; train_optim_loss: 41790004.0611; val_kl_reg_loss: 152260.3438; val_edge_recon_loss: 4006195.2333; val_gene_expr_recon_loss: 22235010.0000; val_masked_gp_l1_reg_loss: 76695.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 205221.2656; val_chrom_access_recon_loss: 15349461.6667; val_global_loss: 42024845.0667; val_optim_loss: 42024845.0667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9088; val_auprc_score: 0.9007; val_best_acc_score: 0.8270; val_best_f1_score: 0.8381; train_kl_reg_loss: 130862.0380; train_edge_recon_loss: 3497552.4065; train_gene_expr_recon_loss: 22168242.8702; train_masked_gp_l1_reg_loss: 77842.6666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 196942.0488; train_chrom_access_recon_loss: 15238300.9542; train_global_loss: 41309742.9008; train_optim_loss: 41309742.9008; val_kl_reg_loss: 132286.5177; val_edge_recon_loss: 3654743.2000; val_gene_expr_recon_loss: 22141126.6667; val_masked_gp_l1_reg_loss: 79397.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 188932.2500; val_chrom_access_recon_loss: 15248698.9333; val_global_loss: 41445185.8667; val_optim_loss: 41445185.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8938; val_auprc_score: 0.8842; val_best_acc_score: 0.8098; val_best_f1_score: 0.8221; train_kl_reg_loss: 137719.2642; train_edge_recon_loss: 3124779.6641; train_gene_expr_recon_loss: 21996957.9695; train_masked_gp_l1_reg_loss: 81570.1146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181266.9159; train_chrom_access_recon_loss: 15139473.7786; train_global_loss: 40661767.7557; train_optim_loss: 40661767.7557; val_kl_reg_loss: 160079.9802; val_edge_recon_loss: 3006583.4500; val_gene_expr_recon_loss: 21911413.0667; val_masked_gp_l1_reg_loss: 82759.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173925.6094; val_chrom_access_recon_loss: 15192297.8667; val_global_loss: 40527060.2667; val_optim_loss: 40527060.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9049; val_auprc_score: 0.8897; val_best_acc_score: 0.8266; val_best_f1_score: 0.8383; train_kl_reg_loss: 158735.3355; train_edge_recon_loss: 2979058.6202; train_gene_expr_recon_loss: 21863326.6412; train_masked_gp_l1_reg_loss: 83774.8494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167431.1162; train_chrom_access_recon_loss: 15078475.7405; train_global_loss: 40330802.1069; train_optim_loss: 40330802.1069; val_kl_reg_loss: 161907.5823; val_edge_recon_loss: 2960668.4167; val_gene_expr_recon_loss: 21866033.6000; val_masked_gp_l1_reg_loss: 85038.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161214.5938; val_chrom_access_recon_loss: 15146026.2667; val_global_loss: 40380887.4667; val_optim_loss: 40380887.4667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9106; val_auprc_score: 0.8959; val_best_acc_score: 0.8351; val_best_f1_score: 0.8473; train_kl_reg_loss: 154990.3141; train_edge_recon_loss: 2936909.7424; train_gene_expr_recon_loss: 21735164.4885; train_masked_gp_l1_reg_loss: 86159.3530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155712.0344; train_chrom_access_recon_loss: 15016999.8550; train_global_loss: 40085935.7252; train_optim_loss: 40085935.7252; val_kl_reg_loss: 143448.0000; val_edge_recon_loss: 2939638.6167; val_gene_expr_recon_loss: 21684518.1333; val_masked_gp_l1_reg_loss: 87618.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150294.7812; val_chrom_access_recon_loss: 14975307.6667; val_global_loss: 39980825.0667; val_optim_loss: 39980825.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9135; val_auprc_score: 0.8992; val_best_acc_score: 0.8340; val_best_f1_score: 0.8476; train_kl_reg_loss: 152604.5172; train_edge_recon_loss: 2915407.0763; train_gene_expr_recon_loss: 21609620.5038; train_masked_gp_l1_reg_loss: 88732.6645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145190.2898; train_chrom_access_recon_loss: 14947940.4733; train_global_loss: 39859495.6031; train_optim_loss: 39859495.6031; val_kl_reg_loss: 151836.9667; val_edge_recon_loss: 2915452.9167; val_gene_expr_recon_loss: 21539610.5333; val_masked_gp_l1_reg_loss: 89893.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140095.3438; val_chrom_access_recon_loss: 14969673.6000; val_global_loss: 39806563.7333; val_optim_loss: 39806563.7333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9255; val_auprc_score: 0.9115; val_best_acc_score: 0.8552; val_best_f1_score: 0.8652; train_kl_reg_loss: 149886.2582; train_edge_recon_loss: 2887445.1393; train_gene_expr_recon_loss: 21506303.0229; train_masked_gp_l1_reg_loss: 90904.6128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135456.9430; train_chrom_access_recon_loss: 14893332.7786; train_global_loss: 39663328.5496; train_optim_loss: 39663328.5496; val_kl_reg_loss: 144689.5187; val_edge_recon_loss: 2878897.4000; val_gene_expr_recon_loss: 21392667.6000; val_masked_gp_l1_reg_loss: 92085.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130862.3516; val_chrom_access_recon_loss: 14853243.5333; val_global_loss: 39492446.9333; val_optim_loss: 39492446.9333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9343; val_auprc_score: 0.9205; val_best_acc_score: 0.8655; val_best_f1_score: 0.8730; train_kl_reg_loss: 144122.4247; train_edge_recon_loss: 2869925.5496; train_gene_expr_recon_loss: 21406453.8321; train_masked_gp_l1_reg_loss: 93122.4855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126733.0807; train_chrom_access_recon_loss: 14856095.1298; train_global_loss: 39496452.3359; train_optim_loss: 39496452.3359; val_kl_reg_loss: 141335.8958; val_edge_recon_loss: 2859104.0333; val_gene_expr_recon_loss: 21346962.8000; val_masked_gp_l1_reg_loss: 94263.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122617.6719; val_chrom_access_recon_loss: 14848260.6000; val_global_loss: 39412545.3333; val_optim_loss: 39412545.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9397; val_auprc_score: 0.9257; val_best_acc_score: 0.8762; val_best_f1_score: 0.8826; train_kl_reg_loss: 140966.3974; train_edge_recon_loss: 2848318.1756; train_gene_expr_recon_loss: 21325962.7481; train_masked_gp_l1_reg_loss: 95258.5797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118794.5333; train_chrom_access_recon_loss: 14813934.6794; train_global_loss: 39343235.1145; train_optim_loss: 39343235.1145; val_kl_reg_loss: 140155.3625; val_edge_recon_loss: 2838371.9833; val_gene_expr_recon_loss: 21325334.6667; val_masked_gp_l1_reg_loss: 96275.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115047.2266; val_chrom_access_recon_loss: 14853338.3333; val_global_loss: 39368524.5333; val_optim_loss: 39368524.5333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9431; val_auprc_score: 0.9318; val_best_acc_score: 0.8779; val_best_f1_score: 0.8853; train_kl_reg_loss: 137760.9035; train_edge_recon_loss: 2831953.8511; train_gene_expr_recon_loss: 21226819.4962; train_masked_gp_l1_reg_loss: 97255.1322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111443.3861; train_chrom_access_recon_loss: 14748490.7252; train_global_loss: 39153723.5725; train_optim_loss: 39153723.5725; val_kl_reg_loss: 134211.6854; val_edge_recon_loss: 2834728.6333; val_gene_expr_recon_loss: 21199878.6667; val_masked_gp_l1_reg_loss: 98162.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107939.7500; val_chrom_access_recon_loss: 14763176.5333; val_global_loss: 39138097.6000; val_optim_loss: 39138097.6000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9496; val_auprc_score: 0.9385; val_best_acc_score: 0.8872; val_best_f1_score: 0.8927; train_kl_reg_loss: 135263.4405; train_edge_recon_loss: 2816531.5420; train_gene_expr_recon_loss: 21188200.1374; train_masked_gp_l1_reg_loss: 99043.6708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104656.1341; train_chrom_access_recon_loss: 14749743.0076; train_global_loss: 39093438.0153; train_optim_loss: 39093438.0153; val_kl_reg_loss: 128970.1474; val_edge_recon_loss: 2806898.8167; val_gene_expr_recon_loss: 21114910.8000; val_masked_gp_l1_reg_loss: 100252.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101547.5391; val_chrom_access_recon_loss: 14697057.8667; val_global_loss: 38949637.8667; val_optim_loss: 38949637.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9499; val_auprc_score: 0.9400; val_best_acc_score: 0.8871; val_best_f1_score: 0.8915; train_kl_reg_loss: 131654.6847; train_edge_recon_loss: 2800063.7519; train_gene_expr_recon_loss: 21142036.3359; train_masked_gp_l1_reg_loss: 100925.0382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98690.9132; train_chrom_access_recon_loss: 14722627.8855; train_global_loss: 38995998.7481; train_optim_loss: 38995998.7481; val_kl_reg_loss: 129827.6302; val_edge_recon_loss: 2816730.4167; val_gene_expr_recon_loss: 21147317.6000; val_masked_gp_l1_reg_loss: 102229.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96002.4609; val_chrom_access_recon_loss: 14756279.4667; val_global_loss: 39048387.2000; val_optim_loss: 39048387.2000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9548; val_auprc_score: 0.9439; val_best_acc_score: 0.8946; val_best_f1_score: 0.8982; train_kl_reg_loss: 130243.1834; train_edge_recon_loss: 2793502.9771; train_gene_expr_recon_loss: 21094282.3206; train_masked_gp_l1_reg_loss: 102777.4828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93383.9579; train_chrom_access_recon_loss: 14700376.5115; train_global_loss: 38914566.1374; train_optim_loss: 38914566.1374; val_kl_reg_loss: 133927.5417; val_edge_recon_loss: 2798649.1333; val_gene_expr_recon_loss: 21017112.2667; val_masked_gp_l1_reg_loss: 103523.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90906.3438; val_chrom_access_recon_loss: 14751514.9333; val_global_loss: 38895633.6000; val_optim_loss: 38895633.6000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9572; val_auprc_score: 0.9487; val_best_acc_score: 0.8976; val_best_f1_score: 0.9020; train_kl_reg_loss: 127930.8083; train_edge_recon_loss: 2778788.4962; train_gene_expr_recon_loss: 21024017.3588; train_masked_gp_l1_reg_loss: 104237.6966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88567.4172; train_chrom_access_recon_loss: 14672274.6489; train_global_loss: 38795816.3359; train_optim_loss: 38795816.3359; val_kl_reg_loss: 129457.7047; val_edge_recon_loss: 2800718.6500; val_gene_expr_recon_loss: 20974076.6667; val_masked_gp_l1_reg_loss: 105175.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86281.8984; val_chrom_access_recon_loss: 14659269.6667; val_global_loss: 38754980.5333; val_optim_loss: 38754980.5333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9606; val_auprc_score: 0.9518; val_best_acc_score: 0.9038; val_best_f1_score: 0.9075; train_kl_reg_loss: 125526.5575; train_edge_recon_loss: 2773017.2424; train_gene_expr_recon_loss: 20957697.7099; train_masked_gp_l1_reg_loss: 105754.4392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84138.5803; train_chrom_access_recon_loss: 14644492.8473; train_global_loss: 38690627.3588; train_optim_loss: 38690627.3588; val_kl_reg_loss: 125385.7583; val_edge_recon_loss: 2784126.9167; val_gene_expr_recon_loss: 20928233.8667; val_masked_gp_l1_reg_loss: 106696.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82034.5547; val_chrom_access_recon_loss: 14663655.2667; val_global_loss: 38690131.7333; val_optim_loss: 38690131.7333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9576; val_auprc_score: 0.9426; val_best_acc_score: 0.9037; val_best_f1_score: 0.9076; train_kl_reg_loss: 123774.2412; train_edge_recon_loss: 2761809.6489; train_gene_expr_recon_loss: 20905738.0916; train_masked_gp_l1_reg_loss: 107388.9003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79995.9642; train_chrom_access_recon_loss: 14609378.1450; train_global_loss: 38588084.7328; train_optim_loss: 38588084.7328; val_kl_reg_loss: 123360.9568; val_edge_recon_loss: 2790639.6500; val_gene_expr_recon_loss: 20958882.5333; val_masked_gp_l1_reg_loss: 108076.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77936.6406; val_chrom_access_recon_loss: 14704323.8000; val_global_loss: 38763218.9333; val_optim_loss: 38763218.9333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9645; val_auprc_score: 0.9558; val_best_acc_score: 0.9085; val_best_f1_score: 0.9122; train_kl_reg_loss: 121284.0958; train_edge_recon_loss: 2760263.8187; train_gene_expr_recon_loss: 20900807.0229; train_masked_gp_l1_reg_loss: 108828.4138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76054.0305; train_chrom_access_recon_loss: 14627254.5954; train_global_loss: 38594492.3359; train_optim_loss: 38594492.3359; val_kl_reg_loss: 120330.3266; val_edge_recon_loss: 2762768.1667; val_gene_expr_recon_loss: 20885961.6000; val_masked_gp_l1_reg_loss: 109595.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74223.7344; val_chrom_access_recon_loss: 14677147.0667; val_global_loss: 38630026.6667; val_optim_loss: 38630026.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9635; val_auprc_score: 0.9516; val_best_acc_score: 0.9086; val_best_f1_score: 0.9115; train_kl_reg_loss: 118208.1840; train_edge_recon_loss: 2757290.2176; train_gene_expr_recon_loss: 20837613.0076; train_masked_gp_l1_reg_loss: 110304.1570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72462.4980; train_chrom_access_recon_loss: 14580758.5496; train_global_loss: 38476636.3969; train_optim_loss: 38476636.3969; val_kl_reg_loss: 116626.3109; val_edge_recon_loss: 2769744.7500; val_gene_expr_recon_loss: 20841520.2667; val_masked_gp_l1_reg_loss: 111007.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70706.7969; val_chrom_access_recon_loss: 14615240.2000; val_global_loss: 38524845.3333; val_optim_loss: 38524845.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9688; val_auprc_score: 0.9595; val_best_acc_score: 0.9144; val_best_f1_score: 0.9180; train_kl_reg_loss: 117471.0017; train_edge_recon_loss: 2744725.8187; train_gene_expr_recon_loss: 20830554.1221; train_masked_gp_l1_reg_loss: 111765.5822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69122.7500; train_chrom_access_recon_loss: 14598081.1450; train_global_loss: 38471720.4885; train_optim_loss: 38471720.4885; val_kl_reg_loss: 117810.6609; val_edge_recon_loss: 2742289.7000; val_gene_expr_recon_loss: 20739404.5333; val_masked_gp_l1_reg_loss: 112344.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67548.5625; val_chrom_access_recon_loss: 14550953.4667; val_global_loss: 38330350.6667; val_optim_loss: 38330350.6667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9696; val_auprc_score: 0.9613; val_best_acc_score: 0.9173; val_best_f1_score: 0.9211; train_kl_reg_loss: 115609.4231; train_edge_recon_loss: 2746642.7615; train_gene_expr_recon_loss: 20775579.3282; train_masked_gp_l1_reg_loss: 113131.6799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66117.5601; train_chrom_access_recon_loss: 14554570.7405; train_global_loss: 38371651.5115; train_optim_loss: 38371651.5115; val_kl_reg_loss: 116765.9635; val_edge_recon_loss: 2747915.5333; val_gene_expr_recon_loss: 20718390.9333; val_masked_gp_l1_reg_loss: 113822.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64607.9453; val_chrom_access_recon_loss: 14524561.0000; val_global_loss: 38286063.2000; val_optim_loss: 38286063.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9738; val_auprc_score: 0.9676; val_best_acc_score: 0.9264; val_best_f1_score: 0.9282; train_kl_reg_loss: 114230.6735; train_edge_recon_loss: 2747804.5305; train_gene_expr_recon_loss: 20777367.2824; train_masked_gp_l1_reg_loss: 114461.0610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63306.2836; train_chrom_access_recon_loss: 14573519.2595; train_global_loss: 38390689.1298; train_optim_loss: 38390689.1298; val_kl_reg_loss: 111992.1250; val_edge_recon_loss: 2742203.8833; val_gene_expr_recon_loss: 20819278.8000; val_masked_gp_l1_reg_loss: 115175.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62083.2656; val_chrom_access_recon_loss: 14637938.2000; val_global_loss: 38488672.5333; val_optim_loss: 38488672.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9729; val_auprc_score: 0.9652; val_best_acc_score: 0.9217; val_best_f1_score: 0.9239; train_kl_reg_loss: 112112.5163; train_edge_recon_loss: 2736235.6317; train_gene_expr_recon_loss: 20712281.9084; train_masked_gp_l1_reg_loss: 115848.7016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60853.7764; train_chrom_access_recon_loss: 14527169.2214; train_global_loss: 38264502.0458; train_optim_loss: 38264502.0458; val_kl_reg_loss: 112202.7260; val_edge_recon_loss: 2735766.5000; val_gene_expr_recon_loss: 20689583.4667; val_masked_gp_l1_reg_loss: 116317.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59617.1758; val_chrom_access_recon_loss: 14520630.0000; val_global_loss: 38234119.2000; val_optim_loss: 38234119.2000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9721; val_auprc_score: 0.9646; val_best_acc_score: 0.9228; val_best_f1_score: 0.9250; train_kl_reg_loss: 111964.7550; train_edge_recon_loss: 2728597.4275; train_gene_expr_recon_loss: 20715784.4580; train_masked_gp_l1_reg_loss: 117049.9789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58453.2101; train_chrom_access_recon_loss: 14541159.4656; train_global_loss: 38273009.3435; train_optim_loss: 38273009.3435; val_kl_reg_loss: 110936.0115; val_edge_recon_loss: 2744652.9833; val_gene_expr_recon_loss: 20701921.8667; val_masked_gp_l1_reg_loss: 117874.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57280.1641; val_chrom_access_recon_loss: 14536502.0000; val_global_loss: 38269167.2000; val_optim_loss: 38269167.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9421; val_auprc_score: 0.9316; val_best_acc_score: 0.8774; val_best_f1_score: 0.8812; train_kl_reg_loss: 141210.0011; train_edge_recon_loss: 2950812.8645; train_gene_expr_recon_loss: 22808335.6489; train_masked_gp_l1_reg_loss: 120208.4713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60706.6966; train_chrom_access_recon_loss: 14997073.1450; train_global_loss: 41078347.0229; train_optim_loss: 41078347.0229; val_kl_reg_loss: 18052.5913; val_edge_recon_loss: 2961126.6333; val_gene_expr_recon_loss: 23502960.1333; val_masked_gp_l1_reg_loss: 122666.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64098.8359; val_chrom_access_recon_loss: 15077274.6667; val_global_loss: 41746178.4000; val_optim_loss: 41746178.4000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9432; val_auprc_score: 0.9314; val_best_acc_score: 0.8764; val_best_f1_score: 0.8797; train_kl_reg_loss: 102516.2439; train_edge_recon_loss: 2852517.5649; train_gene_expr_recon_loss: 23774987.7405; train_masked_gp_l1_reg_loss: 121511.0370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64886.2640; train_chrom_access_recon_loss: 15112180.8855; train_global_loss: 42028599.7557; train_optim_loss: 42028599.7557; val_kl_reg_loss: 26823.0628; val_edge_recon_loss: 2822908.7167; val_gene_expr_recon_loss: 23491066.9333; val_masked_gp_l1_reg_loss: 119323.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63248.1250; val_chrom_access_recon_loss: 15066890.4000; val_global_loss: 41590261.6000; val_optim_loss: 41590261.6000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9424; val_auprc_score: 0.9274; val_best_acc_score: 0.8759; val_best_f1_score: 0.8801; train_kl_reg_loss: 76614.6468; train_edge_recon_loss: 2803687.5973; train_gene_expr_recon_loss: 23523175.0229; train_masked_gp_l1_reg_loss: 116551.1289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61246.2533; train_chrom_access_recon_loss: 15090427.2443; train_global_loss: 41671702.0458; train_optim_loss: 41671702.0458; val_kl_reg_loss: 30868.6289; val_edge_recon_loss: 2777346.4000; val_gene_expr_recon_loss: 23257793.6000; val_masked_gp_l1_reg_loss: 113819.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59176.4102; val_chrom_access_recon_loss: 14934241.3333; val_global_loss: 41173245.8667; val_optim_loss: 41173245.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9390; val_auprc_score: 0.9270; val_best_acc_score: 0.8743; val_best_f1_score: 0.8813; train_kl_reg_loss: 69881.3859; train_edge_recon_loss: 2772918.0630; train_gene_expr_recon_loss: 23325208.3664; train_masked_gp_l1_reg_loss: 113230.0344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58846.5158; train_chrom_access_recon_loss: 15028774.5649; train_global_loss: 41368858.8397; train_optim_loss: 41368858.8397; val_kl_reg_loss: 31030.5845; val_edge_recon_loss: 2785939.4333; val_gene_expr_recon_loss: 23195116.4000; val_masked_gp_l1_reg_loss: 112905.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58555.9570; val_chrom_access_recon_loss: 14978030.2000; val_global_loss: 41161579.2000; val_optim_loss: 41161579.2000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9436; val_auprc_score: 0.9331; val_best_acc_score: 0.8775; val_best_f1_score: 0.8841; train_kl_reg_loss: 68586.7711; train_edge_recon_loss: 2767224.6279; train_gene_expr_recon_loss: 23302817.0229; train_masked_gp_l1_reg_loss: 112602.1814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58308.1692; train_chrom_access_recon_loss: 15029309.2824; train_global_loss: 41338847.8779; train_optim_loss: 41338847.8779; val_kl_reg_loss: 31315.4904; val_edge_recon_loss: 2782518.5667; val_gene_expr_recon_loss: 23252806.1333; val_masked_gp_l1_reg_loss: 112294.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58060.4375; val_chrom_access_recon_loss: 15051708.6000; val_global_loss: 41288702.6667; val_optim_loss: 41288702.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9476; val_auprc_score: 0.9380; val_best_acc_score: 0.8787; val_best_f1_score: 0.8848; train_kl_reg_loss: 67633.8460; train_edge_recon_loss: 2769639.5611; train_gene_expr_recon_loss: 23294980.9313; train_masked_gp_l1_reg_loss: 111982.8117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57821.5550; train_chrom_access_recon_loss: 15027989.8473; train_global_loss: 41330048.7023; train_optim_loss: 41330048.7023; val_kl_reg_loss: 31931.1576; val_edge_recon_loss: 2773697.0000; val_gene_expr_recon_loss: 23198422.1333; val_masked_gp_l1_reg_loss: 111657.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57577.4219; val_chrom_access_recon_loss: 14984874.3333; val_global_loss: 41158161.0667; val_optim_loss: 41158161.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9411; val_auprc_score: 0.9259; val_best_acc_score: 0.8754; val_best_f1_score: 0.8818; train_kl_reg_loss: 66996.5419; train_edge_recon_loss: 2766597.9523; train_gene_expr_recon_loss: 23263683.9695; train_masked_gp_l1_reg_loss: 111331.7906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57331.8872; train_chrom_access_recon_loss: 15009030.5344; train_global_loss: 41274972.6718; train_optim_loss: 41274972.6718; val_kl_reg_loss: 32328.1145; val_edge_recon_loss: 2775664.8167; val_gene_expr_recon_loss: 23197565.2000; val_masked_gp_l1_reg_loss: 110996.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57091.6367; val_chrom_access_recon_loss: 15008247.6000; val_global_loss: 41181893.3333; val_optim_loss: 41181893.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 52 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9730
val AUPRC score: 0.9661
val best accuracy score: 0.9210
val best F1 score: 0.9240
val target rna MSE score: 1.6793
val source rna MSE score: 124.8370
val target atac MSE score: 0.3508
val source atac MSE score: 502.0303
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
