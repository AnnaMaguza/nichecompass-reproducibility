[True]
Run timestamp: 07082023_202839_98.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_98']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8905; val_auprc_score: 0.9006; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 208482.1790; train_edge_recon_loss: 356999.4479; train_gene_expr_recon_loss: 1274872.8333; train_masked_gp_l1_reg_loss: 16428.6868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119169.3056; train_chrom_access_recon_loss: 889775.3333; train_global_loss: 2865727.8056; train_optim_loss: 2865727.8056; val_kl_reg_loss: 51019.6172; val_edge_recon_loss: 406584.3438; val_gene_expr_recon_loss: 1133946.3750; val_masked_gp_l1_reg_loss: 12952.8848; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116490.9219; val_chrom_access_recon_loss: 554673.1875; val_global_loss: 2275667.2500; val_optim_loss: 2275667.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8850; val_auprc_score: 0.8945; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 84986.4266; train_edge_recon_loss: 372430.2674; train_gene_expr_recon_loss: 1066292.4306; train_masked_gp_l1_reg_loss: 12087.6527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114988.6172; train_chrom_access_recon_loss: 586465.2431; train_global_loss: 2237250.6667; train_optim_loss: 2237250.6667; val_kl_reg_loss: 101747.1641; val_edge_recon_loss: 406548.1562; val_gene_expr_recon_loss: 940037.0000; val_masked_gp_l1_reg_loss: 11484.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113241.5156; val_chrom_access_recon_loss: 597749.3125; val_global_loss: 2170807.5000; val_optim_loss: 2170807.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8897; val_auprc_score: 0.8965; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 122808.5881; train_edge_recon_loss: 379315.7431; train_gene_expr_recon_loss: 909091.1944; train_masked_gp_l1_reg_loss: 11474.0649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111910.0026; train_chrom_access_recon_loss: 553055.5382; train_global_loss: 2087655.0972; train_optim_loss: 2087655.0972; val_kl_reg_loss: 69918.6172; val_edge_recon_loss: 406550.3750; val_gene_expr_recon_loss: 836782.0000; val_masked_gp_l1_reg_loss: 11374.9229; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110215.6172; val_chrom_access_recon_loss: 506391.2188; val_global_loss: 1941232.7500; val_optim_loss: 1941232.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8831; val_auprc_score: 0.8891; val_best_acc_score: 0.5036; val_best_f1_score: 0.6683; train_kl_reg_loss: 109636.6567; train_edge_recon_loss: 380909.8646; train_gene_expr_recon_loss: 847768.2083; train_masked_gp_l1_reg_loss: 11137.1746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108776.8950; train_chrom_access_recon_loss: 498370.7743; train_global_loss: 1956599.6111; train_optim_loss: 1956599.6111; val_kl_reg_loss: 55890.8477; val_edge_recon_loss: 406525.6875; val_gene_expr_recon_loss: 804830.6875; val_masked_gp_l1_reg_loss: 10880.1572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106909.0469; val_chrom_access_recon_loss: 476720.1562; val_global_loss: 1861756.5000; val_optim_loss: 1861756.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8860; val_auprc_score: 0.8956; val_best_acc_score: 0.5022; val_best_f1_score: 0.6676; train_kl_reg_loss: 97323.5668; train_edge_recon_loss: 385773.4549; train_gene_expr_recon_loss: 809276.7431; train_masked_gp_l1_reg_loss: 10771.4235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105303.5842; train_chrom_access_recon_loss: 478207.1215; train_global_loss: 1886655.9167; train_optim_loss: 1886655.9167; val_kl_reg_loss: 182874.9844; val_edge_recon_loss: 406541.8750; val_gene_expr_recon_loss: 777904.5000; val_masked_gp_l1_reg_loss: 10653.4355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103242.3438; val_chrom_access_recon_loss: 466318.9375; val_global_loss: 1947536.0000; val_optim_loss: 1947536.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8876; val_auprc_score: 0.8975; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 126118.7122; train_edge_recon_loss: 387425.0694; train_gene_expr_recon_loss: 813491.2292; train_masked_gp_l1_reg_loss: 10574.2003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101545.0477; train_chrom_access_recon_loss: 482866.6493; train_global_loss: 1922020.9028; train_optim_loss: 1922020.9028; val_kl_reg_loss: 70523.8516; val_edge_recon_loss: 406522.2812; val_gene_expr_recon_loss: 765827.6250; val_masked_gp_l1_reg_loss: 10477.3350; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99392.0625; val_chrom_access_recon_loss: 460557.0938; val_global_loss: 1813300.3750; val_optim_loss: 1813300.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8827; val_auprc_score: 0.8917; val_best_acc_score: 0.5023; val_best_f1_score: 0.6677; train_kl_reg_loss: 94913.7118; train_edge_recon_loss: 391041.3368; train_gene_expr_recon_loss: 776928.4028; train_masked_gp_l1_reg_loss: 10419.4830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97630.3203; train_chrom_access_recon_loss: 471918.7847; train_global_loss: 1842852.0556; train_optim_loss: 1842852.0556; val_kl_reg_loss: 50542.2539; val_edge_recon_loss: 406543.5000; val_gene_expr_recon_loss: 752158.3125; val_masked_gp_l1_reg_loss: 10345.1309; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95413.8281; val_chrom_access_recon_loss: 456760.6562; val_global_loss: 1771763.6250; val_optim_loss: 1771763.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8792; val_auprc_score: 0.8928; val_best_acc_score: 0.5031; val_best_f1_score: 0.6680; train_kl_reg_loss: 84571.4154; train_edge_recon_loss: 393652.3611; train_gene_expr_recon_loss: 774260.9653; train_masked_gp_l1_reg_loss: 10267.5437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93637.2969; train_chrom_access_recon_loss: 471367.6875; train_global_loss: 1827757.3333; train_optim_loss: 1827757.3333; val_kl_reg_loss: 48395.1484; val_edge_recon_loss: 406532.0000; val_gene_expr_recon_loss: 746318.5000; val_masked_gp_l1_reg_loss: 10177.0566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91418.1562; val_chrom_access_recon_loss: 454829.1562; val_global_loss: 1757669.8750; val_optim_loss: 1757669.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8752; val_auprc_score: 0.8876; val_best_acc_score: 0.5040; val_best_f1_score: 0.6685; train_kl_reg_loss: 53624.8880; train_edge_recon_loss: 396851.1910; train_gene_expr_recon_loss: 746882.5000; train_masked_gp_l1_reg_loss: 10115.1602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89620.1476; train_chrom_access_recon_loss: 457428.7743; train_global_loss: 1754522.6667; train_optim_loss: 1754522.6667; val_kl_reg_loss: 55995.4844; val_edge_recon_loss: 406521.8125; val_gene_expr_recon_loss: 735584.3125; val_masked_gp_l1_reg_loss: 10039.3584; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87374.6875; val_chrom_access_recon_loss: 452089.6562; val_global_loss: 1747605.3750; val_optim_loss: 1747605.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8657; val_auprc_score: 0.8799; val_best_acc_score: 0.5042; val_best_f1_score: 0.6682; train_kl_reg_loss: 133568.7201; train_edge_recon_loss: 395529.6910; train_gene_expr_recon_loss: 751115.6528; train_masked_gp_l1_reg_loss: 9987.2771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85600.2161; train_chrom_access_recon_loss: 458318.3889; train_global_loss: 1834119.9583; train_optim_loss: 1834119.9583; val_kl_reg_loss: 50531.3047; val_edge_recon_loss: 406521.3438; val_gene_expr_recon_loss: 733059.4375; val_masked_gp_l1_reg_loss: 9924.1592; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83386.2969; val_chrom_access_recon_loss: 453132.2812; val_global_loss: 1736554.7500; val_optim_loss: 1736554.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8712; val_auprc_score: 0.8758; val_best_acc_score: 0.5352; val_best_f1_score: 0.6820; train_kl_reg_loss: 57060.7253; train_edge_recon_loss: 396258.8646; train_gene_expr_recon_loss: 748011.5833; train_masked_gp_l1_reg_loss: 9896.6492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81671.2439; train_chrom_access_recon_loss: 466989.8056; train_global_loss: 1759888.8750; train_optim_loss: 1759888.8750; val_kl_reg_loss: 53086.9219; val_edge_recon_loss: 406321.5625; val_gene_expr_recon_loss: 726110.6250; val_masked_gp_l1_reg_loss: 9848.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79562.1172; val_chrom_access_recon_loss: 450509.6250; val_global_loss: 1725438.8750; val_optim_loss: 1725438.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8592; val_auprc_score: 0.8564; val_best_acc_score: 0.5990; val_best_f1_score: 0.7122; train_kl_reg_loss: 69882.1458; train_edge_recon_loss: 390064.6944; train_gene_expr_recon_loss: 728391.4514; train_masked_gp_l1_reg_loss: 9816.4373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77855.9288; train_chrom_access_recon_loss: 453150.8472; train_global_loss: 1729161.5278; train_optim_loss: 1729161.5278; val_kl_reg_loss: 125432.2969; val_edge_recon_loss: 406003.8750; val_gene_expr_recon_loss: 719202.7500; val_masked_gp_l1_reg_loss: 9781.5635; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75739.0703; val_chrom_access_recon_loss: 449090.0312; val_global_loss: 1785249.7500; val_optim_loss: 1785249.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8511; val_auprc_score: 0.8574; val_best_acc_score: 0.5234; val_best_f1_score: 0.6764; train_kl_reg_loss: 357102.5955; train_edge_recon_loss: 390578.4201; train_gene_expr_recon_loss: 755658.0278; train_masked_gp_l1_reg_loss: 9766.5456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74110.4089; train_chrom_access_recon_loss: 466334.3611; train_global_loss: 2053550.4444; train_optim_loss: 2053550.4444; val_kl_reg_loss: 50405.2773; val_edge_recon_loss: 406375.0000; val_gene_expr_recon_loss: 720641.7500; val_masked_gp_l1_reg_loss: 9753.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72096.8906; val_chrom_access_recon_loss: 451987.5938; val_global_loss: 1711260.0000; val_optim_loss: 1711260.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8492; val_auprc_score: 0.8495; val_best_acc_score: 0.5581; val_best_f1_score: 0.6919; train_kl_reg_loss: 89309.0017; train_edge_recon_loss: 395351.2465; train_gene_expr_recon_loss: 743141.7292; train_masked_gp_l1_reg_loss: 9738.1132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70566.1936; train_chrom_access_recon_loss: 460227.7222; train_global_loss: 1768334.0000; train_optim_loss: 1768334.0000; val_kl_reg_loss: 53776.9688; val_edge_recon_loss: 406211.0938; val_gene_expr_recon_loss: 712479.7500; val_masked_gp_l1_reg_loss: 9712.7432; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68669.5234; val_chrom_access_recon_loss: 448458.7500; val_global_loss: 1699308.7500; val_optim_loss: 1699308.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8465; val_auprc_score: 0.8524; val_best_acc_score: 0.5447; val_best_f1_score: 0.6846; train_kl_reg_loss: 481867.5382; train_edge_recon_loss: 388300.6632; train_gene_expr_recon_loss: 779028.6736; train_masked_gp_l1_reg_loss: 9699.7128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67186.9462; train_chrom_access_recon_loss: 464962.1667; train_global_loss: 2191045.7639; train_optim_loss: 2191045.7639; val_kl_reg_loss: 88484.6875; val_edge_recon_loss: 406250.9688; val_gene_expr_recon_loss: 713782.6250; val_masked_gp_l1_reg_loss: 9677.3965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65376.1328; val_chrom_access_recon_loss: 450924.3750; val_global_loss: 1734496.1250; val_optim_loss: 1734496.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8452; val_auprc_score: 0.8524; val_best_acc_score: 0.5354; val_best_f1_score: 0.6796; train_kl_reg_loss: 157529.4484; train_edge_recon_loss: 396390.0729; train_gene_expr_recon_loss: 734727.7014; train_masked_gp_l1_reg_loss: 9658.4903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64003.9670; train_chrom_access_recon_loss: 459744.6771; train_global_loss: 1822054.3750; train_optim_loss: 1822054.3750; val_kl_reg_loss: 227044.4062; val_edge_recon_loss: 406284.5938; val_gene_expr_recon_loss: 708945.2500; val_masked_gp_l1_reg_loss: 9630.6631; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62303.2344; val_chrom_access_recon_loss: 446898.5312; val_global_loss: 1861106.6250; val_optim_loss: 1861106.6250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8442; val_auprc_score: 0.8458; val_best_acc_score: 0.5660; val_best_f1_score: 0.6933; train_kl_reg_loss: 1483292.9384; train_edge_recon_loss: 391189.6111; train_gene_expr_recon_loss: 800028.8958; train_masked_gp_l1_reg_loss: 9623.9170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60975.6298; train_chrom_access_recon_loss: 488280.4861; train_global_loss: 3233391.4444; train_optim_loss: 3233391.4444; val_kl_reg_loss: 57462.1406; val_edge_recon_loss: 406112.4375; val_gene_expr_recon_loss: 703107.3750; val_masked_gp_l1_reg_loss: 9603.4502; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59334.1211; val_chrom_access_recon_loss: 446230.7188; val_global_loss: 1681850.3750; val_optim_loss: 1681850.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8600; val_auprc_score: 0.8594; val_best_acc_score: 0.6316; val_best_f1_score: 0.7252; train_kl_reg_loss: 342398.7578; train_edge_recon_loss: 391022.8993; train_gene_expr_recon_loss: 753222.9514; train_masked_gp_l1_reg_loss: 9577.3875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58094.0000; train_chrom_access_recon_loss: 463076.9618; train_global_loss: 2017392.9583; train_optim_loss: 2017392.9583; val_kl_reg_loss: 133419.2031; val_edge_recon_loss: 405710.7812; val_gene_expr_recon_loss: 703211.2500; val_masked_gp_l1_reg_loss: 9559.8623; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56572.1641; val_chrom_access_recon_loss: 445651.0312; val_global_loss: 1754124.2500; val_optim_loss: 1754124.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8579; val_auprc_score: 0.8589; val_best_acc_score: 0.6254; val_best_f1_score: 0.7213; train_kl_reg_loss: 1616104.2821; train_edge_recon_loss: 387215.8576; train_gene_expr_recon_loss: 747006.7222; train_masked_gp_l1_reg_loss: 9563.6817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55375.5152; train_chrom_access_recon_loss: 464316.7569; train_global_loss: 3279582.7639; train_optim_loss: 3279582.7639; val_kl_reg_loss: 62318.9688; val_edge_recon_loss: 405750.1875; val_gene_expr_recon_loss: 712895.2500; val_masked_gp_l1_reg_loss: 9550.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53885.8906; val_chrom_access_recon_loss: 445335.7500; val_global_loss: 1689737.0000; val_optim_loss: 1689737.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8660; val_auprc_score: 0.8719; val_best_acc_score: 0.6081; val_best_f1_score: 0.7116; train_kl_reg_loss: 936142.2878; train_edge_recon_loss: 393677.7535; train_gene_expr_recon_loss: 741259.5139; train_masked_gp_l1_reg_loss: 9536.2116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52793.8694; train_chrom_access_recon_loss: 472810.7674; train_global_loss: 2606220.5139; train_optim_loss: 2606220.5139; val_kl_reg_loss: 942362.2500; val_edge_recon_loss: 405806.9062; val_gene_expr_recon_loss: 706812.1250; val_masked_gp_l1_reg_loss: 9496.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51520.4883; val_chrom_access_recon_loss: 451343.1562; val_global_loss: 2567341.0000; val_optim_loss: 2567341.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8517; val_auprc_score: 0.8505; val_best_acc_score: 0.6505; val_best_f1_score: 0.7321; train_kl_reg_loss: 10585490.1467; train_edge_recon_loss: 386207.9028; train_gene_expr_recon_loss: 796175.4653; train_masked_gp_l1_reg_loss: 9483.5981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50524.9557; train_chrom_access_recon_loss: 495888.8438; train_global_loss: 12323770.8333; train_optim_loss: 12323770.8333; val_kl_reg_loss: 77601.3438; val_edge_recon_loss: 405511.2812; val_gene_expr_recon_loss: 705570.0000; val_masked_gp_l1_reg_loss: 9471.2393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49272.1797; val_chrom_access_recon_loss: 453500.9688; val_global_loss: 1700927.0000; val_optim_loss: 1700927.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8540; val_auprc_score: 0.8502; val_best_acc_score: 0.6691; val_best_f1_score: 0.7415; train_kl_reg_loss: 69638.4514; train_edge_recon_loss: 396183.7569; train_gene_expr_recon_loss: 702570.1250; train_masked_gp_l1_reg_loss: 9406.8984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49154.4249; train_chrom_access_recon_loss: 447586.4583; train_global_loss: 1674540.1389; train_optim_loss: 1674540.1389; val_kl_reg_loss: 64450.4883; val_edge_recon_loss: 405305.2188; val_gene_expr_recon_loss: 695262.5625; val_masked_gp_l1_reg_loss: 9335.3174; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49000.5391; val_chrom_access_recon_loss: 445222.1250; val_global_loss: 1668576.2500; val_optim_loss: 1668576.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8542; val_auprc_score: 0.8523; val_best_acc_score: 0.7004; val_best_f1_score: 0.7577; train_kl_reg_loss: 64905.7539; train_edge_recon_loss: 391461.8472; train_gene_expr_recon_loss: 690723.5000; train_masked_gp_l1_reg_loss: 9307.6712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48881.6224; train_chrom_access_recon_loss: 440011.5347; train_global_loss: 1645291.9444; train_optim_loss: 1645291.9444; val_kl_reg_loss: 63536.9805; val_edge_recon_loss: 404905.7812; val_gene_expr_recon_loss: 690757.9375; val_masked_gp_l1_reg_loss: 9269.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48733.1211; val_chrom_access_recon_loss: 443098.6250; val_global_loss: 1660302.5000; val_optim_loss: 1660302.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8488; val_auprc_score: 0.8457; val_best_acc_score: 0.7297; val_best_f1_score: 0.7723; train_kl_reg_loss: 65369.8155; train_edge_recon_loss: 383512.6701; train_gene_expr_recon_loss: 690958.7083; train_masked_gp_l1_reg_loss: 9248.2999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48614.9688; train_chrom_access_recon_loss: 443245.7118; train_global_loss: 1640950.1528; train_optim_loss: 1640950.1528; val_kl_reg_loss: 62063.6250; val_edge_recon_loss: 404311.3438; val_gene_expr_recon_loss: 689894.2500; val_masked_gp_l1_reg_loss: 9223.7715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48465.9297; val_chrom_access_recon_loss: 443211.0938; val_global_loss: 1657170.0000; val_optim_loss: 1657170.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8672; val_auprc_score: 0.8614; val_best_acc_score: 0.7831; val_best_f1_score: 0.8010; train_kl_reg_loss: 64857.8876; train_edge_recon_loss: 373332.8958; train_gene_expr_recon_loss: 685901.4097; train_masked_gp_l1_reg_loss: 9209.3655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48347.3155; train_chrom_access_recon_loss: 443621.8438; train_global_loss: 1625270.7222; train_optim_loss: 1625270.7222; val_kl_reg_loss: 62134.4609; val_edge_recon_loss: 403008.8750; val_gene_expr_recon_loss: 689191.3750; val_masked_gp_l1_reg_loss: 9193.8408; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48200.0781; val_chrom_access_recon_loss: 443270.5625; val_global_loss: 1654999.2500; val_optim_loss: 1654999.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8563; val_auprc_score: 0.8574; val_best_acc_score: 0.5918; val_best_f1_score: 0.7062; train_kl_reg_loss: 57949.6480; train_edge_recon_loss: 398496.6319; train_gene_expr_recon_loss: 1003382.1111; train_masked_gp_l1_reg_loss: 9189.3567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48063.3225; train_chrom_access_recon_loss: 461603.0972; train_global_loss: 1978684.2083; train_optim_loss: 1978684.2083; val_kl_reg_loss: 53753.0508; val_edge_recon_loss: 405976.3750; val_gene_expr_recon_loss: 1006562.5000; val_masked_gp_l1_reg_loss: 9193.0381; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47880.2578; val_chrom_access_recon_loss: 463671.2500; val_global_loss: 1987036.5000; val_optim_loss: 1987036.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8510; val_auprc_score: 0.8533; val_best_acc_score: 0.5985; val_best_f1_score: 0.7088; train_kl_reg_loss: 53378.7231; train_edge_recon_loss: 387424.0694; train_gene_expr_recon_loss: 1023104.7083; train_masked_gp_l1_reg_loss: 9209.8011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47724.2370; train_chrom_access_recon_loss: 468395.5035; train_global_loss: 1989237.0417; train_optim_loss: 1989237.0417; val_kl_reg_loss: 49961.9609; val_edge_recon_loss: 405880.5312; val_gene_expr_recon_loss: 1008102.3125; val_masked_gp_l1_reg_loss: 9237.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47527.6406; val_chrom_access_recon_loss: 464397.0625; val_global_loss: 1985107.2500; val_optim_loss: 1985107.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8487; val_auprc_score: 0.8492; val_best_acc_score: 0.5998; val_best_f1_score: 0.7093; train_kl_reg_loss: 50786.1332; train_edge_recon_loss: 388626.3021; train_gene_expr_recon_loss: 1016256.2153; train_masked_gp_l1_reg_loss: 9267.5514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47370.5221; train_chrom_access_recon_loss: 465570.7951; train_global_loss: 1977877.5417; train_optim_loss: 1977877.5417; val_kl_reg_loss: 47977.9766; val_edge_recon_loss: 405914.2812; val_gene_expr_recon_loss: 1007470.1250; val_masked_gp_l1_reg_loss: 9307.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47175.5039; val_chrom_access_recon_loss: 464281.2500; val_global_loss: 1982126.7500; val_optim_loss: 1982126.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8482; val_auprc_score: 0.8473; val_best_acc_score: 0.6055; val_best_f1_score: 0.7124; train_kl_reg_loss: 49868.8494; train_edge_recon_loss: 390689.4444; train_gene_expr_recon_loss: 1013112.0903; train_masked_gp_l1_reg_loss: 9341.8931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47022.0312; train_chrom_access_recon_loss: 462163.7014; train_global_loss: 1972197.9861; train_optim_loss: 1972197.9861; val_kl_reg_loss: 48435.0195; val_edge_recon_loss: 405837.0312; val_gene_expr_recon_loss: 1004766.1875; val_masked_gp_l1_reg_loss: 9385.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46831.8438; val_chrom_access_recon_loss: 463900.2500; val_global_loss: 1979155.3750; val_optim_loss: 1979155.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8515; val_auprc_score: 0.8531; val_best_acc_score: 0.6054; val_best_f1_score: 0.7124; train_kl_reg_loss: 49988.2930; train_edge_recon_loss: 390605.6424; train_gene_expr_recon_loss: 1012823.3194; train_masked_gp_l1_reg_loss: 9382.7673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46813.9648; train_chrom_access_recon_loss: 463713.6771; train_global_loss: 1973327.6528; train_optim_loss: 1973327.6528; val_kl_reg_loss: 48138.1328; val_edge_recon_loss: 405879.3125; val_gene_expr_recon_loss: 1004536.5000; val_masked_gp_l1_reg_loss: 9382.0811; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46791.6367; val_chrom_access_recon_loss: 463854.3438; val_global_loss: 1978582.1250; val_optim_loss: 1978582.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8512; val_auprc_score: 0.8519; val_best_acc_score: 0.6013; val_best_f1_score: 0.7102; train_kl_reg_loss: 49602.1311; train_edge_recon_loss: 390556.8160; train_gene_expr_recon_loss: 1000892.2917; train_masked_gp_l1_reg_loss: 9384.2261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46774.8971; train_chrom_access_recon_loss: 461634.7222; train_global_loss: 1958845.0972; train_optim_loss: 1958845.0972; val_kl_reg_loss: 48177.5781; val_edge_recon_loss: 405907.7812; val_gene_expr_recon_loss: 1004402.5000; val_masked_gp_l1_reg_loss: 9386.3213; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46753.9922; val_chrom_access_recon_loss: 463921.8125; val_global_loss: 1978550.0000; val_optim_loss: 1978550.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8539; val_auprc_score: 0.8532; val_best_acc_score: 0.6040; val_best_f1_score: 0.7116; train_kl_reg_loss: 49407.6619; train_edge_recon_loss: 389961.6528; train_gene_expr_recon_loss: 998570.6319; train_masked_gp_l1_reg_loss: 9388.4214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46737.7092; train_chrom_access_recon_loss: 459532.2222; train_global_loss: 1953598.2778; train_optim_loss: 1953598.2778; val_kl_reg_loss: 48139.9805; val_edge_recon_loss: 405865.5625; val_gene_expr_recon_loss: 1004218.2500; val_masked_gp_l1_reg_loss: 9391.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46717.4609; val_chrom_access_recon_loss: 463868.0312; val_global_loss: 1978200.3750; val_optim_loss: 1978200.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8574; val_auprc_score: 0.8591; val_best_acc_score: 0.6079; val_best_f1_score: 0.7136; train_kl_reg_loss: 49652.3655; train_edge_recon_loss: 388855.3333; train_gene_expr_recon_loss: 1002127.7986; train_masked_gp_l1_reg_loss: 9393.4607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46701.4440; train_chrom_access_recon_loss: 460762.8264; train_global_loss: 1957493.2361; train_optim_loss: 1957493.2361; val_kl_reg_loss: 48186.4883; val_edge_recon_loss: 405858.9688; val_gene_expr_recon_loss: 1004065.8750; val_masked_gp_l1_reg_loss: 9396.4678; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46681.6836; val_chrom_access_recon_loss: 463843.9375; val_global_loss: 1978033.5000; val_optim_loss: 1978033.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 0 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8549
val AUPRC score: 0.8519
val best accuracy score: 0.5756
val best F1 score: 0.6989
val target rna MSE score: 4.1608
val source rna MSE score: 3.6748
val target atac MSE score: 0.1380
val source atac MSE score: 0.0222
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
