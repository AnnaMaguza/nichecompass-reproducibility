[True]
Run timestamp: 07082023_212539_129.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_129']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8692; val_auprc_score: 0.8857; val_best_acc_score: 0.5338; val_best_f1_score: 0.6808; train_kl_reg_loss: 62084.8288; train_edge_recon_loss: 3478374.3889; train_gene_expr_recon_loss: 1334376.5139; train_masked_gp_l1_reg_loss: 4721.7107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167132.7118; train_chrom_access_recon_loss: 2449267.5417; train_global_loss: 7495957.6667; train_optim_loss: 7495957.6667; val_kl_reg_loss: 28224.9121; val_edge_recon_loss: 4063014.5000; val_gene_expr_recon_loss: 1063874.3750; val_masked_gp_l1_reg_loss: 4381.8755; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162842.1875; val_chrom_access_recon_loss: 1542286.6250; val_global_loss: 6864624.5000; val_optim_loss: 6864624.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8627; val_auprc_score: 0.8755; val_best_acc_score: 0.5671; val_best_f1_score: 0.6951; train_kl_reg_loss: 19792.1803; train_edge_recon_loss: 3481818.7778; train_gene_expr_recon_loss: 977757.1250; train_masked_gp_l1_reg_loss: 4330.4692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160233.6458; train_chrom_access_recon_loss: 1479441.8194; train_global_loss: 6123374.2222; train_optim_loss: 6123374.2222; val_kl_reg_loss: 20066.3086; val_edge_recon_loss: 4060317.2500; val_gene_expr_recon_loss: 869435.0000; val_masked_gp_l1_reg_loss: 4338.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156980.2656; val_chrom_access_recon_loss: 1403933.0000; val_global_loss: 6515070.5000; val_optim_loss: 6515070.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8511; val_auprc_score: 0.8649; val_best_acc_score: 0.5893; val_best_f1_score: 0.7051; train_kl_reg_loss: 17669.4146; train_edge_recon_loss: 3481001.8611; train_gene_expr_recon_loss: 860928.5833; train_masked_gp_l1_reg_loss: 4408.5314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154221.3872; train_chrom_access_recon_loss: 1400380.5139; train_global_loss: 5918610.3333; train_optim_loss: 5918610.3333; val_kl_reg_loss: 14790.6143; val_edge_recon_loss: 4058337.7500; val_gene_expr_recon_loss: 813038.7500; val_masked_gp_l1_reg_loss: 4494.8560; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150593.4062; val_chrom_access_recon_loss: 1371975.8750; val_global_loss: 6413231.5000; val_optim_loss: 6413231.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8315; val_auprc_score: 0.8369; val_best_acc_score: 0.6566; val_best_f1_score: 0.7352; train_kl_reg_loss: 18009.9668; train_edge_recon_loss: 3481298.6944; train_gene_expr_recon_loss: 808963.3472; train_masked_gp_l1_reg_loss: 4533.8831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147366.3663; train_chrom_access_recon_loss: 1372843.4167; train_global_loss: 5833015.6111; train_optim_loss: 5833015.6111; val_kl_reg_loss: 20027.6504; val_edge_recon_loss: 4046476.0000; val_gene_expr_recon_loss: 778479.6875; val_masked_gp_l1_reg_loss: 4561.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143135.4219; val_chrom_access_recon_loss: 1355604.0000; val_global_loss: 6348284.5000; val_optim_loss: 6348284.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8050; val_auprc_score: 0.8065; val_best_acc_score: 0.7090; val_best_f1_score: 0.7495; train_kl_reg_loss: 19787.9692; train_edge_recon_loss: 3478003.9167; train_gene_expr_recon_loss: 782177.6458; train_masked_gp_l1_reg_loss: 4567.8394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139505.4931; train_chrom_access_recon_loss: 1360773.6667; train_global_loss: 5784816.5556; train_optim_loss: 5784816.5556; val_kl_reg_loss: 19315.1250; val_edge_recon_loss: 4014746.7500; val_gene_expr_recon_loss: 756684.5000; val_masked_gp_l1_reg_loss: 4570.2397; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134864.0469; val_chrom_access_recon_loss: 1346142.2500; val_global_loss: 6276323.0000; val_optim_loss: 6276323.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8042; val_auprc_score: 0.7889; val_best_acc_score: 0.7132; val_best_f1_score: 0.7618; train_kl_reg_loss: 18451.8342; train_edge_recon_loss: 3467326.1944; train_gene_expr_recon_loss: 763366.1389; train_masked_gp_l1_reg_loss: 4571.6723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131049.8038; train_chrom_access_recon_loss: 1356201.0000; train_global_loss: 5740966.4444; train_optim_loss: 5740966.4444; val_kl_reg_loss: 14578.0547; val_edge_recon_loss: 3897824.2500; val_gene_expr_recon_loss: 743575.5000; val_masked_gp_l1_reg_loss: 4573.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126269.6250; val_chrom_access_recon_loss: 1340602.7500; val_global_loss: 6127424.0000; val_optim_loss: 6127424.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8018; val_auprc_score: 0.7881; val_best_acc_score: 0.7192; val_best_f1_score: 0.7580; train_kl_reg_loss: 12560.4605; train_edge_recon_loss: 3414365.0278; train_gene_expr_recon_loss: 757038.5069; train_masked_gp_l1_reg_loss: 4583.9087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122465.5035; train_chrom_access_recon_loss: 1353386.2361; train_global_loss: 5664399.6111; train_optim_loss: 5664399.6111; val_kl_reg_loss: 8825.5918; val_edge_recon_loss: 3496397.2500; val_gene_expr_recon_loss: 757574.0000; val_masked_gp_l1_reg_loss: 4599.8604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117760.1719; val_chrom_access_recon_loss: 1343606.1250; val_global_loss: 5728763.0000; val_optim_loss: 5728763.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8146; val_auprc_score: 0.8094; val_best_acc_score: 0.7183; val_best_f1_score: 0.7576; train_kl_reg_loss: 11807.5265; train_edge_recon_loss: 3183297.2778; train_gene_expr_recon_loss: 792026.2292; train_masked_gp_l1_reg_loss: 4651.8442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114147.7023; train_chrom_access_recon_loss: 1355509.0139; train_global_loss: 5461439.6667; train_optim_loss: 5461439.6667; val_kl_reg_loss: 18947.9121; val_edge_recon_loss: 3089576.7500; val_gene_expr_recon_loss: 795863.7500; val_masked_gp_l1_reg_loss: 4751.0381; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109765.0781; val_chrom_access_recon_loss: 1352084.7500; val_global_loss: 5370989.0000; val_optim_loss: 5370989.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8423; val_auprc_score: 0.8349; val_best_acc_score: 0.7452; val_best_f1_score: 0.7726; train_kl_reg_loss: 26298.3696; train_edge_recon_loss: 3014177.3056; train_gene_expr_recon_loss: 800206.0972; train_masked_gp_l1_reg_loss: 4801.5050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106464.8724; train_chrom_access_recon_loss: 1363048.3611; train_global_loss: 5314996.5556; train_optim_loss: 5314996.5556; val_kl_reg_loss: 31968.8242; val_edge_recon_loss: 2976592.2500; val_gene_expr_recon_loss: 770100.7500; val_masked_gp_l1_reg_loss: 4837.1147; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102442.5000; val_chrom_access_recon_loss: 1341225.2500; val_global_loss: 5227166.5000; val_optim_loss: 5227166.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8801; val_auprc_score: 0.8664; val_best_acc_score: 0.7948; val_best_f1_score: 0.8081; train_kl_reg_loss: 35315.8214; train_edge_recon_loss: 2908617.7778; train_gene_expr_recon_loss: 780820.0556; train_masked_gp_l1_reg_loss: 4838.3775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99373.4201; train_chrom_access_recon_loss: 1347126.7778; train_global_loss: 5176092.3333; train_optim_loss: 5176092.3333; val_kl_reg_loss: 36293.8906; val_edge_recon_loss: 2880336.2500; val_gene_expr_recon_loss: 761932.6250; val_masked_gp_l1_reg_loss: 4832.4404; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95637.0469; val_chrom_access_recon_loss: 1336709.8750; val_global_loss: 5115742.5000; val_optim_loss: 5115742.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9214; val_auprc_score: 0.8974; val_best_acc_score: 0.8597; val_best_f1_score: 0.8690; train_kl_reg_loss: 39367.8785; train_edge_recon_loss: 2776877.6111; train_gene_expr_recon_loss: 770069.3889; train_masked_gp_l1_reg_loss: 4829.6470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92803.1128; train_chrom_access_recon_loss: 1350857.6389; train_global_loss: 5034805.4444; train_optim_loss: 5034805.4444; val_kl_reg_loss: 37875.6953; val_edge_recon_loss: 2774821.5000; val_gene_expr_recon_loss: 750702.6250; val_masked_gp_l1_reg_loss: 4834.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89368.3438; val_chrom_access_recon_loss: 1331251.0000; val_global_loss: 4988853.0000; val_optim_loss: 4988853.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9334; val_auprc_score: 0.9116; val_best_acc_score: 0.8740; val_best_f1_score: 0.8815; train_kl_reg_loss: 42144.0642; train_edge_recon_loss: 2747330.5833; train_gene_expr_recon_loss: 759800.9792; train_masked_gp_l1_reg_loss: 4844.8393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86759.7891; train_chrom_access_recon_loss: 1336507.0833; train_global_loss: 4977387.2778; train_optim_loss: 4977387.2778; val_kl_reg_loss: 42022.9492; val_edge_recon_loss: 2756089.2500; val_gene_expr_recon_loss: 737630.3750; val_masked_gp_l1_reg_loss: 4847.6196; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83582.2031; val_chrom_access_recon_loss: 1326175.2500; val_global_loss: 4950347.5000; val_optim_loss: 4950347.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9356; val_auprc_score: 0.9135; val_best_acc_score: 0.8822; val_best_f1_score: 0.8890; train_kl_reg_loss: 45380.1927; train_edge_recon_loss: 2724719.4722; train_gene_expr_recon_loss: 743864.5486; train_masked_gp_l1_reg_loss: 4846.1035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81177.1849; train_chrom_access_recon_loss: 1333733.5139; train_global_loss: 4933721.0556; train_optim_loss: 4933721.0556; val_kl_reg_loss: 43750.7500; val_edge_recon_loss: 2730648.2500; val_gene_expr_recon_loss: 727133.5625; val_masked_gp_l1_reg_loss: 4836.7769; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78239.2266; val_chrom_access_recon_loss: 1321553.6250; val_global_loss: 4906162.0000; val_optim_loss: 4906162.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9400; val_auprc_score: 0.9177; val_best_acc_score: 0.8857; val_best_f1_score: 0.8923; train_kl_reg_loss: 45864.9310; train_edge_recon_loss: 2728468.8333; train_gene_expr_recon_loss: 734692.7708; train_masked_gp_l1_reg_loss: 4825.0487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76038.9158; train_chrom_access_recon_loss: 1328516.1806; train_global_loss: 4918406.6111; train_optim_loss: 4918406.6111; val_kl_reg_loss: 43366.6562; val_edge_recon_loss: 2713353.2500; val_gene_expr_recon_loss: 719768.7500; val_masked_gp_l1_reg_loss: 4807.9067; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73354.2500; val_chrom_access_recon_loss: 1317517.0000; val_global_loss: 4872168.0000; val_optim_loss: 4872168.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9388; val_auprc_score: 0.9178; val_best_acc_score: 0.8809; val_best_f1_score: 0.8872; train_kl_reg_loss: 44600.2257; train_edge_recon_loss: 2735442.9444; train_gene_expr_recon_loss: 726693.2083; train_masked_gp_l1_reg_loss: 4805.2541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71345.3194; train_chrom_access_recon_loss: 1328744.1528; train_global_loss: 4911631.1111; train_optim_loss: 4911631.1111; val_kl_reg_loss: 41128.0273; val_edge_recon_loss: 2739933.5000; val_gene_expr_recon_loss: 716139.7500; val_masked_gp_l1_reg_loss: 4798.2471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68901.5703; val_chrom_access_recon_loss: 1315198.8750; val_global_loss: 4886100.0000; val_optim_loss: 4886100.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9374; val_auprc_score: 0.9162; val_best_acc_score: 0.8769; val_best_f1_score: 0.8841; train_kl_reg_loss: 43087.2943; train_edge_recon_loss: 2720947.7778; train_gene_expr_recon_loss: 721524.4514; train_masked_gp_l1_reg_loss: 4796.1475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67086.1042; train_chrom_access_recon_loss: 1320630.3056; train_global_loss: 4878072.1111; train_optim_loss: 4878072.1111; val_kl_reg_loss: 40575.3594; val_edge_recon_loss: 2757716.5000; val_gene_expr_recon_loss: 712009.2500; val_masked_gp_l1_reg_loss: 4797.4048; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64877.7344; val_chrom_access_recon_loss: 1312616.5000; val_global_loss: 4892593.0000; val_optim_loss: 4892593.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9436; val_auprc_score: 0.9226; val_best_acc_score: 0.8861; val_best_f1_score: 0.8923; train_kl_reg_loss: 43477.5230; train_edge_recon_loss: 2717331.5278; train_gene_expr_recon_loss: 717412.7778; train_masked_gp_l1_reg_loss: 4805.2160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63231.3372; train_chrom_access_recon_loss: 1322742.2222; train_global_loss: 4869000.5556; train_optim_loss: 4869000.5556; val_kl_reg_loss: 40987.0508; val_edge_recon_loss: 2739012.7500; val_gene_expr_recon_loss: 705665.8750; val_masked_gp_l1_reg_loss: 4810.7466; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61223.0547; val_chrom_access_recon_loss: 1308601.7500; val_global_loss: 4860301.0000; val_optim_loss: 4860301.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9462; val_auprc_score: 0.9269; val_best_acc_score: 0.8884; val_best_f1_score: 0.8947; train_kl_reg_loss: 42516.3707; train_edge_recon_loss: 2716709.1667; train_gene_expr_recon_loss: 713221.3056; train_masked_gp_l1_reg_loss: 4821.3280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59715.7387; train_chrom_access_recon_loss: 1317420.5556; train_global_loss: 4854404.5556; train_optim_loss: 4854404.5556; val_kl_reg_loss: 40440.2578; val_edge_recon_loss: 2752134.2500; val_gene_expr_recon_loss: 702425.7500; val_masked_gp_l1_reg_loss: 4830.3794; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57878.3008; val_chrom_access_recon_loss: 1306382.3750; val_global_loss: 4864091.5000; val_optim_loss: 4864091.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9441; val_auprc_score: 0.9226; val_best_acc_score: 0.8890; val_best_f1_score: 0.8952; train_kl_reg_loss: 41539.9167; train_edge_recon_loss: 2718938.1389; train_gene_expr_recon_loss: 707324.1597; train_masked_gp_l1_reg_loss: 4843.4879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56494.6007; train_chrom_access_recon_loss: 1311805.8750; train_global_loss: 4840946.1667; train_optim_loss: 4840946.1667; val_kl_reg_loss: 39391.3984; val_edge_recon_loss: 2721473.0000; val_gene_expr_recon_loss: 699435.0000; val_masked_gp_l1_reg_loss: 4852.3994; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54797.6133; val_chrom_access_recon_loss: 1303864.0000; val_global_loss: 4823813.5000; val_optim_loss: 4823813.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9526; val_auprc_score: 0.9379; val_best_acc_score: 0.8977; val_best_f1_score: 0.9032; train_kl_reg_loss: 41603.3325; train_edge_recon_loss: 2720686.8889; train_gene_expr_recon_loss: 704062.2847; train_masked_gp_l1_reg_loss: 4866.2865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53510.3242; train_chrom_access_recon_loss: 1312059.4583; train_global_loss: 4836788.5556; train_optim_loss: 4836788.5556; val_kl_reg_loss: 40011.3281; val_edge_recon_loss: 2711566.5000; val_gene_expr_recon_loss: 695676.4375; val_masked_gp_l1_reg_loss: 4879.0801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51937.8984; val_chrom_access_recon_loss: 1300797.1250; val_global_loss: 4804868.5000; val_optim_loss: 4804868.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9487; val_auprc_score: 0.9269; val_best_acc_score: 0.8968; val_best_f1_score: 0.9016; train_kl_reg_loss: 41505.8711; train_edge_recon_loss: 2727125.6667; train_gene_expr_recon_loss: 701712.0556; train_masked_gp_l1_reg_loss: 4897.0097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50768.3633; train_chrom_access_recon_loss: 1305842.8194; train_global_loss: 4831851.8889; train_optim_loss: 4831851.8889; val_kl_reg_loss: 39630.8281; val_edge_recon_loss: 2729058.0000; val_gene_expr_recon_loss: 693446.1250; val_masked_gp_l1_reg_loss: 4911.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49337.3359; val_chrom_access_recon_loss: 1299323.5000; val_global_loss: 4815707.0000; val_optim_loss: 4815707.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9527; val_auprc_score: 0.9348; val_best_acc_score: 0.8961; val_best_f1_score: 0.9005; train_kl_reg_loss: 41664.1133; train_edge_recon_loss: 2721618.8333; train_gene_expr_recon_loss: 697671.5972; train_masked_gp_l1_reg_loss: 4929.4312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48260.1879; train_chrom_access_recon_loss: 1309911.6806; train_global_loss: 4824055.8333; train_optim_loss: 4824055.8333; val_kl_reg_loss: 39847.6680; val_edge_recon_loss: 2728125.7500; val_gene_expr_recon_loss: 691056.3750; val_masked_gp_l1_reg_loss: 4944.9683; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46933.4180; val_chrom_access_recon_loss: 1296371.7500; val_global_loss: 4807280.0000; val_optim_loss: 4807280.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9508; val_auprc_score: 0.9340; val_best_acc_score: 0.8960; val_best_f1_score: 0.9007; train_kl_reg_loss: 40778.1589; train_edge_recon_loss: 2721135.2222; train_gene_expr_recon_loss: 697045.5139; train_masked_gp_l1_reg_loss: 4966.8040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45944.9527; train_chrom_access_recon_loss: 1307820.9028; train_global_loss: 4817691.5000; train_optim_loss: 4817691.5000; val_kl_reg_loss: 38674.2656; val_edge_recon_loss: 2745119.2500; val_gene_expr_recon_loss: 688830.1250; val_masked_gp_l1_reg_loss: 4982.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44729.8984; val_chrom_access_recon_loss: 1294697.7500; val_global_loss: 4817033.5000; val_optim_loss: 4817033.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9520; val_auprc_score: 0.9354; val_best_acc_score: 0.8971; val_best_f1_score: 0.9030; train_kl_reg_loss: 40956.6098; train_edge_recon_loss: 2714290.8889; train_gene_expr_recon_loss: 698388.6736; train_masked_gp_l1_reg_loss: 5003.4653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43805.9609; train_chrom_access_recon_loss: 1306910.4722; train_global_loss: 4809356.0556; train_optim_loss: 4809356.0556; val_kl_reg_loss: 40569.5703; val_edge_recon_loss: 2719879.7500; val_gene_expr_recon_loss: 685927.9375; val_masked_gp_l1_reg_loss: 5021.1582; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42674.0625; val_chrom_access_recon_loss: 1291750.7500; val_global_loss: 4785823.0000; val_optim_loss: 4785823.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9563; val_auprc_score: 0.9409; val_best_acc_score: 0.8985; val_best_f1_score: 0.9050; train_kl_reg_loss: 41527.6510; train_edge_recon_loss: 2710326.5556; train_gene_expr_recon_loss: 692030.4306; train_masked_gp_l1_reg_loss: 5040.3795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41825.5017; train_chrom_access_recon_loss: 1301573.3889; train_global_loss: 4792324.0000; train_optim_loss: 4792324.0000; val_kl_reg_loss: 39673.0703; val_edge_recon_loss: 2702554.2500; val_gene_expr_recon_loss: 683422.2500; val_masked_gp_l1_reg_loss: 5054.7710; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40779.6914; val_chrom_access_recon_loss: 1290186.8750; val_global_loss: 4761671.0000; val_optim_loss: 4761671.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9606; val_auprc_score: 0.9493; val_best_acc_score: 0.9042; val_best_f1_score: 0.9089; train_kl_reg_loss: 39639.1515; train_edge_recon_loss: 2729601.1111; train_gene_expr_recon_loss: 1016695.2292; train_masked_gp_l1_reg_loss: 5084.8056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39718.4271; train_chrom_access_recon_loss: 1380287.2083; train_global_loss: 5211025.9444; train_optim_loss: 5211025.9444; val_kl_reg_loss: 14882.4307; val_edge_recon_loss: 2704130.7500; val_gene_expr_recon_loss: 991075.0000; val_masked_gp_l1_reg_loss: 5126.6235; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38256.8047; val_chrom_access_recon_loss: 1365717.5000; val_global_loss: 5119189.0000; val_optim_loss: 5119189.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9595; val_auprc_score: 0.9455; val_best_acc_score: 0.9084; val_best_f1_score: 0.9126; train_kl_reg_loss: 35949.7843; train_edge_recon_loss: 2703835.3056; train_gene_expr_recon_loss: 1010672.7431; train_masked_gp_l1_reg_loss: 5160.1544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37012.3186; train_chrom_access_recon_loss: 1376202.0972; train_global_loss: 5168832.3333; train_optim_loss: 5168832.3333; val_kl_reg_loss: 13840.1191; val_edge_recon_loss: 2708727.0000; val_gene_expr_recon_loss: 990416.0000; val_masked_gp_l1_reg_loss: 5201.8848; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35472.6875; val_chrom_access_recon_loss: 1365445.2500; val_global_loss: 5119103.0000; val_optim_loss: 5119103.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9633; val_auprc_score: 0.9517; val_best_acc_score: 0.9120; val_best_f1_score: 0.9153; train_kl_reg_loss: 32307.1819; train_edge_recon_loss: 2698738.0833; train_gene_expr_recon_loss: 1003367.1181; train_masked_gp_l1_reg_loss: 5235.6053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34298.6024; train_chrom_access_recon_loss: 1373993.5139; train_global_loss: 5147940.0556; train_optim_loss: 5147940.0556; val_kl_reg_loss: 12825.8574; val_edge_recon_loss: 2698468.0000; val_gene_expr_recon_loss: 991141.0000; val_masked_gp_l1_reg_loss: 5274.4087; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32877.9922; val_chrom_access_recon_loss: 1365123.0000; val_global_loss: 5105710.0000; val_optim_loss: 5105710.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9661; val_auprc_score: 0.9575; val_best_acc_score: 0.9109; val_best_f1_score: 0.9136; train_kl_reg_loss: 29271.9149; train_edge_recon_loss: 2698932.5833; train_gene_expr_recon_loss: 1001131.4514; train_masked_gp_l1_reg_loss: 5297.1747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31827.3336; train_chrom_access_recon_loss: 1370144.9861; train_global_loss: 5136605.5000; train_optim_loss: 5136605.5000; val_kl_reg_loss: 12831.4307; val_edge_recon_loss: 2705006.0000; val_gene_expr_recon_loss: 988588.7500; val_masked_gp_l1_reg_loss: 5321.2568; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30566.0117; val_chrom_access_recon_loss: 1363570.2500; val_global_loss: 5105884.0000; val_optim_loss: 5105884.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9667; val_auprc_score: 0.9569; val_best_acc_score: 0.9147; val_best_f1_score: 0.9172; train_kl_reg_loss: 27941.3520; train_edge_recon_loss: 2684889.2500; train_gene_expr_recon_loss: 1003755.5000; train_masked_gp_l1_reg_loss: 5313.0634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30383.0362; train_chrom_access_recon_loss: 1376536.1806; train_global_loss: 5128818.3889; train_optim_loss: 5128818.3889; val_kl_reg_loss: 13029.8271; val_edge_recon_loss: 2702854.0000; val_gene_expr_recon_loss: 989418.3125; val_masked_gp_l1_reg_loss: 5303.9409; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30175.8867; val_chrom_access_recon_loss: 1363529.6250; val_global_loss: 5104311.5000; val_optim_loss: 5104311.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9687; val_auprc_score: 0.9584; val_best_acc_score: 0.9179; val_best_f1_score: 0.9203; train_kl_reg_loss: 27727.8355; train_edge_recon_loss: 2682801.5556; train_gene_expr_recon_loss: 1002606.7153; train_masked_gp_l1_reg_loss: 5301.0523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30044.9021; train_chrom_access_recon_loss: 1374944.1250; train_global_loss: 5123426.2778; train_optim_loss: 5123426.2778; val_kl_reg_loss: 12856.4395; val_edge_recon_loss: 2695375.0000; val_gene_expr_recon_loss: 989674.0000; val_masked_gp_l1_reg_loss: 5296.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29877.3828; val_chrom_access_recon_loss: 1364054.7500; val_global_loss: 5097134.5000; val_optim_loss: 5097134.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9675; val_auprc_score: 0.9543; val_best_acc_score: 0.9185; val_best_f1_score: 0.9197; train_kl_reg_loss: 27468.6599; train_edge_recon_loss: 2683036.6389; train_gene_expr_recon_loss: 1002565.2014; train_masked_gp_l1_reg_loss: 5294.4159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29755.7183; train_chrom_access_recon_loss: 1381289.3333; train_global_loss: 5129410.1111; train_optim_loss: 5129410.1111; val_kl_reg_loss: 12848.5010; val_edge_recon_loss: 2704911.2500; val_gene_expr_recon_loss: 988902.7500; val_masked_gp_l1_reg_loss: 5291.5371; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29606.9727; val_chrom_access_recon_loss: 1363528.1250; val_global_loss: 5105089.0000; val_optim_loss: 5105089.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9685; val_auprc_score: 0.9587; val_best_acc_score: 0.9148; val_best_f1_score: 0.9171; train_kl_reg_loss: 27047.5831; train_edge_recon_loss: 2691635.8611; train_gene_expr_recon_loss: 998437.0764; train_masked_gp_l1_reg_loss: 5289.6293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29494.0178; train_chrom_access_recon_loss: 1373878.9583; train_global_loss: 5125783.0556; train_optim_loss: 5125783.0556; val_kl_reg_loss: 12770.2441; val_edge_recon_loss: 2700584.5000; val_gene_expr_recon_loss: 988915.1250; val_masked_gp_l1_reg_loss: 5287.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29359.1309; val_chrom_access_recon_loss: 1363361.7500; val_global_loss: 5100278.5000; val_optim_loss: 5100278.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 36 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9562
val AUPRC score: 0.9438
val best accuracy score: 0.8965
val best F1 score: 0.9014
val target rna MSE score: 3.7171
val source rna MSE score: 3.1104
val target atac MSE score: 0.1308
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
