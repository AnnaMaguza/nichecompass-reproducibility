[True]
Run timestamp: 26072023_033429_129.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_129']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9689; val_auprc_score: 0.9680; val_best_acc_score: 0.8065; val_best_f1_score: 0.7619; train_kl_reg_loss: 1839.4101; train_edge_recon_loss: 34666187.1111; train_gene_expr_recon_loss: 3204699.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1083613.0000; train_global_loss: 38956337.7778; train_optim_loss: 38956337.7778; val_kl_reg_loss: 1045.0405; val_edge_recon_loss: 40250252.0000; val_gene_expr_recon_loss: 3118283.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1060921.7500; val_global_loss: 44430500.0000; val_optim_loss: 44430500.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9202; val_auprc_score: 0.9121; val_best_acc_score: 0.8375; val_best_f1_score: 0.8438; train_kl_reg_loss: 1119.7367; train_edge_recon_loss: 34553532.0000; train_gene_expr_recon_loss: 3126662.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1077414.6944; train_global_loss: 38758728.0000; train_optim_loss: 38758728.0000; val_kl_reg_loss: 910.4630; val_edge_recon_loss: 35514960.0000; val_gene_expr_recon_loss: 3028626.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1055912.5000; val_global_loss: 39600412.0000; val_optim_loss: 39600412.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8768; val_auprc_score: 0.8693; val_best_acc_score: 0.7753; val_best_f1_score: 0.7946; train_kl_reg_loss: 3425.3966; train_edge_recon_loss: 32080629.5556; train_gene_expr_recon_loss: 3030868.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1071429.5347; train_global_loss: 36186352.4444; train_optim_loss: 36186352.4444; val_kl_reg_loss: 10605.4434; val_edge_recon_loss: 28795942.0000; val_gene_expr_recon_loss: 2941970.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1053243.8750; val_global_loss: 32801762.0000; val_optim_loss: 32801762.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8829; val_auprc_score: 0.8625; val_best_acc_score: 0.7926; val_best_f1_score: 0.8104; train_kl_reg_loss: 25460.0397; train_edge_recon_loss: 28450215.1111; train_gene_expr_recon_loss: 3002607.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1070522.5069; train_global_loss: 32548805.1111; train_optim_loss: 32548805.1111; val_kl_reg_loss: 42945.4180; val_edge_recon_loss: 28259424.0000; val_gene_expr_recon_loss: 2928074.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048144.2500; val_global_loss: 32278588.0000; val_optim_loss: 32278588.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9036; val_auprc_score: 0.8768; val_best_acc_score: 0.8372; val_best_f1_score: 0.8487; train_kl_reg_loss: 53807.6037; train_edge_recon_loss: 27792296.4444; train_gene_expr_recon_loss: 2904399.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1063821.3333; train_global_loss: 31814324.2222; train_optim_loss: 31814324.2222; val_kl_reg_loss: 57878.8594; val_edge_recon_loss: 27615126.0000; val_gene_expr_recon_loss: 2821038.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1043196.1250; val_global_loss: 31537238.0000; val_optim_loss: 31537238.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9185; val_auprc_score: 0.8905; val_best_acc_score: 0.8557; val_best_f1_score: 0.8668; train_kl_reg_loss: 63970.7070; train_edge_recon_loss: 27331353.1111; train_gene_expr_recon_loss: 2820605.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058070.4792; train_global_loss: 31274000.4444; train_optim_loss: 31274000.4444; val_kl_reg_loss: 63192.7422; val_edge_recon_loss: 27330646.0000; val_gene_expr_recon_loss: 2725387.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1034307.1250; val_global_loss: 31153534.0000; val_optim_loss: 31153534.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9286; val_auprc_score: 0.9063; val_best_acc_score: 0.8634; val_best_f1_score: 0.8715; train_kl_reg_loss: 68477.5152; train_edge_recon_loss: 27161467.1111; train_gene_expr_recon_loss: 2740018.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1056896.1875; train_global_loss: 31026859.3333; train_optim_loss: 31026859.3333; val_kl_reg_loss: 68184.2266; val_edge_recon_loss: 27092838.0000; val_gene_expr_recon_loss: 2680362.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1030432.5000; val_global_loss: 30871816.0000; val_optim_loss: 30871816.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9250; val_auprc_score: 0.9003; val_best_acc_score: 0.8611; val_best_f1_score: 0.8733; train_kl_reg_loss: 71824.3411; train_edge_recon_loss: 27116965.3333; train_gene_expr_recon_loss: 2700558.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048907.1667; train_global_loss: 30938255.3333; train_optim_loss: 30938255.3333; val_kl_reg_loss: 71665.7344; val_edge_recon_loss: 27410570.0000; val_gene_expr_recon_loss: 2613676.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1024843.8125; val_global_loss: 31120756.0000; val_optim_loss: 31120756.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9289; val_auprc_score: 0.9034; val_best_acc_score: 0.8676; val_best_f1_score: 0.8776; train_kl_reg_loss: 75042.8498; train_edge_recon_loss: 27177115.3333; train_gene_expr_recon_loss: 2641859.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1039688.6597; train_global_loss: 30933706.2222; train_optim_loss: 30933706.2222; val_kl_reg_loss: 73595.4375; val_edge_recon_loss: 27228114.0000; val_gene_expr_recon_loss: 2585083.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022177.5000; val_global_loss: 30908972.0000; val_optim_loss: 30908972.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9312; val_auprc_score: 0.9015; val_best_acc_score: 0.8738; val_best_f1_score: 0.8817; train_kl_reg_loss: 77725.5946; train_edge_recon_loss: 26965431.5556; train_gene_expr_recon_loss: 2614499.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043632.3542; train_global_loss: 30701289.3333; train_optim_loss: 30701289.3333; val_kl_reg_loss: 73233.1406; val_edge_recon_loss: 27299162.0000; val_gene_expr_recon_loss: 2547132.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018290.9375; val_global_loss: 30937818.0000; val_optim_loss: 30937818.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9350; val_auprc_score: 0.9125; val_best_acc_score: 0.8751; val_best_f1_score: 0.8831; train_kl_reg_loss: 76650.6875; train_edge_recon_loss: 26983393.5556; train_gene_expr_recon_loss: 2559948.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1033938.7917; train_global_loss: 30653931.1111; train_optim_loss: 30653931.1111; val_kl_reg_loss: 74306.8125; val_edge_recon_loss: 27327984.0000; val_gene_expr_recon_loss: 2495055.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015321.0000; val_global_loss: 30912668.0000; val_optim_loss: 30912668.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9403; val_auprc_score: 0.9176; val_best_acc_score: 0.8820; val_best_f1_score: 0.8890; train_kl_reg_loss: 77291.3993; train_edge_recon_loss: 27008798.4444; train_gene_expr_recon_loss: 2541703.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1032560.9306; train_global_loss: 30660353.1111; train_optim_loss: 30660353.1111; val_kl_reg_loss: 73610.7578; val_edge_recon_loss: 27143520.0000; val_gene_expr_recon_loss: 2511801.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014725.1250; val_global_loss: 30743658.0000; val_optim_loss: 30743658.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9346; val_auprc_score: 0.9083; val_best_acc_score: 0.8798; val_best_f1_score: 0.8870; train_kl_reg_loss: 76538.2995; train_edge_recon_loss: 26992158.8889; train_gene_expr_recon_loss: 2540052.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1036316.7500; train_global_loss: 30645065.5556; train_optim_loss: 30645065.5556; val_kl_reg_loss: 74631.4531; val_edge_recon_loss: 27187706.0000; val_gene_expr_recon_loss: 2495570.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1015385.1250; val_global_loss: 30773294.0000; val_optim_loss: 30773294.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9353; val_auprc_score: 0.9109; val_best_acc_score: 0.8805; val_best_f1_score: 0.8879; train_kl_reg_loss: 77537.5217; train_edge_recon_loss: 26946851.7778; train_gene_expr_recon_loss: 2538505.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1033192.0417; train_global_loss: 30596086.8889; train_optim_loss: 30596086.8889; val_kl_reg_loss: 73629.8594; val_edge_recon_loss: 27135256.0000; val_gene_expr_recon_loss: 2503211.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014589.0625; val_global_loss: 30726688.0000; val_optim_loss: 30726688.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9369; val_auprc_score: 0.9135; val_best_acc_score: 0.8818; val_best_f1_score: 0.8886; train_kl_reg_loss: 76085.4158; train_edge_recon_loss: 26962609.1111; train_gene_expr_recon_loss: 2528970.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1026805.0625; train_global_loss: 30594470.4444; train_optim_loss: 30594470.4444; val_kl_reg_loss: 73879.2344; val_edge_recon_loss: 27120808.0000; val_gene_expr_recon_loss: 2490938.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1012181.6875; val_global_loss: 30697808.0000; val_optim_loss: 30697808.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9384; val_auprc_score: 0.9130; val_best_acc_score: 0.8863; val_best_f1_score: 0.8924; train_kl_reg_loss: 77826.0573; train_edge_recon_loss: 27007166.6667; train_gene_expr_recon_loss: 2527850.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1031436.2778; train_global_loss: 30644279.5556; train_optim_loss: 30644279.5556; val_kl_reg_loss: 73464.4844; val_edge_recon_loss: 26996254.0000; val_gene_expr_recon_loss: 2495406.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013552.0000; val_global_loss: 30578676.0000; val_optim_loss: 30578676.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9462; val_auprc_score: 0.9264; val_best_acc_score: 0.8899; val_best_f1_score: 0.8962; train_kl_reg_loss: 77875.8273; train_edge_recon_loss: 27051536.6667; train_gene_expr_recon_loss: 2525817.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1033038.3542; train_global_loss: 30688268.2222; train_optim_loss: 30688268.2222; val_kl_reg_loss: 74073.0938; val_edge_recon_loss: 26943872.0000; val_gene_expr_recon_loss: 2485986.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1012233.3750; val_global_loss: 30516166.0000; val_optim_loss: 30516166.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9388; val_auprc_score: 0.9138; val_best_acc_score: 0.8822; val_best_f1_score: 0.8891; train_kl_reg_loss: 77572.1224; train_edge_recon_loss: 26909930.2222; train_gene_expr_recon_loss: 2516988.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1031488.2639; train_global_loss: 30535979.5556; train_optim_loss: 30535979.5556; val_kl_reg_loss: 74419.6406; val_edge_recon_loss: 27424998.0000; val_gene_expr_recon_loss: 2486664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1012890.7500; val_global_loss: 30998972.0000; val_optim_loss: 30998972.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9453; val_auprc_score: 0.9244; val_best_acc_score: 0.8901; val_best_f1_score: 0.8957; train_kl_reg_loss: 76419.0634; train_edge_recon_loss: 26888220.8889; train_gene_expr_recon_loss: 2517165.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1029720.5764; train_global_loss: 30511526.2222; train_optim_loss: 30511526.2222; val_kl_reg_loss: 73622.2422; val_edge_recon_loss: 26956430.0000; val_gene_expr_recon_loss: 2483920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013116.2500; val_global_loss: 30527088.0000; val_optim_loss: 30527088.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9486; val_auprc_score: 0.9291; val_best_acc_score: 0.8929; val_best_f1_score: 0.8974; train_kl_reg_loss: 76927.8377; train_edge_recon_loss: 26885666.0000; train_gene_expr_recon_loss: 2530696.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1036628.0486; train_global_loss: 30529918.0000; train_optim_loss: 30529918.0000; val_kl_reg_loss: 73286.9219; val_edge_recon_loss: 26737582.0000; val_gene_expr_recon_loss: 2489411.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013097.8125; val_global_loss: 30313378.0000; val_optim_loss: 30313378.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9410; val_auprc_score: 0.9178; val_best_acc_score: 0.8866; val_best_f1_score: 0.8933; train_kl_reg_loss: 75936.5347; train_edge_recon_loss: 26870455.1111; train_gene_expr_recon_loss: 2516073.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1028472.4028; train_global_loss: 30490938.0000; train_optim_loss: 30490938.0000; val_kl_reg_loss: 73209.9219; val_edge_recon_loss: 27047428.0000; val_gene_expr_recon_loss: 2479461.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1011838.1250; val_global_loss: 30611938.0000; val_optim_loss: 30611938.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9423; val_auprc_score: 0.9187; val_best_acc_score: 0.8875; val_best_f1_score: 0.8930; train_kl_reg_loss: 76790.5260; train_edge_recon_loss: 26788164.2222; train_gene_expr_recon_loss: 2511917.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1031828.7569; train_global_loss: 30408701.1111; train_optim_loss: 30408701.1111; val_kl_reg_loss: 73338.4219; val_edge_recon_loss: 26918172.0000; val_gene_expr_recon_loss: 2478360.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1012968.5000; val_global_loss: 30482838.0000; val_optim_loss: 30482838.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9457; val_auprc_score: 0.9295; val_best_acc_score: 0.8892; val_best_f1_score: 0.8957; train_kl_reg_loss: 76750.4418; train_edge_recon_loss: 26969330.2222; train_gene_expr_recon_loss: 2502920.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1033114.9931; train_global_loss: 30582116.4444; train_optim_loss: 30582116.4444; val_kl_reg_loss: 72669.4844; val_edge_recon_loss: 27174810.0000; val_gene_expr_recon_loss: 2478909.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1011270.0000; val_global_loss: 30737660.0000; val_optim_loss: 30737660.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9407; val_auprc_score: 0.9168; val_best_acc_score: 0.8851; val_best_f1_score: 0.8909; train_kl_reg_loss: 76348.2483; train_edge_recon_loss: 26942618.4444; train_gene_expr_recon_loss: 2524058.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1032288.0278; train_global_loss: 30575312.6667; train_optim_loss: 30575312.6667; val_kl_reg_loss: 73146.9766; val_edge_recon_loss: 27180650.0000; val_gene_expr_recon_loss: 2471962.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010032.9375; val_global_loss: 30735790.0000; val_optim_loss: 30735790.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9443; val_auprc_score: 0.9204; val_best_acc_score: 0.8910; val_best_f1_score: 0.8959; train_kl_reg_loss: 75860.7170; train_edge_recon_loss: 26896582.0000; train_gene_expr_recon_loss: 2493049.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1029069.6319; train_global_loss: 30494562.0000; train_optim_loss: 30494562.0000; val_kl_reg_loss: 73091.0781; val_edge_recon_loss: 27073718.0000; val_gene_expr_recon_loss: 2472216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010764.7500; val_global_loss: 30629790.0000; val_optim_loss: 30629790.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9435; val_auprc_score: 0.9202; val_best_acc_score: 0.8860; val_best_f1_score: 0.8924; train_kl_reg_loss: 76412.2509; train_edge_recon_loss: 26927152.6667; train_gene_expr_recon_loss: 2507013.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1027522.9444; train_global_loss: 30538101.5556; train_optim_loss: 30538101.5556; val_kl_reg_loss: 71375.0625; val_edge_recon_loss: 27111864.0000; val_gene_expr_recon_loss: 2471896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010399.1250; val_global_loss: 30665536.0000; val_optim_loss: 30665536.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9411; val_auprc_score: 0.9168; val_best_acc_score: 0.8875; val_best_f1_score: 0.8934; train_kl_reg_loss: 76333.8429; train_edge_recon_loss: 26935663.7778; train_gene_expr_recon_loss: 2500699.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1026640.1250; train_global_loss: 30539337.7778; train_optim_loss: 30539337.7778; val_kl_reg_loss: 71453.5000; val_edge_recon_loss: 26793862.0000; val_gene_expr_recon_loss: 2472707.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010278.2500; val_global_loss: 30348302.0000; val_optim_loss: 30348302.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9429; val_auprc_score: 0.9221; val_best_acc_score: 0.8894; val_best_f1_score: 0.8959; train_kl_reg_loss: 76310.3307; train_edge_recon_loss: 26963297.3333; train_gene_expr_recon_loss: 2497561.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1025017.8056; train_global_loss: 30562186.4444; train_optim_loss: 30562186.4444; val_kl_reg_loss: 71691.7969; val_edge_recon_loss: 26983940.0000; val_gene_expr_recon_loss: 2472554.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010763.0000; val_global_loss: 30538948.0000; val_optim_loss: 30538948.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 47 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9429
Val AUPRC score: 0.9243
Val best accuracy score: 0.8849
Val best F1 score: 0.8905
Val gene expr MSE score: 0.4905
Val chrom access MSE score: 0.0878
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
