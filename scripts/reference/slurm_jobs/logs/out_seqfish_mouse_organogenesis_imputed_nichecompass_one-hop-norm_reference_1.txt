[True]
Run timestamp: 20072023_124552_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '12', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.', '--lambda_gene_expr_recon', '30000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.0', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 3031 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 3031, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1507, n_latent: 1507, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1507, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 6062
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9015; val_auprc_score: 0.9792; val_best_acc_score: 0.8516; val_best_f1_score: 0.9199; train_kl_reg_loss: 477297.8136; train_edge_recon_loss: 10647392.5833; train_gene_expr_recon_loss: 183949640.0000; train_masked_gp_l1_reg_loss: 6994.2254; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195081325.7436; train_optim_loss: 195081325.7436; val_kl_reg_loss: 535287.2604; val_edge_recon_loss: 12058644.6111; val_gene_expr_recon_loss: 104379077.7778; val_masked_gp_l1_reg_loss: 7199.9014; val_group_lasso_reg_loss: 0.0000; val_global_loss: 116980210.2222; val_optim_loss: 116980210.2222
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8675; val_auprc_score: 0.9719; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 558076.9421; train_edge_recon_loss: 10787060.8462; train_gene_expr_recon_loss: 103305094.4615; train_masked_gp_l1_reg_loss: 7313.4008; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114657545.5385; train_optim_loss: 114657545.5385; val_kl_reg_loss: 479941.6406; val_edge_recon_loss: 12004522.5000; val_gene_expr_recon_loss: 100486992.0000; val_masked_gp_l1_reg_loss: 7452.2852; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112978911.5556; val_optim_loss: 112978911.5556
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8609; val_auprc_score: 0.9693; val_best_acc_score: 0.8661; val_best_f1_score: 0.9270; train_kl_reg_loss: 498575.0929; train_edge_recon_loss: 10655882.1026; train_gene_expr_recon_loss: 99075244.7692; train_masked_gp_l1_reg_loss: 7616.6005; train_group_lasso_reg_loss: 0.0000; train_global_loss: 110237318.5128; train_optim_loss: 110237318.5128; val_kl_reg_loss: 459109.5642; val_edge_recon_loss: 12046484.6111; val_gene_expr_recon_loss: 97472059.1111; val_masked_gp_l1_reg_loss: 7813.7983; val_group_lasso_reg_loss: 0.0000; val_global_loss: 109985469.3333; val_optim_loss: 109985469.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8698; val_auprc_score: 0.9712; val_best_acc_score: 0.8928; val_best_f1_score: 0.9397; train_kl_reg_loss: 460282.8478; train_edge_recon_loss: 10623970.2308; train_gene_expr_recon_loss: 96420742.2564; train_masked_gp_l1_reg_loss: 8052.8312; train_group_lasso_reg_loss: 0.0000; train_global_loss: 107513047.8974; train_optim_loss: 107513047.8974; val_kl_reg_loss: 432342.1111; val_edge_recon_loss: 11929425.6111; val_gene_expr_recon_loss: 94894631.1111; val_masked_gp_l1_reg_loss: 8298.9688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 107264694.6667; val_optim_loss: 107264694.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8802; val_auprc_score: 0.9733; val_best_acc_score: 0.8987; val_best_f1_score: 0.9421; train_kl_reg_loss: 422016.4571; train_edge_recon_loss: 10572715.7821; train_gene_expr_recon_loss: 94245415.5385; train_masked_gp_l1_reg_loss: 8572.5540; train_group_lasso_reg_loss: 0.0000; train_global_loss: 105248720.0513; train_optim_loss: 105248720.0513; val_kl_reg_loss: 407902.9618; val_edge_recon_loss: 11958111.1667; val_gene_expr_recon_loss: 92827007.1111; val_masked_gp_l1_reg_loss: 8845.6455; val_group_lasso_reg_loss: 0.0000; val_global_loss: 105201868.8889; val_optim_loss: 105201868.8889
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8841; val_auprc_score: 0.9749; val_best_acc_score: 0.8911; val_best_f1_score: 0.9397; train_kl_reg_loss: 396366.3111; train_edge_recon_loss: 10618043.2821; train_gene_expr_recon_loss: 91746131.1282; train_masked_gp_l1_reg_loss: 9032.5828; train_group_lasso_reg_loss: 0.0000; train_global_loss: 102769572.9231; train_optim_loss: 102769572.9231; val_kl_reg_loss: 385541.6250; val_edge_recon_loss: 11797107.7778; val_gene_expr_recon_loss: 90858556.0000; val_masked_gp_l1_reg_loss: 9197.5957; val_group_lasso_reg_loss: 0.0000; val_global_loss: 103050404.8889; val_optim_loss: 103050404.8889
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8990; val_auprc_score: 0.9768; val_best_acc_score: 0.9010; val_best_f1_score: 0.9447; train_kl_reg_loss: 371222.9319; train_edge_recon_loss: 10580619.1154; train_gene_expr_recon_loss: 90430727.5385; train_masked_gp_l1_reg_loss: 9390.6301; train_group_lasso_reg_loss: 0.0000; train_global_loss: 101391960.3077; train_optim_loss: 101391960.3077; val_kl_reg_loss: 299952.1615; val_edge_recon_loss: 11958795.1111; val_gene_expr_recon_loss: 89396618.2222; val_masked_gp_l1_reg_loss: 9584.3232; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101664948.8889; val_optim_loss: 101664948.8889
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9017; val_auprc_score: 0.9772; val_best_acc_score: 0.9093; val_best_f1_score: 0.9484; train_kl_reg_loss: 348377.1080; train_edge_recon_loss: 10461516.2244; train_gene_expr_recon_loss: 88633724.4103; train_masked_gp_l1_reg_loss: 9723.6188; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99453341.6410; train_optim_loss: 99453341.6410; val_kl_reg_loss: 312604.8594; val_edge_recon_loss: 11684499.8333; val_gene_expr_recon_loss: 88000685.3333; val_masked_gp_l1_reg_loss: 9864.5703; val_group_lasso_reg_loss: 0.0000; val_global_loss: 100007653.3333; val_optim_loss: 100007653.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9021; val_auprc_score: 0.9776; val_best_acc_score: 0.9149; val_best_f1_score: 0.9515; train_kl_reg_loss: 320714.7792; train_edge_recon_loss: 10392015.2244; train_gene_expr_recon_loss: 87366815.5385; train_masked_gp_l1_reg_loss: 10003.9162; train_group_lasso_reg_loss: 0.0000; train_global_loss: 98089549.6923; train_optim_loss: 98089549.6923; val_kl_reg_loss: 323513.6076; val_edge_recon_loss: 11214373.5556; val_gene_expr_recon_loss: 86719318.6667; val_masked_gp_l1_reg_loss: 10141.4463; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98267350.2222; val_optim_loss: 98267350.2222
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8965; val_auprc_score: 0.9762; val_best_acc_score: 0.9097; val_best_f1_score: 0.9488; train_kl_reg_loss: 288848.5437; train_edge_recon_loss: 10224851.4808; train_gene_expr_recon_loss: 86256962.0000; train_masked_gp_l1_reg_loss: 10279.0027; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96780941.1282; train_optim_loss: 96780941.1282; val_kl_reg_loss: 267928.6076; val_edge_recon_loss: 10726184.5000; val_gene_expr_recon_loss: 85792277.3333; val_masked_gp_l1_reg_loss: 10417.2812; val_group_lasso_reg_loss: 0.0000; val_global_loss: 96796806.6667; val_optim_loss: 96796806.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9010; val_auprc_score: 0.9764; val_best_acc_score: 0.9160; val_best_f1_score: 0.9522; train_kl_reg_loss: 270610.8366; train_edge_recon_loss: 10005740.6795; train_gene_expr_recon_loss: 85849444.8718; train_masked_gp_l1_reg_loss: 10562.1689; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96136358.5641; train_optim_loss: 96136358.5641; val_kl_reg_loss: 230362.2413; val_edge_recon_loss: 10627079.5000; val_gene_expr_recon_loss: 87436168.8889; val_masked_gp_l1_reg_loss: 10777.6113; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98304385.7778; val_optim_loss: 98304385.7778
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8924; val_auprc_score: 0.9744; val_best_acc_score: 0.9076; val_best_f1_score: 0.9475; train_kl_reg_loss: 241305.1587; train_edge_recon_loss: 9951152.7628; train_gene_expr_recon_loss: 85058767.1795; train_masked_gp_l1_reg_loss: 10938.3211; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95262163.0769; train_optim_loss: 95262163.0769; val_kl_reg_loss: 238916.6762; val_edge_recon_loss: 10154359.1667; val_gene_expr_recon_loss: 84259588.4444; val_masked_gp_l1_reg_loss: 11100.2539; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94663968.4444; val_optim_loss: 94663968.4444
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8906; val_auprc_score: 0.9747; val_best_acc_score: 0.9060; val_best_f1_score: 0.9468; train_kl_reg_loss: 247421.1549; train_edge_recon_loss: 9639428.3077; train_gene_expr_recon_loss: 83863388.5641; train_masked_gp_l1_reg_loss: 11235.0763; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93761473.1282; train_optim_loss: 93761473.1282; val_kl_reg_loss: 266289.9852; val_edge_recon_loss: 9535656.6111; val_gene_expr_recon_loss: 83432442.2222; val_masked_gp_l1_reg_loss: 11360.0244; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93245748.4444; val_optim_loss: 93245748.4444
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8821; val_auprc_score: 0.9726; val_best_acc_score: 0.9043; val_best_f1_score: 0.9460; train_kl_reg_loss: 270275.4450; train_edge_recon_loss: 9404616.8333; train_gene_expr_recon_loss: 83015411.4359; train_masked_gp_l1_reg_loss: 11475.8040; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92701779.3846; train_optim_loss: 92701779.3846; val_kl_reg_loss: 279635.9062; val_edge_recon_loss: 9343607.2778; val_gene_expr_recon_loss: 82729633.3333; val_masked_gp_l1_reg_loss: 11585.4678; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92364459.5556; val_optim_loss: 92364459.5556
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8801; val_auprc_score: 0.9713; val_best_acc_score: 0.9002; val_best_f1_score: 0.9437; train_kl_reg_loss: 299614.6815; train_edge_recon_loss: 9285052.7949; train_gene_expr_recon_loss: 82254228.6154; train_masked_gp_l1_reg_loss: 11690.8447; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91850587.3333; train_optim_loss: 91850587.3333; val_kl_reg_loss: 314161.9635; val_edge_recon_loss: 9409026.3889; val_gene_expr_recon_loss: 81950900.0000; val_masked_gp_l1_reg_loss: 11792.8926; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91685879.5556; val_optim_loss: 91685879.5556
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8841; val_auprc_score: 0.9732; val_best_acc_score: 0.9003; val_best_f1_score: 0.9437; train_kl_reg_loss: 321842.0895; train_edge_recon_loss: 9102940.5032; train_gene_expr_recon_loss: 81599352.1538; train_masked_gp_l1_reg_loss: 11891.2589; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91036026.0513; train_optim_loss: 91036026.0513; val_kl_reg_loss: 323897.7014; val_edge_recon_loss: 9283662.1667; val_gene_expr_recon_loss: 81408318.2222; val_masked_gp_l1_reg_loss: 11987.3340; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91027861.3333; val_optim_loss: 91027861.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8825; val_auprc_score: 0.9730; val_best_acc_score: 0.9049; val_best_f1_score: 0.9463; train_kl_reg_loss: 336491.4547; train_edge_recon_loss: 9008023.4519; train_gene_expr_recon_loss: 80911452.8205; train_masked_gp_l1_reg_loss: 12083.7793; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90268051.4359; train_optim_loss: 90268051.4359; val_kl_reg_loss: 335259.9201; val_edge_recon_loss: 8859892.9722; val_gene_expr_recon_loss: 80763546.2222; val_masked_gp_l1_reg_loss: 12184.4727; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89970884.0000; val_optim_loss: 89970884.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8852; val_auprc_score: 0.9736; val_best_acc_score: 0.9029; val_best_f1_score: 0.9455; train_kl_reg_loss: 342084.2502; train_edge_recon_loss: 8956458.4391; train_gene_expr_recon_loss: 80393995.2821; train_masked_gp_l1_reg_loss: 12277.6103; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89704815.6923; train_optim_loss: 89704815.6923; val_kl_reg_loss: 335768.8194; val_edge_recon_loss: 9081930.5556; val_gene_expr_recon_loss: 80164830.6667; val_masked_gp_l1_reg_loss: 12372.9609; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89594905.7778; val_optim_loss: 89594905.7778
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8869; val_auprc_score: 0.9741; val_best_acc_score: 0.9049; val_best_f1_score: 0.9466; train_kl_reg_loss: 340769.8353; train_edge_recon_loss: 8896435.5032; train_gene_expr_recon_loss: 79851523.9487; train_masked_gp_l1_reg_loss: 12467.8480; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89101197.2308; train_optim_loss: 89101197.2308; val_kl_reg_loss: 331034.7361; val_edge_recon_loss: 9100364.8889; val_gene_expr_recon_loss: 79618647.1111; val_masked_gp_l1_reg_loss: 12568.3066; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89062614.6667; val_optim_loss: 89062614.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8879; val_auprc_score: 0.9746; val_best_acc_score: 0.9067; val_best_f1_score: 0.9477; train_kl_reg_loss: 329684.1536; train_edge_recon_loss: 8827639.1122; train_gene_expr_recon_loss: 79347502.1538; train_masked_gp_l1_reg_loss: 12662.0040; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88517487.1795; train_optim_loss: 88517487.1795; val_kl_reg_loss: 320772.0903; val_edge_recon_loss: 8938364.3056; val_gene_expr_recon_loss: 79291411.1111; val_masked_gp_l1_reg_loss: 12755.4307; val_group_lasso_reg_loss: 0.0000; val_global_loss: 88563299.1111; val_optim_loss: 88563299.1111
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8963; val_auprc_score: 0.9769; val_best_acc_score: 0.9089; val_best_f1_score: 0.9489; train_kl_reg_loss: 319496.3285; train_edge_recon_loss: 8733644.9487; train_gene_expr_recon_loss: 78878247.6923; train_masked_gp_l1_reg_loss: 12842.1203; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87944230.9231; train_optim_loss: 87944230.9231; val_kl_reg_loss: 307906.8108; val_edge_recon_loss: 8810992.5556; val_gene_expr_recon_loss: 78817052.4444; val_masked_gp_l1_reg_loss: 12928.7402; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87948880.4444; val_optim_loss: 87948880.4444
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8951; val_auprc_score: 0.9770; val_best_acc_score: 0.9119; val_best_f1_score: 0.9507; train_kl_reg_loss: 306965.6432; train_edge_recon_loss: 8686093.3654; train_gene_expr_recon_loss: 78482492.7692; train_masked_gp_l1_reg_loss: 13013.5075; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87488564.8718; train_optim_loss: 87488564.8718; val_kl_reg_loss: 292826.3906; val_edge_recon_loss: 8624723.6667; val_gene_expr_recon_loss: 78448739.1111; val_masked_gp_l1_reg_loss: 13089.5645; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87379376.8889; val_optim_loss: 87379376.8889
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8989; val_auprc_score: 0.9779; val_best_acc_score: 0.9118; val_best_f1_score: 0.9506; train_kl_reg_loss: 293203.7292; train_edge_recon_loss: 8652560.5064; train_gene_expr_recon_loss: 78069836.0000; train_masked_gp_l1_reg_loss: 13163.5904; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87028763.7949; train_optim_loss: 87028763.7949; val_kl_reg_loss: 284491.4236; val_edge_recon_loss: 8704673.5278; val_gene_expr_recon_loss: 77983230.6667; val_masked_gp_l1_reg_loss: 13236.3428; val_group_lasso_reg_loss: 0.0000; val_global_loss: 86985636.0000; val_optim_loss: 86985636.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9057; val_auprc_score: 0.9791; val_best_acc_score: 0.9113; val_best_f1_score: 0.9500; train_kl_reg_loss: 283444.9303; train_edge_recon_loss: 8601815.1378; train_gene_expr_recon_loss: 77660199.2821; train_masked_gp_l1_reg_loss: 13309.2755; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86558768.0513; train_optim_loss: 86558768.0513; val_kl_reg_loss: 273454.5035; val_edge_recon_loss: 8851157.7222; val_gene_expr_recon_loss: 77609832.4444; val_masked_gp_l1_reg_loss: 13375.6953; val_group_lasso_reg_loss: 0.0000; val_global_loss: 86747820.4444; val_optim_loss: 86747820.4444
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9093; val_auprc_score: 0.9799; val_best_acc_score: 0.9152; val_best_f1_score: 0.9520; train_kl_reg_loss: 271431.9118; train_edge_recon_loss: 8536300.8173; train_gene_expr_recon_loss: 77337448.5641; train_masked_gp_l1_reg_loss: 13446.2794; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86158627.4872; train_optim_loss: 86158627.4872; val_kl_reg_loss: 261715.0043; val_edge_recon_loss: 8558237.7778; val_gene_expr_recon_loss: 77354488.4444; val_masked_gp_l1_reg_loss: 13512.9961; val_group_lasso_reg_loss: 0.0000; val_global_loss: 86187953.7778; val_optim_loss: 86187953.7778
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8281; val_auprc_score: 0.9591; val_best_acc_score: 0.8625; val_best_f1_score: 0.9247; train_kl_reg_loss: 64787.3161; train_edge_recon_loss: 11307356.3910; train_gene_expr_recon_loss: 95846785.1282; train_masked_gp_l1_reg_loss: 15752.1111; train_group_lasso_reg_loss: 0.0000; train_global_loss: 107234680.7179; train_optim_loss: 107234680.7179; val_kl_reg_loss: 30311.5407; val_edge_recon_loss: 11686874.1667; val_gene_expr_recon_loss: 85534408.4444; val_masked_gp_l1_reg_loss: 16880.6855; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97268474.2222; val_optim_loss: 97268474.2222
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.6180; val_auprc_score: 0.8908; val_best_acc_score: 0.8636; val_best_f1_score: 0.9260; train_kl_reg_loss: 24758.2324; train_edge_recon_loss: 11262779.8846; train_gene_expr_recon_loss: 87532733.8974; train_masked_gp_l1_reg_loss: 17104.4093; train_group_lasso_reg_loss: 0.0000; train_global_loss: 98837376.5641; train_optim_loss: 98837376.5641; val_kl_reg_loss: 17357.5788; val_edge_recon_loss: 11550957.5000; val_gene_expr_recon_loss: 85619099.1111; val_masked_gp_l1_reg_loss: 17101.8105; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97204517.7778; val_optim_loss: 97204517.7778
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.6227; val_auprc_score: 0.8894; val_best_acc_score: 0.8619; val_best_f1_score: 0.9248; train_kl_reg_loss: 20914.0407; train_edge_recon_loss: 11338369.5962; train_gene_expr_recon_loss: 85334834.8205; train_masked_gp_l1_reg_loss: 17043.3739; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96711161.7436; train_optim_loss: 96711161.7436; val_kl_reg_loss: 17244.1487; val_edge_recon_loss: 11734343.7778; val_gene_expr_recon_loss: 84562188.0000; val_masked_gp_l1_reg_loss: 17066.2012; val_group_lasso_reg_loss: 0.0000; val_global_loss: 96330840.0000; val_optim_loss: 96330840.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.6479; val_auprc_score: 0.9000; val_best_acc_score: 0.8680; val_best_f1_score: 0.9281; train_kl_reg_loss: 19949.1532; train_edge_recon_loss: 11141798.2628; train_gene_expr_recon_loss: 84314369.1282; train_masked_gp_l1_reg_loss: 16999.8967; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95493116.2564; train_optim_loss: 95493116.2564; val_kl_reg_loss: 11612.4146; val_edge_recon_loss: 11271038.4444; val_gene_expr_recon_loss: 83936170.6667; val_masked_gp_l1_reg_loss: 16960.2168; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95235781.7778; val_optim_loss: 95235781.7778

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.6531; val_auprc_score: 0.8988; val_best_acc_score: 0.8653; val_best_f1_score: 0.9264; train_kl_reg_loss: 19039.0760; train_edge_recon_loss: 11047012.1218; train_gene_expr_recon_loss: 83585502.5128; train_masked_gp_l1_reg_loss: 16957.6640; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94668511.4359; train_optim_loss: 94668511.4359; val_kl_reg_loss: 14402.7308; val_edge_recon_loss: 11611684.9444; val_gene_expr_recon_loss: 83230827.5556; val_masked_gp_l1_reg_loss: 16941.4668; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94873858.2222; val_optim_loss: 94873858.2222
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.6548; val_auprc_score: 0.8992; val_best_acc_score: 0.8657; val_best_f1_score: 0.9266; train_kl_reg_loss: 20077.6774; train_edge_recon_loss: 11094327.6731; train_gene_expr_recon_loss: 83318800.0000; train_masked_gp_l1_reg_loss: 16928.4428; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94450134.0000; train_optim_loss: 94450134.0000; val_kl_reg_loss: 14855.3025; val_edge_recon_loss: 11580431.0556; val_gene_expr_recon_loss: 83122580.0000; val_masked_gp_l1_reg_loss: 16913.0293; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94734777.7778; val_optim_loss: 94734777.7778
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.6664; val_auprc_score: 0.9039; val_best_acc_score: 0.8683; val_best_f1_score: 0.9280; train_kl_reg_loss: 20195.5518; train_edge_recon_loss: 10969271.8141; train_gene_expr_recon_loss: 83213869.6923; train_masked_gp_l1_reg_loss: 16907.1839; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94220245.5385; train_optim_loss: 94220245.5385; val_kl_reg_loss: 14772.8665; val_edge_recon_loss: 11455085.3889; val_gene_expr_recon_loss: 83066654.2222; val_masked_gp_l1_reg_loss: 16900.4453; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94553415.5556; val_optim_loss: 94553415.5556
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.6690; val_auprc_score: 0.9082; val_best_acc_score: 0.8720; val_best_f1_score: 0.9302; train_kl_reg_loss: 20694.1520; train_edge_recon_loss: 10967840.1474; train_gene_expr_recon_loss: 83138992.0000; train_masked_gp_l1_reg_loss: 16891.6880; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94144417.6923; train_optim_loss: 94144417.6923; val_kl_reg_loss: 14980.7454; val_edge_recon_loss: 11189950.7222; val_gene_expr_recon_loss: 82839952.8889; val_masked_gp_l1_reg_loss: 16880.8867; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94061763.5556; val_optim_loss: 94061763.5556

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 65 min 24 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9376
Val AUPRC score: 0.9858
Val best accuracy score: 0.9353
Val best F1 score: 0.9627
Val gene expr MSE score: 4630.8640
Val cat covariate0 mean sim diff: -0.0035

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
