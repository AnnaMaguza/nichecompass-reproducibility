[True]
Run timestamp: 16082023_144653_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '2', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1538, n_latent: 1528, n_addon_latent: 10, n_fc_layers: 1, n_layers: 2, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1528, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1528, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9344; val_auprc_score: 0.9810; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 97023448.4983; train_edge_recon_loss: 1186486.7481; train_gene_expr_recon_loss: 132531362.1230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 230741300.4946; train_optim_loss: 230741300.4946; val_kl_reg_loss: 271028.2463; val_edge_recon_loss: 1189023.5159; val_gene_expr_recon_loss: 54280368.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55740420.5622; val_optim_loss: 55740420.5622
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6985; val_auprc_score: 0.9165; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 227168.7875; train_edge_recon_loss: 1153460.7386; train_gene_expr_recon_loss: 50595847.4765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51976476.9819; train_optim_loss: 51976476.9819; val_kl_reg_loss: 49517.4479; val_edge_recon_loss: 1200628.5699; val_gene_expr_recon_loss: 37358389.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38608535.6757; val_optim_loss: 38608535.6757
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8493; val_auprc_score: 0.9570; val_best_acc_score: 0.8808; val_best_f1_score: 0.9345; train_kl_reg_loss: 46669.1690; train_edge_recon_loss: 1048073.2999; train_gene_expr_recon_loss: 36044893.1267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 37139635.5175; train_optim_loss: 37139635.5175; val_kl_reg_loss: 36443.6167; val_edge_recon_loss: 1196114.5422; val_gene_expr_recon_loss: 34679627.3730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 35912185.5568; val_optim_loss: 35912185.5568
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8913; val_auprc_score: 0.9714; val_best_acc_score: 0.9152; val_best_f1_score: 0.9520; train_kl_reg_loss: 31009.1013; train_edge_recon_loss: 1032006.5990; train_gene_expr_recon_loss: 33807938.1930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34870953.8444; train_optim_loss: 34870953.8444; val_kl_reg_loss: 22627.2041; val_edge_recon_loss: 1047682.0476; val_gene_expr_recon_loss: 33040926.0324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34111235.1784; val_optim_loss: 34111235.1784
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8704; val_auprc_score: 0.9675; val_best_acc_score: 0.9061; val_best_f1_score: 0.9471; train_kl_reg_loss: 21923.0729; train_edge_recon_loss: 938436.5228; train_gene_expr_recon_loss: 32592355.9783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 33552715.5464; train_optim_loss: 33552715.5464; val_kl_reg_loss: 26053.3971; val_edge_recon_loss: 900029.3855; val_gene_expr_recon_loss: 32091390.4649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 33017473.2757; val_optim_loss: 33017473.2757
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8709; val_auprc_score: 0.9679; val_best_acc_score: 0.9037; val_best_f1_score: 0.9459; train_kl_reg_loss: 28423.9215; train_edge_recon_loss: 880664.1566; train_gene_expr_recon_loss: 31841357.7587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32750445.8154; train_optim_loss: 32750445.8154; val_kl_reg_loss: 27596.2757; val_edge_recon_loss: 880012.8409; val_gene_expr_recon_loss: 31547189.0486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32454798.1946; val_optim_loss: 32454798.1946
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8838; val_auprc_score: 0.9698; val_best_acc_score: 0.9088; val_best_f1_score: 0.9483; train_kl_reg_loss: 26035.7665; train_edge_recon_loss: 864660.8891; train_gene_expr_recon_loss: 31453896.0555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32344592.7045; train_optim_loss: 32344592.7045; val_kl_reg_loss: 22128.6624; val_edge_recon_loss: 849721.1257; val_gene_expr_recon_loss: 31303957.1784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32175807.0811; val_optim_loss: 32175807.0811
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8968; val_auprc_score: 0.9717; val_best_acc_score: 0.9234; val_best_f1_score: 0.9559; train_kl_reg_loss: 20630.7758; train_edge_recon_loss: 831586.5322; train_gene_expr_recon_loss: 31259902.3185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32112119.6297; train_optim_loss: 32112119.6297; val_kl_reg_loss: 19313.3356; val_edge_recon_loss: 825269.0068; val_gene_expr_recon_loss: 31136487.1676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31981069.5351; val_optim_loss: 31981069.5351
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8931; val_auprc_score: 0.9714; val_best_acc_score: 0.9209; val_best_f1_score: 0.9547; train_kl_reg_loss: 17868.9776; train_edge_recon_loss: 816553.9831; train_gene_expr_recon_loss: 31167060.5561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32001483.5042; train_optim_loss: 32001483.5042; val_kl_reg_loss: 17113.6459; val_edge_recon_loss: 822410.9547; val_gene_expr_recon_loss: 31149931.1351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31989455.7946; val_optim_loss: 31989455.7946
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8996; val_auprc_score: 0.9734; val_best_acc_score: 0.9217; val_best_f1_score: 0.9550; train_kl_reg_loss: 15854.8870; train_edge_recon_loss: 812295.6997; train_gene_expr_recon_loss: 31110022.8251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31938173.4282; train_optim_loss: 31938173.4282; val_kl_reg_loss: 14755.5049; val_edge_recon_loss: 804499.3554; val_gene_expr_recon_loss: 31044654.4649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31863909.3405; val_optim_loss: 31863909.3405
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9020; val_auprc_score: 0.9733; val_best_acc_score: 0.9248; val_best_f1_score: 0.9565; train_kl_reg_loss: 14234.2850; train_edge_recon_loss: 805596.0881; train_gene_expr_recon_loss: 31060644.4210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31880474.8263; train_optim_loss: 31880474.8263; val_kl_reg_loss: 13770.1269; val_edge_recon_loss: 818607.8392; val_gene_expr_recon_loss: 30962367.2649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31794745.1568; val_optim_loss: 31794745.1568
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9089; val_auprc_score: 0.9767; val_best_acc_score: 0.9294; val_best_f1_score: 0.9595; train_kl_reg_loss: 13289.2336; train_edge_recon_loss: 805259.2243; train_gene_expr_recon_loss: 30972388.3426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31790936.8022; train_optim_loss: 31790936.8022; val_kl_reg_loss: 12505.6249; val_edge_recon_loss: 800723.6500; val_gene_expr_recon_loss: 30899466.7243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31712695.9676; val_optim_loss: 31712695.9676
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9098; val_auprc_score: 0.9774; val_best_acc_score: 0.9292; val_best_f1_score: 0.9594; train_kl_reg_loss: 12561.9177; train_edge_recon_loss: 806462.1356; train_gene_expr_recon_loss: 30943172.0157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31762196.0651; train_optim_loss: 31762196.0651; val_kl_reg_loss: 11829.3007; val_edge_recon_loss: 800392.3208; val_gene_expr_recon_loss: 30871914.4432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31684136.0973; val_optim_loss: 31684136.0973
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9101; val_auprc_score: 0.9769; val_best_acc_score: 0.9263; val_best_f1_score: 0.9576; train_kl_reg_loss: 12175.2234; train_edge_recon_loss: 805521.2061; train_gene_expr_recon_loss: 30922864.1713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31740560.6212; train_optim_loss: 31740560.6212; val_kl_reg_loss: 12099.7353; val_edge_recon_loss: 813714.0367; val_gene_expr_recon_loss: 30832739.2324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31658553.0595; val_optim_loss: 31658553.0595
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9147; val_auprc_score: 0.9789; val_best_acc_score: 0.9315; val_best_f1_score: 0.9608; train_kl_reg_loss: 11869.4538; train_edge_recon_loss: 801228.6628; train_gene_expr_recon_loss: 30906025.9433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31719124.0627; train_optim_loss: 31719124.0627; val_kl_reg_loss: 11672.7378; val_edge_recon_loss: 796961.7997; val_gene_expr_recon_loss: 30832664.4865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31641299.0270; val_optim_loss: 31641299.0270
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9139; val_auprc_score: 0.9786; val_best_acc_score: 0.9293; val_best_f1_score: 0.9596; train_kl_reg_loss: 11618.3398; train_edge_recon_loss: 793456.8857; train_gene_expr_recon_loss: 30896946.3378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31702021.5621; train_optim_loss: 31702021.5621; val_kl_reg_loss: 11770.2556; val_edge_recon_loss: 800468.4581; val_gene_expr_recon_loss: 30844510.9622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31656749.7297; val_optim_loss: 31656749.7297
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9165; val_auprc_score: 0.9790; val_best_acc_score: 0.9303; val_best_f1_score: 0.9599; train_kl_reg_loss: 11559.3594; train_edge_recon_loss: 796827.9367; train_gene_expr_recon_loss: 30896266.6333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31704653.9493; train_optim_loss: 31704653.9493; val_kl_reg_loss: 11519.0963; val_edge_recon_loss: 798334.5520; val_gene_expr_recon_loss: 30789345.4054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31599199.1027; val_optim_loss: 31599199.1027
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9244; val_auprc_score: 0.9813; val_best_acc_score: 0.9298; val_best_f1_score: 0.9596; train_kl_reg_loss: 11430.6789; train_edge_recon_loss: 796132.9941; train_gene_expr_recon_loss: 30846200.1110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31653763.7756; train_optim_loss: 31653763.7756; val_kl_reg_loss: 11279.1624; val_edge_recon_loss: 802558.8591; val_gene_expr_recon_loss: 30844406.0324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31658244.0432; val_optim_loss: 31658244.0432
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9218; val_auprc_score: 0.9813; val_best_acc_score: 0.9291; val_best_f1_score: 0.9593; train_kl_reg_loss: 11401.3198; train_edge_recon_loss: 794145.4733; train_gene_expr_recon_loss: 30837728.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31643275.3305; train_optim_loss: 31643275.3305; val_kl_reg_loss: 11261.3383; val_edge_recon_loss: 802636.1672; val_gene_expr_recon_loss: 30812547.8811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31626445.3514; val_optim_loss: 31626445.3514
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9278; val_auprc_score: 0.9828; val_best_acc_score: 0.9309; val_best_f1_score: 0.9603; train_kl_reg_loss: 11395.7215; train_edge_recon_loss: 797832.2012; train_gene_expr_recon_loss: 30832637.6550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31641865.5597; train_optim_loss: 31641865.5597; val_kl_reg_loss: 11136.5334; val_edge_recon_loss: 787704.7556; val_gene_expr_recon_loss: 30766674.6919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31565515.9351; val_optim_loss: 31565515.9351
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9263; val_auprc_score: 0.9826; val_best_acc_score: 0.9284; val_best_f1_score: 0.9588; train_kl_reg_loss: 11288.6882; train_edge_recon_loss: 793883.9203; train_gene_expr_recon_loss: 30835703.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31640875.9156; train_optim_loss: 31640875.9156; val_kl_reg_loss: 11292.7523; val_edge_recon_loss: 809705.9507; val_gene_expr_recon_loss: 30800113.6108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31621112.3243; val_optim_loss: 31621112.3243
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9234; val_auprc_score: 0.9815; val_best_acc_score: 0.9313; val_best_f1_score: 0.9604; train_kl_reg_loss: 11134.5522; train_edge_recon_loss: 797654.0104; train_gene_expr_recon_loss: 30815674.1025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31624462.6478; train_optim_loss: 31624462.6478; val_kl_reg_loss: 11130.1463; val_edge_recon_loss: 794910.6625; val_gene_expr_recon_loss: 30731613.3514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31537654.1730; val_optim_loss: 31537654.1730
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9271; val_auprc_score: 0.9822; val_best_acc_score: 0.9301; val_best_f1_score: 0.9596; train_kl_reg_loss: 11154.3079; train_edge_recon_loss: 796034.1509; train_gene_expr_recon_loss: 30807662.4632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31614850.9131; train_optim_loss: 31614850.9131; val_kl_reg_loss: 11047.3095; val_edge_recon_loss: 806947.1797; val_gene_expr_recon_loss: 30718562.0865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31536556.5730; val_optim_loss: 31536556.5730
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9261; val_auprc_score: 0.9823; val_best_acc_score: 0.9294; val_best_f1_score: 0.9592; train_kl_reg_loss: 11246.1257; train_edge_recon_loss: 797302.2597; train_gene_expr_recon_loss: 30834354.2823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31642902.6779; train_optim_loss: 31642902.6779; val_kl_reg_loss: 11064.6239; val_edge_recon_loss: 801714.0301; val_gene_expr_recon_loss: 30738878.1946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31551656.8324; val_optim_loss: 31551656.8324
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9259; val_auprc_score: 0.9826; val_best_acc_score: 0.9286; val_best_f1_score: 0.9587; train_kl_reg_loss: 11216.8295; train_edge_recon_loss: 793185.8885; train_gene_expr_recon_loss: 30801320.1399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31605722.8733; train_optim_loss: 31605722.8733; val_kl_reg_loss: 11396.4468; val_edge_recon_loss: 806458.6061; val_gene_expr_recon_loss: 30794138.9514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31611993.9892; val_optim_loss: 31611993.9892
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9309; val_auprc_score: 0.9833; val_best_acc_score: 0.9314; val_best_f1_score: 0.9603; train_kl_reg_loss: 11248.1830; train_edge_recon_loss: 793787.4373; train_gene_expr_recon_loss: 30799342.8251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31604378.4089; train_optim_loss: 31604378.4089; val_kl_reg_loss: 11244.6331; val_edge_recon_loss: 804357.5699; val_gene_expr_recon_loss: 30819569.8703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31635172.1405; val_optim_loss: 31635172.1405
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9292; val_auprc_score: 0.9821; val_best_acc_score: 0.9318; val_best_f1_score: 0.9605; train_kl_reg_loss: 11301.0525; train_edge_recon_loss: 792274.9841; train_gene_expr_recon_loss: 30797549.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31601125.6478; train_optim_loss: 31601125.6478; val_kl_reg_loss: 11405.1792; val_edge_recon_loss: 795013.7676; val_gene_expr_recon_loss: 30734544.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31540963.3189; val_optim_loss: 31540963.3189

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9304; val_auprc_score: 0.9834; val_best_acc_score: 0.9334; val_best_f1_score: 0.9615; train_kl_reg_loss: 11456.0296; train_edge_recon_loss: 786168.5800; train_gene_expr_recon_loss: 30727049.0097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31524673.6393; train_optim_loss: 31524673.6393; val_kl_reg_loss: 11271.5214; val_edge_recon_loss: 797384.3733; val_gene_expr_recon_loss: 30661465.4703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31470121.3405; val_optim_loss: 31470121.3405
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9308; val_auprc_score: 0.9834; val_best_acc_score: 0.9322; val_best_f1_score: 0.9609; train_kl_reg_loss: 11461.7849; train_edge_recon_loss: 786198.7882; train_gene_expr_recon_loss: 30727232.8673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31524893.4138; train_optim_loss: 31524893.4138; val_kl_reg_loss: 11269.7329; val_edge_recon_loss: 797016.4828; val_gene_expr_recon_loss: 30673988.8649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31482275.0919; val_optim_loss: 31482275.0919
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9305; val_auprc_score: 0.9834; val_best_acc_score: 0.9335; val_best_f1_score: 0.9617; train_kl_reg_loss: 11425.5234; train_edge_recon_loss: 789579.7371; train_gene_expr_recon_loss: 30721602.5066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31522607.7503; train_optim_loss: 31522607.7503; val_kl_reg_loss: 11155.6075; val_edge_recon_loss: 788692.5223; val_gene_expr_recon_loss: 30682194.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31482042.8324; val_optim_loss: 31482042.8324
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9278; val_auprc_score: 0.9819; val_best_acc_score: 0.9311; val_best_f1_score: 0.9601; train_kl_reg_loss: 11432.8151; train_edge_recon_loss: 792242.9146; train_gene_expr_recon_loss: 30713074.5838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31516750.3064; train_optim_loss: 31516750.3064; val_kl_reg_loss: 11302.1922; val_edge_recon_loss: 808659.8777; val_gene_expr_recon_loss: 30675082.2595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31495044.3243; val_optim_loss: 31495044.3243
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9295; val_auprc_score: 0.9831; val_best_acc_score: 0.9326; val_best_f1_score: 0.9611; train_kl_reg_loss: 11417.4621; train_edge_recon_loss: 791172.7572; train_gene_expr_recon_loss: 30718372.6695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31520962.9035; train_optim_loss: 31520962.9035; val_kl_reg_loss: 11278.5656; val_edge_recon_loss: 799622.0037; val_gene_expr_recon_loss: 30671470.8865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31482371.4595; val_optim_loss: 31482371.4595

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9316; val_auprc_score: 0.9836; val_best_acc_score: 0.9326; val_best_f1_score: 0.9611; train_kl_reg_loss: 11407.6332; train_edge_recon_loss: 789843.9237; train_gene_expr_recon_loss: 30708450.2123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31509701.7575; train_optim_loss: 31509701.7575; val_kl_reg_loss: 11345.5391; val_edge_recon_loss: 794868.0284; val_gene_expr_recon_loss: 30653676.1514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31459889.8162; val_optim_loss: 31459889.8162
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9334; val_auprc_score: 0.9842; val_best_acc_score: 0.9335; val_best_f1_score: 0.9615; train_kl_reg_loss: 11412.4606; train_edge_recon_loss: 788372.0467; train_gene_expr_recon_loss: 30705857.5911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31505642.0917; train_optim_loss: 31505642.0917; val_kl_reg_loss: 11307.8773; val_edge_recon_loss: 793117.0355; val_gene_expr_recon_loss: 30660390.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31464815.6541; val_optim_loss: 31464815.6541
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9310; val_auprc_score: 0.9834; val_best_acc_score: 0.9328; val_best_f1_score: 0.9612; train_kl_reg_loss: 11415.9400; train_edge_recon_loss: 788389.0537; train_gene_expr_recon_loss: 30710313.6743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31510118.6550; train_optim_loss: 31510118.6550; val_kl_reg_loss: 11293.5953; val_edge_recon_loss: 791086.5522; val_gene_expr_recon_loss: 30662604.6919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31464984.8432; val_optim_loss: 31464984.8432
