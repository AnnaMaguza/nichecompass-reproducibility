Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9608; val_auprc_score: 0.9908; val_best_acc_score: 0.9548; val_best_f1_score: 0.9739; train_kl_reg_loss: 7526.5574; train_edge_recon_loss: 79644.3043; train_gene_expr_recon_loss: 1430366.7802; train_masked_gp_l1_reg_loss: 5015.5587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2837.0187; train_global_loss: 1525390.2344; train_optim_loss: 1525390.2344; val_kl_reg_loss: 7482.7819; val_edge_recon_loss: 78931.1224; val_gene_expr_recon_loss: 1430400.7293; val_masked_gp_l1_reg_loss: 5015.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2836.8647; val_global_loss: 1524666.7644; val_optim_loss: 1524666.7644
[True]
Run timestamp: 02082023_004659_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '5', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8801; val_auprc_score: 0.9753; val_best_acc_score: 0.8772; val_best_f1_score: 0.9317; train_kl_reg_loss: 43307.2875; train_edge_recon_loss: 111958.5766; train_gene_expr_recon_loss: 2393879.6782; train_masked_gp_l1_reg_loss: 5802.5385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37208.5817; train_global_loss: 2592156.6628; train_optim_loss: 2592156.6628; val_kl_reg_loss: 29001.9615; val_edge_recon_loss: 107263.4626; val_gene_expr_recon_loss: 2005974.4946; val_masked_gp_l1_reg_loss: 6699.2197; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29526.6133; val_global_loss: 2178465.6613; val_optim_loss: 2178465.6613
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9182; val_auprc_score: 0.9830; val_best_acc_score: 0.9121; val_best_f1_score: 0.9497; train_kl_reg_loss: 24812.4238; train_edge_recon_loss: 101593.1462; train_gene_expr_recon_loss: 1905983.9074; train_masked_gp_l1_reg_loss: 7674.3017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25009.8841; train_global_loss: 2065073.6643; train_optim_loss: 2065073.6643; val_kl_reg_loss: 21915.7289; val_edge_recon_loss: 98336.1222; val_gene_expr_recon_loss: 1823799.6304; val_masked_gp_l1_reg_loss: 8498.6709; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20949.3340; val_global_loss: 1973499.4772; val_optim_loss: 1973499.4772
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9374; val_auprc_score: 0.9861; val_best_acc_score: 0.9298; val_best_f1_score: 0.9596; train_kl_reg_loss: 19022.5818; train_edge_recon_loss: 94359.4803; train_gene_expr_recon_loss: 1760589.5800; train_masked_gp_l1_reg_loss: 9072.3464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18130.6265; train_global_loss: 1901174.6189; train_optim_loss: 1901174.6189; val_kl_reg_loss: 16762.8309; val_edge_recon_loss: 94474.3715; val_gene_expr_recon_loss: 1706661.1774; val_masked_gp_l1_reg_loss: 9485.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15842.9902; val_global_loss: 1843226.6304; val_optim_loss: 1843226.6304
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9632; val_auprc_score: 0.9919; val_best_acc_score: 0.9548; val_best_f1_score: 0.9739; train_kl_reg_loss: 7528.2619; train_edge_recon_loss: 79978.1282; train_gene_expr_recon_loss: 1430593.1874; train_masked_gp_l1_reg_loss: 5015.1484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2836.7120; train_global_loss: 1525951.4385; train_optim_loss: 1525951.4385; val_kl_reg_loss: 7482.6001; val_edge_recon_loss: 77981.5891; val_gene_expr_recon_loss: 1429438.0818; val_masked_gp_l1_reg_loss: 5015.0361; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2836.5640; val_global_loss: 1522753.8993; val_optim_loss: 1522753.8993
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9501; val_auprc_score: 0.9884; val_best_acc_score: 0.9385; val_best_f1_score: 0.9646; train_kl_reg_loss: 14613.6280; train_edge_recon_loss: 88964.1596; train_gene_expr_recon_loss: 1660425.7484; train_masked_gp_l1_reg_loss: 9518.3062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14320.2400; train_global_loss: 1787842.0809; train_optim_loss: 1787842.0809; val_kl_reg_loss: 13225.2609; val_edge_recon_loss: 88499.7532; val_gene_expr_recon_loss: 1621779.1694; val_masked_gp_l1_reg_loss: 9355.1377; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13063.1855; val_global_loss: 1745922.4301; val_optim_loss: 1745922.4301
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9558; val_auprc_score: 0.9902; val_best_acc_score: 0.9445; val_best_f1_score: 0.9680; train_kl_reg_loss: 11790.3330; train_edge_recon_loss: 85751.8024; train_gene_expr_recon_loss: 1588488.7162; train_masked_gp_l1_reg_loss: 8863.2590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12145.2553; train_global_loss: 1707039.3657; train_optim_loss: 1707039.3657; val_kl_reg_loss: 11281.5289; val_edge_recon_loss: 84268.2516; val_gene_expr_recon_loss: 1561554.0565; val_masked_gp_l1_reg_loss: 8285.4707; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11273.7285; val_global_loss: 1676663.0820; val_optim_loss: 1676663.0820
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9542; val_auprc_score: 0.9903; val_best_acc_score: 0.9426; val_best_f1_score: 0.9669; train_kl_reg_loss: 10468.4219; train_edge_recon_loss: 84345.1377; train_gene_expr_recon_loss: 1537425.4685; train_masked_gp_l1_reg_loss: 7736.9522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10382.0031; train_global_loss: 1650357.9807; train_optim_loss: 1650357.9807; val_kl_reg_loss: 10722.8782; val_edge_recon_loss: 82904.2201; val_gene_expr_recon_loss: 1521280.5188; val_masked_gp_l1_reg_loss: 7234.2510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9489.2529; val_global_loss: 1631631.1142; val_optim_loss: 1631631.1142
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9636; val_auprc_score: 0.9920; val_best_acc_score: 0.9558; val_best_f1_score: 0.9745; train_kl_reg_loss: 7528.3698; train_edge_recon_loss: 79240.6069; train_gene_expr_recon_loss: 1430346.0929; train_masked_gp_l1_reg_loss: 5014.9754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2836.3280; train_global_loss: 1524966.3696; train_optim_loss: 1524966.3696; val_kl_reg_loss: 7496.4609; val_edge_recon_loss: 78732.2401; val_gene_expr_recon_loss: 1429479.5746; val_masked_gp_l1_reg_loss: 5014.9097; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2836.2107; val_global_loss: 1523559.4002; val_optim_loss: 1523559.4002
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9618; val_auprc_score: 0.9920; val_best_acc_score: 0.9492; val_best_f1_score: 0.9708; train_kl_reg_loss: 9735.9319; train_edge_recon_loss: 82575.8490; train_gene_expr_recon_loss: 1503866.0915; train_masked_gp_l1_reg_loss: 6859.7652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8673.7614; train_global_loss: 1611711.4001; train_optim_loss: 1611711.4001; val_kl_reg_loss: 9590.7248; val_edge_recon_loss: 80163.3586; val_gene_expr_recon_loss: 1493747.0134; val_masked_gp_l1_reg_loss: 6542.2158; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7901.4233; val_global_loss: 1597944.7231; val_optim_loss: 1597944.7231
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9583; val_auprc_score: 0.9903; val_best_acc_score: 0.9483; val_best_f1_score: 0.9701; train_kl_reg_loss: 9268.6139; train_edge_recon_loss: 81799.8228; train_gene_expr_recon_loss: 1480284.2524; train_masked_gp_l1_reg_loss: 6328.8583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7344.6071; train_global_loss: 1585026.1549; train_optim_loss: 1585026.1549; val_kl_reg_loss: 9380.7170; val_edge_recon_loss: 82737.5503; val_gene_expr_recon_loss: 1473788.1694; val_masked_gp_l1_reg_loss: 6145.6616; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6883.6123; val_global_loss: 1578935.6815; val_optim_loss: 1578935.6815
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9642; val_auprc_score: 0.9918; val_best_acc_score: 0.9530; val_best_f1_score: 0.9729; train_kl_reg_loss: 8979.6940; train_edge_recon_loss: 81271.5104; train_gene_expr_recon_loss: 1463482.1184; train_masked_gp_l1_reg_loss: 6043.7970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6612.1826; train_global_loss: 1566389.3041; train_optim_loss: 1566389.3041; val_kl_reg_loss: 8821.6393; val_edge_recon_loss: 80764.9902; val_gene_expr_recon_loss: 1457807.2245; val_masked_gp_l1_reg_loss: 5938.5684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6401.4727; val_global_loss: 1559733.9745; val_optim_loss: 1559733.9745
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9597; val_auprc_score: 0.9908; val_best_acc_score: 0.9529; val_best_f1_score: 0.9727; train_kl_reg_loss: 7530.0164; train_edge_recon_loss: 79374.1875; train_gene_expr_recon_loss: 1430536.8665; train_masked_gp_l1_reg_loss: 5014.8540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2835.9737; train_global_loss: 1525291.9061; train_optim_loss: 1525291.9061; val_kl_reg_loss: 7485.7260; val_edge_recon_loss: 79865.9502; val_gene_expr_recon_loss: 1429346.0468; val_masked_gp_l1_reg_loss: 5014.8989; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2835.7930; val_global_loss: 1524548.3516; val_optim_loss: 1524548.3516
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9632; val_auprc_score: 0.9917; val_best_acc_score: 0.9535; val_best_f1_score: 0.9731; train_kl_reg_loss: 8748.7214; train_edge_recon_loss: 80644.4734; train_gene_expr_recon_loss: 1451028.6492; train_masked_gp_l1_reg_loss: 5880.7743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6270.8082; train_global_loss: 1552573.4250; train_optim_loss: 1552573.4250; val_kl_reg_loss: 8472.3037; val_edge_recon_loss: 81575.6967; val_gene_expr_recon_loss: 1446629.2769; val_masked_gp_l1_reg_loss: 5816.6655; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6145.2759; val_global_loss: 1548639.1546; val_optim_loss: 1548639.1546
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9639; val_auprc_score: 0.9920; val_best_acc_score: 0.9522; val_best_f1_score: 0.9725; train_kl_reg_loss: 8667.5797; train_edge_recon_loss: 80792.8086; train_gene_expr_recon_loss: 1441479.3111; train_masked_gp_l1_reg_loss: 5787.9450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6023.2569; train_global_loss: 1542750.8978; train_optim_loss: 1542750.8978; val_kl_reg_loss: 9019.9668; val_edge_recon_loss: 79915.2371; val_gene_expr_recon_loss: 1441079.0027; val_masked_gp_l1_reg_loss: 5732.7783; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5890.3848; val_global_loss: 1541637.3266; val_optim_loss: 1541637.3266
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9622; val_auprc_score: 0.9917; val_best_acc_score: 0.9516; val_best_f1_score: 0.9720; train_kl_reg_loss: 8584.9035; train_edge_recon_loss: 80522.6435; train_gene_expr_recon_loss: 1435371.3510; train_masked_gp_l1_reg_loss: 5720.3290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5770.1678; train_global_loss: 1535969.3934; train_optim_loss: 1535969.3934; val_kl_reg_loss: 9186.5147; val_edge_recon_loss: 81625.3243; val_gene_expr_recon_loss: 1436334.5887; val_masked_gp_l1_reg_loss: 5689.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5645.7202; val_global_loss: 1538482.0538; val_optim_loss: 1538482.0538
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9622; val_auprc_score: 0.9914; val_best_acc_score: 0.9551; val_best_f1_score: 0.9740; train_kl_reg_loss: 7525.2107; train_edge_recon_loss: 78896.2453; train_gene_expr_recon_loss: 1430496.7449; train_masked_gp_l1_reg_loss: 5014.7795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2835.6719; train_global_loss: 1524768.6475; train_optim_loss: 1524768.6475; val_kl_reg_loss: 7492.6888; val_edge_recon_loss: 78657.0393; val_gene_expr_recon_loss: 1430150.2275; val_masked_gp_l1_reg_loss: 5014.7446; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2835.4844; val_global_loss: 1524150.2068; val_optim_loss: 1524150.2068
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9605; val_auprc_score: 0.9913; val_best_acc_score: 0.9457; val_best_f1_score: 0.9686; train_kl_reg_loss: 8494.5688; train_edge_recon_loss: 80947.5343; train_gene_expr_recon_loss: 1430694.1571; train_masked_gp_l1_reg_loss: 5662.2095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5490.6749; train_global_loss: 1531289.1428; train_optim_loss: 1531289.1428; val_kl_reg_loss: 8863.1682; val_edge_recon_loss: 82302.9168; val_gene_expr_recon_loss: 1434184.5927; val_masked_gp_l1_reg_loss: 5616.4502; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5341.1738; val_global_loss: 1536308.3078; val_optim_loss: 1536308.3078
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9643; val_auprc_score: 0.9917; val_best_acc_score: 0.9586; val_best_f1_score: 0.9761; train_kl_reg_loss: 8421.3765; train_edge_recon_loss: 80287.4831; train_gene_expr_recon_loss: 1427966.1322; train_masked_gp_l1_reg_loss: 5609.0446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5216.7509; train_global_loss: 1527500.7872; train_optim_loss: 1527500.7872; val_kl_reg_loss: 8813.3944; val_edge_recon_loss: 78701.0894; val_gene_expr_recon_loss: 1431903.8387; val_masked_gp_l1_reg_loss: 5588.0708; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5097.7666; val_global_loss: 1530104.1949; val_optim_loss: 1530104.1949
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9599; val_auprc_score: 0.9907; val_best_acc_score: 0.9470; val_best_f1_score: 0.9693; train_kl_reg_loss: 8344.6719; train_edge_recon_loss: 80456.5028; train_gene_expr_recon_loss: 1426151.7330; train_masked_gp_l1_reg_loss: 5575.6700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5012.2453; train_global_loss: 1525540.8260; train_optim_loss: 1525540.8260; val_kl_reg_loss: 8633.8378; val_edge_recon_loss: 82749.9341; val_gene_expr_recon_loss: 1431130.7688; val_masked_gp_l1_reg_loss: 5551.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4937.9351; val_global_loss: 1533004.2917; val_optim_loss: 1533004.2917
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9636; val_auprc_score: 0.9912; val_best_acc_score: 0.9558; val_best_f1_score: 0.9743; train_kl_reg_loss: 8270.6556; train_edge_recon_loss: 79855.9751; train_gene_expr_recon_loss: 1424087.5865; train_masked_gp_l1_reg_loss: 5531.1902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4872.4213; train_global_loss: 1522617.8241; train_optim_loss: 1522617.8241; val_kl_reg_loss: 8331.5925; val_edge_recon_loss: 80629.2713; val_gene_expr_recon_loss: 1423846.1586; val_masked_gp_l1_reg_loss: 5517.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4812.6226; val_global_loss: 1523137.0242; val_optim_loss: 1523137.0242
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9631; val_auprc_score: 0.9918; val_best_acc_score: 0.9548; val_best_f1_score: 0.9739; train_kl_reg_loss: 7530.5870; train_edge_recon_loss: 79359.1683; train_gene_expr_recon_loss: 1430386.5180; train_masked_gp_l1_reg_loss: 5014.7486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2835.2900; train_global_loss: 1525126.3107; train_optim_loss: 1525126.3107; val_kl_reg_loss: 7480.6465; val_edge_recon_loss: 78254.0324; val_gene_expr_recon_loss: 1428948.0764; val_masked_gp_l1_reg_loss: 5014.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2835.1025; val_global_loss: 1522532.5036; val_optim_loss: 1522532.5036
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9636; val_auprc_score: 0.9913; val_best_acc_score: 0.9561; val_best_f1_score: 0.9745; train_kl_reg_loss: 8213.1770; train_edge_recon_loss: 79315.9177; train_gene_expr_recon_loss: 1421850.6468; train_masked_gp_l1_reg_loss: 5506.6261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4743.2083; train_global_loss: 1519629.5777; train_optim_loss: 1519629.5777; val_kl_reg_loss: 8108.0482; val_edge_recon_loss: 81320.2495; val_gene_expr_recon_loss: 1422230.4651; val_masked_gp_l1_reg_loss: 5490.9980; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4676.7246; val_global_loss: 1521826.5134; val_optim_loss: 1521826.5134
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9623; val_auprc_score: 0.9917; val_best_acc_score: 0.9524; val_best_f1_score: 0.9725; train_kl_reg_loss: 8214.0293; train_edge_recon_loss: 79577.4645; train_gene_expr_recon_loss: 1420824.3287; train_masked_gp_l1_reg_loss: 5495.9918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4592.8784; train_global_loss: 1518704.6889; train_optim_loss: 1518704.6889; val_kl_reg_loss: 8462.3369; val_edge_recon_loss: 79148.5627; val_gene_expr_recon_loss: 1428529.1129; val_masked_gp_l1_reg_loss: 5483.9395; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4524.5317; val_global_loss: 1526148.5108; val_optim_loss: 1526148.5108
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9666; val_auprc_score: 0.9922; val_best_acc_score: 0.9603; val_best_f1_score: 0.9771; train_kl_reg_loss: 8185.9519; train_edge_recon_loss: 79662.7616; train_gene_expr_recon_loss: 1419969.3783; train_masked_gp_l1_reg_loss: 5487.6681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4444.7018; train_global_loss: 1517750.4604; train_optim_loss: 1517750.4604; val_kl_reg_loss: 8222.6555; val_edge_recon_loss: 79414.0491; val_gene_expr_recon_loss: 1422615.3360; val_masked_gp_l1_reg_loss: 5490.2998; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4360.4697; val_global_loss: 1520102.7917; val_optim_loss: 1520102.7917
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9589; val_auprc_score: 0.9906; val_best_acc_score: 0.9529; val_best_f1_score: 0.9728; train_kl_reg_loss: 7529.7860; train_edge_recon_loss: 79530.5738; train_gene_expr_recon_loss: 1430610.7552; train_masked_gp_l1_reg_loss: 5014.6892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2834.9176; train_global_loss: 1525520.7196; train_optim_loss: 1525520.7196; val_kl_reg_loss: 7485.5768; val_edge_recon_loss: 79183.0060; val_gene_expr_recon_loss: 1428851.1897; val_masked_gp_l1_reg_loss: 5014.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2834.7388; val_global_loss: 1523369.1448; val_optim_loss: 1523369.1448
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9641; val_auprc_score: 0.9916; val_best_acc_score: 0.9549; val_best_f1_score: 0.9738; train_kl_reg_loss: 8204.0637; train_edge_recon_loss: 79907.4976; train_gene_expr_recon_loss: 1419198.9674; train_masked_gp_l1_reg_loss: 5475.1967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4288.3875; train_global_loss: 1517074.1116; train_optim_loss: 1517074.1116; val_kl_reg_loss: 8744.4712; val_edge_recon_loss: 80594.2301; val_gene_expr_recon_loss: 1421970.5806; val_masked_gp_l1_reg_loss: 5472.6523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4221.1846; val_global_loss: 1521003.0349; val_optim_loss: 1521003.0349
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9676; val_auprc_score: 0.9924; val_best_acc_score: 0.9608; val_best_f1_score: 0.9774; train_kl_reg_loss: 8180.7271; train_edge_recon_loss: 79049.3573; train_gene_expr_recon_loss: 1418513.8802; train_masked_gp_l1_reg_loss: 5461.5930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4156.2686; train_global_loss: 1515361.8287; train_optim_loss: 1515361.8287; val_kl_reg_loss: 8174.1158; val_edge_recon_loss: 78609.0222; val_gene_expr_recon_loss: 1419144.5417; val_masked_gp_l1_reg_loss: 5473.2642; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4099.4346; val_global_loss: 1515500.3011; val_optim_loss: 1515500.3011
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9669; val_auprc_score: 0.9922; val_best_acc_score: 0.9591; val_best_f1_score: 0.9763; train_kl_reg_loss: 8131.9631; train_edge_recon_loss: 79370.1961; train_gene_expr_recon_loss: 1418210.5871; train_masked_gp_l1_reg_loss: 5450.2817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4039.7734; train_global_loss: 1515202.8008; train_optim_loss: 1515202.8008; val_kl_reg_loss: 8078.9896; val_edge_recon_loss: 79804.6516; val_gene_expr_recon_loss: 1419571.3199; val_masked_gp_l1_reg_loss: 5446.7354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3991.6135; val_global_loss: 1516893.3333; val_optim_loss: 1516893.3333
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9623; val_auprc_score: 0.9913; val_best_acc_score: 0.9540; val_best_f1_score: 0.9733; train_kl_reg_loss: 7536.3088; train_edge_recon_loss: 79765.5860; train_gene_expr_recon_loss: 1430547.1358; train_masked_gp_l1_reg_loss: 5014.6035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2834.6085; train_global_loss: 1525698.2526; train_optim_loss: 1525698.2526; val_kl_reg_loss: 7493.9299; val_edge_recon_loss: 80728.5400; val_gene_expr_recon_loss: 1430018.4586; val_masked_gp_l1_reg_loss: 5014.6045; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2834.4407; val_global_loss: 1526090.0504; val_optim_loss: 1526090.0504
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9599; val_auprc_score: 0.9912; val_best_acc_score: 0.9485; val_best_f1_score: 0.9703; train_kl_reg_loss: 8139.2476; train_edge_recon_loss: 79950.7999; train_gene_expr_recon_loss: 1417833.8522; train_masked_gp_l1_reg_loss: 5445.0965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3944.6112; train_global_loss: 1515313.6069; train_optim_loss: 1515313.6069; val_kl_reg_loss: 8610.2821; val_edge_recon_loss: 81807.2155; val_gene_expr_recon_loss: 1424438.6384; val_masked_gp_l1_reg_loss: 5425.8374; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3907.6460; val_global_loss: 1524189.6425; val_optim_loss: 1524189.6425
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9668; val_auprc_score: 0.9917; val_best_acc_score: 0.9613; val_best_f1_score: 0.9776; train_kl_reg_loss: 8110.3736; train_edge_recon_loss: 80136.6657; train_gene_expr_recon_loss: 1417802.3738; train_masked_gp_l1_reg_loss: 5431.9395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3869.8690; train_global_loss: 1515351.2240; train_optim_loss: 1515351.2240; val_kl_reg_loss: 8609.0074; val_edge_recon_loss: 81231.2426; val_gene_expr_recon_loss: 1424205.8589; val_masked_gp_l1_reg_loss: 5421.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3833.3860; val_global_loss: 1523301.2339; val_optim_loss: 1523301.2339
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9616; val_auprc_score: 0.9915; val_best_acc_score: 0.9550; val_best_f1_score: 0.9741; train_kl_reg_loss: 7917.7722; train_edge_recon_loss: 79600.7373; train_gene_expr_recon_loss: 1425869.6640; train_masked_gp_l1_reg_loss: 5568.5081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3932.5765; train_global_loss: 1522889.2560; train_optim_loss: 1522889.2560; val_kl_reg_loss: 7763.5581; val_edge_recon_loss: 78823.8501; val_gene_expr_recon_loss: 1423963.1022; val_masked_gp_l1_reg_loss: 5437.6904; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3956.8516; val_global_loss: 1519945.1398; val_optim_loss: 1519945.1398
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9607; val_auprc_score: 0.9908; val_best_acc_score: 0.9544; val_best_f1_score: 0.9735; train_kl_reg_loss: 7528.9286; train_edge_recon_loss: 79386.8699; train_gene_expr_recon_loss: 1430551.7345; train_masked_gp_l1_reg_loss: 5014.5710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2834.2614; train_global_loss: 1525316.3767; train_optim_loss: 1525316.3767; val_kl_reg_loss: 7496.0664; val_edge_recon_loss: 79972.7210; val_gene_expr_recon_loss: 1430245.8165; val_masked_gp_l1_reg_loss: 5014.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2834.0352; val_global_loss: 1525563.1079; val_optim_loss: 1525563.1079

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9625; val_auprc_score: 0.9914; val_best_acc_score: 0.9553; val_best_f1_score: 0.9741; train_kl_reg_loss: 7762.7362; train_edge_recon_loss: 80025.6473; train_gene_expr_recon_loss: 1421195.5016; train_masked_gp_l1_reg_loss: 5205.1974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3851.3855; train_global_loss: 1518040.4671; train_optim_loss: 1518040.4671; val_kl_reg_loss: 7792.1981; val_edge_recon_loss: 80379.1241; val_gene_expr_recon_loss: 1421390.8454; val_masked_gp_l1_reg_loss: 5169.7114; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3811.5898; val_global_loss: 1518543.5457; val_optim_loss: 1518543.5457
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9625; val_auprc_score: 0.9915; val_best_acc_score: 0.9552; val_best_f1_score: 0.9741; train_kl_reg_loss: 7800.7601; train_edge_recon_loss: 79980.0591; train_gene_expr_recon_loss: 1420665.5105; train_masked_gp_l1_reg_loss: 5157.4334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3780.3245; train_global_loss: 1517384.0941; train_optim_loss: 1517384.0941; val_kl_reg_loss: 7856.6732; val_edge_recon_loss: 79566.6553; val_gene_expr_recon_loss: 1421023.0941; val_masked_gp_l1_reg_loss: 5145.3154; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3746.5916; val_global_loss: 1517338.4194; val_optim_loss: 1517338.4194
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9622; val_auprc_score: 0.9918; val_best_acc_score: 0.9568; val_best_f1_score: 0.9751; train_kl_reg_loss: 7828.7566; train_edge_recon_loss: 79869.4789; train_gene_expr_recon_loss: 1420139.0136; train_masked_gp_l1_reg_loss: 5138.1279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3719.4983; train_global_loss: 1516694.8735; train_optim_loss: 1516694.8735; val_kl_reg_loss: 7812.2794; val_edge_recon_loss: 78154.9909; val_gene_expr_recon_loss: 1420599.5269; val_masked_gp_l1_reg_loss: 5130.3701; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3691.1572; val_global_loss: 1515388.3011; val_optim_loss: 1515388.3011
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9626; val_auprc_score: 0.9913; val_best_acc_score: 0.9552; val_best_f1_score: 0.9741; train_kl_reg_loss: 7527.5456; train_edge_recon_loss: 79448.4063; train_gene_expr_recon_loss: 1430625.0078; train_masked_gp_l1_reg_loss: 5014.5460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2833.8690; train_global_loss: 1525449.3808; train_optim_loss: 1525449.3808; val_kl_reg_loss: 7484.6754; val_edge_recon_loss: 79094.5542; val_gene_expr_recon_loss: 1429725.4119; val_masked_gp_l1_reg_loss: 5014.5254; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2833.7056; val_global_loss: 1524152.8948; val_optim_loss: 1524152.8948
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9604; val_auprc_score: 0.9907; val_best_acc_score: 0.9547; val_best_f1_score: 0.9738; train_kl_reg_loss: 7847.9700; train_edge_recon_loss: 79044.9387; train_gene_expr_recon_loss: 1419805.4686; train_masked_gp_l1_reg_loss: 5124.1783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3663.9487; train_global_loss: 1515486.5033; train_optim_loss: 1515486.5033; val_kl_reg_loss: 7923.9843; val_edge_recon_loss: 81255.6563; val_gene_expr_recon_loss: 1419971.2083; val_masked_gp_l1_reg_loss: 5116.9976; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3635.0989; val_global_loss: 1517902.9704; val_optim_loss: 1517902.9704
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9643; val_auprc_score: 0.9920; val_best_acc_score: 0.9566; val_best_f1_score: 0.9749; train_kl_reg_loss: 7888.3778; train_edge_recon_loss: 79341.1929; train_gene_expr_recon_loss: 1419521.1314; train_masked_gp_l1_reg_loss: 5114.0638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3611.7834; train_global_loss: 1515476.5497; train_optim_loss: 1515476.5497; val_kl_reg_loss: 7904.5404; val_edge_recon_loss: 79648.3408; val_gene_expr_recon_loss: 1420027.8898; val_masked_gp_l1_reg_loss: 5112.4658; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3587.4585; val_global_loss: 1516280.7715; val_optim_loss: 1516280.7715

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9597; val_auprc_score: 0.9910; val_best_acc_score: 0.9545; val_best_f1_score: 0.9737; train_kl_reg_loss: 7524.2719; train_edge_recon_loss: 79129.0971; train_gene_expr_recon_loss: 1430440.7977; train_masked_gp_l1_reg_loss: 5014.0620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2833.6036; train_global_loss: 1524941.8483; train_optim_loss: 1524941.8483; val_kl_reg_loss: 7496.9466; val_edge_recon_loss: 79639.9461; val_gene_expr_recon_loss: 1430441.6277; val_masked_gp_l1_reg_loss: 5013.9106; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2833.5684; val_global_loss: 1525426.0198; val_optim_loss: 1525426.0198
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9621; val_auprc_score: 0.9905; val_best_acc_score: 0.9564; val_best_f1_score: 0.9747; train_kl_reg_loss: 7993.5082; train_edge_recon_loss: 79179.0679; train_gene_expr_recon_loss: 1419917.9271; train_masked_gp_l1_reg_loss: 5119.8752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3573.0041; train_global_loss: 1515783.3828; train_optim_loss: 1515783.3828; val_kl_reg_loss: 7992.6248; val_edge_recon_loss: 81495.4589; val_gene_expr_recon_loss: 1419525.7675; val_masked_gp_l1_reg_loss: 5108.6040; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3550.3340; val_global_loss: 1517672.8495; val_optim_loss: 1517672.8495
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9630; val_auprc_score: 0.9913; val_best_acc_score: 0.9569; val_best_f1_score: 0.9750; train_kl_reg_loss: 7989.2213; train_edge_recon_loss: 79421.5112; train_gene_expr_recon_loss: 1418780.6056; train_masked_gp_l1_reg_loss: 5103.8036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3527.4613; train_global_loss: 1514822.6044; train_optim_loss: 1514822.6044; val_kl_reg_loss: 7997.9298; val_edge_recon_loss: 80622.0337; val_gene_expr_recon_loss: 1419914.1546; val_masked_gp_l1_reg_loss: 5099.7588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3505.0671; val_global_loss: 1517138.9906; val_optim_loss: 1517138.9906

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9627; val_auprc_score: 0.9914; val_best_acc_score: 0.9573; val_best_f1_score: 0.9753; train_kl_reg_loss: 7972.5515; train_edge_recon_loss: 78692.8301; train_gene_expr_recon_loss: 1418420.7224; train_masked_gp_l1_reg_loss: 5070.4773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3495.1051; train_global_loss: 1513651.6862; train_optim_loss: 1513651.6862; val_kl_reg_loss: 7987.2648; val_edge_recon_loss: 78654.3316; val_gene_expr_recon_loss: 1419421.9489; val_masked_gp_l1_reg_loss: 5064.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3491.0967; val_global_loss: 1514619.4180; val_optim_loss: 1514619.4180
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9596; val_auprc_score: 0.9909; val_best_acc_score: 0.9536; val_best_f1_score: 0.9732; train_kl_reg_loss: 7525.7334; train_edge_recon_loss: 79435.4951; train_gene_expr_recon_loss: 1430683.0543; train_masked_gp_l1_reg_loss: 5013.8543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2833.5408; train_global_loss: 1525491.6735; train_optim_loss: 1525491.6735; val_kl_reg_loss: 7477.7636; val_edge_recon_loss: 79691.9864; val_gene_expr_recon_loss: 1429535.7896; val_masked_gp_l1_reg_loss: 5013.8159; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2833.5159; val_global_loss: 1524552.9155; val_optim_loss: 1524552.9155
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9651; val_auprc_score: 0.9921; val_best_acc_score: 0.9565; val_best_f1_score: 0.9749; train_kl_reg_loss: 7977.2969; train_edge_recon_loss: 78794.5789; train_gene_expr_recon_loss: 1418326.3996; train_masked_gp_l1_reg_loss: 5064.0320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3488.1367; train_global_loss: 1513650.4434; train_optim_loss: 1513650.4434; val_kl_reg_loss: 7985.2683; val_edge_recon_loss: 80626.9470; val_gene_expr_recon_loss: 1419414.7581; val_masked_gp_l1_reg_loss: 5062.9707; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3485.3025; val_global_loss: 1516575.2218; val_optim_loss: 1516575.2218
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9619; val_auprc_score: 0.9912; val_best_acc_score: 0.9572; val_best_f1_score: 0.9753; train_kl_reg_loss: 7980.5086; train_edge_recon_loss: 79673.0945; train_gene_expr_recon_loss: 1418297.1688; train_masked_gp_l1_reg_loss: 5062.9271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3482.5868; train_global_loss: 1514496.2875; train_optim_loss: 1514496.2875; val_kl_reg_loss: 7964.7453; val_edge_recon_loss: 78965.1450; val_gene_expr_recon_loss: 1418668.1505; val_masked_gp_l1_reg_loss: 5062.6582; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3479.7900; val_global_loss: 1514140.4140; val_optim_loss: 1514140.4140
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9625; val_auprc_score: 0.9918; val_best_acc_score: 0.9555; val_best_f1_score: 0.9742; train_kl_reg_loss: 7528.8134; train_edge_recon_loss: 79572.5987; train_gene_expr_recon_loss: 1430621.5125; train_masked_gp_l1_reg_loss: 5013.7917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2833.5001; train_global_loss: 1525570.1926; train_optim_loss: 1525570.1926; val_kl_reg_loss: 7487.6510; val_edge_recon_loss: 78549.1486; val_gene_expr_recon_loss: 1428685.2689; val_masked_gp_l1_reg_loss: 5013.7749; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2833.4854; val_global_loss: 1522569.3192; val_optim_loss: 1522569.3192
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9671; val_auprc_score: 0.9926; val_best_acc_score: 0.9575; val_best_f1_score: 0.9754; train_kl_reg_loss: 7989.7758; train_edge_recon_loss: 79483.0653; train_gene_expr_recon_loss: 1418240.1219; train_masked_gp_l1_reg_loss: 5062.4588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3477.2842; train_global_loss: 1514252.7074; train_optim_loss: 1514252.7074; val_kl_reg_loss: 7999.5804; val_edge_recon_loss: 79990.9138; val_gene_expr_recon_loss: 1418409.5739; val_masked_gp_l1_reg_loss: 5062.2178; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3474.7393; val_global_loss: 1514937.0605; val_optim_loss: 1514937.0605
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9629; val_auprc_score: 0.9913; val_best_acc_score: 0.9562; val_best_f1_score: 0.9746; train_kl_reg_loss: 7997.6925; train_edge_recon_loss: 79233.1336; train_gene_expr_recon_loss: 1418483.9144; train_masked_gp_l1_reg_loss: 5062.1374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3471.9404; train_global_loss: 1514248.8223; train_optim_loss: 1514248.8223; val_kl_reg_loss: 7981.4257; val_edge_recon_loss: 79798.2974; val_gene_expr_recon_loss: 1418809.6868; val_masked_gp_l1_reg_loss: 5061.7490; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3469.8770; val_global_loss: 1515121.0336; val_optim_loss: 1515121.0336
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9633; val_auprc_score: 0.9910; val_best_acc_score: 0.9574; val_best_f1_score: 0.9753; train_kl_reg_loss: 7992.3885; train_edge_recon_loss: 79047.9881; train_gene_expr_recon_loss: 1418169.4093; train_masked_gp_l1_reg_loss: 5061.9975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3467.3151; train_global_loss: 1513739.0956; train_optim_loss: 1513739.0956; val_kl_reg_loss: 8023.2804; val_edge_recon_loss: 80427.4003; val_gene_expr_recon_loss: 1419005.2285; val_masked_gp_l1_reg_loss: 5061.9907; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3464.2349; val_global_loss: 1515982.1573; val_optim_loss: 1515982.1573
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9594; val_auprc_score: 0.9906; val_best_acc_score: 0.9540; val_best_f1_score: 0.9734; train_kl_reg_loss: 7522.1870; train_edge_recon_loss: 79167.2886; train_gene_expr_recon_loss: 1430274.8129; train_masked_gp_l1_reg_loss: 5013.7579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2833.4680; train_global_loss: 1524811.5389; train_optim_loss: 1524811.5389; val_kl_reg_loss: 7488.2001; val_edge_recon_loss: 79917.0114; val_gene_expr_recon_loss: 1430251.8894; val_masked_gp_l1_reg_loss: 5013.7427; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2833.4446; val_global_loss: 1525504.3507; val_optim_loss: 1525504.3507
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9657; val_auprc_score: 0.9928; val_best_acc_score: 0.9576; val_best_f1_score: 0.9755; train_kl_reg_loss: 8001.8579; train_edge_recon_loss: 78716.2450; train_gene_expr_recon_loss: 1418489.3378; train_masked_gp_l1_reg_loss: 5061.8960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3461.9480; train_global_loss: 1513731.2909; train_optim_loss: 1513731.2909; val_kl_reg_loss: 8009.9320; val_edge_recon_loss: 79312.3059; val_gene_expr_recon_loss: 1418698.6815; val_masked_gp_l1_reg_loss: 5061.7261; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3460.0186; val_global_loss: 1514542.6694; val_optim_loss: 1514542.6694

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 904 min 49 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9587
val AUPRC score: 0.9908
val best accuracy score: 0.9536
val best F1 score: 0.9733
val target rna MSE score: 1.0312
val source rna MSE score: 0.4534
Val cat covariate0 mean sim diff: -0.0055

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9654; val_auprc_score: 0.9916; val_best_acc_score: 0.9602; val_best_f1_score: 0.9771; train_kl_reg_loss: 7993.8655; train_edge_recon_loss: 79499.5675; train_gene_expr_recon_loss: 1418503.9461; train_masked_gp_l1_reg_loss: 5058.2600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3458.9654; train_global_loss: 1514514.6057; train_optim_loss: 1514514.6057; val_kl_reg_loss: 7996.0981; val_edge_recon_loss: 77580.2475; val_gene_expr_recon_loss: 1419216.2500; val_masked_gp_l1_reg_loss: 5057.3740; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3458.4614; val_global_loss: 1513308.4624; val_optim_loss: 1513308.4624
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9638; val_auprc_score: 0.9918; val_best_acc_score: 0.9585; val_best_f1_score: 0.9760; train_kl_reg_loss: 7995.7594; train_edge_recon_loss: 79634.9061; train_gene_expr_recon_loss: 1418246.3955; train_masked_gp_l1_reg_loss: 5057.1585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3458.1158; train_global_loss: 1514392.3271; train_optim_loss: 1514392.3271; val_kl_reg_loss: 7995.0223; val_edge_recon_loss: 78516.0916; val_gene_expr_recon_loss: 1419053.8145; val_masked_gp_l1_reg_loss: 5057.0122; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3457.7046; val_global_loss: 1514079.6694; val_optim_loss: 1514079.6694
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9629; val_auprc_score: 0.9918; val_best_acc_score: 0.9570; val_best_f1_score: 0.9752; train_kl_reg_loss: 7996.9837; train_edge_recon_loss: 79374.0108; train_gene_expr_recon_loss: 1418411.9191; train_masked_gp_l1_reg_loss: 5056.8828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3457.4146; train_global_loss: 1514297.2245; train_optim_loss: 1514297.2245; val_kl_reg_loss: 7997.8991; val_edge_recon_loss: 78733.3470; val_gene_expr_recon_loss: 1419352.1640; val_masked_gp_l1_reg_loss: 5056.8345; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3457.1230; val_global_loss: 1514597.4153; val_optim_loss: 1514597.4153
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9631; val_auprc_score: 0.9915; val_best_acc_score: 0.9588; val_best_f1_score: 0.9761; train_kl_reg_loss: 7994.4138; train_edge_recon_loss: 80037.1499; train_gene_expr_recon_loss: 1418230.0418; train_masked_gp_l1_reg_loss: 5056.7618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3456.8225; train_global_loss: 1514775.1976; train_optim_loss: 1514775.1976; val_kl_reg_loss: 7991.9737; val_edge_recon_loss: 79121.3450; val_gene_expr_recon_loss: 1418504.5699; val_masked_gp_l1_reg_loss: 5056.7437; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3456.5603; val_global_loss: 1514131.1317; val_optim_loss: 1514131.1317
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9646; val_auprc_score: 0.9916; val_best_acc_score: 0.9573; val_best_f1_score: 0.9753; train_kl_reg_loss: 7997.0734; train_edge_recon_loss: 79565.6936; train_gene_expr_recon_loss: 1418162.9300; train_masked_gp_l1_reg_loss: 5056.6721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3456.3005; train_global_loss: 1514238.6608; train_optim_loss: 1514238.6608; val_kl_reg_loss: 8013.4968; val_edge_recon_loss: 79887.8795; val_gene_expr_recon_loss: 1419738.1008; val_masked_gp_l1_reg_loss: 5056.6372; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3456.0034; val_global_loss: 1516152.1035; val_optim_loss: 1516152.1035

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9627; val_auprc_score: 0.9911; val_best_acc_score: 0.9572; val_best_f1_score: 0.9752; train_kl_reg_loss: 7996.9057; train_edge_recon_loss: 79442.3053; train_gene_expr_recon_loss: 1418150.0898; train_masked_gp_l1_reg_loss: 5056.2829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3455.9039; train_global_loss: 1514101.4800; train_optim_loss: 1514101.4800; val_kl_reg_loss: 7997.8525; val_edge_recon_loss: 79887.1641; val_gene_expr_recon_loss: 1418948.9126; val_masked_gp_l1_reg_loss: 5056.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3455.8550; val_global_loss: 1515345.9301; val_optim_loss: 1515345.9301
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9655; val_auprc_score: 0.9918; val_best_acc_score: 0.9586; val_best_f1_score: 0.9761; train_kl_reg_loss: 7994.9739; train_edge_recon_loss: 79662.3027; train_gene_expr_recon_loss: 1418202.7395; train_masked_gp_l1_reg_loss: 5056.1379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3455.8227; train_global_loss: 1514371.9769; train_optim_loss: 1514371.9769; val_kl_reg_loss: 8003.4149; val_edge_recon_loss: 78945.6683; val_gene_expr_recon_loss: 1419064.2755; val_masked_gp_l1_reg_loss: 5056.1089; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3455.7834; val_global_loss: 1514525.2325; val_optim_loss: 1514525.2325
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9653; val_auprc_score: 0.9925; val_best_acc_score: 0.9574; val_best_f1_score: 0.9754; train_kl_reg_loss: 7995.1693; train_edge_recon_loss: 79891.7419; train_gene_expr_recon_loss: 1418300.4430; train_masked_gp_l1_reg_loss: 5056.0894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3455.7475; train_global_loss: 1514699.2297; train_optim_loss: 1514699.2297; val_kl_reg_loss: 7994.9499; val_edge_recon_loss: 78737.8183; val_gene_expr_recon_loss: 1419961.3656; val_masked_gp_l1_reg_loss: 5056.0771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3455.7129; val_global_loss: 1515206.0040; val_optim_loss: 1515206.0040
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9648; val_auprc_score: 0.9912; val_best_acc_score: 0.9568; val_best_f1_score: 0.9748; train_kl_reg_loss: 8001.0654; train_edge_recon_loss: 79091.0169; train_gene_expr_recon_loss: 1418371.1822; train_masked_gp_l1_reg_loss: 5056.0638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3455.6813; train_global_loss: 1513974.9879; train_optim_loss: 1513974.9879; val_kl_reg_loss: 8007.3107; val_edge_recon_loss: 82651.8473; val_gene_expr_recon_loss: 1419621.1250; val_masked_gp_l1_reg_loss: 5056.0591; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3455.6572; val_global_loss: 1518791.9140; val_optim_loss: 1518791.9140

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 257 min 49 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9615
val AUPRC score: 0.9914
val best accuracy score: 0.9563
val best F1 score: 0.9748
val target rna MSE score: 0.8851
val source rna MSE score: 0.4557
Val cat covariate0 mean sim diff: -0.0070

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
