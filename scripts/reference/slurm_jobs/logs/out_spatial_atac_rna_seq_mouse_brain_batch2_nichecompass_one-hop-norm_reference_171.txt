[True]
Run timestamp: 08082023_065158_171.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_171']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6721; val_auprc_score: 0.7144; val_best_acc_score: 0.5248; val_best_f1_score: 0.6711; train_kl_reg_loss: 16199.8975; train_edge_recon_loss: 37638.5164; train_gene_expr_recon_loss: 527895.8570; train_masked_gp_l1_reg_loss: 3879.5042; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 780092.4413; train_global_loss: 1365706.2121; train_optim_loss: 1365706.2121; val_kl_reg_loss: 28058.2610; val_edge_recon_loss: 40634.0557; val_gene_expr_recon_loss: 454275.7148; val_masked_gp_l1_reg_loss: 3763.1821; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 748050.0312; val_global_loss: 1274781.2500; val_optim_loss: 1274781.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7529; val_auprc_score: 0.7717; val_best_acc_score: 0.6149; val_best_f1_score: 0.7039; train_kl_reg_loss: 28634.7826; train_edge_recon_loss: 39468.3030; train_gene_expr_recon_loss: 431148.7415; train_masked_gp_l1_reg_loss: 3680.0091; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731101.3475; train_global_loss: 1234033.1875; train_optim_loss: 1234033.1875; val_kl_reg_loss: 27466.0356; val_edge_recon_loss: 40577.5649; val_gene_expr_recon_loss: 423900.3789; val_masked_gp_l1_reg_loss: 3657.7676; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 725881.8984; val_global_loss: 1221483.6406; val_optim_loss: 1221483.6406
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8411; val_auprc_score: 0.8444; val_best_acc_score: 0.7561; val_best_f1_score: 0.7650; train_kl_reg_loss: 27199.7962; train_edge_recon_loss: 39393.5850; train_gene_expr_recon_loss: 414281.3527; train_masked_gp_l1_reg_loss: 3693.5522; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 712498.9081; train_global_loss: 1197067.1989; train_optim_loss: 1197067.1989; val_kl_reg_loss: 25753.4028; val_edge_recon_loss: 40353.5405; val_gene_expr_recon_loss: 407104.8203; val_masked_gp_l1_reg_loss: 3738.4346; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707919.4609; val_global_loss: 1184869.6562; val_optim_loss: 1184869.6562
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8869; val_auprc_score: 0.8832; val_best_acc_score: 0.7809; val_best_f1_score: 0.7542; train_kl_reg_loss: 24612.4129; train_edge_recon_loss: 39104.8614; train_gene_expr_recon_loss: 407290.5265; train_masked_gp_l1_reg_loss: 3790.5299; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703504.1487; train_global_loss: 1178302.4735; train_optim_loss: 1178302.4735; val_kl_reg_loss: 24238.3931; val_edge_recon_loss: 40108.8174; val_gene_expr_recon_loss: 404400.1719; val_masked_gp_l1_reg_loss: 3849.7246; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 706898.1641; val_global_loss: 1179495.2656; val_optim_loss: 1179495.2656
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9089; val_auprc_score: 0.9019; val_best_acc_score: 0.7894; val_best_f1_score: 0.8199; train_kl_reg_loss: 22797.8621; train_edge_recon_loss: 38795.6073; train_gene_expr_recon_loss: 403372.6278; train_masked_gp_l1_reg_loss: 3895.0973; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 697588.8759; train_global_loss: 1166450.0701; train_optim_loss: 1166450.0701; val_kl_reg_loss: 21912.4312; val_edge_recon_loss: 39776.1333; val_gene_expr_recon_loss: 400215.5898; val_masked_gp_l1_reg_loss: 3940.1558; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 690598.0156; val_global_loss: 1156442.3281; val_optim_loss: 1156442.3281
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9144; val_auprc_score: 0.9088; val_best_acc_score: 0.8200; val_best_f1_score: 0.8382; train_kl_reg_loss: 21236.4656; train_edge_recon_loss: 38472.7367; train_gene_expr_recon_loss: 399318.0341; train_masked_gp_l1_reg_loss: 3988.9251; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 689134.9508; train_global_loss: 1152151.1117; train_optim_loss: 1152151.1117; val_kl_reg_loss: 20594.1060; val_edge_recon_loss: 39452.3550; val_gene_expr_recon_loss: 397647.8164; val_masked_gp_l1_reg_loss: 4039.2419; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 686908.3438; val_global_loss: 1148641.8594; val_optim_loss: 1148641.8594
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9141; val_auprc_score: 0.9016; val_best_acc_score: 0.8293; val_best_f1_score: 0.8390; train_kl_reg_loss: 19956.7086; train_edge_recon_loss: 38181.1798; train_gene_expr_recon_loss: 396780.5975; train_masked_gp_l1_reg_loss: 4081.0159; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 684278.5095; train_global_loss: 1143278.0114; train_optim_loss: 1143278.0114; val_kl_reg_loss: 18967.0225; val_edge_recon_loss: 39212.8887; val_gene_expr_recon_loss: 399018.2031; val_masked_gp_l1_reg_loss: 4123.2334; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 687489.7031; val_global_loss: 1148811.0469; val_optim_loss: 1148811.0469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9210; val_auprc_score: 0.9168; val_best_acc_score: 0.8358; val_best_f1_score: 0.8402; train_kl_reg_loss: 19054.0816; train_edge_recon_loss: 37931.5181; train_gene_expr_recon_loss: 394306.4096; train_masked_gp_l1_reg_loss: 4156.6775; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 679883.4915; train_global_loss: 1135332.1799; train_optim_loss: 1135332.1799; val_kl_reg_loss: 17871.5190; val_edge_recon_loss: 38958.1660; val_gene_expr_recon_loss: 393432.1523; val_masked_gp_l1_reg_loss: 4191.2324; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 680429.0391; val_global_loss: 1134882.0938; val_optim_loss: 1134882.0938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9242; val_auprc_score: 0.9200; val_best_acc_score: 0.8319; val_best_f1_score: 0.8448; train_kl_reg_loss: 18273.7183; train_edge_recon_loss: 37726.5272; train_gene_expr_recon_loss: 391672.5786; train_masked_gp_l1_reg_loss: 4230.1832; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 674379.3485; train_global_loss: 1126282.3617; train_optim_loss: 1126282.3617; val_kl_reg_loss: 17319.7366; val_edge_recon_loss: 38750.8037; val_gene_expr_recon_loss: 391167.4492; val_masked_gp_l1_reg_loss: 4269.7583; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 679002.3047; val_global_loss: 1130510.0625; val_optim_loss: 1130510.0625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9291; val_auprc_score: 0.9237; val_best_acc_score: 0.8473; val_best_f1_score: 0.8524; train_kl_reg_loss: 17611.0880; train_edge_recon_loss: 37507.0170; train_gene_expr_recon_loss: 389409.5440; train_masked_gp_l1_reg_loss: 4294.0887; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 670881.4413; train_global_loss: 1119703.1856; train_optim_loss: 1119703.1856; val_kl_reg_loss: 16503.5724; val_edge_recon_loss: 38457.0757; val_gene_expr_recon_loss: 392134.5078; val_masked_gp_l1_reg_loss: 4328.2524; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 671889.9688; val_global_loss: 1123313.3438; val_optim_loss: 1123313.3438
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9301; val_auprc_score: 0.9260; val_best_acc_score: 0.8495; val_best_f1_score: 0.8512; train_kl_reg_loss: 16837.8850; train_edge_recon_loss: 37305.7515; train_gene_expr_recon_loss: 387511.1349; train_masked_gp_l1_reg_loss: 4364.3200; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 668153.6108; train_global_loss: 1114172.7045; train_optim_loss: 1114172.7045; val_kl_reg_loss: 16278.7990; val_edge_recon_loss: 38357.2563; val_gene_expr_recon_loss: 383776.3203; val_masked_gp_l1_reg_loss: 4394.1543; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 670963.7344; val_global_loss: 1113770.2656; val_optim_loss: 1113770.2656
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9298; val_auprc_score: 0.9259; val_best_acc_score: 0.8422; val_best_f1_score: 0.8504; train_kl_reg_loss: 16526.2686; train_edge_recon_loss: 37136.1867; train_gene_expr_recon_loss: 384982.5710; train_masked_gp_l1_reg_loss: 4423.9462; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 663956.0881; train_global_loss: 1107025.0644; train_optim_loss: 1107025.0644; val_kl_reg_loss: 16006.7570; val_edge_recon_loss: 38154.3467; val_gene_expr_recon_loss: 386935.8633; val_masked_gp_l1_reg_loss: 4458.0464; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 660823.6953; val_global_loss: 1106378.6875; val_optim_loss: 1106378.6875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9348; val_auprc_score: 0.9330; val_best_acc_score: 0.8506; val_best_f1_score: 0.8534; train_kl_reg_loss: 16238.4381; train_edge_recon_loss: 36974.1065; train_gene_expr_recon_loss: 383424.9328; train_masked_gp_l1_reg_loss: 4484.3306; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 660459.5256; train_global_loss: 1101581.3277; train_optim_loss: 1101581.3277; val_kl_reg_loss: 15689.3616; val_edge_recon_loss: 37985.4312; val_gene_expr_recon_loss: 385718.5547; val_masked_gp_l1_reg_loss: 4501.8398; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 662619.0625; val_global_loss: 1106514.2656; val_optim_loss: 1106514.2656
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9349; val_auprc_score: 0.9361; val_best_acc_score: 0.8511; val_best_f1_score: 0.8553; train_kl_reg_loss: 15885.4296; train_edge_recon_loss: 36810.0250; train_gene_expr_recon_loss: 381214.7727; train_masked_gp_l1_reg_loss: 4530.5853; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 655913.6193; train_global_loss: 1094354.4356; train_optim_loss: 1094354.4356; val_kl_reg_loss: 15177.2732; val_edge_recon_loss: 37806.6060; val_gene_expr_recon_loss: 384641.2422; val_masked_gp_l1_reg_loss: 4571.5776; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 658426.6406; val_global_loss: 1100623.3438; val_optim_loss: 1100623.3438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9394; val_auprc_score: 0.9357; val_best_acc_score: 0.8592; val_best_f1_score: 0.8644; train_kl_reg_loss: 15525.8706; train_edge_recon_loss: 36613.1887; train_gene_expr_recon_loss: 379389.1591; train_masked_gp_l1_reg_loss: 4589.6531; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 652698.7348; train_global_loss: 1088816.6061; train_optim_loss: 1088816.6061; val_kl_reg_loss: 14768.1415; val_edge_recon_loss: 37485.1743; val_gene_expr_recon_loss: 382714.5781; val_masked_gp_l1_reg_loss: 4614.7178; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 655116.6562; val_global_loss: 1094699.2734; val_optim_loss: 1094699.2734
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9447; val_auprc_score: 0.9459; val_best_acc_score: 0.8627; val_best_f1_score: 0.8636; train_kl_reg_loss: 15209.7129; train_edge_recon_loss: 36438.9983; train_gene_expr_recon_loss: 377689.4271; train_masked_gp_l1_reg_loss: 4641.7460; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 651545.4318; train_global_loss: 1085525.3153; train_optim_loss: 1085525.3153; val_kl_reg_loss: 14814.2611; val_edge_recon_loss: 37362.9863; val_gene_expr_recon_loss: 386061.1602; val_masked_gp_l1_reg_loss: 4663.9375; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 653150.3125; val_global_loss: 1096052.6562; val_optim_loss: 1096052.6562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9482; val_auprc_score: 0.9489; val_best_acc_score: 0.8696; val_best_f1_score: 0.8702; train_kl_reg_loss: 14956.2986; train_edge_recon_loss: 36278.3422; train_gene_expr_recon_loss: 375773.1468; train_masked_gp_l1_reg_loss: 4691.9174; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 648481.0227; train_global_loss: 1080180.7311; train_optim_loss: 1080180.7311; val_kl_reg_loss: 14265.4222; val_edge_recon_loss: 37110.7568; val_gene_expr_recon_loss: 381172.9023; val_masked_gp_l1_reg_loss: 4717.4971; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 649356.5391; val_global_loss: 1086623.1094; val_optim_loss: 1086623.1094
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9479; val_auprc_score: 0.9468; val_best_acc_score: 0.8677; val_best_f1_score: 0.8722; train_kl_reg_loss: 14774.0863; train_edge_recon_loss: 36121.3738; train_gene_expr_recon_loss: 373776.1080; train_masked_gp_l1_reg_loss: 4741.1726; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 644892.0824; train_global_loss: 1074304.8229; train_optim_loss: 1074304.8229; val_kl_reg_loss: 13939.1429; val_edge_recon_loss: 36866.7637; val_gene_expr_recon_loss: 378373.4258; val_masked_gp_l1_reg_loss: 4773.1489; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 651760.3438; val_global_loss: 1085712.8281; val_optim_loss: 1085712.8281
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9494; val_auprc_score: 0.9507; val_best_acc_score: 0.8689; val_best_f1_score: 0.8710; train_kl_reg_loss: 14572.9481; train_edge_recon_loss: 35983.4493; train_gene_expr_recon_loss: 372800.7259; train_masked_gp_l1_reg_loss: 4794.3414; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 644992.9261; train_global_loss: 1073144.3864; train_optim_loss: 1073144.3864; val_kl_reg_loss: 14267.2507; val_edge_recon_loss: 36822.4341; val_gene_expr_recon_loss: 375281.3359; val_masked_gp_l1_reg_loss: 4823.2227; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 643353.7344; val_global_loss: 1074547.9766; val_optim_loss: 1074547.9766
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9493; val_auprc_score: 0.9507; val_best_acc_score: 0.8719; val_best_f1_score: 0.8714; train_kl_reg_loss: 14456.3193; train_edge_recon_loss: 35832.1165; train_gene_expr_recon_loss: 370611.6009; train_masked_gp_l1_reg_loss: 4838.9467; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 641107.5720; train_global_loss: 1066846.5521; train_optim_loss: 1066846.5521; val_kl_reg_loss: 14068.8649; val_edge_recon_loss: 36702.7827; val_gene_expr_recon_loss: 378692.2461; val_masked_gp_l1_reg_loss: 4863.6284; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 646344.2891; val_global_loss: 1080671.7969; val_optim_loss: 1080671.7969
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9596; val_auprc_score: 0.9603; val_best_acc_score: 0.8871; val_best_f1_score: 0.8883; train_kl_reg_loss: 14315.1739; train_edge_recon_loss: 35688.1606; train_gene_expr_recon_loss: 368981.5123; train_masked_gp_l1_reg_loss: 4888.5873; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 638605.2689; train_global_loss: 1062478.6989; train_optim_loss: 1062478.6989; val_kl_reg_loss: 13867.2097; val_edge_recon_loss: 36451.7627; val_gene_expr_recon_loss: 373989.7617; val_masked_gp_l1_reg_loss: 4916.3125; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 641609.7188; val_global_loss: 1070834.7734; val_optim_loss: 1070834.7734
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9616; val_auprc_score: 0.9600; val_best_acc_score: 0.8872; val_best_f1_score: 0.8860; train_kl_reg_loss: 14211.3717; train_edge_recon_loss: 35562.3432; train_gene_expr_recon_loss: 367033.8442; train_masked_gp_l1_reg_loss: 4938.3522; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 636162.4972; train_global_loss: 1057908.4119; train_optim_loss: 1057908.4119; val_kl_reg_loss: 13790.9016; val_edge_recon_loss: 36332.7739; val_gene_expr_recon_loss: 373878.5391; val_masked_gp_l1_reg_loss: 4965.5166; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 641711.2734; val_global_loss: 1070679.0000; val_optim_loss: 1070679.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9637; val_auprc_score: 0.9647; val_best_acc_score: 0.8923; val_best_f1_score: 0.8930; train_kl_reg_loss: 14136.7258; train_edge_recon_loss: 35439.7268; train_gene_expr_recon_loss: 365774.5625; train_masked_gp_l1_reg_loss: 4983.6931; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 634210.8797; train_global_loss: 1054545.5881; train_optim_loss: 1054545.5881; val_kl_reg_loss: 13518.0413; val_edge_recon_loss: 36165.5967; val_gene_expr_recon_loss: 370952.7305; val_masked_gp_l1_reg_loss: 5013.6333; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 635041.0938; val_global_loss: 1060691.1094; val_optim_loss: 1060691.1094
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9662; val_auprc_score: 0.9647; val_best_acc_score: 0.8981; val_best_f1_score: 0.8978; train_kl_reg_loss: 14021.0112; train_edge_recon_loss: 35297.7338; train_gene_expr_recon_loss: 363727.4228; train_masked_gp_l1_reg_loss: 5033.1055; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 631781.0000; train_global_loss: 1049860.2822; train_optim_loss: 1049860.2822; val_kl_reg_loss: 13501.6772; val_edge_recon_loss: 36045.3242; val_gene_expr_recon_loss: 372828.9180; val_masked_gp_l1_reg_loss: 5055.9956; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 632938.7734; val_global_loss: 1060370.7109; val_optim_loss: 1060370.7109
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9710; val_auprc_score: 0.9705; val_best_acc_score: 0.9027; val_best_f1_score: 0.9045; train_kl_reg_loss: 13941.0021; train_edge_recon_loss: 35168.0003; train_gene_expr_recon_loss: 362132.2064; train_masked_gp_l1_reg_loss: 5077.7372; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 629672.8826; train_global_loss: 1045991.8295; train_optim_loss: 1045991.8295; val_kl_reg_loss: 13546.0088; val_edge_recon_loss: 35926.6152; val_gene_expr_recon_loss: 372231.0469; val_masked_gp_l1_reg_loss: 5105.3232; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 627822.1562; val_global_loss: 1054631.1562; val_optim_loss: 1054631.1562
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9645; val_auprc_score: 0.9682; val_best_acc_score: 0.9033; val_best_f1_score: 0.9016; train_kl_reg_loss: 9193.6930; train_edge_recon_loss: 38033.6444; train_gene_expr_recon_loss: 393723.9915; train_masked_gp_l1_reg_loss: 5156.7922; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 663254.4801; train_global_loss: 1109362.5947; train_optim_loss: 1109362.5947; val_kl_reg_loss: 6121.4902; val_edge_recon_loss: 38156.9404; val_gene_expr_recon_loss: 395873.3203; val_masked_gp_l1_reg_loss: 5204.7549; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 666873.5625; val_global_loss: 1112230.0781; val_optim_loss: 1112230.0781
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9282; val_auprc_score: 0.9342; val_best_acc_score: 0.8406; val_best_f1_score: 0.8478; train_kl_reg_loss: 14569369768726161408.0000; train_edge_recon_loss: 37887.8694; train_gene_expr_recon_loss: 399830.2614; train_masked_gp_l1_reg_loss: 5197.8768; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 666218.0256; train_global_loss: 14569369768727252992.0000; train_optim_loss: 14569369768727252992.0000; val_kl_reg_loss: 3683868078.3140; val_edge_recon_loss: 38200.0698; val_gene_expr_recon_loss: 409175.6289; val_masked_gp_l1_reg_loss: 5170.6504; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 675764.7812; val_global_loss: 3684996652.3594; val_optim_loss: 3684996652.3594
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8977; val_auprc_score: 0.9078; val_best_acc_score: 0.8170; val_best_f1_score: 0.8132; train_kl_reg_loss: 770333845.8543; train_edge_recon_loss: 37930.9318; train_gene_expr_recon_loss: 418492.6993; train_masked_gp_l1_reg_loss: 5198.3873; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 681695.8352; train_global_loss: 771477149.8125; train_optim_loss: 771477149.8125; val_kl_reg_loss: 12653.9686; val_edge_recon_loss: 38252.9790; val_gene_expr_recon_loss: 419730.3789; val_masked_gp_l1_reg_loss: 5213.7432; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 686499.6797; val_global_loss: 1162350.7500; val_optim_loss: 1162350.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9336; val_auprc_score: 0.9344; val_best_acc_score: 0.8597; val_best_f1_score: 0.8600; train_kl_reg_loss: 37860.2072; train_edge_recon_loss: 36965.8409; train_gene_expr_recon_loss: 416833.1652; train_masked_gp_l1_reg_loss: 5159.3749; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 681475.6193; train_global_loss: 1178294.2008; train_optim_loss: 1178294.2008; val_kl_reg_loss: 9676.3475; val_edge_recon_loss: 36353.4199; val_gene_expr_recon_loss: 416249.7500; val_masked_gp_l1_reg_loss: 5098.0483; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 682064.8516; val_global_loss: 1149442.4219; val_optim_loss: 1149442.4219

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9396; val_auprc_score: 0.9429; val_best_acc_score: 0.8618; val_best_f1_score: 0.8643; train_kl_reg_loss: 659158.1603; train_edge_recon_loss: 35690.7391; train_gene_expr_recon_loss: 412046.0895; train_masked_gp_l1_reg_loss: 5057.6871; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 679813.0748; train_global_loss: 1791765.7348; train_optim_loss: 1791765.7348; val_kl_reg_loss: 9500.8793; val_edge_recon_loss: 35926.0317; val_gene_expr_recon_loss: 420416.5820; val_masked_gp_l1_reg_loss: 5043.0122; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 688074.9688; val_global_loss: 1158961.4844; val_optim_loss: 1158961.4844
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9428; val_auprc_score: 0.9446; val_best_acc_score: 0.8700; val_best_f1_score: 0.8731; train_kl_reg_loss: 3699813.7041; train_edge_recon_loss: 35606.6992; train_gene_expr_recon_loss: 413714.7670; train_masked_gp_l1_reg_loss: 5034.8778; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 678573.6326; train_global_loss: 4832744.0000; train_optim_loss: 4832744.0000; val_kl_reg_loss: 9136.8433; val_edge_recon_loss: 35747.5439; val_gene_expr_recon_loss: 409854.8203; val_masked_gp_l1_reg_loss: 5026.8867; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 674151.8281; val_global_loss: 1133917.9062; val_optim_loss: 1133917.9062
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9442; val_auprc_score: 0.9456; val_best_acc_score: 0.8705; val_best_f1_score: 0.8751; train_kl_reg_loss: 11561.6347; train_edge_recon_loss: 35370.6888; train_gene_expr_recon_loss: 412127.7822; train_masked_gp_l1_reg_loss: 5019.6086; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 677863.4100; train_global_loss: 1141943.1269; train_optim_loss: 1141943.1269; val_kl_reg_loss: 8984.2167; val_edge_recon_loss: 35595.7544; val_gene_expr_recon_loss: 416492.9844; val_masked_gp_l1_reg_loss: 5012.0625; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 688093.9688; val_global_loss: 1154178.9688; val_optim_loss: 1154178.9688
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9463; val_auprc_score: 0.9441; val_best_acc_score: 0.8729; val_best_f1_score: 0.8785; train_kl_reg_loss: 10634.2727; train_edge_recon_loss: 35187.5594; train_gene_expr_recon_loss: 412925.6293; train_masked_gp_l1_reg_loss: 5005.2253; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 677716.4962; train_global_loss: 1141469.1875; train_optim_loss: 1141469.1875; val_kl_reg_loss: 8873.5148; val_edge_recon_loss: 35533.1362; val_gene_expr_recon_loss: 417003.6289; val_masked_gp_l1_reg_loss: 4997.7070; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 680614.4141; val_global_loss: 1147022.4219; val_optim_loss: 1147022.4219

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 46 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9608
val AUPRC score: 0.9657
val best accuracy score: 0.8833
val best F1 score: 0.8870
val target rna MSE score: 0.5443
val source rna MSE score: 0.3068
val target atac MSE score: 0.1353
val source atac MSE score: 0.0221
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
