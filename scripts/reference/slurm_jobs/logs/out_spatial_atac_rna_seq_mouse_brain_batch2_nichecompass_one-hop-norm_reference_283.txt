[True]
Run timestamp: 07092023_062321_283.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_283']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 27116 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 31634, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7859; val_auprc_score: 0.8035; val_best_acc_score: 0.6024; val_best_f1_score: 0.7060; train_kl_reg_loss: 89423.6844; train_edge_recon_loss: 3668911.2004; train_gene_expr_recon_loss: 17518360.5038; train_masked_gp_l1_reg_loss: 49866.1908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5940195.6932; train_chrom_access_recon_loss: 62188271.0229; train_global_loss: 89455027.9695; train_optim_loss: 89455027.9695; val_kl_reg_loss: 113841.6479; val_edge_recon_loss: 4059330.3167; val_gene_expr_recon_loss: 16165062.0667; val_masked_gp_l1_reg_loss: 45940.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 581055.9375; val_chrom_access_recon_loss: 59808345.0667; val_global_loss: 80773574.4000; val_optim_loss: 80773574.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8219; val_auprc_score: 0.8272; val_best_acc_score: 0.7297; val_best_f1_score: 0.7386; train_kl_reg_loss: 132829.1000; train_edge_recon_loss: 3543855.1374; train_gene_expr_recon_loss: 15661228.7405; train_masked_gp_l1_reg_loss: 42674.1670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 384723.4260; train_chrom_access_recon_loss: 59183949.4962; train_global_loss: 78949259.9695; train_optim_loss: 78949259.9695; val_kl_reg_loss: 138942.9281; val_edge_recon_loss: 4009314.1500; val_gene_expr_recon_loss: 15437701.3333; val_masked_gp_l1_reg_loss: 41864.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 270822.0312; val_chrom_access_recon_loss: 58435315.7333; val_global_loss: 78333960.5333; val_optim_loss: 78333960.5333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8528; val_auprc_score: 0.8430; val_best_acc_score: 0.7586; val_best_f1_score: 0.7835; train_kl_reg_loss: 111516.8616; train_edge_recon_loss: 3342192.8168; train_gene_expr_recon_loss: 15344653.9466; train_masked_gp_l1_reg_loss: 43570.2540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 230504.9327; train_chrom_access_recon_loss: 58354162.0458; train_global_loss: 77426600.8550; train_optim_loss: 77426600.8550; val_kl_reg_loss: 135856.6281; val_edge_recon_loss: 3074247.2000; val_gene_expr_recon_loss: 15328065.6000; val_masked_gp_l1_reg_loss: 45590.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202907.6562; val_chrom_access_recon_loss: 58222549.6000; val_global_loss: 77009217.6000; val_optim_loss: 77009217.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8639; val_auprc_score: 0.8492; val_best_acc_score: 0.7796; val_best_f1_score: 0.8020; train_kl_reg_loss: 141593.9688; train_edge_recon_loss: 3008108.4676; train_gene_expr_recon_loss: 15164489.8092; train_masked_gp_l1_reg_loss: 46954.3823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 189706.9751; train_chrom_access_recon_loss: 57711042.6260; train_global_loss: 76261896.4885; train_optim_loss: 76261896.4885; val_kl_reg_loss: 144876.7437; val_edge_recon_loss: 2988750.3833; val_gene_expr_recon_loss: 15157534.2667; val_masked_gp_l1_reg_loss: 48186.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179432.4375; val_chrom_access_recon_loss: 57723732.5333; val_global_loss: 76242513.6000; val_optim_loss: 76242513.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8794; val_auprc_score: 0.8671; val_best_acc_score: 0.7935; val_best_f1_score: 0.8181; train_kl_reg_loss: 135633.7779; train_edge_recon_loss: 2954749.2176; train_gene_expr_recon_loss: 15009038.3206; train_masked_gp_l1_reg_loss: 49432.7741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172931.5786; train_chrom_access_recon_loss: 57173563.5725; train_global_loss: 75495349.3740; train_optim_loss: 75495349.3740; val_kl_reg_loss: 126717.4057; val_edge_recon_loss: 2935316.4333; val_gene_expr_recon_loss: 15040861.9333; val_masked_gp_l1_reg_loss: 50645.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167644.7812; val_chrom_access_recon_loss: 57045321.3333; val_global_loss: 75366508.2667; val_optim_loss: 75366508.2667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8872; val_auprc_score: 0.8728; val_best_acc_score: 0.7979; val_best_f1_score: 0.8223; train_kl_reg_loss: 128885.6632; train_edge_recon_loss: 2923849.6050; train_gene_expr_recon_loss: 14891315.4275; train_masked_gp_l1_reg_loss: 51688.4264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163076.2865; train_chrom_access_recon_loss: 56712792.3664; train_global_loss: 74871607.6947; train_optim_loss: 74871607.6947; val_kl_reg_loss: 129528.6687; val_edge_recon_loss: 2916855.2000; val_gene_expr_recon_loss: 14884728.6667; val_masked_gp_l1_reg_loss: 52669.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159501.8125; val_chrom_access_recon_loss: 56846535.2000; val_global_loss: 74989819.2000; val_optim_loss: 74989819.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9004; val_auprc_score: 0.8890; val_best_acc_score: 0.8137; val_best_f1_score: 0.8323; train_kl_reg_loss: 126858.5145; train_edge_recon_loss: 2869276.0095; train_gene_expr_recon_loss: 14771876.5267; train_masked_gp_l1_reg_loss: 53604.7125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156932.5782; train_chrom_access_recon_loss: 56289834.0458; train_global_loss: 74268382.4733; train_optim_loss: 74268382.4733; val_kl_reg_loss: 127595.2906; val_edge_recon_loss: 2890692.8833; val_gene_expr_recon_loss: 14801808.6667; val_masked_gp_l1_reg_loss: 54602.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155309.0781; val_chrom_access_recon_loss: 56281489.3333; val_global_loss: 74311498.6667; val_optim_loss: 74311498.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9239; val_auprc_score: 0.9093; val_best_acc_score: 0.8464; val_best_f1_score: 0.8565; train_kl_reg_loss: 125989.9263; train_edge_recon_loss: 2841878.0553; train_gene_expr_recon_loss: 14679289.0458; train_masked_gp_l1_reg_loss: 55420.0302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153093.5120; train_chrom_access_recon_loss: 55922622.3511; train_global_loss: 73778292.7634; train_optim_loss: 73778292.7634; val_kl_reg_loss: 124876.4734; val_edge_recon_loss: 2837990.0500; val_gene_expr_recon_loss: 14764250.6667; val_masked_gp_l1_reg_loss: 56210.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151313.2812; val_chrom_access_recon_loss: 56111867.7333; val_global_loss: 74046509.0667; val_optim_loss: 74046509.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9300; val_auprc_score: 0.9145; val_best_acc_score: 0.8576; val_best_f1_score: 0.8696; train_kl_reg_loss: 123975.5261; train_edge_recon_loss: 2827593.8435; train_gene_expr_recon_loss: 14595444.5115; train_masked_gp_l1_reg_loss: 57008.5612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149680.6484; train_chrom_access_recon_loss: 55575959.8473; train_global_loss: 73329662.8397; train_optim_loss: 73329662.8397; val_kl_reg_loss: 122087.0365; val_edge_recon_loss: 2819907.4667; val_gene_expr_recon_loss: 14634126.3333; val_masked_gp_l1_reg_loss: 57896.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147631.4375; val_chrom_access_recon_loss: 55807429.3333; val_global_loss: 73589078.9333; val_optim_loss: 73589078.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9360; val_auprc_score: 0.9214; val_best_acc_score: 0.8708; val_best_f1_score: 0.8790; train_kl_reg_loss: 123738.5388; train_edge_recon_loss: 2792307.6813; train_gene_expr_recon_loss: 14507748.4504; train_masked_gp_l1_reg_loss: 58481.7516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146809.7074; train_chrom_access_recon_loss: 55215900.4885; train_global_loss: 72844987.0534; train_optim_loss: 72844987.0534; val_kl_reg_loss: 122418.9375; val_edge_recon_loss: 2815156.0167; val_gene_expr_recon_loss: 14559590.6667; val_masked_gp_l1_reg_loss: 59431.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146084.7188; val_chrom_access_recon_loss: 55328922.4000; val_global_loss: 73031604.0000; val_optim_loss: 73031604.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9423; val_auprc_score: 0.9295; val_best_acc_score: 0.8779; val_best_f1_score: 0.8858; train_kl_reg_loss: 121449.8475; train_edge_recon_loss: 2782708.8950; train_gene_expr_recon_loss: 14440258.0458; train_masked_gp_l1_reg_loss: 59972.3339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145032.2406; train_chrom_access_recon_loss: 54878413.3740; train_global_loss: 72427835.1145; train_optim_loss: 72427835.1145; val_kl_reg_loss: 117126.9141; val_edge_recon_loss: 2792964.4333; val_gene_expr_recon_loss: 14460029.0667; val_masked_gp_l1_reg_loss: 60608.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144226.9219; val_chrom_access_recon_loss: 54991032.8000; val_global_loss: 72565987.2000; val_optim_loss: 72565987.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9483; val_auprc_score: 0.9363; val_best_acc_score: 0.8831; val_best_f1_score: 0.8888; train_kl_reg_loss: 119656.8781; train_edge_recon_loss: 2772901.4046; train_gene_expr_recon_loss: 14366428.3664; train_masked_gp_l1_reg_loss: 61238.7537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142843.8275; train_chrom_access_recon_loss: 54575987.7863; train_global_loss: 72039057.0992; train_optim_loss: 72039057.0992; val_kl_reg_loss: 115384.6109; val_edge_recon_loss: 2781712.6333; val_gene_expr_recon_loss: 14418341.0667; val_masked_gp_l1_reg_loss: 62066.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142572.7656; val_chrom_access_recon_loss: 54537146.1333; val_global_loss: 72057221.3333; val_optim_loss: 72057221.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9474; val_auprc_score: 0.9349; val_best_acc_score: 0.8852; val_best_f1_score: 0.8912; train_kl_reg_loss: 117578.2558; train_edge_recon_loss: 2760075.1031; train_gene_expr_recon_loss: 14319034.1298; train_masked_gp_l1_reg_loss: 62534.5787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141590.5889; train_chrom_access_recon_loss: 54304156.5802; train_global_loss: 71704968.7328; train_optim_loss: 71704968.7328; val_kl_reg_loss: 114521.5427; val_edge_recon_loss: 2799698.7000; val_gene_expr_recon_loss: 14399888.0667; val_masked_gp_l1_reg_loss: 63073.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141173.4688; val_chrom_access_recon_loss: 54547317.3333; val_global_loss: 72065673.0667; val_optim_loss: 72065673.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9513; val_auprc_score: 0.9374; val_best_acc_score: 0.8899; val_best_f1_score: 0.8965; train_kl_reg_loss: 116166.3139; train_edge_recon_loss: 2752517.4294; train_gene_expr_recon_loss: 14251897.4351; train_masked_gp_l1_reg_loss: 63629.3635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140486.8863; train_chrom_access_recon_loss: 53964930.8397; train_global_loss: 71289628.3053; train_optim_loss: 71289628.3053; val_kl_reg_loss: 115015.9927; val_edge_recon_loss: 2772207.8667; val_gene_expr_recon_loss: 14314236.2000; val_masked_gp_l1_reg_loss: 64151.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139820.2656; val_chrom_access_recon_loss: 54374397.0667; val_global_loss: 71779828.8000; val_optim_loss: 71779828.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9549; val_auprc_score: 0.9405; val_best_acc_score: 0.8950; val_best_f1_score: 0.9001; train_kl_reg_loss: 115811.8876; train_edge_recon_loss: 2751063.5954; train_gene_expr_recon_loss: 14211210.1450; train_masked_gp_l1_reg_loss: 64633.4134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139328.1900; train_chrom_access_recon_loss: 53725118.3206; train_global_loss: 71007165.4351; train_optim_loss: 71007165.4351; val_kl_reg_loss: 113894.6656; val_edge_recon_loss: 2754602.7500; val_gene_expr_recon_loss: 14287184.8000; val_masked_gp_l1_reg_loss: 65086.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139101.7969; val_chrom_access_recon_loss: 54211673.8667; val_global_loss: 71571546.1333; val_optim_loss: 71571546.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9609; val_auprc_score: 0.9521; val_best_acc_score: 0.9029; val_best_f1_score: 0.9075; train_kl_reg_loss: 113764.9523; train_edge_recon_loss: 2748212.0687; train_gene_expr_recon_loss: 14176342.1221; train_masked_gp_l1_reg_loss: 65812.3865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138799.4633; train_chrom_access_recon_loss: 53494069.4962; train_global_loss: 70737000.5191; train_optim_loss: 70737000.5191; val_kl_reg_loss: 113962.3057; val_edge_recon_loss: 2750612.1000; val_gene_expr_recon_loss: 14184218.0667; val_masked_gp_l1_reg_loss: 66155.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138885.0469; val_chrom_access_recon_loss: 53703031.2000; val_global_loss: 70956866.1333; val_optim_loss: 70956866.1333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9606; val_auprc_score: 0.9449; val_best_acc_score: 0.9050; val_best_f1_score: 0.9091; train_kl_reg_loss: 112157.4213; train_edge_recon_loss: 2737250.4924; train_gene_expr_recon_loss: 14122282.1221; train_masked_gp_l1_reg_loss: 66563.3620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138135.9497; train_chrom_access_recon_loss: 53209750.1679; train_global_loss: 70386139.5725; train_optim_loss: 70386139.5725; val_kl_reg_loss: 111392.7026; val_edge_recon_loss: 2745695.0667; val_gene_expr_recon_loss: 14176601.0000; val_masked_gp_l1_reg_loss: 66991.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138033.5000; val_chrom_access_recon_loss: 53460173.3333; val_global_loss: 70698888.0000; val_optim_loss: 70698888.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9645; val_auprc_score: 0.9558; val_best_acc_score: 0.9097; val_best_f1_score: 0.9133; train_kl_reg_loss: 110492.5632; train_edge_recon_loss: 2738451.8111; train_gene_expr_recon_loss: 14101081.6183; train_masked_gp_l1_reg_loss: 67303.5972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137460.6640; train_chrom_access_recon_loss: 53029844.5191; train_global_loss: 70184634.9924; train_optim_loss: 70184634.9924; val_kl_reg_loss: 109387.6932; val_edge_recon_loss: 2762651.2833; val_gene_expr_recon_loss: 14177363.0000; val_masked_gp_l1_reg_loss: 67835.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138278.1406; val_chrom_access_recon_loss: 53418935.4667; val_global_loss: 70674451.4667; val_optim_loss: 70674451.4667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9670; val_auprc_score: 0.9590; val_best_acc_score: 0.9126; val_best_f1_score: 0.9163; train_kl_reg_loss: 108455.5285; train_edge_recon_loss: 2737022.2557; train_gene_expr_recon_loss: 14065007.6412; train_masked_gp_l1_reg_loss: 68288.3411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137157.1578; train_chrom_access_recon_loss: 52792457.7405; train_global_loss: 69908388.3969; train_optim_loss: 69908388.3969; val_kl_reg_loss: 107401.2276; val_edge_recon_loss: 2734578.0333; val_gene_expr_recon_loss: 14103332.0000; val_masked_gp_l1_reg_loss: 68553.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136733.3281; val_chrom_access_recon_loss: 53363450.4000; val_global_loss: 70514049.6000; val_optim_loss: 70514049.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9657; val_auprc_score: 0.9567; val_best_acc_score: 0.9109; val_best_f1_score: 0.9150; train_kl_reg_loss: 107608.2032; train_edge_recon_loss: 2738208.2710; train_gene_expr_recon_loss: 14024761.6947; train_masked_gp_l1_reg_loss: 68997.7551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136717.4429; train_chrom_access_recon_loss: 52556951.6031; train_global_loss: 69633244.6718; train_optim_loss: 69633244.6718; val_kl_reg_loss: 106743.2839; val_edge_recon_loss: 2755169.8500; val_gene_expr_recon_loss: 14073309.5333; val_masked_gp_l1_reg_loss: 69355.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136671.5938; val_chrom_access_recon_loss: 53064493.0667; val_global_loss: 70205741.8667; val_optim_loss: 70205741.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9678; val_auprc_score: 0.9595; val_best_acc_score: 0.9202; val_best_f1_score: 0.9226; train_kl_reg_loss: 107772.2664; train_edge_recon_loss: 2728377.6832; train_gene_expr_recon_loss: 14008521.6031; train_masked_gp_l1_reg_loss: 69521.4806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136005.3960; train_chrom_access_recon_loss: 52415784.7634; train_global_loss: 69465982.8397; train_optim_loss: 69465982.8397; val_kl_reg_loss: 105845.2047; val_edge_recon_loss: 2742488.0000; val_gene_expr_recon_loss: 14043634.2000; val_masked_gp_l1_reg_loss: 69806.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135884.9219; val_chrom_access_recon_loss: 52798995.7333; val_global_loss: 69896653.8667; val_optim_loss: 69896653.8667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9698; val_auprc_score: 0.9605; val_best_acc_score: 0.9186; val_best_f1_score: 0.9208; train_kl_reg_loss: 105827.9064; train_edge_recon_loss: 2734329.3187; train_gene_expr_recon_loss: 13972924.3893; train_masked_gp_l1_reg_loss: 70101.2648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135355.9239; train_chrom_access_recon_loss: 52169194.0153; train_global_loss: 69187732.8855; train_optim_loss: 69187732.8855; val_kl_reg_loss: 104455.1172; val_edge_recon_loss: 2751043.7667; val_gene_expr_recon_loss: 14106503.6000; val_masked_gp_l1_reg_loss: 70439.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134681.9375; val_chrom_access_recon_loss: 52868532.5333; val_global_loss: 70035656.5333; val_optim_loss: 70035656.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9683; val_auprc_score: 0.9612; val_best_acc_score: 0.9147; val_best_f1_score: 0.9171; train_kl_reg_loss: 104771.6656; train_edge_recon_loss: 2738925.5267; train_gene_expr_recon_loss: 14008114.6870; train_masked_gp_l1_reg_loss: 71834.5766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137931.5980; train_chrom_access_recon_loss: 52340958.5649; train_global_loss: 69402536.7328; train_optim_loss: 69402536.7328; val_kl_reg_loss: 88355.5250; val_edge_recon_loss: 2785655.0000; val_gene_expr_recon_loss: 14193588.9333; val_masked_gp_l1_reg_loss: 75740.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141972.5312; val_chrom_access_recon_loss: 53371621.0667; val_global_loss: 70656933.8667; val_optim_loss: 70656933.8667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9554; val_auprc_score: 0.9442; val_best_acc_score: 0.8971; val_best_f1_score: 0.9018; train_kl_reg_loss: 95296.7563; train_edge_recon_loss: 2806111.5210; train_gene_expr_recon_loss: 14089110.0229; train_masked_gp_l1_reg_loss: 78961.6877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144272.0136; train_chrom_access_recon_loss: 52919712.3969; train_global_loss: 70133464.2748; train_optim_loss: 70133464.2748; val_kl_reg_loss: 163982.4422; val_edge_recon_loss: 2832469.7167; val_gene_expr_recon_loss: 14203950.4000; val_masked_gp_l1_reg_loss: 79760.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143657.3438; val_chrom_access_recon_loss: 53322095.4667; val_global_loss: 70745917.3333; val_optim_loss: 70745917.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9540; val_auprc_score: 0.9437; val_best_acc_score: 0.8954; val_best_f1_score: 0.9013; train_kl_reg_loss: 190688.0243; train_edge_recon_loss: 2845766.5668; train_gene_expr_recon_loss: 14348061.2748; train_masked_gp_l1_reg_loss: 82760.2787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140073.8458; train_chrom_access_recon_loss: 53738756.1527; train_global_loss: 71346105.9542; train_optim_loss: 71346105.9542; val_kl_reg_loss: 135734.6078; val_edge_recon_loss: 2891827.1333; val_gene_expr_recon_loss: 14228798.8000; val_masked_gp_l1_reg_loss: 85498.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125943.2422; val_chrom_access_recon_loss: 53298669.3333; val_global_loss: 70766472.5333; val_optim_loss: 70766472.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9554; val_auprc_score: 0.9436; val_best_acc_score: 0.8989; val_best_f1_score: 0.9039; train_kl_reg_loss: 133122.7714; train_edge_recon_loss: 2818987.4008; train_gene_expr_recon_loss: 13977841.8321; train_masked_gp_l1_reg_loss: 83714.6421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87126.3142; train_chrom_access_recon_loss: 52491761.4351; train_global_loss: 69592554.3817; train_optim_loss: 69592554.3817; val_kl_reg_loss: 96160.4385; val_edge_recon_loss: 2793454.9333; val_gene_expr_recon_loss: 14005865.2000; val_masked_gp_l1_reg_loss: 82377.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83675.6875; val_chrom_access_recon_loss: 52238077.0667; val_global_loss: 69299611.4667; val_optim_loss: 69299611.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9577; val_auprc_score: 0.9498; val_best_acc_score: 0.8991; val_best_f1_score: 0.9037; train_kl_reg_loss: 133176.1828; train_edge_recon_loss: 2783409.0134; train_gene_expr_recon_loss: 13825958.5267; train_masked_gp_l1_reg_loss: 81703.8371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82893.9987; train_chrom_access_recon_loss: 52048160.2137; train_global_loss: 68955302.0153; train_optim_loss: 68955302.0153; val_kl_reg_loss: 95842.5542; val_edge_recon_loss: 2797965.5667; val_gene_expr_recon_loss: 13837882.4667; val_masked_gp_l1_reg_loss: 81164.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82458.3672; val_chrom_access_recon_loss: 52154095.7333; val_global_loss: 69049407.4667; val_optim_loss: 69049407.4667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9579; val_auprc_score: 0.9467; val_best_acc_score: 0.9000; val_best_f1_score: 0.9038; train_kl_reg_loss: 133278.9683; train_edge_recon_loss: 2783950.9542; train_gene_expr_recon_loss: 13727285.0000; train_masked_gp_l1_reg_loss: 80782.3849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81959.0445; train_chrom_access_recon_loss: 51772285.0687; train_global_loss: 68579541.2214; train_optim_loss: 68579541.2214; val_kl_reg_loss: 93560.4292; val_edge_recon_loss: 2795391.7667; val_gene_expr_recon_loss: 13772322.2000; val_masked_gp_l1_reg_loss: 80424.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81702.4219; val_chrom_access_recon_loss: 51887603.4667; val_global_loss: 68711004.8000; val_optim_loss: 68711004.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9568; val_auprc_score: 0.9466; val_best_acc_score: 0.9004; val_best_f1_score: 0.9045; train_kl_reg_loss: 133661.8979; train_edge_recon_loss: 2775152.0172; train_gene_expr_recon_loss: 13706153.4351; train_masked_gp_l1_reg_loss: 80126.2303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81295.5238; train_chrom_access_recon_loss: 51717063.5115; train_global_loss: 68493452.4275; train_optim_loss: 68493452.4275; val_kl_reg_loss: 91391.7979; val_edge_recon_loss: 2806955.5000; val_gene_expr_recon_loss: 13752487.5333; val_masked_gp_l1_reg_loss: 79842.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80982.9062; val_chrom_access_recon_loss: 51850935.7333; val_global_loss: 68662596.2667; val_optim_loss: 68662596.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9628; val_auprc_score: 0.9556; val_best_acc_score: 0.9047; val_best_f1_score: 0.9084; train_kl_reg_loss: 134098.3369; train_edge_recon_loss: 2773262.6832; train_gene_expr_recon_loss: 13675115.6947; train_masked_gp_l1_reg_loss: 79582.3799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80744.1179; train_chrom_access_recon_loss: 51648491.3282; train_global_loss: 68391294.5649; train_optim_loss: 68391294.5649; val_kl_reg_loss: 91227.6484; val_edge_recon_loss: 2772657.1333; val_gene_expr_recon_loss: 13735657.6000; val_masked_gp_l1_reg_loss: 79324.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80437.4141; val_chrom_access_recon_loss: 51783516.0000; val_global_loss: 68542820.5333; val_optim_loss: 68542820.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9577; val_auprc_score: 0.9462; val_best_acc_score: 0.9018; val_best_f1_score: 0.9059; train_kl_reg_loss: 133143.1408; train_edge_recon_loss: 2773912.6679; train_gene_expr_recon_loss: 13667618.0229; train_masked_gp_l1_reg_loss: 79104.2637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80346.3476; train_chrom_access_recon_loss: 51652417.1603; train_global_loss: 68386541.6794; train_optim_loss: 68386541.6794; val_kl_reg_loss: 91483.2771; val_edge_recon_loss: 2782117.5000; val_gene_expr_recon_loss: 13703040.9333; val_masked_gp_l1_reg_loss: 78893.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80238.6719; val_chrom_access_recon_loss: 51757495.7333; val_global_loss: 68493269.3333; val_optim_loss: 68493269.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9600; val_auprc_score: 0.9516; val_best_acc_score: 0.9020; val_best_f1_score: 0.9045; train_kl_reg_loss: 133117.5949; train_edge_recon_loss: 2771462.4027; train_gene_expr_recon_loss: 13652581.7405; train_masked_gp_l1_reg_loss: 78685.4070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80140.6624; train_chrom_access_recon_loss: 51564134.1679; train_global_loss: 68280122.0763; train_optim_loss: 68280122.0763; val_kl_reg_loss: 92309.7682; val_edge_recon_loss: 2787189.5500; val_gene_expr_recon_loss: 13704541.4667; val_masked_gp_l1_reg_loss: 78470.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79892.7500; val_chrom_access_recon_loss: 51737115.7333; val_global_loss: 68479519.2000; val_optim_loss: 68479519.2000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9643; val_auprc_score: 0.9559; val_best_acc_score: 0.9088; val_best_f1_score: 0.9111; train_kl_reg_loss: 132453.7230; train_edge_recon_loss: 2765243.9179; train_gene_expr_recon_loss: 13669153.7405; train_masked_gp_l1_reg_loss: 78274.2935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79731.1076; train_chrom_access_recon_loss: 51554249.8931; train_global_loss: 68279106.6260; train_optim_loss: 68279106.6260; val_kl_reg_loss: 91716.3792; val_edge_recon_loss: 2754189.5000; val_gene_expr_recon_loss: 13712126.0667; val_masked_gp_l1_reg_loss: 78082.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79627.0000; val_chrom_access_recon_loss: 51978844.0000; val_global_loss: 68694586.1333; val_optim_loss: 68694586.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9622; val_auprc_score: 0.9534; val_best_acc_score: 0.9029; val_best_f1_score: 0.9058; train_kl_reg_loss: 131794.0139; train_edge_recon_loss: 2758613.4198; train_gene_expr_recon_loss: 13634560.4656; train_masked_gp_l1_reg_loss: 77908.4458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79596.6596; train_chrom_access_recon_loss: 51546061.2214; train_global_loss: 68228534.2290; train_optim_loss: 68228534.2290; val_kl_reg_loss: 91763.4922; val_edge_recon_loss: 2783025.5500; val_gene_expr_recon_loss: 13750327.6000; val_masked_gp_l1_reg_loss: 77721.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79542.3516; val_chrom_access_recon_loss: 51991168.8000; val_global_loss: 68773550.1333; val_optim_loss: 68773550.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9600; val_auprc_score: 0.9493; val_best_acc_score: 0.9045; val_best_f1_score: 0.9083; train_kl_reg_loss: 130646.4057; train_edge_recon_loss: 2765758.3244; train_gene_expr_recon_loss: 13631067.5420; train_masked_gp_l1_reg_loss: 77545.5100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79396.2720; train_chrom_access_recon_loss: 51494248.0611; train_global_loss: 68178662.1374; train_optim_loss: 68178662.1374; val_kl_reg_loss: 91781.4839; val_edge_recon_loss: 2775384.6167; val_gene_expr_recon_loss: 13729685.5333; val_masked_gp_l1_reg_loss: 77354.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79317.9453; val_chrom_access_recon_loss: 51831218.1333; val_global_loss: 68584741.8667; val_optim_loss: 68584741.8667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9647; val_auprc_score: 0.9580; val_best_acc_score: 0.9066; val_best_f1_score: 0.9108; train_kl_reg_loss: 129567.8343; train_edge_recon_loss: 2768818.5305; train_gene_expr_recon_loss: 13615409.8092; train_masked_gp_l1_reg_loss: 77186.4615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79185.6579; train_chrom_access_recon_loss: 51459497.6183; train_global_loss: 68129665.9847; train_optim_loss: 68129665.9847; val_kl_reg_loss: 90770.4505; val_edge_recon_loss: 2762912.9667; val_gene_expr_recon_loss: 13692267.0000; val_masked_gp_l1_reg_loss: 77015.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79204.0547; val_chrom_access_recon_loss: 51765693.6000; val_global_loss: 68467864.0000; val_optim_loss: 68467864.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9641; val_auprc_score: 0.9564; val_best_acc_score: 0.9064; val_best_f1_score: 0.9098; train_kl_reg_loss: 128692.8750; train_edge_recon_loss: 2761951.9046; train_gene_expr_recon_loss: 13621254.7481; train_masked_gp_l1_reg_loss: 76856.8983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79159.9748; train_chrom_access_recon_loss: 51497845.4962; train_global_loss: 68165762.1374; train_optim_loss: 68165762.1374; val_kl_reg_loss: 90811.3219; val_edge_recon_loss: 2768867.5500; val_gene_expr_recon_loss: 13658370.5333; val_masked_gp_l1_reg_loss: 76684.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79164.0469; val_chrom_access_recon_loss: 51557477.6000; val_global_loss: 68231374.6667; val_optim_loss: 68231374.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9630; val_auprc_score: 0.9557; val_best_acc_score: 0.9008; val_best_f1_score: 0.9051; train_kl_reg_loss: 127818.3739; train_edge_recon_loss: 2756516.1679; train_gene_expr_recon_loss: 13609841.7099; train_masked_gp_l1_reg_loss: 76510.5378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78937.0404; train_chrom_access_recon_loss: 51417448.5802; train_global_loss: 68067072.1527; train_optim_loss: 68067072.1527; val_kl_reg_loss: 91025.3719; val_edge_recon_loss: 2775592.6833; val_gene_expr_recon_loss: 13725458.2667; val_masked_gp_l1_reg_loss: 76335.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79033.7109; val_chrom_access_recon_loss: 51596093.8667; val_global_loss: 68343541.6000; val_optim_loss: 68343541.6000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9608; val_auprc_score: 0.9510; val_best_acc_score: 0.9033; val_best_f1_score: 0.9067; train_kl_reg_loss: 127153.1189; train_edge_recon_loss: 2765959.9924; train_gene_expr_recon_loss: 13606473.3206; train_masked_gp_l1_reg_loss: 76171.9017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78837.1481; train_chrom_access_recon_loss: 51387358.1069; train_global_loss: 68041953.8015; train_optim_loss: 68041953.8015; val_kl_reg_loss: 91148.2052; val_edge_recon_loss: 2776731.8667; val_gene_expr_recon_loss: 13659543.4667; val_masked_gp_l1_reg_loss: 76001.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78767.2500; val_chrom_access_recon_loss: 51579440.0000; val_global_loss: 68261632.8000; val_optim_loss: 68261632.8000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9650; val_auprc_score: 0.9576; val_best_acc_score: 0.9070; val_best_f1_score: 0.9113; train_kl_reg_loss: 126011.8483; train_edge_recon_loss: 2754817.3664; train_gene_expr_recon_loss: 13602259.8473; train_masked_gp_l1_reg_loss: 75846.4721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78603.3205; train_chrom_access_recon_loss: 51396747.4198; train_global_loss: 68034286.2290; train_optim_loss: 68034286.2290; val_kl_reg_loss: 90840.6667; val_edge_recon_loss: 2774912.3000; val_gene_expr_recon_loss: 13659998.2667; val_masked_gp_l1_reg_loss: 75678.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78491.8438; val_chrom_access_recon_loss: 51651397.6000; val_global_loss: 68331318.9333; val_optim_loss: 68331318.9333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9662; val_auprc_score: 0.9588; val_best_acc_score: 0.9115; val_best_f1_score: 0.9146; train_kl_reg_loss: 125879.6078; train_edge_recon_loss: 2756808.2538; train_gene_expr_recon_loss: 13599590.1450; train_masked_gp_l1_reg_loss: 75513.1252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78353.2360; train_chrom_access_recon_loss: 51416799.3282; train_global_loss: 68052943.5115; train_optim_loss: 68052943.5115; val_kl_reg_loss: 91852.0688; val_edge_recon_loss: 2773507.0000; val_gene_expr_recon_loss: 13674806.8667; val_masked_gp_l1_reg_loss: 75348.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78147.7812; val_chrom_access_recon_loss: 51913742.4000; val_global_loss: 68607404.2667; val_optim_loss: 68607404.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9615; val_auprc_score: 0.9519; val_best_acc_score: 0.9042; val_best_f1_score: 0.9080; train_kl_reg_loss: 125551.9155; train_edge_recon_loss: 2745717.2844; train_gene_expr_recon_loss: 13595223.1069; train_masked_gp_l1_reg_loss: 75291.0115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74523.4734; train_chrom_access_recon_loss: 51370492.8244; train_global_loss: 67986799.5115; train_optim_loss: 67986799.5115; val_kl_reg_loss: 91051.0932; val_edge_recon_loss: 2774063.3500; val_gene_expr_recon_loss: 13712383.0000; val_masked_gp_l1_reg_loss: 75250.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74211.6562; val_chrom_access_recon_loss: 51515172.5333; val_global_loss: 68242133.0667; val_optim_loss: 68242133.0667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9630; val_auprc_score: 0.9523; val_best_acc_score: 0.9038; val_best_f1_score: 0.9080; train_kl_reg_loss: 125466.0496; train_edge_recon_loss: 2750053.7385; train_gene_expr_recon_loss: 13598426.7863; train_masked_gp_l1_reg_loss: 75219.6981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74174.8651; train_chrom_access_recon_loss: 51361797.8321; train_global_loss: 67985138.6870; train_optim_loss: 67985138.6870; val_kl_reg_loss: 91477.4797; val_edge_recon_loss: 2768621.6167; val_gene_expr_recon_loss: 13688564.0667; val_masked_gp_l1_reg_loss: 75191.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74149.4453; val_chrom_access_recon_loss: 51831707.4667; val_global_loss: 68529710.6667; val_optim_loss: 68529710.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9630; val_auprc_score: 0.9552; val_best_acc_score: 0.9034; val_best_f1_score: 0.9089; train_kl_reg_loss: 125461.4752; train_edge_recon_loss: 2756087.0401; train_gene_expr_recon_loss: 13585644.1756; train_masked_gp_l1_reg_loss: 75167.8171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74127.1978; train_chrom_access_recon_loss: 51323166.3206; train_global_loss: 67939653.9847; train_optim_loss: 67939653.9847; val_kl_reg_loss: 91886.7271; val_edge_recon_loss: 2770366.1667; val_gene_expr_recon_loss: 13659787.2667; val_masked_gp_l1_reg_loss: 75142.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74116.6562; val_chrom_access_recon_loss: 51668576.8000; val_global_loss: 68339875.7333; val_optim_loss: 68339875.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9638; val_auprc_score: 0.9561; val_best_acc_score: 0.9062; val_best_f1_score: 0.9102; train_kl_reg_loss: 125247.1021; train_edge_recon_loss: 2755617.0687; train_gene_expr_recon_loss: 13594236.2061; train_masked_gp_l1_reg_loss: 75118.1113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74099.6391; train_chrom_access_recon_loss: 51320677.9847; train_global_loss: 67944996.3664; train_optim_loss: 67944996.3664; val_kl_reg_loss: 91544.6526; val_edge_recon_loss: 2775733.1500; val_gene_expr_recon_loss: 13698155.4000; val_masked_gp_l1_reg_loss: 75092.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74086.5234; val_chrom_access_recon_loss: 51595709.8667; val_global_loss: 68310320.5333; val_optim_loss: 68310320.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 134 min 34 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9635
val AUPRC score: 0.9549
val best accuracy score: 0.9018
val best F1 score: 0.9059
val target rna MSE score: 1.3595
val source rna MSE score: 0.5999
val target atac MSE score: 0.1261
val source atac MSE score: 0.0211
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
