[True]
Run timestamp: 27072023_022918_127.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_127']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8706; val_auprc_score: 0.9744; val_best_acc_score: 0.8540; val_best_f1_score: 0.9213; train_kl_reg_loss: 554224.5844; train_edge_recon_loss: 11334880.9349; train_gene_expr_recon_loss: 32929337.1721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44818442.4465; train_optim_loss: 44818442.4465; val_kl_reg_loss: 496663.7552; val_edge_recon_loss: 11857052.3333; val_gene_expr_recon_loss: 24694964.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37048680.1667; val_optim_loss: 37048680.1667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8697; val_auprc_score: 0.9748; val_best_acc_score: 0.8552; val_best_f1_score: 0.9220; train_kl_reg_loss: 313001.1416; train_edge_recon_loss: 11206270.1907; train_gene_expr_recon_loss: 24512027.3860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36031298.6419; train_optim_loss: 36031298.6419; val_kl_reg_loss: 288814.4049; val_edge_recon_loss: 11767429.2500; val_gene_expr_recon_loss: 23425683.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35481927.5000; val_optim_loss: 35481927.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8415; val_auprc_score: 0.9691; val_best_acc_score: 0.8655; val_best_f1_score: 0.9268; train_kl_reg_loss: 279414.6432; train_edge_recon_loss: 10909290.3721; train_gene_expr_recon_loss: 23151300.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34340005.1535; train_optim_loss: 34340005.1535; val_kl_reg_loss: 213472.6100; val_edge_recon_loss: 11795866.1667; val_gene_expr_recon_loss: 22367924.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34377263.3333; val_optim_loss: 34377263.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8350; val_auprc_score: 0.9663; val_best_acc_score: 0.8626; val_best_f1_score: 0.9251; train_kl_reg_loss: 260778.7026; train_edge_recon_loss: 10799218.0140; train_gene_expr_recon_loss: 22182859.1907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33242855.9442; train_optim_loss: 33242855.9442; val_kl_reg_loss: 130167.7331; val_edge_recon_loss: 11946697.7917; val_gene_expr_recon_loss: 21417406.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33494271.8333; val_optim_loss: 33494271.8333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8283; val_auprc_score: 0.9628; val_best_acc_score: 0.8675; val_best_f1_score: 0.9275; train_kl_reg_loss: 200200.2140; train_edge_recon_loss: 10584070.4651; train_gene_expr_recon_loss: 20591935.9070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31376206.6419; train_optim_loss: 31376206.6419; val_kl_reg_loss: 155273.5462; val_edge_recon_loss: 11683839.4167; val_gene_expr_recon_loss: 20123701.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31962814.4167; val_optim_loss: 31962814.4167
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8436; val_auprc_score: 0.9645; val_best_acc_score: 0.8836; val_best_f1_score: 0.9351; train_kl_reg_loss: 173664.8901; train_edge_recon_loss: 10436062.6070; train_gene_expr_recon_loss: 20021310.7628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30631038.2698; train_optim_loss: 30631038.2698; val_kl_reg_loss: 133657.5075; val_edge_recon_loss: 11077322.0417; val_gene_expr_recon_loss: 19875755.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31086734.4167; val_optim_loss: 31086734.4167
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8499; val_auprc_score: 0.9663; val_best_acc_score: 0.8867; val_best_f1_score: 0.9370; train_kl_reg_loss: 141567.7281; train_edge_recon_loss: 10088773.4628; train_gene_expr_recon_loss: 19774887.9442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30005229.1814; train_optim_loss: 30005229.1814; val_kl_reg_loss: 122273.1064; val_edge_recon_loss: 9675996.9167; val_gene_expr_recon_loss: 19578312.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29376582.5833; val_optim_loss: 29376582.5833
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8424; val_auprc_score: 0.9644; val_best_acc_score: 0.8880; val_best_f1_score: 0.9375; train_kl_reg_loss: 155979.8365; train_edge_recon_loss: 9231202.8209; train_gene_expr_recon_loss: 19394173.7302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28781356.4558; train_optim_loss: 28781356.4558; val_kl_reg_loss: 178669.5312; val_edge_recon_loss: 9015753.4583; val_gene_expr_recon_loss: 19178167.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28372590.4167; val_optim_loss: 28372590.4167
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8455; val_auprc_score: 0.9636; val_best_acc_score: 0.8864; val_best_f1_score: 0.9364; train_kl_reg_loss: 175138.7859; train_edge_recon_loss: 8881033.0326; train_gene_expr_recon_loss: 12701043.9674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21757215.8233; train_optim_loss: 21757215.8233; val_kl_reg_loss: 184240.0957; val_edge_recon_loss: 9014477.4792; val_gene_expr_recon_loss: 8747792.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17946510.2500; val_optim_loss: 17946510.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8522; val_auprc_score: 0.9645; val_best_acc_score: 0.8866; val_best_f1_score: 0.9360; train_kl_reg_loss: 187579.1243; train_edge_recon_loss: 8717858.6302; train_gene_expr_recon_loss: 8654953.6512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17560391.3349; train_optim_loss: 17560391.3349; val_kl_reg_loss: 178240.6387; val_edge_recon_loss: 9173769.4167; val_gene_expr_recon_loss: 8561265.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17913275.5000; val_optim_loss: 17913275.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8511; val_auprc_score: 0.9656; val_best_acc_score: 0.8928; val_best_f1_score: 0.9393; train_kl_reg_loss: 176672.1963; train_edge_recon_loss: 8644203.4116; train_gene_expr_recon_loss: 8505987.2791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17326862.8605; train_optim_loss: 17326862.8605; val_kl_reg_loss: 165211.0241; val_edge_recon_loss: 8840836.4167; val_gene_expr_recon_loss: 8447070.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17453117.7917; val_optim_loss: 17453117.7917
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8653; val_auprc_score: 0.9697; val_best_acc_score: 0.8967; val_best_f1_score: 0.9417; train_kl_reg_loss: 159736.1328; train_edge_recon_loss: 8506037.7349; train_gene_expr_recon_loss: 8384692.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17050466.2233; train_optim_loss: 17050466.2233; val_kl_reg_loss: 148391.0618; val_edge_recon_loss: 8721717.4583; val_gene_expr_recon_loss: 8324941.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17195049.6667; val_optim_loss: 17195049.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8728; val_auprc_score: 0.9718; val_best_acc_score: 0.8986; val_best_f1_score: 0.9428; train_kl_reg_loss: 151965.4110; train_edge_recon_loss: 8461547.0395; train_gene_expr_recon_loss: 8269059.0233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16882571.5349; train_optim_loss: 16882571.5349; val_kl_reg_loss: 142471.2513; val_edge_recon_loss: 8372432.2083; val_gene_expr_recon_loss: 8209467.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16724370.6667; val_optim_loss: 16724370.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8768; val_auprc_score: 0.9713; val_best_acc_score: 0.8898; val_best_f1_score: 0.9377; train_kl_reg_loss: 144121.6037; train_edge_recon_loss: 8318356.0372; train_gene_expr_recon_loss: 8162864.3233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16625341.9814; train_optim_loss: 16625341.9814; val_kl_reg_loss: 133273.4170; val_edge_recon_loss: 8843548.3333; val_gene_expr_recon_loss: 8104928.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17081750.0833; val_optim_loss: 17081750.0833
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8833; val_auprc_score: 0.9749; val_best_acc_score: 0.8928; val_best_f1_score: 0.9399; train_kl_reg_loss: 132086.6160; train_edge_recon_loss: 8243699.6302; train_gene_expr_recon_loss: 8058071.2279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16433857.4558; train_optim_loss: 16433857.4558; val_kl_reg_loss: 119266.6833; val_edge_recon_loss: 8274165.8750; val_gene_expr_recon_loss: 8010573.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16404006.2917; val_optim_loss: 16404006.2917
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8882; val_auprc_score: 0.9754; val_best_acc_score: 0.8966; val_best_f1_score: 0.9420; train_kl_reg_loss: 118430.2889; train_edge_recon_loss: 8121166.5326; train_gene_expr_recon_loss: 7966130.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16205727.6651; train_optim_loss: 16205727.6651; val_kl_reg_loss: 108450.4766; val_edge_recon_loss: 8244318.8125; val_gene_expr_recon_loss: 7915575.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16268345.3750; val_optim_loss: 16268345.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8913; val_auprc_score: 0.9757; val_best_acc_score: 0.8992; val_best_f1_score: 0.9429; train_kl_reg_loss: 101378.7507; train_edge_recon_loss: 8205167.2256; train_gene_expr_recon_loss: 7877168.8186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16183714.8279; train_optim_loss: 16183714.8279; val_kl_reg_loss: 90916.3659; val_edge_recon_loss: 8293422.4167; val_gene_expr_recon_loss: 7829733.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16214071.9583; val_optim_loss: 16214071.9583
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9182; val_auprc_score: 0.9819; val_best_acc_score: 0.9184; val_best_f1_score: 0.9532; train_kl_reg_loss: 85314.5201; train_edge_recon_loss: 8091505.6953; train_gene_expr_recon_loss: 7793173.1256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15969993.3721; train_optim_loss: 15969993.3721; val_kl_reg_loss: 74229.0762; val_edge_recon_loss: 8082534.5000; val_gene_expr_recon_loss: 7749778.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15906542.0833; val_optim_loss: 15906542.0833
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9149; val_auprc_score: 0.9812; val_best_acc_score: 0.9199; val_best_f1_score: 0.9543; train_kl_reg_loss: 74529.3420; train_edge_recon_loss: 8022823.1488; train_gene_expr_recon_loss: 7715078.5791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15812431.0605; train_optim_loss: 15812431.0605; val_kl_reg_loss: 68133.9880; val_edge_recon_loss: 8280736.4375; val_gene_expr_recon_loss: 7670083.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16018953.6667; val_optim_loss: 16018953.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9171; val_auprc_score: 0.9822; val_best_acc_score: 0.9183; val_best_f1_score: 0.9536; train_kl_reg_loss: 67642.5672; train_edge_recon_loss: 8014194.0163; train_gene_expr_recon_loss: 7647216.7767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15729053.3535; train_optim_loss: 15729053.3535; val_kl_reg_loss: 59456.3022; val_edge_recon_loss: 8080489.7083; val_gene_expr_recon_loss: 7610819.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15750765.5000; val_optim_loss: 15750765.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9274; val_auprc_score: 0.9836; val_best_acc_score: 0.9230; val_best_f1_score: 0.9558; train_kl_reg_loss: 60330.8677; train_edge_recon_loss: 7915169.3047; train_gene_expr_recon_loss: 7581037.2070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15556537.3907; train_optim_loss: 15556537.3907; val_kl_reg_loss: 53225.7515; val_edge_recon_loss: 7977142.9583; val_gene_expr_recon_loss: 7547861.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15578230.4583; val_optim_loss: 15578230.4583
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9277; val_auprc_score: 0.9846; val_best_acc_score: 0.9189; val_best_f1_score: 0.9537; train_kl_reg_loss: 52166.4124; train_edge_recon_loss: 7949473.5907; train_gene_expr_recon_loss: 7524959.5860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15526599.6093; train_optim_loss: 15526599.6093; val_kl_reg_loss: 49282.5173; val_edge_recon_loss: 7888494.2917; val_gene_expr_recon_loss: 7494934.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15432711.5417; val_optim_loss: 15432711.5417
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9320; val_auprc_score: 0.9853; val_best_acc_score: 0.9245; val_best_f1_score: 0.9567; train_kl_reg_loss: 48173.9342; train_edge_recon_loss: 7851739.3977; train_gene_expr_recon_loss: 7472489.2186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15372402.5442; train_optim_loss: 15372402.5442; val_kl_reg_loss: 42252.3187; val_edge_recon_loss: 7713905.1042; val_gene_expr_recon_loss: 7445518.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15201675.2917; val_optim_loss: 15201675.2917
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9378; val_auprc_score: 0.9862; val_best_acc_score: 0.9252; val_best_f1_score: 0.9568; train_kl_reg_loss: 40518.4467; train_edge_recon_loss: 7842793.3860; train_gene_expr_recon_loss: 7425964.2837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15309276.0605; train_optim_loss: 15309276.0605; val_kl_reg_loss: 37097.9054; val_edge_recon_loss: 8017842.5833; val_gene_expr_recon_loss: 7404652.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15459593.0000; val_optim_loss: 15459593.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9339; val_auprc_score: 0.9855; val_best_acc_score: 0.9232; val_best_f1_score: 0.9558; train_kl_reg_loss: 37812.2004; train_edge_recon_loss: 7793630.5140; train_gene_expr_recon_loss: 7382446.3256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15213889.0837; train_optim_loss: 15213889.0837; val_kl_reg_loss: 38057.0503; val_edge_recon_loss: 8012319.7917; val_gene_expr_recon_loss: 7358593.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15408970.2500; val_optim_loss: 15408970.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9412; val_auprc_score: 0.9872; val_best_acc_score: 0.9276; val_best_f1_score: 0.9580; train_kl_reg_loss: 37602.4993; train_edge_recon_loss: 7767740.0535; train_gene_expr_recon_loss: 7339709.3140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15145051.8512; train_optim_loss: 15145051.8512; val_kl_reg_loss: 33913.0221; val_edge_recon_loss: 8099586.3333; val_gene_expr_recon_loss: 7315534.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15449034.2500; val_optim_loss: 15449034.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9430; val_auprc_score: 0.9870; val_best_acc_score: 0.9272; val_best_f1_score: 0.9581; train_kl_reg_loss: 35433.4115; train_edge_recon_loss: 7778274.3581; train_gene_expr_recon_loss: 7301548.2256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15115255.9674; train_optim_loss: 15115255.9674; val_kl_reg_loss: 32499.8864; val_edge_recon_loss: 8099262.1667; val_gene_expr_recon_loss: 7275753.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15407515.5000; val_optim_loss: 15407515.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9416; val_auprc_score: 0.9868; val_best_acc_score: 0.9275; val_best_f1_score: 0.9579; train_kl_reg_loss: 34081.2281; train_edge_recon_loss: 7716087.9395; train_gene_expr_recon_loss: 7264545.9512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15014715.0744; train_optim_loss: 15014715.0744; val_kl_reg_loss: 32634.6783; val_edge_recon_loss: 8238329.9792; val_gene_expr_recon_loss: 7264391.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15535356.3333; val_optim_loss: 15535356.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9469; val_auprc_score: 0.9889; val_best_acc_score: 0.9314; val_best_f1_score: 0.9606; train_kl_reg_loss: 33293.7251; train_edge_recon_loss: 7725776.2698; train_gene_expr_recon_loss: 7261162.8372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15020232.7860; train_optim_loss: 15020232.7860; val_kl_reg_loss: 32168.3242; val_edge_recon_loss: 7895445.8125; val_gene_expr_recon_loss: 7259623.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15187237.2917; val_optim_loss: 15187237.2917
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9480; val_auprc_score: 0.9886; val_best_acc_score: 0.9319; val_best_f1_score: 0.9607; train_kl_reg_loss: 33134.6460; train_edge_recon_loss: 7716676.0000; train_gene_expr_recon_loss: 7254461.4372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15004272.0605; train_optim_loss: 15004272.0605; val_kl_reg_loss: 32761.8145; val_edge_recon_loss: 7988354.6875; val_gene_expr_recon_loss: 7255019.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15276136.5833; val_optim_loss: 15276136.5833
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9438; val_auprc_score: 0.9877; val_best_acc_score: 0.9315; val_best_f1_score: 0.9608; train_kl_reg_loss: 32977.6606; train_edge_recon_loss: 7791089.5907; train_gene_expr_recon_loss: 7251285.7163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15075352.9209; train_optim_loss: 15075352.9209; val_kl_reg_loss: 30941.3656; val_edge_recon_loss: 7889912.0208; val_gene_expr_recon_loss: 7255805.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15176659.0417; val_optim_loss: 15176659.0417
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9463; val_auprc_score: 0.9872; val_best_acc_score: 0.9352; val_best_f1_score: 0.9630; train_kl_reg_loss: 32244.0119; train_edge_recon_loss: 7852605.0651; train_gene_expr_recon_loss: 7246697.8698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15131546.9395; train_optim_loss: 15131546.9395; val_kl_reg_loss: 30862.4369; val_edge_recon_loss: 7733598.1042; val_gene_expr_recon_loss: 7236837.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15001298.0417; val_optim_loss: 15001298.0417
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9492; val_auprc_score: 0.9891; val_best_acc_score: 0.9338; val_best_f1_score: 0.9618; train_kl_reg_loss: 31842.4978; train_edge_recon_loss: 7748676.2698; train_gene_expr_recon_loss: 7242974.4977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15023493.2791; train_optim_loss: 15023493.2791; val_kl_reg_loss: 30697.1654; val_edge_recon_loss: 7814308.3333; val_gene_expr_recon_loss: 7238765.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15083771.1250; val_optim_loss: 15083771.1250
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9504; val_auprc_score: 0.9889; val_best_acc_score: 0.9355; val_best_f1_score: 0.9625; train_kl_reg_loss: 31980.8432; train_edge_recon_loss: 7603921.5302; train_gene_expr_recon_loss: 7237729.2465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14873631.6465; train_optim_loss: 14873631.6465; val_kl_reg_loss: 30901.6689; val_edge_recon_loss: 7958826.4375; val_gene_expr_recon_loss: 7231031.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15220759.7083; val_optim_loss: 15220759.7083
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9482; val_auprc_score: 0.9886; val_best_acc_score: 0.9377; val_best_f1_score: 0.9640; train_kl_reg_loss: 32165.9048; train_edge_recon_loss: 7839274.6209; train_gene_expr_recon_loss: 7230705.8581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15102146.3814; train_optim_loss: 15102146.3814; val_kl_reg_loss: 31577.1048; val_edge_recon_loss: 7787879.3333; val_gene_expr_recon_loss: 7227690.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15047146.6250; val_optim_loss: 15047146.6250
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9470; val_auprc_score: 0.9883; val_best_acc_score: 0.9335; val_best_f1_score: 0.9618; train_kl_reg_loss: 31877.7694; train_edge_recon_loss: 7702630.3744; train_gene_expr_recon_loss: 7227855.8140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14962363.9581; train_optim_loss: 14962363.9581; val_kl_reg_loss: 29405.1838; val_edge_recon_loss: 7829849.6250; val_gene_expr_recon_loss: 7233862.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15093117.6667; val_optim_loss: 15093117.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9466; val_auprc_score: 0.9874; val_best_acc_score: 0.9356; val_best_f1_score: 0.9632; train_kl_reg_loss: 30672.2017; train_edge_recon_loss: 7755892.7535; train_gene_expr_recon_loss: 7220533.8442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15007098.7953; train_optim_loss: 15007098.7953; val_kl_reg_loss: 29976.9972; val_edge_recon_loss: 7823735.6042; val_gene_expr_recon_loss: 7222944.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15076657.2083; val_optim_loss: 15076657.2083
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9443; val_auprc_score: 0.9874; val_best_acc_score: 0.9344; val_best_f1_score: 0.9623; train_kl_reg_loss: 30816.5718; train_edge_recon_loss: 7678533.1000; train_gene_expr_recon_loss: 7220921.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14930270.7070; train_optim_loss: 14930270.7070; val_kl_reg_loss: 29446.1873; val_edge_recon_loss: 8029943.7917; val_gene_expr_recon_loss: 7224277.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15283668.0000; val_optim_loss: 15283668.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9466; val_auprc_score: 0.9868; val_best_acc_score: 0.9321; val_best_f1_score: 0.9610; train_kl_reg_loss: 30413.8639; train_edge_recon_loss: 7776080.3837; train_gene_expr_recon_loss: 7221660.0256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15028154.2837; train_optim_loss: 15028154.2837; val_kl_reg_loss: 29600.1817; val_edge_recon_loss: 8044071.0833; val_gene_expr_recon_loss: 7220209.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15293881.3333; val_optim_loss: 15293881.3333
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9498; val_auprc_score: 0.9875; val_best_acc_score: 0.9361; val_best_f1_score: 0.9632; train_kl_reg_loss: 30539.7538; train_edge_recon_loss: 7780878.6837; train_gene_expr_recon_loss: 7220117.6279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15031536.0558; train_optim_loss: 15031536.0558; val_kl_reg_loss: 29620.1044; val_edge_recon_loss: 7880505.0417; val_gene_expr_recon_loss: 7229563.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15139688.5417; val_optim_loss: 15139688.5417

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 55 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9449
Val AUPRC score: 0.9863
Val best accuracy score: 0.9315
Val best F1 score: 0.9607
Val gene expr MSE score: 37385.6924
Val cat covariate0 mean sim diff: 0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
