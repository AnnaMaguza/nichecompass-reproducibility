[True]
Run timestamp: 10102023_014948_106.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_106']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7793; val_auprc_score: 0.7980; val_best_acc_score: 0.5338; val_best_f1_score: 0.6802; train_kl_reg_loss: 53272.6413; train_edge_recon_loss: 3508629.6126; train_gene_expr_recon_loss: 13517999.2214; train_masked_gp_l1_reg_loss: 116529.3166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2719965.1901; train_chrom_access_recon_loss: 4793463.3550; train_global_loss: 24709859.3435; train_optim_loss: 24709859.3435; val_kl_reg_loss: 84133.6526; val_edge_recon_loss: 4062824.6167; val_gene_expr_recon_loss: 12736816.0000; val_masked_gp_l1_reg_loss: 104812.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 403576.6562; val_chrom_access_recon_loss: 4616982.7333; val_global_loss: 22009145.2000; val_optim_loss: 22009145.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8073; val_auprc_score: 0.8236; val_best_acc_score: 0.7179; val_best_f1_score: 0.7302; train_kl_reg_loss: 80701.9492; train_edge_recon_loss: 3501661.3302; train_gene_expr_recon_loss: 12583738.4962; train_masked_gp_l1_reg_loss: 101255.2768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225075.5870; train_chrom_access_recon_loss: 4575793.8531; train_global_loss: 21068226.5954; train_optim_loss: 21068226.5954; val_kl_reg_loss: 78770.9021; val_edge_recon_loss: 4032594.1000; val_gene_expr_recon_loss: 12528361.7333; val_masked_gp_l1_reg_loss: 100878.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146246.4219; val_chrom_access_recon_loss: 4546014.9667; val_global_loss: 21432866.2667; val_optim_loss: 21432866.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8744; val_auprc_score: 0.8695; val_best_acc_score: 0.7825; val_best_f1_score: 0.8009; train_kl_reg_loss: 70974.9542; train_edge_recon_loss: 3316765.9332; train_gene_expr_recon_loss: 12430018.3206; train_masked_gp_l1_reg_loss: 104919.7136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121197.7644; train_chrom_access_recon_loss: 4529609.2137; train_global_loss: 20573485.8931; train_optim_loss: 20573485.8931; val_kl_reg_loss: 88471.1344; val_edge_recon_loss: 3014506.0333; val_gene_expr_recon_loss: 12457405.4667; val_masked_gp_l1_reg_loss: 112815.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104078.7266; val_chrom_access_recon_loss: 4522568.7000; val_global_loss: 20299845.6000; val_optim_loss: 20299845.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8973; val_auprc_score: 0.8778; val_best_acc_score: 0.8196; val_best_f1_score: 0.8354; train_kl_reg_loss: 96059.6814; train_edge_recon_loss: 2904128.9160; train_gene_expr_recon_loss: 12300553.6031; train_masked_gp_l1_reg_loss: 116198.8671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97227.6053; train_chrom_access_recon_loss: 4483335.7920; train_global_loss: 19997504.6412; train_optim_loss: 19997504.6412; val_kl_reg_loss: 91597.5573; val_edge_recon_loss: 2877237.5167; val_gene_expr_recon_loss: 12302251.9333; val_masked_gp_l1_reg_loss: 118498.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93764.0078; val_chrom_access_recon_loss: 4479162.9000; val_global_loss: 19962512.1333; val_optim_loss: 19962512.1333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9126; val_auprc_score: 0.8945; val_best_acc_score: 0.8385; val_best_f1_score: 0.8510; train_kl_reg_loss: 99675.2391; train_edge_recon_loss: 2852148.1374; train_gene_expr_recon_loss: 12176070.1069; train_masked_gp_l1_reg_loss: 119148.0573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92526.5609; train_chrom_access_recon_loss: 4449006.7405; train_global_loss: 19788574.7939; train_optim_loss: 19788574.7939; val_kl_reg_loss: 95050.3729; val_edge_recon_loss: 2830676.6000; val_gene_expr_recon_loss: 12165962.6667; val_masked_gp_l1_reg_loss: 119845.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90740.1094; val_chrom_access_recon_loss: 4425520.7000; val_global_loss: 19727794.9333; val_optim_loss: 19727794.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9191; val_auprc_score: 0.9046; val_best_acc_score: 0.8444; val_best_f1_score: 0.8547; train_kl_reg_loss: 96837.3716; train_edge_recon_loss: 2832198.4752; train_gene_expr_recon_loss: 12078611.4885; train_masked_gp_l1_reg_loss: 120746.0431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89035.9727; train_chrom_access_recon_loss: 4414829.1355; train_global_loss: 19632258.4580; train_optim_loss: 19632258.4580; val_kl_reg_loss: 94929.6099; val_edge_recon_loss: 2833883.0000; val_gene_expr_recon_loss: 12109997.2000; val_masked_gp_l1_reg_loss: 120881.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86968.0312; val_chrom_access_recon_loss: 4397325.5333; val_global_loss: 19643984.4000; val_optim_loss: 19643984.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9246; val_auprc_score: 0.9094; val_best_acc_score: 0.8562; val_best_f1_score: 0.8635; train_kl_reg_loss: 92846.9883; train_edge_recon_loss: 2818749.2252; train_gene_expr_recon_loss: 11987040.7786; train_masked_gp_l1_reg_loss: 121884.0479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86060.5596; train_chrom_access_recon_loss: 4387066.3378; train_global_loss: 19493647.8931; train_optim_loss: 19493647.8931; val_kl_reg_loss: 92229.3703; val_edge_recon_loss: 2839121.7000; val_gene_expr_recon_loss: 12066451.1333; val_masked_gp_l1_reg_loss: 123384.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85891.5234; val_chrom_access_recon_loss: 4390371.7000; val_global_loss: 19597450.8000; val_optim_loss: 19597450.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9316; val_auprc_score: 0.9141; val_best_acc_score: 0.8657; val_best_f1_score: 0.8723; train_kl_reg_loss: 92541.8566; train_edge_recon_loss: 2798513.6775; train_gene_expr_recon_loss: 11900631.6565; train_masked_gp_l1_reg_loss: 123425.0445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84017.7940; train_chrom_access_recon_loss: 4350695.7424; train_global_loss: 19349825.6794; train_optim_loss: 19349825.6794; val_kl_reg_loss: 90566.9911; val_edge_recon_loss: 2802646.7333; val_gene_expr_recon_loss: 11935039.8000; val_masked_gp_l1_reg_loss: 124057.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83152.2969; val_chrom_access_recon_loss: 4338337.7333; val_global_loss: 19373801.0667; val_optim_loss: 19373801.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9315; val_auprc_score: 0.9154; val_best_acc_score: 0.8655; val_best_f1_score: 0.8753; train_kl_reg_loss: 90978.6156; train_edge_recon_loss: 2801540.1508; train_gene_expr_recon_loss: 11845516.7710; train_masked_gp_l1_reg_loss: 124405.0163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81791.8794; train_chrom_access_recon_loss: 4332027.8263; train_global_loss: 19276260.3206; train_optim_loss: 19276260.3206; val_kl_reg_loss: 90322.7563; val_edge_recon_loss: 2797671.6833; val_gene_expr_recon_loss: 11917428.0667; val_masked_gp_l1_reg_loss: 124702.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80794.4375; val_chrom_access_recon_loss: 4341070.1333; val_global_loss: 19351988.6667; val_optim_loss: 19351988.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9392; val_auprc_score: 0.9229; val_best_acc_score: 0.8744; val_best_f1_score: 0.8806; train_kl_reg_loss: 88852.5233; train_edge_recon_loss: 2791243.3664; train_gene_expr_recon_loss: 11784448.5115; train_masked_gp_l1_reg_loss: 125222.9482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80095.8839; train_chrom_access_recon_loss: 4313691.9275; train_global_loss: 19183555.1145; train_optim_loss: 19183555.1145; val_kl_reg_loss: 87341.9380; val_edge_recon_loss: 2798877.6833; val_gene_expr_recon_loss: 11866328.8667; val_masked_gp_l1_reg_loss: 125629.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79377.8828; val_chrom_access_recon_loss: 4330036.5333; val_global_loss: 19287592.0000; val_optim_loss: 19287592.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9418; val_auprc_score: 0.9314; val_best_acc_score: 0.8742; val_best_f1_score: 0.8810; train_kl_reg_loss: 88145.1231; train_edge_recon_loss: 2779385.7252; train_gene_expr_recon_loss: 11744955.7176; train_masked_gp_l1_reg_loss: 125812.5697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78417.5454; train_chrom_access_recon_loss: 4295250.1947; train_global_loss: 19111966.8702; train_optim_loss: 19111966.8702; val_kl_reg_loss: 88347.0229; val_edge_recon_loss: 2788689.4667; val_gene_expr_recon_loss: 11725412.6000; val_masked_gp_l1_reg_loss: 126278.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77872.5469; val_chrom_access_recon_loss: 4267187.2667; val_global_loss: 19073787.7333; val_optim_loss: 19073787.7333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9417; val_auprc_score: 0.9306; val_best_acc_score: 0.8721; val_best_f1_score: 0.8802; train_kl_reg_loss: 87349.5766; train_edge_recon_loss: 2763895.4924; train_gene_expr_recon_loss: 11700672.3511; train_masked_gp_l1_reg_loss: 126425.0325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77108.6533; train_chrom_access_recon_loss: 4277721.2118; train_global_loss: 19033172.4580; train_optim_loss: 19033172.4580; val_kl_reg_loss: 85378.0943; val_edge_recon_loss: 2774252.6000; val_gene_expr_recon_loss: 11735352.7333; val_masked_gp_l1_reg_loss: 127171.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77027.3906; val_chrom_access_recon_loss: 4289319.6167; val_global_loss: 19088500.9333; val_optim_loss: 19088500.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9489; val_auprc_score: 0.9324; val_best_acc_score: 0.8888; val_best_f1_score: 0.8934; train_kl_reg_loss: 86644.4847; train_edge_recon_loss: 2752953.0802; train_gene_expr_recon_loss: 11647784.3588; train_masked_gp_l1_reg_loss: 126923.0273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75921.9865; train_chrom_access_recon_loss: 4253781.0286; train_global_loss: 18944007.8473; train_optim_loss: 18944007.8473; val_kl_reg_loss: 88364.9094; val_edge_recon_loss: 2748101.3000; val_gene_expr_recon_loss: 11704768.0667; val_masked_gp_l1_reg_loss: 127544.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76114.7891; val_chrom_access_recon_loss: 4254438.4000; val_global_loss: 18999331.6000; val_optim_loss: 18999331.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9486; val_auprc_score: 0.9332; val_best_acc_score: 0.8852; val_best_f1_score: 0.8924; train_kl_reg_loss: 86965.2588; train_edge_recon_loss: 2751283.4370; train_gene_expr_recon_loss: 11607926.2901; train_masked_gp_l1_reg_loss: 127257.4355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75304.0886; train_chrom_access_recon_loss: 4243765.3187; train_global_loss: 18892501.8779; train_optim_loss: 18892501.8779; val_kl_reg_loss: 86099.2036; val_edge_recon_loss: 2756824.4500; val_gene_expr_recon_loss: 11703126.5333; val_masked_gp_l1_reg_loss: 127638.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75291.7266; val_chrom_access_recon_loss: 4270013.9333; val_global_loss: 19018995.4667; val_optim_loss: 19018995.4667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9557; val_auprc_score: 0.9471; val_best_acc_score: 0.8942; val_best_f1_score: 0.8984; train_kl_reg_loss: 86201.3811; train_edge_recon_loss: 2742610.1737; train_gene_expr_recon_loss: 11581637.0687; train_masked_gp_l1_reg_loss: 127142.5188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74582.3566; train_chrom_access_recon_loss: 4231055.0000; train_global_loss: 18843228.4885; train_optim_loss: 18843228.4885; val_kl_reg_loss: 87898.3104; val_edge_recon_loss: 2733580.0167; val_gene_expr_recon_loss: 11651039.0000; val_masked_gp_l1_reg_loss: 127955.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75002.9531; val_chrom_access_recon_loss: 4248728.4833; val_global_loss: 18924205.0667; val_optim_loss: 18924205.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9570; val_auprc_score: 0.9467; val_best_acc_score: 0.8989; val_best_f1_score: 0.9032; train_kl_reg_loss: 85799.6704; train_edge_recon_loss: 2732996.2328; train_gene_expr_recon_loss: 11546552.8092; train_masked_gp_l1_reg_loss: 127496.3805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74418.4105; train_chrom_access_recon_loss: 4216124.5725; train_global_loss: 18783388.1221; train_optim_loss: 18783388.1221; val_kl_reg_loss: 85327.2604; val_edge_recon_loss: 2736550.2333; val_gene_expr_recon_loss: 11636499.0000; val_masked_gp_l1_reg_loss: 127785.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74253.4141; val_chrom_access_recon_loss: 4222233.9000; val_global_loss: 18882649.7333; val_optim_loss: 18882649.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9567; val_auprc_score: 0.9464; val_best_acc_score: 0.8963; val_best_f1_score: 0.9004; train_kl_reg_loss: 85642.0224; train_edge_recon_loss: 2729331.9084; train_gene_expr_recon_loss: 11517193.5344; train_masked_gp_l1_reg_loss: 127304.7813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74190.4143; train_chrom_access_recon_loss: 4201682.9027; train_global_loss: 18735345.7099; train_optim_loss: 18735345.7099; val_kl_reg_loss: 85428.2911; val_edge_recon_loss: 2739019.7167; val_gene_expr_recon_loss: 11583802.8000; val_masked_gp_l1_reg_loss: 127520.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74511.9375; val_chrom_access_recon_loss: 4210609.9667; val_global_loss: 18820892.8000; val_optim_loss: 18820892.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9642; val_auprc_score: 0.9558; val_best_acc_score: 0.9084; val_best_f1_score: 0.9123; train_kl_reg_loss: 84859.5851; train_edge_recon_loss: 2723094.8874; train_gene_expr_recon_loss: 11493151.8550; train_masked_gp_l1_reg_loss: 127155.2344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74951.2157; train_chrom_access_recon_loss: 4190875.5305; train_global_loss: 18694088.1527; train_optim_loss: 18694088.1527; val_kl_reg_loss: 85814.0005; val_edge_recon_loss: 2725297.6333; val_gene_expr_recon_loss: 11536051.2667; val_masked_gp_l1_reg_loss: 126899.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75266.3594; val_chrom_access_recon_loss: 4197394.4500; val_global_loss: 18746722.4000; val_optim_loss: 18746722.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9612; val_auprc_score: 0.9500; val_best_acc_score: 0.9043; val_best_f1_score: 0.9089; train_kl_reg_loss: 85641.7169; train_edge_recon_loss: 2719680.2156; train_gene_expr_recon_loss: 11474973.4275; train_masked_gp_l1_reg_loss: 126815.4397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76337.9372; train_chrom_access_recon_loss: 4185121.7519; train_global_loss: 18668570.5191; train_optim_loss: 18668570.5191; val_kl_reg_loss: 83555.4401; val_edge_recon_loss: 2741241.8667; val_gene_expr_recon_loss: 11533903.6667; val_masked_gp_l1_reg_loss: 126947.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77935.1250; val_chrom_access_recon_loss: 4191323.5333; val_global_loss: 18754907.3333; val_optim_loss: 18754907.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9657; val_auprc_score: 0.9565; val_best_acc_score: 0.9115; val_best_f1_score: 0.9141; train_kl_reg_loss: 84707.3449; train_edge_recon_loss: 2711923.0611; train_gene_expr_recon_loss: 11461818.1374; train_masked_gp_l1_reg_loss: 126581.6557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77794.2657; train_chrom_access_recon_loss: 4176427.4389; train_global_loss: 18639251.8779; train_optim_loss: 18639251.8779; val_kl_reg_loss: 85368.3406; val_edge_recon_loss: 2730881.9167; val_gene_expr_recon_loss: 11475216.8667; val_masked_gp_l1_reg_loss: 126139.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77666.5781; val_chrom_access_recon_loss: 4176825.4167; val_global_loss: 18672099.2000; val_optim_loss: 18672099.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9658; val_auprc_score: 0.9546; val_best_acc_score: 0.9134; val_best_f1_score: 0.9165; train_kl_reg_loss: 84265.2257; train_edge_recon_loss: 2713560.6145; train_gene_expr_recon_loss: 11411783.1145; train_masked_gp_l1_reg_loss: 126085.3588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78076.1095; train_chrom_access_recon_loss: 4160397.6889; train_global_loss: 18574168.0763; train_optim_loss: 18574168.0763; val_kl_reg_loss: 84168.8208; val_edge_recon_loss: 2722241.7167; val_gene_expr_recon_loss: 11477515.6667; val_masked_gp_l1_reg_loss: 125650.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77610.9609; val_chrom_access_recon_loss: 4171540.3000; val_global_loss: 18658728.6667; val_optim_loss: 18658728.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9651; val_auprc_score: 0.9551; val_best_acc_score: 0.9135; val_best_f1_score: 0.9170; train_kl_reg_loss: 83226.1196; train_edge_recon_loss: 2717027.1908; train_gene_expr_recon_loss: 11410191.2443; train_masked_gp_l1_reg_loss: 125518.4252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78090.8530; train_chrom_access_recon_loss: 4150867.5935; train_global_loss: 18564921.3435; train_optim_loss: 18564921.3435; val_kl_reg_loss: 83798.5411; val_edge_recon_loss: 2733992.1000; val_gene_expr_recon_loss: 11497799.8000; val_masked_gp_l1_reg_loss: 125280.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78112.4141; val_chrom_access_recon_loss: 4184409.0167; val_global_loss: 18703392.4000; val_optim_loss: 18703392.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9713; val_auprc_score: 0.9645; val_best_acc_score: 0.9216; val_best_f1_score: 0.9239; train_kl_reg_loss: 84274.5834; train_edge_recon_loss: 2708162.5363; train_gene_expr_recon_loss: 11377909.6412; train_masked_gp_l1_reg_loss: 125030.6932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77991.3119; train_chrom_access_recon_loss: 4139977.9695; train_global_loss: 18513346.6718; train_optim_loss: 18513346.6718; val_kl_reg_loss: 84252.2328; val_edge_recon_loss: 2708615.9833; val_gene_expr_recon_loss: 11426321.9333; val_masked_gp_l1_reg_loss: 124920.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78554.4766; val_chrom_access_recon_loss: 4163299.3000; val_global_loss: 18585963.7333; val_optim_loss: 18585963.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9689; val_auprc_score: 0.9572; val_best_acc_score: 0.9186; val_best_f1_score: 0.9208; train_kl_reg_loss: 83535.0186; train_edge_recon_loss: 2712241.9905; train_gene_expr_recon_loss: 11374172.6718; train_masked_gp_l1_reg_loss: 124542.9986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78081.6121; train_chrom_access_recon_loss: 4135646.3531; train_global_loss: 18508220.6412; train_optim_loss: 18508220.6412; val_kl_reg_loss: 85496.9630; val_edge_recon_loss: 2730771.1833; val_gene_expr_recon_loss: 11463562.6000; val_masked_gp_l1_reg_loss: 124605.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78335.1719; val_chrom_access_recon_loss: 4140555.2500; val_global_loss: 18623326.1333; val_optim_loss: 18623326.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9714; val_auprc_score: 0.9623; val_best_acc_score: 0.9220; val_best_f1_score: 0.9246; train_kl_reg_loss: 83203.5989; train_edge_recon_loss: 2705558.2405; train_gene_expr_recon_loss: 11347584.1908; train_masked_gp_l1_reg_loss: 124178.9690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77937.2654; train_chrom_access_recon_loss: 4121262.7176; train_global_loss: 18459724.9008; train_optim_loss: 18459724.9008; val_kl_reg_loss: 83197.6755; val_edge_recon_loss: 2718367.6000; val_gene_expr_recon_loss: 11425183.5333; val_masked_gp_l1_reg_loss: 123782.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77443.1641; val_chrom_access_recon_loss: 4154321.5333; val_global_loss: 18582295.4667; val_optim_loss: 18582295.4667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9669; val_auprc_score: 0.9589; val_best_acc_score: 0.9171; val_best_f1_score: 0.9195; train_kl_reg_loss: 103103.2480; train_edge_recon_loss: 2788850.9771; train_gene_expr_recon_loss: 10347719.7939; train_masked_gp_l1_reg_loss: 121740.4256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76784.8928; train_chrom_access_recon_loss: 3779925.7920; train_global_loss: 17218125.2443; train_optim_loss: 17218125.2443; val_kl_reg_loss: 35839.5297; val_edge_recon_loss: 2738017.1833; val_gene_expr_recon_loss: 10383182.8667; val_masked_gp_l1_reg_loss: 120807.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78609.7578; val_chrom_access_recon_loss: 3753475.9333; val_global_loss: 17109933.6000; val_optim_loss: 17109933.6000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9641; val_auprc_score: 0.9509; val_best_acc_score: 0.9140; val_best_f1_score: 0.9178; train_kl_reg_loss: 81674.2411; train_edge_recon_loss: 2734276.6374; train_gene_expr_recon_loss: 10292571.1069; train_masked_gp_l1_reg_loss: 119243.1139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78934.3749; train_chrom_access_recon_loss: 3749769.5057; train_global_loss: 17056469.0229; train_optim_loss: 17056469.0229; val_kl_reg_loss: 40945.8307; val_edge_recon_loss: 2742326.0167; val_gene_expr_recon_loss: 10357592.3333; val_masked_gp_l1_reg_loss: 117531.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79270.3359; val_chrom_access_recon_loss: 3769074.4333; val_global_loss: 17106740.4667; val_optim_loss: 17106740.4667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9693; val_auprc_score: 0.9614; val_best_acc_score: 0.9186; val_best_f1_score: 0.9223; train_kl_reg_loss: 74134.5261; train_edge_recon_loss: 2712490.6908; train_gene_expr_recon_loss: 10252929.1679; train_masked_gp_l1_reg_loss: 115756.9584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79318.5308; train_chrom_access_recon_loss: 3733793.3779; train_global_loss: 16968423.2748; train_optim_loss: 16968423.2748; val_kl_reg_loss: 48233.9117; val_edge_recon_loss: 2723273.1333; val_gene_expr_recon_loss: 10278455.4667; val_masked_gp_l1_reg_loss: 114088.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78717.1250; val_chrom_access_recon_loss: 3726825.4500; val_global_loss: 16969592.8000; val_optim_loss: 16969592.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9694; val_auprc_score: 0.9570; val_best_acc_score: 0.9227; val_best_f1_score: 0.9255; train_kl_reg_loss: 69131.4895; train_edge_recon_loss: 2707685.8721; train_gene_expr_recon_loss: 10225667.8168; train_masked_gp_l1_reg_loss: 112581.7849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79247.9238; train_chrom_access_recon_loss: 3719787.0191; train_global_loss: 16914101.9542; train_optim_loss: 16914101.9542; val_kl_reg_loss: 48899.3227; val_edge_recon_loss: 2703160.2500; val_gene_expr_recon_loss: 10286349.2000; val_masked_gp_l1_reg_loss: 111099.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79253.5000; val_chrom_access_recon_loss: 3720707.1333; val_global_loss: 16949468.5333; val_optim_loss: 16949468.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9685; val_auprc_score: 0.9578; val_best_acc_score: 0.9161; val_best_f1_score: 0.9186; train_kl_reg_loss: 67682.5684; train_edge_recon_loss: 2701078.4504; train_gene_expr_recon_loss: 10206957.7786; train_masked_gp_l1_reg_loss: 109923.7418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78985.7772; train_chrom_access_recon_loss: 3714379.6508; train_global_loss: 16879007.9771; train_optim_loss: 16879007.9771; val_kl_reg_loss: 51823.4096; val_edge_recon_loss: 2718240.3000; val_gene_expr_recon_loss: 10235386.3333; val_masked_gp_l1_reg_loss: 108655.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79132.4297; val_chrom_access_recon_loss: 3725702.8000; val_global_loss: 16918940.4667; val_optim_loss: 16918940.4667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9673; val_auprc_score: 0.9569; val_best_acc_score: 0.9179; val_best_f1_score: 0.9209; train_kl_reg_loss: 67306.7270; train_edge_recon_loss: 2702688.7462; train_gene_expr_recon_loss: 10173025.4809; train_masked_gp_l1_reg_loss: 107351.7134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78663.9945; train_chrom_access_recon_loss: 3706828.0878; train_global_loss: 16835864.7710; train_optim_loss: 16835864.7710; val_kl_reg_loss: 52062.7596; val_edge_recon_loss: 2726439.8167; val_gene_expr_recon_loss: 10259885.2000; val_masked_gp_l1_reg_loss: 106372.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78089.2812; val_chrom_access_recon_loss: 3716059.9500; val_global_loss: 16938908.7333; val_optim_loss: 16938908.7333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9710; val_auprc_score: 0.9604; val_best_acc_score: 0.9231; val_best_f1_score: 0.9252; train_kl_reg_loss: 65361.2770; train_edge_recon_loss: 2699111.8740; train_gene_expr_recon_loss: 10144887.8473; train_masked_gp_l1_reg_loss: 105342.3348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78364.4065; train_chrom_access_recon_loss: 3695329.9924; train_global_loss: 16788397.7634; train_optim_loss: 16788397.7634; val_kl_reg_loss: 55124.0755; val_edge_recon_loss: 2710978.8000; val_gene_expr_recon_loss: 10213670.7333; val_masked_gp_l1_reg_loss: 104244.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77401.5469; val_chrom_access_recon_loss: 3703474.2667; val_global_loss: 16864893.8667; val_optim_loss: 16864893.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9708; val_auprc_score: 0.9617; val_best_acc_score: 0.9254; val_best_f1_score: 0.9274; train_kl_reg_loss: 64098.3965; train_edge_recon_loss: 2686787.6489; train_gene_expr_recon_loss: 10150438.0763; train_masked_gp_l1_reg_loss: 103549.8325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77964.4036; train_chrom_access_recon_loss: 3699515.8034; train_global_loss: 16782354.2061; train_optim_loss: 16782354.2061; val_kl_reg_loss: 56253.9930; val_edge_recon_loss: 2708483.3000; val_gene_expr_recon_loss: 10206987.1333; val_masked_gp_l1_reg_loss: 102736.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78645.6875; val_chrom_access_recon_loss: 3711948.5000; val_global_loss: 16865055.8000; val_optim_loss: 16865055.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9729; val_auprc_score: 0.9584; val_best_acc_score: 0.9278; val_best_f1_score: 0.9293; train_kl_reg_loss: 64902.0207; train_edge_recon_loss: 2690626.6011; train_gene_expr_recon_loss: 10115259.0840; train_masked_gp_l1_reg_loss: 101969.6886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77866.2087; train_chrom_access_recon_loss: 3690091.7385; train_global_loss: 16740715.3817; train_optim_loss: 16740715.3817; val_kl_reg_loss: 53930.5479; val_edge_recon_loss: 2699862.0167; val_gene_expr_recon_loss: 10153958.7333; val_masked_gp_l1_reg_loss: 101116.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77679.3203; val_chrom_access_recon_loss: 3692500.3500; val_global_loss: 16779046.8000; val_optim_loss: 16779046.8000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9714; val_auprc_score: 0.9585; val_best_acc_score: 0.9231; val_best_f1_score: 0.9250; train_kl_reg_loss: 64075.1821; train_edge_recon_loss: 2690298.7004; train_gene_expr_recon_loss: 10105199.3893; train_masked_gp_l1_reg_loss: 100685.7586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77914.8154; train_chrom_access_recon_loss: 3682037.7385; train_global_loss: 16720211.6183; train_optim_loss: 16720211.6183; val_kl_reg_loss: 56141.6068; val_edge_recon_loss: 2698322.7667; val_gene_expr_recon_loss: 10178430.0000; val_masked_gp_l1_reg_loss: 100049.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77827.2109; val_chrom_access_recon_loss: 3675194.8333; val_global_loss: 16785966.2000; val_optim_loss: 16785966.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9709; val_auprc_score: 0.9614; val_best_acc_score: 0.9245; val_best_f1_score: 0.9273; train_kl_reg_loss: 65033.7590; train_edge_recon_loss: 2689049.2290; train_gene_expr_recon_loss: 10083267.0916; train_masked_gp_l1_reg_loss: 99282.8111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77253.4750; train_chrom_access_recon_loss: 3659418.0534; train_global_loss: 16673304.4580; train_optim_loss: 16673304.4580; val_kl_reg_loss: 57935.0247; val_edge_recon_loss: 2705872.4833; val_gene_expr_recon_loss: 10128126.7333; val_masked_gp_l1_reg_loss: 98703.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77677.5547; val_chrom_access_recon_loss: 3653244.6667; val_global_loss: 16721560.8667; val_optim_loss: 16721560.8667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9720; val_auprc_score: 0.9614; val_best_acc_score: 0.9244; val_best_f1_score: 0.9270; train_kl_reg_loss: 64273.6517; train_edge_recon_loss: 2685946.7023; train_gene_expr_recon_loss: 10063365.4504; train_masked_gp_l1_reg_loss: 98276.4464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76945.7614; train_chrom_access_recon_loss: 3653490.6431; train_global_loss: 16642298.6947; train_optim_loss: 16642298.6947; val_kl_reg_loss: 58116.2201; val_edge_recon_loss: 2705852.8167; val_gene_expr_recon_loss: 10092182.6667; val_masked_gp_l1_reg_loss: 97824.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76937.4531; val_chrom_access_recon_loss: 3645625.9667; val_global_loss: 16676538.6000; val_optim_loss: 16676538.6000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9755; val_auprc_score: 0.9687; val_best_acc_score: 0.9266; val_best_f1_score: 0.9293; train_kl_reg_loss: 64501.1820; train_edge_recon_loss: 2677754.9427; train_gene_expr_recon_loss: 10057263.8321; train_masked_gp_l1_reg_loss: 97395.8291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76688.8444; train_chrom_access_recon_loss: 3650665.7347; train_global_loss: 16624270.3130; train_optim_loss: 16624270.3130; val_kl_reg_loss: 58325.1310; val_edge_recon_loss: 2685825.8667; val_gene_expr_recon_loss: 10121633.2667; val_masked_gp_l1_reg_loss: 97094.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76211.2734; val_chrom_access_recon_loss: 3649172.6167; val_global_loss: 16688262.7333; val_optim_loss: 16688262.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9725; val_auprc_score: 0.9639; val_best_acc_score: 0.9229; val_best_f1_score: 0.9250; train_kl_reg_loss: 64192.4706; train_edge_recon_loss: 2684732.1508; train_gene_expr_recon_loss: 10049435.5267; train_masked_gp_l1_reg_loss: 96639.1670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76265.3997; train_chrom_access_recon_loss: 3648756.7710; train_global_loss: 16620021.5038; train_optim_loss: 16620021.5038; val_kl_reg_loss: 58650.3651; val_edge_recon_loss: 2690412.7333; val_gene_expr_recon_loss: 10141496.4667; val_masked_gp_l1_reg_loss: 96164.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76270.7031; val_chrom_access_recon_loss: 3663806.3833; val_global_loss: 16726800.9333; val_optim_loss: 16726800.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9736; val_auprc_score: 0.9635; val_best_acc_score: 0.9298; val_best_f1_score: 0.9319; train_kl_reg_loss: 63494.8061; train_edge_recon_loss: 2682298.6813; train_gene_expr_recon_loss: 10032086.4962; train_masked_gp_l1_reg_loss: 95690.4354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76127.5774; train_chrom_access_recon_loss: 3636714.9294; train_global_loss: 16586412.9771; train_optim_loss: 16586412.9771; val_kl_reg_loss: 56964.2909; val_edge_recon_loss: 2691996.6667; val_gene_expr_recon_loss: 10112891.5333; val_masked_gp_l1_reg_loss: 95478.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76307.9062; val_chrom_access_recon_loss: 3653373.9667; val_global_loss: 16687012.4667; val_optim_loss: 16687012.4667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9755; val_auprc_score: 0.9657; val_best_acc_score: 0.9301; val_best_f1_score: 0.9321; train_kl_reg_loss: 62401.0037; train_edge_recon_loss: 2683890.0019; train_gene_expr_recon_loss: 10037579.5191; train_masked_gp_l1_reg_loss: 95054.3890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76058.3286; train_chrom_access_recon_loss: 3642263.4351; train_global_loss: 16597246.6794; train_optim_loss: 16597246.6794; val_kl_reg_loss: 58269.4927; val_edge_recon_loss: 2687566.2333; val_gene_expr_recon_loss: 10102136.5333; val_masked_gp_l1_reg_loss: 94870.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75713.9688; val_chrom_access_recon_loss: 3656346.5000; val_global_loss: 16674903.7333; val_optim_loss: 16674903.7333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9764; val_auprc_score: 0.9700; val_best_acc_score: 0.9326; val_best_f1_score: 0.9347; train_kl_reg_loss: 63236.0054; train_edge_recon_loss: 2678205.8683; train_gene_expr_recon_loss: 10033550.8473; train_masked_gp_l1_reg_loss: 94494.5945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75999.0739; train_chrom_access_recon_loss: 3641760.2882; train_global_loss: 16587246.6336; train_optim_loss: 16587246.6336; val_kl_reg_loss: 59280.8521; val_edge_recon_loss: 2678525.4333; val_gene_expr_recon_loss: 10130260.1333; val_masked_gp_l1_reg_loss: 94192.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76707.9609; val_chrom_access_recon_loss: 3641164.7833; val_global_loss: 16680132.1333; val_optim_loss: 16680132.1333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9728; val_auprc_score: 0.9635; val_best_acc_score: 0.9305; val_best_f1_score: 0.9328; train_kl_reg_loss: 63130.3605; train_edge_recon_loss: 2681265.7557; train_gene_expr_recon_loss: 10036774.0534; train_masked_gp_l1_reg_loss: 93778.3627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76066.8409; train_chrom_access_recon_loss: 3641349.4771; train_global_loss: 16592364.8626; train_optim_loss: 16592364.8626; val_kl_reg_loss: 60170.5888; val_edge_recon_loss: 2694282.1000; val_gene_expr_recon_loss: 10068988.0667; val_masked_gp_l1_reg_loss: 93577.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75982.1719; val_chrom_access_recon_loss: 3634289.5333; val_global_loss: 16627289.2000; val_optim_loss: 16627289.2000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9748; val_auprc_score: 0.9667; val_best_acc_score: 0.9263; val_best_f1_score: 0.9291; train_kl_reg_loss: 62306.7503; train_edge_recon_loss: 2679498.8053; train_gene_expr_recon_loss: 10002737.0458; train_masked_gp_l1_reg_loss: 93253.5440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75952.9469; train_chrom_access_recon_loss: 3621239.1298; train_global_loss: 16534988.0916; train_optim_loss: 16534988.0916; val_kl_reg_loss: 58585.0870; val_edge_recon_loss: 2696241.7333; val_gene_expr_recon_loss: 10067122.5333; val_masked_gp_l1_reg_loss: 93088.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75729.0391; val_chrom_access_recon_loss: 3626971.9167; val_global_loss: 16617739.2000; val_optim_loss: 16617739.2000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9776; val_auprc_score: 0.9683; val_best_acc_score: 0.9359; val_best_f1_score: 0.9375; train_kl_reg_loss: 63247.0749; train_edge_recon_loss: 2679387.6050; train_gene_expr_recon_loss: 10000475.0687; train_masked_gp_l1_reg_loss: 92675.7146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75809.8395; train_chrom_access_recon_loss: 3616787.7557; train_global_loss: 16528383.0458; train_optim_loss: 16528383.0458; val_kl_reg_loss: 60671.0128; val_edge_recon_loss: 2679948.4833; val_gene_expr_recon_loss: 10102002.8667; val_masked_gp_l1_reg_loss: 92470.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75769.9297; val_chrom_access_recon_loss: 3632539.0000; val_global_loss: 16643402.4000; val_optim_loss: 16643402.4000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9755; val_auprc_score: 0.9666; val_best_acc_score: 0.9310; val_best_f1_score: 0.9334; train_kl_reg_loss: 63240.4803; train_edge_recon_loss: 2679288.0935; train_gene_expr_recon_loss: 10005903.2824; train_masked_gp_l1_reg_loss: 92122.0930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75797.7429; train_chrom_access_recon_loss: 3618666.4790; train_global_loss: 16535018.1908; train_optim_loss: 16535018.1908; val_kl_reg_loss: 59959.6438; val_edge_recon_loss: 2687797.3333; val_gene_expr_recon_loss: 10093971.2667; val_masked_gp_l1_reg_loss: 91512.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75599.1094; val_chrom_access_recon_loss: 3637382.4667; val_global_loss: 16646222.7333; val_optim_loss: 16646222.7333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9762; val_auprc_score: 0.9664; val_best_acc_score: 0.9341; val_best_f1_score: 0.9366; train_kl_reg_loss: 61978.5594; train_edge_recon_loss: 2679996.1336; train_gene_expr_recon_loss: 9994049.1603; train_masked_gp_l1_reg_loss: 91430.2152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75789.6583; train_chrom_access_recon_loss: 3616319.8798; train_global_loss: 16519563.6183; train_optim_loss: 16519563.6183; val_kl_reg_loss: 58576.5211; val_edge_recon_loss: 2696835.2000; val_gene_expr_recon_loss: 10051536.8667; val_masked_gp_l1_reg_loss: 91064.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75656.2188; val_chrom_access_recon_loss: 3634596.8667; val_global_loss: 16608266.6000; val_optim_loss: 16608266.6000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9755; val_auprc_score: 0.9678; val_best_acc_score: 0.9287; val_best_f1_score: 0.9309; train_kl_reg_loss: 61630.8129; train_edge_recon_loss: 2673367.5935; train_gene_expr_recon_loss: 9973904.9542; train_masked_gp_l1_reg_loss: 90817.4823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75783.0379; train_chrom_access_recon_loss: 3609634.0401; train_global_loss: 16485137.9771; train_optim_loss: 16485137.9771; val_kl_reg_loss: 58995.8081; val_edge_recon_loss: 2687609.6333; val_gene_expr_recon_loss: 10038400.8000; val_masked_gp_l1_reg_loss: 90538.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76453.0547; val_chrom_access_recon_loss: 3625154.9833; val_global_loss: 16577152.2000; val_optim_loss: 16577152.2000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9773; val_auprc_score: 0.9703; val_best_acc_score: 0.9329; val_best_f1_score: 0.9358; train_kl_reg_loss: 61312.2574; train_edge_recon_loss: 2680751.2824; train_gene_expr_recon_loss: 9970303.4427; train_masked_gp_l1_reg_loss: 90277.5728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75906.5527; train_chrom_access_recon_loss: 3607509.2328; train_global_loss: 16486060.4351; train_optim_loss: 16486060.4351; val_kl_reg_loss: 57663.0552; val_edge_recon_loss: 2671594.6500; val_gene_expr_recon_loss: 9991214.4000; val_masked_gp_l1_reg_loss: 90115.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75872.9922; val_chrom_access_recon_loss: 3612410.4167; val_global_loss: 16498871.6000; val_optim_loss: 16498871.6000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9781; val_auprc_score: 0.9700; val_best_acc_score: 0.9363; val_best_f1_score: 0.9383; train_kl_reg_loss: 60722.7344; train_edge_recon_loss: 2680262.8511; train_gene_expr_recon_loss: 9959651.3282; train_masked_gp_l1_reg_loss: 89716.7660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75891.6110; train_chrom_access_recon_loss: 3600783.9122; train_global_loss: 16467029.0992; train_optim_loss: 16467029.0992; val_kl_reg_loss: 58613.1297; val_edge_recon_loss: 2700779.9500; val_gene_expr_recon_loss: 10029673.7333; val_masked_gp_l1_reg_loss: 89495.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75572.7812; val_chrom_access_recon_loss: 3592941.2833; val_global_loss: 16547076.9333; val_optim_loss: 16547076.9333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9794; val_auprc_score: 0.9725; val_best_acc_score: 0.9396; val_best_f1_score: 0.9405; train_kl_reg_loss: 61580.7412; train_edge_recon_loss: 2678691.2672; train_gene_expr_recon_loss: 9965054.2824; train_masked_gp_l1_reg_loss: 89284.9052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75796.9790; train_chrom_access_recon_loss: 3607787.1145; train_global_loss: 16478195.2672; train_optim_loss: 16478195.2672; val_kl_reg_loss: 58996.6656; val_edge_recon_loss: 2690841.4667; val_gene_expr_recon_loss: 10022626.5333; val_masked_gp_l1_reg_loss: 89015.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76017.9844; val_chrom_access_recon_loss: 3631650.4000; val_global_loss: 16569149.0000; val_optim_loss: 16569149.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9769; val_auprc_score: 0.9682; val_best_acc_score: 0.9355; val_best_f1_score: 0.9374; train_kl_reg_loss: 61411.1980; train_edge_recon_loss: 2676458.2901; train_gene_expr_recon_loss: 9947228.4351; train_masked_gp_l1_reg_loss: 88756.9622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75609.1600; train_chrom_access_recon_loss: 3598758.4618; train_global_loss: 16448222.5649; train_optim_loss: 16448222.5649; val_kl_reg_loss: 61151.3706; val_edge_recon_loss: 2677706.3333; val_gene_expr_recon_loss: 10021720.4667; val_masked_gp_l1_reg_loss: 88475.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75485.5703; val_chrom_access_recon_loss: 3600439.0833; val_global_loss: 16524978.2667; val_optim_loss: 16524978.2667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9746; val_auprc_score: 0.9630; val_best_acc_score: 0.9299; val_best_f1_score: 0.9323; train_kl_reg_loss: 61378.1833; train_edge_recon_loss: 2667897.4313; train_gene_expr_recon_loss: 9950735.3130; train_masked_gp_l1_reg_loss: 88274.2004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75816.4969; train_chrom_access_recon_loss: 3598945.8492; train_global_loss: 16443047.5191; train_optim_loss: 16443047.5191; val_kl_reg_loss: 60979.2302; val_edge_recon_loss: 2685738.5667; val_gene_expr_recon_loss: 10004902.6000; val_masked_gp_l1_reg_loss: 87951.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75327.6953; val_chrom_access_recon_loss: 3610645.3333; val_global_loss: 16525545.0000; val_optim_loss: 16525545.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9807; val_auprc_score: 0.9743; val_best_acc_score: 0.9419; val_best_f1_score: 0.9437; train_kl_reg_loss: 62574.9952; train_edge_recon_loss: 2673207.0611; train_gene_expr_recon_loss: 9930551.8550; train_masked_gp_l1_reg_loss: 84809.0169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61272.7657; train_chrom_access_recon_loss: 3591850.4580; train_global_loss: 16404266.1908; train_optim_loss: 16404266.1908; val_kl_reg_loss: 60271.9594; val_edge_recon_loss: 2650766.5833; val_gene_expr_recon_loss: 9980794.4000; val_masked_gp_l1_reg_loss: 84308.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59592.2227; val_chrom_access_recon_loss: 3595014.1000; val_global_loss: 16430748.0667; val_optim_loss: 16430748.0667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9764; val_auprc_score: 0.9666; val_best_acc_score: 0.9303; val_best_f1_score: 0.9323; train_kl_reg_loss: 63867.5651; train_edge_recon_loss: 2673455.2462; train_gene_expr_recon_loss: 9940079.1756; train_masked_gp_l1_reg_loss: 84223.7650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59189.0255; train_chrom_access_recon_loss: 3594608.0267; train_global_loss: 16415422.7634; train_optim_loss: 16415422.7634; val_kl_reg_loss: 61355.8695; val_edge_recon_loss: 2691547.1667; val_gene_expr_recon_loss: 9999755.8000; val_masked_gp_l1_reg_loss: 84182.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58842.4453; val_chrom_access_recon_loss: 3610949.9667; val_global_loss: 16506633.9333; val_optim_loss: 16506633.9333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9778; val_auprc_score: 0.9703; val_best_acc_score: 0.9361; val_best_f1_score: 0.9378; train_kl_reg_loss: 64786.7494; train_edge_recon_loss: 2672867.5324; train_gene_expr_recon_loss: 9943802.3130; train_masked_gp_l1_reg_loss: 84116.2191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58585.2022; train_chrom_access_recon_loss: 3594022.0210; train_global_loss: 16418180.0076; train_optim_loss: 16418180.0076; val_kl_reg_loss: 61300.0292; val_edge_recon_loss: 2680931.4500; val_gene_expr_recon_loss: 9979095.8000; val_masked_gp_l1_reg_loss: 84107.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58400.8438; val_chrom_access_recon_loss: 3590592.4167; val_global_loss: 16454427.6667; val_optim_loss: 16454427.6667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9765; val_auprc_score: 0.9680; val_best_acc_score: 0.9368; val_best_f1_score: 0.9391; train_kl_reg_loss: 64535.8772; train_edge_recon_loss: 2670673.4828; train_gene_expr_recon_loss: 9939877.8626; train_masked_gp_l1_reg_loss: 84043.2465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58204.8485; train_chrom_access_recon_loss: 3597159.7844; train_global_loss: 16414495.0153; train_optim_loss: 16414495.0153; val_kl_reg_loss: 61600.3484; val_edge_recon_loss: 2685229.2667; val_gene_expr_recon_loss: 10023360.6667; val_masked_gp_l1_reg_loss: 83993.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57953.7812; val_chrom_access_recon_loss: 3604092.4167; val_global_loss: 16516230.6667; val_optim_loss: 16516230.6667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9749; val_auprc_score: 0.9649; val_best_acc_score: 0.9320; val_best_f1_score: 0.9339; train_kl_reg_loss: 64722.4880; train_edge_recon_loss: 2668167.0802; train_gene_expr_recon_loss: 9940577.3969; train_masked_gp_l1_reg_loss: 83944.7289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57782.4683; train_chrom_access_recon_loss: 3595008.5324; train_global_loss: 16410202.7099; train_optim_loss: 16410202.7099; val_kl_reg_loss: 62113.3776; val_edge_recon_loss: 2701287.3833; val_gene_expr_recon_loss: 9975013.0000; val_masked_gp_l1_reg_loss: 83918.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57610.7656; val_chrom_access_recon_loss: 3594571.7167; val_global_loss: 16474514.6000; val_optim_loss: 16474514.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9789; val_auprc_score: 0.9702; val_best_acc_score: 0.9357; val_best_f1_score: 0.9377; train_kl_reg_loss: 64741.0299; train_edge_recon_loss: 2671572.1508; train_gene_expr_recon_loss: 9923408.4122; train_masked_gp_l1_reg_loss: 83591.3584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56108.0016; train_chrom_access_recon_loss: 3586932.2595; train_global_loss: 16386353.2366; train_optim_loss: 16386353.2366; val_kl_reg_loss: 61986.7044; val_edge_recon_loss: 2677064.7833; val_gene_expr_recon_loss: 10007958.8667; val_masked_gp_l1_reg_loss: 83521.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55918.9766; val_chrom_access_recon_loss: 3612855.1500; val_global_loss: 16499306.5333; val_optim_loss: 16499306.5333
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9777; val_auprc_score: 0.9698; val_best_acc_score: 0.9347; val_best_f1_score: 0.9363; train_kl_reg_loss: 65045.3580; train_edge_recon_loss: 2670700.6756; train_gene_expr_recon_loss: 9929520.5038; train_masked_gp_l1_reg_loss: 83501.7053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55880.7839; train_chrom_access_recon_loss: 3592890.8454; train_global_loss: 16397539.9237; train_optim_loss: 16397539.9237; val_kl_reg_loss: 61978.5417; val_edge_recon_loss: 2679895.3000; val_gene_expr_recon_loss: 9966117.6667; val_masked_gp_l1_reg_loss: 83489.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55838.8672; val_chrom_access_recon_loss: 3609028.0333; val_global_loss: 16456347.4667; val_optim_loss: 16456347.4667
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9784; val_auprc_score: 0.9719; val_best_acc_score: 0.9367; val_best_f1_score: 0.9384; train_kl_reg_loss: 65140.5420; train_edge_recon_loss: 2671646.9218; train_gene_expr_recon_loss: 9936656.1756; train_masked_gp_l1_reg_loss: 83478.4572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55802.9432; train_chrom_access_recon_loss: 3593309.3760; train_global_loss: 16406034.4198; train_optim_loss: 16406034.4198; val_kl_reg_loss: 62032.4826; val_edge_recon_loss: 2675505.4167; val_gene_expr_recon_loss: 9984855.6667; val_masked_gp_l1_reg_loss: 83470.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55775.2852; val_chrom_access_recon_loss: 3602130.3833; val_global_loss: 16463768.9333; val_optim_loss: 16463768.9333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9763; val_auprc_score: 0.9682; val_best_acc_score: 0.9336; val_best_f1_score: 0.9355; train_kl_reg_loss: 65288.7670; train_edge_recon_loss: 2674164.5515; train_gene_expr_recon_loss: 9931621.6031; train_masked_gp_l1_reg_loss: 83464.2415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55752.1967; train_chrom_access_recon_loss: 3590395.9389; train_global_loss: 16400687.2977; train_optim_loss: 16400687.2977; val_kl_reg_loss: 61939.2203; val_edge_recon_loss: 2693521.3333; val_gene_expr_recon_loss: 10019529.6000; val_masked_gp_l1_reg_loss: 83456.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55726.1445; val_chrom_access_recon_loss: 3617561.1833; val_global_loss: 16531734.4000; val_optim_loss: 16531734.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 52 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9778
val AUPRC score: 0.9667
val best accuracy score: 0.9372
val best F1 score: 0.9393
val target rna MSE score: 2.3277
val source rna MSE score: 0.5122
val target atac MSE score: 0.4870
val source atac MSE score: 0.1505
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
