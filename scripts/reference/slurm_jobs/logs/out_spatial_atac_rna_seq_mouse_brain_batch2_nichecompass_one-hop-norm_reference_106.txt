[True]
Run timestamp: 07082023_204351_106.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_106']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9071; val_auprc_score: 0.9163; val_best_acc_score: 0.5554; val_best_f1_score: 0.6916; train_kl_reg_loss: 3417.3659; train_edge_recon_loss: 347821.6319; train_gene_expr_recon_loss: 624672.3611; train_masked_gp_l1_reg_loss: 15389.7722; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 265746.9861; train_global_loss: 1257048.1528; train_optim_loss: 1257048.1528; val_kl_reg_loss: 5026.0347; val_edge_recon_loss: 406162.2812; val_gene_expr_recon_loss: 596211.7500; val_masked_gp_l1_reg_loss: 9512.1836; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 264665.5000; val_global_loss: 1281577.7500; val_optim_loss: 1281577.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9044; val_auprc_score: 0.9053; val_best_acc_score: 0.5554; val_best_f1_score: 0.6918; train_kl_reg_loss: 9865.5863; train_edge_recon_loss: 353506.4306; train_gene_expr_recon_loss: 572528.5903; train_masked_gp_l1_reg_loss: 7532.8780; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 262605.6493; train_global_loss: 1206039.1250; train_optim_loss: 1206039.1250; val_kl_reg_loss: 12729.5039; val_edge_recon_loss: 406205.2500; val_gene_expr_recon_loss: 542515.6875; val_masked_gp_l1_reg_loss: 6475.7769; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260073.1406; val_global_loss: 1227999.3750; val_optim_loss: 1227999.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9016; val_auprc_score: 0.9018; val_best_acc_score: 0.6211; val_best_f1_score: 0.7235; train_kl_reg_loss: 14645.0102; train_edge_recon_loss: 356804.6181; train_gene_expr_recon_loss: 532065.2535; train_masked_gp_l1_reg_loss: 7071.6094; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 258179.0885; train_global_loss: 1168765.5833; train_optim_loss: 1168765.5833; val_kl_reg_loss: 16070.8496; val_edge_recon_loss: 405859.2188; val_gene_expr_recon_loss: 510588.0000; val_masked_gp_l1_reg_loss: 7536.0449; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256047.9531; val_global_loss: 1196102.1250; val_optim_loss: 1196102.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9103; val_auprc_score: 0.9042; val_best_acc_score: 0.7230; val_best_f1_score: 0.7789; train_kl_reg_loss: 17818.7463; train_edge_recon_loss: 357977.2083; train_gene_expr_recon_loss: 499174.8819; train_masked_gp_l1_reg_loss: 7562.1001; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254407.9323; train_global_loss: 1136940.8750; train_optim_loss: 1136940.8750; val_kl_reg_loss: 18467.6484; val_edge_recon_loss: 404938.9375; val_gene_expr_recon_loss: 487797.3750; val_masked_gp_l1_reg_loss: 7662.2812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252911.7188; val_global_loss: 1171778.0000; val_optim_loss: 1171778.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9146; val_auprc_score: 0.9051; val_best_acc_score: 0.8327; val_best_f1_score: 0.8429; train_kl_reg_loss: 19569.4540; train_edge_recon_loss: 357813.0590; train_gene_expr_recon_loss: 483106.2049; train_masked_gp_l1_reg_loss: 7741.3989; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251618.4688; train_global_loss: 1119848.5833; train_optim_loss: 1119848.5833; val_kl_reg_loss: 18147.3242; val_edge_recon_loss: 401235.0000; val_gene_expr_recon_loss: 473384.1875; val_masked_gp_l1_reg_loss: 7816.1987; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250609.9844; val_global_loss: 1151192.6250; val_optim_loss: 1151192.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9148; val_auprc_score: 0.9006; val_best_acc_score: 0.8288; val_best_f1_score: 0.8448; train_kl_reg_loss: 19474.1864; train_edge_recon_loss: 355848.1562; train_gene_expr_recon_loss: 468234.3646; train_masked_gp_l1_reg_loss: 7891.2980; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250035.6372; train_global_loss: 1101483.6250; train_optim_loss: 1101483.6250; val_kl_reg_loss: 17011.5840; val_edge_recon_loss: 383277.0312; val_gene_expr_recon_loss: 465891.7500; val_masked_gp_l1_reg_loss: 7955.2559; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249085.5000; val_global_loss: 1123221.1250; val_optim_loss: 1123221.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9171; val_auprc_score: 0.9046; val_best_acc_score: 0.8370; val_best_f1_score: 0.8486; train_kl_reg_loss: 19518.1799; train_edge_recon_loss: 344331.8785; train_gene_expr_recon_loss: 465654.6042; train_masked_gp_l1_reg_loss: 8009.8622; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249421.8941; train_global_loss: 1086936.4444; train_optim_loss: 1086936.4444; val_kl_reg_loss: 21407.7070; val_edge_recon_loss: 338850.0625; val_gene_expr_recon_loss: 462239.5625; val_masked_gp_l1_reg_loss: 8075.4688; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248115.4844; val_global_loss: 1078688.3750; val_optim_loss: 1078688.3750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9206; val_auprc_score: 0.9079; val_best_acc_score: 0.8352; val_best_f1_score: 0.8434; train_kl_reg_loss: 28214.8839; train_edge_recon_loss: 317557.6146; train_gene_expr_recon_loss: 460559.0972; train_masked_gp_l1_reg_loss: 8150.3570; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247567.7101; train_global_loss: 1062049.6597; train_optim_loss: 1062049.6597; val_kl_reg_loss: 29779.0156; val_edge_recon_loss: 305883.3125; val_gene_expr_recon_loss: 459754.7500; val_masked_gp_l1_reg_loss: 8246.6992; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247346.9219; val_global_loss: 1051010.6250; val_optim_loss: 1051010.6250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9264; val_auprc_score: 0.9073; val_best_acc_score: 0.8491; val_best_f1_score: 0.8585; train_kl_reg_loss: 28224.7858; train_edge_recon_loss: 307774.7326; train_gene_expr_recon_loss: 457028.2431; train_masked_gp_l1_reg_loss: 8319.0115; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246266.7448; train_global_loss: 1047613.5000; train_optim_loss: 1047613.5000; val_kl_reg_loss: 27105.2930; val_edge_recon_loss: 305433.0000; val_gene_expr_recon_loss: 455280.9375; val_masked_gp_l1_reg_loss: 8400.4629; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246444.8438; val_global_loss: 1042664.5000; val_optim_loss: 1042664.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9378; val_auprc_score: 0.9215; val_best_acc_score: 0.8674; val_best_f1_score: 0.8752; train_kl_reg_loss: 28223.3225; train_edge_recon_loss: 301700.5347; train_gene_expr_recon_loss: 455046.8819; train_masked_gp_l1_reg_loss: 8456.0947; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246042.6545; train_global_loss: 1039469.4722; train_optim_loss: 1039469.4722; val_kl_reg_loss: 26413.0273; val_edge_recon_loss: 300701.1562; val_gene_expr_recon_loss: 452608.3750; val_masked_gp_l1_reg_loss: 8523.0449; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245611.3281; val_global_loss: 1033856.9375; val_optim_loss: 1033856.9375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9453; val_auprc_score: 0.9295; val_best_acc_score: 0.8818; val_best_f1_score: 0.8891; train_kl_reg_loss: 28020.1508; train_edge_recon_loss: 297727.7743; train_gene_expr_recon_loss: 450615.5590; train_masked_gp_l1_reg_loss: 8569.3003; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245078.5868; train_global_loss: 1030011.3889; train_optim_loss: 1030011.3889; val_kl_reg_loss: 26802.7637; val_edge_recon_loss: 294619.5000; val_gene_expr_recon_loss: 449329.9375; val_masked_gp_l1_reg_loss: 8618.2520; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244935.8438; val_global_loss: 1024306.2500; val_optim_loss: 1024306.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9535; val_auprc_score: 0.9391; val_best_acc_score: 0.8933; val_best_f1_score: 0.8974; train_kl_reg_loss: 27781.6363; train_edge_recon_loss: 296098.2500; train_gene_expr_recon_loss: 446287.7222; train_masked_gp_l1_reg_loss: 8663.8819; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244379.5208; train_global_loss: 1023211.0208; train_optim_loss: 1023211.0208; val_kl_reg_loss: 27207.7598; val_edge_recon_loss: 294661.1250; val_gene_expr_recon_loss: 445530.0000; val_masked_gp_l1_reg_loss: 8713.0039; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244199.3438; val_global_loss: 1020311.2500; val_optim_loss: 1020311.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9593; val_auprc_score: 0.9498; val_best_acc_score: 0.8981; val_best_f1_score: 0.9011; train_kl_reg_loss: 27400.4086; train_edge_recon_loss: 294891.7326; train_gene_expr_recon_loss: 443773.8507; train_masked_gp_l1_reg_loss: 8751.1661; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244732.5382; train_global_loss: 1019549.7083; train_optim_loss: 1019549.7083; val_kl_reg_loss: 26911.3789; val_edge_recon_loss: 293298.7188; val_gene_expr_recon_loss: 443246.1250; val_masked_gp_l1_reg_loss: 8787.1113; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243607.4688; val_global_loss: 1015850.8750; val_optim_loss: 1015850.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9597; val_auprc_score: 0.9446; val_best_acc_score: 0.9039; val_best_f1_score: 0.9072; train_kl_reg_loss: 27420.2734; train_edge_recon_loss: 292756.0486; train_gene_expr_recon_loss: 440002.6910; train_masked_gp_l1_reg_loss: 8814.5692; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242451.4358; train_global_loss: 1011445.0139; train_optim_loss: 1011445.0139; val_kl_reg_loss: 26282.1367; val_edge_recon_loss: 294194.8750; val_gene_expr_recon_loss: 440784.4375; val_masked_gp_l1_reg_loss: 8842.6807; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243005.3281; val_global_loss: 1013109.4375; val_optim_loss: 1013109.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9647; val_auprc_score: 0.9516; val_best_acc_score: 0.9104; val_best_f1_score: 0.9131; train_kl_reg_loss: 27298.2452; train_edge_recon_loss: 291949.1528; train_gene_expr_recon_loss: 438667.1285; train_masked_gp_l1_reg_loss: 8870.9265; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242078.8003; train_global_loss: 1008864.2292; train_optim_loss: 1008864.2292; val_kl_reg_loss: 26092.9238; val_edge_recon_loss: 292238.0938; val_gene_expr_recon_loss: 439983.2500; val_masked_gp_l1_reg_loss: 8898.4844; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242463.6719; val_global_loss: 1009676.4375; val_optim_loss: 1009676.4375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9705; val_auprc_score: 0.9636; val_best_acc_score: 0.9161; val_best_f1_score: 0.9190; train_kl_reg_loss: 27176.1947; train_edge_recon_loss: 290648.3576; train_gene_expr_recon_loss: 434131.9340; train_masked_gp_l1_reg_loss: 8922.1427; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241991.2031; train_global_loss: 1002869.7986; train_optim_loss: 1002869.7986; val_kl_reg_loss: 26987.4805; val_edge_recon_loss: 289723.8125; val_gene_expr_recon_loss: 437504.2500; val_masked_gp_l1_reg_loss: 8944.0684; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241651.1406; val_global_loss: 1004810.6875; val_optim_loss: 1004810.6875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9736; val_auprc_score: 0.9670; val_best_acc_score: 0.9193; val_best_f1_score: 0.9204; train_kl_reg_loss: 27024.8451; train_edge_recon_loss: 289669.3993; train_gene_expr_recon_loss: 433390.7500; train_masked_gp_l1_reg_loss: 8969.9207; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241844.4392; train_global_loss: 1000899.3472; train_optim_loss: 1000899.3472; val_kl_reg_loss: 25527.3008; val_edge_recon_loss: 288823.5938; val_gene_expr_recon_loss: 437528.9375; val_masked_gp_l1_reg_loss: 8995.3594; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241366.7969; val_global_loss: 1002242.0625; val_optim_loss: 1002242.0625
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9707; val_auprc_score: 0.9620; val_best_acc_score: 0.9184; val_best_f1_score: 0.9207; train_kl_reg_loss: 26904.5595; train_edge_recon_loss: 288569.4688; train_gene_expr_recon_loss: 434189.4201; train_masked_gp_l1_reg_loss: 9012.7924; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241563.8524; train_global_loss: 1000240.0972; train_optim_loss: 1000240.0972; val_kl_reg_loss: 26655.1914; val_edge_recon_loss: 288659.6250; val_gene_expr_recon_loss: 434073.8438; val_masked_gp_l1_reg_loss: 9034.1826; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240671.0938; val_global_loss: 999093.8750; val_optim_loss: 999093.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9748; val_auprc_score: 0.9668; val_best_acc_score: 0.9235; val_best_f1_score: 0.9255; train_kl_reg_loss: 26736.6044; train_edge_recon_loss: 288777.5104; train_gene_expr_recon_loss: 431162.7500; train_masked_gp_l1_reg_loss: 9058.2461; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239369.0503; train_global_loss: 995104.1528; train_optim_loss: 995104.1528; val_kl_reg_loss: 25889.6992; val_edge_recon_loss: 289016.1875; val_gene_expr_recon_loss: 434212.2500; val_masked_gp_l1_reg_loss: 9083.1436; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240196.3594; val_global_loss: 998397.6250; val_optim_loss: 998397.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9717; val_auprc_score: 0.9629; val_best_acc_score: 0.9224; val_best_f1_score: 0.9245; train_kl_reg_loss: 26848.2810; train_edge_recon_loss: 287761.7812; train_gene_expr_recon_loss: 431856.5243; train_masked_gp_l1_reg_loss: 9108.9878; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240084.9427; train_global_loss: 995660.5069; train_optim_loss: 995660.5069; val_kl_reg_loss: 25414.6211; val_edge_recon_loss: 286776.7500; val_gene_expr_recon_loss: 433533.3125; val_masked_gp_l1_reg_loss: 9135.5488; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239737.4531; val_global_loss: 994597.6875; val_optim_loss: 994597.6875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9744; val_auprc_score: 0.9659; val_best_acc_score: 0.9243; val_best_f1_score: 0.9263; train_kl_reg_loss: 26522.4288; train_edge_recon_loss: 287931.5243; train_gene_expr_recon_loss: 428651.2396; train_masked_gp_l1_reg_loss: 9162.0576; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238829.7292; train_global_loss: 991096.9931; train_optim_loss: 991096.9931; val_kl_reg_loss: 25994.1934; val_edge_recon_loss: 289877.5938; val_gene_expr_recon_loss: 430668.5625; val_masked_gp_l1_reg_loss: 9191.7812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238987.2031; val_global_loss: 994719.3125; val_optim_loss: 994719.3125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9747; val_auprc_score: 0.9659; val_best_acc_score: 0.9290; val_best_f1_score: 0.9305; train_kl_reg_loss: 26482.8294; train_edge_recon_loss: 286823.3750; train_gene_expr_recon_loss: 430059.1979; train_masked_gp_l1_reg_loss: 9212.9110; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239232.0382; train_global_loss: 991810.3403; train_optim_loss: 991810.3403; val_kl_reg_loss: 25265.9531; val_edge_recon_loss: 287742.0938; val_gene_expr_recon_loss: 430148.9375; val_masked_gp_l1_reg_loss: 9232.8486; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238554.6875; val_global_loss: 990944.5625; val_optim_loss: 990944.5625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9778; val_auprc_score: 0.9713; val_best_acc_score: 0.9299; val_best_f1_score: 0.9313; train_kl_reg_loss: 26110.3865; train_edge_recon_loss: 286963.0764; train_gene_expr_recon_loss: 425327.3229; train_masked_gp_l1_reg_loss: 9259.1726; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236873.8333; train_global_loss: 984533.8056; train_optim_loss: 984533.8056; val_kl_reg_loss: 26194.7383; val_edge_recon_loss: 286935.6250; val_gene_expr_recon_loss: 428214.4688; val_masked_gp_l1_reg_loss: 9273.7432; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238030.6406; val_global_loss: 988649.2500; val_optim_loss: 988649.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9743; val_auprc_score: 0.9639; val_best_acc_score: 0.9271; val_best_f1_score: 0.9295; train_kl_reg_loss: 26512.5818; train_edge_recon_loss: 285789.6146; train_gene_expr_recon_loss: 426586.2083; train_masked_gp_l1_reg_loss: 9292.2778; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238596.0365; train_global_loss: 986776.7083; train_optim_loss: 986776.7083; val_kl_reg_loss: 25017.8398; val_edge_recon_loss: 285849.0625; val_gene_expr_recon_loss: 428695.8438; val_masked_gp_l1_reg_loss: 9310.4014; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237997.5625; val_global_loss: 986870.6875; val_optim_loss: 986870.6875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9741; val_auprc_score: 0.9659; val_best_acc_score: 0.9278; val_best_f1_score: 0.9295; train_kl_reg_loss: 25984.7164; train_edge_recon_loss: 285734.9931; train_gene_expr_recon_loss: 424113.8229; train_masked_gp_l1_reg_loss: 9335.3090; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236800.0608; train_global_loss: 981968.8750; train_optim_loss: 981968.8750; val_kl_reg_loss: 25548.0078; val_edge_recon_loss: 285297.4688; val_gene_expr_recon_loss: 428609.5625; val_masked_gp_l1_reg_loss: 9355.0371; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237827.9375; val_global_loss: 986638.0000; val_optim_loss: 986638.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9757; val_auprc_score: 0.9691; val_best_acc_score: 0.9267; val_best_f1_score: 0.9284; train_kl_reg_loss: 27557.4596; train_edge_recon_loss: 298121.3646; train_gene_expr_recon_loss: 446674.7465; train_masked_gp_l1_reg_loss: 9367.5008; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242176.9653; train_global_loss: 1023898.0347; train_optim_loss: 1023898.0347; val_kl_reg_loss: 14060.7480; val_edge_recon_loss: 292789.0000; val_gene_expr_recon_loss: 445341.6250; val_masked_gp_l1_reg_loss: 9363.9219; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241785.2031; val_global_loss: 1003340.5000; val_optim_loss: 1003340.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9689; val_auprc_score: 0.9568; val_best_acc_score: 0.9157; val_best_f1_score: 0.9183; train_kl_reg_loss: 22901.0202; train_edge_recon_loss: 289876.6493; train_gene_expr_recon_loss: 440534.5972; train_masked_gp_l1_reg_loss: 9354.6977; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240885.1719; train_global_loss: 1003552.1250; train_optim_loss: 1003552.1250; val_kl_reg_loss: 16734.7734; val_edge_recon_loss: 288215.1875; val_gene_expr_recon_loss: 443603.3750; val_masked_gp_l1_reg_loss: 9334.4766; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241575.6406; val_global_loss: 999463.5000; val_optim_loss: 999463.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9725; val_auprc_score: 0.9634; val_best_acc_score: 0.9256; val_best_f1_score: 0.9279; train_kl_reg_loss: 21700.8084; train_edge_recon_loss: 283990.9514; train_gene_expr_recon_loss: 437706.8472; train_masked_gp_l1_reg_loss: 9314.7893; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239834.4878; train_global_loss: 992547.8819; train_optim_loss: 992547.8819; val_kl_reg_loss: 18112.8145; val_edge_recon_loss: 284329.6875; val_gene_expr_recon_loss: 442435.0625; val_masked_gp_l1_reg_loss: 9285.8613; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241202.9844; val_global_loss: 995366.4375; val_optim_loss: 995366.4375
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9750; val_auprc_score: 0.9657; val_best_acc_score: 0.9263; val_best_f1_score: 0.9289; train_kl_reg_loss: 21090.0208; train_edge_recon_loss: 283519.0764; train_gene_expr_recon_loss: 436525.1910; train_masked_gp_l1_reg_loss: 9267.3355; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239575.2639; train_global_loss: 989976.8750; train_optim_loss: 989976.8750; val_kl_reg_loss: 17758.3164; val_edge_recon_loss: 282501.5938; val_gene_expr_recon_loss: 442352.6250; val_masked_gp_l1_reg_loss: 9243.9531; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240900.3125; val_global_loss: 992756.7500; val_optim_loss: 992756.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9731; val_auprc_score: 0.9605; val_best_acc_score: 0.9287; val_best_f1_score: 0.9309; train_kl_reg_loss: 21005.1795; train_edge_recon_loss: 283797.4549; train_gene_expr_recon_loss: 435231.6562; train_masked_gp_l1_reg_loss: 9160.7694; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239832.9288; train_global_loss: 989027.9792; train_optim_loss: 989027.9792; val_kl_reg_loss: 18769.0977; val_edge_recon_loss: 283719.1562; val_gene_expr_recon_loss: 439430.1562; val_masked_gp_l1_reg_loss: 9091.2930; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240521.0000; val_global_loss: 991530.6875; val_optim_loss: 991530.6875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9760; val_auprc_score: 0.9685; val_best_acc_score: 0.9293; val_best_f1_score: 0.9314; train_kl_reg_loss: 21040.1680; train_edge_recon_loss: 281663.1424; train_gene_expr_recon_loss: 432983.2812; train_masked_gp_l1_reg_loss: 9074.0350; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238363.2830; train_global_loss: 983123.9097; train_optim_loss: 983123.9097; val_kl_reg_loss: 18631.8633; val_edge_recon_loss: 282594.7188; val_gene_expr_recon_loss: 440547.0625; val_masked_gp_l1_reg_loss: 9045.5977; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240578.4219; val_global_loss: 991397.6875; val_optim_loss: 991397.6875
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9732; val_auprc_score: 0.9637; val_best_acc_score: 0.9275; val_best_f1_score: 0.9298; train_kl_reg_loss: 21352.6434; train_edge_recon_loss: 282165.9375; train_gene_expr_recon_loss: 432214.8056; train_masked_gp_l1_reg_loss: 9031.4859; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239324.7309; train_global_loss: 984089.6111; train_optim_loss: 984089.6111; val_kl_reg_loss: 18779.4570; val_edge_recon_loss: 282555.0000; val_gene_expr_recon_loss: 439767.7500; val_masked_gp_l1_reg_loss: 9015.4492; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240531.0625; val_global_loss: 990648.7500; val_optim_loss: 990648.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9748; val_auprc_score: 0.9668; val_best_acc_score: 0.9276; val_best_f1_score: 0.9300; train_kl_reg_loss: 21275.8772; train_edge_recon_loss: 281820.5833; train_gene_expr_recon_loss: 435655.2639; train_masked_gp_l1_reg_loss: 9006.6239; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239853.5868; train_global_loss: 987611.9444; train_optim_loss: 987611.9444; val_kl_reg_loss: 18696.0781; val_edge_recon_loss: 283392.1875; val_gene_expr_recon_loss: 440026.0000; val_masked_gp_l1_reg_loss: 8997.6836; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240549.1719; val_global_loss: 991661.1250; val_optim_loss: 991661.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 23 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9737
val AUPRC score: 0.9674
val best accuracy score: 0.9217
val best F1 score: 0.9237
val target rna MSE score: 0.4991
val source rna MSE score: 0.2719
val target atac MSE score: 0.1336
val source atac MSE score: 0.0209
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
