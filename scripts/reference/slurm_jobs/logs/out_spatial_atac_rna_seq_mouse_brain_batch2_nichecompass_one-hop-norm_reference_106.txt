[True]
Run timestamp: 26072023_030902_106.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_106']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8900; val_auprc_score: 0.8984; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 15029.7793; train_edge_recon_loss: 3501297.2778; train_gene_expr_recon_loss: 31691656.2222; train_masked_gp_l1_reg_loss: 1933.2498; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108766830.2222; train_global_loss: 143976744.8889; train_optim_loss: 143976744.8889; val_kl_reg_loss: 100272.0938; val_edge_recon_loss: 4065876.2500; val_gene_expr_recon_loss: 29936044.0000; val_masked_gp_l1_reg_loss: 2003.8186; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 105280008.0000; val_global_loss: 139384208.0000; val_optim_loss: 139384208.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8770; val_auprc_score: 0.8837; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 47484.9353; train_edge_recon_loss: 3584832.1389; train_gene_expr_recon_loss: 29300866.2222; train_masked_gp_l1_reg_loss: 2114.0698; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106573408.0000; train_global_loss: 139508702.2222; train_optim_loss: 139508702.2222; val_kl_reg_loss: 74179.1562; val_edge_recon_loss: 4065865.7500; val_gene_expr_recon_loss: 27614220.0000; val_masked_gp_l1_reg_loss: 2272.3684; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103215848.0000; val_global_loss: 134972384.0000; val_optim_loss: 134972384.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8758; val_auprc_score: 0.8799; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 93601.4501; train_edge_recon_loss: 3619227.4444; train_gene_expr_recon_loss: 26969354.6667; train_masked_gp_l1_reg_loss: 2408.3628; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 103891899.5556; train_global_loss: 134576489.7778; train_optim_loss: 134576489.7778; val_kl_reg_loss: 76762.7656; val_edge_recon_loss: 4065920.0000; val_gene_expr_recon_loss: 25654344.0000; val_masked_gp_l1_reg_loss: 2568.5728; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101210568.0000; val_global_loss: 131010160.0000; val_optim_loss: 131010160.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8728; val_auprc_score: 0.8805; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 121086.4653; train_edge_recon_loss: 3669144.0000; train_gene_expr_recon_loss: 25117013.7778; train_masked_gp_l1_reg_loss: 2662.6269; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101555236.4444; train_global_loss: 130465141.3333; train_optim_loss: 130465141.3333; val_kl_reg_loss: 132718.1875; val_edge_recon_loss: 4065980.5000; val_gene_expr_recon_loss: 24169368.0000; val_masked_gp_l1_reg_loss: 2759.6675; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99543664.0000; val_global_loss: 127914488.0000; val_optim_loss: 127914488.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8782; val_auprc_score: 0.8840; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 159700.5156; train_edge_recon_loss: 3690962.5556; train_gene_expr_recon_loss: 23680187.1111; train_masked_gp_l1_reg_loss: 2806.6106; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99909703.1111; train_global_loss: 127443360.0000; train_optim_loss: 127443360.0000; val_kl_reg_loss: 178230.7188; val_edge_recon_loss: 4065909.5000; val_gene_expr_recon_loss: 23173238.0000; val_masked_gp_l1_reg_loss: 2847.5574; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98268688.0000; val_global_loss: 125688912.0000; val_optim_loss: 125688912.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8795; val_auprc_score: 0.8742; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 205046.4757; train_edge_recon_loss: 3677379.7222; train_gene_expr_recon_loss: 22975842.2222; train_masked_gp_l1_reg_loss: 2860.8963; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99336224.8889; train_global_loss: 126197354.6667; train_optim_loss: 126197354.6667; val_kl_reg_loss: 166096.6094; val_edge_recon_loss: 4065662.2500; val_gene_expr_recon_loss: 22401854.0000; val_masked_gp_l1_reg_loss: 2868.8425; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97274648.0000; val_global_loss: 123911128.0000; val_optim_loss: 123911128.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8760; val_auprc_score: 0.8715; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 221151.5747; train_edge_recon_loss: 3682451.4444; train_gene_expr_recon_loss: 22342828.2222; train_masked_gp_l1_reg_loss: 2866.0315; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99004432.8889; train_global_loss: 125253729.7778; train_optim_loss: 125253729.7778; val_kl_reg_loss: 198857.6250; val_edge_recon_loss: 4065347.2500; val_gene_expr_recon_loss: 21946334.0000; val_masked_gp_l1_reg_loss: 2859.4338; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96874848.0000; val_global_loss: 123088248.0000; val_optim_loss: 123088248.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8724; val_auprc_score: 0.8692; val_best_acc_score: 0.5066; val_best_f1_score: 0.6696; train_kl_reg_loss: 236375.5174; train_edge_recon_loss: 3672300.8611; train_gene_expr_recon_loss: 21966295.3333; train_masked_gp_l1_reg_loss: 2853.0351; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97837454.2222; train_global_loss: 123715279.1111; train_optim_loss: 123715279.1111; val_kl_reg_loss: 198605.5938; val_edge_recon_loss: 4065077.2500; val_gene_expr_recon_loss: 21592784.0000; val_masked_gp_l1_reg_loss: 2844.8320; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96489296.0000; val_global_loss: 122348608.0000; val_optim_loss: 122348608.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8767; val_auprc_score: 0.8702; val_best_acc_score: 0.5137; val_best_f1_score: 0.6728; train_kl_reg_loss: 240162.6649; train_edge_recon_loss: 3673374.4722; train_gene_expr_recon_loss: 21636650.8889; train_masked_gp_l1_reg_loss: 2837.6486; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97943966.2222; train_global_loss: 123496992.0000; train_optim_loss: 123496992.0000; val_kl_reg_loss: 199429.0312; val_edge_recon_loss: 4064484.5000; val_gene_expr_recon_loss: 21381210.0000; val_masked_gp_l1_reg_loss: 2828.6724; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96250544.0000; val_global_loss: 121898496.0000; val_optim_loss: 121898496.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8837; val_auprc_score: 0.8785; val_best_acc_score: 0.5206; val_best_f1_score: 0.6758; train_kl_reg_loss: 247177.4462; train_edge_recon_loss: 3661840.3611; train_gene_expr_recon_loss: 21419959.1111; train_masked_gp_l1_reg_loss: 2824.3373; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97733625.7778; train_global_loss: 123065426.6667; train_optim_loss: 123065426.6667; val_kl_reg_loss: 225678.8438; val_edge_recon_loss: 4063874.2500; val_gene_expr_recon_loss: 21293810.0000; val_masked_gp_l1_reg_loss: 2818.6975; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96246232.0000; val_global_loss: 121832416.0000; val_optim_loss: 121832416.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8823; val_auprc_score: 0.8773; val_best_acc_score: 0.5356; val_best_f1_score: 0.6823; train_kl_reg_loss: 253954.4184; train_edge_recon_loss: 3647484.4444; train_gene_expr_recon_loss: 21483810.8889; train_masked_gp_l1_reg_loss: 2814.8239; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98436084.4444; train_global_loss: 123824150.2222; train_optim_loss: 123824150.2222; val_kl_reg_loss: 195155.2812; val_edge_recon_loss: 4062993.7500; val_gene_expr_recon_loss: 21176152.0000; val_masked_gp_l1_reg_loss: 2810.3608; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96005384.0000; val_global_loss: 121442496.0000; val_optim_loss: 121442496.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8833; val_auprc_score: 0.8778; val_best_acc_score: 0.5643; val_best_f1_score: 0.6955; train_kl_reg_loss: 241558.7552; train_edge_recon_loss: 3655942.1667; train_gene_expr_recon_loss: 21170502.2222; train_masked_gp_l1_reg_loss: 2808.1619; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97550450.6667; train_global_loss: 122621263.1111; train_optim_loss: 122621263.1111; val_kl_reg_loss: 199283.0469; val_edge_recon_loss: 4061776.5000; val_gene_expr_recon_loss: 21111292.0000; val_masked_gp_l1_reg_loss: 2806.3579; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95853872.0000; val_global_loss: 121229032.0000; val_optim_loss: 121229032.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8926; val_auprc_score: 0.8874; val_best_acc_score: 0.6028; val_best_f1_score: 0.7141; train_kl_reg_loss: 249048.6545; train_edge_recon_loss: 3638747.5000; train_gene_expr_recon_loss: 21264937.5556; train_masked_gp_l1_reg_loss: 2807.9049; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97272239.1111; train_global_loss: 122427780.4444; train_optim_loss: 122427780.4444; val_kl_reg_loss: 210951.2188; val_edge_recon_loss: 4060121.0000; val_gene_expr_recon_loss: 21042292.0000; val_masked_gp_l1_reg_loss: 2810.0950; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95795352.0000; val_global_loss: 121111528.0000; val_optim_loss: 121111528.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8923; val_auprc_score: 0.8856; val_best_acc_score: 0.6434; val_best_f1_score: 0.7347; train_kl_reg_loss: 240431.6285; train_edge_recon_loss: 3638352.2500; train_gene_expr_recon_loss: 21063599.1111; train_masked_gp_l1_reg_loss: 2812.4770; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96898201.7778; train_global_loss: 121843398.2222; train_optim_loss: 121843398.2222; val_kl_reg_loss: 213276.8438; val_edge_recon_loss: 4058040.7500; val_gene_expr_recon_loss: 21009770.0000; val_masked_gp_l1_reg_loss: 2814.5166; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95761240.0000; val_global_loss: 121045144.0000; val_optim_loss: 121045144.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8874; val_auprc_score: 0.8827; val_best_acc_score: 0.6812; val_best_f1_score: 0.7539; train_kl_reg_loss: 242532.2153; train_edge_recon_loss: 3625633.8056; train_gene_expr_recon_loss: 21083024.4444; train_masked_gp_l1_reg_loss: 2816.4181; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97161201.7778; train_global_loss: 122115209.7778; train_optim_loss: 122115209.7778; val_kl_reg_loss: 213053.3750; val_edge_recon_loss: 4054972.2500; val_gene_expr_recon_loss: 20951664.0000; val_masked_gp_l1_reg_loss: 2819.2974; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95484128.0000; val_global_loss: 120706640.0000; val_optim_loss: 120706640.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8905; val_auprc_score: 0.8848; val_best_acc_score: 0.7375; val_best_f1_score: 0.7857; train_kl_reg_loss: 239755.9583; train_edge_recon_loss: 3619105.0000; train_gene_expr_recon_loss: 21130272.4444; train_masked_gp_l1_reg_loss: 2823.0795; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97284598.2222; train_global_loss: 122276555.5556; train_optim_loss: 122276555.5556; val_kl_reg_loss: 192188.5000; val_edge_recon_loss: 4049411.0000; val_gene_expr_recon_loss: 20891510.0000; val_masked_gp_l1_reg_loss: 2827.0342; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95429336.0000; val_global_loss: 120565272.0000; val_optim_loss: 120565272.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8921; val_auprc_score: 0.8808; val_best_acc_score: 0.7658; val_best_f1_score: 0.8007; train_kl_reg_loss: 232536.7656; train_edge_recon_loss: 3626313.6944; train_gene_expr_recon_loss: 20898565.3333; train_masked_gp_l1_reg_loss: 2829.8035; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97046046.2222; train_global_loss: 121806291.5556; train_optim_loss: 121806291.5556; val_kl_reg_loss: 184809.5000; val_edge_recon_loss: 4044045.5000; val_gene_expr_recon_loss: 20873638.0000; val_masked_gp_l1_reg_loss: 2831.6453; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95441152.0000; val_global_loss: 120546480.0000; val_optim_loss: 120546480.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8956; val_auprc_score: 0.8828; val_best_acc_score: 0.7945; val_best_f1_score: 0.8162; train_kl_reg_loss: 233125.2031; train_edge_recon_loss: 3616017.0278; train_gene_expr_recon_loss: 20863900.2222; train_masked_gp_l1_reg_loss: 2833.9923; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96917615.1111; train_global_loss: 121633491.5556; train_optim_loss: 121633491.5556; val_kl_reg_loss: 193262.2188; val_edge_recon_loss: 4036094.2500; val_gene_expr_recon_loss: 20835842.0000; val_masked_gp_l1_reg_loss: 2837.7429; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95320712.0000; val_global_loss: 120388752.0000; val_optim_loss: 120388752.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8920; val_auprc_score: 0.8828; val_best_acc_score: 0.8002; val_best_f1_score: 0.8148; train_kl_reg_loss: 230012.2344; train_edge_recon_loss: 3610668.2778; train_gene_expr_recon_loss: 20896153.5556; train_masked_gp_l1_reg_loss: 2840.0401; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96550773.3333; train_global_loss: 121290447.1111; train_optim_loss: 121290447.1111; val_kl_reg_loss: 193078.8906; val_edge_recon_loss: 4027054.0000; val_gene_expr_recon_loss: 20784884.0000; val_masked_gp_l1_reg_loss: 2843.6548; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95114024.0000; val_global_loss: 120121888.0000; val_optim_loss: 120121888.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8932; val_auprc_score: 0.8827; val_best_acc_score: 0.8135; val_best_f1_score: 0.8179; train_kl_reg_loss: 227013.8733; train_edge_recon_loss: 3604975.1111; train_gene_expr_recon_loss: 20862515.5556; train_masked_gp_l1_reg_loss: 2847.0247; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96349256.8889; train_global_loss: 121046609.7778; train_optim_loss: 121046609.7778; val_kl_reg_loss: 184438.4375; val_edge_recon_loss: 4015623.0000; val_gene_expr_recon_loss: 20772540.0000; val_masked_gp_l1_reg_loss: 2849.9001; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95150184.0000; val_global_loss: 120125632.0000; val_optim_loss: 120125632.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9016; val_auprc_score: 0.8939; val_best_acc_score: 0.8234; val_best_f1_score: 0.8192; train_kl_reg_loss: 221749.0382; train_edge_recon_loss: 3602137.3611; train_gene_expr_recon_loss: 20890570.2222; train_masked_gp_l1_reg_loss: 2852.3781; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96789288.0000; train_global_loss: 121506598.2222; train_optim_loss: 121506598.2222; val_kl_reg_loss: 184319.6562; val_edge_recon_loss: 3999044.5000; val_gene_expr_recon_loss: 20758776.0000; val_masked_gp_l1_reg_loss: 2854.4717; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95180448.0000; val_global_loss: 120125440.0000; val_optim_loss: 120125440.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9061; val_auprc_score: 0.9001; val_best_acc_score: 0.8178; val_best_f1_score: 0.8042; train_kl_reg_loss: 219290.8299; train_edge_recon_loss: 3593667.0833; train_gene_expr_recon_loss: 20905619.5556; train_masked_gp_l1_reg_loss: 2856.6950; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96469994.6667; train_global_loss: 121191427.5556; train_optim_loss: 121191427.5556; val_kl_reg_loss: 170121.1875; val_edge_recon_loss: 3977144.7500; val_gene_expr_recon_loss: 20712254.0000; val_masked_gp_l1_reg_loss: 2859.6357; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94893048.0000; val_global_loss: 119755424.0000; val_optim_loss: 119755424.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9029; val_auprc_score: 0.8910; val_best_acc_score: 0.7991; val_best_f1_score: 0.8102; train_kl_reg_loss: 211616.5885; train_edge_recon_loss: 3589767.4167; train_gene_expr_recon_loss: 20781821.5556; train_masked_gp_l1_reg_loss: 2863.5120; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96494544.0000; train_global_loss: 121080614.2222; train_optim_loss: 121080614.2222; val_kl_reg_loss: 173562.5625; val_edge_recon_loss: 3948565.7500; val_gene_expr_recon_loss: 20681596.0000; val_masked_gp_l1_reg_loss: 2867.7502; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94829936.0000; val_global_loss: 119636528.0000; val_optim_loss: 119636528.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9046; val_auprc_score: 0.8901; val_best_acc_score: 0.8001; val_best_f1_score: 0.8244; train_kl_reg_loss: 210016.9618; train_edge_recon_loss: 3574410.8611; train_gene_expr_recon_loss: 20735121.5556; train_masked_gp_l1_reg_loss: 2870.8667; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96185514.6667; train_global_loss: 120707934.2222; train_optim_loss: 120707934.2222; val_kl_reg_loss: 173352.7500; val_edge_recon_loss: 3909993.2500; val_gene_expr_recon_loss: 20655380.0000; val_masked_gp_l1_reg_loss: 2874.4072; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94785848.0000; val_global_loss: 119527448.0000; val_optim_loss: 119527448.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9063; val_auprc_score: 0.8968; val_best_acc_score: 0.8129; val_best_f1_score: 0.8303; train_kl_reg_loss: 205320.0677; train_edge_recon_loss: 3560940.4444; train_gene_expr_recon_loss: 20807547.1111; train_masked_gp_l1_reg_loss: 2877.5444; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96370475.5556; train_global_loss: 120947161.7778; train_optim_loss: 120947161.7778; val_kl_reg_loss: 164253.2812; val_edge_recon_loss: 3861173.7500; val_gene_expr_recon_loss: 20620892.0000; val_masked_gp_l1_reg_loss: 2880.3396; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94509752.0000; val_global_loss: 119158952.0000; val_optim_loss: 119158952.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9174; val_auprc_score: 0.9074; val_best_acc_score: 0.8208; val_best_f1_score: 0.8189; train_kl_reg_loss: 224253.1372; train_edge_recon_loss: 3665200.1944; train_gene_expr_recon_loss: 20751989.7778; train_masked_gp_l1_reg_loss: 2883.2328; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96211479.1111; train_global_loss: 120855805.3333; train_optim_loss: 120855805.3333; val_kl_reg_loss: 139709.9219; val_edge_recon_loss: 3951424.2500; val_gene_expr_recon_loss: 20647216.0000; val_masked_gp_l1_reg_loss: 2889.0493; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94811800.0000; val_global_loss: 119553040.0000; val_optim_loss: 119553040.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9196; val_auprc_score: 0.9054; val_best_acc_score: 0.8354; val_best_f1_score: 0.8289; train_kl_reg_loss: 181176.5694; train_edge_recon_loss: 3651906.7222; train_gene_expr_recon_loss: 20858125.7778; train_masked_gp_l1_reg_loss: 2898.1030; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96104232.0000; train_global_loss: 120798338.6667; train_optim_loss: 120798338.6667; val_kl_reg_loss: 125959.2812; val_edge_recon_loss: 3975146.0000; val_gene_expr_recon_loss: 20652850.0000; val_masked_gp_l1_reg_loss: 2914.4209; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94543520.0000; val_global_loss: 119300392.0000; val_optim_loss: 119300392.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9186; val_auprc_score: 0.8995; val_best_acc_score: 0.8413; val_best_f1_score: 0.8376; train_kl_reg_loss: 206072.4149; train_edge_recon_loss: 3683123.9444; train_gene_expr_recon_loss: 20802460.6667; train_masked_gp_l1_reg_loss: 2931.6733; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95861440.0000; train_global_loss: 120556029.3333; train_optim_loss: 120556029.3333; val_kl_reg_loss: 147346.6250; val_edge_recon_loss: 3983061.0000; val_gene_expr_recon_loss: 20630158.0000; val_masked_gp_l1_reg_loss: 2952.1582; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94563592.0000; val_global_loss: 119327112.0000; val_optim_loss: 119327112.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9184; val_auprc_score: 0.9053; val_best_acc_score: 0.8301; val_best_f1_score: 0.8234; train_kl_reg_loss: 169999.0486; train_edge_recon_loss: 3692778.8889; train_gene_expr_recon_loss: 20781308.8889; train_masked_gp_l1_reg_loss: 2966.2900; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96120036.4444; train_global_loss: 120767090.6667; train_optim_loss: 120767090.6667; val_kl_reg_loss: 149182.9375; val_edge_recon_loss: 3965248.2500; val_gene_expr_recon_loss: 20624390.0000; val_masked_gp_l1_reg_loss: 2981.9976; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94566616.0000; val_global_loss: 119308416.0000; val_optim_loss: 119308416.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9177; val_auprc_score: 0.8999; val_best_acc_score: 0.8285; val_best_f1_score: 0.8214; train_kl_reg_loss: 160677.2188; train_edge_recon_loss: 3676611.3611; train_gene_expr_recon_loss: 20692808.8889; train_masked_gp_l1_reg_loss: 2982.8249; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95705068.4444; train_global_loss: 120238149.3333; train_optim_loss: 120238149.3333; val_kl_reg_loss: 149433.0000; val_edge_recon_loss: 3961043.2500; val_gene_expr_recon_loss: 20620588.0000; val_masked_gp_l1_reg_loss: 2983.6912; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94640872.0000; val_global_loss: 119374920.0000; val_optim_loss: 119374920.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9162; val_auprc_score: 0.8958; val_best_acc_score: 0.8259; val_best_f1_score: 0.8184; train_kl_reg_loss: 171079.4045; train_edge_recon_loss: 3672091.9444; train_gene_expr_recon_loss: 20608245.3333; train_masked_gp_l1_reg_loss: 2984.1528; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95539183.1111; train_global_loss: 119993583.1111; train_optim_loss: 119993583.1111; val_kl_reg_loss: 172955.7188; val_edge_recon_loss: 3961508.2500; val_gene_expr_recon_loss: 20569186.0000; val_masked_gp_l1_reg_loss: 2984.6926; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94403368.0000; val_global_loss: 119110000.0000; val_optim_loss: 119110000.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9181; val_auprc_score: 0.9002; val_best_acc_score: 0.8266; val_best_f1_score: 0.8196; train_kl_reg_loss: 196515.7622; train_edge_recon_loss: 3637399.5278; train_gene_expr_recon_loss: 20625630.6667; train_masked_gp_l1_reg_loss: 2985.0719; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95440586.6667; train_global_loss: 119903118.2222; train_optim_loss: 119903118.2222; val_kl_reg_loss: 173506.8281; val_edge_recon_loss: 3958366.2500; val_gene_expr_recon_loss: 20590162.0000; val_masked_gp_l1_reg_loss: 2985.4785; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94598576.0000; val_global_loss: 119323600.0000; val_optim_loss: 119323600.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9162; val_auprc_score: 0.8977; val_best_acc_score: 0.8234; val_best_f1_score: 0.8193; train_kl_reg_loss: 174900.7986; train_edge_recon_loss: 3649601.0000; train_gene_expr_recon_loss: 20675337.1111; train_masked_gp_l1_reg_loss: 2985.7738; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95910843.5556; train_global_loss: 120413669.3333; train_optim_loss: 120413669.3333; val_kl_reg_loss: 160816.2812; val_edge_recon_loss: 3955676.0000; val_gene_expr_recon_loss: 20577572.0000; val_masked_gp_l1_reg_loss: 2986.0967; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94503872.0000; val_global_loss: 119200920.0000; val_optim_loss: 119200920.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9246; val_auprc_score: 0.9102; val_best_acc_score: 0.8314; val_best_f1_score: 0.8265; train_kl_reg_loss: 185791.2378; train_edge_recon_loss: 3640470.7500; train_gene_expr_recon_loss: 20788331.7778; train_masked_gp_l1_reg_loss: 2986.1982; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96111136.0000; train_global_loss: 120728716.4444; train_optim_loss: 120728716.4444; val_kl_reg_loss: 174616.8750; val_edge_recon_loss: 3949898.5000; val_gene_expr_recon_loss: 20574292.0000; val_masked_gp_l1_reg_loss: 2986.3101; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94472648.0000; val_global_loss: 119174440.0000; val_optim_loss: 119174440.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9133; val_auprc_score: 0.8967; val_best_acc_score: 0.8186; val_best_f1_score: 0.8178; train_kl_reg_loss: 190316.0816; train_edge_recon_loss: 3667945.8056; train_gene_expr_recon_loss: 20666057.1111; train_masked_gp_l1_reg_loss: 2986.3958; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96165155.5556; train_global_loss: 120692460.4444; train_optim_loss: 120692460.4444; val_kl_reg_loss: 168758.3750; val_edge_recon_loss: 3953400.7500; val_gene_expr_recon_loss: 20575578.0000; val_masked_gp_l1_reg_loss: 2986.4961; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94472848.0000; val_global_loss: 119173568.0000; val_optim_loss: 119173568.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9194; val_auprc_score: 0.9006; val_best_acc_score: 0.8258; val_best_f1_score: 0.8215; train_kl_reg_loss: 184913.3872; train_edge_recon_loss: 3660810.1944; train_gene_expr_recon_loss: 20539791.1111; train_masked_gp_l1_reg_loss: 2986.5013; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95650064.0000; train_global_loss: 120038564.4444; train_optim_loss: 120038564.4444; val_kl_reg_loss: 167449.8125; val_edge_recon_loss: 3950648.0000; val_gene_expr_recon_loss: 20561776.0000; val_masked_gp_l1_reg_loss: 2986.5083; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94484776.0000; val_global_loss: 119167632.0000; val_optim_loss: 119167632.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9206; val_auprc_score: 0.9071; val_best_acc_score: 0.8261; val_best_f1_score: 0.8199; train_kl_reg_loss: 182262.0799; train_edge_recon_loss: 3656057.9444; train_gene_expr_recon_loss: 20708226.4444; train_masked_gp_l1_reg_loss: 2986.5148; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95490240.0000; train_global_loss: 120039773.3333; train_optim_loss: 120039773.3333; val_kl_reg_loss: 161854.9375; val_edge_recon_loss: 3950401.7500; val_gene_expr_recon_loss: 20562974.0000; val_masked_gp_l1_reg_loss: 2986.5308; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94356912.0000; val_global_loss: 119035128.0000; val_optim_loss: 119035128.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9197; val_auprc_score: 0.9033; val_best_acc_score: 0.8255; val_best_f1_score: 0.8240; train_kl_reg_loss: 175009.9444; train_edge_recon_loss: 3660473.3611; train_gene_expr_recon_loss: 20581104.4444; train_masked_gp_l1_reg_loss: 2986.5531; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95268974.2222; train_global_loss: 119688549.3333; train_optim_loss: 119688549.3333; val_kl_reg_loss: 157888.2344; val_edge_recon_loss: 3948206.0000; val_gene_expr_recon_loss: 20571578.0000; val_masked_gp_l1_reg_loss: 2986.5815; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94433136.0000; val_global_loss: 119113792.0000; val_optim_loss: 119113792.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9160; val_auprc_score: 0.8997; val_best_acc_score: 0.8217; val_best_f1_score: 0.8217; train_kl_reg_loss: 173374.7448; train_edge_recon_loss: 3661056.2222; train_gene_expr_recon_loss: 20678105.3333; train_masked_gp_l1_reg_loss: 2986.6089; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95264771.5556; train_global_loss: 119780295.1111; train_optim_loss: 119780295.1111; val_kl_reg_loss: 157724.2656; val_edge_recon_loss: 3949209.7500; val_gene_expr_recon_loss: 20557998.0000; val_masked_gp_l1_reg_loss: 2986.6362; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94367984.0000; val_global_loss: 119035904.0000; val_optim_loss: 119035904.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9220; val_auprc_score: 0.9074; val_best_acc_score: 0.8266; val_best_f1_score: 0.8246; train_kl_reg_loss: 176364.8854; train_edge_recon_loss: 3658500.0000; train_gene_expr_recon_loss: 20685681.5556; train_masked_gp_l1_reg_loss: 2986.6485; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96087964.4444; train_global_loss: 120611497.7778; train_optim_loss: 120611497.7778; val_kl_reg_loss: 160321.7188; val_edge_recon_loss: 3945787.2500; val_gene_expr_recon_loss: 20549540.0000; val_masked_gp_l1_reg_loss: 2986.6626; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94287936.0000; val_global_loss: 118946568.0000; val_optim_loss: 118946568.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9242; val_auprc_score: 0.9096; val_best_acc_score: 0.8290; val_best_f1_score: 0.8280; train_kl_reg_loss: 179570.5625; train_edge_recon_loss: 3660497.1389; train_gene_expr_recon_loss: 20657677.7778; train_masked_gp_l1_reg_loss: 2986.6826; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95319069.3333; train_global_loss: 119819800.0000; train_optim_loss: 119819800.0000; val_kl_reg_loss: 163477.0625; val_edge_recon_loss: 3944446.5000; val_gene_expr_recon_loss: 20548148.0000; val_masked_gp_l1_reg_loss: 2986.6987; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94344312.0000; val_global_loss: 119003368.0000; val_optim_loss: 119003368.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9228; val_auprc_score: 0.9078; val_best_acc_score: 0.8285; val_best_f1_score: 0.8245; train_kl_reg_loss: 182748.6562; train_edge_recon_loss: 3655876.3056; train_gene_expr_recon_loss: 20518249.1111; train_masked_gp_l1_reg_loss: 2986.6978; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95454833.7778; train_global_loss: 119814693.3333; train_optim_loss: 119814693.3333; val_kl_reg_loss: 163015.3750; val_edge_recon_loss: 3944503.7500; val_gene_expr_recon_loss: 20567964.0000; val_masked_gp_l1_reg_loss: 2986.7036; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94464200.0000; val_global_loss: 119142672.0000; val_optim_loss: 119142672.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9196; val_auprc_score: 0.9036; val_best_acc_score: 0.8243; val_best_f1_score: 0.8221; train_kl_reg_loss: 182377.1354; train_edge_recon_loss: 3655089.8056; train_gene_expr_recon_loss: 20630966.4444; train_masked_gp_l1_reg_loss: 2986.7143; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96146904.0000; train_global_loss: 120618323.5556; train_optim_loss: 120618323.5556; val_kl_reg_loss: 163513.7656; val_edge_recon_loss: 3949915.7500; val_gene_expr_recon_loss: 20563158.0000; val_masked_gp_l1_reg_loss: 2986.7251; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94430400.0000; val_global_loss: 119109976.0000; val_optim_loss: 119109976.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9172; val_auprc_score: 0.9027; val_best_acc_score: 0.8205; val_best_f1_score: 0.8211; train_kl_reg_loss: 178724.8281; train_edge_recon_loss: 3653958.5278; train_gene_expr_recon_loss: 20559986.0000; train_masked_gp_l1_reg_loss: 2986.7329; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95153288.0000; train_global_loss: 119548942.2222; train_optim_loss: 119548942.2222; val_kl_reg_loss: 161278.7188; val_edge_recon_loss: 3950331.0000; val_gene_expr_recon_loss: 20560450.0000; val_masked_gp_l1_reg_loss: 2986.7468; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94415696.0000; val_global_loss: 119090744.0000; val_optim_loss: 119090744.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9211; val_auprc_score: 0.9060; val_best_acc_score: 0.8247; val_best_f1_score: 0.8245; train_kl_reg_loss: 180305.8108; train_edge_recon_loss: 3652405.2222; train_gene_expr_recon_loss: 20602482.6667; train_masked_gp_l1_reg_loss: 2986.7482; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95674648.8889; train_global_loss: 120112829.3333; train_optim_loss: 120112829.3333; val_kl_reg_loss: 161249.6406; val_edge_recon_loss: 3946925.5000; val_gene_expr_recon_loss: 20562442.0000; val_masked_gp_l1_reg_loss: 2986.7500; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94361184.0000; val_global_loss: 119034784.0000; val_optim_loss: 119034784.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9232; val_auprc_score: 0.9098; val_best_acc_score: 0.8265; val_best_f1_score: 0.8269; train_kl_reg_loss: 182469.7587; train_edge_recon_loss: 3655572.0833; train_gene_expr_recon_loss: 20594818.6667; train_masked_gp_l1_reg_loss: 2986.7517; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95049720.0000; train_global_loss: 119485567.1111; train_optim_loss: 119485567.1111; val_kl_reg_loss: 159764.0000; val_edge_recon_loss: 3945834.7500; val_gene_expr_recon_loss: 20541916.0000; val_masked_gp_l1_reg_loss: 2986.7539; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94241808.0000; val_global_loss: 118892304.0000; val_optim_loss: 118892304.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9135; val_auprc_score: 0.8989; val_best_acc_score: 0.8165; val_best_f1_score: 0.8188; train_kl_reg_loss: 180291.0503; train_edge_recon_loss: 3655792.0556; train_gene_expr_recon_loss: 20548587.3333; train_masked_gp_l1_reg_loss: 2986.7547; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95268912.0000; train_global_loss: 119656567.1111; train_optim_loss: 119656567.1111; val_kl_reg_loss: 161586.2500; val_edge_recon_loss: 3951982.5000; val_gene_expr_recon_loss: 20553920.0000; val_masked_gp_l1_reg_loss: 2986.7554; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94275360.0000; val_global_loss: 118945832.0000; val_optim_loss: 118945832.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9164; val_auprc_score: 0.8960; val_best_acc_score: 0.8205; val_best_f1_score: 0.8285; train_kl_reg_loss: 177928.3403; train_edge_recon_loss: 3651219.3611; train_gene_expr_recon_loss: 20577110.4444; train_masked_gp_l1_reg_loss: 2986.7563; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95520567.1111; train_global_loss: 119929812.4444; train_optim_loss: 119929812.4444; val_kl_reg_loss: 161758.1250; val_edge_recon_loss: 3946015.0000; val_gene_expr_recon_loss: 20561144.0000; val_masked_gp_l1_reg_loss: 2986.7590; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94486520.0000; val_global_loss: 119158424.0000; val_optim_loss: 119158424.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9200; val_auprc_score: 0.9025; val_best_acc_score: 0.8226; val_best_f1_score: 0.8306; train_kl_reg_loss: 178704.7639; train_edge_recon_loss: 3658144.5000; train_gene_expr_recon_loss: 20621172.8889; train_masked_gp_l1_reg_loss: 2986.7612; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95197011.5556; train_global_loss: 119658019.5556; train_optim_loss: 119658019.5556; val_kl_reg_loss: 162822.5312; val_edge_recon_loss: 3942816.7500; val_gene_expr_recon_loss: 20572906.0000; val_masked_gp_l1_reg_loss: 2986.7639; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94451000.0000; val_global_loss: 119132528.0000; val_optim_loss: 119132528.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9202; val_auprc_score: 0.9031; val_best_acc_score: 0.8240; val_best_f1_score: 0.8276; train_kl_reg_loss: 179060.7865; train_edge_recon_loss: 3654737.6111; train_gene_expr_recon_loss: 20577824.0000; train_masked_gp_l1_reg_loss: 2986.7654; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95558428.4444; train_global_loss: 119973037.3333; train_optim_loss: 119973037.3333; val_kl_reg_loss: 160200.2188; val_edge_recon_loss: 3946263.0000; val_gene_expr_recon_loss: 20564816.0000; val_masked_gp_l1_reg_loss: 2986.7676; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94424408.0000; val_global_loss: 119098672.0000; val_optim_loss: 119098672.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9189; val_auprc_score: 0.9042; val_best_acc_score: 0.8224; val_best_f1_score: 0.8254; train_kl_reg_loss: 177179.3611; train_edge_recon_loss: 3653214.8889; train_gene_expr_recon_loss: 20691567.3333; train_masked_gp_l1_reg_loss: 2986.7677; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95978891.5556; train_global_loss: 120503840.8889; train_optim_loss: 120503840.8889; val_kl_reg_loss: 161774.6094; val_edge_recon_loss: 3945971.5000; val_gene_expr_recon_loss: 20557036.0000; val_masked_gp_l1_reg_loss: 2986.7681; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94395776.0000; val_global_loss: 119063544.0000; val_optim_loss: 119063544.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9248; val_auprc_score: 0.9153; val_best_acc_score: 0.8275; val_best_f1_score: 0.8255; train_kl_reg_loss: 179418.6597; train_edge_recon_loss: 3660040.9444; train_gene_expr_recon_loss: 20730456.6667; train_masked_gp_l1_reg_loss: 2986.7681; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96564732.4444; train_global_loss: 121137634.6667; train_optim_loss: 121137634.6667; val_kl_reg_loss: 162071.7500; val_edge_recon_loss: 3948949.5000; val_gene_expr_recon_loss: 20561594.0000; val_masked_gp_l1_reg_loss: 2986.7681; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94449160.0000; val_global_loss: 119124760.0000; val_optim_loss: 119124760.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9203; val_auprc_score: 0.9048; val_best_acc_score: 0.8234; val_best_f1_score: 0.8263; train_kl_reg_loss: 177374.0122; train_edge_recon_loss: 3656010.9167; train_gene_expr_recon_loss: 20573096.8889; train_masked_gp_l1_reg_loss: 2986.7683; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96000829.3333; train_global_loss: 120410296.8889; train_optim_loss: 120410296.8889; val_kl_reg_loss: 160579.7031; val_edge_recon_loss: 3945433.5000; val_gene_expr_recon_loss: 20555792.0000; val_masked_gp_l1_reg_loss: 2986.7686; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94379664.0000; val_global_loss: 119044456.0000; val_optim_loss: 119044456.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9204; val_auprc_score: 0.9058; val_best_acc_score: 0.8219; val_best_f1_score: 0.8241; train_kl_reg_loss: 179031.5122; train_edge_recon_loss: 3650163.4444; train_gene_expr_recon_loss: 20583739.7778; train_masked_gp_l1_reg_loss: 2986.7685; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95517998.2222; train_global_loss: 119933920.8889; train_optim_loss: 119933920.8889; val_kl_reg_loss: 161585.7188; val_edge_recon_loss: 3944981.7500; val_gene_expr_recon_loss: 20543308.0000; val_masked_gp_l1_reg_loss: 2986.7686; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94316240.0000; val_global_loss: 118969104.0000; val_optim_loss: 118969104.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 55 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9202
Val AUPRC score: 0.9041
Val best accuracy score: 0.8220
Val best F1 score: 0.8297
Val gene expr MSE score: 0.3491
Val chrom access MSE score: 0.0843
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
