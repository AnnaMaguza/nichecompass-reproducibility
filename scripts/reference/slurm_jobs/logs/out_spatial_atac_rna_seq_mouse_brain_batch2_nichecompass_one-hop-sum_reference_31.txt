[True]
Run timestamp: 10082023_200957_31.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_31']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7918; val_auprc_score: 0.8075; val_best_acc_score: 0.5329; val_best_f1_score: 0.6792; train_kl_reg_loss: 121962.4097; train_edge_recon_loss: 3718341.4122; train_gene_expr_recon_loss: 29681166.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 76998201.3130; train_global_loss: 110519671.8168; train_optim_loss: 110519671.8168; val_kl_reg_loss: 109626.4724; val_edge_recon_loss: 4062743.6667; val_gene_expr_recon_loss: 23698981.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 70669286.9333; val_global_loss: 98540637.8667; val_optim_loss: 98540637.8667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7863; val_auprc_score: 0.8074; val_best_acc_score: 0.6425; val_best_f1_score: 0.7165; train_kl_reg_loss: 158551.5428; train_edge_recon_loss: 3691030.7977; train_gene_expr_recon_loss: 23115848.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 69483599.2977; train_global_loss: 96449030.5954; train_optim_loss: 96449030.5954; val_kl_reg_loss: 209969.7583; val_edge_recon_loss: 4057152.5167; val_gene_expr_recon_loss: 22434243.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 69766457.3333; val_global_loss: 96467824.0000; val_optim_loss: 96467824.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8204; val_auprc_score: 0.8353; val_best_acc_score: 0.7316; val_best_f1_score: 0.7308; train_kl_reg_loss: 159725.3318; train_edge_recon_loss: 3594703.9523; train_gene_expr_recon_loss: 22339257.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68665699.3588; train_global_loss: 94759385.8321; train_optim_loss: 94759385.8321; val_kl_reg_loss: 208914.9219; val_edge_recon_loss: 4029978.4333; val_gene_expr_recon_loss: 22163110.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 69534432.2667; val_global_loss: 95936437.3333; val_optim_loss: 95936437.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8865; val_auprc_score: 0.8790; val_best_acc_score: 0.7972; val_best_f1_score: 0.8091; train_kl_reg_loss: 140678.3765; train_edge_recon_loss: 3515702.6069; train_gene_expr_recon_loss: 22099404.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68364736.5802; train_global_loss: 94120522.7481; train_optim_loss: 94120522.7481; val_kl_reg_loss: 120877.9078; val_edge_recon_loss: 3601815.5833; val_gene_expr_recon_loss: 21893722.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68709756.0000; val_global_loss: 94326172.2667; val_optim_loss: 94326172.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8826; val_auprc_score: 0.8711; val_best_acc_score: 0.7956; val_best_f1_score: 0.8131; train_kl_reg_loss: 140808.2372; train_edge_recon_loss: 3162053.7882; train_gene_expr_recon_loss: 21882166.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67789077.6489; train_global_loss: 92974105.1603; train_optim_loss: 92974105.1603; val_kl_reg_loss: 164812.1750; val_edge_recon_loss: 3057877.4167; val_gene_expr_recon_loss: 21738898.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68327386.1333; val_global_loss: 93288975.4667; val_optim_loss: 93288975.4667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8864; val_auprc_score: 0.8740; val_best_acc_score: 0.8001; val_best_f1_score: 0.8202; train_kl_reg_loss: 168685.3869; train_edge_recon_loss: 3001273.3378; train_gene_expr_recon_loss: 21725800.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67433917.7710; train_global_loss: 92329676.9466; train_optim_loss: 92329676.9466; val_kl_reg_loss: 165524.5656; val_edge_recon_loss: 3010676.4833; val_gene_expr_recon_loss: 21608726.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68152732.0000; val_global_loss: 92937658.6667; val_optim_loss: 92937658.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9025; val_auprc_score: 0.8908; val_best_acc_score: 0.8195; val_best_f1_score: 0.8355; train_kl_reg_loss: 163487.9624; train_edge_recon_loss: 2955718.6489; train_gene_expr_recon_loss: 21613727.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67116619.6641; train_global_loss: 91849554.1374; train_optim_loss: 91849554.1374; val_kl_reg_loss: 158639.2458; val_edge_recon_loss: 2953146.2833; val_gene_expr_recon_loss: 21451840.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67660624.5333; val_global_loss: 92224250.1333; val_optim_loss: 92224250.1333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9111; val_auprc_score: 0.9012; val_best_acc_score: 0.8293; val_best_f1_score: 0.8432; train_kl_reg_loss: 156319.5567; train_edge_recon_loss: 2932160.3034; train_gene_expr_recon_loss: 21497896.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66846041.1603; train_global_loss: 91432417.2824; train_optim_loss: 91432417.2824; val_kl_reg_loss: 153238.8604; val_edge_recon_loss: 2951281.6333; val_gene_expr_recon_loss: 21323965.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67281293.6000; val_global_loss: 91709780.2667; val_optim_loss: 91709780.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9195; val_auprc_score: 0.9060; val_best_acc_score: 0.8448; val_best_f1_score: 0.8560; train_kl_reg_loss: 152476.0485; train_edge_recon_loss: 2901762.6966; train_gene_expr_recon_loss: 21365470.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66380200.9466; train_global_loss: 90799909.9847; train_optim_loss: 90799909.9847; val_kl_reg_loss: 152664.5104; val_edge_recon_loss: 2872930.2333; val_gene_expr_recon_loss: 21270451.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66621148.5333; val_global_loss: 90917194.6667; val_optim_loss: 90917194.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9145; val_auprc_score: 0.8993; val_best_acc_score: 0.8386; val_best_f1_score: 0.8504; train_kl_reg_loss: 148889.4903; train_edge_recon_loss: 2878198.0439; train_gene_expr_recon_loss: 21299188.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66207651.9695; train_global_loss: 90533928.6718; train_optim_loss: 90533928.6718; val_kl_reg_loss: 147130.7156; val_edge_recon_loss: 2914223.6000; val_gene_expr_recon_loss: 21238260.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66872701.0667; val_global_loss: 91172315.7333; val_optim_loss: 91172315.7333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9288; val_auprc_score: 0.9166; val_best_acc_score: 0.8544; val_best_f1_score: 0.8654; train_kl_reg_loss: 146678.0321; train_edge_recon_loss: 2850937.2214; train_gene_expr_recon_loss: 21224575.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65959289.0382; train_global_loss: 90181480.0000; train_optim_loss: 90181480.0000; val_kl_reg_loss: 144955.4156; val_edge_recon_loss: 2864835.7167; val_gene_expr_recon_loss: 21147880.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66673439.7333; val_global_loss: 90831110.9333; val_optim_loss: 90831110.9333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9391; val_auprc_score: 0.9293; val_best_acc_score: 0.8705; val_best_f1_score: 0.8796; train_kl_reg_loss: 143590.3928; train_edge_recon_loss: 2829226.5954; train_gene_expr_recon_loss: 21156031.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65757274.5649; train_global_loss: 89886122.9313; train_optim_loss: 89886122.9313; val_kl_reg_loss: 143192.3208; val_edge_recon_loss: 2840416.4167; val_gene_expr_recon_loss: 21117806.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66540309.0667; val_global_loss: 90641722.6667; val_optim_loss: 90641722.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9420; val_auprc_score: 0.9293; val_best_acc_score: 0.8783; val_best_f1_score: 0.8857; train_kl_reg_loss: 141372.9896; train_edge_recon_loss: 2813454.7271; train_gene_expr_recon_loss: 21104789.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65572384.7023; train_global_loss: 89632001.4656; train_optim_loss: 89632001.4656; val_kl_reg_loss: 140107.2542; val_edge_recon_loss: 2816154.1667; val_gene_expr_recon_loss: 21028761.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66100310.9333; val_global_loss: 90085333.8667; val_optim_loss: 90085333.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9495; val_auprc_score: 0.9398; val_best_acc_score: 0.8864; val_best_f1_score: 0.8927; train_kl_reg_loss: 140304.8063; train_edge_recon_loss: 2792762.2290; train_gene_expr_recon_loss: 21041094.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65443717.3130; train_global_loss: 89417879.0840; train_optim_loss: 89417879.0840; val_kl_reg_loss: 139813.0417; val_edge_recon_loss: 2817122.8333; val_gene_expr_recon_loss: 20925963.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65835325.0667; val_global_loss: 89718224.0000; val_optim_loss: 89718224.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9467; val_auprc_score: 0.9359; val_best_acc_score: 0.8814; val_best_f1_score: 0.8884; train_kl_reg_loss: 136603.0706; train_edge_recon_loss: 2785489.1622; train_gene_expr_recon_loss: 20990723.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65211983.2366; train_global_loss: 89124798.8397; train_optim_loss: 89124798.8397; val_kl_reg_loss: 135112.4354; val_edge_recon_loss: 2790270.6000; val_gene_expr_recon_loss: 20850080.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65428327.7333; val_global_loss: 89203790.4000; val_optim_loss: 89203790.4000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9502; val_auprc_score: 0.9380; val_best_acc_score: 0.8856; val_best_f1_score: 0.8922; train_kl_reg_loss: 134639.0723; train_edge_recon_loss: 2776681.2252; train_gene_expr_recon_loss: 20946657.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65047523.0840; train_global_loss: 88905501.4962; train_optim_loss: 88905501.4962; val_kl_reg_loss: 135325.0641; val_edge_recon_loss: 2783592.5333; val_gene_expr_recon_loss: 20806727.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65649205.0667; val_global_loss: 89374849.6000; val_optim_loss: 89374849.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9538; val_auprc_score: 0.9439; val_best_acc_score: 0.8898; val_best_f1_score: 0.8948; train_kl_reg_loss: 131079.1528; train_edge_recon_loss: 2770305.9828; train_gene_expr_recon_loss: 20894680.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64853272.8550; train_global_loss: 88649338.9313; train_optim_loss: 88649338.9313; val_kl_reg_loss: 127250.1802; val_edge_recon_loss: 2787597.9000; val_gene_expr_recon_loss: 20781641.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65493273.3333; val_global_loss: 89189761.6000; val_optim_loss: 89189761.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9534; val_auprc_score: 0.9457; val_best_acc_score: 0.8857; val_best_f1_score: 0.8932; train_kl_reg_loss: 127764.8699; train_edge_recon_loss: 2769447.2920; train_gene_expr_recon_loss: 20888234.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64903578.0153; train_global_loss: 88689024.6718; train_optim_loss: 88689024.6718; val_kl_reg_loss: 127265.5312; val_edge_recon_loss: 2797722.7833; val_gene_expr_recon_loss: 20796805.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65532173.0667; val_global_loss: 89253967.4667; val_optim_loss: 89253967.4667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9607; val_auprc_score: 0.9543; val_best_acc_score: 0.8998; val_best_f1_score: 0.9044; train_kl_reg_loss: 125870.4274; train_edge_recon_loss: 2764007.3340; train_gene_expr_recon_loss: 20818570.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64622953.8931; train_global_loss: 88331402.8702; train_optim_loss: 88331402.8702; val_kl_reg_loss: 124332.2516; val_edge_recon_loss: 2771182.4667; val_gene_expr_recon_loss: 20769457.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65187372.5333; val_global_loss: 88852344.5333; val_optim_loss: 88852344.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9607; val_auprc_score: 0.9521; val_best_acc_score: 0.9003; val_best_f1_score: 0.9050; train_kl_reg_loss: 122878.4629; train_edge_recon_loss: 2759916.3931; train_gene_expr_recon_loss: 20779273.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64474772.9160; train_global_loss: 88136841.8321; train_optim_loss: 88136841.8321; val_kl_reg_loss: 126017.2057; val_edge_recon_loss: 2760299.5833; val_gene_expr_recon_loss: 20762969.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65521834.4000; val_global_loss: 89171120.5333; val_optim_loss: 89171120.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9610; val_auprc_score: 0.9534; val_best_acc_score: 0.8981; val_best_f1_score: 0.9036; train_kl_reg_loss: 120834.2085; train_edge_recon_loss: 2756427.4408; train_gene_expr_recon_loss: 20738016.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64356798.3511; train_global_loss: 87972077.0076; train_optim_loss: 87972077.0076; val_kl_reg_loss: 122327.3677; val_edge_recon_loss: 2770532.2833; val_gene_expr_recon_loss: 20718594.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65074399.7333; val_global_loss: 88685854.4000; val_optim_loss: 88685854.4000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9628; val_auprc_score: 0.9550; val_best_acc_score: 0.9008; val_best_f1_score: 0.9059; train_kl_reg_loss: 117926.8733; train_edge_recon_loss: 2752009.2118; train_gene_expr_recon_loss: 20716454.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64246576.0611; train_global_loss: 87832966.2901; train_optim_loss: 87832966.2901; val_kl_reg_loss: 114691.7349; val_edge_recon_loss: 2775562.2000; val_gene_expr_recon_loss: 20679360.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64857141.6000; val_global_loss: 88426756.2667; val_optim_loss: 88426756.2667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9668; val_auprc_score: 0.9613; val_best_acc_score: 0.9088; val_best_f1_score: 0.9126; train_kl_reg_loss: 117201.4802; train_edge_recon_loss: 2741927.8874; train_gene_expr_recon_loss: 20676636.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64161123.4504; train_global_loss: 87696889.0382; train_optim_loss: 87696889.0382; val_kl_reg_loss: 118051.9937; val_edge_recon_loss: 2738845.0500; val_gene_expr_recon_loss: 20649520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64714010.4000; val_global_loss: 88220428.2667; val_optim_loss: 88220428.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9663; val_auprc_score: 0.9599; val_best_acc_score: 0.9068; val_best_f1_score: 0.9118; train_kl_reg_loss: 115004.9704; train_edge_recon_loss: 2745343.6489; train_gene_expr_recon_loss: 20673021.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64162904.7328; train_global_loss: 87696274.5038; train_optim_loss: 87696274.5038; val_kl_reg_loss: 113898.8656; val_edge_recon_loss: 2754374.9167; val_gene_expr_recon_loss: 20651296.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64797741.6000; val_global_loss: 88317311.4667; val_optim_loss: 88317311.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9684; val_auprc_score: 0.9624; val_best_acc_score: 0.9123; val_best_f1_score: 0.9158; train_kl_reg_loss: 113506.5818; train_edge_recon_loss: 2735454.3531; train_gene_expr_recon_loss: 20625546.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64034911.2977; train_global_loss: 87509418.8702; train_optim_loss: 87509418.8702; val_kl_reg_loss: 113017.3370; val_edge_recon_loss: 2736440.1333; val_gene_expr_recon_loss: 20595399.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64719491.2000; val_global_loss: 88164348.2667; val_optim_loss: 88164348.2667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9449; val_auprc_score: 0.9347; val_best_acc_score: 0.8805; val_best_f1_score: 0.8879; train_kl_reg_loss: 144098.6455; train_edge_recon_loss: 2880253.6145; train_gene_expr_recon_loss: 23655850.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66362142.1985; train_global_loss: 93042345.2824; train_optim_loss: 93042345.2824; val_kl_reg_loss: 14580.6886; val_edge_recon_loss: 2866368.2833; val_gene_expr_recon_loss: 24440582.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67449551.4667; val_global_loss: 94771082.6667; val_optim_loss: 94771082.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9432; val_auprc_score: 0.9288; val_best_acc_score: 0.8795; val_best_f1_score: 0.8866; train_kl_reg_loss: 85488.9072; train_edge_recon_loss: 2788477.5038; train_gene_expr_recon_loss: 24486268.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66910891.9695; train_global_loss: 94271126.9618; train_optim_loss: 94271126.9618; val_kl_reg_loss: 19454.2652; val_edge_recon_loss: 2761059.5167; val_gene_expr_recon_loss: 24040280.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66897135.4667; val_global_loss: 93717930.6667; val_optim_loss: 93717930.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9427; val_auprc_score: 0.9259; val_best_acc_score: 0.8806; val_best_f1_score: 0.8874; train_kl_reg_loss: 48791.5134; train_edge_recon_loss: 2760976.2576; train_gene_expr_recon_loss: 24027931.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66541578.9313; train_global_loss: 93379278.1069; train_optim_loss: 93379278.1069; val_kl_reg_loss: 22860.7230; val_edge_recon_loss: 2739603.0333; val_gene_expr_recon_loss: 23765324.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67132446.1333; val_global_loss: 93660234.1333; val_optim_loss: 93660234.1333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9512; val_auprc_score: 0.9364; val_best_acc_score: 0.8942; val_best_f1_score: 0.8996; train_kl_reg_loss: 44477.1741; train_edge_recon_loss: 2705327.2176; train_gene_expr_recon_loss: 23743708.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66556129.4351; train_global_loss: 93049642.4427; train_optim_loss: 93049642.4427; val_kl_reg_loss: 27279.4074; val_edge_recon_loss: 2705455.6167; val_gene_expr_recon_loss: 23505553.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66924839.4667; val_global_loss: 93163127.4667; val_optim_loss: 93163127.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9480; val_auprc_score: 0.9312; val_best_acc_score: 0.8911; val_best_f1_score: 0.8974; train_kl_reg_loss: 43043.0718; train_edge_recon_loss: 2699884.0344; train_gene_expr_recon_loss: 23572307.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66286461.1603; train_global_loss: 92601695.8168; train_optim_loss: 92601695.8168; val_kl_reg_loss: 27362.5361; val_edge_recon_loss: 2718513.2000; val_gene_expr_recon_loss: 23520720.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66831709.0667; val_global_loss: 93098304.5333; val_optim_loss: 93098304.5333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9545; val_auprc_score: 0.9389; val_best_acc_score: 0.9027; val_best_f1_score: 0.9056; train_kl_reg_loss: 42665.3834; train_edge_recon_loss: 2695344.2080; train_gene_expr_recon_loss: 23559470.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66296707.2061; train_global_loss: 92594187.9084; train_optim_loss: 92594187.9084; val_kl_reg_loss: 27328.3947; val_edge_recon_loss: 2704364.1667; val_gene_expr_recon_loss: 23515142.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67123645.3333; val_global_loss: 93370481.0667; val_optim_loss: 93370481.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9549; val_auprc_score: 0.9386; val_best_acc_score: 0.9019; val_best_f1_score: 0.9062; train_kl_reg_loss: 42366.0108; train_edge_recon_loss: 2688075.6679; train_gene_expr_recon_loss: 23514947.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66182651.9695; train_global_loss: 92428041.0382; train_optim_loss: 92428041.0382; val_kl_reg_loss: 27610.6264; val_edge_recon_loss: 2687366.4333; val_gene_expr_recon_loss: 23303585.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66527871.7333; val_global_loss: 92546434.1333; val_optim_loss: 92546434.1333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9562; val_auprc_score: 0.9439; val_best_acc_score: 0.9018; val_best_f1_score: 0.9070; train_kl_reg_loss: 41848.2143; train_edge_recon_loss: 2700233.2443; train_gene_expr_recon_loss: 23502424.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66233387.3893; train_global_loss: 92477893.0076; train_optim_loss: 92477893.0076; val_kl_reg_loss: 27564.9454; val_edge_recon_loss: 2693919.7000; val_gene_expr_recon_loss: 23401392.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66803136.2667; val_global_loss: 92926013.3333; val_optim_loss: 92926013.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 57 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9702
val AUPRC score: 0.9634
val best accuracy score: 0.9130
val best F1 score: 0.9164
val target rna MSE score: 1.3165
val source rna MSE score: 324.1884
val target atac MSE score: 0.1284
val source atac MSE score: 1.0316
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
