[True, False, True]
Run timestamp: 19102023_172844_42.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_42']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 474107
Number of validation nodes: 52678
Number of training edges: 1120696
Number of validation edges: 124521
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9016; val_auprc_score: 0.9778; val_best_acc_score: 0.9071; val_best_f1_score: 0.9470; train_kl_reg_loss: 30005.5045; train_edge_recon_loss: 8197720.9032; train_gene_expr_recon_loss: 28025760.1672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 320047.0660; train_global_loss: 36573533.6601; train_optim_loss: 36573533.6601; val_kl_reg_loss: 28719.9437; val_edge_recon_loss: 8309320.6045; val_gene_expr_recon_loss: 25393954.7131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156815.0000; val_global_loss: 33888810.8852; val_optim_loss: 33888810.8852
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9083; val_auprc_score: 0.9793; val_best_acc_score: 0.9105; val_best_f1_score: 0.9489; train_kl_reg_loss: 34813.8010; train_edge_recon_loss: 7951840.2940; train_gene_expr_recon_loss: 23871611.4408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164731.2191; train_global_loss: 32022996.7455; train_optim_loss: 32022996.7455; val_kl_reg_loss: 41262.3561; val_edge_recon_loss: 8367443.6189; val_gene_expr_recon_loss: 22771782.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169595.3750; val_global_loss: 31350084.8689; val_optim_loss: 31350084.8689
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9128; val_auprc_score: 0.9808; val_best_acc_score: 0.9126; val_best_f1_score: 0.9499; train_kl_reg_loss: 44943.2131; train_edge_recon_loss: 7923482.4077; train_gene_expr_recon_loss: 22289434.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171412.3545; train_global_loss: 30429272.2832; train_optim_loss: 30429272.2832; val_kl_reg_loss: 48206.9031; val_edge_recon_loss: 8297847.7910; val_gene_expr_recon_loss: 21888502.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174747.0938; val_global_loss: 30409305.5000; val_optim_loss: 30409305.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9176; val_auprc_score: 0.9818; val_best_acc_score: 0.9163; val_best_f1_score: 0.9521; train_kl_reg_loss: 53150.6981; train_edge_recon_loss: 7936735.8847; train_gene_expr_recon_loss: 21682991.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 174791.3133; train_global_loss: 29847668.9091; train_optim_loss: 29847668.9091; val_kl_reg_loss: 56683.7853; val_edge_recon_loss: 8238468.9857; val_gene_expr_recon_loss: 21496232.3525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173819.4219; val_global_loss: 29965205.1311; val_optim_loss: 29965205.1311
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9206; val_auprc_score: 0.9824; val_best_acc_score: 0.9163; val_best_f1_score: 0.9521; train_kl_reg_loss: 60120.4242; train_edge_recon_loss: 7939400.5772; train_gene_expr_recon_loss: 21379689.9726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173534.8458; train_global_loss: 29552745.7953; train_optim_loss: 29552745.7953; val_kl_reg_loss: 62945.2009; val_edge_recon_loss: 8298882.0779; val_gene_expr_recon_loss: 21235811.2131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173571.1719; val_global_loss: 29771210.4918; val_optim_loss: 29771210.4918
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9217; val_auprc_score: 0.9827; val_best_acc_score: 0.9181; val_best_f1_score: 0.9529; train_kl_reg_loss: 65790.1746; train_edge_recon_loss: 7942879.4413; train_gene_expr_recon_loss: 21209811.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172599.7090; train_global_loss: 29391080.4175; train_optim_loss: 29391080.4175; val_kl_reg_loss: 66764.2702; val_edge_recon_loss: 8287340.2828; val_gene_expr_recon_loss: 21115344.3689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173088.8125; val_global_loss: 29642536.9672; val_optim_loss: 29642536.9672
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9206; val_auprc_score: 0.9827; val_best_acc_score: 0.9161; val_best_f1_score: 0.9518; train_kl_reg_loss: 1244289371.7785; train_edge_recon_loss: 7914055.8794; train_gene_expr_recon_loss: 21136508.7483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173296.5435; train_global_loss: 1273513227.0589; train_optim_loss: 1273513227.0589; val_kl_reg_loss: 3174452.6978; val_edge_recon_loss: 8303654.0430; val_gene_expr_recon_loss: 21284110.7705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175620.8750; val_global_loss: 32937837.3607; val_optim_loss: 32937837.3607
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9257; val_auprc_score: 0.9835; val_best_acc_score: 0.9201; val_best_f1_score: 0.9542; train_kl_reg_loss: 159062361.8846; train_edge_recon_loss: 7923976.2259; train_gene_expr_recon_loss: 21063572.1599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171941.0892; train_global_loss: 188221850.4605; train_optim_loss: 188221850.4605; val_kl_reg_loss: 82126.6177; val_edge_recon_loss: 8285665.4590; val_gene_expr_recon_loss: 21084721.0574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174037.4844; val_global_loss: 29626551.1066; val_optim_loss: 29626551.1066
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9263; val_auprc_score: 0.9838; val_best_acc_score: 0.9202; val_best_f1_score: 0.9541; train_kl_reg_loss: 140511.3420; train_edge_recon_loss: 7926506.2640; train_gene_expr_recon_loss: 20966006.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172063.7166; train_global_loss: 29205087.5614; train_optim_loss: 29205087.5614; val_kl_reg_loss: 84958.1378; val_edge_recon_loss: 8305136.5041; val_gene_expr_recon_loss: 20946493.1311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172679.2500; val_global_loss: 29509267.7213; val_optim_loss: 29509267.7213
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9266; val_auprc_score: 0.9840; val_best_acc_score: 0.9216; val_best_f1_score: 0.9550; train_kl_reg_loss: 95044.3709; train_edge_recon_loss: 7927070.2812; train_gene_expr_recon_loss: 20904497.5678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172424.1160; train_global_loss: 29099036.3344; train_optim_loss: 29099036.3344; val_kl_reg_loss: 85106.1198; val_edge_recon_loss: 8201132.9406; val_gene_expr_recon_loss: 20911587.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171866.2344; val_global_loss: 29369692.8607; val_optim_loss: 29369692.8607
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9280; val_auprc_score: 0.9842; val_best_acc_score: 0.9220; val_best_f1_score: 0.9552; train_kl_reg_loss: 85484.0033; train_edge_recon_loss: 7896888.4929; train_gene_expr_recon_loss: 20848121.1329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172611.3714; train_global_loss: 29003105.0251; train_optim_loss: 29003105.0251; val_kl_reg_loss: 87356.8268; val_edge_recon_loss: 8280882.9693; val_gene_expr_recon_loss: 20856947.0410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172780.5469; val_global_loss: 29397966.7951; val_optim_loss: 29397966.7951
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8510; val_auprc_score: 0.9661; val_best_acc_score: 0.8864; val_best_f1_score: 0.9364; train_kl_reg_loss: 12687014544521186.0000; train_edge_recon_loss: 9521825.7823; train_gene_expr_recon_loss: 73763955.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 348024.5157; train_global_loss: 12687014628069036.0000; train_optim_loss: 12687014628069036.0000; val_kl_reg_loss: 650852.1416; val_edge_recon_loss: 9318672.9980; val_gene_expr_recon_loss: 46926223.1148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 212276.7188; val_global_loss: 57108024.2787; val_optim_loss: 57108024.2787
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9162; val_auprc_score: 0.9815; val_best_acc_score: 0.9130; val_best_f1_score: 0.9501; train_kl_reg_loss: 289132.0859; train_edge_recon_loss: 8303745.7716; train_gene_expr_recon_loss: 32096836.0238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175711.5071; train_global_loss: 40865425.4326; train_optim_loss: 40865425.4326; val_kl_reg_loss: 150540.1201; val_edge_recon_loss: 8260010.6189; val_gene_expr_recon_loss: 21609461.2951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164489.3438; val_global_loss: 30184502.0574; val_optim_loss: 30184502.0574
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9261; val_auprc_score: 0.9836; val_best_acc_score: 0.9197; val_best_f1_score: 0.9539; train_kl_reg_loss: 135238.2109; train_edge_recon_loss: 7953517.7903; train_gene_expr_recon_loss: 21366057.5651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166444.4761; train_global_loss: 29621258.0466; train_optim_loss: 29621258.0466; val_kl_reg_loss: 127451.6065; val_edge_recon_loss: 8313167.4529; val_gene_expr_recon_loss: 21054846.4180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167271.2031; val_global_loss: 29662737.4344; val_optim_loss: 29662737.4344

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9238; val_auprc_score: 0.9831; val_best_acc_score: 0.9204; val_best_f1_score: 0.9543; train_kl_reg_loss: 125778.8148; train_edge_recon_loss: 7923052.1514; train_gene_expr_recon_loss: 20866654.4404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109749.6412; train_global_loss: 29025235.0461; train_optim_loss: 29025235.0461; val_kl_reg_loss: 126107.9931; val_edge_recon_loss: 8267625.6148; val_gene_expr_recon_loss: 20865759.6148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107297.2266; val_global_loss: 29366791.1803; val_optim_loss: 29366791.1803
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9271; val_auprc_score: 0.9841; val_best_acc_score: 0.9207; val_best_f1_score: 0.9545; train_kl_reg_loss: 124561.1438; train_edge_recon_loss: 7924006.3248; train_gene_expr_recon_loss: 20797303.3495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106283.5214; train_global_loss: 28952154.3335; train_optim_loss: 28952154.3335; val_kl_reg_loss: 124007.7616; val_edge_recon_loss: 8294199.9447; val_gene_expr_recon_loss: 20803236.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105597.5859; val_global_loss: 29327042.5082; val_optim_loss: 29327042.5082
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9298; val_auprc_score: 0.9847; val_best_acc_score: 0.9215; val_best_f1_score: 0.9549; train_kl_reg_loss: 123545.6298; train_edge_recon_loss: 7914319.4628; train_gene_expr_recon_loss: 20740758.5418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104759.6500; train_global_loss: 28883383.2919; train_optim_loss: 28883383.2919; val_kl_reg_loss: 122880.6854; val_edge_recon_loss: 8277803.1270; val_gene_expr_recon_loss: 20765386.1885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104236.1719; val_global_loss: 29270306.0328; val_optim_loss: 29270306.0328
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9297; val_auprc_score: 0.9846; val_best_acc_score: 0.9219; val_best_f1_score: 0.9551; train_kl_reg_loss: 121812.2030; train_edge_recon_loss: 7900370.7746; train_gene_expr_recon_loss: 20695938.4111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103583.5207; train_global_loss: 28821704.9146; train_optim_loss: 28821704.9146; val_kl_reg_loss: 121555.8727; val_edge_recon_loss: 8279552.9098; val_gene_expr_recon_loss: 20722368.8197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103368.2812; val_global_loss: 29226845.6639; val_optim_loss: 29226845.6639
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9304; val_auprc_score: 0.9849; val_best_acc_score: 0.9221; val_best_f1_score: 0.9551; train_kl_reg_loss: 119703.8649; train_edge_recon_loss: 7888119.3609; train_gene_expr_recon_loss: 20657518.7766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102796.1002; train_global_loss: 28768138.1060; train_optim_loss: 28768138.1060; val_kl_reg_loss: 119298.4368; val_edge_recon_loss: 8278589.5574; val_gene_expr_recon_loss: 20685746.7623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102411.8203; val_global_loss: 29186046.7459; val_optim_loss: 29186046.7459
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9312; val_auprc_score: 0.9851; val_best_acc_score: 0.9229; val_best_f1_score: 0.9556; train_kl_reg_loss: 117685.2668; train_edge_recon_loss: 7904373.7862; train_gene_expr_recon_loss: 20620015.5889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102135.7612; train_global_loss: 28744210.4148; train_optim_loss: 28744210.4148; val_kl_reg_loss: 116912.8158; val_edge_recon_loss: 8211043.5758; val_gene_expr_recon_loss: 20690756.9262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101673.2500; val_global_loss: 29120387.2213; val_optim_loss: 29120387.2213
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9314; val_auprc_score: 0.9850; val_best_acc_score: 0.9241; val_best_f1_score: 0.9563; train_kl_reg_loss: 115772.7431; train_edge_recon_loss: 7910149.1640; train_gene_expr_recon_loss: 20609453.4673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101702.5298; train_global_loss: 28737077.9388; train_optim_loss: 28737077.9388; val_kl_reg_loss: 116011.1711; val_edge_recon_loss: 8230509.3566; val_gene_expr_recon_loss: 20661822.0246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101558.5312; val_global_loss: 29109900.5492; val_optim_loss: 29109900.5492
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9295; val_auprc_score: 0.9846; val_best_acc_score: 0.9230; val_best_f1_score: 0.9559; train_kl_reg_loss: 116030.7826; train_edge_recon_loss: 7912524.1222; train_gene_expr_recon_loss: 20572087.5130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101244.9548; train_global_loss: 28701887.3531; train_optim_loss: 28701887.3531; val_kl_reg_loss: 116705.0929; val_edge_recon_loss: 8189985.9303; val_gene_expr_recon_loss: 20623335.7951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101070.1797; val_global_loss: 29031096.8361; val_optim_loss: 29031096.8361
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9337; val_auprc_score: 0.9856; val_best_acc_score: 0.9249; val_best_f1_score: 0.9568; train_kl_reg_loss: 114462.4209; train_edge_recon_loss: 7919083.5934; train_gene_expr_recon_loss: 20562379.5605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100967.3065; train_global_loss: 28696892.8698; train_optim_loss: 28696892.8698; val_kl_reg_loss: 113076.8475; val_edge_recon_loss: 8177462.1619; val_gene_expr_recon_loss: 20605076.2623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100804.6250; val_global_loss: 28996419.2951; val_optim_loss: 28996419.2951
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9318; val_auprc_score: 0.9851; val_best_acc_score: 0.9237; val_best_f1_score: 0.9561; train_kl_reg_loss: 112878.9187; train_edge_recon_loss: 7928524.5861; train_gene_expr_recon_loss: 20537546.9529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100651.4549; train_global_loss: 28679601.9324; train_optim_loss: 28679601.9324; val_kl_reg_loss: 112185.7767; val_edge_recon_loss: 8249127.0676; val_gene_expr_recon_loss: 20580806.8115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100680.8594; val_global_loss: 29042799.6393; val_optim_loss: 29042799.6393
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9311; val_auprc_score: 0.9851; val_best_acc_score: 0.9229; val_best_f1_score: 0.9557; train_kl_reg_loss: 111038.2644; train_edge_recon_loss: 7884258.5059; train_gene_expr_recon_loss: 20518886.0594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100413.8964; train_global_loss: 28614596.7063; train_optim_loss: 28614596.7063; val_kl_reg_loss: 110866.6235; val_edge_recon_loss: 8228622.5553; val_gene_expr_recon_loss: 20587230.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100339.9766; val_global_loss: 29027059.3361; val_optim_loss: 29027059.3361
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9309; val_auprc_score: 0.9846; val_best_acc_score: 0.9234; val_best_f1_score: 0.9559; train_kl_reg_loss: 111298.3380; train_edge_recon_loss: 7961133.3691; train_gene_expr_recon_loss: 21130939.9973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102464.7555; train_global_loss: 29305836.4276; train_optim_loss: 29305836.4276; val_kl_reg_loss: 67179.1385; val_edge_recon_loss: 8350467.7746; val_gene_expr_recon_loss: 21100524.0574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97764.4766; val_global_loss: 29615934.9918; val_optim_loss: 29615934.9918
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9326; val_auprc_score: 0.9851; val_best_acc_score: 0.9237; val_best_f1_score: 0.9562; train_kl_reg_loss: 108888.4126; train_edge_recon_loss: 7919117.4936; train_gene_expr_recon_loss: 21005445.6619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94213.9836; train_global_loss: 29127665.5404; train_optim_loss: 29127665.5404; val_kl_reg_loss: 68715.0315; val_edge_recon_loss: 8316308.7623; val_gene_expr_recon_loss: 21043413.6311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90817.8438; val_global_loss: 29519255.4754; val_optim_loss: 29519255.4754

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9314; val_auprc_score: 0.9850; val_best_acc_score: 0.9242; val_best_f1_score: 0.9564; train_kl_reg_loss: 105858.4739; train_edge_recon_loss: 7921237.8771; train_gene_expr_recon_loss: 20946866.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85682.6219; train_global_loss: 29059645.3869; train_optim_loss: 29059645.3869; val_kl_reg_loss: 68494.0431; val_edge_recon_loss: 8263502.8504; val_gene_expr_recon_loss: 21012768.0410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84610.2031; val_global_loss: 29429374.8770; val_optim_loss: 29429374.8770
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9314; val_auprc_score: 0.9850; val_best_acc_score: 0.9243; val_best_f1_score: 0.9565; train_kl_reg_loss: 105014.4200; train_edge_recon_loss: 7922496.3102; train_gene_expr_recon_loss: 20941873.7113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83976.2554; train_global_loss: 29053360.6761; train_optim_loss: 29053360.6761; val_kl_reg_loss: 68616.8684; val_edge_recon_loss: 8289174.4898; val_gene_expr_recon_loss: 21012796.8770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83382.8906; val_global_loss: 29453970.3197; val_optim_loss: 29453970.3197
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9317; val_auprc_score: 0.9849; val_best_acc_score: 0.9246; val_best_f1_score: 0.9568; train_kl_reg_loss: 103928.8587; train_edge_recon_loss: 7925073.2565; train_gene_expr_recon_loss: 20939465.5203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82864.0873; train_global_loss: 29051331.7149; train_optim_loss: 29051331.7149; val_kl_reg_loss: 68696.2347; val_edge_recon_loss: 8232614.5902; val_gene_expr_recon_loss: 20994034.0164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82333.4688; val_global_loss: 29377678.8197; val_optim_loss: 29377678.8197
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9317; val_auprc_score: 0.9852; val_best_acc_score: 0.9245; val_best_f1_score: 0.9566; train_kl_reg_loss: 102735.7786; train_edge_recon_loss: 7921072.6398; train_gene_expr_recon_loss: 20928813.4061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81859.0215; train_global_loss: 29034480.8387; train_optim_loss: 29034480.8387; val_kl_reg_loss: 68812.8860; val_edge_recon_loss: 8231469.7602; val_gene_expr_recon_loss: 21015590.1803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81411.4688; val_global_loss: 29397284.8525; val_optim_loss: 29397284.8525

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 304 min 19 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9299
val AUPRC score: 0.9845
val best accuracy score: 0.9234
val best F1 score: 0.9560
val target rna MSE score: 1.5411
val source rna MSE score: 0.4358
Val cat covariate0 mean sim diff: -0.0009
Val cat covariate1 mean sim diff: -0.0487
Val cat covariate2 mean sim diff: -0.0009

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
