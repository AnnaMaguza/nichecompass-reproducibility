[True]
Run timestamp: 26072023_223511_64.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_64']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8766; val_auprc_score: 0.9745; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 348683.7261; train_edge_recon_loss: 1172261.8924; train_gene_expr_recon_loss: 3575742.8099; train_masked_gp_l1_reg_loss: 7291.7096; train_group_lasso_reg_loss: 0.0000; train_global_loss: 5103980.1558; train_optim_loss: 5103980.1558; val_kl_reg_loss: 317744.1432; val_edge_recon_loss: 1200231.0182; val_gene_expr_recon_loss: 2901338.9792; val_masked_gp_l1_reg_loss: 7776.8628; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4427091.1458; val_optim_loss: 4427091.1458
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8646; val_auprc_score: 0.9737; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 353200.3967; train_edge_recon_loss: 1161121.3701; train_gene_expr_recon_loss: 5018919.8663; train_masked_gp_l1_reg_loss: 7962.6597; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6541204.3151; train_optim_loss: 6541204.3151; val_kl_reg_loss: 220143.2891; val_edge_recon_loss: 1185058.5781; val_gene_expr_recon_loss: 3105612.1146; val_masked_gp_l1_reg_loss: 8055.9053; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4518869.9583; val_optim_loss: 4518869.9583
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8658; val_auprc_score: 0.9740; val_best_acc_score: 0.8568; val_best_f1_score: 0.9229; train_kl_reg_loss: 230909.3531; train_edge_recon_loss: 1171646.3695; train_gene_expr_recon_loss: 3374403.3523; train_masked_gp_l1_reg_loss: 8196.0287; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4785155.1047; train_optim_loss: 4785155.1047; val_kl_reg_loss: 182890.1439; val_edge_recon_loss: 1163043.5469; val_gene_expr_recon_loss: 2636009.4062; val_masked_gp_l1_reg_loss: 8355.2949; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3990298.3229; val_optim_loss: 3990298.3229
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8708; val_auprc_score: 0.9754; val_best_acc_score: 0.8604; val_best_f1_score: 0.9244; train_kl_reg_loss: 106207.9172; train_edge_recon_loss: 1121467.4860; train_gene_expr_recon_loss: 2492723.7006; train_masked_gp_l1_reg_loss: 8744.9585; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3729144.0512; train_optim_loss: 3729144.0512; val_kl_reg_loss: 66986.1045; val_edge_recon_loss: 1183932.2708; val_gene_expr_recon_loss: 1635601.0729; val_masked_gp_l1_reg_loss: 9238.4287; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2895757.9896; val_optim_loss: 2895757.9896
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8480; val_auprc_score: 0.9697; val_best_acc_score: 0.8632; val_best_f1_score: 0.9243; train_kl_reg_loss: 57207.5092; train_edge_recon_loss: 1084810.3680; train_gene_expr_recon_loss: 1453287.8209; train_masked_gp_l1_reg_loss: 9686.5181; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2604992.2256; train_optim_loss: 2604992.2256; val_kl_reg_loss: 45240.0304; val_edge_recon_loss: 1189607.1693; val_gene_expr_recon_loss: 1331400.9635; val_masked_gp_l1_reg_loss: 10100.3086; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2576348.4271; val_optim_loss: 2576348.4271
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8424; val_auprc_score: 0.9658; val_best_acc_score: 0.8641; val_best_f1_score: 0.9249; train_kl_reg_loss: 47708.4278; train_edge_recon_loss: 1063952.5642; train_gene_expr_recon_loss: 1283487.3866; train_masked_gp_l1_reg_loss: 10188.1688; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2405336.5640; train_optim_loss: 2405336.5640; val_kl_reg_loss: 40120.0124; val_edge_recon_loss: 1205495.9531; val_gene_expr_recon_loss: 1245352.3854; val_masked_gp_l1_reg_loss: 10266.7207; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2501235.0938; val_optim_loss: 2501235.0938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8521; val_auprc_score: 0.9649; val_best_acc_score: 0.8782; val_best_f1_score: 0.9319; train_kl_reg_loss: 35637.9724; train_edge_recon_loss: 1046167.1701; train_gene_expr_recon_loss: 1071352.7968; train_masked_gp_l1_reg_loss: 10524.3324; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2163682.2634; train_optim_loss: 2163682.2634; val_kl_reg_loss: 30472.9944; val_edge_recon_loss: 1132562.5365; val_gene_expr_recon_loss: 990140.3568; val_masked_gp_l1_reg_loss: 10734.4102; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2163910.3438; val_optim_loss: 2163910.3438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8462; val_auprc_score: 0.9651; val_best_acc_score: 0.8868; val_best_f1_score: 0.9368; train_kl_reg_loss: 31429.8741; train_edge_recon_loss: 981900.2230; train_gene_expr_recon_loss: 976481.2628; train_masked_gp_l1_reg_loss: 10863.1408; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2000674.5047; train_optim_loss: 2000674.5047; val_kl_reg_loss: 33859.5946; val_edge_recon_loss: 941904.4766; val_gene_expr_recon_loss: 963191.4036; val_masked_gp_l1_reg_loss: 10985.4736; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1949940.9792; val_optim_loss: 1949940.9792
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8425; val_auprc_score: 0.9656; val_best_acc_score: 0.8917; val_best_f1_score: 0.9396; train_kl_reg_loss: 37738.9963; train_edge_recon_loss: 926943.1703; train_gene_expr_recon_loss: 953530.3645; train_masked_gp_l1_reg_loss: 11110.6723; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1929323.2029; train_optim_loss: 1929323.2029; val_kl_reg_loss: 36944.3963; val_edge_recon_loss: 890305.2161; val_gene_expr_recon_loss: 945107.3385; val_masked_gp_l1_reg_loss: 11228.8047; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1883585.6927; val_optim_loss: 1883585.6927
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8403; val_auprc_score: 0.9641; val_best_acc_score: 0.8957; val_best_f1_score: 0.9416; train_kl_reg_loss: 36432.6420; train_edge_recon_loss: 907821.4971; train_gene_expr_recon_loss: 936829.1828; train_masked_gp_l1_reg_loss: 11321.7995; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1892405.1233; train_optim_loss: 1892405.1233; val_kl_reg_loss: 32164.1143; val_edge_recon_loss: 909340.3438; val_gene_expr_recon_loss: 928939.8568; val_masked_gp_l1_reg_loss: 11413.6230; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1881857.9427; val_optim_loss: 1881857.9427
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8387; val_auprc_score: 0.9637; val_best_acc_score: 0.8985; val_best_f1_score: 0.9434; train_kl_reg_loss: 31051.2474; train_edge_recon_loss: 881841.9209; train_gene_expr_recon_loss: 916803.9692; train_masked_gp_l1_reg_loss: 11483.4129; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1841180.5483; train_optim_loss: 1841180.5483; val_kl_reg_loss: 28210.1820; val_edge_recon_loss: 890576.9115; val_gene_expr_recon_loss: 905876.2292; val_masked_gp_l1_reg_loss: 11535.8779; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1836199.1979; val_optim_loss: 1836199.1979
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8506; val_auprc_score: 0.9653; val_best_acc_score: 0.9027; val_best_f1_score: 0.9456; train_kl_reg_loss: 27710.9212; train_edge_recon_loss: 870518.4776; train_gene_expr_recon_loss: 895966.0500; train_masked_gp_l1_reg_loss: 11536.9107; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1805732.3634; train_optim_loss: 1805732.3634; val_kl_reg_loss: 24827.6456; val_edge_recon_loss: 871638.3125; val_gene_expr_recon_loss: 889872.1432; val_masked_gp_l1_reg_loss: 11521.4307; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1797859.4896; val_optim_loss: 1797859.4896
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8593; val_auprc_score: 0.9685; val_best_acc_score: 0.9066; val_best_f1_score: 0.9475; train_kl_reg_loss: 24164.6188; train_edge_recon_loss: 850610.7375; train_gene_expr_recon_loss: 882531.2631; train_masked_gp_l1_reg_loss: 11485.8761; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1768792.4895; train_optim_loss: 1768792.4895; val_kl_reg_loss: 21205.6481; val_edge_recon_loss: 859024.8255; val_gene_expr_recon_loss: 878210.7396; val_masked_gp_l1_reg_loss: 11441.5967; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1769882.8438; val_optim_loss: 1769882.8438
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8685; val_auprc_score: 0.9707; val_best_acc_score: 0.9091; val_best_f1_score: 0.9487; train_kl_reg_loss: 22140.9105; train_edge_recon_loss: 839199.1797; train_gene_expr_recon_loss: 870308.5108; train_masked_gp_l1_reg_loss: 11374.7010; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1743023.3029; train_optim_loss: 1743023.3029; val_kl_reg_loss: 21182.4043; val_edge_recon_loss: 838859.9948; val_gene_expr_recon_loss: 865699.9479; val_masked_gp_l1_reg_loss: 11290.5918; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1737032.9740; val_optim_loss: 1737032.9740
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8733; val_auprc_score: 0.9697; val_best_acc_score: 0.9103; val_best_f1_score: 0.9494; train_kl_reg_loss: 20144.6203; train_edge_recon_loss: 833643.8933; train_gene_expr_recon_loss: 858715.4526; train_masked_gp_l1_reg_loss: 11185.7682; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1723689.7378; train_optim_loss: 1723689.7378; val_kl_reg_loss: 18576.7131; val_edge_recon_loss: 853042.3255; val_gene_expr_recon_loss: 854839.2031; val_masked_gp_l1_reg_loss: 11065.3711; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1737523.6042; val_optim_loss: 1737523.6042
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8855; val_auprc_score: 0.9733; val_best_acc_score: 0.9091; val_best_f1_score: 0.9483; train_kl_reg_loss: 18340.9763; train_edge_recon_loss: 823885.7901; train_gene_expr_recon_loss: 847871.2317; train_masked_gp_l1_reg_loss: 10929.3775; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1701027.3785; train_optim_loss: 1701027.3785; val_kl_reg_loss: 16463.1419; val_edge_recon_loss: 855229.8906; val_gene_expr_recon_loss: 844443.9505; val_masked_gp_l1_reg_loss: 10781.3760; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1726918.3594; val_optim_loss: 1726918.3594
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8918; val_auprc_score: 0.9763; val_best_acc_score: 0.9101; val_best_f1_score: 0.9491; train_kl_reg_loss: 16200.1069; train_edge_recon_loss: 819515.6791; train_gene_expr_recon_loss: 837806.1703; train_masked_gp_l1_reg_loss: 10626.8837; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1684148.8355; train_optim_loss: 1684148.8355; val_kl_reg_loss: 15726.1960; val_edge_recon_loss: 824667.1667; val_gene_expr_recon_loss: 833397.8281; val_masked_gp_l1_reg_loss: 10470.2539; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1684261.4427; val_optim_loss: 1684261.4427
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9119; val_auprc_score: 0.9814; val_best_acc_score: 0.9180; val_best_f1_score: 0.9533; train_kl_reg_loss: 14630.1921; train_edge_recon_loss: 814108.7395; train_gene_expr_recon_loss: 828818.9451; train_masked_gp_l1_reg_loss: 10307.4519; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1667865.3326; train_optim_loss: 1667865.3326; val_kl_reg_loss: 13366.5031; val_edge_recon_loss: 784420.1302; val_gene_expr_recon_loss: 825484.3177; val_masked_gp_l1_reg_loss: 10145.5098; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1633416.4635; val_optim_loss: 1633416.4635
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9172; val_auprc_score: 0.9813; val_best_acc_score: 0.9159; val_best_f1_score: 0.9518; train_kl_reg_loss: 13325.2166; train_edge_recon_loss: 811850.8849; train_gene_expr_recon_loss: 820127.5390; train_masked_gp_l1_reg_loss: 9988.9641; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1655292.6064; train_optim_loss: 1655292.6064; val_kl_reg_loss: 12307.3635; val_edge_recon_loss: 846389.1354; val_gene_expr_recon_loss: 817441.9922; val_masked_gp_l1_reg_loss: 9833.6777; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1685972.0885; val_optim_loss: 1685972.0885
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9283; val_auprc_score: 0.9849; val_best_acc_score: 0.9202; val_best_f1_score: 0.9542; train_kl_reg_loss: 12039.5032; train_edge_recon_loss: 809850.6328; train_gene_expr_recon_loss: 812466.6110; train_masked_gp_l1_reg_loss: 9697.0354; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1644053.7831; train_optim_loss: 1644053.7831; val_kl_reg_loss: 10928.7694; val_edge_recon_loss: 804806.5104; val_gene_expr_recon_loss: 810378.1198; val_masked_gp_l1_reg_loss: 9560.8633; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1635674.2812; val_optim_loss: 1635674.2812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9347; val_auprc_score: 0.9856; val_best_acc_score: 0.9299; val_best_f1_score: 0.9599; train_kl_reg_loss: 11982.1932; train_edge_recon_loss: 788263.4924; train_gene_expr_recon_loss: 804791.9169; train_masked_gp_l1_reg_loss: 9423.8173; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1614461.4151; train_optim_loss: 1614461.4151; val_kl_reg_loss: 12096.6163; val_edge_recon_loss: 771854.6693; val_gene_expr_recon_loss: 802698.2005; val_masked_gp_l1_reg_loss: 9289.4844; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1595938.9896; val_optim_loss: 1595938.9896
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9295; val_auprc_score: 0.9844; val_best_acc_score: 0.9255; val_best_f1_score: 0.9570; train_kl_reg_loss: 12079.0041; train_edge_recon_loss: 797528.8131; train_gene_expr_recon_loss: 797790.9573; train_masked_gp_l1_reg_loss: 9162.8535; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1616561.6233; train_optim_loss: 1616561.6233; val_kl_reg_loss: 11085.8031; val_edge_recon_loss: 808861.6901; val_gene_expr_recon_loss: 796430.6745; val_masked_gp_l1_reg_loss: 9028.8271; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1625407.0365; val_optim_loss: 1625407.0365
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9411; val_auprc_score: 0.9874; val_best_acc_score: 0.9302; val_best_f1_score: 0.9597; train_kl_reg_loss: 12053.2396; train_edge_recon_loss: 788820.0131; train_gene_expr_recon_loss: 790814.6779; train_masked_gp_l1_reg_loss: 8913.2575; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1600601.1843; train_optim_loss: 1600601.1843; val_kl_reg_loss: 11683.1377; val_edge_recon_loss: 776603.8828; val_gene_expr_recon_loss: 789606.3906; val_masked_gp_l1_reg_loss: 8799.4375; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1586692.8750; val_optim_loss: 1586692.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9366; val_auprc_score: 0.9854; val_best_acc_score: 0.9288; val_best_f1_score: 0.9587; train_kl_reg_loss: 11949.8432; train_edge_recon_loss: 781485.5985; train_gene_expr_recon_loss: 784198.1055; train_masked_gp_l1_reg_loss: 8684.9073; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1586318.4599; train_optim_loss: 1586318.4599; val_kl_reg_loss: 11346.7878; val_edge_recon_loss: 809820.8880; val_gene_expr_recon_loss: 782961.2943; val_masked_gp_l1_reg_loss: 8565.6953; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1612694.7240; val_optim_loss: 1612694.7240
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9437; val_auprc_score: 0.9869; val_best_acc_score: 0.9329; val_best_f1_score: 0.9610; train_kl_reg_loss: 11777.4541; train_edge_recon_loss: 781731.3105; train_gene_expr_recon_loss: 778151.1241; train_masked_gp_l1_reg_loss: 8453.8344; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1580113.7169; train_optim_loss: 1580113.7169; val_kl_reg_loss: 11788.2714; val_edge_recon_loss: 809073.1276; val_gene_expr_recon_loss: 775766.9219; val_masked_gp_l1_reg_loss: 8339.5547; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1604967.8333; val_optim_loss: 1604967.8333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9440; val_auprc_score: 0.9878; val_best_acc_score: 0.9289; val_best_f1_score: 0.9588; train_kl_reg_loss: 11272.8518; train_edge_recon_loss: 774942.7878; train_gene_expr_recon_loss: 773548.7884; train_masked_gp_l1_reg_loss: 8254.3322; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1568018.7628; train_optim_loss: 1568018.7628; val_kl_reg_loss: 7211.8187; val_edge_recon_loss: 795913.0026; val_gene_expr_recon_loss: 772796.9271; val_masked_gp_l1_reg_loss: 8169.6729; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1584091.3698; val_optim_loss: 1584091.3698
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9460; val_auprc_score: 0.9863; val_best_acc_score: 0.9364; val_best_f1_score: 0.9633; train_kl_reg_loss: 10246.5993; train_edge_recon_loss: 781597.0535; train_gene_expr_recon_loss: 767647.1483; train_masked_gp_l1_reg_loss: 8075.3855; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1567566.1849; train_optim_loss: 1567566.1849; val_kl_reg_loss: 6936.6575; val_edge_recon_loss: 788727.0990; val_gene_expr_recon_loss: 767100.5391; val_masked_gp_l1_reg_loss: 7985.0527; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1570749.2969; val_optim_loss: 1570749.2969
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9432; val_auprc_score: 0.9869; val_best_acc_score: 0.9354; val_best_f1_score: 0.9626; train_kl_reg_loss: 9583.9604; train_edge_recon_loss: 775210.9375; train_gene_expr_recon_loss: 761745.8814; train_masked_gp_l1_reg_loss: 7909.7401; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1554450.5244; train_optim_loss: 1554450.5244; val_kl_reg_loss: 6428.8981; val_edge_recon_loss: 793914.5677; val_gene_expr_recon_loss: 761316.3073; val_masked_gp_l1_reg_loss: 7838.5645; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1569498.3802; val_optim_loss: 1569498.3802
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9493; val_auprc_score: 0.9890; val_best_acc_score: 0.9410; val_best_f1_score: 0.9660; train_kl_reg_loss: 9324.1282; train_edge_recon_loss: 781591.4140; train_gene_expr_recon_loss: 756753.5840; train_masked_gp_l1_reg_loss: 7764.5020; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1555433.6366; train_optim_loss: 1555433.6366; val_kl_reg_loss: 6494.8940; val_edge_recon_loss: 759509.1693; val_gene_expr_recon_loss: 756070.2474; val_masked_gp_l1_reg_loss: 7685.8696; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1529760.1927; val_optim_loss: 1529760.1927
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9457; val_auprc_score: 0.9874; val_best_acc_score: 0.9400; val_best_f1_score: 0.9653; train_kl_reg_loss: 9011.9732; train_edge_recon_loss: 770608.3712; train_gene_expr_recon_loss: 751600.1430; train_masked_gp_l1_reg_loss: 7593.1641; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1538813.6581; train_optim_loss: 1538813.6581; val_kl_reg_loss: 6419.8204; val_edge_recon_loss: 783599.2734; val_gene_expr_recon_loss: 751401.6953; val_masked_gp_l1_reg_loss: 7513.9590; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1548934.7760; val_optim_loss: 1548934.7760
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9519; val_auprc_score: 0.9893; val_best_acc_score: 0.9414; val_best_f1_score: 0.9661; train_kl_reg_loss: 8686.3615; train_edge_recon_loss: 765877.8852; train_gene_expr_recon_loss: 746810.8724; train_masked_gp_l1_reg_loss: 7444.4438; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1528819.5657; train_optim_loss: 1528819.5657; val_kl_reg_loss: 6366.5248; val_edge_recon_loss: 790935.5234; val_gene_expr_recon_loss: 746403.0625; val_masked_gp_l1_reg_loss: 7367.6025; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1551072.7500; val_optim_loss: 1551072.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9480; val_auprc_score: 0.9874; val_best_acc_score: 0.9444; val_best_f1_score: 0.9678; train_kl_reg_loss: 8377.2093; train_edge_recon_loss: 774832.8224; train_gene_expr_recon_loss: 742610.2788; train_masked_gp_l1_reg_loss: 7301.6125; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1533121.9238; train_optim_loss: 1533121.9238; val_kl_reg_loss: 6452.9439; val_edge_recon_loss: 791454.2057; val_gene_expr_recon_loss: 742115.4818; val_masked_gp_l1_reg_loss: 7233.7812; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1547256.3802; val_optim_loss: 1547256.3802
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9493; val_auprc_score: 0.9876; val_best_acc_score: 0.9437; val_best_f1_score: 0.9673; train_kl_reg_loss: 8414.6750; train_edge_recon_loss: 766662.5916; train_gene_expr_recon_loss: 738454.8256; train_masked_gp_l1_reg_loss: 7163.3742; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1520695.4628; train_optim_loss: 1520695.4628; val_kl_reg_loss: 6777.4855; val_edge_recon_loss: 797378.1042; val_gene_expr_recon_loss: 738284.7917; val_masked_gp_l1_reg_loss: 7100.3555; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1549540.7552; val_optim_loss: 1549540.7552

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9509; val_auprc_score: 0.9882; val_best_acc_score: 0.9438; val_best_f1_score: 0.9675; train_kl_reg_loss: 8359.1784; train_edge_recon_loss: 764012.4811; train_gene_expr_recon_loss: 735385.1262; train_masked_gp_l1_reg_loss: 7068.6715; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1514825.4599; train_optim_loss: 1514825.4599; val_kl_reg_loss: 6487.7370; val_edge_recon_loss: 798657.5625; val_gene_expr_recon_loss: 737766.8411; val_masked_gp_l1_reg_loss: 7057.4639; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1549969.6354; val_optim_loss: 1549969.6354
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9531; val_auprc_score: 0.9894; val_best_acc_score: 0.9458; val_best_f1_score: 0.9688; train_kl_reg_loss: 8213.0986; train_edge_recon_loss: 765161.6500; train_gene_expr_recon_loss: 735091.7930; train_masked_gp_l1_reg_loss: 7053.6883; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1515520.2221; train_optim_loss: 1515520.2221; val_kl_reg_loss: 6487.9868; val_edge_recon_loss: 771948.3906; val_gene_expr_recon_loss: 736099.5182; val_masked_gp_l1_reg_loss: 7047.8364; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1521583.7708; val_optim_loss: 1521583.7708
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9533; val_auprc_score: 0.9891; val_best_acc_score: 0.9446; val_best_f1_score: 0.9680; train_kl_reg_loss: 8161.4026; train_edge_recon_loss: 766537.6509; train_gene_expr_recon_loss: 734433.8483; train_masked_gp_l1_reg_loss: 7042.9269; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1516175.8291; train_optim_loss: 1516175.8291; val_kl_reg_loss: 6464.3139; val_edge_recon_loss: 777598.1823; val_gene_expr_recon_loss: 736675.6068; val_masked_gp_l1_reg_loss: 7038.8965; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1527776.9688; val_optim_loss: 1527776.9688
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9538; val_auprc_score: 0.9896; val_best_acc_score: 0.9472; val_best_f1_score: 0.9696; train_kl_reg_loss: 8053.1563; train_edge_recon_loss: 774014.1302; train_gene_expr_recon_loss: 733855.6663; train_masked_gp_l1_reg_loss: 7033.6304; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1522956.5872; train_optim_loss: 1522956.5872; val_kl_reg_loss: 6386.8121; val_edge_recon_loss: 760180.4271; val_gene_expr_recon_loss: 736065.4089; val_masked_gp_l1_reg_loss: 7027.4521; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1509660.1458; val_optim_loss: 1509660.1458
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9533; val_auprc_score: 0.9889; val_best_acc_score: 0.9486; val_best_f1_score: 0.9704; train_kl_reg_loss: 8057.0588; train_edge_recon_loss: 772263.5253; train_gene_expr_recon_loss: 733413.2765; train_masked_gp_l1_reg_loss: 7021.5114; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1520755.3703; train_optim_loss: 1520755.3703; val_kl_reg_loss: 6379.0318; val_edge_recon_loss: 751556.8698; val_gene_expr_recon_loss: 735492.4557; val_masked_gp_l1_reg_loss: 7016.1060; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1500444.4844; val_optim_loss: 1500444.4844
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9550; val_auprc_score: 0.9893; val_best_acc_score: 0.9447; val_best_f1_score: 0.9680; train_kl_reg_loss: 7952.2079; train_edge_recon_loss: 771595.7433; train_gene_expr_recon_loss: 733107.5567; train_masked_gp_l1_reg_loss: 7007.9478; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1519663.4564; train_optim_loss: 1519663.4564; val_kl_reg_loss: 6355.1194; val_edge_recon_loss: 801553.2292; val_gene_expr_recon_loss: 734719.3047; val_masked_gp_l1_reg_loss: 7005.2227; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1549632.9271; val_optim_loss: 1549632.9271
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9489; val_auprc_score: 0.9872; val_best_acc_score: 0.9461; val_best_f1_score: 0.9687; train_kl_reg_loss: 7817.3854; train_edge_recon_loss: 770521.0023; train_gene_expr_recon_loss: 732614.6616; train_masked_gp_l1_reg_loss: 6998.5106; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1517951.5605; train_optim_loss: 1517951.5605; val_kl_reg_loss: 6378.4873; val_edge_recon_loss: 799206.1484; val_gene_expr_recon_loss: 734033.8255; val_masked_gp_l1_reg_loss: 6993.0762; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1546611.5729; val_optim_loss: 1546611.5729
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9538; val_auprc_score: 0.9889; val_best_acc_score: 0.9484; val_best_f1_score: 0.9701; train_kl_reg_loss: 7788.2328; train_edge_recon_loss: 764167.4799; train_gene_expr_recon_loss: 732198.3471; train_masked_gp_l1_reg_loss: 6984.0084; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1511138.0576; train_optim_loss: 1511138.0576; val_kl_reg_loss: 6320.2225; val_edge_recon_loss: 784569.7969; val_gene_expr_recon_loss: 734066.7917; val_masked_gp_l1_reg_loss: 6974.0044; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1531930.8073; val_optim_loss: 1531930.8073
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9550; val_auprc_score: 0.9894; val_best_acc_score: 0.9498; val_best_f1_score: 0.9710; train_kl_reg_loss: 7736.3577; train_edge_recon_loss: 771422.5922; train_gene_expr_recon_loss: 731477.2756; train_masked_gp_l1_reg_loss: 6961.7292; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1517597.9541; train_optim_loss: 1517597.9541; val_kl_reg_loss: 6292.7276; val_edge_recon_loss: 772726.1823; val_gene_expr_recon_loss: 733378.1146; val_masked_gp_l1_reg_loss: 6947.2842; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1519344.2760; val_optim_loss: 1519344.2760

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9562; val_auprc_score: 0.9901; val_best_acc_score: 0.9463; val_best_f1_score: 0.9691; train_kl_reg_loss: 7722.1904; train_edge_recon_loss: 769085.2930; train_gene_expr_recon_loss: 731147.0648; train_masked_gp_l1_reg_loss: 6942.8111; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1514897.3669; train_optim_loss: 1514897.3669; val_kl_reg_loss: 6315.9869; val_edge_recon_loss: 777504.4271; val_gene_expr_recon_loss: 733440.9453; val_masked_gp_l1_reg_loss: 6940.4126; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1524201.7292; val_optim_loss: 1524201.7292
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9497; val_auprc_score: 0.9881; val_best_acc_score: 0.9453; val_best_f1_score: 0.9684; train_kl_reg_loss: 7698.7009; train_edge_recon_loss: 770740.6942; train_gene_expr_recon_loss: 730870.3195; train_masked_gp_l1_reg_loss: 6938.9513; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1516248.6622; train_optim_loss: 1516248.6622; val_kl_reg_loss: 6305.5913; val_edge_recon_loss: 785178.5130; val_gene_expr_recon_loss: 733485.8307; val_masked_gp_l1_reg_loss: 6937.1279; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1531907.0573; val_optim_loss: 1531907.0573
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9522; val_auprc_score: 0.9884; val_best_acc_score: 0.9479; val_best_f1_score: 0.9699; train_kl_reg_loss: 7698.3284; train_edge_recon_loss: 763440.6292; train_gene_expr_recon_loss: 730951.4741; train_masked_gp_l1_reg_loss: 6935.8659; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1509026.3047; train_optim_loss: 1509026.3047; val_kl_reg_loss: 6310.0092; val_edge_recon_loss: 777981.9635; val_gene_expr_recon_loss: 733832.7109; val_masked_gp_l1_reg_loss: 6934.3364; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1525059.0417; val_optim_loss: 1525059.0417
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9571; val_auprc_score: 0.9903; val_best_acc_score: 0.9481; val_best_f1_score: 0.9700; train_kl_reg_loss: 7714.6836; train_edge_recon_loss: 762538.4189; train_gene_expr_recon_loss: 730775.4593; train_masked_gp_l1_reg_loss: 6932.2027; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1507960.7657; train_optim_loss: 1507960.7657; val_kl_reg_loss: 6334.1167; val_edge_recon_loss: 769676.7682; val_gene_expr_recon_loss: 733509.1276; val_masked_gp_l1_reg_loss: 6930.0400; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1516450.0208; val_optim_loss: 1516450.0208

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 57 min 4 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9576
Val AUPRC score: 0.9899
Val best accuracy score: 0.9462
Val best F1 score: 0.9687
Val gene expr MSE score: 75969.4259
Val cat covariate0 mean sim diff: 0.0007

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
