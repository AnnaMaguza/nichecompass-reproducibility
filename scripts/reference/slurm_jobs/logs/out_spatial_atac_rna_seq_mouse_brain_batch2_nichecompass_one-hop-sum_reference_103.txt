[True]
Run timestamp: 10082023_234335_103.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_103']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7641; val_auprc_score: 0.7896; val_best_acc_score: 0.5662; val_best_f1_score: 0.6882; train_kl_reg_loss: 319498.1848; train_edge_recon_loss: 3972119.9237; train_gene_expr_recon_loss: 49088462.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 130868140.8855; train_global_loss: 184248222.4122; train_optim_loss: 184248222.4122; val_kl_reg_loss: 195856.5042; val_edge_recon_loss: 4060751.7833; val_gene_expr_recon_loss: 39741660.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 116409267.7333; val_global_loss: 160407538.1333; val_optim_loss: 160407538.1333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7772; val_auprc_score: 0.8021; val_best_acc_score: 0.6289; val_best_f1_score: 0.7096; train_kl_reg_loss: 187222.7779; train_edge_recon_loss: 3965810.2061; train_gene_expr_recon_loss: 39597645.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 116570862.0458; train_global_loss: 160321540.2748; train_optim_loss: 160321540.2748; val_kl_reg_loss: 196962.7500; val_edge_recon_loss: 4055688.1667; val_gene_expr_recon_loss: 37807670.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 114485720.5333; val_global_loss: 156546041.6000; val_optim_loss: 156546041.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7981; val_auprc_score: 0.8076; val_best_acc_score: 0.6900; val_best_f1_score: 0.7396; train_kl_reg_loss: 206448.9032; train_edge_recon_loss: 3707800.3130; train_gene_expr_recon_loss: 37745610.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 115023971.2977; train_global_loss: 156683831.5725; train_optim_loss: 156683831.5725; val_kl_reg_loss: 221722.3542; val_edge_recon_loss: 3977022.7667; val_gene_expr_recon_loss: 37303736.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 114330461.8667; val_global_loss: 155832942.9333; val_optim_loss: 155832942.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8662; val_auprc_score: 0.8607; val_best_acc_score: 0.7792; val_best_f1_score: 0.7951; train_kl_reg_loss: 197384.3749; train_edge_recon_loss: 3538612.2824; train_gene_expr_recon_loss: 36997092.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 114166295.3282; train_global_loss: 154899385.1603; train_optim_loss: 154899385.1603; val_kl_reg_loss: 165500.2969; val_edge_recon_loss: 3552688.1333; val_gene_expr_recon_loss: 36717185.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112899061.8667; val_global_loss: 153334437.3333; val_optim_loss: 153334437.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8721; val_auprc_score: 0.8577; val_best_acc_score: 0.7936; val_best_f1_score: 0.8086; train_kl_reg_loss: 206515.4073; train_edge_recon_loss: 3217357.3645; train_gene_expr_recon_loss: 36623455.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113221503.2672; train_global_loss: 153268831.6336; train_optim_loss: 153268831.6336; val_kl_reg_loss: 222850.4781; val_edge_recon_loss: 3117461.2833; val_gene_expr_recon_loss: 36386018.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111785446.9333; val_global_loss: 151511774.9333; val_optim_loss: 151511774.9333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8843; val_auprc_score: 0.8717; val_best_acc_score: 0.8010; val_best_f1_score: 0.8205; train_kl_reg_loss: 231664.3577; train_edge_recon_loss: 3074356.2882; train_gene_expr_recon_loss: 36406469.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 112746396.8244; train_global_loss: 152458887.0840; train_optim_loss: 152458887.0840; val_kl_reg_loss: 222799.0604; val_edge_recon_loss: 3053477.7500; val_gene_expr_recon_loss: 36204146.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111911706.1333; val_global_loss: 151392128.0000; val_optim_loss: 151392128.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8923; val_auprc_score: 0.8796; val_best_acc_score: 0.8083; val_best_f1_score: 0.8299; train_kl_reg_loss: 222219.0058; train_edge_recon_loss: 3025913.5687; train_gene_expr_recon_loss: 36245566.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111905427.8473; train_global_loss: 151399127.6947; train_optim_loss: 151399127.6947; val_kl_reg_loss: 217034.0698; val_edge_recon_loss: 3007931.8500; val_gene_expr_recon_loss: 35896294.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111081526.4000; val_global_loss: 150202789.3333; val_optim_loss: 150202789.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9036; val_auprc_score: 0.8931; val_best_acc_score: 0.8178; val_best_f1_score: 0.8349; train_kl_reg_loss: 212282.9318; train_edge_recon_loss: 2992549.9676; train_gene_expr_recon_loss: 35906171.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111201021.2519; train_global_loss: 150312026.2595; train_optim_loss: 150312026.2595; val_kl_reg_loss: 210216.5646; val_edge_recon_loss: 2983538.1833; val_gene_expr_recon_loss: 35835281.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110898197.3333; val_global_loss: 149927233.0667; val_optim_loss: 149927233.0667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9110; val_auprc_score: 0.9004; val_best_acc_score: 0.8283; val_best_f1_score: 0.8434; train_kl_reg_loss: 206871.2752; train_edge_recon_loss: 2960558.9485; train_gene_expr_recon_loss: 35737888.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110863814.7786; train_global_loss: 149769134.0458; train_optim_loss: 149769134.0458; val_kl_reg_loss: 203322.6979; val_edge_recon_loss: 2939993.2833; val_gene_expr_recon_loss: 35729556.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110527221.3333; val_global_loss: 149400096.0000; val_optim_loss: 149400096.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9159; val_auprc_score: 0.9061; val_best_acc_score: 0.8335; val_best_f1_score: 0.8456; train_kl_reg_loss: 198770.2941; train_edge_recon_loss: 2942040.3550; train_gene_expr_recon_loss: 35732540.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110537840.1221; train_global_loss: 149411190.7176; train_optim_loss: 149411190.7176; val_kl_reg_loss: 173076.6469; val_edge_recon_loss: 2974759.6833; val_gene_expr_recon_loss: 35663203.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110220142.4000; val_global_loss: 149031181.8667; val_optim_loss: 149031181.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9222; val_auprc_score: 0.9127; val_best_acc_score: 0.8420; val_best_f1_score: 0.8541; train_kl_reg_loss: 195065.0751; train_edge_recon_loss: 2932524.8874; train_gene_expr_recon_loss: 35746227.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110156221.7405; train_global_loss: 149030039.0840; train_optim_loss: 149030039.0840; val_kl_reg_loss: 196840.9562; val_edge_recon_loss: 2916741.5000; val_gene_expr_recon_loss: 35391501.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109387366.4000; val_global_loss: 147892450.1333; val_optim_loss: 147892450.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9284; val_auprc_score: 0.9177; val_best_acc_score: 0.8502; val_best_f1_score: 0.8608; train_kl_reg_loss: 192991.5468; train_edge_recon_loss: 2899242.8321; train_gene_expr_recon_loss: 35381971.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109852981.8626; train_global_loss: 148327187.7863; train_optim_loss: 148327187.7863; val_kl_reg_loss: 189111.6729; val_edge_recon_loss: 2919514.6500; val_gene_expr_recon_loss: 35220100.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108557413.8667; val_global_loss: 146886140.8000; val_optim_loss: 146886140.8000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9315; val_auprc_score: 0.9212; val_best_acc_score: 0.8554; val_best_f1_score: 0.8644; train_kl_reg_loss: 187559.0351; train_edge_recon_loss: 2888137.7538; train_gene_expr_recon_loss: 35235867.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109308194.4427; train_global_loss: 147619759.7557; train_optim_loss: 147619759.7557; val_kl_reg_loss: 187046.7656; val_edge_recon_loss: 2893849.1167; val_gene_expr_recon_loss: 35063825.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108220111.4667; val_global_loss: 146364834.1333; val_optim_loss: 146364834.1333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9345; val_auprc_score: 0.9231; val_best_acc_score: 0.8638; val_best_f1_score: 0.8727; train_kl_reg_loss: 184042.4289; train_edge_recon_loss: 2869484.3378; train_gene_expr_recon_loss: 35173368.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109178240.6107; train_global_loss: 147405135.1450; train_optim_loss: 147405135.1450; val_kl_reg_loss: 178505.9979; val_edge_recon_loss: 2904248.4667; val_gene_expr_recon_loss: 34995002.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108162848.5333; val_global_loss: 146240606.9333; val_optim_loss: 146240606.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9411; val_auprc_score: 0.9321; val_best_acc_score: 0.8685; val_best_f1_score: 0.8755; train_kl_reg_loss: 178994.5259; train_edge_recon_loss: 2865752.6050; train_gene_expr_recon_loss: 35096254.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108888172.3969; train_global_loss: 147029173.0076; train_optim_loss: 147029173.0076; val_kl_reg_loss: 179003.1187; val_edge_recon_loss: 2872674.8167; val_gene_expr_recon_loss: 34925151.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108011821.3333; val_global_loss: 145988650.6667; val_optim_loss: 145988650.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9434; val_auprc_score: 0.9333; val_best_acc_score: 0.8770; val_best_f1_score: 0.8843; train_kl_reg_loss: 176026.4825; train_edge_recon_loss: 2853770.2042; train_gene_expr_recon_loss: 34930237.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108372337.9542; train_global_loss: 146332372.0305; train_optim_loss: 146332372.0305; val_kl_reg_loss: 173771.6177; val_edge_recon_loss: 2850694.6167; val_gene_expr_recon_loss: 34864719.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107182862.4000; val_global_loss: 145072048.0000; val_optim_loss: 145072048.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9422; val_auprc_score: 0.9289; val_best_acc_score: 0.8748; val_best_f1_score: 0.8838; train_kl_reg_loss: 178500.7712; train_edge_recon_loss: 2854224.7595; train_gene_expr_recon_loss: 35097421.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108372930.8092; train_global_loss: 146503078.3511; train_optim_loss: 146503078.3511; val_kl_reg_loss: 152862.2594; val_edge_recon_loss: 2881006.5667; val_gene_expr_recon_loss: 34893313.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107786407.4667; val_global_loss: 145713590.4000; val_optim_loss: 145713590.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9346; val_auprc_score: 0.9208; val_best_acc_score: 0.8641; val_best_f1_score: 0.8747; train_kl_reg_loss: 170793.0584; train_edge_recon_loss: 2908371.0324; train_gene_expr_recon_loss: 35754207.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108635524.3359; train_global_loss: 147468896.1221; train_optim_loss: 147468896.1221; val_kl_reg_loss: 170489.0531; val_edge_recon_loss: 2918223.4333; val_gene_expr_recon_loss: 35052207.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107680684.2667; val_global_loss: 145821604.2667; val_optim_loss: 145821604.2667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9391; val_auprc_score: 0.9250; val_best_acc_score: 0.8712; val_best_f1_score: 0.8787; train_kl_reg_loss: 161501.0366; train_edge_recon_loss: 2895579.1069; train_gene_expr_recon_loss: 35483685.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108787142.9008; train_global_loss: 147327908.5802; train_optim_loss: 147327908.5802; val_kl_reg_loss: 169219.5740; val_edge_recon_loss: 2852789.5500; val_gene_expr_recon_loss: 35168457.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108602075.7333; val_global_loss: 146792540.8000; val_optim_loss: 146792540.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9437; val_auprc_score: 0.9334; val_best_acc_score: 0.8781; val_best_f1_score: 0.8843; train_kl_reg_loss: 170332.2455; train_edge_recon_loss: 2854834.8149; train_gene_expr_recon_loss: 34997367.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107922841.1603; train_global_loss: 145945374.9008; train_optim_loss: 145945374.9008; val_kl_reg_loss: 169069.4542; val_edge_recon_loss: 2843288.1333; val_gene_expr_recon_loss: 34846129.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106945467.7333; val_global_loss: 144803954.1333; val_optim_loss: 144803954.1333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9400; val_auprc_score: 0.9304; val_best_acc_score: 0.8649; val_best_f1_score: 0.8722; train_kl_reg_loss: 157508.3378; train_edge_recon_loss: 2865604.8645; train_gene_expr_recon_loss: 35127427.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107781458.8092; train_global_loss: 145931999.3893; train_optim_loss: 145931999.3893; val_kl_reg_loss: 169658.4865; val_edge_recon_loss: 2846633.9667; val_gene_expr_recon_loss: 34787863.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107153651.2000; val_global_loss: 144957809.0667; val_optim_loss: 144957809.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9396; val_auprc_score: 0.9290; val_best_acc_score: 0.8649; val_best_f1_score: 0.8740; train_kl_reg_loss: 172949.3655; train_edge_recon_loss: 2827284.3817; train_gene_expr_recon_loss: 34854576.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107707989.7405; train_global_loss: 145562800.2443; train_optim_loss: 145562800.2443; val_kl_reg_loss: 172814.4552; val_edge_recon_loss: 2852974.4500; val_gene_expr_recon_loss: 34726741.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106836281.0667; val_global_loss: 144588810.6667; val_optim_loss: 144588810.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9433; val_auprc_score: 0.9324; val_best_acc_score: 0.8770; val_best_f1_score: 0.8840; train_kl_reg_loss: 168494.6864; train_edge_recon_loss: 2827011.1947; train_gene_expr_recon_loss: 34797939.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107504842.3817; train_global_loss: 145298287.4504; train_optim_loss: 145298287.4504; val_kl_reg_loss: 168620.4354; val_edge_recon_loss: 2826761.8833; val_gene_expr_recon_loss: 34707324.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106752966.4000; val_global_loss: 144455671.4667; val_optim_loss: 144455671.4667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9430; val_auprc_score: 0.9327; val_best_acc_score: 0.8760; val_best_f1_score: 0.8817; train_kl_reg_loss: 166955.3310; train_edge_recon_loss: 2820100.1889; train_gene_expr_recon_loss: 35465879.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107345156.7023; train_global_loss: 145798092.0916; train_optim_loss: 145798092.0916; val_kl_reg_loss: 164210.7333; val_edge_recon_loss: 2848409.6333; val_gene_expr_recon_loss: 34736704.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107562651.2000; val_global_loss: 145311975.4667; val_optim_loss: 145311975.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9460; val_auprc_score: 0.9362; val_best_acc_score: 0.8778; val_best_f1_score: 0.8829; train_kl_reg_loss: 181654.5024; train_edge_recon_loss: 2819716.7939; train_gene_expr_recon_loss: 34826445.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107409362.0153; train_global_loss: 145237178.8702; train_optim_loss: 145237178.8702; val_kl_reg_loss: 178202.8698; val_edge_recon_loss: 2807774.6500; val_gene_expr_recon_loss: 34676329.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106838760.5333; val_global_loss: 144501066.6667; val_optim_loss: 144501066.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9248; val_auprc_score: 0.9126; val_best_acc_score: 0.8479; val_best_f1_score: 0.8592; train_kl_reg_loss: 191093.3327; train_edge_recon_loss: 3058921.7252; train_gene_expr_recon_loss: 40530126.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111695444.3359; train_global_loss: 155475585.3435; train_optim_loss: 155475585.3435; val_kl_reg_loss: 27819.9999; val_edge_recon_loss: 2878134.4667; val_gene_expr_recon_loss: 40617563.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110897606.9333; val_global_loss: 154421125.3333; val_optim_loss: 154421125.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9203; val_auprc_score: 0.9013; val_best_acc_score: 0.8538; val_best_f1_score: 0.8680; train_kl_reg_loss: 132082.3181; train_edge_recon_loss: 2837477.8359; train_gene_expr_recon_loss: 40319435.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111404463.8779; train_global_loss: 154693459.2977; train_optim_loss: 154693459.2977; val_kl_reg_loss: 22737.4460; val_edge_recon_loss: 2860127.9000; val_gene_expr_recon_loss: 39915815.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110840856.0000; val_global_loss: 153639537.0667; val_optim_loss: 153639537.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9204; val_auprc_score: 0.8935; val_best_acc_score: 0.8570; val_best_f1_score: 0.8696; train_kl_reg_loss: 102985.5535; train_edge_recon_loss: 2832058.7519; train_gene_expr_recon_loss: 40004453.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111118600.6718; train_global_loss: 154058099.6641; train_optim_loss: 154058099.6641; val_kl_reg_loss: 23675.5743; val_edge_recon_loss: 2837149.7333; val_gene_expr_recon_loss: 39922528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111018814.4000; val_global_loss: 153802170.6667; val_optim_loss: 153802170.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9237; val_auprc_score: 0.9012; val_best_acc_score: 0.8639; val_best_f1_score: 0.8754; train_kl_reg_loss: 99609.0547; train_edge_recon_loss: 2817841.4790; train_gene_expr_recon_loss: 39994836.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111277142.4733; train_global_loss: 154189429.4962; train_optim_loss: 154189429.4962; val_kl_reg_loss: 23968.0906; val_edge_recon_loss: 2818013.0000; val_gene_expr_recon_loss: 39980113.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110915083.7333; val_global_loss: 153737176.5333; val_optim_loss: 153737176.5333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9250; val_auprc_score: 0.9021; val_best_acc_score: 0.8619; val_best_f1_score: 0.8724; train_kl_reg_loss: 96598.6836; train_edge_recon_loss: 2809743.6775; train_gene_expr_recon_loss: 39964875.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111128214.9618; train_global_loss: 153999432.5496; train_optim_loss: 153999432.5496; val_kl_reg_loss: 24548.6478; val_edge_recon_loss: 2818567.8500; val_gene_expr_recon_loss: 39839082.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110887673.0667; val_global_loss: 153569873.0667; val_optim_loss: 153569873.0667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9272; val_auprc_score: 0.9078; val_best_acc_score: 0.8608; val_best_f1_score: 0.8722; train_kl_reg_loss: 93113.5076; train_edge_recon_loss: 2794113.7901; train_gene_expr_recon_loss: 39923202.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111065845.5573; train_global_loss: 153876274.6870; train_optim_loss: 153876274.6870; val_kl_reg_loss: 24617.2786; val_edge_recon_loss: 2790015.3167; val_gene_expr_recon_loss: 39921317.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110540101.3333; val_global_loss: 153276052.2667; val_optim_loss: 153276052.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 26 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9408
val AUPRC score: 0.9275
val best accuracy score: 0.8712
val best F1 score: 0.8780
val target rna MSE score: 1.5596
val source rna MSE score: 46.3944
val target atac MSE score: 0.1285
val source atac MSE score: 1.0465
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
