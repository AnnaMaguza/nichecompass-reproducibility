[True]
Run timestamp: 01082023_092416_76.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_76']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8995; val_auprc_score: 0.9793; val_best_acc_score: 0.8628; val_best_f1_score: 0.9251; train_kl_reg_loss: 32764.1943; train_edge_recon_loss: 1031692.9144; train_gene_expr_recon_loss: 524658.2251; train_masked_gp_l1_reg_loss: 6282.4322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114709.3644; train_global_loss: 1710107.1319; train_optim_loss: 1710107.1319; val_kl_reg_loss: 23648.1247; val_edge_recon_loss: 1222709.2708; val_gene_expr_recon_loss: 455776.5365; val_masked_gp_l1_reg_loss: 6484.4238; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101723.0000; val_global_loss: 1810341.2708; val_optim_loss: 1810341.2708
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8807; val_auprc_score: 0.9742; val_best_acc_score: 0.8683; val_best_f1_score: 0.9277; train_kl_reg_loss: 17514.3880; train_edge_recon_loss: 1030897.6366; train_gene_expr_recon_loss: 411643.8854; train_masked_gp_l1_reg_loss: 6516.7264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90884.7260; train_global_loss: 1557457.3634; train_optim_loss: 1557457.3634; val_kl_reg_loss: 11284.5228; val_edge_recon_loss: 1205229.8333; val_gene_expr_recon_loss: 350149.8177; val_masked_gp_l1_reg_loss: 6532.5073; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80671.5469; val_global_loss: 1653868.2083; val_optim_loss: 1653868.2083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8642; val_auprc_score: 0.9731; val_best_acc_score: 0.8668; val_best_f1_score: 0.9254; train_kl_reg_loss: 13011.3012; train_edge_recon_loss: 1039024.7303; train_gene_expr_recon_loss: 304636.7124; train_masked_gp_l1_reg_loss: 6481.9680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71858.2962; train_global_loss: 1435013.0116; train_optim_loss: 1435013.0116; val_kl_reg_loss: 12420.0973; val_edge_recon_loss: 1202262.5000; val_gene_expr_recon_loss: 272592.8438; val_masked_gp_l1_reg_loss: 6403.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62881.3594; val_global_loss: 1556560.8333; val_optim_loss: 1556560.8333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8415; val_auprc_score: 0.9670; val_best_acc_score: 0.8825; val_best_f1_score: 0.9353; train_kl_reg_loss: 12237.6498; train_edge_recon_loss: 1021724.1863; train_gene_expr_recon_loss: 263471.3354; train_masked_gp_l1_reg_loss: 6342.9124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54838.0210; train_global_loss: 1358614.1157; train_optim_loss: 1358614.1157; val_kl_reg_loss: 8537.4637; val_edge_recon_loss: 1096148.3125; val_gene_expr_recon_loss: 257606.9818; val_masked_gp_l1_reg_loss: 6305.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47074.4453; val_global_loss: 1415672.7500; val_optim_loss: 1415672.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8301; val_auprc_score: 0.9611; val_best_acc_score: 0.8911; val_best_f1_score: 0.9393; train_kl_reg_loss: 13295.1835; train_edge_recon_loss: 922210.8773; train_gene_expr_recon_loss: 267827.7486; train_masked_gp_l1_reg_loss: 6446.0699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41137.1053; train_global_loss: 1250916.9838; train_optim_loss: 1250916.9838; val_kl_reg_loss: 19466.0186; val_edge_recon_loss: 886433.1771; val_gene_expr_recon_loss: 260045.9740; val_masked_gp_l1_reg_loss: 6561.0303; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35719.7695; val_global_loss: 1208225.9167; val_optim_loss: 1208225.9167
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8558; val_auprc_score: 0.9672; val_best_acc_score: 0.8975; val_best_f1_score: 0.9427; train_kl_reg_loss: 18392.4236; train_edge_recon_loss: 877266.0880; train_gene_expr_recon_loss: 256524.0043; train_masked_gp_l1_reg_loss: 6576.4327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31870.6448; train_global_loss: 1190629.5810; train_optim_loss: 1190629.5810; val_kl_reg_loss: 18567.4736; val_edge_recon_loss: 878751.0625; val_gene_expr_recon_loss: 253962.4635; val_masked_gp_l1_reg_loss: 6598.3452; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28599.4414; val_global_loss: 1186478.8750; val_optim_loss: 1186478.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8625; val_auprc_score: 0.9695; val_best_acc_score: 0.9025; val_best_f1_score: 0.9455; train_kl_reg_loss: 18139.0488; train_edge_recon_loss: 866763.9410; train_gene_expr_recon_loss: 250779.8973; train_masked_gp_l1_reg_loss: 6608.9443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26264.0499; train_global_loss: 1168555.8935; train_optim_loss: 1168555.8935; val_kl_reg_loss: 16778.5991; val_edge_recon_loss: 874595.4271; val_gene_expr_recon_loss: 248687.8828; val_masked_gp_l1_reg_loss: 6612.9600; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24132.5996; val_global_loss: 1170807.5208; val_optim_loss: 1170807.5208
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8914; val_auprc_score: 0.9748; val_best_acc_score: 0.9129; val_best_f1_score: 0.9509; train_kl_reg_loss: 16741.2871; train_edge_recon_loss: 848352.2801; train_gene_expr_recon_loss: 247537.1661; train_masked_gp_l1_reg_loss: 6625.7702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22508.6881; train_global_loss: 1141765.1968; train_optim_loss: 1141765.1968; val_kl_reg_loss: 15482.1243; val_edge_recon_loss: 834913.0521; val_gene_expr_recon_loss: 244874.9922; val_masked_gp_l1_reg_loss: 6660.8569; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21059.6895; val_global_loss: 1122990.7917; val_optim_loss: 1122990.7917
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9057; val_auprc_score: 0.9766; val_best_acc_score: 0.9190; val_best_f1_score: 0.9535; train_kl_reg_loss: 16694.3685; train_edge_recon_loss: 826346.4838; train_gene_expr_recon_loss: 244391.2286; train_masked_gp_l1_reg_loss: 6692.4500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20013.0692; train_global_loss: 1114137.6088; train_optim_loss: 1114137.6088; val_kl_reg_loss: 17470.5052; val_edge_recon_loss: 861456.3542; val_gene_expr_recon_loss: 241780.6042; val_masked_gp_l1_reg_loss: 6696.4463; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18982.1699; val_global_loss: 1146386.0833; val_optim_loss: 1146386.0833
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9062; val_auprc_score: 0.9779; val_best_acc_score: 0.9250; val_best_f1_score: 0.9569; train_kl_reg_loss: 18988.8539; train_edge_recon_loss: 814733.0486; train_gene_expr_recon_loss: 238465.3006; train_masked_gp_l1_reg_loss: 6678.9107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18156.3936; train_global_loss: 1097022.5104; train_optim_loss: 1097022.5104; val_kl_reg_loss: 19906.3874; val_edge_recon_loss: 833206.6354; val_gene_expr_recon_loss: 236083.7344; val_masked_gp_l1_reg_loss: 6658.1533; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17368.6172; val_global_loss: 1113223.4792; val_optim_loss: 1113223.4792
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9164; val_auprc_score: 0.9804; val_best_acc_score: 0.9284; val_best_f1_score: 0.9590; train_kl_reg_loss: 19451.2334; train_edge_recon_loss: 804874.0185; train_gene_expr_recon_loss: 233788.6499; train_masked_gp_l1_reg_loss: 6624.1558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16720.3812; train_global_loss: 1081458.4433; train_optim_loss: 1081458.4433; val_kl_reg_loss: 18881.1836; val_edge_recon_loss: 813215.0938; val_gene_expr_recon_loss: 231269.1224; val_masked_gp_l1_reg_loss: 6588.4307; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16099.7637; val_global_loss: 1086053.5312; val_optim_loss: 1086053.5312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9114; val_auprc_score: 0.9780; val_best_acc_score: 0.9261; val_best_f1_score: 0.9577; train_kl_reg_loss: 18724.9002; train_edge_recon_loss: 804222.4086; train_gene_expr_recon_loss: 229928.6337; train_masked_gp_l1_reg_loss: 6540.9317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15560.3434; train_global_loss: 1074977.2257; train_optim_loss: 1074977.2257; val_kl_reg_loss: 17679.3564; val_edge_recon_loss: 835463.9688; val_gene_expr_recon_loss: 229654.9844; val_masked_gp_l1_reg_loss: 6494.6396; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15055.9482; val_global_loss: 1104348.9167; val_optim_loss: 1104348.9167
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9213; val_auprc_score: 0.9823; val_best_acc_score: 0.9271; val_best_f1_score: 0.9584; train_kl_reg_loss: 18168.1260; train_edge_recon_loss: 801849.7558; train_gene_expr_recon_loss: 226597.6250; train_masked_gp_l1_reg_loss: 6439.2010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14632.1326; train_global_loss: 1067686.8472; train_optim_loss: 1067686.8472; val_kl_reg_loss: 17310.8141; val_edge_recon_loss: 813765.8333; val_gene_expr_recon_loss: 224577.8776; val_masked_gp_l1_reg_loss: 6375.8062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14204.0723; val_global_loss: 1076234.4167; val_optim_loss: 1076234.4167
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9312; val_auprc_score: 0.9842; val_best_acc_score: 0.9310; val_best_f1_score: 0.9603; train_kl_reg_loss: 17238.2806; train_edge_recon_loss: 802512.9005; train_gene_expr_recon_loss: 223510.2413; train_masked_gp_l1_reg_loss: 6303.9592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13836.1641; train_global_loss: 1063401.5417; train_optim_loss: 1063401.5417; val_kl_reg_loss: 16650.6462; val_edge_recon_loss: 809520.0000; val_gene_expr_recon_loss: 221288.9297; val_masked_gp_l1_reg_loss: 6226.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13482.4004; val_global_loss: 1067168.4375; val_optim_loss: 1067168.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9284; val_auprc_score: 0.9832; val_best_acc_score: 0.9304; val_best_f1_score: 0.9600; train_kl_reg_loss: 16363.3792; train_edge_recon_loss: 803039.7650; train_gene_expr_recon_loss: 220746.5796; train_masked_gp_l1_reg_loss: 6140.4488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13144.2582; train_global_loss: 1059434.4190; train_optim_loss: 1059434.4190; val_kl_reg_loss: 14989.1935; val_edge_recon_loss: 822897.9688; val_gene_expr_recon_loss: 219457.7292; val_masked_gp_l1_reg_loss: 6045.6553; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12815.8574; val_global_loss: 1076206.3750; val_optim_loss: 1076206.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9373; val_auprc_score: 0.9864; val_best_acc_score: 0.9335; val_best_f1_score: 0.9619; train_kl_reg_loss: 15673.4589; train_edge_recon_loss: 791539.1725; train_gene_expr_recon_loss: 218004.2080; train_masked_gp_l1_reg_loss: 5944.9195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12491.3993; train_global_loss: 1043653.1516; train_optim_loss: 1043653.1516; val_kl_reg_loss: 14734.6489; val_edge_recon_loss: 794648.9583; val_gene_expr_recon_loss: 216249.8438; val_masked_gp_l1_reg_loss: 5838.6206; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12179.6982; val_global_loss: 1043651.7917; val_optim_loss: 1043651.7917
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9319; val_auprc_score: 0.9852; val_best_acc_score: 0.9266; val_best_f1_score: 0.9581; train_kl_reg_loss: 15025.0365; train_edge_recon_loss: 793339.2245; train_gene_expr_recon_loss: 215408.0703; train_masked_gp_l1_reg_loss: 5726.4161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11878.9614; train_global_loss: 1041377.7153; train_optim_loss: 1041377.7153; val_kl_reg_loss: 14668.1462; val_edge_recon_loss: 794572.8021; val_gene_expr_recon_loss: 213034.9870; val_masked_gp_l1_reg_loss: 5603.5889; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11563.5791; val_global_loss: 1039443.0833; val_optim_loss: 1039443.0833
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9428; val_auprc_score: 0.9869; val_best_acc_score: 0.9348; val_best_f1_score: 0.9623; train_kl_reg_loss: 14057.6741; train_edge_recon_loss: 797141.9618; train_gene_expr_recon_loss: 213225.5043; train_masked_gp_l1_reg_loss: 5484.0163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11295.9450; train_global_loss: 1041205.1030; train_optim_loss: 1041205.1030; val_kl_reg_loss: 13281.0495; val_edge_recon_loss: 809660.6458; val_gene_expr_recon_loss: 211811.1536; val_masked_gp_l1_reg_loss: 5351.4185; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11009.0088; val_global_loss: 1051113.2708; val_optim_loss: 1051113.2708
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9490; val_auprc_score: 0.9893; val_best_acc_score: 0.9369; val_best_f1_score: 0.9639; train_kl_reg_loss: 13624.1134; train_edge_recon_loss: 787463.8021; train_gene_expr_recon_loss: 210921.5263; train_masked_gp_l1_reg_loss: 5218.8922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10725.7410; train_global_loss: 1027954.0741; train_optim_loss: 1027954.0741; val_kl_reg_loss: 12998.7567; val_edge_recon_loss: 774108.1042; val_gene_expr_recon_loss: 210322.5443; val_masked_gp_l1_reg_loss: 5080.4067; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10432.6514; val_global_loss: 1012942.4583; val_optim_loss: 1012942.4583
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9471; val_auprc_score: 0.9877; val_best_acc_score: 0.9366; val_best_f1_score: 0.9635; train_kl_reg_loss: 12973.9278; train_edge_recon_loss: 793122.6713; train_gene_expr_recon_loss: 208895.9375; train_masked_gp_l1_reg_loss: 4948.1480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10184.8510; train_global_loss: 1030125.5278; train_optim_loss: 1030125.5278; val_kl_reg_loss: 13125.7155; val_edge_recon_loss: 798073.6250; val_gene_expr_recon_loss: 207909.6094; val_masked_gp_l1_reg_loss: 4809.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9919.3682; val_global_loss: 1033837.5729; val_optim_loss: 1033837.5729
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9476; val_auprc_score: 0.9876; val_best_acc_score: 0.9384; val_best_f1_score: 0.9643; train_kl_reg_loss: 12711.8962; train_edge_recon_loss: 790800.6458; train_gene_expr_recon_loss: 206772.7112; train_masked_gp_l1_reg_loss: 4668.7711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9640.5579; train_global_loss: 1024594.5787; train_optim_loss: 1024594.5787; val_kl_reg_loss: 12072.0461; val_edge_recon_loss: 807050.9896; val_gene_expr_recon_loss: 205441.3672; val_masked_gp_l1_reg_loss: 4528.4868; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9346.6396; val_global_loss: 1038439.5417; val_optim_loss: 1038439.5417
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9460; val_auprc_score: 0.9874; val_best_acc_score: 0.9380; val_best_f1_score: 0.9643; train_kl_reg_loss: 12437.6033; train_edge_recon_loss: 785746.6736; train_gene_expr_recon_loss: 204869.8403; train_masked_gp_l1_reg_loss: 4400.3187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9069.7596; train_global_loss: 1016524.1852; train_optim_loss: 1016524.1852; val_kl_reg_loss: 11446.8237; val_edge_recon_loss: 794462.1458; val_gene_expr_recon_loss: 204597.4766; val_masked_gp_l1_reg_loss: 4272.4868; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8781.7324; val_global_loss: 1023560.6979; val_optim_loss: 1023560.6979
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9555; val_auprc_score: 0.9903; val_best_acc_score: 0.9417; val_best_f1_score: 0.9664; train_kl_reg_loss: 12171.2519; train_edge_recon_loss: 775990.1181; train_gene_expr_recon_loss: 202918.4896; train_masked_gp_l1_reg_loss: 4142.3961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8501.6644; train_global_loss: 1003723.9178; train_optim_loss: 1003723.9178; val_kl_reg_loss: 11289.6514; val_edge_recon_loss: 777250.9479; val_gene_expr_recon_loss: 202115.3802; val_masked_gp_l1_reg_loss: 4015.1355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8209.6191; val_global_loss: 1002880.7188; val_optim_loss: 1002880.7188
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9534; val_auprc_score: 0.9896; val_best_acc_score: 0.9388; val_best_f1_score: 0.9645; train_kl_reg_loss: 11500.3954; train_edge_recon_loss: 778082.6759; train_gene_expr_recon_loss: 201117.7156; train_masked_gp_l1_reg_loss: 3899.8399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7943.9742; train_global_loss: 1002544.6053; train_optim_loss: 1002544.6053; val_kl_reg_loss: 10725.1200; val_edge_recon_loss: 806142.7083; val_gene_expr_recon_loss: 200017.9792; val_masked_gp_l1_reg_loss: 3778.4348; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7672.5166; val_global_loss: 1028336.7500; val_optim_loss: 1028336.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9534; val_auprc_score: 0.9896; val_best_acc_score: 0.9410; val_best_f1_score: 0.9658; train_kl_reg_loss: 11447.9837; train_edge_recon_loss: 781605.9271; train_gene_expr_recon_loss: 199506.3111; train_masked_gp_l1_reg_loss: 3677.0527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7438.5834; train_global_loss: 1003675.8519; train_optim_loss: 1003675.8519; val_kl_reg_loss: 10758.0578; val_edge_recon_loss: 788774.4375; val_gene_expr_recon_loss: 200141.9531; val_masked_gp_l1_reg_loss: 3565.3943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7199.3184; val_global_loss: 1010439.1250; val_optim_loss: 1010439.1250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9528; val_auprc_score: 0.9893; val_best_acc_score: 0.9406; val_best_f1_score: 0.9656; train_kl_reg_loss: 11152.7249; train_edge_recon_loss: 779517.9954; train_gene_expr_recon_loss: 197717.3501; train_masked_gp_l1_reg_loss: 3467.6381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6972.1873; train_global_loss: 998827.8819; train_optim_loss: 998827.8819; val_kl_reg_loss: 10931.9144; val_edge_recon_loss: 794290.6354; val_gene_expr_recon_loss: 196886.3542; val_masked_gp_l1_reg_loss: 3370.5813; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6739.2358; val_global_loss: 1012218.7083; val_optim_loss: 1012218.7083
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9567; val_auprc_score: 0.9901; val_best_acc_score: 0.9448; val_best_f1_score: 0.9681; train_kl_reg_loss: 10724.0430; train_edge_recon_loss: 786551.6215; train_gene_expr_recon_loss: 196272.6661; train_masked_gp_l1_reg_loss: 3282.2528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6537.1677; train_global_loss: 1003367.7581; train_optim_loss: 1003367.7581; val_kl_reg_loss: 10260.5627; val_edge_recon_loss: 768528.0938; val_gene_expr_recon_loss: 195793.1849; val_masked_gp_l1_reg_loss: 3194.4690; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6327.4028; val_global_loss: 984103.7083; val_optim_loss: 984103.7083
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9575; val_auprc_score: 0.9901; val_best_acc_score: 0.9468; val_best_f1_score: 0.9691; train_kl_reg_loss: 10413.1286; train_edge_recon_loss: 779269.8646; train_gene_expr_recon_loss: 194815.9699; train_masked_gp_l1_reg_loss: 3114.9456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6129.8118; train_global_loss: 993743.7245; train_optim_loss: 993743.7245; val_kl_reg_loss: 10017.7725; val_edge_recon_loss: 806344.1146; val_gene_expr_recon_loss: 194468.3229; val_masked_gp_l1_reg_loss: 3036.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5930.1826; val_global_loss: 1019797.3333; val_optim_loss: 1019797.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9604; val_auprc_score: 0.9901; val_best_acc_score: 0.9467; val_best_f1_score: 0.9691; train_kl_reg_loss: 10156.4513; train_edge_recon_loss: 769862.2963; train_gene_expr_recon_loss: 193475.6696; train_masked_gp_l1_reg_loss: 2966.7821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5744.7077; train_global_loss: 982205.9062; train_optim_loss: 982205.9062; val_kl_reg_loss: 9927.7541; val_edge_recon_loss: 789772.5833; val_gene_expr_recon_loss: 192944.8125; val_masked_gp_l1_reg_loss: 2887.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5556.5942; val_global_loss: 1001089.3438; val_optim_loss: 1001089.3438
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9589; val_auprc_score: 0.9904; val_best_acc_score: 0.9449; val_best_f1_score: 0.9678; train_kl_reg_loss: 9792.6446; train_edge_recon_loss: 769566.8495; train_gene_expr_recon_loss: 192249.2998; train_masked_gp_l1_reg_loss: 2819.1442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5383.4982; train_global_loss: 979811.4248; train_optim_loss: 979811.4248; val_kl_reg_loss: 9550.4282; val_edge_recon_loss: 816766.7917; val_gene_expr_recon_loss: 191490.3646; val_masked_gp_l1_reg_loss: 2753.6470; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5208.9746; val_global_loss: 1025770.2396; val_optim_loss: 1025770.2396
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9584; val_auprc_score: 0.9895; val_best_acc_score: 0.9464; val_best_f1_score: 0.9687; train_kl_reg_loss: 9720.6040; train_edge_recon_loss: 777599.2627; train_gene_expr_recon_loss: 190917.6887; train_masked_gp_l1_reg_loss: 2688.0635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5051.9970; train_global_loss: 985977.6192; train_optim_loss: 985977.6192; val_kl_reg_loss: 9667.3258; val_edge_recon_loss: 795069.0208; val_gene_expr_recon_loss: 190281.1354; val_masked_gp_l1_reg_loss: 2628.0005; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4896.8198; val_global_loss: 1002542.2917; val_optim_loss: 1002542.2917

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9592; val_auprc_score: 0.9910; val_best_acc_score: 0.9471; val_best_f1_score: 0.9693; train_kl_reg_loss: 9878.6462; train_edge_recon_loss: 769930.6412; train_gene_expr_recon_loss: 190097.1163; train_masked_gp_l1_reg_loss: 2596.9417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4807.4561; train_global_loss: 977310.8021; train_optim_loss: 977310.8021; val_kl_reg_loss: 9461.0549; val_edge_recon_loss: 790017.7812; val_gene_expr_recon_loss: 190279.5599; val_masked_gp_l1_reg_loss: 2583.8628; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4774.2017; val_global_loss: 997116.4688; val_optim_loss: 997116.4688
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9593; val_auprc_score: 0.9895; val_best_acc_score: 0.9478; val_best_f1_score: 0.9695; train_kl_reg_loss: 9743.8687; train_edge_recon_loss: 774043.0775; train_gene_expr_recon_loss: 189989.1589; train_masked_gp_l1_reg_loss: 2577.9457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4757.9310; train_global_loss: 981111.9792; train_optim_loss: 981111.9792; val_kl_reg_loss: 9418.5693; val_edge_recon_loss: 811827.1042; val_gene_expr_recon_loss: 189992.1771; val_masked_gp_l1_reg_loss: 2572.2002; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4741.2949; val_global_loss: 1018551.3438; val_optim_loss: 1018551.3438
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9605; val_auprc_score: 0.9915; val_best_acc_score: 0.9511; val_best_f1_score: 0.9717; train_kl_reg_loss: 9636.8897; train_edge_recon_loss: 768114.0428; train_gene_expr_recon_loss: 189814.9740; train_masked_gp_l1_reg_loss: 2566.4505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4724.9664; train_global_loss: 974857.3275; train_optim_loss: 974857.3275; val_kl_reg_loss: 9197.1963; val_edge_recon_loss: 780594.4896; val_gene_expr_recon_loss: 189983.1615; val_masked_gp_l1_reg_loss: 2560.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4708.1118; val_global_loss: 987043.6562; val_optim_loss: 987043.6562
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9632; val_auprc_score: 0.9916; val_best_acc_score: 0.9491; val_best_f1_score: 0.9704; train_kl_reg_loss: 9437.8423; train_edge_recon_loss: 776377.6968; train_gene_expr_recon_loss: 189756.9340; train_masked_gp_l1_reg_loss: 2555.4098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4691.7666; train_global_loss: 982819.6551; train_optim_loss: 982819.6551; val_kl_reg_loss: 9198.7526; val_edge_recon_loss: 785518.9792; val_gene_expr_recon_loss: 189614.0599; val_masked_gp_l1_reg_loss: 2550.0972; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4675.2319; val_global_loss: 991557.1771; val_optim_loss: 991557.1771

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 31 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
val AUROC score: 0.9557
val AUPRC score: 0.9901
val best accuracy score: 0.9453
val best F1 score: 0.9684
val target rna MSE score: 18.8921
val source rna MSE score: 6.7688
Val cat covariate0 mean sim diff: -0.0023

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
