[True]
Run timestamp: 07082023_210929_119.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_119']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8787; val_auprc_score: 0.8950; val_best_acc_score: 0.5334; val_best_f1_score: 0.6810; train_kl_reg_loss: 54916.4672; train_edge_recon_loss: 3474201.6944; train_gene_expr_recon_loss: 1207374.4722; train_masked_gp_l1_reg_loss: 4639.1738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119402.3090; train_chrom_access_recon_loss: 3661924.3194; train_global_loss: 8522458.2222; train_optim_loss: 8522458.2222; val_kl_reg_loss: 8869.7959; val_edge_recon_loss: 4062747.2500; val_gene_expr_recon_loss: 1109648.0000; val_masked_gp_l1_reg_loss: 4218.3213; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117162.1484; val_chrom_access_recon_loss: 1635047.8750; val_global_loss: 6937693.5000; val_optim_loss: 6937693.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8838; val_auprc_score: 0.8962; val_best_acc_score: 0.5299; val_best_f1_score: 0.6794; train_kl_reg_loss: 7874.1214; train_edge_recon_loss: 3472151.1667; train_gene_expr_recon_loss: 1084379.1944; train_masked_gp_l1_reg_loss: 4120.3620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115850.2535; train_chrom_access_recon_loss: 1545415.8194; train_global_loss: 6229790.8889; train_optim_loss: 6229790.8889; val_kl_reg_loss: 7201.1201; val_edge_recon_loss: 4063099.2500; val_gene_expr_recon_loss: 1041653.0000; val_masked_gp_l1_reg_loss: 4079.6091; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114303.6875; val_chrom_access_recon_loss: 1486777.2500; val_global_loss: 6717113.0000; val_optim_loss: 6717113.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8769; val_auprc_score: 0.8942; val_best_acc_score: 0.5299; val_best_f1_score: 0.6795; train_kl_reg_loss: 7600.0626; train_edge_recon_loss: 3473948.1667; train_gene_expr_recon_loss: 983933.3194; train_masked_gp_l1_reg_loss: 4149.0072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113139.5564; train_chrom_access_recon_loss: 1450996.1667; train_global_loss: 6033766.3333; train_optim_loss: 6033766.3333; val_kl_reg_loss: 7796.8135; val_edge_recon_loss: 4063442.7500; val_gene_expr_recon_loss: 940402.8750; val_masked_gp_l1_reg_loss: 4252.8193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111687.9531; val_chrom_access_recon_loss: 1432307.5000; val_global_loss: 6559891.0000; val_optim_loss: 6559891.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8720; val_auprc_score: 0.8893; val_best_acc_score: 0.5260; val_best_f1_score: 0.6777; train_kl_reg_loss: 8819.7632; train_edge_recon_loss: 3477487.1389; train_gene_expr_recon_loss: 895472.9097; train_masked_gp_l1_reg_loss: 4319.7863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110498.4314; train_chrom_access_recon_loss: 1410365.2778; train_global_loss: 5906963.4444; train_optim_loss: 5906963.4444; val_kl_reg_loss: 14092.1465; val_edge_recon_loss: 4063642.5000; val_gene_expr_recon_loss: 858047.5625; val_masked_gp_l1_reg_loss: 4385.2593; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108972.9297; val_chrom_access_recon_loss: 1405573.0000; val_global_loss: 6454714.0000; val_optim_loss: 6454714.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8518; val_auprc_score: 0.8674; val_best_acc_score: 0.5354; val_best_f1_score: 0.6814; train_kl_reg_loss: 14477.7530; train_edge_recon_loss: 3478699.3611; train_gene_expr_recon_loss: 824291.1667; train_masked_gp_l1_reg_loss: 4417.3117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107654.2830; train_chrom_access_recon_loss: 1386131.0556; train_global_loss: 5815670.7778; train_optim_loss: 5815670.7778; val_kl_reg_loss: 14626.9268; val_edge_recon_loss: 4062955.5000; val_gene_expr_recon_loss: 809692.6250; val_masked_gp_l1_reg_loss: 4444.2427; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105924.6953; val_chrom_access_recon_loss: 1379064.7500; val_global_loss: 6376708.0000; val_optim_loss: 6376708.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8429; val_auprc_score: 0.8595; val_best_acc_score: 0.5442; val_best_f1_score: 0.6842; train_kl_reg_loss: 16618.6839; train_edge_recon_loss: 3479909.7222; train_gene_expr_recon_loss: 792333.3750; train_masked_gp_l1_reg_loss: 4462.8893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104415.1667; train_chrom_access_recon_loss: 1363514.4722; train_global_loss: 5761254.2778; train_optim_loss: 5761254.2778; val_kl_reg_loss: 15837.5127; val_edge_recon_loss: 4061330.5000; val_gene_expr_recon_loss: 779260.6250; val_masked_gp_l1_reg_loss: 4482.5498; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102461.6406; val_chrom_access_recon_loss: 1362518.1250; val_global_loss: 6325890.5000; val_optim_loss: 6325890.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8359; val_auprc_score: 0.8485; val_best_acc_score: 0.5562; val_best_f1_score: 0.6883; train_kl_reg_loss: 18186.4303; train_edge_recon_loss: 3480322.9722; train_gene_expr_recon_loss: 763451.8403; train_masked_gp_l1_reg_loss: 4496.5728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100813.5208; train_chrom_access_recon_loss: 1352678.9167; train_global_loss: 5719950.2222; train_optim_loss: 5719950.2222; val_kl_reg_loss: 17975.6816; val_edge_recon_loss: 4059226.2500; val_gene_expr_recon_loss: 757235.8750; val_masked_gp_l1_reg_loss: 4510.9004; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98710.8984; val_chrom_access_recon_loss: 1353867.2500; val_global_loss: 6291527.0000; val_optim_loss: 6291527.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8412; val_auprc_score: 0.8449; val_best_acc_score: 0.5719; val_best_f1_score: 0.6931; train_kl_reg_loss: 19379.4130; train_edge_recon_loss: 3481123.2778; train_gene_expr_recon_loss: 745574.6736; train_masked_gp_l1_reg_loss: 4526.9710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96977.7778; train_chrom_access_recon_loss: 1341664.0278; train_global_loss: 5689246.1667; train_optim_loss: 5689246.1667; val_kl_reg_loss: 18296.9844; val_edge_recon_loss: 4055117.0000; val_gene_expr_recon_loss: 741479.0000; val_masked_gp_l1_reg_loss: 4539.3691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94791.5234; val_chrom_access_recon_loss: 1347910.3750; val_global_loss: 6262134.5000; val_optim_loss: 6262134.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8576; val_auprc_score: 0.8598; val_best_acc_score: 0.6456; val_best_f1_score: 0.7301; train_kl_reg_loss: 19372.8752; train_edge_recon_loss: 3480042.1111; train_gene_expr_recon_loss: 728620.5278; train_masked_gp_l1_reg_loss: 4554.7575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93025.7630; train_chrom_access_recon_loss: 1333288.1111; train_global_loss: 5658904.2222; train_optim_loss: 5658904.2222; val_kl_reg_loss: 19598.7891; val_edge_recon_loss: 4047482.2500; val_gene_expr_recon_loss: 728479.7500; val_masked_gp_l1_reg_loss: 4566.9209; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90813.1641; val_chrom_access_recon_loss: 1342711.1250; val_global_loss: 6233652.0000; val_optim_loss: 6233652.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8692; val_auprc_score: 0.8645; val_best_acc_score: 0.7506; val_best_f1_score: 0.7875; train_kl_reg_loss: 19637.1927; train_edge_recon_loss: 3479289.8889; train_gene_expr_recon_loss: 719586.3611; train_masked_gp_l1_reg_loss: 4580.9155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89037.3472; train_chrom_access_recon_loss: 1335044.8472; train_global_loss: 5647176.4444; train_optim_loss: 5647176.4444; val_kl_reg_loss: 19124.3516; val_edge_recon_loss: 4028626.0000; val_gene_expr_recon_loss: 718532.6250; val_masked_gp_l1_reg_loss: 4594.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86820.7188; val_chrom_access_recon_loss: 1337810.8750; val_global_loss: 6195508.5000; val_optim_loss: 6195508.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8624; val_auprc_score: 0.8497; val_best_acc_score: 0.7894; val_best_f1_score: 0.7876; train_kl_reg_loss: 18774.8168; train_edge_recon_loss: 3474961.6944; train_gene_expr_recon_loss: 710394.9931; train_masked_gp_l1_reg_loss: 4614.6093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85067.1979; train_chrom_access_recon_loss: 1330789.4028; train_global_loss: 5624602.6111; train_optim_loss: 5624602.6111; val_kl_reg_loss: 16043.9902; val_edge_recon_loss: 3974150.0000; val_gene_expr_recon_loss: 712652.3750; val_masked_gp_l1_reg_loss: 4633.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82889.0000; val_chrom_access_recon_loss: 1334489.5000; val_global_loss: 6124858.0000; val_optim_loss: 6124858.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8575; val_auprc_score: 0.8382; val_best_acc_score: 0.7746; val_best_f1_score: 0.7999; train_kl_reg_loss: 15977.7401; train_edge_recon_loss: 3453980.8333; train_gene_expr_recon_loss: 706847.6875; train_masked_gp_l1_reg_loss: 4658.2356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81178.7847; train_chrom_access_recon_loss: 1326123.3611; train_global_loss: 5588766.6667; train_optim_loss: 5588766.6667; val_kl_reg_loss: 11934.7715; val_edge_recon_loss: 3714229.5000; val_gene_expr_recon_loss: 715156.7500; val_masked_gp_l1_reg_loss: 4688.1064; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79064.9844; val_chrom_access_recon_loss: 1332919.7500; val_global_loss: 5857994.0000; val_optim_loss: 5857994.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8381; val_auprc_score: 0.8207; val_best_acc_score: 0.7501; val_best_f1_score: 0.7805; train_kl_reg_loss: 10432.5101; train_edge_recon_loss: 3302102.0000; train_gene_expr_recon_loss: 725526.2569; train_masked_gp_l1_reg_loss: 4748.5853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77434.6944; train_chrom_access_recon_loss: 1331023.0417; train_global_loss: 5451267.0556; train_optim_loss: 5451267.0556; val_kl_reg_loss: 10988.3672; val_edge_recon_loss: 3075870.7500; val_gene_expr_recon_loss: 756105.6250; val_masked_gp_l1_reg_loss: 4860.6006; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75445.4062; val_chrom_access_recon_loss: 1345774.5000; val_global_loss: 5269045.0000; val_optim_loss: 5269045.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8352; val_auprc_score: 0.8259; val_best_acc_score: 0.7367; val_best_f1_score: 0.7710; train_kl_reg_loss: 19010.5013; train_edge_recon_loss: 2992514.1667; train_gene_expr_recon_loss: 756799.7847; train_masked_gp_l1_reg_loss: 4974.3898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73946.5087; train_chrom_access_recon_loss: 1343380.3194; train_global_loss: 5190625.5556; train_optim_loss: 5190625.5556; val_kl_reg_loss: 29074.0742; val_edge_recon_loss: 3028175.2500; val_gene_expr_recon_loss: 742881.5000; val_masked_gp_l1_reg_loss: 5082.0576; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72113.2656; val_chrom_access_recon_loss: 1341070.1250; val_global_loss: 5218396.0000; val_optim_loss: 5218396.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8483; val_auprc_score: 0.8400; val_best_acc_score: 0.7480; val_best_f1_score: 0.7776; train_kl_reg_loss: 36904.0536; train_edge_recon_loss: 2922084.9722; train_gene_expr_recon_loss: 730379.4861; train_masked_gp_l1_reg_loss: 5128.7524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70686.5660; train_chrom_access_recon_loss: 1335931.7083; train_global_loss: 5101115.5556; train_optim_loss: 5101115.5556; val_kl_reg_loss: 42145.1094; val_edge_recon_loss: 2958781.0000; val_gene_expr_recon_loss: 733342.6250; val_masked_gp_l1_reg_loss: 5174.0825; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68921.0625; val_chrom_access_recon_loss: 1335302.5000; val_global_loss: 5143666.0000; val_optim_loss: 5143666.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8688; val_auprc_score: 0.8618; val_best_acc_score: 0.7699; val_best_f1_score: 0.7856; train_kl_reg_loss: 44778.5647; train_edge_recon_loss: 2889955.3056; train_gene_expr_recon_loss: 720876.5000; train_masked_gp_l1_reg_loss: 5202.9272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67556.3646; train_chrom_access_recon_loss: 1331520.9722; train_global_loss: 5059890.6111; train_optim_loss: 5059890.6111; val_kl_reg_loss: 44027.1250; val_edge_recon_loss: 2919231.7500; val_gene_expr_recon_loss: 722061.6250; val_masked_gp_l1_reg_loss: 5230.5791; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65862.3750; val_chrom_access_recon_loss: 1329426.8750; val_global_loss: 5085840.5000; val_optim_loss: 5085840.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8833; val_auprc_score: 0.8646; val_best_acc_score: 0.8057; val_best_f1_score: 0.8184; train_kl_reg_loss: 42554.7826; train_edge_recon_loss: 2855267.1667; train_gene_expr_recon_loss: 711833.9861; train_masked_gp_l1_reg_loss: 5248.9416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64547.8012; train_chrom_access_recon_loss: 1318726.9167; train_global_loss: 4998179.6111; train_optim_loss: 4998179.6111; val_kl_reg_loss: 38911.9727; val_edge_recon_loss: 2886403.5000; val_gene_expr_recon_loss: 722304.1875; val_masked_gp_l1_reg_loss: 5267.1685; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62923.0000; val_chrom_access_recon_loss: 1328569.2500; val_global_loss: 5044379.0000; val_optim_loss: 5044379.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9177; val_auprc_score: 0.8928; val_best_acc_score: 0.8545; val_best_f1_score: 0.8660; train_kl_reg_loss: 39663.9648; train_edge_recon_loss: 2787671.5278; train_gene_expr_recon_loss: 714241.1667; train_masked_gp_l1_reg_loss: 5292.1777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61671.6884; train_chrom_access_recon_loss: 1322835.0000; train_global_loss: 4931375.5000; train_optim_loss: 4931375.5000; val_kl_reg_loss: 41525.9805; val_edge_recon_loss: 2752401.0000; val_gene_expr_recon_loss: 719672.3125; val_masked_gp_l1_reg_loss: 5322.4824; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60141.1641; val_chrom_access_recon_loss: 1326528.3750; val_global_loss: 4905591.5000; val_optim_loss: 4905591.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9301; val_auprc_score: 0.9027; val_best_acc_score: 0.8732; val_best_f1_score: 0.8797; train_kl_reg_loss: 46043.7912; train_edge_recon_loss: 2743060.3056; train_gene_expr_recon_loss: 705898.3056; train_masked_gp_l1_reg_loss: 5349.5044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58965.5369; train_chrom_access_recon_loss: 1317774.9028; train_global_loss: 4877092.3333; train_optim_loss: 4877092.3333; val_kl_reg_loss: 48823.3594; val_edge_recon_loss: 2736058.2500; val_gene_expr_recon_loss: 711351.2500; val_masked_gp_l1_reg_loss: 5372.4312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57516.0234; val_chrom_access_recon_loss: 1322421.0000; val_global_loss: 4881542.0000; val_optim_loss: 4881542.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9371; val_auprc_score: 0.9130; val_best_acc_score: 0.8801; val_best_f1_score: 0.8858; train_kl_reg_loss: 47578.1849; train_edge_recon_loss: 2736549.8333; train_gene_expr_recon_loss: 698403.0833; train_masked_gp_l1_reg_loss: 5386.8247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56398.6502; train_chrom_access_recon_loss: 1309732.4444; train_global_loss: 4854048.9444; train_optim_loss: 4854048.9444; val_kl_reg_loss: 44953.5820; val_edge_recon_loss: 2720758.5000; val_gene_expr_recon_loss: 707010.5000; val_masked_gp_l1_reg_loss: 5398.4092; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55021.7344; val_chrom_access_recon_loss: 1319625.5000; val_global_loss: 4852768.0000; val_optim_loss: 4852768.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9455; val_auprc_score: 0.9294; val_best_acc_score: 0.8891; val_best_f1_score: 0.8955; train_kl_reg_loss: 44133.1454; train_edge_recon_loss: 2733933.7222; train_gene_expr_recon_loss: 700326.3472; train_masked_gp_l1_reg_loss: 5400.5971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53968.6172; train_chrom_access_recon_loss: 1312997.4028; train_global_loss: 4850759.7778; train_optim_loss: 4850759.7778; val_kl_reg_loss: 42198.3633; val_edge_recon_loss: 2702185.2500; val_gene_expr_recon_loss: 705519.0625; val_masked_gp_l1_reg_loss: 5408.8765; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52672.8320; val_chrom_access_recon_loss: 1317506.8750; val_global_loss: 4825491.0000; val_optim_loss: 4825491.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9430; val_auprc_score: 0.9228; val_best_acc_score: 0.8875; val_best_f1_score: 0.8931; train_kl_reg_loss: 42786.0482; train_edge_recon_loss: 2719708.6667; train_gene_expr_recon_loss: 693565.4097; train_masked_gp_l1_reg_loss: 5422.8855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51693.5421; train_chrom_access_recon_loss: 1306328.4306; train_global_loss: 4819504.9444; train_optim_loss: 4819504.9444; val_kl_reg_loss: 42239.7188; val_edge_recon_loss: 2745866.2500; val_gene_expr_recon_loss: 702326.8125; val_masked_gp_l1_reg_loss: 5435.3936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50483.7305; val_chrom_access_recon_loss: 1315189.5000; val_global_loss: 4861541.5000; val_optim_loss: 4861541.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9447; val_auprc_score: 0.9266; val_best_acc_score: 0.8883; val_best_f1_score: 0.8943; train_kl_reg_loss: 42395.8594; train_edge_recon_loss: 2719335.5833; train_gene_expr_recon_loss: 687982.2847; train_masked_gp_l1_reg_loss: 5448.4768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49556.1949; train_chrom_access_recon_loss: 1302373.5833; train_global_loss: 4807091.9444; train_optim_loss: 4807091.9444; val_kl_reg_loss: 41843.9414; val_edge_recon_loss: 2754128.5000; val_gene_expr_recon_loss: 698065.4375; val_masked_gp_l1_reg_loss: 5459.6279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48417.1797; val_chrom_access_recon_loss: 1312899.5000; val_global_loss: 4860814.5000; val_optim_loss: 4860814.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9480; val_auprc_score: 0.9310; val_best_acc_score: 0.8903; val_best_f1_score: 0.8965; train_kl_reg_loss: 41680.8168; train_edge_recon_loss: 2718021.0833; train_gene_expr_recon_loss: 691147.8333; train_masked_gp_l1_reg_loss: 5470.7572; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47542.1788; train_chrom_access_recon_loss: 1305506.2639; train_global_loss: 4809368.8889; train_optim_loss: 4809368.8889; val_kl_reg_loss: 39404.8281; val_edge_recon_loss: 2726057.2500; val_gene_expr_recon_loss: 699555.8125; val_masked_gp_l1_reg_loss: 5484.5659; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46469.2578; val_chrom_access_recon_loss: 1311504.5000; val_global_loss: 4828476.0000; val_optim_loss: 4828476.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9573; val_auprc_score: 0.9416; val_best_acc_score: 0.9060; val_best_f1_score: 0.9110; train_kl_reg_loss: 40172.8997; train_edge_recon_loss: 2717466.9722; train_gene_expr_recon_loss: 687961.5417; train_masked_gp_l1_reg_loss: 5500.7332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45654.2609; train_chrom_access_recon_loss: 1301523.6111; train_global_loss: 4798280.0556; train_optim_loss: 4798280.0556; val_kl_reg_loss: 39323.4531; val_edge_recon_loss: 2679215.7500; val_gene_expr_recon_loss: 695874.6250; val_masked_gp_l1_reg_loss: 5514.1621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44645.1211; val_chrom_access_recon_loss: 1309042.1250; val_global_loss: 4773615.5000; val_optim_loss: 4773615.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9574; val_auprc_score: 0.9423; val_best_acc_score: 0.9034; val_best_f1_score: 0.9078; train_kl_reg_loss: 39014.0352; train_edge_recon_loss: 2715076.3056; train_gene_expr_recon_loss: 965426.4306; train_masked_gp_l1_reg_loss: 5551.8628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43720.6272; train_chrom_access_recon_loss: 1379214.3333; train_global_loss: 5148003.5000; train_optim_loss: 5148003.5000; val_kl_reg_loss: 19252.9961; val_edge_recon_loss: 2709272.5000; val_gene_expr_recon_loss: 963651.7500; val_masked_gp_l1_reg_loss: 5600.1753; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42486.4531; val_chrom_access_recon_loss: 1380449.8750; val_global_loss: 5120714.0000; val_optim_loss: 5120714.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9576; val_auprc_score: 0.9419; val_best_acc_score: 0.9047; val_best_f1_score: 0.9099; train_kl_reg_loss: 35932.0304; train_edge_recon_loss: 2708134.9167; train_gene_expr_recon_loss: 960880.9861; train_masked_gp_l1_reg_loss: 5642.6719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41455.1115; train_chrom_access_recon_loss: 1377929.9167; train_global_loss: 5129975.4444; train_optim_loss: 5129975.4444; val_kl_reg_loss: 18877.3750; val_edge_recon_loss: 2719671.5000; val_gene_expr_recon_loss: 962504.9375; val_masked_gp_l1_reg_loss: 5692.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40171.0547; val_chrom_access_recon_loss: 1378937.8750; val_global_loss: 5125855.0000; val_optim_loss: 5125855.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9634; val_auprc_score: 0.9521; val_best_acc_score: 0.9113; val_best_f1_score: 0.9159; train_kl_reg_loss: 32599.0888; train_edge_recon_loss: 2698203.1944; train_gene_expr_recon_loss: 954244.1736; train_masked_gp_l1_reg_loss: 5730.0760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39172.3885; train_chrom_access_recon_loss: 1376638.0972; train_global_loss: 5106586.8889; train_optim_loss: 5106586.8889; val_kl_reg_loss: 17949.2109; val_edge_recon_loss: 2689940.7500; val_gene_expr_recon_loss: 962113.8750; val_masked_gp_l1_reg_loss: 5772.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37951.5586; val_chrom_access_recon_loss: 1377927.2500; val_global_loss: 5091656.0000; val_optim_loss: 5091656.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9638; val_auprc_score: 0.9506; val_best_acc_score: 0.9143; val_best_f1_score: 0.9185; train_kl_reg_loss: 29615.0202; train_edge_recon_loss: 2693939.1389; train_gene_expr_recon_loss: 957972.2083; train_masked_gp_l1_reg_loss: 5803.2197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37017.2439; train_chrom_access_recon_loss: 1374903.8472; train_global_loss: 5099250.6667; train_optim_loss: 5099250.6667; val_kl_reg_loss: 17866.2637; val_edge_recon_loss: 2682820.2500; val_gene_expr_recon_loss: 958182.7500; val_masked_gp_l1_reg_loss: 5838.9541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35878.6758; val_chrom_access_recon_loss: 1376146.2500; val_global_loss: 5076733.0000; val_optim_loss: 5076733.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9670; val_auprc_score: 0.9544; val_best_acc_score: 0.9166; val_best_f1_score: 0.9205; train_kl_reg_loss: 28174.0556; train_edge_recon_loss: 2679547.3889; train_gene_expr_recon_loss: 955430.8125; train_masked_gp_l1_reg_loss: 5831.5973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35756.3151; train_chrom_access_recon_loss: 1373402.7917; train_global_loss: 5078142.9444; train_optim_loss: 5078142.9444; val_kl_reg_loss: 17659.1484; val_edge_recon_loss: 2681634.2500; val_gene_expr_recon_loss: 962564.3750; val_masked_gp_l1_reg_loss: 5823.1943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35606.0898; val_chrom_access_recon_loss: 1377183.1250; val_global_loss: 5080470.5000; val_optim_loss: 5080470.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9662; val_auprc_score: 0.9521; val_best_acc_score: 0.9165; val_best_f1_score: 0.9200; train_kl_reg_loss: 27852.0013; train_edge_recon_loss: 2673448.2500; train_gene_expr_recon_loss: 951515.9028; train_masked_gp_l1_reg_loss: 5821.0755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35497.9583; train_chrom_access_recon_loss: 1367733.2361; train_global_loss: 5061868.5000; train_optim_loss: 5061868.5000; val_kl_reg_loss: 17718.6953; val_edge_recon_loss: 2690286.7500; val_gene_expr_recon_loss: 960094.1250; val_masked_gp_l1_reg_loss: 5818.2153; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35362.5352; val_chrom_access_recon_loss: 1377038.0000; val_global_loss: 5086318.0000; val_optim_loss: 5086318.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9673; val_auprc_score: 0.9536; val_best_acc_score: 0.9184; val_best_f1_score: 0.9221; train_kl_reg_loss: 27561.2042; train_edge_recon_loss: 2685626.3889; train_gene_expr_recon_loss: 951147.8681; train_masked_gp_l1_reg_loss: 5817.3142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35259.5469; train_chrom_access_recon_loss: 1367109.2222; train_global_loss: 5072521.5556; train_optim_loss: 5072521.5556; val_kl_reg_loss: 17548.5781; val_edge_recon_loss: 2679789.2500; val_gene_expr_recon_loss: 961668.1250; val_masked_gp_l1_reg_loss: 5816.2412; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35132.4453; val_chrom_access_recon_loss: 1377126.8750; val_global_loss: 5077081.5000; val_optim_loss: 5077081.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9685; val_auprc_score: 0.9572; val_best_acc_score: 0.9197; val_best_f1_score: 0.9221; train_kl_reg_loss: 27173.8390; train_edge_recon_loss: 2683618.1667; train_gene_expr_recon_loss: 955277.2569; train_masked_gp_l1_reg_loss: 5815.8379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35033.6723; train_chrom_access_recon_loss: 1375973.8889; train_global_loss: 5082892.7778; train_optim_loss: 5082892.7778; val_kl_reg_loss: 17431.0234; val_edge_recon_loss: 2692450.2500; val_gene_expr_recon_loss: 959489.1250; val_masked_gp_l1_reg_loss: 5815.9175; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34913.3633; val_chrom_access_recon_loss: 1376751.3750; val_global_loss: 5086851.0000; val_optim_loss: 5086851.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9565
val AUPRC score: 0.9425
val best accuracy score: 0.8996
val best F1 score: 0.9054
val target rna MSE score: 3.9586
val source rna MSE score: 3.2395
val target atac MSE score: 0.1388
val source atac MSE score: 0.0214
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
