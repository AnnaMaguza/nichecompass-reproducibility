[True]
Run timestamp: 10102023_030027_119.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_119']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6901; val_auprc_score: 0.6624; val_best_acc_score: 0.5011; val_best_f1_score: 0.6670; train_kl_reg_loss: 53277.1298; train_edge_recon_loss: 3510642.7235; train_gene_expr_recon_loss: 14016463.3636; train_masked_gp_l1_reg_loss: 35587.7340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3634714.7178; train_chrom_access_recon_loss: 11545615.6061; train_global_loss: 32796301.1515; train_optim_loss: 32796301.1515; val_kl_reg_loss: 93560.6426; val_edge_recon_loss: 4065251.2188; val_gene_expr_recon_loss: 12992310.7500; val_masked_gp_l1_reg_loss: 43177.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2015576.6250; val_chrom_access_recon_loss: 11169030.6250; val_global_loss: 30378907.7500; val_optim_loss: 30378907.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6810; val_auprc_score: 0.6614; val_best_acc_score: 0.5911; val_best_f1_score: 0.6944; train_kl_reg_loss: 100810.8073; train_edge_recon_loss: 3519617.3750; train_gene_expr_recon_loss: 12847704.8182; train_masked_gp_l1_reg_loss: 44493.4796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1096787.0530; train_chrom_access_recon_loss: 11021437.3485; train_global_loss: 28630850.8788; train_optim_loss: 28630850.8788; val_kl_reg_loss: 96267.3877; val_edge_recon_loss: 4059178.5938; val_gene_expr_recon_loss: 12573576.8750; val_masked_gp_l1_reg_loss: 45468.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 531105.1875; val_chrom_access_recon_loss: 10971731.6250; val_global_loss: 28277328.5000; val_optim_loss: 28277328.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7533; val_auprc_score: 0.7348; val_best_acc_score: 0.6881; val_best_f1_score: 0.7138; train_kl_reg_loss: 91659.7995; train_edge_recon_loss: 3514167.1023; train_gene_expr_recon_loss: 12706501.0303; train_masked_gp_l1_reg_loss: 46467.1834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 362778.8580; train_chrom_access_recon_loss: 10951285.9848; train_global_loss: 27672859.9394; train_optim_loss: 27672859.9394; val_kl_reg_loss: 97328.0439; val_edge_recon_loss: 4040539.0312; val_gene_expr_recon_loss: 12506523.6250; val_masked_gp_l1_reg_loss: 47317.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 254001.5312; val_chrom_access_recon_loss: 10889082.7500; val_global_loss: 27834793.5000; val_optim_loss: 27834793.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7927; val_auprc_score: 0.7630; val_best_acc_score: 0.7187; val_best_f1_score: 0.7520; train_kl_reg_loss: 80593.6446; train_edge_recon_loss: 3503624.5152; train_gene_expr_recon_loss: 12616172.4848; train_masked_gp_l1_reg_loss: 48722.1867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211237.7438; train_chrom_access_recon_loss: 10879409.2879; train_global_loss: 27339759.7879; train_optim_loss: 27339759.7879; val_kl_reg_loss: 67713.0293; val_edge_recon_loss: 3929269.7500; val_gene_expr_recon_loss: 12423047.8750; val_masked_gp_l1_reg_loss: 49890.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174660.3438; val_chrom_access_recon_loss: 10706608.5000; val_global_loss: 27351189.2500; val_optim_loss: 27351189.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8522; val_auprc_score: 0.8222; val_best_acc_score: 0.7800; val_best_f1_score: 0.8022; train_kl_reg_loss: 65720.6761; train_edge_recon_loss: 3319344.6894; train_gene_expr_recon_loss: 12533668.8333; train_masked_gp_l1_reg_loss: 51619.4335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156044.3703; train_chrom_access_recon_loss: 10803182.8030; train_global_loss: 26929580.6970; train_optim_loss: 26929580.6970; val_kl_reg_loss: 92333.4941; val_edge_recon_loss: 3024440.4688; val_gene_expr_recon_loss: 12406759.5000; val_masked_gp_l1_reg_loss: 54261.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141909.2969; val_chrom_access_recon_loss: 10661244.5000; val_global_loss: 26380949.2500; val_optim_loss: 26380949.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8819; val_auprc_score: 0.8469; val_best_acc_score: 0.8138; val_best_f1_score: 0.8274; train_kl_reg_loss: 101987.0329; train_edge_recon_loss: 2919313.4129; train_gene_expr_recon_loss: 12469198.4697; train_masked_gp_l1_reg_loss: 56231.5464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132022.3991; train_chrom_access_recon_loss: 10752839.8636; train_global_loss: 26431592.7879; train_optim_loss: 26431592.7879; val_kl_reg_loss: 93902.6406; val_edge_recon_loss: 2864711.8125; val_gene_expr_recon_loss: 12315612.8750; val_masked_gp_l1_reg_loss: 57761.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124052.3828; val_chrom_access_recon_loss: 10664752.8750; val_global_loss: 26120794.2500; val_optim_loss: 26120794.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8805; val_auprc_score: 0.8395; val_best_acc_score: 0.8178; val_best_f1_score: 0.8321; train_kl_reg_loss: 103316.0939; train_edge_recon_loss: 2850332.1705; train_gene_expr_recon_loss: 12396999.1364; train_masked_gp_l1_reg_loss: 59000.3619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117772.5871; train_chrom_access_recon_loss: 10696123.3485; train_global_loss: 26223543.8485; train_optim_loss: 26223543.8485; val_kl_reg_loss: 107622.7783; val_edge_recon_loss: 2882166.0000; val_gene_expr_recon_loss: 12147368.7500; val_masked_gp_l1_reg_loss: 59990.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112404.9531; val_chrom_access_recon_loss: 10578637.3750; val_global_loss: 25888189.7500; val_optim_loss: 25888189.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9013; val_auprc_score: 0.8662; val_best_acc_score: 0.8366; val_best_f1_score: 0.8502; train_kl_reg_loss: 104889.6043; train_edge_recon_loss: 2833563.0000; train_gene_expr_recon_loss: 12334272.0000; train_masked_gp_l1_reg_loss: 60915.2103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108560.9271; train_chrom_access_recon_loss: 10660983.1515; train_global_loss: 26103183.8485; train_optim_loss: 26103183.8485; val_kl_reg_loss: 104574.9150; val_edge_recon_loss: 2855921.9062; val_gene_expr_recon_loss: 12036526.5000; val_masked_gp_l1_reg_loss: 61833.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105871.4922; val_chrom_access_recon_loss: 10440141.6250; val_global_loss: 25604868.7500; val_optim_loss: 25604868.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9010; val_auprc_score: 0.8738; val_best_acc_score: 0.8353; val_best_f1_score: 0.8463; train_kl_reg_loss: 102790.4131; train_edge_recon_loss: 2821920.7614; train_gene_expr_recon_loss: 12269057.7121; train_masked_gp_l1_reg_loss: 62608.6613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103301.4693; train_chrom_access_recon_loss: 10610685.2424; train_global_loss: 25970364.2727; train_optim_loss: 25970364.2727; val_kl_reg_loss: 101601.8203; val_edge_recon_loss: 2870882.7188; val_gene_expr_recon_loss: 12108582.3750; val_masked_gp_l1_reg_loss: 63425.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100553.3359; val_chrom_access_recon_loss: 10562716.1250; val_global_loss: 25807762.2500; val_optim_loss: 25807762.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8994; val_auprc_score: 0.8557; val_best_acc_score: 0.8407; val_best_f1_score: 0.8525; train_kl_reg_loss: 101079.9421; train_edge_recon_loss: 2811222.1174; train_gene_expr_recon_loss: 12209376.2121; train_masked_gp_l1_reg_loss: 64089.1065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98512.2433; train_chrom_access_recon_loss: 10560792.0000; train_global_loss: 25845071.5455; train_optim_loss: 25845071.5455; val_kl_reg_loss: 95844.3252; val_edge_recon_loss: 2852726.0625; val_gene_expr_recon_loss: 11956490.6250; val_masked_gp_l1_reg_loss: 64831.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97249.3125; val_chrom_access_recon_loss: 10511505.1250; val_global_loss: 25578646.7500; val_optim_loss: 25578646.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9076; val_auprc_score: 0.8766; val_best_acc_score: 0.8415; val_best_f1_score: 0.8539; train_kl_reg_loss: 98217.0277; train_edge_recon_loss: 2800077.9167; train_gene_expr_recon_loss: 12162236.4545; train_masked_gp_l1_reg_loss: 65531.0676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95257.3478; train_chrom_access_recon_loss: 10525582.3333; train_global_loss: 25746902.2424; train_optim_loss: 25746902.2424; val_kl_reg_loss: 99183.3008; val_edge_recon_loss: 2835935.0312; val_gene_expr_recon_loss: 12026094.6250; val_masked_gp_l1_reg_loss: 66282.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93540.4375; val_chrom_access_recon_loss: 10424935.0000; val_global_loss: 25545971.2500; val_optim_loss: 25545971.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9124; val_auprc_score: 0.8764; val_best_acc_score: 0.8512; val_best_f1_score: 0.8633; train_kl_reg_loss: 95864.3833; train_edge_recon_loss: 2795919.6818; train_gene_expr_recon_loss: 12119025.0152; train_masked_gp_l1_reg_loss: 66798.9570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91309.2700; train_chrom_access_recon_loss: 10483151.6818; train_global_loss: 25652068.7576; train_optim_loss: 25652068.7576; val_kl_reg_loss: 93003.4678; val_edge_recon_loss: 2822623.5000; val_gene_expr_recon_loss: 11998058.7500; val_masked_gp_l1_reg_loss: 67487.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89754.7812; val_chrom_access_recon_loss: 10456547.7500; val_global_loss: 25527476.0000; val_optim_loss: 25527476.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9192; val_auprc_score: 0.8916; val_best_acc_score: 0.8592; val_best_f1_score: 0.8684; train_kl_reg_loss: 92584.9000; train_edge_recon_loss: 2786555.4962; train_gene_expr_recon_loss: 12074566.0758; train_masked_gp_l1_reg_loss: 68099.6635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88085.3598; train_chrom_access_recon_loss: 10455916.9848; train_global_loss: 25565808.3333; train_optim_loss: 25565808.3333; val_kl_reg_loss: 93718.6660; val_edge_recon_loss: 2813274.1250; val_gene_expr_recon_loss: 11913671.6250; val_masked_gp_l1_reg_loss: 68683.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86586.9609; val_chrom_access_recon_loss: 10368031.0000; val_global_loss: 25343966.2500; val_optim_loss: 25343966.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9178; val_auprc_score: 0.8854; val_best_acc_score: 0.8579; val_best_f1_score: 0.8653; train_kl_reg_loss: 92297.3260; train_edge_recon_loss: 2776954.8788; train_gene_expr_recon_loss: 12047369.4091; train_masked_gp_l1_reg_loss: 69177.4512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85064.6054; train_chrom_access_recon_loss: 10436869.0000; train_global_loss: 25507732.5455; train_optim_loss: 25507732.5455; val_kl_reg_loss: 91712.8242; val_edge_recon_loss: 2786669.1562; val_gene_expr_recon_loss: 11900202.1250; val_masked_gp_l1_reg_loss: 69758.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84048.4609; val_chrom_access_recon_loss: 10337235.5000; val_global_loss: 25269625.7500; val_optim_loss: 25269625.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9110; val_auprc_score: 0.8701; val_best_acc_score: 0.8560; val_best_f1_score: 0.8667; train_kl_reg_loss: 90810.5233; train_edge_recon_loss: 2770581.2159; train_gene_expr_recon_loss: 11999300.1061; train_masked_gp_l1_reg_loss: 70221.3300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82893.8101; train_chrom_access_recon_loss: 10392777.1364; train_global_loss: 25406584.0909; train_optim_loss: 25406584.0909; val_kl_reg_loss: 91900.0596; val_edge_recon_loss: 2807306.0312; val_gene_expr_recon_loss: 11917043.8750; val_masked_gp_l1_reg_loss: 70718.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81697.2266; val_chrom_access_recon_loss: 10389484.2500; val_global_loss: 25358149.0000; val_optim_loss: 25358149.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9179; val_auprc_score: 0.8869; val_best_acc_score: 0.8606; val_best_f1_score: 0.8705; train_kl_reg_loss: 89928.8756; train_edge_recon_loss: 2765496.7348; train_gene_expr_recon_loss: 11962218.5758; train_masked_gp_l1_reg_loss: 71095.9210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80763.3739; train_chrom_access_recon_loss: 10359453.6818; train_global_loss: 25328957.1515; train_optim_loss: 25328957.1515; val_kl_reg_loss: 89202.0625; val_edge_recon_loss: 2788462.5312; val_gene_expr_recon_loss: 11798216.2500; val_masked_gp_l1_reg_loss: 71595.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79854.6406; val_chrom_access_recon_loss: 10276315.2500; val_global_loss: 25103646.0000; val_optim_loss: 25103646.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9238; val_auprc_score: 0.8904; val_best_acc_score: 0.8710; val_best_f1_score: 0.8774; train_kl_reg_loss: 88893.6388; train_edge_recon_loss: 2750500.0985; train_gene_expr_recon_loss: 11942447.6515; train_masked_gp_l1_reg_loss: 72001.2859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78784.7564; train_chrom_access_recon_loss: 10332928.4848; train_global_loss: 25265555.7576; train_optim_loss: 25265555.7576; val_kl_reg_loss: 90795.5303; val_edge_recon_loss: 2767523.4375; val_gene_expr_recon_loss: 11792964.6250; val_masked_gp_l1_reg_loss: 72405.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78024.8125; val_chrom_access_recon_loss: 10308033.5000; val_global_loss: 25109747.0000; val_optim_loss: 25109747.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9335; val_auprc_score: 0.9086; val_best_acc_score: 0.8837; val_best_f1_score: 0.8907; train_kl_reg_loss: 88227.8372; train_edge_recon_loss: 2752863.7992; train_gene_expr_recon_loss: 11914857.6970; train_masked_gp_l1_reg_loss: 72699.0798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77196.7476; train_chrom_access_recon_loss: 10309585.4242; train_global_loss: 25215430.4848; train_optim_loss: 25215430.4848; val_kl_reg_loss: 86784.1934; val_edge_recon_loss: 2739402.4688; val_gene_expr_recon_loss: 11797701.1250; val_masked_gp_l1_reg_loss: 73084.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76550.8516; val_chrom_access_recon_loss: 10286410.0000; val_global_loss: 25059933.5000; val_optim_loss: 25059933.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9231; val_auprc_score: 0.8967; val_best_acc_score: 0.8649; val_best_f1_score: 0.8702; train_kl_reg_loss: 86481.3466; train_edge_recon_loss: 2730112.6705; train_gene_expr_recon_loss: 11869570.7273; train_masked_gp_l1_reg_loss: 73416.1945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75857.8978; train_chrom_access_recon_loss: 10264164.6515; train_global_loss: 25099603.5152; train_optim_loss: 25099603.5152; val_kl_reg_loss: 85012.1768; val_edge_recon_loss: 2780551.6562; val_gene_expr_recon_loss: 11710196.7500; val_masked_gp_l1_reg_loss: 73797.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75925.7734; val_chrom_access_recon_loss: 10169163.7500; val_global_loss: 24894648.2500; val_optim_loss: 24894648.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9321; val_auprc_score: 0.9051; val_best_acc_score: 0.8729; val_best_f1_score: 0.8816; train_kl_reg_loss: 86817.7090; train_edge_recon_loss: 2734325.2121; train_gene_expr_recon_loss: 11853297.2576; train_masked_gp_l1_reg_loss: 74067.4273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74851.4322; train_chrom_access_recon_loss: 10240871.2576; train_global_loss: 25064230.1818; train_optim_loss: 25064230.1818; val_kl_reg_loss: 88532.8164; val_edge_recon_loss: 2760085.9688; val_gene_expr_recon_loss: 11732892.1250; val_masked_gp_l1_reg_loss: 74330.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74530.7812; val_chrom_access_recon_loss: 10218066.6250; val_global_loss: 24948439.5000; val_optim_loss: 24948439.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9380; val_auprc_score: 0.9152; val_best_acc_score: 0.8834; val_best_f1_score: 0.8902; train_kl_reg_loss: 85980.5563; train_edge_recon_loss: 2731219.0492; train_gene_expr_recon_loss: 11828100.6515; train_masked_gp_l1_reg_loss: 74637.6529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73864.7586; train_chrom_access_recon_loss: 10223328.0606; train_global_loss: 25017130.8788; train_optim_loss: 25017130.8788; val_kl_reg_loss: 86881.2969; val_edge_recon_loss: 2740111.8125; val_gene_expr_recon_loss: 11611145.8750; val_masked_gp_l1_reg_loss: 75006.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73227.5312; val_chrom_access_recon_loss: 10156517.7500; val_global_loss: 24742891.7500; val_optim_loss: 24742891.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9356; val_auprc_score: 0.9104; val_best_acc_score: 0.8842; val_best_f1_score: 0.8907; train_kl_reg_loss: 83574.4860; train_edge_recon_loss: 2736730.8295; train_gene_expr_recon_loss: 11807550.1818; train_masked_gp_l1_reg_loss: 75136.1740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72821.8654; train_chrom_access_recon_loss: 10190072.6212; train_global_loss: 24965886.0000; train_optim_loss: 24965886.0000; val_kl_reg_loss: 87340.2451; val_edge_recon_loss: 2747645.5312; val_gene_expr_recon_loss: 11677368.8750; val_masked_gp_l1_reg_loss: 75402.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72436.1953; val_chrom_access_recon_loss: 10147735.3750; val_global_loss: 24807929.2500; val_optim_loss: 24807929.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9264; val_auprc_score: 0.8989; val_best_acc_score: 0.8678; val_best_f1_score: 0.8751; train_kl_reg_loss: 85410.0018; train_edge_recon_loss: 2719085.4280; train_gene_expr_recon_loss: 11779874.7424; train_masked_gp_l1_reg_loss: 75573.4380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72181.4080; train_chrom_access_recon_loss: 10163573.9091; train_global_loss: 24895698.8182; train_optim_loss: 24895698.8182; val_kl_reg_loss: 85228.8916; val_edge_recon_loss: 2786041.2188; val_gene_expr_recon_loss: 11633906.5000; val_masked_gp_l1_reg_loss: 75853.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71791.3203; val_chrom_access_recon_loss: 10058839.5000; val_global_loss: 24711661.5000; val_optim_loss: 24711661.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9382; val_auprc_score: 0.9122; val_best_acc_score: 0.8807; val_best_f1_score: 0.8871; train_kl_reg_loss: 84642.2921; train_edge_recon_loss: 2722202.6098; train_gene_expr_recon_loss: 11753220.4394; train_masked_gp_l1_reg_loss: 76019.5955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71545.3336; train_chrom_access_recon_loss: 10135845.8939; train_global_loss: 24843476.1515; train_optim_loss: 24843476.1515; val_kl_reg_loss: 85279.2314; val_edge_recon_loss: 2763524.7500; val_gene_expr_recon_loss: 11649123.1250; val_masked_gp_l1_reg_loss: 76211.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71388.0625; val_chrom_access_recon_loss: 10124996.8750; val_global_loss: 24770523.0000; val_optim_loss: 24770523.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9411; val_auprc_score: 0.9178; val_best_acc_score: 0.8896; val_best_f1_score: 0.8959; train_kl_reg_loss: 82350.3730; train_edge_recon_loss: 2725503.3788; train_gene_expr_recon_loss: 11736998.6212; train_masked_gp_l1_reg_loss: 76444.5732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71222.8018; train_chrom_access_recon_loss: 10101918.3788; train_global_loss: 24794438.0606; train_optim_loss: 24794438.0606; val_kl_reg_loss: 81808.3691; val_edge_recon_loss: 2734120.8750; val_gene_expr_recon_loss: 11611867.1250; val_masked_gp_l1_reg_loss: 76730.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71233.8984; val_chrom_access_recon_loss: 10100761.3750; val_global_loss: 24676522.7500; val_optim_loss: 24676522.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9432; val_auprc_score: 0.9230; val_best_acc_score: 0.8864; val_best_f1_score: 0.8916; train_kl_reg_loss: 106115.3562; train_edge_recon_loss: 2818754.3864; train_gene_expr_recon_loss: 10861423.7424; train_masked_gp_l1_reg_loss: 76870.6587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70867.1057; train_chrom_access_recon_loss: 9488138.1818; train_global_loss: 23422169.3939; train_optim_loss: 23422169.3939; val_kl_reg_loss: 34548.2085; val_edge_recon_loss: 2764611.7812; val_gene_expr_recon_loss: 10641094.0000; val_masked_gp_l1_reg_loss: 76611.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70777.6094; val_chrom_access_recon_loss: 9355623.7500; val_global_loss: 22943268.5000; val_optim_loss: 22943268.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9426; val_auprc_score: 0.9190; val_best_acc_score: 0.8869; val_best_f1_score: 0.8921; train_kl_reg_loss: 91624.9453; train_edge_recon_loss: 2747202.5076; train_gene_expr_recon_loss: 10806256.7273; train_masked_gp_l1_reg_loss: 76145.3137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70612.5708; train_chrom_access_recon_loss: 9400666.0606; train_global_loss: 23192508.0909; train_optim_loss: 23192508.0909; val_kl_reg_loss: 40073.0151; val_edge_recon_loss: 2753862.8438; val_gene_expr_recon_loss: 10718473.5000; val_masked_gp_l1_reg_loss: 75697.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70259.6484; val_chrom_access_recon_loss: 9343376.5000; val_global_loss: 23001743.7500; val_optim_loss: 23001743.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9383; val_auprc_score: 0.9164; val_best_acc_score: 0.8767; val_best_f1_score: 0.8835; train_kl_reg_loss: 78172.1948; train_edge_recon_loss: 2734513.7689; train_gene_expr_recon_loss: 10794397.4545; train_masked_gp_l1_reg_loss: 75309.2934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69713.1125; train_chrom_access_recon_loss: 9388837.5455; train_global_loss: 23140943.3030; train_optim_loss: 23140943.3030; val_kl_reg_loss: 43738.4585; val_edge_recon_loss: 2770068.7188; val_gene_expr_recon_loss: 10734732.1250; val_masked_gp_l1_reg_loss: 74948.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69739.0234; val_chrom_access_recon_loss: 9328997.7500; val_global_loss: 23022223.7500; val_optim_loss: 23022223.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9359; val_auprc_score: 0.9117; val_best_acc_score: 0.8780; val_best_f1_score: 0.8848; train_kl_reg_loss: 72042.0449; train_edge_recon_loss: 2724041.0758; train_gene_expr_recon_loss: 10779070.6212; train_masked_gp_l1_reg_loss: 74586.3958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69291.0702; train_chrom_access_recon_loss: 9375251.8485; train_global_loss: 23094282.9697; train_optim_loss: 23094282.9697; val_kl_reg_loss: 46530.5610; val_edge_recon_loss: 2742887.1250; val_gene_expr_recon_loss: 10625872.0000; val_masked_gp_l1_reg_loss: 74220.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69112.5469; val_chrom_access_recon_loss: 9265712.1250; val_global_loss: 22824334.7500; val_optim_loss: 22824334.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9404; val_auprc_score: 0.9182; val_best_acc_score: 0.8802; val_best_f1_score: 0.8882; train_kl_reg_loss: 67817.2753; train_edge_recon_loss: 2726412.4394; train_gene_expr_recon_loss: 10751816.8485; train_masked_gp_l1_reg_loss: 73823.4782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68415.9237; train_chrom_access_recon_loss: 9358026.3333; train_global_loss: 23046312.2424; train_optim_loss: 23046312.2424; val_kl_reg_loss: 48377.7769; val_edge_recon_loss: 2746843.4062; val_gene_expr_recon_loss: 10755849.0000; val_masked_gp_l1_reg_loss: 73444.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67931.9609; val_chrom_access_recon_loss: 9404267.5000; val_global_loss: 23096713.5000; val_optim_loss: 23096713.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9405; val_auprc_score: 0.9147; val_best_acc_score: 0.8858; val_best_f1_score: 0.8929; train_kl_reg_loss: 66511.9121; train_edge_recon_loss: 2701279.8144; train_gene_expr_recon_loss: 10745857.7121; train_masked_gp_l1_reg_loss: 73219.8120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67665.1706; train_chrom_access_recon_loss: 9346033.0758; train_global_loss: 23000567.2727; train_optim_loss: 23000567.2727; val_kl_reg_loss: 50038.0278; val_edge_recon_loss: 2740555.4062; val_gene_expr_recon_loss: 10690736.8750; val_masked_gp_l1_reg_loss: 72918.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67620.6094; val_chrom_access_recon_loss: 9439182.5000; val_global_loss: 23061052.0000; val_optim_loss: 23061052.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9412; val_auprc_score: 0.9173; val_best_acc_score: 0.8864; val_best_f1_score: 0.8917; train_kl_reg_loss: 65434.6772; train_edge_recon_loss: 2709165.2386; train_gene_expr_recon_loss: 10732684.0000; train_masked_gp_l1_reg_loss: 72565.1667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67201.0022; train_chrom_access_recon_loss: 9326084.0606; train_global_loss: 22973134.0909; train_optim_loss: 22973134.0909; val_kl_reg_loss: 49782.2422; val_edge_recon_loss: 2750925.4375; val_gene_expr_recon_loss: 10710584.6250; val_masked_gp_l1_reg_loss: 72310.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67218.5781; val_chrom_access_recon_loss: 9384345.7500; val_global_loss: 23035168.2500; val_optim_loss: 23035168.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9387; val_auprc_score: 0.9101; val_best_acc_score: 0.8794; val_best_f1_score: 0.8859; train_kl_reg_loss: 63119.6323; train_edge_recon_loss: 2708821.2879; train_gene_expr_recon_loss: 10716729.6212; train_masked_gp_l1_reg_loss: 71986.2913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66840.6791; train_chrom_access_recon_loss: 9321234.8333; train_global_loss: 22948732.3636; train_optim_loss: 22948732.3636; val_kl_reg_loss: 51134.3784; val_edge_recon_loss: 2738725.5000; val_gene_expr_recon_loss: 10693763.0000; val_masked_gp_l1_reg_loss: 71710.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66428.3047; val_chrom_access_recon_loss: 9385762.0000; val_global_loss: 23007522.7500; val_optim_loss: 23007522.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9499; val_auprc_score: 0.9225; val_best_acc_score: 0.8968; val_best_f1_score: 0.9020; train_kl_reg_loss: 62753.4277; train_edge_recon_loss: 2697904.5758; train_gene_expr_recon_loss: 10703408.6970; train_masked_gp_l1_reg_loss: 71396.4678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57358.7904; train_chrom_access_recon_loss: 9294981.0303; train_global_loss: 22887802.9091; train_optim_loss: 22887802.9091; val_kl_reg_loss: 52135.5215; val_edge_recon_loss: 2717040.8750; val_gene_expr_recon_loss: 10525735.7500; val_masked_gp_l1_reg_loss: 71245.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55437.1641; val_chrom_access_recon_loss: 9246052.0000; val_global_loss: 22667646.0000; val_optim_loss: 22667646.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9471; val_auprc_score: 0.9243; val_best_acc_score: 0.8901; val_best_f1_score: 0.8949; train_kl_reg_loss: 64047.0691; train_edge_recon_loss: 2685477.0947; train_gene_expr_recon_loss: 10701395.3333; train_masked_gp_l1_reg_loss: 71181.4370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55174.3411; train_chrom_access_recon_loss: 9303669.5000; train_global_loss: 22880944.6667; train_optim_loss: 22880944.6667; val_kl_reg_loss: 53165.4917; val_edge_recon_loss: 2709538.4688; val_gene_expr_recon_loss: 10565397.7500; val_masked_gp_l1_reg_loss: 71124.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54950.7930; val_chrom_access_recon_loss: 9281136.5000; val_global_loss: 22735314.0000; val_optim_loss: 22735314.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9475; val_auprc_score: 0.9258; val_best_acc_score: 0.8933; val_best_f1_score: 0.8954; train_kl_reg_loss: 64391.9962; train_edge_recon_loss: 2696922.9470; train_gene_expr_recon_loss: 10689072.1667; train_masked_gp_l1_reg_loss: 71080.6502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54807.1141; train_chrom_access_recon_loss: 9294658.9545; train_global_loss: 22870933.9091; train_optim_loss: 22870933.9091; val_kl_reg_loss: 53602.7407; val_edge_recon_loss: 2717294.7812; val_gene_expr_recon_loss: 10588289.7500; val_masked_gp_l1_reg_loss: 71041.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54656.6797; val_chrom_access_recon_loss: 9316464.1250; val_global_loss: 22801350.0000; val_optim_loss: 22801350.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9468; val_auprc_score: 0.9228; val_best_acc_score: 0.8955; val_best_f1_score: 0.9006; train_kl_reg_loss: 64332.5105; train_edge_recon_loss: 2685214.8030; train_gene_expr_recon_loss: 10697637.6364; train_masked_gp_l1_reg_loss: 71004.6106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54565.8762; train_chrom_access_recon_loss: 9298940.7727; train_global_loss: 22871696.0909; train_optim_loss: 22871696.0909; val_kl_reg_loss: 53695.2158; val_edge_recon_loss: 2694946.5938; val_gene_expr_recon_loss: 10566292.5000; val_masked_gp_l1_reg_loss: 70966.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54468.5664; val_chrom_access_recon_loss: 9245664.1250; val_global_loss: 22686033.2500; val_optim_loss: 22686033.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9437; val_auprc_score: 0.9166; val_best_acc_score: 0.8898; val_best_f1_score: 0.8958; train_kl_reg_loss: 63861.8352; train_edge_recon_loss: 2693650.0189; train_gene_expr_recon_loss: 10688062.0455; train_masked_gp_l1_reg_loss: 70937.6776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54413.6607; train_chrom_access_recon_loss: 9284478.8182; train_global_loss: 22855403.9697; train_optim_loss: 22855403.9697; val_kl_reg_loss: 53631.9658; val_edge_recon_loss: 2713464.3438; val_gene_expr_recon_loss: 10437683.8750; val_masked_gp_l1_reg_loss: 70901.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54340.5312; val_chrom_access_recon_loss: 9174718.3750; val_global_loss: 22504741.7500; val_optim_loss: 22504741.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9395; val_auprc_score: 0.9125; val_best_acc_score: 0.8888; val_best_f1_score: 0.8939; train_kl_reg_loss: 64373.7424; train_edge_recon_loss: 2696637.3485; train_gene_expr_recon_loss: 10679009.0000; train_masked_gp_l1_reg_loss: 70855.3129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54215.6010; train_chrom_access_recon_loss: 9283012.7121; train_global_loss: 22848103.6061; train_optim_loss: 22848103.6061; val_kl_reg_loss: 54030.4004; val_edge_recon_loss: 2723616.0938; val_gene_expr_recon_loss: 10506983.5000; val_masked_gp_l1_reg_loss: 70813.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54132.7969; val_chrom_access_recon_loss: 9257054.8750; val_global_loss: 22666632.2500; val_optim_loss: 22666632.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9435; val_auprc_score: 0.9160; val_best_acc_score: 0.8896; val_best_f1_score: 0.8955; train_kl_reg_loss: 64111.1977; train_edge_recon_loss: 2690668.6136; train_gene_expr_recon_loss: 10673515.7576; train_masked_gp_l1_reg_loss: 70769.9814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54079.4103; train_chrom_access_recon_loss: 9256152.0758; train_global_loss: 22809297.0606; train_optim_loss: 22809297.0606; val_kl_reg_loss: 54101.4019; val_edge_recon_loss: 2703370.4375; val_gene_expr_recon_loss: 10550992.5000; val_masked_gp_l1_reg_loss: 70727.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53986.2930; val_chrom_access_recon_loss: 9269549.1250; val_global_loss: 22702727.5000; val_optim_loss: 22702727.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9478; val_auprc_score: 0.9261; val_best_acc_score: 0.8936; val_best_f1_score: 0.8980; train_kl_reg_loss: 64292.1149; train_edge_recon_loss: 2684392.7917; train_gene_expr_recon_loss: 10677641.8939; train_masked_gp_l1_reg_loss: 70684.5552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53880.3152; train_chrom_access_recon_loss: 9270504.5152; train_global_loss: 22821396.2121; train_optim_loss: 22821396.2121; val_kl_reg_loss: 54670.4316; val_edge_recon_loss: 2726868.4688; val_gene_expr_recon_loss: 10557250.3750; val_masked_gp_l1_reg_loss: 70647.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53824.9922; val_chrom_access_recon_loss: 9220305.3750; val_global_loss: 22683568.0000; val_optim_loss: 22683568.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9462; val_auprc_score: 0.9241; val_best_acc_score: 0.8898; val_best_f1_score: 0.8928; train_kl_reg_loss: 63842.5347; train_edge_recon_loss: 2694363.6818; train_gene_expr_recon_loss: 10671115.0606; train_masked_gp_l1_reg_loss: 70600.2313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53780.2911; train_chrom_access_recon_loss: 9264999.9545; train_global_loss: 22818701.6970; train_optim_loss: 22818701.6970; val_kl_reg_loss: 54693.6987; val_edge_recon_loss: 2739602.5938; val_gene_expr_recon_loss: 10580265.2500; val_masked_gp_l1_reg_loss: 70559.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53719.8945; val_chrom_access_recon_loss: 9268623.7500; val_global_loss: 22767465.5000; val_optim_loss: 22767465.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9464; val_auprc_score: 0.9246; val_best_acc_score: 0.8904; val_best_f1_score: 0.8944; train_kl_reg_loss: 63591.9387; train_edge_recon_loss: 2692038.5076; train_gene_expr_recon_loss: 10665934.0909; train_masked_gp_l1_reg_loss: 70528.0014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52717.3577; train_chrom_access_recon_loss: 9261160.7121; train_global_loss: 22805970.4848; train_optim_loss: 22805970.4848; val_kl_reg_loss: 54623.9307; val_edge_recon_loss: 2750914.2812; val_gene_expr_recon_loss: 10582285.5000; val_masked_gp_l1_reg_loss: 70511.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52499.4688; val_chrom_access_recon_loss: 9256105.2500; val_global_loss: 22766939.2500; val_optim_loss: 22766939.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9518; val_auprc_score: 0.9335; val_best_acc_score: 0.8979; val_best_f1_score: 0.8999; train_kl_reg_loss: 63791.0636; train_edge_recon_loss: 2683231.5833; train_gene_expr_recon_loss: 10672634.7576; train_masked_gp_l1_reg_loss: 70504.5704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52468.6650; train_chrom_access_recon_loss: 9262816.2727; train_global_loss: 22805447.1515; train_optim_loss: 22805447.1515; val_kl_reg_loss: 55055.0356; val_edge_recon_loss: 2693719.5938; val_gene_expr_recon_loss: 10708152.5000; val_masked_gp_l1_reg_loss: 70497.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52439.3398; val_chrom_access_recon_loss: 9299632.5000; val_global_loss: 22879497.0000; val_optim_loss: 22879497.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9432; val_auprc_score: 0.9148; val_best_acc_score: 0.8904; val_best_f1_score: 0.8944; train_kl_reg_loss: 63709.5352; train_edge_recon_loss: 2690397.3977; train_gene_expr_recon_loss: 10670733.1212; train_masked_gp_l1_reg_loss: 70492.8267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52417.4656; train_chrom_access_recon_loss: 9269504.5909; train_global_loss: 22817254.9697; train_optim_loss: 22817254.9697; val_kl_reg_loss: 54791.1250; val_edge_recon_loss: 2742709.0625; val_gene_expr_recon_loss: 10555597.5000; val_masked_gp_l1_reg_loss: 70486.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52393.8047; val_chrom_access_recon_loss: 9227203.2500; val_global_loss: 22703180.7500; val_optim_loss: 22703180.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9400; val_auprc_score: 0.9138; val_best_acc_score: 0.8890; val_best_f1_score: 0.8953; train_kl_reg_loss: 63732.4480; train_edge_recon_loss: 2690394.3826; train_gene_expr_recon_loss: 10663298.7121; train_masked_gp_l1_reg_loss: 70481.0205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52378.2794; train_chrom_access_recon_loss: 9260362.9545; train_global_loss: 22800647.6061; train_optim_loss: 22800647.6061; val_kl_reg_loss: 54606.2930; val_edge_recon_loss: 2706926.0625; val_gene_expr_recon_loss: 10539116.0000; val_masked_gp_l1_reg_loss: 70475.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52362.5078; val_chrom_access_recon_loss: 9200334.5000; val_global_loss: 22623820.7500; val_optim_loss: 22623820.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 59 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9501
val AUPRC score: 0.9241
val best accuracy score: 0.8976
val best F1 score: 0.9010
val target rna MSE score: 2.0205
val source rna MSE score: 1.0938
val target atac MSE score: 0.3176
val source atac MSE score: 0.1336
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
