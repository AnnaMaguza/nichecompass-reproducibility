[True]
Run timestamp: 27072023_060917_16.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8437; val_auprc_score: 0.9647; val_best_acc_score: 0.8515; val_best_f1_score: 0.9195; train_kl_reg_loss: 86177.9903; train_edge_recon_loss: 117908.9759; train_gene_expr_recon_loss: 1450070.7186; train_masked_gp_l1_reg_loss: 5999.1328; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1660156.8209; train_optim_loss: 1660156.8209; val_kl_reg_loss: 71304.5218; val_edge_recon_loss: 123508.5553; val_gene_expr_recon_loss: 1054524.1875; val_masked_gp_l1_reg_loss: 5141.9336; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1254479.1354; val_optim_loss: 1254479.1354
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8428; val_auprc_score: 0.9672; val_best_acc_score: 0.8676; val_best_f1_score: 0.9277; train_kl_reg_loss: 58036.8391; train_edge_recon_loss: 117911.3719; train_gene_expr_recon_loss: 1009872.6884; train_masked_gp_l1_reg_loss: 5247.5963; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1191068.4971; train_optim_loss: 1191068.4971; val_kl_reg_loss: 48743.9263; val_edge_recon_loss: 114541.8480; val_gene_expr_recon_loss: 967599.8411; val_masked_gp_l1_reg_loss: 5482.7002; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1136368.3646; val_optim_loss: 1136368.3646
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8567; val_auprc_score: 0.9690; val_best_acc_score: 0.8622; val_best_f1_score: 0.9236; train_kl_reg_loss: 43870.7467; train_edge_recon_loss: 114435.7121; train_gene_expr_recon_loss: 943470.8340; train_masked_gp_l1_reg_loss: 5736.0087; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1107513.3012; train_optim_loss: 1107513.3012; val_kl_reg_loss: 39764.4163; val_edge_recon_loss: 118841.7194; val_gene_expr_recon_loss: 917311.2266; val_masked_gp_l1_reg_loss: 6005.0562; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1081922.3438; val_optim_loss: 1081922.3438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8638; val_auprc_score: 0.9706; val_best_acc_score: 0.8684; val_best_f1_score: 0.9271; train_kl_reg_loss: 36596.2282; train_edge_recon_loss: 112299.2122; train_gene_expr_recon_loss: 901944.5497; train_masked_gp_l1_reg_loss: 6258.5703; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1057098.5558; train_optim_loss: 1057098.5558; val_kl_reg_loss: 34182.4165; val_edge_recon_loss: 114018.1992; val_gene_expr_recon_loss: 883696.2708; val_masked_gp_l1_reg_loss: 6502.6621; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1038399.5573; val_optim_loss: 1038399.5573
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8764; val_auprc_score: 0.9741; val_best_acc_score: 0.8764; val_best_f1_score: 0.9313; train_kl_reg_loss: 32357.6503; train_edge_recon_loss: 109216.9104; train_gene_expr_recon_loss: 873088.7070; train_masked_gp_l1_reg_loss: 6727.8199; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1021391.0901; train_optim_loss: 1021391.0901; val_kl_reg_loss: 30705.1497; val_edge_recon_loss: 110511.9365; val_gene_expr_recon_loss: 859120.3099; val_masked_gp_l1_reg_loss: 6949.4658; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1007286.8281; val_optim_loss: 1007286.8281
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8840; val_auprc_score: 0.9768; val_best_acc_score: 0.8827; val_best_f1_score: 0.9349; train_kl_reg_loss: 29640.7599; train_edge_recon_loss: 107325.6445; train_gene_expr_recon_loss: 850719.4701; train_masked_gp_l1_reg_loss: 7170.3456; train_group_lasso_reg_loss: 0.0000; train_global_loss: 994856.2189; train_optim_loss: 994856.2189; val_kl_reg_loss: 28511.4439; val_edge_recon_loss: 104586.8590; val_gene_expr_recon_loss: 838137.3698; val_masked_gp_l1_reg_loss: 7392.7271; val_group_lasso_reg_loss: 0.0000; val_global_loss: 978628.4167; val_optim_loss: 978628.4167
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8935; val_auprc_score: 0.9774; val_best_acc_score: 0.8849; val_best_f1_score: 0.9349; train_kl_reg_loss: 27612.0812; train_edge_recon_loss: 104593.2992; train_gene_expr_recon_loss: 830968.0326; train_masked_gp_l1_reg_loss: 7606.4866; train_group_lasso_reg_loss: 0.0000; train_global_loss: 970779.9000; train_optim_loss: 970779.9000; val_kl_reg_loss: 26355.0333; val_edge_recon_loss: 107233.6442; val_gene_expr_recon_loss: 821425.1276; val_masked_gp_l1_reg_loss: 7810.8228; val_group_lasso_reg_loss: 0.0000; val_global_loss: 962824.6198; val_optim_loss: 962824.6198
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9026; val_auprc_score: 0.9805; val_best_acc_score: 0.8980; val_best_f1_score: 0.9420; train_kl_reg_loss: 25932.3273; train_edge_recon_loss: 103008.1056; train_gene_expr_recon_loss: 813991.4436; train_masked_gp_l1_reg_loss: 8000.4793; train_group_lasso_reg_loss: 0.0000; train_global_loss: 950932.3547; train_optim_loss: 950932.3547; val_kl_reg_loss: 25196.8914; val_edge_recon_loss: 99864.6800; val_gene_expr_recon_loss: 804498.2526; val_masked_gp_l1_reg_loss: 8187.1602; val_group_lasso_reg_loss: 0.0000; val_global_loss: 937747.0104; val_optim_loss: 937747.0104
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9080; val_auprc_score: 0.9804; val_best_acc_score: 0.9045; val_best_f1_score: 0.9454; train_kl_reg_loss: 24490.3690; train_edge_recon_loss: 101286.1092; train_gene_expr_recon_loss: 799422.3346; train_masked_gp_l1_reg_loss: 8367.9589; train_group_lasso_reg_loss: 0.0000; train_global_loss: 933566.7715; train_optim_loss: 933566.7715; val_kl_reg_loss: 23378.5190; val_edge_recon_loss: 100030.7445; val_gene_expr_recon_loss: 790636.4323; val_masked_gp_l1_reg_loss: 8545.2295; val_group_lasso_reg_loss: 0.0000; val_global_loss: 922590.9505; val_optim_loss: 922590.9505
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9149; val_auprc_score: 0.9812; val_best_acc_score: 0.9100; val_best_f1_score: 0.9485; train_kl_reg_loss: 22949.8904; train_edge_recon_loss: 99662.0007; train_gene_expr_recon_loss: 785712.5052; train_masked_gp_l1_reg_loss: 8700.1567; train_group_lasso_reg_loss: 0.0000; train_global_loss: 917024.5555; train_optim_loss: 917024.5555; val_kl_reg_loss: 22238.6011; val_edge_recon_loss: 100092.3864; val_gene_expr_recon_loss: 777518.3255; val_masked_gp_l1_reg_loss: 8853.5420; val_group_lasso_reg_loss: 0.0000; val_global_loss: 908702.8776; val_optim_loss: 908702.8776
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9192; val_auprc_score: 0.9838; val_best_acc_score: 0.9116; val_best_f1_score: 0.9496; train_kl_reg_loss: 21618.7456; train_edge_recon_loss: 98612.0380; train_gene_expr_recon_loss: 773618.1381; train_masked_gp_l1_reg_loss: 8990.4056; train_group_lasso_reg_loss: 0.0000; train_global_loss: 902839.3273; train_optim_loss: 902839.3273; val_kl_reg_loss: 20843.5103; val_edge_recon_loss: 95091.4486; val_gene_expr_recon_loss: 765610.0052; val_masked_gp_l1_reg_loss: 9124.8369; val_group_lasso_reg_loss: 0.0000; val_global_loss: 890669.7812; val_optim_loss: 890669.7812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9251; val_auprc_score: 0.9844; val_best_acc_score: 0.9144; val_best_f1_score: 0.9508; train_kl_reg_loss: 20201.5431; train_edge_recon_loss: 95710.1520; train_gene_expr_recon_loss: 762396.6468; train_masked_gp_l1_reg_loss: 9239.5860; train_group_lasso_reg_loss: 0.0000; train_global_loss: 887547.9291; train_optim_loss: 887547.9291; val_kl_reg_loss: 19464.1111; val_edge_recon_loss: 95951.3346; val_gene_expr_recon_loss: 755498.3958; val_masked_gp_l1_reg_loss: 9348.8887; val_group_lasso_reg_loss: 0.0000; val_global_loss: 880262.7161; val_optim_loss: 880262.7161
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9288; val_auprc_score: 0.9847; val_best_acc_score: 0.9185; val_best_f1_score: 0.9532; train_kl_reg_loss: 18825.9547; train_edge_recon_loss: 94498.8457; train_gene_expr_recon_loss: 752198.6041; train_masked_gp_l1_reg_loss: 9437.1307; train_group_lasso_reg_loss: 0.0000; train_global_loss: 874960.5331; train_optim_loss: 874960.5331; val_kl_reg_loss: 18032.9237; val_edge_recon_loss: 96227.0518; val_gene_expr_recon_loss: 746113.5990; val_masked_gp_l1_reg_loss: 9516.5703; val_group_lasso_reg_loss: 0.0000; val_global_loss: 869890.1406; val_optim_loss: 869890.1406
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9253; val_auprc_score: 0.9836; val_best_acc_score: 0.9230; val_best_f1_score: 0.9560; train_kl_reg_loss: 17562.5492; train_edge_recon_loss: 93942.4664; train_gene_expr_recon_loss: 742929.4297; train_masked_gp_l1_reg_loss: 9571.7510; train_group_lasso_reg_loss: 0.0000; train_global_loss: 864006.1980; train_optim_loss: 864006.1980; val_kl_reg_loss: 16952.3833; val_edge_recon_loss: 89302.1130; val_gene_expr_recon_loss: 736975.4740; val_masked_gp_l1_reg_loss: 9621.9678; val_group_lasso_reg_loss: 0.0000; val_global_loss: 852851.9089; val_optim_loss: 852851.9089
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9343; val_auprc_score: 0.9858; val_best_acc_score: 0.9243; val_best_f1_score: 0.9563; train_kl_reg_loss: 16364.5245; train_edge_recon_loss: 92352.8996; train_gene_expr_recon_loss: 734337.1765; train_masked_gp_l1_reg_loss: 9651.0997; train_group_lasso_reg_loss: 0.0000; train_global_loss: 852705.6965; train_optim_loss: 852705.6965; val_kl_reg_loss: 15848.0118; val_edge_recon_loss: 92044.3389; val_gene_expr_recon_loss: 729028.7500; val_masked_gp_l1_reg_loss: 9671.5146; val_group_lasso_reg_loss: 0.0000; val_global_loss: 846592.6016; val_optim_loss: 846592.6016
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9335; val_auprc_score: 0.9853; val_best_acc_score: 0.9256; val_best_f1_score: 0.9570; train_kl_reg_loss: 15223.8520; train_edge_recon_loss: 89458.5927; train_gene_expr_recon_loss: 726573.7805; train_masked_gp_l1_reg_loss: 9659.6830; train_group_lasso_reg_loss: 0.0000; train_global_loss: 840915.9064; train_optim_loss: 840915.9064; val_kl_reg_loss: 14590.0034; val_edge_recon_loss: 91062.5853; val_gene_expr_recon_loss: 722930.6302; val_masked_gp_l1_reg_loss: 9637.0322; val_group_lasso_reg_loss: 0.0000; val_global_loss: 838220.2812; val_optim_loss: 838220.2812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9401; val_auprc_score: 0.9865; val_best_acc_score: 0.9266; val_best_f1_score: 0.9576; train_kl_reg_loss: 14188.8228; train_edge_recon_loss: 89559.8667; train_gene_expr_recon_loss: 719235.8253; train_masked_gp_l1_reg_loss: 9587.8822; train_group_lasso_reg_loss: 0.0000; train_global_loss: 832572.4000; train_optim_loss: 832572.4000; val_kl_reg_loss: 13805.0506; val_edge_recon_loss: 91021.9840; val_gene_expr_recon_loss: 714583.4349; val_masked_gp_l1_reg_loss: 9524.7129; val_group_lasso_reg_loss: 0.0000; val_global_loss: 828935.1562; val_optim_loss: 828935.1562
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9349; val_auprc_score: 0.9856; val_best_acc_score: 0.9282; val_best_f1_score: 0.9588; train_kl_reg_loss: 13175.3078; train_edge_recon_loss: 87494.8933; train_gene_expr_recon_loss: 712596.2023; train_masked_gp_l1_reg_loss: 9443.2826; train_group_lasso_reg_loss: 0.0000; train_global_loss: 822709.6837; train_optim_loss: 822709.6837; val_kl_reg_loss: 12739.7264; val_edge_recon_loss: 88096.0316; val_gene_expr_recon_loss: 708291.1276; val_masked_gp_l1_reg_loss: 9347.3750; val_group_lasso_reg_loss: 0.0000; val_global_loss: 818474.2630; val_optim_loss: 818474.2630
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9362; val_auprc_score: 0.9851; val_best_acc_score: 0.9293; val_best_f1_score: 0.9592; train_kl_reg_loss: 12343.7342; train_edge_recon_loss: 86338.7688; train_gene_expr_recon_loss: 706575.9805; train_masked_gp_l1_reg_loss: 9228.1273; train_group_lasso_reg_loss: 0.0000; train_global_loss: 814486.6102; train_optim_loss: 814486.6102; val_kl_reg_loss: 11896.8487; val_edge_recon_loss: 87302.2952; val_gene_expr_recon_loss: 703005.5521; val_masked_gp_l1_reg_loss: 9102.4863; val_group_lasso_reg_loss: 0.0000; val_global_loss: 811307.2005; val_optim_loss: 811307.2005
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9359; val_auprc_score: 0.9856; val_best_acc_score: 0.9338; val_best_f1_score: 0.9619; train_kl_reg_loss: 11595.6730; train_edge_recon_loss: 85479.3191; train_gene_expr_recon_loss: 700626.7276; train_masked_gp_l1_reg_loss: 8961.6160; train_group_lasso_reg_loss: 0.0000; train_global_loss: 806663.3355; train_optim_loss: 806663.3355; val_kl_reg_loss: 11296.8799; val_edge_recon_loss: 83512.3047; val_gene_expr_recon_loss: 696835.5677; val_masked_gp_l1_reg_loss: 8811.8496; val_group_lasso_reg_loss: 0.0000; val_global_loss: 800456.6328; val_optim_loss: 800456.6328
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9421; val_auprc_score: 0.9872; val_best_acc_score: 0.9311; val_best_f1_score: 0.9601; train_kl_reg_loss: 10939.0544; train_edge_recon_loss: 85139.1675; train_gene_expr_recon_loss: 695360.7523; train_masked_gp_l1_reg_loss: 8659.1822; train_group_lasso_reg_loss: 0.0000; train_global_loss: 800098.1567; train_optim_loss: 800098.1567; val_kl_reg_loss: 10602.4773; val_edge_recon_loss: 85593.3711; val_gene_expr_recon_loss: 691450.0807; val_masked_gp_l1_reg_loss: 8505.2148; val_group_lasso_reg_loss: 0.0000; val_global_loss: 796151.1146; val_optim_loss: 796151.1146
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9442; val_auprc_score: 0.9876; val_best_acc_score: 0.9340; val_best_f1_score: 0.9619; train_kl_reg_loss: 10368.6406; train_edge_recon_loss: 84175.3117; train_gene_expr_recon_loss: 690530.8384; train_masked_gp_l1_reg_loss: 8347.4655; train_group_lasso_reg_loss: 0.0000; train_global_loss: 793422.2547; train_optim_loss: 793422.2547; val_kl_reg_loss: 10091.1757; val_edge_recon_loss: 83695.6820; val_gene_expr_recon_loss: 686866.3906; val_masked_gp_l1_reg_loss: 8192.2666; val_group_lasso_reg_loss: 0.0000; val_global_loss: 788845.4974; val_optim_loss: 788845.4974
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9454; val_auprc_score: 0.9869; val_best_acc_score: 0.9371; val_best_f1_score: 0.9635; train_kl_reg_loss: 9841.7816; train_edge_recon_loss: 83873.4528; train_gene_expr_recon_loss: 685960.2273; train_masked_gp_l1_reg_loss: 8033.7335; train_group_lasso_reg_loss: 0.0000; train_global_loss: 787709.1951; train_optim_loss: 787709.1951; val_kl_reg_loss: 9684.3213; val_edge_recon_loss: 83779.3799; val_gene_expr_recon_loss: 682729.6693; val_masked_gp_l1_reg_loss: 7877.1143; val_group_lasso_reg_loss: 0.0000; val_global_loss: 784070.4974; val_optim_loss: 784070.4974
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9453; val_auprc_score: 0.9878; val_best_acc_score: 0.9370; val_best_f1_score: 0.9636; train_kl_reg_loss: 9466.1256; train_edge_recon_loss: 82673.8032; train_gene_expr_recon_loss: 681927.7084; train_masked_gp_l1_reg_loss: 7726.2156; train_group_lasso_reg_loss: 0.0000; train_global_loss: 781793.8561; train_optim_loss: 781793.8561; val_kl_reg_loss: 9256.7972; val_edge_recon_loss: 81719.3936; val_gene_expr_recon_loss: 679257.9557; val_masked_gp_l1_reg_loss: 7584.6396; val_group_lasso_reg_loss: 0.0000; val_global_loss: 777818.7656; val_optim_loss: 777818.7656
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9446; val_auprc_score: 0.9874; val_best_acc_score: 0.9385; val_best_f1_score: 0.9647; train_kl_reg_loss: 9108.0001; train_edge_recon_loss: 81522.7475; train_gene_expr_recon_loss: 678177.7878; train_masked_gp_l1_reg_loss: 7452.3204; train_group_lasso_reg_loss: 0.0000; train_global_loss: 776260.8544; train_optim_loss: 776260.8544; val_kl_reg_loss: 8890.1082; val_edge_recon_loss: 79196.9740; val_gene_expr_recon_loss: 674990.5052; val_masked_gp_l1_reg_loss: 7327.9419; val_group_lasso_reg_loss: 0.0000; val_global_loss: 770405.5286; val_optim_loss: 770405.5286
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9432; val_auprc_score: 0.9877; val_best_acc_score: 0.9283; val_best_f1_score: 0.9587; train_kl_reg_loss: 7299.5901; train_edge_recon_loss: 83287.7524; train_gene_expr_recon_loss: 713390.6767; train_masked_gp_l1_reg_loss: 7478.4617; train_group_lasso_reg_loss: 0.0000; train_global_loss: 811456.4794; train_optim_loss: 811456.4794; val_kl_reg_loss: 5628.2438; val_edge_recon_loss: 83630.1172; val_gene_expr_recon_loss: 699776.0312; val_masked_gp_l1_reg_loss: 7311.9814; val_group_lasso_reg_loss: 0.0000; val_global_loss: 796346.3958; val_optim_loss: 796346.3958
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9388; val_auprc_score: 0.9865; val_best_acc_score: 0.9316; val_best_f1_score: 0.9607; train_kl_reg_loss: 6775.7224; train_edge_recon_loss: 81308.6832; train_gene_expr_recon_loss: 696814.1669; train_masked_gp_l1_reg_loss: 7142.9679; train_group_lasso_reg_loss: 0.0000; train_global_loss: 792041.5448; train_optim_loss: 792041.5448; val_kl_reg_loss: 5782.4179; val_edge_recon_loss: 81592.6714; val_gene_expr_recon_loss: 693209.8594; val_masked_gp_l1_reg_loss: 6981.4512; val_group_lasso_reg_loss: 0.0000; val_global_loss: 787566.3802; val_optim_loss: 787566.3802
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9484; val_auprc_score: 0.9888; val_best_acc_score: 0.9361; val_best_f1_score: 0.9631; train_kl_reg_loss: 6441.8934; train_edge_recon_loss: 81227.5460; train_gene_expr_recon_loss: 691755.6448; train_masked_gp_l1_reg_loss: 6847.2750; train_group_lasso_reg_loss: 0.0000; train_global_loss: 786272.3596; train_optim_loss: 786272.3596; val_kl_reg_loss: 5761.2087; val_edge_recon_loss: 80717.7899; val_gene_expr_recon_loss: 687421.2682; val_masked_gp_l1_reg_loss: 6724.0127; val_group_lasso_reg_loss: 0.0000; val_global_loss: 780624.2630; val_optim_loss: 780624.2630
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9494; val_auprc_score: 0.9887; val_best_acc_score: 0.9329; val_best_f1_score: 0.9611; train_kl_reg_loss: 6219.5620; train_edge_recon_loss: 80921.5953; train_gene_expr_recon_loss: 686898.5927; train_masked_gp_l1_reg_loss: 6615.7411; train_group_lasso_reg_loss: 0.0000; train_global_loss: 780655.4927; train_optim_loss: 780655.4927; val_kl_reg_loss: 5672.7149; val_edge_recon_loss: 81956.4362; val_gene_expr_recon_loss: 683537.8620; val_masked_gp_l1_reg_loss: 6511.7134; val_group_lasso_reg_loss: 0.0000; val_global_loss: 777678.6953; val_optim_loss: 777678.6953

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9441; val_auprc_score: 0.9876; val_best_acc_score: 0.9348; val_best_f1_score: 0.9625; train_kl_reg_loss: 6081.4409; train_edge_recon_loss: 80137.9205; train_gene_expr_recon_loss: 684536.6517; train_masked_gp_l1_reg_loss: 6459.6907; train_group_lasso_reg_loss: 0.0000; train_global_loss: 777215.7067; train_optim_loss: 777215.7067; val_kl_reg_loss: 5663.2794; val_edge_recon_loss: 78391.9626; val_gene_expr_recon_loss: 683131.4792; val_masked_gp_l1_reg_loss: 6444.3218; val_group_lasso_reg_loss: 0.0000; val_global_loss: 773631.0339; val_optim_loss: 773631.0339
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9498; val_auprc_score: 0.9887; val_best_acc_score: 0.9356; val_best_f1_score: 0.9626; train_kl_reg_loss: 6060.7850; train_edge_recon_loss: 80616.1751; train_gene_expr_recon_loss: 684021.7259; train_masked_gp_l1_reg_loss: 6432.7126; train_group_lasso_reg_loss: 0.0000; train_global_loss: 777131.3980; train_optim_loss: 777131.3980; val_kl_reg_loss: 5645.4749; val_edge_recon_loss: 82446.9730; val_gene_expr_recon_loss: 682075.3958; val_masked_gp_l1_reg_loss: 6421.6187; val_group_lasso_reg_loss: 0.0000; val_global_loss: 776589.4688; val_optim_loss: 776589.4688
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9455; val_auprc_score: 0.9886; val_best_acc_score: 0.9326; val_best_f1_score: 0.9612; train_kl_reg_loss: 6043.4798; train_edge_recon_loss: 80141.0125; train_gene_expr_recon_loss: 683519.8869; train_masked_gp_l1_reg_loss: 6409.3362; train_group_lasso_reg_loss: 0.0000; train_global_loss: 776113.7140; train_optim_loss: 776113.7140; val_kl_reg_loss: 5665.0750; val_edge_recon_loss: 81086.9554; val_gene_expr_recon_loss: 681871.3880; val_masked_gp_l1_reg_loss: 6397.2466; val_group_lasso_reg_loss: 0.0000; val_global_loss: 775020.6667; val_optim_loss: 775020.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9506; val_auprc_score: 0.9894; val_best_acc_score: 0.9380; val_best_f1_score: 0.9643; train_kl_reg_loss: 6040.1218; train_edge_recon_loss: 81054.0110; train_gene_expr_recon_loss: 683065.4677; train_masked_gp_l1_reg_loss: 6385.1553; train_group_lasso_reg_loss: 0.0000; train_global_loss: 776544.7526; train_optim_loss: 776544.7526; val_kl_reg_loss: 5690.2981; val_edge_recon_loss: 77903.5457; val_gene_expr_recon_loss: 682036.8307; val_masked_gp_l1_reg_loss: 6372.1069; val_group_lasso_reg_loss: 0.0000; val_global_loss: 772002.7995; val_optim_loss: 772002.7995

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 117 min 16 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9446
Val AUPRC score: 0.9874
Val best accuracy score: 0.9277
Val best F1 score: 0.9581
Val gene expr MSE score: 9962.9852
Val cat covariate0 mean sim diff: -0.0016

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
