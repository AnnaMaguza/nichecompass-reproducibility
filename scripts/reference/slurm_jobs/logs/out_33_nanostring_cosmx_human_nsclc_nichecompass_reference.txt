[True, False, True]
Run timestamp: 12102023_161937_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000000.0', '--lambda_gene_expr_recon', '3000000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 631979
Number of validation nodes: 70220
Number of training edges: 1492281
Number of validation edges: 165809
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8862; val_auprc_score: 0.9804; val_best_acc_score: 0.9142; val_best_f1_score: 0.9529; train_kl_reg_loss: 56947.5940; train_edge_recon_loss: 639899897.6439; train_gene_expr_recon_loss: 2611928495.2041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3251885337.1170; train_optim_loss: 3251885337.1170; val_kl_reg_loss: 49115.8772; val_edge_recon_loss: 649743301.7284; val_gene_expr_recon_loss: 2286863278.6173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2936655695.0123; val_optim_loss: 2936655695.0123
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8923; val_auprc_score: 0.9817; val_best_acc_score: 0.9161; val_best_f1_score: 0.9539; train_kl_reg_loss: 61249.2620; train_edge_recon_loss: 620828019.8148; train_gene_expr_recon_loss: 2191463245.5465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2812352513.4051; train_optim_loss: 2812352513.4051; val_kl_reg_loss: 75129.1064; val_edge_recon_loss: 644438559.8025; val_gene_expr_recon_loss: 2129290506.2716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2773804193.1852; val_optim_loss: 2773804193.1852
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9010; val_auprc_score: 0.9831; val_best_acc_score: 0.9201; val_best_f1_score: 0.9559; train_kl_reg_loss: 88879.3493; train_edge_recon_loss: 614804504.6559; train_gene_expr_recon_loss: 2106893783.6460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2721787166.7376; train_optim_loss: 2721787166.7376; val_kl_reg_loss: 102710.5771; val_edge_recon_loss: 642570436.5432; val_gene_expr_recon_loss: 2085246511.4074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2727919653.1358; val_optim_loss: 2727919653.1358
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9017; val_auprc_score: 0.9830; val_best_acc_score: 0.9202; val_best_f1_score: 0.9559; train_kl_reg_loss: 113557.7436; train_edge_recon_loss: 614527398.4329; train_gene_expr_recon_loss: 2079264838.5647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2693905794.7664; train_optim_loss: 2693905794.7664; val_kl_reg_loss: 127267.7053; val_edge_recon_loss: 651166102.8148; val_gene_expr_recon_loss: 2070380872.2963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2721674248.6914; val_optim_loss: 2721674248.6914
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9078; val_auprc_score: 0.9844; val_best_acc_score: 0.9235; val_best_f1_score: 0.9578; train_kl_reg_loss: 147760.0801; train_edge_recon_loss: 612953932.4268; train_gene_expr_recon_loss: 2059419454.3973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2672521145.3036; train_optim_loss: 2672521145.3036; val_kl_reg_loss: 156797.9210; val_edge_recon_loss: 640001380.3457; val_gene_expr_recon_loss: 2051869081.2840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2692027266.3704; val_optim_loss: 2692027266.3704
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9066; val_auprc_score: 0.9842; val_best_acc_score: 0.9222; val_best_f1_score: 0.9570; train_kl_reg_loss: 174343.3772; train_edge_recon_loss: 614761588.6491; train_gene_expr_recon_loss: 2047738374.7623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2662674306.4151; train_optim_loss: 2662674306.4151; val_kl_reg_loss: 185504.2188; val_edge_recon_loss: 642747320.0988; val_gene_expr_recon_loss: 2049793372.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2692726207.2099; val_optim_loss: 2692726207.2099
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9076; val_auprc_score: 0.9846; val_best_acc_score: 0.9235; val_best_f1_score: 0.9577; train_kl_reg_loss: 202608.9093; train_edge_recon_loss: 614926709.8456; train_gene_expr_recon_loss: 2046200718.4467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2661330038.8226; train_optim_loss: 2661330038.8226; val_kl_reg_loss: 226488.8315; val_edge_recon_loss: 635766138.6667; val_gene_expr_recon_loss: 2036472720.5926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2672465354.2716; val_optim_loss: 2672465354.2716
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9103; val_auprc_score: 0.9847; val_best_acc_score: 0.9246; val_best_f1_score: 0.9583; train_kl_reg_loss: 234950.0915; train_edge_recon_loss: 613445871.2480; train_gene_expr_recon_loss: 2034078126.7650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2647758947.4141; train_optim_loss: 2647758947.4141; val_kl_reg_loss: 256895.5710; val_edge_recon_loss: 640957203.3580; val_gene_expr_recon_loss: 2031242187.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2672456281.2840; val_optim_loss: 2672456281.2840
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9105; val_auprc_score: 0.9847; val_best_acc_score: 0.9253; val_best_f1_score: 0.9587; train_kl_reg_loss: 150061.2585; train_edge_recon_loss: 619523937.0209; train_gene_expr_recon_loss: 2353197834.4947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2972871832.9852; train_optim_loss: 2972871832.9852; val_kl_reg_loss: 199872.2558; val_edge_recon_loss: 644739435.6543; val_gene_expr_recon_loss: 2115059491.1605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2759998791.1111; val_optim_loss: 2759998791.1111
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9070; val_auprc_score: 0.9841; val_best_acc_score: 0.9239; val_best_f1_score: 0.9580; train_kl_reg_loss: 822724.2650; train_edge_recon_loss: 616954183.7832; train_gene_expr_recon_loss: 2218402706.5304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2836179610.1269; train_optim_loss: 2836179610.1269; val_kl_reg_loss: 125836.0725; val_edge_recon_loss: 639260549.4321; val_gene_expr_recon_loss: 2265842995.7531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2905229382.3210; val_optim_loss: 2905229382.3210
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9092; val_auprc_score: 0.9846; val_best_acc_score: 0.9252; val_best_f1_score: 0.9587; train_kl_reg_loss: 206706.4278; train_edge_recon_loss: 614517781.6480; train_gene_expr_recon_loss: 2126287380.3746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2741011868.1468; train_optim_loss: 2741011868.1468; val_kl_reg_loss: 260580.7892; val_edge_recon_loss: 637594832.7901; val_gene_expr_recon_loss: 2088659642.8642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2726515052.2469; val_optim_loss: 2726515052.2469
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8960; val_auprc_score: 0.9818; val_best_acc_score: 0.9193; val_best_f1_score: 0.9554; train_kl_reg_loss: 286205.3329; train_edge_recon_loss: 616288536.3925; train_gene_expr_recon_loss: 2250702419.1671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2867277161.3859; train_optim_loss: 2867277161.3859; val_kl_reg_loss: 94972.2137; val_edge_recon_loss: 649184633.9753; val_gene_expr_recon_loss: 2484540946.9630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3133820561.3827; val_optim_loss: 3133820561.3827

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9039; val_auprc_score: 0.9837; val_best_acc_score: 0.9221; val_best_f1_score: 0.9570; train_kl_reg_loss: 120134.9051; train_edge_recon_loss: 615763151.0504; train_gene_expr_recon_loss: 2406325058.7444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022208343.3825; train_optim_loss: 3022208343.3825; val_kl_reg_loss: 150810.4688; val_edge_recon_loss: 640164587.3580; val_gene_expr_recon_loss: 2312456135.1111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2952771535.0123; val_optim_loss: 2952771535.0123
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9102; val_auprc_score: 0.9850; val_best_acc_score: 0.9243; val_best_f1_score: 0.9582; train_kl_reg_loss: 185977.3154; train_edge_recon_loss: 613998618.7417; train_gene_expr_recon_loss: 2224934710.0981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2839119303.3551; train_optim_loss: 2839119303.3551; val_kl_reg_loss: 221613.6151; val_edge_recon_loss: 637831163.4568; val_gene_expr_recon_loss: 2147430597.9259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2785483376.1975; val_optim_loss: 2785483376.1975
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9125; val_auprc_score: 0.9850; val_best_acc_score: 0.9244; val_best_f1_score: 0.9582; train_kl_reg_loss: 248196.1841; train_edge_recon_loss: 613483651.8202; train_gene_expr_recon_loss: 2104875715.9300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2718607564.9756; train_optim_loss: 2718607564.9756; val_kl_reg_loss: 274635.9137; val_edge_recon_loss: 646162639.8025; val_gene_expr_recon_loss: 2070958603.8519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2717395871.6049; val_optim_loss: 2717395871.6049
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9158; val_auprc_score: 0.9859; val_best_acc_score: 0.9262; val_best_f1_score: 0.9592; train_kl_reg_loss: 297876.0053; train_edge_recon_loss: 611613447.6295; train_gene_expr_recon_loss: 2048948987.0381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2660860310.7897; train_optim_loss: 2660860310.7897; val_kl_reg_loss: 313536.0363; val_edge_recon_loss: 636030829.4321; val_gene_expr_recon_loss: 2035365040.9877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2671709404.4444; val_optim_loss: 2671709404.4444
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9159; val_auprc_score: 0.9859; val_best_acc_score: 0.9260; val_best_f1_score: 0.9590; train_kl_reg_loss: 331191.8374; train_edge_recon_loss: 608908983.1630; train_gene_expr_recon_loss: 2023809734.2134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2633049910.7129; train_optim_loss: 2633049910.7129; val_kl_reg_loss: 347699.1169; val_edge_recon_loss: 641376814.9136; val_gene_expr_recon_loss: 2018767892.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2660492408.0988; val_optim_loss: 2660492408.0988
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9155; val_auprc_score: 0.9856; val_best_acc_score: 0.9269; val_best_f1_score: 0.9595; train_kl_reg_loss: 778853.5710; train_edge_recon_loss: 612029582.7650; train_gene_expr_recon_loss: 2011632335.6542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2624440772.7204; train_optim_loss: 2624440772.7204; val_kl_reg_loss: 367391.4172; val_edge_recon_loss: 638030392.5926; val_gene_expr_recon_loss: 2010032242.5679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2648430028.6420; val_optim_loss: 2648430028.6420
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9168; val_auprc_score: 0.9859; val_best_acc_score: 0.9269; val_best_f1_score: 0.9595; train_kl_reg_loss: 374312.8604; train_edge_recon_loss: 611371065.0950; train_gene_expr_recon_loss: 2004107048.7492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2615852426.0556; train_optim_loss: 2615852426.0556; val_kl_reg_loss: 381823.4922; val_edge_recon_loss: 640716573.1358; val_gene_expr_recon_loss: 2003906172.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2645004574.8148; val_optim_loss: 2645004574.8148
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9174; val_auprc_score: 0.9860; val_best_acc_score: 0.9280; val_best_f1_score: 0.9602; train_kl_reg_loss: 389488.0551; train_edge_recon_loss: 608791630.7431; train_gene_expr_recon_loss: 2000460834.1187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2609641952.4720; train_optim_loss: 2609641952.4720; val_kl_reg_loss: 397473.0563; val_edge_recon_loss: 634212540.6420; val_gene_expr_recon_loss: 2001368714.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2635978722.7654; val_optim_loss: 2635978722.7654
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9175; val_auprc_score: 0.9862; val_best_acc_score: 0.9283; val_best_f1_score: 0.9602; train_kl_reg_loss: 402452.1901; train_edge_recon_loss: 609553577.3420; train_gene_expr_recon_loss: 1995596026.2477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2605552052.9125; train_optim_loss: 2605552052.9125; val_kl_reg_loss: 410722.7482; val_edge_recon_loss: 634109699.4568; val_gene_expr_recon_loss: 1998927710.8148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2633448139.8519; val_optim_loss: 2633448139.8519
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9172; val_auprc_score: 0.9859; val_best_acc_score: 0.9276; val_best_f1_score: 0.9598; train_kl_reg_loss: 413289.7359; train_edge_recon_loss: 610086827.4278; train_gene_expr_recon_loss: 1992407478.6690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2602907594.1654; train_optim_loss: 2602907594.1654; val_kl_reg_loss: 416442.8512; val_edge_recon_loss: 637856174.4198; val_gene_expr_recon_loss: 1996121176.4938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2634393788.8395; val_optim_loss: 2634393788.8395
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9179; val_auprc_score: 0.9861; val_best_acc_score: 0.9276; val_best_f1_score: 0.9599; train_kl_reg_loss: 421038.0621; train_edge_recon_loss: 610789309.4532; train_gene_expr_recon_loss: 1990365829.2254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2601576177.5973; train_optim_loss: 2601576177.5973; val_kl_reg_loss: 426282.6898; val_edge_recon_loss: 634958620.5432; val_gene_expr_recon_loss: 1993139480.4938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2628524385.1852; val_optim_loss: 2628524385.1852
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9177; val_auprc_score: 0.9862; val_best_acc_score: 0.9275; val_best_f1_score: 0.9598; train_kl_reg_loss: 430054.6720; train_edge_recon_loss: 609210998.4165; train_gene_expr_recon_loss: 1988183681.3612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2597824733.2226; train_optim_loss: 2597824733.2226; val_kl_reg_loss: 434949.5583; val_edge_recon_loss: 635008096.9877; val_gene_expr_recon_loss: 1992643636.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2628086685.2346; val_optim_loss: 2628086685.2346
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9184; val_auprc_score: 0.9861; val_best_acc_score: 0.9268; val_best_f1_score: 0.9595; train_kl_reg_loss: 433599.4851; train_edge_recon_loss: 608232983.5691; train_gene_expr_recon_loss: 1985911415.4374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2594577997.3708; train_optim_loss: 2594577997.3708; val_kl_reg_loss: 438047.6297; val_edge_recon_loss: 638665874.1728; val_gene_expr_recon_loss: 1988427811.1605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2627531732.5432; val_optim_loss: 2627531732.5432
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9171; val_auprc_score: 0.9861; val_best_acc_score: 0.9271; val_best_f1_score: 0.9597; train_kl_reg_loss: 450465.0009; train_edge_recon_loss: 612838591.3413; train_gene_expr_recon_loss: 1959828260.1825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2573117316.2593; train_optim_loss: 2573117316.2593; val_kl_reg_loss: 225000.1723; val_edge_recon_loss: 642483638.3210; val_gene_expr_recon_loss: 1963666906.8642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2606375553.5802; val_optim_loss: 2606375553.5802
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9174; val_auprc_score: 0.9861; val_best_acc_score: 0.9276; val_best_f1_score: 0.9600; train_kl_reg_loss: 472023.2150; train_edge_recon_loss: 608260215.2178; train_gene_expr_recon_loss: 1958381429.4175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2567113666.8762; train_optim_loss: 2567113666.8762; val_kl_reg_loss: 230797.0660; val_edge_recon_loss: 637664697.3827; val_gene_expr_recon_loss: 1960848201.0864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2598743691.0617; val_optim_loss: 2598743691.0617
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9186; val_auprc_score: 0.9863; val_best_acc_score: 0.9286; val_best_f1_score: 0.9605; train_kl_reg_loss: 481718.9043; train_edge_recon_loss: 610768805.0388; train_gene_expr_recon_loss: 1956323948.8110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2567574473.3750; train_optim_loss: 2567574473.3750; val_kl_reg_loss: 231879.4105; val_edge_recon_loss: 633727416.0000; val_gene_expr_recon_loss: 1960241731.5556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2594201023.2099; val_optim_loss: 2594201023.2099
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9204; val_auprc_score: 0.9867; val_best_acc_score: 0.9297; val_best_f1_score: 0.9611; train_kl_reg_loss: 481250.8779; train_edge_recon_loss: 611099232.0220; train_gene_expr_recon_loss: 1955471960.4364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2567052442.5660; train_optim_loss: 2567052442.5660; val_kl_reg_loss: 239567.5477; val_edge_recon_loss: 633064927.8025; val_gene_expr_recon_loss: 1958802201.2840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2592106689.5802; val_optim_loss: 2592106689.5802
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9189; val_auprc_score: 0.9864; val_best_acc_score: 0.9293; val_best_f1_score: 0.9609; train_kl_reg_loss: 482525.4488; train_edge_recon_loss: 610271267.9630; train_gene_expr_recon_loss: 1953215137.8113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2563968929.9431; train_optim_loss: 2563968929.9431; val_kl_reg_loss: 245031.5736; val_edge_recon_loss: 630506786.5679; val_gene_expr_recon_loss: 1958991456.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2589743275.4568; val_optim_loss: 2589743275.4568
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9196; val_auprc_score: 0.9867; val_best_acc_score: 0.9292; val_best_f1_score: 0.9608; train_kl_reg_loss: 481705.0411; train_edge_recon_loss: 610279728.2360; train_gene_expr_recon_loss: 1952556607.4511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2563318039.6240; train_optim_loss: 2563318039.6240; val_kl_reg_loss: 249093.7811; val_edge_recon_loss: 631389932.0494; val_gene_expr_recon_loss: 1956826119.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2588465146.4691; val_optim_loss: 2588465146.4691
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9198; val_auprc_score: 0.9867; val_best_acc_score: 0.9290; val_best_f1_score: 0.9607; train_kl_reg_loss: 486568.8132; train_edge_recon_loss: 609016295.9808; train_gene_expr_recon_loss: 1949941900.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2559444763.6638; train_optim_loss: 2559444763.6638; val_kl_reg_loss: 251660.6615; val_edge_recon_loss: 632554245.1358; val_gene_expr_recon_loss: 1956403754.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2589209657.6790; val_optim_loss: 2589209657.6790
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9208; val_auprc_score: 0.9869; val_best_acc_score: 0.9300; val_best_f1_score: 0.9614; train_kl_reg_loss: 491767.4360; train_edge_recon_loss: 611983433.2652; train_gene_expr_recon_loss: 1949395630.4576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2561870832.3678; train_optim_loss: 2561870832.3678; val_kl_reg_loss: 258673.8636; val_edge_recon_loss: 626141915.8519; val_gene_expr_recon_loss: 1953447239.9012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2579847822.2222; val_optim_loss: 2579847822.2222
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9199; val_auprc_score: 0.9867; val_best_acc_score: 0.9296; val_best_f1_score: 0.9610; train_kl_reg_loss: 487206.6229; train_edge_recon_loss: 610243158.2189; train_gene_expr_recon_loss: 1946873693.9691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2557604058.9393; train_optim_loss: 2557604058.9393; val_kl_reg_loss: 260653.9428; val_edge_recon_loss: 629348453.5309; val_gene_expr_recon_loss: 1951341008.9877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2580950115.5556; val_optim_loss: 2580950115.5556
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9211; val_auprc_score: 0.9867; val_best_acc_score: 0.9297; val_best_f1_score: 0.9611; train_kl_reg_loss: 484648.9205; train_edge_recon_loss: 611252944.0494; train_gene_expr_recon_loss: 1946175027.5952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2557912622.1063; train_optim_loss: 2557912622.1063; val_kl_reg_loss: 265005.2236; val_edge_recon_loss: 630626284.8395; val_gene_expr_recon_loss: 1949951413.7284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2580842708.5432; val_optim_loss: 2580842708.5432
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9196; val_auprc_score: 0.9863; val_best_acc_score: 0.9296; val_best_f1_score: 0.9609; train_kl_reg_loss: 484074.2736; train_edge_recon_loss: 609917944.8206; train_gene_expr_recon_loss: 1944991761.5643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2555393779.5293; train_optim_loss: 2555393779.5293; val_kl_reg_loss: 264594.9621; val_edge_recon_loss: 640060599.4074; val_gene_expr_recon_loss: 1949711872.3951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2590037064.6914; val_optim_loss: 2590037064.6914
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9217; val_auprc_score: 0.9867; val_best_acc_score: 0.9297; val_best_f1_score: 0.9610; train_kl_reg_loss: 478633.6160; train_edge_recon_loss: 610389240.7108; train_gene_expr_recon_loss: 1942158534.1256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2553026409.2103; train_optim_loss: 2553026409.2103; val_kl_reg_loss: 267856.0499; val_edge_recon_loss: 635193486.4198; val_gene_expr_recon_loss: 1948368762.8642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2583830104.4938; val_optim_loss: 2583830104.4938

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9191; val_auprc_score: 0.9861; val_best_acc_score: 0.9288; val_best_f1_score: 0.9606; train_kl_reg_loss: 475110.1350; train_edge_recon_loss: 608552607.5060; train_gene_expr_recon_loss: 1938567301.4889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2547595020.6463; train_optim_loss: 2547595020.6463; val_kl_reg_loss: 267049.4008; val_edge_recon_loss: 639567651.7531; val_gene_expr_recon_loss: 1944228835.1605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2584063533.0370; val_optim_loss: 2584063533.0370
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9196; val_auprc_score: 0.9864; val_best_acc_score: 0.9301; val_best_f1_score: 0.9613; train_kl_reg_loss: 473437.3139; train_edge_recon_loss: 610696643.5568; train_gene_expr_recon_loss: 1938336686.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2549506766.6443; train_optim_loss: 2549506766.6443; val_kl_reg_loss: 266357.2507; val_edge_recon_loss: 636045579.8519; val_gene_expr_recon_loss: 1944534384.1975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2580846314.6667; val_optim_loss: 2580846314.6667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9200; val_auprc_score: 0.9865; val_best_acc_score: 0.9298; val_best_f1_score: 0.9611; train_kl_reg_loss: 471895.8414; train_edge_recon_loss: 608906865.3338; train_gene_expr_recon_loss: 1938024236.7451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2547402997.3736; train_optim_loss: 2547402997.3736; val_kl_reg_loss: 266681.3223; val_edge_recon_loss: 633600967.4074; val_gene_expr_recon_loss: 1943910612.9383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2577778258.1728; val_optim_loss: 2577778258.1728
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9216; val_auprc_score: 0.9868; val_best_acc_score: 0.9297; val_best_f1_score: 0.9611; train_kl_reg_loss: 470106.4248; train_edge_recon_loss: 611080718.6223; train_gene_expr_recon_loss: 1938082914.0089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2549633740.0974; train_optim_loss: 2549633740.0974; val_kl_reg_loss: 267436.8979; val_edge_recon_loss: 636600308.2469; val_gene_expr_recon_loss: 1943173543.5062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2580041288.6914; val_optim_loss: 2580041288.6914
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9196; val_auprc_score: 0.9865; val_best_acc_score: 0.9299; val_best_f1_score: 0.9612; train_kl_reg_loss: 467283.6016; train_edge_recon_loss: 612313328.9496; train_gene_expr_recon_loss: 1938191417.9184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2550972030.5509; train_optim_loss: 2550972030.5509; val_kl_reg_loss: 267394.2824; val_edge_recon_loss: 635510815.7037; val_gene_expr_recon_loss: 1942873236.5432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2578651445.7284; val_optim_loss: 2578651445.7284
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9199; val_auprc_score: 0.9866; val_best_acc_score: 0.9305; val_best_f1_score: 0.9615; train_kl_reg_loss: 465329.0382; train_edge_recon_loss: 609587375.0614; train_gene_expr_recon_loss: 1937266909.5300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2547319611.3674; train_optim_loss: 2547319611.3674; val_kl_reg_loss: 268594.1833; val_edge_recon_loss: 630653752.6914; val_gene_expr_recon_loss: 1942451698.1728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2573374037.3333; val_optim_loss: 2573374037.3333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9212; val_auprc_score: 0.9868; val_best_acc_score: 0.9297; val_best_f1_score: 0.9611; train_kl_reg_loss: 463114.9003; train_edge_recon_loss: 608850736.8617; train_gene_expr_recon_loss: 1937217886.3643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2546531738.7417; train_optim_loss: 2546531738.7417; val_kl_reg_loss: 269004.1336; val_edge_recon_loss: 633393746.1728; val_gene_expr_recon_loss: 1943288534.1235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2576951288.8889; val_optim_loss: 2576951288.8889
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9221; val_auprc_score: 0.9870; val_best_acc_score: 0.9296; val_best_f1_score: 0.9610; train_kl_reg_loss: 461133.4829; train_edge_recon_loss: 610808412.6079; train_gene_expr_recon_loss: 1936833580.3938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2548103126.0213; train_optim_loss: 2548103126.0213; val_kl_reg_loss: 268394.1671; val_edge_recon_loss: 638467740.6420; val_gene_expr_recon_loss: 1942683273.8765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2581419408.5926; val_optim_loss: 2581419408.5926
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9206; val_auprc_score: 0.9866; val_best_acc_score: 0.9300; val_best_f1_score: 0.9613; train_kl_reg_loss: 460179.5919; train_edge_recon_loss: 611082146.5358; train_gene_expr_recon_loss: 1936761433.0511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2548303757.5684; train_optim_loss: 2548303757.5684; val_kl_reg_loss: 269185.9133; val_edge_recon_loss: 631250966.9136; val_gene_expr_recon_loss: 1943253674.2716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2574773830.3210; val_optim_loss: 2574773830.3210
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9218; val_auprc_score: 0.9871; val_best_acc_score: 0.9305; val_best_f1_score: 0.9615; train_kl_reg_loss: 458653.1724; train_edge_recon_loss: 609425206.4274; train_gene_expr_recon_loss: 1937049423.4346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2546933285.3242; train_optim_loss: 2546933285.3242; val_kl_reg_loss: 269390.9316; val_edge_recon_loss: 627998532.2469; val_gene_expr_recon_loss: 1942576492.6420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2570844408.0988; val_optim_loss: 2570844408.0988
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9199; val_auprc_score: 0.9865; val_best_acc_score: 0.9296; val_best_f1_score: 0.9609; train_kl_reg_loss: 458038.6720; train_edge_recon_loss: 609048780.7232; train_gene_expr_recon_loss: 1937337033.5067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2546843849.7262; train_optim_loss: 2546843849.7262; val_kl_reg_loss: 270304.2799; val_edge_recon_loss: 635335014.3210; val_gene_expr_recon_loss: 1943590942.0247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2579196251.6543; val_optim_loss: 2579196251.6543
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9216; val_auprc_score: 0.9872; val_best_acc_score: 0.9311; val_best_f1_score: 0.9619; train_kl_reg_loss: 457922.3958; train_edge_recon_loss: 610154606.9516; train_gene_expr_recon_loss: 1936120222.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2546732750.2930; train_optim_loss: 2546732750.2930; val_kl_reg_loss: 270848.2266; val_edge_recon_loss: 624466237.9259; val_gene_expr_recon_loss: 1942930403.9506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2567667490.7654; val_optim_loss: 2567667490.7654
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9217; val_auprc_score: 0.9868; val_best_acc_score: 0.9294; val_best_f1_score: 0.9608; train_kl_reg_loss: 456995.2333; train_edge_recon_loss: 606416844.4487; train_gene_expr_recon_loss: 1936307135.0120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2543180973.3599; train_optim_loss: 2543180973.3599; val_kl_reg_loss: 271025.0090; val_edge_recon_loss: 636913639.1111; val_gene_expr_recon_loss: 1944340888.4938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2581525546.6667; val_optim_loss: 2581525546.6667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9207; val_auprc_score: 0.9867; val_best_acc_score: 0.9294; val_best_f1_score: 0.9609; train_kl_reg_loss: 455780.8288; train_edge_recon_loss: 609419993.3036; train_gene_expr_recon_loss: 1936675472.7300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2546551246.9077; train_optim_loss: 2546551246.9077; val_kl_reg_loss: 271428.3862; val_edge_recon_loss: 635803721.4815; val_gene_expr_recon_loss: 1941814983.1111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2577890127.0123; val_optim_loss: 2577890127.0123
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9214; val_auprc_score: 0.9867; val_best_acc_score: 0.9304; val_best_f1_score: 0.9614; train_kl_reg_loss: 454678.7726; train_edge_recon_loss: 608928938.4617; train_gene_expr_recon_loss: 1936130166.3835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2545513785.4353; train_optim_loss: 2545513785.4353; val_kl_reg_loss: 271440.1816; val_edge_recon_loss: 633650921.8765; val_gene_expr_recon_loss: 1942254451.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2576176816.9877; val_optim_loss: 2576176816.9877
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9213; val_auprc_score: 0.9870; val_best_acc_score: 0.9309; val_best_f1_score: 0.9618; train_kl_reg_loss: 453498.4049; train_edge_recon_loss: 609149876.3746; train_gene_expr_recon_loss: 1935931487.9890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2545534862.1832; train_optim_loss: 2545534862.1832; val_kl_reg_loss: 271989.1942; val_edge_recon_loss: 627431030.9136; val_gene_expr_recon_loss: 1941918192.9877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2569621212.4444; val_optim_loss: 2569621212.4444

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9217; val_auprc_score: 0.9867; val_best_acc_score: 0.9300; val_best_f1_score: 0.9612; train_kl_reg_loss: 453437.7492; train_edge_recon_loss: 610884234.7142; train_gene_expr_recon_loss: 1935390053.3022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2546727727.1602; train_optim_loss: 2546727727.1602; val_kl_reg_loss: 272496.5612; val_edge_recon_loss: 636376932.6420; val_gene_expr_recon_loss: 1941879090.1728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2578528520.6914; val_optim_loss: 2578528520.6914
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9218; val_auprc_score: 0.9869; val_best_acc_score: 0.9309; val_best_f1_score: 0.9618; train_kl_reg_loss: 453193.1072; train_edge_recon_loss: 607038276.7533; train_gene_expr_recon_loss: 1935541409.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2543032878.2820; train_optim_loss: 2543032878.2820; val_kl_reg_loss: 272669.8544; val_edge_recon_loss: 630348253.6296; val_gene_expr_recon_loss: 1943499423.6049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2574120346.8642; val_optim_loss: 2574120346.8642
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9217; val_auprc_score: 0.9869; val_best_acc_score: 0.9296; val_best_f1_score: 0.9610; train_kl_reg_loss: 452720.2459; train_edge_recon_loss: 610059141.3352; train_gene_expr_recon_loss: 1935579349.9334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2546091209.9897; train_optim_loss: 2546091209.9897; val_kl_reg_loss: 272516.9864; val_edge_recon_loss: 636381937.8765; val_gene_expr_recon_loss: 1942279625.8765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2578934085.5309; val_optim_loss: 2578934085.5309
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9221; val_auprc_score: 0.9872; val_best_acc_score: 0.9305; val_best_f1_score: 0.9615; train_kl_reg_loss: 452344.7649; train_edge_recon_loss: 608818841.2158; train_gene_expr_recon_loss: 1935779455.3852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2545050643.4964; train_optim_loss: 2545050643.4964; val_kl_reg_loss: 272169.1479; val_edge_recon_loss: 628891628.0494; val_gene_expr_recon_loss: 1944004661.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2573168463.0123; val_optim_loss: 2573168463.0123

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 659 min 15 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9203
val AUPRC score: 0.9864
val best accuracy score: 0.9302
val best F1 score: 0.9613
val target rna MSE score: 0.5126
val source rna MSE score: 0.1654
Val cat covariate0 mean sim diff: -0.0011
Val cat covariate1 mean sim diff: -0.0581
Val cat covariate2 mean sim diff: 0.0000

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
