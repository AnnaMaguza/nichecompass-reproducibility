[True]
Run timestamp: 01082023_093324_80.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_80']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9017; val_auprc_score: 0.9819; val_best_acc_score: 0.8651; val_best_f1_score: 0.9270; train_kl_reg_loss: 46382.2649; train_edge_recon_loss: 1037083.2477; train_gene_expr_recon_loss: 533298.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113798.5609; train_global_loss: 1730563.0440; train_optim_loss: 1730563.0440; val_kl_reg_loss: 46601.4173; val_edge_recon_loss: 1160391.8542; val_gene_expr_recon_loss: 451701.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100431.5625; val_global_loss: 1759126.7917; val_optim_loss: 1759126.7917
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9006; val_auprc_score: 0.9807; val_best_acc_score: 0.8613; val_best_f1_score: 0.9243; train_kl_reg_loss: 28882.9315; train_edge_recon_loss: 1030757.4977; train_gene_expr_recon_loss: 386560.5069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90061.0334; train_global_loss: 1536261.9653; train_optim_loss: 1536261.9653; val_kl_reg_loss: 20172.1855; val_edge_recon_loss: 1220456.0208; val_gene_expr_recon_loss: 311387.5990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80360.3672; val_global_loss: 1632376.1875; val_optim_loss: 1632376.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8752; val_auprc_score: 0.9762; val_best_acc_score: 0.8635; val_best_f1_score: 0.9247; train_kl_reg_loss: 16856.1278; train_edge_recon_loss: 1030554.0995; train_gene_expr_recon_loss: 285246.4109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71140.6850; train_global_loss: 1403797.3218; train_optim_loss: 1403797.3218; val_kl_reg_loss: 11778.5347; val_edge_recon_loss: 1198737.2917; val_gene_expr_recon_loss: 268946.1198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61642.3633; val_global_loss: 1541104.3750; val_optim_loss: 1541104.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8177; val_auprc_score: 0.9608; val_best_acc_score: 0.8793; val_best_f1_score: 0.9331; train_kl_reg_loss: 11549.6711; train_edge_recon_loss: 1021164.1424; train_gene_expr_recon_loss: 264963.4280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53492.0578; train_global_loss: 1351169.2917; train_optim_loss: 1351169.2917; val_kl_reg_loss: 6909.3790; val_edge_recon_loss: 1085939.1562; val_gene_expr_recon_loss: 264137.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45804.3945; val_global_loss: 1402790.6667; val_optim_loss: 1402790.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8281; val_auprc_score: 0.9596; val_best_acc_score: 0.8799; val_best_f1_score: 0.9334; train_kl_reg_loss: 10440.8155; train_edge_recon_loss: 919850.1377; train_gene_expr_recon_loss: 272582.0590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40070.9999; train_global_loss: 1242944.0162; train_optim_loss: 1242944.0162; val_kl_reg_loss: 15799.4976; val_edge_recon_loss: 917951.1979; val_gene_expr_recon_loss: 266877.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34901.8711; val_global_loss: 1235529.6667; val_optim_loss: 1235529.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8403; val_auprc_score: 0.9638; val_best_acc_score: 0.8925; val_best_f1_score: 0.9402; train_kl_reg_loss: 17152.2094; train_edge_recon_loss: 889979.7812; train_gene_expr_recon_loss: 258997.2726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31215.2613; train_global_loss: 1197344.5347; train_optim_loss: 1197344.5347; val_kl_reg_loss: 17087.8965; val_edge_recon_loss: 857847.1667; val_gene_expr_recon_loss: 252849.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28081.9102; val_global_loss: 1155866.7917; val_optim_loss: 1155866.7917
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8558; val_auprc_score: 0.9663; val_best_acc_score: 0.8967; val_best_f1_score: 0.9423; train_kl_reg_loss: 16750.3506; train_edge_recon_loss: 878056.2269; train_gene_expr_recon_loss: 251731.8831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25863.5384; train_global_loss: 1172402.0046; train_optim_loss: 1172402.0046; val_kl_reg_loss: 14733.8205; val_edge_recon_loss: 875250.9792; val_gene_expr_recon_loss: 249197.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23820.5625; val_global_loss: 1163002.7500; val_optim_loss: 1163002.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8617; val_auprc_score: 0.9658; val_best_acc_score: 0.9051; val_best_f1_score: 0.9463; train_kl_reg_loss: 15202.2062; train_edge_recon_loss: 848432.6528; train_gene_expr_recon_loss: 247967.6007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22291.3992; train_global_loss: 1133893.8611; train_optim_loss: 1133893.8611; val_kl_reg_loss: 15286.4390; val_edge_recon_loss: 853658.9479; val_gene_expr_recon_loss: 244160.7057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20889.2949; val_global_loss: 1133995.3333; val_optim_loss: 1133995.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8610; val_auprc_score: 0.9664; val_best_acc_score: 0.9045; val_best_f1_score: 0.9459; train_kl_reg_loss: 16365.5407; train_edge_recon_loss: 834457.9109; train_gene_expr_recon_loss: 241700.9372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19727.9651; train_global_loss: 1112252.3519; train_optim_loss: 1112252.3519; val_kl_reg_loss: 16418.9844; val_edge_recon_loss: 843466.1146; val_gene_expr_recon_loss: 239072.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18585.8789; val_global_loss: 1117543.0833; val_optim_loss: 1117543.0833
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8672; val_auprc_score: 0.9681; val_best_acc_score: 0.9058; val_best_f1_score: 0.9466; train_kl_reg_loss: 16321.5681; train_edge_recon_loss: 829454.3565; train_gene_expr_recon_loss: 236829.7700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17701.2492; train_global_loss: 1100306.9294; train_optim_loss: 1100306.9294; val_kl_reg_loss: 16157.2082; val_edge_recon_loss: 850957.1458; val_gene_expr_recon_loss: 232109.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16825.3867; val_global_loss: 1116049.5833; val_optim_loss: 1116049.5833
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8782; val_auprc_score: 0.9701; val_best_acc_score: 0.9078; val_best_f1_score: 0.9476; train_kl_reg_loss: 15770.0037; train_edge_recon_loss: 816400.7523; train_gene_expr_recon_loss: 232082.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16093.4859; train_global_loss: 1080346.9062; train_optim_loss: 1080346.9062; val_kl_reg_loss: 14418.6079; val_edge_recon_loss: 850528.4792; val_gene_expr_recon_loss: 228523.5339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15409.6582; val_global_loss: 1108880.2917; val_optim_loss: 1108880.2917
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8803; val_auprc_score: 0.9727; val_best_acc_score: 0.9055; val_best_f1_score: 0.9463; train_kl_reg_loss: 14998.1513; train_edge_recon_loss: 830053.8484; train_gene_expr_recon_loss: 228553.3652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14818.3980; train_global_loss: 1088423.7650; train_optim_loss: 1088423.7650; val_kl_reg_loss: 14216.0876; val_edge_recon_loss: 851711.0729; val_gene_expr_recon_loss: 227808.6146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14231.1084; val_global_loss: 1107966.9167; val_optim_loss: 1107966.9167
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8982; val_auprc_score: 0.9772; val_best_acc_score: 0.9148; val_best_f1_score: 0.9517; train_kl_reg_loss: 14379.3202; train_edge_recon_loss: 824462.8854; train_gene_expr_recon_loss: 225538.3414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13793.8073; train_global_loss: 1078174.3542; train_optim_loss: 1078174.3542; val_kl_reg_loss: 13188.2048; val_edge_recon_loss: 792531.8958; val_gene_expr_recon_loss: 223790.1224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13341.7988; val_global_loss: 1042852.0104; val_optim_loss: 1042852.0104
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9027; val_auprc_score: 0.9764; val_best_acc_score: 0.9195; val_best_f1_score: 0.9540; train_kl_reg_loss: 13390.1523; train_edge_recon_loss: 811698.0938; train_gene_expr_recon_loss: 222865.8469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12979.4732; train_global_loss: 1060933.5521; train_optim_loss: 1060933.5521; val_kl_reg_loss: 13741.5493; val_edge_recon_loss: 809127.7812; val_gene_expr_recon_loss: 221055.1224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12653.2568; val_global_loss: 1056577.7188; val_optim_loss: 1056577.7188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9106; val_auprc_score: 0.9804; val_best_acc_score: 0.9226; val_best_f1_score: 0.9558; train_kl_reg_loss: 13908.1826; train_edge_recon_loss: 792052.0694; train_gene_expr_recon_loss: 219478.6583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12271.2954; train_global_loss: 1037710.2153; train_optim_loss: 1037710.2153; val_kl_reg_loss: 13753.9411; val_edge_recon_loss: 785251.9167; val_gene_expr_recon_loss: 217642.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11884.6875; val_global_loss: 1028532.9062; val_optim_loss: 1028532.9062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9176; val_auprc_score: 0.9817; val_best_acc_score: 0.9265; val_best_f1_score: 0.9579; train_kl_reg_loss: 13980.3311; train_edge_recon_loss: 800879.8657; train_gene_expr_recon_loss: 216632.8504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11538.9589; train_global_loss: 1043032.0081; train_optim_loss: 1043032.0081; val_kl_reg_loss: 13299.7015; val_edge_recon_loss: 803268.3021; val_gene_expr_recon_loss: 214557.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11201.8066; val_global_loss: 1042327.1458; val_optim_loss: 1042327.1458
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9265; val_auprc_score: 0.9838; val_best_acc_score: 0.9255; val_best_f1_score: 0.9571; train_kl_reg_loss: 13199.8925; train_edge_recon_loss: 795574.7685; train_gene_expr_recon_loss: 214065.0651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10866.2841; train_global_loss: 1033706.0127; train_optim_loss: 1033706.0127; val_kl_reg_loss: 12813.5628; val_edge_recon_loss: 818796.5833; val_gene_expr_recon_loss: 212291.3646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10562.8184; val_global_loss: 1054464.3542; val_optim_loss: 1054464.3542
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9295; val_auprc_score: 0.9847; val_best_acc_score: 0.9241; val_best_f1_score: 0.9562; train_kl_reg_loss: 13062.2918; train_edge_recon_loss: 800189.0266; train_gene_expr_recon_loss: 211879.6137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10245.9414; train_global_loss: 1035376.8646; train_optim_loss: 1035376.8646; val_kl_reg_loss: 13305.2741; val_edge_recon_loss: 800294.4479; val_gene_expr_recon_loss: 209830.6771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9965.7012; val_global_loss: 1033396.1458; val_optim_loss: 1033396.1458
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9301; val_auprc_score: 0.9847; val_best_acc_score: 0.9262; val_best_f1_score: 0.9576; train_kl_reg_loss: 12620.3755; train_edge_recon_loss: 802620.6053; train_gene_expr_recon_loss: 209896.5813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9680.5016; train_global_loss: 1034818.0556; train_optim_loss: 1034818.0556; val_kl_reg_loss: 11860.8826; val_edge_recon_loss: 807738.8333; val_gene_expr_recon_loss: 208228.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9426.7588; val_global_loss: 1037255.0104; val_optim_loss: 1037255.0104

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9356; val_auprc_score: 0.9849; val_best_acc_score: 0.9294; val_best_f1_score: 0.9594; train_kl_reg_loss: 12093.1410; train_edge_recon_loss: 791362.3692; train_gene_expr_recon_loss: 208535.0226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9313.6844; train_global_loss: 1021304.2211; train_optim_loss: 1021304.2211; val_kl_reg_loss: 11701.2409; val_edge_recon_loss: 790342.0104; val_gene_expr_recon_loss: 208868.2474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9260.7725; val_global_loss: 1020172.2500; val_optim_loss: 1020172.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9378; val_auprc_score: 0.9858; val_best_acc_score: 0.9261; val_best_f1_score: 0.9574; train_kl_reg_loss: 12018.3158; train_edge_recon_loss: 789284.9606; train_gene_expr_recon_loss: 208346.5697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9230.5710; train_global_loss: 1018880.4132; train_optim_loss: 1018880.4132; val_kl_reg_loss: 11709.9274; val_edge_recon_loss: 815345.6979; val_gene_expr_recon_loss: 208029.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9200.6035; val_global_loss: 1044286.2188; val_optim_loss: 1044286.2188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9330; val_auprc_score: 0.9849; val_best_acc_score: 0.9265; val_best_f1_score: 0.9578; train_kl_reg_loss: 11929.8787; train_edge_recon_loss: 788953.2431; train_gene_expr_recon_loss: 208194.5975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9172.5883; train_global_loss: 1018250.3090; train_optim_loss: 1018250.3090; val_kl_reg_loss: 11460.4494; val_edge_recon_loss: 800670.4167; val_gene_expr_recon_loss: 207793.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9144.0420; val_global_loss: 1029068.8750; val_optim_loss: 1029068.8750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9374; val_auprc_score: 0.9857; val_best_acc_score: 0.9270; val_best_f1_score: 0.9581; train_kl_reg_loss: 11702.0847; train_edge_recon_loss: 791597.2269; train_gene_expr_recon_loss: 208055.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9115.3910; train_global_loss: 1020470.0000; train_optim_loss: 1020470.0000; val_kl_reg_loss: 11463.2443; val_edge_recon_loss: 800555.2604; val_gene_expr_recon_loss: 207695.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9086.2803; val_global_loss: 1028799.9792; val_optim_loss: 1028799.9792
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9354; val_auprc_score: 0.9859; val_best_acc_score: 0.9276; val_best_f1_score: 0.9582; train_kl_reg_loss: 11754.9791; train_edge_recon_loss: 796240.7558; train_gene_expr_recon_loss: 207895.2269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9058.9814; train_global_loss: 1024949.9491; train_optim_loss: 1024949.9491; val_kl_reg_loss: 11325.3724; val_edge_recon_loss: 802692.9792; val_gene_expr_recon_loss: 207373.3255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9030.0312; val_global_loss: 1030421.7083; val_optim_loss: 1030421.7083

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9371; val_auprc_score: 0.9861; val_best_acc_score: 0.9289; val_best_f1_score: 0.9591; train_kl_reg_loss: 11679.4701; train_edge_recon_loss: 790987.7708; train_gene_expr_recon_loss: 207782.8510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9020.5777; train_global_loss: 1019470.6690; train_optim_loss: 1019470.6690; val_kl_reg_loss: 11334.6488; val_edge_recon_loss: 785368.3958; val_gene_expr_recon_loss: 207381.9505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9016.2695; val_global_loss: 1013101.2500; val_optim_loss: 1013101.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9381; val_auprc_score: 0.9862; val_best_acc_score: 0.9264; val_best_f1_score: 0.9575; train_kl_reg_loss: 11500.6700; train_edge_recon_loss: 785356.4525; train_gene_expr_recon_loss: 337867.3559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8999.4064; train_global_loss: 1143723.8866; train_optim_loss: 1143723.8866; val_kl_reg_loss: 7958.5577; val_edge_recon_loss: 828140.2396; val_gene_expr_recon_loss: 337351.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8978.3730; val_global_loss: 1182429.0833; val_optim_loss: 1182429.0833
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9367; val_auprc_score: 0.9861; val_best_acc_score: 0.9296; val_best_f1_score: 0.9597; train_kl_reg_loss: 11144.7411; train_edge_recon_loss: 783294.8322; train_gene_expr_recon_loss: 336838.0828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8958.1926; train_global_loss: 1140235.8669; train_optim_loss: 1140235.8669; val_kl_reg_loss: 7765.8573; val_edge_recon_loss: 771749.4271; val_gene_expr_recon_loss: 336280.9427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8937.6709; val_global_loss: 1124733.8750; val_optim_loss: 1124733.8750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9383; val_auprc_score: 0.9864; val_best_acc_score: 0.9281; val_best_f1_score: 0.9587; train_kl_reg_loss: 10905.7895; train_edge_recon_loss: 778376.1343; train_gene_expr_recon_loss: 335905.5307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8918.5038; train_global_loss: 1134105.9491; train_optim_loss: 1134105.9491; val_kl_reg_loss: 7673.7061; val_edge_recon_loss: 802383.4688; val_gene_expr_recon_loss: 335321.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8898.8857; val_global_loss: 1154277.5208; val_optim_loss: 1154277.5208
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9365; val_auprc_score: 0.9846; val_best_acc_score: 0.9274; val_best_f1_score: 0.9582; train_kl_reg_loss: 10707.1469; train_edge_recon_loss: 784608.5683; train_gene_expr_recon_loss: 335233.2078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8880.4278; train_global_loss: 1139429.3495; train_optim_loss: 1139429.3495; val_kl_reg_loss: 7543.1883; val_edge_recon_loss: 804736.8750; val_gene_expr_recon_loss: 334816.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8861.4541; val_global_loss: 1155958.0417; val_optim_loss: 1155958.0417

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9372; val_auprc_score: 0.9861; val_best_acc_score: 0.9283; val_best_f1_score: 0.9587; train_kl_reg_loss: 10603.2659; train_edge_recon_loss: 782398.8264; train_gene_expr_recon_loss: 334928.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8859.0433; train_global_loss: 1136789.3600; train_optim_loss: 1136789.3600; val_kl_reg_loss: 7533.4679; val_edge_recon_loss: 805078.4062; val_gene_expr_recon_loss: 334777.8802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8857.0635; val_global_loss: 1156246.8958; val_optim_loss: 1156246.8958
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9360; val_auprc_score: 0.9861; val_best_acc_score: 0.9284; val_best_f1_score: 0.9590; train_kl_reg_loss: 10578.0193; train_edge_recon_loss: 784996.8102; train_gene_expr_recon_loss: 334841.4086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8855.2886; train_global_loss: 1139271.5301; train_optim_loss: 1139271.5301; val_kl_reg_loss: 7514.5163; val_edge_recon_loss: 792765.1458; val_gene_expr_recon_loss: 334705.2292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8853.4609; val_global_loss: 1143838.3750; val_optim_loss: 1143838.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9369; val_auprc_score: 0.9867; val_best_acc_score: 0.9282; val_best_f1_score: 0.9588; train_kl_reg_loss: 10564.0844; train_edge_recon_loss: 790055.6169; train_gene_expr_recon_loss: 334819.1626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8851.7134; train_global_loss: 1144290.5810; train_optim_loss: 1144290.5810; val_kl_reg_loss: 7501.6246; val_edge_recon_loss: 777652.7292; val_gene_expr_recon_loss: 334573.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8849.9092; val_global_loss: 1128577.6250; val_optim_loss: 1128577.6250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9324; val_auprc_score: 0.9847; val_best_acc_score: 0.9280; val_best_f1_score: 0.9588; train_kl_reg_loss: 10547.1235; train_edge_recon_loss: 786476.6667; train_gene_expr_recon_loss: 334707.7674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8848.1770; train_global_loss: 1140579.7384; train_optim_loss: 1140579.7384; val_kl_reg_loss: 7494.3236; val_edge_recon_loss: 796612.4271; val_gene_expr_recon_loss: 334454.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8846.3848; val_global_loss: 1147407.8125; val_optim_loss: 1147407.8125

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 0 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9388
val AUPRC score: 0.9853
val best accuracy score: 0.9254
val best F1 score: 0.9569
val target rna MSE score: 26.5582
val source rna MSE score: 49.8409
Val cat covariate0 mean sim diff: -0.0052

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
