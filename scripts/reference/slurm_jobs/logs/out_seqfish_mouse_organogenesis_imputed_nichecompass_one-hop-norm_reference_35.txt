[True]
Run timestamp: 01082023_073423_35.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_35']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9174; val_auprc_score: 0.9840; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 99254.6434; train_edge_recon_loss: 11768.1007; train_gene_expr_recon_loss: 53159517.4074; train_masked_gp_l1_reg_loss: 14385.1758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59279.5503; train_global_loss: 53344204.5926; train_optim_loss: 53344204.5926; val_kl_reg_loss: 214113.4062; val_edge_recon_loss: 12079.3646; val_gene_expr_recon_loss: 41187251.3333; val_masked_gp_l1_reg_loss: 15559.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55039.9297; val_global_loss: 41484044.0000; val_optim_loss: 41484044.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8916; val_auprc_score: 0.9798; val_best_acc_score: 0.8582; val_best_f1_score: 0.9237; train_kl_reg_loss: 246993.8663; train_edge_recon_loss: 11867.7691; train_gene_expr_recon_loss: 38110299.4074; train_masked_gp_l1_reg_loss: 15475.7964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51653.1500; train_global_loss: 38436289.9259; train_optim_loss: 38436289.9259; val_kl_reg_loss: 249098.3281; val_edge_recon_loss: 11526.2923; val_gene_expr_recon_loss: 34316834.0000; val_masked_gp_l1_reg_loss: 15293.0127; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48422.5703; val_global_loss: 34641175.3333; val_optim_loss: 34641175.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8615; val_auprc_score: 0.9731; val_best_acc_score: 0.8547; val_best_f1_score: 0.9216; train_kl_reg_loss: 253547.0061; train_edge_recon_loss: 11896.1992; train_gene_expr_recon_loss: 29871320.0741; train_masked_gp_l1_reg_loss: 15087.9837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45808.8055; train_global_loss: 30197659.9259; train_optim_loss: 30197659.9259; val_kl_reg_loss: 235375.7578; val_edge_recon_loss: 11878.7886; val_gene_expr_recon_loss: 26032178.3333; val_masked_gp_l1_reg_loss: 14888.5801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43337.3086; val_global_loss: 26337659.3333; val_optim_loss: 26337659.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8453; val_auprc_score: 0.9686; val_best_acc_score: 0.8598; val_best_f1_score: 0.9237; train_kl_reg_loss: 230387.8686; train_edge_recon_loss: 11986.3334; train_gene_expr_recon_loss: 24272787.3704; train_masked_gp_l1_reg_loss: 14746.8958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41432.8189; train_global_loss: 24571341.2963; train_optim_loss: 24571341.2963; val_kl_reg_loss: 206060.4557; val_edge_recon_loss: 12018.2363; val_gene_expr_recon_loss: 23196907.3333; val_masked_gp_l1_reg_loss: 14635.8057; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39713.0117; val_global_loss: 23469336.3333; val_optim_loss: 23469336.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8407; val_auprc_score: 0.9663; val_best_acc_score: 0.8676; val_best_f1_score: 0.9265; train_kl_reg_loss: 199271.5182; train_edge_recon_loss: 11928.8095; train_gene_expr_recon_loss: 22769303.4815; train_masked_gp_l1_reg_loss: 14583.3605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38551.6194; train_global_loss: 23033638.9630; train_optim_loss: 23033638.9630; val_kl_reg_loss: 180175.7812; val_edge_recon_loss: 12312.3213; val_gene_expr_recon_loss: 22450135.0000; val_masked_gp_l1_reg_loss: 14545.5420; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37601.0430; val_global_loss: 22694771.0000; val_optim_loss: 22694771.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8432; val_auprc_score: 0.9663; val_best_acc_score: 0.8635; val_best_f1_score: 0.9257; train_kl_reg_loss: 176438.9378; train_edge_recon_loss: 11850.1179; train_gene_expr_recon_loss: 22224889.1852; train_masked_gp_l1_reg_loss: 14522.1506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37183.8542; train_global_loss: 22464884.1111; train_optim_loss: 22464884.1111; val_kl_reg_loss: 160684.1146; val_edge_recon_loss: 11987.0791; val_gene_expr_recon_loss: 22050049.3333; val_masked_gp_l1_reg_loss: 14504.3535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36992.5117; val_global_loss: 22274216.6667; val_optim_loss: 22274216.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8467; val_auprc_score: 0.9673; val_best_acc_score: 0.8750; val_best_f1_score: 0.9316; train_kl_reg_loss: 159790.7532; train_edge_recon_loss: 11896.5473; train_gene_expr_recon_loss: 21881438.8889; train_masked_gp_l1_reg_loss: 14513.5304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36964.2477; train_global_loss: 22104603.7037; train_optim_loss: 22104603.7037; val_kl_reg_loss: 147043.2865; val_edge_recon_loss: 11669.2913; val_gene_expr_recon_loss: 21783325.0000; val_masked_gp_l1_reg_loss: 14536.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36942.2148; val_global_loss: 21993515.3333; val_optim_loss: 21993515.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8571; val_auprc_score: 0.9704; val_best_acc_score: 0.8788; val_best_f1_score: 0.9332; train_kl_reg_loss: 146915.4236; train_edge_recon_loss: 11875.4493; train_gene_expr_recon_loss: 21610686.6296; train_masked_gp_l1_reg_loss: 14579.1100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36923.1913; train_global_loss: 21820979.6296; train_optim_loss: 21820979.6296; val_kl_reg_loss: 136144.3958; val_edge_recon_loss: 11486.4165; val_gene_expr_recon_loss: 21506453.6667; val_masked_gp_l1_reg_loss: 14626.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36904.1094; val_global_loss: 21705614.6667; val_optim_loss: 21705614.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8631; val_auprc_score: 0.9718; val_best_acc_score: 0.8777; val_best_f1_score: 0.9319; train_kl_reg_loss: 136617.7433; train_edge_recon_loss: 11861.5464; train_gene_expr_recon_loss: 21369521.3704; train_masked_gp_l1_reg_loss: 14678.4278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36884.7333; train_global_loss: 21569563.6296; train_optim_loss: 21569563.6296; val_kl_reg_loss: 127336.9753; val_edge_recon_loss: 11576.0155; val_gene_expr_recon_loss: 21251357.0000; val_masked_gp_l1_reg_loss: 14723.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36864.5391; val_global_loss: 21441858.0000; val_optim_loss: 21441858.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8611; val_auprc_score: 0.9701; val_best_acc_score: 0.8726; val_best_f1_score: 0.9298; train_kl_reg_loss: 128437.8727; train_edge_recon_loss: 11901.8631; train_gene_expr_recon_loss: 21160167.3333; train_masked_gp_l1_reg_loss: 14769.2471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36843.7488; train_global_loss: 21352120.1852; train_optim_loss: 21352120.1852; val_kl_reg_loss: 120338.7617; val_edge_recon_loss: 11860.4258; val_gene_expr_recon_loss: 21076044.6667; val_masked_gp_l1_reg_loss: 14814.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36821.2266; val_global_loss: 21259880.3333; val_optim_loss: 21259880.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8785; val_auprc_score: 0.9752; val_best_acc_score: 0.8797; val_best_f1_score: 0.9336; train_kl_reg_loss: 121679.8048; train_edge_recon_loss: 11719.1572; train_gene_expr_recon_loss: 20961471.6667; train_masked_gp_l1_reg_loss: 14853.8369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36799.8025; train_global_loss: 21146524.1852; train_optim_loss: 21146524.1852; val_kl_reg_loss: 114297.4010; val_edge_recon_loss: 11451.2648; val_gene_expr_recon_loss: 20881122.6667; val_masked_gp_l1_reg_loss: 14898.9561; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36776.8789; val_global_loss: 21058545.3333; val_optim_loss: 21058545.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8796; val_auprc_score: 0.9742; val_best_acc_score: 0.8777; val_best_f1_score: 0.9312; train_kl_reg_loss: 115716.5493; train_edge_recon_loss: 11717.2904; train_gene_expr_recon_loss: 20779713.6667; train_masked_gp_l1_reg_loss: 14933.2035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36754.7309; train_global_loss: 20958835.4444; train_optim_loss: 20958835.4444; val_kl_reg_loss: 109362.2839; val_edge_recon_loss: 11846.5742; val_gene_expr_recon_loss: 20711180.0000; val_masked_gp_l1_reg_loss: 14971.9092; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36731.5781; val_global_loss: 20884092.6667; val_optim_loss: 20884092.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8851; val_auprc_score: 0.9749; val_best_acc_score: 0.8809; val_best_f1_score: 0.9316; train_kl_reg_loss: 110763.1602; train_edge_recon_loss: 11628.3699; train_gene_expr_recon_loss: 20616829.3704; train_masked_gp_l1_reg_loss: 15006.3959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36709.3963; train_global_loss: 20790936.7407; train_optim_loss: 20790936.7407; val_kl_reg_loss: 104929.7201; val_edge_recon_loss: 11945.0047; val_gene_expr_recon_loss: 20565078.6667; val_masked_gp_l1_reg_loss: 15048.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36686.2422; val_global_loss: 20733687.6667; val_optim_loss: 20733687.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8848; val_auprc_score: 0.9752; val_best_acc_score: 0.8813; val_best_f1_score: 0.9316; train_kl_reg_loss: 106278.5522; train_edge_recon_loss: 11836.8189; train_gene_expr_recon_loss: 20460848.7778; train_masked_gp_l1_reg_loss: 15088.5543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36663.3972; train_global_loss: 20630716.1111; train_optim_loss: 20630716.1111; val_kl_reg_loss: 100645.0260; val_edge_recon_loss: 11827.4487; val_gene_expr_recon_loss: 20406730.0000; val_masked_gp_l1_reg_loss: 15127.8809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36640.0469; val_global_loss: 20570970.6667; val_optim_loss: 20570970.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8895; val_auprc_score: 0.9766; val_best_acc_score: 0.8833; val_best_f1_score: 0.9321; train_kl_reg_loss: 102305.9314; train_edge_recon_loss: 11637.1714; train_gene_expr_recon_loss: 20314602.0000; train_masked_gp_l1_reg_loss: 15167.7458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36616.7914; train_global_loss: 20480329.8148; train_optim_loss: 20480329.8148; val_kl_reg_loss: 96738.8464; val_edge_recon_loss: 11987.0063; val_gene_expr_recon_loss: 20260643.6667; val_masked_gp_l1_reg_loss: 15214.9717; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36592.3086; val_global_loss: 20421175.6667; val_optim_loss: 20421175.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8932; val_auprc_score: 0.9773; val_best_acc_score: 0.8864; val_best_f1_score: 0.9339; train_kl_reg_loss: 98673.4392; train_edge_recon_loss: 11720.5567; train_gene_expr_recon_loss: 20173946.4074; train_masked_gp_l1_reg_loss: 15252.8994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36568.2857; train_global_loss: 20336161.5556; train_optim_loss: 20336161.5556; val_kl_reg_loss: 93424.3906; val_edge_recon_loss: 11537.5669; val_gene_expr_recon_loss: 20119325.6667; val_masked_gp_l1_reg_loss: 15295.4697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36543.6562; val_global_loss: 20276127.6667; val_optim_loss: 20276127.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8918; val_auprc_score: 0.9757; val_best_acc_score: 0.8845; val_best_f1_score: 0.9332; train_kl_reg_loss: 95324.3595; train_edge_recon_loss: 11682.7912; train_gene_expr_recon_loss: 20040535.5185; train_masked_gp_l1_reg_loss: 15336.4689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36519.8166; train_global_loss: 20199398.8519; train_optim_loss: 20199398.8519; val_kl_reg_loss: 90815.9232; val_edge_recon_loss: 12007.0573; val_gene_expr_recon_loss: 20009821.6667; val_masked_gp_l1_reg_loss: 15381.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36495.6953; val_global_loss: 20164522.6667; val_optim_loss: 20164522.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9036; val_auprc_score: 0.9797; val_best_acc_score: 0.8882; val_best_f1_score: 0.9360; train_kl_reg_loss: 92318.3604; train_edge_recon_loss: 11526.3655; train_gene_expr_recon_loss: 19910929.1481; train_masked_gp_l1_reg_loss: 15422.0584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36473.2478; train_global_loss: 20066669.1852; train_optim_loss: 20066669.1852; val_kl_reg_loss: 87618.8568; val_edge_recon_loss: 11682.7739; val_gene_expr_recon_loss: 19877709.3333; val_masked_gp_l1_reg_loss: 15463.9111; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36448.8906; val_global_loss: 20028923.0000; val_optim_loss: 20028923.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8997; val_auprc_score: 0.9775; val_best_acc_score: 0.8892; val_best_f1_score: 0.9371; train_kl_reg_loss: 89542.5995; train_edge_recon_loss: 11621.9969; train_gene_expr_recon_loss: 19779197.3704; train_masked_gp_l1_reg_loss: 15502.6811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36428.1607; train_global_loss: 19932292.9630; train_optim_loss: 19932292.9630; val_kl_reg_loss: 85047.0573; val_edge_recon_loss: 11747.3880; val_gene_expr_recon_loss: 19733657.3333; val_masked_gp_l1_reg_loss: 15541.5996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36407.1680; val_global_loss: 19882402.3333; val_optim_loss: 19882402.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9058; val_auprc_score: 0.9807; val_best_acc_score: 0.8910; val_best_f1_score: 0.9379; train_kl_reg_loss: 86898.2177; train_edge_recon_loss: 11606.2178; train_gene_expr_recon_loss: 19659042.5556; train_masked_gp_l1_reg_loss: 15578.5843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36387.6780; train_global_loss: 19809513.2963; train_optim_loss: 19809513.2963; val_kl_reg_loss: 82785.3529; val_edge_recon_loss: 11728.7881; val_gene_expr_recon_loss: 19605258.3333; val_masked_gp_l1_reg_loss: 15617.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36368.2773; val_global_loss: 19751758.3333; val_optim_loss: 19751758.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9090; val_auprc_score: 0.9806; val_best_acc_score: 0.8952; val_best_f1_score: 0.9402; train_kl_reg_loss: 84552.0948; train_edge_recon_loss: 11748.2739; train_gene_expr_recon_loss: 19537010.5185; train_masked_gp_l1_reg_loss: 15655.2334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36350.1155; train_global_loss: 19685316.2963; train_optim_loss: 19685316.2963; val_kl_reg_loss: 79955.5638; val_edge_recon_loss: 11571.1706; val_gene_expr_recon_loss: 19488011.6667; val_masked_gp_l1_reg_loss: 15697.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36332.1172; val_global_loss: 19631568.3333; val_optim_loss: 19631568.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9101; val_auprc_score: 0.9816; val_best_acc_score: 0.8962; val_best_f1_score: 0.9406; train_kl_reg_loss: 82312.6573; train_edge_recon_loss: 11469.9645; train_gene_expr_recon_loss: 19418157.4444; train_masked_gp_l1_reg_loss: 15734.4665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36316.8851; train_global_loss: 19563991.2593; train_optim_loss: 19563991.2593; val_kl_reg_loss: 78244.0339; val_edge_recon_loss: 11679.6449; val_gene_expr_recon_loss: 19372328.6667; val_masked_gp_l1_reg_loss: 15775.8262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36302.7578; val_global_loss: 19514330.3333; val_optim_loss: 19514330.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9080; val_auprc_score: 0.9808; val_best_acc_score: 0.8957; val_best_f1_score: 0.9403; train_kl_reg_loss: 80167.2695; train_edge_recon_loss: 11537.7881; train_gene_expr_recon_loss: 19299158.7407; train_masked_gp_l1_reg_loss: 15814.2384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36287.8573; train_global_loss: 19442965.6296; train_optim_loss: 19442965.6296; val_kl_reg_loss: 76295.2539; val_edge_recon_loss: 11433.4808; val_gene_expr_recon_loss: 19262193.0000; val_masked_gp_l1_reg_loss: 15858.2510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36274.1641; val_global_loss: 19402054.0000; val_optim_loss: 19402054.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9123; val_auprc_score: 0.9819; val_best_acc_score: 0.8957; val_best_f1_score: 0.9402; train_kl_reg_loss: 78296.0841; train_edge_recon_loss: 11536.6153; train_gene_expr_recon_loss: 19186429.7778; train_masked_gp_l1_reg_loss: 15896.8302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36260.8173; train_global_loss: 19328420.1481; train_optim_loss: 19328420.1481; val_kl_reg_loss: 74647.6771; val_edge_recon_loss: 11421.3888; val_gene_expr_recon_loss: 19161935.3333; val_masked_gp_l1_reg_loss: 15940.2832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36247.9453; val_global_loss: 19300192.6667; val_optim_loss: 19300192.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9085; val_auprc_score: 0.9804; val_best_acc_score: 0.8950; val_best_f1_score: 0.9394; train_kl_reg_loss: 76475.3955; train_edge_recon_loss: 11553.6066; train_gene_expr_recon_loss: 19080302.4074; train_masked_gp_l1_reg_loss: 15979.3752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36236.4247; train_global_loss: 19220547.1852; train_optim_loss: 19220547.1852; val_kl_reg_loss: 72951.5781; val_edge_recon_loss: 11840.4658; val_gene_expr_recon_loss: 19051072.3333; val_masked_gp_l1_reg_loss: 16026.5283; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36225.1211; val_global_loss: 19188116.0000; val_optim_loss: 19188116.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8493; val_auprc_score: 0.9690; val_best_acc_score: 0.8591; val_best_f1_score: 0.9234; train_kl_reg_loss: 49209.0685; train_edge_recon_loss: 11973.6476; train_gene_expr_recon_loss: 45605173.9630; train_masked_gp_l1_reg_loss: 19563.2591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35193.3218; train_global_loss: 45721113.1111; train_optim_loss: 45721113.1111; val_kl_reg_loss: 46668.6224; val_edge_recon_loss: 11984.5578; val_gene_expr_recon_loss: 36686382.6667; val_masked_gp_l1_reg_loss: 22068.0293; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34768.4492; val_global_loss: 36801872.0000; val_optim_loss: 36801872.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8412; val_auprc_score: 0.9676; val_best_acc_score: 0.8664; val_best_f1_score: 0.9268; train_kl_reg_loss: 52312.0034; train_edge_recon_loss: 11913.8439; train_gene_expr_recon_loss: 34166047.7037; train_masked_gp_l1_reg_loss: 22079.6108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34740.5195; train_global_loss: 34287093.7778; train_optim_loss: 34287093.7778; val_kl_reg_loss: 54866.3874; val_edge_recon_loss: 11947.1965; val_gene_expr_recon_loss: 32113832.6667; val_masked_gp_l1_reg_loss: 21993.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34713.5430; val_global_loss: 32237354.3333; val_optim_loss: 32237354.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8450; val_auprc_score: 0.9682; val_best_acc_score: 0.8690; val_best_f1_score: 0.9281; train_kl_reg_loss: 60684.7892; train_edge_recon_loss: 11821.9170; train_gene_expr_recon_loss: 30121528.5556; train_masked_gp_l1_reg_loss: 21918.1166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34687.4928; train_global_loss: 30250640.8519; train_optim_loss: 30250640.8519; val_kl_reg_loss: 59698.7734; val_edge_recon_loss: 11711.1549; val_gene_expr_recon_loss: 28456967.0000; val_masked_gp_l1_reg_loss: 21848.6543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34660.2695; val_global_loss: 28584884.6667; val_optim_loss: 28584884.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8504; val_auprc_score: 0.9693; val_best_acc_score: 0.8713; val_best_f1_score: 0.9293; train_kl_reg_loss: 62036.2004; train_edge_recon_loss: 11748.0937; train_gene_expr_recon_loss: 27047216.7037; train_masked_gp_l1_reg_loss: 21792.3000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34633.3818; train_global_loss: 27177426.7037; train_optim_loss: 27177426.7037; val_kl_reg_loss: 58870.1921; val_edge_recon_loss: 11695.5252; val_gene_expr_recon_loss: 25928914.0000; val_masked_gp_l1_reg_loss: 21736.3379; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34605.3984; val_global_loss: 26055822.0000; val_optim_loss: 26055822.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8484; val_auprc_score: 0.9683; val_best_acc_score: 0.8730; val_best_f1_score: 0.9301; train_kl_reg_loss: 61360.6287; train_edge_recon_loss: 11755.6223; train_gene_expr_recon_loss: 25735803.4074; train_masked_gp_l1_reg_loss: 21720.3666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34586.5718; train_global_loss: 25865226.4444; train_optim_loss: 25865226.4444; val_kl_reg_loss: 58529.2975; val_edge_recon_loss: 11629.7352; val_gene_expr_recon_loss: 25729745.3333; val_masked_gp_l1_reg_loss: 21708.9082; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34580.2773; val_global_loss: 25856192.3333; val_optim_loss: 25856192.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8536; val_auprc_score: 0.9683; val_best_acc_score: 0.8707; val_best_f1_score: 0.9288; train_kl_reg_loss: 61182.2432; train_edge_recon_loss: 11946.2555; train_gene_expr_recon_loss: 25538328.1111; train_masked_gp_l1_reg_loss: 21702.1608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34577.2892; train_global_loss: 25667736.0000; train_optim_loss: 25667736.0000; val_kl_reg_loss: 58503.9076; val_edge_recon_loss: 11842.4359; val_gene_expr_recon_loss: 25584608.0000; val_masked_gp_l1_reg_loss: 21694.6895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34574.2422; val_global_loss: 25711222.6667; val_optim_loss: 25711222.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8569; val_auprc_score: 0.9703; val_best_acc_score: 0.8747; val_best_f1_score: 0.9310; train_kl_reg_loss: 61031.9421; train_edge_recon_loss: 11821.5147; train_gene_expr_recon_loss: 25369906.5926; train_masked_gp_l1_reg_loss: 21688.2029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34571.2932; train_global_loss: 25499019.6296; train_optim_loss: 25499019.6296; val_kl_reg_loss: 58192.5729; val_edge_recon_loss: 11499.8700; val_gene_expr_recon_loss: 25347647.3333; val_masked_gp_l1_reg_loss: 21682.1191; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34568.2070; val_global_loss: 25473589.6667; val_optim_loss: 25473589.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8582; val_auprc_score: 0.9705; val_best_acc_score: 0.8739; val_best_f1_score: 0.9310; train_kl_reg_loss: 60892.7208; train_edge_recon_loss: 11817.0197; train_gene_expr_recon_loss: 25223306.1852; train_masked_gp_l1_reg_loss: 21674.7552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34565.1230; train_global_loss: 25352255.8519; train_optim_loss: 25352255.8519; val_kl_reg_loss: 58121.9193; val_edge_recon_loss: 11529.7954; val_gene_expr_recon_loss: 25210745.0000; val_masked_gp_l1_reg_loss: 21668.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34561.8516; val_global_loss: 25336626.6667; val_optim_loss: 25336626.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 2 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9153
val AUPRC score: 0.9825
val best accuracy score: 0.9017
val best F1 score: 0.9433
val target rna MSE score: 153.6332
val source rna MSE score: 398.4494
Val cat covariate0 mean sim diff: 0.0002

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
