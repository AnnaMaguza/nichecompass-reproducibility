Run timestamp: 14062023_181717.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cond_contrastive', '10000.', '--contrastive_logits_ratio', '0.015625', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 500, n_cond_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 803, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 803, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 803, n_cond_embed_input: 500, n_addon_input: 0, n_output: 1000
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 500, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 759633
Number of validation nodes: 84404
Number of training edges: 5242555
Number of validation edges: 582506
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9899; val_auprc_score: 0.9966; val_best_acc_score: 0.9623; val_best_f1_score: 0.9756; train_kl_reg_loss: 5597.5883; train_edge_recon_loss: 1237575.5839; train_cond_contrastive_loss: 3779.3920; train_gene_expr_recon_loss: 1170557.1202; train_masked_gp_l1_reg_loss: 1780.7722; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2419290.4573; train_optim_loss: 2419290.4573; val_kl_reg_loss: 5594.9495; val_edge_recon_loss: 1231689.3168; val_cond_contrastive_loss: 3976.2124; val_gene_expr_recon_loss: 1139936.1336; val_masked_gp_l1_reg_loss: 2121.7332; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2383318.3607; val_optim_loss: 2383318.3607
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9922; val_auprc_score: 0.9973; val_best_acc_score: 0.9691; val_best_f1_score: 0.9799; train_kl_reg_loss: 5730.7807; train_edge_recon_loss: 1221594.7916; train_cond_contrastive_loss: 4050.7483; train_gene_expr_recon_loss: 1132578.9055; train_masked_gp_l1_reg_loss: 2179.3162; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2366134.5420; train_optim_loss: 2366134.5420; val_kl_reg_loss: 5817.1253; val_edge_recon_loss: 1227822.2931; val_cond_contrastive_loss: 4090.9868; val_gene_expr_recon_loss: 1126279.5164; val_masked_gp_l1_reg_loss: 2198.0813; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2366207.9218; val_optim_loss: 2366207.9218
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9925; val_auprc_score: 0.9974; val_best_acc_score: 0.9696; val_best_f1_score: 0.9802; train_kl_reg_loss: 5971.9771; train_edge_recon_loss: 1219760.9720; train_cond_contrastive_loss: 4097.4872; train_gene_expr_recon_loss: 1121150.9340; train_masked_gp_l1_reg_loss: 2178.3766; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2353159.7455; train_optim_loss: 2353159.7455; val_kl_reg_loss: 6058.7942; val_edge_recon_loss: 1230341.6498; val_cond_contrastive_loss: 4114.2762; val_gene_expr_recon_loss: 1116342.3017; val_masked_gp_l1_reg_loss: 2163.3909; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2359020.5237; val_optim_loss: 2359020.5237
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9931; val_auprc_score: 0.9976; val_best_acc_score: 0.9715; val_best_f1_score: 0.9815; train_kl_reg_loss: 6149.2507; train_edge_recon_loss: 1218447.8234; train_cond_contrastive_loss: 4129.2051; train_gene_expr_recon_loss: 1114411.5745; train_masked_gp_l1_reg_loss: 2128.8908; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2345266.7424; train_optim_loss: 2345266.7424; val_kl_reg_loss: 6133.6538; val_edge_recon_loss: 1227122.9866; val_cond_contrastive_loss: 4130.8527; val_gene_expr_recon_loss: 1107321.9707; val_masked_gp_l1_reg_loss: 2102.8323; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2346812.2179; val_optim_loss: 2346812.2179
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9934; val_auprc_score: 0.9977; val_best_acc_score: 0.9727; val_best_f1_score: 0.9823; train_kl_reg_loss: 6321.8788; train_edge_recon_loss: 1217986.0587; train_cond_contrastive_loss: 4153.0581; train_gene_expr_recon_loss: 1101052.8871; train_masked_gp_l1_reg_loss: 2080.2584; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2331594.1407; train_optim_loss: 2331594.1407; val_kl_reg_loss: 6311.4624; val_edge_recon_loss: 1227799.9780; val_cond_contrastive_loss: 4170.3420; val_gene_expr_recon_loss: 1085658.3124; val_masked_gp_l1_reg_loss: 2055.8230; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2325995.8431; val_optim_loss: 2325995.8431
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9940; val_auprc_score: 0.9978; val_best_acc_score: 0.9736; val_best_f1_score: 0.9829; train_kl_reg_loss: 6458.1088; train_edge_recon_loss: 1217174.1494; train_cond_contrastive_loss: 4164.7236; train_gene_expr_recon_loss: 1086793.0855; train_masked_gp_l1_reg_loss: 2029.1174; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2316619.1860; train_optim_loss: 2316619.1860; val_kl_reg_loss: 6419.1806; val_edge_recon_loss: 1225129.5738; val_cond_contrastive_loss: 4177.6943; val_gene_expr_recon_loss: 1087618.2817; val_masked_gp_l1_reg_loss: 2005.4747; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2325350.2272; val_optim_loss: 2325350.2272
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9935; val_auprc_score: 0.9978; val_best_acc_score: 0.9724; val_best_f1_score: 0.9821; train_kl_reg_loss: 6595.9457; train_edge_recon_loss: 1217281.1199; train_cond_contrastive_loss: 4178.2187; train_gene_expr_recon_loss: 1081277.6156; train_masked_gp_l1_reg_loss: 1983.8537; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2311316.7530; train_optim_loss: 2311316.7530; val_kl_reg_loss: 6764.5795; val_edge_recon_loss: 1226019.9668; val_cond_contrastive_loss: 4160.5414; val_gene_expr_recon_loss: 1081896.6576; val_masked_gp_l1_reg_loss: 1966.1987; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2320807.9925; val_optim_loss: 2320807.9925
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9944; val_auprc_score: 0.9981; val_best_acc_score: 0.9745; val_best_f1_score: 0.9834; train_kl_reg_loss: 6685.4559; train_edge_recon_loss: 1216333.7304; train_cond_contrastive_loss: 4185.9148; train_gene_expr_recon_loss: 1073228.0753; train_masked_gp_l1_reg_loss: 1944.2744; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2302377.4489; train_optim_loss: 2302377.4489; val_kl_reg_loss: 6568.1026; val_edge_recon_loss: 1226663.3710; val_cond_contrastive_loss: 4198.8114; val_gene_expr_recon_loss: 1070616.3809; val_masked_gp_l1_reg_loss: 1925.5438; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2309972.1656; val_optim_loss: 2309972.1656
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9941; val_auprc_score: 0.9979; val_best_acc_score: 0.9747; val_best_f1_score: 0.9835; train_kl_reg_loss: 6785.5229; train_edge_recon_loss: 1216887.9723; train_cond_contrastive_loss: 4188.8027; train_gene_expr_recon_loss: 1066379.2690; train_masked_gp_l1_reg_loss: 1913.7896; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2296155.3594; train_optim_loss: 2296155.3594; val_kl_reg_loss: 6718.6892; val_edge_recon_loss: 1224081.3537; val_cond_contrastive_loss: 4178.8253; val_gene_expr_recon_loss: 1067186.9934; val_masked_gp_l1_reg_loss: 1908.6042; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2304074.3642; val_optim_loss: 2304074.3642
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9943; val_auprc_score: 0.9980; val_best_acc_score: 0.9747; val_best_f1_score: 0.9835; train_kl_reg_loss: 6845.2333; train_edge_recon_loss: 1217053.7293; train_cond_contrastive_loss: 4204.5428; train_gene_expr_recon_loss: 1066095.4414; train_masked_gp_l1_reg_loss: 1892.6402; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2296091.5890; train_optim_loss: 2296091.5890; val_kl_reg_loss: 6796.9187; val_edge_recon_loss: 1223439.5384; val_cond_contrastive_loss: 4200.9085; val_gene_expr_recon_loss: 1065012.6946; val_masked_gp_l1_reg_loss: 1881.8179; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2301331.8133; val_optim_loss: 2301331.8133
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9943; val_auprc_score: 0.9980; val_best_acc_score: 0.9749; val_best_f1_score: 0.9837; train_kl_reg_loss: 6932.1212; train_edge_recon_loss: 1216057.0551; train_cond_contrastive_loss: 4207.7668; train_gene_expr_recon_loss: 1063514.7499; train_masked_gp_l1_reg_loss: 1877.8617; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2292589.5555; train_optim_loss: 2292589.5555; val_kl_reg_loss: 6908.2540; val_edge_recon_loss: 1227086.3812; val_cond_contrastive_loss: 4206.6524; val_gene_expr_recon_loss: 1064825.4737; val_masked_gp_l1_reg_loss: 1870.4814; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2304897.2641; val_optim_loss: 2304897.2641
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9941; val_auprc_score: 0.9979; val_best_acc_score: 0.9747; val_best_f1_score: 0.9836; train_kl_reg_loss: 7003.2448; train_edge_recon_loss: 1216574.9314; train_cond_contrastive_loss: 4211.0624; train_gene_expr_recon_loss: 1062671.0943; train_masked_gp_l1_reg_loss: 1861.5846; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2292321.9168; train_optim_loss: 2292321.9168; val_kl_reg_loss: 6981.1154; val_edge_recon_loss: 1221074.3317; val_cond_contrastive_loss: 4167.2054; val_gene_expr_recon_loss: 1088418.3078; val_masked_gp_l1_reg_loss: 1849.6064; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2322490.4569; val_optim_loss: 2322490.4569
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9946; val_auprc_score: 0.9981; val_best_acc_score: 0.9758; val_best_f1_score: 0.9843; train_kl_reg_loss: 7044.0682; train_edge_recon_loss: 1216487.5469; train_cond_contrastive_loss: 4216.9789; train_gene_expr_recon_loss: 1059554.1563; train_masked_gp_l1_reg_loss: 1848.8534; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2289151.6015; train_optim_loss: 2289151.6015; val_kl_reg_loss: 7075.0040; val_edge_recon_loss: 1222174.4427; val_cond_contrastive_loss: 4215.1467; val_gene_expr_recon_loss: 1060342.3406; val_masked_gp_l1_reg_loss: 1844.3962; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2295651.4328; val_optim_loss: 2295651.4328
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9946; val_auprc_score: 0.9981; val_best_acc_score: 0.9756; val_best_f1_score: 0.9841; train_kl_reg_loss: 7095.7120; train_edge_recon_loss: 1215854.3833; train_cond_contrastive_loss: 4222.9820; train_gene_expr_recon_loss: 1057588.5962; train_masked_gp_l1_reg_loss: 1836.4072; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2286598.0811; train_optim_loss: 2286598.0811; val_kl_reg_loss: 7049.4482; val_edge_recon_loss: 1224164.2166; val_cond_contrastive_loss: 4206.3905; val_gene_expr_recon_loss: 1059209.6574; val_masked_gp_l1_reg_loss: 1829.2446; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2296458.9750; val_optim_loss: 2296458.9750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9944; val_auprc_score: 0.9980; val_best_acc_score: 0.9754; val_best_f1_score: 0.9840; train_kl_reg_loss: 7134.7478; train_edge_recon_loss: 1214440.8040; train_cond_contrastive_loss: 4227.6526; train_gene_expr_recon_loss: 1057094.5607; train_masked_gp_l1_reg_loss: 1822.4879; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2284720.2544; train_optim_loss: 2284720.2544; val_kl_reg_loss: 7227.2580; val_edge_recon_loss: 1224436.8302; val_cond_contrastive_loss: 4206.1514; val_gene_expr_recon_loss: 1059170.5335; val_masked_gp_l1_reg_loss: 1815.3518; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2296856.0299; val_optim_loss: 2296856.0299
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9945; val_auprc_score: 0.9981; val_best_acc_score: 0.9766; val_best_f1_score: 0.9848; train_kl_reg_loss: 7177.5321; train_edge_recon_loss: 1214657.7383; train_cond_contrastive_loss: 4223.7790; train_gene_expr_recon_loss: 1056900.9621; train_masked_gp_l1_reg_loss: 1810.5700; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2284770.5807; train_optim_loss: 2284770.5807; val_kl_reg_loss: 7164.7007; val_edge_recon_loss: 1220217.9073; val_cond_contrastive_loss: 4209.3111; val_gene_expr_recon_loss: 1058779.2525; val_masked_gp_l1_reg_loss: 1802.1031; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2292173.1731; val_optim_loss: 2292173.1731
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9944; val_auprc_score: 0.9980; val_best_acc_score: 0.9758; val_best_f1_score: 0.9843; train_kl_reg_loss: 7208.1885; train_edge_recon_loss: 1215751.6895; train_cond_contrastive_loss: 4230.9303; train_gene_expr_recon_loss: 1056675.7637; train_masked_gp_l1_reg_loss: 1803.5874; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2285670.1552; train_optim_loss: 2285670.1552; val_kl_reg_loss: 7208.4990; val_edge_recon_loss: 1224620.2608; val_cond_contrastive_loss: 4230.6952; val_gene_expr_recon_loss: 1058625.4139; val_masked_gp_l1_reg_loss: 1792.6492; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2296477.6208; val_optim_loss: 2296477.6208
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9948; val_auprc_score: 0.9982; val_best_acc_score: 0.9768; val_best_f1_score: 0.9849; train_kl_reg_loss: 7235.4434; train_edge_recon_loss: 1215044.9427; train_cond_contrastive_loss: 4230.5814; train_gene_expr_recon_loss: 1056101.0517; train_masked_gp_l1_reg_loss: 1793.7951; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2284405.8174; train_optim_loss: 2284405.8174; val_kl_reg_loss: 7240.1059; val_edge_recon_loss: 1223892.6393; val_cond_contrastive_loss: 4236.2700; val_gene_expr_recon_loss: 1057491.1039; val_masked_gp_l1_reg_loss: 1794.7078; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2294654.8686; val_optim_loss: 2294654.8686
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9947; val_auprc_score: 0.9981; val_best_acc_score: 0.9763; val_best_f1_score: 0.9846; train_kl_reg_loss: 7265.0656; train_edge_recon_loss: 1216064.0496; train_cond_contrastive_loss: 4229.4157; train_gene_expr_recon_loss: 1055795.4327; train_masked_gp_l1_reg_loss: 1788.3916; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2285142.3561; train_optim_loss: 2285142.3561; val_kl_reg_loss: 7111.8809; val_edge_recon_loss: 1221961.1322; val_cond_contrastive_loss: 4226.3739; val_gene_expr_recon_loss: 1057254.3463; val_masked_gp_l1_reg_loss: 1779.9392; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2292333.7373; val_optim_loss: 2292333.7373

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9952; val_auprc_score: 0.9983; val_best_acc_score: 0.9777; val_best_f1_score: 0.9855; train_kl_reg_loss: 7301.2551; train_edge_recon_loss: 1213793.3972; train_cond_contrastive_loss: 4244.3127; train_gene_expr_recon_loss: 1051326.0989; train_masked_gp_l1_reg_loss: 1643.4894; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2278308.5546; train_optim_loss: 2278308.5546; val_kl_reg_loss: 7236.1280; val_edge_recon_loss: 1222792.5059; val_cond_contrastive_loss: 4240.5486; val_gene_expr_recon_loss: 1054146.6167; val_masked_gp_l1_reg_loss: 1616.4731; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2290032.3012; val_optim_loss: 2290032.3012
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9952; val_auprc_score: 0.9983; val_best_acc_score: 0.9776; val_best_f1_score: 0.9855; train_kl_reg_loss: 7333.7016; train_edge_recon_loss: 1213429.3502; train_cond_contrastive_loss: 4252.1790; train_gene_expr_recon_loss: 1050795.6081; train_masked_gp_l1_reg_loss: 1610.4080; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2277421.2437; train_optim_loss: 2277421.2437; val_kl_reg_loss: 7266.9946; val_edge_recon_loss: 1222423.8330; val_cond_contrastive_loss: 4249.2141; val_gene_expr_recon_loss: 1053489.5099; val_masked_gp_l1_reg_loss: 1605.5211; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2289035.0510; val_optim_loss: 2289035.0510
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9953; val_auprc_score: 0.9983; val_best_acc_score: 0.9780; val_best_f1_score: 0.9857; train_kl_reg_loss: 7313.8019; train_edge_recon_loss: 1214075.6578; train_cond_contrastive_loss: 4258.5536; train_gene_expr_recon_loss: 1050519.6447; train_masked_gp_l1_reg_loss: 1604.9502; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2277772.6086; train_optim_loss: 2277772.6086; val_kl_reg_loss: 7230.4772; val_edge_recon_loss: 1219904.5185; val_cond_contrastive_loss: 4244.3112; val_gene_expr_recon_loss: 1053544.0029; val_masked_gp_l1_reg_loss: 1603.6863; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2286527.0620; val_optim_loss: 2286527.0620
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9955; val_auprc_score: 0.9984; val_best_acc_score: 0.9783; val_best_f1_score: 0.9859; train_kl_reg_loss: 7297.6485; train_edge_recon_loss: 1213223.9192; train_cond_contrastive_loss: 4258.6261; train_gene_expr_recon_loss: 1050356.1133; train_masked_gp_l1_reg_loss: 1604.7537; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2276741.0594; train_optim_loss: 2276741.0594; val_kl_reg_loss: 7213.4878; val_edge_recon_loss: 1223708.3822; val_cond_contrastive_loss: 4251.8881; val_gene_expr_recon_loss: 1053838.2903; val_masked_gp_l1_reg_loss: 1603.8296; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2290615.7975; val_optim_loss: 2290615.7975
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9952; val_auprc_score: 0.9983; val_best_acc_score: 0.9776; val_best_f1_score: 0.9855; train_kl_reg_loss: 7288.2637; train_edge_recon_loss: 1214058.4517; train_cond_contrastive_loss: 4259.0794; train_gene_expr_recon_loss: 1049899.8919; train_masked_gp_l1_reg_loss: 1606.6809; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2277112.3666; train_optim_loss: 2277112.3666; val_kl_reg_loss: 7183.0297; val_edge_recon_loss: 1222553.7225; val_cond_contrastive_loss: 4253.5122; val_gene_expr_recon_loss: 1052405.2552; val_masked_gp_l1_reg_loss: 1609.0742; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2288004.5185; val_optim_loss: 2288004.5185
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9954; val_auprc_score: 0.9984; val_best_acc_score: 0.9779; val_best_f1_score: 0.9856; train_kl_reg_loss: 7262.0851; train_edge_recon_loss: 1212733.2478; train_cond_contrastive_loss: 4259.6258; train_gene_expr_recon_loss: 1049766.5226; train_masked_gp_l1_reg_loss: 1611.1446; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2275632.6281; train_optim_loss: 2275632.6281; val_kl_reg_loss: 7172.9452; val_edge_recon_loss: 1222367.7357; val_cond_contrastive_loss: 4259.7999; val_gene_expr_recon_loss: 1053473.0394; val_masked_gp_l1_reg_loss: 1613.7175; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2288887.2711; val_optim_loss: 2288887.2711

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9947; val_auprc_score: 0.9982; val_best_acc_score: 0.9748; val_best_f1_score: 0.9836; train_kl_reg_loss: 6555.5526; train_edge_recon_loss: 1220803.3377; train_cond_contrastive_loss: 4352.3277; train_gene_expr_recon_loss: 1055070.2379; train_masked_gp_l1_reg_loss: 1664.5749; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2288446.0280; train_optim_loss: 2288446.0280; val_kl_reg_loss: 3529.6661; val_edge_recon_loss: 1228957.5062; val_cond_contrastive_loss: 4347.8009; val_gene_expr_recon_loss: 1057321.9026; val_masked_gp_l1_reg_loss: 1699.3093; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2295856.1287; val_optim_loss: 2295856.1287
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9947; val_auprc_score: 0.9982; val_best_acc_score: 0.9752; val_best_f1_score: 0.9839; train_kl_reg_loss: 6216.2211; train_edge_recon_loss: 1219829.6368; train_cond_contrastive_loss: 4337.5927; train_gene_expr_recon_loss: 1052927.7536; train_masked_gp_l1_reg_loss: 1716.1187; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2285027.3231; train_optim_loss: 2285027.3231; val_kl_reg_loss: 3561.5189; val_edge_recon_loss: 1229361.2309; val_cond_contrastive_loss: 4325.2647; val_gene_expr_recon_loss: 1055595.6473; val_masked_gp_l1_reg_loss: 1728.0198; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2294571.6696; val_optim_loss: 2294571.6696
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9949; val_auprc_score: 0.9983; val_best_acc_score: 0.9755; val_best_f1_score: 0.9841; train_kl_reg_loss: 5717.9590; train_edge_recon_loss: 1219687.8337; train_cond_contrastive_loss: 4324.7773; train_gene_expr_recon_loss: 1052354.2385; train_masked_gp_l1_reg_loss: 1733.8950; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2283818.7021; train_optim_loss: 2283818.7021; val_kl_reg_loss: 3602.6810; val_edge_recon_loss: 1229031.9930; val_cond_contrastive_loss: 4320.8594; val_gene_expr_recon_loss: 1055361.7789; val_masked_gp_l1_reg_loss: 1738.8213; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2294056.0576; val_optim_loss: 2294056.0576

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1054 min 37 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9944
Val AUPRC score: 0.9981
Val best accuracy score: 0.9739
Val best F1 score: 0.9830
Val gene expr MSE score: 5.3434

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
