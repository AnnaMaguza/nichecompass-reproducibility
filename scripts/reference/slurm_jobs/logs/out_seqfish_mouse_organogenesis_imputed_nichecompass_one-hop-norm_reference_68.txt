[True]
Run timestamp: 08082023_043921_68.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_68']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9302; val_auprc_score: 0.9863; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 211470.3751; train_edge_recon_loss: 1143827.1496; train_gene_expr_recon_loss: 3972784.4255; train_masked_gp_l1_reg_loss: 20948.3909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176392.1131; train_global_loss: 5525422.4471; train_optim_loss: 5525422.4471; val_kl_reg_loss: 212216.8620; val_edge_recon_loss: 1180489.1458; val_gene_expr_recon_loss: 2569456.8333; val_masked_gp_l1_reg_loss: 20767.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168583.0469; val_global_loss: 4151513.8125; val_optim_loss: 4151513.8125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9296; val_auprc_score: 0.9856; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 234372.9198; train_edge_recon_loss: 1166895.1298; train_gene_expr_recon_loss: 3057991.8029; train_masked_gp_l1_reg_loss: 19604.1199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157889.4507; train_global_loss: 4636753.4087; train_optim_loss: 4636753.4087; val_kl_reg_loss: 196505.4961; val_edge_recon_loss: 1193756.7604; val_gene_expr_recon_loss: 2800274.3958; val_masked_gp_l1_reg_loss: 18719.1777; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146759.4375; val_global_loss: 4356015.2083; val_optim_loss: 4356015.2083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9268; val_auprc_score: 0.9848; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 230049.5467; train_edge_recon_loss: 1168338.0012; train_gene_expr_recon_loss: 2858046.1154; train_masked_gp_l1_reg_loss: 17807.0693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136047.3184; train_global_loss: 4410288.0337; train_optim_loss: 4410288.0337; val_kl_reg_loss: 169973.1823; val_edge_recon_loss: 1199189.1771; val_gene_expr_recon_loss: 2744428.8750; val_masked_gp_l1_reg_loss: 17296.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125549.2891; val_global_loss: 4256437.2917; val_optim_loss: 4256437.2917
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9151; val_auprc_score: 0.9831; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 135996.7919; train_edge_recon_loss: 1127301.3425; train_gene_expr_recon_loss: 2793145.8462; train_masked_gp_l1_reg_loss: 17580.5323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116009.6345; train_global_loss: 4190034.1514; train_optim_loss: 4190034.1514; val_kl_reg_loss: 94272.5039; val_edge_recon_loss: 1205279.0833; val_gene_expr_recon_loss: 2698891.1875; val_masked_gp_l1_reg_loss: 17782.0762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107059.1562; val_global_loss: 4123284.0000; val_optim_loss: 4123284.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9057; val_auprc_score: 0.9817; val_best_acc_score: 0.8542; val_best_f1_score: 0.9213; train_kl_reg_loss: 93902.4476; train_edge_recon_loss: 1086528.4369; train_gene_expr_recon_loss: 2572840.3846; train_masked_gp_l1_reg_loss: 17910.1764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99563.4467; train_global_loss: 3870744.8798; train_optim_loss: 3870744.8798; val_kl_reg_loss: 83066.9883; val_edge_recon_loss: 1185126.8438; val_gene_expr_recon_loss: 2437405.1458; val_masked_gp_l1_reg_loss: 18018.1152; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92409.5234; val_global_loss: 3816026.5000; val_optim_loss: 3816026.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8925; val_auprc_score: 0.9789; val_best_acc_score: 0.8636; val_best_f1_score: 0.9259; train_kl_reg_loss: 80454.3997; train_edge_recon_loss: 1074372.5769; train_gene_expr_recon_loss: 2396225.1827; train_masked_gp_l1_reg_loss: 18028.9074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86296.4748; train_global_loss: 3655377.5288; train_optim_loss: 3655377.5288; val_kl_reg_loss: 70548.3210; val_edge_recon_loss: 1198933.4583; val_gene_expr_recon_loss: 2318418.9167; val_masked_gp_l1_reg_loss: 18071.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80559.9453; val_global_loss: 3686531.8958; val_optim_loss: 3686531.8958
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8704; val_auprc_score: 0.9732; val_best_acc_score: 0.8763; val_best_f1_score: 0.9311; train_kl_reg_loss: 71723.2232; train_edge_recon_loss: 1068252.8071; train_gene_expr_recon_loss: 2274526.3822; train_masked_gp_l1_reg_loss: 18087.5112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75750.9537; train_global_loss: 3508340.8822; train_optim_loss: 3508340.8822; val_kl_reg_loss: 65944.2721; val_edge_recon_loss: 1173338.9167; val_gene_expr_recon_loss: 2248092.2708; val_masked_gp_l1_reg_loss: 18052.5410; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71178.2656; val_global_loss: 3576606.1458; val_optim_loss: 3576606.1458
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8666; val_auprc_score: 0.9693; val_best_acc_score: 0.8980; val_best_f1_score: 0.9423; train_kl_reg_loss: 64950.7507; train_edge_recon_loss: 1057269.1803; train_gene_expr_recon_loss: 2229993.7596; train_masked_gp_l1_reg_loss: 18016.8854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67244.3682; train_global_loss: 3437474.9303; train_optim_loss: 3437474.9303; val_kl_reg_loss: 59884.2354; val_edge_recon_loss: 1156264.3958; val_gene_expr_recon_loss: 2212421.4167; val_masked_gp_l1_reg_loss: 18014.8887; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63466.3750; val_global_loss: 3510051.4583; val_optim_loss: 3510051.4583
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8706; val_auprc_score: 0.9685; val_best_acc_score: 0.9040; val_best_f1_score: 0.9458; train_kl_reg_loss: 57659.2239; train_edge_recon_loss: 1025422.4627; train_gene_expr_recon_loss: 2194994.8053; train_masked_gp_l1_reg_loss: 18109.4687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60151.0204; train_global_loss: 3356336.9808; train_optim_loss: 3356336.9808; val_kl_reg_loss: 56148.5996; val_edge_recon_loss: 1042187.0469; val_gene_expr_recon_loss: 2179405.5625; val_masked_gp_l1_reg_loss: 18278.6895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56968.9219; val_global_loss: 3352988.9792; val_optim_loss: 3352988.9792
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8718; val_auprc_score: 0.9690; val_best_acc_score: 0.9025; val_best_f1_score: 0.9450; train_kl_reg_loss: 60807.3229; train_edge_recon_loss: 977861.9309; train_gene_expr_recon_loss: 2164399.6034; train_masked_gp_l1_reg_loss: 18522.4736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54176.5174; train_global_loss: 3275767.8293; train_optim_loss: 3275767.8293; val_kl_reg_loss: 62335.5677; val_edge_recon_loss: 986625.2500; val_gene_expr_recon_loss: 2152260.9375; val_masked_gp_l1_reg_loss: 18772.1191; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51495.9961; val_global_loss: 3271489.7292; val_optim_loss: 3271489.7292
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8668; val_auprc_score: 0.9690; val_best_acc_score: 0.9054; val_best_f1_score: 0.9468; train_kl_reg_loss: 61587.6582; train_edge_recon_loss: 938911.3618; train_gene_expr_recon_loss: 2136983.1202; train_masked_gp_l1_reg_loss: 18994.6904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49186.7849; train_global_loss: 3205663.6370; train_optim_loss: 3205663.6370; val_kl_reg_loss: 58744.2819; val_edge_recon_loss: 921410.9531; val_gene_expr_recon_loss: 2123573.7917; val_masked_gp_l1_reg_loss: 19215.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46956.1641; val_global_loss: 3169900.5208; val_optim_loss: 3169900.5208
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8679; val_auprc_score: 0.9683; val_best_acc_score: 0.9068; val_best_f1_score: 0.9475; train_kl_reg_loss: 56293.1385; train_edge_recon_loss: 914763.1731; train_gene_expr_recon_loss: 2066095.4760; train_masked_gp_l1_reg_loss: 19548.4779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45112.3176; train_global_loss: 3101812.5649; train_optim_loss: 3101812.5649; val_kl_reg_loss: 53910.3018; val_edge_recon_loss: 927437.5469; val_gene_expr_recon_loss: 2042675.1354; val_masked_gp_l1_reg_loss: 19745.7637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43207.7773; val_global_loss: 3086976.4583; val_optim_loss: 3086976.4583
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8640; val_auprc_score: 0.9676; val_best_acc_score: 0.9081; val_best_f1_score: 0.9485; train_kl_reg_loss: 51706.0870; train_edge_recon_loss: 904863.4579; train_gene_expr_recon_loss: 2027787.9291; train_masked_gp_l1_reg_loss: 19812.7824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41512.5691; train_global_loss: 3045682.8125; train_optim_loss: 3045682.8125; val_kl_reg_loss: 48810.4681; val_edge_recon_loss: 906198.0052; val_gene_expr_recon_loss: 2019073.9583; val_masked_gp_l1_reg_loss: 19861.0020; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39896.0938; val_global_loss: 3033839.4583; val_optim_loss: 3033839.4583
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8647; val_auprc_score: 0.9688; val_best_acc_score: 0.9086; val_best_f1_score: 0.9487; train_kl_reg_loss: 46604.6889; train_edge_recon_loss: 897368.3792; train_gene_expr_recon_loss: 2003405.3365; train_masked_gp_l1_reg_loss: 19862.0080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38417.0673; train_global_loss: 3005657.4904; train_optim_loss: 3005657.4904; val_kl_reg_loss: 43576.8844; val_edge_recon_loss: 898085.6719; val_gene_expr_recon_loss: 1994797.6875; val_masked_gp_l1_reg_loss: 19840.0176; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36996.6445; val_global_loss: 2993297.0000; val_optim_loss: 2993297.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8681; val_auprc_score: 0.9694; val_best_acc_score: 0.9095; val_best_f1_score: 0.9492; train_kl_reg_loss: 41007.7544; train_edge_recon_loss: 891916.3984; train_gene_expr_recon_loss: 1981416.7620; train_masked_gp_l1_reg_loss: 19771.7318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35706.5491; train_global_loss: 2969819.1779; train_optim_loss: 2969819.1779; val_kl_reg_loss: 37433.9196; val_edge_recon_loss: 895520.7552; val_gene_expr_recon_loss: 1971757.9688; val_masked_gp_l1_reg_loss: 19673.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34460.5938; val_global_loss: 2958846.3958; val_optim_loss: 2958846.3958
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8738; val_auprc_score: 0.9705; val_best_acc_score: 0.9140; val_best_f1_score: 0.9517; train_kl_reg_loss: 35282.6637; train_edge_recon_loss: 880532.2806; train_gene_expr_recon_loss: 1959608.9627; train_masked_gp_l1_reg_loss: 19536.5489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33366.9698; train_global_loss: 2928327.4303; train_optim_loss: 2928327.4303; val_kl_reg_loss: 32577.8431; val_edge_recon_loss: 868297.2448; val_gene_expr_recon_loss: 1948948.8646; val_masked_gp_l1_reg_loss: 19375.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32302.3477; val_global_loss: 2901501.4167; val_optim_loss: 2901501.4167
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8807; val_auprc_score: 0.9731; val_best_acc_score: 0.9160; val_best_f1_score: 0.9527; train_kl_reg_loss: 30152.2957; train_edge_recon_loss: 866688.8197; train_gene_expr_recon_loss: 1937557.8678; train_masked_gp_l1_reg_loss: 19177.7285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31432.1979; train_global_loss: 2885008.9135; train_optim_loss: 2885008.9135; val_kl_reg_loss: 27262.3737; val_edge_recon_loss: 854712.4323; val_gene_expr_recon_loss: 1929107.9375; val_masked_gp_l1_reg_loss: 18950.2637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30622.8477; val_global_loss: 2860655.7500; val_optim_loss: 2860655.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8990; val_auprc_score: 0.9763; val_best_acc_score: 0.9218; val_best_f1_score: 0.9556; train_kl_reg_loss: 27113.1952; train_edge_recon_loss: 850217.4790; train_gene_expr_recon_loss: 1916177.7236; train_masked_gp_l1_reg_loss: 18680.3513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29920.4937; train_global_loss: 2842109.2476; train_optim_loss: 2842109.2476; val_kl_reg_loss: 25753.8395; val_edge_recon_loss: 845470.5000; val_gene_expr_recon_loss: 1909793.0104; val_masked_gp_l1_reg_loss: 18380.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29232.2109; val_global_loss: 2828630.3542; val_optim_loss: 2828630.3542
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9118; val_auprc_score: 0.9797; val_best_acc_score: 0.9251; val_best_f1_score: 0.9573; train_kl_reg_loss: 24558.8906; train_edge_recon_loss: 834401.1851; train_gene_expr_recon_loss: 1896804.2524; train_masked_gp_l1_reg_loss: 18041.5294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28547.8641; train_global_loss: 2802353.7212; train_optim_loss: 2802353.7212; val_kl_reg_loss: 22988.8848; val_edge_recon_loss: 842197.5625; val_gene_expr_recon_loss: 1888218.8021; val_masked_gp_l1_reg_loss: 17678.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27867.7734; val_global_loss: 2798951.4375; val_optim_loss: 2798951.4375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9295; val_auprc_score: 0.9838; val_best_acc_score: 0.9351; val_best_f1_score: 0.9628; train_kl_reg_loss: 21943.4957; train_edge_recon_loss: 823734.9904; train_gene_expr_recon_loss: 1878316.9567; train_masked_gp_l1_reg_loss: 17292.3414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27196.6464; train_global_loss: 2768484.4399; train_optim_loss: 2768484.4399; val_kl_reg_loss: 21330.1187; val_edge_recon_loss: 809254.2552; val_gene_expr_recon_loss: 1871944.1667; val_masked_gp_l1_reg_loss: 16886.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26519.0742; val_global_loss: 2745934.2917; val_optim_loss: 2745934.2917
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9377; val_auprc_score: 0.9864; val_best_acc_score: 0.9373; val_best_f1_score: 0.9640; train_kl_reg_loss: 21020.0273; train_edge_recon_loss: 815155.7061; train_gene_expr_recon_loss: 1861094.4940; train_masked_gp_l1_reg_loss: 16470.2338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25828.9830; train_global_loss: 2739569.4471; train_optim_loss: 2739569.4471; val_kl_reg_loss: 20213.4134; val_edge_recon_loss: 803942.5417; val_gene_expr_recon_loss: 1853516.2292; val_masked_gp_l1_reg_loss: 16036.5137; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25128.9336; val_global_loss: 2718837.6875; val_optim_loss: 2718837.6875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9439; val_auprc_score: 0.9878; val_best_acc_score: 0.9379; val_best_f1_score: 0.9643; train_kl_reg_loss: 19613.4780; train_edge_recon_loss: 808559.1004; train_gene_expr_recon_loss: 1844607.6286; train_masked_gp_l1_reg_loss: 15616.2416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24467.8329; train_global_loss: 2712864.2957; train_optim_loss: 2712864.2957; val_kl_reg_loss: 18454.1852; val_edge_recon_loss: 806119.7083; val_gene_expr_recon_loss: 1840689.1354; val_masked_gp_l1_reg_loss: 15196.2871; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23829.0586; val_global_loss: 2704288.3125; val_optim_loss: 2704288.3125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9481; val_auprc_score: 0.9884; val_best_acc_score: 0.9395; val_best_f1_score: 0.9652; train_kl_reg_loss: 18310.5053; train_edge_recon_loss: 798125.1695; train_gene_expr_recon_loss: 1829211.2260; train_masked_gp_l1_reg_loss: 14807.3921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23209.6121; train_global_loss: 2683663.8798; train_optim_loss: 2683663.8798; val_kl_reg_loss: 17827.0812; val_edge_recon_loss: 798482.1510; val_gene_expr_recon_loss: 1825087.9375; val_masked_gp_l1_reg_loss: 14421.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22603.5039; val_global_loss: 2678422.4375; val_optim_loss: 2678422.4375
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9535; val_auprc_score: 0.9893; val_best_acc_score: 0.9408; val_best_f1_score: 0.9659; train_kl_reg_loss: 17289.4562; train_edge_recon_loss: 796831.2776; train_gene_expr_recon_loss: 1815149.6995; train_masked_gp_l1_reg_loss: 14067.0516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22044.2782; train_global_loss: 2665381.7596; train_optim_loss: 2665381.7596; val_kl_reg_loss: 16551.6558; val_edge_recon_loss: 812686.5417; val_gene_expr_recon_loss: 1811509.2083; val_masked_gp_l1_reg_loss: 13717.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21494.2812; val_global_loss: 2675959.3958; val_optim_loss: 2675959.3958
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9564; val_auprc_score: 0.9898; val_best_acc_score: 0.9452; val_best_f1_score: 0.9685; train_kl_reg_loss: 16347.0091; train_edge_recon_loss: 797960.7861; train_gene_expr_recon_loss: 1801517.9760; train_masked_gp_l1_reg_loss: 13391.8141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20990.5390; train_global_loss: 2650208.1514; train_optim_loss: 2650208.1514; val_kl_reg_loss: 16238.6094; val_edge_recon_loss: 793904.4062; val_gene_expr_recon_loss: 1797121.5312; val_masked_gp_l1_reg_loss: 13067.7393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20512.7949; val_global_loss: 2640845.0417; val_optim_loss: 2640845.0417
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9574; val_auprc_score: 0.9904; val_best_acc_score: 0.9463; val_best_f1_score: 0.9690; train_kl_reg_loss: 14832.4854; train_edge_recon_loss: 799859.1917; train_gene_expr_recon_loss: 2078779.3510; train_masked_gp_l1_reg_loss: 12663.3009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17804.6826; train_global_loss: 2923939.0096; train_optim_loss: 2923939.0096; val_kl_reg_loss: 9392.7716; val_edge_recon_loss: 792790.5573; val_gene_expr_recon_loss: 1913391.8958; val_masked_gp_l1_reg_loss: 12283.0723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15308.0713; val_global_loss: 2743166.1875; val_optim_loss: 2743166.1875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9619; val_auprc_score: 0.9912; val_best_acc_score: 0.9487; val_best_f1_score: 0.9703; train_kl_reg_loss: 11752.2593; train_edge_recon_loss: 787736.9026; train_gene_expr_recon_loss: 1888845.1779; train_masked_gp_l1_reg_loss: 11927.7480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13589.1460; train_global_loss: 2713851.2260; train_optim_loss: 2713851.2260; val_kl_reg_loss: 7108.8670; val_edge_recon_loss: 789024.1250; val_gene_expr_recon_loss: 1875689.2708; val_masked_gp_l1_reg_loss: 11585.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12079.9551; val_global_loss: 2695487.2500; val_optim_loss: 2695487.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9621; val_auprc_score: 0.9913; val_best_acc_score: 0.9499; val_best_f1_score: 0.9710; train_kl_reg_loss: 9145.8745; train_edge_recon_loss: 782122.4255; train_gene_expr_recon_loss: 1866517.8798; train_masked_gp_l1_reg_loss: 11275.5716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10956.7385; train_global_loss: 2680018.5000; train_optim_loss: 2680018.5000; val_kl_reg_loss: 5822.0101; val_edge_recon_loss: 784875.4323; val_gene_expr_recon_loss: 1861823.1875; val_masked_gp_l1_reg_loss: 10979.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9943.8350; val_global_loss: 2673443.8750; val_optim_loss: 2673443.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9629; val_auprc_score: 0.9914; val_best_acc_score: 0.9510; val_best_f1_score: 0.9716; train_kl_reg_loss: 7413.0323; train_edge_recon_loss: 778378.7416; train_gene_expr_recon_loss: 1852582.4519; train_masked_gp_l1_reg_loss: 10718.2257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9129.5663; train_global_loss: 2658222.0048; train_optim_loss: 2658222.0048; val_kl_reg_loss: 4857.6805; val_edge_recon_loss: 787175.9740; val_gene_expr_recon_loss: 1847565.6250; val_masked_gp_l1_reg_loss: 10468.7021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8372.7783; val_global_loss: 2658440.7708; val_optim_loss: 2658440.7708

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9635; val_auprc_score: 0.9915; val_best_acc_score: 0.9520; val_best_f1_score: 0.9721; train_kl_reg_loss: 6735.0324; train_edge_recon_loss: 782604.0601; train_gene_expr_recon_loss: 1845638.6779; train_masked_gp_l1_reg_loss: 10402.7154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8182.8704; train_global_loss: 2653563.3654; train_optim_loss: 2653563.3654; val_kl_reg_loss: 4772.8162; val_edge_recon_loss: 778938.1146; val_gene_expr_recon_loss: 1847979.2396; val_masked_gp_l1_reg_loss: 10373.6631; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8100.5850; val_global_loss: 2650164.4167; val_optim_loss: 2650164.4167
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9659; val_auprc_score: 0.9921; val_best_acc_score: 0.9531; val_best_f1_score: 0.9727; train_kl_reg_loss: 6482.9365; train_edge_recon_loss: 777823.4249; train_gene_expr_recon_loss: 1844052.1094; train_masked_gp_l1_reg_loss: 10349.3957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8031.3599; train_global_loss: 2646739.2452; train_optim_loss: 2646739.2452; val_kl_reg_loss: 4601.4476; val_edge_recon_loss: 790961.0208; val_gene_expr_recon_loss: 1844847.4062; val_masked_gp_l1_reg_loss: 10324.5068; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7959.7144; val_global_loss: 2658694.1250; val_optim_loss: 2658694.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9645; val_auprc_score: 0.9918; val_best_acc_score: 0.9526; val_best_f1_score: 0.9727; train_kl_reg_loss: 6332.0376; train_edge_recon_loss: 785117.3804; train_gene_expr_recon_loss: 1843292.8450; train_masked_gp_l1_reg_loss: 10300.7018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7889.3626; train_global_loss: 2652932.3293; train_optim_loss: 2652932.3293; val_kl_reg_loss: 4568.1615; val_edge_recon_loss: 774557.4010; val_gene_expr_recon_loss: 1845128.8438; val_masked_gp_l1_reg_loss: 10275.5459; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7817.2500; val_global_loss: 2642347.1458; val_optim_loss: 2642347.1458
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9657; val_auprc_score: 0.9920; val_best_acc_score: 0.9532; val_best_f1_score: 0.9728; train_kl_reg_loss: 6198.8227; train_edge_recon_loss: 780969.4441; train_gene_expr_recon_loss: 1841761.6310; train_masked_gp_l1_reg_loss: 10249.7041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7745.3050; train_global_loss: 2646924.8942; train_optim_loss: 2646924.8942; val_kl_reg_loss: 4477.0129; val_edge_recon_loss: 789500.7760; val_gene_expr_recon_loss: 1842524.3958; val_masked_gp_l1_reg_loss: 10224.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7671.8613; val_global_loss: 2654397.8958; val_optim_loss: 2654397.8958

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 91 min 41 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9551
val AUPRC score: 0.9897
val best accuracy score: 0.9445
val best F1 score: 0.9679
val target rna MSE score: 15.9041
val source rna MSE score: 98.7668
Val cat covariate0 mean sim diff: -0.0029

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
