[True]
Run timestamp: 26072023_232826_68.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_68']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8662; val_auprc_score: 0.9723; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 285238.2117; train_edge_recon_loss: 1169320.0099; train_gene_expr_recon_loss: 3745076.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 5199634.4558; train_optim_loss: 5199634.4558; val_kl_reg_loss: 232198.7096; val_edge_recon_loss: 1215296.2057; val_gene_expr_recon_loss: 1911692.8073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3359187.6875; val_optim_loss: 3359187.6875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8563; val_auprc_score: 0.9720; val_best_acc_score: 0.8556; val_best_f1_score: 0.9219; train_kl_reg_loss: 199431.8149; train_edge_recon_loss: 1171828.5997; train_gene_expr_recon_loss: 2240281.9140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3611542.3326; train_optim_loss: 3611542.3326; val_kl_reg_loss: 119930.4362; val_edge_recon_loss: 1199186.2812; val_gene_expr_recon_loss: 1435217.6979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2754334.4271; val_optim_loss: 2754334.4271
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8405; val_auprc_score: 0.9689; val_best_acc_score: 0.8572; val_best_f1_score: 0.9225; train_kl_reg_loss: 71183.0613; train_edge_recon_loss: 1106961.1052; train_gene_expr_recon_loss: 1299830.7895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2477974.9610; train_optim_loss: 2477974.9610; val_kl_reg_loss: 55858.0960; val_edge_recon_loss: 1196668.5573; val_gene_expr_recon_loss: 1093606.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2346133.5417; val_optim_loss: 2346133.5417
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8263; val_auprc_score: 0.9660; val_best_acc_score: 0.8631; val_best_f1_score: 0.9251; train_kl_reg_loss: 56918.9167; train_edge_recon_loss: 1066023.1735; train_gene_expr_recon_loss: 1069742.4401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2192684.5331; train_optim_loss: 2192684.5331; val_kl_reg_loss: 44071.0425; val_edge_recon_loss: 1173127.5104; val_gene_expr_recon_loss: 1011331.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2228530.4792; val_optim_loss: 2228530.4792
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8310; val_auprc_score: 0.9643; val_best_acc_score: 0.8646; val_best_f1_score: 0.9259; train_kl_reg_loss: 50629.1012; train_edge_recon_loss: 1061679.1686; train_gene_expr_recon_loss: 992769.4311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2105077.7012; train_optim_loss: 2105077.7012; val_kl_reg_loss: 47350.2472; val_edge_recon_loss: 1152830.8672; val_gene_expr_recon_loss: 976550.2865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2176731.3958; val_optim_loss: 2176731.3958
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8442; val_auprc_score: 0.9678; val_best_acc_score: 0.8717; val_best_f1_score: 0.9289; train_kl_reg_loss: 44865.0262; train_edge_recon_loss: 1031463.8666; train_gene_expr_recon_loss: 965743.0805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2042071.9738; train_optim_loss: 2042071.9738; val_kl_reg_loss: 40251.9631; val_edge_recon_loss: 1044516.4401; val_gene_expr_recon_loss: 953421.2161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2038189.6354; val_optim_loss: 2038189.6354
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8720; val_auprc_score: 0.9720; val_best_acc_score: 0.8812; val_best_f1_score: 0.9333; train_kl_reg_loss: 42384.3251; train_edge_recon_loss: 968378.1942; train_gene_expr_recon_loss: 946413.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1957176.4215; train_optim_loss: 1957176.4215; val_kl_reg_loss: 45606.7804; val_edge_recon_loss: 933382.0052; val_gene_expr_recon_loss: 935953.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1914942.5990; val_optim_loss: 1914942.5990
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8752; val_auprc_score: 0.9723; val_best_acc_score: 0.8889; val_best_f1_score: 0.9364; train_kl_reg_loss: 49424.6658; train_edge_recon_loss: 878040.1070; train_gene_expr_recon_loss: 923731.4561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1851196.2285; train_optim_loss: 1851196.2285; val_kl_reg_loss: 47023.2590; val_edge_recon_loss: 891221.2005; val_gene_expr_recon_loss: 912485.6146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1850730.0677; val_optim_loss: 1850730.0677
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8840; val_auprc_score: 0.9754; val_best_acc_score: 0.8919; val_best_f1_score: 0.9393; train_kl_reg_loss: 45862.9663; train_edge_recon_loss: 857956.7395; train_gene_expr_recon_loss: 901917.7817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1805737.4820; train_optim_loss: 1805737.4820; val_kl_reg_loss: 41831.2848; val_edge_recon_loss: 860092.3828; val_gene_expr_recon_loss: 891681.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1793605.0208; val_optim_loss: 1793605.0208
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8996; val_auprc_score: 0.9796; val_best_acc_score: 0.9017; val_best_f1_score: 0.9441; train_kl_reg_loss: 40683.5979; train_edge_recon_loss: 848048.0453; train_gene_expr_recon_loss: 884364.3904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1773096.0302; train_optim_loss: 1773096.0302; val_kl_reg_loss: 36036.2257; val_edge_recon_loss: 814913.8359; val_gene_expr_recon_loss: 875753.0573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1726703.1198; val_optim_loss: 1726703.1198
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8975; val_auprc_score: 0.9758; val_best_acc_score: 0.9017; val_best_f1_score: 0.9436; train_kl_reg_loss: 35123.0450; train_edge_recon_loss: 833941.5169; train_gene_expr_recon_loss: 868604.8439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1737669.4087; train_optim_loss: 1737669.4087; val_kl_reg_loss: 30788.0164; val_edge_recon_loss: 880498.5052; val_gene_expr_recon_loss: 861751.5651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1773038.0729; val_optim_loss: 1773038.0729
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9065; val_auprc_score: 0.9788; val_best_acc_score: 0.9075; val_best_f1_score: 0.9473; train_kl_reg_loss: 30407.7039; train_edge_recon_loss: 833640.7177; train_gene_expr_recon_loss: 854586.0163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1718634.4459; train_optim_loss: 1718634.4459; val_kl_reg_loss: 27329.8105; val_edge_recon_loss: 844697.2161; val_gene_expr_recon_loss: 847392.6901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1719419.7083; val_optim_loss: 1719419.7083
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9119; val_auprc_score: 0.9802; val_best_acc_score: 0.9186; val_best_f1_score: 0.9535; train_kl_reg_loss: 26744.1940; train_edge_recon_loss: 823650.2436; train_gene_expr_recon_loss: 841109.0416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1691503.4785; train_optim_loss: 1691503.4785; val_kl_reg_loss: 23617.3329; val_edge_recon_loss: 824826.6094; val_gene_expr_recon_loss: 835104.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1683548.6562; val_optim_loss: 1683548.6562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9141; val_auprc_score: 0.9812; val_best_acc_score: 0.9187; val_best_f1_score: 0.9534; train_kl_reg_loss: 23680.2941; train_edge_recon_loss: 815322.9965; train_gene_expr_recon_loss: 828398.7032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1667401.9977; train_optim_loss: 1667401.9977; val_kl_reg_loss: 21799.1229; val_edge_recon_loss: 823537.9062; val_gene_expr_recon_loss: 823481.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1668818.2656; val_optim_loss: 1668818.2656
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9232; val_auprc_score: 0.9835; val_best_acc_score: 0.9210; val_best_f1_score: 0.9548; train_kl_reg_loss: 20654.7466; train_edge_recon_loss: 803294.6262; train_gene_expr_recon_loss: 817536.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1641485.6866; train_optim_loss: 1641485.6866; val_kl_reg_loss: 18286.8559; val_edge_recon_loss: 811756.2266; val_gene_expr_recon_loss: 812820.6823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1642863.7604; val_optim_loss: 1642863.7604
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9260; val_auprc_score: 0.9828; val_best_acc_score: 0.9258; val_best_f1_score: 0.9572; train_kl_reg_loss: 17838.0403; train_edge_recon_loss: 798164.9523; train_gene_expr_recon_loss: 807594.3180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1623597.3093; train_optim_loss: 1623597.3093; val_kl_reg_loss: 15427.5829; val_edge_recon_loss: 825446.1536; val_gene_expr_recon_loss: 804312.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1645186.4271; val_optim_loss: 1645186.4271
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9262; val_auprc_score: 0.9832; val_best_acc_score: 0.9279; val_best_f1_score: 0.9586; train_kl_reg_loss: 16145.9668; train_edge_recon_loss: 793560.7047; train_gene_expr_recon_loss: 798466.5413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1608173.2163; train_optim_loss: 1608173.2163; val_kl_reg_loss: 14815.0938; val_edge_recon_loss: 811888.1927; val_gene_expr_recon_loss: 795354.6927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1622057.9844; val_optim_loss: 1622057.9844
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9260; val_auprc_score: 0.9836; val_best_acc_score: 0.9197; val_best_f1_score: 0.9539; train_kl_reg_loss: 14995.8187; train_edge_recon_loss: 792535.5674; train_gene_expr_recon_loss: 790004.1922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1597535.5820; train_optim_loss: 1597535.5820; val_kl_reg_loss: 14521.0181; val_edge_recon_loss: 806275.2760; val_gene_expr_recon_loss: 786468.1276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1607264.4219; val_optim_loss: 1607264.4219
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9340; val_auprc_score: 0.9860; val_best_acc_score: 0.9253; val_best_f1_score: 0.9572; train_kl_reg_loss: 13493.7037; train_edge_recon_loss: 794314.6654; train_gene_expr_recon_loss: 781830.3791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1589638.7465; train_optim_loss: 1589638.7465; val_kl_reg_loss: 12839.1900; val_edge_recon_loss: 792233.3411; val_gene_expr_recon_loss: 778757.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1583829.7135; val_optim_loss: 1583829.7135
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9357; val_auprc_score: 0.9857; val_best_acc_score: 0.9239; val_best_f1_score: 0.9561; train_kl_reg_loss: 12658.2874; train_edge_recon_loss: 789065.4712; train_gene_expr_recon_loss: 774955.8076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1576679.5703; train_optim_loss: 1576679.5703; val_kl_reg_loss: 11764.2734; val_edge_recon_loss: 812705.6901; val_gene_expr_recon_loss: 772210.4818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1596680.4531; val_optim_loss: 1596680.4531
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9443; val_auprc_score: 0.9878; val_best_acc_score: 0.9298; val_best_f1_score: 0.9596; train_kl_reg_loss: 12386.8880; train_edge_recon_loss: 788153.6544; train_gene_expr_recon_loss: 767906.0855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1568446.6244; train_optim_loss: 1568446.6244; val_kl_reg_loss: 11886.8221; val_edge_recon_loss: 810706.5938; val_gene_expr_recon_loss: 765247.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1587840.5990; val_optim_loss: 1587840.5990
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9447; val_auprc_score: 0.9875; val_best_acc_score: 0.9321; val_best_f1_score: 0.9608; train_kl_reg_loss: 12201.2665; train_edge_recon_loss: 777334.7366; train_gene_expr_recon_loss: 761707.3898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1551243.3913; train_optim_loss: 1551243.3913; val_kl_reg_loss: 12010.9970; val_edge_recon_loss: 798503.6120; val_gene_expr_recon_loss: 759637.9714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1570152.5833; val_optim_loss: 1570152.5833
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9469; val_auprc_score: 0.9884; val_best_acc_score: 0.9360; val_best_f1_score: 0.9631; train_kl_reg_loss: 12071.8700; train_edge_recon_loss: 778800.3154; train_gene_expr_recon_loss: 755999.8724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1546872.0616; train_optim_loss: 1546872.0616; val_kl_reg_loss: 11438.6947; val_edge_recon_loss: 777929.0312; val_gene_expr_recon_loss: 753945.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1543312.9010; val_optim_loss: 1543312.9010
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9488; val_auprc_score: 0.9885; val_best_acc_score: 0.9355; val_best_f1_score: 0.9627; train_kl_reg_loss: 11520.1690; train_edge_recon_loss: 777315.9863; train_gene_expr_recon_loss: 750715.0267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1539551.1866; train_optim_loss: 1539551.1866; val_kl_reg_loss: 10833.9368; val_edge_recon_loss: 802770.8516; val_gene_expr_recon_loss: 749806.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1563410.9948; val_optim_loss: 1563410.9948
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9519; val_auprc_score: 0.9885; val_best_acc_score: 0.9373; val_best_f1_score: 0.9635; train_kl_reg_loss: 11146.8142; train_edge_recon_loss: 770928.8003; train_gene_expr_recon_loss: 745569.1026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1527644.7215; train_optim_loss: 1527644.7215; val_kl_reg_loss: 10890.5359; val_edge_recon_loss: 791308.7161; val_gene_expr_recon_loss: 742985.7865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1545185.0208; val_optim_loss: 1545185.0208
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9550; val_auprc_score: 0.9904; val_best_acc_score: 0.9362; val_best_f1_score: 0.9630; train_kl_reg_loss: 10574.4977; train_edge_recon_loss: 777820.3154; train_gene_expr_recon_loss: 745837.3035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1534232.1227; train_optim_loss: 1534232.1227; val_kl_reg_loss: 6608.8537; val_edge_recon_loss: 808064.2891; val_gene_expr_recon_loss: 743277.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1557950.4010; val_optim_loss: 1557950.4010
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9536; val_auprc_score: 0.9881; val_best_acc_score: 0.9420; val_best_f1_score: 0.9666; train_kl_reg_loss: 9377.6416; train_edge_recon_loss: 777730.9125; train_gene_expr_recon_loss: 741104.7718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1528213.3233; train_optim_loss: 1528213.3233; val_kl_reg_loss: 5949.1440; val_edge_recon_loss: 786395.1276; val_gene_expr_recon_loss: 739180.9349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1531525.1927; val_optim_loss: 1531525.1927
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9561; val_auprc_score: 0.9896; val_best_acc_score: 0.9450; val_best_f1_score: 0.9682; train_kl_reg_loss: 8886.3613; train_edge_recon_loss: 764853.8375; train_gene_expr_recon_loss: 736474.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1510215.1302; train_optim_loss: 1510215.1302; val_kl_reg_loss: 5788.0285; val_edge_recon_loss: 795845.6380; val_gene_expr_recon_loss: 737030.4948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1538664.1510; val_optim_loss: 1538664.1510
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9585; val_auprc_score: 0.9906; val_best_acc_score: 0.9465; val_best_f1_score: 0.9690; train_kl_reg_loss: 8301.5099; train_edge_recon_loss: 773171.0483; train_gene_expr_recon_loss: 733019.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1514491.9610; train_optim_loss: 1514491.9610; val_kl_reg_loss: 5955.8725; val_edge_recon_loss: 777875.2396; val_gene_expr_recon_loss: 733006.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1516837.1458; val_optim_loss: 1516837.1458
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9572; val_auprc_score: 0.9903; val_best_acc_score: 0.9468; val_best_f1_score: 0.9692; train_kl_reg_loss: 8094.6522; train_edge_recon_loss: 775368.8070; train_gene_expr_recon_loss: 730234.7927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1513698.2500; train_optim_loss: 1513698.2500; val_kl_reg_loss: 5853.0993; val_edge_recon_loss: 766419.5625; val_gene_expr_recon_loss: 729749.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1502022.0885; val_optim_loss: 1502022.0885
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9560; val_auprc_score: 0.9897; val_best_acc_score: 0.9433; val_best_f1_score: 0.9672; train_kl_reg_loss: 7981.7761; train_edge_recon_loss: 771218.5773; train_gene_expr_recon_loss: 726527.2869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505727.6413; train_optim_loss: 1505727.6413; val_kl_reg_loss: 5844.7187; val_edge_recon_loss: 814609.6953; val_gene_expr_recon_loss: 726220.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1546674.4479; val_optim_loss: 1546674.4479
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9590; val_auprc_score: 0.9903; val_best_acc_score: 0.9512; val_best_f1_score: 0.9718; train_kl_reg_loss: 8033.8616; train_edge_recon_loss: 773363.4517; train_gene_expr_recon_loss: 723440.6387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1504837.9483; train_optim_loss: 1504837.9483; val_kl_reg_loss: 5811.9665; val_edge_recon_loss: 750013.8984; val_gene_expr_recon_loss: 723820.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1479646.4062; val_optim_loss: 1479646.4062
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9620; val_auprc_score: 0.9914; val_best_acc_score: 0.9511; val_best_f1_score: 0.9716; train_kl_reg_loss: 7618.9791; train_edge_recon_loss: 774237.8597; train_gene_expr_recon_loss: 721559.2401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1503416.0779; train_optim_loss: 1503416.0779; val_kl_reg_loss: 5626.7654; val_edge_recon_loss: 768830.9271; val_gene_expr_recon_loss: 721550.2943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1496007.9792; val_optim_loss: 1496007.9792
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9585; val_auprc_score: 0.9901; val_best_acc_score: 0.9479; val_best_f1_score: 0.9696; train_kl_reg_loss: 7521.6235; train_edge_recon_loss: 781137.4538; train_gene_expr_recon_loss: 719051.5023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1507710.5849; train_optim_loss: 1507710.5849; val_kl_reg_loss: 5398.6418; val_edge_recon_loss: 807884.0156; val_gene_expr_recon_loss: 720296.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1533579.5052; val_optim_loss: 1533579.5052
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9639; val_auprc_score: 0.9913; val_best_acc_score: 0.9508; val_best_f1_score: 0.9714; train_kl_reg_loss: 7345.3739; train_edge_recon_loss: 771003.1622; train_gene_expr_recon_loss: 716458.3273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1494806.8663; train_optim_loss: 1494806.8663; val_kl_reg_loss: 5577.4820; val_edge_recon_loss: 777168.2708; val_gene_expr_recon_loss: 716250.4557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1498996.1875; val_optim_loss: 1498996.1875
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9561; val_auprc_score: 0.9894; val_best_acc_score: 0.9529; val_best_f1_score: 0.9728; train_kl_reg_loss: 7152.4177; train_edge_recon_loss: 770210.6090; train_gene_expr_recon_loss: 714749.7948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1492112.8233; train_optim_loss: 1492112.8233; val_kl_reg_loss: 5503.9379; val_edge_recon_loss: 767461.0547; val_gene_expr_recon_loss: 715144.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1488109.0833; val_optim_loss: 1488109.0833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9625; val_auprc_score: 0.9911; val_best_acc_score: 0.9546; val_best_f1_score: 0.9736; train_kl_reg_loss: 6963.6560; train_edge_recon_loss: 762036.1067; train_gene_expr_recon_loss: 711969.0358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1480968.8000; train_optim_loss: 1480968.8000; val_kl_reg_loss: 5585.7965; val_edge_recon_loss: 770798.6250; val_gene_expr_recon_loss: 712831.9349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1489216.3542; val_optim_loss: 1489216.3542
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9651; val_auprc_score: 0.9925; val_best_acc_score: 0.9559; val_best_f1_score: 0.9744; train_kl_reg_loss: 6973.5937; train_edge_recon_loss: 760092.2608; train_gene_expr_recon_loss: 711413.8215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1478479.6762; train_optim_loss: 1478479.6762; val_kl_reg_loss: 5574.9166; val_edge_recon_loss: 747999.8177; val_gene_expr_recon_loss: 712964.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1466539.2240; val_optim_loss: 1466539.2240
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9651; val_auprc_score: 0.9923; val_best_acc_score: 0.9551; val_best_f1_score: 0.9740; train_kl_reg_loss: 7004.6372; train_edge_recon_loss: 760852.2262; train_gene_expr_recon_loss: 711089.8070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1478946.6738; train_optim_loss: 1478946.6738; val_kl_reg_loss: 5509.7643; val_edge_recon_loss: 765134.7734; val_gene_expr_recon_loss: 712977.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1483622.4531; val_optim_loss: 1483622.4531
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9635; val_auprc_score: 0.9914; val_best_acc_score: 0.9548; val_best_f1_score: 0.9737; train_kl_reg_loss: 6922.5425; train_edge_recon_loss: 766625.2599; train_gene_expr_recon_loss: 711052.5747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1484600.3797; train_optim_loss: 1484600.3797; val_kl_reg_loss: 5511.8791; val_edge_recon_loss: 764317.5078; val_gene_expr_recon_loss: 712479.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1482308.9740; val_optim_loss: 1482308.9740
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9675; val_auprc_score: 0.9926; val_best_acc_score: 0.9544; val_best_f1_score: 0.9736; train_kl_reg_loss: 6871.9922; train_edge_recon_loss: 760616.7820; train_gene_expr_recon_loss: 710811.7128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1478300.4843; train_optim_loss: 1478300.4843; val_kl_reg_loss: 5449.0204; val_edge_recon_loss: 770864.9245; val_gene_expr_recon_loss: 711946.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1488260.8750; val_optim_loss: 1488260.8750
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9637; val_auprc_score: 0.9904; val_best_acc_score: 0.9554; val_best_f1_score: 0.9741; train_kl_reg_loss: 6878.6948; train_edge_recon_loss: 767065.0735; train_gene_expr_recon_loss: 710406.6494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1484350.4215; train_optim_loss: 1484350.4215; val_kl_reg_loss: 5445.9646; val_edge_recon_loss: 785522.0443; val_gene_expr_recon_loss: 712332.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1503300.2135; val_optim_loss: 1503300.2135

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9624; val_auprc_score: 0.9917; val_best_acc_score: 0.9539; val_best_f1_score: 0.9733; train_kl_reg_loss: 6777.3125; train_edge_recon_loss: 775099.9224; train_gene_expr_recon_loss: 710153.2869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1492030.5203; train_optim_loss: 1492030.5203; val_kl_reg_loss: 5431.5500; val_edge_recon_loss: 777425.0990; val_gene_expr_recon_loss: 711711.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1494568.5885; val_optim_loss: 1494568.5885
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9641; val_auprc_score: 0.9918; val_best_acc_score: 0.9520; val_best_f1_score: 0.9721; train_kl_reg_loss: 6764.0195; train_edge_recon_loss: 768765.5267; train_gene_expr_recon_loss: 710158.7869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1485688.3366; train_optim_loss: 1485688.3366; val_kl_reg_loss: 5459.2051; val_edge_recon_loss: 807239.2188; val_gene_expr_recon_loss: 712021.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1524719.5417; val_optim_loss: 1524719.5417
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9650; val_auprc_score: 0.9909; val_best_acc_score: 0.9540; val_best_f1_score: 0.9733; train_kl_reg_loss: 6802.0492; train_edge_recon_loss: 754857.0637; train_gene_expr_recon_loss: 710015.5032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1471674.6174; train_optim_loss: 1471674.6174; val_kl_reg_loss: 5480.2280; val_edge_recon_loss: 780443.7292; val_gene_expr_recon_loss: 711669.3698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1497593.3125; val_optim_loss: 1497593.3125
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9632; val_auprc_score: 0.9917; val_best_acc_score: 0.9526; val_best_f1_score: 0.9724; train_kl_reg_loss: 6823.8332; train_edge_recon_loss: 768061.3352; train_gene_expr_recon_loss: 710311.3372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1485196.5052; train_optim_loss: 1485196.5052; val_kl_reg_loss: 5462.0303; val_edge_recon_loss: 794735.3724; val_gene_expr_recon_loss: 712272.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1512470.3854; val_optim_loss: 1512470.3854

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 23 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9650
Val AUPRC score: 0.9912
Val best accuracy score: 0.9540
Val best F1 score: 0.9734
Val gene expr MSE score: 62667.8094
Val cat covariate0 mean sim diff: 0.0015

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
