[True]
Run timestamp: 07092023_011640_229.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_229']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 27116 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 31634, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 27116

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7887; val_auprc_score: 0.8024; val_best_acc_score: 0.5404; val_best_f1_score: 0.6831; train_kl_reg_loss: 92898.5731; train_edge_recon_loss: 3572823.2729; train_gene_expr_recon_loss: 17039750.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1208424.4976; train_chrom_access_recon_loss: 61751090.1069; train_global_loss: 83664986.8702; train_optim_loss: 83664986.8702; val_kl_reg_loss: 153556.1021; val_edge_recon_loss: 4062544.7000; val_gene_expr_recon_loss: 15733784.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 657052.0000; val_chrom_access_recon_loss: 60149212.5333; val_global_loss: 80756151.4667; val_optim_loss: 80756151.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8849; val_auprc_score: 0.8795; val_best_acc_score: 0.7906; val_best_f1_score: 0.8079; train_kl_reg_loss: 127100.0493; train_edge_recon_loss: 3540309.2366; train_gene_expr_recon_loss: 15546052.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 404906.7688; train_chrom_access_recon_loss: 59065523.7557; train_global_loss: 78683892.0916; train_optim_loss: 78683892.0916; val_kl_reg_loss: 131166.6995; val_edge_recon_loss: 4033190.2667; val_gene_expr_recon_loss: 15392889.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 251987.4688; val_chrom_access_recon_loss: 58986993.3333; val_global_loss: 78796227.7333; val_optim_loss: 78796227.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8896; val_auprc_score: 0.8863; val_best_acc_score: 0.7999; val_best_f1_score: 0.8074; train_kl_reg_loss: 98006.8675; train_edge_recon_loss: 3482183.7405; train_gene_expr_recon_loss: 15306939.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 194132.6359; train_chrom_access_recon_loss: 58273044.1221; train_global_loss: 77354306.9313; train_optim_loss: 77354306.9313; val_kl_reg_loss: 76631.1552; val_edge_recon_loss: 3372523.6667; val_gene_expr_recon_loss: 15202953.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153754.4531; val_chrom_access_recon_loss: 58144113.6000; val_global_loss: 76949976.5333; val_optim_loss: 76949976.5333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8796; val_auprc_score: 0.8665; val_best_acc_score: 0.7871; val_best_f1_score: 0.8089; train_kl_reg_loss: 109746.2834; train_edge_recon_loss: 3047714.4103; train_gene_expr_recon_loss: 15122915.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131191.6892; train_chrom_access_recon_loss: 57667155.2977; train_global_loss: 76078722.8702; train_optim_loss: 76078722.8702; val_kl_reg_loss: 124177.3313; val_edge_recon_loss: 2980676.4000; val_gene_expr_recon_loss: 15071966.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113161.3047; val_chrom_access_recon_loss: 57748704.2667; val_global_loss: 76038687.4667; val_optim_loss: 76038687.4667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8833; val_auprc_score: 0.8699; val_best_acc_score: 0.7959; val_best_f1_score: 0.8184; train_kl_reg_loss: 121743.1659; train_edge_recon_loss: 2956315.0210; train_gene_expr_recon_loss: 14984717.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101199.2267; train_chrom_access_recon_loss: 57193309.0992; train_global_loss: 75357284.0305; train_optim_loss: 75357284.0305; val_kl_reg_loss: 118782.5141; val_edge_recon_loss: 2941714.6667; val_gene_expr_recon_loss: 14931840.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91198.9609; val_chrom_access_recon_loss: 57399925.3333; val_global_loss: 75483460.8000; val_optim_loss: 75483460.8000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8930; val_auprc_score: 0.8786; val_best_acc_score: 0.8038; val_best_f1_score: 0.8234; train_kl_reg_loss: 113813.3337; train_edge_recon_loss: 2940557.9466; train_gene_expr_recon_loss: 14839729.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84047.1035; train_chrom_access_recon_loss: 56664105.6489; train_global_loss: 74642253.1298; train_optim_loss: 74642253.1298; val_kl_reg_loss: 108969.3828; val_edge_recon_loss: 2908781.1667; val_gene_expr_recon_loss: 14764858.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78315.4141; val_chrom_access_recon_loss: 56959755.7333; val_global_loss: 74820679.4667; val_optim_loss: 74820679.4667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9106; val_auprc_score: 0.8932; val_best_acc_score: 0.8344; val_best_f1_score: 0.8456; train_kl_reg_loss: 106730.6632; train_edge_recon_loss: 2890890.5477; train_gene_expr_recon_loss: 14736654.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73684.0695; train_chrom_access_recon_loss: 56310542.7176; train_global_loss: 74118501.9847; train_optim_loss: 74118501.9847; val_kl_reg_loss: 104557.5479; val_edge_recon_loss: 2898167.7667; val_gene_expr_recon_loss: 14750482.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70413.4922; val_chrom_access_recon_loss: 56781600.2667; val_global_loss: 74605220.8000; val_optim_loss: 74605220.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9327; val_auprc_score: 0.9131; val_best_acc_score: 0.8678; val_best_f1_score: 0.8770; train_kl_reg_loss: 104217.2940; train_edge_recon_loss: 2851719.6622; train_gene_expr_recon_loss: 14628775.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67600.3051; train_chrom_access_recon_loss: 55878431.5725; train_global_loss: 73530744.5496; train_optim_loss: 73530744.5496; val_kl_reg_loss: 103043.2318; val_edge_recon_loss: 2818805.9167; val_gene_expr_recon_loss: 14610603.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65427.0000; val_chrom_access_recon_loss: 56078127.2000; val_global_loss: 73676007.4667; val_optim_loss: 73676007.4667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9392; val_auprc_score: 0.9247; val_best_acc_score: 0.8751; val_best_f1_score: 0.8834; train_kl_reg_loss: 106683.8840; train_edge_recon_loss: 2797560.6794; train_gene_expr_recon_loss: 14528226.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63851.1948; train_chrom_access_recon_loss: 55477698.6565; train_global_loss: 72974021.0687; train_optim_loss: 72974021.0687; val_kl_reg_loss: 105561.8734; val_edge_recon_loss: 2807176.8500; val_gene_expr_recon_loss: 14547497.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62241.4375; val_chrom_access_recon_loss: 55853338.4000; val_global_loss: 73375816.0000; val_optim_loss: 73375816.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9425; val_auprc_score: 0.9252; val_best_acc_score: 0.8801; val_best_f1_score: 0.8865; train_kl_reg_loss: 106700.8513; train_edge_recon_loss: 2779431.3473; train_gene_expr_recon_loss: 14458118.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61249.1670; train_chrom_access_recon_loss: 55133393.0992; train_global_loss: 72538892.4580; train_optim_loss: 72538892.4580; val_kl_reg_loss: 102518.0562; val_edge_recon_loss: 2791854.3167; val_gene_expr_recon_loss: 14476858.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60116.3398; val_chrom_access_recon_loss: 55616516.5333; val_global_loss: 73047863.4667; val_optim_loss: 73047863.4667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9511; val_auprc_score: 0.9376; val_best_acc_score: 0.8917; val_best_f1_score: 0.8974; train_kl_reg_loss: 105709.0294; train_edge_recon_loss: 2767136.5725; train_gene_expr_recon_loss: 14394416.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59434.5805; train_chrom_access_recon_loss: 54865077.3740; train_global_loss: 72191774.3511; train_optim_loss: 72191774.3511; val_kl_reg_loss: 103066.6687; val_edge_recon_loss: 2750002.5833; val_gene_expr_recon_loss: 14402333.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58593.8359; val_chrom_access_recon_loss: 55216433.6000; val_global_loss: 72530429.3333; val_optim_loss: 72530429.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9487; val_auprc_score: 0.9346; val_best_acc_score: 0.8868; val_best_f1_score: 0.8931; train_kl_reg_loss: 103105.3671; train_edge_recon_loss: 2759458.5267; train_gene_expr_recon_loss: 14323523.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58048.6730; train_chrom_access_recon_loss: 54518428.8855; train_global_loss: 71762565.4962; train_optim_loss: 71762565.4962; val_kl_reg_loss: 101974.8208; val_edge_recon_loss: 2767664.4833; val_gene_expr_recon_loss: 14337866.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57741.9844; val_chrom_access_recon_loss: 54937328.2667; val_global_loss: 72202576.0000; val_optim_loss: 72202576.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9530; val_auprc_score: 0.9376; val_best_acc_score: 0.8922; val_best_f1_score: 0.8983; train_kl_reg_loss: 101038.5446; train_edge_recon_loss: 2746242.1584; train_gene_expr_recon_loss: 14268098.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57189.5657; train_chrom_access_recon_loss: 54248252.2748; train_global_loss: 71420821.2214; train_optim_loss: 71420821.2214; val_kl_reg_loss: 103067.4578; val_edge_recon_loss: 2745474.0500; val_gene_expr_recon_loss: 14244858.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56638.9023; val_chrom_access_recon_loss: 54573552.5333; val_global_loss: 71723590.4000; val_optim_loss: 71723590.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9540; val_auprc_score: 0.9420; val_best_acc_score: 0.8981; val_best_f1_score: 0.9052; train_kl_reg_loss: 99193.1510; train_edge_recon_loss: 2739113.5573; train_gene_expr_recon_loss: 14215323.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56392.4549; train_chrom_access_recon_loss: 53927428.0000; train_global_loss: 71037450.6260; train_optim_loss: 71037450.6260; val_kl_reg_loss: 97415.0693; val_edge_recon_loss: 2739786.6833; val_gene_expr_recon_loss: 14183326.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56153.8828; val_chrom_access_recon_loss: 54419299.2000; val_global_loss: 71495981.3333; val_optim_loss: 71495981.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9543; val_auprc_score: 0.9430; val_best_acc_score: 0.8989; val_best_f1_score: 0.9048; train_kl_reg_loss: 97224.3760; train_edge_recon_loss: 2734940.6870; train_gene_expr_recon_loss: 14151387.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55909.4852; train_chrom_access_recon_loss: 53578669.8931; train_global_loss: 70618132.2748; train_optim_loss: 70618132.2748; val_kl_reg_loss: 94721.1380; val_edge_recon_loss: 2740431.0500; val_gene_expr_recon_loss: 14206228.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55887.9688; val_chrom_access_recon_loss: 54355078.1333; val_global_loss: 71452346.1333; val_optim_loss: 71452346.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9589; val_auprc_score: 0.9485; val_best_acc_score: 0.9007; val_best_f1_score: 0.9056; train_kl_reg_loss: 95092.1380; train_edge_recon_loss: 2727430.2710; train_gene_expr_recon_loss: 14115453.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55693.8578; train_chrom_access_recon_loss: 53346084.7328; train_global_loss: 70339754.5038; train_optim_loss: 70339754.5038; val_kl_reg_loss: 92751.2854; val_edge_recon_loss: 2755097.6000; val_gene_expr_recon_loss: 14161206.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55349.4492; val_chrom_access_recon_loss: 53859125.8667; val_global_loss: 70923531.7333; val_optim_loss: 70923531.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9648; val_auprc_score: 0.9579; val_best_acc_score: 0.9072; val_best_f1_score: 0.9125; train_kl_reg_loss: 93300.2977; train_edge_recon_loss: 2729380.6298; train_gene_expr_recon_loss: 14064365.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55447.2910; train_chrom_access_recon_loss: 53095557.0076; train_global_loss: 70038051.3282; train_optim_loss: 70038051.3282; val_kl_reg_loss: 89617.4516; val_edge_recon_loss: 2740449.0000; val_gene_expr_recon_loss: 14047553.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55372.1055; val_chrom_access_recon_loss: 53678421.0667; val_global_loss: 70611412.5333; val_optim_loss: 70611412.5333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9670; val_auprc_score: 0.9601; val_best_acc_score: 0.9153; val_best_f1_score: 0.9181; train_kl_reg_loss: 91579.9105; train_edge_recon_loss: 2722951.3435; train_gene_expr_recon_loss: 14032831.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55399.3141; train_chrom_access_recon_loss: 52813589.8931; train_global_loss: 69716352.4580; train_optim_loss: 69716352.4580; val_kl_reg_loss: 92526.2427; val_edge_recon_loss: 2709731.7833; val_gene_expr_recon_loss: 14125337.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54965.1719; val_chrom_access_recon_loss: 53898466.9333; val_global_loss: 70881028.8000; val_optim_loss: 70881028.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9684; val_auprc_score: 0.9622; val_best_acc_score: 0.9135; val_best_f1_score: 0.9178; train_kl_reg_loss: 90511.3389; train_edge_recon_loss: 2719450.3912; train_gene_expr_recon_loss: 14000955.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55252.8894; train_chrom_access_recon_loss: 52599704.6412; train_global_loss: 69465874.5649; train_optim_loss: 69465874.5649; val_kl_reg_loss: 88398.1083; val_edge_recon_loss: 2728973.3333; val_gene_expr_recon_loss: 14010558.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55320.0078; val_chrom_access_recon_loss: 53414048.0000; val_global_loss: 70297298.4000; val_optim_loss: 70297298.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9689; val_auprc_score: 0.9595; val_best_acc_score: 0.9188; val_best_f1_score: 0.9210; train_kl_reg_loss: 89120.8957; train_edge_recon_loss: 2707901.7424; train_gene_expr_recon_loss: 13973677.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55300.1637; train_chrom_access_recon_loss: 52388302.1985; train_global_loss: 69214302.4733; train_optim_loss: 69214302.4733; val_kl_reg_loss: 90791.6260; val_edge_recon_loss: 2725869.0333; val_gene_expr_recon_loss: 14008194.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55299.7266; val_chrom_access_recon_loss: 53532681.8667; val_global_loss: 70412838.1333; val_optim_loss: 70412838.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9691; val_auprc_score: 0.9613; val_best_acc_score: 0.9147; val_best_f1_score: 0.9184; train_kl_reg_loss: 87712.5920; train_edge_recon_loss: 2714127.9580; train_gene_expr_recon_loss: 13947638.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55465.9583; train_chrom_access_recon_loss: 52203675.5420; train_global_loss: 69008621.0382; train_optim_loss: 69008621.0382; val_kl_reg_loss: 86403.4495; val_edge_recon_loss: 2739819.5833; val_gene_expr_recon_loss: 13945539.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55454.9688; val_chrom_access_recon_loss: 53068676.5333; val_global_loss: 69895894.6667; val_optim_loss: 69895894.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9748; val_auprc_score: 0.9706; val_best_acc_score: 0.9212; val_best_f1_score: 0.9240; train_kl_reg_loss: 86463.1212; train_edge_recon_loss: 2710851.2729; train_gene_expr_recon_loss: 13920547.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55499.3547; train_chrom_access_recon_loss: 52048848.5496; train_global_loss: 68822209.5573; train_optim_loss: 68822209.5573; val_kl_reg_loss: 86788.7089; val_edge_recon_loss: 2715948.0667; val_gene_expr_recon_loss: 13981372.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55074.0977; val_chrom_access_recon_loss: 53078674.6667; val_global_loss: 69917857.8667; val_optim_loss: 69917857.8667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9750; val_auprc_score: 0.9686; val_best_acc_score: 0.9255; val_best_f1_score: 0.9284; train_kl_reg_loss: 85814.4859; train_edge_recon_loss: 2703941.6431; train_gene_expr_recon_loss: 13876023.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55382.4925; train_chrom_access_recon_loss: 51780254.2290; train_global_loss: 68501416.0916; train_optim_loss: 68501416.0916; val_kl_reg_loss: 84995.0953; val_edge_recon_loss: 2710539.0667; val_gene_expr_recon_loss: 13921491.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55373.5703; val_chrom_access_recon_loss: 52706989.6000; val_global_loss: 69479389.3333; val_optim_loss: 69479389.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9721; val_auprc_score: 0.9647; val_best_acc_score: 0.9235; val_best_f1_score: 0.9270; train_kl_reg_loss: 84388.2513; train_edge_recon_loss: 2719506.6431; train_gene_expr_recon_loss: 13895025.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55462.7398; train_chrom_access_recon_loss: 51784556.8550; train_global_loss: 68538940.0000; train_optim_loss: 68538940.0000; val_kl_reg_loss: 75297.8354; val_edge_recon_loss: 2727260.0167; val_gene_expr_recon_loss: 14270681.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55936.4492; val_chrom_access_recon_loss: 53350739.2000; val_global_loss: 70479914.1333; val_optim_loss: 70479914.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9609; val_auprc_score: 0.9513; val_best_acc_score: 0.9011; val_best_f1_score: 0.9043; train_kl_reg_loss: 179525438308808625487872.0000; train_edge_recon_loss: 2825508.0267; train_gene_expr_recon_loss: 14529042.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61462.6962; train_chrom_access_recon_loss: 53364251.1145; train_global_loss: 179525438308808692596736.0000; train_optim_loss: 179525438308808692596736.0000; val_kl_reg_loss: 3210819336.4417; val_edge_recon_loss: 2885170.5333; val_gene_expr_recon_loss: 14603171.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79033.6250; val_chrom_access_recon_loss: 54113422.4000; val_global_loss: 3282500272.8000; val_optim_loss: 3282500272.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9542; val_auprc_score: 0.9434; val_best_acc_score: 0.8948; val_best_f1_score: 0.8998; train_kl_reg_loss: 1072545023537.8463; train_edge_recon_loss: 2898429.3931; train_gene_expr_recon_loss: 14573029.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67561.7366; train_chrom_access_recon_loss: 53299373.1603; train_global_loss: 1072615860363.9390; train_optim_loss: 1072615860363.9390; val_kl_reg_loss: 143191.2969; val_edge_recon_loss: 2836733.1500; val_gene_expr_recon_loss: 14154339.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63162.5195; val_chrom_access_recon_loss: 53109499.7333; val_global_loss: 70306925.6000; val_optim_loss: 70306925.6000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9492; val_auprc_score: 0.9364; val_best_acc_score: 0.8888; val_best_f1_score: 0.8938; train_kl_reg_loss: 105420422088643.3750; train_edge_recon_loss: 2828370.1202; train_gene_expr_recon_loss: 14647295.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59384.4111; train_chrom_access_recon_loss: 53103612.3359; train_global_loss: 105420492032847.5781; train_optim_loss: 105420492032847.5781; val_kl_reg_loss: 137229.0375; val_edge_recon_loss: 2877008.8167; val_gene_expr_recon_loss: 14246359.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58536.1406; val_chrom_access_recon_loss: 53681738.9333; val_global_loss: 71000872.2667; val_optim_loss: 71000872.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9509; val_auprc_score: 0.9410; val_best_acc_score: 0.8884; val_best_f1_score: 0.8935; train_kl_reg_loss: 145289699929.1565; train_edge_recon_loss: 2848630.0095; train_gene_expr_recon_loss: 14289494.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47889.0355; train_chrom_access_recon_loss: 52647746.1069; train_global_loss: 145359526246.8702; train_optim_loss: 145359526246.8702; val_kl_reg_loss: 140528.3813; val_edge_recon_loss: 2857547.7333; val_gene_expr_recon_loss: 14188262.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44283.1172; val_chrom_access_recon_loss: 53220684.5333; val_global_loss: 70451305.3333; val_optim_loss: 70451305.3333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9540; val_auprc_score: 0.9415; val_best_acc_score: 0.8944; val_best_f1_score: 0.9002; train_kl_reg_loss: 483837116.4506; train_edge_recon_loss: 2813543.6298; train_gene_expr_recon_loss: 14218790.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43326.9811; train_chrom_access_recon_loss: 52327361.6489; train_global_loss: 553240134.9924; train_optim_loss: 553240134.9924; val_kl_reg_loss: 138757.4094; val_edge_recon_loss: 2805792.3167; val_gene_expr_recon_loss: 14136094.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42022.6719; val_chrom_access_recon_loss: 52708961.6000; val_global_loss: 69831628.2667; val_optim_loss: 69831628.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9541; val_auprc_score: 0.9429; val_best_acc_score: 0.8952; val_best_f1_score: 0.9009; train_kl_reg_loss: 210164320815.6257; train_edge_recon_loss: 2793968.9866; train_gene_expr_recon_loss: 14090987.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41915.2243; train_chrom_access_recon_loss: 52120217.0992; train_global_loss: 210233362796.7634; train_optim_loss: 210233362796.7634; val_kl_reg_loss: 137405.7865; val_edge_recon_loss: 2785188.2333; val_gene_expr_recon_loss: 14023046.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41029.9180; val_chrom_access_recon_loss: 52720816.2667; val_global_loss: 69707486.4000; val_optim_loss: 69707486.4000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9531; val_auprc_score: 0.9373; val_best_acc_score: 0.8963; val_best_f1_score: 0.9020; train_kl_reg_loss: 137837.0453; train_edge_recon_loss: 2778824.4981; train_gene_expr_recon_loss: 14115497.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41177.4325; train_chrom_access_recon_loss: 52149338.3206; train_global_loss: 69222674.5344; train_optim_loss: 69222674.5344; val_kl_reg_loss: 138200.0948; val_edge_recon_loss: 2772384.5000; val_gene_expr_recon_loss: 14034088.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40777.7578; val_chrom_access_recon_loss: 52815314.9333; val_global_loss: 69800765.8667; val_optim_loss: 69800765.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 87 min 28 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9735
val AUPRC score: 0.9670
val best accuracy score: 0.9200
val best F1 score: 0.9231
val target rna MSE score: 0.9283
val source rna MSE score: 0.3144
val target atac MSE score: 0.2098
val source atac MSE score: 0.0198
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
