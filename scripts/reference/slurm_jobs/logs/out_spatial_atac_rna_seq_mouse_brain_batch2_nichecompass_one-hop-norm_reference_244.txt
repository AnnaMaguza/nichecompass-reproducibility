[True]
Run timestamp: 07092023_024630_244.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_244']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 946 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 4542, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 946
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 946

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6607; val_auprc_score: 0.6489; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 61432.3717; train_edge_recon_loss: 3540261.7765; train_gene_expr_recon_loss: 14816105.7727; train_masked_gp_l1_reg_loss: 41736.9081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7584358.4015; train_chrom_access_recon_loss: 5293301.5833; train_global_loss: 31337196.6667; train_optim_loss: 31337196.6667; val_kl_reg_loss: 68252.7158; val_edge_recon_loss: 4065045.6250; val_gene_expr_recon_loss: 13271673.0000; val_masked_gp_l1_reg_loss: 39194.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2648778.2500; val_chrom_access_recon_loss: 5028037.8125; val_global_loss: 25120981.0000; val_optim_loss: 25120981.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6641; val_auprc_score: 0.6478; val_best_acc_score: 0.5962; val_best_f1_score: 0.6909; train_kl_reg_loss: 119534.4375; train_edge_recon_loss: 3538079.9545; train_gene_expr_recon_loss: 13243658.2576; train_masked_gp_l1_reg_loss: 36167.4544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 949768.5705; train_chrom_access_recon_loss: 5010363.2727; train_global_loss: 22897571.9697; train_optim_loss: 22897571.9697; val_kl_reg_loss: 108418.0322; val_edge_recon_loss: 4058320.4375; val_gene_expr_recon_loss: 12735227.6250; val_masked_gp_l1_reg_loss: 34401.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 302815.5938; val_chrom_access_recon_loss: 4896717.6875; val_global_loss: 22135901.7500; val_optim_loss: 22135901.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7184; val_auprc_score: 0.6959; val_best_acc_score: 0.6537; val_best_f1_score: 0.7080; train_kl_reg_loss: 109437.6786; train_edge_recon_loss: 3530144.8712; train_gene_expr_recon_loss: 13028182.6970; train_masked_gp_l1_reg_loss: 34504.8813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 227715.3897; train_chrom_access_recon_loss: 4960517.9242; train_global_loss: 21890503.3939; train_optim_loss: 21890503.3939; val_kl_reg_loss: 99553.0967; val_edge_recon_loss: 4025705.5625; val_gene_expr_recon_loss: 12710789.1250; val_masked_gp_l1_reg_loss: 35128.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185458.5938; val_chrom_access_recon_loss: 4873647.1250; val_global_loss: 21930282.0000; val_optim_loss: 21930282.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7696; val_auprc_score: 0.7460; val_best_acc_score: 0.7018; val_best_f1_score: 0.7341; train_kl_reg_loss: 93380.0144; train_edge_recon_loss: 3502381.4015; train_gene_expr_recon_loss: 12914850.1212; train_masked_gp_l1_reg_loss: 36237.8430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167362.7003; train_chrom_access_recon_loss: 4926582.9242; train_global_loss: 21640795.0000; train_optim_loss: 21640795.0000; val_kl_reg_loss: 100600.7773; val_edge_recon_loss: 3792411.3438; val_gene_expr_recon_loss: 12605724.2500; val_masked_gp_l1_reg_loss: 37501.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152268.1250; val_chrom_access_recon_loss: 4861641.1875; val_global_loss: 21550147.7500; val_optim_loss: 21550147.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8087; val_auprc_score: 0.7930; val_best_acc_score: 0.7431; val_best_f1_score: 0.7614; train_kl_reg_loss: 78464.8667; train_edge_recon_loss: 3271043.1212; train_gene_expr_recon_loss: 12870628.7273; train_masked_gp_l1_reg_loss: 38799.5372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140713.6300; train_chrom_access_recon_loss: 4909962.5682; train_global_loss: 21309612.5455; train_optim_loss: 21309612.5455; val_kl_reg_loss: 93387.5049; val_edge_recon_loss: 3181501.4688; val_gene_expr_recon_loss: 12508352.8750; val_masked_gp_l1_reg_loss: 40214.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132436.0625; val_chrom_access_recon_loss: 4793448.3125; val_global_loss: 20749341.0000; val_optim_loss: 20749341.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8787; val_auprc_score: 0.8462; val_best_acc_score: 0.8098; val_best_f1_score: 0.8260; train_kl_reg_loss: 107891.5800; train_edge_recon_loss: 2998847.0947; train_gene_expr_recon_loss: 12791421.7727; train_masked_gp_l1_reg_loss: 41234.8849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126877.0399; train_chrom_access_recon_loss: 4888373.9848; train_global_loss: 20954646.3636; train_optim_loss: 20954646.3636; val_kl_reg_loss: 115365.4346; val_edge_recon_loss: 2947274.1250; val_gene_expr_recon_loss: 12459074.7500; val_masked_gp_l1_reg_loss: 42160.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123464.3984; val_chrom_access_recon_loss: 4820673.6875; val_global_loss: 20508013.0000; val_optim_loss: 20508013.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8720; val_auprc_score: 0.8337; val_best_acc_score: 0.8106; val_best_f1_score: 0.8284; train_kl_reg_loss: 117604.9929; train_edge_recon_loss: 2884891.1212; train_gene_expr_recon_loss: 12723849.7121; train_masked_gp_l1_reg_loss: 43072.3678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120658.2917; train_chrom_access_recon_loss: 4858353.0985; train_global_loss: 20748429.7576; train_optim_loss: 20748429.7576; val_kl_reg_loss: 113784.7041; val_edge_recon_loss: 2913660.3750; val_gene_expr_recon_loss: 12366061.0000; val_masked_gp_l1_reg_loss: 44169.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117273.5000; val_chrom_access_recon_loss: 4800604.7500; val_global_loss: 20355553.2500; val_optim_loss: 20355553.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8920; val_auprc_score: 0.8503; val_best_acc_score: 0.8350; val_best_f1_score: 0.8471; train_kl_reg_loss: 118790.0038; train_edge_recon_loss: 2850613.1856; train_gene_expr_recon_loss: 12650525.8030; train_masked_gp_l1_reg_loss: 45001.4974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114515.8440; train_chrom_access_recon_loss: 4831084.3788; train_global_loss: 20610530.7879; train_optim_loss: 20610530.7879; val_kl_reg_loss: 113422.3721; val_edge_recon_loss: 2859252.8750; val_gene_expr_recon_loss: 12338812.8750; val_masked_gp_l1_reg_loss: 45811.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112453.6016; val_chrom_access_recon_loss: 4769318.9375; val_global_loss: 20239073.0000; val_optim_loss: 20239073.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8959; val_auprc_score: 0.8689; val_best_acc_score: 0.8283; val_best_f1_score: 0.8404; train_kl_reg_loss: 116081.2388; train_edge_recon_loss: 2835208.7121; train_gene_expr_recon_loss: 12592543.1667; train_masked_gp_l1_reg_loss: 46600.2463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110097.8263; train_chrom_access_recon_loss: 4811782.8409; train_global_loss: 20512314.2121; train_optim_loss: 20512314.2121; val_kl_reg_loss: 117251.8506; val_edge_recon_loss: 2889983.5312; val_gene_expr_recon_loss: 12375563.2500; val_masked_gp_l1_reg_loss: 47395.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108582.2109; val_chrom_access_recon_loss: 4739547.0000; val_global_loss: 20278323.2500; val_optim_loss: 20278323.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8974; val_auprc_score: 0.8612; val_best_acc_score: 0.8307; val_best_f1_score: 0.8462; train_kl_reg_loss: 113224.9598; train_edge_recon_loss: 2835466.3750; train_gene_expr_recon_loss: 12536667.0152; train_masked_gp_l1_reg_loss: 48042.9078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108018.4671; train_chrom_access_recon_loss: 4791577.3030; train_global_loss: 20432997.0606; train_optim_loss: 20432997.0606; val_kl_reg_loss: 112405.1221; val_edge_recon_loss: 2858503.5312; val_gene_expr_recon_loss: 12223440.6250; val_masked_gp_l1_reg_loss: 48861.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106262.4531; val_chrom_access_recon_loss: 4705847.7500; val_global_loss: 20055321.5000; val_optim_loss: 20055321.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9124; val_auprc_score: 0.8886; val_best_acc_score: 0.8490; val_best_f1_score: 0.8583; train_kl_reg_loss: 109223.4860; train_edge_recon_loss: 2831370.0530; train_gene_expr_recon_loss: 12490712.5909; train_masked_gp_l1_reg_loss: 49417.3316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105695.0849; train_chrom_access_recon_loss: 4770983.6818; train_global_loss: 20357402.2121; train_optim_loss: 20357402.2121; val_kl_reg_loss: 106232.7539; val_edge_recon_loss: 2816494.0000; val_gene_expr_recon_loss: 12128975.8750; val_masked_gp_l1_reg_loss: 50190.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105409.5000; val_chrom_access_recon_loss: 4679573.1250; val_global_loss: 19886876.0000; val_optim_loss: 19886876.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9073; val_auprc_score: 0.8801; val_best_acc_score: 0.8447; val_best_f1_score: 0.8555; train_kl_reg_loss: 106046.9289; train_edge_recon_loss: 2833870.3371; train_gene_expr_recon_loss: 12437418.1970; train_masked_gp_l1_reg_loss: 50719.2688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105127.3737; train_chrom_access_recon_loss: 4754316.1894; train_global_loss: 20287498.3333; train_optim_loss: 20287498.3333; val_kl_reg_loss: 105787.4453; val_edge_recon_loss: 2869283.5625; val_gene_expr_recon_loss: 12398045.5000; val_masked_gp_l1_reg_loss: 51328.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105269.8984; val_chrom_access_recon_loss: 4721396.1875; val_global_loss: 20251111.7500; val_optim_loss: 20251111.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9067; val_auprc_score: 0.8783; val_best_acc_score: 0.8479; val_best_f1_score: 0.8589; train_kl_reg_loss: 103740.4684; train_edge_recon_loss: 2813478.1288; train_gene_expr_recon_loss: 12385794.3182; train_masked_gp_l1_reg_loss: 51858.6456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105259.5559; train_chrom_access_recon_loss: 4734679.5227; train_global_loss: 20194810.6970; train_optim_loss: 20194810.6970; val_kl_reg_loss: 101555.0146; val_edge_recon_loss: 2855405.3438; val_gene_expr_recon_loss: 11983080.1250; val_masked_gp_l1_reg_loss: 52473.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105030.2969; val_chrom_access_recon_loss: 4644019.6875; val_global_loss: 19741563.0000; val_optim_loss: 19741563.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9105; val_auprc_score: 0.8728; val_best_acc_score: 0.8533; val_best_f1_score: 0.8617; train_kl_reg_loss: 105287.5101; train_edge_recon_loss: 2797469.5341; train_gene_expr_recon_loss: 12348205.8333; train_masked_gp_l1_reg_loss: 52848.2378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104934.1239; train_chrom_access_recon_loss: 4720310.8864; train_global_loss: 20129056.1818; train_optim_loss: 20129056.1818; val_kl_reg_loss: 101656.3457; val_edge_recon_loss: 2849697.0625; val_gene_expr_recon_loss: 12009422.3750; val_masked_gp_l1_reg_loss: 53384.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104848.1016; val_chrom_access_recon_loss: 4683230.1875; val_global_loss: 19802239.2500; val_optim_loss: 19802239.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9182; val_auprc_score: 0.8913; val_best_acc_score: 0.8616; val_best_f1_score: 0.8665; train_kl_reg_loss: 101395.1070; train_edge_recon_loss: 2794119.3674; train_gene_expr_recon_loss: 12314292.4394; train_masked_gp_l1_reg_loss: 53764.0223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104987.0771; train_chrom_access_recon_loss: 4713393.3485; train_global_loss: 20081951.3939; train_optim_loss: 20081951.3939; val_kl_reg_loss: 101898.1885; val_edge_recon_loss: 2823611.4375; val_gene_expr_recon_loss: 12012851.2500; val_masked_gp_l1_reg_loss: 54309.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105336.7734; val_chrom_access_recon_loss: 4656429.0000; val_global_loss: 19754436.0000; val_optim_loss: 19754436.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9235; val_auprc_score: 0.8915; val_best_acc_score: 0.8678; val_best_f1_score: 0.8749; train_kl_reg_loss: 99092.9206; train_edge_recon_loss: 2789067.3788; train_gene_expr_recon_loss: 12276639.4848; train_masked_gp_l1_reg_loss: 54752.5476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105351.5883; train_chrom_access_recon_loss: 4695926.7652; train_global_loss: 20020830.6970; train_optim_loss: 20020830.6970; val_kl_reg_loss: 97881.9121; val_edge_recon_loss: 2770953.6562; val_gene_expr_recon_loss: 11992736.1250; val_masked_gp_l1_reg_loss: 55244.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105197.4375; val_chrom_access_recon_loss: 4608719.2500; val_global_loss: 19630732.0000; val_optim_loss: 19630732.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9218; val_auprc_score: 0.8954; val_best_acc_score: 0.8632; val_best_f1_score: 0.8698; train_kl_reg_loss: 98993.9695; train_edge_recon_loss: 2774975.2765; train_gene_expr_recon_loss: 12234038.7879; train_masked_gp_l1_reg_loss: 55554.1228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105224.0172; train_chrom_access_recon_loss: 4677951.8561; train_global_loss: 19946737.9091; train_optim_loss: 19946737.9091; val_kl_reg_loss: 96095.4814; val_edge_recon_loss: 2827544.2188; val_gene_expr_recon_loss: 11873895.5000; val_masked_gp_l1_reg_loss: 55974.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105335.5312; val_chrom_access_recon_loss: 4599569.3750; val_global_loss: 19558414.5000; val_optim_loss: 19558414.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9305; val_auprc_score: 0.9109; val_best_acc_score: 0.8710; val_best_f1_score: 0.8763; train_kl_reg_loss: 95351.2344; train_edge_recon_loss: 2787619.8712; train_gene_expr_recon_loss: 12208624.0606; train_masked_gp_l1_reg_loss: 56393.3274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104962.9160; train_chrom_access_recon_loss: 4670231.0682; train_global_loss: 19923182.3939; train_optim_loss: 19923182.3939; val_kl_reg_loss: 95719.4688; val_edge_recon_loss: 2771845.5312; val_gene_expr_recon_loss: 11873406.8750; val_masked_gp_l1_reg_loss: 56799.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105301.5938; val_chrom_access_recon_loss: 4586107.8750; val_global_loss: 19489181.7500; val_optim_loss: 19489181.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9273; val_auprc_score: 0.9026; val_best_acc_score: 0.8678; val_best_f1_score: 0.8776; train_kl_reg_loss: 95837.0517; train_edge_recon_loss: 2774477.9735; train_gene_expr_recon_loss: 12168673.3182; train_masked_gp_l1_reg_loss: 57147.3610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105125.4183; train_chrom_access_recon_loss: 4653557.9242; train_global_loss: 19854819.0909; train_optim_loss: 19854819.0909; val_kl_reg_loss: 95702.3281; val_edge_recon_loss: 2770473.0938; val_gene_expr_recon_loss: 11800055.3750; val_masked_gp_l1_reg_loss: 57477.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105283.2578; val_chrom_access_recon_loss: 4585795.1250; val_global_loss: 19414786.7500; val_optim_loss: 19414786.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9298; val_auprc_score: 0.8985; val_best_acc_score: 0.8807; val_best_f1_score: 0.8863; train_kl_reg_loss: 93498.1256; train_edge_recon_loss: 2773553.3333; train_gene_expr_recon_loss: 12144743.9242; train_masked_gp_l1_reg_loss: 57839.7554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105496.8305; train_chrom_access_recon_loss: 4640881.9394; train_global_loss: 19816013.9091; train_optim_loss: 19816013.9091; val_kl_reg_loss: 90065.5928; val_edge_recon_loss: 2775393.5000; val_gene_expr_recon_loss: 11778973.3750; val_masked_gp_l1_reg_loss: 58282.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105761.7344; val_chrom_access_recon_loss: 4561839.3125; val_global_loss: 19370315.7500; val_optim_loss: 19370315.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9229; val_auprc_score: 0.8937; val_best_acc_score: 0.8678; val_best_f1_score: 0.8746; train_kl_reg_loss: 93656.9266; train_edge_recon_loss: 2768535.1098; train_gene_expr_recon_loss: 12110373.2273; train_masked_gp_l1_reg_loss: 58604.1958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105740.7829; train_chrom_access_recon_loss: 4630426.4621; train_global_loss: 19767336.6667; train_optim_loss: 19767336.6667; val_kl_reg_loss: 92209.8525; val_edge_recon_loss: 2819804.3438; val_gene_expr_recon_loss: 11822869.0000; val_masked_gp_l1_reg_loss: 58854.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106380.2969; val_chrom_access_recon_loss: 4566838.3125; val_global_loss: 19466955.2500; val_optim_loss: 19466955.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9266; val_auprc_score: 0.8967; val_best_acc_score: 0.8756; val_best_f1_score: 0.8837; train_kl_reg_loss: 92624.2468; train_edge_recon_loss: 2763594.8674; train_gene_expr_recon_loss: 12085206.0152; train_masked_gp_l1_reg_loss: 59214.2998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106748.2076; train_chrom_access_recon_loss: 4618576.9091; train_global_loss: 19725964.4242; train_optim_loss: 19725964.4242; val_kl_reg_loss: 95505.9629; val_edge_recon_loss: 2802489.8438; val_gene_expr_recon_loss: 11658988.8750; val_masked_gp_l1_reg_loss: 59626.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107171.3828; val_chrom_access_recon_loss: 4548255.3125; val_global_loss: 19272036.7500; val_optim_loss: 19272036.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9319; val_auprc_score: 0.9105; val_best_acc_score: 0.8778; val_best_f1_score: 0.8841; train_kl_reg_loss: 92399.4233; train_edge_recon_loss: 2762316.9053; train_gene_expr_recon_loss: 12061995.6515; train_masked_gp_l1_reg_loss: 59902.9209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107685.1147; train_chrom_access_recon_loss: 4611833.7045; train_global_loss: 19696133.6061; train_optim_loss: 19696133.6061; val_kl_reg_loss: 91998.6328; val_edge_recon_loss: 2785369.9062; val_gene_expr_recon_loss: 11873077.3750; val_masked_gp_l1_reg_loss: 60259.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108032.0469; val_chrom_access_recon_loss: 4559763.1875; val_global_loss: 19478500.2500; val_optim_loss: 19478500.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9269; val_auprc_score: 0.8988; val_best_acc_score: 0.8726; val_best_f1_score: 0.8771; train_kl_reg_loss: 92290.4667; train_edge_recon_loss: 2741299.5076; train_gene_expr_recon_loss: 12043113.2424; train_masked_gp_l1_reg_loss: 60508.9804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108436.3728; train_chrom_access_recon_loss: 4597536.5985; train_global_loss: 19643185.2121; train_optim_loss: 19643185.2121; val_kl_reg_loss: 94571.7764; val_edge_recon_loss: 2786722.4062; val_gene_expr_recon_loss: 11626173.8750; val_masked_gp_l1_reg_loss: 60830.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108528.4688; val_chrom_access_recon_loss: 4513654.6875; val_global_loss: 19190481.5000; val_optim_loss: 19190481.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9296; val_auprc_score: 0.9056; val_best_acc_score: 0.8778; val_best_f1_score: 0.8833; train_kl_reg_loss: 91193.1513; train_edge_recon_loss: 2746842.6667; train_gene_expr_recon_loss: 12016026.3030; train_masked_gp_l1_reg_loss: 61137.5562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108862.2612; train_chrom_access_recon_loss: 4592531.6136; train_global_loss: 19616593.6061; train_optim_loss: 19616593.6061; val_kl_reg_loss: 90289.0732; val_edge_recon_loss: 2781231.3750; val_gene_expr_recon_loss: 11706709.5000; val_masked_gp_l1_reg_loss: 61496.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108889.6484; val_chrom_access_recon_loss: 4535046.6875; val_global_loss: 19283663.0000; val_optim_loss: 19283663.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9394; val_auprc_score: 0.9153; val_best_acc_score: 0.8885; val_best_f1_score: 0.8951; train_kl_reg_loss: 92201.8000; train_edge_recon_loss: 2742222.3106; train_gene_expr_recon_loss: 11982411.2121; train_masked_gp_l1_reg_loss: 61724.5996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108898.9402; train_chrom_access_recon_loss: 4580792.4015; train_global_loss: 19568251.2424; train_optim_loss: 19568251.2424; val_kl_reg_loss: 91116.4258; val_edge_recon_loss: 2752462.5312; val_gene_expr_recon_loss: 11578903.7500; val_masked_gp_l1_reg_loss: 62117.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109260.5312; val_chrom_access_recon_loss: 4456933.6875; val_global_loss: 19050793.7500; val_optim_loss: 19050793.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9326; val_auprc_score: 0.9094; val_best_acc_score: 0.8726; val_best_f1_score: 0.8793; train_kl_reg_loss: 90260.3422; train_edge_recon_loss: 2744339.0000; train_gene_expr_recon_loss: 11967755.4242; train_masked_gp_l1_reg_loss: 62316.6614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109157.5933; train_chrom_access_recon_loss: 4569057.0833; train_global_loss: 19542885.9697; train_optim_loss: 19542885.9697; val_kl_reg_loss: 90526.9248; val_edge_recon_loss: 2790252.2500; val_gene_expr_recon_loss: 11699116.1250; val_masked_gp_l1_reg_loss: 62573.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109092.2969; val_chrom_access_recon_loss: 4512347.6875; val_global_loss: 19263908.0000; val_optim_loss: 19263908.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9388; val_auprc_score: 0.9164; val_best_acc_score: 0.8847; val_best_f1_score: 0.8917; train_kl_reg_loss: 89873.6750; train_edge_recon_loss: 2738232.3485; train_gene_expr_recon_loss: 11943066.9545; train_masked_gp_l1_reg_loss: 62836.3126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109226.4728; train_chrom_access_recon_loss: 4558247.2273; train_global_loss: 19501482.9394; train_optim_loss: 19501482.9394; val_kl_reg_loss: 91339.0195; val_edge_recon_loss: 2747439.1250; val_gene_expr_recon_loss: 11652544.2500; val_masked_gp_l1_reg_loss: 63314.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109477.2891; val_chrom_access_recon_loss: 4497004.8750; val_global_loss: 19161119.5000; val_optim_loss: 19161119.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9390; val_auprc_score: 0.9146; val_best_acc_score: 0.8864; val_best_f1_score: 0.8904; train_kl_reg_loss: 90230.5862; train_edge_recon_loss: 2720311.9848; train_gene_expr_recon_loss: 11926743.6818; train_masked_gp_l1_reg_loss: 63491.1286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109182.0791; train_chrom_access_recon_loss: 4548568.0606; train_global_loss: 19458527.4242; train_optim_loss: 19458527.4242; val_kl_reg_loss: 90790.0947; val_edge_recon_loss: 2753604.7500; val_gene_expr_recon_loss: 11653643.5000; val_masked_gp_l1_reg_loss: 63730.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108387.3438; val_chrom_access_recon_loss: 4502358.5625; val_global_loss: 19172514.0000; val_optim_loss: 19172514.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9358; val_auprc_score: 0.9143; val_best_acc_score: 0.8831; val_best_f1_score: 0.8888; train_kl_reg_loss: 88995.7638; train_edge_recon_loss: 2719772.7197; train_gene_expr_recon_loss: 11910192.2576; train_masked_gp_l1_reg_loss: 64025.7119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109294.4987; train_chrom_access_recon_loss: 4542197.0909; train_global_loss: 19434478.0303; train_optim_loss: 19434478.0303; val_kl_reg_loss: 89772.8857; val_edge_recon_loss: 2765936.6250; val_gene_expr_recon_loss: 11638191.8750; val_masked_gp_l1_reg_loss: 64443.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109266.8047; val_chrom_access_recon_loss: 4511312.5625; val_global_loss: 19178924.2500; val_optim_loss: 19178924.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9434; val_auprc_score: 0.9230; val_best_acc_score: 0.8896; val_best_f1_score: 0.8955; train_kl_reg_loss: 89316.2351; train_edge_recon_loss: 2721269.5303; train_gene_expr_recon_loss: 11889604.5000; train_masked_gp_l1_reg_loss: 63635.7348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82489.1971; train_chrom_access_recon_loss: 4531413.4015; train_global_loss: 19377728.8182; train_optim_loss: 19377728.8182; val_kl_reg_loss: 90762.4531; val_edge_recon_loss: 2769949.9688; val_gene_expr_recon_loss: 11632342.0000; val_masked_gp_l1_reg_loss: 63170.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77423.8516; val_chrom_access_recon_loss: 4516449.3125; val_global_loss: 19150098.2500; val_optim_loss: 19150098.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9407; val_auprc_score: 0.9195; val_best_acc_score: 0.8877; val_best_f1_score: 0.8935; train_kl_reg_loss: 90588.4583; train_edge_recon_loss: 2727007.0000; train_gene_expr_recon_loss: 11885904.3939; train_masked_gp_l1_reg_loss: 63059.9350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77062.4740; train_chrom_access_recon_loss: 4526753.2652; train_global_loss: 19370375.5758; train_optim_loss: 19370375.5758; val_kl_reg_loss: 91713.5195; val_edge_recon_loss: 2759256.5938; val_gene_expr_recon_loss: 11612463.2500; val_masked_gp_l1_reg_loss: 62993.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76751.5781; val_chrom_access_recon_loss: 4516137.6875; val_global_loss: 19119316.5000; val_optim_loss: 19119316.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9432; val_auprc_score: 0.9218; val_best_acc_score: 0.8933; val_best_f1_score: 0.8991; train_kl_reg_loss: 91151.5555; train_edge_recon_loss: 2721172.8598; train_gene_expr_recon_loss: 11886235.4545; train_masked_gp_l1_reg_loss: 62967.8215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76581.7718; train_chrom_access_recon_loss: 4527568.3712; train_global_loss: 19365677.6970; train_optim_loss: 19365677.6970; val_kl_reg_loss: 92110.3896; val_edge_recon_loss: 2747203.3125; val_gene_expr_recon_loss: 11626736.2500; val_masked_gp_l1_reg_loss: 62964.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76411.6641; val_chrom_access_recon_loss: 4486681.7500; val_global_loss: 19092108.2500; val_optim_loss: 19092108.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9408; val_auprc_score: 0.9186; val_best_acc_score: 0.8882; val_best_f1_score: 0.8935; train_kl_reg_loss: 92031.1720; train_edge_recon_loss: 2719524.2083; train_gene_expr_recon_loss: 11876756.3182; train_masked_gp_l1_reg_loss: 62961.7002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76269.2829; train_chrom_access_recon_loss: 4524492.5985; train_global_loss: 19352035.2727; train_optim_loss: 19352035.2727; val_kl_reg_loss: 93658.3096; val_edge_recon_loss: 2746322.4062; val_gene_expr_recon_loss: 11523339.8750; val_masked_gp_l1_reg_loss: 62969.0508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76176.2656; val_chrom_access_recon_loss: 4453004.5625; val_global_loss: 18955469.7500; val_optim_loss: 18955469.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9393; val_auprc_score: 0.9201; val_best_acc_score: 0.8861; val_best_f1_score: 0.8906; train_kl_reg_loss: 92140.7352; train_edge_recon_loss: 2719464.1970; train_gene_expr_recon_loss: 11877759.2879; train_masked_gp_l1_reg_loss: 62981.4956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76052.6101; train_chrom_access_recon_loss: 4525298.9167; train_global_loss: 19353697.2727; train_optim_loss: 19353697.2727; val_kl_reg_loss: 93136.6230; val_edge_recon_loss: 2759305.1562; val_gene_expr_recon_loss: 11651470.0000; val_masked_gp_l1_reg_loss: 62982.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75920.6094; val_chrom_access_recon_loss: 4496135.8125; val_global_loss: 19138951.2500; val_optim_loss: 19138951.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9408; val_auprc_score: 0.9192; val_best_acc_score: 0.8890; val_best_f1_score: 0.8946; train_kl_reg_loss: 91911.1476; train_edge_recon_loss: 2715028.1553; train_gene_expr_recon_loss: 11858190.1364; train_masked_gp_l1_reg_loss: 63017.6006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75853.0071; train_chrom_access_recon_loss: 4519418.0455; train_global_loss: 19323417.8788; train_optim_loss: 19323417.8788; val_kl_reg_loss: 93363.1875; val_edge_recon_loss: 2739106.8125; val_gene_expr_recon_loss: 11555124.1250; val_masked_gp_l1_reg_loss: 63029.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75750.7188; val_chrom_access_recon_loss: 4482806.6875; val_global_loss: 19009182.2500; val_optim_loss: 19009182.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9460; val_auprc_score: 0.9250; val_best_acc_score: 0.8944; val_best_f1_score: 0.8977; train_kl_reg_loss: 92150.6866; train_edge_recon_loss: 2711977.4053; train_gene_expr_recon_loss: 11866778.8182; train_masked_gp_l1_reg_loss: 63057.7695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75723.2635; train_chrom_access_recon_loss: 4518189.1439; train_global_loss: 19327877.1818; train_optim_loss: 19327877.1818; val_kl_reg_loss: 91928.9209; val_edge_recon_loss: 2749611.3750; val_gene_expr_recon_loss: 11541511.7500; val_masked_gp_l1_reg_loss: 63081.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75652.5000; val_chrom_access_recon_loss: 4474644.5000; val_global_loss: 18996431.0000; val_optim_loss: 18996431.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9415; val_auprc_score: 0.9185; val_best_acc_score: 0.8909; val_best_f1_score: 0.8965; train_kl_reg_loss: 91913.2607; train_edge_recon_loss: 2716726.4091; train_gene_expr_recon_loss: 11865997.0758; train_masked_gp_l1_reg_loss: 63115.3127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75514.7926; train_chrom_access_recon_loss: 4520247.3788; train_global_loss: 19333514.1212; train_optim_loss: 19333514.1212; val_kl_reg_loss: 91990.4375; val_edge_recon_loss: 2738411.5938; val_gene_expr_recon_loss: 11590793.6250; val_masked_gp_l1_reg_loss: 63133.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75430.7578; val_chrom_access_recon_loss: 4466205.5000; val_global_loss: 19025966.0000; val_optim_loss: 19025966.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9561; val_auprc_score: 0.9438; val_best_acc_score: 0.9006; val_best_f1_score: 0.9025; train_kl_reg_loss: 92038.5232; train_edge_recon_loss: 2715512.7348; train_gene_expr_recon_loss: 11865186.3788; train_masked_gp_l1_reg_loss: 63053.0760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72788.7603; train_chrom_access_recon_loss: 4516822.8371; train_global_loss: 19325402.3030; train_optim_loss: 19325402.3030; val_kl_reg_loss: 93323.6865; val_edge_recon_loss: 2721035.8438; val_gene_expr_recon_loss: 11598291.6250; val_masked_gp_l1_reg_loss: 62990.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72281.1406; val_chrom_access_recon_loss: 4480953.6875; val_global_loss: 19028875.7500; val_optim_loss: 19028875.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9413; val_auprc_score: 0.9207; val_best_acc_score: 0.8893; val_best_f1_score: 0.8955; train_kl_reg_loss: 92123.5501; train_edge_recon_loss: 2714789.6288; train_gene_expr_recon_loss: 11868711.2424; train_masked_gp_l1_reg_loss: 62967.2366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72227.1093; train_chrom_access_recon_loss: 4519090.0303; train_global_loss: 19329908.7879; train_optim_loss: 19329908.7879; val_kl_reg_loss: 93030.7285; val_edge_recon_loss: 2741788.6875; val_gene_expr_recon_loss: 11550559.2500; val_masked_gp_l1_reg_loss: 62950.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72196.3359; val_chrom_access_recon_loss: 4457516.5625; val_global_loss: 18978042.5000; val_optim_loss: 18978042.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9496; val_auprc_score: 0.9305; val_best_acc_score: 0.8984; val_best_f1_score: 0.9029; train_kl_reg_loss: 92213.0541; train_edge_recon_loss: 2718197.9583; train_gene_expr_recon_loss: 11858594.6212; train_masked_gp_l1_reg_loss: 62944.4234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72176.4777; train_chrom_access_recon_loss: 4519099.7652; train_global_loss: 19323226.3030; train_optim_loss: 19323226.3030; val_kl_reg_loss: 93625.0059; val_edge_recon_loss: 2720444.1250; val_gene_expr_recon_loss: 11527894.0000; val_masked_gp_l1_reg_loss: 62937.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72155.4375; val_chrom_access_recon_loss: 4453510.6250; val_global_loss: 18930566.0000; val_optim_loss: 18930566.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9416; val_auprc_score: 0.9173; val_best_acc_score: 0.8864; val_best_f1_score: 0.8936; train_kl_reg_loss: 92313.2515; train_edge_recon_loss: 2713157.8068; train_gene_expr_recon_loss: 11865795.8636; train_masked_gp_l1_reg_loss: 62935.6876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72133.4641; train_chrom_access_recon_loss: 4517612.1515; train_global_loss: 19323948.2727; train_optim_loss: 19323948.2727; val_kl_reg_loss: 93429.2568; val_edge_recon_loss: 2751046.3125; val_gene_expr_recon_loss: 11738944.3750; val_masked_gp_l1_reg_loss: 62933.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72119.1016; val_chrom_access_recon_loss: 4520661.1875; val_global_loss: 19239133.2500; val_optim_loss: 19239133.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9433; val_auprc_score: 0.9206; val_best_acc_score: 0.8885; val_best_f1_score: 0.8926; train_kl_reg_loss: 92216.3402; train_edge_recon_loss: 2713296.4735; train_gene_expr_recon_loss: 11860944.0000; train_masked_gp_l1_reg_loss: 62933.1355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72112.3268; train_chrom_access_recon_loss: 4518439.1818; train_global_loss: 19319941.6061; train_optim_loss: 19319941.6061; val_kl_reg_loss: 93114.0215; val_edge_recon_loss: 2759893.9375; val_gene_expr_recon_loss: 11615310.1250; val_masked_gp_l1_reg_loss: 62931.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72096.4844; val_chrom_access_recon_loss: 4492469.3750; val_global_loss: 19095814.7500; val_optim_loss: 19095814.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9467; val_auprc_score: 0.9289; val_best_acc_score: 0.8917; val_best_f1_score: 0.8961; train_kl_reg_loss: 92366.0682; train_edge_recon_loss: 2715651.5152; train_gene_expr_recon_loss: 11868401.5152; train_masked_gp_l1_reg_loss: 62934.2624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72077.6886; train_chrom_access_recon_loss: 4518598.2045; train_global_loss: 19330029.3333; train_optim_loss: 19330029.3333; val_kl_reg_loss: 93912.2959; val_edge_recon_loss: 2753453.7812; val_gene_expr_recon_loss: 11575156.7500; val_masked_gp_l1_reg_loss: 62933.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72066.8359; val_chrom_access_recon_loss: 4475326.6250; val_global_loss: 19032850.2500; val_optim_loss: 19032850.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9459; val_auprc_score: 0.9285; val_best_acc_score: 0.8915; val_best_f1_score: 0.8952; train_kl_reg_loss: 92335.1052; train_edge_recon_loss: 2717130.3295; train_gene_expr_recon_loss: 11851714.9545; train_masked_gp_l1_reg_loss: 62938.0283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72065.4170; train_chrom_access_recon_loss: 4515738.6894; train_global_loss: 19311922.6667; train_optim_loss: 19311922.6667; val_kl_reg_loss: 93666.6787; val_edge_recon_loss: 2749911.9688; val_gene_expr_recon_loss: 11636444.6250; val_masked_gp_l1_reg_loss: 62935.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72045.5625; val_chrom_access_recon_loss: 4498543.5625; val_global_loss: 19113549.2500; val_optim_loss: 19113549.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9430; val_auprc_score: 0.9288; val_best_acc_score: 0.8845; val_best_f1_score: 0.8910; train_kl_reg_loss: 92297.7897; train_edge_recon_loss: 2714075.1477; train_gene_expr_recon_loss: 11861554.4848; train_masked_gp_l1_reg_loss: 62928.7005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71780.9119; train_chrom_access_recon_loss: 4517434.6212; train_global_loss: 19320071.7273; train_optim_loss: 19320071.7273; val_kl_reg_loss: 93067.6631; val_edge_recon_loss: 2769470.9375; val_gene_expr_recon_loss: 11662743.3750; val_masked_gp_l1_reg_loss: 62922.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71729.3594; val_chrom_access_recon_loss: 4455074.4375; val_global_loss: 19115008.7500; val_optim_loss: 19115008.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9454; val_auprc_score: 0.9279; val_best_acc_score: 0.8898; val_best_f1_score: 0.8940; train_kl_reg_loss: 92292.8877; train_edge_recon_loss: 2713983.7386; train_gene_expr_recon_loss: 11865787.5909; train_masked_gp_l1_reg_loss: 62920.4656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71724.3095; train_chrom_access_recon_loss: 4519270.7348; train_global_loss: 19325979.6970; train_optim_loss: 19325979.6970; val_kl_reg_loss: 94378.7539; val_edge_recon_loss: 2740774.6562; val_gene_expr_recon_loss: 11723554.1250; val_masked_gp_l1_reg_loss: 62918.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71721.0312; val_chrom_access_recon_loss: 4555507.5000; val_global_loss: 19248855.2500; val_optim_loss: 19248855.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9439; val_auprc_score: 0.9254; val_best_acc_score: 0.8898; val_best_f1_score: 0.8945; train_kl_reg_loss: 92393.3074; train_edge_recon_loss: 2721007.7917; train_gene_expr_recon_loss: 11871157.5909; train_masked_gp_l1_reg_loss: 62917.5587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71718.5856; train_chrom_access_recon_loss: 4516351.5606; train_global_loss: 19335546.4545; train_optim_loss: 19335546.4545; val_kl_reg_loss: 93563.9766; val_edge_recon_loss: 2755528.4062; val_gene_expr_recon_loss: 11519671.8750; val_masked_gp_l1_reg_loss: 62916.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71716.0391; val_chrom_access_recon_loss: 4470359.5625; val_global_loss: 18973757.0000; val_optim_loss: 18973757.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9472; val_auprc_score: 0.9289; val_best_acc_score: 0.8896; val_best_f1_score: 0.8935; train_kl_reg_loss: 92370.0376; train_edge_recon_loss: 2721308.8106; train_gene_expr_recon_loss: 11864941.0303; train_masked_gp_l1_reg_loss: 62916.0821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71713.5484; train_chrom_access_recon_loss: 4518048.6364; train_global_loss: 19331298.2727; train_optim_loss: 19331298.2727; val_kl_reg_loss: 92982.6377; val_edge_recon_loss: 2758046.6875; val_gene_expr_recon_loss: 11600258.0000; val_masked_gp_l1_reg_loss: 62915.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71712.1875; val_chrom_access_recon_loss: 4505218.4375; val_global_loss: 19091133.0000; val_optim_loss: 19091133.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 12 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9455
val AUPRC score: 0.9271
val best accuracy score: 0.8909
val best F1 score: 0.8963
val target rna MSE score: 1.0154
val source rna MSE score: 0.3536
val target atac MSE score: 0.4743
val source atac MSE score: 0.1011
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
