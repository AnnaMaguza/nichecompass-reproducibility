[True]
Run timestamp: 26072023_234002_71.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_71']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8631; val_auprc_score: 0.9733; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 187247.9578; train_edge_recon_loss: 1148363.7506; train_gene_expr_recon_loss: 3130992.8680; train_masked_gp_l1_reg_loss: 15469.6553; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4482074.2221; train_optim_loss: 4482074.2221; val_kl_reg_loss: 96127.6670; val_edge_recon_loss: 1198735.4010; val_gene_expr_recon_loss: 1384147.4062; val_masked_gp_l1_reg_loss: 16203.4668; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2695213.9896; val_optim_loss: 2695213.9896
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8581; val_auprc_score: 0.9720; val_best_acc_score: 0.8614; val_best_f1_score: 0.9249; train_kl_reg_loss: 86102.8423; train_edge_recon_loss: 1106004.7657; train_gene_expr_recon_loss: 1273889.1116; train_masked_gp_l1_reg_loss: 16378.7846; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2482375.5116; train_optim_loss: 2482375.5116; val_kl_reg_loss: 60407.7471; val_edge_recon_loss: 1182531.1797; val_gene_expr_recon_loss: 1105491.5156; val_masked_gp_l1_reg_loss: 16443.0508; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2364873.4271; val_optim_loss: 2364873.4271
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8408; val_auprc_score: 0.9673; val_best_acc_score: 0.8616; val_best_f1_score: 0.9240; train_kl_reg_loss: 66247.8062; train_edge_recon_loss: 1077488.9837; train_gene_expr_recon_loss: 1076498.4494; train_masked_gp_l1_reg_loss: 16488.4254; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2236723.6669; train_optim_loss: 2236723.6669; val_kl_reg_loss: 47226.6885; val_edge_recon_loss: 1210731.3255; val_gene_expr_recon_loss: 1050299.0495; val_masked_gp_l1_reg_loss: 16584.1387; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2324841.2812; val_optim_loss: 2324841.2812
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8399; val_auprc_score: 0.9631; val_best_acc_score: 0.8831; val_best_f1_score: 0.9351; train_kl_reg_loss: 53142.7443; train_edge_recon_loss: 1053117.7160; train_gene_expr_recon_loss: 1017991.8285; train_masked_gp_l1_reg_loss: 16756.6338; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2141008.9186; train_optim_loss: 2141008.9186; val_kl_reg_loss: 44991.6043; val_edge_recon_loss: 1113554.3958; val_gene_expr_recon_loss: 985793.6562; val_masked_gp_l1_reg_loss: 16930.0996; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2161269.6979; val_optim_loss: 2161269.6979
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8470; val_auprc_score: 0.9632; val_best_acc_score: 0.8852; val_best_f1_score: 0.9354; train_kl_reg_loss: 49299.5580; train_edge_recon_loss: 993327.1799; train_gene_expr_recon_loss: 975825.4230; train_masked_gp_l1_reg_loss: 17295.6859; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2035747.8395; train_optim_loss: 2035747.8395; val_kl_reg_loss: 51777.1746; val_edge_recon_loss: 975323.9870; val_gene_expr_recon_loss: 959468.5938; val_masked_gp_l1_reg_loss: 17726.5977; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2004296.3750; val_optim_loss: 2004296.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8401; val_auprc_score: 0.9607; val_best_acc_score: 0.8940; val_best_f1_score: 0.9406; train_kl_reg_loss: 53269.4067; train_edge_recon_loss: 911898.7567; train_gene_expr_recon_loss: 946654.8041; train_masked_gp_l1_reg_loss: 18108.2947; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1929931.2599; train_optim_loss: 1929931.2599; val_kl_reg_loss: 48764.2645; val_edge_recon_loss: 914698.0755; val_gene_expr_recon_loss: 930728.2422; val_masked_gp_l1_reg_loss: 18441.2129; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1912631.8281; val_optim_loss: 1912631.8281
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8439; val_auprc_score: 0.9642; val_best_acc_score: 0.9005; val_best_f1_score: 0.9446; train_kl_reg_loss: 45984.7038; train_edge_recon_loss: 897432.0628; train_gene_expr_recon_loss: 919187.6526; train_masked_gp_l1_reg_loss: 18661.9904; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1881266.4105; train_optim_loss: 1881266.4105; val_kl_reg_loss: 40423.1326; val_edge_recon_loss: 885838.5339; val_gene_expr_recon_loss: 905570.3125; val_masked_gp_l1_reg_loss: 18804.6406; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1850636.6042; val_optim_loss: 1850636.6042
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8425; val_auprc_score: 0.9639; val_best_acc_score: 0.8972; val_best_f1_score: 0.9426; train_kl_reg_loss: 37973.4811; train_edge_recon_loss: 890885.8570; train_gene_expr_recon_loss: 897787.2858; train_masked_gp_l1_reg_loss: 18814.4473; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1845461.0663; train_optim_loss: 1845461.0663; val_kl_reg_loss: 35207.6522; val_edge_recon_loss: 894695.6432; val_gene_expr_recon_loss: 887005.3203; val_masked_gp_l1_reg_loss: 18781.0977; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1835689.7292; val_optim_loss: 1835689.7292
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8700; val_auprc_score: 0.9715; val_best_acc_score: 0.9026; val_best_f1_score: 0.9451; train_kl_reg_loss: 32657.6497; train_edge_recon_loss: 864979.2596; train_gene_expr_recon_loss: 880163.6642; train_masked_gp_l1_reg_loss: 18666.1013; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1796466.6738; train_optim_loss: 1796466.6738; val_kl_reg_loss: 29349.3753; val_edge_recon_loss: 855882.3932; val_gene_expr_recon_loss: 869557.5443; val_masked_gp_l1_reg_loss: 18519.6035; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1773308.9271; val_optim_loss: 1773308.9271
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8904; val_auprc_score: 0.9755; val_best_acc_score: 0.9060; val_best_f1_score: 0.9472; train_kl_reg_loss: 26782.9846; train_edge_recon_loss: 843371.4183; train_gene_expr_recon_loss: 864507.2744; train_masked_gp_l1_reg_loss: 18322.0241; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1752983.7029; train_optim_loss: 1752983.7029; val_kl_reg_loss: 23126.9465; val_edge_recon_loss: 830151.2318; val_gene_expr_recon_loss: 855166.9531; val_masked_gp_l1_reg_loss: 18094.9258; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1726540.0208; val_optim_loss: 1726540.0208
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9072; val_auprc_score: 0.9778; val_best_acc_score: 0.9216; val_best_f1_score: 0.9551; train_kl_reg_loss: 21852.9473; train_edge_recon_loss: 818866.1933; train_gene_expr_recon_loss: 849719.3509; train_masked_gp_l1_reg_loss: 17796.1736; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1708234.6645; train_optim_loss: 1708234.6645; val_kl_reg_loss: 20177.6032; val_edge_recon_loss: 841473.4896; val_gene_expr_recon_loss: 841209.7734; val_masked_gp_l1_reg_loss: 17456.5215; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1720317.3854; val_optim_loss: 1720317.3854
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9196; val_auprc_score: 0.9813; val_best_acc_score: 0.9258; val_best_f1_score: 0.9576; train_kl_reg_loss: 19080.0623; train_edge_recon_loss: 804848.7480; train_gene_expr_recon_loss: 834887.8142; train_masked_gp_l1_reg_loss: 17029.1053; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1675845.7314; train_optim_loss: 1675845.7314; val_kl_reg_loss: 18208.9709; val_edge_recon_loss: 805119.1953; val_gene_expr_recon_loss: 827458.7266; val_masked_gp_l1_reg_loss: 16561.7676; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1667348.6458; val_optim_loss: 1667348.6458
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9209; val_auprc_score: 0.9819; val_best_acc_score: 0.9231; val_best_f1_score: 0.9559; train_kl_reg_loss: 16799.0850; train_edge_recon_loss: 799728.4686; train_gene_expr_recon_loss: 822406.9753; train_masked_gp_l1_reg_loss: 16098.4515; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1655032.9791; train_optim_loss: 1655032.9791; val_kl_reg_loss: 14698.5764; val_edge_recon_loss: 825758.2370; val_gene_expr_recon_loss: 814980.4583; val_masked_gp_l1_reg_loss: 15642.9385; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1671080.2760; val_optim_loss: 1671080.2760
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9251; val_auprc_score: 0.9830; val_best_acc_score: 0.9259; val_best_f1_score: 0.9575; train_kl_reg_loss: 14195.5033; train_edge_recon_loss: 799792.3157; train_gene_expr_recon_loss: 810753.3965; train_masked_gp_l1_reg_loss: 15238.0736; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1639979.2901; train_optim_loss: 1639979.2901; val_kl_reg_loss: 12897.1897; val_edge_recon_loss: 813445.5990; val_gene_expr_recon_loss: 803892.9974; val_masked_gp_l1_reg_loss: 14829.3086; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1645065.0469; val_optim_loss: 1645065.0469
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9255; val_auprc_score: 0.9831; val_best_acc_score: 0.9217; val_best_f1_score: 0.9550; train_kl_reg_loss: 13065.1065; train_edge_recon_loss: 786595.7445; train_gene_expr_recon_loss: 800594.8698; train_masked_gp_l1_reg_loss: 14428.1211; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1614683.8413; train_optim_loss: 1614683.8413; val_kl_reg_loss: 12746.9472; val_edge_recon_loss: 838702.0469; val_gene_expr_recon_loss: 793729.5573; val_masked_gp_l1_reg_loss: 14035.3828; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1659213.9219; val_optim_loss: 1659213.9219
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9273; val_auprc_score: 0.9840; val_best_acc_score: 0.9232; val_best_f1_score: 0.9557; train_kl_reg_loss: 12460.5258; train_edge_recon_loss: 790067.5660; train_gene_expr_recon_loss: 790837.5270; train_masked_gp_l1_reg_loss: 13663.3230; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1607028.9535; train_optim_loss: 1607028.9535; val_kl_reg_loss: 13273.3145; val_edge_recon_loss: 792623.7188; val_gene_expr_recon_loss: 785027.2500; val_masked_gp_l1_reg_loss: 13307.8887; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1604232.1510; val_optim_loss: 1604232.1510
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9353; val_auprc_score: 0.9851; val_best_acc_score: 0.9272; val_best_f1_score: 0.9582; train_kl_reg_loss: 11456.7946; train_edge_recon_loss: 785153.3884; train_gene_expr_recon_loss: 782711.2651; train_masked_gp_l1_reg_loss: 12987.7691; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1592309.2227; train_optim_loss: 1592309.2227; val_kl_reg_loss: 11054.7598; val_edge_recon_loss: 791449.7370; val_gene_expr_recon_loss: 777505.3411; val_masked_gp_l1_reg_loss: 12651.3027; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1592661.0938; val_optim_loss: 1592661.0938
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9422; val_auprc_score: 0.9866; val_best_acc_score: 0.9343; val_best_f1_score: 0.9620; train_kl_reg_loss: 11102.2163; train_edge_recon_loss: 780080.3108; train_gene_expr_recon_loss: 774822.7020; train_masked_gp_l1_reg_loss: 12330.4148; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1578335.6430; train_optim_loss: 1578335.6430; val_kl_reg_loss: 10651.8804; val_edge_recon_loss: 799106.2083; val_gene_expr_recon_loss: 768921.7812; val_masked_gp_l1_reg_loss: 11984.7471; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1590664.6198; val_optim_loss: 1590664.6198
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9466; val_auprc_score: 0.9877; val_best_acc_score: 0.9362; val_best_f1_score: 0.9632; train_kl_reg_loss: 10963.7980; train_edge_recon_loss: 781306.7936; train_gene_expr_recon_loss: 767629.9302; train_masked_gp_l1_reg_loss: 11679.1730; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1571579.6948; train_optim_loss: 1571579.6948; val_kl_reg_loss: 10885.4204; val_edge_recon_loss: 776006.1042; val_gene_expr_recon_loss: 762617.5729; val_masked_gp_l1_reg_loss: 11365.6719; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1560874.7344; val_optim_loss: 1560874.7344
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9488; val_auprc_score: 0.9881; val_best_acc_score: 0.9335; val_best_f1_score: 0.9612; train_kl_reg_loss: 11042.1983; train_edge_recon_loss: 783465.0515; train_gene_expr_recon_loss: 760915.8785; train_masked_gp_l1_reg_loss: 11042.5700; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1566465.6959; train_optim_loss: 1566465.6959; val_kl_reg_loss: 10818.2931; val_edge_recon_loss: 831929.9635; val_gene_expr_recon_loss: 756109.9844; val_masked_gp_l1_reg_loss: 10778.5498; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1609636.7500; val_optim_loss: 1609636.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9452; val_auprc_score: 0.9872; val_best_acc_score: 0.9391; val_best_f1_score: 0.9648; train_kl_reg_loss: 11041.5266; train_edge_recon_loss: 775417.8788; train_gene_expr_recon_loss: 755172.8698; train_masked_gp_l1_reg_loss: 10493.8436; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1552126.1180; train_optim_loss: 1552126.1180; val_kl_reg_loss: 10685.4134; val_edge_recon_loss: 797511.2891; val_gene_expr_recon_loss: 751455.2344; val_masked_gp_l1_reg_loss: 10215.2031; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1569867.2031; val_optim_loss: 1569867.2031
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9506; val_auprc_score: 0.9887; val_best_acc_score: 0.9404; val_best_f1_score: 0.9654; train_kl_reg_loss: 11211.3061; train_edge_recon_loss: 764074.4820; train_gene_expr_recon_loss: 750148.9427; train_masked_gp_l1_reg_loss: 9990.9018; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1535425.6256; train_optim_loss: 1535425.6256; val_kl_reg_loss: 11038.2938; val_edge_recon_loss: 788669.2109; val_gene_expr_recon_loss: 744688.1406; val_masked_gp_l1_reg_loss: 9787.2607; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1554182.8854; val_optim_loss: 1554182.8854
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9500; val_auprc_score: 0.9885; val_best_acc_score: 0.9428; val_best_f1_score: 0.9668; train_kl_reg_loss: 11079.3958; train_edge_recon_loss: 772382.4096; train_gene_expr_recon_loss: 745061.1657; train_masked_gp_l1_reg_loss: 9587.5759; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1538110.5494; train_optim_loss: 1538110.5494; val_kl_reg_loss: 10449.5854; val_edge_recon_loss: 788821.9193; val_gene_expr_recon_loss: 741185.1536; val_masked_gp_l1_reg_loss: 9394.5713; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1549851.2760; val_optim_loss: 1549851.2760
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9484; val_auprc_score: 0.9868; val_best_acc_score: 0.9453; val_best_f1_score: 0.9682; train_kl_reg_loss: 10940.6248; train_edge_recon_loss: 771835.9733; train_gene_expr_recon_loss: 740567.9890; train_masked_gp_l1_reg_loss: 9200.3781; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1532544.9622; train_optim_loss: 1532544.9622; val_kl_reg_loss: 10666.7930; val_edge_recon_loss: 774425.5443; val_gene_expr_recon_loss: 736407.6042; val_masked_gp_l1_reg_loss: 9004.7744; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1530504.6927; val_optim_loss: 1530504.6927
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9545; val_auprc_score: 0.9895; val_best_acc_score: 0.9448; val_best_f1_score: 0.9682; train_kl_reg_loss: 10930.3486; train_edge_recon_loss: 772861.5541; train_gene_expr_recon_loss: 736444.6346; train_masked_gp_l1_reg_loss: 8861.5588; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1529098.0924; train_optim_loss: 1529098.0924; val_kl_reg_loss: 10657.2711; val_edge_recon_loss: 768017.3438; val_gene_expr_recon_loss: 733437.6615; val_masked_gp_l1_reg_loss: 8747.4062; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1520859.6562; val_optim_loss: 1520859.6562
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9496; val_auprc_score: 0.9868; val_best_acc_score: 0.9426; val_best_f1_score: 0.9666; train_kl_reg_loss: 9494.8883; train_edge_recon_loss: 765568.4834; train_gene_expr_recon_loss: 739877.1456; train_masked_gp_l1_reg_loss: 8717.3222; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1523657.8378; train_optim_loss: 1523657.8378; val_kl_reg_loss: 5870.6573; val_edge_recon_loss: 795865.5833; val_gene_expr_recon_loss: 735326.2891; val_masked_gp_l1_reg_loss: 8605.4844; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1545668.0156; val_optim_loss: 1545668.0156
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9589; val_auprc_score: 0.9909; val_best_acc_score: 0.9486; val_best_f1_score: 0.9703; train_kl_reg_loss: 8745.3322; train_edge_recon_loss: 764742.1090; train_gene_expr_recon_loss: 735659.7654; train_masked_gp_l1_reg_loss: 8488.7508; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1517635.9599; train_optim_loss: 1517635.9599; val_kl_reg_loss: 5610.1766; val_edge_recon_loss: 777275.7839; val_gene_expr_recon_loss: 731612.6198; val_masked_gp_l1_reg_loss: 8382.6680; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1522881.2188; val_optim_loss: 1522881.2188
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9560; val_auprc_score: 0.9900; val_best_acc_score: 0.9463; val_best_f1_score: 0.9690; train_kl_reg_loss: 8413.6910; train_edge_recon_loss: 769512.1610; train_gene_expr_recon_loss: 732519.5811; train_masked_gp_l1_reg_loss: 8321.8267; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1518767.2640; train_optim_loss: 1518767.2640; val_kl_reg_loss: 5558.2914; val_edge_recon_loss: 782628.3646; val_gene_expr_recon_loss: 729006.4089; val_masked_gp_l1_reg_loss: 8246.1182; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1525439.1927; val_optim_loss: 1525439.1927
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9600; val_auprc_score: 0.9906; val_best_acc_score: 0.9509; val_best_f1_score: 0.9714; train_kl_reg_loss: 8121.4848; train_edge_recon_loss: 773904.5797; train_gene_expr_recon_loss: 729393.5218; train_masked_gp_l1_reg_loss: 8156.3383; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1519575.9203; train_optim_loss: 1519575.9203; val_kl_reg_loss: 5518.8364; val_edge_recon_loss: 789367.7135; val_gene_expr_recon_loss: 726535.4557; val_masked_gp_l1_reg_loss: 8030.8438; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1529452.8802; val_optim_loss: 1529452.8802

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9605; val_auprc_score: 0.9907; val_best_acc_score: 0.9506; val_best_f1_score: 0.9714; train_kl_reg_loss: 8044.3528; train_edge_recon_loss: 767614.8003; train_gene_expr_recon_loss: 726722.7093; train_masked_gp_l1_reg_loss: 7978.0182; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1510359.8767; train_optim_loss: 1510359.8767; val_kl_reg_loss: 5611.5896; val_edge_recon_loss: 768902.4635; val_gene_expr_recon_loss: 724147.2891; val_masked_gp_l1_reg_loss: 7968.0264; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1506629.3385; val_optim_loss: 1506629.3385
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9557; val_auprc_score: 0.9898; val_best_acc_score: 0.9493; val_best_f1_score: 0.9707; train_kl_reg_loss: 8002.9961; train_edge_recon_loss: 763739.6657; train_gene_expr_recon_loss: 726273.5174; train_masked_gp_l1_reg_loss: 7965.1641; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505981.3471; train_optim_loss: 1505981.3471; val_kl_reg_loss: 5583.9309; val_edge_recon_loss: 776209.9896; val_gene_expr_recon_loss: 724495.0312; val_masked_gp_l1_reg_loss: 7963.1387; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1514252.0885; val_optim_loss: 1514252.0885
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9567; val_auprc_score: 0.9902; val_best_acc_score: 0.9513; val_best_f1_score: 0.9719; train_kl_reg_loss: 7977.5961; train_edge_recon_loss: 761908.7328; train_gene_expr_recon_loss: 725795.7209; train_masked_gp_l1_reg_loss: 7957.0776; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1503639.1343; train_optim_loss: 1503639.1343; val_kl_reg_loss: 5453.1905; val_edge_recon_loss: 755704.7500; val_gene_expr_recon_loss: 723506.8750; val_masked_gp_l1_reg_loss: 7959.4097; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1492624.1927; val_optim_loss: 1492624.1927
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9528; val_auprc_score: 0.9886; val_best_acc_score: 0.9508; val_best_f1_score: 0.9715; train_kl_reg_loss: 7856.7839; train_edge_recon_loss: 765551.0709; train_gene_expr_recon_loss: 725639.2398; train_masked_gp_l1_reg_loss: 7956.9977; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1507004.0971; train_optim_loss: 1507004.0971; val_kl_reg_loss: 5504.6530; val_edge_recon_loss: 781651.8620; val_gene_expr_recon_loss: 723533.5521; val_masked_gp_l1_reg_loss: 7960.7173; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1518650.8177; val_optim_loss: 1518650.8177
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9553; val_auprc_score: 0.9892; val_best_acc_score: 0.9481; val_best_f1_score: 0.9700; train_kl_reg_loss: 7832.5788; train_edge_recon_loss: 773755.3390; train_gene_expr_recon_loss: 725313.0483; train_masked_gp_l1_reg_loss: 7958.0426; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1514859.0058; train_optim_loss: 1514859.0058; val_kl_reg_loss: 5448.1210; val_edge_recon_loss: 787914.2708; val_gene_expr_recon_loss: 723663.9479; val_masked_gp_l1_reg_loss: 7961.7441; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1524988.0990; val_optim_loss: 1524988.0990
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9628; val_auprc_score: 0.9914; val_best_acc_score: 0.9508; val_best_f1_score: 0.9714; train_kl_reg_loss: 7721.2526; train_edge_recon_loss: 762340.2956; train_gene_expr_recon_loss: 725462.8387; train_masked_gp_l1_reg_loss: 7956.0521; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1503480.4407; train_optim_loss: 1503480.4407; val_kl_reg_loss: 5557.0302; val_edge_recon_loss: 783674.9323; val_gene_expr_recon_loss: 722706.6198; val_masked_gp_l1_reg_loss: 7957.8232; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1519896.4531; val_optim_loss: 1519896.4531
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9585; val_auprc_score: 0.9905; val_best_acc_score: 0.9518; val_best_f1_score: 0.9720; train_kl_reg_loss: 7635.9616; train_edge_recon_loss: 772611.0215; train_gene_expr_recon_loss: 724792.4535; train_masked_gp_l1_reg_loss: 7950.0674; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1512989.5076; train_optim_loss: 1512989.5076; val_kl_reg_loss: 5499.5855; val_edge_recon_loss: 787298.2630; val_gene_expr_recon_loss: 723161.3281; val_masked_gp_l1_reg_loss: 7946.1084; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1523905.3021; val_optim_loss: 1523905.3021

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9592; val_auprc_score: 0.9900; val_best_acc_score: 0.9518; val_best_f1_score: 0.9720; train_kl_reg_loss: 7620.1846; train_edge_recon_loss: 765414.1637; train_gene_expr_recon_loss: 724318.7759; train_masked_gp_l1_reg_loss: 7937.7764; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1505290.8977; train_optim_loss: 1505290.8977; val_kl_reg_loss: 5462.0985; val_edge_recon_loss: 778351.4818; val_gene_expr_recon_loss: 722238.0469; val_masked_gp_l1_reg_loss: 7935.3687; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1513986.9844; val_optim_loss: 1513986.9844
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9548; val_auprc_score: 0.9888; val_best_acc_score: 0.9500; val_best_f1_score: 0.9710; train_kl_reg_loss: 7593.9080; train_edge_recon_loss: 751529.4352; train_gene_expr_recon_loss: 723986.6953; train_masked_gp_l1_reg_loss: 7934.5721; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1491044.6134; train_optim_loss: 1491044.6134; val_kl_reg_loss: 5457.8500; val_edge_recon_loss: 796575.8776; val_gene_expr_recon_loss: 723186.7682; val_masked_gp_l1_reg_loss: 7933.9917; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1533154.5052; val_optim_loss: 1533154.5052
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9629; val_auprc_score: 0.9918; val_best_acc_score: 0.9520; val_best_f1_score: 0.9722; train_kl_reg_loss: 7577.7196; train_edge_recon_loss: 765256.1169; train_gene_expr_recon_loss: 724035.4535; train_masked_gp_l1_reg_loss: 7933.0730; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1504802.3593; train_optim_loss: 1504802.3593; val_kl_reg_loss: 5457.8983; val_edge_recon_loss: 767169.5729; val_gene_expr_recon_loss: 722353.2760; val_masked_gp_l1_reg_loss: 7931.9004; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1502912.6250; val_optim_loss: 1502912.6250
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9576; val_auprc_score: 0.9898; val_best_acc_score: 0.9490; val_best_f1_score: 0.9705; train_kl_reg_loss: 7570.8989; train_edge_recon_loss: 770106.4625; train_gene_expr_recon_loss: 724342.2910; train_masked_gp_l1_reg_loss: 7931.0024; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1509950.6517; train_optim_loss: 1509950.6517; val_kl_reg_loss: 5445.2932; val_edge_recon_loss: 783244.7161; val_gene_expr_recon_loss: 721799.9323; val_masked_gp_l1_reg_loss: 7930.0674; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1518420.0677; val_optim_loss: 1518420.0677

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 56 min 13 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9566
Val AUPRC score: 0.9894
Val best accuracy score: 0.9485
Val best F1 score: 0.9702
Val gene expr MSE score: 43914.8313
Val cat covariate0 mean sim diff: -0.0062

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
