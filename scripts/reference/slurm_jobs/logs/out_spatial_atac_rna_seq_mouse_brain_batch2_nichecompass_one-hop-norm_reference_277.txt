[True]
Run timestamp: 07092023_053807_277.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_277']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23411 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 27040, n_cat_covariates_embed_input: 0, n_hidden: 2386, n_latent: 2286, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 23411
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 23411

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7660; val_auprc_score: 0.7921; val_best_acc_score: 0.6213; val_best_f1_score: 0.7050; train_kl_reg_loss: 114800.6033; train_edge_recon_loss: 3668151.5458; train_gene_expr_recon_loss: 15377029.9695; train_masked_gp_l1_reg_loss: 39379.5704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4628213.2295; train_chrom_access_recon_loss: 53503565.0382; train_global_loss: 77331140.1832; train_optim_loss: 77331140.1832; val_kl_reg_loss: 133980.6313; val_edge_recon_loss: 4057671.9167; val_gene_expr_recon_loss: 13952375.8667; val_masked_gp_l1_reg_loss: 34563.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 503868.4375; val_chrom_access_recon_loss: 50712074.6667; val_global_loss: 69394535.2000; val_optim_loss: 69394535.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8768; val_auprc_score: 0.8745; val_best_acc_score: 0.7864; val_best_f1_score: 0.7993; train_kl_reg_loss: 131943.8093; train_edge_recon_loss: 3530442.2939; train_gene_expr_recon_loss: 13932923.4885; train_masked_gp_l1_reg_loss: 33096.2800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 321748.7948; train_chrom_access_recon_loss: 51083864.0916; train_global_loss: 69034018.7176; train_optim_loss: 69034018.7176; val_kl_reg_loss: 107407.9641; val_edge_recon_loss: 3623951.2000; val_gene_expr_recon_loss: 13591160.1333; val_masked_gp_l1_reg_loss: 33635.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 228979.5000; val_chrom_access_recon_loss: 50042083.4667; val_global_loss: 67627218.4000; val_optim_loss: 67627218.4000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8651; val_auprc_score: 0.8565; val_best_acc_score: 0.7716; val_best_f1_score: 0.7937; train_kl_reg_loss: 135340.8968; train_edge_recon_loss: 3103570.3969; train_gene_expr_recon_loss: 13698815.4351; train_masked_gp_l1_reg_loss: 35316.2419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 198675.2869; train_chrom_access_recon_loss: 50374846.8092; train_global_loss: 67546565.2519; train_optim_loss: 67546565.2519; val_kl_reg_loss: 143971.6917; val_edge_recon_loss: 3020756.9500; val_gene_expr_recon_loss: 13405597.4000; val_masked_gp_l1_reg_loss: 36633.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178720.5469; val_chrom_access_recon_loss: 49374579.2000; val_global_loss: 66160258.4000; val_optim_loss: 66160258.4000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8782; val_auprc_score: 0.8676; val_best_acc_score: 0.7854; val_best_f1_score: 0.8066; train_kl_reg_loss: 142555.7734; train_edge_recon_loss: 2961132.7824; train_gene_expr_recon_loss: 13544113.8550; train_masked_gp_l1_reg_loss: 37841.1801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167504.0395; train_chrom_access_recon_loss: 49917396.5802; train_global_loss: 66770544.2748; train_optim_loss: 66770544.2748; val_kl_reg_loss: 135311.7880; val_edge_recon_loss: 2972985.1000; val_gene_expr_recon_loss: 13272296.6667; val_masked_gp_l1_reg_loss: 38992.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159413.9531; val_chrom_access_recon_loss: 48985958.6667; val_global_loss: 65564958.9333; val_optim_loss: 65564958.9333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8970; val_auprc_score: 0.8801; val_best_acc_score: 0.8164; val_best_f1_score: 0.8327; train_kl_reg_loss: 131530.1954; train_edge_recon_loss: 2925735.3187; train_gene_expr_recon_loss: 13414641.4885; train_masked_gp_l1_reg_loss: 39953.9446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152985.4208; train_chrom_access_recon_loss: 49500559.2977; train_global_loss: 66165405.5573; train_optim_loss: 66165405.5573; val_kl_reg_loss: 129227.2026; val_edge_recon_loss: 2912532.4833; val_gene_expr_recon_loss: 13182401.6000; val_masked_gp_l1_reg_loss: 41084.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147927.8906; val_chrom_access_recon_loss: 48718433.0667; val_global_loss: 65131606.4000; val_optim_loss: 65131606.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9157; val_auprc_score: 0.9005; val_best_acc_score: 0.8390; val_best_f1_score: 0.8510; train_kl_reg_loss: 125414.3288; train_edge_recon_loss: 2892027.9618; train_gene_expr_recon_loss: 13300289.3511; train_masked_gp_l1_reg_loss: 41935.2906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143971.3581; train_chrom_access_recon_loss: 49040969.5573; train_global_loss: 65544607.9695; train_optim_loss: 65544607.9695; val_kl_reg_loss: 120590.5323; val_edge_recon_loss: 2875502.9667; val_gene_expr_recon_loss: 13023475.8000; val_masked_gp_l1_reg_loss: 42867.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140268.9844; val_chrom_access_recon_loss: 48245930.9333; val_global_loss: 64448637.3333; val_optim_loss: 64448637.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9361; val_auprc_score: 0.9202; val_best_acc_score: 0.8694; val_best_f1_score: 0.8772; train_kl_reg_loss: 125681.3240; train_edge_recon_loss: 2844090.4466; train_gene_expr_recon_loss: 13201854.5496; train_masked_gp_l1_reg_loss: 43746.6330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137359.3292; train_chrom_access_recon_loss: 48716525.5267; train_global_loss: 65069257.7099; train_optim_loss: 65069257.7099; val_kl_reg_loss: 125314.9859; val_edge_recon_loss: 2805019.3000; val_gene_expr_recon_loss: 12944566.2000; val_masked_gp_l1_reg_loss: 44685.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134476.8906; val_chrom_access_recon_loss: 47856597.3333; val_global_loss: 63910659.4667; val_optim_loss: 63910659.4667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9394; val_auprc_score: 0.9257; val_best_acc_score: 0.8758; val_best_f1_score: 0.8830; train_kl_reg_loss: 125126.2115; train_edge_recon_loss: 2811149.3340; train_gene_expr_recon_loss: 13099423.7176; train_masked_gp_l1_reg_loss: 45503.7492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131977.8099; train_chrom_access_recon_loss: 48344461.9237; train_global_loss: 64557642.8397; train_optim_loss: 64557642.8397; val_kl_reg_loss: 129688.7672; val_edge_recon_loss: 2807067.1833; val_gene_expr_recon_loss: 12898640.6667; val_masked_gp_l1_reg_loss: 46351.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129831.2969; val_chrom_access_recon_loss: 47836817.8667; val_global_loss: 63848397.6000; val_optim_loss: 63848397.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9402; val_auprc_score: 0.9235; val_best_acc_score: 0.8785; val_best_f1_score: 0.8852; train_kl_reg_loss: 125101.5823; train_edge_recon_loss: 2783578.6679; train_gene_expr_recon_loss: 13020199.2672; train_masked_gp_l1_reg_loss: 47104.2153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128057.3133; train_chrom_access_recon_loss: 48061374.9618; train_global_loss: 64165416.0000; train_optim_loss: 64165416.0000; val_kl_reg_loss: 121044.6630; val_edge_recon_loss: 2794439.6167; val_gene_expr_recon_loss: 12771516.2000; val_masked_gp_l1_reg_loss: 47866.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126253.1094; val_chrom_access_recon_loss: 47206773.3333; val_global_loss: 63067893.8667; val_optim_loss: 63067893.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9390; val_auprc_score: 0.9218; val_best_acc_score: 0.8781; val_best_f1_score: 0.8852; train_kl_reg_loss: 122379.4727; train_edge_recon_loss: 2779930.9122; train_gene_expr_recon_loss: 12953193.4885; train_masked_gp_l1_reg_loss: 48571.8800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124582.6313; train_chrom_access_recon_loss: 47750089.8626; train_global_loss: 63778748.2748; train_optim_loss: 63778748.2748; val_kl_reg_loss: 112478.7198; val_edge_recon_loss: 2794772.1167; val_gene_expr_recon_loss: 12750499.0667; val_masked_gp_l1_reg_loss: 49398.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123495.3828; val_chrom_access_recon_loss: 46971141.3333; val_global_loss: 62801784.0000; val_optim_loss: 62801784.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9458; val_auprc_score: 0.9322; val_best_acc_score: 0.8837; val_best_f1_score: 0.8916; train_kl_reg_loss: 117895.2173; train_edge_recon_loss: 2769730.4370; train_gene_expr_recon_loss: 12889087.4122; train_masked_gp_l1_reg_loss: 50036.5316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121772.1469; train_chrom_access_recon_loss: 47480146.1679; train_global_loss: 63428667.7252; train_optim_loss: 63428667.7252; val_kl_reg_loss: 116461.0760; val_edge_recon_loss: 2792622.6833; val_gene_expr_recon_loss: 12685460.2000; val_masked_gp_l1_reg_loss: 50707.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120315.9219; val_chrom_access_recon_loss: 46898496.0000; val_global_loss: 62664062.6667; val_optim_loss: 62664062.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9473; val_auprc_score: 0.9334; val_best_acc_score: 0.8884; val_best_f1_score: 0.8958; train_kl_reg_loss: 116727.2081; train_edge_recon_loss: 2761812.9943; train_gene_expr_recon_loss: 12825700.9771; train_masked_gp_l1_reg_loss: 51290.8660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119429.3238; train_chrom_access_recon_loss: 47182640.6718; train_global_loss: 63057602.1985; train_optim_loss: 63057602.1985; val_kl_reg_loss: 118185.0047; val_edge_recon_loss: 2773095.4000; val_gene_expr_recon_loss: 12701021.6000; val_masked_gp_l1_reg_loss: 51880.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118345.2891; val_chrom_access_recon_loss: 46774277.6000; val_global_loss: 62536804.8000; val_optim_loss: 62536804.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9507; val_auprc_score: 0.9390; val_best_acc_score: 0.8913; val_best_f1_score: 0.8975; train_kl_reg_loss: 114448.3686; train_edge_recon_loss: 2751516.1622; train_gene_expr_recon_loss: 12773863.4656; train_masked_gp_l1_reg_loss: 52500.8538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117960.1748; train_chrom_access_recon_loss: 46941527.0534; train_global_loss: 62751816.0611; train_optim_loss: 62751816.0611; val_kl_reg_loss: 114600.3536; val_edge_recon_loss: 2776372.2167; val_gene_expr_recon_loss: 12616835.8000; val_masked_gp_l1_reg_loss: 53033.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117479.1953; val_chrom_access_recon_loss: 46527785.0667; val_global_loss: 62206105.3333; val_optim_loss: 62206105.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9563; val_auprc_score: 0.9435; val_best_acc_score: 0.8972; val_best_f1_score: 0.9022; train_kl_reg_loss: 111713.5522; train_edge_recon_loss: 2753201.6355; train_gene_expr_recon_loss: 12720033.6641; train_masked_gp_l1_reg_loss: 53553.9387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116692.4111; train_chrom_access_recon_loss: 46683565.7099; train_global_loss: 62438760.7939; train_optim_loss: 62438760.7939; val_kl_reg_loss: 109571.0859; val_edge_recon_loss: 2782912.0833; val_gene_expr_recon_loss: 12541968.8000; val_masked_gp_l1_reg_loss: 54050.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116322.4531; val_chrom_access_recon_loss: 46230575.2000; val_global_loss: 61835399.4667; val_optim_loss: 61835399.4667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9609; val_auprc_score: 0.9494; val_best_acc_score: 0.9074; val_best_f1_score: 0.9122; train_kl_reg_loss: 109119.8092; train_edge_recon_loss: 2742241.2882; train_gene_expr_recon_loss: 12674813.5954; train_masked_gp_l1_reg_loss: 54594.3978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115647.4416; train_chrom_access_recon_loss: 46409366.3206; train_global_loss: 62105782.7481; train_optim_loss: 62105782.7481; val_kl_reg_loss: 107445.1719; val_edge_recon_loss: 2751415.7000; val_gene_expr_recon_loss: 12497359.4667; val_masked_gp_l1_reg_loss: 55048.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115641.0078; val_chrom_access_recon_loss: 46132500.5333; val_global_loss: 61659410.4000; val_optim_loss: 61659410.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9579; val_auprc_score: 0.9458; val_best_acc_score: 0.9050; val_best_f1_score: 0.9100; train_kl_reg_loss: 107542.4819; train_edge_recon_loss: 2742399.6584; train_gene_expr_recon_loss: 12648721.1908; train_masked_gp_l1_reg_loss: 55573.8369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114689.4889; train_chrom_access_recon_loss: 46235288.7634; train_global_loss: 61904215.6031; train_optim_loss: 61904215.6031; val_kl_reg_loss: 105203.3771; val_edge_recon_loss: 2755902.1833; val_gene_expr_recon_loss: 12417067.0667; val_masked_gp_l1_reg_loss: 56156.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114632.7734; val_chrom_access_recon_loss: 45532081.3333; val_global_loss: 60981042.6667; val_optim_loss: 60981042.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9597; val_auprc_score: 0.9490; val_best_acc_score: 0.9016; val_best_f1_score: 0.9073; train_kl_reg_loss: 106232.8640; train_edge_recon_loss: 2737019.8683; train_gene_expr_recon_loss: 12601534.8855; train_masked_gp_l1_reg_loss: 56505.3379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114084.6981; train_chrom_access_recon_loss: 45987219.1450; train_global_loss: 61602596.6412; train_optim_loss: 61602596.6412; val_kl_reg_loss: 102619.9443; val_edge_recon_loss: 2759027.9333; val_gene_expr_recon_loss: 12379404.1333; val_masked_gp_l1_reg_loss: 56966.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114474.2422; val_chrom_access_recon_loss: 45429890.1333; val_global_loss: 60842382.9333; val_optim_loss: 60842382.9333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9603; val_auprc_score: 0.9507; val_best_acc_score: 0.9026; val_best_f1_score: 0.9070; train_kl_reg_loss: 98305.9831; train_edge_recon_loss: 2748857.4752; train_gene_expr_recon_loss: 12588832.4580; train_masked_gp_l1_reg_loss: 57438.4363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114750.5889; train_chrom_access_recon_loss: 45945564.6718; train_global_loss: 61553749.6183; train_optim_loss: 61553749.6183; val_kl_reg_loss: 96265.8068; val_edge_recon_loss: 2766105.8000; val_gene_expr_recon_loss: 12382297.0000; val_masked_gp_l1_reg_loss: 57955.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118901.1016; val_chrom_access_recon_loss: 45472220.0000; val_global_loss: 60893746.1333; val_optim_loss: 60893746.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9571; val_auprc_score: 0.9491; val_best_acc_score: 0.8941; val_best_f1_score: 0.8989; train_kl_reg_loss: 150370.7717; train_edge_recon_loss: 2765741.5916; train_gene_expr_recon_loss: 12653199.7023; train_masked_gp_l1_reg_loss: 59658.3930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120870.7243; train_chrom_access_recon_loss: 46246804.7328; train_global_loss: 61996645.8321; train_optim_loss: 61996645.8321; val_kl_reg_loss: 91876.3833; val_edge_recon_loss: 2775800.9500; val_gene_expr_recon_loss: 12390959.6000; val_masked_gp_l1_reg_loss: 61125.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124485.2500; val_chrom_access_recon_loss: 45535751.2000; val_global_loss: 60979998.9333; val_optim_loss: 60979998.9333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9505; val_auprc_score: 0.9394; val_best_acc_score: 0.8918; val_best_f1_score: 0.8979; train_kl_reg_loss: 4599181.4265; train_edge_recon_loss: 2788537.2805; train_gene_expr_recon_loss: 12658329.3664; train_masked_gp_l1_reg_loss: 64751.7388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121086.7564; train_chrom_access_recon_loss: 46230005.8931; train_global_loss: 66461892.9466; train_optim_loss: 66461892.9466; val_kl_reg_loss: 115006.3693; val_edge_recon_loss: 2773863.0167; val_gene_expr_recon_loss: 12437034.6667; val_masked_gp_l1_reg_loss: 65242.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119030.5312; val_chrom_access_recon_loss: 45431947.7333; val_global_loss: 60942124.8000; val_optim_loss: 60942124.8000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9509; val_auprc_score: 0.9403; val_best_acc_score: 0.8879; val_best_f1_score: 0.8953; train_kl_reg_loss: 115797.3380; train_edge_recon_loss: 2780566.9618; train_gene_expr_recon_loss: 12622868.5191; train_masked_gp_l1_reg_loss: 66060.1494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123221.9945; train_chrom_access_recon_loss: 46209148.9160; train_global_loss: 61917663.6031; train_optim_loss: 61917663.6031; val_kl_reg_loss: 96510.0328; val_edge_recon_loss: 2819852.4167; val_gene_expr_recon_loss: 12424302.6667; val_masked_gp_l1_reg_loss: 68310.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123590.7578; val_chrom_access_recon_loss: 45400515.7333; val_global_loss: 60933081.8667; val_optim_loss: 60933081.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9535; val_auprc_score: 0.9414; val_best_acc_score: 0.8918; val_best_f1_score: 0.8972; train_kl_reg_loss: 97685.7802; train_edge_recon_loss: 2790121.8359; train_gene_expr_recon_loss: 12569451.6260; train_masked_gp_l1_reg_loss: 66867.2919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91575.0110; train_chrom_access_recon_loss: 45789611.8779; train_global_loss: 61405313.5573; train_optim_loss: 61405313.5573; val_kl_reg_loss: 100213.6380; val_edge_recon_loss: 2793630.2333; val_gene_expr_recon_loss: 12396883.0667; val_masked_gp_l1_reg_loss: 65898.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88111.5000; val_chrom_access_recon_loss: 45381205.0667; val_global_loss: 60825941.3333; val_optim_loss: 60825941.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9503; val_auprc_score: 0.9379; val_best_acc_score: 0.8863; val_best_f1_score: 0.8928; train_kl_reg_loss: 101289.7557; train_edge_recon_loss: 2767333.3664; train_gene_expr_recon_loss: 12517397.5344; train_masked_gp_l1_reg_loss: 65400.0813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87173.1006; train_chrom_access_recon_loss: 45504979.5725; train_global_loss: 61043573.2519; train_optim_loss: 61043573.2519; val_kl_reg_loss: 104163.3151; val_edge_recon_loss: 2785645.1667; val_gene_expr_recon_loss: 12362464.4000; val_masked_gp_l1_reg_loss: 64975.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86335.5234; val_chrom_access_recon_loss: 45227819.7333; val_global_loss: 60631404.5333; val_optim_loss: 60631404.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9560; val_auprc_score: 0.9464; val_best_acc_score: 0.8968; val_best_f1_score: 0.9017; train_kl_reg_loss: 104530.0508; train_edge_recon_loss: 2754325.2939; train_gene_expr_recon_loss: 12512385.9237; train_masked_gp_l1_reg_loss: 64721.3696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85787.9980; train_chrom_access_recon_loss: 45521268.4275; train_global_loss: 61043019.1756; train_optim_loss: 61043019.1756; val_kl_reg_loss: 105692.4146; val_edge_recon_loss: 2764156.4167; val_gene_expr_recon_loss: 12267326.8667; val_masked_gp_l1_reg_loss: 64492.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85293.2891; val_chrom_access_recon_loss: 45023778.1333; val_global_loss: 60310740.0000; val_optim_loss: 60310740.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9517; val_auprc_score: 0.9388; val_best_acc_score: 0.8903; val_best_f1_score: 0.8961; train_kl_reg_loss: 107023.9907; train_edge_recon_loss: 2758979.8092; train_gene_expr_recon_loss: 12499214.7023; train_masked_gp_l1_reg_loss: 64315.8634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84617.1544; train_chrom_access_recon_loss: 45437150.0153; train_global_loss: 60951301.5878; train_optim_loss: 60951301.5878; val_kl_reg_loss: 107232.7094; val_edge_recon_loss: 2782857.0667; val_gene_expr_recon_loss: 12287102.6667; val_masked_gp_l1_reg_loss: 64138.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84126.1406; val_chrom_access_recon_loss: 44961832.5333; val_global_loss: 60287288.8000; val_optim_loss: 60287288.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9566; val_auprc_score: 0.9466; val_best_acc_score: 0.8934; val_best_f1_score: 0.8981; train_kl_reg_loss: 105403.6397; train_edge_recon_loss: 2770889.0992; train_gene_expr_recon_loss: 12290124.1756; train_masked_gp_l1_reg_loss: 63798.3811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83598.0704; train_chrom_access_recon_loss: 45398244.0305; train_global_loss: 60712057.3740; train_optim_loss: 60712057.3740; val_kl_reg_loss: 74332.2255; val_edge_recon_loss: 2784645.6667; val_gene_expr_recon_loss: 12090727.8000; val_masked_gp_l1_reg_loss: 63576.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83435.8984; val_chrom_access_recon_loss: 44654347.2000; val_global_loss: 59751065.8667; val_optim_loss: 59751065.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9514; val_auprc_score: 0.9338; val_best_acc_score: 0.8944; val_best_f1_score: 0.8994; train_kl_reg_loss: 108356.6302; train_edge_recon_loss: 2773467.0267; train_gene_expr_recon_loss: 12261329.5344; train_masked_gp_l1_reg_loss: 63394.3951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82768.4034; train_chrom_access_recon_loss: 45187485.1603; train_global_loss: 60476801.2214; train_optim_loss: 60476801.2214; val_kl_reg_loss: 76132.7531; val_edge_recon_loss: 2783975.1833; val_gene_expr_recon_loss: 12047742.0667; val_masked_gp_l1_reg_loss: 63210.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82206.5469; val_chrom_access_recon_loss: 44281986.1333; val_global_loss: 59335253.3333; val_optim_loss: 59335253.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9579; val_auprc_score: 0.9465; val_best_acc_score: 0.8969; val_best_f1_score: 0.9022; train_kl_reg_loss: 111063.9926; train_edge_recon_loss: 2763843.8340; train_gene_expr_recon_loss: 12245622.2443; train_masked_gp_l1_reg_loss: 63038.7062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81542.5720; train_chrom_access_recon_loss: 45110676.6412; train_global_loss: 60375788.0305; train_optim_loss: 60375788.0305; val_kl_reg_loss: 77431.0177; val_edge_recon_loss: 2761907.7000; val_gene_expr_recon_loss: 12097814.8667; val_masked_gp_l1_reg_loss: 62867.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80901.7031; val_chrom_access_recon_loss: 44987006.4000; val_global_loss: 60067930.4000; val_optim_loss: 60067930.4000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9570; val_auprc_score: 0.9445; val_best_acc_score: 0.9023; val_best_f1_score: 0.9066; train_kl_reg_loss: 113571.1708; train_edge_recon_loss: 2769109.9981; train_gene_expr_recon_loss: 12237462.8397; train_masked_gp_l1_reg_loss: 62709.5386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80352.5890; train_chrom_access_recon_loss: 45088767.6641; train_global_loss: 60351973.9542; train_optim_loss: 60351973.9542; val_kl_reg_loss: 77729.5833; val_edge_recon_loss: 2762892.8500; val_gene_expr_recon_loss: 12018982.6000; val_masked_gp_l1_reg_loss: 62546.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79848.4844; val_chrom_access_recon_loss: 44394624.8000; val_global_loss: 59396623.7333; val_optim_loss: 59396623.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9552; val_auprc_score: 0.9437; val_best_acc_score: 0.8967; val_best_f1_score: 0.9015; train_kl_reg_loss: 114130.7036; train_edge_recon_loss: 2765787.0725; train_gene_expr_recon_loss: 12255017.2061; train_masked_gp_l1_reg_loss: 62398.0335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79701.4130; train_chrom_access_recon_loss: 45325354.0153; train_global_loss: 60602388.2443; train_optim_loss: 60602388.2443; val_kl_reg_loss: 76386.8057; val_edge_recon_loss: 2775022.9000; val_gene_expr_recon_loss: 12034616.8000; val_masked_gp_l1_reg_loss: 62283.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81201.5547; val_chrom_access_recon_loss: 44837566.6667; val_global_loss: 59867078.1333; val_optim_loss: 59867078.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9562; val_auprc_score: 0.9442; val_best_acc_score: 0.8950; val_best_f1_score: 0.8999; train_kl_reg_loss: 116001.8099; train_edge_recon_loss: 2765396.3989; train_gene_expr_recon_loss: 12232763.1985; train_masked_gp_l1_reg_loss: 62127.0262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80527.3254; train_chrom_access_recon_loss: 45146039.0534; train_global_loss: 60402854.6565; train_optim_loss: 60402854.6565; val_kl_reg_loss: 79190.6729; val_edge_recon_loss: 2781316.4000; val_gene_expr_recon_loss: 12067094.0667; val_masked_gp_l1_reg_loss: 61962.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79164.8438; val_chrom_access_recon_loss: 44305292.5333; val_global_loss: 59374020.2667; val_optim_loss: 59374020.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9562; val_auprc_score: 0.9467; val_best_acc_score: 0.8948; val_best_f1_score: 0.8997; train_kl_reg_loss: 116852.9806; train_edge_recon_loss: 2751547.8034; train_gene_expr_recon_loss: 12215275.6260; train_masked_gp_l1_reg_loss: 61921.2518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76577.9224; train_chrom_access_recon_loss: 45029734.9008; train_global_loss: 60251910.5954; train_optim_loss: 60251910.5954; val_kl_reg_loss: 79118.0823; val_edge_recon_loss: 2783547.3167; val_gene_expr_recon_loss: 12050466.3333; val_masked_gp_l1_reg_loss: 61891.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76265.7812; val_chrom_access_recon_loss: 44425760.2667; val_global_loss: 59477050.1333; val_optim_loss: 59477050.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9574; val_auprc_score: 0.9489; val_best_acc_score: 0.8950; val_best_f1_score: 0.9007; train_kl_reg_loss: 116793.9359; train_edge_recon_loss: 2761321.0210; train_gene_expr_recon_loss: 12222652.6794; train_masked_gp_l1_reg_loss: 61868.8064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76164.8671; train_chrom_access_recon_loss: 45017196.3664; train_global_loss: 60255997.5878; train_optim_loss: 60255997.5878; val_kl_reg_loss: 79082.4005; val_edge_recon_loss: 2773572.2167; val_gene_expr_recon_loss: 12023964.2667; val_masked_gp_l1_reg_loss: 61845.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76055.3516; val_chrom_access_recon_loss: 44350438.4000; val_global_loss: 59364956.8000; val_optim_loss: 59364956.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9591; val_auprc_score: 0.9485; val_best_acc_score: 0.9022; val_best_f1_score: 0.9064; train_kl_reg_loss: 116849.2394; train_edge_recon_loss: 2762635.9847; train_gene_expr_recon_loss: 12210342.1679; train_masked_gp_l1_reg_loss: 61824.8316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75949.5636; train_chrom_access_recon_loss: 45003973.1908; train_global_loss: 60231574.9313; train_optim_loss: 60231574.9313; val_kl_reg_loss: 79544.6365; val_edge_recon_loss: 2759090.0333; val_gene_expr_recon_loss: 12021469.2667; val_masked_gp_l1_reg_loss: 61803.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75845.0547; val_chrom_access_recon_loss: 44413820.2667; val_global_loss: 59411572.2667; val_optim_loss: 59411572.2667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9584; val_auprc_score: 0.9493; val_best_acc_score: 0.9000; val_best_f1_score: 0.9047; train_kl_reg_loss: 117227.1360; train_edge_recon_loss: 2763817.7863; train_gene_expr_recon_loss: 12215954.3740; train_masked_gp_l1_reg_loss: 61782.1446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75736.1992; train_chrom_access_recon_loss: 45014188.5496; train_global_loss: 60248705.9847; train_optim_loss: 60248705.9847; val_kl_reg_loss: 79564.7698; val_edge_recon_loss: 2790314.5167; val_gene_expr_recon_loss: 12035865.7333; val_masked_gp_l1_reg_loss: 61760.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75641.5859; val_chrom_access_recon_loss: 44409520.5333; val_global_loss: 59452667.7333; val_optim_loss: 59452667.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 91 min 48 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
val AUROC score: 0.9560
val AUPRC score: 0.9452
val best accuracy score: 0.8959
val best F1 score: 0.9003
val target rna MSE score: 1.3530
val source rna MSE score: 0.5753
val target atac MSE score: 0.1250
val source atac MSE score: 0.0241
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
