[True]
Run timestamp: 10102023_000844_79.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_79']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6920; val_auprc_score: 0.6603; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 39139.3849; train_edge_recon_loss: 3503566.5227; train_gene_expr_recon_loss: 14041331.5909; train_masked_gp_l1_reg_loss: 45580.5291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5403258.5871; train_chrom_access_recon_loss: 6940088.6212; train_global_loss: 29972965.3939; train_optim_loss: 29972965.3939; val_kl_reg_loss: 143325.4404; val_edge_recon_loss: 4065275.0000; val_gene_expr_recon_loss: 13245627.7500; val_masked_gp_l1_reg_loss: 57264.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2410691.0000; val_chrom_access_recon_loss: 6784013.1875; val_global_loss: 26706197.0000; val_optim_loss: 26706197.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6984; val_auprc_score: 0.6666; val_best_acc_score: 0.6128; val_best_f1_score: 0.7085; train_kl_reg_loss: 79711.5613; train_edge_recon_loss: 3518687.3030; train_gene_expr_recon_loss: 12983212.5909; train_masked_gp_l1_reg_loss: 61579.7326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1095545.1080; train_chrom_access_recon_loss: 6633784.8864; train_global_loss: 24372521.1818; train_optim_loss: 24372521.1818; val_kl_reg_loss: 85387.4668; val_edge_recon_loss: 4058804.8438; val_gene_expr_recon_loss: 12738860.0000; val_masked_gp_l1_reg_loss: 62419.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 438759.7188; val_chrom_access_recon_loss: 6616233.1875; val_global_loss: 24000465.2500; val_optim_loss: 24000465.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7450; val_auprc_score: 0.7205; val_best_acc_score: 0.6760; val_best_f1_score: 0.7162; train_kl_reg_loss: 82582.7113; train_edge_recon_loss: 3508482.9053; train_gene_expr_recon_loss: 12745644.4091; train_masked_gp_l1_reg_loss: 62876.8668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 304161.9493; train_chrom_access_recon_loss: 6563393.0985; train_global_loss: 23267141.8182; train_optim_loss: 23267141.8182; val_kl_reg_loss: 76914.7334; val_edge_recon_loss: 4047058.7188; val_gene_expr_recon_loss: 12624992.3750; val_masked_gp_l1_reg_loss: 63643.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 223774.5312; val_chrom_access_recon_loss: 6564368.7500; val_global_loss: 23600752.0000; val_optim_loss: 23600752.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8199; val_auprc_score: 0.7963; val_best_acc_score: 0.7491; val_best_f1_score: 0.7693; train_kl_reg_loss: 72632.9111; train_edge_recon_loss: 3491439.1098; train_gene_expr_recon_loss: 12645476.8030; train_masked_gp_l1_reg_loss: 64627.1836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 190240.9209; train_chrom_access_recon_loss: 6518759.1288; train_global_loss: 22983175.9697; train_optim_loss: 22983175.9697; val_kl_reg_loss: 59401.3027; val_edge_recon_loss: 3835706.5000; val_gene_expr_recon_loss: 12539128.1250; val_masked_gp_l1_reg_loss: 65827.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166056.7969; val_chrom_access_recon_loss: 6576364.0000; val_global_loss: 23242483.7500; val_optim_loss: 23242483.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8496; val_auprc_score: 0.8186; val_best_acc_score: 0.7687; val_best_f1_score: 0.7923; train_kl_reg_loss: 75661.2705; train_edge_recon_loss: 3155682.0379; train_gene_expr_recon_loss: 12572068.5606; train_masked_gp_l1_reg_loss: 69753.4484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149574.4209; train_chrom_access_recon_loss: 6468689.7045; train_global_loss: 22491429.2121; train_optim_loss: 22491429.2121; val_kl_reg_loss: 73653.7168; val_edge_recon_loss: 3089593.9688; val_gene_expr_recon_loss: 12438535.6250; val_masked_gp_l1_reg_loss: 74926.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138030.6875; val_chrom_access_recon_loss: 6511037.6875; val_global_loss: 22325779.0000; val_optim_loss: 22325779.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8482; val_auprc_score: 0.8180; val_best_acc_score: 0.7773; val_best_f1_score: 0.8051; train_kl_reg_loss: 93687.1931; train_edge_recon_loss: 2929910.6061; train_gene_expr_recon_loss: 12494797.8788; train_masked_gp_l1_reg_loss: 77835.6954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131200.6845; train_chrom_access_recon_loss: 6436504.1061; train_global_loss: 22163936.0606; train_optim_loss: 22163936.0606; val_kl_reg_loss: 95664.7998; val_edge_recon_loss: 2961141.0000; val_gene_expr_recon_loss: 12230370.6250; val_masked_gp_l1_reg_loss: 79373.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124810.1719; val_chrom_access_recon_loss: 6356959.0000; val_global_loss: 21848319.5000; val_optim_loss: 21848319.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8762; val_auprc_score: 0.8395; val_best_acc_score: 0.8057; val_best_f1_score: 0.8257; train_kl_reg_loss: 97927.4373; train_edge_recon_loss: 2880292.5871; train_gene_expr_recon_loss: 12435151.8030; train_masked_gp_l1_reg_loss: 80672.1707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120695.4062; train_chrom_access_recon_loss: 6409409.0152; train_global_loss: 22024148.3333; train_optim_loss: 22024148.3333; val_kl_reg_loss: 103204.0596; val_edge_recon_loss: 2878338.7812; val_gene_expr_recon_loss: 12363087.1250; val_masked_gp_l1_reg_loss: 81808.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116970.0312; val_chrom_access_recon_loss: 6418679.0000; val_global_loss: 21962086.7500; val_optim_loss: 21962086.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8861; val_auprc_score: 0.8551; val_best_acc_score: 0.8192; val_best_f1_score: 0.8370; train_kl_reg_loss: 100502.5629; train_edge_recon_loss: 2833799.5871; train_gene_expr_recon_loss: 12348739.6515; train_masked_gp_l1_reg_loss: 82788.5185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113462.8280; train_chrom_access_recon_loss: 6371149.3030; train_global_loss: 21850442.5455; train_optim_loss: 21850442.5455; val_kl_reg_loss: 102081.1875; val_edge_recon_loss: 2882404.4375; val_gene_expr_recon_loss: 12314067.0000; val_masked_gp_l1_reg_loss: 83724.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110191.5078; val_chrom_access_recon_loss: 6428291.1875; val_global_loss: 21920760.5000; val_optim_loss: 21920760.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8941; val_auprc_score: 0.8515; val_best_acc_score: 0.8350; val_best_f1_score: 0.8479; train_kl_reg_loss: 100035.3803; train_edge_recon_loss: 2835386.9394; train_gene_expr_recon_loss: 12296938.8939; train_masked_gp_l1_reg_loss: 84420.8893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107781.3262; train_chrom_access_recon_loss: 6349154.1364; train_global_loss: 21773717.4545; train_optim_loss: 21773717.4545; val_kl_reg_loss: 100987.8154; val_edge_recon_loss: 2803537.5938; val_gene_expr_recon_loss: 12123362.2500; val_masked_gp_l1_reg_loss: 85203.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106226.4453; val_chrom_access_recon_loss: 6322731.6250; val_global_loss: 21542049.2500; val_optim_loss: 21542049.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9058; val_auprc_score: 0.8683; val_best_acc_score: 0.8439; val_best_f1_score: 0.8553; train_kl_reg_loss: 96931.9961; train_edge_recon_loss: 2810303.9735; train_gene_expr_recon_loss: 12251916.8788; train_masked_gp_l1_reg_loss: 85812.3253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105099.6622; train_chrom_access_recon_loss: 6330200.8561; train_global_loss: 21680265.8182; train_optim_loss: 21680265.8182; val_kl_reg_loss: 97670.9766; val_edge_recon_loss: 2846773.6562; val_gene_expr_recon_loss: 12144218.5000; val_masked_gp_l1_reg_loss: 86497.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104408.5781; val_chrom_access_recon_loss: 6394338.5000; val_global_loss: 21673907.7500; val_optim_loss: 21673907.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9005; val_auprc_score: 0.8639; val_best_acc_score: 0.8399; val_best_f1_score: 0.8551; train_kl_reg_loss: 96038.6986; train_edge_recon_loss: 2810391.3750; train_gene_expr_recon_loss: 12191016.1818; train_masked_gp_l1_reg_loss: 86933.9601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103300.9021; train_chrom_access_recon_loss: 6304865.3030; train_global_loss: 21592546.5152; train_optim_loss: 21592546.5152; val_kl_reg_loss: 100876.1709; val_edge_recon_loss: 2799766.6875; val_gene_expr_recon_loss: 12068942.7500; val_masked_gp_l1_reg_loss: 87533.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102598.9531; val_chrom_access_recon_loss: 6353144.8750; val_global_loss: 21512862.7500; val_optim_loss: 21512862.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9113; val_auprc_score: 0.8785; val_best_acc_score: 0.8544; val_best_f1_score: 0.8643; train_kl_reg_loss: 95482.3132; train_edge_recon_loss: 2798179.8485; train_gene_expr_recon_loss: 12147372.3485; train_masked_gp_l1_reg_loss: 87883.4205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101436.6754; train_chrom_access_recon_loss: 6283403.8485; train_global_loss: 21513758.4242; train_optim_loss: 21513758.4242; val_kl_reg_loss: 88563.1504; val_edge_recon_loss: 2800465.4688; val_gene_expr_recon_loss: 12015910.7500; val_masked_gp_l1_reg_loss: 88411.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101445.7812; val_chrom_access_recon_loss: 6269142.3125; val_global_loss: 21363939.2500; val_optim_loss: 21363939.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8999; val_auprc_score: 0.8693; val_best_acc_score: 0.8337; val_best_f1_score: 0.8482; train_kl_reg_loss: 92455.2844; train_edge_recon_loss: 2789912.8523; train_gene_expr_recon_loss: 12098074.4848; train_masked_gp_l1_reg_loss: 88837.2229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100018.3963; train_chrom_access_recon_loss: 6262507.0455; train_global_loss: 21431805.2727; train_optim_loss: 21431805.2727; val_kl_reg_loss: 90701.5176; val_edge_recon_loss: 2854767.6562; val_gene_expr_recon_loss: 11969722.7500; val_masked_gp_l1_reg_loss: 89118.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99609.9531; val_chrom_access_recon_loss: 6300105.8750; val_global_loss: 21404026.2500; val_optim_loss: 21404026.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9166; val_auprc_score: 0.8848; val_best_acc_score: 0.8552; val_best_f1_score: 0.8666; train_kl_reg_loss: 91185.5508; train_edge_recon_loss: 2790107.0227; train_gene_expr_recon_loss: 12069719.1667; train_masked_gp_l1_reg_loss: 89375.0656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98104.0998; train_chrom_access_recon_loss: 6246445.1667; train_global_loss: 21384936.1212; train_optim_loss: 21384936.1212; val_kl_reg_loss: 89080.4395; val_edge_recon_loss: 2794587.1562; val_gene_expr_recon_loss: 12033826.6250; val_masked_gp_l1_reg_loss: 89634.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96885.8828; val_chrom_access_recon_loss: 6256284.8125; val_global_loss: 21360300.5000; val_optim_loss: 21360300.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9150; val_auprc_score: 0.8804; val_best_acc_score: 0.8549; val_best_f1_score: 0.8651; train_kl_reg_loss: 90189.8277; train_edge_recon_loss: 2785210.7197; train_gene_expr_recon_loss: 12028404.7121; train_masked_gp_l1_reg_loss: 89826.2034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95968.8331; train_chrom_access_recon_loss: 6225184.0000; train_global_loss: 21314784.5455; train_optim_loss: 21314784.5455; val_kl_reg_loss: 88691.7920; val_edge_recon_loss: 2805277.0312; val_gene_expr_recon_loss: 11922716.2500; val_masked_gp_l1_reg_loss: 90085.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95391.6641; val_chrom_access_recon_loss: 6231032.6875; val_global_loss: 21233195.7500; val_optim_loss: 21233195.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9156; val_auprc_score: 0.8846; val_best_acc_score: 0.8576; val_best_f1_score: 0.8687; train_kl_reg_loss: 89950.2150; train_edge_recon_loss: 2773424.7576; train_gene_expr_recon_loss: 11993395.5000; train_masked_gp_l1_reg_loss: 90261.0030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94614.3873; train_chrom_access_recon_loss: 6211306.2576; train_global_loss: 21252952.3333; train_optim_loss: 21252952.3333; val_kl_reg_loss: 90540.1914; val_edge_recon_loss: 2787753.3750; val_gene_expr_recon_loss: 11896924.3750; val_masked_gp_l1_reg_loss: 90450.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94272.2656; val_chrom_access_recon_loss: 6189909.1875; val_global_loss: 21149848.7500; val_optim_loss: 21149848.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9190; val_auprc_score: 0.8826; val_best_acc_score: 0.8598; val_best_f1_score: 0.8695; train_kl_reg_loss: 89292.0005; train_edge_recon_loss: 2769198.1364; train_gene_expr_recon_loss: 11963640.6364; train_masked_gp_l1_reg_loss: 90579.7602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93475.1009; train_chrom_access_recon_loss: 6191612.6364; train_global_loss: 21197798.1212; train_optim_loss: 21197798.1212; val_kl_reg_loss: 89867.9922; val_edge_recon_loss: 2813859.0312; val_gene_expr_recon_loss: 11893666.2500; val_masked_gp_l1_reg_loss: 90756.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92866.3047; val_chrom_access_recon_loss: 6262324.2500; val_global_loss: 21243340.5000; val_optim_loss: 21243340.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9217; val_auprc_score: 0.8937; val_best_acc_score: 0.8673; val_best_f1_score: 0.8766; train_kl_reg_loss: 88912.4149; train_edge_recon_loss: 2766224.0492; train_gene_expr_recon_loss: 11919591.8333; train_masked_gp_l1_reg_loss: 90991.9819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92053.3503; train_chrom_access_recon_loss: 6171564.4394; train_global_loss: 21129338.0909; train_optim_loss: 21129338.0909; val_kl_reg_loss: 87149.1729; val_edge_recon_loss: 2781562.3125; val_gene_expr_recon_loss: 11943743.6250; val_masked_gp_l1_reg_loss: 91229.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91598.1562; val_chrom_access_recon_loss: 6218439.3750; val_global_loss: 21213722.5000; val_optim_loss: 21213722.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9223; val_auprc_score: 0.8944; val_best_acc_score: 0.8681; val_best_f1_score: 0.8770; train_kl_reg_loss: 89493.9660; train_edge_recon_loss: 2751379.1477; train_gene_expr_recon_loss: 11890965.5000; train_masked_gp_l1_reg_loss: 91468.8896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91072.1928; train_chrom_access_recon_loss: 6153608.6667; train_global_loss: 21067988.3939; train_optim_loss: 21067988.3939; val_kl_reg_loss: 89460.1816; val_edge_recon_loss: 2784010.3125; val_gene_expr_recon_loss: 11788098.2500; val_masked_gp_l1_reg_loss: 91620.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91149.1250; val_chrom_access_recon_loss: 6220278.3750; val_global_loss: 21064617.2500; val_optim_loss: 21064617.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9180; val_auprc_score: 0.8852; val_best_acc_score: 0.8641; val_best_f1_score: 0.8749; train_kl_reg_loss: 89206.5746; train_edge_recon_loss: 2745641.9129; train_gene_expr_recon_loss: 11881929.1515; train_masked_gp_l1_reg_loss: 91767.8916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90658.9020; train_chrom_access_recon_loss: 6146943.6818; train_global_loss: 21046148.0606; train_optim_loss: 21046148.0606; val_kl_reg_loss: 88820.4072; val_edge_recon_loss: 2765840.7188; val_gene_expr_recon_loss: 11826662.6250; val_masked_gp_l1_reg_loss: 92037.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89865.3125; val_chrom_access_recon_loss: 6200715.7500; val_global_loss: 21063941.7500; val_optim_loss: 21063941.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9243; val_auprc_score: 0.8991; val_best_acc_score: 0.8651; val_best_f1_score: 0.8750; train_kl_reg_loss: 86098.1983; train_edge_recon_loss: 2750591.5417; train_gene_expr_recon_loss: 11851057.2576; train_masked_gp_l1_reg_loss: 92118.6461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89798.7804; train_chrom_access_recon_loss: 6126337.3561; train_global_loss: 20996001.6061; train_optim_loss: 20996001.6061; val_kl_reg_loss: 86119.7803; val_edge_recon_loss: 2821633.4375; val_gene_expr_recon_loss: 11803009.8750; val_masked_gp_l1_reg_loss: 92248.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89650.4531; val_chrom_access_recon_loss: 6189675.8125; val_global_loss: 21082336.5000; val_optim_loss: 21082336.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9223; val_auprc_score: 0.8872; val_best_acc_score: 0.8646; val_best_f1_score: 0.8742; train_kl_reg_loss: 86572.8656; train_edge_recon_loss: 2745956.2424; train_gene_expr_recon_loss: 11827612.9848; train_masked_gp_l1_reg_loss: 92425.9006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89334.7000; train_chrom_access_recon_loss: 6120899.5909; train_global_loss: 20962802.2424; train_optim_loss: 20962802.2424; val_kl_reg_loss: 86209.8691; val_edge_recon_loss: 2803749.0625; val_gene_expr_recon_loss: 11779164.3750; val_masked_gp_l1_reg_loss: 92573.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88973.6953; val_chrom_access_recon_loss: 6168167.1875; val_global_loss: 21018838.7500; val_optim_loss: 21018838.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9248; val_auprc_score: 0.8989; val_best_acc_score: 0.8667; val_best_f1_score: 0.8755; train_kl_reg_loss: 85022.4315; train_edge_recon_loss: 2745702.3485; train_gene_expr_recon_loss: 11805242.1970; train_masked_gp_l1_reg_loss: 92737.1800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88865.4626; train_chrom_access_recon_loss: 6102486.6515; train_global_loss: 20920056.3333; train_optim_loss: 20920056.3333; val_kl_reg_loss: 86878.8174; val_edge_recon_loss: 2773431.1250; val_gene_expr_recon_loss: 11645445.8750; val_masked_gp_l1_reg_loss: 92852.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88773.3906; val_chrom_access_recon_loss: 6099811.9375; val_global_loss: 20787193.7500; val_optim_loss: 20787193.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9260; val_auprc_score: 0.8994; val_best_acc_score: 0.8646; val_best_f1_score: 0.8748; train_kl_reg_loss: 85209.2442; train_edge_recon_loss: 2746422.8258; train_gene_expr_recon_loss: 11777049.0606; train_masked_gp_l1_reg_loss: 92878.1287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88323.8111; train_chrom_access_recon_loss: 6086790.5303; train_global_loss: 20876673.6061; train_optim_loss: 20876673.6061; val_kl_reg_loss: 87391.0244; val_edge_recon_loss: 2758646.7500; val_gene_expr_recon_loss: 11697774.3750; val_masked_gp_l1_reg_loss: 92943.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88331.2109; val_chrom_access_recon_loss: 6140173.0000; val_global_loss: 20865259.2500; val_optim_loss: 20865259.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9349; val_auprc_score: 0.9100; val_best_acc_score: 0.8804; val_best_f1_score: 0.8868; train_kl_reg_loss: 84177.8789; train_edge_recon_loss: 2732152.6705; train_gene_expr_recon_loss: 11771640.1061; train_masked_gp_l1_reg_loss: 92982.2070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88003.2801; train_chrom_access_recon_loss: 6080139.7879; train_global_loss: 20849095.9394; train_optim_loss: 20849095.9394; val_kl_reg_loss: 86218.5078; val_edge_recon_loss: 2722245.5312; val_gene_expr_recon_loss: 11592418.6250; val_masked_gp_l1_reg_loss: 93277.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87861.5000; val_chrom_access_recon_loss: 6078494.1250; val_global_loss: 20660515.7500; val_optim_loss: 20660515.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9235; val_auprc_score: 0.8942; val_best_acc_score: 0.8632; val_best_f1_score: 0.8720; train_kl_reg_loss: 106775.0191; train_edge_recon_loss: 2843757.0568; train_gene_expr_recon_loss: 10795008.9091; train_masked_gp_l1_reg_loss: 93369.8809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89269.7737; train_chrom_access_recon_loss: 5666960.3333; train_global_loss: 19595141.1212; train_optim_loss: 19595141.1212; val_kl_reg_loss: 34807.3999; val_edge_recon_loss: 2789648.4375; val_gene_expr_recon_loss: 10650665.6250; val_masked_gp_l1_reg_loss: 92695.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90853.2266; val_chrom_access_recon_loss: 5635189.6875; val_global_loss: 19293860.7500; val_optim_loss: 19293860.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9271; val_auprc_score: 0.8969; val_best_acc_score: 0.8702; val_best_f1_score: 0.8795; train_kl_reg_loss: 89606.7002; train_edge_recon_loss: 2758796.6212; train_gene_expr_recon_loss: 10730566.3636; train_masked_gp_l1_reg_loss: 91796.3486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90553.7435; train_chrom_access_recon_loss: 5600261.8333; train_global_loss: 19361581.6667; train_optim_loss: 19361581.6667; val_kl_reg_loss: 42256.9937; val_edge_recon_loss: 2759258.4375; val_gene_expr_recon_loss: 10695485.1250; val_masked_gp_l1_reg_loss: 90847.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89968.2109; val_chrom_access_recon_loss: 5623410.5625; val_global_loss: 19301227.5000; val_optim_loss: 19301227.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9231; val_auprc_score: 0.8921; val_best_acc_score: 0.8649; val_best_f1_score: 0.8742; train_kl_reg_loss: 78701.4504; train_edge_recon_loss: 2740457.3674; train_gene_expr_recon_loss: 10720770.0758; train_masked_gp_l1_reg_loss: 89898.1905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89427.0131; train_chrom_access_recon_loss: 5590103.4621; train_global_loss: 19309357.5152; train_optim_loss: 19309357.5152; val_kl_reg_loss: 47108.3613; val_edge_recon_loss: 2761111.5625; val_gene_expr_recon_loss: 10527889.6250; val_masked_gp_l1_reg_loss: 88865.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89180.7266; val_chrom_access_recon_loss: 5616808.4375; val_global_loss: 19130965.0000; val_optim_loss: 19130965.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9259; val_auprc_score: 0.8942; val_best_acc_score: 0.8622; val_best_f1_score: 0.8715; train_kl_reg_loss: 74451.8807; train_edge_recon_loss: 2726729.8068; train_gene_expr_recon_loss: 10695551.6970; train_masked_gp_l1_reg_loss: 87904.3885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88716.8009; train_chrom_access_recon_loss: 5575340.3636; train_global_loss: 19248694.8182; train_optim_loss: 19248694.8182; val_kl_reg_loss: 48577.1245; val_edge_recon_loss: 2779595.3750; val_gene_expr_recon_loss: 10654502.3750; val_masked_gp_l1_reg_loss: 87078.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87938.8594; val_chrom_access_recon_loss: 5640318.1250; val_global_loss: 19298011.2500; val_optim_loss: 19298011.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9247; val_auprc_score: 0.8942; val_best_acc_score: 0.8694; val_best_f1_score: 0.8761; train_kl_reg_loss: 68987.1610; train_edge_recon_loss: 2719502.0871; train_gene_expr_recon_loss: 10684686.7424; train_masked_gp_l1_reg_loss: 86250.7037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87790.6026; train_chrom_access_recon_loss: 5571171.8333; train_global_loss: 19218388.9697; train_optim_loss: 19218388.9697; val_kl_reg_loss: 51200.7227; val_edge_recon_loss: 2776620.9062; val_gene_expr_recon_loss: 10605607.3750; val_masked_gp_l1_reg_loss: 85425.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87412.4688; val_chrom_access_recon_loss: 5591937.5000; val_global_loss: 19198204.2500; val_optim_loss: 19198204.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9261; val_auprc_score: 0.8982; val_best_acc_score: 0.8641; val_best_f1_score: 0.8731; train_kl_reg_loss: 68837.4079; train_edge_recon_loss: 2720337.1023; train_gene_expr_recon_loss: 10668757.1364; train_masked_gp_l1_reg_loss: 84608.0748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87012.7214; train_chrom_access_recon_loss: 5560475.5758; train_global_loss: 19190027.8788; train_optim_loss: 19190027.8788; val_kl_reg_loss: 55370.6426; val_edge_recon_loss: 2767921.5625; val_gene_expr_recon_loss: 10601453.5000; val_masked_gp_l1_reg_loss: 83808.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86873.5312; val_chrom_access_recon_loss: 5571978.6875; val_global_loss: 19167406.5000; val_optim_loss: 19167406.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9290; val_auprc_score: 0.9077; val_best_acc_score: 0.8705; val_best_f1_score: 0.8807; train_kl_reg_loss: 69054.3217; train_edge_recon_loss: 2712948.2576; train_gene_expr_recon_loss: 10646900.1970; train_masked_gp_l1_reg_loss: 82999.1122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86782.6719; train_chrom_access_recon_loss: 5550303.4470; train_global_loss: 19148987.8485; train_optim_loss: 19148987.8485; val_kl_reg_loss: 56353.0913; val_edge_recon_loss: 2746432.3125; val_gene_expr_recon_loss: 10562496.6250; val_masked_gp_l1_reg_loss: 82294.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86664.7812; val_chrom_access_recon_loss: 5537405.8750; val_global_loss: 19071647.7500; val_optim_loss: 19071647.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9343; val_auprc_score: 0.9168; val_best_acc_score: 0.8697; val_best_f1_score: 0.8781; train_kl_reg_loss: 67083.7153; train_edge_recon_loss: 2703534.1970; train_gene_expr_recon_loss: 10634213.6667; train_masked_gp_l1_reg_loss: 81721.1210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86369.1574; train_chrom_access_recon_loss: 5544213.4697; train_global_loss: 19117135.4848; train_optim_loss: 19117135.4848; val_kl_reg_loss: 57169.8970; val_edge_recon_loss: 2749695.6250; val_gene_expr_recon_loss: 10510996.0000; val_masked_gp_l1_reg_loss: 81087.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86023.2109; val_chrom_access_recon_loss: 5561379.0625; val_global_loss: 19046351.7500; val_optim_loss: 19046351.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9301; val_auprc_score: 0.9057; val_best_acc_score: 0.8718; val_best_f1_score: 0.8795; train_kl_reg_loss: 65427.6825; train_edge_recon_loss: 2723660.4583; train_gene_expr_recon_loss: 10616618.0758; train_masked_gp_l1_reg_loss: 80489.3720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85936.1296; train_chrom_access_recon_loss: 5528159.0758; train_global_loss: 19100290.8485; train_optim_loss: 19100290.8485; val_kl_reg_loss: 54234.3345; val_edge_recon_loss: 2776735.8750; val_gene_expr_recon_loss: 10517917.0000; val_masked_gp_l1_reg_loss: 80016.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85815.3281; val_chrom_access_recon_loss: 5495062.6875; val_global_loss: 19009781.5000; val_optim_loss: 19009781.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9381; val_auprc_score: 0.9144; val_best_acc_score: 0.8807; val_best_f1_score: 0.8868; train_kl_reg_loss: 64353.4820; train_edge_recon_loss: 2702618.8447; train_gene_expr_recon_loss: 10601572.8939; train_masked_gp_l1_reg_loss: 79524.2463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85814.3768; train_chrom_access_recon_loss: 5519955.5682; train_global_loss: 19053839.3636; train_optim_loss: 19053839.3636; val_kl_reg_loss: 57126.8618; val_edge_recon_loss: 2733511.5312; val_gene_expr_recon_loss: 10478400.0000; val_masked_gp_l1_reg_loss: 79063.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85898.7031; val_chrom_access_recon_loss: 5522868.8750; val_global_loss: 18956869.2500; val_optim_loss: 18956869.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9314; val_auprc_score: 0.9037; val_best_acc_score: 0.8761; val_best_f1_score: 0.8845; train_kl_reg_loss: 63214.9808; train_edge_recon_loss: 2711281.5227; train_gene_expr_recon_loss: 10580066.2727; train_masked_gp_l1_reg_loss: 78607.5889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85743.8421; train_chrom_access_recon_loss: 5505686.1136; train_global_loss: 19024600.4242; train_optim_loss: 19024600.4242; val_kl_reg_loss: 55137.1108; val_edge_recon_loss: 2733833.8750; val_gene_expr_recon_loss: 10485427.1250; val_masked_gp_l1_reg_loss: 78100.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85617.9688; val_chrom_access_recon_loss: 5503448.3750; val_global_loss: 18941564.7500; val_optim_loss: 18941564.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9334; val_auprc_score: 0.9025; val_best_acc_score: 0.8796; val_best_f1_score: 0.8867; train_kl_reg_loss: 62658.6280; train_edge_recon_loss: 2712420.8939; train_gene_expr_recon_loss: 10566448.8030; train_masked_gp_l1_reg_loss: 77680.7227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85541.1591; train_chrom_access_recon_loss: 5495091.2045; train_global_loss: 18999841.1515; train_optim_loss: 18999841.1515; val_kl_reg_loss: 57905.5767; val_edge_recon_loss: 2766931.6875; val_gene_expr_recon_loss: 10575786.8750; val_masked_gp_l1_reg_loss: 77316.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85870.8594; val_chrom_access_recon_loss: 5538175.3750; val_global_loss: 19101986.2500; val_optim_loss: 19101986.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9423; val_auprc_score: 0.9216; val_best_acc_score: 0.8842; val_best_f1_score: 0.8900; train_kl_reg_loss: 64126.1640; train_edge_recon_loss: 2707225.4470; train_gene_expr_recon_loss: 10556353.5455; train_masked_gp_l1_reg_loss: 76949.7411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85402.9265; train_chrom_access_recon_loss: 5492100.0152; train_global_loss: 18982157.6667; train_optim_loss: 18982157.6667; val_kl_reg_loss: 59562.3877; val_edge_recon_loss: 2715492.9375; val_gene_expr_recon_loss: 10444276.8750; val_masked_gp_l1_reg_loss: 76541.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85105.6406; val_chrom_access_recon_loss: 5504208.5625; val_global_loss: 18885188.2500; val_optim_loss: 18885188.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9407; val_auprc_score: 0.9188; val_best_acc_score: 0.8869; val_best_f1_score: 0.8924; train_kl_reg_loss: 62528.9525; train_edge_recon_loss: 2705617.6705; train_gene_expr_recon_loss: 10537864.3182; train_masked_gp_l1_reg_loss: 76177.0855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85229.4049; train_chrom_access_recon_loss: 5477540.2348; train_global_loss: 18944957.6970; train_optim_loss: 18944957.6970; val_kl_reg_loss: 57354.3433; val_edge_recon_loss: 2717217.0625; val_gene_expr_recon_loss: 10389928.5000; val_masked_gp_l1_reg_loss: 75922.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85631.5781; val_chrom_access_recon_loss: 5440380.7500; val_global_loss: 18766434.5000; val_optim_loss: 18766434.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9423; val_auprc_score: 0.9182; val_best_acc_score: 0.8872; val_best_f1_score: 0.8940; train_kl_reg_loss: 61086.0589; train_edge_recon_loss: 2704464.3826; train_gene_expr_recon_loss: 10530378.1515; train_masked_gp_l1_reg_loss: 75556.3568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85281.7880; train_chrom_access_recon_loss: 5470374.1515; train_global_loss: 18927140.9697; train_optim_loss: 18927140.9697; val_kl_reg_loss: 59544.8232; val_edge_recon_loss: 2742916.8438; val_gene_expr_recon_loss: 10447629.2500; val_masked_gp_l1_reg_loss: 75364.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85354.0938; val_chrom_access_recon_loss: 5471373.3125; val_global_loss: 18882182.2500; val_optim_loss: 18882182.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9434; val_auprc_score: 0.9202; val_best_acc_score: 0.8920; val_best_f1_score: 0.8967; train_kl_reg_loss: 63750.0012; train_edge_recon_loss: 2688055.1288; train_gene_expr_recon_loss: 10510153.8636; train_masked_gp_l1_reg_loss: 74980.7743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84893.4620; train_chrom_access_recon_loss: 5459713.0833; train_global_loss: 18881546.3030; train_optim_loss: 18881546.3030; val_kl_reg_loss: 60029.0737; val_edge_recon_loss: 2713951.4688; val_gene_expr_recon_loss: 10485225.2500; val_masked_gp_l1_reg_loss: 74521.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84943.8047; val_chrom_access_recon_loss: 5497908.4375; val_global_loss: 18916580.2500; val_optim_loss: 18916580.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9414; val_auprc_score: 0.9124; val_best_acc_score: 0.8917; val_best_f1_score: 0.8992; train_kl_reg_loss: 62286.6013; train_edge_recon_loss: 2690313.4659; train_gene_expr_recon_loss: 10495122.1364; train_masked_gp_l1_reg_loss: 74284.7467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84899.1289; train_chrom_access_recon_loss: 5446243.4394; train_global_loss: 18853149.5152; train_optim_loss: 18853149.5152; val_kl_reg_loss: 59502.6030; val_edge_recon_loss: 2706075.7812; val_gene_expr_recon_loss: 10384245.7500; val_masked_gp_l1_reg_loss: 74135.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84588.2422; val_chrom_access_recon_loss: 5490150.1875; val_global_loss: 18798697.2500; val_optim_loss: 18798697.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9435; val_auprc_score: 0.9229; val_best_acc_score: 0.8815; val_best_f1_score: 0.8885; train_kl_reg_loss: 61883.6968; train_edge_recon_loss: 2694429.8106; train_gene_expr_recon_loss: 10483367.9697; train_masked_gp_l1_reg_loss: 73917.3108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84727.5904; train_chrom_access_recon_loss: 5439448.1667; train_global_loss: 18837774.7576; train_optim_loss: 18837774.7576; val_kl_reg_loss: 57594.8276; val_edge_recon_loss: 2755728.0312; val_gene_expr_recon_loss: 10495552.3750; val_masked_gp_l1_reg_loss: 73798.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85057.8125; val_chrom_access_recon_loss: 5501126.6875; val_global_loss: 18968857.7500; val_optim_loss: 18968857.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9459; val_auprc_score: 0.9232; val_best_acc_score: 0.8885; val_best_f1_score: 0.8949; train_kl_reg_loss: 61327.6378; train_edge_recon_loss: 2695148.1932; train_gene_expr_recon_loss: 10462370.2273; train_masked_gp_l1_reg_loss: 73286.0694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69581.6274; train_chrom_access_recon_loss: 5428725.8712; train_global_loss: 18790439.4848; train_optim_loss: 18790439.4848; val_kl_reg_loss: 57952.1255; val_edge_recon_loss: 2715499.7188; val_gene_expr_recon_loss: 10412655.3750; val_masked_gp_l1_reg_loss: 73070.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66539.4453; val_chrom_access_recon_loss: 5494133.3125; val_global_loss: 18819849.2500; val_optim_loss: 18819849.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9432; val_auprc_score: 0.9191; val_best_acc_score: 0.8877; val_best_f1_score: 0.8941; train_kl_reg_loss: 62008.9844; train_edge_recon_loss: 2703870.4318; train_gene_expr_recon_loss: 10455932.1061; train_masked_gp_l1_reg_loss: 73014.5143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66277.7792; train_chrom_access_recon_loss: 5425301.4470; train_global_loss: 18786405.3636; train_optim_loss: 18786405.3636; val_kl_reg_loss: 58622.3384; val_edge_recon_loss: 2754100.0000; val_gene_expr_recon_loss: 10393209.3750; val_masked_gp_l1_reg_loss: 72970.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66040.0859; val_chrom_access_recon_loss: 5424409.1875; val_global_loss: 18769352.0000; val_optim_loss: 18769352.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9499; val_auprc_score: 0.9253; val_best_acc_score: 0.8995; val_best_f1_score: 0.9053; train_kl_reg_loss: 63228.0814; train_edge_recon_loss: 2687488.9394; train_gene_expr_recon_loss: 10459522.4091; train_masked_gp_l1_reg_loss: 72940.6141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65868.8610; train_chrom_access_recon_loss: 5425571.5682; train_global_loss: 18774620.5455; train_optim_loss: 18774620.5455; val_kl_reg_loss: 59826.7466; val_edge_recon_loss: 2713190.5312; val_gene_expr_recon_loss: 10432903.2500; val_masked_gp_l1_reg_loss: 72912.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65650.3281; val_chrom_access_recon_loss: 5446480.5000; val_global_loss: 18790964.0000; val_optim_loss: 18790964.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9499; val_auprc_score: 0.9293; val_best_acc_score: 0.8928; val_best_f1_score: 0.8988; train_kl_reg_loss: 63553.6754; train_edge_recon_loss: 2685350.4394; train_gene_expr_recon_loss: 10452774.2424; train_masked_gp_l1_reg_loss: 72891.4013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65501.4207; train_chrom_access_recon_loss: 5426515.2273; train_global_loss: 18766586.5152; train_optim_loss: 18766586.5152; val_kl_reg_loss: 59851.1802; val_edge_recon_loss: 2705980.0625; val_gene_expr_recon_loss: 10405705.5000; val_masked_gp_l1_reg_loss: 72857.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65380.6758; val_chrom_access_recon_loss: 5466544.1875; val_global_loss: 18776319.0000; val_optim_loss: 18776319.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 36 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9466
val AUPRC score: 0.9225
val best accuracy score: 0.8915
val best F1 score: 0.8967
val target rna MSE score: 2.4078
val source rna MSE score: 1.0988
val target atac MSE score: 0.3311
val source atac MSE score: 0.1351
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
