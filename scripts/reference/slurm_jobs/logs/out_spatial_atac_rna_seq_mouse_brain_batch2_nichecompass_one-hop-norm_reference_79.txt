[True]
Run timestamp: 07082023_194826_79.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_79']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9205; val_auprc_score: 0.9269; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 112885.4425; train_edge_recon_loss: 356188.2778; train_gene_expr_recon_loss: 649552.0139; train_masked_gp_l1_reg_loss: 16977.4104; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 815028.9514; train_global_loss: 1950632.1111; train_optim_loss: 1950632.1111; val_kl_reg_loss: 46207.3359; val_edge_recon_loss: 406606.0938; val_gene_expr_recon_loss: 576276.6875; val_masked_gp_l1_reg_loss: 14037.5391; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 787117.8125; val_global_loss: 1830245.5000; val_optim_loss: 1830245.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9178; val_auprc_score: 0.9258; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 48771.6413; train_edge_recon_loss: 370464.9583; train_gene_expr_recon_loss: 561148.9931; train_masked_gp_l1_reg_loss: 13093.8823; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 786433.6667; train_global_loss: 1779913.1528; train_optim_loss: 1779913.1528; val_kl_reg_loss: 45904.7891; val_edge_recon_loss: 406585.8750; val_gene_expr_recon_loss: 534502.3750; val_masked_gp_l1_reg_loss: 12332.8379; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 773256.2500; val_global_loss: 1772582.0000; val_optim_loss: 1772582.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9113; val_auprc_score: 0.9203; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 41552.9835; train_edge_recon_loss: 371720.5208; train_gene_expr_recon_loss: 531764.4965; train_masked_gp_l1_reg_loss: 12237.0429; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 774885.5278; train_global_loss: 1732160.5556; train_optim_loss: 1732160.5556; val_kl_reg_loss: 34778.0703; val_edge_recon_loss: 406578.5625; val_gene_expr_recon_loss: 509255.0000; val_masked_gp_l1_reg_loss: 12089.2725; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 762564.3750; val_global_loss: 1725265.2500; val_optim_loss: 1725265.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9058; val_auprc_score: 0.9118; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 42145.3765; train_edge_recon_loss: 374688.8472; train_gene_expr_recon_loss: 510196.1840; train_masked_gp_l1_reg_loss: 11758.7079; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 760585.7917; train_global_loss: 1699374.9028; train_optim_loss: 1699374.9028; val_kl_reg_loss: 83066.0547; val_edge_recon_loss: 406550.4062; val_gene_expr_recon_loss: 494518.0000; val_masked_gp_l1_reg_loss: 11313.8652; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 755191.6250; val_global_loss: 1750640.0000; val_optim_loss: 1750640.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8973; val_auprc_score: 0.9009; val_best_acc_score: 0.5053; val_best_f1_score: 0.6690; train_kl_reg_loss: 44751.9041; train_edge_recon_loss: 375154.3403; train_gene_expr_recon_loss: 502584.1250; train_masked_gp_l1_reg_loss: 11010.2230; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 764037.4861; train_global_loss: 1697538.0694; train_optim_loss: 1697538.0694; val_kl_reg_loss: 32086.0996; val_edge_recon_loss: 406479.7812; val_gene_expr_recon_loss: 486388.7500; val_masked_gp_l1_reg_loss: 10660.0088; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 750087.3750; val_global_loss: 1685702.0000; val_optim_loss: 1685702.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8731; val_auprc_score: 0.8740; val_best_acc_score: 0.5563; val_best_f1_score: 0.6918; train_kl_reg_loss: 36039.5927; train_edge_recon_loss: 370659.5938; train_gene_expr_recon_loss: 482387.3854; train_masked_gp_l1_reg_loss: 10430.6541; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 747180.3194; train_global_loss: 1646697.5139; train_optim_loss: 1646697.5139; val_kl_reg_loss: 35000.3438; val_edge_recon_loss: 406188.2812; val_gene_expr_recon_loss: 474344.3750; val_masked_gp_l1_reg_loss: 10168.6895; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 744561.6250; val_global_loss: 1670263.2500; val_optim_loss: 1670263.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8755; val_auprc_score: 0.8745; val_best_acc_score: 0.6446; val_best_f1_score: 0.7345; train_kl_reg_loss: 36650.5326; train_edge_recon_loss: 365077.1007; train_gene_expr_recon_loss: 466897.8854; train_masked_gp_l1_reg_loss: 10003.3997; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 737276.8611; train_global_loss: 1615905.7917; train_optim_loss: 1615905.7917; val_kl_reg_loss: 29675.5762; val_edge_recon_loss: 405492.1562; val_gene_expr_recon_loss: 464030.8125; val_masked_gp_l1_reg_loss: 9806.2910; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 738839.9375; val_global_loss: 1647844.7500; val_optim_loss: 1647844.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8815; val_auprc_score: 0.8752; val_best_acc_score: 0.7417; val_best_f1_score: 0.7865; train_kl_reg_loss: 34689.3485; train_edge_recon_loss: 364761.7222; train_gene_expr_recon_loss: 459561.8819; train_masked_gp_l1_reg_loss: 9676.7004; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 734157.3611; train_global_loss: 1602847.0278; train_optim_loss: 1602847.0278; val_kl_reg_loss: 33518.1445; val_edge_recon_loss: 404175.2812; val_gene_expr_recon_loss: 455779.4375; val_masked_gp_l1_reg_loss: 9521.2812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 734262.3750; val_global_loss: 1637256.5000; val_optim_loss: 1637256.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8791; val_auprc_score: 0.8710; val_best_acc_score: 0.7996; val_best_f1_score: 0.8149; train_kl_reg_loss: 33096.0621; train_edge_recon_loss: 361758.5347; train_gene_expr_recon_loss: 449534.6667; train_masked_gp_l1_reg_loss: 9423.8229; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 730487.7639; train_global_loss: 1584300.8333; train_optim_loss: 1584300.8333; val_kl_reg_loss: 29867.1934; val_edge_recon_loss: 401499.0312; val_gene_expr_recon_loss: 449190.1875; val_masked_gp_l1_reg_loss: 9306.8027; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 730374.3750; val_global_loss: 1620237.5000; val_optim_loss: 1620237.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8861; val_auprc_score: 0.8782; val_best_acc_score: 0.8006; val_best_f1_score: 0.7897; train_kl_reg_loss: 29647.0425; train_edge_recon_loss: 359846.5035; train_gene_expr_recon_loss: 444158.9201; train_masked_gp_l1_reg_loss: 9241.9450; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 722598.7986; train_global_loss: 1565493.2083; train_optim_loss: 1565493.2083; val_kl_reg_loss: 28774.0684; val_edge_recon_loss: 396871.5312; val_gene_expr_recon_loss: 443140.0000; val_masked_gp_l1_reg_loss: 9158.1523; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 726500.0000; val_global_loss: 1604443.7500; val_optim_loss: 1604443.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8942; val_auprc_score: 0.8845; val_best_acc_score: 0.8003; val_best_f1_score: 0.8191; train_kl_reg_loss: 28913.1039; train_edge_recon_loss: 357160.8507; train_gene_expr_recon_loss: 438948.1771; train_masked_gp_l1_reg_loss: 9110.9070; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 723791.3264; train_global_loss: 1557924.3472; train_optim_loss: 1557924.3472; val_kl_reg_loss: 26059.7109; val_edge_recon_loss: 384671.3750; val_gene_expr_recon_loss: 439897.0000; val_masked_gp_l1_reg_loss: 9054.3457; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 723658.7500; val_global_loss: 1583341.2500; val_optim_loss: 1583341.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9043; val_auprc_score: 0.8939; val_best_acc_score: 0.8212; val_best_f1_score: 0.8333; train_kl_reg_loss: 27357.0920; train_edge_recon_loss: 349364.0382; train_gene_expr_recon_loss: 437974.4514; train_masked_gp_l1_reg_loss: 9029.8219; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 722926.3194; train_global_loss: 1546651.7222; train_optim_loss: 1546651.7222; val_kl_reg_loss: 25952.1621; val_edge_recon_loss: 353171.7500; val_gene_expr_recon_loss: 440626.2500; val_masked_gp_l1_reg_loss: 8998.9248; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722762.1250; val_global_loss: 1551511.2500; val_optim_loss: 1551511.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9048; val_auprc_score: 0.8933; val_best_acc_score: 0.8143; val_best_f1_score: 0.8262; train_kl_reg_loss: 30477.7465; train_edge_recon_loss: 333358.4132; train_gene_expr_recon_loss: 434351.3194; train_masked_gp_l1_reg_loss: 8999.5062; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 716434.3264; train_global_loss: 1523621.3056; train_optim_loss: 1523621.3056; val_kl_reg_loss: 35127.8516; val_edge_recon_loss: 327196.2500; val_gene_expr_recon_loss: 438190.9688; val_masked_gp_l1_reg_loss: 8997.0068; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 720024.6250; val_global_loss: 1529536.7500; val_optim_loss: 1529536.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9038; val_auprc_score: 0.8896; val_best_acc_score: 0.8162; val_best_f1_score: 0.8288; train_kl_reg_loss: 37428.1567; train_edge_recon_loss: 321249.8889; train_gene_expr_recon_loss: 434964.0764; train_masked_gp_l1_reg_loss: 9004.0190; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 717176.1875; train_global_loss: 1519822.3056; train_optim_loss: 1519822.3056; val_kl_reg_loss: 36109.0938; val_edge_recon_loss: 319037.3438; val_gene_expr_recon_loss: 435160.0625; val_masked_gp_l1_reg_loss: 9014.5400; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 717588.2500; val_global_loss: 1516909.2500; val_optim_loss: 1516909.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9030; val_auprc_score: 0.8821; val_best_acc_score: 0.8216; val_best_f1_score: 0.8310; train_kl_reg_loss: 35964.5304; train_edge_recon_loss: 317574.6667; train_gene_expr_recon_loss: 432404.5347; train_masked_gp_l1_reg_loss: 9030.8771; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 719664.2986; train_global_loss: 1514638.9444; train_optim_loss: 1514638.9444; val_kl_reg_loss: 35135.6094; val_edge_recon_loss: 321181.2500; val_gene_expr_recon_loss: 432036.7500; val_masked_gp_l1_reg_loss: 9044.1826; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 714847.5000; val_global_loss: 1512245.2500; val_optim_loss: 1512245.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9128; val_auprc_score: 0.8921; val_best_acc_score: 0.8375; val_best_f1_score: 0.8407; train_kl_reg_loss: 35032.1523; train_edge_recon_loss: 314517.1285; train_gene_expr_recon_loss: 429552.0174; train_masked_gp_l1_reg_loss: 9060.9595; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 713021.6042; train_global_loss: 1501183.8611; train_optim_loss: 1501183.8611; val_kl_reg_loss: 34513.2109; val_edge_recon_loss: 315160.9062; val_gene_expr_recon_loss: 430484.5625; val_masked_gp_l1_reg_loss: 9075.9336; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 712759.0000; val_global_loss: 1501993.6250; val_optim_loss: 1501993.6250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9205; val_auprc_score: 0.9047; val_best_acc_score: 0.8414; val_best_f1_score: 0.8504; train_kl_reg_loss: 34749.3537; train_edge_recon_loss: 311953.3715; train_gene_expr_recon_loss: 428122.6458; train_masked_gp_l1_reg_loss: 9093.9817; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 708331.9097; train_global_loss: 1492251.2500; train_optim_loss: 1492251.2500; val_kl_reg_loss: 34126.1992; val_edge_recon_loss: 312697.0312; val_gene_expr_recon_loss: 428480.0938; val_masked_gp_l1_reg_loss: 9106.1982; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 710828.6875; val_global_loss: 1495238.2500; val_optim_loss: 1495238.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9252; val_auprc_score: 0.9096; val_best_acc_score: 0.8510; val_best_f1_score: 0.8577; train_kl_reg_loss: 34609.9835; train_edge_recon_loss: 309958.3403; train_gene_expr_recon_loss: 424264.0938; train_masked_gp_l1_reg_loss: 9121.2643; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 707607.1597; train_global_loss: 1485560.8611; train_optim_loss: 1485560.8611; val_kl_reg_loss: 33788.8438; val_edge_recon_loss: 308084.9062; val_gene_expr_recon_loss: 427528.9688; val_masked_gp_l1_reg_loss: 9130.3223; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 708772.5000; val_global_loss: 1487305.5000; val_optim_loss: 1487305.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9272; val_auprc_score: 0.9078; val_best_acc_score: 0.8544; val_best_f1_score: 0.8611; train_kl_reg_loss: 33887.0951; train_edge_recon_loss: 307732.3333; train_gene_expr_recon_loss: 424919.0556; train_masked_gp_l1_reg_loss: 9142.1552; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 706311.4861; train_global_loss: 1481992.1250; train_optim_loss: 1481992.1250; val_kl_reg_loss: 34214.4883; val_edge_recon_loss: 306611.0000; val_gene_expr_recon_loss: 427031.9375; val_masked_gp_l1_reg_loss: 9154.0039; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707421.0000; val_global_loss: 1484432.5000; val_optim_loss: 1484432.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9333; val_auprc_score: 0.9189; val_best_acc_score: 0.8620; val_best_f1_score: 0.8677; train_kl_reg_loss: 34084.6975; train_edge_recon_loss: 306026.8542; train_gene_expr_recon_loss: 424012.3646; train_masked_gp_l1_reg_loss: 9170.6345; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 702886.2292; train_global_loss: 1476180.7917; train_optim_loss: 1476180.7917; val_kl_reg_loss: 33563.8320; val_edge_recon_loss: 306285.0312; val_gene_expr_recon_loss: 425035.6250; val_masked_gp_l1_reg_loss: 9180.7656; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 705694.3125; val_global_loss: 1479759.5000; val_optim_loss: 1479759.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9370; val_auprc_score: 0.9225; val_best_acc_score: 0.8632; val_best_f1_score: 0.8693; train_kl_reg_loss: 33616.0386; train_edge_recon_loss: 305050.8403; train_gene_expr_recon_loss: 423961.0729; train_masked_gp_l1_reg_loss: 9193.3278; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703501.6458; train_global_loss: 1475322.9444; train_optim_loss: 1475322.9444; val_kl_reg_loss: 33234.9531; val_edge_recon_loss: 303218.4062; val_gene_expr_recon_loss: 423877.5000; val_masked_gp_l1_reg_loss: 9200.3857; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 704619.1250; val_global_loss: 1474150.3750; val_optim_loss: 1474150.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9396; val_auprc_score: 0.9269; val_best_acc_score: 0.8720; val_best_f1_score: 0.8788; train_kl_reg_loss: 34087.4332; train_edge_recon_loss: 301716.6181; train_gene_expr_recon_loss: 421479.8090; train_masked_gp_l1_reg_loss: 9222.9414; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 702504.6319; train_global_loss: 1469011.4306; train_optim_loss: 1469011.4306; val_kl_reg_loss: 33826.2773; val_edge_recon_loss: 302702.2500; val_gene_expr_recon_loss: 423185.7500; val_masked_gp_l1_reg_loss: 9232.1768; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 703355.0625; val_global_loss: 1472301.5000; val_optim_loss: 1472301.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9444; val_auprc_score: 0.9259; val_best_acc_score: 0.8800; val_best_f1_score: 0.8870; train_kl_reg_loss: 33784.6580; train_edge_recon_loss: 300450.8958; train_gene_expr_recon_loss: 420377.4861; train_masked_gp_l1_reg_loss: 9249.3997; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 700691.9931; train_global_loss: 1464554.4444; train_optim_loss: 1464554.4444; val_kl_reg_loss: 34332.4766; val_edge_recon_loss: 298814.3438; val_gene_expr_recon_loss: 422102.6250; val_masked_gp_l1_reg_loss: 9261.9336; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 702045.0625; val_global_loss: 1466556.5000; val_optim_loss: 1466556.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9475; val_auprc_score: 0.9348; val_best_acc_score: 0.8836; val_best_f1_score: 0.8883; train_kl_reg_loss: 34489.9418; train_edge_recon_loss: 298930.8438; train_gene_expr_recon_loss: 419368.1146; train_masked_gp_l1_reg_loss: 9276.0858; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 698510.4722; train_global_loss: 1460575.4583; train_optim_loss: 1460575.4583; val_kl_reg_loss: 33492.2422; val_edge_recon_loss: 299668.9062; val_gene_expr_recon_loss: 420689.6250; val_masked_gp_l1_reg_loss: 9283.6709; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 700968.0625; val_global_loss: 1464102.5000; val_optim_loss: 1464102.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9529; val_auprc_score: 0.9427; val_best_acc_score: 0.8863; val_best_f1_score: 0.8908; train_kl_reg_loss: 33596.3997; train_edge_recon_loss: 298901.6632; train_gene_expr_recon_loss: 417123.0104; train_masked_gp_l1_reg_loss: 9292.0829; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 698578.2569; train_global_loss: 1457491.4167; train_optim_loss: 1457491.4167; val_kl_reg_loss: 33857.1250; val_edge_recon_loss: 299848.8125; val_gene_expr_recon_loss: 419977.9375; val_masked_gp_l1_reg_loss: 9297.3008; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 699381.5625; val_global_loss: 1462362.7500; val_optim_loss: 1462362.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9423; val_auprc_score: 0.9275; val_best_acc_score: 0.8751; val_best_f1_score: 0.8807; train_kl_reg_loss: 34727.7044; train_edge_recon_loss: 340404.1562; train_gene_expr_recon_loss: 436061.5938; train_masked_gp_l1_reg_loss: 9305.7669; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711336.5972; train_global_loss: 1531835.8194; train_optim_loss: 1531835.8194; val_kl_reg_loss: 16492.7910; val_edge_recon_loss: 333106.1562; val_gene_expr_recon_loss: 436328.0625; val_masked_gp_l1_reg_loss: 9293.0010; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 711006.8125; val_global_loss: 1506226.7500; val_optim_loss: 1506226.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9316; val_auprc_score: 0.9152; val_best_acc_score: 0.8557; val_best_f1_score: 0.8614; train_kl_reg_loss: 30579.9160; train_edge_recon_loss: 321481.1389; train_gene_expr_recon_loss: 435441.9271; train_masked_gp_l1_reg_loss: 9279.8292; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 710436.7569; train_global_loss: 1507219.5556; train_optim_loss: 1507219.5556; val_kl_reg_loss: 18361.9805; val_edge_recon_loss: 315605.7188; val_gene_expr_recon_loss: 437392.1875; val_masked_gp_l1_reg_loss: 9263.4326; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 711073.5625; val_global_loss: 1491696.8750; val_optim_loss: 1491696.8750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9275; val_auprc_score: 0.9104; val_best_acc_score: 0.8548; val_best_f1_score: 0.8600; train_kl_reg_loss: 28974.2480; train_edge_recon_loss: 308665.9514; train_gene_expr_recon_loss: 431819.8264; train_masked_gp_l1_reg_loss: 9253.3891; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 706543.9514; train_global_loss: 1485257.3750; train_optim_loss: 1485257.3750; val_kl_reg_loss: 22867.9199; val_edge_recon_loss: 304392.0312; val_gene_expr_recon_loss: 434740.8750; val_masked_gp_l1_reg_loss: 9233.0664; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 709280.6875; val_global_loss: 1480514.5000; val_optim_loss: 1480514.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9360; val_auprc_score: 0.9195; val_best_acc_score: 0.8650; val_best_f1_score: 0.8708; train_kl_reg_loss: 28897.0749; train_edge_recon_loss: 303672.2465; train_gene_expr_recon_loss: 431022.3715; train_masked_gp_l1_reg_loss: 9213.2091; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 706874.0486; train_global_loss: 1479678.9444; train_optim_loss: 1479678.9444; val_kl_reg_loss: 23488.0430; val_edge_recon_loss: 301290.4062; val_gene_expr_recon_loss: 432521.6875; val_masked_gp_l1_reg_loss: 9185.0166; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707452.0000; val_global_loss: 1473937.1250; val_optim_loss: 1473937.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9330; val_auprc_score: 0.9135; val_best_acc_score: 0.8619; val_best_f1_score: 0.8681; train_kl_reg_loss: 28138.2828; train_edge_recon_loss: 302161.0417; train_gene_expr_recon_loss: 428128.9618; train_masked_gp_l1_reg_loss: 9119.9618; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 704052.6042; train_global_loss: 1471600.8750; train_optim_loss: 1471600.8750; val_kl_reg_loss: 23655.9863; val_edge_recon_loss: 301452.8125; val_gene_expr_recon_loss: 432228.3438; val_masked_gp_l1_reg_loss: 9063.4141; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707110.3750; val_global_loss: 1473511.0000; val_optim_loss: 1473511.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9320; val_auprc_score: 0.9143; val_best_acc_score: 0.8608; val_best_f1_score: 0.8652; train_kl_reg_loss: 28067.4427; train_edge_recon_loss: 301913.7604; train_gene_expr_recon_loss: 430654.7153; train_masked_gp_l1_reg_loss: 9047.0244; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 709279.3264; train_global_loss: 1478962.2778; train_optim_loss: 1478962.2778; val_kl_reg_loss: 23742.1836; val_edge_recon_loss: 304048.0625; val_gene_expr_recon_loss: 431971.6250; val_masked_gp_l1_reg_loss: 9021.5996; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707086.6875; val_global_loss: 1475870.2500; val_optim_loss: 1475870.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9374; val_auprc_score: 0.9218; val_best_acc_score: 0.8676; val_best_f1_score: 0.8728; train_kl_reg_loss: 27914.3188; train_edge_recon_loss: 301238.8125; train_gene_expr_recon_loss: 428444.2569; train_masked_gp_l1_reg_loss: 9008.3641; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 706460.5486; train_global_loss: 1473066.3056; train_optim_loss: 1473066.3056; val_kl_reg_loss: 23443.8906; val_edge_recon_loss: 301237.2812; val_gene_expr_recon_loss: 432050.5938; val_masked_gp_l1_reg_loss: 8992.8555; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707134.8125; val_global_loss: 1472859.5000; val_optim_loss: 1472859.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9334; val_auprc_score: 0.9192; val_best_acc_score: 0.8603; val_best_f1_score: 0.8667; train_kl_reg_loss: 27544.2513; train_edge_recon_loss: 300885.1667; train_gene_expr_recon_loss: 429501.5451; train_masked_gp_l1_reg_loss: 8983.3982; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 702761.0833; train_global_loss: 1469675.4167; train_optim_loss: 1469675.4167; val_kl_reg_loss: 23622.0488; val_edge_recon_loss: 302309.2500; val_gene_expr_recon_loss: 431832.1250; val_masked_gp_l1_reg_loss: 8973.2930; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707079.1250; val_global_loss: 1473815.8750; val_optim_loss: 1473815.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 22 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9527
val AUPRC score: 0.9400
val best accuracy score: 0.8883
val best F1 score: 0.8942
val target rna MSE score: 0.4793
val source rna MSE score: 0.2963
val target atac MSE score: 0.1350
val source atac MSE score: 0.0193
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
