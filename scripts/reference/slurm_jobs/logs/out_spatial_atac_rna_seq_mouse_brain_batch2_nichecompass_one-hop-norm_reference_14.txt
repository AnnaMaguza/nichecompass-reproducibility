[True]
Run timestamp: 07082023_173136_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8731; val_auprc_score: 0.8941; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 10459.3355; train_edge_recon_loss: 35802.3290; train_gene_expr_recon_loss: 1316176.8750; train_masked_gp_l1_reg_loss: 8352.3290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119514.9392; train_chrom_access_recon_loss: 3242162.4583; train_global_loss: 4732468.2500; train_optim_loss: 4732468.2500; val_kl_reg_loss: 5801.8525; val_edge_recon_loss: 40660.1484; val_gene_expr_recon_loss: 1089324.2500; val_masked_gp_l1_reg_loss: 6498.7627; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117172.1953; val_chrom_access_recon_loss: 1672711.8750; val_global_loss: 2932169.0000; val_optim_loss: 2932169.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8834; val_auprc_score: 0.9020; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6547.2186; train_edge_recon_loss: 36706.7969; train_gene_expr_recon_loss: 1056100.6597; train_masked_gp_l1_reg_loss: 6017.8175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115789.3411; train_chrom_access_recon_loss: 1572618.3056; train_global_loss: 2793780.1111; train_optim_loss: 2793780.1111; val_kl_reg_loss: 7119.4360; val_edge_recon_loss: 40661.1250; val_gene_expr_recon_loss: 962779.2500; val_masked_gp_l1_reg_loss: 5836.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114158.4531; val_chrom_access_recon_loss: 1465242.3750; val_global_loss: 2595797.2500; val_optim_loss: 2595797.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8857; val_auprc_score: 0.9018; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9598.2548; train_edge_recon_loss: 37354.4770; train_gene_expr_recon_loss: 934397.7500; train_masked_gp_l1_reg_loss: 6213.4913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112954.7622; train_chrom_access_recon_loss: 1442703.3750; train_global_loss: 2543222.1389; train_optim_loss: 2543222.1389; val_kl_reg_loss: 13240.9023; val_edge_recon_loss: 40661.9258; val_gene_expr_recon_loss: 851082.8125; val_masked_gp_l1_reg_loss: 6623.2246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111465.5781; val_chrom_access_recon_loss: 1409483.7500; val_global_loss: 2432558.2500; val_optim_loss: 2432558.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8997; val_auprc_score: 0.9131; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17556.8070; train_edge_recon_loss: 38476.1780; train_gene_expr_recon_loss: 825363.3403; train_masked_gp_l1_reg_loss: 6725.3124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110229.0573; train_chrom_access_recon_loss: 1396886.1389; train_global_loss: 2395236.8056; train_optim_loss: 2395236.8056; val_kl_reg_loss: 20236.2461; val_edge_recon_loss: 40661.9453; val_gene_expr_recon_loss: 773335.7500; val_masked_gp_l1_reg_loss: 6791.0112; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108614.1562; val_chrom_access_recon_loss: 1373969.1250; val_global_loss: 2323608.2500; val_optim_loss: 2323608.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8955; val_auprc_score: 0.9027; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 21714.7611; train_edge_recon_loss: 38884.8967; train_gene_expr_recon_loss: 771390.7083; train_masked_gp_l1_reg_loss: 6805.3746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107185.4774; train_chrom_access_recon_loss: 1376185.7361; train_global_loss: 2322166.9722; train_optim_loss: 2322166.9722; val_kl_reg_loss: 20280.7070; val_edge_recon_loss: 40660.9219; val_gene_expr_recon_loss: 739221.6875; val_masked_gp_l1_reg_loss: 6792.6636; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105309.9375; val_chrom_access_recon_loss: 1346878.8750; val_global_loss: 2259144.7500; val_optim_loss: 2259144.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8888; val_auprc_score: 0.8950; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 21524.6654; train_edge_recon_loss: 38893.5195; train_gene_expr_recon_loss: 744536.8056; train_masked_gp_l1_reg_loss: 6786.8975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103697.2170; train_chrom_access_recon_loss: 1352772.0278; train_global_loss: 2268211.1111; train_optim_loss: 2268211.1111; val_kl_reg_loss: 21433.5312; val_edge_recon_loss: 40659.6250; val_gene_expr_recon_loss: 716136.5000; val_masked_gp_l1_reg_loss: 6775.2754; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101626.0312; val_chrom_access_recon_loss: 1333294.3750; val_global_loss: 2219925.2500; val_optim_loss: 2219925.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8785; val_auprc_score: 0.8810; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 22833.2713; train_edge_recon_loss: 38999.2374; train_gene_expr_recon_loss: 721288.6528; train_masked_gp_l1_reg_loss: 6749.9184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99902.1111; train_chrom_access_recon_loss: 1339071.1667; train_global_loss: 2228844.3333; train_optim_loss: 2228844.3333; val_kl_reg_loss: 22374.9219; val_edge_recon_loss: 40656.6562; val_gene_expr_recon_loss: 699139.6250; val_masked_gp_l1_reg_loss: 6706.3760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97715.4844; val_chrom_access_recon_loss: 1324172.3750; val_global_loss: 2190765.5000; val_optim_loss: 2190765.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8684; val_auprc_score: 0.8671; val_best_acc_score: 0.5092; val_best_f1_score: 0.6708; train_kl_reg_loss: 23273.4468; train_edge_recon_loss: 39018.6424; train_gene_expr_recon_loss: 703449.5139; train_masked_gp_l1_reg_loss: 6676.4883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95931.6927; train_chrom_access_recon_loss: 1324906.5417; train_global_loss: 2193256.3056; train_optim_loss: 2193256.3056; val_kl_reg_loss: 22411.9785; val_edge_recon_loss: 40650.3438; val_gene_expr_recon_loss: 686236.3750; val_masked_gp_l1_reg_loss: 6626.7012; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93690.0000; val_chrom_access_recon_loss: 1317489.5000; val_global_loss: 2167105.0000; val_optim_loss: 2167105.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8663; val_auprc_score: 0.8638; val_best_acc_score: 0.5350; val_best_f1_score: 0.6821; train_kl_reg_loss: 23573.0653; train_edge_recon_loss: 39051.2144; train_gene_expr_recon_loss: 695645.3681; train_masked_gp_l1_reg_loss: 6594.3267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91887.4939; train_chrom_access_recon_loss: 1322407.4861; train_global_loss: 2179159.0000; train_optim_loss: 2179159.0000; val_kl_reg_loss: 22206.4258; val_edge_recon_loss: 40632.5156; val_gene_expr_recon_loss: 676047.6250; val_masked_gp_l1_reg_loss: 6548.3525; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89632.2188; val_chrom_access_recon_loss: 1311927.6250; val_global_loss: 2146994.7500; val_optim_loss: 2146994.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8532; val_auprc_score: 0.8545; val_best_acc_score: 0.5631; val_best_f1_score: 0.6939; train_kl_reg_loss: 23724.2491; train_edge_recon_loss: 39064.8911; train_gene_expr_recon_loss: 683198.2500; train_masked_gp_l1_reg_loss: 6519.1786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87839.3924; train_chrom_access_recon_loss: 1324136.6111; train_global_loss: 2164482.5833; train_optim_loss: 2164482.5833; val_kl_reg_loss: 22976.4414; val_edge_recon_loss: 40616.2305; val_gene_expr_recon_loss: 666409.6250; val_masked_gp_l1_reg_loss: 6475.3145; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85607.3828; val_chrom_access_recon_loss: 1307192.7500; val_global_loss: 2129277.7500; val_optim_loss: 2129277.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8463; val_auprc_score: 0.8424; val_best_acc_score: 0.5981; val_best_f1_score: 0.7097; train_kl_reg_loss: 24067.9900; train_edge_recon_loss: 39131.4900; train_gene_expr_recon_loss: 677016.5069; train_masked_gp_l1_reg_loss: 6455.1561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83848.6606; train_chrom_access_recon_loss: 1313369.8472; train_global_loss: 2143889.6944; train_optim_loss: 2143889.6944; val_kl_reg_loss: 23139.1367; val_edge_recon_loss: 40591.5859; val_gene_expr_recon_loss: 659901.9375; val_masked_gp_l1_reg_loss: 6422.2246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81667.2734; val_chrom_access_recon_loss: 1302823.8750; val_global_loss: 2114546.0000; val_optim_loss: 2114546.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8441; val_auprc_score: 0.8457; val_best_acc_score: 0.6443; val_best_f1_score: 0.7319; train_kl_reg_loss: 24211.8874; train_edge_recon_loss: 39165.2917; train_gene_expr_recon_loss: 665910.5972; train_masked_gp_l1_reg_loss: 6402.7958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79962.6337; train_chrom_access_recon_loss: 1310820.2222; train_global_loss: 2126473.4167; train_optim_loss: 2126473.4167; val_kl_reg_loss: 22745.0273; val_edge_recon_loss: 40560.5312; val_gene_expr_recon_loss: 655405.1250; val_masked_gp_l1_reg_loss: 6374.8848; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77858.6641; val_chrom_access_recon_loss: 1299261.0000; val_global_loss: 2102205.2500; val_optim_loss: 2102205.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8420; val_auprc_score: 0.8424; val_best_acc_score: 0.6586; val_best_f1_score: 0.7377; train_kl_reg_loss: 24024.0328; train_edge_recon_loss: 39161.9705; train_gene_expr_recon_loss: 662358.2153; train_masked_gp_l1_reg_loss: 6356.8000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76224.0174; train_chrom_access_recon_loss: 1305439.8889; train_global_loss: 2113564.9722; train_optim_loss: 2113564.9722; val_kl_reg_loss: 22278.4785; val_edge_recon_loss: 40543.5586; val_gene_expr_recon_loss: 651936.8750; val_masked_gp_l1_reg_loss: 6333.2788; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74205.3047; val_chrom_access_recon_loss: 1295725.7500; val_global_loss: 2091023.2500; val_optim_loss: 2091023.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8512; val_auprc_score: 0.8482; val_best_acc_score: 0.6803; val_best_f1_score: 0.7483; train_kl_reg_loss: 23728.6326; train_edge_recon_loss: 39151.6766; train_gene_expr_recon_loss: 661076.2431; train_masked_gp_l1_reg_loss: 6323.9765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72641.8950; train_chrom_access_recon_loss: 1301642.9167; train_global_loss: 2104565.3194; train_optim_loss: 2104565.3194; val_kl_reg_loss: 21950.1680; val_edge_recon_loss: 40521.7812; val_gene_expr_recon_loss: 648861.8125; val_masked_gp_l1_reg_loss: 6309.2261; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70715.0703; val_chrom_access_recon_loss: 1293040.8750; val_global_loss: 2081399.0000; val_optim_loss: 2081399.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8549; val_auprc_score: 0.8546; val_best_acc_score: 0.6890; val_best_f1_score: 0.7525; train_kl_reg_loss: 23180.7394; train_edge_recon_loss: 39118.2990; train_gene_expr_recon_loss: 656873.3125; train_masked_gp_l1_reg_loss: 6307.1675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69232.7283; train_chrom_access_recon_loss: 1298089.6250; train_global_loss: 2092801.9306; train_optim_loss: 2092801.9306; val_kl_reg_loss: 22468.8359; val_edge_recon_loss: 40516.3008; val_gene_expr_recon_loss: 645470.6250; val_masked_gp_l1_reg_loss: 6296.9863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67410.1719; val_chrom_access_recon_loss: 1290538.0000; val_global_loss: 2072701.0000; val_optim_loss: 2072701.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8664; val_auprc_score: 0.8602; val_best_acc_score: 0.7167; val_best_f1_score: 0.7678; train_kl_reg_loss: 22732.4089; train_edge_recon_loss: 39100.7374; train_gene_expr_recon_loss: 658370.8333; train_masked_gp_l1_reg_loss: 6292.4024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66006.8928; train_chrom_access_recon_loss: 1304353.8056; train_global_loss: 2096857.0972; train_optim_loss: 2096857.0972; val_kl_reg_loss: 22078.5039; val_edge_recon_loss: 40495.3672; val_gene_expr_recon_loss: 643457.8750; val_masked_gp_l1_reg_loss: 6288.1685; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64283.2500; val_chrom_access_recon_loss: 1290293.1250; val_global_loss: 2066896.2500; val_optim_loss: 2066896.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8752; val_auprc_score: 0.8695; val_best_acc_score: 0.7475; val_best_f1_score: 0.7854; train_kl_reg_loss: 22247.2615; train_edge_recon_loss: 39060.9505; train_gene_expr_recon_loss: 653529.2153; train_masked_gp_l1_reg_loss: 6288.1029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62962.1246; train_chrom_access_recon_loss: 1292406.1111; train_global_loss: 2076493.7222; train_optim_loss: 2076493.7222; val_kl_reg_loss: 20989.2070; val_edge_recon_loss: 40463.0156; val_gene_expr_recon_loss: 642057.0000; val_masked_gp_l1_reg_loss: 6281.2822; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61341.9336; val_chrom_access_recon_loss: 1288683.3750; val_global_loss: 2059815.8750; val_optim_loss: 2059815.8750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8818; val_auprc_score: 0.8775; val_best_acc_score: 0.7771; val_best_f1_score: 0.8036; train_kl_reg_loss: 21811.3696; train_edge_recon_loss: 39024.2804; train_gene_expr_recon_loss: 650046.4097; train_masked_gp_l1_reg_loss: 6281.5664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60103.8754; train_chrom_access_recon_loss: 1296300.3056; train_global_loss: 2073567.7917; train_optim_loss: 2073567.7917; val_kl_reg_loss: 20431.4141; val_edge_recon_loss: 40436.0508; val_gene_expr_recon_loss: 640535.3750; val_masked_gp_l1_reg_loss: 6272.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58582.6172; val_chrom_access_recon_loss: 1286110.7500; val_global_loss: 2052368.6250; val_optim_loss: 2052368.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8954; val_auprc_score: 0.8894; val_best_acc_score: 0.8058; val_best_f1_score: 0.8220; train_kl_reg_loss: 21342.0794; train_edge_recon_loss: 38967.0556; train_gene_expr_recon_loss: 648957.6528; train_masked_gp_l1_reg_loss: 6276.9093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57418.6636; train_chrom_access_recon_loss: 1293563.0556; train_global_loss: 2066525.4444; train_optim_loss: 2066525.4444; val_kl_reg_loss: 20314.8164; val_edge_recon_loss: 40383.8438; val_gene_expr_recon_loss: 638710.6250; val_masked_gp_l1_reg_loss: 6279.5171; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55989.1445; val_chrom_access_recon_loss: 1283996.2500; val_global_loss: 2045674.2500; val_optim_loss: 2045674.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9042; val_auprc_score: 0.8980; val_best_acc_score: 0.8333; val_best_f1_score: 0.8400; train_kl_reg_loss: 21035.8448; train_edge_recon_loss: 38901.2500; train_gene_expr_recon_loss: 647133.6319; train_masked_gp_l1_reg_loss: 6283.8250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54897.1745; train_chrom_access_recon_loss: 1288708.5417; train_global_loss: 2056960.2778; train_optim_loss: 2056960.2778; val_kl_reg_loss: 20319.4043; val_edge_recon_loss: 40328.3047; val_gene_expr_recon_loss: 637063.1250; val_masked_gp_l1_reg_loss: 6281.6611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53552.7266; val_chrom_access_recon_loss: 1281961.2500; val_global_loss: 2039506.5000; val_optim_loss: 2039506.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9183; val_auprc_score: 0.9078; val_best_acc_score: 0.8500; val_best_f1_score: 0.8498; train_kl_reg_loss: 20723.6864; train_edge_recon_loss: 38838.8307; train_gene_expr_recon_loss: 643801.9444; train_masked_gp_l1_reg_loss: 6287.0214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52527.0095; train_chrom_access_recon_loss: 1286638.5694; train_global_loss: 2048817.0417; train_optim_loss: 2048817.0417; val_kl_reg_loss: 19659.4375; val_edge_recon_loss: 40209.8672; val_gene_expr_recon_loss: 636024.5625; val_masked_gp_l1_reg_loss: 6279.9126; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51262.2422; val_chrom_access_recon_loss: 1279808.5000; val_global_loss: 2033244.5000; val_optim_loss: 2033244.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9232; val_auprc_score: 0.9116; val_best_acc_score: 0.8486; val_best_f1_score: 0.8448; train_kl_reg_loss: 20458.7170; train_edge_recon_loss: 38752.8702; train_gene_expr_recon_loss: 643961.9167; train_masked_gp_l1_reg_loss: 6282.3884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50299.3455; train_chrom_access_recon_loss: 1288765.1667; train_global_loss: 2048520.4028; train_optim_loss: 2048520.4028; val_kl_reg_loss: 19271.8672; val_edge_recon_loss: 40114.0820; val_gene_expr_recon_loss: 634820.1875; val_masked_gp_l1_reg_loss: 6279.4575; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49115.4922; val_chrom_access_recon_loss: 1277954.1250; val_global_loss: 2027555.2500; val_optim_loss: 2027555.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9297; val_auprc_score: 0.9209; val_best_acc_score: 0.8469; val_best_f1_score: 0.8397; train_kl_reg_loss: 20214.3511; train_edge_recon_loss: 38672.9527; train_gene_expr_recon_loss: 644199.4583; train_masked_gp_l1_reg_loss: 6283.5763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48216.1918; train_chrom_access_recon_loss: 1281922.5556; train_global_loss: 2039509.0833; train_optim_loss: 2039509.0833; val_kl_reg_loss: 18875.5332; val_edge_recon_loss: 40038.0898; val_gene_expr_recon_loss: 634027.5000; val_masked_gp_l1_reg_loss: 6283.2246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47101.2305; val_chrom_access_recon_loss: 1276419.2500; val_global_loss: 2022744.8750; val_optim_loss: 2022744.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9343; val_auprc_score: 0.9239; val_best_acc_score: 0.8447; val_best_f1_score: 0.8348; train_kl_reg_loss: 20037.6400; train_edge_recon_loss: 38602.7843; train_gene_expr_recon_loss: 643306.8472; train_masked_gp_l1_reg_loss: 6287.5064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46253.4045; train_chrom_access_recon_loss: 1288897.7917; train_global_loss: 2043386.0000; train_optim_loss: 2043386.0000; val_kl_reg_loss: 19058.7383; val_edge_recon_loss: 39931.7734; val_gene_expr_recon_loss: 632430.6250; val_masked_gp_l1_reg_loss: 6283.7295; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45209.1875; val_chrom_access_recon_loss: 1274588.3750; val_global_loss: 2017502.5000; val_optim_loss: 2017502.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9380; val_auprc_score: 0.9290; val_best_acc_score: 0.8409; val_best_f1_score: 0.8275; train_kl_reg_loss: 19909.9781; train_edge_recon_loss: 38515.2192; train_gene_expr_recon_loss: 644696.5000; train_masked_gp_l1_reg_loss: 6288.4680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44413.2331; train_chrom_access_recon_loss: 1285958.1944; train_global_loss: 2039781.6250; train_optim_loss: 2039781.6250; val_kl_reg_loss: 18844.4102; val_edge_recon_loss: 39845.2266; val_gene_expr_recon_loss: 631398.9375; val_masked_gp_l1_reg_loss: 6287.3564; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43431.6484; val_chrom_access_recon_loss: 1272673.0000; val_global_loss: 2012480.5000; val_optim_loss: 2012480.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9277; val_auprc_score: 0.9148; val_best_acc_score: 0.8515; val_best_f1_score: 0.8614; train_kl_reg_loss: 16405.3895; train_edge_recon_loss: 39984.4336; train_gene_expr_recon_loss: 983968.5278; train_masked_gp_l1_reg_loss: 6415.9955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42566.1233; train_chrom_access_recon_loss: 1351873.0417; train_global_loss: 2441213.5000; train_optim_loss: 2441213.5000; val_kl_reg_loss: 15061.3145; val_edge_recon_loss: 40352.2891; val_gene_expr_recon_loss: 955346.1250; val_masked_gp_l1_reg_loss: 6666.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41431.7383; val_chrom_access_recon_loss: 1344305.1250; val_global_loss: 2403163.5000; val_optim_loss: 2403163.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9377; val_auprc_score: 0.9249; val_best_acc_score: 0.8697; val_best_f1_score: 0.8758; train_kl_reg_loss: 15493.5279; train_edge_recon_loss: 40036.9036; train_gene_expr_recon_loss: 976280.5694; train_masked_gp_l1_reg_loss: 6875.6544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40504.1324; train_chrom_access_recon_loss: 1354575.1944; train_global_loss: 2433765.9444; train_optim_loss: 2433765.9444; val_kl_reg_loss: 14212.0186; val_edge_recon_loss: 40298.1758; val_gene_expr_recon_loss: 947277.2500; val_masked_gp_l1_reg_loss: 7130.4731; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39358.7383; val_chrom_access_recon_loss: 1342358.6250; val_global_loss: 2390635.2500; val_optim_loss: 2390635.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9304; val_auprc_score: 0.9136; val_best_acc_score: 0.8623; val_best_f1_score: 0.8679; train_kl_reg_loss: 15328.5684; train_edge_recon_loss: 40039.5195; train_gene_expr_recon_loss: 965488.5417; train_masked_gp_l1_reg_loss: 7289.3881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38478.5382; train_chrom_access_recon_loss: 1351037.5833; train_global_loss: 2417662.1944; train_optim_loss: 2417662.1944; val_kl_reg_loss: 14159.7812; val_edge_recon_loss: 40294.3398; val_gene_expr_recon_loss: 941427.1875; val_masked_gp_l1_reg_loss: 7463.2983; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37402.6914; val_chrom_access_recon_loss: 1340331.2500; val_global_loss: 2381078.5000; val_optim_loss: 2381078.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9350; val_auprc_score: 0.9245; val_best_acc_score: 0.8614; val_best_f1_score: 0.8648; train_kl_reg_loss: 15220.5400; train_edge_recon_loss: 40009.1970; train_gene_expr_recon_loss: 955429.4097; train_masked_gp_l1_reg_loss: 7564.0366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36584.2765; train_chrom_access_recon_loss: 1347528.6944; train_global_loss: 2402336.1111; train_optim_loss: 2402336.1111; val_kl_reg_loss: 13980.2715; val_edge_recon_loss: 40237.6250; val_gene_expr_recon_loss: 937325.2500; val_masked_gp_l1_reg_loss: 7672.5029; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35584.9609; val_chrom_access_recon_loss: 1338106.3750; val_global_loss: 2372907.0000; val_optim_loss: 2372907.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9408; val_auprc_score: 0.9300; val_best_acc_score: 0.8723; val_best_f1_score: 0.8740; train_kl_reg_loss: 15244.4280; train_edge_recon_loss: 39998.0777; train_gene_expr_recon_loss: 952739.6458; train_masked_gp_l1_reg_loss: 7644.4742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35472.5469; train_chrom_access_recon_loss: 1347883.8333; train_global_loss: 2398983.0833; train_optim_loss: 2398983.0833; val_kl_reg_loss: 14061.0059; val_edge_recon_loss: 40231.7773; val_gene_expr_recon_loss: 936881.0625; val_masked_gp_l1_reg_loss: 7621.3408; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35336.1680; val_chrom_access_recon_loss: 1338608.8750; val_global_loss: 2372740.2500; val_optim_loss: 2372740.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9337; val_auprc_score: 0.9193; val_best_acc_score: 0.8620; val_best_f1_score: 0.8654; train_kl_reg_loss: 15358.4579; train_edge_recon_loss: 40007.2396; train_gene_expr_recon_loss: 957940.4097; train_masked_gp_l1_reg_loss: 7618.2726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35240.7153; train_chrom_access_recon_loss: 1347489.8889; train_global_loss: 2403654.9722; train_optim_loss: 2403654.9722; val_kl_reg_loss: 14104.7949; val_edge_recon_loss: 40241.4727; val_gene_expr_recon_loss: 936436.9375; val_masked_gp_l1_reg_loss: 7611.0049; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35120.6875; val_chrom_access_recon_loss: 1338624.3750; val_global_loss: 2372139.2500; val_optim_loss: 2372139.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9331; val_auprc_score: 0.9172; val_best_acc_score: 0.8624; val_best_f1_score: 0.8654; train_kl_reg_loss: 15326.7542; train_edge_recon_loss: 40006.5269; train_gene_expr_recon_loss: 957819.9236; train_masked_gp_l1_reg_loss: 7608.0617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35029.6311; train_chrom_access_recon_loss: 1353283.1806; train_global_loss: 2409074.0833; train_optim_loss: 2409074.0833; val_kl_reg_loss: 14065.8945; val_edge_recon_loss: 40235.8633; val_gene_expr_recon_loss: 935985.4375; val_masked_gp_l1_reg_loss: 7605.0122; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34917.4922; val_chrom_access_recon_loss: 1338329.6250; val_global_loss: 2371139.2500; val_optim_loss: 2371139.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9357; val_auprc_score: 0.9248; val_best_acc_score: 0.8653; val_best_f1_score: 0.8675; train_kl_reg_loss: 15295.9453; train_edge_recon_loss: 39994.1901; train_gene_expr_recon_loss: 955473.4375; train_masked_gp_l1_reg_loss: 7603.8010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34830.1289; train_chrom_access_recon_loss: 1352212.9861; train_global_loss: 2405410.5000; train_optim_loss: 2405410.5000; val_kl_reg_loss: 14061.5605; val_edge_recon_loss: 40232.6562; val_gene_expr_recon_loss: 935591.8750; val_masked_gp_l1_reg_loss: 7603.2334; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34723.8711; val_chrom_access_recon_loss: 1338016.3750; val_global_loss: 2370229.5000; val_optim_loss: 2370229.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9346
val AUPRC score: 0.9192
val best accuracy score: 0.8651
val best F1 score: 0.8726
val target rna MSE score: 3.6121
val source rna MSE score: 2.9893
val target atac MSE score: 0.1346
val source atac MSE score: 0.0196
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
