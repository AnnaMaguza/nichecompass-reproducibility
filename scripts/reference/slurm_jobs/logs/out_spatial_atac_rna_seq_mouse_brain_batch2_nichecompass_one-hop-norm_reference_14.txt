[True]
Run timestamp: 09102023_193019_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7778; val_auprc_score: 0.7963; val_best_acc_score: 0.5288; val_best_f1_score: 0.6779; train_kl_reg_loss: 52423.5269; train_edge_recon_loss: 3508202.1584; train_gene_expr_recon_loss: 13499879.6489; train_masked_gp_l1_reg_loss: 126702.0612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2791700.8302; train_chrom_access_recon_loss: 2271034.5086; train_global_loss: 22249942.7786; train_optim_loss: 22249942.7786; val_kl_reg_loss: 83326.4557; val_edge_recon_loss: 4063226.1667; val_gene_expr_recon_loss: 12881920.9333; val_masked_gp_l1_reg_loss: 110481.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 416136.4688; val_chrom_access_recon_loss: 2215356.3083; val_global_loss: 19770447.3333; val_optim_loss: 19770447.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7923; val_auprc_score: 0.8056; val_best_acc_score: 0.6915; val_best_f1_score: 0.7345; train_kl_reg_loss: 77095.5816; train_edge_recon_loss: 3498602.1813; train_gene_expr_recon_loss: 12614173.1908; train_masked_gp_l1_reg_loss: 106136.3262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 222177.5547; train_chrom_access_recon_loss: 2165227.6326; train_global_loss: 18683412.3817; train_optim_loss: 18683412.3817; val_kl_reg_loss: 68526.7604; val_edge_recon_loss: 3977135.0500; val_gene_expr_recon_loss: 12603398.5333; val_masked_gp_l1_reg_loss: 106457.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140364.3125; val_chrom_access_recon_loss: 2182350.7083; val_global_loss: 19078233.2000; val_optim_loss: 19078233.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8289; val_auprc_score: 0.8390; val_best_acc_score: 0.7312; val_best_f1_score: 0.7570; train_kl_reg_loss: 61087.7945; train_edge_recon_loss: 3269292.6240; train_gene_expr_recon_loss: 12525967.8397; train_masked_gp_l1_reg_loss: 122913.4318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122327.3691; train_chrom_access_recon_loss: 2143103.3645; train_global_loss: 18244692.4122; train_optim_loss: 18244692.4122; val_kl_reg_loss: 66213.4042; val_edge_recon_loss: 3125437.8000; val_gene_expr_recon_loss: 12555551.7333; val_masked_gp_l1_reg_loss: 131746.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112980.0078; val_chrom_access_recon_loss: 2167408.3000; val_global_loss: 18159338.1333; val_optim_loss: 18159338.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8359; val_auprc_score: 0.8334; val_best_acc_score: 0.7493; val_best_f1_score: 0.7592; train_kl_reg_loss: 78526.5952; train_edge_recon_loss: 3064878.1832; train_gene_expr_recon_loss: 12337605.7863; train_masked_gp_l1_reg_loss: 130184.9787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98576.5705; train_chrom_access_recon_loss: 2117835.2500; train_global_loss: 17827607.4046; train_optim_loss: 17827607.4046; val_kl_reg_loss: 84273.9901; val_edge_recon_loss: 3059915.3167; val_gene_expr_recon_loss: 12367179.7333; val_masked_gp_l1_reg_loss: 129199.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93523.4922; val_chrom_access_recon_loss: 2131328.3333; val_global_loss: 17865419.3333; val_optim_loss: 17865419.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8698; val_auprc_score: 0.8627; val_best_acc_score: 0.7922; val_best_f1_score: 0.7956; train_kl_reg_loss: 81150.9155; train_edge_recon_loss: 2977059.3931; train_gene_expr_recon_loss: 12209429.7176; train_masked_gp_l1_reg_loss: 128791.8905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91978.3021; train_chrom_access_recon_loss: 2098394.7700; train_global_loss: 17586804.9313; train_optim_loss: 17586804.9313; val_kl_reg_loss: 89285.5448; val_edge_recon_loss: 2959746.7000; val_gene_expr_recon_loss: 12285351.5333; val_masked_gp_l1_reg_loss: 128653.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89872.4219; val_chrom_access_recon_loss: 2122917.9500; val_global_loss: 17675826.9333; val_optim_loss: 17675826.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9277; val_auprc_score: 0.9148; val_best_acc_score: 0.8573; val_best_f1_score: 0.8650; train_kl_reg_loss: 80975.1650; train_edge_recon_loss: 2881976.2519; train_gene_expr_recon_loss: 12096578.3130; train_masked_gp_l1_reg_loss: 130962.9583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89583.6888; train_chrom_access_recon_loss: 2081043.4179; train_global_loss: 17361119.8473; train_optim_loss: 17361119.8473; val_kl_reg_loss: 83813.0432; val_edge_recon_loss: 2818844.2000; val_gene_expr_recon_loss: 12163645.4667; val_masked_gp_l1_reg_loss: 132837.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88431.0781; val_chrom_access_recon_loss: 2102892.1083; val_global_loss: 17390464.0667; val_optim_loss: 17390464.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9359; val_auprc_score: 0.9211; val_best_acc_score: 0.8692; val_best_f1_score: 0.8775; train_kl_reg_loss: 92131.8948; train_edge_recon_loss: 2789981.0324; train_gene_expr_recon_loss: 12012788.0305; train_masked_gp_l1_reg_loss: 133595.1224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86272.8287; train_chrom_access_recon_loss: 2069139.2576; train_global_loss: 17183908.1374; train_optim_loss: 17183908.1374; val_kl_reg_loss: 96337.2724; val_edge_recon_loss: 2786012.0000; val_gene_expr_recon_loss: 12063532.0667; val_masked_gp_l1_reg_loss: 133949.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84620.1562; val_chrom_access_recon_loss: 2090589.1667; val_global_loss: 17255039.5333; val_optim_loss: 17255039.5333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9407; val_auprc_score: 0.9269; val_best_acc_score: 0.8763; val_best_f1_score: 0.8823; train_kl_reg_loss: 93760.6390; train_edge_recon_loss: 2765084.5935; train_gene_expr_recon_loss: 11939894.7328; train_masked_gp_l1_reg_loss: 134218.1289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82885.6850; train_chrom_access_recon_loss: 2055469.5115; train_global_loss: 17071313.3282; train_optim_loss: 17071313.3282; val_kl_reg_loss: 94138.1391; val_edge_recon_loss: 2781272.8000; val_gene_expr_recon_loss: 11969625.4667; val_masked_gp_l1_reg_loss: 134637.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81867.5625; val_chrom_access_recon_loss: 2072890.9500; val_global_loss: 17134432.3333; val_optim_loss: 17134432.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9455; val_auprc_score: 0.9319; val_best_acc_score: 0.8871; val_best_f1_score: 0.8914; train_kl_reg_loss: 92631.0287; train_edge_recon_loss: 2747694.1107; train_gene_expr_recon_loss: 11861968.5344; train_masked_gp_l1_reg_loss: 134346.2369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80192.9590; train_chrom_access_recon_loss: 2040795.1431; train_global_loss: 16957628.0382; train_optim_loss: 16957628.0382; val_kl_reg_loss: 91543.5411; val_edge_recon_loss: 2771638.5167; val_gene_expr_recon_loss: 11937551.0667; val_masked_gp_l1_reg_loss: 134664.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79256.3594; val_chrom_access_recon_loss: 2063665.3167; val_global_loss: 17078318.4667; val_optim_loss: 17078318.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9501; val_auprc_score: 0.9359; val_best_acc_score: 0.8919; val_best_f1_score: 0.8959; train_kl_reg_loss: 91634.9918; train_edge_recon_loss: 2741258.1527; train_gene_expr_recon_loss: 11803477.4656; train_masked_gp_l1_reg_loss: 134415.8404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78358.1159; train_chrom_access_recon_loss: 2029959.8874; train_global_loss: 16879104.5496; train_optim_loss: 16879104.5496; val_kl_reg_loss: 92755.8797; val_edge_recon_loss: 2744227.8667; val_gene_expr_recon_loss: 11825332.0667; val_masked_gp_l1_reg_loss: 134600.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77711.5000; val_chrom_access_recon_loss: 2043161.8333; val_global_loss: 16917790.0000; val_optim_loss: 16917790.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9556; val_auprc_score: 0.9446; val_best_acc_score: 0.8965; val_best_f1_score: 0.9010; train_kl_reg_loss: 90255.9951; train_edge_recon_loss: 2737774.7347; train_gene_expr_recon_loss: 11752036.3053; train_masked_gp_l1_reg_loss: 134183.5323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76848.3047; train_chrom_access_recon_loss: 2021742.8884; train_global_loss: 16812841.7786; train_optim_loss: 16812841.7786; val_kl_reg_loss: 90747.6297; val_edge_recon_loss: 2735438.2000; val_gene_expr_recon_loss: 11795373.5333; val_masked_gp_l1_reg_loss: 134454.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76232.9219; val_chrom_access_recon_loss: 2041459.0250; val_global_loss: 16873706.3333; val_optim_loss: 16873706.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9558; val_auprc_score: 0.9443; val_best_acc_score: 0.8961; val_best_f1_score: 0.9007; train_kl_reg_loss: 89046.4906; train_edge_recon_loss: 2739458.1489; train_gene_expr_recon_loss: 11705818.4809; train_masked_gp_l1_reg_loss: 133873.0580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75810.1248; train_chrom_access_recon_loss: 2012565.6584; train_global_loss: 16756571.9618; train_optim_loss: 16756571.9618; val_kl_reg_loss: 88040.9495; val_edge_recon_loss: 2745777.0167; val_gene_expr_recon_loss: 11798023.2667; val_masked_gp_l1_reg_loss: 133671.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75561.3750; val_chrom_access_recon_loss: 2031865.6750; val_global_loss: 16872939.8667; val_optim_loss: 16872939.8667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9541; val_auprc_score: 0.9435; val_best_acc_score: 0.8987; val_best_f1_score: 0.9038; train_kl_reg_loss: 88074.4542; train_edge_recon_loss: 2733367.5954; train_gene_expr_recon_loss: 11657847.9847; train_masked_gp_l1_reg_loss: 133320.1434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75505.6783; train_chrom_access_recon_loss: 2004631.6794; train_global_loss: 16692747.4809; train_optim_loss: 16692747.4809; val_kl_reg_loss: 89916.5828; val_edge_recon_loss: 2745878.9500; val_gene_expr_recon_loss: 11761344.1333; val_masked_gp_l1_reg_loss: 133139.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75605.8516; val_chrom_access_recon_loss: 2040453.3083; val_global_loss: 16846337.8667; val_optim_loss: 16846337.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9591; val_auprc_score: 0.9476; val_best_acc_score: 0.9025; val_best_f1_score: 0.9059; train_kl_reg_loss: 86034.6384; train_edge_recon_loss: 2729113.4313; train_gene_expr_recon_loss: 11607835.2519; train_masked_gp_l1_reg_loss: 132946.8752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76269.7651; train_chrom_access_recon_loss: 1995134.4036; train_global_loss: 16627334.3511; train_optim_loss: 16627334.3511; val_kl_reg_loss: 84669.7599; val_edge_recon_loss: 2728300.4000; val_gene_expr_recon_loss: 11706703.6667; val_masked_gp_l1_reg_loss: 132666.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77113.1250; val_chrom_access_recon_loss: 2026654.6917; val_global_loss: 16756107.3333; val_optim_loss: 16756107.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9597; val_auprc_score: 0.9489; val_best_acc_score: 0.9066; val_best_f1_score: 0.9099; train_kl_reg_loss: 86639.4815; train_edge_recon_loss: 2718333.7271; train_gene_expr_recon_loss: 11581359.9313; train_masked_gp_l1_reg_loss: 132332.2219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77185.2476; train_chrom_access_recon_loss: 1991891.3254; train_global_loss: 16587741.9160; train_optim_loss: 16587741.9160; val_kl_reg_loss: 86985.2635; val_edge_recon_loss: 2729807.4333; val_gene_expr_recon_loss: 11624139.0000; val_masked_gp_l1_reg_loss: 132365.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77803.0859; val_chrom_access_recon_loss: 2014525.8500; val_global_loss: 16665625.6667; val_optim_loss: 16665625.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9623; val_auprc_score: 0.9521; val_best_acc_score: 0.9077; val_best_f1_score: 0.9106; train_kl_reg_loss: 84123.3770; train_edge_recon_loss: 2728694.7576; train_gene_expr_recon_loss: 11542907.1908; train_masked_gp_l1_reg_loss: 131687.8808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77534.8993; train_chrom_access_recon_loss: 1984386.1403; train_global_loss: 16549334.2595; train_optim_loss: 16549334.2595; val_kl_reg_loss: 85477.9349; val_edge_recon_loss: 2736385.4500; val_gene_expr_recon_loss: 11616023.9333; val_masked_gp_l1_reg_loss: 131012.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77458.1719; val_chrom_access_recon_loss: 2004805.9167; val_global_loss: 16651164.0000; val_optim_loss: 16651164.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9610; val_auprc_score: 0.9486; val_best_acc_score: 0.9065; val_best_f1_score: 0.9095; train_kl_reg_loss: 82918.3882; train_edge_recon_loss: 2720935.2271; train_gene_expr_recon_loss: 11513573.6107; train_masked_gp_l1_reg_loss: 130843.9945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77445.1779; train_chrom_access_recon_loss: 1978618.1861; train_global_loss: 16504334.5954; train_optim_loss: 16504334.5954; val_kl_reg_loss: 84633.2370; val_edge_recon_loss: 2740666.1833; val_gene_expr_recon_loss: 11570103.0667; val_masked_gp_l1_reg_loss: 130573.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77614.7344; val_chrom_access_recon_loss: 1998970.4250; val_global_loss: 16602560.9333; val_optim_loss: 16602560.9333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9648; val_auprc_score: 0.9564; val_best_acc_score: 0.9120; val_best_f1_score: 0.9153; train_kl_reg_loss: 84931.4187; train_edge_recon_loss: 2715730.8550; train_gene_expr_recon_loss: 11481712.2137; train_masked_gp_l1_reg_loss: 130331.7905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76954.4686; train_chrom_access_recon_loss: 1971621.0143; train_global_loss: 16461281.7252; train_optim_loss: 16461281.7252; val_kl_reg_loss: 82809.1000; val_edge_recon_loss: 2737174.2333; val_gene_expr_recon_loss: 11547238.2667; val_masked_gp_l1_reg_loss: 129665.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76673.9062; val_chrom_access_recon_loss: 1997032.4250; val_global_loss: 16570593.6000; val_optim_loss: 16570593.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9633; val_auprc_score: 0.9510; val_best_acc_score: 0.9093; val_best_f1_score: 0.9134; train_kl_reg_loss: 84243.5433; train_edge_recon_loss: 2713891.9351; train_gene_expr_recon_loss: 11462644.8779; train_masked_gp_l1_reg_loss: 129291.2396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76296.9836; train_chrom_access_recon_loss: 1969211.9637; train_global_loss: 16435580.5267; train_optim_loss: 16435580.5267; val_kl_reg_loss: 86249.0229; val_edge_recon_loss: 2722254.1000; val_gene_expr_recon_loss: 11549010.0000; val_masked_gp_l1_reg_loss: 129494.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76748.6641; val_chrom_access_recon_loss: 1995944.5917; val_global_loss: 16559701.8000; val_optim_loss: 16559701.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9683; val_auprc_score: 0.9623; val_best_acc_score: 0.9155; val_best_f1_score: 0.9175; train_kl_reg_loss: 83461.1090; train_edge_recon_loss: 2711923.1698; train_gene_expr_recon_loss: 11440876.8015; train_masked_gp_l1_reg_loss: 128770.8437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76032.0131; train_chrom_access_recon_loss: 1962819.4857; train_global_loss: 16403883.3893; train_optim_loss: 16403883.3893; val_kl_reg_loss: 85248.1219; val_edge_recon_loss: 2711979.6500; val_gene_expr_recon_loss: 11513277.2667; val_masked_gp_l1_reg_loss: 128461.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76399.0156; val_chrom_access_recon_loss: 1987503.6667; val_global_loss: 16502869.7333; val_optim_loss: 16502869.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9683; val_auprc_score: 0.9615; val_best_acc_score: 0.9117; val_best_f1_score: 0.9157; train_kl_reg_loss: 83401.8053; train_edge_recon_loss: 2704621.0095; train_gene_expr_recon_loss: 11419689.2137; train_masked_gp_l1_reg_loss: 128301.7505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75919.8788; train_chrom_access_recon_loss: 1959751.2281; train_global_loss: 16371684.9237; train_optim_loss: 16371684.9237; val_kl_reg_loss: 83036.0057; val_edge_recon_loss: 2724181.4500; val_gene_expr_recon_loss: 11522058.5333; val_masked_gp_l1_reg_loss: 128499.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76518.2734; val_chrom_access_recon_loss: 1988431.3500; val_global_loss: 16522725.2000; val_optim_loss: 16522725.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9652; val_auprc_score: 0.9565; val_best_acc_score: 0.9138; val_best_f1_score: 0.9175; train_kl_reg_loss: 83279.9513; train_edge_recon_loss: 2698011.0821; train_gene_expr_recon_loss: 11403043.0534; train_masked_gp_l1_reg_loss: 128005.9905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75805.7183; train_chrom_access_recon_loss: 1958266.5372; train_global_loss: 16346412.2519; train_optim_loss: 16346412.2519; val_kl_reg_loss: 84954.0068; val_edge_recon_loss: 2715985.0000; val_gene_expr_recon_loss: 11468366.4667; val_masked_gp_l1_reg_loss: 127438.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75792.3125; val_chrom_access_recon_loss: 1977853.0667; val_global_loss: 16450389.6000; val_optim_loss: 16450389.6000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9683; val_auprc_score: 0.9562; val_best_acc_score: 0.9196; val_best_f1_score: 0.9233; train_kl_reg_loss: 83977.5541; train_edge_recon_loss: 2699741.6107; train_gene_expr_recon_loss: 11382593.3511; train_masked_gp_l1_reg_loss: 127060.2598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75580.6323; train_chrom_access_recon_loss: 1950619.1460; train_global_loss: 16319572.6260; train_optim_loss: 16319572.6260; val_kl_reg_loss: 82256.8375; val_edge_recon_loss: 2724382.2500; val_gene_expr_recon_loss: 11480373.4000; val_masked_gp_l1_reg_loss: 126640.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75340.1094; val_chrom_access_recon_loss: 1985747.4667; val_global_loss: 16474739.9333; val_optim_loss: 16474739.9333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9700; val_auprc_score: 0.9605; val_best_acc_score: 0.9235; val_best_f1_score: 0.9264; train_kl_reg_loss: 82454.0271; train_edge_recon_loss: 2705132.3435; train_gene_expr_recon_loss: 11359525.7405; train_masked_gp_l1_reg_loss: 126410.4408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75503.8780; train_chrom_access_recon_loss: 1948028.9170; train_global_loss: 16297055.2443; train_optim_loss: 16297055.2443; val_kl_reg_loss: 83624.0068; val_edge_recon_loss: 2693429.8833; val_gene_expr_recon_loss: 11461317.1333; val_masked_gp_l1_reg_loss: 125948.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75150.1797; val_chrom_access_recon_loss: 1981691.8667; val_global_loss: 16421161.9333; val_optim_loss: 16421161.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9711; val_auprc_score: 0.9621; val_best_acc_score: 0.9250; val_best_f1_score: 0.9272; train_kl_reg_loss: 81301.2524; train_edge_recon_loss: 2698350.3034; train_gene_expr_recon_loss: 11346190.5267; train_masked_gp_l1_reg_loss: 125932.3540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75713.6439; train_chrom_access_recon_loss: 1944055.3912; train_global_loss: 16271543.4656; train_optim_loss: 16271543.4656; val_kl_reg_loss: 81753.1453; val_edge_recon_loss: 2709691.5500; val_gene_expr_recon_loss: 11502122.4667; val_masked_gp_l1_reg_loss: 125711.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75948.4219; val_chrom_access_recon_loss: 1983720.8583; val_global_loss: 16478948.3333; val_optim_loss: 16478948.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9652; val_auprc_score: 0.9550; val_best_acc_score: 0.9104; val_best_f1_score: 0.9139; train_kl_reg_loss: 101045.1643; train_edge_recon_loss: 2793031.0401; train_gene_expr_recon_loss: 10283538.6412; train_masked_gp_l1_reg_loss: 123807.4953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73421.3498; train_chrom_access_recon_loss: 1782561.1250; train_global_loss: 15157404.9084; train_optim_loss: 15157404.9084; val_kl_reg_loss: 32197.3527; val_edge_recon_loss: 2776899.4167; val_gene_expr_recon_loss: 10371774.4667; val_masked_gp_l1_reg_loss: 123116.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75188.1953; val_chrom_access_recon_loss: 1804452.3833; val_global_loss: 15183627.6000; val_optim_loss: 15183627.6000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9662; val_auprc_score: 0.9579; val_best_acc_score: 0.9127; val_best_f1_score: 0.9152; train_kl_reg_loss: 80623.0939; train_edge_recon_loss: 2726447.8588; train_gene_expr_recon_loss: 10222064.8931; train_masked_gp_l1_reg_loss: 121540.1582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75210.7972; train_chrom_access_recon_loss: 1772040.1613; train_global_loss: 14997926.9618; train_optim_loss: 14997926.9618; val_kl_reg_loss: 40488.9750; val_edge_recon_loss: 2720131.2000; val_gene_expr_recon_loss: 10234208.4667; val_masked_gp_l1_reg_loss: 119672.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75751.3906; val_chrom_access_recon_loss: 1790317.1417; val_global_loss: 14980568.8000; val_optim_loss: 14980568.8000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9693; val_auprc_score: 0.9608; val_best_acc_score: 0.9151; val_best_f1_score: 0.9181; train_kl_reg_loss: 71972.9037; train_edge_recon_loss: 2715628.6355; train_gene_expr_recon_loss: 10184988.5496; train_masked_gp_l1_reg_loss: 117345.6036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76008.5005; train_chrom_access_recon_loss: 1769663.7204; train_global_loss: 14935607.8550; train_optim_loss: 14935607.8550; val_kl_reg_loss: 44235.2383; val_edge_recon_loss: 2710570.8167; val_gene_expr_recon_loss: 10229155.2667; val_masked_gp_l1_reg_loss: 115114.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75846.6562; val_chrom_access_recon_loss: 1790947.0417; val_global_loss: 14965870.2000; val_optim_loss: 14965870.2000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9705; val_auprc_score: 0.9644; val_best_acc_score: 0.9144; val_best_f1_score: 0.9180; train_kl_reg_loss: 68744.7810; train_edge_recon_loss: 2704347.8969; train_gene_expr_recon_loss: 10158230.4351; train_masked_gp_l1_reg_loss: 113120.7602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75999.7399; train_chrom_access_recon_loss: 1765945.6317; train_global_loss: 14886389.3206; train_optim_loss: 14886389.3206; val_kl_reg_loss: 49017.0000; val_edge_recon_loss: 2707033.0000; val_gene_expr_recon_loss: 10248244.0000; val_masked_gp_l1_reg_loss: 111309.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76107.8203; val_chrom_access_recon_loss: 1790238.0250; val_global_loss: 14981949.0667; val_optim_loss: 14981949.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9692; val_auprc_score: 0.9623; val_best_acc_score: 0.9165; val_best_f1_score: 0.9192; train_kl_reg_loss: 65537.3740; train_edge_recon_loss: 2696574.6889; train_gene_expr_recon_loss: 10143940.3282; train_masked_gp_l1_reg_loss: 109586.4868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75827.2171; train_chrom_access_recon_loss: 1763905.3569; train_global_loss: 14855371.4427; train_optim_loss: 14855371.4427; val_kl_reg_loss: 51670.5625; val_edge_recon_loss: 2700066.2167; val_gene_expr_recon_loss: 10230517.8667; val_masked_gp_l1_reg_loss: 108170.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75909.5703; val_chrom_access_recon_loss: 1784393.8000; val_global_loss: 14950729.4000; val_optim_loss: 14950729.4000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9717; val_auprc_score: 0.9648; val_best_acc_score: 0.9188; val_best_f1_score: 0.9214; train_kl_reg_loss: 64203.7892; train_edge_recon_loss: 2703222.7844; train_gene_expr_recon_loss: 10138927.1603; train_masked_gp_l1_reg_loss: 106843.0825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75536.3875; train_chrom_access_recon_loss: 1762516.7261; train_global_loss: 14851249.9084; train_optim_loss: 14851249.9084; val_kl_reg_loss: 54375.5521; val_edge_recon_loss: 2703981.4000; val_gene_expr_recon_loss: 10201772.3333; val_masked_gp_l1_reg_loss: 105627.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75356.2656; val_chrom_access_recon_loss: 1792857.1917; val_global_loss: 14933969.6667; val_optim_loss: 14933969.6667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9736; val_auprc_score: 0.9627; val_best_acc_score: 0.9223; val_best_f1_score: 0.9255; train_kl_reg_loss: 62931.0781; train_edge_recon_loss: 2691235.6908; train_gene_expr_recon_loss: 10109273.1756; train_masked_gp_l1_reg_loss: 104637.9396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75222.2631; train_chrom_access_recon_loss: 1757736.9800; train_global_loss: 14801037.0382; train_optim_loss: 14801037.0382; val_kl_reg_loss: 52077.8201; val_edge_recon_loss: 2678057.5667; val_gene_expr_recon_loss: 10216650.6667; val_masked_gp_l1_reg_loss: 103857.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74905.1641; val_chrom_access_recon_loss: 1784541.8583; val_global_loss: 14910091.0000; val_optim_loss: 14910091.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9745; val_auprc_score: 0.9640; val_best_acc_score: 0.9254; val_best_f1_score: 0.9276; train_kl_reg_loss: 63251.2374; train_edge_recon_loss: 2690233.0172; train_gene_expr_recon_loss: 10090799.9847; train_masked_gp_l1_reg_loss: 102991.7675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74873.2800; train_chrom_access_recon_loss: 1754142.1899; train_global_loss: 14776291.5725; train_optim_loss: 14776291.5725; val_kl_reg_loss: 53881.6232; val_edge_recon_loss: 2691609.4167; val_gene_expr_recon_loss: 10205648.3333; val_masked_gp_l1_reg_loss: 102099.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74763.3906; val_chrom_access_recon_loss: 1785131.4917; val_global_loss: 14913134.0000; val_optim_loss: 14913134.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9712; val_auprc_score: 0.9635; val_best_acc_score: 0.9196; val_best_f1_score: 0.9224; train_kl_reg_loss: 62819.9030; train_edge_recon_loss: 2683575.4332; train_gene_expr_recon_loss: 10068906.3588; train_masked_gp_l1_reg_loss: 101229.0890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74677.5522; train_chrom_access_recon_loss: 1749709.2987; train_global_loss: 14740917.5191; train_optim_loss: 14740917.5191; val_kl_reg_loss: 52748.7586; val_edge_recon_loss: 2699853.6667; val_gene_expr_recon_loss: 10135275.9333; val_masked_gp_l1_reg_loss: 100375.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74684.4766; val_chrom_access_recon_loss: 1773596.3750; val_global_loss: 14836533.8667; val_optim_loss: 14836533.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9758; val_auprc_score: 0.9709; val_best_acc_score: 0.9243; val_best_f1_score: 0.9267; train_kl_reg_loss: 62608.2566; train_edge_recon_loss: 2681437.1546; train_gene_expr_recon_loss: 10055763.2366; train_masked_gp_l1_reg_loss: 99676.1431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74566.2043; train_chrom_access_recon_loss: 1747082.1813; train_global_loss: 14721133.1985; train_optim_loss: 14721133.1985; val_kl_reg_loss: 55281.8102; val_edge_recon_loss: 2687939.7833; val_gene_expr_recon_loss: 10139366.8000; val_masked_gp_l1_reg_loss: 99118.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74208.5156; val_chrom_access_recon_loss: 1773179.9333; val_global_loss: 14829096.2000; val_optim_loss: 14829096.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9760; val_auprc_score: 0.9688; val_best_acc_score: 0.9281; val_best_f1_score: 0.9300; train_kl_reg_loss: 63609.9963; train_edge_recon_loss: 2673965.6011; train_gene_expr_recon_loss: 10042700.3893; train_masked_gp_l1_reg_loss: 98358.0866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74533.7010; train_chrom_access_recon_loss: 1744298.2929; train_global_loss: 14697466.0000; train_optim_loss: 14697466.0000; val_kl_reg_loss: 58503.7435; val_edge_recon_loss: 2676929.1500; val_gene_expr_recon_loss: 10117138.1333; val_masked_gp_l1_reg_loss: 97684.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74575.8203; val_chrom_access_recon_loss: 1774959.2333; val_global_loss: 14799790.2667; val_optim_loss: 14799790.2667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9744; val_auprc_score: 0.9622; val_best_acc_score: 0.9264; val_best_f1_score: 0.9284; train_kl_reg_loss: 63369.6781; train_edge_recon_loss: 2673049.2958; train_gene_expr_recon_loss: 10033558.5573; train_masked_gp_l1_reg_loss: 96967.1533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74290.2393; train_chrom_access_recon_loss: 1739392.4695; train_global_loss: 14680627.3053; train_optim_loss: 14680627.3053; val_kl_reg_loss: 59183.9005; val_edge_recon_loss: 2690068.1167; val_gene_expr_recon_loss: 10143251.2000; val_masked_gp_l1_reg_loss: 96572.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74339.0078; val_chrom_access_recon_loss: 1771937.4917; val_global_loss: 14835351.5333; val_optim_loss: 14835351.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9721; val_auprc_score: 0.9646; val_best_acc_score: 0.9220; val_best_f1_score: 0.9250; train_kl_reg_loss: 62498.9717; train_edge_recon_loss: 2678100.3912; train_gene_expr_recon_loss: 10018831.0076; train_masked_gp_l1_reg_loss: 96042.4922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74104.9464; train_chrom_access_recon_loss: 1736730.9800; train_global_loss: 14666308.8550; train_optim_loss: 14666308.8550; val_kl_reg_loss: 59277.5492; val_edge_recon_loss: 2696007.6667; val_gene_expr_recon_loss: 10106936.6000; val_masked_gp_l1_reg_loss: 95618.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73918.6328; val_chrom_access_recon_loss: 1757966.1083; val_global_loss: 14789726.0000; val_optim_loss: 14789726.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9728; val_auprc_score: 0.9657; val_best_acc_score: 0.9221; val_best_f1_score: 0.9254; train_kl_reg_loss: 62623.4795; train_edge_recon_loss: 2680492.3645; train_gene_expr_recon_loss: 9999457.3130; train_masked_gp_l1_reg_loss: 95216.7666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74021.3187; train_chrom_access_recon_loss: 1730723.5906; train_global_loss: 14642534.9160; train_optim_loss: 14642534.9160; val_kl_reg_loss: 58949.8091; val_edge_recon_loss: 2709615.9167; val_gene_expr_recon_loss: 10103882.0667; val_masked_gp_l1_reg_loss: 94600.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74079.5000; val_chrom_access_recon_loss: 1752407.5000; val_global_loss: 14793535.5333; val_optim_loss: 14793535.5333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9753; val_auprc_score: 0.9647; val_best_acc_score: 0.9290; val_best_f1_score: 0.9316; train_kl_reg_loss: 63058.7897; train_edge_recon_loss: 2677959.4943; train_gene_expr_recon_loss: 9992666.9771; train_masked_gp_l1_reg_loss: 94357.5227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74046.6367; train_chrom_access_recon_loss: 1729803.1870; train_global_loss: 14631892.6107; train_optim_loss: 14631892.6107; val_kl_reg_loss: 58788.5898; val_edge_recon_loss: 2677533.3833; val_gene_expr_recon_loss: 10026844.1333; val_masked_gp_l1_reg_loss: 93989.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74076.0938; val_chrom_access_recon_loss: 1738991.3833; val_global_loss: 14670223.4667; val_optim_loss: 14670223.4667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9776; val_auprc_score: 0.9712; val_best_acc_score: 0.9351; val_best_f1_score: 0.9372; train_kl_reg_loss: 60770.7506; train_edge_recon_loss: 2677397.8721; train_gene_expr_recon_loss: 9987308.2748; train_masked_gp_l1_reg_loss: 93699.8344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74067.0286; train_chrom_access_recon_loss: 1726481.2929; train_global_loss: 14619725.0076; train_optim_loss: 14619725.0076; val_kl_reg_loss: 58487.0570; val_edge_recon_loss: 2685049.2333; val_gene_expr_recon_loss: 10075861.5333; val_masked_gp_l1_reg_loss: 93412.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74277.5234; val_chrom_access_recon_loss: 1753307.2333; val_global_loss: 14740396.0000; val_optim_loss: 14740396.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9740; val_auprc_score: 0.9669; val_best_acc_score: 0.9305; val_best_f1_score: 0.9328; train_kl_reg_loss: 61442.8576; train_edge_recon_loss: 2678410.6985; train_gene_expr_recon_loss: 9974225.1908; train_masked_gp_l1_reg_loss: 93057.3667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74131.4252; train_chrom_access_recon_loss: 1724142.2471; train_global_loss: 14605409.7939; train_optim_loss: 14605409.7939; val_kl_reg_loss: 60147.3701; val_edge_recon_loss: 2684689.4333; val_gene_expr_recon_loss: 10042872.1333; val_masked_gp_l1_reg_loss: 92787.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74224.5312; val_chrom_access_recon_loss: 1740255.2583; val_global_loss: 14694976.0000; val_optim_loss: 14694976.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9759; val_auprc_score: 0.9642; val_best_acc_score: 0.9307; val_best_f1_score: 0.9329; train_kl_reg_loss: 62481.6979; train_edge_recon_loss: 2683665.9408; train_gene_expr_recon_loss: 9958783.6183; train_masked_gp_l1_reg_loss: 92328.1339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73991.2238; train_chrom_access_recon_loss: 1720571.4179; train_global_loss: 14591822.0687; train_optim_loss: 14591822.0687; val_kl_reg_loss: 59022.7685; val_edge_recon_loss: 2687492.1000; val_gene_expr_recon_loss: 10059757.4667; val_masked_gp_l1_reg_loss: 92106.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74325.3984; val_chrom_access_recon_loss: 1751678.6167; val_global_loss: 14724382.9333; val_optim_loss: 14724382.9333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9743; val_auprc_score: 0.9625; val_best_acc_score: 0.9294; val_best_f1_score: 0.9314; train_kl_reg_loss: 62315.2831; train_edge_recon_loss: 2675027.5573; train_gene_expr_recon_loss: 9958624.9771; train_masked_gp_l1_reg_loss: 91785.9757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74000.4755; train_chrom_access_recon_loss: 1721234.8635; train_global_loss: 14582989.1145; train_optim_loss: 14582989.1145; val_kl_reg_loss: 60067.1083; val_edge_recon_loss: 2684586.1833; val_gene_expr_recon_loss: 10057684.0000; val_masked_gp_l1_reg_loss: 91681.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73417.9062; val_chrom_access_recon_loss: 1749931.6917; val_global_loss: 14717368.0000; val_optim_loss: 14717368.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9749; val_auprc_score: 0.9658; val_best_acc_score: 0.9278; val_best_f1_score: 0.9303; train_kl_reg_loss: 63384.1201; train_edge_recon_loss: 2674030.7443; train_gene_expr_recon_loss: 9942428.7863; train_masked_gp_l1_reg_loss: 88619.7756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59476.7005; train_chrom_access_recon_loss: 1719206.3922; train_global_loss: 14547146.4885; train_optim_loss: 14547146.4885; val_kl_reg_loss: 60496.3466; val_edge_recon_loss: 2692012.9333; val_gene_expr_recon_loss: 9996989.8667; val_masked_gp_l1_reg_loss: 88087.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57717.1328; val_chrom_access_recon_loss: 1736351.0833; val_global_loss: 14631655.3333; val_optim_loss: 14631655.3333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9746; val_auprc_score: 0.9660; val_best_acc_score: 0.9266; val_best_f1_score: 0.9291; train_kl_reg_loss: 64842.3411; train_edge_recon_loss: 2667209.8836; train_gene_expr_recon_loss: 9939906.1527; train_masked_gp_l1_reg_loss: 87962.8885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57392.3705; train_chrom_access_recon_loss: 1718833.6536; train_global_loss: 14536147.2595; train_optim_loss: 14536147.2595; val_kl_reg_loss: 61738.0216; val_edge_recon_loss: 2700903.5667; val_gene_expr_recon_loss: 10015580.9333; val_masked_gp_l1_reg_loss: 87871.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57119.1797; val_chrom_access_recon_loss: 1738882.1917; val_global_loss: 14662094.4667; val_optim_loss: 14662094.4667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9765; val_auprc_score: 0.9678; val_best_acc_score: 0.9317; val_best_f1_score: 0.9332; train_kl_reg_loss: 65201.3070; train_edge_recon_loss: 2667358.9809; train_gene_expr_recon_loss: 9915726.2977; train_masked_gp_l1_reg_loss: 87764.9195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56902.8875; train_chrom_access_recon_loss: 1715735.4189; train_global_loss: 14508689.8092; train_optim_loss: 14508689.8092; val_kl_reg_loss: 61072.8310; val_edge_recon_loss: 2678114.6667; val_gene_expr_recon_loss: 10033921.5333; val_masked_gp_l1_reg_loss: 87697.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56655.3633; val_chrom_access_recon_loss: 1738620.2750; val_global_loss: 14656082.1333; val_optim_loss: 14656082.1333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9776; val_auprc_score: 0.9727; val_best_acc_score: 0.9290; val_best_f1_score: 0.9306; train_kl_reg_loss: 64802.1851; train_edge_recon_loss: 2671953.3321; train_gene_expr_recon_loss: 9925048.1832; train_masked_gp_l1_reg_loss: 87635.6887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56508.0152; train_chrom_access_recon_loss: 1716258.2739; train_global_loss: 14522205.7328; train_optim_loss: 14522205.7328; val_kl_reg_loss: 61387.2750; val_edge_recon_loss: 2700799.7833; val_gene_expr_recon_loss: 10039105.6667; val_masked_gp_l1_reg_loss: 87569.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56313.6523; val_chrom_access_recon_loss: 1749143.7833; val_global_loss: 14694320.5333; val_optim_loss: 14694320.5333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9769; val_auprc_score: 0.9709; val_best_acc_score: 0.9307; val_best_f1_score: 0.9329; train_kl_reg_loss: 65086.5991; train_edge_recon_loss: 2679245.7996; train_gene_expr_recon_loss: 9922493.1374; train_masked_gp_l1_reg_loss: 87501.4710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56195.2146; train_chrom_access_recon_loss: 1714630.4475; train_global_loss: 14525152.6870; train_optim_loss: 14525152.6870; val_kl_reg_loss: 62082.0755; val_edge_recon_loss: 2683213.7167; val_gene_expr_recon_loss: 10049052.8667; val_masked_gp_l1_reg_loss: 87441.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55982.0195; val_chrom_access_recon_loss: 1751905.3667; val_global_loss: 14689677.8667; val_optim_loss: 14689677.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9752; val_auprc_score: 0.9669; val_best_acc_score: 0.9274; val_best_f1_score: 0.9299; train_kl_reg_loss: 64833.4994; train_edge_recon_loss: 2667415.7920; train_gene_expr_recon_loss: 9922274.5496; train_masked_gp_l1_reg_loss: 87125.0674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54489.2185; train_chrom_access_recon_loss: 1715227.3216; train_global_loss: 14511365.4580; train_optim_loss: 14511365.4580; val_kl_reg_loss: 62074.6716; val_edge_recon_loss: 2691379.9000; val_gene_expr_recon_loss: 10021663.0667; val_masked_gp_l1_reg_loss: 87058.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54305.2734; val_chrom_access_recon_loss: 1749777.3417; val_global_loss: 14666257.8667; val_optim_loss: 14666257.8667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9747; val_auprc_score: 0.9659; val_best_acc_score: 0.9274; val_best_f1_score: 0.9288; train_kl_reg_loss: 65022.1674; train_edge_recon_loss: 2666661.1431; train_gene_expr_recon_loss: 9919352.3588; train_masked_gp_l1_reg_loss: 87040.6880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54262.5441; train_chrom_access_recon_loss: 1715036.8225; train_global_loss: 14507375.6565; train_optim_loss: 14507375.6565; val_kl_reg_loss: 62278.9659; val_edge_recon_loss: 2691779.0833; val_gene_expr_recon_loss: 10009544.3333; val_masked_gp_l1_reg_loss: 87021.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54213.5430; val_chrom_access_recon_loss: 1737035.5000; val_global_loss: 14641873.0667; val_optim_loss: 14641873.0667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9777; val_auprc_score: 0.9712; val_best_acc_score: 0.9357; val_best_f1_score: 0.9372; train_kl_reg_loss: 65139.7831; train_edge_recon_loss: 2668743.5859; train_gene_expr_recon_loss: 9910448.2061; train_masked_gp_l1_reg_loss: 87010.7146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54178.2131; train_chrom_access_recon_loss: 1712865.0916; train_global_loss: 14498385.6107; train_optim_loss: 14498385.6107; val_kl_reg_loss: 62167.1031; val_edge_recon_loss: 2689075.2833; val_gene_expr_recon_loss: 10045573.6000; val_masked_gp_l1_reg_loss: 86999.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54147.5703; val_chrom_access_recon_loss: 1746465.8750; val_global_loss: 14684428.9333; val_optim_loss: 14684428.9333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9775; val_auprc_score: 0.9698; val_best_acc_score: 0.9305; val_best_f1_score: 0.9326; train_kl_reg_loss: 65134.8756; train_edge_recon_loss: 2665052.5897; train_gene_expr_recon_loss: 9920074.3206; train_masked_gp_l1_reg_loss: 86991.0411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54127.2431; train_chrom_access_recon_loss: 1714147.2137; train_global_loss: 14505527.2977; train_optim_loss: 14505527.2977; val_kl_reg_loss: 62298.9581; val_edge_recon_loss: 2698269.7000; val_gene_expr_recon_loss: 10036491.9333; val_masked_gp_l1_reg_loss: 86982.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54100.1797; val_chrom_access_recon_loss: 1740677.7083; val_global_loss: 14678820.2000; val_optim_loss: 14678820.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 49 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9773
val AUPRC score: 0.9717
val best accuracy score: 0.9303
val best F1 score: 0.9322
val target rna MSE score: 2.3170
val source rna MSE score: 0.5778
val target atac MSE score: 0.3496
val source atac MSE score: 0.1065
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
