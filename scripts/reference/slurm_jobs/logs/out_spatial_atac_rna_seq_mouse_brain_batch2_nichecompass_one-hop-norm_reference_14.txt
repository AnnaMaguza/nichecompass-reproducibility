[True]
Run timestamp: 10082023_124146_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2602, n_latent: 2602, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7577; val_auprc_score: 0.7768; val_best_acc_score: 0.5509; val_best_f1_score: 0.6872; train_kl_reg_loss: 103601.7788; train_edge_recon_loss: 3581895.0840; train_gene_expr_recon_loss: 9483406.9580; train_masked_gp_l1_reg_loss: 73220.7285; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1569177.6069; train_global_loss: 14811302.1527; train_optim_loss: 14811302.1527; val_kl_reg_loss: 86039.9677; val_edge_recon_loss: 4062539.7500; val_gene_expr_recon_loss: 8588526.7667; val_masked_gp_l1_reg_loss: 68498.7578; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1506230.8083; val_global_loss: 14311836.2000; val_optim_loss: 14311836.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8292; val_auprc_score: 0.8376; val_best_acc_score: 0.7316; val_best_f1_score: 0.7551; train_kl_reg_loss: 128444.8306; train_edge_recon_loss: 3543792.0324; train_gene_expr_recon_loss: 8408301.0344; train_masked_gp_l1_reg_loss: 65783.2600; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1484636.8979; train_global_loss: 13630958.0840; train_optim_loss: 13630958.0840; val_kl_reg_loss: 110016.4594; val_edge_recon_loss: 4040039.8667; val_gene_expr_recon_loss: 8298549.2667; val_masked_gp_l1_reg_loss: 65028.8828; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1474698.1500; val_global_loss: 13988332.8000; val_optim_loss: 13988332.8000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8712; val_auprc_score: 0.8619; val_best_acc_score: 0.7793; val_best_f1_score: 0.8020; train_kl_reg_loss: 111585.0151; train_edge_recon_loss: 3387730.2080; train_gene_expr_recon_loss: 8253371.4771; train_masked_gp_l1_reg_loss: 66965.8580; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1463784.4742; train_global_loss: 13283437.0229; train_optim_loss: 13283437.0229; val_kl_reg_loss: 144094.2484; val_edge_recon_loss: 2978836.1333; val_gene_expr_recon_loss: 8221543.7000; val_masked_gp_l1_reg_loss: 70069.7109; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1463174.5000; val_global_loss: 12877718.7333; val_optim_loss: 12877718.7333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8833; val_auprc_score: 0.8698; val_best_acc_score: 0.7909; val_best_f1_score: 0.8086; train_kl_reg_loss: 139913.4799; train_edge_recon_loss: 2984602.5821; train_gene_expr_recon_loss: 8157164.2137; train_masked_gp_l1_reg_loss: 72060.3396; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1453960.5401; train_global_loss: 12807701.1221; train_optim_loss: 12807701.1221; val_kl_reg_loss: 135351.4760; val_edge_recon_loss: 2991039.1833; val_gene_expr_recon_loss: 8058150.2667; val_masked_gp_l1_reg_loss: 73880.1562; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1439218.1667; val_global_loss: 12697638.9333; val_optim_loss: 12697638.9333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8938; val_auprc_score: 0.8767; val_best_acc_score: 0.8162; val_best_f1_score: 0.8323; train_kl_reg_loss: 130874.5715; train_edge_recon_loss: 2950341.2748; train_gene_expr_recon_loss: 8067860.7290; train_masked_gp_l1_reg_loss: 75688.2879; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1441214.9151; train_global_loss: 12665979.8779; train_optim_loss: 12665979.8779; val_kl_reg_loss: 123324.6797; val_edge_recon_loss: 2920822.1333; val_gene_expr_recon_loss: 8009179.3333; val_masked_gp_l1_reg_loss: 77360.3750; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1435981.1167; val_global_loss: 12566667.2667; val_optim_loss: 12566667.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9119; val_auprc_score: 0.8967; val_best_acc_score: 0.8350; val_best_f1_score: 0.8488; train_kl_reg_loss: 124596.6776; train_edge_recon_loss: 2879987.2595; train_gene_expr_recon_loss: 7996411.7634; train_masked_gp_l1_reg_loss: 79067.7495; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1427990.1775; train_global_loss: 12508053.6489; train_optim_loss: 12508053.6489; val_kl_reg_loss: 125220.6911; val_edge_recon_loss: 2881136.0000; val_gene_expr_recon_loss: 7940217.5667; val_masked_gp_l1_reg_loss: 80732.3359; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1434877.0833; val_global_loss: 12462183.4000; val_optim_loss: 12462183.4000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9223; val_auprc_score: 0.9059; val_best_acc_score: 0.8521; val_best_f1_score: 0.8634; train_kl_reg_loss: 121783.4970; train_edge_recon_loss: 2840022.7328; train_gene_expr_recon_loss: 7942768.5458; train_masked_gp_l1_reg_loss: 82378.4563; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1425778.6823; train_global_loss: 12412731.9084; train_optim_loss: 12412731.9084; val_kl_reg_loss: 129948.5328; val_edge_recon_loss: 2842548.6500; val_gene_expr_recon_loss: 7915862.2000; val_masked_gp_l1_reg_loss: 83746.8359; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1427944.2000; val_global_loss: 12400050.6667; val_optim_loss: 12400050.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9371; val_auprc_score: 0.9208; val_best_acc_score: 0.8729; val_best_f1_score: 0.8809; train_kl_reg_loss: 118692.4647; train_edge_recon_loss: 2810541.7748; train_gene_expr_recon_loss: 7888180.4809; train_masked_gp_l1_reg_loss: 85057.6956; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1406999.4418; train_global_loss: 12309471.8855; train_optim_loss: 12309471.8855; val_kl_reg_loss: 120483.4594; val_edge_recon_loss: 2815630.6167; val_gene_expr_recon_loss: 7830899.5333; val_masked_gp_l1_reg_loss: 86439.2344; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1405472.8000; val_global_loss: 12258925.5333; val_optim_loss: 12258925.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9379; val_auprc_score: 0.9242; val_best_acc_score: 0.8736; val_best_f1_score: 0.8801; train_kl_reg_loss: 118097.1481; train_edge_recon_loss: 2785876.5534; train_gene_expr_recon_loss: 7846730.5496; train_masked_gp_l1_reg_loss: 87519.2233; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1399171.6889; train_global_loss: 12237395.1298; train_optim_loss: 12237395.1298; val_kl_reg_loss: 112121.0063; val_edge_recon_loss: 2831123.3000; val_gene_expr_recon_loss: 7793702.5667; val_masked_gp_l1_reg_loss: 88732.4062; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1398271.6583; val_global_loss: 12223950.4667; val_optim_loss: 12223950.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9488; val_auprc_score: 0.9348; val_best_acc_score: 0.8902; val_best_f1_score: 0.8960; train_kl_reg_loss: 113131.0169; train_edge_recon_loss: 2779803.8702; train_gene_expr_recon_loss: 7805209.5000; train_masked_gp_l1_reg_loss: 89940.2886; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1392154.2796; train_global_loss: 12180238.9313; train_optim_loss: 12180238.9313; val_kl_reg_loss: 111556.8521; val_edge_recon_loss: 2766015.9500; val_gene_expr_recon_loss: 7776557.5667; val_masked_gp_l1_reg_loss: 91150.8516; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1394972.5583; val_global_loss: 12140253.8667; val_optim_loss: 12140253.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9520; val_auprc_score: 0.9395; val_best_acc_score: 0.8913; val_best_f1_score: 0.8970; train_kl_reg_loss: 111122.1796; train_edge_recon_loss: 2767627.9866; train_gene_expr_recon_loss: 7764913.9198; train_masked_gp_l1_reg_loss: 92129.3910; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1383929.8616; train_global_loss: 12119723.3817; train_optim_loss: 12119723.3817; val_kl_reg_loss: 107635.5578; val_edge_recon_loss: 2763600.9500; val_gene_expr_recon_loss: 7720316.4667; val_masked_gp_l1_reg_loss: 93121.7500; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1378836.9333; val_global_loss: 12063512.0000; val_optim_loss: 12063512.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9476; val_auprc_score: 0.9302; val_best_acc_score: 0.8946; val_best_f1_score: 0.8992; train_kl_reg_loss: 109349.9385; train_edge_recon_loss: 2761062.3721; train_gene_expr_recon_loss: 7725555.1985; train_masked_gp_l1_reg_loss: 94092.6502; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1376015.2357; train_global_loss: 12066075.4580; train_optim_loss: 12066075.4580; val_kl_reg_loss: 110349.6771; val_edge_recon_loss: 2769746.1333; val_gene_expr_recon_loss: 7702411.8333; val_masked_gp_l1_reg_loss: 95019.8359; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1377586.0667; val_global_loss: 12055113.6000; val_optim_loss: 12055113.6000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9571; val_auprc_score: 0.9441; val_best_acc_score: 0.9018; val_best_f1_score: 0.9068; train_kl_reg_loss: 105472.2884; train_edge_recon_loss: 2755397.0019; train_gene_expr_recon_loss: 7703628.3435; train_masked_gp_l1_reg_loss: 95902.1895; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1369282.8235; train_global_loss: 12029682.6565; train_optim_loss: 12029682.6565; val_kl_reg_loss: 101591.9292; val_edge_recon_loss: 2747470.9000; val_gene_expr_recon_loss: 7663677.1000; val_masked_gp_l1_reg_loss: 97007.2422; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1368836.6917; val_global_loss: 11978583.7333; val_optim_loss: 11978583.7333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9568; val_auprc_score: 0.9438; val_best_acc_score: 0.9004; val_best_f1_score: 0.9048; train_kl_reg_loss: 104053.0850; train_edge_recon_loss: 2737007.2653; train_gene_expr_recon_loss: 7665183.1412; train_masked_gp_l1_reg_loss: 97694.6529; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1362534.7987; train_global_loss: 11966472.9237; train_optim_loss: 11966472.9237; val_kl_reg_loss: 102591.1094; val_edge_recon_loss: 2763293.7667; val_gene_expr_recon_loss: 7638324.6333; val_masked_gp_l1_reg_loss: 98517.5078; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1361562.1333; val_global_loss: 11964289.5333; val_optim_loss: 11964289.5333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9556; val_auprc_score: 0.9417; val_best_acc_score: 0.9002; val_best_f1_score: 0.9048; train_kl_reg_loss: 100985.9577; train_edge_recon_loss: 2741578.3187; train_gene_expr_recon_loss: 7645035.5000; train_masked_gp_l1_reg_loss: 99374.3977; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1357632.5639; train_global_loss: 11944606.7328; train_optim_loss: 11944606.7328; val_kl_reg_loss: 99350.8052; val_edge_recon_loss: 2764921.5667; val_gene_expr_recon_loss: 7659018.4000; val_masked_gp_l1_reg_loss: 100082.3516; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1361510.5917; val_global_loss: 11984883.2667; val_optim_loss: 11984883.2667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9621; val_auprc_score: 0.9511; val_best_acc_score: 0.9081; val_best_f1_score: 0.9104; train_kl_reg_loss: 99011.4252; train_edge_recon_loss: 2737663.3092; train_gene_expr_recon_loss: 7627933.2481; train_masked_gp_l1_reg_loss: 100831.8734; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1354246.0219; train_global_loss: 11919685.7863; train_optim_loss: 11919685.7863; val_kl_reg_loss: 97412.2531; val_edge_recon_loss: 2720236.5167; val_gene_expr_recon_loss: 7576675.4667; val_masked_gp_l1_reg_loss: 101723.3984; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1350589.3917; val_global_loss: 11846636.6000; val_optim_loss: 11846636.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9627; val_auprc_score: 0.9497; val_best_acc_score: 0.9117; val_best_f1_score: 0.9156; train_kl_reg_loss: 97018.8551; train_edge_recon_loss: 2728943.4389; train_gene_expr_recon_loss: 7603376.0267; train_masked_gp_l1_reg_loss: 102306.3767; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1349321.0878; train_global_loss: 11880965.7634; train_optim_loss: 11880965.7634; val_kl_reg_loss: 92945.0703; val_edge_recon_loss: 2728511.4333; val_gene_expr_recon_loss: 7594055.2667; val_masked_gp_l1_reg_loss: 103290.8359; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1347842.7250; val_global_loss: 11866645.4000; val_optim_loss: 11866645.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9618; val_auprc_score: 0.9500; val_best_acc_score: 0.9069; val_best_f1_score: 0.9120; train_kl_reg_loss: 96814.8819; train_edge_recon_loss: 2728552.9542; train_gene_expr_recon_loss: 7583380.2672; train_masked_gp_l1_reg_loss: 103724.0546; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1344768.0458; train_global_loss: 11857240.1908; train_optim_loss: 11857240.1908; val_kl_reg_loss: 95596.0750; val_edge_recon_loss: 2732503.9667; val_gene_expr_recon_loss: 7543874.9333; val_masked_gp_l1_reg_loss: 104319.9219; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1337112.3083; val_global_loss: 11813407.1333; val_optim_loss: 11813407.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9632; val_auprc_score: 0.9546; val_best_acc_score: 0.9033; val_best_f1_score: 0.9068; train_kl_reg_loss: 95425.2831; train_edge_recon_loss: 2718807.9885; train_gene_expr_recon_loss: 7564984.5344; train_masked_gp_l1_reg_loss: 104831.2510; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1342326.3979; train_global_loss: 11826375.3969; train_optim_loss: 11826375.3969; val_kl_reg_loss: 94549.9005; val_edge_recon_loss: 2731876.1833; val_gene_expr_recon_loss: 7557829.3667; val_masked_gp_l1_reg_loss: 105545.7969; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1346854.3167; val_global_loss: 11836655.6000; val_optim_loss: 11836655.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9645; val_auprc_score: 0.9540; val_best_acc_score: 0.9173; val_best_f1_score: 0.9204; train_kl_reg_loss: 94143.3999; train_edge_recon_loss: 2713383.4275; train_gene_expr_recon_loss: 7542691.6947; train_masked_gp_l1_reg_loss: 106109.4212; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1340087.1011; train_global_loss: 11796414.9542; train_optim_loss: 11796414.9542; val_kl_reg_loss: 91155.7740; val_edge_recon_loss: 2735849.0000; val_gene_expr_recon_loss: 7555126.9667; val_masked_gp_l1_reg_loss: 106737.5156; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1337580.8167; val_global_loss: 11826450.4667; val_optim_loss: 11826450.4667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9644; val_auprc_score: 0.9526; val_best_acc_score: 0.9124; val_best_f1_score: 0.9151; train_kl_reg_loss: 93356.3837; train_edge_recon_loss: 2717368.5496; train_gene_expr_recon_loss: 7530828.5802; train_masked_gp_l1_reg_loss: 107148.7610; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1334184.7013; train_global_loss: 11782887.0000; train_optim_loss: 11782887.0000; val_kl_reg_loss: 91719.5031; val_edge_recon_loss: 2730988.3167; val_gene_expr_recon_loss: 7519673.6667; val_masked_gp_l1_reg_loss: 107776.5859; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1335515.3333; val_global_loss: 11785673.9333; val_optim_loss: 11785673.9333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9709; val_auprc_score: 0.9629; val_best_acc_score: 0.9224; val_best_f1_score: 0.9239; train_kl_reg_loss: 92294.3857; train_edge_recon_loss: 2710592.6641; train_gene_expr_recon_loss: 7515782.5725; train_masked_gp_l1_reg_loss: 108173.3188; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1333480.5172; train_global_loss: 11760323.4504; train_optim_loss: 11760323.4504; val_kl_reg_loss: 89805.1214; val_edge_recon_loss: 2716250.0333; val_gene_expr_recon_loss: 7519529.5667; val_masked_gp_l1_reg_loss: 108807.0547; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1341091.5000; val_global_loss: 11775483.2667; val_optim_loss: 11775483.2667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9715; val_auprc_score: 0.9639; val_best_acc_score: 0.9237; val_best_f1_score: 0.9266; train_kl_reg_loss: 91442.3130; train_edge_recon_loss: 2703995.0248; train_gene_expr_recon_loss: 7499117.6756; train_masked_gp_l1_reg_loss: 109237.0475; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1329092.9160; train_global_loss: 11732885.0153; train_optim_loss: 11732885.0153; val_kl_reg_loss: 90819.5036; val_edge_recon_loss: 2716789.4500; val_gene_expr_recon_loss: 7505310.1000; val_masked_gp_l1_reg_loss: 109713.6328; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1330168.5750; val_global_loss: 11752801.6667; val_optim_loss: 11752801.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9695; val_auprc_score: 0.9613; val_best_acc_score: 0.9208; val_best_f1_score: 0.9230; train_kl_reg_loss: 89904.1673; train_edge_recon_loss: 2704815.9599; train_gene_expr_recon_loss: 7480324.7672; train_masked_gp_l1_reg_loss: 110164.5474; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1325999.0086; train_global_loss: 11711208.4656; train_optim_loss: 11711208.4656; val_kl_reg_loss: 90414.7693; val_edge_recon_loss: 2728451.2167; val_gene_expr_recon_loss: 7483873.2333; val_masked_gp_l1_reg_loss: 110500.0469; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1328467.8250; val_global_loss: 11741707.0000; val_optim_loss: 11741707.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9700; val_auprc_score: 0.9610; val_best_acc_score: 0.9237; val_best_f1_score: 0.9264; train_kl_reg_loss: 89486.2683; train_edge_recon_loss: 2699172.3664; train_gene_expr_recon_loss: 7469031.5840; train_masked_gp_l1_reg_loss: 111059.5600; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1324542.6155; train_global_loss: 11693292.4122; train_optim_loss: 11693292.4122; val_kl_reg_loss: 91036.6411; val_edge_recon_loss: 2725379.3833; val_gene_expr_recon_loss: 7445698.6333; val_masked_gp_l1_reg_loss: 111547.1719; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1325493.6583; val_global_loss: 11699155.4000; val_optim_loss: 11699155.4000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9203; val_auprc_score: 0.9064; val_best_acc_score: 0.8461; val_best_f1_score: 0.8549; train_kl_reg_loss: 120386.7091; train_edge_recon_loss: 2889099.6450; train_gene_expr_recon_loss: 8643393.8244; train_masked_gp_l1_reg_loss: 115739.1068; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1440369.0439; train_global_loss: 13208988.3588; train_optim_loss: 13208988.3588; val_kl_reg_loss: 10242.8225; val_edge_recon_loss: 2923717.4000; val_gene_expr_recon_loss: 9352597.5333; val_masked_gp_l1_reg_loss: 119256.9922; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1503911.8083; val_global_loss: 13909726.4667; val_optim_loss: 13909726.4667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9297; val_auprc_score: 0.9066; val_best_acc_score: 0.8681; val_best_f1_score: 0.8734; train_kl_reg_loss: 54435.5027; train_edge_recon_loss: 2806883.6221; train_gene_expr_recon_loss: 9328556.8321; train_masked_gp_l1_reg_loss: 116679.1210; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1490141.4160; train_global_loss: 13796696.4733; train_optim_loss: 13796696.4733; val_kl_reg_loss: 16282.8620; val_edge_recon_loss: 2791502.8667; val_gene_expr_recon_loss: 9283608.4000; val_masked_gp_l1_reg_loss: 113414.1562; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1482390.1333; val_global_loss: 13687198.2000; val_optim_loss: 13687198.2000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9305; val_auprc_score: 0.9092; val_best_acc_score: 0.8725; val_best_f1_score: 0.8775; train_kl_reg_loss: 35651.6653; train_edge_recon_loss: 2754016.3015; train_gene_expr_recon_loss: 9359043.8626; train_masked_gp_l1_reg_loss: 109878.3705; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1485908.0744; train_global_loss: 13744498.2672; train_optim_loss: 13744498.2672; val_kl_reg_loss: 19967.6758; val_edge_recon_loss: 2779702.9167; val_gene_expr_recon_loss: 9391572.1333; val_masked_gp_l1_reg_loss: 106306.3203; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1481774.7000; val_global_loss: 13779323.4000; val_optim_loss: 13779323.4000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9383; val_auprc_score: 0.9213; val_best_acc_score: 0.8790; val_best_f1_score: 0.8840; train_kl_reg_loss: 31799.9164; train_edge_recon_loss: 2735808.5763; train_gene_expr_recon_loss: 9377445.7023; train_masked_gp_l1_reg_loss: 102842.8777; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1480576.8607; train_global_loss: 13728473.9084; train_optim_loss: 13728473.9084; val_kl_reg_loss: 22620.1273; val_edge_recon_loss: 2745710.4833; val_gene_expr_recon_loss: 9312922.2667; val_masked_gp_l1_reg_loss: 99356.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1475788.5583; val_global_loss: 13656397.6000; val_optim_loss: 13656397.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9341; val_auprc_score: 0.9136; val_best_acc_score: 0.8735; val_best_f1_score: 0.8812; train_kl_reg_loss: 30626.3483; train_edge_recon_loss: 2730384.9504; train_gene_expr_recon_loss: 9333480.4351; train_masked_gp_l1_reg_loss: 98616.7417; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1476562.8626; train_global_loss: 13669671.3053; train_optim_loss: 13669671.3053; val_kl_reg_loss: 22617.0335; val_edge_recon_loss: 2771365.0500; val_gene_expr_recon_loss: 9305351.0000; val_masked_gp_l1_reg_loss: 98220.2891; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1476001.4583; val_global_loss: 13673554.6000; val_optim_loss: 13673554.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9379; val_auprc_score: 0.9176; val_best_acc_score: 0.8812; val_best_f1_score: 0.8891; train_kl_reg_loss: 30501.7267; train_edge_recon_loss: 2727615.2424; train_gene_expr_recon_loss: 9320715.3435; train_masked_gp_l1_reg_loss: 97861.6764; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1475223.1861; train_global_loss: 13651917.1069; train_optim_loss: 13651917.1069; val_kl_reg_loss: 23554.1999; val_edge_recon_loss: 2741145.3833; val_gene_expr_recon_loss: 9328286.6000; val_masked_gp_l1_reg_loss: 97490.8359; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1484264.7000; val_global_loss: 13674742.0000; val_optim_loss: 13674742.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9393; val_auprc_score: 0.9181; val_best_acc_score: 0.8828; val_best_f1_score: 0.8894; train_kl_reg_loss: 30833.0705; train_edge_recon_loss: 2729772.1718; train_gene_expr_recon_loss: 9317983.6870; train_masked_gp_l1_reg_loss: 97121.2144; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1475956.1250; train_global_loss: 13651666.2519; train_optim_loss: 13651666.2519; val_kl_reg_loss: 24071.6596; val_edge_recon_loss: 2714985.6167; val_gene_expr_recon_loss: 9307661.9333; val_masked_gp_l1_reg_loss: 96733.6406; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1475904.1000; val_global_loss: 13619357.4667; val_optim_loss: 13619357.4667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9338; val_auprc_score: 0.9106; val_best_acc_score: 0.8759; val_best_f1_score: 0.8825; train_kl_reg_loss: 30939.7856; train_edge_recon_loss: 2730619.4160; train_gene_expr_recon_loss: 9326534.1450; train_masked_gp_l1_reg_loss: 96346.6453; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1476600.8368; train_global_loss: 13661040.8779; train_optim_loss: 13661040.8779; val_kl_reg_loss: 24043.3422; val_edge_recon_loss: 2761721.4167; val_gene_expr_recon_loss: 9249058.3333; val_masked_gp_l1_reg_loss: 95947.7500; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1475249.9500; val_global_loss: 13606021.0667; val_optim_loss: 13606021.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 6 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9746
val AUPRC score: 0.9636
val best accuracy score: 0.9303
val best F1 score: 0.9332
val target rna MSE score: 0.8856
val source rna MSE score: 0.3372
val target atac MSE score: 0.5939
val source atac MSE score: 0.1591
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
