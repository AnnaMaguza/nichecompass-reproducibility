[True]
Run timestamp: 07092023_135041_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6468; val_auprc_score: 0.6168; val_best_acc_score: 0.5107; val_best_f1_score: 0.6712; train_kl_reg_loss: 66597.1688; train_edge_recon_loss: 3542634.0076; train_gene_expr_recon_loss: 16792211.7424; train_masked_gp_l1_reg_loss: 169417.9335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9742184.3598; train_chrom_access_recon_loss: 1260310.1004; train_global_loss: 31573355.2121; train_optim_loss: 31573355.2121; val_kl_reg_loss: 122221.1025; val_edge_recon_loss: 4064763.9062; val_gene_expr_recon_loss: 15255143.7500; val_masked_gp_l1_reg_loss: 156116.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3295054.7500; val_chrom_access_recon_loss: 1210597.2031; val_global_loss: 24103895.7500; val_optim_loss: 24103895.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6683; val_auprc_score: 0.6561; val_best_acc_score: 0.5951; val_best_f1_score: 0.6944; train_kl_reg_loss: 131367.9173; train_edge_recon_loss: 3546896.6439; train_gene_expr_recon_loss: 14929151.5758; train_masked_gp_l1_reg_loss: 146661.8670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1139852.7102; train_chrom_access_recon_loss: 1203199.0057; train_global_loss: 21097129.4848; train_optim_loss: 21097129.4848; val_kl_reg_loss: 133281.3613; val_edge_recon_loss: 4058816.5625; val_gene_expr_recon_loss: 14647053.0000; val_masked_gp_l1_reg_loss: 142686.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 358400.5938; val_chrom_access_recon_loss: 1179189.1875; val_global_loss: 20519426.0000; val_optim_loss: 20519426.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7039; val_auprc_score: 0.6881; val_best_acc_score: 0.6370; val_best_f1_score: 0.6825; train_kl_reg_loss: 126365.4292; train_edge_recon_loss: 3536057.7955; train_gene_expr_recon_loss: 14689645.2424; train_masked_gp_l1_reg_loss: 142558.9633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 270783.5926; train_chrom_access_recon_loss: 1189989.8485; train_global_loss: 19955400.6364; train_optim_loss: 19955400.6364; val_kl_reg_loss: 131609.8506; val_edge_recon_loss: 4049320.6250; val_gene_expr_recon_loss: 14536255.2500; val_masked_gp_l1_reg_loss: 143967.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 220527.8281; val_chrom_access_recon_loss: 1171370.5625; val_global_loss: 20253052.0000; val_optim_loss: 20253052.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7527; val_auprc_score: 0.7386; val_best_acc_score: 0.6728; val_best_f1_score: 0.7213; train_kl_reg_loss: 115463.1997; train_edge_recon_loss: 3524345.3788; train_gene_expr_recon_loss: 14563694.1970; train_masked_gp_l1_reg_loss: 145291.2462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 196777.4479; train_chrom_access_recon_loss: 1180890.1970; train_global_loss: 19726461.5152; train_optim_loss: 19726461.5152; val_kl_reg_loss: 101622.6953; val_edge_recon_loss: 3982025.0938; val_gene_expr_recon_loss: 14549994.0000; val_masked_gp_l1_reg_loss: 146704.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178640.4375; val_chrom_access_recon_loss: 1170548.3750; val_global_loss: 20129534.5000; val_optim_loss: 20129534.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7436; val_auprc_score: 0.7472; val_best_acc_score: 0.6768; val_best_f1_score: 0.7089; train_kl_reg_loss: 97778.1367; train_edge_recon_loss: 3454955.8561; train_gene_expr_recon_loss: 14483027.8939; train_masked_gp_l1_reg_loss: 148773.7277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166207.2597; train_chrom_access_recon_loss: 1175073.7481; train_global_loss: 19525816.3939; train_optim_loss: 19525816.3939; val_kl_reg_loss: 83944.7949; val_edge_recon_loss: 3490779.3125; val_gene_expr_recon_loss: 14489954.8750; val_masked_gp_l1_reg_loss: 151191.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154156.7344; val_chrom_access_recon_loss: 1180700.5156; val_global_loss: 19550727.5000; val_optim_loss: 19550727.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7843; val_auprc_score: 0.7772; val_best_acc_score: 0.7053; val_best_f1_score: 0.7306; train_kl_reg_loss: 106189.1219; train_edge_recon_loss: 3211012.8485; train_gene_expr_recon_loss: 14430828.0303; train_masked_gp_l1_reg_loss: 154429.0166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147273.7048; train_chrom_access_recon_loss: 1168618.8807; train_global_loss: 19218351.5152; train_optim_loss: 19218351.5152; val_kl_reg_loss: 118001.5420; val_edge_recon_loss: 3246147.0312; val_gene_expr_recon_loss: 14448843.2500; val_masked_gp_l1_reg_loss: 157351.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139240.1250; val_chrom_access_recon_loss: 1167343.4062; val_global_loss: 19276927.5000; val_optim_loss: 19276927.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8100; val_auprc_score: 0.7979; val_best_acc_score: 0.7311; val_best_f1_score: 0.7496; train_kl_reg_loss: 123269.6242; train_edge_recon_loss: 3116005.8106; train_gene_expr_recon_loss: 14357780.7727; train_masked_gp_l1_reg_loss: 159572.2150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135804.3899; train_chrom_access_recon_loss: 1164209.6761; train_global_loss: 19056642.5758; train_optim_loss: 19056642.5758; val_kl_reg_loss: 109390.2637; val_edge_recon_loss: 3130818.9375; val_gene_expr_recon_loss: 14279080.1250; val_masked_gp_l1_reg_loss: 162166.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132192.2344; val_chrom_access_recon_loss: 1162703.8906; val_global_loss: 18976351.0000; val_optim_loss: 18976351.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8388; val_auprc_score: 0.8146; val_best_acc_score: 0.7542; val_best_f1_score: 0.7774; train_kl_reg_loss: 122854.1076; train_edge_recon_loss: 3011151.2879; train_gene_expr_recon_loss: 14297600.7576; train_masked_gp_l1_reg_loss: 166481.3445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131292.5798; train_chrom_access_recon_loss: 1158930.0530; train_global_loss: 18888310.0303; train_optim_loss: 18888310.0303; val_kl_reg_loss: 124684.4678; val_edge_recon_loss: 3057156.0938; val_gene_expr_recon_loss: 14153109.7500; val_masked_gp_l1_reg_loss: 171831.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130838.6094; val_chrom_access_recon_loss: 1148026.1719; val_global_loss: 18785646.2500; val_optim_loss: 18785646.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8834; val_auprc_score: 0.8565; val_best_acc_score: 0.8066; val_best_f1_score: 0.8265; train_kl_reg_loss: 125393.7957; train_edge_recon_loss: 2915503.7803; train_gene_expr_recon_loss: 14229511.6818; train_masked_gp_l1_reg_loss: 174311.4818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130027.3647; train_chrom_access_recon_loss: 1154931.4034; train_global_loss: 18729679.5758; train_optim_loss: 18729679.5758; val_kl_reg_loss: 132525.9150; val_edge_recon_loss: 2929218.2812; val_gene_expr_recon_loss: 14105374.6250; val_masked_gp_l1_reg_loss: 176542.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129478.1953; val_chrom_access_recon_loss: 1132882.6719; val_global_loss: 18606021.7500; val_optim_loss: 18606021.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8700; val_auprc_score: 0.8494; val_best_acc_score: 0.7883; val_best_f1_score: 0.8095; train_kl_reg_loss: 121986.9429; train_edge_recon_loss: 3011974.5114; train_gene_expr_recon_loss: 14263884.3333; train_masked_gp_l1_reg_loss: 180216.7157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133076.9152; train_chrom_access_recon_loss: 1151354.1231; train_global_loss: 18862493.4848; train_optim_loss: 18862493.4848; val_kl_reg_loss: 116822.4395; val_edge_recon_loss: 2971308.6875; val_gene_expr_recon_loss: 14210078.0000; val_masked_gp_l1_reg_loss: 180230.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134766.4062; val_chrom_access_recon_loss: 1144640.0000; val_global_loss: 18757845.2500; val_optim_loss: 18757845.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8922; val_auprc_score: 0.8654; val_best_acc_score: 0.8227; val_best_f1_score: 0.8355; train_kl_reg_loss: 121236.1362; train_edge_recon_loss: 2914486.5568; train_gene_expr_recon_loss: 14148710.5909; train_masked_gp_l1_reg_loss: 181466.5102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132698.4074; train_chrom_access_recon_loss: 1143682.7064; train_global_loss: 18642280.7576; train_optim_loss: 18642280.7576; val_kl_reg_loss: 124937.5293; val_edge_recon_loss: 2913833.9688; val_gene_expr_recon_loss: 14156300.2500; val_masked_gp_l1_reg_loss: 182960.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132277.7656; val_chrom_access_recon_loss: 1143779.7656; val_global_loss: 18654090.0000; val_optim_loss: 18654090.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8972; val_auprc_score: 0.8657; val_best_acc_score: 0.8318; val_best_f1_score: 0.8421; train_kl_reg_loss: 133258.7031; train_edge_recon_loss: 2885506.9356; train_gene_expr_recon_loss: 14099918.3485; train_masked_gp_l1_reg_loss: 183385.5926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130792.6366; train_chrom_access_recon_loss: 1140034.8826; train_global_loss: 18572897.0606; train_optim_loss: 18572897.0606; val_kl_reg_loss: 127656.6943; val_edge_recon_loss: 2900992.0625; val_gene_expr_recon_loss: 14057775.2500; val_masked_gp_l1_reg_loss: 182784.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130769.4219; val_chrom_access_recon_loss: 1129653.0469; val_global_loss: 18529631.2500; val_optim_loss: 18529631.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8993; val_auprc_score: 0.8678; val_best_acc_score: 0.8385; val_best_f1_score: 0.8514; train_kl_reg_loss: 137106.2095; train_edge_recon_loss: 2852866.4053; train_gene_expr_recon_loss: 14042373.5455; train_masked_gp_l1_reg_loss: 183148.8705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129487.2198; train_chrom_access_recon_loss: 1135541.1345; train_global_loss: 18480523.1515; train_optim_loss: 18480523.1515; val_kl_reg_loss: 139769.3926; val_edge_recon_loss: 2884371.1875; val_gene_expr_recon_loss: 14012309.3750; val_masked_gp_l1_reg_loss: 184244.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129036.5469; val_chrom_access_recon_loss: 1127129.1562; val_global_loss: 18476859.5000; val_optim_loss: 18476859.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9024; val_auprc_score: 0.8744; val_best_acc_score: 0.8385; val_best_f1_score: 0.8495; train_kl_reg_loss: 135548.7464; train_edge_recon_loss: 2839854.0682; train_gene_expr_recon_loss: 13998396.3636; train_masked_gp_l1_reg_loss: 184631.0812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128503.7753; train_chrom_access_recon_loss: 1132335.0114; train_global_loss: 18419268.9697; train_optim_loss: 18419268.9697; val_kl_reg_loss: 135931.4316; val_edge_recon_loss: 2876645.1562; val_gene_expr_recon_loss: 13942245.8750; val_masked_gp_l1_reg_loss: 185294.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127240.2812; val_chrom_access_recon_loss: 1133754.6406; val_global_loss: 18401111.7500; val_optim_loss: 18401111.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8976; val_auprc_score: 0.8695; val_best_acc_score: 0.8299; val_best_f1_score: 0.8444; train_kl_reg_loss: 136677.1366; train_edge_recon_loss: 2832116.3295; train_gene_expr_recon_loss: 13948938.1818; train_masked_gp_l1_reg_loss: 186038.3904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127365.9787; train_chrom_access_recon_loss: 1128098.7121; train_global_loss: 18359234.7879; train_optim_loss: 18359234.7879; val_kl_reg_loss: 133113.1152; val_edge_recon_loss: 2895371.4375; val_gene_expr_recon_loss: 14000276.5000; val_masked_gp_l1_reg_loss: 186639.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127074.4922; val_chrom_access_recon_loss: 1139285.5938; val_global_loss: 18481760.0000; val_optim_loss: 18481760.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9000; val_auprc_score: 0.8725; val_best_acc_score: 0.8399; val_best_f1_score: 0.8515; train_kl_reg_loss: 132282.0948; train_edge_recon_loss: 2832835.8939; train_gene_expr_recon_loss: 13909641.4545; train_masked_gp_l1_reg_loss: 187113.6499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127146.9267; train_chrom_access_recon_loss: 1125504.6070; train_global_loss: 18314524.7879; train_optim_loss: 18314524.7879; val_kl_reg_loss: 137428.6367; val_edge_recon_loss: 2889896.5312; val_gene_expr_recon_loss: 13846057.5000; val_masked_gp_l1_reg_loss: 187418.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126191.8906; val_chrom_access_recon_loss: 1107698.4922; val_global_loss: 18294691.0000; val_optim_loss: 18294691.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9066; val_auprc_score: 0.8770; val_best_acc_score: 0.8450; val_best_f1_score: 0.8566; train_kl_reg_loss: 133296.5627; train_edge_recon_loss: 2830727.5720; train_gene_expr_recon_loss: 13866591.4848; train_masked_gp_l1_reg_loss: 187966.6577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126420.1828; train_chrom_access_recon_loss: 1121668.9034; train_global_loss: 18266671.5758; train_optim_loss: 18266671.5758; val_kl_reg_loss: 131016.8486; val_edge_recon_loss: 2876509.4688; val_gene_expr_recon_loss: 13847545.0000; val_masked_gp_l1_reg_loss: 188588.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126129.8594; val_chrom_access_recon_loss: 1110198.7422; val_global_loss: 18279987.5000; val_optim_loss: 18279987.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9052; val_auprc_score: 0.8759; val_best_acc_score: 0.8401; val_best_f1_score: 0.8512; train_kl_reg_loss: 132253.4780; train_edge_recon_loss: 2818695.8447; train_gene_expr_recon_loss: 13832595.3333; train_masked_gp_l1_reg_loss: 189038.7216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125959.2108; train_chrom_access_recon_loss: 1119610.5701; train_global_loss: 18218153.2727; train_optim_loss: 18218153.2727; val_kl_reg_loss: 127525.0859; val_edge_recon_loss: 2885003.3750; val_gene_expr_recon_loss: 13759631.8750; val_masked_gp_l1_reg_loss: 189479.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125606.0078; val_chrom_access_recon_loss: 1112703.9375; val_global_loss: 18199950.5000; val_optim_loss: 18199950.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9088; val_auprc_score: 0.8828; val_best_acc_score: 0.8482; val_best_f1_score: 0.8578; train_kl_reg_loss: 127715.8617; train_edge_recon_loss: 2828307.5265; train_gene_expr_recon_loss: 13808795.4091; train_masked_gp_l1_reg_loss: 189902.9730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126623.9214; train_chrom_access_recon_loss: 1116964.9157; train_global_loss: 18198310.5152; train_optim_loss: 18198310.5152; val_kl_reg_loss: 125840.7832; val_edge_recon_loss: 2894548.1562; val_gene_expr_recon_loss: 13852124.8750; val_masked_gp_l1_reg_loss: 190274.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126576.4062; val_chrom_access_recon_loss: 1114926.1250; val_global_loss: 18304289.7500; val_optim_loss: 18304289.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9175; val_auprc_score: 0.8923; val_best_acc_score: 0.8552; val_best_f1_score: 0.8664; train_kl_reg_loss: 129986.4968; train_edge_recon_loss: 2839588.3977; train_gene_expr_recon_loss: 13763443.1970; train_masked_gp_l1_reg_loss: 190551.6728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126556.6385; train_chrom_access_recon_loss: 1113371.1951; train_global_loss: 18163497.6061; train_optim_loss: 18163497.6061; val_kl_reg_loss: 131489.9697; val_edge_recon_loss: 2828172.5000; val_gene_expr_recon_loss: 13687801.6250; val_masked_gp_l1_reg_loss: 190978.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126766.2578; val_chrom_access_recon_loss: 1105860.4531; val_global_loss: 18071069.2500; val_optim_loss: 18071069.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9170; val_auprc_score: 0.8877; val_best_acc_score: 0.8557; val_best_f1_score: 0.8659; train_kl_reg_loss: 125641.0656; train_edge_recon_loss: 2816329.0303; train_gene_expr_recon_loss: 13726032.5455; train_masked_gp_l1_reg_loss: 191444.6607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127331.2223; train_chrom_access_recon_loss: 1110933.3864; train_global_loss: 18097711.9697; train_optim_loss: 18097711.9697; val_kl_reg_loss: 129449.7148; val_edge_recon_loss: 2819352.6562; val_gene_expr_recon_loss: 13658445.7500; val_masked_gp_l1_reg_loss: 192129.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127347.5391; val_chrom_access_recon_loss: 1095462.4766; val_global_loss: 18022187.7500; val_optim_loss: 18022187.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9032; val_auprc_score: 0.8687; val_best_acc_score: 0.8439; val_best_f1_score: 0.8564; train_kl_reg_loss: 129010.9425; train_edge_recon_loss: 2814350.5114; train_gene_expr_recon_loss: 13695584.4394; train_masked_gp_l1_reg_loss: 191890.4626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127118.3907; train_chrom_access_recon_loss: 1108374.2481; train_global_loss: 18066328.9697; train_optim_loss: 18066328.9697; val_kl_reg_loss: 133449.1387; val_edge_recon_loss: 2887104.9375; val_gene_expr_recon_loss: 13735792.3750; val_masked_gp_l1_reg_loss: 191886.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126727.7734; val_chrom_access_recon_loss: 1109781.8984; val_global_loss: 18184742.5000; val_optim_loss: 18184742.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9146; val_auprc_score: 0.8822; val_best_acc_score: 0.8560; val_best_f1_score: 0.8654; train_kl_reg_loss: 126618.2622; train_edge_recon_loss: 2813218.4394; train_gene_expr_recon_loss: 13667039.1818; train_masked_gp_l1_reg_loss: 191981.6783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127140.0380; train_chrom_access_recon_loss: 1105707.5170; train_global_loss: 18031704.9394; train_optim_loss: 18031704.9394; val_kl_reg_loss: 125913.7207; val_edge_recon_loss: 2833076.1250; val_gene_expr_recon_loss: 13602905.2500; val_masked_gp_l1_reg_loss: 192365.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127253.4062; val_chrom_access_recon_loss: 1109366.6797; val_global_loss: 17990881.0000; val_optim_loss: 17990881.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9149; val_auprc_score: 0.8880; val_best_acc_score: 0.8600; val_best_f1_score: 0.8697; train_kl_reg_loss: 126324.1546; train_edge_recon_loss: 2808812.8902; train_gene_expr_recon_loss: 13643215.2424; train_masked_gp_l1_reg_loss: 192456.8265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127170.8630; train_chrom_access_recon_loss: 1103126.7216; train_global_loss: 18001106.6970; train_optim_loss: 18001106.6970; val_kl_reg_loss: 123918.1357; val_edge_recon_loss: 2832792.7188; val_gene_expr_recon_loss: 13660976.6250; val_masked_gp_l1_reg_loss: 192796.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127301.8750; val_chrom_access_recon_loss: 1111501.4375; val_global_loss: 18049287.5000; val_optim_loss: 18049287.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9173; val_auprc_score: 0.8894; val_best_acc_score: 0.8538; val_best_f1_score: 0.8652; train_kl_reg_loss: 124939.7289; train_edge_recon_loss: 2796001.8939; train_gene_expr_recon_loss: 13627894.3030; train_masked_gp_l1_reg_loss: 193031.9962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127420.7547; train_chrom_access_recon_loss: 1101539.7689; train_global_loss: 17970828.5152; train_optim_loss: 17970828.5152; val_kl_reg_loss: 127439.9385; val_edge_recon_loss: 2872673.5938; val_gene_expr_recon_loss: 13487718.0000; val_masked_gp_l1_reg_loss: 193622.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128796.3750; val_chrom_access_recon_loss: 1099482.4844; val_global_loss: 17909733.0000; val_optim_loss: 17909733.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9155; val_auprc_score: 0.8888; val_best_acc_score: 0.8608; val_best_f1_score: 0.8708; train_kl_reg_loss: 141508.1694; train_edge_recon_loss: 2855446.6856; train_gene_expr_recon_loss: 13168047.1364; train_masked_gp_l1_reg_loss: 192472.6882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124229.9478; train_chrom_access_recon_loss: 1071347.3371; train_global_loss: 17553052.2121; train_optim_loss: 17553052.2121; val_kl_reg_loss: 90382.0283; val_edge_recon_loss: 2877292.6562; val_gene_expr_recon_loss: 13142073.7500; val_masked_gp_l1_reg_loss: 193255.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125643.2344; val_chrom_access_recon_loss: 1060373.1484; val_global_loss: 17489020.7500; val_optim_loss: 17489020.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9118; val_auprc_score: 0.8776; val_best_acc_score: 0.8482; val_best_f1_score: 0.8607; train_kl_reg_loss: 136400.4634; train_edge_recon_loss: 2807162.8333; train_gene_expr_recon_loss: 13074082.6818; train_masked_gp_l1_reg_loss: 193627.2876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126249.2818; train_chrom_access_recon_loss: 1056269.9716; train_global_loss: 17393792.3636; train_optim_loss: 17393792.3636; val_kl_reg_loss: 94088.9961; val_edge_recon_loss: 2886582.0625; val_gene_expr_recon_loss: 12990892.2500; val_masked_gp_l1_reg_loss: 193667.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126506.0391; val_chrom_access_recon_loss: 1041773.4766; val_global_loss: 17333510.1250; val_optim_loss: 17333510.1250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9155; val_auprc_score: 0.8811; val_best_acc_score: 0.8541; val_best_f1_score: 0.8655; train_kl_reg_loss: 132583.7242; train_edge_recon_loss: 2801068.9924; train_gene_expr_recon_loss: 13035014.1970; train_masked_gp_l1_reg_loss: 192804.5033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125839.2913; train_chrom_access_recon_loss: 1054367.5871; train_global_loss: 17341678.4697; train_optim_loss: 17341678.4697; val_kl_reg_loss: 102995.4160; val_edge_recon_loss: 2826815.8438; val_gene_expr_recon_loss: 13080137.7500; val_masked_gp_l1_reg_loss: 191856.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126253.6328; val_chrom_access_recon_loss: 1049461.6250; val_global_loss: 17377520.7500; val_optim_loss: 17377520.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9192; val_auprc_score: 0.8893; val_best_acc_score: 0.8662; val_best_f1_score: 0.8766; train_kl_reg_loss: 125685.1854; train_edge_recon_loss: 2796001.2197; train_gene_expr_recon_loss: 13009728.9091; train_masked_gp_l1_reg_loss: 191163.2375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125805.0169; train_chrom_access_recon_loss: 1052089.9801; train_global_loss: 17300473.6667; train_optim_loss: 17300473.6667; val_kl_reg_loss: 105773.0742; val_edge_recon_loss: 2817609.4375; val_gene_expr_recon_loss: 13022907.8750; val_masked_gp_l1_reg_loss: 190295.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125510.6172; val_chrom_access_recon_loss: 1061761.5781; val_global_loss: 17323859.2500; val_optim_loss: 17323859.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9293; val_auprc_score: 0.9068; val_best_acc_score: 0.8740; val_best_f1_score: 0.8795; train_kl_reg_loss: 124276.9554; train_edge_recon_loss: 2782183.6174; train_gene_expr_recon_loss: 12989564.1515; train_masked_gp_l1_reg_loss: 189491.2370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124959.4615; train_chrom_access_recon_loss: 1049446.8059; train_global_loss: 17259922.2121; train_optim_loss: 17259922.2121; val_kl_reg_loss: 108852.7715; val_edge_recon_loss: 2826826.9688; val_gene_expr_recon_loss: 12925767.0000; val_masked_gp_l1_reg_loss: 188691.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123972.5625; val_chrom_access_recon_loss: 1039032.0469; val_global_loss: 17213144.0000; val_optim_loss: 17213144.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9228; val_auprc_score: 0.8928; val_best_acc_score: 0.8716; val_best_f1_score: 0.8804; train_kl_reg_loss: 121506.0637; train_edge_recon_loss: 2777020.3068; train_gene_expr_recon_loss: 12966593.8030; train_masked_gp_l1_reg_loss: 188096.3146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124328.8859; train_chrom_access_recon_loss: 1048155.0739; train_global_loss: 17225700.5303; train_optim_loss: 17225700.5303; val_kl_reg_loss: 108894.1123; val_edge_recon_loss: 2807556.2812; val_gene_expr_recon_loss: 13120445.7500; val_masked_gp_l1_reg_loss: 187600.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124440.5938; val_chrom_access_recon_loss: 1057222.9141; val_global_loss: 17406160.7500; val_optim_loss: 17406160.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9239; val_auprc_score: 0.8949; val_best_acc_score: 0.8726; val_best_f1_score: 0.8799; train_kl_reg_loss: 120172.1828; train_edge_recon_loss: 2780460.8371; train_gene_expr_recon_loss: 12950440.1970; train_masked_gp_l1_reg_loss: 187105.9721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123774.9851; train_chrom_access_recon_loss: 1047572.1117; train_global_loss: 17209526.3030; train_optim_loss: 17209526.3030; val_kl_reg_loss: 111528.6064; val_edge_recon_loss: 2816086.8750; val_gene_expr_recon_loss: 12974864.5000; val_masked_gp_l1_reg_loss: 186321.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124155.6250; val_chrom_access_recon_loss: 1041019.5703; val_global_loss: 17253976.3750; val_optim_loss: 17253976.3750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9274; val_auprc_score: 0.9012; val_best_acc_score: 0.8716; val_best_f1_score: 0.8794; train_kl_reg_loss: 119812.7263; train_edge_recon_loss: 2779805.8485; train_gene_expr_recon_loss: 12933301.5606; train_masked_gp_l1_reg_loss: 185771.2214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123215.2216; train_chrom_access_recon_loss: 1046762.5616; train_global_loss: 17188669.1515; train_optim_loss: 17188669.1515; val_kl_reg_loss: 110332.3096; val_edge_recon_loss: 2793111.3750; val_gene_expr_recon_loss: 12850733.8750; val_masked_gp_l1_reg_loss: 185020.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122559.9219; val_chrom_access_recon_loss: 1046932.0625; val_global_loss: 17108689.6250; val_optim_loss: 17108689.6250
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9317; val_auprc_score: 0.9041; val_best_acc_score: 0.8799; val_best_f1_score: 0.8861; train_kl_reg_loss: 119670.5212; train_edge_recon_loss: 2781855.1742; train_gene_expr_recon_loss: 12915342.7273; train_masked_gp_l1_reg_loss: 184935.4015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122846.3549; train_chrom_access_recon_loss: 1044389.5975; train_global_loss: 17169039.6970; train_optim_loss: 17169039.6970; val_kl_reg_loss: 111585.0879; val_edge_recon_loss: 2780949.3438; val_gene_expr_recon_loss: 12833895.1250; val_masked_gp_l1_reg_loss: 184718.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121907.7734; val_chrom_access_recon_loss: 1033645.7578; val_global_loss: 17066701.5000; val_optim_loss: 17066701.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9264; val_auprc_score: 0.8987; val_best_acc_score: 0.8673; val_best_f1_score: 0.8761; train_kl_reg_loss: 117902.1789; train_edge_recon_loss: 2779097.5492; train_gene_expr_recon_loss: 12892593.9848; train_masked_gp_l1_reg_loss: 184292.0890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122211.9351; train_chrom_access_recon_loss: 1043009.5956; train_global_loss: 17139107.2576; train_optim_loss: 17139107.2576; val_kl_reg_loss: 120545.9834; val_edge_recon_loss: 2819327.2188; val_gene_expr_recon_loss: 12867800.2500; val_masked_gp_l1_reg_loss: 184219.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122672.6875; val_chrom_access_recon_loss: 1033799.9609; val_global_loss: 17148365.5000; val_optim_loss: 17148365.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9292; val_auprc_score: 0.8991; val_best_acc_score: 0.8775; val_best_f1_score: 0.8831; train_kl_reg_loss: 119549.6760; train_edge_recon_loss: 2764140.3333; train_gene_expr_recon_loss: 12875607.1667; train_masked_gp_l1_reg_loss: 183564.6555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121737.6715; train_chrom_access_recon_loss: 1041129.8845; train_global_loss: 17105729.4242; train_optim_loss: 17105729.4242; val_kl_reg_loss: 117457.1455; val_edge_recon_loss: 2778906.9062; val_gene_expr_recon_loss: 12851064.0000; val_masked_gp_l1_reg_loss: 183256.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122022.1172; val_chrom_access_recon_loss: 1038728.4453; val_global_loss: 17091435.8750; val_optim_loss: 17091435.8750
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9345; val_auprc_score: 0.9077; val_best_acc_score: 0.8826; val_best_f1_score: 0.8880; train_kl_reg_loss: 117382.7552; train_edge_recon_loss: 2767231.8068; train_gene_expr_recon_loss: 12865702.9242; train_masked_gp_l1_reg_loss: 183047.7060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121875.0653; train_chrom_access_recon_loss: 1039968.9877; train_global_loss: 17095209.3788; train_optim_loss: 17095209.3788; val_kl_reg_loss: 115697.2266; val_edge_recon_loss: 2782765.5000; val_gene_expr_recon_loss: 12764848.3750; val_masked_gp_l1_reg_loss: 183054.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122066.5781; val_chrom_access_recon_loss: 1036356.7031; val_global_loss: 17004788.7500; val_optim_loss: 17004788.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9336; val_auprc_score: 0.9082; val_best_acc_score: 0.8794; val_best_f1_score: 0.8850; train_kl_reg_loss: 118786.0466; train_edge_recon_loss: 2758299.4545; train_gene_expr_recon_loss: 12854906.3788; train_masked_gp_l1_reg_loss: 182846.2031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121549.9345; train_chrom_access_recon_loss: 1038457.9157; train_global_loss: 17074845.8333; train_optim_loss: 17074845.8333; val_kl_reg_loss: 117943.3857; val_edge_recon_loss: 2809747.9062; val_gene_expr_recon_loss: 12788494.5000; val_masked_gp_l1_reg_loss: 182833.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121538.1172; val_chrom_access_recon_loss: 1037210.8125; val_global_loss: 17057767.5000; val_optim_loss: 17057767.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9391; val_auprc_score: 0.9179; val_best_acc_score: 0.8847; val_best_f1_score: 0.8917; train_kl_reg_loss: 118257.9246; train_edge_recon_loss: 2768796.8712; train_gene_expr_recon_loss: 12843102.6818; train_masked_gp_l1_reg_loss: 182544.1172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121198.9895; train_chrom_access_recon_loss: 1037996.3030; train_global_loss: 17071896.8333; train_optim_loss: 17071896.8333; val_kl_reg_loss: 116583.4141; val_edge_recon_loss: 2771751.1875; val_gene_expr_recon_loss: 12954138.3750; val_masked_gp_l1_reg_loss: 182015.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120039.4297; val_chrom_access_recon_loss: 1031119.4922; val_global_loss: 17175646.5000; val_optim_loss: 17175646.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9355; val_auprc_score: 0.9142; val_best_acc_score: 0.8810; val_best_f1_score: 0.8853; train_kl_reg_loss: 118571.6462; train_edge_recon_loss: 2761636.0985; train_gene_expr_recon_loss: 12831607.2576; train_masked_gp_l1_reg_loss: 182020.9929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120716.7451; train_chrom_access_recon_loss: 1037371.3409; train_global_loss: 17051924.0152; train_optim_loss: 17051924.0152; val_kl_reg_loss: 115335.0586; val_edge_recon_loss: 2808459.8438; val_gene_expr_recon_loss: 12880962.5000; val_masked_gp_l1_reg_loss: 181904.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121268.4453; val_chrom_access_recon_loss: 1029193.0234; val_global_loss: 17137122.1250; val_optim_loss: 17137122.1250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9406; val_auprc_score: 0.9192; val_best_acc_score: 0.8877; val_best_f1_score: 0.8926; train_kl_reg_loss: 117582.6737; train_edge_recon_loss: 2753273.0303; train_gene_expr_recon_loss: 12814694.3030; train_masked_gp_l1_reg_loss: 181867.4969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120895.9530; train_chrom_access_recon_loss: 1034976.2131; train_global_loss: 17023289.6667; train_optim_loss: 17023289.6667; val_kl_reg_loss: 117074.2969; val_edge_recon_loss: 2798343.4375; val_gene_expr_recon_loss: 12763562.8750; val_masked_gp_l1_reg_loss: 181835.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121090.0391; val_chrom_access_recon_loss: 1037089.7656; val_global_loss: 17018996.7500; val_optim_loss: 17018996.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9430; val_auprc_score: 0.9176; val_best_acc_score: 0.8893; val_best_f1_score: 0.8951; train_kl_reg_loss: 117968.8034; train_edge_recon_loss: 2757000.9470; train_gene_expr_recon_loss: 12801556.0152; train_masked_gp_l1_reg_loss: 178774.9695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90105.5066; train_chrom_access_recon_loss: 1033825.1004; train_global_loss: 16979231.4091; train_optim_loss: 16979231.4091; val_kl_reg_loss: 116763.9102; val_edge_recon_loss: 2751601.1562; val_gene_expr_recon_loss: 12756266.7500; val_masked_gp_l1_reg_loss: 177601.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83944.5859; val_chrom_access_recon_loss: 1023144.7812; val_global_loss: 16909322.6250; val_optim_loss: 16909322.6250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9404; val_auprc_score: 0.9215; val_best_acc_score: 0.8885; val_best_f1_score: 0.8935; train_kl_reg_loss: 119184.6112; train_edge_recon_loss: 2754777.2348; train_gene_expr_recon_loss: 12794743.6364; train_masked_gp_l1_reg_loss: 177358.0568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83579.6130; train_chrom_access_recon_loss: 1032974.8532; train_global_loss: 16962617.8333; train_optim_loss: 16962617.8333; val_kl_reg_loss: 119282.3525; val_edge_recon_loss: 2781547.8125; val_gene_expr_recon_loss: 12826767.0000; val_masked_gp_l1_reg_loss: 177146.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83248.1562; val_chrom_access_recon_loss: 1043172.2031; val_global_loss: 17031163.0000; val_optim_loss: 17031163.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9420; val_auprc_score: 0.9197; val_best_acc_score: 0.8877; val_best_f1_score: 0.8926; train_kl_reg_loss: 120766.9986; train_edge_recon_loss: 2756799.7992; train_gene_expr_recon_loss: 12789581.9545; train_masked_gp_l1_reg_loss: 177028.8056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83031.4318; train_chrom_access_recon_loss: 1031669.1061; train_global_loss: 16958878.2576; train_optim_loss: 16958878.2576; val_kl_reg_loss: 119789.9805; val_edge_recon_loss: 2746714.3438; val_gene_expr_recon_loss: 12782123.7500; val_masked_gp_l1_reg_loss: 176932.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82857.1094; val_chrom_access_recon_loss: 1022888.8594; val_global_loss: 16931306.0000; val_optim_loss: 16931306.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9359; val_auprc_score: 0.9123; val_best_acc_score: 0.8821; val_best_f1_score: 0.8880; train_kl_reg_loss: 120275.9192; train_edge_recon_loss: 2756883.9583; train_gene_expr_recon_loss: 12797166.0303; train_masked_gp_l1_reg_loss: 176881.9754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82808.7641; train_chrom_access_recon_loss: 1033132.7955; train_global_loss: 16967149.5303; train_optim_loss: 16967149.5303; val_kl_reg_loss: 118413.7207; val_edge_recon_loss: 2814997.7500; val_gene_expr_recon_loss: 12848176.5000; val_masked_gp_l1_reg_loss: 176837.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82640.3672; val_chrom_access_recon_loss: 1029032.0469; val_global_loss: 17070097.1250; val_optim_loss: 17070097.1250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9392; val_auprc_score: 0.9148; val_best_acc_score: 0.8855; val_best_f1_score: 0.8919; train_kl_reg_loss: 120723.0703; train_edge_recon_loss: 2748282.0189; train_gene_expr_recon_loss: 12799769.6061; train_masked_gp_l1_reg_loss: 176795.0142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82606.2504; train_chrom_access_recon_loss: 1033024.7491; train_global_loss: 16961200.7576; train_optim_loss: 16961200.7576; val_kl_reg_loss: 119986.7578; val_edge_recon_loss: 2774685.6562; val_gene_expr_recon_loss: 12801108.7500; val_masked_gp_l1_reg_loss: 176739.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82513.5547; val_chrom_access_recon_loss: 1023760.5859; val_global_loss: 16978795.3750; val_optim_loss: 16978795.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9454; val_auprc_score: 0.9294; val_best_acc_score: 0.8955; val_best_f1_score: 0.8996; train_kl_reg_loss: 120796.8081; train_edge_recon_loss: 2743575.5720; train_gene_expr_recon_loss: 12786826.9848; train_masked_gp_l1_reg_loss: 176427.6892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79060.0137; train_chrom_access_recon_loss: 1032513.2178; train_global_loss: 16939200.1970; train_optim_loss: 16939200.1970; val_kl_reg_loss: 119697.3525; val_edge_recon_loss: 2752234.4375; val_gene_expr_recon_loss: 12737001.5000; val_masked_gp_l1_reg_loss: 176296.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78371.0312; val_chrom_access_recon_loss: 1025443.0625; val_global_loss: 16889043.3750; val_optim_loss: 16889043.3750
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9358; val_auprc_score: 0.9075; val_best_acc_score: 0.8842; val_best_f1_score: 0.8899; train_kl_reg_loss: 120583.0488; train_edge_recon_loss: 2743748.8826; train_gene_expr_recon_loss: 12790386.4394; train_masked_gp_l1_reg_loss: 176258.1842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78310.3204; train_chrom_access_recon_loss: 1032363.5938; train_global_loss: 16941650.3636; train_optim_loss: 16941650.3636; val_kl_reg_loss: 120411.8555; val_edge_recon_loss: 2793811.8750; val_gene_expr_recon_loss: 12759668.5000; val_masked_gp_l1_reg_loss: 176228.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78261.5938; val_chrom_access_recon_loss: 1036401.4297; val_global_loss: 16964783.7500; val_optim_loss: 16964783.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9361; val_auprc_score: 0.9127; val_best_acc_score: 0.8818; val_best_f1_score: 0.8887; train_kl_reg_loss: 120934.3072; train_edge_recon_loss: 2740466.9924; train_gene_expr_recon_loss: 12786623.5909; train_masked_gp_l1_reg_loss: 176204.9626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78226.3759; train_chrom_access_recon_loss: 1031768.3759; train_global_loss: 16934224.8333; train_optim_loss: 16934224.8333; val_kl_reg_loss: 120089.4902; val_edge_recon_loss: 2794652.3438; val_gene_expr_recon_loss: 12853756.7500; val_masked_gp_l1_reg_loss: 176182.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78192.3906; val_chrom_access_recon_loss: 1037205.2891; val_global_loss: 17060078.1250; val_optim_loss: 17060078.1250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9437; val_auprc_score: 0.9260; val_best_acc_score: 0.8909; val_best_f1_score: 0.8945; train_kl_reg_loss: 120971.2712; train_edge_recon_loss: 2746918.9015; train_gene_expr_recon_loss: 12781150.5303; train_masked_gp_l1_reg_loss: 176173.2637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78169.0829; train_chrom_access_recon_loss: 1031971.8958; train_global_loss: 16935355.0455; train_optim_loss: 16935355.0455; val_kl_reg_loss: 120297.2129; val_edge_recon_loss: 2785524.8125; val_gene_expr_recon_loss: 12756149.0000; val_masked_gp_l1_reg_loss: 176161.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78149.8047; val_chrom_access_recon_loss: 1022196.7188; val_global_loss: 16938478.8750; val_optim_loss: 16938478.8750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9393; val_auprc_score: 0.9208; val_best_acc_score: 0.8855; val_best_f1_score: 0.8918; train_kl_reg_loss: 120921.6804; train_edge_recon_loss: 2758400.0265; train_gene_expr_recon_loss: 12776807.1970; train_masked_gp_l1_reg_loss: 176148.1690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78127.6763; train_chrom_access_recon_loss: 1031787.8125; train_global_loss: 16942192.5303; train_optim_loss: 16942192.5303; val_kl_reg_loss: 120520.7393; val_edge_recon_loss: 2779641.2812; val_gene_expr_recon_loss: 12890888.6250; val_masked_gp_l1_reg_loss: 176138.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78115.9219; val_chrom_access_recon_loss: 1039425.9609; val_global_loss: 17084731.3750; val_optim_loss: 17084731.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9402; val_auprc_score: 0.9195; val_best_acc_score: 0.8861; val_best_f1_score: 0.8911; train_kl_reg_loss: 121263.5540; train_edge_recon_loss: 2745472.9773; train_gene_expr_recon_loss: 12787855.3788; train_masked_gp_l1_reg_loss: 176107.6877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77769.4522; train_chrom_access_recon_loss: 1033094.0966; train_global_loss: 16941563.2121; train_optim_loss: 16941563.2121; val_kl_reg_loss: 119693.4219; val_edge_recon_loss: 2764902.3438; val_gene_expr_recon_loss: 12700841.5000; val_masked_gp_l1_reg_loss: 176095.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77701.6562; val_chrom_access_recon_loss: 1025358.6094; val_global_loss: 16864592.8750; val_optim_loss: 16864592.8750
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9392; val_auprc_score: 0.9138; val_best_acc_score: 0.8847; val_best_f1_score: 0.8890; train_kl_reg_loss: 121314.4489; train_edge_recon_loss: 2745721.5379; train_gene_expr_recon_loss: 12798112.8636; train_masked_gp_l1_reg_loss: 176091.4657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77695.0447; train_chrom_access_recon_loss: 1032949.6477; train_global_loss: 16951884.9394; train_optim_loss: 16951884.9394; val_kl_reg_loss: 120262.5869; val_edge_recon_loss: 2763833.1875; val_gene_expr_recon_loss: 12842515.8750; val_masked_gp_l1_reg_loss: 176087.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77690.5703; val_chrom_access_recon_loss: 1038466.2969; val_global_loss: 17018857.1250; val_optim_loss: 17018857.1250
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9429; val_auprc_score: 0.9207; val_best_acc_score: 0.8877; val_best_f1_score: 0.8921; train_kl_reg_loss: 121175.1869; train_edge_recon_loss: 2743794.0909; train_gene_expr_recon_loss: 12786421.6667; train_masked_gp_l1_reg_loss: 176085.1797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77687.1515; train_chrom_access_recon_loss: 1032204.3438; train_global_loss: 16937367.6515; train_optim_loss: 16937367.6515; val_kl_reg_loss: 119905.3965; val_edge_recon_loss: 2804717.5312; val_gene_expr_recon_loss: 12775673.3750; val_masked_gp_l1_reg_loss: 176083.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77683.2422; val_chrom_access_recon_loss: 1031849.9688; val_global_loss: 16985912.1250; val_optim_loss: 16985912.1250
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9471; val_auprc_score: 0.9334; val_best_acc_score: 0.8896; val_best_f1_score: 0.8952; train_kl_reg_loss: 121125.5049; train_edge_recon_loss: 2760645.1856; train_gene_expr_recon_loss: 12771274.0758; train_masked_gp_l1_reg_loss: 176081.7024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77680.6982; train_chrom_access_recon_loss: 1030847.6534; train_global_loss: 16937654.8030; train_optim_loss: 16937654.8030; val_kl_reg_loss: 120311.0996; val_edge_recon_loss: 2789264.5625; val_gene_expr_recon_loss: 12814165.1250; val_masked_gp_l1_reg_loss: 176079.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77677.6797; val_chrom_access_recon_loss: 1029944.3750; val_global_loss: 17007443.2500; val_optim_loss: 17007443.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9452; val_auprc_score: 0.9287; val_best_acc_score: 0.8893; val_best_f1_score: 0.8946; train_kl_reg_loss: 121030.8177; train_edge_recon_loss: 2750775.4432; train_gene_expr_recon_loss: 12799415.0152; train_masked_gp_l1_reg_loss: 176078.0627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77674.0187; train_chrom_access_recon_loss: 1033674.5549; train_global_loss: 16958647.9394; train_optim_loss: 16958647.9394; val_kl_reg_loss: 120408.3379; val_edge_recon_loss: 2748017.7812; val_gene_expr_recon_loss: 12803820.2500; val_masked_gp_l1_reg_loss: 176076.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77672.7734; val_chrom_access_recon_loss: 1039634.8516; val_global_loss: 16965631.1250; val_optim_loss: 16965631.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9396; val_auprc_score: 0.9146; val_best_acc_score: 0.8842; val_best_f1_score: 0.8887; train_kl_reg_loss: 121224.4737; train_edge_recon_loss: 2745815.5758; train_gene_expr_recon_loss: 12794021.8485; train_masked_gp_l1_reg_loss: 176073.3745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77637.9138; train_chrom_access_recon_loss: 1033077.4602; train_global_loss: 16947850.6667; train_optim_loss: 16947850.6667; val_kl_reg_loss: 120439.5605; val_edge_recon_loss: 2797637.0000; val_gene_expr_recon_loss: 12909631.5000; val_masked_gp_l1_reg_loss: 176072.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77631.1172; val_chrom_access_recon_loss: 1040494.1641; val_global_loss: 17121905.2500; val_optim_loss: 17121905.2500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9400; val_auprc_score: 0.9183; val_best_acc_score: 0.8826; val_best_f1_score: 0.8893; train_kl_reg_loss: 121161.3937; train_edge_recon_loss: 2745029.1061; train_gene_expr_recon_loss: 12787442.4394; train_masked_gp_l1_reg_loss: 176071.7060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77630.4506; train_chrom_access_recon_loss: 1032182.5720; train_global_loss: 16939517.7273; train_optim_loss: 16939517.7273; val_kl_reg_loss: 120195.1484; val_edge_recon_loss: 2801586.7188; val_gene_expr_recon_loss: 12840790.0000; val_masked_gp_l1_reg_loss: 176071.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77629.9609; val_chrom_access_recon_loss: 1031982.4375; val_global_loss: 17048255.5000; val_optim_loss: 17048255.5000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9430; val_auprc_score: 0.9244; val_best_acc_score: 0.8885; val_best_f1_score: 0.8934; train_kl_reg_loss: 121095.0374; train_edge_recon_loss: 2746966.6174; train_gene_expr_recon_loss: 12788702.3030; train_masked_gp_l1_reg_loss: 176071.0518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77629.5135; train_chrom_access_recon_loss: 1032290.0275; train_global_loss: 16942754.3636; train_optim_loss: 16942754.3636; val_kl_reg_loss: 120965.2734; val_edge_recon_loss: 2751699.2812; val_gene_expr_recon_loss: 12912976.5000; val_masked_gp_l1_reg_loss: 176070.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77629.0859; val_chrom_access_recon_loss: 1042180.4531; val_global_loss: 17081521.0000; val_optim_loss: 17081521.0000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9396; val_auprc_score: 0.9165; val_best_acc_score: 0.8855; val_best_f1_score: 0.8909; train_kl_reg_loss: 121178.6539; train_edge_recon_loss: 2745519.6023; train_gene_expr_recon_loss: 12786950.8333; train_masked_gp_l1_reg_loss: 176070.5739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77628.6817; train_chrom_access_recon_loss: 1031917.4640; train_global_loss: 16939265.8636; train_optim_loss: 16939265.8636; val_kl_reg_loss: 121232.1162; val_edge_recon_loss: 2768249.4062; val_gene_expr_recon_loss: 12847724.5000; val_masked_gp_l1_reg_loss: 176070.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77628.3828; val_chrom_access_recon_loss: 1037981.4375; val_global_loss: 17028885.5000; val_optim_loss: 17028885.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 45 min 48 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9403
val AUPRC score: 0.9182
val best accuracy score: 0.8912
val best F1 score: 0.8960
val target rna MSE score: 1.0256
val source rna MSE score: 0.3420
val target atac MSE score: 0.4848
val source atac MSE score: 0.1047
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
