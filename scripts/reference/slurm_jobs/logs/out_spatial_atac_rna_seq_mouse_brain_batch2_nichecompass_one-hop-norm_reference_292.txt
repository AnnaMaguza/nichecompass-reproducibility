[True]
Run timestamp: 07092023_071703_292.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_292']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 797 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3511, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 797
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 797

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7204; val_auprc_score: 0.6940; val_best_acc_score: 0.5046; val_best_f1_score: 0.6685; train_kl_reg_loss: 52048.4177; train_edge_recon_loss: 3534746.0076; train_gene_expr_recon_loss: 12384145.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 814533.5180; train_chrom_access_recon_loss: 4386986.0985; train_global_loss: 21172459.6061; train_optim_loss: 21172459.6061; val_kl_reg_loss: 95044.2236; val_edge_recon_loss: 4064795.8438; val_gene_expr_recon_loss: 11418982.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 619228.3125; val_chrom_access_recon_loss: 4175522.0938; val_global_loss: 20373572.5000; val_optim_loss: 20373572.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7319; val_auprc_score: 0.7179; val_best_acc_score: 0.6171; val_best_f1_score: 0.7070; train_kl_reg_loss: 97203.7584; train_edge_recon_loss: 3521412.0379; train_gene_expr_recon_loss: 11269032.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 455645.3703; train_chrom_access_recon_loss: 4154073.2121; train_global_loss: 19497367.2727; train_optim_loss: 19497367.2727; val_kl_reg_loss: 98514.4756; val_edge_recon_loss: 4055695.1250; val_gene_expr_recon_loss: 11094737.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 318227.9688; val_chrom_access_recon_loss: 4104136.6250; val_global_loss: 19671312.0000; val_optim_loss: 19671312.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7972; val_auprc_score: 0.7809; val_best_acc_score: 0.6900; val_best_f1_score: 0.7369; train_kl_reg_loss: 84578.3762; train_edge_recon_loss: 3507994.7462; train_gene_expr_recon_loss: 11116342.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 238876.9744; train_chrom_access_recon_loss: 4110361.3977; train_global_loss: 19058154.0606; train_optim_loss: 19058154.0606; val_kl_reg_loss: 85539.7676; val_edge_recon_loss: 3935624.1250; val_gene_expr_recon_loss: 11035671.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 176913.2812; val_chrom_access_recon_loss: 4094900.0625; val_global_loss: 19328648.5000; val_optim_loss: 19328648.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8250; val_auprc_score: 0.8021; val_best_acc_score: 0.7434; val_best_f1_score: 0.7768; train_kl_reg_loss: 65705.3853; train_edge_recon_loss: 3364133.7879; train_gene_expr_recon_loss: 11047583.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142121.9335; train_chrom_access_recon_loss: 4097509.7348; train_global_loss: 18717054.4242; train_optim_loss: 18717054.4242; val_kl_reg_loss: 65091.1294; val_edge_recon_loss: 3192446.4688; val_gene_expr_recon_loss: 11002906.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114522.4219; val_chrom_access_recon_loss: 4062273.1562; val_global_loss: 18437239.2500; val_optim_loss: 18437239.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8594; val_auprc_score: 0.8307; val_best_acc_score: 0.7783; val_best_f1_score: 0.7992; train_kl_reg_loss: 84565.1709; train_edge_recon_loss: 2990220.4432; train_gene_expr_recon_loss: 10978497.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97339.7757; train_chrom_access_recon_loss: 4074915.2386; train_global_loss: 18225538.5758; train_optim_loss: 18225538.5758; val_kl_reg_loss: 90715.3662; val_edge_recon_loss: 2932320.3438; val_gene_expr_recon_loss: 10998686.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82066.3750; val_chrom_access_recon_loss: 4041671.1250; val_global_loss: 18145459.5000; val_optim_loss: 18145459.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8805; val_auprc_score: 0.8492; val_best_acc_score: 0.8020; val_best_f1_score: 0.8197; train_kl_reg_loss: 91149.8523; train_edge_recon_loss: 2899739.5227; train_gene_expr_recon_loss: 10896605.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72045.3087; train_chrom_access_recon_loss: 4050285.1894; train_global_loss: 18009825.3030; train_optim_loss: 18009825.3030; val_kl_reg_loss: 85108.0762; val_edge_recon_loss: 2912099.0938; val_gene_expr_recon_loss: 10868914.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63496.5195; val_chrom_access_recon_loss: 4026061.7500; val_global_loss: 17955680.2500; val_optim_loss: 17955680.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8986; val_auprc_score: 0.8661; val_best_acc_score: 0.8302; val_best_f1_score: 0.8410; train_kl_reg_loss: 87108.9923; train_edge_recon_loss: 2858369.6742; train_gene_expr_recon_loss: 10825078.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57449.2364; train_chrom_access_recon_loss: 4033951.5152; train_global_loss: 17861958.1818; train_optim_loss: 17861958.1818; val_kl_reg_loss: 86914.2002; val_edge_recon_loss: 2841044.4688; val_gene_expr_recon_loss: 10876550.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51979.6875; val_chrom_access_recon_loss: 4005003.5938; val_global_loss: 17861492.5000; val_optim_loss: 17861492.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8960; val_auprc_score: 0.8584; val_best_acc_score: 0.8388; val_best_f1_score: 0.8521; train_kl_reg_loss: 88676.0730; train_edge_recon_loss: 2821651.0758; train_gene_expr_recon_loss: 10763378.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48293.4183; train_chrom_access_recon_loss: 4010217.4280; train_global_loss: 17732216.3636; train_optim_loss: 17732216.3636; val_kl_reg_loss: 86183.4883; val_edge_recon_loss: 2846620.1562; val_gene_expr_recon_loss: 10768263.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44900.4688; val_chrom_access_recon_loss: 3976025.5000; val_global_loss: 17721993.0000; val_optim_loss: 17721993.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9072; val_auprc_score: 0.8781; val_best_acc_score: 0.8372; val_best_f1_score: 0.8482; train_kl_reg_loss: 85834.4395; train_edge_recon_loss: 2806267.0076; train_gene_expr_recon_loss: 10722903.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42328.4703; train_chrom_access_recon_loss: 3998742.0189; train_global_loss: 17656075.0000; train_optim_loss: 17656075.0000; val_kl_reg_loss: 81358.6689; val_edge_recon_loss: 2845396.1562; val_gene_expr_recon_loss: 10645488.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40112.6875; val_chrom_access_recon_loss: 3937568.7812; val_global_loss: 17549925.2500; val_optim_loss: 17549925.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9065; val_auprc_score: 0.8791; val_best_acc_score: 0.8439; val_best_f1_score: 0.8538; train_kl_reg_loss: 83766.9925; train_edge_recon_loss: 2793428.2803; train_gene_expr_recon_loss: 10674493.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38497.6659; train_chrom_access_recon_loss: 3980594.5530; train_global_loss: 17570781.5152; train_optim_loss: 17570781.5152; val_kl_reg_loss: 82674.5381; val_edge_recon_loss: 2841771.0000; val_gene_expr_recon_loss: 10606586.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37236.7969; val_chrom_access_recon_loss: 3923653.4062; val_global_loss: 17491922.8750; val_optim_loss: 17491922.8750
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9067; val_auprc_score: 0.8764; val_best_acc_score: 0.8431; val_best_f1_score: 0.8565; train_kl_reg_loss: 82701.6501; train_edge_recon_loss: 2792287.4735; train_gene_expr_recon_loss: 10627370.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35982.4855; train_chrom_access_recon_loss: 3963630.1932; train_global_loss: 17501972.7424; train_optim_loss: 17501972.7424; val_kl_reg_loss: 77804.7188; val_edge_recon_loss: 2822342.1875; val_gene_expr_recon_loss: 10569558.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35091.3008; val_chrom_access_recon_loss: 3923777.4062; val_global_loss: 17428573.7500; val_optim_loss: 17428573.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9145; val_auprc_score: 0.8809; val_best_acc_score: 0.8568; val_best_f1_score: 0.8651; train_kl_reg_loss: 80333.0600; train_edge_recon_loss: 2777426.1742; train_gene_expr_recon_loss: 10590496.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34126.6602; train_chrom_access_recon_loss: 3953687.0152; train_global_loss: 17436069.7424; train_optim_loss: 17436069.7424; val_kl_reg_loss: 77743.0117; val_edge_recon_loss: 2809178.1250; val_gene_expr_recon_loss: 10562113.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33615.5508; val_chrom_access_recon_loss: 3912006.7188; val_global_loss: 17394657.2500; val_optim_loss: 17394657.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9145; val_auprc_score: 0.8777; val_best_acc_score: 0.8568; val_best_f1_score: 0.8689; train_kl_reg_loss: 77170.7031; train_edge_recon_loss: 2767784.2197; train_gene_expr_recon_loss: 10547121.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32893.8740; train_chrom_access_recon_loss: 3937881.9280; train_global_loss: 17362852.3636; train_optim_loss: 17362852.3636; val_kl_reg_loss: 78280.6387; val_edge_recon_loss: 2811160.5625; val_gene_expr_recon_loss: 10480093.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32436.2305; val_chrom_access_recon_loss: 3930066.5312; val_global_loss: 17332037.7500; val_optim_loss: 17332037.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9162; val_auprc_score: 0.8822; val_best_acc_score: 0.8571; val_best_f1_score: 0.8687; train_kl_reg_loss: 75633.3893; train_edge_recon_loss: 2749968.0152; train_gene_expr_recon_loss: 10511545.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31954.1284; train_chrom_access_recon_loss: 3922944.0985; train_global_loss: 17292045.2121; train_optim_loss: 17292045.2121; val_kl_reg_loss: 75110.0449; val_edge_recon_loss: 2792452.6875; val_gene_expr_recon_loss: 10506220.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31645.6484; val_chrom_access_recon_loss: 3910261.8438; val_global_loss: 17315690.7500; val_optim_loss: 17315690.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9207; val_auprc_score: 0.8921; val_best_acc_score: 0.8611; val_best_f1_score: 0.8715; train_kl_reg_loss: 74453.2737; train_edge_recon_loss: 2755452.3409; train_gene_expr_recon_loss: 10482122.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31241.8380; train_chrom_access_recon_loss: 3916132.1477; train_global_loss: 17259401.8636; train_optim_loss: 17259401.8636; val_kl_reg_loss: 73792.6914; val_edge_recon_loss: 2784402.1250; val_gene_expr_recon_loss: 10476143.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30875.3301; val_chrom_access_recon_loss: 3908048.2812; val_global_loss: 17273261.2500; val_optim_loss: 17273261.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9224; val_auprc_score: 0.8894; val_best_acc_score: 0.8646; val_best_f1_score: 0.8729; train_kl_reg_loss: 73416.6858; train_edge_recon_loss: 2731056.9621; train_gene_expr_recon_loss: 10443545.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30526.9029; train_chrom_access_recon_loss: 3899807.0114; train_global_loss: 17178352.4848; train_optim_loss: 17178352.4848; val_kl_reg_loss: 71634.1045; val_edge_recon_loss: 2773088.8125; val_gene_expr_recon_loss: 10463207.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30426.1660; val_chrom_access_recon_loss: 3875337.0625; val_global_loss: 17213693.7500; val_optim_loss: 17213693.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9172; val_auprc_score: 0.8854; val_best_acc_score: 0.8638; val_best_f1_score: 0.8713; train_kl_reg_loss: 73105.4026; train_edge_recon_loss: 2740880.1667; train_gene_expr_recon_loss: 10410104.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30165.5882; train_chrom_access_recon_loss: 3889602.4621; train_global_loss: 17143857.8636; train_optim_loss: 17143857.8636; val_kl_reg_loss: 74139.9766; val_edge_recon_loss: 2769034.8750; val_gene_expr_recon_loss: 10406019.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30001.2812; val_chrom_access_recon_loss: 3882576.0312; val_global_loss: 17161771.2500; val_optim_loss: 17161771.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9273; val_auprc_score: 0.9062; val_best_acc_score: 0.8670; val_best_f1_score: 0.8771; train_kl_reg_loss: 70467.7431; train_edge_recon_loss: 2732104.6326; train_gene_expr_recon_loss: 10389521.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29801.7648; train_chrom_access_recon_loss: 3878979.3333; train_global_loss: 17100874.8636; train_optim_loss: 17100874.8636; val_kl_reg_loss: 71804.7568; val_edge_recon_loss: 2764465.9062; val_gene_expr_recon_loss: 10314669.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29642.3008; val_chrom_access_recon_loss: 3851843.8750; val_global_loss: 17032426.2500; val_optim_loss: 17032426.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9227; val_auprc_score: 0.8912; val_best_acc_score: 0.8627; val_best_f1_score: 0.8737; train_kl_reg_loss: 70214.0855; train_edge_recon_loss: 2730256.7424; train_gene_expr_recon_loss: 10352053.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29432.6821; train_chrom_access_recon_loss: 3870136.4886; train_global_loss: 17052093.7273; train_optim_loss: 17052093.7273; val_kl_reg_loss: 68398.5352; val_edge_recon_loss: 2764896.1250; val_gene_expr_recon_loss: 10282195.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29530.2070; val_chrom_access_recon_loss: 3819698.5000; val_global_loss: 16964719.2500; val_optim_loss: 16964719.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9335; val_auprc_score: 0.9152; val_best_acc_score: 0.8748; val_best_f1_score: 0.8813; train_kl_reg_loss: 68068.2629; train_edge_recon_loss: 2720144.4962; train_gene_expr_recon_loss: 10327524.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29323.7979; train_chrom_access_recon_loss: 3855051.6856; train_global_loss: 17000113.3030; train_optim_loss: 17000113.3030; val_kl_reg_loss: 67362.5723; val_edge_recon_loss: 2760709.7812; val_gene_expr_recon_loss: 10373903.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29160.1387; val_chrom_access_recon_loss: 3834560.5625; val_global_loss: 17065696.7500; val_optim_loss: 17065696.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9323; val_auprc_score: 0.9036; val_best_acc_score: 0.8756; val_best_f1_score: 0.8823; train_kl_reg_loss: 66955.0897; train_edge_recon_loss: 2716061.2917; train_gene_expr_recon_loss: 10305220.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28983.6681; train_chrom_access_recon_loss: 3849267.9545; train_global_loss: 16966488.3030; train_optim_loss: 16966488.3030; val_kl_reg_loss: 67284.5557; val_edge_recon_loss: 2740510.5938; val_gene_expr_recon_loss: 10285245.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29019.6172; val_chrom_access_recon_loss: 3831639.1250; val_global_loss: 16953699.5000; val_optim_loss: 16953699.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9363; val_auprc_score: 0.9106; val_best_acc_score: 0.8794; val_best_f1_score: 0.8852; train_kl_reg_loss: 65521.1002; train_edge_recon_loss: 2712076.3068; train_gene_expr_recon_loss: 10280489.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28963.0628; train_chrom_access_recon_loss: 3838709.9886; train_global_loss: 16925759.5303; train_optim_loss: 16925759.5303; val_kl_reg_loss: 65071.9287; val_edge_recon_loss: 2729068.8125; val_gene_expr_recon_loss: 10288354.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28941.0215; val_chrom_access_recon_loss: 3786149.4375; val_global_loss: 16897586.0000; val_optim_loss: 16897586.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9390; val_auprc_score: 0.9146; val_best_acc_score: 0.8855; val_best_f1_score: 0.8909; train_kl_reg_loss: 66072.1807; train_edge_recon_loss: 2694653.6288; train_gene_expr_recon_loss: 10255286.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28883.5550; train_chrom_access_recon_loss: 3828309.2765; train_global_loss: 16873205.3788; train_optim_loss: 16873205.3788; val_kl_reg_loss: 65917.1060; val_edge_recon_loss: 2741842.5312; val_gene_expr_recon_loss: 10286334.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28971.1309; val_chrom_access_recon_loss: 3822701.9062; val_global_loss: 16945766.7500; val_optim_loss: 16945766.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9430; val_auprc_score: 0.9266; val_best_acc_score: 0.8890; val_best_f1_score: 0.8943; train_kl_reg_loss: 64768.1351; train_edge_recon_loss: 2701106.1174; train_gene_expr_recon_loss: 10230146.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28773.7147; train_chrom_access_recon_loss: 3819410.2121; train_global_loss: 16844204.3333; train_optim_loss: 16844204.3333; val_kl_reg_loss: 64265.5093; val_edge_recon_loss: 2732057.4688; val_gene_expr_recon_loss: 10296748.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28797.1562; val_chrom_access_recon_loss: 3805140.2500; val_global_loss: 16927008.8750; val_optim_loss: 16927008.8750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9389; val_auprc_score: 0.9098; val_best_acc_score: 0.8826; val_best_f1_score: 0.8872; train_kl_reg_loss: 64650.7839; train_edge_recon_loss: 2702203.6023; train_gene_expr_recon_loss: 10214056.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28647.5915; train_chrom_access_recon_loss: 3810670.9773; train_global_loss: 16820229.2424; train_optim_loss: 16820229.2424; val_kl_reg_loss: 61574.3208; val_edge_recon_loss: 2754284.6875; val_gene_expr_recon_loss: 10185157.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28829.4824; val_chrom_access_recon_loss: 3758205.3750; val_global_loss: 16788051.1250; val_optim_loss: 16788051.1250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9411; val_auprc_score: 0.9127; val_best_acc_score: 0.8874; val_best_f1_score: 0.8934; train_kl_reg_loss: 67568.8070; train_edge_recon_loss: 2724210.6515; train_gene_expr_recon_loss: 10021566.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25202.8259; train_chrom_access_recon_loss: 3785581.7538; train_global_loss: 16624130.5455; train_optim_loss: 16624130.5455; val_kl_reg_loss: 46317.2358; val_edge_recon_loss: 2730496.5625; val_gene_expr_recon_loss: 9955607.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24375.1855; val_chrom_access_recon_loss: 3741878.1875; val_global_loss: 16498673.8750; val_optim_loss: 16498673.8750
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9406; val_auprc_score: 0.9177; val_best_acc_score: 0.8855; val_best_f1_score: 0.8918; train_kl_reg_loss: 67084.7401; train_edge_recon_loss: 2700188.4811; train_gene_expr_recon_loss: 9943321.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24353.5364; train_chrom_access_recon_loss: 3739549.5644; train_global_loss: 16474497.4848; train_optim_loss: 16474497.4848; val_kl_reg_loss: 47189.8716; val_edge_recon_loss: 2758391.2812; val_gene_expr_recon_loss: 9957019.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24366.1230; val_chrom_access_recon_loss: 3720759.0312; val_global_loss: 16507725.6250; val_optim_loss: 16507725.6250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9449; val_auprc_score: 0.9269; val_best_acc_score: 0.8904; val_best_f1_score: 0.8958; train_kl_reg_loss: 65845.8915; train_edge_recon_loss: 2696066.4167; train_gene_expr_recon_loss: 9920229.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24407.9756; train_chrom_access_recon_loss: 3727577.4318; train_global_loss: 16434127.0606; train_optim_loss: 16434127.0606; val_kl_reg_loss: 48725.1982; val_edge_recon_loss: 2714230.0312; val_gene_expr_recon_loss: 9925973.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24480.6094; val_chrom_access_recon_loss: 3695606.2812; val_global_loss: 16409015.7500; val_optim_loss: 16409015.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9506; val_auprc_score: 0.9373; val_best_acc_score: 0.8915; val_best_f1_score: 0.8956; train_kl_reg_loss: 62914.8047; train_edge_recon_loss: 2682926.5947; train_gene_expr_recon_loss: 9894250.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24551.4842; train_chrom_access_recon_loss: 3718367.6402; train_global_loss: 16383011.4697; train_optim_loss: 16383011.4697; val_kl_reg_loss: 48722.3877; val_edge_recon_loss: 2714842.2812; val_gene_expr_recon_loss: 9943236.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24587.2559; val_chrom_access_recon_loss: 3710322.6875; val_global_loss: 16441710.6250; val_optim_loss: 16441710.6250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9434; val_auprc_score: 0.9193; val_best_acc_score: 0.8912; val_best_f1_score: 0.8964; train_kl_reg_loss: 61869.8264; train_edge_recon_loss: 2700625.8636; train_gene_expr_recon_loss: 9853733.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24657.8593; train_chrom_access_recon_loss: 3706963.4394; train_global_loss: 16347850.8788; train_optim_loss: 16347850.8788; val_kl_reg_loss: 48795.5024; val_edge_recon_loss: 2743900.2812; val_gene_expr_recon_loss: 9906309.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24740.4219; val_chrom_access_recon_loss: 3677641.5625; val_global_loss: 16401386.1250; val_optim_loss: 16401386.1250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9442; val_auprc_score: 0.9261; val_best_acc_score: 0.8904; val_best_f1_score: 0.8963; train_kl_reg_loss: 60967.0243; train_edge_recon_loss: 2684588.5303; train_gene_expr_recon_loss: 9834983.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24755.7529; train_chrom_access_recon_loss: 3704629.0682; train_global_loss: 16309923.5000; train_optim_loss: 16309923.5000; val_kl_reg_loss: 48468.2969; val_edge_recon_loss: 2734711.8125; val_gene_expr_recon_loss: 9915294.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24802.5781; val_chrom_access_recon_loss: 3711057.9062; val_global_loss: 16434336.0000; val_optim_loss: 16434336.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9486; val_auprc_score: 0.9277; val_best_acc_score: 0.8952; val_best_f1_score: 0.8989; train_kl_reg_loss: 57756.9221; train_edge_recon_loss: 2681092.1402; train_gene_expr_recon_loss: 9813834.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24808.0119; train_chrom_access_recon_loss: 3690114.7576; train_global_loss: 16267606.1667; train_optim_loss: 16267606.1667; val_kl_reg_loss: 48688.8521; val_edge_recon_loss: 2716459.7188; val_gene_expr_recon_loss: 9906288.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24866.8672; val_chrom_access_recon_loss: 3656731.1562; val_global_loss: 16353035.2500; val_optim_loss: 16353035.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9502; val_auprc_score: 0.9327; val_best_acc_score: 0.8939; val_best_f1_score: 0.8984; train_kl_reg_loss: 57095.2821; train_edge_recon_loss: 2683692.7008; train_gene_expr_recon_loss: 9796237.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24874.6646; train_chrom_access_recon_loss: 3688465.2727; train_global_loss: 16250365.0303; train_optim_loss: 16250365.0303; val_kl_reg_loss: 49143.6240; val_edge_recon_loss: 2710213.7188; val_gene_expr_recon_loss: 9805252.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24920.6445; val_chrom_access_recon_loss: 3666255.9688; val_global_loss: 16255786.3750; val_optim_loss: 16255786.3750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9462; val_auprc_score: 0.9236; val_best_acc_score: 0.8995; val_best_f1_score: 0.9036; train_kl_reg_loss: 56114.5355; train_edge_recon_loss: 2681618.8977; train_gene_expr_recon_loss: 9775847.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24920.1577; train_chrom_access_recon_loss: 3680058.8902; train_global_loss: 16218560.0303; train_optim_loss: 16218560.0303; val_kl_reg_loss: 49205.3809; val_edge_recon_loss: 2712455.2812; val_gene_expr_recon_loss: 9791280.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24978.5215; val_chrom_access_recon_loss: 3631500.5312; val_global_loss: 16209420.6250; val_optim_loss: 16209420.6250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9516; val_auprc_score: 0.9334; val_best_acc_score: 0.9003; val_best_f1_score: 0.9037; train_kl_reg_loss: 54490.5768; train_edge_recon_loss: 2676536.4394; train_gene_expr_recon_loss: 9765051.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24980.6657; train_chrom_access_recon_loss: 3674947.4811; train_global_loss: 16196007.0303; train_optim_loss: 16196007.0303; val_kl_reg_loss: 47774.7646; val_edge_recon_loss: 2706485.1875; val_gene_expr_recon_loss: 9844635.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24988.4805; val_chrom_access_recon_loss: 3677905.8438; val_global_loss: 16301789.3750; val_optim_loss: 16301789.3750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9519; val_auprc_score: 0.9308; val_best_acc_score: 0.8976; val_best_f1_score: 0.9009; train_kl_reg_loss: 54305.0383; train_edge_recon_loss: 2673095.3068; train_gene_expr_recon_loss: 9744986.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25012.7699; train_chrom_access_recon_loss: 3666787.6174; train_global_loss: 16164187.6212; train_optim_loss: 16164187.6212; val_kl_reg_loss: 48437.7227; val_edge_recon_loss: 2703285.7812; val_gene_expr_recon_loss: 9732362.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25011.8125; val_chrom_access_recon_loss: 3646754.3125; val_global_loss: 16155852.1250; val_optim_loss: 16155852.1250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9530; val_auprc_score: 0.9381; val_best_acc_score: 0.8960; val_best_f1_score: 0.9003; train_kl_reg_loss: 53769.6905; train_edge_recon_loss: 2670146.2727; train_gene_expr_recon_loss: 9734181.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25021.2310; train_chrom_access_recon_loss: 3663794.4508; train_global_loss: 16146912.7424; train_optim_loss: 16146912.7424; val_kl_reg_loss: 48181.8979; val_edge_recon_loss: 2731334.3125; val_gene_expr_recon_loss: 9713298.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25104.7773; val_chrom_access_recon_loss: 3635225.7500; val_global_loss: 16153145.8750; val_optim_loss: 16153145.8750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9558; val_auprc_score: 0.9408; val_best_acc_score: 0.8984; val_best_f1_score: 0.9027; train_kl_reg_loss: 53181.9336; train_edge_recon_loss: 2668900.8371; train_gene_expr_recon_loss: 9718676.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25084.7212; train_chrom_access_recon_loss: 3655538.3220; train_global_loss: 16121382.3333; train_optim_loss: 16121382.3333; val_kl_reg_loss: 48707.2622; val_edge_recon_loss: 2700874.3125; val_gene_expr_recon_loss: 9758271.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25071.4180; val_chrom_access_recon_loss: 3664840.7812; val_global_loss: 16197765.1250; val_optim_loss: 16197765.1250
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9562; val_auprc_score: 0.9398; val_best_acc_score: 0.9041; val_best_f1_score: 0.9059; train_kl_reg_loss: 53199.6692; train_edge_recon_loss: 2674901.7538; train_gene_expr_recon_loss: 9698703.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25064.1481; train_chrom_access_recon_loss: 3652910.2803; train_global_loss: 16104779.0758; train_optim_loss: 16104779.0758; val_kl_reg_loss: 47387.7729; val_edge_recon_loss: 2677964.3125; val_gene_expr_recon_loss: 9709795.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25064.7793; val_chrom_access_recon_loss: 3636656.9375; val_global_loss: 16096869.6250; val_optim_loss: 16096869.6250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9582; val_auprc_score: 0.9439; val_best_acc_score: 0.9062; val_best_f1_score: 0.9098; train_kl_reg_loss: 51853.4754; train_edge_recon_loss: 2677688.9356; train_gene_expr_recon_loss: 9691504.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25052.0604; train_chrom_access_recon_loss: 3646491.6553; train_global_loss: 16092590.8788; train_optim_loss: 16092590.8788; val_kl_reg_loss: 44412.7012; val_edge_recon_loss: 2686585.1562; val_gene_expr_recon_loss: 9788904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25074.4766; val_chrom_access_recon_loss: 3631600.5000; val_global_loss: 16176576.6250; val_optim_loss: 16176576.6250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9559; val_auprc_score: 0.9361; val_best_acc_score: 0.9052; val_best_f1_score: 0.9097; train_kl_reg_loss: 50748.6236; train_edge_recon_loss: 2672509.8902; train_gene_expr_recon_loss: 9676754.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25090.1499; train_chrom_access_recon_loss: 3640940.6364; train_global_loss: 16066043.9545; train_optim_loss: 16066043.9545; val_kl_reg_loss: 45608.9414; val_edge_recon_loss: 2679559.5000; val_gene_expr_recon_loss: 9748328.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25125.0254; val_chrom_access_recon_loss: 3643375.3438; val_global_loss: 16141996.8750; val_optim_loss: 16141996.8750
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9592; val_auprc_score: 0.9467; val_best_acc_score: 0.9062; val_best_f1_score: 0.9096; train_kl_reg_loss: 49810.0607; train_edge_recon_loss: 2659373.5265; train_gene_expr_recon_loss: 9666922.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25086.1189; train_chrom_access_recon_loss: 3634715.4621; train_global_loss: 16035908.1970; train_optim_loss: 16035908.1970; val_kl_reg_loss: 45929.1499; val_edge_recon_loss: 2706057.1250; val_gene_expr_recon_loss: 9733732.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25067.1543; val_chrom_access_recon_loss: 3627838.1250; val_global_loss: 16138624.1250; val_optim_loss: 16138624.1250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9580; val_auprc_score: 0.9431; val_best_acc_score: 0.9081; val_best_f1_score: 0.9110; train_kl_reg_loss: 49688.8458; train_edge_recon_loss: 2678850.2879; train_gene_expr_recon_loss: 9654093.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25092.1923; train_chrom_access_recon_loss: 3631999.2538; train_global_loss: 16039723.9394; train_optim_loss: 16039723.9394; val_kl_reg_loss: 46702.4497; val_edge_recon_loss: 2671882.4375; val_gene_expr_recon_loss: 9698834.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25127.5117; val_chrom_access_recon_loss: 3640935.5625; val_global_loss: 16083482.8750; val_optim_loss: 16083482.8750
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9584; val_auprc_score: 0.9397; val_best_acc_score: 0.9159; val_best_f1_score: 0.9183; train_kl_reg_loss: 49722.4093; train_edge_recon_loss: 2666461.7803; train_gene_expr_recon_loss: 9643711.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25074.6633; train_chrom_access_recon_loss: 3628292.9318; train_global_loss: 16013263.1364; train_optim_loss: 16013263.1364; val_kl_reg_loss: 47171.7744; val_edge_recon_loss: 2687302.9375; val_gene_expr_recon_loss: 9547052.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25064.1035; val_chrom_access_recon_loss: 3603238.8750; val_global_loss: 15909829.8750; val_optim_loss: 15909829.8750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9616; val_auprc_score: 0.9487; val_best_acc_score: 0.9138; val_best_f1_score: 0.9164; train_kl_reg_loss: 49401.3932; train_edge_recon_loss: 2667452.5682; train_gene_expr_recon_loss: 9638329.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25041.5377; train_chrom_access_recon_loss: 3623610.3106; train_global_loss: 16003835.6364; train_optim_loss: 16003835.6364; val_kl_reg_loss: 45817.2280; val_edge_recon_loss: 2695230.1875; val_gene_expr_recon_loss: 9763484.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25031.8125; val_chrom_access_recon_loss: 3627022.6875; val_global_loss: 16156585.8750; val_optim_loss: 16156585.8750
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9571; val_auprc_score: 0.9384; val_best_acc_score: 0.9081; val_best_f1_score: 0.9111; train_kl_reg_loss: 48602.4203; train_edge_recon_loss: 2667783.2614; train_gene_expr_recon_loss: 9620196.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25020.8255; train_chrom_access_recon_loss: 3622556.5758; train_global_loss: 15984159.6667; train_optim_loss: 15984159.6667; val_kl_reg_loss: 44964.8916; val_edge_recon_loss: 2712426.6562; val_gene_expr_recon_loss: 9572435.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25005.2441; val_chrom_access_recon_loss: 3586248.6562; val_global_loss: 15941081.0000; val_optim_loss: 15941081.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9597; val_auprc_score: 0.9397; val_best_acc_score: 0.9156; val_best_f1_score: 0.9184; train_kl_reg_loss: 48119.7535; train_edge_recon_loss: 2662917.3068; train_gene_expr_recon_loss: 9612742.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24995.3702; train_chrom_access_recon_loss: 3616815.9811; train_global_loss: 15965591.1061; train_optim_loss: 15965591.1061; val_kl_reg_loss: 46346.6089; val_edge_recon_loss: 2646403.2188; val_gene_expr_recon_loss: 9628786.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24989.3555; val_chrom_access_recon_loss: 3654250.9375; val_global_loss: 16000776.6250; val_optim_loss: 16000776.6250
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9559; val_auprc_score: 0.9400; val_best_acc_score: 0.9084; val_best_f1_score: 0.9122; train_kl_reg_loss: 48002.7412; train_edge_recon_loss: 2657654.6818; train_gene_expr_recon_loss: 9598701.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24953.6376; train_chrom_access_recon_loss: 3608203.0189; train_global_loss: 15937515.5909; train_optim_loss: 15937515.5909; val_kl_reg_loss: 44918.7988; val_edge_recon_loss: 2703742.3438; val_gene_expr_recon_loss: 9654645.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24916.4043; val_chrom_access_recon_loss: 3607471.9375; val_global_loss: 16035693.7500; val_optim_loss: 16035693.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9565; val_auprc_score: 0.9367; val_best_acc_score: 0.9060; val_best_f1_score: 0.9107; train_kl_reg_loss: 47280.0071; train_edge_recon_loss: 2664568.6553; train_gene_expr_recon_loss: 9583101.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23270.6215; train_chrom_access_recon_loss: 3604764.8258; train_global_loss: 15922985.3485; train_optim_loss: 15922985.3485; val_kl_reg_loss: 45453.7920; val_edge_recon_loss: 2714730.1562; val_gene_expr_recon_loss: 9664662.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22895.1387; val_chrom_access_recon_loss: 3617281.1562; val_global_loss: 16065022.5000; val_optim_loss: 16065022.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9631; val_auprc_score: 0.9470; val_best_acc_score: 0.9146; val_best_f1_score: 0.9176; train_kl_reg_loss: 47780.1787; train_edge_recon_loss: 2661205.7841; train_gene_expr_recon_loss: 9582568.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22831.4916; train_chrom_access_recon_loss: 3603752.0038; train_global_loss: 15918137.4545; train_optim_loss: 15918137.4545; val_kl_reg_loss: 46261.4004; val_edge_recon_loss: 2694030.3125; val_gene_expr_recon_loss: 9674502.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22767.3301; val_chrom_access_recon_loss: 3612740.9688; val_global_loss: 16050301.6250; val_optim_loss: 16050301.6250
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9620; val_auprc_score: 0.9462; val_best_acc_score: 0.9162; val_best_f1_score: 0.9193; train_kl_reg_loss: 47872.6876; train_edge_recon_loss: 2666362.1780; train_gene_expr_recon_loss: 9576011.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22720.3902; train_chrom_access_recon_loss: 3602596.7159; train_global_loss: 15915563.3030; train_optim_loss: 15915563.3030; val_kl_reg_loss: 45973.6177; val_edge_recon_loss: 2665407.7188; val_gene_expr_recon_loss: 9649861.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22674.5273; val_chrom_access_recon_loss: 3607202.5312; val_global_loss: 15991120.3750; val_optim_loss: 15991120.3750
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9624; val_auprc_score: 0.9476; val_best_acc_score: 0.9078; val_best_f1_score: 0.9115; train_kl_reg_loss: 48052.7003; train_edge_recon_loss: 2655963.5682; train_gene_expr_recon_loss: 9570231.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22644.2818; train_chrom_access_recon_loss: 3598376.1894; train_global_loss: 15895268.5152; train_optim_loss: 15895268.5152; val_kl_reg_loss: 46535.8848; val_edge_recon_loss: 2704989.6250; val_gene_expr_recon_loss: 9635241.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22608.2070; val_chrom_access_recon_loss: 3613622.7812; val_global_loss: 16022997.2500; val_optim_loss: 16022997.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 24 min 58 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9568
val AUPRC score: 0.9397
val best accuracy score: 0.9089
val best F1 score: 0.9127
val target rna MSE score: 1.2504
val source rna MSE score: 0.3652
val target atac MSE score: 0.4733
val source atac MSE score: 0.1014
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
