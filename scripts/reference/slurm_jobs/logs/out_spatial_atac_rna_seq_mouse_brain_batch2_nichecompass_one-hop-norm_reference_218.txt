[True]
Run timestamp: 07092023_002703_218.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_218']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 18606 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 21320, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 18606
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 18606

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6696; val_auprc_score: 0.6544; val_best_acc_score: 0.5887; val_best_f1_score: 0.6871; train_kl_reg_loss: 38445.3693; train_edge_recon_loss: 3624704.4356; train_gene_expr_recon_loss: 12759901.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 832765.1818; train_chrom_access_recon_loss: 41489454.0606; train_global_loss: 58745271.1515; train_optim_loss: 58745271.1515; val_kl_reg_loss: 78544.6553; val_edge_recon_loss: 4059093.1250; val_gene_expr_recon_loss: 11584686.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 658956.3750; val_chrom_access_recon_loss: 39119455.5000; val_global_loss: 55500735.5000; val_optim_loss: 55500735.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6868; val_auprc_score: 0.6793; val_best_acc_score: 0.6282; val_best_f1_score: 0.6872; train_kl_reg_loss: 94479.5729; train_edge_recon_loss: 3595270.7727; train_gene_expr_recon_loss: 11425336.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 499496.0118; train_chrom_access_recon_loss: 39454664.4242; train_global_loss: 55069247.2121; train_optim_loss: 55069247.2121; val_kl_reg_loss: 118491.6953; val_edge_recon_loss: 4040636.1875; val_gene_expr_recon_loss: 11106212.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 360980.2500; val_chrom_access_recon_loss: 38439431.0000; val_global_loss: 54065750.5000; val_optim_loss: 54065750.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7708; val_auprc_score: 0.7604; val_best_acc_score: 0.6934; val_best_f1_score: 0.7328; train_kl_reg_loss: 105606.4876; train_edge_recon_loss: 3524952.4394; train_gene_expr_recon_loss: 11173447.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 277285.8279; train_chrom_access_recon_loss: 38986556.4242; train_global_loss: 54067848.1818; train_optim_loss: 54067848.1818; val_kl_reg_loss: 91232.7998; val_edge_recon_loss: 3847863.9062; val_gene_expr_recon_loss: 11071720.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 211660.0156; val_chrom_access_recon_loss: 38169530.0000; val_global_loss: 53392009.0000; val_optim_loss: 53392009.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8240; val_auprc_score: 0.8006; val_best_acc_score: 0.7329; val_best_f1_score: 0.7791; train_kl_reg_loss: 93042.5439; train_edge_recon_loss: 3299975.4545; train_gene_expr_recon_loss: 11068838.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 174737.0057; train_chrom_access_recon_loss: 38720337.9394; train_global_loss: 53356932.1212; train_optim_loss: 53356932.1212; val_kl_reg_loss: 113686.9854; val_edge_recon_loss: 3058816.3750; val_gene_expr_recon_loss: 10932338.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145169.2812; val_chrom_access_recon_loss: 37794323.0000; val_global_loss: 52044334.0000; val_optim_loss: 52044334.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8252; val_auprc_score: 0.7880; val_best_acc_score: 0.7431; val_best_f1_score: 0.7781; train_kl_reg_loss: 127709.3040; train_edge_recon_loss: 3022388.4773; train_gene_expr_recon_loss: 10964942.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126084.8915; train_chrom_access_recon_loss: 38440078.6061; train_global_loss: 52681203.8182; train_optim_loss: 52681203.8182; val_kl_reg_loss: 130485.4951; val_edge_recon_loss: 3044484.2500; val_gene_expr_recon_loss: 10900715.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109494.7500; val_chrom_access_recon_loss: 37956781.5000; val_global_loss: 52141962.0000; val_optim_loss: 52141962.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8304; val_auprc_score: 0.7806; val_best_acc_score: 0.7681; val_best_f1_score: 0.7922; train_kl_reg_loss: 124310.7644; train_edge_recon_loss: 2975229.9432; train_gene_expr_recon_loss: 10900976.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97677.9852; train_chrom_access_recon_loss: 38293324.5455; train_global_loss: 52391519.8788; train_optim_loss: 52391519.8788; val_kl_reg_loss: 117996.2852; val_edge_recon_loss: 2990604.6875; val_gene_expr_recon_loss: 10845661.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87447.8125; val_chrom_access_recon_loss: 37862891.5000; val_global_loss: 51904602.5000; val_optim_loss: 51904602.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8281; val_auprc_score: 0.7849; val_best_acc_score: 0.7681; val_best_f1_score: 0.7942; train_kl_reg_loss: 117302.7725; train_edge_recon_loss: 2949257.0265; train_gene_expr_recon_loss: 10835595.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79992.6977; train_chrom_access_recon_loss: 38122997.5758; train_global_loss: 52105145.2727; train_optim_loss: 52105145.2727; val_kl_reg_loss: 112598.8486; val_edge_recon_loss: 3024182.5625; val_gene_expr_recon_loss: 10766838.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73444.2109; val_chrom_access_recon_loss: 37523175.0000; val_global_loss: 51500239.5000; val_optim_loss: 51500239.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8538; val_auprc_score: 0.8099; val_best_acc_score: 0.7902; val_best_f1_score: 0.8188; train_kl_reg_loss: 108478.5289; train_edge_recon_loss: 2918309.9015; train_gene_expr_recon_loss: 10780610.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68310.7431; train_chrom_access_recon_loss: 37947423.7576; train_global_loss: 51823133.2727; train_optim_loss: 51823133.2727; val_kl_reg_loss: 106013.3066; val_edge_recon_loss: 2911945.5000; val_gene_expr_recon_loss: 10753393.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63869.4883; val_chrom_access_recon_loss: 37186763.5000; val_global_loss: 51021985.0000; val_optim_loss: 51021985.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8695; val_auprc_score: 0.8382; val_best_acc_score: 0.8001; val_best_f1_score: 0.8215; train_kl_reg_loss: 106800.0561; train_edge_recon_loss: 2887291.4280; train_gene_expr_recon_loss: 10737893.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60298.6539; train_chrom_access_recon_loss: 37798136.1818; train_global_loss: 51590419.6364; train_optim_loss: 51590419.6364; val_kl_reg_loss: 107425.3311; val_edge_recon_loss: 2907736.4062; val_gene_expr_recon_loss: 10635539.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56988.8477; val_chrom_access_recon_loss: 37152385.5000; val_global_loss: 50860075.0000; val_optim_loss: 50860075.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8914; val_auprc_score: 0.8539; val_best_acc_score: 0.8270; val_best_f1_score: 0.8442; train_kl_reg_loss: 109041.5102; train_edge_recon_loss: 2848880.1023; train_gene_expr_recon_loss: 10685173.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54573.3542; train_chrom_access_recon_loss: 37653031.3939; train_global_loss: 51350699.6970; train_optim_loss: 51350699.6970; val_kl_reg_loss: 109694.5645; val_edge_recon_loss: 2799269.9062; val_gene_expr_recon_loss: 10537063.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52447.0352; val_chrom_access_recon_loss: 36778765.5000; val_global_loss: 50277240.5000; val_optim_loss: 50277240.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8864; val_auprc_score: 0.8442; val_best_acc_score: 0.8213; val_best_f1_score: 0.8392; train_kl_reg_loss: 108336.5414; train_edge_recon_loss: 2829867.9735; train_gene_expr_recon_loss: 10647072.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50446.0093; train_chrom_access_recon_loss: 37506104.0000; train_global_loss: 51141826.9091; train_optim_loss: 51141826.9091; val_kl_reg_loss: 104658.6201; val_edge_recon_loss: 2845264.8125; val_gene_expr_recon_loss: 10584761.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48982.1289; val_chrom_access_recon_loss: 37081305.0000; val_global_loss: 50664971.0000; val_optim_loss: 50664971.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8992; val_auprc_score: 0.8696; val_best_acc_score: 0.8334; val_best_f1_score: 0.8500; train_kl_reg_loss: 103640.9002; train_edge_recon_loss: 2810155.8750; train_gene_expr_recon_loss: 10603496.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47409.4036; train_chrom_access_recon_loss: 37371708.3636; train_global_loss: 50936410.8485; train_optim_loss: 50936410.8485; val_kl_reg_loss: 102306.0967; val_edge_recon_loss: 2852962.0000; val_gene_expr_recon_loss: 10570235.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46176.9844; val_chrom_access_recon_loss: 36888611.5000; val_global_loss: 50460292.5000; val_optim_loss: 50460292.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8961; val_auprc_score: 0.8568; val_best_acc_score: 0.8388; val_best_f1_score: 0.8528; train_kl_reg_loss: 104375.5522; train_edge_recon_loss: 2809051.2273; train_gene_expr_recon_loss: 10564426.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45134.3528; train_chrom_access_recon_loss: 37255299.4545; train_global_loss: 50778287.0909; train_optim_loss: 50778287.0909; val_kl_reg_loss: 101879.5518; val_edge_recon_loss: 2824150.9688; val_gene_expr_recon_loss: 10474994.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44096.7812; val_chrom_access_recon_loss: 36542747.0000; val_global_loss: 49987870.0000; val_optim_loss: 49987870.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9037; val_auprc_score: 0.8686; val_best_acc_score: 0.8450; val_best_f1_score: 0.8602; train_kl_reg_loss: 101303.6018; train_edge_recon_loss: 2791398.8750; train_gene_expr_recon_loss: 10542416.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43216.8050; train_chrom_access_recon_loss: 37125105.0909; train_global_loss: 50603440.1212; train_optim_loss: 50603440.1212; val_kl_reg_loss: 95215.6562; val_edge_recon_loss: 2824232.0938; val_gene_expr_recon_loss: 10537842.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42440.3945; val_chrom_access_recon_loss: 36655586.0000; val_global_loss: 50155316.0000; val_optim_loss: 50155316.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8980; val_auprc_score: 0.8534; val_best_acc_score: 0.8461; val_best_f1_score: 0.8584; train_kl_reg_loss: 98561.9304; train_edge_recon_loss: 2794923.2045; train_gene_expr_recon_loss: 10507488.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41876.7682; train_chrom_access_recon_loss: 37017900.4242; train_global_loss: 50460750.9697; train_optim_loss: 50460750.9697; val_kl_reg_loss: 97356.3682; val_edge_recon_loss: 2814765.5938; val_gene_expr_recon_loss: 10455793.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41184.7188; val_chrom_access_recon_loss: 36414175.5000; val_global_loss: 49823275.5000; val_optim_loss: 49823275.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9080; val_auprc_score: 0.8770; val_best_acc_score: 0.8479; val_best_f1_score: 0.8604; train_kl_reg_loss: 97757.7031; train_edge_recon_loss: 2771919.6667; train_gene_expr_recon_loss: 10465747.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40552.1076; train_chrom_access_recon_loss: 36884443.7576; train_global_loss: 50260420.2424; train_optim_loss: 50260420.2424; val_kl_reg_loss: 96832.8984; val_edge_recon_loss: 2829017.7812; val_gene_expr_recon_loss: 10407996.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39897.0508; val_chrom_access_recon_loss: 36293220.5000; val_global_loss: 49666964.5000; val_optim_loss: 49666964.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9119; val_auprc_score: 0.8772; val_best_acc_score: 0.8544; val_best_f1_score: 0.8649; train_kl_reg_loss: 96013.6571; train_edge_recon_loss: 2761889.2386; train_gene_expr_recon_loss: 10438025.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39346.6074; train_chrom_access_recon_loss: 36768379.1515; train_global_loss: 50103653.6970; train_optim_loss: 50103653.6970; val_kl_reg_loss: 95730.4033; val_edge_recon_loss: 2820916.3438; val_gene_expr_recon_loss: 10408496.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38898.7422; val_chrom_access_recon_loss: 36276481.0000; val_global_loss: 49640523.0000; val_optim_loss: 49640523.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9171; val_auprc_score: 0.8877; val_best_acc_score: 0.8600; val_best_f1_score: 0.8689; train_kl_reg_loss: 94130.7704; train_edge_recon_loss: 2762308.7197; train_gene_expr_recon_loss: 10403641.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38480.7907; train_chrom_access_recon_loss: 36623126.0606; train_global_loss: 49921687.5758; train_optim_loss: 49921687.5758; val_kl_reg_loss: 92990.8965; val_edge_recon_loss: 2784049.8125; val_gene_expr_recon_loss: 10352540.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38028.8555; val_chrom_access_recon_loss: 36190852.5000; val_global_loss: 49458463.0000; val_optim_loss: 49458463.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9194; val_auprc_score: 0.8873; val_best_acc_score: 0.8587; val_best_f1_score: 0.8693; train_kl_reg_loss: 93223.4517; train_edge_recon_loss: 2758189.2083; train_gene_expr_recon_loss: 10372067.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37629.3584; train_chrom_access_recon_loss: 36501542.0909; train_global_loss: 49762651.6364; train_optim_loss: 49762651.6364; val_kl_reg_loss: 92617.5469; val_edge_recon_loss: 2790791.5938; val_gene_expr_recon_loss: 10251407.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37304.0625; val_chrom_access_recon_loss: 35557207.5000; val_global_loss: 48729328.0000; val_optim_loss: 48729328.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9248; val_auprc_score: 0.8973; val_best_acc_score: 0.8638; val_best_f1_score: 0.8716; train_kl_reg_loss: 91910.2604; train_edge_recon_loss: 2745559.0455; train_gene_expr_recon_loss: 10356341.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36901.2298; train_chrom_access_recon_loss: 36435372.5455; train_global_loss: 49666084.0000; train_optim_loss: 49666084.0000; val_kl_reg_loss: 91529.3145; val_edge_recon_loss: 2774884.4375; val_gene_expr_recon_loss: 10303790.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36576.6680; val_chrom_access_recon_loss: 36524717.0000; val_global_loss: 49731497.5000; val_optim_loss: 49731497.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9277; val_auprc_score: 0.9006; val_best_acc_score: 0.8692; val_best_f1_score: 0.8773; train_kl_reg_loss: 90771.9957; train_edge_recon_loss: 2743528.2727; train_gene_expr_recon_loss: 10321497.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36301.7689; train_chrom_access_recon_loss: 36276553.3636; train_global_loss: 49468653.1515; train_optim_loss: 49468653.1515; val_kl_reg_loss: 88549.5830; val_edge_recon_loss: 2753312.0625; val_gene_expr_recon_loss: 10306360.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35999.4922; val_chrom_access_recon_loss: 36135588.5000; val_global_loss: 49319809.0000; val_optim_loss: 49319809.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9271; val_auprc_score: 0.8991; val_best_acc_score: 0.8678; val_best_f1_score: 0.8780; train_kl_reg_loss: 90188.4339; train_edge_recon_loss: 2742158.1136; train_gene_expr_recon_loss: 10302428.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35739.2027; train_chrom_access_recon_loss: 36181724.4242; train_global_loss: 49352238.6667; train_optim_loss: 49352238.6667; val_kl_reg_loss: 89446.6992; val_edge_recon_loss: 2780497.3125; val_gene_expr_recon_loss: 10265633.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35566.2461; val_chrom_access_recon_loss: 35649498.5000; val_global_loss: 48820642.5000; val_optim_loss: 48820642.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9340; val_auprc_score: 0.9076; val_best_acc_score: 0.8780; val_best_f1_score: 0.8859; train_kl_reg_loss: 88299.3304; train_edge_recon_loss: 2736688.0909; train_gene_expr_recon_loss: 10288752.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35329.3021; train_chrom_access_recon_loss: 36106668.0606; train_global_loss: 49255737.0303; train_optim_loss: 49255737.0303; val_kl_reg_loss: 85917.7920; val_edge_recon_loss: 2755182.9062; val_gene_expr_recon_loss: 10304267.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35142.2930; val_chrom_access_recon_loss: 35639803.0000; val_global_loss: 48820313.0000; val_optim_loss: 48820313.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9283; val_auprc_score: 0.8947; val_best_acc_score: 0.8745; val_best_f1_score: 0.8810; train_kl_reg_loss: 87474.1862; train_edge_recon_loss: 2722397.3030; train_gene_expr_recon_loss: 10250570.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31724.9023; train_chrom_access_recon_loss: 35925408.1818; train_global_loss: 49017575.5152; train_optim_loss: 49017575.5152; val_kl_reg_loss: 88888.9062; val_edge_recon_loss: 2771288.8750; val_gene_expr_recon_loss: 10185897.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30508.6680; val_chrom_access_recon_loss: 35696257.5000; val_global_loss: 48772842.5000; val_optim_loss: 48772842.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9303; val_auprc_score: 0.9034; val_best_acc_score: 0.8692; val_best_f1_score: 0.8785; train_kl_reg_loss: 89459.7204; train_edge_recon_loss: 2727597.7311; train_gene_expr_recon_loss: 10253330.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30304.9675; train_chrom_access_recon_loss: 35915705.2121; train_global_loss: 49016398.7273; train_optim_loss: 49016398.7273; val_kl_reg_loss: 89634.9111; val_edge_recon_loss: 2781973.0625; val_gene_expr_recon_loss: 10148680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30183.8984; val_chrom_access_recon_loss: 35559679.5000; val_global_loss: 48610151.5000; val_optim_loss: 48610151.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9356; val_auprc_score: 0.9078; val_best_acc_score: 0.8775; val_best_f1_score: 0.8850; train_kl_reg_loss: 89936.4014; train_edge_recon_loss: 2733622.4432; train_gene_expr_recon_loss: 10247431.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30085.4972; train_chrom_access_recon_loss: 35898193.8182; train_global_loss: 48999269.3333; train_optim_loss: 48999269.3333; val_kl_reg_loss: 89869.7207; val_edge_recon_loss: 2753223.3438; val_gene_expr_recon_loss: 10289980.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29997.2266; val_chrom_access_recon_loss: 36052812.0000; val_global_loss: 49215883.0000; val_optim_loss: 49215883.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9292; val_auprc_score: 0.9026; val_best_acc_score: 0.8700; val_best_f1_score: 0.8770; train_kl_reg_loss: 89858.6819; train_edge_recon_loss: 2728376.6856; train_gene_expr_recon_loss: 10253025.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29919.6055; train_chrom_access_recon_loss: 35900206.0000; train_global_loss: 49001385.7576; train_optim_loss: 49001385.7576; val_kl_reg_loss: 89573.4980; val_edge_recon_loss: 2772531.7188; val_gene_expr_recon_loss: 10195578.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29858.1172; val_chrom_access_recon_loss: 35632618.0000; val_global_loss: 48720160.0000; val_optim_loss: 48720160.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9316; val_auprc_score: 0.9036; val_best_acc_score: 0.8802; val_best_f1_score: 0.8866; train_kl_reg_loss: 89947.1271; train_edge_recon_loss: 2732809.5758; train_gene_expr_recon_loss: 10252186.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29777.7996; train_chrom_access_recon_loss: 35901531.2121; train_global_loss: 49006252.3636; train_optim_loss: 49006252.3636; val_kl_reg_loss: 90828.3242; val_edge_recon_loss: 2754290.4688; val_gene_expr_recon_loss: 10184211.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29721.4902; val_chrom_access_recon_loss: 35341841.7500; val_global_loss: 48400894.0000; val_optim_loss: 48400894.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9277; val_auprc_score: 0.8984; val_best_acc_score: 0.8694; val_best_f1_score: 0.8777; train_kl_reg_loss: 89914.4889; train_edge_recon_loss: 2726100.6553; train_gene_expr_recon_loss: 10251456.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29655.6186; train_chrom_access_recon_loss: 35881455.8182; train_global_loss: 48978582.4848; train_optim_loss: 48978582.4848; val_kl_reg_loss: 89530.2627; val_edge_recon_loss: 2790384.6562; val_gene_expr_recon_loss: 10188039.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29586.4473; val_chrom_access_recon_loss: 35443255.0000; val_global_loss: 48540795.0000; val_optim_loss: 48540795.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9339; val_auprc_score: 0.9132; val_best_acc_score: 0.8751; val_best_f1_score: 0.8825; train_kl_reg_loss: 89441.6784; train_edge_recon_loss: 2725457.4924; train_gene_expr_recon_loss: 10238918.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29533.7100; train_chrom_access_recon_loss: 35815016.1818; train_global_loss: 48898367.5152; train_optim_loss: 48898367.5152; val_kl_reg_loss: 89807.2324; val_edge_recon_loss: 2758491.9062; val_gene_expr_recon_loss: 10217427.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29479.4160; val_chrom_access_recon_loss: 35767069.0000; val_global_loss: 48862274.5000; val_optim_loss: 48862274.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9306; val_auprc_score: 0.9025; val_best_acc_score: 0.8702; val_best_f1_score: 0.8780; train_kl_reg_loss: 89530.3168; train_edge_recon_loss: 2720313.6477; train_gene_expr_recon_loss: 10234527.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29417.1769; train_chrom_access_recon_loss: 35831892.0000; train_global_loss: 48905680.7273; train_optim_loss: 48905680.7273; val_kl_reg_loss: 89978.6289; val_edge_recon_loss: 2772933.0625; val_gene_expr_recon_loss: 10309892.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29359.0020; val_chrom_access_recon_loss: 35911320.0000; val_global_loss: 49113483.5000; val_optim_loss: 49113483.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9376; val_auprc_score: 0.9116; val_best_acc_score: 0.8753; val_best_f1_score: 0.8842; train_kl_reg_loss: 89687.8469; train_edge_recon_loss: 2730768.9848; train_gene_expr_recon_loss: 10240981.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29303.4176; train_chrom_access_recon_loss: 35849111.5758; train_global_loss: 48939853.6970; train_optim_loss: 48939853.6970; val_kl_reg_loss: 89171.8877; val_edge_recon_loss: 2741943.6562; val_gene_expr_recon_loss: 10304425.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29268.9219; val_chrom_access_recon_loss: 35825987.5000; val_global_loss: 48990798.0000; val_optim_loss: 48990798.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9295; val_auprc_score: 0.9016; val_best_acc_score: 0.8769; val_best_f1_score: 0.8850; train_kl_reg_loss: 89098.5101; train_edge_recon_loss: 2726747.8144; train_gene_expr_recon_loss: 10236470.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28904.5499; train_chrom_access_recon_loss: 35812720.3636; train_global_loss: 48893941.8788; train_optim_loss: 48893941.8788; val_kl_reg_loss: 88993.7402; val_edge_recon_loss: 2754673.4062; val_gene_expr_recon_loss: 10267092.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28764.5176; val_chrom_access_recon_loss: 35511499.0000; val_global_loss: 48651024.0000; val_optim_loss: 48651024.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9364; val_auprc_score: 0.9145; val_best_acc_score: 0.8759; val_best_f1_score: 0.8841; train_kl_reg_loss: 89221.5742; train_edge_recon_loss: 2725737.3144; train_gene_expr_recon_loss: 10232307.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28733.5708; train_chrom_access_recon_loss: 35818435.2121; train_global_loss: 48894435.6970; train_optim_loss: 48894435.6970; val_kl_reg_loss: 88707.4844; val_edge_recon_loss: 2753515.6250; val_gene_expr_recon_loss: 10212230.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28713.2266; val_chrom_access_recon_loss: 35431078.0000; val_global_loss: 48514244.0000; val_optim_loss: 48514244.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9355; val_auprc_score: 0.9072; val_best_acc_score: 0.8764; val_best_f1_score: 0.8835; train_kl_reg_loss: 89159.1832; train_edge_recon_loss: 2719337.0341; train_gene_expr_recon_loss: 10237598.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28699.6500; train_chrom_access_recon_loss: 35791973.6970; train_global_loss: 48866768.4242; train_optim_loss: 48866768.4242; val_kl_reg_loss: 89357.0918; val_edge_recon_loss: 2770363.8438; val_gene_expr_recon_loss: 10270730.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28687.9609; val_chrom_access_recon_loss: 36053832.5000; val_global_loss: 49212971.5000; val_optim_loss: 49212971.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9327; val_auprc_score: 0.9092; val_best_acc_score: 0.8745; val_best_f1_score: 0.8846; train_kl_reg_loss: 89284.5606; train_edge_recon_loss: 2714271.6364; train_gene_expr_recon_loss: 10227361.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28677.8962; train_chrom_access_recon_loss: 35796544.0909; train_global_loss: 48856139.6970; train_optim_loss: 48856139.6970; val_kl_reg_loss: 89142.2705; val_edge_recon_loss: 2727487.2500; val_gene_expr_recon_loss: 10221416.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28669.2715; val_chrom_access_recon_loss: 35630056.5000; val_global_loss: 48696771.5000; val_optim_loss: 48696771.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 29 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9298
val AUPRC score: 0.9044
val best accuracy score: 0.8689
val best F1 score: 0.8797
val target rna MSE score: 1.3146
val source rna MSE score: 0.4300
val target atac MSE score: 0.1173
val source atac MSE score: 0.0262
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
