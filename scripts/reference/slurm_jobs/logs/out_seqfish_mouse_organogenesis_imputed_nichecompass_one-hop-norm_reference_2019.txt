[True]
Run timestamp: 21072023_193645_2019.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '2000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10.0', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_2019']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 2034 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 2034, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1471, n_latent: 1471, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1471, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 4068
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8879; val_auprc_score: 0.9773; val_best_acc_score: 0.8645; val_best_f1_score: 0.9263; train_kl_reg_loss: 108461.4817; train_edge_recon_loss: 117680.7603; train_gene_expr_recon_loss: 2538223.5132; train_masked_gp_l1_reg_loss: 9209.5861; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2773575.3450; train_optim_loss: 2773575.3450; val_kl_reg_loss: 99404.5335; val_edge_recon_loss: 121967.9733; val_gene_expr_recon_loss: 2527948.9583; val_masked_gp_l1_reg_loss: 8178.6572; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2757500.2083; val_optim_loss: 2757500.2083
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8828; val_auprc_score: 0.9754; val_best_acc_score: 0.8637; val_best_f1_score: 0.9258; train_kl_reg_loss: 122301.3124; train_edge_recon_loss: 119170.1413; train_gene_expr_recon_loss: 3215076.3786; train_masked_gp_l1_reg_loss: 8475.4114; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3465023.2584; train_optim_loss: 3465023.2584; val_kl_reg_loss: 102031.9365; val_edge_recon_loss: 120783.7526; val_gene_expr_recon_loss: 2791209.9688; val_masked_gp_l1_reg_loss: 9089.8184; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3023115.4375; val_optim_loss: 3023115.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8761; val_auprc_score: 0.9745; val_best_acc_score: 0.8650; val_best_f1_score: 0.9267; train_kl_reg_loss: 223148.7154; train_edge_recon_loss: 118741.0425; train_gene_expr_recon_loss: 2828931.6310; train_masked_gp_l1_reg_loss: 9160.3108; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3179981.6983; train_optim_loss: 3179981.6983; val_kl_reg_loss: 195264.1035; val_edge_recon_loss: 117536.3366; val_gene_expr_recon_loss: 2743017.2188; val_masked_gp_l1_reg_loss: 9179.6484; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3064997.4062; val_optim_loss: 3064997.4062
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8829; val_auprc_score: 0.9757; val_best_acc_score: 0.8670; val_best_f1_score: 0.9277; train_kl_reg_loss: 189108.6585; train_edge_recon_loss: 119451.2662; train_gene_expr_recon_loss: 3581571.4543; train_masked_gp_l1_reg_loss: 9906.7164; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3900038.0733; train_optim_loss: 3900038.0733; val_kl_reg_loss: 121688.3060; val_edge_recon_loss: 117282.1042; val_gene_expr_recon_loss: 2869509.0521; val_masked_gp_l1_reg_loss: 9765.4727; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3118244.9479; val_optim_loss: 3118244.9479
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8990; val_auprc_score: 0.9788; val_best_acc_score: 0.8608; val_best_f1_score: 0.9245; train_kl_reg_loss: 138026.7313; train_edge_recon_loss: 119080.2326; train_gene_expr_recon_loss: 4615321.0048; train_masked_gp_l1_reg_loss: 11153.8322; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4883581.8498; train_optim_loss: 4883581.8498; val_kl_reg_loss: 83205.0016; val_edge_recon_loss: 121737.5446; val_gene_expr_recon_loss: 2780848.0312; val_masked_gp_l1_reg_loss: 11246.9775; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2997037.5625; val_optim_loss: 2997037.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8881; val_auprc_score: 0.9763; val_best_acc_score: 0.8736; val_best_f1_score: 0.9308; train_kl_reg_loss: 66289.4208; train_edge_recon_loss: 118612.7577; train_gene_expr_recon_loss: 2743831.8401; train_masked_gp_l1_reg_loss: 11147.4106; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2939881.4207; train_optim_loss: 2939881.4207; val_kl_reg_loss: 51406.3232; val_edge_recon_loss: 118860.0443; val_gene_expr_recon_loss: 2683976.4479; val_masked_gp_l1_reg_loss: 11057.4893; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2865300.3333; val_optim_loss: 2865300.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8815; val_auprc_score: 0.9751; val_best_acc_score: 0.8877; val_best_f1_score: 0.9376; train_kl_reg_loss: 39943.5087; train_edge_recon_loss: 117659.8134; train_gene_expr_recon_loss: 1343360.6304; train_masked_gp_l1_reg_loss: 11252.7299; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1512216.6932; train_optim_loss: 1512216.6932; val_kl_reg_loss: 35353.2507; val_edge_recon_loss: 119510.5716; val_gene_expr_recon_loss: 865581.9922; val_masked_gp_l1_reg_loss: 11183.1045; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1031628.9323; val_optim_loss: 1031628.9323
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8804; val_auprc_score: 0.9748; val_best_acc_score: 0.8930; val_best_f1_score: 0.9401; train_kl_reg_loss: 34171.2810; train_edge_recon_loss: 116863.1590; train_gene_expr_recon_loss: 857121.0589; train_masked_gp_l1_reg_loss: 11052.4552; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1019207.9576; train_optim_loss: 1019207.9576; val_kl_reg_loss: 32116.7702; val_edge_recon_loss: 117411.7715; val_gene_expr_recon_loss: 852459.7396; val_masked_gp_l1_reg_loss: 10949.8721; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1012938.1589; val_optim_loss: 1012938.1589
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8754; val_auprc_score: 0.9735; val_best_acc_score: 0.8911; val_best_f1_score: 0.9379; train_kl_reg_loss: 31346.7383; train_edge_recon_loss: 116001.6783; train_gene_expr_recon_loss: 845142.4354; train_masked_gp_l1_reg_loss: 10873.6230; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1003364.4751; train_optim_loss: 1003364.4751; val_kl_reg_loss: 29350.6073; val_edge_recon_loss: 118208.1423; val_gene_expr_recon_loss: 839128.9974; val_masked_gp_l1_reg_loss: 10808.1074; val_group_lasso_reg_loss: 0.0000; val_global_loss: 997495.8698; val_optim_loss: 997495.8698
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8734; val_auprc_score: 0.9725; val_best_acc_score: 0.8841; val_best_f1_score: 0.9352; train_kl_reg_loss: 29458.9700; train_edge_recon_loss: 115036.2714; train_gene_expr_recon_loss: 834132.5325; train_masked_gp_l1_reg_loss: 10750.2530; train_group_lasso_reg_loss: 0.0000; train_global_loss: 989378.0273; train_optim_loss: 989378.0273; val_kl_reg_loss: 29759.1830; val_edge_recon_loss: 117326.1250; val_gene_expr_recon_loss: 830170.4323; val_masked_gp_l1_reg_loss: 10694.5059; val_group_lasso_reg_loss: 0.0000; val_global_loss: 987950.2448; val_optim_loss: 987950.2448
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8739; val_auprc_score: 0.9719; val_best_acc_score: 0.8952; val_best_f1_score: 0.9414; train_kl_reg_loss: 27893.3346; train_edge_recon_loss: 113806.6546; train_gene_expr_recon_loss: 824549.1517; train_masked_gp_l1_reg_loss: 10656.0511; train_group_lasso_reg_loss: 0.0000; train_global_loss: 976905.1893; train_optim_loss: 976905.1893; val_kl_reg_loss: 26363.6124; val_edge_recon_loss: 117159.0365; val_gene_expr_recon_loss: 822016.9089; val_masked_gp_l1_reg_loss: 10622.2656; val_group_lasso_reg_loss: 0.0000; val_global_loss: 976161.8021; val_optim_loss: 976161.8021
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8787; val_auprc_score: 0.9722; val_best_acc_score: 0.9031; val_best_f1_score: 0.9450; train_kl_reg_loss: 26202.5062; train_edge_recon_loss: 111826.6472; train_gene_expr_recon_loss: 816282.2803; train_masked_gp_l1_reg_loss: 10592.2628; train_group_lasso_reg_loss: 0.0000; train_global_loss: 964903.6968; train_optim_loss: 964903.6968; val_kl_reg_loss: 26246.0870; val_edge_recon_loss: 116072.4131; val_gene_expr_recon_loss: 813505.7682; val_masked_gp_l1_reg_loss: 10567.3164; val_group_lasso_reg_loss: 0.0000; val_global_loss: 966391.5781; val_optim_loss: 966391.5781
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8759; val_auprc_score: 0.9710; val_best_acc_score: 0.9059; val_best_f1_score: 0.9470; train_kl_reg_loss: 24792.9727; train_edge_recon_loss: 110335.0458; train_gene_expr_recon_loss: 807750.9973; train_masked_gp_l1_reg_loss: 10554.7977; train_group_lasso_reg_loss: 0.0000; train_global_loss: 953433.8143; train_optim_loss: 953433.8143; val_kl_reg_loss: 24272.7985; val_edge_recon_loss: 115593.3685; val_gene_expr_recon_loss: 791287.9453; val_masked_gp_l1_reg_loss: 10578.9941; val_group_lasso_reg_loss: 0.0000; val_global_loss: 941733.1172; val_optim_loss: 941733.1172
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8798; val_auprc_score: 0.9719; val_best_acc_score: 0.9101; val_best_f1_score: 0.9493; train_kl_reg_loss: 23637.4629; train_edge_recon_loss: 108908.3261; train_gene_expr_recon_loss: 787599.6298; train_masked_gp_l1_reg_loss: 10557.1463; train_group_lasso_reg_loss: 0.0000; train_global_loss: 930702.5655; train_optim_loss: 930702.5655; val_kl_reg_loss: 22969.4723; val_edge_recon_loss: 110742.7669; val_gene_expr_recon_loss: 783507.4844; val_masked_gp_l1_reg_loss: 10549.6914; val_group_lasso_reg_loss: 0.0000; val_global_loss: 927769.4115; val_optim_loss: 927769.4115
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8859; val_auprc_score: 0.9736; val_best_acc_score: 0.9117; val_best_f1_score: 0.9498; train_kl_reg_loss: 22083.0317; train_edge_recon_loss: 107458.7304; train_gene_expr_recon_loss: 779844.1451; train_masked_gp_l1_reg_loss: 10536.2592; train_group_lasso_reg_loss: 0.0000; train_global_loss: 919922.1668; train_optim_loss: 919922.1668; val_kl_reg_loss: 21193.7028; val_edge_recon_loss: 107890.0921; val_gene_expr_recon_loss: 775644.3672; val_masked_gp_l1_reg_loss: 10537.1699; val_group_lasso_reg_loss: 0.0000; val_global_loss: 915265.3516; val_optim_loss: 915265.3516
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8862; val_auprc_score: 0.9733; val_best_acc_score: 0.9117; val_best_f1_score: 0.9499; train_kl_reg_loss: 21023.8871; train_edge_recon_loss: 105568.8480; train_gene_expr_recon_loss: 772987.6499; train_masked_gp_l1_reg_loss: 10530.6325; train_group_lasso_reg_loss: 0.0000; train_global_loss: 910111.0168; train_optim_loss: 910111.0168; val_kl_reg_loss: 19821.8251; val_edge_recon_loss: 109355.8304; val_gene_expr_recon_loss: 768570.2448; val_masked_gp_l1_reg_loss: 10530.5352; val_group_lasso_reg_loss: 0.0000; val_global_loss: 908278.4635; val_optim_loss: 908278.4635
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8925; val_auprc_score: 0.9742; val_best_acc_score: 0.9145; val_best_f1_score: 0.9513; train_kl_reg_loss: 19530.7651; train_edge_recon_loss: 102847.3874; train_gene_expr_recon_loss: 765465.7203; train_masked_gp_l1_reg_loss: 10521.8959; train_group_lasso_reg_loss: 0.0000; train_global_loss: 898365.7671; train_optim_loss: 898365.7671; val_kl_reg_loss: 18704.0535; val_edge_recon_loss: 106147.3503; val_gene_expr_recon_loss: 762007.0156; val_masked_gp_l1_reg_loss: 10515.6826; val_group_lasso_reg_loss: 0.0000; val_global_loss: 897374.1068; val_optim_loss: 897374.1068
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8880; val_auprc_score: 0.9728; val_best_acc_score: 0.9129; val_best_f1_score: 0.9506; train_kl_reg_loss: 18210.6161; train_edge_recon_loss: 101969.4532; train_gene_expr_recon_loss: 759201.5580; train_masked_gp_l1_reg_loss: 10498.7143; train_group_lasso_reg_loss: 0.0000; train_global_loss: 889880.3380; train_optim_loss: 889880.3380; val_kl_reg_loss: 17357.5627; val_edge_recon_loss: 102457.6009; val_gene_expr_recon_loss: 757028.0469; val_masked_gp_l1_reg_loss: 10483.7500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 887326.9609; val_optim_loss: 887326.9609
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8880; val_auprc_score: 0.9733; val_best_acc_score: 0.9107; val_best_f1_score: 0.9492; train_kl_reg_loss: 16999.0962; train_edge_recon_loss: 99163.3813; train_gene_expr_recon_loss: 753194.9474; train_masked_gp_l1_reg_loss: 10458.7068; train_group_lasso_reg_loss: 0.0000; train_global_loss: 879816.1322; train_optim_loss: 879816.1322; val_kl_reg_loss: 16257.5642; val_edge_recon_loss: 102707.6478; val_gene_expr_recon_loss: 751199.4609; val_masked_gp_l1_reg_loss: 10435.8018; val_group_lasso_reg_loss: 0.0000; val_global_loss: 880600.4896; val_optim_loss: 880600.4896
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8914; val_auprc_score: 0.9745; val_best_acc_score: 0.9140; val_best_f1_score: 0.9511; train_kl_reg_loss: 15681.2609; train_edge_recon_loss: 97968.2837; train_gene_expr_recon_loss: 746961.6394; train_masked_gp_l1_reg_loss: 10402.8103; train_group_lasso_reg_loss: 0.0000; train_global_loss: 871013.9946; train_optim_loss: 871013.9946; val_kl_reg_loss: 14969.1942; val_edge_recon_loss: 97438.4766; val_gene_expr_recon_loss: 743171.2891; val_masked_gp_l1_reg_loss: 10359.4824; val_group_lasso_reg_loss: 0.0000; val_global_loss: 865938.4609; val_optim_loss: 865938.4609
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8889; val_auprc_score: 0.9738; val_best_acc_score: 0.9101; val_best_f1_score: 0.9490; train_kl_reg_loss: 14515.0965; train_edge_recon_loss: 96669.6262; train_gene_expr_recon_loss: 741173.4871; train_masked_gp_l1_reg_loss: 10304.8978; train_group_lasso_reg_loss: 0.0000; train_global_loss: 862663.1076; train_optim_loss: 862663.1076; val_kl_reg_loss: 13730.4717; val_edge_recon_loss: 95289.5415; val_gene_expr_recon_loss: 738366.9297; val_masked_gp_l1_reg_loss: 10247.2900; val_group_lasso_reg_loss: 0.0000; val_global_loss: 857634.2604; val_optim_loss: 857634.2604
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8904; val_auprc_score: 0.9742; val_best_acc_score: 0.9124; val_best_f1_score: 0.9503; train_kl_reg_loss: 13316.4098; train_edge_recon_loss: 94044.5553; train_gene_expr_recon_loss: 735514.5255; train_masked_gp_l1_reg_loss: 10175.0251; train_group_lasso_reg_loss: 0.0000; train_global_loss: 853050.5162; train_optim_loss: 853050.5162; val_kl_reg_loss: 12735.2668; val_edge_recon_loss: 95678.2376; val_gene_expr_recon_loss: 731962.9375; val_masked_gp_l1_reg_loss: 10089.2441; val_group_lasso_reg_loss: 0.0000; val_global_loss: 850465.6953; val_optim_loss: 850465.6953
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8992; val_auprc_score: 0.9768; val_best_acc_score: 0.9141; val_best_f1_score: 0.9514; train_kl_reg_loss: 12157.1775; train_edge_recon_loss: 92669.3975; train_gene_expr_recon_loss: 729626.3513; train_masked_gp_l1_reg_loss: 10004.9761; train_group_lasso_reg_loss: 0.0000; train_global_loss: 844457.9026; train_optim_loss: 844457.9026; val_kl_reg_loss: 11574.0826; val_edge_recon_loss: 91958.7425; val_gene_expr_recon_loss: 726097.4635; val_masked_gp_l1_reg_loss: 9908.6084; val_group_lasso_reg_loss: 0.0000; val_global_loss: 839538.9115; val_optim_loss: 839538.9115
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8973; val_auprc_score: 0.9763; val_best_acc_score: 0.9137; val_best_f1_score: 0.9510; train_kl_reg_loss: 11055.7689; train_edge_recon_loss: 90962.2468; train_gene_expr_recon_loss: 724245.4733; train_masked_gp_l1_reg_loss: 9805.3491; train_group_lasso_reg_loss: 0.0000; train_global_loss: 836068.8368; train_optim_loss: 836068.8368; val_kl_reg_loss: 10610.8914; val_edge_recon_loss: 91073.9974; val_gene_expr_recon_loss: 721140.5911; val_masked_gp_l1_reg_loss: 9696.5684; val_group_lasso_reg_loss: 0.0000; val_global_loss: 832522.0469; val_optim_loss: 832522.0469
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9127; val_auprc_score: 0.9801; val_best_acc_score: 0.9196; val_best_f1_score: 0.9543; train_kl_reg_loss: 10207.3002; train_edge_recon_loss: 89351.4360; train_gene_expr_recon_loss: 718938.9011; train_masked_gp_l1_reg_loss: 9580.8087; train_group_lasso_reg_loss: 0.0000; train_global_loss: 828078.4462; train_optim_loss: 828078.4462; val_kl_reg_loss: 9803.8865; val_edge_recon_loss: 87478.0781; val_gene_expr_recon_loss: 716621.1354; val_masked_gp_l1_reg_loss: 9464.2910; val_group_lasso_reg_loss: 0.0000; val_global_loss: 823367.4193; val_optim_loss: 823367.4193
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8791; val_auprc_score: 0.9743; val_best_acc_score: 0.8815; val_best_f1_score: 0.9340; train_kl_reg_loss: 23775.3769; train_edge_recon_loss: 117385.1048; train_gene_expr_recon_loss: 1082309.4312; train_masked_gp_l1_reg_loss: 9444.3992; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1232914.3071; train_optim_loss: 1232914.3071; val_kl_reg_loss: 14621.0997; val_edge_recon_loss: 118666.4469; val_gene_expr_recon_loss: 761933.4740; val_masked_gp_l1_reg_loss: 9066.1035; val_group_lasso_reg_loss: 0.0000; val_global_loss: 904287.1484; val_optim_loss: 904287.1484
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8762; val_auprc_score: 0.9737; val_best_acc_score: 0.8823; val_best_f1_score: 0.9349; train_kl_reg_loss: 14226.5336; train_edge_recon_loss: 118664.3602; train_gene_expr_recon_loss: 765641.0956; train_masked_gp_l1_reg_loss: 8748.8377; train_group_lasso_reg_loss: 0.0000; train_global_loss: 907280.8269; train_optim_loss: 907280.8269; val_kl_reg_loss: 12296.5233; val_edge_recon_loss: 119567.4036; val_gene_expr_recon_loss: 747234.0156; val_masked_gp_l1_reg_loss: 8446.3828; val_group_lasso_reg_loss: 0.0000; val_global_loss: 887544.3177; val_optim_loss: 887544.3177
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8824; val_auprc_score: 0.9747; val_best_acc_score: 0.8924; val_best_f1_score: 0.9401; train_kl_reg_loss: 11595.2984; train_edge_recon_loss: 117380.6459; train_gene_expr_recon_loss: 742714.5898; train_masked_gp_l1_reg_loss: 8219.0654; train_group_lasso_reg_loss: 0.0000; train_global_loss: 879909.6010; train_optim_loss: 879909.6010; val_kl_reg_loss: 10201.2124; val_edge_recon_loss: 116780.6283; val_gene_expr_recon_loss: 737432.6380; val_masked_gp_l1_reg_loss: 8006.3955; val_group_lasso_reg_loss: 0.0000; val_global_loss: 872420.8516; val_optim_loss: 872420.8516
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8877; val_auprc_score: 0.9753; val_best_acc_score: 0.9003; val_best_f1_score: 0.9434; train_kl_reg_loss: 9977.5624; train_edge_recon_loss: 115906.4748; train_gene_expr_recon_loss: 735354.5204; train_masked_gp_l1_reg_loss: 7842.0277; train_group_lasso_reg_loss: 0.0000; train_global_loss: 869080.5859; train_optim_loss: 869080.5859; val_kl_reg_loss: 9049.4991; val_edge_recon_loss: 115373.8210; val_gene_expr_recon_loss: 731856.7135; val_masked_gp_l1_reg_loss: 7684.6641; val_group_lasso_reg_loss: 0.0000; val_global_loss: 863964.7188; val_optim_loss: 863964.7188

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8884; val_auprc_score: 0.9756; val_best_acc_score: 0.9012; val_best_f1_score: 0.9437; train_kl_reg_loss: 9260.4870; train_edge_recon_loss: 115258.3698; train_gene_expr_recon_loss: 731016.6208; train_masked_gp_l1_reg_loss: 7643.8432; train_group_lasso_reg_loss: 0.0000; train_global_loss: 863179.3206; train_optim_loss: 863179.3206; val_kl_reg_loss: 8812.0363; val_edge_recon_loss: 113558.9746; val_gene_expr_recon_loss: 731315.0312; val_masked_gp_l1_reg_loss: 7625.8521; val_group_lasso_reg_loss: 0.0000; val_global_loss: 861311.9219; val_optim_loss: 861311.9219
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8889; val_auprc_score: 0.9760; val_best_acc_score: 0.9016; val_best_f1_score: 0.9438; train_kl_reg_loss: 9111.8275; train_edge_recon_loss: 114934.9930; train_gene_expr_recon_loss: 730178.6178; train_masked_gp_l1_reg_loss: 7609.0802; train_group_lasso_reg_loss: 0.0000; train_global_loss: 861834.5186; train_optim_loss: 861834.5186; val_kl_reg_loss: 8795.2325; val_edge_recon_loss: 115175.2956; val_gene_expr_recon_loss: 731624.1198; val_masked_gp_l1_reg_loss: 7591.7969; val_group_lasso_reg_loss: 0.0000; val_global_loss: 863186.4557; val_optim_loss: 863186.4557
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8884; val_auprc_score: 0.9753; val_best_acc_score: 0.9004; val_best_f1_score: 0.9434; train_kl_reg_loss: 8992.3116; train_edge_recon_loss: 114044.6182; train_gene_expr_recon_loss: 729291.1562; train_masked_gp_l1_reg_loss: 7573.3699; train_group_lasso_reg_loss: 0.0000; train_global_loss: 859901.4561; train_optim_loss: 859901.4561; val_kl_reg_loss: 8576.3853; val_edge_recon_loss: 113551.1045; val_gene_expr_recon_loss: 729151.1536; val_masked_gp_l1_reg_loss: 7552.5728; val_group_lasso_reg_loss: 0.0000; val_global_loss: 858831.2083; val_optim_loss: 858831.2083
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8850; val_auprc_score: 0.9742; val_best_acc_score: 0.8975; val_best_f1_score: 0.9423; train_kl_reg_loss: 8848.5172; train_edge_recon_loss: 113737.3418; train_gene_expr_recon_loss: 728822.5442; train_masked_gp_l1_reg_loss: 7531.9671; train_group_lasso_reg_loss: 0.0000; train_global_loss: 858940.3726; train_optim_loss: 858940.3726; val_kl_reg_loss: 8417.7564; val_edge_recon_loss: 117106.1133; val_gene_expr_recon_loss: 727322.3281; val_masked_gp_l1_reg_loss: 7511.6113; val_group_lasso_reg_loss: 0.0000; val_global_loss: 860357.8229; val_optim_loss: 860357.8229

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 96 min 5 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9212
Val AUPRC score: 0.9811
Val best accuracy score: 0.9303
Val best F1 score: 0.9599
Val gene expr MSE score: 11158.4516
Val cat covariate0 mean sim diff: -0.0068

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
