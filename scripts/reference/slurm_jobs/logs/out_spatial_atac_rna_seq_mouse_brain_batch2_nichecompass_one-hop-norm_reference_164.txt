[True]
Run timestamp: 10102023_060203_164.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_164']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6699; val_auprc_score: 0.6453; val_best_acc_score: 0.5336; val_best_f1_score: 0.6801; train_kl_reg_loss: 52996.5197; train_edge_recon_loss: 740422.4403; train_gene_expr_recon_loss: 23013625.5152; train_masked_gp_l1_reg_loss: 104388.9183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3264172.2689; train_chrom_access_recon_loss: 990230.5909; train_global_loss: 28165836.3636; train_optim_loss: 28165836.3636; val_kl_reg_loss: 84696.7871; val_edge_recon_loss: 812715.2422; val_gene_expr_recon_loss: 21678679.2500; val_masked_gp_l1_reg_loss: 79298.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2170105.2500; val_chrom_access_recon_loss: 958479.9844; val_global_loss: 25783975.0000; val_optim_loss: 25783975.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7405; val_auprc_score: 0.7325; val_best_acc_score: 0.6464; val_best_f1_score: 0.7192; train_kl_reg_loss: 84313.9182; train_edge_recon_loss: 744367.1392; train_gene_expr_recon_loss: 21268523.3030; train_masked_gp_l1_reg_loss: 74424.6368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1396711.3011; train_chrom_access_recon_loss: 943736.9517; train_global_loss: 24512077.0303; train_optim_loss: 24512077.0303; val_kl_reg_loss: 79992.1807; val_edge_recon_loss: 810936.5625; val_gene_expr_recon_loss: 21253010.7500; val_masked_gp_l1_reg_loss: 72902.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 824303.1875; val_chrom_access_recon_loss: 951282.9688; val_global_loss: 23992428.5000; val_optim_loss: 23992428.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8315; val_auprc_score: 0.8122; val_best_acc_score: 0.7367; val_best_f1_score: 0.7454; train_kl_reg_loss: 76648.2433; train_edge_recon_loss: 734961.4403; train_gene_expr_recon_loss: 21037905.2121; train_masked_gp_l1_reg_loss: 73674.6468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 571587.9086; train_chrom_access_recon_loss: 936423.7348; train_global_loss: 23431201.0909; train_optim_loss: 23431201.0909; val_kl_reg_loss: 77480.9043; val_edge_recon_loss: 794635.2969; val_gene_expr_recon_loss: 21012245.5000; val_masked_gp_l1_reg_loss: 75034.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 394508.2500; val_chrom_access_recon_loss: 929779.2266; val_global_loss: 23283682.7500; val_optim_loss: 23283682.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8756; val_auprc_score: 0.8409; val_best_acc_score: 0.8068; val_best_f1_score: 0.8215; train_kl_reg_loss: 69512.3512; train_edge_recon_loss: 719253.9062; train_gene_expr_recon_loss: 20864061.3333; train_masked_gp_l1_reg_loss: 76462.9839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 311399.7318; train_chrom_access_recon_loss: 931068.1723; train_global_loss: 22971758.3939; train_optim_loss: 22971758.3939; val_kl_reg_loss: 68339.7100; val_edge_recon_loss: 741778.1016; val_gene_expr_recon_loss: 20850928.5000; val_masked_gp_l1_reg_loss: 77997.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 249839.4062; val_chrom_access_recon_loss: 933055.5625; val_global_loss: 22921940.0000; val_optim_loss: 22921940.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8802; val_auprc_score: 0.8494; val_best_acc_score: 0.8114; val_best_f1_score: 0.8211; train_kl_reg_loss: 71824.8285; train_edge_recon_loss: 672866.0388; train_gene_expr_recon_loss: 20732337.4545; train_masked_gp_l1_reg_loss: 78687.4946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 213379.3331; train_chrom_access_recon_loss: 925838.3106; train_global_loss: 22694933.3030; train_optim_loss: 22694933.3030; val_kl_reg_loss: 76976.4395; val_edge_recon_loss: 652647.7266; val_gene_expr_recon_loss: 20874742.5000; val_masked_gp_l1_reg_loss: 79409.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182055.0312; val_chrom_access_recon_loss: 936676.6328; val_global_loss: 22802509.2500; val_optim_loss: 22802509.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8933; val_auprc_score: 0.8695; val_best_acc_score: 0.8197; val_best_f1_score: 0.8307; train_kl_reg_loss: 78847.9624; train_edge_recon_loss: 634431.3968; train_gene_expr_recon_loss: 20584643.3333; train_masked_gp_l1_reg_loss: 80335.0820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160554.0639; train_chrom_access_recon_loss: 920692.3816; train_global_loss: 22459504.3030; train_optim_loss: 22459504.3030; val_kl_reg_loss: 77702.5010; val_edge_recon_loss: 629859.8438; val_gene_expr_recon_loss: 20658990.5000; val_masked_gp_l1_reg_loss: 81879.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142605.4219; val_chrom_access_recon_loss: 929382.3828; val_global_loss: 22520421.5000; val_optim_loss: 22520421.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8953; val_auprc_score: 0.8567; val_best_acc_score: 0.8321; val_best_f1_score: 0.8422; train_kl_reg_loss: 77054.9647; train_edge_recon_loss: 624915.4811; train_gene_expr_recon_loss: 20497006.8788; train_masked_gp_l1_reg_loss: 82803.9403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130133.4387; train_chrom_access_recon_loss: 917759.5559; train_global_loss: 22329674.2121; train_optim_loss: 22329674.2121; val_kl_reg_loss: 75690.8506; val_edge_recon_loss: 619812.4922; val_gene_expr_recon_loss: 20663232.7500; val_masked_gp_l1_reg_loss: 83950.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119649.0703; val_chrom_access_recon_loss: 926397.7891; val_global_loss: 22488733.5000; val_optim_loss: 22488733.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8953; val_auprc_score: 0.8661; val_best_acc_score: 0.8275; val_best_f1_score: 0.8422; train_kl_reg_loss: 75495.4705; train_edge_recon_loss: 615824.9356; train_gene_expr_recon_loss: 20392911.5152; train_masked_gp_l1_reg_loss: 84800.0980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111910.5027; train_chrom_access_recon_loss: 913790.2737; train_global_loss: 22194733.0606; train_optim_loss: 22194733.0606; val_kl_reg_loss: 76738.4590; val_edge_recon_loss: 618373.6172; val_gene_expr_recon_loss: 20357305.7500; val_masked_gp_l1_reg_loss: 85936.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105938.5625; val_chrom_access_recon_loss: 918802.3594; val_global_loss: 22163094.2500; val_optim_loss: 22163094.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9071; val_auprc_score: 0.8852; val_best_acc_score: 0.8353; val_best_f1_score: 0.8448; train_kl_reg_loss: 74509.3214; train_edge_recon_loss: 610869.6619; train_gene_expr_recon_loss: 20316997.0606; train_masked_gp_l1_reg_loss: 86501.7480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100263.2293; train_chrom_access_recon_loss: 911284.3210; train_global_loss: 22100425.2424; train_optim_loss: 22100425.2424; val_kl_reg_loss: 73367.5762; val_edge_recon_loss: 614252.4297; val_gene_expr_recon_loss: 20278983.5000; val_masked_gp_l1_reg_loss: 87485.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96179.1016; val_chrom_access_recon_loss: 921245.3984; val_global_loss: 22071515.2500; val_optim_loss: 22071515.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9122; val_auprc_score: 0.8875; val_best_acc_score: 0.8474; val_best_f1_score: 0.8561; train_kl_reg_loss: 72843.8200; train_edge_recon_loss: 604895.0133; train_gene_expr_recon_loss: 20214958.2121; train_masked_gp_l1_reg_loss: 87944.3197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91532.1955; train_chrom_access_recon_loss: 907145.5275; train_global_loss: 21979319.0909; train_optim_loss: 21979319.0909; val_kl_reg_loss: 74330.5986; val_edge_recon_loss: 608721.6328; val_gene_expr_recon_loss: 20394154.2500; val_masked_gp_l1_reg_loss: 88820.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88593.7891; val_chrom_access_recon_loss: 919637.5000; val_global_loss: 22174258.2500; val_optim_loss: 22174258.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9172; val_auprc_score: 0.8969; val_best_acc_score: 0.8461; val_best_f1_score: 0.8542; train_kl_reg_loss: 71554.6875; train_edge_recon_loss: 603458.8996; train_gene_expr_recon_loss: 20133460.5758; train_masked_gp_l1_reg_loss: 89134.8110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85227.9911; train_chrom_access_recon_loss: 903179.5824; train_global_loss: 21886016.4545; train_optim_loss: 21886016.4545; val_kl_reg_loss: 70520.9961; val_edge_recon_loss: 615004.8906; val_gene_expr_recon_loss: 20138680.5000; val_masked_gp_l1_reg_loss: 89804.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83435.7031; val_chrom_access_recon_loss: 909992.9688; val_global_loss: 21907439.2500; val_optim_loss: 21907439.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9241; val_auprc_score: 0.9064; val_best_acc_score: 0.8573; val_best_f1_score: 0.8648; train_kl_reg_loss: 70473.3007; train_edge_recon_loss: 599253.0047; train_gene_expr_recon_loss: 20070014.2727; train_masked_gp_l1_reg_loss: 90287.5349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80746.1854; train_chrom_access_recon_loss: 901031.6771; train_global_loss: 21811806.2121; train_optim_loss: 21811806.2121; val_kl_reg_loss: 70415.0918; val_edge_recon_loss: 600810.1094; val_gene_expr_recon_loss: 20224756.2500; val_masked_gp_l1_reg_loss: 90898.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78692.6328; val_chrom_access_recon_loss: 903638.8594; val_global_loss: 21969210.5000; val_optim_loss: 21969210.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9272; val_auprc_score: 0.9062; val_best_acc_score: 0.8614; val_best_f1_score: 0.8671; train_kl_reg_loss: 68948.0342; train_edge_recon_loss: 599713.9934; train_gene_expr_recon_loss: 20000813.7576; train_masked_gp_l1_reg_loss: 91231.0496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77087.6514; train_chrom_access_recon_loss: 898559.8248; train_global_loss: 21736354.3939; train_optim_loss: 21736354.3939; val_kl_reg_loss: 67472.7969; val_edge_recon_loss: 599971.3438; val_gene_expr_recon_loss: 19915271.7500; val_masked_gp_l1_reg_loss: 92054.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76279.1094; val_chrom_access_recon_loss: 897802.9531; val_global_loss: 21648853.2500; val_optim_loss: 21648853.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9257; val_auprc_score: 0.9025; val_best_acc_score: 0.8654; val_best_f1_score: 0.8712; train_kl_reg_loss: 68145.3554; train_edge_recon_loss: 596380.6506; train_gene_expr_recon_loss: 19921720.2424; train_masked_gp_l1_reg_loss: 92249.6596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74932.4276; train_chrom_access_recon_loss: 894521.7320; train_global_loss: 21647950.2424; train_optim_loss: 21647950.2424; val_kl_reg_loss: 67558.9268; val_edge_recon_loss: 600979.4141; val_gene_expr_recon_loss: 19918423.5000; val_masked_gp_l1_reg_loss: 92638.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73644.5391; val_chrom_access_recon_loss: 892044.0391; val_global_loss: 21645288.0000; val_optim_loss: 21645288.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9252; val_auprc_score: 0.9035; val_best_acc_score: 0.8571; val_best_f1_score: 0.8645; train_kl_reg_loss: 67972.6963; train_edge_recon_loss: 592223.8930; train_gene_expr_recon_loss: 19866437.6667; train_masked_gp_l1_reg_loss: 93282.5946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73017.4473; train_chrom_access_recon_loss: 892733.2396; train_global_loss: 21585667.5455; train_optim_loss: 21585667.5455; val_kl_reg_loss: 66899.0254; val_edge_recon_loss: 603541.3594; val_gene_expr_recon_loss: 20014111.0000; val_masked_gp_l1_reg_loss: 93731.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71654.6562; val_chrom_access_recon_loss: 893145.0859; val_global_loss: 21743083.0000; val_optim_loss: 21743083.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9284; val_auprc_score: 0.9080; val_best_acc_score: 0.8686; val_best_f1_score: 0.8726; train_kl_reg_loss: 66685.3471; train_edge_recon_loss: 592341.5350; train_gene_expr_recon_loss: 19819448.6970; train_masked_gp_l1_reg_loss: 94255.1780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71063.4502; train_chrom_access_recon_loss: 890339.5436; train_global_loss: 21534133.9091; train_optim_loss: 21534133.9091; val_kl_reg_loss: 66397.2651; val_edge_recon_loss: 602685.5859; val_gene_expr_recon_loss: 19875859.2500; val_masked_gp_l1_reg_loss: 94852.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70606.7344; val_chrom_access_recon_loss: 890889.2500; val_global_loss: 21601289.5000; val_optim_loss: 21601289.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9399; val_auprc_score: 0.9271; val_best_acc_score: 0.8767; val_best_f1_score: 0.8807; train_kl_reg_loss: 66246.9006; train_edge_recon_loss: 588964.7566; train_gene_expr_recon_loss: 19745323.7576; train_masked_gp_l1_reg_loss: 95378.6330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69924.6465; train_chrom_access_recon_loss: 888142.9773; train_global_loss: 21453981.7879; train_optim_loss: 21453981.7879; val_kl_reg_loss: 66893.5361; val_edge_recon_loss: 594526.5156; val_gene_expr_recon_loss: 19852913.0000; val_masked_gp_l1_reg_loss: 95964.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69225.1641; val_chrom_access_recon_loss: 892049.1875; val_global_loss: 21571572.2500; val_optim_loss: 21571572.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9356; val_auprc_score: 0.9137; val_best_acc_score: 0.8726; val_best_f1_score: 0.8773; train_kl_reg_loss: 65309.6748; train_edge_recon_loss: 589108.9148; train_gene_expr_recon_loss: 19696495.8182; train_masked_gp_l1_reg_loss: 96500.5629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68623.5597; train_chrom_access_recon_loss: 886170.9858; train_global_loss: 21402209.4848; train_optim_loss: 21402209.4848; val_kl_reg_loss: 65754.6768; val_edge_recon_loss: 600455.4688; val_gene_expr_recon_loss: 19730970.5000; val_masked_gp_l1_reg_loss: 97179.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67770.1797; val_chrom_access_recon_loss: 881827.4141; val_global_loss: 21443958.0000; val_optim_loss: 21443958.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9359; val_auprc_score: 0.9142; val_best_acc_score: 0.8767; val_best_f1_score: 0.8802; train_kl_reg_loss: 64537.3184; train_edge_recon_loss: 588390.4991; train_gene_expr_recon_loss: 19631443.0303; train_masked_gp_l1_reg_loss: 97690.3448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67698.2205; train_chrom_access_recon_loss: 882609.6525; train_global_loss: 21332368.8788; train_optim_loss: 21332368.8788; val_kl_reg_loss: 64712.2227; val_edge_recon_loss: 598694.8359; val_gene_expr_recon_loss: 19720217.7500; val_masked_gp_l1_reg_loss: 98186.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67344.5234; val_chrom_access_recon_loss: 885478.3203; val_global_loss: 21434633.5000; val_optim_loss: 21434633.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9433; val_auprc_score: 0.9282; val_best_acc_score: 0.8831; val_best_f1_score: 0.8853; train_kl_reg_loss: 63806.4763; train_edge_recon_loss: 585877.6771; train_gene_expr_recon_loss: 19572473.3333; train_masked_gp_l1_reg_loss: 98847.3699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67055.3156; train_chrom_access_recon_loss: 881033.3769; train_global_loss: 21269093.7273; train_optim_loss: 21269093.7273; val_kl_reg_loss: 64169.2266; val_edge_recon_loss: 595338.8359; val_gene_expr_recon_loss: 19559185.0000; val_masked_gp_l1_reg_loss: 99824.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67299.2031; val_chrom_access_recon_loss: 883257.2344; val_global_loss: 21269074.7500; val_optim_loss: 21269074.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9460; val_auprc_score: 0.9302; val_best_acc_score: 0.8877; val_best_f1_score: 0.8911; train_kl_reg_loss: 62983.9775; train_edge_recon_loss: 587612.5199; train_gene_expr_recon_loss: 19529662.8182; train_masked_gp_l1_reg_loss: 100317.4877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66574.4363; train_chrom_access_recon_loss: 879259.4479; train_global_loss: 21226410.5455; train_optim_loss: 21226410.5455; val_kl_reg_loss: 63250.3862; val_edge_recon_loss: 586236.2422; val_gene_expr_recon_loss: 19623661.7500; val_masked_gp_l1_reg_loss: 100891.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66493.3984; val_chrom_access_recon_loss: 892254.4609; val_global_loss: 21332788.2500; val_optim_loss: 21332788.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9411; val_auprc_score: 0.9258; val_best_acc_score: 0.8759; val_best_f1_score: 0.8807; train_kl_reg_loss: 62589.2786; train_edge_recon_loss: 584763.6420; train_gene_expr_recon_loss: 19473423.7273; train_masked_gp_l1_reg_loss: 101614.1813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66094.0082; train_chrom_access_recon_loss: 878035.7017; train_global_loss: 21166520.5152; train_optim_loss: 21166520.5152; val_kl_reg_loss: 62602.5371; val_edge_recon_loss: 591260.7109; val_gene_expr_recon_loss: 19570954.5000; val_masked_gp_l1_reg_loss: 102353.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66085.1641; val_chrom_access_recon_loss: 887153.7656; val_global_loss: 21280411.5000; val_optim_loss: 21280411.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9419; val_auprc_score: 0.9267; val_best_acc_score: 0.8812; val_best_f1_score: 0.8853; train_kl_reg_loss: 62055.8734; train_edge_recon_loss: 584285.5360; train_gene_expr_recon_loss: 19388663.7273; train_masked_gp_l1_reg_loss: 102930.2840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65500.7093; train_chrom_access_recon_loss: 874983.5114; train_global_loss: 21078419.4545; train_optim_loss: 21078419.4545; val_kl_reg_loss: 62181.7710; val_edge_recon_loss: 593294.9844; val_gene_expr_recon_loss: 19421152.2500; val_masked_gp_l1_reg_loss: 103922.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65481.2695; val_chrom_access_recon_loss: 878544.6328; val_global_loss: 21124577.5000; val_optim_loss: 21124577.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9439; val_auprc_score: 0.9248; val_best_acc_score: 0.8842; val_best_f1_score: 0.8867; train_kl_reg_loss: 61309.4250; train_edge_recon_loss: 583091.3636; train_gene_expr_recon_loss: 19343193.3333; train_masked_gp_l1_reg_loss: 104453.8170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65218.4343; train_chrom_access_recon_loss: 873228.8977; train_global_loss: 21030495.4242; train_optim_loss: 21030495.4242; val_kl_reg_loss: 61404.8799; val_edge_recon_loss: 590705.1172; val_gene_expr_recon_loss: 19352899.7500; val_masked_gp_l1_reg_loss: 105302.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65324.2031; val_chrom_access_recon_loss: 874797.3594; val_global_loss: 21050433.2500; val_optim_loss: 21050433.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9435; val_auprc_score: 0.9310; val_best_acc_score: 0.8821; val_best_f1_score: 0.8869; train_kl_reg_loss: 60467.7980; train_edge_recon_loss: 583360.5758; train_gene_expr_recon_loss: 19292497.8485; train_masked_gp_l1_reg_loss: 106175.2050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64801.4420; train_chrom_access_recon_loss: 871386.4242; train_global_loss: 20978689.4242; train_optim_loss: 20978689.4242; val_kl_reg_loss: 61099.5947; val_edge_recon_loss: 592776.4531; val_gene_expr_recon_loss: 19443938.7500; val_masked_gp_l1_reg_loss: 106917.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64724.9180; val_chrom_access_recon_loss: 871255.7891; val_global_loss: 21140713.0000; val_optim_loss: 21140713.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9135; val_auprc_score: 0.8858; val_best_acc_score: 0.8428; val_best_f1_score: 0.8527; train_kl_reg_loss: 48510.4540; train_edge_recon_loss: 682288.0436; train_gene_expr_recon_loss: 18783809.4242; train_masked_gp_l1_reg_loss: 106827.6103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58534.2823; train_chrom_access_recon_loss: 854421.1951; train_global_loss: 20534390.8182; train_optim_loss: 20534390.8182; val_kl_reg_loss: 24493.6294; val_edge_recon_loss: 692287.6016; val_gene_expr_recon_loss: 18780053.2500; val_masked_gp_l1_reg_loss: 106612.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63192.9258; val_chrom_access_recon_loss: 842076.0234; val_global_loss: 20508714.5000; val_optim_loss: 20508714.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8990; val_auprc_score: 0.8689; val_best_acc_score: 0.8294; val_best_f1_score: 0.8454; train_kl_reg_loss: 32134.6810; train_edge_recon_loss: 682062.5559; train_gene_expr_recon_loss: 18677613.4242; train_masked_gp_l1_reg_loss: 105014.7790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64995.9827; train_chrom_access_recon_loss: 837726.2661; train_global_loss: 20399547.7879; train_optim_loss: 20399547.7879; val_kl_reg_loss: 25869.0955; val_edge_recon_loss: 664809.5547; val_gene_expr_recon_loss: 18578687.7500; val_masked_gp_l1_reg_loss: 102860.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63020.1445; val_chrom_access_recon_loss: 845980.5391; val_global_loss: 20281227.2500; val_optim_loss: 20281227.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9007; val_auprc_score: 0.8733; val_best_acc_score: 0.8275; val_best_f1_score: 0.8407; train_kl_reg_loss: 38914.7908; train_edge_recon_loss: 641841.0284; train_gene_expr_recon_loss: 18559230.5152; train_masked_gp_l1_reg_loss: 101018.9950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60900.4547; train_chrom_access_recon_loss: 835347.8267; train_global_loss: 20237253.6364; train_optim_loss: 20237253.6364; val_kl_reg_loss: 31024.5295; val_edge_recon_loss: 632993.6875; val_gene_expr_recon_loss: 18339006.2500; val_masked_gp_l1_reg_loss: 99088.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59365.2773; val_chrom_access_recon_loss: 827662.6953; val_global_loss: 19989141.2500; val_optim_loss: 19989141.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9048; val_auprc_score: 0.8769; val_best_acc_score: 0.8305; val_best_f1_score: 0.8439; train_kl_reg_loss: 43989.9363; train_edge_recon_loss: 617990.5208; train_gene_expr_recon_loss: 18467158.6364; train_masked_gp_l1_reg_loss: 98052.3781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58517.3389; train_chrom_access_recon_loss: 834354.3570; train_global_loss: 20120063.2121; train_optim_loss: 20120063.2121; val_kl_reg_loss: 37318.3208; val_edge_recon_loss: 617694.1328; val_gene_expr_recon_loss: 18515815.5000; val_masked_gp_l1_reg_loss: 97169.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57717.5898; val_chrom_access_recon_loss: 839712.5625; val_global_loss: 20165428.5000; val_optim_loss: 20165428.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9135; val_auprc_score: 0.8828; val_best_acc_score: 0.8442; val_best_f1_score: 0.8527; train_kl_reg_loss: 46092.6461; train_edge_recon_loss: 610449.7756; train_gene_expr_recon_loss: 18361493.6667; train_masked_gp_l1_reg_loss: 96332.1035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57190.8969; train_chrom_access_recon_loss: 831927.5294; train_global_loss: 20003486.5455; train_optim_loss: 20003486.5455; val_kl_reg_loss: 40439.5352; val_edge_recon_loss: 609413.8672; val_gene_expr_recon_loss: 18386861.2500; val_masked_gp_l1_reg_loss: 95793.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56994.1562; val_chrom_access_recon_loss: 842141.4922; val_global_loss: 20031644.5000; val_optim_loss: 20031644.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9171; val_auprc_score: 0.8959; val_best_acc_score: 0.8444; val_best_f1_score: 0.8524; train_kl_reg_loss: 47088.3172; train_edge_recon_loss: 603390.8987; train_gene_expr_recon_loss: 18321640.7576; train_masked_gp_l1_reg_loss: 95086.4754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56287.5788; train_chrom_access_recon_loss: 830891.4650; train_global_loss: 19954385.7576; train_optim_loss: 19954385.7576; val_kl_reg_loss: 42015.0859; val_edge_recon_loss: 600630.3906; val_gene_expr_recon_loss: 18465713.5000; val_masked_gp_l1_reg_loss: 94492.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55805.7227; val_chrom_access_recon_loss: 841302.3984; val_global_loss: 20099959.5000; val_optim_loss: 20099959.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9186; val_auprc_score: 0.8958; val_best_acc_score: 0.8482; val_best_f1_score: 0.8579; train_kl_reg_loss: 47559.6050; train_edge_recon_loss: 598332.1581; train_gene_expr_recon_loss: 18290939.3333; train_masked_gp_l1_reg_loss: 94077.4608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55600.4956; train_chrom_access_recon_loss: 829353.6818; train_global_loss: 19915862.5455; train_optim_loss: 19915862.5455; val_kl_reg_loss: 43577.0239; val_edge_recon_loss: 601397.7969; val_gene_expr_recon_loss: 18305271.7500; val_masked_gp_l1_reg_loss: 93728.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54984.9062; val_chrom_access_recon_loss: 827595.5234; val_global_loss: 19926554.5000; val_optim_loss: 19926554.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9206; val_auprc_score: 0.8958; val_best_acc_score: 0.8563; val_best_f1_score: 0.8654; train_kl_reg_loss: 47692.5996; train_edge_recon_loss: 594372.9811; train_gene_expr_recon_loss: 18258539.9697; train_masked_gp_l1_reg_loss: 93340.6372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55052.1495; train_chrom_access_recon_loss: 828433.5644; train_global_loss: 19877431.7273; train_optim_loss: 19877431.7273; val_kl_reg_loss: 44551.0859; val_edge_recon_loss: 597077.5312; val_gene_expr_recon_loss: 18281710.0000; val_masked_gp_l1_reg_loss: 92914.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54685.8203; val_chrom_access_recon_loss: 826062.7188; val_global_loss: 19897001.0000; val_optim_loss: 19897001.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9213; val_auprc_score: 0.8999; val_best_acc_score: 0.8506; val_best_f1_score: 0.8589; train_kl_reg_loss: 48223.3226; train_edge_recon_loss: 591752.6856; train_gene_expr_recon_loss: 18236958.6364; train_masked_gp_l1_reg_loss: 92696.4308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54476.6341; train_chrom_access_recon_loss: 827713.8371; train_global_loss: 19851821.7273; train_optim_loss: 19851821.7273; val_kl_reg_loss: 45437.7549; val_edge_recon_loss: 597248.0078; val_gene_expr_recon_loss: 18265552.2500; val_masked_gp_l1_reg_loss: 92529.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54419.0000; val_chrom_access_recon_loss: 833302.9844; val_global_loss: 19888490.0000; val_optim_loss: 19888490.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9285; val_auprc_score: 0.9090; val_best_acc_score: 0.8630; val_best_f1_score: 0.8676; train_kl_reg_loss: 48242.3994; train_edge_recon_loss: 586747.6212; train_gene_expr_recon_loss: 18214599.9394; train_masked_gp_l1_reg_loss: 92253.0533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54370.9373; train_chrom_access_recon_loss: 825571.3049; train_global_loss: 19821785.2424; train_optim_loss: 19821785.2424; val_kl_reg_loss: 45171.5352; val_edge_recon_loss: 593039.7891; val_gene_expr_recon_loss: 18187257.7500; val_masked_gp_l1_reg_loss: 92098.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54379.8633; val_chrom_access_recon_loss: 828887.3203; val_global_loss: 19800834.0000; val_optim_loss: 19800834.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9211; val_auprc_score: 0.8972; val_best_acc_score: 0.8571; val_best_f1_score: 0.8662; train_kl_reg_loss: 48222.7121; train_edge_recon_loss: 588190.6269; train_gene_expr_recon_loss: 18172302.9697; train_masked_gp_l1_reg_loss: 92009.8168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54239.3360; train_chrom_access_recon_loss: 823225.3816; train_global_loss: 19778190.8182; train_optim_loss: 19778190.8182; val_kl_reg_loss: 46164.9766; val_edge_recon_loss: 591140.6562; val_gene_expr_recon_loss: 18371599.2500; val_masked_gp_l1_reg_loss: 91965.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54043.0742; val_chrom_access_recon_loss: 836328.7109; val_global_loss: 19991243.7500; val_optim_loss: 19991243.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9268; val_auprc_score: 0.9059; val_best_acc_score: 0.8608; val_best_f1_score: 0.8708; train_kl_reg_loss: 48353.0972; train_edge_recon_loss: 585765.7831; train_gene_expr_recon_loss: 18132446.0303; train_masked_gp_l1_reg_loss: 91780.6430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54069.4954; train_chrom_access_recon_loss: 822548.0530; train_global_loss: 19734963.3333; train_optim_loss: 19734963.3333; val_kl_reg_loss: 46813.7192; val_edge_recon_loss: 590764.0078; val_gene_expr_recon_loss: 18264733.0000; val_masked_gp_l1_reg_loss: 91582.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54090.0039; val_chrom_access_recon_loss: 824914.0469; val_global_loss: 19872896.2500; val_optim_loss: 19872896.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9380; val_auprc_score: 0.9241; val_best_acc_score: 0.8764; val_best_f1_score: 0.8825; train_kl_reg_loss: 48365.1047; train_edge_recon_loss: 583154.9934; train_gene_expr_recon_loss: 18121756.4545; train_masked_gp_l1_reg_loss: 91666.2000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54040.4284; train_chrom_access_recon_loss: 821979.5634; train_global_loss: 19720962.9394; train_optim_loss: 19720962.9394; val_kl_reg_loss: 46564.5151; val_edge_recon_loss: 586308.3438; val_gene_expr_recon_loss: 18205328.5000; val_masked_gp_l1_reg_loss: 91671.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54036.5117; val_chrom_access_recon_loss: 821840.8906; val_global_loss: 19805750.2500; val_optim_loss: 19805750.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9337; val_auprc_score: 0.9143; val_best_acc_score: 0.8729; val_best_f1_score: 0.8812; train_kl_reg_loss: 48338.5282; train_edge_recon_loss: 581434.3286; train_gene_expr_recon_loss: 18097757.8182; train_masked_gp_l1_reg_loss: 91655.5414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53878.6180; train_chrom_access_recon_loss: 821976.5388; train_global_loss: 19695041.3939; train_optim_loss: 19695041.3939; val_kl_reg_loss: 47269.1240; val_edge_recon_loss: 583179.8672; val_gene_expr_recon_loss: 18238535.5000; val_masked_gp_l1_reg_loss: 91701.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53831.0000; val_chrom_access_recon_loss: 827194.1406; val_global_loss: 19841711.7500; val_optim_loss: 19841711.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9311; val_auprc_score: 0.9101; val_best_acc_score: 0.8697; val_best_f1_score: 0.8766; train_kl_reg_loss: 48627.0743; train_edge_recon_loss: 582072.8873; train_gene_expr_recon_loss: 18059045.2424; train_masked_gp_l1_reg_loss: 89936.4400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46643.3126; train_chrom_access_recon_loss: 819108.4006; train_global_loss: 19645433.3333; train_optim_loss: 19645433.3333; val_kl_reg_loss: 47467.3677; val_edge_recon_loss: 586748.9766; val_gene_expr_recon_loss: 18150773.5000; val_masked_gp_l1_reg_loss: 89236.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44797.2930; val_chrom_access_recon_loss: 819811.3516; val_global_loss: 19738835.0000; val_optim_loss: 19738835.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9319; val_auprc_score: 0.9155; val_best_acc_score: 0.8635; val_best_f1_score: 0.8708; train_kl_reg_loss: 48972.1649; train_edge_recon_loss: 578823.8277; train_gene_expr_recon_loss: 18047643.9697; train_masked_gp_l1_reg_loss: 89084.8253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44417.7900; train_chrom_access_recon_loss: 818733.6638; train_global_loss: 19627676.1212; train_optim_loss: 19627676.1212; val_kl_reg_loss: 47963.2563; val_edge_recon_loss: 589284.3281; val_gene_expr_recon_loss: 18360051.5000; val_masked_gp_l1_reg_loss: 88991.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44082.2969; val_chrom_access_recon_loss: 832236.7656; val_global_loss: 19962609.7500; val_optim_loss: 19962609.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9385; val_auprc_score: 0.9238; val_best_acc_score: 0.8721; val_best_f1_score: 0.8794; train_kl_reg_loss: 49043.9512; train_edge_recon_loss: 580190.0928; train_gene_expr_recon_loss: 18042526.8788; train_masked_gp_l1_reg_loss: 88931.1681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43865.8462; train_chrom_access_recon_loss: 819033.0786; train_global_loss: 19623591.0000; train_optim_loss: 19623591.0000; val_kl_reg_loss: 47845.6699; val_edge_recon_loss: 582403.0312; val_gene_expr_recon_loss: 18076656.5000; val_masked_gp_l1_reg_loss: 88888.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43665.0742; val_chrom_access_recon_loss: 815107.1875; val_global_loss: 19654566.5000; val_optim_loss: 19654566.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9363; val_auprc_score: 0.9230; val_best_acc_score: 0.8697; val_best_f1_score: 0.8768; train_kl_reg_loss: 49378.5820; train_edge_recon_loss: 579349.9252; train_gene_expr_recon_loss: 18048287.8788; train_masked_gp_l1_reg_loss: 88865.1796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43554.3752; train_chrom_access_recon_loss: 818558.6553; train_global_loss: 19627994.3030; train_optim_loss: 19627994.3030; val_kl_reg_loss: 47787.8545; val_edge_recon_loss: 584068.1797; val_gene_expr_recon_loss: 18031342.5000; val_masked_gp_l1_reg_loss: 88857.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43404.4102; val_chrom_access_recon_loss: 813800.2031; val_global_loss: 19609260.5000; val_optim_loss: 19609260.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9288; val_auprc_score: 0.9047; val_best_acc_score: 0.8630; val_best_f1_score: 0.8721; train_kl_reg_loss: 49490.0848; train_edge_recon_loss: 580146.3589; train_gene_expr_recon_loss: 18033503.6667; train_masked_gp_l1_reg_loss: 88838.8581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43308.2173; train_chrom_access_recon_loss: 817144.8277; train_global_loss: 19612432.0909; train_optim_loss: 19612432.0909; val_kl_reg_loss: 47935.6323; val_edge_recon_loss: 592950.4375; val_gene_expr_recon_loss: 17998516.5000; val_masked_gp_l1_reg_loss: 88831.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43201.1445; val_chrom_access_recon_loss: 825638.4219; val_global_loss: 19597075.0000; val_optim_loss: 19597075.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9349; val_auprc_score: 0.9157; val_best_acc_score: 0.8686; val_best_f1_score: 0.8772; train_kl_reg_loss: 49714.0214; train_edge_recon_loss: 579446.6875; train_gene_expr_recon_loss: 18037094.7879; train_masked_gp_l1_reg_loss: 88809.1193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43110.2578; train_chrom_access_recon_loss: 818268.9564; train_global_loss: 19616443.7273; train_optim_loss: 19616443.7273; val_kl_reg_loss: 48372.7002; val_edge_recon_loss: 585174.5938; val_gene_expr_recon_loss: 18107169.5000; val_masked_gp_l1_reg_loss: 88798.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43009.0703; val_chrom_access_recon_loss: 823243.8594; val_global_loss: 19695768.7500; val_optim_loss: 19695768.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9319; val_auprc_score: 0.9111; val_best_acc_score: 0.8721; val_best_f1_score: 0.8802; train_kl_reg_loss: 49771.3262; train_edge_recon_loss: 580683.3087; train_gene_expr_recon_loss: 18028113.0303; train_masked_gp_l1_reg_loss: 88782.5676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42920.8520; train_chrom_access_recon_loss: 817402.5985; train_global_loss: 19607673.6970; train_optim_loss: 19607673.6970; val_kl_reg_loss: 48599.8638; val_edge_recon_loss: 583541.5391; val_gene_expr_recon_loss: 18170818.0000; val_masked_gp_l1_reg_loss: 88773.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42790.1055; val_chrom_access_recon_loss: 820460.8438; val_global_loss: 19754983.5000; val_optim_loss: 19754983.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9275; val_auprc_score: 0.9043; val_best_acc_score: 0.8614; val_best_f1_score: 0.8719; train_kl_reg_loss: 49913.8999; train_edge_recon_loss: 580629.8116; train_gene_expr_recon_loss: 18016043.5455; train_masked_gp_l1_reg_loss: 88762.5476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42752.0823; train_chrom_access_recon_loss: 816679.3428; train_global_loss: 19594781.1818; train_optim_loss: 19594781.1818; val_kl_reg_loss: 48377.5571; val_edge_recon_loss: 591360.3750; val_gene_expr_recon_loss: 18114394.0000; val_masked_gp_l1_reg_loss: 88760.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42657.1914; val_chrom_access_recon_loss: 821798.1719; val_global_loss: 19707348.5000; val_optim_loss: 19707348.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9336; val_auprc_score: 0.9081; val_best_acc_score: 0.8713; val_best_f1_score: 0.8800; train_kl_reg_loss: 49953.3978; train_edge_recon_loss: 579073.0133; train_gene_expr_recon_loss: 18012343.3030; train_masked_gp_l1_reg_loss: 88760.1828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42613.1166; train_chrom_access_recon_loss: 817201.1449; train_global_loss: 19589944.2424; train_optim_loss: 19589944.2424; val_kl_reg_loss: 48680.9897; val_edge_recon_loss: 584188.5859; val_gene_expr_recon_loss: 18322572.0000; val_masked_gp_l1_reg_loss: 88766.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42527.3945; val_chrom_access_recon_loss: 839585.5781; val_global_loss: 19926321.2500; val_optim_loss: 19926321.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9382; val_auprc_score: 0.9223; val_best_acc_score: 0.8764; val_best_f1_score: 0.8818; train_kl_reg_loss: 49868.0679; train_edge_recon_loss: 576747.7509; train_gene_expr_recon_loss: 18029435.4848; train_masked_gp_l1_reg_loss: 88576.2698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41770.7956; train_chrom_access_recon_loss: 817119.8703; train_global_loss: 19603518.1818; train_optim_loss: 19603518.1818; val_kl_reg_loss: 48437.9746; val_edge_recon_loss: 582212.1094; val_gene_expr_recon_loss: 18175289.2500; val_masked_gp_l1_reg_loss: 88482.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41603.5117; val_chrom_access_recon_loss: 825202.4844; val_global_loss: 19761227.2500; val_optim_loss: 19761227.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9268; val_auprc_score: 0.9043; val_best_acc_score: 0.8638; val_best_f1_score: 0.8726; train_kl_reg_loss: 50068.7609; train_edge_recon_loss: 578856.7169; train_gene_expr_recon_loss: 18037468.7273; train_masked_gp_l1_reg_loss: 88449.5264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41570.7322; train_chrom_access_recon_loss: 817680.0114; train_global_loss: 19614094.5455; train_optim_loss: 19614094.5455; val_kl_reg_loss: 48811.3022; val_edge_recon_loss: 586035.4453; val_gene_expr_recon_loss: 18110369.0000; val_masked_gp_l1_reg_loss: 88425.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41541.1797; val_chrom_access_recon_loss: 828385.6562; val_global_loss: 19703569.7500; val_optim_loss: 19703569.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9251; val_auprc_score: 0.9003; val_best_acc_score: 0.8606; val_best_f1_score: 0.8711; train_kl_reg_loss: 50079.2644; train_edge_recon_loss: 578288.2898; train_gene_expr_recon_loss: 18025399.5152; train_masked_gp_l1_reg_loss: 88413.8540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41519.9899; train_chrom_access_recon_loss: 817983.1402; train_global_loss: 19601683.9394; train_optim_loss: 19601683.9394; val_kl_reg_loss: 48852.9131; val_edge_recon_loss: 592059.7891; val_gene_expr_recon_loss: 18045706.0000; val_masked_gp_l1_reg_loss: 88400.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41496.7070; val_chrom_access_recon_loss: 818702.1016; val_global_loss: 19635216.7500; val_optim_loss: 19635216.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9355; val_auprc_score: 0.9140; val_best_acc_score: 0.8743; val_best_f1_score: 0.8817; train_kl_reg_loss: 50044.5353; train_edge_recon_loss: 578630.8949; train_gene_expr_recon_loss: 18007271.6364; train_masked_gp_l1_reg_loss: 88392.9366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41482.4047; train_chrom_access_recon_loss: 816527.7263; train_global_loss: 19582350.2424; train_optim_loss: 19582350.2424; val_kl_reg_loss: 48651.5063; val_edge_recon_loss: 579255.1953; val_gene_expr_recon_loss: 18236310.7500; val_masked_gp_l1_reg_loss: 88383.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41462.3320; val_chrom_access_recon_loss: 834755.3750; val_global_loss: 19828819.2500; val_optim_loss: 19828819.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 4 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9336
val AUPRC score: 0.9147
val best accuracy score: 0.8678
val best F1 score: 0.8729
val target rna MSE score: 1.3896
val source rna MSE score: 0.7697
val target atac MSE score: 0.4878
val source atac MSE score: 0.2033
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
