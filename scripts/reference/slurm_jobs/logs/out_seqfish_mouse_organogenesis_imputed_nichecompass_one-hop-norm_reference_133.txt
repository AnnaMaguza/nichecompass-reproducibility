[True]
Run timestamp: 27072023_024853_133.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_133']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8754; val_auprc_score: 0.9757; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 298870.3683; train_edge_recon_loss: 10552019.8814; train_gene_expr_recon_loss: 18780727.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29631617.2744; train_optim_loss: 29631617.2744; val_kl_reg_loss: 448063.8411; val_edge_recon_loss: 11816961.9583; val_gene_expr_recon_loss: 10892330.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23157356.0000; val_optim_loss: 23157356.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8522; val_auprc_score: 0.9700; val_best_acc_score: 0.8628; val_best_f1_score: 0.9250; train_kl_reg_loss: 264788.5922; train_edge_recon_loss: 10557807.0558; train_gene_expr_recon_loss: 10517558.9907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21340154.5581; train_optim_loss: 21340154.5581; val_kl_reg_loss: 233819.3288; val_edge_recon_loss: 11875466.1250; val_gene_expr_recon_loss: 10249746.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22359031.8333; val_optim_loss: 22359031.8333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8613; val_auprc_score: 0.9697; val_best_acc_score: 0.8756; val_best_f1_score: 0.9316; train_kl_reg_loss: 208759.7502; train_edge_recon_loss: 10443887.0791; train_gene_expr_recon_loss: 10014526.9349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20667173.7767; train_optim_loss: 20667173.7767; val_kl_reg_loss: 144429.1562; val_edge_recon_loss: 11764531.5417; val_gene_expr_recon_loss: 9748935.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21657896.4167; val_optim_loss: 21657896.4167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8627; val_auprc_score: 0.9684; val_best_acc_score: 0.8912; val_best_f1_score: 0.9388; train_kl_reg_loss: 160702.3063; train_edge_recon_loss: 10332703.8698; train_gene_expr_recon_loss: 9573878.0372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20067284.2419; train_optim_loss: 20067284.2419; val_kl_reg_loss: 106464.9131; val_edge_recon_loss: 10367905.0833; val_gene_expr_recon_loss: 9485935.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19960305.7500; val_optim_loss: 19960305.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8477; val_auprc_score: 0.9652; val_best_acc_score: 0.8926; val_best_f1_score: 0.9400; train_kl_reg_loss: 135913.3025; train_edge_recon_loss: 9254717.0558; train_gene_expr_recon_loss: 9414877.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18805508.1488; train_optim_loss: 18805508.1488; val_kl_reg_loss: 187163.7604; val_edge_recon_loss: 8981540.5625; val_gene_expr_recon_loss: 9204966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18373670.6667; val_optim_loss: 18373670.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8632; val_auprc_score: 0.9702; val_best_acc_score: 0.9055; val_best_f1_score: 0.9470; train_kl_reg_loss: 202699.0988; train_edge_recon_loss: 8841259.1070; train_gene_expr_recon_loss: 9059373.4605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18103331.6279; train_optim_loss: 18103331.6279; val_kl_reg_loss: 196425.8678; val_edge_recon_loss: 8478583.7292; val_gene_expr_recon_loss: 8951358.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17626367.9167; val_optim_loss: 17626367.9167
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8748; val_auprc_score: 0.9729; val_best_acc_score: 0.9113; val_best_f1_score: 0.9500; train_kl_reg_loss: 199306.0390; train_edge_recon_loss: 8614523.1907; train_gene_expr_recon_loss: 8819590.8233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17633420.0279; train_optim_loss: 17633420.0279; val_kl_reg_loss: 193392.0234; val_edge_recon_loss: 8274789.5208; val_gene_expr_recon_loss: 8711654.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17179836.4167; val_optim_loss: 17179836.4167
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8718; val_auprc_score: 0.9716; val_best_acc_score: 0.9085; val_best_f1_score: 0.9483; train_kl_reg_loss: 195402.0003; train_edge_recon_loss: 8448806.2465; train_gene_expr_recon_loss: 8595278.0140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17239486.3163; train_optim_loss: 17239486.3163; val_kl_reg_loss: 185544.4232; val_edge_recon_loss: 8568271.4167; val_gene_expr_recon_loss: 8517710.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17271526.5000; val_optim_loss: 17271526.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8814; val_auprc_score: 0.9733; val_best_acc_score: 0.9073; val_best_f1_score: 0.9476; train_kl_reg_loss: 185037.3541; train_edge_recon_loss: 8360033.3000; train_gene_expr_recon_loss: 8416588.0628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16961658.6698; train_optim_loss: 16961658.6698; val_kl_reg_loss: 173766.3626; val_edge_recon_loss: 8558678.7083; val_gene_expr_recon_loss: 8355496.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17087941.7083; val_optim_loss: 17087941.7083
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8976; val_auprc_score: 0.9780; val_best_acc_score: 0.9112; val_best_f1_score: 0.9499; train_kl_reg_loss: 170994.1310; train_edge_recon_loss: 8291427.2791; train_gene_expr_recon_loss: 8276302.1535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16738723.5302; train_optim_loss: 16738723.5302; val_kl_reg_loss: 149148.5033; val_edge_recon_loss: 8212974.1458; val_gene_expr_recon_loss: 8221437.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16583560.2917; val_optim_loss: 16583560.2917
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9092; val_auprc_score: 0.9808; val_best_acc_score: 0.9177; val_best_f1_score: 0.9528; train_kl_reg_loss: 152888.9384; train_edge_recon_loss: 8326822.7093; train_gene_expr_recon_loss: 8150793.8791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16630505.5907; train_optim_loss: 16630505.5907; val_kl_reg_loss: 145997.1419; val_edge_recon_loss: 8130697.1250; val_gene_expr_recon_loss: 8105138.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16381832.5833; val_optim_loss: 16381832.5833
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9205; val_auprc_score: 0.9821; val_best_acc_score: 0.9226; val_best_f1_score: 0.9555; train_kl_reg_loss: 147127.7739; train_edge_recon_loss: 8257337.0256; train_gene_expr_recon_loss: 8040387.3488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16444852.1395; train_optim_loss: 16444852.1395; val_kl_reg_loss: 144858.1406; val_edge_recon_loss: 8161766.3333; val_gene_expr_recon_loss: 8003057.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16309681.9583; val_optim_loss: 16309681.9583
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9271; val_auprc_score: 0.9842; val_best_acc_score: 0.9248; val_best_f1_score: 0.9570; train_kl_reg_loss: 141664.4701; train_edge_recon_loss: 8162723.5209; train_gene_expr_recon_loss: 7940466.7767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16244854.7814; train_optim_loss: 16244854.7814; val_kl_reg_loss: 133794.0990; val_edge_recon_loss: 8031413.7500; val_gene_expr_recon_loss: 7903336.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16068544.6667; val_optim_loss: 16068544.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9276; val_auprc_score: 0.9844; val_best_acc_score: 0.9233; val_best_f1_score: 0.9560; train_kl_reg_loss: 132681.0051; train_edge_recon_loss: 7994936.5186; train_gene_expr_recon_loss: 7848304.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15975922.3721; train_optim_loss: 15975922.3721; val_kl_reg_loss: 120567.4694; val_edge_recon_loss: 8167999.2917; val_gene_expr_recon_loss: 7822879.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16111446.1250; val_optim_loss: 16111446.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9360; val_auprc_score: 0.9870; val_best_acc_score: 0.9252; val_best_f1_score: 0.9570; train_kl_reg_loss: 122272.4014; train_edge_recon_loss: 7997397.7605; train_gene_expr_recon_loss: 7768167.0023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15887837.2186; train_optim_loss: 15887837.2186; val_kl_reg_loss: 109731.5993; val_edge_recon_loss: 7839429.5833; val_gene_expr_recon_loss: 7749114.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15698276.2083; val_optim_loss: 15698276.2083
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9362; val_auprc_score: 0.9860; val_best_acc_score: 0.9240; val_best_f1_score: 0.9562; train_kl_reg_loss: 109455.3189; train_edge_recon_loss: 7954922.4163; train_gene_expr_recon_loss: 7691495.8140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15755873.5535; train_optim_loss: 15755873.5535; val_kl_reg_loss: 100135.0889; val_edge_recon_loss: 8129861.3750; val_gene_expr_recon_loss: 7680785.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15910782.4583; val_optim_loss: 15910782.4583
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9375; val_auprc_score: 0.9860; val_best_acc_score: 0.9218; val_best_f1_score: 0.9549; train_kl_reg_loss: 98475.0787; train_edge_recon_loss: 7919066.4047; train_gene_expr_recon_loss: 7626788.1837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15644329.6558; train_optim_loss: 15644329.6558; val_kl_reg_loss: 90920.4749; val_edge_recon_loss: 8080711.0208; val_gene_expr_recon_loss: 7626197.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15797828.5417; val_optim_loss: 15797828.5417
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9424; val_auprc_score: 0.9882; val_best_acc_score: 0.9304; val_best_f1_score: 0.9600; train_kl_reg_loss: 89967.5644; train_edge_recon_loss: 7805018.0326; train_gene_expr_recon_loss: 7562334.6233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15457320.1767; train_optim_loss: 15457320.1767; val_kl_reg_loss: 84366.2275; val_edge_recon_loss: 7781621.5417; val_gene_expr_recon_loss: 7559360.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15425348.3333; val_optim_loss: 15425348.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9376; val_auprc_score: 0.9867; val_best_acc_score: 0.9255; val_best_f1_score: 0.9573; train_kl_reg_loss: 83429.0221; train_edge_recon_loss: 7852987.8953; train_gene_expr_recon_loss: 7501486.5860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15437903.5023; train_optim_loss: 15437903.5023; val_kl_reg_loss: 76298.3604; val_edge_recon_loss: 7988797.9375; val_gene_expr_recon_loss: 7497164.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15562260.7083; val_optim_loss: 15562260.7083
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9486; val_auprc_score: 0.9887; val_best_acc_score: 0.9358; val_best_f1_score: 0.9630; train_kl_reg_loss: 77714.0901; train_edge_recon_loss: 7780549.6512; train_gene_expr_recon_loss: 7447368.5209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15305632.2837; train_optim_loss: 15305632.2837; val_kl_reg_loss: 70859.2633; val_edge_recon_loss: 7640112.4375; val_gene_expr_recon_loss: 7449432.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15160404.6667; val_optim_loss: 15160404.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9529; val_auprc_score: 0.9898; val_best_acc_score: 0.9411; val_best_f1_score: 0.9660; train_kl_reg_loss: 71641.3296; train_edge_recon_loss: 7766036.4070; train_gene_expr_recon_loss: 7399038.5116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15236716.2791; train_optim_loss: 15236716.2791; val_kl_reg_loss: 71525.3177; val_edge_recon_loss: 7691177.5417; val_gene_expr_recon_loss: 7385161.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15147864.3333; val_optim_loss: 15147864.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9556; val_auprc_score: 0.9903; val_best_acc_score: 0.9415; val_best_f1_score: 0.9662; train_kl_reg_loss: 68504.6965; train_edge_recon_loss: 7778639.9116; train_gene_expr_recon_loss: 7353736.9140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15200881.5116; train_optim_loss: 15200881.5116; val_kl_reg_loss: 64232.1030; val_edge_recon_loss: 7924723.3958; val_gene_expr_recon_loss: 7352024.5208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15340980.0417; val_optim_loss: 15340980.0417
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9547; val_auprc_score: 0.9894; val_best_acc_score: 0.9435; val_best_f1_score: 0.9671; train_kl_reg_loss: 62619.7721; train_edge_recon_loss: 7743069.1535; train_gene_expr_recon_loss: 7311073.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15116762.1535; train_optim_loss: 15116762.1535; val_kl_reg_loss: 57344.7772; val_edge_recon_loss: 8123220.9792; val_gene_expr_recon_loss: 7310363.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15490929.1250; val_optim_loss: 15490929.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9564; val_auprc_score: 0.9896; val_best_acc_score: 0.9500; val_best_f1_score: 0.9711; train_kl_reg_loss: 57910.7213; train_edge_recon_loss: 7761983.7651; train_gene_expr_recon_loss: 7273552.9535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15093447.4512; train_optim_loss: 15093447.4512; val_kl_reg_loss: 54540.0168; val_edge_recon_loss: 7738287.6458; val_gene_expr_recon_loss: 7275946.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15068774.3750; val_optim_loss: 15068774.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9552; val_auprc_score: 0.9892; val_best_acc_score: 0.9467; val_best_f1_score: 0.9691; train_kl_reg_loss: 53903.7267; train_edge_recon_loss: 7681002.6070; train_gene_expr_recon_loss: 7243522.7651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14978429.0791; train_optim_loss: 14978429.0791; val_kl_reg_loss: 50207.3481; val_edge_recon_loss: 7773004.8125; val_gene_expr_recon_loss: 7249555.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15072767.5000; val_optim_loss: 15072767.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9570; val_auprc_score: 0.9902; val_best_acc_score: 0.9463; val_best_f1_score: 0.9689; train_kl_reg_loss: 54622.6312; train_edge_recon_loss: 7693452.5930; train_gene_expr_recon_loss: 7225407.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14973482.5116; train_optim_loss: 14973482.5116; val_kl_reg_loss: 22409.7479; val_edge_recon_loss: 7893513.6875; val_gene_expr_recon_loss: 7232162.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15148085.4167; val_optim_loss: 15148085.4167
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9610; val_auprc_score: 0.9904; val_best_acc_score: 0.9505; val_best_f1_score: 0.9714; train_kl_reg_loss: 49357.1763; train_edge_recon_loss: 7742989.5791; train_gene_expr_recon_loss: 7194627.8605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14986974.6047; train_optim_loss: 14986974.6047; val_kl_reg_loss: 20495.9173; val_edge_recon_loss: 7979876.7500; val_gene_expr_recon_loss: 7207988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15208360.6667; val_optim_loss: 15208360.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9586; val_auprc_score: 0.9907; val_best_acc_score: 0.9500; val_best_f1_score: 0.9709; train_kl_reg_loss: 44813.6723; train_edge_recon_loss: 7732305.2186; train_gene_expr_recon_loss: 7165748.8721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14942867.7395; train_optim_loss: 14942867.7395; val_kl_reg_loss: 19327.8688; val_edge_recon_loss: 7915076.3958; val_gene_expr_recon_loss: 7174998.2292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15109402.6250; val_optim_loss: 15109402.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9573; val_auprc_score: 0.9888; val_best_acc_score: 0.9526; val_best_f1_score: 0.9725; train_kl_reg_loss: 41439.1345; train_edge_recon_loss: 7696645.0419; train_gene_expr_recon_loss: 7125895.2907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14863979.4977; train_optim_loss: 14863979.4977; val_kl_reg_loss: 19832.4739; val_edge_recon_loss: 7803181.5833; val_gene_expr_recon_loss: 7150936.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14973950.4583; val_optim_loss: 14973950.4583
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9595; val_auprc_score: 0.9903; val_best_acc_score: 0.9524; val_best_f1_score: 0.9724; train_kl_reg_loss: 41583.3811; train_edge_recon_loss: 7680722.0163; train_gene_expr_recon_loss: 7120360.5279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14842665.9163; train_optim_loss: 14842665.9163; val_kl_reg_loss: 19585.0887; val_edge_recon_loss: 7805147.4583; val_gene_expr_recon_loss: 7145987.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14970719.9167; val_optim_loss: 14970719.9167
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9629; val_auprc_score: 0.9912; val_best_acc_score: 0.9527; val_best_f1_score: 0.9727; train_kl_reg_loss: 40951.6545; train_edge_recon_loss: 7669455.0209; train_gene_expr_recon_loss: 7116774.9721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14827181.6465; train_optim_loss: 14827181.6465; val_kl_reg_loss: 19384.7575; val_edge_recon_loss: 7761018.3125; val_gene_expr_recon_loss: 7143093.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14923496.9583; val_optim_loss: 14923496.9583
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9599; val_auprc_score: 0.9904; val_best_acc_score: 0.9524; val_best_f1_score: 0.9725; train_kl_reg_loss: 41061.1775; train_edge_recon_loss: 7694764.2186; train_gene_expr_recon_loss: 7112365.5116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14848190.8884; train_optim_loss: 14848190.8884; val_kl_reg_loss: 19540.9292; val_edge_recon_loss: 7779749.5625; val_gene_expr_recon_loss: 7135589.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14934880.3333; val_optim_loss: 14934880.3333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9583; val_auprc_score: 0.9890; val_best_acc_score: 0.9519; val_best_f1_score: 0.9723; train_kl_reg_loss: 40472.5357; train_edge_recon_loss: 7707184.4279; train_gene_expr_recon_loss: 7110311.0302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14857967.9581; train_optim_loss: 14857967.9581; val_kl_reg_loss: 19490.6082; val_edge_recon_loss: 7753151.1667; val_gene_expr_recon_loss: 7143476.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14916117.6667; val_optim_loss: 14916117.6667
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9652; val_auprc_score: 0.9923; val_best_acc_score: 0.9552; val_best_f1_score: 0.9741; train_kl_reg_loss: 40489.1084; train_edge_recon_loss: 7632008.7465; train_gene_expr_recon_loss: 7106557.9302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14779055.8419; train_optim_loss: 14779055.8419; val_kl_reg_loss: 19644.6450; val_edge_recon_loss: 7651412.1667; val_gene_expr_recon_loss: 7133607.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14804664.7500; val_optim_loss: 14804664.7500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9590; val_auprc_score: 0.9902; val_best_acc_score: 0.9502; val_best_f1_score: 0.9712; train_kl_reg_loss: 40613.8922; train_edge_recon_loss: 7712137.4209; train_gene_expr_recon_loss: 7102375.9767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14855127.2977; train_optim_loss: 14855127.2977; val_kl_reg_loss: 19471.2258; val_edge_recon_loss: 7951664.6667; val_gene_expr_recon_loss: 7129481.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15100617.1250; val_optim_loss: 15100617.1250
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9595; val_auprc_score: 0.9899; val_best_acc_score: 0.9521; val_best_f1_score: 0.9721; train_kl_reg_loss: 39435.5545; train_edge_recon_loss: 7688795.7605; train_gene_expr_recon_loss: 7100900.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14829132.1674; train_optim_loss: 14829132.1674; val_kl_reg_loss: 19304.4250; val_edge_recon_loss: 8015151.4792; val_gene_expr_recon_loss: 7122685.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15157141.7500; val_optim_loss: 15157141.7500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9662; val_auprc_score: 0.9917; val_best_acc_score: 0.9539; val_best_f1_score: 0.9732; train_kl_reg_loss: 38791.9754; train_edge_recon_loss: 7671573.4000; train_gene_expr_recon_loss: 7097839.8721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14808205.2372; train_optim_loss: 14808205.2372; val_kl_reg_loss: 19234.0458; val_edge_recon_loss: 7848775.7292; val_gene_expr_recon_loss: 7120052.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14988062.5417; val_optim_loss: 14988062.5417
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9580; val_auprc_score: 0.9898; val_best_acc_score: 0.9528; val_best_f1_score: 0.9727; train_kl_reg_loss: 37855.9422; train_edge_recon_loss: 7629641.6837; train_gene_expr_recon_loss: 7092370.6465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14759868.2791; train_optim_loss: 14759868.2791; val_kl_reg_loss: 18556.2788; val_edge_recon_loss: 7773248.2500; val_gene_expr_recon_loss: 7118524.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14910329.0417; val_optim_loss: 14910329.0417

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9600; val_auprc_score: 0.9905; val_best_acc_score: 0.9533; val_best_f1_score: 0.9730; train_kl_reg_loss: 37156.7901; train_edge_recon_loss: 7705628.0605; train_gene_expr_recon_loss: 7091542.7698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14834327.6512; train_optim_loss: 14834327.6512; val_kl_reg_loss: 18778.0793; val_edge_recon_loss: 7868173.5417; val_gene_expr_recon_loss: 7106938.2292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14993889.8750; val_optim_loss: 14993889.8750
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9627; val_auprc_score: 0.9912; val_best_acc_score: 0.9532; val_best_f1_score: 0.9729; train_kl_reg_loss: 37307.6167; train_edge_recon_loss: 7680006.8326; train_gene_expr_recon_loss: 7085341.2163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14802655.6930; train_optim_loss: 14802655.6930; val_kl_reg_loss: 18763.9045; val_edge_recon_loss: 7878934.0000; val_gene_expr_recon_loss: 7115481.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15013179.7917; val_optim_loss: 15013179.7917
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9616; val_auprc_score: 0.9910; val_best_acc_score: 0.9546; val_best_f1_score: 0.9738; train_kl_reg_loss: 37230.3852; train_edge_recon_loss: 7652438.8279; train_gene_expr_recon_loss: 7087884.3977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14777553.5814; train_optim_loss: 14777553.5814; val_kl_reg_loss: 18815.8030; val_edge_recon_loss: 7599578.3333; val_gene_expr_recon_loss: 7107569.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14725963.5417; val_optim_loss: 14725963.5417
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9653; val_auprc_score: 0.9923; val_best_acc_score: 0.9555; val_best_f1_score: 0.9743; train_kl_reg_loss: 37134.7670; train_edge_recon_loss: 7602648.2372; train_gene_expr_recon_loss: 7087538.7326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14727321.6884; train_optim_loss: 14727321.6884; val_kl_reg_loss: 18728.2100; val_edge_recon_loss: 7764461.8542; val_gene_expr_recon_loss: 7106261.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14889451.4583; val_optim_loss: 14889451.4583
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9648; val_auprc_score: 0.9923; val_best_acc_score: 0.9545; val_best_f1_score: 0.9738; train_kl_reg_loss: 37087.7862; train_edge_recon_loss: 7610132.2000; train_gene_expr_recon_loss: 7086869.8209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14734089.8372; train_optim_loss: 14734089.8372; val_kl_reg_loss: 18807.2250; val_edge_recon_loss: 7537477.3542; val_gene_expr_recon_loss: 7111082.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14667367.3333; val_optim_loss: 14667367.3333
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9663; val_auprc_score: 0.9920; val_best_acc_score: 0.9562; val_best_f1_score: 0.9744; train_kl_reg_loss: 37127.4799; train_edge_recon_loss: 7675802.0395; train_gene_expr_recon_loss: 7087241.7488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14800171.2884; train_optim_loss: 14800171.2884; val_kl_reg_loss: 18796.1080; val_edge_recon_loss: 7937671.3125; val_gene_expr_recon_loss: 7112089.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15068556.7500; val_optim_loss: 15068556.7500
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9644; val_auprc_score: 0.9915; val_best_acc_score: 0.9556; val_best_f1_score: 0.9742; train_kl_reg_loss: 36904.4711; train_edge_recon_loss: 7653178.8791; train_gene_expr_recon_loss: 7084925.5256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14775008.8930; train_optim_loss: 14775008.8930; val_kl_reg_loss: 18697.4834; val_edge_recon_loss: 7820673.2292; val_gene_expr_recon_loss: 7115660.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14955030.7917; val_optim_loss: 14955030.7917
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9607; val_auprc_score: 0.9914; val_best_acc_score: 0.9528; val_best_f1_score: 0.9728; train_kl_reg_loss: 36857.0870; train_edge_recon_loss: 7570507.5512; train_gene_expr_recon_loss: 7083997.5302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14691362.1814; train_optim_loss: 14691362.1814; val_kl_reg_loss: 18730.4210; val_edge_recon_loss: 7654950.4792; val_gene_expr_recon_loss: 7122371.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14796052.3333; val_optim_loss: 14796052.3333
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9683; val_auprc_score: 0.9930; val_best_acc_score: 0.9560; val_best_f1_score: 0.9745; train_kl_reg_loss: 36812.7626; train_edge_recon_loss: 7681091.8605; train_gene_expr_recon_loss: 7083770.4860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14801675.0605; train_optim_loss: 14801675.0605; val_kl_reg_loss: 18609.8315; val_edge_recon_loss: 7619289.6458; val_gene_expr_recon_loss: 7114077.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14751976.6250; val_optim_loss: 14751976.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9603; val_auprc_score: 0.9901; val_best_acc_score: 0.9552; val_best_f1_score: 0.9741; train_kl_reg_loss: 36687.5398; train_edge_recon_loss: 7662616.0326; train_gene_expr_recon_loss: 7085677.7651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14784981.3116; train_optim_loss: 14784981.3116; val_kl_reg_loss: 18706.2526; val_edge_recon_loss: 7682710.4167; val_gene_expr_recon_loss: 7111534.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14812951.0417; val_optim_loss: 14812951.0417
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9628; val_auprc_score: 0.9900; val_best_acc_score: 0.9543; val_best_f1_score: 0.9733; train_kl_reg_loss: 36699.5628; train_edge_recon_loss: 7671209.1186; train_gene_expr_recon_loss: 7079601.8930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14787510.5767; train_optim_loss: 14787510.5767; val_kl_reg_loss: 18666.8695; val_edge_recon_loss: 8125445.8958; val_gene_expr_recon_loss: 7112336.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15256449.4167; val_optim_loss: 15256449.4167
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9612; val_auprc_score: 0.9909; val_best_acc_score: 0.9534; val_best_f1_score: 0.9731; train_kl_reg_loss: 36737.8076; train_edge_recon_loss: 7683881.9953; train_gene_expr_recon_loss: 7082624.2349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14803244.0465; train_optim_loss: 14803244.0465; val_kl_reg_loss: 18675.7338; val_edge_recon_loss: 7692126.7500; val_gene_expr_recon_loss: 7122083.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14832885.5833; val_optim_loss: 14832885.5833
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9631; val_auprc_score: 0.9914; val_best_acc_score: 0.9552; val_best_f1_score: 0.9740; train_kl_reg_loss: 36676.4032; train_edge_recon_loss: 7597233.3488; train_gene_expr_recon_loss: 7085304.7047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14719214.4326; train_optim_loss: 14719214.4326; val_kl_reg_loss: 18686.3458; val_edge_recon_loss: 7641782.6458; val_gene_expr_recon_loss: 7118859.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14779328.6667; val_optim_loss: 14779328.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 72 min 10 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9642
Val AUPRC score: 0.9914
Val best accuracy score: 0.9545
Val best F1 score: 0.9737
Val gene expr MSE score: 35762.1977
Val cat covariate0 mean sim diff: -0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
