[True]
Run timestamp: 07082023_175640_26.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_26']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8794; val_auprc_score: 0.9036; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6972.0102; train_edge_recon_loss: 36035.8559; train_gene_expr_recon_loss: 1265535.6389; train_masked_gp_l1_reg_loss: 15701.3602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119389.2552; train_chrom_access_recon_loss: 2671244.4861; train_global_loss: 4114878.6389; train_optim_loss: 4114878.6389; val_kl_reg_loss: 6617.4341; val_edge_recon_loss: 40660.6641; val_gene_expr_recon_loss: 1125506.3750; val_masked_gp_l1_reg_loss: 10538.9434; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117073.1172; val_chrom_access_recon_loss: 1696739.3750; val_global_loss: 2997136.0000; val_optim_loss: 2997136.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8951; val_auprc_score: 0.9124; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6290.6540; train_edge_recon_loss: 36629.5907; train_gene_expr_recon_loss: 1053538.8819; train_masked_gp_l1_reg_loss: 9058.0105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115654.4661; train_chrom_access_recon_loss: 1537715.8750; train_global_loss: 2758887.4722; train_optim_loss: 2758887.4722; val_kl_reg_loss: 5939.3701; val_edge_recon_loss: 40660.6836; val_gene_expr_recon_loss: 995811.1875; val_masked_gp_l1_reg_loss: 8431.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113979.3359; val_chrom_access_recon_loss: 1462154.8750; val_global_loss: 2626977.2500; val_optim_loss: 2626977.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9053; val_auprc_score: 0.9185; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8054.9151; train_edge_recon_loss: 37015.8767; train_gene_expr_recon_loss: 930385.8958; train_masked_gp_l1_reg_loss: 9221.0802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112698.5616; train_chrom_access_recon_loss: 1440066.3750; train_global_loss: 2537442.6944; train_optim_loss: 2537442.6944; val_kl_reg_loss: 12638.5576; val_edge_recon_loss: 40661.5195; val_gene_expr_recon_loss: 870921.7500; val_masked_gp_l1_reg_loss: 9882.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111092.3125; val_chrom_access_recon_loss: 1426301.6250; val_global_loss: 2471498.7500; val_optim_loss: 2471498.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9018; val_auprc_score: 0.9103; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17297.6583; train_edge_recon_loss: 38374.5764; train_gene_expr_recon_loss: 828492.2292; train_masked_gp_l1_reg_loss: 9969.4335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109751.1398; train_chrom_access_recon_loss: 1413698.7639; train_global_loss: 2417583.7778; train_optim_loss: 2417583.7778; val_kl_reg_loss: 20026.7812; val_edge_recon_loss: 40661.0859; val_gene_expr_recon_loss: 789763.6250; val_masked_gp_l1_reg_loss: 10079.4277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108002.4609; val_chrom_access_recon_loss: 1389009.2500; val_global_loss: 2357542.5000; val_optim_loss: 2357542.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8852; val_auprc_score: 0.8875; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 21033.6254; train_edge_recon_loss: 38828.8073; train_gene_expr_recon_loss: 768700.0486; train_masked_gp_l1_reg_loss: 10121.2209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106472.6693; train_chrom_access_recon_loss: 1373694.8333; train_global_loss: 2318851.2222; train_optim_loss: 2318851.2222; val_kl_reg_loss: 21925.9219; val_edge_recon_loss: 40658.1758; val_gene_expr_recon_loss: 750163.3750; val_masked_gp_l1_reg_loss: 10155.0049; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104481.5703; val_chrom_access_recon_loss: 1358222.1250; val_global_loss: 2285606.2500; val_optim_loss: 2285606.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8721; val_auprc_score: 0.8668; val_best_acc_score: 0.5042; val_best_f1_score: 0.6685; train_kl_reg_loss: 23494.6664; train_edge_recon_loss: 38985.1003; train_gene_expr_recon_loss: 734587.6528; train_masked_gp_l1_reg_loss: 10135.1222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102771.4444; train_chrom_access_recon_loss: 1348374.7361; train_global_loss: 2258348.6944; train_optim_loss: 2258348.6944; val_kl_reg_loss: 23431.6992; val_edge_recon_loss: 40649.1562; val_gene_expr_recon_loss: 723451.5000; val_masked_gp_l1_reg_loss: 10080.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100571.6406; val_chrom_access_recon_loss: 1340217.5000; val_global_loss: 2238401.5000; val_optim_loss: 2238401.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8490; val_auprc_score: 0.8364; val_best_acc_score: 0.5365; val_best_f1_score: 0.6831; train_kl_reg_loss: 24145.1289; train_edge_recon_loss: 39032.2192; train_gene_expr_recon_loss: 714792.7917; train_masked_gp_l1_reg_loss: 10030.4312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98739.6458; train_chrom_access_recon_loss: 1333200.6528; train_global_loss: 2219940.8333; train_optim_loss: 2219940.8333; val_kl_reg_loss: 23226.3320; val_edge_recon_loss: 40631.9453; val_gene_expr_recon_loss: 706999.3750; val_masked_gp_l1_reg_loss: 9965.9629; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96417.2812; val_chrom_access_recon_loss: 1330394.3750; val_global_loss: 2207635.2500; val_optim_loss: 2207635.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8333; val_auprc_score: 0.8246; val_best_acc_score: 0.5629; val_best_f1_score: 0.6951; train_kl_reg_loss: 24361.9520; train_edge_recon_loss: 39109.4510; train_gene_expr_recon_loss: 697099.3056; train_masked_gp_l1_reg_loss: 9906.7591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94533.3759; train_chrom_access_recon_loss: 1323069.4861; train_global_loss: 2188080.2778; train_optim_loss: 2188080.2778; val_kl_reg_loss: 24357.4121; val_edge_recon_loss: 40619.7891; val_gene_expr_recon_loss: 693284.3125; val_masked_gp_l1_reg_loss: 9819.7520; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92169.7031; val_chrom_access_recon_loss: 1323704.0000; val_global_loss: 2183955.0000; val_optim_loss: 2183955.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8151; val_auprc_score: 0.8070; val_best_acc_score: 0.5862; val_best_f1_score: 0.7055; train_kl_reg_loss: 24887.1693; train_edge_recon_loss: 39166.7691; train_gene_expr_recon_loss: 685207.3472; train_masked_gp_l1_reg_loss: 9756.7618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90277.0816; train_chrom_access_recon_loss: 1321051.9583; train_global_loss: 2170347.0833; train_optim_loss: 2170347.0833; val_kl_reg_loss: 25078.1875; val_edge_recon_loss: 40609.1758; val_gene_expr_recon_loss: 683565.0000; val_masked_gp_l1_reg_loss: 9671.4668; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87917.9375; val_chrom_access_recon_loss: 1318439.0000; val_global_loss: 2165280.7500; val_optim_loss: 2165280.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8126; val_auprc_score: 0.8028; val_best_acc_score: 0.6109; val_best_f1_score: 0.7167; train_kl_reg_loss: 24917.1317; train_edge_recon_loss: 39166.4071; train_gene_expr_recon_loss: 677601.0625; train_masked_gp_l1_reg_loss: 9609.1288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86047.8142; train_chrom_access_recon_loss: 1316289.3889; train_global_loss: 2153630.9167; train_optim_loss: 2153630.9167; val_kl_reg_loss: 24067.6602; val_edge_recon_loss: 40591.7500; val_gene_expr_recon_loss: 677933.1250; val_masked_gp_l1_reg_loss: 9539.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83724.5469; val_chrom_access_recon_loss: 1314055.7500; val_global_loss: 2149912.5000; val_optim_loss: 2149912.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7990; val_auprc_score: 0.7889; val_best_acc_score: 0.6233; val_best_f1_score: 0.7221; train_kl_reg_loss: 25058.1678; train_edge_recon_loss: 39220.5456; train_gene_expr_recon_loss: 672638.3542; train_masked_gp_l1_reg_loss: 9479.8345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81906.1762; train_chrom_access_recon_loss: 1311874.9306; train_global_loss: 2140178.0556; train_optim_loss: 2140178.0556; val_kl_reg_loss: 24255.6680; val_edge_recon_loss: 40579.6094; val_gene_expr_recon_loss: 672299.5000; val_masked_gp_l1_reg_loss: 9414.4658; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79656.9062; val_chrom_access_recon_loss: 1311085.3750; val_global_loss: 2137291.5000; val_optim_loss: 2137291.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7997; val_auprc_score: 0.7893; val_best_acc_score: 0.6458; val_best_f1_score: 0.7327; train_kl_reg_loss: 24558.1901; train_edge_recon_loss: 39177.4275; train_gene_expr_recon_loss: 664246.6111; train_masked_gp_l1_reg_loss: 9380.4081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77904.8377; train_chrom_access_recon_loss: 1303344.7639; train_global_loss: 2118612.1944; train_optim_loss: 2118612.1944; val_kl_reg_loss: 24012.3477; val_edge_recon_loss: 40561.3164; val_gene_expr_recon_loss: 668431.2500; val_masked_gp_l1_reg_loss: 9333.5244; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75740.5938; val_chrom_access_recon_loss: 1307935.7500; val_global_loss: 2126014.7500; val_optim_loss: 2126014.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7906; val_auprc_score: 0.7806; val_best_acc_score: 0.6478; val_best_f1_score: 0.7322; train_kl_reg_loss: 24477.2103; train_edge_recon_loss: 39194.7530; train_gene_expr_recon_loss: 661880.3611; train_masked_gp_l1_reg_loss: 9301.1042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74061.3090; train_chrom_access_recon_loss: 1307098.3333; train_global_loss: 2116013.0556; train_optim_loss: 2116013.0556; val_kl_reg_loss: 23380.3555; val_edge_recon_loss: 40554.6953; val_gene_expr_recon_loss: 665719.3750; val_masked_gp_l1_reg_loss: 9257.1543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71991.4062; val_chrom_access_recon_loss: 1305432.1250; val_global_loss: 2116335.0000; val_optim_loss: 2116335.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8042; val_auprc_score: 0.7969; val_best_acc_score: 0.6686; val_best_f1_score: 0.7421; train_kl_reg_loss: 24082.5100; train_edge_recon_loss: 39168.2734; train_gene_expr_recon_loss: 658862.7917; train_masked_gp_l1_reg_loss: 9226.3370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70388.3047; train_chrom_access_recon_loss: 1298575.0000; train_global_loss: 2100303.2500; train_optim_loss: 2100303.2500; val_kl_reg_loss: 22959.1328; val_edge_recon_loss: 40539.0039; val_gene_expr_recon_loss: 663034.5625; val_masked_gp_l1_reg_loss: 9189.6201; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68412.1953; val_chrom_access_recon_loss: 1302808.7500; val_global_loss: 2106943.2500; val_optim_loss: 2106943.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8066; val_auprc_score: 0.7980; val_best_acc_score: 0.6731; val_best_f1_score: 0.7436; train_kl_reg_loss: 23553.6823; train_edge_recon_loss: 39151.5924; train_gene_expr_recon_loss: 657138.3542; train_masked_gp_l1_reg_loss: 9165.9231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66890.2995; train_chrom_access_recon_loss: 1296958.0972; train_global_loss: 2092857.9444; train_optim_loss: 2092857.9444; val_kl_reg_loss: 23096.3066; val_edge_recon_loss: 40534.2422; val_gene_expr_recon_loss: 660322.1875; val_masked_gp_l1_reg_loss: 9140.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65021.1328; val_chrom_access_recon_loss: 1302666.2500; val_global_loss: 2100780.5000; val_optim_loss: 2100780.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8128; val_auprc_score: 0.8082; val_best_acc_score: 0.6862; val_best_f1_score: 0.7476; train_kl_reg_loss: 23150.9332; train_edge_recon_loss: 39123.0907; train_gene_expr_recon_loss: 659477.0347; train_masked_gp_l1_reg_loss: 9122.4922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63591.6389; train_chrom_access_recon_loss: 1300023.7917; train_global_loss: 2094488.9444; train_optim_loss: 2094488.9444; val_kl_reg_loss: 22012.6992; val_edge_recon_loss: 40514.2188; val_gene_expr_recon_loss: 658928.5000; val_masked_gp_l1_reg_loss: 9096.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61841.7812; val_chrom_access_recon_loss: 1300495.6250; val_global_loss: 2092889.0000; val_optim_loss: 2092889.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8402; val_auprc_score: 0.8353; val_best_acc_score: 0.7110; val_best_f1_score: 0.7621; train_kl_reg_loss: 22747.4173; train_edge_recon_loss: 39113.4909; train_gene_expr_recon_loss: 653014.4097; train_masked_gp_l1_reg_loss: 9092.3380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60503.3824; train_chrom_access_recon_loss: 1294888.5000; train_global_loss: 2079359.5139; train_optim_loss: 2079359.5139; val_kl_reg_loss: 21927.2656; val_edge_recon_loss: 40501.7930; val_gene_expr_recon_loss: 656754.6875; val_masked_gp_l1_reg_loss: 9077.5137; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58855.2305; val_chrom_access_recon_loss: 1297897.5000; val_global_loss: 2085014.0000; val_optim_loss: 2085014.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8523; val_auprc_score: 0.8429; val_best_acc_score: 0.7315; val_best_f1_score: 0.7733; train_kl_reg_loss: 22254.2765; train_edge_recon_loss: 39065.0894; train_gene_expr_recon_loss: 655198.7222; train_masked_gp_l1_reg_loss: 9069.8797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57592.6970; train_chrom_access_recon_loss: 1298039.9722; train_global_loss: 2081220.6528; train_optim_loss: 2081220.6528; val_kl_reg_loss: 21673.8594; val_edge_recon_loss: 40482.3555; val_gene_expr_recon_loss: 654992.3750; val_masked_gp_l1_reg_loss: 9065.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56049.4062; val_chrom_access_recon_loss: 1296148.6250; val_global_loss: 2078411.6250; val_optim_loss: 2078411.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8671; val_auprc_score: 0.8606; val_best_acc_score: 0.7648; val_best_f1_score: 0.7920; train_kl_reg_loss: 21900.9080; train_edge_recon_loss: 39044.2986; train_gene_expr_recon_loss: 649351.4444; train_masked_gp_l1_reg_loss: 9060.8500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54872.0286; train_chrom_access_recon_loss: 1294648.3889; train_global_loss: 2068877.9028; train_optim_loss: 2068877.9028; val_kl_reg_loss: 20468.7363; val_edge_recon_loss: 40443.9688; val_gene_expr_recon_loss: 654694.6250; val_masked_gp_l1_reg_loss: 9047.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53424.1445; val_chrom_access_recon_loss: 1294567.3750; val_global_loss: 2072646.0000; val_optim_loss: 2072646.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8775; val_auprc_score: 0.8667; val_best_acc_score: 0.7875; val_best_f1_score: 0.8074; train_kl_reg_loss: 21422.0922; train_edge_recon_loss: 39007.7682; train_gene_expr_recon_loss: 646921.6667; train_masked_gp_l1_reg_loss: 9039.8121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52319.8194; train_chrom_access_recon_loss: 1288983.1389; train_global_loss: 2057694.2778; train_optim_loss: 2057694.2778; val_kl_reg_loss: 20519.7578; val_edge_recon_loss: 40415.7812; val_gene_expr_recon_loss: 652502.1875; val_masked_gp_l1_reg_loss: 9027.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50961.6484; val_chrom_access_recon_loss: 1292170.2500; val_global_loss: 2065597.0000; val_optim_loss: 2065597.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8860; val_auprc_score: 0.8743; val_best_acc_score: 0.8037; val_best_f1_score: 0.8175; train_kl_reg_loss: 21099.8531; train_edge_recon_loss: 38955.8177; train_gene_expr_recon_loss: 646776.6528; train_masked_gp_l1_reg_loss: 9011.5503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49925.9679; train_chrom_access_recon_loss: 1285920.1111; train_global_loss: 2051689.9444; train_optim_loss: 2051689.9444; val_kl_reg_loss: 19862.8281; val_edge_recon_loss: 40384.0625; val_gene_expr_recon_loss: 651860.3125; val_masked_gp_l1_reg_loss: 8994.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48656.2500; val_chrom_access_recon_loss: 1290587.7500; val_global_loss: 2060345.3750; val_optim_loss: 2060345.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9006; val_auprc_score: 0.8910; val_best_acc_score: 0.8227; val_best_f1_score: 0.8310; train_kl_reg_loss: 20758.4627; train_edge_recon_loss: 38908.7826; train_gene_expr_recon_loss: 645114.0000; train_masked_gp_l1_reg_loss: 8982.7469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47690.1029; train_chrom_access_recon_loss: 1288309.0139; train_global_loss: 2049763.1250; train_optim_loss: 2049763.1250; val_kl_reg_loss: 20229.9531; val_edge_recon_loss: 40335.0547; val_gene_expr_recon_loss: 649970.2500; val_masked_gp_l1_reg_loss: 8968.3809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46497.9219; val_chrom_access_recon_loss: 1289076.8750; val_global_loss: 2055078.5000; val_optim_loss: 2055078.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9015; val_auprc_score: 0.8923; val_best_acc_score: 0.8271; val_best_f1_score: 0.8322; train_kl_reg_loss: 20612.3177; train_edge_recon_loss: 38872.1480; train_gene_expr_recon_loss: 647017.9722; train_masked_gp_l1_reg_loss: 8959.6995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45588.9852; train_chrom_access_recon_loss: 1287331.2083; train_global_loss: 2048382.3194; train_optim_loss: 2048382.3194; val_kl_reg_loss: 19864.9180; val_edge_recon_loss: 40297.0625; val_gene_expr_recon_loss: 648954.3750; val_masked_gp_l1_reg_loss: 8945.2725; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44475.9609; val_chrom_access_recon_loss: 1286486.3750; val_global_loss: 2049024.0000; val_optim_loss: 2049024.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9124; val_auprc_score: 0.9028; val_best_acc_score: 0.8387; val_best_f1_score: 0.8373; train_kl_reg_loss: 20319.5488; train_edge_recon_loss: 38811.5911; train_gene_expr_recon_loss: 642865.5000; train_masked_gp_l1_reg_loss: 8937.2393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43628.2122; train_chrom_access_recon_loss: 1286333.6806; train_global_loss: 2040895.7778; train_optim_loss: 2040895.7778; val_kl_reg_loss: 19106.2578; val_edge_recon_loss: 40242.5703; val_gene_expr_recon_loss: 648524.4375; val_masked_gp_l1_reg_loss: 8923.5605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42582.5781; val_chrom_access_recon_loss: 1284997.0000; val_global_loss: 2044376.3750; val_optim_loss: 2044376.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9253; val_auprc_score: 0.9172; val_best_acc_score: 0.8473; val_best_f1_score: 0.8420; train_kl_reg_loss: 20089.2493; train_edge_recon_loss: 38743.2769; train_gene_expr_recon_loss: 642046.7292; train_masked_gp_l1_reg_loss: 8919.5634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41789.3668; train_chrom_access_recon_loss: 1282438.4028; train_global_loss: 2034026.5694; train_optim_loss: 2034026.5694; val_kl_reg_loss: 19303.3711; val_edge_recon_loss: 40145.5898; val_gene_expr_recon_loss: 646938.9375; val_masked_gp_l1_reg_loss: 8911.8135; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40808.8398; val_chrom_access_recon_loss: 1282560.6250; val_global_loss: 2038669.1250; val_optim_loss: 2038669.1250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9317; val_auprc_score: 0.9239; val_best_acc_score: 0.8226; val_best_f1_score: 0.8440; train_kl_reg_loss: 16659.5611; train_edge_recon_loss: 40268.6220; train_gene_expr_recon_loss: 963476.2431; train_masked_gp_l1_reg_loss: 9093.4227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39963.6280; train_chrom_access_recon_loss: 1355817.3472; train_global_loss: 2425278.8056; train_optim_loss: 2425278.8056; val_kl_reg_loss: 13117.6260; val_edge_recon_loss: 40463.8086; val_gene_expr_recon_loss: 962645.2500; val_masked_gp_l1_reg_loss: 9456.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38860.7422; val_chrom_access_recon_loss: 1356561.7500; val_global_loss: 2421105.2500; val_optim_loss: 2421105.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9247; val_auprc_score: 0.9121; val_best_acc_score: 0.8177; val_best_f1_score: 0.8403; train_kl_reg_loss: 15280.7383; train_edge_recon_loss: 40279.3368; train_gene_expr_recon_loss: 954039.1181; train_masked_gp_l1_reg_loss: 9768.7821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37964.4562; train_chrom_access_recon_loss: 1354755.6111; train_global_loss: 2412088.0278; train_optim_loss: 2412088.0278; val_kl_reg_loss: 13122.4531; val_edge_recon_loss: 40467.6211; val_gene_expr_recon_loss: 954233.8750; val_masked_gp_l1_reg_loss: 10113.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36858.8633; val_chrom_access_recon_loss: 1354156.3750; val_global_loss: 2408952.2500; val_optim_loss: 2408952.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9254; val_auprc_score: 0.9148; val_best_acc_score: 0.8293; val_best_f1_score: 0.8479; train_kl_reg_loss: 14586.5317; train_edge_recon_loss: 40292.2196; train_gene_expr_recon_loss: 944127.7639; train_masked_gp_l1_reg_loss: 10325.6630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36007.4310; train_chrom_access_recon_loss: 1355869.2639; train_global_loss: 2401208.8889; train_optim_loss: 2401208.8889; val_kl_reg_loss: 12924.0850; val_edge_recon_loss: 40452.1602; val_gene_expr_recon_loss: 948480.3750; val_masked_gp_l1_reg_loss: 10546.1670; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34967.2617; val_chrom_access_recon_loss: 1351980.8750; val_global_loss: 2399351.0000; val_optim_loss: 2399351.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9239; val_auprc_score: 0.9121; val_best_acc_score: 0.8317; val_best_f1_score: 0.8492; train_kl_reg_loss: 14417.3568; train_edge_recon_loss: 40290.1506; train_gene_expr_recon_loss: 937433.5069; train_masked_gp_l1_reg_loss: 10667.5099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34174.2365; train_chrom_access_recon_loss: 1351919.1528; train_global_loss: 2388901.9167; train_optim_loss: 2388901.9167; val_kl_reg_loss: 12925.3145; val_edge_recon_loss: 40449.0430; val_gene_expr_recon_loss: 944170.1250; val_masked_gp_l1_reg_loss: 10786.9941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33206.6797; val_chrom_access_recon_loss: 1350593.5000; val_global_loss: 2392131.7500; val_optim_loss: 2392131.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9280; val_auprc_score: 0.9199; val_best_acc_score: 0.8358; val_best_f1_score: 0.8526; train_kl_reg_loss: 14151.9313; train_edge_recon_loss: 40285.2808; train_gene_expr_recon_loss: 935351.3125; train_masked_gp_l1_reg_loss: 10715.0859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33095.3845; train_chrom_access_recon_loss: 1353508.3889; train_global_loss: 2387107.3333; train_optim_loss: 2387107.3333; val_kl_reg_loss: 13362.1641; val_edge_recon_loss: 40445.9883; val_gene_expr_recon_loss: 943305.3750; val_masked_gp_l1_reg_loss: 10659.2520; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32961.2266; val_chrom_access_recon_loss: 1350029.8750; val_global_loss: 2390764.0000; val_optim_loss: 2390764.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9264; val_auprc_score: 0.9158; val_best_acc_score: 0.8359; val_best_f1_score: 0.8526; train_kl_reg_loss: 14552.4159; train_edge_recon_loss: 40286.1228; train_gene_expr_recon_loss: 938415.1042; train_masked_gp_l1_reg_loss: 10646.6517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32868.7170; train_chrom_access_recon_loss: 1348052.3611; train_global_loss: 2384821.3611; train_optim_loss: 2384821.3611; val_kl_reg_loss: 13396.6172; val_edge_recon_loss: 40448.4297; val_gene_expr_recon_loss: 942913.5000; val_masked_gp_l1_reg_loss: 10622.5244; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32751.9414; val_chrom_access_recon_loss: 1349846.8750; val_global_loss: 2389980.0000; val_optim_loss: 2389980.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9245; val_auprc_score: 0.9139; val_best_acc_score: 0.8316; val_best_f1_score: 0.8489; train_kl_reg_loss: 14349.3925; train_edge_recon_loss: 40286.0152; train_gene_expr_recon_loss: 942359.6736; train_masked_gp_l1_reg_loss: 10610.9015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32663.5979; train_chrom_access_recon_loss: 1348717.1667; train_global_loss: 2388986.7500; train_optim_loss: 2388986.7500; val_kl_reg_loss: 13201.8975; val_edge_recon_loss: 40449.0547; val_gene_expr_recon_loss: 942691.8125; val_masked_gp_l1_reg_loss: 10598.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32554.6523; val_chrom_access_recon_loss: 1349764.0000; val_global_loss: 2389259.5000; val_optim_loss: 2389259.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9296; val_auprc_score: 0.9209; val_best_acc_score: 0.8351; val_best_f1_score: 0.8518; train_kl_reg_loss: 14316.7704; train_edge_recon_loss: 40284.8563; train_gene_expr_recon_loss: 937491.1111; train_masked_gp_l1_reg_loss: 10591.9626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32469.9766; train_chrom_access_recon_loss: 1346475.5972; train_global_loss: 2381630.2778; train_optim_loss: 2381630.2778; val_kl_reg_loss: 13381.2158; val_edge_recon_loss: 40447.1289; val_gene_expr_recon_loss: 942254.1250; val_masked_gp_l1_reg_loss: 10585.7246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32367.0664; val_chrom_access_recon_loss: 1349576.7500; val_global_loss: 2388612.0000; val_optim_loss: 2388612.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 36 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9300
val AUPRC score: 0.9186
val best accuracy score: 0.7904
val best F1 score: 0.8220
val target rna MSE score: 3.9648
val source rna MSE score: 3.2063
val target atac MSE score: 0.1339
val source atac MSE score: 0.0201
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
