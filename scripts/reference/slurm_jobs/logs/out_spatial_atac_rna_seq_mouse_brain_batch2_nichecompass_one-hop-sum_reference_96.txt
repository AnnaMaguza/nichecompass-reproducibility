[True]
Run timestamp: 10082023_231958_96.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_96']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7507; val_auprc_score: 0.7755; val_best_acc_score: 0.5043; val_best_f1_score: 0.6684; train_kl_reg_loss: 128927.8883; train_edge_recon_loss: 3875730.8874; train_gene_expr_recon_loss: 44878130.1069; train_masked_gp_l1_reg_loss: 82200.4213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245727.8763; train_chrom_access_recon_loss: 27241864.7481; train_global_loss: 76452582.1679; train_optim_loss: 76452582.1679; val_kl_reg_loss: 316919.2021; val_edge_recon_loss: 4065325.5333; val_gene_expr_recon_loss: 38977270.9333; val_masked_gp_l1_reg_loss: 78965.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239801.8125; val_chrom_access_recon_loss: 26024451.6000; val_global_loss: 69702732.2667; val_optim_loss: 69702732.2667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7678; val_auprc_score: 0.7965; val_best_acc_score: 0.5651; val_best_f1_score: 0.6888; train_kl_reg_loss: 215480.8169; train_edge_recon_loss: 3673988.1183; train_gene_expr_recon_loss: 37836144.1832; train_masked_gp_l1_reg_loss: 75251.6656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232225.0415; train_chrom_access_recon_loss: 25851536.1221; train_global_loss: 67884626.1374; train_optim_loss: 67884626.1374; val_kl_reg_loss: 223064.5135; val_edge_recon_loss: 4061340.3833; val_gene_expr_recon_loss: 37690129.6000; val_masked_gp_l1_reg_loss: 73549.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224380.1250; val_chrom_access_recon_loss: 25675176.8000; val_global_loss: 67947639.2000; val_optim_loss: 67947639.2000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8648; val_auprc_score: 0.8624; val_best_acc_score: 0.7608; val_best_f1_score: 0.7540; train_kl_reg_loss: 206826.3217; train_edge_recon_loss: 3579836.0076; train_gene_expr_recon_loss: 37021652.7328; train_masked_gp_l1_reg_loss: 73423.2550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 216598.8578; train_chrom_access_recon_loss: 25590975.4198; train_global_loss: 66689312.6412; train_optim_loss: 66689312.6412; val_kl_reg_loss: 195243.4208; val_edge_recon_loss: 3998491.5667; val_gene_expr_recon_loss: 37030651.2000; val_masked_gp_l1_reg_loss: 74251.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 208828.3750; val_chrom_access_recon_loss: 25462370.2667; val_global_loss: 66969836.2667; val_optim_loss: 66969836.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9031; val_auprc_score: 0.8910; val_best_acc_score: 0.8290; val_best_f1_score: 0.8422; train_kl_reg_loss: 172056.5107; train_edge_recon_loss: 3512600.9599; train_gene_expr_recon_loss: 36622824.1832; train_masked_gp_l1_reg_loss: 75696.2108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 201528.2938; train_chrom_access_recon_loss: 25395970.8702; train_global_loss: 65980676.6718; train_optim_loss: 65980676.6718; val_kl_reg_loss: 146580.2521; val_edge_recon_loss: 3551164.3333; val_gene_expr_recon_loss: 36683531.7333; val_masked_gp_l1_reg_loss: 77193.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 194429.5156; val_chrom_access_recon_loss: 25268380.5333; val_global_loss: 65921276.5333; val_optim_loss: 65921276.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8940; val_auprc_score: 0.8799; val_best_acc_score: 0.8172; val_best_f1_score: 0.8313; train_kl_reg_loss: 169986.7684; train_edge_recon_loss: 3168393.0821; train_gene_expr_recon_loss: 36367673.4351; train_masked_gp_l1_reg_loss: 78854.1349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188211.6572; train_chrom_access_recon_loss: 25247289.2977; train_global_loss: 65220408.1832; train_optim_loss: 65220408.1832; val_kl_reg_loss: 196336.0167; val_edge_recon_loss: 3055712.4000; val_gene_expr_recon_loss: 36397993.0667; val_masked_gp_l1_reg_loss: 79999.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182090.2812; val_chrom_access_recon_loss: 25089903.8667; val_global_loss: 65002036.8000; val_optim_loss: 65002036.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9065; val_auprc_score: 0.8894; val_best_acc_score: 0.8313; val_best_f1_score: 0.8443; train_kl_reg_loss: 195404.0211; train_edge_recon_loss: 3005451.4160; train_gene_expr_recon_loss: 36111037.0992; train_masked_gp_l1_reg_loss: 81145.2246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176443.9678; train_chrom_access_recon_loss: 25128395.5420; train_global_loss: 64697877.3435; train_optim_loss: 64697877.3435; val_kl_reg_loss: 194686.0562; val_edge_recon_loss: 2993755.8333; val_gene_expr_recon_loss: 36313338.9333; val_masked_gp_l1_reg_loss: 82262.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170897.6094; val_chrom_access_recon_loss: 25072494.5333; val_global_loss: 64827434.6667; val_optim_loss: 64827434.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9229; val_auprc_score: 0.9079; val_best_acc_score: 0.8494; val_best_f1_score: 0.8571; train_kl_reg_loss: 191381.1834; train_edge_recon_loss: 2949838.1317; train_gene_expr_recon_loss: 35845241.1298; train_masked_gp_l1_reg_loss: 83559.8326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165803.3820; train_chrom_access_recon_loss: 24962667.5420; train_global_loss: 64198491.0840; train_optim_loss: 64198491.0840; val_kl_reg_loss: 184221.1708; val_edge_recon_loss: 2921942.3667; val_gene_expr_recon_loss: 36072768.5333; val_masked_gp_l1_reg_loss: 85020.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160780.1094; val_chrom_access_recon_loss: 24910452.4000; val_global_loss: 64335184.2667; val_optim_loss: 64335184.2667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9291; val_auprc_score: 0.9135; val_best_acc_score: 0.8600; val_best_f1_score: 0.8708; train_kl_reg_loss: 186352.9630; train_edge_recon_loss: 2927172.6889; train_gene_expr_recon_loss: 35716934.8855; train_masked_gp_l1_reg_loss: 86022.0785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156167.6462; train_chrom_access_recon_loss: 24909708.3511; train_global_loss: 63982358.8702; train_optim_loss: 63982358.8702; val_kl_reg_loss: 183510.2635; val_edge_recon_loss: 2884861.3500; val_gene_expr_recon_loss: 35859714.1333; val_masked_gp_l1_reg_loss: 87206.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151688.9531; val_chrom_access_recon_loss: 24793749.7333; val_global_loss: 63960730.9333; val_optim_loss: 63960730.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9336; val_auprc_score: 0.9191; val_best_acc_score: 0.8658; val_best_f1_score: 0.8741; train_kl_reg_loss: 183419.3170; train_edge_recon_loss: 2886954.3053; train_gene_expr_recon_loss: 35504588.3053; train_masked_gp_l1_reg_loss: 88332.5053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147542.7749; train_chrom_access_recon_loss: 24772071.2672; train_global_loss: 63582908.0916; train_optim_loss: 63582908.0916; val_kl_reg_loss: 177811.5094; val_edge_recon_loss: 2876456.5500; val_gene_expr_recon_loss: 35809339.2000; val_masked_gp_l1_reg_loss: 89492.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143641.7188; val_chrom_access_recon_loss: 24673044.9333; val_global_loss: 63769784.2667; val_optim_loss: 63769784.2667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9368; val_auprc_score: 0.9253; val_best_acc_score: 0.8667; val_best_f1_score: 0.8729; train_kl_reg_loss: 177656.6769; train_edge_recon_loss: 2875506.0210; train_gene_expr_recon_loss: 35375289.1298; train_masked_gp_l1_reg_loss: 90560.5151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140109.3169; train_chrom_access_recon_loss: 24719128.9160; train_global_loss: 63378250.8397; train_optim_loss: 63378250.8397; val_kl_reg_loss: 171392.1063; val_edge_recon_loss: 2888123.1500; val_gene_expr_recon_loss: 35613088.0000; val_masked_gp_l1_reg_loss: 91615.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136705.1875; val_chrom_access_recon_loss: 24619200.1333; val_global_loss: 63520122.9333; val_optim_loss: 63520122.9333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9455; val_auprc_score: 0.9326; val_best_acc_score: 0.8822; val_best_f1_score: 0.8875; train_kl_reg_loss: 171867.2479; train_edge_recon_loss: 2851532.7538; train_gene_expr_recon_loss: 35331645.9542; train_masked_gp_l1_reg_loss: 92847.2049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133582.0224; train_chrom_access_recon_loss: 24708079.5420; train_global_loss: 63289555.0534; train_optim_loss: 63289555.0534; val_kl_reg_loss: 166734.3750; val_edge_recon_loss: 2846923.1667; val_gene_expr_recon_loss: 35473424.5333; val_masked_gp_l1_reg_loss: 93879.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130547.4766; val_chrom_access_recon_loss: 24567850.9333; val_global_loss: 63279361.0667; val_optim_loss: 63279361.0667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9463; val_auprc_score: 0.9307; val_best_acc_score: 0.8843; val_best_f1_score: 0.8900; train_kl_reg_loss: 167271.0087; train_edge_recon_loss: 2843540.4599; train_gene_expr_recon_loss: 35188566.9313; train_masked_gp_l1_reg_loss: 94905.9772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127540.7818; train_chrom_access_recon_loss: 24636320.8702; train_global_loss: 63058146.1374; train_optim_loss: 63058146.1374; val_kl_reg_loss: 167929.8323; val_edge_recon_loss: 2832912.1500; val_gene_expr_recon_loss: 35444578.2667; val_masked_gp_l1_reg_loss: 95999.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124648.4609; val_chrom_access_recon_loss: 24494650.6667; val_global_loss: 63160718.6667; val_optim_loss: 63160718.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9483; val_auprc_score: 0.9376; val_best_acc_score: 0.8859; val_best_f1_score: 0.8902; train_kl_reg_loss: 164260.9693; train_edge_recon_loss: 2821032.3607; train_gene_expr_recon_loss: 35038029.5573; train_masked_gp_l1_reg_loss: 97005.1011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121845.3353; train_chrom_access_recon_loss: 24545265.8779; train_global_loss: 62787439.2672; train_optim_loss: 62787439.2672; val_kl_reg_loss: 162071.0198; val_edge_recon_loss: 2847873.3167; val_gene_expr_recon_loss: 35230056.0000; val_masked_gp_l1_reg_loss: 97893.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119093.1250; val_chrom_access_recon_loss: 24499646.6667; val_global_loss: 62956630.6667; val_optim_loss: 62956630.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9574; val_auprc_score: 0.9506; val_best_acc_score: 0.8932; val_best_f1_score: 0.8966; train_kl_reg_loss: 159463.3432; train_edge_recon_loss: 2820574.0057; train_gene_expr_recon_loss: 34997245.7252; train_masked_gp_l1_reg_loss: 98907.6353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116465.3769; train_chrom_access_recon_loss: 24542863.6489; train_global_loss: 62735519.9084; train_optim_loss: 62735519.9084; val_kl_reg_loss: 159615.9833; val_edge_recon_loss: 2822617.0500; val_gene_expr_recon_loss: 35204457.6000; val_masked_gp_l1_reg_loss: 100044.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113976.6328; val_chrom_access_recon_loss: 24418791.2000; val_global_loss: 62819501.8667; val_optim_loss: 62819501.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9568; val_auprc_score: 0.9477; val_best_acc_score: 0.8980; val_best_f1_score: 0.9011; train_kl_reg_loss: 157300.1474; train_edge_recon_loss: 2804597.0534; train_gene_expr_recon_loss: 34854723.9542; train_masked_gp_l1_reg_loss: 100994.3316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111548.6127; train_chrom_access_recon_loss: 24460879.0382; train_global_loss: 62490043.0534; train_optim_loss: 62490043.0534; val_kl_reg_loss: 156371.6375; val_edge_recon_loss: 2807627.0000; val_gene_expr_recon_loss: 35185861.2000; val_masked_gp_l1_reg_loss: 102056.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109229.6406; val_chrom_access_recon_loss: 24430106.9333; val_global_loss: 62791250.9333; val_optim_loss: 62791250.9333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9583; val_auprc_score: 0.9493; val_best_acc_score: 0.8961; val_best_f1_score: 0.9003; train_kl_reg_loss: 153797.0879; train_edge_recon_loss: 2787384.3664; train_gene_expr_recon_loss: 34811823.3893; train_masked_gp_l1_reg_loss: 102921.6127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107105.8157; train_chrom_access_recon_loss: 24443373.1145; train_global_loss: 62406404.9466; train_optim_loss: 62406404.9466; val_kl_reg_loss: 151925.4917; val_edge_recon_loss: 2824640.4500; val_gene_expr_recon_loss: 35188367.7333; val_masked_gp_l1_reg_loss: 104207.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104990.8047; val_chrom_access_recon_loss: 24510700.2667; val_global_loss: 62884833.6000; val_optim_loss: 62884833.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9596; val_auprc_score: 0.9513; val_best_acc_score: 0.9018; val_best_f1_score: 0.9048; train_kl_reg_loss: 149818.2823; train_edge_recon_loss: 2790067.4008; train_gene_expr_recon_loss: 34684052.6718; train_masked_gp_l1_reg_loss: 104925.2202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103021.8590; train_chrom_access_recon_loss: 24360931.7710; train_global_loss: 62192817.0687; train_optim_loss: 62192817.0687; val_kl_reg_loss: 148940.1865; val_edge_recon_loss: 2802427.1333; val_gene_expr_recon_loss: 34989148.0000; val_masked_gp_l1_reg_loss: 105974.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101052.0781; val_chrom_access_recon_loss: 24358939.0667; val_global_loss: 62506482.6667; val_optim_loss: 62506482.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9653; val_auprc_score: 0.9566; val_best_acc_score: 0.9107; val_best_f1_score: 0.9128; train_kl_reg_loss: 146807.8261; train_edge_recon_loss: 2782599.0248; train_gene_expr_recon_loss: 34658126.0611; train_masked_gp_l1_reg_loss: 106889.9515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99233.3203; train_chrom_access_recon_loss: 24355715.3588; train_global_loss: 62149371.4198; train_optim_loss: 62149371.4198; val_kl_reg_loss: 145351.6531; val_edge_recon_loss: 2772222.7667; val_gene_expr_recon_loss: 34962918.9333; val_masked_gp_l1_reg_loss: 107812.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97456.0391; val_chrom_access_recon_loss: 24243590.4000; val_global_loss: 62329351.4667; val_optim_loss: 62329351.4667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9645; val_auprc_score: 0.9553; val_best_acc_score: 0.9092; val_best_f1_score: 0.9123; train_kl_reg_loss: 143955.0186; train_edge_recon_loss: 2779060.4103; train_gene_expr_recon_loss: 34587491.1298; train_masked_gp_l1_reg_loss: 108740.5206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95790.6317; train_chrom_access_recon_loss: 24321247.2214; train_global_loss: 62036285.1908; train_optim_loss: 62036285.1908; val_kl_reg_loss: 139396.8635; val_edge_recon_loss: 2789592.1333; val_gene_expr_recon_loss: 34797341.3333; val_masked_gp_l1_reg_loss: 109634.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94122.1172; val_chrom_access_recon_loss: 24184058.1333; val_global_loss: 62114148.8000; val_optim_loss: 62114148.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9654; val_auprc_score: 0.9560; val_best_acc_score: 0.9113; val_best_f1_score: 0.9146; train_kl_reg_loss: 140585.1200; train_edge_recon_loss: 2775748.5630; train_gene_expr_recon_loss: 34468236.0916; train_masked_gp_l1_reg_loss: 110643.4184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92498.2663; train_chrom_access_recon_loss: 24248546.7786; train_global_loss: 61836258.4427; train_optim_loss: 61836258.4427; val_kl_reg_loss: 142842.0063; val_edge_recon_loss: 2779985.7333; val_gene_expr_recon_loss: 34943926.5333; val_masked_gp_l1_reg_loss: 111613.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91060.1797; val_chrom_access_recon_loss: 24272996.6667; val_global_loss: 62342422.4000; val_optim_loss: 62342422.4000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9674; val_auprc_score: 0.9587; val_best_acc_score: 0.9154; val_best_f1_score: 0.9181; train_kl_reg_loss: 138489.0316; train_edge_recon_loss: 2767275.5916; train_gene_expr_recon_loss: 34490523.3282; train_masked_gp_l1_reg_loss: 112700.6471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89626.9544; train_chrom_access_recon_loss: 24310120.1374; train_global_loss: 61908735.0534; train_optim_loss: 61908735.0534; val_kl_reg_loss: 138967.7531; val_edge_recon_loss: 2782994.4333; val_gene_expr_recon_loss: 34846992.6667; val_masked_gp_l1_reg_loss: 113691.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88279.4844; val_chrom_access_recon_loss: 24267633.7333; val_global_loss: 62238559.7333; val_optim_loss: 62238559.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9673; val_auprc_score: 0.9610; val_best_acc_score: 0.9135; val_best_f1_score: 0.9165; train_kl_reg_loss: 136600.1281; train_edge_recon_loss: 2764131.8950; train_gene_expr_recon_loss: 34427761.6336; train_masked_gp_l1_reg_loss: 114692.5533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87089.8219; train_chrom_access_recon_loss: 24266529.7252; train_global_loss: 61796805.5573; train_optim_loss: 61796805.5573; val_kl_reg_loss: 136530.3219; val_edge_recon_loss: 2782707.3500; val_gene_expr_recon_loss: 34748401.3333; val_masked_gp_l1_reg_loss: 115547.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85907.7188; val_chrom_access_recon_loss: 24232145.4667; val_global_loss: 62101241.0667; val_optim_loss: 62101241.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9723; val_auprc_score: 0.9637; val_best_acc_score: 0.9200; val_best_f1_score: 0.9225; train_kl_reg_loss: 135135.4674; train_edge_recon_loss: 2762724.0763; train_gene_expr_recon_loss: 34294444.0763; train_masked_gp_l1_reg_loss: 116544.2462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84760.4431; train_chrom_access_recon_loss: 24171522.7176; train_global_loss: 61565131.3282; train_optim_loss: 61565131.3282; val_kl_reg_loss: 136952.9750; val_edge_recon_loss: 2763057.5333; val_gene_expr_recon_loss: 34675727.4667; val_masked_gp_l1_reg_loss: 117601.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83648.7031; val_chrom_access_recon_loss: 24170778.0000; val_global_loss: 61947764.0000; val_optim_loss: 61947764.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9676; val_auprc_score: 0.9596; val_best_acc_score: 0.9153; val_best_f1_score: 0.9180; train_kl_reg_loss: 132922.1173; train_edge_recon_loss: 2757305.9103; train_gene_expr_recon_loss: 34323087.7252; train_masked_gp_l1_reg_loss: 118585.7263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82726.7861; train_chrom_access_recon_loss: 24223854.0763; train_global_loss: 61638482.0458; train_optim_loss: 61638482.0458; val_kl_reg_loss: 134746.9177; val_edge_recon_loss: 2784216.4500; val_gene_expr_recon_loss: 34580293.0667; val_masked_gp_l1_reg_loss: 119492.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81717.4297; val_chrom_access_recon_loss: 24142992.1333; val_global_loss: 61843456.0000; val_optim_loss: 61843456.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9692; val_auprc_score: 0.9617; val_best_acc_score: 0.9159; val_best_f1_score: 0.9195; train_kl_reg_loss: 130700.8065; train_edge_recon_loss: 2754287.5439; train_gene_expr_recon_loss: 34257584.1221; train_masked_gp_l1_reg_loss: 120595.2323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80732.4719; train_chrom_access_recon_loss: 24197805.4962; train_global_loss: 61541705.9237; train_optim_loss: 61541705.9237; val_kl_reg_loss: 133849.6125; val_edge_recon_loss: 2774985.5000; val_gene_expr_recon_loss: 34741573.8667; val_masked_gp_l1_reg_loss: 121279.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79700.9609; val_chrom_access_recon_loss: 24255042.2667; val_global_loss: 62106431.4667; val_optim_loss: 62106431.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9712; val_auprc_score: 0.9665; val_best_acc_score: 0.9186; val_best_f1_score: 0.9220; train_kl_reg_loss: 137738.1384; train_edge_recon_loss: 2801918.8244; train_gene_expr_recon_loss: 35572386.5344; train_masked_gp_l1_reg_loss: 120868.1988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80717.8022; train_chrom_access_recon_loss: 24492233.9084; train_global_loss: 63205863.1756; train_optim_loss: 63205863.1756; val_kl_reg_loss: 77449.7943; val_edge_recon_loss: 2796298.5167; val_gene_expr_recon_loss: 35694672.2667; val_masked_gp_l1_reg_loss: 121158.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80888.5547; val_chrom_access_recon_loss: 24361812.8000; val_global_loss: 63132281.6000; val_optim_loss: 63132281.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9704; val_auprc_score: 0.9646; val_best_acc_score: 0.9197; val_best_f1_score: 0.9207; train_kl_reg_loss: 135220.8393; train_edge_recon_loss: 2783018.0420; train_gene_expr_recon_loss: 35347832.1679; train_masked_gp_l1_reg_loss: 121473.4566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80218.4765; train_chrom_access_recon_loss: 24451936.9008; train_global_loss: 62919699.6031; train_optim_loss: 62919699.6031; val_kl_reg_loss: 82051.1536; val_edge_recon_loss: 2791893.6667; val_gene_expr_recon_loss: 35637931.4667; val_masked_gp_l1_reg_loss: 121661.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79362.8672; val_chrom_access_recon_loss: 24396499.7333; val_global_loss: 63109400.8000; val_optim_loss: 63109400.8000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9710; val_auprc_score: 0.9638; val_best_acc_score: 0.9200; val_best_f1_score: 0.9217; train_kl_reg_loss: 127497.8789; train_edge_recon_loss: 2756624.4790; train_gene_expr_recon_loss: 35206879.2672; train_masked_gp_l1_reg_loss: 121743.7934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78434.5307; train_chrom_access_recon_loss: 24407357.9084; train_global_loss: 62698537.8015; train_optim_loss: 62698537.8015; val_kl_reg_loss: 87420.6052; val_edge_recon_loss: 2769924.8167; val_gene_expr_recon_loss: 35687350.1333; val_masked_gp_l1_reg_loss: 121814.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77432.8672; val_chrom_access_recon_loss: 24475166.8000; val_global_loss: 63219110.1333; val_optim_loss: 63219110.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9737; val_auprc_score: 0.9688; val_best_acc_score: 0.9225; val_best_f1_score: 0.9242; train_kl_reg_loss: 124520.6903; train_edge_recon_loss: 2743256.7366; train_gene_expr_recon_loss: 35192263.3893; train_masked_gp_l1_reg_loss: 121436.9681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77130.5320; train_chrom_access_recon_loss: 24378476.4275; train_global_loss: 62637084.7328; train_optim_loss: 62637084.7328; val_kl_reg_loss: 88543.0120; val_edge_recon_loss: 2743196.7333; val_gene_expr_recon_loss: 35676631.7333; val_masked_gp_l1_reg_loss: 121321.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76897.9375; val_chrom_access_recon_loss: 24361985.3333; val_global_loss: 63068573.3333; val_optim_loss: 63068573.3333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9736; val_auprc_score: 0.9681; val_best_acc_score: 0.9231; val_best_f1_score: 0.9247; train_kl_reg_loss: 123878.9309; train_edge_recon_loss: 2748324.9065; train_gene_expr_recon_loss: 35228900.6260; train_masked_gp_l1_reg_loss: 121289.2373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76748.8734; train_chrom_access_recon_loss: 24410944.9160; train_global_loss: 62710087.5115; train_optim_loss: 62710087.5115; val_kl_reg_loss: 88884.7734; val_edge_recon_loss: 2749506.5500; val_gene_expr_recon_loss: 35596167.7333; val_masked_gp_l1_reg_loss: 121262.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76619.3438; val_chrom_access_recon_loss: 24324056.1333; val_global_loss: 62956498.6667; val_optim_loss: 62956498.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9720; val_auprc_score: 0.9667; val_best_acc_score: 0.9221; val_best_f1_score: 0.9238; train_kl_reg_loss: 123151.3457; train_edge_recon_loss: 2744909.7214; train_gene_expr_recon_loss: 35228751.8779; train_masked_gp_l1_reg_loss: 121249.1410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76510.1410; train_chrom_access_recon_loss: 24423950.7481; train_global_loss: 62718522.8397; train_optim_loss: 62718522.8397; val_kl_reg_loss: 89854.0641; val_edge_recon_loss: 2758346.6500; val_gene_expr_recon_loss: 35621109.0667; val_masked_gp_l1_reg_loss: 121230.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76392.0547; val_chrom_access_recon_loss: 24371437.4667; val_global_loss: 63038371.2000; val_optim_loss: 63038371.2000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9734; val_auprc_score: 0.9688; val_best_acc_score: 0.9216; val_best_f1_score: 0.9234; train_kl_reg_loss: 122818.3257; train_edge_recon_loss: 2740469.4962; train_gene_expr_recon_loss: 35161780.7176; train_masked_gp_l1_reg_loss: 121211.8441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76274.7316; train_chrom_access_recon_loss: 24372741.7405; train_global_loss: 62595296.6718; train_optim_loss: 62595296.6718; val_kl_reg_loss: 89463.7750; val_edge_recon_loss: 2752278.0667; val_gene_expr_recon_loss: 35523626.1333; val_masked_gp_l1_reg_loss: 121187.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76142.4531; val_chrom_access_recon_loss: 24343085.3333; val_global_loss: 62905785.0667; val_optim_loss: 62905785.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 51 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9727
val AUPRC score: 0.9658
val best accuracy score: 0.9251
val best F1 score: 0.9277
val target rna MSE score: 1.2089
val source rna MSE score: 99.5634
val target atac MSE score: 0.3424
val source atac MSE score: 2.6379
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
