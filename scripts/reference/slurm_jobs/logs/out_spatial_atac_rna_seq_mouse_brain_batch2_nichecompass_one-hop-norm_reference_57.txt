[True]
Run timestamp: 24072023_165739_57.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_57']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9642; val_auprc_score: 0.9684; val_best_acc_score: 0.6967; val_best_f1_score: 0.7660; train_kl_reg_loss: 23881.1185; train_edge_recon_loss: 34665772.4444; train_gene_expr_recon_loss: 317911.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1103875.7917; train_global_loss: 36111440.4444; train_optim_loss: 36111440.4444; val_kl_reg_loss: 18008.4766; val_edge_recon_loss: 40567712.0000; val_gene_expr_recon_loss: 307052.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1060589.3750; val_global_loss: 41953360.0000; val_optim_loss: 41953360.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9607; val_auprc_score: 0.9604; val_best_acc_score: 0.8781; val_best_f1_score: 0.8676; train_kl_reg_loss: 10077.4081; train_edge_recon_loss: 34660840.4444; train_gene_expr_recon_loss: 316360.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1098140.4167; train_global_loss: 36085418.2222; train_optim_loss: 36085418.2222; val_kl_reg_loss: 1803.2490; val_edge_recon_loss: 40353052.0000; val_gene_expr_recon_loss: 305548.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1060597.7500; val_global_loss: 41721000.0000; val_optim_loss: 41721000.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9360; val_auprc_score: 0.9348; val_best_acc_score: 0.8333; val_best_f1_score: 0.8505; train_kl_reg_loss: 1436.6327; train_edge_recon_loss: 34634349.3333; train_gene_expr_recon_loss: 314472.1493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1080507.3889; train_global_loss: 36030765.7778; train_optim_loss: 36030765.7778; val_kl_reg_loss: 662.5808; val_edge_recon_loss: 38910184.0000; val_gene_expr_recon_loss: 303931.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058329.3750; val_global_loss: 40273108.0000; val_optim_loss: 40273108.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8771; val_auprc_score: 0.8603; val_best_acc_score: 0.7871; val_best_f1_score: 0.8109; train_kl_reg_loss: 938.5058; train_edge_recon_loss: 34178266.2222; train_gene_expr_recon_loss: 309120.6806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1082778.7083; train_global_loss: 35571103.5556; train_optim_loss: 35571103.5556; val_kl_reg_loss: 1577.2283; val_edge_recon_loss: 31544352.0000; val_gene_expr_recon_loss: 299895.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1057170.2500; val_global_loss: 32902996.0000; val_optim_loss: 32902996.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8664; val_auprc_score: 0.8617; val_best_acc_score: 0.7728; val_best_f1_score: 0.7892; train_kl_reg_loss: 6904.2248; train_edge_recon_loss: 30200420.0000; train_gene_expr_recon_loss: 308004.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1077322.2639; train_global_loss: 31592651.3333; train_optim_loss: 31592651.3333; val_kl_reg_loss: 17518.6328; val_edge_recon_loss: 28640742.0000; val_gene_expr_recon_loss: 305504.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058766.3750; val_global_loss: 30022530.0000; val_optim_loss: 30022530.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8827; val_auprc_score: 0.8783; val_best_acc_score: 0.7901; val_best_f1_score: 0.7956; train_kl_reg_loss: 28368.4603; train_edge_recon_loss: 28253425.5556; train_gene_expr_recon_loss: 308336.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1075286.1667; train_global_loss: 29665416.8889; train_optim_loss: 29665416.8889; val_kl_reg_loss: 36173.6406; val_edge_recon_loss: 28681960.0000; val_gene_expr_recon_loss: 300392.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1054301.1250; val_global_loss: 30072828.0000; val_optim_loss: 30072828.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8894; val_auprc_score: 0.8702; val_best_acc_score: 0.8077; val_best_f1_score: 0.8229; train_kl_reg_loss: 41559.5425; train_edge_recon_loss: 27980769.5556; train_gene_expr_recon_loss: 302108.6076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1068617.0972; train_global_loss: 29393054.2222; train_optim_loss: 29393054.2222; val_kl_reg_loss: 42479.5000; val_edge_recon_loss: 27733814.0000; val_gene_expr_recon_loss: 296021.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051101.5000; val_global_loss: 29123418.0000; val_optim_loss: 29123418.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9018; val_auprc_score: 0.8711; val_best_acc_score: 0.8324; val_best_f1_score: 0.8472; train_kl_reg_loss: 46251.2266; train_edge_recon_loss: 27563106.8889; train_gene_expr_recon_loss: 301747.9306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1073150.1250; train_global_loss: 28984256.0000; train_optim_loss: 28984256.0000; val_kl_reg_loss: 45492.5977; val_edge_recon_loss: 27653662.0000; val_gene_expr_recon_loss: 298346.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048402.8750; val_global_loss: 29045902.0000; val_optim_loss: 29045902.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9269; val_auprc_score: 0.9054; val_best_acc_score: 0.8634; val_best_f1_score: 0.8714; train_kl_reg_loss: 47153.8286; train_edge_recon_loss: 27223642.0000; train_gene_expr_recon_loss: 300804.6493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1065612.6806; train_global_loss: 28637213.7778; train_optim_loss: 28637213.7778; val_kl_reg_loss: 46105.2969; val_edge_recon_loss: 27305356.0000; val_gene_expr_recon_loss: 295152.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1046109.2500; val_global_loss: 28692724.0000; val_optim_loss: 28692724.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9362; val_auprc_score: 0.9184; val_best_acc_score: 0.8729; val_best_f1_score: 0.8788; train_kl_reg_loss: 47982.8767; train_edge_recon_loss: 26908590.8889; train_gene_expr_recon_loss: 299431.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1065163.9931; train_global_loss: 28321169.7778; train_optim_loss: 28321169.7778; val_kl_reg_loss: 44971.8555; val_edge_recon_loss: 26891076.0000; val_gene_expr_recon_loss: 292512.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1044422.6875; val_global_loss: 28272982.0000; val_optim_loss: 28272982.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9412; val_auprc_score: 0.9213; val_best_acc_score: 0.8805; val_best_f1_score: 0.8885; train_kl_reg_loss: 45526.4210; train_edge_recon_loss: 26869461.1111; train_gene_expr_recon_loss: 297827.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1063450.1111; train_global_loss: 28276264.8889; train_optim_loss: 28276264.8889; val_kl_reg_loss: 40985.8984; val_edge_recon_loss: 26980892.0000; val_gene_expr_recon_loss: 289641.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1044201.9375; val_global_loss: 28355722.0000; val_optim_loss: 28355722.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9557; val_auprc_score: 0.9397; val_best_acc_score: 0.9045; val_best_f1_score: 0.9086; train_kl_reg_loss: 40862.2253; train_edge_recon_loss: 26677931.5556; train_gene_expr_recon_loss: 293786.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1059097.2083; train_global_loss: 28071677.7778; train_optim_loss: 28071677.7778; val_kl_reg_loss: 37719.0078; val_edge_recon_loss: 26531130.0000; val_gene_expr_recon_loss: 289153.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1041981.9375; val_global_loss: 27899986.0000; val_optim_loss: 27899986.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9571; val_auprc_score: 0.9325; val_best_acc_score: 0.9092; val_best_f1_score: 0.9134; train_kl_reg_loss: 38299.7391; train_edge_recon_loss: 26498878.4444; train_gene_expr_recon_loss: 293241.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1064813.7639; train_global_loss: 27895232.4444; train_optim_loss: 27895232.4444; val_kl_reg_loss: 36363.6094; val_edge_recon_loss: 26484498.0000; val_gene_expr_recon_loss: 286851.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1040664.3750; val_global_loss: 27848378.0000; val_optim_loss: 27848378.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9578; val_auprc_score: 0.9418; val_best_acc_score: 0.9064; val_best_f1_score: 0.9116; train_kl_reg_loss: 37296.9609; train_edge_recon_loss: 26445432.6667; train_gene_expr_recon_loss: 289651.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058350.1389; train_global_loss: 27830730.6667; train_optim_loss: 27830730.6667; val_kl_reg_loss: 36150.7500; val_edge_recon_loss: 26589576.0000; val_gene_expr_recon_loss: 283529.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1040864.8750; val_global_loss: 27950120.0000; val_optim_loss: 27950120.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9576; val_auprc_score: 0.9366; val_best_acc_score: 0.9074; val_best_f1_score: 0.9123; train_kl_reg_loss: 37992.2500; train_edge_recon_loss: 26525872.8889; train_gene_expr_recon_loss: 289584.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1063258.6250; train_global_loss: 27916708.0000; train_optim_loss: 27916708.0000; val_kl_reg_loss: 36276.9297; val_edge_recon_loss: 26699564.0000; val_gene_expr_recon_loss: 285340.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1036578.7500; val_global_loss: 28057758.0000; val_optim_loss: 28057758.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9633; val_auprc_score: 0.9464; val_best_acc_score: 0.9169; val_best_f1_score: 0.9209; train_kl_reg_loss: 37159.2218; train_edge_recon_loss: 26410330.0000; train_gene_expr_recon_loss: 285649.5590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052914.7014; train_global_loss: 27786053.3333; train_optim_loss: 27786053.3333; val_kl_reg_loss: 35643.4219; val_edge_recon_loss: 26333418.0000; val_gene_expr_recon_loss: 283387.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1038411.5000; val_global_loss: 27690862.0000; val_optim_loss: 27690862.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9638; val_auprc_score: 0.9496; val_best_acc_score: 0.9150; val_best_f1_score: 0.9185; train_kl_reg_loss: 37576.4457; train_edge_recon_loss: 26413954.4444; train_gene_expr_recon_loss: 287207.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1057083.0000; train_global_loss: 27795820.4444; train_optim_loss: 27795820.4444; val_kl_reg_loss: 35781.9609; val_edge_recon_loss: 26566636.0000; val_gene_expr_recon_loss: 280356.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1034612.3125; val_global_loss: 27917386.0000; val_optim_loss: 27917386.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9637; val_auprc_score: 0.9479; val_best_acc_score: 0.9173; val_best_f1_score: 0.9210; train_kl_reg_loss: 36550.2535; train_edge_recon_loss: 26459521.1111; train_gene_expr_recon_loss: 283999.5868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1054381.9028; train_global_loss: 27834452.8889; train_optim_loss: 27834452.8889; val_kl_reg_loss: 35405.3750; val_edge_recon_loss: 26592148.0000; val_gene_expr_recon_loss: 277097.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1031499.8750; val_global_loss: 27936152.0000; val_optim_loss: 27936152.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9651; val_auprc_score: 0.9504; val_best_acc_score: 0.9185; val_best_f1_score: 0.9220; train_kl_reg_loss: 36506.2613; train_edge_recon_loss: 26273915.1111; train_gene_expr_recon_loss: 281493.5903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1049739.5000; train_global_loss: 27641654.0000; train_optim_loss: 27641654.0000; val_kl_reg_loss: 34657.5938; val_edge_recon_loss: 26462402.0000; val_gene_expr_recon_loss: 279054.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1030675.0000; val_global_loss: 27806788.0000; val_optim_loss: 27806788.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9662; val_auprc_score: 0.9525; val_best_acc_score: 0.9223; val_best_f1_score: 0.9252; train_kl_reg_loss: 36001.5078; train_edge_recon_loss: 26302573.5556; train_gene_expr_recon_loss: 281142.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051167.7361; train_global_loss: 27670885.1111; train_optim_loss: 27670885.1111; val_kl_reg_loss: 34248.2891; val_edge_recon_loss: 26447972.0000; val_gene_expr_recon_loss: 278334.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1030526.4375; val_global_loss: 27791080.0000; val_optim_loss: 27791080.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9670; val_auprc_score: 0.9489; val_best_acc_score: 0.9274; val_best_f1_score: 0.9300; train_kl_reg_loss: 35360.1089; train_edge_recon_loss: 26319636.6667; train_gene_expr_recon_loss: 280604.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046010.8125; train_global_loss: 27681611.5556; train_optim_loss: 27681611.5556; val_kl_reg_loss: 34195.3828; val_edge_recon_loss: 26236240.0000; val_gene_expr_recon_loss: 275536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1029842.8125; val_global_loss: 27575814.0000; val_optim_loss: 27575814.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9658; val_auprc_score: 0.9504; val_best_acc_score: 0.9212; val_best_f1_score: 0.9246; train_kl_reg_loss: 35625.7960; train_edge_recon_loss: 26394632.4444; train_gene_expr_recon_loss: 281284.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051403.8472; train_global_loss: 27762946.8889; train_optim_loss: 27762946.8889; val_kl_reg_loss: 34200.8594; val_edge_recon_loss: 26536288.0000; val_gene_expr_recon_loss: 277526.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1031836.3750; val_global_loss: 27879850.0000; val_optim_loss: 27879850.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9687; val_auprc_score: 0.9541; val_best_acc_score: 0.9236; val_best_f1_score: 0.9265; train_kl_reg_loss: 35148.8168; train_edge_recon_loss: 26421226.6667; train_gene_expr_recon_loss: 280267.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043646.5556; train_global_loss: 27780289.7778; train_optim_loss: 27780289.7778; val_kl_reg_loss: 33946.5234; val_edge_recon_loss: 26470312.0000; val_gene_expr_recon_loss: 276279.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1029640.3750; val_global_loss: 27810176.0000; val_optim_loss: 27810176.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9651; val_auprc_score: 0.9518; val_best_acc_score: 0.9229; val_best_f1_score: 0.9260; train_kl_reg_loss: 35358.5365; train_edge_recon_loss: 26393905.1111; train_gene_expr_recon_loss: 279836.8646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046943.2639; train_global_loss: 27756044.0000; train_optim_loss: 27756044.0000; val_kl_reg_loss: 34116.5586; val_edge_recon_loss: 26469478.0000; val_gene_expr_recon_loss: 276858.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1031588.6250; val_global_loss: 27812040.0000; val_optim_loss: 27812040.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9677; val_auprc_score: 0.9525; val_best_acc_score: 0.9272; val_best_f1_score: 0.9299; train_kl_reg_loss: 35293.1762; train_edge_recon_loss: 26344212.4444; train_gene_expr_recon_loss: 280105.3819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1045640.7639; train_global_loss: 27705251.7778; train_optim_loss: 27705251.7778; val_kl_reg_loss: 34092.4062; val_edge_recon_loss: 26258382.0000; val_gene_expr_recon_loss: 276584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1029639.5625; val_global_loss: 27598698.0000; val_optim_loss: 27598698.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9703; val_auprc_score: 0.9589; val_best_acc_score: 0.9258; val_best_f1_score: 0.9285; train_kl_reg_loss: 35349.2305; train_edge_recon_loss: 26330121.3333; train_gene_expr_recon_loss: 280337.2708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047038.7986; train_global_loss: 27692846.4444; train_optim_loss: 27692846.4444; val_kl_reg_loss: 26282.7773; val_edge_recon_loss: 26392892.0000; val_gene_expr_recon_loss: 277853.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1031710.7500; val_global_loss: 27728738.0000; val_optim_loss: 27728738.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9709; val_auprc_score: 0.9571; val_best_acc_score: 0.9302; val_best_f1_score: 0.9325; train_kl_reg_loss: 35255.3451; train_edge_recon_loss: 26378699.7778; train_gene_expr_recon_loss: 279790.4965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048039.6389; train_global_loss: 27741785.3333; train_optim_loss: 27741785.3333; val_kl_reg_loss: 26144.6914; val_edge_recon_loss: 26280424.0000; val_gene_expr_recon_loss: 277798.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1030636.0000; val_global_loss: 27615002.0000; val_optim_loss: 27615002.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9675; val_auprc_score: 0.9526; val_best_acc_score: 0.9271; val_best_f1_score: 0.9297; train_kl_reg_loss: 35539.6749; train_edge_recon_loss: 26375942.0000; train_gene_expr_recon_loss: 281452.4792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052933.9931; train_global_loss: 27745868.2222; train_optim_loss: 27745868.2222; val_kl_reg_loss: 26272.3281; val_edge_recon_loss: 26511118.0000; val_gene_expr_recon_loss: 278351.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032873.0000; val_global_loss: 27848616.0000; val_optim_loss: 27848616.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9685; val_auprc_score: 0.9517; val_best_acc_score: 0.9254; val_best_f1_score: 0.9285; train_kl_reg_loss: 35281.9957; train_edge_recon_loss: 26338828.2222; train_gene_expr_recon_loss: 282082.6597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051343.1944; train_global_loss: 27707536.0000; train_optim_loss: 27707536.0000; val_kl_reg_loss: 26119.5566; val_edge_recon_loss: 26384100.0000; val_gene_expr_recon_loss: 278526.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1032325.6250; val_global_loss: 27721072.0000; val_optim_loss: 27721072.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 30 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9703
Val AUPRC score: 0.9599
Val best accuracy score: 0.9233
Val best F1 score: 0.9270
Val gene expr MSE score: 1.7689
Val chrom access MSE score: 0.1084
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
