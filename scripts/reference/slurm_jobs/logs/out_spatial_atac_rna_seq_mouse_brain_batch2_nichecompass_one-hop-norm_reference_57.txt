[True]
Run timestamp: 07082023_190408_57.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_57']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8828; val_auprc_score: 0.8928; val_best_acc_score: 0.5053; val_best_f1_score: 0.6690; train_kl_reg_loss: 37186.9662; train_edge_recon_loss: 352847.1007; train_gene_expr_recon_loss: 1172012.1389; train_masked_gp_l1_reg_loss: 4722.9250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166833.3785; train_chrom_access_recon_loss: 2141537.3194; train_global_loss: 3875139.8333; train_optim_loss: 3875139.8333; val_kl_reg_loss: 15751.0742; val_edge_recon_loss: 406531.0938; val_gene_expr_recon_loss: 1001636.6250; val_masked_gp_l1_reg_loss: 4443.3013; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162297.9375; val_chrom_access_recon_loss: 1681435.0000; val_global_loss: 3272095.0000; val_optim_loss: 3272095.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8742; val_auprc_score: 0.8820; val_best_acc_score: 0.5075; val_best_f1_score: 0.6700; train_kl_reg_loss: 14721.1332; train_edge_recon_loss: 357736.3507; train_gene_expr_recon_loss: 903999.9236; train_masked_gp_l1_reg_loss: 4437.0992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159437.0903; train_chrom_access_recon_loss: 1516004.8194; train_global_loss: 2956336.4167; train_optim_loss: 2956336.4167; val_kl_reg_loss: 13107.2773; val_edge_recon_loss: 406515.9688; val_gene_expr_recon_loss: 846248.3750; val_masked_gp_l1_reg_loss: 4502.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155895.1875; val_chrom_access_recon_loss: 1415377.1250; val_global_loss: 2841646.0000; val_optim_loss: 2841646.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8720; val_auprc_score: 0.8819; val_best_acc_score: 0.5071; val_best_f1_score: 0.6699; train_kl_reg_loss: 15312.3142; train_edge_recon_loss: 357989.6736; train_gene_expr_recon_loss: 819418.5000; train_masked_gp_l1_reg_loss: 4643.6991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152972.5312; train_chrom_access_recon_loss: 1403347.1528; train_global_loss: 2753683.8611; train_optim_loss: 2753683.8611; val_kl_reg_loss: 15127.7754; val_edge_recon_loss: 406524.8125; val_gene_expr_recon_loss: 792271.8750; val_masked_gp_l1_reg_loss: 4806.6948; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149149.9688; val_chrom_access_recon_loss: 1382288.3750; val_global_loss: 2750169.5000; val_optim_loss: 2750169.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8702; val_auprc_score: 0.8808; val_best_acc_score: 0.5123; val_best_f1_score: 0.6722; train_kl_reg_loss: 16864.1621; train_edge_recon_loss: 358725.7778; train_gene_expr_recon_loss: 775826.5625; train_masked_gp_l1_reg_loss: 4876.4819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145761.3264; train_chrom_access_recon_loss: 1368667.5417; train_global_loss: 2670721.8056; train_optim_loss: 2670721.8056; val_kl_reg_loss: 17792.6777; val_edge_recon_loss: 406498.5000; val_gene_expr_recon_loss: 763524.0000; val_masked_gp_l1_reg_loss: 4930.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141347.2031; val_chrom_access_recon_loss: 1363315.2500; val_global_loss: 2697408.0000; val_optim_loss: 2697408.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8550; val_auprc_score: 0.8616; val_best_acc_score: 0.5256; val_best_f1_score: 0.6780; train_kl_reg_loss: 19641.3366; train_edge_recon_loss: 359670.4444; train_gene_expr_recon_loss: 749423.7639; train_masked_gp_l1_reg_loss: 4933.1188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137579.4444; train_chrom_access_recon_loss: 1359320.9861; train_global_loss: 2630569.0556; train_optim_loss: 2630569.0556; val_kl_reg_loss: 18483.9570; val_edge_recon_loss: 406411.2500; val_gene_expr_recon_loss: 743039.8750; val_masked_gp_l1_reg_loss: 4917.3574; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132753.9219; val_chrom_access_recon_loss: 1351467.2500; val_global_loss: 2657073.5000; val_optim_loss: 2657073.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8587; val_auprc_score: 0.8639; val_best_acc_score: 0.5407; val_best_f1_score: 0.6837; train_kl_reg_loss: 20290.4464; train_edge_recon_loss: 359688.3368; train_gene_expr_recon_loss: 729795.3819; train_masked_gp_l1_reg_loss: 4898.3773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128811.8160; train_chrom_access_recon_loss: 1345610.2222; train_global_loss: 2589094.5833; train_optim_loss: 2589094.5833; val_kl_reg_loss: 20178.6250; val_edge_recon_loss: 406235.0312; val_gene_expr_recon_loss: 725766.4375; val_masked_gp_l1_reg_loss: 4869.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123884.0000; val_chrom_access_recon_loss: 1342787.5000; val_global_loss: 2623721.0000; val_optim_loss: 2623721.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8560; val_auprc_score: 0.8558; val_best_acc_score: 0.5501; val_best_f1_score: 0.6854; train_kl_reg_loss: 21265.2882; train_edge_recon_loss: 360084.9132; train_gene_expr_recon_loss: 712121.9444; train_masked_gp_l1_reg_loss: 4845.1432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119966.8220; train_chrom_access_recon_loss: 1334704.3889; train_global_loss: 2552988.5556; train_optim_loss: 2552988.5556; val_kl_reg_loss: 21589.4297; val_edge_recon_loss: 405967.9688; val_gene_expr_recon_loss: 711135.0625; val_masked_gp_l1_reg_loss: 4809.9209; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115107.4375; val_chrom_access_recon_loss: 1336051.5000; val_global_loss: 2594661.2500; val_optim_loss: 2594661.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8613; val_auprc_score: 0.8582; val_best_acc_score: 0.5943; val_best_f1_score: 0.7054; train_kl_reg_loss: 22366.3819; train_edge_recon_loss: 359846.5590; train_gene_expr_recon_loss: 702550.5625; train_masked_gp_l1_reg_loss: 4783.1204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111313.8490; train_chrom_access_recon_loss: 1329514.5972; train_global_loss: 2530375.0278; train_optim_loss: 2530375.0278; val_kl_reg_loss: 23112.5742; val_edge_recon_loss: 405472.8125; val_gene_expr_recon_loss: 698479.6250; val_masked_gp_l1_reg_loss: 4746.6885; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106653.5078; val_chrom_access_recon_loss: 1330089.2500; val_global_loss: 2568554.5000; val_optim_loss: 2568554.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8405; val_auprc_score: 0.8400; val_best_acc_score: 0.6452; val_best_f1_score: 0.7291; train_kl_reg_loss: 23250.6296; train_edge_recon_loss: 359816.2153; train_gene_expr_recon_loss: 688869.3681; train_masked_gp_l1_reg_loss: 4729.8872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103077.7205; train_chrom_access_recon_loss: 1330769.5972; train_global_loss: 2510513.4167; train_optim_loss: 2510513.4167; val_kl_reg_loss: 22264.4922; val_edge_recon_loss: 404872.5625; val_gene_expr_recon_loss: 689710.8750; val_masked_gp_l1_reg_loss: 4698.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98706.3906; val_chrom_access_recon_loss: 1325177.2500; val_global_loss: 2545429.5000; val_optim_loss: 2545429.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8227; val_auprc_score: 0.8176; val_best_acc_score: 0.6973; val_best_f1_score: 0.7519; train_kl_reg_loss: 23320.4280; train_edge_recon_loss: 359625.4062; train_gene_expr_recon_loss: 680894.7361; train_masked_gp_l1_reg_loss: 4681.5799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95392.0877; train_chrom_access_recon_loss: 1319048.1528; train_global_loss: 2482962.3333; train_optim_loss: 2482962.3333; val_kl_reg_loss: 22740.3203; val_edge_recon_loss: 403715.0000; val_gene_expr_recon_loss: 683403.3750; val_masked_gp_l1_reg_loss: 4656.7021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91371.1094; val_chrom_access_recon_loss: 1320920.7500; val_global_loss: 2526807.5000; val_optim_loss: 2526807.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8144; val_auprc_score: 0.8121; val_best_acc_score: 0.7241; val_best_f1_score: 0.7547; train_kl_reg_loss: 23701.9885; train_edge_recon_loss: 359231.7951; train_gene_expr_recon_loss: 674463.2083; train_masked_gp_l1_reg_loss: 4645.6286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88365.1719; train_chrom_access_recon_loss: 1319033.1528; train_global_loss: 2469440.9444; train_optim_loss: 2469440.9444; val_kl_reg_loss: 23942.7109; val_edge_recon_loss: 402542.6875; val_gene_expr_recon_loss: 678562.0000; val_masked_gp_l1_reg_loss: 4624.8374; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84728.4688; val_chrom_access_recon_loss: 1317430.7500; val_global_loss: 2511831.5000; val_optim_loss: 2511831.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8202; val_auprc_score: 0.8195; val_best_acc_score: 0.7339; val_best_f1_score: 0.7358; train_kl_reg_loss: 23705.3852; train_edge_recon_loss: 358555.7465; train_gene_expr_recon_loss: 672805.0278; train_masked_gp_l1_reg_loss: 4619.1963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82031.1207; train_chrom_access_recon_loss: 1315075.5833; train_global_loss: 2456792.0556; train_optim_loss: 2456792.0556; val_kl_reg_loss: 22534.8770; val_edge_recon_loss: 400563.1250; val_gene_expr_recon_loss: 674670.1875; val_masked_gp_l1_reg_loss: 4605.3486; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78774.1484; val_chrom_access_recon_loss: 1313879.6250; val_global_loss: 2495027.5000; val_optim_loss: 2495027.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8238; val_auprc_score: 0.8223; val_best_acc_score: 0.7290; val_best_f1_score: 0.7491; train_kl_reg_loss: 23421.3205; train_edge_recon_loss: 357749.4896; train_gene_expr_recon_loss: 666578.9792; train_masked_gp_l1_reg_loss: 4601.1960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76355.6571; train_chrom_access_recon_loss: 1308846.4028; train_global_loss: 2437553.0556; train_optim_loss: 2437553.0556; val_kl_reg_loss: 21293.1992; val_edge_recon_loss: 397677.9062; val_gene_expr_recon_loss: 672350.1250; val_masked_gp_l1_reg_loss: 4591.0869; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73427.8750; val_chrom_access_recon_loss: 1311070.2500; val_global_loss: 2480410.5000; val_optim_loss: 2480410.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8247; val_auprc_score: 0.8212; val_best_acc_score: 0.7150; val_best_f1_score: 0.7593; train_kl_reg_loss: 23014.6393; train_edge_recon_loss: 356955.4861; train_gene_expr_recon_loss: 665451.9861; train_masked_gp_l1_reg_loss: 4593.9032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71248.7049; train_chrom_access_recon_loss: 1307975.4306; train_global_loss: 2429240.1667; train_optim_loss: 2429240.1667; val_kl_reg_loss: 20866.1133; val_edge_recon_loss: 394517.4375; val_gene_expr_recon_loss: 670102.8750; val_masked_gp_l1_reg_loss: 4587.1387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68599.2344; val_chrom_access_recon_loss: 1308321.0000; val_global_loss: 2466994.0000; val_optim_loss: 2466994.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8326; val_auprc_score: 0.8275; val_best_acc_score: 0.7409; val_best_f1_score: 0.7667; train_kl_reg_loss: 22609.6625; train_edge_recon_loss: 355717.8958; train_gene_expr_recon_loss: 659622.6319; train_masked_gp_l1_reg_loss: 4589.3292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66623.3516; train_chrom_access_recon_loss: 1305003.9167; train_global_loss: 2414166.7778; train_optim_loss: 2414166.7778; val_kl_reg_loss: 20819.5547; val_edge_recon_loss: 390160.0000; val_gene_expr_recon_loss: 667548.3750; val_masked_gp_l1_reg_loss: 4583.7715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64215.2695; val_chrom_access_recon_loss: 1305776.3750; val_global_loss: 2453103.5000; val_optim_loss: 2453103.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8330; val_auprc_score: 0.8278; val_best_acc_score: 0.7448; val_best_f1_score: 0.7624; train_kl_reg_loss: 22223.0790; train_edge_recon_loss: 354069.6840; train_gene_expr_recon_loss: 657032.2083; train_masked_gp_l1_reg_loss: 4588.6943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62417.1797; train_chrom_access_recon_loss: 1305300.2361; train_global_loss: 2405631.0833; train_optim_loss: 2405631.0833; val_kl_reg_loss: 20176.9609; val_edge_recon_loss: 384104.9062; val_gene_expr_recon_loss: 666457.5000; val_masked_gp_l1_reg_loss: 4586.8267; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60229.2930; val_chrom_access_recon_loss: 1303744.3750; val_global_loss: 2439300.0000; val_optim_loss: 2439300.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8509; val_auprc_score: 0.8468; val_best_acc_score: 0.7631; val_best_f1_score: 0.7783; train_kl_reg_loss: 21571.8563; train_edge_recon_loss: 351433.9097; train_gene_expr_recon_loss: 657866.1111; train_masked_gp_l1_reg_loss: 4596.3589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58601.1285; train_chrom_access_recon_loss: 1297811.8056; train_global_loss: 2391881.1389; train_optim_loss: 2391881.1389; val_kl_reg_loss: 19696.6406; val_edge_recon_loss: 374719.4062; val_gene_expr_recon_loss: 665448.1875; val_masked_gp_l1_reg_loss: 4600.8491; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56613.7422; val_chrom_access_recon_loss: 1302207.0000; val_global_loss: 2423286.0000; val_optim_loss: 2423286.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8599; val_auprc_score: 0.8543; val_best_acc_score: 0.7741; val_best_f1_score: 0.7880; train_kl_reg_loss: 21350.5727; train_edge_recon_loss: 347284.7292; train_gene_expr_recon_loss: 654448.7569; train_masked_gp_l1_reg_loss: 4615.0060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55133.6732; train_chrom_access_recon_loss: 1297896.4444; train_global_loss: 2380729.1389; train_optim_loss: 2380729.1389; val_kl_reg_loss: 20210.1875; val_edge_recon_loss: 360923.2500; val_gene_expr_recon_loss: 664363.0625; val_masked_gp_l1_reg_loss: 4621.8442; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53314.7695; val_chrom_access_recon_loss: 1300377.1250; val_global_loss: 2403810.2500; val_optim_loss: 2403810.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8713; val_auprc_score: 0.8613; val_best_acc_score: 0.7824; val_best_f1_score: 0.7999; train_kl_reg_loss: 21734.6599; train_edge_recon_loss: 338485.6562; train_gene_expr_recon_loss: 654153.0556; train_masked_gp_l1_reg_loss: 4637.5035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51951.1649; train_chrom_access_recon_loss: 1292436.1389; train_global_loss: 2363398.1667; train_optim_loss: 2363398.1667; val_kl_reg_loss: 22211.2773; val_edge_recon_loss: 340380.5938; val_gene_expr_recon_loss: 663786.9375; val_masked_gp_l1_reg_loss: 4649.2764; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50285.2148; val_chrom_access_recon_loss: 1299046.0000; val_global_loss: 2380359.2500; val_optim_loss: 2380359.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8694; val_auprc_score: 0.8564; val_best_acc_score: 0.7781; val_best_f1_score: 0.8020; train_kl_reg_loss: 25607.5059; train_edge_recon_loss: 325130.0903; train_gene_expr_recon_loss: 654815.4306; train_masked_gp_l1_reg_loss: 4669.4529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49039.4227; train_chrom_access_recon_loss: 1288256.0278; train_global_loss: 2347517.8611; train_optim_loss: 2347517.8611; val_kl_reg_loss: 29150.2363; val_edge_recon_loss: 324057.0312; val_gene_expr_recon_loss: 662335.3750; val_masked_gp_l1_reg_loss: 4689.8457; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47515.1953; val_chrom_access_recon_loss: 1296807.3750; val_global_loss: 2364555.0000; val_optim_loss: 2364555.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8806; val_auprc_score: 0.8615; val_best_acc_score: 0.7935; val_best_f1_score: 0.8139; train_kl_reg_loss: 31509.1730; train_edge_recon_loss: 314749.2847; train_gene_expr_recon_loss: 653448.4792; train_masked_gp_l1_reg_loss: 4708.3113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46377.8915; train_chrom_access_recon_loss: 1290682.4028; train_global_loss: 2341475.5000; train_optim_loss: 2341475.5000; val_kl_reg_loss: 30786.5312; val_edge_recon_loss: 314788.0000; val_gene_expr_recon_loss: 660788.2500; val_masked_gp_l1_reg_loss: 4724.0522; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44980.0078; val_chrom_access_recon_loss: 1294426.8750; val_global_loss: 2350493.7500; val_optim_loss: 2350493.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9037; val_auprc_score: 0.8911; val_best_acc_score: 0.8186; val_best_f1_score: 0.8314; train_kl_reg_loss: 30656.8292; train_edge_recon_loss: 311479.9375; train_gene_expr_recon_loss: 651892.7778; train_masked_gp_l1_reg_loss: 4744.2524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43943.1445; train_chrom_access_recon_loss: 1288095.8750; train_global_loss: 2330812.8056; train_optim_loss: 2330812.8056; val_kl_reg_loss: 28706.3887; val_edge_recon_loss: 311972.8125; val_gene_expr_recon_loss: 659974.2500; val_masked_gp_l1_reg_loss: 4756.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42662.7812; val_chrom_access_recon_loss: 1292268.5000; val_global_loss: 2340341.5000; val_optim_loss: 2340341.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9148; val_auprc_score: 0.8999; val_best_acc_score: 0.8382; val_best_f1_score: 0.8455; train_kl_reg_loss: 29318.9655; train_edge_recon_loss: 308536.2569; train_gene_expr_recon_loss: 649840.8958; train_masked_gp_l1_reg_loss: 4772.8293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41705.1541; train_chrom_access_recon_loss: 1288561.8611; train_global_loss: 2322736.0000; train_optim_loss: 2322736.0000; val_kl_reg_loss: 29165.9902; val_edge_recon_loss: 308315.7812; val_gene_expr_recon_loss: 658167.5000; val_masked_gp_l1_reg_loss: 4790.7290; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40525.4648; val_chrom_access_recon_loss: 1290572.7500; val_global_loss: 2331538.2500; val_optim_loss: 2331538.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9212; val_auprc_score: 0.9057; val_best_acc_score: 0.8482; val_best_f1_score: 0.8561; train_kl_reg_loss: 29843.4201; train_edge_recon_loss: 304447.8403; train_gene_expr_recon_loss: 650980.2083; train_masked_gp_l1_reg_loss: 4811.5732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39639.0243; train_chrom_access_recon_loss: 1289005.2500; train_global_loss: 2318727.2778; train_optim_loss: 2318727.2778; val_kl_reg_loss: 29379.7383; val_edge_recon_loss: 306067.9062; val_gene_expr_recon_loss: 656505.0625; val_masked_gp_l1_reg_loss: 4826.7959; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38551.5938; val_chrom_access_recon_loss: 1287980.6250; val_global_loss: 2323311.7500; val_optim_loss: 2323311.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9323; val_auprc_score: 0.9153; val_best_acc_score: 0.8634; val_best_f1_score: 0.8705; train_kl_reg_loss: 30105.0586; train_edge_recon_loss: 302486.6146; train_gene_expr_recon_loss: 653047.3542; train_masked_gp_l1_reg_loss: 4846.9052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37734.7569; train_chrom_access_recon_loss: 1291451.7083; train_global_loss: 2319672.3611; train_optim_loss: 2319672.3611; val_kl_reg_loss: 29267.6367; val_edge_recon_loss: 300431.4062; val_gene_expr_recon_loss: 655695.2500; val_masked_gp_l1_reg_loss: 4861.8760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36724.5469; val_chrom_access_recon_loss: 1286048.2500; val_global_loss: 2313029.0000; val_optim_loss: 2313029.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9325; val_auprc_score: 0.9152; val_best_acc_score: 0.8643; val_best_f1_score: 0.8717; train_kl_reg_loss: 27798.4188; train_edge_recon_loss: 303534.7500; train_gene_expr_recon_loss: 970994.0417; train_masked_gp_l1_reg_loss: 4934.7970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35745.1658; train_chrom_access_recon_loss: 1357474.8472; train_global_loss: 2700482.0000; train_optim_loss: 2700482.0000; val_kl_reg_loss: 19752.3125; val_edge_recon_loss: 301411.3750; val_gene_expr_recon_loss: 975259.2500; val_masked_gp_l1_reg_loss: 5065.8052; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34396.7539; val_chrom_access_recon_loss: 1355022.7500; val_global_loss: 2690908.2500; val_optim_loss: 2690908.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9377; val_auprc_score: 0.9236; val_best_acc_score: 0.8705; val_best_f1_score: 0.8749; train_kl_reg_loss: 26944.3351; train_edge_recon_loss: 300004.0694; train_gene_expr_recon_loss: 964473.6458; train_masked_gp_l1_reg_loss: 5186.9955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33270.7198; train_chrom_access_recon_loss: 1352711.6944; train_global_loss: 2682591.4444; train_optim_loss: 2682591.4444; val_kl_reg_loss: 20658.5625; val_edge_recon_loss: 298779.3438; val_gene_expr_recon_loss: 970701.5000; val_masked_gp_l1_reg_loss: 5324.7715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31887.8125; val_chrom_access_recon_loss: 1353211.2500; val_global_loss: 2680563.2500; val_optim_loss: 2680563.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9390; val_auprc_score: 0.9229; val_best_acc_score: 0.8725; val_best_f1_score: 0.8781; train_kl_reg_loss: 26085.2826; train_edge_recon_loss: 297831.4722; train_gene_expr_recon_loss: 959630.2431; train_masked_gp_l1_reg_loss: 5424.1989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30849.6497; train_chrom_access_recon_loss: 1352885.7778; train_global_loss: 2672706.6667; train_optim_loss: 2672706.6667; val_kl_reg_loss: 21648.8848; val_edge_recon_loss: 296235.8125; val_gene_expr_recon_loss: 964429.5625; val_masked_gp_l1_reg_loss: 5535.4272; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29599.6387; val_chrom_access_recon_loss: 1350703.3750; val_global_loss: 2668152.5000; val_optim_loss: 2668152.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9385; val_auprc_score: 0.9227; val_best_acc_score: 0.8720; val_best_f1_score: 0.8769; train_kl_reg_loss: 26005.2706; train_edge_recon_loss: 294888.4132; train_gene_expr_recon_loss: 953990.0347; train_masked_gp_l1_reg_loss: 5613.6584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28682.1994; train_chrom_access_recon_loss: 1344568.4167; train_global_loss: 2653747.9167; train_optim_loss: 2653747.9167; val_kl_reg_loss: 22989.8906; val_edge_recon_loss: 297417.5312; val_gene_expr_recon_loss: 959294.0000; val_masked_gp_l1_reg_loss: 5701.3809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27579.3320; val_chrom_access_recon_loss: 1348961.7500; val_global_loss: 2661944.0000; val_optim_loss: 2661944.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9424; val_auprc_score: 0.9287; val_best_acc_score: 0.8746; val_best_f1_score: 0.8823; train_kl_reg_loss: 26029.6083; train_edge_recon_loss: 294609.6458; train_gene_expr_recon_loss: 951381.0486; train_masked_gp_l1_reg_loss: 5697.2432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27406.5234; train_chrom_access_recon_loss: 1355150.7083; train_global_loss: 2660274.7500; train_optim_loss: 2660274.7500; val_kl_reg_loss: 23427.9766; val_edge_recon_loss: 296043.4375; val_gene_expr_recon_loss: 959200.4375; val_masked_gp_l1_reg_loss: 5692.6665; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27213.4766; val_chrom_access_recon_loss: 1348766.2500; val_global_loss: 2660344.2500; val_optim_loss: 2660344.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9352; val_auprc_score: 0.9146; val_best_acc_score: 0.8708; val_best_f1_score: 0.8769; train_kl_reg_loss: 26086.0783; train_edge_recon_loss: 294011.4549; train_gene_expr_recon_loss: 942314.4931; train_masked_gp_l1_reg_loss: 5693.1475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27096.6155; train_chrom_access_recon_loss: 1339720.5417; train_global_loss: 2634922.3056; train_optim_loss: 2634922.3056; val_kl_reg_loss: 23192.5469; val_edge_recon_loss: 296665.6562; val_gene_expr_recon_loss: 958623.8750; val_masked_gp_l1_reg_loss: 5693.2251; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26946.4102; val_chrom_access_recon_loss: 1348716.6250; val_global_loss: 2659838.2500; val_optim_loss: 2659838.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9397; val_auprc_score: 0.9239; val_best_acc_score: 0.8723; val_best_f1_score: 0.8800; train_kl_reg_loss: 25823.4887; train_edge_recon_loss: 294317.0764; train_gene_expr_recon_loss: 941845.5139; train_masked_gp_l1_reg_loss: 5694.5378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26838.4084; train_chrom_access_recon_loss: 1341321.8750; train_global_loss: 2635840.8611; train_optim_loss: 2635840.8611; val_kl_reg_loss: 23081.8789; val_edge_recon_loss: 296443.3125; val_gene_expr_recon_loss: 958478.6250; val_masked_gp_l1_reg_loss: 5696.4170; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26706.9238; val_chrom_access_recon_loss: 1348425.1250; val_global_loss: 2658832.0000; val_optim_loss: 2658832.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9432; val_auprc_score: 0.9287; val_best_acc_score: 0.8778; val_best_f1_score: 0.8833; train_kl_reg_loss: 25701.3913; train_edge_recon_loss: 294608.5590; train_gene_expr_recon_loss: 944791.9792; train_masked_gp_l1_reg_loss: 5698.5782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26607.4937; train_chrom_access_recon_loss: 1344553.8889; train_global_loss: 2641961.8056; train_optim_loss: 2641961.8056; val_kl_reg_loss: 22979.9316; val_edge_recon_loss: 294958.1562; val_gene_expr_recon_loss: 958125.1875; val_masked_gp_l1_reg_loss: 5701.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26488.9844; val_chrom_access_recon_loss: 1348378.6250; val_global_loss: 2656632.5000; val_optim_loss: 2656632.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9279
val AUPRC score: 0.9107
val best accuracy score: 0.8599
val best F1 score: 0.8652
val target rna MSE score: 4.0175
val source rna MSE score: 3.2334
val target atac MSE score: 0.1351
val source atac MSE score: 0.0194
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
