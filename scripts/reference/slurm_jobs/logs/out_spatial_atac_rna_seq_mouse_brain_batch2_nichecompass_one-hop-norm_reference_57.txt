[True]
Run timestamp: 29072023_112337_57.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_57']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8748; val_auprc_score: 0.8962; val_best_acc_score: 0.5152; val_best_f1_score: 0.6730; train_kl_reg_loss: 4728.8049; train_edge_recon_loss: 3468813.6111; train_gene_expr_recon_loss: 843465.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1827788.6111; train_global_loss: 6144796.9444; train_optim_loss: 6144796.9444; val_kl_reg_loss: 3899.9053; val_edge_recon_loss: 4062472.2500; val_gene_expr_recon_loss: 748292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1809705.8750; val_global_loss: 6624370.0000; val_optim_loss: 6624370.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8955; val_auprc_score: 0.9097; val_best_acc_score: 0.5551; val_best_f1_score: 0.6903; train_kl_reg_loss: 1928.7009; train_edge_recon_loss: 3467381.3056; train_gene_expr_recon_loss: 758400.2986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1769022.5139; train_global_loss: 5996732.9444; train_optim_loss: 5996732.9444; val_kl_reg_loss: 553.7369; val_edge_recon_loss: 4060811.0000; val_gene_expr_recon_loss: 770345.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1725181.5000; val_global_loss: 6556891.5000; val_optim_loss: 6556891.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9109; val_auprc_score: 0.9185; val_best_acc_score: 0.5201; val_best_f1_score: 0.6754; train_kl_reg_loss: 971.4627; train_edge_recon_loss: 3469292.6667; train_gene_expr_recon_loss: 763638.1319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1730611.2917; train_global_loss: 5964513.5000; train_optim_loss: 5964513.5000; val_kl_reg_loss: 1811.6614; val_edge_recon_loss: 4063430.2500; val_gene_expr_recon_loss: 740468.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1711994.5000; val_global_loss: 6517704.5000; val_optim_loss: 6517704.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9192; val_auprc_score: 0.9305; val_best_acc_score: 0.5150; val_best_f1_score: 0.6731; train_kl_reg_loss: 4543.4673; train_edge_recon_loss: 3473546.3056; train_gene_expr_recon_loss: 723434.2569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1723344.3889; train_global_loss: 5924868.4444; train_optim_loss: 5924868.4444; val_kl_reg_loss: 7514.4722; val_edge_recon_loss: 4063850.2500; val_gene_expr_recon_loss: 696609.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1707983.7500; val_global_loss: 6475958.0000; val_optim_loss: 6475958.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9161; val_auprc_score: 0.9270; val_best_acc_score: 0.5185; val_best_f1_score: 0.6747; train_kl_reg_loss: 8340.9871; train_edge_recon_loss: 3474202.8611; train_gene_expr_recon_loss: 686196.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1711224.3889; train_global_loss: 5879964.5000; train_optim_loss: 5879964.5000; val_kl_reg_loss: 10519.3740; val_edge_recon_loss: 4063903.0000; val_gene_expr_recon_loss: 664946.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1692038.6250; val_global_loss: 6431407.5000; val_optim_loss: 6431407.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9150; val_auprc_score: 0.9198; val_best_acc_score: 0.5310; val_best_f1_score: 0.6803; train_kl_reg_loss: 13711.2247; train_edge_recon_loss: 3476800.8333; train_gene_expr_recon_loss: 653603.5903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1700138.8611; train_global_loss: 5844254.3889; train_optim_loss: 5844254.3889; val_kl_reg_loss: 11959.8184; val_edge_recon_loss: 4063171.2500; val_gene_expr_recon_loss: 633924.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1671916.2500; val_global_loss: 6380972.0000; val_optim_loss: 6380972.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9150; val_auprc_score: 0.9197; val_best_acc_score: 0.5489; val_best_f1_score: 0.6884; train_kl_reg_loss: 14562.0725; train_edge_recon_loss: 3478126.0000; train_gene_expr_recon_loss: 616218.7986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1687157.3472; train_global_loss: 5796064.2222; train_optim_loss: 5796064.2222; val_kl_reg_loss: 14917.9297; val_edge_recon_loss: 4062236.0000; val_gene_expr_recon_loss: 590810.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1658856.8750; val_global_loss: 6326821.5000; val_optim_loss: 6326821.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9078; val_auprc_score: 0.9141; val_best_acc_score: 0.5938; val_best_f1_score: 0.7094; train_kl_reg_loss: 17223.7982; train_edge_recon_loss: 3478423.6389; train_gene_expr_recon_loss: 575678.2153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1660070.8472; train_global_loss: 5731396.4444; train_optim_loss: 5731396.4444; val_kl_reg_loss: 14076.1797; val_edge_recon_loss: 4060088.0000; val_gene_expr_recon_loss: 555907.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1644590.5000; val_global_loss: 6274662.0000; val_optim_loss: 6274662.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8903; val_auprc_score: 0.8928; val_best_acc_score: 0.6559; val_best_f1_score: 0.7404; train_kl_reg_loss: 17477.2095; train_edge_recon_loss: 3479501.7778; train_gene_expr_recon_loss: 538154.5764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1648130.5000; train_global_loss: 5683264.1667; train_optim_loss: 5683264.1667; val_kl_reg_loss: 12837.8008; val_edge_recon_loss: 4056264.5000; val_gene_expr_recon_loss: 523923.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1626169.0000; val_global_loss: 6219194.5000; val_optim_loss: 6219194.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8745; val_auprc_score: 0.8723; val_best_acc_score: 0.7087; val_best_f1_score: 0.7682; train_kl_reg_loss: 18153.9406; train_edge_recon_loss: 3478674.1111; train_gene_expr_recon_loss: 502092.7118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1620587.1806; train_global_loss: 5619508.1111; train_optim_loss: 5619508.1111; val_kl_reg_loss: 15660.9678; val_edge_recon_loss: 4050244.7500; val_gene_expr_recon_loss: 490323.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1611871.2500; val_global_loss: 6168100.0000; val_optim_loss: 6168100.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8662; val_auprc_score: 0.8603; val_best_acc_score: 0.7782; val_best_f1_score: 0.8011; train_kl_reg_loss: 19584.0219; train_edge_recon_loss: 3478585.3889; train_gene_expr_recon_loss: 475041.5729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1608505.0278; train_global_loss: 5581716.1111; train_optim_loss: 5581716.1111; val_kl_reg_loss: 18071.6797; val_edge_recon_loss: 4027942.0000; val_gene_expr_recon_loss: 462747.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1597265.0000; val_global_loss: 6106026.0000; val_optim_loss: 6106026.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8548; val_auprc_score: 0.8418; val_best_acc_score: 0.7548; val_best_f1_score: 0.7928; train_kl_reg_loss: 18876.8631; train_edge_recon_loss: 3473953.0833; train_gene_expr_recon_loss: 453196.1042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1607199.0556; train_global_loss: 5553225.0556; train_optim_loss: 5553225.0556; val_kl_reg_loss: 13407.5566; val_edge_recon_loss: 3925090.2500; val_gene_expr_recon_loss: 450155.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1579677.7500; val_global_loss: 5968331.0000; val_optim_loss: 5968331.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8520; val_auprc_score: 0.8375; val_best_acc_score: 0.7650; val_best_f1_score: 0.7873; train_kl_reg_loss: 13034.4247; train_edge_recon_loss: 3423839.6111; train_gene_expr_recon_loss: 444968.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1593627.8750; train_global_loss: 5475471.0000; train_optim_loss: 5475471.0000; val_kl_reg_loss: 7168.3301; val_edge_recon_loss: 3350730.2500; val_gene_expr_recon_loss: 451622.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1584149.0000; val_global_loss: 5393670.5000; val_optim_loss: 5393670.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8446; val_auprc_score: 0.8377; val_best_acc_score: 0.7471; val_best_f1_score: 0.7765; train_kl_reg_loss: 11330.5215; train_edge_recon_loss: 3075447.4167; train_gene_expr_recon_loss: 460046.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1610553.8889; train_global_loss: 5157378.4444; train_optim_loss: 5157378.4444; val_kl_reg_loss: 22108.1504; val_edge_recon_loss: 2951447.7500; val_gene_expr_recon_loss: 457571.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1602623.5000; val_global_loss: 5033751.0000; val_optim_loss: 5033751.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8522; val_auprc_score: 0.8373; val_best_acc_score: 0.7538; val_best_f1_score: 0.7819; train_kl_reg_loss: 34530.7786; train_edge_recon_loss: 2902935.1111; train_gene_expr_recon_loss: 447463.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1599844.3889; train_global_loss: 4984774.2222; train_optim_loss: 4984774.2222; val_kl_reg_loss: 42991.3633; val_edge_recon_loss: 2932029.2500; val_gene_expr_recon_loss: 438357.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1583635.7500; val_global_loss: 4997014.0000; val_optim_loss: 4997014.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8743; val_auprc_score: 0.8611; val_best_acc_score: 0.7736; val_best_f1_score: 0.7962; train_kl_reg_loss: 47478.7209; train_edge_recon_loss: 2880004.8611; train_gene_expr_recon_loss: 435808.0243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1597898.6389; train_global_loss: 4961190.3333; train_optim_loss: 4961190.3333; val_kl_reg_loss: 44259.8320; val_edge_recon_loss: 2856141.2500; val_gene_expr_recon_loss: 431022.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1576628.3750; val_global_loss: 4908051.5000; val_optim_loss: 4908051.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8778; val_auprc_score: 0.8590; val_best_acc_score: 0.7793; val_best_f1_score: 0.8070; train_kl_reg_loss: 41722.7461; train_edge_recon_loss: 2853257.2500; train_gene_expr_recon_loss: 428790.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1584922.4583; train_global_loss: 4908692.5000; train_optim_loss: 4908692.5000; val_kl_reg_loss: 34992.1328; val_edge_recon_loss: 2835921.2500; val_gene_expr_recon_loss: 429115.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1578168.7500; val_global_loss: 4878198.0000; val_optim_loss: 4878198.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8793; val_auprc_score: 0.8524; val_best_acc_score: 0.7955; val_best_f1_score: 0.8189; train_kl_reg_loss: 33293.6061; train_edge_recon_loss: 2823500.5833; train_gene_expr_recon_loss: 425709.2257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1579470.0139; train_global_loss: 4861973.3333; train_optim_loss: 4861973.3333; val_kl_reg_loss: 29364.4805; val_edge_recon_loss: 2810984.5000; val_gene_expr_recon_loss: 425786.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1571631.5000; val_global_loss: 4837766.5000; val_optim_loss: 4837766.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9005; val_auprc_score: 0.8718; val_best_acc_score: 0.8304; val_best_f1_score: 0.8435; train_kl_reg_loss: 29852.8778; train_edge_recon_loss: 2797536.2222; train_gene_expr_recon_loss: 424692.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1572462.6667; train_global_loss: 4824543.8889; train_optim_loss: 4824543.8889; val_kl_reg_loss: 28089.6328; val_edge_recon_loss: 2784900.2500; val_gene_expr_recon_loss: 425882.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1571094.3750; val_global_loss: 4809967.0000; val_optim_loss: 4809967.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9110; val_auprc_score: 0.8797; val_best_acc_score: 0.8541; val_best_f1_score: 0.8638; train_kl_reg_loss: 29475.6191; train_edge_recon_loss: 2762360.4444; train_gene_expr_recon_loss: 423004.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1576862.7778; train_global_loss: 4791703.1111; train_optim_loss: 4791703.1111; val_kl_reg_loss: 27985.0938; val_edge_recon_loss: 2757344.5000; val_gene_expr_recon_loss: 423723.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1563564.2500; val_global_loss: 4772617.5000; val_optim_loss: 4772617.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9192; val_auprc_score: 0.8912; val_best_acc_score: 0.8614; val_best_f1_score: 0.8695; train_kl_reg_loss: 31164.8661; train_edge_recon_loss: 2734530.7222; train_gene_expr_recon_loss: 422048.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1576898.2639; train_global_loss: 4764642.5000; train_optim_loss: 4764642.5000; val_kl_reg_loss: 31971.4688; val_edge_recon_loss: 2754101.5000; val_gene_expr_recon_loss: 418362.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1560081.5000; val_global_loss: 4764517.0000; val_optim_loss: 4764517.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9245; val_auprc_score: 0.9010; val_best_acc_score: 0.8661; val_best_f1_score: 0.8760; train_kl_reg_loss: 36149.7730; train_edge_recon_loss: 2728437.3056; train_gene_expr_recon_loss: 415541.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1570338.6944; train_global_loss: 4750466.7778; train_optim_loss: 4750466.7778; val_kl_reg_loss: 35547.7539; val_edge_recon_loss: 2751025.7500; val_gene_expr_recon_loss: 414991.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1559230.3750; val_global_loss: 4760795.0000; val_optim_loss: 4760795.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9300; val_auprc_score: 0.9060; val_best_acc_score: 0.8724; val_best_f1_score: 0.8802; train_kl_reg_loss: 37955.7982; train_edge_recon_loss: 2726796.1667; train_gene_expr_recon_loss: 413118.8299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1567045.0278; train_global_loss: 4744915.7222; train_optim_loss: 4744915.7222; val_kl_reg_loss: 35207.7617; val_edge_recon_loss: 2721922.5000; val_gene_expr_recon_loss: 413769.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1553788.2500; val_global_loss: 4724688.0000; val_optim_loss: 4724688.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9264; val_auprc_score: 0.9016; val_best_acc_score: 0.8719; val_best_f1_score: 0.8797; train_kl_reg_loss: 36856.1576; train_edge_recon_loss: 2724634.7500; train_gene_expr_recon_loss: 410781.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1554070.3750; train_global_loss: 4726342.3889; train_optim_loss: 4726342.3889; val_kl_reg_loss: 34595.9023; val_edge_recon_loss: 2735554.0000; val_gene_expr_recon_loss: 409914.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1552730.3750; val_global_loss: 4732794.5000; val_optim_loss: 4732794.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9332; val_auprc_score: 0.9104; val_best_acc_score: 0.8746; val_best_f1_score: 0.8835; train_kl_reg_loss: 36344.3997; train_edge_recon_loss: 2721319.0000; train_gene_expr_recon_loss: 407430.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1558503.5278; train_global_loss: 4723597.5000; train_optim_loss: 4723597.5000; val_kl_reg_loss: 33881.7734; val_edge_recon_loss: 2744208.2500; val_gene_expr_recon_loss: 408989.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1549331.5000; val_global_loss: 4736411.0000; val_optim_loss: 4736411.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9302; val_auprc_score: 0.9065; val_best_acc_score: 0.8715; val_best_f1_score: 0.8803; train_kl_reg_loss: 35876.7079; train_edge_recon_loss: 2716917.1111; train_gene_expr_recon_loss: 408396.7882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1552213.5417; train_global_loss: 4713404.1111; train_optim_loss: 4713404.1111; val_kl_reg_loss: 28421.5840; val_edge_recon_loss: 2763573.5000; val_gene_expr_recon_loss: 407988.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1550213.6250; val_global_loss: 4750197.5000; val_optim_loss: 4750197.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9391; val_auprc_score: 0.9204; val_best_acc_score: 0.8801; val_best_f1_score: 0.8877; train_kl_reg_loss: 37722.5534; train_edge_recon_loss: 2727430.1667; train_gene_expr_recon_loss: 405670.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1549322.1667; train_global_loss: 4720145.5000; train_optim_loss: 4720145.5000; val_kl_reg_loss: 28018.6797; val_edge_recon_loss: 2715513.5000; val_gene_expr_recon_loss: 409225.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1553007.0000; val_global_loss: 4705765.0000; val_optim_loss: 4705765.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9356; val_auprc_score: 0.9105; val_best_acc_score: 0.8747; val_best_f1_score: 0.8840; train_kl_reg_loss: 35510.0126; train_edge_recon_loss: 2729381.2778; train_gene_expr_recon_loss: 406187.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1557259.7778; train_global_loss: 4728338.8333; train_optim_loss: 4728338.8333; val_kl_reg_loss: 26108.9258; val_edge_recon_loss: 2739322.0000; val_gene_expr_recon_loss: 407475.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1548966.0000; val_global_loss: 4721872.5000; val_optim_loss: 4721872.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9426; val_auprc_score: 0.9249; val_best_acc_score: 0.8801; val_best_f1_score: 0.8889; train_kl_reg_loss: 34203.5933; train_edge_recon_loss: 2713418.7222; train_gene_expr_recon_loss: 406203.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1561277.0278; train_global_loss: 4715102.7222; train_optim_loss: 4715102.7222; val_kl_reg_loss: 25668.1328; val_edge_recon_loss: 2731361.7500; val_gene_expr_recon_loss: 406798.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1547020.2500; val_global_loss: 4710849.0000; val_optim_loss: 4710849.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9378; val_auprc_score: 0.9135; val_best_acc_score: 0.8793; val_best_f1_score: 0.8860; train_kl_reg_loss: 34357.9479; train_edge_recon_loss: 2711501.5556; train_gene_expr_recon_loss: 407663.0069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1558888.1250; train_global_loss: 4712410.6667; train_optim_loss: 4712410.6667; val_kl_reg_loss: 25613.6055; val_edge_recon_loss: 2736404.0000; val_gene_expr_recon_loss: 406105.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1544276.5000; val_global_loss: 4712399.0000; val_optim_loss: 4712399.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9438; val_auprc_score: 0.9236; val_best_acc_score: 0.8847; val_best_f1_score: 0.8916; train_kl_reg_loss: 33595.1806; train_edge_recon_loss: 2714638.6111; train_gene_expr_recon_loss: 406118.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1552833.4722; train_global_loss: 4707186.0556; train_optim_loss: 4707186.0556; val_kl_reg_loss: 24669.5625; val_edge_recon_loss: 2707742.7500; val_gene_expr_recon_loss: 404350.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1543053.3750; val_global_loss: 4679816.5000; val_optim_loss: 4679816.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9505; val_auprc_score: 0.9338; val_best_acc_score: 0.8905; val_best_f1_score: 0.8952; train_kl_reg_loss: 31202.9668; train_edge_recon_loss: 2728299.1944; train_gene_expr_recon_loss: 402648.4757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1555911.0417; train_global_loss: 4718061.7222; train_optim_loss: 4718061.7222; val_kl_reg_loss: 23635.4336; val_edge_recon_loss: 2718240.0000; val_gene_expr_recon_loss: 403389.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1539442.6250; val_global_loss: 4684708.0000; val_optim_loss: 4684708.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9471; val_auprc_score: 0.9247; val_best_acc_score: 0.8905; val_best_f1_score: 0.8964; train_kl_reg_loss: 31127.6510; train_edge_recon_loss: 2710783.6111; train_gene_expr_recon_loss: 401037.5174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1548282.6944; train_global_loss: 4691231.5000; train_optim_loss: 4691231.5000; val_kl_reg_loss: 25114.1445; val_edge_recon_loss: 2725557.0000; val_gene_expr_recon_loss: 402357.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1538106.0000; val_global_loss: 4691134.5000; val_optim_loss: 4691134.5000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9519; val_auprc_score: 0.9345; val_best_acc_score: 0.8954; val_best_f1_score: 0.9012; train_kl_reg_loss: 31308.8553; train_edge_recon_loss: 2705389.8056; train_gene_expr_recon_loss: 402543.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1551127.6528; train_global_loss: 4690369.7222; train_optim_loss: 4690369.7222; val_kl_reg_loss: 23461.1719; val_edge_recon_loss: 2726785.7500; val_gene_expr_recon_loss: 403636.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1538353.0000; val_global_loss: 4692236.0000; val_optim_loss: 4692236.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9523; val_auprc_score: 0.9359; val_best_acc_score: 0.8923; val_best_f1_score: 0.8979; train_kl_reg_loss: 29430.8932; train_edge_recon_loss: 2706425.9444; train_gene_expr_recon_loss: 401762.0868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1541546.1667; train_global_loss: 4679165.1667; train_optim_loss: 4679165.1667; val_kl_reg_loss: 23496.8633; val_edge_recon_loss: 2720825.7500; val_gene_expr_recon_loss: 403169.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1540489.5000; val_global_loss: 4687981.5000; val_optim_loss: 4687981.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9532; val_auprc_score: 0.9384; val_best_acc_score: 0.8925; val_best_f1_score: 0.8984; train_kl_reg_loss: 29275.1387; train_edge_recon_loss: 2696243.4444; train_gene_expr_recon_loss: 399953.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1545302.6667; train_global_loss: 4670774.7778; train_optim_loss: 4670774.7778; val_kl_reg_loss: 23818.1719; val_edge_recon_loss: 2714127.5000; val_gene_expr_recon_loss: 401238.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537695.7500; val_global_loss: 4676880.0000; val_optim_loss: 4676880.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9568; val_auprc_score: 0.9407; val_best_acc_score: 0.9012; val_best_f1_score: 0.9059; train_kl_reg_loss: 29480.2001; train_edge_recon_loss: 2703339.1111; train_gene_expr_recon_loss: 399055.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1539634.5694; train_global_loss: 4671509.7222; train_optim_loss: 4671509.7222; val_kl_reg_loss: 23436.7305; val_edge_recon_loss: 2711012.0000; val_gene_expr_recon_loss: 401008.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1534149.7500; val_global_loss: 4669607.5000; val_optim_loss: 4669607.5000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9553; val_auprc_score: 0.9379; val_best_acc_score: 0.8973; val_best_f1_score: 0.9026; train_kl_reg_loss: 29119.3260; train_edge_recon_loss: 2695123.6944; train_gene_expr_recon_loss: 401449.3785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1550089.9306; train_global_loss: 4675782.2778; train_optim_loss: 4675782.2778; val_kl_reg_loss: 23494.5020; val_edge_recon_loss: 2697289.5000; val_gene_expr_recon_loss: 401765.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537611.0000; val_global_loss: 4660160.0000; val_optim_loss: 4660160.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9589; val_auprc_score: 0.9471; val_best_acc_score: 0.9012; val_best_f1_score: 0.9061; train_kl_reg_loss: 29052.0829; train_edge_recon_loss: 2689650.2778; train_gene_expr_recon_loss: 399787.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1540602.8889; train_global_loss: 4659092.7222; train_optim_loss: 4659092.7222; val_kl_reg_loss: 23539.2891; val_edge_recon_loss: 2700353.2500; val_gene_expr_recon_loss: 400653.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1534897.2500; val_global_loss: 4659443.0000; val_optim_loss: 4659443.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9523; val_auprc_score: 0.9377; val_best_acc_score: 0.8936; val_best_f1_score: 0.8990; train_kl_reg_loss: 29063.7426; train_edge_recon_loss: 2698873.3889; train_gene_expr_recon_loss: 399162.2569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1544359.0278; train_global_loss: 4671458.3889; train_optim_loss: 4671458.3889; val_kl_reg_loss: 23509.3262; val_edge_recon_loss: 2713617.5000; val_gene_expr_recon_loss: 401387.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536895.6250; val_global_loss: 4675409.5000; val_optim_loss: 4675409.5000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9604; val_auprc_score: 0.9490; val_best_acc_score: 0.8977; val_best_f1_score: 0.9021; train_kl_reg_loss: 28766.9727; train_edge_recon_loss: 2693898.7222; train_gene_expr_recon_loss: 399935.1736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1544887.1250; train_global_loss: 4667487.9444; train_optim_loss: 4667487.9444; val_kl_reg_loss: 23276.1094; val_edge_recon_loss: 2706821.0000; val_gene_expr_recon_loss: 401303.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536434.2500; val_global_loss: 4667834.0000; val_optim_loss: 4667834.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9565; val_auprc_score: 0.9406; val_best_acc_score: 0.8999; val_best_f1_score: 0.9036; train_kl_reg_loss: 28741.0883; train_edge_recon_loss: 2696339.7222; train_gene_expr_recon_loss: 401443.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1546971.3889; train_global_loss: 4673496.0556; train_optim_loss: 4673496.0556; val_kl_reg_loss: 23301.5938; val_edge_recon_loss: 2699729.2500; val_gene_expr_recon_loss: 400861.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536399.2500; val_global_loss: 4660291.0000; val_optim_loss: 4660291.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9574; val_auprc_score: 0.9435; val_best_acc_score: 0.9008; val_best_f1_score: 0.9058; train_kl_reg_loss: 28568.3789; train_edge_recon_loss: 2692336.8056; train_gene_expr_recon_loss: 400056.8160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1536633.6667; train_global_loss: 4657595.6111; train_optim_loss: 4657595.6111; val_kl_reg_loss: 23518.2148; val_edge_recon_loss: 2701321.5000; val_gene_expr_recon_loss: 401137.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537600.5000; val_global_loss: 4663578.0000; val_optim_loss: 4663578.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9585; val_auprc_score: 0.9489; val_best_acc_score: 0.8975; val_best_f1_score: 0.9029; train_kl_reg_loss: 28628.2133; train_edge_recon_loss: 2685985.2500; train_gene_expr_recon_loss: 399585.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1540814.1528; train_global_loss: 4655013.5000; train_optim_loss: 4655013.5000; val_kl_reg_loss: 23500.9258; val_edge_recon_loss: 2717543.5000; val_gene_expr_recon_loss: 400948.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537045.5000; val_global_loss: 4679038.5000; val_optim_loss: 4679038.5000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9563; val_auprc_score: 0.9371; val_best_acc_score: 0.8994; val_best_f1_score: 0.9034; train_kl_reg_loss: 28714.5851; train_edge_recon_loss: 2688462.6667; train_gene_expr_recon_loss: 402105.7674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1552451.1250; train_global_loss: 4671734.1111; train_optim_loss: 4671734.1111; val_kl_reg_loss: 23431.8496; val_edge_recon_loss: 2718474.0000; val_gene_expr_recon_loss: 401048.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537044.0000; val_global_loss: 4679998.0000; val_optim_loss: 4679998.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9594; val_auprc_score: 0.9452; val_best_acc_score: 0.9031; val_best_f1_score: 0.9078; train_kl_reg_loss: 28521.3661; train_edge_recon_loss: 2697006.6944; train_gene_expr_recon_loss: 400589.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1545245.3056; train_global_loss: 4671363.3333; train_optim_loss: 4671363.3333; val_kl_reg_loss: 23371.7070; val_edge_recon_loss: 2683870.5000; val_gene_expr_recon_loss: 401244.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536810.0000; val_global_loss: 4645296.5000; val_optim_loss: 4645296.5000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9551; val_auprc_score: 0.9340; val_best_acc_score: 0.8988; val_best_f1_score: 0.9040; train_kl_reg_loss: 28697.7769; train_edge_recon_loss: 2701939.0833; train_gene_expr_recon_loss: 400586.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1542962.7778; train_global_loss: 4674186.0000; train_optim_loss: 4674186.0000; val_kl_reg_loss: 23375.5898; val_edge_recon_loss: 2718887.7500; val_gene_expr_recon_loss: 400866.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536163.7500; val_global_loss: 4679293.5000; val_optim_loss: 4679293.5000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9570; val_auprc_score: 0.9395; val_best_acc_score: 0.9042; val_best_f1_score: 0.9088; train_kl_reg_loss: 28464.8861; train_edge_recon_loss: 2699279.8611; train_gene_expr_recon_loss: 399341.8542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1537351.8056; train_global_loss: 4664438.4444; train_optim_loss: 4664438.4444; val_kl_reg_loss: 23355.9902; val_edge_recon_loss: 2695821.7500; val_gene_expr_recon_loss: 401030.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1538527.6250; val_global_loss: 4658735.5000; val_optim_loss: 4658735.5000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9585; val_auprc_score: 0.9460; val_best_acc_score: 0.9014; val_best_f1_score: 0.9059; train_kl_reg_loss: 28566.2268; train_edge_recon_loss: 2702785.8611; train_gene_expr_recon_loss: 401263.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1553121.8194; train_global_loss: 4685737.2222; train_optim_loss: 4685737.2222; val_kl_reg_loss: 23302.0781; val_edge_recon_loss: 2688930.7500; val_gene_expr_recon_loss: 400575.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1535089.6250; val_global_loss: 4647898.0000; val_optim_loss: 4647898.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9597; val_auprc_score: 0.9470; val_best_acc_score: 0.9012; val_best_f1_score: 0.9060; train_kl_reg_loss: 28599.8479; train_edge_recon_loss: 2681829.1667; train_gene_expr_recon_loss: 399953.6910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1548878.5000; train_global_loss: 4659261.2222; train_optim_loss: 4659261.2222; val_kl_reg_loss: 23377.3516; val_edge_recon_loss: 2691690.2500; val_gene_expr_recon_loss: 400697.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1535383.0000; val_global_loss: 4651148.0000; val_optim_loss: 4651148.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9566; val_auprc_score: 0.9421; val_best_acc_score: 0.8995; val_best_f1_score: 0.9042; train_kl_reg_loss: 28578.6502; train_edge_recon_loss: 2690605.8056; train_gene_expr_recon_loss: 401671.0243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1543047.7361; train_global_loss: 4663903.3333; train_optim_loss: 4663903.3333; val_kl_reg_loss: 23357.5000; val_edge_recon_loss: 2705371.5000; val_gene_expr_recon_loss: 401264.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536210.5000; val_global_loss: 4666204.0000; val_optim_loss: 4666204.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9567; val_auprc_score: 0.9449; val_best_acc_score: 0.8975; val_best_f1_score: 0.9030; train_kl_reg_loss: 28577.6882; train_edge_recon_loss: 2699270.8889; train_gene_expr_recon_loss: 400652.6285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1537669.7778; train_global_loss: 4666171.1111; train_optim_loss: 4666171.1111; val_kl_reg_loss: 23260.4277; val_edge_recon_loss: 2709673.2500; val_gene_expr_recon_loss: 400989.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536207.6250; val_global_loss: 4670130.5000; val_optim_loss: 4670130.5000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9546; val_auprc_score: 0.9390; val_best_acc_score: 0.8953; val_best_f1_score: 0.9012; train_kl_reg_loss: 28630.3535; train_edge_recon_loss: 2689815.3056; train_gene_expr_recon_loss: 400856.9965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1546708.4028; train_global_loss: 4666011.1667; train_optim_loss: 4666011.1667; val_kl_reg_loss: 23324.2773; val_edge_recon_loss: 2720879.5000; val_gene_expr_recon_loss: 400852.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1535438.0000; val_global_loss: 4680494.5000; val_optim_loss: 4680494.5000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9615; val_auprc_score: 0.9501; val_best_acc_score: 0.9035; val_best_f1_score: 0.9077; train_kl_reg_loss: 28463.3149; train_edge_recon_loss: 2685359.8611; train_gene_expr_recon_loss: 400497.6597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1540429.7778; train_global_loss: 4654750.6111; train_optim_loss: 4654750.6111; val_kl_reg_loss: 23341.0703; val_edge_recon_loss: 2691203.2500; val_gene_expr_recon_loss: 400864.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536964.6250; val_global_loss: 4652373.0000; val_optim_loss: 4652373.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 8 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9575
val AUPRC score: 0.9451
val best accuracy score: 0.8980
val best F1 score: 0.9034
val target rna MSE score: 2.0141
val source rna MSE score: 1.7259
val target atac MSE score: 0.1276
val source atac MSE score: 0.0187
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
