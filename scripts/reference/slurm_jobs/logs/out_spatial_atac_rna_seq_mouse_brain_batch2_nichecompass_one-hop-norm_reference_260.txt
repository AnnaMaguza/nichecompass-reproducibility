[True]
Run timestamp: 07092023_041709_260.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_260']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 22333 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 25929, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 22333
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 22333

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6941; val_auprc_score: 0.6799; val_best_acc_score: 0.5059; val_best_f1_score: 0.6680; train_kl_reg_loss: 58564.5493; train_edge_recon_loss: 3640381.8750; train_gene_expr_recon_loss: 14796011.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1128668.6941; train_chrom_access_recon_loss: 49787049.1515; train_global_loss: 69410676.4242; train_optim_loss: 69410676.4242; val_kl_reg_loss: 114810.0420; val_edge_recon_loss: 4064528.1562; val_gene_expr_recon_loss: 13172918.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 870436.7500; val_chrom_access_recon_loss: 47114539.5000; val_global_loss: 65337232.0000; val_optim_loss: 65337232.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6807; val_auprc_score: 0.6642; val_best_acc_score: 0.5629; val_best_f1_score: 0.6834; train_kl_reg_loss: 114491.6659; train_edge_recon_loss: 3616999.4091; train_gene_expr_recon_loss: 13289707.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 641373.6349; train_chrom_access_recon_loss: 47610324.2424; train_global_loss: 65272896.0606; train_optim_loss: 65272896.0606; val_kl_reg_loss: 123690.2715; val_edge_recon_loss: 4061501.5312; val_gene_expr_recon_loss: 13134600.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 447133.1875; val_chrom_access_recon_loss: 47656812.5000; val_global_loss: 65423740.0000; val_optim_loss: 65423740.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7544; val_auprc_score: 0.7390; val_best_acc_score: 0.6875; val_best_f1_score: 0.6987; train_kl_reg_loss: 120711.9528; train_edge_recon_loss: 3553418.8674; train_gene_expr_recon_loss: 13024382.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 337263.6281; train_chrom_access_recon_loss: 47024321.0303; train_global_loss: 64060098.4242; train_optim_loss: 64060098.4242; val_kl_reg_loss: 106496.0400; val_edge_recon_loss: 4034948.0938; val_gene_expr_recon_loss: 12966938.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 256342.2656; val_chrom_access_recon_loss: 46873598.0000; val_global_loss: 64238322.0000; val_optim_loss: 64238322.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8025; val_auprc_score: 0.7743; val_best_acc_score: 0.7208; val_best_f1_score: 0.7564; train_kl_reg_loss: 107966.1107; train_edge_recon_loss: 3513406.9621; train_gene_expr_recon_loss: 12922211.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211119.4453; train_chrom_access_recon_loss: 46687586.4242; train_global_loss: 63442290.0000; train_optim_loss: 63442290.0000; val_kl_reg_loss: 103550.0000; val_edge_recon_loss: 3739127.8750; val_gene_expr_recon_loss: 12749247.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174607.2812; val_chrom_access_recon_loss: 46808946.5000; val_global_loss: 63575479.0000; val_optim_loss: 63575479.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8241; val_auprc_score: 0.7835; val_best_acc_score: 0.7450; val_best_f1_score: 0.7820; train_kl_reg_loss: 106658.6023; train_edge_recon_loss: 3204161.6212; train_gene_expr_recon_loss: 12809238.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151944.4384; train_chrom_access_recon_loss: 46434742.6667; train_global_loss: 62706745.4545; train_optim_loss: 62706745.4545; val_kl_reg_loss: 131182.7119; val_edge_recon_loss: 3060793.4688; val_gene_expr_recon_loss: 12705078.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132948.5625; val_chrom_access_recon_loss: 46528380.0000; val_global_loss: 62558383.0000; val_optim_loss: 62558383.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8328; val_auprc_score: 0.7935; val_best_acc_score: 0.7716; val_best_f1_score: 0.7979; train_kl_reg_loss: 134239.6199; train_edge_recon_loss: 3008096.5076; train_gene_expr_recon_loss: 12713021.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118916.2379; train_chrom_access_recon_loss: 46151816.4242; train_global_loss: 62126090.9697; train_optim_loss: 62126090.9697; val_kl_reg_loss: 142410.6758; val_edge_recon_loss: 3009825.1875; val_gene_expr_recon_loss: 12560558.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106753.4062; val_chrom_access_recon_loss: 46005611.5000; val_global_loss: 61825158.5000; val_optim_loss: 61825158.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8499; val_auprc_score: 0.8041; val_best_acc_score: 0.7915; val_best_f1_score: 0.8122; train_kl_reg_loss: 134198.1159; train_edge_recon_loss: 2940272.5568; train_gene_expr_recon_loss: 12643124.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97298.4809; train_chrom_access_recon_loss: 45940907.2121; train_global_loss: 61755800.9697; train_optim_loss: 61755800.9697; val_kl_reg_loss: 125710.9844; val_edge_recon_loss: 2956818.5625; val_gene_expr_recon_loss: 12385495.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88927.9844; val_chrom_access_recon_loss: 45848302.5000; val_global_loss: 61405255.0000; val_optim_loss: 61405255.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8406; val_auprc_score: 0.7908; val_best_acc_score: 0.7824; val_best_f1_score: 0.8095; train_kl_reg_loss: 126125.5288; train_edge_recon_loss: 2917461.2235; train_gene_expr_recon_loss: 12584642.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82424.5951; train_chrom_access_recon_loss: 45809426.2424; train_global_loss: 61520080.4242; train_optim_loss: 61520080.4242; val_kl_reg_loss: 121923.6641; val_edge_recon_loss: 2958079.5938; val_gene_expr_recon_loss: 12440123.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76709.5156; val_chrom_access_recon_loss: 45373644.5000; val_global_loss: 60970480.0000; val_optim_loss: 60970480.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8470; val_auprc_score: 0.7979; val_best_acc_score: 0.7923; val_best_f1_score: 0.8187; train_kl_reg_loss: 124540.9438; train_edge_recon_loss: 2893968.6515; train_gene_expr_recon_loss: 12523408.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72313.7623; train_chrom_access_recon_loss: 45547149.0303; train_global_loss: 61161380.6061; train_optim_loss: 61161380.6061; val_kl_reg_loss: 121720.1621; val_edge_recon_loss: 2907264.3438; val_gene_expr_recon_loss: 12455086.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68165.8359; val_chrom_access_recon_loss: 45786288.0000; val_global_loss: 61338525.5000; val_optim_loss: 61338525.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8560; val_auprc_score: 0.8104; val_best_acc_score: 0.7947; val_best_f1_score: 0.8224; train_kl_reg_loss: 122767.0105; train_edge_recon_loss: 2865289.2917; train_gene_expr_recon_loss: 12463942.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65016.0058; train_chrom_access_recon_loss: 45392322.0606; train_global_loss: 60909336.3636; train_optim_loss: 60909336.3636; val_kl_reg_loss: 122537.8672; val_edge_recon_loss: 2890704.2500; val_gene_expr_recon_loss: 12271788.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61821.6562; val_chrom_access_recon_loss: 45636284.5000; val_global_loss: 60983137.0000; val_optim_loss: 60983137.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8723; val_auprc_score: 0.8291; val_best_acc_score: 0.8057; val_best_f1_score: 0.8290; train_kl_reg_loss: 119470.6856; train_edge_recon_loss: 2853171.0606; train_gene_expr_recon_loss: 12429940.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59444.3893; train_chrom_access_recon_loss: 45272486.5455; train_global_loss: 60734513.2121; train_optim_loss: 60734513.2121; val_kl_reg_loss: 118590.7178; val_edge_recon_loss: 2887323.6562; val_gene_expr_recon_loss: 12291883.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57189.5000; val_chrom_access_recon_loss: 44899275.5000; val_global_loss: 60254263.5000; val_optim_loss: 60254263.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8799; val_auprc_score: 0.8485; val_best_acc_score: 0.8098; val_best_f1_score: 0.8333; train_kl_reg_loss: 117965.7296; train_edge_recon_loss: 2830522.5871; train_gene_expr_recon_loss: 12375961.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55212.2230; train_chrom_access_recon_loss: 45056627.4545; train_global_loss: 60436290.0606; train_optim_loss: 60436290.0606; val_kl_reg_loss: 112963.1533; val_edge_recon_loss: 2866290.0000; val_gene_expr_recon_loss: 12168440.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53405.5898; val_chrom_access_recon_loss: 44910534.0000; val_global_loss: 60111632.0000; val_optim_loss: 60111632.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8827; val_auprc_score: 0.8470; val_best_acc_score: 0.8160; val_best_f1_score: 0.8353; train_kl_reg_loss: 116032.1641; train_edge_recon_loss: 2830497.3068; train_gene_expr_recon_loss: 12322119.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51897.3728; train_chrom_access_recon_loss: 44860274.1212; train_global_loss: 60180819.9394; train_optim_loss: 60180819.9394; val_kl_reg_loss: 113575.2207; val_edge_recon_loss: 2868936.6875; val_gene_expr_recon_loss: 12202987.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50575.8164; val_chrom_access_recon_loss: 45061240.5000; val_global_loss: 60297315.5000; val_optim_loss: 60297315.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8856; val_auprc_score: 0.8487; val_best_acc_score: 0.8157; val_best_f1_score: 0.8334; train_kl_reg_loss: 113521.1495; train_edge_recon_loss: 2818899.3295; train_gene_expr_recon_loss: 12302932.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49418.1014; train_chrom_access_recon_loss: 44781970.6667; train_global_loss: 60066741.3333; train_optim_loss: 60066741.3333; val_kl_reg_loss: 111829.7402; val_edge_recon_loss: 2886116.4688; val_gene_expr_recon_loss: 12141887.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48468.7266; val_chrom_access_recon_loss: 45164827.5000; val_global_loss: 60353130.5000; val_optim_loss: 60353130.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8975; val_auprc_score: 0.8694; val_best_acc_score: 0.8291; val_best_f1_score: 0.8452; train_kl_reg_loss: 111751.5779; train_edge_recon_loss: 2807867.5720; train_gene_expr_recon_loss: 12253238.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47386.3938; train_chrom_access_recon_loss: 44572559.5152; train_global_loss: 59792803.5758; train_optim_loss: 59792803.5758; val_kl_reg_loss: 111673.7402; val_edge_recon_loss: 2861087.3125; val_gene_expr_recon_loss: 12069336.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46836.5781; val_chrom_access_recon_loss: 44817534.5000; val_global_loss: 59906468.5000; val_optim_loss: 59906468.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8995; val_auprc_score: 0.8658; val_best_acc_score: 0.8372; val_best_f1_score: 0.8501; train_kl_reg_loss: 109938.3642; train_edge_recon_loss: 2793554.2121; train_gene_expr_recon_loss: 12224253.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45979.0782; train_chrom_access_recon_loss: 44463750.3636; train_global_loss: 59637475.6970; train_optim_loss: 59637475.6970; val_kl_reg_loss: 110753.7871; val_edge_recon_loss: 2858956.6875; val_gene_expr_recon_loss: 12220788.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45263.7109; val_chrom_access_recon_loss: 44929504.5000; val_global_loss: 60165267.5000; val_optim_loss: 60165267.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9095; val_auprc_score: 0.8741; val_best_acc_score: 0.8474; val_best_f1_score: 0.8613; train_kl_reg_loss: 109916.2807; train_edge_recon_loss: 2781770.5303; train_gene_expr_recon_loss: 12187977.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44852.2561; train_chrom_access_recon_loss: 44295092.9091; train_global_loss: 59419609.1515; train_optim_loss: 59419609.1515; val_kl_reg_loss: 110617.6904; val_edge_recon_loss: 2805164.7812; val_gene_expr_recon_loss: 11969178.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44329.1719; val_chrom_access_recon_loss: 44594080.5000; val_global_loss: 59523371.0000; val_optim_loss: 59523371.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9107; val_auprc_score: 0.8738; val_best_acc_score: 0.8603; val_best_f1_score: 0.8693; train_kl_reg_loss: 108837.8834; train_edge_recon_loss: 2775213.5000; train_gene_expr_recon_loss: 12159239.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43839.1841; train_chrom_access_recon_loss: 44184334.5455; train_global_loss: 59271464.3636; train_optim_loss: 59271464.3636; val_kl_reg_loss: 106924.6787; val_edge_recon_loss: 2813243.6875; val_gene_expr_recon_loss: 11973652.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43412.5117; val_chrom_access_recon_loss: 43992773.5000; val_global_loss: 58930007.5000; val_optim_loss: 58930007.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9192; val_auprc_score: 0.8904; val_best_acc_score: 0.8592; val_best_f1_score: 0.8688; train_kl_reg_loss: 106529.8094; train_edge_recon_loss: 2769300.1856; train_gene_expr_recon_loss: 12116145.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43023.1756; train_chrom_access_recon_loss: 43993656.1212; train_global_loss: 59028654.7879; train_optim_loss: 59028654.7879; val_kl_reg_loss: 106780.5088; val_edge_recon_loss: 2808789.0312; val_gene_expr_recon_loss: 12080235.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42612.9922; val_chrom_access_recon_loss: 44428172.0000; val_global_loss: 59466590.0000; val_optim_loss: 59466590.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9238; val_auprc_score: 0.8959; val_best_acc_score: 0.8667; val_best_f1_score: 0.8747; train_kl_reg_loss: 105086.1270; train_edge_recon_loss: 2765187.8371; train_gene_expr_recon_loss: 12095153.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42306.7895; train_chrom_access_recon_loss: 43891750.4848; train_global_loss: 58899484.7879; train_optim_loss: 58899484.7879; val_kl_reg_loss: 104053.8066; val_edge_recon_loss: 2809815.9375; val_gene_expr_recon_loss: 11860501.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42303.6250; val_chrom_access_recon_loss: 43805805.0000; val_global_loss: 58622479.5000; val_optim_loss: 58622479.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9222; val_auprc_score: 0.8857; val_best_acc_score: 0.8673; val_best_f1_score: 0.8772; train_kl_reg_loss: 104359.5453; train_edge_recon_loss: 2751093.0985; train_gene_expr_recon_loss: 12069111.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41909.0215; train_chrom_access_recon_loss: 43745070.4848; train_global_loss: 58711543.7576; train_optim_loss: 58711543.7576; val_kl_reg_loss: 104851.3789; val_edge_recon_loss: 2780828.8438; val_gene_expr_recon_loss: 11847780.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41736.2812; val_chrom_access_recon_loss: 43562443.0000; val_global_loss: 58337640.0000; val_optim_loss: 58337640.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9158; val_auprc_score: 0.8767; val_best_acc_score: 0.8614; val_best_f1_score: 0.8718; train_kl_reg_loss: 103990.6900; train_edge_recon_loss: 2757649.5644; train_gene_expr_recon_loss: 12048367.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41430.1952; train_chrom_access_recon_loss: 43655439.0303; train_global_loss: 58606877.2121; train_optim_loss: 58606877.2121; val_kl_reg_loss: 105886.3662; val_edge_recon_loss: 2810330.7812; val_gene_expr_recon_loss: 11918553.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41499.3906; val_chrom_access_recon_loss: 43845112.0000; val_global_loss: 58721382.0000; val_optim_loss: 58721382.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9216; val_auprc_score: 0.9021; val_best_acc_score: 0.8541; val_best_f1_score: 0.8635; train_kl_reg_loss: 1002477.5633; train_edge_recon_loss: 2775592.4091; train_gene_expr_recon_loss: 12143842.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41859.1490; train_chrom_access_recon_loss: 43909926.4242; train_global_loss: 59873697.7576; train_optim_loss: 59873697.7576; val_kl_reg_loss: 84935.5801; val_edge_recon_loss: 2828890.3438; val_gene_expr_recon_loss: 12057104.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41931.0234; val_chrom_access_recon_loss: 44143786.0000; val_global_loss: 59156647.5000; val_optim_loss: 59156647.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9080; val_auprc_score: 0.8682; val_best_acc_score: 0.8514; val_best_f1_score: 0.8641; train_kl_reg_loss: 131323.5563; train_edge_recon_loss: 2800550.9508; train_gene_expr_recon_loss: 12283643.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42464.2704; train_chrom_access_recon_loss: 44167234.4848; train_global_loss: 59425216.7879; train_optim_loss: 59425216.7879; val_kl_reg_loss: 90205.3574; val_edge_recon_loss: 2859529.5625; val_gene_expr_recon_loss: 12005038.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42313.3984; val_chrom_access_recon_loss: 43580010.0000; val_global_loss: 58577096.5000; val_optim_loss: 58577096.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9175; val_auprc_score: 0.8881; val_best_acc_score: 0.8646; val_best_f1_score: 0.8768; train_kl_reg_loss: 436591.1924; train_edge_recon_loss: 2806208.3788; train_gene_expr_recon_loss: 12280001.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41971.3873; train_chrom_access_recon_loss: 43942687.3939; train_global_loss: 59507459.7576; train_optim_loss: 59507459.7576; val_kl_reg_loss: 100680.5205; val_edge_recon_loss: 2785303.6562; val_gene_expr_recon_loss: 12041954.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41165.3984; val_chrom_access_recon_loss: 43587087.5000; val_global_loss: 58556190.5000; val_optim_loss: 58556190.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9196; val_auprc_score: 0.8833; val_best_acc_score: 0.8662; val_best_f1_score: 0.8778; train_kl_reg_loss: 103642.3458; train_edge_recon_loss: 2792480.1250; train_gene_expr_recon_loss: 12077030.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35918.4836; train_chrom_access_recon_loss: 44109786.5455; train_global_loss: 59118858.6061; train_optim_loss: 59118858.6061; val_kl_reg_loss: 84943.7148; val_edge_recon_loss: 2798518.9688; val_gene_expr_recon_loss: 11868554.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33786.8047; val_chrom_access_recon_loss: 43937038.5000; val_global_loss: 58722842.0000; val_optim_loss: 58722842.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9089; val_auprc_score: 0.8775; val_best_acc_score: 0.8506; val_best_f1_score: 0.8661; train_kl_reg_loss: 104972.7873; train_edge_recon_loss: 2780819.8182; train_gene_expr_recon_loss: 11992615.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33179.1312; train_chrom_access_recon_loss: 43661223.8182; train_global_loss: 58572811.1515; train_optim_loss: 58572811.1515; val_kl_reg_loss: 84938.9072; val_edge_recon_loss: 2849354.2812; val_gene_expr_recon_loss: 11837608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32675.4512; val_chrom_access_recon_loss: 43670651.0000; val_global_loss: 58475226.0000; val_optim_loss: 58475226.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9076; val_auprc_score: 0.8712; val_best_acc_score: 0.8589; val_best_f1_score: 0.8719; train_kl_reg_loss: 106499.9277; train_edge_recon_loss: 2772339.9697; train_gene_expr_recon_loss: 11928843.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32294.1324; train_chrom_access_recon_loss: 43385069.9394; train_global_loss: 58225047.4545; train_optim_loss: 58225047.4545; val_kl_reg_loss: 84754.9023; val_edge_recon_loss: 2803198.1250; val_gene_expr_recon_loss: 11682278.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31936.6953; val_chrom_access_recon_loss: 43167398.5000; val_global_loss: 57769566.5000; val_optim_loss: 57769566.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9098; val_auprc_score: 0.8722; val_best_acc_score: 0.8560; val_best_f1_score: 0.8701; train_kl_reg_loss: 108196.4545; train_edge_recon_loss: 2773127.3864; train_gene_expr_recon_loss: 11906808.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31624.4091; train_chrom_access_recon_loss: 43320062.7879; train_global_loss: 58139819.6364; train_optim_loss: 58139819.6364; val_kl_reg_loss: 87012.8643; val_edge_recon_loss: 2805308.6250; val_gene_expr_recon_loss: 11709714.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31333.9355; val_chrom_access_recon_loss: 43401242.5000; val_global_loss: 58034613.5000; val_optim_loss: 58034613.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9267; val_auprc_score: 0.8974; val_best_acc_score: 0.8678; val_best_f1_score: 0.8796; train_kl_reg_loss: 109241.2082; train_edge_recon_loss: 2765614.4773; train_gene_expr_recon_loss: 11889517.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31075.2948; train_chrom_access_recon_loss: 43184510.4242; train_global_loss: 57979958.6667; train_optim_loss: 57979958.6667; val_kl_reg_loss: 88065.8486; val_edge_recon_loss: 2762117.7188; val_gene_expr_recon_loss: 11695386.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30819.3848; val_chrom_access_recon_loss: 43159213.5000; val_global_loss: 57735602.0000; val_optim_loss: 57735602.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9144; val_auprc_score: 0.8864; val_best_acc_score: 0.8530; val_best_f1_score: 0.8671; train_kl_reg_loss: 109841.9671; train_edge_recon_loss: 2779212.6439; train_gene_expr_recon_loss: 11879302.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30582.3744; train_chrom_access_recon_loss: 43185677.4545; train_global_loss: 57984616.7879; train_optim_loss: 57984616.7879; val_kl_reg_loss: 87795.1973; val_edge_recon_loss: 2806798.0000; val_gene_expr_recon_loss: 11804940.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30349.9766; val_chrom_access_recon_loss: 43648667.0000; val_global_loss: 58378551.0000; val_optim_loss: 58378551.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9176; val_auprc_score: 0.8844; val_best_acc_score: 0.8638; val_best_f1_score: 0.8759; train_kl_reg_loss: 110151.9278; train_edge_recon_loss: 2769660.4508; train_gene_expr_recon_loss: 11874418.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30150.4274; train_chrom_access_recon_loss: 43151849.6364; train_global_loss: 57936230.7273; train_optim_loss: 57936230.7273; val_kl_reg_loss: 88133.2686; val_edge_recon_loss: 2792568.3125; val_gene_expr_recon_loss: 11808311.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29947.3574; val_chrom_access_recon_loss: 43394742.5000; val_global_loss: 58113702.0000; val_optim_loss: 58113702.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9126; val_auprc_score: 0.8785; val_best_acc_score: 0.8557; val_best_f1_score: 0.8697; train_kl_reg_loss: 110650.4973; train_edge_recon_loss: 2757215.1856; train_gene_expr_recon_loss: 11861134.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29766.1523; train_chrom_access_recon_loss: 43148198.1212; train_global_loss: 57906963.9394; train_optim_loss: 57906963.9394; val_kl_reg_loss: 89654.1660; val_edge_recon_loss: 2794677.2500; val_gene_expr_recon_loss: 11684691.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29580.5488; val_chrom_access_recon_loss: 43117957.5000; val_global_loss: 57716562.0000; val_optim_loss: 57716562.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9210; val_auprc_score: 0.8915; val_best_acc_score: 0.8614; val_best_f1_score: 0.8736; train_kl_reg_loss: 110797.8239; train_edge_recon_loss: 2770842.8409; train_gene_expr_recon_loss: 11856087.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29424.1222; train_chrom_access_recon_loss: 43120591.8182; train_global_loss: 57887744.2424; train_optim_loss: 57887744.2424; val_kl_reg_loss: 88822.8125; val_edge_recon_loss: 2810674.7500; val_gene_expr_recon_loss: 11750253.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29266.9004; val_chrom_access_recon_loss: 43068461.5000; val_global_loss: 57747479.0000; val_optim_loss: 57747479.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9174; val_auprc_score: 0.8810; val_best_acc_score: 0.8632; val_best_f1_score: 0.8762; train_kl_reg_loss: 111029.6442; train_edge_recon_loss: 2763637.8826; train_gene_expr_recon_loss: 11848829.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29116.1586; train_chrom_access_recon_loss: 43089056.2424; train_global_loss: 57841669.0909; train_optim_loss: 57841669.0909; val_kl_reg_loss: 89554.0762; val_edge_recon_loss: 2782376.8438; val_gene_expr_recon_loss: 11660213.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28967.8340; val_chrom_access_recon_loss: 42892451.0000; val_global_loss: 57453562.5000; val_optim_loss: 57453562.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9303; val_auprc_score: 0.9070; val_best_acc_score: 0.8708; val_best_f1_score: 0.8825; train_kl_reg_loss: 111786.8413; train_edge_recon_loss: 2753601.6705; train_gene_expr_recon_loss: 11841873.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28834.0566; train_chrom_access_recon_loss: 43069259.0909; train_global_loss: 57805354.8485; train_optim_loss: 57805354.8485; val_kl_reg_loss: 89970.7061; val_edge_recon_loss: 2762386.8750; val_gene_expr_recon_loss: 11744693.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28696.0703; val_chrom_access_recon_loss: 42772326.5000; val_global_loss: 57398074.5000; val_optim_loss: 57398074.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9166; val_auprc_score: 0.8838; val_best_acc_score: 0.8611; val_best_f1_score: 0.8733; train_kl_reg_loss: 112177.5607; train_edge_recon_loss: 2756543.5000; train_gene_expr_recon_loss: 11841541.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28579.8265; train_chrom_access_recon_loss: 43043127.4545; train_global_loss: 57781970.1212; train_optim_loss: 57781970.1212; val_kl_reg_loss: 90709.2510; val_edge_recon_loss: 2802971.1562; val_gene_expr_recon_loss: 11828040.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28468.5449; val_chrom_access_recon_loss: 42831432.5000; val_global_loss: 57581622.5000; val_optim_loss: 57581622.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9155; val_auprc_score: 0.8756; val_best_acc_score: 0.8587; val_best_f1_score: 0.8712; train_kl_reg_loss: 111671.4384; train_edge_recon_loss: 2750116.6629; train_gene_expr_recon_loss: 11839851.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28365.8306; train_chrom_access_recon_loss: 43020767.2121; train_global_loss: 57750772.9697; train_optim_loss: 57750772.9697; val_kl_reg_loss: 90388.4111; val_edge_recon_loss: 2804385.0938; val_gene_expr_recon_loss: 11756387.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28252.9414; val_chrom_access_recon_loss: 43184769.5000; val_global_loss: 57864183.0000; val_optim_loss: 57864183.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9125; val_auprc_score: 0.8782; val_best_acc_score: 0.8552; val_best_f1_score: 0.8675; train_kl_reg_loss: 111501.8400; train_edge_recon_loss: 2744662.5379; train_gene_expr_recon_loss: 11829928.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28159.7618; train_chrom_access_recon_loss: 43004596.1212; train_global_loss: 57718848.7879; train_optim_loss: 57718848.7879; val_kl_reg_loss: 90635.1982; val_edge_recon_loss: 2821853.8125; val_gene_expr_recon_loss: 11589349.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28063.6270; val_chrom_access_recon_loss: 42745744.0000; val_global_loss: 57275647.0000; val_optim_loss: 57275647.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9222; val_auprc_score: 0.8841; val_best_acc_score: 0.8622; val_best_f1_score: 0.8724; train_kl_reg_loss: 111322.4768; train_edge_recon_loss: 2752681.4659; train_gene_expr_recon_loss: 11830646.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27971.0771; train_chrom_access_recon_loss: 42971007.8788; train_global_loss: 57693629.4545; train_optim_loss: 57693629.4545; val_kl_reg_loss: 90198.2344; val_edge_recon_loss: 2793432.5000; val_gene_expr_recon_loss: 11694308.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27880.1758; val_chrom_access_recon_loss: 43137067.5000; val_global_loss: 57742887.0000; val_optim_loss: 57742887.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9178; val_auprc_score: 0.8819; val_best_acc_score: 0.8627; val_best_f1_score: 0.8749; train_kl_reg_loss: 110988.4465; train_edge_recon_loss: 2753568.0947; train_gene_expr_recon_loss: 11835858.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27808.8456; train_chrom_access_recon_loss: 43024356.0000; train_global_loss: 57752579.5758; train_optim_loss: 57752579.5758; val_kl_reg_loss: 89440.0713; val_edge_recon_loss: 2785450.9375; val_gene_expr_recon_loss: 11606286.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27720.2578; val_chrom_access_recon_loss: 42756822.0000; val_global_loss: 57265719.5000; val_optim_loss: 57265719.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9173; val_auprc_score: 0.8871; val_best_acc_score: 0.8533; val_best_f1_score: 0.8680; train_kl_reg_loss: 110466.3226; train_edge_recon_loss: 2764194.5871; train_gene_expr_recon_loss: 11831723.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27655.4480; train_chrom_access_recon_loss: 43004375.5758; train_global_loss: 57738415.3939; train_optim_loss: 57738415.3939; val_kl_reg_loss: 89043.3311; val_edge_recon_loss: 2798873.0000; val_gene_expr_recon_loss: 11767563.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27584.3652; val_chrom_access_recon_loss: 42874823.5000; val_global_loss: 57557888.0000; val_optim_loss: 57557888.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9235; val_auprc_score: 0.8983; val_best_acc_score: 0.8619; val_best_f1_score: 0.8738; train_kl_reg_loss: 110187.9287; train_edge_recon_loss: 2747459.0455; train_gene_expr_recon_loss: 11815382.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27515.4900; train_chrom_access_recon_loss: 42925836.2424; train_global_loss: 57626380.9091; train_optim_loss: 57626380.9091; val_kl_reg_loss: 89744.1465; val_edge_recon_loss: 2789309.6875; val_gene_expr_recon_loss: 11689110.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27444.2930; val_chrom_access_recon_loss: 42883680.0000; val_global_loss: 57479288.5000; val_optim_loss: 57479288.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9292; val_auprc_score: 0.9038; val_best_acc_score: 0.8710; val_best_f1_score: 0.8822; train_kl_reg_loss: 110280.6896; train_edge_recon_loss: 2754762.9848; train_gene_expr_recon_loss: 11821300.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27388.5007; train_chrom_access_recon_loss: 42953480.5455; train_global_loss: 57667213.6364; train_optim_loss: 57667213.6364; val_kl_reg_loss: 89477.9277; val_edge_recon_loss: 2756711.3125; val_gene_expr_recon_loss: 11724262.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27321.3691; val_chrom_access_recon_loss: 42945106.0000; val_global_loss: 57542878.5000; val_optim_loss: 57542878.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9180; val_auprc_score: 0.8870; val_best_acc_score: 0.8595; val_best_f1_score: 0.8722; train_kl_reg_loss: 109652.4605; train_edge_recon_loss: 2749875.1818; train_gene_expr_recon_loss: 11812579.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27263.2187; train_chrom_access_recon_loss: 42953526.0606; train_global_loss: 57652895.8788; train_optim_loss: 57652895.8788; val_kl_reg_loss: 90389.9990; val_edge_recon_loss: 2793450.6250; val_gene_expr_recon_loss: 11664217.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27194.0605; val_chrom_access_recon_loss: 42873688.0000; val_global_loss: 57448940.5000; val_optim_loss: 57448940.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9312; val_auprc_score: 0.9055; val_best_acc_score: 0.8718; val_best_f1_score: 0.8831; train_kl_reg_loss: 109641.2756; train_edge_recon_loss: 2745445.3182; train_gene_expr_recon_loss: 11820260.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26949.6282; train_chrom_access_recon_loss: 42933647.5152; train_global_loss: 57635943.6970; train_optim_loss: 57635943.6970; val_kl_reg_loss: 89053.1689; val_edge_recon_loss: 2756601.7812; val_gene_expr_recon_loss: 11730913.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26892.2090; val_chrom_access_recon_loss: 43051413.5000; val_global_loss: 57654874.0000; val_optim_loss: 57654874.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9214; val_auprc_score: 0.8956; val_best_acc_score: 0.8552; val_best_f1_score: 0.8699; train_kl_reg_loss: 109658.6591; train_edge_recon_loss: 2746305.4470; train_gene_expr_recon_loss: 11819595.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26879.4980; train_chrom_access_recon_loss: 42946486.8485; train_global_loss: 57648925.8788; train_optim_loss: 57648925.8788; val_kl_reg_loss: 89787.2510; val_edge_recon_loss: 2792594.0312; val_gene_expr_recon_loss: 11750959.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26866.8281; val_chrom_access_recon_loss: 43223873.0000; val_global_loss: 57884081.5000; val_optim_loss: 57884081.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9255; val_auprc_score: 0.8971; val_best_acc_score: 0.8732; val_best_f1_score: 0.8842; train_kl_reg_loss: 109445.5285; train_edge_recon_loss: 2739404.2841; train_gene_expr_recon_loss: 11815737.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26855.8829; train_chrom_access_recon_loss: 42919590.7273; train_global_loss: 57611033.8182; train_optim_loss: 57611033.8182; val_kl_reg_loss: 89319.3779; val_edge_recon_loss: 2769405.1562; val_gene_expr_recon_loss: 11663194.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26845.5176; val_chrom_access_recon_loss: 43222014.5000; val_global_loss: 57770779.5000; val_optim_loss: 57770779.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9240; val_auprc_score: 0.8938; val_best_acc_score: 0.8662; val_best_f1_score: 0.8780; train_kl_reg_loss: 109747.4281; train_edge_recon_loss: 2754411.4356; train_gene_expr_recon_loss: 11815679.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26837.7657; train_chrom_access_recon_loss: 42955052.9697; train_global_loss: 57661729.3939; train_optim_loss: 57661729.3939; val_kl_reg_loss: 89752.7266; val_edge_recon_loss: 2771024.0938; val_gene_expr_recon_loss: 11623762.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26829.3457; val_chrom_access_recon_loss: 42879547.0000; val_global_loss: 57390915.0000; val_optim_loss: 57390915.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 20 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9142
val AUPRC score: 0.8843
val best accuracy score: 0.8544
val best F1 score: 0.8686
val target rna MSE score: 1.2472
val source rna MSE score: 0.5340
val target atac MSE score: 0.1228
val source atac MSE score: 0.0276
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
