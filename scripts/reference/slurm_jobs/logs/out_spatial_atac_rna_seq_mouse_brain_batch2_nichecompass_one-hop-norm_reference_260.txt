[True]
Run timestamp: 10102023_121558_260.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_260']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6892; val_auprc_score: 0.6569; val_best_acc_score: 0.5204; val_best_f1_score: 0.6754; train_kl_reg_loss: 57821.1191; train_edge_recon_loss: 742931.8778; train_gene_expr_recon_loss: 22793404.4545; train_masked_gp_l1_reg_loss: 107516.0780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3276276.4318; train_chrom_access_recon_loss: 4936794.2576; train_global_loss: 31914743.9697; train_optim_loss: 31914743.9697; val_kl_reg_loss: 79270.3545; val_edge_recon_loss: 812815.6250; val_gene_expr_recon_loss: 21263837.2500; val_masked_gp_l1_reg_loss: 83148.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2175072.7500; val_chrom_access_recon_loss: 4668602.0625; val_global_loss: 29082745.2500; val_optim_loss: 29082745.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7151; val_auprc_score: 0.6921; val_best_acc_score: 0.6359; val_best_f1_score: 0.7131; train_kl_reg_loss: 88571.1829; train_edge_recon_loss: 746571.1837; train_gene_expr_recon_loss: 21197728.4545; train_masked_gp_l1_reg_loss: 76619.8158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1393775.5095; train_chrom_access_recon_loss: 4719279.7348; train_global_loss: 28222546.0000; train_optim_loss: 28222546.0000; val_kl_reg_loss: 77243.3164; val_edge_recon_loss: 811174.7109; val_gene_expr_recon_loss: 21254997.0000; val_masked_gp_l1_reg_loss: 73255.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 811099.5000; val_chrom_access_recon_loss: 4670780.3125; val_global_loss: 27698551.2500; val_optim_loss: 27698551.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8098; val_auprc_score: 0.7996; val_best_acc_score: 0.7423; val_best_f1_score: 0.7317; train_kl_reg_loss: 80550.7351; train_edge_recon_loss: 737465.1572; train_gene_expr_recon_loss: 20996523.9091; train_masked_gp_l1_reg_loss: 73129.8417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 553940.2988; train_chrom_access_recon_loss: 4691670.7348; train_global_loss: 27133280.9091; train_optim_loss: 27133280.9091; val_kl_reg_loss: 79006.7832; val_edge_recon_loss: 801115.5156; val_gene_expr_recon_loss: 20924678.2500; val_masked_gp_l1_reg_loss: 73855.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 374928.6250; val_chrom_access_recon_loss: 4651434.6250; val_global_loss: 26905019.2500; val_optim_loss: 26905019.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8597; val_auprc_score: 0.8296; val_best_acc_score: 0.7931; val_best_f1_score: 0.8042; train_kl_reg_loss: 72968.3697; train_edge_recon_loss: 726325.8580; train_gene_expr_recon_loss: 20837326.3636; train_masked_gp_l1_reg_loss: 74906.3484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 291979.8918; train_chrom_access_recon_loss: 4658673.5909; train_global_loss: 26662180.3939; train_optim_loss: 26662180.3939; val_kl_reg_loss: 66068.4805; val_edge_recon_loss: 769744.6719; val_gene_expr_recon_loss: 20689911.5000; val_masked_gp_l1_reg_loss: 76063.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230765.9844; val_chrom_access_recon_loss: 4582127.5625; val_global_loss: 26414682.5000; val_optim_loss: 26414682.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8835; val_auprc_score: 0.8485; val_best_acc_score: 0.8074; val_best_f1_score: 0.8291; train_kl_reg_loss: 68880.7153; train_edge_recon_loss: 698398.5483; train_gene_expr_recon_loss: 20658828.8485; train_masked_gp_l1_reg_loss: 77315.3924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197475.0966; train_chrom_access_recon_loss: 4629452.5682; train_global_loss: 26330351.1818; train_optim_loss: 26330351.1818; val_kl_reg_loss: 71484.9297; val_edge_recon_loss: 681201.8047; val_gene_expr_recon_loss: 20583018.2500; val_masked_gp_l1_reg_loss: 78539.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169033.4062; val_chrom_access_recon_loss: 4556484.1875; val_global_loss: 26139763.0000; val_optim_loss: 26139763.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8860; val_auprc_score: 0.8516; val_best_acc_score: 0.8122; val_best_f1_score: 0.8323; train_kl_reg_loss: 76670.9969; train_edge_recon_loss: 647789.7623; train_gene_expr_recon_loss: 20546860.4545; train_masked_gp_l1_reg_loss: 79642.2853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149754.0831; train_chrom_access_recon_loss: 4606756.3333; train_global_loss: 26107474.0303; train_optim_loss: 26107474.0303; val_kl_reg_loss: 80144.1279; val_edge_recon_loss: 635226.9922; val_gene_expr_recon_loss: 20342387.7500; val_masked_gp_l1_reg_loss: 80636.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133758.1406; val_chrom_access_recon_loss: 4508724.5000; val_global_loss: 25780877.5000; val_optim_loss: 25780877.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8961; val_auprc_score: 0.8600; val_best_acc_score: 0.8345; val_best_f1_score: 0.8480; train_kl_reg_loss: 78976.1069; train_edge_recon_loss: 627576.7623; train_gene_expr_recon_loss: 20466912.3333; train_masked_gp_l1_reg_loss: 81665.7726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122646.6553; train_chrom_access_recon_loss: 4591510.7879; train_global_loss: 25969288.5152; train_optim_loss: 25969288.5152; val_kl_reg_loss: 78354.7236; val_edge_recon_loss: 619920.1562; val_gene_expr_recon_loss: 20520676.0000; val_masked_gp_l1_reg_loss: 82529.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113133.1797; val_chrom_access_recon_loss: 4535671.3125; val_global_loss: 25950286.2500; val_optim_loss: 25950286.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8995; val_auprc_score: 0.8640; val_best_acc_score: 0.8294; val_best_f1_score: 0.8458; train_kl_reg_loss: 77334.3761; train_edge_recon_loss: 621649.6837; train_gene_expr_recon_loss: 20351967.2424; train_masked_gp_l1_reg_loss: 83557.1854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106657.5696; train_chrom_access_recon_loss: 4569253.2879; train_global_loss: 25810419.3030; train_optim_loss: 25810419.3030; val_kl_reg_loss: 76240.7471; val_edge_recon_loss: 617266.1094; val_gene_expr_recon_loss: 20161824.7500; val_masked_gp_l1_reg_loss: 84299.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100882.9062; val_chrom_access_recon_loss: 4495558.6250; val_global_loss: 25536072.2500; val_optim_loss: 25536072.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9075; val_auprc_score: 0.8792; val_best_acc_score: 0.8372; val_best_f1_score: 0.8509; train_kl_reg_loss: 76116.8720; train_edge_recon_loss: 614613.9564; train_gene_expr_recon_loss: 20267364.0303; train_masked_gp_l1_reg_loss: 85032.9719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97067.0049; train_chrom_access_recon_loss: 4549324.7879; train_global_loss: 25689519.6667; train_optim_loss: 25689519.6667; val_kl_reg_loss: 73980.2852; val_edge_recon_loss: 616969.9062; val_gene_expr_recon_loss: 20067438.5000; val_masked_gp_l1_reg_loss: 85797.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94324.0000; val_chrom_access_recon_loss: 4438570.4375; val_global_loss: 25377081.2500; val_optim_loss: 25377081.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9059; val_auprc_score: 0.8798; val_best_acc_score: 0.8350; val_best_f1_score: 0.8486; train_kl_reg_loss: 74621.5292; train_edge_recon_loss: 609394.2869; train_gene_expr_recon_loss: 20182290.8485; train_masked_gp_l1_reg_loss: 86485.6038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91355.4920; train_chrom_access_recon_loss: 4531577.0000; train_global_loss: 25575724.9091; train_optim_loss: 25575724.9091; val_kl_reg_loss: 71943.1846; val_edge_recon_loss: 616010.7969; val_gene_expr_recon_loss: 20020438.2500; val_masked_gp_l1_reg_loss: 87187.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89044.2266; val_chrom_access_recon_loss: 4434869.2500; val_global_loss: 25319493.7500; val_optim_loss: 25319493.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9114; val_auprc_score: 0.8846; val_best_acc_score: 0.8409; val_best_f1_score: 0.8551; train_kl_reg_loss: 73172.6312; train_edge_recon_loss: 607243.3362; train_gene_expr_recon_loss: 20118374.8788; train_masked_gp_l1_reg_loss: 87658.8084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86923.3461; train_chrom_access_recon_loss: 4519800.7500; train_global_loss: 25493173.6364; train_optim_loss: 25493173.6364; val_kl_reg_loss: 71302.9434; val_edge_recon_loss: 610559.5781; val_gene_expr_recon_loss: 20058078.0000; val_masked_gp_l1_reg_loss: 88105.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84932.4922; val_chrom_access_recon_loss: 4400991.8750; val_global_loss: 25313970.5000; val_optim_loss: 25313970.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9214; val_auprc_score: 0.9009; val_best_acc_score: 0.8557; val_best_f1_score: 0.8637; train_kl_reg_loss: 71522.7966; train_edge_recon_loss: 604573.6269; train_gene_expr_recon_loss: 20042075.5152; train_masked_gp_l1_reg_loss: 88612.3460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83252.8589; train_chrom_access_recon_loss: 4497441.0000; train_global_loss: 25387477.9697; train_optim_loss: 25387477.9697; val_kl_reg_loss: 70406.8135; val_edge_recon_loss: 606293.3516; val_gene_expr_recon_loss: 20170714.5000; val_masked_gp_l1_reg_loss: 89258.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81947.1016; val_chrom_access_recon_loss: 4462268.3750; val_global_loss: 25480889.2500; val_optim_loss: 25480889.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9226; val_auprc_score: 0.8932; val_best_acc_score: 0.8560; val_best_f1_score: 0.8654; train_kl_reg_loss: 70569.5386; train_edge_recon_loss: 601057.8608; train_gene_expr_recon_loss: 19970037.6364; train_masked_gp_l1_reg_loss: 89735.3370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80080.1044; train_chrom_access_recon_loss: 4481861.3030; train_global_loss: 25293341.8788; train_optim_loss: 25293341.8788; val_kl_reg_loss: 70159.8164; val_edge_recon_loss: 603640.7578; val_gene_expr_recon_loss: 20024737.0000; val_masked_gp_l1_reg_loss: 90320.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79577.4062; val_chrom_access_recon_loss: 4470515.6875; val_global_loss: 25338951.2500; val_optim_loss: 25338951.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9254; val_auprc_score: 0.9058; val_best_acc_score: 0.8619; val_best_f1_score: 0.8712; train_kl_reg_loss: 69572.2656; train_edge_recon_loss: 599301.4081; train_gene_expr_recon_loss: 19915550.6667; train_masked_gp_l1_reg_loss: 90727.1940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77933.2790; train_chrom_access_recon_loss: 4466948.3561; train_global_loss: 25220033.3939; train_optim_loss: 25220033.3939; val_kl_reg_loss: 67896.8320; val_edge_recon_loss: 610307.7734; val_gene_expr_recon_loss: 19937243.5000; val_masked_gp_l1_reg_loss: 91345.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77539.9219; val_chrom_access_recon_loss: 4420151.6250; val_global_loss: 25204485.2500; val_optim_loss: 25204485.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9250; val_auprc_score: 0.9032; val_best_acc_score: 0.8641; val_best_f1_score: 0.8734; train_kl_reg_loss: 68495.1945; train_edge_recon_loss: 596958.5322; train_gene_expr_recon_loss: 19835466.2727; train_masked_gp_l1_reg_loss: 91685.5695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76058.0097; train_chrom_access_recon_loss: 4446465.5227; train_global_loss: 25115129.2727; train_optim_loss: 25115129.2727; val_kl_reg_loss: 67524.6450; val_edge_recon_loss: 603522.3047; val_gene_expr_recon_loss: 19673071.0000; val_masked_gp_l1_reg_loss: 92182.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75701.1641; val_chrom_access_recon_loss: 4376060.5625; val_global_loss: 24888062.0000; val_optim_loss: 24888062.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9431; val_auprc_score: 0.9266; val_best_acc_score: 0.8807; val_best_f1_score: 0.8863; train_kl_reg_loss: 67778.0895; train_edge_recon_loss: 595973.4271; train_gene_expr_recon_loss: 19785284.4545; train_masked_gp_l1_reg_loss: 92602.3986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74692.0890; train_chrom_access_recon_loss: 4430325.2348; train_global_loss: 25046655.4242; train_optim_loss: 25046655.4242; val_kl_reg_loss: 66125.8301; val_edge_recon_loss: 594900.3594; val_gene_expr_recon_loss: 19618334.7500; val_masked_gp_l1_reg_loss: 93472.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74352.5469; val_chrom_access_recon_loss: 4347487.8750; val_global_loss: 24794673.0000; val_optim_loss: 24794673.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9398; val_auprc_score: 0.9232; val_best_acc_score: 0.8794; val_best_f1_score: 0.8851; train_kl_reg_loss: 66797.8816; train_edge_recon_loss: 594247.2595; train_gene_expr_recon_loss: 19703300.2121; train_masked_gp_l1_reg_loss: 93858.5471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73721.7865; train_chrom_access_recon_loss: 4405968.0947; train_global_loss: 24937893.7879; train_optim_loss: 24937893.7879; val_kl_reg_loss: 66495.5840; val_edge_recon_loss: 591620.6875; val_gene_expr_recon_loss: 19884337.2500; val_masked_gp_l1_reg_loss: 94112.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73109.5156; val_chrom_access_recon_loss: 4349194.0312; val_global_loss: 25058869.2500; val_optim_loss: 25058869.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9391; val_auprc_score: 0.9222; val_best_acc_score: 0.8786; val_best_f1_score: 0.8849; train_kl_reg_loss: 66884.5378; train_edge_recon_loss: 590675.9205; train_gene_expr_recon_loss: 19705338.6667; train_masked_gp_l1_reg_loss: 94618.0418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72818.2653; train_chrom_access_recon_loss: 4400228.8258; train_global_loss: 24930564.1212; train_optim_loss: 24930564.1212; val_kl_reg_loss: 68468.2822; val_edge_recon_loss: 601135.5859; val_gene_expr_recon_loss: 19649536.2500; val_masked_gp_l1_reg_loss: 95198.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72687.0391; val_chrom_access_recon_loss: 4345900.3750; val_global_loss: 24832926.0000; val_optim_loss: 24832926.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9402; val_auprc_score: 0.9192; val_best_acc_score: 0.8821; val_best_f1_score: 0.8870; train_kl_reg_loss: 66323.3708; train_edge_recon_loss: 591197.0587; train_gene_expr_recon_loss: 19606271.7273; train_masked_gp_l1_reg_loss: 95622.7147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72005.5853; train_chrom_access_recon_loss: 4373205.7159; train_global_loss: 24804626.1212; train_optim_loss: 24804626.1212; val_kl_reg_loss: 65530.7881; val_edge_recon_loss: 596293.7031; val_gene_expr_recon_loss: 19429253.5000; val_masked_gp_l1_reg_loss: 96120.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71796.3516; val_chrom_access_recon_loss: 4316607.2188; val_global_loss: 24575601.2500; val_optim_loss: 24575601.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9380; val_auprc_score: 0.9200; val_best_acc_score: 0.8791; val_best_f1_score: 0.8852; train_kl_reg_loss: 65457.6278; train_edge_recon_loss: 589558.2443; train_gene_expr_recon_loss: 19577578.0303; train_masked_gp_l1_reg_loss: 96703.5687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71575.9847; train_chrom_access_recon_loss: 4354047.5152; train_global_loss: 24754920.8788; train_optim_loss: 24754920.8788; val_kl_reg_loss: 64038.3042; val_edge_recon_loss: 597198.0781; val_gene_expr_recon_loss: 19555216.2500; val_masked_gp_l1_reg_loss: 97475.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71503.7578; val_chrom_access_recon_loss: 4303306.1875; val_global_loss: 24688738.7500; val_optim_loss: 24688738.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9457; val_auprc_score: 0.9304; val_best_acc_score: 0.8880; val_best_f1_score: 0.8932; train_kl_reg_loss: 64197.7295; train_edge_recon_loss: 590222.3864; train_gene_expr_recon_loss: 19499964.1818; train_masked_gp_l1_reg_loss: 98090.6773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71390.0838; train_chrom_access_recon_loss: 4331747.1780; train_global_loss: 24655612.3636; train_optim_loss: 24655612.3636; val_kl_reg_loss: 63095.0342; val_edge_recon_loss: 594101.8984; val_gene_expr_recon_loss: 19555199.2500; val_masked_gp_l1_reg_loss: 98868.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71562.3125; val_chrom_access_recon_loss: 4312296.3125; val_global_loss: 24695121.7500; val_optim_loss: 24695121.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9429; val_auprc_score: 0.9247; val_best_acc_score: 0.8885; val_best_f1_score: 0.8936; train_kl_reg_loss: 63552.0298; train_edge_recon_loss: 588847.1695; train_gene_expr_recon_loss: 19440095.4242; train_masked_gp_l1_reg_loss: 99531.6995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71392.6679; train_chrom_access_recon_loss: 4308809.9886; train_global_loss: 24572229.0303; train_optim_loss: 24572229.0303; val_kl_reg_loss: 63546.3325; val_edge_recon_loss: 592388.1328; val_gene_expr_recon_loss: 19475604.7500; val_masked_gp_l1_reg_loss: 100380.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71455.7344; val_chrom_access_recon_loss: 4326079.6875; val_global_loss: 24629455.0000; val_optim_loss: 24629455.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9478; val_auprc_score: 0.9284; val_best_acc_score: 0.8968; val_best_f1_score: 0.9024; train_kl_reg_loss: 63145.1065; train_edge_recon_loss: 588200.3731; train_gene_expr_recon_loss: 19386728.1515; train_masked_gp_l1_reg_loss: 101138.5481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71173.0207; train_chrom_access_recon_loss: 4284653.1553; train_global_loss: 24495038.4545; train_optim_loss: 24495038.4545; val_kl_reg_loss: 62937.6484; val_edge_recon_loss: 589437.8281; val_gene_expr_recon_loss: 19354531.5000; val_masked_gp_l1_reg_loss: 101810.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71442.9922; val_chrom_access_recon_loss: 4232321.5312; val_global_loss: 24412480.5000; val_optim_loss: 24412480.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9520; val_auprc_score: 0.9361; val_best_acc_score: 0.9033; val_best_f1_score: 0.9060; train_kl_reg_loss: 62575.9757; train_edge_recon_loss: 588262.1809; train_gene_expr_recon_loss: 19322188.2121; train_masked_gp_l1_reg_loss: 102747.3359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71098.4889; train_chrom_access_recon_loss: 4257412.6402; train_global_loss: 24404284.6667; train_optim_loss: 24404284.6667; val_kl_reg_loss: 62375.7705; val_edge_recon_loss: 585850.7969; val_gene_expr_recon_loss: 19182431.7500; val_masked_gp_l1_reg_loss: 103712.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71168.9844; val_chrom_access_recon_loss: 4204950.8438; val_global_loss: 24210489.0000; val_optim_loss: 24210489.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9473; val_auprc_score: 0.9227; val_best_acc_score: 0.8958; val_best_f1_score: 0.8997; train_kl_reg_loss: 62422.0447; train_edge_recon_loss: 586258.4479; train_gene_expr_recon_loss: 19272913.8788; train_masked_gp_l1_reg_loss: 104573.2663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71185.1450; train_chrom_access_recon_loss: 4236280.5000; train_global_loss: 24333633.4242; train_optim_loss: 24333633.4242; val_kl_reg_loss: 62360.1123; val_edge_recon_loss: 588480.9062; val_gene_expr_recon_loss: 19460360.0000; val_masked_gp_l1_reg_loss: 105625.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71459.9922; val_chrom_access_recon_loss: 4195375.4375; val_global_loss: 24483662.5000; val_optim_loss: 24483662.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8564; val_auprc_score: 0.8021; val_best_acc_score: 0.8009; val_best_f1_score: 0.8249; train_kl_reg_loss: 46133.2023; train_edge_recon_loss: 731414.4697; train_gene_expr_recon_loss: 19011409.6667; train_masked_gp_l1_reg_loss: 108554.5386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75254.0816; train_chrom_access_recon_loss: 4284884.1591; train_global_loss: 24257649.9091; train_optim_loss: 24257649.9091; val_kl_reg_loss: 27474.5730; val_edge_recon_loss: 759601.1406; val_gene_expr_recon_loss: 18446135.0000; val_masked_gp_l1_reg_loss: 110640.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81511.6172; val_chrom_access_recon_loss: 4141563.3125; val_global_loss: 23566925.7500; val_optim_loss: 23566925.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8626; val_auprc_score: 0.8201; val_best_acc_score: 0.7974; val_best_f1_score: 0.8169; train_kl_reg_loss: 26411.5771; train_edge_recon_loss: 729082.1259; train_gene_expr_recon_loss: 18678643.8788; train_masked_gp_l1_reg_loss: 109205.5518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82979.3612; train_chrom_access_recon_loss: 4208600.1439; train_global_loss: 23834922.3333; train_optim_loss: 23834922.3333; val_kl_reg_loss: 13272.8179; val_edge_recon_loss: 760072.4844; val_gene_expr_recon_loss: 18510812.5000; val_masked_gp_l1_reg_loss: 108727.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85985.3594; val_chrom_access_recon_loss: 4140407.6562; val_global_loss: 23619279.2500; val_optim_loss: 23619279.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8785; val_auprc_score: 0.8365; val_best_acc_score: 0.8117; val_best_f1_score: 0.8350; train_kl_reg_loss: 23745.5109; train_edge_recon_loss: 720726.3532; train_gene_expr_recon_loss: 18588552.3333; train_masked_gp_l1_reg_loss: 107842.0819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85277.5328; train_chrom_access_recon_loss: 4195266.7652; train_global_loss: 23721410.5758; train_optim_loss: 23721410.5758; val_kl_reg_loss: 22576.2825; val_edge_recon_loss: 732278.6953; val_gene_expr_recon_loss: 18563699.0000; val_masked_gp_l1_reg_loss: 106013.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82354.8672; val_chrom_access_recon_loss: 4150288.3750; val_global_loss: 23657210.5000; val_optim_loss: 23657210.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8714; val_auprc_score: 0.8344; val_best_acc_score: 0.8119; val_best_f1_score: 0.8333; train_kl_reg_loss: 24173.8898; train_edge_recon_loss: 702544.9659; train_gene_expr_recon_loss: 18575046.4242; train_masked_gp_l1_reg_loss: 106201.7931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82508.5206; train_chrom_access_recon_loss: 4193138.1932; train_global_loss: 23683613.8788; train_optim_loss: 23683613.8788; val_kl_reg_loss: 21486.5359; val_edge_recon_loss: 714650.8516; val_gene_expr_recon_loss: 18625002.2500; val_masked_gp_l1_reg_loss: 106002.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81410.8125; val_chrom_access_recon_loss: 4168708.2500; val_global_loss: 23717259.7500; val_optim_loss: 23717259.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8833; val_auprc_score: 0.8480; val_best_acc_score: 0.8195; val_best_f1_score: 0.8409; train_kl_reg_loss: 26807.8072; train_edge_recon_loss: 678364.6402; train_gene_expr_recon_loss: 18456680.3333; train_masked_gp_l1_reg_loss: 104225.7792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78548.5569; train_chrom_access_recon_loss: 4177017.3295; train_global_loss: 23521644.3939; train_optim_loss: 23521644.3939; val_kl_reg_loss: 21743.1184; val_edge_recon_loss: 673210.3359; val_gene_expr_recon_loss: 18237361.7500; val_masked_gp_l1_reg_loss: 102805.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75660.0391; val_chrom_access_recon_loss: 4074844.6250; val_global_loss: 23185625.2500; val_optim_loss: 23185625.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8572; val_auprc_score: 0.8115; val_best_acc_score: 0.7996; val_best_f1_score: 0.8252; train_kl_reg_loss: 27580.2531; train_edge_recon_loss: 659093.4233; train_gene_expr_recon_loss: 18442816.7576; train_masked_gp_l1_reg_loss: 101815.6795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74424.1398; train_chrom_access_recon_loss: 4177318.4659; train_global_loss: 23483048.5152; train_optim_loss: 23483048.5152; val_kl_reg_loss: 22636.5664; val_edge_recon_loss: 661498.7109; val_gene_expr_recon_loss: 18316087.5000; val_masked_gp_l1_reg_loss: 101075.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73771.2422; val_chrom_access_recon_loss: 4079160.5938; val_global_loss: 23254231.5000; val_optim_loss: 23254231.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8766; val_auprc_score: 0.8418; val_best_acc_score: 0.8141; val_best_f1_score: 0.8373; train_kl_reg_loss: 29836.3882; train_edge_recon_loss: 640706.9650; train_gene_expr_recon_loss: 18407075.6061; train_masked_gp_l1_reg_loss: 100480.1375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72570.4265; train_chrom_access_recon_loss: 4167932.6818; train_global_loss: 23418602.1818; train_optim_loss: 23418602.1818; val_kl_reg_loss: 25281.6899; val_edge_recon_loss: 631522.2812; val_gene_expr_recon_loss: 18259951.2500; val_masked_gp_l1_reg_loss: 99744.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71328.4531; val_chrom_access_recon_loss: 4072952.7812; val_global_loss: 23160780.0000; val_optim_loss: 23160780.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8732; val_auprc_score: 0.8315; val_best_acc_score: 0.8106; val_best_f1_score: 0.8332; train_kl_reg_loss: 32223.8998; train_edge_recon_loss: 625654.9640; train_gene_expr_recon_loss: 18356816.9091; train_masked_gp_l1_reg_loss: 99120.0559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70339.6876; train_chrom_access_recon_loss: 4162825.3788; train_global_loss: 23346981.0303; train_optim_loss: 23346981.0303; val_kl_reg_loss: 29313.0603; val_edge_recon_loss: 619866.1484; val_gene_expr_recon_loss: 18455508.5000; val_masked_gp_l1_reg_loss: 98516.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69297.2969; val_chrom_access_recon_loss: 4127760.9688; val_global_loss: 23400262.5000; val_optim_loss: 23400262.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8777; val_auprc_score: 0.8498; val_best_acc_score: 0.8111; val_best_f1_score: 0.8332; train_kl_reg_loss: 34949.4070; train_edge_recon_loss: 613389.3911; train_gene_expr_recon_loss: 18316537.6364; train_masked_gp_l1_reg_loss: 97949.6044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68379.8138; train_chrom_access_recon_loss: 4154257.9773; train_global_loss: 23285463.7576; train_optim_loss: 23285463.7576; val_kl_reg_loss: 33207.4141; val_edge_recon_loss: 613787.5547; val_gene_expr_recon_loss: 18284427.5000; val_masked_gp_l1_reg_loss: 97363.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67625.4844; val_chrom_access_recon_loss: 4090958.9375; val_global_loss: 23187371.2500; val_optim_loss: 23187371.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8841; val_auprc_score: 0.8501; val_best_acc_score: 0.8122; val_best_f1_score: 0.8338; train_kl_reg_loss: 37613.8812; train_edge_recon_loss: 606935.8324; train_gene_expr_recon_loss: 18283904.7879; train_masked_gp_l1_reg_loss: 96681.7461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66820.9188; train_chrom_access_recon_loss: 4151497.1136; train_global_loss: 23243454.2121; train_optim_loss: 23243454.2121; val_kl_reg_loss: 36002.2788; val_edge_recon_loss: 603461.5156; val_gene_expr_recon_loss: 18210378.0000; val_masked_gp_l1_reg_loss: 96039.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66412.6016; val_chrom_access_recon_loss: 4094805.0000; val_global_loss: 23107099.0000; val_optim_loss: 23107099.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8848; val_auprc_score: 0.8453; val_best_acc_score: 0.8192; val_best_f1_score: 0.8361; train_kl_reg_loss: 39530.7691; train_edge_recon_loss: 601744.8589; train_gene_expr_recon_loss: 18241935.5758; train_masked_gp_l1_reg_loss: 95429.4833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65704.5133; train_chrom_access_recon_loss: 4147103.3182; train_global_loss: 23191448.3333; train_optim_loss: 23191448.3333; val_kl_reg_loss: 38935.5107; val_edge_recon_loss: 601996.9062; val_gene_expr_recon_loss: 18281922.7500; val_masked_gp_l1_reg_loss: 94847.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65181.9805; val_chrom_access_recon_loss: 4106624.5625; val_global_loss: 23189509.2500; val_optim_loss: 23189509.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8820; val_auprc_score: 0.8533; val_best_acc_score: 0.8079; val_best_f1_score: 0.8296; train_kl_reg_loss: 40906.6793; train_edge_recon_loss: 598889.5360; train_gene_expr_recon_loss: 18218142.8182; train_masked_gp_l1_reg_loss: 94301.7933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64487.4391; train_chrom_access_recon_loss: 4138506.0417; train_global_loss: 23155234.5152; train_optim_loss: 23155234.5152; val_kl_reg_loss: 39540.2778; val_edge_recon_loss: 604760.7734; val_gene_expr_recon_loss: 18141983.5000; val_masked_gp_l1_reg_loss: 93911.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64313.8086; val_chrom_access_recon_loss: 4081752.3438; val_global_loss: 23026263.2500; val_optim_loss: 23026263.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8843; val_auprc_score: 0.8516; val_best_acc_score: 0.8135; val_best_f1_score: 0.8311; train_kl_reg_loss: 41952.4084; train_edge_recon_loss: 596976.9792; train_gene_expr_recon_loss: 18188968.6364; train_masked_gp_l1_reg_loss: 93327.7874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63859.2738; train_chrom_access_recon_loss: 4125763.8030; train_global_loss: 23110849.2727; train_optim_loss: 23110849.2727; val_kl_reg_loss: 40195.2568; val_edge_recon_loss: 605953.5312; val_gene_expr_recon_loss: 17994252.5000; val_masked_gp_l1_reg_loss: 92907.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63417.5000; val_chrom_access_recon_loss: 4014583.7500; val_global_loss: 22811309.7500; val_optim_loss: 22811309.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8991; val_auprc_score: 0.8782; val_best_acc_score: 0.8262; val_best_f1_score: 0.8399; train_kl_reg_loss: 42450.4555; train_edge_recon_loss: 594979.8153; train_gene_expr_recon_loss: 18167501.8485; train_masked_gp_l1_reg_loss: 92430.2810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63195.3737; train_chrom_access_recon_loss: 4113734.3977; train_global_loss: 23074292.1212; train_optim_loss: 23074292.1212; val_kl_reg_loss: 41956.7144; val_edge_recon_loss: 595806.8594; val_gene_expr_recon_loss: 18219437.7500; val_masked_gp_l1_reg_loss: 92065.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62788.6445; val_chrom_access_recon_loss: 4087420.3438; val_global_loss: 23099475.0000; val_optim_loss: 23099475.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8980; val_auprc_score: 0.8746; val_best_acc_score: 0.8264; val_best_f1_score: 0.8400; train_kl_reg_loss: 43041.3307; train_edge_recon_loss: 594513.1335; train_gene_expr_recon_loss: 18121955.7576; train_masked_gp_l1_reg_loss: 91668.2230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62455.8035; train_chrom_access_recon_loss: 4103234.8750; train_global_loss: 23016869.2424; train_optim_loss: 23016869.2424; val_kl_reg_loss: 42529.7148; val_edge_recon_loss: 595635.4219; val_gene_expr_recon_loss: 17844447.0000; val_masked_gp_l1_reg_loss: 91260.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62329.8438; val_chrom_access_recon_loss: 3999199.5938; val_global_loss: 22635402.0000; val_optim_loss: 22635402.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8992; val_auprc_score: 0.8698; val_best_acc_score: 0.8283; val_best_f1_score: 0.8407; train_kl_reg_loss: 43451.6148; train_edge_recon_loss: 592512.6894; train_gene_expr_recon_loss: 18117413.6970; train_masked_gp_l1_reg_loss: 90958.0239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61865.3176; train_chrom_access_recon_loss: 4098047.1212; train_global_loss: 23004248.5152; train_optim_loss: 23004248.5152; val_kl_reg_loss: 42651.3999; val_edge_recon_loss: 601523.9375; val_gene_expr_recon_loss: 18082027.0000; val_masked_gp_l1_reg_loss: 90756.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61759.2266; val_chrom_access_recon_loss: 4066428.8125; val_global_loss: 22945147.2500; val_optim_loss: 22945147.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9135; val_auprc_score: 0.8890; val_best_acc_score: 0.8466; val_best_f1_score: 0.8575; train_kl_reg_loss: 43875.2904; train_edge_recon_loss: 590816.5568; train_gene_expr_recon_loss: 18092077.3333; train_masked_gp_l1_reg_loss: 90413.6344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61485.5787; train_chrom_access_recon_loss: 4093994.9621; train_global_loss: 22972663.1515; train_optim_loss: 22972663.1515; val_kl_reg_loss: 43339.1899; val_edge_recon_loss: 586863.3359; val_gene_expr_recon_loss: 18114656.2500; val_masked_gp_l1_reg_loss: 90297.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61333.7031; val_chrom_access_recon_loss: 4035208.0938; val_global_loss: 22931699.0000; val_optim_loss: 22931699.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9103; val_auprc_score: 0.8883; val_best_acc_score: 0.8372; val_best_f1_score: 0.8501; train_kl_reg_loss: 44074.9979; train_edge_recon_loss: 591345.9205; train_gene_expr_recon_loss: 18062056.8788; train_masked_gp_l1_reg_loss: 89988.3826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60854.0133; train_chrom_access_recon_loss: 4097178.0189; train_global_loss: 22945498.2424; train_optim_loss: 22945498.2424; val_kl_reg_loss: 43801.7842; val_edge_recon_loss: 594668.1406; val_gene_expr_recon_loss: 18150776.5000; val_masked_gp_l1_reg_loss: 89549.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60309.3203; val_chrom_access_recon_loss: 4106339.9062; val_global_loss: 23045445.7500; val_optim_loss: 23045445.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9144; val_auprc_score: 0.8886; val_best_acc_score: 0.8463; val_best_f1_score: 0.8567; train_kl_reg_loss: 44496.9732; train_edge_recon_loss: 588177.9337; train_gene_expr_recon_loss: 18053304.8788; train_masked_gp_l1_reg_loss: 89498.4833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59922.6946; train_chrom_access_recon_loss: 4088043.8333; train_global_loss: 22923444.8788; train_optim_loss: 22923444.8788; val_kl_reg_loss: 44701.7812; val_edge_recon_loss: 587171.4219; val_gene_expr_recon_loss: 18005930.2500; val_masked_gp_l1_reg_loss: 89521.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59667.3125; val_chrom_access_recon_loss: 4063069.1250; val_global_loss: 22850062.7500; val_optim_loss: 22850062.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9111; val_auprc_score: 0.8884; val_best_acc_score: 0.8412; val_best_f1_score: 0.8533; train_kl_reg_loss: 44987.9313; train_edge_recon_loss: 589194.6051; train_gene_expr_recon_loss: 18024200.6667; train_masked_gp_l1_reg_loss: 87723.0050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52028.5771; train_chrom_access_recon_loss: 4078684.3258; train_global_loss: 22876819.3030; train_optim_loss: 22876819.3030; val_kl_reg_loss: 44880.2734; val_edge_recon_loss: 590503.1875; val_gene_expr_recon_loss: 18020679.7500; val_masked_gp_l1_reg_loss: 87055.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50085.7031; val_chrom_access_recon_loss: 4000909.2188; val_global_loss: 22794115.0000; val_optim_loss: 22794115.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9113; val_auprc_score: 0.8875; val_best_acc_score: 0.8428; val_best_f1_score: 0.8541; train_kl_reg_loss: 45263.2189; train_edge_recon_loss: 589099.3324; train_gene_expr_recon_loss: 18001575.1515; train_masked_gp_l1_reg_loss: 86899.5884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49694.7408; train_chrom_access_recon_loss: 4076233.3068; train_global_loss: 22848765.3939; train_optim_loss: 22848765.3939; val_kl_reg_loss: 44717.7002; val_edge_recon_loss: 595138.9219; val_gene_expr_recon_loss: 17952461.5000; val_masked_gp_l1_reg_loss: 86783.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49369.9766; val_chrom_access_recon_loss: 4030378.0312; val_global_loss: 22758850.2500; val_optim_loss: 22758850.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9161; val_auprc_score: 0.8880; val_best_acc_score: 0.8506; val_best_f1_score: 0.8610; train_kl_reg_loss: 45430.4841; train_edge_recon_loss: 585433.9602; train_gene_expr_recon_loss: 17996707.3939; train_masked_gp_l1_reg_loss: 86718.5431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49171.2461; train_chrom_access_recon_loss: 4080835.7576; train_global_loss: 22844297.3636; train_optim_loss: 22844297.3636; val_kl_reg_loss: 44808.8662; val_edge_recon_loss: 582031.7578; val_gene_expr_recon_loss: 17878629.2500; val_masked_gp_l1_reg_loss: 86674.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48945.4531; val_chrom_access_recon_loss: 3991146.1562; val_global_loss: 22632236.0000; val_optim_loss: 22632236.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9211; val_auprc_score: 0.9013; val_best_acc_score: 0.8503; val_best_f1_score: 0.8602; train_kl_reg_loss: 45638.8954; train_edge_recon_loss: 586987.4905; train_gene_expr_recon_loss: 17992976.7273; train_masked_gp_l1_reg_loss: 86634.4536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48839.0379; train_chrom_access_recon_loss: 4077922.5947; train_global_loss: 22838999.1212; train_optim_loss: 22838999.1212; val_kl_reg_loss: 45220.9771; val_edge_recon_loss: 595260.7969; val_gene_expr_recon_loss: 18206965.0000; val_masked_gp_l1_reg_loss: 86585.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48677.9102; val_chrom_access_recon_loss: 4063241.3750; val_global_loss: 23045952.2500; val_optim_loss: 23045952.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9169; val_auprc_score: 0.8935; val_best_acc_score: 0.8506; val_best_f1_score: 0.8604; train_kl_reg_loss: 45782.4649; train_edge_recon_loss: 584619.7898; train_gene_expr_recon_loss: 17986338.4242; train_masked_gp_l1_reg_loss: 86553.6590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48570.8430; train_chrom_access_recon_loss: 4079143.1326; train_global_loss: 22831008.2424; train_optim_loss: 22831008.2424; val_kl_reg_loss: 45220.6353; val_edge_recon_loss: 589784.9609; val_gene_expr_recon_loss: 18164953.0000; val_masked_gp_l1_reg_loss: 86497.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48454.4102; val_chrom_access_recon_loss: 4008188.5625; val_global_loss: 22943099.2500; val_optim_loss: 22943099.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9188; val_auprc_score: 0.8958; val_best_acc_score: 0.8466; val_best_f1_score: 0.8573; train_kl_reg_loss: 45776.8725; train_edge_recon_loss: 588202.9176; train_gene_expr_recon_loss: 17992936.8182; train_masked_gp_l1_reg_loss: 86469.8456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48346.8105; train_chrom_access_recon_loss: 4079378.0303; train_global_loss: 22841111.0606; train_optim_loss: 22841111.0606; val_kl_reg_loss: 45439.3970; val_edge_recon_loss: 594934.4453; val_gene_expr_recon_loss: 18073068.5000; val_masked_gp_l1_reg_loss: 86453.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48240.8047; val_chrom_access_recon_loss: 4042695.7500; val_global_loss: 22890832.2500; val_optim_loss: 22890832.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9141; val_auprc_score: 0.8901; val_best_acc_score: 0.8458; val_best_f1_score: 0.8585; train_kl_reg_loss: 46052.4234; train_edge_recon_loss: 586827.2178; train_gene_expr_recon_loss: 17998165.8182; train_masked_gp_l1_reg_loss: 86432.8991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48174.6143; train_chrom_access_recon_loss: 4077667.2538; train_global_loss: 22843320.3636; train_optim_loss: 22843320.3636; val_kl_reg_loss: 45806.8662; val_edge_recon_loss: 588366.8984; val_gene_expr_recon_loss: 17867994.7500; val_masked_gp_l1_reg_loss: 86413.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48091.9570; val_chrom_access_recon_loss: 4000983.2188; val_global_loss: 22637657.2500; val_optim_loss: 22637657.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9200; val_auprc_score: 0.8950; val_best_acc_score: 0.8506; val_best_f1_score: 0.8602; train_kl_reg_loss: 46116.3053; train_edge_recon_loss: 586516.3816; train_gene_expr_recon_loss: 17997788.4545; train_masked_gp_l1_reg_loss: 86224.6565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47322.5208; train_chrom_access_recon_loss: 4079901.2386; train_global_loss: 22843869.6364; train_optim_loss: 22843869.6364; val_kl_reg_loss: 45728.3066; val_edge_recon_loss: 588026.1172; val_gene_expr_recon_loss: 17899605.5000; val_masked_gp_l1_reg_loss: 86137.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47141.9727; val_chrom_access_recon_loss: 4010495.8125; val_global_loss: 22677136.2500; val_optim_loss: 22677136.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9132; val_auprc_score: 0.8891; val_best_acc_score: 0.8444; val_best_f1_score: 0.8567; train_kl_reg_loss: 46134.0578; train_edge_recon_loss: 585905.3636; train_gene_expr_recon_loss: 17989144.3636; train_masked_gp_l1_reg_loss: 86104.4229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47104.3479; train_chrom_access_recon_loss: 4079053.7576; train_global_loss: 22833446.3030; train_optim_loss: 22833446.3030; val_kl_reg_loss: 45717.0503; val_edge_recon_loss: 593472.5469; val_gene_expr_recon_loss: 17959918.7500; val_masked_gp_l1_reg_loss: 86079.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47067.9375; val_chrom_access_recon_loss: 4041782.5312; val_global_loss: 22774038.7500; val_optim_loss: 22774038.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9117; val_auprc_score: 0.8876; val_best_acc_score: 0.8444; val_best_f1_score: 0.8567; train_kl_reg_loss: 46207.5208; train_edge_recon_loss: 587147.6487; train_gene_expr_recon_loss: 17982285.6970; train_masked_gp_l1_reg_loss: 86066.2214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47037.6142; train_chrom_access_recon_loss: 4075055.6402; train_global_loss: 22823800.3333; train_optim_loss: 22823800.3333; val_kl_reg_loss: 45422.0962; val_edge_recon_loss: 595964.9844; val_gene_expr_recon_loss: 17859681.7500; val_masked_gp_l1_reg_loss: 86055.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47014.1562; val_chrom_access_recon_loss: 3982916.2500; val_global_loss: 22617055.0000; val_optim_loss: 22617055.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9145; val_auprc_score: 0.8919; val_best_acc_score: 0.8420; val_best_f1_score: 0.8549; train_kl_reg_loss: 46189.1037; train_edge_recon_loss: 584473.5767; train_gene_expr_recon_loss: 17984611.5152; train_masked_gp_l1_reg_loss: 86045.2214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46993.9982; train_chrom_access_recon_loss: 4074805.5644; train_global_loss: 22823118.7879; train_optim_loss: 22823118.7879; val_kl_reg_loss: 45778.3364; val_edge_recon_loss: 590253.6250; val_gene_expr_recon_loss: 17893647.2500; val_masked_gp_l1_reg_loss: 86039.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46971.3711; val_chrom_access_recon_loss: 4032196.7188; val_global_loss: 22694888.0000; val_optim_loss: 22694888.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9111; val_auprc_score: 0.8895; val_best_acc_score: 0.8436; val_best_f1_score: 0.8546; train_kl_reg_loss: 46195.0170; train_edge_recon_loss: 586621.0237; train_gene_expr_recon_loss: 17976617.9091; train_masked_gp_l1_reg_loss: 86032.7288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46954.3275; train_chrom_access_recon_loss: 4076692.1894; train_global_loss: 22819113.3333; train_optim_loss: 22819113.3333; val_kl_reg_loss: 45653.9419; val_edge_recon_loss: 596969.3672; val_gene_expr_recon_loss: 17996874.2500; val_masked_gp_l1_reg_loss: 86026.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46935.1055; val_chrom_access_recon_loss: 4016023.3438; val_global_loss: 22788482.5000; val_optim_loss: 22788482.5000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9153; val_auprc_score: 0.8938; val_best_acc_score: 0.8495; val_best_f1_score: 0.8594; train_kl_reg_loss: 46167.1040; train_edge_recon_loss: 586244.4280; train_gene_expr_recon_loss: 17984843.3939; train_masked_gp_l1_reg_loss: 86021.8757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46917.4961; train_chrom_access_recon_loss: 4078950.6667; train_global_loss: 22829144.9091; train_optim_loss: 22829144.9091; val_kl_reg_loss: 45462.2432; val_edge_recon_loss: 594390.1797; val_gene_expr_recon_loss: 17992391.0000; val_masked_gp_l1_reg_loss: 86016.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46900.1719; val_chrom_access_recon_loss: 3997937.8750; val_global_loss: 22763097.5000; val_optim_loss: 22763097.5000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9168; val_auprc_score: 0.8883; val_best_acc_score: 0.8541; val_best_f1_score: 0.8632; train_kl_reg_loss: 46216.6890; train_edge_recon_loss: 586940.8163; train_gene_expr_recon_loss: 17991513.5455; train_masked_gp_l1_reg_loss: 86011.2997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46884.3060; train_chrom_access_recon_loss: 4078428.8523; train_global_loss: 22835995.5152; train_optim_loss: 22835995.5152; val_kl_reg_loss: 45771.4409; val_edge_recon_loss: 585602.6719; val_gene_expr_recon_loss: 18005301.7500; val_masked_gp_l1_reg_loss: 86003.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46866.3281; val_chrom_access_recon_loss: 4039850.5938; val_global_loss: 22809396.2500; val_optim_loss: 22809396.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9126; val_auprc_score: 0.8851; val_best_acc_score: 0.8452; val_best_f1_score: 0.8559; train_kl_reg_loss: 46230.5173; train_edge_recon_loss: 585466.4441; train_gene_expr_recon_loss: 17996360.0303; train_masked_gp_l1_reg_loss: 85986.1552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46788.2641; train_chrom_access_recon_loss: 4078513.5265; train_global_loss: 22839345.0000; train_optim_loss: 22839345.0000; val_kl_reg_loss: 45955.7075; val_edge_recon_loss: 588509.6875; val_gene_expr_recon_loss: 17874424.0000; val_masked_gp_l1_reg_loss: 85977.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46770.6328; val_chrom_access_recon_loss: 4030734.5000; val_global_loss: 22672372.2500; val_optim_loss: 22672372.2500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9083; val_auprc_score: 0.8808; val_best_acc_score: 0.8401; val_best_f1_score: 0.8520; train_kl_reg_loss: 46232.8219; train_edge_recon_loss: 586953.5388; train_gene_expr_recon_loss: 17978861.4848; train_masked_gp_l1_reg_loss: 85974.7750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46767.0630; train_chrom_access_recon_loss: 4072303.7955; train_global_loss: 22817093.3636; train_optim_loss: 22817093.3636; val_kl_reg_loss: 45996.9614; val_edge_recon_loss: 598330.0703; val_gene_expr_recon_loss: 18156997.2500; val_masked_gp_l1_reg_loss: 85971.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46763.6445; val_chrom_access_recon_loss: 4061697.4062; val_global_loss: 22995757.5000; val_optim_loss: 22995757.5000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9090; val_auprc_score: 0.8813; val_best_acc_score: 0.8444; val_best_f1_score: 0.8554; train_kl_reg_loss: 46272.6932; train_edge_recon_loss: 585636.5786; train_gene_expr_recon_loss: 17980255.6970; train_masked_gp_l1_reg_loss: 85970.4330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46760.9554; train_chrom_access_recon_loss: 4075443.2992; train_global_loss: 22820339.8182; train_optim_loss: 22820339.8182; val_kl_reg_loss: 45685.3618; val_edge_recon_loss: 594080.2266; val_gene_expr_recon_loss: 17858107.7500; val_masked_gp_l1_reg_loss: 85968.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46758.0430; val_chrom_access_recon_loss: 4000087.1250; val_global_loss: 22630686.2500; val_optim_loss: 22630686.2500
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9154; val_auprc_score: 0.8944; val_best_acc_score: 0.8452; val_best_f1_score: 0.8578; train_kl_reg_loss: 46238.4917; train_edge_recon_loss: 586721.6638; train_gene_expr_recon_loss: 17991434.6061; train_masked_gp_l1_reg_loss: 85967.7543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46755.9231; train_chrom_access_recon_loss: 4078820.7538; train_global_loss: 22835939.0909; train_optim_loss: 22835939.0909; val_kl_reg_loss: 45706.8379; val_edge_recon_loss: 593811.1016; val_gene_expr_recon_loss: 18069810.2500; val_masked_gp_l1_reg_loss: 85966.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46753.3711; val_chrom_access_recon_loss: 4032741.1562; val_global_loss: 22874789.2500; val_optim_loss: 22874789.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 8 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9160
val AUPRC score: 0.8970
val best accuracy score: 0.8450
val best F1 score: 0.8567
val target rna MSE score: 1.3939
val source rna MSE score: 0.8043
val target atac MSE score: 0.4585
val source atac MSE score: 0.1937
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
