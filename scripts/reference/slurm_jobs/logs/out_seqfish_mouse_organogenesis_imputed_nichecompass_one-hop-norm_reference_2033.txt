[True]
Run timestamp: 21072023_200004_2033.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '24', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_2033']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 635067
Number of validation edges: 70562
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9041; val_auprc_score: 0.9813; val_best_acc_score: 0.8582; val_best_f1_score: 0.9234; train_kl_reg_loss: 239425.1057; train_edge_recon_loss: 118736.7108; train_gene_expr_recon_loss: 4905186.2289; train_masked_gp_l1_reg_loss: 8230.5989; train_group_lasso_reg_loss: 0.0000; train_global_loss: 5271578.5986; train_optim_loss: 5271578.5986; val_kl_reg_loss: 223056.3333; val_edge_recon_loss: 118412.4352; val_gene_expr_recon_loss: 4217046.3043; val_masked_gp_l1_reg_loss: 9604.4658; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4568119.5725; val_optim_loss: 4568119.5725
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8864; val_auprc_score: 0.9775; val_best_acc_score: 0.8630; val_best_f1_score: 0.9252; train_kl_reg_loss: 109305.5420; train_edge_recon_loss: 118732.1482; train_gene_expr_recon_loss: 3839939.0948; train_masked_gp_l1_reg_loss: 9466.7033; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4077443.4926; train_optim_loss: 4077443.4926; val_kl_reg_loss: 52307.3221; val_edge_recon_loss: 119817.1296; val_gene_expr_recon_loss: 1387478.5290; val_masked_gp_l1_reg_loss: 9672.3320; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1569275.3569; val_optim_loss: 1569275.3569
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8808; val_auprc_score: 0.9756; val_best_acc_score: 0.8751; val_best_f1_score: 0.9288; train_kl_reg_loss: 41866.0282; train_edge_recon_loss: 117915.3230; train_gene_expr_recon_loss: 1142296.5828; train_masked_gp_l1_reg_loss: 9713.6440; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1311791.5743; train_optim_loss: 1311791.5743; val_kl_reg_loss: 35429.0292; val_edge_recon_loss: 118531.6429; val_gene_expr_recon_loss: 934899.5879; val_masked_gp_l1_reg_loss: 9774.7930; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1098635.0091; val_optim_loss: 1098635.0091
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8917; val_auprc_score: 0.9755; val_best_acc_score: 0.9067; val_best_f1_score: 0.9466; train_kl_reg_loss: 32548.5752; train_edge_recon_loss: 114368.4366; train_gene_expr_recon_loss: 915947.5913; train_masked_gp_l1_reg_loss: 9775.8550; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1072640.4600; train_optim_loss: 1072640.4600; val_kl_reg_loss: 29030.6825; val_edge_recon_loss: 115279.3274; val_gene_expr_recon_loss: 901026.3279; val_masked_gp_l1_reg_loss: 9797.4404; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1055133.8143; val_optim_loss: 1055133.8143
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8968; val_auprc_score: 0.9762; val_best_acc_score: 0.9166; val_best_f1_score: 0.9525; train_kl_reg_loss: 27794.4461; train_edge_recon_loss: 110112.1470; train_gene_expr_recon_loss: 888233.8066; train_masked_gp_l1_reg_loss: 9780.4709; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1035920.8699; train_optim_loss: 1035920.8699; val_kl_reg_loss: 25410.8179; val_edge_recon_loss: 109044.4081; val_gene_expr_recon_loss: 876846.9665; val_masked_gp_l1_reg_loss: 9736.3691; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1021038.5707; val_optim_loss: 1021038.5707
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9041; val_auprc_score: 0.9775; val_best_acc_score: 0.9191; val_best_f1_score: 0.9537; train_kl_reg_loss: 22944.5804; train_edge_recon_loss: 105551.4163; train_gene_expr_recon_loss: 865811.1834; train_masked_gp_l1_reg_loss: 9678.9143; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1003986.0935; train_optim_loss: 1003986.0935; val_kl_reg_loss: 20956.6977; val_edge_recon_loss: 105666.1843; val_gene_expr_recon_loss: 857310.2083; val_masked_gp_l1_reg_loss: 9609.4092; val_group_lasso_reg_loss: 0.0000; val_global_loss: 993542.5208; val_optim_loss: 993542.5208
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8845; val_auprc_score: 0.9717; val_best_acc_score: 0.9050; val_best_f1_score: 0.9456; train_kl_reg_loss: 19359.9603; train_edge_recon_loss: 104703.9850; train_gene_expr_recon_loss: 870340.6809; train_masked_gp_l1_reg_loss: 9360.7610; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1003765.3864; train_optim_loss: 1003765.3864; val_kl_reg_loss: 17125.7558; val_edge_recon_loss: 103487.8744; val_gene_expr_recon_loss: 859532.6612; val_masked_gp_l1_reg_loss: 9115.9385; val_group_lasso_reg_loss: 0.0000; val_global_loss: 989262.2310; val_optim_loss: 989262.2310
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8978; val_auprc_score: 0.9755; val_best_acc_score: 0.9148; val_best_f1_score: 0.9514; train_kl_reg_loss: 14164.5827; train_edge_recon_loss: 97211.8708; train_gene_expr_recon_loss: 837593.9501; train_masked_gp_l1_reg_loss: 8882.7710; train_group_lasso_reg_loss: 0.0000; train_global_loss: 957853.1732; train_optim_loss: 957853.1732; val_kl_reg_loss: 11947.1212; val_edge_recon_loss: 95979.2926; val_gene_expr_recon_loss: 827020.4629; val_masked_gp_l1_reg_loss: 8609.0186; val_group_lasso_reg_loss: 0.0000; val_global_loss: 943555.8786; val_optim_loss: 943555.8786
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9012; val_auprc_score: 0.9768; val_best_acc_score: 0.9180; val_best_f1_score: 0.9535; train_kl_reg_loss: 10360.5511; train_edge_recon_loss: 92516.0669; train_gene_expr_recon_loss: 818270.3097; train_masked_gp_l1_reg_loss: 8286.9848; train_group_lasso_reg_loss: 0.0000; train_global_loss: 929433.9121; train_optim_loss: 929433.9121; val_kl_reg_loss: 8941.8800; val_edge_recon_loss: 90089.3973; val_gene_expr_recon_loss: 810971.2772; val_masked_gp_l1_reg_loss: 7939.2554; val_group_lasso_reg_loss: 0.0000; val_global_loss: 917941.8043; val_optim_loss: 917941.8043
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9161; val_auprc_score: 0.9797; val_best_acc_score: 0.9259; val_best_f1_score: 0.9576; train_kl_reg_loss: 8111.0840; train_edge_recon_loss: 88219.6471; train_gene_expr_recon_loss: 804072.1588; train_masked_gp_l1_reg_loss: 7643.6704; train_group_lasso_reg_loss: 0.0000; train_global_loss: 908046.5606; train_optim_loss: 908046.5606; val_kl_reg_loss: 7485.1319; val_edge_recon_loss: 85927.1950; val_gene_expr_recon_loss: 797623.6404; val_masked_gp_l1_reg_loss: 7362.9775; val_group_lasso_reg_loss: 0.0000; val_global_loss: 898398.9692; val_optim_loss: 898398.9692
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9271; val_auprc_score: 0.9827; val_best_acc_score: 0.9353; val_best_f1_score: 0.9628; train_kl_reg_loss: 7140.7161; train_edge_recon_loss: 83983.8337; train_gene_expr_recon_loss: 790024.8396; train_masked_gp_l1_reg_loss: 7100.8482; train_group_lasso_reg_loss: 0.0000; train_global_loss: 888250.2360; train_optim_loss: 888250.2360; val_kl_reg_loss: 6818.9412; val_edge_recon_loss: 82167.8243; val_gene_expr_recon_loss: 784407.1857; val_masked_gp_l1_reg_loss: 6836.8823; val_group_lasso_reg_loss: 0.0000; val_global_loss: 880230.8270; val_optim_loss: 880230.8270
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9354; val_auprc_score: 0.9848; val_best_acc_score: 0.9418; val_best_f1_score: 0.9666; train_kl_reg_loss: 6599.4834; train_edge_recon_loss: 82232.7353; train_gene_expr_recon_loss: 778462.8720; train_masked_gp_l1_reg_loss: 6626.4145; train_group_lasso_reg_loss: 0.0000; train_global_loss: 873921.5051; train_optim_loss: 873921.5051; val_kl_reg_loss: 6286.1801; val_edge_recon_loss: 81037.0136; val_gene_expr_recon_loss: 773646.5987; val_masked_gp_l1_reg_loss: 6424.3057; val_group_lasso_reg_loss: 0.0000; val_global_loss: 867394.1060; val_optim_loss: 867394.1060
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9494; val_auprc_score: 0.9883; val_best_acc_score: 0.9470; val_best_f1_score: 0.9695; train_kl_reg_loss: 6291.0719; train_edge_recon_loss: 81205.2518; train_gene_expr_recon_loss: 768849.8766; train_masked_gp_l1_reg_loss: 6243.4288; train_group_lasso_reg_loss: 0.0000; train_global_loss: 862589.6282; train_optim_loss: 862589.6282; val_kl_reg_loss: 6130.5977; val_edge_recon_loss: 79929.4587; val_gene_expr_recon_loss: 764629.6821; val_masked_gp_l1_reg_loss: 6095.1172; val_group_lasso_reg_loss: 0.0000; val_global_loss: 856784.8632; val_optim_loss: 856784.8632
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9639; val_auprc_score: 0.9920; val_best_acc_score: 0.9559; val_best_f1_score: 0.9745; train_kl_reg_loss: 6185.8328; train_edge_recon_loss: 80011.6992; train_gene_expr_recon_loss: 760977.3397; train_masked_gp_l1_reg_loss: 5947.1422; train_group_lasso_reg_loss: 0.0000; train_global_loss: 853122.0144; train_optim_loss: 853122.0144; val_kl_reg_loss: 6176.7429; val_edge_recon_loss: 78960.0979; val_gene_expr_recon_loss: 756662.6205; val_masked_gp_l1_reg_loss: 5797.3511; val_group_lasso_reg_loss: 0.0000; val_global_loss: 847596.8361; val_optim_loss: 847596.8361
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9628; val_auprc_score: 0.9915; val_best_acc_score: 0.9489; val_best_f1_score: 0.9703; train_kl_reg_loss: 6387.5188; train_edge_recon_loss: 80117.3165; train_gene_expr_recon_loss: 762903.2921; train_masked_gp_l1_reg_loss: 5742.0169; train_group_lasso_reg_loss: 0.0000; train_global_loss: 855150.1438; train_optim_loss: 855150.1438; val_kl_reg_loss: 6778.4402; val_edge_recon_loss: 79407.2777; val_gene_expr_recon_loss: 765207.6920; val_masked_gp_l1_reg_loss: 5822.0049; val_group_lasso_reg_loss: 0.0000; val_global_loss: 857215.4094; val_optim_loss: 857215.4094
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9694; val_auprc_score: 0.9928; val_best_acc_score: 0.9600; val_best_f1_score: 0.9768; train_kl_reg_loss: 6315.0915; train_edge_recon_loss: 79651.6614; train_gene_expr_recon_loss: 756565.5852; train_masked_gp_l1_reg_loss: 5510.1451; train_group_lasso_reg_loss: 0.0000; train_global_loss: 848042.4828; train_optim_loss: 848042.4828; val_kl_reg_loss: 6210.1853; val_edge_recon_loss: 78739.8194; val_gene_expr_recon_loss: 753394.9991; val_masked_gp_l1_reg_loss: 5274.9023; val_group_lasso_reg_loss: 0.0000; val_global_loss: 843619.8813; val_optim_loss: 843619.8813
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9698; val_auprc_score: 0.9931; val_best_acc_score: 0.9607; val_best_f1_score: 0.9772; train_kl_reg_loss: 6082.2729; train_edge_recon_loss: 79422.0904; train_gene_expr_recon_loss: 751409.1900; train_masked_gp_l1_reg_loss: 5096.1939; train_group_lasso_reg_loss: 0.0000; train_global_loss: 842009.7479; train_optim_loss: 842009.7479; val_kl_reg_loss: 5884.3615; val_edge_recon_loss: 78333.9538; val_gene_expr_recon_loss: 751752.1884; val_masked_gp_l1_reg_loss: 4937.1699; val_group_lasso_reg_loss: 0.0000; val_global_loss: 840907.6929; val_optim_loss: 840907.6929
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9702; val_auprc_score: 0.9930; val_best_acc_score: 0.9623; val_best_f1_score: 0.9781; train_kl_reg_loss: 6074.8461; train_edge_recon_loss: 79116.5697; train_gene_expr_recon_loss: 748746.8607; train_masked_gp_l1_reg_loss: 4789.6673; train_group_lasso_reg_loss: 0.0000; train_global_loss: 838727.9433; train_optim_loss: 838727.9433; val_kl_reg_loss: 5971.5361; val_edge_recon_loss: 77994.4532; val_gene_expr_recon_loss: 748670.7138; val_masked_gp_l1_reg_loss: 4649.0850; val_group_lasso_reg_loss: 0.0000; val_global_loss: 837285.7645; val_optim_loss: 837285.7645
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9722; val_auprc_score: 0.9936; val_best_acc_score: 0.9645; val_best_f1_score: 0.9794; train_kl_reg_loss: 6064.4227; train_edge_recon_loss: 78949.4792; train_gene_expr_recon_loss: 747604.4914; train_masked_gp_l1_reg_loss: 4550.9218; train_group_lasso_reg_loss: 0.0000; train_global_loss: 837169.3151; train_optim_loss: 837169.3151; val_kl_reg_loss: 5882.1668; val_edge_recon_loss: 77283.7892; val_gene_expr_recon_loss: 748066.0924; val_masked_gp_l1_reg_loss: 4439.3779; val_group_lasso_reg_loss: 0.0000; val_global_loss: 835671.4212; val_optim_loss: 835671.4212
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9713; val_auprc_score: 0.9931; val_best_acc_score: 0.9634; val_best_f1_score: 0.9787; train_kl_reg_loss: 6051.7950; train_edge_recon_loss: 79037.6635; train_gene_expr_recon_loss: 747565.3154; train_masked_gp_l1_reg_loss: 4427.0319; train_group_lasso_reg_loss: 0.0000; train_global_loss: 837081.8059; train_optim_loss: 837081.8059; val_kl_reg_loss: 5974.1365; val_edge_recon_loss: 77914.1510; val_gene_expr_recon_loss: 745658.2536; val_masked_gp_l1_reg_loss: 4421.6543; val_group_lasso_reg_loss: 0.0000; val_global_loss: 833968.1676; val_optim_loss: 833968.1676
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9710; val_auprc_score: 0.9931; val_best_acc_score: 0.9632; val_best_f1_score: 0.9786; train_kl_reg_loss: 6087.9031; train_edge_recon_loss: 78929.0813; train_gene_expr_recon_loss: 745214.4110; train_masked_gp_l1_reg_loss: 4316.7211; train_group_lasso_reg_loss: 0.0000; train_global_loss: 834548.1179; train_optim_loss: 834548.1179; val_kl_reg_loss: 6125.2090; val_edge_recon_loss: 78582.7704; val_gene_expr_recon_loss: 745236.5634; val_masked_gp_l1_reg_loss: 4245.9580; val_group_lasso_reg_loss: 0.0000; val_global_loss: 834190.4801; val_optim_loss: 834190.4801
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9719; val_auprc_score: 0.9932; val_best_acc_score: 0.9629; val_best_f1_score: 0.9784; train_kl_reg_loss: 6061.2686; train_edge_recon_loss: 79060.4052; train_gene_expr_recon_loss: 745479.5747; train_masked_gp_l1_reg_loss: 4181.3238; train_group_lasso_reg_loss: 0.0000; train_global_loss: 834782.5721; train_optim_loss: 834782.5721; val_kl_reg_loss: 6139.1671; val_edge_recon_loss: 79671.4052; val_gene_expr_recon_loss: 747028.8125; val_masked_gp_l1_reg_loss: 4259.2720; val_group_lasso_reg_loss: 0.0000; val_global_loss: 837098.6386; val_optim_loss: 837098.6386
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9710; val_auprc_score: 0.9930; val_best_acc_score: 0.9634; val_best_f1_score: 0.9788; train_kl_reg_loss: 6035.7465; train_edge_recon_loss: 78809.4028; train_gene_expr_recon_loss: 744198.1466; train_masked_gp_l1_reg_loss: 4095.9468; train_group_lasso_reg_loss: 0.0000; train_global_loss: 833139.2428; train_optim_loss: 833139.2428; val_kl_reg_loss: 6110.2160; val_edge_recon_loss: 78170.1668; val_gene_expr_recon_loss: 743155.2545; val_masked_gp_l1_reg_loss: 4065.3955; val_group_lasso_reg_loss: 0.0000; val_global_loss: 831501.0109; val_optim_loss: 831501.0109
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9719; val_auprc_score: 0.9933; val_best_acc_score: 0.9647; val_best_f1_score: 0.9795; train_kl_reg_loss: 6018.5518; train_edge_recon_loss: 78660.1341; train_gene_expr_recon_loss: 743532.5725; train_masked_gp_l1_reg_loss: 3987.9835; train_group_lasso_reg_loss: 0.0000; train_global_loss: 832199.2437; train_optim_loss: 832199.2437; val_kl_reg_loss: 6012.4468; val_edge_recon_loss: 77336.4917; val_gene_expr_recon_loss: 743199.9375; val_masked_gp_l1_reg_loss: 3930.0051; val_group_lasso_reg_loss: 0.0000; val_global_loss: 830478.8750; val_optim_loss: 830478.8750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9723; val_auprc_score: 0.9934; val_best_acc_score: 0.9651; val_best_f1_score: 0.9797; train_kl_reg_loss: 6012.5509; train_edge_recon_loss: 78679.6881; train_gene_expr_recon_loss: 742898.4067; train_masked_gp_l1_reg_loss: 3910.0135; train_group_lasso_reg_loss: 0.0000; train_global_loss: 831500.6588; train_optim_loss: 831500.6588; val_kl_reg_loss: 5981.3666; val_edge_recon_loss: 78187.0404; val_gene_expr_recon_loss: 742181.0172; val_masked_gp_l1_reg_loss: 3882.0862; val_group_lasso_reg_loss: 0.0000; val_global_loss: 830231.4900; val_optim_loss: 830231.4900
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9697; val_auprc_score: 0.9926; val_best_acc_score: 0.9622; val_best_f1_score: 0.9781; train_kl_reg_loss: 5125.2260; train_edge_recon_loss: 78627.5987; train_gene_expr_recon_loss: 743638.3889; train_masked_gp_l1_reg_loss: 3789.2836; train_group_lasso_reg_loss: 0.0000; train_global_loss: 831180.4965; train_optim_loss: 831180.4965; val_kl_reg_loss: 4709.5856; val_edge_recon_loss: 78098.1858; val_gene_expr_recon_loss: 744791.9339; val_masked_gp_l1_reg_loss: 3771.7036; val_group_lasso_reg_loss: 0.0000; val_global_loss: 831371.3913; val_optim_loss: 831371.3913
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9719; val_auprc_score: 0.9934; val_best_acc_score: 0.9637; val_best_f1_score: 0.9789; train_kl_reg_loss: 4938.1917; train_edge_recon_loss: 78326.2576; train_gene_expr_recon_loss: 742625.9944; train_masked_gp_l1_reg_loss: 3770.7351; train_group_lasso_reg_loss: 0.0000; train_global_loss: 829661.1791; train_optim_loss: 829661.1791; val_kl_reg_loss: 4654.0705; val_edge_recon_loss: 78143.8039; val_gene_expr_recon_loss: 743843.9303; val_masked_gp_l1_reg_loss: 3800.8435; val_group_lasso_reg_loss: 0.0000; val_global_loss: 830442.6205; val_optim_loss: 830442.6205
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9707; val_auprc_score: 0.9931; val_best_acc_score: 0.9633; val_best_f1_score: 0.9787; train_kl_reg_loss: 4844.6238; train_edge_recon_loss: 78346.5107; train_gene_expr_recon_loss: 742511.8609; train_masked_gp_l1_reg_loss: 3778.2266; train_group_lasso_reg_loss: 0.0000; train_global_loss: 829481.2224; train_optim_loss: 829481.2224; val_kl_reg_loss: 4787.6105; val_edge_recon_loss: 78053.8504; val_gene_expr_recon_loss: 743923.5752; val_masked_gp_l1_reg_loss: 3757.2666; val_group_lasso_reg_loss: 0.0000; val_global_loss: 830522.2835; val_optim_loss: 830522.2835
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9701; val_auprc_score: 0.9930; val_best_acc_score: 0.9615; val_best_f1_score: 0.9776; train_kl_reg_loss: 4823.5536; train_edge_recon_loss: 78048.6839; train_gene_expr_recon_loss: 741999.8853; train_masked_gp_l1_reg_loss: 3757.6775; train_group_lasso_reg_loss: 0.0000; train_global_loss: 828629.8005; train_optim_loss: 828629.8005; val_kl_reg_loss: 4675.6625; val_edge_recon_loss: 78578.4995; val_gene_expr_recon_loss: 743955.9511; val_masked_gp_l1_reg_loss: 3751.7900; val_group_lasso_reg_loss: 0.0000; val_global_loss: 830961.9239; val_optim_loss: 830961.9239

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9727; val_auprc_score: 0.9938; val_best_acc_score: 0.9644; val_best_f1_score: 0.9793; train_kl_reg_loss: 4808.9341; train_edge_recon_loss: 77815.7254; train_gene_expr_recon_loss: 740446.8551; train_masked_gp_l1_reg_loss: 3638.6072; train_group_lasso_reg_loss: 0.0000; train_global_loss: 826710.1232; train_optim_loss: 826710.1232; val_kl_reg_loss: 4806.8530; val_edge_recon_loss: 77679.5940; val_gene_expr_recon_loss: 740616.4212; val_masked_gp_l1_reg_loss: 3628.1528; val_group_lasso_reg_loss: 0.0000; val_global_loss: 826730.9946; val_optim_loss: 826730.9946
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9705; val_auprc_score: 0.9923; val_best_acc_score: 0.9647; val_best_f1_score: 0.9795; train_kl_reg_loss: 4806.6512; train_edge_recon_loss: 77807.3737; train_gene_expr_recon_loss: 739949.3786; train_masked_gp_l1_reg_loss: 3627.2571; train_group_lasso_reg_loss: 0.0000; train_global_loss: 826190.6598; train_optim_loss: 826190.6598; val_kl_reg_loss: 4739.3731; val_edge_recon_loss: 77640.1311; val_gene_expr_recon_loss: 741019.3071; val_masked_gp_l1_reg_loss: 3625.5034; val_group_lasso_reg_loss: 0.0000; val_global_loss: 827024.3116; val_optim_loss: 827024.3116
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9715; val_auprc_score: 0.9934; val_best_acc_score: 0.9636; val_best_f1_score: 0.9789; train_kl_reg_loss: 4788.4456; train_edge_recon_loss: 77526.5743; train_gene_expr_recon_loss: 739952.7967; train_masked_gp_l1_reg_loss: 3631.2210; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825899.0376; train_optim_loss: 825899.0376; val_kl_reg_loss: 4749.3214; val_edge_recon_loss: 77437.3932; val_gene_expr_recon_loss: 741266.4674; val_masked_gp_l1_reg_loss: 3631.4463; val_group_lasso_reg_loss: 0.0000; val_global_loss: 827084.6241; val_optim_loss: 827084.6241
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9720; val_auprc_score: 0.9933; val_best_acc_score: 0.9656; val_best_f1_score: 0.9801; train_kl_reg_loss: 4782.0656; train_edge_recon_loss: 77437.1538; train_gene_expr_recon_loss: 739620.4777; train_masked_gp_l1_reg_loss: 3634.6146; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825474.3111; train_optim_loss: 825474.3111; val_kl_reg_loss: 4776.5580; val_edge_recon_loss: 76896.3129; val_gene_expr_recon_loss: 741906.7409; val_masked_gp_l1_reg_loss: 3633.2622; val_group_lasso_reg_loss: 0.0000; val_global_loss: 827212.8596; val_optim_loss: 827212.8596
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9715; val_auprc_score: 0.9932; val_best_acc_score: 0.9649; val_best_f1_score: 0.9797; train_kl_reg_loss: 4768.7838; train_edge_recon_loss: 77975.0899; train_gene_expr_recon_loss: 740063.6299; train_masked_gp_l1_reg_loss: 3636.3595; train_group_lasso_reg_loss: 0.0000; train_global_loss: 826443.8609; train_optim_loss: 826443.8609; val_kl_reg_loss: 4786.6791; val_edge_recon_loss: 76577.3702; val_gene_expr_recon_loss: 740784.8025; val_masked_gp_l1_reg_loss: 3641.6196; val_group_lasso_reg_loss: 0.0000; val_global_loss: 825790.4774; val_optim_loss: 825790.4774
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9715; val_auprc_score: 0.9930; val_best_acc_score: 0.9638; val_best_f1_score: 0.9790; train_kl_reg_loss: 4757.7324; train_edge_recon_loss: 78021.9412; train_gene_expr_recon_loss: 739913.2391; train_masked_gp_l1_reg_loss: 3642.4927; train_group_lasso_reg_loss: 0.0000; train_global_loss: 826335.4042; train_optim_loss: 826335.4042; val_kl_reg_loss: 4720.1616; val_edge_recon_loss: 77455.0228; val_gene_expr_recon_loss: 741838.7527; val_masked_gp_l1_reg_loss: 3644.1938; val_group_lasso_reg_loss: 0.0000; val_global_loss: 827658.1259; val_optim_loss: 827658.1259
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9715; val_auprc_score: 0.9932; val_best_acc_score: 0.9638; val_best_f1_score: 0.9790; train_kl_reg_loss: 4748.2942; train_edge_recon_loss: 77458.5702; train_gene_expr_recon_loss: 739917.8531; train_masked_gp_l1_reg_loss: 3644.6271; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825769.3437; train_optim_loss: 825769.3437; val_kl_reg_loss: 4724.1370; val_edge_recon_loss: 77834.5900; val_gene_expr_recon_loss: 740638.9058; val_masked_gp_l1_reg_loss: 3644.0791; val_group_lasso_reg_loss: 0.0000; val_global_loss: 826841.6911; val_optim_loss: 826841.6911
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9722; val_auprc_score: 0.9933; val_best_acc_score: 0.9635; val_best_f1_score: 0.9787; train_kl_reg_loss: 4737.0938; train_edge_recon_loss: 77674.6325; train_gene_expr_recon_loss: 739793.9470; train_masked_gp_l1_reg_loss: 3646.1561; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825851.8308; train_optim_loss: 825851.8308; val_kl_reg_loss: 4765.1366; val_edge_recon_loss: 78942.2199; val_gene_expr_recon_loss: 740554.0761; val_masked_gp_l1_reg_loss: 3649.5605; val_group_lasso_reg_loss: 0.0000; val_global_loss: 827910.9928; val_optim_loss: 827910.9928
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9713; val_auprc_score: 0.9930; val_best_acc_score: 0.9650; val_best_f1_score: 0.9798; train_kl_reg_loss: 4740.5359; train_edge_recon_loss: 77706.6970; train_gene_expr_recon_loss: 739653.8844; train_masked_gp_l1_reg_loss: 3647.9306; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825749.0482; train_optim_loss: 825749.0482; val_kl_reg_loss: 4754.2301; val_edge_recon_loss: 76263.3595; val_gene_expr_recon_loss: 740132.1277; val_masked_gp_l1_reg_loss: 3643.7803; val_group_lasso_reg_loss: 0.0000; val_global_loss: 824793.4728; val_optim_loss: 824793.4728
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9731; val_auprc_score: 0.9934; val_best_acc_score: 0.9651; val_best_f1_score: 0.9798; train_kl_reg_loss: 4721.5214; train_edge_recon_loss: 77639.5782; train_gene_expr_recon_loss: 739557.0739; train_masked_gp_l1_reg_loss: 3648.1217; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825566.2957; train_optim_loss: 825566.2957; val_kl_reg_loss: 4706.5479; val_edge_recon_loss: 76913.0471; val_gene_expr_recon_loss: 741170.9683; val_masked_gp_l1_reg_loss: 3650.9646; val_group_lasso_reg_loss: 0.0000; val_global_loss: 826441.5009; val_optim_loss: 826441.5009
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9722; val_auprc_score: 0.9932; val_best_acc_score: 0.9647; val_best_f1_score: 0.9795; train_kl_reg_loss: 4713.2867; train_edge_recon_loss: 77475.5591; train_gene_expr_recon_loss: 739728.7823; train_masked_gp_l1_reg_loss: 3651.4733; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825569.1029; train_optim_loss: 825569.1029; val_kl_reg_loss: 4649.8473; val_edge_recon_loss: 77914.6035; val_gene_expr_recon_loss: 740833.5000; val_masked_gp_l1_reg_loss: 3649.6914; val_group_lasso_reg_loss: 0.0000; val_global_loss: 827047.6368; val_optim_loss: 827047.6368
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9708; val_auprc_score: 0.9927; val_best_acc_score: 0.9632; val_best_f1_score: 0.9787; train_kl_reg_loss: 4707.1622; train_edge_recon_loss: 77743.4762; train_gene_expr_recon_loss: 739585.1845; train_masked_gp_l1_reg_loss: 3650.8600; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825686.6841; train_optim_loss: 825686.6841; val_kl_reg_loss: 4740.8811; val_edge_recon_loss: 77866.4148; val_gene_expr_recon_loss: 740673.1205; val_masked_gp_l1_reg_loss: 3654.5115; val_group_lasso_reg_loss: 0.0000; val_global_loss: 826934.9167; val_optim_loss: 826934.9167
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9725; val_auprc_score: 0.9937; val_best_acc_score: 0.9643; val_best_f1_score: 0.9793; train_kl_reg_loss: 4700.7668; train_edge_recon_loss: 77764.2432; train_gene_expr_recon_loss: 739264.8270; train_masked_gp_l1_reg_loss: 3654.5347; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825384.3717; train_optim_loss: 825384.3717; val_kl_reg_loss: 4738.6557; val_edge_recon_loss: 77335.4804; val_gene_expr_recon_loss: 740993.2944; val_masked_gp_l1_reg_loss: 3659.7852; val_group_lasso_reg_loss: 0.0000; val_global_loss: 826727.2400; val_optim_loss: 826727.2400

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9722; val_auprc_score: 0.9935; val_best_acc_score: 0.9645; val_best_f1_score: 0.9794; train_kl_reg_loss: 4708.7893; train_edge_recon_loss: 77485.7732; train_gene_expr_recon_loss: 739724.8337; train_masked_gp_l1_reg_loss: 3639.0986; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825558.4952; train_optim_loss: 825558.4952; val_kl_reg_loss: 4712.4184; val_edge_recon_loss: 77407.2990; val_gene_expr_recon_loss: 740651.7156; val_masked_gp_l1_reg_loss: 3634.6328; val_group_lasso_reg_loss: 0.0000; val_global_loss: 826406.0553; val_optim_loss: 826406.0553
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9733; val_auprc_score: 0.9937; val_best_acc_score: 0.9647; val_best_f1_score: 0.9795; train_kl_reg_loss: 4703.6613; train_edge_recon_loss: 77731.6061; train_gene_expr_recon_loss: 739582.8816; train_masked_gp_l1_reg_loss: 3633.3619; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825651.5100; train_optim_loss: 825651.5100; val_kl_reg_loss: 4699.4300; val_edge_recon_loss: 77209.0394; val_gene_expr_recon_loss: 741004.7681; val_masked_gp_l1_reg_loss: 3632.7827; val_group_lasso_reg_loss: 0.0000; val_global_loss: 826546.0525; val_optim_loss: 826546.0525
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9721; val_auprc_score: 0.9932; val_best_acc_score: 0.9638; val_best_f1_score: 0.9790; train_kl_reg_loss: 4699.5436; train_edge_recon_loss: 77516.7679; train_gene_expr_recon_loss: 739586.8084; train_masked_gp_l1_reg_loss: 3632.5603; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825435.6789; train_optim_loss: 825435.6789; val_kl_reg_loss: 4683.1210; val_edge_recon_loss: 77959.2752; val_gene_expr_recon_loss: 741516.7790; val_masked_gp_l1_reg_loss: 3632.3733; val_group_lasso_reg_loss: 0.0000; val_global_loss: 827791.5516; val_optim_loss: 827791.5516
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9723; val_auprc_score: 0.9934; val_best_acc_score: 0.9646; val_best_f1_score: 0.9795; train_kl_reg_loss: 4694.0629; train_edge_recon_loss: 77352.4914; train_gene_expr_recon_loss: 739476.9576; train_masked_gp_l1_reg_loss: 3632.0271; train_group_lasso_reg_loss: 0.0000; train_global_loss: 825155.5383; train_optim_loss: 825155.5383; val_kl_reg_loss: 4681.0027; val_edge_recon_loss: 77053.7486; val_gene_expr_recon_loss: 740882.2917; val_masked_gp_l1_reg_loss: 3632.1953; val_group_lasso_reg_loss: 0.0000; val_global_loss: 826249.2283; val_optim_loss: 826249.2283

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 599 min 30 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9725
Val AUPRC score: 0.9933
Val best accuracy score: 0.9653
Val best F1 score: 0.9799
Val gene expr MSE score: 23651.8513
Val cat covariate0 mean sim diff: -0.0023

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
