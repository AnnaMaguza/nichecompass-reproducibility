[True]
Run timestamp: 07092023_191126_86.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_86']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6032; val_auprc_score: 0.6024; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 76914.6794; train_edge_recon_loss: 3619072.5303; train_gene_expr_recon_loss: 27645539.3636; train_masked_gp_l1_reg_loss: 92263.7272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1545994.9091; train_chrom_access_recon_loss: 6358919.0909; train_global_loss: 39338704.3030; train_optim_loss: 39338704.3030; val_kl_reg_loss: 49100.3965; val_edge_recon_loss: 4065906.3438; val_gene_expr_recon_loss: 25091603.0000; val_masked_gp_l1_reg_loss: 87015.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1285147.8750; val_chrom_access_recon_loss: 6038656.1875; val_global_loss: 36617430.0000; val_optim_loss: 36617430.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6519; val_auprc_score: 0.6249; val_best_acc_score: 0.5035; val_best_f1_score: 0.6681; train_kl_reg_loss: 118428.2055; train_edge_recon_loss: 3573526.6629; train_gene_expr_recon_loss: 24882884.6364; train_masked_gp_l1_reg_loss: 81229.8535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1031429.7396; train_chrom_access_recon_loss: 6038952.0000; train_global_loss: 35726451.2727; train_optim_loss: 35726451.2727; val_kl_reg_loss: 121476.4521; val_edge_recon_loss: 4065216.0312; val_gene_expr_recon_loss: 24181361.5000; val_masked_gp_l1_reg_loss: 76871.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 797785.4375; val_chrom_access_recon_loss: 5847591.3750; val_global_loss: 35090303.0000; val_optim_loss: 35090303.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7040; val_auprc_score: 0.6765; val_best_acc_score: 0.5801; val_best_f1_score: 0.6933; train_kl_reg_loss: 125489.7823; train_edge_recon_loss: 3544239.9242; train_gene_expr_recon_loss: 24440515.3636; train_masked_gp_l1_reg_loss: 75792.8073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 636445.8892; train_chrom_access_recon_loss: 5967597.6364; train_global_loss: 34790081.3333; train_optim_loss: 34790081.3333; val_kl_reg_loss: 131462.9424; val_edge_recon_loss: 4057132.7188; val_gene_expr_recon_loss: 24014485.2500; val_masked_gp_l1_reg_loss: 75892.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 499783.0625; val_chrom_access_recon_loss: 5865639.6250; val_global_loss: 34644396.5000; val_optim_loss: 34644396.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7529; val_auprc_score: 0.7355; val_best_acc_score: 0.6840; val_best_f1_score: 0.7032; train_kl_reg_loss: 115928.0491; train_edge_recon_loss: 3528747.3447; train_gene_expr_recon_loss: 24209285.3636; train_masked_gp_l1_reg_loss: 76940.2861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 410907.6468; train_chrom_access_recon_loss: 5928815.2424; train_global_loss: 34270623.9394; train_optim_loss: 34270623.9394; val_kl_reg_loss: 108582.8447; val_edge_recon_loss: 4012696.1875; val_gene_expr_recon_loss: 23620825.5000; val_masked_gp_l1_reg_loss: 78362.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 335875.0000; val_chrom_access_recon_loss: 5736303.0000; val_global_loss: 33892644.2500; val_optim_loss: 33892644.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8114; val_auprc_score: 0.7844; val_best_acc_score: 0.7303; val_best_f1_score: 0.7641; train_kl_reg_loss: 103703.4441; train_edge_recon_loss: 3501841.0076; train_gene_expr_recon_loss: 24026837.8182; train_masked_gp_l1_reg_loss: 79689.8849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 286128.4148; train_chrom_access_recon_loss: 5894461.4242; train_global_loss: 33892661.8182; train_optim_loss: 33892661.8182; val_kl_reg_loss: 95656.3545; val_edge_recon_loss: 3822014.1562; val_gene_expr_recon_loss: 23802171.2500; val_masked_gp_l1_reg_loss: 81319.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 242862.9375; val_chrom_access_recon_loss: 5747933.5625; val_global_loss: 33791956.7500; val_optim_loss: 33791956.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8325; val_auprc_score: 0.7971; val_best_acc_score: 0.7625; val_best_f1_score: 0.7886; train_kl_reg_loss: 90088.4402; train_edge_recon_loss: 3326696.9886; train_gene_expr_recon_loss: 23908837.6061; train_masked_gp_l1_reg_loss: 83163.3265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211983.2211; train_chrom_access_recon_loss: 5866346.9924; train_global_loss: 33487116.5758; train_optim_loss: 33487116.5758; val_kl_reg_loss: 97353.7158; val_edge_recon_loss: 3127468.5938; val_gene_expr_recon_loss: 23446678.5000; val_masked_gp_l1_reg_loss: 86250.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185507.3750; val_chrom_access_recon_loss: 5675954.6875; val_global_loss: 32619213.0000; val_optim_loss: 32619213.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8334; val_auprc_score: 0.7840; val_best_acc_score: 0.7571; val_best_f1_score: 0.7908; train_kl_reg_loss: 101786.7702; train_edge_recon_loss: 3097326.1515; train_gene_expr_recon_loss: 23868363.4242; train_masked_gp_l1_reg_loss: 88529.8576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167719.7424; train_chrom_access_recon_loss: 5844584.4924; train_global_loss: 33168310.3333; train_optim_loss: 33168310.3333; val_kl_reg_loss: 101390.8408; val_edge_recon_loss: 3060684.5938; val_gene_expr_recon_loss: 23394754.5000; val_masked_gp_l1_reg_loss: 90706.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153279.1562; val_chrom_access_recon_loss: 5671790.6875; val_global_loss: 32472606.7500; val_optim_loss: 32472606.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8345; val_auprc_score: 0.7891; val_best_acc_score: 0.7595; val_best_f1_score: 0.7828; train_kl_reg_loss: 119259.8823; train_edge_recon_loss: 2993619.1553; train_gene_expr_recon_loss: 23679121.0303; train_masked_gp_l1_reg_loss: 91029.9111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136102.0507; train_chrom_access_recon_loss: 5811193.8182; train_global_loss: 32830325.5758; train_optim_loss: 32830325.5758; val_kl_reg_loss: 118098.7246; val_edge_recon_loss: 3032634.6250; val_gene_expr_recon_loss: 23258204.2500; val_masked_gp_l1_reg_loss: 91819.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122101.8203; val_chrom_access_recon_loss: 5663778.3750; val_global_loss: 32286638.2500; val_optim_loss: 32286638.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8494; val_auprc_score: 0.8109; val_best_acc_score: 0.7719; val_best_f1_score: 0.7975; train_kl_reg_loss: 122139.9989; train_edge_recon_loss: 2971294.8561; train_gene_expr_recon_loss: 23574153.3636; train_masked_gp_l1_reg_loss: 92936.2983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111530.5395; train_chrom_access_recon_loss: 5781932.9470; train_global_loss: 32653987.9394; train_optim_loss: 32653987.9394; val_kl_reg_loss: 120505.6328; val_edge_recon_loss: 2957249.7500; val_gene_expr_recon_loss: 23218546.5000; val_masked_gp_l1_reg_loss: 94312.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103434.4453; val_chrom_access_recon_loss: 5637279.2500; val_global_loss: 32131327.0000; val_optim_loss: 32131327.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8652; val_auprc_score: 0.8274; val_best_acc_score: 0.7918; val_best_f1_score: 0.8012; train_kl_reg_loss: 119278.3086; train_edge_recon_loss: 2948022.8333; train_gene_expr_recon_loss: 23477594.3636; train_masked_gp_l1_reg_loss: 95504.7537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95903.5766; train_chrom_access_recon_loss: 5757016.7197; train_global_loss: 32493320.5152; train_optim_loss: 32493320.5152; val_kl_reg_loss: 114855.2920; val_edge_recon_loss: 2937327.6250; val_gene_expr_recon_loss: 22827978.0000; val_masked_gp_l1_reg_loss: 96801.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89876.8359; val_chrom_access_recon_loss: 5606225.7500; val_global_loss: 31673064.2500; val_optim_loss: 31673064.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8638; val_auprc_score: 0.8317; val_best_acc_score: 0.7910; val_best_f1_score: 0.8082; train_kl_reg_loss: 117364.8975; train_edge_recon_loss: 2937035.9242; train_gene_expr_recon_loss: 23356844.7576; train_masked_gp_l1_reg_loss: 97680.1731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84725.6244; train_chrom_access_recon_loss: 5730741.4091; train_global_loss: 32324392.8182; train_optim_loss: 32324392.8182; val_kl_reg_loss: 116026.7998; val_edge_recon_loss: 2944478.9062; val_gene_expr_recon_loss: 23055532.2500; val_masked_gp_l1_reg_loss: 98867.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80652.5547; val_chrom_access_recon_loss: 5606609.5000; val_global_loss: 31902167.2500; val_optim_loss: 31902167.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8691; val_auprc_score: 0.8327; val_best_acc_score: 0.7988; val_best_f1_score: 0.8180; train_kl_reg_loss: 112648.1128; train_edge_recon_loss: 2906084.3220; train_gene_expr_recon_loss: 23294058.3636; train_masked_gp_l1_reg_loss: 99739.4891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76632.5501; train_chrom_access_recon_loss: 5708964.8030; train_global_loss: 32198127.6667; train_optim_loss: 32198127.6667; val_kl_reg_loss: 108297.4355; val_edge_recon_loss: 2951055.2500; val_gene_expr_recon_loss: 22891266.0000; val_masked_gp_l1_reg_loss: 100827.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73301.5469; val_chrom_access_recon_loss: 5550101.9375; val_global_loss: 31674850.2500; val_optim_loss: 31674850.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8940; val_auprc_score: 0.8642; val_best_acc_score: 0.8213; val_best_f1_score: 0.8348; train_kl_reg_loss: 110571.5808; train_edge_recon_loss: 2885936.6591; train_gene_expr_recon_loss: 23199742.0909; train_masked_gp_l1_reg_loss: 101830.5415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70480.8625; train_chrom_access_recon_loss: 5691762.0758; train_global_loss: 32060323.9394; train_optim_loss: 32060323.9394; val_kl_reg_loss: 112831.9717; val_edge_recon_loss: 2845771.9062; val_gene_expr_recon_loss: 22918142.0000; val_masked_gp_l1_reg_loss: 102665.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68208.4375; val_chrom_access_recon_loss: 5622553.4375; val_global_loss: 31670173.5000; val_optim_loss: 31670173.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8901; val_auprc_score: 0.8516; val_best_acc_score: 0.8256; val_best_f1_score: 0.8422; train_kl_reg_loss: 110418.0582; train_edge_recon_loss: 2859057.4318; train_gene_expr_recon_loss: 23123762.5455; train_masked_gp_l1_reg_loss: 103630.2259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65781.4908; train_chrom_access_recon_loss: 5668215.7500; train_global_loss: 31930865.5758; train_optim_loss: 31930865.5758; val_kl_reg_loss: 112730.3623; val_edge_recon_loss: 2847484.2188; val_gene_expr_recon_loss: 22923848.7500; val_masked_gp_l1_reg_loss: 104793.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64187.5859; val_chrom_access_recon_loss: 5562076.3750; val_global_loss: 31615121.7500; val_optim_loss: 31615121.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8981; val_auprc_score: 0.8631; val_best_acc_score: 0.8315; val_best_f1_score: 0.8478; train_kl_reg_loss: 112170.8205; train_edge_recon_loss: 2825412.6439; train_gene_expr_recon_loss: 23067370.5455; train_masked_gp_l1_reg_loss: 105410.9727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61749.0754; train_chrom_access_recon_loss: 5651643.4924; train_global_loss: 31823757.4242; train_optim_loss: 31823757.4242; val_kl_reg_loss: 114730.8438; val_edge_recon_loss: 2823083.0312; val_gene_expr_recon_loss: 22660707.0000; val_masked_gp_l1_reg_loss: 106124.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60138.6094; val_chrom_access_recon_loss: 5565899.8750; val_global_loss: 31330682.7500; val_optim_loss: 31330682.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9083; val_auprc_score: 0.8809; val_best_acc_score: 0.8388; val_best_f1_score: 0.8554; train_kl_reg_loss: 115026.1255; train_edge_recon_loss: 2816623.4470; train_gene_expr_recon_loss: 22986021.0606; train_masked_gp_l1_reg_loss: 106845.5225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58665.5424; train_chrom_access_recon_loss: 5635435.8409; train_global_loss: 31718617.4242; train_optim_loss: 31718617.4242; val_kl_reg_loss: 111905.4121; val_edge_recon_loss: 2820254.4375; val_gene_expr_recon_loss: 22717560.0000; val_masked_gp_l1_reg_loss: 107596.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57500.3164; val_chrom_access_recon_loss: 5553427.5000; val_global_loss: 31368244.0000; val_optim_loss: 31368244.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9062; val_auprc_score: 0.8752; val_best_acc_score: 0.8450; val_best_f1_score: 0.8576; train_kl_reg_loss: 110979.6522; train_edge_recon_loss: 2817509.7727; train_gene_expr_recon_loss: 22934429.5455; train_masked_gp_l1_reg_loss: 108390.7299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56259.8561; train_chrom_access_recon_loss: 5618206.5606; train_global_loss: 31645776.3333; train_optim_loss: 31645776.3333; val_kl_reg_loss: 109524.0654; val_edge_recon_loss: 2864353.1562; val_gene_expr_recon_loss: 22566796.7500; val_masked_gp_l1_reg_loss: 109432.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55600.6484; val_chrom_access_recon_loss: 5491061.9375; val_global_loss: 31196768.0000; val_optim_loss: 31196768.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9140; val_auprc_score: 0.8902; val_best_acc_score: 0.8495; val_best_f1_score: 0.8577; train_kl_reg_loss: 111060.8558; train_edge_recon_loss: 2812456.8788; train_gene_expr_recon_loss: 22855539.7879; train_masked_gp_l1_reg_loss: 109926.5513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54350.3938; train_chrom_access_recon_loss: 5604748.3788; train_global_loss: 31548082.9091; train_optim_loss: 31548082.9091; val_kl_reg_loss: 108712.6689; val_edge_recon_loss: 2831299.7188; val_gene_expr_recon_loss: 22339437.7500; val_masked_gp_l1_reg_loss: 110659.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53436.8047; val_chrom_access_recon_loss: 5437119.3125; val_global_loss: 30880665.5000; val_optim_loss: 30880665.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9067; val_auprc_score: 0.8761; val_best_acc_score: 0.8415; val_best_f1_score: 0.8554; train_kl_reg_loss: 111331.8140; train_edge_recon_loss: 2793671.9508; train_gene_expr_recon_loss: 22819865.3939; train_masked_gp_l1_reg_loss: 111128.2053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52665.7532; train_chrom_access_recon_loss: 5587246.2424; train_global_loss: 31475909.6061; train_optim_loss: 31475909.6061; val_kl_reg_loss: 110005.1201; val_edge_recon_loss: 2826573.0000; val_gene_expr_recon_loss: 22533715.7500; val_masked_gp_l1_reg_loss: 111990.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51972.6328; val_chrom_access_recon_loss: 5475903.8125; val_global_loss: 31110159.5000; val_optim_loss: 31110159.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9106; val_auprc_score: 0.8813; val_best_acc_score: 0.8514; val_best_f1_score: 0.8631; train_kl_reg_loss: 108740.4679; train_edge_recon_loss: 2786732.3371; train_gene_expr_recon_loss: 22752164.0303; train_masked_gp_l1_reg_loss: 112550.6901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51189.2497; train_chrom_access_recon_loss: 5572832.5530; train_global_loss: 31384209.3333; train_optim_loss: 31384209.3333; val_kl_reg_loss: 109243.1758; val_edge_recon_loss: 2835865.1562; val_gene_expr_recon_loss: 22341088.2500; val_masked_gp_l1_reg_loss: 113237.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50652.1016; val_chrom_access_recon_loss: 5422578.1875; val_global_loss: 30872664.7500; val_optim_loss: 30872664.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9220; val_auprc_score: 0.9010; val_best_acc_score: 0.8544; val_best_f1_score: 0.8649; train_kl_reg_loss: 107240.9841; train_edge_recon_loss: 2790171.4318; train_gene_expr_recon_loss: 22715573.8788; train_masked_gp_l1_reg_loss: 113833.2802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50196.3697; train_chrom_access_recon_loss: 5558905.6591; train_global_loss: 31335921.6061; train_optim_loss: 31335921.6061; val_kl_reg_loss: 109042.3320; val_edge_recon_loss: 2811101.9062; val_gene_expr_recon_loss: 22280733.5000; val_masked_gp_l1_reg_loss: 114536.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50039.1094; val_chrom_access_recon_loss: 5415239.0625; val_global_loss: 30780693.2500; val_optim_loss: 30780693.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9254; val_auprc_score: 0.9026; val_best_acc_score: 0.8611; val_best_f1_score: 0.8719; train_kl_reg_loss: 106657.4177; train_edge_recon_loss: 2772106.7727; train_gene_expr_recon_loss: 22660369.0000; train_masked_gp_l1_reg_loss: 115140.8319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49398.5945; train_chrom_access_recon_loss: 5543800.5833; train_global_loss: 31247473.6061; train_optim_loss: 31247473.6061; val_kl_reg_loss: 106347.1631; val_edge_recon_loss: 2822948.2812; val_gene_expr_recon_loss: 22159464.0000; val_masked_gp_l1_reg_loss: 115830.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48979.6484; val_chrom_access_recon_loss: 5413312.7500; val_global_loss: 30666881.7500; val_optim_loss: 30666881.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9305; val_auprc_score: 0.9127; val_best_acc_score: 0.8710; val_best_f1_score: 0.8767; train_kl_reg_loss: 105827.0616; train_edge_recon_loss: 2750968.5909; train_gene_expr_recon_loss: 22611906.9697; train_masked_gp_l1_reg_loss: 116221.4795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48728.2357; train_chrom_access_recon_loss: 5533571.9394; train_global_loss: 31167224.2424; train_optim_loss: 31167224.2424; val_kl_reg_loss: 104424.2207; val_edge_recon_loss: 2816801.0625; val_gene_expr_recon_loss: 22285045.5000; val_masked_gp_l1_reg_loss: 117007.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48684.7500; val_chrom_access_recon_loss: 5417528.1875; val_global_loss: 30789491.0000; val_optim_loss: 30789491.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9287; val_auprc_score: 0.9103; val_best_acc_score: 0.8667; val_best_f1_score: 0.8746; train_kl_reg_loss: 103441.6776; train_edge_recon_loss: 2764436.0038; train_gene_expr_recon_loss: 22566293.0303; train_masked_gp_l1_reg_loss: 117589.9368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48131.2075; train_chrom_access_recon_loss: 5518371.2576; train_global_loss: 31118263.2121; train_optim_loss: 31118263.2121; val_kl_reg_loss: 104074.4717; val_edge_recon_loss: 2841232.7188; val_gene_expr_recon_loss: 22269838.0000; val_masked_gp_l1_reg_loss: 118153.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47944.8047; val_chrom_access_recon_loss: 5440629.2500; val_global_loss: 30821872.2500; val_optim_loss: 30821872.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9310; val_auprc_score: 0.9098; val_best_acc_score: 0.8748; val_best_f1_score: 0.8817; train_kl_reg_loss: 103577.5162; train_edge_recon_loss: 2760878.7197; train_gene_expr_recon_loss: 22528145.4848; train_masked_gp_l1_reg_loss: 118587.2372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47564.0060; train_chrom_access_recon_loss: 5508325.7500; train_global_loss: 31067078.6364; train_optim_loss: 31067078.6364; val_kl_reg_loss: 103525.7627; val_edge_recon_loss: 2773711.2500; val_gene_expr_recon_loss: 22461449.0000; val_masked_gp_l1_reg_loss: 119150.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47570.0508; val_chrom_access_recon_loss: 5453434.8750; val_global_loss: 30958840.2500; val_optim_loss: 30958840.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9278; val_auprc_score: 0.8947; val_best_acc_score: 0.8753; val_best_f1_score: 0.8824; train_kl_reg_loss: 110559.7807; train_edge_recon_loss: 2790054.4886; train_gene_expr_recon_loss: 22250730.3636; train_masked_gp_l1_reg_loss: 118224.6549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39837.6624; train_chrom_access_recon_loss: 5461566.3864; train_global_loss: 30770973.5455; train_optim_loss: 30770973.5455; val_kl_reg_loss: 78571.6416; val_edge_recon_loss: 2813406.6562; val_gene_expr_recon_loss: 21909063.2500; val_masked_gp_l1_reg_loss: 117755.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37245.2305; val_chrom_access_recon_loss: 5288140.6250; val_global_loss: 30244183.7500; val_optim_loss: 30244183.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9384; val_auprc_score: 0.9150; val_best_acc_score: 0.8831; val_best_f1_score: 0.8884; train_kl_reg_loss: 112347.1049; train_edge_recon_loss: 2770630.6402; train_gene_expr_recon_loss: 22163186.0606; train_masked_gp_l1_reg_loss: 117987.8776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36474.4191; train_chrom_access_recon_loss: 5411069.6894; train_global_loss: 30611695.8182; train_optim_loss: 30611695.8182; val_kl_reg_loss: 78319.6621; val_edge_recon_loss: 2780230.0938; val_gene_expr_recon_loss: 21796568.0000; val_masked_gp_l1_reg_loss: 118357.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35944.0273; val_chrom_access_recon_loss: 5259918.1875; val_global_loss: 30069337.5000; val_optim_loss: 30069337.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9285; val_auprc_score: 0.9078; val_best_acc_score: 0.8675; val_best_f1_score: 0.8762; train_kl_reg_loss: 108652.3208; train_edge_recon_loss: 2767171.2273; train_gene_expr_recon_loss: 22126704.9091; train_masked_gp_l1_reg_loss: 118590.8991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35693.1181; train_chrom_access_recon_loss: 5402639.0076; train_global_loss: 30559451.4848; train_optim_loss: 30559451.4848; val_kl_reg_loss: 80696.1436; val_edge_recon_loss: 2845264.8750; val_gene_expr_recon_loss: 21795589.5000; val_masked_gp_l1_reg_loss: 118928.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35365.0938; val_chrom_access_recon_loss: 5306146.1250; val_global_loss: 30181990.7500; val_optim_loss: 30181990.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9326; val_auprc_score: 0.9089; val_best_acc_score: 0.8737; val_best_f1_score: 0.8828; train_kl_reg_loss: 107619.8554; train_edge_recon_loss: 2760532.3295; train_gene_expr_recon_loss: 22068662.6061; train_masked_gp_l1_reg_loss: 119242.1477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35211.9566; train_chrom_access_recon_loss: 5387165.5682; train_global_loss: 30478434.9091; train_optim_loss: 30478434.9091; val_kl_reg_loss: 83050.1191; val_edge_recon_loss: 2793332.1875; val_gene_expr_recon_loss: 21941711.7500; val_masked_gp_l1_reg_loss: 119452.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34934.3516; val_chrom_access_recon_loss: 5271981.0000; val_global_loss: 30244461.7500; val_optim_loss: 30244461.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9316; val_auprc_score: 0.9043; val_best_acc_score: 0.8799; val_best_f1_score: 0.8874; train_kl_reg_loss: 105060.7491; train_edge_recon_loss: 2743881.4508; train_gene_expr_recon_loss: 22052837.6667; train_masked_gp_l1_reg_loss: 119701.2378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34847.0391; train_chrom_access_recon_loss: 5386250.4924; train_global_loss: 30442578.5152; train_optim_loss: 30442578.5152; val_kl_reg_loss: 81410.7480; val_edge_recon_loss: 2771391.3125; val_gene_expr_recon_loss: 21745409.5000; val_masked_gp_l1_reg_loss: 120154.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34856.4531; val_chrom_access_recon_loss: 5237135.5625; val_global_loss: 29990357.0000; val_optim_loss: 29990357.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9434; val_auprc_score: 0.9221; val_best_acc_score: 0.8861; val_best_f1_score: 0.8908; train_kl_reg_loss: 101815.2459; train_edge_recon_loss: 2747254.5379; train_gene_expr_recon_loss: 21989632.3030; train_masked_gp_l1_reg_loss: 120437.7686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34664.9792; train_chrom_access_recon_loss: 5368475.4091; train_global_loss: 30362280.3030; train_optim_loss: 30362280.3030; val_kl_reg_loss: 83440.0605; val_edge_recon_loss: 2758760.7188; val_gene_expr_recon_loss: 21602906.2500; val_masked_gp_l1_reg_loss: 120750.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34514.7344; val_chrom_access_recon_loss: 5222427.9375; val_global_loss: 29822799.0000; val_optim_loss: 29822799.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9437; val_auprc_score: 0.9238; val_best_acc_score: 0.8958; val_best_f1_score: 0.9017; train_kl_reg_loss: 100014.3545; train_edge_recon_loss: 2742635.5379; train_gene_expr_recon_loss: 21942240.1515; train_masked_gp_l1_reg_loss: 121033.8646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34437.1568; train_chrom_access_recon_loss: 5357301.0455; train_global_loss: 30297662.2121; train_optim_loss: 30297662.2121; val_kl_reg_loss: 83041.2676; val_edge_recon_loss: 2742583.5625; val_gene_expr_recon_loss: 21547095.2500; val_masked_gp_l1_reg_loss: 121347.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34255.2109; val_chrom_access_recon_loss: 5232224.0625; val_global_loss: 29760548.2500; val_optim_loss: 29760548.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9352; val_auprc_score: 0.9076; val_best_acc_score: 0.8847; val_best_f1_score: 0.8910; train_kl_reg_loss: 97892.4527; train_edge_recon_loss: 2737181.1970; train_gene_expr_recon_loss: 21893143.7879; train_masked_gp_l1_reg_loss: 121607.0664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34128.1841; train_chrom_access_recon_loss: 5345747.0379; train_global_loss: 30229699.5758; train_optim_loss: 30229699.5758; val_kl_reg_loss: 84548.4053; val_edge_recon_loss: 2785501.0312; val_gene_expr_recon_loss: 21512358.0000; val_masked_gp_l1_reg_loss: 121942.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34092.7812; val_chrom_access_recon_loss: 5233275.8750; val_global_loss: 29771717.0000; val_optim_loss: 29771717.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9475; val_auprc_score: 0.9296; val_best_acc_score: 0.8960; val_best_f1_score: 0.9003; train_kl_reg_loss: 96945.5739; train_edge_recon_loss: 2747566.3561; train_gene_expr_recon_loss: 21861958.7576; train_masked_gp_l1_reg_loss: 122124.0566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33995.4028; train_chrom_access_recon_loss: 5340238.7803; train_global_loss: 30202828.8485; train_optim_loss: 30202828.8485; val_kl_reg_loss: 82941.9834; val_edge_recon_loss: 2732625.0625; val_gene_expr_recon_loss: 21606536.7500; val_masked_gp_l1_reg_loss: 122317.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33890.7930; val_chrom_access_recon_loss: 5203677.0625; val_global_loss: 29781988.5000; val_optim_loss: 29781988.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9482; val_auprc_score: 0.9239; val_best_acc_score: 0.8963; val_best_f1_score: 0.8994; train_kl_reg_loss: 94023.7442; train_edge_recon_loss: 2736134.4432; train_gene_expr_recon_loss: 21825325.8485; train_masked_gp_l1_reg_loss: 122612.1751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33861.1730; train_chrom_access_recon_loss: 5331296.4091; train_global_loss: 30143253.9697; train_optim_loss: 30143253.9697; val_kl_reg_loss: 81316.7627; val_edge_recon_loss: 2744790.2188; val_gene_expr_recon_loss: 21616200.7500; val_masked_gp_l1_reg_loss: 122841.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33826.9883; val_chrom_access_recon_loss: 5189145.8750; val_global_loss: 29788122.0000; val_optim_loss: 29788122.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9420; val_auprc_score: 0.9179; val_best_acc_score: 0.8845; val_best_f1_score: 0.8908; train_kl_reg_loss: 93241.8849; train_edge_recon_loss: 2730454.7235; train_gene_expr_recon_loss: 21790943.2424; train_masked_gp_l1_reg_loss: 123064.1038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33785.9624; train_chrom_access_recon_loss: 5323669.3939; train_global_loss: 30095159.3333; train_optim_loss: 30095159.3333; val_kl_reg_loss: 80570.7734; val_edge_recon_loss: 2747007.6875; val_gene_expr_recon_loss: 21503666.0000; val_masked_gp_l1_reg_loss: 123277.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33751.9180; val_chrom_access_recon_loss: 5186693.8125; val_global_loss: 29674968.0000; val_optim_loss: 29674968.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9499; val_auprc_score: 0.9274; val_best_acc_score: 0.9041; val_best_f1_score: 0.9080; train_kl_reg_loss: 92920.5324; train_edge_recon_loss: 2719916.0227; train_gene_expr_recon_loss: 21761133.0000; train_masked_gp_l1_reg_loss: 123481.4579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33636.8444; train_chrom_access_recon_loss: 5320686.7727; train_global_loss: 30051774.6364; train_optim_loss: 30051774.6364; val_kl_reg_loss: 81725.7676; val_edge_recon_loss: 2751340.9688; val_gene_expr_recon_loss: 21325492.7500; val_masked_gp_l1_reg_loss: 123701.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33559.1406; val_chrom_access_recon_loss: 5164817.6250; val_global_loss: 29480639.0000; val_optim_loss: 29480639.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9436; val_auprc_score: 0.9221; val_best_acc_score: 0.8901; val_best_f1_score: 0.8965; train_kl_reg_loss: 91924.1435; train_edge_recon_loss: 2725270.7008; train_gene_expr_recon_loss: 21733905.5455; train_masked_gp_l1_reg_loss: 123882.9755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33528.8928; train_chrom_access_recon_loss: 5312756.0076; train_global_loss: 30021268.3939; train_optim_loss: 30021268.3939; val_kl_reg_loss: 84287.7441; val_edge_recon_loss: 2751381.5625; val_gene_expr_recon_loss: 21420592.7500; val_masked_gp_l1_reg_loss: 124133.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33589.5625; val_chrom_access_recon_loss: 5203046.5625; val_global_loss: 29617033.0000; val_optim_loss: 29617033.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9478; val_auprc_score: 0.9286; val_best_acc_score: 0.8920; val_best_f1_score: 0.8981; train_kl_reg_loss: 91714.4071; train_edge_recon_loss: 2721095.5947; train_gene_expr_recon_loss: 21693592.6667; train_masked_gp_l1_reg_loss: 124220.1518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33488.8841; train_chrom_access_recon_loss: 5308550.6288; train_global_loss: 29972662.5152; train_optim_loss: 29972662.5152; val_kl_reg_loss: 82868.4902; val_edge_recon_loss: 2749101.9062; val_gene_expr_recon_loss: 21345145.5000; val_masked_gp_l1_reg_loss: 124365.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33394.1328; val_chrom_access_recon_loss: 5204495.6875; val_global_loss: 29539372.0000; val_optim_loss: 29539372.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9456; val_auprc_score: 0.9242; val_best_acc_score: 0.8917; val_best_f1_score: 0.8966; train_kl_reg_loss: 90126.5556; train_edge_recon_loss: 2725400.9508; train_gene_expr_recon_loss: 21675371.5758; train_masked_gp_l1_reg_loss: 124552.8069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33362.7215; train_chrom_access_recon_loss: 5304189.0152; train_global_loss: 29953003.5455; train_optim_loss: 29953003.5455; val_kl_reg_loss: 82866.6885; val_edge_recon_loss: 2763728.9688; val_gene_expr_recon_loss: 21445293.0000; val_masked_gp_l1_reg_loss: 124785.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33387.7578; val_chrom_access_recon_loss: 5174672.5000; val_global_loss: 29624735.0000; val_optim_loss: 29624735.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9440; val_auprc_score: 0.9109; val_best_acc_score: 0.8990; val_best_f1_score: 0.9022; train_kl_reg_loss: 88914.6499; train_edge_recon_loss: 2711156.8106; train_gene_expr_recon_loss: 21673240.9091; train_masked_gp_l1_reg_loss: 124862.8957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33249.1854; train_chrom_access_recon_loss: 5301068.4318; train_global_loss: 29932492.8788; train_optim_loss: 29932492.8788; val_kl_reg_loss: 80908.1582; val_edge_recon_loss: 2737008.1562; val_gene_expr_recon_loss: 21422164.2500; val_masked_gp_l1_reg_loss: 125212.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33287.7852; val_chrom_access_recon_loss: 5172688.0625; val_global_loss: 29571268.5000; val_optim_loss: 29571268.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9530; val_auprc_score: 0.9354; val_best_acc_score: 0.9009; val_best_f1_score: 0.9044; train_kl_reg_loss: 86994.4239; train_edge_recon_loss: 2724507.0341; train_gene_expr_recon_loss: 21644680.1818; train_masked_gp_l1_reg_loss: 124425.6529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30772.9128; train_chrom_access_recon_loss: 5294413.8106; train_global_loss: 29905794.0303; train_optim_loss: 29905794.0303; val_kl_reg_loss: 80960.2188; val_edge_recon_loss: 2753961.2500; val_gene_expr_recon_loss: 21607694.0000; val_masked_gp_l1_reg_loss: 123985.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30171.7676; val_chrom_access_recon_loss: 5256002.3750; val_global_loss: 29852775.2500; val_optim_loss: 29852775.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9487; val_auprc_score: 0.9292; val_best_acc_score: 0.9006; val_best_f1_score: 0.9040; train_kl_reg_loss: 88415.3116; train_edge_recon_loss: 2710830.6591; train_gene_expr_recon_loss: 21617329.9697; train_masked_gp_l1_reg_loss: 123846.0250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30051.7669; train_chrom_access_recon_loss: 5293014.6364; train_global_loss: 29863488.3939; train_optim_loss: 29863488.3939; val_kl_reg_loss: 82831.3330; val_edge_recon_loss: 2736259.0625; val_gene_expr_recon_loss: 21411726.5000; val_masked_gp_l1_reg_loss: 123746.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29948.3301; val_chrom_access_recon_loss: 5247374.3750; val_global_loss: 29631885.0000; val_optim_loss: 29631885.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9456; val_auprc_score: 0.9247; val_best_acc_score: 0.8907; val_best_f1_score: 0.8944; train_kl_reg_loss: 89256.2491; train_edge_recon_loss: 2710238.5000; train_gene_expr_recon_loss: 21630654.3636; train_masked_gp_l1_reg_loss: 123707.9371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29872.4197; train_chrom_access_recon_loss: 5291294.3939; train_global_loss: 29875023.8788; train_optim_loss: 29875023.8788; val_kl_reg_loss: 83300.1250; val_edge_recon_loss: 2747866.4062; val_gene_expr_recon_loss: 21442179.0000; val_masked_gp_l1_reg_loss: 123675.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29797.5273; val_chrom_access_recon_loss: 5214493.7500; val_global_loss: 29641313.2500; val_optim_loss: 29641313.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9525; val_auprc_score: 0.9321; val_best_acc_score: 0.8990; val_best_f1_score: 0.9008; train_kl_reg_loss: 89973.2108; train_edge_recon_loss: 2710375.5985; train_gene_expr_recon_loss: 21627405.0909; train_masked_gp_l1_reg_loss: 123670.6407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29736.4900; train_chrom_access_recon_loss: 5292954.3788; train_global_loss: 29874115.3333; train_optim_loss: 29874115.3333; val_kl_reg_loss: 83055.7646; val_edge_recon_loss: 2728617.8438; val_gene_expr_recon_loss: 21421181.0000; val_masked_gp_l1_reg_loss: 123646.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29682.4336; val_chrom_access_recon_loss: 5218079.3750; val_global_loss: 29604262.5000; val_optim_loss: 29604262.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 36 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9495
val AUPRC score: 0.9291
val best accuracy score: 0.9011
val best F1 score: 0.9056
val target rna MSE score: 0.8631
val source rna MSE score: 0.2950
val target atac MSE score: 0.4772
val source atac MSE score: 0.1048
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
