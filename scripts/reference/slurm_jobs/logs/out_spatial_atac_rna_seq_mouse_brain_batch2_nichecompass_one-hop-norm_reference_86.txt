[True]
Run timestamp: 07082023_200533_86.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_86']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8776; val_auprc_score: 0.8900; val_best_acc_score: 0.5151; val_best_f1_score: 0.6733; train_kl_reg_loss: 33435.5087; train_edge_recon_loss: 350757.8611; train_gene_expr_recon_loss: 1204595.9167; train_masked_gp_l1_reg_loss: 8769.2673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119350.9141; train_chrom_access_recon_loss: 942365.1667; train_global_loss: 2659274.6111; train_optim_loss: 2659274.6111; val_kl_reg_loss: 12500.6807; val_edge_recon_loss: 406450.7812; val_gene_expr_recon_loss: 1087785.5000; val_masked_gp_l1_reg_loss: 7583.6963; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117077.5781; val_chrom_access_recon_loss: 547835.3750; val_global_loss: 2179233.7500; val_optim_loss: 2179233.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8851; val_auprc_score: 0.8947; val_best_acc_score: 0.5071; val_best_f1_score: 0.6699; train_kl_reg_loss: 14634.7798; train_edge_recon_loss: 356973.6910; train_gene_expr_recon_loss: 995045.9097; train_masked_gp_l1_reg_loss: 7289.6485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115706.2839; train_chrom_access_recon_loss: 545522.4340; train_global_loss: 2035172.7361; train_optim_loss: 2035172.7361; val_kl_reg_loss: 14460.0215; val_edge_recon_loss: 406513.9375; val_gene_expr_recon_loss: 905617.8750; val_masked_gp_l1_reg_loss: 7127.9985; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114056.3125; val_chrom_access_recon_loss: 496029.6250; val_global_loss: 1943805.8750; val_optim_loss: 1943805.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8998; val_auprc_score: 0.9071; val_best_acc_score: 0.5049; val_best_f1_score: 0.6688; train_kl_reg_loss: 15887.8852; train_edge_recon_loss: 358961.1910; train_gene_expr_recon_loss: 873602.1528; train_masked_gp_l1_reg_loss: 7251.5894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112737.9010; train_chrom_access_recon_loss: 487927.3125; train_global_loss: 1856368.0694; train_optim_loss: 1856368.0694; val_kl_reg_loss: 15793.2441; val_edge_recon_loss: 406537.8750; val_gene_expr_recon_loss: 824254.6250; val_masked_gp_l1_reg_loss: 7398.7593; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111043.0625; val_chrom_access_recon_loss: 472867.6875; val_global_loss: 1837895.2500; val_optim_loss: 1837895.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8928; val_auprc_score: 0.9018; val_best_acc_score: 0.5100; val_best_f1_score: 0.6711; train_kl_reg_loss: 18422.3921; train_edge_recon_loss: 360064.4479; train_gene_expr_recon_loss: 800282.9861; train_masked_gp_l1_reg_loss: 7399.2783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109572.8932; train_chrom_access_recon_loss: 466282.8576; train_global_loss: 1762024.9167; train_optim_loss: 1762024.9167; val_kl_reg_loss: 19233.2695; val_edge_recon_loss: 406497.0312; val_gene_expr_recon_loss: 776101.0000; val_masked_gp_l1_reg_loss: 7342.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107638.3516; val_chrom_access_recon_loss: 459317.0000; val_global_loss: 1776129.2500; val_optim_loss: 1776129.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8749; val_auprc_score: 0.8780; val_best_acc_score: 0.5375; val_best_f1_score: 0.6832; train_kl_reg_loss: 19679.3433; train_edge_recon_loss: 358882.7882; train_gene_expr_recon_loss: 758076.7500; train_masked_gp_l1_reg_loss: 7282.2129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105938.2951; train_chrom_access_recon_loss: 455723.7118; train_global_loss: 1705583.1111; train_optim_loss: 1705583.1111; val_kl_reg_loss: 20539.8418; val_edge_recon_loss: 406307.9375; val_gene_expr_recon_loss: 746962.4375; val_masked_gp_l1_reg_loss: 7193.2764; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103729.3906; val_chrom_access_recon_loss: 453470.2500; val_global_loss: 1738203.1250; val_optim_loss: 1738203.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8588; val_auprc_score: 0.8581; val_best_acc_score: 0.5834; val_best_f1_score: 0.7025; train_kl_reg_loss: 19554.7114; train_edge_recon_loss: 358252.9236; train_gene_expr_recon_loss: 741590.4792; train_masked_gp_l1_reg_loss: 7129.3209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101853.1519; train_chrom_access_recon_loss: 452481.2708; train_global_loss: 1680861.8750; train_optim_loss: 1680861.8750; val_kl_reg_loss: 18389.4727; val_edge_recon_loss: 405827.3750; val_gene_expr_recon_loss: 728991.0000; val_masked_gp_l1_reg_loss: 7048.4497; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99459.0547; val_chrom_access_recon_loss: 449633.6875; val_global_loss: 1709349.0000; val_optim_loss: 1709349.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8538; val_auprc_score: 0.8470; val_best_acc_score: 0.6532; val_best_f1_score: 0.7356; train_kl_reg_loss: 19104.3941; train_edge_recon_loss: 358040.2465; train_gene_expr_recon_loss: 721320.2361; train_masked_gp_l1_reg_loss: 7003.6619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97496.6753; train_chrom_access_recon_loss: 450168.1944; train_global_loss: 1653133.3750; train_optim_loss: 1653133.3750; val_kl_reg_loss: 17984.8242; val_edge_recon_loss: 404871.8438; val_gene_expr_recon_loss: 712878.8750; val_masked_gp_l1_reg_loss: 6940.2314; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95020.3047; val_chrom_access_recon_loss: 447292.6875; val_global_loss: 1684988.7500; val_optim_loss: 1684988.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8451; val_auprc_score: 0.8365; val_best_acc_score: 0.7028; val_best_f1_score: 0.7591; train_kl_reg_loss: 19191.9019; train_edge_recon_loss: 357660.0243; train_gene_expr_recon_loss: 703161.6806; train_masked_gp_l1_reg_loss: 6914.1861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93024.5816; train_chrom_access_recon_loss: 446144.4896; train_global_loss: 1626096.8750; train_optim_loss: 1626096.8750; val_kl_reg_loss: 19246.0352; val_edge_recon_loss: 403728.9375; val_gene_expr_recon_loss: 700811.6250; val_masked_gp_l1_reg_loss: 6867.3223; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90527.8281; val_chrom_access_recon_loss: 445255.3750; val_global_loss: 1666437.2500; val_optim_loss: 1666437.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8446; val_auprc_score: 0.8444; val_best_acc_score: 0.7386; val_best_f1_score: 0.7724; train_kl_reg_loss: 19462.2956; train_edge_recon_loss: 356837.8021; train_gene_expr_recon_loss: 694683.4306; train_masked_gp_l1_reg_loss: 6846.4451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88543.2622; train_chrom_access_recon_loss: 445123.5000; train_global_loss: 1611496.7639; train_optim_loss: 1611496.7639; val_kl_reg_loss: 19641.8496; val_edge_recon_loss: 402158.4062; val_gene_expr_recon_loss: 692023.7500; val_masked_gp_l1_reg_loss: 6814.3184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86075.0703; val_chrom_access_recon_loss: 443797.1250; val_global_loss: 1650510.6250; val_optim_loss: 1650510.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8387; val_auprc_score: 0.8371; val_best_acc_score: 0.7625; val_best_f1_score: 0.7691; train_kl_reg_loss: 19306.4746; train_edge_recon_loss: 355865.1632; train_gene_expr_recon_loss: 688593.6667; train_masked_gp_l1_reg_loss: 6807.5127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84136.0938; train_chrom_access_recon_loss: 444359.6458; train_global_loss: 1599068.5694; train_optim_loss: 1599068.5694; val_kl_reg_loss: 18193.8828; val_edge_recon_loss: 399122.5312; val_gene_expr_recon_loss: 685763.3750; val_masked_gp_l1_reg_loss: 6790.6074; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81734.6016; val_chrom_access_recon_loss: 442313.1250; val_global_loss: 1633918.1250; val_optim_loss: 1633918.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8453; val_auprc_score: 0.8380; val_best_acc_score: 0.7524; val_best_f1_score: 0.7622; train_kl_reg_loss: 19359.7229; train_edge_recon_loss: 355030.9028; train_gene_expr_recon_loss: 681595.0764; train_masked_gp_l1_reg_loss: 6794.1753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79857.7726; train_chrom_access_recon_loss: 442196.2986; train_global_loss: 1584833.9444; train_optim_loss: 1584833.9444; val_kl_reg_loss: 17980.6582; val_edge_recon_loss: 395330.6875; val_gene_expr_recon_loss: 680576.3125; val_masked_gp_l1_reg_loss: 6783.9160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77532.4375; val_chrom_access_recon_loss: 440955.2812; val_global_loss: 1619159.2500; val_optim_loss: 1619159.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8533; val_auprc_score: 0.8419; val_best_acc_score: 0.7580; val_best_f1_score: 0.7855; train_kl_reg_loss: 19203.3309; train_edge_recon_loss: 353367.3576; train_gene_expr_recon_loss: 675189.6944; train_masked_gp_l1_reg_loss: 6789.3800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75717.1736; train_chrom_access_recon_loss: 439605.8993; train_global_loss: 1569872.8472; train_optim_loss: 1569872.8472; val_kl_reg_loss: 17656.8203; val_edge_recon_loss: 388032.4062; val_gene_expr_recon_loss: 677579.7500; val_masked_gp_l1_reg_loss: 6788.3916; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73474.2891; val_chrom_access_recon_loss: 439995.5625; val_global_loss: 1603527.2500; val_optim_loss: 1603527.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8713; val_auprc_score: 0.8587; val_best_acc_score: 0.7967; val_best_f1_score: 0.8019; train_kl_reg_loss: 18950.1638; train_edge_recon_loss: 351001.4965; train_gene_expr_recon_loss: 673081.4097; train_masked_gp_l1_reg_loss: 6801.2780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71734.9080; train_chrom_access_recon_loss: 441143.5347; train_global_loss: 1562712.8194; train_optim_loss: 1562712.8194; val_kl_reg_loss: 17152.5449; val_edge_recon_loss: 377803.5625; val_gene_expr_recon_loss: 675122.5000; val_masked_gp_l1_reg_loss: 6800.3608; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69582.6641; val_chrom_access_recon_loss: 439099.0312; val_global_loss: 1585560.6250; val_optim_loss: 1585560.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8863; val_auprc_score: 0.8747; val_best_acc_score: 0.8048; val_best_f1_score: 0.8138; train_kl_reg_loss: 18494.8954; train_edge_recon_loss: 346134.3125; train_gene_expr_recon_loss: 671919.8403; train_masked_gp_l1_reg_loss: 6817.5799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67920.6337; train_chrom_access_recon_loss: 440701.7361; train_global_loss: 1551988.9861; train_optim_loss: 1551988.9861; val_kl_reg_loss: 16929.1953; val_edge_recon_loss: 358769.5000; val_gene_expr_recon_loss: 674504.7500; val_masked_gp_l1_reg_loss: 6834.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65872.0391; val_chrom_access_recon_loss: 438561.3750; val_global_loss: 1561471.8750; val_optim_loss: 1561471.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8911; val_auprc_score: 0.8771; val_best_acc_score: 0.8096; val_best_f1_score: 0.8213; train_kl_reg_loss: 18625.3407; train_edge_recon_loss: 334466.3403; train_gene_expr_recon_loss: 670897.0417; train_masked_gp_l1_reg_loss: 6867.5221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64300.8220; train_chrom_access_recon_loss: 439209.1597; train_global_loss: 1534366.2361; train_optim_loss: 1534366.2361; val_kl_reg_loss: 19754.6211; val_edge_recon_loss: 330964.4688; val_gene_expr_recon_loss: 674542.6250; val_masked_gp_l1_reg_loss: 6897.3506; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62376.6406; val_chrom_access_recon_loss: 438192.7812; val_global_loss: 1532728.5000; val_optim_loss: 1532728.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8858; val_auprc_score: 0.8725; val_best_acc_score: 0.7982; val_best_f1_score: 0.8154; train_kl_reg_loss: 23606.6944; train_edge_recon_loss: 320645.5833; train_gene_expr_recon_loss: 667952.0417; train_masked_gp_l1_reg_loss: 6935.6926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60906.4666; train_chrom_access_recon_loss: 436195.6285; train_global_loss: 1516242.1250; train_optim_loss: 1516242.1250; val_kl_reg_loss: 26720.8418; val_edge_recon_loss: 317951.6562; val_gene_expr_recon_loss: 672718.6250; val_masked_gp_l1_reg_loss: 6973.2446; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59095.0625; val_chrom_access_recon_loss: 437194.7812; val_global_loss: 1520654.2500; val_optim_loss: 1520654.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8925; val_auprc_score: 0.8746; val_best_acc_score: 0.8096; val_best_f1_score: 0.8229; train_kl_reg_loss: 28288.6684; train_edge_recon_loss: 311321.7083; train_gene_expr_recon_loss: 666128.0764; train_masked_gp_l1_reg_loss: 7004.7467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57709.7925; train_chrom_access_recon_loss: 435620.0035; train_global_loss: 1506073.0139; train_optim_loss: 1506073.0139; val_kl_reg_loss: 26702.1758; val_edge_recon_loss: 312273.0000; val_gene_expr_recon_loss: 670347.1250; val_masked_gp_l1_reg_loss: 7043.3843; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56010.1484; val_chrom_access_recon_loss: 436481.9688; val_global_loss: 1508857.8750; val_optim_loss: 1508857.8750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9041; val_auprc_score: 0.8854; val_best_acc_score: 0.8223; val_best_f1_score: 0.8335; train_kl_reg_loss: 26719.9121; train_edge_recon_loss: 307637.1285; train_gene_expr_recon_loss: 667078.9236; train_masked_gp_l1_reg_loss: 7075.1825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54717.8772; train_chrom_access_recon_loss: 436725.8681; train_global_loss: 1499954.8889; train_optim_loss: 1499954.8889; val_kl_reg_loss: 24856.0586; val_edge_recon_loss: 306755.4688; val_gene_expr_recon_loss: 669057.4375; val_masked_gp_l1_reg_loss: 7112.0894; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53132.0898; val_chrom_access_recon_loss: 435740.4688; val_global_loss: 1496653.6250; val_optim_loss: 1496653.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9060; val_auprc_score: 0.8792; val_best_acc_score: 0.8292; val_best_f1_score: 0.8398; train_kl_reg_loss: 25453.1009; train_edge_recon_loss: 304670.2569; train_gene_expr_recon_loss: 664061.7917; train_masked_gp_l1_reg_loss: 7143.2961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51921.6128; train_chrom_access_recon_loss: 435594.3611; train_global_loss: 1488844.4306; train_optim_loss: 1488844.4306; val_kl_reg_loss: 24615.7070; val_edge_recon_loss: 305578.3125; val_gene_expr_recon_loss: 666608.2500; val_masked_gp_l1_reg_loss: 7178.6792; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50434.7070; val_chrom_access_recon_loss: 435021.6250; val_global_loss: 1489437.2500; val_optim_loss: 1489437.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9093; val_auprc_score: 0.8820; val_best_acc_score: 0.8366; val_best_f1_score: 0.8466; train_kl_reg_loss: 25436.0035; train_edge_recon_loss: 302806.7326; train_gene_expr_recon_loss: 658798.8264; train_masked_gp_l1_reg_loss: 7208.0939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49302.0859; train_chrom_access_recon_loss: 433971.7292; train_global_loss: 1477523.4861; train_optim_loss: 1477523.4861; val_kl_reg_loss: 24729.7422; val_edge_recon_loss: 302288.6562; val_gene_expr_recon_loss: 665032.0000; val_masked_gp_l1_reg_loss: 7234.7256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47907.8125; val_chrom_access_recon_loss: 434428.3750; val_global_loss: 1481621.2500; val_optim_loss: 1481621.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9199; val_auprc_score: 0.9015; val_best_acc_score: 0.8437; val_best_f1_score: 0.8511; train_kl_reg_loss: 25569.7446; train_edge_recon_loss: 300154.8681; train_gene_expr_recon_loss: 663369.4444; train_masked_gp_l1_reg_loss: 7262.0710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46845.5521; train_chrom_access_recon_loss: 434418.9028; train_global_loss: 1477620.5694; train_optim_loss: 1477620.5694; val_kl_reg_loss: 24842.5137; val_edge_recon_loss: 299664.2188; val_gene_expr_recon_loss: 664396.2500; val_masked_gp_l1_reg_loss: 7283.6060; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45535.7070; val_chrom_access_recon_loss: 433663.1250; val_global_loss: 1475385.5000; val_optim_loss: 1475385.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9229; val_auprc_score: 0.9036; val_best_acc_score: 0.8517; val_best_f1_score: 0.8583; train_kl_reg_loss: 25882.6181; train_edge_recon_loss: 297720.6979; train_gene_expr_recon_loss: 659518.6250; train_masked_gp_l1_reg_loss: 7307.7941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44541.0234; train_chrom_access_recon_loss: 432557.9340; train_global_loss: 1467528.6806; train_optim_loss: 1467528.6806; val_kl_reg_loss: 25026.9492; val_edge_recon_loss: 297970.1562; val_gene_expr_recon_loss: 662217.1250; val_masked_gp_l1_reg_loss: 7326.4478; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43317.3242; val_chrom_access_recon_loss: 432929.9375; val_global_loss: 1468788.0000; val_optim_loss: 1468788.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9276; val_auprc_score: 0.9015; val_best_acc_score: 0.8603; val_best_f1_score: 0.8663; train_kl_reg_loss: 25652.2563; train_edge_recon_loss: 296967.7292; train_gene_expr_recon_loss: 655707.8403; train_masked_gp_l1_reg_loss: 7348.6219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42388.7491; train_chrom_access_recon_loss: 431353.0035; train_global_loss: 1459418.1944; train_optim_loss: 1459418.1944; val_kl_reg_loss: 24777.9570; val_edge_recon_loss: 296640.8438; val_gene_expr_recon_loss: 661247.1250; val_masked_gp_l1_reg_loss: 7358.5811; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41242.8203; val_chrom_access_recon_loss: 432455.2812; val_global_loss: 1463722.6250; val_optim_loss: 1463722.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9315; val_auprc_score: 0.9105; val_best_acc_score: 0.8681; val_best_f1_score: 0.8741; train_kl_reg_loss: 25746.1250; train_edge_recon_loss: 294553.2951; train_gene_expr_recon_loss: 656407.9306; train_masked_gp_l1_reg_loss: 7374.4913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40372.7752; train_chrom_access_recon_loss: 431307.1701; train_global_loss: 1455761.7639; train_optim_loss: 1455761.7639; val_kl_reg_loss: 25398.4512; val_edge_recon_loss: 293916.5625; val_gene_expr_recon_loss: 660030.1250; val_masked_gp_l1_reg_loss: 7386.8760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39298.0195; val_chrom_access_recon_loss: 431882.2188; val_global_loss: 1457912.2500; val_optim_loss: 1457912.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9395; val_auprc_score: 0.9227; val_best_acc_score: 0.8742; val_best_f1_score: 0.8800; train_kl_reg_loss: 25638.6641; train_edge_recon_loss: 294201.6910; train_gene_expr_recon_loss: 655260.9861; train_masked_gp_l1_reg_loss: 7403.1903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38482.6007; train_chrom_access_recon_loss: 432767.0729; train_global_loss: 1453754.2083; train_optim_loss: 1453754.2083; val_kl_reg_loss: 25114.4746; val_edge_recon_loss: 295733.6250; val_gene_expr_recon_loss: 658499.7500; val_masked_gp_l1_reg_loss: 7413.3066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37478.6289; val_chrom_access_recon_loss: 431167.1250; val_global_loss: 1455407.0000; val_optim_loss: 1455407.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9385; val_auprc_score: 0.9222; val_best_acc_score: 0.8724; val_best_f1_score: 0.8765; train_kl_reg_loss: 23218.7888; train_edge_recon_loss: 296639.1910; train_gene_expr_recon_loss: 1005776.4375; train_masked_gp_l1_reg_loss: 7515.7829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36573.4201; train_chrom_access_recon_loss: 455849.0799; train_global_loss: 1825572.6806; train_optim_loss: 1825572.6806; val_kl_reg_loss: 15299.5273; val_edge_recon_loss: 295139.4375; val_gene_expr_recon_loss: 1010099.3750; val_masked_gp_l1_reg_loss: 7718.7900; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35371.4688; val_chrom_access_recon_loss: 454474.6562; val_global_loss: 1818103.2500; val_optim_loss: 1818103.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9404; val_auprc_score: 0.9250; val_best_acc_score: 0.8725; val_best_f1_score: 0.8767; train_kl_reg_loss: 22323.3023; train_edge_recon_loss: 292211.4132; train_gene_expr_recon_loss: 1002834.0764; train_masked_gp_l1_reg_loss: 7912.5877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34378.4996; train_chrom_access_recon_loss: 454366.2535; train_global_loss: 1814026.1389; train_optim_loss: 1814026.1389; val_kl_reg_loss: 17083.9648; val_edge_recon_loss: 294562.4062; val_gene_expr_recon_loss: 1000573.0625; val_masked_gp_l1_reg_loss: 8143.9136; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33153.3711; val_chrom_access_recon_loss: 453310.9375; val_global_loss: 1806827.7500; val_optim_loss: 1806827.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9467; val_auprc_score: 0.9328; val_best_acc_score: 0.8843; val_best_f1_score: 0.8890; train_kl_reg_loss: 22074.5369; train_edge_recon_loss: 290924.9826; train_gene_expr_recon_loss: 995585.0278; train_masked_gp_l1_reg_loss: 8311.6232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32219.6897; train_chrom_access_recon_loss: 456020.1285; train_global_loss: 1805135.9861; train_optim_loss: 1805135.9861; val_kl_reg_loss: 17591.6758; val_edge_recon_loss: 290876.8750; val_gene_expr_recon_loss: 995941.8125; val_masked_gp_l1_reg_loss: 8504.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31081.3125; val_chrom_access_recon_loss: 452576.3125; val_global_loss: 1796572.2500; val_optim_loss: 1796572.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9475; val_auprc_score: 0.9331; val_best_acc_score: 0.8841; val_best_f1_score: 0.8881; train_kl_reg_loss: 21170.3724; train_edge_recon_loss: 289322.8993; train_gene_expr_recon_loss: 992922.7153; train_masked_gp_l1_reg_loss: 8639.7925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30220.8262; train_chrom_access_recon_loss: 454444.8125; train_global_loss: 1796721.4028; train_optim_loss: 1796721.4028; val_kl_reg_loss: 18400.9844; val_edge_recon_loss: 290230.7812; val_gene_expr_recon_loss: 992228.3750; val_masked_gp_l1_reg_loss: 8795.3135; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29176.9570; val_chrom_access_recon_loss: 451999.2812; val_global_loss: 1790831.7500; val_optim_loss: 1790831.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9485; val_auprc_score: 0.9322; val_best_acc_score: 0.8874; val_best_f1_score: 0.8911; train_kl_reg_loss: 21321.1395; train_edge_recon_loss: 288961.9757; train_gene_expr_recon_loss: 991220.2917; train_masked_gp_l1_reg_loss: 8777.9768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29057.2910; train_chrom_access_recon_loss: 452823.7014; train_global_loss: 1792162.3889; train_optim_loss: 1792162.3889; val_kl_reg_loss: 18657.0742; val_edge_recon_loss: 288362.8750; val_gene_expr_recon_loss: 990843.6875; val_masked_gp_l1_reg_loss: 8763.0723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28911.7168; val_chrom_access_recon_loss: 451859.7500; val_global_loss: 1787398.2500; val_optim_loss: 1787398.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9489; val_auprc_score: 0.9352; val_best_acc_score: 0.8863; val_best_f1_score: 0.8900; train_kl_reg_loss: 21312.5449; train_edge_recon_loss: 289246.8993; train_gene_expr_recon_loss: 984887.7778; train_masked_gp_l1_reg_loss: 8764.5139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28810.0673; train_chrom_access_recon_loss: 452168.2153; train_global_loss: 1785190.0417; train_optim_loss: 1785190.0417; val_kl_reg_loss: 18536.2188; val_edge_recon_loss: 290138.1562; val_gene_expr_recon_loss: 991036.6250; val_masked_gp_l1_reg_loss: 8763.9590; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28682.4434; val_chrom_access_recon_loss: 451937.2500; val_global_loss: 1789094.7500; val_optim_loss: 1789094.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9501; val_auprc_score: 0.9322; val_best_acc_score: 0.8905; val_best_f1_score: 0.8936; train_kl_reg_loss: 21208.9052; train_edge_recon_loss: 287475.9826; train_gene_expr_recon_loss: 983992.4444; train_masked_gp_l1_reg_loss: 8766.4901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28586.5456; train_chrom_access_recon_loss: 451716.3646; train_global_loss: 1781746.7222; train_optim_loss: 1781746.7222; val_kl_reg_loss: 18640.4219; val_edge_recon_loss: 289041.0625; val_gene_expr_recon_loss: 990467.1250; val_masked_gp_l1_reg_loss: 8770.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28468.8086; val_chrom_access_recon_loss: 451743.6875; val_global_loss: 1787131.5000; val_optim_loss: 1787131.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9521; val_auprc_score: 0.9386; val_best_acc_score: 0.8895; val_best_f1_score: 0.8929; train_kl_reg_loss: 21269.2426; train_edge_recon_loss: 289056.7222; train_gene_expr_recon_loss: 988354.5903; train_masked_gp_l1_reg_loss: 8774.8506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28377.5627; train_chrom_access_recon_loss: 452521.2083; train_global_loss: 1788354.1667; train_optim_loss: 1788354.1667; val_kl_reg_loss: 18762.6543; val_edge_recon_loss: 290128.5938; val_gene_expr_recon_loss: 990061.6250; val_masked_gp_l1_reg_loss: 8781.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28266.8555; val_chrom_access_recon_loss: 451695.4062; val_global_loss: 1787696.2500; val_optim_loss: 1787696.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 33 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9360
val AUPRC score: 0.9209
val best accuracy score: 0.8711
val best F1 score: 0.8769
val target rna MSE score: 3.9286
val source rna MSE score: 3.1659
val target atac MSE score: 0.1345
val source atac MSE score: 0.0199
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
