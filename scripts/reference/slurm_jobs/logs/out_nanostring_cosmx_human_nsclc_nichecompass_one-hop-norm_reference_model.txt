First script finished. Launching follow up script.
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9913; val_auprc_score: 0.9966; val_best_acc_score: 0.9731; val_best_f1_score: 0.9822; train_kl_reg_loss: 4310.7107; train_edge_recon_loss: 130597.2101; train_gene_expr_recon_loss: 170956.4907; train_masked_gp_l1_reg_loss: 703.3879; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306567.7992; train_optim_loss: 306567.7992; val_kl_reg_loss: 4235.0646; val_edge_recon_loss: 130949.4269; val_gene_expr_recon_loss: 171564.8049; val_masked_gp_l1_reg_loss: 703.6618; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307452.9532; val_optim_loss: 307452.9532
Run timestamp: 12062023_123416.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1064, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1064, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1064, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 254337
Number of validation nodes: 28260
Number of training edges: 602647
Number of validation edges: 66960
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9531; val_auprc_score: 0.9791; val_best_acc_score: 0.9276; val_best_f1_score: 0.9527; train_kl_reg_loss: 4091.0111; train_edge_recon_loss: 135431.6853; train_gene_expr_recon_loss: 190852.6388; train_masked_gp_l1_reg_loss: 687.4872; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331062.8233; train_optim_loss: 331062.8233; val_kl_reg_loss: 3990.5956; val_edge_recon_loss: 134248.8319; val_gene_expr_recon_loss: 184777.5279; val_masked_gp_l1_reg_loss: 742.9929; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323759.9550; val_optim_loss: 323759.9550
Run timestamp: 12062023_123411.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1064, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1064, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1064, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 254337
Number of validation nodes: 28260
Number of training edges: 602647
Number of validation edges: 66960
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9526; val_auprc_score: 0.9788; val_best_acc_score: 0.9256; val_best_f1_score: 0.9513; train_kl_reg_loss: 4065.6686; train_edge_recon_loss: 135977.5894; train_gene_expr_recon_loss: 191549.0378; train_masked_gp_l1_reg_loss: 677.4396; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332269.7373; train_optim_loss: 332269.7373; val_kl_reg_loss: 3995.8293; val_edge_recon_loss: 135239.4360; val_gene_expr_recon_loss: 184839.2446; val_masked_gp_l1_reg_loss: 735.7154; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324810.2268; val_optim_loss: 324810.2268
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9615; val_auprc_score: 0.9834; val_best_acc_score: 0.9339; val_best_f1_score: 0.9568; train_kl_reg_loss: 3998.8187; train_edge_recon_loss: 132094.5078; train_gene_expr_recon_loss: 182623.8014; train_masked_gp_l1_reg_loss: 761.0079; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319478.1366; train_optim_loss: 319478.1366; val_kl_reg_loss: 3776.2706; val_edge_recon_loss: 135002.2067; val_gene_expr_recon_loss: 180086.2287; val_masked_gp_l1_reg_loss: 773.8345; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319638.5497; val_optim_loss: 319638.5497
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9641; val_auprc_score: 0.9849; val_best_acc_score: 0.9338; val_best_f1_score: 0.9567; train_kl_reg_loss: 4005.0837; train_edge_recon_loss: 132277.5351; train_gene_expr_recon_loss: 183152.2722; train_masked_gp_l1_reg_loss: 750.9938; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320185.8836; train_optim_loss: 320185.8836; val_kl_reg_loss: 3778.0720; val_edge_recon_loss: 135033.5027; val_gene_expr_recon_loss: 180449.3210; val_masked_gp_l1_reg_loss: 769.3202; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320030.2088; val_optim_loss: 320030.2088
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9674; val_auprc_score: 0.9861; val_best_acc_score: 0.9390; val_best_f1_score: 0.9600; train_kl_reg_loss: 4013.1541; train_edge_recon_loss: 131513.0745; train_gene_expr_recon_loss: 178870.9308; train_masked_gp_l1_reg_loss: 777.2807; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315174.4393; train_optim_loss: 315174.4393; val_kl_reg_loss: 3917.6713; val_edge_recon_loss: 134524.4500; val_gene_expr_recon_loss: 177333.6937; val_masked_gp_l1_reg_loss: 781.4033; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316557.2202; val_optim_loss: 316557.2202
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9697; val_auprc_score: 0.9874; val_best_acc_score: 0.9399; val_best_f1_score: 0.9606; train_kl_reg_loss: 4019.0623; train_edge_recon_loss: 131730.5951; train_gene_expr_recon_loss: 179352.7830; train_masked_gp_l1_reg_loss: 774.4598; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315876.9007; train_optim_loss: 315876.9007; val_kl_reg_loss: 3982.5703; val_edge_recon_loss: 134597.5152; val_gene_expr_recon_loss: 176956.0798; val_masked_gp_l1_reg_loss: 777.5671; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316313.7277; val_optim_loss: 316313.7277
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9692; val_auprc_score: 0.9868; val_best_acc_score: 0.9402; val_best_f1_score: 0.9609; train_kl_reg_loss: 4085.9953; train_edge_recon_loss: 131561.1191; train_gene_expr_recon_loss: 176224.0194; train_masked_gp_l1_reg_loss: 777.9715; train_group_lasso_reg_loss: 0.0000; train_global_loss: 312649.1070; train_optim_loss: 312649.1070; val_kl_reg_loss: 4088.2791; val_edge_recon_loss: 135699.6971; val_gene_expr_recon_loss: 174561.1785; val_masked_gp_l1_reg_loss: 772.9891; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315122.1558; val_optim_loss: 315122.1558

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9916; val_auprc_score: 0.9965; val_best_acc_score: 0.9731; val_best_f1_score: 0.9822; train_kl_reg_loss: 4307.9361; train_edge_recon_loss: 130108.4980; train_gene_expr_recon_loss: 170862.4096; train_masked_gp_l1_reg_loss: 696.0804; train_group_lasso_reg_loss: 0.0000; train_global_loss: 305974.9238; train_optim_loss: 305974.9238; val_kl_reg_loss: 4250.4538; val_edge_recon_loss: 130915.3253; val_gene_expr_recon_loss: 171275.0807; val_masked_gp_l1_reg_loss: 695.2061; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307136.0802; val_optim_loss: 307136.0802
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9706; val_auprc_score: 0.9877; val_best_acc_score: 0.9410; val_best_f1_score: 0.9611; train_kl_reg_loss: 4073.5149; train_edge_recon_loss: 131680.1020; train_gene_expr_recon_loss: 176556.2186; train_masked_gp_l1_reg_loss: 778.9627; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313088.7972; train_optim_loss: 313088.7972; val_kl_reg_loss: 3971.4591; val_edge_recon_loss: 135790.7820; val_gene_expr_recon_loss: 174709.2829; val_masked_gp_l1_reg_loss: 776.6411; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315248.1795; val_optim_loss: 315248.1795
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9729; val_auprc_score: 0.9889; val_best_acc_score: 0.9428; val_best_f1_score: 0.9624; train_kl_reg_loss: 4166.7239; train_edge_recon_loss: 131886.8541; train_gene_expr_recon_loss: 173810.8562; train_masked_gp_l1_reg_loss: 780.3036; train_group_lasso_reg_loss: 0.0000; train_global_loss: 310644.7376; train_optim_loss: 310644.7376; val_kl_reg_loss: 4243.5070; val_edge_recon_loss: 134944.4883; val_gene_expr_recon_loss: 173099.8324; val_masked_gp_l1_reg_loss: 788.7167; val_group_lasso_reg_loss: 0.0000; val_global_loss: 313076.5473; val_optim_loss: 313076.5473
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9713; val_auprc_score: 0.9881; val_best_acc_score: 0.9421; val_best_f1_score: 0.9620; train_kl_reg_loss: 4249.9179; train_edge_recon_loss: 131609.3095; train_gene_expr_recon_loss: 172066.0166; train_masked_gp_l1_reg_loss: 790.4458; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308715.6906; train_optim_loss: 308715.6906; val_kl_reg_loss: 4184.8057; val_edge_recon_loss: 135260.3794; val_gene_expr_recon_loss: 170957.9138; val_masked_gp_l1_reg_loss: 792.6810; val_group_lasso_reg_loss: 0.0000; val_global_loss: 311195.7846; val_optim_loss: 311195.7846
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9722; val_auprc_score: 0.9882; val_best_acc_score: 0.9438; val_best_f1_score: 0.9631; train_kl_reg_loss: 4160.6396; train_edge_recon_loss: 131869.2572; train_gene_expr_recon_loss: 174163.6945; train_masked_gp_l1_reg_loss: 780.6182; train_group_lasso_reg_loss: 0.0000; train_global_loss: 310974.2091; train_optim_loss: 310974.2091; val_kl_reg_loss: 4088.9287; val_edge_recon_loss: 135207.0323; val_gene_expr_recon_loss: 172495.1238; val_masked_gp_l1_reg_loss: 782.5684; val_group_lasso_reg_loss: 0.0000; val_global_loss: 312573.6463; val_optim_loss: 312573.6463
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9715; val_auprc_score: 0.9878; val_best_acc_score: 0.9445; val_best_f1_score: 0.9636; train_kl_reg_loss: 4304.7251; train_edge_recon_loss: 131566.7429; train_gene_expr_recon_loss: 170619.3191; train_masked_gp_l1_reg_loss: 797.3425; train_group_lasso_reg_loss: 0.0000; train_global_loss: 307288.1300; train_optim_loss: 307288.1300; val_kl_reg_loss: 4264.3213; val_edge_recon_loss: 135479.5855; val_gene_expr_recon_loss: 170236.3925; val_masked_gp_l1_reg_loss: 806.2035; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310786.5161; val_optim_loss: 310786.5161
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9745; val_auprc_score: 0.9893; val_best_acc_score: 0.9463; val_best_f1_score: 0.9647; train_kl_reg_loss: 4248.2880; train_edge_recon_loss: 131247.4476; train_gene_expr_recon_loss: 172323.7115; train_masked_gp_l1_reg_loss: 790.6325; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308610.0785; train_optim_loss: 308610.0785; val_kl_reg_loss: 4271.9185; val_edge_recon_loss: 135481.9112; val_gene_expr_recon_loss: 170960.0869; val_masked_gp_l1_reg_loss: 798.7462; val_group_lasso_reg_loss: 0.0000; val_global_loss: 311512.6667; val_optim_loss: 311512.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9747; val_auprc_score: 0.9893; val_best_acc_score: 0.9474; val_best_f1_score: 0.9653; train_kl_reg_loss: 4351.2751; train_edge_recon_loss: 131640.2074; train_gene_expr_recon_loss: 169675.8986; train_masked_gp_l1_reg_loss: 809.4424; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306476.8238; train_optim_loss: 306476.8238; val_kl_reg_loss: 4244.1535; val_edge_recon_loss: 134775.6850; val_gene_expr_recon_loss: 169363.3816; val_masked_gp_l1_reg_loss: 813.4350; val_group_lasso_reg_loss: 0.0000; val_global_loss: 309196.6572; val_optim_loss: 309196.6572
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9918; val_auprc_score: 0.9967; val_best_acc_score: 0.9737; val_best_f1_score: 0.9826; train_kl_reg_loss: 4305.9734; train_edge_recon_loss: 130178.9651; train_gene_expr_recon_loss: 170808.9683; train_masked_gp_l1_reg_loss: 695.1834; train_group_lasso_reg_loss: 0.0000; train_global_loss: 305989.0898; train_optim_loss: 305989.0898; val_kl_reg_loss: 4260.0673; val_edge_recon_loss: 131464.0635; val_gene_expr_recon_loss: 171433.3016; val_masked_gp_l1_reg_loss: 695.2149; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307852.6503; val_optim_loss: 307852.6503
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9721; val_auprc_score: 0.9880; val_best_acc_score: 0.9459; val_best_f1_score: 0.9645; train_kl_reg_loss: 4306.7450; train_edge_recon_loss: 131445.2621; train_gene_expr_recon_loss: 170835.8289; train_masked_gp_l1_reg_loss: 803.2840; train_group_lasso_reg_loss: 0.0000; train_global_loss: 307391.1203; train_optim_loss: 307391.1203; val_kl_reg_loss: 4297.1993; val_edge_recon_loss: 135834.8520; val_gene_expr_recon_loss: 169544.3461; val_masked_gp_l1_reg_loss: 807.7888; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310484.1771; val_optim_loss: 310484.1771
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9758; val_auprc_score: 0.9900; val_best_acc_score: 0.9473; val_best_f1_score: 0.9653; train_kl_reg_loss: 4391.9850; train_edge_recon_loss: 131595.4127; train_gene_expr_recon_loss: 168898.2865; train_masked_gp_l1_reg_loss: 819.3813; train_group_lasso_reg_loss: 0.0000; train_global_loss: 305705.0666; train_optim_loss: 305705.0666; val_kl_reg_loss: 4160.1319; val_edge_recon_loss: 135641.6965; val_gene_expr_recon_loss: 168744.9105; val_masked_gp_l1_reg_loss: 825.0519; val_group_lasso_reg_loss: 0.0000; val_global_loss: 309371.8035; val_optim_loss: 309371.8035
Run timestamp: 12062023_123009.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1064, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1064, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1064, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 638080
Number of validation nodes: 70898
Number of training edges: 2908935
Number of validation edges: 323215
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9740; val_auprc_score: 0.9960; val_best_acc_score: 0.9621; val_best_f1_score: 0.9788; train_kl_reg_loss: 3036.6609; train_edge_recon_loss: 61996.0148; train_gene_expr_recon_loss: 177264.8586; train_masked_gp_l1_reg_loss: 592.2203; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242889.7545; train_optim_loss: 242889.7545; val_kl_reg_loss: 3041.8917; val_edge_recon_loss: 60888.7188; val_gene_expr_recon_loss: 170849.9475; val_masked_gp_l1_reg_loss: 627.5363; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235408.0889; val_optim_loss: 235408.0889
Run timestamp: 12062023_123012.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1064, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1064, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1064, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 638080
Number of validation nodes: 70898
Number of training edges: 2908935
Number of validation edges: 323215
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9746; val_auprc_score: 0.9961; val_best_acc_score: 0.9620; val_best_f1_score: 0.9788; train_kl_reg_loss: 3041.7392; train_edge_recon_loss: 62023.2434; train_gene_expr_recon_loss: 176753.7499; train_masked_gp_l1_reg_loss: 589.5602; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242408.2928; train_optim_loss: 242408.2928; val_kl_reg_loss: 3121.4975; val_edge_recon_loss: 61369.8910; val_gene_expr_recon_loss: 170708.3344; val_masked_gp_l1_reg_loss: 625.7234; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235825.4422; val_optim_loss: 235825.4422
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9751; val_auprc_score: 0.9894; val_best_acc_score: 0.9482; val_best_f1_score: 0.9659; train_kl_reg_loss: 4357.9871; train_edge_recon_loss: 131351.5095; train_gene_expr_recon_loss: 169710.0883; train_masked_gp_l1_reg_loss: 817.4481; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306237.0323; train_optim_loss: 306237.0323; val_kl_reg_loss: 4237.6275; val_edge_recon_loss: 135139.9237; val_gene_expr_recon_loss: 168992.6274; val_masked_gp_l1_reg_loss: 823.1793; val_group_lasso_reg_loss: 0.0000; val_global_loss: 309193.3655; val_optim_loss: 309193.3655
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9750; val_auprc_score: 0.9895; val_best_acc_score: 0.9476; val_best_f1_score: 0.9655; train_kl_reg_loss: 4426.7219; train_edge_recon_loss: 131477.6162; train_gene_expr_recon_loss: 168323.7419; train_masked_gp_l1_reg_loss: 827.8733; train_group_lasso_reg_loss: 0.0000; train_global_loss: 305055.9524; train_optim_loss: 305055.9524; val_kl_reg_loss: 4359.6633; val_edge_recon_loss: 135143.6693; val_gene_expr_recon_loss: 168176.0017; val_masked_gp_l1_reg_loss: 832.7900; val_group_lasso_reg_loss: 0.0000; val_global_loss: 308512.1141; val_optim_loss: 308512.1141
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9748; val_auprc_score: 0.9893; val_best_acc_score: 0.9486; val_best_f1_score: 0.9662; train_kl_reg_loss: 4452.8185; train_edge_recon_loss: 131452.2824; train_gene_expr_recon_loss: 167780.1506; train_masked_gp_l1_reg_loss: 836.3261; train_group_lasso_reg_loss: 0.0000; train_global_loss: 304521.5772; train_optim_loss: 304521.5772; val_kl_reg_loss: 4453.0968; val_edge_recon_loss: 135365.7504; val_gene_expr_recon_loss: 167858.1082; val_masked_gp_l1_reg_loss: 845.3409; val_group_lasso_reg_loss: 0.0000; val_global_loss: 308522.2969; val_optim_loss: 308522.2969
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9728; val_auprc_score: 0.9883; val_best_acc_score: 0.9480; val_best_f1_score: 0.9659; train_kl_reg_loss: 4406.6388; train_edge_recon_loss: 131461.5204; train_gene_expr_recon_loss: 168902.9688; train_masked_gp_l1_reg_loss: 832.5268; train_group_lasso_reg_loss: 0.0000; train_global_loss: 305603.6543; train_optim_loss: 305603.6543; val_kl_reg_loss: 4263.6730; val_edge_recon_loss: 134587.6928; val_gene_expr_recon_loss: 168069.5888; val_masked_gp_l1_reg_loss: 833.7775; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307754.7367; val_optim_loss: 307754.7367
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9753; val_auprc_score: 0.9898; val_best_acc_score: 0.9492; val_best_f1_score: 0.9666; train_kl_reg_loss: 4479.6214; train_edge_recon_loss: 131633.6784; train_gene_expr_recon_loss: 167292.1034; train_masked_gp_l1_reg_loss: 844.7915; train_group_lasso_reg_loss: 0.0000; train_global_loss: 304250.1950; train_optim_loss: 304250.1950; val_kl_reg_loss: 4352.9561; val_edge_recon_loss: 134778.3379; val_gene_expr_recon_loss: 167425.8324; val_masked_gp_l1_reg_loss: 848.1527; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307405.2822; val_optim_loss: 307405.2822
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9767; val_auprc_score: 0.9903; val_best_acc_score: 0.9496; val_best_f1_score: 0.9669; train_kl_reg_loss: 4435.8476; train_edge_recon_loss: 131814.4139; train_gene_expr_recon_loss: 168309.4379; train_masked_gp_l1_reg_loss: 840.4762; train_group_lasso_reg_loss: 0.0000; train_global_loss: 305400.1758; train_optim_loss: 305400.1758; val_kl_reg_loss: 4349.7279; val_edge_recon_loss: 134131.0420; val_gene_expr_recon_loss: 167394.8198; val_masked_gp_l1_reg_loss: 843.4787; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306719.0573; val_optim_loss: 306719.0573
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9917; val_auprc_score: 0.9968; val_best_acc_score: 0.9738; val_best_f1_score: 0.9827; train_kl_reg_loss: 4302.2173; train_edge_recon_loss: 130099.2874; train_gene_expr_recon_loss: 170797.1460; train_masked_gp_l1_reg_loss: 695.3167; train_group_lasso_reg_loss: 0.0000; train_global_loss: 305893.9673; train_optim_loss: 305893.9673; val_kl_reg_loss: 4245.5208; val_edge_recon_loss: 129985.3754; val_gene_expr_recon_loss: 171339.2568; val_masked_gp_l1_reg_loss: 695.3583; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306265.4973; val_optim_loss: 306265.4973
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9761; val_auprc_score: 0.9899; val_best_acc_score: 0.9501; val_best_f1_score: 0.9673; train_kl_reg_loss: 4505.1873; train_edge_recon_loss: 131313.6859; train_gene_expr_recon_loss: 167022.7681; train_masked_gp_l1_reg_loss: 852.1951; train_group_lasso_reg_loss: 0.0000; train_global_loss: 303693.8371; train_optim_loss: 303693.8371; val_kl_reg_loss: 4419.4363; val_edge_recon_loss: 134298.9137; val_gene_expr_recon_loss: 166873.2280; val_masked_gp_l1_reg_loss: 857.6120; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306449.2027; val_optim_loss: 306449.2027
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9759; val_auprc_score: 0.9899; val_best_acc_score: 0.9499; val_best_f1_score: 0.9671; train_kl_reg_loss: 4463.0783; train_edge_recon_loss: 131435.4210; train_gene_expr_recon_loss: 167715.8956; train_masked_gp_l1_reg_loss: 850.0239; train_group_lasso_reg_loss: 0.0000; train_global_loss: 304464.4189; train_optim_loss: 304464.4189; val_kl_reg_loss: 4430.1192; val_edge_recon_loss: 134977.4062; val_gene_expr_recon_loss: 166929.7363; val_masked_gp_l1_reg_loss: 854.7962; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307192.0417; val_optim_loss: 307192.0417
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9768; val_auprc_score: 0.9903; val_best_acc_score: 0.9511; val_best_f1_score: 0.9679; train_kl_reg_loss: 4523.5259; train_edge_recon_loss: 131225.6459; train_gene_expr_recon_loss: 166604.1939; train_masked_gp_l1_reg_loss: 859.9956; train_group_lasso_reg_loss: 0.0000; train_global_loss: 303213.3615; train_optim_loss: 303213.3615; val_kl_reg_loss: 4401.0969; val_edge_recon_loss: 135468.7144; val_gene_expr_recon_loss: 166683.3873; val_masked_gp_l1_reg_loss: 865.8282; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307419.0431; val_optim_loss: 307419.0431
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9767; val_auprc_score: 0.9901; val_best_acc_score: 0.9509; val_best_f1_score: 0.9676; train_kl_reg_loss: 4491.8846; train_edge_recon_loss: 131376.1343; train_gene_expr_recon_loss: 167157.4462; train_masked_gp_l1_reg_loss: 858.9829; train_group_lasso_reg_loss: 0.0000; train_global_loss: 303884.4472; train_optim_loss: 303884.4472; val_kl_reg_loss: 4402.6836; val_edge_recon_loss: 135253.2942; val_gene_expr_recon_loss: 166847.8196; val_masked_gp_l1_reg_loss: 862.3883; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307366.1733; val_optim_loss: 307366.1733
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9752; val_auprc_score: 0.9897; val_best_acc_score: 0.9491; val_best_f1_score: 0.9665; train_kl_reg_loss: 4544.7219; train_edge_recon_loss: 131383.3769; train_gene_expr_recon_loss: 166387.7325; train_masked_gp_l1_reg_loss: 867.6269; train_group_lasso_reg_loss: 0.0000; train_global_loss: 303183.4593; train_optim_loss: 303183.4593; val_kl_reg_loss: 4433.7758; val_edge_recon_loss: 135359.0114; val_gene_expr_recon_loss: 166415.0888; val_masked_gp_l1_reg_loss: 869.8211; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307077.6908; val_optim_loss: 307077.6908
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9769; val_auprc_score: 0.9902; val_best_acc_score: 0.9510; val_best_f1_score: 0.9678; train_kl_reg_loss: 4558.9236; train_edge_recon_loss: 131667.8256; train_gene_expr_recon_loss: 166106.0760; train_masked_gp_l1_reg_loss: 874.9563; train_group_lasso_reg_loss: 0.0000; train_global_loss: 303207.7818; train_optim_loss: 303207.7818; val_kl_reg_loss: 4502.8039; val_edge_recon_loss: 135054.9137; val_gene_expr_recon_loss: 166443.6577; val_masked_gp_l1_reg_loss: 879.4680; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306880.8456; val_optim_loss: 306880.8456
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9782; val_auprc_score: 0.9907; val_best_acc_score: 0.9522; val_best_f1_score: 0.9686; train_kl_reg_loss: 4511.4955; train_edge_recon_loss: 131315.4512; train_gene_expr_recon_loss: 166847.4061; train_masked_gp_l1_reg_loss: 864.9242; train_group_lasso_reg_loss: 0.0000; train_global_loss: 303539.2776; train_optim_loss: 303539.2776; val_kl_reg_loss: 4352.5517; val_edge_recon_loss: 134590.9742; val_gene_expr_recon_loss: 166160.5821; val_masked_gp_l1_reg_loss: 866.8767; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305970.9815; val_optim_loss: 305970.9815

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9778; val_auprc_score: 0.9905; val_best_acc_score: 0.9522; val_best_f1_score: 0.9685; train_kl_reg_loss: 4506.1113; train_edge_recon_loss: 131044.0437; train_gene_expr_recon_loss: 165450.5792; train_masked_gp_l1_reg_loss: 830.6802; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301831.4140; train_optim_loss: 301831.4140; val_kl_reg_loss: 4411.5256; val_edge_recon_loss: 136030.8004; val_gene_expr_recon_loss: 165968.0002; val_masked_gp_l1_reg_loss: 825.9418; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307236.2647; val_optim_loss: 307236.2647
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9920; val_auprc_score: 0.9968; val_best_acc_score: 0.9740; val_best_f1_score: 0.9828; train_kl_reg_loss: 4303.4946; train_edge_recon_loss: 130273.3905; train_gene_expr_recon_loss: 170841.8943; train_masked_gp_l1_reg_loss: 695.4890; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306114.2687; train_optim_loss: 306114.2687; val_kl_reg_loss: 4250.0244; val_edge_recon_loss: 131090.0293; val_gene_expr_recon_loss: 171428.2363; val_masked_gp_l1_reg_loss: 695.5515; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307463.8514; val_optim_loss: 307463.8514
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9775; val_auprc_score: 0.9907; val_best_acc_score: 0.9519; val_best_f1_score: 0.9685; train_kl_reg_loss: 4530.6197; train_edge_recon_loss: 131448.4426; train_gene_expr_recon_loss: 166621.8561; train_masked_gp_l1_reg_loss: 874.9731; train_group_lasso_reg_loss: 0.0000; train_global_loss: 303475.8925; train_optim_loss: 303475.8925; val_kl_reg_loss: 4484.1196; val_edge_recon_loss: 134397.2550; val_gene_expr_recon_loss: 166058.3478; val_masked_gp_l1_reg_loss: 879.5300; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305819.2543; val_optim_loss: 305819.2543
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9787; val_auprc_score: 0.9911; val_best_acc_score: 0.9519; val_best_f1_score: 0.9683; train_kl_reg_loss: 4497.5742; train_edge_recon_loss: 130888.9667; train_gene_expr_recon_loss: 165329.8474; train_masked_gp_l1_reg_loss: 825.1699; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301541.5580; train_optim_loss: 301541.5580; val_kl_reg_loss: 4406.5953; val_edge_recon_loss: 135196.6751; val_gene_expr_recon_loss: 165824.0568; val_masked_gp_l1_reg_loss: 825.1159; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306252.4498; val_optim_loss: 306252.4498
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9768; val_auprc_score: 0.9901; val_best_acc_score: 0.9524; val_best_f1_score: 0.9687; train_kl_reg_loss: 4546.4958; train_edge_recon_loss: 131377.6842; train_gene_expr_recon_loss: 166280.7612; train_masked_gp_l1_reg_loss: 885.2787; train_group_lasso_reg_loss: 0.0000; train_global_loss: 303090.2201; train_optim_loss: 303090.2201; val_kl_reg_loss: 4397.8533; val_edge_recon_loss: 135614.1835; val_gene_expr_recon_loss: 166106.6148; val_masked_gp_l1_reg_loss: 886.7825; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307005.4318; val_optim_loss: 307005.4318
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9769; val_auprc_score: 0.9903; val_best_acc_score: 0.9519; val_best_f1_score: 0.9684; train_kl_reg_loss: 4493.8002; train_edge_recon_loss: 131412.7245; train_gene_expr_recon_loss: 165334.0669; train_masked_gp_l1_reg_loss: 825.2471; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302065.8398; train_optim_loss: 302065.8398; val_kl_reg_loss: 4386.7198; val_edge_recon_loss: 134922.2622; val_gene_expr_recon_loss: 165958.6281; val_masked_gp_l1_reg_loss: 825.7239; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306093.3262; val_optim_loss: 306093.3262
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9774; val_auprc_score: 0.9904; val_best_acc_score: 0.9525; val_best_f1_score: 0.9687; train_kl_reg_loss: 4553.2300; train_edge_recon_loss: 131371.6386; train_gene_expr_recon_loss: 166103.4374; train_masked_gp_l1_reg_loss: 889.6642; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302917.9709; train_optim_loss: 302917.9709; val_kl_reg_loss: 4472.1486; val_edge_recon_loss: 135027.8045; val_gene_expr_recon_loss: 165336.3681; val_masked_gp_l1_reg_loss: 893.6127; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305729.9451; val_optim_loss: 305729.9451
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9785; val_auprc_score: 0.9911; val_best_acc_score: 0.9532; val_best_f1_score: 0.9692; train_kl_reg_loss: 4492.1429; train_edge_recon_loss: 131379.2440; train_gene_expr_recon_loss: 165207.3376; train_masked_gp_l1_reg_loss: 826.1591; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301904.8838; train_optim_loss: 301904.8838; val_kl_reg_loss: 4398.4428; val_edge_recon_loss: 134682.9883; val_gene_expr_recon_loss: 165717.4399; val_masked_gp_l1_reg_loss: 827.0181; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305625.9015; val_optim_loss: 305625.9015
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9777; val_auprc_score: 0.9905; val_best_acc_score: 0.9524; val_best_f1_score: 0.9687; train_kl_reg_loss: 4496.2413; train_edge_recon_loss: 131340.0081; train_gene_expr_recon_loss: 165133.2758; train_masked_gp_l1_reg_loss: 827.7319; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301797.2579; train_optim_loss: 301797.2579; val_kl_reg_loss: 4400.5773; val_edge_recon_loss: 134947.0027; val_gene_expr_recon_loss: 165443.3075; val_masked_gp_l1_reg_loss: 828.4402; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305619.3243; val_optim_loss: 305619.3243
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9781; val_auprc_score: 0.9908; val_best_acc_score: 0.9526; val_best_f1_score: 0.9688; train_kl_reg_loss: 4563.3518; train_edge_recon_loss: 131371.1435; train_gene_expr_recon_loss: 165864.0936; train_masked_gp_l1_reg_loss: 894.8649; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302693.4535; train_optim_loss: 302693.4535; val_kl_reg_loss: 4393.2274; val_edge_recon_loss: 134699.6838; val_gene_expr_recon_loss: 165646.2801; val_masked_gp_l1_reg_loss: 899.0735; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305638.2524; val_optim_loss: 305638.2524
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9792; val_auprc_score: 0.9968; val_best_acc_score: 0.9671; val_best_f1_score: 0.9816; train_kl_reg_loss: 3225.2771; train_edge_recon_loss: 60730.3241; train_gene_expr_recon_loss: 169168.6299; train_masked_gp_l1_reg_loss: 630.9344; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233755.1653; train_optim_loss: 233755.1653; val_kl_reg_loss: 3174.3986; val_edge_recon_loss: 60999.1083; val_gene_expr_recon_loss: 167378.7040; val_masked_gp_l1_reg_loss: 630.9858; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232183.1955; val_optim_loss: 232183.1955
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9915; val_auprc_score: 0.9966; val_best_acc_score: 0.9736; val_best_f1_score: 0.9826; train_kl_reg_loss: 4305.4204; train_edge_recon_loss: 130459.0270; train_gene_expr_recon_loss: 170826.6531; train_masked_gp_l1_reg_loss: 695.6449; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306286.7455; train_optim_loss: 306286.7455; val_kl_reg_loss: 4237.4537; val_edge_recon_loss: 130537.0747; val_gene_expr_recon_loss: 171295.3690; val_masked_gp_l1_reg_loss: 695.8037; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306765.7104; val_optim_loss: 306765.7104
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9791; val_auprc_score: 0.9969; val_best_acc_score: 0.9659; val_best_f1_score: 0.9809; train_kl_reg_loss: 3224.6509; train_edge_recon_loss: 60616.5191; train_gene_expr_recon_loss: 168898.7206; train_masked_gp_l1_reg_loss: 622.7129; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233362.6036; train_optim_loss: 233362.6036; val_kl_reg_loss: 3234.8829; val_edge_recon_loss: 60926.2220; val_gene_expr_recon_loss: 167249.5665; val_masked_gp_l1_reg_loss: 623.4966; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232034.1715; val_optim_loss: 232034.1715
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9787; val_auprc_score: 0.9911; val_best_acc_score: 0.9531; val_best_f1_score: 0.9691; train_kl_reg_loss: 4496.4531; train_edge_recon_loss: 131016.4964; train_gene_expr_recon_loss: 165104.7971; train_masked_gp_l1_reg_loss: 829.2649; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301447.0112; train_optim_loss: 301447.0112; val_kl_reg_loss: 4416.4741; val_edge_recon_loss: 134881.1258; val_gene_expr_recon_loss: 165711.5997; val_masked_gp_l1_reg_loss: 830.3217; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305839.5137; val_optim_loss: 305839.5137
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9781; val_auprc_score: 0.9907; val_best_acc_score: 0.9528; val_best_f1_score: 0.9690; train_kl_reg_loss: 4575.9252; train_edge_recon_loss: 131234.6898; train_gene_expr_recon_loss: 165639.0680; train_masked_gp_l1_reg_loss: 901.8275; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302351.5114; train_optim_loss: 302351.5114; val_kl_reg_loss: 4516.9702; val_edge_recon_loss: 135064.0339; val_gene_expr_recon_loss: 165721.6958; val_masked_gp_l1_reg_loss: 903.5281; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306206.2306; val_optim_loss: 306206.2306
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9789; val_auprc_score: 0.9915; val_best_acc_score: 0.9534; val_best_f1_score: 0.9695; train_kl_reg_loss: 4489.7092; train_edge_recon_loss: 130988.9065; train_gene_expr_recon_loss: 165176.5334; train_masked_gp_l1_reg_loss: 831.4260; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301486.5748; train_optim_loss: 301486.5748; val_kl_reg_loss: 4416.7689; val_edge_recon_loss: 133753.7444; val_gene_expr_recon_loss: 165417.5339; val_masked_gp_l1_reg_loss: 832.7210; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304420.7652; val_optim_loss: 304420.7652
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9778; val_auprc_score: 0.9906; val_best_acc_score: 0.9538; val_best_f1_score: 0.9696; train_kl_reg_loss: 4591.8815; train_edge_recon_loss: 131503.1992; train_gene_expr_recon_loss: 165567.0688; train_masked_gp_l1_reg_loss: 907.8409; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302569.9906; train_optim_loss: 302569.9906; val_kl_reg_loss: 4447.6776; val_edge_recon_loss: 135306.1039; val_gene_expr_recon_loss: 165407.9657; val_masked_gp_l1_reg_loss: 908.4549; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306070.2164; val_optim_loss: 306070.2164
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9781; val_auprc_score: 0.9909; val_best_acc_score: 0.9521; val_best_f1_score: 0.9684; train_kl_reg_loss: 4491.7239; train_edge_recon_loss: 130950.4438; train_gene_expr_recon_loss: 165049.8862; train_masked_gp_l1_reg_loss: 833.9143; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301325.9688; train_optim_loss: 301325.9688; val_kl_reg_loss: 4411.5371; val_edge_recon_loss: 136503.6262; val_gene_expr_recon_loss: 165613.5481; val_masked_gp_l1_reg_loss: 835.7423; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307364.4612; val_optim_loss: 307364.4612
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9779; val_auprc_score: 0.9904; val_best_acc_score: 0.9542; val_best_f1_score: 0.9699; train_kl_reg_loss: 4603.8901; train_edge_recon_loss: 131347.7693; train_gene_expr_recon_loss: 165360.6203; train_masked_gp_l1_reg_loss: 913.6911; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302225.9710; train_optim_loss: 302225.9710; val_kl_reg_loss: 4430.5682; val_edge_recon_loss: 134414.2150; val_gene_expr_recon_loss: 165145.5670; val_masked_gp_l1_reg_loss: 919.5221; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304909.8826; val_optim_loss: 304909.8826
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9779; val_auprc_score: 0.9909; val_best_acc_score: 0.9535; val_best_f1_score: 0.9695; train_kl_reg_loss: 4497.9520; train_edge_recon_loss: 131071.3022; train_gene_expr_recon_loss: 164974.0083; train_masked_gp_l1_reg_loss: 836.4433; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301379.7060; train_optim_loss: 301379.7060; val_kl_reg_loss: 4390.4410; val_edge_recon_loss: 134123.8952; val_gene_expr_recon_loss: 165603.1579; val_masked_gp_l1_reg_loss: 837.4626; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304954.9635; val_optim_loss: 304954.9635
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9919; val_auprc_score: 0.9968; val_best_acc_score: 0.9737; val_best_f1_score: 0.9826; train_kl_reg_loss: 4300.5950; train_edge_recon_loss: 130378.9917; train_gene_expr_recon_loss: 170817.3760; train_masked_gp_l1_reg_loss: 695.8258; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306192.7881; train_optim_loss: 306192.7881; val_kl_reg_loss: 4230.8277; val_edge_recon_loss: 130661.3304; val_gene_expr_recon_loss: 171398.3310; val_masked_gp_l1_reg_loss: 695.9431; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306986.4289; val_optim_loss: 306986.4289
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9777; val_auprc_score: 0.9906; val_best_acc_score: 0.9542; val_best_f1_score: 0.9699; train_kl_reg_loss: 4601.9841; train_edge_recon_loss: 131040.3378; train_gene_expr_recon_loss: 165285.8124; train_masked_gp_l1_reg_loss: 921.2301; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301849.3652; train_optim_loss: 301849.3652; val_kl_reg_loss: 4395.3941; val_edge_recon_loss: 134399.3984; val_gene_expr_recon_loss: 165255.0182; val_masked_gp_l1_reg_loss: 921.0070; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304970.8087; val_optim_loss: 304970.8087
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9761; val_auprc_score: 0.9902; val_best_acc_score: 0.9488; val_best_f1_score: 0.9664; train_kl_reg_loss: 4103.7106; train_edge_recon_loss: 131379.0444; train_gene_expr_recon_loss: 165028.2799; train_masked_gp_l1_reg_loss: 838.2950; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301349.3308; train_optim_loss: 301349.3308; val_kl_reg_loss: 3571.2455; val_edge_recon_loss: 135855.0415; val_gene_expr_recon_loss: 165322.8535; val_masked_gp_l1_reg_loss: 839.4180; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305588.5478; val_optim_loss: 305588.5478
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9786; val_auprc_score: 0.9908; val_best_acc_score: 0.9541; val_best_f1_score: 0.9698; train_kl_reg_loss: 4609.8008; train_edge_recon_loss: 131302.4571; train_gene_expr_recon_loss: 165193.9205; train_masked_gp_l1_reg_loss: 922.1513; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302028.3315; train_optim_loss: 302028.3315; val_kl_reg_loss: 4508.9313; val_edge_recon_loss: 135193.1349; val_gene_expr_recon_loss: 164914.8999; val_masked_gp_l1_reg_loss: 920.1244; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305537.0914; val_optim_loss: 305537.0914

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9751; val_auprc_score: 0.9896; val_best_acc_score: 0.9493; val_best_f1_score: 0.9667; train_kl_reg_loss: 4025.1876; train_edge_recon_loss: 131071.9960; train_gene_expr_recon_loss: 164943.1026; train_masked_gp_l1_reg_loss: 834.5536; train_group_lasso_reg_loss: 0.0000; train_global_loss: 300874.8401; train_optim_loss: 300874.8401; val_kl_reg_loss: 3549.1117; val_edge_recon_loss: 136296.6776; val_gene_expr_recon_loss: 165378.2064; val_masked_gp_l1_reg_loss: 833.7837; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306057.7779; val_optim_loss: 306057.7779
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9786; val_auprc_score: 0.9911; val_best_acc_score: 0.9547; val_best_f1_score: 0.9703; train_kl_reg_loss: 4618.4560; train_edge_recon_loss: 131633.7621; train_gene_expr_recon_loss: 165050.2408; train_masked_gp_l1_reg_loss: 926.1968; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302228.6564; train_optim_loss: 302228.6564; val_kl_reg_loss: 4509.9631; val_edge_recon_loss: 134106.6422; val_gene_expr_recon_loss: 165156.3506; val_masked_gp_l1_reg_loss: 926.1343; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304699.0795; val_optim_loss: 304699.0795
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9759; val_auprc_score: 0.9900; val_best_acc_score: 0.9504; val_best_f1_score: 0.9673; train_kl_reg_loss: 4011.2339; train_edge_recon_loss: 131361.9359; train_gene_expr_recon_loss: 164940.3742; train_masked_gp_l1_reg_loss: 833.8111; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301147.3545; train_optim_loss: 301147.3545; val_kl_reg_loss: 3555.3230; val_edge_recon_loss: 135612.3401; val_gene_expr_recon_loss: 165411.4112; val_masked_gp_l1_reg_loss: 833.9081; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305412.9782; val_optim_loss: 305412.9782
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9790; val_auprc_score: 0.9908; val_best_acc_score: 0.9546; val_best_f1_score: 0.9701; train_kl_reg_loss: 4628.1549; train_edge_recon_loss: 131257.1161; train_gene_expr_recon_loss: 164905.5824; train_masked_gp_l1_reg_loss: 930.5263; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301721.3804; train_optim_loss: 301721.3804; val_kl_reg_loss: 4557.1336; val_edge_recon_loss: 135408.9348; val_gene_expr_recon_loss: 165215.3471; val_masked_gp_l1_reg_loss: 933.7586; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306115.1643; val_optim_loss: 306115.1643

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9917; val_auprc_score: 0.9966; val_best_acc_score: 0.9736; val_best_f1_score: 0.9826; train_kl_reg_loss: 4298.5473; train_edge_recon_loss: 130521.1015; train_gene_expr_recon_loss: 170775.4449; train_masked_gp_l1_reg_loss: 695.1026; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306290.1956; train_optim_loss: 306290.1956; val_kl_reg_loss: 4240.3634; val_edge_recon_loss: 131273.0819; val_gene_expr_recon_loss: 171248.2317; val_masked_gp_l1_reg_loss: 694.9594; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307456.6462; val_optim_loss: 307456.6462
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9757; val_auprc_score: 0.9899; val_best_acc_score: 0.9502; val_best_f1_score: 0.9674; train_kl_reg_loss: 3993.8128; train_edge_recon_loss: 131235.7154; train_gene_expr_recon_loss: 164904.8199; train_masked_gp_l1_reg_loss: 834.0300; train_group_lasso_reg_loss: 0.0000; train_global_loss: 300968.3784; train_optim_loss: 300968.3784; val_kl_reg_loss: 3552.3033; val_edge_recon_loss: 134945.1193; val_gene_expr_recon_loss: 165562.0656; val_masked_gp_l1_reg_loss: 834.0854; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304893.5800; val_optim_loss: 304893.5800
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9798; val_auprc_score: 0.9916; val_best_acc_score: 0.9550; val_best_f1_score: 0.9704; train_kl_reg_loss: 4632.1362; train_edge_recon_loss: 131474.0942; train_gene_expr_recon_loss: 164845.7282; train_masked_gp_l1_reg_loss: 936.2883; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301888.2469; train_optim_loss: 301888.2469; val_kl_reg_loss: 4605.2640; val_edge_recon_loss: 134529.6108; val_gene_expr_recon_loss: 165240.3627; val_masked_gp_l1_reg_loss: 935.7482; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305310.9891; val_optim_loss: 305310.9891
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9780; val_auprc_score: 0.9908; val_best_acc_score: 0.9533; val_best_f1_score: 0.9693; train_kl_reg_loss: 4099.6338; train_edge_recon_loss: 131427.0266; train_gene_expr_recon_loss: 164758.3642; train_masked_gp_l1_reg_loss: 932.9524; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301217.9778; train_optim_loss: 301217.9778; val_kl_reg_loss: 3724.4145; val_edge_recon_loss: 136074.6843; val_gene_expr_recon_loss: 165000.4401; val_masked_gp_l1_reg_loss: 936.4613; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305736.0090; val_optim_loss: 305736.0090
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9816; val_auprc_score: 0.9972; val_best_acc_score: 0.9685; val_best_f1_score: 0.9823; train_kl_reg_loss: 3335.7956; train_edge_recon_loss: 60691.7207; train_gene_expr_recon_loss: 166775.4439; train_masked_gp_l1_reg_loss: 635.0433; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231438.0034; train_optim_loss: 231438.0034; val_kl_reg_loss: 3331.3540; val_edge_recon_loss: 61456.3056; val_gene_expr_recon_loss: 165749.7651; val_masked_gp_l1_reg_loss: 638.4927; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231175.9252; val_optim_loss: 231175.9252
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9804; val_auprc_score: 0.9970; val_best_acc_score: 0.9685; val_best_f1_score: 0.9824; train_kl_reg_loss: 3345.2265; train_edge_recon_loss: 60685.6962; train_gene_expr_recon_loss: 166607.3299; train_masked_gp_l1_reg_loss: 630.6114; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231268.8642; train_optim_loss: 231268.8642; val_kl_reg_loss: 3263.9895; val_edge_recon_loss: 61156.0935; val_gene_expr_recon_loss: 165908.3225; val_masked_gp_l1_reg_loss: 638.8230; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230967.2337; val_optim_loss: 230967.2337

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9780; val_auprc_score: 0.9907; val_best_acc_score: 0.9536; val_best_f1_score: 0.9696; train_kl_reg_loss: 3909.3601; train_edge_recon_loss: 130927.6571; train_gene_expr_recon_loss: 164289.1361; train_masked_gp_l1_reg_loss: 896.3841; train_group_lasso_reg_loss: 0.0000; train_global_loss: 300022.5376; train_optim_loss: 300022.5376; val_kl_reg_loss: 3668.3831; val_edge_recon_loss: 134848.5779; val_gene_expr_recon_loss: 164509.8473; val_masked_gp_l1_reg_loss: 891.7990; val_group_lasso_reg_loss: 0.0000; val_global_loss: 303918.6207; val_optim_loss: 303918.6207
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9904; val_auprc_score: 0.9962; val_best_acc_score: 0.9696; val_best_f1_score: 0.9800; train_kl_reg_loss: 4154.4212; train_edge_recon_loss: 130548.7613; train_gene_expr_recon_loss: 170914.4128; train_masked_gp_l1_reg_loss: 695.0514; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306312.6478; train_optim_loss: 306312.6478; val_kl_reg_loss: 3478.2997; val_edge_recon_loss: 131910.8287; val_gene_expr_recon_loss: 171431.4945; val_masked_gp_l1_reg_loss: 695.1315; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307515.7485; val_optim_loss: 307515.7485

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 50 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9745
Val AUPRC score: 0.9894
Val best accuracy score: 0.9486
Val best F1 score: 0.9662
Val gene expr MSE score: 1.0073

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9784; val_auprc_score: 0.9908; val_best_acc_score: 0.9542; val_best_f1_score: 0.9699; train_kl_reg_loss: 3901.6039; train_edge_recon_loss: 130893.6438; train_gene_expr_recon_loss: 164153.4068; train_masked_gp_l1_reg_loss: 891.9220; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299840.5762; train_optim_loss: 299840.5762; val_kl_reg_loss: 3668.3167; val_edge_recon_loss: 134872.8409; val_gene_expr_recon_loss: 164728.2763; val_masked_gp_l1_reg_loss: 892.3081; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304161.7457; val_optim_loss: 304161.7457
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9786; val_auprc_score: 0.9911; val_best_acc_score: 0.9545; val_best_f1_score: 0.9701; train_kl_reg_loss: 3895.5171; train_edge_recon_loss: 130922.6492; train_gene_expr_recon_loss: 164129.3345; train_masked_gp_l1_reg_loss: 892.8191; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299840.3198; train_optim_loss: 299840.3198; val_kl_reg_loss: 3712.4912; val_edge_recon_loss: 135021.6007; val_gene_expr_recon_loss: 164732.3982; val_masked_gp_l1_reg_loss: 892.8523; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304359.3338; val_optim_loss: 304359.3338
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9790; val_auprc_score: 0.9911; val_best_acc_score: 0.9546; val_best_f1_score: 0.9702; train_kl_reg_loss: 3882.5113; train_edge_recon_loss: 130889.3125; train_gene_expr_recon_loss: 164050.0961; train_masked_gp_l1_reg_loss: 893.4238; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299715.3430; train_optim_loss: 299715.3430; val_kl_reg_loss: 3689.2190; val_edge_recon_loss: 134573.9714; val_gene_expr_recon_loss: 164543.5047; val_masked_gp_l1_reg_loss: 893.6877; val_group_lasso_reg_loss: 0.0000; val_global_loss: 303700.3840; val_optim_loss: 303700.3840
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9900; val_auprc_score: 0.9960; val_best_acc_score: 0.9701; val_best_f1_score: 0.9802; train_kl_reg_loss: 3958.8580; train_edge_recon_loss: 130727.4109; train_gene_expr_recon_loss: 170853.4111; train_masked_gp_l1_reg_loss: 695.1824; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306234.8602; train_optim_loss: 306234.8602; val_kl_reg_loss: 3342.2371; val_edge_recon_loss: 131076.8803; val_gene_expr_recon_loss: 171441.1102; val_masked_gp_l1_reg_loss: 695.2260; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306555.4473; val_optim_loss: 306555.4473
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9786; val_auprc_score: 0.9911; val_best_acc_score: 0.9550; val_best_f1_score: 0.9705; train_kl_reg_loss: 3866.4842; train_edge_recon_loss: 131190.3407; train_gene_expr_recon_loss: 164014.7023; train_masked_gp_l1_reg_loss: 894.6266; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299966.1540; train_optim_loss: 299966.1540; val_kl_reg_loss: 3676.7557; val_edge_recon_loss: 134088.3048; val_gene_expr_recon_loss: 164565.7109; val_masked_gp_l1_reg_loss: 895.2874; val_group_lasso_reg_loss: 0.0000; val_global_loss: 303226.0530; val_optim_loss: 303226.0530
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9788; val_auprc_score: 0.9910; val_best_acc_score: 0.9550; val_best_f1_score: 0.9704; train_kl_reg_loss: 3849.7723; train_edge_recon_loss: 130826.6217; train_gene_expr_recon_loss: 164064.7772; train_masked_gp_l1_reg_loss: 896.4671; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299637.6381; train_optim_loss: 299637.6381; val_kl_reg_loss: 3710.3847; val_edge_recon_loss: 134881.1602; val_gene_expr_recon_loss: 164349.1269; val_masked_gp_l1_reg_loss: 897.7362; val_group_lasso_reg_loss: 0.0000; val_global_loss: 303838.4223; val_optim_loss: 303838.4223
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9837; val_auprc_score: 0.9976; val_best_acc_score: 0.9708; val_best_f1_score: 0.9837; train_kl_reg_loss: 3417.3521; train_edge_recon_loss: 60772.6060; train_gene_expr_recon_loss: 165664.5185; train_masked_gp_l1_reg_loss: 640.3946; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230494.8710; train_optim_loss: 230494.8710; val_kl_reg_loss: 3326.1918; val_edge_recon_loss: 60940.3377; val_gene_expr_recon_loss: 164864.4212; val_masked_gp_l1_reg_loss: 644.3948; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229775.3409; val_optim_loss: 229775.3409
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9792; val_auprc_score: 0.9912; val_best_acc_score: 0.9557; val_best_f1_score: 0.9709; train_kl_reg_loss: 3838.9152; train_edge_recon_loss: 130745.0322; train_gene_expr_recon_loss: 163990.3946; train_masked_gp_l1_reg_loss: 898.4366; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299472.7785; train_optim_loss: 299472.7785; val_kl_reg_loss: 3718.7769; val_edge_recon_loss: 134757.4137; val_gene_expr_recon_loss: 164478.9619; val_masked_gp_l1_reg_loss: 898.5499; val_group_lasso_reg_loss: 0.0000; val_global_loss: 303853.7164; val_optim_loss: 303853.7164
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9823; val_auprc_score: 0.9973; val_best_acc_score: 0.9701; val_best_f1_score: 0.9832; train_kl_reg_loss: 3421.7953; train_edge_recon_loss: 60684.1556; train_gene_expr_recon_loss: 165505.4249; train_masked_gp_l1_reg_loss: 641.8146; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230253.1903; train_optim_loss: 230253.1903; val_kl_reg_loss: 3382.5027; val_edge_recon_loss: 61285.1591; val_gene_expr_recon_loss: 164906.4551; val_masked_gp_l1_reg_loss: 646.7205; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230220.8357; val_optim_loss: 230220.8357

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 168 min 52 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9902
Val AUPRC score: 0.9962
Val best accuracy score: 0.9694
Val best F1 score: 0.9798
Val gene expr MSE score: 1.0217

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9795; val_auprc_score: 0.9913; val_best_acc_score: 0.9564; val_best_f1_score: 0.9713; train_kl_reg_loss: 3828.3556; train_edge_recon_loss: 130813.8834; train_gene_expr_recon_loss: 164035.4477; train_masked_gp_l1_reg_loss: 900.1661; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299577.8531; train_optim_loss: 299577.8531; val_kl_reg_loss: 3721.5165; val_edge_recon_loss: 134715.2781; val_gene_expr_recon_loss: 164388.8738; val_masked_gp_l1_reg_loss: 900.7355; val_group_lasso_reg_loss: 0.0000; val_global_loss: 303726.4181; val_optim_loss: 303726.4181

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9801; val_auprc_score: 0.9917; val_best_acc_score: 0.9558; val_best_f1_score: 0.9709; train_kl_reg_loss: 3824.2205; train_edge_recon_loss: 130679.4467; train_gene_expr_recon_loss: 163903.3154; train_masked_gp_l1_reg_loss: 895.9866; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299302.9688; train_optim_loss: 299302.9688; val_kl_reg_loss: 3711.7733; val_edge_recon_loss: 135816.6525; val_gene_expr_recon_loss: 164270.1252; val_masked_gp_l1_reg_loss: 895.1846; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304693.7377; val_optim_loss: 304693.7377
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9796; val_auprc_score: 0.9913; val_best_acc_score: 0.9555; val_best_f1_score: 0.9707; train_kl_reg_loss: 3816.8152; train_edge_recon_loss: 130928.7686; train_gene_expr_recon_loss: 163885.6480; train_masked_gp_l1_reg_loss: 895.1275; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299526.3597; train_optim_loss: 299526.3597; val_kl_reg_loss: 3704.2856; val_edge_recon_loss: 135277.9155; val_gene_expr_recon_loss: 164486.9051; val_masked_gp_l1_reg_loss: 895.1454; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304364.2637; val_optim_loss: 304364.2637
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9791; val_auprc_score: 0.9913; val_best_acc_score: 0.9554; val_best_f1_score: 0.9707; train_kl_reg_loss: 3811.3591; train_edge_recon_loss: 130881.4750; train_gene_expr_recon_loss: 163967.3947; train_masked_gp_l1_reg_loss: 895.1578; train_group_lasso_reg_loss: 0.0000; train_global_loss: 299555.3862; train_optim_loss: 299555.3862; val_kl_reg_loss: 3704.4585; val_edge_recon_loss: 134483.6714; val_gene_expr_recon_loss: 164577.2483; val_masked_gp_l1_reg_loss: 895.2192; val_group_lasso_reg_loss: 0.0000; val_global_loss: 303660.5956; val_optim_loss: 303660.5956
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9828; val_auprc_score: 0.9974; val_best_acc_score: 0.9714; val_best_f1_score: 0.9840; train_kl_reg_loss: 3472.3021; train_edge_recon_loss: 60747.9582; train_gene_expr_recon_loss: 164957.2943; train_masked_gp_l1_reg_loss: 647.3096; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229824.8642; train_optim_loss: 229824.8642; val_kl_reg_loss: 3370.3547; val_edge_recon_loss: 61320.3485; val_gene_expr_recon_loss: 164398.7384; val_masked_gp_l1_reg_loss: 649.1981; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229738.6450; val_optim_loss: 229738.6450

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 74 min 42 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9794
Val AUPRC score: 0.9913
Val best accuracy score: 0.9562
Val best F1 score: 0.9712
Val gene expr MSE score: 1.0002

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9836; val_auprc_score: 0.9975; val_best_acc_score: 0.9712; val_best_f1_score: 0.9838; train_kl_reg_loss: 3480.3559; train_edge_recon_loss: 60740.3470; train_gene_expr_recon_loss: 164845.0107; train_masked_gp_l1_reg_loss: 652.5882; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229718.3016; train_optim_loss: 229718.3016; val_kl_reg_loss: 3463.6627; val_edge_recon_loss: 61652.6449; val_gene_expr_recon_loss: 164666.3614; val_masked_gp_l1_reg_loss: 656.3751; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230439.0444; val_optim_loss: 230439.0444
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9842; val_auprc_score: 0.9976; val_best_acc_score: 0.9714; val_best_f1_score: 0.9840; train_kl_reg_loss: 3514.1221; train_edge_recon_loss: 60622.7408; train_gene_expr_recon_loss: 164531.3875; train_masked_gp_l1_reg_loss: 654.9342; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229323.1847; train_optim_loss: 229323.1847; val_kl_reg_loss: 3510.4647; val_edge_recon_loss: 61167.7928; val_gene_expr_recon_loss: 164063.8304; val_masked_gp_l1_reg_loss: 657.1603; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229399.2440; val_optim_loss: 229399.2440
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9848; val_auprc_score: 0.9977; val_best_acc_score: 0.9720; val_best_f1_score: 0.9843; train_kl_reg_loss: 3520.2447; train_edge_recon_loss: 60704.1788; train_gene_expr_recon_loss: 164436.0285; train_masked_gp_l1_reg_loss: 661.6879; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229322.1399; train_optim_loss: 229322.1399; val_kl_reg_loss: 3413.0294; val_edge_recon_loss: 61283.6786; val_gene_expr_recon_loss: 164238.4108; val_masked_gp_l1_reg_loss: 663.6934; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229598.8055; val_optim_loss: 229598.8055
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9849; val_auprc_score: 0.9978; val_best_acc_score: 0.9726; val_best_f1_score: 0.9846; train_kl_reg_loss: 3548.4503; train_edge_recon_loss: 60776.9081; train_gene_expr_recon_loss: 164211.1203; train_masked_gp_l1_reg_loss: 660.5180; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229196.9968; train_optim_loss: 229196.9968; val_kl_reg_loss: 3544.2506; val_edge_recon_loss: 61319.0945; val_gene_expr_recon_loss: 163857.9494; val_masked_gp_l1_reg_loss: 664.1162; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229385.4042; val_optim_loss: 229385.4042
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9845; val_auprc_score: 0.9977; val_best_acc_score: 0.9716; val_best_f1_score: 0.9841; train_kl_reg_loss: 3548.7028; train_edge_recon_loss: 60767.9889; train_gene_expr_recon_loss: 164159.0544; train_masked_gp_l1_reg_loss: 666.2829; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229142.0289; train_optim_loss: 229142.0289; val_kl_reg_loss: 3513.8463; val_edge_recon_loss: 61605.9503; val_gene_expr_recon_loss: 164006.1813; val_masked_gp_l1_reg_loss: 671.9209; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229797.8997; val_optim_loss: 229797.8997
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9852; val_auprc_score: 0.9978; val_best_acc_score: 0.9731; val_best_f1_score: 0.9849; train_kl_reg_loss: 3568.0237; train_edge_recon_loss: 60690.3989; train_gene_expr_recon_loss: 163948.6557; train_masked_gp_l1_reg_loss: 669.8521; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228876.9306; train_optim_loss: 228876.9306; val_kl_reg_loss: 3589.7323; val_edge_recon_loss: 61227.7302; val_gene_expr_recon_loss: 163627.8432; val_masked_gp_l1_reg_loss: 674.0891; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229119.3997; val_optim_loss: 229119.3997
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9850; val_auprc_score: 0.9978; val_best_acc_score: 0.9724; val_best_f1_score: 0.9846; train_kl_reg_loss: 3574.5217; train_edge_recon_loss: 60651.5272; train_gene_expr_recon_loss: 163921.4040; train_masked_gp_l1_reg_loss: 671.9208; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228819.3736; train_optim_loss: 228819.3736; val_kl_reg_loss: 3518.4006; val_edge_recon_loss: 61204.8057; val_gene_expr_recon_loss: 163907.3390; val_masked_gp_l1_reg_loss: 671.6859; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229302.2325; val_optim_loss: 229302.2325
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9848; val_auprc_score: 0.9977; val_best_acc_score: 0.9731; val_best_f1_score: 0.9850; train_kl_reg_loss: 3589.1520; train_edge_recon_loss: 60632.5053; train_gene_expr_recon_loss: 163749.1844; train_masked_gp_l1_reg_loss: 675.5534; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228646.3951; train_optim_loss: 228646.3951; val_kl_reg_loss: 3440.7029; val_edge_recon_loss: 60920.8060; val_gene_expr_recon_loss: 163510.7362; val_masked_gp_l1_reg_loss: 671.9410; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228544.1824; val_optim_loss: 228544.1824
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9852; val_auprc_score: 0.9978; val_best_acc_score: 0.9718; val_best_f1_score: 0.9842; train_kl_reg_loss: 3589.9445; train_edge_recon_loss: 60699.3878; train_gene_expr_recon_loss: 163709.4398; train_masked_gp_l1_reg_loss: 675.3755; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228674.1475; train_optim_loss: 228674.1475; val_kl_reg_loss: 3448.5481; val_edge_recon_loss: 61485.8298; val_gene_expr_recon_loss: 163622.9203; val_masked_gp_l1_reg_loss: 678.4471; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229235.7516; val_optim_loss: 229235.7516
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9852; val_auprc_score: 0.9977; val_best_acc_score: 0.9733; val_best_f1_score: 0.9850; train_kl_reg_loss: 3605.3364; train_edge_recon_loss: 60737.2971; train_gene_expr_recon_loss: 163600.7752; train_masked_gp_l1_reg_loss: 679.6171; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228623.0258; train_optim_loss: 228623.0258; val_kl_reg_loss: 3592.5245; val_edge_recon_loss: 61499.7779; val_gene_expr_recon_loss: 163381.5105; val_masked_gp_l1_reg_loss: 681.2146; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229155.0317; val_optim_loss: 229155.0317
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9860; val_auprc_score: 0.9979; val_best_acc_score: 0.9737; val_best_f1_score: 0.9853; train_kl_reg_loss: 3608.0133; train_edge_recon_loss: 60703.0783; train_gene_expr_recon_loss: 163502.8694; train_masked_gp_l1_reg_loss: 682.2560; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228496.2170; train_optim_loss: 228496.2170; val_kl_reg_loss: 3560.0704; val_edge_recon_loss: 61440.9922; val_gene_expr_recon_loss: 163554.3332; val_masked_gp_l1_reg_loss: 684.0445; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229239.4424; val_optim_loss: 229239.4424
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9858; val_auprc_score: 0.9979; val_best_acc_score: 0.9740; val_best_f1_score: 0.9855; train_kl_reg_loss: 3615.1502; train_edge_recon_loss: 60589.8039; train_gene_expr_recon_loss: 163520.4494; train_masked_gp_l1_reg_loss: 681.5698; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228406.9731; train_optim_loss: 228406.9731; val_kl_reg_loss: 3535.6885; val_edge_recon_loss: 60698.1910; val_gene_expr_recon_loss: 163234.1358; val_masked_gp_l1_reg_loss: 682.0560; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228150.0775; val_optim_loss: 228150.0775
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9862; val_auprc_score: 0.9980; val_best_acc_score: 0.9738; val_best_f1_score: 0.9853; train_kl_reg_loss: 3622.1235; train_edge_recon_loss: 60802.3450; train_gene_expr_recon_loss: 163418.4502; train_masked_gp_l1_reg_loss: 685.8684; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228528.7869; train_optim_loss: 228528.7869; val_kl_reg_loss: 3724.0643; val_edge_recon_loss: 61076.6505; val_gene_expr_recon_loss: 163531.4172; val_masked_gp_l1_reg_loss: 690.1563; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229022.2882; val_optim_loss: 229022.2882
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9861; val_auprc_score: 0.9979; val_best_acc_score: 0.9741; val_best_f1_score: 0.9855; train_kl_reg_loss: 3627.5557; train_edge_recon_loss: 60714.8902; train_gene_expr_recon_loss: 163372.7220; train_masked_gp_l1_reg_loss: 683.5128; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228398.6809; train_optim_loss: 228398.6809; val_kl_reg_loss: 3565.9754; val_edge_recon_loss: 60788.3828; val_gene_expr_recon_loss: 163314.5230; val_masked_gp_l1_reg_loss: 684.9355; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228353.8188; val_optim_loss: 228353.8188
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9855; val_auprc_score: 0.9978; val_best_acc_score: 0.9734; val_best_f1_score: 0.9851; train_kl_reg_loss: 3637.0212; train_edge_recon_loss: 60880.2063; train_gene_expr_recon_loss: 163320.1770; train_masked_gp_l1_reg_loss: 689.3430; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228526.7476; train_optim_loss: 228526.7476; val_kl_reg_loss: 3500.3329; val_edge_recon_loss: 61571.2617; val_gene_expr_recon_loss: 163364.4892; val_masked_gp_l1_reg_loss: 690.4363; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229126.5217; val_optim_loss: 229126.5217
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9859; val_auprc_score: 0.9979; val_best_acc_score: 0.9746; val_best_f1_score: 0.9857; train_kl_reg_loss: 3636.5696; train_edge_recon_loss: 60651.9002; train_gene_expr_recon_loss: 163289.2290; train_masked_gp_l1_reg_loss: 686.9027; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228264.6015; train_optim_loss: 228264.6015; val_kl_reg_loss: 3588.3475; val_edge_recon_loss: 61309.7989; val_gene_expr_recon_loss: 163158.6591; val_masked_gp_l1_reg_loss: 689.6642; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228746.4768; val_optim_loss: 228746.4768
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9865; val_auprc_score: 0.9980; val_best_acc_score: 0.9742; val_best_f1_score: 0.9855; train_kl_reg_loss: 3640.0307; train_edge_recon_loss: 60652.1827; train_gene_expr_recon_loss: 163194.8041; train_masked_gp_l1_reg_loss: 690.7258; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228177.7433; train_optim_loss: 228177.7433; val_kl_reg_loss: 3566.8638; val_edge_recon_loss: 61756.0024; val_gene_expr_recon_loss: 163282.7267; val_masked_gp_l1_reg_loss: 692.1569; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229297.7493; val_optim_loss: 229297.7493
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9865; val_auprc_score: 0.9980; val_best_acc_score: 0.9752; val_best_f1_score: 0.9861; train_kl_reg_loss: 3643.1539; train_edge_recon_loss: 60727.3622; train_gene_expr_recon_loss: 163208.3186; train_masked_gp_l1_reg_loss: 690.8101; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228269.6448; train_optim_loss: 228269.6448; val_kl_reg_loss: 3599.7185; val_edge_recon_loss: 61028.0570; val_gene_expr_recon_loss: 163265.0012; val_masked_gp_l1_reg_loss: 694.5215; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228587.2922; val_optim_loss: 228587.2922
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9854; val_auprc_score: 0.9978; val_best_acc_score: 0.9739; val_best_f1_score: 0.9853; train_kl_reg_loss: 3652.3722; train_edge_recon_loss: 60645.8432; train_gene_expr_recon_loss: 163087.3824; train_masked_gp_l1_reg_loss: 692.6903; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228078.2884; train_optim_loss: 228078.2884; val_kl_reg_loss: 3575.1632; val_edge_recon_loss: 61146.8431; val_gene_expr_recon_loss: 163229.1965; val_masked_gp_l1_reg_loss: 694.6681; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228645.8743; val_optim_loss: 228645.8743

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9874; val_auprc_score: 0.9981; val_best_acc_score: 0.9757; val_best_f1_score: 0.9864; train_kl_reg_loss: 3591.5016; train_edge_recon_loss: 60502.9463; train_gene_expr_recon_loss: 162667.5999; train_masked_gp_l1_reg_loss: 618.2953; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227380.3428; train_optim_loss: 227380.3428; val_kl_reg_loss: 3538.3348; val_edge_recon_loss: 60865.9850; val_gene_expr_recon_loss: 162742.8354; val_masked_gp_l1_reg_loss: 613.8902; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227761.0455; val_optim_loss: 227761.0455
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9863; val_auprc_score: 0.9980; val_best_acc_score: 0.9747; val_best_f1_score: 0.9858; train_kl_reg_loss: 3658.0899; train_edge_recon_loss: 60744.8576; train_gene_expr_recon_loss: 163035.7624; train_masked_gp_l1_reg_loss: 694.9907; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228133.7006; train_optim_loss: 228133.7006; val_kl_reg_loss: 3680.4837; val_edge_recon_loss: 61096.2701; val_gene_expr_recon_loss: 163189.8080; val_masked_gp_l1_reg_loss: 695.6977; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228662.2651; val_optim_loss: 228662.2651
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9875; val_auprc_score: 0.9981; val_best_acc_score: 0.9755; val_best_f1_score: 0.9863; train_kl_reg_loss: 3592.0466; train_edge_recon_loss: 60554.5910; train_gene_expr_recon_loss: 162589.5299; train_masked_gp_l1_reg_loss: 613.6504; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227349.8178; train_optim_loss: 227349.8178; val_kl_reg_loss: 3567.2458; val_edge_recon_loss: 61179.8737; val_gene_expr_recon_loss: 162616.6358; val_masked_gp_l1_reg_loss: 612.9327; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227976.6925; val_optim_loss: 227976.6925
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9861; val_auprc_score: 0.9979; val_best_acc_score: 0.9739; val_best_f1_score: 0.9854; train_kl_reg_loss: 3664.6239; train_edge_recon_loss: 60647.7210; train_gene_expr_recon_loss: 163001.0092; train_masked_gp_l1_reg_loss: 696.9296; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228010.2835; train_optim_loss: 228010.2835; val_kl_reg_loss: 3701.8241; val_edge_recon_loss: 61611.2978; val_gene_expr_recon_loss: 163189.3622; val_masked_gp_l1_reg_loss: 697.3571; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229199.8434; val_optim_loss: 229199.8434
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9878; val_auprc_score: 0.9981; val_best_acc_score: 0.9757; val_best_f1_score: 0.9863; train_kl_reg_loss: 3585.7650; train_edge_recon_loss: 60341.5551; train_gene_expr_recon_loss: 162549.4958; train_masked_gp_l1_reg_loss: 614.8735; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227091.6894; train_optim_loss: 227091.6894; val_kl_reg_loss: 3524.0708; val_edge_recon_loss: 60792.5240; val_gene_expr_recon_loss: 162522.1271; val_masked_gp_l1_reg_loss: 617.4601; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227456.1755; val_optim_loss: 227456.1755
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9868; val_auprc_score: 0.9980; val_best_acc_score: 0.9743; val_best_f1_score: 0.9856; train_kl_reg_loss: 3670.4606; train_edge_recon_loss: 60678.5966; train_gene_expr_recon_loss: 162942.2176; train_masked_gp_l1_reg_loss: 697.6396; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227988.9143; train_optim_loss: 227988.9143; val_kl_reg_loss: 3649.2700; val_edge_recon_loss: 60905.8414; val_gene_expr_recon_loss: 163239.5757; val_masked_gp_l1_reg_loss: 697.9412; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228492.6251; val_optim_loss: 228492.6251
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9875; val_auprc_score: 0.9981; val_best_acc_score: 0.9756; val_best_f1_score: 0.9863; train_kl_reg_loss: 3585.2060; train_edge_recon_loss: 60511.7106; train_gene_expr_recon_loss: 162469.7949; train_masked_gp_l1_reg_loss: 617.4451; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227184.1563; train_optim_loss: 227184.1563; val_kl_reg_loss: 3536.6449; val_edge_recon_loss: 61099.1896; val_gene_expr_recon_loss: 162553.9115; val_masked_gp_l1_reg_loss: 617.7969; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227807.5431; val_optim_loss: 227807.5431
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9865; val_auprc_score: 0.9980; val_best_acc_score: 0.9745; val_best_f1_score: 0.9857; train_kl_reg_loss: 3677.8911; train_edge_recon_loss: 60648.7370; train_gene_expr_recon_loss: 162867.9451; train_masked_gp_l1_reg_loss: 699.8959; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227894.4691; train_optim_loss: 227894.4691; val_kl_reg_loss: 3716.2566; val_edge_recon_loss: 61499.7662; val_gene_expr_recon_loss: 163085.4170; val_masked_gp_l1_reg_loss: 703.5845; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229005.0180; val_optim_loss: 229005.0180
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9879; val_auprc_score: 0.9982; val_best_acc_score: 0.9757; val_best_f1_score: 0.9863; train_kl_reg_loss: 3584.2756; train_edge_recon_loss: 60648.3661; train_gene_expr_recon_loss: 162531.2024; train_masked_gp_l1_reg_loss: 619.3636; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227383.2077; train_optim_loss: 227383.2077; val_kl_reg_loss: 3559.6599; val_edge_recon_loss: 61383.2508; val_gene_expr_recon_loss: 162547.5371; val_masked_gp_l1_reg_loss: 620.3646; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228110.8072; val_optim_loss: 228110.8072
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9859; val_auprc_score: 0.9979; val_best_acc_score: 0.9745; val_best_f1_score: 0.9857; train_kl_reg_loss: 3685.9442; train_edge_recon_loss: 60627.2502; train_gene_expr_recon_loss: 162830.1975; train_masked_gp_l1_reg_loss: 700.7348; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227844.1268; train_optim_loss: 227844.1268; val_kl_reg_loss: 3699.6828; val_edge_recon_loss: 60944.4266; val_gene_expr_recon_loss: 163007.2527; val_masked_gp_l1_reg_loss: 699.5157; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228350.8778; val_optim_loss: 228350.8778
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9879; val_auprc_score: 0.9982; val_best_acc_score: 0.9762; val_best_f1_score: 0.9866; train_kl_reg_loss: 3583.1686; train_edge_recon_loss: 60299.7320; train_gene_expr_recon_loss: 162466.9983; train_masked_gp_l1_reg_loss: 621.2901; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226971.1889; train_optim_loss: 226971.1889; val_kl_reg_loss: 3511.4643; val_edge_recon_loss: 61216.4658; val_gene_expr_recon_loss: 162630.7950; val_masked_gp_l1_reg_loss: 622.6114; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227981.3346; val_optim_loss: 227981.3346
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9871; val_auprc_score: 0.9981; val_best_acc_score: 0.9750; val_best_f1_score: 0.9860; train_kl_reg_loss: 3687.0193; train_edge_recon_loss: 60629.1787; train_gene_expr_recon_loss: 162772.0508; train_masked_gp_l1_reg_loss: 699.9609; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227788.2099; train_optim_loss: 227788.2099; val_kl_reg_loss: 3671.8347; val_edge_recon_loss: 60874.3598; val_gene_expr_recon_loss: 163075.9350; val_masked_gp_l1_reg_loss: 697.8492; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228319.9733; val_optim_loss: 228319.9733

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9876; val_auprc_score: 0.9981; val_best_acc_score: 0.9760; val_best_f1_score: 0.9866; train_kl_reg_loss: 3575.1354; train_edge_recon_loss: 60434.4580; train_gene_expr_recon_loss: 162399.1696; train_masked_gp_l1_reg_loss: 613.2694; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227022.0327; train_optim_loss: 227022.0327; val_kl_reg_loss: 3522.0229; val_edge_recon_loss: 61107.7832; val_gene_expr_recon_loss: 162569.5373; val_masked_gp_l1_reg_loss: 612.7831; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227812.1246; val_optim_loss: 227812.1246
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9872; val_auprc_score: 0.9981; val_best_acc_score: 0.9760; val_best_f1_score: 0.9866; train_kl_reg_loss: 3688.7163; train_edge_recon_loss: 60499.4780; train_gene_expr_recon_loss: 162776.9954; train_masked_gp_l1_reg_loss: 700.9842; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227666.1739; train_optim_loss: 227666.1739; val_kl_reg_loss: 3590.8441; val_edge_recon_loss: 60856.3327; val_gene_expr_recon_loss: 163018.2629; val_masked_gp_l1_reg_loss: 699.2205; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228164.6581; val_optim_loss: 228164.6581
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9878; val_auprc_score: 0.9982; val_best_acc_score: 0.9761; val_best_f1_score: 0.9866; train_kl_reg_loss: 3570.2608; train_edge_recon_loss: 60359.2905; train_gene_expr_recon_loss: 162384.8886; train_masked_gp_l1_reg_loss: 612.8890; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226927.3287; train_optim_loss: 226927.3287; val_kl_reg_loss: 3537.6112; val_edge_recon_loss: 60855.5643; val_gene_expr_recon_loss: 162470.5646; val_masked_gp_l1_reg_loss: 612.9437; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227476.6775; val_optim_loss: 227476.6775
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9872; val_auprc_score: 0.9981; val_best_acc_score: 0.9755; val_best_f1_score: 0.9863; train_kl_reg_loss: 3694.7048; train_edge_recon_loss: 60542.7141; train_gene_expr_recon_loss: 162760.3260; train_masked_gp_l1_reg_loss: 701.4510; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227699.1959; train_optim_loss: 227699.1959; val_kl_reg_loss: 3664.5452; val_edge_recon_loss: 60638.8625; val_gene_expr_recon_loss: 162966.8063; val_masked_gp_l1_reg_loss: 703.1378; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227973.3547; val_optim_loss: 227973.3547
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9880; val_auprc_score: 0.9982; val_best_acc_score: 0.9762; val_best_f1_score: 0.9866; train_kl_reg_loss: 3572.0584; train_edge_recon_loss: 60501.7107; train_gene_expr_recon_loss: 162350.3327; train_masked_gp_l1_reg_loss: 613.0205; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227037.1223; train_optim_loss: 227037.1223; val_kl_reg_loss: 3515.3919; val_edge_recon_loss: 60791.5457; val_gene_expr_recon_loss: 162412.8839; val_masked_gp_l1_reg_loss: 613.1207; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227332.9469; val_optim_loss: 227332.9469
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9871; val_auprc_score: 0.9981; val_best_acc_score: 0.9760; val_best_f1_score: 0.9866; train_kl_reg_loss: 3697.9783; train_edge_recon_loss: 60499.5730; train_gene_expr_recon_loss: 162718.6621; train_masked_gp_l1_reg_loss: 702.6133; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227618.8268; train_optim_loss: 227618.8268; val_kl_reg_loss: 3576.4494; val_edge_recon_loss: 61366.9022; val_gene_expr_recon_loss: 163081.3268; val_masked_gp_l1_reg_loss: 704.9387; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228729.6160; val_optim_loss: 228729.6160
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9878; val_auprc_score: 0.9981; val_best_acc_score: 0.9761; val_best_f1_score: 0.9866; train_kl_reg_loss: 3571.9197; train_edge_recon_loss: 60343.0976; train_gene_expr_recon_loss: 162335.9321; train_masked_gp_l1_reg_loss: 613.3142; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226864.2637; train_optim_loss: 226864.2637; val_kl_reg_loss: 3514.9452; val_edge_recon_loss: 61106.5807; val_gene_expr_recon_loss: 162462.5307; val_masked_gp_l1_reg_loss: 613.3223; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227697.3850; val_optim_loss: 227697.3850
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9872; val_auprc_score: 0.9981; val_best_acc_score: 0.9761; val_best_f1_score: 0.9866; train_kl_reg_loss: 3698.0832; train_edge_recon_loss: 60533.0539; train_gene_expr_recon_loss: 162653.1908; train_masked_gp_l1_reg_loss: 704.3064; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227588.6343; train_optim_loss: 227588.6343; val_kl_reg_loss: 3703.9721; val_edge_recon_loss: 60964.1221; val_gene_expr_recon_loss: 162923.1681; val_masked_gp_l1_reg_loss: 706.2643; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228297.5280; val_optim_loss: 228297.5280
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9882; val_auprc_score: 0.9982; val_best_acc_score: 0.9765; val_best_f1_score: 0.9868; train_kl_reg_loss: 3570.4777; train_edge_recon_loss: 60404.9591; train_gene_expr_recon_loss: 162332.8641; train_masked_gp_l1_reg_loss: 613.4902; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226921.7913; train_optim_loss: 226921.7913; val_kl_reg_loss: 3523.4256; val_edge_recon_loss: 61193.8513; val_gene_expr_recon_loss: 162478.0587; val_masked_gp_l1_reg_loss: 613.6681; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227809.0076; val_optim_loss: 227809.0076
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9868; val_auprc_score: 0.9980; val_best_acc_score: 0.9754; val_best_f1_score: 0.9862; train_kl_reg_loss: 3700.3497; train_edge_recon_loss: 60641.5523; train_gene_expr_recon_loss: 162636.9334; train_masked_gp_l1_reg_loss: 703.5367; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227682.3719; train_optim_loss: 227682.3719; val_kl_reg_loss: 3678.0695; val_edge_recon_loss: 61119.3621; val_gene_expr_recon_loss: 163124.0218; val_masked_gp_l1_reg_loss: 704.1851; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228625.6408; val_optim_loss: 228625.6408
