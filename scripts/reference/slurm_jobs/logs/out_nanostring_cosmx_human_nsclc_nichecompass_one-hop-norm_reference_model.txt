First script finished. Launching follow up script.
Run timestamp: 02062023_065414.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'sample', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '1024', '--node_batch_size', 'None']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1064, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1064, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1064, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 254337
Number of validation nodes: 28260
Number of training edges: 1722321
Number of validation edges: 191368
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9856; val_auprc_score: 0.9940; val_best_acc_score: 0.9606; val_best_f1_score: 0.9740; train_kl_reg_loss: 3890.2606; train_edge_recon_loss: 133033.3964; train_gene_expr_recon_loss: 189184.1197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326107.7767; train_optim_loss: 326107.7767; val_kl_reg_loss: 3903.8310; val_edge_recon_loss: 131228.4132; val_gene_expr_recon_loss: 182377.3126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317509.5567; val_optim_loss: 317509.5567
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9900; val_auprc_score: 0.9960; val_best_acc_score: 0.9683; val_best_f1_score: 0.9791; train_kl_reg_loss: 3917.3605; train_edge_recon_loss: 130959.2340; train_gene_expr_recon_loss: 179888.1677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 314764.7625; train_optim_loss: 314764.7625; val_kl_reg_loss: 3898.7692; val_edge_recon_loss: 130244.5701; val_gene_expr_recon_loss: 178358.6291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 312501.9681; val_optim_loss: 312501.9681
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9895; val_auprc_score: 0.9956; val_best_acc_score: 0.9711; val_best_f1_score: 0.9808; train_kl_reg_loss: 3967.9800; train_edge_recon_loss: 130655.9012; train_gene_expr_recon_loss: 177225.4996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 311849.3811; train_optim_loss: 311849.3811; val_kl_reg_loss: 3961.4859; val_edge_recon_loss: 130750.0005; val_gene_expr_recon_loss: 176721.9632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 311433.4507; val_optim_loss: 311433.4507
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9925; val_auprc_score: 0.9971; val_best_acc_score: 0.9738; val_best_f1_score: 0.9827; train_kl_reg_loss: 4009.5417; train_edge_recon_loss: 130296.1543; train_gene_expr_recon_loss: 175987.6700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 310293.3657; train_optim_loss: 310293.3657; val_kl_reg_loss: 3970.5628; val_edge_recon_loss: 129698.8703; val_gene_expr_recon_loss: 175802.7331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 309472.1643; val_optim_loss: 309472.1643
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9921; val_auprc_score: 0.9969; val_best_acc_score: 0.9749; val_best_f1_score: 0.9834; train_kl_reg_loss: 4044.9400; train_edge_recon_loss: 129991.1172; train_gene_expr_recon_loss: 175250.3350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 309286.3920; train_optim_loss: 309286.3920; val_kl_reg_loss: 3982.8474; val_edge_recon_loss: 130287.3755; val_gene_expr_recon_loss: 175192.7133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 309462.9363; val_optim_loss: 309462.9363
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9928; val_auprc_score: 0.9970; val_best_acc_score: 0.9758; val_best_f1_score: 0.9840; train_kl_reg_loss: 4080.2617; train_edge_recon_loss: 130019.3134; train_gene_expr_recon_loss: 174751.6216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308851.1968; train_optim_loss: 308851.1968; val_kl_reg_loss: 4011.7657; val_edge_recon_loss: 130061.3920; val_gene_expr_recon_loss: 174984.1190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 309057.2766; val_optim_loss: 309057.2766
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9938; val_auprc_score: 0.9975; val_best_acc_score: 0.9768; val_best_f1_score: 0.9846; train_kl_reg_loss: 4113.6505; train_edge_recon_loss: 130278.2406; train_gene_expr_recon_loss: 174378.1006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308769.9913; train_optim_loss: 308769.9913; val_kl_reg_loss: 4077.8480; val_edge_recon_loss: 130310.8285; val_gene_expr_recon_loss: 174541.7776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 308930.4554; val_optim_loss: 308930.4554
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9931; val_auprc_score: 0.9972; val_best_acc_score: 0.9771; val_best_f1_score: 0.9849; train_kl_reg_loss: 4136.2483; train_edge_recon_loss: 130007.0142; train_gene_expr_recon_loss: 174158.0495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308301.3118; train_optim_loss: 308301.3118; val_kl_reg_loss: 4082.9000; val_edge_recon_loss: 129306.9318; val_gene_expr_recon_loss: 174731.1499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 308120.9820; val_optim_loss: 308120.9820
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9941; val_auprc_score: 0.9976; val_best_acc_score: 0.9788; val_best_f1_score: 0.9859; train_kl_reg_loss: 4162.3175; train_edge_recon_loss: 130088.9331; train_gene_expr_recon_loss: 173978.2989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308229.5498; train_optim_loss: 308229.5498; val_kl_reg_loss: 4118.1821; val_edge_recon_loss: 130334.5508; val_gene_expr_recon_loss: 174658.2609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 309110.9923; val_optim_loss: 309110.9923
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9947; val_auprc_score: 0.9978; val_best_acc_score: 0.9798; val_best_f1_score: 0.9866; train_kl_reg_loss: 4182.0972; train_edge_recon_loss: 129991.3320; train_gene_expr_recon_loss: 173787.3441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 307960.7737; train_optim_loss: 307960.7737; val_kl_reg_loss: 4182.2708; val_edge_recon_loss: 129242.0876; val_gene_expr_recon_loss: 174402.0213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307826.3802; val_optim_loss: 307826.3802
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9945; val_auprc_score: 0.9979; val_best_acc_score: 0.9806; val_best_f1_score: 0.9872; train_kl_reg_loss: 4199.9662; train_edge_recon_loss: 129804.9986; train_gene_expr_recon_loss: 173602.2584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 307607.2226; train_optim_loss: 307607.2226; val_kl_reg_loss: 4208.0047; val_edge_recon_loss: 129943.3231; val_gene_expr_recon_loss: 174361.0460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 308512.3727; val_optim_loss: 308512.3727
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9952; val_auprc_score: 0.9980; val_best_acc_score: 0.9809; val_best_f1_score: 0.9874; train_kl_reg_loss: 4218.4247; train_edge_recon_loss: 129796.5941; train_gene_expr_recon_loss: 173520.5744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 307535.5933; train_optim_loss: 307535.5933; val_kl_reg_loss: 4203.8766; val_edge_recon_loss: 129695.6730; val_gene_expr_recon_loss: 174512.2658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 308411.8173; val_optim_loss: 308411.8173
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9951; val_auprc_score: 0.9981; val_best_acc_score: 0.9812; val_best_f1_score: 0.9876; train_kl_reg_loss: 4238.0910; train_edge_recon_loss: 129776.6522; train_gene_expr_recon_loss: 173461.9286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 307476.6717; train_optim_loss: 307476.6717; val_kl_reg_loss: 4281.0634; val_edge_recon_loss: 129618.4348; val_gene_expr_recon_loss: 174413.3551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 308312.8529; val_optim_loss: 308312.8529

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9955; val_auprc_score: 0.9982; val_best_acc_score: 0.9821; val_best_f1_score: 0.9881; train_kl_reg_loss: 4227.5601; train_edge_recon_loss: 129515.8277; train_gene_expr_recon_loss: 172824.6715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306568.0593; train_optim_loss: 306568.0593; val_kl_reg_loss: 4196.9379; val_edge_recon_loss: 129667.8280; val_gene_expr_recon_loss: 173914.1982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307778.9641; val_optim_loss: 307778.9641
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9957; val_auprc_score: 0.9983; val_best_acc_score: 0.9821; val_best_f1_score: 0.9882; train_kl_reg_loss: 4223.2297; train_edge_recon_loss: 129562.9382; train_gene_expr_recon_loss: 172669.2607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306455.4288; train_optim_loss: 306455.4288; val_kl_reg_loss: 4184.2104; val_edge_recon_loss: 129719.4305; val_gene_expr_recon_loss: 173884.3469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307787.9886; val_optim_loss: 307787.9886
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9959; val_auprc_score: 0.9984; val_best_acc_score: 0.9827; val_best_f1_score: 0.9886; train_kl_reg_loss: 4220.7027; train_edge_recon_loss: 129453.0829; train_gene_expr_recon_loss: 172643.2139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306316.9997; train_optim_loss: 306316.9997; val_kl_reg_loss: 4198.5463; val_edge_recon_loss: 129773.2858; val_gene_expr_recon_loss: 173799.7998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307771.6322; val_optim_loss: 307771.6322
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9958; val_auprc_score: 0.9983; val_best_acc_score: 0.9825; val_best_f1_score: 0.9884; train_kl_reg_loss: 4221.7674; train_edge_recon_loss: 129612.3060; train_gene_expr_recon_loss: 172565.6361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306399.7098; train_optim_loss: 306399.7098; val_kl_reg_loss: 4176.1607; val_edge_recon_loss: 129690.6738; val_gene_expr_recon_loss: 174245.8149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 308112.6491; val_optim_loss: 308112.6491
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9960; val_auprc_score: 0.9984; val_best_acc_score: 0.9830; val_best_f1_score: 0.9887; train_kl_reg_loss: 4221.2041; train_edge_recon_loss: 129412.6369; train_gene_expr_recon_loss: 172572.5955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306206.4364; train_optim_loss: 306206.4364; val_kl_reg_loss: 4153.5375; val_edge_recon_loss: 129834.6157; val_gene_expr_recon_loss: 173926.6568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307914.8100; val_optim_loss: 307914.8100
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9959; val_auprc_score: 0.9984; val_best_acc_score: 0.9831; val_best_f1_score: 0.9888; train_kl_reg_loss: 4223.0755; train_edge_recon_loss: 129560.9216; train_gene_expr_recon_loss: 172466.7391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306250.7369; train_optim_loss: 306250.7369; val_kl_reg_loss: 4160.7340; val_edge_recon_loss: 129583.8450; val_gene_expr_recon_loss: 173790.7749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307535.3538; val_optim_loss: 307535.3538
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9960; val_auprc_score: 0.9983; val_best_acc_score: 0.9834; val_best_f1_score: 0.9890; train_kl_reg_loss: 4225.5364; train_edge_recon_loss: 129367.4784; train_gene_expr_recon_loss: 172462.2152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306055.2299; train_optim_loss: 306055.2299; val_kl_reg_loss: 4169.4503; val_edge_recon_loss: 129594.6743; val_gene_expr_recon_loss: 173923.4728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307687.5988; val_optim_loss: 307687.5988
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9960; val_auprc_score: 0.9984; val_best_acc_score: 0.9828; val_best_f1_score: 0.9886; train_kl_reg_loss: 4226.6445; train_edge_recon_loss: 129472.5429; train_gene_expr_recon_loss: 172508.3623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306207.5499; train_optim_loss: 306207.5499; val_kl_reg_loss: 4207.3470; val_edge_recon_loss: 128935.0788; val_gene_expr_recon_loss: 173741.4743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 306883.9001; val_optim_loss: 306883.9001
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9961; val_auprc_score: 0.9984; val_best_acc_score: 0.9833; val_best_f1_score: 0.9889; train_kl_reg_loss: 4230.3499; train_edge_recon_loss: 129461.4593; train_gene_expr_recon_loss: 172405.2834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306097.0926; train_optim_loss: 306097.0926; val_kl_reg_loss: 4204.8197; val_edge_recon_loss: 129927.5185; val_gene_expr_recon_loss: 173771.7972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307904.1344; val_optim_loss: 307904.1344
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9959; val_auprc_score: 0.9984; val_best_acc_score: 0.9834; val_best_f1_score: 0.9890; train_kl_reg_loss: 4232.9653; train_edge_recon_loss: 129610.6508; train_gene_expr_recon_loss: 172389.4004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306233.0160; train_optim_loss: 306233.0160; val_kl_reg_loss: 4180.8971; val_edge_recon_loss: 128913.8081; val_gene_expr_recon_loss: 173978.8952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307073.6003; val_optim_loss: 307073.6003
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9961; val_auprc_score: 0.9984; val_best_acc_score: 0.9837; val_best_f1_score: 0.9892; train_kl_reg_loss: 4231.1318; train_edge_recon_loss: 129677.9121; train_gene_expr_recon_loss: 172439.7115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306348.7555; train_optim_loss: 306348.7555; val_kl_reg_loss: 4165.9246; val_edge_recon_loss: 129230.8037; val_gene_expr_recon_loss: 173955.1817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307351.9088; val_optim_loss: 307351.9088

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9961; val_auprc_score: 0.9983; val_best_acc_score: 0.9835; val_best_f1_score: 0.9891; train_kl_reg_loss: 4231.4560; train_edge_recon_loss: 129542.7426; train_gene_expr_recon_loss: 172280.1319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 306054.3304; train_optim_loss: 306054.3304; val_kl_reg_loss: 4210.2659; val_edge_recon_loss: 129759.1815; val_gene_expr_recon_loss: 173955.6075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307925.0545; val_optim_loss: 307925.0545
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9960; val_auprc_score: 0.9984; val_best_acc_score: 0.9833; val_best_f1_score: 0.9889; train_kl_reg_loss: 4174.0375; train_edge_recon_loss: 129504.7785; train_gene_expr_recon_loss: 172265.7603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 305944.5763; train_optim_loss: 305944.5763; val_kl_reg_loss: 4020.4350; val_edge_recon_loss: 129688.5280; val_gene_expr_recon_loss: 173775.5089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307484.4733; val_optim_loss: 307484.4733
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9961; val_auprc_score: 0.9985; val_best_acc_score: 0.9835; val_best_f1_score: 0.9891; train_kl_reg_loss: 4157.6724; train_edge_recon_loss: 129509.5974; train_gene_expr_recon_loss: 172210.4257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 305877.6958; train_optim_loss: 305877.6958; val_kl_reg_loss: 4012.7890; val_edge_recon_loss: 129755.2167; val_gene_expr_recon_loss: 174035.6138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 307803.6212; val_optim_loss: 307803.6212

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 368 min 9 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9960
Val AUPRC score: 0.9984
Val best accuracy score: 0.9835
Val best F1 score: 0.9891
Val gene expr MSE score: 1.0562

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
