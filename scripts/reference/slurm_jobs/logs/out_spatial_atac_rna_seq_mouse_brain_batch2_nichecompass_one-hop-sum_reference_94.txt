[True]
Run timestamp: 10082023_231411_94.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_94']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7671; val_auprc_score: 0.7890; val_best_acc_score: 0.5598; val_best_f1_score: 0.6894; train_kl_reg_loss: 209403.1754; train_edge_recon_loss: 3967251.5954; train_gene_expr_recon_loss: 49762983.2061; train_masked_gp_l1_reg_loss: 83207.9636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 246774.2486; train_chrom_access_recon_loss: 131234264.6107; train_global_loss: 185503883.9695; train_optim_loss: 185503883.9695; val_kl_reg_loss: 322228.7906; val_edge_recon_loss: 4061461.1833; val_gene_expr_recon_loss: 40262587.4667; val_masked_gp_l1_reg_loss: 79791.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 244872.9062; val_chrom_access_recon_loss: 117403656.5333; val_global_loss: 162374598.4000; val_optim_loss: 162374598.4000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7984; val_auprc_score: 0.8130; val_best_acc_score: 0.7053; val_best_f1_score: 0.7353; train_kl_reg_loss: 246842.8084; train_edge_recon_loss: 3831479.8302; train_gene_expr_recon_loss: 38979430.3817; train_masked_gp_l1_reg_loss: 77753.9960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241798.5124; train_chrom_access_recon_loss: 115873466.8092; train_global_loss: 159250772.3969; train_optim_loss: 159250772.3969; val_kl_reg_loss: 172869.6760; val_edge_recon_loss: 4045711.0333; val_gene_expr_recon_loss: 38386954.9333; val_masked_gp_l1_reg_loss: 76443.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 237931.4688; val_chrom_access_recon_loss: 116432218.1333; val_global_loss: 159352129.0667; val_optim_loss: 159352129.0667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8601; val_auprc_score: 0.8620; val_best_acc_score: 0.7587; val_best_f1_score: 0.7845; train_kl_reg_loss: 253409.7529; train_edge_recon_loss: 3621814.6641; train_gene_expr_recon_loss: 37246027.6336; train_masked_gp_l1_reg_loss: 76469.1756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233421.5976; train_chrom_access_recon_loss: 114735522.4427; train_global_loss: 156166664.6718; train_optim_loss: 156166664.6718; val_kl_reg_loss: 241032.1260; val_edge_recon_loss: 3919057.2500; val_gene_expr_recon_loss: 37342545.3333; val_masked_gp_l1_reg_loss: 76290.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 228624.4062; val_chrom_access_recon_loss: 114546568.0000; val_global_loss: 156354118.4000; val_optim_loss: 156354118.4000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8864; val_auprc_score: 0.8783; val_best_acc_score: 0.8018; val_best_f1_score: 0.8159; train_kl_reg_loss: 217405.3981; train_edge_recon_loss: 3457931.3760; train_gene_expr_recon_loss: 36801552.0916; train_masked_gp_l1_reg_loss: 77236.5275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 223791.6184; train_chrom_access_recon_loss: 114041637.8015; train_global_loss: 154819554.3206; train_optim_loss: 154819554.3206; val_kl_reg_loss: 219900.9427; val_edge_recon_loss: 3281918.5333; val_gene_expr_recon_loss: 37118224.2667; val_masked_gp_l1_reg_loss: 78270.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 218843.1094; val_chrom_access_recon_loss: 114233665.6000; val_global_loss: 155150824.5333; val_optim_loss: 155150824.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8909; val_auprc_score: 0.8813; val_best_acc_score: 0.8050; val_best_f1_score: 0.8199; train_kl_reg_loss: 248163.0100; train_edge_recon_loss: 3169109.9160; train_gene_expr_recon_loss: 36542867.4198; train_masked_gp_l1_reg_loss: 78713.6503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 213940.1102; train_chrom_access_recon_loss: 113267851.6641; train_global_loss: 153520646.3511; train_optim_loss: 153520646.3511; val_kl_reg_loss: 250094.9104; val_edge_recon_loss: 3108956.1167; val_gene_expr_recon_loss: 36773648.8000; val_masked_gp_l1_reg_loss: 78708.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 208998.2500; val_chrom_access_recon_loss: 113439167.4667; val_global_loss: 153859575.4667; val_optim_loss: 153859575.4667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8863; val_auprc_score: 0.8741; val_best_acc_score: 0.8023; val_best_f1_score: 0.8189; train_kl_reg_loss: 256995.2319; train_edge_recon_loss: 3075211.2786; train_gene_expr_recon_loss: 36258958.8397; train_masked_gp_l1_reg_loss: 79494.6482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 204317.8248; train_chrom_access_recon_loss: 112657385.5267; train_global_loss: 152532362.8702; train_optim_loss: 152532362.8702; val_kl_reg_loss: 245804.1594; val_edge_recon_loss: 3083394.2167; val_gene_expr_recon_loss: 36523894.1333; val_masked_gp_l1_reg_loss: 80286.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199780.5469; val_chrom_access_recon_loss: 112455998.4000; val_global_loss: 152589158.4000; val_optim_loss: 152589158.4000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9010; val_auprc_score: 0.8885; val_best_acc_score: 0.8172; val_best_f1_score: 0.8324; train_kl_reg_loss: 243401.5018; train_edge_recon_loss: 3046376.8588; train_gene_expr_recon_loss: 36004174.1679; train_masked_gp_l1_reg_loss: 81238.6589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 195307.8281; train_chrom_access_recon_loss: 111899377.5267; train_global_loss: 151469876.8855; train_optim_loss: 151469876.8855; val_kl_reg_loss: 234675.8927; val_edge_recon_loss: 3032383.0333; val_gene_expr_recon_loss: 36319391.4667; val_masked_gp_l1_reg_loss: 82189.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190792.8906; val_chrom_access_recon_loss: 111910780.8000; val_global_loss: 151770211.2000; val_optim_loss: 151770211.2000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9040; val_auprc_score: 0.8895; val_best_acc_score: 0.8227; val_best_f1_score: 0.8389; train_kl_reg_loss: 231316.6570; train_edge_recon_loss: 3006188.3168; train_gene_expr_recon_loss: 35837648.8855; train_masked_gp_l1_reg_loss: 83234.2219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186520.7581; train_chrom_access_recon_loss: 111494109.8626; train_global_loss: 150839019.8473; train_optim_loss: 150839019.8473; val_kl_reg_loss: 231681.8427; val_edge_recon_loss: 2991705.4167; val_gene_expr_recon_loss: 36138419.7333; val_masked_gp_l1_reg_loss: 84008.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182278.4219; val_chrom_access_recon_loss: 111517418.1333; val_global_loss: 151145511.4667; val_optim_loss: 151145511.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9159; val_auprc_score: 0.9033; val_best_acc_score: 0.8374; val_best_f1_score: 0.8491; train_kl_reg_loss: 223969.1636; train_edge_recon_loss: 2972499.8092; train_gene_expr_recon_loss: 35701493.4351; train_masked_gp_l1_reg_loss: 84883.7171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178343.6922; train_chrom_access_recon_loss: 111122819.6031; train_global_loss: 150284008.6718; train_optim_loss: 150284008.6718; val_kl_reg_loss: 220003.1437; val_edge_recon_loss: 2979030.1000; val_gene_expr_recon_loss: 35900846.6667; val_masked_gp_l1_reg_loss: 85495.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174431.9531; val_chrom_access_recon_loss: 110662692.8000; val_global_loss: 150022498.1333; val_optim_loss: 150022498.1333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9295; val_auprc_score: 0.9179; val_best_acc_score: 0.8581; val_best_f1_score: 0.8675; train_kl_reg_loss: 217407.0315; train_edge_recon_loss: 2941915.6107; train_gene_expr_recon_loss: 35472968.3969; train_masked_gp_l1_reg_loss: 86514.9031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170756.5569; train_chrom_access_recon_loss: 110391637.7405; train_global_loss: 149281200.1221; train_optim_loss: 149281200.1221; val_kl_reg_loss: 215665.7531; val_edge_recon_loss: 2931307.7833; val_gene_expr_recon_loss: 35836516.2667; val_masked_gp_l1_reg_loss: 87576.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167086.5312; val_chrom_access_recon_loss: 110683664.5333; val_global_loss: 149921819.7333; val_optim_loss: 149921819.7333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9321; val_auprc_score: 0.9158; val_best_acc_score: 0.8645; val_best_f1_score: 0.8717; train_kl_reg_loss: 215520.8810; train_edge_recon_loss: 2913879.8989; train_gene_expr_recon_loss: 35390201.1908; train_masked_gp_l1_reg_loss: 88346.7906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163614.4865; train_chrom_access_recon_loss: 110191010.6870; train_global_loss: 148962574.0458; train_optim_loss: 148962574.0458; val_kl_reg_loss: 205480.7823; val_edge_recon_loss: 2950621.7833; val_gene_expr_recon_loss: 35773110.4000; val_masked_gp_l1_reg_loss: 89253.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160204.4375; val_chrom_access_recon_loss: 110585068.8000; val_global_loss: 149763738.6667; val_optim_loss: 149763738.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9384; val_auprc_score: 0.9248; val_best_acc_score: 0.8736; val_best_f1_score: 0.8808; train_kl_reg_loss: 208867.5148; train_edge_recon_loss: 2907183.5515; train_gene_expr_recon_loss: 35344767.4504; train_masked_gp_l1_reg_loss: 89959.9519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156995.7009; train_chrom_access_recon_loss: 109954107.1145; train_global_loss: 148661881.2824; train_optim_loss: 148661881.2824; val_kl_reg_loss: 216147.5823; val_edge_recon_loss: 2906223.5333; val_gene_expr_recon_loss: 35700482.9333; val_masked_gp_l1_reg_loss: 90611.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153715.9688; val_chrom_access_recon_loss: 110024119.4667; val_global_loss: 149091301.3333; val_optim_loss: 149091301.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9375; val_auprc_score: 0.9229; val_best_acc_score: 0.8705; val_best_f1_score: 0.8779; train_kl_reg_loss: 211827.9422; train_edge_recon_loss: 2879460.5477; train_gene_expr_recon_loss: 35457459.6489; train_masked_gp_l1_reg_loss: 91191.2340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150443.3609; train_chrom_access_recon_loss: 109281292.8244; train_global_loss: 148071674.9924; train_optim_loss: 148071674.9924; val_kl_reg_loss: 205406.6708; val_edge_recon_loss: 2921851.9833; val_gene_expr_recon_loss: 35547709.3333; val_masked_gp_l1_reg_loss: 91904.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147342.7500; val_chrom_access_recon_loss: 109156866.6667; val_global_loss: 148071082.6667; val_optim_loss: 148071082.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9410; val_auprc_score: 0.9313; val_best_acc_score: 0.8708; val_best_f1_score: 0.8778; train_kl_reg_loss: 200487.5786; train_edge_recon_loss: 2886795.3626; train_gene_expr_recon_loss: 35206391.5878; train_masked_gp_l1_reg_loss: 92566.7260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144308.0258; train_chrom_access_recon_loss: 109378689.5878; train_global_loss: 147909238.5954; train_optim_loss: 147909238.5954; val_kl_reg_loss: 188919.5187; val_edge_recon_loss: 2915694.6000; val_gene_expr_recon_loss: 35591667.7333; val_masked_gp_l1_reg_loss: 93384.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141365.4062; val_chrom_access_recon_loss: 109566783.4667; val_global_loss: 148497814.4000; val_optim_loss: 148497814.4000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9450; val_auprc_score: 0.9322; val_best_acc_score: 0.8795; val_best_f1_score: 0.8868; train_kl_reg_loss: 197799.8197; train_edge_recon_loss: 2872301.5019; train_gene_expr_recon_loss: 35067798.1069; train_masked_gp_l1_reg_loss: 94275.3739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138349.2941; train_chrom_access_recon_loss: 108930648.4885; train_global_loss: 147301172.5191; train_optim_loss: 147301172.5191; val_kl_reg_loss: 204889.1740; val_edge_recon_loss: 2865468.9000; val_gene_expr_recon_loss: 35419379.2000; val_masked_gp_l1_reg_loss: 94974.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135468.4844; val_chrom_access_recon_loss: 109625290.6667; val_global_loss: 148345470.9333; val_optim_loss: 148345470.9333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9475; val_auprc_score: 0.9377; val_best_acc_score: 0.8809; val_best_f1_score: 0.8861; train_kl_reg_loss: 202945.7591; train_edge_recon_loss: 2853058.5649; train_gene_expr_recon_loss: 34915136.5038; train_masked_gp_l1_reg_loss: 95417.6153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132989.7273; train_chrom_access_recon_loss: 108418413.0687; train_global_loss: 146617960.9160; train_optim_loss: 146617960.9160; val_kl_reg_loss: 200063.9354; val_edge_recon_loss: 2870704.2333; val_gene_expr_recon_loss: 35416570.2667; val_masked_gp_l1_reg_loss: 96380.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130706.2891; val_chrom_access_recon_loss: 109407152.5333; val_global_loss: 148121576.5333; val_optim_loss: 148121576.5333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9502; val_auprc_score: 0.9408; val_best_acc_score: 0.8871; val_best_f1_score: 0.8923; train_kl_reg_loss: 198254.6882; train_edge_recon_loss: 2843853.2252; train_gene_expr_recon_loss: 34812678.0458; train_masked_gp_l1_reg_loss: 96976.9803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128616.0299; train_chrom_access_recon_loss: 108195417.1603; train_global_loss: 146275796.1527; train_optim_loss: 146275796.1527; val_kl_reg_loss: 194602.7250; val_edge_recon_loss: 2863229.1000; val_gene_expr_recon_loss: 35243641.2000; val_masked_gp_l1_reg_loss: 97524.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126554.3203; val_chrom_access_recon_loss: 109080748.2667; val_global_loss: 147606300.8000; val_optim_loss: 147606300.8000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9521; val_auprc_score: 0.9418; val_best_acc_score: 0.8882; val_best_f1_score: 0.8944; train_kl_reg_loss: 193184.0151; train_edge_recon_loss: 2835321.1985; train_gene_expr_recon_loss: 34789406.4275; train_masked_gp_l1_reg_loss: 98480.7091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124641.6351; train_chrom_access_recon_loss: 108110267.6031; train_global_loss: 146151301.0076; train_optim_loss: 146151301.0076; val_kl_reg_loss: 190732.9958; val_edge_recon_loss: 2846288.8667; val_gene_expr_recon_loss: 35080476.2667; val_masked_gp_l1_reg_loss: 99399.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122748.6953; val_chrom_access_recon_loss: 108014528.0000; val_global_loss: 146354174.9333; val_optim_loss: 146354174.9333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9529; val_auprc_score: 0.9406; val_best_acc_score: 0.8897; val_best_f1_score: 0.8954; train_kl_reg_loss: 188510.8477; train_edge_recon_loss: 2828449.5553; train_gene_expr_recon_loss: 34734032.1221; train_masked_gp_l1_reg_loss: 100073.6612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120873.5890; train_chrom_access_recon_loss: 107877586.4427; train_global_loss: 145849526.2290; train_optim_loss: 145849526.2290; val_kl_reg_loss: 185492.1812; val_edge_recon_loss: 2837761.7667; val_gene_expr_recon_loss: 35167115.4667; val_masked_gp_l1_reg_loss: 100824.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118938.7656; val_chrom_access_recon_loss: 108295685.3333; val_global_loss: 146705818.6667; val_optim_loss: 146705818.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9542; val_auprc_score: 0.9440; val_best_acc_score: 0.8911; val_best_f1_score: 0.8973; train_kl_reg_loss: 184942.4927; train_edge_recon_loss: 2828870.4695; train_gene_expr_recon_loss: 34599711.2977; train_masked_gp_l1_reg_loss: 101667.8191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117119.4541; train_chrom_access_recon_loss: 107362363.1756; train_global_loss: 145194674.9313; train_optim_loss: 145194674.9313; val_kl_reg_loss: 184367.3292; val_edge_recon_loss: 2848157.4333; val_gene_expr_recon_loss: 35051940.2667; val_masked_gp_l1_reg_loss: 102334.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115364.5625; val_chrom_access_recon_loss: 107930165.8667; val_global_loss: 146232328.5333; val_optim_loss: 146232328.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9597; val_auprc_score: 0.9525; val_best_acc_score: 0.8987; val_best_f1_score: 0.9032; train_kl_reg_loss: 180487.8100; train_edge_recon_loss: 2823157.8092; train_gene_expr_recon_loss: 34579138.3359; train_masked_gp_l1_reg_loss: 103223.0754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113619.2794; train_chrom_access_recon_loss: 107394889.5878; train_global_loss: 145194516.1527; train_optim_loss: 145194516.1527; val_kl_reg_loss: 180369.7948; val_edge_recon_loss: 2812154.9500; val_gene_expr_recon_loss: 34939456.8000; val_masked_gp_l1_reg_loss: 103770.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111895.3359; val_chrom_access_recon_loss: 107432135.4667; val_global_loss: 145579784.5333; val_optim_loss: 145579784.5333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9558; val_auprc_score: 0.9464; val_best_acc_score: 0.8937; val_best_f1_score: 0.8989; train_kl_reg_loss: 177783.4610; train_edge_recon_loss: 2815634.1756; train_gene_expr_recon_loss: 34534922.5496; train_masked_gp_l1_reg_loss: 104722.2142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110323.4201; train_chrom_access_recon_loss: 107318533.3740; train_global_loss: 145061919.1450; train_optim_loss: 145061919.1450; val_kl_reg_loss: 177101.5198; val_edge_recon_loss: 2839734.4333; val_gene_expr_recon_loss: 34882497.0667; val_masked_gp_l1_reg_loss: 105340.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108821.7656; val_chrom_access_recon_loss: 107561230.4000; val_global_loss: 145674724.2667; val_optim_loss: 145674724.2667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9561; val_auprc_score: 0.9468; val_best_acc_score: 0.8950; val_best_f1_score: 0.8997; train_kl_reg_loss: 173453.2044; train_edge_recon_loss: 2816943.3836; train_gene_expr_recon_loss: 34470960.1985; train_masked_gp_l1_reg_loss: 106234.9392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107245.5519; train_chrom_access_recon_loss: 107060713.7710; train_global_loss: 144735551.7557; train_optim_loss: 144735551.7557; val_kl_reg_loss: 171130.7260; val_edge_recon_loss: 2821904.1167; val_gene_expr_recon_loss: 34847985.4667; val_masked_gp_l1_reg_loss: 107217.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105703.2188; val_chrom_access_recon_loss: 107467202.1333; val_global_loss: 145521142.4000; val_optim_loss: 145521142.4000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9615; val_auprc_score: 0.9524; val_best_acc_score: 0.9037; val_best_f1_score: 0.9073; train_kl_reg_loss: 170840.5636; train_edge_recon_loss: 2806252.7557; train_gene_expr_recon_loss: 34442080.3969; train_masked_gp_l1_reg_loss: 107941.8486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104359.8717; train_chrom_access_recon_loss: 106999388.0305; train_global_loss: 144630863.7557; train_optim_loss: 144630863.7557; val_kl_reg_loss: 170342.0812; val_edge_recon_loss: 2797698.1000; val_gene_expr_recon_loss: 34841322.6667; val_masked_gp_l1_reg_loss: 108872.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103023.2422; val_chrom_access_recon_loss: 107575691.7333; val_global_loss: 145596950.4000; val_optim_loss: 145596950.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9576; val_auprc_score: 0.9495; val_best_acc_score: 0.8967; val_best_f1_score: 0.9016; train_kl_reg_loss: 169484.4235; train_edge_recon_loss: 2794827.8664; train_gene_expr_recon_loss: 34419140.0458; train_masked_gp_l1_reg_loss: 109600.0004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101648.8207; train_chrom_access_recon_loss: 106938952.3664; train_global_loss: 144533654.2290; train_optim_loss: 144533654.2290; val_kl_reg_loss: 170979.5406; val_edge_recon_loss: 2817127.8333; val_gene_expr_recon_loss: 34787972.4000; val_masked_gp_l1_reg_loss: 110249.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100362.9453; val_chrom_access_recon_loss: 107330709.3333; val_global_loss: 145317399.4667; val_optim_loss: 145317399.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9618; val_auprc_score: 0.9532; val_best_acc_score: 0.9037; val_best_f1_score: 0.9072; train_kl_reg_loss: 182662.2128; train_edge_recon_loss: 2876190.1489; train_gene_expr_recon_loss: 35652041.8015; train_masked_gp_l1_reg_loss: 108096.5295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99972.0184; train_chrom_access_recon_loss: 107856298.8092; train_global_loss: 146775261.5573; train_optim_loss: 146775261.5573; val_kl_reg_loss: 99894.6391; val_edge_recon_loss: 2849826.6833; val_gene_expr_recon_loss: 36023477.8667; val_masked_gp_l1_reg_loss: 107134.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99320.4375; val_chrom_access_recon_loss: 108829842.1333; val_global_loss: 148009497.6000; val_optim_loss: 148009497.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9624; val_auprc_score: 0.9549; val_best_acc_score: 0.9039; val_best_f1_score: 0.9076; train_kl_reg_loss: 173501.3668; train_edge_recon_loss: 2829877.5706; train_gene_expr_recon_loss: 35510187.1908; train_masked_gp_l1_reg_loss: 107027.5461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98159.3922; train_chrom_access_recon_loss: 107851453.0687; train_global_loss: 146570205.4351; train_optim_loss: 146570205.4351; val_kl_reg_loss: 108590.4135; val_edge_recon_loss: 2819577.7500; val_gene_expr_recon_loss: 35746330.4000; val_masked_gp_l1_reg_loss: 106815.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96792.4141; val_chrom_access_recon_loss: 107410440.0000; val_global_loss: 146288545.0667; val_optim_loss: 146288545.0667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9616; val_auprc_score: 0.9531; val_best_acc_score: 0.9020; val_best_f1_score: 0.9071; train_kl_reg_loss: 161430.6998; train_edge_recon_loss: 2814853.9637; train_gene_expr_recon_loss: 35359704.4885; train_masked_gp_l1_reg_loss: 106759.8666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95982.4407; train_chrom_access_recon_loss: 107521775.1450; train_global_loss: 146060505.4046; train_optim_loss: 146060505.4046; val_kl_reg_loss: 113400.9901; val_edge_recon_loss: 2813848.5833; val_gene_expr_recon_loss: 35660254.9333; val_masked_gp_l1_reg_loss: 106652.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95240.8906; val_chrom_access_recon_loss: 107490761.0667; val_global_loss: 146280156.8000; val_optim_loss: 146280156.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9604; val_auprc_score: 0.9518; val_best_acc_score: 0.9029; val_best_f1_score: 0.9067; train_kl_reg_loss: 155643.2508; train_edge_recon_loss: 2791561.8435; train_gene_expr_recon_loss: 35291995.9847; train_masked_gp_l1_reg_loss: 106740.7145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94602.6140; train_chrom_access_recon_loss: 107439081.8931; train_global_loss: 145879626.5038; train_optim_loss: 145879626.5038; val_kl_reg_loss: 116101.6760; val_edge_recon_loss: 2804179.0667; val_gene_expr_recon_loss: 35646565.3333; val_masked_gp_l1_reg_loss: 106744.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93910.2266; val_chrom_access_recon_loss: 107537222.9333; val_global_loss: 146304728.5333; val_optim_loss: 146304728.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9648; val_auprc_score: 0.9584; val_best_acc_score: 0.9069; val_best_f1_score: 0.9100; train_kl_reg_loss: 153180.3333; train_edge_recon_loss: 2786571.2214; train_gene_expr_recon_loss: 35214883.7557; train_masked_gp_l1_reg_loss: 106410.8482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93630.3053; train_chrom_access_recon_loss: 107267487.7557; train_global_loss: 145622164.6412; train_optim_loss: 145622164.6412; val_kl_reg_loss: 118820.8177; val_edge_recon_loss: 2797245.5000; val_gene_expr_recon_loss: 35565529.6000; val_masked_gp_l1_reg_loss: 106277.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93399.3047; val_chrom_access_recon_loss: 107744820.8000; val_global_loss: 146426092.8000; val_optim_loss: 146426092.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9643; val_auprc_score: 0.9571; val_best_acc_score: 0.9072; val_best_f1_score: 0.9109; train_kl_reg_loss: 153688.8255; train_edge_recon_loss: 2782343.0363; train_gene_expr_recon_loss: 35258068.2443; train_masked_gp_l1_reg_loss: 106216.2482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93229.4353; train_chrom_access_recon_loss: 107532740.7023; train_global_loss: 145926287.3893; train_optim_loss: 145926287.3893; val_kl_reg_loss: 120196.5953; val_edge_recon_loss: 2771014.7833; val_gene_expr_recon_loss: 35618801.6000; val_masked_gp_l1_reg_loss: 106153.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93066.2500; val_chrom_access_recon_loss: 107515872.0000; val_global_loss: 146225105.0667; val_optim_loss: 146225105.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9648; val_auprc_score: 0.9569; val_best_acc_score: 0.9026; val_best_f1_score: 0.9072; train_kl_reg_loss: 153508.6907; train_edge_recon_loss: 2778598.7519; train_gene_expr_recon_loss: 35251882.7786; train_masked_gp_l1_reg_loss: 106114.5441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92919.5299; train_chrom_access_recon_loss: 107599986.9924; train_global_loss: 145983011.9084; train_optim_loss: 145983011.9084; val_kl_reg_loss: 120490.6781; val_edge_recon_loss: 2784437.8500; val_gene_expr_recon_loss: 35737616.0000; val_masked_gp_l1_reg_loss: 106067.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92770.2734; val_chrom_access_recon_loss: 108424216.5333; val_global_loss: 147265603.2000; val_optim_loss: 147265603.2000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9624; val_auprc_score: 0.9518; val_best_acc_score: 0.9056; val_best_f1_score: 0.9091; train_kl_reg_loss: 152439.9311; train_edge_recon_loss: 2783776.1832; train_gene_expr_recon_loss: 35212531.0840; train_masked_gp_l1_reg_loss: 106027.7897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92633.1442; train_chrom_access_recon_loss: 107412890.4427; train_global_loss: 145760299.6031; train_optim_loss: 145760299.6031; val_kl_reg_loss: 120804.8016; val_edge_recon_loss: 2794214.5667; val_gene_expr_recon_loss: 35606637.6000; val_masked_gp_l1_reg_loss: 105979.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92484.7578; val_chrom_access_recon_loss: 107776856.5333; val_global_loss: 146496976.0000; val_optim_loss: 146496976.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 24 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9632
val AUPRC score: 0.9534
val best accuracy score: 0.9037
val best F1 score: 0.9078
val target rna MSE score: 1.1663
val source rna MSE score: 65.1267
val target atac MSE score: 0.1247
val source atac MSE score: 0.9419
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
