[True]
Run timestamp: 10082023_230727_91.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_91']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7789; val_auprc_score: 0.7991; val_best_acc_score: 0.5459; val_best_f1_score: 0.6828; train_kl_reg_loss: 251142.2387; train_edge_recon_loss: 3979648.0534; train_gene_expr_recon_loss: 50696097.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 130916397.5573; train_global_loss: 185843285.3740; train_optim_loss: 185843285.3740; val_kl_reg_loss: 198147.6875; val_edge_recon_loss: 4062134.0333; val_gene_expr_recon_loss: 40529391.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 116404257.6000; val_global_loss: 161193931.7333; val_optim_loss: 161193931.7333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8073; val_auprc_score: 0.8225; val_best_acc_score: 0.7332; val_best_f1_score: 0.7358; train_kl_reg_loss: 264765.4037; train_edge_recon_loss: 3783774.8569; train_gene_expr_recon_loss: 38585573.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 116071278.4733; train_global_loss: 158705391.7557; train_optim_loss: 158705391.7557; val_kl_reg_loss: 270938.2938; val_edge_recon_loss: 4040317.8833; val_gene_expr_recon_loss: 37664222.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 114196227.7333; val_global_loss: 156171706.6667; val_optim_loss: 156171706.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8756; val_auprc_score: 0.8737; val_best_acc_score: 0.7894; val_best_f1_score: 0.8033; train_kl_reg_loss: 260087.0761; train_edge_recon_loss: 3601067.4542; train_gene_expr_recon_loss: 37357066.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 114917721.4046; train_global_loss: 156135941.8626; train_optim_loss: 156135941.8626; val_kl_reg_loss: 226971.3646; val_edge_recon_loss: 3834259.3833; val_gene_expr_recon_loss: 37071952.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 113246224.5333; val_global_loss: 154379408.0000; val_optim_loss: 154379408.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8854; val_auprc_score: 0.8790; val_best_acc_score: 0.7951; val_best_f1_score: 0.8053; train_kl_reg_loss: 223734.7108; train_edge_recon_loss: 3366233.3111; train_gene_expr_recon_loss: 36865170.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113869743.6947; train_global_loss: 154324883.2977; train_optim_loss: 154324883.2977; val_kl_reg_loss: 231373.4031; val_edge_recon_loss: 3218839.6167; val_gene_expr_recon_loss: 36792401.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112682577.0667; val_global_loss: 152925191.4667; val_optim_loss: 152925191.4667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8995; val_auprc_score: 0.8936; val_best_acc_score: 0.8108; val_best_f1_score: 0.8237; train_kl_reg_loss: 253752.6324; train_edge_recon_loss: 3111234.6145; train_gene_expr_recon_loss: 36599599.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113456527.1450; train_global_loss: 153421113.4046; train_optim_loss: 153421113.4046; val_kl_reg_loss: 237648.8438; val_edge_recon_loss: 3076600.6167; val_gene_expr_recon_loss: 36541706.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112344840.0000; val_global_loss: 152200795.7333; val_optim_loss: 152200795.7333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9127; val_auprc_score: 0.9029; val_best_acc_score: 0.8265; val_best_f1_score: 0.8401; train_kl_reg_loss: 239695.3427; train_edge_recon_loss: 3058754.3053; train_gene_expr_recon_loss: 36383058.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 112894647.2672; train_global_loss: 152576154.3817; train_optim_loss: 152576154.3817; val_kl_reg_loss: 232633.9312; val_edge_recon_loss: 3032673.3000; val_gene_expr_recon_loss: 36193528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111443440.5333; val_global_loss: 150902275.2000; val_optim_loss: 150902275.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9156; val_auprc_score: 0.9049; val_best_acc_score: 0.8360; val_best_f1_score: 0.8470; train_kl_reg_loss: 230789.2276; train_edge_recon_loss: 3008049.9008; train_gene_expr_recon_loss: 36182224.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 112326066.5649; train_global_loss: 151747129.7710; train_optim_loss: 151747129.7710; val_kl_reg_loss: 224634.5635; val_edge_recon_loss: 2996380.3167; val_gene_expr_recon_loss: 36013464.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110493707.7333; val_global_loss: 149728185.6000; val_optim_loss: 149728185.6000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9182; val_auprc_score: 0.9046; val_best_acc_score: 0.8418; val_best_f1_score: 0.8545; train_kl_reg_loss: 220625.2826; train_edge_recon_loss: 2969827.5095; train_gene_expr_recon_loss: 35955825.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111580458.6870; train_global_loss: 150726736.7328; train_optim_loss: 150726736.7328; val_kl_reg_loss: 219520.1333; val_edge_recon_loss: 2967842.0000; val_gene_expr_recon_loss: 35883855.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110379220.2667; val_global_loss: 149450438.4000; val_optim_loss: 149450438.4000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9316; val_auprc_score: 0.9192; val_best_acc_score: 0.8601; val_best_f1_score: 0.8706; train_kl_reg_loss: 215078.3610; train_edge_recon_loss: 2936651.0038; train_gene_expr_recon_loss: 35795792.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111073583.6336; train_global_loss: 150021104.7328; train_optim_loss: 150021104.7328; val_kl_reg_loss: 207350.0344; val_edge_recon_loss: 2920997.3167; val_gene_expr_recon_loss: 35680904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110033806.9333; val_global_loss: 148843057.0667; val_optim_loss: 148843057.0667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9378; val_auprc_score: 0.9264; val_best_acc_score: 0.8612; val_best_f1_score: 0.8696; train_kl_reg_loss: 209289.9383; train_edge_recon_loss: 2908210.2996; train_gene_expr_recon_loss: 35640552.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110630682.8092; train_global_loss: 149388735.6336; train_optim_loss: 149388735.6336; val_kl_reg_loss: 204081.0729; val_edge_recon_loss: 2911465.8167; val_gene_expr_recon_loss: 35572070.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109428395.2000; val_global_loss: 148116010.6667; val_optim_loss: 148116010.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9412; val_auprc_score: 0.9315; val_best_acc_score: 0.8717; val_best_f1_score: 0.8777; train_kl_reg_loss: 204584.9245; train_edge_recon_loss: 2895262.4752; train_gene_expr_recon_loss: 35518435.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110370794.1985; train_global_loss: 148989076.2748; train_optim_loss: 148989076.2748; val_kl_reg_loss: 198141.2708; val_edge_recon_loss: 2894575.8333; val_gene_expr_recon_loss: 35429392.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109159254.9333; val_global_loss: 147681366.4000; val_optim_loss: 147681366.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9370; val_auprc_score: 0.9234; val_best_acc_score: 0.8682; val_best_f1_score: 0.8740; train_kl_reg_loss: 199390.0160; train_edge_recon_loss: 2869557.9599; train_gene_expr_recon_loss: 35343169.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109636397.1298; train_global_loss: 148048514.1985; train_optim_loss: 148048514.1985; val_kl_reg_loss: 193222.6906; val_edge_recon_loss: 2903175.7833; val_gene_expr_recon_loss: 35257886.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108404804.2667; val_global_loss: 146759086.9333; val_optim_loss: 146759086.9333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9504; val_auprc_score: 0.9434; val_best_acc_score: 0.8836; val_best_f1_score: 0.8880; train_kl_reg_loss: 192585.5595; train_edge_recon_loss: 2866113.8149; train_gene_expr_recon_loss: 35299960.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109504594.9924; train_global_loss: 147863255.2061; train_optim_loss: 147863255.2061; val_kl_reg_loss: 191040.5010; val_edge_recon_loss: 2874024.4833; val_gene_expr_recon_loss: 35191402.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108552746.6667; val_global_loss: 146809216.0000; val_optim_loss: 146809216.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9434; val_auprc_score: 0.9332; val_best_acc_score: 0.8762; val_best_f1_score: 0.8816; train_kl_reg_loss: 190890.8564; train_edge_recon_loss: 2845997.5000; train_gene_expr_recon_loss: 35172819.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109178029.0076; train_global_loss: 147387736.5496; train_optim_loss: 147387736.5496; val_kl_reg_loss: 186975.0458; val_edge_recon_loss: 2873236.9500; val_gene_expr_recon_loss: 34999943.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107602305.0667; val_global_loss: 145662461.8667; val_optim_loss: 145662461.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9535; val_auprc_score: 0.9432; val_best_acc_score: 0.8911; val_best_f1_score: 0.8962; train_kl_reg_loss: 187336.8135; train_edge_recon_loss: 2831698.5095; train_gene_expr_recon_loss: 35076171.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108812613.1298; train_global_loss: 146907820.3359; train_optim_loss: 146907820.3359; val_kl_reg_loss: 181726.8896; val_edge_recon_loss: 2850802.2333; val_gene_expr_recon_loss: 35154266.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108263700.2667; val_global_loss: 146450496.0000; val_optim_loss: 146450496.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9512; val_auprc_score: 0.9412; val_best_acc_score: 0.8872; val_best_f1_score: 0.8929; train_kl_reg_loss: 182154.5385; train_edge_recon_loss: 2828476.0382; train_gene_expr_recon_loss: 34993367.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108511188.5802; train_global_loss: 146515187.4198; train_optim_loss: 146515187.4198; val_kl_reg_loss: 173112.5979; val_edge_recon_loss: 2837262.9500; val_gene_expr_recon_loss: 34808276.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106821861.8667; val_global_loss: 144640514.1333; val_optim_loss: 144640514.1333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9478; val_auprc_score: 0.9354; val_best_acc_score: 0.8829; val_best_f1_score: 0.8897; train_kl_reg_loss: 179228.1682; train_edge_recon_loss: 2825542.2691; train_gene_expr_recon_loss: 34937031.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108409910.4122; train_global_loss: 146351711.4504; train_optim_loss: 146351711.4504; val_kl_reg_loss: 172461.0833; val_edge_recon_loss: 2849484.1000; val_gene_expr_recon_loss: 34839386.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107268808.0000; val_global_loss: 145130139.7333; val_optim_loss: 145130139.7333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9527; val_auprc_score: 0.9434; val_best_acc_score: 0.8874; val_best_f1_score: 0.8936; train_kl_reg_loss: 174174.7811; train_edge_recon_loss: 2818051.7481; train_gene_expr_recon_loss: 34799015.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107944101.3130; train_global_loss: 145735343.1450; train_optim_loss: 145735343.1450; val_kl_reg_loss: 168486.4438; val_edge_recon_loss: 2828391.1167; val_gene_expr_recon_loss: 34709221.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106875593.6000; val_global_loss: 144581693.8667; val_optim_loss: 144581693.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9613; val_auprc_score: 0.9555; val_best_acc_score: 0.8975; val_best_f1_score: 0.9008; train_kl_reg_loss: 169514.8330; train_edge_recon_loss: 2819240.3588; train_gene_expr_recon_loss: 34732510.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107826066.3817; train_global_loss: 145547331.9084; train_optim_loss: 145547331.9084; val_kl_reg_loss: 166256.0042; val_edge_recon_loss: 2806313.9500; val_gene_expr_recon_loss: 34762116.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106977439.4667; val_global_loss: 144712125.8667; val_optim_loss: 144712125.8667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9599; val_auprc_score: 0.9526; val_best_acc_score: 0.8996; val_best_f1_score: 0.9034; train_kl_reg_loss: 166297.1780; train_edge_recon_loss: 2802893.0153; train_gene_expr_recon_loss: 34642372.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107323213.0687; train_global_loss: 144934774.9618; train_optim_loss: 144934774.9618; val_kl_reg_loss: 164774.1000; val_edge_recon_loss: 2806198.4333; val_gene_expr_recon_loss: 34767236.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106694365.3333; val_global_loss: 144432573.8667; val_optim_loss: 144432573.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9588; val_auprc_score: 0.9496; val_best_acc_score: 0.8991; val_best_f1_score: 0.9028; train_kl_reg_loss: 163814.2426; train_edge_recon_loss: 2801786.3073; train_gene_expr_recon_loss: 34615629.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107431625.4046; train_global_loss: 145012856.0000; train_optim_loss: 145012856.0000; val_kl_reg_loss: 162334.8302; val_edge_recon_loss: 2811254.5333; val_gene_expr_recon_loss: 34646076.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106547344.5333; val_global_loss: 144167008.0000; val_optim_loss: 144167008.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9592; val_auprc_score: 0.9506; val_best_acc_score: 0.9014; val_best_f1_score: 0.9057; train_kl_reg_loss: 160349.3663; train_edge_recon_loss: 2799028.5897; train_gene_expr_recon_loss: 34573983.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107305078.4122; train_global_loss: 144838439.0840; train_optim_loss: 144838439.0840; val_kl_reg_loss: 156728.2729; val_edge_recon_loss: 2814234.3833; val_gene_expr_recon_loss: 34554769.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106526139.2000; val_global_loss: 144051872.0000; val_optim_loss: 144051872.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9622; val_auprc_score: 0.9561; val_best_acc_score: 0.9027; val_best_f1_score: 0.9073; train_kl_reg_loss: 157299.3052; train_edge_recon_loss: 2786133.3454; train_gene_expr_recon_loss: 34521134.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107187849.6489; train_global_loss: 144652416.9160; train_optim_loss: 144652416.9160; val_kl_reg_loss: 151703.5177; val_edge_recon_loss: 2817655.4500; val_gene_expr_recon_loss: 34572108.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106332558.9333; val_global_loss: 143874023.4667; val_optim_loss: 143874023.4667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9633; val_auprc_score: 0.9574; val_best_acc_score: 0.9018; val_best_f1_score: 0.9064; train_kl_reg_loss: 153477.6225; train_edge_recon_loss: 2792752.0725; train_gene_expr_recon_loss: 34451923.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 106867044.7634; train_global_loss: 144265197.9237; train_optim_loss: 144265197.9237; val_kl_reg_loss: 148279.7437; val_edge_recon_loss: 2808574.2000; val_gene_expr_recon_loss: 34364444.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 105594212.8000; val_global_loss: 142915512.5333; val_optim_loss: 142915512.5333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9612; val_auprc_score: 0.9528; val_best_acc_score: 0.9014; val_best_f1_score: 0.9051; train_kl_reg_loss: 152480.6638; train_edge_recon_loss: 2784360.9981; train_gene_expr_recon_loss: 34419454.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 106904876.7023; train_global_loss: 144261173.4962; train_optim_loss: 144261173.4962; val_kl_reg_loss: 151950.5990; val_edge_recon_loss: 2802716.1833; val_gene_expr_recon_loss: 34514754.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106477758.9333; val_global_loss: 143947178.6667; val_optim_loss: 143947178.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9643; val_auprc_score: 0.9577; val_best_acc_score: 0.9064; val_best_f1_score: 0.9101; train_kl_reg_loss: 156919.6003; train_edge_recon_loss: 2821167.5782; train_gene_expr_recon_loss: 35406632.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107894741.7405; train_global_loss: 146279460.5191; train_optim_loss: 146279460.5191; val_kl_reg_loss: 96486.3266; val_edge_recon_loss: 2817033.3000; val_gene_expr_recon_loss: 35491802.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107079235.7333; val_global_loss: 145484557.8667; val_optim_loss: 145484557.8667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9653; val_auprc_score: 0.9580; val_best_acc_score: 0.9104; val_best_f1_score: 0.9146; train_kl_reg_loss: 154499.3331; train_edge_recon_loss: 2810460.1126; train_gene_expr_recon_loss: 35431002.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107875742.9618; train_global_loss: 146271703.8168; train_optim_loss: 146271703.8168; val_kl_reg_loss: 96363.4151; val_edge_recon_loss: 2809025.9000; val_gene_expr_recon_loss: 35482382.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107068119.4667; val_global_loss: 145455891.2000; val_optim_loss: 145455891.2000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9677; val_auprc_score: 0.9616; val_best_acc_score: 0.9139; val_best_f1_score: 0.9166; train_kl_reg_loss: 148761.3683; train_edge_recon_loss: 2796293.0191; train_gene_expr_recon_loss: 35390635.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107893243.1145; train_global_loss: 146228934.1069; train_optim_loss: 146228934.1069; val_kl_reg_loss: 96701.8094; val_edge_recon_loss: 2795670.9000; val_gene_expr_recon_loss: 35399107.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107017931.2000; val_global_loss: 145309412.2667; val_optim_loss: 145309412.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9703; val_auprc_score: 0.9646; val_best_acc_score: 0.9175; val_best_f1_score: 0.9208; train_kl_reg_loss: 148670.4419; train_edge_recon_loss: 2784630.3454; train_gene_expr_recon_loss: 35420810.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107820198.9618; train_global_loss: 146174310.4122; train_optim_loss: 146174310.4122; val_kl_reg_loss: 98489.4089; val_edge_recon_loss: 2796366.9500; val_gene_expr_recon_loss: 35574441.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107163902.9333; val_global_loss: 145633197.8667; val_optim_loss: 145633197.8667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9698; val_auprc_score: 0.9623; val_best_acc_score: 0.9196; val_best_f1_score: 0.9210; train_kl_reg_loss: 148321.3577; train_edge_recon_loss: 2774879.3206; train_gene_expr_recon_loss: 35430957.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107730291.2366; train_global_loss: 146084449.9542; train_optim_loss: 146084449.9542; val_kl_reg_loss: 99304.4250; val_edge_recon_loss: 2785892.3000; val_gene_expr_recon_loss: 35494656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106828842.6667; val_global_loss: 145208697.6000; val_optim_loss: 145208697.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9672; val_auprc_score: 0.9596; val_best_acc_score: 0.9161; val_best_f1_score: 0.9185; train_kl_reg_loss: 148040.0211; train_edge_recon_loss: 2779532.4637; train_gene_expr_recon_loss: 35453317.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107884038.9618; train_global_loss: 146264929.0992; train_optim_loss: 146264929.0992; val_kl_reg_loss: 99583.0208; val_edge_recon_loss: 2775871.6000; val_gene_expr_recon_loss: 35599210.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107369457.6000; val_global_loss: 145844122.6667; val_optim_loss: 145844122.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9679; val_auprc_score: 0.9583; val_best_acc_score: 0.9158; val_best_f1_score: 0.9187; train_kl_reg_loss: 147496.2202; train_edge_recon_loss: 2777614.8397; train_gene_expr_recon_loss: 35447034.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107834546.6870; train_global_loss: 146206691.7863; train_optim_loss: 146206691.7863; val_kl_reg_loss: 99627.7198; val_edge_recon_loss: 2793465.1000; val_gene_expr_recon_loss: 35433135.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106859459.2000; val_global_loss: 145185683.2000; val_optim_loss: 145185683.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 52 min 26 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9625
val AUPRC score: 0.9557
val best accuracy score: 0.9045
val best F1 score: 0.9089
val target rna MSE score: 1.1104
val source rna MSE score: 51.2431
val target atac MSE score: 0.1207
val source atac MSE score: 0.8843
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
