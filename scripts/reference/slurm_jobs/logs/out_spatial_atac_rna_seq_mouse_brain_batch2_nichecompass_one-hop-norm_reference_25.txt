[True]
Run timestamp: 07082023_175629_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8912; val_auprc_score: 0.9001; val_best_acc_score: 0.5019; val_best_f1_score: 0.6675; train_kl_reg_loss: 10354.0685; train_edge_recon_loss: 35664.4692; train_gene_expr_recon_loss: 660499.0278; train_masked_gp_l1_reg_loss: 16133.6222; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 795682.9722; train_global_loss: 1518334.1806; train_optim_loss: 1518334.1806; val_kl_reg_loss: 11152.3652; val_edge_recon_loss: 40653.9219; val_gene_expr_recon_loss: 607273.8750; val_masked_gp_l1_reg_loss: 11731.7275; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 794392.8125; val_global_loss: 1465204.7500; val_optim_loss: 1465204.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8651; val_auprc_score: 0.8715; val_best_acc_score: 0.5023; val_best_f1_score: 0.6677; train_kl_reg_loss: 18928.2140; train_edge_recon_loss: 38516.6354; train_gene_expr_recon_loss: 569590.0764; train_masked_gp_l1_reg_loss: 10261.4069; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 778856.1111; train_global_loss: 1416152.4583; train_optim_loss: 1416152.4583; val_kl_reg_loss: 25128.9531; val_edge_recon_loss: 40654.9883; val_gene_expr_recon_loss: 546703.7500; val_masked_gp_l1_reg_loss: 9285.9990; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 776466.0000; val_global_loss: 1398239.7500; val_optim_loss: 1398239.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8703; val_auprc_score: 0.8714; val_best_acc_score: 0.5150; val_best_f1_score: 0.6731; train_kl_reg_loss: 26046.9564; train_edge_recon_loss: 39126.2214; train_gene_expr_recon_loss: 516693.4896; train_masked_gp_l1_reg_loss: 9488.2764; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 768659.4306; train_global_loss: 1360014.3750; train_optim_loss: 1360014.3750; val_kl_reg_loss: 27389.5879; val_edge_recon_loss: 40645.3477; val_gene_expr_recon_loss: 506917.1875; val_masked_gp_l1_reg_loss: 9611.5127; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 763363.6875; val_global_loss: 1347927.2500; val_optim_loss: 1347927.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8705; val_auprc_score: 0.8694; val_best_acc_score: 0.5195; val_best_f1_score: 0.6750; train_kl_reg_loss: 27777.4110; train_edge_recon_loss: 39303.2622; train_gene_expr_recon_loss: 488800.9271; train_masked_gp_l1_reg_loss: 9446.8351; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 749185.6528; train_global_loss: 1314514.0972; train_optim_loss: 1314514.0972; val_kl_reg_loss: 28427.1680; val_edge_recon_loss: 40641.0508; val_gene_expr_recon_loss: 485094.1250; val_masked_gp_l1_reg_loss: 9240.2656; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 753248.5625; val_global_loss: 1316651.2500; val_optim_loss: 1316651.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8698; val_auprc_score: 0.8633; val_best_acc_score: 0.5379; val_best_f1_score: 0.6828; train_kl_reg_loss: 28741.1641; train_edge_recon_loss: 39277.7600; train_gene_expr_recon_loss: 470925.5347; train_masked_gp_l1_reg_loss: 9087.6520; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 744744.0556; train_global_loss: 1292776.1667; train_optim_loss: 1292776.1667; val_kl_reg_loss: 29195.6191; val_edge_recon_loss: 40624.2539; val_gene_expr_recon_loss: 469890.1875; val_masked_gp_l1_reg_loss: 8912.0488; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 745347.8125; val_global_loss: 1293970.0000; val_optim_loss: 1293970.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8741; val_auprc_score: 0.8644; val_best_acc_score: 0.5585; val_best_f1_score: 0.6911; train_kl_reg_loss: 29143.0757; train_edge_recon_loss: 39300.9831; train_gene_expr_recon_loss: 459227.3090; train_masked_gp_l1_reg_loss: 8782.3894; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 737073.1111; train_global_loss: 1273526.8611; train_optim_loss: 1273526.8611; val_kl_reg_loss: 29055.0820; val_edge_recon_loss: 40600.8672; val_gene_expr_recon_loss: 459089.6875; val_masked_gp_l1_reg_loss: 8617.0566; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 738655.7500; val_global_loss: 1276018.5000; val_optim_loss: 1276018.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8806; val_auprc_score: 0.8733; val_best_acc_score: 0.5946; val_best_f1_score: 0.7079; train_kl_reg_loss: 30076.5152; train_edge_recon_loss: 39329.7079; train_gene_expr_recon_loss: 448225.0035; train_masked_gp_l1_reg_loss: 8524.6197; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 726874.0278; train_global_loss: 1253029.8889; train_optim_loss: 1253029.8889; val_kl_reg_loss: 29731.0879; val_edge_recon_loss: 40562.9023; val_gene_expr_recon_loss: 450340.2500; val_masked_gp_l1_reg_loss: 8411.7217; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 732445.6250; val_global_loss: 1261491.6250; val_optim_loss: 1261491.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9072; val_auprc_score: 0.9034; val_best_acc_score: 0.6628; val_best_f1_score: 0.7433; train_kl_reg_loss: 30987.6500; train_edge_recon_loss: 39349.7526; train_gene_expr_recon_loss: 441052.9618; train_masked_gp_l1_reg_loss: 8346.3468; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724070.2639; train_global_loss: 1243806.9861; train_optim_loss: 1243806.9861; val_kl_reg_loss: 31731.2539; val_edge_recon_loss: 40532.4023; val_gene_expr_recon_loss: 442416.0000; val_masked_gp_l1_reg_loss: 8269.5615; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 726781.0625; val_global_loss: 1249730.2500; val_optim_loss: 1249730.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9118; val_auprc_score: 0.9041; val_best_acc_score: 0.7688; val_best_f1_score: 0.8060; train_kl_reg_loss: 32091.0378; train_edge_recon_loss: 39373.4918; train_gene_expr_recon_loss: 433246.3715; train_masked_gp_l1_reg_loss: 8218.3663; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 716947.2986; train_global_loss: 1229876.5278; train_optim_loss: 1229876.5278; val_kl_reg_loss: 31288.1367; val_edge_recon_loss: 40448.7500; val_gene_expr_recon_loss: 437335.9688; val_masked_gp_l1_reg_loss: 8161.2051; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722313.2500; val_global_loss: 1239547.3750; val_optim_loss: 1239547.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9191; val_auprc_score: 0.9146; val_best_acc_score: 0.8161; val_best_f1_score: 0.8360; train_kl_reg_loss: 32439.9835; train_edge_recon_loss: 39332.0486; train_gene_expr_recon_loss: 431222.7882; train_masked_gp_l1_reg_loss: 8133.5777; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 715552.7361; train_global_loss: 1226681.1250; train_optim_loss: 1226681.1250; val_kl_reg_loss: 31628.6523; val_edge_recon_loss: 40356.9805; val_gene_expr_recon_loss: 432683.0000; val_masked_gp_l1_reg_loss: 8106.7998; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718482.5625; val_global_loss: 1231258.0000; val_optim_loss: 1231258.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9200; val_auprc_score: 0.9129; val_best_acc_score: 0.8332; val_best_f1_score: 0.8463; train_kl_reg_loss: 32497.2459; train_edge_recon_loss: 39290.4740; train_gene_expr_recon_loss: 427147.4618; train_masked_gp_l1_reg_loss: 8099.6447; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 713810.3333; train_global_loss: 1220845.1667; train_optim_loss: 1220845.1667; val_kl_reg_loss: 31613.0508; val_edge_recon_loss: 40296.8125; val_gene_expr_recon_loss: 429025.0312; val_masked_gp_l1_reg_loss: 8083.8237; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 715352.5625; val_global_loss: 1224371.2500; val_optim_loss: 1224371.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9259; val_auprc_score: 0.9169; val_best_acc_score: 0.8546; val_best_f1_score: 0.8598; train_kl_reg_loss: 32175.6632; train_edge_recon_loss: 39269.6285; train_gene_expr_recon_loss: 421595.5903; train_masked_gp_l1_reg_loss: 8074.3222; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 711563.7778; train_global_loss: 1212678.9861; train_optim_loss: 1212678.9861; val_kl_reg_loss: 30315.4258; val_edge_recon_loss: 40235.5859; val_gene_expr_recon_loss: 426938.0000; val_masked_gp_l1_reg_loss: 8058.2300; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 712765.6250; val_global_loss: 1218312.8750; val_optim_loss: 1218312.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9264; val_auprc_score: 0.9196; val_best_acc_score: 0.8587; val_best_f1_score: 0.8607; train_kl_reg_loss: 31727.6456; train_edge_recon_loss: 39229.8767; train_gene_expr_recon_loss: 418647.7396; train_masked_gp_l1_reg_loss: 8044.9503; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 706408.0069; train_global_loss: 1204058.2361; train_optim_loss: 1204058.2361; val_kl_reg_loss: 29685.1152; val_edge_recon_loss: 40180.6055; val_gene_expr_recon_loss: 424852.9375; val_masked_gp_l1_reg_loss: 8032.9375; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 710470.4375; val_global_loss: 1213222.0000; val_optim_loss: 1213222.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9298; val_auprc_score: 0.9218; val_best_acc_score: 0.8628; val_best_f1_score: 0.8634; train_kl_reg_loss: 31302.4980; train_edge_recon_loss: 39196.0004; train_gene_expr_recon_loss: 418656.2118; train_masked_gp_l1_reg_loss: 8038.1716; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 703010.2847; train_global_loss: 1200203.1667; train_optim_loss: 1200203.1667; val_kl_reg_loss: 30330.4492; val_edge_recon_loss: 40158.0508; val_gene_expr_recon_loss: 422209.5312; val_masked_gp_l1_reg_loss: 8034.8481; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 707169.1250; val_global_loss: 1207902.0000; val_optim_loss: 1207902.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9301; val_auprc_score: 0.9158; val_best_acc_score: 0.8624; val_best_f1_score: 0.8607; train_kl_reg_loss: 31128.7509; train_edge_recon_loss: 39165.3099; train_gene_expr_recon_loss: 416609.9965; train_masked_gp_l1_reg_loss: 8037.0792; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 701946.2431; train_global_loss: 1196887.3472; train_optim_loss: 1196887.3472; val_kl_reg_loss: 29380.1758; val_edge_recon_loss: 40097.2500; val_gene_expr_recon_loss: 420735.6250; val_masked_gp_l1_reg_loss: 8032.5732; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 705227.1250; val_global_loss: 1203472.7500; val_optim_loss: 1203472.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9340; val_auprc_score: 0.9213; val_best_acc_score: 0.8608; val_best_f1_score: 0.8591; train_kl_reg_loss: 30589.5699; train_edge_recon_loss: 39120.3307; train_gene_expr_recon_loss: 413034.7674; train_masked_gp_l1_reg_loss: 8039.3764; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 700113.5972; train_global_loss: 1190897.6389; train_optim_loss: 1190897.6389; val_kl_reg_loss: 29651.6406; val_edge_recon_loss: 40046.0234; val_gene_expr_recon_loss: 418710.1250; val_masked_gp_l1_reg_loss: 8042.9590; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 702563.1875; val_global_loss: 1199014.0000; val_optim_loss: 1199014.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9384; val_auprc_score: 0.9312; val_best_acc_score: 0.8601; val_best_f1_score: 0.8565; train_kl_reg_loss: 30309.8262; train_edge_recon_loss: 39070.8976; train_gene_expr_recon_loss: 413665.3299; train_masked_gp_l1_reg_loss: 8041.7243; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 696068.7569; train_global_loss: 1187156.5278; train_optim_loss: 1187156.5278; val_kl_reg_loss: 28856.9590; val_edge_recon_loss: 39985.2266; val_gene_expr_recon_loss: 417625.2500; val_masked_gp_l1_reg_loss: 8037.3701; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 700803.3125; val_global_loss: 1195308.1250; val_optim_loss: 1195308.1250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9393; val_auprc_score: 0.9320; val_best_acc_score: 0.8603; val_best_f1_score: 0.8560; train_kl_reg_loss: 29881.9395; train_edge_recon_loss: 39035.1224; train_gene_expr_recon_loss: 410151.5521; train_masked_gp_l1_reg_loss: 8044.6882; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 693132.2778; train_global_loss: 1180245.5694; train_optim_loss: 1180245.5694; val_kl_reg_loss: 28843.4141; val_edge_recon_loss: 39963.0430; val_gene_expr_recon_loss: 416144.3438; val_masked_gp_l1_reg_loss: 8042.1631; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 698762.5000; val_global_loss: 1191755.5000; val_optim_loss: 1191755.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9382; val_auprc_score: 0.9299; val_best_acc_score: 0.8558; val_best_f1_score: 0.8497; train_kl_reg_loss: 29382.0375; train_edge_recon_loss: 39006.3793; train_gene_expr_recon_loss: 407859.0521; train_masked_gp_l1_reg_loss: 8050.2214; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 688801.2292; train_global_loss: 1173098.9167; train_optim_loss: 1173098.9167; val_kl_reg_loss: 27665.3848; val_edge_recon_loss: 39918.8086; val_gene_expr_recon_loss: 415555.7500; val_masked_gp_l1_reg_loss: 8049.3389; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 697753.1250; val_global_loss: 1188942.3750; val_optim_loss: 1188942.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9412; val_auprc_score: 0.9323; val_best_acc_score: 0.8561; val_best_f1_score: 0.8496; train_kl_reg_loss: 29098.9214; train_edge_recon_loss: 38965.3021; train_gene_expr_recon_loss: 408378.0243; train_masked_gp_l1_reg_loss: 8053.6022; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 691774.9167; train_global_loss: 1176270.7639; train_optim_loss: 1176270.7639; val_kl_reg_loss: 28253.9414; val_edge_recon_loss: 39876.1172; val_gene_expr_recon_loss: 413926.1875; val_masked_gp_l1_reg_loss: 8056.9443; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 695736.6250; val_global_loss: 1185849.7500; val_optim_loss: 1185849.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9411; val_auprc_score: 0.9349; val_best_acc_score: 0.8496; val_best_f1_score: 0.8404; train_kl_reg_loss: 28761.0436; train_edge_recon_loss: 38920.6801; train_gene_expr_recon_loss: 406384.3160; train_masked_gp_l1_reg_loss: 8062.7517; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 690130.0694; train_global_loss: 1172258.8472; train_optim_loss: 1172258.8472; val_kl_reg_loss: 26564.8906; val_edge_recon_loss: 39843.2656; val_gene_expr_recon_loss: 414014.6562; val_masked_gp_l1_reg_loss: 8065.8301; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 694951.2500; val_global_loss: 1183439.8750; val_optim_loss: 1183439.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9381; val_auprc_score: 0.9280; val_best_acc_score: 0.8472; val_best_f1_score: 0.8377; train_kl_reg_loss: 28240.6020; train_edge_recon_loss: 38899.0451; train_gene_expr_recon_loss: 404541.7153; train_masked_gp_l1_reg_loss: 8069.0588; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 683041.2847; train_global_loss: 1162791.7083; train_optim_loss: 1162791.7083; val_kl_reg_loss: 26540.5820; val_edge_recon_loss: 39830.6445; val_gene_expr_recon_loss: 412748.5625; val_masked_gp_l1_reg_loss: 8067.3389; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 693335.8750; val_global_loss: 1180523.0000; val_optim_loss: 1180523.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9456; val_auprc_score: 0.9403; val_best_acc_score: 0.8488; val_best_f1_score: 0.8417; train_kl_reg_loss: 27959.2941; train_edge_recon_loss: 38862.1515; train_gene_expr_recon_loss: 405756.7118; train_masked_gp_l1_reg_loss: 8072.3791; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 684503.8333; train_global_loss: 1165154.3750; train_optim_loss: 1165154.3750; val_kl_reg_loss: 26192.5996; val_edge_recon_loss: 39777.9688; val_gene_expr_recon_loss: 412090.4688; val_masked_gp_l1_reg_loss: 8073.7720; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 691726.8125; val_global_loss: 1177861.6250; val_optim_loss: 1177861.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9460; val_auprc_score: 0.9372; val_best_acc_score: 0.8534; val_best_f1_score: 0.8420; train_kl_reg_loss: 27608.0299; train_edge_recon_loss: 38827.3316; train_gene_expr_recon_loss: 405380.7431; train_masked_gp_l1_reg_loss: 8082.6724; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 686293.3264; train_global_loss: 1166192.0972; train_optim_loss: 1166192.0972; val_kl_reg_loss: 26611.3203; val_edge_recon_loss: 39781.3750; val_gene_expr_recon_loss: 410645.6875; val_masked_gp_l1_reg_loss: 8085.3555; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 689685.0000; val_global_loss: 1174808.7500; val_optim_loss: 1174808.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9467; val_auprc_score: 0.9381; val_best_acc_score: 0.8459; val_best_f1_score: 0.8412; train_kl_reg_loss: 27380.7389; train_edge_recon_loss: 38800.4688; train_gene_expr_recon_loss: 405192.4236; train_masked_gp_l1_reg_loss: 8091.8620; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 685162.9375; train_global_loss: 1164628.4444; train_optim_loss: 1164628.4444; val_kl_reg_loss: 25201.6953; val_edge_recon_loss: 39714.5938; val_gene_expr_recon_loss: 410905.4375; val_masked_gp_l1_reg_loss: 8093.8281; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 689170.0000; val_global_loss: 1173085.5000; val_optim_loss: 1173085.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9449; val_auprc_score: 0.9418; val_best_acc_score: 0.8476; val_best_f1_score: 0.8636; train_kl_reg_loss: 25432.9217; train_edge_recon_loss: 40295.9510; train_gene_expr_recon_loss: 423937.7326; train_masked_gp_l1_reg_loss: 8120.4284; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 699607.9375; train_global_loss: 1197394.9722; train_optim_loss: 1197394.9722; val_kl_reg_loss: 19127.3457; val_edge_recon_loss: 40443.0469; val_gene_expr_recon_loss: 428012.7188; val_masked_gp_l1_reg_loss: 8136.2769; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 704389.4375; val_global_loss: 1200108.8750; val_optim_loss: 1200108.8750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9444; val_auprc_score: 0.9376; val_best_acc_score: 0.8484; val_best_f1_score: 0.8645; train_kl_reg_loss: 21935.1157; train_edge_recon_loss: 40357.3429; train_gene_expr_recon_loss: 419745.7917; train_masked_gp_l1_reg_loss: 8129.5132; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 698578.7361; train_global_loss: 1188746.5000; train_optim_loss: 1188746.5000; val_kl_reg_loss: 18742.0898; val_edge_recon_loss: 40441.6602; val_gene_expr_recon_loss: 425711.4375; val_masked_gp_l1_reg_loss: 8101.4121; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 702615.6250; val_global_loss: 1195612.2500; val_optim_loss: 1195612.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9461; val_auprc_score: 0.9386; val_best_acc_score: 0.8575; val_best_f1_score: 0.8703; train_kl_reg_loss: 20950.1549; train_edge_recon_loss: 40334.5117; train_gene_expr_recon_loss: 418898.0000; train_masked_gp_l1_reg_loss: 8075.2076; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695840.8958; train_global_loss: 1184098.7639; train_optim_loss: 1184098.7639; val_kl_reg_loss: 18555.6602; val_edge_recon_loss: 40403.5312; val_gene_expr_recon_loss: 424017.0625; val_masked_gp_l1_reg_loss: 8038.4121; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 701408.2500; val_global_loss: 1192422.8750; val_optim_loss: 1192422.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9495; val_auprc_score: 0.9460; val_best_acc_score: 0.8720; val_best_f1_score: 0.8809; train_kl_reg_loss: 20247.3674; train_edge_recon_loss: 40295.0451; train_gene_expr_recon_loss: 418519.3854; train_masked_gp_l1_reg_loss: 8015.7342; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 696709.3472; train_global_loss: 1183786.8750; train_optim_loss: 1183786.8750; val_kl_reg_loss: 17997.8047; val_edge_recon_loss: 40360.5859; val_gene_expr_recon_loss: 423171.5000; val_masked_gp_l1_reg_loss: 7982.7402; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 700530.3750; val_global_loss: 1190043.0000; val_optim_loss: 1190043.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9476; val_auprc_score: 0.9403; val_best_acc_score: 0.8657; val_best_f1_score: 0.8762; train_kl_reg_loss: 19845.6947; train_edge_recon_loss: 40273.2834; train_gene_expr_recon_loss: 417143.8368; train_masked_gp_l1_reg_loss: 7904.6326; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 695175.0903; train_global_loss: 1180342.5278; train_optim_loss: 1180342.5278; val_kl_reg_loss: 19058.7500; val_edge_recon_loss: 40366.4805; val_gene_expr_recon_loss: 422050.4375; val_masked_gp_l1_reg_loss: 7840.2642; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 699927.3125; val_global_loss: 1189243.2500; val_optim_loss: 1189243.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9475; val_auprc_score: 0.9436; val_best_acc_score: 0.8627; val_best_f1_score: 0.8734; train_kl_reg_loss: 19829.4991; train_edge_recon_loss: 40265.4384; train_gene_expr_recon_loss: 415145.6771; train_masked_gp_l1_reg_loss: 7821.0153; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 694744.7639; train_global_loss: 1177806.4028; train_optim_loss: 1177806.4028; val_kl_reg_loss: 18455.6914; val_edge_recon_loss: 40363.3789; val_gene_expr_recon_loss: 422445.5000; val_masked_gp_l1_reg_loss: 7791.4248; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 700201.6250; val_global_loss: 1189257.6250; val_optim_loss: 1189257.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9484; val_auprc_score: 0.9447; val_best_acc_score: 0.8693; val_best_f1_score: 0.8787; train_kl_reg_loss: 19931.2826; train_edge_recon_loss: 40262.0143; train_gene_expr_recon_loss: 415319.0243; train_masked_gp_l1_reg_loss: 7776.4180; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 693898.2917; train_global_loss: 1177187.0278; train_optim_loss: 1177187.0278; val_kl_reg_loss: 18515.6445; val_edge_recon_loss: 40361.5352; val_gene_expr_recon_loss: 422277.9688; val_masked_gp_l1_reg_loss: 7758.7383; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 700057.8125; val_global_loss: 1188971.7500; val_optim_loss: 1188971.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9443; val_auprc_score: 0.9358; val_best_acc_score: 0.8611; val_best_f1_score: 0.8722; train_kl_reg_loss: 19676.0948; train_edge_recon_loss: 40259.5143; train_gene_expr_recon_loss: 414911.7188; train_masked_gp_l1_reg_loss: 7747.9147; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 694444.4653; train_global_loss: 1177039.7083; train_optim_loss: 1177039.7083; val_kl_reg_loss: 18571.4492; val_edge_recon_loss: 40365.9414; val_gene_expr_recon_loss: 422299.8125; val_masked_gp_l1_reg_loss: 7736.2671; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 699865.1875; val_global_loss: 1188838.6250; val_optim_loss: 1188838.6250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 28 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9475
val AUPRC score: 0.9433
val best accuracy score: 0.8673
val best F1 score: 0.8765
val target rna MSE score: 0.5032
val source rna MSE score: 0.2962
val target atac MSE score: 0.1382
val source atac MSE score: 0.0184
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
