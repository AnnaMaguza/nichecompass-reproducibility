[True]
Run timestamp: 27072023_025703_134.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_134']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8641; val_auprc_score: 0.9739; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 474842.9168; train_edge_recon_loss: 11073718.2279; train_gene_expr_recon_loss: 20629824.1907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32178385.4512; train_optim_loss: 32178385.4512; val_kl_reg_loss: 194673.0247; val_edge_recon_loss: 11823238.2500; val_gene_expr_recon_loss: 13200291.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25218202.7500; val_optim_loss: 25218202.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8416; val_auprc_score: 0.9698; val_best_acc_score: 0.8669; val_best_f1_score: 0.9276; train_kl_reg_loss: 294131.6861; train_edge_recon_loss: 10763476.3651; train_gene_expr_recon_loss: 12203724.2233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23261332.3256; train_optim_loss: 23261332.3256; val_kl_reg_loss: 210425.5280; val_edge_recon_loss: 11802825.7083; val_gene_expr_recon_loss: 11921104.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23934355.5000; val_optim_loss: 23934355.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8386; val_auprc_score: 0.9688; val_best_acc_score: 0.8583; val_best_f1_score: 0.9231; train_kl_reg_loss: 177165.0773; train_edge_recon_loss: 10714976.2791; train_gene_expr_recon_loss: 11981174.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22873316.0930; train_optim_loss: 22873316.0930; val_kl_reg_loss: 155683.9622; val_edge_recon_loss: 12000782.2500; val_gene_expr_recon_loss: 11571868.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23728334.9167; val_optim_loss: 23728334.9167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8296; val_auprc_score: 0.9663; val_best_acc_score: 0.8675; val_best_f1_score: 0.9274; train_kl_reg_loss: 131194.0437; train_edge_recon_loss: 10641541.1047; train_gene_expr_recon_loss: 11184523.7628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21957258.9209; train_optim_loss: 21957258.9209; val_kl_reg_loss: 111649.6745; val_edge_recon_loss: 11584923.6667; val_gene_expr_recon_loss: 9936247.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21632820.3333; val_optim_loss: 21632820.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8319; val_auprc_score: 0.9639; val_best_acc_score: 0.8788; val_best_f1_score: 0.9331; train_kl_reg_loss: 120826.8187; train_edge_recon_loss: 10343591.8000; train_gene_expr_recon_loss: 9887108.0465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20351526.6791; train_optim_loss: 20351526.6791; val_kl_reg_loss: 113709.6149; val_edge_recon_loss: 11410169.5833; val_gene_expr_recon_loss: 9613248.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21137128.0833; val_optim_loss: 21137128.0833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8281; val_auprc_score: 0.9603; val_best_acc_score: 0.8769; val_best_f1_score: 0.9318; train_kl_reg_loss: 102366.2931; train_edge_recon_loss: 10009010.9279; train_gene_expr_recon_loss: 9500000.6744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19611377.8698; train_optim_loss: 19611377.8698; val_kl_reg_loss: 88529.1924; val_edge_recon_loss: 10095797.1667; val_gene_expr_recon_loss: 9365040.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19549366.3333; val_optim_loss: 19549366.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8379; val_auprc_score: 0.9616; val_best_acc_score: 0.8833; val_best_f1_score: 0.9348; train_kl_reg_loss: 118441.6453; train_edge_recon_loss: 9189543.9744; train_gene_expr_recon_loss: 9264345.8140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18572331.4744; train_optim_loss: 18572331.4744; val_kl_reg_loss: 147868.3496; val_edge_recon_loss: 9230384.8333; val_gene_expr_recon_loss: 9124044.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18502298.2500; val_optim_loss: 18502298.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8276; val_auprc_score: 0.9602; val_best_acc_score: 0.8890; val_best_f1_score: 0.9381; train_kl_reg_loss: 168106.6483; train_edge_recon_loss: 8861895.0349; train_gene_expr_recon_loss: 9028024.3953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18058026.1256; train_optim_loss: 18058026.1256; val_kl_reg_loss: 168093.1973; val_edge_recon_loss: 8965947.1458; val_gene_expr_recon_loss: 8903599.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18037639.7917; val_optim_loss: 18037639.7917
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8452; val_auprc_score: 0.9646; val_best_acc_score: 0.8968; val_best_f1_score: 0.9424; train_kl_reg_loss: 168980.1791; train_edge_recon_loss: 8725163.7767; train_gene_expr_recon_loss: 8809490.7442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17703634.6000; train_optim_loss: 17703634.6000; val_kl_reg_loss: 157147.1237; val_edge_recon_loss: 8714536.9375; val_gene_expr_recon_loss: 8706825.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17578509.7083; val_optim_loss: 17578509.7083
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8449; val_auprc_score: 0.9650; val_best_acc_score: 0.9016; val_best_f1_score: 0.9450; train_kl_reg_loss: 149886.3905; train_edge_recon_loss: 8645408.6674; train_gene_expr_recon_loss: 8503999.4442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17299294.4651; train_optim_loss: 17299294.4651; val_kl_reg_loss: 135394.7637; val_edge_recon_loss: 8789643.6250; val_gene_expr_recon_loss: 8412037.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17337076.2917; val_optim_loss: 17337076.2917
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8652; val_auprc_score: 0.9693; val_best_acc_score: 0.9067; val_best_f1_score: 0.9474; train_kl_reg_loss: 131272.3802; train_edge_recon_loss: 8504765.5721; train_gene_expr_recon_loss: 8340255.3488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16976293.2698; train_optim_loss: 16976293.2698; val_kl_reg_loss: 119785.8184; val_edge_recon_loss: 8656538.3958; val_gene_expr_recon_loss: 8265279.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17041603.5000; val_optim_loss: 17041603.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8832; val_auprc_score: 0.9728; val_best_acc_score: 0.9073; val_best_f1_score: 0.9473; train_kl_reg_loss: 118321.2863; train_edge_recon_loss: 8274090.8209; train_gene_expr_recon_loss: 8207372.9953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16599785.1023; train_optim_loss: 16599785.1023; val_kl_reg_loss: 105630.4508; val_edge_recon_loss: 8662508.7708; val_gene_expr_recon_loss: 8140550.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16908689.3333; val_optim_loss: 16908689.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8879; val_auprc_score: 0.9749; val_best_acc_score: 0.9038; val_best_f1_score: 0.9451; train_kl_reg_loss: 106758.4210; train_edge_recon_loss: 8277892.9000; train_gene_expr_recon_loss: 8085374.5930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16470025.8930; train_optim_loss: 16470025.8930; val_kl_reg_loss: 99559.1396; val_edge_recon_loss: 8384268.7500; val_gene_expr_recon_loss: 8028980.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16512808.0833; val_optim_loss: 16512808.0833
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8988; val_auprc_score: 0.9782; val_best_acc_score: 0.9034; val_best_f1_score: 0.9446; train_kl_reg_loss: 97322.4670; train_edge_recon_loss: 8115253.5674; train_gene_expr_recon_loss: 7974192.0512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16186768.0605; train_optim_loss: 16186768.0605; val_kl_reg_loss: 89775.0238; val_edge_recon_loss: 8382058.1458; val_gene_expr_recon_loss: 7918731.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16390564.5000; val_optim_loss: 16390564.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9002; val_auprc_score: 0.9780; val_best_acc_score: 0.9080; val_best_f1_score: 0.9471; train_kl_reg_loss: 88827.6711; train_edge_recon_loss: 8166051.2140; train_gene_expr_recon_loss: 7878758.3395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16133637.1721; train_optim_loss: 16133637.1721; val_kl_reg_loss: 82447.5179; val_edge_recon_loss: 8300258.1250; val_gene_expr_recon_loss: 7836819.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16219525.1250; val_optim_loss: 16219525.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9064; val_auprc_score: 0.9777; val_best_acc_score: 0.9102; val_best_f1_score: 0.9484; train_kl_reg_loss: 76069.3731; train_edge_recon_loss: 8016709.8419; train_gene_expr_recon_loss: 7789667.8953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15882447.1116; train_optim_loss: 15882447.1116; val_kl_reg_loss: 69254.6383; val_edge_recon_loss: 8343759.3958; val_gene_expr_recon_loss: 7757772.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16170786.9583; val_optim_loss: 16170786.9583
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9196; val_auprc_score: 0.9813; val_best_acc_score: 0.9210; val_best_f1_score: 0.9548; train_kl_reg_loss: 68991.7584; train_edge_recon_loss: 8003791.1372; train_gene_expr_recon_loss: 7710691.8651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15783474.7302; train_optim_loss: 15783474.7302; val_kl_reg_loss: 65107.3921; val_edge_recon_loss: 8065396.1667; val_gene_expr_recon_loss: 7674159.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15804662.7083; val_optim_loss: 15804662.7083
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9200; val_auprc_score: 0.9827; val_best_acc_score: 0.9218; val_best_f1_score: 0.9551; train_kl_reg_loss: 63491.9273; train_edge_recon_loss: 7933025.5837; train_gene_expr_recon_loss: 7635210.9651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15631728.4791; train_optim_loss: 15631728.4791; val_kl_reg_loss: 58638.7437; val_edge_recon_loss: 7886425.9167; val_gene_expr_recon_loss: 7599340.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15544405.4167; val_optim_loss: 15544405.4167
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9218; val_auprc_score: 0.9825; val_best_acc_score: 0.9198; val_best_f1_score: 0.9541; train_kl_reg_loss: 58363.2116; train_edge_recon_loss: 7922506.5302; train_gene_expr_recon_loss: 7566557.9953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15547427.7116; train_optim_loss: 15547427.7116; val_kl_reg_loss: 53989.9246; val_edge_recon_loss: 7970529.8125; val_gene_expr_recon_loss: 7529959.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15554479.5417; val_optim_loss: 15554479.5417
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9317; val_auprc_score: 0.9842; val_best_acc_score: 0.9231; val_best_f1_score: 0.9556; train_kl_reg_loss: 53594.2054; train_edge_recon_loss: 7864960.2535; train_gene_expr_recon_loss: 7502159.8605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15420714.3349; train_optim_loss: 15420714.3349; val_kl_reg_loss: 49440.2064; val_edge_recon_loss: 8049155.8125; val_gene_expr_recon_loss: 7484971.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15583567.9583; val_optim_loss: 15583567.9583
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9256; val_auprc_score: 0.9830; val_best_acc_score: 0.9216; val_best_f1_score: 0.9549; train_kl_reg_loss: 49080.1275; train_edge_recon_loss: 7894315.1395; train_gene_expr_recon_loss: 7450364.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15393759.6047; train_optim_loss: 15393759.6047; val_kl_reg_loss: 44319.2770; val_edge_recon_loss: 8185833.2083; val_gene_expr_recon_loss: 7426890.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15657042.9167; val_optim_loss: 15657042.9167
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9278; val_auprc_score: 0.9839; val_best_acc_score: 0.9241; val_best_f1_score: 0.9561; train_kl_reg_loss: 45604.0780; train_edge_recon_loss: 7849464.6605; train_gene_expr_recon_loss: 7393507.0558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15288575.8279; train_optim_loss: 15288575.8279; val_kl_reg_loss: 42661.4837; val_edge_recon_loss: 7776213.6250; val_gene_expr_recon_loss: 7368944.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15187819.9583; val_optim_loss: 15187819.9583
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9326; val_auprc_score: 0.9856; val_best_acc_score: 0.9257; val_best_f1_score: 0.9570; train_kl_reg_loss: 40919.4134; train_edge_recon_loss: 7819865.4419; train_gene_expr_recon_loss: 7343284.9535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15204069.8093; train_optim_loss: 15204069.8093; val_kl_reg_loss: 38131.5373; val_edge_recon_loss: 7731768.3333; val_gene_expr_recon_loss: 7321122.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15091022.2500; val_optim_loss: 15091022.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9392; val_auprc_score: 0.9860; val_best_acc_score: 0.9279; val_best_f1_score: 0.9580; train_kl_reg_loss: 38107.1992; train_edge_recon_loss: 7782387.1163; train_gene_expr_recon_loss: 7300676.1744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15121170.5023; train_optim_loss: 15121170.5023; val_kl_reg_loss: 35138.3743; val_edge_recon_loss: 8037679.1667; val_gene_expr_recon_loss: 7306571.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15379389.0833; val_optim_loss: 15379389.0833
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9415; val_auprc_score: 0.9875; val_best_acc_score: 0.9293; val_best_f1_score: 0.9592; train_kl_reg_loss: 36669.4290; train_edge_recon_loss: 7769232.3209; train_gene_expr_recon_loss: 7259851.9372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15065753.6558; train_optim_loss: 15065753.6558; val_kl_reg_loss: 35643.9471; val_edge_recon_loss: 7862031.1250; val_gene_expr_recon_loss: 7233376.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15131051.4583; val_optim_loss: 15131051.4583
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9444; val_auprc_score: 0.9877; val_best_acc_score: 0.9316; val_best_f1_score: 0.9607; train_kl_reg_loss: 36963.5258; train_edge_recon_loss: 7880763.7628; train_gene_expr_recon_loss: 7248129.1791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15165856.5070; train_optim_loss: 15165856.5070; val_kl_reg_loss: 17043.4058; val_edge_recon_loss: 7917586.0000; val_gene_expr_recon_loss: 7217932.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15152561.7917; val_optim_loss: 15152561.7917
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9484; val_auprc_score: 0.9878; val_best_acc_score: 0.9399; val_best_f1_score: 0.9653; train_kl_reg_loss: 35881.6191; train_edge_recon_loss: 7758289.8721; train_gene_expr_recon_loss: 7203559.8674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14997731.3535; train_optim_loss: 14997731.3535; val_kl_reg_loss: 16919.0898; val_edge_recon_loss: 7716274.7708; val_gene_expr_recon_loss: 7194951.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14928145.5833; val_optim_loss: 14928145.5833
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9556; val_auprc_score: 0.9902; val_best_acc_score: 0.9427; val_best_f1_score: 0.9669; train_kl_reg_loss: 33469.4535; train_edge_recon_loss: 7771368.2907; train_gene_expr_recon_loss: 7176499.3581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14981337.1349; train_optim_loss: 14981337.1349; val_kl_reg_loss: 16307.1248; val_edge_recon_loss: 7773948.8958; val_gene_expr_recon_loss: 7165832.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14956088.8750; val_optim_loss: 14956088.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9511; val_auprc_score: 0.9876; val_best_acc_score: 0.9428; val_best_f1_score: 0.9669; train_kl_reg_loss: 31914.2478; train_edge_recon_loss: 7753181.7395; train_gene_expr_recon_loss: 7146873.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14931969.6930; train_optim_loss: 14931969.6930; val_kl_reg_loss: 16061.9598; val_edge_recon_loss: 7950912.7917; val_gene_expr_recon_loss: 7131832.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15098807.5833; val_optim_loss: 15098807.5833
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9527; val_auprc_score: 0.9889; val_best_acc_score: 0.9460; val_best_f1_score: 0.9686; train_kl_reg_loss: 30181.5005; train_edge_recon_loss: 7668475.0465; train_gene_expr_recon_loss: 7118595.4744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14817252.0233; train_optim_loss: 14817252.0233; val_kl_reg_loss: 15326.3315; val_edge_recon_loss: 7756982.2917; val_gene_expr_recon_loss: 7108938.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14881247.5000; val_optim_loss: 14881247.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9531; val_auprc_score: 0.9888; val_best_acc_score: 0.9462; val_best_f1_score: 0.9687; train_kl_reg_loss: 29520.1231; train_edge_recon_loss: 7736460.5279; train_gene_expr_recon_loss: 7096916.4372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14862897.1302; train_optim_loss: 14862897.1302; val_kl_reg_loss: 15546.4134; val_edge_recon_loss: 8043373.8542; val_gene_expr_recon_loss: 7103777.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15162697.5417; val_optim_loss: 15162697.5417
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9541; val_auprc_score: 0.9897; val_best_acc_score: 0.9452; val_best_f1_score: 0.9682; train_kl_reg_loss: 28407.1140; train_edge_recon_loss: 7609466.6605; train_gene_expr_recon_loss: 7071919.8326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14709793.5767; train_optim_loss: 14709793.5767; val_kl_reg_loss: 15617.5134; val_edge_recon_loss: 7855160.6458; val_gene_expr_recon_loss: 7078654.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14949432.4167; val_optim_loss: 14949432.4167
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9541; val_auprc_score: 0.9894; val_best_acc_score: 0.9474; val_best_f1_score: 0.9695; train_kl_reg_loss: 27274.8926; train_edge_recon_loss: 7709984.3279; train_gene_expr_recon_loss: 7055290.6837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14792549.9209; train_optim_loss: 14792549.9209; val_kl_reg_loss: 15335.7513; val_edge_recon_loss: 7864248.2708; val_gene_expr_recon_loss: 7048730.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14928314.8333; val_optim_loss: 14928314.8333
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9626; val_auprc_score: 0.9917; val_best_acc_score: 0.9527; val_best_f1_score: 0.9726; train_kl_reg_loss: 26802.3355; train_edge_recon_loss: 7642678.3814; train_gene_expr_recon_loss: 7030514.7628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14699995.4977; train_optim_loss: 14699995.4977; val_kl_reg_loss: 15351.8211; val_edge_recon_loss: 7636904.6250; val_gene_expr_recon_loss: 7043874.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14696131.1250; val_optim_loss: 14696131.1250
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9600; val_auprc_score: 0.9909; val_best_acc_score: 0.9489; val_best_f1_score: 0.9704; train_kl_reg_loss: 25794.8107; train_edge_recon_loss: 7641571.7093; train_gene_expr_recon_loss: 7020657.9256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14688024.4465; train_optim_loss: 14688024.4465; val_kl_reg_loss: 15238.6104; val_edge_recon_loss: 7739551.2083; val_gene_expr_recon_loss: 7012994.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14767783.8333; val_optim_loss: 14767783.8333
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9621; val_auprc_score: 0.9906; val_best_acc_score: 0.9512; val_best_f1_score: 0.9715; train_kl_reg_loss: 25401.8333; train_edge_recon_loss: 7636012.0767; train_gene_expr_recon_loss: 7002298.0419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14663711.9860; train_optim_loss: 14663711.9860; val_kl_reg_loss: 15027.7597; val_edge_recon_loss: 7833702.2292; val_gene_expr_recon_loss: 7021185.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14869915.2500; val_optim_loss: 14869915.2500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9637; val_auprc_score: 0.9917; val_best_acc_score: 0.9555; val_best_f1_score: 0.9742; train_kl_reg_loss: 25206.8002; train_edge_recon_loss: 7744799.0465; train_gene_expr_recon_loss: 6995492.3814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14765498.2093; train_optim_loss: 14765498.2093; val_kl_reg_loss: 14405.1976; val_edge_recon_loss: 7673059.6458; val_gene_expr_recon_loss: 6996302.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14683767.7083; val_optim_loss: 14683767.7083
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9639; val_auprc_score: 0.9916; val_best_acc_score: 0.9540; val_best_f1_score: 0.9732; train_kl_reg_loss: 24151.4567; train_edge_recon_loss: 7599216.6488; train_gene_expr_recon_loss: 6979944.8233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14603312.9302; train_optim_loss: 14603312.9302; val_kl_reg_loss: 14569.9279; val_edge_recon_loss: 7942353.8958; val_gene_expr_recon_loss: 7002099.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14959022.9583; val_optim_loss: 14959022.9583
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9626; val_auprc_score: 0.9914; val_best_acc_score: 0.9544; val_best_f1_score: 0.9735; train_kl_reg_loss: 23926.8958; train_edge_recon_loss: 7690167.9047; train_gene_expr_recon_loss: 6968272.9442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14682367.7349; train_optim_loss: 14682367.7349; val_kl_reg_loss: 14692.5150; val_edge_recon_loss: 7895887.7500; val_gene_expr_recon_loss: 6974934.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14885514.8750; val_optim_loss: 14885514.8750
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9636; val_auprc_score: 0.9908; val_best_acc_score: 0.9554; val_best_f1_score: 0.9741; train_kl_reg_loss: 23639.6158; train_edge_recon_loss: 7650830.3023; train_gene_expr_recon_loss: 6963324.3279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14637794.2605; train_optim_loss: 14637794.2605; val_kl_reg_loss: 13731.8344; val_edge_recon_loss: 7847410.2917; val_gene_expr_recon_loss: 6970912.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14832054.7500; val_optim_loss: 14832054.7500
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9630; val_auprc_score: 0.9913; val_best_acc_score: 0.9574; val_best_f1_score: 0.9752; train_kl_reg_loss: 23286.3345; train_edge_recon_loss: 7630234.7186; train_gene_expr_recon_loss: 6949884.9814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14603406.0465; train_optim_loss: 14603406.0465; val_kl_reg_loss: 14762.2982; val_edge_recon_loss: 7920003.2083; val_gene_expr_recon_loss: 6961868.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14896634.3750; val_optim_loss: 14896634.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9628; val_auprc_score: 0.9908; val_best_acc_score: 0.9567; val_best_f1_score: 0.9749; train_kl_reg_loss: 23317.1534; train_edge_recon_loss: 7545266.8279; train_gene_expr_recon_loss: 6921678.0698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14490262.0744; train_optim_loss: 14490262.0744; val_kl_reg_loss: 14998.8090; val_edge_recon_loss: 7788606.4167; val_gene_expr_recon_loss: 6931138.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14734743.7083; val_optim_loss: 14734743.7083
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9587; val_auprc_score: 0.9900; val_best_acc_score: 0.9552; val_best_f1_score: 0.9742; train_kl_reg_loss: 23249.8645; train_edge_recon_loss: 7613525.7442; train_gene_expr_recon_loss: 6917747.6605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14554523.3023; train_optim_loss: 14554523.3023; val_kl_reg_loss: 15179.0148; val_edge_recon_loss: 7718314.2917; val_gene_expr_recon_loss: 6928411.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14661904.5417; val_optim_loss: 14661904.5417
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9660; val_auprc_score: 0.9920; val_best_acc_score: 0.9581; val_best_f1_score: 0.9758; train_kl_reg_loss: 23009.1579; train_edge_recon_loss: 7629375.8512; train_gene_expr_recon_loss: 6913639.9326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14566024.9349; train_optim_loss: 14566024.9349; val_kl_reg_loss: 15156.5688; val_edge_recon_loss: 7618497.3125; val_gene_expr_recon_loss: 6927741.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14561395.7917; val_optim_loss: 14561395.7917
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9610; val_auprc_score: 0.9900; val_best_acc_score: 0.9575; val_best_f1_score: 0.9753; train_kl_reg_loss: 22962.3404; train_edge_recon_loss: 7605473.6605; train_gene_expr_recon_loss: 6911982.0605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14540418.0651; train_optim_loss: 14540418.0651; val_kl_reg_loss: 15096.0082; val_edge_recon_loss: 7626306.5000; val_gene_expr_recon_loss: 6923865.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14565267.7500; val_optim_loss: 14565267.7500
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9667; val_auprc_score: 0.9922; val_best_acc_score: 0.9585; val_best_f1_score: 0.9759; train_kl_reg_loss: 23041.5398; train_edge_recon_loss: 7607310.4302; train_gene_expr_recon_loss: 6912926.5140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14543278.4465; train_optim_loss: 14543278.4465; val_kl_reg_loss: 15241.9563; val_edge_recon_loss: 7877834.0208; val_gene_expr_recon_loss: 6921800.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14814876.5000; val_optim_loss: 14814876.5000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9669; val_auprc_score: 0.9925; val_best_acc_score: 0.9581; val_best_f1_score: 0.9756; train_kl_reg_loss: 22956.2685; train_edge_recon_loss: 7573871.9070; train_gene_expr_recon_loss: 6909162.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14505990.6465; train_optim_loss: 14505990.6465; val_kl_reg_loss: 14873.9618; val_edge_recon_loss: 7876974.6667; val_gene_expr_recon_loss: 6923001.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14814849.8333; val_optim_loss: 14814849.8333
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9642; val_auprc_score: 0.9912; val_best_acc_score: 0.9554; val_best_f1_score: 0.9740; train_kl_reg_loss: 22670.4387; train_edge_recon_loss: 7599891.6349; train_gene_expr_recon_loss: 6909601.1977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14532163.2512; train_optim_loss: 14532163.2512; val_kl_reg_loss: 15079.7583; val_edge_recon_loss: 7955967.4167; val_gene_expr_recon_loss: 6918624.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14889671.7500; val_optim_loss: 14889671.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9652; val_auprc_score: 0.9914; val_best_acc_score: 0.9583; val_best_f1_score: 0.9757; train_kl_reg_loss: 22716.0406; train_edge_recon_loss: 7695575.6279; train_gene_expr_recon_loss: 6905930.6163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14624222.2930; train_optim_loss: 14624222.2930; val_kl_reg_loss: 15043.9748; val_edge_recon_loss: 7898860.1250; val_gene_expr_recon_loss: 6915744.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14829648.5833; val_optim_loss: 14829648.5833
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9643; val_auprc_score: 0.9915; val_best_acc_score: 0.9579; val_best_f1_score: 0.9757; train_kl_reg_loss: 22690.1185; train_edge_recon_loss: 7633543.5814; train_gene_expr_recon_loss: 6904792.3140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14561026.0419; train_optim_loss: 14561026.0419; val_kl_reg_loss: 15113.0823; val_edge_recon_loss: 7565373.3958; val_gene_expr_recon_loss: 6921357.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14501843.5833; val_optim_loss: 14501843.5833
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9645; val_auprc_score: 0.9905; val_best_acc_score: 0.9599; val_best_f1_score: 0.9767; train_kl_reg_loss: 22709.8042; train_edge_recon_loss: 7599944.6767; train_gene_expr_recon_loss: 6906985.9465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14529640.4605; train_optim_loss: 14529640.4605; val_kl_reg_loss: 15087.4662; val_edge_recon_loss: 7708757.5833; val_gene_expr_recon_loss: 6916437.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14640282.5417; val_optim_loss: 14640282.5417
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9673; val_auprc_score: 0.9923; val_best_acc_score: 0.9556; val_best_f1_score: 0.9742; train_kl_reg_loss: 22754.0639; train_edge_recon_loss: 7597152.0744; train_gene_expr_recon_loss: 6904315.7977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14524221.9395; train_optim_loss: 14524221.9395; val_kl_reg_loss: 15147.7068; val_edge_recon_loss: 7891801.6667; val_gene_expr_recon_loss: 6912089.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14819038.6667; val_optim_loss: 14819038.6667
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9680; val_auprc_score: 0.9922; val_best_acc_score: 0.9591; val_best_f1_score: 0.9763; train_kl_reg_loss: 22822.2789; train_edge_recon_loss: 7653502.9023; train_gene_expr_recon_loss: 6904071.8302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14580396.9814; train_optim_loss: 14580396.9814; val_kl_reg_loss: 15113.3903; val_edge_recon_loss: 7630325.3333; val_gene_expr_recon_loss: 6912924.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14558363.5833; val_optim_loss: 14558363.5833
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9664; val_auprc_score: 0.9922; val_best_acc_score: 0.9606; val_best_f1_score: 0.9771; train_kl_reg_loss: 22779.0357; train_edge_recon_loss: 7709873.6512; train_gene_expr_recon_loss: 6904034.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14636686.9581; train_optim_loss: 14636686.9581; val_kl_reg_loss: 15095.6455; val_edge_recon_loss: 7724817.6667; val_gene_expr_recon_loss: 6921496.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14661409.4583; val_optim_loss: 14661409.4583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9657; val_auprc_score: 0.9922; val_best_acc_score: 0.9576; val_best_f1_score: 0.9753; train_kl_reg_loss: 22722.1824; train_edge_recon_loss: 7625781.3581; train_gene_expr_recon_loss: 6903221.9047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14551725.4651; train_optim_loss: 14551725.4651; val_kl_reg_loss: 15108.7024; val_edge_recon_loss: 7827608.7083; val_gene_expr_recon_loss: 6916564.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14759281.7500; val_optim_loss: 14759281.7500
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9655; val_auprc_score: 0.9916; val_best_acc_score: 0.9558; val_best_f1_score: 0.9743; train_kl_reg_loss: 22741.4901; train_edge_recon_loss: 7766104.5558; train_gene_expr_recon_loss: 6901403.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14690249.9023; train_optim_loss: 14690249.9023; val_kl_reg_loss: 15114.8775; val_edge_recon_loss: 7951195.0417; val_gene_expr_recon_loss: 6923308.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14889618.3333; val_optim_loss: 14889618.3333
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9674; val_auprc_score: 0.9924; val_best_acc_score: 0.9586; val_best_f1_score: 0.9760; train_kl_reg_loss: 22697.6822; train_edge_recon_loss: 7641011.9349; train_gene_expr_recon_loss: 6904855.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14568565.4093; train_optim_loss: 14568565.4093; val_kl_reg_loss: 15076.1502; val_edge_recon_loss: 7751853.6875; val_gene_expr_recon_loss: 6913953.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14680883.6667; val_optim_loss: 14680883.6667
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9663; val_auprc_score: 0.9924; val_best_acc_score: 0.9594; val_best_f1_score: 0.9765; train_kl_reg_loss: 22723.4782; train_edge_recon_loss: 7647252.0419; train_gene_expr_recon_loss: 6903327.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14573303.0093; train_optim_loss: 14573303.0093; val_kl_reg_loss: 15081.9583; val_edge_recon_loss: 7545482.1875; val_gene_expr_recon_loss: 6920935.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14481499.8750; val_optim_loss: 14481499.8750
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9690; val_auprc_score: 0.9928; val_best_acc_score: 0.9589; val_best_f1_score: 0.9761; train_kl_reg_loss: 22696.3822; train_edge_recon_loss: 7649422.4674; train_gene_expr_recon_loss: 6902161.0953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14574279.9488; train_optim_loss: 14574279.9488; val_kl_reg_loss: 15091.5296; val_edge_recon_loss: 7609104.6667; val_gene_expr_recon_loss: 6917318.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14541514.9167; val_optim_loss: 14541514.9167
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9646; val_auprc_score: 0.9918; val_best_acc_score: 0.9574; val_best_f1_score: 0.9754; train_kl_reg_loss: 22709.2361; train_edge_recon_loss: 7623847.2302; train_gene_expr_recon_loss: 6904571.3744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14551127.8279; train_optim_loss: 14551127.8279; val_kl_reg_loss: 15094.9368; val_edge_recon_loss: 7640458.9167; val_gene_expr_recon_loss: 6913991.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14569545.5833; val_optim_loss: 14569545.5833
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9665; val_auprc_score: 0.9923; val_best_acc_score: 0.9546; val_best_f1_score: 0.9737; train_kl_reg_loss: 22722.9021; train_edge_recon_loss: 7617431.7977; train_gene_expr_recon_loss: 6904122.5465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14544277.2047; train_optim_loss: 14544277.2047; val_kl_reg_loss: 15126.9991; val_edge_recon_loss: 7902794.6250; val_gene_expr_recon_loss: 6916770.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14834691.7500; val_optim_loss: 14834691.7500
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9665; val_auprc_score: 0.9920; val_best_acc_score: 0.9576; val_best_f1_score: 0.9754; train_kl_reg_loss: 22722.0761; train_edge_recon_loss: 7645601.6000; train_gene_expr_recon_loss: 6903980.9465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14572304.6047; train_optim_loss: 14572304.6047; val_kl_reg_loss: 15125.6477; val_edge_recon_loss: 7710487.0625; val_gene_expr_recon_loss: 6912495.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14638108.3333; val_optim_loss: 14638108.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9653; val_auprc_score: 0.9913; val_best_acc_score: 0.9568; val_best_f1_score: 0.9750; train_kl_reg_loss: 22702.5010; train_edge_recon_loss: 7622807.6907; train_gene_expr_recon_loss: 6903832.0302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14549342.2140; train_optim_loss: 14549342.2140; val_kl_reg_loss: 15113.0705; val_edge_recon_loss: 7732014.2083; val_gene_expr_recon_loss: 6921387.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14668514.7917; val_optim_loss: 14668514.7917
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9660; val_auprc_score: 0.9919; val_best_acc_score: 0.9565; val_best_f1_score: 0.9747; train_kl_reg_loss: 22705.0816; train_edge_recon_loss: 7581153.1907; train_gene_expr_recon_loss: 6908180.5860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14512038.8512; train_optim_loss: 14512038.8512; val_kl_reg_loss: 15117.1098; val_edge_recon_loss: 7922139.1458; val_gene_expr_recon_loss: 6925219.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14862475.6250; val_optim_loss: 14862475.6250
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9683; val_auprc_score: 0.9924; val_best_acc_score: 0.9579; val_best_f1_score: 0.9756; train_kl_reg_loss: 22720.3394; train_edge_recon_loss: 7618438.4651; train_gene_expr_recon_loss: 6903443.9930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14544602.8140; train_optim_loss: 14544602.8140; val_kl_reg_loss: 15125.0515; val_edge_recon_loss: 7796389.8750; val_gene_expr_recon_loss: 6918717.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14730232.2500; val_optim_loss: 14730232.2500
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9644; val_auprc_score: 0.9919; val_best_acc_score: 0.9593; val_best_f1_score: 0.9765; train_kl_reg_loss: 22693.4027; train_edge_recon_loss: 7567898.9279; train_gene_expr_recon_loss: 6902904.0186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14493496.3070; train_optim_loss: 14493496.3070; val_kl_reg_loss: 15113.0072; val_edge_recon_loss: 7587233.5833; val_gene_expr_recon_loss: 6917175.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14519521.6667; val_optim_loss: 14519521.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 86 min 11 sec.
Using best model state, which was in epoch 58.

--- MODEL EVALUATION ---
Val AUROC score: 0.9663
Val AUPRC score: 0.9927
Val best accuracy score: 0.9565
Val best F1 score: 0.9749
Val gene expr MSE score: 184656.1926
Val cat covariate0 mean sim diff: -0.0017

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
